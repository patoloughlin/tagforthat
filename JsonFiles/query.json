{"total":20739,"page":1,"pagesize":100,"questions":[{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13298621,"title":"Select Statement with Distinct returning multiple rows and need only first result","body":"<p>I having a challenge with my query returning multiple results.</p>\n\n<pre><code>SELECT DISTINCT gpph.id, gpph.cname, gc2a.assetfilename, gpph.alternateURL\nFROM [StepMirror].[dbo].[stepview_nwppck_ngn_getpimproducthierarchy] gpph \nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2assetrefs] gc2a\nON gpph.id=gc2a.id\nWHERE gpph.subtype='Level_4' AND gpph.parentId=@ID AND gc2a.assettype='Primary Image'\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/29ZKP.png\" alt=\"result set\"></p>\n\n<p>A record, 5679599, has 2 'Primary Images' and is returning 2 results for that id but I only need the first result back.  Is there any way to do this IN the current query?  Do I need to write multiple queries?</p>\n\n<p>I need some direction on how to constrain the results to only 1 result on Primary Image. I have looked at a ton of similar questions but most typically are just requiring the guidance of adding 'distinct' to the beginning of their query rather than on the where clause.</p>\n\n<p>Any help would be awesome!</p>\n"},{"tags":["sql","sql-server","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13298432,"title":"SQL Nested JOIN","body":"<p>I am attemping to do a nested join from 2 sets of unioned tables.   I do not understand why I am getting the following errors:</p>\n\n<blockquote>\n  <p>Msg 156, Level 15, State 1, Line 15 Incorrect syntax near the keyword\n  'INNER'. Msg 156, Level 15, State 1, Line 24 Incorrect syntax near the\n  keyword 'On'.</p>\n</blockquote>\n\n<p>I assume based on the errors there is a problem with my ()'s but the syntax does follow the language shown from <a href=\"http://msdn.microsoft.com/en-us/library/office/bb208854%28v=office.12%29.aspx\" rel=\"nofollow\">Inner Join Operation</a>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>SELECT TOP 1000\n\nPus.SerialnoId,Hus.RT,Hus.DIVISION,Hus.REGION,Hus.ADJHSG,Hus.ADJINC,Hus.WGTP,Hus.NP,Hus.TYPE,Hus.ACR,Hus.AGS,Hus.BLD,Hus.BUS,Hus.CONP,Hus.ELEP,Hus.FS,Hus.FULP,Hus.GASP,Hus.HFL,Hus.INSP,Hus.KIT,Hus.MHP,Hus.MRGI,Hus.MRGP,Hus.MRGT,Hus.MRGX,Hus.RNTM,Hus.RNTP,Hus.SMP,Hus.TEL,Hus.TEN,Hus.VACS,Hus.VEH,Hus.WATP,Hus.YBL,Hus.FES,Hus.FINCP,Hus.FPARC,Hus.GRNTP,Hus.GRPIP,Hus.HHL,Hus.HHT,Hus.HINCP,Hus.HUGCL,Hus.HUPAC,Hus.HUPAOC,Hus.HUPARC,Hus.LNGI,Hus.MV,Hus.NOC,Hus.NPF,Hus.NPP,Hus.NR,Hus.NRC,Hus.OCPIP,Hus.PARTNER,Hus.PSF,Hus.R18,Hus.R60,Hus.R65,Hus.RESMODE,Hus.SMOCP,Hus.SMX,Hus.SRNT,Hus.SVAL,Hus.TAXP,Hus.WIF,Hus.WKEXREL,Hus.WORKSTAT,Hus.FACRP,Hus.FAGSP,Hus.FBDSP,Hus.FBLDP,Hus.FBUSP,Hus.FCONP,Hus.FELEP,Hus.FFSP,Hus.FFULP,Hus.FGASP,Hus.FHFLP,Hus.FINSP,Hus.FKITP,Hus.FMHP,Hus.FMRGIP,Hus.FMRGP,Hus.FMRGTP,Hus.FMRGXP,Hus.FPLMP,Hus.FRMSP,Hus.FRNTMP,Hus.FRNTP,Hus.FSMP,Hus.FSMXHP,Hus.FSMXSP,Hus.FTAXP,Hus.FTELP,Hus.FTENP,Hus.FVACSP,Hus.FVALP,Hus.FVEHP,Hus.FWATP,Hus.FYBLP,Hus.WGTP1,Hus.WGTP2,Hus.WGTP3,Hus.WGTP4,Hus.WGTP5,Hus.WGTP6,Hus.WGTP7,Hus.WGTP8,Hus.WGTP9,Hus.WGTP10,Hus.WGTP11,Hus.WGTP12,Hus.WGTP13,Hus.WGTP14,Hus.WGTP15,Hus.WGTP16,Hus.WGTP17,Hus.WGTP18,Hus.WGTP19,Hus.WGTP20,Hus.WGTP21,Hus.WGTP22,Hus.WGTP23,Hus.WGTP24,Hus.WGTP25,Hus.WGTP26,Hus.WGTP27,Hus.WGTP28,Hus.WGTP29,Hus.WGTP30,Hus.WGTP31,Hus.WGTP32,Hus.WGTP33,Hus.WGTP34,Hus.WGTP35,Hus.WGTP36,Hus.WGTP37,Hus.WGTP38,Hus.WGTP39,Hus.WGTP40,Hus.WGTP41,Hus.WGTP42,Hus.WGTP43,Hus.WGTP44,Hus.WGTP45,Hus.WGTP46,Hus.WGTP47,Hus.WGTP48,Hus.WGTP49,Hus.WGTP50,Hus.WGTP51,Hus.WGTP52,Hus.WGTP53,Hus.WGTP54,Hus.WGTP55,Hus.WGTP56,Hus.WGTP57,Hus.WGTP58,Hus.WGTP59,Hus.WGTP60,Hus.WGTP61,Hus.WGTP62,Hus.WGTP63,Hus.WGTP64,Hus.WGTP65,Hus.WGTP66,Hus.WGTP67,Hus.WGTP68,Hus.WGTP69,Hus.WGTP70,Hus.WGTP71,Hus.WGTP72,Hus.WGTP73,Hus.WGTP74,Hus.WGTP75,Hus.WGTP76,Hus.WGTP77,Hus.WGTP78,Hus.WGTP79,Hus.WGTP80 \n,Pus.RT,Pus.SPORDER,Pus.ST,Pus.ADJINC,Pus.PWGTP,Pus.AGEP,Pus.CIT,Pus.COW,Pus.DDRS,Pus.DEYE,Pus.DOUT,Pus.DPHY,Pus.DREM,Pus.ENG,Pus.FER,Pus.GCL,Pus.GCM,Pus.GCR,Pus.INTP,Pus.JWMNP,Pus.JWRIP,Pus.JWTR,Pus.LANX,Pus.MAR,Pus.MIG,Pus.MIL,Pus.MLPA,Pus.MLPB,Pus.MLPC,Pus.MLPD,Pus.MLPE,Pus.MLPF,Pus.MLPG,Pus.MLPH,Pus.MLPI,Pus.MLPJ,Pus.MLPK,Pus.NWAB,Pus.NWAV,Pus.NWLA,Pus.NWLK,Pus.NWRE,Pus.OIP,Pus.PAP,Pus.RETP,Pus.SCH,Pus.SCHG,Pus.SCHL,Pus.SEMP,Pus.SEX,Pus.SSIP,Pus.SSP,Pus.WAGP,Pus.WKHP,Pus.WKL,Pus.WKW,Pus.YOEP,Pus.ANC,Pus.ANC1P,Pus.ANC2P,Pus.DECADE,Pus.DRIVESP,Pus.ESP,Pus.ESR,Pus.HISP,Pus.INDP,Pus.JWAP,Pus.JWDP,Pus.LANP,Pus.MIGPUMA,Pus.MIGSP,Pus.MSP,Pus.NAICSP,Pus.NATIVITY,Pus.OC,Pus.PAOC,Pus.PERNP,Pus.PINCP,Pus.POBP,Pus.POVPIP,Pus.POWPUMA,Pus.POWSP,Pus.QTRBIR,Pus.RAC1P,Pus.RAC2P,Pus.RAC3P,Pus.RACAIAN,Pus.RACASN,Pus.RACBLK,Pus.RACNHPI,Pus.RACNUM,Pus.RACSOR,Pus.RACWHT,Pus.RC,Pus.SFN,Pus.SFR,Pus.VPS,Pus.WAOB,Pus.FAGEP,Pus.FANCP,Pus.FCITP,Pus.FCOWP,Pus.FDDRSP,Pus.FDEYEP,Pus.FDOUTP,Pus.FDPHYP,Pus.FDREMP,Pus.FENGP,Pus.FESRP,Pus.FFERP,Pus.FGCLP,Pus.FGCMP,Pus.FGCRP,Pus.FHISP,Pus.FINDP,Pus.FINTP,Pus.FJWDP,Pus.FJWMNP,Pus.FJWRIP,Pus.FJWTRP,Pus.FLANP,Pus.FLANXP,Pus.FMARP,Pus.FMIGP,Pus.FMIGSP,Pus.FMILPP,Pus.FMILSP,Pus.FOCCP,Pus.FOIP,Pus.FPAP,Pus.FPOBP,Pus.FPOWSP,Pus.FRACP,Pus.FRELP,Pus.FRETP,Pus.FSCHGP,Pus.FSCHLP,Pus.FSCHP,Pus.FSEMP,Pus.FSEXP,Pus.FSSIP,Pus.FSSP,Pus.FWAGP,Pus.FWKHP,Pus.FWKLP,Pus.FWKWP,Pus.FYOEP,Pus.PWGTP1,Pus.PWGTP2,Pus.PWGTP3,Pus.PWGTP4,Pus.PWGTP5,Pus.PWGTP6,Pus.PWGTP7,Pus.PWGTP8,Pus.PWGTP9,Pus.PWGTP10,Pus.PWGTP11,Pus.PWGTP12,Pus.PWGTP13,Pus.PWGTP14,Pus.PWGTP15,Pus.PWGTP16,Pus.PWGTP17,Pus.PWGTP18,Pus.PWGTP19,Pus.PWGTP20,Pus.PWGTP21,Pus.PWGTP22,Pus.PWGTP23,Pus.PWGTP24,Pus.PWGTP25,Pus.PWGTP26,Pus.PWGTP27,Pus.PWGTP28,Pus.PWGTP29,Pus.PWGTP30,Pus.PWGTP31,Pus.PWGTP32,Pus.PWGTP33,Pus.PWGTP34,Pus.PWGTP35,Pus.PWGTP36,Pus.PWGTP37,Pus.PWGTP38,Pus.PWGTP39,Pus.PWGTP40,Pus.PWGTP41,Pus.PWGTP42,Pus.PWGTP43,Pus.PWGTP44,Pus.PWGTP45,Pus.PWGTP46,Pus.PWGTP47,Pus.PWGTP48,Pus.PWGTP49,Pus.PWGTP50,Pus.PWGTP51,Pus.PWGTP52,Pus.PWGTP53,Pus.PWGTP54,Pus.PWGTP55,Pus.PWGTP56,Pus.PWGTP57,Pus.PWGTP58,Pus.PWGTP59,Pus.PWGTP60,Pus.PWGTP61,Pus.PWGTP62,Pus.PWGTP63,Pus.PWGTP64,Pus.PWGTP65,Pus.PWGTP66,Pus.PWGTP67,Pus.PWGTP68,Pus.PWGTP69,Pus.PWGTP70,Pus.PWGTP71,Pus.PWGTP72,Pus.PWGTP73,Pus.PWGTP74,Pus.PWGTP75,Pus.PWGTP76,Pus.PWGTP77,Pus.PWGTP78,Pus.PWGTP79,Pus.PWGTP80\n\nFROM \n\n    (select * FROM \n        (select serialnoId,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,KIT,MHP,MRGI,MRGP,MRGT,MRGX,RNTM,RNTP,SMP,TEL,TEN,VACS,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,LNGI,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP,FPLMP,FRMSP,FRNTMP,FRNTP,FSMP,FSMXHP,FSMXSP,FTAXP,FTELP,FTENP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80 from dbo.AcsBy320052007Hus\n        UNION ALL \n        select serialnoId,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,KIT,MHP,MRGI,MRGP,MRGT,MRGX,RNTM,RNTP,SMP,TEL,TEN,VACS,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,LNGI,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP, FPLMP,FRMSP,FRNTMP,FRNTP,FSMP,FSMXHP,FSMXSP,FTAXP,FTELP,FTENP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80 from dbo.AcsBy320082010Hus \n        ) AS Hus\n    )\n    INNER JOIN \n    (select * FROM \n        (\n        SELECT serialnoId,RT,SPORDER,PUMA,ST,ADJINC,PWGTP,AGEP,CIT,COW,DDRS,DEYE,DOUT,DPHY,DREM,ENG,FER,GCL,GCM,GCR,INTP,JWMNP,JWRIP,JWTR,LANX,MAR,MIG,MIL,MLPA,MLPB,MLPC,MLPD,MLPE,MLPF,MLPG,MLPH,MLPI,MLPJ,MLPK,NWAB,NWAV,NWLA,NWLK,NWRE,OIP,PAP,RETP,SCH,SCHG,SCHL,SEMP,SEX,SSIP,SSP,WAGP,WKHP,WKL,WKW,YOEP,ANC,ANC1P,ANC2P,DECADE,DRIVESP,ESP,ESR,HISP,INDP,JWAP,JWDP,LANP,MIGPUMA,MIGSP,MSP,NAICSP,NATIVITY,OC,PAOC,PERNP,PINCP,POBP,POVPIP,POWPUMA,POWSP,QTRBIR,RAC1P,RAC2P,RAC3P,RACAIAN,RACASN,RACBLK,RACNHPI,RACNUM,RACSOR,RACWHT,RC,SFN,SFR,VPS,WAOB,FAGEP,FANCP,FCITP,FCOWP,FDDRSP,FDEYEP,FDOUTP,FDPHYP,FDREMP,FENGP,FESRP,FFERP,FGCLP,FGCMP,FGCRP,FHISP,FINDP,FINTP,FJWDP,FJWMNP,FJWRIP,FJWTRP,FLANP,FLANXP,FMARP,FMIGP,FMIGSP,FMILPP,FMILSP,FOCCP,FOIP,FPAP,FPOBP,FPOWSP,FRACP,FRELP,FRETP,FSCHGP,FSCHLP,FSCHP,FSEMP,FSEXP,FSSIP,FSSP,FWAGP,FWKHP,FWKLP,FWKWP,FYOEP,PWGTP1,PWGTP2,PWGTP3,PWGTP4,PWGTP5,PWGTP6,PWGTP7,PWGTP8,PWGTP9,PWGTP10,PWGTP11,PWGTP12,PWGTP13,PWGTP14,PWGTP15,PWGTP16,PWGTP17,PWGTP18,PWGTP19,PWGTP20,PWGTP21,PWGTP22,PWGTP23,PWGTP24,PWGTP25,PWGTP26,PWGTP27,PWGTP28,PWGTP29,PWGTP30,PWGTP31,PWGTP32,PWGTP33,PWGTP34,PWGTP35,PWGTP36,PWGTP37,PWGTP38,PWGTP39,PWGTP40,PWGTP41,PWGTP42,PWGTP43,PWGTP44,PWGTP45,PWGTP46,PWGTP47,PWGTP48,PWGTP49,PWGTP50,PWGTP51,PWGTP52,PWGTP53,PWGTP54,PWGTP55,PWGTP56,PWGTP57,PWGTP58,PWGTP59,PWGTP60,PWGTP61,PWGTP62,PWGTP63,PWGTP64,PWGTP65,PWGTP66,PWGTP67,PWGTP68,PWGTP69,PWGTP70,PWGTP71,PWGTP72,PWGTP73,PWGTP74,PWGTP75,PWGTP76,PWGTP77,PWGTP78,PWGTP79,PWGTP80 FROM dbo.AcsBy320052007Pus\n        UNION ALL \n        select serialnoId,RT,SPORDER,PUMA,ST,ADJINC,PWGTP,AGEP,CIT,COW,DDRS,DEYE,DOUT,DPHY,DREM,ENG,FER,GCL,GCM,GCR,INTP,JWMNP,JWRIP,JWTR,LANX,MAR,MIG,MIL,MLPA,MLPB,MLPC,MLPD,MLPE,MLPF,MLPG,MLPH,MLPI,MLPJ,MLPK,NWAB,NWAV,NWLA,NWLK,NWRE,OIP,PAP,RETP,SCH,SCHG,SCHL,SEMP,SEX,SSIP,SSP,WAGP,WKHP,WKL,WKW,YOEP,ANC,ANC1P,ANC2P,DECADE,DRIVESP,ESP,ESR,HISP,INDP,JWAP,JWDP,LANP,MIGPUMA,MIGSP,MSP,NAICSP,NATIVITY,OC,PAOC,PERNP,PINCP,POBP,POVPIP,POWPUMA,POWSP,QTRBIR,RAC1P,RAC2P,RAC3P,RACAIAN,RACASN,RACBLK,RACNHPI,RACNUM,RACSOR,RACWHT,RC,SFN,SFR,VPS,WAOB,FAGEP,FANCP,FCITP,FCOWP,FDDRSP,FDEYEP,FDOUTP,FDPHYP,FDREMP,FENGP,FESRP,FFERP,FGCLP,FGCMP,FGCRP,FHISP,FINDP,FINTP,FJWDP,FJWMNP,FJWRIP,FJWTRP,FLANP,FLANXP,FMARP,FMIGP,FMIGSP,FMILPP,FMILSP,FOCCP,FOIP,FPAP,FPOBP,FPOWSP,FRACP,FRELP,FRETP,FSCHGP,FSCHLP,FSCHP,FSEMP,FSEXP,FSSIP,FSSP,FWAGP,FWKHP,FWKLP,FWKWP,FYOEP,PWGTP1,PWGTP2,PWGTP3,PWGTP4,PWGTP5,PWGTP6,PWGTP7,PWGTP8,PWGTP9,PWGTP10,PWGTP11,PWGTP12,PWGTP13,PWGTP14,PWGTP15,PWGTP16,PWGTP17,PWGTP18,PWGTP19,PWGTP20,PWGTP21,PWGTP22,PWGTP23,PWGTP24,PWGTP25,PWGTP26,PWGTP27,PWGTP28,PWGTP29,PWGTP30,PWGTP31,PWGTP32,PWGTP33,PWGTP34,PWGTP35,PWGTP36,PWGTP37,PWGTP38,PWGTP39,PWGTP40,PWGTP41,PWGTP42,PWGTP43,PWGTP44,PWGTP45,PWGTP46,PWGTP47,PWGTP48,PWGTP49,PWGTP50,PWGTP51,PWGTP52,PWGTP53,PWGTP54,PWGTP55,PWGTP56,PWGTP57,PWGTP58,PWGTP59,PWGTP60,PWGTP61,PWGTP62,PWGTP63,PWGTP64,PWGTP65,PWGTP66,PWGTP67,PWGTP68,PWGTP69,PWGTP70,PWGTP71,PWGTP72,PWGTP73,PWGTP74,PWGTP75,PWGTP76,PWGTP77,PWGTP78,PWGTP79,PWGTP80 FROM dbo.AcsBy320082010Pus\n        ) AS Pus\n    )\n\nOn Hus.SerialNoId = Pus.SerialNoId\n</code></pre>\n"},{"tags":["php","mysql","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":13146949,"title":"transpose using php after querying a database","body":"<p>I am using PHP to query a MYSQL database, and I am trying to output the data to an excel file.</p>\n\n<p>I have used phpexcel, csv, etc. With each i have successfully been able to output the data to an excel file, but I can't seem to transpose it in the excel (transpose- flip all columns into rows, and rows into columns)</p>\n\n<p>I can't find any tutorials to help me out.</p>\n\n<p>My question is, is there a way to use php to transpose those rows and columns from MYSQL and import them into an excel file?</p>\n\n<p>thanks!</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>exportMysqlToCsv($tablename,$tokenmain, $id);\nfunction exportMysqlToCsv($tablename,$tokenmain, $id, $filename = 'Results.csv'){\n    $sql_query = \"select * from $tablename where token=1\";\n\n  // Gets the data from the database\n   $result = mysql_query($sql_query);\n\n    $f = fopen('php://temp', 'wt');\n    $first = true;\n\n//trying to transpose the data \nfunction transpose($array) {\n    array_unshift($array, null);\n    return call_user_func_array('array_map', $array);}\n\n//inserting it into the excel file  \n  while ($row = mysql_fetch_assoc($result)) {\n\n        if ($first) {\n\n            fputcsv($f, array_keys($row));\n\n            $first = false;\n\n         }\n\n      fputcsv($f, $row);\n    }\n} //end while\n</code></pre>\n\n<p><strong>Database sample:</strong></p>\n\n<pre><code>=======================================\n|  Male/female  |    Favorite artist  |\n=====+========+===============+=======|\n|    F          | Britney Spears      |\n|-------------------------------------|\n</code></pre>\n\n<p><strong>What I want it to look like:</strong></p>\n\n<pre><code>=====================================\n|Question          |  Answer        |\n=====+========+===============+=====|\n|   Male/female    |   F            |\n|----+--------+---------------+-----|\n| Favorite artist  | Britney Spears |\n|----+--------+---------------+-----|\n</code></pre>\n\n<p><strong>HUGE NOTE:</strong> There is no changing the database/hardcoding out the array in php. I want it all dynamic and the database is going to stay the way it is </p>\n"},{"tags":["mysql","query","optimization","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13297974,"title":"Speed up insert query mysql","body":"<p>I want to insert about 10000 new rows to an existing table which contain 10000 rows already. \nI need to get the insert id for the query and to use that id in another function inside the loop as in the code below.</p>\n\n<pre><code>foreach($values as $val){\n  $sql = \"INSERT INTO wp_posts (`post_author`, `post_date`, `post_content`, `post_title`, `post_excerpt`, `post_status`,`post_modified`,`post_type`)\n  VALUES('\".$val[author].\"',NOW(),'\".$val[content].\"','\".$val[title].\"','\".$val[excerpt].\"','published',NOW(),'post')\";\n  $result = mysql_query($sql);\n  $insertid = mysql_insert_id();\n  add_post_meta($insertid, $val[metakey], $val[metaval], true );\n}\n</code></pre>\n\n<p>I am fetching the values for $values array from a CSV file. As of now, I can insert only 20 new rows per 3 minutes. \nIs there anyway to speed up this insertion?</p>\n"},{"tags":["sql","sql-server","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13241518,"title":"sql query including month columns?","body":"<p>I was wondering if I could get some ideas or direction on a sql query that would output column months. Here is my current query..</p>\n\n<pre><code>select A.assetid, A.Acquisition_Cost, B.modepreciaterate from FA00100 A\ninner join FA00200 B on A.assetindex = B.assetindex\nwhere MoDepreciateRate != '0'\n</code></pre>\n\n<p>I would like to add more columns that look as such:</p>\n\n<pre><code>select assetid, acquisition_cost, perdeprrate, Dec_2012, Jan_2013, Feb_2013....\n\nwhere Dec_2012 = (acquisition_cost - MoDepreciateRate*(# of months))\nand Jan_2013 = (acquisition_cost - MoDepreciateRate*(# of months))\n</code></pre>\n\n<p>where # of months can be changed.</p>\n\n<p>Any help would be really appreciated. Thank you!</p>\n\n<p>Here is an example of what I would like the output to be with '# of months' = 4</p>\n\n<pre><code>assetid SHRTNAME    Acquisition_Cost    perdeprrate Dec_2012    Jan_2013    Feb_2013    Mar_2013\nCS-013  GEH INTEG   17490.14            485.83      17004.31    16518.48    16032.65    15546.82\nCS-014  WEB BRD     14560               404.4507    14155.5493  13751.0986  13346.6479  12942.1972\n</code></pre>\n"},{"tags":["sql","query","coldfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13297652,"title":"Using BETWEEN on a varchar field not a numeric field?","body":"<p>I am using ColdFusion 8 and SQL Server 2008 R2.</p>\n\n<p>I am trying to query a column of values to get rows with a value within a range.  The column SHOULD be numeric, but it's not. It's setup as a varchar (by someone else). There are 100,000+ rows of data. Here's a FAKE sample of the data:</p>\n\n<pre><code>ID COLUMN\n1  1\n2  1.2 \n3  0.9 \n4  5 \n5  -6\n</code></pre>\n\n<p>My query looks like this:</p>\n\n<pre><code>select column\nfrom table\nwhere column between 1 and 2\n</code></pre>\n\n<p>This query won't run because the where statement's column is a varchar, and I get a conversion error, so I have to change the where statement to this:</p>\n\n<pre><code>where column between '1' and '2'\n</code></pre>\n\n<p>Now, when I run a query like this, it runs, but I don't get results. But I know that I should be seeing results, because I know that many of the values in the column field are within that range I am querying. </p>\n\n<p>I am wondering if I am seeing no results due to the field being a varchar and not a numeric. Might that be messing up my results?</p>\n\n<p>Also, we have 100,000+ records we are searching through, would there be a big performance hit by using a varchar field instead of a numeric field?</p>\n"},{"tags":["javascript","mysql","query","mongodb","mongoose"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13297632,"title":"what is the SQL equivalent of this mongoose query","body":"<pre><code>ProjectModel.find({projectName: 'name'}).sort({viewCount: -1}).limit(5).exec( \n    function(err, projects) {\n        ...\n    }\n);\n</code></pre>\n\n<p>Just trying to learn whats this query is doing. i believe it is searching for <code>viewCount</code> in a descending order and the result is limited to 5.</p>\n"},{"tags":["mysql","query","order","match","wildcard"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":225,"score":3,"question_id":10165181,"title":"Wildcard Match Against Query causes score to = 0 ( php / sql )","body":"<p>I am using a full text query with MySql version 5.0.45 and I am trying to optimize it for my needs. The score system was working fine, however because I have added a stemmer before the input now, I had to use a wildcard on the search term. The problem is that now a stemmed word will match but return a score of 0. (ie: \"restriction\" gets stemmed to \"restrict\" and will still get recognized as a match but with a score of 0)</p>\n\n<p>Here's the query:</p>\n\n<pre><code>$escaped_string = mysql_real_escape_string($string);\n$query = \"SELECT DISTINCT A1.item_ID, item, \n              4.0 * (match (`item_1`) against ('\". $escaped_string.\"*'))\n              + 3.5 * (match (`item_2`) against ('\".$escaped_string.\"*'))\n              + 3.0 * (match (`item_3`) against ('\".$escaped_string.\"*')) \n              + 2.5 * (match (`item_4`) against ('\".$escaped_string.\"*'))\n              + 1.5 * (match (`item_5`) against ('\".$escaped_string.\"*'))\n            as score\n          FROM Items A1 LEFT OUTER JOIN Inventory A2 ON A1.item_ID=A2.item_ID\n          WHERE MATCH(`item_1`, `item_2`,`item_3`,`item_4`,`item_5`) AGAINST ('\".$escaped_string.\"*' IN BOOLEAN MODE)\n          ORDER BY score DESC\n          LIMIT 200\";\n</code></pre>\n\n<p>The score calculates perfectly before when it's <code>('\".$escaped_string.\"'))</code> but not when you add the wildcard *. In both cases the matching works fine, the problem is that the score does not calculate if there is a wildcard.</p>\n\n<p>Any help on this would be appreciated! (I hope I'm doing this mostly right)</p>\n"},{"tags":["query","postgresql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13297491,"title":"ERROR: invalid reference to FROM-clause","body":"<p>I have the following SQL (PostgreSQL) query:</p>\n\n<pre><code>SELECT ff.*, fp.*\nFROM fibra ff, fibra fp\n\nJOIN cables cp ON fp.cable_id = cp.id\nLEFT OUTER JOIN terceiro  ced_pai ON ced_pai.id = cp.cedente_id\nLEFT OUTER JOIN terceiro tp ON tp.id = fp.terceiro_id\n\nJOIN cables cf ON ff.cable_id = cf.id\nLEFT OUTER JOIN terceiro ced_f ON ced_f.id = cf.cedente_id\nLEFT OUTER JOIN terceiro tf ON tf.id = ff.terceiro_id\n\nwhere ff.fibra_pai_id = fp.id \nAND ff.cable_id IN (8,9,10) \nAND fp.cable_id IN (8,9,10)\n</code></pre>\n\n<p>But it's giving me this error:</p>\n\n<pre><code>ERROR:  invalid reference to FROM-clause entry for table \"ff\"\nLINE 8:  JOIN cables cf ON ff.cable_id = cf.id\n           ^\nHINT:  There is an entry for table \"ff\", but it cannot be referenced from this part of the query.\n\n********** Error **********\n\nERROR: invalid reference to FROM-clause entry for table \"ff\"\nSQL state: 42P01\nHint: There is an entry for table \"ff\", but it cannot be referenced from this part of the query.\nCharacter: 261\n</code></pre>\n\n<p>Does anyone know what AM I doing wrong ?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13295323,"title":"sql query joining two columns with one","body":"<p>I have 2 tables in ms access 2010 as below  </p>\n\n<pre><code>USERS (u_id, u_name)\nLOAN (l_id, l_from[ref users.u_id], l_to[ref users.u_id], l_amount)\n\nUsers\n+------+--------+\n| u_id | u_name |\n+------+--------+ \n| 1    | abc    |\n| 2    | def    |\n+------+--------+\n\nLoan\n+-----+--------+------+----------+\n|l_id | l_from | l_to | l_amount |\n+-----+--------+------+----------+\n| 1   | 2      | 1    | 100      |\n| 2   | 2      | 1    | 100      |\n| 3   | 1      | 1    | 50       |\n+-----+--------+------+----------+\n</code></pre>\n\n<p>I want to select names instead of numbers(l_from &amp; l_to) from loan table</p>\n\n<pre><code>select\n  loan.l_id,\n  loan.l_from,\n  users.u_name user_from,\n  loan.l_to,\n  users.u_name as user_to,\n  loan.l_amount\nfrom loan, users\nwhere ???\n</code></pre>\n"},{"tags":["sql","query","sqlite","parsing"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13242543,"title":"Parsing simplified SQL queries with Perl into SQLite","body":"<p>I am trying to turn a \"simplified\" sql query into a working SQLite one to use against XnViews databases, meaning the database layout is at best suboptimal for what I'm trying to do AND I can't change anything about that.</p>\n\n<p>Example would be \"(cat_10 and cat_12) and (cat_5 or cat_7)\".</p>\n\n<p>This should be used against the table \"t3\", which has the fields \"if\" (fileID) and \"ic\" (categoryID).</p>\n\n<p>The entries look like this:</p>\n\n<pre><code>if, ic\n7, 10\n7, 12\n7, 4\n9, 10\n9, 12\n9, 5\n10, 10\n10, 12\n10, 7\n</code></pre>\n\n<p>The simplified query above should only select the files 9 and 10 as 7 does have the wanted categories 10 and 12 but has neither 5 nor 7.</p>\n\n<p>The actual problem now is building that hell of a query statement because it took me already some hours to simply get an AND between two categories working.</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\n</code></pre>\n\n<p>This gives me all fileIDs that contain category 10 and 12, but I have no idea how I should combine that with the remaining \" and (cat_5 or cat_7)\".</p>\n\n<p>When I planned these simplified sql statements (made by a click-it-together-builder made in html and js) I was planning to simply replace \"cat_5\" with \"t3.ic = 5\" and leave the rest as it is.</p>\n\n<p>Of course I didn't forsee that it wouldn't work as where checks the entry as a whole and there can't be ic = 5 AND ic = 7. That pretty much broke everything.</p>\n\n<p>So I'm wondering if anyone would have an idea how I could translate these simple queries in actual working ones, keeping in mind that it might not be limited to ( x and y ) pairs.</p>\n\n<p>Edit: I worked out how to do the example I've given, I think atleast:</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\nINTERSECT \nSELECT if FROM t3 WHERE ic IN (5, 7) GROUP BY if\n</code></pre>\n\n<p>But the main problem now is resolving the ( ) in the right order.</p>\n\n<p>Edit 2: I think I'm giving grouping the categories into one field with group_concat() a try, then I should be able to simply to cats LIKE \"  \" AND which would be small blocks I could easy throw together, then just the brackets and it should work. Highlighting the 'should'.</p>\n"},{"tags":["php","sql","query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13286725,"title":"how to use php variables in postgresql query","body":"<p>I have two php variables, one integer and other json, which I convert into string variable and then inserting them inside a postgresql database.</p>\n\n<p>Converting integer into string variable:</p>\n\n<pre><code>$string1 = (string)$integer;\n</code></pre>\n\n<p>Coneverting json from facebook api into string variable:</p>\n\n<pre><code>$string2 = json_encode($json);\n</code></pre>\n\n<p>Now, I have to insert these two string variables into postgres database:</p>\n\n<pre><code>$query = \"INSERT INTO interests VALUES(\". $string1 .\" ,\" . $string2 .\")\"; \npg_query($con, $query) or die(\"Cannot execute query: $query\\n\");\n</code></pre>\n\n<p>This is not working. I have tried a lot of solutions but still not working. </p>\n\n<p>I changed my function to insert into database</p>\n\n<pre><code>function push_interests(){\n$id = $facebook-&gt;getUser();\n$int = $facebook-&gt;api('/me/interests');     \n$host = \"hostname\"; \n$user = \"user\"; \n$pass = \"password\"; \n$db = \"database\"; \n\n$con = pg_connect(\"host=$host dbname=$db user=$user password=$pass\")\n    or die (\"Could not connect to server\\n\"); \n\n\n$id = (string)$id;\n$int = json_encode($int);\n\n$sql = \"INSERT INTO interests VALUES($1,$2)\"; \npg_prepare($con,'my_insert', $sql) or die (\"Cannot prepare statement1\\n\") ;\npg_execute($con,'my_insert', array($id,$int)) or die (\"Cannot execute statement1\\n\");\n\npg_close($con); \n\n}\n</code></pre>\n\n<p>Output is: cannot execute statement1\nI have created database as below:</p>\n\n<pre><code>$query = \"DROP TABLE IF EXISTS interests\"; \npg_query($con, $query) or die(\"Cannot execute query: $query\\n\");\n\n$query = \"CREATE TABLE interests(id VARCHAR(25) PRIMARY KEY, interests VARCHAR(500))\";  \npg_query($con, $query) or die(\"Cannot execute query: $query\\n\"); \n</code></pre>\n"},{"tags":["json","query","mongodb","rest","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13216304,"title":"Querying MongoDB with JSON / HTTP / REST Interface","body":"<p>I am building an ASP.Net web application and want to access data from MongoDB (remotely hosted). Any of my documents looks like this (have ensured index on Utc field);</p>\n\n<pre><code>{ \n   \"_id\" : { \"$oid\" : \"509501393e8785025c10bc21\" }, \n   \"Index\" : 1,\n   \"Url\" : \"http:...\", \n   \"CameraId\" : 123,  \n   \"Utc\" : { \"$date\" : 1351955858006 } \n}\n</code></pre>\n\n<p>Considering the performance on user end, I want to fetch this data at max speed. One option that i have tried is calling a local Web Service via JSON on Page.aspx which uses MongoDB C# driver to query documents between two Dates (Utc). That works but seems like using  web service adds some extra milliseconds in request/response cycle (request for single document using db.foo.findOne() is served in 1.3 seconds on average). Average number of documents in that collection is 50,000 which will increase up-to 30,00,000.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Am i right in saying that using web services adds some delay\n(millisecs) in request/response cycle ? (because MongoDB actually\ntakes few milliseconds to complete the query)</li>\n<li>Second Option is to use MongoDB's <a href=\"http://www.mongodb.org/display/DOCS/Http+Interface\" rel=\"nofollow\">HTTP / REST Interface</a>. That way i might avoid web services and directly query MongoDB. Here\ni need your opinion on,<br>\n<ul>\n<li>Is there a way to query MongoDB between two Dates using HTTP/REST ?,</li>\n<li>Is there a way to query MongoDB with '>' and '&lt;' conditions using HTTP/REST ?,</li>\n<li>How does it seem, accessing DB directly on Page.aspx with security point of view ?</li>\n</ul></li>\n<li>Any other querying alternative OR optimizations for above schema?</li>\n</ol>\n\n<p>My related question is <a href=\"http://stackoverflow.com/questions/13207217/having-large-number-of-collections-in-mongodb-need-schema-design-suggestions\">here</a>.</p>\n\n<p>Regards.</p>\n"},{"tags":["linq","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13296038,"title":"LINQ query does not \"see\" the values in array","body":"<p>here is my query</p>\n\n<pre><code>        var traj_of_user_2=\n        from num in trajectoryArray\n        where num.ID_User == 2\n        select num.ID_Traj;\n</code></pre>\n\n<p>when i run the program, an exception appears (see the image)</p>\n\n<p>what's the problem is your opinion? a friend of me told me that since the array is \"lazy\" there are no istances</p>\n\n<p><img src=\"http://i.stack.imgur.com/Y8ZIm.png\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","query","postgresql"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13285985,"title":"Recursive query (postgresql 9) - number of files in subfolders","body":"<p>I do have a table with list of files. There is id_folder, id_parrent_folder, size (file size):</p>\n\n<pre><code>create table sample_data (\n    id_folder bigint ,\n    id_parrent_folder bigint,\n    size bigint\n);\n</code></pre>\n\n<p>I would like to know, how many files are in every subfolder (including current folder) for each folder (starting wigh given folder). Given the samle data posted below I expect the following output:</p>\n\n<pre><code>id_folder     files\n100623           35\n100624           14\n</code></pre>\n\n<p>Sample data:</p>\n\n<pre><code>insert into sample_data values (100623,58091,60928);\ninsert into sample_data values (100623,58091,59904);\ninsert into sample_data values (100623,58091,54784);\ninsert into sample_data values (100623,58091,65024);\ninsert into sample_data values (100623,58091,25600);\ninsert into sample_data values (100623,58091,31744);\ninsert into sample_data values (100623,58091,27648);\ninsert into sample_data values (100623,58091,39424);\ninsert into sample_data values (100623,58091,30720);\ninsert into sample_data values (100623,58091,71168);\ninsert into sample_data values (100623,58091,68608);\ninsert into sample_data values (100623,58091,34304);\ninsert into sample_data values (100623,58091,46592);\ninsert into sample_data values (100623,58091,35328);\ninsert into sample_data values (100623,58091,29184);\ninsert into sample_data values (100623,58091,38912);\ninsert into sample_data values (100623,58091,38400);\ninsert into sample_data values (100623,58091,49152);\ninsert into sample_data values (100623,58091,14444);\ninsert into sample_data values (100623,58091,33792);\ninsert into sample_data values (100623,58091,14789);\ninsert into sample_data values (100624,100623,16873);\ninsert into sample_data values (100624,100623,32768);\ninsert into sample_data values (100624,100623,104920);\ninsert into sample_data values (100624,100623,105648);\ninsert into sample_data values (100624,100623,31744);\ninsert into sample_data values (100624,100623,16431);\ninsert into sample_data values (100624,100623,46592);\ninsert into sample_data values (100624,100623,28160);\ninsert into sample_data values (100624,100623,58650);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\n</code></pre>\n\n<p>I've tried to use example from postgresql (<a href=\"http://www.postgresql.org/docs/9.1/static/queries-with.html\" rel=\"nofollow\">postgresql docs</a>), but it (obviously) can't work this way. Any help appreciated.</p>\n\n<p>-- Edit</p>\n\n<p>I've tried the following query:</p>\n\n<pre><code>WITH RECURSIVE included_files(id_folder, parrent_folder, dist_last_change) AS (\nSELECT \n    id_folder, \n    id_parrent_folder, \n    size\nFROM \n    sample_data p \nWHERE \n    id_folder = 100623\nUNION ALL\nSELECT \n    p.id_folder, \n    p.id_parrent_folder, \n    p.size\nFROM \n    included_files if, \n    sample_data p\nWHERE \n    p.id_parrent_folder = if.id_folder\n)\nselect * from included_files\n</code></pre>\n\n<p>This won't work, because for every child there is a lot of parents and as a result rows in child folders are multiplied.</p>\n"},{"tags":["mysql","sql","query","explain"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13291062,"title":"Mysql: Large Query with subqueries optimization","body":"<p>Any query optimization gurus in the house??  </p>\n\n<p>Anyway, I trying to attach this on two fronts, one I'm trying to code a way around it but secondly, I'm thinking some real optimization might help in the short trem while we create a more complex, more robust fix.  So without further exposition, here's the query:</p>\n\n<pre><code>select \n      Date(events.start_time) as event_date, \n      if(transactions.type = 'BoxOfficeTransaction', \n         (select sales_outlets.name \n            from \n                  ticket_agents, \n                  sales_outlets \n            where \n                  transactions.ticket_agent_id = ticket_agents.id \n              and ticket_agents.sales_outlet_id = sales_outlets.id), \n         transactions.type) as location, \n      ticket_types.name as price_type, \n      ticket_types.price as cost, \n      if (transactions.type = 'WebTransaction', \n          ( select count(tickets.id) \n               from \n                  tickets, \n                  transactions, \n                  events, \n                  ticket_types \n               where \n                      tickets.transaction_id = transactions.id \n                  and tickets.event_id = events.id \n                  and tickets.ticket_type_id = ticket_types.id \n                  and transactions.type = 'WebTransaction' \n                  and ticket_types.name = price_type \n                  and Date(events.start_time) = event_date \n                  and tickets.status = 'active'), \n          ( select count(tickets.id) \n               from \n                  tickets, \n                  transactions, \n                  events, \n                  ticket_types, \n                  ticket_agents, \n                  sales_outlets \n               where \n                      tickets.transaction_id = transactions.id \n                  and tickets.event_id = events.id \n                  and tickets.ticket_type_id = ticket_types.id \n                  and transactions.ticket_agent_id = ticket_agents.id \n                  and ticket_agents.sales_outlet_id = sales_outlets.id \n                  and ticket_types.name = price_type \n                  and Date(events.start_time) = event_date \n                  and tickets.status = 'active' \n                  and sales_outlets.name = location) \n         ) as quantity, \n      ( select quantity * ticket_types.price) as value, \n      ( select tickets.purchase_price * quantity) as revenue \n   from \n      events, \n      transactions, \n      tickets, \n      ticket_types \n   where \n          transactions.event_id = events.id \n      and tickets.transaction_id = transactions.id \n      and tickets.ticket_type_id = ticket_types.id \n      and events.start_time &gt;= '2012-11-15 05:00:00' \n      and events.start_time &lt;= '2013-01-06 04:59:59' \n   group by \n      event_date, \n      location, \n      ticket_types.name\n</code></pre>\n\n<p>A doozy I know.  Here's the explain:</p>\n\n<pre><code>+----+--------------------+---------------+--------+-------------------------------------+-------------------+---------+---------------------------------------+------+-----------------------------------------------------------+\n| id | select_type        | table         | type   | possible_keys                       | key               | key_len | ref                                   | rows | Extra                                                     |\n+----+--------------------+---------------+--------+-------------------------------------+-------------------+---------+---------------------------------------+------+-----------------------------------------------------------+\n|  1 | PRIMARY            | events        | index  | PRIMARY,event_date                  | event_date        | 13      | NULL                                  |   53 | Using where; Using index; Using temporary; Using filesort |\n|  1 | PRIMARY            | transactions  | ref    | PRIMARY,event_id                    | event_id          | 5       | abg_dev.events.id                     |   23 | Using where                                               |\n|  1 | PRIMARY            | tickets       | ref    | trans_id,ticket_types_id            | trans_id          | 5       | abg_dev.transactions.id               |    2 | Using where                                               |\n|  1 | PRIMARY            | ticket_types  | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.ticket_type_id        |    1 |                                                           |\n|  4 | DEPENDENT SUBQUERY | sales_outlets | ref    | PRIMARY,sales_outlet_name           | sales_outlet_name | 767     | func                                  |    1 | Using where; Using index                                  |\n|  4 | DEPENDENT SUBQUERY | ticket_types  | ref    | PRIMARY,type_name,ticket_types_name | type_name         | 767     | func                                  |    4 | Using index                                               |\n|  4 | DEPENDENT SUBQUERY | tickets       | ref    | trans_id,ticket_types_id            | ticket_types_id   | 5       | abg_dev.ticket_types.id               |  441 | Using where                                               |\n|  4 | DEPENDENT SUBQUERY | events        | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.event_id              |    1 | Using where                                               |\n|  4 | DEPENDENT SUBQUERY | transactions  | eq_ref | PRIMARY,ticket_agent_id             | PRIMARY           | 4       | abg_dev.tickets.transaction_id        |    1 |                                                           |\n|  4 | DEPENDENT SUBQUERY | ticket_agents | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.transactions.ticket_agent_id  |    1 | Using where                                               |\n|  3 | DEPENDENT SUBQUERY | ticket_types  | ref    | PRIMARY,type_name,ticket_types_name | type_name         | 767     | func                                  |    4 | Using index                                               |\n|  3 | DEPENDENT SUBQUERY | tickets       | ref    | trans_id,ticket_types_id            | ticket_types_id   | 5       | abg_dev.ticket_types.id               |  441 | Using where                                               |\n|  3 | DEPENDENT SUBQUERY | transactions  | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.transaction_id        |    1 | Using where                                               |\n|  3 | DEPENDENT SUBQUERY | events        | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.event_id              |    1 | Using where                                               |\n|  2 | DEPENDENT SUBQUERY | ticket_agents | eq_ref | PRIMARY                             | PRIMARY           | 4       | transactions.ticket_agent_id          |    1 |                                                           |\n|  2 | DEPENDENT SUBQUERY | sales_outlets | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.ticket_agents.sales_outlet_id |    1 |                                                           |\n+----+--------------------+---------------+--------+-------------------------------------  +-------------------+---------+---------------------------------------+------+-----------------------------------------------------------+\n16 rows in set, 2 warnings (0.00 sec) \n</code></pre>\n\n<p>Indexes:</p>\n\n<pre><code>mysql&gt; show indexes from events;\n+--------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table  | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+--------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| events |          0 | PRIMARY    |            1 | id          | A         |          53 |     NULL | NULL   |      | BTREE      |         |               |\n| events |          1 | event_date |            1 | start_time  | A         |          53 |     NULL | NULL   | YES  | BTREE      |         |               |\n| events |          1 | event_date |            2 | id          | A         |          53 |     NULL | NULL   |      | BTREE      |         |               |\n+--------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; show indexes from transactions;\n+--------------+------------+---------------------+--------------+---------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table        | Non_unique | Key_name            | Seq_in_index | Column_name         | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+--------------+------------+---------------------+--------------+---------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| transactions |          0 | PRIMARY             |            1 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | ticket_agent_id     |            1 | ticket_agent_id     | A         |          41 |     NULL | NULL   | YES  | BTREE      |         |               |\n| transactions |          1 | ticket_agent_id     |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | user_id             |            1 | user_id             | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | user_id             |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | payment_method_type |            1 | payment_method_type | A         |           5 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | payment_method_type |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at          |            1 | created_at          | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at          |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at_by_user  |            1 | created_at          | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at_by_user  |            2 | user_id             | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | event_id            |            1 | event_id            | A         |          55 |     NULL | NULL   | YES  | BTREE      |         |               |\n| transactions |          1 | event_id            |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n+--------------+------------+---------------------+--------------+---------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n13 rows in set (0.00 sec)\n\nmysql&gt; show indexes from tickets;\n+---------+------------+-----------------+--------------+----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table   | Non_unique | Key_name        | Seq_in_index | Column_name    | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+---------+------------+-----------------+--------------+----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| tickets |          0 | PRIMARY         |            1 | id             | A         |        4330 |     NULL | NULL   |      | BTREE      |         |               |\n| tickets |          0 | barcode_index   |            1 | barcode        | A         |        4330 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tickets |          1 | trans_id        |            1 | transaction_id | A         |        2165 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tickets |          1 | trans_id        |            2 | id             | A         |        4330 |     NULL | NULL   |      | BTREE      |         |               |\n| tickets |          1 | ticket_types_id |            1 | ticket_type_id | A         |           9 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tickets |          1 | ticket_types_id |            2 | id             | A         |        4330 |     NULL | NULL   |      | BTREE      |         |               |\n+---------+------------+-----------------+--------------+----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n6 rows in set (0.00 sec)\n\nmysql&gt; show indexes from sales_outlets;\n+---------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table         | Non_unique | Key_name          | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+---------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| sales_outlets |          0 | PRIMARY           |            1 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| sales_outlets |          1 | sales_outlet_name |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| sales_outlets |          1 | sales_outlet_name |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n+---------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; show indexes from ticket_types;\n+--------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table        | Non_unique | Key_name          | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+--------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| ticket_types |          0 | PRIMARY           |            1 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | type_name         |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | type_name         |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | price             |            1 | price       | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | price             |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | ticket_types_name |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | ticket_types_name |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n+--------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n7 rows in set (0.00 sec)\n</code></pre>\n\n<p>Transactions is about 3000 rows\nTickets is about 6000 rows\nSales Outlets is 3 rows\nTicket_types is 18 rows</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","sql","arrays","query","variables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13295163,"title":"Store data in PHP Array from Query","body":"<p>I would like to store this data in a variable line by line.  I already have the query written and this is what it returns.  Some are missing because there were 0 results.  But I would like to account for those, too.</p>\n\n<pre><code>    total   unique  uristem\n\n    1665    320     /Run\n    2103    845     /Add\n    5114    267     /Download\n    2576    720     /Time\n    8246    1252    /RunBegin\n    856     257     /Edit\n    1226    369     /Open\n</code></pre>\n\n<p>I want each one to look something like this:</p>\n\n<pre><code>Array\n(\n    [a] =&gt; 1665\n    [b] =&gt; 320\n    [c] =&gt; /Run\n)\n\nArray\n(\n    [a] =&gt; 2103\n    [b] =&gt; 845\n    [c] =&gt; /Add\n)\n</code></pre>\n\n<p>I'm thinking of storing this output in a temporary file and then parsing through it.  Any ideas?</p>\n\n<p>Thanks!</p>\n\n<p>--</p>\n"},{"tags":["query","syntax","mongoid","multiple-conditions"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13294860,"title":"Using a combination of ANDs and ORs in Mongoid","body":"<p>I'd like to construct a query of the form:</p>\n\n<pre><code>select * from some_table\nwhere \n  (field1 = 'x' or field2 = 'y') \n  and \n  (field3 = 'z' or field4 = 'w')\n</code></pre>\n\n<p>From reading the docs, I thought it should look something like this in <code>Mongoid</code>:</p>\n\n<pre><code>SomeTable.or({:field1 =&gt; 'x'}, {:field2 =&gt; 'y'})\n         .and  #  or is it .intersect?\n         .or({:field3 =&gt; 'z'}, {:field4 =&gt; 'w'})\n</code></pre>\n\n<p>But then that doesn't work - the mongo selector is simply an \"$or\" of all the fields. What's the correct way to do this? thanks.</p>\n\n<p>I'd also appreciate the inverse of that, e.g - how to perform this query:</p>\n\n<pre><code>select * from some_table\nwhere \n  (field1 = 'x' and field2 = 'y') \n  or\n  (field3 = 'z' and field4 = 'w') \n</code></pre>\n"},{"tags":["sql","sql-server","query","sql-server-2005","split"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13291954,"title":"SQL Query to split shipping cost over multiple items / rows","body":"<p>I am trying to create a query that will allow me to split a single figure over multiple rows.</p>\n\n<p>For example, purchase order x may have 15 items allocated to it.  Shipping cost is, say, 9.95.  How can I calculate 1/15th of 9.95 and then update the cost price of the stock with 1/15th of the shipping cost?</p>\n\n<p>Therefore the cost price of the item would increase from 4.50 to 5.16 (4.50 + 0.66).</p>\n"},{"tags":["mysql","query","select","max","min"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13293778,"title":"MySQL MIN/MAX all row","body":"<p>I have table <code>Races</code> with the rows <code>ID</code>, <code>Name</code> and <code>TotalCP</code> . I SELECT MIN( <code>TotalCP</code> ) FROM <code>Races</code>, but then I want to select the entire row which have the minimum value. How I can make that, in a single query ?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13292691,"title":"SQL Query to find unique count","body":"<p>Here's a little bit of background.  I have a database like this:</p>\n\n<pre><code>    uristem       username\n  +------------+  +-------+\n  | /uristem/1 |  | user1 |\n  | /uristem/2 |  | user2 |\n  | /uristem/3 |  | user3 |\n  | /uristem/3 |  | user4 |\n  | /uristem/1 |  | user1 |\n  | /uristem/7 |  | user5 |\n  | /uristem/5 |  | user3 |\n  | /uristem/5 |  | user1 |\n  | /uristem/3 |  | user1 |\n  +------------+  +-------+\n</code></pre>\n\n<p>I need to count the number of (<strong>unique</strong>) users that hit <code>/uristem/3</code>.  What operators can I use in a query to do this?</p>\n\n<p>Your help is greatly appreciated,</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13293249,"title":"My SQL JOIN query returning No results","body":"<pre><code>SELECT 'nmc_cd.CDID','nmc_cd.CDTitle', 'nmc_cd.CDYear','nmc_cd.pubID','nmc_cd.catID','nmc_cd.CDPrice','nmc_category.catDesc'\nFrom nmc_cd\nJOIN nmc_category\nON 'nmc_cd.catID'='nmc_category.catID'\nORDER BY CDTitle\n</code></pre>\n\n<p>Ive been putting this query into mySQL to try and get a table with results from ncm_CD and nmc_category but it keeps retuning no value?? also if i use a right or left join it is returning the Column name (e.g. nmc_cd.CDJD)</p>\n"},{"tags":["mysql","query","search"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13285105,"title":"Mysql search based on user weightage","body":"<p>I want to make a search based on user weightage, forxample...</p>\n\n<p>i have following search parameters...<br>\nLocation<br>\nAge<br>\nGender<br>\nSexual-Orientation<br>\nMarital-status<br>\nand few others...<br>\n<br>\nrequirement is to add the weightage for each parameter, like if user sets weightage as...<br>\nlocation weightage to 10<br>\ngender to 5<br>\nage to 3<br>\n<br>\nthen search results should be more relevant to location less to gender and even lesser to age.<br>\n<br>\ni dont know how to do that!!! kindly tell me how is this possible using mysql.<br></p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13292715,"title":"SQL query between statement","body":"<p>I have a problem using mySQL with my PHP admin and have a problem querying my DB\nThis is the query statement:</p>\n\n<pre><code>SELECT Record_ID, Datalog_ID, TIME, AVG( Value ) \nFROM  `Datalog_Values` \nWHERE Datalog_ID =  '241'\nAND TIME\nBETWEEN  '2012-06-01'\nAND  '2012-06-30'\nGROUP BY HOUR( TIME ) \n</code></pre>\n\n<p>The result i am getting is only the results from the first day and not the period.i.e. the month.</p>\n\n<p>what is wrong with my statement????</p>\n"},{"tags":["sql","sql-server","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13292631,"title":"Database query to handle when specific rows don't exist","body":"<p>Sorry for the bad title, it is hard to explain in one sentence what I am having problems with. So I have a stats database for basketball. What I am trying to do is group the stats for one team in one row then group all the stats this team played against in one other row. What I have now works if there are opponent stats in the database, but it is possible to not have opponent stats and just have the team stats. Hard to explain why, so please just go with that.</p>\n\n<p>So lets say I have 3 rows like this:</p>\n\n<pre><code>COMP_ID | TEAM_ID | OFF_REB | DEF_REB\n  1     |  100   |   5     |    4\n  2     |  100   |   1     |    1\n  3     |  100   |   3     |    7\n</code></pre>\n\n<p>Basically, there are 3 games, and I only have team 100's stats. I would like to get all of the OFF and DEF rebounds for team 100 in a row and then all of the opponent OFF and DEF rebounds in another row. If there are no opponent stats, just 0's will be fine.</p>\n\n<p>FYI - What I do now is do a group by to package the team 100's stats together and also to package the opponent stats together. For the TEAM_ID of the opponent stats, I group them into -999 value so I know they are opponent values.</p>\n\n<p>Here is the query I have now:</p>\n\n<pre><code>SELECT CASE WHEN TEAM_ID &lt;&gt; 100 THEN -999 ELSE 100 END AS TEAM_ID, SUM(OFF_REB+DEF_REB) REBS\nFROM V_STATS_COMP\nWHERE COMP_ID IN (SELECT COMP_ID FROM COMPETITIONS WHERE HOME_ID = 100 OR VIS_ID = 100)\nGROUP BY CASE WHEN TEAM_ID &lt;&gt; 100 THEN -999 ELSE 100 END\nORDER BY TEAM_ID\n</code></pre>\n\n<p>With this query, I get only 1 row back and thats for team 100. How do I adjust it to get the -999 row even if there are no stats available?</p>\n\n<p>Edit to show desired results: </p>\n\n<pre><code>TEAM_ID | REBS\n  100   |  21\n -999   |  0\n</code></pre>\n\n<p>Of course if there were opponent stats, id like to see their REBS value.</p>\n"},{"tags":["mysql","query","count","union","result"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13291873,"title":"MYSQL union query lookup another table?","body":"<p>I have a query (below) that will check for a match in 3 tables. All 3 tables have the columns UID and IPADDRESS; the third table also has USERNAME. How can I change the query below to populate the variable $username with a unique list of usernames that matched the ipaddress?</p>\n\n<p>So in each of the tables UID where the ipaddress matched could be say 2, 3, 6, 6, 23, 2, 6 because there are multiple entries and someone may have spoofed others ip's. What i'd like is the query to populate $username with the usernames that match the UIDs 2, 3, 6, 23 (unique list). I have to tell you I'm completely new to MySQL and queries. Here's the query:</p>\n\n<pre><code>error_reporting(E_ALL &amp; ~E_NOTICE &amp; ~8192);\n$UAM = strtoupper($_SERVER['HTTP_USER_AGENT']);\n$ips = strtoupper($_SERVER['REMOTE_ADDR']);\n\n$myquery= \"select sum(total)\nFROM (SELECT count(*) as total,userid\n      FROM \" .TABLE_PREFIX.\"memberviews v\n      where v.ipaddress = '$ips'\n      union all\n      SELECT count(*) as total,userid\n      FROM \" .TABLE_PREFIX.\"membervisits v1\n      where v1.ipaddress = '$ips'\n      union all\n      SELECT count(*) as total,userid\n      FROM \" .TABLE_PREFIX.\"user v3\n      where v3.ipaddress = '$ips'\n      )src\";\n\n$result = mysql_query($myquery);\n$rowCount = mysql_num_rows($myquery);\n$row = mysql_fetch_array($myquery);\n$username = $row['userid'];\n\n    If($rowCount !=0){\n      $fp = fopen(\"logtext.txt\", \"a\");\n$DateOfRequest = date('m-d-Y H:i:s');\nfwrite($fp, \"Registration Attempt\\n\\nDate: . $DateOfRequest . \\nMatched Member: . $username . \\nWith User Agent:  . $UAM . \\nIP: . $ips . \\n\\n\");\n    }\nmysql_free_result($myquery);\n</code></pre>\n\n<p>Currently the query works in as much as it writes the file. All help appreciated :)</p>\n"},{"tags":["query","couchdb","range"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13216640,"title":"CouchDB: getting number of keys in given key range","body":"<p>In my CouchDB database, all keys have the form \"A_xxxxxxxx\" where xxxxxxxx is zero-padded decimal number (e.g. \"A_00000001\" or \"A_12345678\")</p>\n\n<p>I want to get only <em>the number of keys</em> in a given key range.</p>\n\n<p>For example, to get the keys from A_10000000 to A_30000000, I can query something like:</p>\n\n<pre><code>GET DATABASE/_all_docs?startkey=\"A_00001000\"&amp;endkey=\"A_30000000\"&amp;include_docs=false\n</code></pre>\n\n<p>But the result contains all keys, and I need to count the elements in \"docs\" field of the output.</p>\n\n<p>Since the number of keys in my query will be huge, and all I want to know is the number of keys, not the actual list of the keys.</p>\n\n<p>The range start and range end value can be vary, which is not fixed.</p>\n\n<p>Is is possible to get only the number of keys of the given range, without retrieving actual key list?</p>\n\n<p>Thanks,</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13282765,"title":"Displaying results from multiple tables SQL/PHP","body":"<p>I currently have a database with 12 tables. I am doing a php query to pull the information from the database but I am not getting anything displayed. The query alone bridges all the tables starting with table <code>schedule</code> that have a foreign key related. Should I need to start the query from the table <code>class</code> and bridge with other tables?</p>\n\n<p><a href=\"http://webprolearner.ueuo.com/class_des/table_structure.php\" rel=\"nofollow\">TABLE DESIGN- PICTURE</a></p>\n\n<p>If you like to duplicate my design- <a href=\"http://webprolearner.ueuo.com/class_des/query_create.php\" rel=\"nofollow\">QUERY</a></p>\n\n<pre><code>$query = (\"SELECT  class_name, class_caption, class_credit_hours, class_description\n                FROM schedule \n                INNER JOIN section \n                ON class.id = section.class_id\n                INNER JOIN faculty\n                ON faculty.id = section.faculty_id\n                INNER JOIN faculty\n                ON faculty.id = office_hours.faculty_id\n                INNER JOIN faculty_titles\n                ON faculty_titles.faculty_id = faculty.id\n                INNER JOIN faculty_education\n                ON faculty_education.faculty_id = faculty.id \n                INNER JOIN section\n                ON section.faculty_id = faculty.id \n                INNER JOIN class\n                ON class.id = section.class_id\n                INNER JOIN major_class_br\n                ON major_class_br.class_id = class.id\n                INNER JOIN  major_minor \n                ON major_class_br.major_minor_id = major_minor.id                \n                 \");\n      //execute query\n      $result = mysql_query($query);\n\n     if ($result){\n\n    $totalhours = 0;\n\n    while ($row = mysql_fetch_assoc( $result ))\n    {  \n        print \"&lt;b&gt;\" . $row['class_name'] . \"&lt;/b&gt;&lt;br&gt;\";\n        print $row['class_caption'] . \"&lt;br&gt;\";\n        print $row['class_description'] . \"&lt;br&gt;\";\n        print $row ['class_credit_hours'] . \"hrs. &lt;br&gt;\";\n        print \"------------------------------&lt;br /&gt;\";\n        $totalhours += $row['class_credit_hours']; \n    }   \n    }\n</code></pre>\n\n<p><a href=\"http://sqlfiddle.com/#!2/28c29/2\" rel=\"nofollow\">SQL fiddle query</a></p>\n"},{"tags":["query","rally","description","testcase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13292665,"title":"rally : how to get \"description\" attribute of a testcase from testcaseresult","body":"<p>I am querying for a testcaseresult and I want to print the \"name\" and \"description\" attributes of testcase, this testcaseresult belongs to. So I am using the following code to make a query.</p>\n\n<pre><code>var queryObject = {\n                        type : 'TestCaseResult',\n                        key : 'tcresults',\n                        fetch: 'Build,Name,TestSet,Verdict,TestCase,Date'\n                    };\n</code></pre>\n\n<p>From this query, I can get TestCase.Name ,but not TestCase.Description.\nDo I have to do a separate query for the testcase to access \"Description\" or is there something I am missing over here? Thanks.</p>\n"},{"tags":["c#","query","add-in","document"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13290800,"title":"How to get SQL Command text from Query Document in Visual Studio?","body":"<p>I am building a Visual Studio add-in and what I want to do is get the text of an SQL Command in a Query Document.\nFor example:</p>\n\n<ul>\n<li>A user opens Server Explorer and connects to a database</li>\n<li>He executes a 'New Query' command</li>\n<li>A new Query Document opens (Query visualiser or whatever you want to call it)</li>\n<li>He selects some columns in the Table visualiser panel and a code is generated in a Command  text panel</li>\n</ul>\n\n<p>What I want to do is to be able to get the generated text. I tried using the code suggested as a solution to similar issues, that I've found here, but it doesn't seem to work for me. The code I used is:</p>\n\n<pre><code>TextSelection s = (TextSelection)dte.ActiveDocument.Selection;\nTextDocument d = (TextDocument)dte.ActiveDocument.Object(\"TextDocument\");\n</code></pre>\n\n<p>This does not work because in the first case Selection is always null and in the second one Object is always null. This part of code only works if an open document is a .txt or file. I tried to find a class similar to QueryDocument or Query, but I failed.</p>\n\n<p>Do you have any suggestions? </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13289214,"title":"consecutive dates and appointments in sql","body":"<p>I've got a sql table that holds engineer, appt_date and appt_slot. </p>\n\n<pre><code>engineer_id, visit_date, visit_slot\n\n1,           20/10/12,   All Day\n1,           21/10/12,   AM\n2,           20/10/12,   All Day\n2,           21/10/12,   All Day\n2,           22/10/12,   All Day\n3,           20/10/12,   PM\n3,           21/10/12,   All Day\n3,           22/10/12,   PM\n</code></pre>\n\n<p>What I'd like to show is</p>\n\n<pre><code>Engineer_id, start_visit,      end_visit\n\n1,           20/10/12 All Day, 21/10/12 AM\n2,           20/10/12 All Day, 22/10/12 All Day\n3,           20/10/12 PM,      21/10/12 All Day\n3,           22/10/12 PM,      22/10/12 PM\n</code></pre>\n\n<p>I'm struggling with the sql to show the breaks in the bookings, any help would be greatly appreciated.\nThanks</p>\n"},{"tags":["query","lucene.net","term"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273718,"title":"Lucene.net query for contains and avoiding empty string fields","body":"<p>I have a Lucene index setup which I can query fine. I just am not able to get a \"field not equals to empty string\" condition to work. For example in the below code specimen, I want to have 3 conditions </p>\n\n<ol>\n<li>Where \"country tag\" field contains \"{4ED2F7EE-5C2A-418C-B2F6-236F94166BA1}\".</li>\n<li>Where \"country tag\" field is not empty string.</li>\n<li><p>Where \"date\" range is between \"20110101T000000\" and \"20121001T000000\".</p>\n\n<pre><code>    WildcardQuery taggingQuery = new WildcardQuery(new Term(\"country tag\", \"*\" + ShortID.Encode(\"{4ED2F7EE-5C2A-418C-B2F6-236F94166BA1}\").ToLowerInvariant() + \"*\"));\n    TermQuery taggingNotQuery = new Term(\"country tag\", \" \"));\n\n    RangeQuery rangeQuery = new RangeQuery(new Term(\"date\", \"20110101T000000\"), new Term(\"date\", \"20121001T000000\"), true);\n\n    BooleanQuery booleanQuery = new BooleanQuery();\n    booleanQuery.Add(taggingQuery, BooleanClause.Occur.MUST);\n    booleanQuery.Add(taggingNotQuery, BooleanClause.Occur.MUST_NOT);\n    booleanQuery.Add(rangeQuery, BooleanClause.Occur.MUST);\n</code></pre></li>\n</ol>\n\n<p>I have a feeling I am doing this wrong or my query is wrong somehow. I should not need a condition where I should have to look out for empty or null fields.</p>\n\n<p>Any help is appreciated!</p>\n"},{"tags":["php","mysql","forms","query","iterate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13290680,"title":"Assign variables to a MySQL iterative result set","body":"<p>StackOverflow,</p>\n\n<pre><code>$resultpaid = $mysqli-&gt;query($paidquery);\nwhile ($row=$resultpaid-&gt;fetch_array()) \n{\n  print $row['paid'] .'&lt;br /&gt;';\n}\n</code></pre>\n\n<p>I realize this should be simple, unfortunately, I'm not well versed in PHP.  I'm trying to take the result set from this while loop and assign them to variables.  Basically right now it finds two rows, both with integer values.  So when it iterates through, it prints out 250 and 260.  I'm trying to figure out if there's a way to assign each row a variable in order to add the integers together, or reference them individually at a certain point.  </p>\n"},{"tags":["php","mysql","query","join"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":8,"view_count":25,"score":-7,"question_id":13290733,"title":"How is the speed factor on joining two tables with 10000 rows each and then fetching 100 rows in alphabetic order?","body":"<p>This is a Scalability question.</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13289571,"title":"check at least a record exists","body":"<p>two tables:</p>\n\n<pre><code>== customers ==\ncust_id\n\n== attachments ==\natt_id\ncust_id\n</code></pre>\n\n<p>1 customer -> MANY attachments</p>\n\n<p>i would retrieve all the custmers and, adding the boolean virtual field \"has_attach\" to select, know if a customer have got attachments.</p>\n\n<p>without GROUP BY, if this is possibile :-)</p>\n"},{"tags":["mysql","query","strip-tags"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":685,"score":1,"question_id":7654436,"title":"What is the MYSQL query equivalent of PHP strip_tags?","body":"<p>I have a large database which contains records that have  tags in them and i would like to remove them. Of course there is the method where i create a php script that selects all ... strip_tags a update the database, but this takes a loong time. So how can I do this whit a simple (or complicated) Mysql query? Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","query","activerecord","random"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13289352,"title":"Rails Active Record Query - find random record that meets a condition","body":"<p>I have a model from which I want to pull a random record that meets a certain criteria. For example: give me a random record from table Thing where column_name = true.</p>\n\n<p>To get a random record from the model I can do the following:</p>\n\n<pre><code>Thing.offset(rand(Thing.count)).first\n</code></pre>\n\n<p>and I want to combine that with the query:</p>\n\n<pre><code>Thing.where(\"column_name = ?\", true).all\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<pre><code>counter = Thing.where(\"column_name = ?\", true).count\nThing.where(\"column_name = ?\", true).offset(rand(counter)).first\n</code></pre>\n\n<p>Any ideas on how to write this query would be greatly appreciated.</p>\n"},{"tags":["mysql","sql","database","query","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":39,"score":4,"question_id":13288764,"title":"Nested queries (dependent queries)","body":"<p>I need to store a family (i.e. some childs of a parent. Those childs have their own childs and so on..)</p>\n\n<p>So, I created a table family that has following structure</p>\n\n<blockquote>\n  <p>id&nbsp;&nbsp;&nbsp;&nbsp;child&nbsp;&nbsp;&nbsp;&nbsp;child_id&nbsp;&nbsp;&nbsp;&nbsp;parent_id</p>\n</blockquote>\n\n<p>When I save a child, I store a parent_id along with it.</p>\n\n<p>Now,</p>\n\n<p>when I want to fetch all childs of given parent, I can easily do.</p>\n\n<pre><code>select child_id from family where parent_id = &lt;given parent id&gt;\n</code></pre>\n\n<p>But, </p>\n\n<p>now I want to fetch the complete family (all descendants of a given parent)</p>\n\n<p>i.e.</p>\n\n<p>I want to fetch all childs which have a given parent_id + all childs that are childs of fetched childs in first query and so on.</p>\n\n<p>Can somebody help me ?</p>\n\n<p>I also, thing there could be better way to store the data initially, so I can fetch it later. Can somebody point out a better way ?</p>\n"},{"tags":["query","hadoop","hive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13289436,"title":"Multiple insert overwrite into multiple tables query stores same results in all temp tables","body":"<p>I am doing a query with multiple INSERT OVERWRITE to multiple tables, in order to scan the\ndataset only 1 time, and i end up having all these tables with the same content ! It seems\nthe GROUP BY query that returns results is overwriting all the temp tables.</p>\n\n<p>This is the misbehaving query:</p>\n\n<pre><code>FROM nikon\nINSERT OVERWRITE TABLE e1\nSELECT qs_cs_s_aid AS Emplacements, COUNT(*) AS Impressions\nWHERE qs_cs_s_cat='PRINT' GROUP BY qs_cs_s_aid\nINSERT OVERWRITE TABLE e2\nSELECT qs_cs_s_aid AS Emplacements, COUNT(*) AS Vues\nWHERE qs_cs_s_cat='VIEW' GROUP BY qs_cs_s_aid\n;\n</code></pre>\n\n<p>It launches only one MR job and here are the results. Why does table 'e1' contains results\nfrom table 'e2' ?! Table 'e1' should have been empty (see individual SELECTs further below)</p>\n\n<pre><code>hive&gt; SELECT * from e1;\nOK\nNULL    2\n1627575 25\n1627576 70\n1690950 22\n1690952 42\n1696705 199\n1696706 66\n1696730 229\n1696759 85\n1696893 218\nTime taken: 0.229 seconds\n\nhive&gt; SELECT * from e2;\nOK\nNULL    2\n1627575 25\n1627576 70\n1690950 22\n1690952 42\n1696705 199\n1696706 66\n1696730 229\n1696759 85\n1696893 218\nTime taken: 0.11 seconds\n</code></pre>\n\n<p>Here is are the result to the indiviual queries (only the second query returns a result set):</p>\n\n<pre><code>hive&gt; SELECT qs_cs_s_aid AS Emplacements, COUNT(*) AS Impressions FROM nikon\nWHERE qs_cs_s_cat='PRINT' GROUP BY qs_cs_s_aid;\n(...)\nOK\n      &lt;- There are no results, this is normal\nTime taken: 41.471 seconds\n\nhive&gt; SELECT qs_cs_s_aid AS Emplacements, COUNT(*) AS Vues FROM nikon\nWHERE qs_cs_s_cat='VIEW' GROUP BY qs_cs_s_aid;\n(...)\nOK\nNULL  2\n1627575 25\n1627576 70\n1690950 22\n1690952 42\n1696705 199\n1696706 66\n1696730 229\n1696759 85\n1696893 218\nTime taken: 39.607 seconds\n</code></pre>\n"},{"tags":["php","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13282835,"title":"special character is giving null value","body":"<p>I am having 1 database.In that I am having one tabel.\n  I am doing json parsing in this code.<br>\n  I have used this php code for retrieving value:</p>\n\n<pre><code>&lt;head&gt;\n&lt;style type=\"text/css\"&gt;\n.auto-style1 {\n    text-align: right;\n}\n&lt;/style&gt;\n&lt;/head&gt;\n\n&lt;?php\n\necho getdata($_REQUEST['lastupdate']);\n\nfunction getdata($lastupdatedate){\n\n\n    $obj = json_decode($json);\n\n\n\n    $con = mysql_connect(\"localhost\",\"root\",\"Password\");\n\n\n    if (!$con)\n    {\n        die('Could not connect: ' . mysql_error());\n    }\n    mysql_select_db(\"roster\", $con);\n\n    $query = \"select * from statedeathtax_v2 where LastUpdated &gt; '\".$lastupdatedate.\"' order by LastUpdated\";\n\n    $rs = mysql_query($query) or die($query);\n\n    //print_r($rs);\n\n    while($row=mysql_fetch_assoc($rs)){\n\n    $record[] = $row;\n\n    }\n\n\n\n    $data = json_encode($record);\n\n\n\n    header('Cache-Control: no-cache, must-revalidate');\n\n    header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');\n\n    header('Content-type: application/json');\n\n    return $data;\n\n}\n\n?&gt;\n</code></pre>\n\n<p>Here this code is not displaying special characters like \"$\".\n  When I am throwing query in this code,it showing null values for the columns which is having special characters.\nI am not getting the issue.</p>\n"},{"tags":["mysql","query","unicode"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13287145,"title":"MySQL: Querying for unicode entities","body":"<p>I need to find the word <strong>Lämmönmyyntipalvelut</strong> from the database. Only, in the database it is in a field, whose value has been a PHP array, converted into JSON using json_encode() and so the special characters are scrabled into hex unicode.</p>\n\n<p>So my query is</p>\n\n<pre><code>SELECT * FROM table WHERE (services LIKE '%Lämmönmyyntipalvelut%')\n</code></pre>\n\n<p>No results. No surprise. Next, query with special characters converted:</p>\n\n<pre><code>SELECT * FROM table WHERE (services LIKE '%L\\u00e4mm\\u00f6nmyyntipalvelut%')\n</code></pre>\n\n<p>No results and I wonder why. Next I tested querying for only special character:</p>\n\n<pre><code>SELECT * FROM table WHERE (services LIKE '%\\u00e4%')\n</code></pre>\n\n<p>Found what was supposed to find. Next I started adding stuff (L to beginning) to see where it went wrong:</p>\n\n<pre><code>SELECT * FROM table WHERE (services LIKE '%L\\u00e4%')\n</code></pre>\n\n<p>No results. Another test:</p>\n\n<pre><code>SELECT * FROM table WHERE (services LIKE '%\\u00e4mm%')\n</code></pre>\n\n<p>Found what was supposed to find.</p>\n\n<p>So my conclusion is that the backslash is somehow messing things up, but I don't understand how?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Exact contents of services field:</p>\n\n<pre><code>[\"Neuvonta\",\"L\\u00e4mm\\u00f6nmyyntipalvelut\",\n\"Mets\\u00e4-\\/energiapuunkorjuupalvelut\"]\n</code></pre>\n\n<p>Exact query:</p>\n\n<pre><code>SELECT id, uid, company_name, services, logo FROM rekisteroeidy_toimijaks \nWHERE \n    (services LIKE '%L\\u00e4mm\\u00f6nmyyntipalvelut%' AND \n    services LIKE '%Mets\\u00e4-\\/energiapuunkorjuupalvelut%') \nORDER BY company_name ASC\n</code></pre>\n\n<p>I added some line breaks to help readability.</p>\n"},{"tags":["php","mysql","database","query","random"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13286782,"title":"how to create two new lists from an existing mysql db in random order in PHP where the elements at the same positions are unequal?","body":"<p>Ok. Let's make it all a little clearer.</p>\n\n<p>What I am trying to do is the following:</p>\n\n<p>I have a table like this one...\n <pre>\n    +---------+--------------------+--------------------------+\n    |    id   |    name            | email                    |\n    +---------+--------------------+--------------------------+\n    | 1       |  karl              | karl@email.com           |\n    +---------+--------------------+--------------------------+\n    | 2       |  fred              | fred@email.com           |\n    +---------+--------------------+--------------------------+\n    | 3       |  christopher       | chris@email.com          |\n    +---------+--------------------+--------------------------+\n </pre></p>\n\n<p>What I want to end up with is a new table like the following:\n <pre>\n    +-----+---------------+---------------------+--------------+--------------------+\n    | id  | name1         | email1              | name2        | email2             |\n    +-----+---------------+---------------------+--------------+--------------------+\n    | 1   | fred          | fred@email.com      | christopher  | chris@email.com    |\n    +-----+---------------+---------------------+--------------+--------------------+\n    | 2   | christopher   | chris@email.com     | karl         | karl@email.com     |\n    +-----+---------------+---------------------+--------------+--------------------+\n    | 3   | karl          | karl@email.com      | fred         | fred@email.com     |\n    +-----+---------------+---------------------+--------------+--------------------+\n </pre></p>\n\n<p>The values are unique horizontally (id[1].name1 != id[1].name2) and vertically (id[1].name1 != id[2].name1).</p>\n\n<p>Therefore, this output should not be possible:</p>\n\n<p><pre>\n    +-----+---------------+---------------------+--------------+--------------------+\n    | id  | name1         | email1              | name2        | email2             |\n    +-----+---------------+---------------------+--------------+--------------------+\n    | 1   | fred          | fred@email.com      | christopher  | chris@email.com    |\n    +-----+---------------+---------------------+--------------+--------------------+\n    | 2   | fred          | fred@email.com      | karl         | karl@email.com     |\n    +-----+---------------+---------------------+--------------+--------------------+\n    | 3   | karl          | karl@email.com      | karl         | karl@email.com     |\n    +-----+---------------+---------------------+--------------+--------------------+\n </pre></p>\n\n<p>How can I achieve this in an easy way?</p>\n"},{"tags":["sql","sql-server","query","select"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":42,"score":0,"question_id":13286661,"title":"what does a select statement returns if condition doesn't match?","body":"<p>For example if I have following statement</p>\n\n<pre><code>declare @uid int;\nset @uid = (select id from tablename where condition)\n</code></pre>\n\n<p>In this case if condition doesn't match then what it will return to <code>@uid</code>.</p>\n"},{"tags":["mysql","query","mysqli","query-performance","query-plans"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13286369,"title":"How can I improve performance of this query?","body":"<ol>\n<li><p>How can I improve performance of below query? It was running more\nthan one hour to execute in my production environment. anybody can\nhelp me here.</p>\n\n<pre><code>    mysql&gt; explain   SELECT transaction_detail.trans_id, trans_detail_segment.segment_id,SUM(trans_detail_segment.segment_count),SUM(trans_detail_segment.segment_amt)\n     FROM trans_detail_segment JOIN transaction_detail on transaction_detail.trans_detail_id =\n</code></pre>\n\n<p>trans_detail_segment.trans_detail_id JOIN transaction\n        on transaction.trans_id = transaction_detail.trans_id WHERE transaction.calendar_id = 2012101012 GROUP BY\ntransaction_detail.trans_id, trans_detail_segment.segment_id;\n        +----+-------------+----------------------+------+------------------------------------------------------+------------------------------+---------+---------------------------------------------------------+-------+----------------------------------------------+\n        | id | select_type | table                | type | possible_keys                                        | key<br>\n| key_len | ref                       | rows  | Extra<br>\n|\n        +----+-------------+----------------------+------+------------------------------------------------------+------------------------------+---------+---------------------------------------------------------+-------+----------------------------------------------+\n        |  1 | SIMPLE      | transaction          | ref  | PRIMARY,i_transaction_calendar,i_trans_calendar_site |\ni_transaction_calendar       | 4       | const<br>\n| 29986 | Using index; Using temporary; Using filesort |\n        |  1 | SIMPLE      | transaction_detail   | ref  | PRIMARY,i_trans_detail_transaction                   |\ni_trans_detail_transaction   | 9       |\nnakika_bi_retail_com.transaction.trans_id               |     2 |\nUsing where; Using index                     |\n        |  1 | SIMPLE      | trans_detail_segment | ref  | i_trans_detail_segment_trans                         |\ni_trans_detail_segment_trans | 9       |\nnakika_bi_retail_com.transaction_detail.trans_detail_id |     1 |\nUsing where                                  |\n        +----+-------------+----------------------+------+------------------------------------------------------+------------------------------+---------+---------------------------------------------------------+-------+----------------------------------------------+\n        3 rows in set (0.00 sec)</p>\n\n<pre><code>    structure of my tables\n\n    mysql&gt; show create table transaction\\G\n    *************************** 1. row ***************************\n           Table: transaction\n    Create Table: CREATE TABLE `transaction` (\n      `trans_id` bigint(20) NOT NULL AUTO_INCREMENT,\n      `calendar_id` int(11) NOT NULL,\n      `reentry_mode_flag` varchar(5) DEFAULT NULL,\n      `receipt_number` varchar(45) DEFAULT NULL,\n      `business_day_date` date DEFAULT NULL,\n      `begin_date_time` datetime DEFAULT NULL,\n      `end_date_time` datetime DEFAULT NULL,\n      `elapsed_time` int(11) DEFAULT NULL,\n      `retail_trans_ver` varchar(10) DEFAULT NULL,\n      `trans_detail_count` int(11) DEFAULT '0',\n      `net_amt` decimal(10,2) DEFAULT '0.00',\n      `tax_amt` decimal(10,2) DEFAULT '0.00',\n      `tax_exempt_amt` decimal(10,2) DEFAULT '0.00',\n      `discount_amt` decimal(10,2) DEFAULT '0.00',\n      `tender_amt` decimal(10,2) DEFAULT '0.00',\n      `gross_amt` decimal(10,2) DEFAULT '0.00',\n      `change_amt` decimal(10,2) DEFAULT '0.00',\n      `trans_type_id` int(11) NOT NULL,\n      `workstation_id` int(11) NOT NULL,\n      `emp_id` int(11) NOT NULL,\n      `employee_approve_id` int(11) DEFAULT NULL,\n      `employee_received_id` int(11) DEFAULT NULL,\n      `site_id` int(11) NOT NULL,\n      `custom_data_id` int(11) DEFAULT NULL,\n      `trans_uuid` varchar(36) DEFAULT NULL,\n      PRIMARY KEY (`trans_id`),\n      KEY `fk_transaction_transaction_type1` (`trans_type_id`),\n      KEY `fk_transaction_workstation1` (`workstation_id`),\n      KEY `fk_transaction_employee1` (`emp_id`),\n      KEY `fk_transaction_custom_data1` (`custom_data_id`),\n      KEY `fk_transaction_site1` (`site_id`),\n      KEY `i_transaction_receipt_num` (`receipt_number`),\n      KEY `i_transaction_bus_day_date` (`business_day_date`),\n      KEY `i_trans_trans_uuid` (`trans_uuid`),\n      KEY `i_transaction_calendar` (`calendar_id`),\n      KEY `date_receipt` (`begin_date_time`,`receipt_number`),\n      KEY `i_trans_calendar_site` (`calendar_id`,`site_id`),\n      CONSTRAINT `fk_transaction_custom_data1` FOREIGN KEY (`custom_data_id`) REFERENCES `custom_data` (`custom_data_id`) ON\n</code></pre>\n\n<p>DELETE NO ACTION ON UPDATE NO ACTION,\n          CONSTRAINT <code>fk_transaction_employee1</code> FOREIGN KEY (<code>emp_id</code>) REFERENCES <code>employee</code> (<code>emp_id</code>) ON DELETE NO ACTION ON\nUPDATE NO ACTION,\n          CONSTRAINT <code>fk_transaction_site1</code> FOREIGN KEY (<code>site_id</code>) REFERENCES <code>site</code> (<code>site_id</code>) ON DELETE NO ACTION ON UPDATE NO\nACTION,\n          CONSTRAINT <code>fk_transaction_transaction_type1</code> FOREIGN KEY (<code>trans_type_id</code>) REFERENCES <code>transaction_type</code>\n(<code>transaction_type_id</code>) ON DELETE NO ACTION ON UPDATE NO ACTION,\n          CONSTRAINT <code>fk_transaction_workstation1</code> FOREIGN KEY (<code>workstation_id</code>) REFERENCES <code>workstation</code> (<code>workstation_id</code>) ON\nDELETE NO ACTION ON UPDATE NO ACTION\n        ) ENGINE=InnoDB AUTO_INCREMENT=2759455 DEFAULT CHARSET=utf8\n        1 row in set (0.02 sec)</p>\n\n<pre><code>    mysql&gt; show create table transaction_detail\\G\n    *************************** 1. row ***************************\n           Table: transaction_detail\n    Create Table: CREATE TABLE `transaction_detail` (\n      `trans_detail_id` bigint(20) NOT NULL AUTO_INCREMENT,\n      `trans_id` bigint(20) DEFAULT NULL,\n      `seq_num` int(11) NOT NULL,\n      `timestamp` datetime DEFAULT NULL,\n      `site_id` int(11) NOT NULL,\n      `unit_amount` decimal(8,2) DEFAULT '0.00',\n      `gross_amt` decimal(8,2) DEFAULT '0.00',\n      `net_amt` decimal(8,2) DEFAULT '0.00',\n      `discount_amt` decimal(8,2) DEFAULT '0.00',\n      `tax_amt` decimal(8,2) DEFAULT '0.00',\n      `tax_exempt_amt` decimal(8,2) DEFAULT '0.00',\n      `promotion_id` varchar(20) DEFAULT NULL,\n      `related_item_seq_num` int(11) DEFAULT NULL,\n      `quantity` int(11) DEFAULT '0',\n      `serial_num` varchar(20) DEFAULT NULL,\n      `gift_receipt_flag` tinyint(1) DEFAULT '0',\n      `line_item_type_id` int(11) NOT NULL,\n      `sku_id` int(11) DEFAULT NULL,\n      `entry_method_id` int(11) NOT NULL,\n      `trans_uuid` varchar(36) DEFAULT NULL,\n      `trans_detail_uuid` varchar(36) DEFAULT NULL,\n      PRIMARY KEY (`trans_detail_id`),\n      KEY `fk_trans_detail_line_item_type` (`line_item_type_id`),\n      KEY `fk_trans_detail_sku` (`sku_id`),\n      KEY `fk_trans_detail_entry_method` (`entry_method_id`),\n      KEY `fk_trans_detail_site` (`site_id`),\n      KEY `i_trans_detail_transaction` (`trans_id`),\n      KEY `i_trans_detail_uuid` (`trans_detail_uuid`),\n      KEY `i_detail_trans_uuid` (`trans_uuid`),\n      CONSTRAINT `fk_trans_detail_entry_method` FOREIGN KEY (`entry_method_id`) REFERENCES `entry_method` (`entry_method_id`) ON\n</code></pre>\n\n<p>DELETE NO ACTION ON UPDATE NO ACTION,\n          CONSTRAINT <code>fk_trans_detail_line_item_type</code> FOREIGN KEY (<code>line_item_type_id</code>) REFERENCES <code>line_item_type</code>\n(<code>line_item_type_id</code>) ON DELETE NO ACTION ON UPDATE NO ACTION,\n          CONSTRAINT <code>fk_trans_detail_site</code> FOREIGN KEY (<code>site_id</code>) REFERENCES <code>site</code> (<code>site_id</code>) ON DELETE NO ACTION ON UPDATE NO\nACTION,\n          CONSTRAINT <code>fk_trans_detail_sku</code> FOREIGN KEY (<code>sku_id</code>) REFERENCES <code>sku</code> (<code>sku_id</code>) ON DELETE NO ACTION ON UPDATE NO ACTION\n        ) ENGINE=InnoDB AUTO_INCREMENT=22010863 DEFAULT CHARSET=utf8\n        1 row in set (0.00 sec)</p>\n\n<pre><code>    mysql&gt; show create table trans_detail_segment\\G\n    *************************** 1. row ***************************\n           Table: trans_detail_segment\n    Create Table: CREATE TABLE `trans_detail_segment` (\n      `trans_detail_segment_id` int(11) NOT NULL AUTO_INCREMENT,\n      `trans_detail_id` bigint(20) DEFAULT NULL,\n      `segment_id` int(11) NOT NULL,\n      `segment_count` int(11) DEFAULT '0',\n      `segment_amt` decimal(10,2) DEFAULT '0.00',\n      `trans_detail_uuid` varchar(36) DEFAULT NULL,\n      PRIMARY KEY (`trans_detail_segment_id`),\n      KEY `fk_trans_detail_segment_segment` (`segment_id`),\n      KEY `i_trans_detail_segment_trans` (`trans_detail_id`),\n      KEY `i_segment_trans_detail_uuid` (`trans_detail_uuid`),\n      CONSTRAINT `fk_trans_detail_segment_segment` FOREIGN KEY (`segment_id`) REFERENCES `segment` (`segment_id`) ON DELETE NO\n</code></pre>\n\n<p>ACTION ON UPDATE NO ACTION\n        ) ENGINE=InnoDB AUTO_INCREMENT=22084631 DEFAULT CHARSET=utf8\n        1 row in set (0.00 sec)**</p></li>\n</ol>\n"},{"tags":["c#","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":13266580,"title":"Complex Linq c# query","body":"<p>I tried this in LinqPad</p>\n\n<p>I have the following data and linq query which should return only 1 record and 2 images but returns 2 records and 4 images. </p>\n\n<p>I know i have something wrong but don't know what. I am looking for the users details + car details + images fro user: 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 </p>\n\n<p>It has something to do with the bids as when I delete one of he bids for user (0b3c2ba5-1538-4557-a6c0-7de701fd83e7 ) i then get 1 record and 2 images</p>\n\n<p><strong>TABLES<br>\n------</strong> </p>\n\n<h2>TABLE bids</h2>\n\n<pre><code>id      cardid  bidamount   dateplaced          usedid  \n\n43  83  625 2012-11-05 16:12:51.600 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n44  86  575 2012-11-05 16:15:02.257 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n45  83  650 2012-11-05 16:15:07.283 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n46  86  600 2012-11-05 17:45:04.140 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n47  86  625 2012-11-05 17:45:08.867 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n49  83  750 2012-11-07 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7  \n52  83  850 2012-11-08 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 \n</code></pre>\n\n<h2>TABLE userdetails</h2>\n\n<pre><code>userid                                  city    state  \n0b3c2ba5-1538-4557-a6c0-7de701fd83e7    Sydney  NSW  \n</code></pre>\n\n<h2>TABLE cars</h2>\n\n<pre><code>id  name     descr   listingOption priceStarting priceReserve  \n83  Valiant  Old Car     2              1000         1500  \n86  Volvo    Safe Car    3              3000         4500 \n</code></pre>\n\n<h2>TABLE auction_images</h2>\n\n<pre><code>id         image                                              belongs_to  \n71  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  83  \n72  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   83  \n75  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  86  \n76  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   86  \n</code></pre>\n\n<p><strong>QUERY\n-----</strong></p>\n\n<pre><code> var query = (from c in cars\n                         from ud in users_details\n                         from bd in bids\n                         orderby c.listingOption descending\n                         where a.userID == ud.userid\n                        &amp;&amp; c.id == bd.carID\n                        &amp;&amp; c.enabled == true\n                        &amp;&amp; bd.userID == new Guid(\"0b3c2ba5-1538-4557-a6c0-7de701fd83e7\")\n                         let images = from ai in auction_images\n                                      where ai.belongs_to == c.id\n                                      select ai\n\n                         let bid = (from b in bids\n                                    orderby b.id descending\n                                    where b.carID == c.id\n                                    select b.bidamount).FirstOrDefault()\n                         select\n                         new\n                         {\n                             images,\n                             bidamount = (bid != null ? bid : 0),\n                             ud.city,\n                             ud.state,\n                             c.name,\n                             c.descr,\n                             c.id,\n                             c.listingOption,\n                             c.priceStarting,\n                             c.priceReserve,\n                             bd.userID\n                         }\n                         );\n\nquery.Distinct().Dump();\n</code></pre>\n"},{"tags":["query","ldap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13285364,"title":"%let Filter = \"(&(memberof=CN= in LDAP","body":"<p>I'm working on a project to filter users out of groups.</p>\n\n<p>To filter on specified groups, I've found it already, but now I want to do the same to filter on different users in LDAP.</p>\n\n<p>Can anyone help me?</p>\n"},{"tags":["javascript","jquery","query","random"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13282037,"title":"limit jquery random image with MVC","body":"<p>I have a little trouble in here, I have some script that I taken from this link <a href=\"http://stackoverflow.com/a/9436445/1099048\">jQuery, random div order</a>, this script I used for call my query's with MySQL.</p>\n\n<p>My problem is, for example I have 8 records but I already limit only 4 records to displayed and I want all records can be displayed even I already limit to displayed it. How?</p>\n\n<p>here for my model </p>\n\n<pre><code>public function get_ads_query(){\n    $row = $this-&gt;db-&gt;get('advertise');\n\n    return $row;\n\n}\n</code></pre>\n\n<p>here is my code in view</p>\n\n<pre><code>&lt;div id=\"advertentie\" class=\"advcontainer\"&gt;\n    &lt;?php \n        $row = $this-&gt;M_front-&gt;get_ads_query();\n        $row = $row-&gt;result();\n        foreach($row as $ads):\n    ?&gt;\n    &lt;div class=\"adblock\"&gt;&lt;img src=\"&lt;?php echo base_url(); ?&gt;images/advertise/&lt;?php echo $ads-&gt;Picture; ?&gt;\" /&gt;&lt;/div&gt;\n    &lt;?php endforeach;?&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>and here the jquery</p>\n\n<pre><code>var $container = $(\".advcontainer\");\n\nsetInterval(function(){\n    $container.html(shuffle($container.children().get()));\n}, 1500);\n$(\".advcontainer div\").each(function(){\n    var color = $(this).attr(\"class\");\n    $(this).css({backgroundColor: color});\n});\nfunction shuffle(o){\n    for(var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);\n    return o;\n};\n</code></pre>\n\n<p>thank you</p>\n"},{"tags":["oracle","query","concatenation","decode"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13284859,"title":"show data with decode function in oracle","body":"<p>original data (image)\n<img src=\"http://i.stack.imgur.com/5DaCH.jpg\" alt=\"enter image description here\">\nI want to display my data by concatenating several columns. But the data that appears less than perfect: there is a comma behind at the end of the concatenations, like the picture shows:</p>\n\n<p><img src=\"http://i.stack.imgur.com/DUVOY.jpg\" alt=\"http://i1207.photobucket.com/albums/bb476/daniwarrior/decode1.jpg\"></p>\n\n<p>Here is the query that I created in oracle 10g</p>\n\n<pre><code>    select id_pegawai, \n    whitelist_pembayaran||decode(whitelist_pembayaran,null,null,', ')||\n    whitelist_pemasang||decode(whitelist_pemasang,null,null,', ')||\n    whitelist_jenis_iklan||decode(whitelist_jenis_iklan,null,null) as whitelist,\n\n    blacklist_pembayaran||decode(blacklist_pembayaran,null,null,', ')||\n    blacklist_pemasang||decode(blacklist_pemasang,null,null,', ')||\n    blacklist_jenis_iklan||decode(blacklist_jenis_iklan,null,null) as blacklist\n    from verifikator order by id_verifikator desc\n</code></pre>\n"},{"tags":["sql","sql-server","query","graph","subgraph"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13281776,"title":"SQL: Finding a subgraph","body":"<p>I have a graph network stored in an SQL server. The graph network ( collection of labeled, undirected and connected graphs) is stored in Vertex-Edge mapping scheme (i.e there are 2 tables..one for vertices and one for edges) :</p>\n\n<p>Vertices ( graphID , vertexID, vertexLabel )</p>\n\n<p>Edges  ( graphID , sourceVertex  , destinationVertex ,edgeLabel )</p>\n\n<p>I am looking for a simple way of counting a particular subgraph in this network. For example: I would like to find how many instances of \"A-B-C\" are present in this network : \"C-D-A-B-C-E-A-B-C-F\". I have a few ideas on how this can be done in say Java or C++ ...but I have no clue how to approach this problem using SQL. any ideas?</p>\n\n<p>A little background: I'm no student..this is a small project I would like to pursue. I do a lot of social media analysis (in memory) but have little experience mining graphs against an SQL database.</p>\n"},{"tags":["mysql","query","variables","count"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13284972,"title":"MYSQL query giving general database error","body":"<p>I'm trying to get a query to run counting over 3 tables and add the usernames (only found in table \"user\") to a variable for each matched UID (appears in all tables). With the below query i'm getting a general database error but it's not giving an error code as such?</p>\n\n<pre><code>$UAM = strtoupper($_SERVER['HTTP_USER_AGENT']); \n$ips = strtoupper($_SERVER['REMOTE_ADDR']); \n\n$myquery= \"select sum(total) \nfrom (SELECT count(*) as total,username \n      FROM \" .TABLE_PREFIX.\"tview v \n      where v.ipaddress = '$ips' \n      union all \n      SELECT count(*) as total \n      FROM \" .TABLE_PREFIX.\"tview1 v1 \n      where v1.ipaddress = '$ips' \n      union all \n      SELECT count(*) as total \n      FROM \" .TABLE_PREFIX.\"user v3 \n      where v3.ipaddress = '$ips' \n      ) src\"; \n\n$result = mysql_query($myquery); \n$rowCount = mysql_num_rows($result); \n$row = mysql_fetch_array($myquery); \n$username = $row['username']; \n\n    If($rowCount !=0){ \n       echo \"NOT EMPTY\"; \n    }else{ \n      echo \"EMPTY\"; \n    } \nmysql_free_result($result); \nmysql_free_result($query); \n$fp = fopen(\"logtext.txt\", \"a\"); \n$DateOfRequest = date('m-d-Y H:i:s'); \nfwrite($fp, \"$DateOfRequest . \\nMatched Member: . $username . \\nWith User Agent:  . $UAM . \\n\\nIP: . $ips . \\n\\n\");\n</code></pre>\n\n<p>The scenario would be <strong>$ips</strong> could be 196.168.01.01 check for occurrences in tables <strong>view, tview</strong> and <strong>user</strong>, on any row that it finds a match look up the UID (appears in every table) in the table <strong>user</strong> and add the (unique) <strong>username</strong> (found only in table \"user\") to the variable $username, do this for all matches, so the variable $username for that ip could look like: Silo, John Doe, Jane Doe, Jack Doe - this would be because 3 other users had spoofed my IP and appear in the tables.</p>\n\n<p>Hopefully i've explained clearly what's in my head but feel free to ask anything :)</p>\n\n<p>I'm a newbie at this and have had some help from BF (bluefleet), all help is greatly appreciated,</p>\n\n<p>Regards,\nSilo</p>\n"},{"tags":["oracle","query","concatenation","pivot","string-aggregation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13283231,"title":"show data from multi column to single row","body":"<p>in my oracle database contained the following data</p>\n\n<p><a href=\"http://i1207.photobucket.com/albums/bb476/daniwarrior/data-awal.jpg\" rel=\"nofollow\">http://i1207.photobucket.com/albums/bb476/daniwarrior/data-awal.jpg</a></p>\n\n<p>I want to display the data as shown below</p>\n\n<p><a href=\"http://i1207.photobucket.com/albums/bb476/daniwarrior/data-aKHIR.jpg\" rel=\"nofollow\">http://i1207.photobucket.com/albums/bb476/daniwarrior/data-aKHIR.jpg</a></p>\n\n<p><strong>Whitelist</strong> column are <strong>merging whitelist_pembayaran column, whitelist_pemasan, and whitelist_jenis_iklan</strong></p>\n\n<p><strong>Blacklist</strong> column are merging <strong>blacklist_pembayaran column, blacklist_pemasang, and blacklist_jenis_iklan</strong></p>\n\n<p>whether the query in oracle can do? if you can how to query to display data like the picture above</p>\n\n<p>*<em>)sorry I can not show pictures because my reputation is less to be able to display the image, so I provide a link to the picture</em></p>\n"},{"tags":["android","query","sqlite","optimization","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13278376,"title":"Android SQLite Select query speed","body":"<p>I would like help speeding up a fairly simple select query in my <code>SQLite</code> database.  </p>\n\n<p>The query is searching a table of approx 6500 rows and currently returns in about 600ms.  I don't know if that is acceptable or not, but I had hoped that it would be faster than that.  I will be putting this into an <code>AsyncTask</code> eventually, but wanted to optimize as much as possible.  In the code snippet below you can see what I have tried.<br>\nKEY_songPath is indexed.</p>\n\n<pre><code>public ArrayList&lt;Song&gt; getCurrentDirSongs(String currentDir) {\nlong startTime = System.currentTimeMillis();\nArrayList&lt;Song&gt; songsList = new ArrayList&lt;Song&gt;();\n\nString selectQuery = \"\";\nint strLength = currentDir.length();\n    //selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE (\" + KEY_songPath + \" &gt;= '\" + currentDir + \"')\";\n    //selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE (\" + KEY_songPath + \" GLOB '\" + currentDir + \"*')\";\n    //selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE (\" + KEY_songPath + \" LIKE '\" + currentDir + \"%')\";\n    selectQuery = \"SELECT  * FROM \" + TABLE_SONGS + \" WHERE \" + KEY_ID +\n                    \" IN (SELECT \" + KEY_ID +\" FROM \"+ TABLE_SONGS + \" WHERE length(\" + KEY_songPath + \")&gt;= \"+ strLength +\") AND \" + \n                    \"(\" + KEY_songPath + \" LIKE '\" + currentDir + \"%')\";\n\nSQLiteDatabase db = this.getReadableDatabase();\n\nCursor cursor = db.rawQuery(selectQuery, null);\n\n// looping through all rows and adding to list\nif (cursor.moveToFirst()) {\n    do {\n        Song song = new Song();\n        song.setSongTitle(cursor.getString(1));\n        song.setSongPath(cursor.getString(2));\n        song.setSongArtist(cursor.getString(3));\n        song.setSongAlbum(cursor.getString(4));\n        song.setTrackNumber(cursor.getString(5));\n        song.setID(Integer.parseInt(cursor.getString(6)));\n        song.setAlbumID(Integer.parseInt(cursor.getString(7)));\n        song.setArtistID(Integer.parseInt(cursor.getString(8)));\n        song.setSongCheckedStatus(Boolean.parseBoolean(cursor.getString(9)));\n        song.setSongPosition(Integer.parseInt(cursor.getString(10)));\n        song.setSongDuration(Integer.parseInt(cursor.getString(11)));\n        // Adding song to list\n        songsList.add(song);\n    } while (cursor.moveToNext());\n}\nlong estimatedTime = System.currentTimeMillis() - startTime;\nLog.d(\"AMCDatabase Database Handler: \", \"SongsList.size(): \"+ getSongsCount(\"SongsList\") + \" Time: \" + estimatedTime + \"ms\");\n// return contact list\nreturn songsList;\n</code></pre>\n\n<p>}</p>\n\n<p>This has returned with the following result:\nSongsList.size(): 6390 Time: 588ms</p>\n\n<p>Any help gratefully received!  </p>\n\n<p>P.S This may all be a non-issue - is that time of a second acceptable to query and 6000 values to an <code>ArrayList</code>?</p>\n"},{"tags":["database","query","api","web","data-mining"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":3,"score":-2,"question_id":13281830,"title":"Download Data from NYtimes Interactive Graph","body":"<p>NY times published an interesting interactive graph, showing the words used during Democrats and Republican's convention.\n<a href=\"http://www.nytimes.com/interactive/2012/09/06/us/politics/convention-word-counts.html\" rel=\"nofollow\">http://www.nytimes.com/interactive/2012/09/06/us/politics/convention-word-counts.html</a></p>\n\n<p>I'd like to reuse the data, but don't know how to download it (I checked the source code, can't find the trace where they pull via KPI or anything).</p>\n\n<p>Does anyone know how to find ways to download the data?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","mysql","sql","query","statement"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1903,"score":2,"question_id":10797794,"title":"Multiple queries executed in java in single statement","body":"<p>Hi I was wondering if it is possible to execute something like this using JDBC as it currently provides an exception even though it is possible in the MySQL query browser.</p>\n\n<pre><code>\"SELECT FROM * TABLE;INSERT INTO TABLE;\"\n</code></pre>\n\n<p>While I do realize that it is possible with having the SQL query string being split and the statement executed twice but I was wondering if there is a one time approach for this.</p>\n\n<pre><code>    String url = \"jdbc:mysql://localhost:3306/\";\n    String dbName = \"databaseinjection\";\n    String driver = \"com.mysql.jdbc.Driver\";\n    String sqlUsername = \"root\"; \n    String sqlPassword = \"abc\";\n\n    Class.forName(driver).newInstance();\n\n    connection = DriverManager.getConnection(url+dbName, sqlUsername, sqlPassword);\n</code></pre>\n"},{"tags":["query","doctrine2","like","dql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":233,"score":1,"question_id":10916797,"title":"Doctrine query + LIKE expression","body":"<p>I have problems to create a Doctrine Query with LIKE Expression:</p>\n\n<p><strong>QUERY:</strong></p>\n\n<pre class=\"lang-php prettyprint-override\"><code>$dql    = \"SELECT u FROM Users u JOIN u.group g WHERE g.name LIKE lower('ADMIN')\";\n$query  = $em-&gt;createQuery($dql);\n$result = $query-&gt;getResult();\n</code></pre>\n\n<p><strong>ERROR:</strong></p>\n\n<pre><code>QueryException: [Syntax Error] line 0, col 147: Error: Expected Doctrine\\ORM\\Query\\Lexer::T_STRING, got 'lower'\n</code></pre>\n\n<p>LOWER was just an example, I need to use other functions in LIKE\nEXPRESSION, for example, unnacent...</p>\n\n<p>How can I change Like Expression to support function on both sides?</p>\n\n<p>Example: <code>LOWER(unaccent(u.login)) LIKE LOWER(unaccent('ADMIN'))</code></p>\n"},{"tags":["php","query","mongodb","find","eval"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13283619,"title":"How to use eval() to convert string to php code in mongodb php query?","body":"<p>I want to convert a string to php code.</p>\n\n<pre><code>$criteria = \"\\\"department\\\" =&gt; array('\\$in' =&gt; array(\\\"IT\\\"))\";\n</code></pre>\n\n<p>My actual Mongodb query is this,</p>\n\n<pre><code>$collection-&gt;find(array(\"name\" =&gt; $a, \"department\" =&gt; array('$in' =&gt; array(\"IT\")));\n</code></pre>\n\n<p>But what I need is, query should be based on criteria..</p>\n\n<pre><code>$collection-&gt;find(array(\"name\" =&gt; $a, $criteria);\n</code></pre>\n\n<p>But this doesn't seem to work for me.</p>\n\n<p>I even tried <code>eval($criteria)</code> and then tried it. Negative result.</p>\n\n<p>Where am I going wrong? Any help would be appreciated.</p>\n"},{"tags":["database","query","mongodb","schemaless"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2111,"score":6,"question_id":6814151,"title":"how to export collection to csv in mongodb","body":"<p>How to export all the record in mongodb to csv ?</p>\n\n<pre><code>mongoexport --host localhost --db dbname --collection name --csv &gt; test.csv\n</code></pre>\n\n<p>This asks me to specify name of the fields I need to export. Can I just export all the fields without specifying the name of fields?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13283381,"title":"Row size too large error in mysql create table query","body":"<p>I am trying to create a table with the below query</p>\n\n<pre><code>Create Table PerformaceReport\n(\ncampaignID int,\nkeywordID bigint,\nkeyword varchar(8000),\navgPosition decimal(18,6),\ncost int,\nclicks int,\n conv1PerClick int, \n impressions int,\n  day datetime,\n  currency varchar(8000),\n  account varchar(8000),\n   timeZone varchar(8000),\n    adGroup varchar(8000),\n    adGroupState varchar(8000),\n     approvalStatus varchar(8000),\n     lowestPosition varchar(8000),\n     campaign varchar(8000),\n      campaignState varchar(8000),\n       convManyPerClick int,\n       totalConvValue decimal(18,6),\n        maxCPCSource varchar(8000),\n         clientName varchar(8000),\n          destinationURL varchar(8000),\n           device varchar(8000),\n           firstPageCPC int,\n            isNegative bit,\n             matchType varchar(8000),\n              maxCPC varchar(8000),\n               maxCPM varchar(8000),\n               highestPosition varchar(8000),\n               qualityScore int,\n               keywordState varchar(8000),\n               viewThroughConv int)\n</code></pre>\n\n<p>And i am getting the below error</p>\n\n<pre><code>#1118 - Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. You have to change some columns to TEXT or BLOBs\n</code></pre>\n\n<p>Can anyone please let me know how to avoid this error and make the query work to create a table.</p>\n"},{"tags":["mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13282932,"title":"Inserting a Zero instead of NULL while performing LEFT OUTER JOIN in MYSQL","body":"<p>Is there a way to insert a zero instead of NULL while performing LEFT OUTER JOIN on two tables? </p>\n\n<p>Suppose I have a query like this:</p>\n\n<pre><code>SELECT * FROM\n(SELECT uID from Class) T1\nLEFT OUTER JOIN\n(SELECT pID from University) T2\nON T1.uID = T2.pID\nCASE WHEN T1.uID IS NULL\n    THEN 0\nELSE T1.uID\nEND AS uID`\n</code></pre>\n\n<p>Correct me if I'm wrong</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13277453,"title":"Populating fields in MySQL Database","body":"<p>I have currently created a total of 12 tables in MySQL database. 11 of those tables share correlated data and are indexing with each other. I am undergoing some difficulties populating the values in each individual field of the tables and making sure they index properly. I was wondering if there is an easier way that I can populate each field in all tables for one record without doing it manually and having to worry for the proper <code>foreign_key</code> matches with the other table(indexing). Possibly a query can do the job but I am not sure how I can build such query. Or any other suggestions specifically tying to this example.</p>\n\n<p>Below are links to the desing of tables and a query if you will like to create an exact copy of tables in my database.</p>\n\n<p><a href=\"http://webprolearner.ueuo.com/class_des/table_structure.php\" rel=\"nofollow\">TABLE STRUCTURE/DESIGN</a></p>\n\n<p><a href=\"http://webprolearner.ueuo.com/class_des/query_create.php\" rel=\"nofollow\">QUERY FOR CREATING ALL TABLES</a></p>\n"},{"tags":["sql","sql-server","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13276318,"title":"Returning not found values in query","body":"<p>I'm working on a project, and I have a list of several thousand records that I need check.  I need to provide the list of the ones NOT found, and provide the query I use to locate them so my superiors can check their work.</p>\n\n<p>I'll admit I'm relatively new to SQL. I don't have access to create temporary tables, which is one way I had thought of to do this.</p>\n\n<p>A basic idea of what I'm doing:</p>\n\n<pre><code>select t.column1, t.column2\nfrom table1 t\nwhere t.column1 in ('value1','value2','value3')\n</code></pre>\n\n<p>If value1 and value3 are in the database, but value2 is not, I need to display value2 and not the others.</p>\n\n<p>I have tried <code>ISNULL</code>, embedding the query, and trying to select <code>NOT</code> values from the query.  </p>\n\n<p>I have searched for returning records not found in a query on Google and on this site, and still found nothing.</p>\n"},{"tags":["sql","query","dynamics-crm","dynamics-crm-2011","dynamic-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13273956,"title":"SQL Query in CRM Report","body":"<p>A \"Case\" in CRM has a field called \"Status\" with four options.  </p>\n\n<p>I'm trying to\n build a report in CRM that fills a table with every week of the year (each row is a different week), and then counts the number of cases that have each Status option (the columns would be each of the Status options).</p>\n\n<p>The table would look like this </p>\n\n<pre><code>         Status 1    Status 2    Status 3\nWeek 1       3         55          4\nWeek 2       5         23          5\nWeek 3       14        11          33\n</code></pre>\n\n<p>So far I have the following: </p>\n\n<pre><code>SELECT \n    SUM(case WHEN status = 1 then 1 else 0 end) Status1,\n    SUM(case WHEN status = 2 then 1 else 0 end) Status2,\n    SUM(case WHEN status = 3 then 1 else 0 end) Status3,\n    SUM(case WHEN status = 4 then 1 else 0 end) Status4,\n    SUM(case WHEN status = 5 then 1 else 0 end) Status5\nFROM [DB].[dbo].[Contact]\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   2         43          53\n</code></pre>\n\n<p>Now I need to somehow split this into 52 rows for the past year and filter these results by date (columns in the Contact table).  I'm a bit new to SQL queries and CRM - any help here would be much appreciated.  </p>\n\n<p>Here is a SQLFiddle with my progress and sample data: <a href=\"http://sqlfiddle.com/#!2/85b19/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/85b19/1</a></p>\n"},{"tags":["java","query","parsing","query-string","querystringparameter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":22,"score":0,"question_id":13281701,"title":"Parse a query string parameter to java object","body":"<p>I have query string like that: </p>\n\n<pre><code>ObjectGUId=1abcde&amp;ObjectType=2&amp;ObjectTitle=maximumoflife&amp;Content=racroi&amp;TimeStamp=2012-11-05T17:20:06.056\n</code></pre>\n\n<p>And I have Java Object:</p>\n\n<pre><code>LogObject{\n    private String ObjectGUId;\n    private String ObjectType;\n    private String ObjectTitle;\n    private String Content;\n    private String TimeStamp;\n}\n</code></pre>\n\n<p>So i want to parse this query string to this java Object.</p>\n\n<p>I've searched and read many question but not gotten correct answer yet.</p>\n\n<p>Show me what can solve this problem.</p>\n"},{"tags":["php","html","mysql","query","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13281869,"title":"Why won't my new version using mysqli work?","body":"<p>I wrote this code, but it was pointed out by people here at stackoverflow that these functions will deprecate. So I'm updating it with mysqli functions. The new one won't return the image url i want to show though. </p>\n\n<p>Here's the old working code :</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n\n&lt;title&gt;My first PHP script&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt; \n\n&lt;?php\n\n$dbhost = 'access.website';\n$dbname = 'my_db';\n$dbuser = 'usr_nam';\n$dbpass = 'passwrd';\n\n$mysql_handle = mysql_connect($dbhost, $dbuser, $dbpass)\n    or die(\"Error Connecting To Database Server\");\n\nmysql_select_db($dbname, $mysql_handle)\n    or die(\"Error selecting database: $dbname\");\n\n$query = sprintf(\"SELECT image_url, Type FROM Pokemon \n    c WHERE c.name='%s'\", \n    mysql_real_escape_string($_GET[\"fname\"]));\n\n$result = mysql_fetch_assoc(mysql_query($query));   \n\necho '&lt;img height=\"450\" width=\"330\" src=\"'.$result['image_url'].'\" /&gt;';\n\nmysql_close($mysql_handle);\n\n?&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And here is my new code:</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n\n  &lt;title&gt;My first PHP script&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt; \n\n&lt;?php\n\n$dbhost = 'access.website';\n$dbname = 'my_db';\n$dbuser = 'usr_nam';\n$dbpass = 'passwrd';\n\n$link = mysqli_connect($dbhost,$dbuser,$dbpass,$dbname);\n\nmysqli_select_db($link,$dbname);\n\n$query = sprintf(\"SELECT image_url, Type FROM Pokemon \n    c WHERE c.name='%s'\", \n    mysqli_real_escape_string($link,$_GET[\"fname\"]));\n\n$result = mysqli_query($link,$query);   \n\necho '&lt;img height=\"450\" width=\"330\" src=\"'.$result['image_url'].'\" /&gt;';\n\nmysqli_close($link);\n\n?&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["mysql","sql","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13280677,"title":"How to do a moving average on a range of dates in SQL?","body":"<p>Let's just say I have two columns, DATE and VALUE. The dates are not necessarily regularly spaced intervals. How can I create a moving average on VALUE over the past N days? I'm using postgres but mysql solutions would also be helpful.</p>\n\n<p>Data:</p>\n\n<pre><code>DATE    VALUE\n2012-11-05 10\n2012-10-29 31\n2012-10-22 108\n2012-10-17 3654\n2012-10-16 1187\n2012-10-15 12033\n2012-10-09 41\n2012-10-01 85\n2012-09-25 20\n2012-09-24 285\n2012-09-17 20\n2012-09-10 20\n2012-09-04 41\n2012-08-27 63\n2012-08-20 52\n2012-08-13 160\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13281693,"title":"Comparing number in formatted string in MySQL?","body":"<p>I have a <code>PolicyNo</code> column in my table in MySQL with a format like this:</p>\n\n<pre><code>XXXX-000000\n</code></pre>\n\n<p>A four capital-case <strong>characters</strong> followed by a <strong>dash</strong> and a six digit <strong>number</strong>.</p>\n\n<p>The six digit number is incremental, adding <code>1</code> for the next row, and the the four characters is always the same for all rows. The <code>PolicyNo</code> column is unique with a type of <code>varchar(11)</code>.</p>\n\n<p>If ordered, it will look like this:</p>\n\n<pre><code>XXXX-000001\nXXXX-000002\nXXXX-000003\n...\n</code></pre>\n\n<p>Now I want to get all <code>PolicyNo</code> whose number is greater than a specified number.</p>\n\n<p>For example: Retrieve all <code>PolicyNo</code> greater than <code>'XXXX-000100'</code>:</p>\n\n<pre><code>XXXX-000101\nXXXX-000102\nXXXX-000103\n...\n</code></pre>\n\n<p>I test this query and it works fine, but I just didn't know if it is really <em>safe</em> to do such:</p>\n\n<pre><code>SELECT  'XXXX-000099' &gt; 'XXXX-000098'\n    ,   'XXXX-000099' &gt; 'XXXX-000100'\n    ,   'XXXX-000099' &gt; 'XXXX-000101'\n\nResult:\n+-------------------------------+-------------------------------+-------------------------------+\n| 'XXXX-000099' &gt; 'XXXX-000098' | 'XXXX-000099' &gt; 'XXXX-000100' | 'XXXX-000099' &gt; 'XXXX-000101' |\n+-------------------------------+-------------------------------+-------------------------------+\n|                             1 |                             0 |                             0 |\n+-------------------------------+-------------------------------+-------------------------------+\n</code></pre>\n\n<p>Is there any other way to do this or is it already OK to use this?</p>\n"},{"tags":["query","parameters","nginx"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1139,"score":2,"question_id":8130692,"title":"with nginx,how to forward query parameters?","body":"<pre><code>upstream apache {\n   server 127.0.0.1:8080;\n}\nserver{\n   location ~* ^/service/(.*)$ {\n      proxy_pass http://apache/$1;\n      proxy_redirect off;\n   }\n }\n</code></pre>\n\n<p>Above snippet will  redirect part of requests within that url includes string \"service\" to another server,but not include query parameters.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13280045,"title":"Getting rid of duplicates based on older date in mysql","body":"<p>Picture this... a person adds a row of data about a computer into mysql and he again adds another row of essentially same row of data except that the date is different where each date is always stamped with the insert. </p>\n\n<p>I want to be able to eliminate duplicates and show only the most recent row. </p>\n\n<p>Let's say we have a \"computers\" table with 3 fields: ID, COMPUTER, DATEADD</p>\n\n<p>inside the table goes like this</p>\n\n<pre><code>1, dell, 2010-10-09\n2, dell, 2011-10-10\n3, gateway, 2010-03-03\n4, dell, 2010-02-02\n</code></pre>\n\n<p>simple, ok... how do I get rid of dups of dell and only get dell with the latest date? </p>\n\n<p>I tried this query:</p>\n\n<pre><code> SELECT * \n  FROM  `computers` \n  GROUP BY computer\n  ORDER BY dates ASC \n</code></pre>\n\n<p>it doesnt perform as I expect - the date is not the latest.</p>\n"},{"tags":["query","mongodb","find","cross-database"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13278814,"title":"MongoDB cross database query","body":"<p>I know I've seen this solution somewhere, but I can't seem to find it now.  I'm trying to query one MongoDB database while connected to another.  This should be possible without explicitly connecting to the other database before running the query.  Does anyone know the correct syntax to do this?</p>\n"},{"tags":["sql","sql-server","performance","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13280548,"title":"Performance issue in retrieving multiple output of the same column with different values from a single table","body":"<p>is there anyway to get the following results from query without joining the same table three times (or) without reading the same \"wordlocation\" table three times (or more if there are more words)? If there are three or more words, it takes about over a minute for the results to be returned.</p>\n\n<p>Currently \"wordlocation\" table has three rows being (\"bookid\",\"wordid\",\"location\") and it currently has 917802 rows.</p>\n\n<p>What I am trying to do is </p>\n\n<ol>\n<li>retrieve the \"bookid\" that contains all the words specified in the query by \"wordid\".</li>\n<li>sum word count of all words (from the query) from each book</li>\n<li>minimum values of each word location, e.g. (min(w0.location), min (w1.location)</li>\n</ol>\n\n<p>I have tried commenting out count(w0.wordid) and min(location) calculations to see whether they are affecting the performance but this is not the case. Joining the same table multiple time was the case.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SYLB7.jpg\" alt=\"enter image description here\"></p>\n\n<p>(this is the same code as the above image)   </p>\n\n<pre><code>select \n    w0.bookid, \n    count(w0.wordid) as wcount, \n    abs(min(w0.location) + min(w1.location) + min(w2.location)) as wordlocation, \n    (abs(min(w0.location) - min(w1.location)) + abs(min(w1.location) - min(w2.location))) as distance \n    from \n    wordlocation as w0 \n    inner join \n    wordlocation as w1 on w0.bookid = w1.bookid \n    join \n    wordlocation as w2 on w1.bookid = w2.bookid \n    where \n    w0.wordid =3 \n    and \n    w1.wordid =52 \n    and \n    w2.wordid =42\n    group by w0.bookid \n    order by wcount desc;\n</code></pre>\n\n<p>This is the result that I am looking for, and which I got from running the above query, but it takes too long if I specify more than 3 words, e.g. (w0 = 3, w1 = 52 , w2 = 42, w3 = 71)</p>\n\n<p><img src=\"http://i.stack.imgur.com/08dD5.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["python","sql","query","sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13271894,"title":"Interfacing with Sqlalchemy query object to extend, custom query types","body":"<p>I'm working on adding pagination functionality to my models. I could do this with a method in a mixin, I think I understand what pagination is in this context, but I'm looking to add queries so I can pass in pagination wherever I want without hard coding a model method and without a mixin e.g.:</p>\n\n<pre><code>Mymodel.query.filter(Mymodel.attr=='X').paginate(**args, **kwargs)\n</code></pre>\n\n<p>flask-sqlalchemy does this, but I'm not using that, though I've gone over it to attempt to extract some of the functionality.</p>\n\n<p>So if I have something like this method:</p>\n\n<pre><code>def paginate(self, page, per_page=20):\n        items = self.limit(per_page).offset((page - 1) * per_page).all()\n        return Pagination(self, page, per_page, self.count(), items)\n</code></pre>\n\n<p>How do I insert that as something with an interface in and out in the sqlalchemy query chain? I somewhat do and don't follow how it is being done in flask-sqlalchemy, but I want to extract/learn how to do this and more control over querying in the future, refine my use of sqlalchemy, so I do not exactly know where I'm going with it, just asking a question and going from there.</p>\n\n<p>Long answer: to keep reading the sqlalchemy docs and code until I achieve greater understanding. I'm looking to extend orm.Query -- which I've done, but I don't see how I can tie this into my project yet because I don't understand the underlying mechanics of sqlalchemy, but I think I just need to add my paginate query to the declarative base Base I'm using but will see once I get back to working on it. </p>\n"},{"tags":["php","mysql","database","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13279604,"title":"What would be a sql query of \" USA State\" come first?","body":"<p>I have MySQL table named employees with </p>\n\n<pre><code> 1. id \n 2. employee \n 3. state\n</code></pre>\n\n<p>I am not getting an idea how I can query the database where state with the name \"New York\" will come first and all other records will come normally. Here is what I have so far </p>\n\n<pre><code>$sql = \"select * from employees order by\";\n</code></pre>\n"},{"tags":["query","ms-access-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":22,"score":-2,"question_id":13279878,"title":"I need Example for student attendence in Access 2010","body":"<p>Please, I need to make attendance in Access </p>\n\n<p>And want to know how count:</p>\n\n<ol>\n<li>number of absences </li>\n<li>number of attendance</li>\n</ol>\n\n<p>Please, if any one has an example send it to me .. Thanks a lot</p>\n"},{"tags":["query","freebase"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13183878,"title":"Freebase currency query","body":"<p>I have a little problem, maybe can you help me. I'm trying to get the \"currency features\" from freebase. So I tried to do : \"/base/schemastaging/person_extra/net_worth\": null but, I can't get the value written on freebase (for example, with Madonna, it's 650,000,000). Do you know, why it's not working ?</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13278632,"title":"Not sure how to write a query to return column associated with max value in group by","body":"<p>This query in postgres 9.2:</p>\n\n<pre><code>select max(amount) as max_analyte,concat(sarea,' ',sloc) as location,analyte\nfrom sample natural join station\ngroup by analyte,location\norder by max_analyte desc;\n</code></pre>\n\n<p>returns the following results:</p>\n\n<pre><code>max_analyte;location;analyte\n24196;\"CANDLESTICK POINT WINDSURFER CIRCLE\";\"COLI_TOTAL  \"\n19863;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_TOTAL  \"\n14136;\"CRISSY FIELD EAST\";\"COLI_TOTAL  \"\n12033;\"CHINA BEACH/BAKER BEACH BAKER BEACH WEST\";\"COLI_TOTAL  \"\n4352;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_E      \"\n3076;\"CHINA BEACH/BAKER BEACH BACKER BEACH EAST\";\"COLI_TOTAL  \"\n2851;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"ENTERO      \"\n2064;\"AQUATIC PARK SHORELINE\";\"COLI_TOTAL  \"\n1918;\"CRISSY FIELD EAST\";\"ENTERO      \"\n...\n...\n\n74;\"CHINA BEACH/BAKER BEACH CHINA BEACH\";\"ENTERO      \"\n41;\"CRISSY FIELD WEST\";\"ENTERO      \"\n41;\"OCEAN BEACH NORTH LINCOLN WAY\";\"ENTERO      \"\n31;\"OCEAN BEACH NORTH LINCOLN WAY\";\"COLI_E      \"\n</code></pre>\n\n<p>The data set contains the levels of 3 types of bacteria (COLI_TOTAL, COLI_E, ENTERO) sampled at various locations around the Bay Area on many different dates. The query above finds the max value at each location for each type of bacteria, but now I'd like to find which type of bacteria is associated with the maximum value for each location. I'm just not sure how to write that query. I should mention I'm doing this to improve my SQL skills. Thanks for any help/suggestions.</p>\n\n<p>The tables schemas are as follows:</p>\n\n<pre><code>CREATE TABLE sample\n(\n  analyte character(12),\n  amount integer,\n  sdate date,\n  sid character varying(20)\n)\n\nCREATE TABLE station\n(\n  sid character(20),\n  sarea character varying(24),\n  sloc character varying(24),\n  sfreq character varying(24)\n)\n</code></pre>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13278880,"title":"sql query returning multiple result using WHERE","body":"<p>There is a table name <code>Top_Up</code>. Its current snapshot is:\n<img src=\"http://i.stack.imgur.com/5CQha.png\" alt=\"Top_Up Table\">  </p>\n\n<p>When I run query <code>SELECT * FROM Top_Up WHERE Top_up_ID = (round(random() * 9 ) + 1);</code> on it, I am getting random result. Sometimes it is returning with two tuples, sometimes no tuples and sometime one tuple.  </p>\n\n<p>To debug I run the query <code>Select (round(random() * 9 ) + 1);</code> and it is always returning only one tuple in the result.  </p>\n\n<p><strong>Why I am getting this vague and random result?</strong></p>\n"},{"tags":["php","mysql","query","sorting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2479,"score":0,"question_id":4537784,"title":"how to sort mysql result set after the query's done","body":"<p>I am writing a query for mysql database having 2 parameters.</p>\n\n<p>Its a basic search but the problem is I want to sort the order of the results on the basis of the selection.\nSo after I've clicked the <em>search</em> button and the browser displayied the result set I want to order this specific result set by <em>expiration-date</em> or by <em>price</em> depending wich button i click.</p>\n\n<pre><code>   //SELECTION DATA FORM \n   &lt;form action=\"EVENTS_SELECTION.PHP\"&gt;\n     &lt;select name=\"Type\"&gt;\n     &lt;option value=\"\"&gt;SPORT\n     &lt;option value=\"\"&gt;CULTURE       \n     &lt;option value=\"\"&gt;LEISURE\n     &lt;option value=\"\"&gt;GASTRONOMY\n     &lt;/select&gt;  \n\n     &lt;select name=\"WHERE\"&gt;\n     &lt;option&gt;ROME ALL\n     &lt;option&gt;ROME SOUTH\n     &lt;option&gt;ROME WEST\n     &lt;option&gt;ROME EAST\n     &lt;option&gt;ROME NORTH\n     &lt;/select&gt;\n\n     &lt;input type=\"submit\" value=\"search\"&gt;   \n &lt;/form&gt; \n</code></pre>\n\n<p>how can I achieve that??\nthanks\nLuca</p>\n"},{"tags":["sql","query","dbms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":9593727,"title":"Inverted SQL query on a movie DBMS","body":"<p>I've got a task that says, find all firstname and surnames for those people who have been casting and directing in exactly same amount off movies, but where he/she has not been acting but only directing. Take in account only those who have been directing more than ten(10) movies.</p>\n\n<p>Here is the new query I tried:</p>\n\n<pre><code>SELECT p.firstname, p.lastname, COUNT(*) as CASTDIRECTING from PERSON p\n  INNER JOIN Filmparticipation fpCast ON fpCast.personid = p.personid\n  INNER JOIN Filmparticipation fpDirector ON fpDirector.personid = p.personid\n  INNER JOIN FilmItem fi ON fi.filmid = fpCast.filmid AND fi.filmid = fpDirector.filmid\n  INNER JOIN Film f ON f.filmid = fi.filmid\nWHERE (fpCast.parttype = 'cast' AND fpDirector.parttype = 'director' AND fpCast.personid = fpDirector.personid)\nGROUP BY p.lastname, p.firstname\nHAVING count(*) = (SELECT count(*) as DirectedOnly FROM Person p \n       INNER JOIN filmparticipation fpDirector ON fpDirector.personid = p.personid \n       INNER JOIN filmparticipation fpCast ON fpCast.personid = p.personid \n       WHERE (fpCast.parttype!='cast' AND fpDirector.parttype = 'director' AND \n           fpDirector.personid = fpCast.personid) \n       HAVING count(*) &gt; 10)\nORDER BY p.lastname ASC, p.firstname ASC;\n</code></pre>\n\n<p>Now it's returning empty rows. Do anyone see the errors in the query?</p>\n\n<p>Here are some relevant tables regarding the task..</p>\n\n<pre><code>create table filmparticipation (\n    partid int primary key,\n    personid int not null references person (personid),\n    filmid int not null references filmitem (filmid),\n    parttype text not null);\n\n\ncreate table person (\n    personid int primary key,\n    lastname text not null,\n    firstname text not null,\n    gender char(1),\n    check (gender = 'M' or gender = 'F'));\n\ncreate table filmitem (\n    filmid int primary key,\n    filmtype varchar(4) not null);\n\ncreate table film (\n    filmid int primary key references filmitem (filmid),\n    title text not null,\n    prodyear int);\n\ncreate index filmtitleindex on film (title);\ncreate index filmyearindex on film (prodyear);\n</code></pre>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["sql","query","mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13278372,"title":"Calculate mode in SQL","body":"<p>I have seen the answer from a previous post, which works fine but I have a small dilemma.\nTaking the same scenario:</p>\n\n<p><br>A table that list students' grades per class. I want a result set that looks like: </p>\n\n<pre><code>BIO...B \nCHEM...C \n</code></pre>\n\n<p><br>Where the \"B\" and \"C\" are the modes for the class and want to get the mode for the class.</p>\n\n<p>Once I applied the below query, i got the following output:</p>\n\n<pre><code>Class | Score | Freq  |  Ranking \n2010  |   B   | 8     |    1 \n2010  |   C   | 8     |    1 \n2011  |   A   | 10    |    1 \n2012  |   B   | 11    |    1\n</code></pre>\n\n<p>In 2010, I have two grades with the same frequency. What if..I just want to display the highest score, in this case will be \"B\". How can I achieve that? I would need to assign rankings to the letter grades, but I'm not sure how. Please advise.\nThanks.</p>\n\n<p>Prior post:\n<a href=\"http://stackoverflow.com/questions/2045075/sql-server-mode-sql\">SQL Server mode SQL</a></p>\n\n<p>The query I used to retrieve the data was the answer from Peter:</p>\n\n<pre><code>;WITH Ranked AS ( \nSELECT \n    ClassName, Grade \n    , GradeFreq = COUNT(*) \n    , Ranking = DENSE_RANK() OVER (PARTITION BY ClassName ORDER BY COUNT(*) DESC) \nFROM Scores \nGROUP BY ClassName, Grade \n) \nSELECT * FROM Ranked WHERE Ranking = 1\n</code></pre>\n"},{"tags":["php","mysql","query","phpexcel"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13243332,"title":"Removing fields from excel using phpexcel after MYSQL query","body":"<p>I'm using PHPExcel to export data from a MYSQL database and import it into an excel file.</p>\n\n<p><strong>I've got a database that looks like this (this is also what my excel file currently looks like when I generate it using PHPExcel):</strong></p>\n\n<pre><code>======================================================\n|           Question                  |   Answer     |\n=========+===========+===============================|\n| Do you listen to music?             |    YES       |            \n|----------------------------------------------------|\n| Who is your favorite music artists? | Justin Beiber| \n|----------------------------------------------------|\n| &lt;p&gt; Select an Answer&lt;p&gt;             |              | \n|----------------------------------------------------|\n|Are you a Male or female             |      M       | \n|----------------------------------------------------|\n</code></pre>\n\n<p><strong>I want my excel file to look like this:</strong></p>\n\n<pre><code>======================================================\n|           Question                  |   Answer     |\n=========+===========+===============================|\n| Do you listen to music?             |    YES       |            \n|----------------------------------------------------|\n| Who is your favorite music artists? | Justin Beiber| \n|----------------------------------------------------|\n|Are you a Male or female             |      M       | \n|----------------------------------------------------|\n</code></pre>\n\n<p><strong>I'm using this code:</strong></p>\n\n<pre><code>$objPHPExcel = new PHPExcel();\n\n$col = 1; \nwhile($row_data = mysql_fetch_assoc($result)) {\n    $row = 1;\n    if ($col == 1) {\n        $row_headings = array_keys($row_data);\n        foreach($row_headings as $value) {\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n            $row++;\n        }\n        $row = 1;\n        $col++;\n    }\n    foreach($row_data as $value) {\n      if (!strstr('&lt;p&gt;', $value)){\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n\n    $row++;\n         }\n    }\n    $col++;\n}\n</code></pre>\n"},{"tags":["java","query","jpa-2.0","criteria-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13270857,"title":"JPA 2 criteria API: How to select values from various joined tables without using Metamodel?","body":"<p>I have the following type of query that I wish to convert into a jpa criteria query and the following table structure:</p>\n\n<pre><code>Table A 1--&gt;1 Table B  1&lt;--* Table C (proceedings) *--&gt;1 Table D(prcoeedingsstatus)\n--------      --------       -------                     -------\n aID           bID           cID                         dID\n ...           ....          timestamp                   textValue\n f_bID         ....          f_bID       \n                             f_dID\n</code></pre>\n\n<p>1 A has 1 B, 1 B has many proceedings and each proceeding has a proceedingstatus.</p>\n\n<pre><code>SELECT a.*\n\nFROM ((a LEFT JOIN b ON a.f_b = b.id)\n        LEFT JOIN proceedings ON b.id = proceedings.f_b)\n        RIGHT JOIN proceedingsstatus ON proceedings.f_d = proceedingsstatus.id\n\nWHERE   d.textValue IN (\"some unique text\")\n        AND c.timestamp BETWEEN 'somedate' AND 'anotherdate'\n</code></pre>\n\n<p>When I now try to do something like this for the predicates:</p>\n\n<pre><code>Predicate conditions = (root.join(\"tableB\")\n                            .joinList(\"proceedings\")\n                            .join(\"proceedingsstatus\").get(\"textValue\"))\n                            .in(constraintList.getSelectedValues());\n\nPredicate time = cb.between((root.join(\"tableB\")\n                            .joinList(\"proceedings\")\n                            .&lt;Date&gt;get(\"timestamp\")), dt1.toDate(), dt2.toDate());\n\nconstraints = cb.and(conditions, time);\n</code></pre>\n\n<p>Right now it selects entries A where there is at least 1 occurrence of the right proceedingsstatus according to the conditions-predicate if in any of A's proceedings the 'timestamp' matches the time-predicate that I built.\nSo it would also select an entry A when C.timestamp is correct for a proceeding with the wrong textValue in D, if there is at least one entry C belonging to A with the right textvalue in D.  </p>\n\n<p>How can I change it so that it only selects A's where the proceedingsstatus has the right value AND the time of proceeds is correct?</p>\n"},{"tags":["sql","query","ms-access","ms-jet-ace"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13277677,"title":"SQL for the following equation. Todays EMA = (Price * (2/11)) + ((1 - (2/11)) * Yesterdays EMA)","body":"<p>May I ask for your help with the following, please?</p>\n\n<p>I want to create an MS Jet/Ace/Access Query that returns a 10 day Exponential Moving Average (EMA) from a table of price data. The table format and a small set of its data is as follows …</p>\n\n<pre><code>TableName = Spot\nID (AutoNumber) aDate (DateTime)        Settle (Double)\n1               01/10/2007              16.056\n2               02/10/2007              15.625\n3               03/10/2007              15.655\n4               04/10/2007              15.686\n5               05/10/2007              15.810\n6               08/10/2007              15.665\n7               09/10/2007              15.908\n8               10/10/2007              16.004\n9               11/10/2007              16.319\n10              12/10/2007              16.233\n</code></pre>\n\n<p>In case you are not aware of Exponential Moving Averages, the following websites may help explain them …</p>\n\n<p><a href=\"http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a\" rel=\"nofollow\">http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a</a></p>\n\n<p><a href=\"http://www.pandacash.com/technical-analysis/moving-average/exponential.htm\" rel=\"nofollow\">http://www.pandacash.com/technical-analysis/moving-average/exponential.htm</a></p>\n\n<p>However, hopefuly I can explain the equation to you. </p>\n\n<pre><code>Todays EMA = (Settle * Exponent) + ((1 - Exponent) * Yesterdays EMA)\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>Settle = Closing price of the Stock / Asset\nExponent = (2 / (10 Days + 1)) ie 0.1818\n</code></pre>\n\n<p>I have a query that returns some of the values I need, but I am unable to find a solution to the whole thing.</p>\n\n<p>My Query, so far (hopefully the formatting makes it clearer to read)</p>\n\n<pre><code>SELECT aDate, Settle, \n\n   (SELECT((SELECT Settle \n            FROM   SPOT AS SubQ \n            WHERE  SubQ.ID = SS.ID)) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS YesterdaySettle,\n\n   ( 2 / 11 ) AS Exponent,\n\n   (SELECT Settle \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID) * ( Exponent ) AS [Part A],\n\n   ( 1 - Exponent ) AS [Part B],\n\n   (SELECT ((SELECT Settle \n              FROM   SPOT AS SubQ \n              WHERE  SubQ.ID = SS.ID) * ( 2 / 11 )) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS [Yesterdays Part A],\n\n   (SELECT SUM(Settle) \n    FROM   SPOT AS SubQ \n    WHERE  ID BETWEEN Spot.ID AND Spot.ID -9) / Iif(Spot.id &gt; 10, 10, Spot.id) AS [10DMA] \n\nFROM   SPOT\nORDER  BY aDate; \n</code></pre>\n\n<p>Based on the field names of my Query, my equation would be …</p>\n\n<pre><code>Todays EMA = ([Part A])  + ([Part B] * [Part C])\n</code></pre>\n\n<p>And I would expect results similar to the following.</p>\n\n<pre><code>[10DMA] [Exponent]  [Part A]    [Part B]    [Part C] (Previous EMA)     [EMA]\n15.896  0.181818182 2.919272727 0.818181818     USE 10DMA ie 15.896     15.925\n15.911  0.181818182 2.840909091 0.818181818                 15.925      15.871\n15.945  0.181818182 2.846363636 0.818181818                 15.871      15.831\n15.985  0.181818182 2.852       0.818181818                 15.831      15.805\n16.027  0.181818182 2.874545455 0.818181818                 15.805      15.806\n16.037  0.181818182 2.848181818 0.818181818                 15.806      15.780\n16.052  0.181818182 2.892363636 0.818181818                 15.780      15.803\n16.054  0.181818182 2.909818182 0.818181818                 15.803      15.840\n16.039  0.181818182 2.967090909 0.818181818                 15.840      15.927\n16.025  0.181818182 2.951454545 0.818181818                 15.927      15.983                  \n</code></pre>\n\n<p>The problem is I can’t figure out how to create the [Part C] field.</p>\n\n<p>Some points are …</p>\n\n<ul>\n<li>If there is no EMA for a day, then the [Part C] value should be\n[10DMA]. For example, the first record will not have a EMA so I need\nto use [10DMA]. </li>\n<li>If there is an EMA from yesterday, then use that value for todays [Part C].</li>\n</ul>\n\n<p>May I ask for some advice please. I kind of stumbled across what I have so far, But I am stumped for the Part C value.</p>\n\n<p>I thought I could do something along the lines of …</p>\n\n<pre><code>iif (EMA &lt;&gt; 0, EMA, [10DMA]) AS [Part C],\n    (([Part A]) + ([Part B] * [Part C])) AS EMA\n</code></pre>\n\n<p>However, I get an error relating to </p>\n\n<pre><code>Circular reference caused by alias 'Part C'.\n</code></pre>\n\n<p>Any advice would be gratefully received. Many thanks for your time.</p>\n\n<p>John.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13274827,"title":"MySQL query with MATCH on keyword","body":"<p>I'm having troubles understanding the MATCH in MySql. I have a table with Full Text Index on a \"keywords\"-field. The keywords are comma-separated.</p>\n\n<p>I'm testing with 3 rows, with the keywords: prep,rat,mouse</p>\n\n<p>When I search for either \"prep\" or \"rat\", I get the result I want. But if I search for \"mouse\", I get no results. This is the query I'm using:</p>\n\n<pre><code>SELECT *, MATCH(Keywords) AGAINST('mouse') AS Score\nFROM fs_Files\nWHERE MATCH(Keywords) AGAINST('mouse')\nORDER BY score DESC;\n</code></pre>\n\n<p>I've also tried with <code>IN BOOLEAN MODE</code> after 'mouse', but it's the same result.</p>\n\n<p><strong>EDIT</strong>\nIn my database-entry where I used the word 'mouse', I actually used the word 'mus' (which is mouse in Norwegian). I found that if I changed this to 'musebart' (just made the word longer), the search picks it up. Could it be too short with only 3 chars? Is MySql ignoring it (stopword?) since it only contains 3 chars?</p>\n\n<p><strong>EDIT AGAIN:</strong>\nBingo, it has to be at least 4 characters to be searchable. Or else, you have to change it (if you have the permission to do so) Link: <a href=\"http://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html</a>.</p>\n"},{"tags":["query","mongodb","absolute-value"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13275491,"title":"mongodb - Find document with closest integer value","body":"<p>Let's assume I have a collection with documents with a ratio attribute that is a floating point number.</p>\n\n<pre><code>{'ratio':1.437}\n</code></pre>\n\n<p>How do I write a query to find the single document with the closest value to a given integer without loading them all into memory using a driver and finding one with the smallest value of <code>abs(x-ratio)</code>?</p>\n"},{"tags":["ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13276375,"title":"ActiveRecord include with order","body":"<p>I have models:</p>\n\n<pre><code> class FirstModel &lt; AR::B\n   belongs_to :second_model\n end\n\n class SecondModel &lt; AR::B\n   #name\n   has_many :first_model\n end\n</code></pre>\n\n<p>I have code:</p>\n\n<pre><code> @a = FirstModel.where(#some query)\n @a.include([:second_model])\n</code></pre>\n\n<p>How i can include SecondModel with order by name?   </p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13276240,"title":"SQL query - whats the best way to do this","body":"<p>I have this query...</p>\n\n<pre><code>select * from selection_value where id = 14702\n14702\n14704\n14724\n14710\n14738\n14717\n14719\n14719\n14738\n14722\n14721\n14724\n14725\n14706\n14730\n14708\n14731\n14715\n14708\n14749\n14752\n14754\n14755\n14757\n14795\n14753\n14760\n14761\n14759\n14762\n14763\n14785\n14764\n14765\n14785\n14766\n14768\n14796\n14771\n14772\n14774\n14776\n14764\n14780\n14781\n14767\n14784\n14785\n14786\n14788\n14789\n14790\n14791\n14785\n14772\n14792\n14796\n14785\n14797\n14798\n14799\n14800\n14802\n14778\n14803\n14758\n14765\n14762\n14781\n14785\n14786\n14808\n14793\n14805\n14807\n14808\n</code></pre>\n\n<p>Now I know this will not work, I was just wondering whats the best way to get the data for all of these ids in this order?</p>\n\n<p>Is this possible?</p>\n"},{"tags":["mysql","query","group-by","range"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1192,"score":1,"question_id":6687534,"title":"group by range in mysql","body":"<pre><code>Table:   \nnew_table                                                    \nuser_number  | diff                  \n     2       |  0                      \n     1       |  28  \n     2       |  32  \n     1       |  40  \n     1       |  53  \n     1       |  59  \n     1       |  101  \n     1       |  105  \n     2       |  108  \n     2       |  129  \n     2       |  130    \n     1       |  144  \n\n\n            |(result)\n            v\n\nrange  | number of users  \n0-20   |  2  \n21-41  |  3  \n42-62  |  1  \n63-83  |  2  \n84-104 |  1  \n105-135|  0  \n136-156|  3\n\n\nselect t.range as [range], count(*) as [number of users]  \nfrom (  \n  select case    \n    when diff between 0 and 20 then ' 0-20'  \n    when diff between 21 and 41 then ' 21-41'  \n    when diff between 42 and 62 then ' 42-62'  \n    when diff between 63 and 83 then ' 63-83'  \n    when diff between 84 and 104 then ' 84-104'  \n    when diff between 105 and 135 then ' 105-135'  \n    else '136-156'   \n     end as range  \n  from new_table) t  \ngroup by t.diff  \n\nError:\n\nYou have an error in your SQL syntax, near '[range], count(*) as [number of users]  \nfrom (  \n  select case  \n    when' at line 1  \n</code></pre>\n"},{"tags":["wordpress","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13275354,"title":"What is wrong with this custom post type/custom field query?","body":"<p>Im trying to get related posts for actual post that user is seeing (custom post type named property)</p>\n\n<p>At the moment it only gives me the related post from the same 'pcategory' which are the categories for the post type.</p>\n\n<p>What I need is same post type category as it is now and also with the same post type custom field ('location').</p>\n\n<p>Tried many ways but was not able to get it. What is wrong?</p>\n\n<pre><code>$querystr = \"\nSELECT * FROM $wpdb-&gt;posts\nLEFT JOIN $wpdb-&gt;postmeta ON($wpdb-&gt;posts.ID = $wpdb-&gt;postmeta.post_id)\nLEFT JOIN $wpdb-&gt;term_relationships ON($wpdb-&gt;posts.ID = $wpdb-&gt;term_relationships.object_id)\nLEFT JOIN $wpdb-&gt;term_taxonomy ON($wpdb-&gt;term_relationships.term_taxonomy_id = $wpdb-&gt;term_taxonomy.term_taxonomy_id)\nLEFT JOIN $wpdb-&gt;terms ON($wpdb-&gt;term_taxonomy.term_id = $wpdb-&gt;terms.term_id)\n    WHERE $wpdb-&gt;terms.term_id in (\".$catId.\")\nAND $wpdb-&gt;term_taxonomy.taxonomy = 'pcategory'\nAND $wpdb-&gt;posts.post_status = 'publish'\nAND $wpdb-&gt;posts.post_type = 'property'\nAND $wpdb-&gt;postmeta.meta_key = 'location'\n\nORDER BY $wpdb-&gt;posts.ID LIMIT 0 ,$limit\";\n</code></pre>\n"},{"tags":["query","sql-server-2008-r2","left-join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13259980,"title":"How do I get a single result, from two tables, where the 2nd table contains an updated version of a record from the 1st?","body":"<p>I have two tables, <code>CompanyAddresses</code> &amp; <code>MyCompanyAddresses</code>. <em>(Names changed to protect the guilty).</em></p>\n\n<p><code>CompanyAddresses</code> holds a list of default addresses for companies. These records are immutable. The user can change the details of a company address, but those changes are stored <code>MyCompanyAddresses</code>.</p>\n\n<p>How can I produce a single list of addresses from both tables, excluding records from <code>CompanyAddresses</code> where a corresponding record exists in <code>MyCompanyAddresses</code>?</p>\n\n<h3>Sample Data</h3>\n\n<p>CompanyAddresses</p>\n\n<pre><code>DatabaseId | Id    | Code | Name      | Street            | City      | Zip    | Maint Date\n    1      | Guid1 | APL  | Apple     | 1 Infinite Loop   | Cupertino | 95014  | 11/1/2012\n    2      | Guid2 | MS   | Microsoft | One Microsoft Way | Redmond   | 98052  | 11/1/2012\n</code></pre>\n\n<p>MyCompanyAddresses</p>\n\n<pre><code>DatabaseId | Id    | Code | Name      | Street            | City      | Zip    | Maint Date\n    5      | Guid3 | APL  | Apple     | Updated Address   | Cupertino | 95014  | 11/6/2012\n</code></pre>\n\n<p>Desired Results</p>\n\n<pre><code>DatabaseId | Id    | Code | Name      | Street            | City      | Zip    | Maint Date\n    2      | Guid2 | MS   | Microsoft | One Microsoft Way | Redmond   | 98052  | 11/1/2012\n    5      | Guid3 | APL  | Apple     | Updated Address   | Cupertino | 95014  | 11/6/2012\n</code></pre>\n\n<p>I've tried various permutations of MS SQL's <code>UNION</code>, <code>EXCEPT</code> &amp; <code>INTERSECT</code> to no avail. Also, I don't believe <code>JOIN</code>'s are the answer either, but I'll be happily proven wrong.</p>\n\n<p>The database design <em>can</em> be changed, but it would be preferable if it stayed the same.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13276404,"title":"mysql run second query based on time stamp of an id from first query","body":"<p>I have a table \"test\". the stamp gets updated everytime table is updated.</p>\n\n<pre><code>id  |  text    |   stamp  \n__________________________ \n1   |  textA   |   2012-11-06 01:06:34\n2   |  textB   |   2012-11-06 01:01:34\n3   |  textC   |   2012-11-06 01:03:34\n4   |  textD   |   2012-11-06 01:05:34\n5   |  textE   |   2012-11-06 01:02:34\n6   |  textF   |   2012-11-06 01:08:34\n7   |  textG   |   2012-11-06 01:09:34\n8   |  textH   |   2012-11-06 01:04:34\n</code></pre>\n\n<p>I run a query \n\"SELECT * from test ORDER BY stamp DESC LIMIT 3\" (This returns rows with id 7,6 and 1)</p>\n\n<p>Now I have the id of the last row returned (ie 1). How do I use that id to run a second query to fetch next 3 rows where the time stamp &lt; stamp of id ? </p>\n\n<p>Expected result is rows 4,8,3.</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13273966,"title":"SQL: unique constraint and aggregate function","body":"<p>Presently I'm learning (MS) SQL, and was trying out various aggregate function samples. The question  I have is: Is there any scenario (sample query that uses aggregate function) where having a unique constraint column (on a table) helps when using an aggregate function.</p>\n\n<p>Please note: I'm not trying to find a solution to a problem, but trying to see if such a scenario exist in real world SQL programming.</p>\n"},{"tags":["mysql","sql","database","wordpress","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13275271,"title":"SQL Joining another table based on the ID of the initial table","body":"<p>I really just can't seem to grasb the sytanx of SQL Joins, etc ... so I'm needing some help with this (which I think is quite simple)</p>\n\n<p>I'm querying <code>bid_tag</code> as follows:</p>\n\n<pre><code>SELECT paid_date, term, pet_id FROM bid_tag WHERE active = 1\n</code></pre>\n\n<p>And I need to use the <code>pet_id</code> to then grab some information from another table <code>wp_postmeta</code>, where the table is actually in a <code>meta_key</code> <code>meta_value</code> structure (WordPress) ...</p>\n\n<p>So I need to grab the <code>meta_value</code> of <code>meta_key</code> \"bid_name\", for example... amongst other values.</p>\n\n<pre><code>TABLE\nid | meta_key | meta_value\n1    bid_name    Max\n</code></pre>\n\n<p>That <code>ID</code> is the same <code>ID</code> that I need to connect the initial table to...</p>\n\n<p>I really appreciate it!</p>\n"},{"tags":["sql","query","search","search-engine","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13275510,"title":"How to retrieve records based on multiple bit of strings present in those records?","body":"<p>I am using Ruby on Rails v3.2.2 and the MySQL database. I have a database table containing data as-like the following (note: the <code>column1</code> contains comma separated strings):</p>\n\n<pre><code>id   | column1                          | column2 | columnM    \n-----|-----------------------------------------------------\n1    | one1                             | value1  |  ...\n2    | one1, two1                       | value1  |  ...\n3    | one1, two1, three1               | value1  |  ...\n4    | one2                             | value2  |  ...\n5    | one2, two2                       | value2  |  ...\n6    | one2, two2, three2               | value2  |  ...\n...  | ...                              | ...     |  ...\n1000 | oneN                             | valueN  |  ...\n1001 | oneN, twoN                       | valueN  |  ...\n1002 | oneN, twoN, threeN               | valueN  |  ...\n1003 | oneN, twoN, threeN, fourN        | valueN  |  ...\n</code></pre>\n\n<p>I would like to write a SQL query so to retrieve <em>records starting at the same time with one or more bit of strings</em> present in the <code>column1</code>. That is, for instance, given I search the <code>column1</code> for <em>strings</em></p>\n\n<pre><code>Case 1: \"thr\"\nCase 2: \"two1 thr\"\nCase 3: \"two thr\"\nCase 4: \"wo\"\nCase 5: \"one\"\nCase 6: \"four one\"\n</code></pre>\n\n<p>Then, I would like to get respectively records with following <code>id</code>s:</p>\n\n<pre><code>Case 1: 3, 6, 1002, 1003                         # returns all records starting with \"thr\"\nCase 2: 3                                        # returns all records starting with \"two1\" and at the same time starting with \"thr\" \nCase 3: 3, 6, 1002, 1003                         # returns all records starting with \"two\" and at the same time starting with \"thr\"\nCase 4:                                          # nothing to return\nCase 5: 1, 2, 3, 4, 5, 6, 1000, 1001, 1002, 1003 # returns all records starting with \"one\"\nCase 6: 1003                                     # returns all records starting with \"four\" and at the same time starting with \"one\"\n</code></pre>\n\n<p><em>How can I make the SQL query to behave as the above</em> (maybe, by using something as like wildcards or other things unknown to me)<em>?</em> Since I am trying to implement a \"simple\" search engine, what do you advice about? Is there some prescriptions?</p>\n"},{"tags":["windows","query","c#-4.0","wmi","groups"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13275158,"title":"How to get all windows groups along with their permissions using WMI C#?","body":"<p>I am trying to read</p>\n\n<ol>\n<li>All <strong>Groups</strong> of Users in Windows</li>\n<li><strong>Permissions</strong> (ACL, DACL etc) on each group.</li>\n</ol>\n\n<p>Here is my code</p>\n\n<pre><code>public List&lt;GroupPermissions&gt; GetGroups()\n    {\n        var scope = new ManagementScope(\"\\\\\\\\.\\\\ROOT\\\\cimv2\");\n        var sQuery = new SelectQuery(\"Select * from Win32_SecurityDescriptor\");\n        var secDesc = new List&lt;GroupPermissions&gt;();\n        try\n        {\n            var mSearcher = new ManagementObjectSearcher(scope,sQuery);\n\n            foreach (ManagementObject mObject in mSearcher.Get())\n            {\n                var sDObj = new GroupPermissions();\n                var aceList = new List&lt;ACE&gt;();\n                var saceList = new List&lt;ACE&gt;();\n\n                var aceobjs = (ManagementObjectCollection)mObject[\"DACL\"];\n                var aceobjsS = (ManagementObjectCollection)mObject[\"SACL\"];\n                var gpTt = (ManagementObject)mObject[\"Group\"];\n                var ownerTt = (ManagementObject)mObject[\"Owner\"];\n                var sids = (UInt16[]) gpTt[\"SID\"];\n                    var osids= (UInt16[]) ownerTt[\"SID\"];\n                    var groupTrustee = new Trustee()\n                                           {\n                                               Domain =Convert.ToString(gpTt[\"Domain\"]),\n                                               Name = Convert.ToString(gpTt[\"Name\"]),\n                                               SIDString = Convert.ToString(gpTt[\"SIDString\"]),\n                                               SidLength = Convert.ToUInt32(gpTt[\"SidLength\"]),\n                                               SID = sids\n                                           };\n                      var ownerTrustee = new Trustee()\n                                           {\n                                               Domain =Convert.ToString(ownerTt[\"Domain\"]),\n                                               Name = Convert.ToString(ownerTt[\"Name\"]),\n                                               SIDString = Convert.ToString(ownerTt[\"SIDString\"]),\n                                               SidLength = Convert.ToUInt32(ownerTt[\"SidLength\"]),\n                                               SID = osids\n                                           };\n\n                foreach (ManagementObject ace in aceobjs)\n                {\n                    var dTrustee = (ManagementObject)ace[\"Trustee\"];\n                    var daclSids= (UInt16[]) dTrustee [\"SID\"];\n                    var daclTrustee = new Trustee()\n                                           {\n                                               Domain =Convert.ToString(gpTt[\"Domain\"]),\n                                               Name = Convert.ToString(gpTt[\"Name\"]),\n                                               SIDString = Convert.ToString(gpTt[\"SIDString\"]),\n                                               SidLength = Convert.ToUInt32(gpTt[\"SidLength\"]),\n                                               SID = daclSids\n                                           };\n\n                    aceList.Add(new ACE()\n                                    {\n                                        AccessMask = Convert.ToUInt32(ace[\"AccessMask\"]),\n                                        AceFlags = Convert.ToUInt32(ace[\"AceFlags\"]),\n                                        GuidInheritedObjectType = Convert.ToString(ace[\"GuidInheritedObjectType\"]),\n                                        AceType = Convert.ToUInt32(ace[\"AceType\"]),\n                                        GuidObjectType = Convert.ToString(ace[\"GuidObjectType\"]),\n                                        Trustee = daclTrustee \n\n                                    });\n                }\n                foreach (ManagementObject sace in aceobjsS)\n                {\n                    var dTrustee = (ManagementObject)sace[\"Trustee\"];\n                    var daclSids = (UInt16[])dTrustee[\"SID\"];\n                    var daclTrustee = new Trustee()\n                    {\n                        Domain = Convert.ToString(gpTt[\"Domain\"]),\n                        Name = Convert.ToString(gpTt[\"Name\"]),\n                        SIDString = Convert.ToString(gpTt[\"SIDString\"]),\n                        SidLength = Convert.ToUInt32(gpTt[\"SidLength\"]),\n                        SID = daclSids\n                    };\n\n                    saceList.Add(new ACE()\n                    {\n                        AccessMask = Convert.ToUInt32(sace[\"AccessMask\"]),\n                        AceFlags = Convert.ToUInt32(sace[\"AceFlags\"]),\n                        GuidInheritedObjectType = Convert.ToString(sace[\"GuidInheritedObjectType\"]),\n                        AceType = Convert.ToUInt32(sace[\"AceType\"]),\n                        GuidObjectType = Convert.ToString(sace[\"GuidObjectType\"]),\n                        Trustee = daclTrustee\n\n                    });\n                }\n\n\n\n\n                sDObj.ControlFlags = Convert.ToUInt32(mObject[\"ControlFlags\"] ?? 0);\n                sDObj.DACL = aceList.ToArray();\n                sDObj.Group = groupTrustee;\n                sDObj.Owner = ownerTrustee;\n                sDObj.SACL = saceList.ToArray();\n                secDesc.Add(sDObj);\n            }\n        }\n        catch (Exception ex)\n        {\n\n        }\n        return secDesc;\n\n    }\n</code></pre>\n\n<p>and dependent classes that i have created (in copy of WMI classes)</p>\n\n<pre><code>    public class GroupPermissions\n    {\n        public UInt32 ControlFlags;\n        public ACE[] DACL;\n        public Trustee Group;\n        public Trustee Owner;\n        public ACE[] SACL;\n    }\n\n    public class ACE\n    {\n        public UInt32 AccessMask;\n        public UInt32 AceFlags;\n        public UInt32 AceType;\n        public string GuidInheritedObjectType;\n        public string GuidObjectType;\n        public Trustee Trustee;\n    };\n\n    public class Trustee\n    {\n        public string Domain;\n        public string Name;\n        public UInt16[] SID;\n        public UInt32 SidLength;\n        public string SIDString;\n    };\n</code></pre>\n\n<p>It returns nothing. The list object is empty. I am definitely doing something wrong. Can some one please help me out? Thank you</p>\n\n<p>Steve</p>\n"},{"tags":["mysql","sql","query","sql-order-by","order"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13271667,"title":"MySQL order by multiple columns while grouping by one","body":"<p>So I have a weird scenario where I want the following data to be ordered in a certain way. Let the table data be:</p>\n\n<pre><code>abc 111 2     priority\nabc 111 blah  data\nabc 222 1     priority\nabc 222 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>I want to order that data based on column three (where column 4 is priority) but keep the return order grouped by column 2. So the expected query result would look like:</p>\n\n<pre><code>abc 222 1     priority\nabc 222 blah  data\nabc 111 2     priority\nabc 111 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>What's the best possible way of doing this. I can think of doing a query up front and an in clause, but then I would have to account for all possible priorities.</p>\n\n<p>Thanks in advance. FYI, its MySQL that I am using.</p>\n\n<p>ANSWER (but still looking to see if someone has a more efficient way)\ngiven - </p>\n\n<pre><code>CREATE TABLE my_data( name VARCHAR(20),groupid INT(5), attributekey VARCHAR(10),attributevalue VARCHAR(10));\n\nINSERT INTO my_data VALUES(\"abc\", 111, \"priority\", \"2\");\nINSERT INTO my_data VALUES(\"abc\", 111, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"priority\", \"1\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"priority\", \"3\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"someattr\", \"blah\");\n</code></pre>\n\n<p>solution -</p>\n\n<pre><code>SELECT m1.*,\n(select attributevalue from my_data m2\n   where m1.groupid=m2.groupid \n   AND m2.attributekey='priority' \n) groupidpriority \nFROM my_data m1\norder by groupidpriority;\n</code></pre>\n"},{"tags":["mysql","sql","query","optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13241119,"title":"Problems with a slow Dependent Subquery","body":"<p>I have a query I'm running in MySQL.  As you can see, every part of the query is on indexed fields.  Nevertheless, the query takes forever (tens of minutes, longer than I'm willing to wait).  The Connect tables consist of two integers and two indexes (one field one, field two, the other field two, field one). Source and target are tables with a single indexed int field.  Given all the indexes, I expected this query to finish in seconds.  Any suggestions on 1: why it's taking so long, and 2: how to make it faster?</p>\n\n<p>Thanks!</p>\n\n<pre><code>mysql&gt; explain \nSELECT DISTINCT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n  JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n  JOIN InDels2 AS source ON source.id = snpEConnect.indelID \n  WHERE geneConnect.geneSymbolID NOT IN (\n    SELECT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n    JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n    JOIN InDels3 AS target ON target.id = snpEConnect.indelID);\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n| id | select_type        | table       | type  | possible_keys     | key      | key_len | ref                                                                   | rows | Extra                          |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n|  1 | PRIMARY            | source      | index | id                | id       | 4       | NULL                                                                  | 5771 | Using index; Using temporary   |\n|  1 | PRIMARY            | snpEConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.source.id                                           |    2 | Using index                    |\n|  1 | PRIMARY            | geneConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.snpEConnect.snpEffectID                             |    1 | Using where; Using index       |\n|  2 | DEPENDENT SUBQUERY | geneConnect | ref   | snpEList,geneList | geneList | 4       | func                                                                  |    1 | Using index                    |\n|  2 | DEPENDENT SUBQUERY | target      | index | id                | id       | 4       | NULL                                                                  | 6297 | Using index; Using join buffer |\n|  2 | DEPENDENT SUBQUERY | snpEConnect | ref   | snpEList          | snpEList | 8       | treattablebrowser.target.id,treattablebrowser.geneConnect.snpEffectID |    1 | Using index                    |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n</code></pre>\n\n<p>6 rows in set (0.01 sec)</p>\n"},{"tags":["python","django","query","order","concatenation"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13273805,"title":"django : concatenate 2 queries or special order?","body":"<p>I have to make such query :</p>\n\n<pre><code>similar_brokers_ = Profile.objects.filter(Q(tp=broker.tp) |  Q(md=broker.md)).exclude(Q(id=broker.id))[:4]\n</code></pre>\n\n<p>i need to get 4 similar brokers, which have the same <code>tp</code> field or <code>md</code> field</p>\n\n<p>so this query does it, but i need brokers with the same <code>tp</code> field go first, after them should go brokers with the same <code>md</code> field.</p>\n\n<p>how can i do it better?</p>\n\n<p>for example :</p>\n\n<pre><code>broker1  with tp=1, md=100\nbroker2  with tp=2, md=100\nbroker3  with tp=1, md=99\n</code></pre>\n\n<p>get brokers similat to <code>broker1</code> :\nfirst should go <code>broker3</code> (with <code>tp</code>=1) and after <code>broker2</code> (with <code>md</code>=100)</p>\n"},{"tags":["sql","database","query","count","db2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13273023,"title":"DB2 - Printing info in a Count","body":"<p>Here is the question and my attempt at an answer. I believe that it's successfully selecting records that have borrowed more than one book, I just don't know how to print the book info.</p>\n\n<p>--Find the cardholders (b_name, b_addr) who have borrowed exactly 3 books. Include in your answer the author and title of the borrowed books. </p>\n\n<pre><code>SELECT DISTINCT b_name, b_addr\nFROM cardholder ch, copy c, book k\nWHERE ch.borrowerid IN (SELECT borrowerid\n                        FROM borrows b\n                        WHERE b.borrowerid = ch.borrowerid \n                        AND c.accession_no = b.accession_no\n                        GROUP BY borrowerid\n                        HAVING COUNT(DISTINCT l_date) = 3);\n</code></pre>\n"},{"tags":["sql","sql-server","query","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13274256,"title":"Swapping rows and columns in a \"Group by\" query","body":"<p>I currently have the following: </p>\n\n<pre><code>SELECT status,count(status) AS count\n  FROM [DB].[dbo].[contact]\n  GROUP BY status\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   |   12\nStatus 2   |   23\nStatus 3   |   63\n</code></pre>\n\n<p>I'm trying to get the table to look like this: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   12        23         63\n</code></pre>\n\n<p>Eventually the table will look like this: </p>\n\n<pre><code>                 Status 1   Status 2   Status 3  \nDate Range 1        12        23         63\nDate Range 2        23        2           3       \n</code></pre>\n\n<p>I'm just not sure what to do now.  What kind of SQL commands / syntax should I study to get this done?  This is my first time looking at SQL so any pointers would be awesome.  </p>\n"}]}
{"total":20739,"page":2,"pagesize":100,"questions":[{"tags":["mysql","sql","database","query","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13267870,"title":"optimizing a delete query for table with no index?","body":"<p>Let's say we have the following tables:\nr(a, b, c)\nwhere a is some integer, and the table has 50 rows\ns(d, e, f, a)\ns.a is a foreign key onto t.a.\neach tuple is 400 bytes and s is a multiset since this is a SQL database.\ns holds about 1 million tuples. \nwhen a table is added, the database server automatically creates an index on the primary-­‐key columns in the table so for example t has an index on a. However, Oracle does not create indexes on columns that are foreign keys. So s has no index.\nWe want to delete 15 rows from t. So here is what we do:\n1) We remove rows from s that have the same a values in t. This takes 10 minutes.\n2) Then we run the statement DELETE FROM t WHERE a IN (values we are trying to remove, 15 of them to be exact)\nThis takes about 6 hours. </p>\n\n<p>So my guess is the second step takes a long time because for every tuple in t, we are comparing the value of a to every value within the query list. So how can we optimize this query to get the same result but much faster!?</p>\n"},{"tags":["php","database","security","query","hash"],"answer_count":7,"favorite_count":2,"up_vote_count":14,"down_vote_count":0,"view_count":3442,"score":14,"question_id":3665247,"title":"Fastest hash for non-cryptographic uses?","body":"<p>I'm essentially preparing phrases to be put into the database, they may be malformed so I want to store a short hash of them instead (I will be simply comparing if they exist or not, so hash is ideal).</p>\n\n<p>I assume MD5 is fairly slow on 100,000+ requests so I wanted to know what would be the best method to hash the phrases, maybe rolling out my own hash function or using <code>hash('md4', '...'</code> would be faster in the end?</p>\n\n<p>I know MySQL has MD5(), so that would complement a bit of speed on the query end, but maybe there's further a faster hashing function in MySQL I don't know about that would work with PHP..</p>\n"},{"tags":["query","ms-access","microsoft"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":38,"score":-3,"question_id":13272320,"title":"Number of Columns in Ms Access 2010?","body":"<p>I have 52 Yes/No Columns for attendance Weekly .. I want to make query to know the number of columns that put in it a Yes or No .. Can anyone help me to solve this problem ?.. And if any recommend sites or community to Access Query ... So you will have my Thanks.</p>\n"},{"tags":["sql","sql-server-2008","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13273705,"title":"SQL to bring back material names","body":"<p>The below code is a result of a query i have created, it all works fine apart from one thing.  I have Material ID's for material names:</p>\n\n<pre><code>1 = bath\n2 = sink\n3 = toilet\n</code></pre>\n\n<p>The below works but displays sink for every material</p>\n\n<pre><code>Select cu.FName + '  ' + cu.SName as 'Name', \ncu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', \ncu.PostCode, \nco.DateOrdered,\nco.Material1,\nma.MaterialName,\nco.material2, \nma.MaterialName, \nma.Price as 'Item Price' \nfrom Customers cu \nleft join CustomerOrder co on co.CustomerID = cu.CustomerID\nleft join ItemOrder it on it.OrderID = co.OrderID \nleft join Materials ma on ma.MaterialID = co.Material1 \nor co.material2 = ma.MaterialItemID or co.material3 = ma.MaterialItemID\n</code></pre>\n\n<p>it displays as follows (just the materials are listed to stop confusion)</p>\n\n<pre><code>Material1 | MaterialName | Material2 | Material2Name | Material3 | Material3Name\n    1          Sink            2           Sink           3             Sink\n</code></pre>\n\n<p>Can anybody help with this?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273343,"title":"REPLACE new line character in MYSql not working","body":"<p>I executed following query and for some reason its not replacing new line character in database . It says Rows matched 1 but no change . What can be wrong ?</p>\n\n<pre><code>mysql&gt; UPDATE aboutme SET abouttext=REPLACE(abouttext,'\\\\n','') WHERE userid='5099a95cd944b8.22468149';\nQuery OK, 0 rows affected (0.00 sec)\nRows matched: 1  Changed: 0  Warnings: 0\n</code></pre>\n"},{"tags":["query","erp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13273248,"title":"epicor baq search not working","body":"<p>I have created a BAQ in epicor 905700c. Under the BAQ Search tab I have selected Part.PartNum as the \"Like\" column. But when I try to use this BAQ for a part search it doesn't work properly. </p>\n\n<p>For instance, if I open Part Maintenance, and click the part button to search for available parts, the search form pops up. I select the BAQ search I just created. The search actually returns results, but when I try to select one, it does not populate the part field.</p>\n\n<p>This happens for every BAQ I have hooked up by way of partnum. All other BAQ searches work. </p>\n\n<p>I assume there is a setting somewhere in Epicor that did not get turned on properly when we did the install. Can anyone shed any light on why this is happening and how to fix it? Thanks!</p>\n"},{"tags":["mysql","sql","database","query","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13272230,"title":"mysql - sum columns from multiple tables based on multiple id's","body":"<p>I have a mySQL database with a couple of identical tables. I need to join all the tables and sum up the views and hits every time the <code>id1</code> and <code>id2</code> are equal in at least 2 tables, or simply show the row if not. </p>\n\n<p>Please see below the tables structure:</p>\n\n<pre><code>Table1:\nid..id2...views...hits\n1...102...55......12\n2...103...12......22\n\nTable2:\nid..id2...views...hits\n1...123...512......13\n2...103...123......43\n\nTable3:\nid..id2...views...hits\n1...102...232......43\n2...103...100......70\n</code></pre>\n\n<p>The end result should be the following table:<br></p>\n\n<pre><code>id...id2...views...hits\n1....102...287....65   &lt;-- This one is the result of adding 1st row of table1 and 2nd row of table 2\n1....123...512....13   &lt;-- This is the 1st row of table2 as there's no other id2 = 123\n2....103...235....135 &lt;-- This is the sum of 2nd row in table1 + 2nd row in table2 + 2nd row in table3\n</code></pre>\n\n<p>I hope this makes sense and someone can help with it.</p>\n\n<p>Thanks !</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13272029,"title":"Efficient Way to Select if a database row value match a group of string","body":"<p>Efficient Way to Select if a database row value match a group of string</p>\n\n<pre><code>  SELECT id FROM tablename where \n    LeadStatus like \"%Contact Attempt 1%\" or \n    LeadStatus like \"%Contact Attempt 2%\" or \n    LeadStatus like \"%Contact Attempt 3%\" or \n    LeadStatus like \"%Contact Attempt 4%\" or \n    LeadStatus like \"%Contact Attempt 5%\" or \n    LeadStatus like \"%Contact Attempt 6%\" or \n    LeadStatus like \"%Contact Attempt 7%\" or \n    LeadStatus like \"%Call Back/Follow-up%\" or \n    LeadStatus like \"%Working%\" or \n    LeadStatus like \"%Credit Pulled%\" or \n    LeadStatus like \"%Selected other Lender%\" or \n    LeadStatus like \"%Pre-Approved%\" or \n    LeadStatus like \"%Application Taken/Sent%\" or \n    LeadStatus like \"%Application Received%\" or \n    LeadStatus like \"%Submitted%\" or \n    LeadStatus like \"%Funded%\" or \n    LeadStatus like \"%Future Opportunity%\" or \n    LeadStatus like \"%Manager Review%\"\n</code></pre>\n\n<p>I think it clear enough that what I want?</p>\n\n<p><strong>Note :</strong> I can't change the <code>LeadStatus</code> value as it is fetched from a API not in my control </p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","query","webhooks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13272004,"title":"RnR: Long running query, Heroku timeouts: webhooks? Ajax?","body":"<p>So here's the issue, we have a data that the users want displayed.  The query, we optimized and indexed to be as fast as I think its going get.  We might shave off a second or two but with the amount of data, not much we can do.  </p>\n\n<p>Anyway, so the query runs great when limited to a day or two of data, however the users are running it for a week or two of data.  So the query for two or three weeks of data takes about 40 seconds, with a Heroku timeout of 30 seconds, that doesn't work.  So we need a solution.  </p>\n\n<p>So searching here and Google, I see comments that webhooks or Ajax would work as out solution.  However, I've been unable to find a real concrete example.  I also saw a comment where someone was saying we could send some kind of response that would \"reset the clock.\" But again sounded intriguing but couldn't find an example.  </p>\n\n<p>We're kind of under the gun, the users are unhappy, so we need a solution that is fast and simple.  Thanks in advance for your help! </p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13244369,"title":"MySql Query for generating report","body":"<p>I have one table which is having three fields:</p>\n\n<pre><code>Id, Creation Time, Fuel Level\n</code></pre>\n\n<p>Every two minutes we are getting data and inserting to database.For generating a fuel credit/debit statement i want to get starting(Stating of the day) and ending(End of the Day) Fuel Level.Can anyone help to form a query to generate this report?</p>\n\n<p>Search parameters will be date range.</p>\n\n<p>Id=10;creation time =2019-02-15 16:32:59;Fuel Level =20</p>\n\n<p>I created one sample schema here\n<a href=\"http://sqlfiddle.com/#!2/76dd5\" rel=\"nofollow\">http://sqlfiddle.com/#!2/76dd5</a></p>\n"},{"tags":["xml","query","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13267628,"title":"XPath query to check multiple nodes each has required value","body":"<p>My example XML is as follows:</p>\n\n<pre><code>&lt;FileList&gt;\n  &lt;File&gt;\n    &lt;Name&gt;20120427_1.pdf&lt;/Name&gt;\n    &lt;Size&gt;654441&lt;/Size&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Country&lt;/Name&gt;\n      &lt;Value&gt;United States&lt;/Value&gt;\n    &lt;/Property&gt;\n   &lt;/File&gt;\n   &lt;File&gt;\n    &lt;Name&gt;Name2&lt;/Name&gt;\n    &lt;Size&gt;2147483647&lt;/Size&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name4&lt;/Name&gt;\n      &lt;Value&gt;Value4&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name5&lt;/Name&gt;\n      &lt;Value&gt;Value5&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name6&lt;/Name&gt;\n      &lt;Value&gt;Value6&lt;/Value&gt;\n    &lt;/Property&gt;\n  &lt;/File&gt;\n  &lt;File&gt;\n    &lt;Name&gt;Name3&lt;/Name&gt;\n    &lt;Size&gt;2147483647&lt;/Size&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name7&lt;/Name&gt;\n      &lt;Value&gt;Value7&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Name8&lt;/Name&gt;\n      &lt;Value&gt;Value8&lt;/Value&gt;\n    &lt;/Property&gt;\n    &lt;Property&gt;\n      &lt;Name&gt;Country&lt;/Name&gt;\n      &lt;Value&gt;UK&lt;/Value&gt;\n    &lt;/Property&gt;\n  &lt;/File&gt;\n&lt;/FileList&gt;\n</code></pre>\n\n<p>The requirement is that every file node has a Country value in the Propery/Name element. So far I've created an XPath query:</p>\n\n<pre><code>/FileList/File/Property/Name/text()='Country'\n</code></pre>\n\n<p>This passes as true as query is looking at all nodes when the answer should be false. How do I change it so it checks each 'File' node instead?</p>\n"},{"tags":["mysql","query","distinct","max"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13216762,"title":"Selecting most recent MySQL rows by MAX(time) WHERE time <= x","body":"<p>I am selecting the most recent entries of a MySQL table with:</p>\n\n<pre><code>SELECT MAX(time) as most_recent, userID\nFROM TableName\nGROUP BY userID\nORDER BY most_recent DESC\n</code></pre>\n\n<p>My problem is, if I want to limit the maximum time with:</p>\n\n<pre><code>WHERE time &lt;= nnn\n</code></pre>\n\n<p>The query does not work anymore. Is there a solution for with without a subquery?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["java","sql","database","query","jdbc"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":69,"score":-2,"question_id":13270154,"title":"SQL statements are being stored into database instead of values (simple but challenging )","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their username (their email address) so as to fill in an input form. The functionality of the input form is that the user has to enter for book names in order of priority.</p>\n\n<p>In the application, suppose a user's email address is \"david.ferno@gmail.com\". He will have to input only \"david.ferno\" in the JTextBox, and a SQL LIKE statement is used check the corresponding User ID from the \"bookuser\" table and store it into the \"priority\" table along with the book priority choices.</p>\n\n<p>I have used PreparedStatement for the SQL retrieval from database but when values are being inserted to the , instead of saving User ID like \"user88\", it is saving the SQL statement itself inside the database.</p>\n\n<p>What I mean to say is, in the \"priority\" table, instead of saving user88 (as an example), it is saving \"SELECT User_ID FROM user WHERE email_address\"</p>\n\n<p>Please help me to find out what is wrong with my code.</p>\n\n<p><strong>Here is the \"user\" table structure >></strong> <br/></p>\n\n<pre><code> COLUMNNAME     TYPE\n ------------------- \n User_ID        Text\n full_name      Text \n last_name      Text\n email_address  Text\n phone          Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key</p>\n\n<p><strong>Here is the \"priority\" table structure >></strong> <br/></p>\n\n<pre><code>COLUMNNAME  TYPE \n----------------\nUser_ID     Text \nBook1       Text \nBook2       Text \nBook3       Text\nBook4       Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key </p>\n\n<p><strong>Here are my codes</strong></p>\n\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport javax.swing.*;\nimport java.sql.*;\nimport javax.*;\n\n  public class Handleraddclassroom implements ActionListener{\n\n      public void actionPerformed(ActionEvent event) {\n          String name = ((JButton)event.getSource()).getText();\n\n          if (name.equals(\"Confirm\")) {\n              String filename = \"C:/JAVA/book.accdb\";\n              String database = \"jdbc:odbc:booking\";\n\n              if(txt_mail.getText().equals(\"\")) {\n                   JOptionPane.showMessageDialog(\n                                     addpriority.this, \n                                     \"Your Username Field cannot be blank\");\n              } else {\n                   try {\n                       Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                       //username &amp;password not being used\n                       Connection con = DriverManager.getConnection(database ,\"\",\"\"); \n                       Statement s = con.createStatement(\n                                          ResultSet.TYPE_SCROLL_INSENSITIVE, \n                                          ResultSet.CONCUR_READ_ONLY);\n\n                       String squery = \"SELECT User_ID FROM bookuser WHERE \" +\n                                        + \"email_address LIKE ?\";\n                       PreparedStatement pstmt = con.prepareStatement(squery);\n                       pstmt.setString (1, txt_mail.getText() + '*');\n                       pstmt.executeQuery();\n\n                       String sql = \"INSERT INTO priority VALUES('\" \n                                                 + squery + \"','\"\n                                                 + txt_book1.getText() + \"','\"\n                                                 + txt_book2.getText() + \"','\" \n                                                 + txt_book3.getText() + \"','\"\n                                                 + txt_book4.getText()+ \"')\";\n\n                       JOptionPane.showMessageDialog(addpriority.this,\n                                                     \"Choice Records Saved.\");\n\n                       dispose();\n                       Mainmenulecturer mml = new Mainmenulecturer();\n\n                       s.execute(sql);\n\n                       s.close();\n                       con.close();\n\n                   } catch (Exception e) {\n                        System.out.print(\"Error: \" + e);\n                   }\n              }\n          }\n      }   \n\n}\n</code></pre>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":28,"score":5,"question_id":13261636,"title":"Query: Tables with indexing/foregeing keys/correlated data","body":"<p>I am currently working with a MySQL database table structure. I found a great table structure online but i am not sure how to duplicate such thing. I am new to this and I am requesting help in creating a query that will create all tables( which have correlated data(index), foreign keys, many to many relationships, etc.). </p>\n\n<p><strong>Random</strong> I was able to make a query to select all fields:</p>\n\n<pre><code>SELECT *\n\nFROM schedule \n\nINNER JOIN semester \n\nON schedule.semester_id = semester.id\n\nINNER JOIN office_hours\n\nON office_hours.schedule_id = schedule.semester_id\n\nINNER JOIN faculty\n\nON faculty.id = office_hours.faculty_id\n\nINNER JOIN faculty_titles\n\nON faculty_titles.faculty_id = faculty.id\n\nINNER JOIN faculty_education\n\nON faculty_education.faculty_id = faculty.id \n\nINNER JOIN section\n\nON section.faculty_id = faculty.id \n\nINNER JOIN class\n\nON class.id = section.class_id\n\nINNER JOIN major_class_br\n</code></pre>\n"},{"tags":["sql","sql-server","query","datepart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13270325,"title":"Using DATEPART for AM works correctly but does not work for PM query","body":"<p>I'm using a query to pull a report for our 3rd shift folks.  </p>\n\n<p>The issue I just noticed when the report was mailed with 0 results is that I have it set right now to run from 6pm to 5:59am the next morning.  Since I have the date field = the <code>GETDATE</code>, it doesn't see the results from the night prior(1800-2359).  I was thinking of having this just pull from like -12 hours, but the button can be pressed at anytime to look at results.  </p>\n\n<p>So if they pushed it before the end of the shift, it would show some of 1st shifts entries.  I want it to only run from 1800-0559 the next morning, no matter if the button is pressed before midnight or after midnight.  I hope this makes sense.  I'm not even sure if the between recognizes to go to 00 after it's hit 2359.  I have this built into a VB.net application, and they can press the button anytime they want to get results.  This is for management to track what is being done as the employees are required to enter data real time when issues are taking place.  </p>\n\n<p>Thanks for any help.  Hope I made enough sense!  :D</p>\n\n<pre><code>SELECT \n   Assignment, Datemodified, General, \n   IncNumber, NextSteps, PDCRStatus, \n   RootCause, Status, Summary, \n   Timings, UserID \nFROM \n   Turnover \nWHERE DATEPART(HOUR, datemodified) between 18 and 05 \nAND CONVERT(NVARCHAR(50),datemodified,103) = CONVERT(NVARCHAR(50),GETDATE(),103);\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13263023,"title":"Need advice to re-create history of a table based on audit tables","body":"<p>OK folks, I have an urgent need. I am tasked with re-creating an accurate history of changes to  multiple fields of an active table retroactively based on individual audit tables for each field.  I have a SQL Server Agent job that does this currently on a daily basis starting 10/16/2012, but need to immediately add records to retrofit the history back to 1/1/2012.</p>\n\n<p>To compound my issue, I need to reflect daily changes to the full hierarchy from the top down based on these audit records.</p>\n\n<p>Here's what I have:</p>\n\n<p>Active Table:</p>\n\n<pre><code>empId varchar(20),\nfirst_name varchar(50),\nlast_name varchar(50),\ncost_center varchar(20), -- need to re-create history\nmgr_empId varchar(20), -- need to re-create history\nstart_dt date, -- starting date range of active record\nend_dt date, -- end of active record - default value of 12/31/2999 = active record\nhierarchy_empId varchar (200), --derived field from a nasty self-referencing function (12x)\nhierarchy_name varchar(1000) -- derived from the same functino as the field above.\n</code></pre>\n\n<p>Example:</p>\n\n<p>Employee A1000, Tim Lee enters the org on 3/1/2012 with manager Bill A with emp Id B1000 into cost center 01552.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   12/31/2999   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999   B1000         Bill A\n</pre>\n\n<p>On 5/1/2012 the nightly job picks up a delta for Tim, and Tim's cost center changes to  31550.  So his current record is updated with an end date of yesterday, and a new \"current\" record is entered, reflected below:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   4/30/2012   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999  B1000         Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012   12/31/2999  B1000>A1000   Bill A>Tim Lee\n</pre>\n\n<p>On 6/15/2012, a new manager Ben C, emp Id C1000, was hired underneath Tim's manager:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000         Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    12/31/2999  B1000               Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000         Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   12/31/2999  A1000>C1000         Bill A>Ben C\nA1000  Tim Lee  31550   B1000   6/15/2012   12/31/2999  B1000>C1000>A1000   Bill A>Ben C>Tim Lee\n</pre>\n\n<p>These updates must trickle down the hierarchy.  So, if something changes above Tim, it also must be reflected in his record.   </p>\n\n<p>On 7/15, Tim's original manager Bill A gets a new manager, Mark S, emp Id X3000.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000               Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    7/14/2012   B1000                     Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000               Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   7/14/2012   A1000>C1000               Bill A>Ben C\nA1000  Tim Lee  31550   C1000   6/15/2012   7/14/2012   B1000>C1000>A1000         Bill A>Ben C>Tim Lee\nX3000  Mark S   01000   NULL    7/15/2012   12/31/2999  X3000                     Mark S\nA1000  Tim Lee  31550   C1000   7/15/2012   12/31/2999  X3000>B1000>C1000>A1000   Mark S>Bill A>Ben C>Tim Lee\nB1000  Bill A   01552   X3000   7/15/2012   12/31/2999  X3000>B1000               Mark S>Bill A\nC1000  Ben C    31550   B1000   7/15/2012   12/31/2999  X3000>B1000>C1000              Mark S>Bill A>Ben C\n\n</pre>\n\n<p>I have these audit tables:</p>\n\n<p><strong>tblManagerAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimestamp datetime,\noldMgr varchar(20),\nnewMgr varchar(20)\n</code></pre>\n\n<p><strong>tblCostCenterAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimnestamp datetime,\noldCostCenter varchar(20),\nnewCostCenter varchar(20)\n</code></pre>\n\n<p>I have struggled with how to combine the audit records for a very long time and appreciate any input.</p>\n"},{"tags":["query","filter","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13248426,"title":"Query with multiple field values specified","body":"<p>I'm trying to perform an elasticsearch query with multiple fields specified. Here is some pseudo code which hopefully illustrates my intention:</p>\n\n<pre><code>\"query\" : {\n  \"query_string\" : { \"query\" : \"william\" }\n},\n\"filter\" : {\n  \"missing\" : { \"field\" : \"membership_expires_on\" }\n},\n\"filter\" : {\n  \"missing\" : { \"field\" : \"gender\" }\n},\n\"filter\" : {\n  \"terms\" : { \"status\" : \"p\"}\n},\n\"filter\" : {\n  \"terms\" : { \"unit_id\" : \"4\"}\n}\n</code></pre>\n\n<p>I'm trying to AND all these filters together, but from the <a href=\"http://www.elasticsearch.org/guide/reference/query-dsl/missing-filter.html\" rel=\"nofollow\">elasticsearch doc</a> I can't figure out how to put these specific filters into a single query. Any help would be greatly appreciated!</p>\n\n<p><strong>UPDATE</strong>: Here is what I have so far:</p>\n\n<pre><code>{\n  \"from\": 0,\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"missing\": {\n                \"field\": \"membership_expires_on\"\n              }\n            },\n            {\n              \"term\": {\n                \"status\": \"p\"\n              }\n            },\n            {\n              \"missing\": {\n                \"field\": \"gender\"\n              }\n            },\n            {\n              \"term\": {\n                \"unit\": \"4\"\n              }\n            }\n          ]\n        }\n      },\n      \"query\": {\n        \"query_string\": {\n          \"query\": \"william\"\n        }\n      }\n    }\n  },\n  \"size\": 10\n}\n</code></pre>\n\n<p>But this returns no results, so I'm doing something wrong. Am I wielding the bool filter with the array inside in an illegal manner?</p>\n\n<p><strong>Update 2</strong>: I've confirmed that the JSON above indeed is a valid query, so there's probably something amiss with my data/index. That will be a question for another day :-)</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13248287,"title":"appending 2 columns into one list in sql","body":"<p>I have 2 tables and each table has some 3 columns. i want to get one column such that one column from each table are apended one after the other</p>\n\n<pre><code> eg:- suppose one column in a table contains  hai, how, are, you.\n and another column in another column contains i, am, fine.\n i want a query which gives hai, how, are, you,i,am,fine. in just one column\n</code></pre>\n\n<p>can anybody give a query for this in sql...</p>\n"},{"tags":["sql","query","left-join","where-clause"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13266786,"title":"How to use where clause in Query with LEFT JOIN?","body":"<p>how to write my sql query correct? I would like to use WHERE clause in query, but I don't know  how is correct. This is my query with mistake:</p>\n\n<pre><code>**SELECT pil.[Buy-from Vendor No_],  pil.No_, pil.Amount, pil.Quantity \nFROM dbo.[„blk“ 2011$Purch_ Inv_ Line]AS pil\nWHERE pil.Type=5\nLEFT JOIN dbo.[„blk“ 2011$Purch_ Inv_ Header] AS pih\nON pil.[Document No_]=pih.No_\nORDER BY pil.amount**\n</code></pre>\n"},{"tags":["query","namespaces","space"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13155091,"title":"I don't query in storeprocedure Because head name fields have space","body":"<p>In Sql Server 2008. Have Fields \"First Name\". But this name have space. I try query this fields error: Invalid column name 'First'.</p>\n\n<p>How can i query this fields?</p>\n\n<p>Code:</p>\n\n<pre><code>SELECT em.First Name\nFROM Emp em\n</code></pre>\n\n<p>Thanks you for your time. :) </p>\n"},{"tags":["sql","database","sql-server-2008","query","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":26,"score":-2,"question_id":13261087,"title":"How to generate the mapping table in a many to many insert","body":"<p>I have a table of trades for Companys in an exchange. So for a given day I can have many trades for a company. I now want to take these trades and group them into positions.</p>\n\n<p>A trade can below to many positions depending on its attributes like country, type etc\na position can be made up of many trades.</p>\n\n<p>So I have the following tables</p>\n\n<p><strong>Table Trades</strong><br/></p>\n\n<pre><code>Id   Date      Company   Trade  Type\n1 2012-11-01     IBM     1000    A\n2 2012-11-01     IBM     3000    B\n3 2012-11-01     Dell    1000    A\n4 2012-11-01     HP      5000    A\n5 2012-11-01     HP      6000    A\n6 2012-11-01     HP      7000    B\n</code></pre>\n\n<p><strong>Table TradePositionMapping</strong><br/></p>\n\n<pre><code>PK     TableTradeID      PositionID\n1          1                100      --IBM 1000\n2          1                101      --IBM 1000\n3          2                101      --IBM 3000\n4          3                102      --Dell 1000\n5          4                103      --HP 5000\n6          5                103      --HP 6000\n7          4                104      --Hp 5000\n7          5                104      --Hp 6000\n7          6                104      --Hp 7000\n</code></pre>\n\n<p><strong>Table Position</strong><br/></p>\n\n<pre><code>PK   Company Position\n100   IBM      1000\n101   IBM      4000\n102   Dell     1000\n103   Hp      11000\n104   Hp      18000\n</code></pre>\n\n<p>So in the Positions above the IBM Trade ID 1 went to 2 Positions 100 and 101. Trade Id 2 also went to Position 101 giving a total of 4000</p>\n\n<p>Ok so the idea being that a trade can make up 1 or more positions and a position can have many trades. The business logic will determine what positions the trades flow to, so I have used A and B as flags for now just as an example.</p>\n\n<p>So to the question which is..</p>\n\n<p>When I select and aggregate from the Trades Table, I insert all the new positions that are made up from the various trades into the Positions table. Now what is the best way to create the mapping table.</p>\n\n<p>What I do at the moment is that I store the newly created Position Ids in a tempory table and then repeat the select that I would do to generate the postions in the first place.. and join to the tempory table. THis seems like a lot of duplication of code and I would like to know what the best practice is out there to do such a thing.</p>\n\n<p>best regards Mick</p>\n"},{"tags":["php","mysql","sql","query","opencart"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13257360,"title":"Using quotation mark in MySQL","body":"<p>I have a list of 1000 products I am currently importing into OpenCart. Some of the product titles contains an quotation mark to symbolise the inches (for example 5\").</p>\n\n<p>I have imported all of these products successfully using this query:</p>\n\n<pre><code>$data['name'] = mysql_escape_string($data['name']);\n$sql = \"INSERT INTO \".DB_PREFIX.\"product-description SET language_id = '1', name = '\".$data['name'].\"'\";\n$query = mysql_query($sql);\n</code></pre>\n\n<p>When I am in OpenCart the list of products also show proberly however when I go to edit the product the title input field (which is meant to show the title) cuts out the title from the \" symbol onwards.</p>\n\n<p>Here is a visual example:\n<img src=\"http://i.stack.imgur.com/HIpsV.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title is complete\n<img src=\"http://i.stack.imgur.com/93t7G.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title as been cut out after the \".</p>\n\n<p>I can confirm it is not an OpenCart coding error because if I manually insert products from the interface with a \" it works fine. The error must lie within my query.</p>\n\n<p>If there is a problem with my query, is there a query where I can update all the products rather than re-insert them?</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13266299,"title":"Query to Update Table using another table as information?","body":"<p>I have two tables, <code>Staff</code> and <code>Wages</code></p>\n\n<p><code>Staff</code> Contains </p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        \n  2   Name2       4      \n  3   Name3       1      \n  4   Name4       2      \n</code></pre>\n\n<p><code>Wages</code> Contains</p>\n\n<pre><code> JobID, Wage\n   1    1500\n   2    800\n   3    1600\n   4    2000\n</code></pre>\n\n<p>(There are alot more columns in the actual one I have just took the top 4)</p>\n\n<p>I am missing the wages inside the <code>Staff</code> table, and the wages I need in the staff table are the rates in the <code>Wages</code> table..</p>\n\n<p>So I need a query which would make the <code>Staff</code> table look like:</p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        800\n  2   Name2       4        2000\n  3   Name3       1        1500\n  4   Name4       2        800\n</code></pre>\n\n<p>An example Query which I tried was:</p>\n\n<pre><code>UPDATE `Staff` \nSET wage = (SELECT wage FROM `Wages`) \nWHERE jobID = (Select jobId FROM `Wages`)\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["query","lucene","wildcard","elasticsearch","proximity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13258997,"title":"elasticsearch Query - Wildcard or Stemming within a Span (i.e. Proximity Query)","body":"<p>I would like to construct an elasticsearch query (or filter) that detects whether two words with wildcards are within a certain distance of each other.  Is this possible with elasticsearch?</p>\n\n<p>For example, I would like a query that detects whether <code>pret*</code> and <code>ug*</code> are within five words of each other. Such a query should match <code>\"She is pretty and he is ugly.\"</code> </p>\n\n<p>I think I would need to use the <code>span_near</code> query, but <code>span_near</code> only accepts a series of <code>span_term</code>'s as arguments and <code>span_term</code> doesn't appear to allow wildcards.</p>\n\n<p>Is it possible to do this with elasticsearch? If not, is this possible with Lucene directly?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13265250,"title":"Query to return Pokemon with HP by Type","body":"<p>I have a database full of Pokemon Cards, and I want to do a query to find the pokemon that has the highest HP by each type. I want the view to show just the name, type, and HP of that pokemon.</p>\n\n<pre><code>SELECT MAX(HP), Type, name FROM `Pokemon` group by Type\n</code></pre>\n\n<p>I have this code. It returns the max HP but not the correct Pokemon. \nWill this code show multiple rows with the same HP for a single type?</p>\n"},{"tags":["sql-server-2008","query","table","select","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13263699,"title":"Is there any way to send a column value from outer query to inner sub query?","body":"<p>'Discussions' table schema</p>\n\n<pre><code>title      description    desid    replyto    upvote    downvote   views\nbrowser    used           a1        none        1          1       12\n-          bad topic      b2        a1          2          3       14\nsql        database       a3        none        4          5       34\n-          crome          b4        a3          3          4       12\n</code></pre>\n\n<p>The above table has two types of content types Main Topics and Comments. Unique content identifier 'desid' used to identify that its a main topic or a comment. 'desid' starts with 'a' for Main Topic and for comment 'desid' starts with 'b'. For comment 'replyto' is the 'desid' of main topic to which this comment is associated. </p>\n\n<p>I like to find out the list of the top main topics that are arranged on the basis of (upvote+downvote+visits+number of comments to it) addition. The following query gives top topics list in order of  (upvote+downvote+visits)</p>\n\n<p><code>select *</code> with highest number of <code>upvote+downvote+views</code> by query </p>\n\n<pre><code>select * \nfrom [DB_user1212].[dbo].[discussions] \nwhere desid like 'a%'\norder by (upvote+downvote+visited) desc\n</code></pre>\n\n<p>For (comments+upvote+downvote+views ) i tried </p>\n\n<pre><code>select *\nfrom [DB_user1212].[dbo].[discussions]\nwhere desid like 'a%'\norder by (select count(*)\n           from [DB_user1212].[dbo].[discussions]\n           where replyto = desid )+upvote+downvote+visited) desc \n</code></pre>\n\n<p>but it didn't work . Because its not possible to send desid from outer query to innner subquery. Please tell me how to solve this. Please note that I want solution in query language only.</p>\n"},{"tags":["sql-server","query","search","casting","binary"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13264305,"title":"SQL Server : Like Syntax and Add operator Error","body":"<p>I am using this syntax and it should work well if only it doesn't get an error.</p>\n\n<pre><code>SELECT\n   e.user_key,\n   e.char_key,\n   CONVERT(VARCHAR,substring(e.char_data, 9, 16)) AS name,\n   p.CHAR_DATA\nFROM \n   CHAR_DATA0 AS e\nINNER JOIN  \n   CHAR_DATA1 AS p ON e.CHAR_KEY = p.CHAR_KEY\nWHERE \n   p.CHAR_DATA LIKE '%'+CAST(cast(reverse(CONVERT(BINARY, 9998)) as BINARY(2)) AS BINARY(2))+'%'\nORDER BY \n   char_key\n</code></pre>\n\n<p>I need help. How to change this code for it to work?</p>\n\n<p><code>CHAR_DATA</code> column is of type <code>BINARY(2000)</code></p>\n\n<p>I have data like so: (got it using select)</p>\n\n<pre><code> 0x04005C03020F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBA3B8C08000000BB3B8C080000000F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBC3B8C08000000BD3B8C080000000F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBE3B8C08000000BF3B8C080000000F2789080100000F278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFC03B8C08000000C13B8C08000000B5388B08020000B5388B08020000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBA3B8C08000000BB3B8C08000000B5388B08020000B5388B08020000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBC3B8C08000000BD3B8C080000000E2789080100000E278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFBE3B8C08000000BF3B8C080000000E2789080100000E278908010000FFFFFFFFFFFFFF0E2787080100000E278708010000FFFFFFFFFFFFFFC03B8C08000000C13BFFFF000000FFFFFFFFFFFFFFFFFFFFFFFFFFFF0F27FFFF0100000F27FFFF0100000E2789080000000E278908000000FFFFFFFFFFFFFF7E107F08000000EC168408000000B0177D080000000F27FFFF0100000F27FFFF0100000E2789080000000E27890800000052167C081E000052167C081E0000E2167D08000000271F2005000000FFFFFFFFFFFFFFFFFFFFFFFFFFFF0E2787080100000E27870801000052167C081E000052167C081E0000FFFFFFFFFFFFFF13127F08000000C813FFFF1E0000C813FFFF1E00000E2787080100000E27870801000028127A08000000BF3B2D05000000FFFFFFFFFFFFFF13127F08000000C813FFFF1E0000C813FFFF1E0000FFFFFFFFFFFFFFFFFFFFFFFFFFFF28127A08000000FFFFFFFFFFFFFF1B1A80081A00001B1A80081A0000E915FFFF1B0000E915FFFF1B000023067A0800000024147B0800000020120D05000000084792080100001B1A80081A00001B1A80081A0000E915FFFF1B0000E915FFFF1B000025067A0800000024147B0800000020120D05000000E21610050000000000009D000000FFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\n</code></pre>\n\n<p>I need to search somewhere in those lines if it contains the entry I'm trying to find.</p>\n\n<p>What I'm trying to find is always 2 bytes. So I'm looking for 0x0E27 in the syntax above.</p>\n\n<p>This is a working syntax but its not what I want to do:</p>\n\n<pre><code>SELECT \n   CONVERT(INT,cast(reverse(substring(char_data, 37, 2)) as BINARY(2))) AS helm \nFROM CHAR_DATA0 \nWHERE CHAR_KEY = 5\n</code></pre>\n\n<p>Another this is if I use nvarchar(MAX) it gives results that doesn't even contain the data I'm trying to find.</p>\n"},{"tags":["mysql","sql","wordpress","query","posts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13071035,"title":"SQL query to extract all WordPress posts with categories","body":"<p>I need to extract all posts from my WordPress DB along with the associated categories and not sure how to write this query. I've taken a couple of stabs at it already with no joy and would appreciate the help?</p>\n\n<p><strong>EDIT: Here's what I have tried already:</strong></p>\n\n<pre><code>SELECT post_title, wpr.object_id, wp_terms.name\nFROM wp_terms\nINNER JOIN wp_term_taxonomy ON wp_terms.term_id = wp_term_taxonomy.term_id\nINNER JOIN wp_term_relationships wpr ON wpr.term_taxonomy_id = \nwp_term_taxonomy.term_taxonomy_id\nINNER JOIN wp_posts ON ID = wpr.object_id\nWHERE taxonomy = 'category' \nAND post_type = 'post' \nORDER by post_title\n</code></pre>\n\n<p>This seems to work but it returns 1,553 where I know I only have 1343 in my DB.</p>\n\n<p><strong>EDIT:</strong> \nWe did the same thing on another SQL query a little while ago and found that it was pulling in the revisions and other post types but thought that this was resolved using post_type = 'post'</p>\n\n<p><strong>EDIT:</strong>\nUpon looking at the number of categories in the DB, I come up with a total number of 216, 6 off the number if you subtract 1553 - 1343 = 216. So I think this total number of 1553 is coming from the wp_terms table which needs to be excluded and only those that are active with published posts should be shown?</p>\n\n<p><strong>EDIT:</strong>\nThe other possibility is that each post can have multiple categories, hence the reason for having more posts (1553). So how could I separate each posts into multiple categories?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13242249,"title":"Sorting mysql results by times from 3 tables","body":"<p>I have 3 tables: <code>questions</code>, <code>articles</code> and <code>pictures</code></p>\n\n<p>The rows in each table contain a current_timestamp column <code>posted</code>, and link to an id. I'd like to sort the results of the rows of all three by their timestamp and only echo the newest of the three (for example: if the question is newest from the ID, display that only)</p>\n\n<pre><code>if(count($interests) != 0){ foreach($interests as $interests_following){\n    $interestid = mysql_result(mysql_query(\"SELECT `id` FROM `interests` WHERE `name` = '$interests_following'\"),0);\n    $interestquestions = @mysql_result(mysql_query(\"SELECT `question_text`, `posted` FROM `questions` WHERE `interest` = '$interests_following'\"),0);\n    $interestarticles = @mysql_result(mysql_query(\"SELECT `article_title`, `posted` FROM `articles` WHERE `interest_id` = '$interestid'\"),0);\n    $interestpictures = @mysql_result(mysql_query(\"SELECT `interest_pic_title`, `posted` FROM `interest_pictures` WHERE `interest_id` = '$interestid'\"),0);\n\necho '.$interests_following.': //&lt;Only display 1 newest item (article/picture/question here&gt;\n</code></pre>\n"},{"tags":["query","solr","filter","schema"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13264580,"title":"Single schema versus multiple schemas in solr for different document types","body":"<p>What is the general rule of thumb when deciding between creating multiple schemas versus creating a single consolidated schema for different document types.</p>\n\n<p>For example, if I want to index a collection of products and a collection of articles, what general rules should be followed to determine whether they should be created in one schema (and then use solr fq filter query to filter on the document type) or created in two schemas. The number of overlapping fields? The need to return data across both document types and also be able to filter to a single type? </p>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13264168,"title":"Query to delete where id is other than multiple values?","body":"<p>How would I make a query to  delete the column where id is other than multiple values?</p>\n\n<p>I tried</p>\n\n<pre><code>DELETE FROM `Player` WHERE `Player`.`Squad` != 3,\n4,\n8,\n9,\n10,\n11,\n21, \n31,\n36,\n43,\n64,\n65,\n66,\n71,\n74,\n103,\n105,\n154,\n171,\n190;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13263615,"title":"sql error(1242) : sub query returns more than 1 row","body":"<p>i have two tables <code>a_daily</code> and <code>o_daily_lcsgeneration</code>:</p>\n\n<p>i am trying this query : </p>\n\n<pre><code>update a_daily\nset\n  a_daily.Turbine_Generation =  \n   (\n     select sum(o_daily_lcsgeneration.Turbine_Generation) \n     from o_daily_lcsgeneration \n     where o_daily_lcsgeneration.Location = 1 \n     group by o_daily_lcsgeneration.Date\n  ) \n</code></pre>\n\n<p>but received the above error saying sub query more than 1 row</p>\n"},{"tags":["php","sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13263569,"title":"Getting only the same result to appear in SQL","body":"<p>This is my code, later I will be putting it into php, but for the time being I am using it in a provided Query tester. We are doing the first degree of kevin bacon instead of the 6th.</p>\n\n<p><strong>My query is as follow:</strong> </p>\n\n<pre><code>SELECT name,year\nFROM actors\nJOIN roles ON roles.actor_id = actors.id\nJOIN movies ON movies.id=roles.movie_id\nWHERE actors.first_name= 'kevin' AND actors.last_name='bacon' OR actors.first_name= 'sean' AND actors.last_name='penn'\nORDER BY movies.name;\n</code></pre>\n\n<p><strong>it results in</strong> </p>\n\n<pre><code>Animal House 1978\nApollo 13 1995 \nFew Good Men, A 1992 \nFootloose 1984 \nHollow Man 2000 \nJFK 1991 \nMystic River 2003 \nMystic River 2003 \nPlanes, Trains &amp; Automobiles 1987 \nStir of Echoes 1999 \n</code></pre>\n\n<p><strong>How do I get it to show only Mystic River?</strong></p>\n"},{"tags":["sql","sql-server-2008","query","stored-procedures","triggers"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13193745,"title":"update column1 based on another column2 from same table without using trigger","body":"<p>scenario is :\nThere are many columns in my table like Col1 Col2 Col3 Col4.\nI want to set data of Col4 if VALUE of Col1 is changed. On firing update query value of Col1 may or may not change.</p>\n\n<p>I have implemented it through trigger.</p>\n\n<pre><code>Select @ISTDNotPossibleI = I.ISTDNotPossible From inserted i\nSelect @IsTDCompletedD = D.IsTDCompleted from deleted d\n\nIf (\n  (@IsTDCompletedD != @IsTDCompletedI) Or\n  (@ISTDNotPossibleD != @ISTDNotPossibleI) Or\n  (@IsTDDirectD != @IsTDDirectI) Or (\n    @IsTDCompletedD Is Null And\n    @IsTDCompletedI Is Not Null\n  ) Or (\n    @ISTDNotPossibleD Is Null And\n    @ISTDNotPossibleI Is Not Null\n  ) OR (\n    @IsTDDirectD Is Null And\n    @IsTDDirectI Is Not Null\n  )\n)\nBegin\n  Update \n    CRM_CarTDLog \n  Set\n    TDCompletedEventBy = @UpdatedBy,\n    TDCompletedEventOn = GetDate() \n  Where\n    Id = @UpdateID \nEnd\n</code></pre>\n\n<p>Problem is : this field is not likely to be updated regularly. But Col2 and Col3 are likely to be updated frequently. And since update query is being fired on this table frequently the trigger will be  fired frequently too. And it is increasing the overhead without serving any purpose.</p>\n\n<p>I want to solve this without using trigger. Please help me.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13262615,"title":"Construct query to create tables","body":"<p>I am currently working with a MySQL database table structure. I found a table structure online but i am not sure how to duplicate the exact tables structure. These tables share foreign keys and index with each other. I have attached a link that shows the tables are setup in the model I would like to duplicate. I am requesting help in creating a query that will create all tables with their correlated data.  <a href=\"http://webprolearner2346.zxq.net/class_des/\" rel=\"nofollow\">LINK- TABLE STRUCTURE</a></p>\n\n<p><strong>Foreign keys</strong></p>\n\n<pre><code>semester_id\nfaculty_id\nschedule_id\nsection_id\nclass_id\nmajor_minor_id\n</code></pre>\n"},{"tags":["c#","mysql","query","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13262638,"title":"Search datetime in MySQL","body":"<p>I have a MySQL database, there's a table which have column Time's Type is <strong>Nvachar(50)</strong> and <strong>its values</strong> is <strong>kind like this \"05/09/2012 20:53:40:843\"</strong> *<em>(Month-date-year hour:mins:second:msecond)</em>*</p>\n\n<p>Now I want to query to get a record have Time after \"10/05/2012 01:00:30 PM\".\nI had code in C# to converted it to \"05/10/2012 13:00:30\" before making a query.\nMy Query : </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>But i got no record. So please tell me how can I can make it return record have time after the time above ???  </p>\n\n<p>More Info My C# code :</p>\n\n<pre><code>string tableName = \"ABCDFEGH\";\nstring date = \"05/10/2012 13:00:30\";\n\nvar query = \"SELECT * FROM \" + tableName + \" WHERE capTime &gt; '\" + date + \"' LIMIT 0, 1\";\n\nvar cmd = new MySqlCommand(query, connection);\nMySqlDataReader dataReader = null;\ntry\n{\ndataReader = cmd.ExecuteReader();\n}\n</code></pre>\n\n<p>I'm so so so so so so sorry. I made a mistake the query must be</p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05/10/2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>This query is successful return the record i need :)</p>\n\n<p>But soemhow I have mistyped it into </p>\n\n<pre><code>SELECT * FROM ABCDFEGH WHERE capTime &gt; '05-10-2012 13:00:30' LIMIT 0, 1\n</code></pre>\n\n<p>Sorry again, topic close. But tks for evveryone tried :) </p>\n"},{"tags":["query","hibernate","grails","data-binding","gorm"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13262418,"title":"GORM delay in binding SQL param to a query","body":"<p>Trying to tweak a long running grails service and going through the SQL logs I find this behavior that is puzzling me a bit. The hibernate generated query is parametrized and one would hope that the query would be cached in the db-server and the binding should be instantaneous as well (used Burt Beckwith's suggestions to implement the SQL logging). </p>\n\n<pre><code>2012-11-06 00:30:39,488 [Thread-22] DEBUG hibernate.SQL  -\n    /* criteria query */ select\n..\n..\n2012-11-06 00:30:39,605 [Thread-22] TRACE sql.BasicBinder  -  - binding parameter [1] as [TIMESTAMP] - \n</code></pre>\n\n<p>So, it looks like binding is happening after 100ms. I would like to know why should this happen? Other queries report the same time for query and binding. What can be done to make it more efficient?</p>\n"},{"tags":["php","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":7,"view_count":66,"score":-7,"question_id":13260741,"title":"Why doesn't this query return any results?","body":"<p>The query below returns nothing, and frankly I do not understand why. Any hint will be appreciated. Must be an error in the code</p>\n\n<pre><code>$query = sprintf(\"SELECT *, \n    unix_timestamp(StartDate) AS SD FROM %s AS a\n    FROM \" . AL_ARTICLES_TABLE . \" AS art\n    INNER JOIN \" . AL_USERS_TABLE . \" AS u ON art.AuthorID = u.UserID\n    WHERE a.Visible=1 AND a.Status=1  \n    AND a.IsFinished=1     LEFT JOIN \" . AL_CATASSOC_TABLE . \" \n    AS ca ON art.ArticleID = ca.ArticleID\n    INNER JOIN \" . AL_CATEGORIES_TABLE . \" \n    AS c ON ca.CategoryID = c.CategoryID \n    WHERE ca.CategoryID IN(%s) \n    AND art.Featured=1  \n    AND art.Visible=1 \n    AND c.inrecent=1  \n    AND art.Status=1  \n    AND unix_timestamp(a.StartDate) &lt;= unix_timestamp(now()) \n    AND (unix_timestamp(a.ExpiryDate) &gt;= unix_timestamp(now()) \n    OR a.EnableExpiry=0) %s  \n    ORDER BY StartDate DESC, ArticleID DESC %s\", \n    AL_ARTICLES_TABLE, AL_USERS_TABLE, AL_CATASSOC_TABLE, AL_CATEGORIES_TABLE, $podcastQuery, $limitArticles);\n</code></pre>\n"},{"tags":["mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13252509,"title":"Query for correlated tables","body":"<p>I am currently trying to run a query that will show all tables that correlate with each other. I did not make the table design. So I am running into some trouble in making: It's not clear how <code>office_hours</code> table correlates with <code>schedule</code> table? Overall how can I display properly all tables that correlate through a query? </p>\n\n<pre><code>SELECT * \nFROM schedule\nINNER JOIN semester ON schedule.semester_id = semester.id\nINNER JOIN office_hours ON office_hours.id = schedule.???\n</code></pre>\n"},{"tags":["java","query","sparql","jena"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13255744,"title":"Trying to create a Sparql query using Jena's java api","body":"<p>I created an Ontology model in Java using the Apache Jena library, and I entered pizza ontology.\nI am trying to make a sparql query but the table print is blank, although normaly there are answers to my query.\nAm I doing something wrong...?\nHere is the code:</p>\n\n<pre><code>OntModel model = ModelFactory.createOntologyModel( OntModelSpec.OWL_MEM_MICRO_RULE_INF);\nString inputFileName=\"pizza.owl\";\nInputStream in = FileManager.get().open( inputFileName );\nif (in == null) {\n    throw new IllegalArgumentException(\n         \"File: \" + inputFileName + \" not found\");\n}\nmodel.read(in, null);\n\nString queryString =\n        \"prefix pizza: &lt;www.co-ode.org/ontologies/pizza/pizza.owl#Pizza&gt; \"+        \n        \"prefix rdfs: &lt;\" + RDFS.getURI() + \"&gt; \"           +\n        \"prefix owl: &lt;\" + OWL.getURI() + \"&gt; \"             +\n        \"select ?pizza where {?pizza a owl:Class ; \"      +\n        \"rdfs:subClassOf ?restriction. \"                  +\n        \"?restriction owl:onProperty pizza:hasTopping ;\"  +\n        \"owl:someValuesFrom pizza:PeperoniSausageTopping\" +\n        \"}\";\nQuery query = QueryFactory.create(queryString);\nQueryExecution qe = QueryExecutionFactory.create(query, model);\ncom.hp.hpl.jena.query.ResultSet results =  qe.execSelect();\n\nResultSetFormatter.out(System.out, results, query);\nqe.close();\n</code></pre>\n"},{"tags":["query","vba","null","recordset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13257484,"title":"VBA Recordset.MoveNext Returning E_FAIL on NULL","body":"<p>Good day,</p>\n\n<p>I have been having a problem with a bit of simple VBA.  I wrote a script to take a text query (with no input parameters so no real user interaction, SQL Injection, etc.), run it against a database, and dump it to a new worksheet.  This is a simple one-off for some developer analysis so the features are extremely simple.</p>\n\n<p>If the query returns values for every column, there is no problem.  However, if the query has any null values in it (as the result of a ROLLUP(), in my case), the entire subroutine will fail at MoveNext (NOTE: not the assignment of the null value to a cell).  Originally, the script was failing before the null row was ever even accessed at </p>\n\n<pre><code>Range(Cells(2, 1), Cells(rsData.RecordCount + 1, rsData.Fields.Count)).NumberFormat = \"@\"\n</code></pre>\n\n<p>This was commented and moved to be cell-by-cell with the intent of adding a check if the current cell is null (by far the most common suggestion on the internet).</p>\n\n<p>The queries have been verified using a back-end SQL editor and are correct.  Every other article that I have read has either been specific to a product or not applicable.  The question, then, is simply: how is one supposed to handle null values in a Recordset?  I would like to avoid removing the nulls on the database side, as this sub is used for many different queries and the thought of having to pepper my queries with a bunch of NVL() statements is quite displeasing.</p>\n\n<p>Thank you in advance for any assistance.  Full code is as follows:</p>\n\n<pre><code>Sub runReport(query As String, sheetName As String)\n\n    Dim cnDatabase As ADODB.Connection\n    Dim rsData As ADODB.Recordset\n    Dim row As Integer\n    Dim column As Integer\n\n    'Create new worksheet\n    Sheets.Add.Name = sheetName\n    Excel.Application.Worksheets(sheetName).Select\n\n    'Connect to database\n    Set cnDatabase = New Connection\n    cnDatabase.ConnectionString = \"Provider=OraOLEDB.Oracle;Data Source=DB.EXAMPLE.COM;User ID=FOO;Password=BAR;ChunkSize=1000;FetchSize=100;\"\n    cnDatabase.Open\n\n    'Retrieve dataset\n    Set rsData = New Recordset\n    Set rsData.ActiveConnection = cnDatabase\n    rsData.Source = query\n    rsData.CursorLocation = adUseClient\n    rsData.CursorType = adOpenStatic\n    rsData.Open\n\n    'Output header row\n    For column = 1 To rsData.Fields.Count\n        Cells(1, column).Value = rsData.Fields(column - 1).Name\n        Rows(1).Font.Bold = True\n    Next\n\n    'Set all fields as text\n    'Range(Cells(2, 1), Cells(rsData.RecordCount + 1, rsData.Fields.Count)).NumberFormat = \"@\"\n\n    'Output retrieved data from database\n    row = 2\n    While Not rsData.EOF\n      For column = 1 To rsData.Fields.Count\n         Cells(row, column).NumberFormat = \"@\"\n         Cells(row, column).Value = rsData.Fields(column - 1).Value\n      Next\n\n      rsData.MoveNext\n      row = row + 1\n   Wend\n   cnDatabase.Close\n\nEnd Sub\n</code></pre>\n"},{"tags":["mysql","query","many-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13260335,"title":"Querying Many-to-One in Mysql","body":"<p>The following image illustrates how my database is organized:</p>\n\n<p><img src=\"http://akplebani.com/graphic.png\" alt=\"a busy cat\"></p>\n\n<p>What I'm looking for is a <strong>single</strong> query wich results gives me <strong>coordinate_name</strong>, <strong>title_project</strong>, <strong>title_solution</strong> and <strong>name_client</strong>, based on coordinate <strong>date</strong>.</p>\n\n<p>I'm trying something like this:</p>\n\n<pre><code>SELECT coordinate_name, title_project, title_solution, name_client FROM coordinate NATURAL JOIN client WHERE date BETWEEN ? AND ?\n</code></pre>\n"},{"tags":["sql","query","razor","webmatrix"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12854901,"title":"how to add and divide results from sql queries","body":"<p>I have a database which I am trying to create a webpage summary widget for. I am using MS Webmatrix and razor.</p>\n\n<p>I have several select queries set as variables, then my html asks for their values as a string and displays them. So far so good.<br>\nNow I want to add two results together, then subtract a third. EG: add todays processed orders ( I called it itotl) and todays partly processed orders (ppr) and subtract todays credits (ctotl).<br>\nThus, i want (itotl + ppr) - ctotl.<br>\nIf I try and do this by entering the @itotl and @ppr variables etc in my html, it fails.<br>\nThere will be a simple, industry best practice way to do it but I'm only learning, and the hard way at that!</p>\n\n<p>Any Suggestions? I can paste the whole code in here if it will help.\nHere:<br>\n<code>@{<br>\n    Layout = \"~/_SiteLayout.cshtml\";<br>\n    Page.Title = \"SCOREBOARD\";<br>\n    var db = Database.Open(\"data\");<br>\n    var itot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and SUBTOTAL &gt;0\");<br>\n    var isum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.DR_TRANS where TRANSDATE = 41192 and Subtotal &gt;0\");<br>\n    var qsum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Subtotal &gt;0\");<br>\n    var ppr = db.QueryValue(\"select sum(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0 and status = 1\");<br>\n    var psum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Status =1\");<br>\n    var qtot = db.QueryValue(\"SELECT SUM(SUBTOTAL) FROM dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0\");<br>\n    var ctot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    var csum = db.QueryValue(\"SELECT COUNT(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    &lt;META HTTP-EQUIV=\"REFRESH\" CONTENT=\"15\"&gt;&lt;/META&gt;;<br>\n}</code>\n<code>&lt;!DOCTYPE html&gt;</code></p>\n\n<p><code>&lt;html lang=\"en\"&gt;</code>\n   <code>&lt;head&gt;<br>\n        &lt;meta charset=\"utf-8\" /&gt;<br>\n        &lt;title&gt;&lt;/title&gt;<br>\n        &lt;style&gt;<br>\n            .column1 {color: blue; font-weight: bold; font-size: 1.6em;}<br>\n            .column2 {color: red;}<br>\n        &lt;/style&gt;<br>\n    &lt;/head&gt;<br>\n    &lt;body&gt;<br>\n        &lt;p&gt;@qsum.ToString() Quotes:<br>\n            &lt;span class=@(qtot &gt; 20000 ? \"column1\" : \"column2\")&gt;@qtot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@psum.ToString() Partly Processed:<br>\n            &lt;span class=@(ppr &gt; 18000 ? \"column1\" : \"column2\")&gt;@ppr.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@isum.ToString() Invoices:<br>\n            &lt;span class=@(itot &gt; 18000 ? \"column1\" : \"column2\")&gt;@itot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@csum.ToString() Credits:<br>\n            &lt;span class=@(ctot &gt; 18000 ? \"column1\" : \"column2\")&gt;@ctot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;Nett Sales:&lt;/p&gt;<br>\n    &lt;/body&gt;<br>\n&lt;/html&gt;</code>  </p>\n\n<p>How do I get my markup to show tidily in stack? This has rendered a little hard to read!</p>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13259028,"title":"SQL Server bulk insert - \"Bulk load data conversion error\"","body":"<pre><code>bulk insert dbo.A\nFROM 'd:\\AData.csv'\nWITH \n(\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\n</code></pre>\n\n<p>Inserting bulk data into a database, I approached an unexplainable error after review of the suspect data:</p>\n\n<blockquote>\n  <p><em>Msg 4867, Level 16, State 1, Line 6</em><br>\n  <em>Bulk load data conversion error (overflow) for row 1, column 42 (FES).</em></p>\n</blockquote>\n\n<p>Column FES was <code>tinyint</code>, now <code>smallint</code>. <code>d:\\AData.csv</code> contains a <code>2</code> in row 1, column 42. Are there any other sources for this type of error?</p>\n\n<p>---APPEND---</p>\n\n<p>I'm not sure how to properly post this. </p>\n\n<p>Create Table Script </p>\n\n<pre><code>create table AcsBy320082010Hus(\nserialnoId bigint,\nRT char,\nDIVISION tinyint,\nPUMA int,\nREGION tinyint,\nST tinyint,\nADJHSG int,\nADJINC int,\nWGTP int,\nNP tinyint,\nTYPE tinyint,\nACR tinyint,\nAGS tinyint,\nBDS tinyint,\nBLD tinyint,\nBUS tinyint,\nCONP smallint,\nELEP smallint,\nFS smallint,\nFULP int,\nGASP int,\nHFL tinyint,\nINSP varchar(6),\nKIT tinyint,\nMHP int,\nMRGI tinyint,\nMRGP int,\nMRGT tinyint,\nMRGX tinyint,\nPLM tinyint,\nRMS tinyint,\nRNTM tinyint,\nRNTP int,\nSMP int,\nTEL tinyint,\nTEN tinyint,\nVACS tinyint,\nVAL tinyint,\nVEH tinyint,\nWATP int,\nYBL tinyint,\nFES tinyint,\nFINCP int,\nFPARC tinyint,\nGRNTP int,\nGRPIP tinyint,\nHHL tinyint,\nHHT tinyint,\nHINCP int,\nHUGCL bit,\nHUPAC tinyint,\nHUPAOC tinyint,\nHUPARC tinyint,\nLNGI tinyint,\nMV tinyint,\nNOC tinyint,\nNPF tinyint,\nNPP bit,\nNR bit,\nNRC tinyint,\nOCPIP tinyint,\nPARTNER tinyint,\nPSF bit,\nR18 bit,\nR60 tinyint,\nR65 tinyint,\nRESMODE tinyint,\nSMOCP int,\nSMX tinyint,\nSRNT bit,\nSVAL bit,\nTAXP tinyint,\nWIF tinyint,\nWKEXREL tinyint,\nWORKSTAT tinyint,\nFACRP bit,\nFAGSP bit,\nFBDSP bit,\nFBLDP bit,\nFBUSP bit,\nFCONP bit,\nFELEP bit,\nFFSP bit,\nFFULP bit,\nFGASP bit,\nFHFLP bit,\nFINSP bit,\nFKITP bit,\nFMHP bit,\nFMRGIP bit,\nFMRGP bit,\nFMRGTP bit,\nFMRGXP bit,\nFMVYP bit,\nFPLMP bit,\nFRMSP bit,\nFRNTMP bit,\nFRNTP bit,\nFSMP bit,\nFSMXHP bit,\nFSMXSP bit,\nFTAXP bit,\nFTELP bit,\nFTENP bit,\nFVACSP bit,\nFVALP bit,\nFVEHP bit,\nFWATP bit,\nFYBLP bit,\nWGTP1 int,\nWGTP2 int,\nWGTP3 int,\nWGTP4 int,\nWGTP5 int,\nWGTP6 int,\nWGTP7 int,\nWGTP8 int,\nWGTP9 int,\nWGTP10 int,\nWGTP11 int,\nWGTP12 int,\nWGTP13 int,\nWGTP14 int,\nWGTP15 int,\nWGTP16 int,\nWGTP17 int,\nWGTP18 int,\nWGTP19 int,\nWGTP20 int,\nWGTP21 int,\nWGTP22 int,\nWGTP23 int,\nWGTP24 int,\nWGTP25 int,\nWGTP26 int,\nWGTP27 int,\nWGTP28 int,\nWGTP29 int,\nWGTP30 int,\nWGTP31 int,\nWGTP32 int,\nWGTP33 int,\nWGTP34 int,\nWGTP35 int,\nWGTP36 int,\nWGTP37 int,\nWGTP38 int,\nWGTP39 int,\nWGTP40 int,\nWGTP41 int,\nWGTP42 int,\nWGTP43 int,\nWGTP44 int,\nWGTP45 int,\nWGTP46 int,\nWGTP47 int,\nWGTP48 int,\nWGTP49 int,\nWGTP50 int,\nWGTP51 int,\nWGTP52 int,\nWGTP53 int,\nWGTP54 int,\nWGTP55 int,\nWGTP56 int,\nWGTP57 int,\nWGTP58 int,\nWGTP59 int,\nWGTP60 int,\nWGTP61 int,\nWGTP62 int,\nWGTP63 int,\nWGTP64 int,\nWGTP65 int,\nWGTP66 int,\nWGTP67 int,\nWGTP68 int,\nWGTP69 int,\nWGTP70 int,\nWGTP71 int,\nWGTP72 int,\nWGTP73 int,\nWGTP74 int,\nWGTP75 int,\nWGTP76 int,\nWGTP77 int,\nWGTP78 int,\nWGTP79 int,\nWGTP80 int)\n</code></pre>\n\n<p>Headers row </p>\n\n<blockquote>\n  <p>serialno,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BATH,BDSP,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,MHP,MRGI,MRGP,MRGT,MRGX,REFR,RMSP,RNTM,RNTP,RWAT,SINK,SMP,STOV,TEL,TEN,TOIL,VACS,VALP,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,KIT,LNGI,MULTG,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PLM,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBATHP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP,FMVP,FPLMP,FREFRP,FRMSP,FRNTMP,FRNTP,FRWATP,FSINKP,FSMP,FSMXHP,FSMXSP,FSTOVP,FTAXP,FTELP,FTENP,FTOILP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80</p>\n</blockquote>\n\n<p>Row 1</p>\n\n<blockquote>\n  <p>2008000000023,H,6,01300,3,01,1012650,1031272,00043,04,1,1,,1,02,02,2,0000,150,2,0002,020,3,00150,,2,00980,1,1,1,03,,,1,1,,1,1,1,1,,0210000,2,0080,09,2,000058100,2,,,4,1,000058100,0,3,3,3,1,1,1,3,02,04,0,0,02,024,0,1,0,1,0,0,1,01170,3,0,1,19,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,00112,00045,00068,00017,00044,00091,00071,00032,00036,00042,00048,00041,00013,00031,00063,00013,00037,00017,00063,00098,00026,00036,00017,00065,00036,00020,00014,00035,00037,00046,00047,00048,00080,00034,00012,00061,00031,00069,00043,00060,00011,00050,00016,00057,00050,00013,00016,00068,00056,00039,00042,00049,00081,00041,00012,00092,00050,00055,00049,00016,00062,00041,00103,00012,00048,00060,00073,00052,00063,00038,00047,00040,00017,00040,00059,00020,00042,00010,00038,00018</p>\n</blockquote>\n\n<p><a href=\"http://www.census.gov/acs/www/Downloads/data_documentation/pums/DataDict/PUMS_Data_Dictionary_2008-2010.pdf\" rel=\"nofollow\">Link to ACS 2008-2010 Data Dictionary</a></p>\n"},{"tags":["php","mysql","query","combine"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13259250,"title":"PHP & MySQL: How to combine UPDATE and SELECT (with min function) queries","body":"<p>I'm trying to select a row with the least value from a MySQL table and update the flag column for that row using PHP. But it's not working for me. If I break it into two queries, it works, but combining the two isn't going anywhere. What am I doing wrong?</p>\n\n<p>Here's what works:</p>\n\n<pre><code>$flag = 1;\n$query = \"SELECT MIN(value) FROM \". $myTable;\n$data = mysqli_query($dbh, $query);\n$dataSet = mysqli_fetch_row($data);\n$value = $dataSet[0];\n$queryUpdate = \"UPDATE \". $myTable . \" SET flag='\" . $flag . \"' WHERE value='\" . $value. \"'\";\n$dataUpdate = mysqli_query($dbh, $queryUpdate);\n</code></pre>\n\n<p>Here are attempts I made but failed:</p>\n\n<pre><code>//attempt #1\n$flag = 1;\n$query = \"UPDATE \". $myTable . \" SET flag='\" . $flag . \"' WHERE value=( SELECT MIN(value) FROM '\". $myTable . \"')\";\n$data = mysqli_query($dbh, $query);\n\n// attempt #2\n$flag = 1;\n$query = \"UPDATE \". $myTable . \" SET flag='\" . $flag . \"' ORDER BY value ASC LIMIT 1\";\n$data = mysqli_query($dbh, $query);\n\n// attempt #3\n$flag = 1;\n$query = \"UPDATE \". $myTable . \" T1 \nINNER JOIN ( SELECT MIN(value) FROM \". $myTable . \" ) T2\nON T1.id = T2.id\nSET T1.flag=\" . $flag;\n$data = mysqli_query($dbh, $query);\n</code></pre>\n\n<p>mysqli_error() returns </p>\n\n<blockquote>\n  <p>Warning: mysqli_error() expects exactly 1 parameter, 0 given [in the $data = mysqli_query($dbh, $query) lines.]</p>\n</blockquote>\n\n<p>Any help would be so appreciated.</p>\n"},{"tags":["php","mysql","query","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13241092,"title":"Stored MySQL Procedures vs. Dynamic MySQL Queries","body":"<p>I'm developing a basic php based function that executes MySQL queries in order to sort the data in the database and present it to the user. As a general statement, is it considered best practice to simply construct static queries and to execute them as needed, or simply piece together elements of a MySQL statement based on conditions? </p>\n\n<p>To narrow the question, I have a specific example:</p>\n\n<p>Say I have a few drop-down menus that define the search on the user's end. Let one drop-down simply contain a list of names, say Bob Smith, and the two others a date range. From there, I can easily create a search along the lines of <code>SELECT item FROM checkOUT WHERE...</code> I can definitely write a general query with parameters to be executed when ALL three of the parameters are present. Consider the case when only a date range is selected regardless of individuals - that would require only two parameters and a different general query. And what if the data is spread across multiple tables? That has to be taken into account. I should add as well that my function is based on drop-down menus - not original user input.</p>\n\n<p>Basically, what would be the best method to create the MySQL Query - prepared statements or dynamically created statements? Obviously, the end result will rely on a hybrid of the two, but to which side it leans the farthest is the issue. I'm asking this question as I am not too familiar with this particular side of handling multiple queries from one source. Typically, I simply have to execute one query to get what I need and work with it - not sorting.</p>\n\n<p>Any insight is appreciated.  </p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13254141,"title":"How do I use DateTime from one result set as start and end date for another query?","body":"<p>OK, I have product with serial numbers running through a production line. I read and store times when these serial number are read at different locations. </p>\n\n<p>I can query this data and get:</p>\n\n<pre><code>Tagname - Barcode reader identifier.\nDateTime - DateTime of read.\nValue - Serial Number.\n</code></pre>\n\n<p>I need to look at the process values of a tool from the time that the reader reads a specific Serial Number before the tool and the time it reads that same serial number after the tool. I would like to average, min/max, etc. the values but I haven't figured out how to use the DateTime of the barcode reads to act as the StartDate and EndDate of the process values query.</p>\n\n<p>Any help would be very much appreciated.</p>\n\n<p>Process Query:</p>\n\n<pre><code>SET NOCOUNT ON\nDECLARE @StartDate DateTime\nDECLARE @EndDate DateTime\nSET @StartDate = '20121106 08:48:26.000'\nSET @EndDate = '20121106 08:53:26.000'\nSET NOCOUNT OFF\nSELECT  * \nFROM (SELECT History.TagName, DateTime, Value, vValue, StartDateTime\n      FROM History\n      WHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\n      AND wwRetrievalMode = 'Average'\n      AND wwCycleCount = 10\n      AND wwVersion = 'Latest'\n      AND DateTime &gt;= @StartDate\n      AND DateTime &lt;= @EndDate) temp \nWHERE temp.StartDateTime &gt;= @StartDate\n</code></pre>\n\n<p>I want to get the data based on barcode reads before and after the tool. I tried some things like:</p>\n\n<pre><code>SELECT History.TagName, DateTime, Value\nFROM History\nWHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\nAND DateTime &gt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber',\n                                           'MES_110A.PVD1101R_In_SerialNumber' )\n                 AND Value = '100056134')\nAND DateTime &lt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110B.SCR1101_SerialNumber',\n                                           'MES_110B.SCR1102_SerialNumber')\n                 AND Value = '100056134')\n</code></pre>\n\n<p>OK, I made some changes. Now I have:</p>\n\n<pre><code>    SET NOCOUNT ON\n    DECLARE @StartDate DateTime\n    DECLARE @EndDate DateTime\n    SET @StartDate = (SELECT DateTime\n                              FROM History\n                              WHERE History.TagName IN  ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n                              AND Value = '100056130'\n                              AND DateTime &gt;= '20121106 05:39:48.000'\n                              AND DateTime &lt;= '20121106 23:39:48.000')\n    SET @EndDate = (SELECT DateTime\n                           FROM History\n                           WHERE TagName IN ('MES_110B.SCR1101_In_SerialNumber', 'MES_110B.SCR1102_In_SerialNumber' )\n                           AND Value = '100056130'\n                           AND DateTime &gt;= '20121106 05:39:48.000'\n                           AND DateTime &lt;= '20121106 23:39:48.000')\n    SET NOCOUNT OFF\n\n    SELECT TagName, AVG (Value) AS \"Average\"\n     FROM History\n     WHERE History.TagName IN  ('PVD1101_01.CHU1_Return_Water_Pressure', 'PVD1101_01.CHU1_Return_Water_Temp', 'PVD1101_01.5CT11_IN_Supply_Temp', 'PVD1101_01.5CT11_Out_Return_Temp')\n     AND DateTime &gt;= @StartDate\n     AND DateTime &lt;= @EndDate\n    GROUP BY TagName\n</code></pre>\n\n<p>This returns the values I am looking for. I will make the serial number value a parameter for the reports and it should work. Does this look totally convoluted and inefficient?</p>\n\n<p>I do need one more thing. This subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n</code></pre>\n\n<p>Returns Null. This Subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n     AND DateTime &gt;= '20121106 05:39:48.000'\n     AND DateTime &lt;= '20121106 23:39:48.000'\n</code></pre>\n\n<p>Returns a value. Why?</p>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13258021,"title":"distinct condition in case statement","body":"<p>I have a SQL that returns a cnt1 and cnt2 for each Event_ID, while testing a condition for column \"POSA\" </p>\n\n<p>this returns the following as desired:</p>\n\n<p>Event_ID | CNT1 | CNT2</p>\n\n<p>I would like to add another condition to each CASE statement that tests if another column \"S\" in the same table is distinct.  Below is the code snippet:</p>\n\n<pre><code>SELECT Event_ID, \n sum  \n (CASE WHEN POSA IN ('SX', 'DX')  THEN 1 \n    ELSE 0 \n END) \n AS cnt1,\nsum \n(CASE  \n    WHEN POSA IN ('SP', 'DP')  THEN 1 \n    ELSE 0 \n END) AS cnt2\n\n\nFROM Station_Processed_Info GROUP BY EVENT_ID;\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13258442,"title":"SELECT DISTINCT HAVING Count unique conditions","body":"<p>I've searched for an answer on this but can't find quite how to get this distinct recordset based on a condition.  I have a table with the following sample data:</p>\n\n<pre><code>Type    Color   Location    Supplier\n----    -----   --------    --------\nApple   Green   New York    ABC\nApple   Green   New York    XYZ\nApple   Green   Los Angeles ABC\nApple   Red     Chicago     ABC\nApple   Red     Chicago     XYZ\nApple   Red     Chicago     DEF\nBanana  Yellow  Miami       ABC\nBanana  Yellow  Miami       DEF\nBanana  Yellow  Miami       XYZ\nBanana  Yellow  Atlanta     ABC\n</code></pre>\n\n<p>I'd like to create a query that shows the count of unique locations for each distinct Type+Color where the number of unique locations is more than 1, e.g.</p>\n\n<pre><code>Type    Color   UniqueLocations\n----    -----   --------\nApple   Green   2\nBanana  Yellow  2\n</code></pre>\n\n<p>Note that {Apple, Red, 1} doesn't appear because there is only 1 location for red apples (Chicago).  I think I've got this one (but perhaps there is a simpler method).  I'm using:</p>\n\n<pre><code>SELECT Type, Color, Count(Location) FROM\n(SELECT DISTINCT Type, Color, Location FROM MyTable)\nGROUP BY Type, Color HAVING Count(Location)&gt;1;\n</code></pre>\n\n<p>How can I create another query that lists the <code>Type, Color</code>, and <code>Location</code> for each distinct <code>Type,Color</code> when the count of unique locations for that <code>Type,Color</code> is greater than 1?  The resulting recordset would look like:</p>\n\n<pre><code>Type    Color   Location\n----    -----   --------\nApple   Green   New York\nApple   Green   Los Angeles\nBanana  Yellow  Miami\nBanana  Yellow  Atlanta\n</code></pre>\n\n<p>Note that <code>Apple, Red, Chicago</code> doesn't appear because there is only 1 location for red apples.  Thanks!</p>\n"},{"tags":["sql","mysql","query","table","drop"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":5119,"score":11,"question_id":1589278,"title":"SQL: deleting tables with prefix","body":"<p>i know how to delete my tables in MySQL, </p>\n\n<pre><code>DROP TABLE\n</code></pre>\n\n<p>but now i need to know how to delete my tables who all have the prefix</p>\n\n<pre><code>myprefix_\n</code></pre>\n\n<p>How to?</p>\n\n<p>--I NEED TO DO THIS IN PHPMYADMIN, IN A BROWSER. NO TERMINAL STUFF PLEASE. BATCH STUFF IS ALWAYS APRECIATED.--</p>\n"},{"tags":["mysql","sql","query","reservation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13239084,"title":"MySQL Reservation System - Testing for multiple conditions","body":"<p>I'm working on a reservation system in MySQL and I'm having a bit of trouble with my query for finding the next available appointment slots.</p>\n\n<p>My days are broken down into 15-minute slots (00:00:00 - 00:14:59, 00:15:00 - 00:29:59, etc.).  Table structure so far:</p>\n\n<p><strong>appointments table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `appointments` (\n`appointmentID` int(9) unsigned NOT NULL AUTO_INCREMENT,\n`patientID` int(9) unsigned NOT NULL,\n`apptTitle` varchar(50) NOT NULL,\n`apptDT` datetime NOT NULL,\n`apptLength` int(4) NOT NULL,\n`apptStatus` varchar(25) NOT NULL,\n`physician` int(9) unsigned NOT NULL,\n`apptType` varchar(30) NOT NULL,\n`apptLocation` varchar(25) NOT NULL,\nPRIMARY KEY (`appointmentID`),\nKEY `patientID` (`patientID`),\nKEY `physician` (`physician`),\nKEY `apptStatus` (`apptStatus`),\nKEY `apptLocation` (`apptLocation`),\nKEY `apptType` (`apptType`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n</code></pre>\n\n<p><strong>apptSlots Table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `apptSlots` (\n`startDT` datetime NOT NULL,\n`endDT` datetime NOT NULL,\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>The apptSlots table is already filled with all the 15 minute slots for 2012, as I explained above.</p>\n\n<p>I have a query that can successfully show me the slots that aren't taken in any way (no appointments scheduled at all).</p>\n\n<pre><code>SELECT a.*\nFROM apptSlots AS a\nLEFT JOIN appointments AS b\nON a.endDT\nBETWEEN b.apptDT AND DATE_ADD(b.apptDT, INTERVAL b.apptLength MINUTE)\nAND b.appointmentID IS NULL\n</code></pre>\n\n<p>What I need to do now is search for appointment slots across multiple physicians, multiple rooms, etc.  For example, if Physician A makes an appointment for 7am - 8am, that time slot no longer shows up in my query above.  But Physician B and C don't have any appointments for that slot, so I need to be able to schedule them.  The same goes for rooms, Room A is used by the 7am appointment, but room B and C are still free to be scheduled.</p>\n\n<p>How can I determine open slots with all these variables?  I know I can test with WHERE conditions for each combination and this works if I need to test for a specific doctor, or a specific room for a treatment.  But, if I just want to see all slots across all doctors and rooms, my query doesn't work and testing all possible combinations individually doesn't seem right, it's just a matter of how to get the right conditions into the LEFT JOIN clause.</p>\n\n<p>Please let me know if I'm being unclear, but I think this is enough info.  If not, I'll add in whatever you ask for!</p>\n\n<p>Thank you for your help, my previous question on here got me as far as my query above, now I just need some refinement.  Ask any questions you need, I'll be here to answer them!</p>\n"},{"tags":["sql","sql-server","query","tsql","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13257860,"title":"When I run simple select query, is it possible not to show number of rows affected at the end?","body":"<p>I try to use OSQL in order to save query results in text file and later bulk insert those text file to a table. OSQL part is ok, however, in bulk insert, number of rows affected at the end of query results causes error. Here is an example;</p>\n\n<pre><code>select item_number, description, price from item\n\n3536114   Fruit mix     $3.99\n\n3536229   DO 20 liquid  $9.99\n\n3536251   Peppermint    $7.99\n\n(3 rows affected) ------&gt; I do not need this line.\n</code></pre>\n"},{"tags":["mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13253814,"title":"MySQL query to retrieve items that have an exact match in a many-to-many relationship","body":"<p>I have the following tables:</p>\n\n<pre><code>Media:\n- mediaid\n- mediatitle\n\n\nMediaTag:\n- mediaid\n- mediatag\n\n\nTag:\n- tagid\n- tagname\n</code></pre>\n\n<p>The following tags:</p>\n\n<pre><code>Tag: (1) - Public\nTag: (2) - Premium\nTag: (3) - Restricted\n</code></pre>\n\n<p>The following media with tags:</p>\n\n<pre><code>Media: (1) - Public\nMedia: (2) - Premium &amp; Restricted\nMedia: (3) - Premium\nMedia: (4) - Restricted\nMedia: (5) - No tags\n</code></pre>\n\n<p>Assume that a user has permissions to see only <code>Public (1)</code> and <code>Restricted (3)</code> tags. If a media has a combination of tags that the user doesn't have explicit access to, he's not allowed to see it. If a media has no tag it's not visible at all. So the user in this case would be able to see only <code>Media 1</code> and <code>Media 4</code>.</p>\n\n<p>Is it possible to write a MySQL query to retrieve the media assuming I have the user permissions in the form of an array with tag IDs <code>(1,3)</code> ?</p>\n"},{"tags":["sql","database","performance","query","filter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257155,"title":"Architecture for a fast screener","body":"<p>I'm building a screener that should be able to search through a table about 50 columns wide and 7000 rows long really fast.</p>\n\n<p>Each row is composed of the following columns.</p>\n\n<p>primary_key, quantity1, quantity2, quantity3...quantity50.</p>\n\n<p>All quantities are essentially floats or integers. Hence a typical screener would look like this.</p>\n\n<pre><code>Get all rows which have quantity1 &gt; x and quantity2 &lt; y and quantity3 &gt;= z.\n</code></pre>\n\n<p>Indexing all columns should lead to really fast search times however some of the columns will be updating in realtime. Indexing everything obviously leads to very low insert/update times.</p>\n\n<p>A portion of the columns are fairly static though. Hence an idea was to segregate the data into two tables, one containing all columns that are static while the other containing data that is dynamic. Any screener would then be applied to both tables based on the actual query. And the results combined in the end.</p>\n\n<p>I am currently planning on using a MySQL engine, most probably INNoDB. However I'm looking to get much faster response times. An implementation of the same problem on a certain site was very snappy. Regardless of the query size, i was getting the results within 500 ms. Wondering what other options are available out there to implement this function.</p>\n\n<p>Any thoughts/hints towards a potential solution would be greatly appreciated.</p>\n"},{"tags":["sql","query","optimization","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13256383,"title":"SQL query: how to distinct count of a column group by another column","body":"<p>In my table I need to know if each <code>ID</code> has one and only one <code>ID_name</code>. How can I write such query?</p>\n\n<p>I tried:</p>\n\n<pre><code>select ID, count(distinct ID_name) as count_name \nfrom table \ngroup by ID \nhaving count_name &gt; 1\n</code></pre>\n\n<p>But it takes forever to run. </p>\n\n<p>Any thoughts?</p>\n"},{"tags":["mysql","query","search-engine","information-extraction","data-extraction"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":13,"score":-1,"question_id":13256513,"title":"Extraction Error in query processing","body":"<p>In our project we have to find errors in the result extraction from search engines.\nCan anybody explain what exactly is the extraction error in query processing and what may be an example of one?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13255478,"title":"Simple MySQL Query Help: How to Get All Users who have one field value but not another","body":"<p>Pretty bad at MySQL as I've only done light web design and SQL on oracle dbs. Say I have a table listing all the fruits people like.</p>\n\n<pre><code>name   fruit\n------------\njohn   bananas\njohn   oranges\nmarcy  bananas\ndave   oranges\nlucy   bananas\nlucy   oranges\n</code></pre>\n\n<p>Say I wanted to get all the names of people that liked oranges but didn't specify if they liked bananas. There's only two possible fruits in this table. (It may expand to more but there are generally only two).</p>\n\n<p>What would the query be? I want a query that only returns \"dave\" because marcy has only specified she likes bananas, and john and lucy say they like both. I don't think I need a join since this is only one table.</p>\n\n<p>I'm trying</p>\n\n<pre><code>select name from table\nwhere(--uhm.. use the stuff below somehow\nselect name from table\nwhere fruit like 'bananas';\nselect name from table\nwhere fruit like 'oranges';\n)\n</code></pre>\n\n<p>I would also be really happy with a query that returned all the people that like oranges but not bananas, or bananas but not oranges instead. I don't know which query would be easier.</p>\n\n<p>Also I'm sure I'd be able to find someone else with the same problem on the internet. What query would you use on google to answer my question?</p>\n"},{"tags":["query","coldfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1743,"score":5,"question_id":2581394,"title":"How to get a dynamic attribute name in cfloop over query in ColdFusion","body":"<p>I'm inside a <code>cfloop</code> over a query. I want to get an attribute, but I won't know what that attribute will be until runtime. Using <code>#qryResult[MyAttr]#</code> fails with the error \"Complex object types cannot be converted to simple values.\"  What is the syntax for doing this?</p>\n\n<p>Here is a simplified example:</p>\n\n<pre><code>&lt;cfquery datasource=\"TestSource\" name=\"qryResult\"&gt;\n    SELECT * FROM MyTable\n&lt;/cfquery&gt;\n\n&lt;cfloop query=\"qryResult\"&gt;\n    &lt;cfset MyAttr=\"autoid\" /&gt;\n    &lt;cfoutput&gt;\n        Test 1: #qryResult.autoid# &lt;br/&gt;  &lt;!--- succeeds ---&gt;\n        Test 2: #qryResult[MyAttr]# &lt;br/&gt; &lt;!--- fails ---&gt;\n    &lt;/cfoutput&gt;\n&lt;/cfloop&gt;\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13254109,"title":"How to determine the place of a row in ordered SQL table?","body":"<p>I have a table of users and a 'points' column. I would like to determine the number/place of the row across all the users ordered by 'points'.</p>\n\n<p>I could just get result of all users data and then do while loop, and stop when id equals necessary user. But I believe there is a more efficient way do to that because my table will contain ~100 000 rows.</p>\n"},{"tags":["sql","sql-server","query","sql-server-2005"],"answer_count":9,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":76,"score":-1,"question_id":13253445,"title":"Select Part of Column","body":"<p>I was wondering if anyone could help with a query to select part of a column.</p>\n\n<p>The column 'criteriadata' contains data that would look like this:</p>\n\n<blockquote>\n  <p><strong>CriteriaData</strong></p>\n  \n  <p>14 27 15 C</p>\n  \n  <p>14 30 15 DD</p>\n  \n  <p>14 38 15 Pass</p>\n  \n  <p>14 33 15 Pass</p>\n</blockquote>\n\n<p>How can I select just the data that appears after the number 15.</p>\n\n<p>Many thanks.</p>\n"},{"tags":["php","mysql","query","where"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13242955,"title":"php mysql query error with \"where\"","body":"<p>I'm running a query on our customer order database to see the sales from the last week. The query looks like this:</p>\n\n<pre><code>select\ndistinct day(from_unixtime(customerorder.datetime)) as day,\ncount(distinct customerorder.customerorderid) as count_totalorders,\ncount(distinct customerorderpos.itemid) as count_differentitems,\nsum(customerorderpos.quantity_ordered) as quantity_ordered,\nsum(customerorderpos.itemsubtotal) as item_subtotal,\nsum(customerorderpos.pricechangetotal) as item_pricechangetotal,\nsum(customerorderpos.itemtotal) as item_total,\nsum(customerorderpos.purchase_price * customerorderpos.quantity_ordered) as item_purchasepricetotal,\nsum(distinct cart_discounttotal) as total_discount,\nsum(customerorderpos.itemtotal - (customerorderpos.purchase_price * customerorderpos.quantity_ordered) - (select distinct cart_discounttotal)) as item_earningstotal,\nsum(distinct cart_total_shipping) as total_shipping,\nsum(distinct cart_total_tax) as total_tax,\nsum(distinct cart_total_complete) as total_complete\nfrom customerorder\ninner join customerorderpos on customerorder.customerorderid = customerorderpos.customerorderid\nwhere\ncustomerorder.datetime &gt;= 1351494000 and\ncustomerorder.status_cancelled = \"0\"\ngroup by day(from_unixtime(customerorder.datetime))\norder by customerorder.datetime\n</code></pre>\n\n<p>When I enter the query in PhpMyAdmin in works fine and shows the last 7 days orders. But when we run it in our own software it gives an error.</p>\n\n<pre><code>$result = $db-&gt;query($query);\nwhile ($row = $result-&gt;fetch_assoc()){\n</code></pre>\n\n<p>This shows: \"Fatal error: Call to a member function fetch_assoc() on a non-object\"</p>\n\n<p>But.... if I take out \"where customerorder.datetime >= 1351494000\" from the query it works fine.\nIn other words the query works perfectly until I want to limit it to a specific time. Customerorder.datetime is an int(11) column with a timestamp.</p>\n\n<p>Any ideas what the problem could be?</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["sql-server","query","tsql","time"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":53,"score":-2,"question_id":13246987,"title":"TSQL query to sum time periods per range","body":"<p>I need to create a query to sum day's hours and night's hours from a range intersec.\nFor example with this range:</p>\n\n<pre><code>8AM-8PM -&gt; day\n8PM-8AM -&gt; night\n</code></pre>\n\n<p>and one or more start-end time period:</p>\n\n<pre><code>7.30AM 10.00PM\n</code></pre>\n\n<p>I would like to get this values:</p>\n\n<pre><code>12 day's hours\n2.5 night's hours\n</code></pre>\n\n<p>I don't know which is the bast way to accomplish this function.</p>\n"},{"tags":["sql","performance","query","postgresql","postgresql-performance"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":83,"score":3,"question_id":13234812,"title":"Improving query speed: simple SELECT in big postgres table","body":"<p>I'm having trouble regarding speed in a SELECT query on a Postgres database.</p>\n\n<p>I have a table with two integer columns as key: (int1,int2)\nThis table has around 70 million rows.</p>\n\n<p>I need to make two kind of simple SELECT queries in this environment:</p>\n\n<pre><code>SELECT * FROM table WHERE int1=X;\nSELECT * FROM table WHERE int2=X;\n</code></pre>\n\n<p>These two selects returns around 10.000 rows each out of these 70 million. For this to work as fast as possible I thought on using two HASH indexes, one for each column. Unfortunately the results are not that good:</p>\n\n<pre><code>                                                               QUERY PLAN                                                               \n----------------------------------------------------------------------------------------------------------------------------------------\n Bitmap Heap Scan on lec_sim  (cost=232.21..25054.38 rows=6565 width=36) (actual time=14.759..23339.545 rows=7871 loops=1)\n   Recheck Cond: (lec2_id = 11782)\n   -&gt;  Bitmap Index Scan on lec_sim_lec2_hash_ind  (cost=0.00..230.56 rows=6565 width=0) (actual time=13.495..13.495 rows=7871 loops=1)\n         Index Cond: (lec2_id = 11782)\n Total runtime: 23342.534 ms\n(5 rows)\n</code></pre>\n\n<p>This is an EXPLAIN ANALYZE example of one of these queries. It is taking around 23 seconds. My expectations are to get this information in less than a second.</p>\n\n<p>These are some parameters of the postgres db config:</p>\n\n<pre><code>work_mem = 128MB\nshared_buffers = 2GB\nmaintenance_work_mem = 512MB\nfsync = off\nsynchronous_commit = off\neffective_cache_size = 4GB\n</code></pre>\n\n<p>Any help, comment or thought would be really appreciated.</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["python","django","query","mongodb","mongoengine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13204573,"title":"Trouble querying ListField with mongoengine","body":"<p>I'm using mongoengine, and I've got the following situation,</p>\n\n<p>My model:</p>\n\n<pre><code>class Item(Document):\n   ...\n   tags = ListField(StringField(max_length=30))\n</code></pre>\n\n<p>The query:</p>\n\n<pre><code>filters = {\n    'tags__contains': query\n}\ntags_with_counter = Item.objects.filter(**filters).item_frequencies('tags')\n</code></pre>\n\n<p>This returns a list of tuples containing the name of the tag, and the frequency. What I want to do is get only tags that contain <strong>query</strong> and their respective frequency. How can I do that?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13250351,"title":"MySql: Extract products with identical options","body":"<p>I'm trying to write a query that would extract products that have identical option values assigned to them. Affected tables are:</p>\n\n<pre><code>products\n| id |\n\nrel_product_options\n| product | option | value |\n\"option\" is an id from \"options\" table\n\"value\" is an option value id from \"values\" table (an option can have multiple values. eg. option \"color\" can have \"red\", \"blue\" etc.)\n</code></pre>\n\n<p>Every product has multiple option-value combinations ir \"rel_product_options\" table. Variations of the same product cannot have identical option-value pairs and that's why prior to changing any value on any option i need to check if the next value would no conflict with some other product. Let's assume</p>\n\n<ul>\n<li>product A (color: red, size: 10)</li>\n<li>product B (color: blue, size: 10)</li>\n</ul>\n\n<p>Now if i try to change color of \"product B\" to \"red\" - i should be able to find in the database that options of \"product A\" would be identical and cancel the change. I hope the question is clear and honestly i don't even know where to start: sql is something of a mystery to me no matter how many times i use it ... I've started with something like the code below, but i think it is probably wrong on more levels than i can count to so any help is very appreciated.</p>\n\n<pre><code># my thoughts\nSELECT P1.*, PO1.*, PO2.* FROM products AS P1\n# first select the product we want to extract all options from\n# THIS ALREADY IS WRONG, because one of the options is ABOUT TO CHANGE, but this code assumes it has already done that\nJOIN rel_product_options AS PO1 ON (PO1.product = P1.id AND PO1.product = 1)\n# now join all other products that do not have identical option-value pairs\nLEFT JOIN rel_product_options AS PO2 ON (PO1.product != PO2.product AND PO1.`option` = PO2.`option` AND PO1.value = PO2.value)\n# and ... i'm lost ...\n</code></pre>\n"},{"tags":["query","solr"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13249717,"title":"Solr query syntax Issue","body":"<p>I'm trying to do the following query with Solr:</p>\n\n<pre><code>time:90000 OR (-time:[1521 TO *] AND -(time:[* TO 1519] OR time:[1521 TO *]))\n</code></pre>\n\n<p>it returns only one result with tag <code>time=90000</code>, but I have two items with tag <code>time</code> with value <code>90000</code> and <code>1520</code>. I would like them both.</p>\n\n<p>Can anyone give me some explaination? Thanks in advance.</p>\n"},{"tags":["mysql","sql","query","normalization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13242840,"title":"SQL query - Two tables with relation many to one (Normalization issue)","body":"<p>I have this example tables:</p>\n\n<pre><code>table ORDERS\n\nclient   orderno   cant1   code1   notes1   cant2   code2   notes2   cant[i]   code[i] [...]\n--------------------------------------------------------------------------------------\n1          1        3      AA01    Test      4      BB01    Testing\n2          2        10     XX05    Test      \n\n\n\ntable PRODUCTS\n\ncode   prod    price\n---------------------\nAA01   Engine   100  \nBB01   Wheel     50  \n\n\n\ntable CLIENTS\n\nclient   name      address     telephone\n-----------------------------------------\n  1     Maxwell   24 1st st    0987654321\n  2     Hammer    77 main st   1234567890\n</code></pre>\n\n<p>I need to relate them to get the quantity, name of the product and price for each of the product lines (they are 30 cant[i], code[i] and notes[i]) and the customer's information (name, address, etc)</p>\n\n<p>I found this case, but I don't understand how to apply it to mine: <a href=\"http://stackoverflow.com/questions/9420475/sql-query-two-tables-with-relation-one-to-many\">SQL query two tables with relation one-to-many</a></p>\n\n<p>I hope it's not too complex.</p>\n\n<p>Thanks in advance!</p>\n\n<h1>EDIT</h1>\n\n<p>Thanks to ElectricLlama I realized the problem here is the table where the order is storaged. According to his answer, the normalization of the database would improve the way I'm able to get the info.</p>\n\n<p>For anyone interested in this solution, I found this great website: <a href=\"http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/\" rel=\"nofollow\">http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/</a></p>\n\n<p>This SO answer clears it ALL! Super clear and understandable!\n<a href=\"http://stackoverflow.com/a/1258776/888292\">http://stackoverflow.com/a/1258776/888292</a></p>\n"},{"tags":["python","query","autocomplete","combobox","pyqt4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13197267,"title":"QSqlRelationalTableModel and autocomplete field (PyQt4)","body":"<p>I have created a single-field tableview using QSqlRelationalTableModel. The only field in this tableview is taken from a table (mysql) with a long list of names. What is the right way to create an autocomplete when I write a name in the field which is logically connected with a query \"like\".</p>\n\n<pre><code>self.model = QtSql.QSqlRelationalTableModel()\n\nself.model.setTable(\"archlibri\")\nself.model.setHeaderData(0, QtCore.Qt.Horizontal, \"ID\")\nself.model.setHeaderData(1, QtCore.Qt.Horizontal, \"Autore\")\nself.model.setHeaderData(2, QtCore.Qt.Horizontal, \"Titolo\")\nself.model.setRelation(1, QtSql.QSqlRelation(\"elAutori\", \"aID\", \"aNome\"))\nself.model.select()\n\ntabella.setModel(self.model)       \n\ntabella.setItemDelegate(QtSql.QSqlRelationalDelegate(tabella))\n</code></pre>\n\n<p>Tabella is a QTableView. The column \"Autore\" (column have relation delegate) is where i want add a autocomplete when i write a name</p>\n"},{"tags":["sql","sql-server","xml","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13249503,"title":"SQL XML query from column","body":"<p>How to select file names from this kind of XML in a SQL Server column?</p>\n\n<ol>\n<li><p>file name is in attribute <code>VALUE</code> only if high level tag is object with name <code>File</code>\nlike this</p>\n\n<pre><code>&lt;Object NAME=\"File\"&gt;\n    &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n&lt;/Object&gt;\n</code></pre></li>\n<li><p>This sub-hierarchy can be placed on any level of xml (see example below)</p></li>\n<li><p>XML column can contain 0-N file names, I need list like this:</p>\n\n<pre><code>id, filename\n--- ------------------------\n 1  \\\\mysvr\\fiels\\readme1.txt\n 1  \\\\mysvr\\fiels\\readme2.txt\n 2  \\\\mysvr\\fiels\\readme3.txt\n 2  \\\\mysvr\\fiels\\readme4.txt\n</code></pre></li>\n</ol>\n\n<p>Example of XML contents:</p>\n\n<pre><code>declare @t1 table\n(   id int,\n   x XML\n)\n\ninsert into @t1 (id, x)\nselect 1,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n   &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n&lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"10\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme2.txt\" /&gt;\n&lt;/Object&gt;\n&lt;Object NAME=\"bitmap\"&gt;\n              &lt;Parameter ID=\"11\" NAME=\"my1\" VALUE=\"bmp\" /&gt;\n&lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\nunion \nselect 2,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"13\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme3.txt\" /&gt;\n  &lt;/Object&gt;\n  &lt;Object NAME=\"Font\"&gt;\n              &lt;Parameter ID=\"22\" NAME=\"Tahoma\" VALUE=\"11\" /&gt;\n  &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"14\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme4.txt\" /&gt;\n  &lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\n</code></pre>\n"},{"tags":["c#","linq","query","tolist"],"answer_count":4,"favorite_count":2,"up_vote_count":13,"down_vote_count":0,"view_count":206,"score":13,"question_id":13250561,"title":"Does foreach execute the query only once?","body":"<p>I have a list of items and a LINQ query over them. Now, with LINQ's deferred execution, would a subsequent foreach loop execute the query only once or for each turn in the loop?</p>\n\n<p>Given this example (Taken from <a href=\"http://msdn.microsoft.com/en-us/library/bb397906.aspx\">Introduction to LINQ Queries (C#), on MSDN</a>)</p>\n\n<pre><code>    // The Three Parts of a LINQ Query: \n    //  1. Data source. \n    int[] numbers = new int[7] { 0, 1, 2, 3, 4, 5, 6 };\n\n    // 2. Query creation. \n    // numQuery is an IEnumerable&lt;int&gt; \n    var numQuery =\n        from num in numbers\n        where (num % 2) == 0\n        select num;\n\n    // 3. Query execution. \n    foreach (int num in numQuery)\n    {\n        Console.Write(\"{0,1} \", num);\n    }\n</code></pre>\n\n<p>Or, in other words, <strong>would there be any difference if I had</strong>:</p>\n\n<pre><code>    foreach (int num in numQuery.ToList())\n</code></pre>\n\n<p>And, would it matter, if the underlying data is not in an array, but in a Database?</p>\n"},{"tags":["mysql","sql","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":13247632,"title":"postgresql query to mysql","body":"<p>I want create query in MySQL similiar to PostgreSQL below:</p>\n\n<pre><code>CREATE FUNCTION check_unique_pair(IN id1 INTEGER, IN id2 INTEGER) RETURNS INTEGER AS   $body$\nDECLARE retval INTEGER DEFAULT 0;\nBEGIN \n SELECT COUNT(*) INTO retval FROM (\n  SELECT * FROM edges WHERE a = id1 AND b = id2\n  UNION ALL\n  SELECT * FROM edges WHERE a = id2 AND b = id1\n)  AS pairs;\nRETURN retval;\nEND\n$body$\nLANGUAGE 'plpgsql';\n\nALTER TABLE edges ADD CONSTRAINT unique_pair CHECK (check_unique_pair(a, b) &lt; 1);\n</code></pre>\n\n<p>I am new to MySQL.</p>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13249903,"title":"mysql select multiple rows by referencing to one data field","body":"<pre><code>===========================\n= id = model_id = property =\n===========================\n= 14 = 1        = 1       =\n===========================\n= 15 = 1        = 3       =\n===========================\n= 16 = 2        = 1       =\n</code></pre>\n\n<p>I have a table like above and I want to select model_ids only where property equals to 1 AND 3</p>\n\n<p>I'd be glad if you could show me how</p>\n\n<p>thanks in advance </p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13249281,"title":"Getting extra data in MYSQL count query","body":"<p>Hi all i've had help from bluefleet (BF) with a mysql query which i've now put in a php file, the query works fine but i find i need to get extra data as well as the count, so what i need is when a match is found i need to look up the username in table tview3.</p>\n\n<p>Whichever table the ip match is found there will be a column called UID, in the table tview3 there will also be a column called USERNAME, what i'd like to do is get the username(s) for the matches and then use them in a text file.</p>\n\n<p>I have to state i'm a complete newbie at this, all help is appreciated</p>\n\n<pre><code>$myquery= \"select sum(total)\nfrom\n(\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview v\n    where v.ipaddress = '$ips'\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview2 v1\n    where v1.ipaddress = '$ips'\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview3 v3\n    where v3.ipaddress = '$ips'\n) src\";\n\n $result = mysql_query($myquery);\n    $rowCount = mysql_num_rows($result);\n    If($rowCount !=0){\n       echo \"NOT EMPTY\";\n    }else{\n      echo \"EMPTY\";\n    }\n   mysql_free_result($result);\n\n$UAM = strtoupper($_SERVER['HTTP_USER_AGENT']);\n$ips = strtoupper($_SERVER['REMOTE_ADDR']);\n$fp = fopen(\"logtext.txt\", \"a\");\n$DateOfRequest = date('m-d-Y H:i:s');\n\nfwrite($fp, \"$DateOfRequest . \\nMatched Member: . $username . \\nWith User Agent:  . $UAM . \\n\\nIP: . $ips . \\n\\n\");\n</code></pre>\n\n<p>So i'd like to populate a variable <strong>$username</strong> with the username(s) where the matches were found.</p>\n\n<p>Regards,\nSilo</p>\n"},{"tags":["sql","query","group","wise","sub-query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13245223,"title":"SQL Inner/Sub group wise Query for a specific scenario","body":"<p>I have a table as below</p>\n\n<blockquote>\n  <p>Schema: ID | Category | Keyword | Bid Price</p>\n</blockquote>\n\n<p>Write a sql to fetch out top 5 keywords based on the bid price per category.</p>\n\n<p>Details:</p>\n\n<p>Table definition considered on oracle 10.x:</p>\n\n<pre><code>create table test (\n    ID number,\n    Category varchar (20),\n    Keyword varchar (20),\n    BidPrice number\n);\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>insert into test values (1, 'Category-A', 'Keyword-A1', 110);\ninsert into test values (2, 'Category-A', 'Keyword-A2', 121);\ninsert into test values (3, 'Category-A', 'Keyword-A3', 130);\ninsert into test values (4, 'Category-A', 'Keyword-A4', 125);\ninsert into test values (5, 'Category-A', 'Keyword-A5', 115);\ninsert into test values (6, 'Category-A', 'Keyword-A6', 133);\ninsert into test values (7, 'Category-B', 'Keyword-B1', 105);\ninsert into test values (8, 'Category-B', 'Keyword-B2', 111);\ninsert into test values (9, 'Category-B', 'Keyword-B3', 108);\ninsert into test values (10, 'Category-B', 'Keyword-B4', 128);\ninsert into test values (11, 'Category-B', 'Keyword-B5', 144);\ninsert into test values (12, 'Category-B', 'Keyword-B6', 101);\ninsert into test values (13, 'Category-C', 'Keyword-C1', 150);\ninsert into test values (14, 'Category-C', 'Keyword-C2', 137);\ninsert into test values (15, 'Category-C', 'Keyword-C3', 126);\ninsert into test values (16, 'Category-C', 'Keyword-C4', 121);\ninsert into test values (17, 'Category-C', 'Keyword-C5', 112);\ninsert into test values (18, 'Category-C', 'Keyword-C6', 118);\n</code></pre>\n\n<p><strong>Output expected:</strong></p>\n\n<pre><code>KEYWORD        CATEGORY        BIDPRICE\n-------------- --------------- ----------\n</code></pre>\n\n<blockquote>\n  <p><br>Keyword-A6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;133\n  <br>Keyword-A3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;130\n  <br>Keyword-A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;125\n  <br>Keyword-A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-A5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;115\n  <br>Keyword-B5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;144\n  <br>Keyword-B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;128\n  <br>Keyword-B2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;111\n  <br>Keyword-B3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;108\n  <br>Keyword-B1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;105\n  <br>Keyword-C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;150\n  <br>Keyword-C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;137\n  <br>Keyword-C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;126\n  <br>Keyword-C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-C6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;118\n  <br></p>\n</blockquote>\n\n<p><em>Note:  Answer has to be only in SQL without use of any Oracle or database specific function.</em></p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13248976,"title":"How to insert, update, delete when import data from table to table?","body":"<p>I have a query that I need to run more than once a day. This query is importing data from a database to another. </p>\n\n<p>The target table structure is:  </p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2\n</code></pre>\n\n<p>An application can also insert data to the target table. The records that are inserted by the application may not be updated also when this record exists in the source(temp table) table with another state.</p>\n\n<p>To make this possible I have an solution created. I will create an new column in the target table with a second state so that I can check.</p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State   StateSource\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2       2\n</code></pre>\n\n<p>Some Requirements:</p>\n\n<p>If a record is added by the application than StateSource will be NULL. Means that this record may not be deleted, updated or inserted again from the source table.</p>\n\n<p>If a Record is updated by the application than the value State and StateSource will be different. In this case I do not update this record.</p>\n\n<p>I will update if the state from the sourcetable and targettable are not same and the values from target table State = StateSource.</p>\n\n<p>I will INSERT a record when this is not exists in the target table. When records already exists do not insert (no matter if this is added by the application or my query on the first run).</p>\n\n<p>I will delete the records from the target when they are no more exists in my sourcetable and State=StateSource.</p>\n\n<p>I already have the following queries. I have decided to make 3 statements.</p>\n\n<pre><code>--Delete Statement first\nDelete from t\nfrom TargetTable t LEFT JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\nand t.State=t.StateSource\n\n--Just delete if a date is no more exists from the source table and this records is NOT\n--changed by the application (t.State=t.StateSource)\n\n\n--Update statement second\nUpdate t\nset t.State = s.State\nFrom Targettable t INNER JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\n\nThe problem here is:\n--when I have State 2 already in the targettable and in my sourcetable i have\n--another state then the state in the targettable changes. This would not be the case.\n\n\n--Insert Statement thirth\n\ninsert into TargetTable (Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource)\nselect Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource\nfrom SourceTable s \nWHERE Date not in (select Date \n                   from TargetTable t \n                   where t.id=s.id \n                   and t.PersonId=s.PersonId\n                   and t.date=s.date\n                   and t.department=s.department)     \n\n--I have no idea about how the insert should be because the application also can\n--insert records. When a record exists then no insert. What to do with the State?\n</code></pre>\n\n<p>Remember that the states that are changed by the application are leading.</p>\n\n<p>Can anyone help me with the desired result? </p>\n"},{"tags":["sql","database","query","postgresql","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13249348,"title":"Extrude 2d polygon into 3d polygon","body":"<p>I am using postgresql and I have a table containing 2d polygons. Now my question is how can I extrude this polygon into a nice 3d building.? </p>\n\n<p>Can anyone help please? because I couldn't find a good tutorial on it.</p>\n\n<p>Many thanks</p>\n"},{"tags":["css","query","media"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":19,"score":0,"question_id":13248378,"title":"How to revert back to Desktop website from Mobile Website when using CSS Media Queries?","body":"<p>I'm using CSS media queries to create a responsive theme. I want to add a link at the footer of the website labeled \"GO TO DESKTOP WEBSITE\". This link will specifically be displayed on the mobile devices. How can I do it so that when a visitor click on the desktop website link, the website is loaded with desktop media query, not of mobile. I hope I've made myself pretty clear on my issue. I've searched on Google for the solution but can not find anything related.</p>\n"},{"tags":["mysql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13247243,"title":"Regarding query for db2","body":"<p>I have the query, I have the below relationships among the following tables </p>\n\n<pre><code>select * from PRODGP_STRUCTURE\nselect * from PRODGP_STR_LINK\nselect * from PRODUCT_GROUP\nselect * from PROD_PGRP_LINK\nselect * from PRODUCT\n</code></pre>\n\n<p>the relationship is ...</p>\n\n<pre><code>select pstr.PSTR_NAME, PG.PRGP_NAME, PRD.PROD_NAME\nfrom prodgp_structure pstr\nJOIN PRODGP_STR_LINK pgstrlnk\n  ON pgstrlnk.PSTR_ID = pstr.PSTR_ID  \nJOIN PRODUCT_GROUP pg \n  ON pgstrlnk.PRGP_CHILD_ID = PG.PRGP_ID\nJOIN PROD_PGRP_LINK prdprdgp\n  ON prdprdgp.PRGP_ID = pg.PRGP_ID\nJOIN product prd\n  ON prdprdgp.PROD_ID = prd.PROD_ID;\n</code></pre>\n\n<p>I have come up to the following query, </p>\n\n<pre><code>select * from PRODGP_STRUCTURE where pstr_id in \n(select pstr_id from PRODGP_STR_LINK where PRGP_CHILD_ID  in\n(select  prgp_id from PRODUCT_GROUP where PRGP_ID in ( select  PRGP_ID from PROD_PGRP_LINK where PROD_ID in ( select PROD_ID from product where PROD_ID=2))))\n</code></pre>\n\n<p>Please let e know is there any other way to write this query..!!</p>\n"},{"tags":["java","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13247844,"title":"Delete state for sql query","body":"<p>I've met up with some problems regarding to sql statement. I screenshot a photo of tables for you guys to see.</p>\n\n<p><img src=\"http://i.stack.imgur.com/pXzYD.png\" alt=\"Picture delete\"></p>\n\n<p>Okay, so what I'm trying to do here is that i retrieve a parameter from the user, which is '14' in this case. So the query has to link the other foreign keys and delete them off. For this, 'User' table is the \"Parent\" of the other 2 tables which is 'camera' and 'mob_dev'. However, camera can't be deleted as there is another foreign key connected to the table 'camera' which is 'device'. So is there any idea on how I can delete the 4 tables by only inputting a single parameter at 'User' table 'userid'. I tried it by doing this in the controller:</p>\n\n<pre><code>String querycam = \"DELETE FROM ip_camera where user_id =\"  +params.userinput\nString querydevice = \"DELETE FROM mobile_device where user_id =\"  +params.userinput\nString queryvalue = \"DELETE FROM sec_user where id =\"  +params.userinput\n</code></pre>\n\n<p>Or is there a better way for doing this? Thanks in advance to anyone who can solve this :).</p>\n"},{"tags":["sql","query","postgresql","otrs"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13237579,"title":"querying otrs database","body":"<p>I have a problem with creating a query on a postgresql database from OTRS.  I need to get an asset list with some data that is stored in the CMDB, but I am having trouble with the way that the data is stored.</p>\n\n<p>This query works ok as far as it goes but as soon as I add another left join to get some more data it just runs for ever without returning any results.</p>\n\n<p>As far as I can see, the problem is that all the information is contained in the xml_storage table without any relationships so I need to repeatedly query that table to get the data.  There is also a mix of data types where an integer is stored as a varyable character in some cases and this prevents me from using that value to get additional information from the general catalog.</p>\n\n<p>I have been banging my head against a brick wall for days on this so i would really appreciate any help</p>\n\n<pre><code>SELECT \n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      array_agg(service),\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    FROM \n      public.configitem_version,\n      public.general_catalog,\n      public.configitem \n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS asset_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Asset Number''}[1]{''Content''}')   as select_asset on last_version_id::int = select_asset.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS manufacturer_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Manufacturer''}[1]{''Content''}' ) as select_manufacturer on last_version_id::int = select_manufacturer.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS model_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Model''}[1]{''Content''}' ) as select_model on last_version_id::int = select_model.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS serial_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''SerialNumber''}[1]{''Content''}' ) as select_serial on last_version_id::int = select_serial.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS fqdn_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''FQDN''}[1]{''Content''}' ) as select_fqdn on last_version_id::int = select_fqdn.xml_key::int\n\n    left join\n      (SELECT \n      link_relation.source_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.target_key::int = service.id AND\n      link_relation.target_object_id::int = 2 AND link_relation.source_object_id::int = 3\n      UNION\n      SELECT \n      link_relation.target_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.source_key::int = service.id AND\n      link_relation.target_object_id::int = 3 AND link_relation.source_object_id::int = 2) as select_service on configitem.id = configitem_id::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS purchasedate_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''PurchaseDate''}[1]{''Content''}' ) as select_purchasedate on last_version_id::int = select_purchasedate.xml_key::int\n\n    left join\n      (SELECT\n      general_catalog.name AS status_value,\n      general_catalog.id\n      FROM\n      public.general_catalog) as select_status on configitem.cur_depl_state_id::int = select_status.id::int\n\n    WHERE\n      configitem.last_version_id = configitem_version.id AND\n      configitem.class_id = general_catalog.id AND\n      (configitem.class_id = 32 OR configitem.class_id = 33)\n\n\n    GROUP BY\n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    ;\n</code></pre>\n"},{"tags":["sql","sql-server","query","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13244832,"title":"SQL Server 2000 Query of total value and value from max date","body":"<p>I have this RoomTable with value</p>\n\n<pre><code>SID   Room   Date        APhase   BPhase   ACount  BCount\n1     One    10/28/2012  4        5         3       6\n2     One    10/29/2012  2        3        -1      -1\n3     One    10/30/2012  4        5         7      -1\n4     Two    10/28/2012  8        3         2       3\n5     Two    10/30/2012  3        5         4       6\n6     Three  10/29/2012  5        8         2      -1\n7     Three  10/30/2012  5        6        -1       4\n8     Four   10/29/2012  6        2        -1      -1\n9     Four   10/30/2012  5        8        -1      -1\n</code></pre>\n\n<p>What I want is to return the following:</p>\n\n<ol>\n<li>Total sum of APhase and BPhase of each Room.</li>\n<li>Value of ACount and BCount from max date of each Room</li>\n<li>If ACount value is -1 then use the previous date. Same as BCount.</li>\n<li>If ACount value is -1 and the previous date is -1 and so on. Then use 0. Same as BCount.</li>\n</ol>\n\n<p>I can get the query of number 1 with this query</p>\n\n<pre><code>SELECT Room, sum(APhase) as TotalAPhase, sum(BPhase) as TotalBPhase \nFROM RoomTable \nWHERE Date between '10/28/2012' and '10/30/2012'\ngroup by Room\norder by Room\n</code></pre>\n\n<p>But I'm confused on how to include the number 2-4 query.</p>\n\n<p>This is the output I want</p>\n\n<pre><code>Room  TotalAPhase  TotalBPhase  ACount   BCount\nOne   10           13           7        6\nTwo   11           8            4        6\nThree 10           13           2        4\nFour  11           10           0        0\n</code></pre>\n\n<p>Any ideas will be much appreciated. Thanks. </p>\n"},{"tags":["sql","query","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13245424,"title":"Join in Db2 query","body":"<p>I have joined two tables using inner join. Here primary key of table <code>TPREG</code> is <code>co_id</code> and <code>pol_id</code></p>\n\n<pre><code> SELECT (SELECT etbl_desc_txt\n       FROM uding604.tedit e\n       WHERE etbl_typ_id = 'PITCD'\n       AND   co_id = 'CP'\n       AND   etbl_valu_id = p.pol_ind_typ_cd) pol_ind_typ_cd,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYT'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_TYP_CD) POL_BILL_TYP_CD,\n       POL_PAC_DRW_DY,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYM'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_MODE_CD) POL_BILL_MODE_CD,\n       t.SOURCE_CD\nFROM uding604.tpol p,\n     uding604.TPREG t\nWHERE p.co_id = t.co_id\nAND   p.pol_id = t.pol_id\nAND   p.co_id = 'CP'\nAND   p.pol_id = '000000011'\nAND   t.co_id = 'CP'\nAND   t.pol_id = '000000011'\n</code></pre>\n\n<p>How to make this query more simple?</p>\n\n<p>Please guide.</p>\n"},{"tags":["mysql","query","stored-procedures","prepared-statement"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13245390,"title":"Removing Parameters from where clause to display records","body":"<p>I have a real estate website where people can search property based on Location, Property Type and Builder.</p>\n\n<p>I have a Table like below.</p>\n\n<pre>\n\nCREATE TABLE Project(ProjectId INT NOT NULL PRIMARY KEY AUTO_INCREMENT, \n                     Location  VARCHAR(255), \n                     PropertyType VARCHAR(255), \n                     Builder VARCHAR(255), \n                     ProjectName  VARCHAR(255),\n                     Status TINYINT)\n\n\nINSERT INTO Project(Location, PropertyType, Builder, ProjectName)\n             VALUES('Location A', 'Flats',     'Builder A', 'Project A', 1),\n                   ('Location A', 'Villas',    'Builder B', 'Project B', 1),\n                   ('Location B', 'Flats',     'Builder A', 'Project C', 1),\n                   ('Location C', 'Villas',    'Builder C', 'Project D', 1),\n                   ('Location B', 'Plots',     'Builder B', 'Project E', 1),\n                   ('Location A', 'Row House', 'Builder C', 'Project F', 1),\n                   ('Location A', 'Plots',     'Builder A', 'Project G', 1),\n                   ('Location C', 'Plots',     'Builder C', 'Project H', 1),\n                   ('Location C', 'Flats',     'Builder B', 'Project I', 1),\n                   ('Location C', 'Villas',    'Builder B', 'Project J', 1),\n                   ('Location A', 'Villas',    'Builder A', 'Project K', 1),\n                   ('Location C', 'Flats',     'Builder B', 'Project L', 1);\n\n</pre>\n\n<p>The search procedure which I use is in such a way that It brings back search result as per the parameters they selected i.e Property Type, Location, Builder Name</p>\n\n<p>Now there may be projects for some search parameters as below</p>\n\n<p>Flats by Builder A at Location C </p>\n\n<p>I want to change procedure in such a way the parameters in filters in where clause should change to bring result all the time by considering other possibilities like for the above </p>\n\n<p>Flats by Builder A at Location C </p>\n\n<p>There is no Flats by Builder A at Location C so it should display Flats at Location C by Other Builders</p>\n\n<pre>\n\n      Location C   Flats     Builder B    Project I\n\n</pre>\n\n<p>The Filter should Consider  PropertyType, Location and Builder Name</p>\n\n<p>Villas at Location B </p>\n\n<p>There is No Villas at Location B So </p>\n\n<pre>\n\nLocation A    Villas   Builder B   Project B\nLocation C    Villas   Builder B   Project J\nLocation A    Villas   Builder A   Project K\n\n</pre>\n\n<p>The search should happen by </p>\n\n<pre>\n\n       PropertyType -> Location -> Builder\n\n</pre>\n\n<p>If there is No project for a particular Builder in that Location then </p>\n\n<pre>\n\n       PropertyType -> Location\n\n</pre>\n\n<p>If there is No project for a particular Location then </p>\n\n<pre>\n\n       PropertyType\n\n</pre>\n\n<p>The parameters in the filters should be eliminated in such a way it brings similar result to search param.</p>\n\n<pre>\n\n       PropertyType -> Location -> Builder       No Records\n       PropertyType -> Location                  No Records\n       PropertyType                              Records Found\n\n</pre>\n\n<p>The procedure I created is as Below</p>\n\n<pre>\n\n    DROP PROCEDURE  IF EXISTS getProjectResult;\n    CREATE PROCEDURE getProjectResult(IN PropertyType VARCHAR(255), IN Location VARCHAR(255), IN BuilderName VARCHAR(255))\n    BEGIN\n      SET @strSQL = 'SELECT * \n                       FROM project\n                      WHERE status = 1 ';\n\n      IF PropertyType != '' THEN\n        SET @strSQL = CONCAT(@strSQL, ' AND PropertyType =\"', PropertyType, '\" ');\n      END IF;\n\n      IF Location != '' THEN    \n        SET @strSQL = CONCAT(@strSQL, ' AND Location =\"', Location, '\" ');\n      END IF;\n\n      IF BuilderName != '' THEN\n        SET @strSQL = CONCAT(@strSQL, ' AND Builder =\"', BuilderName, '\" ');\n      END IF;\n\n      PREPARE stmt FROM @strSQL;\n      EXECUTE stmt;  \n      DEALLOCATE PREPARE stmt; \n    END;\n\n</pre>\n\n<p>So My Procedure is Going to bring output as below</p>\n\n<pre>\n\n     CALL getProjectResult('Flats', 'Location C', 'Builder A');\n\n</pre>\n\n<p>No Output</p>\n\n<p>So it should display </p>\n\n<pre>\n\n       Location C    Flats     Builder B   Project L  \n\n</pre>\n\n<p>How to Change Procedure in such a way it remove parameters from filters so it brings result.\nThe parameters should be removed in following order builder, location and property type.</p>\n\n<p>Property type should be given highest preference followed Location and builder name</p>\n\n<p>Thanks for Reply</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13245476,"title":"Error (1093):You cant update target table for update in FROM Clause","body":"<p><strong>This is the select statement  which i have got the correct answer:</strong></p>\n\n<pre><code>select s_billing_cycle.Billing_cycle from s_billing_cycle \njoin o_daily_lcsgeneration_copy on o_daily_lcsgeneration_copy.Location=s_billing_cycle.Location where o_daily_lcsgeneration_copy.Date between s_billing_cycle.From_Date and s_billing_cycle.To_Date\n</code></pre>\n\n<p><strong>while updating the same query into another table i couldnt do that using update query getting :\nYou cant update target table \"o_daily_lcsgeneration_copy\" for update in FROM Clause \nthe query i have used is :</strong></p>\n\n<pre><code>update o_daily_lcsgeneration_copy  set o_daily_lcsgeneration_copy.Billing_cycle = (select s_billing_cycle.Billing_cycle from s_billing_cycle join o_daily_lcsgeneration_copy on o_daily_lcsgeneration_copy.Location=s_billing_cycle.Location where o_daily_lcsgeneration_copy.Date between s_billing_cycle.From_Date and s_billing_cycle.To_Date) \n</code></pre>\n\n<p>Help  me !!!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13243626,"title":"Efficient Query, Table Bridge/Indexing and strucuture","body":"<p>In my PhpMyAdmin database I have 9 tables. 8 of those tables are relevant to me at this moment. I would like my queries to be executed quickly enough but I am not sure the design/structure of the tables are the most effecient. Any suggestion of merging a table with another or creating another bridge table?  Also, I am struggling in building a query that will display bridge results from the following tables: <code>semester</code>, <code>schedule</code>, <code>office_hours</code>, <code>faculty</code>, <code>section</code>, <code>major_minor</code>, <code>major_class_br</code>, <code>class</code>?</p>\n\n<p><a href=\"http://webprolearner2346.zxq.net/class_des/\" rel=\"nofollow\">TABLE STRUCTURE</a></p>\n\n<p>Basic Query- that shows class details</p>\n\n<pre><code>SELECT  class_name, class_caption, class_credit_hours, class_description\nFROM class  \n</code></pre>\n"},{"tags":["sql","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4065,"score":1,"question_id":4714239,"title":"How to delete last record(on condition) from a table in MySql","body":"<p>I have a <strong>LoginTime</strong> table like this:</p>\n\n<pre><code>id | user_id | datetime\n1  |   1     | 2011-01-17 18:51:05\n2  |   1     | 2011-01-18 18:51:05  \n3  |   1     | 2011-01-19 18:51:05  \n4  |   2     | 2011-01-19 18:51:05  \n</code></pre>\n\n<p>I want to delete last record for <code>user_id=1</code>. Last record of a user can be recognized by <code>datetime</code>.</p>\n\n<p>How can I do this with one query. </p>\n"},{"tags":["sql","sql-server","database","query","sql-server-2008-r2"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":11666009,"title":"SQL server query to get this output","body":"<p>I have a query which i am unable to get the output.\nBelow is the query to be executed</p>\n\n<p>Q: 2.   Write a query to find the city Name, Id and Count that has got maximum number of vehicles associated.</p>\n\n<p>Now, Given is the one table on which the query should be executed.</p>\n\n<pre><code>Vehicle_Detail_ID   City_ID\n56                    242\n57                    242\n58                    242\n59                    243\n60                    241\n61                    242\n62                    245\n</code></pre>\n\n<p>Another table which has the city name</p>\n\n<pre><code>City_ID City_Name\n242          Bangalore\n243          ChamarajNager\n241          Bellary\n245          Chitradurga\n</code></pre>\n\n<p>EXPECTED OUTPUT: </p>\n\n<pre><code>City_ID No_Vehicles\n242          4\n</code></pre>\n\n<p>Please tell me how to write the query which fetches me the right output.</p>\n\n<p>Given below is the query which gives the city Id and its vehicle count.\nTRIED: </p>\n\n<pre><code>SELECT c.city_id, COUNT(c.City_ID) AS NO_vehicles\n  FROM city c, vehicle_details v \n WHERE c.City_ID = v.City_ID\n GROUP BY c.City_ID\n</code></pre>\n\n<p>ACTUAL OUTPUT </p>\n\n<pre><code>City_ID No_Vehicles\n242             4\n243             1\n241             1\n245             1\n</code></pre>\n\n<p>Please help me to get max of these as shown in EXPECTED OUTPUT.</p>\n"},{"tags":["python","django","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13243575,"title":"Curious about how django achieves the ORM query optimization","body":"<p>I am no python expert and I am curious about how django optimize the following query</p>\n\n<pre><code>Model.objects.filter(field = 'abc')[0]\n</code></pre>\n\n<p>Somehow django will intelligently add '<code>limit 1</code>' to SQL query like '<code>select * from model where field = 'abc' limit 1</code>'</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13242632,"title":"SQL Query with INI data?","body":"<p>I have a simple data table with the a column structure including: name, email, paid, and params</p>\n\n<p>The 'params' column contains custom fields filled in by a form from the user.  I have provided a sample submission value AT THE BOTTOM OF THIS QUESTION.  I i would like to display:</p>\n\n<p>custom_field_value_1_person_1</p>\n\n<p>custom_field_value_2_person_1</p>\n\n<p>custom_field_value_3_person_1</p>\n\n<p>custom_field_value_4_person_1</p>\n\n<p>Is there any way to retrieve these from such data?</p>\n\n<p>Right now my simple query reads: </p>\n\n<pre><code>SELECT\n  R.ohanah_registration_id,\n  E.title AS Event,\n  R.name,\n  R.email,\n  R.paid\nFROM\n waqcl_ohanah_registrations R LEFT JOIN waqcl_ohanah_events E\n  ON R.ohanah_event_id = E.ohanah_event_id\n</code></pre>\n\n<p>SAMPLE SUBMISSION VALUE:\nfield_name_person_1=field_name_person_2=field_name_person_3=field_name_person_4=field_name_person_5=custom_field_value_1_person_1=\\CrossFit Gold\\\"custom_field_value_1_person_2=\\\"\\\"custom_field_value_1_person_3=\\\"\\\"custom_field_value_1_person_4=\\\"\\\"custom_field_value_1_person_5=\\\"\\\"custom_field_value_2_person_1=\\\"XL\\\"custom_field_value_2_person_2=\\\"\\\"custom_field_value_2_person_3=\\\"\\\"custom_field_value_2_person_4=\\\"\\\"custom_field_value_2_person_5=\\\"\\\"custom_field_value_3_person_1=\\\"m\\\"custom_field_value_3_person_2=\\\"\\\"custom_field_value_3_person_3=\\\"\\\"custom_field_value_3_person_4=\\\"\\\"custom_field_value_3_person_5=\\\"\\\"custom_field_value_4_person_1=\\\"916-952-..  </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13242569,"title":"Query to retrieve records containing Unix dates","body":"<p>One column in a table in my MySQL database stores date in Unix format.</p>\n\n<p>I am trying to retrieve all rows where the date is later than a specific date. How do I write a query to do this? I want something like:</p>\n\n<pre><code>SELECT * FROM table_name WHERE date &gt; \"yyyy-mm-dd\";\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","sql","query","group-by","case"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13228875,"title":"Using CASE WHEN with GROUP BY","body":"<p>Background: I'm trying to display a table with the headings: id, full_name, position_7, position_8, position_9...etc if a person was an active employee for Jul and Aug, then 2012_Jul and 2012_Aug will be displayed in position_7 and 8 on one line. If I don't use GROUP BY I get the output but on 2 lines. The reason this is happening is because in the BLMths table a single person will have multiple entries due to being employed for more than 1 month. </p>\n\n<p>The below query will get every persons id, full_name and month successfully...if I don't use GROUP BY. But the problem is, if I neglect to use GROUP BY I will have 4 lines (or more) for each person in my table.   When I do use GROUP BY, I have the desired output of 1 line for each person, but the data I need in the table isn't all there.</p>\n\n<p>Does anyone know what I'm doing wrong?  Or does anyone know why when I use GROUP BY the data from some of my CASE statements appear to be missing?</p>\n\n<p>I know the answer to this has to be simple, but I can't seem to solve it.  Any help is appreciated.   Many thanks in advance.</p>\n\n<pre><code>SELECT Blm.Ags, Blmths.Id, Ie.Full_Name, Blmths.Month,\n       CASE month\n       WHEN \"2012-07-01\" THEN 1\n           ELSE NULL\n       END AS Position_7,\n       CASE month\n       WHEN \"2012-08-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_8,\n       CASE Blmths.Month\n       WHEN \"2012-09-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_9,\n       CASE month\n       WHEN \"2012-10-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_10,\n       CASE Blmths.Month\n       WHEN \"2012-11-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_11,\n       CASE Blmths.Month\n       WHEN \"2012-12-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_12,\n       CASE month\n       WHEN '2013-01-01' THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_1,\n       CASE month\n       WHEN \"2013-02-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_2,\n       CASE month\n       WHEN \"2012-03-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_3,\n       CASE Blmths.Month\n       WHEN \"2013-04-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_4,\n       CASE Blmths.Month\n       WHEN \"2013-05-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_5,\n       CASE Blmths.Month\n       WHEN \"2013-06-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_6\n  FROM Bogus_Leadership_Months AS Blmths, Injection_Employees AS Ie,\nBogus_Leadership_Members AS Blm\n  WHERE Blmths.Id = Blm.Id\n    AND Ie.Ags = Blm.Ags\n    AND Ie.Centre_Id = '666'\n  GROUP BY Blm.Ags\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13242268,"title":"MYSQL Query: combine columns and get count","body":"<p>I have about 9 tables that contain the same type of field. I would like to combine the 9 of them FIRST, and then get the distinct count of unique values in that combined column. This is what I've tried so far, but to no avail. I'm not also not sure this is the most efficient way to return this value?</p>\n\n<pre><code>SELECT COUNT(DISTINCT aircraft_id) FROM \n(\nSELECT aircraft_id FROM database.a_message UNION ALL\nSELECT aircraft_id FROM database.b_message UNION ALL\nSELECT aircraft_id FROM database.c_message UNION ALL\nSELECT aircraft_id FROM database.d_message UNION ALL\nSELECT aircraft_id FROM database.e_message UNION ALL\nSELECT aircraft_id FROM database.f_message UNION ALL\nSELECT aircraft_id FROM database.g_message UNION ALL\nSELECT aircraft_id FROM database.h_message UNION ALL\nSELECT aircraft_id FROM database.i_message\n) ;\n</code></pre>\n"},{"tags":["query","date","datetime","sdk","rally"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13185167,"title":"Rally: how to pull latest testresult from a specific testset","body":"<p>I am trying to use the following code to get a pie chart for the latest testresult from a particular testset.</p>\n\n<pre><code>pieconfig = {\ntype: 'TestCaseResult',\nattribute: 'Verdict',\nquery: rally.sdk.util.Query.and(['TestSet = \"' + testsetDropdown.getValue() + '\"','Date &lt; \"2012-11-01\"'])\n            };\nvar pieChart = new rally.sdk.ui.PieChart(pieconfig,rallyDataSource);\npieChart.display(\"pieChartDiv\");\n</code></pre>\n\n<p>In this code I've put today's date manually, but I want to make this query as of a  generic type which should pull the latest testresult from a specific testset. Any hints...? Thank you.</p>\n"},{"tags":["php","mysql","database","query","many-to-many"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":10884677,"title":"A library database","body":"<p>So me and my colleague have been assigned for making a library database as the lesson's assignement and then make an html database interface where someone would be able to perform certain tasks within the database such as inserting rows, deleting rows, finding rows etc.</p>\n\n<p>We have created the database, imported it and all that but the problem is in inserting elements into it.</p>\n\n<p>Well for example the books table has a many-to-many relationship with the authors table (where primary keys of each table are the ISBN and the authors ID respectively) so when we want to insert a book with it's authors in our DB we don't know exactly how to do it because they are in different tables. We are confused as to how we would put data from a single form in multiple tables with different primary keys.</p>\n\n<p>We have been trying to find examples like that but to no avail.</p>\n\n<p><img src=\"http://i.stack.imgur.com/FCVs4.png\" alt=\"\"></p>\n\n<p>Even links to tutorials and whatnot are mostly welcome.</p>\n\n<p>Server side code is PHP.</p>\n\n<p>Thank you very much.</p>\n"},{"tags":["sql","query","caching","ruby-on-rails-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13239510,"title":"Caching database data","body":"<p>I am trying to cache some data from the database to reduce number of SQL queries to the database. Currently, what I am doing is that I will load a set of records from the database:</p>\n\n<pre><code>@records = Record.find(:all, :conditions =&gt; [\"id &lt; ?\", 100])\n</code></pre>\n\n<p>and then iterate through this array to find the records that I really want:</p>\n\n<pre><code>@needed_records = Array.new\n@records.each do |record|\n  if record.is_needed\n    @needed_records.push(record)\n  end\nend\n</code></pre>\n\n<p>So that whenever I need, i can just pass @records instead of actually accessing the database.</p>\n\n<p>My question is, is there any shortcoming doing it this way? Is there any better way to do the equivalent?</p>\n"},{"tags":["php","mysql","query","environment"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":67,"score":-4,"question_id":13240734,"title":"Using mysql query and result in php?","body":"<p>I've had some help from bluefleet (BF) with a mysql query, i now need to use that query in a php environment, this is what i've come up with, firstly can you tell me if it's correct and secondly do i need to release the query after i've done something with the result?</p>\n\n<p>Here's the query</p>\n\n<pre><code>    $myquery= \"select sum(total)\nfrom\n(\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview v\n    where v.ipaddress = $ips\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview1 v1\n    where v1.ipaddress = $ips\n    union all\n    SELECT count(*) as total\n    FROM \" .TABLE_PREFIX.\"tview3` v3\n    where v3.ipaddress = $ips\n) src\";\n\nwhile ($row = mysql_fetch_array($myquery)) {\n\nIf($row !=0){\necho \"NOT EMPTY\";\n}else{\necho \"EMPTY\";\n}\n}\n</code></pre>\n"},{"tags":["php","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":50,"score":-2,"question_id":13239393,"title":"php- Query - need to adapt a line of code to act as another one (shown)","body":"<p>On one hand I have this part of code that list my recent articles correctly (wit the ones from Categories tagged as inrecent=1\n\"</p>\n\n<pre><code> $query = \"SELECT * FROM \" . AL_ARTICLES_TABLE . \" AS art\n    INNER JOIN \" . AL_USERS_TABLE . \" AS u ON art.AuthorID = u.UserID\n    LEFT JOIN \" . AL_CATASSOC_TABLE . \" AS ca ON art.ArticleID = ca.ArticleID\n    INNER JOIN \" . AL_CATEGORIES_TABLE . \" AS c ON ca.CategoryID = c.CategoryID\n    WHERE ca.CategoryID IN(%s) \n    AND art.Featured=0 \n    AND art.Visible=1 \n    AND c.inrecent=1 \n    AND art.Status=1 \n    AND art.StartDate &lt;= '\".GetMysqlDateTime().\"' \n    AND art.IsFinished=1 \n    AND (art.ExpiryDate &gt;= '\".GetMysqlDateTime().\"' \n    OR art.EnableExpiry=0)\n    GROUP BY art.ArticleID\n    ORDER BY art.StartDate DESC, art.ArticleID DESC\n    LIMIT \" . $this-&gt;numArticles;\n</code></pre>\n\n<p>On the other hand I am looking to prevent the Articles from categories tagged as inrecent=0 to be selected in the query below (and I will need help, please) :</p>\n\n<pre><code>$query = sprintf(\"SELECT *, \n    unix_timestamp(StartDate) AS SD FROM %s AS a \n    INNER JOIN %s AS u ON a.AuthorID = u.UserID \n    WHERE a.Visible=1 AND a.Status=1  \n    AND a.IsFinished=1 \n    AND unix_timestamp(a.StartDate) &lt;= unix_timestamp(now()) \n    AND (unix_timestamp(a.ExpiryDate) &gt;= unix_timestamp(now()) \n    OR a.EnableExpiry=0) %s \n    ORDER BY StartDate DESC, ArticleID DESC %s\", \n    AL_ARTICLES_TABLE, AL_USERS_TABLE, $podcastQuery, $limitArticles);\n</code></pre>\n\n<p>Thank you for your help - Hope I posted enough info.</p>\n"},{"tags":["mysql","query","table","count"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":28,"score":1,"question_id":13240115,"title":"MySql find match in any of three tables?","body":"<p>im trying to find a match for an ip address in any one of three tables but my query tells me the column i'm looking in is ambiguous?</p>\n\n<pre><code>SELECT COUNT(*) \nFROM `zz_tview`,`zz_tview1`,`zz_tview3` \nWHERE `ipaddress` =\"192.168.01.01\"\n</code></pre>\n\n<p>So i get this message \"Column 'ipaddress' in where clause is ambiguous\", how would i construct this firstly so it works and secondly so the query isn't too heavy as the tables have many thousands of rows?</p>\n\n<p>Regards,\nSimon</p>\n"},{"tags":["sql-server","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13234761,"title":"Multiple rows in one","body":"<p>I know there are similar questions like mine but unfortunately I haven't found the corresponding solution to my problem.</p>\n\n<p>First off here's a simplified overview of my tables:</p>\n\n<ul>\n<li><p><code>Partner</code> table: <code>PartnerID, Name</code></p></li>\n<li><p><code>Address</code> table: <code>PartnerID, Street, Postcode, City, ValidFrom</code></p></li>\n<li><p><code>Contact</code> table: <code>PartnerID, TypID, TelNr, Email, ValidFrom</code></p></li>\n</ul>\n\n<p>A partner can have one or more addresses as well as contact info. With the contact info a partner could have let's say 2 tel numbers, 1 mobile number and 1 email. In the table it would look like this:</p>\n\n<pre><code>PartnerID   TypID   TelNr                   Email               ValidFrom\n1           1       0041 / 044 - 2002020                        01.01.2010\n1           1       0041 / 044 - 2003030                        01.01.2011\n1           2       0041 / 079 - 7003030                        01.04.2011\n1           3                               myemail@hotmail.com 01.06.2011\n</code></pre>\n\n<p>What I need in the end is, combining all tables for each partner, is like this:</p>\n\n<pre><code>PartnerID   Name    Street              Postcode        City            TelNr                               Email\n1           SomeGuy MostActualStreet    MostActualPC    MostActualCity  MostActual Nr (either type 1 or 2)  MostActual Email\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":["sql","sql-server","query","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13239312,"title":"Return 4 separate counts for single column in SSRS DataSet","body":"<p>I want to provide 5 counts to SSRS from a conditional count on a column.  For instance, suppose the column held the color of a product -- green ,blue, red and yellow.  What I would like to do is return the count of each in a single query.</p>\n\n<p>Although I can accomplish getting this done using a case statement:</p>\n\n<pre><code>Select\n      COUNT(*) 'Count',\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GR' then 'Green\n            Else 'All Others'\n      End as Payment\nFrom COLORS(NoLock)\nGroup by\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GRthen ‘Green’\n            Else 'All Others'\n      End\n</code></pre>\n\n<p>When I use the dataset is SSRS, all I get is the a single count.  I don't want to create 4 dataset queries as I'm actually selection the records by the parameters start and end date and I would end up having 5 sets of date parameters. </p>\n"}]}
{"total":20739,"page":3,"pagesize":100,"questions":[{"tags":["sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13239041,"title":"sql server 2008, altering the table layout","body":"<p>Please find the blow table.  </p>\n\n<p><strong>TABLE</strong>  </p>\n\n<pre><code>ClientID    Balance1    Balance2    Balance3    Balance4    Balance5    Balance6    Balance7    Balance8    Balance9\nA           NULL        NULL        NULL        3           Null        Null        Null        Null        Null\nB           10          null        Null        Null        20          Null        Null        Null        NULL\nC           Null        8           Null        10          Null        Null        1           Null        NULL\nD           Null        19          Null        Null        Null        Null        Null        Null        NULL\nE           Null        Null        50          Null        Null        Null        Null        Null        NULL\nF           NULL        NULL        NULL        30          NULL        NULL        NULL        NULL        NULL    \nG           NULL        NULL        NULL        NULL        80          NULL        NULL        NULL        NULL      \n</code></pre>\n\n<p>How can I modify the above table into as shown below by using query, Please help!    </p>\n\n<pre><code>ClientID    Balance1    Balance2    Balance3    Balance4    Balance5    Balance6    Balance7    Balance8    Balance9\nA           NULL        NULL        NULL        3           3           3           3           3           3   \nB           10          10          10          10          20          20          20          20          20\nC           Null        8           8           10          10          10          1           1           1\nD           Null        19          19          19          19          19          19          19          19\nE           Null        Null        50          50          50          50          50          50          50          \nF           NULL        NULL        NULL        30          30          30          30          30          30          \nG           NULL        NULL        NULL        NULL        80          80          80          80          80          \n</code></pre>\n"},{"tags":["mysql","sql","query","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13238850,"title":"Override column value in WHERE clause?","body":"<p>I was wondering if it was possible to override column value in the Where clause of a SQL query (MySQL in my case).</p>\n\n<p>To be more clear, here is an example :</p>\n\n<p>Suppose a basic query is :</p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = \"Doe\";\n</code></pre>\n\n<p>Is it possible to force <code>lastname</code> and <code>firstname</code> to return value from an other table, just by modifying what is after the WHERE part ? Something like </p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = (SELECT name FROM companies);\n</code></pre>\n\n<p>I am currently testing a web application, and I found a SQL Injection flaw where I can change <code>Doe</code> to whatever I want, but I'm limited with only one query (<a href=\"http://php.net/mysql_query\" rel=\"nofollow\">mysql_query restriction of PHP</a>) and <code>addslashes</code> (so no \" and ').</p>\n"},{"tags":["query","web-scraping"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12762425,"title":"Data Aggregation from multiple websites for a given query","body":"<p>Hi I am going to work on a project wherein i want to query few web sites and fetch similar data from them and present it to the user. for eg: if a user has a query with name-\"reebok shoes\" of size \"9.0\" between range \"$30 to $75\" , my application should scape a few websites (which i will be providing) for these queries and fetch the relevant data from them.Without saving the data in DB i need to format and fetch it to the user. I am new to this so need pointers on which framework to choose or which tool or any important stuff i should know abt web scraping. I did researched a few tools and framework but not sure which one is able to handle query specific web scraping.</p>\n"},{"tags":["wordpress","query","content","singlepage","development-approach"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13238747,"title":"Approach for creating a single-page WordPress site","body":"<p>I've lately come across several cases where the client wants a single-page WordPress site, be it a Parallax solution, a contained frame or just a regular page with all content gathered. So far I've used this approach for fetching the content:</p>\n\n<p>In the index.php file in the theme's folder, before any HTML I make a query for all content. This might be separated, such as a query for all pages, one for all posts of a specific category etc, so that they are more easily looped.\nThen I loop the queries,<br><br></p>\n\n<pre><code>while ( $query-&gt;have_posts() ) : $query-&gt;the_post();\n    // Sample\n    if ($post-&gt;ID == 1 ) {\n        $sample = get_the_content();\n    }\nendwhile;\n</code></pre>\n\n<p><br>and output the content at their respective part of the page. Now this works great for smaller sites, but put in an additional language and a couple of custom post types and it can get really messy. Now I'm wondering if there isn't a better approach, and one that particularly doesn't involve ID matching (i.e. running conditional statements for every article in the loop). Ideas?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13237570,"title":"MySQL query consuming an inordinate amount of processor time of the system's CPU","body":"<p>I have the following MySQL query which seems to be consuming an inordinate amount of processor time of the system's CPU.</p>\n\n<p>The query is suppose to get the news that has the highest number of comments in last week:</p>\n\n<pre><code>$timeago = strtotime(\"-1 week\");\n\n$query = \"SELECT * , \n    news.id, \n    news.title, \n    news.state, \n    news.date, \n    COUNT(comments.module_id) as comments_count, \n    comments.module, \n    comments.state \n    FROM news \n    LEFT OUTER JOIN comments on comments.module_id = news.id AND comments.module = 'news' AND comments.state = '1' \n    WHERE news.state = '2' \n    GROUP BY news.id, news.title, news.date \n    ORDER BY news.date &gt;= $timeago DESC, comments_count DESC limit 6\";\n\n$result = mysql_query($query) or die (mysql_error());\n$data = mysql_fetch_assoc($result);\n</code></pre>\n\n<p>The query servers me just right, it sorts out the news which has the highest number of comments in the last week. There is 17,290 record in news table. For this reason I am try to figure out to fix the query in a way that would be healthy for the CPU consumption.</p>\n\n<p>Any suggestions would be welcome.</p>\n\n<p>Explain plan says</p>\n\n<p>| id    | select_type   | table     | type  | possible_keys     | key   | key_len   | ref   | rows  | Extra</p>\n\n<p>| 1     | SIMPLE    | news  | ref   | state     | state     | 4     | const     | 17282     | Using where; Using temporary; Using filesort</p>\n\n<p>| 1     | SIMPLE    | comments  | ref   | module_id     | module_id     | 101   | saidasea_v2.news.id,const,const   | 4     </p>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13237830,"title":"SQL Server 2008 query to fill the null values","body":"<p>I need a query on below table</p>\n\n<p>TABLE     </p>\n\n<pre><code>ClienName   Bal0    Bal1    Bal2        Bal3        Bal4        Bal5        Bal6    \n--------------------------------------------------------------------------------\nA           600     600     NULL        NULL        NULL        NULL        NULL    \nB           Null    100     NULL        NULL        NULL        NULL        NULL    \nC           NULL    NULL    200          NULL       NULL        NULL        NULL        \nD           NULL    NULL    NULL        NULL        NULL        130         130     \nE           510     510     NULL        510         510         NULL        NULL    \nF           170     170     NULL        170         170         NULL        170 \nG           210     210     NULL        210         210         210         210     \nH           20      20      NULL        20          NULL        NULL        NULL    \n</code></pre>\n\n<p><strong>Result:  I would like to see the above TABLE as below, which query can do it? please help</strong>  </p>\n\n<pre><code>ClienName   Bal0    Bal1    Bal2        Bal3        Bal4        Bal5        Bal6    \n--------------------------------------------------------------------------------\nA           600     600     600         600         600         600         600     \nB           100     100     100         100         100         100         100     \nC           200     200     200         200         200         200         200     \nD           130     130     130         130         130         130         130         \nE           510     510     510         510         510         510         510     \nF           170     170     170         170         170         170         170 \nG           210     210     210         210         210         210         210     \nH           20      20      20          20          20          20          20\n</code></pre>\n"},{"tags":["mysql","query","optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13236212,"title":"MySQL soccer league query optimization (player stats)","body":"<p>I'd like to optimize this query 'cause it really seems a mess to me... </p>\n\n<pre><code>SELECT\n    L.id,\n    L.role,\n    L.first_name,\n    L.last_name,\n    L.birth_date,\n    L.team_name,\n    L.team AS team_id,\n    L.photo,\n    L.email,\n    L.played,\n    L.vote_average,\n    L.goal_sum AS goal,\n    L.score + IFNULL(L.c_mvp, 0)*10 AS score,\n    L.y_card_sum AS y_card,\n    L.r_card_sum AS r_card,\n    IFNULL(L.c_mvp, 0) AS mvp,\n    IFNULL(unbeaten, 0) AS unbeaten\nFROM (\n    SELECT * FROM (\n        SELECT\n            dc_player. *,\n            dc_team.name AS team_name,\n            COUNT( dc_match_entry.player_id ) AS played,\n            AVG( dc_match_entry.vote ) AS vote_average,\n            SUM( dc_match_entry.goal ) AS goal_sum,\n            SUM( dc_match_entry.vote ) *10 + SUM( dc_match_entry.goal ) *10 - SUM( dc_match_entry.r_card ) *10 - SUM( dc_match_entry.y_card ) *5 - SUM( dc_match_entry.own_goal ) *10 AS score,\n            SUM( dc_match_entry.y_card ) AS y_card_sum,\n            SUM( dc_match_entry.r_card ) AS r_card_sum\n        FROM\n            dc_player,\n            dc_match_entry,\n            dc_team\n        WHERE \n            dc_player.id = dc_match_entry.player_id AND\n            dc_player.team = dc_team.id\n        GROUP BY\n            dc_player.id\n    ) LOL\n    LEFT JOIN (\n        SELECT\n            COUNT(dc_match.mvp) c_mvp,\n            mvp AS player_id\n        FROM dc_match\n        WHERE\n            dc_match.mvp IS NOT NULL\n        GROUP BY dc_match.mvp\n    ) ROFL\n    ON ROFL.player_id = LOL.id\n    ORDER BY \n        LOL.score DESC\n) L\nLEFT OUTER JOIN(\n    SELECT\n        dc_player.id,\n        COUNT(dc_match.id) AS unbeaten\n    FROM\n        dc_match,\n        dc_match_entry,\n        dc_player\n    WHERE\n        (\n            (dc_player.team=dc_match.host AND\n            dc_match.guest_score=0\n            ) OR\n            (\n                dc_player.team=dc_match.guest AND\n                dc_match.host_score=0\n            )\n        ) AND\n        dc_player.id = dc_match_entry.player_id AND dc_match.id = dc_match_entry.match_day\n    GROUP BY\n        dc_player.id\n) I\nON\n    L.id = I.id\nGROUP BY\n    id\n</code></pre>\n\n<p>I read about some subqueries mysql issues and afaik this query seems to be a little \"heavy\". Can anybody help me with it? Thanks a lot.</p>\n"},{"tags":["sql-server","query","tsql","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13235720,"title":"SQL Server append query","body":"<p>I have the following (not working) query:  </p>\n\n<pre><code>insert into [MyDB].[dbo].[Reports_StepsStat]  \n    (ActivityID,TaskID,StepIndex,StepStatus,TimeSpanInSeconds,Score)\nVALUES (\n  SELECT\n    tasks.ActivityID as ActivityID,\n    tasks.ID as TaskID,\n    [StepIndex]=item.value('(StepIndex)[1]', 'NVARCHAR(MAX)'),\n    [StepStatus]=item.value('(Status)[1]', 'NVARCHAR(MAX)'),\n    [TimeSpanInSeconds] = DATEDIFF(MINUTE, item.value('(StartedOn)[1]',    'datetime'),item.value('(FinishedOn)[1]', 'datetime')),\n    tasks.Score as Score\n  FROM \n    [MyDB].[dbo].[Tasks] as tasks \n  CROSS APPLY \n    [Progress].nodes ('//Progress/Steps/ProgressStep') Progress(item)\n)  \n</code></pre>\n\n<p>The inner select query (<code>SELECT task.ActivityID..</code>) works perfectly and produces the expected table.  </p>\n\n<p>The outer <code>insert into</code> part is supposed to append the result of the inner part to a table by the name of <code>Reports_StepsStat</code>. This does not work.  </p>\n\n<p>I have tried and succeeded doing that with <code>SELECT INTO</code>, but apparently <code>SELECT INTO</code> can only be used to create a new table, and not to append to an existing table, which is what I need.  </p>\n\n<p>The errors I get are:  </p>\n\n<blockquote>\n  <p><em>Msg 156, Level 15, State 1, Line 6</em><br>\n  <em>Incorrect syntax near the keyword 'SELECT'.</em><br>\n  <em>Msg 102, Level 15, State 1, Line 14</em><br>\n  <em>Incorrect syntax near ')'.</em></p>\n</blockquote>\n"},{"tags":["sql","query","count"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13235981,"title":"Count number of occurrences for each unique value","body":"<p>Basically I have a table similar to this:</p>\n\n<pre><code>time.....activities.....length  \n13:00........3.............1  \n13:15........2.............2  \n13:00........3.............2  \n13:30........1.............1  \n13:45........2.............3  \n13:15........5.............1  \n13:45........1.............3  \n13:15........3.............1  \n13:45........3.............2  \n13:45........1.............1  \n13:15........3.............3  \n</code></pre>\n\n<p>A couple of notes:</p>\n\n<ul>\n<li>Activities can be between 1 and 5</li>\n<li>Length can be between 1 and 3</li>\n</ul>\n\n<p>The query should return:</p>\n\n<pre><code>time........count  \n13:00.........2  \n13:15.........2  \n13:30.........0  \n13:45.........1  \n</code></pre>\n\n<p>Basically for each unique time I want a count of the number of rows where the activities value is 3.</p>\n\n<p>So then I can say: </p>\n\n<pre><code>At 13:00 there were X amount of activity 3s.\nAt 13:45 there were Y amount of activity 3s.\n</code></pre>\n\n<p>Then I want a count for activity 1s,2s,4s and 5s. so I can plot the distribution for each unique time.</p>\n"},{"tags":["sql","database","sql-server-2008","query","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13235606,"title":"SQL query :Copy one table to another from different servers","body":"<p>What's wrong with my query, I want to copy three columns to another server\\table if one of the column (ID_DIRCT) is not null :</p>\n\n<pre><code>INSERT INTO  System\\Syst3.Server1.dbo.TABLE_RESRC (NO_EMPLY,PR,NM_FAML,CO_DIRCT)\nSELECT NO_EMPLY, PR_EMPLY, NM_EMPLY, ID_DIRCT \nFROM System\\Syst3.Server2.dbo.RESRC\nWHERE System\\Syst3.Server2.dbo.RESRC.ID_DIRCT IS NOT NULL\n</code></pre>\n\n<p>Using SQL Server 2008 R2.</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","indexing"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13235094,"title":"Indexing mysql query","body":"<p>I have this query in mysql and I wanted to be indexed, what is the best index composition?</p>\n\n<pre><code>SELECT cometchat.id, cometchat.from, cometchat.to, cometchat.message, cometchat.sent, cometchat.read, cometchat.direction\nFROM cometchat\nWHERE (\n(\ncometchat.to =  '30411'\nAND cometchat.direction &lt;&gt;2\n)\nOR (\ncometchat.from =  '30411'\nAND cometchat.direction &lt;&gt;1\n)\n)\n</code></pre>\n\n<p>I've tried these indexes but they didn't work:</p>\n\n<pre><code>ALTER TABLE  `cometchat` ADD INDEX (  `from`,`to`,`direction`)\nALTER TABLE  `cometchat` ADD INDEX (  `from`,`to`)\nALTER TABLE  `cometchat` ADD INDEX (  `to`,`direction`)\nALTER TABLE  `cometchat` ADD INDEX (  `from`,`direction`)\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198395,"title":"Select with SQL the oldest payment associated to a list of persons","body":"<p>Having troubles with a SQL query on an Oracle database (11G I think).</p>\n\n<p>I need to make a query on two tables. The first one contains identifiers of persons. The second one contains payments (you can consider it as salaries), each record associated to the person with a foreign key.</p>\n\n<p>What I need to do is retrieve, for a known list of persons (let's say identifiers 1, 2, 5 and 10), the oldest payment (based on the payment date).</p>\n\n<p>What I made first is this : </p>\n\n<pre><code>select id_person, MIN(payment_date) \nfrom payment where id_person in (1, 2, 5, 10)\ngroup by id_person;\n</code></pre>\n\n<p>This retrieves something like :</p>\n\n<pre><code>1   19940623\n2   20100429\n5   20100204\n10  20100111\n</code></pre>\n\n<p>Now, how do I get, for each person, the complete record of the ´payment´ table which correspond to the oldest payment ?</p>\n\n<p>I cannot figure out a way of doing this...</p>\n\n<p>The answer must be in a single SQL query (I cannot make a call for each person, which would be very easy to do...)</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":13233649,"title":"MySQL: Impossible WHERE noticed after reading const table","body":"<p>A very simple query always returns an empty result set, after running EXPLAIN, this is what I got:</p>\n\n<pre><code>EXPLAIN SELECT u.id, fname\nFROM user u\nWHERE (birthdate\nBETWEEN \"1992-04-05\"\nAND \"1990-04-05\")\nLIMIT 0,20\n</code></pre>\n\n<p>No matter, if I turn birthdays arround (1990-1992), it's the same... </p>\n\n<pre><code>id  select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  NULL    NULL    NULL    NULL    NULL    NULL    NULL    Impossible WHERE noticed after reading const table...\n</code></pre>\n\n<p>What does this error say? I only found other issues on SO where people tried to join tables, but this query is so simple, what is the matter with it? Any ideas would be highly appreciated, thank you already!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13233325,"title":"Get the ID for range with smallest difference","body":"<p>Lets say that I have a table A. This table has ID, X_value, Y_value. Here is content of table A:</p>\n\n<p>Table A</p>\n\n<pre><code>ID X_value Y_value\n1  100     150\n2  110     170\n3  120     190\n</code></pre>\n\n<p>Now, if I'm comparing number <strong>130</strong> with range numbers(X_value - Y_value) I would like to get ID of range with smallest(minimal) difference! If I can name it that way? Right away we see that number <strong>130</strong> will fall into all this ranges, but I need ID of range with smallest(minimal) difference between <strong>130</strong> and numbers of range. To elaborate that difference:</p>\n\n<pre><code>For range 1: 130-100=30 and 150-130=20\nFor range 2: 130-110=20 and 170-130=40\nFor range 3: 130-120=10 and 190-130=60\n</code></pre>\n\n<p>From this elaboration we see that minimal difference is at third range(that is <strong>10</strong>) so I would like to get ID <strong>3</strong>. What will be a query for this example if I have this table within MySQL db?! </p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13232681,"title":"Assistance with a regular expression mysql query","body":"<p>I have a database column with data that looks like  <strong>file_name|||file_id|||field_id</strong>  I would like to run a query to replace the data with just the <strong>file_id</strong>.</p>\n\n<p>So, my query, in essence needs to parse out the file_id between the pipes, and then update the field to replace the full string with just the file id.</p>\n"},{"tags":["query","activerecord","join","yii"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1159,"score":1,"question_id":8604350,"title":"Unknown column - multiple joins in CDbCriteria","body":"<p>I'm trying to get data from multiple tables and I've ended with this error:\nSQL: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'p.firstname' in 'field list'</p>\n\n<pre><code>    $criteria = new CDbCriteria;\n    $criteria-&gt;select = 'ohu_id, hash, p.firstname, p.surname, p.city, u.email AS Email';\n    $criteria-&gt;join = 'LEFT JOIN `profiles` p ON  p.user_id = user_id';\n    $criteria-&gt;join = 'LEFT JOIN users u ON user_id = u.id';\n    $criteria-&gt;condition = 'offer_id = :oID';\n    $criteria-&gt;params = array(':oID' =&gt; $_GET['id']);\n\n    $model = MyModel::model()-&gt;findAll($criteria);\n</code></pre>\n\n<p>Anyone know what I'm doing wrong?\nOr is there better way to get related data?</p>\n"},{"tags":["query","api","geolocation","wikipedia","geotagging"],"answer_count":6,"favorite_count":8,"up_vote_count":11,"down_vote_count":0,"view_count":1418,"score":11,"question_id":1400717,"title":"Reverse wikipedia geotagging lookup","body":"<p>Wikipedia is <a href=\"http://en.wikipedia.org/wiki/Geotagging\" rel=\"nofollow\">geotagging</a> a <a href=\"http://en.wikipedia.org/wiki/Aalborg\" rel=\"nofollow\">lot</a> <a href=\"http://en.wikipedia.org/wiki/British%5FIsles\" rel=\"nofollow\">of</a> <a href=\"http://en.wikipedia.org/wiki/Kent%27s%5FCavern\" rel=\"nofollow\">its</a> <a href=\"http://en.wikipedia.org/wiki/Aalborghus%5FCastle\" rel=\"nofollow\">articles</a>. (Look in the top right corner of the page.)</p>\n\n<p>Is there any API for querying all <a href=\"http://en.wikipedia.org/wiki/Wikipedia%3AWikiProject%5FGeographical%5Fcoordinates\" rel=\"nofollow\">geotagged pages</a> within a specified radius of a geographical position?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Okay, so based on lost-theory's answer I tried this (on <a href=\"http://dbpedia.org/snorql/\" rel=\"nofollow\">dbpedia query explorer</a>):</p>\n\n<pre><code>PREFIX geo: &lt;http://www.w3.org/2003/01/geo/wgs84_pos#&gt;\nSELECT ?subject ?label ?lat ?long WHERE {\n    ?subject geo:lat ?lat.\n    ?subject geo:long ?long.\n    ?subject rdfs:label ?label.\n    FILTER(xsd:float(?lat) - 57.03185 &lt;= 0.05 &amp;&amp; 57.03185 - xsd:float(?lat) &lt;= 0.05\n        &amp;&amp; xsd:float(?long) - 9.94513 &lt;= 0.05 &amp;&amp; 9.94513 - xsd:float(?long) &lt;= 0.05\n        &amp;&amp; lang(?label) = \"en\"\n    ).\n} LIMIT 20\n</code></pre>\n\n<p>This is very close to what I want, except it returns results within a (<a href=\"http://en.wikipedia.org/wiki/Local%5Fproperty\" rel=\"nofollow\">local</a>) square around the point and not a circle. Also I would like if the results where sorted based on the distance from the point. (If possible.)</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>I am trying to determine the euclidean distance as an approximation of the true distance, But I am having trouble on squaring a number in sparql. (<a href=\"http://stackoverflow.com/questions/1401401/power-in-sparql-and-other-math-functions\">Question opened here</a>.) When I get something useful I will update the question, but in the meantime I will appreciate any suggestions on alternative approaches.</p>\n\n<p><strong>Update 3</strong></p>\n\n<p>A final update. I gave up on using sparql trough dbpedia. I have written a simple parser which fetches the wikipedia article text nightly database dump and parses all articles for geocodes. It works rather nicely and it allows me to store information about geotagged articles however I wish.</p>\n\n<p>This is probably the solution I will continue using, and if I get around to create a nice interface to it I might consider allowing public API access and/or publishing the source to the parser.</p>\n\n<p>Thanks for all the suggestions, comments and help!</p>\n"},{"tags":["mysql","monitoring","query"],"answer_count":5,"favorite_count":33,"up_vote_count":43,"down_vote_count":0,"view_count":30497,"score":43,"question_id":568564,"title":"How can I view live MySQL queries?","body":"<p>I am just wondering if its possible to trace MySQL queries on my linux server as they happen?</p>\n\n<p>For example I'd love to set up some sort of listener, then request a web page and view all of the queries the engine executed, or just view all of the queries being run on a production server.</p>\n\n<p>Are there tools to do this?</p>\n"},{"tags":["eclipse","query","servlets","sparql","jena"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":22,"score":0,"question_id":13225623,"title":"eclipse jena and tomcat query","body":"<pre><code>import java.io.IOException;\nimport java.io.PrintWriter;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport com.hp.hpl.jena.ontology.OntModel;\nimport com.hp.hpl.jena.rdf.model.*;\nimport com.hp.hpl.jena.rdf.model.ModelFactory;\nimport com.hp.hpl.jena.util.FileManager;\nimport com.hp.hpl.jena.sparql.*;\nimport java.io.InputStream;\nimport com.hp.hpl.jena.query.*;\nimport com.hp.hpl.jena.util.FileManager;\nimport com.hp.hpl.jena.ontology.*;\n\n/**\n * Servlet implementation class rdf\n */\npublic class rdf extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public rdf() {\n        super();\n        // TODO Auto-generated constructor stub\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n        String inputFileName = \"/home/jarboox/Documentos/Eclipse/workspace/Sparql/src/tres.rdf\";\n\n        try {\n\n              //create the reasoning model using the base\n              OntModel inf = ModelFactory.createOntologyModel();\n\n              // use the FileManager to find the input file\n              InputStream in = FileManager.get().open(inputFileName);\n              if (in == null) {\n                throw new IllegalArgumentException(\"File: \" + inputFileName + \" not found\");\n              }\n\n              inf.read(in, \"\");\n\n        } catch (Exception e) {\n            System.out.println(e.getMessage());    \n          } \n    }\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Tomcat problem: </p>\n  \n  <p>type Informe de Excepción</p>\n  \n  <p>mensaje La ejecución del Servlet lanzó una excepción</p>\n  \n  <p>descripción El servidor encontró un error interno que hizo que no\n  pudiera rellenar este requerimiento.</p>\n  \n  <p>excepción</p>\n  \n  <p>javax.servlet.ServletException: La ejecución del Servlet lanzó una\n  excepción causa raíz</p>\n  \n  <p>java.lang.NoClassDefFoundError: com/hp/hpl/jena/rdf/model/ModelFactory\n    rdf.doPost(rdf.java:55)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) causa\n  raíz</p>\n  \n  <p>java.lang.ClassNotFoundException:\n  com.hp.hpl.jena.rdf.model.ModelFactory\n    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)\n    org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)\n    rdf.doPost(rdf.java:55)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) nota La\n  traza completa de la causa de este error se encuentra en los archivos\n  de diario de Apache Tomcat/6.0.36.</p>\n</blockquote>\n"},{"tags":["query","dns","resolver","dnspython"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13231344,"title":"dnsPython - answer from dns.resolver.query","body":"<p>I need some help with getting nameserver (NS) records from specific domains.\nSo far i had no problem with my script but now I realised that it has\nproblem getting answer from domains like this: fpv.ukf.sk\nWith simple domain like google.com, ukf.sk etc. I have no problem. </p>\n\n<p>used code:\nanswers = dns.resolver.query('fpv.ukf.sk', 'NS')</p>\n\n<p>I get this error:\n    answers = dns.resolver.query('fpv.ukf.sk', 'NS')\n  File \"build\\bdist.win32\\egg\\dns\\resolver.py\", line 920, in query\n    raise_on_no_answer, source_port)\n  File \"build\\bdist.win32\\egg\\dns\\resolver.py\", line 858, in query\n    raise_on_no_answer)\n  File \"build\\bdist.win32\\egg\\dns\\resolver.py\", line 133, in <strong>init</strong>\n    raise NoAnswer\nNoAnswer</p>\n\n<p>any suggestions why I cant get answer when I send query for fpv.ukf.sk domain?</p>\n"},{"tags":["mysql","query","select","double","rename"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13230685,"title":"Fetching a result twice with deferend name","body":"<p><br/>I have 1 table with tasks named opentask:<br/>columns: id,title,description,expires,creator_id,creator_name, executer_id, executer_name, priority_id, status_id<br/>1 table with users named user:<br/>\nwith columns: user_id, username<br/>\nWhat I want is to create a query where there will be all columns from opentask table where the executer_id will be equal to the user_id of user table AND the creator_id will be equal to the user_id again. This creates a confusion because the first equality excludes the second.<br/><br/>So I need somehow to create a query where I will include the usernames for the executer with something like where \"opentask.executer_id=user_user_id\" and at the same time I will include the username again (as a differend name?) for the creator with something like \"where opentask.executer_id=user_user_id\"<br/><br/>So I try this, which of course I know that is missing something, can you help?</p>\n\n<blockquote>\n  <p>SELECT DISTINCT id, title, description, expires, creator_id, executer_id, oc_opentask.priority_id, oc_opentask.status_id, priority_name, status_name, user_id, username, (SELECT username FROM oc_opentask, oc_user WHERE oc_opentask.creator_id=oc_user.user_id) AS username2 FROM oc_opentask, oc_opentask_priority, oc_user, oc_opentask_status WHERE oc_opentask.priority_id=oc_opentask_priority.priority_id AND oc_opentask.executer_id=oc_user.user_id AND oc_opentask.status_id=oc_opentask_status.status_id ORDER BY oc_opentask.expires DESC</p>\n</blockquote>\n"},{"tags":["query","powershell","psobject"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13228769,"title":"Powershell Find specific row (querying) psobject","body":"<p>I'm new to Powershell. And I'm struggling with the most simplest of tasks.</p>\n\n<p>OK.  This is a really stupid question, but I have created a PSObject ... added members (4 columns, ID, Name, Status, TagFile; a number of rows) ... I have a loop ... for each i (iteration) ... I want it to use the values for the row in my object where ID = i.</p>\n\n<p>It's really not hard.  I have googled and haven't come up with an answer which is clear enough or concise enough to help me.</p>\n"},{"tags":["sql","query","typo3","raw","extbase"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13084863,"title":"Extbase - get created sql from query","body":"<p>i want to get some database tables from my typo3 extensions.\nThe Extension is based on extbase.</p>\n\n<p>The query always returns nothing but the data exists</p>\n\n<p>I've tried this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n$query-&gt;statement('SELECT * FROM `my_table`\n    WHERE field = ? ORDER BY date DESC LIMIT 1',\n    array($condition));\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n\n$query-&gt;matching($query-&gt;equals('field', $condition));\n$query-&gt;setOrderings(array('date' =&gt; Tx_Extbase_Persistence_QueryInterface::ORDER_DESCENDING));\n$query-&gt;setLimit(1);\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>both returns <em>null</em> as result.</p>\n\n<p>Is it possible to get the sql that the class creates to look where the bug is?</p>\n\n<p>I've looked in some extbase persistent classes but didn't find a clue</p>\n\n<p>EDIT: \nFor those who are interested.. i found a \"solution\".</p>\n\n<p>If you create the query with the statement() method, you can print the query with this function</p>\n\n<pre><code>echo $query-&gt;getStatement()-&gt;getStatement();\n</code></pre>\n\n<p>It doesn't replace the placeholder.\nBut you can get the Variables with this method</p>\n\n<pre><code>var_dump($query-&gt;getStatement()-&gt;getBoundVariables());\n</code></pre>\n\n<p>Thats the best Solution that i found, without editing the extbase extenstions</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":10430335,"title":"sql query to find absent tables from database","body":"<p>I am using ORACLE database. \n<strong>EDIT</strong>:</p>\n\n<p>I want only tables not present in a list, not all those tables in database.</p>\n\n<p>Ex: In my database following tables are present:</p>\n\n<pre><code>a\nb\nc\nd\ne\nr\ns\n</code></pre>\n\n<p>I am being given a list of tables:</p>\n\n<pre><code>a\nb\nc\nv\nh\n</code></pre>\n\n<p>out of which i want to find out which tables are <strong>absent(not present)</strong> in my database.</p>\n\n<p>so: a, b, c are those tables which are present in my database. So excluding these tables my answer will be:</p>\n\n<pre><code>v and h \n</code></pre>\n\n<p><strong>My answer is not d,e,r,s</strong></p>\n\n<p>How can i write a query for this to find out?</p>\n"},{"tags":["query","select","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13228535,"title":"SELECT old data state with DB2","body":"<p>Is it possible to access old data state in an DB2 database?</p>\n\n<p>Oracle has the clause <pre>select ... as of timestamp</pre> to do it. Does DB2 have something like it?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13226450,"title":"Get latest updated records","body":"<p>I have an \"Observation\" table in SQL Server 2008. This table has a locationId column for a bunch of geographic locations, a few columns for observation details and a column for latest updated date.</p>\n\n<p>Every week, a new observation record for each location is appended. So a location has many occurrences in the table.</p>\n\n<p>What I want to achieve is to be able to get the most recent observation record for each location.</p>\n\n<p>Can anyone help with any idea?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Cheers,\nAlex</p>\n"},{"tags":["query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13227878,"title":"postgres coalesce fields, sum and group by","body":"<p>maybe someone can help me out with a postgres query.</p>\n\n<p>the table structure looks like this</p>\n\n<pre><code>  nummer   nachname   vorname   cash\n +-------+----------+----------+------+\n   2       Bert       Brecht    0,758\n   2       Harry      Belafonte 1,568\n   3       Elvis      Presley   0,357\n   4       Mark       Twain     1,555\n   4       Ella       Fitz      0,333\n   …\n</code></pre>\n\n<p>How can I coalesce the fields where \"nummer\" are the same and sum the cash values?\nMy output should look like this:</p>\n\n<pre><code>   2       Bert, Brecht      2,326\n           Harry, Belafonte \n   3       Elvis, Presley    0,357\n   4       Mark, Twain       1,888\n           Ella, Fitz   \n</code></pre>\n\n<p>I think the part to coalesce should work something like this:</p>\n\n<pre><code> array_to_string(array_agg(nachname|| ', ' ||coalesce(vorname, '')), '&lt;br /&gt;') as name,   \n</code></pre>\n\n<p>Thanks for any help,</p>\n\n<p>tony</p>\n"},{"tags":["mysql","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13187858,"title":"mysql query to find out non existing users","body":"<p>I am playing with 2 database tables. One is <strong>user</strong> table which contains user details like full name and active(whether the user is active or not) columns. The other one is <strong>tasks</strong> table which contains the task details of each user. So tasks table has columns called UserID and StartTime. The following query will display all user details who entered the tasks yesterday. </p>\n\n<pre><code>$today = mktime(0,0,0);\n$yesterday = $today - 86400;\n$res = $db-&gt;fetchAll(\"SELECT DISTINCT tasks.UserID,user.full_name FROM `tasks` JOIN `user` ON tasks.UserID=user.id WHERE user.active=1 AND tasks.StartTime &gt; \".$db-&gt;quote($yesterday,'integer').\" AND tasks.StartTime &lt; \".$db-&gt;quote($today,'integer'));\n</code></pre>\n\n<p>I need to find out the user details who doesn't enter the tasks yesterday. How can I modify the above query?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13227436,"title":"Excel data fetch query syntax","body":"<p>I have an .xlsx file with 15 columns from A to O. I can fetch the all data with a simple query;  OleDbCommand cmd = new OleDbCommand(\"SELECT *\" + \"FROM [Sheet1$]\", conn);</p>\n\n<p>Here is my problem ; I have missing datas all over the excel sheet and these are marked with '?' and spread randomly. I don't want to fetch the row even one attribute of the row is '?'. I tried ;</p>\n\n<pre><code>OleDbCommand cmd = new OleDbCommand(\"SELECT  [A],[B],[C],[D],[E],[F],[G],[H],[I],[J],[K],[L],[M],[N],[O]\" + \"FROM [Sheet1$]\" +  \n               \"Where A != ' ?' and B != ' ?' and C != ' ?' and D != ' ?' and E != ' ?' and F != ' ?' and G != ' ?' and H != ' ?' and I != ' ?' and J != ' ?' and K != ' ?' and L != ' ?' and M != ' ?' and N != ' ?' and O != ' ?'\", conn);\n</code></pre>\n\n<p>But I got the error : </p>\n\n<p>Syntax error (missing operator) in query expression.</p>\n\n<p>Can anyone help me with this ?</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","sql","perl","query","dbi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":13172755,"title":"Replace quotation marks in sql query in perl script","body":"<p>I have a text file of data that I am importing into a MySQL database. Some of the lines unfortunatley contain quotation marks, which causes my SQL queries to go haywire. I would like to get rid of any field that has quotation marks, or at very least ignore them in my query.</p>\n\n<p>I found something that might work, but being as this is run through a Perl script I am having issues \"escaping\" the quotation marks. I really don't know how and can't figure it out. I would like to just search through my table and delete any quotation marks (\") that it may find or replace it with a single quotation mark or space or anything really.</p>\n\n<pre><code>my $myreplacequery = \"REPLACE(s.Title, '\"','')\";\n$sth = $dbh-&gt;prepare($myreplacequery);\n$sth-&gt;execute;\n</code></pre>\n\n<p>Anyone have any ideas?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13226657,"title":"Insert text in each row of mysql field","body":"<p>I have a table with this structure :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | img.jpg\n2  | otherimg.png\n3  | img2.png \n4  | someimg.gif\n5  | otherelseimg.jpg\n6  | dummy.jpg\n7  | jusimg.jpg\n</code></pre>\n\n<p>How can I modified each row to become like this :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | folder/img.jpg\n2  | folder/otherimg.png\n3  | folder/img2.png \n4  | folder/someimg.gif\n5  | folder/otherelseimg.jpg\n6  | folder/dummy.jpg\n7  | folder/jusimg.jpg\n</code></pre>\n"},{"tags":["query","wordnet","expansion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13226629,"title":"WordNet, Query Expansion, Step by Step","body":"<p>I want to make a project about query expansion using wordnet,but it's hard to find step by step method to do it.</p>\n\n<p>i've found this article <a href=\"http://www.codeproject.com/Articles/11835/WordNet-based-semantic-similarity-measurement\" rel=\"nofollow\">http://www.codeproject.com/Articles/11835/WordNet-based-semantic-similarity-measurement</a> </p>\n\n<p>it is the step by step based on the articel</p>\n\n<p>input sentence to the program and then do this:</p>\n\n<p>1.Tokenization\n2. Tagging part of speech\n3. Stemming word\n4. Word sense disambiguation\n5. Semantic similiraity between two synset (it still confusing)</p>\n\n<p>and then we can conclude that word with larger score, is the query expansion from the input</p>\n\n<p>is there any source that i can learn about make query expansion using wordnet step by step?</p>\n\n<p>thank you</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13216427,"title":"mysql: row number for query results grouped by FK","body":"<p>I have a table that has the following columns:\nid | fk_id | rcv_date</p>\n\n<p>There may be multiple records with a common fk_id, which represents a foreign key id in a related table.</p>\n\n<p>I need to create a query that will assign a row number to each record, grouped by fk_id, sorted by rcv_date.</p>\n\n<p>I originally began with the following query, which works quite well for sorting and assigning row numbers:</p>\n\n<pre><code>SELECT @row:=@row +1 AS ordinality, c.fk_id, rcv_date\nFROM (SELECT @row:=0) r, mytable c\nORDER BY rcv_date\n</code></pre>\n\n<p>However -- the row count and sorting is done across the entire dataset. I need the counting to be within a common fk_id. For example, the following sample data would return (the first column represents the row count/ordinality):</p>\n\n<pre><code>1 | 5 | 2011-10-01\n2 | 5 | 2011-10-14\n3 | 5 | 2011-11-02\n4 | 5 | 2011-12-17\n1 | 8 | 2011-09-03\n2 | 8 | 2011-11-12\n1 | 9 | 2011-10-08\n2 | 9 | 2011-10-10\n3 | 9 | 2011-11-19\n</code></pre>\n\n<p>The middle column represents the fk_id. As you can see, the sorting and row count is within the fk_id \"grouping.\"</p>\n\n<p><strong>UPDATE</strong>\nI have a query that seems to be working, but would like some input as to whether it can be improved:</p>\n\n<pre><code>SELECT IF(@last = c.fk_id, @row:=@row +1, @row:=1) AS ordinality, @last:=c.fk_id, c.fk_id, rcv_date\nFROM (SELECT @row:=0) r, (SELECT @last:=0) l, mytable c\nORDER BY c.fk_id, rcv_date\n</code></pre>\n\n<p>So what this does is order by fk_id and then rcv_date -- which essentially handles my grouping. Then I use a second variable to compare the fk_id in the previous record with the current record: if it's the same, we increment the row; if different, we reset to 1.</p>\n\n<p>My tests with real data appear to be working. I suspect it's a pretty inefficient query though -- so if anyone has ideas for improving it, or see possible flaws, I would love to hear.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":1,"view_count":55,"score":5,"question_id":13225620,"title":"Parse in MySQL using comma as delimiter","body":"<p>I have two tables</p>\n\n<p>Table1 with list of users comma separated</p>\n\n<pre><code>Name    UserID\nabc     A,B,C,D\ndef     A,B,C\n</code></pre>\n\n<p>Table2</p>\n\n<pre><code>Name   UserID\nabc    A\nabc    B\nabc    C\ndef    A\ndef    B\n</code></pre>\n\n<p>I need to find the users that are in table1 for each Name but not in table2 (There won't ever be an instance when a UserID to Name pair is present in table2 but not in table1 as CSV). </p>\n\n<p>The output should be</p>\n\n<pre><code>Name    UserID\nabc     D\ndef     C\n</code></pre>\n\n<p><em>I can do this with PHP but <strong>is there a way this can be done through a query?</em></strong> I am not sure where to begin in case I'm doing this as a query.  Can I parse in MySQL using comma as delimiter?</p>\n"},{"tags":["mysql","sql","query","constraints"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":769,"score":0,"question_id":5156281,"title":"Mysql adding a constraint: force a field to get specific values","body":"<p>I have a simple mysql table with the following attributes: <code>Name, Surname, Role</code>.</p>\n\n<p>I want the Role field to get only 2 possible values: <code>Supervisor</code> or <code>Operator</code> and to result in error when a query tries to insert something different from that 2 values.</p>\n\n<p>For example, i want the following query to return an error:</p>\n\n<pre><code>INSERT INTO tablename (name,surname,role) VALUES ('max','power','footballplayer');\n</code></pre>\n\n<p>I tried setting the field <code>Role</code> as a <code>ENUM</code> or <code>SET</code> type but it will just leave the field empty instead of firing and error :(</p>\n"},{"tags":["query","dojo","innerhtml","nodelist"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12713306,"title":"getting value of dojo NodeList inner elements","body":"<p>I am building a configuration dialog using dojo that I later need to interrogate for user input. There are multiple rows in the dialog each with the same format and tags. Here is the html that I use to build each row.  </p>\n\n<pre><code>html = '&lt;div class=\"cfgtxtrow\"&gt; &lt;label&gt;Label:&lt;/label&gt;\n&lt;input id=\"mac\" type=\"hidden\" name=\"mac\" value=\"'+mac+'\"/&gt;\n&lt;input id=\"label\" type=\"text\" maxlength=\"6\" name=\"label\" value=\"'+labl+'\"/&gt;\n&lt;/div&gt;';\n</code></pre>\n\n<p>That part all works and I can see the data in Firebug on return.</p>\n\n<p>I need to parse the values out and ultimately send them to the server using xhr. So I thought that I could use dojo query to get the nodelist and walk each node to get to the input values and build an associative array of them to send. I figured this to be much like validating the values programmatically.</p>\n\n<p>I can see the innerhtml on each node (using dojo.query(\".cfgtxtrow\").forEach( function(node)) but cannot figure out how to programmatically (using dojo) get to the values on each node. I thought that I would be able to use dojo.byId or query on the Nodelist to get to its inner elements but I just get errors back. </p>\n\n<p>I am beginning to suspect that my concepts are all wrong, as I thought this would be simple.</p>\n\n<p>Here is what I ended up with..</p>\n\n<pre><code>dojo.query(\".cfgtxtrow input\").forEach( function(node)\n{\n    id = dojo.attr(node, \"id\" );\n    console.debug( node );\n\n    if( id == \"mac\" ) mac = dojo.attr( node, \"value\" ); // since mac comes first this is safe..\n    if( id == \"label\" )\n    {\n        labl = dojo.attr( node, \"value\" );\n        console.debug( mac );\n        console.debug( labl );\n        macLabels[mac] = labl;\n    }\n});\nconsole.debug(macLabels[mac]);\n// send the data via the xhrPut call..\n</code></pre>\n\n<p>I thought it should be simple and the dojo.attr call seems to do the job..</p>\n\n<p>Is there a better way to do the same thing ?</p>\n"},{"tags":["sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":73,"score":-1,"question_id":10897473,"title":"Complex SQL Server Database Query","body":"<p>Previously I had only one table (I have more, ofc, but these are the ones I'm struggling with), which was the <code>UNIVERSITY</code> table.</p>\n\n<p>I now want to create two more tables : <code>STATE</code> and <code>CITY</code>.</p>\n\n<h3>Table Attributes</h3>\n\n<pre><code>UNIVERSITY: ID, NAME, SHORTNAME, FK_STATE, FK_CITY\n\nSTATE: ID, NAME, SHORTNAME\n\nCITY : ID, NAME\n</code></pre>\n\n<h3>Problem</h3>\n\n<p>I am parsing a excel sheet for the universities (including the city and state in which this university resides). Once I have all this information in memory, the hardest part comes.</p>\n\n<p>How do I:</p>\n\n<blockquote>\n  <p>Insert all Universities in the database,including its state and city, but querying the STATE and CITY databases for their IDs, to set the FK's of the university correctly.</p>\n</blockquote>\n\n<p>Example:<br>\nOnce I add a University named 'PUC-RIO', it is presented in 'RIO DE JANEIRO', (city) 'RIO DE JANEIRO' (state aswell). Adding the university itself is not a problem, but, how can I update its foreign key to the 'RIO DE JANEIRO' Key on state and city tables?</p>\n"},{"tags":["mysql","query","table","search","optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13221136,"title":"How can I optimize the searching of two tables?","body":"<p>Let's say I'm some kind of newbie in MySQL. I have two tables:</p>\n\n<p>1st:</p>\n\n<pre>    CREATE TABLE IF NOT EXISTS `tags` (\n  `i` int(10) NOT NULL AUTO_INCREMENT,\n  `id` int(10) NOT NULL,\n  `k` varchar(32) COLLATE utf8_bin NOT NULL,\n  PRIMARY KEY (`i`),\n  KEY `k` (`k`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_bin AUTO_INCREMENT=1505426 ;\n</pre>\n\n<p>and 2nd:</p>\n\n<pre>CREATE TABLE IF NOT EXISTS `w` (\n  `id` int(7) NOT NULL,\n  `title` varchar(255) COLLATE utf8_bin NOT NULL,\n  `k1` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k2` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k3` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k4` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k5` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k6` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k7` varchar(24) COLLATE utf8_bin NOT NULL,\n  `k8` varchar(24) COLLATE utf8_bin NOT NULL,\n  `w` int(5) NOT NULL,\n  `h` int(5) NOT NULL,\n  `s` varchar(32) COLLATE utf8_bin NOT NULL,\n  `r` varchar(11) COLLATE utf8_bin NOT NULL,\n  `v` int(7) NOT NULL,\n  `c` varchar(32) COLLATE utf8_bin NOT NULL,\n  `c1` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c2` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c3` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c4` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c5` varchar(6) COLLATE utf8_bin NOT NULL,\n  `c6` varchar(6) COLLATE utf8_bin NOT NULL,\n  `m` varchar(4) COLLATE utf8_bin NOT NULL,\n  `t` int(10) NOT NULL,\n  `i` int(6) NOT NULL,\n  `o` int(6) NOT NULL,\n  `f` varchar(255) COLLATE utf8_bin NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `keywords` (`k1`,`k2`,`k3`,`k4`,`k5`,`k6`,`k7`,`k8`),\n  KEY `category` (`c`),\n  KEY `color1` (`c1`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin ROW_FORMAT=DYNAMIC;</pre>\n\n<p>I'm trying to search 2 words ($search1 + $search2) from table 'tags' and find id's at 'w' table.\n query:</p>\n\n<pre>SELECT w.id,w.title,w.k1,w.k2,w.k3,w.k4,w.k5,w.k6,w.k7,w.w,w.h,w.s,w.c1,w.c2,w.c3,w.c4,w.c5,w.c6,w.m,w.f\nFROM tags,tags as tags2,w\nWHERE tags.k ='$search1' AND tags2.k = '$search2'\nand tags.id = tags2.id and tags2.id = w.id\nORDER BY `w`.`id`desc limit 24</pre>\n\n<p>The problem is that EXPLAIN function shows \"Using where; Using temporary; Using filesort\"\nAlso I believe that there is another way to optimize this my type search system.\nActually all data is in 'w' table, I just have no idea how exactly to search it properly.\nI would be grateful for any help.</p>\n\n<p><strong>Edit</strong>:a bit more information about this</p>\n\n<p>table 'tags' 1505425 records InnoDB = 65,9 MiB</p>\n\n<p>table 'w' 398900 rercords, InnoDB = 140,3 MiB</p>\n\n<p>after this (<strong>updated</strong>) query:</p>\n\n<pre>select `w`.`id` AS `id`,`w`.`title` AS `title`,`w`.`k1` AS `k1`,`w`.`k2` AS `k2`,`w`.`k3` AS `k3`,`w`.`k4` AS `k4`,`w`.`k5` AS `k5`,`w`.`k6` AS `k6`,`w`.`k7` AS `k7`,`w`.`k8` AS `k8`,`w`.`w` AS `w`,`w`.`h` AS `h`,`w`.`s` AS `s`,`w`.`c1` AS `c1`,`w`.`c2` AS `c2`,`w`.`c3` AS `c3`,`w`.`c4` AS `c4`,`w`.`c5` AS `c5`,`w`.`c6` AS `c6`,`w`.`m` AS `m`,`w`.`f` AS `f` from `tags` join `tags` `tags2` join `w` where ((`tags`.`k` = '$search1') and (`tags2`.`id` = `tags`.`id`) and (`w`.`id` = `tags`.`id`) and (`tags2`.`k` = '$search2')) order by `tags`.`i` desc limit 0,24;</pre>\n\n<p>mysql still shows:\n<pre>\n+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+\n| id | select_type | table      | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra                       |\n+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+\n|  1 | SIMPLE      | tags       | ref    | k,id          | k       | 98      | const       |  902 |   100.00 | Using where; Using filesort |\n|  1 | SIMPLE      | tags2      | ref    | k,id          | id      | 4       | db.tags.id  |    4 |   100.00 | Using where                 |\n|  1 | SIMPLE      | w          | eq_ref | PRIMARY       | PRIMARY | 4       | db.tags2.id |    1 |   100.00 | Using where                 |\n+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+\n3 rows in set, 1 warning (0.00 sec)</p>\n\n<p></pre> 1 warning, also still everything remains the same, is there any solution for better performance? at the moment it works fine, but later everything will goes slower and slower i think.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13223565,"title":"How can I split one record into two and set null values?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning TuesdayEvening and so on\n1   2012-01-01          2               3               2              2\n2   2012-01-02          2               2               2              2\n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning  TuesdayEvening\n1   2012-01-01          2               NULL          2                 2\n1   2012-01-01          NULL            3             NULL              NULL\n2   2012-01-02          2               2             2                 2\n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>I already have a query but, neem some changes. See the query on\n<a href=\"http://sqlfiddle.com/#!3/d41d8/5712\" rel=\"nofollow\">SQL Fiddle</a>.\nThe output you can see here is the case where it goes wrong. For TuesdayEvening and MondayEvening I am expecting 2.</p>\n\n<p>The information on SQL Fiddle is:</p>\n\n<pre><code>Declare @t Table(Id int identity,[Date] Datetime,MondayMorning Int,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int)\nInsert Into @t Select '2012-01-01',0,2,0,2\n\nSELECT id\n    ,date\n    ,MondayMorning\n    ,(CASE WHEN MondayEvening &lt;&gt; MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,TuesdayMorning\n    ,(CASE WHEN TuesdayEvening &lt;&gt; TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t \n\nUNION ALL \n\nSELECT id\n    ,date\n    ,NULL AS MondayMorning\n    ,(CASE WHEN MondayEvening = MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,NULL AS TuesdayMorning\n    ,(CASE WHEN TuesdayEvening = TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t\nWHERE --MondayMorning &lt;&gt; MondayEvening\n--OR TuesdayMorning &lt;&gt; TuesdayEvening\nMondayMorning &lt;&gt; MondayEvening\nAND (MondayMorning != 0 and MondayEvening != 0)\nOR TuesdayMorning &lt;&gt; TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\n</code></pre>\n"},{"tags":["wordpress","query","timestamp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13222161,"title":"Wordpress custom query comparing two timestamp meta data","body":"<p>I am trying to query posts by comparing meta value.\nI have set two meta with the posts. i.e. 'start_date' and 'end_date'.\nthey are stored as UNIX timestamp.</p>\n\n<p>Now I want to query posts on following conditions:</p>\n\n<ol>\n<li>timestamp of current momment is after(greater than) 'start_date'.</li>\n<li>timestamp of current momment is before(smaller than) 'end_date'.</li>\n</ol>\n\n<p>In this case, I want both conditions to fulfill. So, I have used 'relation'=>'AND'. </p>\n\n<p>So here is the print_r of the query:</p>\n\n<pre><code>Array\n(\n   [post_type] =&gt; ads\n   [meta_query] =&gt; Array\n       (\n           [relation] =&gt; AND\n           [0] =&gt; Array\n               (\n                   [kye] =&gt; start_date\n                   [compare] =&gt; &lt;=\n                   [value] =&gt; 1352054503\n                   [type] =&gt; NUMERIC\n               )\n\n           [1] =&gt; Array\n               (\n                   [kye] =&gt; end_date\n                   [compare] =&gt; &gt;=\n                   [value] =&gt; 1352054503\n                   [type] =&gt; NUMERIC\n               )\n\n       )\n\n)\n</code></pre>\n\n<p>Note: ads is a custom post type.</p>\n\n<p>And here is meta of a post:</p>\n\n<pre><code>Array\n(   \n   [start_date] =&gt; Array\n       (\n           [0] =&gt; 1352160000\n       )\n\n   [end_date] =&gt; Array\n       (\n           [0] =&gt; 1352246400\n       )\n\n)\n</code></pre>\n\n<p>I see absolutely no reason why this post should show up.\nThe start date timestamp(1352160000) is bigger than the current timestamp(1352054503). Which breaks condition #1.\nSo, why is this still showing up?\nWhat do you think?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13222950,"title":"Assistance writing a mysql query based on conditions","body":"<p>I'm attempting to write a MySQL statement based on an if statement.</p>\n\n<p>Here's what I want to do: I need the query to collect rows based on whether or not an item is going to be due within two weeks or if it's already passed due.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>select\n  t_id,\n  firstName, \n  lastName, \n  checkTime,\n  due\nfrom (checkOut join People)\nwhere checkOut.p_id = People.p_id\norder by due IF(DATE(NOW()-checkOut.due) &lt;= 2 WEEK);\n</code></pre>\n\n<p>MySQL is stating that there is a syntax error near the IF statement (I'm not surprised as I'm not familiar with writing conditional statements in MySQL). </p>\n\n<p>Another question is regarding whether or not MySQL will yield a date that is negative (i.e. to indicate that an item is passed due). Thanks in advance.</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13221861,"title":"PDO fetchall() performance considerations?","body":"<p>After reading a few articles on the performance impact of PHP's PDO <code>fetchall()</code> function, I am curious if there is another way to accomplish the same outcome without invoking <code>fetchall()</code>.</p>\n\n<p>To explain, most agree that <code>fetchall()</code> tends to be resource intensive.  In my case, I don't believe it will be too big of an issue. Yes, I am having to pull an entire table from my database and display it to the user, but it is going to be about a 100 rows at the very most; I don't believe that will be an issue. Hypothetically, though, if I were needing to pull 100,000 rows, what would be a more optimal solution? </p>\n"},{"tags":["query","caching","filter"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":68,"score":5,"question_id":13024973,"title":"How to efficiently count totals for filter options","body":"<p>I am working on a webshop-type application. One feature I often see in other websites is a breakdown of filtering options, with after that a total of how many results that filtering option will have. You often see this on computer sites (e.g. Newegg) or used car sites. Example:</p>\n\n<pre><code>CPU:\n  * AMD (315)\n  * Intel (455)\n\nVideo card:\n  * ATI (378)\n  * Nvidia (402)\n</code></pre>\n\n<p>How can I efficiently calculate these totals? The website I a working on will have many different products (10.000+) with many different options. To make matters worse, the products are constantly changing.</p>\n\n<p>Trying to precalculate all the different filtering combination totals seems unfeasable. If I have 5 different filters with 4 options each, the number of option possibilities would be <code>20 * 16 * 12 * 8 * 4 = 122880</code>. It would take a long time to calculate that.</p>\n\n<p>Another option would be to query on-demand and cache the results (e.g. in Redis). But how could I manage the cache efficiently if products keep being added and removed? The caches would often be stale. I'm afraid I'd have to micro-manage cache invalidation somehow leading to a very complex and brittle implementation. The alternative would be to invalidate broad sections of cache. But immediately after invalidating, my database would be rushed by hunderds of queries from active users who need these totals recalculated.</p>\n\n<p>Is there a nice and elegant way to handle this?</p>\n"},{"tags":["sql","sql-server","query","insert","character"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13218271,"title":"SQL statement using special charter","body":"<p>Can anyone please help me in correcting below statement:</p>\n\n<pre><code>SET @cmd='BULK INSERT ' + @Database + '.dbo.' + @tmp + ' from ' + @Out + @tmp + '.csv \nWITH (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)' \n</code></pre>\n\n<p>Output of the above query is: </p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)</p>\n</blockquote>\n\n<p>I want to print this in below manner:</p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR =',', ROWTERMINATOR = '\\n')</p>\n</blockquote>\n"},{"tags":["php","sql","query","orm","kohana"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13219599,"title":"Kohana is not loading the result rows?","body":"<p>if i try to load a result with Kohana ORM, the query is correct, but the result is empty. If i copy the Query and use it in phpmyadmin, i receive 2 rows.</p>\n\n<p>This is the Kohana Code (ORM)</p>\n\n<pre><code>        // DB work\n        $ftps = ORM::factory('ftp');\n\n        // if we activate many (we load only ready)\n        if ($this-&gt;request-&gt;param('mode') == 'activate') {\n            $ftps-&gt;where('ready', '=', '1');\n\n        // if we activate many (we load only ready)\n        } elseif ($this-&gt;request-&gt;param('mode') == 'not_ready') {\n            $ftps-&gt;where('ready', '=', '0');\n        }\n\n        // DB work\n        $ftps-&gt;and_where('activated', '=', '0')\n             -&gt;order_by('lastcheck', 'ASC')\n             -&gt;limit(intval($post['number']))\n             -&gt;find_all();\n</code></pre>\n\n<p>This is the SQL Query (Debug) </p>\n\n<pre><code>SELECT `ftp`.* FROM `ftps` AS `ftp` WHERE `activated` = '0' ORDER BY `lastcheck` ASC LIMIT 100 (1)\n</code></pre>\n\n<p>Why is Kohana not able to load the same results like phpmyadmin does? It's the same query. I don't find a solution.</p>\n\n<p>Thank you for your help</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13219212,"title":"speed up mysql query with group by","body":"<p>I have a mysql query:</p>\n\n<p><code>SELECT date(FROM_UNIXTIME(time)) as date,<br>\ncount(view) as views<br>\nFROM ('table_1')<br>\nWHERE 'address' = 1<br>\nGROUP BY date(FROM_UNIXTIME(time))</code></p>\n\n<p>total rows in table is <code>270k</code></p>\n\n<p>this query have slow executing, in myql-slow.log is: </p>\n\n<blockquote>\n  <p>Query_time: 1.839096  Lock_time: 0.000042 Rows_sent: 155  Rows_examined: 286435</p>\n</blockquote>\n\n<p>view - it's auto increment and primary key,  (int(11))<br>\naddress - have index , (int(11))<br>\ntime - also have index, (int(11))</p>\n\n<p>with use EXPLAIN looks like below:</p>\n\n<blockquote>\n  <p>id &nbsp; select_type  &nbsp;&nbsp;&nbsp;   table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   type   possible_keys&nbsp;&nbsp;&nbsp; key       key_len &nbsp;&nbsp;&nbsp;ref   &nbsp;&nbsp;&nbsp; rows  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Extra<br>\n  1  SIMPLE  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   table_1  &nbsp; ref   &nbsp;&nbsp;&nbsp;address    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   address  5      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const  139138 &nbsp;  Using where; Using temporary; Using filesort</p>\n</blockquote>\n\n<p>maybe somebody know how to improve this query to speed up executing? maybe better will be if I will change date in php ? but I think in php take a date as timestamp next convert to human readable and make \"group by\" will take more time then one query in mysql .   <br><br>maybe somebody know how to make this query faster?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13218355,"title":"MySQL query: retrieve some rows based on keys in another table","body":"<p>I'm new at MySQL, so I will use an example to expose my problem...</p>\n\n<p>I have two tables:</p>\n\n<p><strong>Table1:</strong></p>\n\n<pre><code>+----+-----+-----+-----+-----+\n| id | a1  | b1  | c1  | d1  |\n+----+-----+-----+-----+-----+\n|  1 | ... | ... | ... | ... |\n|  2 | ... | ... | ... | ... |\n|  3 | ... | ... | ... | ... |\n|  4 | ... | ... | ... | ... |\n|  5 | ... | ... | ... | ... |\n|  6 | ... | ... | ... | ... |\n+----+-----+-----+-----+-----+\n</code></pre>\n\n<p><strong>Table2:</strong></p>\n\n<pre><code>+----+-----+-----+-----+---------------+\n| id | a2  | b2  | c2  | table1_row_id |\n+----+-----+-----+-----+---------------+\n|  1 | ... | ... | ... | ...           |\n|  2 | ... | ... | ... | 4             |\n|  3 | ... | ... | ... | ...           |\n+----+-----+-----+-----+---------------+\n</code></pre>\n\n<p>Table2 column <code>table1_row_id</code> is the key for table1.</p>\n\n<p>Which kind of query should I use to retrieve table1 data that is not referenced in <code>table2.table1_row_id</code> column?</p>\n\n<p>For instance, for the above tables, the query should return a table like:</p>\n\n<pre><code>+----+-----+-----+-----+-----+\n| id | a1  | b1  | c1  | d1  |\n+----+-----+-----+-----+-----+\n|  1 | ... | ... | ... | ... |\n|  2 | ... | ... | ... | ... |\n|  3 | ... | ... | ... | ... |\n|  5 | ... | ... | ... | ... |\n|  6 | ... | ... | ... | ... |\n+----+-----+-----+-----+-----+\n</code></pre>\n\n<p>Probably this is simple, but I don't know how should I do yet...</p>\n"},{"tags":["sql","vb.net","query","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13209090,"title":"No effect on rowstate after editing data in textbox binded to a binding source VB","body":"<p>I have a sql Query using join that fills the binding source</p>\n\n<pre><code>SELECT        \n  CustomerServiceLocation.id, \n  CustomerServiceLocation.custId, \n  CustomerServiceLocation.custSubId, \n  CustomerServiceLocation.locationId, \n\n  cust.firstNamePri, \n  cust.lastNamePri, \n  cust.phonePriPri, \n  cust.phoneAltPri, \n  cust.extPri, \n  cust.firstNameAlt, \n  cust.lastNameAlt, \n  cust.phonePriAlt, \n  cust.phoneAltAlt, \n  cust.extAlt, \n  cust.id AS Expr1, \n\n  location.custId AS Expr2, \n  location.city, \n  location.unitNum, \n  location.zip, \n  location.gated, \n  location.height, \n  location.code, \n  location.street, \n  location.email, \n  location.comments,\n  location.id AS Expr3 \nFROM            \n  CustomerServiceLocation \nINNER JOIN\n  Customer AS cust ON CustomerServiceLocation.custId = cust.id \nINNER JOIN\n  ServiceLocation AS location ON CustomerServiceLocation.locationId = location.id \nWHERE        \n  (CustomerServiceLocation.custSubId = @custId)\n</code></pre>\n\n<p>The query runs fine and the text boxes binded also display the corect information. When I edit datain text box and select save from navigation then the dataset shows no change in row state. This is the code I use behind the save button in navigation binder:</p>\n\n<pre><code>    Me.Validate()\n\n    Me.CustomerServiceLocationBindingSource.EndEdit()\n\n\n    Dim deletedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n    CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Deleted), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim newChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Added), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim modifiedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Modified), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n</code></pre>\n\n<p>But none of the variables show any changes in <code>deletedChildRecords</code>, <code>newChildRecords</code> &amp; <code>modifiedChildRecords</code></p>\n\n<p>Can anyone help me figure out what I am doing wrong.</p>\n\n<p>Thanks.</p>\n\n<p>UPDATE: if I make changes in fields that are part of CustomerServiceLocation table only those fields value are detected in getChanges and not the Joined tables fields. Can anyone explain how to get changes for joined tables fields that have been binded.</p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13217679,"title":"SHOW TABLES only shows tables starting with a space mysql","body":"<p>I have some code that needs to get a list of all of the tables in a database with a certain column equaling a certain thing. However, using the <code>SHOW TABLES</code> MySQL code is only listing tables that start with a space. Here is my code...</p>\n\n<pre><code>$result = mysql_query(\"SHOW FULL TABLES IN `db`\") or die(\"Error: \" . mysql_error());\nwhile ($word = mysql_fetch_array($result)) {\n    $word = $word[0];\n    $sql = \"SELECT * FROM `db`.`$word` WHERE col='$val'\";\n    $result = mysql_query($sql, $con) or die(\"Error: \" . mysql_error());\n    while ($col = mysql_fetch_array($result)) echo \"&lt;li&gt;&lt;a nav='$word' title='View $word'&gt;$word&lt;/a&gt;&lt;/li&gt;\";\n}\n</code></pre>\n\n<p>For some reason, the first <code>mysql_query()</code> is only returning one result, which happens to be a table beginning with a space. (It is the only table starting with a space in the whole thing)\nEdit: I just realized that I left out the line of code that turned $word from an array into a string... it's in there now.</p>\n"},{"tags":["sql","database","query","select"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13217069,"title":"Using max() in SQL","body":"<p>One part of my homework assignment is to find the student with the highest average from each department. </p>\n\n<p>QUERY: </p>\n\n<pre><code>SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\nFROM studentgrades g, student s\nWHERE g.sid = s.sid\nGROUP BY s.sid\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>1   Robert  ger 80.0000\n2   Julie   sta 77.0000\n3   Michael csc 84.0000\n4   Julia   csc 100.0000\n5   Patric  csc 86.0000\n6   Jill    sta 74.5000\n</code></pre>\n\n<p>To answer The question, I ran the query </p>\n\n<pre><code>SELECT dcode, averages.sfirstName, MAX(averages.average)\nFROM (\n    SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\n    FROM studentgrades g, student s\n    WHERE g.sid = s.sid\n    GROUP BY s.sid) averages\nGROUP BY dcode\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>csc Michael 100.0000\nger Robert  80.0000\nsta Julie   77.0000\n</code></pre>\n\n<p>Even though the averages are correct, the names are not!\nJulia is the one who has the average 100 in csc, so why does Michael show up?</p>\n\n<hr>\n\n<p>Here's an example:</p>\n\n<p>a student takes courses and gets grades for these courses. EG:</p>\n\n<pre><code>student1 from dept1 took course A and got grade 80\nstudent1 from dept1 took course B and got grade 90\nstudent2 from dept1 took course C and got grade 100\nstudent3 from dept2 took course X and got grade 90\n</code></pre>\n\n<p>AFTER RUNNING THE FIRST QUERY we get the averages for each student</p>\n\n<pre><code>student 1 from dept1 has average 85\nstudent 2 from dept1 has average 100\nstudent 3 from dept2 has average 90\n</code></pre>\n\n<p>Now we find the student with the highest average from each department</p>\n\n<pre><code>dept1, student2, 100\ndept2, student3, 90\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":212,"score":8,"question_id":12315573,"title":"How to write Oracle query to find a total length of possible overlapping from-to dates","body":"<p>I'm struggling to find the query for the following task</p>\n\n<p>I have the following data and want to find the total network day for each unique ID</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   03-Sep-12   07-Sep-12   5\n1   03-Sep-12   04-Sep-12   2\n1   05-Sep-12   06-Sep-12   2\n1   06-Sep-12   12-Sep-12   5\n1   31-Aug-12   04-Sep-12   3\n2   04-Sep-12   06-Sep-12   3\n2   11-Sep-12   13-Sep-12   3\n2   05-Sep-12   08-Sep-12   3\n</code></pre>\n\n<p>Problem is the date range can be overlapping and I can't come up with SQL that will give me the following results</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   31-Aug-12   12-Sep-12   9\n2   04-Sep-12   08-Sep-12   4\n2   11-Sep-12   13-Sep-12   3\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>ID  Total Network Day\n1   9\n2   7\n</code></pre>\n\n<p>In case the network day calculation is not possible just get to the second table would be sufficient.</p>\n\n<p>Hope my question is clear</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13216582,"title":"Issue with value being returned from PDO query","body":"<p>I am experiencing an issue with the values being returned from my PDO statement.</p>\n\n<p>This is my code:</p>\n\n<pre><code>//Execute test\n$this-&gt;checkConnect();\n$stmt = $this-&gt;dbh-&gt;prepare(\"SELECT p_id FROM People WHERE lastName = :param1 AND firstName = :param2\");\n$stmt-&gt;bindParam(':param1', $this-&gt;lName);\n$stmt-&gt;bindParam(':param2', $this-&gt;fName);\n$stmt-&gt;execute();\n$count = $stmt-&gt;rowCount();\n\n//Determine value of test\nif($count == FALSE)\n{\n    return FALSE;\n}\nelse\n{\n    $dummyvar = $stmt-&gt;fetch();\n    $this-&gt;p_id = implode($dummyvar);\n}\n</code></pre>\n\n<p>When I was going through my database records, I noticed that a certain value was off from what I had input. When I execute a query, it is supposed to grab the value of <code>p_id</code> from the table<code>People</code>. Simple enough. However, what happens is that the number is appended twice to itself. For instance, say <code>p_id</code> is equal to 1. <code>this-&gt;p_id</code> will be equal to 11. Or is <code>p_id</code> is equal to 2, the output will be 22. I've executed this query within MySQL and the value is correct. I'm not sure what is happening in my php code. Perhaps something to do with implode? I'm not sure.</p>\n\n<p>Any insight will be appreciated.</p>\n\n<p>Addition: I should also state that <code>p_id</code> is unique, thus only one value can be returned.</p>\n"},{"tags":["query","button","extjs","grid","next"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":11715065,"title":"Result lost with Extjs grid panel \"next button\"","body":"<p>I have a grid panel which works with a search function. Each time the search button is pressed, a query is passed and the grid panel is sorted and display</p>\n\n<p>The query works fine. But when I pressed the \"Next Page Button\" The query information got lost and returns to the original states [with no query execution]</p>\n\n<pre><code>bbar: new Ext.PagingToolbar(\n{\n    store: store,\n    pageSize: 20,\n    plugins: [new Ext.ux.Andrie.pPageSize()],\n    displayInfo: true,\n    width: '400',\n    refresh: function(pt, o) {\n        store.reload();\n        FormPanel.findById('grid').getView().refresh();\n    },\n    emptyMsg: \"No message to display\"\n    }\n)\n</code></pre>\n\n<p>Why is it so?</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13215553,"title":"Match a column from a column with concatenated values in sqlite","body":"<p>I have a table with a column that has concatenated values like this</p>\n\n<pre><code>Table CHILD:\n\n    ChildId       Values\n    2           x123,j455\n    3           f456,z789 \n    4           m333,y567\n    5           x123,h888\n</code></pre>\n\n<p>And I have a master table MASTER that has </p>\n\n<pre><code>Table MASTER:\n\n    MainValues\n    x123\n    f456\n    y567\n</code></pre>\n\n<p>I need to get a query that'll select the following data</p>\n\n<pre><code>ChildId MainValues\n2       x123\n3       f456\n4       y567\n5       x123\n</code></pre>\n\n<p>Basically match value from MASTER in child values and return only the master value. How can I do this ? I have tried IN and LIKE clause matching with second table but that doesnt help much since the values are csv. Is there a way to split and match in sqlite ? </p>\n\n<p>EDIT: Table and column names are fictional and intended just to explain this question better</p>\n"},{"tags":["query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13215435,"title":"elasticsearch - How to reference multi-field when building query","body":"<p>I am unable to access multi fields using the navigation notation</p>\n\n<p>My mapping:</p>\n\n<pre><code>{\n\"mappings\":{\n    \"document\":{\n        \"properties\":{\n            \"tags\":{\n                \"type\":\"object\",\n                \"properties\":{\n                    \"title\":{\n                        \"fields\":{\n                            \"partial\":{\n                                \"search_analyzer\":\"main\",\n                                \"index_analyzer\":\"partial\",\n                                \"type\":\"string\"\n                            },\n                            \"title\":{\n                                \"type\":\"string\",\n                                \"analyzer\":\"main\"\n                            },\n                            \"title2\":{\n                                \"type\":\"string\",\n                                \"analyzer\":\"main\"\n                            }\n                        },\n                        \"type\":\"multi_field\"\n                    }\n                }\n            }\n        }\n    }\n},\n\n\"settings\":{\n    \"analysis\":{\n        \"filter\":{\n            \"name_ngrams\":{\n                \"side\":\"front\",\n                \"max_gram\":50,\n                \"min_gram\":2,\n                \"type\":\"edgeNGram\"\n            },\n            \"name_ngrams_back\":{\n                \"side\":\"back\",\n                \"max_gram\":50,\n                \"min_gram\":2,\n                \"type\":\"edgeNGram\"\n            },\n            \"name_middle_ngrams\":{\n                \"type\":\"nGram\",\n                \"max_gram\":50,\n                \"min_gram\":2\n            }\n        },\n\n        \"analyzer\":{\n            \"main\":{\n                \"filter\": [\"standard\", \"lowercase\", \"asciifolding\"],\n                \"type\": \"custom\",\n                \"tokenizer\": \"standard\"\n            },\n            \"partial\":{\n                \"filter\":[\"standard\",\"lowercase\",\"asciifolding\",\"name_ngrams\"],\n                \"type\": \"custom\",\n                \"tokenizer\": \"standard\"\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Test data:</p>\n\n<pre><code>curl -XPUT localhost:9200/testindex/document/1 -d '{\"title\": \"Fight for your life\"}'\ncurl -XPUT localhost:9200/testindex/document/2 -d '{\"title\": \"Fighting for your life\"}'\ncurl -XPUT localhost:9200/testindex/document/3 -d '{\"title\": \"Will you just start the    fight\"}'\n</code></pre>\n\n<p>Search:</p>\n\n<pre><code> curl -XGET 'localhost:9200/testindex/document/_search?q=title:life&amp;pretty=1'                   // Ok\n curl -XGET 'localhost:9200/testindex/document/_search?q=document.title:life&amp;pretty=1'     // Ok\n\n // Return 0 hits.  I expect this to return same result as the above queries.\n curl -XGET 'localhost:9200/testindex/document/_search?q=title.title2:life&amp;pretty=1'\n curl -XGET 'localhost:9200/testindex/document/_search? q=document.title.title2:life&amp;pretty=1'\n</code></pre>\n\n<p>How do I reference multi fields when building queries?</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13215466,"title":"Changed connection page to PDO and got mysql_error()","body":"<p>Was going over my code to turn all my queies into prepared queries (PDO). I changed my connection page accordingly. As I was cleaning up my functions page I came across the error <code>mysql_error() expects parameter 1 to be resource, integer given</code> which referred to my email function </p>\n\n<pre><code>email_exists($email){\n    $query1 = mysql_query(\"SELECT COUNT(user_id) FROM tempusers WHERE \n    `email` = '$email'\") OR die(mysql_error(0));\n    $email = sanitize($email);\n\n    return (mysql_result($query1,0)==1)? true : false;\n}\n</code></pre>\n\n<p>Because it is a function page meaning I can't call on the variables in my connection page coupled with the fact I'm still stuck in the old query ways I'm having a hard time fixing this query. I'd appreciate any ideas on the process of making this query work as well as any tips in general. </p>\n"},{"tags":["android","query","sqlite","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13215371,"title":"Android:Get single row from SQlLite, Null Pointer exception","body":"<p>I am trying to receive a row id from from a main activity and from there, display the content of that row. However I am getting a null pointer exception. I'm unsure of how to implement this properly.</p>\n\n<p>The exception is related to line 22 <strong>MODULEDATABASE.openToRead();</strong> I am an unsure if I need to open to read as I have done this in the main activity. If I comment out this line the next error refers to line 23  <strong>cursor = MODULEDATABASE.getRow(rowId);</strong> Any suggestions would be much appreciated</p>\n\n<p>LogCat error from **MODULEDATABASE.openToRead();</p>\n\n<pre><code>    10-23 09:12:52.572: E/AndroidRuntime(19778): Uncaught handler: thread main exiting due to uncaught exception\n10-23 09:12:52.582: E/AndroidRuntime(19778): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.mycoursetimetable/com.example.mycoursetimetable.ViewCourse}: java.lang.NullPointerException\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.access$2200(ActivityThread.java:119)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.os.Handler.dispatchMessage(Handler.java:99)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.os.Looper.loop(Looper.java:123)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.main(ActivityThread.java:4363)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at java.lang.reflect.Method.invoke(Method.java:521)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at dalvik.system.NativeStart.main(Native Method)\n10-23 09:12:52.582: E/AndroidRuntime(19778): Caused by: java.lang.NullPointerException\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at com.example.mycoursetimetable.ViewCourse.onCreate(ViewCourse.java:22)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)\n10-23 09:12:52.582: E/AndroidRuntime(19778):    ... 11 more\n10-23 09:12:52.603: I/dalvikvm(19778): threadid=7: reacting to signal 3\n10-23 09:12:52.603: E/dalvikvm(19778): Unable to open stack trace file '/data/anr/traces.txt': Permission denied\n10-23 09:12:59.232: I/Process(19778): Sending signal. PID: 19778 SIG: 9\n</code></pre>\n\n<p>LogCat cursor = MODULEDATABASE.getRow(rowId);</p>\n\n<pre><code>10-23 09:16:42.923: E/AndroidRuntime(20316): Uncaught handler: thread main exiting due to uncaught exception\n10-23 09:16:42.933: E/AndroidRuntime(20316): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.mycoursetimetable/com.example.mycoursetimetable.ViewCourse}: java.lang.NullPointerException\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.access$2200(ActivityThread.java:119)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.os.Handler.dispatchMessage(Handler.java:99)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.os.Looper.loop(Looper.java:123)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.main(ActivityThread.java:4363)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at java.lang.reflect.Method.invoke(Method.java:521)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at dalvik.system.NativeStart.main(Native Method)\n10-23 09:16:42.933: E/AndroidRuntime(20316): Caused by: java.lang.NullPointerException\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at com.example.mycoursetimetable.ViewCourse.onCreate(ViewCourse.java:23)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)\n10-23 09:16:42.933: E/AndroidRuntime(20316):    ... 11 more\n10-23 09:16:42.953: I/dalvikvm(20316): threadid=7: reacting to signal 3\n10-23 09:16:42.953: E/dalvikvm(20316): Unable to open stack trace file '/data/anr/traces.txt': Permission denied\n10-23 09:16:44.633: I/Process(20316): Sending signal. PID: 20316 SIG: 9\n</code></pre>\n\n<p>View Course activity</p>\n\n<pre><code>public class ViewCourse extends Activity {\nCursor cursor;\ndatabase MODULEDATABASE;\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_view_course);\n\n        Intent intent = getIntent();\n        String rowId = intent.getStringExtra(MyCourses.TEST);\n        //MODULEDATABASE.openToRead();\n        cursor = MODULEDATABASE.getRow(rowId);\n\n        TextView text_modulecode = (TextView)findViewById(R.id.viewModuleCode);\n        TextView text_modulename = (TextView)findViewById(R.id.viewModuleName);\n\n        text_modulecode.setText(cursor.getString(cursor.getColumnIndex(database.KEY_MODULECODE)));\n        text_modulename.setText(cursor.getString(cursor.getColumnIndex(database.KEY_MODULENAME)));\n\n    }\n</code></pre>\n\n<p>Database Class</p>\n\n<pre><code>public  database openToRead()throws SQLException{\n        myHelper = new DbHelper(myContext);\n        moduleDatabase = myHelper.getReadableDatabase();\n        return this;\n}\n\npublic Cursor getRow(String rowId)\n    {\n        String[] columns = new String [] {KEY_ROWID,KEY_MODULECODE, KEY_MODULENAME};\n        Cursor c = moduleDatabase.query(DATABASE_TABLE, columns,KEY_ROWID+ \"=\"+rowId , null, null, null, null);\n        if(c!=null){\n            c.moveToFirst();\n        }\n        return c;\n    }\n</code></pre>\n"},{"tags":["java","query","group-by","datanucleus","jdoql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13197072,"title":"Datanucleus jdoql group by having avg()","body":"<p>I'm trying to write a query that returns all departments whose average salary of employees is within the specified range.</p>\n\n<p>I have something like this:</p>\n\n<pre><code>Query query = pm.newQuery(Employee.class);\nquery.setResult(\"department, avg(salary)\");\nquery.setGrouping(\"department HAVING avg(salary) &gt;= :x &amp;&amp; avg(salary) &lt;= :y\");\nquery.setOrdering(\"2 desc\");\n</code></pre>\n\n<p>Problem is, that avg(salary) is counted again in HAVING, so I get all departments if avg(salary) is in the range or I get empty list of results otherwise. Any ideas?</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13213923,"title":"How to create sql query results in columns from rows?","body":"<p>From the following tables:</p>\n\n<ul>\n<li>store(store_id, ...) {1 ..., 2 ...} two stores</li>\n<li>film(film_id, ...)</li>\n<li>inventory(inventory_id, film_id, store_id)</li>\n<li>rental(rental_id, rental_date, inventory_id, return_date, ...)</li>\n<li>category(category_id, name)</li>\n<li>film_category(film_id, category_id)</li>\n<li>film(film_id, rental_duration, rental_rate, ...)</li>\n<li>customer(customer_id, store_id, ...)</li>\n</ul>\n\n<p>Can I have a query resutls on a table just like the follwoing?</p>\n\n<p>CategoryName | \"Store 1: avaliable items\" | \"Store 1: unavaliable items\" | \"Store 2: avaliable items\" | \"Store 2: unavaliable items\"</p>\n\n<p>Notice that the store fileds in the result table are inseperate columns not in the same columns !!</p>\n\n<p>I am not looking for the result query, I am looking for how to make them side by side store 1, store 2.</p>\n\n<p>Can case sql statement help here?</p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13213948,"title":"join two tables with different rows and multiple select statements","body":"<p>I have a result as</p>\n\n<pre><code>select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username\n</code></pre>\n\n<p>which gives me the columns as <code>username,EmaxViews</code> and gives me 93 rows</p>\n\n<p>and I have another table as <code>Users (username,date_registered,name)</code> which has 100 queries in it</p>\n\n<p>I would like to join my above two queries as a single table as</p>\n\n<pre><code>username, date_registered, EmaxViews\n</code></pre>\n\n<p>I tried like this</p>\n\n<pre><code>select name, date_registered,G.EmaxViews from Users F LEFT OUTER JOIN (select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username) G ON F.username=G.username ORDER BY F.date_registered;\n</code></pre>\n\n<p>Now I am getting 100 rows and proper values for name and date_registered but I am getting NULL for EmaxViews for all the rows..</p>\n\n<p>whats wrong in my query ?</p>\n"},{"tags":["java","mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13166471,"title":"MySQL syntax error using Java in Eclipse","body":"<p>I have the following prepared statement for sql  in Java :</p>\n\n<p>com.mysql.jdbc.JDBC4PreparedStatement@6e56103e:</p>\n\n<pre><code>INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)VALUES(2502591,'2000-03-02 02:02:02','5x5 aptb wdw','00:55:48','DotA v6.75b.w3x','aptb ')ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameStart),`Name`=VALUES(Name),`Lenght`=VALUES(Lenght),`MapVersion`=VALUES(MapVersion),`Mode`=VALUES(Mode).\n</code></pre>\n\n<p>When I execute it in Eclipse I get the following error:</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?,?,?,?,?,?)ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameSta' at line 1.\n</code></pre>\n\n<p>But at the same time when I execute the same query in SQLyog I don't get an error. Rows are updated. What can be a problem? Thanks in advance</p>\n\n<p>Code:</p>\n\n<pre><code>  Class.forName(\"com.mysql.jdbc.Driver\");\n    Connection con = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/dota\",\"root\",\"root\");\n    PreparedStatement updateGame = null;\n    String updatingGame = \"INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)\" +\n                \"VALUES(?,?,?,?,?,?)\" +\n                \"ON DUPLICATE KEY UPDATE \" +\n                \"`Id`=VALUES(Id),\"+\n                \"`GameStart` = VALUES(GameStart),\" +\n                \"`Name`=VALUES(Name),\" +\n                \"`Lenght`=VALUES(Lenght),\" +\n                \"`MapVersion`=VALUES(MapVersion),\" +\n                \"`Mode`=VALUES(Mode)\";\n    con.setAutoCommit(false);\n    updateGame=con.prepareStatement(updatingGame);\n                updateGame.setInt(1, game.Id);\n                Timestamp timestamp = new Timestamp(100,2,2,2,2,2,2);\n                updateGame.setTimestamp(2,timestamp);\n                updateGame.setString(3, game.GameName);\n                updateGame.setTime(4, (Time) game.Time);\n                updateGame.setString(5, game.MapVersion);\n                updateGame.setString(6, game.Mode);\n                updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>And on:</p>\n\n<pre><code>updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>I get an error</p>\n"},{"tags":["sql","query","table","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13205615,"title":"Advanced SQL SUM COLUMN FROM A SAME TABLE","body":"<p>I have this table...</p>\n\n<pre><code>+-----+--------+------+-----+-----+\n|categ| nAME   | quan |IDUNQ|   ID|\n+-----+--------+------+-----+-----+\n|   1 | Z      |    3 |   1 |  15 |\n|   1 | A      |    3 |   2 |  16 |\n|   1 | B      |    3 |   3 |  17 |\n|   2 | Z      |    2 |   4 |  15 |\n|   2 | A      |    2 |   5 |  16 |\n|   3 | Z      |    1 |   6 |  15 |\n|   3 | B      |    1 |   7 |  17 |\n|   2 | Z      |    1 |   8 |  15 |\n|   2 | C      |    4 |   8 |  15 |\n|   1 | D      |    1 |   8 |  15 |\n+-----+--------+------+-----+-----+\n</code></pre>\n\n<p>I need to get the <em>Z of category 1 + Z of category 2 - Z of category 3</em></p>\n\n<p>For example, <em>(3+3-1) = 5   ==>  3 of cat 1,  3 of cat 2, 1 of cat 3</em></p>\n\n<p>The final result should be...</p>\n\n<pre><code>Z ==&gt; 5\nA ==&gt; 5\nB ==&gt; 2\nC ==&gt; 4\n</code></pre>\n"},{"tags":["mysql","sql","query","select","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13210900,"title":"Sql Insert default value if Select returns nothing","body":"<p>I have the following SQL query which populates a table with details of various phone calls.</p>\n\n<pre><code>INSERT tblCalls (callerID, destinationNum)\nSELECT tblCallerID.callerID, tblSkyNums.skyID\nFROM tblCallerID, tblSkyNums\nWHERE tblCallerID.callerNumber = '\".$caller_id.\"'\nAND tblSkyNums.skyNum = '\".$dest_no.\"'\n</code></pre>\n\n<p>The query grabs a callerID and a skyID from two seperate tables and inserts them into a third table; tblCalls.</p>\n\n<p>My problem is sometimes no skyID exists for the number entered, and when this happens nothing is entered into tblCalls. Which means no data is recorded for this call.</p>\n\n<p>What I have been trying to do is if no such skyID exists, simply enter 'n/a' into the skyID field for that particular call.</p>\n\n<p>I have been at this for over two days now and cant seem to find a way to get it to work.\nAny help would be geatly appreciated.</p>\n"},{"tags":["python","query","google-app-engine","key","case-insensitive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13210408,"title":"case insensitive query for key_name","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3289781/how-to-make-case-insensitive-filter-queries-with-google-app-engine\">How to make case insensitive filter queries with Google App Engine?</a>  </p>\n</blockquote>\n\n\n\n<p>Can a GAE datastore be queried case insensitively for a key_name? Maybe query is not the right term. I really want to do a <code>get_by_key_name()</code> so the user does not have to have the correct case, but does have the correct text characters. </p>\n"},{"tags":["sql","sql-server","performance","sql-server-2008","query"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":35270,"score":7,"question_id":4193705,"title":"SQL Server SELECT LAST N Rows","body":"<p>This is a known question but the best solution I've found is something like:</p>\n\n<pre><code>SELECT TOP N *\nFROM MyTable\nORDER BY Id DESC\n</code></pre>\n\n<p>I've a table with lots of rows. It is not a posibility to use that query because it takes lot of time. So how can I do to select last N rows without using ORDER BY?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Sorry duplicated question of <a href=\"http://stackoverflow.com/questions/311054/how-do-i-select-last-5-rows-in-a-table-without-sorting\">this one</a></p>\n"},{"tags":["mysql","query","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13015489,"title":"Nested categories counting only one branch with products","body":"<pre><code>CREATE TABLE IF NOT EXISTS `site_location` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `level` int(11) NOT NULL,\n  `lft` int(11) NOT NULL,\n  `rgt` int(11) NOT NULL,\n  `name` varchar(50) NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=13 ;\n\n///DATA\n    INSERT INTO `site_location` (`id`, `level`, `lft`, `rgt`, `name`) VALUES\n    (1, 0, 1, 24, 'United Kingdom'),\n    (2, 1, 2, 19, 'London'),\n    (3, 2, 13, 14, 'Central London'),\n    (4, 2, 11, 12, 'East London'),\n    (5, 2, 9, 10, 'North London'),\n    (6, 2, 7, 8, 'North West London'),\n    (7, 2, 5, 6, 'South East London'),\n    (8, 2, 3, 4, 'West London'),\n    (9, 2, 15, 18, 'South West'),\n    (10, 3, 16, 17, 'Battersea'),\n    (11, 1, 20, 23, 'Brighton'),\n    (12, 2, 21, 22, 'Guildford');\n\nCREATE TABLE IF NOT EXISTS `ads` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `category_id` int(11) NOT NULL,\n  `location` int(11) NOT NULL,\n  `title` varchar(255) CHARACTER SET utf8 NOT NULL,\n  PRIMARY KEY (`id`,`category_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=5 ;\n\nINSERT INTO `ads` (`id`, `category_id`, `location`, `title`) VALUES\n(1, 7, 10, 'Test1'),\n(2, 9, 3, 'Test2'),\n(3, 12, 10, 'Test3'),\n(4, 13, 4, 'Test4');\n</code></pre>\n\n<p>when ID is ID=1 to return this way</p>\n\n<pre><code>[ United Kingdom(4) ]\n    London(4)     \n    Brighton(0)\n</code></pre>\n\n<p>and when ID is ID = 2</p>\n\n<pre><code>    United Kingdom(4)\n      [ London(4) ]\n        South West(2)\n        Central London(1)\n        East London(1)\n      Brighton(0)\n</code></pre>\n\n<p>so when is selected \"London\" I need all its siblings and all its children</p>\n\n<p>the same when is selected \"South West\" I need all its siblings all its children, its parent all its parent siblings</p>\n\n<pre><code>    United Kingdom(4)\n      London(4)\n        [ South West(2) ]\n          Battersea(2)\n        Central London(1)\n        East London(1)\n      Brighton(0)\n</code></pre>\n\n<p>and as well how many ads have in the location, for example in UK has to have 4 because all ads in the table are 4, south west has to have 2 because in Battersea has 2</p>\n\n<p>when id is 11</p>\n\n<pre><code>United Kingdom(4)\n  London(4)\n  [ Brighton(0) ]\n      Guildford(0)\n</code></pre>\n\n<p>I have a query:\n South West lft:15, rgt:18, level:2</p>\n\n<pre><code> SELECT \n    node.id, \n    node.alias, \n    node.level, \n    node.name, \n    COUNT(ads.id) as ads,\n    IF(node.lft = node.rgt-1, \"0\", \"1\") AS `has_children`\n FROM \n    site_location AS parent LEFT JOIN\n    ads as ads ON (parent.id = ads.location),\n    site_location AS node\n WHERE\n    parent.lft BETWEEN node.lft AND node.rgt\n AND \n    parent.lft BETWEEN 15 AND 18\n AND \n    node.level &gt; 0\n AND\n   node.level &lt; 2 + 3\n GROUP BY node.id\n ORDER BY node.lft\n</code></pre>\n\n<p>this will return </p>\n\n<pre><code> London(4)\n  South West(2)\n   Battersea(2)\n</code></pre>\n\n<p>I need to be in this way</p>\n\n<pre><code> London(4)\n  South West(2)\n   Battersea(2)\n Brighton(0) \n</code></pre>\n\n<p>Is it possible to do this with single query :?\nIf anyone can help, It will be great. Thanks in advance!</p>\n"},{"tags":["mysql","query","group-by","subquery","not-exists"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13171867,"title":"MySQL query GROUPing from one table, excluding results found in another sub query","body":"<p>Let's say I have two tables - ADDONS and DOWNLOADS.</p>\n\n<p>ADDONS dictates which apps come with which addons for FREE.<br>\nDOWNLOADS logs addon downloads from all apps, those that include for free and not.</p>\n\n<pre><code>ADDONS  \nappname  | varchar  \nappaddon | varchar\n\nDOWNLOADS  \nid       | int  \nappaddon | varchar  \nappname  | varchar  \nsource   | varchar  \ndate     | datetime  \n</code></pre>\n\n<p>I am trying to write a query that shows the count of each appaddon in DOWNLOADS where it was NOT included for free in ADDONS.</p>\n\n<p>I got as far as:  <code>\"SELECT appaddon, count(id) FROM downloads GROUP BY appaddon ORDER BY count(id) DESC\"</code> - but that is inclusive of apps that included it for free and those that do not.</p>\n\n<p>Can anyone point me in the right direction on this?</p>\n\n<hr>\n\n<p>Update:  </p>\n\n<p>Example:  Imagine I have two holiday themed apps - one for Christmas, one for Halloween, and each app allows you to download costumes that are included with the app (for example Halloween lets you download a witch, skeleton or jack o lantern, and Christmas lets you download a Santa or elf).  BUT if someone upgrades from within the app, they can download ANY of the available costumes (so Christmas upgraded could download a skeleton, or Halloween upgraded could download an Elf).</p>\n\n<p>I am trying to get a count of the downloads that are NOT included without upgrading.  So I want to exclude the witches downloaded by Halloween, and the Santas downloaded by Christmas, but get a count of the witches, skeletons, elves, etc downloaded by the OTHER apps. </p>\n\n<p>Here is some example data:  </p>\n\n<pre><code>ADDONS  \nappname     | appaddon  \n========================  \nhalloween   | jackolantern  \nhalloween   | skeleton  \nhalloween   | witch  \nchristmas   | santa  \nchristmas   | elf  \nchristmas   | reindeer  \neaster      | bunny  \nallholidays | bunny\n\nDOWNLOADS  \nid | appaddon  | appname   | date  \n=======================================\n1  | skeleton  | halloween | 2012-10-15  \n2  | skeleton  | halloween | 2012-10-15  \n3  | witch     | halloween | 2012-10-16  \n4  | santa     | christmas | 2012-10-16  \n5  | elf       | christmas | 2012-10-16  \n6  | witch     | christmas | 2012-10-16  \n7  | bunny     | christmas | 2012-10-16  \n8  | bunny     | halloween | 2012-10-17  \n9  | bunny     | easter    | 2012-10-18\n</code></pre>\n\n<p>Based on above, I would expect the results:</p>\n\n<pre><code>appaddon  | count\n=================\nbunny     | 2\nwitch     | 1\n</code></pre>\n"},{"tags":["android","query","sqlite","android-contentprovider"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13210044,"title":"exist() method sqlite with ContentProvider","body":"<p>i'd like to create a method for \"exist tuple?\"</p>\n\n<p>my old method with classic StartManagingCursor way was :</p>\n\n<pre><code>public boolean exist(long uid){\n     boolean ex = false;\n\n     Cursor c= db.rawQuery(\"SELECT COUNT(*) FROM \" + Person.PERSON_TABLE + \" WHERE uid = \"+ \"'\" + uid + \"'\", null);\n            c.moveToFirst();\n  int jcount = c.getInt(0);\n\n  if (jcount &gt;0){\n            ex=true;                        \n    }\n     return ex;\n</code></pre>\n\n<p>}</p>\n\n<p>now i wanna do this with ContentProvider for my sqlite db. \nhow i can do this with query method of my contentprovider class?</p>\n"},{"tags":["mysql","query","adapter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13209815,"title":"Update the date column in mysql","body":"<p>Im struggling in update the date format in mysql. Before that while retrieval from Mysql(using netbeans) of date using adapter the format was is like that</p>\n\n<p><strong>\"Birth_Date\": \"1990-10-11T00:00:00.000Z\",</strong></p>\n\n<p>Now i want to modify the column of Birthdate into  <strong>1990-10-11</strong></p>\n\n<p>i dont want rest of character .. guide me how to achieve this</p>\n"},{"tags":["php","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13209734,"title":"PHP error: Warning: ociparse() parameter 1 to be resource","body":"<p>As there is not ready made function in oracle to validate the Query so created.\nSo I tried below code to check whether the QUERY is valid or not.</p>\n\n<pre><code>if(isset($_POST['btn_Submit_Query']))\n            {\n                $check_query=$_POST['txtQuery'];\n                echo $check_query;\n                $valid = false;\n                $stmt = oci_parse($DB, $check_query);\n                echo \"Statement\" . $stmt;\n                //oci_define_by_name($stmt, 'NUMBER_OF_ROWS', $number_of_rows);\n                oci_execute($stmt, OCI_DEFAULT);\n                echo oci_num_rows($stmt);\n            }\n</code></pre>\n\n<p>I got following Warnings in the Execution:</p>\n\n<pre><code>Warning: oci_parse() expects parameter 1 to be resource, object given in D:\\xampp\\htdocs\\app\\DashBoardSite\\Admin\\querybuilder.php on line 899\nStatement\nWarning: oci_execute() expects parameter 1 to be resource, null given in D:\\xampp\\htdocs\\app\\DashBoardSite\\Admin\\querybuilder.php on line 902\n\nWarning: oci_num_rows() expects parameter 1 to be resource, null given in D:\\xampp\\htdocs\\app\\DashBoardSite\\Admin\\querybuilder.php on line 903\n</code></pre>\n\n<p>Kindly please tell me the PROBLEM where is my mistake.\nThanks and Regards in Advance</p>\n"},{"tags":["query","tsql","join","insert-update"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13195855,"title":"T-SQL Need assistance with complex join","body":"<p>I am really out of ideas of how to solve this issue and need some assistance - not only solution but idea of how to approach will be welcomed. </p>\n\n<p>I have the following table:</p>\n\n<pre><code>TABLE Data\n( \n     RecordID\n    ,DateAdd\n    ,Status\n)\n</code></pre>\n\n<p>with sample date like this:</p>\n\n<pre><code>11  2012-10-01 OK\n11  2012-10-04 NO\n11  2012-11-05 NO\n22  2012-10-01 OK\n33  2012-11-01 NO\n33  2012-11-15 OK\n</code></pre>\n\n<p>And this table with the following example data:</p>\n\n<pre><code>TABLE Periods\n(\n    PeriodID\n   ,PeriodName\n   ,DateStart\n   ,DateEnd\n)\n\n1 Octomer  2012-10-01 2012-10-31\n2 November 2012-11-01 2012-11-30\n</code></pre>\n\n<p>What I need to do, is to populate a new table:</p>\n\n<pre><code>TABLE DataPerPeriods\n(\n    PeriodID,\n    RecordID,\n    Status\n)\n</code></pre>\n\n<p>That will store all possible combinations of PeriodID and RecordID and the latest status for period if available. If status is not available for give period, then the status for previous periods. If there are no previous status at all - then NULL for status.</p>\n\n<p>For example with the following data I need something like this:</p>\n\n<pre><code>1 11 NO //We have status \"OK\" and \"NO\", but \"NO\" is latest for the period\n1 22 OK \n1 33 NULL//Because there are no records for this and previous periods\n2 11 NO //We get the previos status as there are no records in this periods\n2 22 OK //There are not records for this period, but record for last periods is available\n2 33 NO //We have status \"OK\" and \"NO\", but \"OK\" is latest for the period\n</code></pre>\n\n<p>EDIT: I have already populate the period ids and the records ids in the last table, I need more help on the status update.</p>\n"},{"tags":["python","django","query","orm","user"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13207416,"title":"Django : How to filter users with username__iexact by default?","body":"<p>Implementing username case-insensitive :</p>\n\n<p>I want to implicitly imply <code>iexact</code> when querying for <code>user</code> :</p>\n\n<pre><code>user = User.objects.get(username = 'yugal')  # Lowercase\nuser.id # 1\n\nuser = User.objects.get(username = 'YUgal')  # Mixcase\nuser.id # 1\n</code></pre>\n\n<p>How can I achieve this ? { somehow with <code>UserManager</code> }</p>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>Also, <code>django.shortcuts.get_object_or_404</code> seems to use it as <code>User.objects.get_query_set().all().get()</code>. How can we make it work ?</li>\n</ul>\n"},{"tags":["mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":60,"score":5,"question_id":13207838,"title":"Disk space implications of setting MySQL column value to NULL instead of 0 or ''","body":"<p>I'm trying to understand the best way to handle columns which are mostly empty in terms of <strong>disk-space</strong> and <strong>index-performance</strong>. Is there a difference between putting in all empty places NULL vs '' (for varchar / text) vs 0 (for int).</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","optimization","group-by","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":13201809,"title":"MySQL very slow query using left joins","body":"<p>I have this query that runs on a fairly large set of data.<br>\nIt is <em>extremely</em> slow... </p>\n\n<p>I need to optimize this query, and not sure where to start (aside from indexes).</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>SELECT d.distributor_id, \nd.first_name,\nd.last_name,\nd.sponsor_id,\nCOUNT(f.business_level) AS total_enrollments,\nSUM(CASE WHEN UPPER(f.business_level) = 'EXECUTIVE' THEN 1 else 0 end)\n    AS executive_enrollments,\nSUM(CASE WHEN UPPER(f.business_level) = 'PERSONAL' THEN 1 else 0 end)\n    AS personal_enrollments,\nSUM(CASE WHEN UPPER(f.business_level) = 'PREFERRED CUSTOMER' THEN 1 else 0 end)\n    AS preferred_customer_enrollments,\nIFNULL(cf.commission_paid, 0) AS commission_paid,\nIFNULL(cf.retention_earned, 0) AS retention_earned,\nCOUNT(df.order_type) AS total_autoships,\nIFNULL(a.consecutive_streak, 0) AS autoship_streak,\nIFNULL(a.enrollment_date, \"Not Enrolled\") AS autoship_enrollment,\nd.highest_rank\n    FROM warehouse.distributor d\n        LEFT JOIN warehouse.enrollment_detail_fact f ON d.distributor_id = f.distributor_id\n        LEFT JOIN warehouse.country c ON d.country = c.name\n             AND c.country_id = 185\n        LEFT JOIN warehouse.autoship a ON d.distributor_id = a.distributor_id\n        LEFT JOIN warehouse.order_detail_fact df ON d.distributor_id = df.distributor_id\n            AND UPPER(order_type) = 'AUTOSHIP'\n            AND date_id IN(SELECT date_id FROM warehouse.date\n                WHERE DATE BETWEEN '2012-10-10'\n                AND '2012-10-11' ORDER BY date DESC)\n        LEFT JOIN warehouse.commission_detail_fact cf ON d.distributor_id = df.distributor_id\n        LEFT JOIN db.commission_level_type_details cl ON d.highest_rank = cl.name\nWHERE d.active = 1               \n    AND cl.commission_level_type_detail_id IN (23)\nGROUP BY distributor_id\nORDER BY first_name; \n</code></pre>\n"},{"tags":["ruby-on-rails","query","activerecord","nested-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13207082,"title":"Rails Nested Query","body":"<p>I have follow query</p>\n\n<pre><code>  notes = Note.where('notes.id IN\n  (\n    SELECT \"notes\".\"id\" FROM \"notes\" \n      WHERE \"notes\".\"circle_id\" = ?\n  )\n  OR notes.id IN \n  (\n    SELECT \"notes\".\"id\" FROM \"notes\" \n      INNER JOIN \"circles_dreams\" \n      ON \"circles_dreams\".\"dream_id\" = \"notes\".\"dream_id\" \n      WHERE \"circles_dreams\".\"circle_id\" = ? \n  )', @circle.id, @circle.id)\n</code></pre>\n\n<p>How to simplify this query? \n Thanks.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13207618,"title":"MySQL JOIN query -","body":"<p>I know this question has already asked here, but I can't figure this one out from the previous answers.</p>\n\n<p>We've got 2 tables:</p>\n\n<pre><code>members\n-----------------------\n| id | country_iso_3 |\n-----------------------\n  1    USA\n  2    DZA\n  3    FRA\n  4    ILI\n  5    USA\n  6    USA\n\n\nmembers_details\n-----------------------\n| member_id | city    |\n-----------------------\n  1          AA\n  2          BB\n  3          CC\n  4          DD\n  5          EE\n  6          FF\n</code></pre>\n\n<p>Now I want to query members_details and select the cities which are from the same countries, here \"AA\", \"EE\" and \"FF\" should be the results (because the members are from USA)</p>\n\n<p>I know how to compare different cols from different tables, but here we need to check the second table 'member_id' and the first table 'id (country_iso_3)' somehow!</p>\n"},{"tags":["performance","query","google-app-engine","memcached","gae-datastore"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13205472,"title":"Most Efficient Way for Users to Search for all of a Database Model","body":"<p>I have two database models in my webapp and one has around 10,000 entries and the other has close to double that. I have it set up right now so that all of these entries are kept in memcache.  I also have it set up so that the user can search by certain constraints and I just filter the cache by those constraints with some if statements.  Part of this is so that I don't have to pay for the search quota with the Google Search API.</p>\n\n<p>I wanted to see if using memcache here is the best option or if I should simply do a DB query which will quickly run up my read quota or if there is any other good option.  One of my problems here is that as my database gets larger the searches are getting slower.</p>\n\n<p>Here is some example code where I am searching by location and then filtering by a sport category:</p>\n\n<pre><code>        #this is the cache I am using\n        groups = group_cache()\n        search_location = self.request.get(\"search_location\")\n        search_postsport = self.request.get(\"search_postsport\")\n        GPSlocation = None\n        error=None\n        groups_to_render = None\n\n        if search_location:\n            g = geocoders.Google()\n            searched_location = None\n            #to catch an error where there is no corresponding location\n            try:\n                #to catch an error where there are multiple returned locations\n                try:\n                    place, (lat, lng) = g.geocode(search_location)\n                    place, searched_location = g.geocode(search_location)\n                except ValueError:\n                    geocodespot = g.geocode(search_location, exactly_one=False)\n                    place, (lat, lng) = geocodespot[0]\n                    place, searched_location = geocodespot[0]\n                GPSlocation = \"(\"+str(lat)+\", \"+str(lng)+\")\"\n\n                groups = group_cache()\n                return_groups = []                   \n                for group in groups:\n                    distance.distance = distance.GreatCircleDistance\n                    location_distance = distance.distance(searched_location, point.Point(group.lat, group.lng)).miles\n\n                    if location_distance &lt; 300:\n                        return_groups.append(group)\n                groups = return_groups\n                search=True\n                groups_to_render = sorted(groups, key=attrgetter('recordCount'), reverse=True)\n                groups_to_render = groups_to_render[:10]\n</code></pre>\n"},{"tags":["html","query","google","parameters","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":11584551,"title":"Need information on query parameters for Google Books e.g. difference between &dq and &q, &f, &redir_esc, etc","body":"<p>In books with \"Snippet view\" available (where you can view snippets of text in a page) to link to highlighted text represented by <code>&lt;search_string&gt;</code>, I can any one of the following forms of the URL:</p>\n\n<pre><code>http://books.google.com/books?id=&lt;book_id&gt;&amp;q=&lt;search_string&gt;&amp;dq=&lt;search_string&gt;\nhttp://books.google.com/books?id=&lt;book_id&gt;&amp;q=&lt;search_string&gt;\nhttp://books.google.com/books?id=&lt;book_id&gt;&amp;dq=&lt;search_string&gt;\n</code></pre>\n\n<p>In books with \"Preview\" available (where you can view full pages) links to highlighted text add <code>&amp;pg=&lt;page_number&gt;</code> after <code>&amp;id=&lt;book_id&gt;</code> to a URL in one of the above forms. I've discovered that that such a URL always works when it has both <code>&amp;dq</code> and <code>&amp;q</code> but queries with only <code>&amp;dq</code> or only <code>&amp;q</code> don't work with some books.</p>\n\n<p>I've also noticed that <code>&amp;f=false</code> tends to be automatically appended to the query when you click on the link.</p>\n\n<p>What do these parameters <code>&amp;q</code>, <code>&amp;dq</code>, <code>&amp;f</code> and <code>&amp;redir_esc=y#v=onepage</code> mean? Where I can find this information and information on how to use query parameters in general for Google Books? I've searched but can't find anything with this specific information.</p>\n\n<p>Note: Different books use different page number formats. In my experience, <code>&lt;page number&gt;</code> in the URL for a book with \"Preview\" available can be one of the following forms:</p>\n\n<ul>\n<li><code>PAx</code> where x is the actual page number in the book.</li>\n<li><code>PTx</code> where x may not be actual page number in the printed book, which may not be shown on the page in the Google Books viewer.</li>\n<li><code>PRx</code> where x is the number of a page preceding the first chapter e.g. page iii in the book is linked to with <code>&amp;pg=PR3</code></li>\n<li><code>SLz-PAx</code> where the pages of the book are of the form <code>&lt;section&gt;&lt;page&gt;</code> with z as the index number of the section in the book and x the page number in that section e.g. page C17 is is linked to with <code>&amp;pg=SL3-PA17</code></li>\n</ul>\n"},{"tags":["query","query-optimization","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":11852025,"title":"Access 2010 Optimizing a bloated query","body":"<p>I have to have this query produce a monthly average availability for a selection of equipment. The query looks pretty ugly and rather bloated and I'm wondering if there's something I can do to make it better.  </p>\n\n<p>Right now I have an Expression column representing each month. In each month, take January for example, I need to check if the maintenance period occurred within the month, started before the month but ended during, started during the month but ended outside, completely encapsulates the month (if Jan 2012, then started maintenance Dec 2011 ended Feb 2012),  or not count it because it was fully operational throughout the month.  </p>\n\n<p>So as you can see checking these 4 cases and doing calculations afterwards really bloats up one month, let alone 12! So I'm just looking for a suggestion if there's something more I can be doing. I'm not afraid of some RnD if someone has articles they can point me towards. If this approach is not overly bad I don't mind, I would just like to do better if its possible.  </p>\n\n<p>Thanks in advanced!  </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13203117,"title":"mysql distinct query based off non unique columns","body":"<p>I have a weird (probably bad table design) query question thatI cannot think of an easy way to  solve.</p>\n\n<p>here is a table layout like what I have:</p>\n\n<pre><code>| id                 | int(11)     | NO   | PRI | NULL    | auto_increment | \n| num                | varchar(15) | YES  | MUL | NULL    |                | \n| type               | varchar(4)  | YES  |     | NULL    |                | \n</code></pre>\n\n<p>type is actually,  enum(\"val1\",\"val2\",\"blah\")</p>\n\n<p>num can have 3 entries in the table,  one with each of the 3 different type.</p>\n\n<p>The query I need is the count of distinct number of \"num's\" that have both an entry for \"val1\" and \"val2\".</p>\n\n<p>I do not think there is a simple query to handle this.. but the only solution I have come up with is to dump distinct entries of val1 to a memory table,  distinct entries of val2 to a memory table.</p>\n\n<p>Then determine which table has the least number of records.,  then write a subquery based off the smaller table looking for number matches in the larger table.</p>\n\n<p>the above sounds like a bad hack though...</p>\n\n<p>Am I missing something here...Do any of you see a better way to do this?</p>\n"},{"tags":["c#","database","query","asp.net-mvc-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13193514,"title":"connect with C# console application to internal DB of asp.net mvc 4 website","body":"<p>is there any chance to connect into default DB of asp.net mvc 4 application?</p>\n\n<p>I have one running website on server, and another C# console application, also on same server. And I'm trying to figure how to put some queries (insert/update) from that console app to database created in asp.net application. Of course website app is running.</p>\n\n<p>Any ideas?</p>\n\n<p>//edit</p>\n\n<p>I need this cause of creating web application for \"imports\" (it's bigger amount of data, about 300k records from Excel file). And I don't want push user to have opened website whole time while updating database (\"backside processing\"). If you have some another idea how to make it, I will be really happy to hear it</p>\n"},{"tags":["javascript","query","google-visualization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13201820,"title":"Using 2 queries in one dashboard google visualization","body":"<p>I am trying to put in 2 queries in one dashboard on Google Visualization. I'd like to create two tables: <code>transaction table</code> and <code>summary table</code> in one dashboard. However, as I have observed, <code>you can only pass one query</code>. In this case, <code>query.send(drawDashboard)</code>. Are there any tricks to pass 2 queries in a function?</p>\n\n<p><strong>Note:</strong> I have tried creating 2 queries inside <code>setQuery()</code> function, then created another function that would catch the query such as <code>drawTransaction()</code>. However, the page display does not allow it. </p>\n\n<p><strong>Query</strong></p>\n\n<pre><code>function setQuery() {\n    var query = new google.visualization.Query('&lt;spreadsheet here&gt;');\n    var queryString = 'select A,B,C';\n    //alert(queryString);\n    query.setQuery(queryString);\n    query.send(drawDashboard);\n}\n</code></pre>\n\n<p><strong>Draw Dashboard</strong></p>\n\n<pre><code>function drawDashboard(response) {\n    data = response.getDataTable();\n    var dateformatter = new google.visualization.DateFormat({\n        formatType: 'medium'\n    });\n    dateformatter.format(data,0);\n\n    var memberPicker = new google.visualization.ControlWrapper({\n        'controlType':'CategoryFilter',\n        'containerId':'memberPicker',\n        'options': {\n            'filterColumnLabel':'IssuedTo',\n            'ui': {\n                'label':'Member',\n                'labelStacking': 'vertical',\n                'allowTyping': false,\n                'allowMultiple': false                      \n            }\n        }\n    });\n    var table = new google.visualization.ChartWrapper({\n        'chartType':'Table',\n        'containerId':'dataTable',\n        'options': {\n            'width':920\n        }\n    });\n    new google.visualization.Dashboard(document.getElementById('dashboard')).\n    bind(memberPicker,table).\n    draw(data);\n}\n</code></pre>\n"},{"tags":["php","mysql","regex","query","strip"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13199470,"title":"Strip/delete all values from MySQL query using PHP regex?","body":"<p>How to strip/delete all values from MySQL queries using PHP Regex?</p>\n\n<p>Example:  </p>\n\n<p>original: <code>SELECT id, abc FROM mytable WHERE id IN (12, 15)</code><br>\nstriped: <code>SELECT id, abc FROM mytable WHERE id IN ()</code></p>\n\n<p>original:</p>\n\n<pre><code>SELECT ut.id, IF(stagiaire_devis.id IS NOT NULL, CONCAT(ut.prenom, ' (my lovely)', ut.prenom) AS value FROM quality AS uq, avocate, utility AS ut LEFT JOIN stagiaire_devis ON (stagiaire_devis.id_devis='1293049' AND stagiaire_devis.id_utilisateur=ut.id) WHERE uq.id_utilisateur = ut.id AND avocate.id_utilisateur = ut.id AND avocate.deleted = 0 AND avocate.id_avocat_liste_cabinet = 7 AND uq.id_liste_qualite IN (5,2,9) AND uq.actif = 2 ORDER BY ut.prenom\n</code></pre>\n\n<p>striped:</p>\n\n<pre><code>SELECT ut.id, IF(stagiaire_devis.id IS NOT NULL, CONCAT(ut.prenom, '', ut.prenom) AS value FROM quality AS uq, avocate, utility AS ut LEFT JOIN stagiaire_devis ON (stagiaire_devis.id_devis='' AND stagiaire_devis.id_utilisateur=ut.id) WHERE uq.id_utilisateur = ut.id AND avocate.id_utilisateur = ut.id AND avocate.deleted = AND avocate.id_avocat_liste_cabinet = AND uq.id_liste_qualite IN () AND uq.actif = ORDER BY ut.prenom\n</code></pre>\n\n<p>I cannot find right regex :(</p>\n"},{"tags":["query","scala","slick"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13097492,"title":"scala slick query return value","body":"<p>I am rather new at Scala and have been struggling with slick and can't see how to return the results of a query to the calling method</p>\n\n<p>I have a simple UserDto</p>\n\n<pre><code>case class UserDto(val firstName:String,\n  val lastName:String,\n  val userName:String,\n  val isAdmin:Boolean) {}\n</code></pre>\n\n<p>a User table object</p>\n\n<pre><code>object User extends Table[(String, String, String, Boolean)](\"USER\") {\n\n  def firstName = column[String](\"FIRST_NAME\")\n  def lastName = column[String](\"LAST_NAME\")\n  def userName = column[String](\"USER_NAME\")\n  def admin = column[Boolean](\"IS_ADMIN\")\n\n  def * = firstName ~ lastName ~ userName ~ admin\n\n}\n</code></pre>\n\n<p>and a query class</p>\n\n<pre><code>class UserQuerySlickImpl(dataSource:DataSource) {\n\n  def getResults(userName:String):Option[UserDto] = {\n    var resultDto:Option[UserDto] = None\n\n    Database.forDataSource(dataSource) withSession {\n      val q = for {u &lt;- User if u.userName is userName}\n      yield (u.firstName, u.lastName, u.userName, u.admin)\n\n      for (t &lt;- q) {\n        t match {\n          case (f:String, l:String, u:String, a:Boolean) =&gt; \n            resultDto = Some(new UserDto(f, l, u, a))\n        }\n      }\n    }\n    resultDto\n  }\n}\n</code></pre>\n\n<p>I can query the database and get the user that matches the username, but the only way I could figure out how to return that user is by creating a var outside of the <code>Database.forDataSource....{}</code>.</p>\n\n<p>Is there a better way that does not use the var but returns the <code>resultDto</code> directly.</p>\n\n<p>also is there a way to construct the <code>UserDto</code> directly from the first for comprehension rather than needing the second for (t &lt;- q) ...</p>\n\n<p>I am using  slick_2.10.0-M7, version 0.11.1.</p>\n"},{"tags":["query","rest","path","resteasy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13198043,"title":"RESTful webservices: query parameters","body":"<p>I am using JAX-RS with RESTEasy.</p>\n\n<p>I want to know if we can have represent different resources with path differentiated only  by order and number of query parameters?</p>\n\n<p>e.g.</p>\n\n<pre><code>/customer/1234\n/customer?id=1234\n/customer?name=James\n</code></pre>\n\n<p>Can I create three different methods e.g.</p>\n\n<pre><code>@Path(\"customer/{id}\")\npublic Response get(@PathParam(\"id\") final Long id) {\n..\n}\n\n@Path(\"customer?id={id}\")\npublic Response get(@QueryParam(\"id\") final Long id) {\n..\n}\n\n@Path(\"customer?name={name}\")\npublic Response get(@QueryParam(\"name\") final String name) {\n..\n}\n</code></pre>\n\n<p>Will this work, can I invoke different methods by differentiating path like this?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":13195515,"title":"How to set a NULL in the first and second record?","body":"<p>I have the following query:  </p>\n\n<pre><code>Declare @t Table(Id int identity,Groep int,[Date] Datetime,MondayMorning      \nInt,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int ,WednesdayMorning    \nInt,WednesdayEvening Int)\nInsert Into @t Select 2,'2012-01-01',2,0,2,2,2,2\nunion all\nSelect 2,'2012-01-02', 2,2,2,3,2,2\nunion all\nSelect 3,'2012-01-03', 2,2,2,2,2,2\n\n\nselect Id, Groep ,[Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nfrom @t t\nunion all\nselect Id, Groep, [Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nFrom @t tt\n\nWHERE tt.MondayMorning &lt;&gt; tt.MondayEvening\nAND (tt.MondayMorning != 0 and tt.MondayEvening != 0)\nOR tt.TuesdayMorning &lt;&gt; tt.TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\nOR tt.WednesdayMorning &lt;&gt; tt.WednesdayEvening\nAND (tt.WednesdayEvening != 0 and tt.WednesdayMorning != 0)\n</code></pre>\n\n<p>This query gives me a result that is actually correct. I just need to set in TuesdayEvening a Null value in the first record with Id=2. In the second record from that Id=2 set TuesdayMorning = null</p>\n\n<p>To see how this works just run the query.</p>\n\n<p>any ideas?</p>\n"},{"tags":["jquery","query","filter","portfolio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":8837512,"title":"Filtering portfolio in jQuery","body":"<p>I want to add a filtering option to my <a href=\"http://lionwebmedia.com\" rel=\"nofollow\">portfolio</a>. I found a tutorial on CSS-Tricks which I follow with a few modifications (mostly it was deleting unnecessary code).</p>\n\n<p>The goal I want to achieve is to filter portfolio projects so if I you click on \"UI\" portfolio will show only projects related to UI by sliding all projects up and than sliding down all UI projects (just like in tutorial I mention).</p>\n\n<p>So far everything works fine, you can scroll to desired project and at the bottom of it you will find a filter list, everything works, portfolio is sorting but the problem is with sliding up, because website is sliding to the very top of the page. It should look like this:</p>\n\n<p>If we are in the middle of portfolio (or in any position) and we want to sort it to show only UI projects website should scroll to the top of the project list (right under the black header).</p>\n\n<p>JS can be found <a href=\"http://jsfiddle.net/lionwebmedia/spESn/\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["php","mysql","query","insert"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13196931,"title":"Inserting title into database","body":"<p>I want to add \" write title\". This script does not have write title option and I would like to add it to script. It already has the add video option so I though that write title should be similar to add video option . That's why I tried to do something like this and I just can't get the script to insert title in the database, if you could help me with this one I would be very thankful. Here is the srcipt</p>\n\n<pre><code> &lt;?\n  session_start();\n  include(\"../func/db_info\".\".php\");\n  include(\"logincheck\".\".php\");\n  logincheck();\n\n  $surl = $_SERVER['HTTP_HOST'] ;\n\n  if (strip_tags($_POST['add'])){\n  $vidid=mysql_real_escape_string(strip_tags($_POST['vidid']));\n\n  $url = \"$vidid\";\n  parse_str( parse_url( $url, PHP_URL_QUERY ), $my_array_of_vars);\n  $t1=mysql_real_escape_string(strip_tags($_POST['tit1']));\n  $title=\"$t1\";\n  parse_str( $title, $my_vars );\n  mysql_query(\"INSERT INTO `videos` (`id`, `videoid`, `views`, `title`) VALUES ('',                         '\".$my_array_of_vars['v'].\"', '0', '\".$my_vars['v'].\"');\") or die (mysql_error());\n  $message=\"&lt;img src=\\\"../img/tick-icon.jpg\\\"&gt;\";\n  }\n  if (strip_tags($_POST['rem'])){\n  $vidid2=mysql_real_escape_string(strip_tags($_POST['vidid2']));\n\n  $url = \"$vidid2\";\n  parse_str( parse_url( $url, PHP_URL_QUERY ), $my_array_of_vars );\n\n  mysql_query(\"DELETE FROM videos WHERE id=\".$my_array_of_vars['v'].\"\");\n\n  $message2=\"&lt;img src=\\\"../img/tick-icon.jpg\\\"&gt;\";\n  }\n  ?&gt;\n\n  &lt;div align=\"center\"&gt;&lt;form id=\"form1\" method=\"post\" action=\"\"&gt;\n  Youtube URL: &lt;input type=\"text\" name=\"vidid\" id=\"vidid\"&gt;\n  Title: &lt;input type=\"text\" name=\"tit1\" id=\"tit1\"&gt;\n  &lt;input name='add' type='submit' id='add' value='Add Video' /&gt; &lt;? echo\"$message\";?&gt;                        \n\n  Website URL: &lt;input type=\"text\" name=\"vidid2\" id=\"vidid2\"&gt;\n  &lt;input name='rem' type='submit' id='rem' value='Remove Video' /&gt; &lt;? echo\"$message2\";?  \n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13168483,"title":"How to select more rows from subquery","body":"<p>When I'm trying to run this query:</p>\n\n<pre><code> select * FROM `activity` \n WHERE user_id = 1\n AND activity_id NOT LIKE (select activity_id from activity where user_id = 1 ORDER BY activity_id DESC LIMIT 8)\n</code></pre>\n\n<p>I get the follow error:</p>\n\n<pre><code> Subquery returns more than 1 row\n</code></pre>\n\n<p>How can I solve this problem? I want to select the activity_id from the table excluding the latest 8 activity_id's for a certain user.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":13182272,"title":"PHP and MySQL Runs twice but only echos once","body":"<p>I'm troubleshooting a problem on my site and I have narrowed it down to the php being run twice. I assume this means the page is loaded twice but the catch is that the code is only echoed or printed once. I figured this out using ChromePHP to log some text. That text prints in the console twice every now and again.</p>\n\n<p>The main issue is that I'm making a mysql query and setting a variable. In an example. It prints the ID number it gets as 2, but then the code randomly loads again and that variable is now set to something else... lets say 15 or whatever. But visually the echoed variable is still 2. </p>\n\n<pre><code>include 'php/classes/ChromePhp.php';\n$link = mysqli_connect($host, $dbuser, $dbpass, $dbname );\n\nif (mysqli_connect_errno()) {\n    printf(\"Connect failed: %s\\n\", mysqli_connect_error());\n    exit();\n}\n\nif ($result = mysqli_query($link,'SELECT questionID FROM questions order by rand() limit 1')) {\n    $row = mysqli_fetch_array($result);\n    printf(\"Question \", $row['questionID']);\n    mysqli_free_result($result);\n    ChromePhp::log('QUESTIONID '.$row['questionID']);\n}       \nif($link) \n    mysqli_close($link);\n?&gt;\n</code></pre>\n\n<p>I've looked around and people say it could be the favicon being loaded separately or the .htaccess redirect which I use. I took the .htaccess off and I still have this issue.</p>\n\n<p>Any pointers to a direction would be nice.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13192736,"title":"writing a Select query to deduct one table from another","body":"<p>I am just a little confuse to how write the below query :</p>\n\n<p>I have two tables</p>\n\n<pre><code>tbl_one\nID      TEXT\n1       test1\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tbl_two\nID      userID      tblone_ID\n1       50          1\n2       100         1\n3       100         2\n</code></pre>\n\n<p>I am looking to get rows of tbl_one which are not appear in tbl_two but for the certain user .</p>\n\n<p>for example by below select  :</p>\n\n<pre><code>select * from tbl_one, tbl_two \nwhere (tbl_two.tblone_ID !=tbl_one.ID and tbl_two.userID==50) \n</code></pre>\n\n<p>my desire resault will be </p>\n\n<pre><code>Desire resalt:\nID      TEXT\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","query","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13189390,"title":"Rails select and sort by aggregate of has_many","body":"<p>I have a Course model which has_many reviews. My Review model has a rating field. What I would like is a query to find the top rated courses. I want to do this in the SQL in order to avoid returning all the course objects and then trying to rank and sort them.</p>\n"},{"tags":["mysql","sql","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13195501,"title":"mySQL query using two tables","body":"<p>I have one table (config) with the field 'type' in and another table (users) with the field 'status' in.</p>\n\n<p>Some values for the field 'status' are blank.</p>\n\n<p>I want to change the field 'status' to 'applied' ONLY if the field 'type' in the other table equals '3'.</p>\n\n<p>Can you please explain how to do this query?</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13191768,"title":"How to make two records from one?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning, and so on\n1   2012-01-01          2               3   \n2   2012-01-01          2               2 \n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning\n1   2012-01-01          2               NULL          2\n1   2012-01-01          NULL            3             2\n2   2012-01-01          2               2 \n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["performance","query","postgresql","index"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13183735,"title":"Query performance in PostgreSQL using 'similar to'","body":"<p>I need to retrieve certain rows from a table depending on certain values in a specific column, named <strong>columnX</strong> in the example:</p>\n\n<pre><code>select *\nfrom tableName \nwhere columnX similar to ('%A%|%B%|%C%|%1%|%2%|%3%')\n</code></pre>\n\n<p>So if <strong>columnX</strong> contains at least one of the values specified (A, B, C, 1, 2, 3), I will keep the row.  </p>\n\n<p>I can't find a better approach than using <strong>similar to</strong>.  The problem is that the query takes too long for a table with more than a million rows.</p>\n\n<p>I've tried indexing it:</p>\n\n<pre><code>create index tableName_columnX_idx on tableName (columnX) \nwhere columnX similar to ('%A%|%B%|%C%|%1%|%2%|%3%')\n</code></pre>\n\n<p>However, if the condition is variable (the values could be other than A, B, C, 1, 2, 3), I would need a different index for each condition.</p>\n\n<p>Is there any better solution for this problem?</p>\n\n<p>EDIT: Thanks everybody for the feedback.  Looks like I've achieved to this point maybe because of a design mistake (topic I've posted in a <a href=\"http://stackoverflow.com/questions/13194906/data-structure-design-for-database-replication-support\">separated question</a>).</p>\n"},{"tags":["query","tfs","items"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13162705,"title":"How to run a work items query for/on previous state of closed item in TFS","body":"<p>I just want to run a query in TFS, to get a list of work items which are currently in closed state. where the condition is  &amp; . </p>\n\n<p>Eg: If item A is finished coding and been assigned to person X for review with 'In code Review' as state, and later the item A went through all the states and is closed.</p>\n\n<p>so , now can I run a TFS query to get the list of closed items like A which were reviewed by person X?</p>\n"},{"tags":["sql","mysql","query"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":8055,"score":3,"question_id":1783784,"title":"SQL Delete Rows Based on Another Table","body":"<p>This is probably very easy, but it's Monday morning.  I have two tables:</p>\n\n<p>Table1:</p>\n\n<pre><code>Field        | Type             | Null | Key | Default | Extra\nid           | int(32) unsigned | NO   | PRI | NULL    | auto_increment\ngroup        | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>Field     | Type             | Null | Key | Default | Extra\ngroup     | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Ignoring other fields...I would like a single SQL DELETE statement that will delete all rows in Table1 for which there exists a Table2.group equal to Table1.group. Thus, if a row of Table1 has group=69, that row should be deleted if and only if there exists a row in Table2 with group=69.</p>\n\n<p>Thank you for any help.</p>\n"},{"tags":["sql","sql-server","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13008116,"title":"routing network function issue","body":"<p>Following on from a <a href=\"http://stackoverflow.com/q/12990638/398670\">this question</a>, I have some dynamic SQL I'm running successfully in PL/PgSQL with <code>EXECUTE</code>, but it doesn't seem to have the intended effect.</p>\n\n<p>The following code is part of a plpgsql function that I have created. This intends to go to each point that is lying on the same track and for each point find its nearest point in order to eventually I will create a network between all the tracks. For some reson it is not working properly.</p>\n\n<p>The i represent the number of the current track.</p>\n\n<pre><code> DECLARE\n    _r record;\n    i int := 0;\n    source_geom character varying;\n    target_geom character varying;\n\nBEGIN\n\nWHILE i &lt; 3 --DEPENDS ON THE NUMBER OF TRACKS\nLOOP\n\nFOR _r IN EXECUTE ' SELECT a.'|| quote_ident(gid_cname) || ' AS id,'\n|| ' st_astext( a.'||quote_ident(geo_cname)||') AS source,' \n|| ' st_astext(b.'||quote_ident(geo_cname)||') AS target, ' \n|| ' ST_Distance(a.'||quote_ident(geo_cname) || ' ,  b.'||quote_ident(geo_cname)||') As dist_ft'\n|| ' FROM ' || quote_ident (geom_table) ||' AS a INNER JOIN ' || quote_ident(geom_table) || ' As b ON ST_DWithin(a.'||quote_ident(geo_cname)|| ', b.'||quote_ident(geo_cname)|| ',1000)'\n|| ' WHERE b.'||quote_ident(gid_cname)|| ' &gt; a.'||quote_ident(gid_cname)|| ' AND b.'||quote_ident(tid_cname)|| ' = '||i|| 'AND a.'||quote_ident(tid_cname)|| ' = '||i|| \n   ' ORDER BY dist_ft '\n|| ' Limit 1 '\n\nLOOP\n\nsource_geom := _r.source;\ntarget_geom := _r.target;\n\n\nEXECUTE 'update ' || quote_ident(geom_table) || \n    ' SET source = ''' || source_geom ||''' \n    , target = ''' || target_geom || ''' \n    WHERE ' || quote_ident(gid_cname) || ' =  ' || _r.id;\nEND LOOP;\n\ni = i + 1;\n\nEND LOOP;\n\nRETURN 'OK';\nEND;\n</code></pre>\n\n<p>The thing is that I have tested the query in plain sql and it worked brilliantly. Now for some reason in plpgsql it is not working properly. Below you can find the same query in plain sql. </p>\n\n<pre><code>SELECT a.ogc_fid AS id, st_astext( a.wkb_geometry) AS source, st_astext(b.wkb_geometry) AS target, ST_Distance(a.wkb_geometry, b.wkb_geometry) As dist_ft\nFROM track_points AS a INNER JOIN track_points As b\nON ST_DWithin(a.wkb_geometry , b.wkb_geometry, 1000)\nWHERE b.ogc_fid &gt; a.ogc_fid AND b.track_fid = 0 AND a.track_fid = 0 \norder by dist_ft\n</code></pre>\n"},{"tags":["java","mysql","query","hql","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13193062,"title":"Strange mysql retrieve with hibernate criteria","body":"<p>In a web-service i have the following function which retreives some infos of a doctor and his patient based on patient's phone:</p>\n\n<pre><code>    public String findDoctorOfPatient(String phone) {\n    AnnotationConfiguration config = new AnnotationConfiguration();\n    config.configure(\"hibernate.cfg.xml\");\n    SessionFactory factory = config.buildSessionFactory();\n    Session session = factory.openSession();\n\n    session.beginTransaction();\n\n    Criteria query = session.createCriteria(doctor.class);\n    query.createCriteria(\"patients\", \"p\");\n    query.add(Restrictions.eq(\"p.phone\", phone));\n    List&lt;doctor&gt; doctorList = (ArrayList&lt;doctor&gt;) query.list();\n    session.getTransaction().commit();\n    String answear = \"\";\n    for (doctor d : doctorList) {\n        answear = answear.concat(\"docPhone\" + d.getPhone() + \"docEmail\"\n                + d.getEmail() + \"patDia\"\n                + d.getPatients().iterator().next().getDiastolic()\n                + \"patSys\"\n                + d.getPatients().iterator().next().getSystolic());\n    }\n    if (doctorList.isEmpty()) {\n        session.close();\n        factory.close();\n        return \"No Doctor!\";\n    } else {\n        session.close();\n        factory.close();\n        return answear;\n    }\n}\n</code></pre>\n\n<p>The problem is when i have one patient is ok , but when i add second patient it gives me the details of last patient despite i have set to criteria tha firt's patient phone!</p>\n\n<p>I have 2 tables:</p>\n\n<p>1.doctor(id,username,password,phone,email)\n2.patient(id,name,surname,phone,systolic,diastolic,doctorid(FK refers to doctor.id))</p>\n\n<p>I have configured properly the hibernate.cfg.xml.</p>\n\n<p>And i have set the class for doctor and patient:</p>\n\n<pre><code>@Entity\npublic class doctor {\n    @Id\n    private int id;\n    private String username;\n    private String password;\n    private String phone;\n    private String email;\n\n    @OneToMany(targetEntity = patient.class, cascade = CascadeType.ALL, mappedBy = \"doctor\")\n    @Cascade(value = org.hibernate.annotations.CascadeType.ALL)\n    private Collection&lt;patient&gt; patients = new ArrayList&lt;patient&gt;();\n\n    public Collection&lt;patient&gt; getPatients() {\n        return patients;\n    }\n\n    public void setPatients(Collection&lt;patient&gt; patients) {\n        this.patients = patients;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getPhone() {\n        return phone;\n    }\n\n    public void setPhone(String phone) {\n        this.phone = phone;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>@Entity\npublic class patient {\n    @Id\n    private int id;\n    private String name;\n    private String surname;\n    private String phone;\n    private int systolic;\n    private int diastolic;\n\n    @ManyToOne\n    private doctor doctor;\n\n    public doctor getDoctor() {\n        return doctor;\n    }\n\n    public void setDoctor(doctor doctor) {\n        this.doctor = doctor;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getSurname() {\n        return surname;\n    }\n\n    public void setSurname(String surname) {\n        this.surname = surname;\n    }\n\n    public String getPhone() {\n        return phone;\n    }\n\n    public void setPhone(String phone) {\n        this.phone = phone;\n    }\n\n    public int getSystolic() {\n        return systolic;\n    }\n\n    public void setSystolic(int systolic) {\n        this.systolic = systolic;\n    }\n\n    public int getDiastolic() {\n        return diastolic;\n    }\n\n    public void setDiastolic(int diastolic) {\n        this.diastolic = diastolic;\n    }\n}\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/6YaGX.png\" alt=\"doctor\">\n<img src=\"http://i.stack.imgur.com/EH4Ii.png\" alt=\"patient\">\n<img src=\"http://i.stack.imgur.com/q19yD.png\" alt=\"patientRelationView![][3]\"></p>\n\n<p>In this web-service the response is always the same (given 6940861374 or 6981938435).\nIt gives me always the patSys=130 and patDia=80 which are the second's patient info!(dimitrios oikonomopoulos).Something must be wrong in the webservice but to me all seems ok!</p>\n"},{"tags":["mysql","sql","query","zend-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1056,"score":0,"question_id":6096147,"title":"zend framework insert() and LAST_INSERT_ID() screw up","body":"<p>so I tried to use Zend_Db_Adapter_Pdo_Mysql's insert() method....</p>\n\n<p>and then after that I issued the <code>SELECT LAST_INSERT_ID();</code> command....</p>\n\n<p>but then for some reason, that command always return 0 rather than the actual inserted ID...</p>\n\n<p>when I tried to use normal INSERT query, and then get the last insert id, it works just fine so I guess it's some zend framework screw up...</p>\n\n<p>does anybody know how to get around this? </p>\n\n<p>the insert() method only returns 1 if it succeeds rather than the id, so the solution for this: <a href=\"http://stackoverflow.com/questions/4842064/last-insert-id-with-zend-db-table-abstract\">last insert id with zend db table abstract</a>  doesn't seem to work </p>\n"}]}
{"total":20739,"page":4,"pagesize":100,"questions":[{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13192379,"title":"Convert unconventional string to mysql datetime in MySQL","body":"<p>I want to convert a field that represents a date-time but is currently a VARCHAR to a DATETIME field.\nCurrently the representation looks like: 'Sun May 20 01:04:39 +0000 2012'\nI want to do this operation in a query.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13192092,"title":"SQL Server : convert char to float and round it","body":"<p>I have a database with a column of <code>VARCHAR2</code> type keeping a value like: <code>398566,569885</code></p>\n\n<p>What I need is to cast this number to float and then to make it looking like: <code>398566,56</code>\nCasting it to float is <strong>not</strong> so important, if It's possible to trim the numbers it will be also ok.</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>select\ncast (p1.VALUE as float) as Total\nfrom Workflow p\nLEFT JOIN PA_PARAMETER p1 on p1.ID=p.ID AND p1.NAME = 'Total'\nWHERE p.TYPE = 'Marketing'\n</code></pre>\n\n<p>Is there a way to trim these numbers or to round it somehow?</p>\n"},{"tags":["query","gallery","cycle","numeric","pager"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13192189,"title":"Jquery Cycle plugin gallery counter use 0# of 0# images?","body":"<p>I'm using a counter on my website with the Jquery Cycle plugin. I would like to add 0's to the beginning of the numbers. Is there anyway to modify my code to achieve this?</p>\n\n<p>I'm not sure if I'm asking clearly but I want to go from this:</p>\n\n<p>&lt; 2 / 7 ></p>\n\n<p>to this:</p>\n\n<p>&lt; 02 / 07 ></p>\n\n<p>here is my code:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function(){ \n    $('#image').cycle({\n        fx:'fade', \n        speed:'300', \n        timeout: 0, \n        next:'.next',\n        prev:'.prev',\n        after: onAfter\n    });\n});\n\nfunction onAfter(curr,next,opts) {\n    var counter = (opts.currSlide + 1) + ' / ' + opts.slideCount;\n    $('.counter').html(counter);\n}\n&lt;/script&gt;\n</code></pre>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13191127,"title":"SQL Query for Count value from the latest date","body":"<p>I need to have a query that returns the ff:</p>\n\n<ol>\n<li>Count from the latest Date in each Name</li>\n<li>If the value of Count from the latest Date is -1 then it will return the count of the Date before the latest Date</li>\n<li>If the value of Count from the latest Date is -1 and the other Date is -1. Then return 0</li>\n<li>If the value of Count from the latest Date is -1 and no other Date of that Name. Then return 0</li>\n</ol>\n\n<p>Example Table:</p>\n\n<pre><code>ID  Name  Date         Count\n1   Adj   09/29/2012   2\n2   Adj   09/30/2012   4\n3   Ped   09/29/2012  -1\n4   Ped   09/30/2012   5\n5   Mel   09/29/2012   3\n6   Mel   09/30/2012  -1\n7   Rod   09/30/2012   7\n8   Ney   09/30/2012  -1\n9   Jin   09/29/2012  -1\n10  Jin   09/30/2012  -1\n</code></pre>\n\n<p>Desired Output:</p>\n\n<pre><code>Name   Count\nAdj    4\nPed    5\nMel    3\nRod    7\nNey    0\nJin    0\n</code></pre>\n\n<p>I am very confused on how to approach this in SQL since I only knew simple query.</p>\n\n<p>Any idea on how to make a query for this? Thanks.</p>\n\n<p>Btw, I'm sorry I forgot to include this. I am using SQL Server 2000.</p>\n"},{"tags":["sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13191522,"title":"SQL Server: rows to columns","body":"<p>sample datas</p>\n\n<pre><code> date     | num | name | value\n 01012012 |  1  |    A |  20\n 01012012 |  1  |    B |  30\n 01012012 |  2  |    C |  40\n</code></pre>\n\n<p>wish to  like this</p>\n\n<pre><code> date     | num |  A |  B |  C\n 01012012 |   1 | 20 | 30 | --\n 01012012 |   2 | -- | -- | 40\n</code></pre>\n\n<ul>\n<li>name is not fixed can allow many names</li>\n</ul>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13190731,"title":"Get the subtraction of two scores from two tables for several usres. Mysql","body":"<p>I need to access several tables, actually they are the same table but older versions, and get the max of subtracted score from both tables for each manager. </p>\n\n<p>let's say we tables r6 and r10 that have a field called scores. </p>\n\n<p>I need to get the scores from the two tables and subtract the new score (from latest table) form the old one (in an older table) to get the managers score for between period. </p>\n\n<p>let's say table r6 has score = 1 for manager A, and table r10 has score = 5 for manager A. So for manager A the yield score is 5-1 = 4. Which is basically (r10.scores - r6.scores) which will be totalScore. </p>\n\n<p>Now i need to get that totalScore (the score from 10-6) for all managers A-Z and also be able to find the highest one as well. </p>\n\n<p>The question is, how to achieve that in mysql, if not possible, what do u suggest? I am using php btw. </p>\n\n<p>Addition info: </p>\n\n<p>Table's Names:</p>\n\n<pre><code>1- ranking_gw6_260912 AS r6\n2- ranking_gw10_201012 AS r10 \n</code></pre>\n\n<p>Used Fields: </p>\n\n<pre><code>1- rx.manager_id\n2- rx.scores\n</code></pre>\n\n<p>These fields exist in both tables. </p>\n\n<p>n.b gw refers to game weeks of football matches, The website is for fantasy football and I am trying to get the winner of the contest who has the highest score from game week 6 to game week 10. Sadly, the database only stores the latest score overriding the on for the previous week. so I cannot get each week score and thus I am left with the overall score. Yet, we have a backup tables for each week that I will be using to get the between score. </p>\n"},{"tags":["sql","database","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":45,"score":-2,"question_id":13190155,"title":"join tables sql","body":"<p>I have the following tables \n<img src=\"http://i.stack.imgur.com/gJCad.png\" alt=\"enter image description here\">\nDishes table:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ex0ps.png\" alt=\"enter image description here\"></p>\n\n<p>Category table:\n<img src=\"http://i.stack.imgur.com/NWNAO.png\" alt=\"enter image description here\"></p>\n\n<p>t_time table:\n<img src=\"http://i.stack.imgur.com/gMPGU.png\" alt=\"enter image description here\"></p>\n\n<p>To get connect a dish with the ingredients I have the following code which works:</p>\n\n<pre><code>$sql = \"SELECT d.name, i.item\\n\"\n    . \"FROM dish d\\n\"\n    . \"JOIN dish_ingredients di ON ( d.id = di.dish_id )\\n\"\n    . \"JOIN ingredients i ON ( di.ingredient_id = i.id )\\n\"\n    . \"WHERE d.id =1\\n\"\n    . \"LIMIT 0 , 30\";\n</code></pre>\n\n<p>but now I want to connect the dish with the matching <code>categories</code>/<code>t_time</code> and <code>cuisine</code> . instead of having time= 6 and Category 3 being displayed when I do the query I want it to display 60 and fish instead. What would be the easiest way to do this?  a good tutorial might help as well. </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":12984497,"title":"Single Row Friendship Database Schema with getting userid from one column or the other","body":"<p>I need help querying the friendID from a table.\nMy table stores the user id of two members who are friends together.</p>\n\n<p>But in order to store a \"friendhship\" b/w two members I would have to store two records like this:</p>\n\n<pre><code>friendshipID |  userID  |  friendID  \n1            |  5       |  10\n2            |  10      |   5\n</code></pre>\n\n<p>Yet, that seems heavy for the DB when we really only need to store the first record as that is sufficient as it contains both ids of both members.</p>\n\n<p>However, the trouble comes when I want to query the records of the friends of ID=5.  Sometimes the ID is in the userID column and other times it is in the friendID column.</p>\n\n<p>This is the query I am using:</p>\n\n<pre><code>SELECT *\nFROM friends\nWHERE userID = '5'\n   OR friendID = '5'\n</code></pre>\n\n<p>But what I want to do is something like this</p>\n\n<pre><code>SELECT \nif $userID=5 then userID as myfriend\nelse friendID=5 then friendID as myfriend\nFROM friends WHERE userID='5' OR myfriendID='5'\n</code></pre>\n\n<p>Hope that makes sense.  In the end I would like to have all the friends ID's of member #5 and not bring up results with #5 as the friend or user....but just his friends.</p>\n"},{"tags":["asp.net","linq","web-services","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13177023,"title":"Selected value from dropdownlist has to be tablename from linq query","body":"<p>I have a problem with my linq query. I want a search field (textbox) with a dropdownlist next to it. When i set the dropdownlist on \"ProductID\" he has to search only in the table \"ProductID\", And when i put it on \"Productinformation\", he has to search in the table \"productinformation\", i hope somebody understand this?</p>\n\n<p>So what i want is the following query:</p>\n\n<pre><code>    var textboxvalue = TextBox1.Text;\n            var dropdownsearch = DropDownList1.SelectedValue;    \n\nvar Metadata = from m in db.Metadatas\n                               join mm in db.Multimedias\n                               on m.multimediaID equals mm.multimediaID\n                               where (m. {{{Here i want the dropdownsearch}}} .ToString().Contains(textboxvalue) ||\n                                      mm. {{{Here i want the dropdownsearch}}} .ToString().Contains(textboxvalue))\n\n\n                               select new\n                               {\n                                   mm.ProductID,\n                                   mm.filename,\n                                   mm.filetype,\n                                   mm.filesize\n                               };\n</code></pre>\n\n<p>So, how can i get the selected value from the dropdownlist, as a table in the query? Normally you would put m.ProductID into the query, but i want the Selected value in it, something like <code>m.(Dropdownlist1.Selectedvalue)</code>... or <code>m.dropdownsearch</code>..\nIs that possible? And how?</p>\n\n<p>Thanks :)</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13188603,"title":"can't specify target table for UPDATE in FROM clause","body":"<p>I am trying to execute the following query:</p>\n\n<pre><code>update table3 d set status = 'Complete'\nwhere d.id in \n(\n    select b.id from table1 a, table3 b, table2 c\n    where a.id = b.table1_id\n    and c.id = b.table2_id\n    and c.examId = 16637                 -- will be passed in by user\n    and a.id in (46,47,48,49)            -- will be passed in by user\n);\n</code></pre>\n\n<p>So, I'm trying to update multiple rows of <code>table3</code>. </p>\n\n<p><code>table3</code> is a join table between <code>table1</code> and <code>table2</code>. </p>\n"},{"tags":["query","sql-server-2008-r2","colon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13188471,"title":"SQL purpose of colon","body":"<p>My colleague wrote this SQL statement and I had a hard time understanding it. What exactly is the purpose of using colon in the where clause?</p>\n\n<pre><code>WHERE MGM_YYMM like :AS_YYMM\n</code></pre>\n\n<p>Full Query:</p>\n\n<pre><code>SELECT  A.MGM_YYMM,\n        A.MGM_DATE,\n        A.MGM_GB,\n        A.INDATE,\n        A.SUDATE,\n        A.EMPNUM,\nFROM  SE_MAGAM A(NOLOCK)\nWHERE MGM_YYMM like :AS_YYMM\nORDER BY MGM_YYMM DESC\n</code></pre>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":13163057,"title":"PostgreSQL - select only when specific multiple apperance in column","body":"<p>I'm using PostgreSQL.\nI have a table with 3 fields\nperson, recipe and ingredient</p>\n\n<pre><code>person = creator of the recipe\nrecipe = the recipe\ningredient = one of the ingredients in the recipe\n</code></pre>\n\n<p>I want to create a query which results in every person who whenever has added carrot to a recipe, the person must also have added salt to the same recipe.</p>\n\n<p>More than one person can have created the recipe, in which case the person who added the ingredient will be credited for adding the ingredient. Sometimes the ingredient is used more than once, even by the same person.</p>\n\n<p>If this the table:</p>\n\n<pre><code>person1, rec1, carrot\nperson1, rec1, salt\nperson1, rec1, salt\nperson1, rec2, salt\nperson1, rec2, pepper\nperson2, rec1, carrot\nperson2, rec1, salt\nperson2, rec2, carrot\nperson2, rec2, pepper\nperson3, rec1, sugar\nperson3, rec1, carrot\n</code></pre>\n\n<p>Then I want this result:\nperson1</p>\n\n<p>Because this person is the only one who whenever has added carrot also have added salt.</p>\n\n<p>\"Nothing but the carrot could affect the result. I only want persons who has added at least one carrot in one of their recipes, but I don't want persons who have not also added salt to all of the same recipes they've added carrot to. Sorry, but I just can't explain it any clearer than that.\"</p>\n"},{"tags":["php","mysql","forms","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13180011,"title":"PHP Variables disappearing","body":"<pre><code>    echo $t1, $t2, $t3, $t4, $uid;\n$querytotal = \"update customer_det set `t1` = $t1, `t2` = $t2, `t3` = $t3, `t4` = $t4 WHERE `id` = $uid \"; \necho $querytotal;\n</code></pre>\n\n<p>So I echo the variables, and I see them fine.  When I go to do the update statement and echo the statement afterwards, it drops all the variables.  I have no idea how that's even possible.  Mysql_error: ...for the right syntax to use near ' <code>t2</code> = , <code>t3</code> = , <code>t4</code> = WHERE <code>id</code> =' at line 1.  So it's skipping error on t1, but then kicks out at t2?  Is there something i'm missing here?</p>\n\n<p>Here's the echo'd query before it's ran <code>update customer_det set</code>t1<code>= '215',</code>t2<code>= '240',</code>t3<code>= '265',</code>t4<code>= '300' WHERE</code>id<code>= '273'</code></p>\n\n<p>and after <code>update customer_det set</code>t1<code>= '',</code>t2<code>= '',</code>t3<code>= '',</code>t4<code>= '' WHERE</code>id<code>= ''</code></p>\n"},{"tags":["mysql","sql","database","query","query-optimization"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13080770,"title":"mysql query optimization","body":"<p>I got tasked to help speed up this query and I think some of the indexes on these tables are not setup properly.  I also believe they're not all going to be used b/c a function is applied to the col that I have an index on. can anyone see how I can optimize these tables or query?   The <code>requests</code> table will be the largest table of the 3 and will have upwards of 200k+ records. <code>devices</code> currently is sitting ~500 records and <code>clients</code> will be smaller as well.</p>\n\n<p>Query:</p>\n\n<pre><code>explain extended SELECT MAX(Request.datetime) AS datetime, Device.id,\n       Device.client_id, Device.mac_address, Device.type, Device.manufacturer,\n       Device.model_number, Client.id, Client.email_address,\n       Request.device_id, Request.datetime, Request.ip_address\n  FROM livefi.devices AS Device\n  LEFT JOIN livefi.clients AS Client\n    ON (Client.id         = Device.client_id)\n INNER JOIN livefi.requests AS Request\n    ON (Request.device_id = Device.id)\n GROUP BY Request.device_id, Request.client_id\n\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n| id | select_type | table   | type   | possible_keys                                           | key           | key_len | ref                     | rows | filtered | Extra                           |\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n|  1 | SIMPLE      | Device  | ALL    | PRIMARY                                                 | NULL          | NULL    | NULL                    |  617 |   100.00 | Using temporary; Using filesort |\n|  1 | SIMPLE      | Client  | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | livefi.Device.client_id |    1 |   100.00 |                                 |\n|  1 | SIMPLE      | Request | ref    | idx_device_id,inx_requests_deviceId_datetime_ip_address | idx_device_id | 5       | livefi.Device.id        |  144 |   100.00 | Using where                     |\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n3 rows in set, 1 warning (0.04 sec)\n</code></pre>\n\n<p>Tables:</p>\n\n<pre><code>CREATE TABLE `clients` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `email_address` varchar(100) DEFAULT NULL,\n  `mac_address` varchar(17) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `email_address` (`email_address`),\n  KEY `idx_mac_address` (`mac_address`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\n\nCREATE TABLE `devices` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `client_id` int(10) unsigned DEFAULT NULL,\n  `mac_address` varchar(17) DEFAULT NULL,\n  `type` varchar(25) DEFAULT NULL,\n  `manufacturer` varchar(100) DEFAULT NULL,\n  `model_number` varchar(50) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `mac_address` (`mac_address`),\n  KEY `idx_mac_address` (`mac_address`),\n  KEY `fk_devices_clients1` (`client_id`),\n  CONSTRAINT `fk_devices_clients1` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=492 DEFAULT CHARSET=utf8\n\n\nCREATE TABLE `requests` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `client_id` int(10) unsigned DEFAULT NULL,\n  `device_id` int(10) unsigned DEFAULT NULL,\n  `domain_id` int(10) unsigned DEFAULT NULL,\n  `ip_address` varchar(15) DEFAULT NULL,\n  `datetime` datetime DEFAULT NULL,\n  `gmt_offset` time DEFAULT NULL,\n  `request_method` varchar(15) DEFAULT NULL,\n  `url` text,\n  `http_protocol` varchar(20) DEFAULT NULL,\n  `http_status_code` varchar(20) DEFAULT NULL,\n  `request_size` int(10) unsigned DEFAULT '0',\n  `referer` text,\n  `user_agent` text,\n  `squid_cache_response` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `idx_client_id` (`client_id`),\n  KEY `idx_datetime` (`datetime`),\n  KEY `idx_device_id` (`device_id`),\n  KEY `idx_domain_id` (`domain_id`),\n  KEY `idx_id` (`id`),\n  KEY `idx_request_size` (`request_size`),\n  KEY `inx_requests_deviceId_datetime_ip_address` (`device_id`,`datetime`,`ip_address`),\n  CONSTRAINT `fk_requests_clients` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_requests_devices1` FOREIGN KEY (`device_id`) REFERENCES `devices` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_requests_domains1` FOREIGN KEY (`domain_id`) REFERENCES `domains` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=200523 DEFAULT CHARSET=utf8\n</code></pre>\n"},{"tags":["sql","sql-server","query","datediff"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13185869,"title":"SQL query to get DateDiff of the last two records","body":"<p>I have a table called Event with eventNum as the primary key and date as a datetime2(7) in SQL Server 2008 R2.  I am trying to get the date of the last two rows in the table and get the difference in minutes. This is what I currently have:</p>\n\n<pre><code>Select DATEDIFF(MI, e.date,(Select e2.date from Event e2 where eventNum = (Select MAX(e2.eventNum))))\n    From Event e\n    Where eventNum = (Select MAX(e.eventNum)-1 from e)\n</code></pre>\n\n<p>and I get this error:</p>\n\n<blockquote>\n  <p>Invalid column name 'Select eventNum from Event Where eventNum =\n  Select MAX(eventNum) from Event'.</p>\n</blockquote>\n\n<p>I've changed this 100 times and can't get it to work. Any help? </p>\n"},{"tags":["sql","query","postgresql","distinct","aggregate-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13183817,"title":"Distinctly sum a column on a joined table?","body":"<p>This is a simple problem, and I'm not sure if its possible here. Here's the problem:</p>\n\n<p>=> <a href=\"http://sqlfiddle.com/#!12/584f1/7\" rel=\"nofollow\">http://sqlfiddle.com/#!12/584f1/7</a></p>\n\n<p>Explanation:</p>\n\n<ul>\n<li>A ticket belongs to an attendee</li>\n<li>An attendee has a revenue</li>\n<li>I need to group the tickets by section and get the total revenue.</li>\n<li>This double counts attendees because 2 tickets can belong to the same attendee, thus double counting it. I'd like to grab the sum of the revenue, but only count the attendees once.</li>\n</ul>\n\n<p>In my sqlfiddle example, I'd like to see:</p>\n\n<pre><code>section | total_revenue\n------------------------\nA       | 40            &lt;= 40 is correct, but I'm getting 50...\nB       | null\nC       | 40\n</code></pre>\n\n<p><em><strong>I'd like to solve this without the use of sub queries. I need a scalable solution that will allow me to do this for multiple columns on different joins in a single query. So whatever allows me to accomplish this, I'm open to suggestions.</em></strong></p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["php","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":215,"score":1,"question_id":586031,"title":"mssql_query accent","body":"<p>I hava  a problem with this mssql_query in PHP :</p>\n\n<pre><code>$query = 'SELECT Ville FROM tblLstManufacturiers where province = \"Québec\"';\n</code></pre>\n\n<p>The result is empty because I have an accent in Québec</p>\n\n<p>How can I do this?</p>\n"},{"tags":["mysql","sql","query","postgresql","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13184804,"title":"Setting defaults for empty fields returned in select","body":"<p>Given two tables:</p>\n\n<pre><code>image(id, cat_id, name)\nimage_translation(id, title, desc, lang)\n</code></pre>\n\n<p>(names and ids are unique)</p>\n\n<p>Query to select all translations for the particular file:</p>\n\n<pre><code>SELECT c.id           AS c__id, \n       c.cat_id       AS c__cat_id, \n       c.name         AS c__name, \n       c2.id          AS c2__id, \n       c2.title       AS c2__title, \n       c2.desc        AS c2__desc, \n       c2.lang        AS c2__lang, \nFROM   image c \n       LEFT JOIN image_translation c2 \n              ON c.id = c2.id \nWHERE  ( c1.name = 'file.jpg' ) \n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>c__id | c__cat_id  | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n------+------------+-----------+-----------+---------------+--------------+--------- \n114   | 2          | 114       | file.jpg  | default title | default desc | en\n114   | 2          | 114       | file.jpg  | NULL          | desc in de   | de\n114   | 2          | 114       | file.jpg  | title in fr   | ''           | fr\n</code></pre>\n\n<p>To select the translation for the particular file in particular language,\nobviously I need to add the where clause.</p>\n\n<p>But then it returns the default row content, which may contain empty fields in translation.</p>\n\n<p><strong>How can I merge the result with the default values and overwrite the empy fields with the default ones?</strong> The default values are returned for lang <em>en</em>:</p>\n\n<pre><code>SELECT c2.title       AS c2__title, \n       c2.desc        AS c2__desc, \n       c2.lang        AS c2__lang, \nFROM   image c \n       LEFT JOIN image_translation c2 \n              ON c.id = c2.id \nWHERE  ( c1.name = 'file.jpg' ) \nAND WHERE ( c2.lang = 'en')\n</code></pre>\n\n<p>Sample results I expect:</p>\n\n<p>for german language:</p>\n\n<pre><code>-- AND WHERE ( c2.lang = 'de' ) \n\nc__id | c__cat_id | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n-----+------------+-----------+-----------+---------------+--------------+--------- \n114  | 2          | 114       | file.jpg  | default title | desc in de   | de\n</code></pre>\n\n<p>for french language:</p>\n\n<pre><code>-- AND WHERE ( c2.lang = 'fr' ) \n\nc__id | c__cat_id | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n-----+------------+-----------+-----------+---------------+--------------+--------- \n114  | 2          | 114       | file.jpg  | title in fr   | default desc | fr\n</code></pre>\n\n<p><strong>How to do it right in one smart query?</strong></p>\n\n<p>(I use MySQL and Doctrine ORM with I18N behavior)</p>\n"},{"tags":["mysql","database","query","join","inner-join"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13184949,"title":"Join columns from multiple tables","body":"<p>Below is part of a database that I need help with.</p>\n\n<pre><code>DROP DATABASE IF EXISTS bookex;\nCREATE DATABASE bookex;\nuse Bookex;\n\n\nCREATE TABLE Reviewer(\n   ReviewerID INT,\n   Name VARCHAR(20) NOT NULL,\n   EmployedBy CHAR(30),\n   constraint reviewer_reviewerID_pk PRIMARY KEY (reviewerID)\n);\n\nCREATE TABLE Book(\n   ISBN        CHAR(13),\n   Title       VARCHAR(70) NOT NULL,\n   Description VARCHAR(100),\n   Category    INT,\n   Edition     CHAR(30),\n   PublisherID INT         NOT NULL,\n   constraint book_ISBN_pk PRIMARY KEY (ISBN)\n);\n\nCREATE TABLE BookReview(\n   ISBN CHAR(13) NOT NULL,\n   ReviewerID INT NOT NULL,\n   Rating INT,\n   Comments VARCHAR(255),\n   constraint bookreview_pk PRIMARY KEY (ISBN, ReviewerID),\n   constraint bookreview_ISBN_fk FOREIGN KEY (ISBN) REFERENCES Book(ISBN),\n   constraint bookreview_reviewerID_fk FOREIGN KEY (ReviewerID) REFERENCES Reviewer(ReviewerID)\n);\n\n\n--\n-- Dumping data for table 'reviewer'\n--\n\nINSERT INTO reviewer VALUES (1,'Jacobs','Gadget Boy');\nINSERT INTO reviewer VALUES (2,'Troell','Dallas Underground');\nINSERT INTO reviewer VALUES (3,'Bills','The RIT Reporter');\nINSERT INTO reviewer VALUES (4,'Hill','Microsoft News');\nINSERT INTO reviewer VALUES (5,'Kurtz','MacIntosh News');\nINSERT INTO reviewer VALUES (6,'Leone',null);\nINSERT INTO reviewer VALUES (7,'Doubleday','Media Mania');\nINSERT INTO reviewer VALUES (8,'Wells','The RIT Reporter');\nINSERT INTO reviewer VALUES (9,'Worthington','The Annex');\nINSERT INTO reviewer VALUES (10,'Lawson','The Last Word');\nINSERT INTO reviewer VALUES (11,'Lasky',null);\nINSERT INTO reviewer VALUES (12,'Rozanski',null);\nINSERT INTO reviewer VALUES (13,'Whittington','JAVA Rocks');\nINSERT INTO reviewer VALUES (14,'Holden',null);\nINSERT INTO reviewer VALUES (15,'Stratton','Harvard Lampoon');\nINSERT INTO reviewer VALUES (16,'Johnson','NRA Weekly');\nINSERT INTO reviewer VALUES (17,'Mason','BMW Owners Quarterly');\nINSERT INTO reviewer VALUES (18,'Goodman','MacIntosh News');\nINSERT INTO reviewer VALUES (19,'Phelps','Detroit News');\nINSERT INTO reviewer VALUES (20,'Yacci','The Learning Channel');\nINSERT INTO reviewer VALUES (24,'Weeden','Scrye');\nINSERT INTO reviewer VALUES (25,'McVea','Programming Central');\nINSERT INTO reviewer VALUES (26,'Perez-Hardy','The Network Voice');\nINSERT INTO reviewer VALUES (27,'Heartthrob','Journal of Romance');\nINSERT INTO reviewer VALUES (28,'Bierre','JAVA Rocks');\nINSERT INTO reviewer VALUES (29,'Axelrod','JAVA Rocks');\n\n\n-- Dumping data for table 'book'\n--\n\nINSERT INTO book VALUES ('1-111-11111-4','Women are From Venus ORACLE is from Beyond Pluto','New York Times Best Seller 27 weeks',1,'4',1);\nINSERT INTO book VALUES ('1-222-32443-7','Calculus for Phys Ed Majors','Carry our 200 lb text book: learn integrals and keep in Shape',7,'3',7);\nINSERT INTO book VALUES ('1-295-84547-1','My Love\\'s Last Longing','Volume 1 of 4',1,'1',4);\nINSERT INTO book VALUES ('1-533-73363-8','From the Shores of Lake Erie to IT','One man\\'s Journey to IT',8,'2',1);\nINSERT INTO book VALUES ('1-559-68777-1','My Love\\'s Last Lingering Lost','Volume 2 of 4',1,'1',4);\nINSERT INTO book VALUES ('1-932-87447-6','The Science of Literature Searching','A Book Worth a Look is Worth a Good Look Up',6,'1',5);\nINSERT INTO book VALUES ('2-089-77869-5','Yes! Networking is for Bills Fans','How to Use a Spanning Tree to Exit Rich Stadium',9,'1',8);\nINSERT INTO book VALUES ('2-122-29058-5','How to Keep your Cellular Bill Down','How to carry 500 Miles of Fiber in Your Wallet',5,'2',2);\nINSERT INTO book VALUES ('2-221-11341-5','Tired of wired? Infrared instead!','500 Ways to pull out your hair while pulling out all your cable',5,'1',2);\nINSERT INTO book VALUES ('3-444-95595-4','ER, SOM, NF, DK/NF, SQL, JDBC, ODBC, and RELVAR','How U can avoid being trapped in Database acronyms',4,'1',3);\nINSERT INTO book VALUES ('3-445-43341-2','Master Wireless Through The Classic Comics','Infrared man triumphs over Cable Guy and CoAx NastyMan',2,'1',6);\nINSERT INTO book VALUES ('3-445-58668-5','How to Keep your Cable Bill Down','How to Avoid Tripping on 500 Miles of Fiber in your wallet',5,'1',10);\nINSERT INTO book VALUES ('4-344-22221-1','I Lasted my Love\\'s Last Lingering Longing','Volume 3 of 4',1,'2',4);\nINSERT INTO book VALUES ('4-668-39283-8','From Deep in the Heart of Texas to IT','One man\\'s Journey to IT',8,'1',1);\nINSERT INTO book VALUES ('5-538-55746-1','My Lost Love\\'s Long Last Lingering','Volume 4 of 4',1,'1',4);\nINSERT INTO book VALUES ('6-449-68668-8','From Brockport to IT','Prof. Johnson\\'s Journey to IT (about 25 min via 490)',8,'1',1);\nINSERT INTO book VALUES ('7-999-14432-2','Master HTML Through The Classic Comics','Using his Super Web thrower, Spiderman creates HTML docs',2,'2',6);\nINSERT INTO book VALUES ('8-330-69586-6','The Shortest Book in the World','A Guide to how Detroit will win the World Series in 2001',9,'1',3);\nINSERT INTO book VALUES ('9-333-44441-1','My Love\\'s at Long Last Lost his Lingering','Volume 5 of 4',1,'1',4);\nINSERT INTO book VALUES ('9-337-55467-3','How to add Class to your Programming','How to write programs in VB instead of C',3,'3',10);\nINSERT INTO book VALUES ('9-400-55555-2','Master C++ Through The Classic Comics','GeekMan triumphs over C++ program infected with Kryptonite virus',2,'1',6);\nINSERT INTO book VALUES ('9-444-43356-3','A language without Pointers? Priceless.','For Everything Else, there\\'s C++',3,'1',13);\nINSERT INTO book VALUES ('9-455-61223-3','JAVA: It\\'s more than Just a Programming Language','Achieve enlightenment through the mystery of the Swing package',3,'1',7);\n\n\nINSERT INTO bookreview VALUES ('1-111-11111-4',19,10,'Hold on to your hats, gang! If you think a cookbook or the yellow pages is exciting reading, you gotta read Professor Spadas remarkable treatise on enriching you personal relationships through your knowledge of ORACLE 8.1.6. In an easy-to-read fashion, s');\nINSERT INTO bookreview VALUES ('1-295-84547-1',27,10,'This is one of the most outstanding books ever written. Five thumbs up. Five stars. A must-read for everyone.');\nINSERT INTO bookreview VALUES ('1-533-73363-8',20,4,'A rather boring autobiography of a northern Ohio native who migrates to Rochester New York where he becomes a professor of Information Technology at RIT. Other than the chapters devoted to the Cleveland Indians (chapters 1, 2, 3, 6, 10, 11, 12, 13), The C');\nINSERT INTO bookreview VALUES ('1-559-68777-1',2,8,'A wonderful romance novel about Matt, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find himself.  Matt meets Margaret, a person with cowgirl charm in touch with her masculine self. Matt falls in lov');\nINSERT INTO bookreview VALUES ('1-559-68777-1',19,9,'A wonderful romance novel about Margaret, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find herself.  Margaret meets Matt, a person with tough cowboy swagger in touch with his feminine self. Margare');\nINSERT INTO bookreview VALUES ('2-089-77869-5',5,5,'Definitely dont buy this book if you are a Giants fan.  Two Giants fans tried this technique at the Giants game several weeks ago and they arent back yet.');\nINSERT INTO bookreview VALUES ('2-089-77869-5',13,8,'For any networking buff/Bills fan, Dr. Lutz treatise on the use of spanning trees to exit a Buffalo Bills game is a must. It is difficult to slog through in spots, but he shows you that by applying his minimalization technique you can get back to Rochest');\nINSERT INTO bookreview VALUES ('2-089-77869-5',15,6,'Dont buy this book unless your are  Bills fan.  Fans of any other team will find their departure time from a Bills game actually triples when the technique is applied. In fact, it probably accounts for why Dr. Lutz (and any other Bills fan who applies it');\nINSERT INTO bookreview VALUES ('2-122-29058-5',6,7,'Professor Hartpence shows you how to carry 500 miles of fiber in your wallet.  Warning to the unwary: dont buy this book unless you have deep pockets.');\nINSERT INTO bookreview VALUES ('2-122-29058-5',13,8,'Watch out Jim Carey .. this non-cable guy may leave you out of work. In his book, Professor Hartpence combines his cellular and networking skills with his experience in both the military and the commercial world and the practice of Zen to show you how to');\nINSERT INTO bookreview VALUES ('3-444-95595-4',3,4,'U lose if you ever bother to read this book.');\nINSERT INTO bookreview VALUES ('3-445-58668-5',6,7,'This book is a follow-up to Professor Hartpences book on how to carry 500 miles of fiber in your wallet.');\nINSERT INTO bookreview VALUES ('4-344-22221-1',24,7,'A wonderful romance novel about Nelson, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find himself.  Nelson meets Laura, a person with cowgirl charm in touch with her masculine self. Nelson falls in');\nINSERT INTO bookreview VALUES ('4-668-39283-8',6,6,'A sometimes boring autobiography of a Texan transplanted to Rochester New York where he becomes a professor of Information Technology at RIT. Other than the chapters devoted to the Dallas Cowboys (chapters 1, 2, 3, 6, 10, 11, 12, 13), The Presidential ele');\nINSERT INTO bookreview VALUES ('5-538-55746-1',15,9,'A wonderful romance novel about Laura, a successful editor for the New York Times, who resigns and retreats to a Dude Ranch in New Mexico to find herself.  Laura meets Nelson, a person with tough cowboy swagger in touch with his feminine self. Laura falls');\nINSERT INTO bookreview VALUES ('6-449-68668-8',20,7,'The funny, often racy, autobiography of Daryl Johnson and his escapades to and from RIT. The book is largely about the excitement of commuting from the west side to RIT every day and how much fun it can be. A great book for those who live on the west side');\nINSERT INTO bookreview VALUES ('6-449-68668-8',26,10,'An absolutely outstanding autobiography of a Saint John Fisher Graduate and how he has adapted to his 20 minute ride (mostly on 490) to RIT every morning and his 20 ride (mostly on 490) home from RIT every night. The author uses thirteen chapters to vibra');\nINSERT INTO bookreview VALUES ('8-330-69586-6',5,10,'Geez .. no pages, no paragraphs, no words .. not even an illustration. But he did dedicate the book to Tony Clark. Says something for the fervor of this Detroit Tigers fan.');\nINSERT INTO bookreview VALUES ('8-330-69586-6',15,10,'Very accurate analysis of a problem that is not NP complete.');\nINSERT INTO bookreview VALUES ('9-333-44441-1',24,7,'Throwing the usual themes and twists of a romance novel to the winds, the author tells the store of Laura, a successful Dude Ranch owner in New Mexico, who resigns and moves to New York to seek her fortune as an editor for the New York Times. Laura meets');\nINSERT INTO bookreview VALUES ('9-337-55467-3',25,9,'These authors know their way around a coding pad, let me tell you! In clear, bell-shaped tones, with succinct wording and pinpoint accuracy, they nail this subject matter to the wall. Do you like inheritance? How about information hiding? Maybe you like e');\nINSERT INTO bookreview VALUES ('9-455-61223-3',13,9,'Professor Sonstein shows how oneness with the spiritual universe can be achieved by bringing the soul into rhytmn with the JAVA runtime machine. He shows that through various forms of self denial, such as writing code without pointers and heavy weight com');\n</code></pre>\n\n<p>I need help displaying the NAME of the the reviewer, the TITLE of the book and the RATING the reviewer gave the book. <strong>But only of reviewers whos EmployedBy field is empty.</strong></p>\n\n<p>This is what it should look like:</p>\n\n<pre><code> name  | title                                 | rating \n Leone | How to Keep your Cellular Bill Down   |      7 \n Leone | How to Keep your Cable Bill Down      |      7 \n Leone | From Deep in the Heart of Texas to IT |      6 \n</code></pre>\n\n<p>Do I need to use an Inner Join, a Union, or just a multiple SELECT?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13184325,"title":"Reference 2 rows on same column/table, from a different table","body":"<p>I'm working on a stat tracking webpage for a virtual hockey league on Xbox. I have my basic table layout setup, but I am struggling with how to create the query that will allow me to show the schedule. Below is my basic table layout, and what I'd like to do is have it display something like:</p>\n\n<p>Game 1:<br>\n New York vs Chicago<br>\n Detroit vs Boston</p>\n\n<p>Game 2:<br>\n Boston vs New York<br>\n Chicago vs Detroit</p>\n\n<pre><code>SELECT homeTeam.name AS HOME_TEAMNAME\nFROM GameSchedule Sched\n\nINNER JOIN GameStats GameStatsHome\nON Sched.ID = GameStatsHome.gameSchedule_ID\nAND Sched.homeTeam_ID = GameStatsHome.team_ID\n\nINNER JOIN Team homeTeam\nON homeTeam.ID = gameStatsHome.team_ID\n</code></pre>\n\n<p>I realize where I'm running into the problem is trying to pull the Team.name for both GameSchedule.awayTeam_ID and GameSchedule.homeTeam_ID. But I haven't been able to figure out how to do this. I feel like I'm close..but then again, I have no idea what I'm doing, and have spent about 3 days trying to figure this one query out. I think if someone can point me in the right direction, I should be good for the rest of what I need... Any help would be greatly appreciated.</p>\n\n<pre><code>Table: Team\n-----------------------------------------------------------\n| ID | name       | abbreviation | conference | division |\n-----------------------------------------------------------\n|  1  | New York  |      TMA     |      1     |     1    |\n|  2  | Chicago   |      TMB     |      1     |     1    |\n|  3  | Detroit   |      TMC     |      1     |     1    |\n|  4  | Boston    |      TMD     |      1     |     1    |\n-----------------------------------------------------------\n\nTable: GameSchedule\n------------------------------------------------\n| ID | awayTeam_ID | homeTeam_ID | gameTime_ID |\n------------------------------------------------\n| 1  |     1       |      2      |      1      |\n| 2  |     3       |      4      |      1      |\n| 3  |     4       |      1      |      2      |\n| 4  |     2       |      3      |      2      |\n------------------------------------------------\n\nTable: GameStats\n------------------------------------------\n| ID | gameSchedule_ID | team_ID | goals |\n------------------------------------------\n| 1  |        1        |    1    |   5   |\n| 2  |        1        |    2    |   3   |\n| 3  |        2        |    3    |   6   |\n| 4  |        2        |    4    |   1   |\n| 5  |        3        |    1    |   2   |\n| 6  |        3        |    4    |   5   |\n------------------------------------------\n</code></pre>\n"},{"tags":["mysql","query","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13170790,"title":"How can I update all fields in row matching `x` to `y` without looping through each individually?","body":"<p>I'm curious if I can update all matching fields in a row with a new value at once in MySQL.</p>\n\n<p>I know I can use <code>ALTER TABLE</code> to change default values, but I'm interested only in one row, not in changing the default values of an entire table.  I can iterate through each in a loop if necessary, but I'm curious if there is a way to accomplish this more elegantly.</p>\n\n<p>Imagine my row looks like this:</p>\n\n<pre><code>| 1 | Joe | Smith | null | X | X | X | Y | X | Y | Y | X | null | Y | X | null |\n</code></pre>\n\n<p>Is it possible to update all fields matching <code>X</code> to <code>Y</code> at once?</p>\n\n<p>So the result would look like this:</p>\n\n<pre><code>| 1 | Joe | Smith | null | Y | Y | Y | Y | Y | Y | Y | Y | null | Y | Y | null |\n</code></pre>\n\n<p>(assume <code>1</code> is a primary key, id... if that helps at all)</p>\n\n<p>Can this be done with only one <code>UPDATE</code> query?</p>\n"},{"tags":["mysql","query","distinct"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13183586,"title":"SQL query distinct with additional select","body":"<p>I need to perform a query in MySQL that returns distinct values for product_id but also I need to select and return 'id' field which is in that particular table.</p>\n\n<p>This query will return distinct product_id's without id:</p>\n\n<pre><code>SELECT DISTINCT product_id FROM orders_cart\n</code></pre>\n\n<p>This query will use distinct on both fields which and I want to use it on product_id and see the id</p>\n\n<pre><code>SELECT DISTINCT id, product_id FROM orders_cart\n</code></pre>\n\n<p>It would be quite easy to do on pgsql but I have no idea how to do this on mysql.</p>\n"},{"tags":["sql","query","oracle11g","entity-attribute-value"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13025135,"title":"How can I write a select query from a table which has columns like product,attribute,value?","body":"<p>I have tables like these</p>\n\n<pre><code> - Products: PID,ProductName...\n - Attributes:AID,AttributeName...\n - ProductAttributes:PID,AID,Value\n</code></pre>\n\n<p>and the values are</p>\n\n<pre><code>***ProductAttributes***\n\n - P1,A1,V1\n - P1,A2,V2\n - P1,A3,V3\n - P2,A1,V4\n - P2,A2,V2\n - P2,A3,V3\n - P3,A1,V1\n - P3,A2,V2\n - P3,A3,V5\n</code></pre>\n\n<p>I need a procedure which has 2 array parameters and it filters products by these parameters. If <code>Parameter1:{A1,A2}</code> and <code>Parameter2:{V1,V2}</code> procedure should select </p>\n\n<pre><code>P1,P3\n</code></pre>\n\n<p>How can I write this? Thanks</p>\n"},{"tags":["php","database","query","cakephp"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13183370,"title":"Query every time keypress or a inital big query? Which is better in cakePHP and jquery?","body":"<p>Hi I have a site develop in cakephp, in a page I have an input type text where a user can insert string like \"ban\" I make a query to the database to retrieve the data to obtain record which contain that string (in the example: \"banana\", \"banned\"...). Every time that the user digit another letter I make another query to retrieve data which containt taht string every time. The query is done in jquery every time that a user press a letter.\nI have for example 1 milion of record into my table and I don't know if a user start to digit letter if this solution is fast.\nAnother solution is: when I open that page I make a query to find all record and put it into an array. every time that a user digit a letter I search that string into the array to obtain a subarray with the result.</p>\n\n<p>Which is the best solution in terms of speed, RAM. Consider that in that table I can have 1 milion of record and many user can enter into that page simultaneously.\nMy database is MYSQL.</p>\n"},{"tags":["mysql","sql","query","join","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13183371,"title":"Tricky MySQL query with joins?","body":"<p>I have 4 tables (among a lot of others - just showing the relevant ones). They are:</p>\n\n<ul>\n<li>\"users\"\n<ul>\n<li>id</li>\n<li>name</li>\n<li>role_id</li>\n</ul></li>\n<li>\"roles\"\n<ul>\n<li>id</li>\n<li>name</li>\n</ul></li>\n<li>\"chapter_role_view_permissions\"\n<ul>\n<li>id</li>\n<li>chapter_id</li>\n<li>role_id</li>\n</ul></li>\n<li>\"chapters\"\n<ul>\n<li>id</li>\n<li>name</li>\n</ul></li>\n</ul>\n\n<p>I'm trying to build a query that will return to me a list of all users, their role name, all chapters per user, and whether or not they have view access to each chapter. So lets say there are 2 users and 2 chapter. User 1 is role_id=1 and User 2 is role_id=2. And the chapter_role_view_permissions has 1 record ( id:1 | chapter_id: 1 | role_id: 1 ) which means only users with role_id=1 can view chapter 1.</p>\n\n<p>The query result I am looking for should be something like:</p>\n\n<p>|---users.id---|--roles.id---|---chapters.id--|-can_view_chapter-|</p>\n\n<p>|------ 1 ------|----- 1 -------|------- 1 --------|----------- 1 -----------|</p>\n\n<p>|------ 1 ------|----- 1 -------|------- 2 --------|----------- 0 -----------|</p>\n\n<p>|------ 2 ------|----- 2 -------|------- 1 --------|----------- 0 -----------|</p>\n\n<p>|------ 2 ------|----- 2 -------|------- 2 --------|----------- 0 -----------|</p>\n\n<p>Any idea what the query might look like? I don't want to have to make a new field in chapter_role_view_permissions that says \"allowed\" and insert new records for each role type with either allowed=1 or allowed=0</p>\n"},{"tags":["query","grails","alias","projection","criteria-api"],"answer_count":2,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":2236,"score":5,"question_id":5895091,"title":"Grails Criteria projections on joined table","body":"<p>I have an issue with grails criteria builder, I want to do a projection on a column that is on a table that is in one-to-many relation to parent table example:</p>\n\n<pre><code>Car.createCriteria() { \n   projections { \n     property('name') \n     property('wheels.name')// ???? \n   }\n\n   join 'wheels' \n   //or wheels {} ???\n}\n</code></pre>\n\n<p>or something similar exist? I think it is basic propblem with aliases</p>\n"},{"tags":["php","sql","query","results"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13168663,"title":"SQL query results returned, even if exact match not found","body":"<p>I hope this question isn't redundant.  What I am trying to accomplish is have a user select a bunch of checkboxes on a page and return the closest matching records if there are no matching rows. For example:</p>\n\n<p>A person checks off [x]Apples [x]Oranges [x]Pears [x]Bananas</p>\n\n<p>But the table looks like this:</p>\n\n<pre><code>Apples     Oranges      Pears     Bananas\n 1             1           1        null\n 1             1         null       1\n 1             1         null       null\n</code></pre>\n\n<p>(Obviously I missed the id column here, but you get the point I think.) So, the desired result is to have those three rows still be returned in order of most matches, so pretty much the order they are in now. I'm just not sure what the best approach to take on something like this. I've considered a full text search, the levenshtein function,  but I really like the idea of returning the exact match if it exists. No need for you to go at length with code if not needed. I'm just hoping to be sent in the right direction. I HAVE seen other questions sort of like this, but I still am unsure about which way to go.</p>\n\n<p>Thanks!</p>\n"},{"tags":["query","post","node.js"],"answer_count":5,"favorite_count":12,"up_vote_count":18,"down_vote_count":0,"view_count":16507,"score":18,"question_id":5710358,"title":"how to get POST query in express node.js?","body":"<p>Here is my simple form:</p>\n\n<pre><code>&lt;form id=\"loginformA\" action=\"userlogin\" method=\"post\"&gt;\n        &lt;div&gt;\n            &lt;label for=\"email\"&gt;Email: &lt;/label&gt;\n            &lt;input type=\"text\" id=\"email\" name=\"email\"&gt;&lt;/input&gt;\n        &lt;/div&gt;\n&lt;input type=\"submit\" value=\"Submit\"&gt;&lt;/input&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here is my express node.js code:</p>\n\n<pre><code>app.post('/userlogin', function(sReq, sRes){\n\n    var email = sReq.query.email.;\n\n}\n</code></pre>\n\n<p>I tried <code>sReq.query.email</code> or <code>sReq.query['email']</code> or <code>sReq.params['email']</code> etc. None of them work.  They all return <code>undefined</code>. </p>\n\n<p>When I change to a Get call, it works, so .. any idea?</p>\n"},{"tags":["sql","ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1249,"score":1,"question_id":2952482,"title":"Advanced count and join in Rails","body":"<p>I am try to find the top <code>n</code> number of categories as they relate to articles, there is a habtm relationship set up between the two. This is the SQL I want to execute, but am unsure of how to do this with ActiveRecord, aside from using the <code>find_by_sql</code> method. is there any way of doing this with ActiveRecord methods:</p>\n\n<pre><code>SELECT \n  \"categories\".id, \n  \"categories\".name, \n  count(\"articles\".id) as counter \nFROM \"categories\"\nJOIN \"articles_categories\" \n  ON \"articles_categories\".category_id = \"categories\".id\nJOIN \"articles\" \n  ON \"articles\".id = \"articles_categories\".article_id\nGROUP BY \"categories\".id\nORDER BY counter DESC\nLIMIT 5;\n</code></pre>\n"},{"tags":["json","query","postgresql"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":827,"score":3,"question_id":6663665,"title":"PostgreSQL how to query json data based upon json attribs criteria","body":"<p>I am using PostgreSQL i want to store JSON data into table column.\nLater i want to retrieve data records criteria based upon JSON attributes.\nI know sort of this support available in MS SQL Server but i don't know that is it available in PostgreSQL or not.</p>\n"},{"tags":["mysql","arrays","query","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13181500,"title":"Looping through array field in mysql statement?","body":"<p>I was given a database that is a little weird, but I am not able to change it. There is a field that is set as an array but holds ids that I need to access in where clauses. Here is the field set up:</p>\n\n<pre><code>TABLE: PROMOS\npromo_id   |    contract_ids\n-----------------------------\n 1               23,34,54\n 2               13,34,55\n 3               20,30\n</code></pre>\n\n<p>I need to do an sql query to get all promo_ids where contract id = 34</p>\n\n<pre><code>mysql_query(\"SELECT promo_id FROM Promos WHERE contract_ids = '34'\n</code></pre>\n\n<p>Is there a way to do this?? Thanks for any help!</p>\n"},{"tags":["sql","query","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13181117,"title":"SQL - how to get out chained data?","body":"<p>I have 4 tables which were auto generated for me:</p>\n\n<ul>\n<li>User</li>\n<li>Challenge</li>\n<li>Exercise</li>\n<li>Challenge_Exercise</li>\n</ul>\n\n<p>One User may have many Challenges, and one Challenge will have many Exercises.</p>\n\n<p>What I noticed is that the Challenge table has a reference to it's parent User (called user_id) but Exercise do not have a reference in it's table to Challenge; their relation is stored in Challenge_Exercise as Challenge_id and exercise_id.</p>\n\n<p>My question is, how would I take out every Exercise that is linked to a specific user? For instance User with id = 1?</p>\n"},{"tags":["excel","odbc","query"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":16527,"score":3,"question_id":1285686,"title":"Excel: Use a cell value as a parameter for a SQL query","body":"<p>I'm using MS Excel to get data from a MySQL database through ODBC.<br />\nI successfully get data using an SQL query. But now I want that query to be parameterized.<br />\nSo I wonder If it is possible to use a cell value (a spreadsheet cell) as a parameter for such a query.<br />\nFor example, for this query:</p>\n\n<pre><code>select name from user where id=1\n</code></pre>\n\n<p>I'd like to get the id value from, say, cell D4 in the spreadsheet.</p>\n\n<p>Is that the proper approach to parameterize a query? and how can I do it?</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13180326,"title":"Basic SQL Update query in PHP","body":"<p>I am using a MVC framework and have a problem in a SQL query.</p>\n\n<p>The user that publish a post on my website receives an email containing a confirmation URL : </p>\n\n<pre><code>mywebsite.com/confirm/f9b83b3bf994e5db3b06ya20eb306a24/\n</code></pre>\n\n<p>The routing is made correctly, but I would like to change the SQL \"published\" field to 1 (it is set to 0 by default)</p>\n\n<p>So basically, everything is working except my UPDATE SQL query, it's probably something stupid but I am a beginner in this domain and I couldn't fix it after many tries.</p>\n\n<pre><code>    if(substr(ROUTE, 0, 8) == 'confirm/')\n        {\n            if(strlen($code = substr(ROUTE, 8, 32)) == 32)\n            {\n                if($row = db::fetch(db::query('SELECT `id` FROM `'.DB_PREFIX.'Posts` WHERE `published`=0 AND `confirm`=\"'.db::escape($code).'\"'), 'row'))\n                {\n\n//This is the problematic line\n                 db::query('UPDATE '.DB_PREFIX.'Posts SET published=1 WHERE published=0 AND confirm=\"'.db::escape($code).'\"');\n\n                }\n            }\n\n            header('Location: '.WEB.'publish_success.html');\n        } \n</code></pre>\n\n<p>Thank youf or your help :)</p>\n\n<p>Edit : Problem fixed adding the WHERE clause !</p>\n"},{"tags":["jquery","query","media"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13179056,"title":"Stop jQuery with media query","body":"<p>Simple question can I stop a jquery function with media queries.</p>\n\n<p>I have a jQuery slideshow that I want to stop when the window gets to phone size so i can adjust the layout.</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13178569,"title":"ms sql casting error","body":"<p>My question is regarding my <a href=\"http://stackoverflow.com/questions/13176788/ms-sql-2005-cant-compare-dates\">previous</a> topic.</p>\n\n<p>The problem I have is that when the date wich have to be casted is like: (25.09.2012) is throwing a strange <code>The conversion of a char data type to a datetime data type resulted in an out-of-range datetime value.</code>error. I lost 40 minutes trying to fix it without success.</p>\n\n<p>Here the code is:</p>\n\n<pre><code>edited\n</code></pre>\n\n<p>Is there a way to convert it? For example when I put <code>20.09.2012</code> im getting an error, but it's running with <code>10.09.2012</code> Please help me with this issue!</p>\n"},{"tags":["query","encoding","solr"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12749890,"title":"Solr query on Europe character (Beklædning)","body":"<p>in solr query search,\na search </p>\n\n<pre><code>q=*%3A*&amp;fq=grand_cat_str%3ABeklædning\n</code></pre>\n\n<p>Solr will read the fq as:<code>&lt;str name=\"fq\"&gt;grand_cat_str:BeklÃ¦dning&lt;/str&gt;</code></p>\n\n<p>and return no result. Doing wild search for Bekl*dning would return correct result.</p>\n\n<p>[edit]\nI added </p>\n\n<pre><code>    &lt;fieldType name=\"string\" class=\"solr.StrField\" sortMissingLast=\"true\" &gt;\n &lt;analyzer type=\"index\"&gt;\n        &lt;tokenizer class=\"solr.StandardTokenizerFactory\"/&gt;\n        &lt;filter class=\"solr.ASCIIFoldingFilterFactory\"/&gt;\n &lt;/analyzer&gt;\n\n&lt;/fieldType&gt;\n</code></pre>\n\n<p>but got a error:</p>\n\n<pre><code>&lt;org.apache.solr.common.SolrException: FieldType: StrField (string) does not support specifying an analyzer\n</code></pre>\n"},{"tags":["sql","sql-server","query","ide","formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":207,"score":1,"question_id":11061642,"title":"SQL server 2012 SP_HELPTEXT extra lines issue","body":"<p>I am using SQL server 2012, &amp; always use <code>SP_HELPTEXT</code> to get my previously created Stored Procedures, In previous versions of SQL server there were no issues in this process but in 2012, My Stored Procedures come with extra lines, for example this is the procedure that I wrote</p>\n\n<pre><code>Create proc SP_Test\nas\nbegin\n Select * \n from table_ABC\nend\n</code></pre>\n\n<p>Now after using <code>SP_HELPTEXT</code> with this procedure (or any other procedure), I am getting this output</p>\n\n<pre><code>Create proc SP_Test\n\nas\n\nbegin\n\n Select * \n\n from table_ABC\n\nend\n</code></pre>\n\n<p>Do any one else also facing this problem or I am the only one on this planet to struggle with this issue ??\nDoes any body know how to solve this issue ??</p>\n\n<p>Configuration of my SQL server is as follows (copied from <strong>Help -> About</strong> )</p>\n\n<pre><code>Microsoft SQL Server Management Studio          11.0.2100.60\nMicrosoft Analysis Services Client Tools        11.0.2100.60\nMicrosoft Data Access Components (MDAC)         6.1.7601.17514\nMicrosoft MSXML                     3.0 6.0 \nMicrosoft Internet Explorer             9.0.8112.16421\nMicrosoft .NET Framework                4.0.30319.269\nOperating System                    6.1.7601\n</code></pre>\n\n<p>Thanx in advance.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13179326,"title":"What is the best way to create a query with a big set of data?","body":"<p>I have about 360 lines of data which I need to make into 360 query's for SQL, Is there any quick way of putting all the data into one query instead of having to put them all in separate, for example here is just 3 lines of data I have:</p>\n\n<pre><code>   1,81,32\n   1,101,82\n   1,60,65\n</code></pre>\n\n<p>I have to make this data into query's so these 3 would look like:</p>\n\n<pre><code>   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (1,81,32);\n   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (1,101,82);\n   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (2,60,65);\n</code></pre>\n\n<p>But I have 360 lines of this, so It will be hard to make these all into query's 1 by 1, Is there any quicker way of doing this, Like just one query to insert them all?</p>\n"},{"tags":["query","ruby-on-rails-3.1","comments","polymorphism"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13167248,"title":"How do I Query Polymorphic Comments when commentables can belong to another commentable?","body":"<p>So I'm trying to do a relatively advanced query on a polymorphic model. I have the following models:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :project_stakeholders, :dependent =&gt; :destroy\n  has_many :features, :dependent =&gt; :destroy\n  has_many :iterations, :dependent =&gt; :destroy\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass ProjectStakeholder &lt; ActiveRecord::Base\n  belongs_to :project\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass Feature &lt; ActiveRecord::Base\n  belongs_to :project\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass Iteration &lt; ActiveRecord::Base\n  belongs_to :project\n  has_many :comments, :as =&gt; :commentable, :dependent =&gt; :destroy\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :comments, :dependent =&gt; :destroy\nend\n\nclass Comment &lt; ActiveRecord::Base\n  belongs_to :commentable, :polymorphic =&gt; true\n  belongs_to :created_by, :class_name =&gt; 'User'\nend\n</code></pre>\n\n<p>I'm trying to find the current_user's comments for a particular project (project.comments, project.features.comments, project.iterations.comments, project.project_stakeholder.comments) and sort them in created_at descending order.</p>\n\n<p>The best I have come up with is:</p>\n\n<pre><code>Class Project &lt; ActiveRecord::Base\n  def all_comments_for_user(user)\n    Comment.where(:created_by_id =&gt; user.id).select { |c| c.commentable.attributes.has_key?('project_id') }.select { |c| c.commentable.project == self } | comments.where(:created_by_id =&gt; user)\n  end\nend\n</code></pre>\n\n<p>But this doesn't address the descending create_at sequence.</p>\n"},{"tags":["query","google","parameters","search-engine"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1547,"score":2,"question_id":2401115,"title":"Meaning of parameters in a Google query?","body":"<p>Are there any ressources on what the parameters in a Google query mean? Any analysis how the Google search pages work internally? </p>\n\n<p>Examples would be</p>\n\n<pre><code>http://www.google.com/#hl=en&amp;source=hp&amp;q=lol&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;fp=45675624562456\n</code></pre>\n\n<p>or</p>\n\n<pre><code>http://www.google.com/url?sa=t&amp;source=web&amp;ct=res&amp;cd=11&amp;ved=KJSGHFKSDJF&amp;url=sfdgagasdgasdgasgasg&amp;rct=j&amp;q=fghthwrteghedgf&amp;ei=asdfasdfsa&amp;usg=asdfasdfasf\n</code></pre>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13177901,"title":"How to find if a date is from a Odd or Even week?","body":"<p>In my table I have for each day:</p>\n\n<pre><code>Id_______Startdate _______ EndDate __________MondayMorning _____MondayEvening ___TuMorning  ....  \n121 _____2012-01-01________2012-12-31 ________2 ___________________2______________2   \n122 _____2012-02-01________2012-08-05 ________1 ___________________2______________3   \n</code></pre>\n\n<p>I already generated a list of dates using the Startdate and EndDate. </p>\n\n<p>I want to know if this dates belongs to a odd week or a even week so that I can filter days from my output that have number 3 Or 1 (see second record).</p>\n\n<p>how can I filter the days that belongs to  odd weeks and even weeks that have number 1 and 3?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13176788,"title":"ms sql 2005 can't compare dates","body":"<p>I have a huge database in ms sql. I have a date stored into a field of type: <code>VARCHAR2</code>\nI have the code, but it can't compare dates. What I mean? There is an input with a launch date. What I need is to get the launchdate inputs where the launchdate is bigger than a date and smaller than another. The problem is that when I change the year from 2012 to 2013 there are no results. Also when I have dates with 0 (like 01.01.2012) it can't compire them.</p>\n\n<p>What I have so far is:</p>\n\n<pre><code>edited\n</code></pre>\n\n<p>Can someone help me to get the correct results?</p>\n\n<p><strong>EDIT1</strong></p>\n\n<p>The date is stored as string in this format: yyyy-mm-dd</p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13173833,"title":"How to have many column from just one cloumn?","body":"<p>I have a table : </p>\n\n<p>IADATA</p>\n\n<pre><code>    Id     Studentid     Mon   Value  Type\n    1      ABC1           1      12     1\n    1      ABC1           1      02     2\n    1      ABC1           1      18     4\n    1      ABC1           1      09     7\n    1      ABC1           1      12     8\n    1      ABC1           1      22     10\n    1      ABC2           2      12     1\n    1      ABC2           2      02     2\n    1      ABC2           2      18     4\n    1      ABC2           2      09     7\n    1      ABC2           2      12     10\n    1      ABC2           3      05     1\n    1      ABC2           3      02     2\n    1      ABC2           3      20     4\n    1      ABC2           3      09     7\n    1      ABC2           3      12     10\n</code></pre>\n\n<p>In the above table we have two Students ABC1 and ABC2 and their data.</p>\n\n<p>Now the kind of result i want is:</p>\n\n<pre><code>   Id      Studentid      Mon     Obtained   Benefits   Max    Type\n    1        ABC1          1         12         02      18       I\n    2        ABC1          1         09         12      22       II\n    3        ABC2          2         12         02      18       I\n    4        ABC2          2         09         00      12       II\n    5        ABC2          3         05         02      20       I\n    6        ABC2          3         09         00      12       II\n</code></pre>\n\n<p>Now in the result you can see that i am placing the values according to the studentid and mon and the types in a certain order. if the type is I it should have obtained, then benefits then max and same with II. What can be the select query for it?</p>\n\n<p>The type in previous tables are linked. When it has the value 1,2,4 it should be like obtained, benefits and maximum for new type I and when 7,8,10, it should be like obtained,benefits and maximum for new type II. And when there is no column available, it should be zero. </p>\n"},{"tags":["php","mysql","sql","query","date"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13139318,"title":"Comparing a string-date with another string-date in MySql query","body":"<p>I'm trying to get entries from MySql server where the dates are <code>&gt; date_begin and &lt; date_end</code></p>\n\n<p>My problem is that the table column \"<code>date</code>\" is set to <code>VARCHAR</code>, and the string I am comparing it is also directly from an <code>&lt;input type=\"text\"/&gt;</code></p>\n\n<p>The date format ( as string / varchar ) in the mysql table and in the textbox will be <code>DD.MM.YYYY</code></p>\n\n<p>my problem is that if i do </p>\n\n<p>( php code )</p>\n\n<pre><code> $query = \"SELECT * FROM table WHERE date&gt;='\" . $dateBegin . \"' AND date&lt;='\" . $dateEnd . \"'\";\n</code></pre>\n\n<p>the result will be completely random.</p>\n\n<p>I know why this happening so the question is: How can I compare this to get the right result ?</p>\n\n<p>thank you all who can help</p>\n\n<p><strong>UPDATE :</strong> </p>\n\n<p>Now I've tryed this solution, but it also doesn't work.</p>\n\n<pre><code>$query = \"SELECT * FROM artikel WHERE STR_TO_DATE(datum, '%d.%m.%Y')&gt;=STR_TO_DATE('\" . $_REQUEST['dateTo'] . \"', '%d.%m.%Y')\" . \"' AND STR_TO_DATE(datum, '%d.%m.%Y')&lt;=STR_TO_DATE('\" . $_REQUEST['dateTo'] . \"', '%d.%m.%Y')\";\n</code></pre>\n\n<p>the <code>$_REQUEST['dateFrom']</code> and <code>$_REQUEST['dateTo']</code> came from 2 textboxes and the input is a string like this <code>\"05.06.2005\"</code>.</p>\n\n<p>in the db-table 'artikel' (german for articles) in the column 'datum' (german for date) the values are VARCHAR's with the same format ( \"05.06.2005\" ).</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13176338,"title":"Query single value with SQL","body":"<p>I want to get a single value(aktiv) out of a table called wartung. </p>\n\n<pre><code>include('blog/includes/db_connect.php');\n$query = $db-&gt;prepare(\"SELECT * FROM wartung\");\n$query-&gt;execute();\n$query-&gt;bind_result($wartung_id, $aktiv, $grund);\n</code></pre>\n\n<p>The value of aktiv in the database is 1.<br>\nbut this code doesn't get this 1 into the <code>$aktiv</code> variable.  </p>\n\n<p><sub>PS: I'm not used to code with MySQL and PHP so if there is a beginner-bug please don't be mad.</sub></p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13175550,"title":"MySQL database query returns empty result","body":"<p>I am doing a data migration and getting empty result of simple query with one join. Following is the query</p>\n\n<pre><code>Select * from users u INNER JOIN temp_users tu ON tu.uid = u.uid\n</code></pre>\n\n<p>There are hundreds of records which have same uid in both tables, but this query returns only one record.</p>\n\n<p>Following is the structure of tables</p>\n\n<pre><code>users table\nuid:  varchar(50)   utf8_general_ci         Yes     NULL \n\ntemp_users table\nuid: varchar(50)    utf8_general_ci         Yes     NULL\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":55,"score":5,"question_id":13172228,"title":"Require if in where condition SQL","body":"<p>I want to fetch the data based on the key_column in the table. I am having a procedure where i am passing the key character. If the key is 'A' only those records with key as 'A' should get selected . For any other key character other than 'A', I need all the records except the rows with the key_Column value 'A' </p>\n\n<p>sample code:</p>\n\n<pre><code>select * from tab1\nwhere \nif (@key_Char = 'A') Then key_Column=@key_Char \nELSE key_Column &lt;&gt;@key_Char \n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13175192,"title":"ms sql convert string to date changing the order from yyyy-mm-dd to dd.mm.yyyy","body":"<p>I have a field named <code>VALUE</code> of <code>VARCHAR2</code> type</p>\n\n<p>The string is in this format: <code>yyyy-mm-dd</code>\nIs it possible to change it to: <code>dd-mm-yyyy</code></p>\n\n<p>An then (again if possible) to convert it to date in this format?</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>SELECT convert(varchar, getdate(), 110)\n</code></pre>\n\n<p>but it's only for the current time. Is there a way to do this?</p>\n\n<p>Edit:\nHere my code is:</p>\n\n<pre><code>select\np1.VALUE as Sdate\nfrom Process p \nLEFT JOIN PARAMETER p1 on p1.WP_ID=p.ID AND p1.NAME = 'Sdate'\nWHERE p.TYPE = 'Marketing' and convert(varchar, convert(date,p1.value), 103) ='22.08.2012'\n</code></pre>\n"},{"tags":["c#","string","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13174387,"title":"Query string using LINQ","body":"<p>For parsing SDP information from an RTSP, currently I use default c# string functions (like loop the string line by line) and foreach/switch methods. Default SDP information comes from a device in this form:</p>\n\n<pre><code>v=0\no=mhandley 2890844526 2890842807 IN IP4 126.16.64.4\ns=SDP Seminar\ni=A Seminar on the session description protocol\nu=http://www.cs.ucl.ac.uk/staff/M.Handley/sdp.03.ps\ne=mjh@isi.edu (Mark Handley)\nc=IN IP4 224.2.17.12/127\nt=2873397496 2873404696\na=recvonly\nm=audio 3456 RTP/AVP 0\nm=video 2232 RTP/AVP 31\nm=whiteboard 32416 UDP WB\na=orient:portrait\n</code></pre>\n\n<p>Im wondering is this string is query-able using LINQ or something instead of foreaching each line, switching the first character and then storing the rest as a value, because this method is very sensitive to malfunction and error (like when 2 attributes/params are on 1 line or the first character isn't accidentally the right one (e.g. with a space before)). Before I begin to cover every damn exception than can occur, I'm wondering if there's a technique to query a string for values/keys using LINQ.</p>\n"},{"tags":["mysql","database","oracle","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13174298,"title":"oracle select statement reuse?","body":"<p>This is an extract sql that gets days</p>\n\n<pre><code>AND S.Date          IN\n\n  (\n    SELECT Date\n    FROM\n      (\n      SELECT Date,\n        ROW_NUMBER() OVER (ORDER BY Date DESC )-1 Day\n      FROM CALENDAR_DIM\n      WHERE TYPE               = 'ABC'\n      )\n    WHERE BUS_DAY BETWEEN 0 AND 2\n  )\n</code></pre>\n\n<p>I want to run this code twice in two parts of my sql. How can i do that without pasting the same code. Also .. how could i rewrite the above code?. I am having some issues with performance. </p>\n"},{"tags":["query","mongodb","geo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13154419,"title":"slow Mongodb $near search with additional criteria","body":"<p>I have a collection, the data look like this:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"4e627655677c27cf24000000\"),\n    \"gps\" : {\n        \"lng\" : 116.343079,\n        \"lat\" : 40.034283\n    },\n    \"lat\" : 1351672296\n}\n</code></pre>\n\n<p>And I build a compound index:</p>\n\n<pre><code>{\n    \"v\" : 1,\n    \"key\" : {\n        \"gps\" : \"2d\",\n        \"lat\" : 1\n    },\n    \"ns\" : \"test.user\",\n    \"name\" : \"gps__lat_1\"\n}\n</code></pre>\n\n<p>A pure $near query like below can be very fast ( &lt; 20ms ):</p>\n\n<pre><code>&gt;db.user.find({\"gps\":{\"$near\":{\"lng\":116.343079,\"lat\":40.034283}}}).explain()\n{\n    \"cursor\" : \"GeoSearchCursor\",\n    \"nscanned\" : 100,\n    \"nscannedObjects\" : 100,\n    \"n\" : 100,\n    \"millis\" : 23,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"isMultiKey\" : false,\n    \"indexOnly\" : false,\n    \"indexBounds\" : {\n\n    }\n}\n</code></pre>\n\n<p>But the query with \"lat\" criteria is very slow ( 900ms+ ):</p>\n\n<pre><code>&gt;db.user.find({\"gps\":{\"$near\":{\"lng\":116.343079,\"lat\":40.034283}},\"lat\":{\"$gt\":1351413167}}).explain()\n{\n    \"cursor\" : \"GeoSearchCursor\",\n    \"nscanned\" : 3,\n    \"nscannedObjects\" : 3,\n    \"n\" : 3,\n    \"millis\" : 665,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"isMultiKey\" : false,\n    \"indexOnly\" : false,\n    \"indexBounds\" : {\n\n    }\n}    \n</code></pre>\n\n<p>Can anybody explain this? Great thx!</p>\n"},{"tags":["android","query","sqlite","date","sql-order-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13172245,"title":"SQLITE raw query result not the same as in aSQLiteManager","body":"<p>I make the following query in SQLitemanager (SQL DB App for Android):</p>\n\n<pre><code>SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY SUBSTR(fahrtenbuch.startdatum,7,4), SUBSTR(fahrtenbuch.startdatum,4,2), SUBSTR(fahrtenbuch.startdatum,1,2) ASC\n</code></pre>\n\n<p>The returned order is as expected. The date is correctly sorted by <strong>dd.mm.yyyy</strong>.</p>\n\n<p>But when I execute the query in my <strong>DB-Helper class</strong>, the order is not the same.\nIn the DB-Helper class:</p>\n\n<pre><code>final String MY_QUERY = \"SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY SUBSTR(fahrtenbuch.startdatum,7,4), SUBSTR(fahrtenbuch.startdatum,4,2), SUBSTR(fahrtenbuch.startdatum,1,2) ASC\";\nreturn mDb.rawQuery(MY_QUERY, null);\n</code></pre>\n\n<p>In my activity:</p>\n\n<hr>\n\n<pre><code>Cursor curCSV = mDbHelper.fetchAllFahrtenbuchASC();\ncurCSV.moveToFirst();\nwhile(curCSV.moveToNext()) \n{\n   System.out.println(\"Date of entry: \" +curCSV.getString(18));\n} \n\ncurCSV.close();\n</code></pre>\n\n<hr>\n\n<p>Does anyone know why this is not working?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13173585,"title":"How to check if a field is updated when inserting from table to table?","body":"<p>I have the following data inserted from TableA to TableB. I'm inserting the data from TableA to TableB using a query that automatically runs every 4 hours. The query contains a insert, update and a delete.</p>\n\n<blockquote>\n  <p>Date_<strong><em>_</em>__<em>_</em>_</strong><em>Group  <strong></em>____</strong><em>State  <strong></em>___</strong><em>BeginTime  <strong></em>___</strong><em>EndTime<br>\n  2012-11-1 <strong></em>_</strong><em>A  <strong></em>__<em>_</em>__<em>_</em>__</strong><em>1     <strong></em>__<em>_</em>____</strong><em>08:00   <strong></em>__<em>_</em>___</strong>_16:00</p>\n</blockquote>\n\n<p>The application that uses TableB can also change the field State but I need to check if this is changed by the application. There is no any attribute how I can check this.</p>\n\n<p>I tried to create a new column 'FromTableA' (bit) into TableB to hold a state that means, this data coming from TableA. But when the application changes the state, the attribute FromTableA stays TRUE so I can't check this.</p>\n\n<p>Any ideas to solve the problem, using just a query? Changes in the application are not allowed.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13173252,"title":"Count and insert comments from Xoops database","body":"<p>I am trying to convert Xoops posts to Wordpress. As part of that, I want to get comment count for a topic. Post and replies are on same \"topic_id\". How to count them and post it in to new column?</p>\n\n<p><strong>DB current status</strong></p>\n\n<pre><code>topic_id | subject             |comment_count|\n+________+_____________________+_____________+\n1    | welcome             | \n1    | Re: welcome         |\n2    | hello world         |\n2    | Re: hello world     |\n2    | Re: hello world     |\n3    | hello friends       |\n</code></pre>\n\n<p>from here I want to take the (count of topic_id - 1) as the number of replays (comment count). Guide me to query in MYSQL</p>\n\n<p>I want to place the output in the same table. (comment_count)</p>\n\n<p><strong>DB expected output</strong></p>\n\n<pre><code>   | topic_id | subject             |comment_count|\n   +________+_____________________+_____________+\n   | 1   | welcome             | 1 \n   | 1   | Re: welcome         | 1\n   | 2   | hello world         | 2\n   | 2   | Re: hello world     | 2\n   | 2   | Re: hello world     | 2\n   | 3   | hello friends       | 0\n</code></pre>\n"},{"tags":["mysql","query","count","group-by"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13171133,"title":"Select maximum date with group by another columns","body":"<p>I have a table like:</p>\n\n<p><strong>gold_2012</strong></p>\n\n<pre><code>gold_city | gold_type | gold_cost | gold_selltime\n--------------------------------------------------\ncity1     | type 1    | 41.23     | 2012-01-01   \ncity1     | type 1    | 42.23     | 2012-02-02   \ncity1     | type 1    | 40.23     | 2012-03-03   \ncity2     | type 2    | 43.23     | 2012-01-01   \ncity2     | type 2    | 45.23     | 2012-02-02   \ncity2     | type 2    | 47.23     | 2012-03-03   \ncity3     | type 3    | 48.23     | 2012-01-01   \ncity3     | type 3    | 49.23     | 2012-02-02   \ncity3     | type 3    | 44.23     | 2012-03-03   \n</code></pre>\n\n<p>How can I get 1 last result order by <code>gold_selltime</code> desc each group by <code>gold_city</code> and <code>gold_type</code>.</p>\n\n<p>I used this:</p>\n\n<pre><code>SELECT * , COUNT( * ) \nFROM  gold_2012\nGROUP BY  gold_type ,  gold_city\nORDER BY gold_selltime DESC\n</code></pre>\n\n<p>but it didn't work.<br>\nI only have result like:</p>\n\n<pre><code>gold_city | gold_type | gold_cost | gold_selltime\n--------------------------------------------------\ncity1     | type 1    | 41.23     | 2012-01-01   \ncity2     | type 2    | 43.23     | 2012-01-01   \ncity3     | type 3    | 48.23     | 2012-01-01   \n</code></pre>\n\n<p>but I need it like:</p>\n\n<pre><code>gold_city | gold_type | gold_cost | gold_selltime\n--------------------------------------------------\ncity1     | type 1    | 40.23     | 2012-03-03   \ncity2     | type 2    | 47.23     | 2012-03-03   \ncity3     | type 3    | 44.23     | 2012-03-03   \n</code></pre>\n\n<p>Sorry! I forget sth! Please see my edited question above.</p>\n"},{"tags":["java","query","mongodb","results"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13155328,"title":"MongoDB & Java, add a value to the result","body":"<p>I have the code as shown below. I query the MongoDB and the results are serialized and returned. But I would like to add a new value to every record/document, in this case 'age'.\nSo I thought I would loop over the results and add them with one.put but the value is not showing in the returned json.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks for any help or suggestions!</p>\n\n<pre><code>    public String (int id){     \n        DBCollection collection = database.getCollection(\"collection\");\n        BasicDBObject query = new BasicDBObject();\n        query.put(\"id\", id);\n\n        DBCursor cursor = collection.find(query);       \n        if (cursor.hasNext()) {\n            DBObject one = cursor.next();\n            one.put(\"age\", 33);\n        }\n\n        String json = JSON.serialize(cursor)\n\n        return json;\n    }   \n</code></pre>\n"},{"tags":["mysql","sql","query","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":26,"score":0,"question_id":13171594,"title":"SQL Query Throws Error 150","body":"<pre><code>SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;\nSET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;\nSET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';\n\nCREATE SCHEMA IF NOT EXISTS `rsmad` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;\nUSE `rsmad` ;\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_flashobjects`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_flashobjects` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `flashobject_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_html`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_html` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `html_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_iframes`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_iframes` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `iframe_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_images`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_images` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `image_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_links`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_links` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `link_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_text`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_text` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `text_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`apps`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`apps` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `webpage_id` INT UNSIGNED NOT NULL ,\n  `timestamp` DATETIME NULL ,\n  `status` ENUM('ok','malicious','good') NOT NULL DEFAULT 'ok' ,\n  PRIMARY KEY (`id`) ,\n  CONSTRAINT `fk_apps_app_flashobjects1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_flashobjects` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_html1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_html` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_iframes1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_iframes` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_images1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_images` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_links1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_links` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_text1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_text` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE)\nENGINE = InnoDB;\n</code></pre>\n\n<p>Can anyone explain what the issue with these queries is?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13170717,"title":"MS Access SQL Query - Joining 3 Tables to receive Total Order Price","body":"<p>I would like to know the total price for a specific order ID. The information is contained in these tables:</p>\n\n<p>Order_line_t</p>\n\n<pre><code>Order_ID    Product_ID    Quantity\n--------    ----------    --------\n1006        4             1\n1006        5             2\n1006        7             2\n</code></pre>\n\n<p>Uses_t</p>\n\n<pre><code>Product_ID    Material_ID    Footage\n----------    -----------    -------\n4             16             20\n5             15             13\n7             10             16\n</code></pre>\n\n<p>Raw_Materials_t</p>\n\n<pre><code>Material_ID    Unit_Price\n-----------    ----------\n16             05.70\n15             16.72\n10             15.55\n</code></pre>\n\n<p>The total cost is computed by </p>\n\n<pre><code>Multiplying SUM ( Order_line_t.Quantity * Uses_t.Footage * Raw_Materials_t.Unit_Price) AS Total\n</code></pre>\n\n<p>My current query only returns an error:</p>\n\n<pre><code>SELECT Order_line_t.Order_ID, Order_line_t.Product_ID, Uses_t.Product_ID   ,Uses_t.Footage , \nSUM ( Order_line_t.Quantity * Uses_t.Footage * Raw_Materials_t.Unit_Price) AS Total\nFROM Order_line_t, Uses_t , Raw_Materials_t\nWHERE  Order_line_t.Order_ID = 1006;\n</code></pre>\n\n<p>Help appreciated! How exactly do I JOIN these tables? What am i missing?</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13170561,"title":"PHP how to check if a returned row contains duplicate values?","body":"<pre><code>&lt;?php\ninclude('includes/connection.php');\n\n$query = 'select a, c from b';\n$result = mysql_query($query, $con);\n$num_rows = mysql_num_rows($result);\n\nif ($num_rows &gt; 0)\n{\n    echo '&lt;p&gt;';\n    while($row = mysql_fetch_array($result))\n    {\n         echo \"{$row[\"a\"]}\";\n    }\n    echo '&lt;/p&gt;';\n}\n?&gt;\n</code></pre>\n\n<p>Table \"b\" has these values in column \"a\"</p>\n\n<pre><code>Table b\n-------\na     c\n-     -\n1     a\n1     a1\n1     a2\n2     a\n3     b\n4     b\n</code></pre>\n\n<p>I would like to be able to in my while loop determine if the returned row is a duplicate and discard it. I only want the number 1 in this case to show up once. How can I go about doing this?</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13169921,"title":"Using SQL to create football fixtures?","body":"<p>Quite hard to explain but say I have a table named 'Teams' and It contains 5 teams like so:</p>\n\n<pre><code> team_id, teamname, manager\n   1,       Team1,    1\n   2,       Team2,    10\n   3,       Team3,    3\n   4,       Team4,    5\n   5,       Team5,    6\n</code></pre>\n\n<p>I need to create another table looking similar to this (named TeamFixtures for example)</p>\n\n<pre><code>  id, HomeTeam, HomeScore, AwayScore, AwayTeam\n                  NULL        NULL\n</code></pre>\n\n<p>How would I make the HomeTeam and AwayTeam be the team_id of the 'teams' table?</p>\n\n<p>Id need this for each team so they play against each other twice, home and away games.</p>\n\n<p>Is there a Query that could make this quicker for me, rather than typing out the fixtures 1by1</p>\n"},{"tags":["query","cakephp","cakephp-2.0","condition"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13167968,"title":"How do I restrict query results based on sub-results in CakePHP?","body":"<p>In CakePHP if I run the following find command</p>\n\n<pre><code>$this-&gt;Instructor-&gt;find('all');\n</code></pre>\n\n<p>the following is returned:</p>\n\n<pre><code>Array\n(\n    [0] =&gt; Array\n        (\n            [Instructor] =&gt; Array\n                (\n                    [id] =&gt; 1\n                    [user_id] =&gt; 3\n                    [bio] =&gt; A billionaire playboy, industrialist and ingenious engineer, Tony Stark suffers a severe chest injury during a kidnapping in which his captors attempt to force him to build a weapon of mass destruction. He instead creates a powered suit of armor to save his life and escape captivity. He later uses the suit to protect the world as Iron Man.\n                )\n\n            [User] =&gt; Array\n                (\n                    [id] =&gt; 3\n                    [first_name] =&gt; Tony\n                    [last_name] =&gt; Stark\n                    [asurite_user] =&gt; tstark\n                    [asurite_id] =&gt; \n                    [password] =&gt; \n                    [email] =&gt; tstark@example.com\n                    [created] =&gt; 2012-10-30 09:57:36\n                    [modified] =&gt; 2012-10-30 09:57:36\n                )\n\n            [Course] =&gt; Array\n                (\n                    [0] =&gt; Array\n                        (\n                            [id] =&gt; 1\n                            [slug] =&gt; beatles\n                            [sln] =&gt; AAA001\n                            [course_number] =&gt; \n                            [title] =&gt; The Beatles\n                            [description] =&gt; This is a class about the Beatles.  If this were a real description, more information would be listed here.\n                            [state] =&gt; \n                        )\n\n                    [1] =&gt; Array\n                        (\n                            [id] =&gt; 2\n                            [slug] =&gt; elvis\n                            [sln] =&gt; AAA002\n                            [course_number] =&gt; \n                            [title] =&gt; Elvis: The King of Rock\n                            [description] =&gt; All about the king of rock and roll, Elvis Presley.\n                            [state] =&gt; \n                        )\n\n                )\n\n        )\n\n    [1] =&gt; Array\n        (\n            ...\n</code></pre>\n\n<p>There is a many-to-many relationship between \"Instructor\" and \"Course\". How can I filter the results based on the \"Course\"s each \"Instructor\" belongs to?  I tried the following without success:</p>\n\n<pre><code>$instructors = $this-&gt;Instructor-&gt;find('all', array(\n    'conditions' =&gt; array('Course.id' = 2)\n));\n</code></pre>\n"},{"tags":["php","database","wordpress","query","multiple-tables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13169276,"title":"Unable to insert data into multiple wordpress tables","body":"<p>I am creating WordPress tags import/export plugin. but I am having an issue.</p>\n\n<p>As we know Tags are actually occupying <code>wp_terms</code> in the database and as well as <code>wp_term_taxonomy</code>.</p>\n\n<p>So I come up with a plan but its not working.</p>\n\n<p>Please check the following codes and let me know how can I fix the issue. Because I am importing <code>name</code> and <code>slug</code> from excel file and trying to save in <code>wp_terms</code> table as well as trying to save <code>term_id</code> into <code>wp_term_taxonomy</code>.</p>\n\n<pre><code>if (( $file_ext == \"xls\" ) &amp;&amp; ( $file_size &lt; 500000 )) \n{       \n    $data = new Spreadsheet_Excel_Reader();\n    $data-&gt;setOutputEncoding('CP1251');\n    $data-&gt;read($_FILES['tag_import']['tmp_name']);\n\n    for ($i = 1; $i &lt;= $data-&gt;sheets[0]['numRows']; $i++)\n    {\n        for ($j = 1; $j &lt;= $data-&gt;sheets[0]['numCols']; $j++)\n        {\n            // add the new category \n            $query = \"INSERT INTO $wpdb-&gt;terms (name, slug) VALUES (%s, %s)\";\n            $wpdb-&gt;query($wpdb-&gt;prepare($query, $data-&gt;sheets[0]['cells'][$i][0], $data-&gt;sheets[0]['cells'][$i][1])); \n\n            // create the relationship \n            $query = \"INSERT INTO $wpdb-&gt;term_taxonomy (term_id, taxonomy) VALUES (%d, %s)\";  \n            $wpdb-&gt;query($wpdb-&gt;prepare($query, LAST_INSERT_ID, 'post_tag'));           \n        }\n    }\n}\nelse  \n{\n    echo \"&lt;div class='error'&gt;&lt;p&gt;Invalid file or file size too big.&lt;/p&gt;&lt;/div&gt;\";\n}\n</code></pre>\n\n<p>Please check and let me know.</p>\n"},{"tags":["oracle","query","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13169095,"title":"SSRS BIDS Error when executing oracle query (This command is not supported by this provider)","body":"<p>I am creating a SSRS report which directly gets the data from oracle. </p>\n\n<p>When i run this query in the \"query designer\" then i am getting an error saying</p>\n\n<p>\"This Command is not supported by this provider\".</p>\n\n<p>I had tried using 'Oracle' and 'OLEDB' connection types but they didn't worked.</p>\n\n<p>I am using Microsoft Visual Studio 2008.</p>\n\n<p>Please advise me on this</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13169119,"title":"How to query a range of columns MYSQL","body":"<p>I have a table in MYSQL and I'd like to start querying after the first 5 columns and every column from then on. </p>\n\n<p>Is there a way I could something like</p>\n\n<pre><code> select * from table where column 5 begins  \n</code></pre>\n\n<p>Also I know that at the 5th column the headers are numbers. So it could also be something like </p>\n\n<pre><code>Select * from table where headers=[0-9]\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13168966,"title":"Structuring select statement from MySQL database","body":"<p>I have 4 tables that I am using to try and get the customer orders they are:</p>\n\n<pre><code>account\n- account_id\n- username\n\nproduct\n- product_number\n- product_name\n\ncustomer_order\n- customer_order_id\n- fk_account_id (foreign key)\n\ncustomer_order_details\n- fk_customer_order_id (foreign key)\n- fk_product_id (foreign key)    \n</code></pre>\n\n<p>This is my query... it's a bit confusing but:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT customer_order_details.fk_customer_order_id, product.product_name,\ncustomer_order_details.colour, customer_order_details.size\nFROM customer_order, customer_order_details, product, account\nWHERE customer_order.customer_order_id = \ncustomer_order_details.fk_customer_order_id\nAND customer_order_details.fk_product_id = product.product_id\nAND customer_order.fk_account_id = account.account_id\nAND account.username = 'user1'\nGROUP BY customer_order_details.fk_customer_order_id;\n</code></pre>\n\n<p>It should group by the foreign key (fk_customer_order_id) in the customer_order_details table. The results that I want are like this:</p>\n\n<pre><code>1\nMicrofleece Vest\nJacket With Hood\n\n2\nJacket With Hood\n</code></pre>\n\n<p>Instead I get something like:</p>\n\n<pre><code>1\nMicrofleece Vest\n\n2\nJacket With Hood\n</code></pre>\n\n<p>My PHP code is simply running through a while loop and printing out the product_name and fk_customer_order_id.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":13166647,"title":"Trouble Joining 3 Tables","body":"<p>I am new to writing SQL queries and have been trying to pull information from 3 different tables and link it together.  </p>\n\n<p>Data resides in Microsoft SQL Server.  </p>\n\n<p>This is my current query (which is not working the way I intend it to):  </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhpart, h.jhrev, h.jhcust, h.jhextd, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend \nFROM Jhead AS h\nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 \nORDER BY h.jhjob\n</code></pre>\n\n<p>To explain what I am trying to do.  I have a job header table <strong>Jhead</strong>, a job detail table <strong>jjops</strong> and a purchase order detail table <strong>hpodt</strong>.  I believe the job number is the primary key in the jhead table.</p>\n\n<p>Here is my problem:  As soon as I add the second left join I end up with a lot of extra lines of duplicated information. </p>\n\n<p>I have tried using the GROUP BY jhead.jhjob but get the following error: </p>\n\n<p>“Column ‘jhead.jhhold’ is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.”</p>\n\n<p>So I researched the error with one of the solutions being to make my GROUP BY look like this:\nGROUP BY jhead.jhjob, jhead.jhhold, jhead.jhpart, jhead.jhrev, jhead.jhcust, jhead.jhextd</p>\n\n<p>But then as soon as I put in jhead.jhextd I get this error:\n“The text, ntext, and image data types cannot be compared or sorted, except when using IS NULL or LIKE operator.”</p>\n\n<p>And have now hit a brick wall.  I did see that you can change the type to NVARCHAR.  I don’t really want to be sorting by the description field because it is unique and may be very taxing on the server.  Is there a better way to do this?  </p>\n\n<p><strong>Edit With Sample Data:</strong>\nI removed extra fields to simplify the query and have filtered the results for 1 job number.</p>\n\n<p>With only 1 left join:\n<img src=\"http://i.imgur.com/Gd3J5.jpg\" alt=\"With only 1 Left Join\"></p>\n\n<p>With both left joins:\n<img src=\"http://i.imgur.com/Woaog.jpg\" alt=\"Second\"></p>\n\n<p>ERP software as you can see has multiple jobs under 1 PO# and I am only interested in displaying lines with a job number that matches.\n<img src=\"http://i.imgur.com/nZzXx.jpg\" alt=\"Third\"></p>\n\n<p><strong>QUERY UPDATED</strong> </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd\nFROM Jhead AS h\nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo\nORDER BY h.jhjob\n</code></pre>\n\n<p>This is getting close to what I want.  The problem is now that my jadesc field is duplicating the first result when it should actually be different for each line.</p>\n\n<p><img src=\"http://i.imgur.com/9o7du.jpg\" alt=\"4\"></p>\n\n<p>I filtered to just display one job.  Their should only be one column.</p>\n\n<p><strong>Getting extra lines but have all the data I need</strong>  </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd, p.hdseq \nFROM Jhead AS h \nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo AND p.hdseq = o.jaseq AND o.jaopr != 'PT') \n  OR (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND o.japo = 0 AND o.jaopr != 'PT')\nORDER BY h.jhjob, o.jaseq\n</code></pre>\n"},{"tags":["sql","query","sqlite","table","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13167464,"title":"query returning consecutive rows with matching value","body":"<p>assume i have the following table:</p>\n\n<pre><code>data_point (creation_datetime DATETIME PRIMARY KEY, \n            data_point INTEGER);\n</code></pre>\n\n<p>i am looking for an SQL query that would not only tell me if the most recent entry has a data_point value of X, but how many consecutive rows after it also have X as a value.</p>\n\n<p>for instance, assuming the following data:</p>\n\n<pre><code>creation_datetime       data_point\n2012-10-31 12:00:00     0\n2012-10-31 11:55:00     0\n2012-10-31 11:50:00     0\n2012-10-31 11:45:00     2\n2012-10-31 11:40:00     0\n</code></pre>\n\n<p>if i had X=0, the number i would want back here would be 3, because the most recent value matches X, and the next 2 rows also match it.</p>\n\n<p>i don't have any ID column or anything.  i could add one if need be, but i'd like to avoid it.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13163478,"title":"Updates which include auto increment column","body":"<p>I am using PostgreSQL and I would like to update a table which would include an auto number column id. I know it might something very simple but I have done something like this;</p>\n\n<pre><code>CREATE SEQUENCE  SEQ_ID\nMINVALUE 1\nSTART WITH 1\nINCREMENT BY 1\nCACHE 10\n\nupdate trk2\nset (id, track_id, track_point) =\n           (select nextval('seq_id'), trk1.track_fid, trk1.wkb_geometry\n              from track_points_1 as trk1\n             where track_fid = 0)\n</code></pre>\n\n<p>The thing is that it is giving me the following error (<em>code reformatted</em>):</p>\n\n<pre><code>ERROR:  syntax error at or near \"select\"\nLINE 3: set (id, track_id, track_point)=(select nextval('seq_id'), t...\n</code></pre>\n\n<p>Can anybody help please?</p>\n"},{"tags":["query","grails","groovy","gorm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":34,"score":0,"question_id":13167176,"title":"Grails Query, How to get a specific field in the result?","body":"<p>I have the domain class:</p>\n\n<pre><code>class Product {\n\n    String barcode\n    String name\n    String measurement\n\n    static constraints = {\n\n    }\n}\n</code></pre>\n\n<p>Now, I want to get a list with only one field like \"name\":</p>\n\n<blockquote>\n  <p>Product.findAllByNameIlike(\"%$params.name%\",[order: \"desc\" ])</p>\n</blockquote>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13167577,"title":"SQL add month to a query without calendar table","body":"<p>I have a pretty simple table here:</p>\n\n<hr>\n\n<p><strong>Table1</strong><br>\nID<br>\nDate1<br>\nDate2<br>\nDate3  </p>\n\n<hr>\n\n<p>I want to summarize the data by month and ID so the query result comes out like this:</p>\n\n<hr>\n\n<p><strong>Query Result of table1</strong><br>\nID<br>\nMonth<br>\nCount of Date1 from the month that's not null<br>\nCount of Date2 from the month that's not null<br>\nCount of Date3 from the month that's not null    </p>\n\n<hr>\n\n<p>I currently have this query below that only pulls one month depending on what @month is specified to:</p>\n\n<pre><code>Select ID, @month as [Month]  \nSum((Case When Month(Date1)=@month then 1 else 0 END)) as [Date1 Count],   \nSum((Case When Month(Date2)=@month then 1 else 0 END)) as [Date2 Count],  \nSum((Case When Month(Date3)=@month then 1 else 0 END)) as [Date3 Count],  \nFrom Table1  \nGroup by ID \n</code></pre>\n\n<p>But I want to pull <strong>all 12 month</strong>, however the database does not have a month table or calendar table, how can I create a query that will include all 12 month for each IDs and get their corresponding monthly counts for Date1, Date2, and Date3?  Btw, a lot of the entries have one of the Dates empty, e.g. Date1 and Date3 = Null whereas Date2 = '01/01/2008'.  Thanks in advance!</p>\n"},{"tags":["php","mysql","query","phpexcel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13166502,"title":"Hardcoding headers to excel file using PHP while dynamically querying SQL","body":"<p>I have this <strong>PHPExcel</strong> code:</p>\n\n<pre><code>/** Error reporting */\nerror_reporting(E_ALL);\ndate_default_timezone_set('Europe/London');\n\n/** Include PHPExcel */\nrequire_once '../Classes/PHPExcel.php';\n    $objPHPExcel = new PHPExcel();\n    //$objPHPExcel-&gt;setActiveSheetIndex(0)\n               // -&gt;setCellValue('A1', 'Hello')\n               // -&gt;setCellValue('A2', 'world!')\n\n$row = 2; \nwhile($row_data = mysql_fetch_assoc($result)) {\n    $col = 1;\n    foreach($row_data as $key=&gt;$value) {\n$objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n$col++;\n    }\n        $row++;\n    }\n\n// Rename worksheet\n$objPHPExcel-&gt;getActiveSheet()-&gt;setTitle('Results');\n\n// Set active sheet index to the first sheet, so Excel opens this as the first sheet\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n\n// Redirect output to a client’s web browser (Excel5)\nheader('Content-Type: application/vnd.ms-excel');\nheader('Content-Disposition: attachment;filename=\"Output.xls\"');\nheader('Cache-Control: max-age=0');\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');\n$objWriter-&gt;save('php://output');\nexit;\n</code></pre>\n\n<p>Basically I am dynamically querying the database and placing it into an excel file. </p>\n\n<p>I just want to hardcode in a few headers. So for A1 I'd like to hardcode in \"Hello\" and A2: \"World!\" while querying the database and putting the data starting in Column B</p>\n"},{"tags":["android","query","sqlite","date","sql-order-by"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13166445,"title":"SQLITE DB sort query by string formatted date field","body":"<p>I have a SQLITE DB with a string field which contains a date in the following format: \"01.01.2012\".\nWhat I want is to sort the by this string formatted date in a query.\nI tried this without success:</p>\n\n<pre><code>SELECT * FROM fahrer, fahrzeuge, nutzungsarten, fahrtenbuch WHERE fahrtenbuch.nutzungsart_id = nutzungsarten._id AND fahrtenbuch.fahrzeuge_id = fahrzeuge._id AND fahrtenbuch.fahrer_id = fahrer._id ORDER BY strftime ('%d.%m.%Y', fahrtenbuch.startdatum)\n</code></pre>\n\n<p>What I am doing wrong?</p>\n"},{"tags":["php","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13121436,"title":"add an onChange function to this dynamically populated select field to echo result to a textfield","body":"<p>I checked the boards and Googled for this code but couldn't find anything.  Any help would be greatly appreciated.  </p>\n\n<p>I have worked through a tutorial that queries a database for a car model based on the car make.  In the code, the car make is hardcoded to the select while the car model is dynamic.  Here's the first part of the code: </p>\n\n<pre><code>    &lt;?php \n    require_once(\"Connections/xxx.php\"); // database connection\n\n    $make = $_POST['make'];\n\n\n    if ($make){\n    $query= sprintf(\"SELECT * FROM car_model where car_model_id='$make'\");\n    $result = @mysql_query($query); \n    $rowModel = mysql_fetch_array($result);\n    }\n    ?&gt;\n</code></pre>\n\n<p>Here's the select hard code:</p>\n\n<pre><code>&lt;select name=\"make\" onChange=\"document.forms[0].submit()\"&gt;\n&lt;option value=\"\"&gt;Select Make&lt;/option&gt;\n&lt;option value=\"1\" &lt;?php if(!(strcmp(1, $make))){echo \"selected\";}?&gt;&gt;Alfa Romeo&lt;/option&gt;\n&lt;option value=\"2\" &lt;?php if(!(strcmp(2, $make))){echo \"selected\";}?&gt;&gt;Audi&lt;/option&gt;\n&lt;option value=\"3\" &lt;?php if(!(strcmp(3, $make))){echo \"selected\";}?&gt;&gt;BMW&lt;/option&gt;\n&lt;option value=\"4\" &lt;?php if(!(strcmp(4, $make))){echo \"selected\";}?&gt;&gt;Citroen&lt;/option&gt;\n</code></pre>\n\n<p></p>\n\n<p>And this is the dynamically populated select:</p>\n\n<pre><code> &lt;select name=\"model\"&gt;\n&lt;option value=\"\"&gt;Select Model&lt;/option&gt;\n&lt;?php do {  ?&gt;\n&lt;option value=\"&lt;?php echo $rowModel['car_model_id']; ?&gt;\"&gt;&lt;?php echo $rowModel['car_model']; ?&gt;&lt;/option&gt;\n&lt;?php  }while ($rowModel = mysql_fetch_array($result));  ?&gt;\n</code></pre>\n\n<p></p>\n\n<p>I would like to add an onChange function to this dynamically populated select field to echo result to a textfield and I have tried many combinations but haven't been able to figure this out.  Thank you      </p>\n"},{"tags":["sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13166566,"title":"sql how to write complicated query for noob?","body":"<p>Here is my tables</p>\n\n<pre><code> Student (sname, sid, gpa, level, deptno) \n Course (cno, cname, deptno, units) \n Dept (dname, deptno) \n Takes (sid, cno) \n</code></pre>\n\n<p>Write a SQL query that returns the names (i.e., snames) of students who have taken \nmore courses outside their department than inside their department.you can \nassume that all students in the database have taken at least one course inside their department.</p>\n\n<p>I am not looking for any solutions for this question, but still welcome for any answer.\nBut I more hoping people can tell me how to generate the steps to write a complicated query like this..</p>\n\n<p>My answer is </p>\n\n<pre><code> Select S.sname\n From Student S, Course C, Dept D, Takes T\n Where T.cno=C.cno and D.deptno=C.deptno and S.sid = T.sid\n Having COUNT(S.deptno=C.deptno) &gt; COUNT( S.deptno != C.deptno)\n</code></pre>\n\n<p>I am not sure I can use the count after HAVING in this way or not .\nThanks</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13165703,"title":"SQL update table data query","body":"<p>I want to run update query to update PercentAvailability column value 0 to 100 between specified date period in my case <code>2012-10-28 03:31:01 to 2012-10-28 08:31:01</code>. see following picture.</p>\n\n<p><img src=\"http://i.stack.imgur.com/HQdGV.png\" alt=\"enter image description here\"></p>\n\n<p>How do i run query to update above data between specified date?</p>\n\n<p>Note: I have many ApplicationID which has this issue so how could i run query against all ApplicationID, I believe we need to run JOIN syntax but it would be good if you give some short of hint. </p>\n"},{"tags":["sql","linq","query"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1479,"score":5,"question_id":6190620,"title":"how to convert linq query to sql","body":"<p>Just trying to get the sql that is generated by a linq query.</p>\n"},{"tags":["sql","sql-server","query","insert","where-in"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13165550,"title":"where in sql server query update number list one field to another","body":"<p>I am using SQL Server, and in the query below, I have a concern.  I am not sure if the field on the left will update with the field on the right (coming from the same table) when I do a where in list.</p>\n\n<pre><code>update loc \nset locShortName = locName \nwhere locid in (3,4,11,13,14,15,16,18,19,20,21,24,32,41,45,68,69,77,82,85)\n\nupdate loc set locShortName = locName where locid = 3 (move to next record in the list)      \nupdate loc set locShortName = locName where locid = 4 (move to next record in the list)\nupdate loc set locShortName = locName where locid = 11(move to next record in the list)\n</code></pre>\n\n<p>and so on...</p>\n\n<p>I would think it would take the fist number in the list and address the field value setting, then move to the next in the list.</p>\n\n<p>Are my expectations correct?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","database","wordpress","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13159382,"title":"how can I add same value in two different tables","body":"<p>i m trying to add custom list of tags using excel file and I have done most of the work. but i am confused that how can I add same value in 2 different tables columns.</p>\n\n<p>i had inserted the values in </p>\n\n<pre><code>INSERT INTO `steve`.`wp_terms` (`term_id`, `name`, `slug`, `term_group`) VALUES (NULL, 'tag99', 'tag99', '0');\n</code></pre>\n\n<p>and </p>\n\n<pre><code>INSERT INTO `steve`.`wp_term_taxonomy` (`term_taxonomy_id`, `term_id`, `taxonomy`, `description`, `parent`, `count`) VALUES (NULL, '21', 'post_tag', '', '0', '0');\n</code></pre>\n\n<p>now i want to add term_id in both table .. could somebody tell me how can i do that?</p>\n\n<p>AND <code>term_id</code> is database generated value.</p>\n"},{"tags":["android","database","query","sms","contact"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13165469,"title":"Android: get all SMS from contact","body":"<p>I'm trying to get all SMS from all contacts.</p>\n\n<p>The problem is when I query database, same (bat not the same) number isn't recognized as a single entity. For example (IT international prefix is +39):\n    +39123456789\n    123456789\n    123 456 789\n    123-456-789</p>\n\n<p>This is 4 versions of same number, but database don't recognize equality.\nSo, how can I retrieve all SMS from contact number? Number of versions are virtually infinite, but all applications I founded in market haven't same issue.</p>\n\n<p>Any idea to get all SMS from address number in all versions?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":48,"score":-2,"question_id":13163955,"title":"Find row which has unique values with respect to some of its columns","body":"<p>My SQL table is something like this:</p>\n\n<pre><code>id, name, value1, value2, value3, value4\n1, xyz, 1, 2, 4, 1\n2, xyz, 4, 2, 4, 1\n3, abc, 4, 2, 4, 1\n4, abc, 4, 2, 2, 1\n5, abc, 4, 2, 2, 1\n</code></pre>\n\n<p>I want to write a Sql query which returns rows which has <strong>any</strong> of their values (read: value1,value2,value3,value4) changed. So the result output would be:</p>\n\n<pre><code>id, name, value1, value2, value3, value4\n1, xyz, 1, 2, 4, 1\n2, xyz, 4, 2, 4, 1\n4, abc, 4, 2, 2, 1\n</code></pre>\n\n<p>I understand, if I just needed values in output I could have used Distinct or Group by like:</p>\n\n<pre><code>select distinct value1,value2,value3,value4 from table;\n</code></pre>\n\n<p>But, here I need id and name columns too in output.</p>\n\n<p>Wondering if I really need to write a subquery or create virtual/inner table to get my result. Or, there is a smarter way?</p>\n\n<p>My question is not similar to <a href=\"http://stackoverflow.com/questions/6941049/how-to-find-out-whether-a-table-has-some-unique-columns\">How to find out whether a table has some unique columns</a>. Let me know if you think otherwise, I can clarify.</p>\n"},{"tags":["ruby","query","mongodb","mongoid3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13163897,"title":"How to find all and sort by count?","body":"<p>How to build a query that returns all entities sorted desc by count embedded post ids?</p>\n\n<p>Sample data:</p>\n\n<pre><code>{ \"_id\" : ObjectId( \"5090f8061e7bf28095000012\" ),\n  \"name\" : \"test\",\n  \"post_ids\" : \n    [ ObjectId( \"5090f8061e7bf28095000010\" ) ],\n    [ ObjectId( \"5090f8061e7bf28095000011\" ) ] },\n{ \"_id\" : ObjectId( \"5090f8061e7bf28095000012\" ),\n  \"name\" : \"test2\",\n  \"post_ids\" : [ \n    ObjectId( \"5090f8061e7bf28095000010\" ), \n    ObjectId( \"509104ec1e7bf2989b00000b\" ), \n    ObjectId( \"509105001e7bf2989b00000f\" ) ] }\n\n#my actual query returns only count:\ntags_by_count = Tag.desc(:post_ids).count\n</code></pre>\n"},{"tags":["php","sql","query","duplicates","ignore"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13163474,"title":"Do Not Duplicate VALUE if already exist on MySQL","body":"<p>I've been trying to accomplish this, but as other issues I just can't figured it out. I've been reading around for posibles solutions but non of them goes along with my code, or if they do I can't figure out how or where to use them.</p>\n\n<p>I have a DB where a user sends records. The database consist in few tables containing the Following \"<strong>Name, Lastname, Phone</strong>\". If any of this values is duplicate,  I would like my code to identify and <strong>Ignore</strong> the submission of the Form <strong>if ALL this VALUES already exist on the DB</strong>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>        &lt;?php\n\n        $con = mysql_connect(\"HOST\",\"USER\",\"PASS\");\n        if (!$con)\n          {\n          die('Could not connect: ' . mysql_error());\n          }\n\n        mysql_select_db(\"testdb\", $con);\n        $sql=\"INSERT INTO people (Name, LastName, Phone)\n        VALUES\n        ('$_POST[Name]','$_POST[LastName]','$_POST[Phone]')\";\n\n        if (!mysql_query($sql,$con))\n          {\n          die('Error: ' . mysql_error());\n          }\n\n        echo \"Record Added\";\n\n        mysql_close($con);\n        ?&gt;\n</code></pre>\n\n<p>Like I said, I've tried may ways but can't figure it out yet, I'm starting to learn, so excuse me if is something very simple. Thanks a lot everyone!!</p>\n"},{"tags":["query","tornado","unbound"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13163370,"title":"Array empty or not. How to choose to render with Tornado the page","body":"<p>In an handler of Tornado web server I have this code:</p>\n\n<pre><code>.........\n\n# Retrieve the sensors \n    sens = self.db.query(\"SELECT * FROM devices \\\n                          WHERE network_id=%s\", nid)\n    self.unlock_tables()\n..............\n# Render the networks page\n    self.render(\"sensors.html\", sensors=sens, perms=perms, net=net, action=action, writeable=writeable, sens_config=sens_config, users=user)\n..........\n</code></pre>\n\n<p>Now in the html page I have a part of code like this:</p>\n\n<pre><code> {% for sens in sensors %}\n .............\n {% end %}\n</code></pre>\n\n<p>But obviously when I have some sensors and then I delete them, after the last sensor delete I obtain this error:</p>\n\n<p><em>UnboundLocalError: local variable 'sens' referenced before assignment</em></p>\n\n<p>because the sens array in Tornado is empty I think.</p>\n\n<p>If I put the if...end block in a {% if sensors %}...{% end %} block is the same because the page didn't recognize at the same time the variable sens.</p>\n\n<p>How can I exclude the part in the if...end statement if the query result sens is empty?</p>\n\n<p>Thank you very much.</p>\n"},{"tags":["sql-server","database","query","table","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13159879,"title":"SQL Select Data","body":"<p>I have a table set up, it is a customers' repayment schedule for a product.</p>\n\n<p>My table consists of the following fields:</p>\n\n<blockquote>\n  <p>SaleID | PaymentDueDate | AmountDue</p>\n</blockquote>\n\n<p>What I need for each Sale is:</p>\n\n<blockquote>\n  <p>SaleID | FirstPaymentDate | FirstPaymentValue | RegularPaymentValue | FinalPaymentvalue</p>\n</blockquote>\n\n<p>Each repayment schedule has the following characteristics:</p>\n\n<p>First payment amount is defined by the customer.\nRegular and final payments are dictated by the balance remaining.</p>\n\n<p>e.g</p>\n\n<p>Sale = £200\nTerm = 14 Weeks (14 Payments)</p>\n\n<p>First Payment = £50 (x1)</p>\n\n<p>Regular Payment = £12 (x12)</p>\n\n<p>Final Payment = £6 (x1)</p>\n\n<p>Please can you advise how I can retrieve what I need.</p>\n\n<p>ADDITION:\nCode So Far:</p>\n\n<p>This is what I have achieved so far, but this only gets me the First Payment and First Payment Date for each Sale:</p>\n\n<pre><code>SELECT      \nFP.SaleID, FP.FirstPaymentDate, RS.AmountDue AS FirstPayment \nFROM    \n(       \nSELECT SaleID, MIN(PaymentDueDate)AS FirstPaymentDate       \nFROM RepaymentSchedule          \nGROUP BY SaleID     \n) AS FP \nLEFT OUTER JOIN\nRepaymentSchedule AS RS ON FP.SaleID = RS.SaleID AND FP.FirstPaymentDate =   RS.PaymentDueDate ORDER BY RS.SaleID\n</code></pre>\n\n<p>ADDITION:\nData Sample:\n£280 over 14 Weeks</p>\n\n<pre><code>SaleID  PaymentDueDate            AmountDue\n41      2012-08-29 00:00:00.000   120.00\n41      2012-09-05 00:00:00.000   12.30\n41      2012-09-12 00:00:00.000   12.30\n41      2012-09-19 00:00:00.000   12.30\n41      2012-09-26 00:00:00.000   12.30\n41      2012-10-03 00:00:00.000   12.30\n41      2012-10-10 00:00:00.000   12.30\n41      2012-10-17 00:00:00.000   12.30\n41      2012-10-24 00:00:00.000   12.30\n41      2012-10-31 00:00:00.000   12.30\n41      2012-11-07 00:00:00.000   12.30\n41      2012-11-14 00:00:00.000   12.30\n41      2012-11-21 00:00:00.000   12.30\n41      2012-11-28 00:00:00.000   12.40\n</code></pre>\n\n<p>I guess the FinalPaymentValue is not too crucial.</p>\n\n<p>Really I just need to know how to work out what the regular payment is.</p>\n"},{"tags":["linq","query","exception","table","datacontext"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":911,"score":1,"question_id":4414523,"title":"LINQ Exception: \"Queries with local collections are not supported.\" but not using a local collection","body":"<p>Using the AdventureWorks database's Products table as the example, I have created a DBML and extended the properties of the DataContext to include a new property:</p>\n\n<pre>\npartial class AdventureWorksDataContext\n{\n  public IQueryable&lt;Product&gt; FinishedProducts\n  {\n    get { return Products.Where(p => p.FinishedGoodsFlag); }\n  }\n}\n</pre>\n\n<p>The Products property is part of the generated DataContext and all I've done is add a Where from the Table&lt;Product&gt; so it returns an IQueryable.</p>\n\n<p>Now, the problem comes in when trying to query it like this (dumb example but one that should show the problem):</p>\n\n<p><code>var queryFinishedProducts = datacontext.FinishedProducts.Where(fp =&gt; fp.ProductID == datacontext.FinishedProducts.Max(p =&gt; p.ProductID));</code></p>\n\n<p>Iterating this query results in \"Queries with local collections are not supported\" exception. I don't understand why it would throw that error when there are no local collections being used. If I run it against the normal Products table (which is a <code>Table&lt;Product&gt;</code>):</p>\n\n<p><code>var queryProducts = datacontext.FinishedProducts.Where(fp =&gt; fp.ProductID == datacontext.Products.Max(p =&gt; p.ProductID));</code></p>\n\n<p>...it works fine. The only difference is that I added a Where to the <code>Table&lt;Product&gt;</code> and returned it as an <code>IQueryable&lt;Product&gt;</code>.</p>\n\n<p>Anyone have any ideas? TIA</p>\n"},{"tags":["php","mysql","query","execute","page-refresh"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13160927,"title":"PHP include mysql query, use header to prevent query re-execution, but where to echo out the notifications?","body":"<p>My code when F5 re-executes a query:</p>\n\n<pre><code>if (isset($_POST['addnewproject']) )\n{\n    include(\"query/pm_addnewproject.php\");\n    echo $emailnotificationmessage;\n}\n</code></pre>\n\n<p>To prevent query re-execution after pressing F5 or page reload I have to modify a header and place it in the first rules (before any output) of the .php page. So:</p>\n\n<pre><code>    if (isset($_POST['addnewproject']) ) \n    {\n        include(\"query/pm_addnewproject.php\");\n        header(\"Location:pm_configureaccounting.php?edit=$_SESSION[accidsession]\");\n\n        echo $emailnotificationmessage; exit();\n\n    }\n</code></pre>\n\n<p>Because of the header, I now lose the $emailnotificationmessage I wanted to echo out somewhere middle of the page.</p>\n\n<p>What's the best thing to do now when I want to still echo this out?</p>\n\n<p>Now I changed the $emailnotificationmessages to $_SESSION['emailnotificationmessage'] and echo it out where I want it.</p>\n\n<p>But I need to unset this session too, else it keeps showing the user.</p>\n\n<p>So when I place <code>echo $_SESSION['bla']</code> somewhere middle of the page, it has a value there. It works. But I need to clear it after so when the user visits again, it wont show any message unless project is added again. So I place <code>$_SESSION['bla'] = \"\";</code> at the end of the page, and still, this SESSION gets the value <code>\"\"</code> ?! How is this possible? </p>\n"},{"tags":["mysql","database","query","constraints","unique"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13158079,"title":"How to add a constraint on all the columns of a table in a single query?","body":"<p>I have a database named dbapp. I need to add the constraint 'NOT NULL' to all the columns of all the tables in this database. I am unable to form this query. Even if I am able to perform it individually on each table, it would be fine. Please help.</p>\n"},{"tags":["sql","oracle","query","isqlquery"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13062683,"title":"Oracle SQL compare strings containing numbers, starting with 0 (zero)","body":"<p>I have a Date column, which is actually not in a date format.\nThe date looks like: <code>25/10/2012</code>.\nNow I have to compare 2 dates, but I cant find a pattern to do this, as the format is wrong.</p>\n\n<p>What I have tried is: </p>\n\n<pre><code> SELECT * \n   from PARAMETER\n  where NAME like 'Date_To' and SUBSTR(VALUE, 1, 2)&lt;'25' \n    and SUBSTR(VALUE, 1, 2)&gt;'05'\n</code></pre>\n\n<p>The problem I am facing is that this part: <code>SUBSTR(PA_VALUE, 1, 2)&gt;'05'</code> is not working as there is a 0(zero) infront of the number. Are there any solutions?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13159966,"title":"mysql timestamp in between query","body":"<p>In the below i have a table1,table2 ,i am stuck with a query.I want find the timestamps in table2 which are in between two consecutive timestamps of table1 .How to form this query.</p>\n\n<p>table1:</p>\n\n<pre><code>   id    timestamp\n    1    2012-08-15 01:11:11\n    1    2012-08-15 01:11:14\n    1    2012-08-15 01:11:16 \n    2    2012-08-15 01:22:11\n    2    2012-08-15 01:32:11\n    2    2012-08-15 01:33:11\n    2    2012-08-15 01:36:11\n</code></pre>\n\n<p>table 2: </p>\n\n<pre><code>   id    timestamp\n    1    2012-08-15 01:11:12\n    1    2012-08-15 01:11:15\n    1    2012-08-15 01:11:16 \n    2    2012-08-15 01:23:55\n    2    2012-08-15 01:26:11\n    2    2012-08-15 01:34:11\n    2    2012-08-15 01:36:01\n</code></pre>\n\n<p>Desired output:Get all rows of table2 which are in between the timestamps of table1 and if possible output timestamp of table1 also</p>\n"},{"tags":["java","query","hibernate","collate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13160476,"title":"How I should use COLLATE in Hibernate Query","body":"<p>I'am trying to use COLLATE statment in a Hibernate SQL query but, it doesn't reconise the statment.</p>\n\n<pre><code>CONSULTA: FROM Articulos WHERE activo=0 and (codigodearticulo like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI' or descripcion like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI'  or descripcionadicional like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI' ) and codigodelinea in (select CODIGODELINEA from Lineas where CATAUTOPARTES='1')\n</code></pre>\n\n<p>And when app compile, Hibernate return this exception :</p>\n\n<pre><code>- line 1:107: unexpected token: COLLATE\n- line 1:107: unexpected token: COLLATE\n- line 1:107: unexpected token: COLLATE\n- Error hibernate: unexpected token: COLLATE near line 1, column 107\n</code></pre>\n\n<p>I can't find the problem, in mi MSSQL Server it works fine.</p>\n\n<p>Thanks you!</p>\n"},{"tags":["sql","query","ms-access","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13158913,"title":"Concatenate 2 rows in a complex SQL query","body":"<p>I'm using MS-Access 2003 with the query creator. I select everything from one table (<code>FaitsSaillants</code>), then one specific row (<code>WHERE VARIABLE='TitreMandat'</code>) from another table (<code>tb_SOMMAIRE</code>). I want to select another row from that second table and concatenate it.</p>\n\n<h2>The query</h2>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS\n    [CurrAxe] Text ( 255 ), [CurrOTP] Text ( 255 ),\n    [CurrClient] Text ( 255 ), [StartDate] DateTime, [EndDate] DateTime;\nSELECT \n    tb_SOMMAIRE.Valeur AS Projet, tb_SOMMAIRE.VARIABLE, *\nFROM\n    (FaitsSaillants\n     LEFT JOIN Employes\n         ON FaitsSaillants.Utilisateur = Employes.CIP)\n    INNER JOIN tb_SOMMAIRE\n        ON FaitsSaillants.OTP = tb_SOMMAIRE.OTP\nWHERE\n    (((FaitsSaillants.OTP)=[CurrOTP]) AND \n     ((FaitsSaillants.Client) Like [CurrClient]) AND\n     ((FaitsSaillants.Axe) Like [CurrAxe]) AND\n     ((DateValue([DateInsertion]))&gt;=[StartDate] AND\n      (DateValue([DateInsertion]))&lt;=[EndDate]) AND\n     ((tb_SOMMAIRE.VARIABLE)='TitreMandat'))\nORDER BY\n    FaitsSaillants.DateInsertion DESC;\n</code></pre>\n\n<p>This query does add the <code>tb_SOMMAIRE.Valeur</code> field where the IDs (<code>OTP</code> field) match and where <code>tb_SOMMAIRE.VARIABLE='TitreMandat'</code>. It works like a charm. However, I want to add another row to the <code>tb_SOMMAIRE</code> results. I would like to get the row where <code>VARIABLE='TitreMandat'</code> (that part is actually working) and the row where <code>VARIABLE='NomInstallation'</code>. I will get 2 rows and I want those 2 rows to be concatenated and displayed when I ask for <code>Projet</code> (<code>tb_SOMMAIRE.Value as Projet</code>). Both rows' <code>OTP</code> (IDs) are the same as the one selected in <code>FaitsSaillants</code>.</p>\n\n<p>Sorry if it's in French.</p>\n\n<h2>Tables' structure</h2>\n\n<p>FaitsSaillants</p>\n\n<blockquote>\n<pre><code>Index AutoNumber\nProjet Text\nAxe Text\nClient Text\nOTP Text\nFaitSaillant Memo\nDateInsertion Date\nUtilisateur Text\n</code></pre>\n</blockquote>\n\n<p>tb_SOMMAIRE</p>\n\n<blockquote>\n<pre><code>OTP Text\nVARIABLE Text\nValeur Text\n</code></pre>\n</blockquote>\n\n<h2>Data example</h2>\n\n<p>tb_SOMMAIRE</p>\n\n<blockquote>\n<pre><code>OTP   VARIABLE        Valeur\nUGPSW NomInstallation PosteNemiscau\nUGPSW TitreMandat     oscilloperturbographe\nUGPSW RespIng         CU9656\nGWIHK NomInstallation AnotherInstallation\nGWIHK TitreMandat     Anytitle\nGWIHK Responsable     ImportantPerson\n</code></pre>\n</blockquote>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13152556,"title":"sql server queries related to case statement","body":"<p>My query like this</p>\n\n<p>case when statement1 = statement2 then offer1</p>\n\n<p>if offer1 is have value means  then i need to display offer1 value will be 'Yes'</p>\n\n<p>How to  write the query for this?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1298,"score":0,"question_id":11801911,"title":"Insert multiple rows into single column","body":"<p>I'm new to SQL, (using SQL 2008 R2) and I am having trouble inserting multiple rows into a single column.</p>\n\n<p>I have a table named <code>Data</code> and this is what I am trying</p>\n\n<pre><code>INSERT INTO Data ( Col1 ) VALUES\n('Hello', 'World')\n</code></pre>\n\n<p>That code was taken from <a href=\"http://stackoverflow.com/questions/452859/inserting-multiple-rows-in-a-single-sql-query\">this</a> question, but it, like many other examples I have found on the web uses 2 columns, I just want to use 1. What am I doing wrong?</p>\n\n<p>Thanks</p>\n"},{"tags":["query","sdk","rally","pie-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13151762,"title":"Rally SDK: creating pie chart using a query as an attribute","body":"<p>I have been trying to create pie chart using rally sdk with the following piece of code:</p>\n\n<pre><code>    &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Pie Chart Example&lt;/title&gt;\n &lt;meta name=\"Name\" content=\"Component Example: Pie Chart\" /&gt;\n &lt;meta name=\"Version\" content=\"1.32\" /&gt;\n &lt;meta name=\"Vendor\" content=\"Rally Software\" /&gt;\n &lt;script type=\"text/javascript\" src=\"/apps/1.32/sdk.js\"&gt;&lt;/script&gt;\n &lt;script type=\"text/javascript\"&gt;\n\n function showPie() {\n\n   var rallyDataSource = new rally.sdk.data.RallyDataSource('__WORKSPACE_OID__',\n                           '__PROJECT_OID__',\n                           '__PROJECT_SCOPING_UP__',\n                           '__PROJECT_SCOPING_DOWN__');\n   var pieConfig = {\n        type : \"TestCaseResult\",\n       attribute: \"Verdict\",\n        query: 'TestSet.Name=\"Alpha\"'\n     };\n   var pieChart = new rally.sdk.ui.PieChart(pieConfig, rallyDataSource);\n   pieChart.display(\"pieChartDiv\");\n }\n\n rally.addOnLoad(showPie);\n &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n   &lt;div id=\"pieChartDiv\" style=\"height:225px; width:250px\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n\n<p>This isn't working. it says \"no data\" in place of the pie chart. But if I remove the following line...</p>\n\n<pre><code>query: 'TestSet.Name=\"Alpha\"'\n</code></pre>\n\n<p>...then i see the piechart but that's for all testcaseresults in the project. I need to create pie chart for testcaseresults from a specific testset only. How do I accomplish that? Thank you. </p>\n"},{"tags":["oracle","query","xmltype"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13159126,"title":"Split up query results after loading XML with fn:string-join in an Oracle table","body":"<p>I've loaded a few XML files into an Oracle database (11gr2 on Linux x64) and I had to use a fn:string-join to succesfully import the xml files which contain multiple records.</p>\n\n<p>After the data has landed/has been imported to an XMLTYPE table using SQL*LOADER, i've issued a query which transports the XML data from the XMLTYPE table to a regular table, lets call that one Table_A </p>\n\n<p>This table now contains all fields of the imported records (2 records in this case) together in the target fields, so for instance.</p>\n\n<p>The xml file contains an entry for computer_brand and the first record has the value 'Dell' and the second record has got the value 'Apple'.\nNow the two records from the XML file have been select/inserted in to Table_A but are in the same field, separated by a semi-colon.\nField name: computer_brand\nValues: Dell;Apple</p>\n\n<p>What I'd like to do is select the separate values from the table (regardless from the number of different values in the field, since this query needs to run from a scheduled job) and pass them through to insert all the values in their own separate fields.</p>\n\n<hr>\n\n<p>Here's an example of the things i've made/used:</p>\n\n<hr>\n\n<p>Table_A metadata:</p>\n\n<pre><code>CREATE TABLE table_a\n(\ncomputer_brand                           varchar2(41),\nowner                                    varchar2(101),\naddress                                  varchar2(101),\nserialnumber                             varchar2(21)\n)\n</code></pre>\n\n<p>I've selected and inserted the data imported from the xmltype table into Table_A with the following query:</p>\n\n<pre><code>insert into table_a\n(computer_brand,\n owner,\n address,\n serialnumber\n)\nselect\n a.computer_brand,\n a.owner,\n a.address,\n a.serialnumber\nfrom table_xml a,\n xmltable (xmlnamespaces('not mentioned due to security reasons' as \"tns\"),\n '//tns:Main' passing a.xml_file\n columns\n computer_brand      varchar2(41)  path 'fn:string-join(tns:/@computer_brand,\";\")',\n owner               varchar2(101) path 'fn:string-join(tns:/@owner,\";\")',\n address             varchar2(101) path 'fn:string-join(tns:/@address,\";\")',\n serialnumber        varchar2(21)  path 'fn:string-join(tns:/serialnumber,\";\")')\n(+) k\nwhere upper(file_name)=upper('xmlfile.xml');\n</code></pre>\n\n<p>The output for the above query is:</p>\n\n<pre><code>computer_brand\n--------------\ndell;apple\n\nowner\n--------------\npete;jack\n\naddress\n--------------\nbasement;attic\n\nserialnumber\n--------------\n123444;456555\n</code></pre>\n\n<p>Enormous thanks in advance if someone would know how to and help out? I was looking at <code>SUBSTR()</code> didn't really manage to fix it..</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13141181,"title":"Select from 2 tables with a left join","body":"<p>Here is probably an easy one if your used to SQL, which I'm not.</p>\n\n<p>I have this query:</p>\n\n<pre><code>SELECT * \nFROM myTable \nLEFT JOIN anotherTable \n    ON myTable.myField=anotherTable.anotherField\n</code></pre>\n\n<p>Actually, this query returns everything from myTable which meets the <em>join condition</em> (as far as my comprehension goes). This query works great, but I would like to select another field from another table. What I would like to do is something like this:</p>\n\n<pre><code>SELECT myTable.*, myTable2.aSpecificField \nFROM myTable, myTable2 \nLEFT JOIN anotherTable \n    ON myTable.myField=anotherTable.anotherField \nWHERE myTable.id = myTable2.id\n</code></pre>\n\n<p>However, this doesn't work, I get an error message about the <em>LEFT JOIN</em>. I would like the aSpecificField from myTable2 to be added to the rows where the ID of both tables match.</p>\n\n<p>Can you help me building this query correctly? Thank you.</p>\n"},{"tags":["php","query","url","seo","seo-friendly"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":43,"score":5,"question_id":13157673,"title":"arabic query string - url did not stored and displayed","body":"<p>I'm trying to make my links SEO friendly by addingdate and title. However, I some of the titles are in Arabic. The English ones work great, while the Arabic ones doesn't. Example:</p>\n\n<blockquote>\n  <p>خالد-على-20120923220529.html</p>\n</blockquote>\n\n<p>Following <a href=\"http://www.9lessons.info/2011/04/seo-friendly-urls-with-php.html\" rel=\"nofollow\">this tutorial</a>, I've produced this code:</p>\n\n<pre><code>$title=mysql_real_escape_string($_POST['title']);\n</code></pre>\n\n<p>i have error with insert title and URL didn't insert with Arabic character\nand when removing this code inserting done no problem but when select this url from database will redirect not found 404 \ni need t display my links </p>\n\n<blockquote>\n  <p><a href=\"http://dzeduc.org/%D8%A7%D9%84%D9%85%D8%B9%D8%A7%D8%AF%D9%84%D8%A7%D8%AA-%D9%88-%D8%A7%D9%84%D9%85%D8%AA%D8%B1%D8%A7%D8%AC%D8%AD%D8%A7%D8%AA-%D9%85%D9%86-%D8%A7%D9%84%D8%AF%D8%B1%D8%AC%D8%A9-1%D9%882/\" rel=\"nofollow\">http://dzeduc.org/%D8%A7%D9%84%D9%85%D8%B9%D8%A7%D8%AF%D9%84%D8%A7%D8%AA-%D9%88-%D8%A7%D9%84%D9%85%D8%AA%D8%B1%D8%A7%D8%AC%D8%AD%D8%A7%D8%AA-%D9%85%D9%86-%D8%A7%D9%84%D8%AF%D8%B1%D8%AC%D8%A9-1%D9%882/</a></p>\n</blockquote>\n\n<p>How can i resolve this problem?</p>\n\n<p>Note </p>\n\n<pre><code>$conn = mysql_connect($db_host,$db_user,$db_pass) or die(mysql_error());\nmysql_select_db($db_name,$conn);\n\nmysql_query(\"SET NAMES 'utf8'\");\nmysql_query('SET CHARACTER SET utf8'); \n</code></pre>\n\n<p>Meta Tags </p>\n\n<pre><code>&lt;meta charset=\"UTF-8\" /&gt;\n&lt;meta http-equiv=\"content-type\" content=\"application/xhtml+xml; charset=UTF-8\" /&gt; \n</code></pre>\n"},{"tags":["query","configuration","nosql","cassandra","oom"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13144232,"title":"Big Cassandra query causes daemon to crush","body":"<p>There is a need to read ~2.5Gb of records from cassandra 1.1.6 database running on CentOS release 6.3 virtual machine. When daemon with default out-of-the-box configuration is queried, i get error :</p>\n\n<pre><code> INFO [Thread-2] 2012-10-30 20:05:13,345 CassandraDaemon.java (line 212) Listening for thrift clients...\n WARN [ScheduledTasks:1] 2012-10-30 20:06:27,076 GCInspector.java (line 145) Heap is 0.8434091049049706 full.  You may need to reduce memtable and/or\n WARN [ScheduledTasks:1] 2012-10-30 20:06:27,077 StorageService.java (line 2855) Flushing CFS(Keyspace='system', ColumnFamily='Versions') to relieve m\n INFO [ScheduledTasks:1] 2012-10-30 20:06:27,077 ColumnFamilyStore.java (line 659) Enqueuing flush of Memtable-Versions@1970754472(83/103 serialized/l\n INFO [FlushWriter:2] 2012-10-30 20:06:27,078 Memtable.java (line 264) Writing Memtable-Versions@1970754472(83/103 serialized/live bytes, 3 ops)\n INFO [FlushWriter:2] 2012-10-30 20:06:27,096 Memtable.java (line 305) Completed flushing /var/lib/cassandra/data/system/Versions/system-Versions-hf-1\n WARN [ScheduledTasks:1] 2012-10-30 20:06:28,793 GCInspector.java (line 139) Heap is 0.9390217139392345 full.  You may need to reduce memtable and/or\n WARN [ScheduledTasks:1] 2012-10-30 20:06:28,794 AutoSavingCache.java (line 156) Reducing KeyCache capacity from 2075306 to 12 to reduce memory pressu\n WARN [ScheduledTasks:1] 2012-10-30 20:06:28,794 GCInspector.java (line 145) Heap is 0.9390217139392345 full.  You may need to reduce memtable and/or\n INFO [ScheduledTasks:1] 2012-10-30 20:06:28,795 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families\n WARN [ScheduledTasks:1] 2012-10-30 20:06:30,181 GCInspector.java (line 145) Heap is 0.9984246325381808 full.  You may need to reduce memtable and/or\n INFO [ScheduledTasks:1] 2012-10-30 20:06:30,182 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families\n WARN [ScheduledTasks:1] 2012-10-30 20:06:34,740 GCInspector.java (line 145) Heap is 0.9983338780063149 full.  You may need to reduce memtable and/or\n INFO [ScheduledTasks:1] 2012-10-30 20:06:34,741 StorageService.java (line 2851) Unable to reduce heap usage since there are no dirty column families\nERROR [ReadStage:33] 2012-10-30 20:06:34,843 AbstractCassandraDaemon.java (line 135) Exception in thread Thread[ReadStage:33,5,main]\njava.lang.OutOfMemoryError: Java heap space\n&lt;------&gt;at org.apache.cassandra.io.util.RandomAccessReader.readBytes(RandomAccessReader.java:323)\n&lt;------&gt;at org.apache.cassandra.utils.ByteBufferUtil.read(ByteBufferUtil.java:398)\n&lt;------&gt;at org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:363)\n&lt;------&gt;at org.apache.cassandra.db.ColumnSerializer.deserialize(ColumnSerializer.java:120)\n&lt;------&gt;at org.apache.cassandra.io.util.ColumnIterator.deserializeNext(ColumnSortedMap.java:255)\n&lt;------&gt;at org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:275)\n&lt;------&gt;at org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:232)\n&lt;------&gt;at edu.stanford.ppl.concurrent.SnapTreeMap.&lt;init&gt;(SnapTreeMap.java:453)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns$Holder.&lt;init&gt;(AtomicSortedColumns.java:311)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns.&lt;init&gt;(AtomicSortedColumns.java:77)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns.&lt;init&gt;(AtomicSortedColumns.java:48)\n&lt;------&gt;at org.apache.cassandra.db.AtomicSortedColumns$1.fromSorted(AtomicSortedColumns.java:61)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:399)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:382)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:377)\n&lt;------&gt;at org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:339)\n&lt;------&gt;at org.apache.cassandra.db.columniterator.SimpleSliceReader.computeNext(SimpleSliceReader.java:79)\n&lt;------&gt;at org.apache.cassandra.db.columniterator.SimpleSliceReader.computeNext(SimpleSliceReader.java:39)\n&lt;------&gt;at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:140)\n&lt;------&gt;at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:135)\n&lt;------&gt;at org.apache.cassandra.db.columniterator.SSTableSliceIterator.hasNext(SSTableSliceIterator.java:116)\n&lt;------&gt;at org.apache.cassandra.utils.MergeIterator$Candidate.advance(MergeIterator.java:147)\n</code></pre>\n\n<p>Don't have much time for calculating size of heap/memory tables etc., added</p>\n\n<pre><code>JVM_OPTS=\"-Xms4g -Xmx4g\"\n</code></pre>\n\n<p>to daemon config (test server has 8 gigs of ram). Query fails again with</p>\n\n<pre><code>ERROR [ReadStage:1] 2012-10-30 20:46:22,417 AbstractCassandraDaemon.java (line 135) Exception in thread Thread[ReadStage:1,5,main]\njava.lang.RuntimeException: java.lang.IllegalArgumentException\n        at org.apache.cassandra.service.RangeSliceVerbHandler.doVerb(RangeSliceVerbHandler.java:71)\n        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:59)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\nCaused by: java.lang.IllegalArgumentException\n        at org.apache.cassandra.io.util.FastByteArrayOutputStream.&lt;init&gt;(FastByteArrayOutputStream.java:78)\n        at org.apache.cassandra.io.util.DataOutputBuffer.&lt;init&gt;(DataOutputBuffer.java:40)\n        at org.apache.cassandra.db.RangeSliceReply.getReply(RangeSliceReply.java:48)\n        at org.apache.cassandra.service.RangeSliceVerbHandler.doVerb(RangeSliceVerbHandler.java:64)\n        ... 4 more\n</code></pre>\n\n<p>and i can't debug further. Does anyone knows how can i tweak Cassandra so i can run that query? Database have ~500 of supercolumns ~7 mb each. I need to read them all and at some point have in memory (client machine has 40 gigs of ram so thats 100% not a lacking resources issue) for further processing. Query result is not returned into api at all.</p>\n"},{"tags":["mysql","query","group"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13079776,"title":"MySQL group by week returning strange intervals","body":"<p>For some odd reason, group by week is returning odd date intervals with a datetime field. </p>\n\n<p>\"Completed\" is a datetime field, and using:</p>\n\n<p>GROUP BY WEEK(Completed)   </p>\n\n<p>I'm getting:</p>\n\n<pre><code>Completed  ActivityCount    CompletedTimestamp\n2012-09-25  300            2012-09-25 00:00:00\n2012-10-02  764            2012-10-02 00:00:00\n2012-10-08  379            2012-10-08 00:00:00\n2012-10-17  659            2012-10-17 00:00:00\n2012-10-22  382            2012-10-22 00:00:00\n</code></pre>\n\n<p>some are 7 days apart, others are 6 days apart, others are 5.... and one is 9?</p>\n\n<p>Why does it group the dates by such strange intervals instead of just 7 days?</p>\n\n<p>Thanks much for any help.</p>\n"}]}
{"total":20739,"page":5,"pagesize":100,"questions":[{"tags":["query","ms-access","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13157441,"title":"How to get the best 10 (top 10) in a query that is also ordered by another field first?","body":"<p>For example I would like to get only the top 10 customer by seller. So it will look like this (without the top 10):</p>\n\n<pre><code>Select seller, customer, sells from table order by seller asc, sells desc\n</code></pre>\n\n<p>But this will give me all the values. I would only like to have the first 10 customers for each seller.</p>\n\n<p>Is this even possible in ms-access 2003? If yes, please give me a hint,\nthanks ;)</p>\n"},{"tags":["sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13157277,"title":"Query in SQL Server (machines that are now in specific project)","body":"<p>I have a table including 3 fields which are <code>Machine Name</code>, <code>Project Name</code>, <code>Date Time</code>\nwhere <code>Date Time</code> indicates the exact time when machine was assigned to a project.</p>\n\n<p>Now I want to find machines which are now in a specific project (in fact it may be that one machine in different times be allocated to different projects).</p>\n\n<p>I want lasted specific project be latest project that machine assigned to it.</p>\n"},{"tags":["ruby-on-rails","query","syntax"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13156945,"title":"Rails query syntax","body":"<p>I'm kinda new on the Rails boat, I would like to know the difference between two types of syntax for queries</p>\n\n<p>The first one I tried is: </p>\n\n<pre><code>User.limit(8).order('created_at DESC').group('created_at').count\n</code></pre>\n\n<p>The second, which seems to be far more efficient and powerful: </p>\n\n<pre><code>User.count(:order =&gt;'DATE(created_at) DESC', :group =&gt;[\"DATE(created_at)\"], :limit =&gt; 8) \n</code></pre>\n\n<p>But I don't really understand the use case for both.\nI'm sure this is something obvious anyway... \nThanks!</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13156493,"title":"How to create a list of dates from a daterange without using a CTE","body":"<p>The following link explains how to turn a date range into a list of dates.\nI used this approach and it works fine but the query is not performing (I used Maxrecursion 0 to unlimit).</p>\n\n<p><a href=\"http://blog.justinstolle.com/sql-turn-a-date-range-into-a-list-of-dates/\" rel=\"nofollow\">http://blog.justinstolle.com/sql-turn-a-date-range-into-a-list-of-dates/</a></p>\n\n<p>Is there any other solution to get this done? (using subquery or declare table?)</p>\n"},{"tags":["query","join","mongodb","schema"],"answer_count":5,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":6374,"score":3,"question_id":4563205,"title":"How to join query in mongodb?","body":"<p>I have user document collection,like this:</p>\n\n<pre><code>User {\n   id:\"001\"\n   name:\"John\",\n   age:30,\n   friends:[\"userId1\",\"userId2\",\"userId3\"....]\n}\n</code></pre>\n\n<p><strong>some user have many many friends(10000)</strong>, How can I do like in SQL:</p>\n\n<p><code>select * from user where in (select friends from user where id=?) order by age</code>.</p>\n\n<p>I would like to have only one query but i dont know if its possible.</p>\n\n<p>Thanks</p>\n"},{"tags":["query","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13136729,"title":"How can I get a sorted children without access parent entity[many-to-many] in hibernate","body":"<p>For example, there is a many-to-many association between A and B. And<pre> <strong>A.bs</strong> is sorted List&lt;B> that sorted by an index-column in the middle-table: idx</pre>  So we haven't mapping idx column as Class field. </p>\n\n<p>Now we want to query the list of B individually and the main condition is A's id. But when query B directly, it comes out with an unsorted List (don't order by the idx field). </p>\n\n<p>I know we can retrieve A at first then collect the B into a List. However, considering the framework, we can do like that, it have to return a List without manual coding (don't want to describe too much about the framework. in one word, this limitation is caused by the pagination tool encapsulate by our self, I don't want to modify that.).</p>\n\n<p>Is there any methods to solve this problem via HQL/Criteria. Criteria are preferable.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13139202,"title":"mysql query error for timestamps","body":"<p>I hope the below error is self explanatory.I want to compare event_time with some few cart_time.I know that usually when we want any operation like this we need to use <code>in</code> but for timestamps how to compare it</p>\n\n<pre><code> mysql&gt; SELECT bsid\n        FROM access_aug15\n        WHERE event_time &lt; (SELECT cart_time \n                            FROM chat_final \n                            WHERE bsid in (SELECT bsid  \n                                           FROM access_aug15\n                                           WHERE eventid=\"11\"\n                                           AND current_page not like  '%cart%'));\n\n ERROR 1242 (21000): Subquery returns more than 1 row\n</code></pre>\n\n<p>EDIT:Table structure access_aug15</p>\n\n<pre><code>  +-------------------+--------------+------+-----+---------+-------+\n  | Field             | Type         | Null | Key | Default | Extra |\n  +-------------------+--------------+------+-----+---------+-------+\n  | vid               | varchar(200) | YES  |     | NULL    |       |\n  | bsid              | varchar(200) | YES  | MUL | NULL    |       |\n  | event_time        | datetime     | YES  | MUL | NULL    |       |\n  | eventid           | varchar(10)  | YES  | MUL | NULL    |       |\n  | current_page      | mediumtext   | YES  |     | NULL    |       |\n  | departmentid      | varchar(100) | YES  | MUL | NULL    |       |\n  | form_id           | varchar(100) | YES  |     | NULL    |       |\n  | form_name         | varchar(100) | YES  |     | NULL    |       |\n  | page_title        | varchar(200) | YES  |     | NULL    |       |\n  | report_date       | datetime     | YES  | MUL | NULL    |       |\n  +-------------------+--------------+------+-----+---------+-------+\n</code></pre>\n\n<p>table2:chat_final</p>\n\n<pre><code>  +-------------------+--------------+------+-----+---------+-------+\n  | Field             | Type         | Null | Key | Default | Extra |\n  +-------------------+--------------+------+-----+---------+-------+\n  | bsid              | varchar(200) | YES  | MUL | NULL    |       |\n  | chat_time         | datetime     | YES  |     | NULL    |       |\n  | cart_time         | datetime     | YES  |     | NULL    |       |\n  | customerid        | varchar(100) | YES  |     | NULL    |       |\n  | detail            | longtext     | YES  |     | NULL    |       |\n  | chat_type         | varchar(5)   | YES  |     | NULL    |       |\n  +-------------------+--------------+------+-----+---------+-------+\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":6,"view_count":37,"score":-4,"question_id":13154807,"title":"Query required for given output","body":"<p>Supose I have data in below format</p>\n\n<pre><code>FIELD1   F2       F3 \nLIN0_TMP    A0  1\nLIN0_TMP    B0  2\nLIN0_TMP    C0  3\nLIN_TMP     A   1\nLIN_TMP     B   2\nLIN_TMP     C   3\nLIN_TMP     D   4\nLIN2_TMP    A2  1\nLIN2_TMP    B2  2\nLIN2_TMP    C2  3\nLIN2_TMP    D2  4\n</code></pre>\n\n<p>i WANT output in below format using oracle sql query. </p>\n\n<pre><code>FIELD1   F2       F3   FLOW\n    LIN0_TMP    A0  1 FLOW1\n    LIN0_TMP    B0  2 FLOW1\n    LIN0_TMP    C0  3 FLOW1\n    LIN_TMP     A   1 FLOW2\n    LIN_TMP     B   2 FLOW2\n    LIN_TMP     C   3 FLOW2\n    LIN_TMP     D   4 FLOW2\n    LIN2_TMP    A2  1 FLOW3 \n    LIN2_TMP    B2  2 FLOW3\n    LIN2_TMP    C2  3 FLOW3\n    LIN2_TMP    D2  4 FLOW3\n</code></pre>\n\n<p>Number of record for field1 is not fixed for each LIN_TMP value..</p>\n"},{"tags":["sql","wpf","query","designer","builder"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13156142,"title":"WPF query builder control","body":"<p>I wonder if there is any sql query builder out there meeting these conditions:</p>\n\n<ol>\n<li>Available as WPF control so that it can be integrated in my WPF app</li>\n<li>At least support of MS SQL Server and Oracle</li>\n<li>Visual representation and drag/drop support (tables, columns)</li>\n<li>SQL expression as a result property (no fancy \"user-friendly\" meta concept)</li>\n<li>Possibility to edit the SQL expression manually (with changes to the visual representation)</li>\n<li>No need to build up a metadata model before </li>\n</ol>\n\n<p>I already spend some time on the web with the following results </p>\n\n<ol>\n<li>ActiveQueryBuilder is functionally perfect but does not fit 1. (lacks WPF support)  [http://www.activequerybuilder.com/index.html?from=about&amp;edition=net]</li>\n<li>KorzhEasyQueryNET does not fit 5. (SQL is not written back to visual) and 6. (metadata model needed) [http://devtools.korzh.com]</li>\n<li>Query Objects is not a component but a standalone tool [http://www.query-objects.com/]</li>\n</ol>\n\n<p>So, is anybody out who knows of an alternative?</p>\n\n<p>Regards</p>\n"},{"tags":["query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13155215,"title":"Elastic Search: Multiple queries and boosting","body":"<p>I want to make a search containing many searches with different boosts, and having the results returned by score. I tried making a search as follows, and I thought it worked very well, until I realized that only the first query was being run.</p>\n\n<p>How should I rephrase this to have a result with all the queries run, and the results ordered by score, where the scores will be added together if a result shows up for multiple queries?</p>\n\n<pre><code>[{\n    \"query\": {\n        \"fuzzy\": {\n            \"title\": {\n                \"value\": \"lord\",\n                \"boost\": 20,\n                \"min_similarity\": 0.8\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"location\": {\n                \"value\": \"london\",\n                \"boost\": 1000,\n                \"min_similarity\": 0.8\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"haircolour\": {\n                \"value\": \"dark\",\n                \"boost\": 500,\n                \"min_similarity\": 0.8\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"description\": {\n                \"value\": \"senior\",\n                \"boost\": 100,\n                \"min_similarity\": 0.7\n            }\n        }\n    }\n}, {\n    \"query\": {\n        \"fuzzy\": {\n            \"description\": {\n                \"value\": \"manager\",\n                \"boost\": 100,\n                \"min_similarity\": 0.7\n            }\n        }\n    }\n}]\n</code></pre>\n\n<p>Cheers</p>\n\n<p>Nik</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13150915,"title":"SQL - Average number of records within a time period","body":"<p>I'm trying to compile some lifetime value information for customers within one of our databases.</p>\n\n<p>We have an MS SQL Server database which stores all of our customer/transactional information.</p>\n\n<p>My issue is that I don't have much experience when it comes to MS SQL Server (or SQL in general) - I'd like to be able to run a query against the database that pulls AVG number of loans, and AVG revenue based on three criteria:</p>\n\n<p>1.) Loans be counted if they are 'approved'\n2.) Loans from a customer_id only be counted if the first loan (first identified by date_created field) be on or after a certain 'mm/yyyy'\n3.) I'm able to specify for how many months after the first 'mm/yyyy' to tally the number of loans / revenue to be included within the AVG</p>\n\n<p>Here is what the database would look like:</p>\n\n<pre><code>customer_id   | loan_status | date_created      | revenue\n111       | 'approved'  | 2010-06-20 17:17:09   | 100.00\n222       | 'approved'  | 2010-06-21 09:54:43   | 255.12\n333       | 'denied'    | 2011-06-21 12:47:30   | NULL\n333       | 'approved'  | 2011-06-21 12:47:20   | 56.87\n222       | 'denied'    | 2011-06-21 09:54:48   | NULL\n222       | 'approved'  | 2011-06-21 09:54:18   | 50.00\n111       | 'approved'  | 2011-06-20 17:17:23   | 100.00\n... loads' of records ...\n555       | 'approved'  | 2012-01-02 09:08:42   | 24.70\n111       | 'denied'    | 2012-01-05 02:10:36   | NULL\n666       | 'denied'    | 2012-02-05 03:31:16   | NULL\n555       | 'approved'  | 2012-02-17 09:32:26   | 197.10\n777       | 'approved'  | 2012-04-03 18:28:45   | 300.50\n777       | 'approved'  | 2012-06-28 02:42:01   | 201.80\n555       | 'approved'  | 2012-06-21 22:16:59   | 10.00\n666       | 'approved'  | 2012-09-30 01:17:20   | 50.00\n</code></pre>\n\n<p>If I wanted to find the avg transaction count (approved transactions), and average revenue per approved transaction for all customer's who's <strong>first</strong> loan was in/after 2012-01, and for a period of 4 months after then, how would I go about querying the database?</p>\n\n<p>Any help is greatly appreciated.</p>\n"},{"tags":["sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13141241,"title":"create a statistics table using datetime MSSQL Query","body":"<p>I have little table which gives me a very hard time:</p>\n\n<pre><code>Person    datetime1                   datetime2\nEric      2012-10-01 09:00:05.000     2012-10-01 22:00:00.000\nAnna      2012-10-02 06:00:05.000     2012-10-03 12:00:05.000\nRichard   2012-10-03 09:00:05.000     2012-10-04 02:00:05.000\nChuck     2012-10-01 12:00:05.000     2012-10-01 23:00:05.000\n</code></pre>\n\n<p>I am trying to write a query, which gives me statistics table. This table contains information about when a user logged in and out (daily granularity):</p>\n\n<pre><code>Date        logged_in  logged_off\n2012-10-01  2          2\n2012-10-02  1          0\n2012-10-03  1          1\n2012-10-04  0          1\n</code></pre>\n\n<p>According to my research, a pivot command could solve the problem?</p>\n\n<pre><code>select Person,\nSUM(case when datetime1 = '2012-10-01' then 1 else 0 end) as [loggeed_in],\nSUM(case when datetime2 = '2012-10-01'  then 1 else 0 end) as [logged_of]\nfrom table\ngroup by Person\n</code></pre>\n\n<p>This is not working... Do you have any ideas?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13135580,"title":"mysql select related items based on current item","body":"<p>i have a scenario, lets say 3 users review a business of id 10, how can i get all the unique id of the user who review that business and and use that unique id to find another business review which is not equal to 10 ? </p>\n\n<p>sample table user_review:</p>\n\n<pre><code>review_id | user_id | business_id | rating | review_date\n  1           2          10           3       20121030124001\n  2           2          9            3       20121022120627\n  3           2          10           4       20121023120627\n  4           3          10           4       20121024120627\n  5           3          6            3       20121022140627\n  6           4          10           2       20121025120627\n  7           4          10           5       20121030120627\n  8           3          10           2       20121010120627\n  9           4          8            5       20121028120627\n</code></pre>\n\n<p>i should get result of these</p>\n\n<pre><code>review_id | user_id | business_id | rating | review_date\n  2           2          9            3       20121022120627\n  5           3          6            3       20121022140627\n  9           4          8            5       20121028120627\n</code></pre>\n\n<p>In a above result if there is 2 reviews for a same user_id and same business_id the latest one should be return.Thanks</p>\n"},{"tags":["css","ipad","query","media"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13076371,"title":"Media Query for iPad and desktop (max-width)","body":"<p><strong>I want some CSS code to target both iPad and desktop with max-width: 768.</strong></p>\n\n<p>This (I don't know why, would be glad to know) doesn't work for the iPad (only desktop):</p>\n\n<pre><code>@media only screen and (max-width: 768px)\n</code></pre>\n\n<p>so I had to to this for the iPad:</p>\n\n<pre><code>@media only screen and (device-width: 768px)\n</code></pre>\n\n<p>However, I have the exact same code inside both media queries, and that I cannot accept.</p>\n\n<p>I tried this also: </p>\n\n<pre><code>@media only screen and (max-width: 767px) or (device-width: 768px)\n</code></pre>\n\n<p>This one above doesn't work either - it actually works for the desktop, no matter what width, and not on iPad. Really strange.</p>\n\n<p>How to target both iPad and desktop with same media query?</p>\n"},{"tags":["query","request","touch","sencha","jsonp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13153407,"title":"Phonegap ==> not all variables are returned from server","body":"<p>I wrote a login in sencha touch. Quite simple. A simple form with username and password. Submit a request to the server where I execute a sql to search the corresponding username/password. If a result is found then return success=true and the member_id and member_username.</p>\n\n<p>It works in Chrome and also using Eclipse/Phonegap.</p>\n\n<p>Now I expanded the sql so also the password is returned from the sql. In md5 it is stored in the db. So I can store this in the localstorage. For some reason the password I get back from the server is always \"undefined\". Although in Chrome it works fine. In Eclipse/Phonegap the value is \"undefined\".</p>\n\n<p>Here is the code from the JSONP. The code \"console.log(response.user.member_pw);\" shows \"undefined\". Allthough in Chrome it is filled in correctly... With the md5 value of the password.</p>\n\n<pre><code>Ext.util.JSONP.request({\n        url: 'http://10.0.2.2/mobile/login.php',\n        params: options.data,\n        callbackKey: \"callback\",\n        scope: this, \n        callback: function(response) {\n            console.log(\"checklogin success\");\n             if (response.success == \"true\")\n             {\n                console.log(\"Paswoord returned:\");\n                console.log(response.user.member_pw);\n                 var member = Ext.ModelMgr.create({\n                    member_id: response.user.member_id,\n                    member_username: response.user.member_username,\n                    member_password: response.user.member_pw\n                }, 'Login');\n\n                app.subapps.Login.stores.login.add(member);\n                app.subapps.Login.stores.login.sync();\n\n                this.index(options);\n            }\n            else {\n                 Ext.Msg.alert('', response.errors.reason, '');\n                 console.log(\"failure\");\n            }\n        }\n    });\n}  \n</code></pre>\n\n<p>Here is the code from the login.php</p>\n\n<pre><code>         $username = $_GET['username'];\n    $pw = $_GET['password'];\n\n    $callback = $_REQUEST['callback'];\n\n    $sql_select = \"select member_id, member_username, member_password from member where member_username like '\".$username.\"' and member_password like '\".md5($pw).\"'\";\n    $sql_result = mysql_query($sql_select, $db) or die (\"Error: \".mysql_error());\n    $sql_number_records = mysql_num_rows($sql_result);\n\n    if ($sql_number_records == 1)\n    {\n        $sql_record         = mysql_fetch_array($sql_result);\n        $idRef_user         = $sql_record[0];\n        $member_username     = $sql_record[1];\n        $member_pw            = $sql_record[2];\n\n\n            $json_return = '{\"success\": \"true\", \"user\": { \"member_id\": \"'.$idRef_user.'\", \"member_username\": \"'.$member_username.'\", \"member_pw\": \"'.$member_pw.'\"}}';\n\n            if ($callback) {\n                header('Content-Type: text/javascript');\n                echo $callback . '(' . $json_return . ');';        \n            } else {\n                header('Content-Type: application/x-json');\n                echo $json_return;    \n            }\n        }\n        else\n        {\n            $json_return =  '{\"success\": \"false\", \"errors\": { \"reason\": \"Login failed\"}}';\n            if ($callback) {\n                header('Content-Type: text/javascript');     \n                echo $callback . '(' . $json_return . ');';\n            } else {\n                header('Content-Type: application/x-json');\n                echo $json_return;    \n            }\n        }\n    } \n</code></pre>\n\n<p>I also tried to do a select * or instead of returning the password returning another field from the table. But it keeps being \"undefined\". With Chrome is works, strange...     </p>\n\n<p>Update: even if I hard code the password, $member_pw = \"mypasswordcomeshereinmd5\"; it still is undefined...</p>\n\n<p>Update2: I also hard coded the password in de json object</p>\n\n<p>'{\"success\": \"true\", \"user\": { \"member_id\": \"'.$idRef_user.'\", \"member_username\": \"'.$member_username.'\", \"member_pw\": \"mypasswordcomeshereinmd5\"}}';</p>\n\n<p>Still undefined....</p>\n"},{"tags":["javascript","jquery","sql","query","jqgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13153287,"title":"JQgrid search string builder","body":"<p>Is there any way for search string builder for JQgrid ?\ni.e. when I press search button then it should automatically generate the search string for the search critaria provided for the grid.</p>\n"},{"tags":["mysql","query","query-optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13152796,"title":"MYSQL query - getting totals by month","body":"<p><a href=\"http://sqlfiddle.com/#!2/6a6b1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/6a6b1</a></p>\n\n<p>The scheme is given above.. all i want to do is get the results as total of sales / month... the user will enter a start date and end date and I can generate (in php) all the month and years for those dates. for example if i want ot know the total number of \"sales\" for 12 months i know i can run 12 individual queries with start and end dates...  but i am want to run only one query where the result will look like </p>\n\n<pre><code>Month     numofsale\nJanuary - 2  \nFeb-1\nMarch - 23\nApr - 10\n</code></pre>\n\n<p>so on ..</p>\n\n<p>or just a list of sales with out the months i can then pair it to the array of months generated in the php ...any ideas....</p>\n\n<p>Edit / schema and data pasted from sqlfiddle.com:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `lead_activity2` (\n  `lead_activity_id` int(11) NOT NULL AUTO_INCREMENT,\n  `sp_id` int(11) NOT NULL,\n  `act_date` datetime NOT NULL,\n  `act_name` varchar(255) NOT NULL,\n  PRIMARY KEY (`lead_activity_id`),\n  KEY `act_date` (`act_date`),\n  KEY `act_name` (`act_name`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1  ;\n\nINSERT INTO `lead_activity2` (`lead_activity_id`, `sp_id`, `act_date`, `act_name`) VALUES\n(1, 5, '2012-10-16 16:05:29', 'sale'),\n(2, 5, '2012-10-16 16:05:29', 'search'),\n(3, 5, '2012-10-16 16:05:29', 'sale'),\n(4, 5, '2012-10-17 16:05:29', 'DNC'),\n(5, 5, '2012-10-17 16:05:29', 'sale'),\n(6, 5, '2012-09-16 16:05:30', 'SCB'),\n(7, 5, '2012-09-16 16:05:30', 'sale'),\n(8, 5, '2012-08-16 16:05:30', 'sale'),\n(9, 5,'2012-08-16 16:05:30', 'sale'),\n(10, 5, '2012-07-16 16:05:30', 'sale');\n</code></pre>\n"},{"tags":["mysql","sql","query","like","where"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13150741,"title":"Specification in like query","body":"<p>I can't figure out what's wrong with this query. I just want to search in a specific genre, but this query gives me results of other genres. Would really like some help. This code is for my first site built in php.</p>\n\n<pre><code>SELECT * \nFROM news\nWHERE (titel LIKE '%keyword%') AND genre='politics'\n</code></pre>\n"},{"tags":["mysql","query","insert","union"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13152425,"title":"Cannot use UNION in INSERT MySQL?","body":"<p>I have a select query that works fine. But when I wrap it into an INSERT statement, I get an error.</p>\n\n<p>Error 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(SELECT DISTINCT NULL AS <code>id</code>,NULL AS <code>core_value_id</code>,NULL AS <code>translation_id</code>' at line 3</p>\n\n<p>I can solve this problem by using 1 insert for each source table. But is there any way to do it with a single query? Why isn't this working?</p>\n\n<p>Here's the query.</p>\n\n<pre><code>INSERT INTO `some_table`\n(\n(SELECT DISTINCT\nNULL AS `id`,\nNULL AS `core_value_id`,\nNULL AS `translation_id`,\nt1.`upc` AS `source_value`,\nt1.`upc` AS `value`,\nCOUNT(*) AS `count`\nFROM  `source_table_1` t1\nGROUP BY `upc`)\n\nUNION ALL\n(SELECT DISTINCT\nNULL,NULL,NULL,\nt1.`upc`,\nt1.`upc`,\nCOUNT(*) AS `count`\nFROM  `source_table_2` t1\nGROUP BY `upc`\n)\nORDER BY `count` DESC\n)\n</code></pre>\n\n<p>Here's the table definition:</p>\n\n<pre><code>CREATE TABLE `some_table` (\n `id` int(11) NOT NULL AUTO_INCREMENT,\n `core_value_id` int(11) DEFAULT NULL,\n `translation_id` int(11) DEFAULT NULL,\n `source_value` varchar(255) NOT NULL,\n `value` varchar(255) DEFAULT NULL,\n `count` int(11) NOT NULL,\n PRIMARY KEY (`id`),\n KEY `core_value_id` (`core_value_id`),\n KEY `translation_id` (`translation_id`),\n KEY `source_value` (`source_value`),\n KEY `value` (`value`),\n KEY `count` (`count`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>source_tables would look something like this:</p>\n\n<pre><code>CREATE TABLE `source_table_1` (\n `id` int(11) NOT NULL AUTO_INCREMENT,\n `upc` bigint(20) DEFAULT NULL,\n PRIMARY KEY (`id`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>The upc columns would have data like:</p>\n\n<pre><code>123456789012\n123456789013\n123456789014\n123456789015\n123456789016\n123456789017\n</code></pre>\n"},{"tags":["php","sql","query","search","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13150516,"title":"Search SQL with Date Range and Checkbox","body":"<p>I've been trying to develop a code where I have a form to search SQL tables according to date ranges and a checkbox status.</p>\n\n<p>I already have worked out the search query for the dates, but I haven't been able to make it work with the checkbox. I would like to combine both features in one search but I can't figure it out.</p>\n\n<p>For ex: Search between \"<strong>01/01/2012</strong>\" and \"<strong>12/31/2012</strong>\" where status is \"DONE! <strong>(Checkbox=Checked)</strong>\".</p>\n\n<p>Here is the code I'm using to do the search:</p>\n\n<p>The Form</p>\n\n<pre><code>&lt;form method = \"post\" action = \"&lt;?php echo $_SERVER['PHP_SELF'];?&gt;\"&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align:center; padding-top:15px;\"&gt;\n                    &lt;span&gt;From&amp;nbsp:&lt;/span&gt;\n                    &lt;input type = \"date\" name = \"OLD\"&gt;\n                    To:\n                    &lt;input type = \"date\" name = \"NEW\"&gt;\n                    Status:\n                    &lt;input type='checkbox' name='Status' value='DONE'/&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align:center; padding-top:15px;\"&gt;\n                    &lt;button type = \"submit\" name = \"search\" value = \"Search\" class=\"button orange\"&gt;Search&lt;/button&gt;\n                    &lt;button type = \"reset\" value = \"Clear\" class=\"button orange\"&gt;Reset&lt;/button&gt;\n                &lt;/td&gt;   \n            &lt;/tr&gt;\n        &lt;/table&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>The PHP</p>\n\n<pre><code>&lt;?php\n    if(!isset($_POST['search']))\n    {\n    ?&gt;\n\n    &lt;?php\n    }\n    else\n    {\n        $OLD = trim($_POST['from']);\n        $NEW = trim($_POST['to']);\n\n        $connection = mysql_pconnect(\"HOST\", \"USER\", \"PASS\") or die(\"Connection failed. \".myslq_error());\n        mysql_select_db(\"DATABASENAME\") or die(\"Unable to select db. \".mysql_error());\n        $query = \"SELECT * FROM table WHERE Date &gt;= '$OLD' AND Date &lt;= '$NEW' ORDER BY date ASC\";\n        $result = mysql_query($query) or die(mysql_error());\n\n        echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n            echo \"&lt;tr class='rowa'&gt;&lt;b&gt;\";\n                echo \"&lt;td class='col1 cell'&gt;Name&lt;/td&gt;\";\n                echo \"&lt;td class='col2 cell'&gt;Last Name&lt;/td&gt;\";\n            echo \"&lt;/tr&gt;\";\n        echo \"&lt;/table&gt;\";\n        while($record = mysql_fetch_object($result))\n        {   \n        echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n            echo \"&lt;tr class='rowb'&gt;\";\n                echo \"&lt;td class='col1 cell'&gt;\".$record-&gt;Name.\"&lt;/td&gt;\";\n                echo \"&lt;td class='col2 cell'&gt;\".$record-&gt;LastName.\"&lt;/td&gt;\";\n            echo \"&lt;/tr&gt;\";       \n        echo \"&lt;/table&gt;\";\n        }       \n    }\n?&gt;\n</code></pre>\n\n<p>Who can lead me in the right way to accomplish this?! Thanks a lot!</p>\n"},{"tags":["query","sqlalchemy","rowcount"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13145068,"title":"SQL Alchemy ResultProxy.rowcount should not be zero","body":"<p>Does anyone know how to get the row count from an SQL Alchemy query ResultProxy object without looping through the result set? The ResultProxy.rowcount attribute shows 0, I would expect it to have a value of 2. For updates it shows the number of rows affected which is what I would expect.</p>\n\n<pre><code>from sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\n\nengine = create_engine(\n    'oracle+cx_oracle://user:pass@host:port/database'\n    )\n\nsession = sessionmaker(\n    bind = engine\n    , autocommit = False\n    , autoflush = False\n    )()\n\nsql_text = u\"\"\"\n    SELECT 1 AS Val FROM dual UNION ALL\n    SELECT 2 AS Val FROM dual\n    \"\"\"\n\nresults = session.execute(sql_text)\n\nprint '%s rows returned by query...\\n' % results.rowcount\nprint results.keys()\n\nfor i in results:\n    print repr(i)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 rows returned by query...\n\n[u'val']\n(1,)\n(2,)\n</code></pre>\n"},{"tags":["mysql","query","select","numbers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13150281,"title":"MYSQL Selection more than one value","body":"<pre><code>$query = $query.\"AND `category` != '(1,2)') ORDER BY id DESC LIMIT $a , $b\" ;\n</code></pre>\n\n<p>Long story short, can't find the right syntax for the above (1,2) and i don't want to write over with another AND because there may apear more values in future.</p>\n\n<p>Hope somebody can help me ;).</p>\n"},{"tags":["android","query","sqlite","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":885,"score":0,"question_id":6891684,"title":"Android SQLite query multiple tables","body":"<p>Im trying to do something like this (This is MySQL format)</p>\n\n<pre><code>SELECT q.question_id, q.question, q.answer\nFROM relationship r, questions q\nWHERE r.cat_id =1\nAND r.question_id = q.question_id\nLIMIT 0 , 30\n</code></pre>\n\n<p>So, I got questions stored in one table, then categories in another table. I have the relationship table set up so that a question can be in multiple categories. So say a question has an id of 5, and its in 3 different categories, the relationship table would look like this</p>\n\n<pre><code>relation_id, question_id, category_id\n    1            5            1\n    2            5            2\n    3            5            3\n    4            6            1  \n</code></pre>\n\n<p>So, say I wanna get all the questions with the cat_id of 1, I should get 2 results. That's basically what I'm trying to do.</p>\n"},{"tags":["php","mysql","query","pdo","count"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13148325,"title":"Counting rows by category-filter during fetching of categories from database","body":"<p>I have two tables in my database</p>\n\n<pre><code>table: products                   table: companies\n+-----------+------------+        +------+------------+\n| name      | company_id |        | id   | name       |\n+-----------+------------+        +------+------------+\n|Product 1  | 1          |        | 1    | Company 1  |\n|Product 2  | 1          |        | 2    | Company 2  |   \n|Product 3  | 3          |        | 3    | Company 3  |\n|Product 4  | 1          |        | 4    | Company 4  |\n|Product 5  | 1          |        | ...               |\n|Product 6  | 3          |        +------+------------+\n|Product 7  | 2          |\n|...                     |\n+-----------+------------+\n</code></pre>\n\n<p>Now I have to make <strong>company-selector</strong> (filtering products by company) using HTML <code>SELECT</code> element with names of all companies from table <code>companies</code> and <code>COUNT</code> of products after company name in the list.</p>\n\n<p>So, my goal is to get <code>SELECT</code> options like this:</p>\n\n<ul>\n<li>Company 1 (4)</li>\n<li>Company 2 (1)</li>\n<li>Company 3 (2)</li>\n<li>Company 4 (0)</li>\n</ul>\n\n<p><em>(note: counts inside the brackets are from example above)</em></p>\n\n<h2>What have I tried so far?</h2>\n\n<p>I was using <code>mysql_*</code> functions earlier and later it was <code>mysqli</code> procedural model. I can do this manually with one query for companies and another one inside <code>while</code> block to get <code>COUNT</code> of elements (filtered by current company's id in the loop). Now I'm trying to work with <code>PDO object</code> which is something new for me and I'm not very familiar with it.</p>\n\n<h2>Question</h2>\n\n<p>Is it somehow possible to get <code>COUNT</code> with one query (using <code>JOINs</code> or something)? If not, how I can do it with query inside the loop (old way) using my <code>$dbPDO</code> object? Or any other way?</p>\n\n<p>I've looked some examples here but nothing could adapt to fit my requirements. Maybe I missed something but working with PDO is still painful for me (and I must learn it ASAP). </p>\n\n<p>Looking at my own question, I don't think it's something hard, but the worst thing, I <strong>can't find solution</strong> by myself.</p>\n\n<p>At the end, I have solution in <code>mysqli</code>, just I don't like it so much and think there's easier way of making this task done!</p>\n\n<p>I thought this <a href=\"http://stackoverflow.com/questions/1803905/counting-all-the-posts-belonging-to-a-category-and-its-subcategories\"><strong>question</strong></a> is something I need but still don't understand that query in answer.</p>\n\n<p>So far I have this code and have no idea how to make it counts products:</p>\n\n<pre><code>  $dbPDO = new PDO('mysql:dbname=comixdb;host=localhost', 'root', '');\n  $sel_cat = ''; # selector HTML\n  $sql = \"SELECT * FROM categories ORDER BY name\";\n  foreach ($dbPDO-&gt;query($sql) as $row) {\n    $sel_cat .= \"&lt;option value=\\\"{$row['id']}\\\"&gt;{$row['name']}&lt;/option&gt;\";\n    }\n  $sel_cat = \"&lt;select&gt;&lt;option value=\\\"*\\\"&gt;All categories&lt;/option&gt;$sel_cat&lt;/select&gt;\";\n\n  echo $sel_cat;\n</code></pre>\n\n<p>Hope I've clarified question enough. Any help would be appreciated. </p>\n"},{"tags":["php","mysql","database","query","retrieve"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13148810,"title":"Wrong data retrieved from database","body":"<p>So, I want to retrieve the order of the elements of a list. The order is set before by the user, and are stored in the table below. Because I also want to retrieve name and description of the list elements I need to combine two tables (see below).</p>\n\n<p>However, what is actually retrieved is an array containing 16 elements (should be four because it only exists four elements as for now). The array is too long to post here, but I put it in a phpFiddle <a href=\"http://phpfiddle.org/main/code/b2a-vtp\" rel=\"nofollow\">to be found here</a> if you're interested.</p>\n\n<p>Well, I have really tried to find what's wrong (probably something easy as always), but with no luck.</p>\n\n<p>Thanks a lot for your time and help!</p>\n\n<p><strong>listModel.php:</strong></p>\n\n<pre><code>public function GetOrderedElements($userId, $listId) {\n\n// $userId = 46\n// $listId = 1\n\n        $query = \"SELECT le.listElemId, le.listElemName, le.listElemDesc, lo.listElemOrderPlace\n                    FROM listElement AS le\n                    INNER JOIN listElemOrder AS lo\n                    ON le.listId = lo.listId\n                    WHERE lo.userId = ?\n                    AND lo.listId = ?\n                    ORDER BY listElemId\";\n\n        $stmt = $this-&gt;m_db-&gt;Prepare($query);\n\n        $stmt-&gt;bind_param(\"ii\", $userId, $listId);\n\n        $listElements = $this-&gt;m_db-&gt;GetOrderedElements($stmt);\n\n        return $listElements;       \n    }\n</code></pre>\n\n<p><strong>database.php:</strong></p>\n\n<pre><code>public function GetOrderedElements(\\mysqli_stmt $stmt) {\n\n        if ($stmt === FALSE) {\n                throw new \\Exception($this-&gt;mysqli-&gt;error);\n        }\n\n        if ($stmt-&gt;execute() == FALSE) {\n                throw new \\Exception($this-&gt;mysqli-&gt;error);\n        }\n\n        if ($stmt-&gt;bind_result($listElemId, $listElemName, $listElemDesc, $listElemOrderPlace) == FALSE) {\n            throw new \\Exception($this-&gt;mysqli-&gt;error);\n        }\n\n        $listElements = array();\n\n        while ($stmt-&gt;fetch()) {\n            $listElements[] = array('listElemId' =&gt; $listElemId,\n                                 'listElemName' =&gt; $listElemName,\n                                 'listElemDesc' =&gt; $listElemDesc,\n                                 'listElemOrderPlace' =&gt; $listElemOrderPlace);\n        }\n\n        var_dump($listElements);\n\n        $stmt-&gt;Close();\n\n        return $listElements;\n    }\n</code></pre>\n\n<p><strong>from the database:</strong></p>\n\n<p><em>listElemOrder</em>:</p>\n\n<pre><code>listElemOrderId | listId | listElemId | userId | listElemOrderPlace\n      1              1          1          46           1\n      4              1          2          46           4\n      2              1          3          46           2\n      3              1          4          46           3\n</code></pre>\n\n<p><em>listElement</em>:</p>\n\n<pre><code>listElemId | listElemName | listId | listElemDesc | listElemOrderPlace\n      1          Elem A         1         Derp             NULL\n      2          Elem B         1         Herp             NULL\n      3          Elem C         1         Lorum            NULL\n      4          Elem D         1         Ipsum            NULL\n</code></pre>\n\n<p><strong>Note:</strong> 'listElemOrderPlace' in the table <em>listElement</em> is the final order of the elements (all users average), not to be mixed with the one with the same name in the other table, that's only a specific user's order of the list elements (which is the interesting one in this case).</p>\n"},{"tags":["database","query","configuration","nosql","ravendb"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":74,"score":5,"question_id":13083421,"title":"RavenDB Database Configuration","body":"<p>How to configure the RavenDB database that can be capable to sending too many requests, or receiving too large a response?</p>\n\n<p>By default, RavenDB will not allow operations that might compromise the stability of either the server or the client and a RavenDB session automatically enforces the following limitations:</p>\n\n<ol>\n<li><p>If a page size value is not specified, the length of the results will be limited to 128 results. At the server side as well, there is a hard limit to the page size of 1,024 results.</p></li>\n<li><p>The number of remote calls to the server per session is limited to 30.</p></li>\n</ol>\n\n<p>I want to configure DocumentStore/DocumentSession in the client that it increase limitation of page size value and number of remote calls the server per session.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":9689587,"title":"Can someone advise on simplifying a MySQL query so it doesn't take minutes to execute and/or display incorrect results","body":"<p>We are using SugarCRM with ZuckerReports at the office and need a specific statistic coming out. </p>\n\n<p>The issue lies within my MYSQL query.</p>\n\n<p>If I use the following query</p>\n\n<pre><code>SELECT \n  accounts.id,\n  accounts.name AS AccountName,\n  (SELECT \n  accounts_audit.`after_value_string` \n  FROM accounts_audit \n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  accounts_audit.date_created &lt; CONCAT(CAST(2012 AS CHAR(4)),'-',LPAD(CAST(3 AS CHAR(2)),2,'0'),'-01 00:00:00') AND\n  accounts_audit.after_value_string&lt;&gt;'Active' AND \n  accounts_audit.after_value_string&lt;&gt;'Semi' AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created \n  LIMIT 1) AS PreviousStatus,\n  (SELECT \n  accounts_audit.after_value_string \n  FROM accounts_audit\n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  MONTH(accounts_audit.date_created) = 3 AND\n  YEAR(accounts_audit.date_created) = 2012 AND\n  (accounts_audit.after_value_string='Active' OR \n  accounts_audit.after_value_string='Semi') AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created DESC\n  LIMIT 1) AS NextStatus,\n  (SELECT \n  COUNT(tp_trade_profile.awb_number) \n  FROM tp_trade_profile \n  LEFT OUTER JOIN tp_trade_prile_accounts_c ON (tp_trade_profile.id = tp_trade_prile_accounts_c.tp_trade_p7fc3profile_ida) \n  WHERE tp_trade_prile_accounts_c.deleted = 0 \n  AND tp_trade_profile.deleted = 0 \n  AND MONTH(tp_trade_profile.date_shipping)=3\n  AND YEAR(tp_trade_profile.date_shipping)=2012\n  AND tp_trade_prile_accounts_c.tp_trade_p2584ccounts_idb =accounts.id) AS SHIPMENTS,\n  accounts_cstm.area_code_c\nFROM\n  accounts\n  LEFT OUTER JOIN users ON (accounts.assigned_user_id = users.id)\n  LEFT OUTER JOIN accounts_cstm ON (accounts.id = accounts_cstm.id_c)\nWHERE\n      users.user_name = 'USER1'\nGROUP BY\n      accounts.id    \n</code></pre>\n\n<p>it runs realtively fast but also the result shows     NULL    rows in    NextStatus    .\nIf I add the same check for </p>\n\n<blockquote>\n  <p>NextStatus</p>\n</blockquote>\n\n<p>in the</p>\n\n<blockquote>\n  <p>PreviousStatus</p>\n</blockquote>\n\n<p>query, but omitting the NULLs, it takes around 20 minutes to finish and show only NULLs for</p>\n\n<blockquote>\n  <p>NextStatus</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>PreviousStatus</p>\n</blockquote>\n\n<p>Here's the modified query: </p>\n\n<pre><code>SELECT \n  accounts.id,\n  accounts.name AS AccountName,\n  (SELECT \n  accounts_audit.`after_value_string` \n  FROM accounts_audit \n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  accounts_audit.date_created &lt; CONCAT(CAST(2012 AS CHAR(4)),'-',LPAD(CAST(3 AS CHAR(2)),2,'0'),'-01 00:00:00') AND\n  accounts_audit.after_value_string&lt;&gt;'Active' AND \n  accounts_audit.after_value_string&lt;&gt;'Semi' AND\n  accounts_audit.parent_id = accounts.id AND\n  (SELECT accounts_audit.after_value_string \n      FROM accounts_audit \n      WHERE     \n      accounts_audit.field_name = 'statuses_c' \n      AND MONTH(accounts_audit.date_created) = 3 \n      AND YEAR(accounts_audit.date_created) = 2012 \n      AND (accounts_audit.after_value_string='Active' OR accounts_audit.after_value_string='Semi') \n      AND accounts_audit.parent_id = accounts.id \n      ORDER BY accounts_audit.date_created DESC LIMIT 1)&lt;&gt;NULL\n  ORDER BY accounts_audit.date_created \n  LIMIT 1) AS PreviousStatus,\n  (SELECT \n  accounts_audit.after_value_string \n  FROM accounts_audit\n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  MONTH(accounts_audit.date_created) = 3 AND\n  YEAR(accounts_audit.date_created) = 2012 AND\n  (accounts_audit.after_value_string='Active' OR \n  accounts_audit.after_value_string='Semi') AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created DESC\n  LIMIT 1) AS NextStatus,\n  (SELECT \n  COUNT(tp_trade_profile.awb_number) \n  FROM tp_trade_profile \n  LEFT OUTER JOIN tp_trade_prile_accounts_c ON (tp_trade_profile.id = tp_trade_prile_accounts_c.tp_trade_p7fc3profile_ida) \n  WHERE tp_trade_prile_accounts_c.deleted = 0 \n  AND tp_trade_profile.deleted = 0 \n  AND MONTH(tp_trade_profile.date_shipping)=3\n  AND YEAR(tp_trade_profile.date_shipping)=2012\n  AND tp_trade_prile_accounts_c.tp_trade_p2584ccounts_idb =accounts.id) AS SHIPMENTS,\n  accounts_cstm.area_code_c\nFROM\n  accounts\n  LEFT OUTER JOIN users ON (accounts.assigned_user_id = users.id)\n  LEFT OUTER JOIN accounts_cstm ON (accounts.id = accounts_cstm.id_c)\nWHERE\n      users.user_name = 'USER1'\nGROUP BY\n      accounts.id    \n</code></pre>\n\n<p>Could anyone point me in the right direction here?</p>\n\n<p>Also the 4 tables that we use have between 30000 and 50000 records each.\nThanks in advance!</p>\n\n<p>Ok, I noticed that I am actually filtering records only in one of the subqueries and thus the NULLs in the result. After moving a filter to the main conditions:</p>\n\n<pre><code>SELECT \n  accounts.id,\n  accounts.name AS AccountName,\n  (SELECT \n  accounts_audit.`after_value_string` \n  FROM accounts_audit \n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  accounts_audit.date_created &lt; CONCAT(CAST(2012 AS CHAR(4)),'-',LPAD(CAST(3 AS CHAR(2)),2,'0'),'-01 00:00:00') AND\n  accounts_audit.after_value_string&lt;&gt;'Active' AND \n  accounts_audit.after_value_string&lt;&gt;'Semi' AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created \n  LIMIT 1) AS PreviousStatus,\n  (SELECT \n  accounts_audit.after_value_string \n  FROM accounts_audit\n  WHERE accounts_audit.field_name = 'statuses_c' AND \n  MONTH(accounts_audit.date_created) = 3 AND\n  YEAR(accounts_audit.date_created) = 2012 AND\n  (accounts_audit.after_value_string='Active' OR \n  accounts_audit.after_value_string='Semi') AND\n  accounts_audit.parent_id = accounts.id\n  ORDER BY accounts_audit.date_created DESC\n  LIMIT 1) AS NextStatus,\n  (SELECT \n  COUNT(tp_trade_profile.awb_number) \n  FROM tp_trade_profile \n  LEFT OUTER JOIN tp_trade_prile_accounts_c ON (tp_trade_profile.id = tp_trade_prile_accounts_c.tp_trade_p7fc3profile_ida) \n  WHERE tp_trade_prile_accounts_c.deleted = 0 \n  AND tp_trade_profile.deleted = 0 \n  AND MONTH(tp_trade_profile.date_shipping)=3\n  AND YEAR(tp_trade_profile.date_shipping)=2012\n  AND tp_trade_prile_accounts_c.tp_trade_p2584ccounts_idb =accounts.id) AS SHIPMENTS,\n  accounts_cstm.area_code_c\nFROM\n  accounts\n  LEFT OUTER JOIN users ON (accounts.assigned_user_id = users.id)\n  LEFT OUTER JOIN accounts_cstm ON (accounts.id = accounts_cstm.id_c)\nWHERE\n      users.user_name = 'USER1' AND\n      accounts.id IN (SELECT \n                      b.parent_id\n                      FROM\n                      accounts_audit b\n                      WHERE\n                      b.field_name = 'statuses_c' AND \n                      MONTH(b.date_created) = 3 AND \n                      YEAR(b.date_created) = 2012 AND \n                      (b.after_value_string = 'Active' OR \n                      b.after_value_string = 'Semi')\n                      GROUP BY  parent_id ORDER BY  b.date_created)\nGROUP BY\n      accounts.id\n</code></pre>\n\n<p>I've got 45 mins of execution/at least, so far/ and no result :(</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Here's some info about the tables:</p>\n\n<p>The <code>accounts</code> table holds <code>name</code> and <code>id</code>(along other info that's not in this situation.</p>\n\n<p>The <code>accounts_audit</code> table holds <code>parent_id</code> and statuses along with their dates of update.</p>\n\n<p>The <code>tp_trade_profile</code> contains shipment info.</p>\n\n<p>The <code>tp_trade_prile_accounts_c</code> holds shipment id and the id of the account(form <code>accounts</code>) that is the owner of the shipment.</p>\n"},{"tags":["php","query","script","http-get"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":43,"score":-5,"question_id":13147166,"title":"How to write a PHP script that receive report via HTTP GET?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13146605/how-to-retrieve-data-using-http-get-from-external-url-using-php\">How to retrieve data using HTTP GET from external URL using PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>A company is supposed to send me a report via HTTP GET. \nA report is sent to my url (www.myurl.com/report.php)as query paramaters for example:\nmessageID, batch_ID, complete_Time ...</p>\n\n<p>I would like to know how can I write a PHP script that could receive that report.</p>\n\n<p>Is it possible to save it to a file , or read that from a database?</p>\n\n<p>Thank you for your help.</p>\n\n<p>Meda</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13102714,"title":"Fatal error: Call to a member function query() on a non-object in .php file","body":"<p>I'm new to PHP and SQL, but I'm trying to create a login script for my webapp.\nFor some reason I'm stuck. When the username or password-field is empty, there is an alert, but when they are both filled in correct or incorrect, there is no alert.</p>\n\n<p>When I open the website in my browser (Chrome) and inspect the page, I get:</p>\n\n<p><strong>\"POST ../App/auth.php 500 (Internal Server Error)\"</strong> </p>\n\n<p>When I open the error.log-file from my server, I get:</p>\n\n<p><strong>\"PHP Fatal error:  Call to a member function query() on a non-object in ../App/class.manageUsers.php on line 24, referer: ../App/login.php\"</strong></p>\n\n<p>line 24 in class.manageUsers.php is:</p>\n\n<pre><code>$query = $this-&gt;link-&gt;query(\"SELECT * FROM users WHERE username = '$username' AND\npassword = '$password' LIMIT 1\");\n</code></pre>\n\n<p>class.manageUsers.php:</p>\n\n<pre><code>&lt;?php\n\ninclude_once('class.database.php');\n\nclass ManageUsers{\n\n    protected $link;\n\n    function __construct(){\n        $db_conn = new ManageDatabase;\n        $this-&gt;link = $db_conn-&gt;connect();\n        return $this-&gt;link;\n    }\n    function addUsers($username,$firstname,$lastname,$email,$password,$user_level){\n        $query = $this-&gt;link-&gt;prepare(\"INSERT INTO users (username,firstname,lastname,email,password,user_level)\n            VALUES (?,?,?,?,?,?)\n        \");\n        $values = array($username,$firstname,$lastname,$email,$password,$user_level);\n        $query-&gt;execute($values);\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;\n    }\n    function loginUsers($username,$password){\n        $query = $this-&gt;link-&gt;query(\"SELECT * FROM users WHERE username = '$username' AND password = '$password' LIMIT 1\");\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;           \n    }\n    function listUsers($user_id = null){\n        if(isset($user_id))\n        {\n        $query = $this-&gt;link-&gt;query(\"SELECT * FROM users WHERE id = '$user_id' LIMIT 1\");\n        }\n        else\n        {\n        $query = $this-&gt;link-&gt;query(\"SELECT * FROM users ORDER BY id DESC\");\n        }\n        $rowCount = $query-&gt;rowCount();\n        if($rowCount &gt;= 1)\n        {\n            $result = $query-&gt;fetchAll();\n        }\n        else\n        {\n            $result = 0;\n        }\n        return $result;\n    }\n\n    function editUsers($user_id,$param){\n        foreach ($param as $key =&gt; $value)\n        {\n        $query = $this-&gt;link-&gt;query(\"UPDATE users SET $key = '$value' WHERE id = '$user_id' LIMIT 1\");\n        }\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;\n    }\n\n    function deleteUsers($user_id){\n        $query = $this-&gt;link-&gt;query(\"DELETE FROM users WHERE id = '$user_id' LIMIT 1\");\n        $rowCount = $query-&gt;rowCount();\n        return $rowCount;\n    }\n\n}\n\n?&gt;\n</code></pre>\n\n<p>class.database.php:</p>\n\n<pre><code>&lt;?php\n\nclass ManageDatabase{\n\n    protected $db_conn;\n    protected $db_host = 'localhost';\n    protected $db_name = 'jqueryMobile';\n    protected $db_user = 'root';\n    protected $db_pass = '';\n\n    function connect(){\n        try{\n            $this-&gt;db_conn = new PDO(\"mySQL:host=$this-&gt;db_host;dbname=$this-&gt;db_name\",$this-&gt;db_user,$this-&gt;db_pass);\n            return $this-&gt;db_conn;\n        }\n        catch(PDOexception $e){\n            return $e-&gt;getMessage();\n        }\n    }\n\n}\n?&gt;\n</code></pre>\n\n<p>I hope someone can find where it seems to go wrong. \nThanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13146304,"title":"How to Select Every Row Where Column Value is NOT Distinct","body":"<p>I need to run a select statement that returns all rows where the value of a column (i.e. EmailAddress) is not distinct.</p>\n\n<p>For example, if the table looks like below:</p>\n\n<pre><code>CustomerName     EmailAddress\nAaron            aaron@gmail.com\nChristy          aaron@gmail.com\nJason            jason@gmail.com\nEric             eric@gmail.com\nJohn             aaron@gmail.com\n</code></pre>\n\n<p>I need the query to return:</p>\n\n<pre><code>Aaron            aaron@gmail.com\nChristy          aaron@gmail.com\nJohn             aaron@gmail.com (peer edited from john@gmail.com)\n</code></pre>\n\n<p>I have read many posts and tried different queries to no avail.  The query that I believe should work is below.  Can someone suggest an alternative or tell me what may be wrong with my query?</p>\n\n<pre><code>select EmailAddress, CustomerName from Customers\ngroup by EmailAddress, CustomerName\nhaving COUNT(distinct(EmailAddress)) &gt; 1\n</code></pre>\n"},{"tags":["sql","query","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13146033,"title":"oracle querying","body":"<p>Assuming I'm using a model like <a href=\"http://www.eclipse.org/birt/phoenix/db/dbschema/ClassicModelsDBSchema.jpg\" rel=\"nofollow\">this</a> </p>\n\n<p>How would I be able to find the last customer to order a give product?<br>\n<img src=\"http://i.stack.imgur.com/OeJ06.jpg\" alt=\"enter image description here\"></p>\n\n<p>I got this far</p>\n\n<pre><code>   SELECT customerNumber\nFROM ORDERS\nWHERE orderNumber = (SELECT  TOP 1 OrderNumber FROM orderDetails WHERE productCode = 1\nORDER BY orderDate DESCENDING)\n</code></pre>\n\n<p>Now I'm stuck. Not sure what subquery(s) should be.</p>\n"},{"tags":["php","html","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13104939,"title":"How to search for special characters in my database with an sql query in an accent insensitive way?","body":"<p>I have a table in my db that contains several columns and in some of them there are special characters like á, é, í, ó, ú, Á, É, Í, Ó, Ú, ñ and Ñ. I have in my webpage a search box and by using this I make a query that searches my bd table and displays the results like this:</p>\n\n<p>searching form:</p>\n\n<pre><code>&lt;form action=\"resultado.php\" method=\"post\" name=\"form1\" id=\"form1\"&gt;\n    &lt;th scope=\"col\"&gt;&lt;label for=\"busqueda\"&gt;&lt;/label&gt;\n    &lt;input type=\"text\" name=\"buscar\" id=\"buscar\" width=\"auto\" placeholder=\"Buscar...\" height=\"auto\" /&gt;\n  &lt;/th&gt;\n  &lt;th scope=\"col\" align=\"center\" valign=\"top\"&gt;&lt;input type=\"submit\" name=\"ACTION\" class=\"button1\" value=\"Buscar\"&gt;&lt;/th&gt;\n&lt;/tr&gt;&lt;/form&gt;\n</code></pre>\n\n<p>Button function</p>\n\n<pre><code> if (@$_POST['ACTION']=='Buscar'){ \n $buscar = $_POST['buscar'];\n $query = \"SELECT * FROM Medios_table WHERE concat(id,UPPER(Id_Nombre),UPPER(Pais),UPPER(Estado),UPPER(Ciudad),UPPER(website),UPPER(Url),UPPER(Url2),UPPER(InfAnex) COLLATE uft8_unicode_ci) LIKE UPPER('%$buscar%') ORDER BY Id_Nombre ASC\";\n $busquedaresult = mysql_query($query);}\n</code></pre>\n\n<p>In my table I have several columns that contains words like \"Andalucía\" and \"España\" many times as a result from this query if I type in the search box \"andalucia\" nothing comes up, but if I type \"Andalucía\" now it does show up, if I search \"Espana\" nothing shows up but \"España\" works fine, i cannot make it accent insensitive. my table and column collation is utf8_unicode_ci and my webpage meta looks like this</p>\n\n<pre><code> &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n</code></pre>\n\n<p>I'm using a myPhpAdmin in my website to create or modify my db and it has the mySQL server 5.1.1</p>\n"},{"tags":["mysql","sql","query","select"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13144230,"title":"Divisioning of results of two select SQL-statements","body":"<p>So this is my problem:</p>\n\n<p>I have 2 different sql select queries, which both return me a value (1425000 and 2850000)\nWhat i want to do now is the following:</p>\n\n<pre><code>Select (query1 / query 2)\nfrom xxxxx\nwhere xxxx;\n</code></pre>\n\n<p>But query 1 and query 2 are quiet complicated queries, having count and sum functions in it.</p>\n\n<p>How can I solve this?</p>\n"},{"tags":["mysql","sql","query","phpmyadmin","sql-update"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140582,"title":"MySQL update query does not work #1064","body":"<p>Can anyone tell me what is wrong with this Query ?</p>\n\n<pre><code>UPDATE\n    violetta.navi__stop\nSET\n    violetta.navi__stop.endHour = VB.endHour\nFROM\n    violetta.navi__stop AS V\nINNER JOIN\n    violetta_back.navi__stop AS VB\nON V.code = VB.code\n</code></pre>\n\n<p>This code sample works for me on my database:</p>\n\n<pre><code>SELECT\nV.code, V.endHour\nFROM\n    violetta.navi__stop AS V\nUNIQUE\n    violetta_back.navi__stop AS VB\nON V.code = VB.code\n</code></pre>\n"},{"tags":["query","date","ms-access","transactions","max"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13140494,"title":"Get entire record for Max value (date) in one column","body":"<p>I am trying to query data for transactions. I want to get multiple columns for the latest dated transaction. PONumber, Vendor, Price for each item, last time purchased. For example:</p>\n\n<p>Data:</p>\n\n<pre><code>PONumber    Item    Vendor    Price    DateOrdered\n1           ABC     Wal-Mart  1.00     10/29/12\n2           ABC     BestBuy   1.25     10/20/12\n3           XYZ     Wal-Mart  2.00     10/30/12\n4           XYZ     HomeDepot 2.50     9/14/12\n</code></pre>\n\n<p>Desired Result Set:</p>\n\n<pre><code>PONumber    Item    Vendor    Price    DateOrdered\n1           ABC     Wal-Mart  1.00     10/29/12\n3           XYZ     Wal-Mart  2.00     10/30/12\n</code></pre>\n\n<p>Trying to use max function on DateOrdered, but when I include the vendor I get the last purchase for each vendor and item (too many rows). I need one record for each item. Any ideas on how to accomplish? Using MS Access 2007 with ODBC to oracle tables. Thanks in advance.</p>\n"},{"tags":["facebook","query","facebook-graph-api","facebook-fql"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13144102,"title":"Using FQL to retrieve facebook status's of all users who are using My Facebook Application","body":"<p>I would like to retrieve status's of all users who are using my Facebook application.\nI am not interested in retrieving the user's friends statuses only interested in retrieving the users who are using my Facebook application and have granted my application the \"read_stream\" permission.</p>\n\n<p>I can successfully retrieve status's of the logged in user or one of the logged in user's friends by calling:</p>\n\n<pre><code>SELECT post_id, message, attachment, type FROM stream WHERE source_id = \"SOME ID\" AND type IN (46, 247)\n</code></pre>\n\n<p>But that is not my goal. I would like to get \"All\" users who are using my Facebook application and get their latest status feed without any particular user being logged in.</p>\n\n<p>For example: I am not logged in facebook now neither or you. But when you click the link below you will get an RSS Feed of this particular user. This user is actually a business page so it is open to the public. Click This <a href=\"https://www.facebook.com/feeds/page.php?format=rss20&amp;id=152237754851522\" rel=\"nofollow\">Link</a> </p>\n\n<p>I would like to retrieve this information from users who allow my application \"read stream\" permissions.</p>\n\n<p>I cannot retrieve this information on personal Facebook user pages. So I am under the impression I need to build a Facebook Application to do so.</p>\n"},{"tags":["sql","query","select","join","left-join"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":6,"view_count":42,"score":-6,"question_id":13144251,"title":"query has to many joins","body":"<p>I have this query and works fine. I want to know another way of doing this ?</p>\n\n<pre><code>SELECT  UP.PHYS_RESR_ID,  UP.EQMT_INIT,  UP.EQMT_NBR,  UP.PRIM_OWN_INIT, UP.AAR_CAR_TYPE,  UP.AAR_CAR_CODE ,UP.AAR_END_DOOR_TYPE, UP.TOTL_AXLE_CNT,  UP.LAST_UPTD_DT,  UP.LAST_UPTD_USER_ID,   \n     EXTHGT.DIMN_VALU as EXTHGT , EXTHGT.UOM_CODE   as UNIT_EXTHGT  \n   , EXTWD.DIMN_VALU as EXTWD , EXTWD.UOM_CODE   as UNIT_EXTWD  \n   , INHGT.DIMN_VALU as INHGT , INHGT.UOM_CODE   as UNIT_INHGT  \n   , INLGTH.DIMN_VALU as INLGTH , INLGTH.UOM_CODE   as UNIT_INLGTH  \n   , INWDTH.DIMN_VALU as INWDTH , INWDTH.UOM_CODE   as UNIT_INWDTH  \n   , OUTLGT.DIMN_VALU as OUTLGT , OUTLGT.UOM_CODE   as UNIT_OUTLGT  \n   , SDHGT.DIMN_VALU as SDHGT , SDHGT.UOM_CODE   as UNIT_SDHGT  \n   , SDWDTH.DIMN_VALU as SDWDTH , SDWDTH.UOM_CODE   as UNIT_SDWDTH \n\n   FROM EQU_EQMT UPE \n\n  left join EQU_EQMT_DIMN EXTHGT on EXTHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID and EXTHGT.DIMN_TYPE = 'EXTHGT' and   ( EXTHGT.POS_DESC is null      or  EXTHGT.POS_DESC =  'VALU'      or  EXTHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN EXTWD on  EXTWD.PHYS_RESR_ID = UP.PHYS_RESR_ID   and EXTWD.DIMN_TYPE =  'EXTWD'      and   ( EXTWD.POS_DESC is null      or  EXTWD.POS_DESC =  'VALU'      or  EXTWD.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INHGT on  INHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INHGT.DIMN_TYPE =  'INHGT'      and   ( INHGT.POS_DESC is null      or  INHGT.POS_DESC =  'VALU'      or  INHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INLGTH on  INLGTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INLGTH.DIMN_TYPE =  'INLGTH'      and   ( INLGTH.POS_DESC is null      or  INLGTH.POS_DESC =  'VALU'      or  INLGTH.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INWDTH on  INWDTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INWDTH.DIMN_TYPE =  'INWDTH'      and   ( INWDTH.POS_DESC is null      or  INWDTH.POS_DESC =  'VALU'      or  INWDTH.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN OUTLGT on  OUTLGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and OUTLGT.DIMN_TYPE =  'OUTLGT'      and   ( OUTLGT.POS_DESC is null      or  OUTLGT.POS_DESC =  'VALU'      or  OUTLGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN SDHGT on  SDHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and SDHGT.DIMN_TYPE =  'SDHGT'      and   ( SDHGT.POS_DESC is null      or  SDHGT.POS_DESC =  'VALU'      or  SDHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN SDWDTH on  SDWDTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and SDWDTH.DIMN_TYPE =  'SDWDTH'      and   ( SDWDTH.POS_DESC is null      or  SDWDTH.POS_DESC =  'VALU'      or  SDWDTH.POS_DESC =  'valu'           );\n</code></pre>\n\n<p>I WANT TO DO A NEW QUERY THAT GIVES ME THE SAME INFO ANY ADVICES ?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13133234,"title":"MySQL Join table export to CSV with HTML body column","body":"<p>I've got below query to export to CSV with column body that has HTML values.</p>\n\n<p>Problem is even though when I replace comma with space, it doesn't show up properly (as in not appearing correctly) and also rows are not terminating with line break.</p>\n\n<pre><code>SELECT j.id,j.title,j.featured,REPLCAE(j.body,',',' '),j.created,j.created_by,j.start_date,j.end_date,j.apply_link,o.name,o.website,o.logo,o.created,p.code,p.suburb,s.name INTO OUTFILE '/tmp/careersandjobs.csv'\nFIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"'\nESCAPED BY '\\\\'\nLINES TERMINATED BY '\\n'\nFROM job j\nLEFT JOIN portfolio_job pj\nON pj.job_id = j.id\nLEFT JOIN organisation o\nON o.id = j.organisation_id\nLEFT JOIN postcode p\nON p.id = j.postcode_id\nLEFT JOIN state s\nON s.id = p.state_id\nWHERE published = 1\nAND end_date &gt; CURDATE()\nAND pj.port_id = 8\n</code></pre>\n\n<p>Is there a reason behind this?</p>\n\n<p>@Michael</p>\n\n<p>I've tried with what you suggested but it now generates this error:</p>\n\n<pre><code>Failed to execute SQL : SQL SELECT j.id,j.title,j.featured,REPLACE(j.body,',',' ') as body,j.created,j.created_by,j.start_date,j.end_date,j.apply_link,o.name,o.website,o.logo,o.created,p.code,p.suburb,s.name INTO OUTFILE '/tmp/careersandjobs.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' ESCAPED BY '\\\\' LINES TERMINATED BY \"\\n\" FROM job j LEFT JOIN portfolio_job pj ON pj.job_id = j.id LEFT JOIN organisation o ON o.id = j.organisation_id LEFT JOIN postcode p ON p.id = j.postcode_id LEFT JOIN state s ON s.id = p.state_id WHERE published = 1 AND end_date &gt; CURDATE() AND pj.port_id = 8 failed : Field separator argument is not what is expected; check the manual\n</code></pre>\n"},{"tags":["php","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13143965,"title":"PHP Export Date range","body":"<p>I have a working database export to xls but I need it to export a particular date range based on the 'closed' date. (See code below).</p>\n\n<p>For example, I'd like it to export all 'closed' dates for last month and/or this month (Range: Sept 1, 2012 to Sept 30, 2012  or  Oct 1, 2012 to Oct 31, 2012)</p>\n\n<pre><code>&lt;?PHP\n\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"ost_helpdesk\";                //your MySQL Database Name\n$DB_TBLName = \"ost_ticket\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select ticketID, name, company, subject, closed from $DB_TBLName ORDER BY closed DESC\";\n\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"MDT Database Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n\n     }\n}\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","query","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13143892,"title":"Is it really a good choice to transform every SQL query to functions call?","body":"<p>I would like to know if using functions call for most of SQL select in a software is a good idea ?</p>\n\n<p>Here are the pro argument that I found :</p>\n\n<ul>\n<li><p>faster, the sql engine already have the functions, and don't have to parse every query</p></li>\n<li><p>less data is transfered between the application and the sql engine</p></li>\n<li><p>better abstraction, as the application doesn't know about database implementation</p></li>\n<li><p>much bigger security, as the functions call are designed by a DBA</p></li>\n</ul>\n\n<p>I really don't like the idea of replacing most of my queries by functions call.</p>\n\n<p>I am wrong ? or is it really a great 'idea' ?</p>\n"},{"tags":["sql","query","join","row","max"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":54,"score":3,"question_id":13130524,"title":"SQL Query get data from one table, and get data from only one row from another table","body":"<p>I don't know how to explain my problem in the title, so I'll explain it better here...</p>\n\n<p>I have two tables</p>\n\n<pre><code>CREATE TABLE [dbo].[Ventas]\n(\n    [IdVenta] [int] IDENTITY(1,1) NOT NULL,\n    [FechaVenta] [date] NULL,\n    [HoraVenta] [varchar](10) NULL,\n    [Subtotal] [money] NULL,\n    [Iva] [money] NULL,\n    [Total] [money] NULL,\n    [Saldo] [money] NULL,\n    [Abono] [money] NULL,\n    [FormaDePago] [varchar](50) NULL,\n    [Plazos] [int] NULL,\n    [Estado] [varchar](50) NULL,\n)\n\nCREATE TABLE [dbo].[Plazos]\n(\n    [IdPlazo] [int] IDENTITY(1,1) NOT NULL,\n    [IdVenta] [int] NULL,\n    [NumeroPlazo] [int] NULL,\n    [FechaVencimiento] [date] NULL,\n    [FechaCorte] [date] NULL,\n    [FechaPenalizacion] [date] NULL,\n    [FechaLiquidacion] [date] NULL,\n    [Total] [money] NULL,\n    [Cargo] [money] NULL,\n    [Abono] [money] NULL,\n    [Estado] [varchar](50) NULL,\n)\n</code></pre>\n\n<p>now to add some data</p>\n\n<pre><code>INSERT [dbo].[Ventas] ([IdVenta], [FechaVenta], [HoraVenta], [Subtotal], [Iva], [Total], [Saldo], [Abono], [FormaDePago], [Plazos], [Estado]) VALUES (182, CAST(0x54360B00 AS Date), N'11:20', 500.0000, 55.0000, 555.0000, 333.0000, 222.0000, N'A Credito', 5, N'Pendiente De Pago')\nINSERT [dbo].[Ventas] ([IdVenta], [FechaVenta], [HoraVenta], [Subtotal], [Iva], [Total], [Saldo], [Abono], [FormaDePago], [Plazos], [Estado]) VALUES (183, CAST(0x54360B00 AS Date), N'12:29', 575.0000, 63.2500, 638.2500, 638.2500, 0.0000, N'Una Sola Exhibicion', 1, N'Pendiente De Pago')\n\n\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (93, 182, 1, CAST(0x54360B00 AS Date), CAST(0x57360B00 AS Date), CAST(0x5C360B00 AS Date), CAST(0x54360B00 AS Date), 111.0000, 0.0000, 111.0000, N'Liquidado')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (94, 182, 2, CAST(0x73360B00 AS Date), CAST(0x75360B00 AS Date), CAST(0x7A360B00 AS Date), CAST(0x54360B00 AS Date), 111.0000, 0.0000, 111.0000, N'Liquidado')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (95, 182, 3, CAST(0x91360B00 AS Date), CAST(0x94360B00 AS Date), CAST(0x99360B00 AS Date), NULL, 111.0000, 111.0000, 0.0000, N'Pendiente')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (96, 183, 1, CAST(0x54360B00 AS Date), CAST(0x57360B00 AS Date), CAST(0x5C360B00 AS Date), NULL, 639.0000, 639.0000, 0.0000, N'Pendiente')\n</code></pre>\n\n<p>Foreign Key On Ventas.IdVenta = Plazos.IdVenta</p>\n\n<p>Ok, Here's the deal...\nI need to use a query that brings data from all sales (Ventas), which only it supposed to be 2 rows...</p>\n\n<p>However, I need data from Plazos, but I only need data from Plazos \nWhat I need is to display data from plazos on the same row as Ventas, but only data from the most recent Plazo...</p>\n\n<p>you may notice that for example, in Plazos there is a column called NumeroPlazo which increases on the same IdVenta... what I need in this example is to display:</p>\n\n<p>Ventas IdVenta 182 with data from Plazos IdPlazo 95 (since from Plazos, IdPlazo 95 has the highest number on the column Numero Plazos...\nand of course IdVenta 183, but since it only has one Plazo, it will display data from that plazo...</p>\n\n<p>At the moment I had this query...</p>\n\n<pre><code>SELECT Ventas.*, Plazos.*, \nFROM Ventas INNER JOIN Plazos ON Plazos.IdVenta = Ventas.IdVenta \nWHERE Ventas.Estado = 'Pendiente De Pago' \nORDER BY Ventas.FechaVenta DESC, Ventas.HoraVenta DESC\n</code></pre>\n\n<p>but it returns 4 rows (3 rows for Venta where IdVenta = 182, and one where IdVenta = 183)\nWhat I want is only 2 rows...</p>\n\n<p>Then I tried this query that worked... but only for one row</p>\n\n<pre><code>SELECT Ventas.*, Plazos.*, \nFROM Ventas INNER JOIN Plazos ON Plazos.IdVenta = Ventas.IdVenta \nWHERE Ventas.Estado = 'Pendiente De Pago' \nAND Plazos.NumeroPlazo = (SELECT MAX(Plazos.NumeroPlazo) FROM Plazos WHERE Plazos.IdVenta = 182)\nORDER BY Ventas.FechaVenta DESC, Ventas.HoraVenta DESC\n</code></pre>\n\n<p>Obviously it only works for one sale since I specify Plazos.IdVenta = 182...\nMy question here is... how can I use the latter query to get the data I want for each sale...</p>\n\n<p>I hope yuo can help me...\nIf you need me to be more specific, please let me know.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13142611,"title":"Complex SQL query in string","body":"<p>I want to add this SQL Query into a php variable:</p>\n\n<p>But I have errors.. How can I add that SQL query in right format to the php variable..\nSo I can execute the query later on..</p>\n\n<pre><code>SELECT DISTINCT vtiger_account.account_no AS 'Accounts_Account_No'\n   , vtiger_account.accountname AS 'Accounts_Account_Name'\n   , vtiger_accountscf.cf_740 AS 'Accounts_Shipping_Street_Number'\n   , vtiger_accountshipads.ship_street AS 'Accounts_Shipping_Address'\n   , vtiger_accountshipads.ship_city AS 'Accounts_Shipping_City'\n   , vtiger_accountshipads.ship_state AS 'Accounts_Shipping_State'\n   , vtiger_accountshipads.ship_code AS 'Accounts_Shipping_Code'\n   , vtiger_accountshipads.ship_country AS 'Accounts_Shipping_Country'\n   , vtiger_accountshipads.ship_pobox AS 'Accounts_Shipping_Po_Box'\n   , vtiger_accountbillads.bill_state AS 'Accounts_Billing_State'\n   , vtiger_crmentity.crmid AS \"LBL_ACTION\"\nFROM vtiger_account\nINNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = vtiger_account.accountid\nINNER JOIN vtiger_accountbillads ON vtiger_account.accountid = vtiger_accountbillads.accountaddressid\nINNER JOIN vtiger_accountshipads ON vtiger_account.accountid = vtiger_accountshipads.accountaddressid\nINNER JOIN vtiger_accountscf ON vtiger_account.accountid = vtiger_accountscf.accountid\nLEFT JOIN vtiger_groups AS vtiger_groupsAccounts ON vtiger_groupsAccounts.groupid = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_account AS vtiger_accountAccounts ON vtiger_accountAccounts.accountid = vtiger_account.parentid\nLEFT JOIN vtiger_users AS vtiger_usersAccounts ON vtiger_usersAccounts.id = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_users AS vtiger_lastModifiedByAccounts ON vtiger_lastModifiedByAccounts.id = vtiger_crmentity.modifiedby\nWHERE vtiger_account.accountid &gt; 0\n   AND vtiger_crmentity.deleted = 0\n   AND (\n      (\n         vtiger_accountshipads.ship_state = 'WA'\n         OR vtiger_accountbillads.bill_state = 'WA'\n         )\n      AND (\n         trim(CASE \n               WHEN (vtiger_usersAccounts.last_name NOT LIKE '')\n                  THEN CONCAT (\n                        vtiger_usersAccounts.first_name\n                        , ' '\n                        , vtiger_usersAccounts.last_name\n                        )\n               ELSE vtiger_groupsAccounts.groupname\n               END) = 'HACO Australia'\n         OR trim(CASE \n               WHEN (vtiger_usersAccounts.last_name NOT LIKE '')\n                  THEN CONCAT (\n                        vtiger_usersAccounts.first_name\n                        , ' '\n                        , vtiger_usersAccounts.last_name\n                        )\n               ELSE vtiger_groupsAccounts.groupname\n               END) = 'Sam'\n         )\n      )\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13142202,"title":"SQL query to different tables and show all","body":"<p>On my php web I have 3 content type saved on different tables with different number of columns</p>\n\n<p>for example:</p>\n\n<pre><code>Type 1 (X columns) (example: table_products)\nType 2 (Y columns) (example: table_customers)\nType 3 (Z columns) (example: table_posts)\n</code></pre>\n\n<p>I'm making a Search system that searchs on each type in the same Select, showing finally all results.</p>\n\n<p>Example:</p>\n\n<pre><code>I search: foo\n\nSystem searchs on: Type 1, type 2 and type 3 \"foo\" and shows:\n\n- Product foo1\n- Product foo2\n- Customer foo1\n- Customer foo2\n- Customer foo3\n- Post foo1\n (It's only an example)\n</code></pre>\n\n<p>Now I have three different functions to make the query on each type, but I don't like this because I can't paginate it.</p>\n\n<p><strong>I need to make a query that searchs on three tables at time.</strong></p>\n\n<p>Thank you</p>\n"},{"tags":["php","sql","database","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13142196,"title":"Export specific table columns to Excel","body":"<p>I'm trying to export specific column data (i.e., Ticket #, Company/Customer Name, Issue Subject, Date Closed) from my SQL DB table to Excel (.xls), I have the code written but it's exporting my entire Database table. (See code Below)</p>\n\n<p>Specific column data that needs to be exported:</p>\n\n<ul>\n<li>ticketID</li>\n<li>name</li>\n<li>company</li>\n<li>subject</li>\n<li>closed</li>\n</ul>\n\n<p>Also is there any way to add a function that only exports a specific range (i.e., Date range from October 1, 2012 to October 31, 2012)?</p>\n\n<p><pre></p>\n\n<code>&lt;?PHP\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"my_databse\";                //your MySQL Database Name\n$DB_TBLName = \"my_table\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select * from $DB_TBLName\";\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y H:i');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //following fix suggested by Josue (thanks, Josue!)\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n     }\n}\n\n?&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["query","jpa","entity","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13128588,"title":"Limiting size of jpa association query","body":"<p>The following query gets all the employees in the department:</p>\n\n<pre><code>List&lt;Employee&gt; employees = em.find(Department.class,departmentid).getEmployeeList();\n</code></pre>\n\n<p>However, i am looking to get only a limited number of results from the above query and not complete resultset.  Is it possible via the above query?</p>\n\n<p>I am aware of em.createQuery() alternative however would like to use the existing one-to-many association in the entity and not write a new query to get limited results.</p>\n\n<p>Any help or ideas would be great.</p>\n"},{"tags":["sharepoint","query","content","webparts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1229,"score":0,"question_id":6975151,"title":"Sharepoint Content Query Webpart untrusted xsl file","body":"<p>I have created a custom xsl file for the Content Query Webpart. I assigned the path of the xsl file to the property \"MainXsl\" of the CQW. After I put the CQW to a sub sitecollection, it show me the following message: \"The web part references an untrusted XSL file. Only XSL files contained in this site's Style Library may be referenced.\"</p>\n\n<p>I have checked up, there is my xsl file in the sub sitecollection (Style Library/XSL Style Sheets) and is published.</p>\n\n<p>Please tell me how to solve this problem.</p>\n\n<p>Thanks a lot in advance.</p>\n\n<p>Best regards\nG-Nosis.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","exists"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13141461,"title":"What can I do to speed up this SQL Query?","body":"<p>I've created this SQL query with the help of @Dems :-)</p>\n\n<p>Here is some detail, I tried to make a SQLFiddle but I kept getting errors with my variables... This works in Sql Server 2008...  My question is, how can I make my query faster? I know I'm doing a number of things wrong here (repeated nester queries), I'm hoping to get one of you SQL gurus to take a look and help me get this down from it's 30 minute execution time! :-S</p>\n\n<p>I'm not sure exactly how much information you need to be able to help me on this one, please fire away with any questions and I'll reply ASAP.  Sorry if the level of detail is lacking a little, I just don't know what you want/need to know!</p>\n\n<p>The basic idea behind the query is that in the game I want to find all players which haven't moved 5 units for a period of time, who have fired whilst stood still and did not fire for 60 minutes before they stopped moving.  The query works, but it's the <code>AND NOT EXISTS</code> clause which is slowing things down to a crawl, before I added that it took 16 seconds to run!  16 seconds is still a looong time, so any other improvements would be appreciated, but for now with this being my own POC game (just throwing bits and pieces together), 16 seconds is acceptable... </p>\n\n<pre><code>DECLARE @n INT , @DistanceLimit INT\nSELECT  @n = 2 , @DistanceLimit = 5;\n\nWITH    partitioned\n          AS ( SELECT   * ,\n                        CASE WHEN Distance &lt; @DistanceLimit THEN 1\n                             ELSE 0\n                        END AS PartitionID\n               FROM     EntityStateEvent\n               WHERE    ExerciseID = '8B50D860-6C4E-11E1-8E70-0025648E65EC'\n             ),\n        sequenced\n          AS ( SELECT   ROW_NUMBER() OVER ( PARTITION BY PlayerID ORDER BY EventTime ) AS MasterSeqID ,\n                        ROW_NUMBER() OVER ( PARTITION BY PlayerID, PartitionID ORDER BY EventTime ) AS PartIDSeqID ,\n                        *\n               FROM     partitioned\n             ),\n        filter\n          AS ( SELECT   MasterSeqID - PartIDSeqID AS GroupID ,\n                        MIN(MasterSeqID) AS GroupFirstMastSeqID ,\n                        MAX(MasterSeqID) AS GroupFinalMastSeqID ,\n                        PlayerID\n               FROM     sequenced\n               WHERE    PartitionID = 1\n               GROUP BY PlayerID ,\n                        MasterSeqID - PartIDSeqID\n               HAVING   COUNT(*) &gt;= @n\n             )\n    SELECT\nDISTINCT    ( sequenced.PlayerID ) ,\n            MIN(sequenced.EventTime) AS StartTime ,\n            MAX(sequenced.EventTime) AS EndTime ,\n            DATEDIFF(minute, MIN(sequenced.EventTime),\n                     MAX(sequenced.EventTime)) AS StaticTime ,\n            Player.Designation AS 'Player'\n    FROM    filter\n            INNER JOIN sequenced ON sequenced.PlayerID = filter.PlayerID\n                                    AND sequenced.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                    AND sequenced.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n            INNER JOIN Events ON Events.FiringPlayerID = sequenced.PlayerID \n            INNER JOIN Player ON Player.PlayerID = sequenced.PlayerID\n                                 AND Player.Force = 'FR'\n                                 AND NOT EXISTS ( SELECT    *\n                                                  FROM      Events\n                                                  WHERE     Events.FiringPlayerID = Player.PlayerID\n                                                  GROUP BY  Events.FiringTime\n                                                  HAVING    Events.FiringTime BETWEEN DATEADD(minute,\n                                                              -60,\n                                                              ( SELECT\n                                                              MIN(s.EventTime)\n                                                              FROM\n                                                              sequenced s\n                                                              WHERE\n                                                              s.PlayerID = filter.PlayerID\n                                                              AND s.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                                              AND s.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n                                                              ))\n                                                              AND\n                                                              ( SELECT\n                                                              MIN(s.EventTime)\n                                                              FROM\n                                                              sequenced s\n                                                              WHERE\n                                                              s.PlayerID = filter.PlayerID\n                                                              AND s.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                                              AND s.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n                                                              ) )\n            INNER JOIN Player HitPlayer ON HitPlayer.PlayerID = Events.HitPlayerID\n    WHERE   HitPlayer.[FORCE] = 'HO'\n    GROUP BY GroupID ,\n            sequenced.PlayerID ,\n            Events.FiringPlayerID ,\n            Events.FiringTime ,\n            Player.Designation\n    HAVING  DATEDIFF(minute, MIN(sequenced.EventTime),\n                     MAX(sequenced.EventTime)) &gt; 5\n            AND Events.FiringTime BETWEEN MIN(sequenced.EventTime)\n                                  AND     MAX(sequenced.EventTime)\n    ORDER BY StartTime\n</code></pre>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13141236,"title":"MYSQL insert into first empty column","body":"<p>I have a tbl, for example:</p>\n\n<pre><code>uniqueId     |    col1    |    col2   |   col3   \nu1                 8       \nu2\nu3                 13           89\n</code></pre>\n\n<p>What I want is to insert into the first empty column (can make them null if that helps). In the given if I'll add to u1 the value 2 it will be inserted into col2. If I do it for u2, it will enter col1. and for u3 it will enter to u3. These three queries will do the trick but I would rather do it in one.</p>\n\n<p><code>INSERT INTO tbl SET col1 = $toInsertVal WHERE uniqueId=u col1=''</code><br>\n<code>INSERT INTO tbl SET col2 = $toInsertVal WHERE uniqueId=u col1&lt;&gt;'' AND col2=''</code><br>\n<code>INSERT INTO tbl SET col3 = $toInsertVal WHERE uniqueId=u col1&lt;&gt;'' AND col2&lt;&gt;'' AND col3=''</code></p>\n"},{"tags":["c#","database","query","parameters","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13139950,"title":"C#.net Parametize OLE DB Query using MS Access as DB","body":"<p>ok i do have a OLEDB function that inserts data in the database. well i know the usual way on how to do SQL with OLEDB but what I want to do here is to parametize each data in the query string. </p>\n\n<p>Now I been in Google for almost 3 hours just know how to make parametized query in OLEDB but all of them are not working with me.</p>\n\n<p>Now at last my query seems to work fine in the code below but still an error occurs</p>\n\n<p><strong>my function code :</strong></p>\n\n<pre><code>private bool dbInsert(int [] inputNumbers, DateTime datetime){\n                try {\n                    String sql = \"INSERT INTO 655(1stNum, 2ndNum, 3rdNum, 4thNum, 5thNum, 6thNum, datedraw) VALUES(?, ?, ?, ?, ?, ? ,?)\";\n                    OleDbCommand dbcmd = new OleDbCommand(sql, app.oleDbConn());\n                    dbcmd.Connection.Open();\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[0];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[1];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[2];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[3];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[4];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.Numeric).Value = inputNumbers[5];\n                    dbcmd.Parameters.Add(\"?\",OleDbType.DBTimeStamp).Value = datetime;\n                    dbcmd.ExecuteNonQuery();\n                    dbcmd.Connection.Close();\n\n                }catch(OleDbException ex){\n                    showPrompt(\"Error reading the database\",Color.Red);\n                    Console.WriteLine(ex.ToString());\n                }\n                return true;\n            }\n</code></pre>\n\n<p><strong>this is the error log show in the console:</strong></p>\n\n<blockquote>\n  <p>System.Data.OleDb.OleDbException: Data type mismatch in criteria\n  expression.    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult\n  hr)    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS\n  dbParams, Object&amp; executeResult)    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object&amp;\n  executeResult)    at\n  System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior\n  behavior, Object&amp; executeResult)    at\n  System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior\n  behavior, String method)    at\n  System.Data.OleDb.OleDbCommand.ExecuteNonQuery()</p>\n</blockquote>\n\n<p>the datatypes of my columns in my access db files are <strong>Numeric</strong> from 1stNum to 6thNum and <strong>Date/Time</strong> in datedraw, of course ID is <strong>AutoNumber</strong></p>\n\n<p>is there any mistake in the parametize query implementation? please help me.</p>\n\n<p><strong>Update</strong></p>\n\n<ul>\n<li>I change the OleDBType for nums to <strong>Numeric</strong> as in the Access file its <strong>Numeric</strong></li>\n</ul>\n"},{"tags":["ruby-on-rails","query","activerecord","count","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":633,"score":1,"question_id":4465591,"title":"ActiveRecord Grouping/Count Query Help Needed","body":"<p>I am using Rails 3.</p>\n\n<p>Suppose I have the following archetypical models:  Blog, Post, Comment, Category.  Blog has_many posts, Post has_many comments and belongs_to category.</p>\n\n<p>I want to know how many posts are in each category but only counting those that have comments.</p>\n\n<p>If I do the following:</p>\n\n<pre><code>blog.posts.group(\"category_id\").count\n</code></pre>\n\n<p>--This gives me an OrderedHash which is close to what I need but of course the problem is the count values include posts that have no comments.</p>\n\n<p>If I do:</p>\n\n<pre><code>blog.posts.group(\"category_id\").joins(\"comments\").count\n</code></pre>\n\n<p>--this gives me the number of comments that are in posts of that category (it does the same thing if I put the join before the grouping).</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["query","join","ms-access-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13128262,"title":"MS Access 07 - wildcard in JOIN query","body":"<p>I've got the following query</p>\n\n<pre><code>SELECT tblUsers.userfullname, \n       tblReports.reportdate, \n       tblReports.reportnumber, \n       tblRawData.reportcategory, \n       tblRawData.reportissue\nFROM tblRawData \nRIGHT JOIN (tblUsers RIGHT JOIN tblReports ON tblUsers.userID = tblReports.userID) ON tblReports.reportnumber LIKE \"*\" &amp; tblRawData.reportnum\nWHERE (\n       ((tblUsers.username) Like \"*\" &amp; [Forms]![frmSelect]![txtUser] &amp; \"*\") \n       AND\n       ((tblUsers.userShift) Like \"*\" &amp; [Forms]![frmSelect]![txtShift] &amp; \"*\")\n      );\n</code></pre>\n\n<p>Which works - except the part of </p>\n\n<pre><code>ON tblReports.reportnumber LIKE \"*\" &amp; tblRawData.reportnum\n</code></pre>\n\n<p>what i'm trying to match is instances where</p>\n\n<pre><code>tblReports.reportnumber = 410145\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tblRawData.reportnum = 12345.410145\n</code></pre>\n\n<p>or just </p>\n\n<pre><code>tblRawDatw.reportnum = 410145\n</code></pre>\n\n<p>but for some reason it just will not find that first match (ex: 12345.410145) unless the number is identical like the second match (ex: 410145).  I've tried formatting it as a number as well as text - and no luck.</p>\n\n<p>any idea what I may be missing?</p>\n\n<p>Update:  I tried making another query with just the two tables and it doesn't like to match.  i tried removing the \".\" (example: 12345.410145 into 12345410145) and no luck.  here's my second query.</p>\n\n<pre><code>SELECT tblReports.userID, \ntblRawData.reportnum,\ntblRawData.reportcategory,\ntblRawData.reportissue,\ntblReports.reportdate,\ntblReports.reportnumber\nFROM tblReports\nLEFT JOIN tblRawData ON tblReports.reportnumber LIKE \"*\" &amp; tblRawData.reportnum;\n</code></pre>\n\n<p>where if the data is like such.</p>\n\n<p>tblReports Report numbers:\n410145\n410144\n410143\n410142\n410141</p>\n\n<p>and tblRawData report numbers are such:\n12345.410145\n410143\n12344.410141</p>\n\n<p>the resulting query should show me all 5 records from tblReports - but three of those records have the notes and such from tblRawData.</p>\n"},{"tags":["mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13139717,"title":"MYSQL Query - need some assistance","body":"<p>I'm having a mysql table GAMES with the following columns: for example:</p>\n\n<pre><code>+-------+---------+\n| NAME  | PARTNER |\n+-------+---------+\n| Chris | Steven  |\n| Chris | Peter   |\n| Chris | Steven  |\n| Chris | Paul    |\n| Chris | Steven  |\n| Chris | Peter   |\n| Paul  | Chris   |\n| Paul  | Peter   |\n| Paul  | Steven  |\n| Paul  | Peter   |\n| Paul  | Peter   |\n| Paul  | Chris   |\n| Peter | Paul    |\n| Peter | Chris   |\n+-------+---------+\n</code></pre>\n\n<p>I would like to have a query for each name and the partner that they had most of the times, with an 'undefined' value if there is a ex aequo. So, for the above example the output should look something like this:</p>\n\n<pre><code>+-------+--------------+\n| NAME  | PARTNER_MOST |\n+-------+--------------+\n| Chris | Steven       |\n| Paul  | Peter        |\n| Peter | undefined    |\n+-------+--------------+\n</code></pre>\n\n<p>How could I achieve this in the most simple way? Thanks in advance!</p>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13066509,"title":"can anyone please help me understand this query?","body":"<p>Can anyone help me understand this query? The <code>mktpgmvhclxref.mktpgmvhclxrefId.mktgPgm</code> part mostly. Generally it is <code>table_name.columnName</code> but here the format seems to be different </p>\n\n<pre><code>SELECT mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm, \n       mktpgm.mktgpgm, \n       mktpgmvhclxref.cmpgn, \n       campaign.cmpgndescription, \n       mktpgmvhclxref.mktpgmvhclxrefid.vhcl, \n       vhclhierarchy.modname, \n       mktpgmvhclxref.mktpgmvhclxrefid.modyr, \n       mktpgmvhclxref.userinsrt, \n       mktpgmvhclxref.rowinsrt \nFROM   mktpgmvhclxref mktpgmvhclxref, \n       mktpgm mktpgm, \n       vhclhierarchy vhclHierarchy, \n       campaign campaign \nWHERE  mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm = mktpgm.idmktgpgm \n       AND mktpgmvhclxref.cmpgn = campaign.campaignid \n       AND mktpgmvhclxref.mktpgmvhclxrefid.vhcl = vhclhierarchy.vhcl \n</code></pre>\n"},{"tags":["sql","oracle","query","plsql","plsqldeveloper"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":56,"score":-1,"question_id":13138534,"title":"How to handle large string coming as an input parameter to the procedure?","body":"<p>I am getting 200 Supplier names as an input parameter with huge values to the stored procedure.I tried declaring in CLOB,VARCHAR2(32767).But when i try to execute it is not accepting.\nPlease anyone help me how to handle this   .</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE GMMT_PROC.or_rmce_RB_grid_sp (\n   p_plant_cd        IN VARCHAR2,\n   p_region_cd       IN VARCHAR2,\n   p_matrl_nbr       IN OUT VARCHAR2,\n   p_supplier_nbr    IN OUT VARCHAR2,\n   p_supplier_name   IN OUT CLOB,\n   p_mrpcontrollercd IN OUT VARCHAR2,\n   p_currency        IN   VARCHAR2,\n   oresultset        OUT  sys_refcursor,\n   p_err_cd          OUT  NUMBER,\n   p_err_msg         OUT  VARCHAR2\n)\nIS\nsqlquery varchar2(10000);\np1 varchar2(10);\np2 varchar2(20);\np3 varchar2(20);\np4 varchar2(20);\nv_percent varchar2(10):='%';\nV_FROM_CURRENCY VARCHAR2(5);\nV_EX_RATE NUMBER;\nv_matrl_nbr       VARCHAR2(10000);\nv_supplier_nbr    VARCHAR2(10000);\nv_supplier_name   CLOB;\nv_mrpcontrollercd  VARCHAR2(10000);\n\nBEGIN\np1:='matrl_nbr';\n v_matrl_nbr:=p_matrl_nbr;\n p2:='supplier_nbr';\n v_supplier_nbr :=p_supplier_nbr;\n p3:='supplier_name_txt';\n v_supplier_name :=p_supplier_name;\n p4:='mrp_controller_cd';\n v_mrpcontrollercd:=p_mrpcontrollercd; \nsqlquery:='select wk_nbr, nbr_working_days,'||p1||' as matrl_nbr ,'||p2||' as supplier_nbr,'||p3||' as supplier_name_txt,'||p4||' as mrp_controller_cd,sum(reqmnt_qty)reqmnt_qty , sum(proj_inven_qty)proj_inven_qty, sum(doh) doh,sum(proj_recpt_1) proj_recpt_1, sum(proj_recpt_2) proj_recpt_2, sum(proj_recpt_3) proj_recpt_3, sum(proj_recpt_4) proj_recpt_4,sum( proj_recpt_total_qty) proj_recpt_total_qty,sum(consumption_qty) consumption_qty, sum(consumption_var_qty) consumption_var_qty , sum(final_recpt_qty) final_recpt_qty,sum(recpt_var_qty) recpt_var_qty from GMMT_OWNER.OR_RMCE_GTT_PROJ_RECPT_T ';\nsqlquery:=sqlquery||' where ('''||v_matrl_nbr||''' IS NULL) OR matrl_nbr IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_matrl_nbr||'''))) OR matrl_nbr like '''|| v_matrl_nbr||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_supplier_nbr||''' IS NULL) OR supplier_nbr IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_supplier_nbr||'''))) OR supplier_nbr like '''|| v_supplier_nbr||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_supplier_name||''' IS NULL) OR supplier_name_txt IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_supplier_name||'''))) OR supplier_name_txt like '''|| v_supplier_name||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_mrpcontrollercd||''' IS NULL) OR mrp_controller_cd IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_mrpcontrollercd||'''))) OR mrp_controller_cd like '''|| v_mrpcontrollercd||v_percent||'''';\nsqlquery:=sqlquery||' group by wk_nbr, nbr_working_days,'||p1||','||p2||','||p3||','||p4||' order by wk_nbr';\n\nOPEN oresultset FOR sqlquery;\n\ndbms_output.put_line(sqlquery);\nEND;                \n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":44,"score":2,"question_id":13133208,"title":"MySQL Order by Two Columns","body":"<p>I have a Table Like Below</p>\n\n<pre>\n\n    CREATE TABLE Products(Product_id INT, ProductName VARCHAR(255), \n                          Featured enum('Yes', 'No'), Priority enum('p1', 'p2', 'p3'))\n\n\n    INSERT INTO Products(ProductName, Featured, Priority) \n                  VALUES('Product A', 'Yes', 'p1'),\n                        ('Product B', 'No',  'p2'),\n                        ('Product C', 'Yes', 'p1'),\n                        ('Product D', 'No',  'p1'),\n                        ('Product E', 'Yes', 'p3'),\n                        ('Product F', 'No',  'p2'),\n                        ('Product G', 'Yes', 'p1'),\n                        ('Product H', 'Yes', 'p2'),\n                        ('Product I', 'No',  'p2'),\n                        ('Product J', 'Yes', 'p3'),\n                        ('Product K', 'Yes', 'p1'),\n                        ('Product L', 'No',  'p3');\n\n\n</pre>\n\n<p>I Need to get the Featured products followed by product with priority p1, p2 and p3 </p>\n\n<pre>\n\nOp:\n   ProdName | Featured  | Priority\n\n    Product A   Yes         p1\n    Product C   Yes         p1\n    Product G   Yes         p1\n    Product K   Yes         p1\n    Product H   Yes         p2\n    Product E   Yes         p3\n    Product J   Yes         p3\n    Product D   No          p1\n    Product B   No          p2\n    Product F   No          p2\n    Product I   No          p2\n    Product L   No          p3\n\n</pre>\n\n<p>I Wrote a query below which ain't working..</p>\n\n<pre>                                           \n  SELECT * \n    FROM Products\n   ORDER BY Featured IN ('Yes') desc,\n            Priority IN ('p1', 'p2', 'p3') desc\n</pre>\n\n<p>Could u plz spot mistake in that</p>\n"},{"tags":["database","query","ms-access","report","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13134250,"title":"Two Queries: Group by Column, Subtract Similar Columns, Show Totals","body":"<p>I have the following two queries setup in Access.  Each query has only 1 line per org and the org names are consistent across the two queries.</p>\n\n<p>Query A (budget model based on Table A)</p>\n\n<pre><code>Org, Jan, Feb, ... Dec, Total\n-----------------------------\nA,   $68, $25, ... $51, $809\nB,   $23, $39, ... $13, $423\n...\nE,   $11, $90, ... $84, $789\n</code></pre>\n\n<p>Query B (budget model based on Table B)</p>\n\n<pre><code>Org, Jan, Feb, ... Dec, Total\n-----------------------------\nA,   $67, $25, ... $70, $821\nB,   $23, $39, ... $13, $423\n...\nE,   $15, $45, ... $71, $755\n</code></pre>\n\n<p>How can I create a report with all of the following information?  I'm having troubling bringing together the two queries, subtracting their values and then ultimately showing the totals rows all in the same report/query.</p>\n\n<pre><code>             Jan, Feb, ...  Dec,   Total\nOrg A:\n\n    Model A: $68, $25, ..., $51,   $809\n    Model B: $67, $25, ..., $70,   $821\n    A - B  : $ 1, $ 0, ..., ($19), ($12)\n\nOrg B:\n\n    Model A: $23, $39, ..., $13,   $423\n    Model B: $23, $39, ..., $13,   $423\n    A - B  : $ 0, $ 0, ..., $ 0,   $  0\n\n...\n\nOrg E:\n\n    Model A: $11, $90, ..., $84,   $789\n    Model B: $15, $45, ..., $71,   $755\n    A - B  :($ 4),$45, ..., $13,   $ 34\n\n-------------------------------------------\nTotals:\n\n    Model A: $102, $154, ..., $148,   $2021\n    Model B: $105, $109, ..., $154,   $1999\n    A - B  :($ 3), $45, ..., ($ 6),   $  22\n</code></pre>\n"},{"tags":["sql-server","query","sql-update","division","multiple-columns"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13137975,"title":"Divide by from selected columns","body":"<p>Sorry if the question was asked before i try search but not found. I'm still new on mssql so\nmaybe the answer are obvious just i cant find.</p>\n\n<p>My current query is:</p>\n\n<pre><code>SELECT gold_min, gold_max, gold_min_2, gold_max_2\nFROM m_rdb\n</code></pre>\n\n<p>I want to divide the values on current columns by 20 and then update, just not sure how to do.\nAny help are welcome. </p>\n"},{"tags":["php","mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":13136490,"title":"query for show nearest date descending in MySql","body":"<p>I have a event table which stored date (m/d/Y) in a following manner</p>\n\n<pre><code>eventid eventstart          eventend    status\n--------------------------------------------------------------\n    1       10/9/2012       10/27/2012  Active\n    2       4/3/2012        4/27/2012   Active\n    3       10/26/2012      10/27/2012  Active\n    4       2/7/2012        2/9/2012    Active\n    5       10/30/2012      10/31/2012  Active\n    6       10/9/2012       10/31/2012  Active\n    7       11/9/2012       10/19/2012  Active\n    8       10/31/2012      10/18/2012  Active\n</code></pre>\n\n<p>if i have input the date ie 10/29/2012 then i want to sort the startdate in the following manner </p>\n\n<pre><code>eventstart          \n-----------------\n10/30/2012\n10/31/2012 \n11/9/2012\n10/26/2012\n10/9/2012\n10/9/2012\n</code></pre>\n\n<p>can anyone help me</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13135552,"title":"oracle SQL how to remove time from date","body":"<p>I have a column named <code>StartDate</code> containing a date in this format: <code>03-03-2012 15:22</code></p>\n\n<p>What I need is to convert it to date. It should be looking like this: <code>DD/MM/YYYY</code></p>\n\n<p>What I have tried without success is:</p>\n\n<pre><code>select \np1.PA_VALUE as StartDate,\np2.PA_VALUE as EndDate\nfrom WP_Work p \nLEFT JOIN PARAMETER p1 on p1.WP_ID=p.WP_ID AND p1.NAME = 'StartDate'\nLEFT JOIN PARAMETER p2 on p2.WP_ID=p.WP_ID AND p2.NAME = 'Date_To'\nWHERE p.TYPE = 'EventManagement2'\nAND TO_DATE(p1.PA_VALUE, 'DD/MM/YYYY') &gt;= TO_DATE('25/10/2012', 'DD/MM/YYYY')\nAND TO_DATE(p2.PA_VALUE, 'DD/MM/YYYY') &lt;= TO_DATE('26/10/2012', 'DD/MM/YYYY')\n</code></pre>\n\n<p>Is there a way to do this?</p>\n\n<p>EDIT1: the <code>PA_VALUE</code> column is: <code>VARCHAR2</code></p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13136022,"title":"select from the result of execute(@query)","body":"<p>I am using this SQL query</p>\n\n<pre><code>DECLARE @cols AS NVARCHAR(MAX),\n    @query  AS NVARCHAR(MAX)\n\nselect @cols = STUFF((SELECT distinct ',' + QUOTENAME(Animal2) \n                    from animals\n            FOR XML PATH(''), TYPE\n            ).value('.', 'NVARCHAR(MAX)') \n        ,1,1,'')\n\nset @query = 'SELECT Animal1, ' + @cols + ' from \n             (\n                select animal1, animal2, Corelation\n                from animals\n            ) x\n            pivot \n            (\n                min(Corelation)\n                for animal2 in (' + @cols + ')\n            ) p '\n\nexecute(@query)\n</code></pre>\n\n<p>See <a href=\"http://sqlfiddle.com/#!3/5b713/6\" rel=\"nofollow\">SQL Fiddle with demo</a></p>\n\n<p>When I execute the query I get a table as a return.</p>\n\n<p>How can I select from that table? I tried to use <code>SELECT * FROM (*past here the script*)</code> but it did not work. I just need to use the result of the execute(@query) as a table and select from it (to put it in a new table). How can I do it?</p>\n\n<p>Thanks</p>\n\n<p>NOTE: that query was an answer of <a href=\"http://stackoverflow.com/questions/13125187/sql-query-to-select-records-in-a-specific-format-using-pivot-or-other/\">this SO question</a></p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13134944,"title":"SQL finding out the common values in two tables","body":"<p>I have two tables as <code>vMerkmale</code> and <code>aREL_Adr_Merk</code>. They have one common attribute as <code>MID</code>. I want to bind <code>Mtitel</code> from <code>merkmale</code> whose  <code>MID</code>'s are common with <code>aREl_Adr_Merk</code>. BUT , the problem is that , when I choose two IDs then it binds all values of these two IDs. I JUST WANT  TO Bind their common  MTITEL Values. MY code is below..</p>\n\n<pre><code>   SELECT M.mtitel as Attribute FROM vMerkmale  M ,aREL_Adr_Merk R\n   where m.mid=R.MID and AdrID in(252674,247354) \n   group by M.MTitel\n</code></pre>\n"},{"tags":["php","wordpress","query","wordpress-plugin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13134813,"title":"Tags import export wordpress query","body":"<p>I have been try to code a plugin to import/export wordpres tags from excel file to database. but i am confused that what will be the SQL Query for that to extract the complete list of tags from wordpress database. </p>\n\n<p>please guide me how can i figure out this.</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","sql","query","date","max"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13121742,"title":"MySQL Query: Write max(Date) from whole table to each row","body":"<p>I need to find the max(n.LastEdited) (Latest Editing Date) for my whole table and write it on each row.</p>\n\n<p>What I have:</p>\n\n<pre><code>SELECT n.ID,\nn.Title,\nn.News,\n(SELECT max(n.LastEdited)) AS NewsLastEdited\nFROM News AS n\nORDER BY n.ID DESC\nLIMIT 0,20\n</code></pre>\n\n<p>What I get (not showing ID, Title, News, ...):</p>\n\n<pre><code>NewsLastEdited\n2012-10-25 10:54:24\n2012-10-25 10:54:12\n2012-10-25 10:54:02\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>NewsLastEdited\n2012-10-25 10:54:24\n2012-10-25 10:54:24\n2012-10-25 10:54:24\n</code></pre>\n"},{"tags":["ruby-on-rails","query","controller","production"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":13130195,"title":"Rails - query works in view and controller in development, but only in view in production","body":"<p>I'm new to rails, so my question may have a simple answer. I am using rails 3.2.3. I have the following code to perform a search on my database:</p>\n\n<p><code>@search_results = User.search(\"test search\")</code></p>\n\n<p>Where <code>search</code> is defined in my model. This code works perfectly for me when <code>@search_results = Data.search(\"test search\")</code> is in either the view or controller in my development environment. In production, it works in the view, but not in the controller. I don't know why. Looking at my production log, there is a big difference in the SQL for the view and the controller:</p>\n\n<p>When query is from a view in production, this is what I see in the log:</p>\n\n<pre><code>SELECT 'users'.* FROM 'users' WHERE (concat(field1, ' ', field2, ' ', field3) LIKE '%test%' AND concat(field1, ' ', field2, ' ', field3) LIKE '%search%'\n</code></pre>\n\n<p>That is exactly what I want. However, when query is from controller, the SQL turns into this:</p>\n\n<pre><code>SELECT 'users'.* FROM 'users' WHERE (field1 LIKE '%test search%' OR field2 LIKE '%test search%' OR field3 LIKE '%test search%')\n</code></pre>\n\n<p>I don't understand what my controller in the production environment is doing to create this change.</p>\n\n<p>EDIT-Here is the <code>search</code> method:</p>\n\n<pre><code>def self.search(search)\n  if search\n    search_length = search.split.length\n     find(:all, :conditions =&gt; [([\"concat(field1, ' ', field2, ' ', field3) LIKE ?\"] *        search_length).join(' AND ')] + search.split.map { |name| \"%#{name}%\" }) \n  else\n    find(:all)\n  end\nend\n</code></pre>\n\n<p>I am using MySQL on both production and development.</p>\n"},{"tags":["oracle","query","notin"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":224,"score":3,"question_id":12982568,"title":"NOT IN query... odd results","body":"<p>I need a list of users in one database that are not listed as the <code>new_user_id</code> in another.  There are 112,815 matching users in both databases; <code>user_id</code> is the key in all queries tables.</p>\n\n<p><br />\nQuery #1 works, and gives me 111,327 users who are NOT referenced as a new_user_Id.  But it requires querying the same data twice.</p>\n\n<pre><code>-- 111,327 GSU users are NOT listed as a CSS new user \n--   1,488 GSU users ARE listed as a new user in CSS\n--\nselect count(gup.user_id)\nfrom   gsu.user_profile gup\n  join (select cud.user_id, cud.new_user_id, cud.user_type_code\n        from   css.user_desc cud) cudsubq\n    on gup.user_id = cudsubq.user_id\nwhere  gup.user_id not in (select cud.new_user_id \n                           from   css.user_desc cud\n                           where  cud.new_user_id is not null);\n</code></pre>\n\n<p><br />\nQuery #2 would be perfect... and I'm actually surprised that it's syntactically accepted.  But it gives me a result that makes no sense.</p>\n\n<pre><code>-- This gives me 1,505 users... I've checked, and they are not\n-- referenced as new_user_ids in CSS, but I don't know why the ones \n-- that were excluded were excluded.\n--\n-- Where are the missing 109,822, and whatexcluded them?\n-- \nselect count(gup.user_id)\nfrom   gsu.user_profile gup\n  join (select cud.user_id, cud.new_user_id, cud.user_type_code\n        from   css.user_desc cud) cudsubq\n    on gup.user_id = cudsubq.user_id\nwhere  gup.user_id not in (cudsubq.new_user_id);\n</code></pre>\n\n<p><br />\nWhat exactly is the where clause in the second query doing, and why is it excluding 109,822 records from the results?</p>\n\n<p><br />\n<strong>Note</strong>  The above query is a simplification of what I'm really after.  There are other/better ways to do the above queries... they're just representative of the part of the query that's giving me problems.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13131172,"title":"MySQL table value1 less than table value2","body":"<p>I have an issue here.\nThis is what I have: <code>mysql_query(\"SELECT * FROM hosts WHERE location='$locid' AND currentservers &lt; maxservers\");</code></p>\n\n<p>So, what I want to do is to select everything from a table where location is equal to the value and currentservers less than maxservers. I haven't tested this out yet since the whole function I'm making is quite large. currentservers and maxservers are columns in the table.</p>\n\n<p>Will this query work?\nAlso, I only want to return 1 row. How do I do that?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Best Regards,\nTom.</p>\n"},{"tags":["mysql","query","pagination","double"],"answer_count":7,"favorite_count":10,"up_vote_count":28,"down_vote_count":0,"view_count":12422,"score":28,"question_id":818567,"title":"MySQL pagination without double-querying?","body":"<p>I was wondering if there was a way to get the number of results from a MySQL query, and at the same time limit the results.</p>\n\n<p>The way pagination works (as I understand it), first I do something like</p>\n\n<pre><code>query = SELECT COUNT(*) FROM `table` WHERE `some_condition`\n</code></pre>\n\n<p>After I get the num_rows(query), I have the number of results. But then to actually limit my results, I have to do a second query like:</p>\n\n<pre><code>query2 = SELECT COUNT(*) FROM `table` WHERE `some_condition` LIMIT 0, 10\n</code></pre>\n\n<p>My question: Is there anyway to both retrieve the total number of results that would be given, AND limit the results returned in a single query? Or any more efficient way of doing this. Thanks!</p>\n"},{"tags":["mysql","query","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13129689,"title":"Speeding up MySQL SELECT queries with no results","body":"<p>I have a MySQL table of restaurants, described like so:</p>\n\n<pre><code> CREATE TABLE `restaurants` (\n    `id` int(11) NOT NULL AUTO_INCREMENT,\n    `name` varchar(32) NOT NULL,\n    `description` varchar(512) NOT NULL,\n    `tags` varchar(512) DEFAULT NULL,\n    `type` enum('A','D','E','L','Q','R','P','T','Z') NOT NULL,\n    `popularity` int(11) DEFAULT '0',\n    PRIMARY KEY (`id`),\n    UNIQUE KEY `uc_type_name` (`type`,`name`),\n    KEY `name_idx` (`name`),\n    KEY `type_popularity_idx` (`type`,`popularity`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>Here is some status info about the table:</p>\n\n<pre><code>Name: restaurants\n    Engine: MyISAM\n    Version: 10\n    Row_format: Dynamic\n    Rows: 72999\n    Avg_row_length: 84\n    Data_length: 6204488\n    Max_data_length: 281474976710655\n    Index_length: 5280768\n    Data_free: 0\n    Auto_increment: 75634\n    Collation: utf8_general_ci\n    Checksum: NULL\n    Create_options:\n    Comment:\n</code></pre>\n\n<p>I am trying to build a query that returns the 6 most popular restaurants that match a given term for a given restaurant type:</p>\n\n<pre><code>SELECT `id`, `name`, `type`, `description` FROM `restaurants` \nWHERE `type` = 'A'\n      AND (`name` LIKE '%some restaurant%'\n           OR `description` LIKE '%some restaurant%' \n           OR `tags` LIKE '%some restaurant%')\nORDER BY `popularity` DESC\nLIMIT 6\n</code></pre>\n\n<p>One of the restaurant types, A, contains 61,500 of the restaurants. Furthermore, these A type restaurants often have relatively long descriptions and names. Therefore, when there are no results for the lookup for type A, the queries take as long as 0.8-0.9 seconds. When there are results, however, they run as fast as 0.1 seconds.</p>\n\n<p>How can I speed up the performance of this query?</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13129705,"title":"How can I get data from database?","body":"<p>A guy did some php/database work for me a while back. He linked the pages to a menu (which had a separate function/table). I'm a little lost on how it's beneficial to link everything to a menu like that.</p>\n\n<p>Here's the code I'm trying to figure out:</p>\n\n<pre><code>function writeContent($page){\n$parentQ = \"select * from cdi_content where page=\\\"$page\\\"\";//query to obtain content for this page\n$parentResult = mysql_query($parentQ);//run query\n$link = mysql_fetch_assoc($parentResult);//result\necho $link['content'];//write content`\n}\n</code></pre>\n\n<p>With <code>&lt;?php writeContent(\"DDesign/index.php\");?&gt;</code> on the index.php page he created.</p>\n\n<p>From what I understand it runs through the menu function, but I'm just trying to get it to print what's in the \"content\" field in the database.</p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13128239,"title":"Getting data from multiple tables using joins","body":"<p>I have various tables like </p>\n\n<pre>Student\nprimary id , students name, course\n\nPapers\npaper id, papername, course, semester, type\n\nStudentOptions\nprimary id, studentid (foreign key - reference student id) and paperid (foreign key - references paper id)\n\nStudentsTerm\nstudentid (foreign key- references student id) and student semester</pre>\n\n<p>Now the kind of result i want is,</p>\n\n<p>I want to choose a course then the term, which will give me the number of papers/subject it has with their types (Mandatory/Optional) and with that i want to have the count of number of students studying those papers from all these tables.</p>\n\n<p>I don't wanna create any view or stuff, Just a normal select query will do. </p>\n\n<p>The query i am running is :</p>\n\n<pre><code>SELECT p_name,\n       p_id,\n       type,\n       Count(sps.studentid) AS counts\nFROM   students,\n       str,\n       papers\n       LEFT JOIN sps\n              ON sps.paperid = papers.p_id\nWHERE  sps.studentid = students.studentid\n       AND students.studentid = str.studentid\n       AND sps.studentid = str.studentid\n       AND str.semesterid = p_semid\n       AND str.sessionid = 12\n       AND students.course = c_id\n       AND c_id = 6\n       AND p_semid = 1\nGROUP  BY p_id \n</code></pre>\n\n<p>Thanks for your help in advance.</p>\n"},{"tags":["python","mysql","django","query","django-models"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13127526,"title":"Django Query Optimization - Using Itertools","body":"<p>I have an educational site that serves up curriculum based upon Grade level.</p>\n\n<ol>\n<li><p>The GradeLevel table stores all of the possible Grade Levels. Then I have LessonCategories and LessonCurriculum tables.</p></li>\n<li><p>The GradeLevel table has reverse relationships established with the curriculum and categories tables.</p></li>\n<li><p>I loop through each grade in the GradeLevel table, (8 grades), and grab the respective, curriculum and categories along the way.</p></li>\n<li><p>Upon completion, I stuff all of the collected curriculum and categories into a list and and pass that to my template.</p></li>\n</ol>\n\n<p>Now, the problem is that Django is evaluating each query AT LEAST twice. Once for the initial request and the second when I put it into the list. (I am using itertools to chain the results. Itertools is causing the queries to be run again.) This is having the adverse effect of slowing my server down to a crawl.</p>\n\n<p>My question is if someone could take a look at my models and queries and make a suggestion as to a better way to query as to avoid and/or mitigate this MAJOR performance bottle-neck.</p>\n\n<p><strong>GradeLevel Model:</strong></p>\n\n<pre><code>class GradeLevel(models.Model):\n    title = models.CharField('Grade',max_length=10, null=True, blank=True, db_index=True)\n    fullname = models.CharField('Description',max_length=100, null=True, blank=True, db_index=True)\n</code></pre>\n\n<p><strong>LessonCategory Model:</strong></p>\n\n<pre><code>class LessonCategory(models.Model):\n    title = models.CharField(max_length=255, null=True, blank=True, db_index=True)\n    ...\n    gradelevel = models.ManyToManyField(GradeLevel, related_name='grade_cats', null=True, blank=True)\n</code></pre>\n\n<p><strong>LessonCurriculum:</strong></p>\n\n<pre><code>class LessonCurriculum(models.Model):         \n    title = models.CharField(max_length=255, null=True, blank=True, db_index=True)\n    ...\n    gradelevel = models.ManyToManyField(GradeLevel, related_name='grade_curriculum', null=True, blank=True)\n</code></pre>\n\n<p>My View:</p>\n\n<pre><code>from itertools import chain\nfrom operator import attrgetter\n\ndef my_view(request):\n    grade_pk =  GradeLevel.objects.prefetch_related().get(title='pre-k')\n    grade_pk_categories = grade_pk.grade_cats.filter(active=True,featured=True)\n    grade_pk_galleries = grade_pk.grade_curriculum.filter(active=True,featured=True)\n\n    grade_k =  GradeLevel.objects.prefetch_related().get(title='k')\n    grade_k_categories = grade_k.grade_cats.filter(active=True,featured=True)\n    grade_k_galleries = grade_k.grade_curriculum.filter(active=True,featured=True)\n\n    grade_1 =  GradeLevel.objects.prefetch_related().get(title='1')\n    grade_1_categories = grade_1.grade_cats.filter(active=True,featured=True)\n    grade_1_galleries = grade_1.grade_curriculum.filter(active=True,featured=True)\n\n    grade_2 =  GradeLevel.objects.prefetch_related().get(title='2')\n    grade_2_categories = grade_2.grade_cats.filter(active=True,featured=True)\n    grade_2_galleries = grade_2.grade_curriculum.filter(active=True,featured=True)\n\n    grade_3 =  GradeLevel.objects.prefetch_related().get(title='3')\n    grade_3_categories = grade_3.grade_cats.filter(active=True,featured=True)\n    grade_3_galleries = grade_3.grade_curriculum.filter(active=True,featured=True)\n\n    grade_4 =  GradeLevel.objects.prefetch_related().get(title='4')\n    grade_4_categories = grade_4.grade_cats.filter(active=True,featured=True)\n    grade_4_galleries = grade_4.grade_curriculum.filter(active=True,featured=True)\n\n    grade_5 =  GradeLevel.objects.prefetch_related().get(title='5')\n    grade_5_categories = grade_5.grade_cats.filter(active=True,featured=True)\n    grade_5_galleries = grade_5.grade_curriculum.filter(active=True,featured=True)\n\n    grade_6 =  GradeLevel.objects.prefetch_related().get(title='6')\n    grade_6_categories = grade_6.grade_cats.filter(active=True,featured=True)\n    grade_6_galleries = grade_6.grade_curriculum.filter(active=True,featured=True)\n\n    grade_7 =  GradeLevel.objects.prefetch_related().get(title='7')\n    grade_7_categories = grade_7.grade_cats.filter(active=True,featured=True)\n    grade_7_galleries = grade_7.grade_curriculum.filter(active=True,featured=True)\n\n    grade_8 =  GradeLevel.objects.prefetch_related().get(title='8')\n    grade_8_categories = grade_8.grade_curriculum.filter(active=True,featured=True)\n    grade_8_galleries = grade_8.grade_curriculum.filter(active=True,featured=True)\n\n    gallery_list = list(set(sorted(chain(grade_pk_categories,grade_pk_galleries,grade_k_categories,grade_k_galleries,grade_1_categories,grade_1_galleries,grade_2_categories,grade_2_galleries,grade_3_categories,grade_3_galleries,grade_4_categories,grade_4_galleries,grade_5_categories,grade_5_galleries,grade_6_categories,grade_6_galleries,grade_7_categories,grade_7_galleries,grade_8_categories,grade_8_galleries), key=attrgetter('display_order'))))\n</code></pre>\n"},{"tags":["sql","mysql","query","join","subquery"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1249,"score":3,"question_id":4853203,"title":"SQL JOIN To Find Records That Don't Have a Matching Record With a Specific Value","body":"<p>I'm trying to speed up some code that I wrote years ago for my employer's purchase authorization app.  Basically I have a SLOW subquery that I'd like to replace with a JOIN (if it's faster).  </p>\n\n<p>When the director logs into the application he sees a list of purchase requests he has yet to authorize or deny. That list is generated with the following query:</p>\n\n<pre><code>SELECT * FROM SA_ORDER WHERE ORDER_ID NOT IN\n    (SELECT ORDER_ID FROM SA_SIGNATURES WHERE TYPE = 'administrative director');\n</code></pre>\n\n<p>There are only about 900 records in sa_order and 1800 records in sa_signature and this query still takes about 5 seconds to execute. I've tried using a LEFT JOIN to retrieve records I need, but I've only been able to get sa_order records with NO matching records in sa_signature, and I need sa_order records with \"no matching records with a type of 'administrative director'\".  Your help is greatly appreciated!</p>\n\n<p>The schema for the two tables is as follows:</p>\n\n<p>The tables involved have the following layout:</p>\n\n<pre><code>CREATE TABLE sa_order\n(\n    `order_id`        BIGINT       PRIMARY KEY AUTO_INCREMENT,\n    `order_number`    BIGINT       NOT NULL,\n    `submit_date`     DATE         NOT NULL,\n    `vendor_id`       BIGINT       NOT NULL,\n    `DENIED`          BOOLEAN      NOT NULL DEFAULT FALSE,\n    `MEMO`            MEDIUMTEXT,\n    `year_id`         BIGINT       NOT NULL,\n    `advisor`         VARCHAR(255) NOT NULL,\n    `deleted`         BOOLEAN      NOT NULL DEFAULT FALSE\n);\n\nCREATE TABLE sa_signature\n(\n    `signature_id`        BIGINT          PRIMARY KEY AUTO_INCREMENT,\n    `order_id`            BIGINT          NOT NULL,\n    `signature`           VARCHAR(255)    NOT NULL,\n    `proxy`               BOOLEAN         NOT NULL DEFAULT FALSE,\n    `timestamp`           TIMESTAMP       NOT NULL DEFAULT NOW(),\n    `username`            VARCHAR(255)    NOT NULL,\n    `type`                VARCHAR(255)    NOT NULL\n);\n</code></pre>\n"},{"tags":["mysql","database","performance","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13127703,"title":"need a sql query to find out the Database wait time ratio for MySQL","body":"<p>Oracle supports sql queries to <code>SYS.V_$SYSMETRIC</code> to find out Database Wait Time Ratio (% of wait or bottlenecks experienced in time spent on user-level calls)  <a href=\"http://www.oracle.com/technetwork/articles/schumacher-analysis-099313.html\" rel=\"nofollow\">http://www.oracle.com/technetwork/articles/schumacher-analysis-099313.html</a>. What is an equivalent query to find similar stats for MySQL database? </p>\n\n<p>I have looked at <code>information_schema.PROFILING</code> and <code>information_schema.PROCESSLIST</code> tables to calculate a similar measure but unable to comprehend what values to use / address.</p>\n\n<p>Any suggestions?</p>\n\n<p>I need it for both Windows and Linux Platforms with remote MySql server. I think a light-weight DB query would help as opposed to gathering CPU Utilization for the machine hosting MySQL server. </p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","query","join","subquery"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13127389,"title":"SQL SubQuery from same data table","body":"<p>I'm having trouble wrapping my head around what should be a pretty simple query in MS SQL. I have two tables: <code>Employees</code> and <code>Departments</code>. </p>\n\n<p><code>Employees</code> consists of the standard items: <code>ID (pkey int)</code>, <code>FName</code>, <code>LName</code>, ... , <code>DepartmentID</code>.</p>\n\n<p><code>Departments</code> consists of <code>DepartmentID</code>, <code>DepartmentName</code>, ... , <code>ManagerID</code>.</p>\n\n<p>There is a relationship from <code>Employees.DepartmentID</code> to <code>Departments.DepartmentID</code>, and a relationship between <code>Departments.ManagerID</code> and <code>Employees.EmployeeID</code>. </p>\n\n<p>In other words, each employee has a department, and each department has a manager that is also an employee.</p>\n\n<p>I'm trying to create a view that will display the employee name, ... , department, and department manager.</p>\n\n<p>I keep getting an error that more than one value is being returned when using this code:</p>\n\n<pre><code>SELECT\nEmployees_1.EmployeeID, Employees_1.FirstName, Employees_1.LastName, \nDepartments_1.DepartmentName,\n(SELECT\n    dbo.Employees.LastName\n    FROM dbo.Employees \n    INNER JOIN dbo.Departments\n      ON dbo.Departments.DepartmentManager = dbo.Employees.EmployeeID\n) AS ManagerName\nFROM dbo.Employees AS Employees_1\nINNER JOIN dbo.Departments AS Departments_1 \n  ON Employees_1.Department = Departments_1.DepartmentID \n  AND Employees_1.EmployeeID = Departments_1.DepartmentManager\n</code></pre>\n\n<p>Any ideas on how to join back to the same table (different row) based on the relationship from a second table?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13127216,"title":"Improving query performance/rewriting query to be faster on MySQL","body":"<p>I have a couple of queries that run very slowly (several minutes) with the data currently in my database, and I'd like to improve their performance. Unfortunately they're kind of complex so the info I'm getting via google isn't enough for me to figure out what indexes to add or if I need to rewrite my queries or what... I'm hoping someone can help. I don't <em>think</em> they should be this slow, if things were set up properly.</p>\n\n<p>The first query is: </p>\n\n<pre><code>SELECT i.name, i.id, COUNT(c.id) \nFROM cert_certificates c \nJOIN cert_histories h ON h.cert_certificate_id = c.id \nLEFT OUTER JOIN inspectors i ON h.inspector_id = i.id\nLEFT OUTER JOIN cert_histories h2 \n  ON (h2.cert_certificate_id = c.id AND h.date_changed &lt; h2.date_changed)\nWHERE (h.cert_status_ref_id = ? OR h.cert_status_ref_id = ?) \n  AND h2.id IS NULL\nGROUP BY i.id, i.name\nORDER BY i.name</code></pre>\n\n<p>The second query is:</p>\n\n<pre><code>SELECT l.letter, c.number\nFROM cert_certificates c \nJOIN cert_type_letter_refs l ON c.cert_type_letter_ref_id = l.id\nJOIN cert_histories h ON h.cert_certificate_id = c.id\nLEFT OUTER JOIN cert_histories h2 \n  ON (h2.cert_certificate_id = c.id AND h.date_changed &lt; h2.date_changed)\nWHERE h.cert_status_ref_id = ? \n  AND h2.id IS NULL \n  AND h.inspector_id = ?\nORDER BY l.letter, c.number\n</code></pre>\n\n<p>The cert_certificates table contains nearly 19k records as does the cert_histories table (although in the future this table is expected to grow to approximately 2-3x the size of the cert_certificates table). The other tables are all quite small; less than 10 records each.</p>\n\n<p>The only indexes right now are on id for each table and on cert_certificates.number. I read in a couple of places (e.g. <a href=\"http://stackoverflow.com/questions/3658859/when-to-add-what-indexes-in-a-table-in-rails\">here</a>) to add indices for foreign keys, but in the case of the cert_histories table that'd be nearly all the columns (cert_certificate_id, inspector_id, cert_status_ref_id) which is also <a href=\"http://stackoverflow.com/questions/5447987/why-cant-i-simply-add-an-index-that-includes-all-columns\">not advisable</a> (according to some of the answers on that question e.g. Markus Winand's), so I'm kinda lost.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>ETA: The results from EXPLAIN on the first query are (sorry for the hideous formatting; I'm using SQLyog which presents it in a nice table but it seems StackOverflow doesn't support tables?):</p>\n\n<pre>id select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  h   ALL NULL    NULL    NULL    NULL    19740   Using where; Using temporary; Using filesort\n1   SIMPLE  i   ref index_inspectors_on_id  index_inspectors_on_id  768 marketing_development.h.inspector_id    1   \n1   SIMPLE  c   ref index_cert_certificates_on_id   index_cert_certificates_on_id   768 marketing_development.h.cert_certificate_id 91  Using where; Using index\n1   SIMPLE  h2  ALL NULL    NULL    NULL    NULL    19740   Using where</pre>\n\n<p>Second query:</p>\n\n<pre>id select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  h   ALL NULL    NULL    NULL    NULL    19795   Using where; Using temporary; Using filesort\n1   SIMPLE  c   ref index_cert_certificates_on_id   index_cert_certificates_on_id   768 marketing_development.h.cert_certificate_id 91  Using where\n1   SIMPLE  l   ALL index_cert_type_letter_refs_on_id   NULL    NULL    NULL    5   Using where; Using join buffer\n1   SIMPLE  h2  ALL NULL    NULL    NULL    NULL    19795   Using where</pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13124279,"title":"MYSQL query return empty result","body":"<p>I need to look up email preferences for users. </p>\n\n<p>This table contains the types of email a user can receive, broken down by category. </p>\n\n<pre><code>email_preferences_categories\n\n+----------+------------------+------+-----+---------+----------------+\n| Field    | Type             | Null | Key | Default | Extra          |\n+----------+------------------+------+-----+---------+----------------+\n| id       | int(10) unsigned | NO   | PRI | NULL    | auto_increment |\n| name     | text             | YES  |     | NULL    |                |\n| overview | text             | YES  |     | NULL    |                |\n+----------+------------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>This table contains their preference for receiving various types. If they haven't set their preferences, this table won't have any rows for them.</p>\n\n<pre><code>email_preferences\n\n+------------+---------------------------------+------+-----+---------+----------------+\n| Field      | Type                            | Null | Key | Default | Extra          |\n+------------+---------------------------------+------+-----+---------+----------------+\n| id         | int(10) unsigned                | NO   | PRI | NULL    | auto_increment |\n| user_id    | int(10) unsigned                | NO   |     | NULL    |                |\n| name       | text                            | YES  |     | NULL    |                |\n| frequency  | enum('Daily','Monthly','None')  | YES  |     | Daily   |                |\n+------------+---------------------------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>I need to construct a MYSQL query that returns the name and frequency corresponding to the email preferences for a given user. </p>\n\n<pre><code>SELECT name, frequency\nFROM email_preferences\nLEFT JOIN email_preferences_categories using (name)\nWHERE user_id = 42\n</code></pre>\n\n<p>Where I'm having trouble: If the user hasn't set their preferences, this query doesn't return any rows. I would like it to return the default of 'Daily' for email categories that are missing.</p>\n"},{"tags":["php","query","sugarcrm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":219,"score":0,"question_id":8838975,"title":"SugarCRM Get Last Email Date and Search on it","body":"<p>So I have been working with SugarCRM pretty extensively lately and I need to be able to display the last date a contact was emailed as well search based on how long ago a contact was emailed.  </p>\n\n<p>I can easily create a logic hook to get the last email date but I cannot search based on the value of that.</p>\n\n<p>So I looked in SearchFields.php and found the following code which obviously gets the email of the contact. </p>\n\n<pre><code>'email' =&gt; \n  array (\n    'query_type' =&gt; 'default',\n    'operator' =&gt; 'subquery',\n    'subquery' =&gt; 'SELECT eabr.bean_id FROM email_addr_bean_rel eabr JOIN email_addresses ea ON (ea.id = eabr.email_address_id) WHERE eabr.deleted=0 AND ea.email_address LIKE',\n    'db_field' =&gt; \n    array (\n      0 =&gt; 'id',\n    ),\n  ),\n</code></pre>\n\n<p>Using that data I decided to create a new array with the following code to get the last email date.  Obviously it will need to be sorted or something to get the actual last email date if the contact was emailed multiple times but you get the point.</p>\n\n<pre><code>'last_email_c' =&gt; \n  array (\n    'query_type' =&gt; 'default',\n    'operator' =&gt; 'subquery',\n    'subquery' =&gt; 'SELECT e.date_sent FROM emails e WHERE e.parent_type = \\'Contacts\\' AND e.parent_id = \\'{0}\\'',\n    'db_field' =&gt; \n    array (\n      0 =&gt; 'id',\n    ),\n  ),\n</code></pre>\n\n<p>My issue is, I don't know what to do with this new subquery, I checked in the listviewdefs and the searchdefs and cannot find any reference to either of these custom SearchFields.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["mysql","sql","database","query","one-to-many"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13108587,"title":"Selecting primary keys that does not has foreign keys in another table","body":"<p>For simplification, I have two tables related with one to many using a foreign key, for example:</p>\n\n<pre><code>Users table:\nid\nname\n\nActions table:\nid\nuser_id\n</code></pre>\n\n<p>one user may have many actions or not. I need an sql select that returns users ids that have not user_id value in the actions table.</p>\n\n<pre><code>Users Table:\nid      name\n1       John\n2       Smith\n3       Alice\n\nActions Table:\nid      user_id\n1       3\n2       1\n</code></pre>\n\n<p>So I need sql query that returns the user id 2 (Smith) because the foreign key values have not the id 2 </p>\n\n<p>I tried the following SQL, but it returns all users ids:</p>\n\n<pre><code>SELECT users.id from users left join actions on actions.user_id is null\n</code></pre>\n"},{"tags":["php","wordpress","query","post","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13102828,"title":"Multiple loop in wordpress with post type","body":"<p>I have this code to display all post:</p>\n\n<p><a href=\"http://pastie.org/5124323\" rel=\"nofollow\">http://pastie.org/5124323</a></p>\n\n<p>Shows the two types of post but does not work pagination. When I go to the next page shows the same post in the home page. I do not know what the problem is.</p>\n\n<p>And in the post_type \"articles\" category are not displayed.</p>\n"},{"tags":["php","sql","query","command-line"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13126050,"title":"Show each number sepparated after comma in php","body":"<p>I have two tables</p>\n\n<p>category</p>\n\n<pre><code>id | category\n------\n1  | One\n2  | Two\n</code></pre>\n\n<p>etc</p>\n\n<p>second one is</p>\n\n<p>mp_photos</p>\n\n<pre><code>id|name|test|CategoryID\n1 |name|test|1,2\n</code></pre>\n\n<p>So now i need to fetch data from mp_photos row CategoryID (1,2) every categoryid is seppareted by comma and link every number with Category name in first table </p>\n"},{"tags":["android","query","cursor","android-cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13125457,"title":"Query using where condition in Android","body":"<p>I want to set a query to get names which cointain the a particular string (here constraint). \nSO I coded: </p>\n\n<pre><code>Cursor contactCursor = cr.query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, new String[]{Phone.DISPLAY_NAME}, Phone.DISPLAY_NAME + \"like + ?\", new String[]{\"%\"+constraint+\"%\"}, Phone.DISPLAY_NAME + \" ASC\");\n</code></pre>\n\n<p>But I get en error. \nI know that I'm close. \nWhere I'm wrong?</p>\n"},{"tags":["mysql","query","table","inner-join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13125473,"title":"Need help on creating a mysql query","body":"<p>I have three tables - 1-FriendShip, 2-Users, 3-Pages.\nFriendship table has fromUser, and toUser columns.\nfromUser column contains the user who initiated friend request. toUser contains who recieved friend request (Inspired from facebook)</p>\n\n<p>I want to select data from Pages table who are friends with a given user, say 'user1'.\nI can get the friends of user1 using this query:</p>\n\n<pre><code>  SELECT friends.`fromUser` AS `friend`\n    FROM friends\n    INNER JOIN users\n    ON friends.`fromUser` = users.`userid`\n    WHERE `friends`.`toUser`='user1'\n UNION\n  SELECT friends.`toUser` AS `friend`\n    FROM friends\n    INNER JOIN users\n    ON friends.`toUser` = users.`userid`\n    WHERE friends.`fromUser`='user1'\n</code></pre>\n\n<p>This gives me result like this:</p>\n\n<p>Friends<br/>\nuser2<br/>\nuser5<br/></p>\n\n<p>and so on...</p>\n\n<p>I want to select the pages of all these users and order them in descending order by timestamp column. Any one please provide a solution</p>\n"},{"tags":["sql","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":66,"score":3,"question_id":13123118,"title":"The row must be shown same order in result set according to column value","body":"<p>I am using SQL Server 2008 R2.\nI have the following data:</p>\n\n<pre><code>ID   Value   OrderNumber\n1      A         NULL\n2      E          4\n3      C         NULL\n4      B         NULL\n5      F          2\n6      D         NULL\n</code></pre>\n\n<p>i want to write a query that must fetch data ordering by OrderNumber column considering OrderNumber values. The query result must be below:</p>\n\n<pre><code>ID      Value     OrderNumber\n1         A           NULL\n5         F            2  --indicates row must be second in result set. \n3         C           NULL\n2         E            4  --indicates row must be fourth in result set.\n4         B           NULL\n6         D           NULL\n</code></pre>\n\n<p>Thanks for reading and your answers.</p>\n"},{"tags":["java","query","hibernate","map","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13056216,"title":"Using HQL to search in a Map","body":"<p>I have a Java class (let's call it BigClass) which has a Map as attribute (Map&lt; MyClass, Integer >), what I would like to do is to make an HQL query to filter this classes depending on the values of this map.</p>\n\n<p>In fact, what I would like to do is to recover all instances (b) of BigClass which satisfy for a specific instance (m) of MyClass b.map.get(m) > 0.</p>\n\n<p>For example: I would like to recover an instance of BigClass, if its map has an entry like &lt; m, 2 >, and I would't like to recover an instance of BigClass if its map has an entry like &lt; m, 0 > or if m doesn't belong to the map keys.</p>\n\n<p>I've been searching and I found this post related to my problem:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10804664/using-hql-to-query-on-a-maps-values\">Using HQL to query on a Map&#39;s Values</a></p>\n\n<p>Although, it didn't give me a solution.</p>\n\n<hr>\n\n<p>These are some queries I've been trying with no success:</p>\n\n<pre><code>org.hibernate.QueryException: No index value! \n[SELECT e FROM BigClass e WHERE ( map[(SELECT b FROM MyClass b WHERE b.id = ?)] &gt; 0) ]\n\norg.hibernate.QueryException: No index value! \n[SELECT e FROM BigClass e WHERE ( index(map) = (SELECT b FROM MyClass b WHERE b.id = ?) ) &gt; 0) ]\n</code></pre>\n\n<p>Thanks in advance...</p>\n"},{"tags":["php","mysql","sql","database","query"],"answer_count":10,"favorite_count":0,"up_vote_count":3,"down_vote_count":5,"view_count":83,"score":-2,"question_id":13124338,"title":"How do I make sure rows are unique in sql?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3124793/how-to-ensure-that-mysql-rows-are-unique\">How to ensure that MySQL rows are unique?</a>  </p>\n</blockquote>\n\n\n\n<p>If I have a table where each column can have duplicate data, how do I keep it so each row is unique?</p>\n\n<p>Example:\nIf my table has (col_foo, col_bar) with the rows:</p>\n\n<ul>\n<li>A | X</li>\n<li>A | Y</li>\n<li>B | Y</li>\n</ul>\n\n<p>And I want to insert (A, X) how do I only end up with one row with values (A, X).</p>\n\n<p>I'll be using this in a web project, so it's going to be written in PHP.</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":103,"score":3,"question_id":13108525,"title":"MS Access 2010 query pulls same records multiple times, sql challenge","body":"<p>I'm currently working on a program that keeps track of my company's stock inventory, using ms Access 2010. I'm having a hard time getting the query, intended to show inventory, to display the information I want. The problem seems to be that the query pulls the same record multiple times, inflating the sums of reserved and sold product. </p>\n\n<p>Background: \nMy company stocks steel bars. We offer to cut the bars into pieces. From an inventory side, We want to track the length of each bar, from the moment it comes in to the warehouse, through it's time in the warehouse (where it might get cut into smaller pieces), until the entire bar is sold and gone. </p>\n\n<p>Database:\nThe query giving problems, is consulting 3 tables; </p>\n\n<ul>\n<li>Barstock (with the following fields)\n<ul>\n<li>BatchNumber (all the bars recieved, beloning to the same production heat)</li>\n<li>BarNo (the individual bar)</li>\n<li>Orginial Length (the length of the bar when recieved at the stock</li>\n</ul></li>\n</ul>\n\n<p>(BatchNumber and BarNo combined, is the primary key)</p>\n\n<ul>\n<li><p>Sales </p>\n\n<ul>\n<li>ID (primary key)</li>\n<li>BatchNumber</li>\n<li>BarNo</li>\n<li>Quantity Sold</li>\n</ul></li>\n<li><p>Reservation (a seller kan reserve some material, when a customer signals interest, but needs time to decide)</p>\n\n<ul>\n<li>ID (Primary key)</li>\n<li>BatchNumber</li>\n<li>BarNo</li>\n<li>Quantity reserved</li>\n</ul></li>\n</ul>\n\n<p>I'd like to pull information from the three tables into one list, that displays:\n-Barstock.orginial length As Received\n- Sales.Quantity sold As Sold\n- Recieved - Sold As On Stock\n- reservation.Quantity Reserved As Reserved\n- On Stock - Reserved As Available. </p>\n\n<p>The problem is that I suck at sql. I've looked into union and inner join to the best of my ability, but my efforts have been in vain. I usually rely on the design view to produce the Sql statements I need. With design view, I've come up with the following Sql: </p>\n\n<pre><code>SELECT \n  BarStock.BatchNo\n  , BarStock.BarNo\n  , First(BarStock.OrgLength) AS Recieved\n  , Sum(Sales.QtySold) AS SumAvQtySold\n  , [Recieved]-[SumAvQtySold] AS [On Stock]\n  , Sum(Reservation.QtyReserved) AS Reserved\n  , ([On Stock]-[Reserved])*[Skjemaer]![Inventory]![unitvalg] AS Available\nFROM \n  (BarStock \n    INNER JOIN Reservation ON (BarStock.BarNo = Reservation.BarNo) AND (BarStock.BatchNo = Reservation.BatchNo)\n  ) \n    INNER JOIN Sales ON (BarStock.BarNo = Sales.BarNo) AND (BarStock.BatchNo = Sales.BatchNo)\nGROUP BY \n  BarStock.BatchNo\n  , BarStock.BarNo\n</code></pre>\n\n<p>I know that the query is pulling the same record multiple times because; \n- when I remove the GROUP BY term, I get several records that are exactley the same.\n- There are however, only one instance of these records in the corresponding tables. </p>\n\n<p>I hope I've been able to explain myself properly, please ask if I need to elaborate on anything.</p>\n\n<p>Thank you for taking the time to look at my problem!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13123607,"title":"Create table as ( using a column and table name)","body":"<p>I need to build a table from several tables in MySql and I want it has two columns like:</p>\n\n<pre>-------------------\nname | table_name |\n-------------------</pre>\n\n<p>I'm doing this:</p>\n\n<pre><code>Create table teams as \n(\nSelect name from table1\nunion\nSelect name from table2\nunion\nSelect name from table3);\n</code></pre>\n\n<p>How could I include each table name as a second column??</p>\n\n<p>Thank you!</p>\n"},{"tags":["php","mysql","arrays","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13124040,"title":"php MySQL query not returning anything","body":"<p>I'm not sure exactly how to explain what the query does, however the problem isn't entirely with how it's set up, because it does work, in another instance, when I use it as an array, however it's not working when I use it with mysql_fetch_assoc(), so here is what my original query is(not the one im having trouble with):</p>\n\n<pre><code>SELECT * FROM \n(SELECT * FROM comments \n          WHERE postID='$id' AND state='0' \n          ORDER BY id DESC LIMIT 3\n) t ORDER BY id ASC\n</code></pre>\n\n<p>what this does is selects the last 3 comments on a post, then orders them in another way (so they show up in the correct order, old to new) Now this is the query for echoing out the array of comments directly.\nBut now what I want to do, is to just get the first id out of the 3 comments.</p>\n\n<p>here's what I have tried to do (and by the way, this query DOES work, when i replace my previous query to echo out the results in an array, but i need to get just the id for use, i don't want an array):</p>\n\n<pre><code>$previousIDq = mysql_fetch_assoc(mysql_query(\"\n                                   SELECT * FROM \n                                  (SELECT * FROM comments \n                                   WHERE postID='$id' AND state='0' \n                                   ORDER BY id DESC LIMIT 3\n                                  ) t ORDER BY id ASC LIMIT 1\"));\n\n $previousID = $previousIDq['id']; //this doesn't return the id as I want it to.\n</code></pre>\n"},{"tags":["sql-server","query","stored-procedures","join","outer-join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13124004,"title":"How show datetime select only in Sql Server?","body":"<p>I need show <code>datetime</code> when I select datetime only. Because I try to run SQL but show all <code>datetime</code>.</p>\n\n<p>Table <code>Emp</code>:</p>\n\n<pre><code>EmpNo   fullName\n00001   Midna\n00002   Klog\n00003   Porla\n00004   Seka\n00005   Mila\n</code></pre>\n\n<p>Table <code>tFile</code>:</p>\n\n<pre><code>EmpNo   cDate                     cTime\n00001   2012-10-29 00:00:00.000   2012-10-29 07:52:00.000\n00001   2012-10-29 00:00:00.000   2012-10-29 19:00:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 07:40:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 19:32:00.000\n00005   2012-10-29 00:00:00.000   2012-10-29 07:58:00.000\n00005   2012-10-29 00:00:00.000   2012-10-29 18:35:00.000\n</code></pre>\n\n<p>This code</p>\n\n<pre><code>SELECT \n   em.EmpNo as 'EmpNo', \n   case \n       when tf.cDate &lt;&gt; null then tf.cDate \n            else coalesce(tf.cDate, '2012-10-29') \n   end as 'cDate', \n   Min(tf.cTime) as 'timeIn', \n   Max(tf.cTime) as 'timeOut'\nFROM \n   tFile tf \nFull Outer join \n   Emp em On tf.EmpNo = em.EmpNo\nGroup By \n   em.EmpNo,tf.cDate\nOrder By \n   'EmpNo'\n</code></pre>\n\n<p>returns this result:</p>\n\n<pre><code>EmpNo   cDate                     timeIn                     timeOut\n-------------------------------------------------------------------------------------\n00001   2012-10-21 00:00:00.000   2012-10-21 07:22:00.000    2012-10-21 17:35:00.000\n00001   2012-10-24 00:00:00.000   2012-10-24 07:30:00.000    2012-10-24 19:00:00.000\n00001   2012-10-29 00:00:00.000   2012-10-29 07:52:00.000    2012-10-29 19:00:00.000\n00002   2012-10-25 00:00:00.000   2012-10-25 07:58:00.000    2012-10-25 18:35:00.000\n00002   2012-10-22 00:00:00.000   2012-10-22 08:04:00.000    2012-10-22 17:55:00.000\n00002   2012-10-24 00:00:00.000   2012-10-24 08:00:00.000    2012-10-24 18:45:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 07:40:00.000    2012-10-29 19:32:00.000\n00003   2012-10-29 00:00:00.000   NULL                       NULL\n00004   2012-10-29 00:00:00.000   NULL                       NULL\n00005   2012-10-28 00:00:00.000   2012-10-28 07:30:00.000    2012-10-28 19:20:00.000\n00005   2012-10-27 00:00:00.000   2012-10-27 07:38:00.000    2012-10-27 19:30:00.000\n00005   2012-10-29 00:00:00.000   2012-10-29 07:58:00.000    2012-10-29 18:35:00.000\n</code></pre>\n\n<p>But I need this result:</p>\n\n<p>I select date ex. <code>2012-10-29</code> then I need to show all rows with <code>2012-10-29</code> only.</p>\n\n<p>But some <code>Empno</code> don't have data in <code>2012-10-29</code> it's set NULL.</p>\n\n<pre><code>EmpNo   cDate                     timeIn                     timeOut\n---------------------------------------------------------------------------------------\n00001   2012-10-29 00:00:00.000   2012-10-29 07:52:00.000    2012-10-29 19:00:00.000\n00002   2012-10-29 00:00:00.000   2012-10-29 07:40:00.000    2012-10-29 19:32:00.000\n00003   2012-10-29 00:00:00.000   NULL                       NULL\n00004   2012-10-29 00:00:00.000   NULL                       NULL\n00005   2012-10-29 00:00:00.000   2012-10-29 07:58:00.000    2012-10-29 18:35:00.000\n</code></pre>\n\n<p>Thanks for your time. :)</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","select"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13121094,"title":"Doing a comparison using the previous row?","body":"<p>I'm trying to work out an efficient way of comparing two rows in SQL Server 2008.  I need to write a query which finds all rows in the <code>Movement</code> table which have <code>Speed &lt; 10</code> N consecutive times.</p>\n\n<p>The structure of the table is:</p>\n\n<p>EventTime\nSpeed </p>\n\n<p>If the data were:</p>\n\n<pre><code>2012-02-05 13:56:36.980, 2\n2012-02-05 13:57:36.980, 11\n2012-02-05 13:57:46.980, 2\n2012-02-05 13:59:36.980, 2\n2012-02-05 14:06:36.980, 22\n2012-02-05 15:56:36.980, 2\n</code></pre>\n\n<p>Then it would return rows 3/4 (13:57:46.980 / 13:59:36.980) if I looked for 2 consecutive rows, and would return nothing if I looked for three consecutive rows.  The order of the data is EventTime/DateTime only.</p>\n\n<p>Any help you could give me would be great.  I'm considering using cursors but they're usually pretty inefficient.  Also, this table is approximately 10m rows in size, so the more efficient the better! :)</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","query","fuelphp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13123616,"title":"FuelPHP Query builder join on multiple fields","body":"<p>I need to create a query using the join on various parameters like:</p>\n\n<pre><code>SELECT foo.*, bar.* FROM foo LEFT JOIN bar ON foo.c1 = bar.c1 AND foo.c2 = bar.c2 WHERE foo c3 = \"somedata\";\n</code></pre>\n\n<p>The problem is that I can't find how to create \"AND\" using FuelPHP Query Builder.</p>\n\n<p>Thanks.</p>\n"},{"tags":["query","jpa","wildcard","like-operator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13122149,"title":"Using wildcards in column value in LIKE condition","body":"<p>I have a situation where I need to find an entity matching a given filename. The filename is in this form:</p>\n\n<pre><code>filename1 = \"ABCD_126518.pdf\";\nfilename2 = \"XYZ_32162.pdf\";\n</code></pre>\n\n<p>In the Oracle DB, I have entities with filename_patterns like the following:</p>\n\n<pre><code>ID | filename_pattern\n1  | ABCD_\n2  | KLM\n3  | XYZ_\n</code></pre>\n\n<p>I need to find the pattern ID that the given filename matches to. In the given example it should be ID = 1 for filename1 and ID = 3 for filename2. How should the query look like in Java for the named query?</p>\n\n<p>I need something like</p>\n\n<pre><code>SELECT p FROM FilenamePattern p WHERE p.filename_pattern || \"%\" LIKE :param;\n</code></pre>\n\n<p>We use Oracle DB and JPA 1.0.</p>\n"},{"tags":["sql-server","sql-server-2005","query"],"answer_count":7,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":8058,"score":10,"question_id":235515,"title":"Hierarchical Queries in SQL Server 2005","body":"<p>Way back when I was working in an Oracle shop I took the CONNECT_BY for granted.  Now I'm stuck working with SQL Server 2005 and have some nasty object hierarchies.  Specifically, we have a self referencing table where all child records have a column with their parent's id.  Currently we have a view that maps children to levels in the hierarchy and a nasty query that does the heavy lifting to connect parents with their children.  While this method works, it is far from elegant and reeks of taint.  I'm just curious how other people retrieve hierarchical data from SQL Server 2005.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13089625,"title":"Display products under product header PHP & MySQL","body":"<p>I have two tables; sublevel and subcat1. sublevel contains the products headers, or collective group name and the other one, subcat1 contains all the actual products..</p>\n\n<p>Here is sublevel table;</p>\n\n<p><code>\n<strong>CategoryID SublevelID  Name</strong><br /> \n67         1          Anaesthsia Thermometers<br />\n67         2          Forehead Thermometers<br />\n67         3          Drug Testing Thermometers<br />\n67         4          Drug Testing Thermometers\n</code></p>\n\n<p>and here is the other table, subcat1;</p>\n\n<p><code><strong>CategoryID SublevelID SubCatName</strong><br />\n67         2          12 Level Thermometer<br />\n67         1          Clinitrend<br />\n67         2          Forehead Thermometer<br />\n67         3          Briteline<br />\n67         3          BriteEvent\n</code></p>\n\n<p>The idea of what i want is the output and when i mean output i mean in php code to be something like this;</p>\n\n<p><strong>Anaesthesia Thermometers</strong> - Clinitrend</p>\n\n<p><strong>Forehead Thermometers</strong> - 6 Event Disposable, 6 Event Reusable, 12 Event</p>\n\n<p><strong>Drug Testing Thermometers</strong> - Briteline, BriteEvent</p>\n\n<p>The problem I keep running into is I keep repeating the same header with each product, but I only would like it once. I've tried GROUP BY, DISTINCT and LEFT JOIN but with every product that is retrieved it shows it's category header-I know I'm probably looking at the query the wrong way...everytime i think of something new that I could change the query I fail..</p>\n\n<p><a href=\"https://twitter.com/D_Azzopardi/status/258340698900819968/photo/1/large\" rel=\"nofollow\">I even drew out the table structure along with the ideal output</a> to see it differently, but my brain doesn't work that way.. </p>\n\n<pre><code>function catLevelsName(){\n\n// This would be used to select which category $cat_id = $_GET['cat_id'];\n\nglobal $dbc;\n\n$query = \"SELECT subcat1.SubCatName FROM subcat1 RIGHT JOIN sublevel ON sublevel.CategoryID = subcat1.CategoryID\";  \n$result = mysqli_query($dbc, $query) or die(mysqli_error(). \"&lt;p&gt;with query;&lt;br /&gt;$query\");\n\nwhile($row = mysqli_fetch_array($result)){\n\necho $row['Name'];\necho $row['SubCatName'];\n}\n</code></pre>\n\n<p>Any pointers to what I'm doing wrong?</p>\n\n<p>ps. A million apologies for my formatting.</p>\n"},{"tags":["query","vba","excel-2011"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":348,"score":0,"question_id":8280620,"title":"Excel 2011 (Mac) vba: text encoding fails when importing text files as QueryTables","body":"<p>I need to import text files to Excel sheets. The text files come both from Macs and PCs and contain characters from various languages. For Excel 2004 (PC) I have successfully used vba code like below for converting Mac-coded text to PC-coding:</p>\n\n<pre><code>Worksheets(\"A\").Cells.Clear\npth = Application.GetOpenFilename()\nWith Worksheets(\"A\").QueryTables.Add(Connection:=\"TEXT;\" &amp; pth, _\n Destination:=Worksheets(\"A\").Range(\"A1\"))\n    .TextFilePlatform = 10000\n    .TextFileColumnDataTypes = Array(xlTextFormat)\n    .Refresh\nEnd With\nWorksheets(\"A\").QueryTables(1).Delete\n</code></pre>\n\n<p>I am trying to use similar code for Excel 2011 to convert the coding from PC to Mac, using</p>\n\n<pre><code>.TextFilePlatform = xlWindows '=2\n</code></pre>\n\n<p>as suggested by running the macro recorder. Doing the importing manually works perfectly, changing the coding from PC to Mac, but the vba program run in Excel 2011 does not change the coding at all. The TextFilePlatform parameter can (in my version of Excel 2011; different language versions might possibly differ here) be set to 1, 2, or 3 (any other integer from -1000000 to 1000000 gives error 5), and the resulting text looks exactly the same for these three cases. Is there some other setting that overrules my attempt to convert the text coding? Any suggestion greatly appreciated!  </p>\n\n<p>Edit: I have confirmed that the code with .TextFilePlatform = xlWindows properly translates windows coded text to mac coding for Excel 10 (2001) and for Excel 11 (2004), contrary to the case for Excel 2011 described above.    </p>\n"},{"tags":["mysql","query","friends"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":13090353,"title":"MySQL Query to find friends and number of mutual friends","body":"<p>I have looked through the questions but I cant find anything that does exactly what I need and I can't figure out how to do it myself.</p>\n\n<p>I have 2 tables, a user table and a friend link table. The user table is a table of all my users:</p>\n\n<pre><code>    +---------+------------+---------+---------------+\n    | user_id | first_name | surname |     email     |\n    +---------+------------+---------+---------------+\n          1         joe       bloggs    joe@test.com\n          2         bill      bloggs    bill@test.com\n          3         john      bloggs    john@test.com\n          4         karl      bloggs    karl@test.com\n</code></pre>\n\n<p>My friend links table then shows all relationships between the users, for example:</p>\n\n<pre><code>    +--------=+---------+-----------+--------+\n    | link_id | user_id | friend_id | status |\n    +---------+---------+-----------+--------+\n       1         1          3           a\n       2         3          1           a\n       3         4          3           a\n       4         3          4           a\n       5         2          3           a\n       6         3          2           a\n</code></pre>\n\n<p>As a note the a in the status column means approved, there could also be r(request) and d(declined).</p>\n\n<p>What I want to do is have a query where if a user does a search it will bring back a list of users that they are currently not already friends with and how many mutual friends each user has with them.</p>\n\n<p>I have managed to get a query for all users that are currently not friends with them. So if the user doing the search had the user id of 1:</p>\n\n<pre><code>SELECT u.user_id,u.first_name,u.surname\nFROM users u\n    LEFT JOIN friend_links fl\n        ON u.user_id = fl.user_id AND 1 IN (fl.friend_id)\nWHERE fl.friend_id IS NULL\nAND u.user_id != 1\nAND surname LIKE 'bloggs'\n</code></pre>\n\n<p>How then do I have a count of the number of mutual friends for each returned user?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Just as an edit as I don't think I am being particularly clear with my question.</p>\n\n<p>The query that I currently have above will produce the following set of results:</p>\n\n<pre><code>    +---------+------------+---------+\n    | user_id | first_name | surname |\n    +---------+------------+---------+\n          2         bill      bloggs\n          4         karl      bloggs\n</code></pre>\n\n<p>Those are the users matching the surname bloggs that are not currently friends with joe bloggs (user id 1).</p>\n\n<p>Then I want to have how many mutual friends each of these users has with the user doing the search so the returned results would look like:</p>\n\n<pre><code>    +---------+------------+---------+--------+\n    | user_id | first_name | surname | mutual |\n    +---------+------------+---------+--------+\n          2         bill      bloggs     1\n          4         karl      bloggs     1\n</code></pre>\n\n<p>Each of these returned users has 1 mutual friend as joe bloggs (user id 1) is friends with john bloggs and john bloggs is friends with both returned users.</p>\n\n<p>I hope this is a bit more clear.</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","query-optimization","neo4j"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13120031,"title":"Map Neo4j on MySQL for fast select query","body":"<p>I designed Neo4j data schema but we want to take backup of neo4j database on MySQL.</p>\n\n<p>So we mapped nodes and relations as tables in mysql. ( we store nodes and relations number in tables too)</p>\n\n<p>Now for each page which user surf,we have near 1500 Socket.IO ( something like ajax but with a less overhead ) request to server. </p>\n\n<p>Is it good idea that query to MySQL database and get nodes and relations id of neo4j instead requesting Neo4j for do it?Is it faster or not?</p>\n\n<p><em>we mapped it to mysql because of fear of project provider to use new technology such as Neo4J</em></p>\n"},{"tags":["mysql","sql","regex","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":10827125,"title":"MySQL and word boundary in regex","body":"<p>How can I use regex word boundary in a MySQL query?</p>\n\n<p>For instance, I want to match either 'product' or 'newsletter',</p>\n\n<p>It works fine with <code>OR</code>, </p>\n\n<pre><code>IF(? = 'product' OR ? = 'newsletter', ... , ...)\n</code></pre>\n\n<p>But how about a regex? I assume it would be something like this below?</p>\n\n<pre><code>IF(? REGEXP '^('product'||'newsletter')+$', ..., ... ) \n</code></pre>\n"},{"tags":["sql","sql-server","query","stored-procedures","full-outer-join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13118578,"title":"How can I use full outer join?","body":"<p>I need use join 2 table show all data.</p>\n\n<p><strong>Exam</strong></p>\n\n<p><strong>Table Contact</strong></p>\n\n<pre><code>numCode | fullName\n00001   | Midna \n00002   | Klog\n00003   | Porla\n00004   | Seka\n00005   | Mila\n</code></pre>\n\n<p><strong>Table dateFile</strong></p>\n\n<pre><code>numCode | dateCurr\n00001   | 2012-10-29 00:00:00.000\n00002   | 2012-10-29 00:00:00.000\n00005   | 2012-10-29 00:00:00.000\n</code></pre>\n\n<p><strong>Code Sql Server</strong></p>\n\n<pre><code>SELECT df.numCode as 'numCode', tf.dateCurr as 'dateCurr'\nFROM dateFile df Full Outer join Contact ct On ct.numCode = df.numCode\nWHERE df.dateCurr = '2012-10-29'\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>numCode | dateCurr\n00001   | 2012-10-29 00:00:00.000\n00002   | 2012-10-29 00:00:00.000\n00005   | 2012-10-29 00:00:00.000\n</code></pre>\n\n<p><strong>But I need output get:</strong></p>\n\n<pre><code>numCode | dateCurr\n00001   | 2012-10-29 00:00:00.000\n00002   | 2012-10-29 00:00:00.000\n00003   | 2012-10-29 00:00:00.000  (Insert Date from choose datetime)\n00004   | 2012-10-29 00:00:00.000  (Insert Date from choose datetime)\n00005   | 2012-10-29 00:00:00.000\n</code></pre>\n"},{"tags":["android","database","query","android-intent","sms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13118427,"title":"How to clear db when app is uninstalled in android","body":"<p>Im using database to store messages, and if i uninstall my app and again reinstall the same app, the db remains same, but i want to clear my database, how to solve this?</p>\n"}]}
{"total":20739,"page":6,"pagesize":100,"questions":[{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13118928,"title":"SQL new attribute join from another table","body":"<p>I have a SQL query like that</p>\n\n<pre><code>select M.mtitel as Attribute from aRel_adr_Merk R \ninner join vMerkmale M on M.mid=R.mid   \nwhere adrid in(\" + listdatenids + \")\", utilDB.conn()\n</code></pre>\n\n<p>I have another table called as aAdress. I want to bind adrID from aAdressen. But, they have no common attributes. I just want to show adrID also. How may I do it?</p>\n"},{"tags":["mysql","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13117499,"title":"Update query on mutiple table in Sqlite or SQL","body":"<p>Hi I am new to SQL database.</p>\n\n<p>I have two tables one is a \"Master\" and other is \"Sub\" like this</p>\n\n<pre><code>Master \nuid(primary key)         f_name            l_name\n 1                        fAaa              lAaa\n 2                        fBbb              lBbb\n</code></pre>\n\n<p>second table</p>\n\n<pre><code>Sub \ntid(primary key)         uid(foreign key)      time           is_free\n  1                        1                   1:00AM           0\n  2                        1                   2:00AM           1 \n  3                        1                   3:00AM           0 \n  4                        2                   1:30PM           0\n  5                        2                   2:30PM           1   \n</code></pre>\n\n<p>from both table we can say that user fAaa lAaa is free at 2:00AM and NOT free at 1:00AM and 3:00AM.</p>\n\n<p>now I want to update like this, for user 1(fAaa lAaa), I want to delete time 2:00AM and want to insert new two time like 5:00AM and 6:00AM for user 1 than what should be my join query for update. </p>\n\n<p>please help me!\nThanks</p>\n"},{"tags":["sql","database","postgresql","query","indexes"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1499,"score":3,"question_id":4675605,"title":"Speeding up a group by date query on a big table in postgres","body":"<p>I've got a table with around 20 million rows. For arguments sake, lets say there are two columns in the table - an id and a timestamp. I'm trying to get a count of the number of items per day. Here's what I have at the moment.</p>\n\n<pre><code>  SELECT DATE(timestamp) AS day, COUNT(*)\n    FROM actions\n   WHERE DATE(timestamp) &gt;= '20100101'\n     AND DATE(timestamp) &lt;  '20110101'\nGROUP BY day;\n</code></pre>\n\n<p>Without any indices, this takes about a 30s to run on my machine. Here's the explain analyze output:</p>\n\n<pre><code> GroupAggregate  (cost=675462.78..676813.42 rows=46532 width=8) (actual time=24467.404..32417.643 rows=346 loops=1)\n   -&gt;  Sort  (cost=675462.78..675680.34 rows=87021 width=8) (actual time=24466.730..29071.438 rows=17321121 loops=1)\n         Sort Key: (date(\"timestamp\"))\n         Sort Method:  external merge  Disk: 372496kB\n         -&gt;  Seq Scan on actions  (cost=0.00..667133.11 rows=87021 width=8) (actual time=1.981..12368.186 rows=17321121 loops=1)\n               Filter: ((date(\"timestamp\") &gt;= '2010-01-01'::date) AND (date(\"timestamp\") &lt; '2011-01-01'::date))\n Total runtime: 32447.762 ms\n</code></pre>\n\n<p>Since I'm seeing a sequential scan, I tried to index on the date aggregate</p>\n\n<pre><code>CREATE INDEX ON actions (DATE(timestamp));\n</code></pre>\n\n<p>Which cuts the speed by about 50%.</p>\n\n<pre><code> HashAggregate  (cost=796710.64..796716.19 rows=370 width=8) (actual time=17038.503..17038.590 rows=346 loops=1)\n   -&gt;  Seq Scan on actions  (cost=0.00..710202.27 rows=17301674 width=8) (actual time=1.745..12080.877 rows=17321121 loops=1)\n         Filter: ((date(\"timestamp\") &gt;= '2010-01-01'::date) AND (date(\"timestamp\") &lt; '2011-01-01'::date))\n Total runtime: 17038.663 ms\n</code></pre>\n\n<p>I'm new to this whole query-optimization business, and I have no idea what to do next. Any clues how I could get this query running faster?</p>\n\n<p><strong>--edit--</strong></p>\n\n<p>It looks like I'm hitting the limits of indices. This is pretty much the only query that gets run on this table (though the values of the dates change). Is there a way to partition up the table? Or create a cache table with all the count values? Or any other options?</p>\n"},{"tags":["database","query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13118268,"title":"Query with integers not working","body":"<p>I've been searching here on stackoverflow and other sources but not found a solution to this</p>\n\n<p>The query below works as expected expect for when either <code>custinfo.cust_cntct_id</code> or <code>custinfo.cust_corrcntct_id = ''</code> (blank not <code>NULL</code>) then I get no results. Both are integer fields and if both have an integer value then I get results.  I still want a value returned for either <code>cntct_email</code> or <code>corrcntct_email</code> even if <code>custinfo.cust_cntct_id</code> or <code>custinfo.cust_corrcntct_id = blank</code></p>\n\n<p>Can someone help me out in making this work? The database is PostgreSQL.</p>\n\n<pre><code>SELECT \n  cntct.cntct_email AS cntct_email, \n  corrcntct.cntct_email AS corrcntct_email\nFROM \n  public.custinfo, \n  public.invchead, \n  public.cntct, \n  public.cntct corrcntct\nWHERE \n  invchead.invchead_cust_id = custinfo.cust_id AND\n  cntct.cntct_id = custinfo.cust_cntct_id AND\n  corrcntct.cntct_id = custinfo.cust_corrcntct_id;\n</code></pre>\n"},{"tags":["php","mysql","wordpress","query","data"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3549,"score":0,"question_id":5449218,"title":"PHP getting data from mysql database for the Query string variable","body":"<p>Here is what i would like to do. I am passing an encoded data as a query valiable to my webpage. then in my php page, i am decoding the data and checking the same in my database. the code i am using is shown below:</p>\n\n<pre><code>&lt;?php\n// Get the ID from URL.\n$id = ( isset($_GET[\"id\"]) &amp;&amp; !empty($_GET[\"id\"]) ? $_GET[\"id\"] : \"\");\n\n// If \"id\" is not empty, proceed.\nif(!empty($id)) {\n    $id = base64_decode($id);\n    global $wpdb;\n    $res = $wpdb-&gt;query(\"SELECT * FROM S_redirect WHERE source = \".$id);\n    $tot = count($res);\n\n    echo $tot . \" records found.\";\n\n    for( $i=0; $i&lt;count($res); $i++) {\n        echo $res[$i]-&gt;id;\n    }\n    exit;\n}\nelse {\n    echo \"No ID\";\n    exit;\n}\n?&gt;\n</code></pre>\n\n<p>I have one record in my database. the above code correctly says \"1 records found\". I am not sure how to get the value of the field in that row. I have 3 columns. they are id, field1 and field2. The code \"<code>echo $res[$i]-&gt;id</code>\" returns nothing.</p>\n\n<p>Please help</p>\n\n<p><strong>BTW, I am trying this in my Wordpress blog.</strong></p>\n\n<p>Thannk you all for your suggestions. I tried your suggestions and here are my results:</p>\n\n<pre><code>$res = $wpdb-&gt;query(\"SELECT * FROM S_redirect WHERE source = \".$id);\n$tot = count($res);\necho $tot . \" records found.\".\"&lt;/br&gt;\";\n</code></pre>\n\n<p>it says 1 records found.</p>\n\n<pre><code>$res = $wpdb-&gt;get_row(\"SELECT * FROM S_redirect WHERE source = \".$id);\n$tot = count($res);\necho $tot . \" records found.\".\"&lt;/br&gt;\";\n</code></pre>\n\n<p>it says 0 records found.</p>\n\n<pre><code>$res = $wpdb-&gt;get_results(\"SELECT * FROM S_redirect WHERE source = \".$id);\n$tot = count($res);\necho $tot . \" records found.\".\"&lt;/br&gt;\";  \n</code></pre>\n\n<p>it says 0 records found.</p>\n\n<pre><code>while ($row = mysql_fetch_array($res)) {\necho $row[0];  \n}\n</code></pre>\n\n<p>If i use mysql_fetch_array, </p>\n\n<pre><code>Warning: mysql_fetch_array(): supplied argument is not a valid MySQL result resource in /home/myfolder/mytheme/index.php on line 38.\n</code></pre>\n\n<p>line 38 is while ($row = mysql_fetch_array($res)) {.</p>\n\n<p><strong>What I am trying to accomplish:</strong></p>\n\n<p>I have a wordpress blog. All the above code goes into my index.php. I will pass a product id to my index.php via query string variable. I have created a new table called S_redirect in my wordpress database. i will retrieve the value of query string variable id and check the same in my database table. If record exists, then retrieve one of the column value (url of the product) from that table row and redirect to that product url. If the record doesn't exists then redirect to home page. hope this helps everyone to understand what I am doing.</p>\n\n<p>Thank you all :)</p>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13116504,"title":"Mysql innerjoin clause doesn't working","body":"<p>I have 2 tables as follow:</p>\n\n<p><strong><code>talk</code> table</strong>:</p>\n\n<pre><code>topic_id | topic_name | user_id (user who create topic)\n  1           test1        1\n  2           test2        2\n</code></pre>\n\n<p><strong><code>talk_reply</code> table</strong>:</p>\n\n<pre><code>talk_reply_id | message | topic_id | user_id (user who reply to specific topic)\n     1            hi1        1         3\n     2            hi2        1         4\n</code></pre>\n\n<p><strong><code>user</code> table</strong>:</p>\n\n<pre><code>user_id  | name\n  1        mark\n  2        pedro\n  3        gates\n  4        steve\n</code></pre>\n\n<p>My query are as follow:</p>\n\n<pre><code>SELECT `tr`.`message`, \n       `tr`.`user_id`, \n       `tr`.`topic_id`,  \n       `u`.`name` \nFROM `talk_reply` AS `tr`\nINNER JOIN `users` AS `u` ON tr.user_id = u.user_id WHERE (tr.topic_id=1)\n</code></pre>\n\n<p>But I only get 1 result instead of 2, what am I missing here? Thanks.</p>\n"},{"tags":["query","selection","blank","alternate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":17,"score":-1,"question_id":13116518,"title":"I need a select query with alternate blank rows","body":"<p>I have a table named <code>tblemployee</code>.</p>\n\n<p>i want to be my selection to be like this</p>\n\n<pre><code>id     lastname      firsname     middlename\n1      Johnson       mark         rupert\n2      null          null         null\n3      Morris        Phillip      Stevens\n4      null          null         null\n5      Joe           John         Hefburn\n6      null          null         null\n</code></pre>\n"},{"tags":["query","programming-languages","sparql","dbpedia"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13094536,"title":"How do I consistently query dbpedia for programming languages by name?","body":"<p>There seems to be no consistent way to query for programming languages based on name. Examples:</p>\n\n<pre><code>http://dbpedia.org/page/D_(programming_language)\nrdfs:label \"D (programming language)\"@en\ndbpprop:name \"D programming language\"\nowl:sameAs freebase:\"D (programming language)\"\nfoaf:name \"D programming language\"\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>http://dbpedia.org/page/C++\nrdfs:label \"C++\"@en\ndbpprop:name \"C++\"\nowl:samwAs freebase:\"C++\"\nfoaf:name \"C++\"\n</code></pre>\n\n<p>Since there's no standard convention for whether \"programming language\", \"(programming language)\", \"programming_language\", \"(programming_language\", or \"\" is part of a name for a programming language in dbpedia, I have no idea how to consistently search by name.</p>\n\n<p>I'd like to create some sort of SPARQL query that returns <a href=\"http://dbpedia.org/page/D_(programming_language\" rel=\"nofollow\">http://dbpedia.org/page/D_(programming_language</a>) for \"D\" and <a href=\"http://dbpedia.org/page/C++\" rel=\"nofollow\">http://dbpedia.org/page/C++</a> for \"C++\", but I don't know how do to this.</p>\n\n<p>Unless at least one of the various triples for programming languages uses a consistent naming convention, I'll have to hack it by querying first against name + \" (programming_language)\", and falling back to name + \"(programming language\", name + \" programming language\" when no results are found. But I'd like a much more robust method.</p>\n"},{"tags":["php","sql","query","codeigniter","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12410322,"title":"Codeigniter db select","body":"<p>I want to select products from my table where is Akcie 1 and Stav also 1. But it it search query so I have there more like. It is not working why? Here is query</p>\n\n<pre><code>$q = $this-&gt;db-&gt;where('Akcia', 1)\n          -&gt;like('Titul', $vyraz)\n      -&gt;or_like('PodTitul', $vyraz)\n      -&gt;or_like('Autor1', $vyraz)\n      -&gt;or_like('Autor2', $vyraz)\n      -&gt;or_like('Autor3', $vyraz)\n      -&gt;or_like('Autor4', $vyraz)\n      -&gt;or_like('Prekladatel', $vyraz)\n      -&gt;or_like('Rozmer', $vyraz)\n      -&gt;or_like('Vydavatelstvo', $vyraz)\n      -&gt;or_like('ISBN', $vyraz)\n      -&gt;or_like('EAN', $vyraz)\n      -&gt;or_like('Popis', $vyraz)\n      -&gt;or_like('KratkyPopis', $vyraz)\n      -&gt;or_like('RokVydania', $vyraz)\n      -&gt;where('stav', 1)\n      -&gt;order_by('id', 'desc')\n      -&gt;limit($limit)\n      -&gt;offset($offset)\n     -&gt;get('knihy');\n\n         return $q-&gt;result();\n</code></pre>\n\n<p>This query is selcting also pruduts where Akcia is 0 why?</p>\n"},{"tags":["c#","linq","query","table","reference"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13114418,"title":"Including a junction table in a LINQ Query?","body":"<p>I'm having difficulty writing a LINQ query. Here is my scenario:</p>\n\n<p>Three database tables:<br />\n<strong>InterviewRequests</strong><br/>\n<strong>Contacts</strong><br />\n<strong>InterviewRequestContacts</strong> (a junction table containing <strong>ID</strong>, <strong>InterviewRequestID</strong>, <strong>ContactID</strong>)</p>\n\n<p>My goal is to have a table of <strong>InterviewRequests</strong>, and to display the <strong>Contact</strong> for each InterviewRequest. So I will need to fetch all InterviewRequests, and for each InterviewRequest the associated Contact using the <strong>InterviewRequestContacts</strong> junction table.</p>\n\n<p>How can I do this using LINQ? I've tried various methods but couldn't get it to work.</p>\n\n<p>EDIT: I'm using EntityFramework 5.0 and generated an .edmx ADO.NET Entity Data Model.</p>\n"},{"tags":["mysql","database","query","data","mysqldump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13035610,"title":"Mysql query to copy new data from one DB to another","body":"<p>I have a situation. While we upgraded our server drives, we took a backup of our DB and then imported it again and then site was live, its after a weeks we realize that import did not copy entire backup from dump file as when we checked it was only 13 GB which it suppose to be 60 GB. The interesting thing is, there is one big table which we figured out is copied in a funny way, it is huge and its just copied few initial records, say like 2000-5000 and it copied last records say 400000-500000 and there is no records in between. isnt that weird? cause while we imported we checked initial and last entries and thought it copied everything. Then We created a new DB and imported a dump again and now it seems to be ok, but we have the new entry already in our live DB(13GB data), so we have to copy those and add to our newl imported DB. What will be the idle way to copy those new records in to recovered DB? I mean some query which will search the new DB and add only new records found. SO do I have to take dump of our 13 GB and then import? or is there anyways to copy from live DB?</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13114244,"title":"The idea for a nice MYSQL print data","body":"<p>e.g.</p>\n\n<pre><code>id - Name - Surname - Phone - Married\n1 - Ann - AnnS - 123 - No\n2 - Mary - MarryS - [empty] - Yes\n3 - Jane - JaneS - 321 - [empty]\n</code></pre>\n\n<p>Now I want to take a record by <strong>id</strong> and print the info smth like this (<strong>CHANGE THE ROW NAME TO SMTH ELSE and IF THE ROW IS EMPTY - NOT TO SHOW THE ROW AT ALL</strong>):</p>\n\n<pre><code>SELECT * FROM `girls` WHERE `id`='1'\n\nThe girls name - Ann \nThe girls surname - AnnS\nThe girls number - 123\nIs the girl married? - No\n</code></pre>\n\n<p>/-/</p>\n\n<pre><code>SELECT * FROM `girls` WHERE `id`='2'\n\nThe girls name - Ann\nThe girls surname - AnnS\nIs the girl married? - No\n</code></pre>\n\n<p><em>How is it easier to do without overloading the server (there are about 130 rows in a table) ?</em></p>\n"},{"tags":["php","mysql","query","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":59,"score":-3,"question_id":13085181,"title":"mysql search query and display all similar users","body":"<p>I have small question on mysql search query i need to make a search query php scripting with displaying all similar name , eg: if 100 similar names are found in the results the 100 results must show.</p>\n\n<p>Here is my script of search query system.</p>\n\n<pre><code>$result = mysql_Query(\"SELECT user FROM `UserData` WHERE user LIKE '%$username%'\") or die(mysql_error());\n        $fetch = mysql_num_rows($result);           \n\n        if( $fetch &gt; 0 )\n        {                   \n            $resultgg = mysql_Query(\"SELECT user FROM `theusers` WHERE user LIKE '%$username%' ORDER BY `user` ASC LIMIT 500\") or die(mysql_error());\n            $row = mysql_fetch_row($resultgg);\n            $users = $row[0];               \n            echo \"$users\";                  \n        }\n               }\n    else \n    {\n            echo \"&lt;br&gt;&lt;b&gt;Please Enter Valid Username!&lt;/b&gt;\";\n    }\n</code></pre>\n\n<p>Please Help me.</p>\n"},{"tags":["php","mysql","database","query","mysqli"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13112078,"title":"Display image if field is true","body":"<p>I have a table called user_badges and a field called badge1 with the default value written <strong>\"locked\"</strong> when a user unlocks the badge the field is updated to <strong>\"unlocked\"</strong></p>\n\n<p>What I want is the script to check the value in the field badge 1 in the table  <strong>WHERE $username = $_SESSION['username'];</strong> and display the image of the badge located in a folder on my site.</p>\n\n<p>I have an idea on how to go about it but not sure how to fully execute this. </p>\n\n<pre><code>//Connect to database\n&lt;?php\n$connect = mysql_connect(\"host\",\"username\",\"password\");\nmysql_select_db(\"database_name\");\n?&gt;\n\nif field (field_name) from table (table_name) value= unlocked\necho/display image from (images/badges/fanaticbadge.png)\n\nelse echo/display (images/badges/locked.png) \n</code></pre>\n\n<p>Is this possible? Thanks for any assistance !</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":65,"score":-1,"question_id":13112759,"title":"How to select a record that is between two dateranges and two input parameters StartDate and EndDate in SQL server?","body":"<p>In my database I have a group which can be active in a week with opening hours.<br>\nGroup A Startdate: 22-10-2012 EndDate: 28-10-2012 (Startdate is always beginning of the week)<br>\nGroup A Startdate: 29-10-2012 EndDate: 04-11-2012 (Always end of the week)</p>\n\n<p>Group A has two different opening hours in this two weeks. </p>\n\n<p>Now I have a stored procedure that returns the active group by looking the input parameters StartDate and EndDate. If this two parameters are between the startdate and end date of ONE week then I'm getting the right opening hours.</p>\n\n<p>But when the input parameters are about TWO weeks (Begindate: 22-10-2012 and EndDate: 30-10-2012) then I get the opening hours of two weeks.  </p>\n\n<pre><code>declare @Begindate datetime    \nset @Begindate = '2012-10-22'\n\ndeclare @Enddate datetime   \nset @Enddate = '2012-11-02'\n\n\nSELECT Id, Date, ..., ...   \nFROM Table1 t1  \nINNER JOIN Combinations c ON t1.Id=c.Table1Id\nINNER JOIN Group g ON c.GroupId=g.Id  \nWHERE t1.Date&lt;= @Enddate) AND (t1.Date&gt;= @Begindate  (gets dates I need)   \nAND g.BeginDate &lt;=@Enddate and g.Enddate &gt;= @Begindate (Gets active groups)\n\n\nSome table data:\n\nTable1:\n\nId    Date         GroupId\n1     2012-10-23   10\n1     2012-10-29   10\n\n\n\nCombinations: (holds the relation between Table1 and Group)\n\nID  Table1Id    GroupId\n1   10          1\n\n\nGroup Table:\n\nID    Name     StartDate   EndDate     MondayOpen   MondayClose ...\n1     Group A  2012-10-22  2012-10-28  08:00        18:00\n1     Group A  2012-10-29  2012-11-04  13:00        18:00\n</code></pre>\n\n<p>With this query I am getting a group two times because both the inputparametes are over two weeks. </p>\n\n<p>How can I get for the dates (from t1) the correct opening dates looking the group Begin and End date?</p>\n"},{"tags":["sql","query","ms-access","ms-access-2007","ms-access-2003"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":244,"score":3,"question_id":8049538,"title":"How does Access's query editor decide whether to discard my formatting?","body":"<p>Like a lot of developers who are comfortable with SQL syntax I get frustrated when working with Access's query editor. I'm talking about the raw <strong>SQL Syntax</strong> view, obviously.</p>\n\n<p>One of its many annoying properties is that upon saving it will discard my layout / formatting. When reopening the query all I see is a bunch of unformatted  SQL.</p>\n\n<p>However, if my syntax is long and/or complex enough I've noticed that Access <em>will</em> retain my formatting and layout and, oh joy, the query remains clear and readable. I'm looking at an example right now with a page of SQL containing couple of <code>UNIONs</code> all nicely laid out from a few days ago.</p>\n\n<p>At what point does Access flip over to allowing the user to retain his own formatting? Is it length? Complexity? And is there maybe even a trivial structural edit (if <em>trivial structural</em> isn't an oxymoron) I can make to all my queries which will force Access to leave my layout in place?</p>\n"},{"tags":["sql","oracle","query","top-n"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":13111390,"title":"how to get first female of each tool, oracle database","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2306744/oracle-sql-how-to-retrieve-highest-5-values-of-a-column\">Oracle SQL - How to Retrieve highest 5 values of a column</a>  </p>\n</blockquote>\n\n\n\n<p>I'm writing oracle query but stuck in the following problem</p>\n\n<p>table is like this:</p>\n\n<pre><code>**Tool**       **Name**       **Gender**\nFacebook   Alice        F\nFacebook   Alex         M\nFacebook   Loong        M\nFacebook   Jimmy        M\nTwitter    James        M\nTwitter    Jessica      F\nTwitter    Sam          M\nTwitter    Kathrine     F\nGoogle     Rosa         F\nGoogle     Lily         F\nGoogle     Bob          M\n</code></pre>\n\n<p>What I wanna get is the first female in each tool\nthe result should be like:</p>\n\n<pre><code>Facebook   Alice\nTwitter    Jessica\nGoogle     Rosa\n</code></pre>\n\n<p>I'm trying to get this by using query not functions or procedures\nThank for helping</p>\n"},{"tags":["php","mysql","string","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13106195,"title":"How can I find word matches from a string in a simple mysql/php words in string wordsolver app?","body":"<p>I have 27 tables in my database.  One word table (a scrabble word list), and 26 association tables.</p>\n\n<pre><code>Table  Fields\n================\nword   [id,word]\na      [word_id]\nb      [word_id]\n...\nz      [word_id]\n</code></pre>\n\n<p>I'm trying to figure out matching words given a string.</p>\n\n<p>For example, if the given string is <code>pant</code>, I want to know: <code>pant, apt, pat, tap, ant, tan, nap, pan, at, ta, pa, an, na</code>.</p>\n\n<p>My current strategy is to explode each letter in the string and find the associated words that match all the letters.</p>\n\n<p>For example:</p>\n\n<pre><code>SELECT word.word\nFROM word, p, a, n, t\nWHERE\n    word.id = p.word_id OR\n    word.id = a.word_id OR\n    word.id = n.word_id OR\n    word.id = t.word_id\n</code></pre>\n\n<p>But this ends up printing all words that have a p,a,n or t in them.</p>\n\n<p>And if I switch all the operators to <code>AND</code>, I'm stuck with only one match: <code>pant</code>.</p>\n\n<p>Can you help me solve this riddle?</p>\n\n<p>I'm also concerned with how to handle duplicate letters in the string.  For example, <code>PPANT</code> should find a match for <code>app</code>, when plain <code>PANT</code> should not.</p>\n\n<p>Am I on the right track with the association tables or is there a better way?</p>\n\n<p>I'm trying to handle this fairly efficiently in php/mysql.  I'm aware there are others who have solved this riddle before in C, perl, java and the like.</p>\n"},{"tags":["mysql","database","query","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13109104,"title":"MySQL Database - storing data in one table or using lookups","body":"<p>I'm in the middle of redesigning an app that has 100,000s of records in a particular table (currently 250K and growing). </p>\n\n<p>The table contains information of websites and domains.</p>\n\n<p>For the sake of speed and resources, should I include all the data needed about either entity in the original table, or should I be using two lookup tables to store information not shared - for example one lookup table which stores all domain specific info and one which stores all site specific info?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13111978,"title":"rendering Ruby statements inside of rails views?","body":"<p>So in my DB I want stored a ruby/HTML statement in the Database Table such as - \np This site is owned from 2000 - #{Time.now.year} by Acme Widget Co. /p </p>\n\n<p>Or let's say that I want people to be able to include in other code snippits - e.g. \nA client wants to run in a show view in the middle of a paragraph some magical partial such as  #{render 'my_magical_code'} </p>\n\n<p>On the view I have this being rendered as &lt;%= raw(@page.content) %>  </p>\n\n<p>But its like a double rendering and rails will just put on the page #{render 'my_magical_code'} or #{Time.now.year} </p>\n\n<p>So can / how do I solve this? </p>\n\n<p>Thanks! </p>\n"},{"tags":["sql","query","design","nested","common-table-expression"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13095711,"title":"Query design for nested statements and CTEs","body":"<p>I have a query that sequentially joins 6 tables from their original data sources. Nested, it's a mess:</p>\n\n<pre><code>SELECT\nFROM\n(\n    SELECT\n    FROM\n    (\n        SELECT\n        FROM\n        (. . .)\n        INNER JOIN\n    )\n    INNER JOIN\n)\n</code></pre>\n\n<p>I switched to CTE definitions, and each definition is one join on a previous definition, with the final query at the end providing the result: </p>\n\n<pre><code>WITH\nTable1 (field1, field2) AS\n(\n    SELECT\n    FROM \n    INNER JOIN\n),\n\nTable2 (field2, field3) AS\n(\n    SELECT\n    FROM Table1\n    INNER JOIN\n), . . . \n\nSELECT \nFROM Table 6\n</code></pre>\n\n<p>This is a lot more readable, and dependencies flow downward in logical order. However, this doesn't seem like the intended use of CTEs (and also why I'm not using Views), since each definition is really only referenced once in order.</p>\n\n<p>Is there any guidance out there on how to construct sequentially nested joins like this that is both readable and logical in structure? </p>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13102762,"title":"mongoDB \"multiple\" select","body":"<p>I am not exactly sure on how this can be called, but what I want to do is select two different values with a limit; for example select 5 documents with of type \"A\", and 5 of type \"B\"; something like:</p>\n\n<pre><code>db.students.find({class: 'A'}).limit(10);\ndb.students.find({class: 'B'}).limit(10);\n</code></pre>\n\n<p>can this be done with only ONE query?\nThanks in advance.</p>\n"},{"tags":["php","mysql","database","forms","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":57,"score":-2,"question_id":12748539,"title":"Handling data from form to mysql database giving server error","body":"<p>I'm having difficulties making work a PHP script. This code handles a form  that should  add a product to the database.</p>\n\n<p>I've tried searching around for possible problems in my code but I am totally lost. I tried rewriting my code but nothing that I do seem to work for some reason. I am definitely  missing something.\n I would really appreciate if anyone can steer me towards the right direction as I've been suck with this for a couple of days plz.</p>\n\n<p>The code is as follows   </p>\n\n<pre><code>     &lt;form action=\"\" method=\"post\"&gt;\n\n    &lt;table width=\"436\" border=\"0px\"&gt;\n        &lt;tr class=\"even\"&gt;\n            &lt;td width=\"132\"&gt;&lt;label for=\"title\"&gt;title&lt;/label&gt;&lt;/td&gt;\n            &lt;td width=\"333\"&gt;&lt;input type=\"text\" size=\"40px\" name=\"title\" value=\"\"  /&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n      &lt;tr class=\"odd\"&gt;\n        &lt;td&gt;&lt;label style=\" text-align:top\" for=\"icon_description\"&gt;short description&lt;/label&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;textarea name=\"icon_description\" rows=\"2\" cols=\"30\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr class=\"even\"&gt;\n      &lt;td height=\"95\"&gt;&lt;label for=\"full_description\"&gt;full description&lt;/label&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;textarea name=\"full_description\" cols=\"30\" rows=\"6\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n\n\n      &lt;tr class=\"odd\"&gt;\n        &lt;td&gt;&lt;label for=\"category\"&gt;category&lt;/label&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;select name=\"category\" &gt;\n            &lt;?php\n            foreach(get_categories() as $category)\n            {\n                ?&gt;\n                &lt;option value=\"&lt;?php echo $category['id']; ?&gt;\"&gt; &lt;?php echo $category['category_name']; ?&gt; &lt;/option&gt;\n                &lt;?php\n            }\n            ?&gt;\n\n        &lt;/select&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"even\"&gt;\n            &lt;td&gt;&lt;label for=\"price\"&gt;price (&lt;em&gt;BsF&lt;/em&gt;)&lt;/label&gt;&lt;/td&gt;&lt;td&gt;&lt;textarea name=\"price\" rows=\"1\" cols=\"20\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"odd\"&gt;\n            &lt;td&gt;&lt;label for=\"stock\"&gt;stock&lt;/label&gt;&lt;/td&gt;&lt;td&gt;&lt;textarea name=\"stock\" rows=\"1\" cols=\"20\"&gt;&lt;/textarea&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"even\"&gt;\n            &lt;td&gt;&lt;/td&gt;\n            &lt;td style=\"margin-top:30px\"&gt;&lt;p style=\"text-align:left; margin-left:20px;\"&gt;&lt;input type=\"submit\" value=\"Add Product\" /&gt;&lt;/p&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n          &lt;/form&gt;\n        &lt;/div&gt;\n</code></pre>\n\n<p>On the same page, at the top of the document I have this code to handle the data from form and send it to the actual function that adds it to database:</p>\n\n<pre><code>&lt;?php\n\ninclude_once('init.php');\ninclude_once('store.php');\n\n$products = get_all_available_products();\n\n\nif( isset($_POST['title'], $_POST['icon_description'], $_POST['category'], $_POST['price'], $_POST['stock']) )\n{\n\n    $title = $_POST['title'];\n    $icon_description = $_POST['icon_description'];\n    $category = $_POST['category'];\n    $price = $_POST['price'];\n    $stock = $_POST['stock'];\n\n\n    $errors = array();\n\n    if( empty($title) )\n    {\n        $errors[] = 'You need to add a title.';\n    }\n    else if( strlen($title) &gt; 125 )\n    {\n        $errors[] = 'Title cannot be longer than 255 characters.';\n    }\n    if( empty($icon_description))\n    {\n        $errors[] = 'Short description is empty.';\n    }\n    if( empty($price))\n    {\n        $errors[] = 'You need to specify a price.';\n    }\n    if( empty($stock))\n    {\n        $errors[] = 'You need to ad stock amount.';\n    }\n\n\n    add_product($title, $category, $icon_description, $price, $stock);\n\n    header('Location: products.php');\n    die();\n}\n</code></pre>\n\n<p>And the code where the add_product() function is:</p>\n\n<pre><code>include_once('init.php');\n\nfunction add_product($title, $category_id, $description, $price, $stock)\n{\n    $title =  mysql_real_escape_string($title);\n    $category_id = (int)($category_id);\n    $description = mysql_real_escape_string($description);\n    $price = doubleval($price);\n    $stock = (int)$stock;\n\n    $mysql_query(\"INSERT INTO `products` SET\n                `product_name` = '{$title}',\n                `product_description` = '{$description}',\n                `category_id` = {$category_id},\n                `price` = {$price},\n                `stock` = {$stock}\");\n}\n</code></pre>\n\n<p>All my other code to display the products in databse is working, so connection and configuration is ok (i think). The problem is when I try to add a product, when I click the button to submit the website gives me a server error. </p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":94,"score":0,"question_id":13108767,"title":"Select data from multiple tables","body":"<p>How can i join multiple rows in just one single row through mysql?</p>\n\n<p>Example :</p>\n\n<p>Student Table</p>\n\n<pre><code>Sno.|  Name |  Subjects\n1.  | ABC   |  1\n2.  | ABC   |  3\n3.  | ABC   |  4\n4.  | FMC   |  2\n5.  | ABC   |  4\n6.  | JBC   |  4\n</code></pre>\n\n<p>Papers Table:</p>\n\n<pre><code>Sno. | Paper Name | Type \n 1.      French     Optional\n 2.      English    Mandatory\n 3.      Japenese   Optional\n 4.      Maths      Optional\n</code></pre>\n\n<p>Now I want it in this format</p>\n\n<pre><code>Sno.| Name|   Sub1  |  Sub2    | Sub3  |  Sub4 |\n1.  | ABC |  French |  Japenese| Maths | Null  |\n2.  | FMC |  Null   | Null     | Null  | Null  |\n3.  | JBC |  Maths  | Null     | Null  | Null  |\n</code></pre>\n\n<p>What i want to select is papers name from papers table and student name, four subjects from the other table. I only want to see those paper which are optional. I am not sure what to do?</p>\n"},{"tags":["query","data","sparql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13109251,"title":"SPARQL query universities","body":"<p>I am trying to fetch the names of universities using SPARQL:</p>\n\n<p>The rdf data is the following (and a whole lot more, but that is irrelevant).</p>\n\n<pre><code>&lt;Organization rdf:about=\"http://data.semanticweb.org/organization/the-university-of-queensland\"&gt;\n    &lt;rdfs:label&gt;The University of Queensland&lt;/rdfs:label&gt;\n    &lt;homepage rdf:resource=\"http://www.uq.edu.au/\"/&gt;\n    &lt;member rdf:resource=\"http://data.semanticweb.org/person/jane-hunter\"/&gt;\n    &lt;member rdf:resource=\"http://data.semanticweb.org/person/kwok-cheung\"/&gt;\n    &lt;member rdf:resource=\"http://data.semanticweb.org/person/robert-m-colomb\"/&gt;\n    &lt;name&gt;The University of Queensland&lt;/name&gt;\n&lt;/Organization&gt;\n</code></pre>\n\n<p>I have written a java program which queries the data. \nMy string to query the data is the following:</p>\n\n<pre><code>            queryString += \"PREFIX swrc:        &lt;http://swrc.ontoware.org/ontology#&gt; \\n\";\n            queryString += \"PREFIX dc:          &lt;http://purl.org/dc/elements/1.1/&gt; \\n\";\n            queryString += \"PREFIX foaf:        &lt;http://xmlns.com/foaf/0.1/&gt; \\n\";\n            queryString += \"PREFIX geo:         &lt;http://www.w3.org/2003/01/geo/wgs84_pos#&gt; \\n\";\n            queryString += \"PREFIX ical:        &lt;http://www.w3.org/2002/12/cal/ical#&gt; \\n\";\n            queryString += \"PREFIX rdf:         &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; \\n\";\n            queryString += \"PREFIX rdfs:        &lt;http://www.w3.org/2000/01/rdf-schema#&gt; \\n\";\n            queryString += \"PREFIX swc:         &lt;http://data.semanticweb.org/ns/swc/ontology#&gt; \\n\";\n            queryString += \"PREFIX swrc_ext:    &lt;http://www.cs.vu.nl/~mcaklein/onto/swrc_ext/2005/05#&gt; \\n\";\n            queryString += \"SELECT ?name WHERE {\\n\";\n            queryString += \"?university rdfs:label ?aff . \\n ?university foaf:name ?name FILTER(str(?aff)='uni') }\";\n</code></pre>\n\n<p>Unfortunatelly, this is not correct, as no result is returned:</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt; \n  &lt;sparql xmlns='w3.org/2005/sparql-results#'&gt; \n    &lt;head&gt; \n     &lt;variable name='name'/&gt; \n    &lt;/head&gt; \n    &lt;results&gt; \n    &lt;/results&gt; \n  &lt;/sparql&gt;\n</code></pre>\n\n<p>Can anyone point me in the right direction?</p>\n\n<p>P.S. If possible I'd like to only fetch 10 university names.</p>\n"},{"tags":["mysql","query"],"answer_count":8,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":4157,"score":1,"question_id":1138292,"title":"MySQL Query to calculate Previous Week","body":"<p>I would like to calculate my total order amount in the previous week.</p>\n\n<p>I got the query for getting the data for the last 7 days from the current date.</p>\n\n<pre><code>SELECT SUM(goods_total) AS Total_Amount  FROM orders\nWHERE order_placed_date &gt;= date_sub(current_date, INTERVAL 7 day);\n</code></pre>\n\n<p>Now how can I get Previous week data only, excluding this week.</p>\n\n<p>For e.g. This week I made $15,000 and last week i made $14,000.</p>\n\n<p>I get the $15,000 by running the above query.</p>\n\n<p>But i dont know how to calculate previous week. </p>\n"},{"tags":["sql","query","time","recording"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13108316,"title":"Employee Attendance query","body":"<p>I am writing a time recording program where people can log in to record events, like when they have started work when they have finished work. Each event such as start and finish has a status code other events like \"attending training course\" has a diferent code. Each event is timestamped.</p>\n\n<p>The table looks like this:</p>\n\n<pre><code>staff_recording.staff_name\nstaff_recording.event_time\nstaff_recording.event_code\nstaff_recording.event_note\n</code></pre>\n\n<p>I have already written one query to go through each staff name and fetch the most recent event so it can be displayed on a status board.</p>\n\n<p>I am now trying to query events for each staff member within a specified date like a week period to count the time worked. So I need to count all time between each start work event (event_code = 0) and finish work (event_code = 1) for each day, summ it up and display in hours, minutes etc.</p>\n\n<p>If anyone can help I think I need a nested query but cannot make progress!\nAndy.</p>\n"},{"tags":["database","linq","query","entity-framework","linq-to-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13108228,"title":"Loading the last related record instantly for multiple parent records using Entity framework","body":"<p>Does anyone know a good approach using Entity Framework for the problem described below?</p>\n\n<p>I am trying for our next release to come up with a performant way to show the placed orders for the logged on customer.\nOf course paging is always a good technique to use when a lot of data is available I would like to see an answer without any paging techniques.</p>\n\n<p>Here's the story: a customer places an order which gets an orderstatus = PENDING. Depending on some strategy we move that order up the chain in order to get it APPROVED.\nEvery change of status is logged so we can see a trace for statusses and maybe even an extra line of comment per status which can provide some extra valuable information to whoever sees this order in an interface.</p>\n\n<p>So an Order is linked to a Customer. One order can have multiple orderstatusses stored in OrderStatusHistory.</p>\n\n<p>In my testscenario I am using a customer which has 100+ Orders each with about 5 records in the OrderStatusHistory-table.\nI would for now like to see all orders in one page not using paging where for each Order I show the last relevant Status and the extra comment (if there is any for this last status; both fields coming from OrderStatusHistory; the record with the highest Id for the given OrderId).</p>\n\n<p>There are multiple scenarios I have tried, but I would like to see any potential other solutions or comments on the things I have already tried.</p>\n\n<ul>\n<li>Trying to do Include() when getting Orders but this still results in multiple queries launched on the database. Each order triggers an extra query to the database to get all orderstatusses in the history table. So all statusses are queried here instead of just returning the last relevant one, plus 100 extra queries are launched for 100 orders. You can imagine the problem when there are 100000+ orders in the database.</li>\n<li>Having 2 computed columns on the database: LastStatus, LastStatusInformation and a regular Linq-Query which gets those columns which are available through the Entity-model.\nThe problem with this approach is the fact that those computed columns are determined using a scalar function which can not be changed without removing the formula from the computed column, etc...</li>\n</ul>\n\n<p>In the end I am very familiar with SQL and Stored procedures, but since the rest of the data-layer uses Entity Framework I would like to stick to it as long as possible, even though I have my doubts about performance.\nUsing the SQL approach I would write something like this:</p>\n\n<pre><code>WITH cte (RN, OrderId, [Status], Information)\nAS\n(\nSELECT ROW_NUMBER() OVER (PARTITION BY OrderId ORDER BY Id DESC), OrderId,    [Status], Information\nFROM OrderStatus\n)\nSELECT o.Id, cte.[Status], cte.Information AS StatusInformation, o.* FROM [Order] o\nINNER JOIN cte ON o.Id = cte.OrderId AND cte.RN = 1\nWHERE CustomerId = @CustomerId\nORDER BY 1 DESC;\n</code></pre>\n\n<p>which returns all orders for the customer with the statusinformation provided by the Common Table Expression.</p>\n\n<p>Does anyone know a good approach using Entity Framework?</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":158,"score":1,"question_id":10187088,"title":"MySQL - Getting the top-level parent id in a hierarchy","body":"<p>Here's my table structure...</p>\n\n<p>TABLE : <strong>position_hierarchy_level</strong></p>\n\n<pre><code>id parent_position_id position_id\n 1 1                  2\n 2 2                  3\n 3 3                  4\n 4 4                  5\n 5 5                  6\n 6 6                  7\n 7 7                  8\n 8 8                  9\n 9 9                  10\n 10 10                11\n 11 11                12\n 12 12                13\n 13 13                14\n 14 14                15\n</code></pre>\n\n<p>My query for getting the <code>parent_position_id</code> of a certain <code>position_id</code> is:</p>\n\n<pre><code>select `parent_position_id` from `position_hierarchy_level` where position_id= 15;\n</code></pre>\n\n<p>But how can I get the top-most parent of a certain <code>position_id</code>? For example, the top-most <code>parent_position_id</code> of <code>position_id</code> 15 would be <code>1</code>.</p>\n\n<p>Is there a convenient way to get this value using a single query? Or do I need to create a loop in PHP?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13099319,"title":"Select row dependent on other rows in the table","body":"<p>Apologies if this has been asked before but I really didn't know what to search and thus not sure how to word the question title so fingers crossed. </p>\n\n<p>I'm building quite a common system where one product can have multiple categories and on the front-end, the user can search for products specifying multiple categories.</p>\n\n<p>Say we had the following schema and data ( I cant post images yet, apologies, please see link )- </p>\n\n<p><strong>table name: product_categories</strong></p>\n\n<p>Data: </p>\n\n<p><img src=\"http://i.stack.imgur.com/s7MaS.jpg\" alt=\"enter image description here\"> </p>\n\n<p><em>The products table is very standard - id, name, amount etc.</em></p>\n\n<p>So product 1 has 2 categories.</p>\n\n<p>If the user checks 2 tickboxes on the search page which represent category 2 and 3, how would I query that so only products which have both of those categories come back?</p>\n\n<p>Something such as follows doesn't work, as there is no one row in that which has a category id of 2 AND a category id of 3:</p>\n\n<pre><code>SELECT * from product_categories where `category_id` = 2 AND `category_id` = 3;\n</code></pre>\n\n<p>I've tried using WHERE IN aswell, however, this would return product 1 even if i was looking for products which had both category id 2 and 6 ( for example ) which I don't want.</p>\n\n<p>This is part of a bigger query however, I will be able to apply the solution if I manage to find one.</p>\n"},{"tags":["php","mysql","query","pagination"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13106918,"title":"Suggestions with pagination","body":"<p>I've a problem with pagination. The php code of pagination query is:</p>\n\n<pre><code>$ &lt;? if (isset($_GET[\"page\"])) { \n\n    $Page = preg_replace(\"/[^0-9]/\",\"\", $_GET[\"page\"]);\n} else {\n    $Page = 0;\n}\n$limit       = 10;\n$StartFrom  = $limit * $Page;\n$TotalFiles = mysql_num_rows(mysql_query(\"SELECT * FROM linkuri WHERE `categorie` = 'Afaceri' AND status = 1\"));\n$TotalPages = floor($TotalFiles / $limit); ?&gt;\n</code></pre>\n\n<p>And code to display it:</p>\n\n<pre><code>$i = 0; while ($TotalPages &gt;= $i) { echo '&lt;a class=\"active imgf\" style=\"opacity: 1;margin-bottom:3px; margin-top:3px;\" href=\"afaceri.php?page='.$i.'\"&gt;'.($i+1).'&lt;/a&gt;';$i++;}\n</code></pre>\n\n<p>The problem is I am trying to make the display as: <code>PAGES: \"BACK\" 1 2 3 4 5 \"NEXT\"</code></p>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":224,"score":2,"question_id":3481752,"title":"MySQL relational view - join?","body":"<p>I'm relatively new to MySQL and I'm having no end of difficulty trying to work out how to do this. I've researched joining and such but I'm not really sure how to apply this.</p>\n\n<p>I have three tables:</p>\n\n<p><strong>Artists Table</strong>\nID,\nName,\nDescription</p>\n\n<p><strong>Albums Table</strong>\nID,\nTitle,\nYear,\nArtist_ID</p>\n\n<p><strong>Tracks Table</strong>\nID,\nTitle,\nAlbum_ID</p>\n\n<p>Tracks are assigned to albums and albums are assigned to artists. (I did this through the relation view in phpmyadmin, engine is InnoDB).</p>\n\n<p>What I'm trying to do is query ALL of the tracks for a particular artist (from their ID).</p>\n\n<p>Is anyone able to point me in the right direction? Thanks in advance!</p>\n"},{"tags":["c++","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13106706,"title":"Which scenario is more efficient?","body":"<p>ALL,\nI have a DB with some data.\nI also have a C++ application that communicates with the DB.</p>\n\n<p>Which scenario is more efficient?</p>\n\n<p>Scenario 1:</p>\n\n<ol>\n<li>User hit \"Edit Data\" button.</li>\n<li>Program reads data from DB and presents it for editing</li>\n<li>User edit the data and hit \"Save\" button</li>\n<li>Program creates new object with the newly saved data then makes the comparison with the old object.</li>\n<li>Program issues some UPDATE statements.</li>\n</ol>\n\n<p>Scenario 2:</p>\n\n<ol>\n<li>Steps 1-3 are the same.</li>\n<li>Program overwrites an old object data with the new data.</li>\n<li>Program issue DELETE/INSERT statements in one transaction.</li>\n</ol>\n\n<p>I'm inclined to say scenario 2.</p>\n"},{"tags":["query","symfony2","request"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13105236,"title":"Symfony2 Request extra query parameter missing","body":"<p>I need to use my route <code>site_edit</code> with an extra query parameter 'company'=1. The route is as follows:</p>\n\n<pre><code>@Route(\"/_sys/site/edit/{id}\", name=\"site_edit\", defaults={\"id\"=null})\n</code></pre>\n\n<p>Symfony2 generates the link <code>/_sys/site/edit?comp=1</code> which looks fine for me. It hits the action alright but Request#query is empty though $_GET is array('comp'=>'1').\nIf I adjust the query string to be <code>/_sys/site/edit/?comp=1</code> then no matching route is found. If I insert some value for {id} e.g. <code>/_sys/site/edit/new?comp=1</code> then all is fine ($id=\"new\" and Request#query is array('comp'=>'1') but this case is not tolerable by application logic I must not change.</p>\n\n<p>I need a route with very similar structure where exactly one of the parameters comp and id is present. So the urls need to be generated as [twig] <code>url('site_edit', {'id':positiveInteger})</code> or <code>url('site_edit', {'comp':positiveInteger})</code>.</p>\n\n<p>Is this a bug? IMHO in <code>/_sys/site/edit?comp=1</code> the part before ? should launch the action with {id}=null (ok) and the part after ? should ensure that Request#query-get('comp') yields '1' (fail).</p>\n"},{"tags":["sql","mysql","query","datetime","group-by"],"answer_count":4,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":6710,"score":5,"question_id":2793994,"title":"Group mysql query by 15 min intervals","body":"<p>I've got a monitoring system that is collecting data every n seconds (n ~=10 but varies).  I'd like to aggregate the collected data by 15 minute intervals.  Is there a way to corral the timestamp column into 15 minute chunks to allow for grouping to work?</p>\n"},{"tags":["sql","oracle","query","helper"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2410,"score":4,"question_id":1841183,"title":"Decent Visual SQL query Builder","body":"<p>I am a code developer, not a DBA, and I tend to get lost with loooong SQL queries, when I use many joins (10 joins is pretty common for me). </p>\n\n<p>I would like to find a Visual SQL Query Builder (free if possible) that could connect to Oracle and see all the tables there, so I would only select visually my keys that link the Joins, and select the fields I want to be shown.</p>\n"},{"tags":["string","query",".htaccess","redirect"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13103717,"title":"Redirecting in HTACCESS from Query String to URL","body":"<p>I am trying to redirect a URL with a query string to a URL without a query string, however, I would like to use values from the query string.</p>\n\n<p>In my example below I am using a single state however I want it to be dynamic, meaning it will parse any URL with a query string down to a clean URL which still contains the value from the query string.</p>\n\n<pre><code>Example: http://www.mywebsite.com/?state=CA redirects to http://www.mywebsite.com/CA/\n</code></pre>\n\n<p>I have tired to add the information below into my HTACCESS file with no luck:</p>\n\n<pre><code>Options +FollowSymlinks\nRewriteEngine On\nRewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\\ /\\?state=([a-z]+)&amp;type=([a-z\\-]+)\nRewriteRule ^ /%1/%2? [L]\nRewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\\ /\\?state=([a-z]+)($|\\ )\nRewriteRule ^ /%1? [L]\n</code></pre>\n\n<p>These have worked however I must input every redirect which I would like to avoid:<br/></p>\n\n<pre><code>RewriteCond %{QUERY_STRING} state=FL\nRewriteRule ^$ \"http://www.mywebsite.com/fl/?\" [R=301,L]\nRewriteCond %{QUERY_STRING} state=RI\nRewriteRule ^$ \"http://www.mywebsite.com/ri/?\" [R=301,L]\n</code></pre>\n\n<p>Any ideas? I am using WordPress on Apache. I believe everything is up to date.</p>\n"},{"tags":["mysql","query","select","like"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13104113,"title":"NOT LIKE MySQL statement","body":"<p>I have an issue with NOT LIKE statement. I have two sql tables setup as tag map. First table finds tag_id according to the search name and second finds resource_id based on tag_id found. When I run a NOT LIKE statement below, I receive the result: resource_id = 1.</p>\n\n<h3>Tag map tables</h3>\n\n<pre><code>tag_id name\n1      meat\n2      vegetarian\n\nresource_id tag_id\n1           1\n1           2\n</code></pre>\n\n<h3>Query</h3>\n\n<pre><code>SELECT \n    f.id, f.food_name, tm.resource_id, tm.tag_id, t.name \nFROM \n    tag as t, tagmap as tm JOIN item as f ON \n    (\n        f.id = tm.resource_id AND tm.tag_id IN \n        (\n        SELECT \n            t.tag_id \n        FROM \n            tag as t \n        WHERE \n            t.name NOT LIKE '%meat%' \n        ) \n     )\nGROUP by f.id\n</code></pre>\n\n<p>All I need this query to do is, if it finds a resource_id with tag name \"meat\" I don't want it to return this resource_id.</p>\n\n<p>If my explanation is not clear please let me know.</p>\n"},{"tags":["sql","regex","query","database-design"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13104790,"title":"Monitoring Updates over Time Frames and/or SQL Query with Regex counting dates within string","body":"<p>This is probably a fork in the road question.  I have a journal blog that date stamps a continuation of a single field within a record.</p>\n\n<p>Example:  </p>\n\n<p>Proj #1 (ID): Notes (memo field:) 10/12/2012 - visited site. 10/11/2012 - updated information. 10/11/2012 - call client. 10/10/2012 - Input information.</p>\n\n<p>Proj #2 (ID): Notes (memo field:) 10/10/12 - visited site. 10/10/2012 - call client. 10/9/2012 - Input information. 10/1/2012 - Started project. etc etc...</p>\n\n<p>I need to count how many updates where made over a specific time frame.  I know I can create a hidden field and add + 1 everytime there is an update which is useful for an OVERALL update count... but how can i keep track of number of updates over the last 5 days.  Like the example above you may update it twice in one day and I may not care about updates made 2 weeks ago.</p>\n\n<p>I think I need to create an SQL that counts the number of \"dates\" since 10/10/12 or since 10/2/12 etc.</p>\n\n<p>I have done the SQL: SELECT memo FROM Projects WHERE memo IN ('%10/10/12%', '%10/9/2012%' etc)\nand then the Len(memoStringCombined) - Len(Replace(searchword\"\"etc)/Len(searchword) and it works fine for countings a single date...  but if I have count multiple dates over 30 days it gets to be quite cumbersome to keep rewriting each search word.  Is there a regex or obj that can loop through this for me?</p>\n\n<p>Otherwise any other suggestions for counting updates between time frames would be greatly appreciated.</p>\n\n<p>BTW - I can't really justify creating a new table dedicated to tracking updates because there will be 100's of updates for close to 10,000 records which means the update tracking table will be more monstrous than the data... or am I wrong with that idea too?</p>\n"},{"tags":["actionscript-3","flash","query","sqlite","mdm-zinc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":8277381,"title":"MDM Zinc SQLite Query by arabic text Issue","body":"<p>I am connecting to an SQLite data base via MDM and as3 and run this query: </p>\n\n<pre><code>SELECT * FROM Branch WHERE name LIKE '%مرحبا%'\n</code></pre>\n\n<p>But, after after I run it my program closes. Can mdm execute query via Arabic text?</p>\n"},{"tags":["query","query-string"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3636,"score":1,"question_id":2939130,"title":"Passing Multiple values Through Query String?","body":"<p>I tried to pass more than one value through Query String from page1.aspx to page2.aspx.</p>\n\n<p>This is my Query string in the Grid View</p>\n\n<pre><code>&lt;a href=\"javascript:void(0);\" onclick='javascript:window.open(\"Update.aspx?Regno= &lt;%#Eval (\"ID\") %&gt;'+ \",\"'&amp;Fn=&lt;%#Eval (\"FIRSTNAME\") %&gt;' +\", \"'&amp;Ln=&lt;%#Eval (\"LASTNAME\") %&gt;'\")';&gt;\n                    Edit&lt;/a&gt;\n</code></pre>\n\n<p>On My Page2.aspx, my code behind on PageLoad is:</p>\n\n<pre><code>if (Page.IsPostBack) return;\n            string id = Request.QueryString[\"ID\"];\n            string Firstname = Request.QueryString[\"FIRSTNAME\"];\n            string LastName = Request.QueryString[\"LASTNAME\"];\n</code></pre>\n\n<p>My Visual Studio IDE shows a syntax error on this query string. I dont know the exact way to pass multiple values through Query String. How to make it work? Can anyone pls help me on this..</p>\n\n<p>Which is the right syntax to pass multiple query string?</p>\n"},{"tags":["database","query","function","google-spreadsheet"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13088988,"title":"Alter data in google spreadsheet sheet via other sheet in the same spreadsheet","body":"<p><strong>Question:</strong></p>\n\n<p>Google Spreadsheet is great for viewing/filtering data, and great as DB of applications.<br/>\nBut is it possible to edit data on a sheet via another sheet?</p>\n\n<p><em><strong>Functional description:</em></strong></p>\n\n<p>We are a small group (5) non nerd that keep track of tasks we do. \nWe do this via a google spreadsheet, this works great :)\nWe recieve tasks via the phone and these get added to the sheet1.\nWhen someone pickups a task he/she addes his/her name to the appropriate column in sheet1 of the task (row).\nWe keep track of status updates etc, per task.</p>\n\n<p><em><strong>Reason for change:</em></strong></p>\n\n<p>Sheet1 of this spreadsheet is now to big to get a clear overview of the tasks of 1 person.\nSo I have 20 tasks in the big spreadsheet, but since ordering is not handy when new tasks are added, it would be nice to have a seperate sheet per person.\nThis can easily be done via the query() function.\nBut this is a one-way street. you can not alter this data and get it back in the main sheet.\nAnd using sheet1 as a report is also not handy, because how do you add new tasks?</p>\n\n<p><em><strong>Question rephrase:</em></strong></p>\n\n<ol>\n<li><p>So is it possible to alter data in the \"main\" sheet via an subset of\nthe data, available in an other sheet of the same spreadsheet?</p></li>\n<li><p>If not, is it possible to use a google spreadsheet as in interface\n(read/write/update) to an sqlite database in google app engine ?</p></li>\n</ol>\n"},{"tags":["sql","sql-server","sql-server-2008","query","query-optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13099463,"title":"Query Optimizing Request","body":"<p>I am very sorry if this question is structured in not a very helpful manner or the question itself is not a very good one!</p>\n\n<p>I need to <code>update</code> a <code>MSSQL</code> <code>table</code> call <code>component</code> every 10 minutes based on information from another <code>table</code> call <code>materials_progress</code></p>\n\n<p>I have nearly 60000 records in <code>component</code> and more than 10000 records in <code>materials_progress</code></p>\n\n<p>I wrote an <code>update query</code> to do the job, but it takes longer than 4 minutes to complete execution!\nHere is the <code>query</code> : </p>\n\n<pre><code>UPDATE component \nSET stage_id = \nCASE \n    WHEN t.required_quantity &lt;= t.total_received THEN 27\n    WHEN t.total_ordered &lt; t.total_received THEN 18\n    ELSE 18\nEND\nFROM\n    (\n    SELECT \n        mp.job_id,  \n        mp.line_no,  \n        mp.component,  \n        l.quantity AS line_quantity, \n        CASE WHEN mp.component_name_id = 2 THEN l.quantity*2\n            ELSE l.quantity\n        END AS required_quantity,\n        SUM(ordered) AS total_ordered, SUM(received) AS total_received ,\n        c.component_id \n    FROM line l \n    LEFT JOIN component c ON c.line_id = l.line_id\n    LEFT JOIN materials_progress mp ON l.job_id = mp.job_id AND l.line_no = mp.line_no AND c.component_name_id = mp.component_name_id \n    WHERE \n        mp.job_id IS NOT NULL  \n        AND (mp.cancelled IS NULL OR mp.cancelled = 0)\n        AND (mp.manual_override IS NULL OR mp.manual_override = 0)\n        AND c.stage_id = 18\n    GROUP BY  mp.job_id,  mp.line_no,  mp.component, l.quantity, mp.component_name_id, component_id\n    ) AS t\n\nWHERE \n    component.component_id = t.component_id\n</code></pre>\n\n<p>I am not going to explain the scenario as it too complex.. could somebody please please tell me what makes this query this much expensive and a way to get around it?</p>\n\n<p>Thank you very very much in advance!!!</p>\n\n<p>Edit 1:\nHere is the execution plan;\n<img src=\"http://i.stack.imgur.com/xNgxe.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql-server","query","sql-server-2008-r2","sql-function"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13103353,"title":"How to create a nullable record in SQL Server 2008 R2?","body":"<p>I create a <code>Inline table function</code> in SQL Server 2008 R2, and I realized some queries return any record. So I'd like when that happens, returns a record with all the empty columns.</p>\n\n<p>By example:</p>\n\n<pre><code>Col1   Col2   Col3\nNULL   NULL   NULL\n</code></pre>\n\n<p>UPDATE: Here is the function</p>\n\n<pre><code>ALTER FUNCTION [dbo].[GetWorksheetSummaryByObjective](@objectiveId [smallint], @testTemplateId [smallint])\nRETURNS @resultTable TABLE (\n    [AnsweredWorksheetId] [smallint] NOT NULL,\n    [LastDate] [date] NULL,\n    [BestScore] [smallint] NULL,\n    [ShouldBeMakeUp] [tinyint] NOT NULL\n)\nAS \nBEGIN\n\n    INSERT @resultTable\n    SELECT TOP 1 B.Id AS AnsweredWorksheetId, A.Date, CONVERT(smallint, B.Score * 100),\n        CASE\n        WHEN B.Score &gt;= 0.7 THEN 0\n        ELSE 1\n        END AS ShouldBeMakeUp\n    FROM AnsweredTest AS A\n    RIGHT JOIN AnsweredWorksheet AS B ON (A.Id = B.AnsweredTestId)\n    WHERE B.ObjectiveId = @objectiveId AND A.ExamTemplateId = @testTemplateId\n    ORDER BY B.Score DESC\n\n    RETURN\nEND\n</code></pre>\n"},{"tags":["query","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2656,"score":2,"question_id":5035365,"title":"How to specify multiple values in where with AR query interface in rails3","body":"<p>Per section 2.2 of rails guide on Active Record query interface <a href=\"http://guides.rubyonrails.org/active_record_querying.html#conditions\" rel=\"nofollow\">here</a>:</p>\n\n<p>which seems to indicate that I can pass a string specifying the condition(s), then an array of values that should be substituted at some point while the arel is being built. So I've got a statement that generates my conditions string, which can be a varying number of attributes chained together with either AND or OR between them, and I pass in an array as the second arg to the where method, and I get:</p>\n\n<blockquote>\n  <p>ActiveRecord::PreparedStatementInvalid: wrong number of bind variables (1 for 5)</p>\n</blockquote>\n\n<p>which leads me to believe I'm doing this incorrectly. However, I'm not finding anything on how to do it correctly. To restate the problem another way, I need to pass in a string to the where method such as \"table.attribute = ? AND table.attribute1 = ? OR table.attribute1 = ?\" with an unknown number of these conditions anded or ored together, and then pass something, what I thought would be an array as the second argument that would be used to substitute the values in the first argument conditions string. Is this the correct approach, or, I'm just missing some other huge concept somewhere and I'm coming at this all wrong? I'd think that somehow, this has to be possible, short of just generating a raw sql string.  </p>\n"},{"tags":["mysql","query","select","logical"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":27,"score":3,"question_id":13103004,"title":"MySQL logical operation SELECT query","body":"<p>I have the following query and I seem to know what is causing the error however I lack experience to fix it myself.</p>\n\n<pre><code>SELECT \n    f.id, f.food_name, tm.resource_id, tm.tag_id, t.name\nFROM \n    tag as t, tagmap as tm\nJOIN \n    item as f \n    ON \n    (\n    f.id = tm.resource_id AND tm.tag_id = \n        (\n        SELECT \n            t.tag_id \n        FROM \n            tag as t \n        WHERE \n            t.name LIKE '%meat%' OR t.name LIKE '%vegan%'\n        ) \n    )\nGROUP by f.id\n</code></pre>\n\n<p>I believe the error is in line </p>\n\n<pre><code>f.id = tm.resource_id AND tm.tag_id = \n</code></pre>\n\n<p>It is looking for a single tag_id and receiving many thus the error: <em>Error executing the SQL statement</em></p>\n\n<p>What is the procedure to receive an array of tag_id 's? I know this statement works for a single ID because if I remove the second WHERE condition the query works.</p>\n\n<p>Thanks for the help.</p>\n"},{"tags":["mysql","query","subquery"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13101511,"title":"select * duplicates, then select * non-duplicates - mysql","body":"<p>The question is for the example table structure:</p>\n\n<p>mytable</p>\n\n<pre><code>fielda, fieldb\nval1    valx\nval2    valy\nval3    valz\nval1    vala\n</code></pre>\n\n<p>I want to select from mytable with a query:</p>\n\n<pre><code>fielda, fieldb\nval1    valx\nval1    vala\n</code></pre>\n\n<p>basically select * from table where fielda is duplicated.</p>\n\n<p>then with a different query select from mytable</p>\n\n<pre><code>fielda, fieldb\nval2    valy\nval3    valz\n</code></pre>\n\n<p>val1 on fielda was encountered as a duplicate therefore it wasn't selected and the rest were.</p>\n"},{"tags":["php","arrays","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13002829,"title":"How do I get a PHP query result into an array?","body":"<p>I know this is insanely easy, but I'm a noob and not sure what I'm doing wrong here:</p>\n\n<pre><code>1: $mysqli = new mysqli('test', 'test', 'test', 'test');\n2: if ($stmt = $mysqli-&gt;prepare($query)) {\n3:     if (!$stmt-&gt;execute()) {\n4:        $out .= \"Execute failed: (\" . $stmt-&gt;errno . \") \" . $stmt-&gt;error;\n5:    }\n6:    $out = $stmt-&gt;fetch_array();\n7: } else {\n8:   $out .= $mysqli-&gt;error;\n9: }\n</code></pre>\n\n<p>I get a <code>Fatal error: Call to undefined method mysqli_stmt::fetch_array()</code> error on line 6. </p>\n"},{"tags":["android","query","android-contentprovider"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13086992,"title":"What is the proper way to get data from content provider once you have the row uri?","body":"<p>I was wondering if it is possible to get the data which is present in a content provider row directly in a cursor (or other container) in the case where I already know the row uri (in other words, I already have the ContentURIs with the row id appended).</p>\n\n<p>Both an insert or a Content Observer OnChange (on android api 16) gives me back the inserted/changed URI and I would like to get the data from that row efficiently (without many queries or instructions). However, the only way I found was to parse the ID from the URI, build a query with a selection clause to that id and then get the cursor, as:</p>\n\n<pre><code>     long row = ContentUris.parseId(uri);\n     String mSelectionClause = ContentProvider.Table._ID + \" = ?\";\n     String[] mSelectionArgs = {Long.toString(row)};\n     Uri other_uri = Uri.parse(ContentProvider.AUTHORITY_STRING + ContentProvider.UriPathIndex.Table);\n     Cursor cursor = cr.query(other_uri ,null,mSelectionClause,mSelectionArgs,null);\n</code></pre>\n\n<p>Is there some other way of doing it? I was wondering if it was possible to directly use the row uri</p>\n"},{"tags":["mysql","query","datetime","gaps-and-islands","group-by-time-interval"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13100444,"title":"Mysql select distinct only if certain time difference exist","body":"<p>I have a rather strange question.\nI have a really big table which is the log of all the request made by everyone in my webservice.\nThis table has id, user_id, and a datetime field.\nI now want to select distinct \"sessions\".\nBy session I mean that I consider requests that have more than 5 mins difference and the same user_id a different \"session\".\nIs this possible without parsing programmatically each line ?</p>\n"},{"tags":["query","onload"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13100488,"title":"My Jquery script wont run when the page loads","body":"<p>I'm trying to implement this script to centre and image on the screen. It won't run on the page load though, only when the browser is resized.</p>\n\n<p>I tried wrapping it with the:</p>\n\n<pre><code>$(document).ready(function() {});\n</code></pre>\n\n<p>But that just stops the script from working.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>&lt;script&gt;\n(function($){\n $.fn.extend({\n      center: function (options) {\n           var options =  $.extend({ // Default values\n                inside:window, // element, center into window\n                transition: 0, // millisecond, transition time\n                minX:0, // pixel, minimum left element value\n                minY:0, // pixel, minimum top element value\n                withScrolling:true, // booleen, take care of the scrollbar (scrollTop)\n                vertical:true, // booleen, center vertical\n                horizontal:true // booleen, center horizontal\n           }, options);\n           return this.each(function() {\n                var props = {position:'absolute'};\n                if (options.vertical) {\n                     var top = ($(options.inside).height() - $(this).outerHeight()) / 2;\n                     if (options.withScrolling) top += $(options.inside).scrollTop() || 0;\n                     top = (top &gt; options.minY ? top : options.minY);\n                     $.extend(props, {top: top+'px'});\n                }\n                if (options.horizontal) {\n                      var left = ($(options.inside).width() - $(this).outerWidth()) / 2;\n                      if (options.withScrolling) left += $(options.inside).scrollLeft() ||     0;\n                      left = (left &gt; options.minX ? left : options.minX);\n                      $.extend(props, {left: left+'px'});\n                }\n                if (options.transition &gt; 0) $(this).animate(props, options.transition);\n                else $(this).css(props);\n                return $(this);\n           });\n      }\n });\n})(jQuery);\n&lt;/script&gt;\n&lt;script&gt;\n$('#myDiv').center();\n$(window).bind('resize', function() {\n$('#myDiv').center({transition:20});\n});\n&lt;/script&gt;\n</code></pre>\n"},{"tags":["mysql","sql","query","view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13098871,"title":"how do I change my complex mysql query into mysql view","body":"<p>I'm a nubie in mysql queries, and I would like to ask, whether if there's someone who can help me to solve my problem. I have this complex(for me) sql. and I want to change it into a view.</p>\n\n<pre><code>SELECT \n    username, \n    user_id,\n    sum(result_points) AS count_points, \n    count(result_points) AS activity_done, \n    (\n        (\n            SELECT count(*) FROM `activity` WHERE periode_id = ''\n        ) + \n        (\n            SELECT\n                IFNULL(sum(acs.result_points), 0) \n            FROM \n                user_activity ua \n            WHERE \n                periode_id = '' \n            AND ua.user_id = user_activity.user_id\n            AND ua.result_points IS NOT NULL\n        )\n    ) AS total\n    FROM \n        user_activity \n        LEFT JOIN users ON users.id = user_activity.user_id \n    WHERE \n        periode_id = '' \n    and user_id &gt; 0 \n    GROUP BY user_id \n    ORDER BY total DESC\n</code></pre>\n\n<p>is there a way, to take out the \"where\" statement,so that i still can change it to view?</p>\n"},{"tags":["android","query","sqlite","boolean","bug"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13095277,"title":"Android - Database with ContentValue with boolean bug?","body":"<p>I created database table in my android app. I used this query:</p>\n\n<pre><code>CREATE TABLE foo (_id INTEGER PRIMARY KEY AUTOINCREMENT, mybool BOOLEAN)\n</code></pre>\n\n<p>Than I added row to the table, that the value of <code>mybool</code> will be <code>true</code>.<br>\nI ran the sqlite3 command to see the value in the table, and I saw:</p>\n\n<pre><code>  _id    |    mybool\n----------------------\n   1     |      1\n</code></pre>\n\n<p>That is corret, the <code>true</code> value became to 1.  </p>\n\n<p>The strange thing is in the reading. I read the table like that:</p>\n\n<pre><code>ContentValues values = new ContentValues();\nCursor cursor = db.rawQuery(\"SELECT * FROM foo\", null);\nDatabaseUtils.cursorRowToContentValues(cursor, values);\n</code></pre>\n\n<p>Then I get strange result:</p>\n\n<pre><code>values.getAsBoolean(\"mybool\"); // return false - WRONG\nvalues.getAsInteger(\"mybool\"); // return 1 = true - CORRECT\n</code></pre>\n\n<p>I use the code like that to get boolean value:</p>\n\n<pre><code>values.getAsInteger(\"mybool\") != 0; \n</code></pre>\n\n<p>But it's strange.</p>\n\n<p>Why I get always <code>false</code> in the <code>getAsBoolean</code> function? Is there any bug in the <code>ContentValues</code> class? Anyone else having this problem?</p>\n"},{"tags":["xml","performance","query","qt","xquery"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13098726,"title":"Qt: how to make generic (X)Query in Qt to different XML documents?","body":"<p>I'm new to QXmlQuery lib and I want to learn what is capable on with XML documents. I have maybe more than 1000 XML documents, some of them are the same (the xml scheme is the same), some of them are different.. But all of them have one common element called 'list' and this element have always children called 'item' (many items). I don't know the absolute path to the list element in each document, but I know that it is somewhere in. I want to make one query to all of this files and extract the 'items'.\nMay be this will illustrate my idea better:</p>\n\n<pre><code>QXmlQuery xquery;\nxquery.setQuery( \"doc('some_doc.xml')/list/item\");\nif (xquery.isValid())\n{\n    QXmlResultItems itemResult;\n    xquery.evaluateTo( &amp;itemResult );\n    //take an iterator or QStringList.. nevermind\n}\n</code></pre>\n\n<p>I have a code somewhere like this.</p>\n\n<p>There are two examples of these xml docs:</p>\n\n<pre><code>&lt;globalroot&gt;\n  &lt;list&gt;\n    &lt;item&gt;20.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;21.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;22.15.14447.2214&lt;/item&gt;\n  &lt;/list&gt;\n&lt;/globalroot&gt;\n</code></pre>\n\n<p>and the second example:</p>\n\n<pre><code>&lt;root&gt;\n &lt;sdmlt&gt;random text, not important&lt;/sdmlt&gt;\n &lt;localroot&gt;\n  &lt;list&gt;\n    &lt;item&gt;40.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;41.15.14447.2214&lt;/item&gt;\n    &lt;item&gt;42.15.14447.2214&lt;/item&gt;\n  &lt;/list&gt;\n &lt;/localroot&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>The output must look like this:</p>\n\n<pre><code> //I need an iterator or QStringList that contains following down elements:\n //from the first doc:\n 20.15.14447.2214\n 21.15.14447.2214\n 22.15.14447.2214\n\n //from the second doc:\n 40.15.14447.2214\n 41.15.14447.2214\n 42.15.14447.2214\n</code></pre>\n\n<p>How can I make such a generic query? I know how to iterate over the tree and just run the xQuery over each node until (isValid() == true), but I need some mechanism in Qt that allows me to do that implicitly. Is it possible? If you know something about it you can give me a short example; suggestions, similar topics are welcomed too.</p>\n"},{"tags":["java","query","mongodb","freemarker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12705679,"title":"MongoDB, Java and Freemarker Templates (FLT)","body":"<p>I'm working on this web project with: Java, MongoDB and Freemarker Templates (FTL)</p>\n\n<p>The data is sent to the FTL pages within a Map. </p>\n\n<p>Now I would like to know if it's possible to convert the result from a Mongo query straight into a Map and then send this to the FTL template. </p>\n\n<p>For example:\nI would like to query all the members from a collection and put this in Map to use in the FTL template.</p>\n\n<pre><code>        public Map&lt;String, Object&gt; getAllMembers() {\n            DBCollection collection =database.getCollection(\"members\");\n            BasicDBObject query = new BasicDBObject();\n            DBCursor cur = collection.find(query);\n            DBObject one = cur.next();\n\n            HashMap&lt;String,Object&gt; result = one;\n\n            return result;\n        }\n</code></pre>\n\n<p>Or is this not possible and I would need to loop over the results putting each value into a Map? Like this:</p>\n\n<pre><code>        public Map&lt;String, Object&gt; getAllMembers(f){\n            DBCollection collection = database.getCollection(\"members\");\n            DBCursor cursor = collection.find();\n            Map&lt;String,Object&gt; itemMap = new HashMap&lt;String, Object&gt;();\n            DBObject one;\n            while(cursor.hasNext()) {\n                one = cursor.next();\n                itemMap.put((String)one.get(\"id\"),one.get(\"name\"));\n            }\n            return itemMap;\n        }           \n</code></pre>\n\n<p>Thanks for any help and suggestions!</p>\n"},{"tags":["android","query","android-sqlite","forceclose"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13097839,"title":"use existing database in android","body":"<p>I have written this code for using an existing database in android.</p>\n\n<p><strong>What I have is:</strong></p>\n\n<ul>\n<li>database: test</li>\n<li>table: t1</li>\n</ul>\n\n<p>I have saved my database in <code>asset</code> folder and if I run my project it give me <code>force-close</code> error.</p>\n\n<p>Where am i going wrong?</p>\n\n<pre><code>public class BDAdapter extends SQLiteOpenHelper {\n     private Context mycontext;\nint id=0;\n        private String DB_PATH = \"data/data/com.example.dd9/databases/\";\n        private static String DB_NAME = \"test.sqlite\";\n     //   public static final String KEY_ROWID = \"_id\";\n        public static final String KEY_QUOTE = \"name\";\n        private static final String DATABASE_TABLE = \"t1\";\n        private static final String TAG = \"BDAdapter\";\n        private static final String DATABASE_CREATE =\n                \"create table t1 ( \"\n                + \"name text not null );\";\n\n        private SQLiteDatabase db;\n\n\n\n        public BDAdapter(Context context) {\n            super(context, DB_NAME, null, 1);\n            this.mycontext = context;\n            boolean dbexist = checkdatabase();\n            if (dbexist) {\n            } else {\n                System.out.println(\"Database doesn't exist\");\n                try {\n                    createdatabase();\n                } catch (IOException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n            }\n\n        }\n\n        public void createdatabase() throws IOException {\n            boolean dbexist = checkdatabase();\n            if (dbexist) {\n            } else {\n                this.getReadableDatabase();\n                try {\n                    copydatabase();\n                } catch (IOException e) {\n                    throw new Error(\"Error copying database\");\n                }\n            }\n        }\n\n        private boolean checkdatabase() {\n            boolean checkdb = false;\n            try {\n                String myPath = DB_PATH + DB_NAME;\n                File dbfile = new File(myPath);\n                checkdb = dbfile.exists();\n            } catch (SQLiteException e) {\n                System.out.println(\"Database doesn't exist\");\n            }\n\n            return checkdb;\n        }\n\n        private void copydatabase() throws IOException {\n\n            // Open your local db as the input stream\n            InputStream myinput = mycontext.getAssets().open(DB_NAME);\n\n            // Path to the just created empty db\n            @SuppressWarnings(\"unused\")\n            String outfilename = DB_PATH + DB_NAME;\n\n            // Open the empty db as the output stream\n            OutputStream myoutput = new FileOutputStream(\n                    \"data/data/com.example.dd9/databases/test.sqlite\");\n\n            // transfer byte to inputfile to outputfile\n            byte[] buffer = new byte[1024];\n            int length;\n            while ((length = myinput.read(buffer)) &gt; 0) {\n                myoutput.write(buffer, 0, length);\n            }\n\n            // Close the streams\n            myoutput.flush();\n            myoutput.close();\n            myinput.close();\n\n        }\n\n        public void open() {\n            // Open the database\n            String mypath = DB_PATH + DB_NAME;\n            myDataBase = SQLiteDatabase.openDatabase(mypath, null,\n                    SQLiteDatabase.OPEN_READWRITE);\n\n        }\n\n        public synchronized void close() {\n            myDataBase.close();\n            super.close();\n        }\n\n        @Override\n        public void onCreate(SQLiteDatabase db) {\n            // TODO Auto-generated method stub\n            db.execSQL(DATABASE_CREATE);\n\n        }\n\n        @Override\n        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {\n            // TODO Auto-generated method stub\n            Log.w(TAG, \"Upgrading database from version \" + oldVersion + \" to \"\n                    + newVersion + \", which will destroy all old data\");\n            db.execSQL(\"DROP TABLE IF EXISTS t1\");\n            onCreate(db);\n\n\n        }\n\n        public long insertQuote(String Quote) \n        {\n            ContentValues initialValues = new ContentValues();\n            initialValues.put(KEY_QUOTE, Quote);\n            return db.insert(DATABASE_TABLE, null, initialValues);\n        }\n\n        public int getAllEntries() \n        {\n            Cursor cursor = db.rawQuery(\n                        \"SELECT COUNT(name) FROM t1\", null);\n                    if(cursor.moveToFirst()) {\n                        return cursor.getInt(0);\n                    }\n                    return cursor.getInt(0);\n\n        }\n\n        public String getRandomEntry() \n        {\n\n            id = getAllEntries();\n            Random random = new Random();\n            int rand = random.nextInt(getAllEntries());\n            if(rand == 0)\n                ++rand;\n            Cursor cursor = db.rawQuery(\n                      \"SELECT name FROM t1 \", null);\n                    //\"SELECT * FROM tblRandomQuotes\",null);\n                    if(cursor.moveToFirst()) {\n                        return cursor.getString(0);\n\n                    }\n                    return cursor.getString(0);\n\n        }\n\n        public Cursor getAllTitles() \n        {\n            return db.query(DATABASE_TABLE, new String[] {\n\n                    KEY_QUOTE,\n                    }, \n                    null, \n                    null, \n                    null, \n                    null, \n                    null);\n        }\n\n\n}\n\n\n\n//---------------------------Main class------------------------\n\npublic class MainActivity extends Activity\n{\n    BDAdapter db = new BDAdapter(this);\n    EditText name;\n    /** Called when the activity is first created. */\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.main);\n        // Capture our button from layout\n        Button setButton = (Button)findViewById(R.id.go);\n        Button getButton = (Button)findViewById(R.id.genRan);\n        // Register the onClick listener with the implementation above\n        setButton.setOnClickListener(mAddListener);\n        getButton.setOnClickListener(mAddListener);\n    }\n\n    // Create an anonymous implementation of OnClickListener\n    private OnClickListener mAddListener = new OnClickListener() \n    {\n        public void onClick(View v) \n        {\n            switch(v.getId())\n            {\n            case R.id.go:\n                db.open();\n                long id = 0;\n                // do something when the button is clicked\n                try\n                {\n                    name = (EditText)findViewById(R.id.Quote);\n                    db.insertQuote(name.getText().toString());\n\n\n                    id = db.getAllEntries();\n\n                    Context context = getApplicationContext();\n                    CharSequence text = \"The quote '\" + name.getText() + \"' was added successfully!\\nQuotes Total = \" + id;\n                    int duration = Toast.LENGTH_LONG;\n\n                    Toast toast = Toast.makeText(context, text, duration);\n                    toast.show();\n                    name.setText(\"\");\n                }\n                catch (Exception ex)\n                {\n                    Context context = getApplicationContext();\n                    CharSequence text = ex.toString() + \"ID = \" + id;\n                    int duration = Toast.LENGTH_LONG;\n\n                    Toast toast = Toast.makeText(context, text, duration);\n                    toast.show();\n                }\n\n                db.close();\n                break;\n            case R.id.genRan:\n                db.open();\n                //long id1 = 0;\n                // do something when the button is clicked\n                try\n                {\n                    //String quote = \"\";\n                    //quote = db.getRandomEntry();\n                    //Context context = getApplicationContext();\n                    //CharSequence text = quote;\n                    //int duration = Toast.LENGTH_LONG;\n\n                    //Toast toast = Toast.makeText(context, text, duration);\n                    //toast.show();\n\n                     db.open();\n                        Cursor c = db.getAllTitles();\n                       if (c.moveToFirst())\n                       {\n                          do {          \n                                DisplayTitle(c);\n                            } while (c.moveToNext());\n                       }\n                        db.close();\n\n\n                }\n                catch (Exception ex)\n                {\n                    Context context = getApplicationContext();\n                    CharSequence text = ex.toString();\n                    int duration = Toast.LENGTH_LONG;\n\n                    Toast toast = Toast.makeText(context, text, duration);\n                    toast.show();\n                }\n                db.close();\n            }\n        }\n\n    };\n    public void DisplayTitle(Cursor c)\n    {\n        Toast.makeText(this, \n                \"NAME: \" + c.getString(0) + \"\\n\" ,\n\n\n                Toast.LENGTH_LONG).show();        \n    } \n\n\n}\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13097320,"title":"How do I query a user value in one table to a column header and get value under header?","body":"<h2>Situation</h2>\n\n<p>I have two tables:</p>\n\n<p><img src=\"http://i.stack.imgur.com/TDCPR.jpg\" alt=\"tables\"></p>\n\n<ul>\n<li>SGL= Single (one person in room)</li>\n<li>DBL = Double (two people in the room)</li>\n<li>TPL = Triple (three people).</li>\n</ul>\n\n<p>and so on.  (CHD = child in room; discounted occupancy).</p>\n\n<p>The <em>clients</em> table contains user inserted values.  The <em>tourprices</em> table is preset rates for roomtypes.</p>\n\n<h2>Question</h2>\n\n<p>Is there a way to query such that the user inserted roomtype is compared to the column header of tourprices table such that the result is the price for the date under that column header?</p>\n\n<p>For example:  the user wishes to book two people (DBL) onto the tour for 27-Feb-2012.  How do I write the query to pull the $200 rate based on the given?</p>\n\n<pre><code>SELECT c.roomtype, t.SGL, t.DBL, t.TPL, t.QUD, t.CHD\nFROM clients c, tourprices t\nWHERE c.roomtype = ??????\n</code></pre>\n\n<p>thanks!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13096830,"title":"Set the default schema order of a MySQL table to be reversed","body":"<p>I am currently running this query:</p>\n\n<pre><code>SELECT t.videolink, t.userid, t.tag\n    FROM (SELECT * FROM tagstrend ORDER BY timestamp DESC) AS t\n        WHERE t.timestamp &gt; ?\n        GROUP BY t.tag\n        ORDER BY SUM(t.tagcount) DESC\n        LIMIT ?, 20;\n</code></pre>\n\n<p>What I am doing is reversing the order of the table that I am selecting from before I run the rest of the query because when the I use \"GROUP BY\" I need that to take the top result which is the most recent row in the database.</p>\n\n<p>However doing this will take a hit on the performance/speed of the query because it needs to reverse the order of the table before it can query it.</p>\n\n<p>My question is, is there a way to set the default order of the table to be reversed? Because I will always be SELECTing from this table in reverse order.</p>\n\n<p>Unless someone knows a way of grouping by the most recent row in the database?</p>\n"},{"tags":["ios","query","parse.com"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12980105,"title":"Parse.com iOS queryWithClassName works for some and not others, why?","body":"<p>I have several Classes one of which one is User and another one is TestObject.  If I query User (which I learned by trial &amp; error that it should queried as _User) I get the correct record count, but if I query TestObject I get 0.  This happens for some Classes but not for all.  Why is that?</p>\n\n<pre><code>PFQuery *query = [PFQuery queryWithClassName:@\"_User\"];\n[query findObjectsInBackgroundWithBlock:^(NSArray *objects, NSError *error) {\n             if (error) {\n                 NSLog(@\"Error: %@ %@\", error, [error userInfo]);\n             } else {\n                 NSLog(@\"Successfully retrieved %d scores.\",objects.count);\n             }\n}];\n</code></pre>\n\n<p>This returns: </p>\n\n<blockquote>\n  <p>2012-10-19 13:55:03.239\n  TableViewParseDotCom[5497:10103]\n  Successfully retrieved 24 scores.</p>\n</blockquote>\n\n<p>But if I change the line, to:</p>\n\n<blockquote>\n  <p>PFQuery *query = [PFQuery\n  queryWithClassName:@\"TestObject\"];</p>\n</blockquote>\n\n<p>I get 0 count, but I know I have  45 records.  Why?</p>\n"},{"tags":["oracle","query","oracle11gr2"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":379,"score":5,"question_id":11083718,"title":"Query causes DB to fail with ORA-0113","body":"<p>I need to create a collection out of elements in a collection within an inline view. I've tryed to deaggregate the collection and aggregate it again using the collect and table functions, but it fails with ORA-03113.</p>\n\n<p>Below is a simplified version of the query causing the issue.</p>\n\n<p>In my Implementation I will have many levels of nested queries joined with unions in a single query that should aggregate all collections into a single one. For performance reasons (Expensive context switching), implementing PL/SQL code to aggregate the collections is not an option.</p>\n\n<p>Thanks a lot for your feedback/suggestions.</p>\n\n<h3>Script</h3>\n\n<hr>\n\n<pre><code>SELECT BANNER FROM V$VERSION\n/\n\nCREATE OR REPLACE TYPE OBJECT_ID_TAB_T IS TABLE OF NUMBER(11);\n/\n\nSELECT OWNER, CAST(COLLECT( MULTISET(SELECT COLUMN_VALUE FROM TABLE((OBJECT_ID_LIST) ))) AS OBJECT_ID_TAB_T) AS OBJECT_ID_LIST\nFROM  (SELECT OWNER, OBJECT_NAME, CAST(COLLECT(OBJECT_ID) AS OBJECT_ID_TAB_T)  AS OBJECT_ID_LIST\n       FROM ALL_OBJECTS\n       GROUP BY OWNER, OBJECT_NAME\n      )\nGROUP BY OWNER\n/\n</code></pre>\n\n<h3>Results</h3>\n\n<hr>\n\n<pre><code>BANNER                                                                          \n--------------------------------------------------------------------------------\nOracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production    \nPL/SQL Release 11.2.0.1.0 - Production                                          \nCORE    11.2.0.1.0  Production                                                      \nTNS for 64-bit Windows: Version 11.2.0.1.0 - Production                         \nNLSRTL Version 11.2.0.1.0 - Production                                          \n\n5 rows selected.\nType created.\nSELECT OWNER, CAST(COLLECT( MULTISET(SELECT COLUMN_VALUE FROM TABLE((OBJECT_ID_LIST) ))) AS OBJECT_ID_TAB_T) AS OBJECT_ID_LIST\nFROM  (SELECT OWNER, OBJECT_NAME, CAST(COLLECT(OBJECT_ID) AS OBJECT_ID_TAB_T)  AS OBJECT_ID_LIST\n       FROM ALL_OBJECTS\n       GROUP BY OWNER, OBJECT_NAME\n      )\nGROUP BY OWNER\n*\nError at line 0\nORA-03113: end-of-file on communication channel\nProcess ID: 8000\nSession ID: 154 Serial number: 164\n\nScript Terminated on line 25.\n</code></pre>\n"},{"tags":["mysql","sql","query","aggregate-functions","greatest-n-per-group"],"answer_count":4,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":8244,"score":14,"question_id":7745609,"title":"SQL Select only rows with Max Value on a Column","body":"<p>I have this table for documents (simplified version here):</p>\n\n<pre><code>+------+-------+--------------------------------------+\n| id   | rev   | content                              |\n+------+-------+--------------------------------------+\n| 1    | 1     | ...                                  |\n| 2    | 1     | ...                                  |\n| 1    | 2     | ...                                  |\n| 1    | 3     | ...                                  |\n+------+-------+--------------------------------------+\n</code></pre>\n\n<p>How do I select one row per id and only the greatest rev?<br>\nWith the above data, the result should contain two rows: <code>[1, 3, ...]</code> and <code>[2, 1, ..]</code>. I'm using MySQL.</p>\n\n<p>Currently I use checks in the <code>while</code> loop to detect and over-write old revs from the resultset. But is this the only method to acheive the result? Isn't there a SQL solution? </p>\n"},{"tags":["query","parsing","solr","lucene"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13091973,"title":"SOLR query coming from my application is not parsed the same as when i do it from SOLR admin console","body":"<p>I am fairly new to Solr/Lucene and am not a developer. I am troubleshooting issues where my queries that use AND/NOT are not returning the results as they should. When i run the search using them it seems to only treat the 1st word before the AND/NOT. I think i know why. see below</p>\n\n<p>I have tried several ways to no avail.</p>\n\n<p>Catalina log show the following when i run from our .net application</p>\n\n<pre><code>INFO: [] webapp=/solr path=/select params={spellcheck=true&amp;start=0&amp;q=content_en:\"GINGER+NOT+BRAD\"&amp;?=&amp;rows=1000} hits=0 status=0 QTime=0 \n</code></pre>\n\n<p>It appears to be putting my query in just one q=content_en: with the NOT included</p>\n\n<p>Catalina log show the following when i run from solr admin</p>\n\n<pre><code>INFO: [] webapp=/solr path=/select/ params={start=0&amp;version=2.2&amp;q=content_en:ginger++NOT+content_en:brad&amp;indent=on&amp;rows=10} hits=1 status=0 QTime=1 \n</code></pre>\n\n<p>It is properly treating each criteria by segregating them.</p>\n\n<p>I have tried EVERY single combination from my application front end and still no go.</p>\n\n<p>I'm sure you gurus will see this and tell me what's wrong.</p>\n"},{"tags":["query","filter","lucene","neo4j"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12155578,"title":"queryContext - filtering with numbers neo4j/lucene","body":"<p>I'm trying to filter a wildcard query in neo/lucene using numeric range.\nI want to search for all nodes (documents) having key \"actor\" starting with \"rob\" and age > 20:</p>\n\n<pre><code>WildcardQuery luceneQuery  = new WildcardQuery( new Term(\"actor\", \"rob*\" ));\nQueryContext qx = new QueryContext(luceneQuery)\n            .numericRange(\"age\", 20, null)\n                .sortNumeric(\"age\", true);      \nIndexHits&lt;Node&gt; hits = lucene.query(qx);\n</code></pre>\n\n<p>Once I add numeric range the wildCard query does not works, it only orders by numeric range.\nIs it possible to combine both wildcard and numeric?</p>\n\n<p>Thanks,\nDaniele</p>\n"},{"tags":["query","report","multiple"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13094169,"title":"copy the resultset from maindataset to subdataset in jasper report","body":"<p>I'm working on a JRXML report and want to display a detailed table and pie chart using the same query. Since I will have to sort and groupby the data to generate the pie chart and I dont want my table report to be sorted, I want to work on different datasets(with same data)</p>\n\n<p>Is there any way to copy the resultset from maindataset to subdataset in jasper report (JRXML)?</p>\n\n<p>Or can I write a query like <code>select * from MAINDATASET</code> in the querystring of the subdataset.</p>\n"},{"tags":["query","ms-access","access-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1307,"score":0,"question_id":7194224,"title":"How to query number of attachments from Attachment field in Microsoft Access?","body":"<p>One of my users has a Microsoft Access database and in the table he has an attachment field. In one of his queries, he wants to return the number of attachments that the field contains. I have tried to get this to work to no avail. I've tried creating a VBA module and passing into it the field but it errors on me. I've tried creating the parameter as a DAO.Recordset, DAO.Field, Attachment, etc.</p>\n\n<p>I've also tried querying the field like this [MyField].AttachmentCount.</p>\n"},{"tags":["sql","query","group-by","max","cascading"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":20,"score":2,"question_id":13094338,"title":"Select latest month record from group of records for several groups","body":"<p>I have a table that generates a record each month for each project status report (PSR) if a PSR is/was generated. From a single table, I need to get the most recent record for each PSR.</p>\n\n<p>This gives me the list of PSR's I am looking for:</p>\n\n<pre><code>SELECT Max(Main.PSRMonth) AS MaxOfPSRMonth, Main.PE, Main.Loc, Main.EWO\nFROM Main\nGROUP BY Main.PE, Main.Loc, Main.EWO\nORDER BY Main.PE, Main.Loc, Main.EWO;\n\nTable:Main \nPrimary Key is PSRMonth + PE + EWO + LOC\n</code></pre>\n\n<p>Now, I need all fields <code>FROM Main</code> based on the selection above.\nI would like to do this with one SQL statement.</p>\n"},{"tags":["sql","xml","query","performance"],"answer_count":4,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":700,"score":1,"question_id":3701616,"title":"Speed Up XML Queries in SQL Server 2005","body":"<p>I store all my data in on XML column in SQL Server 2005.</p>\n\n<p>As more and more records are being inserted, I notice the queries are slowing down.  I've tried creaeting a Primary XML Index, as well as a Secondary VALUE index and this did not do anything to help the speed.</p>\n\n<p>Any tips,thoughts, or tricks that I'm missing?</p>\n\n<p>Sample View that I query:</p>\n\n<pre><code>SELECT Id\n, CaseNumber\n, XmlTest.value('(/CodeFiveReport/ReportEvent/StartDate)[1]', 'varchar(25)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/StartTime)[1]', 'varchar(25)') as StartDate\n, XmlTest.value('(/CodeFiveReport/@Status)[1]', 'varchar(10)') as [Status]\n, XmlTest.value('(/CodeFiveReport/ReportEvent/Address/PatrolDistrict/@Name)[1]', 'varchar(100)') as PatrolDistrict\n, XmlTest.value('(/CodeFiveReport/PrimaryUnit/@Name)[1]', 'varchar(40)') as PrimaryUnit\n, XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@StreetNumber)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@StreetName)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/StreetSuffix/@Name)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@City)[1]', 'varchar(50)') + ' ' + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/State/@Abbreviation)[1]', 'varchar(50)') + ' '  + XmlTest.value('(/CodeFiveReport/ReportEvent/Address/@ZipCode)[1]', 'varchar(50)') as Location\n, XmlTest.value('(/CodeFiveReport/ReportEvent/ReportType/@Name)[1]', 'varchar(50)') as ReportType\n, XmlTest.value('(/CodeFiveReport/ReportEvent/Offenses/OffenseDescription/OffenseType/@CodeAndDescription)[1]', 'varchar(50)') as IncidentType\n, XmlTest as Report\n, CreatedBy as UserId\n, XmlTest.value('(/CodeFiveReport/PrimaryUnit/@ID)[1]', 'integer') as UnitId\n, XmlTest.value('(/CodeFiveReport/PrimaryUnit/@Code)[1]', 'varchar(6)') as UnitCode\n, XmlTest.value('(/CodeFiveReport/Owner/AgencyID)[1]', 'char(2)') as AgencyId   \n, IsLocked\n, LockedBy\n, XmlTest.value('(/CodeFiveReport/VersionUsed)[1]', 'varchar(20)') as VersionUsed\nFROM UploadReport\nWHERE XmlTest.value('(/CodeFiveReport/Owner/AgencyID)[1]', 'char(2)') = '06'\n</code></pre>\n"},{"tags":["django","query","chain"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13087511,"title":"Django Q chained queries","body":"<p>I need a little help with a Django Q query im trying to string together, it looks right, but its not quite working. The query is</p>\n\n<pre><code>( Q(src__lte=4) &amp; Q(src__startswith='2') ) | \n( Q(src__gt=4) &amp; ~Q(src__istartswith='713') &amp; ~Q(src__istartswith='281') ) )\n</code></pre>\n\n<p>what im trying to accomplish would be \"select where src is less than 4 AND startsiwth 2 OR src is greater than 4 and DOES NOT start with 713 OR 281\"</p>\n\n<p>the result is showing src's that start with 713 and 281, what am i doing wrong here? thanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13088856,"title":"SQL Server : add CSV programmable","body":"<p>I have the following code to insert a CSV file into a temp table:</p>\n\n<pre><code>USE [websitehere.com].[dbo]\nGO\nCREATE TABLE [websitehere.com].[dbo].[tmpTable]\n(ID INT,\n    Caller_Number VARCHAR(100),\n    Caller_Name VARCHAR(100),\n    GroupBy VARCHAR(100),\n    Campaign_Name VARCHAR(100),\n    DateAndTime VARCHAR(100),\n    Duration VARCHAR(100),\n    Call_Status VARCHAR(100))\nGO;\n\nBULK\nINSERT tmpTable \nFROM 'C:\\Users\\namehere\\Documents\\CallLog.csv' \nWITH\n(\n    FIELDTERMINATOR = ',',\n    ROWTERMINATOR = '\\n'\n)\nGO\n</code></pre>\n\n<p>But...</p>\n\n<ol>\n<li><p>It does not seem to add the <code>tmpTable</code>. It gives me an error </p>\n\n<blockquote>\n  <p><em>Msg 102, Level 15, State 1, Line 1<br>\n  Incorrect syntax near '.'.</em></p>\n</blockquote></li>\n<li><p>It won't add the insert command saying that</p>\n\n<blockquote>\n  <p><em>Msg 4834, Level 16, State 4, Line 8<br>\n  You do not have permission to use the bulk load statement.</em></p>\n</blockquote></li>\n</ol>\n\n<p>Any help would be great to take care of these 2 errors!</p>\n\n<p><strong>Update</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/Hxv6A.png\" alt=\"db user secutirys\"></p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13092702,"title":"How to iterate this SQL Query?","body":"<p>I've got this query: </p>\n\n<pre><code>SELECT TOP 1 A.ExamTemplateId, A.Id AS AnsweredTestId, AVG(B.Score) AS AvgScore, A.[Date]\nFROM AnsweredTest AS A\nINNER JOIN AnsweredWorksheet AS B ON (A.Id = B.AnsweredTestId)\nWHERE A.StudentId = 'OPA-3DKCL2' AND A.ExamTemplateId = 1\nGROUP BY A.Id, A.ExamTemplateId, A.[Date]\nORDER BY AvgScore DESC\n</code></pre>\n\n<p>Please check that I have a <code>WHERE</code> condition which receives a static number. The query result is:</p>\n\n<p>EXAMPLE 1\n<img src=\"http://i.stack.imgur.com/EZqHP.png\" alt=\"\"></p>\n\n<p>EXAMPLE 2\n<img src=\"http://i.stack.imgur.com/mAdO8.png\" alt=\"enter image description here\"></p>\n\n<p>And it is correct! But now, I'd like to show all the records from a ExamTemplate table. But now I don't know how can I accomplish that. I was thinking creating a function but I'm not sure, it's just an idea.</p>\n\n<p>The final output which I'd like to receive is the union of last records:</p>\n\n<pre><code>1   1   0.7 2012-10-21 19:50:11.697\n2   10  0.555555555555556   2012-10-22 18:58:24.163\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>UPDATE:</p>\n\n<p>I've got highlighted with yellow color the rows which I'm interested. I set in the last query <code>TOP 1</code> because I want to get the highest average score by <code>ExamTemplateId</code>. And that's will be all.</p>\n\n<p><img src=\"http://i.stack.imgur.com/VUALu.png\" alt=\"enter image description here\"></p>\n"},{"tags":["mysql","query","relationship"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13081264,"title":"Select Parent, Children, Children's Children, etc in single MySQL query","body":"<p>I feel like this must be a classic problem, but I can't find the answer.</p>\n\n<p>I have a table Person, which has basic details describing a person. Then, I have a ParentChildRelationship table, which looks something like this:</p>\n\n<pre><code>CREATE TABLE `ParentChildRelationship` (\n    `ParentId` INT(10) UNSIGNED NOT NULL,\n    `ChildId` INT(10) UNSIGNED NOT NULL,\n PRIMARY KEY(ParentId,ChildId),\n CONSTRAINT `FK_ParentRelationship`\n    FOREIGN KEY (`ParentId` )\n    REFERENCES `Person` (`idPerson` ),\n CONSTRAINT `FK_ChildRelationship`\n    FOREIGN KEY (`ChildId` )\n    REFERENCES `Person` (`idPerson` )\n);\n</code></pre>\n\n<p>I need a select query that simply returns all Person records for the Parent and all Children down the tree.</p>\n\n<p>For example, with the following data:</p>\n\n<pre><code>Parent   Child\n1        3\n1        8\n2        4\n3        5\n3        6\n6        9\n4        7\n</code></pre>\n\n<p>Select all Person records where the ParentId = 1 OR ChildId is in the tree <em>below</em> ParentId of 1. This query should return the Person information (SELECT * FROM <code>Person</code>...) for the following PersonId's:</p>\n\n<p>1,3,8,5,6,9</p>\n\n<p>I don't know if this matters, but the order of how these are returned do not matter, as I will need to order based off of something like \"LastName\" or something like that. In other words, the result could also have been 1,3,5,6,9,8.</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13092624,"title":"PostgreSQL Inner Join on the same table + second table?","body":"<p>If this is a stupid question, forgive me, I'm not very familiar with PostgreSQL.</p>\n\n<p>I've collected inventory data from used car dealerships in my area and stored it in a postgreSQL table. I've got a second table with particular details regarding certain makes and models. For example:</p>\n\n<p>The dealership table is structured like so:</p>\n\n<pre><code>-----------------------------------------\n| Dealership | Make | Model | Year | ID |\n----------------------------------------|\n|     A      | Ford | F250  | 2003 |  1 |\n|     A      | Chevy| Cobalt| 2005 |  2 |\n|     B      | Ford | F250  | 2003 |  1 |\n|     B      | Dodge| Chrgr | 2012 |  3 |\n-----------------------------------------\n</code></pre>\n\n<p>The details table is structured like so:</p>\n\n<pre><code>-----------------------------------------\n|     ID     | DetailA| DetailB| DetailC|\n-----------------------------------------\n|     1      |  data  |  data  |  data  |\n|     2      |  data  |  data  |  data  |\n|     3      |  data  |  data  |  data  |\n|     4      |  data  |  data  |  data  |\n-----------------------------------------\n</code></pre>\n\n<p>My goal is to retrieve vehicle matches from multiple dealerships and display the appropriate details. In the above example, I would like to see:</p>\n\n<pre><code>-----------------------------------------------------\n| Make | Model | Year | DetailA | DetailB | DetailC |\n-----------------------------------------------------\n| Ford | F250  | 2003 |   data  |  data   |  data   |\n-----------------------------------------------------\n</code></pre>\n\n<p>With this result, I will know that both A and B havea  2003 Ford F250 for sale, and can view the related details of the vehicle.</p>\n\n<p>I've tried many different queries, but most are variations on something like this:</p>\n\n<pre><code>SELECT DISTINCT\n    dealership_table.make,\n    dealership_table.model,\n    dealership_table.year\n            details_table.detaila,\n            details_table.detailb,\n            details_table.detailc\nFROM\n    dealership_table\nINNER JOIN\n    details_table\n    ON\n    dealership_table.id = details_table.id\nWHERE\n     dealership_table.dealership = 'A'\n     OR\n     dealership_table.dealership = 'B'\n</code></pre>\n\n<p>However this returns all of the distinct matches from the table where dealership is either A or B. I've tried multiple inner-joins, but I an error complaining <code>details_table</code> is specified multiple times.</p>\n\n<p>If I'm doing something really silly, I apologize. Like I said before, I'm pretty much an SQL noob.</p>\n\n<p>What am I doing wrong? How should I go about retrieving the desired results? Any suggestions, solutions, or advice is greatly appreciated!</p>\n"},{"tags":["query","lucene"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13092455,"title":"Lucene - search a subset with boolean query","body":"<p>I have an index with a field (eg. field1) with two rows, one is \"short greg\" and the second one is \"great greg\".\nif I search with (using Luke) : field1:g*  field1:greg </p>\n\n<p>the result will be both rows but with the same score!\nThese because both words have the same initial character G.</p>\n\n<p>My expectation is \"great greg\" with the maximum score, where G* give more weight to the score of \"GREAT GREG\".</p>\n\n<p>the question is : how to write this query ? \nthanks anyway </p>\n"},{"tags":["mysql","sql","query","random"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13092337,"title":"mysql select number overflow","body":"<p>I have the following query:</p>\n\n<pre><code>SELECT (RAND() * (SELECT MAX(id) FROM frag.test))\n</code></pre>\n\n<p>Results in: -2.36835027969671e+18 <br>\nid is a: <code>id</code> bigint(20) unsigned</p>\n\n<p>The things is that</p>\n\n<pre><code>SELECT MAX(id) FROM frag.test\n</code></pre>\n\n<p>Results in 15783548581713655808</p>\n\n<p>And if I place the literal number instead of a select it works</p>\n\n<pre><code>SELECT (RAND() * 15783548581713655808\n</code></pre>\n\n<p>Results in  1.50243050315076e+19</p>\n\n<p>Also the following query:</p>\n\n<pre><code>SELECT RAND()*id from frag.test;\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>+----------------------+\n| RAND()*id            |\n+----------------------+\n| 2.90739099802377e+18 |\n| 3.18790581714312e+18 |\n| 4.55299756382674e+18 |\n| 8.53310890373737e+18 |\n| 5.32382972831492e+18 |\n| 1.13192831652015e+19 |\n+----------------------+\n</code></pre>\n\n<p>The problem appears to happen only when MAX() is used.</p>\n\n<p>Anyone have any thoughts on what might be happening here?</p>\n\n<p>Thank you!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As pointed out by coge, this has something to do with casting.\nI changed the query to</p>\n\n<pre><code>SELECT (RAND() * (SELECT cast(MAX(id) as decimal(30,10)) FROM frag.test));\n</code></pre>\n\n<p>And now it works as expected!</p>\n"},{"tags":["sql-server-2008","query","wildcard","like-operator"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13077636,"title":"Parameterizing an SQL query which uses the NOT LIKE, \" ^ \" wildcard?","body":"<p>How can I parameterize the following query? (By the way I'm using a full text indexed table, hence the <code>CONTAINS()</code>)</p>\n\n<pre><code>SELECT * FROM Table WHERE CONTAINS(Column, 'cat OR dog') \nand ((column NOT LIKE '%[^ cat OR dog]%')); \n</code></pre>\n\n<p>This didn't work:</p>\n\n<pre><code> DECLARE @term1 VARCHAR(10);\n\n DECLARE @term2 VARCHAR(10);\n\n SET @term1 = 'cat';\n\n SET @term2 = 'dog';\n\nSET @term3 = @term1 + ' ' + 'OR' + ' ' + @term2;\n\nSET @term4 = '[^ @term1  OR  @term2 ]' ;\n\nSELECT * FROM table WHERE CONTAINS(column, @term3) &lt;--up to this point works\nAND (column NOT LIKE '%[@term4]%'); &lt;--this part doesn't include the second term (@term2)\n</code></pre>\n\n<p>If you'd like to fiddle with this on your end, my Full Text Indexed table looks like:</p>\n\n<pre><code> animalListID     AnimalsList\n       1           cat dog\n       2           cat\n       3           cat dog bird\n</code></pre>\n\n<p>(basically i need the parameterized version of the <code>SELECT</code> statement which returns the rows with 'cat dog' and 'cat' and NOT 'cat dog bird')</p>\n\n<p>**This is a VERY oversimplified version of my data, but the question is an exact match of the concept I'm trying to achieve. The table will have millions of rows, and many terms in each row.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13091620,"title":"How to check another row if value exists?","body":"<p>This is driving me nuts. I have dumped the imdb db using imdbpy. I'm trying to find US movies that have the actor data available by the first letter of the movie.</p>\n\n<p>Below is an example of a query that fetches the movies without acto data. This runs pretty quick:</p>\n\n<pre><code>SELECT DISTINCT title.id,title.title,title.production_year\nFROM  title\n\nINNER JOIN movie_info ON\n(movie_info.movie_id =  title.id\nAND\nmovie_info.info_type_id = 8\nAND\nmovie_info.info =  'USA') \n\nWHERE  title LIKE  'a%'\nAND  title.kind_id =  1\nLIMIT 75\n</code></pre>\n\n<p>The cast data is stored in a separate table called <code>cast_info</code> and contains about 22 million records. The <code>nr_order</code> column contains the order of credits for actors in a movie. For example, Tom Hank would be 1 in Forrest Gump. There are typically dozens of rows for each <code>movie_id</code>. </p>\n\n<p>So to check to see if the actor data is available, there should be at least one row that isn't null for that particular <code>movie_id</code>. If all the values in <code>nr_order</code> for a <code>movie_id</code> are null, it does NOT contain the data I need.</p>\n\n<p>To attempt to grab this information is used the query below:</p>\n\n<pre><code>SELECT DISTINCT title.id,title.title,title.production_year\nFROM  title\n\nINNER JOIN movie_info ON\n(movie_info.movie_id =  title.id\nAND\nmovie_info.info_type_id = 8\nAND\nmovie_info.info =  'USA') \n\nINNER JOIN cast_info ON \n(cast_info.movie_id = title.id\nAND\ncast_info.nr_order = 1)\n\nWHERE  title LIKE  'a%'\nAND  title.kind_id =  1\nLIMIT 75\n</code></pre>\n\n<p>For some reason the query becomes very slow. It takes .3-.7 for the first query and about 6-10 seconds for the second. I added an index on <code>cast_info</code>.<code>nr_order</code> but it didn't help.</p>\n\n<p>The EXPLAIN output:</p>\n\n<pre><code>+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n| id | select_type | table     | type  | possible_keys                                    | key               | key_len | ref          | rows  | Extra                       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n|  1 | SIMPLE      | title     | range | PRIMARY,title_idx_title,fk_kind_type_id_4        |  title_idx_title  | 257     | NULL         | 132801| Using where; Using temporary|\n|  1 | SIMPLE      | movie_info| ref   | ovie_info_idx_mid,info_type_id movie_info_idx_mid| movie_info_idx_mid| 4       | imdb.title.id| 4     | Using where; Distinct       |\n|  1 | SIMPLE      | table1    | ref   | cast_info_idx_mid,nr_order                       | cast_info_idx_mid | 4       | imdb.title.id| 12    | Using where; Distinct       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n</code></pre>\n\n<p>Any ideas would be very helpful!</p>\n\n<p>EDIT: EXPLAIN from 1st query</p>\n\n<pre><code>+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n| id | select_type | table     | type  | possible_keys                                    | key               | key_len | ref          | rows  | Extra                       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n|  1 | SIMPLE      | title     | range | PRIMARY,title_idx_title,fk_kind_type_id_4        |  title_idx_title  | 257     | NULL         | 132801| Using where; Using temporary|\n|  1 | SIMPLE      | movie_info| ref   | ovie_info_idx_mid,info_type_id movie_info_idx_mid| movie_info_idx_mid| 4       | imdb.title.id| 4     | Using where; Distinct       |\n+----+-------------+-----------+-------+--------------------------------------------------+-------------------+---------+--------------+-------+-----------------------------+\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13090690,"title":"MS SQL REPLACE not showing results","body":"<p>Hey all i have the following query:</p>\n\n<pre><code>SELECT REPLACE(REPLACE(REPLACE(REPLACE(tmpTable.Caller_Number,'-',''),'(',''),')',''),' ','') \nFROM tmpTable \nWHERE EXISTS \n(SELECT REPLACE(REPLACE(REPLACE(REPLACE(OnlineAppDetails.addPhone,'-',''),'(',''),')',''),' ','') \nFROM OnlineAppDetails \nWHERE OnlineAppDetails.addPhone = tmpTable.Caller_Number)\nORDER BY GroupsBy ASC;\n</code></pre>\n\n<p>It returns no records... However, when i do this query:</p>\n\n<pre><code>SELECT * \nFROM tmpTable \nWHERE EXISTS \n(SELECT * FROM OnlineAppDetails \nWHERE SUBSTRING(OnlineAppDetails.addPhone,2,3)+'-'+SUBSTRING(OnlineAppDetails.addPhone,7,4)+SUBSTRING(OnlineAppDetails.addPhone,11,4) = tmpTable.Caller_Number)\nORDER BY GroupsBy ASC;\n</code></pre>\n\n<p>It returns records..</p>\n\n<p>The phome number is formatted like:</p>\n\n<pre><code>for OnlineAppDetails: (xxx) xxx-xxxx\nfor         tmpTable: xxx-xxx-xxxx\n</code></pre>\n\n<p>All i am doing is taking out the <strong>- ( ) and [space]</strong> in the phone number just to be sure i am being returned all the records i should be. I know there are matches in both tables so taking out <strong>- ( ) and [space]</strong> should still result in records returned.</p>\n\n<p><strong>update</strong></p>\n\n<p>Duh.... knew it was going to be simple.</p>\n\n<pre><code>SELECT * \nFROM tmpTable \nWHERE EXISTS \n(SELECT * \nFROM OnlineAppDetails \nWHERE  REPLACE(REPLACE(REPLACE(REPLACE(OnlineAppDetails.addPhone,'-',''),'(',''),')',''),' ','') = REPLACE(REPLACE(REPLACE(REPLACE(tmpTable.Caller_Number,'-',''),'(',''),')',''),' ',''))\nORDER BY GroupsBy ASC;\n</code></pre>\n"},{"tags":["php","query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13091231,"title":"Mongo: Finding from multiple queries","body":"<p>New to Mongo here. I'm using the PHP lib and trying to work out how I can find in a collection from multiple queries. I could do this by repeating the query with a different query, but I wondered if it can be done in one.</p>\n\n<p>I.e.</p>\n\n<pre><code>$idsToLookFor = array(2124,4241,5553);\n$query = $db-&gt;thisCollection-&gt;find(array('id' =&gt; $idsToLookFor));\n</code></pre>\n\n<p>That's what I'd like to do. However it doesn't work. What I'm trying to do is find a set of results for all the id's at one time.</p>\n\n<p>Possible or just do a findOne on each with a foreach/for?   </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":243,"score":3,"question_id":8372121,"title":"Optimizing a mysql index on an ordered, range query","body":"<p>I'm looking for help with some offensive mysql queries I currently have running against my server. My goal is to show the most expensive ebay items with end time's less than one month ago.</p>\n\n<p>I'm using MySQL 5.1.</p>\n\n<p>My query is as follows ('ebay_items' has ~350,000 rows):</p>\n\n<pre><code>explain SELECT `ebay_items`.* FROM `ebay_items` \nWHERE (endtime &gt; NOW()-INTERVAL 1 MONTH) ORDER BY price desc\\G;\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>*************************** 1. row ***************************\nid: 1\nselect_type: SIMPLE\ntable: ebay_items\ntype: range\npossible_keys: endtime\nkey: endtime\nkey_len: 9\nref: NULL\nrows: 71760\nExtra: Using where; Using filesort\n1 row in set (0.00 sec)\n</code></pre>\n\n<p>This query results in an expensive 'filesort' using 71760 rows. </p>\n\n<pre><code>show indexes on ebay_items;\n</code></pre>\n\n<p>yields (I've only included the index in question, 'endtime'):</p>\n\n<pre><code>*************************** 7. row ***************************\nTable: ebay_items\nNon_unique: 1\nKey_name: endtime\nSeq_in_index: 1\nColumn_name: endtime\nCollation: A\nCardinality: 230697\nSub_part: NULL\nPacked: NULL\nNull: YES\nIndex_type: BTREE\nComment: \n*************************** 8. row ***************************\nTable: ebay_items\nNon_unique: 1\nKey_name: endtime\nSeq_in_index: 2\nColumn_name: price\nCollation: A\nCardinality: 230697\nSub_part: NULL\nPacked: NULL\nNull: YES\nIndex_type: BTREE\nComment: \n</code></pre>\n\n<p>Only the 'endtime' key of the composite endtime index (endtime, price) is being used. As far as I know, MySQL will not make use of a composite index effectively when dealing with a range query in conjunction with an 'order by' clause. </p>\n\n<p>Has anyone found a good workout for this issues? I'd primarily like to solve it at the DB level (either by a smarter use of indexes or schema changes) but I'm open to suggestions. </p>\n\n<p>One way that I could avoid the range query is to have a background task cycling through every X hours and marking an enum type field on ebay_items as '&lt; 1 day old', '&lt; 1 week old', '&lt; 1 month old', etc. I was hoping to solve the problem in a cleaner way.</p>\n\n<p>Is there any way to execute MySQL range query with an order by clause, queries in an efficient manner? </p>\n\n<p>Huge thanks for your help! </p>\n\n<p>Edit: Kohányi Róbert made the good point that I should clarify the exact problem I was having with the query. The query results in the disk I/O being pegged for it's duration. If several of these queries are running simultaneously, processes get backed up and the machine locks up. My assumption is that the filesort is eating the I/O. </p>\n\n<p>I should also mention that the table is using the MyISAM engine. Would it more performant and less I/O intensive to use the InnoDB engine? Thanks again.</p>\n"},{"tags":["query","mongodb","count","aggregate","output"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13087657,"title":"MongoDB aggregate query","body":"<p>In MongoDB I have a collection:</p>\n\n<pre><code>Statistics\n{\n    UserID:  int          //User id\n    Url: string           //Url\n    Clicks: [DateTime]    //A time array    \n}\n</code></pre>\n\n<p>When a user clicks an url add a date of the click date in Clicks array. My question is how can I write an aggregate query such as get a number of clicks that was from [date1] till [date2] and group by UserID? How can I output the, to a file?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":43,"score":4,"question_id":13089284,"title":"How can I select the most recent input for each member?","body":"<p>Assume I have a MySQL table:</p>\n\n<pre>\n╔══════╦═════╦═════════╦═════════╗\n║ time ║ mid ║ field_1 ║ field_2 ║\n╠══════╬═════╬═════════╬═════════╣\n║  100 ║   1 ║      32 ║      54 ║\n║  100 ║   2 ║       0 ║      34 ║\n║  100 ║   3 ║      44 ║      99 ║\n║  200 ║   1 ║       0 ║      45 ║\n║  200 ║   2 ║       0 ║      45 ║\n║  200 ║   3 ║       4 ║      59 ║\n║  200 ║   4 ║      45 ║      45 ║\n╚══════╩═════╩═════════╩═════════╝\n</pre>\n\n<p>time is a UNIX timestamp. mid is the member id. field_1 is supplied by the member. field_2 is filled automatically.</p>\n\n<p>I wish to select the row with the most recent non-zero field_1 for all members. So the query would result in:</p>\n\n<pre>\n╔══════╦═════╦═════════╦═════════╗\n║ time ║ mid ║ field_1 ║ field_2 ║\n╠══════╬═════╬═════════╬═════════╣\n║  100 ║   1 ║      32 ║      54 ║\n║  200 ║   3 ║       4 ║      59 ║\n║  200 ║   4 ║      45 ║      45 ║\n╚══════╩═════╩═════════╩═════════╝\n</pre>\n\n<p>The only solution I came up with does not seem very elegant:</p>\n\n<pre>\nSELECT *\nFROM (\n    SELECT *\n    FROM t1\n    WHERE field_1 > 0\n    ORDER BY time DESC\n) AS a\nGROUP BY mid\n</pre>\n\n<p>Is there a better way?</p>\n"},{"tags":["java","sql","query","ms-access","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13089118,"title":"How can I insert new values into two related tables?","body":"<p>I have a store program in java and a database made in access. I already have 2 tables in my database which are the customers table and the products table.</p>\n\n<p>I want to add an orders table wherein it's primary key is an autonumber and an order_line table to complete this app. I want to have tables like this..</p>\n\n<pre><code>customer(cust_id, name, ....)\norders(order_no, cust_id, date_purchased,...)\norder_line(order_no, product_id, ...)\nproducts(product_id, product_name, price,....)\n</code></pre>\n\n<p>When the customer purchased the products, i could insert new values to the orders table. The thing that is not clear to me is how could i insert also in the order_line table, because the order_no I created in access is of type autonumber.</p>\n\n<p>Would I make a select statement first to get the order_no value to put it to the order_no in order_line's table? Or I need to put this in one query only.</p>\n\n<p>Anyone with experience to this? Any advice is appreciated.</p>\n"},{"tags":["mysql","sql","query","pivot"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13080962,"title":"Row to column with total count","body":"<p>I have MySQL data that looks like this:</p>\n\n<pre><code>+----------------------------------------+\n|Name                | kode      | jum   |\n+----------------------------------------+\n| aman               |kode1      | 2     |\n| aman               |kode2      | 1     |\n| jhon               |kode1      | 4     |\n| amir               |kode2      | 4     |\n+--------------------+-----------+-------+\n</code></pre>\n\n<p>How can I make the table look like this one, using a MySQL query?</p>\n\n<pre><code>Name                 kode1    kode2     count\naman                  2         1        3  \njhon                  4         0        4\namir                  0         4        4\n</code></pre>\n"},{"tags":["query","syntax","hive"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":1877,"score":7,"question_id":5656899,"title":"HIve: writing column headers to local file?","body":"<p>Hive documentation lacking again:</p>\n\n<p>I'd like to write the results of a query to a local file as well as the names of the columns. </p>\n\n<p>Does Hive support this?</p>\n\n<blockquote>\n  <p>Insert overwrite local directory 'tmp/blah.blah' select * from table_name;</p>\n</blockquote>\n\n<p>Also, separate question: Is StackOverflow the best place to get Hive Help? @Nija, has been very helpful, but I don't to keep bothering them...</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13072320,"title":"MySQL subquery returns false data","body":"<p>I'm having an issue with a subquery / union.</p>\n\n<p>Here is what i want: i have a \"backup table\" (it is used for some purposes, not just backup) for orders, which i call dc_all_orders. I have two other tables, wb_orders and wb_printed. An order first gets into wb_orders and then, after a workflow step, it gets into wb_printed.\nwe have seen that some orderitems went missing, which we have in the backup table, but not in the two main order tables. I wanted to count the affected orderItems. I know 100% that the count should be more then 0, but it keeps returning zero. An example for an item which should count in:</p>\n\n<pre><code>mysql&gt; select orderId,productId from dc_all_orders where productId = '22040247153891';\n+---------------------+----------------+\n| orderId             | productId      |\n+---------------------+----------------+\n| 20319833369460309A  | 22040247153891 |\n+---------------------+----------------+\n1 row in set (2.06 sec)\n\n\nmysql&gt; select * from wb_orders where productId = '22040247153891';\nEmpty set (0.00 sec)\n\nmysql&gt; select * from wb_printed where productId = '22040247153891';\nEmpty set (0.00 sec)\n</code></pre>\n\n<p>So this productId should show up. Now: </p>\n\n<pre><code>mysql&gt; select count(*) from (select productId from wb_orders UNION select productId from wb_printed) as x;\n+----------+\n| count(*) |\n+----------+\n|  4295961 |\n+----------+\n1 row in set (2 min 51.80 sec)\n</code></pre>\n\n<p>So you know how much data we have. </p>\n\n<pre><code>mysql&gt; select count(*) from dc_all_orders WHERE productId NOT IN \n    -&gt; (select productId from wb_orders UNION select productId from wb_printed);\n+----------+\n| count(*) |\n+----------+\n|        0 |\n+----------+\n1 row in set (11 min 9.20 sec)\n</code></pre>\n\n<p>I cannot explain it. I tried it with different ways, but every way shows 0. All i can think of is the size of the subquery, but i checked the logs, no error and as you see, results are returned without an error. </p>\n\n<p>Am is missing the obvious? :)</p>\n\n<p>Here is an other way:</p>\n\n<pre><code>mysql&gt; select count(productId) from dc_all_orders WHERE productId NOT IN (select productId from wb_orders) AND  productId NOT IN (select productId from wb_printed);\n+------------------+\n| count(productId) |\n+------------------+\n|                0 |\n+------------------+\n1 row in set (6 min 3.07 sec)\n</code></pre>\n\n<p>Edit: MySQL version: \"Server version: 5.1.65-ius Distributed by The IUS Community Project\" on a CentOS 5.8</p>\n"},{"tags":["asp.net","sql","database","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13086360,"title":"DropDownList value into Linq query where clause","body":"<p>I am facing following problem. I want a search field with a DropDowList next to it, where user can pick an item for which he wants to search. I have to make it with this LINQ code not just a SQL query.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>var Metadata = from m in db.Metadatas\n    join mm in db.Multimedias\n    on m.multimediaID equals mm.multimediaID\n    where (m.   { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue) ||\n           mm.  { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue))\n           &amp;&amp; mm.filetype.ToString().Contains(radiobuttonvalue)\n</code></pre>\n\n<p>I want to put something like: \"Dropdownlist.selectedvalue\" into the area { Here would i have the selected value from the dropdownlist. }</p>\n\n<p>I hope you guys understand my idea and problem.</p>\n"},{"tags":["sql","query","date","sql-order-by"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22468,"score":2,"question_id":1545888,"title":"SQL ORDER BY date problem","body":"<p>Can you please help me in solving this problem. I am trying to order the results of an SQL query by date, but I'm not getting the results I need.</p>\n\n<p>The query I'm using is:</p>\n\n<pre><code>SELECT date FROM tbemp ORDER BY date ASC\n</code></pre>\n\n<p>Results are:</p>\n\n<pre><code>01/02/2009\n03/01/2009\n04/06/2009\n05/03/2009\n06/12/2008\n07/02/2009\n</code></pre>\n\n<p>Results should be:</p>\n\n<pre><code>06/12/2008\n03/01/2009\n01/02/2009\n07/02/2009\n</code></pre>\n\n<p>I need to select the date in the format above. </p>\n\n<p>Your help is much appreciated.</p>\n"},{"tags":["database","algorithm","query","math"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":238,"score":4,"question_id":12327004,"title":"How does the HyperLogLog algorithm work?","body":"<p>I've been learning about different algorithms in my spare time recently, and one that I came across which appears to be very interesting is called the HyperLogLog algorithm - which estimates how many unique items are in a set.</p>\n\n<p>This was particularly interesting to me because it brought me back to my MySQL days when I saw that \"Cardinality\" value (which I always assumed until recently that it was calculated not estimated).</p>\n\n<p>So I know how to write an algorithm in O(n) that will calculate how many unique items are in a set. I wrote this in Javascript</p>\n\n<pre><code>function countUniqueAlgo1(set) {\n    var Table = {};\n    var numUnique = 0;\n    var numDataPoints = set.length;\n    for (var j = 0; j &lt; numDataPoints; j++) {\n        var val = set[j];\n        if (Table[val] != null) {\n            continue;\n        }\n        Table[val] = 1;\n        numUnique++;\n    }\n    return numUnique;\n}\n</code></pre>\n\n<p>But the problem is that my algorithm, while O(n), uses a lot of memory (storing values in <code>Table</code>).</p>\n\n<p>I've been reading this paper about how to count duplicates in a set in O(n) time and using minimal memory.\n<a href=\"http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf\" rel=\"nofollow\">http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf</a></p>\n\n<p>It explains that by hashing and counting bits or something one can estimate within a certain probability (assuming the set is evenly distributed) the number of unique items in a set.</p>\n\n<p>I've read the paper but I can't seem to understand it. Can someone give a more layperson's explanation? I know what hashes are, but I don't understand how they are used in this HyperLogLog algorithm.</p>\n"},{"tags":["sql","query"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1976,"score":4,"question_id":3650689,"title":"SQL - exclude a column from SELECT query","body":"<p>I have 100 columns in a table, i want to list 99 columns except a particular one, how to exclude that columns name?</p>\n"},{"tags":["mysql","query","cakephp-1.3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13083543,"title":"CakePHP multiple nested query","body":"<p>I want my query as:</p>\n\n<pre><code>$conditions = array(\n                        'ManageTrackby.trackby_num NOT LIKE' =&gt; '%n/a%',\n                        'Balancesheet.subscriber_id' =&gt; $_SESSION['Auth']['User']['subscriber_id'],\n                        'Balancesheet.show_id' =&gt; $this-&gt;Session-&gt;read('openshowid'),\n                        'OR' =&gt; array('Balancesheet.season_id' =&gt; $season_id,  'Balancesheet.season_id is null'),\n                        'OR' =&gt; array('Balancesheet.episode_id'=&gt; $episode_id, 'Balancesheet.episode_id is null')\n                    );\n</code></pre>\n\n<p>which skips last <code>OR</code> option here and giving below result:</p>\n\n<pre><code>Array\n(\n[ManageTrackby.trackby_num NOT LIKE] =&gt; %n/a%\n[Balancesheet.subscriber_id] =&gt; 105\n[Balancesheet.show_id] =&gt; 56\n[OR] =&gt; Array\n    (\n        [Balancesheet.episode_id] =&gt; 86\n        [0] =&gt; Balancesheet.episode_id is null\n    )\n</code></pre>\n\n<p>)</p>\n\n<p>Here, it misses <code>SEASON_ID</code> from the condition, any idea why?</p>\n\n<p>Please guide me !</p>\n"},{"tags":["android","query","calendar","android-contentprovider"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1124,"score":1,"question_id":5735953,"title":"Create an event with attendees eMail on android","body":"<p>I try to create an event and add an email to it.</p>\n\n<p>i cant get it work, the time i get is 1970 and no email apears.</p>\n\n<p>any ideas?</p>\n\n<p>Thanks. </p>\n\n<p>This is the code i use:</p>\n\n<pre><code>    Uri calendars = null;\n   if (Integer.parseInt(Build.VERSION.SDK) == 8 )\n   {\n         calendars = Uri.parse(\"content://com.android.calendar/calendars\");\n   }\n   else\n   {\n          calendars = Uri.parse(\"content://calendar/calendars\");\n   }\n\n   Cursor cursor = context.getContentResolver().query(calendars,                                                                  new String[] { \"_id\", \"displayName\" },                                                    \"selected=1\",                                                   null,                                                   null);\n\n   if (cursor != null &amp;&amp; cursor.moveToFirst()) \n   {\n       String[] calNames = new String[cursor.getCount()];\n   final int[] calIds = new int[cursor.getCount()];\n   for (int i = 0; i &lt; calNames.length; i++) \n   {\n    // retrieve the calendar names and ids               \n    calIds[i] = cursor.getInt(0);\n    calNames[i] = cursor.getString(1);\n    cursor.moveToNext();\n   } \ncursor.close();\n    String name = \"Name1\";\n    String eMail = \"name1@nnn.com\";\n    ContentValues event = new ContentValues();\n\n    int cal_id = calIds[which];\n    event.put(\"calendar_id\", cal_id);\n    event.put(\"title\", \"test title\");\n    event.put(\"eventLocation\", \"test location\");            \n    event.put(\"eventStatus\", 1);\n    event.put(\"visibility\", 0);\n    event.put(\"transparency\", 0);\n    event.put(\"hasAlarm\", 1);\n    event.put(\"hasAttendeeData\", \"1\");\n\n    Calendar c = Calendar.getInstance();\n    c.roll(Calendar.DAY_OF_MONTH, true);\n\n    Date date = c.getTime();\n    Date begine = new Date(date.getYear(), \n            date.getMonth(), \n            date.getDate(), \n            14, 0);         long dtstart = begine.getTime();\n    event.put(\"dtstart\", dtstart);\n\n    Date end = new Date(date.getYear(), \n                date.getMonth(), \n                date.getDate(), \n                15, 0);\n    long dtend = end.getTime();\n\n    event.put(\"dtend\", dtend);\nUri eventsUri = null;\n    if (Integer.parseInt(Build.VERSION.SDK) == 8 )\n    {\n       eventsUri = Uri.parse(\"content://com.android.calendar/events\");\n    }\n    else\n{\n      eventsUri = Uri.parse(\"content://calendar/events\");\n    }\n    Uri url = context.getContentResolver().insert(eventsUri, event);\n    long id = -1;\n\n    if (url != null) \n    {\n         id = Long.parseLong(url.getLastPathSegment());\n        ContentValues values = new ContentValues();\n        values.put(\"event_id\", id);\n        values.put(\"method\", 1); //METHOD_ALERT\n        values.put(\"minutes\", 15); // 15 minutes\n        Uri reminder = Uri.parse(\"content://com.android.calendar/reminders\");\n            context.getContentResolver().insert(reminder, values);\n        if(name.length() &gt; 0 || eMail.length() &gt; 0)\n        {\n            ContentValues attendees = new ContentValues();\n            attendees.put(\"attendeeEmail\", eMail);\n            attendees.put(\"attendeeName\", name);\n            attendees.put(\"attendeeRelationship\", 2);//RELATIONSHIP_ATTENDEE\n            attendees.put(\"attendeeStatus\", 3); //ATTENDEE_STATUS_INVITED       \n            attendees.put(\"attendeeType\", 1); //TYPE_REQUIRED\n            attendees.put(\"event_id\", id);\n\n            Uri attendeesUri = null;\n            if (Integer.parseInt(Build.VERSION.SDK) == 8 )\n            {\n                     attendeesUri = Uri.parse(\"content://com.android.calendar/attendees\");\n            }\n                else\n                {\n                    attendeesUri = Uri.parse(\"content://calendar/attendees\");\n                }\n            context.getContentResolver().insert(attendeesUri, attendees);\n\n            Intent i = new Intent(Intent.ACTION_EDIT); \n\n            i.setType(\"vnd.android.cursor.item/event\");\n            i.setData(url);\n\n            context.startActivity(i);\n        }\n        else\n        {\n            Toast.makeText(context, \"Could not create an event!\", Toast.LENGTH_LONG);               \n        }\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":63,"score":-2,"question_id":13087154,"title":"Find MAX and SUM From Two Tables","body":"<p>I am developing a point of sale system and in need of finding the customer who has the highest amount of purchase.</p>\n\n<p>I have these two tables, the first which holds the customer and transaction number, the second holds the transaction number and the total amount of the transaction. Here is the table</p>\n\n<pre><code>--------------------------\n| Customer | Transaction |\n--------------------------\n| 1000     | 902134      |\n--------------------------\n| 1001     | 798249      |\n--------------------------\n| 1001     | 312523      |\n--------------------------\n| 1002     | 741284      |\n--------------------------\n| 1000     | 122354      |\n-------------------------- \n\n------------------------------\n| Transaction | Total_Amount |\n------------------------------\n| 902134      | 9000.00      |\n------------------------------\n| 798249      | 3000.00      |\n------------------------------\n| 312523      | 5000.00      |\n------------------------------\n| 741284      | 4000.00      |\n------------------------------\n| 122354      | 1000.00      |\n------------------------------\n</code></pre>\n\n<p>I need to get the customer code 1000 which has 10,000.00 worth of transaction. </p>\n\n<p>I am using MySQL and PHP.</p>\n"},{"tags":["mysql","query","magento-1.7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13029709,"title":"Magento: Subtraction and Division on addAttributeToFilter","body":"<p>I'm a newbie with Magento getResourceModel, and I'm trying to add a simple filter to my query, but i can't figure that using getResourceModel.</p>\n\n<p>Original Query:</p>\n\n<pre><code>$collection = Mage::getResourceModel('catalog/product_collection');\nMage::getModel('catalog/layer')-&gt;prepareProductCollection($collection);\n$collection-&gt;addAttributeToFilter('promotion', 1)-&gt;setOrder('price', 'desc');\n</code></pre>\n\n<p>I just want add the where clause:</p>\n\n<pre><code> (`price` - `final_price`) &gt;= (`price` * 0.4) \n</code></pre>\n\n<p>Someone can help me to do this?</p>\n\n<p>This is all, thanks!</p>\n"},{"tags":["mysql","query","join","if-statement","count"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":2616,"score":0,"question_id":9798937,"title":"Count with if condition in mysql query","body":"<p>I have two tables one is for news and other one is for comments and i want to get the count for the comments whose status has been set as approved.</p>\n\n<pre><code>SELECT ccc_news . * , \ncount(if(ccc_news_comments.id = 'approved', ccc_news_comments.id, 0)) AS comments\nFROM ccc_news\nLEFT JOIN ccc_news_comments ON ccc_news_comments.news_id = ccc_news.news_id\nWHERE `ccc_news`.`category` = 'news_layer2'\nAND `ccc_news`.`status` = 'Active'\nGROUP BY ccc_news.news_id\nORDER BY ccc_news.set_order ASC\nLIMIT 20 \n</code></pre>\n\n<p>But the problem with this query is that minimum value that is fetched for the comments column is 1 whether there is any comment existent corresponding to that news or not.</p>\n\n<p>Any help would be highly appreciable.</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":274,"score":-1,"question_id":6571701,"title":"SQL Query Help obtaining last order date from 2 tables","body":"<p>I have the following table</p>\n\n<pre><code>Orders_All\nAccount\n</code></pre>\n\n<p>Orders all contains every order line many thousand records and the 2 records are <code>order_date</code> and <code>order_account_id</code>.</p>\n\n<p>This need to join into the Account so other queries can be run as well but I want a report that shows the account_id and the last order date but only one record per account.</p>\n\n<p>How can I create a query to acgieve this.</p>\n"},{"tags":["query","alfresco","cmis","workbench"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12980624,"title":"Cant execute simple query to Alfresco with CMIS WORKBENCH","body":"<p>I am trying to execute this simple query to Alfresco with CMIS WORKBENCH and I am getting some errors:</p>\n\n<pre><code>SELECT * FROM cmis:document\n</code></pre>\n\n<p>When I check the log, there is a lot of exceptions. These are (to me) the relevants:</p>\n\n<blockquote>\n  <p>The Web Script /alfresco/service/cmis/queries has responded with a status of 500 - Internal Error.</p>\n  \n  <p>Message:   09180065 Wrapped Exception (with status template): 09185424 Failed to execute script 'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js': 09185423</p>\n  \n  <p>Exception:    java.security.cert.CertificateExpiredException - NotAfter:\n  Fri Aug 17 07:34:11 VET 2012\n  Exception:    java.security.cert.CertPathValidatorException - timestamp\n  check failed\n  Exception:    org.alfresco.repo.search.impl.lucene.LuceneQueryParserException\n  - 09185423 Exception: org.alfresco.scripts.ScriptException - 09185424 Failed to execute script\n  'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js':\n  Exception:    org.springframework.extensions.webscripts.WebScriptException\n  - 09180065 Wrapped Exception (with status template): 09185424 Failed to execute script\n  'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js':\n  09185423</p>\n</blockquote>\n\n<p>Does anybody knows what this exceptions means? Thanks for any help!</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12927356,"title":"Microsoft Access - Enter Parameter Value why?","body":"<p>I am encountering a problem for my database.</p>\n\n<p>And tried to do the query for how many transactions have movie \"Harry_Potter\"?</p>\n\n<p>so I used SQL query:</p>\n\n<pre><code>SELECT\nCOUNT(td.movie) AS number_of_occurrence,\ntd.transaction_number\nFROM\nTransactionDetails td,\nMovieDetails md\nWHERE\nmd.movie = Harry_Potter\n</code></pre>\n\n<p>But it asks for Harry_Potter enter parameter value why?\nThe relevant SQL statements are</p>\n\n<pre><code>CREATE TABLE TransactionDetails \n(\ntransaction_number INTEGER PRIMARY KEY,\nmovie VARCHAR(30) NOT NULL,\ndate_of_transaction DATE NOT NULL,\nmember_number INTEGER NOT NULL\n)\n\nCREATE TABLE MovieDetails\n(\nmovie VARCHAR(30) PRIMARY KEY,\nmovie_type VARCHAR(3) NOT NULL,\nmovie_genre VARCHAR(10) NOT NULL\n)\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT member_number_fk FOREIGN KEY (member_number) REFERENCES    LimelightMemberDetails(member_number);\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT transaction_number_drink_fk FOREIGN KEY (transaction_number) REFERENCES DrinkTransactionDetails(transaction_number);\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT transaction_number_food_fk FOREIGN KEY (transaction_number) REFERENCES FoodTransactionDetails(transaction_number);\n\nALTER TABLE TransactionDetails\nADD CONSTRAINT movie_fk FOREIGN KEY (movie) REFERENCES MovieDetails (movie);\n</code></pre>\n\n<p>Thank you for your help! If there is anything wrong with my database design please let me know! thank you!</p>\n"},{"tags":["query","fields","ms-access-2010"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":213,"score":0,"question_id":11527438,"title":"Access 2010 form not displaying query","body":"<p>I'm sure this is an easy fix but I can't seem to find it. I just have a form, that will be a subform of another, that needs to display the results of a query.</p>\n\n<p>The query is simple enough, just displays all fields of records that fall between specified dates. The query works great, but when I attach it to the form as its record source it doesn't display the data. I can see the correct amount of record selectors so I know its understanding the query but its as if all fields are hidden!  </p>\n\n<p>I have also tried building a query to the forms record source that was simply  Select query.* From query. Oddly I have had this working before but I had to specify every field. What I mean is:  </p>\n\n<p>Select title From query<br>\nSelect type From query<br>\nSelect date From query\n...  </p>\n\n<p>And so on for all the fields but this seems foolish, can anyone think of what I may be doing wrong?<br>\nThanks in advance!</p>\n\n<p><strong>Edit, forgot to mention I also tried the foolish solution that I mentioned above and it didn't work so its definitely some issue that I'm not seeing, some property that's probably not appropriately set</strong>    </p>\n\n<p>@sshekhar well its not really code at the moment I'm using Access 2010. I have a form that needs to display a subform that executes this query of displaying records that have a data field that fall between dates specified by  the user. The query works and displays the correct records, but the form that it is attached to only shows the record selectors and all the fields appear to be \"hidden.\" I thought it may be one of the form's properties set incorrectly but I checked on the test form from another database that I used and each have what appears to be identical settings. So I'm at a loss!</p>\n"},{"tags":["sql","query","cakephp-2.1","avg"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13085657,"title":"Avg Method for inner association in a query","body":"<p>I am using cakephp 2.1 and I wanna find out movie avg critic rating.\nI have written query as follows.</p>\n\n<pre><code>$latest_movies = $this-&gt;Movie-&gt;find('all', array(\n        'contain' =&gt; array('Language', 'CriticReview' =&gt; array('fields' =&gt; array('AVG(CriticReview.rating) AS avg_rating'))),\n        'limit' =&gt; 3,\n        'conditions' =&gt; array('Movie.release &lt;=' =&gt; date('Y-m-d')),\n        'order' =&gt; 'Movie.release DESC'));\n</code></pre>\n\n<p>The associations are</p>\n\n<pre><code>'Movie' =&gt; hasOne(Language),\n        =&gt; hasMany(CriticReview).\n</code></pre>\n\n<p>The array structure before including fields field in 'CriticReview' as follows</p>\n\n<pre><code>array(\n(int) 0 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '4',\n        'name' =&gt; 'Maattrraan',\n        'release' =&gt; '2012-10-12',\n        'language_id' =&gt; '2',\n        'industry_id' =&gt; '3'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'tamil'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'id' =&gt; '2',,\n            'rating' =&gt; '4',\n            'movie_id' =&gt; '4',\n        ),\n        (int) 1 =&gt; array(\n            'id' =&gt; '4',\n            'rating' =&gt; '4',\n            'movie_id' =&gt; '4',\n        )\n    )\n),\n(int) 1 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'Romeo',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '1',\n        'industry_id' =&gt; '1'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'kannada'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'id' =&gt; '1',\n            'rating' =&gt; '6',\n            'movie_id' =&gt; '1','\n        )\n    )\n),\n(int) 2 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'Eega',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '3',\n        'industry_id' =&gt; '2'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '3',\n        'name' =&gt; 'telugu'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'id' =&gt; '3',\n            'rating' =&gt; '5',\n            'movie_id' =&gt; '2',\n        )\n    )\n)\n</code></pre>\n\n<p>)</p>\n\n<p>The array structure after including fields field in 'CriticReview' as follows.</p>\n\n<pre><code>array(\n(int) 0 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '4',\n        'name' =&gt; 'Maattrraan',\n        'release' =&gt; '2012-10-12',\n        'language_id' =&gt; '2',\n        'industry_id' =&gt; '3'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'tamil'\n    ),\n    'CriticReview' =&gt; array()\n),\n(int) 1 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'Romeo',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '1',\n        'industry_id' =&gt; '1'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'kannada'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'movie_id' =&gt; '1',\n        'CriticReview' =&gt; array(\n             (int) 0 =&gt; array(\n            'id' =&gt; '1',\n            'rating' =&gt; '4.75',\n            'movie_id' =&gt; '1','\n             )\n    )\n        )\n    )\n),\n(int) 2 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'Eega',\n        'release' =&gt; '2012-07-06',\n        'language_id' =&gt; '3',\n        'industry_id' =&gt; '2'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '3',\n        'name' =&gt; 'telugu'\n    ),\n    'CriticReview' =&gt; array()\n)\n</code></pre>\n\n<p>)</p>\n\n<p>I am getting avg critic rating of all movies for movie id 1 but not for perticular movie.\nPlease help me to sort out that avg rating for each movie. The work will be more appreciable.</p>\n"},{"tags":["c#","sql-server","query","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":155,"score":0,"question_id":5648444,"title":"Error While passing long query","body":"<p>I have a query.</p>\n\n<pre><code>DECLARE  @fromDate AS DATETIME = '01/28/2009';\nDECLARE  @ToDate AS DATETIME = '01/28/2011';\nDECLARE  @IsMonthWise AS BIT = 1\nDECLARE  @temp AS TABLE(   userId BIGINT\n                         , Visits INT\n                         , DownLoads INT )\nDECLARE  @tempmonth AS TABLE(   userId BIGINT\n                              , Visits INT\n                              , DownLoads INT\n                              , MonthYear NVARCHAR( 50 ) )\n\nIF @IsMonthWise = 0\nBEGIN\n    INSERT INTO @temp(   UserId\n                       , Visits\n                       , DownLoads )\n    SELECT  Main.user_id             AS UserId\n          , COUNT( Main.user_id )    AS Visits\n          , ( SELECT  COUNT( user_id )\n              FROM  content_hits_tbl AS Sub\n              WHERE  content_id &lt;&gt; 0 AND\n                     Main.user_id = Sub.user_id AND\n                     visit_type = 2 AND\n                     CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n              GROUP BY  USER_ID )\n    FROM  content_hits_tbl AS Main\n    INNER JOIN users\n    ON  Main.user_id = users.user_id\n    WHERE  content_id = 0 AND\n           visit_type = 1 AND\n           users.user_deleted = 0 AND\n           CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n    GROUP BY  Main.user_id\n\n    SELECT  Users.last_name + ',' + Users.first_name AS User_Name\n          , REPLACE( REPLACE( REPLACE( REPLACE( region.value_string, '1', 'APR' ), '2', 'LAR' ), '3', 'EAMER' ), '4', 'US&amp;C' ) AS User_Region\n          , CASE\n                WHEN Users.membership_user = 0 THEN 'Internal'\n                ELSE 'External'\n            END AS User_Type\n          , Visits                   AS No_of_Visits\n          , ISNULL( DownLoads, 0 )   AS No_of_DownLoads\n          , Users.user_id            AS UserId\n          , ( SELECT  userData.value_string\n              FROM  dynamic_data_tbl AS userData\n              WHERE  userData.object_id = user_id AND\n                     definition_id = 2147483649 ) AS [Organizational Group]\n    FROM  users AS Users\n    INNER JOIN @temp AS temp\n    ON  temp.UserId = Users.user_id\n    INNER JOIN dynamic_data_tbl AS region\n    ON  region.object_id = Users.user_id\n    WHERE  region.definition_id = 43\n    ORDER BY  No_of_Visits DESC\nEND\nELSE\nBEGIN\n    INSERT INTO @tempmonth(   UserId\n                            , Visits\n                            , DownLoads\n                            , MonthYear )\n    SELECT  Main.user_id             AS UserId\n          , COUNT( Main.user_id )    AS Visits\n          , ( SELECT  COUNT( user_id )\n              FROM  content_hits_tbl AS Sub\n              WHERE  content_id &lt;&gt; 0 AND\n                     Main.user_id = Sub.user_id AND\n                     DATENAME( mm, Main.hit_date ) + '-' + DATENAME( yyyy, Main.hit_date ) = DATENAME( mm, Sub.hit_date ) + '-' + DATENAME( yyyy, Sub.hit_date ) AND\n                     visit_type = 2 AND\n                     CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n              GROUP BY  USER_ID\n                      , DATENAME( mm, hit_date ) + '-' + DATENAME( yyyy, hit_date ) )\n          , DATENAME( mm, hit_date ) + '-' + DATENAME( yyyy, hit_date ) AS MonthYear\n    FROM  content_hits_tbl AS Main\n    INNER JOIN users\n    ON  Main.user_id = users.user_id\n    WHERE  content_id = 0 AND\n           visit_type = 1 AND\n           users.user_deleted = 0 AND\n           CAST( CONVERT( VARCHAR, hit_date, 101 ) AS DATETIME ) BETWEEN CAST( CONVERT( VARCHAR, @fromDate, 101 ) AS DATETIME ) AND CAST( CONVERT( VARCHAR, @ToDate, 101 ) AS DATETIME )\n    GROUP BY  Main.user_id\n            , DATENAME( mm, hit_date ) + '-' + DATENAME( yyyy, hit_date )\n\n    SELECT  Users.last_name + ',' + Users.first_name AS User_Name\n          , REPLACE( REPLACE( REPLACE( REPLACE( region.value_string, '1', 'APR' ), '2', 'LAR' ), '3', 'EAMER' ), '4', 'US&amp;C' ) AS User_Region\n          , CASE\n                WHEN Users.membership_user = 0 THEN 'Internal'\n                ELSE 'External'\n            END AS User_Type\n          , Visits                   AS No_of_Visits\n          , ISNULL( DownLoads, 0 )   AS No_of_DownLoads\n          , Users.user_id            AS UserId\n          , temp.MonthYear           AS MonthYear\n          , ( SELECT  userData.value_string\n              FROM  dynamic_data_tbl AS userData\n              WHERE  userData.object_id = user_id AND\n                     definition_id = 2147483649 ) AS [Organizational Group]\n    FROM  users AS Users\n    INNER JOIN @tempmonth AS temp\n    ON  temp.UserId = Users.user_id\n    INNER JOIN dynamic_data_tbl AS region\n    ON  region.object_id = Users.user_id\n    WHERE  region.definition_id = 43\n    ORDER BY  User_Name ASC\n            , MonthYear DESC\nEND\n\nDELETE FROM @temp\n\nDELETE FROM @tempmonth\n</code></pre>\n\n<p>IT Works fine if in run in SQL server. But if i pass the same as string from C# code(ExecuteReader).It is Not executing.</p>\n\n<p>If i copy the query from code behind and paste in sql server it is coming in single row.I think it is the reason why my query is not executing.</p>\n\n<p>Please let me know the way how to pass execute long query from my Application (C#)</p>\n\n<p>Thanks</p>\n"}]}
{"total":20739,"page":7,"pagesize":100,"questions":[{"tags":["mysql","sql","query","select","information-schema"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":611,"score":1,"question_id":5265684,"title":"Select tables that do not contain a certain column in MySQL","body":"<p>I am trying to select all tables that do not have column named 'unique'. I can select all tables that have it using:</p>\n\n<pre><code>SELECT DISTINCT TABLE_NAME \nFROM INFORMATION_SCHEMA.COLUMNS\nWHERE COLUMN_NAME = 'unique'\nAND TABLE_SCHEMA ='database';\n</code></pre>\n\n<p>Is there a simple way to modify the SELECT statement so it lists all tables that do not have that column? This seems like it would be simple, but I can't figure it out, and can't find an answer on the forum.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","xml","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13065532,"title":"LINQ XML- Read XML data","body":"<p>I am having trouble with LINQ query for XML and can't solve</p>\n\n<p>I am trying to extract the  element values</p>\n\n<p>Here is the XML</p>\n\n<pre><code>&lt;response&gt;\n  &lt;make&gt;DODGE&lt;/make&gt;\n  &lt;make&gt;CHRYSLER&lt;/make&gt;\n  &lt;make&gt;JEEP&lt;/make&gt;\n  &lt;make&gt;RAM&lt;/make&gt;\n  .......etc\n&lt;/response&gt;\n</code></pre>\n\n<p>Here is the code I have so far...</p>\n\n<pre><code>        XElement parsedXml3 = XElement.Parse(xml3);\n        var query2 = from m in parsedXml3.Descendants(\"response\")\n                     select m.Elements(\"make\").Select(e =&gt; e.Value);\n        List&lt;string&gt; ls = new List&lt;string&gt;();\n        foreach (var o in query2)\n        {\n            ls = o.ToList();\n        }\n        ls.Sort();\n</code></pre>\n\n<p>Thanks for your help - extended explanations would be great </p>\n"},{"tags":["performance","query","tsql","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":12854990,"title":"Why would ISNULL improve the performance of a query?","body":"<p>We're currently trying to speedup some queries and we've run into something which I (not a DBA just a .NET developer) cannot explain or comprehent. We're running this query on SQL Server 2005.</p>\n\n<p>We have the following query (made small and simple for the sake of argument);</p>\n\n<pre><code>SELECT    \n    *\nFROM    \n    RandomTable \nWHERE   \n    MoneyColumn &lt;&gt; 0\nGROUP BY\n    SomeColumn\n</code></pre>\n\n<p>This query run in around <strong>three</strong> seconds, then we randomly tried to following to speed it up (shot in the dark really)</p>\n\n<pre><code>SELECT    \n    *\nFROM    \n    RandomTable \nWHERE   \n    isnull(MoneyColumn,0) &lt;&gt; 0\nGROUP BY\n    SomeColumn\n</code></pre>\n\n<p>This reduces the query speed to around <strong>one</strong> second..</p>\n\n<p>This column has no NULL values (yet due to the database design beeing HORRIBLE) it is however NULLABLE...</p>\n\n<p>Is the fact that it's NULLABLE making SQL Server do something to account for this making it slow where the ISNULL isn't beeing mentioned? I simply have no idea why the ISNULL would make it perform faster (and by such a big margin). I'd think SQL would actually have more to do when there is a ISNULL statement in the query.</p>\n\n<p>Can anyone shed some light on this?</p>\n\n<p><strong>EDIT</strong> Execution plans added</p>\n\n<p><strong>With ISNULL</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;ShowPlanXML xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" Version=\"1.0\" Build=\"9.00.5000.00\" xmlns=\"http://schemas.microsoft.com/sqlserver/2004/07/showplan\"&gt;\n  &lt;BatchSequence&gt;\n    &lt;Batch&gt;\n      &lt;Statements&gt;\n        &lt;StmtSimple StatementCompId=\"1\" StatementEstRows=\"9019.76\" StatementId=\"1\" StatementOptmLevel=\"FULL\" StatementSubTreeCost=\"1.48105\" StatementText=\"SELECT    debiteur_id, MIN(Faktuurdatum) AS OldestOpenInvoiceDate, ISNULL(SUM(Totaal_Open),0) AS TotalOpenAmount&amp;#xD;&amp;#xA;FROM    dbo.tbl_Faktuur &amp;#xD;&amp;#xA;WHERE   (Afgehandeld_NeeJa = 0 OR Afgehandeld_NeeJa IS NULL)&amp;#xD;&amp;#xA;AND        (ISNULL(Totaal_Open,0) &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;--AND        (Totaal_Open &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;GROUP BY debiteur_id\" StatementType=\"SELECT\"&gt;\n          &lt;StatementSetOptions ANSI_NULLS=\"false\" ANSI_PADDING=\"false\" ANSI_WARNINGS=\"false\" ARITHABORT=\"true\" CONCAT_NULL_YIELDS_NULL=\"false\" NUMERIC_ROUNDABORT=\"false\" QUOTED_IDENTIFIER=\"false\" /&gt;\n          &lt;QueryPlan DegreeOfParallelism=\"1\" MemoryGrant=\"1520\" CachedPlanSize=\"54\" CompileTime=\"11\" CompileCPU=\"11\" CompileMemory=\"704\"&gt;\n            &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.000901976\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"9019.76\" LogicalOp=\"Compute Scalar\" NodeId=\"0\" Parallel=\"false\" PhysicalOp=\"Compute Scalar\" EstimatedTotalSubtreeCost=\"1.48105\"&gt;\n              &lt;OutputList&gt;\n                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                &lt;ColumnReference Column=\"Expr1005\" /&gt;\n              &lt;/OutputList&gt;\n              &lt;ComputeScalar&gt;\n                &lt;DefinedValues&gt;\n                  &lt;DefinedValue&gt;\n                    &lt;ColumnReference Column=\"Expr1005\" /&gt;\n                    &lt;ScalarOperator ScalarString=\"isnull([Expr1004],($0.0000))\"&gt;\n                      &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Identifier&gt;\n                            &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                          &lt;/Identifier&gt;\n                        &lt;/ScalarOperator&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/Intrinsic&gt;\n                    &lt;/ScalarOperator&gt;\n                  &lt;/DefinedValue&gt;\n                &lt;/DefinedValues&gt;\n                &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.291662\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"9019.76\" LogicalOp=\"Compute Scalar\" NodeId=\"1\" Parallel=\"false\" PhysicalOp=\"Compute Scalar\" EstimatedTotalSubtreeCost=\"1.48014\"&gt;\n                  &lt;OutputList&gt;\n                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                  &lt;/OutputList&gt;\n                  &lt;ComputeScalar&gt;\n                    &lt;DefinedValues&gt;\n                      &lt;DefinedValue&gt;\n                        &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                        &lt;ScalarOperator ScalarString=\"CASE WHEN [Expr1013]=(0) THEN NULL ELSE [Expr1014] END\"&gt;\n                          &lt;IF&gt;\n                            &lt;Condition&gt;\n                              &lt;ScalarOperator&gt;\n                                &lt;Compare CompareOp=\"EQ\"&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Identifier&gt;\n                                      &lt;ColumnReference Column=\"Expr1013\" /&gt;\n                                    &lt;/Identifier&gt;\n                                  &lt;/ScalarOperator&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Const ConstValue=\"(0)\" /&gt;\n                                  &lt;/ScalarOperator&gt;\n                                &lt;/Compare&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Condition&gt;\n                            &lt;Then&gt;\n                              &lt;ScalarOperator&gt;\n                                &lt;Const ConstValue=\"NULL\" /&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Then&gt;\n                            &lt;Else&gt;\n                              &lt;ScalarOperator&gt;\n                                &lt;Identifier&gt;\n                                  &lt;ColumnReference Column=\"Expr1014\" /&gt;\n                                &lt;/Identifier&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Else&gt;\n                          &lt;/IF&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/DefinedValue&gt;\n                    &lt;/DefinedValues&gt;\n                    &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.291662\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"9019.76\" LogicalOp=\"Aggregate\" NodeId=\"2\" Parallel=\"false\" PhysicalOp=\"Hash Match\" EstimatedTotalSubtreeCost=\"1.48014\"&gt;\n                      &lt;OutputList&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                        &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                        &lt;ColumnReference Column=\"Expr1013\" /&gt;\n                        &lt;ColumnReference Column=\"Expr1014\" /&gt;\n                      &lt;/OutputList&gt;\n                      &lt;MemoryFractions Input=\"1\" Output=\"1\" /&gt;\n                      &lt;RunTimeInformation&gt;\n                        &lt;RunTimeCountersPerThread Thread=\"0\" ActualRows=\"156794\" ActualEndOfScans=\"1\" ActualExecutions=\"1\" /&gt;\n                      &lt;/RunTimeInformation&gt;\n                      &lt;Hash&gt;\n                        &lt;DefinedValues&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                            &lt;ScalarOperator ScalarString=\"MIN([directpay].[dbo].[tbl_Faktuur].[Faktuurdatum])\"&gt;\n                              &lt;Aggregate AggType=\"MIN\" Distinct=\"false\"&gt;\n                                &lt;ScalarOperator&gt;\n                                  &lt;Identifier&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                                  &lt;/Identifier&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/Aggregate&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Column=\"Expr1013\" /&gt;\n                            &lt;ScalarOperator ScalarString=\"COUNT_BIG([directpay].[dbo].[tbl_Faktuur].[Totaal_Open])\"&gt;\n                              &lt;Aggregate AggType=\"COUNT_BIG\" Distinct=\"false\"&gt;\n                                &lt;ScalarOperator&gt;\n                                  &lt;Identifier&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                  &lt;/Identifier&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/Aggregate&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Column=\"Expr1014\" /&gt;\n                            &lt;ScalarOperator ScalarString=\"SUM([directpay].[dbo].[tbl_Faktuur].[Totaal_Open])\"&gt;\n                              &lt;Aggregate AggType=\"SUM\" Distinct=\"false\"&gt;\n                                &lt;ScalarOperator&gt;\n                                  &lt;Identifier&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                  &lt;/Identifier&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/Aggregate&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/DefinedValue&gt;\n                        &lt;/DefinedValues&gt;\n                        &lt;HashKeysBuild&gt;\n                          &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                        &lt;/HashKeysBuild&gt;\n                        &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.255\" EstimateIO=\"0.634196\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"27420\" LogicalOp=\"Index Seek\" NodeId=\"4\" Parallel=\"false\" PhysicalOp=\"Index Seek\" EstimatedTotalSubtreeCost=\"0.889196\"&gt;\n                          &lt;OutputList&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                          &lt;/OutputList&gt;\n                          &lt;RunTimeInformation&gt;\n                            &lt;RunTimeCountersPerThread Thread=\"0\" ActualRows=\"298726\" ActualEndOfScans=\"1\" ActualExecutions=\"1\" /&gt;\n                          &lt;/RunTimeInformation&gt;\n                          &lt;IndexScan Ordered=\"true\" ScanDirection=\"FORWARD\" ForcedIndex=\"false\" NoExpandHint=\"false\"&gt;\n                            &lt;DefinedValues&gt;\n                              &lt;DefinedValue&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                              &lt;/DefinedValue&gt;\n                              &lt;DefinedValue&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                              &lt;/DefinedValue&gt;\n                              &lt;DefinedValue&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/DefinedValue&gt;\n                            &lt;/DefinedValues&gt;\n                            &lt;Object Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Index=\"[_dta_index_tbl_Faktuur_5_583009158__K13_K9_K19_K2_5]\" /&gt;\n                            &lt;SeekPredicates&gt;\n                              &lt;SeekPredicate&gt;\n                                &lt;Prefix ScanType=\"EQ\"&gt;\n                                  &lt;RangeColumns&gt;\n                                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Afgehandeld_NeeJa\" /&gt;\n                                  &lt;/RangeColumns&gt;\n                                  &lt;RangeExpressions&gt;\n                                    &lt;ScalarOperator ScalarString=\"(0)\"&gt;\n                                      &lt;Const ConstValue=\"(0)\" /&gt;\n                                    &lt;/ScalarOperator&gt;\n                                  &lt;/RangeExpressions&gt;\n                                &lt;/Prefix&gt;\n                              &lt;/SeekPredicate&gt;\n                            &lt;/SeekPredicates&gt;\n                            &lt;Predicate&gt;\n                              &lt;ScalarOperator ScalarString=\"isnull([directpay].[dbo].[tbl_Faktuur].[Totaal_Open],($0.0000))&amp;lt;($0.0000) OR isnull([directpay].[dbo].[tbl_Faktuur].[Totaal_Open],($0.0000))&amp;gt;($0.0000)\"&gt;\n                                &lt;Logical Operation=\"OR\"&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Compare CompareOp=\"LT\"&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Identifier&gt;\n                                              &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                            &lt;/Identifier&gt;\n                                          &lt;/ScalarOperator&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                          &lt;/ScalarOperator&gt;\n                                        &lt;/Intrinsic&gt;\n                                      &lt;/ScalarOperator&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                      &lt;/ScalarOperator&gt;\n                                    &lt;/Compare&gt;\n                                  &lt;/ScalarOperator&gt;\n                                  &lt;ScalarOperator&gt;\n                                    &lt;Compare CompareOp=\"GT\"&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Identifier&gt;\n                                              &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                                            &lt;/Identifier&gt;\n                                          &lt;/ScalarOperator&gt;\n                                          &lt;ScalarOperator&gt;\n                                            &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                          &lt;/ScalarOperator&gt;\n                                        &lt;/Intrinsic&gt;\n                                      &lt;/ScalarOperator&gt;\n                                      &lt;ScalarOperator&gt;\n                                        &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                      &lt;/ScalarOperator&gt;\n                                    &lt;/Compare&gt;\n                                  &lt;/ScalarOperator&gt;\n                                &lt;/Logical&gt;\n                              &lt;/ScalarOperator&gt;\n                            &lt;/Predicate&gt;\n                          &lt;/IndexScan&gt;\n                        &lt;/RelOp&gt;\n                      &lt;/Hash&gt;\n                    &lt;/RelOp&gt;\n                  &lt;/ComputeScalar&gt;\n                &lt;/RelOp&gt;\n              &lt;/ComputeScalar&gt;\n            &lt;/RelOp&gt;\n          &lt;/QueryPlan&gt;\n        &lt;/StmtSimple&gt;\n      &lt;/Statements&gt;\n    &lt;/Batch&gt;\n  &lt;/BatchSequence&gt;\n&lt;/ShowPlanXML&gt;\n</code></pre>\n\n<p><strong>Without ISNULL</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;ShowPlanXML xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" Version=\"1.0\" Build=\"9.00.5000.00\" xmlns=\"http://schemas.microsoft.com/sqlserver/2004/07/showplan\"&gt;\n  &lt;BatchSequence&gt;\n    &lt;Batch&gt;\n      &lt;Statements&gt;\n        &lt;StmtSimple StatementCompId=\"1\" StatementEstRows=\"1322.43\" StatementId=\"1\" StatementOptmLevel=\"FULL\" StatementOptmEarlyAbortReason=\"GoodEnoughPlanFound\" StatementSubTreeCost=\"0.274954\" StatementText=\"SELECT    debiteur_id, MIN(Faktuurdatum) AS OldestOpenInvoiceDate, ISNULL(SUM(Totaal_Open),0) AS TotalOpenAmount&amp;#xD;&amp;#xA;FROM    dbo.tbl_Faktuur &amp;#xD;&amp;#xA;WHERE   (Afgehandeld_NeeJa = 0 OR Afgehandeld_NeeJa IS NULL)&amp;#xD;&amp;#xA;--AND        (ISNULL(Totaal_Open,0) &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;AND        (Totaal_Open &amp;lt;&amp;gt; 0) &amp;#xD;&amp;#xA;GROUP BY debiteur_id\" StatementType=\"SELECT\"&gt;\n          &lt;StatementSetOptions ANSI_NULLS=\"false\" ANSI_PADDING=\"false\" ANSI_WARNINGS=\"false\" ARITHABORT=\"true\" CONCAT_NULL_YIELDS_NULL=\"false\" NUMERIC_ROUNDABORT=\"false\" QUOTED_IDENTIFIER=\"false\" /&gt;\n          &lt;QueryPlan CachedPlanSize=\"47\" CompileTime=\"9\" CompileCPU=\"9\" CompileMemory=\"528\"&gt;\n            &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.000132243\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"1322.43\" LogicalOp=\"Compute Scalar\" NodeId=\"0\" Parallel=\"false\" PhysicalOp=\"Compute Scalar\" EstimatedTotalSubtreeCost=\"0.274954\"&gt;\n              &lt;OutputList&gt;\n                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                &lt;ColumnReference Column=\"Expr1005\" /&gt;\n              &lt;/OutputList&gt;\n              &lt;ComputeScalar&gt;\n                &lt;DefinedValues&gt;\n                  &lt;DefinedValue&gt;\n                    &lt;ColumnReference Column=\"Expr1005\" /&gt;\n                    &lt;ScalarOperator ScalarString=\"isnull([Expr1004],($0.0000))\"&gt;\n                      &lt;Intrinsic FunctionName=\"isnull\"&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Identifier&gt;\n                            &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                          &lt;/Identifier&gt;\n                        &lt;/ScalarOperator&gt;\n                        &lt;ScalarOperator&gt;\n                          &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/Intrinsic&gt;\n                    &lt;/ScalarOperator&gt;\n                  &lt;/DefinedValue&gt;\n                &lt;/DefinedValues&gt;\n                &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.167304\" EstimateIO=\"0\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"1322.43\" LogicalOp=\"Aggregate\" NodeId=\"1\" Parallel=\"false\" PhysicalOp=\"Hash Match\" EstimatedTotalSubtreeCost=\"0.274822\"&gt;\n                  &lt;OutputList&gt;\n                    &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                    &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                  &lt;/OutputList&gt;\n                  &lt;MemoryFractions Input=\"0\" Output=\"0\" /&gt;\n                  &lt;Hash&gt;\n                    &lt;DefinedValues&gt;\n                      &lt;DefinedValue&gt;\n                        &lt;ColumnReference Column=\"Expr1003\" /&gt;\n                        &lt;ScalarOperator ScalarString=\"MIN([directpay].[dbo].[tbl_Faktuur].[Faktuurdatum])\"&gt;\n                          &lt;Aggregate AggType=\"MIN\" Distinct=\"false\"&gt;\n                            &lt;ScalarOperator&gt;\n                              &lt;Identifier&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                              &lt;/Identifier&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/Aggregate&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/DefinedValue&gt;\n                      &lt;DefinedValue&gt;\n                        &lt;ColumnReference Column=\"Expr1004\" /&gt;\n                        &lt;ScalarOperator ScalarString=\"SUM([directpay].[dbo].[tbl_Faktuur].[Totaal_Open])\"&gt;\n                          &lt;Aggregate AggType=\"SUM\" Distinct=\"false\"&gt;\n                            &lt;ScalarOperator&gt;\n                              &lt;Identifier&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/Identifier&gt;\n                            &lt;/ScalarOperator&gt;\n                          &lt;/Aggregate&gt;\n                        &lt;/ScalarOperator&gt;\n                      &lt;/DefinedValue&gt;\n                    &lt;/DefinedValues&gt;\n                    &lt;HashKeysBuild&gt;\n                      &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                    &lt;/HashKeysBuild&gt;\n                    &lt;RelOp AvgRowSize=\"23\" EstimateCPU=\"0.030319\" EstimateIO=\"0.0771991\" EstimateRebinds=\"0\" EstimateRewinds=\"0\" EstimateRows=\"27420\" LogicalOp=\"Index Seek\" NodeId=\"2\" Parallel=\"false\" PhysicalOp=\"Index Seek\" EstimatedTotalSubtreeCost=\"0.107518\"&gt;\n                      &lt;OutputList&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                        &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                      &lt;/OutputList&gt;\n                      &lt;IndexScan Ordered=\"true\" ScanDirection=\"FORWARD\" ForcedIndex=\"false\" NoExpandHint=\"false\"&gt;\n                        &lt;DefinedValues&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Debiteur_ID\" /&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Faktuurdatum\" /&gt;\n                          &lt;/DefinedValue&gt;\n                          &lt;DefinedValue&gt;\n                            &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                          &lt;/DefinedValue&gt;\n                        &lt;/DefinedValues&gt;\n                        &lt;Object Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Index=\"[_dta_index_tbl_Faktuur_5_583009158__K13_K9_K19_K2_5]\" /&gt;\n                        &lt;SeekPredicates&gt;\n                          &lt;SeekPredicate&gt;\n                            &lt;Prefix ScanType=\"EQ\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Afgehandeld_NeeJa\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"(0)\"&gt;\n                                  &lt;Const ConstValue=\"(0)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/Prefix&gt;\n                            &lt;EndRange ScanType=\"LT\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"($0.0000)\"&gt;\n                                  &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/EndRange&gt;\n                          &lt;/SeekPredicate&gt;\n                          &lt;SeekPredicate&gt;\n                            &lt;Prefix ScanType=\"EQ\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Afgehandeld_NeeJa\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"(0)\"&gt;\n                                  &lt;Const ConstValue=\"(0)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/Prefix&gt;\n                            &lt;StartRange ScanType=\"GT\"&gt;\n                              &lt;RangeColumns&gt;\n                                &lt;ColumnReference Database=\"[directpay]\" Schema=\"[dbo]\" Table=\"[tbl_Faktuur]\" Column=\"Totaal_Open\" /&gt;\n                              &lt;/RangeColumns&gt;\n                              &lt;RangeExpressions&gt;\n                                &lt;ScalarOperator ScalarString=\"($0.0000)\"&gt;\n                                  &lt;Const ConstValue=\"($0.0000)\" /&gt;\n                                &lt;/ScalarOperator&gt;\n                              &lt;/RangeExpressions&gt;\n                            &lt;/StartRange&gt;\n                          &lt;/SeekPredicate&gt;\n                        &lt;/SeekPredicates&gt;\n                      &lt;/IndexScan&gt;\n                    &lt;/RelOp&gt;\n                  &lt;/Hash&gt;\n                &lt;/RelOp&gt;\n              &lt;/ComputeScalar&gt;\n            &lt;/RelOp&gt;\n          &lt;/QueryPlan&gt;\n        &lt;/StmtSimple&gt;\n      &lt;/Statements&gt;\n    &lt;/Batch&gt;\n  &lt;/BatchSequence&gt;\n&lt;/ShowPlanXML&gt;\n</code></pre>\n"},{"tags":["mysql","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13082066,"title":"to improve performance on query","body":"<p>I hava nest query:</p>\n\n<pre><code>SELECT PIXEL_X as 'X_Coord', PIXEL_Y as 'Y_Coord', \nCONVERTWATTS2DBM_udf(SUM(L2_VALUE)/SUM(L3_VALUE)) as 'Pixel_Value' \n   FROM table  \n   WHERE  \n      ('GSM 850/900' like CONCAT('%',FILTER2,'/%') OR \n       'GSM 850/900' like CONCAT('%/',FILTER2,'%') ) \nGROUP BY X_Coord, Y_Coord;\n</code></pre>\n\n<p>but takes a long time, could you help me to improve their performance?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","query","merge","duplicates","concatenation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13078062,"title":"Merging records with SQL, with some rules","body":"<p>I have a table with 4 records:</p>\n\n<pre><code>NAME    INSTRUMENT    BOOLEAN 1  BOOLEAN 2\nBob     Organ         TRUE       FALSE\nThomas  Violin        FALSE      FALSE\nBob     Piano         FALSE      TRUE\n</code></pre>\n\n<p>I want to merge records with same \"NAME\", in order to get  :</p>\n\n<pre><code>Bob     Organ Piano   TRUE       TRUE\nThomas  Violin        FALSE      FALSE\n</code></pre>\n\n<p>What's the rule that I want when merging ?</p>\n\n<ul>\n<li><p>\"text fields\" are just concatenated    (example : Organ + Piano ==> \"Organ Piano\")</p></li>\n<li><p>\"boolean fields\" are merged with a LOGICAL OR   (example : TRUE or FALSE = TRUE)</p></li>\n</ul>\n\n<p>My questions :</p>\n\n<p>1) I will choose which software to use in regard to the ability to do this!   Database with SQL queries (SQLite, MySQL or even Access)   or Excel ? </p>\n\n<p>2) If the best solution is a database,   what's the SQL query to do that ?</p>\n\n<p>Thanks a lot in advance!</p>\n"},{"tags":["php","mysql","query","phpmyadmin"],"answer_count":7,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":666,"score":5,"question_id":8536623,"title":"MySQL query works in phpmyadmin but not through php","body":"<p>Any ideas would help, I have been on this for a while now and just can't figure out what is wrong.</p>\n\n<p>Problem: query works fine until I added in the multiple word search which you can see bolded below. However, I echoed the sql query and then pasted in phpmyadmin and it worked perfectly but through the php it results with 0 records. It doesn't make any sense and I can't figure out what could be causing a result of 0.</p>\n\n<pre><code>SELECT \n        DISTINCT c.id \n    FROM \n        carpets AS c \n        INNER JOIN carpet_relations AS r1 ON c.id = r1.carpet_id \n        INNER JOIN carpet_relations AS r2 ON c.id = r2.carpet_id\n        INNER JOIN carpet_relations AS r3 ON c.id = r3.carpet_id\n    WHERE \n        c.active = '1' \n\n\n\n        AND ((c.title LIKE '%north tabriz%') OR **(c.title LIKE '%north%') OR (c.title LIKE '%tabriz%')** OR (c.item_no LIKE '%north tabriz%') OR **(c.item_no LIKE '%north%') OR (c.item_no LIKE '%tabriz%')** OR (c.pattern LIKE '%north tabriz%') OR **(c.pattern LIKE '%north%') OR (c.pattern LIKE '%tabriz%')** OR (c.period LIKE '%north tabriz%') OR **(c.period LIKE '%north%') OR (c.period LIKE '%tabriz%')** OR (c.country LIKE '%north tabriz%') **OR (c.country LIKE '%north%') OR (c.country LIKE '%tabriz%')**)\n\n        AND (c.width_feet BETWEEN '0' AND '22') \n        AND (c.width_inches BETWEEN '0' AND '11') \n        AND (c.height_feet BETWEEN '0' AND '49') \n        AND (c.height_inches BETWEEN '0' AND '11') \n    ORDER BY \n        c.item_no\n\n\nid  int(11) NO  PRI     NULL    auto_increment\nactive  int(11) NO      NULL    \ntitle   varchar(250)    NO      NULL    \nitem_no     varchar(250)    NO      NULL    \ncountry     varchar(250)    NO      NULL    \nperiod  varchar(250)    NO      NULL    \npattern     varchar(250)    NO      NULL    \nprice   float   NO      NULL    \nweb_special     float   NO      NULL    \nnotes   text    NO      NULL    \nwidth_feet  int(11) NO      NULL    \nwidth_inches    int(11) NO      NULL    \nheight_feet     int(11) NO      NULL    \nheight_inches   int(11) NO      NULL    \nrestrict    int(11) NO      NULL    \nviews_amount    int(11) NO      NULL    \nlast_modified   datetime    NO      NULL    \nmodified_by     int(11) NO      NULL\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13064117,"title":"Need help speeding up a MySQL query","body":"<p>I need a query that quickly shows the articles within a particular module (a subset of articles) that a user has NOT uploaded a PDF for. The query I am using below takes about 37 seconds, given there are 300,000 articles in the Article table, and 6,000 articles in the Module.</p>\n\n<pre><code>SELECT * \nFROM article a \nINNER JOIN article_module_map amm ON amm.article=a.id \nWHERE amm.module = 2 AND\n    a.id NOT IN ( \n        SELECT afm.article \n        FROM article_file_map afm \n        INNER JOIN article_module_map amm ON amm.article = afm.article \n        WHERE afm.organization = 4 AND \n            amm.module = 2 \n    ) \n</code></pre>\n\n<p>What I am doing in the above query is first truncating the list of articles to the selected module, and then further truncating that list to the articles that are not in the subquery. The subquery is generating a list of the articles that an organization has already uploaded PDF's for. Hence, the end result is a list of articles that an organization has not yet uploaded PDF's for. </p>\n\n<p>Help would be hugely appreciated, thanks in advance!</p>\n\n<p><strong>EDIT 2012/10/25</strong></p>\n\n<p>With @fthiella's help, the below query ran in an astonishing 1.02 seconds, down from 37+ seconds! </p>\n\n<pre><code>SELECT a.* FROM (\n    SELECT article.* FROM article \n    INNER JOIN article_module_map\n        ON article.id = article_module_map.article\n    WHERE article_module_map.module = 2\n) AS a\nLEFT JOIN article_file_map\n    ON a.id = article_file_map.article\n    AND article_file_map.organization=4\nWHERE article_file_map.id IS NULL\n</code></pre>\n"},{"tags":["php","mysql","query","table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13081132,"title":"Running two MySQL queries at a time in PHP mysql_query()","body":"<p>I need to use SELECT LAST_INSERT_ID() function of MySQL to get the ID of last inserted row .\nWhen I try to run this:-</p>\n\n<pre><code>  mysql_query(\"\n    INSERT INTO `posts`\n           (`user`, `body`, `time`, `pageID`)\n           VALUES('pachykutty', 'testMessage', '2012-10-26 04:59:43', 1);\n    SELECT LAST_INSERT_ID();\");\n</code></pre>\n\n<p>Gives me error. But When I run the two queries seperate like this:-</p>\n\n<pre><code>mysql_query(\"\nINSERT INTO `posts`\n       (`user`, `body`, `time`, `pageID`)\n       VALUES('pachykutty', 'testMessage', '2012-10-26 04:59:43', 1)\");\nmysql_query(\"SELECT LAST_INSERT_ID()\");\n</code></pre>\n\n<p>It is OK. I fear that If two clients ran the query same time, their LAST_INSERT_ID will conflict. So I want to run the two queries together without delay. Is there any Way?</p>\n"},{"tags":["query","search"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13080586,"title":"Search/Report Queries in Visual Studio (ASP.net Site)","body":"<p>My asp.net site linked to my access database needs to be able to allow the users to search;</p>\n\n<p>-By course code or course title\n-By course type\n-By course status\n-By courses which contain certain units\n-By a combination of these</p>\n\n<p>However I have no idea how to implement this. Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["query","postgresql","count","database-performance","postgresql-performance"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":13075210,"title":"Optimization of count query for PostgreSQL","body":"<p>I have a table in postgresql that contains an array which is updated constantly.</p>\n\n<p>In my application i need to get the number of rows for which a specific parameter is not present in that array column.  My query looks like this:</p>\n\n<pre><code>select count(id) \nfrom table \nwhere not (ARRAY['parameter value'] &lt;@ table.array_column)\n</code></pre>\n\n<p>But when increasing the amount of rows and the amount of executions of that query (several times per second, possibly hundreds or thousands) the performance decreses a lot, it seems to me that the counting in postgresql might have a linear order of execution (I’m not completely sure of this).</p>\n\n<p>Basically my question is:</p>\n\n<p>Is there an existing pattern I’m not aware of that applies to this situation? what would be the best approach for this?</p>\n\n<p>Any suggestion you could give me would be really appreciated.</p>\n"},{"tags":["php","mysql","ajax","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13079933,"title":"Many datbase calls that load less data or fewer database calls that load more data?","body":"<p>I have a website I'm working on that loads 8 rows of data by making an ajax call to a php content loader that calls my database each time the user hits a next button to load the new content.</p>\n\n<p>This method works very fast for me right now as a single user of the site. </p>\n\n<p>My question is though, if I have many users on the site, would it be better to load the next 16,32, etc rows of data up front when they hit next or keep the way it is now by loading in 8 rows each time they hit next? Does it matter?</p>\n"},{"tags":["mysql","query","join","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13079084,"title":"Subquery join and total dilemma again","body":"<p>So here is my latest endeaver .. trying to add the result of sub queries to get another field or total... but sumhow this <em>simple</em> syntax doesn't seem to work.. can somebody please point me to the right direction... thanks in advance</p>\n\n<pre><code>    SELECT \n    sub_events.name AS sub_event, \n    clients.name AS client, \n    divisions.name AS division, \n    subdivisions.name AS subdivision, \n    (SELECT CONCAT(name,' ',surname) FROM users WHERE id = bookings.host_id) AS host,\n    CONCAT(users.name,'  ',users.surname) AS name, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 1 AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS flight, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 1 and itinerary_booking_id = 2 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS flight_change, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS hotel, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 and itinerary_booking_id = 3 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS hotel_change, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3  AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL)  AS transfer, \n    (SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3 AND itinerary_booking_id = 4 AND booking_id = bookings.id AND client_cost IS NOT NULL) AS transfer_change\n    (SELECT SUM((SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3 AND itinerary_booking_id = 4 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 1 and itinerary_booking_id = 2 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 2 and itinerary_booking_id = 3 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3  AND itinerary_booking_id = 1 AND booking_id = bookings.id AND client_cost IS NOT NULL)\n            +(SELECT client_cost FROM itineraries WHERE itinerary_type_id = 3 AND itinerary_booking_id = 4 AND booking_id = bookings.id AND client_cost IS NOT NULL)) AS Total)\nFROM users \nJOIN bookings ON bookings.guest_id = users.id \nJOIN clients ON users.client_id = bookings.client_id \nJOIN details ON details.user_id = users.id \nJOIN divisions ON divisions.client_id = users.client_id \nJOIN subdivisions ON subdivisions.division_id = bookings.division_id \nJOIN sub_events ON sub_events.id = bookings.sub_event_id \nJOIN itineraries ON itineraries.booking_id = bookings.id \nGROUP BY bookings.id`\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13079846,"title":"How to group results of a query by 'less than equal to' grouping?","body":"<p>I need to have the count of all items with a specific status &lt;= a particular day. So if I group by 'day' then all the 'open' items till that day must be counted. So for the next 'day' it'd be a cumulative sum including the 'open' items from the previous day(s).</p>\n\n<p>Here's an example of the schema:</p>\n\n<p><img src=\"http://i.stack.imgur.com/LsO3d.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Query</strong>: How many items were in a specific status on a particular day?</p>\n\n<p><strong>Expected output:</strong></p>\n\n<pre>\n    day*| status | count\n    ---------------------\n     1  |  open  |  3\n     2  |  open  |  6 //3 today and 3 from the previous day\n     2  |  maybe |  1\n     2  |  agree |  2\n     2  |  open  |  6 //nothing new was 'open'\n     3  |  open  |  8 //2 new\n     3  |  agree |  4 //2 new\n\n*could also be date or some other format. Not a rule, but just for illustration\n</pre>\n\n<p>I'm quite stumped with how to formulate this. I'm sure you need a self (inner) join but I don't know on what to do the group-by and what exactly to count since it's a cumulative sum. I'm guessing I'd need some temporary variables and the like but not sure how to do this in MySQL. </p>\n"},{"tags":["sql","database","query","data","masking"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13079312,"title":"Measuring Data Masking Effectiveness","body":"<p>I'm in the process of analyzing how effective a vendor tool is at data masking a defined database. In order to objectively measure the effectiveness of the tool, I would be interested in examining the difference between the original data and the masked data. Is there an open source tool available for comparing data sets? I don't need to analyze whether there is a difference in the schema after the masking just the raw data. All suggestions are appreciated. Thank you in advance for your help.</p>\n"},{"tags":["android","eclipse","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13078835,"title":"SQLite \"no such table\"","body":"<p>I've made an Adnroid program in Eclipse that reads a csv file and inputs the info into an SQLite database, and using</p>\n\n<pre><code>dbCursor = database.query(DATABASE_TABLE, new String[]{KEY_ROWID, KEY_ITEMTYPE, KEY_QUANTITY},  null, null, null, null, null);  \n\n    int iRow = dbCursor.getColumnIndex(KEY_ROWID);\n    int iType = dbCursor.getColumnIndex(KEY_ITEMTYPE);\n    int iQuantity = dbCursor.getColumnIndex(KEY_QUANTITY);\n\n        for(dbCursor.moveToFirst(); !dbCursor.isAfterLast(); dbCursor.moveToNext()){\n            allData = allData + \" \" + dbCursor.getString(iRow) + \"\\t \" + dbCursor.getString(iType) + \"\\t\\t\\t \" + dbCursor.getString(iQuantity) + \"\\n\";      \n        }\n</code></pre>\n\n<p>and then printing out allData in a textview box has worked just fine.</p>\n\n<p>Then I wanted to use </p>\n\n<pre><code>dbCursor = database.rawQuery(\"SELECT KEY_ROWID , SUM(KEY_ITEMTYPE) FROM DATABASE_TABLE GROUP BY KEY_ROWID\", null);          \nfor(dbCursor.moveToFirst(); !dbCursor.isAfterLast(); dbCursor.moveToNext()){\n\n    allDataSum = allDataSum + \" \" + dbCursor.getString(0);\n} //I know this will probably not print what I want correctly but that's a problem for another day\n</code></pre>\n\n<p>When I try to print this I get the error \"10-25 22:06:35.016: I/Database(1911): sqlite returned: error code = 1, msg = no such table: DATABASE_TABLE\". </p>\n\n<p>I then opened DDMS File Explorer and copied the database onto my desktop and then tried viewing the database with a command tool but again got an error, \"SQL error: no such table: inventory\".</p>\n\n<p>How can the emulator show me what I want to see from .query() (but not from .rawQuery) when apparently there is no table in the database? Everything about I use the query and rawQuery is identical, so it's not a case of not opening the db for rawQuery or something like that. </p>\n"},{"tags":["mysql","query","data","record"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13078714,"title":"Many data to one record MYSQL","body":"<p>I have a table named medOrder. In this table I have orders. One order has many wishes. I tried to write a query that shows one record and all the names of the wishes but I don't think the query is as good as it  could be.</p>\n\n<pre><code>SELECT m.ordcode as koden, w.wish, r.meaName as rnamn, r.meaImg as bild, \n        r.meaPrice as pris, k.catName as cname from cats k, meals r, wishes w,\n        meaOrder m\n    join orders c on c.ordNR='7265'\n    WHERE m.ordNR=c.ordNR AND m.meaID=r.meaID AND m.wishesID=w.id\n        AND r.catID=k.catID\n    ORDER BY m.ordcode DESC;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/FgaNv.png\" alt=\"data schema\"></p>\n"},{"tags":["java","sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13078116,"title":"Best Practice - Building a query based on user selections","body":"<p>I am creating a small web based tool that allows users to query a large lookup table in various ways. Since its a small tool, I'm using JSP/Servlets. </p>\n\n<p>The lookup table has a definition something like this:</p>\n\n<p>column1 | column2 | column3 | date | user | count</p>\n\n<p>The user can query by column values or a range. Also, the results can be sorted by a specific column. Because the table has several hundred thousand of records, and growing rapidly, I'm using Oracle's ROWNUM and only returning a small subset of results.</p>\n\n<p>I have a form page that gets the search criteria from the user. I generate my query based on a series of conditions, for example:</p>\n\n<pre><code>query = \"SELECT * FROM mytable WHERE 1=1 \"\nif(searchCriteria1 != \"\")\n    query += \"AND column1='searchCriteria1' \"\nif(searchCriteria2 != \"\")\n    query += \"AND column2='searchCriteria2' \"\nif(searchCriteria2 != \"\")\n    query += \"AND column2='searchCriteria2' \"\nif(searchCriteria3 != \"\")\n    query += \"AND column3='searchCriteria3' \"\nif((searchCriteria4 != \"\") &amp;&amp; (searchCriteria5 != \"\"))\n    query += \"AND date&gt;='searchCriteria4' AND date&lt;='searchCriteria5' \"\netc...\n</code></pre>\n\n<p>(This is just simplified pseudo code)</p>\n\n<p>The sorting is handled after the first results page is displayed. The user clicks on the column header of that page to sort by that column. This would be doing a post back and querying the database. Basically, I run the same code above but with this at the end:</p>\n\n<pre><code>if(sortColumn1)\n    query += \"ORDER BY column1\"\nif(sortColumn2)\n    query += \"ORDER BY column2\"\nif(sortColumn3)\n    query += \"ORDER BY column3\"\n</code></pre>\n\n<p>So, as you might imagine, my query building code is very long with all these different conditions. Any suggestions on a better way to do this?</p>\n"},{"tags":["sql","query","sqlite","count","nested"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":84,"score":3,"question_id":13059892,"title":"simple sql query with count","body":"<p>I'm using SQLite.\nI need an help for an easy issue.\nHere's my three tables:</p>\n\n<pre><code>--------------\nproblem\n--------------\nid (primary key)\nquestion_id (foreign key)\n\n--------------\nquestion\n--------------\nid (primary key)\nanswer_id (foreign key)\n\n--------------\nanswer\n--------------\nid (primary key)\n</code></pre>\n\n<p>I would like to get ALL problems that have at least N answers in every question of a problem. I'll give you an example: </p>\n\n<pre><code>-------\nproblem\nid \n1\n2\n\n\n-------\nquestion \nid   problem_id\n1    1\n2    1\n3    1\n4    2\n\n-------\nanswer\nid   question_id\n1    1\n2    1\n3    1\n4    2\n5    2\n6    3\n7    4\n8    4\n</code></pre>\n\n<p>If n=2, my result should be problem_id=2.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>   select distinct question.problem_id \n   from answer, question\n   where answer.question_id = question.id\n   group by answer.question_id\n   having count(*) &gt;= 2\n</code></pre>\n\n<p>but it doesn't work because it gets problems with at least one question with at least 2 answers. All questions must satisfy that condition.</p>\n\n<p>Any problems?</p>\n"},{"tags":["sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13077797,"title":"Determine which join added row to result set","body":"<p>I started out with a question in this thread:\n<a href=\"http://stackoverflow.com/questions/12737572/need-sql-guru-for-a-complex-query\">Need SQL guru for a complex query</a></p>\n\n<p>I now have that solved (thanks to SO), but now need to extract a bit more data.</p>\n\n<p>Let's say I have a query that joins 2 other tables, where criteria in each of the three tables can cause a row to be added to the result set.  Something like:</p>\n\n<pre><code>    SELECT a.*\n    FROM tableA a\n    LEFT JOIN tableB b on a.b_id = b.id\n    LEFT JOIN tableC c on a.c_id = c.id\n    WHERE a.creator_id = 5 OR b.is_active = 1 OR c.can_attend = 1\n</code></pre>\n\n<p>Whatever the data is... basically what I need to do is determine, for each row in the result set, which criteria allowed it in.  Was it because creator_id was 5, or because it was active, etc.</p>\n\n<p>From this overly simplified example, you could say just look at the data, but notice the data for tables b and c are not being returned, and note that there are a variety of ways in which the join may add the row to the result set.</p>\n\n<p>What I am looking for, I think, is a way to inject a value when a row is added to the result set, or something to that effect.  Will make more sense if you look at the accepted answer in the linked question above.</p>\n\n<p>Thanks for any input!</p>\n"},{"tags":["sql","query","full-text-search","contains"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13058286,"title":"SELECT statement SQL Server (full text) similar to \"CONTAINS(column, 'term1 or term 2 or term3') AND NOT (anything else)\"","body":"<p>I have a full text search going with the following scenario:</p>\n\n<p>I'd like to look for rows containing exactly the terms I have specified, and nothing more. </p>\n\n<p>My column looks like:</p>\n\n<pre><code>        Col1\n        apples oranges grapes\n        apples oranges\n        apples strawberries\n        apples strawberries peaches\n        apples\n</code></pre>\n\n<p>But I want to search only for rows that contain apples and/or strawberries, and nothing else</p>\n\n<p>my result will look like:</p>\n\n<pre><code>1| apples strawberries\n2| apples \n</code></pre>\n\n<p>Thank you :)</p>\n"},{"tags":["query","cakephp","cakephp-2.1","avg"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13069353,"title":"CakePHP 2.1 Avg function for query","body":"<p>I am using cakephp 2.1 and I wanna get average of movie ratings for perticular movie.\nWhere 'Movie' is a model and it contains 'Language' and 'CriticReview' as models.\nThe array structure is as follows.</p>\n\n<pre><code>    array(\n(int) 0 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '4',\n        'name' =&gt; 'Maattrraan',\n        'cover_image' =&gt; '/movies/4d0d1c41d956a2cb2ab93603d1fdf70c.jpg',\n        'release' =&gt; '2012-10-12',\n        'runtime' =&gt; '',\n        'budget' =&gt; '65 crore',\n        'box_office' =&gt; '',\n        'language_id' =&gt; '2',\n        'industry_id' =&gt; '3'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '2',\n        'name' =&gt; 'tamil'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'rating' =&gt; '4',\n            'movie_id' =&gt; '4'\n        ),\n                    (int) 1 =&gt; array(\n                            'rating' =&gt; '3',\n                            'movie_id' =&gt; '4'\n                    )\n    )\n),\n(int) 1 =&gt; array(\n    'Movie' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'Romeo',\n        'cover_image' =&gt; '/movies/32aa2788fa5e1584d4c627c56214574e.jpg',\n        'release' =&gt; '2012-07-06',\n        'runtime' =&gt; '',\n        'budget' =&gt; '',\n        'box_office' =&gt; '',\n        'language_id' =&gt; '1',\n        'industry_id' =&gt; '1'\n    ),\n    'Language' =&gt; array(\n        'id' =&gt; '1',\n        'name' =&gt; 'kannada'\n    ),\n    'CriticReview' =&gt; array(\n        (int) 0 =&gt; array(\n            'rating' =&gt; '6',\n            'movie_id' =&gt; '1'\n        ),\n                    (int) 1 =&gt; array(\n                            'rating' =&gt; '3',\n                            'movie_id' =&gt; '1'\n                    )\n    )\n));\n</code></pre>\n\n<p>So I have to avg of critic review. Please help me to find out the solution. The work will be appreciable.</p>\n"},{"tags":["ruby-on-rails","query","relationship","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13060036,"title":"Aggregate has_many With Another has_many Rails","body":"<p>I have the following models:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :subscriptions, as: :subscribable\n  has_many :user_to_high_school_subscriptions\n  has_many :high_school_subscriptions, through: :user_to_high_school_subscriptions\n\n  def all_subscriptions\n    self.subscriptions + self.high_school_subscriptions.subscriptions\n  end\nend\n\nclass UserToHighSchoolSubscription &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :high_school_subscription\nend\n\nclass HighSchoolSubscription &lt; ActiveRecord::Base\n  has_many :user_to_high_school_subscriptions\n  has_many :users, through: :user_to_high_school_subscriptions\n  has_many :subscriptions, as: :subscribable\nend\n\nclass Subscription &lt; ActiveRecord::Base\n  belongs_to :subscribable, polymorphic: true\nend\n</code></pre>\n\n<p>Is there a clever way for me to get ALL <code>Subscription</code>s that a <code>User</code> has.</p>\n\n<p>I tried </p>\n\n<pre><code>u = User.first\nsubs = u.all_subscriptions\n</code></pre>\n\n<p>but that is erroring out (<code>undefined method subscriptions' for #&lt;ActiveRecord::Relation:</code>).  I think it's choking when I try to use the <code>has_many :subscriptions</code> on the <code>HighSchoolSubscription</code> because a <code>user</code> <code>has_many :high_school_subscriptions</code>. (This line: <code>self.high_school_subscriptions.subscriptions</code>).</p>\n\n<p>Is there a way to aggregate has_many on a has_many in Rails?</p>\n\n<p>Running rails 3.2.1 </p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13076565,"title":"table with multiple foreign keys joining 1 foriegn key in mysql","body":"<p>Hi I have a database table with the following information :</p>\n\n<pre><code>owner.primaryitowner, (bobsmith@mail.com)\nowner.secondaryitowner, \nowner.primarybusinessowner, \nowner.secondarybusinessowner\nusers.username (email bobsmith@mail.com)\nusers.displayname (e.g. Bob Smith)\n</code></pre>\n\n<p>The issue, is the owners are only stored as emails. There is another table I normally </p>\n\n<p><code>inner join users on users.username = owner.primaryitowner to get users.displayname</code> \nso the data reads correctly.` </p>\n\n<p>I am able to do this</p>\n\n<pre><code>select u.displayname\nfrom users u\ninner join owners o on\n    o.primaryitowner = u.username\n    or o.secondaryitowner = u.username\n    or o.primarybusinessowner = u.username\n    or o.secondarybusinessowner = u.username\n</code></pre>\n\n<p>The issue is I need to have unique columns not all into one column. </p>\n\n<p>PS I cannot change the database I am only a report writer.</p>\n\n<p>Thanks so much in advance</p>\n"},{"tags":["c#","asp.net","query","session","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":13076336,"title":"Compare data from two columns from data table against variables in ASP.NET C#","body":"<p><strong>So I am practicing using a databases with ASP.Net...</strong></p>\n\n<p>I have two datatable columns from Northwind database. One is <code>Product.ProductID</code> and the other is <code>Product.UnitsInStock</code>. I need to compare that with a collection (SortedList) of objects. Essentially comparing variables Product ID and quantity(client side). The objects are a <code>ICollection</code> Value saved in a <code>Session[\"cart\"]</code>. </p>\n\n<p>How can I compare the variables I have of product id and units in stock against the DataTable columns 1 is Products.ProductID and second column is Products.UnitsInStock?</p>\n\n<p>Here is the query and roughly how I thought I could grab these variables from the database.</p>\n\n<pre><code>DataTable dt = new DataTable();\n\nif (dt.Columns.Count != 0 &amp;&amp;\n       dt.Rows.Count != 0)\n    {\n        int quantityOfUnit = 0;\n        int productID = 0;\n        for (int index = 0; index &lt; dt.Columns.Count; index++)\n        {\n            if (index == indexOfUnitsInStock)//indexOfUnitsInStock = 1\n            {\n                quantityOfUnit = int.Parse(dt.Rows[0][index].ToString());\n            }\n            else//index = 0\n            {\n                productID = int.Parse(dt.Rows[0][index].ToString());\n            }\n        }\n</code></pre>\n\n<p>Building a new query:</p>\n\n<pre><code>foreach (object items in ((ShoppingCart)Session[\"cart\"]).Values)\n    {\n        OleDbConnection conn = new OleDbConnection((string)Application[\"DBConnectionString\"]);\n    string selectionString =\n        \"SELECT Products.ProductID, Products.UnitsInStock \" +\n            \"FROM Products\" +\n            \"WHERE Products.ProductID = \" +\n            ((ShoppingCart)Session[\"cart\"]).Values;\n    DataTable dt = new DataTable();\n    try\n    {\n        OleDbCommand cm = new OleDbCommand(selectionString, conn);\n        OleDbDataAdapter da = new OleDbDataAdapter();\n        da.SelectCommand = cm;   \n        da.Fill(dt);\n        da.Dispose();\n    }\n    catch(Exception ex)\n    {\n        txtUnderstockedItems.Text = \"There was a problem connecting to the database: \" + ex.Message ;\n    }\n    finally\n    {\n        conn.Close();\n    }\n    }\n</code></pre>\n"},{"tags":["sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13068753,"title":"Alternatives to using SQL IN in this query","body":"<p>I have a string holding comma separated values = value1, value2, value3 .......</p>\n\n<p>I want to perform following operation:</p>\n\n<pre><code>SELECT col FROM table WHERE col IN :values\n</code></pre>\n\n<p>This works fine if values have less than 1000 entries. It gives error when values have more than 1000 entries. There is a limit on usage of IN.</p>\n\n<p>Is there any alternative way to perform this query? </p>\n\n<p>EDIT: \nIt is Oracle's Business Intelligence Publisher application. Customer/User can use any database underneath.</p>\n\n<p>I do not have control over database. So I cannot create a temp table or stored procedure. All I can do is select multiple values from UI screen (it forms comma separated string) and use it in a SQL query. Depending on which reports are generated.</p>\n\n<ul>\n<li>Cannot use EXISTS with static string values.</li>\n<li>Cannot use stored procedure or temp table.</li>\n</ul>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13075505,"title":"MySql: is it possibile to 'SUM IF' or to 'COUNT IF'?","body":"<p>I have a column 'hour'\nI have a column 'kind'  (it can be 1,2 or 3)</p>\n\n<p>I'd like to do something like: </p>\n\n<pre><code>SELECT count(id), SUM(hour) as totHour, SUM( IF ( kind = 1, 1, 0 ) ) as countKindOne\n</code></pre>\n\n<p>or</p>\n\n<pre><code>SELECT count(id), SUM(hour) as totHour, COUNT( IF ( kind = 1 ) ) as countKindOne\n</code></pre>\n\n<p>But mysql tell me I've an error... what's the error !?</p>\n\n<p>PLEASE SEE THIS stackoverflow topic : <a href=\"http://stackoverflow.com/questions/9083283/mysql-sum-if-field-b-field-a\">MySQL SUM IF field b = field a</a></p>\n\n<p>.. I'm not able to reply this ... </p>\n"},{"tags":["mysql","query","cpu-usage"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13075403,"title":"mySQL query killed the server","body":"<p>I am trying to find duplicate entries on a column so they can be fixed in preparation for creating a unique index on that column.  The database currently has around 4.5mil records.</p>\n\n<p>The query I used was:</p>\n\n<pre><code>SELECT `sig`, COUNT(*) c FROM `info` GROUP BY `sig` HAVING c &gt; 1;\n</code></pre>\n\n<p>This immediately locked me out of the server and the remote admin had to reboot it to restore function.  My question is, is there another better option for finding duplicates?  Some other way to mitigate the effect of the query?</p>\n"},{"tags":["php","mysql","regex","query"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13075058,"title":"Using reg ex in PHP to query MYSQL","body":"<p>I am trying to query a MYSQL database using regular expressions. I am looking to get the values under columns with this pattern 1234X32X12.</p>\n\n<p>I have written some pseudo-code, but I am unfamiliar with regular expressions, so I was hoping someone could help me out.</p>\n\n<p><strong>CODE:</strong> </p>\n\n<pre><code>if ($transposed_array[$i][0] starts with number)\n    {\n        $sid = regex something /^[0-9]*/\n        $gid = regex something /X[0-9]*X/\n        $gid = remove first and last character from $gid\n        $qid = regex something /[0-9]*$/\n\n        $question_text = mysql_query(\"select question from table where sid = \".$sid.\" and gid = \".$gid.\" and qid = \".$qid.\" limit 1\");\n        $transposed_array[$i][0] = $question_test\n    }\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"},{"tags":["php","string","query",".htaccess","mod-rewrite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13073976,"title":"htaccess rewrite issue within subdirectory and using varibales... stumped","body":"<p>I have searched and searched and tried soo many different things that just didnt work... It is beyond me. I've tried at least 50 things with no luck.. someone please help!</p>\n\n<p>First I have a a file \"index.php\" page within the folder /blog that has a link that passes variables to a page called \"post\".. The MySQL in the \"post.php\" page pulls the MySQL data from row that matches ID and displays that specific post.</p>\n\n<p>What I am trying to do is have a much cleaner and SEO friendly URL...</p>\n\n<p>For example:\non the \"www.mydomain.com/blog/index.php\" page they click a link like \"post?title=This%20is%20a%20test%20title%20for%20the%20blog%20post...&amp;id=1\" which takes them to the \"post.php\" page in the same directory as the \"index.php\" page in \"/blog/\"..</p>\n\n<p>Every single htaccess rewrite I have found is not changing the URL to a much friendlier version at all.. everything ends up staying the same.. </p>\n\n<p>Someone please help. I would like it to show as www.mydomain.com/blog/title rather than showing the above! If anyone could help me remove the \"%\" that appear in post titles for spaces and replace with \"-\" that would be really great too.. </p>\n\n<p>::desperate::\nThanks again, \nAdam</p>\n\n<p>Currently Using this in a htaccess file located in the \"blog/\" directory.</p>\n\n<pre><code>Options +FollowSymLinks -MultiViews\nRewriteEngine On\nRewriteBase /\nRewriteCond %{THE_REQUEST} ^[A-Z]{3,}\\s([^.]+)\\.php [NC]\nRewriteRule ^ %1 [R=301,NC,L]\nRewriteCond %{REQUEST_FILENAME}.php -f\nRewriteRule ^ %{REQUEST_URI}.php [L]\nRewriteEngine On\nRewriteCond %{HTTP_HOST} ^mydomain.com/blog/$ [NC]\nRewriteRule ^(.*)$ http://www.mydomain.com/blog/$1 [R=301,L]\nRewriteEngine On\nRewriteRule ^([^/]*)/([^/]*)$ /post?title=$1&amp;id=$2 [QSA,L]\n</code></pre>\n"},{"tags":["ruby-on-rails","query","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13073005,"title":"Order a merged DataMapper query and limit the number of records returned","body":"<p>Currently I have a query that DOES order my result set the way I want it, but I would like to limit the number of records returned. I am aware of limit in DataMapper but this has not worked for me because I am limiting each query return rather than the merged return. This is my query:</p>\n\n<pre><code> @activities = current_user.followed_users.activities(:order =&gt; [:created_at.desc]) + current_user.followed_centers.activities(:order =&gt; [:created_at.desc])\n</code></pre>\n\n<p>This merges the result set and orders them correctly. However, does anyone know if I can limit the return size of the merged result set? i.e if I said limit => 2... this would get the 2 newest activities either by a user or/and center.</p>\n"},{"tags":["mysql","sql","database","query","mysqldump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13074062,"title":"mysql dump copy new and changed data to DB","body":"<p>I have a DB which is 60 GB and I have a live DB which is 13 GB , now on the live DB there are some new entries and updated entries too. Consider 13GB DB has same initial data which 60 GB has with some rows updated and last few entries are completely new. No I want to copy that 13 GB to 60 GB. I have the dump but the insert commands and when I try to import it, it shows me the forign key constarained error and says it canot delete or update. So I need a query for mysql import so that it will copy the new data and update the new if any, and also the dump file is regular dump file with create, insert all those and it is not possible to change anything inside it :(</p>\n"},{"tags":["sql","sql-server","database","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":13072992,"title":"Avoid \"SELECT TOP 1\" and \"ORDER BY\" in Queries","body":"<p>I have the very table in sql server 2008 with lot of data</p>\n\n<pre><code>|ID|Name|Column_1|Column_2|\n|..|....|........|........|\n</code></pre>\n\n<p>more than 18,000 records. So i need to the the row with the lowest value of <code>Column_1</code> that is date but could by any data type (that is unsorted) so I use these sentence</p>\n\n<pre><code>SELECT TOP 1 ID, Name from table ORDER BY Column_1 ASC\n</code></pre>\n\n<p>But this is very very slow. And i think that i don't need to to sort the whole table. My question es how to get the same date with out using <code>TOP 1</code> and <code>ORDER BY</code></p>\n"},{"tags":["query","email"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3033,"score":4,"question_id":3024819,"title":"How do I check if an email address is valid without sending anything to it?","body":"<p>I have a client with 5000 emails from an old list he has that he wants to promote his services to. He wants to know which emails on the list are still valid. I want to check them for him - without sending out 5K emails randomly and then being listed as a spammer or something. Ideas?</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":17,"score":-1,"question_id":13073651,"title":"Sql server Query to get the Table Altered Result","body":"<p>I have a table as below  </p>\n\n<pre><code>ClientID        AccountNumber   BalanceOnDay0       BalanceOnDay1   BalanceOnDay2       BalanceOnDay3       BalanceOnDay4       BalanceOnDay5       BalanceOnDay6       BalanceOnDay7\nABC1            123             10                  NULL            NULL                NULL                NULL                NULL                NULL                NULL    \nABC1            123             NULL                NULL            NULL                NULL                NULL                NULL                NULL                3       \n</code></pre>\n\n<p>I would like to see the result as beblow.  </p>\n\n<pre><code>ClientID        AccountNumber   BalanceOnDay0       BalanceOnDay1   BalanceOnDay2       BalanceOnDay3       BalanceOnDay4       BalanceOnDay5       BalanceOnDay6       BalanceOnDay7\nABC1            123             10                  NULL            NULL                NULL                NULL                NULL                NULL                3\n</code></pre>\n\n<p>Please suggest!</p>\n"},{"tags":["mysql","sql","query","index"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13072004,"title":"How to query in Mysql Index","body":"<p>I created a index of my employees Name. \nBut know I don´t know how to query that index, how do I query an Index? </p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12966873,"title":"MySQL: Why is NULL ignored in MySQL?","body":"<p>I have a table with the following possible values for the column field_value.</p>\n\n<p>But when I try to select all values which are not 'CB', the query result also ignores all NULL values.</p>\n\n<p>Why does this happen? </p>\n\n<pre><code>mysql&gt; select distinct field_value from TableName;\n+--------------+\n| field_value  |\n+--------------+\n| S            |\n| NULL         |\n| CA           |\n| CB           |\n+--------------+\n4 rows in set (6.32 sec)\n\nmysql&gt; select distinct field_value from TableName where field_value!='CB';\n+--------------+\n| field_value  |\n+--------------+\n| S            |\n| CA           |\n+--------------+\n2 rows in set (0.15 sec)\n\nmysql&gt;\n</code></pre>\n"},{"tags":["database","query","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":83,"score":4,"question_id":13048988,"title":"MS Access : Average and Total Calculation in Single Query","body":"<p><strong>INTRODUCTION TO DATABASE TABLE BEING USED -</strong></p>\n\n<p>I am working on a “Stock Market Prices” based Database Table. My table has got the data for the following FIELDS –</p>\n\n<p>ID</p>\n\n<p>SYMBOL</p>\n\n<p>OPEN</p>\n\n<p>HIGH</p>\n\n<p>LOW</p>\n\n<p>CLOSE</p>\n\n<p>VOLUME</p>\n\n<p>VOLUME CHANGE</p>\n\n<p>VOLUME CHANGE %</p>\n\n<p>OPEN_INT</p>\n\n<p>SECTOR</p>\n\n<p>TIMESTAMP</p>\n\n<p>New data gets added to the table daily “Monday to Friday”, based on the stock market price changes for that day. The current requirement is based on the “VOLUME “field, which shows the volume traded for a particular stock on daily basis.</p>\n\n<p><strong>REQUIREMENT –</strong>\nTo get the Average and Total Volume for last 10,15 and 30 Days respectively.</p>\n\n<p><strong>METHOD USED CURRENTLY -</strong>\nI created these 9 SEPARATE QUERIES in order to get my desired results –\nFirst I have created these 3 queries to take out the most recent last 10,15 and 30 dates from the current table.\n  qryLast10DaysStored\n  qryLast15DaysStored\n  qryLast30DaysStored</p>\n\n<p>Then I have created these 3 queries for getting the respective AVERAGES\n  qrySymbolAvgVolume10Days\n  qrySymbolAvgVolume15Days\n  qrySymbolAvgVolume30Days</p>\n\n<p>And then I have created these 3 queries for getting the respective TOTALS\n  qrySymbolTotalVolume10Days\n  qrySymbolTotalVolume15Days\n  qrySymbolTotalVolume30Days\n**\nPROBLEM BEING FACED WITH CURRENT METHOD -**\nNow, my problem is that I have ended up having these so many different queries, whereas I wanted to get the output into One Single Query, <strong>as shown in the Snapshot of the Excel Sheet.</strong></p>\n\n<p><a href=\"http://i49.tinypic.com/256tgcp.png\" rel=\"nofollow\">http://i49.tinypic.com/256tgcp.png</a></p>\n\n<p><strong>SOLUTION NEEDED -</strong>\nIs there some way by which I can get these required fields into ONE SINGLE QUERY, so that I do not have to look into multiple places for the required fields? Can someone please tell me how to get all these separate queries into one -\nA) Either by taking out or moving the results from these separate individual queries to one.\nB)** Or by making a new query which calculates all these fields within itself, so that these separate individual queries are no longer needed. This would be a better solution I think.**</p>\n\n<p><strong>One Clarification about Dates –</strong> Some friend might think why I used the method of using Top 10,15 and 30 for getting the last 10,15 and 30 Date Values. Why not I just used the PC Date for getting these values? Or used something like -  (\"VOLUME\",\"tbl-B\", \"TimeStamp BETWEEN Date() - 10 AND Date()\")\nThe answer is that I require my query to \"Read\" the date from the \"TIMESTAMP\" Field, and then perform its calculations accordingly <strong>for  LAST / MOST RECENT \"10 days, 15 days, 30 days”  FOR WHICH THE DATA IS AVAILABLE IN THE TABLE, WITHOUT BOTHERING WHAT THE CURRENT DATE IS. It should not depend upon the current date in any way.</strong></p>\n\n<p><strong>If there is any better method  or more efficient way to create these queries, then please enlighten.</strong></p>\n\n<p>Thanks a lot :)</p>\n\n<p>PS : I have attached a SAMPLE database which has the data for 6 months,  from 1 Nov 2011 to 30 April 2012 and it has also got the above mentioned queries in it.\n<a href=\"http://limelinx.com/448h\" rel=\"nofollow\">Sample Database with QUERIES</a></p>\n"},{"tags":["php","wordpress","query","if-statement","echo"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13072691,"title":"PHP/Wordpress - Including an IF function inside an Echo","body":"<p>I have the following WordPress query:</p>\n\n<pre><code>$my_query = new WP_Query($args);\nif ($my_query-&gt;have_posts()) {\n    echo '&lt;div class=\"' . $tax_term-&gt;slug . '\" style=\"display:none; background:url(' . $whatdoiputhere . ');\"&gt;';\n    while ($my_query-&gt;have_posts()) : $my_query-&gt;the_post();\n</code></pre>\n\n<p>In the background URL, I need to include an image URL that is generated by the following code:</p>\n\n<pre><code>&lt;?php if (function_exists('z_taxonomy_image_url')) echo z_taxonomy_image_url(); ?&gt;\n</code></pre>\n\n<p>How would I include this IF function inside the background URL?</p>\n\n<p>I tried this but as you can guess it didn't work:</p>\n\n<pre><code>background:url(' . if (function_exists('z_taxonomy_image_url')) echo z_taxonomy_image_url(); . ');\n</code></pre>\n\n<p>Would appreciate some help as to how I would do this.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13071766,"title":"SQL Server - Get highest values when previous date not blank","body":"<p>I have a table that contains information for player's steps taken for any given day, I want to get the 3 highest totals from the database, when the day before the day of the high total has a value added to it for that player. Since some players are not logging everyday, but rather lumping multiple days into one update.</p>\n\n<p>Data Structure:</p>\n\n<pre><code>|---------------------------------------------------------------|\n| id | player_id | steps | date       | submitted               |\n|----|-----------|-------|------------|-------------------------|\n| 1  | 16        | 5718  | 2012-09-06 | 2012-09-10 08:31:35.000 |\n| 2  | 16        | 9837  | 2012-09-07 | 2012-09-10 08:31:17.000 |\n| 3  | 16        | 10432 | 2012-09-09 | 2012-09-10 08:30:54.000 |\n| 4  | 30        | 3973  | 2012-09-07 | 2012-09-10 09:34:42.000 |\n| 5  | 30        | 7104  | 2012-09-08 | 2012-09-10 09:35:05.000 |\n| 6  | 30        | 10916 | 2012-09-09 | 2012-09-10 09:35:29.000 |\n| 7  | 9         | 6437  | 2012-09-07 | 2012-09-10 09:39:15.000 |\n| 8  | 9         | 9032  | 2012-09-08 | 2012-09-10 09:40:02.000 |\n|---------------------------------------------------------------|\n</code></pre>\n\n<p>So what I want to return are the rows:</p>\n\n<pre><code>|---------------------------------------------------------------|\n| 6  | 30        | 10916 | 2012-09-09 | 2012-09-10 09:35:29.000 |\n| 2  | 16        | 9837  | 2012-09-07 | 2012-09-10 08:31:17.000 |\n| 8  | 9         | 9032  | 2012-09-08 | 2012-09-10 09:40:02.000 |\n|---------------------------------------------------------------|\n</code></pre>\n\n<p>My query is currently:</p>\n\n<pre><code>SELECT TOP 3 p.name,\n             player_id,\n             steps,\n             date\nFROM   steppers_step_log\n       JOIN steppers_players P\n         ON player_id = P.id\nORDER  BY steps DESC \n</code></pre>\n\n<p>Which does not take into account whether there is an entry for the date prior on the top 3 from steps, which with my query in its current form will return 10432, 10916, and 9837 as the top steps.</p>\n\n<p>I am having trouble working out how to do the WHERE command to make sure that the previous day has an entry for that player_id and would appreciate any help in getting it working.</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":135,"score":7,"question_id":11509707,"title":"MySQL - Search PHP script","body":"<p>I'm currently coding my own CMS and I'm at the point of the <code>search.php</code>. I need to search in 4 tables that haves different columns name within only one query because my server is not the fastest.</p>\n\n<p>There's my DB arrangement:</p>\n\n<p><code>cmw_admin</code> (users table)</p>\n\n<pre><code>+-----------------+------------+------+-----+---------+----------------+\n| Field           | Type       | Null | Key | Default | Extra          |\n+-----------------+------------+------+-----+---------+----------------+\n| id              | int(11)    | NO   | PRI | NULL    | auto_increment |\n| role            | int(11)    | NO   |     | 1       |                |\n| username        | text       | NO   |     | NULL    |                |\n| password        | text       | NO   |     | NULL    |                |\n| email           | text       | NO   |     | NULL    |                |\n| phone           | text       | NO   |     | NULL    |                |\n| location        | text       | NO   |     | NULL    |                |\n| full_name       | text       | NO   |     | NULL    |                |\n| bio             | text       | NO   |     | NULL    |                |\n| website         | text       | NO   |     | NULL    |                |\n| last_login      | datetime   | NO   |     | NULL    |                |\n| registered_date | datetime   | NO   |     | NULL    |                |\n| registered_ip   | text       | NO   |     | NULL    |                |\n| credits         | tinyint(1) | NO   |     | NULL    |                |\n| online          | int(11)    | NO   |     | 0       |                |\n+-----------------+------------+------+-----+---------+----------------+\n</code></pre>\n\n<p><code>cmw_blog</code> (articles table)</p>\n\n<pre><code>+------------+----------+------+-----+---------+----------------+\n| Field      | Type     | Null | Key | Default | Extra          |\n+------------+----------+------+-----+---------+----------------+\n| id         | int(11)  | NO   | PRI | NULL    | auto_increment |\n| title      | text     | NO   |     | NULL    |                |\n| content    | text     | NO   |     | NULL    |                |\n| date       | datetime | NO   |     | NULL    |                |\n| author     | int(11)  | NO   |     | NULL    |                |\n| categories | text     | NO   |     | NULL    |                |\n| media      | text     | NO   |     | NULL    |                |\n| thumb      | text     | NO   |     | NULL    |                |\n+------------+----------+------+-----+---------+----------------+\n</code></pre>\n\n<p><code>cmw_projects</code> (portfolio)</p>\n\n<pre><code>+-------------+------------+------+-----+---------+----------------+\n| Field       | Type       | Null | Key | Default | Extra          |\n+-------------+------------+------+-----+---------+----------------+\n| id          | int(11)    | NO   | PRI | NULL    | auto_increment |\n| owner_id    | int(11)    | NO   |     | NULL    |                |\n| title       | text       | NO   |     | NULL    |                |\n| content     | text       | NO   |     | NULL    |                |\n| date        | date       | NO   |     | NULL    |                |\n| link        | text       | NO   |     | NULL    |                |\n| img         | text       | NO   |     | NULL    |                |\n| type        | int(11)    | NO   |     | NULL    |                |\n| start_date  | date       | NO   |     | NULL    |                |\n| end_date    | date       | NO   |     | NULL    |                |\n| done        | tinyint(1) | NO   |     | 0       |                |\n| screenshots | text       | NO   |     | NULL    |                |\n+-------------+------------+------+-----+---------+----------------+\n</code></pre>\n\n<p><code>cmw_services</code> (services table)</p>\n\n<pre><code>+-------------+---------------+------+-----+---------+----------------+\n| Field       | Type          | Null | Key | Default | Extra          |\n+-------------+---------------+------+-----+---------+----------------+\n| id          | int(11)       | NO   | PRI | NULL    | auto_increment |\n| cat_id      | int(11)       | NO   |     | NULL    |                |\n| name        | text          | NO   |     | NULL    |                |\n| description | text          | NO   |     | NULL    |                |\n| img         | text          | NO   |     | NULL    |                |\n| price       | decimal(11,2) | NO   |     | NULL    |                |\n+-------------+---------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>In my search, I need to search for string in every <code>name</code>/<code>title</code> columns and in all <code>description</code>/<code>content</code> columns too. In clear, I want to search all those table for one string, in only one query. Is that possible? I know that using <code>JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code> and <code>INNER JOIN</code> may be easy but I don't know how to use them. Google is not very explicit on that things!</p>\n"},{"tags":["mysql","sql","database","query","ms-access"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13069977,"title":"Very slow querying in Access, Can a SQL server do any better","body":"<p>I am working on MSAccess to quickly load the data and perform some analysis.\nSince the data exceeds over 200,000 records, it gets really very slow and takes for ever or never returns a result. I know that this is expected.</p>\n\n<p>Does installing a SQL server (freely availalbe) like MySQL do better in this scenario?\n(even for a million similar records)</p>\n\n<p>I cannot ask for paid software to perform analysis.</p>\n"},{"tags":["string","query",".htaccess","redirect","append"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13066142,"title":"htaccess Redirect if query string variable present","body":"<p>I need to add <code>style=2</code> to all urls within a directory ONLY if the url does NOT already contain <code>style=2</code>. </p>\n\n<p>Within the directory root, I have an .htaccess with the following:</p>\n\n<pre><code>RewriteCond %{QUERY_STRING} !(?style=|&amp;style=)\nRewriteRule ^(.*)$ %1&amp;style=2? [R=301,QSA]\n</code></pre>\n\n<p>I know it's wrong. Can anyone help?</p>\n"},{"tags":["sql","sql-server","query","backup"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13069025,"title":"SQL backup loop","body":"<p>I've built a backup query in SSMSE 2005 and saved as a text query.</p>\n\n<p>Is there a way to loop through DB and write each as a unique file?</p>\n\n<p>What I've done is copy/paste and find/replace database_name and run both in a single pass.  That works, but would like either:</p>\n\n<p>Run a single loop script which backs up each DB individually OR \nBatch backup from the SSMSE GUI</p>\n\n<pre><code>BACKUP DATABASE [ION_Data_Nov08] TO DISK =\nN'C:\\Documents and Settings\\DB.control\\Desktop\\ION Database Backups\\121025_0700\\ION_Data_Nov08'\nWITH noformat, init, name = N'ION_Data_Nov08-Full Database Backup', skip,\nnorewind, nounload, stats = 10 \n\ngo\n\nDECLARE @backupSetId AS INT \n\nSELECT @backupSetId = position\nFROM   msdb..backupset\nWHERE  database_name = N'ION_Data_Nov08' \n        AND backup_set_id = (SELECT Max(backup_set_id)\n                             FROM   msdb..backupset\n                            WHERE  database_name = N'ION_Data_Nov08')\n\n IF @backupSetId IS NULL\n   BEGIN\n       RAISERROR(\nN'Verify failed. Backup information for database ''ION_Data_Nov08'' not found.',\n 16,1)\nEND\n\n RESTORE verifyonly FROM DISK =\n  N'C:\\Documents and Settings\\DB.control\\Desktop\\ION Database Backups\\121025_0700\\ION_Data_Nov08'\n WITH FILE = @backupSetId, nounload, norewind\n\ngo\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","query","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13041605,"title":"Rails: How to fetch records that are 2 'has_many' levels deep?","body":"<p>I have these models set up:</p>\n\n<pre><code>Course\n  has_and_belongs_to_many Student\n\nStudent\n  has_and_belongs_to_many Course\n  has_many Books\n\nBook\n  belongs_to Student\n</code></pre>\n\n<p>How do I efficiently get all the Books for a Course with ActiveRecord?</p>\n"},{"tags":["mysql","sql","query","many-to-many"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":69,"score":1,"question_id":13063497,"title":"Mysql many-to-many realtionship multiple condition","body":"<p>I have three tables, for example:</p>\n\n<p>watch table</p>\n\n<pre><code>id(int)  name(varchar)  ref(int)\n1        tissot         1234567\n2        addidas        7654321\n3        nike           8976543\n</code></pre>\n\n<p>property table</p>\n\n<pre><code>id(int)  name(varchar)\n1        water_resistant\n2        material_body\n3        material_bracelet\n4        watch_type\n</code></pre>\n\n<p>property_material table</p>\n\n<pre><code>watch_id  property_id   value\n1              1          200\n1              2         steel\n1              3         leather\n1              4         quartz\n2              1          50\n2              2         plastic\n2              3         leather\n2              4         quartz\n3              1         100\n3              2         steel\n3              3         rubber\n3              4        mechanical\n</code></pre>\n\n<p>I want get all watches which have properties for example: </p>\n\n<ul>\n<li>water_resistant >= 100</li>\n<li>material_body = steel or plastic</li>\n<li>material_bracelet = leather or rubber</li>\n<li>watch_type = quartz.</li>\n</ul>\n\n<p>Help me please create query. Properties can be about 100.\nIn ideal i want get result:</p>\n\n<pre><code>watch_id name    ref   water_res mat_body mat_bracelet watch_type\n1        tissot  1234   200       steel    leather      quartz\n</code></pre>\n\n<p>I'm try: </p>\n\n<pre><code>select \n w.*, pm.value,pm.property_id \nfrom \n watch w \njoin \n  property_material pm \n on w.id = pm.watch_id \nwhere \n  pm.pid in (1,2,3) \nand \n pm.value in ('100','Steel','Leather');\n</code></pre>\n\n<p>But this query return all records, when value is Steel or Leather, bur I need where material_body is Steel and material_bracelet is Leather, for example.</p>\n\n<p><strong>UPDATE</strong>: What you are think about this query?</p>\n\n<pre><code>select \n  name, ref \nfrom\n  watch w\njoin\n(SELECT w.id\n  FROM watch w\n  JOIN property_material pm on w.id = pm.watch_id\n  WHERE (pm.property_id = 1 AND pm.value &gt; 100)\n   OR (pm.property_id = 2 AND pm.value IN ('steel','plastic'))\n   OR (pm.property_id = 3 AND pm.value IN ('leather','rubber'))\n   OR (pm.property_id = 4 AND pm.value = 'quartz')\n  Group by w.id\n  Having count(*) = 4) as t1\n on t1.id = w.id;\n</code></pre>\n\n<p><strong>LAST UPDATE</strong>:</p>\n\n<pre><code>select \n  w.name, \n  max(if(pm.property_id='1',pm.value,'')) water_resistant,\n  max(if(pm.property_id='2',pm.value,'')) material_body,\n  max(if(pm.property_id='3',pm.value,'')) material_bracelet,\n  max(if(pm.property_id='4',pm.value,'')) watch_type\nfrom\n  watch w\njoin\n(\n    SELECT w.id\n  FROM watch w\n       JOIN property_material pm on w.id = pm.watch_id\n  WHERE (pm.property_id = 1 AND pm.value &gt; 100)\n      OR (pm.property_id = 2 AND pm.value IN ('steel','plastic'))\n      OR (pm.property_id = 3 AND pm.value IN ('leather','rubber'))\n      OR (pm.property_id = 4 AND pm.value = 'quartz')\n  Group by w.id\n  Having count(*) = 4\n  ) as t1 on t1.id = w.id\n join property_material pm on w.id = pm.watch_id\nGROUP BY w.id\n</code></pre>\n"},{"tags":["php","mysql","query","insert"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13067121,"title":"MySQL: Get a return result from an INSERT SELECT","body":"<p>I have query that INSERTS both explicit values and SELECTd content. I'm also doing basic incrementing.</p>\n\n<pre><code>INSERT INTO `table` (`myID`, `myVal1`, `myVal2`) SELECT `myID` + 1, 'explValHere', 'otherValThere')\nFROM `table` ORDER BY `myID` DESC LIMIT 0,1\n</code></pre>\n\n<p>I am doing this as the table has multiple id's and incrementing within a specific column. So I can't, as you would first say, use auto incrementing and insert_id.</p>\n\n<p>The problem of course is the insert doesn't return the select, but can it? Is there a way of running this insert query and returning any of the result?</p>\n"},{"tags":["facebook","query","chat","history","fql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":12094464,"title":"FQL Query for getting Chat conversation","body":"<p>Here is the code. In the result I want to see my conversation and my friend conversation. For conversation history functionality How can I do this? </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT message_id, thread_id, author_id, body, created_time, viewer_id \nFROM message WHERE thread_id IN \n(SELECT thread_id, subject, recipients FROM thread WHERE folder_id =0 )\nAND author_id = 'xxxxxxxxxxxxxxx' ORDER BY created_time DESC LIMIT 0,25\n</code></pre>\n\n<p>This code returns only my friend data.</p>\n"},{"tags":["c#","linq","query","linq-to-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13064614,"title":"LINQ query... How to perform?","body":"<p>Say I got next sequence:</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n</code></pre>\n\n<p>I need make next thing with Linq:</p>\n\n<pre><code>1,2;\n2,3;\n3,4;\n4,5;\n...\n9,10;\n</code></pre>\n\n<p>Can't get it.</p>\n"},{"tags":["sql","oracle","query","entity-attribute-value"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13064378,"title":"Oracle, Can't get details from the same column","body":"<p>I have a table named PARAMETER looking like this:</p>\n\n<pre><code>ID - number\nNAME - varchar2\nVALUE - varchar2\n</code></pre>\n\n<p>I have this query witch is 'extracting' the date from the string:</p>\n\n<pre><code>SELECT * from PARAMETER\nwhere (NAME = 'From') and SUBSTR(VALUE, 1, 2)&gt;='01' \nand SUBSTR(ALUE, -7, 5)&gt;='11' and SUBSTR(VALUE, -4, 4) &gt;='2012'\n</code></pre>\n\n<p>Now I need to run it again changing only: <code>where (NAME = 'From')</code>  to  <code>where (NAME = 'To')</code></p>\n\n<p>and compare the results. I can't find a way to do this. Is there a trick?</p>\n"},{"tags":["performance","query","optimization","expressionengine"],"answer_count":6,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":139,"score":9,"question_id":13041463,"title":"What's the optimal amount of queries an ExpressionEngine page should load?","body":"<p>I saw @parscale tweet: <a href=\"https://twitter.com/parscale/status/260808185424781312\">How many queries are you happy with for a home page? When do you say this is Optimized?</a></p>\n\n<p>I saw responses that &lt; 50 is good, 30 or less is best, and 100+ is danger zone. Is there really any proper number? And if say you do have > 50 queries running on your pages, what are some ways to bring it down?</p>\n\n<p>I generally have sites that run the gamut that are under 50 queries and some more, though the \"more\" don't seem to be too slow, I'm always interested in making it faster. How?</p>\n"},{"tags":["sql","query","jpa-2.0","java-ee-6"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13065801,"title":"How can I convert this SQL Query into JPA Query?","body":"<p>I have a query like that:</p>\n\n<pre><code>Select p.* from MyTable p where \nid = 1 and version = (select MAX(version) from MyTable where id=1)\n</code></pre>\n\n<p>I try to convert it into JPA Query. How should it be?</p>\n\n<pre><code>select e from MyTable e where e.id=:id and version=(Select max(e.version) from MyTable e where e.id=:id) \n</code></pre>\n\n<p>Is it correct?</p>\n\n<p>Can I use for both id parameters the same name. (id) and handle them with only one setParameter?</p>\n"},{"tags":["query","ms-access","report"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13066392,"title":"I have a view-query in ms-access that has an order by sum(sells) and it works; The same query is not working in a report","body":"<p>When it runs into a report a dialog window opens to ask me for the \"sum(sells)\" variable as it didn't know what it was. The query is exactly the same as the view and the view shows correct data but the report don't.</p>\n\n<p>How might I fix?</p>\n"},{"tags":["query","prolog","stackoverflow","nfa"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12747324,"title":"Prolog query infinite search","body":"<p>I am a beginner to Prolog and I would like to ask a question about Prolog.</p>\n\n<p>My program is based on non-deterministic finite-state automaton.</p>\n\n<p>the start state is <strong>S0</strong> and the final state is <strong>S3</strong>.</p>\n\n<p>The diagram is</p>\n\n<p><img src=\"http://i.stack.imgur.com/LwhI7.png\" alt=\"enter image description here\"></p>\n\n<p>so if there is a string <code>[a,a,b,b,c,c]</code> it should be like</p>\n\n<pre><code>start(s0) \nedge(a, s0, s0) \nedge(a, s0, s1) \nedge(b, s1, s1) \nedge(b, s1, s2) \nedge(c, s2, s2) \nedge(c, s2, s3) \nfinal(s3)\n</code></pre>\n\n<p>There is a predicate <code>accepts(Ls)</code> if (there <code>Ls</code> is a list of string)</p>\n\n<pre><code>accepts (Ls) :- start(A), goesTo(Ls, A, B), final(B)\n</code></pre>\n\n<p>and assuming that the NFA goes from state <strong>Si</strong> to state <strong>Sj</strong> and in between them there is a state <strong>Sk</strong>, <code>goesTo</code> predicate is defined as</p>\n\n<pre><code>goesTo (Ls, Si, Sj) :- edge (L, Si, Sk), goesTo(Ls, Sk, Sj)\n</code></pre>\n\n<p>But if querying <code>accepts(Ls)</code> (any arbitrary list of string ranging from <code>a</code> to <code>c</code>)\nthe tutorial question says that it will almost certainly go into an infinite search and stack overflow will occur.</p>\n\n<p>However, I don't understand why the query will go into an infinite search and cause stack overflow. If you can give me the reason, it would be really great!</p>\n\n<p><em><strong>(edit:)</em></strong> the exact quote is:</p>\n\n<blockquote>\n  <p>\"a typical Prolog user might hope that his/her goesTo rules would be such tat the query accepts(X) would generate successive strings that are accepted by the NFA above. Almost certainly, given the above presentation of the given NFA, the Prolog system will go into an infinite search and stack overflow will occur. Say why this is so. (if your goesTo avoid this problem, say how you managed to avoid it).\"</p>\n</blockquote>\n"},{"tags":["mysql","performance","query","select-query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13048951,"title":"I need to speed up specific mysql query on large table","body":"<p>Hi I know there is a lot of topics dedicated to query optimizing strategies, but this one is so specific I couldnt find the answer anywhere on the interenet.</p>\n\n<p>I have large table of product in eshop (appx. 180k rows) and the table has 65 columns. Yeah yeah I know its quite a lot, but I store there information about books, dvds, bluerays and games.</p>\n\n<p>Still I am not considering a lot of cols into query, but the select is still quite tricky. There are many conditions that need to be considered and compared. Query below</p>\n\n<pre><code>SELECT *\nFROM products\nWHERE production = 1 \nAND publish_on &lt; '2012-10-23 11:10:06' \nAND publish_off &gt; '2012-10-23 11:10:06' \nAND price_vat &gt; '0.5' \nAND ean &lt;&gt; ''\nAND publisher LIKE '%Johnny Cash%'\nORDER BY bought DESC, datec DESC, quantity_storage1 DESC, quantity_storege2 DESC, quantity_storage3 DESC\nLIMIT 0, 20\n</code></pre>\n\n<p>I have already tried to put there indexes one by one on cols in where clause and even in order by clause, then I tried to create compound index on (production, publish_on, publish_off, price_vat, ean). </p>\n\n<p>Query is still slow (couple of seconds) and it need to be fast since its eshop solution and people are leaving as they are not getting their results fast. And I am still not counting the time I need to perform the search for all found rows so I can make paging.</p>\n\n<p>I mean, the best way to make it quick is to simplify the query, but all the conditions and sorting is a must in this case. </p>\n\n<p>Can anyone help with this kind of issue? Is it even possible to speed this kind of query up, or is there any other way how I can for example simplify the query and leave the rest on php engine to sort the results.. </p>\n\n<p>Oh, Iam really clueless in this.. Share your wisdom peple, please...</p>\n\n<p>Many thanks in advance</p>\n"},{"tags":["sql","query","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13064040,"title":"Pivot table in sql server 2005","body":"<p>This is my record in my table </p>\n\n<pre><code>GuestName      F1    H1    F2  H2  F3   H3\nRyan Palma     1200  Room  12  SC  14   VAT\nRichard Palma  1500  Room  15  SC  17   VAT\nRuth Palma     1600  Room  16  SV  18   VAT\n</code></pre>\n\n<p>I want an output like this</p>\n\n<pre><code>GuestName      Room  SC  VAT\nRyan Palma     1200  12  14\nRichard Palma  1500  15  17\nRuth Palma     1600  16  18\n</code></pre>\n\n<p>How can i do this using query,</p>\n\n<p>Thanks in advance, any help is appreciated</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13064062,"title":"hyphen in sql query is causing the issue","body":"<p>i am trying to query from database asking for data with this filter. i want that the word which is after not like not to exist in my result query. but my result is still having the that word. </p>\n\n<pre><code>select * from table where titel not like '%word-word%'\n</code></pre>\n\n<p>but i am still getting the query where the title has the word <code>'word-word'</code>. </p>\n\n<p>do i have to escape the query for <code>'-'</code></p>\n\n<p>is there any difference between <code>like</code> and <code>not like</code> in this sense ? </p>\n"},{"tags":["mysql","query","index"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13063943,"title":"mysql performance & index","body":"<p>I have 5 relation tables like </p>\n\n<pre><code>ID | FK_USER | FK_POST | DATE\n</code></pre>\n\n<p>Is it faster and efficient to user separate tables for each type of relation, or to create just one table like</p>\n\n<pre><code>ID | FK_USER | FK_POST | TYPE | DATE\n</code></pre>\n\n<p>where type is an Enum, and I put an INDEX on TYPE ?</p>\n\n<p>Assume that I search about \"subscription\" (which is one of my relation types) Is it faster to use separate table and search on it, or use combined table and add \"<code>where TYPE = 1</code>\" to query string?</p>\n"},{"tags":["c#","sql","linq","query","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13062518,"title":"How to convert IEnumerable to EntitySet","body":"<p>I have got way to convert <code>IEnumerable</code> to <code>EntitySet</code>. But I'm facing some issue in calling the function.</p>\n\n<p>My class is a sealed public class, so I have added extension method in separate static class within the same namespace.</p>\n\n<pre><code> public static class Conversion\n    {\n        public static EntitySet&lt;T&gt; ToEntitySet&lt;T&gt;(this IEnumerable&lt;T&gt; source) where T : class\n        {\n            var es = new EntitySet&lt;T&gt;();\n            es.AddRange(source);\n            return es;\n        }\n    }\n</code></pre>\n\n<p>My query is in sealed class, how can i call this method from my query. Here is my sql query</p>\n\n<pre><code>var p1 = (from v in dc.ptable\n                          where v.PtableId == ps.input.Id.Value\n                          select new DBModel\n               {\n\n                   MEntetyset = (v.Menteties.Where(t =&gt; t.Delf == null))\n\n               });\n</code></pre>\n\n<p>Kindly help. thanks in advance</p>\n"},{"tags":["java","mysql","query","procedure"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13063289,"title":"Mysql update query/procedure","body":"<p>I have a table with 2 columns, user and userMessage with table name as <strong>Messages</strong>\nI have another table with 2 columns as user and userMessageCount with table name as <strong>MessageCount</strong>.\nI am very new to programming. I need to write an update query or procedure something that will count the number of messages per user from <strong>Messages</strong> and store the count in <strong>MessageCount</strong>.</p>\n\n<p>I am not able to understand the proper way of doing this. I understand this is a very basic question and I should study to solve this. i am running very late for a deadline. Please help me on this query.</p>\n"},{"tags":["c#","oracle","query"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3542,"score":0,"question_id":1542594,"title":"Insert, Update, Delete for Oracle are not working in .NET C#?","body":"<p>It has been a while that i'm dealing with oracle and .net and they don't seem to be a perfect match together. That's this strange thing, i'm not finding any reason why it happens or how to fix it.</p>\n\n<p>I do simple insert, update and delete and they are not working. It fails on the </p>\n\n<pre><code>cmd.ExecuteNonQuery();\n</code></pre>\n\n<p>Here's the piece of code:</p>\n\n<pre><code>sqlCommand = string.Format(@\" INSERT INTO TABLE_1\n                              (ID, NAME, DESCRIPTION)\n                              VALUES ((SELECT MAX(ID)+1 FROM TABLE_1),'{0}','{1}')\", name, description);\n\nusing (OracleConnection conn = new OracleConnection(connectionString))\n{\n OracleCommand cmd = new OracleCommand(sqlCommand, conn);\n cmd.CommandType = commandType;\n\n try\n {\n  conn.Open();\n  result = cmd.ExecuteNonQuery();                    \n }\n catch (Exception ex) { throw;}\n finally\n {\n  conn.Close();\n }\n</code></pre>\n\n<p>a simple insert, right?! when i debug, i get the cmd.Text value (that would be the sqlCommand), and i do execute it in the oracle db, it goes just fine. As i go the point of executing it in .Net it gives up. </p>\n\n<p>Is this a known situation? Is there any solution, any explanation for it?</p>\n\n<p>Thnx in advance</p>\n"},{"tags":["sql","query","duplicates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13062986,"title":"How to delete duplicate values from fields in SQL?","body":"<p>I have two tables (cd catalogs lets say) in my SQL DB. I want to put records from one table (that gets re-created nightly) into my main table. I only want to put items with a quantity greater than 0 into the main table. However, some items in the nightly table will have the same UPC barcode field as those in the main table. I do not want to put these in, provided those already in the main table have a quantity greater than 0. Otherwise I want all the entries with quantities greater than 0 to go from nightly to main table.</p>\n\n<p>I simply can't wrap my head around how to do this. Of course I have it set up now so that everything with a quantity>0 gets copied to the main table, but then that means I can have duplicate listings for the same item that was already in the main table (duplicates based on UPC).</p>\n\n<p>Anyone know how I can do this? My query as it stands:</p>\n\n<pre><code>INSERT INTO main ( id, title, artist, qty, barcode ) \nSELECT nightly.PID, \n       nightly.Title, \n       nightly.Artist, \n       nightly.QtyAvail, \n       nightly.UPC \nFROM nightly \nWHERE nightly.QtyAvail &gt; 0;\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":11560713,"title":"Generate insert script for selected records?","body":"<p>I have a table with the following data:</p>\n\n<pre><code>Pk_Id  ProductName           Fk_CompanyId       Price\n------------------------------------------------------\n1      AMX                   1                  10.00\n2      ABC                   1                  11.00\n3      APEX                  1                  12.00\n4      AMX                   1                  10.00\n5      ABC                   1                  11.00\n6      APEX                  1                  12.00\n7      AMX                   2                  10.00\n8      ABC                   2                  11.00\n9      APEX                  2                  12.00\n</code></pre>\n\n<p>I want to generate Insert script for migrating records whose Fk_CompanyId is 1.</p>\n\n<p>There is an insert script option to generate script for all records but I want to filter some records to migrate to another database.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13062133,"title":"MySQL query and count from other table","body":"<p>I would like to get the data from one table, and count all results from other table, depending on the first table data, here is what I tried:</p>\n\n<pre><code>SELECT\n    cars.*, (\n        SELECT\n            COUNT(*)\n        FROM\n            uploads\n        WHERE\n            uploads.cid = cars.customer\n    ) AS `count`,\nFROM\n    `cars`\nWHERE\n    customer = 11;\n</code></pre>\n\n<p>I dont really have an idea why its not working, as I'm not a regular MySQL user/coder...</p>\n\n<p>Could anyone direct me in the right direction with this one?</p>\n"},{"tags":["sql","database","query","sqlite3","aggregate-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13058721,"title":"How to select rows with max values on a certain column","body":"<p>For example, I have</p>\n\n<pre><code>tab1:\natt1|att2\nA|3\nB|4\nC|3\nD|4\nE|1\nF|2\n</code></pre>\n\n<p>And I want</p>\n\n<pre><code>B|4\nD|4\n</code></pre>\n\n<p>I know I can use</p>\n\n<pre><code>SELECT att1 att2\nFROM tab1 as T\nWHERE T.att2 =\n(\n   SELECT MAX(att2) FROM tab1;\n}\n</code></pre>\n\n<p>I wondering if there is a more clever way to do it. B/c if it takes a complicated query to get tab1, it is cumbersome to write it twice.\nBy the way, I am using Sqlite.</p>\n"},{"tags":["php","mysql","arrays","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":606,"score":0,"question_id":7985114,"title":"MYSQL Delete Where Field is Not Part of Array","body":"<p>I have a table \"groupdentlink\" where I want to delete all the rows that weren't checked in a form. </p>\n\n<p>In essence I want to perform a query like:</p>\n\n<pre><code>DELETE * FROM groupdentlink\nWHERE group_id = 'a'\nAND dentist_id IS NOT IN ARRAY 'b'\n</code></pre>\n\n<p>I think I could set a variable with a foreach loop and then keep adding the array values to it so I end up with:</p>\n\n<pre><code>DELETE * FROM groupdentlink\nWHERE group_id = 'a'\nAND dentist_id != 'D1'\nAND dentist_id != 'D5'\nAND dentist_id != 'D8'\n</code></pre>\n\n<p>...and so on.</p>\n\n<p>But is this really the right/best way to do this?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["query","sql-server-2012","results"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13061343,"title":"Getting SQL Procedure ResultSet Information","body":"<p>for SQL Server 2012, Any idea how to get the results from a SQL stored procedure without running it?</p>\n\n<p>Closest I found find is from sp_depends which has a selected but it gives me results even when its in the where statement.</p>\n\n<p>Hoping to find a way to find what columns are selected, but not in where statement</p>\n\n<p>Lemme rephrase a little bit..</p>\n\n<p>I dont need the data, just what columns it returns, so I can create my result classes via a T4</p>\n"},{"tags":["query","xdocument"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13061221,"title":"using Linq to query XDocument keeps throwing Null pointer exception","body":"<p>How do I use Linq to query an xml doc? When I use the code below the \"where\" clause is throwing \"Object reference not set to an instance of an object.\". Specifically, I think the node is null. Please help!</p>\n\n<p>My xml looks like this:</p>\n\n<pre><code>&lt;qbo:QboCompanyPreferences xmlns=\"http://www.intuit.com/sb/cdm/v2\" xmlns:qbp=\"http://www.intuit.com/sb/cdm/qbopayroll/v1\" xmlns:qbo=\"http://www.intuit.com/sb/cdm/qbo\"&gt;\n  &lt;qbo:Preference&gt;\n    &lt;Name&gt;TaxAccountId&lt;/Name&gt;\n    &lt;Value&gt;34&lt;/Value&gt;\n  &lt;/qbo:Preference&gt;\n  &lt;qbo:Preference&gt;\n    &lt;Name&gt;TaxPercent&lt;/Name&gt;\n    &lt;Value&gt;4.5%&lt;/Value&gt;\n  &lt;/qbo:Preference&gt;\n&lt;/qbo:QboCompanyPreferences&gt;\n</code></pre>\n\n<p>I'm using XDocument like this:</p>\n\n<pre><code>XDocument doc = XDocument.Parse(serviceResponse);\nstring taxNodeName = \"TaxPercent\";\nXNamespace qbo = \"http://www.intuit.com/sb/cdm/qbo\";\n\nvar Preference = (from node in doc.Descendants(qbo + \"Preference\")\n                        where node.Element(\"Name\").Value == taxNodeName\n                        select node).FirstOrDefault();\n\nResponse.Write(Preference.ToString());\n</code></pre>\n"},{"tags":["query","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13061067,"title":"Repeated Query API vs. Storing in DB","body":"<p>I'm new to programming in general, and I'm trying to learn a lot.</p>\n\n<p>Here's my question: When querying an external DB using an API, when is it appropriate to actually store the data internally vs. continually querying. For example, if I want to query multiple sets of data for multiple users, it seems like loadtime will be very slow. </p>\n\n<p>At the same time, it seems excessive to store a ton of data on my own db. </p>\n\n<p>Sorry for the ambiguity here - I know this is very theoretically-heavy topic. Just wanted to get some insight here!</p>\n\n<p>Thanks for the responses</p>\n"},{"tags":["query","excel","vba","export"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13059900,"title":"Having trouble exporting multiple MS Access 2010 queries to MS Excel 2010 from one \"Form Load\" or \"Form Open\"","body":"<p>I tried this several different ways but it keeps stopping after the first one. I tried adding other forms, form 1 to run one on open, then form 1 opens form 2 which runs one export etc but that didn't work. I tried pausing, <code>do while not isloaded(next form)</code> etc but that didn't work.</p>\n\n<pre><code>Option Compare Database\nPrivate Sub Form_Load()\nOn Error GoTo Err_Form_Load\n\n'I tried 9\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"All-ActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"All-ActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\n\n'I tried 12 and 12XML\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllFilteredABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\n\n'I tried it as a function\n'see function below the three exports\n\nCall exportData(\"All-FilteredABC\", _\n\"Y:\\Projects\\Folders\\All-FilteredABC.xlsx\")\nCall exportData(\"AllActiveABC\", _\n\"Y:\\Projects\\Folders\\AllActiveABC.xlsx\")\nCall exportData(\"AllABC\", _\n\"Y:\\Projects\\Folders\\AllABC.xlsx\")\n\n\nFunction exportData(queryName As String, strSaveFileName As String)\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, queryName, strSaveFileName, True \n\nEnd Function\n</code></pre>\n\n<p>No luck. I am so confused by all the things I've tried and the different outcomes I've had like, creating a new blank sheet in the existing workbook but with an _1 at the end, stopping after one export, exporting them all but all blank.</p>\n"},{"tags":["java","query","data","dynamically-generated"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13056902,"title":"Use a db table to control from 5 to several hundred subroutine callsfrom one location","body":"<p>There is one thought of including code like this in a Jave application.</p>\n\n<pre><code>Evaluate External Type Code\nWhen 1 \n  Call L.Services Parm1, Parm2, Parm3,Parm4, Parm5, Parm6\nWhen 2 \n  Call T.Services Parm1, Parm2, Parm3\nWhen 3 \n  Call C.Services Parm1, Parm2, Parm3,Parm4, Parm5, Parm6\nWhen 4\n  Call D.Services Parm1, Parm2\nWhen 4\n  Call X.Services Parm1, Parm2, Parm3,Parm4, Parm5\nWhen other\n  Call Invalid\nEnd Evaluate\n</code></pre>\n\n<p>There will be likely additions of calls added over the development cycle.  I haven't developed anything in Java, my experience is mainframe assembler, COBOL, PL/1, and database applications.\nThe Parm fields can be to/from and there will be a different number of parms for each subroutine.</p>\n\n<p>I know this can be done in assembler, C and PL/1 however Java?</p>\n\n<p>My preference would be to have a small table with the name of the called routine and a list of all the parameters.<br>\nThis would allow the query of the CALL Table with the CALL ID to return the routine name and all parmaters. (as an array?)\nWith this method, there would not be any code changes in the controlling module to add new functionallity, only an insert into the CALL Table.</p>\n\n<p>Can this be done in Java?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13060176,"title":"MS Access SQL Query - Showing total number of orders in a certain year","body":"<p>Me again. SQL appears to be more complex than I anticipated. My problem: for each customer, I would like to show the Customer ID and the total number of orders placed in 2011.</p>\n\n<p>My table looks like this</p>\n\n<pre><code>Table: Order_t\nOrder_ID    Order_Date    Customer_ID\n--------    ----------    -----------\n1001        10/21/2011    1\n1002        10/25/2011    8\n1003        10/26/2011    15\n1004        10/27/2011    5\n1005        11/24/2011    3\n1006        11/27/2011    2\n1007        11/28/2011    11\n1008        12/3/2011     12\n1009        12/5/2011     1\n1010         1/16/2012    4\n</code></pre>\n\n<p>I would like my query to display a table like this:</p>\n\n<pre><code>Customer_ID    Orders_Placed\n-----------    -------------\n1              2\n2              1\n3              1\n5              1\n8              1\n11             1\n12             1\n15             1\n</code></pre>\n\n<p>My current query is this (I am currently completely neglecting the Date part because I haven't even figured out the grouping yet:</p>\n\n<pre><code>SELECT Customer_ID, SUM(Order_ID) AS Orders_Placed\nFROM Order_t\nGROUP BY Order_ID, Customer_ID\n</code></pre>\n\n<p>And this is my obviously wrong query: </p>\n\n<pre><code>Customer_ID    Orders_Placed\n-----------    -------------\n1              1001\n8              1002\n15             1003\n5              1004\n3              1005\n2              1006\n11             1007\n12             1008\n1              1009\n4              1010\n</code></pre>\n\n<p>Thanks for help, but I would also like to understand where the problem is in my logic. What crucial part do I seem to not understand?</p>\n\n<p>Thanks!</p>\n"},{"tags":["query","google-app-engine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13059763,"title":"Fetch a table from a url and store it in Google App Engine or Cloud Storage and using it with Big Query","body":"<p>I'm new to Google App Engine. Hope someone can help with my query.</p>\n\n<p>I want to scrap a table containing a stock's historical prices in Yahoo Finance or Google Finance using urlfetch and store it in Google Storage. Data needs to be refreshed regularly. </p>\n\n<p>I want to use BigQuery to query on prices on certain dates, find averages etc. similar to GoogleQuery in Google Apps. I have done this on Google Apps using Importhtml, ImportXml and GoogleQuery but I have concerns about filesize, execution limits etc. Hence, I want to migrate to Google App Engine.</p>\n"},{"tags":["sql","database","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13059732,"title":"MS Access SQL Query - Showing Total Quantity of product ordered by most popular","body":"<p>I have a table (Order_line_t) with the following format:</p>\n\n<pre><code>Order_ID    Product_ID    Quantity\n--------    ----------    --------\n1001        1             2\n1001        2             2\n1001        4             1\n1002        3             5\n1003        3             1\n1004        6             2\n1004        8             2\n1005        4             4\n1006        1             1\n1006        5             2\n1006        7             2\n1007        1             3\n1007        2             2\n1008        3             2\n1008        8             3\n1009        4             2\n1009        7             3\n1010        8             10\n</code></pre>\n\n<p>My goal is to show the total quantity that has been ordered by descending popularity for each product like this: (I used my current query and clicked on Descending Filter for Column Total_Quantity to achieve this result)</p>\n\n<pre><code>Product_ID    Total_Quantity\n----------    --------------\n8             15\n4             8\n3             8\n7             5\n1             5\n2             4\n6             2\n5             2\n</code></pre>\n\n<p>I have been trying to figure this out for 3 hours, and I don't know where I my error is. My current SQL Query is this:</p>\n\n<pre><code>SELECT  Product_ID, SUM(Quantity) AS Total_Quantity\nFROM Order_line_t\nGROUP BY Product_ID\n</code></pre>\n\n<p>My Query result is this:</p>\n\n<pre><code>Product_ID    Total_Quantity\n----------    --------------\n1             5\n2             4\n3             8\n4             8\n5             2\n6             2\n7             5\n8             15\n</code></pre>\n\n<p>Thanks in advance, I am just beginning to learn SQL. Please bear with me.</p>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13058861,"title":"What will happen if I kill a huge MySQL InnoDb DELETE Query?","body":"<p>I'm currently running a <code>DELETE</code> query that is taking a lot longer than expected (already 10hrs!). I would like to kill it through phpmyadmin processes, however am concerned about what might happen. Will the roll-back he automatically does take a lot of time also? Current query status shows \"updating\".</p>\n"},{"tags":["php","mysql","database","query","mongodb"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":90,"score":0,"question_id":12235369,"title":"A lot of queries with \"or\"","body":"<p>I'm trying to convert a database from MySQL to MongoDB but I have a problem. I do not know how the query should look for MongoDB.</p>\n\n<pre><code>   $hd='';\n   $count = count($args[1]);\n   for($i=0;$i&lt;$count-1;$i++){\n       $hd.=\"playerId='\" . $args[1][$i] . \"' OR \";\n   }\n   $hd.=\"playerId='\".$args[1][$count-1].\"'\";\n   $h1=mysql_query(sprintf(\"SELECT * FROM player where \".$hd));\n</code></pre>\n\n<p>Anyone know how to fix it?</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13058646,"title":"INSERT with SELECT works once","body":"<p>I have 3 tables on my SQLite db as follow:</p>\n\n<p>TABLE first_names</p>\n\n<pre><code>id\nname\ngender\n</code></pre>\n\n<p>TABLE last_names</p>\n\n<pre><code>id\nname\n</code></pre>\n\n<p>TABLE names</p>\n\n<pre><code>id\nfirst\nlast\ngender\nbirthday (null)\nused (default 0)\n</code></pre>\n\n<p>Where first and last are unique and also have a index with both being unique on the names table.</p>\n\n<p>In order to fed names table I have used the below query, which worked the first time but after I had added a new name to the last_names and tried to use it again it failed.</p>\n\n<pre><code>INSERT INTO names (first, last, gender) \n       SELECT f.name AS first, l.name AS last, f.gender AS gender \n              FROM first_names f \n              LEFT JOIN last_names l \n              WHERE f.name NOT IN (SELECT first FROM names) AND \n                    l.name NOT IN (SELECT last FROM names)\n</code></pre>\n\n<p>Have also tried using <code>(first, last, gender, [birthday], [used])</code> with values as <code>null AS [birthday], 0 AS [used]</code> but since it birthday is set to null on the table design and used to 0 as default and it worked on the first time didnt think it would be needed nor it made any difference anyway.</p>\n\n<p>I would think it is because of the unique fields however I do have a WHERE to make sure the names are not already in the table names.</p>\n\n<p>I have tried the query using C# and SQLiteAdmin both executing without requesting result or else it doesnt work.</p>\n\n<p>What is wrong with my query and why it only works once ?</p>\n"},{"tags":["php","mysql","database","query","website"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13057480,"title":"Updating information into a MySQL Database using PHP","body":"<p>Within my code, I'm attempting to update my database with values from modifiable text fields in a form. However, when the query is ran, it wipes all fields (turning them to \"\") related to the record the user is attempting to edit. Can anyone see why at all?</p>\n\n<pre><code>&lt;?php\n$dbuser = 'test';\n$dbpass = 'test';\n$host = '127.0.0.1';\n$db = 'test';\nmysql_connect($host, $dbuser, $dbpass) or die(mysql_error());\nmysql_select_db($db) or die(mysql_error());\n\n$result = mysql_query(\"SELECT * from characters\");\n$id = $_REQUEST['combo'];\nwhile($row = mysql_fetch_array($result))\n{\n    if($id == $row['_Key'])\n    {\n        echo \"&lt;form action=\\\"webpagetests.php\\\" method=\\'post\\'&gt;\";\n        echo \"&lt;strong&gt;Player ID:&lt;/strong&gt;    \" . $row['_Key'] . \"&lt;/br&gt;\";\n        echo \"&lt;strong&gt;Steam Name:&lt;/strong&gt;   \" . $row['_SteamName'] . \"&lt;/br&gt;\";\n        echo \"&lt;strong&gt;Steam ID:&lt;/strong&gt;     \" . $row['_SteamID'] . \"&lt;/br&gt;&lt;/br&gt;\";\n\n        echo \"Name: &lt;/br&gt;&lt;input name = \\\"name\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Name'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Cash: &lt;/br&gt;&lt;input name = \\\"cash\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Cash'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Flags: &lt;/br&gt;&lt;input name = \\\"flags\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Flags'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Gender:&lt;/br&gt; &lt;input name = \\\"gender\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Gender'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Model:&lt;/br&gt; &lt;input name = \\\"model\\\" type=\\\"text\\\" size=\\\"50\\\" value=\\\"\" . $row['_Model'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Faction: &lt;/br&gt;&lt;input name = \\\"faction\\\" type=\\\"text\\\" size=\\\"25\\\" value=\\\"\" . $row['_Faction'] . \"\\\"&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;\";\n        echo \"Recognised Names: &lt;/br&gt;&lt;input name = \\\"names\\\" type=\\\"text\\\" size=\\\"50\\\" value=\\\"\" . $row['_RecognisedNames'] . \"\\\"&lt;/br&gt;\";\n        echo \"&lt;input name=\\\"submit2\\\" type=\\\"submit\\\" value=\\\"Update\\\" /&gt;\";\n        echo \"&lt;/form&gt;\";\n    }\n}\nif (isset($_POST['submit2'])) \n{\n    //$name = mysql_real_escape_string(htmlspecialchars($_POST['name']));\n    $name = \"Test\";\n    $cash = (int)$_POST['cash'];\n    $flags = mysql_real_escape_string(htmlspecialchars($_POST['flags']));\n    $gender = mysql_real_escape_string(htmlspecialchars($_POST['gender']));\n    $model = mysql_real_escape_string(htmlspecialchars($_POST['model']));\n    $faction = mysql_real_escape_string(htmlspecialchars($_POST['faction']));\n    $names = mysql_real_escape_string(htmlspecialchars($_POST['names']));\n\n    mysql_query(\"UPDATE  `test`.`characters` SET  `_Name` =  '$name',\n    `_Cash` =  '$cash',\n    `_Model` =  '$model',\n    `_Flags` =  '$flags',\n    `_Gender` =  '$gender',\n    `_Faction` =  '$faction',\n    `_RecognisedNames` =  '$names' \n    WHERE  `characters`.`_Key` ='$id'\") or die(mysql_error());\n    echo '&lt;META HTTP-EQUIV=\"Refresh\" Content=\"0; URL=webpagetest.php\"&gt;'; \n}?&gt;\n</code></pre>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13057824,"title":"Show one title and multiple dates from sql query","body":"<p>New to sql and php and trying to work through this one.  After reading several examples here, I still can't seem to get this done.  Right now I have the following query </p>\n\n<pre><code>$sql = \"SELECT e.id, e.event_name, e.recurrence_id, e.start_date, e.venue_title FROM \" . wp_events_detail . \" e  WHERE e.recurrence_id &lt;&gt;0 or e.recurrence_id = 0 and is_active = 'Y' GROUP BY e.event_name, e.start_date\"  ;\n                $posts = $wpdb-&gt;get_results($sql);\n\n                print(\"&lt;ul&gt;\");\n                foreach ($posts as $post)\n                {\n                    print('&lt;li&gt;'.$post-&gt;event_name.'|'.$post-&gt;event_desc.'&lt;br/&gt;');\n\n                     print('&lt;/li&gt;');\n                    print($post-&gt;start_date. '~' .$post-&gt;venue_title.'&lt;br/&gt;'); \n                }\n                print(\"&lt;/ul&gt;\");\n</code></pre>\n\n<p>This produces\nName of Class A\nStart Date 1\nName of Class A\nStart Date 2\nName of Class B\nStart Date 1\nName of Class B\nStart Date 2</p>\n\n<p>what I would like is \nName of Class A\nStart Date 1\nStart Date 2</p>\n\n<p>Name of Class B\nStart Date 1\nStart Date 2</p>\n\n<p>I know I need an array and define rows - Have tried several options with no luck.  Not understanding all the variables etc defined in this answer (which seems what I want this to do)</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9253070/show-year-only-once-in-archives-loop\">Show year only once in archives loop</a></p>\n\n<p>Any help greatly appreciated!  Even a point in the right direction;-)</p>\n"},{"tags":["android","query","listview","join","mergecursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13057462,"title":"How to combine data from two database tables into one listView","body":"<p>I am quite confused about how to combine two separate database queries into one listView.</p>\n\n<p>Currently, my listView is populated by the following adapter which queries the damaged component table in my database and provides a list of damaged components for a certain location:</p>\n\n<pre><code>private class MyListAdapter extends ResourceCursorAdapter { \n\n    // In your ListActivity class, create a new inner class that extends ResourceCursorAdapter. \n    //This inner class is the custom CursorAdapter we will use to manage how data is bound to a list item:\n\n    public MyListAdapter(Context context, Cursor cursor) { \n        super(context, R.layout.row_location, cursor);\n    } \n\n    @Override\n    public void bindView(View view, Context context, Cursor cursor) { \n        TextView text_first_line = (TextView) view.findViewById(R.id.location_row_item_main_text);\n        TextView text_second_line = (TextView) view.findViewById(R.id.location_row_item_secondary_text);\n        ImageView flagIcon = (ImageView) view.findViewById(R.id.flagIcon);\n\n        String row_text_component = cursor.getString(cursor.getColumnIndex(RMDbAdapter.COMPONENT));\n        String row_text_position = \", Position \" + cursor.getString(cursor.getColumnIndex(RMDbAdapter.POSITION));\n        if(row_text_position.equals(\", Position Not Applicable\")){\n            row_text_position = \"\";\n        }\n        String row_text_action = \" - \" + cursor.getString(cursor.getColumnIndex(RMDbAdapter.ACTION_REQUIRED));\n\n        text_first_line.setText(row_text_component + row_text_position + row_text_action);\n        text_second_line.setText(\"Dexion Speedlock, S Duty, 3000mm\");\n\n        String risk = cursor.getString(cursor.getColumnIndex(RMDbAdapter.RISK));\n        if (risk.equals(\"Red Risk\")){\n            flagIcon.setImageResource(R.drawable.red_flag);\n        }\n        else if (risk.equals(\"Green Risk\")){\n            flagIcon.setImageResource(R.drawable.green_flag);\n        }\n        else if (risk.equals(\"No Risk\")){\n            flagIcon.setImageResource(R.drawable.note);\n        }\n\n    }\n}\n</code></pre>\n\n<p>This is triggered when I call the following when the activity is started:</p>\n\n<pre><code>private void setAdapter(){\n\n    // Get a Cursor for the list items\n\n    Cursor listComponentCursor = rmDbHelper.fetchDamagedComponentsForLocation(locationId);\n    componentCursorSize = listComponentCursor.getCount();\n    startManagingCursor(listComponentCursor); \n    // set the custom list adapter     \n    setListAdapter(new MyListAdapter(this, listComponentCursor));\n\n}\n</code></pre>\n\n<p>So I would also like to create a second query on a separate table (this time issues table) and add this to the listView under the list of damaged components.  </p>\n\n<p>Reading this <a href=\"http://stackoverflow.com/questions/3539684/listview-from-multiple-tables\">Listview from multiple tables?</a>, I believe that I should use a Join <strong>or</strong> Merge cursor.  However, from what I have researched I still have no idea how to integrate either concept into my code.</p>\n\n<p>Can anyone point me in the right direction please?</p>\n"},{"tags":["sql","sql-server-2008","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13057029,"title":"SQL query to filter out match results","body":"<pre><code>        SELECT TOP 92 PERCENT \n        Convert(DateTime,Floor(Cast((DateTime) as Float)*24)/24,0) AS SummaryDateTime,\n        MIN(APM_ApplicationAvailability.PercentAvailability) AS MIN_of_ApplicationAvailability,\n        Nodes.Caption AS NodeName \n\n        FROM \n        (Nodes INNER JOIN APM_AlertsAndReportsData ON (Nodes.NodeID = APM_AlertsAndReportsData.NodeId))  INNER JOIN APM_ApplicationAvailability ON (APM_AlertsAndReportsData.ApplicationId = APM_ApplicationAvailability.ApplicationID)\n\n\n        WHERE \n        ( DateTime BETWEEN 40907 AND 41205 )\n         AND  \n        (\n          (APM_AlertsAndReportsData.ApplicationName LIKE '%HTTP%') AND \n          (Nodes.Caption = 'www.example.com')\n        )\nGROUP BY Convert(DateTime,Floor(Cast((DateTime) as Float)*24)/24,0), \nNodes.Caption\n\n\nORDER BY SummaryDateTime ASC\n</code></pre>\n\n<p>Above query giving me following result, which attached as an image. <img src=\"http://i.stack.imgur.com/zCENr.png\" alt=\"enter image description here\"> </p>\n\n<p>I want to write a query to filter out all <code>0.00%</code> results so it will just gives only <code>0.00%</code> data, because i don't care about <code>100%</code> data. I don't know how to filter data. </p>\n"},{"tags":["django","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":35,"score":-3,"question_id":13056497,"title":"Can i get field in another by pk in django","body":"<p>Can i query by django like this below SQL command.</p>\n\n<pre><code>select pk_2 from table2 where (id = pk1);\n\n( Table1 )\npk_1 = 17\n\n( Table2 )\npk_2 = 15\nid = 17\n</code></pre>\n\n<p>Please T^T</p>\n"},{"tags":["php","mysql","sql","query","mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13048972,"title":"Calculating Mode within existing query to count rows in PHP and MySQL","body":"<p>I have a table <code>rel</code> with fields <code>id</code> <code>refid</code> <code>cellid</code> <code>cat</code> and some working PHP code to count the number of rows for each <code>cellid</code> and return this as an array for later use.</p>\n\n<pre><code>&lt;?php\n// connect to database\nrequire($DOCUMENT_ROOT . \"connect.php\");\n// count the number of relationships for each cell id\n  $cell_array = array();\n  if ($result = mysqli_query($link, \"SELECT cellid, COUNT(*) totalcount, cat FROM rel GROUP BY cellid\")) {\n    if (mysqli_num_rows($result)) {\n      while ($row = mysqli_fetch_assoc($result)) {\n        $cell_array[$row[\"cellid\"]] = $row['totalcount'];\n      }\n    }\n  }\n?&gt;\n</code></pre>\n\n<p>I now want to add an additional function, calculate the Mode (most common value) of <code>cat</code> for each <code>cellid</code> and include that value in the array. If there is more than one mode or no mode then return 9 (<code>cat</code> can only have values of 1 to 8).</p>\n\n<p>I've been reading around how to find the Mode and the common solution looks like this:</p>\n\n<pre><code>SELECT COUNT(*) frequency, cat, cellid\nFROM rel\nGROUP BY cat\nORDER BY COUNT(*) DESC\nLIMIT 1\n</code></pre>\n\n<p>But this does not return the most common <code>cat</code> for each <code>cellid</code> just the most common <code>cat</code> in general.</p>\n\n<p>I have been working using a sub-query</p>\n\n<pre><code>SELECT cellid, cat, COUNT( * ) \nFROM  `rel` \nGROUP BY cellid, cat\n</code></pre>\n\n<p>Which produces a row for each <code>cellid</code> <code>cat</code> combination, but I'm unsure how to then use this to find the total number of entries for each <code>cellid</code> and the the most common <code>cat</code> for each <code>cellid</code> </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have made some further progress, I now have a working query to find the mode <code>cat</code> for each <code>cellid</code></p>\n\n<pre><code>SELECT cellid, cat\nFROM rel t\nGROUP BY cellid, cat\nHAVING cat = ( \nSELECT cat\nFROM rel\nWHERE cellid = t.cellid\nGROUP BY cat\nORDER BY COUNT( * ) DESC , cat\nLIMIT 1 )\n</code></pre>\n\n<p>But I am still unsure how to combine the two queries are the output from one cannot be used in the other.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13052979,"title":"Many to Many restriction of one side","body":"<p>I have 3 tables</p>\n\n<pre><code>user\nid | etc |\n\ngame\nid | etc \n\nuser_game\nuser_id | game_id\n</code></pre>\n\n<p>I want to create a situation where <code>n</code> users couldn't create another game if and only if they already have a game between those <code>n</code> users.</p>\n\n<p>so for example, assume we have <code>user_ids: 1,2</code> and they're both playing in <code>game_id 1</code>, they can't create another game between them, they could however create a new game if <code>user_id 3</code> joins the game.</p>\n\n<p>Is it possible to query for such thing, if so - how could I go about it? tried playing with queries, joins, selects and where's for far too long :)</p>\n\n<p>EDIT: the end result should be that I query for severel users, and see if they're elgible to play together (ie. no records were found of those <code>n</code> users playing together).</p>\n"},{"tags":["string","query","mod-rewrite","rewrite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13047910,"title":"Remove query string - rewrite rule","body":"<p>How do i remove a query string from the end of a url?\nTo be more specific, this is my rewrite rule:</p>\n\n<pre><code>RewriteRule example-(.*).html$ examples/view-example.php?param1=parameter&amp;param2=$1&amp;split=-\n</code></pre>\n\n<p>and I want this to return a 404 or a redirect to <code>www.mydomain.com/example-one.html</code> :</p>\n\n<pre><code>www.mydomain.com/example-one.html?param1=parameter&amp;param2=one&amp;split=-\n</code></pre>\n\n<p>This is what i tried, it doesn't work:</p>\n\n<pre><code>RewriteCond %{REQUEST_URI}  /examples/view-example\\.php\nRewriteCond %{QUERY_STRING} param1=parameter&amp;param2=(.*)&amp;split=-\nRewriteRule ^(.*)$ http://mydomain.com/example-%1.html$\n</code></pre>\n\n<p>I think that <code>RewriteRule ^(.*)$ http://mydomain.com/example-%1.html$</code> isn't correct..</p>\n"},{"tags":["query","symfony2","doctrine","doctrine2","querybuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13053616,"title":"Doctrine2 QueryBuilder - variable in field name","body":"<p>I am trying to place a variable into the field name in the query , so I have a schema:</p>\n\n<pre><code>  id amazon - tesco - asda - happyshopper - \n\n  1   £5    - NULL  - NULL  -     £4.99\n  2   NULL  - £2.99 - NULL  -     NULL\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>$store = 'amazon'; \n\n$qb = $em-&gt;createQueryBuilder();\n        $products = $qb-&gt;select('p')-&gt;from('MyBundle:Product', 'p')\n        -&gt;where('p.:store IS NOT NULL')\n        -&gt;setParameter('store', $store)\n        -&gt;add('orderBy', 'p.onSale DESC')\n        -&gt;setMaxResults(40)\n        -&gt;getQuery()\n        -&gt;getResult();\n</code></pre>\n\n<p>Would return row 1. </p>\n\n<p>What I've done for :</p>\n\n<pre><code>-&gt;where('p.:store IS NOT NULL')\n-&gt;setParameter('store', $store)\n</code></pre>\n\n<p>Is incorrect and it errors. </p>\n\n<pre><code>-&gt;where(':store IS NOT NULL')\n-&gt;setParameter('store', $store)\n</code></pre>\n\n<p>does not error, but doesn't apply the store filter. </p>\n"},{"tags":["python","query","search"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13052762,"title":"python dictionary float search within range","body":"<p>Suppose I have some kind of dictionary structure like this (or another data structure representing the same thing.</p>\n\n<pre><code>d = {\n  42.123231:'X',\n  42.1432423:'Y',\n  45.3213213:'Z',\n  ..etc\n}\n</code></pre>\n\n<p>I want to create a function like this:</p>\n\n<pre><code>f(n,d,e):\n    '''Return a list with the values in dictionary d corresponding to the float n\n    within (+/-) the float error term e'''\n</code></pre>\n\n<p>So if I called the function like this with the above dictionary:</p>\n\n<pre><code>f(42,d,2)\n</code></pre>\n\n<p>It would return</p>\n\n<pre><code>['X','Y']\n</code></pre>\n\n<p>However, while it is straightforward to write this function with a loop, I don't want to do something that goes through every value in the dictionary and checks it exhaustively, but I want it to take advantage of the indexed structure somehow (or a even a sorted list could be used) to make the search much faster.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13053521,"title":"Combine two queries with different numbers of columns","body":"<p>I have two queries I want to combine into a single output, I can't use a UNIOn because they have different numbers of columns.</p>\n\n<p>The table is <code>ref</code> with fields <code>id</code> <code>refid</code> <code>cellid</code> <code>cat</code> all of which contain whole numbers </p>\n\n<p>Query 1: Finds the total number of rows for each unique <code>cellid</code></p>\n\n<pre><code>SELECT cellid, COUNT(*) totalcount, cat FROM rel GROUP BY cellid\n</code></pre>\n\n<p>Query 2: Finds the Mode (most common value) of <code>cat</code> for each unique <code>cellid</code></p>\n\n<pre><code>SELECT cellid, cat\nFROM rel t\nGROUP BY cellid, cat\nHAVING cat = (\nSELECT cat\nFROM rel\nWHERE cellid = t.cellid\nGROUP BY cat\nORDER BY COUNT(*) DESC, cat\nLIMIT 1\n)\n</code></pre>\n\n<p>To give an example of what I'm trying to do I want to query my table</p>\n\n<pre><code>id | refid | cellid | cat\n1  | 1     |  1     | 1\n2  | 2     |  2     | 2\n3  | 3     |  3     | 4\n4  | 1     |  1     | 2\n5  | 2     |  1     | 2\n6  | 3     |  1     | 3\n7  | 1     |  2     | 2\n8  | 1     |  1     | 2\n</code></pre>\n\n<p>and return</p>\n\n<pre><code>cellid | no_of_rows | Mode_of_cat\n 1     |  5         |  2\n 2     |  2         |  2\n 3     |  1         |  4\n</code></pre>\n"},{"tags":["string","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13051936,"title":"Redirect, and keep query string [javascript]","body":"<p>I want to create a re-direct in JavaScript for the following functionality;</p>\n\n<p>Once someone has landed on a webpage, there will be a JavaScript that will temporarily direct them onto a webpage (they will be on this webpage for a very short time, so the page can capture the cookie/IDs), and then redirected again to a different webpage;</p>\n\n<p>So for example:</p>\n\n<p>I land on www.bbc.co.uk?ID=1234, I then get directed to another webpage, which is carrying my query string, www.google.com?ID=1234, then immediately I get directed to the final webpage, www.facebook.com.</p>\n\n<p>And there maybe 1, or more query strings that will need to be carried over from bbc onto google. No query strings on the third and final webpage.</p>\n\n<p>I want to ask, if this is possible? It must be in JavaScript, I know to direct somebody in JS it's simply;</p>\n\n<p>So far, my workings as:</p>\n\n<blockquote>\n  <p>window.location.href =</p>\n</blockquote>\n\n<p>I can get the query strings by:</p>\n\n<blockquote>\n  <p>var vars = [], hash;\n      var q = document.URL.split('?')[1];\n      if(q != undefined){\n          q = q.split('&amp;');\n          for(var i = 0; i &lt; q.length; i++){\n              hash = q[i].split('=');\n              vars.push(hash[1]);\n              vars[hash[0]] = hash[1];\n          } }</p>\n</blockquote>\n\n<p>Help/Advise will be very appreciated! </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13049920,"title":"Left Join - Unknown Column Error 1054","body":"<p>I keep getting #1054 - Unknown column 'colour' in 'where clause'.</p>\n\n<p>A simplified version of my query is as follows.</p>\n\n<pre><code>SELECT *, \"red\" AS colour\nFROM (\n    SELECT *,'calls' AS 'tbl', id AS cid FROM calls) as c\nWHERE colour='red' \nORDER BY colour ASC, c.created_date DESC\n</code></pre>\n\n<p>If I remove the WHERE line the query executed fine and colour is recognised and all is well.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13050136,"title":"Register and call query in ElasticSearch","body":"<p>Is it possible to register query (like the percolate process) and call them by name to execute them.\nI am building an application that will let the user save search query associated with a label. I would like to save the query generated by the filter in ES.</p>\n\n<p>If I save the query in an index, I have to call ES first to retrieve the query, extract the field containing the query and then call ES again to execute it. Can I do it in one call ?</p>\n\n<p>The other solution is to register queries (labels with _percolator with an identifier of the user:\n/_percolate/transaction/user1_label1</p>\n\n<pre><code>{\n  \"userId\": \"user1\",\n  \"query\":{\n     \"term\":{\"field1\":\"foo\" }\n   }\n}\n</code></pre>\n\n<p>and when there is a new document use the percolator in a non indexing mode (filtered per userId) to retrieve which query match, and then update the document by adding a field  \"label\":[\"user1_label1\", \"user1_label2\"] and finaly index the document. SO the labelling is done at indexing time.</p>\n\n<p>What do you think ? \nThanks in advance.</p>\n"},{"tags":["query","client","postgresql","less"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":496,"score":2,"question_id":1982453,"title":"PSQL 8.3+ client query results display","body":"<p>Rather silly question, but I can't seem to find the answer in the docs or man pages.</p>\n\n<p>Starting with 8.3 I think, the psql CLI client will not display the results of a large query inline. It pipes to a 'less-like' result viewer that disappears when you hit q.</p>\n\n<p>This makes it very difficult to use data from the first query in subsequent queries or updates.</p>\n\n<p>Does anyone know of a switch or way to force psql to display the query results inline, like the old client did?</p>\n\n<p>edit: the \\x switch does this, but I need the multiple row view.</p>\n"},{"tags":["mysql","query","distinct"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13046634,"title":"Selecting distinct records that has last creation date in similar records","body":"<p>I have a table: <code>messages</code> with this structure:</p>\n\n<pre><code>`ID`   //  auto increment\n`SenderUserID`   // foreign key: `ID` from `User` table\n`ReceiverUserID`   // foreign key: `ID` from `User` table\n`Message`   \n`DateCreated`   // timestamp \n</code></pre>\n\n<p>I need to get distinct ReceiverUserIDs from table by this conditions: </p>\n\n<ol>\n<li>Sender user should have conversations with receiver users.</li>\n<li>Selected distinct <code>ReceiverUserID</code> should give us last <code>DateCreated</code> message.</li>\n</ol>\n\n<p>So in the results, I'll have user last conversations ordered by creation date DESC.</p>\n\n<p>When I distinct in select query, mysql return a first record, but I need maximum <code>DateCreated</code> for selected `ReceiverUserID to get last message in top of results.</p>\n\n<pre><code>SELECT DISTINCT `m`.`ReceiverUserID` AS `ID` FROM `messages` `m`\nWHERE (`m`.`SenderUserID` = :UserID OR `m`.`ReceiverUserID` = :UserID) \nORDER BY `m`.`DateCreated` DESC\n\n//:UserID means LogedInUserID\n</code></pre>\n\n<p><strong>It is good to know It will be exactly like facebook messages board.</strong></p>\n\n<hr>\n\n<pre><code>ID, SenderUserID, ReceiverUserID, Message,  DateCreated\n1, 12, 11, 'Hi admin', 2012-10-24 11:07:00\n2, 11, 12, 'Hi guy',  2012-10-24 11:08:00\n3, 11, 13, 'Hello dear customer',  2012-10-24 11:12:00\n4, 11, 13, 'Are you there?',  2012-10-24 11:13:00\n5, 13, 11, 'Hiiii',  2012-10-24 11:14:00  // last conversation betwen 11 &amp; 13\n</code></pre>\n\n<p>Current logedin user id: 11</p>\n\n<pre><code>SELECT `m`.`ReceiverUserID` AS `ID`, MAX(`m`.`DateCreated`) as `lastmsg` \nFROM `messages` `m` WHERE (`m`.`SenderUserID` = 11 OR `m`.`ReceiverUserID` = 11) \nGROUP BY `m`.`ReceiverUserID`\n</code></pre>\n\n<p>We have problem in this section:\nIt is not return our last conversation between 11 and 13 when receiver user answered the sender message, It will be not seen in results</p>\n\n<p>Results:</p>\n\n<pre><code>ID, lastmsg\n12, 2012-10-24 11:08:00\n13, 2012-10-24 11:13:00  // Should be: 13, 2012-10-24 11:14:00\n</code></pre>\n"},{"tags":["query","google-app-engine","gae-datastore","jdo"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13030340,"title":"Substring searching of text in Google App Engine Datastore entity","body":"<p>I have been working on with Google App Engine. I have found problem with searching sub strings and few other operations. The javax.jdo.Query provides options to set filter as per the need. There are several filters available like contains, inequality operators but I couldn't find any that matches my need.</p>\n\n<p>I am unable to find methods for following:\nHow to set query filter to </p>\n\n<ol>\n<li>search for a substring</li>\n<li>search by regular expression</li>\n<li>search by ignore case</li>\n</ol>\n\n<p>Is any of the above 3 operations possible with JDO?</p>\n"},{"tags":["sql","database","query","sqlite","design"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13050218,"title":"sqlite database: advanced SQL or redesign","body":"<p>I've been programming for several years, but I'm pretty new to SQL(ite).</p>\n\n<p>I'm designing a database for a sort of a bookkeeping program. What I've got so far:  </p>\n\n<pre><code>orders \n    (o INTEGER PRIMARY KEY, \n     customer INTEGER REFERENCES customers(c), \n     num_products INTEGER, \n     date STRING, \n     discount INTEGER, \n     comments TEXT, \n     status INTEGER)\n\no_products \n    (o INTEGER PRIMARY KEY REFERENCES orders(o), \n     p_0 INTEGER, \n     p_1 INTEGER, \n     p_2 INTEGER, etc.\n\no_qtys \n    (o INTEGER PRIMARY KEY REFERENCES orders(o), \n     q_0 INTEGER, \n     q_1 INTEGER, \n     q_2 INTEGER, etc.\n\no_prices \n    (o INTEGER PRIMARY KEY REFERENCES orders(o), \n     p_0 INTEGER, \n     p_1 INTEGER, \n     p_2 INTEGER, etc.\n</code></pre>\n\n<p>The customers and products tables are irrelevant.</p>\n\n<p>Now, this design works well for retrieving the products, quantities and prices in an order, but I'm not sure how to do something like <strong>figure out total quantity of a product ordered in all orders</strong>. I know I could run a lot of queries and sort through the data in my code, but I'm <strong>looking for one elegant query, something like SELECT sum(<em>ordered of this product</em>).</strong> I could turn the o_products table on its side, to list what orders each product is in, but then it would be hard to retrieve what products are in one specific order. I've done some searching, but I can't seem to find an answer.</p>\n\n<p>Is there a good way to do this, or should I redesign the database? If I should redesign it, <strong>how</strong>?</p>\n"},{"tags":["android","sql","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":12974150,"title":"android sqlite how to order by time","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8948435/how-do-i-order-my-sqlite-database-in-descending-order-for-an-android-app\">How do i order my SQLITE database in descending order, for an android app?</a>  </p>\n</blockquote>\n\n\n\n<p>I've the following table where i'd like to select the contents of the table but order by the C_TAG_SCAN_TIME field DESC. </p>\n\n<pre><code>public static final String C_ID = BaseColumns._ID; // special for id internally in system\n    public static final String C_TYPE = \"type\";\n    public static final String C_COMPANY_ID = \"companyid\";\n    public static final String C_PERSON_ID = \"person\";\n    public static final String C_NAME = \"name\";\n    public static final String C_TAG_ID = \"tagid\";\n    public static final String C_STATUS = \"status\";\n    public static final String C_TAG_SCAN_TIME = \"tagscantime\";\n    public static final String C_TAG_SENTSERVER_TIME = \"tagsentservertime\";\n    public static final String C_TRANSACTIONS_LATITUDE = \"transactionslatitude\";\n    public static final String C_TRANSACTIONS_LONGITUDE = \"transactionslongitude\";\n</code></pre>\n\n<p>.</p>\n\n<p>This is my query to select everything from the table TRANSACTIONS.</p>\n\n<pre><code>return db.query(DBHelper.TABLETRANSACTIONS, null, null, null, null, null, null);\n</code></pre>\n\n<p>My question is how can i change the query to order descendingly on the C_TAG_SCAN_TIME column?</p>\n"},{"tags":["java","query","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13048733,"title":"Quering depending on children id","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3492018/how-to-write-jpa-query-where-parameter-is-a-set\">How to write JPA query where parameter is a set?</a>  </p>\n</blockquote>\n\n\n\n<p>I have 2 entities</p>\n\n<pre><code>@Entity\npublic class Container {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    Long id;\n\n    @ManyToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    Set&lt;Child&gt; data = newHashSet();\n}\n@Entity\npublic class Child {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    Long id;\n}\n</code></pre>\n\n<p>Now I want select all containers that contains specified child.\nI wrote jpa query <code>select c from Container c where :child in c.data</code> that produce sql</p>\n\n<pre><code>select \n    container0_.id as id4_ \nfrom \n    Container container0_ \n    cross join Container_Child data1_, Child child2_ \nwhere \n    container0_.id=data1_.Container_id \nand data1_.data_id=child2_.id \nand (? in (.)) \nlimit ? [42001-168]\n</code></pre>\n\n<p>and fails with <code>JdbcSQLException</code>. How can I fix it?</p>\n"},{"tags":["java","sql","query","hibernate","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13049137,"title":"hibernate native query, count","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1372317/how-do-we-count-rows-using-hibernate\">How do we count rows using Hibernate?</a>  </p>\n</blockquote>\n\n\n\n<p>I want count number of records by criteria in database.<br>\nI try use next query  </p>\n\n<pre><code>String queryString = \"SELECT Count(*) FROM my_table\";  \nQuery query = entityManager.createNativeQuery(queryString);  \n</code></pre>\n\n<p>but there is no method to execute this <code>Query query</code> and get result.<br>\nI know, that I can count records using   </p>\n\n<pre><code>String queryString = \"SELECT * FROM my_table\";  \nQuery query = entityManager.createNativeQuery(queryString); \nquery.getResultList().size();  \n</code></pre>\n\n<p>so question, is query with <code>Count(*)</code> more performance, and if <code>yes</code>, then how can I execute query with <code>Count(*)</code>?</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13047833,"title":"How to identify the the sql exec() execute a command properly","body":"<p>If i run a sql EXEC() command, then how i confirm that the command is executed properly.Because i don't find any success/failure return type of this command.\nLet say my command is: </p>\n\n<pre><code>EXEC('INSERT into '+@t1+'('+@c1+') values ('+@v1+')')\n</code></pre>\n\n<p>or any other way to be confirm that, the command is execute properly into the destination table.</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13047746,"title":"Changing column name in a SQL Server table with 1000+ records","body":"<p>I have a column and want to change its name but nothing else using query, what would be the best way of doing it.</p>\n"},{"tags":["sql","query","join","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13047972,"title":"SQL Join setting value from table2 to table1 where id is the same","body":"<p>i've the following table</p>\n\n<pre><code>+-----+------+\n| sID | name |\n+-----+------+\n|   2 | MXX  |\n|   3 | ISS  |\n|   4 | FSS  |\n|   5 | SSA  |\n|   6 | PSA  |\n+-----+------+\n</code></pre>\n\n<p>and the following table</p>\n\n<pre><code>+-----+-------+\n| sID | pname | \n+-----+-------+\n|   1 | qqq   |      \n|   1 | yyy   |         \n|   2 | zzz   |\n|   1 | lll   |\n|   2 | mmm   | \n|   3 | ttt   |\n|   3 | sss   |\n|   5 | xxx   |\n|   5 | iii   |\n+-----+-------+\n</code></pre>\n\n<p>and the join result should look like</p>\n\n<pre><code>+-----+-------+----------+\n| sID | pname | supplier |\n+-----+-------+----------+\n|   1 | qqq   |          |\n|   1 | yyy   |          |\n|   2 | zzz   | MXX      |\n|   1 | lll   |          |\n|   2 | mmm   | MXX      |\n|   3 | ttt   | ISS      |\n|   3 | sss   | ISS      |\n|   5 | xxx   | SSA      |\n|   5 | iii   | SSA      |\n+-----+-------+----------+\n</code></pre>\n\n<p>idea is to put the values of column <code>name</code> from first table in the second table where <code>sID</code> is the same</p>\n\n<p>i tried <code>Select * From TABLE1  c LEFT join TABLE2 T on c.sID=T.sID</code></p>\n"}]}
{"total":20739,"page":8,"pagesize":100,"questions":[{"tags":["android","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13047321,"title":"Update table using RawQuery() methos des not work","body":"<p>I tried the following SQLite query:</p>\n\n<pre><code>    int idServizo = 150;\n    String whereClause = id_servizio+\" = '\"+idServizio+\" ' \";\n    ContentValues cv = new ContentValues();\n    cv.put(\"sync\", 1);\n\n    int r = dbManager.updateTable(\"myTable\", cv, whereClause);\n</code></pre>\n\n<p>where fields sync and id_servizio are both integer.\nthe method updateTable is:</p>\n\n<pre><code> public int updateTable(String table, ContentValues values, String whereClause){\n    int r = mDb.update(table, values, whereClause, null);\n    return r;\n}\n\n // mDb is SQLiteDatabase object\n</code></pre>\n\n<p>All this works good. \nBut if I try with RawQuery() method defined as:</p>\n\n<pre><code> public Cursor RawQuery(String sqlQuery, String[] columns){\n    return mDb.rawQuery(sqlQuery, columns);    \n}\n</code></pre>\n\n<p>the table is not update! even if no error occurs.</p>\n\n<pre><code> int idServizo = 150;\n String updateQuery =\"UPDATE myTable SET sync = 1 WHERE id_servizio = \"+idServizio;\n dbManager.RawQuery(updateQuery, null);\n</code></pre>\n\n<p>Why this solution does not work?</p>\n"},{"tags":["query","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13036328,"title":"Update Query Access","body":"<p>I am trying to update a field inside one table, \"Todays_Deliveries\", from another table called \"Current_Delivery\". The field is a number field called \"Remaining\" which describes how many units there are of a particular item left on the daily deliveries.</p>\n\n<p>The \"Todays_Deliveries\" table is generated using an APPEND query from another master table with every delivery stored in it. Everytime the user opens a delivery on a form anything in the \"Current_Delivery\" table is removed using a DELETE query and then generated based on the delivery selected using an APPEND query from the \"Todays_Deliveries\" table.</p>\n\n<p>Both tables have identical fields and identical values, given one is generated from the data of the other.</p>\n\n<p>I have tried to create an UPDATE query to update the \"Todays_Deliveries\" table when a user edits the \"Current_Delivery\" table but it doesn't work. I recieve no error messages the field just doesn't update. The steps I took were as follows:</p>\n\n<ol>\n<li>Add both tables.</li>\n<li>Change to UPDATE query.</li>\n<li>Link tables using the Remaining field.</li>\n<li>Set the Field: Remaining and </li>\n<li>Set the Table: Current_Delivery.</li>\n<li>Set Update To: [Todays_Deliveries].[Remaining].</li>\n</ol>\n\n<p>Any advice/help would be greatly appreciated.</p>\n\n<p>EDIT:</p>\n\n<p>BEFORE:</p>\n\n<p><strong>Todays_Deliveries</strong></p>\n\n<pre><code>ID   Date      Time  Ref  Studio Description Total Remaining\n3187 23-Oct-12 10:00 3663 ROCK   PINK        1900  1900\n</code></pre>\n\n<p><strong>Current_Delivery</strong></p>\n\n<pre><code>ID   Date      Time  Ref  Studio Description Total Remaining\n3187 23-Oct-12 10:00 3663 ROCK   PINK        1900  1000\n</code></pre>\n\n<p>AFTER:</p>\n\n<p><strong>Todays_Deliveries</strong></p>\n\n<pre><code>ID   Date      Time  Ref  Studio Description Total Remaining\n3187 23-Oct-12 10:00 3663 ROCK   PINK        1900  1000\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I've got the query working using the below function</p>\n\n<pre><code>UPDATE Todays_Deliveries SET Remaining = DLookup(\"Remaining\",\"Current_Delivery\",\"[MP-Ref] = Form![MP-Ref] And [Cat No] ='\" &amp; [Cat No] &amp; \"'\")\nWHERE \"[MP-Ref] = Form![MP-Ref] And [Cat No] ='\" &amp; [Cat No] &amp; \"'\";\n</code></pre>\n\n<p>Where <em>MP-Ref</em> is the delivery reference that list a number of items, and <em>Cat No</em> is the individual item reference.</p>\n\n<p>The only problem is the other items in the _Daily_Deliveries_ table, the ones not in the _Current_Delivery_ table, have there remaining field set to 0 when I run it. Is there anyway to stop this?</p>\n"},{"tags":["c#","sql","visual-studio-2010","query","methods"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13043910,"title":"SQL query throws error C#","body":"<p>I have created a database and display the data in a gridview. I am trying to enable a method that searches for an employee's name and returns the results. </p>\n\n<p>The following SQL displays correct rows when the EXACT NAME is entered. -</p>\n\n<pre><code>SELECT personID, name, address, phoneNumber, age FROM dbo.person WHERE name Like @name \n</code></pre>\n\n<p><strong>I want to be able to display rows where the name is correct and partially correct.</strong> </p>\n\n<p>I have tried the following SQL - </p>\n\n<pre><code>SELECT personID, name, address, phoneNumber, age FROM dbo.person WHERE name Like @name% \n</code></pre>\n\n<p>But it throws the error \"no overload for method 'searchName' takes 2 arguments\".  </p>\n\n<p>When the \"search\" button is clicked, the following code is executed:</p>\n\n<pre><code>        this.personTableAdapter.searchName(this.personDataSet.person,\n        searchTextBox.Text);\n</code></pre>\n"},{"tags":["mysql","database","query","search","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":10059096,"title":"What is the most efficient approaches to advance search/sort database (MySql) information?","body":"<p>I'm curious what the popular opinion is for creating an advanced searching/sorting function for a database. I'm thinking something like these examples; <a href=\"http://www.amazon.com/gp/browse.html?node=241582011\" rel=\"nofollow\">Amazon</a> or <a href=\"http://www.cars.com/for-sale/advancedsearch.action\" rel=\"nofollow\">Cars.com</a>.</p>\n\n<p>I'm looking to use MySql and searching would be done completely by select, radio, and checkboxes. I would like to use chained select boxes much like the cars.com example where if a user does not make a selection all results for that category will be shown. I also want to make sure and keep myself secure, avoiding sql injection. </p>\n\n<p>My original design allowed for selections to be made by select boxes where if no selection was made it passed a variable to the sql SELECT statement but it seems dirty and long (mysql_real_escape_string not included). I have to establish a variable for each possible, searchable, category like so.</p>\n\n<pre><code>}\nif(!$_POST['ex1']) {\n$ex1='%';\n}\nelse {\n$ex1=$_POST['ex1'];\n}\n</code></pre>\n\n<p>Then I must use a select statement like</p>\n\n<pre><code>SELECT * FROM table WHERE ex1 LIKE '$ex1' AND ex2 LIKE '$ex2' AND numEx BETWEEN '$numEX1' AND '$numEX2' AND ex3 LIKE '$ex3' ORDER BY ex1  \n</code></pre>\n\n<p>I started with a very simple and clean version of this but as my needs grew I have developed what I feel is ugly and inefficient. Since I am needing to expand significantly, I thought now would be the best time to start from scratch.</p>\n\n<p>I'd love to hear others opinions as I know this self-made solution is far from best. I'm obviously not a professional, just a personal hobby and taking care of my needs independently.</p>\n"},{"tags":["database","query","mongodb","mongodb-csharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13046121,"title":"Insert documents into MongoDB only if all fields are unique","body":"<p>I have the following class structure:</p>\n\n<pre><code>public class DBTestItem\n{\n    public int p0;\n    public int p1;\n    public int p2;\n    public int p3;\n    public int p4;\n    public int p5;\n    public int p6;\n    public int p7;\n    public string data;\n}\n\npublic sealed class MongoTestItem : DBTestItem\n{\n    public ObjectId _id;\n}\n</code></pre>\n\n<p>_id is meaningless to me. p0 - p7 represent a composite key, and data represents the value.</p>\n\n<p>I want to save <code>MongoTestItem</code> documents where data is unique, and ideally without performing updates as they would be meaningless. In other words, save if data's value does not exist in the collection.</p>\n\n<p>I have looked at the documentation, but can't quite find how to write the statement to meet the above.</p>\n\n<p>I did create a different structure where p0 - p7 makes a composite _id and data is a List, in which case the statement is as follows:</p>\n\n<pre><code>var query = Query&lt;MdbData&gt;.EQ(x =&gt; x._id, doc._id);\nvar update = Update&lt;MdbData&gt;.Push(x =&gt; x.data, \"somenewvalue\");\ncol.Update(query, update, UpdateFlags.Upsert);\n</code></pre>\n\n<p>This has different semantics, so the upsert is OK.</p>\n\n<p>I want to write the above so I can evaluate the performance difference.</p>\n"},{"tags":["php","sql","query","cs-cart"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13046049,"title":"SQL Query or PHP Query from Excel Sheets","body":"<p>My suppliers in South Africa do not use live xmls for their stock lists.</p>\n\n<p>Each of our suppliers stock lists ( excel pricelists ) have very different layouts. The only way I currently do updates is by copying the code and the price into a new excel csv sheet and import. Then the product codes that it can’t pickup will automatically be put in the “products” category with just the code and the price. The rest I do manually. Adding the short description, product name and correct category.</p>\n\n<p>Is there anyway to make this more automated. We currently have over 15 different pricelists and in excess of 30k products. </p>\n\n<p>I want it to automatically fetch the products image from google based on the products name. Automatically add it to the correct category? I assume I would have to set conditions such as code starting with MO- go to computers///peripherals///mouses. Or for it to ask me to set conditions to look for in product code or short descriptions then it will do the rest?</p>\n\n<p>I also want that when a product is missing from the pricelists it gets hidden.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13046020,"title":"How to add ten new columns to SQL table with 1000+ records in it without losing any single record","body":"<p>I am looking for query that I can use to add ten new boolean columns to existing table without effecting anything else in database. Also by default these boolean columns should be set to true as default.</p>\n\n<p>Looking for best practices.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>\"Also by default these boolean columns should be set to true as default.\"</p>\n\n<p>Sorry I meant to say that for records already exists new column should have value set as true, there shouldn't be any default value as I will set it myself.</p>\n"},{"tags":["database","query","postgresql","indexing","database-optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13044668,"title":"Index not getting dropped on PostgreSQL","body":"<p>I was trying to figure out what is faster while querying a db:\n1. Chaining queries.\n2. Joins.</p>\n\n<p>So, I used EXPLAIN (QUERY) for both types for same query, and the result for chaining (1) was faster than joins (2).</p>\n\n<p>Then I tried to optimize it by indexing one column.</p>\n\n<p>The result of indexing was awesome. Both of my query got optimized tremendously, almost by 10 times. Again, chaining outperformed joins and this time on higher margin.</p>\n\n<p>Now, I wanted to drop the index on the table (that I created). DROP INDEX ran successfully but the query run time is still the same (i.e. the optimized one). I have checked that the index does no longer exist and even restarted system (making sure that no temporary storage), but still performance is the same. So now I can't understand what actually happened?</p>\n\n<p>P.S: I need to revert back to original to check other queries on that scenario.</p>\n\n<p>O/P for \\dt tablename:</p>\n\n<pre><code> Schema |       Name        | Type  | Owner  \n--------+-------------------+-------+--------\n public | feedback          | table | xxx\n</code></pre>\n\n<p>O/P for ANALYZE for chaining:</p>\n\n<p><a href=\"http://explain.depesz.com/s/Rner\" rel=\"nofollow\">http://explain.depesz.com/s/Rner</a></p>\n\n<p>O/P for ANALYZE for JOIN:</p>\n\n<p><a href=\"http://explain.depesz.com/s/6Hr\" rel=\"nofollow\">http://explain.depesz.com/s/6Hr</a></p>\n\n<p>These are the o/p after I indexed itemid in feedback table. Now I can't go back to my previous state (no index)</p>\n\n<p>The data-set is very low... But my main question is not about which one is faster, but why didn't my index got deleted? </p>\n"},{"tags":["vb.net","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12967418,"title":"Read information from text file and display in listbox","body":"<p>I am trying to figure out how to have one form where the user writes in the information they want to see on another form in a listbox. basically the user would write in the details that they want (title, author, stock, price, fiction or nonfiction) and then would press record details and the program would search a text file for those values and then another form would come up with a listbox where they would see all those selected books.</p>\n\n<p>Here is the code I have so far and it basically reads the text file information and stores it into an array:</p>\n\n<pre><code>    Dim Title As String\n    Dim Author As String\n    Dim Stock As Integer\n    Dim Price As Double\n    Dim Fiction As String\n    Dim NonFiction As String\n\nPrivate Sub btnRecord_Click(sender As System.Object, e As System.EventArgs) Handles btnRecord.Click\n\n\n    ''Read the information into a string''\n    Dim objReader As New StreamReader(\"C:\\Users\\Books.txt\")\n    Dim fileString As String = objReader.ReadToEnd()\n    objReader.Close()\n    objReader.Dispose()\n\n    ''Concert string into array''\n    Dim Array As Char() = fileString.ToCharArray()\n    Array(0) = CChar(\"BookName\")\n\n    ''Declare the string to hold the value''\n    Dim resultString As String = \",\"\n\n    ''Increment each item in the string''\n    Dim curChar As Char\n    For i As Integer = 0 To (Array.Length - 1)\n        curChar = Array(i)\n        If (Char.IsLetterOrDigit(curChar)) Then\n            Array(i) = Chr(Asc(curChar) + 1)\n        End If\n    Next\n\n    ''Conver the array back to string''\n    Dim newString As String = New String(Array)\n\n    ''Hide the details form when book inventory runs''\n    Me.Hide()\n\n    ''display inventory form''\n    frmInventory.Show()\n\nEnd Sub\n</code></pre>\n"},{"tags":["mysql","query","max","min"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":9668586,"title":"Use mysql to work out in and out times of vehicle at customer, multiple stops and entries for each customer","body":"<p>I have a mysql table that contains data as per the screenshot below.</p>\n\n<p>My requirement is to generate a mysql query that will show me the in and out time for each customer.\nthe issue I have is that I cannot use min or max as the vehicle might have visited the same customer two or three times within a period.</p>\n\n<p>So the output I am looking for is:</p>\n\n<pre><code>Vehicle: RB10\nCustomer: Hulamin\nIn: 10:19\nout: 10:35\nTime Taken: 16 min\nIn: 11:14\nout: 11:29\nTime Taken: 15 min\nave time taken: 15.5 min\n</code></pre>\n\n<p>and the same for each of the other sites and vehicles as required.</p>\n\n<p>How do I tell mysql to take the smallest in time before the corresponding out time and report?</p>\n\n<p>Many thanks for the assistance.</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12998043,"title":"Difference in outcome query between PhpMyAdmin en PDO","body":"<p>I have the following query being prepared in PHP/PDO.</p>\n\n<pre><code>SELECT\n    count(distinct(p.accid)) as aantal\nFROM \n    winter_accommodaties_prijzen p\nINNER JOIN winter_accommodaties a ON (a.id = p.accid)\nINNER JOIN winter_dorpen d ON (d.id = a.did)\nINNER JOIN winter_gebied g ON (g.id = d.gid)\nINNER JOIN winter_accommodaties_types t ON (a.tid = t.id)\nWHERE\n    g.lid IN(:lid0) AND \n    g.min_hoogte &gt;= :hoogte AND\n    (g.pistes_groen+g.pistes_blauw+g.pistes_rood+g.pistes_zwart) &gt;= :km AND \n    d.hoogte_dorp &gt;= :hoogte_dorp AND \n    d.afstand_utrecht &lt;= :afstand_utrecht AND \n    prijs &lt; : max_prijs AND \n    p.persons &gt;= :aantal_personen\n</code></pre>\n\n<p>Then I bind the following array to this query:</p>\n\n<pre><code> Array\n (\n  [:lid0] =&gt; 1\n  [:hoogte] =&gt; 500\n  [:km] =&gt; 50\n  [:hoogte_dorp] =&gt; 500\n  [:afstand_utrecht] =&gt; 2500\n  [:max_prijs] =&gt; 1200\n  [:aantal_personen] =&gt; 4\n )\n</code></pre>\n\n<p>Running this via PHP I get as a result for 'aantal': 97 (results).\nIf I run the above query, replacing all the variables with their corresponding value, I get via PhpMyAdmin 124 results. Running the same query on the old fashion way in PHP using mysql_query, I also get 124 results.</p>\n\n<p>What am I missing in the PDO query that results in the difference?</p>\n\n<p>UPDATE to the request of AL_ => Creation of the PDO connection:</p>\n\n<pre><code>$conn = new PDO(DB_DSN, DB_USER, DB_PASSWORD);\n$conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n$query = \"See query above\"\n\n$query_pag_no = $conn-&gt;prepare($query); // the above query\n$query_pag_no-&gt;execute($bind_array);    // the above array\n\n$aantal_resultaten = $query_pag_no-&gt;fetchColumn();\n</code></pre>\n\n<p>The outcome in $aantal_resultaten is then 97 (rows).</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13044490,"title":"Mysql group post_id by max count status","body":"<p>hi i have an mysql query where it will return post_id by max counts of status, The result it display currently is </p>\n\n<pre><code>POST_ID\n\n    3\n</code></pre>\n\n<p>Mysql Table:</p>\n\n<pre><code>(`post_id`, `user_id`, `status`, `date_created`)\n(2, 2, 'funny', 20121022120627)\n(2, 3, 'lame', 20121023120627)\n(3, 1, 'useful', 20121023120627)\n(3, 3, 'lame', 20121023120627)\n(3, 4, 'useful', 20121023120627)\n(4, 4, 'useful', 20121024120627)\n</code></pre>\n\n<p>But the result i need is, to display the count from max to min on desc order.if 2 result having same number, then the top result will be based on the latest date_created similar like this</p>\n\n<pre><code>POST_ID\n\n     3\n     2\n     4\n</code></pre>\n\n<p>My current query is</p>\n\n<pre><code>SELECT post_id\nFROM tableName\nGROUP BY post_ID\nHAVING COUNT(*) = \n(\n    SELECT MAX(x.counts)\n    FROM\n    (\n        SELECT post_id, COUNT(*) counts\n        FROM tableName\n        GROUP BY post_id\n    ) x\n)\n</code></pre>\n\n<p>The sample can be found on SQLFiddle <a href=\"http://sqlfiddle.com/#!2/a515e/1\" rel=\"nofollow\">SQLFiddle</a></p>\n"},{"tags":["mysql","query","indexing","database-management","mysql-slow-query-log"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13041479,"title":"how to determine slow queries?","body":"<p>My site is experiencing a really slow loading time. I have suspected that it might be javascript or php that causes longer loading time but i have tested my  site in YSlow and its grade is B which i think is not bad.</p>\n\n<p>Now i want to check my database if something is wrong with queries, database indexing that causes my site to load slower.</p>\n\n<p>Is there some tutorials or tricks i might read or try to test database to figure out if there is slow queries? Any tips for database management?</p>\n"},{"tags":["java","query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13043731,"title":"Cursor limit in mongoDB","body":"<p>Iam using mongo as an db for my web app. Java code queries the data from mongo. Curntly there is >40000 in mongo . In one of my api it will return all that documents. So i need only 50 documents to show on the web page. I have tried <code>cursor.limit(50)</code> but it only reduces the time taken by while loop. so i think the whole time is taking from this code <code>DBCursor cursor=collection.find(query,field)</code> . Any ways to reduce it..?.</p>\n"},{"tags":["php","mysql","wordpress","query","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13042844,"title":"need help optimizing wordpress meta_query","body":"<p>I would some help in optimizing this wordpress query, it currently takes 100% cpu usage and have never got the chance for it to finish:</p>\n\n<pre><code>SELECT wp_posts.* FROM wp_posts INNER JOIN wp_postmeta ON (wp_posts.ID = wp_postmeta.post_id)\nINNER JOIN wp_postmeta AS mt1 ON (wp_posts.ID = mt1.post_id)\nINNER JOIN wp_postmeta AS mt2 ON (wp_posts.ID = mt2.post_id)\nINNER JOIN wp_postmeta AS mt3 ON (wp_posts.ID = mt3.post_id)\nINNER JOIN wp_postmeta AS mt4 ON (wp_posts.ID = mt4.post_id)\nINNER JOIN wp_postmeta AS mt5 ON (wp_posts.ID = mt5.post_id)\nINNER JOIN wp_postmeta AS mt6 ON (wp_posts.ID = mt6.post_id)\nINNER JOIN wp_postmeta AS mt7 ON (wp_posts.ID = mt7.post_id)\nINNER JOIN wp_postmeta AS mt8 ON (wp_posts.ID = mt8.post_id)\nINNER JOIN wp_postmeta AS mt9 ON (wp_posts.ID = mt9.post_id)\nINNER JOIN wp_postmeta AS mt10 ON (wp_posts.ID = mt10.post_id) WHERE 1=1 AND wp_posts.post_type = 'produkter' AND (wp_posts.post_status = 'publish' OR wp_posts.post_status = 'private') AND (wp_postmeta.meta_key = 'csv_product_month_sub'\nOR (mt1.meta_key = 'csv_product_type' AND CAST(mt1.meta_value AS CHAR) = 'Mobilt Bredbaand')\nOR (mt2.meta_key = 'csv_product_consumption' AND CAST(mt2.meta_value AS SIGNED) BETWEEN '0' AND '2')\nOR (mt3.meta_key = 'csv_product_consumption' AND CAST(mt3.meta_value AS SIGNED) BETWEEN '3' AND '9')\nOR (mt4.meta_key = 'csv_product_consumption' AND CAST(mt4.meta_value AS SIGNED) BETWEEN '10' AND '19')\nOR (mt5.meta_key = 'csv_product_download' AND CAST(mt5.meta_value AS SIGNED) BETWEEN '2' AND '9')\nOR (mt6.meta_key = 'csv_product_download' AND CAST(mt6.meta_value AS SIGNED) BETWEEN '10' AND '19')\nOR (mt7.meta_key = 'csv_product_download' AND CAST(mt7.meta_value AS SIGNED) BETWEEN '20' AND '29')\nOR (mt8.meta_key = 'csv_product_month_sub' AND CAST(mt8.meta_value AS SIGNED) BETWEEN '0' AND '49')\nOR (mt9.meta_key = 'csv_product_month_sub' AND CAST(mt9.meta_value AS SIGNED) BETWEEN '50' AND '99')\nOR (mt10.meta_key = 'csv_product_month_sub' AND CAST(mt10.meta_value AS SIGNED) BETWEEN '100' AND '149') ) GROUP BY wp_posts.ID ORDER BY wp_postmeta.meta_value+0 ASC \n</code></pre>\n"},{"tags":["mysql","sql","query","insert"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":64,"score":4,"question_id":12600527,"title":"Accessing last inserted row in mysql","body":"<p>On my db-server i am inserting data in a table having a auto increment field say 'id'. Now i want to use the value of this last inserted 'id' in subsequent steps. I can use this:-</p>\n\n<pre><code>  select * from table_name order by id desc limit 1; \n</code></pre>\n\n<p>But the problem here is, it is a server and many more insertions could be happening and there could be a case where i try to retrieve the data with the query i mentioned and get a different id ie. between my insert and select there could be some other insert and i wont get the value i inserted. Any way in which this could be addressed.?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","sql","visual-studio-2010","query","arguments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13043326,"title":"SQL Query accept a valid argument C#","body":"<p>I have created a database and have presented the data in a gridview using Visual Studio C#. I am trying to write a query method that will search for an employee's name and return all results that are similar to the name. </p>\n\n<pre><code>SELECT personID, name, address, phoneNumer, age FROM dbo.person WHERE name Like @name\n</code></pre>\n\n<p>Any advice/help on this would be hugely appreciated. I can't seem to find a solution. </p>\n"},{"tags":["php","mysql","query","checkbox","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":2286115,"title":"When exactly are PHP-MySQL variable assignments made?","body":"<p>[Status: learner] \nUsing checkboxes, the user selects rows from a displayed HTML table.  I then want to insert the date and the unique row id (\"select_id\") of the selected ('ticked') rows into a different table.  Maybe I'm off-base, but it seems to me that the first block of code <strong>does not work</strong>.  The second block of code <strong>does work</strong>.  If I'm correct, it appears that it matters where the $SQL statement is made.  WHY?  I mean, no variable assignments are made until the $sql is called by the mysql_query() function, right?</p>\n\n<p>(...If I'm wrong, nevermind, it is just a normal evening at home.)</p>\n\n<pre><code>$sql = \"INSERT INTO sap_id_select (  select_date\n                                   , select_id )\n        VALUES (  CURRENT_DATE ()\n                , '{$cSelected_id}' ) \n       \" ;\n\nif ( isset ( $_POST [ checkbox] ) ) \n   { \n      foreach ( $_POST [ checkbox ] as $cSelected_id )\n         {\n            mysql_query ( $sql ) or ( \"Error: \" . mysql_error () ) ;\n         }\n   }\n</code></pre>\n\n<p>================================</p>\n\n<pre><code> if ( isset ( $_POST [ checkbox] ) ) \n    { \n       foreach ( $_POST [ checkbox ] as $cSelected_id )\n          {\n             $sql = \"INSERT INTO sap_id_select (  select_date\n                                                , select_id )\n                     VALUES (  CURRENT_DATE ()\n                             , '{$cSelected_id}' ) \n                    \" ;\n\n             mysql_query ( $sql ) or ( \"Error: \" . mysql_error () ) ;\n          }\n    }\n</code></pre>\n"},{"tags":["sql","ruby","database","query","sequel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13037044,"title":"How do I combine AND and OR using Sequel?","body":"<p>I want to generate a SQL query like the following using Ruby's Sequel:</p>\n\n<pre><code>SELECT * FROM Objects WHERE (color = \"red\" AND shape = \"triangle\") OR \n                            (color = \"blue\" AND shape = \"square\") OR\n                            (color = \"green\" AND shape = \"circle\")\n</code></pre>\n\n<p>I want to build this query programmatically from a list of conditions, so that I can do something like this:</p>\n\n<pre><code>conditions = [[[:color, \"red\"], [:shape, \"triangle\"]],\n              [[:color, \"blue\"], [:shape, \"square\"]],\n              [[:color, \"green\"], [:shape, \"circle\"]]]\nDB[:Users].where(conditions.sql_or)\n</code></pre>\n\n<p>It doesn't have to follow that exact form, but I want to be able to build the conditions programmatically, so it's not sufficient to be able to construct this query by hand.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13042521,"title":"query result echoing results four times","body":"<p>I have a functioning query that is echoing the correct results, for 2 people in the reservation, except that it publishing the results four times instead of just once.</p>\n\n<p>Echo of results should be:</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p>Instead, the echo is:</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p><strong>Total for Options:</strong> $94</p>\n\n<p>Here's the associated query and PHP code:</p>\n\n<pre><code>    $optquery = \"SELECT t.ibtp, c.ibt\n                FROM clients c, tourprices t \n                WHERE c.tourstart = t.tourstart\n                AND c.tourbk_id = t.tour_id\"; \n\n    $optresult = $db-&gt;query($optquery); \n\n    while ($optrate = mysqli_fetch_assoc($optresult))\n       {\n\n     $opttotalcost = $optrate['ibtp'] * $optrate['ibt']; \n        echo '&lt;strong&gt;',\"Total for Options :&lt;/strong&gt;  $ {$opttotalcost}&lt;br /&gt;\"; \n}\n</code></pre>\n\n<p>Any one see the problem?  </p>\n"},{"tags":["query","hibernate","join","one-to-many","jql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13042231,"title":"JQL for One To Many with join table","body":"<p>I have the following relationships: A CustomerApplication has a list of Customer objects as a OneToMany with a join table.  A CustomerApplication also has a OneToOne to a CustomerAgreement.  The code in the CustomerApplication class is as follows:</p>\n\n<pre><code>@OneToMany( fetch = FetchType.EAGER )  \n@JoinTable(  \n        name = \"customer_application_customer\",  \n        joinColumns = @JoinColumn( name = \"customer_application_id\" ),  \n        inverseJoinColumns = @JoinColumn( name = \"customer_id\" ) )  \nprivate List&lt;Customer&gt; customers = new ArrayList&lt;Customer&gt;();  \n\n@OneToOne( mappedBy = \"customerApplication\" )  \nprivate CustomerAgreement customerAgreement;\n</code></pre>\n\n<p>I need to use JQL to query all active agreements for customers with the same Social Security number.  I have the following, which gives the error: </p>\n\n<p>Errors in named queries: CustomerAgreement.fetchActiveForSsn  </p>\n\n<p>Here is the query.  </p>\n\n<p>@NamedQuery( name = \"CustomerAgreement.fetchActiveForSsn\", query = \"select o from CustomerAgreement o where o.status = :status and o.customerApplication.customers.customer.socialSecurityNumber = :ssn\" )</p>\n\n<p>It's the join between the CustomerApplication and the list of customers to check the social that I'm not sure of.  Can someone tell me how that's done?</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13041685,"title":"multiple MySQL SELECTS in same query","body":"<p>Is it possible to retrieve elements from multiple SELECTS into PHP?</p>\n\n<p>Take this one for example:</p>\n\n<pre><code>$query= mysql_query(\"SELECT ...; SELECT ...;\") \n</code></pre>\n\n<p>If it is possible how can we organize the information ?</p>\n\n<p>I don't think it's as simple as:</p>\n\n<pre><code>while($row = mysql_fetch_array($query))\n</code></pre>\n"},{"tags":["sql","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13041437,"title":"Alternative to INTERSECT Given Arbitrary Number of conditions","body":"<p>If I have a table similar to the following:</p>\n\n<pre><code>MyIds MyValues\n----- --------\n  1    Meat\n  1    Fruit\n  1    Veggies\n  2    Fruit\n  2    Meat\n  3    Meat\n</code></pre>\n\n<p>How do I create a query  such that if I am given an arbitrary list of distinct <code>MyValues</code>, it will give me all the <code>MyIds</code> that match <strong>all</strong> of <code>MyValues</code>.</p>\n\n<p>Example: If list of <code>MyValues</code> contained [Meat, Fruit, Veggies], I'd like to get <code>MyIds</code> of <code>1</code> back because <code>1</code> has an entry in the table for each value in MyValues.</p>\n\n<p>I know that this can be done with an INTERSECT if I'm given a specific list of <code>MyValues</code>. But I don't know how it can be done with an arbitrary number of <code>MyValues</code> </p>\n"},{"tags":["ruby-on-rails","query","dry"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":23,"score":3,"question_id":13041051,"title":"Trying not to repeat myself with Rails data manipulation","body":"<p>I'm fairly new to rails, an an intermediate programmer in general, but I'll try to be as clear as I can.</p>\n\n<p>I have a database table for Products, which owns a field called category. Category has two possible values, call them Category1 and Category 2. The goal is to retrieve all the Products and display them in HTML organized by Category. I can make this work, but I know there has to be a better way.</p>\n\n<p>My method now is to get my Products like so:</p>\n\n<pre><code>@category1_products = Product.all(conditions: { category: \"Category1\" })\n@category2_products = Product.all(conditions: { category: \"Category2\" })\n</code></pre>\n\n<p>and then output the data something like this:</p>\n\n<pre><code>&lt;table&gt;\n&lt;tr&gt;\n  &lt;td&gt;Category1 Name&lt;/td&gt;\n&lt;% @category1_products.each do |product| %&gt;\n  &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.description %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.price %&gt;&lt;/td&gt;\n&lt;% end %&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n  &lt;td&gt;Category2 Name&lt;/td&gt;\n&lt;% @category2_products.each do |product| %&gt;\n  &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.description %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= product.price %&gt;&lt;/td&gt;\n&lt;% end %&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I would like to accomplish this using a single instance: get all Products at once, group them by Category, and then output them by looping through one Category at a time (including the Category Names). This seems like a pretty elementary concept to me, but I'm having trouble getting my head around it.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12980911,"title":"Trouble creating a SQL query","body":"<p>I've been thinking about how to compose this SQL query for a while now, but after thinking about it for a few hours I thought I'd ask the SO community to see if they have any ideas.</p>\n\n<p>Here is a mock up of the relevant portion of the tables:</p>\n\n<h2>contracts</h2>\n\n<ul>\n<li>id</li>\n<li>date</li>\n<li>ar (yes/no)</li>\n<li>term</li>\n</ul>\n\n<h2>payments</h2>\n\n<ul>\n<li>contract_id</li>\n<li>payment_date</li>\n</ul>\n\n<p>The object of the query is to determine, per month, how many payments we expect, vs how many payments we received.</p>\n\n<p><strong>conditions for expecting a payment</strong>\nExpected payments begin on <code>contracts.term</code> months after <code>contracts.date</code>, <em>if <code>contracts.ar</code> is \"yes\"</em>. Payments continue to be expected until the month after the first missed payment.</p>\n\n<p>There is one other complication to this: <em>payments might be late, but they need to show up as if they were paid on the date expected.</em></p>\n\n<p>The data is all there, but I've been having trouble wrapping my head around the SQL query. I am not an SQL guru - I merely have a decent amount of experience handling simpler queries. I'd like to avoid filtering the results in code, if possible - but without your help that may be what I have to do.</p>\n\n<h2>Expected Output</h2>\n\n<pre><code>Month    Expected Payments    Received Payments\nJanuary  500                    450\nFebruary 498                    478\nMarch    234                    211\nApril    987                    789\n...\n</code></pre>\n\n<h2>SQL Fiddle</h2>\n\n<p>I've created an SQL Fiddle: <a href=\"http://sqlfiddle.com/#!2/a2c3f/2\" rel=\"nofollow\">http://sqlfiddle.com/#!2/a2c3f/2</a></p>\n"},{"tags":["mysql","sql","query","import","mysqldump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13039168,"title":"mysql query to import data from dump to existing data and overwrite new entry","body":"<p>I want to import new DUMP file to my old database which has same schema. I want to overwrite if there is anychange in record with dump file record I am importing and want to add new records. I dont want to delete the existing records in the DB I am gonna import.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13039706,"title":"trying to multiply query results for a total","body":"<h2>Issue</h2>\n\n<p>I've produced a query to determine the total cost per person for a room and the total number of persons in the room; the total cost per person is returning correctly as is the total number of person in the room; however, when I try to echo the minor multiplication for the total, I am merely getting the display of the numbers I wish to multiply.  </p>\n\n<p><strong>For example:</strong>\nprice per person = $1207\ntotal number of person in the room = 2\nquery result ... \"1207*2\" ... </p>\n\n<h2>Question:</h2>\n\n<p>I'm certain it is something stupid or minor but could use a second set of eyes.  How do I rewrite the code below to produce the desired result of <strong>$2414</strong>?</p>\n\n<h2>Here's the query:</h2>\n\n<pre><code>$tourquery = \"SELECT t.roomprice, c.totpax \n         FROM clients c, tourprices t \n         WHERE c.roomtype1 = t.roomtype \n         AND c.tourstart = t.tourstart\n         AND c.tourbk_id = t.tour_id\"; \n$tourresult = $db-&gt;query($tourquery); \n\n\nwhile ($roomrate = mysqli_fetch_assoc($tourresult))\n   {\necho \"Per person amount : {$roomrate['roomprice']}&lt;br /&gt;\";\necho \"Total room amount : {$roomrate['roomprice']}*{$roomrate['totpax']}&lt;br /&gt;\";\n\n}\n</code></pre>\n"},{"tags":["mysql","query","union","subtraction"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13037149,"title":"Partial sum and subtraction (minus) in UNION Query","body":"<p>I have two similar tables (one for bills, the other payments) right now I show to users a union mixing data from both..</p>\n\n<pre><code>Table Bills                             \nCustomerId  Amount                      \n1           100                        \n2           100                        \n1           100                        \n2           100\n\nTable Payments\nCustomerId  Amount\n1           100\n2           100\n1           100\n</code></pre>\n\n<p>Right now my users can see the following informtation</p>\n\n<pre><code>From Customer 1\nType    CustomerId   Amount\nB       1            100\nP       1            -100\nB       1            100\nP       1            -100\nTOTAL 0\n\nFrom Customer 2\nType    CustomerId   Amount\nB       1            100\nP       1            -100\nB       1            100\nTotal 100\n</code></pre>\n\n<p>Everything works fine using UNION Statement</p>\n\n<p>Right now I need to show Partial Balance on each record so users can keep in mind balanca while they are looking at records..</p>\n\n<p>Like this... (DESIRED)</p>\n\n<pre><code>From Customer 1\nType    CustomerId   Amount    Partial\nB       1            100       100\nP       1            -100      0\nB       1            100       100\nP       1            -100      0\n</code></pre>\n\n<p>I've alredy try using Variables like @Partial := @Partial + Amount but it seems that it first sum the first part (bills) and then the rest (payments)... like this...</p>\n\n<pre><code>From Customer 1\nType    CustomerId   Amount    Partial\nB       1            100       100\nP       1            -100      200\nB       1            100       200\nP       1            -100      100\n</code></pre>\n\n<p>it seems that first sum everything from bills and then start subtraction... anyone knows how to solve it?</p>\n\n<p><em><strong></em>**<em>*</em>**<em>*</em></strong> // update  // <strong><em>*</em>**<em>*</em>****</strong></p>\n\n<p>here original query ...</p>\n\n<p>(SELECT  'Bill' as cType   , b.type, b.tal , 'Customer', b.number , b.date , b.subtot, b.tax, IF(b.type='CA' or b.type='CB' or b.type='CC' or b.type='CX',b.total*-1,b.total) as total  FROM bills b WHERE b.idcustomer='000140') UNION ALL\n(SELECT  'Payment' as cType, 'CO'  , '1'   , ''    , c.idcash , c.date , 0       ,0     , -c.amount FROM cash c WHERE c.idcustomer='000140' and ( c.type='CO' or c.type='DM') ) order by date asc;</p>\n\n<p>this brings something like this</p>\n\n<p>Bill    FX  1   Customer    9   2011-02-25  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       37  2011-03-04  0.00    0.00    -100.00</p>\n\n<p>Bill    FX  1   Customer    616 2011-03-23  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       751 2011-04-12  0.00    0.00    -100.00</p>\n\n<p>Bill    FX  1   Customer    1267    2011-04-27  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       1157    2011-05-10  0.00    0.00    -100.00</p>\n\n<p>Bill    FX  1   Customer    1974    2011-05-26  0.00    0.00    100.00</p>\n\n<p>Payment CO  1       1654    2011-06-08  0.00    0.00    -100.00</p>\n\n<p>then When I try to sum patiars...using the following code</p>\n\n<p>set @running_total=0;\n(SELECT  'Bill' as cType   , b.type, b.tal , 'Customer', b.number , b.date , b.subtot, b.tax, IF(b.type='CA' or b.type='CB' or b.type='CC' or b.type='CX',b.total*-1,b.total) as total, ( @running_total := @running_total + total) AS RunningTotal  FROM bills b WHERE b.idcustomer='000140') UNION ALL\n(SELECT  'Payment' as cType, 'CO'  , '1'   , ''    , c.idcash , c.date , 0       ,0     , -c.amount, ( @running_total := @running_total-c.amount) AS RunningTotal FROM cash c WHERE c.idcustomer='000140' and ( c.type='CO' or c.type='DM') ) order by date asc;</p>\n\n<p>results...</p>\n\n<p>Bill    FX  1   Customer    9   2011-02-25  0.00    0.00    100.00  100.00</p>\n\n<p>Payment CO  1       37  2011-03-04  0.00    0.00    -100.00 1905.00</p>\n\n<p>Bill    FX  1   Customer    616 2011-03-23  0.00    0.00    100.00  200.00</p>\n\n<p>Payment CO  1       751 2011-04-12  0.00    0.00    -100.00 1805.00</p>\n\n<p>Bill    FX  1   Customer    1267    2011-04-27  0.00    0.00    100.00  300.00</p>\n\n<p>Payment CO  1       1157    2011-05-10  0.00    0.00    -100.00 1705.00</p>\n\n<p>As you Can See seems to sum first all from bills and then start substraccion from payments...</p>\n"},{"tags":["sql","query","sql-update","iterate","foxpro"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13034082,"title":"sql query to \"iterate\" and \"concatenate\" through table values","body":"<p>I have a table like this</p>\n\n<pre><code>name    group        id\n\njohn    employee     1\njoe     intern       i1\nsmith   intern       i2\n</code></pre>\n\n<p>i'm wondering if there is a sql technique that will allow me to group the rows with the same group type to have something like following :</p>\n\n<pre><code>name               group        id\n\njohn               employee     1\njoe, smith         intern       i1,i2\n</code></pre>\n\n<p>i'm looking for a query/solution in pure sql, no proprietary sql (e.g sql server, oracle...)\nI'm no sql guru, so pardon my ignorance.</p>\n"},{"tags":["php","sql-server","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13038942,"title":"Invalid column name in mysql PHP query","body":"<p>I had the following form working properly and populating MySQL DB.  I had since added on a new field 'type' to my database and also added it to the form.  However now when I try to add a new entry it says \"Invalid column name 'type'\".  Any help would be greatly appreciated.</p>\n\n<pre><code>&lt;script&gt;\n      $(document).ready(function() {\n        $(\"#datepicker\").datepicker();\n      });\n      &lt;/script&gt;\n\n  &lt;script&gt;\n$(document).ready(function() {\n$(\"#datepicker2\").datepicker();\n});\n&lt;/script&gt;\n\n &lt;/head&gt;\n &lt;body&gt;\n &lt;?php \n // if there are any errors, display them\n if ($error != '')\n {\n echo '&lt;div style=\"padding:4px; border:1px solid red; color:red;\"&gt;'.$error.'&lt;/div&gt;';\n }\n ?&gt; \n\n  &lt;form action=\"\" method=\"post\"&gt;\n &lt;div&gt;\n &lt;label for=\"Posted\"&gt;&lt;strong&gt;Posted: &lt;/strong&gt; &lt;/label&gt;\n &lt;input id=\"datepicker\"  name=\"posted\" value=\"&lt;?php echo $Posted; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Ends\"&gt;&lt;strong&gt;Ends: &lt;/strong&gt; &lt;/label&gt;\n &lt;input id=\"datepicker2\"  name=\"ends\" value=\"&lt;?php echo $Ends; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Position\"&gt;&lt;strong&gt;Position: &lt;/strong&gt;&lt;/label&gt;\n  &lt;input type=\"text\" name=\"position\" value=\"&lt;?php echo $Position; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n  &lt;label for=\"Location\"&gt;&lt;strong&gt;Location: &lt;/strong&gt; &lt;/label&gt;\n &lt;select name=\"location\"&gt;\n  &lt;option value=\" \"&gt;Select...&lt;?php echo $Location; ?&gt;&lt;/option&gt;\n  &lt;option value=\"Fargo\"&gt;Fargo&lt;/option&gt;\n  &lt;option value=\"Grand Forks\"&gt;Grand Forks&lt;/option&gt;\n&lt;/select&gt;&lt;br/&gt;&lt;br/&gt;\n\n&lt;label for=\"Application Type\"&gt;&lt;strong&gt;Application Type: &lt;/strong&gt; &lt;/label&gt;\n  &lt;select name=\"type\"&gt;\n  &lt;option value=\" \"&gt;Select...&lt;?php echo $Type; ?&gt;&lt;/option&gt;\n  &lt;option value=\"Driver\"&gt;Driver&lt;/option&gt;\n  &lt;option value=\"Employee\"&gt;Employee&lt;/option&gt;\n&lt;/select&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Hours\"&gt;&lt;strong&gt;Hours: &lt;/strong&gt; &lt;/label&gt;\n &lt;input type=\"text\" name=\"hours\" value=\"&lt;?php echo $Hours; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Pay\"&gt;&lt;strong&gt;Pay: &lt;/strong&gt; &lt;/label&gt;\n &lt;input type=\"text\" name=\"pay\" value=\"&lt;?php echo $Pay; ?&gt;\" /&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Benefits\"&gt;&lt;strong&gt;Benefits: &lt;/strong&gt; &lt;/label&gt;\n &lt;textarea cols=\"60\" rows=\"2\" name=\"benefits\" value=\"&lt;?php echo $Benefits; ?&gt;\" &gt;&lt;?php echo $Benefits; ?&gt;&lt;/textarea&gt;&lt;br/&gt;&lt;br/&gt;\n\n &lt;label for=\"Description\"&gt;&lt;strong&gt;Description: &lt;/strong&gt; &lt;/label&gt;\n &lt;textarea cols=\"60\" rows=\"3\" name=\"description\" value=\"&lt;?php echo $Description; ?&gt;\" &gt;&lt;?php echo $Description; ?&gt;&lt;/textarea&gt;&lt;br/&gt;&lt;br/&gt;\n\n\n &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n &lt;/div&gt;\n &lt;/form&gt; \n &lt;/body&gt;\n &lt;/html&gt;\n &lt;?php \n }\n\n\n\n\n // connect to the database\n include('connect-db.php');\n\n // check if the form has been submitted. If it has, start to process the form and save it to the database\n if (isset($_POST['submit']))\n { \n // get form data, making sure it is valid\n\n function ms_escape_string($data) {\n        if ( !isset($data) or empty($data) ) return '';\n        if ( is_numeric($data) ) return $data;\n\n        $non_displayables = array(\n            '/%0[0-8bcef]/',            // url encoded 00-08, 11, 12, 14, 15\n            '/%1[0-9a-f]/',             // url encoded 16-31\n            '/[\\x00-\\x08]/',            // 00-08\n            '/\\x0b/',                   // 11\n            '/\\x0c/',                   // 12\n            '/[\\x0e-\\x1f]/'             // 14-31\n        );\n        foreach ( $non_displayables as $regex )\n            $data = preg_replace( $regex, '', $data );\n        $data = str_replace(\"'\", \"''\", $data );\n        return $data;\n    }\n\n    ms_escape_string($_POST);\n\n\n     $posted=$_POST['posted'];\n     $ends=$_POST['ends'];\n     $type=$_POST['type'];\n     $position=$_POST['position'];\n     $location=$_POST['location'];\n     $hours=$_POST['hours'];\n     $pay=$_POST['pay'];\n     $benefits=$_POST['benefits'];\n     $description=$_POST['description'];\n\n // check to make sure all fields are entered\n if ($posted == '' || $ends == '' || $type == '' || $position == '' || $location == '' || $hours == '' || $pay == '' || $benefits == '' || $description == '')\n {\n // generate error message\n $error = 'ERROR: Please fill in all required fields!';\n\n // if any fields are blank, display the form again\n renderForm($posted, $ends, $type, $position, $location, $hours, $pay, $benefits, $description, $error);\n }\n else\n {\n // save the data to the database\n    $SQL = \"INSERT INTO JobPosting (posted, ends, type, position, location, hours, pay, benefits, description) VALUES ('$posted', '$ends', '$type', '$position', '$location', '$hours', '$pay', '$benefits', '$description')\";\n\n     $result = mssql_query($SQL) \n        or die (mssql_get_last_message());  \n\n // once saved, redirect back to the view page\n header(\"Location: view.php\"); \n }\n }\n else\n // if the form hasn't been submitted, display the form\n {\n renderForm('','','','','','','','','','');\n }\n</code></pre>\n"},{"tags":["sql-server","vb.net","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13038389,"title":"Proper way to execute a large SQL query in vb.net","body":"<p>I have a SQL query that I used my vb.net application to run it, but i have a problem when It exceeds to its command timeout property. I set it to 300, any tips or suggestions?</p>\n\n<p>here is the snippet of my code in vb.net</p>\n\n<pre><code>  .ExecuteQuery(\"exec spCentrIX_PracticeSet '\" &amp; oCompany &amp; \"','\" &amp; .SecDatabaseName &amp; \"'\", sDataSet)\n  Application.DoEvents()\n  .ExecuteQuery(\"exec spCentrIX_PracticeSet '\" &amp; oCompany &amp; \"','\" &amp; .SetDatabaseName &amp; \"'\", sDataSet)\n  Application.DoEvents()\n  .ExecuteQuery(\"exec spCentrIX_PracticeSet '\" &amp; oCompany &amp; \"','\" &amp; .TranDatabaseName &amp; \"'\", sDataSet)\n  Application.DoEvents()\n</code></pre>\n\n<p>same script that run three times. this script gets all the data from the 3 databases which runs okie. however, when it is running...it exceeds the connection timeout of my code.</p>\n"},{"tags":["android","string","query","listview","trim"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13037546,"title":"How to get a part of a datastring from clicking a listview-item","body":"<p>I have a variable called current which holds the last clicked listview item data. The id of this data is to be used to query the db again for movies taht are similar.</p>\n\n<p>The problem that current = id=17985, title=the matrix, year=1999 when all i need is the actual id-number. I have tried to use substring to only use the correct places of the string. This works for the matrix since its id is exactly 5 digits long, but as soon as i try to click  movie with higher/lower amount of digits in its id of course it fucks up.</p>\n\n<p>String id = current.substring(4,9).trim().toString(); does not work for all movies.</p>\n\n<p>Heres some code:</p>\n\n<p>// search method: this is necessary cause this is the method thats first used and where the variable current is set. This is also the only method using three lines for getting data - id, title and year. </p>\n\n<pre><code> protected void search() {\n        data = new ArrayList&lt;Map&lt;String, String&gt;&gt;();\n        list = new ArrayList&lt;String&gt;();\n        EditText searchstring = (EditText) findViewById(R.id.searchstring);\n        String query = searchstring.getText().toString().replace(' ', '+');\n        String text;\n\n        text = searchquery(query);\n        try {\n            JSONObject res = new JSONObject(text);\n\n            JSONArray jsonArray = res.getJSONArray(\"movies\");\n\n            for (int i = 0; i &lt; jsonArray.length(); i++) {\n\n                JSONObject jsonObject = jsonArray.getJSONObject(i);\n                item = new HashMap&lt;String, String&gt;(2);\n                item.put(\"id\",jsonObject.getString(\"id\"));\n                item.put(\"title\",jsonObject.getString(\"title\"));\n                item.put(\"year\", jsonObject.getString(\"year\"));\n                data.add(item);\n\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }                   \n\n        aa = new SimpleAdapter(SearchTab.this, data,\n                R.layout.mylistview,\n                new String[] {\"title\", \"year\"},\n                new int[] {R.id.text1,\n                R.id.text2});\n        ListView lv = (ListView) findViewById(R.id.listView1);\n        lv.setAdapter(aa);\n        lv.setDividerHeight(5); \n\n        lv.setOnItemClickListener(new OnItemClickListener() {\n            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int pos, long id) {\n\n                Map&lt;String, String&gt; s = data.get((int) id);\n                current = s.toString();\n            }});\n    }\n</code></pre>\n\n<p>// similar method: this tries to build a list from the fetched data from \"current\"-string. As you can see i try to use 4,9 to only get right numbers, but this fails with others. Best would be to only to be ble to get the ID which I cant seem to do. The toast is just to see what is beeing fetched, much like a system out print.</p>\n\n<pre><code> protected void similar() {\n        data = new ArrayList&lt;Map&lt;String, String&gt;&gt;();\n        list = new ArrayList&lt;String&gt;();\n        String id = current.substring(4,9).trim().toString();\n        Toast.makeText(getApplicationContext(), id, Toast.LENGTH_SHORT).show();\n        String text;\n\n        text = similarquery(id);\n        try {\n            JSONObject res = new JSONObject(text);\n\n            JSONArray jsonArray = res.getJSONArray(\"movies\");\n\n            for (int i = 0; i &lt; jsonArray.length(); i++) {\n\n                JSONObject jsonObject = jsonArray.getJSONObject(i);\n                item = new HashMap&lt;String, String&gt;(2);\n                item.put(\"title\",jsonObject.getString(\"title\"));\n                item.put(\"year\", jsonObject.getString(\"year\"));\n                data.add(item);\n\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }                   \n\n        aa = new SimpleAdapter(SearchTab.this, data,\n                R.layout.mylistview2,\n                new String[] {\"title\", \"year\"},\n                new int[] {R.id.text1,\n                R.id.text2});\n        ListView lv = (ListView) findViewById(R.id.listView1);\n        lv.setAdapter(aa);\n        lv.setDividerHeight(5); \n\n    }\n</code></pre>\n"},{"tags":["query","sqlite","sqlite3","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":83,"score":1,"question_id":13030058,"title":"WebSQL query optimization help - CASE WHEN makes query 400 ms slow","body":"<p>Can somebody tell me why 'CASE WHEN' makes it so slow and how to optimize / fix it, please ?</p>\n\n<p>It is needed to get the items that are pinned to be put first in the result and in order.</p>\n\n<p>I could probably do it after the sql query but i think it would be faster, when done right, if this sorting is done inside the sql query.</p>\n\n<p>slow query ~490ms</p>\n\n<pre><code>SELECT \n    places.id AS place_id,\n    url,\n    title,\n    thumbnails.score AS score,\n    thumbnails.clipping AS clipping,\n    thumbnails.lastModified AS lastModified,\n    EXISTS (SELECT 1 FROM pinned pi WHERE pi.place_id = places.id) AS pinned\nFROM places\n    LEFT JOIN thumbnails ON (thumbnails.place_id = places.id)\n    LEFT JOIN pinned j ON (j.place_id = places.id) WHERE (hidden == 0)\nORDER BY case when j.id is null then 1 else 0 end,\n    j.id,\n    frecency DESC LIMIT 24\n</code></pre>\n\n<p>Removing the 'CASE WHEN' part:\nquery ~6ms</p>\n\n<pre><code>SELECT\n    places.id AS place_id,\n    url,\n    title,\n    thumbnails.score AS score,\n    thumbnails.clipping AS clipping,\n    thumbnails.lastModified AS lastModified,\n    EXISTS (SELECT 1 FROM pinned pi WHERE pi.place_id = places.id) AS pinned\nFROM places\n    LEFT JOIN thumbnails ON (thumbnails.place_id = places.id) WHERE (hidden == 0)\nORDER BY frecency DESC LIMIT 24\n</code></pre>\n\n<p>Table info:</p>\n\n<pre><code>var Create_Table_Places =\n    'CREATE TABLE places (' +\n        'id INTEGER PRIMARY KEY,' +\n        'url LONGVARCHAR,' +\n        'title LONGVARCHAR,' +\n        'visit_count INTEGER DEFAULT 0,' +\n        'hidden INTEGER DEFAULT 0 NOT NULL,' +\n        'typed INTEGER DEFAULT 0 NOT NULL,' +\n        'frecency INTEGER DEFAULT -1 NOT NULL,' +\n        'last_visit_date INTEGER,' +\n        'dateAdded INTEGER,' +\n        'lastModified INTEGER' +\n    ')';\n\nvar Create_Table_Thumbnails =\n    'CREATE TABLE thumbnails (' +\n        'id INTEGER PRIMARY KEY,' +\n        'place_id INTEGER UNIQUE,' +\n        'data LONGVARCHAR,' +\n        'score REAL,' +\n        'clipping INTEGER,' +\n        'dateAdded INTEGER,' +\n        'lastModified INTEGER' +\n    ')';\n\nvar Create_Table_Pinned =\n    'CREATE TABLE pinned (' +\n        'id INTEGER PRIMARY KEY,' +\n        'place_id INTEGER UNIQUE,' +\n        'position INTEGER,' +\n        'dateAdded INTEGER,' +\n        'lastModified INTEGER' +\n    ')';\n</code></pre>\n"},{"tags":["sql","query","select","if-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13037468,"title":"if then statement in select query","body":"<pre><code>select \n     DISTINCT CONTACT.CONTACT_ID\n    , CONTACT.FIRST_NAME\n    , CONTACT.LAST_NAME\n    , CONTACT_ADDRESS.COMPANY_NAME\n    , CONTACT_ADDRESS.ADDRESS_LINE_1\n    , CONTACT_ADDRESS.ADDRESS_LINE_2\n    , CONTACT_ADDRESS.CITY\n    , CONTACT_ADDRESS.STATE_PROVINCE\n    , CONTACT_ADDRESS.POSTAL_CODE_1\n    , CONTACT_ADDRESS.POSTAL_CODE_2\n    , CONTACT_LABEL.CREATED_BY\n    , CONTACT_NOTE.CONTACT_NOTE_ID\n    , dbms_lob.substr( CONTACT_NOTE.NOTE_TEXT, 4000, 1) as note_text\n    , CONTACT_NOTE.NOTE_TYPE\n    , rep_profile.terr1\n    , ' ' as Territory\nfrom contact \n    INNER JOIN CONTACT_ADDRESS ON CONTACT.CONTACT_ID = CONTACT_ADDRESS.CONTACT_ID\n    INNER JOIN CONTACT_LABEL ON CONTACT.CONTACT_ID = CONTACT_LABEL.CONTACT_ID\n    INNER JOIN LABEL ON CONTACT_LABEL.LABEL_ID = LABEL.LABEL_ID\n    LEFT JOIN CONTACT_NOTE ON CONTACT.CONTACT_ID = CONTACT_NOTE.CONTACT_ID\n    left join \n    (\n        rep_profile \n        inner join terr_user on rep_profile.terr1 = terr_user.terr\n        inner join terr_version on \n            (terr_user.version = terr_version.version\n                and TERR_USER.ROLE_ID ='00007' \n                and TERR_VERSION.CURRENT_VERSION ='Y'\n            )\n    ) on contact.contact_id = rep_profile.contact_id\n\nWHERE \n    LABEL.DESCRIPTION='Holiday Card 2012' \n    AND (   CONTACT_NOTE.NOTE_TYPE='HC12' \n            or CONTACT_NOTE.NOTE_TYPE IS NULL\n        )\n</code></pre>\n\n<p>I need to put in an if-then-else statement which depends on what the <code>rep_profile.terr1</code> field shows.</p>\n\n<p>Pseudo-code:</p>\n\n<pre><code>if rep_profile.terr1 = 'W05' then Territory = 'Bob'\nelse if rep_profile_terr1 = 'W04' then Territory = 'Jack'\n...\nelse Territory = 'N/A'\n</code></pre>\n\n<p>There are 11 different <code>rep_profile.terr1</code>. Would appreciate any help on how to best do this. Many thanks in advance!</p>\n"},{"tags":["query","coldfusion","coldfusion-8"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13036134,"title":"Have you seen this weird QoQ Error [ColdFusion]?","body":"<p>I have confirmed that the first query works as expected</p>\n\n<pre><code>&lt;cfquery name=\"validation_info\" dbtype=\"query\"&gt;\n    select      shipViaName,TOTALSHIPRATE\n    from        s_c_c.qShipCalc\n    WHERE       sku in (#preserveSingleQuotes(validate)#)\n&lt;/cfquery&gt;\n&lt;cfquery name=\"validation_info2\" dbtype=\"query\"&gt;\n    select      TOTALSHIPRATE\n    from        validation_info\n    WHERE       shipViaName = \"FedEx 3 Day\"\n&lt;/cfquery&gt;\n</code></pre>\n\n<p>But on the second query, I get this error:</p>\n\n<blockquote>\n  <p>Encountered \"shipViaName. Incorrect conditional expression, Incorrect\n  conditional expression, Lexical error at line 0, column 0.\n  Encountered: \"\\\"\" (34), after : \"\"</p>\n</blockquote>\n\n<p>It says the error is happening on this line: </p>\n\n<pre><code>&lt;cfquery name=\"validation_info2\" dbtype=\"query\"&gt;\n</code></pre>\n\n<p>I was also getting this error when I had the two queries combined into one.</p>\n\n<p><strong>Update from comments:</strong></p>\n\n<p>Dump of the validation_info query:</p>\n\n<p>SHIPVIANAME TOTALSHIPRATE </p>\n\n<pre><code>1 | FedEx Ground | 11.9  ||\n2 | FedEx 3 Day  | 22.99 || \n3 | FedEx 2 Day  | 26.99 || \n4 | FedEx 1 Day  | 44.55 || \n5 | FedEx Ground | 0     || \n6 | FedEx 3 Day  | 23.63 || \n7 | FedEx 2 Day  | 26.71 || \n8 | FedEx 1 Day  | 41.9  ||\n</code></pre>\n"},{"tags":["ruby-on-rails","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13036604,"title":"Rails 3 merging scopes with joins","body":"<h1>Setup</h1>\n\n<p>For this question, I'll use the following three classes:</p>\n\n<pre><code>class SolarSystem &lt; ActiveRecord::Base\n  has_many :planets\n\n  scope :has_earthlike_planet, joins(:planets).merge(Planet.like_earth)\nend\n\nclass Planet &lt; ActiveRecord::Base\n  belongs_to :solar_system\n  belongs_to :planet_type\n\n  scope :like_earth, joins(:planet_type).where(:planet_types =&gt; {:life =&gt; true, :gravity =&gt; 9.8})\nend\n\nclass PlanetType &lt; ActiveRecord::Base\n  has_many :planets\n\n  attr_accessible :gravity, :life\nend\n</code></pre>\n\n<h1>Problem</h1>\n\n<p>The scope <code>has_earthlike_planet</code> does not work. It gives me the following error:</p>\n\n<blockquote>\n  <p>ActiveRecord::ConfigurationError: Association named 'planet_type' was\n  not found; perhaps you misspelled it?</p>\n</blockquote>\n\n<h1>Question</h1>\n\n<p>I have found out that this is because it is equivalent to the following:</p>\n\n<pre><code>joins(:planets, :planet_type)...\n</code></pre>\n\n<p>and SolarSystem does not have a <code>planet_type</code> association. I'd like to use the <code>like_earth</code> scope on <code>Planet</code>, the <code>has_earthlike_planet</code> on <code>SolarSystem</code>, and would like to avoid duplicating code and conditions. Is there a way to merge these scopes like I'm attempting to do but am missing a piece? If not, what other techniques can I use to accomplish these goals?</p>\n"},{"tags":["mysql","sql","query","subquery"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13028037,"title":"SQL query to select attendance per student using sub query cant use row from parent query","body":"<p>I have a problem in SQL, I'm trying to work out the student attendance for a class in a register system I'm building however it won't let me use the parent column in the sub query,</p>\n\n<pre><code>SELECT A.student_id, TRUNCATE((100 - ((100/B.reg_num) * C.abs_num)), 0) AS attendance FROM\nstudents A\nJOIN (\nSELECT COUNT(*) AS reg_num\nFROM students\nJOIN seminargroup_student ON seminargroup_student.student_id = students.student_id\nJOIN seminar_group ON seminar_group.seminar_group_id = seminargroup_student.seminar_group_id\nJOIN modules ON modules.module_id = seminar_group.seminar_group_module_id\nJOIN register_seminar ON register_seminar.seminar_id = seminar_group.seminar_group_id\nJOIN registers ON registers.register_id = register_seminar.register_id\nWHERE modules.module_id =1 AND students.student_id = A.student_id\n) B\nJOIN (\nSELECT COUNT(*) AS abs_num\nFROM students\nJOIN seminargroup_student ON seminargroup_student.student_id = students.student_id\nJOIN seminar_group ON seminar_group.seminar_group_id = seminargroup_student.seminar_group_id\nJOIN modules ON modules.module_id = seminar_group.seminar_group_module_id\nJOIN absence ON students.student_id = absence.student_id\nWHERE modules.module_id =1 AND students.student_id = A.student_id\n) C\n</code></pre>\n\n<p>This returns: #1054 - Unknown column 'A.student_id' in 'where clause'</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":13036780,"title":"PHP script wont connect to database?","body":"<p>When certain pages load on my site I have a script that will add points to the users table in the points row.  Here is my script</p>\n\n<pre><code>&lt;?php\n\nsession_start();\n$db = mysqli_connect(\"hostname\", \"username\", \"password\", \"database\");\n\n$username = $_SESSION['username']; \n\nmysqli_query($db, 'UPDATE login_users SET points_column=points_column+1 WHERE username=$username');\n\n\n?&gt;\n</code></pre>\n\n<p>I have already checked the host name, username and password details and everything is correct but I keep getting this error</p>\n\n<blockquote>\n  <p>Warning: mysqli_connect() [function.mysqli-connect]: (28000/1045): Access denied for user 'a5950626_jlf'@'10.1.1.34' (using password: YES) in /home/a5950626/public_html/application/home.php on line 5</p>\n  \n  <p>PHP Error Message</p>\n  \n  <p>Warning: mysqli_query() expects parameter 1 to be mysqli, boolean\n  given in /home/a5950626/public_html/application/home.php on line 9</p>\n</blockquote>\n\n<p>Any ideas what the problem could be or how to fix it? Thanks!</p>\n"},{"tags":["php","query","mongodb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":48,"score":-2,"question_id":13036776,"title":"I need another Mongodb query for my project","body":"<p>I need a query, all I need to do is,getting the row with \"n\" keyword and get the last two inserted rows that is nothing to do with \"n\" keyword. But I don't know if it is possible or not, thank you :), this is my first query, but It only finds one.</p>\n\n<pre><code>$ho = $collect-&gt;findOne(array(\"n\" =&gt; $key));\n</code></pre>\n"},{"tags":["c#","sql","query","sqlcommand"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13031362,"title":"Upload to database more quickly","body":"<p>I have some code that at the end of the program's life, uploads the entire contents of 6 different lists into a database. The problem is, they're parallel lists with about 14,000 items in each, and I have to run an Insert query for each of their separate item(s). This takes a long time, is there a faster way to do this? Here's a sample of the relevant code:</p>\n\n<pre><code>    public void uploadContent()\n    {\n        var cs = Properties.Settings.Default.Database;\n        SqlConnection dataConnection = new SqlConnection(cs);\n        dataConnection.Open();\n\n        for (int i = 0; i &lt; urlList.Count; i++)\n        {\n            SqlCommand dataCommand = new SqlCommand(Properties.Settings.Default.CommandString, dataConnection);\n            try\n            {\n                dataCommand.Parameters.AddWithValue(\"@user\", userList[i]);\n                dataCommand.Parameters.AddWithValue(\"@computer\", computerList[i]);\n                dataCommand.Parameters.AddWithValue(\"@date\", timestampList[i]);\n                dataCommand.Parameters.AddWithValue(\"@itemName\", domainList[i]);\n                dataCommand.Parameters.AddWithValue(\"@itemDetails\", urlList[i]);\n                dataCommand.Parameters.AddWithValue(\"@timesUsed\", hitsList[i]);\n\n                dataCommand.ExecuteNonQuery();\n            }\n            catch (Exception e)\n            {\n                using (StreamWriter sw = File.AppendText(\"errorLog.log\"))\n                {\n                    sw.WriteLine(e);\n                }\n            }\n\n        }\n        dataConnection.Close();\n    }\n</code></pre>\n\n<p>Here is the command string the code is pulling from the config file:</p>\n\n<p>CommandString:</p>\n\n<pre><code>INSERT dbo.InternetUsage VALUES (@user, @computer, @date, @itemName, @itemDetails, @timesUsed)\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13035871,"title":"Going wrong in SQL join","body":"<p>I've a table called <code>tbl_users</code></p>\n\n<pre><code>================================================================================\nsystem_name | user_id | username | password | system_id | group_id | user_level\n================================================================================\nDemo        | 12345   | demo     | demo     | 99999     | 54321    | Admin\n================================================================================\nDemo        | 78794   | demo2    | demo2    | 99999     |          | Employee\n================================================================================\n</code></pre>\n\n<p>And second table as <code>tbl_groups</code></p>\n\n<pre><code>=================================\nsystem_id | group_id | group_name\n=================================\n99999     | 54321    | engine     \n=================================\n</code></pre>\n\n<p>Am using this query :</p>\n\n<pre><code>SELECT username, user_level, system_name, tbl_users.system_id, tbl_users.user_id, tbl_users.group_id, group_name \nFROM tbl_users JOIN tbl_groups \nWHERE tbl_users.group_id = tbl_groups.group_id \nAND system_name = 'demo' \nAND tbl_users.system_id = '99999'\n</code></pre>\n\n<p>But using the above query am just getting a row of <code>Demo User</code>, I want Demo 2 also but can't get it done, If am removing <code>tbl_users.group_id = tbl_groups.group_id</code> I get both rows but in <code>group_name</code> it's printed <strong>engine</strong> in <code>Demo2 User</code> <code>group_name</code> column which is wrong as he has no group currently, so how can I query that I get all users and names of groups if a user is in or else I want group_name column blank if user is in no group.</p>\n"},{"tags":["mysql","query","select","query-optimization","distinct-values"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13035615,"title":"MySQL select count(distinct id) is very slow","body":"<p>I have a MyISAM table with about 70 million records. When I do <code>select count(distinct id)</code> it takes about 80 seconds to get the query results. This table is a de-normalized table, that's why I need to get the unique count for id, and it has to be done dynamically. If I add a where clause, depending on the range I give, it takes a shorter time between 4 - 90 secs.</p>\n\n<p>I'm wondering if there is any way I can optimize this to improve the query speed.</p>\n"},{"tags":["database","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13034367,"title":"Oracle select statement performance","body":"<p>i have the following select statement : </p>\n\n<blockquote>\n<pre><code>(\n  SELECT CAL_DATE,BUS_DAY\n  FROM risk_mart.vw_calendar_t5\n  WHERE type = 'RPC'\n  AND BUS_DAY BETWEEN 0 AND 1\n) CAL\n WHERE t.cal_date         = cal.cal_date\n</code></pre>\n</blockquote>\n\n<p>It selects all the dates and then filters them <code>between</code> 0 and 1 (displays only two dates e.g. '22-OCT-12','19-OCT-12').</p>\n\n<p>Now, i can re-write that manually as </p>\n\n<blockquote>\n  <p>WHERE t.cal_date in ('22-OCT-12','19-OCT-12')</p>\n</blockquote>\n\n<p>The difference is performance. The first example i get a return back within 90 seconds and the second example, i get it within 10 seconds. Why?. </p>\n\n<p>How can i improve the first statement/rewrite it? </p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12996899,"title":"Efficient way to SELECT a fixed range of high scores given only a user id","body":"<p>I have a table consisting of records of every match that every player has played.  I've gotten a pretty good head start from the top answer of this question: <a href=\"http://stackoverflow.com/questions/5436263/ranking-with-millions-of-entries\">Ranking with millions of entries</a>, and am currently using this query to retrieve each player's highest score and their rank:</p>\n\n<pre><code>SET @rank=0;\n\nSELECT user_id, score, rank FROM (\n    SELECT *, @rank := @rank + 1 as rank\n    FROM high_scores\n    JOIN (\n        SELECT user_id as user_id2, MAX(score) AS max_score         \n        FROM high_scores\n        GROUP BY user_id2\n        ORDER BY max_score DESC) AS max_score_table                \n    ON max_score = high_scores.score AND high_scores.user_id = user_id2) derived_table\nORDER BY rank;\n</code></pre>\n\n<p>Again, this gives me a nice ordered list of each player's top score and its rank; However, I'd also like to be able to supply a specific <code>user_id</code> and filter the results down to this user's score as well as X amount of surrounding higher and lower scores. </p>\n\n<p>I would think I'd need to perform a <code>SELECT ... WHERE</code> on \"derived_table\" for the <code>user id</code> and use the returned row's <code>'rank'</code> to filter the top-level <code>SELECT</code> statement, but in addition to the query not even being accepted ('derived_table doesn't exist'), the way I was doing it would have required me to re-query derived_table twice (for a greater-than and less-than test), making the query even less efficient than it probably should be.</p>\n\n<p>How can I filter the full list of high scores and ranks down to a single <code>user_id</code>'s entry and X amount of surrounding entries?  Any insight on the code I'm trying to come up with (or the code I currently have) would be greatly appreciated.</p>\n"},{"tags":["mysql","query","phpmyadmin"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13032835,"title":"MySQL error Subquery returns more than 1 row","body":"<p>I have the following query:</p>\n\n<pre><code>SELECT \n    users.*,\n    classes.*, \n    evaluation.student_id, \n    evaluation.class_id, \n    evaluation.chapter_title,\n    (SELECT\n        `score`\n     FROM \n        `evaluation`\n     WHERE \n        `class_id` = 1 \n     AND \n        `id` \n     IN\n        (SELECT \n            MAX(`id`)\n         FROM\n            `evaluation`\n         WHERE\n            `class_id` = 1\n         GROUP BY\n            `chapter_title`)\n     GROUP BY\n        `chapter_title`) \n     AS\n        `score`,\n     (SELECT\n        `total_score`\n      FROM\n        `evaluation`\n      WHERE\n        `class_id` = 1\n      AND\n        `id`\n      IN\n        (SELECT \n            MAX(`id`)\n         FROM\n            `evaluation`\n         WHERE\n            `class_id` = 1\n         GROUP BY\n            `chapter_title`)\n      GROUP BY\n         `chapter_title`)\n      AS\n         `total_score`\n      FROM\n        (`evaluation`\n      INNER JOIN\n        `users`\n      ON \n        evaluation.student_id=users.id)\n      INNER JOIN\n        `classes`\n      ON\n        evaluation.class_id=classes.id\n      WHERE\n        users.role='student'\n      AND\n        evaluation.class_id = 1\n      AND\n        evaluation.student_id = 8\n</code></pre>\n\n<p>But when I execute this query in phpmyadmin it displays a error message saying:</p>\n\n<pre><code>#1242 - Subquery returns more than 1 row\n</code></pre>\n\n<p>Whats wrong in the query.Please help. Thanks in advance.</p>\n\n<p>I have this tables:</p>\n\n<p>users\n<img src=\"http://i.stack.imgur.com/aBc7e.jpg\" alt=\"enter image description here\"></p>\n\n<p>classes\n<img src=\"http://i.stack.imgur.com/YZyAD.jpg\" alt=\"enter image description here\"></p>\n\n<p>evaluation\n<img src=\"http://i.stack.imgur.com/4Akbx.jpg\" alt=\"enter image description here\"></p>\n\n<p>In the evaluation table(last image).. I would only want to return a distinct chapter_title or a grouped chapter_title that has the highest id and has a student_id of 8.</p>\n\n<p>I needed to use this query... but returns an error.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":56,"score":5,"question_id":13026254,"title":"MYSQL query for a table","body":"<p>I have a table called visitors which contains IP and country columns.</p>\n\n<p>Now I want to query the table such that I get unique countries from the table and display the count of rows of that country. </p>\n\n<p>Table:</p>\n\n<pre><code>IP         Country \n1.1.1.1.    xyz \n1.2.3.4     xyz\n2.2.3.6     abc\n3.61.3.69   axy\n</code></pre>\n\n<p>Now I want the result as :</p>\n\n<pre><code>Country     No_Visitors\nxyz               2\nabc               1\naxy               1\n</code></pre>\n\n<p>I know how to do it by using 2 queries, get the unique country first and then again query the table for the country name. But how can I do it with single query.</p>\n"},{"tags":["sql","query","phpmyadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13033509,"title":"SQL Query error Subquery returns more than 1 row","body":"<p>Here is my query:</p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/92414/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/92414/1</a></p>\n\n<p>Please check it if what is wrong with my query</p>\n\n<p>I needed to return the query that has a distinct chapter title and the has the max id that is filtered by the student_id from the evaluation table..</p>\n\n<p>I need you help. thank you in advance</p>\n"},{"tags":["sql","database","query","rdbms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13032551,"title":"Omit all the results even if one row has a different value","body":"<p>I have a sample database:</p>\n\n<pre><code>Var1    Var2    Status\n=========================\nA1      SG1     Completed\nA2      SG2     Completed\nA2      SG1     Progress\n</code></pre>\n\n<p>Statuses can be as many as 10 different statuses.</p>\n\n<p>I want to pull all the records only when all the rows' Status is 'Completed'. Meaning in this case no rows will be pulled. Only if all rows = 'Completed' then only it will pull the entire database.</p>\n\n<p>How can I achieve this in lowest time?</p>\n"},{"tags":["php","mysql","sql","query","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13032302,"title":"Need to Create a PHP LOOP (Not sure how to proceed after many failure)","body":"<p>So its simple, I need to replace the number 1 with 2 then 3 and so on 32 times. I know how to create simple PHP loops and everything but want to leave this \"Clean\" so its easier for you guys to help me.</p>\n\n<p>Thank you for any help you can provide me.</p>\n\n<pre><code>&lt;?php\n  $con = mysql_connect(\"localhost\",\"user\",\"pass\");\n  if (!$con)\n    {\n    die('Could not connect: ' . mysql_error());\n    }\n\n  mysql_select_db(\"mbbcom1_rfhl\", $con);\n\n  $sql=\"UPDATE `mbbcom1_rfhl`.`_statbu`\n  SET gp= gp + '$_POST[gp1]', g= g + '$_POST[g1]', a= a + '$_POST[a1]', shot= shot + '$_POST[s1]', pm= pm + '$_POST[pm1]', ppg= ppg + '$_POST[ppg1]', shg= shg + '$_POST[shg1]', bs= bs + '$_POST[blk1]', gwg= gwg + '$_POST[gwg1]', sog= sog + '$_POST[sog1]', soa= soa + '$_POST[soa1]', pim= pim + '$_POST[pim1]' WHERE `season` =9 AND `_statbu`.`player_id` = 1\";\n  if (!mysql_query($sql,$con))\n    {\n    die('Error: ' . mysql_error());\n    }\n  mysql_close($con)\n  ?&gt;\n</code></pre>\n\n<p>So just to be clear, i need the next loop to do the same thing but with '$_POST[gp2]', g= g + '$_POST[g2]' ....ect</p>\n\n<p>Once again, thank you</p>\n"},{"tags":["android","database","query","sqlite"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13032449,"title":"a query in sqlite on the first place in db","body":"<p>I'm trying to run a query on a DB that I've build but I have a strange problem\nwhen I run the query ( by name ) and extract the result .\nif I extract the first row in db than I can run another query on with other parameters.\nif I extract a row other than the first I can no longer access to the first row in my db</p>\n\n<pre><code>    Cursor cur =datasource.query( 2,new String[] {\"_id\",\"Player\",\"Num_of_wrong_ans\",\"Num_of_drunkness_checks\"} , PlayerDatabaseHelper.PLAYER + \" =? \" ,new String[] {array[1]} , null ); \n            if(cur.moveToFirst())\n            {                   \n                id = cur.getString(cur.getColumnIndex(PlayerDatabaseHelper.ID));\n\n            }\n            cur.close();    \n</code></pre>\n\n<p>the query method is this :</p>\n\n<pre><code>    public Cursor query( int indicator,String[] projection, String selection,\n        String[] selectionArgs, String sortOrder) {\n    SQLiteQueryBuilder qb = new SQLiteQueryBuilder();\n    String a;\n    switch (indicator) \n    { \n    case 1: \n        qb.setTables(PlayerDatabaseHelper.PLAYER_TABLE_NAME); \n        qb.setProjectionMap(projectionMap); \n        break; \n    case 2: \n        qb.setTables(PlayerDatabaseHelper.PLAYER_TABLE_NAME); \n        qb.setProjectionMap(projectionMap); \n        qb.appendWhere(PlayerDatabaseHelper.PLAYER);\n        break; \n    default: \n        throw new IllegalArgumentException(\"Unknown  \"); \n    } \n\n    // Get the database and run the query \n    SQLiteDatabase db = mHelper.getReadableDatabase(); \n    Cursor c = qb.query(db, projection, selection, selectionArgs, null, null, null); \n    return c; \n\n}    \n</code></pre>\n\n<p>what am I doing wrong ???</p>\n"},{"tags":["wordpress","query","multiple","taxonomy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13031125,"title":"WordPress query posts by several taxonomies","body":"<p>I was searching a lot on this issue, but can't find anything conslusive. Maybe someone can help me here!</p>\n\n<p>I have custom post type 'place' and two custom taxonomies 'place area' and 'place category'. I am building a dropdown filter by those two taxonomies. And all works great if the filter is empty and if both taxonomies are selected. But I can't figure out how to make it work if one of the taxonomies has value and another one is null.</p>\n\n<p>Here's my query:</p>\n\n<pre><code>if(($category == null) &amp;&amp; ($area == null)) {\n\n    //Usual query without taxonomy\n\n  } else {\n    $args = array(\n      'post_type'      =&gt; 'place',\n      'tax_query' =&gt; array(\n            array(\n                'taxonomy' =&gt; 'placecat',\n                'field' =&gt; 'slug',\n                'terms' =&gt; $category\n            ),\n            array(\n                'taxonomy' =&gt; 'placearea',\n                'field' =&gt; 'slug',\n                'terms' =&gt; $area\n            )\n        )\n    );\n  }\n  $the_query = new WP_Query( $args );\n</code></pre>\n\n<p>I thought that the null value will mean all taxonomy terms, but it seems like it's looking for a non-existent term and returns empty result.</p>\n\n<p>Any ideas how I can exclude taxonomy from query if the term value is null?</p>\n"},{"tags":["linq","query","sql-server-2005","entity-framework-4"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":396,"score":2,"question_id":10431578,"title":"Linq query giving Invalid column name \"xyz\" error","body":"<p>I am using this LINQ query</p>\n\n<pre><code>var db = new XYZ();\nvar product = (from cp in db.CatalogProducts\n               where cp.ProductID == productId\n               select cp).FirstOrDefault();\n</code></pre>\n\n<p>Running this query gives me an error </p>\n\n<blockquote>\n  <p>Invalid column name 'Cracker Cruncher'.<br>\n  Invalid column name 'crushing torque'.<br>\n  Invalid column name 'Slicing velocity'.</p>\n</blockquote>\n\n<p>Can any one help me in this matter?</p>\n\n<p>Gautam</p>\n"},{"tags":["ios","database","xcode","query","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":12686107,"title":"SQlite update is not working when switching between views in iOS","body":"<p>I have a Favorites view, that loads data from an sqlite database. It loads entry into cells obviously.</p>\n\n<p>The Favorites view class is named FavReal. I have enabled a canEditRowAtIndexPath with the action of deleting the entry from the database and removing it from the table View. It works fine! and also i have a clear all favorites button that removes all entry correctly.</p>\n\n<p>Now, if i click on a cell, it takes me to another View called Details22 view. In this view i get the details of the selected cell and it works.</p>\n\n<p>Now after clicking on an entry and going back to the Favorites View. If I try to delete an entry either by swipe gesture or by clear all button. It doesn't work :S no errors no nothing it just won't remove it from the database, and just remove it instantly from the table view.</p>\n\n<p>Here are my codes.</p>\n\n<p><b><i> /*  FavReal.m */ </b></i></p>\n\n<pre><code>//\n//  FavReal.m\n//  AuthorsApp\n//\n//  Created by georges ouyoun on 8/16/12.\n//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.\n//\n\n#import \"FavReal.h\"\n#import &lt;sqlite3.h&gt;\n#import \"Author.h\" \n#import \"Details22.h\"\n#import \"AuthorVC.h\"\n@interface FavReal ()\n\n@end\n\n@implementation FavReal\n@synthesize textLabel2;\n@synthesize theFav;\n@synthesize author; \nNSString *authorNAme;\nNSString *authorNAme3 , *authorNAme4;\nNSString *authorFav;\nNSString *PathDB;\n\n- (id)initWithStyle:(UITableViewStyle)style\n{\n    self = [super initWithStyle:style];\n    if (self) {\n        // Custom initialization\n    }\n    return self;\n}\n\n- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    NSLog(@\"entered the cellForRowAtIndexPath\");\n    static NSString *CellIdentifier2 = @\"FavoritesCell\";\n\n    UITableViewCell *cell2 = [tableView dequeueReusableCellWithIdentifier:CellIdentifier2];\n            NSLog(@\"Break before the if\");\n    if (cell2 == nil) {\n        NSLog(@\"Entered the nil cell 1 \");\n        cell2= [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier2];\n        NSLog(@\"Entered the nil cell 2 \");\n    }\n\n    Author *author8 = [self.theFav objectAtIndex:indexPath.row];\n    NSLog(@\"Author initialized\");\n    cell2.textLabel.text = author8.title;\n    NSLog(@\"This is the author8.title variable %@\" , author8.title);\n    NSLog(@\"Cell2 is initialized\");\n //   NSString *cellName = cell2.textLabel.text;\n\n //   [theFav release];\n        return cell2;\n\n}\n\n-(void)viewWillAppear:(BOOL)animated{\n//    [self.tableView cell];\n    NSLog(@\"§§§§§§§§§§§§§ VIew will appear phase 1 §§§§§§§§§§§§§§§§\");\n\n    [self authorList2];\n    [self.tableView reloadData] ;\n    NSLog(@\"§§§§§§§§§§§§§ VIew will appear §§§§§§§§§§§§§§§§\");\n   [self viewDidLoad];\n}\n\n- (void)viewDidLoad\n{\n      NSLog(@\"§§§§§§§§§§§§§ ViewDidLoad §§§§§§§§§§§§§§§§\");\n    UIBarButtonItem *nextButton = [[UIBarButtonItem alloc]\n                                   initWithTitle:@\"Clear All Favorites\"\n                                   style:UIBarButtonItemStyleBordered\n\n                                   target:self\n                                   action:@selector(deleteSomeStuff)];\n\n    [[self navigationItem] setLeftBarButtonItem:nextButton];\n\n    [nextButton release], nextButton = nil;\n\n    [self authorList2];\n    [super viewDidLoad];\n\n}\n\n- (void)viewDidUnload\n{\n\n    NSLog(@\"§§§§§§§§§§§§§ ViewDid UN-Load §§§§§§§§§§§§§§§§\");\n\n    [self setTextLabel2:nil];\n    [ClearBu release];\n    ClearBu = nil;\n    [super viewDidUnload];\n\n}\n\n-(void) viewWillDisappear:(BOOL)animated{\n\n}\n- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation\n{\n    return (interfaceOrientation == UIInterfaceOrientationPortrait);\n}\n\n#pragma mark - Table view data source\n\n- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView\n{\n#warning Potentially incomplete method implementation.\n    // Return the number of sections.\n    return 1;\n}\n\n- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section\n{\n#warning Incomplete method implementation.\n    int rowCount;\n\n     rowCount = theFav.count;\n    return rowCount;\n}\n\n-(NSMutableArray *) authorList2{\n\n    NSFileManager *fileManager = [NSFileManager defaultManager];\n\n    NSLog(@\"1\");\n    theFav = [[NSMutableArray alloc] initWithCapacity:1000000];\n\n    @try {\n        NSLog(@\"1 alpha:\");\n\n        BOOL success = [fileManager fileExistsAtPath:PathDB];\n        NSLog(@\"1 gamma\");\n        if(!success)\n        {\n            NSLog(@\"2\");\n            NSLog(@\"Cannot locate database file '%@'.\", PathDB);\n        }\n        NSLog(@\"Success\");\n        if(!(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK))\n        {\n            NSLog(@\"3\");\n            NSLog(@\"An error has occured: %@\", sqlite3_errmsg(db2));\n\n        }\n\n        NSLog(@\"Database opened\");\n        // const char *sql = \"SELECT F_Keyword FROM wordss\";  \n        const char *sql2 = \"SELECT Name FROM Fav\";\n\n        sqlite3_stmt *sqlStatement2;\n        if(sqlite3_prepare(db2, sql2, -1, &amp;sqlStatement2, NULL) != SQLITE_OK)\n        {\n            NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n        }else{\n            while (sqlite3_step(sqlStatement2)==SQLITE_ROW) {\n              //  NSLog(@\"Probleme not with the query but in here!!\");\n                Author * author2 = [[Author alloc] init];\n                //author2.fav = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement2,2)];\n                author2.title = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement2,0)];\n\n               // authorFav=author2.title;              \n                [theFav addObject:author2];\n\n            }\n        }\n    }\n    @catch (NSException *exception) {\n        NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }\n    @finally {\n\n        return theFav;\n    }\n}\n\n\n-(void)deleteSomeStuff{\n    NSLog(@\"Delete Button Clicked\");\n    @try {\n     //   NSLog(@\"This is the authorName2 variable %@\",authorNAme2);\n\n        sqlite3_stmt *compiled_statement1;\n\n        if(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK) {\n\n            NSString *formatedSql = [NSString stringWithFormat:@\"DELETE FROM Fav\"];\n\n            const char *sql = [formatedSql UTF8String];\n            NSLog(@\" !!!!!!!! In the middle of it !!!!!!!!!!!!\");\n            if (sqlite3_prepare_v2(db2, sql, -1, &amp;compiled_statement1, NULL) != SQLITE_OK) {\n                NSLog(@\"!!!!!!!!!!!!!!!!!!!ERRRRROOOOOOORRRRRRRRR!!!!!!!!!!!!!!!!!!!!!!!!!\");\n\n            }\n\n            NSLog(@\"This is the query %@\",formatedSql);\n\n\n            int success = sqlite3_step(compiled_statement1);\n\n            if (success != SQLITE_ERROR) {\n                NSLog(@\"Successfully Deleted!\");\n                sqlite3_last_insert_rowid(db2);\n            }\n\n            if(sqlite3_prepare(db2, sql, -1, &amp;compiled_statement1, NULL) != SQLITE_OK)\n            {\n                NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n\n            }else{\n\n                NSLog(@\"Got in the else tag where pictures should change \");\n\n                while (sqlite3_step(compiled_statement1)!=SQLITE_OK) {\n\n                    NSLog(@\"Got in the while tag\");\n                    break;\n                    }\n                }\n            }\n\n       // NSArray *arr;\n        [self.theFav removeAllObjects]; \n        [self.tableView reloadData];\n\n        }\n\n    @catch (NSException *exception) {\n\n        NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }\n    @finally {\n        sqlite3_close(db2);\n    }\n\n}\n\n/*\n// Override to support conditional editing of the table view.\n- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    // Return NO if you do not want the specified item to be editable.\n    return YES;\n}\n*/\n\n/*\n// Override to support editing the table view.\n- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    if (editingStyle == UITableViewCellEditingStyleDelete) {\n        // Delete the row from the data source\n        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];\n    }   \n    else if (editingStyle == UITableViewCellEditingStyleInsert) {\n        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view\n    }   \n}\n*/\n\n/*\n// Override to support rearranging the table view.\n- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath\n{\n}\n*/\n\n/*\n// Override to support conditional rearranging of the table view.\n- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    // Return NO if you do not want the item to be re-orderable.\n    return YES;\n}\n*/\n\n#pragma mark - Table view delegate\n\n- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath {\n    return YES;\n}\n- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {\n    if(editingStyle == UITableViewCellEditingStyleDelete)\n    {\n        @try{\n            if(!(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK))\n            {\n                NSLog(@\"3\");\n               // NSLog(@\"Could not open Db2\", sqlite3_errmsg(db2));\n\n            }\n            else {\n                NSLog(@\"Db2 is opened\");\n            }\n            NSIndexPath *indPath7= [NSIndexPath indexPathForRow:indexPath.row inSection:0]; \n            UITableViewCell *cell7 = [tableView cellForRowAtIndexPath:indPath7]; \n            NSString *cellText7 = cell7.textLabel.text;\n\n          //  NSLog(@\"§§§§§§§§§§§§§§§§§ This is the cell text §§§§§§§§§§\" , cellText3);\n            sqlite3_stmt *sqlStatement7;\n            NSString *titleString = [[[NSString alloc] initWithFormat:@\"%d\",indexPath.row] autorelease];\n\n            //const char *sql3 = [\"DELETE FROM Fav WHERE rowid = '%@'\" , titleString]  ;\n\n            NSString *formatedSql3 = [NSString stringWithFormat:@\"DELETE FROM Fav WHERE Name = '%@'\" ,cellText7];\n           // const char *formatedSql3 = [@\"DELETE FROM Fav WHERE rowid = '%@'\",titleString];\n\n            NSLog(@\"This is the DELETE Query %@\", formatedSql3);\n            const char *sql3 = [formatedSql3 UTF8String];\n            NSLog(@\"This is the titleString Variable %@ \" , titleString);\n\n            if(sqlite3_prepare(db2, sql3, -1, &amp;sqlStatement7, NULL) != SQLITE_OK)\n        {\n            NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n        }\n            else{\n\n                int successS = sqlite3_step(sqlStatement7);\n                if (successS != SQLITE_DONE) {\n                    NSLog(@\"An error Has occured during the delete of the specific record\");\n                }\n                else{\n\n                    NSLog(@\"Update Database successfull!\");\n                }\n            }\n        }    \n                @catch (NSException *exception) {\n                    NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n                }\n\n                @finally {\n                    //sqlite3_finalize(sql);\n                  //  sqlite3_close(db2);\n                    //return theFav;\n                }\n            [self.theFav removeObjectAtIndex:indexPath.row];\n            [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];\n\n    }\n}\n\n- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {\n\n    NSIndexPath *indPath3 = [NSIndexPath indexPathForRow:indexPath.row inSection:0]; \n    UITableViewCell *cell3 = [tableView cellForRowAtIndexPath:indPath3]; \n    NSString *cellText3 = cell3.textLabel.text;\n\n  //  NSLog(@\"This is at first : %@\" , authorNAme);\n  //   NSString *titleString2 = [[[NSString alloc] initWithFormat:@\"Element row number :  %d\",indexPath.row] autorelease];\n    NSLog(@\"This is the showDetailsForIndexPath\");\n\n    Details22 * vc4 = [self.storyboard instantiateViewControllerWithIdentifier:@\"Details22\"];\n    //FavReal* author;\n    NSLog(@\"This is the showDetailsForIndexPath 2\");\n\n    @try{\n            if(sqlite3_open([PathDB UTF8String], &amp;db2) == SQLITE_OK) {\n\n        NSString *titleString3 = [[[NSString alloc] initWithFormat:@\"Element row number :  %d\",indexPath.row] autorelease];\n        NSLog(@\"This is the row number chosen %@\",titleString3);\n\n       NSString *formatedSql333 = [NSString stringWithFormat:@\"Select * from Sheet1 where field3 = '%@'\" , cellText3 ];\n                const char *formatedSql3333 = [formatedSql333 UTF8String];\n\n        NSLog(@\"This is the SQLite Approriate Query %@\",formatedSql333);\n\n        sqlite3_stmt *sqlStatement3;\n\n        NSString *SearchedItem = cellText3;\n        NSLog(@\"This is the SearchedITem Variable %@\" , SearchedItem);\n\n        if(sqlite3_prepare(db2, formatedSql3333, -1, &amp;sqlStatement3, NULL) != SQLITE_OK)\n    {\n            NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }else{\n\n     while (sqlite3_step(sqlStatement3)!=SQLITE_ERROR) {\n\n         NSLog(@\"Entered the While tag\");   \n         NSString *SearchedItem = cellText3;\n         NSLog(@\"This is the SearchedITem Variable %@\" , SearchedItem);\n\n\n                Author * author3 = [[Author alloc] init];\n         NSLog(@\" Debug 1  \");\n\n                author3.name = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement3,2)];\n                  NSLog(@\" Debug 2  \");\n\n                NSLog(@\"This is the author.name in the FavReal %@\" , author3.name);\n\n                author3.title = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement3,3)];\n         NSLog(@\"This is the author.TITLE in the FavReal %@\" , author3.title);\n\n                author3.genre = [NSString stringWithUTF8String:(char *) sqlite3_column_text(sqlStatement3, 6)];\n         NSLog(@\"This is the author.GENRE in the FavReal %@\" , author3.genre);\n         NSLog(@\"This is the authorName before %@\", authorNAme);\n         NSLog(@\"This is the authorName2 before %@\", authorNAme2);\n         authorNAme = author3.genre;\n         authorNAme2 = author3.name;\n\n         NSLog(@\"This is the authorName after %@\", authorNAme);\n         NSLog(@\"This is the authorName2 after %@\", authorNAme2);\n\n         NSLog(@\"Before the break\");\n         NSLog(@\"Before the animation part\");\n         [self.navigationController pushViewController:vc4 animated:true];   \n         NSLog(@\"Passed the should animate part\");\n\n         break;\n         NSLog(@\"After the break\");\n     }     \n               }\n    }\n    }\n\n    @catch (NSException *exception) {\n        NSLog(@\"Problem with prepare statement:  %@\", sqlite3_errmsg(db2));\n    }\n    @finally {\n        sqlite3_close(db2);\n        NSLog(@\"The database should NOT be closed here\");\n    }\n}\n\n- (UITableViewCellAccessoryType)tableView:(UITableView *)tableView accessoryTypeForRowWithIndexPath:(NSIndexPath *)indexPath {\n\n    //return UITableViewCellAccessoryDetailDisclosureButton;\n    return UITableViewCellAccessoryDisclosureIndicator;\n}\n\n- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath {\n\n    [self tableView:tableView didSelectRowAtIndexPath:indexPath];\n}\n\n- (void)dealloc {\n    [theFav release];\n    [self release];\n    [textLabel2 release];\n    [textLabel2 release];\n    [ClearBu release];\n    [super dealloc];\n}\n- (IBAction)ClearButtonAction:(id)sender {\n\n    NSLog(@\"Clear Button is Clicked\");\n}\n@end\n</code></pre>\n\n<p><b><i> /* Details22.m */ </b></i> </p>\n\n<pre><code>//\n//  Details.m\n//  AuthorsApp\n//\n//  Created by georges ouyoun on 7/17/12.\n//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.\n//\n\n#import \"AppDelegate.h\"\n#import \"Details22.h\"\n#import \"Author.h\"\n#import \"AuthorVC.h\"\n#import &lt;sqlite3.h&gt;\n#import \"FavReal.h\"\n//#import \"MTPopupWindow.h\"\n\n\n@interface Details22 ()\n\n@end\n\n@implementation Details22\n//@synthesize Favo;\n@synthesize text2;\n@synthesize WebV2;\n@synthesize labelText;\n@synthesize selectedAuthors;\n@synthesize author , infoRequest;\nNSUInteger textFontSize2 = 20;\nNSString *PathDB; \n- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil\n{\n    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];\n    if (self) {\n        // Custom initialization\n    }\n    return self;\n}\n\n- (void)viewDidLoad\n{\n    [super viewDidLoad];\n\n    NSLog(@\"In the viewDidLoad this is the current value of the textFontSize %d\" , textFontSize2);\n\n    NSString * htmlString = [NSString stringWithFormat:@\"\\\n                             &lt;html&gt;\\\n                             &lt;body&gt;\\\n                             &lt;p dir='rtl' style = 'font-size:40px;'&gt; %@ &lt;/p&gt;\\\n                             &lt;/body&gt;\\\n                             &lt;/html&gt;\",authorNAme];\n\n\n    [self.WebV2 setScalesPageToFit:YES];\n    [self.WebV2 loadHTMLString:htmlString baseURL:nil];\n\n    self.text2.text = authorNAme2;\n\n    /* ////////////////////////////////////////////         This is where the label text APPearsssssssss       ///////////////////////////          */\n\n    NSLog(@\"Everything is ok now !\");\n\n}\n- (void)viewDidUnload\n{\n    //  [self setLabelText:nil];\n    NSLog(@\"U have entered view did unload in Details22\");\n\n    //[FavReal initialize];\n\n    [self setText2:nil];\n\n    [self setWebV2:nil];\n\n    [sizeFontFromStepper release];\n    sizeFontFromStepper = nil;\n    [super viewDidUnload];\n\n    //[self setLabelText:Nil];\n    //[AuthorVC load];\n\n    //[self release];\n   // NSLog(@\" FAvReal should have been initialised \");\n    // Release any retained subviews of the main view.\n}\n\n-(void)viewWillAppear:(BOOL)animated\n{ \n    NSLog(@\"U have entered the viewWillAppear tag\");\n}\n\n-(void) viewWillDisappear:(BOOL)animated{\n\n      NSLog(@\"This is the view will disappear tag in Details22\");\n\n}\n\n- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation\n{\n    return YES;\n}\n\n- (void)dealloc {\n    [labelText release];\n\n    [text2 release];\n   // [fontStep release];\n    [WebV2 release];\n    [sizeFontFromStepper release];\n   // [sizeFontFromStepper release];\n    [super dealloc];\n}\n\n-(void)loadHTMLString:(int)textFontSize2\n{\n    NSString * htmlString = [NSString stringWithFormat:@\"\\\n                             &lt;html&gt;\\\n                             &lt;body&gt;\\\n                             &lt;p dir='rtl' style = 'font-size:%dpx;'&gt; %@ &lt;/p&gt;\\\n                             &lt;/body&gt;\\\n                             &lt;/html&gt;\",textFontSize2,authorNAme];\n\n    NSLog(@\"This is the loadHTMLString function with a textFonSize of %d\" , textFontSize2);\n\n    //[self.WebV setScalesPageToFit:YES];\n    [self.WebV2 loadHTMLString:htmlString baseURL:nil];\n\n}\n- (IBAction)loadHtmlNewFontSize:(int)textFontSize2 {\n\n    textFontSize2 = sizeFontFromStepper.value;\n\n    [self loadHTMLString:textFontSize2];\n\n    NSLog(@\"This is textFontSize %d\" , textFontSize2);\n}          \n\n@end\n</code></pre>\n\n<p>Anyone ?</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13028925,"title":"Remove duplicates when joining tables","body":"<p>I have a news table as follows</p>\n\n<p>News:</p>\n\n<pre><code>| id  | title                       | description\n| 1   | Breaking news               | bla bla bla\n| 2   | Heavy snowfall in london    | bla bla bla\n</code></pre>\n\n<p>a Type table as follows:</p>\n\n<pre><code>| id  | type_name   | type_code\n| 1   | weather     | 0567\n| 2   | city        | 0653\n</code></pre>\n\n<p>and a NewsType table as follows</p>\n\n<pre><code>|id | news_id | type_id | created_by |\n| 1 | 2       | 1       | \"John\"     |\n| 2 | 2       | 2       | \"Alex\"     |\n</code></pre>\n\n<p>As you can see from the NewsType table that a single news can fall into two or more types.</p>\n\n<p>I need to display news corresponding to types. A user might say give me all the news about cities and weather. To display this I am doing something like:</p>\n\n<pre><code>      select distinct n.* , nt.created_at\n      from news n, newstype nt, type t where\n      n.id = nt.news_id and\n      t.id = nt.type_id \n      order by nt.created_at\n      limit 25\n</code></pre>\n\n<p>The problem is this query returns the same news twice (I think it's because of the inner join I am doing). What should I change in the query so that if a news is classified as two types, and the user has requested to view the same two types of news, I get only single news item? instead of two!</p>\n"},{"tags":["sql","oracle","query","count"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13028358,"title":"Incorrect results with COUNT function?","body":"<p>I'm a beginner to SQL using ORACLE and have run into a few problems. I have a basic database with 4 tables (HOTEL,ROOM,BOOKING,GUEST) which are populated with data regarding price of rooms ext.</p>\n\n<p>I have a written query that is supposed to find the numbers and names of guests who booked rooms in the price range between 230 and 350 dollars. Also show also how many times they booked such rooms. However, it doesn't seem to be giving me the correct output and I can't figure out why. Here's the query:</p>\n\n<pre><code>SELECT GUEST.GUEST_NAME \"GUEST NAME\",GUEST.GUEST_NO \"GUEST NUMBER\", \nCOUNT(GUEST.GUEST_NO)     \"NUMBER OF TIMES BOOKED\"\nFROM ROOM, GUEST, BOOKING\nWHERE R_PRICE&gt;=260\nAND R_PRICE&lt;=350\nAND GUEST.GUEST_NO = BOOKING.GUEST_NO\nAND ROOM.HOTEL_NO = BOOKING.HOTEL_NO\nGROUP BY GUEST.GUEST_NO, GUEST.GUEST_NAME\nORDER BY \"NUMBER OF TIMES BOOKED\" ASC;\n</code></pre>\n\n<p>And the output: </p>\n\n<pre><code>Tina Duncan      G001    2\nJenny Freeman    G003    2\nMartin Ferguson  G006    3\nPaul Happy       G002    3\nSteve Kirkwood   G005    3\n</code></pre>\n\n<p>Here is sample for tables:</p>\n\n<p>ROOM: </p>\n\n<pre><code>   ROOM_NO HOTEL_NO R_TYPE\n------- -------- ------ ---------\n1       H100     S          220\n2       H100     D          230\n3       H100     F          310\n1       H200     S          260\n2       H200     D          170\n3       H200     S          250\n4       H200     F          180\n5       H200     F          295\n1       H300     D          200\n2       H300     S          420\n</code></pre>\n\n<p>BOOKING:</p>\n\n<pre><code>DATE_FROM DATE_TO   ROOM_NO\n--------- --------- -------\n15-AUG-12 17-AUG-12 1\n30-AUG-12 15-SEP-12 2\n01-AUG-12 02-AUG-12 2\n10-AUG-12 11-AUG-12 2\n01-SEP-12 15-SEP-12 3\n31-JUL-12 02-AUG-12 1\n11-JUL-12 01-AUG-12 1\n12-JUL-12 13-JUL-12 1\n14-JUL-12 15-JUL-12 1\n17-AUG-12 28-AUG-12 2\n31-JUL-12 01-SEP-12 1\n31-AUG-12 01-SEP-12 2\n31-AUG-12 15-SEP-12 4\n01-SEP-12 15-SEP-12 1\n</code></pre>\n\n<p>GUEST:</p>\n\n<pre><code>GUEST_NO G_NAME\n-------- --------------------\nG001     Tina Duncan\nG002     Paul Happy\nG003     Jenny Freeman\nG012     Dianne Kelly\nG005     Steve Kirkwood\nG006     Martin Ferguson\nG007     Vanessa Horton\nGoo8     Bianca Begg\n</code></pre>\n\n<p>The output should be:</p>\n\n<pre><code>Paul Happy       G002    2\nJenny Freeman    G003    1\nSteve Kirkwood   G005    1\nMartin Ferguson      G006    1\nDianne Kelly     G012    1\n</code></pre>\n\n<p>Hopefully I have given you enough, i'd appreciate it heaps if i could get a little help. Thanks guys! </p>\n"},{"tags":["sql","query","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13027608,"title":"Query explanation","body":"<p>I have a query similar to the following,</p>\n\n<pre><code>select * from T1 where abc in (select distinct abc from T2);\n</code></pre>\n\n<p>the scenario is that there is <strong>NO field named abc in table T2</strong>, so the inner query goes invalid, but still the whole query returns the output. </p>\n\n<p>What is the reason for this behaviour?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13027957,"title":"How to make query with ORDER BY and LIMIT work faster?","body":"<p>In my project I have a loop that runs the same query but with different limit values. In the first 10 loop cycles, query is executed with acceptable speed, but then slow down. Table to which I'm making query has 150K registers and <code>column1</code> is Integer and my query is:</p>\n\n<pre><code>SELECT * FROM my_table ORDER BY column1 ASC LIMIT 0,1000\n...\nSELECT * FROM my_table ORDER BY column1 ASC LIMIT 9000,10000\n</code></pre>\n\n<p>As I understood it sorts all 150K registers each time. But how can I sort register only between indicated range?\nHow can I make this query work faster? </p>\n"},{"tags":["c","windows","query","gpu","temperature"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13017148,"title":"How do I get GPU usage per process?","body":"<p>I have a temperature monitor program I wrote a while back which monitors the temperatures and fans on my AMD Graphics cards, checking for fan failure OR overheats.\nThe problem with it, is that it needs to know in advance which process will be using the GPU(Graphics Processing Unit), in order to kill it or gracefully make it stop to avoid overheating.</p>\n\n<p>To make my program more dynamic, I needed a way to find which process is using the GPU, much like which process is using CPU time(Task Manager). One such application is Process Explorer from SysInternals.</p>\n\n<p>I am asking, how may I do this in Windows in C? I am aware that if there is such a way, it would target Vista and above.</p>\n"},{"tags":["query","hibernate","caching","second-level-cache","hazelcast"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13027369,"title":"clear specific query in the QueryRegion","body":"<p>How can I clear a specific query in some query region that I created, and not all of the query region.</p>\n\n<p>I'm using Hibernate and Hazelcast as second level cache.  </p>\n"},{"tags":["sql","query","grails-2.0","grails-controller"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13022595,"title":"MSSQL/SQL Query condition error","body":"<p>I have this 2 following SQL Queries on my grails controller:</p>\n\n<pre><code>def query1 = sql.rows(\"select abc from table_one where cond = 1\")\n</code></pre>\n\n<p>The return result from query1 gives me <code>[{abc=5}]</code></p>\n\n<pre><code>def query2 = sql.rows(\"select req from table_two where abc = \" +query1)\n</code></pre>\n\n<p>I am having an error trying to run query2 and I have no idea why.</p>\n\n<p>the column name <code>abc</code> exist in both <code>table_one</code> and <code>table_two</code>, I am trying to fetch the value of <code>abc</code> from <code>table_one</code>, whereby <code>cond = 1</code>, and assign it to variable query1.</p>\n\n<p>and with query2, I am trying to get the values of <code>req</code> from <code>table_two</code>, whereby the value of <code>abc</code> in <code>table_two</code> is equals to the value of query1.</p>\n\n<p>any help on this?</p>\n\n<p>Error message from query2:</p>\n\n<pre><code>Message:Unclosed quotation mark after the character string '[abc:5]'.\n</code></pre>\n"},{"tags":["php","mysql","database","query","triggers"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13017086,"title":"Update table value on page view?","body":"<p>I am trying to create a PHP trigger for when a user views certain pages on my website it will update the user table in the <strong>points</strong> section.</p>\n\n<p>I understand the process would work something like this</p>\n\n<pre><code>on page view &gt; update user &gt; where user id is (**get username from session**) &gt; add 5 to points row\n</code></pre>\n\n<p>Anyone have any idea how to set up something simple like this for giving users simple points for viewing pages? </p>\n\n<p>My site is using PHP and mySQL for the database.</p>\n"},{"tags":["php","sql","database","query","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13024545,"title":"PHP SQL Query error 22 no file found only on insertion","body":"<p>Hy,</p>\n\n<p>I'm making an website that inserts data into an db. It can pull all the data out of the db with no problem, but somehow it goes wrong when i insert the data.</p>\n\n<p>This is the part that gets the values and make the query and execute the query:</p>\n\n<pre><code>    $facility_id = $_POST['facilityID'];\n    $location_zone_area = $_POST['locationZoneArea'];\n    $facility_type = $_POST['facilityType'];\n    $structure_type = $_POST['structureType'];\n    $material_type = $_POST['materialType'];\n    $cause_of_defect = $_POST['causeOfDefect'];\n    $defect_outcome = $_POST['defectOutcome'];\n    $repair_strategy = $_POST['repairStrategy'];\n    $defect_description = $_POST['defectDescription'];\n    $defect_condition = $_POST['defectCondition'];\n    $likelihood_of_failure = $_POST['likelihoodOfFailure'];\n    $consequence_of_failure = $_POST['consequenceOfFailure'];\n    $value = $_POST['value'];\n    $risk = $_POST['risk'];\n    $inspection_frequency = $_POST['inspectionFrequency'];\n    $remarks = $_POST['remarks'];\n    $structure_plan = $_POST['structurePlan'];\n    $name_of_supervisor = $_POST['nameOfSupervisor'];\n    $date = $_POST['date'];\n    $email = $_POST['email'];\n\n    $sQueryInsertData = \"   INSERT INTO `\n                            \".DB_PREFIX.\"main` \n                            (`facility_id`,`location_zone_area`,`structure_type`,`material_type`,`cause_of_defect`,`defect_outcome`,`repair_strategy`,`defect_description`,`defect_condition`,`likelihood_of_failure`,`consequence_of_failure`,`value`,`risk`,`inspection_frequency`,`remarks`,`structure_plan`,`name_of_supervisor`,`date`,`email`,`facility_type`) VALUES ('$facility_id','$location_zone_area','$structure_type','$material_type','$cause_of_defect','$defect_outcome','$repair_strategy','$defect_description','$defect_condition','$likelihood_of_failure','$consequence_of_failure','$value','$risk','$inspection_frequency','$remarks','$structure_plan','$name_of_supervisor','$date', '$email','$facility_type')\";\n    $insertSuccesfull = do_query($sQueryInsertData,'INSERT');\n</code></pre>\n\n<p>The do_query:</p>\n\n<pre><code>function do_query($le_query_to_execute, $type_to_do) {\n    global $link2;\n    switch ($type_to_do) {\n        case 'SELECT' :\n            $return_value = mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)));\n            return $return_value;\n            break;\n        case 'UPDATE' :\n            if (mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)))) {\n                return TRUE;\n            }\n            break;\n        case 'DELETE' :\n            if (mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)))) {\n                return TRUE;\n            }\n            break;\n        case 'INSERT' :\n            if (mysqli_query($link2,$le_query_to_execute) or die(mysqlError($le_query_to_execute, mysqli_error($link2)))) {\n                return TRUE;\n            }\n            break;\n        default :\n            mysqlError($le_query_to_execute,'Er is geen keuze gemaakt wat voor soort type qeury het is.');\n            return FALSE;\n            break;\n    }\n    return FALSE;\n}\n</code></pre>\n\n<p>And the error i get:</p>\n\n<pre><code>There is an error in the query:\n\nINSERT INTO ` facilitydb_main` (`facility_id`,`location_zone_area`,`structure_type`,`material_type`,`cause_of_defect`,`defect_outcome`,`repair_strategy`,`defect_description`,`defect_condition`,`likelihood_of_failure`,`consequence_of_failure`,`value`,`risk`,`inspection_frequency`,`remarks`,`structure_plan`,`name_of_supervisor`,`date`,`email`,`facility_type`) VALUES ('mcot','nederland / hiero / daar','Administration','Concrete','Low cement content and finely ground cement','Highly permeable concrete','Repair','Defect descri','Lighthouse.jpg','2','1','2','Very Low','Inspection/maintenance in a maximum of 5 yearsâ€™ time','kaput','Hydrangeas1.jpg','Marc MEesters','now', 'abcdingetje@gmail.com','building')\n\nThis is the error mysqli gave: \nCan't find file: '.\\facilitydb2test\\@000d@000a@0009@0009@0009@0009@0009@0009@0009facilitydb_main.frm' (errno: 22)\n</code></pre>\n\n<p>Data of the table facility_main:</p>\n\n<pre><code>CREATE TABLE `facilitydb_main` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `facility_id` text NOT NULL,\n  `location_zone_area` text NOT NULL,\n  `structure_type` text NOT NULL,\n  `material_type` text NOT NULL,\n  `cause_of_defect` text NOT NULL,\n  `defect_outcome` text NOT NULL,\n  `repair_strategy` text NOT NULL,\n  `defect_description` text NOT NULL,\n  `defect_condition` text NOT NULL,\n  `likelihood_of_failure` int(11) NOT NULL,\n  `consequence_of_failure` int(11) NOT NULL,\n  `value` int(11) NOT NULL,\n  `risk` text NOT NULL,\n  `inspection_frequency` text NOT NULL,\n  `remarks` text NOT NULL,\n  `structure_plan` text NOT NULL,\n  `name_of_supervisor` text NOT NULL,\n  `date` text NOT NULL,\n  `email` text NOT NULL,\n  `facility_type` text,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n</code></pre>\n"},{"tags":["sql","database","oracle","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":52,"score":-1,"question_id":13024058,"title":"Write a query Display Dept Name , Job Name , \"count of employees in job for each dept\" & \"Count of employees in dept\"","body":"<p>I need to display the count of employees in job for each dept and count employees in dept. My desired output is like this:</p>\n\n<pre><code>DNAME                JOB                    Count(*)    Count(*)\n-----                ---                    --------    --------\nSALES                Manager                       3           5\nACCOUNTING           SALESMAN                      4           2\n</code></pre>\n\n<p>How can I do this? Can I use a sub query?</p>\n"},{"tags":["query","asp-classic","parameterized","named-parameters"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4597,"score":2,"question_id":1092512,"title":"ASP Classic Named Parameter in Paramaterized Query: Must declare the scalar variable ","body":"<p>I'm trying to write a parameterized query in ASP Classic, and it's starting to feel like i'm beating my head against a wall. I'm getting the following error:</p>\n\n<blockquote>\n  <p>Must declare the scalar variable \"@something\".</p>\n</blockquote>\n\n<p>I would swear that is what the hello line does, but maybe i'm missing something...</p>\n\n<pre><code>&lt;% OPTION EXPLICIT %&gt;\n&lt;!-- #include file=\"../common/adovbs.inc\" --&gt;\n&lt;%\n\n    Response.Buffer=false\n\n    dim conn,connectionString,cmd,sql,rs,parm\n\n    connectionString = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Data Source=.\\sqlexpress;Initial Catalog=stuff\"\n    set conn = server.CreateObject(\"adodb.connection\")\n    conn.Open(connectionString)\n\n    set cmd = server.CreateObject(\"adodb.command\")\n    set cmd.ActiveConnection = conn\n    cmd.CommandType = adCmdText\n    cmd.CommandText = \"select @something\"\n    cmd.NamedParameters = true\n    cmd.Prepared = true\n    set parm = cmd.CreateParameter(\"@something\",advarchar,adParamInput,255,\"Hello\")\n    call cmd.Parameters.append(parm)\n    set rs = cmd.Execute\n    if not rs.eof then\n    \tResponse.Write rs(0)\n    end if\n\n\n%&gt;\n</code></pre>\n"},{"tags":["sql","database","query","ms-access","syntax-error"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12925244,"title":"Vague \"Syntax error in join operation\" - Access 2003","body":"<p>For some time, I've had this block of SQL which has worked for a month:</p>\n\n<pre><code>SELECT \n    F.[BRANCH] AS REGION\n    , F.[ACCOUNT]\n    , F.[EFFECTIVE]\n    , F.[POLICY]\n    , F.[DESC2]\n    , F.[DESC4]\n    , F.[GROSS]\n    , F.[COMM]\n    , F.[GST ON COMM]\n    , F.[ENTRYDATE]\n    , I.[TYPE] \nFROM (\n    (SELECT [POLP - Detailed Debtors Import].* \n     FROM [POLP - Detailed Debtors Import]  \n     WHERE [POLP - Detailed Debtors Import].[EFFECTIVE] &lt;= DateValue(\"30/05/2012\")  \n        AND [POLP - Detailed Debtors Import].[GROSS] &gt;= 0  \n        AND [POLP - Detailed Debtors Import].[DESC4] IN ('RNWL', 'NEWB', 'EP')  \n        AND [POLP - Detailed Debtors Import].[DUEYR] = 2012) AS F \n        INNER JOIN (SELECT IPM_ACCTXREF.* FROM IPM_ACCTXREF  \n                        WHERE IPM_ACCTXREF.TYPE \n                            IN (SELECT [Evolve - Account Types].[Account Types] \n                                FROM [Evolve - Account Types])\n                        ) AS I ON F.[ACCOUNT] = I.[ACCOUNT]\n    ) \n    LEFT JOIN (SELECT  [POLP - Detailed Debtors Import].* \n                  FROM [POLP - Detailed Debtors Import]  \n                  WHERE [POLP - Detailed Debtors Import].[DESC4] IN ('CS', 'CANC', 'JL')\n                  ) AS S ON F.[POLICY] = S.[POLICY] \nWHERE S.[POLICY] IS NULL\n</code></pre>\n\n<p>I then wanted to make a change to the DateValue parameter (which would be as simple as changing say, the 5 to a 6).</p>\n\n<p>Problem then is that I get a \"Syntax error in JOIN operation\" repeated three times. Clicking through each of them, the query then displays the resulting table but with \"#Name?\" populated in each field.</p>\n\n<p>Not sure what's happening here...</p>\n"},{"tags":["mysql","query","distinct"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13021528,"title":"MySQL select distinct dateTime. Cant figure this query out","body":"<p>My users answer two different questions, they are added to my answers_table as one row each. I'm trying to count how many users have answered my questions which seems simple at first. Count(*) and divide by 2. YES! But: the users can add new questions as they go, so suddenly there might be three questions, all answers/3 becomes an incorrect number of users if there was two  questions for a while and then three, for example!</p>\n\n<p>Can anyone figure out a query for doing this? So far I've got</p>\n\n<pre><code>SELECT COUNT(DISTINCT date) as totNum FROM login_answers\n</code></pre>\n\n<p>But it doesn't take the time in consideration. Meaning i just get the amount of answers in total for that day, not knowing how many questions was available that day.</p>\n\n<p>Here's my table:</p>\n\n<p>qid is the QuestionID so i guess thats somewhere to start?</p>\n\n<pre><code>id      qid answer  date                deviceID\n1502    2   2       2012-10-19 08:42:41 7\n1503    1   3       2012-10-19 08:51:53 7\n1504    2   2       2012-10-19 08:51:53 7\n1505    1   4       2012-10-19 09:05:23 7\n1506    2   2       2012-10-19 09:05:23 7\n1507    1   4       2012-10-19 09:40:59 7\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13021312,"title":"query to count MySQL rows","body":"<p>Trying to get a count (to later multiply with a rate) of names in upto (if data is present in one or more) four rows.  In other words, there is a price per person occupying a room.  So, I want to count the number of persons in the room by names entered on the form and saved in the database table.</p>\n\n<p>I <em>could</em> simply add a field where the user also selects the number of people in addition to completeing the name fields but this seems redundant (and prone to error).</p>\n\n<h2>Setup</h2>\n\n<p>Table: 1.<em>clients</em> which has columns: </p>\n\n<pre><code>id, \ntourbk_id, \ntourstart, \nroomtype1, \nclient1_name, \nclient2_name, \nclient3_name, \nclient4_name\n</code></pre>\n\n<h2>Question</h2>\n\n<p>I have a query which currently checks the roomtype to the per person price for that room type and is working to produce the result but, of course, it is only returning (for two people in a room) the price person for double occupancy.  </p>\n\n<p>E.g.: (per person prices)... single = $10; double = $20; triple = $30; quad = $40 </p>\n\n<p>My current result for double room is $20 (which echo's next to \"Price per person\".  I need a query to count the total persons in this double and multiple times the rate ... \"Total:  query[$20 * 2]\"</p>\n\n<p>How do I code a query to count the <em>\"client</em>_name\" entries in a table? </p>\n"},{"tags":["query","url","actionscript","parameters","swfaddress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13017581,"title":"SWFAddress used to change INDIVIDUAL params in the url","body":"<p>I am using SWFAddress in actionscript 3 to control urls for navigation and controls, and while I am able to target and change specific parameters, I feel like I am missing a cleaner and more consistent way of handling it, perhaps even a feature or method I am not aware of.</p>\n\n<p>Say I have a url and I want to change just the second param of <em>def</em> to <em>xyz</em>.</p>\n\n<p><code>http://localhost/some-page/#/?param1=abc&amp;param2=def&amp;param3=ghi</code> changed to\n<code>http://localhost/some-page/#/?param1=abc&amp;param2=xyz&amp;param3=ghi</code></p>\n\n<p>I currently am doing:</p>\n\n<pre><code>if (SWFAddress.getParameterNames().indexOf(\"param2\") &gt;= 0) {\n    SWFAddress.setValue(SWFAddress.getPath() + \"?\"\n       + SWFAddress.getQueryString().replace(\"param2=\" + SWFAddress.getParameter(\"param2\"), \"param2=xyz\"))\n</code></pre>\n\n<p>Essentially, checking if the param exists, checking what its current value is, then recreating the whole url using <em>base</em>, '?\", and <em>query</em>, making sure I replace the the parameter <em>and</em> the parameter's value, making sure I don't miss the <em>equal sign</em>. This get's sloppy, and is error prone if the param exists but is not set to anything, or whether or not there is an equal sign, and a host of other pitfalls.</p>\n\n<p>So, I can not just tell SWFAddress to update that one parameter in the url? A theoretical function of SWFAddress.setParam(\"param2, \"xyz\").</p>\n\n<p>Has anyone coded their own method to micro-manipulate SWFAddress and the url, beyond the single function they supply you with of setValue(val:String)?</p>\n"},{"tags":["query","node.js","mongodb","geddy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13001245,"title":"Query mongodb with geddy","body":"<p>While trying out the node.js framework geddy (on windows) and i've run into a bit of a problem.</p>\n\n<p>I'm trying to query mongodb, in my controller, using the .first() method from my Users Model like so:</p>\n\n<pre><code>geddy.model.User.first({name: 'jdoe'}, function (err, data) {\n  if (err) {\n    throw err;\n  } else {\n    console.log(data);\n  }\n\n});\n</code></pre>\n\n<p>Strangely enough i'm not getting any output, error, nothing. The user jdoe exists in the collection so it should output something, right ? Am i doing something wrong ?</p>\n\n<p>My model is defined as:</p>\n\n<pre><code>var User = function () {\n\n    this.defineProperties({\n      username: {type: 'string', required: true},\n      password: {type: 'string', required: true},\n    });\n\n    this.autoIncrementId = true;\n\n};\n\nUser = geddy.model.register('User', User);\n</code></pre>\n\n<p>The default adapter is set to mongo in development.js, when i ran geddy for the first time it created my database and it has inserted the Users collection correctly.</p>\n\n<p>Any idea on whats going wrong here ?</p>\n\n<p>UPDATE:</p>\n\n<p>added development.js as requested</p>\n\n<pre><code>var config = {\n  detailedErrors: true\n, debug: true\n, hostname: null\n, port: 4000\n, model: {\n    defaultAdapter: 'mongo',\n    }\n,db: {\n    mongo: {\n        dbname: 'knowledgebase'\n    }\n}\n, sessions: {\n    store: 'memory'\n  , key: 'sid'\n  , expiry: 14 * 24 * 60 * 60\n  }\n};\n\nmodule.exports = config;\n</code></pre>\n\n<p>also my collections on mongo ( created by geddy )</p>\n\n<pre><code>&gt; show collections\nUser\nsystem.indexes\nusers\n</code></pre>\n\n<p>note that somehow geddy is creating two collections instead of one</p>\n"},{"tags":["php","mysql","query","fatal-error"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13020298,"title":"Catchable fatal error: Object of class mysqli_result could not be converted to string","body":"<p>Trying to get my first multi-table MySQL database but i've gut an error I just can wrap my head around.  Can someone please suggest an approach before I toss my computer out a window?</p>\n\n<h2><strong>Setup</strong></h2>\n\n<p>I have two tables:  </p>\n\n<ol>\n<li><em>clients</em> which has rows: *id, tourbk_id, tourstart, roomtype1, client_name*</li>\n<li><em>tourprices</em> which has rows: *id, tour_id, tourstart, roomtype, roomprice*</li>\n</ol>\n\n<h2><strong>Goal</strong></h2>\n\n<p>I'm intending for the following query to look, in the <em>clients</em> table for the tour the client wishes to purchase, compare the tour date + tour name + room type in the <em>client</em> table, and echo the price.  </p>\n\n<h2><strong>My <em>fubar</em> Query</strong></h2>\n\n<pre><code>    $tourquery = \"SELECT t.roomprice \n         FROM clients c, tourprices t \n         WHERE c.roomtype1 = t.roomtype \n         AND c.tourstart = t.tourstart\n         AND c.tourbk_id = t.tour_id\"; \n$tourresult = $db-&gt;query($tourquery); \n\necho '&lt;strong&gt;',\"Per room amount:  \",'&lt;/strong&gt;'.$tourresult. \"\";\n\n$tourresult-&gt;free();\n</code></pre>\n\n<p>As-is, the result is just an error stating:\n<strong>Catchable fatal error: Object of class mysqli_result could not be converted to string</strong></p>\n\n<p>any help is much appreciated.</p>\n"},{"tags":["php","query","if-statement","statement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":56,"score":-4,"question_id":13020098,"title":"PHP Script Won't Execute Echo in If/Else","body":"<p>I'm populating a table with a sql query. One of the rows is $row['com'] and it just returns 1's or 0's. what I want to do is replace the 1's and 0's with an icon image (green.png/red.png). I'm trying to use a if/else statement but I'm not sure how to get it working. Any help would be appreciated. </p>\n\n<pre><code>    mysql_select_db(\"RRRC\", $con);\n\n    $result = mysql_query(\"SELECT * FROM mainreq WHERE roomnum=$loc\");\n\n    echo \"&lt;table border='0'&gt;\n    &lt;tr&gt;\n    &lt;th&gt;Requests&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;/tr&gt;\";\n\n    while($row = mysql_fetch_array($result))\n    {\n        echo \"&lt;tr&gt;\";\necho \"&lt;td&gt;&lt;a href='roomdata.php?loc=\".$row['roomnum'].\"&amp;uni=\".$row['uniint'].\"&amp;com=\".$row['com'].\"'&gt;\".$row['timesub'].\"&lt;/a&gt;&lt;/td&gt;\";\necho \"&lt;td&gt;&lt;center&gt;\" . \n\n  if ($row['com'] == 1)\n    {\n      echo \"&lt;img src=\"images/green.png\" alt=\"logo\"/&gt;\";\n    }\n  else\n    {\n      echo \"&lt;img src=\"images/red.png\" alt=\"logo\"/&gt;\";\n    } \n. \"&lt;/center&gt;&lt;/td&gt;\";\n        echo \"&lt;/tr&gt;\";\n    }\n    echo \"&lt;/table&gt;\";\n</code></pre>\n"},{"tags":["javascript","jquery","html","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13020038,"title":"Allow only one query result per table cell","body":"<p>I have a jquery script that accesses a db and returns a numeric result and writes that result into a table cell. This scripts runs when the page loads but also when the drop down menu is changed. I want to be able to limit only 1 result per table cell. </p>\n\n<p>Right now when page loads it writes the result to the cell and when the drop down menu is changed it just adds the new result to the cell instead of replacing it.</p>\n\n<p>I have search quite a bit trying to figure out how to do this and can not come up with anything. Can someone help me?</p>\n\n<p>Here is the jQuery:</p>\n\n<pre><code>$(document).ready(function(){\n\n$('.typeval').change(function(){\n    var movement    =  $(this).val();\n    var client_id   = $(this).parent().siblings().find('.clientval').val();\n    var class_id    = &lt;? echo $class_id; ?&gt;;\n        $count      = $(this).parents('tr').find('label.count');\n\n$.ajax({ \n  type: \"POST\",\n  url: \"movement_count.php\",\n  data: {movement:movement, client_id:client_id, class_id:class_id},\n  dataType: \"json\", \n  async: false,\n  success:(function(output) {      \n\n      $.each(output, function(index, value){\n     //alert(value);\n     $count.append(output[index]);\n     }); // each\n     })     \n}) // ajax\n\n}).change(); // .typeval\n\n});  // document\n</code></pre>\n\n<p>Here is the table cell where I only want to show one result at a time.</p>\n\n<pre><code>&lt;td&gt;&lt;label class=\"count\"&gt;5&lt;/label&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Please let me know if I have not provided enough info for the assistance needed.</p>\n"},{"tags":["sql","query","postgresql","plpgsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13019369,"title":"temporary table function and loop","body":"<p>I have a function in plpgsql where it creates a temporary table and than it has a loop. The thing is that each time it loops it executes also the part where it creates the temporary table and therefore an error pops up saying;</p>\n\n<pre><code>ERROR:  relation \"tmpr\" already exists\nCONTEXT:  SQL statement \"CREATE TEMPORARY TABLE tmpr (\n                id int,\n                source geometry,\n                target geometry,\n                dist_ft character varying\n        )\"\n</code></pre>\n\n<p>Is there any way how I can prevent from execute not more than once a part of the code?</p>\n\n<p>below you can find the code:</p>\n\n<pre><code>DECLARE\n    _r record;\n    t record;\n    i int := 0;\n    j int := 1;\n    count int := 0;\n    source_geom character varying;\n    target_geom character varying;\n\n\nBEGIN\n\n     BEGIN \n\n        CREATE TEMPORARY TABLE tmpr (\n                id int,\n                source geometry,\n                target geometry,\n                dist_ft character varying\n        );\n\n  END;\n\n  BEGIN\n\n        CREATE TEMPORARY TABLE tmp (\n                ogc_fid int,\n                wkb_geometry character varying,\n                track_fid int\n        );\n   END;\n\nEND IF;\n\n\n    WHILE i &lt; 3 --DEPENDS ON THE NUMBER OF TRACKS\n\n LOOP\n\n--j := 1;\n\n--WHILE j &lt; 29 --DEPENDS ON THE NUMBER OF TRACK POINTS\n--LOOP\n\nEXECUTE 'INSERT INTO tmp (ogc_fid, wkb_geometry, track_fid)\nSELECT '|| quote_ident(gid_cname) ||' , ' ||quote_ident(geo_cname)||' , ' || quote_ident(tid_cname) ||'\nFROM ' ||quote_ident(geom_table)|| '\nWHERE ' ||quote_ident(tid_cname)|| ' = ' || i;\n\nFOR _r IN EXECUTE \n  ' SELECT *' \n||' FROM  tmp' \n\nLOOP\n\nEXECUTE 'INSERT INTO tmpr (id, source, target, dist_ft)\nSELECT a.'|| quote_ident(gid_cname) || ' AS id,'\n|| ' st_astext( a.'||quote_ident(geo_cname)||') AS source,' \n|| ' st_astext(b.'||quote_ident(geo_cname)||') AS target, ' \n|| ' ST_Distance(a.'||quote_ident(geo_cname) || ' ,  b.'||quote_ident(geo_cname)||') As dist_ft '\n|| ' FROM tmp AS a INNER JOIN tmp As b ON ST_DWithin(a.'||quote_ident(geo_cname)|| ', b.'||quote_ident(geo_cname)|| ',1000)'\n|| ' WHERE b.'||quote_ident(gid_cname)|| ' &gt; a.'||quote_ident(gid_cname)|| ' AND b.'||quote_ident(tid_cname)|| ' = '||i|| 'AND a.'||quote_ident(tid_cname)|| ' = '||i|| \n   ' ORDER BY  dist_ft '\n|| ' Limit 1 ';\n\n\n--source_geom := temp.source;\n--target_geom := temp.target;\n\n\nEXECUTE 'update ' || quote_ident(geom_table) || \n    ' SET source = tmpr.source\n    , target = tmpr.target\n    FROM tmpr\n    WHERE ' || quote_ident(gid_cname) || ' =  tmpr.id';\n\nEXECUTE 'delete from tmpr';\n\nEND LOOP;\n\n--j = j + 1;\n\n--END LOOP;\nEXECUTE 'delete from tmp';\n\ni = i + 1;\n\nEND LOOP;\n\nRETURN 'OK';\nEND;\n</code></pre>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13019120,"title":"SQL Server 2008 Query to pull the max account date opened","body":"<p>i have the table as below,<br>\n        i would like to find the max(account_opened_date), if there is null date is existing, i have to show null values.</p>\n\n<p><strong>Scenario1</strong>  </p>\n\n<p><strong>Table1</strong>  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE\n11562               3880                07/05/2012\n11562               3884                08/05/2012\n11562               3885                09/06/2012\n11562               3886                10/06/2012\n11562               3881                NULL\n11562               3882                NULL  \n</code></pre>\n\n<p>the results are as below.  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE  \n11562               3882                NULL  \n</code></pre>\n\n<p>in the above scenario, i have to take null because, there is null values existing in account opened dates  </p>\n\n<p><strong>Scenario2</strong>  </p>\n\n<p><strong>Table1</strong>  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE  \n11563               3880                07/05/2012\n11563               3884                08/05/2012\n11563               3885                09/06/2012\n11563               3886                10/06/2012\n11563               3881                11/10/2011\n11563               3882                10/22/2012  \n</code></pre>\n\n<p>The results ARE AS below.  </p>\n\n<pre><code>CLIENTID            ACCOUNTID           ACCOUNT_OPENED_DATE\n11563               3882                10/22/2012  \n</code></pre>\n\n<p>in the above scenario, i have to take 10/22/2012 because, there is no null values existing in account opened dates<br>\nPLEASE HELP!</p>\n"},{"tags":["php","mysql","query","transpose"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13019151,"title":"How to transpose MYSQL db in PHP","body":"<p>I am using PHP to query a MYSQL db to output data to a csv file. </p>\n\n<p>I am currently able to query the db and export the data to the CSV file.</p>\n\n<p>However i am unable to transpose the data so that the columns are rows, and rows are columns.</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code> function transpose($array) {\n             if (!is_array($array) || empty($array)) {\n             return array();\n\n             else {\n                foreach ($array as $row_key =&gt; $row) {\n                    if (is_array($row) &amp;&amp; !empty($row)) { //check to see if there is a                  second dimension\n\n                foreach ($row as $column_key =&gt; $element) {\n                       $transposed_array[$column_key][$row_key] = $element;\n\n        else {\n               $transposed_array[0][$row_key] = $row;\n\n                   return $transposed_array;\n\n    }\n}\n\n    exportMysqlToCsv($tablename,$tokenmain, $id);\n    function exportMysqlToCsv($tablename,$tokenmain, $id, $filename = 'Results.csv'){\n        $sql_query = \"select * from $tablename\";\n\n        // Gets the data from the database\n        $result = mysql_query($sql_query);\n\n        $f = fopen('php://temp', 'wt');\n        $first = true;\n\n        while ($row = mysql_fetch_assoc($result)) {\n\n            if ($first) {\n\n                fputcsv($f, array_keys($row));\n\n                $first = false;\n     }\n\n      fputcsv($f, $row);\n\n        } // end while\n\n        $size = ftell($f);\n        rewind($f);\n        header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n        header(\"Content-Length: $size\");\n\n     // Output to browser with appropriate mime type, you choose ;)\n        header(\"Content-type: text/x-csv\");\n        header(\"Content-type: text/csv\");\n        header(\"Content-type: application/csv\");\n        header(\"Content-Disposition: attachment; filename=$filename\");\n\n        fpassthru($f);\n\n        exit;\n    }\n</code></pre>\n\n<p>Somehow, those two functions should be intertwined to give me the output I need.</p>\n\n<p>Any help would be greatly appreciated. thanks!\n -Merica</p>\n"},{"tags":["java","sql","query","data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13019011,"title":"Need a recommendation for how to organize SQL result","body":"<p>I'm building a multi-tiered menu. So, for example, each main menu item might have 5-10 submenu items, and each of those might have 5-10 third level items. The menu items, no matter what tier they are from, are kept in a single table. The query I (currently) use to pull the data out looks like this:</p>\n\n<pre><code>SELECT *\nFROM menu_items AS m1\nLEFT JOIN (SELECT name AS slName, id AS slId, parent_id AS slPid FROM menu_items)\nm2 ON m1.id = m2.slPid\nLEFT JOIN (SELECT name AS tlName, id AS tlId, parent_id AS tlPid FROM menu_items)\nm3 ON m2.slId = m3.tlPid\nWHERE parent_id = 0\n</code></pre>\n\n<p>The result of this query visually looks like the menu I want, but now I'm thinking I may want to try and restructure so that I can stick it cleanly in an object, rather that just leaving it as a DataTable or whatever.</p>\n\n<p>Here's a sample result of the query above:</p>\n\n<p>For reference, sl means second level, tl means third level, etc.</p>\n\n<pre><code>{id=1, name=Industry, level=1, parent_id=0, slname=Equipment &amp; Machinery, slid=4, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Food, slid=5, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Fabricated Metal Products, slid=8, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Automotive, slid=9, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=1, name=Industry, level=1, parent_id=0, slname=Chemicals and Allied Products, slid=10, slpid=1, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 1, slid=11, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 2, slid=12, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 3, slid=13, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=2, name=Application, level=1, parent_id=0, slname=App Stuff 4, slid=14, slpid=2, tlname=null, tlid=null, tlpid=null}\n{id=3, name=Product, level=1, parent_id=0, slname=Prod Stuff 1, slid=15, slpid=3, tlname=null, tlid=null, tlpid=null}\n{id=3, name=Product, level=1, parent_id=0, slname=Prod Stuff 2, slid=16, slpid=3, tlname=null, tlid=null, tlpid=null}\n{id=3, name=Product, level=1, parent_id=0, slname=Prod Stuff 3, slid=17, slpid=3, tlname=null, tlid=null, tlpid=null}\n</code></pre>\n\n<p>So the problem is now I end up with a bunch of rows which aren't really very nicely formatted to create a Menu object out of. I'm just looking for recommendations on how to restructure. Maybe change up the sql query so get a better base set of data or maybe an idea on how to format my current SQL. </p>\n"},{"tags":["query","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13018556,"title":"Convert query letters to uppercase using Management Studio","body":"<p>Can I convert query syntax to uppercase using SQL Server Management Studio? I have a bunch of queries that are all written in lowercase letters, and I want to convert them all to uppercase letters. I'm looking for a built-in editor functionality. </p>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13018192,"title":"How to write a query in SQL?","body":"<p>I have created some tables in SQL already, they are below:</p>\n\n<pre><code>CREATE TABLE Courses(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999) PRIMARY KEY,\n    Title VARCHAR(100) NOT NULL,\n    )\n\nCREATE TABLE CourseSections(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999),\n    SectionNo INTEGER,\n    InstructorNo INTEGER NOT NULL,\n    Year INTEGER,\n    Semester INTEGER,\n    RoomNo INTEGER NOT NULL,\n    Weekday INTEGER NOT NULL,\n    StartTime INTEGER NOT NULL,\n    FinishTime INTEGER NOT NULL,\n    Capacity INTEGER NOT NULL,\n    PRIMARY KEY(CourseNo, SectionNo, Year, Semester)\n    )\n\nCREATE TABLE Instructor(\n    InstructorNo INTEGER PRIMARY KEY,\n    FirstName VARCHAR(40) NOT NULL,\n    LastName VARCHAR(40) NOT NULL\n    )\n\nCREATE TABLE Students(\n    StudentNo INTEGER PRIMARY KEY,\n    FirstName VARCHAR(40) NOT NULL,\n    LastName VARCHAR(40) NOT NULL,\n    Year INTEGER,\n    GPA REAL\n    )\n\nCREATE TABLE Enrollments(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999),\n    Year INTEGER,\n    Semester INTEGER,\n    SectionNo INTEGER,\n    StudentNo INTEGER,\n    Grade REAL,\n    PRIMARY KEY(CourseNo, Year, Semester, SectionNo, StudentNo)\n    )\n\nCREATE TABLE Areas(\n    AreaName VARCHAR(40) PRIMARY KEY\n    )\n\nCREATE TABLE AreasOfCourse(\n    CourseNo INTEGER CHECK(CourseNo&gt;=100 AND CourseNo&lt;=999),\n    AreaName VARCHAR(40),\n    PRIMARY KEY(CourseNo, AreaName)\n    )\n\nCREATE TABLE AreasOfInstructor(\n    InstructorNo INTEGER,\n    AreaName VARCHAR(40),\n    PRIMARY KEY(InstructorNo, AreaName)\n    )\n</code></pre>\n\n<p>Now, I wanna find the title of each course, and the total enrollment of that course for each semester, I have to write a query for this. So my work is below:</p>\n\n<pre><code>SELECT c1.Title, COUNT(e1.SectionNo), e1.Semester\nFROM Courses c1, Courses c2, Enrollments e1, Enrollments e2\nWHERE c1.CourseNo = c2.CourseNo AND e1.Semester = e2.Semester AND \n                  e1.SectionNo &lt;&gt; e2.SectionNo\n</code></pre>\n\n<p>There is an error comes up when I execute this query. The error is: </p>\n\n<blockquote>\n  <p>Column 'Courses.Title` is invalid in the select list because it is not\n  contained in either an aggregate function or the GROUP BY clause.</p>\n</blockquote>\n\n<p>Can anyone help me figure out how to solve this problem please?</p>\n"},{"tags":["mysql","query","rank"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":495,"score":2,"question_id":5347565,"title":"How to get a row rank?","body":"<p>HI,</p>\n\n<p>I actually posted similar (or same?) question yesterday, but I thought I need to post a new question since I have short, but clear question.</p>\n\n<p>I have the following table.</p>\n\n<pre><code>id  point\n1   30\n2   30\n3   29\n4   27\n5   28\n6   26\n</code></pre>\n\n<p>what I want:</p>\n\n<ol>\n<li><p>get all the users order by rank. user #1 and #2 should have 1 as their rank value because they both have 30 points</p></li>\n<li><p>I want to query a rank by user id. I like to get 1 as the result of my rank when I query user #1 and #2 because both of them have 30 points</p></li>\n</ol>\n\n<p><strong>Added on: 3/18</strong></p>\n\n<p>I tried Logan's query, but got the following result</p>\n\n<pre><code>id point   rank\n1   30  1\n2   30  1\n3   29  3\n4   27  5\n5   28  4\n6   26  6\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13017824,"title":"Count the number of nulls in each column","body":"<p>I've run into a DB that has tables that are excessively wide.  (600+ columns)  Even asking for the top 100 rows with no parameters takes 4 seconds.  I'd like to slim these tables down a bit.</p>\n\n<p>To figure out which columns can be most easily moved to new tables, or removed entirely, I would like to know how many nulls are in each column.  This should tell me what information is likely to be least important.</p>\n\n<p>How would I write a query that can find all columns and count the nulls inside those columns? </p>\n\n<p><strong>Edit</strong> The DB is SQL server 2008.  I'm <em>really</em> hoping not to type each of the columns individually.  It looks like sys.columns could help with this?</p>\n\n<p><strong>Edit2</strong> The columns are all different types.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13004638,"title":"Sum(count()) for last four months individually?","body":"<p>I have to find out tot(count) values with months for last 4 months individually how I can do this </p>\n\n<p>table stucture was </p>\n\n<pre><code>CREATE TABLE `lime_survey_16579` ( \n`id` int(11) NOT NULL auto_increment, \n`submitdate` datetime default NULL, \n`lastpage` int(11) default NULL, \n`startlanguage` varchar(20) collate utf8_unicode_ci NOT NULL, \n`token` varchar(36) collate utf8_unicode_ci default NULL, \n`16579X10X31` varchar(5) collate utf8_unicode_ci default NULLPRIMARY KEY (`id`) \n) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=480 ; \n</code></pre>\n\n<p>here $survey = lime_survey_16579 \nand $temp= 16579X10X31 \nhere 16579X10X31 has values like A1 A2 A3 .. </p>\n\n<p>How I can do this to give output like </p>\n\n<pre><code>tot month \n\n2 july \n4 aug \n6 sep \n9 oct \n</code></pre>\n\n<p>Can anybody help me? </p>\n"},{"tags":["python","django","query","django-mptt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13015828,"title":"Access get_root of a MPTT model through a query","body":"<p>Consider below example:</p>\n\n<pre><code>class ModelX(models.Model):\n    fieldX = models.ForeignKey(ModelY)\n\nclass ModelY(MPTTModel):\n\n    def root(self):\n        return get_root()\n\n    root = property(root)\n</code></pre>\n\n<p>Now I would like to make query like this</p>\n\n<pre><code>ModelX.objects.filter(fieldX__root=match)\n</code></pre>\n\n<p>or better yet directly calling <code>get_root()</code> like this</p>\n\n<pre><code>ModelX.objects.filter(fieldX__get_root=match)\n</code></pre>\n\n<p>which would make the <code>root()</code> method superfluous.</p>\n\n<p>None of the above seem to work though. Why is that? </p>\n"},{"tags":["sql-server-2008","query","full-text-search","contains"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12945479,"title":"How to do a CONTAINS() on two columns of Full Text Index Search SQL","body":"<p>I have a table (MyTable) with the following columns:</p>\n\n<p>Col1: NameID VARCHAR(50) PRIMARY KEY NOT NULL\nCol2: Address VARCHAR(255)</p>\n\n<p>Data Example:</p>\n\n<p>Name: '1 24'\nAddress: '1234 Main St.'</p>\n\n<p>and i did a full text index on the table after making the catalog using default params.</p>\n\n<p>How can I achieve the following query:</p>\n\n<pre><code> SELECT * FROM MyTable\n WHERE CONTAINS(NameID, '1')\n AND CONTAINS(Address, 'Main St.');\n</code></pre>\n\n<p>But my query is returning no results, which doesn't make sense because this does work:</p>\n\n<pre><code> SELECT * FROM MyTable\nWHERE CONTAINS(Address, 'Main St.');\n</code></pre>\n\n<p>and so does this:</p>\n\n<pre><code> SELECT * FROM MyTable\n WHERE CONTAINS(Address, 'Main St.')\n AND NameID LIKE '1%'\n</code></pre>\n\n<p>but this also doesn't work:</p>\n\n<pre><code> SELECT * FROM MyTable\n WHERE CONTAINS(NameID, '1');\n</code></pre>\n\n<p>Why can't I query on the indexed, primary key column (Name) when I selected this column to be included with\nthe Address column when setting up the Full Text Index?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["json","query","scala","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13014774,"title":"Retrieving nested element from MongoCursor","body":"<p>I am querying a Mongo DB in Scala and looping through the returned elements, that look like this: </p>\n\n<pre><code>{ \"_id\" : \"123:1350918540586068000:v\" , \n    \"i\" : { \n        \"vendorStyle\" : \"coolStyle\" , \n        \"createdAt\" : 1350918540580 , \n        \"productId\" : \"product123\" , \n        \"skuId\" : \"123\"\n    }\n}\n</code></pre>\n\n<p>My question is: how do I retrieve the value from skuId? I know you can use the notation parent.child in the 'find' method in Mongo, but that doesn't work when reading from the resulting DBObject</p>\n\n<p>This is the code:</p>\n\n<pre><code>val elems = SkuStorage.collection.find(MongoDBObject(\"i.productId\" -&gt; productId))\nelems.toSeq.map { element=&gt;\n    readSkuById(element.get(\"i.skuId\")) //breaks! \n}\n</code></pre>\n\n<p>Do I need to go get(\"i\") then parse the string into a JSON? Is there any better way of handling this?</p>\n"},{"tags":["sql","query","coldfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13015993,"title":"MS-SQL get difference value","body":"<p>I have this query that calculates current gallons value from all fuel tanks in my database.</p>\n\n<pre><code>SELECT DISTINCT y.TankNumber as TankNumber\n    , y.Gallons as Gallons\n    , y.timeUpdated\n    , y.FuelType as FuelType\nFROM (\n    SELECT TankNumber, max(timeUpdated) as maxdate\n    FROM someTable\n    GROUP BY TankNumber) as x\nJOIN someTable y\nON x.TankNumber = y.TankNumber\nAND x.maxdate = y.timeUpdated\nORDER BY y.TankNumber\n</code></pre>\n\n<p>Based on the fuel usage, data gets dumped in to my database automatically at any time. And query above will give me only the current gallons value in each fueltank:<br /></p>\n\n<pre><code>TankNumber  |  Gallons  |  timeUpdated        |  FuelType\n     1      |  14       |  2012-10-22 04:16   |  89\n     2      |  8        |  2012-10-22 04:14   |  93\n</code></pre>\n\n<p>and etc..<br />\nMy problem is, that I am trying to add another output value to my page, that will give me a difference how much fuel was used since last update. So it will look something like this:<br /></p>\n\n<pre><code>TankNumber  |  Gallons  |  timeUpdated        |  FuelType  |  GallonsUsed\n     1      |  14       |  2012-10-22 04:16   |  89        |  5\n     2      |  8        |  2012-10-22 04:14   |  93        |  -11\n</code></pre>\n\n<p>Unfortunately my SQL experience is not as solid for this type of problem and I have spent about two days trying to figure out or google something close. So, any help will be greatly appreciated.</p>\n"},{"tags":["mysql","query","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13011123,"title":"Why is this trigger making some of my inserts hang?","body":"<p>The trigger is as follows:     </p>\n\n<pre><code>DELIMITER //\nCREATE TRIGGER `Conturi_BI` BEFORE INSERT ON `Conturi` FOR EACH ROW BEGIN\nSET NEW.CUI_cod = digits(NEW.CUI);\nEND//\nDELIMITER ;\n</code></pre>\n\n<p>I'm just applying a digits function to a user input for faster matching and duplicates search, but ever since I implemented it some of my Inserts just hang. I made a similar one for updates and it doesn't have the same problem.</p>\n\n<p>The digits function is created by me and the trigger and inserts work fine most of the time.</p>\n\n<p>The digits function, as requested:</p>\n\n<pre><code>BEGIN\n  DECLARE i, len SMALLINT DEFAULT 1;\n  DECLARE ret CHAR(32) DEFAULT '';\n  DECLARE c CHAR(1);\n  SET len = CHAR_LENGTH( str );\n  REPEAT\n    BEGIN\n      SET c = MID( str, i, 1 );\n      IF c BETWEEN '0' AND '9' THEN \n        SET ret=CONCAT(ret,c);\n      END IF;\n      SET i = i + 1;\n      END;\n  UNTIL i &gt; len END REPEAT;\n  RETURN ret;\nEND\n</code></pre>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13014046,"title":"MS Access Query to display latest Active Part Number","body":"<p>I have following Table \"Replaced\" in MS Access.</p>\n\n<pre><code>ID  PartNumber  ReplacedNumber  Status\n4   b                       Active\n5   c           b           Replaced\n6   d           b           Replaced\n7   e           c           Replaced\n8   h           d           Replaced\n9   104308          408077-0102 Replaced\n10  310224          408077-0102 Replaced\n11  0R5888          408077-0102 Replaced\n12  4N6515          408077-0102 Replaced\n13  4N6860          408077-0102 Replaced\n14  408077-0102 408077-5102 Replaced\n15  408077-5102 408077-5102S    Replaced\n16  408077-5102S                Active\n</code></pre>\n\n<p>Query requirement</p>\n\n<p>The final answer for any of these numbers (104308, 310224, 0R5888, 4N6515, 4N6860, 408077-0102, 408077-5102, 408077-5102S) should be 408077-5102S as this number has superseded all the rest. So, if my query has a criteria, [Please Enter part number to find the latest number], the resultant number should be 408077-5102S. As, it is the only Active number and has superseded all the rest.</p>\n\n<p>Similarly, The final answer for any of these numbers (b, c, d, e, h) should be b as this number has superseded all the rest. So, if my query has a criteria, [Please Enter part number to find the latest number], the resultant number should be b. As, it is the only Active number and has superseded all the rest.</p>\n\n<p>Any ideas? I have also looked at <a href=\"http://stackoverflow.com/questions/12972219/replacing-values-in-sql-microsoft-access\">Replacing Values in SQL (Microsoft Access)</a> but it does not help.</p>\n"},{"tags":["sql","query","mysql-like"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12993752,"title":"select where string doesn't match exactly","body":"<p>It's my table rows:</p>\n\n<pre><code>++ id ---- text ++++++++++++++\n-- 1  ---- '90','80,'50' -----\n-- 2  ---- '30','2','1_2' --\n-- 3  ---- '10_2','5_3' -----\n</code></pre>\n\n<p>as you see, <code>text</code> contains 2 types of numbers, one doesn't have underscore, and the other does.</p>\n\n<p>I want to select rows which have at least one number without underscore (type 1). Something like this: (result-set)</p>\n\n<pre><code>++ id ---- text ++++++++++++++\n-- 1  ---- '90','80,'50' -----\n-- 2  ---- '30','2','1_2' --\n</code></pre>\n\n<p>(<code>3</code> is ignored)</p>\n\n<p>How to do that? (I think it's possible with <code>NOT LIKE</code>, but I don't know how to write)</p>\n"},{"tags":["sql","sql-server","performance","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":63,"score":1,"question_id":12558483,"title":"SQL query slow calculating cumulative totals","body":"<p>We are storing data readings at 5 minute intervals for a large number of gauges.</p>\n\n<p>The data tables involved are:</p>\n\n<pre><code>Table1 - GaugeData\nColumns - \n    GaugeID (int, primary key)\n    Timestamp (datetime, primary key)\n    Value (decimal)\n\nTable2 - GaugeSummaryData\nColumns - \n    GaugeID (int, primary key)\n    DayTimestamp (date, primary key)\n    DayTotal (decimal) - total for the current date/day\n    CumulativeTotal (decimal) - total up to and including the current date\n</code></pre>\n\n<p>Without changing the table structure in any way, what would be the most efficient way to copy and aggregate data from GaugeData into GaugeSummaryData?</p>\n\n<p>I have attempted this two ways already. Using a cursor takes 40 minutes to copy all data from GaugeData to GaugeSummaryData. Using insert/update statements took 2hrs+.</p>\n\n<p>Could somebody please suggest the most efficient way? Pseudocode or SQL appreciated.</p>\n"},{"tags":["mysql","database","string","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13014217,"title":"Mysql replace function returns null","body":"<p>I have a table activity_types which contains the text for activities e.g. <br />\n<code>New project has been assigned to {user} with name {project}</code> <br />\n<code>New discussion has been posted by {client} on {project}</code> <br />\n<code>Project {project} has been closed by {user}</code> <br />\n<code>A draft has been approved by {client} on {project}</code><br />\nand so on</p>\n\n<p>I have another table in which the id of these texts has been populated.</p>\n\n<p>Now my requirement is to fetch these by replacing the text within {} with their actual values like {client} should be replaced with client name, {project} should be replaced with project name. </p>\n\n<p>I have tried using nested replace mysql function but it returns null string. Here is my query</p>\n\n<pre><code>SELECT      REPLACE(REPLACE(REPLACE(att.type_text, '{project}', p.project_business_name), '{user}', u.user_fullname), '{client}', c.client_name) AS activity, a.*\nFROM        activities a\nLEFT JOIN   activity_types AS att ON att.type_id = a.activity_type\nLEFT JOIN   users u ON u.user_id = a.activity_user AND a.activity_user IS NOT NULL\nLEFT JOIN   projects p ON p.project_id = a.activity_project AND p.project_is_removed = '0'\nLEFT JOIN   clients c ON c.client_id = a.activity_client AND a.activity_client IS NOT NULL;\n</code></pre>\n\n<p>The problem is that if i replace the c.client_name with static text it works fine but when i replace the static string with c.client_name it return null in activities which does not have {client}. Any guesses where am i doing wrong?</p>\n"},{"tags":["mysql","sql","database","query","aggregate-functions"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":2130,"score":3,"question_id":6131197,"title":"mysql count the sum of all rows","body":"<p>I have a mysql table that has a number of rows, and in each row a field called \"value\",\nthe field value will differ from row to row.\nWhat I want, is to select all the rows and count the sum of all the \"value\" fields.</p>\n\n<p>any idea?</p>\n"},{"tags":["mysql","sql","query","aggregate-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":4716,"score":1,"question_id":6715095,"title":"How to SUM and SUBTRACT using SQL?","body":"<p>I am using MySQL and I have two tables:</p>\n\n<p><code>master_table</code></p>\n\n<ul>\n<li>ORDERNO </li>\n<li>ITEM</li>\n<li>QTY</li>\n</ul>\n\n<p><code>stock_bal</code> </p>\n\n<ul>\n<li>ITEM </li>\n<li>BAL_QTY</li>\n</ul>\n\n<p>Master table has duplicate <code>ORDERNO</code> and <code>ITEM</code> values. I have get total <code>QTY</code> using SQL 'GROUP BY' clause.</p>\n\n<p>I need to deduct/subtract <code>BAL_QTY</code> from SUM of <code>ITEM</code> (master_table).  I've got SUM <code>QTY</code> value using query (actually there are many rows).</p>\n"},{"tags":["c#","query","usergroups","principalcontext","principalsearcher"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13012497,"title":"Query PrincipalSearcher for containing multiple strings","body":"<p>I want to be able to query the active directory give a list of all groups containing certain words like Users or Administrators below is what i've got so far</p>\n\n<pre><code>PrincipalContext ctx = new PrincipalContext(ContextType.Domain);\nGroupPrincipal qbeGroup = new GroupPrincipal(ctx);\nqbeGroup.DisplayName = \"Administrators\";\nqbeGroup.DisplayName = \"Users\";\nPrincipalSearcher srch = new PrincipalSearcher(qbeGroup);\nreturn srch.FindAll().Select(g =&gt; g.Name).ToArray();\n</code></pre>\n\n<p>This code doesn't even seem to filter out the the Group names that is not Administrators or Users. But anyway what I can't figure out is how to query if the group name contains? and not if group name is equal to and how to do this of multiple strings.</p>\n\n<p>I can do the same thing using DirectoryEntry so I put it here for referance</p>\n\n<pre><code>var groups = new List&lt;string&gt;();\nvar path = string.Format(\"LDAP://CN=Users,DC=company,DC=com\");\nvar computerEntry = new DirectoryEntry(path);\n\nif (computerEntry != null)\n   {\n       using (computerEntry)\n       {\n            var userNames =\n            from DirectoryEntry childEntry\n            in computerEntry.Children\n            where childEntry.SchemaClassName == \"Group\"\n            select childEntry.Name;\n            foreach (var name in userNames)\n            {\n                 if (name.Contains(\"Administrators\") || name.Contains(\"Users\"))\n            {\n             groups.Add(name);\n       }\n   }\n}\n}\nreturn groups.ToArray();\n</code></pre>\n"},{"tags":["oracle","query","join","group"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13002043,"title":"For each row of one table, count entries in another table pointing to each of those rows in Oracle","body":"<p>Not sure the title explains the problem well; this is what I'm working with,</p>\n\n<p>I have the following tables,</p>\n\n<pre><code>-- table = kms_doc_ref_currnt_v\nDOC_ID    VARCHAR2(19)\nTO_DOC_ID    VARCHAR2(19)\nBRANCH_ID    NUMBER(8)\nREF_TYP_CD    VARCHAR2(20)\n\n-- table = kms_fil_nm_t\nDOC_ID    VARCHAR2(19)    PRIMARY KEY    UNIQUE\n</code></pre>\n\n<p>For example, I can get a count of all <code>kms_doc_ref_currnt_v</code> records that have a <code>to_doc_id = 59678</code>, where 59678 is one value in <code>kms_fil_nm_t</code>, with this query,</p>\n\n<pre><code>select 'doc_id 59678 has ' || count(to_doc_id) as cnt from kms_doc_ref_currnt_v where branch_id=1 and ref_typ_cd in ('CONREF', 'KBA') and to_doc_id=59678;\n</code></pre>\n\n<p><code>kms_doc_ref_currnt_v.to_doc_id</code> is a field that has one of the <code>kms_fil_nm_t.doc_id</code> values. <code>kms_doc_ref_currnt_v.doc_id</code> is also one of the values in <code>kms_fil_nm_t</code>.</p>\n\n<p>The single query I'm looking for would loop over each <code>kms_fil_nm_t.doc_id</code> and count all the rows in <code>kms_doc_ref_currnt_v</code> that have a similar <code>to_doc_id</code>. Each row returned would look like the output of the query above. Here's example output,</p>\n\n<pre><code>doc_id 1 has 32\ndoc_id 2 has 314\ndoc_id 3 has 2718\ndoc_id 4 has 42\ndoc_id 5 has 128\ndoc_id 6 has 11235\n.\n.\n.\n</code></pre>\n\n<p>Probably simple but I just can't figure it out. Thanks</p>\n"},{"tags":["sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13011900,"title":"Need help to get records of current date?","body":"<p>I am trying to write Stored Procedure for getting records for current date, but I am not able to do so. I have created one for record display with latest first &amp; trying to modify the same </p>\n\n<p>Here is the code of same:-</p>\n\n<pre><code>SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE PROCEDURE [dbo].[SP_SELECTTODAYRECORDS_Test]\nAS\nBEGIN \n    SELECT col_Source as 'country', \n    col_FirstName +' '+col_LastName as 'name',\n    description as 'state' ,\n    col_county\n    from tbl_Info_Test, tbl_CountySite \n    where col_Pic is not null\n    and col_Source = sourcecountry\n    and ISDATE(col_BookDate) = 1\n    order by CONVERT(datetime, col_BookDate) DESC\nEND\n</code></pre>\n\n<p>Could you please help me out to modify the same. thanks in advance.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13008949,"title":"How do I write an update query for duplicate records","body":"<p>My knowledge of MySQL is pretty basic and I struggle with complicated queries - for me, the following problem is complicated - hopefully it's not for you!</p>\n\n<p>I've been importing businesses to my database, some of which have the same company name. For instance, we have two Subway branches in the table, both with different addresses.</p>\n\n<p>I'd like to set the Company Name to be \"Company Name\" + \"Town\" so we end up with unique fields:</p>\n\n<ul>\n<li>Subway London </li>\n<li>Subway Manchester</li>\n</ul>\n\n<p>So far, all I've managed to do is check out which Company names appear in the db twice with:</p>\n\n<pre><code>SELECT CompanyName , count( CompanyName )\nFROM directorydata\nGROUP BY CompanyName \nHAVING count( CompanyName ) &gt;1\n</code></pre>\n\n<p>How do I go about updating each of the CompanyName field with it's current value, plus that of the Town field?</p>\n\n<p>Your help is greatly appreciated!</p>\n"},{"tags":["mysql","query","stored-procedures","csv","match-against"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":2,"view_count":398,"score":3,"question_id":9950216,"title":"Grouping a comma separated value on common data","body":"<p>I have a table with col1 id int, col2 as varchar(comma seperated value) and column 3 for assigning group to them.\nTable looks like</p>\n\n<pre><code>  col1          col2     group\n..............................\n       1        2,3,4       \n       2        5,6        \n       3        1,2,5\n       4        7,8\n       5        11,3\n       6        22,8\n</code></pre>\n\n<p>this is only the sample of real data, now i have to assign a group no to them in such a way that output looks like</p>\n\n<pre><code>  col1          col2       group\n..............................\n       1        2,3,4       1\n       2        5,6         1\n       3        1,2,5       1\n       4        7,8         2\n       5        11,3        1\n       6        22,8        2\n</code></pre>\n\n<p>The logic for assigning group no is that every similar comma seperated value of string in col2 have to be same group no as every where in col2 where '2' is there it has to be same group no but the complication is that 2,3,4 are together so they all three int value if found in any where in col2 will be assigned same group.\n   the major part is 2,3,4 and 1,2,5 both in col2 have 2 so all int 1,2,3,4,5 have to assign same group no.\nTried store procedure with match against on col2 but not getting desired result</p>\n\n<p>Most imp( i can't use normalization,because i cant afford to make new table from my original table which have millions of record) ,even normalization is not helpfull in my context.</p>\n\n<hr>\n\n<p>Achieved so far......\nIhave set the group column auto increment and then wrote this procedure:-</p>\n\n<pre><code>BEGIN\n  declare cil1_new,col2_new,group_new int;\n  declare done tinyint default 0;\n  declare group_new varchar(100);\n  declare cur1 cursor for select col1,col2,`group` from company ; \n  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=1;\n  open cur1;\n  REPEAT\n  fetch cur1 into col1_new,col2_new,group_new;\n  update company set group=group_new where\n  match(col2) against(concat(\"'\",col2_new,\"'\"));\n  until  done end repeat;\n  close cur1;\n  select * from company;\nEND\n</code></pre>\n\n<p>This procedure is working,no syntex mistake but the proble is that i am not acheiving the desired result exectly.</p>\n"},{"tags":["php","query","propel","generate","peer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12997208,"title":"propel generated peer and query filename","body":"<p>I added propel library in my codeigniter project\nCodeigniter 2.1.3 Propel 1.6.7\nbut apparently as propel users know it generates camelcase names</p>\n\n<p>ex. UsersQuery.php UsersPeer.php</p>\n\n<p>but codeigniter wont accept camelcase names when executing </p>\n\n<pre><code>$this-&gt;load-&gt;model('UsersQuery');\n</code></pre>\n\n<p>does anyone know how to change generated propel model class to lowercase filenames?\nbecause if i will just rename each file, i will do it everytime i generate classes and it's not efficient, thank you for your response.</p>\n"},{"tags":["javascript","css","query","printing","media"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":162,"score":7,"question_id":12371822,"title":"How can I print an image in a web page, fitting the paper size (A3, A4, A5, etc)?","body":"<p>I am currently using IE9 and media queries and I have no need to have this working from other browsers.</p>\n\n<p>I tried using a set of rules like:</p>\n\n<pre><code>@page {\n    size: auto;\n    margin: 10mm 10mm 10mm 10mm;\n}\n</code></pre>\n\n<p>//... rules to match the millimiters of all the A formats (A0, A1, A2, etc) including margins and tolerance</p>\n\n<pre><code>/* A4 210x297 mm */\n@media print and (min-height: 266mm) and (max-height: 288mm) and\n    (min-width: 179mm) and (max-width: 201mm) {\n    .img_port {\n        height: 267mm !important;\n    }\n}\n</code></pre>\n\n<p>// ...</p>\n\n<p>it seems to be working but it is not reliable because the size height and the width values passed to the CSS seems to depend on the printer even if the A4 format is always selected.</p>\n\n<p>What I want to ask is if there is any other possible way to obtain the same result (fitting the image on one page according to the paper size).</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13007172,"title":"Conditional query depending on 2 checkbox","body":"<p>I am creating a query that depends on several input form values, and at some point I am working on three values.  The first value queried has to be always 0, so I have this:</p>\n\n<pre><code>.. AND value_1 = 0\n</code></pre>\n\n<p>What I want to be able to do cleanly is the following:</p>\n\n<p>If checkbox_2 is checked:</p>\n\n<pre><code>... AND (value_1 = 0 OR value_2 = 0)\n</code></pre>\n\n<p>If checkbox_3 is checked</p>\n\n<pre><code>... AND (value_1 = 0 OR value_3 = 0)\n</code></pre>\n\n<p>If checkbox_2 and checkbox_3 are checked</p>\n\n<pre><code>... AND (value_1 = 0 OR value_2 = 0 OR value_3 = 0)\n</code></pre>\n\n<p>I am creating the SQL query in a string, and I am wondering what would be a clean way to do this.</p>\n"}]}
{"total":20739,"page":9,"pagesize":100,"questions":[{"tags":["database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":13005728,"title":"Slow Database Query","body":"<p>I have a query something like this: </p>\n\n<pre><code>SELECT title FROM Table WHERE friendly_url = 'friendlyurl'\n</code></pre>\n\n<p>But a Server says that the query is slow and consume a lot of server resources and they paste the actual query:</p>\n\n<pre><code>SELECT title FROM Table WHERE friendly_url =\n'friendlyurl' and 9=16 union select\nconcat(0x6D6E617879,(hex(compress(concat_ws(0x03,(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n120,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n121,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n122,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n123,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n124,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n125,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n126,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n127,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n128,1),(select\nconcat_ws(0x02,ifnull(table_schema,0x01),ifnull(table_name,0x01),ifnull(column_name,0x01),ifnull(is_nullable,0x01))\nfrom information_schema.columns where\ntable_schema0x696E666F726D6174696F6E5F736368656D61 limit\n129,1))))),0x7861306969) -- a' LIMIT 1 \n</code></pre>\n\n<p>Can anyone explain this to me? Please. </p>\n"},{"tags":["query","post"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":12997176,"title":"Update Table row on Particular date which is stored in another table","body":"<p>The problem I am facing is, I am having a table in which I have Cheque Amount And Cheque Date Field. So, Sometimes I might have <strong>post</strong> dated Cheque, may be of after 3-4 days.. So in this case, on particular date Cheque amount should add to related bank amount. Here I need some help.</p>\n"},{"tags":["database","sql-server-2008","query","grails-2.0","grails-controller"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12967518,"title":"SQL Querying Database","body":"<p>I have this following query\n <code>\"select abc from table where val = 1\"</code><br/>\nThe result i got was </p>\n\n<pre><code> [{abc=5}]\n</code></pre>\n\n<p>However, I <strong>need just the integer value 5</strong> from the result <strong>instead of the array[{abc=5}]</strong>.<br/>\nAnyone have any idea on how to do this? thanks\n*My friend told me that I will need to use substring to get just the 5 out from the [{abc=5}], but i have completely no clue on how to work on it. Any help will be appreciated!</p>\n\n<p>*edited </p>\n"},{"tags":["c#","xml","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13004201,"title":"LINQ XML Subquery - Need Assistance","body":"<p>My current LINQ query and example XML are below. What I'd like to do is select the primary image urls from the  as well as the other attributes such as trim, body, make, model, etc.</p>\n\n<p>What is the best way to do this?</p>\n\n<pre><code>&lt;response&gt;\n&lt;objects&gt;\n    &lt;object&gt;\n        &lt;trim&gt;LT&lt;/trim&gt;\n        &lt;body&gt;4dr Car&lt;/body&gt;\n        &lt;warranty_miles /&gt;\n        &lt;color&gt;WHITE&lt;/color&gt;\n        &lt;selling_price&gt;0.00&lt;/selling_price&gt;\n        &lt;vin&gt;1g1jc5sh3c4198042&lt;/vin&gt;\n        &lt;has_service_contract &gt;False&lt;/has_service_contract&gt;\n        &lt;year&gt;2012&lt;/year&gt;\n        &lt;alt_id&gt;&lt;/alt_id&gt;\n        &lt;stock_num&gt;1205362&lt;/stock_num&gt;\n        &lt;has_warranty&gt;False&lt;/has_warranty&gt;\n        &lt;warranty_month /&gt;\n        &lt;make&gt;CHEVROLET&lt;/make&gt;\n        &lt;date_manufactured /&gt;\n        &lt;interior_color&gt;Dark Pewter/Dark Titanium&lt;/interior_color&gt;\n        &lt;date_updated&gt;2012-10-17&lt;/date_updated&gt;\n        &lt;date_dealer_created&gt;2012-06-06&lt;/date_dealer_created&gt;\n        &lt;certification_warranty /&gt;\n        &lt;status/&gt;\n        &lt;vevo&gt;&lt;/vevo&gt;\n        &lt;image_urls&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/1764e186eabe4ae892f6230107b862cf.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/3eeb7050770849e8937191d09453d936.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/7f6c1f172f7b4944ac2d165c0dfbcb09.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/82d242ba07bb4bb9a7c8514ea1aadae7.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/93e3cac89d0f4872b86acd9c2d94695a.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/edec4ffe9b2349ffabea9dcb25a78d1e.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/f2c1dbb15fec4cf6a62b7842db22763a.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/fa7341e250654533a9de2a756d4274eb.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n          &lt;/image_urls&gt;\n       &lt;/object&gt;\n   &lt;/objects&gt;\n &lt;/response&gt;\n</code></pre>\n\n<p>Here is what I have so far</p>\n\n<pre><code>        var users = from m in main2.Elements(\"object\")\n                    select new Inventory \n                    {\n                        Make = (string)m.Element(\"make\"),\n                        Year = (string)m.Element(\"year\"),\n                        Model = (string)m.Element(\"model\"),\n                    };\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12679822,"title":"How to Determine the Age of a Person in aTable","body":"<p>I am trying to determine the age of the people that are listed in my database. This is what I came up with, but I can't seem to limit the query to show people who are only 18 and under.     </p>\n\n<pre><code>SELECT \n  * \nFROM \n  patientdetails \nWHERE \n  ageInYears IN (\n    SELECT \n      DATEDIFF(CURRENT_DATE, STR_TO_DATE(p.DOB, '%d-%m-%Y'))/365 AS ageInYears \n    FROM \n      patientdetails p\n  ) &lt; 19\n</code></pre>\n"},{"tags":["mysql","query","pdo","prepared-statement","max"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":11991752,"title":"Getting maximum value from a column in a MySQL table, increasing value by 1 and passing to variable","body":"<p>I am using the query below to extract the maximum value of a column called id in a MySQL table, so that I can increase it's value by 1 and pass it to a variable called $fav_id.  For some reason $fav_id is returning '0', instead of the value I want, i.e. if the maximum current value in the id column is 465, then $fav_id should be set to 466.  Perhaps someone could let me know where I am going wrong.</p>\n\n<pre><code>$sth2 = $pdo-&gt;prepare(\"SELECT MAX(id) AS id FROM tracks\");\n\n$sth2-&gt;setFetchMode(PDO::FETCH_OBJ);\n\nwhile($row = $sth2-&gt;fetch()) {\n    $fav_id = $row-&gt;id+1;\n}\n</code></pre>\n"},{"tags":["mysql","sql","json","query"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":12998610,"title":"MySQL view query without Json from a table containing some Json objects","body":"<p>Ive been trying to make a new MySQL view without Json from an existing MySQL table which contain some Json objects. Table 1 is the current table. Table 2 is the new MySQL view derived from Table 1. The content of table 2 will always reflect table 1 content. The difference is just the structure.</p>\n\n<p>Below are simplified tables for our example context where actually there are more than 20 columns.</p>\n\n<h1>Table 1 (3 columns)</h1>\n\n<pre><code>user_id | name |          params\n---------------------------------------------\n   1    | john |{\"age\":\"26\",\"gender\":\"male\"}\n   2    | amy  |{\"age\":\"28\",\"gender\":\"female\"}\n</code></pre>\n\n<h1>Table 2 (4 columns)</h1>\n\n<pre><code>user_id | name | age | gender\n-----------------------------\n   1    | john | 26  | male\n   2    | amy  | 28  | female\n</code></pre>\n\n<p>The data flow is like this: \nAt anytime, user key in data from 3rd party custom form and got saved into Table 1. The data however need to be pulled from the Table 2 format, also at anytime.</p>\n\n<p>How can we achieve this using only SQL queries? Thank you in advance. This will sure helps many developers out there coping with Json as new standard. Cheers!</p>\n"},{"tags":["python","query","django-orm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13002877,"title":"List out of index Error","body":"<p>I have a for loop such as:</p>\n\n<pre><code>staff = Staff.objects.all().order_by('person__full_name')\nfor k in staff:\n    categ = k.staff_job_categories.all()[1]\n    if categ.name == unicode(\"xxx\",\"utf-8\"):\n        t = categ.name\n</code></pre>\n\n<p>But for <code>categ = k.staff_job_categories.all()[1]</code>\nI get an List out of index Error.</p>\n\n<p>Any ideas? </p>\n"},{"tags":["mysql","query","optimization","join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13001981,"title":"How do I optimize my query?","body":"<p>I've written a query to pull a report from a WordPress database. The query is unbelievable slow so I want to optimize it. I've done a bit of research and am having trouble understanding what is the best way top speed up the query (which, even though I wrote, I barely understand what I did.) Can someone point me in the right direction toward optimizing this slow query.</p>\n\n<pre><code>SELECT\nwp1.meta_value as firstName,\nwp2.meta_value as middleName,\nwp3.meta_value as lastName,\nwp5.meta_value as email2,\nwp6.meta_value as address,\nwp7.meta_value as city,\nwp8.meta_value as state,\nwp9.meta_value as zip,\nwp10.meta_value as country,\nwp11.meta_value as phone,\nwp12.meta_value as dateOfBirth\nFROM wp99_usermeta wp1\nJOIN wp99_usermeta wp2 ON wp1.user_id = wp2.user_id and wp2.meta_key = 'middle_name'\nJOIN wp99_usermeta wp3 ON wp1.user_id = wp3.user_id and wp3.meta_key = 'last_name'\nJOIN wp99_usermeta wp5 ON wp1.user_id = wp5.user_id and wp5.meta_key = 'email2'\nJOIN wp99_usermeta wp6 ON wp1.user_id = wp6.user_id and wp6.meta_key = 'street_address'\nJOIN wp99_usermeta wp7 ON wp1.user_id = wp7.user_id and wp7.meta_key = 'city'\nJOIN wp99_usermeta wp8 ON wp1.user_id = wp8.user_id and wp8.meta_key = 'state'\nJOIN wp99_usermeta wp9 ON wp1.user_id = wp9.user_id and wp9.meta_key = 'zip'\nJOIN wp99_usermeta wp10 ON wp1.user_id = wp10.user_id and wp10.meta_key = 'country'\nJOIN wp99_usermeta wp11 ON wp1.user_id = wp11.user_id and wp11.meta_key = 'phone'\nJOIN wp99_usermeta wp12 ON wp1.user_id = wp12.user_id and wp12.meta_key = 'date_of_birth'\nWHERE wp1.meta_key = 'first_name' \n</code></pre>\n\n<p>The default <code>wp_usermeta</code> table structure:</p>\n\n<pre><code>CREATE TABLE `wp_usermeta` (\n  `umeta_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n  `user_id` bigint(20) unsigned NOT NULL DEFAULT '0',\n  `meta_key` varchar(255) DEFAULT NULL,\n  `meta_value` longtext,\n  PRIMARY KEY (`umeta_id`),\n  KEY `user_id` (`user_id`),\n  KEY `meta_key` (`meta_key`)\n) ENGINE=***  DEFAULT CHARSET=utf8 AUTO_INCREMENT=15 ;\n</code></pre>\n\n<p>Trying the ALTER TABLE suggestion. This is giving me an error at line 5</p>\n\n<p>ALTER TABLE wp99_usermeta\n    ADD INDEX meta_key__user_id \n      (meta_key, user_id) ;</p>\n\n<pre><code>SELECT\nwp1.meta_value as firstName,\nwp2.meta_value as middleName,\nwp3.meta_value as lastName,\nwp5.meta_value as email2,\nwp6.meta_value as address,\nwp7.meta_value as city,\nwp8.meta_value as state,\nwp9.meta_value as zip,\nwp10.meta_value as country\nFROM wp99_usermeta wp1\nJOIN wp99_usermeta wp2 ON wp1.user_id = wp2.meta_key__user_id = 'middle_name'\nJOIN wp99_usermeta wp3 ON wp1.user_id = wp3.meta_key__user_id = 'last_name'\nJOIN wp99_usermeta wp5 ON wp1.user_id = wp5.meta_key__user_id = 'email2'\nJOIN wp99_usermeta wp6 ON wp1.user_id = wp6.meta_key__user_id = 'street_address'\nJOIN wp99_usermeta wp7 ON wp1.user_id = wp7.meta_key__user_id = 'city'\nJOIN wp99_usermeta wp8 ON wp1.user_id = wp8.meta_key__user_id = 'state'\nJOIN wp99_usermeta wp9 ON wp1.user_id = wp9.meta_key__user_id = 'zip'\nJOIN wp99_usermeta wp10 ON wp1.user_id = wp10.meta_key__user_id = 'country'\nWHERE wp1.meta_key = 'first_name' \n</code></pre>\n"},{"tags":["mysql","sql","database","query","table"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":268,"score":2,"question_id":12932993,"title":"How to form a sql query","body":"<p>Hi all so here is the problem that I need to solve:</p>\n\n<p>This is the table that I need to get for each user.</p>\n\n<pre><code>Date        | Working time (day) | Night shifts (23:00 - 06:00) | Total(day + night) |             | Notes\n3.9.        |    7               |               2              |         9          |      1      | \n4.9.        |    8               |               0              |         8          |             |  \n5.9.        |    6               |               2              |         8          |             |\n6.9.        |    4               |               3              |         7          |             |\n7.9.        |    0               |               0              |         0          |             |\n8.9.        |    0               |               0              |         0          |             |\n9.9.        |    0               |               0              |         0          |             |\n10.9.       |    0               |               0              |         0          |             |\nTotal(week) |    25              |               7              |         32         |  Total(&gt;48h)|    0    \n</code></pre>\n\n<p>So let me explain this. User chooses the week in this example it is a from 3.9-10.9, user has unique key. Everything in this table needs to be generated in sql if this is possible. So the first column is date, second one is a working time which is between (06:00-23:00), third column is night shift between (23:00-06:00), fourth column is Total of day and night shift, fifth column is only filled if fourth column is bigger then 8 i.e. 9h of total - 8 is 1,sixth column is only filled if Total of(day and night shifts) at the bottom is bigger then 48h and then difference is written in that last column.</p>\n\n<p>My current table with data has this columns: <code>user_key,id,time</code></p>\n\n<p>Now this would be an example of what should query do:</p>\n\n<pre><code>    1. user_key(100), id(1), time(15:00); \n    2. user_key(200), id(2), time(15:05); \n    3. user_key(100), id(3), time(16:00); \n    4. user_key(100), id(4), time(16:05); \n    5. user_key(100), id(5), time(17:05); \n\n    3.-1. = 1h \n    5.-4. = 1h \n\n    Result: \n    user_key(100), day_shift(2h)\n</code></pre>\n\n<p>So we user_key is unique for each user and id is auto-incrementing, we always need to take first and the second record for the same user and save result and then second two records for that user and save working time and so on...\nHow to achieve this? I need to use some sql variables? Of course it has to have to options if it is a day shift and night shift as we don't want to save working time in the wrong column.</p>\n\n<p>EDIT:</p>\n\n<p>As I see that lot of you didn't understood what I really need.\nI will try to explain it a bit more.</p>\n\n<p>When user signs in it has it own user_key written. When he signs out then I wrote user_key(0) in the table after that another user can sing in and so on. So basically I need to see first unique user key in the for example day shift and get the last. The last user_key we can get just to check if the next user_key is different. If the next user key is the different then we have the first one and the last one and difference between them needs to be saved in the variable. Then for example we have some other users and later on we have again pair of user_key then we just need to add the difference between them to the same variable and so on...</p>\n\n<p>My problem can be solved in PHP too. For example we can get only values for certain user_key and for the certain time. Then in php we can go trough the data and check.</p>\n\n<p>Please provide me with some examples</p>\n\n<p>EDIT:</p>\n\n<p>Data:</p>\n\n<pre><code>1447, 0, 2012-10-21 13:32:15.453\n1448, 0, 2012-10-21 13:32:22.203\n1449, 0, 2012-10-21 13:32:29.203\n1450, , 2012-10-21 13:32:35.671\n1451, , 2012-10-21 13:32:44.515\n1452, , 2012-10-21 13:32:52.62\n1453, 0010154108, 2012-10-21 13:32:59.203\n1454, 0010154108, 2012-10-21 13:33:06.46\n1455, 0010154108, 2012-10-21 13:33:13.171\n1456, 0010154108, 2012-10-21 13:33:20.62\n1457, 0010154108, 2012-10-21 13:33:27.62\n1458, 0010154108, 2012-10-21 13:33:34.171\n1459, 0010154108, 2012-10-21 13:33:40.234\n1460, 0010154108, 2012-10-21 13:33:47 \n1461, 0010154108, 2012-10-21 13:33:53.812\n1462, 0010154108, 2012-10-21 13:33:59.828\n1463, 0010154108, 2012-10-21 13:34:05.859\n1464, 0010154108, 2012-10-21 13:34:11.828\n1465, 0010154108, 2012-10-21 13:34:18.843\n1466, 0010154108, 2012-10-21 13:34:24.828\n1467, 0010154108, 2012-10-21 13:34:30.781\n1468, 0010154108, 2012-10-21 13:34:36.765\n1469, 0010154108, 2012-10-21 13:34:43.156\n1470, 0010154108, 2012-10-21 13:34:49.375\n1471, 0010154108, 2012-10-21 13:34:55.593\n1472, 0010154108, 2012-10-21 13:35:03.156\n1473, 0010154108, 2012-10-21 13:35:10.875\n1474, 0010154108, 2012-10-21 13:35:16.734\n1475, 0010154108, 2012-10-21 13:35:24.875\n1476, 0010154108, 2012-10-21 13:35:31.750\n1477, 0010154108, 2012-10-21 13:35:38.765\n1478, 0010154108, 2012-10-21 13:35:45.859\n1479, 0010154108, 2012-10-21 13:35:54.203\n1480, 0010154108, 2012-10-21 13:36:01.62\n1481, 0010154108, 2012-10-21 13:36:08.93\n1482, 0010154108, 2012-10-21 13:36:15.109\n1483, 0010154108, 2012-10-21 13:36:21.109\n1484, 0010154108, 2012-10-21 13:36:28.109\n1485, 0010154108, 2012-10-21 13:36:34.93\n1486, 0010154108, 2012-10-21 13:36:40.93\n1487, 0010154108, 2012-10-21 13:36:46.78\n1488, 0010154108, 2012-10-21 13:36:54.921\n1489, 0010154108, 2012-10-21 13:37:01.93\n1490, 0010154108, 2012-10-21 13:37:08.93\n1491, 0010154108, 2012-10-21 13:37:14.78\n1492, 0010154108, 2012-10-21 13:37:20.78\n1493, 0010154108, 2012-10-21 13:37:26.78\n1494, 0010154108, 2012-10-21 13:37:33.93\n1495, 0010154108, 2012-10-21 13:37:39.140\n1496, 0010154108, 2012-10-21 13:37:45.156\n1497, 0010154108, 2012-10-21 13:37:51.171\n1498, 0010154108, 2012-10-21 13:37:58.562\n1499, 0010154108, 2012-10-21 13:38:05.93\n1500, 0010154108, 2012-10-21 13:38:11.125\n1501, 0010154108, 2012-10-21 13:38:18.109\n1502, 0010154108, 2012-10-21 13:38:24.78\n1503, 0010154108, 2012-10-21 13:38:30.15\n1504, 0010154108, 2012-10-21 13:38:36.15\n1505, 0010154108, 2012-10-21 13:38:42.984\n1506, 0010154108, 2012-10-21 13:38:48.984\n1507, 0010154108, 2012-10-21 13:38:55 \n1508, 0010154108, 2012-10-21 13:39:01.750\n1509, 0010154108, 2012-10-21 13:39:07.953\n1510, 0010154108, 2012-10-21 13:39:13.953\n1511, 0010154108, 2012-10-21 13:39:19.984\n1512, 0010154108, 2012-10-21 13:39:26 \n1513, 0010154108, 2012-10-21 13:39:32.984\n1514, 0010154108, 2012-10-21 13:39:38.953\n1515, 0010154108, 2012-10-21 13:39:44.937\n1516, 0010154108, 2012-10-21 13:39:50.937\n1517, 0010154108, 2012-10-21 13:39:57.968\n1518, 0010154108, 2012-10-21 13:40:03.968\n1519, 0010154108, 2012-10-21 13:40:10.15\n1520, 0010154108, 2012-10-21 13:40:16.15\n1521, 0010154108, 2012-10-21 13:40:22.968\n1522, 0010154108, 2012-10-21 13:40:28.953\n1523, 0010154108, 2012-10-21 13:40:34.953\n1524, 0010154108, 2012-10-21 13:40:40.984\n1525, 0010154108, 2012-10-21 13:40:48 \n1526, 0010154108, 2012-10-21 13:40:54.15\n1527, 0010154108, 2012-10-21 13:40:59.984\n1528, 0010154108, 2012-10-21 13:41:07.578\n1529, 0010154108, 2012-10-21 13:41:13.984\n1530, 0010154108, 2012-10-21 13:41:20.31\n1531, 0010154108, 2012-10-21 13:41:26.31\n1532, 0010154108, 2012-10-21 13:41:33.78\n1533, 0010154108, 2012-10-21 13:41:39.46\n1534, 0010154108, 2012-10-21 13:41:45.31\n1535, 0010154108, 2012-10-21 13:41:50.937\n1536, 0010154108, 2012-10-21 13:41:57.968\n1537, 0010154108, 2012-10-21 13:42:03.953\n1538, 0010154108, 2012-10-21 13:42:11.93\n1539, 0010154108, 2012-10-21 13:42:17.953\n1540, 0010154108, 2012-10-21 13:42:23.968\n1541, 0010154108, 2012-10-21 13:42:30.187\n1542, 0010154108, 2012-10-21 13:42:37.968\n1543, 0010154108, 2012-10-21 13:42:44 \n1544, 0010154108, 2012-10-21 13:42:50.15\n1545, 0010154108, 2012-10-21 13:42:56 \n1546, 0010154108, 2012-10-21 13:43:03.31\n1547, 0010154108, 2012-10-21 13:43:08.984\n1548, 0010154108, 2012-10-21 13:43:14.984\n1549, 0010154108, 2012-10-21 13:43:21.281\n1550, 0010154108, 2012-10-21 13:43:28.62\n1551, 0010154108, 2012-10-21 13:43:35 \n1552, 0010154108, 2012-10-21 13:43:41.78\n1553, 0010154108, 2012-10-21 13:43:48.78\n1554, 0010154108, 2012-10-21 13:43:54 \n1555, 0010154108, 2012-10-21 13:43:59.968\n1556, 0010154108, 2012-10-21 13:44:06.62\n1557, 0010154108, 2012-10-21 13:44:13.15\n1558, 0010154108, 2012-10-21 13:44:19.968\n1559, 0010154108, 2012-10-21 13:44:25.984\n1560, 0010154108, 2012-10-21 13:44:33.15\n1561, 0010154108, 2012-10-21 13:44:39.78\n1562, 0010154108, 2012-10-21 13:44:45.46\n1563, 0010154108, 2012-10-21 13:44:53.78\n1564, 0010154108, 2012-10-21 13:44:59.78\n1565, 0010154108, 2012-10-21 13:45:05.437\n1566, 0010154108, 2012-10-21 13:45:12.953\n1567, 0010154108, 2012-10-21 13:45:19.625\n1568, 0010154108, 2012-10-21 13:45:25.937\n1569, 0010154108, 2012-10-21 13:45:32.921\n1570, 0010154108, 2012-10-21 13:45:38.937\n1571, 0010154108, 2012-10-21 13:45:44.890\n1572, 0010154108, 2012-10-21 13:45:50.843\n1573, 0010154108, 2012-10-21 13:45:57.843\n1574, 0010154108, 2012-10-21 13:46:03.843\n1575, 0010154108, 2012-10-21 13:46:09.906\n1576, 0010154108, 2012-10-21 13:46:15.906\n1577, 0010154108, 2012-10-21 13:46:22.921\n1578, 0010154108, 2012-10-21 13:46:28.859\n1579, 0010154108, 2012-10-21 13:46:34.796\n1580, 0010154108, 2012-10-21 13:46:40.703\n1581, 0010154108, 2012-10-21 13:46:48.656\n1582, 0010154108, 2012-10-21 13:46:54.687\n1583, 0010154108, 2012-10-21 13:47:00.671\n1584, 0010154108, 2012-10-21 13:47:07.687\n1585, 0010154108, 2012-10-21 13:47:13.750\n1586, 0010154108, 2012-10-21 13:47:20.265\n1587, 0010154108, 2012-10-21 13:47:27.812\n1588, 0010154108, 2012-10-21 13:47:33.796\n1589, 0010154108, 2012-10-21 13:47:39.781\n1590, 0010154108, 2012-10-21 13:47:45.765\n1591, 0010154108, 2012-10-21 13:47:52.734\n1592, 0010154108, 2012-10-21 13:47:58.781\n1593, 0010154108, 2012-10-21 13:48:04.812\n1594, 0010154108, 2012-10-21 13:48:10.843\n1595, 0010154108, 2012-10-21 13:48:17.843\n1596, 0010154108, 2012-10-21 13:48:23.843\n1597, 0010154108, 2012-10-21 13:48:29.859\n1598, 0010154108, 2012-10-21 13:48:35.890\n1599, 0010154108, 2012-10-21 13:48:42.906\n1600, 0010154108, 2012-10-21 13:48:48.875\n1601, 0010154108, 2012-10-21 13:48:54.890\n1602, 0010154108, 2012-10-21 13:49:00.890\n1603, 0010154108, 2012-10-21 13:49:07.843\n1604, 0010154108, 2012-10-21 13:49:13.890\n1605, 0010154108, 2012-10-21 13:49:19.890\n1606, 0010154108, 2012-10-21 13:49:28.468\n1607, 0010154108, 2012-10-21 13:49:34.500\n1608, 0010154108, 2012-10-21 13:49:40.484\n1609, 0010154108, 2012-10-21 13:49:46.453\n1610, 0010154108, 2012-10-21 13:49:52.859\n1611, 0010154108, 2012-10-21 13:49:58.984\n1612, 0010154108, 2012-10-21 13:50:04.875\n1613, 0010154108, 2012-10-21 13:50:10.875\n1614, 0010154108, 2012-10-21 13:50:17.796\n1615, 0010154108, 2012-10-21 13:50:23.812\n1616, 0010154108, 2012-10-21 13:50:29.796\n1617, 0010154108, 2012-10-21 13:50:35.812\n1618, 0010154108, 2012-10-21 13:50:42.812\n1619, 0010154108, 2012-10-21 13:50:48.828\n1620, 0010154108, 2012-10-21 13:50:54.906\n1621, 0, 2012-10-21 13:51:00.828\n1622, 0, 2012-10-21 13:51:07.890\n1623, 0, 2012-10-21 13:51:13.796\n1624, 0, 2012-10-21 13:51:19.796\n1625, 0, 2012-10-21 13:51:25.812\n1626, 0, 2012-10-21 13:51:32.828\n1627, 0, 2012-10-21 13:51:38.828\n1628, 0, 2012-10-21 13:51:44.796\n1629, 0, 2012-10-21 13:51:50.781\n1630, 0, 2012-10-21 13:51:57.750\n1631, 0, 2012-10-21 13:52:03.718\n1632, 0, 2012-10-21 13:52:12.718\n1633, 0, 2012-10-21 13:52:18.765\n1634, 0, 2012-10-21 13:52:25.46\n1635, 0, 2012-10-21 13:52:32.796\n1636, 0, 2012-10-21 13:52:39.765\n1637, 0, 2012-10-21 13:52:45.781\n1638, 0, 2012-10-21 13:52:52.812\n1639, 0, 2012-10-21 13:52:59.218\n1640, 0, 2012-10-21 13:53:05.250\n1641, 0, 2012-10-21 13:53:12.765\n1642, 0, 2012-10-21 13:53:18.781\n1643, 0, 2012-10-21 13:53:24.875\n1644, 0, 2012-10-21 13:53:30.890\n1645, 0, 2012-10-21 13:53:37.765\n1646, 0, 2012-10-21 13:53:43.750\n1647, 0, 2012-10-21 13:53:49.734\n1648, 0, 2012-10-21 13:53:55.718\n1649, 0, 2012-10-21 13:54:02.859\n1650, 0, 2012-10-21 13:54:08.750\n1651, 0, 2012-10-21 13:54:14.781\n1652, 0, 2012-10-21 13:54:20.750\n1653, 0, 2012-10-21 13:54:27.703\n1654, 0, 2012-10-21 13:54:33.656\n1655, 0, 2012-10-21 13:54:39.671\n1656, 0, 2012-10-21 13:54:46.671\n1657, 0, 2012-10-21 13:54:53.671\n1658, 0, 2012-10-21 13:54:59.656\n1659, 0, 2012-10-21 13:55:05.656\n1660, 0, 2012-10-21 13:55:12.640\n1661, 0, 2012-10-21 13:55:18.640\n1662, 0, 2012-10-21 13:55:24.656\n1663, 0, 2012-10-21 13:55:30.718\n1664, 0, 2012-10-21 13:55:37.703\n1665, 0, 2012-10-21 13:55:43.703\n1666, 0, 2012-10-21 13:55:49.671\n1667, 0, 2012-10-21 13:55:55.609\n1668, 0, 2012-10-21 13:56:02.609\n1669, 0, 2012-10-21 13:56:08.625\n1670, 0, 2012-10-21 13:56:14.625\n1671, 0, 2012-10-21 13:56:20.593\n1672, 0, 2012-10-21 13:56:27.625\n1673, 0, 2012-10-21 13:56:33.687\n1674, 0, 2012-10-21 13:56:39.640\n1675, 0, 2012-10-21 13:56:45.578\n1676, 0, 2012-10-21 13:56:53.703\n1677, 0, 2012-10-21 13:56:59.984\n1678, 0, 2012-10-21 13:57:07.562\n1679, 0, 2012-10-21 13:57:14.562\n1680, 0, 2012-10-21 13:57:20.578\n1681, 0, 2012-10-21 13:57:27.625\n1682, 0, 2012-10-21 13:57:33.609\n1683, 0, 2012-10-21 13:57:39.546\n1684, 0, 2012-10-21 13:57:47.609\n1685, 0, 2012-10-21 13:57:55.765\n1686, 0, 2012-10-21 13:58:02.453\n1687, 0, 2012-10-21 13:58:08.609\n1688, 0, 2012-10-21 13:58:14.484\n1689, 0, 2012-10-21 13:58:22.500\n1690, 0, 2012-10-21 13:58:28.703\n1691, 0, 2012-10-21 13:58:35 \n1692, 0, 2012-10-21 13:58:42.656\n1693, 0, 2012-10-21 13:58:49.468\n1694, 0, 2012-10-21 13:58:55.453\n1695, 0, 2012-10-21 13:59:02.453\n1696, 0, 2012-10-21 13:59:08.453\n1697, 0, 2012-10-21 13:59:14.453\n1698, 0, 2012-10-21 13:59:20.453\n1699, 0, 2012-10-21 13:59:27.453\n1700, 0, 2012-10-21 13:59:33.484\n1701, 0, 2012-10-21 13:59:40.515\n1702, 0, 2012-10-21 13:59:47.515\n1703, 0, 2012-10-21 13:59:53.531\n1704, 0, 2012-10-21 14:00:01.437\n1705, 0, 2012-10-21 14:00:07.484\n1706, 0, 2012-10-21 14:00:13.484\n1707, 0, 2012-10-21 14:00:19.500\n1708, 0, 2012-10-21 14:00:25.531\n1709, 0, 2012-10-21 14:00:32.562\n1710, 0, 2012-10-21 14:00:38.531\n1711, 0, 2012-10-21 14:00:44.515\n1712, 0, 2012-10-21 14:00:50.484\n1713, 0, 2012-10-21 14:00:57.531\n1714, 0, 2012-10-21 14:01:04.62\n1715, 0, 2012-10-21 14:01:09.968\n1716, 0, 2012-10-21 14:01:17.531\n1717, 0, 2012-10-21 14:01:23.546\n1718, 0, 2012-10-21 14:01:29.546\n1719, 0, 2012-10-21 14:01:35.531\n1720, 0, 2012-10-21 14:01:42.546\n1721, 0, 2012-10-21 14:01:48.562\n1722, 0, 2012-10-21 14:01:54.531\n1723, 0, 2012-10-21 14:02:00.546\n1724, 0, 2012-10-21 14:02:07.671\n1725, 0, 2012-10-21 14:02:13.468\n1726, 0, 2012-10-21 14:02:19.921\n1727, 0, 2012-10-21 14:02:27.468\n1728, 0, 2012-10-21 14:02:33.484\n1729, 0, 2012-10-21 14:02:39.468\n1730, 0, 2012-10-21 14:02:45.484\n1731, 0, 2012-10-21 14:02:52.484\n1732, 0, 2012-10-21 14:02:58.484\n1733, 0, 2012-10-21 14:03:04.515\n1734, 0, 2012-10-21 14:03:12.500\n1735, 0, 2012-10-21 14:03:18.421\n1736, 0, 2012-10-21 14:03:24.437\n1737, 0, 2012-10-21 14:03:30.734\n1738, 0, 2012-10-21 14:03:37.484\n1739, 0, 2012-10-21 14:03:43.437\n1740, 0, 2012-10-21 14:03:49.437\n1741, 0, 2012-10-21 14:03:55.484\n1742, 0, 2012-10-21 14:04:02.484\n1743, 0, 2012-10-21 14:04:08.453\n1744, 0, 2012-10-21 14:04:14.531\n1745, 0, 2012-10-21 14:04:20.500\n1746, 0, 2012-10-21 14:04:27.484\n1747, 0, 2012-10-21 14:04:33.515\n1748, 0, 2012-10-21 14:04:39.484\n1749, 0, 2012-10-21 14:04:45.375\n1750, 0, 2012-10-21 14:04:52.375\n1751, 0, 2012-10-21 14:04:58.406\n1752, 0, 2012-10-21 14:05:04.421\n1753, 0, 2012-10-21 14:05:10.437\n1754, 0, 2012-10-21 14:05:17.406\n1755, 0, 2012-10-21 14:05:23.421\n1756, 0, 2012-10-21 14:05:29.453\n1757, 0, 2012-10-21 14:05:35.453\n1758, 0, 2012-10-21 14:05:42.468\n1759, 0, 2012-10-21 14:05:48.437\n1760, 0, 2012-10-21 14:05:54.437\n1761, 0, 2012-10-21 14:06:00.453\n1762, 0, 2012-10-21 14:06:07.406\n1763, 0, 2012-10-21 14:06:13.390\n1764, 0, 2012-10-21 14:06:19.343\n1765, 0, 2012-10-21 14:06:25.359\n1766, 0, 2012-10-21 14:06:32.343\n1767, 0, 2012-10-21 14:06:38.343\n1768, 0, 2012-10-21 14:06:44.359\n1769, 0, 2012-10-21 14:06:50.343\n1770, 0, 2012-10-21 14:06:57.343\n1771, 0, 2012-10-21 14:07:03.328\n1772, 0, 2012-10-21 14:07:09.312\n1773, 0, 2012-10-21 14:07:15.343\n1774, 0, 2012-10-21 14:07:22.812\n1775, 0, 2012-10-21 14:07:29.312\n1776, 0, 2012-10-21 14:07:35.328\n1777, 0, 2012-10-21 14:07:42.343\n1778, 0, 2012-10-21 14:07:48.296\n1779, 0, 2012-10-21 14:07:54.343\n1780, 0, 2012-10-21 14:08:00.343\n1781, 0, 2012-10-21 14:08:07.328\n1782, 0, 2012-10-21 14:08:13.312\n1783, 0, 2012-10-21 14:08:19.265\n1784, 0, 2012-10-21 14:08:26.46\n1785, 0, 2012-10-21 14:08:32.296\n1786, 0, 2012-10-21 14:08:38.296\n1787, 0, 2012-10-21 14:08:44.281\n1788, 0, 2012-10-21 14:08:50.296\n1789, 0, 2012-10-21 14:08:57.265\n1790, 0, 2012-10-21 14:09:03.828\n1791, 0, 2012-10-21 14:09:09.937\n1792, 0, 2012-10-21 14:09:17.265\n1793, 0, 2012-10-21 14:09:23.546\n1794, 0, 2012-10-21 14:09:30.468\n1795, 0, 2012-10-21 14:09:39.406\n1796, 0, 2012-10-21 14:09:49.453\n1797, 0, 2012-10-21 14:09:57.562\n1798, 0, 2012-10-21 14:10:04.359\n1799, 0, 2012-10-21 14:10:15.609\n1800, 0, 2012-10-21 14:10:22.187\n1801, 0, 2012-10-21 14:10:28.218\n1802, 0, 2012-10-21 14:10:34.218\n1803, 0, 2012-10-21 14:10:40.296\n1804, 0, 2012-10-21 14:10:50.250\n1805, 0, 2012-10-21 14:10:57.265\n1806, 0, 2012-10-21 14:11:03.125\n1807, 0, 2012-10-21 14:11:09.125\n1808, 0, 2012-10-21 14:11:15.125\n1809, 0, 2012-10-21 14:11:22.125\n1810, 0, 2012-10-21 14:11:28.109\n1811, 0, 2012-10-21 14:11:35.390\n1812, 0, 2012-10-21 14:11:42.15\n1813, 0, 2012-10-21 14:11:48.31\n1814, 0, 2012-10-21 14:11:54.46\n1815, 0, 2012-10-21 14:12:00.78\n1816, 0, 2012-10-21 14:12:08.140\n1817, 0, 2012-10-21 14:12:14.140\n1818, 0, 2012-10-21 14:12:20.171\n1819, 0, 2012-10-21 14:12:27.218\n1820, 0, 2012-10-21 14:12:33.171\n1821, 0, 2012-10-21 14:12:39.125\n1822, 0, 2012-10-21 14:12:46 \n1823, 0, 2012-10-21 14:12:52.93\n1824, 0, 2012-10-21 14:12:58.593\n1825, 0, 2012-10-21 14:13:05.484\n1826, 0, 2012-10-21 14:13:12.78\n1827, 0, 2012-10-21 14:13:18.93\n1828, 0, 2012-10-21 14:13:24.109\n1829, 0, 2012-10-21 14:13:30.140\n1830, 0, 2012-10-21 14:13:37.140\n1831, 0, 2012-10-21 14:13:43.203\n1832, 0, 2012-10-21 14:13:49.281\n1833, 0, 2012-10-21 14:13:57.296\n1834, 0, 2012-10-21 14:14:03.203\n1835, 0, 2012-10-21 14:14:09.671\n1836, 0, 2012-10-21 14:14:17.265\n1837, 0, 2012-10-21 14:14:23.171\n1838, 0, 2012-10-21 14:14:29.187\n1839, 0, 2012-10-21 14:14:35.109\n1840, 0, 2012-10-21 14:14:43.484\n1841, 0, 2012-10-21 14:14:49.515\n1842, 0, 2012-10-21 14:14:57.203\n1843, 0, 2012-10-21 14:15:03.187\n1844, 0, 2012-10-21 14:15:09.125\n1845, 0, 2012-10-21 14:15:17.156\n1846, 0, 2012-10-21 14:15:23.140\n1847, 0, 2012-10-21 14:15:29.109\n1848, 0, 2012-10-21 14:15:35.109\n1849, 0, 2012-10-21 14:15:42.125\n1850, 0, 2012-10-21 14:15:48.93\n1851, 0, 2012-10-21 14:15:54.125\n1852, 0, 2012-10-21 14:16:00.109\n1853, 0, 2012-10-21 14:16:07.546\n1854, 0, 2012-10-21 14:16:14.78\n1855, 0, 2012-10-21 14:16:20.156\n1856, 0, 2012-10-21 14:16:28.93\n1857, 0, 2012-10-21 14:16:34.546\n1858, 0, 2012-10-21 14:16:42.62\n1859, 0, 2012-10-21 14:16:50.437\n1860, 0, 2012-10-21 14:17:13.15\n1861, 0, 2012-10-21 14:17:20.593\n1862, 0, 2012-10-21 14:17:28.125\n1863, 0, 2012-10-21 14:17:35.578\n1864, 0, 2012-10-21 14:17:43.125\n1865, 0, 2012-10-21 14:17:52.484\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":54,"score":-2,"question_id":13001285,"title":"How to use dropdown list in query?","body":"<p>I have this dropdown list and idea is i wanto to select all products that they are added(today,last week,last month,last year).This is format datetime in database:0000-00-00 00:00:00. </p>\n\n<pre><code>  &lt;select name=\"time\" id=\"time\" &gt;\n  &lt;option value=\"0\"&gt;Please Select&lt;/option&gt;\n  &lt;option name=\"1\" value=\"1\" &gt;Today&lt;/option&gt;\n  &lt;option name=\"2 \"value=\"2\"&gt;Last Week&lt;/option&gt;\n  &lt;option name=\"3 \"value=\"3\"&gt;Last Month&lt;/option&gt;\n  &lt;option name=\"4 \"value=\"4\"&gt;Last Year&lt;/option&gt;\n  &lt;/select&gt;\n</code></pre>\n"},{"tags":["php","query","mongodb"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12987812,"title":"Converting a mysql query to mongodb using php","body":"<p>Currently I have an mysql table like this:</p>\n\n<pre><code>+---------+----------+------+-----+---------+----------------+\n| Field   | Type     | Null | Key | Default | Extra          |\n+---------+----------+------+-----+---------+----------------+\n| id      | int(11)  | NO   | PRI | NULL    | auto_increment |\n| mediaID | int(11)  | NO   |     | NULL    |                |\n| date    | datetime | NO   |     | NULL    |                |\n+---------+----------+------+-----+---------+----------------+\n</code></pre>\n\n<p>In this table I store every hit made for a specific media. I save mediaID and date when this hit happened. So ... when I want to show trending medias (most viewed medias for specific time period), I use this mysql query:</p>\n\n<pre><code>SELECT  mediaID, COUNT(*) as cnt FROM hits WHERE DATE(date) = CURDATE() - INTERVAL 1 DAY GROUP BY mediaID ORDER BY cnt DESC LIMIT 0,10\n</code></pre>\n\n<p>Now.. I'm planning to move this in MongoDB. Currently I have collection \"hits\" with the following documents:</p>\n\n<pre><code>{\n    _id: ObjectId(\"50827eaaae1c3ced6c00000f\"),\n    mediaID: \"2\",\n    ts: ISODate(\"2012-10-20T13:36:26+03:00\")\n}\n{\n    _id: ObjectId(\"50827ebeae1c3ced6c000010\"),\n    mediaID: \"1\",\n    ts: ISODate(\"2012-10-20T13:36:46+03:00\")\n}\n{\n    _id: ObjectId(\"50827ec3ae1c3c6167000008\"),\n    mediaID: \"2\",\n    ts: ISODate(\"2012-10-20T13:36:51+03:00\")\n}\n</code></pre>\n\n<p>So, my question is how to convert my previous query to be able to work with MongoDB? \nP.S. I'm using php with php mongodb driver.</p>\n\n<p>Greetings,\nMilen</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":89,"score":0,"question_id":12995863,"title":"Product Sales Report weekly monthly","body":"<p>how can i run a SQL query to retrieve weekly  and monthly sales reports.</p>\n\n<p><strong>Table: orders</strong></p>\n\n<h2>    ID |Product_id | order price | QTY | purchase date</h2>\n\n<pre><code>1        1           34         2        9/10/12\n2        1           34         2        8/10/12\n3        4           34         2        07/10/12\n4        3           34         2        22/09/12\n5        1           34         2        9/10/12\n6        1           34         2        22/09/12\n7        4           34         2        9/08/12\n8        3           34         2        22/09/12\n</code></pre>\n\n<p><strong>Table: Products</strong></p>\n\n<pre><code>ID | Name | description\n\n1    A       ksfjsdkf\n2    B       ksfjsdkf\n3    C       ksfjsdkf\n1    A       ksfjsdkf\n</code></pre>\n\n<p><strong>Expecting result</strong>\n:the following is an example result not accurate</p>\n\n<pre><code>product_name           Weekly Sum(QTY), weekly revenue,  Monthly SUM(QTY), monthly revenue\n\nA                           120             3000           2345                  234343\n</code></pre>\n"},{"tags":["regex","query","sqlite","query-string"],"answer_count":8,"favorite_count":9,"up_vote_count":12,"down_vote_count":0,"view_count":8695,"score":12,"question_id":5071601,"title":"How do I use regex in a SQLite query?","body":"<p>I'd like to use a regular expression in sqlite, but I don't know how.</p>\n\n<p>My table has got a column with strings like this: \"3,12,13,14,19,28,32\"\nNow if I type \"where x LIKE '3'\" I also get the rows which contain values like 13 or 32,\nbut I'd like to get only the rows which have exactly the value 3 in that string.</p>\n\n<p>Does anyone know how to solve this?</p>\n"},{"tags":["php","string","query",".htaccess","url"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12999700,"title":"remove query string form url with htaccess","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5464481/clean-urls-for-search-query\">Clean URLs for search query?</a>  </p>\n</blockquote>\n\n\n\n<p>I made a php webpage for checking the color code,here is the first four line</p>\n\n<pre><code>if(isset($_GET['c']))\n$hex = $_GET['c'];\nelseif(!isset($_GET['c']))\n$hex = $_POST['c'];\n</code></pre>\n\n<p>and my htaccess have:</p>\n\n<pre><code>RewriteEngine On\nRewriteRule ^([a-zA-Z0-9]{6})$ index.php?c=$1 [L]\n</code></pre>\n\n<p>if I type site.com/ffcdee it successfully show the color #ffcdee\nbut if i use the input box:</p>\n\n<pre><code>&lt;form action=\"\"&gt;\n&lt;input type=\"text\" name=\"c\" &gt;\n&lt;input type=\"submit\" value=\"Search\" id=\"search-submit\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>it show site.com/?c=ffcdee,\nI tried change input name to other word,but the script not work anymore..\nhow can I remove the ?c= from the url?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":54,"score":-2,"question_id":12998090,"title":"Is there a way to simplify the given mysql query","body":"<pre><code>SELECT \nt3.transaction_id,\nt3.transaction_no,\nt3.retrivel_ref_no,\nt3.transaction_type,\nt3.reversal_flag,\nt3.expires_on,\nt3.currency_code,\nt3.message_reason_code,\nt4.sales_person_id,\nt3.card_no,\nt3.transaction_amount,\nt3.transmission_date_time\nFROM TRANSACTION AS t4\nINNER JOIN\n(   SELECT\n    t2.transaction_id,\n    t2.transaction_no,\n    t2.retrivel_ref_no,\n    t2.transaction_type,\n    t2.reversal_flag,\n    t2.transmission_date_time,\n    t2.transaction_amount,\n    t2.card_no,\n    t2.expires_on,\n    t2.currency_code,\n    t1.message_reason_code\n    FROM\n    (   SELECT*\n        FROM    transaction_pci_details \n        WHERE   message_reason_code LIKE '%OUT%'|| \n            message_reason_code LIKE '%FAILED%'\n    ) AS t1\n    INNER JOIN\n    (   \n        SELECT*\n        FROM    transaction_pci_details \n        WHERE   action_code LIKE '%REQ%'\n    ) AS t2\n    ON t1.transaction_no = t2.transaction_no    \n) AS t3\nON t4.transaction_id = t3.transaction_id;\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":144,"score":0,"question_id":9098100,"title":"MySQL - Delete one row and re-order the others with the correct Sort ID","body":"<p>I have a table which contains a bunch of rows and a <strong>sort_order</strong>.  I was wondering how I can do this so when I delete a row, say I delete the highlighted row with a sort_order of 7.  Then instead of 7 just being removed, I would need to change #8 to #7 .. #9 to #8 .. #10 to #9 .. and #11 to #10.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/GVg3E.png\" alt=\"enter image description here\"></p>\n\n<p>Is something like this possible?</p>\n"},{"tags":["query","doctrine","doctrine-1.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":399,"score":0,"question_id":8563614,"title":"Doctrine Query calculate MAX value in WHERE clause","body":"<p>I have this tables:</p>\n\n<p><em>subscribers</em></p>\n\n<pre><code>id | name  |\n---+-------+\n1  | Hill  |\n2  | Sam   |\n3  | Joe   |\n</code></pre>\n\n<p>subscribers_years</p>\n\n<pre><code>subscriber_id | year  |\n--------------+-------+\n1             | 2009  |\n1             | 2010  |\n1             | 2011  |\n2             | 2009  |\n2             | 2010  |\n3             | 2010  |\n</code></pre>\n\n<p>I want to take an advanced search using only records that have a maximum as x.\nIf x = 2010\nResults query must be: Sam and Joe!</p>\n\n<p>I try this:</p>\n\n<pre><code>$query = $this-&gt;createQuery('su')\n            -&gt;select('su.id, su.name)\n            -&gt;addWhere(\n                '(SELECT MAX(year) AS maxYear FROM `subscribers_years` WHERE `subscriber_id`=`su.id`) = ?',\n                2010\n            );\n</code></pre>\n\n<p>but i have the message error: Message: Couldn't find class <code>subscribers_years</code> </p>\n\n<p>how should I write my query right way?</p>\n\n<hr>\n\n<h2>Solution</h2>\n\n<pre><code>$query-&gt;addWhere('(SELECT MAX(year) AS maxYear FROM SubscriberYear WHERE subscriber_id=su.id) = ?', 2010 );\n</code></pre>\n\n<p>my mistake was that I did not use the class name Doctrine as the From, but used the name of the table mysql! :S</p>\n"},{"tags":["android","query","sqlite","achartengine"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":12995417,"title":"plotting sqlite data with achartengine","body":"<p>I am using achartengine to plot two fields from an sqlite table i set up. I believe that the retrieving of fields is working, but i cannot resolve some variable issues in the graphing activity. Any suggestions? Achartengine and sqlite are both new to me so any help is welcome. I am getting errors in the value1 ==null line and the mcurrentSeries and mChartView.</p>\n\n<p>My Database query:</p>\n\n<pre><code>public String getPlotX(long l) {\n    String[] column = new String[]{KEY_TIME, KEY_BGL, KEY_RANGE, KEY_LASTMEAL, KEY_MEALTIME};\n    Cursor c = ourDatabase.query(DATABASE_TABLE, column, KEY_ROWID + \"=\" + l, null, null, null, null);\n    if (c != null){\n    c.moveToFirst();\n    String value1 = c.getString(0);\n    return value1;\n    }\n    return null;\n    }\n\npublic String getPlotY(long l) {\n    String[] column = new String[]{KEY_TIME, KEY_BGL, KEY_RANGE, KEY_LASTMEAL, KEY_MEALTIME};\n    Cursor c = ourDatabase.query(DATABASE_TABLE, column, KEY_ROWID + \"=\" + l, null, null, null, null);\n    if (c != null){\n    c.moveToFirst();\n    String value1 = c.getString(1);\n    return value1;\n    }\n    return null;\n    }\n</code></pre>\n\n<p>And my graph activity class:\n         import org.achartengine.ChartFactory;\n         import org.achartengine.model.TimeSeries;\n         import org.achartengine.model.XYMultipleSeriesDataset;\n         import org.achartengine.renderer.XYMultipleSeriesRenderer;\n         import org.achartengine.renderer.XYSeriesRenderer;</p>\n\n<pre><code>     import android.app.Activity;\n     import android.content.Context;\n     import android.content.Intent;\n\n public class GraphActivity extends Activity {\npublic Intent getIntent(Context context){\n\n    DatabaseHandler getData = new DatabaseHandler(context);\n    getData.open();\n\n    for (int i = 1; value1 == null; i++) {\n    String value1 = getData.getPlotX(i);\n    String value2 = getData.getPlotY(i);\n\n    double x = Double.parseDouble(value1);\n    double y = Double.parseDouble(value2);\n\n    mCurrentSeries.add(x, y); \n\n    }\n    getData.close();\n\n    if (mChartView != null) {\n    mChartView.repaint();\n    }\n    }\n}\n</code></pre>\n"},{"tags":["c#","sql","database","query","oledb"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12994943,"title":"Joins not working in described condition","body":"<p>I have two tables.</p>\n\n<p>Table1->Payment</p>\n\n<pre><code>AdmissionNum(PK)  |  StudName |   Fees |\n\n       1               sagar      5000 \n       2               nilesh     6000\n       3               amar       4000  \n</code></pre>\n\n<p>Table2-> paymentDetails</p>\n\n<pre><code>AdmissionNum(FK) | RemainingFees |   Date       |  Payment\n        1             4000          1/1/2012          1000\n        2             5000          2/5/2012          1000\n        1             3500          2/10/2012         1500\n        1             2500          2/15/2012         1000\n        2             2500          2/20/2012         2500\n        3             0             3/25/2012         4000\n</code></pre>\n\n<p>I have tried different queries but was not able to make joint between payment table and paymentDetails table.\nI am making C# windows app. When particular student is paying fees his record is stored in paymentDetails table.\nI want to extract only outstanding fees details i.e. student whose Remaining Fees is greater than 0 but the last details in the paymentDetais table i.e. .</p>\n\n<p>My expected resut table is-</p>\n\n<pre><code>AdmissionNum  |  StudName |   Fees | RemainingFees\n\n       1           sagar      5000    2500\n       2           nilesh     6000    2500\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":45,"score":-2,"question_id":12994444,"title":"How would I write this MySQL query for products?","body":"<p>I have 3 dropdown boxes, and I want to make a query depending what the user chooses. But what happens if they don't choose any option for the dropdown boxes?</p>\n\n<p>I want to display all products where <code>product=</code><em><code>first dropdownbox</code></em>, and <code>price</code> is between <code>$first</code> and <code>$last</code>, but I'm unsure how to do that.</p>\n\n<pre><code>SELECT * FROM Products where product=$rec AND PRICE &gt;=$first AND PRICE &lt;=$last\n</code></pre>\n"},{"tags":["php","mysql","sql","query","large-data"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12994326,"title":"optimizing large data in php page","body":"<p>I'm trying to speed up the time it takes to query 200K rows of data and show it in a web page, it normally takes around 20-30 seconds, but currently I've gotten it down to around 7-10 seconds. I still need it to go around 3-7 seconds at most. </p>\n\n<p>In my query, I'm selecting all the rows in a single table and placing around 5 columns into the PHP script. The query goes like this:</p>\n\n<pre><code>SELECT * FROM table where company = ? and division = ?;\n</code></pre>\n\n<p>I just add the parameters from my session. Then I send the query and the parameters in a <em>.inc</em> file and the <em>inc</em> runs the query. But it also runs a separate query for pagination of data. then it would compare the 2 queries to check for any irregularities between the two. Then it will place the data in a new window. </p>\n\n<p>Are there any known algorithms or techniques I could use to speed up the process? I've already removed any garbage code and sped up some functions but it's still slow.</p>\n\n<p>P.S.: <em>I also just handled the system around 2 days ago so I'm still familiarizing the structure.</em></p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12994131,"title":"SQL plus statement to a JAVA query","body":"<p>I am trying to execute:</p>\n\n<pre><code>SELECT P_NUMBER FROM RDIMARS;\n</code></pre>\n\n<p>In another part of my code, I can successfully execute this statement:</p>\n\n<pre><code>ResultSet result = statement.executeQuery(\"SELECT TABLE_NAME FROM USER_TABLES \" +\n\" WHERE TABLE_NAME LIKE 'APL%'\" );\n</code></pre>\n\n<p>However when I try this:</p>\n\n<pre><code>ResultSet result = statement.executeQuery(\"SELECT TABLE_NAME FROM USER_TABLES \" +\n\" WHERE RDIMARS LIKE 'P_NUMBER'\" );\n</code></pre>\n\n<p>as an attempt to mimic my first function code, it fails. What I would like to do is:</p>\n\n<pre><code>ResultSet result = statement.executeQuery(\"SELECT P_NUMBER from RDIMARS );\n</code></pre>\n\n<p>This does not work for me. But that exact code works in SQLplus. Any idea what I am doing wrong?  The SQLplus command I use is <code>select P_NUMBER from RDIMARS;</code></p>\n"},{"tags":["sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":931,"score":0,"question_id":7739186,"title":"sql query to display the name,job,department name salary and grade","body":"<p>The question is </p>\n\n<p>CREATE A QUERY THAT WILL DISPLAY THE <code>NAME,JOB,DEPARTMENT NAME,SALARY</code> AND <code>GRADE</code>( FROM THE <code>SALGRADE</code> TABLE) FOR ALL <code>EMPLOYEE</code>S.</p>\n\n<p>MY CODE SO FAR GIVES AN OUTPUT</p>\n\n<pre><code>select e.ename, e.job, d.dname, e.sal, s.grade\nfrom emp e, dept d, salgrade s\nwhere e.deptno = d.deptno\n</code></pre>\n\n<p>This returns 70 rows, but the result should only produce 14 rows.</p>\n\n<pre><code>EMPLOYEE   EMP JOB   DEPT NAME      EMP SALARY SALARY GRADE                               \n---------- --------- -------------- ---------- ------------                               \nJAMES      CLERK     SALES                 950            1                               \nSMITH      CLERK     RESEARCH              800            1                               \nADAMS      CLERK     RESEARCH             1100            1                               \nMARTIN     SALESMAN  SALES                1250            2                               \nWARD       SALESMAN  SALES                1250            2                               \nMILLER     CLERK     ACCOUNTING           1300            2                               \nALLEN      SALESMAN  SALES                1600            3                               \nTURNER     SALESMAN  SALES                1500            3                               \nBLAKE      MANAGER   RESEARCH             2850            4                               \nCLARK      MANAGER   ACCOUNTING           2450            4                               \nJONES      MANAGER   RESEARCH             2975            4                               \nFORD       ANALYST   RESEARCH             3000            4                               \nSCOTT      ANALYST   RESEARCH             3000            4                               \nKING       PRESIDENT ACCOUNTING           5000            5         \n</code></pre>\n\n<ul>\n<li><code>emp</code> table has <code>empno, ename, job, deptno, comm, sal</code></li>\n<li><code>salgrade</code> table has <code>grade</code></li>\n<li><code>DEPT</code> table has <code>deptno, loc</code></li>\n</ul>\n\n<p>please help ONLY 14 rows should be selected</p>\n"},{"tags":["php","mysql","ajax","query","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12993249,"title":"Ajax and PHP with database connection","body":"<p>i have problems with the code below, I'm trying to bring a message of error if the email already exists, but I'm not having success .. Look at the code:</p>\n\n<p>Ajax an jQuery:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;  \n\n    // Centering the text content\n    jQuery(window).resize(function () {\n        boxHeight();\n    }).load(function() {\n        boxHeight();\n        // Show the content and focus the email input\n        $(\"#content\").fadeIn();\n        $(\"#email\").focus();\n\n\n    });\n\n    jQuery(document).ready(function($){\n        $('#subscribe').submit(function(e){\n            e.preventDefault();\n\n            email = $('input#email');           \n            email_regex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;           \n            if(!email_regex.test(email.val())) {\n                $('#response', form).fadeIn(500, function() {\n                    $('#response', form).html('&lt;p class=\"message warning\" align=\"center\"&gt;Invalid email&lt;/p&gt;');\n                });\n                return;\n            } else {\n                $('#response', form).html('&lt;p class=\"message\"&gt;Please Wait...&lt;/p&gt;');\n            }\n\n            var form = $(this);\n            var post_url = form.attr('action');\n            var post_data = form.serialize();               \n            $.ajax({\n                type: 'POST',\n                url: post_url,\n                data: post_data,\n                success: function(responseText) {  if(responseText == 1) {\n                    $('#response', form).html('&lt;p class=\"message\"&gt;Error...&lt;/p&gt;');\n                } else { if(responseText == \"\") {                       \n                    $(form).fadeOut(500, function(){\n                        form.html(msg).fadeIn();\n                    });\n\n                }\n                }\n            }\n            });\n        });\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>PHP Database connect:</p>\n\n<pre><code>    &lt;?php    \n$host=\"xxxx\"; // Host name\n$username=\"xxxx\"; // Mysql username\n$password=\"xxxx\"; // Mysql password\n$db_name=\"xxxx\"; // Database name\n$tbl_name=\"xxxx\"; // Table name\n\n// Connect to server and select database.\nmysql_connect(\"$host\", \"$username\", \"$password\")or die(\"cannot connect\");\nmysql_select_db(\"$db_name\")or die(\"cannot select DB\");\n\n// Get values from form\n$email = $_POST['email'];\n\n$query = mysql_query(\"SELECT email FROM banco_emails WHERE 'email' = '$email'\");\n    if(mysql_num_rows($query) == 1) { // if return 1, email exist.\n    echo '1';\n    } else {\n// Insert data into mysql\n$sql=\"INSERT INTO $tbl_name(email) VALUES ('\". $email . \"')\";\n$result=mysql_query($sql);\necho '&lt;p class=\"message\"&gt;Thanks for registering. Our bar is getting crowded!&lt;/p&gt;';\n</code></pre>\n\n<p>The problem is that the ajax code does not show the error message, only the message \"Please wait ...\" and nothing happens, i don't know why...</p>\n\n<p>Sorry for my bad english.</p>\n\n<p>Thanks in advanced!</p>\n\n<hr>\n\n<p>Problem solved, the problem was in the php code, I did it and it worked!</p>\n\n<pre><code>    $query = mysql_query(\"SELECT email FROM banco_emails WHERE email = '$email' LIMIT 1\");\n\n    $email_check = mysql_num_rows($query);\n     if ($email_check &gt; 0) {\n    echo '1';\n    } else if ($email_check == 0) {\n// Insert data into mysql\n$sql=\"INSERT INTO $tbl_name(email) VALUES ('\". $email . \"')\";\n$result=mysql_query($sql);\necho '&lt;p class=\"message\"&gt;Thanks for registering. Our bar is getting crowded!&lt;/p&gt;';\n</code></pre>\n"},{"tags":["mysql","django","query","django-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12989767,"title":"Django query based on foreign key relationship","body":"<p>I have two models, a Project and an Action:</p>\n\n<pre><code>class Project(models.Model):\n    name = models.CharField(\"Project Name\", max_length=200, unique = True)\n\nclass Action(models.Model):\n    name = models.CharField(\"Action Name\", max_length=200)\n    project = models.ForeignKey(Project, blank=True, null=True, verbose_name=\"Project\")\n    notes = models.TextField(\"Notes\", blank=True)\n    complete = models.BooleanField(default=False, verbose_name=\"Complete?\")\n    status = models.IntegerField(\"Action Status\", choices = STATUS, default=0)\n</code></pre>\n\n<p>I need a query that returns all the Projects for which there are no actions with status &lt; 2.</p>\n\n<p>I tried:</p>\n\n<pre><code>Project.objects.filter(action__status__gt = 1)\n</code></pre>\n\n<p>But this returns all the Projects because in each Project, there are some actions with status 2 and some actions with status less than 2.  Also, it repeated Projects in the resulting query.  My current solution is below:</p>\n\n<pre><code>Project.objects.filter(action__status__gt =1).exclude(action__status__lt =2).annotate()\n</code></pre>\n\n<p>This collapses the repeating results and shows only actions with action statuses greater than 1.  But is this the correct way to construct such a query?  What if I wanted to return Projects with actions statuses greater than 1 OR Projects with no actions?</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":41,"score":1,"question_id":12993179,"title":"SQL query of relationship between two items from the same table","body":"<p>I have 3 tables in sqlite, the first one is about an entity I call bar:</p>\n\n<pre><code>bar\n    *id\n    -name\n</code></pre>\n\n<p>and the other one keeps a relationship between two bars, I call this relationship foo:</p>\n\n<pre><code>foo\n    *id\n    -bar_one (fk-&gt;bar)\n    -bar_two (fk-&gt;bar)\n    -baz (fk-&gt;baz)\n</code></pre>\n\n<p>baz holds an attribute that qualifies the KIND relationship that foo represents:</p>\n\n<pre><code>baz\n    *id\n    -description\n</code></pre>\n\n<p>I need to show a query of foo that substitutes the foreign keys with the values of bar an baz, something like:</p>\n\n<pre><code>id    bar_one    bar_two    baz\n1     bar1       bar2       siblings\n2     bar2       bar3       acquaintances\n3     bar3       bar4       enemies\n</code></pre>\n\n<p>I'm not a specialist in DBs as you can see, I tried with a join and it works with foo and baz.</p>\n\n<pre><code>SELECT foo.id, baz.description FROM foo, baz WHERE foo.baz = baz.id;\n</code></pre>\n\n<p>But to show the two members of bar is difficult for me in this way. Some advice?</p>\n"},{"tags":["mysql","query","data","posts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12993040,"title":"trying to write Mysql query for my database","body":"<p>Here is a image on my database <a href=\"http://oi46.tinypic.com/2eb5lpw.jpg\" rel=\"nofollow\">http://oi46.tinypic.com/2eb5lpw.jpg</a></p>\n\n<p><img src=\"http://i.stack.imgur.com/OYT6T.png\" alt=\"enter image description here\"></p>\n\n<p>,  i wonder if it possible to get posts from \"Meals\" by restID? </p>\n"},{"tags":["php","mysql","query","duplicates"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12992456,"title":"mysql query returning more than one value - should return one","body":"<p>I have a website where visitors can create \"battles\" and upload videos to compete in these battles.</p>\n\n<p>The following mySQL query is trying to retrieve details of every \"battle\" in a database. </p>\n\n<p>The problem I have is that if a \"battle creator\" has uploaded two \"videos\" to the same battle, a duplicate battle prints out.</p>\n\n<p>How can I make the query only print out one value for each battle, even if the videos table has two entries under the same battle_id?  </p>\n\n<p>Thanks!</p>\n\n<pre><code>SELECT * from Battles, Player, Video \nWHERE (Battles.battle_creator = Player.player_id \nAND Battles.battle_id = Video.battle_id \nAND Video.player_id = Battles.battle_creator) \nORDER BY Battles.battle_date DESC;\n</code></pre>\n"},{"tags":["sql-server","query","code-efficiency"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12988372,"title":"How can I make this query more efficient by reducing index seeks?","body":"<p>I have a function which I want to be more efficient. I know that most of the cost is in seeking index. I want to know if there is a way to merge these two index seeks into one.</p>\n\n<p>Here is my function</p>\n\n<pre><code>ALTER FUNCTION [dbo].[Search]\n(\n    @Query nvarchar(150)        \n)\nRETURNS @result TABLE \n(\n    ID int,\n    ResultPhrase nvarchar(max),\n    Domain nvarchar(50)\n)\nAS\n\nBEGIN\n\ndeclare  @id int,\n         @OffsetArticle nvarchar(50),\n         @OffsetProfile nvarchar(50),\n         @index int,\n         @domain nvarchar(50),\n         @StringResult nvarchar(max),\n         @substrIndex int,\n         @substrCount int,\n         @field nvarchar(40),\n         @begin int,\n         @end int\n\n        DECLARE pidCursor CURSOR FAST_FORWARD\n        FOR select id,OffsetArticle,OffsetProfile from PerfTest where contains (data,@Query)\n\n        open pidCursor\n        FETCH NEXT FROM pidCursor INTO @id,@OffsetArticle,@OffsetProfile\n\n        while (@@FETCH_STATUS = 0)\n        begin\n\n        select @index = CHARINDEX(@Query,data) from PerfTest where ID=@id\n\n        exec @domain =  dbo.FindDomain @id=@id ,@index=@index, @offsetArticle=@OffsetArticle, @offsetProfile=@OffsetProfile\n\n\n        if(@domain = N'Profile')\n            set @end = SUBSTRING(@offsetProfile,CHARINDEX(N'-',@offsetProfile)+1,len(@offsetProfile)-CHARINDEX(N'-',@offsetProfile))\n            set @begin = SUBSTRING(@offsetProfile,1,CHARINDEX(N'-',@offsetProfile)-1)\n\n        if(@domain = N'Article')\n            set @end = SUBSTRING(@OffsetArticle,CHARINDEX(N'-',@OffsetArticle)+1,len(@OffsetArticle)-CHARINDEX(N'-',@OffsetArticle))\n            set @begin = SUBSTRING(@OffsetArticle,1,CHARINDEX(N'-',@OffsetArticle)-1)\n\n\n\n        if(@index - 20 &lt; CAST(@begin as int))\n            set @substrIndex = @index\n        else\n            set @substrIndex = @index - 20\n\n        if(@index + 150 &gt; CAST(@end as int))\n            set @substrCount = @end\n        else\n            set @substrCount = @index + 150 \n\n\n        select @StringResult = SUBSTRING(data,@substrIndex,@substrCount) from PerfTest where ID=@id\n\n        insert @result (id,ResultPhrase,Domain) values (@id,@StringResult,@domain)\n\n\n        if(@@FETCH_STATUS = 0)\n            FETCH NEXT FROM pidCursor INTO @id,@OffsetArticle,@OffsetProfile\n\n        end\n        CLOSE pidCursor\n        DEALlOCATE pidCursor\n\nRETURN      \nEND\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":204,"score":1,"question_id":8228284,"title":"make sql subqueries stop complaining about duplicate columns","body":"<p>so suppose I have this query</p>\n\n<pre><code>SELECT COUNT(*) FROM (SELECT * FROM k JOIN j ON k.id = j.aid) k \n</code></pre>\n\n<p>suppose k and j have two columns with the same name, this entire query will complain with the duplicate columns error....</p>\n\n<p>while simply executing <code>SELECT * FROM k JOIN j ON k.id = j.aid</code> will execute just fine despite the duplicate columns....</p>\n\n<p>I know that you can use USING in the subquery to specify which column to use in case of duplicates, but is there a way to specify the query so that it'll automatically pic a specific column (whether randomly or using whatever rule) to use in case of duplicates without me having to manually specify them? </p>\n\n<p>ie do this without modifying the subquery (SELECT * FROM k etc) and only modify the superquery (SELECT COUNT(*) FROM...) and make it as abstract as possible so that it'll work regardless of what the subquery is</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":184,"score":0,"question_id":8237282,"title":"SQL_CALC_FOUND_ROWS not working","body":"<p>so I execute query: </p>\n\n<pre><code>SELECT SQL_CALC_FOUND_ROWS * FROM table l LIMIT 10, 20;\n</code></pre>\n\n<p>which returns 20 rows from table, and there are a total 553 rows in the table</p>\n\n<p>Then i immediately execute <code>SELECT FOUND_ROWS();</code></p>\n\n<p>But this instead only returns the number 1, despite the fact that there are 553 rows in my table (it's supposed to return 553, am I correct?)</p>\n\n<p>what did I do wrong? </p>\n"},{"tags":["php","mysql","query","insert"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":12990917,"title":"Why doesn't my query succeed? (PHP MySQL)","body":"<p>there is something wrong with my query but I have no idea what the problem is.</p>\n\n<p>Here are my queries:</p>\n\n<pre><code>$result=mysql_query(\"UPDATE user_info SET Money = '$newmoney' WHERE Username ='$user'\"); \n\n$result=mysql_query(\"INSERT INTO order (username, amount, stock, company) VALUES \n('$user','$amount','$stock','$symbol')\");\n</code></pre>\n\n<p>When I run it the first query works, but the second doesn't. There are now errors given.\nAny help would be great, thank you.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12990849,"title":"query multiple rows in mysql as variable","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/811153/php-simple-way-to-read-single-record-from-mysql\">PHP - Simple way to read single record from MySQL</a>  </p>\n</blockquote>\n\n\n\n<p>I want to query multiple rows in mysql as variable. for example:</p>\n\n<pre><code>SELECT name, tid FROM term_data WHERE vid = 2\n</code></pre>\n\n<p>this is the result:</p>\n\n<pre><code>name | tid\n-----|----\nJack | 55\nTony | 87\nJohn | 32\n</code></pre>\n\n<p>then I want to use while:</p>\n\n<pre><code>while (...) {\n\nprint \"My name is: $name and my ID is: $tid\";\n//name and tid should be printed from database. \n\n}\n</code></pre>\n\n<p>I can query one row and put it in a <code>while</code> but How is this possible?</p>\n\n<p><img src=\"http://i.stack.imgur.com/5F5Nl.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":73,"score":-1,"question_id":12990301,"title":"sql query to count rows that are not null","body":"<p>How do I construct an SQL query that does the following</p>\n\n<pre><code>Return the number of fields (or columns) in a table that start with \"xyz_\" \nand whose value is not null\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":43,"score":-2,"question_id":12990347,"title":"SQL query according to submit form","body":"<p>I want to query the database according to the input of the amount deposited. In the database the bank minimal amounts are stored. So the query consists in showing all banks with min_amount\n\n<p>The amount is defined $amount, and the row containing the minimum amounts is minimum. So i have done it like this but it tells me: Undefined index for $amount. ???</p>\n\n<pre><code> &lt;form name=\"test\" method=\"get\" action=\"this.php\"&gt;\n    Amount: &lt;input name=\"amount\"/&gt;\n    &lt;input type=\"submit\"/&gt;\n    &lt;/form&gt;\n\n    &lt;?php\n        $amount = $_GET[\"amount\"];\n\n        $result = mysql_query(\"SELECT * FROM list1 WHERE minimum &lt;= '$amount'\");\n\n        while($row = mysql_fetch_array($result))\n          {\n          echo $row['bank_name'] . \" - \" . $row['Tariff'];\n          echo \"&lt;br /&gt;\";\n          }\n        ?&gt;\n</code></pre>\n"},{"tags":["php","mysql","arrays","query","metadata"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2827,"score":0,"question_id":4729322,"title":"Selecting MySql table data into an array","body":"<p>I try to catch data from mysql to put them all in array.\nSuppose:</p>\n\n<pre><code>    users table\n    -----------------------\n    id| name | code \n    ----------------------\n    1| gorge | 2132\n    2| flix | ksd02\n    3| jasmen | skaod2\n\n    $sql = mysql_query(\"select id, name, code from users\");\n    $userinfo = array()\n    while($row_user = mysql_fetch_array($sql)){\n    $userinfo = $row_user[name] \n    }\n-------------------------\nforeach($userinfo as $usinfo){\necho $usinfo.\"&lt;br/&gt;\";\n}\n</code></pre>\n\n<p>Here is the problem i can only insert user name but cant insert also code &amp; id in userinfo array please help me to insert all data in same array.</p>\n\n<p>[P.S] No object oriented please.</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12989927,"title":"SQL query where value smaller than number","body":"<p>Ok i need to select from database banks wich have the minimum &lt;= 50 and than show the names of the banks and their tarifs. I did it like this but it doesn't work.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM list1 WHERE minimum &lt;= 50]\");\n\nwhile($row = mysql_fetch_array($result))\n  {\n  echo $row['bank_name'] . \" - \" . $row['Tarif'];\n  echo \"&lt;br /&gt;\";\n  }\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12989747,"title":"SQL query, by comparing values","body":"<p>I have a form where you have to input the ammount to deposit (number), and a mysql table where it has a list of banks with the minimal ammount of deposit (like first row = <code>name</code>, second row = <code>minimal amount</code>). </p>\n\n<p>The question is: <strong>How can i query the database in order to show me the banks which are right for me according to minimal deposit value?</strong> So example you want to deposit 50$, but not all banks allow you this as some of them have 100$ minimal deposit, so i want to show only those that have min.deposit below my amount.</p>\n"},{"tags":["sql","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12986371,"title":"Oracle - merge rows into 1 from the output","body":"<p>When I run the following query:</p>\n\n<p><code>SELECT  datetime_up, logic_id,eqp_name,ack, created FROM NAS_db.main\nWHERE TRUNC(datetime_up,'DD') &gt;= TO_TIMESTAMP ('04/18/2012', 'MM/DD/YYYY') and\nTRUNC(datetime_up,'DD') &lt;= TO_TIMESTAMP ('04/21/2012', 'MM/DD/YYYY') AND eqp_name ='Router-A'\nGROUP BY datetime_up,eqp_name, logic_id,ack,created</code></p>\n\n<p>I get the following output:</p>\n\n<pre><code>datetime_up             logic_id    eqp_name      ack   created\n4/19/2012 5:52:04 PM    IP_1.1.1.1_ Router-A       1       0\n\n4/19/2012 5:52:04 PM    IP_1.1.1.1_ Router-A       0       0\n</code></pre>\n\n<p>Ok, Those are consecutive records, I need to... in the cases like this , that the first record has a 1, to take only that one, instead of 2.</p>\n\n<p>I mean, if I query and I have 1000 records showing a 1 after the RouterA, I will need to take only one, and avoid the other one, if they are only 0s, the same, only take one, so I would like to have my query to show this.</p>\n\n<pre><code>4/19/2012 5:52:04 PM    IP_1.1.1.1_ Router-A       1       0\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","xml","query","tsql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":83,"score":0,"question_id":12985491,"title":"SQL Server Query for getting column names of all tables as XML","body":"<p>In my database, I intend to get the - [TableName] as the first column and all columns of that table in a \", \" (comma followed by space - delimiter...as the second column--for all tables in the DB.</p>\n\n<pre><code>Table A | ColumnA1, ColumnA2, ColumnA3  \nTable B | ColumnB1, ColumnB2, ColumnB3\n......................................\n</code></pre>\n\n<p>And retrieve it as an XML</p>\n\n<pre><code>&lt;TableList&gt;  \n&lt;TableName&gt;TableA&lt;/TableName&gt; &lt;Columns&gt; ColumnA1, ColumnA2, ColumnA3&lt;/Columns&gt;  \n&lt;TableName&gt;TableB&lt;/TableName&gt; &lt;Columns&gt; ColumnB1, ColumnB2, ColumnB3&lt;/Columns&gt;  \n&lt;/TableList&gt;\n</code></pre>\n\n<p>How should the SQL Query be written?</p>\n"},{"tags":["java","mysql","query","callable-statement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12983359,"title":"how to get detail from a prepareCall when it gets a row of an array","body":"<p>I have a program that connects to Db, using prepareCall. there is a function that browse some element from Db.  this is part of this function:</p>\n\n<pre><code>Resource f = new Resource();\n        if (rs.next()) {\n            f.setAreaSrl(rs.getInt(1));\n            f.setAreaId(rs.getInt(2));\n            f.setAreaName(rs.getString(3));\n            f.setCenterX(rs.getFloat(4));\n            f.setCenterY(rs.getFloat(5));\n            f.setCenterZ(rs.getFloat(6));\n\n        }\n        return f;\n    } catch (SQLException e) {\n        JOptionPane.showMessageDialog(null, \"problem in accessing DB\");\n        e.printStackTrace();\n        return null;\n    }\n</code></pre>\n\n<p>and I have the folloing code in java: </p>\n\n<pre><code>Resource mzone = new Resource();\n          mzone.getOneEntityBase(\"areasrl=i\");\n</code></pre>\n\n<p>that will give me a row of table. how can i access to them, element by element? </p>\n\n<p>I want to do some calculation by this numbers, so i need to have them separately. </p>\n\n<p>I have found some way to do it, but it doesn't work. </p>\n\n<pre><code>Resource mzone = new ResourceAreaZone();\n          mzone.getOneEntityBase(\"areasrl=1\");\n          String name = mzone.getAreaName();              \n          centerX = (int) mzone.getCenterX();\n</code></pre>\n"},{"tags":["excel","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":2286382,"title":"Write Queries on Excel sheet in c#","body":"<p>I want to update specific row of excel sheet from my asp.net application. I m able to read excel, but how can i update the records.Can i write Update query . How . please send me code:</p>\n\n<pre><code>        string strQuery = \"UPDATE [Sheet1$]  SET Child Name=\" + \"\\\"\" + strDataToUpdate[0] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Point Name=\" + \"\\\"\" + strDataToUpdate[1] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Bus No=\" + \"\\\"\" + strDataToUpdate[2] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Bus Time=\" + \"\\\"\" + strDataToUpdate[3] + \"\\\",\";\n        strQuery = strQuery + \"Drop Down Point Name=\" + \"\\\"\" + strDataToUpdate[4] + \"\\\",\";\n        strQuery = strQuery + \"Drop Bus No=\" + \"\\\"\" + strDataToUpdate[5] + \"\\\",\";\n        strQuery = strQuery + \"Drop Down Bus Time=\" + \"\\\"\" + strDataToUpdate[6] + \"\\\",\";\n        strQuery = strQuery + \"Parent Name=\" + \"\\\"\" + strDataToUpdate[7] + \"\\\",\";\n        strQuery = strQuery + \"Mobile 1=\" + \"\\\"\" + strDataToUpdate[8] + \"\\\",\";\n        strQuery = strQuery + \"Mobile 2=\" + \"\\\"\" + strDataToUpdate[9] + \"\\\",\";\n        strQuery = strQuery + \"Email ID 1=\" + \"\\\"\" + strDataToUpdate[10] + \"\\\",\";\n        strQuery = strQuery + \"Email ID 2=\" + \"\\\"\" + strDataToUpdate[11] + \"\\\",\";\n        strQuery = strQuery + \"Service Mode=\" + \"\\\"\" + strDataToUpdate[12] + \"\\\",\";\n        strQuery = strQuery + \"WHERE Child Id=\" + strDataToUpdate[13];\n</code></pre>\n\n<p>This Query i am using giving Syntax error.Please guide</p>\n"},{"tags":["php","mysql","sql","wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12984692,"title":"MySQL: Help changing the column names in this query","body":"<p>I'm getting the wrong kind of column names from this query ... for example, I'm getting the column name <code>meta_value</code> for the \"resource_email\" and the \"resource_phone\" cells... they both have the column name of <code>meta_value</code></p>\n\n<pre><code>SET @centerLat = '48.428289';\nSET @centerLng = '-123.380585';\n\nSELECT wp_posts.*, resource_email.meta_value, resource_phone.meta_value,\n( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat.meta_value ) ) * cos( radians( lng.meta_value ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat.meta_value ) ) ) ) AS distance\n\nFROM wp_posts\n\nLEFT JOIN wp_postmeta AS lat \n    ON lat.post_id = wp_posts.id \n        AND lat.meta_key = 'bid_resource_lat'\n\nLEFT JOIN wp_postmeta AS lng \n    ON lng.post_id = wp_posts.id \n        AND lng.meta_key = 'bid_resource_lng'\n\nLEFT JOIN wp_postmeta AS resource_email \n    ON resource_email.post_id = wp_posts.id \n        AND resource_email.meta_key = 'bid_resource_primary_email'\n\nLEFT JOIN wp_postmeta AS resource_phone \n    ON resource_phone.post_id = wp_posts.id \n        AND resource_phone.meta_key = 'bid_resource_primary_phone'\n\nHAVING distance &lt; 5\nLIMIT 0 , 20\n</code></pre>\n\n<p>Not sure how I need to change this query in order to get the column names I really need.</p>\n"},{"tags":["python","query","cursor"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":12984607,"title":"Python MySQLdb failing to insert","body":"<p>I'm trying</p>\n\n<pre><code>title = \"Title here\"\nurl = \"http://www.mysite.com/url-goes-here\"\n\ncursor.execute(\"\"\"INSERT INTO `videos_justicevids` (`title`, `pageurl`) VALUES (%s, %s)\"\"\",(title, url))\n</code></pre>\n\n<p>I'm not getting an error, but it's not inserting into the database.</p>\n"},{"tags":["sql","sql-server-2008","query","sum","select-case"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12984396,"title":"SQL Sum with conditions in a select case","body":"<p>have the following sql query</p>\n\n<pre><code>select catalogid\n   , sum(numitems) numitems\n   , sum(allitems) - sum(numitems) ignoreditems\nfrom\n(\n   select i.catalogid\n      , case\n           when (ocardtype in ('PayPal','Sofort') OR\n                   ocardtype in ('mastercard','visa') and\n                   odate is not null)\n              AND NOT EXISTS\n              (\n                 select *\n                 FROM bookedordersids b\n                 where b.booked = o.orderid\n              )\n           then numitems\n           else 0\n        end AS numitems\n      , numitems AS allitems\n   from orders AS o\n   join oitems AS i on i.orderid = o.orderid\n) AS X\ngroup by catalogid\n</code></pre>\n\n<p>now i've 2 tables Here\norders and oitems table</p>\n\n<p>the query sums the <code>numitems</code> and <code>ignoreditems</code> based on the conditions you see, now what if i want to find the sum only when the value of a column called <code>oprocessed</code> in <code>oitems</code> table is <code>0</code> ,</p>\n\n<p>do i add the following before <code>X</code></p>\n\n<pre><code>where oprocessed=0\n</code></pre>\n\n<p>or should i add a condition to the SELECT CASE?</p>\n"},{"tags":["php","mysql","sql","wordpress","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12984021,"title":"MySQL: Searching one simple table, but combining the WordPress 'wp_usermeta' table with meta_key/meta_value","body":"<p>As I mention in the title, I'm doing a request for latitude and longitude within a 'bid_userloc' table ... but I need to combine information from the 'wp_usermeta' table ...</p>\n\n<pre><code>SET @centerLat = '48.531157';\nSET @centerLng = '-123.782959';\n\nSELECT *, ( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat ) ) ) ) AS distance FROM bid_userloc HAVING distance &lt; 25 ORDER BY distance LIMIT 0 , 20\n</code></pre>\n\n<p>And using the <code>user_id</code> that comes in from the <code>SELECT *</code>, I need to get some user data from the <code>wp_userdata</code> table that looks like this:</p>\n\n<pre><code>id\nmeta_key\nmeta_value\n</code></pre>\n\n<p>For example, I need the <code>meta_value</code> of <code>meta_key</code> \"nickname\" ... as well as a number of others, but once I see how it's done for one, I can add more.</p>\n\n<p>I really appreciate it!</p>\n"},{"tags":["mysql","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12984231,"title":"MySql Query: Total Average for multiple tables","body":"<p>I want to calculate the overall average GPA for all of the students in one of the departments, this is what I came up with but it does it not work</p>\n\n<pre><code>COLUMN AVERAGE FORMAT 0.999  \nSELECT  AVG(GPA) \"AVERAGE\"  \nFROM    STUDENT  \nWHERE   (YEAR &lt; 4) AND \n        (MAJOR LIKE '%ACCT%') AND \n        (MAJOR LIKE '%FINA%') AND \n        (MAJOR LIKE '%MGMT%') AND \n        (MAJOR LIKE '%AISY%') AND \n        (MAJOR LIKE '%MINS%') AND \n        (MAJOR LIKE '%SCMS%');  \n</code></pre>\n\n<p>so they should be both undergraduates and be enrolled in one of those majors.</p>\n\n<p>Also as an additional question: is it possible to write such a query using \"GROUP BY ### and HAVING ###) ? how?</p>\n"},{"tags":["sql","tsql","query","sql-server-2000"],"answer_count":14,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":24301,"score":7,"question_id":982932,"title":"SQL query to return one single record for each unique value in a column","body":"<p>I have a table in SQL Server 2000 that I am trying to query in a specific way.  The best way to show this is with example data.</p>\n\n<p>Behold, <code>[Addresses]</code>:</p>\n\n<pre><code>Name         Street                 City          State\n--------------------------------------------------------\nBob          123 Fake Street        Peoria        IL\nBob          234 Other Street       Fargo         ND\nJim          345 Main Street        St Louis      MO\n</code></pre>\n\n<p>This is actually a simplified example of the structure of the actual table.  The structure of the table is completely beyond my control.  I need a query that will return a single address per name.  It doesn't matter which address, just that there is only one.  The result could be this:</p>\n\n<pre><code>Name         Street                 City          State\n--------------------------------------------------------\nBob          123 Fake Street        Peoria        IL\nJim          345 Main Street        St Louis      MO\n</code></pre>\n\n<p>I found a similar question <a href=\"http://stackoverflow.com/questions/715804/query-to-return-1-instance-of-a-record-with-duplicates\">here</a>, but none of the solutions given work in my case because I do not have access to <code>CROSS APPLY</code>, and calling <code>MIN()</code> on each column will mix different addresses together, and although I don't care which record is returned, it must be one intact row, not a mix of different rows.</p>\n\n<p>Recommendations to change the table structure will not help me.  I agree that this table is terrible, (it's worse than shown here) but this is part of a major ERP database that I can not change.</p>\n\n<p>There are about 3000 records in this table.  There is no primary key.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["query","solr","dismax"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":12963979,"title":"Solr End User Query Translation","body":"<p>I am wondering if there is anyway to transform an end user query to a more complicated solr query based on some rules.</p>\n\n<p>For example, if the user types in 32\" television, then I want to use the dismax query parser to let solr take care of this user query string like below:</p>\n\n<pre><code>http://localhost:8983/solr/select/?q=32\" television&amp;defType=dismax\n</code></pre>\n\n<p>However, if the user types in \"televisions on sale\", then I want to do a regular search for token televisions and onsale flag is true like below:</p>\n\n<pre><code>http://localhost:8983/solr/select/?q=name:televisions AND isOnSale:true\n</code></pre>\n\n<p>Is this possible? Or must this logic require an advance search form where the user can clearly state in a checkbox that they only want on sale items.</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","mysql","query","class","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12983906,"title":"query mysql database from inside a class","body":"<p>I'm trying to run a query to a MySQL database from within a class and it's not working for some reason.  I have the class in a separate file which I'm linking to with the <code>require_once()</code> function.</p>\n\n<p>here's what the main .php file looks like:</p>\n\n<pre><code>&lt;?php\n  require_once(\"connect.php\");\n  require_once(\"theClass.php\");\n\n  $a = new theClass;\n  $a-&gt;runQuery();\n}\n</code></pre>\n\n<p>connect.php:</p>\n\n<pre><code>&lt;?php\n//connect to mySQL database\n$mysqli = new mysqli(\"host\", \"user\", \"password\", \"db\");\nif ($mysqli-&gt;connect_errno)\n{\n    echo \"&lt;br&gt;&lt;h1&gt;Failed to connect to MySQL: (\" . $mysqli-&gt;connect_errno . \") \" . $mysqli-&gt;connect_error . \"&lt;/h1&gt;&lt;br&gt;\";\n}\n</code></pre>\n\n<p>theClass.php:</p>\n\n<pre><code>&lt;?php\nrequire_once('connect.php');\n\nclass theClass\n{\n  //class variables and other functions here\n\n  function runQuery()\n  {\n    $query = \"SELECT col_1 FROM db.table\";\n    $stmt = $mysqli-&gt;prepare($query);\n    stmt-&gt;execute();\n    $stmt-&gt;bind_result($r);\n\n    while($stmt-&gt;fetch())\n    {\n      echo $r . \"&lt;br&gt;\";\n    }\n  }\n};\n</code></pre>\n\n<p>I've tried copying the class into the main .php file and it still doesn't work; however, I have used the exact same code( the query, prepare, execute, bind_result, and fetch part) in an external .php file as well as inside the main .php file and it has worked both times.  This leads me to believe that you're not able to run queries from inside a class or that there is a different way of going about doing so.  Could anyone point me in the right direction? </p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","query","performance"],"answer_count":10,"favorite_count":1,"up_vote_count":11,"down_vote_count":1,"view_count":1271,"score":10,"question_id":561900,"title":"How many MySQL queries should I limit myself to on a page? PHP / MySQL","body":"<p>Okay, so I'm sure plenty of you have built crazy database intensive pages...  </p>\n\n<p>I am building a page that I'd like to pull all sorts of unrelated database information from.  Here are some sample different queries for this one page:</p>\n\n<ul>\n<li>article content and info</li>\n<li>IF the author is a registered user, their info</li>\n<li>UPDATE the article's view counter</li>\n<li>retrieve comments on the article</li>\n<li>retrieve information for the authors of the comments</li>\n<li>if the reader of the article is signed in, query for info on them</li>\n<li>etc...</li>\n</ul>\n\n<p>I know these are basically going to be pretty lightning quick, and that I could combine some; but I wanted to make sure that this isn't abnormal?</p>\n\n<p>How many fairly normal and un-heavy queries would you limit yourself to on a page?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12983182,"title":"SQL: Get column where it contains 1 or another","body":"<p>This is an \"either or\" kind of query that I can't figure out the best way to approach</p>\n\n<p><code>SELECT id, serial_number FROM bid_tag WHERE active = 1 AND house_id = 0 OR house_id = 14</code></p>\n\n<p>So I need to get a house_id that is either <strong>0</strong> or a specific number of \"14\"</p>\n"},{"tags":["sql","query","jpa"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2543,"score":4,"question_id":6276122,"title":"Can I get the SQL string from a JPA query object?","body":"<p>May I know how can I get the sql from a JPA query? or let's say, convert the JPA query to a SQL string? Thank you very much!</p>\n"},{"tags":["sql","database","query","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12981408,"title":"implementing substitution variables in access 2007","body":"<p>is there a way i can use substitution variables in access 2007, i wrote a query that returns rows which have a word okeu in them but i want to use substitution variables so that i can retrieve any word i want and if the word i want is not there i want to pop a message saying <code>word not there</code>  its easier to do it in oracle sqlplus but how can i apply it in access using sql queries??any ideas,thanks in advance</p>\n\n<p>this is my sql i made in access</p>\n\n<pre><code>SELECT MENU.NAME_REC, MENU.C_REC, AUTO.C_GROUP\nFROM MENU, AUTO\nWHERE (((MENU.NAME_REC)=\"okeu\"));\n</code></pre>\n"},{"tags":["query","ms-access"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":10851,"score":2,"question_id":96661,"title":"How can I make MS Access Query Parameters Optional?","body":"<p>I have a query that I would like to filter in different ways at different times.  The way I have done this right now by placing parameters in the criteria field of the relevant query fields, however there are many cases in which I do not want to filter on a given field but only on the other fields.  Is there any way in which a wildcard of some sort can be passed to the criteria parameter so that I can bypass the filtering for that particular call of the query?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12980002,"title":"SELECT DISTINCT not doing what I would hope it would do","body":"<p>I am trying to bring back a list of properties. Properties can have many \"passes\". I want to bring back a list of unique properties but if they have multiple passes, I want the one with the largest pass_id. This is what I have so far:</p>\n\n<pre><code>select * from passes\ninner join properties on properties.prop_id = passes.prop_id\nwhere pass_id NOT IN (select pass_id from queue where user_id = 1)\n\n+---------+---------+---------+---------+------------------+--------------+-------+\n| pass_id | prop_id | user_id | prop_id | full_street_name | house_number | zip   |\n+---------+---------+---------+---------+------------------+--------------+-------+\n|      18 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |\n|      20 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |\n|      21 |      21 |       1 |      21 |  N KEELER AVE    |         6200 | 60646 |\n|      22 |      22 |       1 |      22 |  E CHESTNUT ST   |          111 | 60611 |\n+---------+---------+---------+---------+------------------+--------------+-------+\n</code></pre>\n\n<p>I want it to return only pass_id 21 and 22 since 18 and 20 are duplicate properties of 21. Thanks in advance.</p>\n"},{"tags":["query","google-fusion-tables"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":120,"score":2,"question_id":12972778,"title":"Fusion Tables numeric ID","body":"<p>I'm working on a multiple query with Fusion Table. Till yesterday I used numericID but today creating a new Table, FT shows no numeric ID in the about menu. I tried to change NUmeric ID with Ecrypted one, but it doesn't work. This is the page:</p>\n\n<p><a href=\"http://siti-torino.hostei.com/test/test_09_02.html\" rel=\"nofollow\">http://siti-torino.hostei.com/test/test_09_02.html</a> ( <code>numeric ID</code>)\n<a href=\"http://siti-torino.hostei.com/test/test_09_03.html\" rel=\"nofollow\">http://siti-torino.hostei.com/test/test_09_03.html</a> ( <code>Encrypted ID</code>)</p>\n\n<p>It's quite clear that the query works correctly (the counter show the right result), but the script can't update the map. So I suppose the problem is at line 94-95</p>\n\n<pre><code>searchTracks = new google.maps.FusionTablesLayer(fusionTableId, { query: searchStr});\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["oracle","query","clob"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":239,"score":1,"question_id":12980038,"title":"ORA-00932: inconsistent datatypes: expected - got CLOB","body":"<p>Considering  that <code>TEST_SCRIPT</code> is a <code>CLOB</code>  why when I run this simple query from SQL*PLUS on Oracle , I get the error:</p>\n\n<pre><code>ORA-00932: inconsistent datatypes: expected - got CLOB\n</code></pre>\n\n<p>I have been reading a lot of questions about the same error but none of those is running a direct query from SQLPLUS </p>\n\n<pre><code>    UPDATE IMS_TEST \n       SET TEST_Category  = 'just testing'  \n     WHERE TEST_SCRIPT    = 'something'\n       AND ID             = '10000239' \n</code></pre>\n\n<p>Full example:</p>\n\n<pre><code>SQL&gt; create table ims_test(\n  2  test_category varchar2(30),\n  3  test_script clob,\n  4  id varchar2(30)\n  5  );\n\nTable created.\n\nSQL&gt; insert into ims_test values ('test1','something','10000239');\n\n1 row created.\n\nSQL&gt; UPDATE IMS_TEST\n  2  SET TEST_Category  = 'just testing'\n  3  WHERE TEST_SCRIPT    = 'something'\n  4  AND ID             = '10000239';\nWHERE TEST_SCRIPT    = 'something'\n      *\nERROR at line 3:\nORA-00932: inconsistent datatypes: expected - got CLOB\n</code></pre>\n"},{"tags":["sql","oracle","query","select","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12979452,"title":"Transposing Non-Aggregate Fields in an Oracle SELECT","body":"<p>For a table structured as such:</p>\n\n<pre><code>\"Object Attribute\" Table - Links objects with all of their attributes and values;\nObject ID       Attribute ID    Attribute String Value  ...\n1337            123             Example Object Title\n1337            124             Example Object Type\n1337            125             Example Object Description\n1337            126             Example Object Author\n0001            123             (null)\n0001            124             SomeType\n0001            125             This is an example record\n0001            126             Jiman\n0002            123             Bar\n0002            124             BarType\n0002            125             This is another\n0002            126             Jiman\n</code></pre>\n\n<p>EDIT: Attribute ID's have the following mapping:</p>\n\n<pre><code>Attribute ID    Attribute Name\n123             Title\n124             Type\n125             Description\n126             Author\n</code></pre>\n\n<p>How would I compose an Oracle query that returns a transposed set of data, where the Title field is NULL?</p>\n\n<p>Example output:</p>\n\n<pre><code>ID      Title       Type        Description             Author\n0001    (null)      FooType     This is an example...   Jiman\n</code></pre>\n\n<p>Can PIVOT be used to transpose non-aggregate values (i.e., those string attributes)?</p>\n"},{"tags":["mysql","sql","database","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":12980075,"title":"Connecting table with multiple foreign keys in mysql","body":"<p>Hi I have a database table with the following information :</p>\n\n<pre><code>owner.primaryitowner, \nowner.secondaryitowner, \nowner.primarybusinessowner, \nowner.secondarybusinessowner\n</code></pre>\n\n<p>The issue, is the owners are only stored as emails. There is another table I normally inner join users on <code>users.username = owner.primaryitowner</code> to get <code>users.displayname</code> so the data reads correctly. The issue is I need to do this for all 4 columns, and when I can only figure out how to connect 1 column in a query. Thanks for the help</p>\n\n<p>PS I cannot change the database I am only a report writer.</p>\n\n<p>Thanks so much in advance</p>\n"},{"tags":["query","sharepoint","sorting","sql-order-by","caml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12935946,"title":"How can I sort items in a splistitemcollection?","body":"<p>I have a problem in sharepoint webpart.\nI have a custom list where in I have a column name order with type number.\nthen I created a webpart that display the list and sorted by the column order.</p>\n\n<p>I have this caml query<br/>\nstring test =<br/><code>&lt;Query&gt;</code> + <br/>\n                    &nbsp;&nbsp;   <code>&lt;OrderBy&gt;</code> + <br/>\n         &nbsp;           &nbsp;&nbsp;&nbsp;        <code>&lt;FieldRef Name='order0' Ascending='True' /&gt;</code> +<br/>\n                  &nbsp;&nbsp;     <code>&lt;/OrderBy&gt;</code> +<br/>\n             <code>&lt;/Query&gt;</code>;<br/></p>\n\n<p>my problem is when I loop like this sample</p>\n\n<p>foreach (SPListItem result in items)\n  {\n    .....\n }</p>\n\n<p>the result will always be like this:<br/>\n4 <br/>\n1<br/>\n2<br/>\n3<br/></p>\n\n<p>where I want to have like this:<br/>\n1<br/>\n2<br/>\n3<br/>\n4<br/></p>\n\n<p>Please I really need your help. I'm really new in sharepoint and I don't have a training for this.</p>\n\n<p>Thanks,<br/>\nGracela</p>\n"},{"tags":["php","sql","database","query","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12979722,"title":"The word Array is displayed instead of the database entry","body":"<p>I am trying to print selected product names from my database, however all i see is the word \"Array\" instead of the product name. It is displayed as many times as the number products it finds, and that number is correct, but it only shows \"Array\"...</p>\n\n<p>Here's my code:</p>\n\n<pre><code>public function lookup($product)\n    {\n\n        $camera = $this-&gt;db-&gt;query(\"SELECT name FROM products WHERE type = 'Camera' \");\n\n        $laptop = $this-&gt;db-&gt;query(\"SELECT name FROM products WHERE type = 'Laptop' \");\n\n\n        $data = array();\n\n        switch($product)\n        {\n            case 'camera' : \n            foreach ($camera-&gt;result() as $row)\n            {\n                $entry = array();\n                $entry['name'] = $row-&gt;name;\n                $data[] = $entry;\n            }\n            return $data; break;\n\n            case 'laptop' :\n            foreach ($laptop-&gt;result() as $row)\n            {\n                $entry = array();\n                $entry['name'] = $row-&gt;name;\n                $data[] = $entry;\n            }\n            return $data; break;\n\n        }   \n    }\n</code></pre>\n"},{"tags":["sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12979008,"title":"Utilizing SQL datepart to indentify consecutive periods of time","body":"<p>I have a stored procedure that works correctly, but don't understand the theory behind why it works. I'm indentifying a consecutive period of time by utilizing a datepart and dense rank (found solution through help elsewhere). </p>\n\n<pre><code>        select \n            c.bom\n            ,h.x\n            ,h.z\n            ,datepart(year, c.bom) * 12 + datepart(month, c.bom) -- this is returning a integer value for the year and month, allowing us to increment the number by one for each month\n            - dense_rank() over ( partition by h.x order by datepart(year, c.bom) * 12 + datepart(month, c.bom)) as grp -- this row does a dense rank and subtracts out the integer date and rank so that consecutive months (ie consecutive integers) are grouped as the same integer\n\n        from \n            #c c\n\n            inner join test.vw_info_h h\n            on h.effective_date &lt;= c.bom\n            and (h.expiration_date is null or h.expiration_date &gt; c.bom)\n</code></pre>\n\n<p>I understand in theory what is happening with the grouping functionality.</p>\n\n<p><strong>How does multiplying year * 12 + month work? Why do we multiply the year? What is happening in the backend?</strong></p>\n"},{"tags":["java","mysql","database","query","jdbc"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12963504,"title":"Preferred way to query a database multiple times?","body":"<p>When using JDBC in Java, the generally accepted method of querying a database is to acquire a connection, create a statement from that connection, and then execute a query from that statement.</p>\n\n<pre><code>// load driver\nConnection con = DriverManager.getConnection(..);\nStatement stmt = con.createStatement();\nResultSet result = stmt.executeQuery(\"SELECT..\");\n// ...\n</code></pre>\n\n<p>However, I am unsure of how to treat a second query to the same database.</p>\n\n<ol>\n<li><p>Can another query be executed safely on the same <code>Statement</code> object, or must another statement be created from the <code>Connection</code> object in order to execute another query?</p></li>\n<li><p>If the same <code>Statement</code> object can be used for multiple queries, what is the purpose of the <code>Statement</code> class (since it would then make more sense for a <code>Connection.executeQuery()</code> method to exist)?</p></li>\n</ol>\n"},{"tags":["visual-studio-2010","query","tfs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12976404,"title":"TFS 2010 Team query does not work","body":"<pre><code>AndOr   Field   Operator    Value\n    Team Project    =       @Project\nAnd Area Path       Under   MyProject \nAnd Iteration Path  Under   MyProject\\Iteration 5\nAnd Work Item Type  =       User Story\nOr  Work Item Type  =       Task\n</code></pre>\n\n<p>after I run the query, I see all the workitesm in the results.  I am looking only for the ones under MyProject\\Iteration 5 but I see everything under Iteration 4 , Iteration 3 , etc.</p>\n\n<p>The way I added my Iteration 5 was to go to Areas and Iterations and creating itttttt.  Any help is highly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":174,"score":2,"question_id":6399058,"title":"Order by polymorphic belongs_to attribute","body":"<p>How do I make an ActiveRecord query that orders by an attribute of a polymorphic belongs_to association?</p>\n\n<p>For example I have model called <code>Tagging</code> that has a polymorphic belongs_to association named <code>tagged_item</code>.</p>\n\n<p>Unfortunately <code>Tagging.joins(:tagged_item)</code> throws a <code>ActiveRecord::EagerLoadPolymorphicError</code>. So I can't do something like <code>Tagging.joins(:tagged_item).order(\"tagged_item.created_at DESC\")</code>.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["query","sharepoint","caml"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":115,"score":1,"question_id":12815623,"title":"CAML filter to get the current month from the list?","body":"<p>In SharePoint 2010, I need to get items from a list based on a condition. Considering one of the fields to be 'Date' of type DateTime, the condition is:</p>\n\n<p>Get Current Month Data.</p>\n\n<p>How do I filter the list items based on this condition using CAML Qurey?</p>\n\n<p>By,\nRaji</p>\n"},{"tags":["performance","oracle","query","database-design","data-warehouse"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12973618,"title":"Oracle explain plan over simple select performs multiple hash joins when multiple columns are indexed in a table","body":"<p>I am currently running into an issue with my Oracle instance.  I have two simple select statements:  </p>\n\n<pre><code>select * from dog_vets  \n</code></pre>\n\n<p>and  </p>\n\n<pre><code>select * from dog_statuses\n</code></pre>\n\n<p>and the following <a href=\"http://sqlfiddle.com/#!4/37754\" rel=\"nofollow\">fiddle</a></p>\n\n<p>My explain plan on <code>dog_vets</code> is as follows:  </p>\n\n<pre><code> 0 | Select Statement  \n 1 | Table Access Full Scan dog_vets\n</code></pre>\n\n<p>my explain plan on <code>dog_statuses</code>  is as follows:  </p>\n\n<pre><code>ID|Operation | Name | Rows |Bytes | cost | time    \n0 | Select Statement |  | 20G | 500M | 100000 | 999:99:17  \n1 | View  | index%_join_001 | 20G | 500M | 100000 | 999:99:17  \n2 | Hash Join  |  | | | |   \n3 | Hash Join  |  | | | |   \n4 | Index fast full scan dog_statuses_check_up  |  | 20G | 500M | 100000 | 32:15:00  \n5 | Index fast full scan dog_statuses_sick|  | 20G | 500M | 100000 | 35:19:00  \n</code></pre>\n\n<p>To get this type of output execute the following statement:  </p>\n\n<pre><code>explain plan for   \nselect * from dog_vets;\n</code></pre>\n\n<p>OR</p>\n\n<pre><code> explain plan for   \n    select * from dog_statuses;\n</code></pre>\n\n<p>and then  </p>\n\n<pre><code>select * from table(dbms_xplan.display);\n</code></pre>\n\n<p>Now my question is, why do multiple indexes imply a view (materialized  I assume) being created in my above statements and further what type of performance hit am I suffering on this type of query?  As it stands now <code>dog_vets</code> has ~300 million records and <code>dog_Statuses</code> has about 500 million.  I have yet to be able to get <code>select * from dog_statuses</code> to return in under 10 hours.  This is primarily because the query dies before it completes.  </p>\n\n<p><strong>DDL</strong>  </p>\n\n<p>In case sql fiddle dies:  </p>\n\n<pre><code>create table dog_vets\n(\n     name varchar2(50),\n     founded timestamp,\n     staff_count number\n  );\n\ncreate table dog_statuses\n(\n      check_up timestamp,\n      sick varchar2(1)\n  );\n\n\ncreate index dog_vet_name\non dog_vets(name);\n\ncreate index dog_status_check_up\non dog_statuses(check_up);\n\ncreate index dog_status_sick\non dog_statuses(sick);\n</code></pre>\n"},{"tags":["mysql","sql","query","subquery","ranking"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12976162,"title":"Ranking system using a complex query: more precise filters","body":"<p>To realize a ranking system on my gameserver, I store some information about each player in a MySQL database.\nI've got the following database tables.</p>\n\n<p>Table <code>players</code> with example data:</p>\n\n<pre><code>id | steamId | deaths\n---+---------+-------\n1  | asdja   | 2\n2  | kfjsl   | 5\n</code></pre>\n\n<p>Table <code>weapons</code> with example data:</p>\n\n<pre><code>playerId | weaponId | kills\n---------+----------+------\n1        | 5        | 8\n1        | 9        | 7\n2        | 3        | 3\n2        | 6        | 10\n2        | 7        | 2\n</code></pre>\n\n<p>You see that I do not store the kills for each player in the <code>players</code>-table, because I could simply calculate it from the <code>weapons</code>-table.\nI'm not very familiar with SQL queries, but I finished creating the following one to select a simple data set with following fields:</p>\n\n<pre><code>kills,\ndeaths,\nkill-death-rate (kdrate),\ncount (maximum number of players),\nrank (current ranking position, sorted by kills)\n</code></pre>\n\n<p>The query:</p>\n\n<pre><code>SELECT\n    SUM(weapons.kills) AS `kills`,\n    `deaths`,\n    (SUM(kills) / IF(deaths, deaths, 1)) AS `kdrate`,\n    (SELECT COUNT(*) FROM `players`) AS `count`,\n    (\n        SELECT\n            COUNT(*)\n        FROM\n            (\n                SELECT\n                    p.id AS id2,\n                    SUM(w.kills) AS kills2,\n                    p.deaths AS deaths2,\n                    p.steamId AS steamId2\n                FROM\n                    weapons AS w,\n                    players AS p\n                WHERE\n                    p.id = w.playerId\n                GROUP BY\n                    p.id\n            ) AS temp\n        WHERE\n            temp.kills2 &gt;= (\n                SELECT\n                    SUM(weapons.kills) AS `kills`\n                FROM\n                    `players`,\n                    `weapons`\n                WHERE\n                    players.id = weapons.playerId AND\n                    `id` = 1\n                GROUP BY\n                  `id`\n            )\n        ORDER BY\n            temp.kills2 DESC,\n            temp.deaths2 ASC,\n            temp.steamId2 ASC\n    ) AS `rank`\nFROM\n    `players`\nINNER JOIN\n    `weapons`\nON\n    players.id = weapons.playerId\nWHERE\n    `id` = 1\nGROUP BY\n    `id`\n</code></pre>\n\n<p>There are two problems:</p>\n\n<p>1.) The query is horrible.</p>\n\n<p>2.) Executing this query with the given example data results in \"the same rank\".\nI mean, both players get the same rank because I the amount of kills is the same on both players.\nBut instead, player 1 should be on rank 1 because he has less deaths than player 2.\nI don't know how I can realize this.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:\n@Manueru_mx gave me a basic idea of how to do it:\nI've got the following code based on his answer:</p>\n\n<pre><code>SELECT\n    id,\n    kills,\n    deaths,\n    kdrate,\n    COUNT(*) AS rank,\n    (SELECT COUNT(*) FROM players) AS `count`\nFROM\n    (\n        SELECT\n            pys.id AS id,\n            SUM(wps.kills) AS kills,\n            pys.deaths AS deaths,\n            (SUM(wps.kills) / pys.deaths) as kdrate\n        FROM\n            players pys\n        INNER JOIN\n            weapons wps\n        ON\n            pys.id = wps.playerid\n        GROUP BY\n            pys.id\n        ORDER BY\n            2 DESC,\n            3,\n            4 ASC\n    ) AS tmp\nWHERE\n    id = 1\n</code></pre>\n\n<p>The only problem left is, that the <code>rank</code> is 1 in both cases.</p>\n"},{"tags":["query","solr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12977389,"title":"How to filter query in solr by date?","body":"<p>In my SOLR there is date field(published_date) and values are in this format <em>\"2012-09-26T10:08:09.123Z\"</em></p>\n\n<p>How I can search by simple input like \"2012-09-10\" instead of full ISO date format.</p>\n\n<p>Is it possible in SOLR?I have tried with </p>\n\n<p><code>fq=[2012-09-24%20TO%20NOW]</code></p>\n\n<p>It should return by filtering results greater than published date 2012-09-24 and less than NOW.</p>\n\n<p>But it returns data with published date with 2012-09-23,like below</p>\n\n<pre><code>&lt;float name=\"score\"&gt;2.8183863&lt;/float&gt;\n&lt;str name=\"name\"&gt;Local Team Inspires Obama&lt;/str&gt;\n&lt;date name=\"published_date\"&gt;2012-09-23T07:44:53.123Z&lt;/date&gt;\n</code></pre>\n\n<p>Am I missing something?</p>\n\n<p>thanks in advance.</p>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12975454,"title":"SQL Server 2008: Finding strings within a table which contain the word World","body":"<p>I'm trying to filter my query to show only table entries with the word WORLD and also contains other country codes. </p>\n\n<p>I have used the wildcard function but I am unsure as to how I can have it only return entries with both WORLD and other country codes.</p>\n\n<pre><code>SELECT *\nFROM [****].[dbo].[Titles]\nWHERE Territories LIKE '%world%'\n</code></pre>\n\n<p>Any help is appreciated </p>\n\n<p>EDIT: Expected result would return all rows with both WORLD and one or more country code in the field. The territories column in this table contains both World or country codes and should bot contain both. the reason im running this query is to search for any rows with bad data.</p>\n"},{"tags":["php","mysql","query","function","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12966091,"title":"PHP pass variables to my own MySQL function--DB using variable as column name","body":"<p>This is sort of a follow up to my last question (http://stackoverflow.com/questions/12945119/mysql-function-add-prices-from-multiple-tables ) so the MySQL code is there.  My background with DBs is all SQL Server 2008 and Access, so the idiosyncrasies of MySQL are getting the better of me.  I've Googled my brains out, read every even vaguely relevant Q&amp;A on StackOverflow, StackExchange's programming and webdeveloper boards, etc.  (Had to get that disclaimer out of the way.)</p>\n\n<p>I ran the function in DreamCoder and when it just prompts me for intput and then runs the function, it returns the correct answer (a decimal,) so the function's logic is sound as far as I can tell. However, when I try to call the function from PHP, it errors out.</p>\n\n<p>The DB access code is as follows:</p>\n\n<pre><code>function getQuote($json)\n\necho(\"JSON input: \");\nvar_dump($json);\n\n    $array = json_decode($json, TRUE);\n    echo(\"JSON decoded array: \");\n    print_r($array);\n\n    $cheese = $array[0];\n    $meat = $array[1];\n    $veg = $array[2];   \n\n    $c = db_connect();\n    $query = \"SELECT calculatePrice($cheese, $meat, $veg)\";\n    var_dump($query);\n    $result  = mysql_query($query , $c);\n    if(!$result)\n    {\n        echo \"\\nCould not successfully run query ($query) from DB: \" . mysql_error();\n        exit;\n    }\n\nif (mysql_num_rows($result) == 0) {\n    echo \"No rows found, nothing to print so am exiting\";\n    exit;\n}\n\nwhile($row = mysql_fetch_assoc($result)){\n    echo(\"Row: \");\n    var_dump($row);\n\n    if(!$row)\n        die(\"No price returned!\" . var_dump($row));\n    else\n    {   \n        return json_encode($row);   \n    }\n}  //end while\n</code></pre>\n\n<p>And I wrote the following \"test harness\" to manually feed it data.  I know the JSON's going in right because the full code gives the same error verbatim, so the issues's either PHP or MySQL.</p>\n\n<pre><code>    &lt;?php\n        require_once 'DBUtils.php';\n\n    $array = array();\n    $array[] = \"Chedder\";\n    $array[] =\"Ham\";\n    $array[] =\"Carrot\";\n\n    $json = json_encode($array);\n    echo(\"JSON object:\");\n    var_dump($json);\n\n    $test = getQuote($json);\n\n        echo(\"Test: \");\n        print_r($test);\n\n    ?&gt;\n</code></pre>\n\n<p>I've also tried MySQLi, same deal, same error.  According to MySQL's documentation, scant as it is, I'm calling the function properly and passing the variables correctly.  (PHP's documentation on such is virtually non-existent; their examples all amount to \"SELECT * from tblFoo WHERE bar=4.\")</p>\n\n<p>The error is that it treats chedder as a column name rather than as the variable: \"Unknown column 'cheddar' in 'field list'\".  What am I missing?</p>\n\n<p>I could do this in SQLServer and ASP.NET without batting an eye, but MySQL/PHP is confusing the penguins out of me X_X  (Not Linux penguins, just the zoo kind.)</p>\n\n<p>PHP version is 5.3.17, MySQL is 5.1 in case either makes a difference.  I think PHP 5.4.* has some relevant methods, but before I go through the hassle of changing my PHP version, I'd rather exhaust any 5.3.* options first.</p>\n\n<p>I'm well-aware the answer is probably obvious, and know there's no one who'll outdo me for calling myself stupid once I learn what I'm doing.</p>\n\n<p>Thank you again!  This site is darned near my go-to before Google for questions ^_^  (And at least 2/3 of the results for any Google question I ask come from here anyway =-p )</p>\n\n<p>EDIT:\nOK the MySQL works alone (SELECT from etc...)  Turns out it wanted ' vs. `.</p>\n"},{"tags":["django","query","optimization","foreign-keys","generic-foreign-key"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":106,"score":2,"question_id":12466945,"title":"django: prefetch related objects of a GenericForeignKey","body":"<p>Suppose I have a model <code>Box</code> with a <code>GenericForeignKey</code> that points to either an <code>Apple</code> instance or a <code>Chocolate</code> instance. <code>Apple</code> and <code>Chocolate</code>, in turn, have ForeignKeys to <code>Farm</code> and <code>Factory</code>, respectively. I want to display a list of <code>Box</code>es, for which I need to access <code>Farm</code> and <code>Factory</code>. How do I do this in as few DB queries as possible?</p>\n\n<p>Minimal illustrative example:</p>\n\n<pre><code>class Farm(Model):\n    ...\n\nclass Apple(Model):\n    farm = ForeignKey(Farm)\n    ...\n\nclass Factory(Model):\n    ...\n\nclass Chocolate(Model):\n    factory = ForeignKey(Factory)\n    ...\n\nclass Box(Model)\n    content_type = ForeignKey(ContentType)\n    object_id = PositiveIntegerField()\n    content_object = GenericForeignKey('content_type', 'object_id')\n    ...\n\n    def __unicode__(self):\n        if self.content_type == ContentType.objects.get_for_model(Apple):\n            apple = self.content_object\n            return \"Apple {} from Farm {}\".format(apple, apple.farm)\n        elif self.content_type == ContentType.objects.get_for_model(Chocolate):\n            chocolate = self.content_object\n            return \"Chocolate {} from Factory {}\".format(chocolate, chocolate.factory)\n</code></pre>\n\n<p>Here are a few things I tried. In all these examples, <strong>N</strong> is the number of Boxes. The query count assumes that the <code>ContentType</code>s for <code>Apple</code> and <code>Chocolate</code> have already been cached, so the <code>get_for_model()</code> calls do not hit the DB.</p>\n\n<p>1) Naive:</p>\n\n<p><code>print [box for box in Box.objects.all()]</code></p>\n\n<p>This does <strong>1</strong> (fetch Boxes) + <strong>N</strong> (fetch Apple or Chocolate for each Box) + <strong>N</strong> (fetch Farm for each Apple and Factory for each Chocolate) queries.</p>\n\n<p>2) <code>select_related</code> doesn't help here, because <code>Box.content_object</code> is a <code>GenericForeignKey</code>.</p>\n\n<p>3) As of django 1.4, <code>prefetch_related</code> can fetch <code>GenericForeignKey</code>s.</p>\n\n<p><code>print [box for box in Box.objects.prefetch_related('content_object').all()]</code></p>\n\n<p>This does <strong>1</strong> (fetch Boxes) + <strong>2</strong> (fetch Apples and Chocolates for all Boxes) + <strong>N</strong> (fetch Farm for each Apple and Factory for each Chocolate) queries.</p>\n\n<p>4) Apparently <code>prefetch_related</code> isn't smart enough to follow ForeignKeys of GenericForeignKeys. If I try:</p>\n\n<p><code>print [box for box in Box.objects.prefetch_related(\n    'content_object__farm',\n    'content_object__factory').all()]</code></p>\n\n<p>it rightfully complains that <code>Chocolate</code> objects don't have a <code>farm</code> field, and vice versa.</p>\n\n<p>5) I could do:</p>\n\n<pre><code>apple_ctype = ContentType.objects.get_for_model(Apple)\nchocolate_ctype = ContentType.objects.get_for_model(Chocolate)\nboxes_with_apples = Box.objects.filter(content_type=apple_ctype).prefetch_related('content_object__farm')\nboxes_with_chocolates = Box.objects.filter(content_type=chocolate_ctype).prefetch_related('content_object__factory')\n</code></pre>\n\n<p>This does <strong>1</strong> (fetch Boxes) + <strong>2</strong> (fetch Apples and Chocolates for all Boxes) + <strong>2</strong> (fetch Farms for all Apples and Factories for all Chocolates) queries. The downside is that I have to merge and sort the two querysets (<code>boxes_with_apples</code>, <code>boxes_with_chocolates</code>) manually. In my real application, I'm displaying these Boxes in a paginated ModelAdmin. It's not obvious how to integrate this solution there. Maybe I could write a custom Paginator to do this caching transparently?</p>\n\n<p>6) I could cobble together something based on <a href=\"http://blog.roseman.org.uk/2010/02/22/django-patterns-part-4-forwards-generic-relations/\" rel=\"nofollow\">this</a> that also does O(1) queries. But I'd rather not mess with internals (<code>_content_object_cache</code>) if I can avoid it.</p>\n\n<p>In summary: <strong>Printing a Box requires access to the ForeignKeys of a GenericForeignKey. How can I print N Boxes in O(1) queries?</strong> Is (5) the best I can do, or is there a simpler solution?</p>\n\n<p>Bonus points: <strong>How would you refactor this DB schema to make such queries easier?</strong></p>\n"},{"tags":["mysql","forms","wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12975590,"title":"wordpress search form sql query","body":"<p>I am trying to build a custom search <code>form</code> that will query my <code>wordpress DB</code> for the results.\nThe problems I seem to encounter is that the form does not send anything to function upon action just says <code>404 not found</code>.</p>\n\n<p>The function to query the database is located at <code>functions/theme-search.php</code> and I have declared <code>function search_db</code> in it.</p>\n\n<p>Where am I going wrong?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12973700,"title":"Hibernate query date compare on year and month only","body":"<p>I need to grab some records from a table which has a Column <code>birthDate</code> which is a <code>Date</code>(without time). I need to filter records by comparing against year and month only. \nFor example I want all the users born on March of 1990. The day doesn't matter.</p>\n\n<p>How do you handle it?</p>\n"},{"tags":["php","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12972254,"title":"Best way to write a concatenating PHP MS SQL Query and put it into a loop","body":"<p>So normally I would write queries and loops like follows:</p>\n\n<pre><code>    $result = mssql_query(\"SELECT Element FROM Table WHERE Type='Type'\");\n\n                while ($row = mssql_fetch_array($result)) { \n}\n</code></pre>\n\n<p>I know it isn't best practice but I am still learning and it works. </p>\n\n<p>I used to concatenate my queries as follows:</p>\n\n<pre><code>$query = \"SELECT Element \";\n$query .= \"FROM Table \";\n$query .= \"WHERE Condition = 'no' \";\n\n$result = mssql_query($query);\n\n$numRows = mssql_num_rows($result);\n</code></pre>\n\n<p>This isn't very secure however I have written a SQL Encode but I digress. I now face the problem of having t write a very long query and loop it. I have written the following, however it doesn't work. Can someone tell me if my syntax is correct, so that I can debug if the problem lays with my syntax or another element. Any help would be greatly appreciated. </p>\n\n<pre><code> $query = \"INSERT INTO Items (BasketID, Qty, ProductType, Element1, Element2, Element3, Element4, Element5, Element6, Element7, Element8, Element9, Element10, Element11, Element12, Element13, Element14, Element15, Element16, Element17, Element18, Element19, Element20, DateAdded, Notes)\";\n$query .= \" VALUES (\"$_SESSION['basketid']\", \"1\", \"Type1\", \"SQLencode($_POST['Element1'])\", \"SQLencode($_POST['Element2'])\", \"SQLencode($_POST['Element3'])\", \"SQLencode($_POST['Element4'])\", \"SQLencode($_POST['Element5'])\", \"SQLencode($_POST['Element6'])\", \"SQLencode($_POST['Element7'])\",\";\n$query .= \"\"SQLencode($_POST['Element8'])\", \"SQLencode($_POST['Element9'])\", \"SQLencode($_POST['Element10'])\",\"SQLencode($_POST['Element11']\", \"SQLencode($_POST['Element12']\", \"SQLencode($_POST['Element13']\",\"SQLencode($_POST['Element14']\",\"SQLencode($_POST['Element15']\", \"SQLencode($_POST['Element16']\",\";\n$query .= \"\"SQLencode($_POST['Element17'])\",\"SQLencode($_POST['Element18'])\",\"SQLencode($_POST['Element19'])\", \"SQLencode($_POST['Element20'])\", \"NOW()\", \"SQLencode($_POST['Notes'])\" ) \"\n\n$insertsql = mssql_query($query);\n\nwhile ($insertrow = mssql_fetch_array($insertsql)) { \n\n\n?&gt;\n</code></pre>\n\n<p>I think/hope I am the right track, but I think my syntax for the actual query is slightly wrong somewhere but I can't quite figure out why, I keep getting unexpected t_variables. Can anyone point me where I am going wrong please?</p>\n"},{"tags":["mysql","database","query","function","mysql-workbench"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12969000,"title":"Identical MySQL query returning different result in MySQL Workbench than from command-line","body":"<p>This query `</p>\n\n<pre><code>delimiter $$\n\nCREATE DEFINER=`root`@`localhost` FUNCTION `calculatePrice`(cheese VARCHAR(50), meat VARCHAR(50), veg VARCHAR(50)) RETURNS decimal(10,0)\n    DETERMINISTIC\nBEGIN\nDECLARE price DECIMAL;\nSET price = (SELECT  SUM(x.Price) \n    FROM\n    (\n        SELECT `priceFactor` AS Price FROM `tblCheese` WHERE `cheeseName` = cheese\n        UNION ALL \n        SELECT `priceFactor` AS Price FROM `tblMeat` WHERE `meatName` = meat \n        UNION ALL \n        SELECT `priceFactor` AS Price FROM `tblVeggie` WHERE `veggieName` = veg\n    ) x );\nRETURN price;\nEND$$\n\n`\n</code></pre>\n\n<p>is returning the mathematically-correct answer when called from the MySQL command-line client, but incorrect for any other program or when called from PHP (it's returning 3 there, no matter what parameters are passed.)  See below:\n<img src=\"http://i.stack.imgur.com/hHcXs.png\" alt=\"Identical query, identical parameters, different results\"></p>\n\n<p>The calling statement, in case it's blurry, is SELECT calculatePrice('colby', 'sausage', 'black beans');</p>\n\n<p>I've never seen this weirdness before.  It's all going off of the same copy of MySQL, etc.</p>\n\n<p>Edit to add: phpMyAdmin also yields the correct answer to the query.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12971993,"title":"Working on friending system, need to have a way to add friend's id to WHERE query? Same column?","body":"<p>Ok this may be obvious but I am making a friending system but I need to have multiple possible userids for the userid column in my table <code>activity</code> but when i use the code below:</p>\n\n<pre><code>$q = $pdo-&gt;prepare(\"SELECT * FROM friends WHERE userid=:uid\");\n        $q-&gt;execute(array(\n            \":uid\"=&gt;$user['id'],\n        ));\n        if($q-&gt;rowCount()&gt;0){\n            $remainder =\"\";\n            foreach($q as $p){\n                $remainder .= \"OR `userid` =`\".$p['friendid'].\"`\";\n            }\n        }\n        $query = $pdo -&gt; prepare(\"SELECT * FROM `activity` WHERE `userid`=:id .$remainder. ORDER BY id DESC LIMIT 50\");\n        $query-&gt;execute(array(\n            \":id\"=&gt;$user['id']\n        ));\n</code></pre>\n\n<p>it in fact returns nothing when I <code>var_dump</code> the result. Whereas it should have the stream content of the user and all his/her friends.</p>\n\n<p>What have I done wrong here? I cannot seem to find the problem?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","mysql","query","date"],"answer_count":14,"favorite_count":12,"up_vote_count":24,"down_vote_count":0,"view_count":44373,"score":24,"question_id":510012,"title":"Get a list of dates between two dates","body":"<p>Using standard mysql functions is there a way to write a query that will return a list of days between two dates.</p>\n\n<p>eg given 2009-01-01 and 2009-01-13 it would return a one column table with the values:</p>\n\n<ul>\n<li>2009-01-01 </li>\n<li>2009-01-02 </li>\n<li>2009-01-03</li>\n<li>2009-01-04 </li>\n<li>2009-01-05</li>\n<li>2009-01-06</li>\n<li>2009-01-07</li>\n<li>2009-01-08 </li>\n<li>2009-01-09</li>\n<li>2009-01-10</li>\n<li>2009-01-11</li>\n<li>2009-01-12</li>\n<li>2009-01-13</li>\n</ul>\n\n<p>Edit: It appears I have not been clear. I want to GENERATE this list. I have values stored in the database (by datetime) but want them to be aggregated on a left outer join to a list of dates as above (I am expecting null from the right side of some of this join for some days and will handle this).</p>\n"},{"tags":["mysql","sql","query","group-by"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":12971455,"title":"Advances MySQL Group by","body":"<p>I have MySQL table that contains all messages from user to user:</p>\n\n<pre><code>id | to_id /*user_id*/ | from_id /*user_id*/\n 1 |  32               |  54\n 2 |  54               |  32\n 3 |  32               |  54\n</code></pre>\n\n<p>The goal is get MySQL answer like list of dialogs user_id - user_id ordered by date. But if i do sql query:</p>\n\n<pre><code>select * from messages group by to_id, from_id\n</code></pre>\n\n<p>i will get</p>\n\n<pre><code> to_id /*user_id*/ | from_id /*user_id*/\n  32               |  54\n  54               |  32\n</code></pre>\n\n<p>But first and second string is the same dialog. How can i group this records?</p>\n"},{"tags":["query","mongoid","has-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":225,"score":0,"question_id":11003179,"title":"How to select document with has_many relation with Mongoid","body":"<p>I know that my problem is the trivial one, but I need some help.</p>\n\n<p>I have two mongoid classes with <code>has_many</code> relation:</p>\n\n<pre><code>class Container\n    ...\n    has_many: items\n    ...\nend\n\nclass Item\n    ...\n    field :date, type =&gt; Date\n    belongs_to: container\n    ...\nend\n</code></pre>\n\n<p>I need all containers that have item at the particular date.</p>\n\n<p>Here is the scope that doesn't work as expected. It returns both, the containters that do have, and the containers that don't have items at the given date:</p>\n\n<pre><code>class Container\n    ...\n    scope :with_items_on, -&gt;(date){ where(:_id.in =&gt; Item.on(date).only(:container_id).distinct(:container_id)) }\n    ...\nend\n</code></pre>\n\n<p><code>.on(date)</code> is scope that returns correctly all Items for the given date.\nThanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12966848,"title":"getting the minimum and maximum date in the same query","body":"<p>I have a working query that gives me the maxdate:</p>\n\n<pre><code>SELECT a.client_id AS client_id\n   , a.patientcount AS patientcount\n   , received_date AS maxRecDate\nFROM\n(\n   SELECT DISTINCT CLIENT_ID\n   , PATIENT_ID\n   , count(*) over (partition by client_id, patient_id) AS patientcount\n   from f_accession_daily\n) AS a\nJOIN F_ACCESSION_DAILY AS f ON a.CLIENT_ID = f.CLIENT_ID\n   AND a.PATIENT_ID = f.PATIENT_ID\nGROUP BY f.RECEIVED_DATE, a.CLIENT_ID, a.patientcount\nHAVING f.RECEIVED_DATE = MAX(f.received_date)\n</code></pre>\n\n<p>In the same query I would also like to return min(f.received_date).</p>\n\n<p>Is there a way to do this? perhaps with the subquery?</p>\n"},{"tags":["mysql","performance","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12970402,"title":"Slow MySQL query with multiple sub-select joins","body":"<p>This has been bothering me all day:</p>\n\n<p>I have this query which works fine but is quite slow in some cases. The explain result tells me mysql is scanning 40000 rows 3 times. The query joins on approximatily similar sub-selects but there all a little different.</p>\n\n<p>How can I improve this?</p>\n\n<pre><code>SET @lastchecktime = (SELECT max(tresults.StartTime) FROM tresults);\nSELECT tresults.shopID\n , tshops.OfficialName\n , tresults.Price, tresults.starttime\n , Sub2.minprice\n , Sub2.StartTime\n , Sub3.daystoolow\n , (sub2.minprice/tsupplierproducts.lowestprice) -1 as afwijking\n , If(maxstarttime = @lastchecktime,'yes' ,'no') as notavailable     \nFROM\n  tresults\nINNER JOIN tshops\nON tshops.shopID = tresults.shopID\ninner JOIN (SELECT tresults.shopID\n                 , max(tresults.StartTime) AS MaxStartTime\n            FROM\n            tresults\n            WHERE\n              tresults.pID = 7\n              AND tresults.websiteID = 1\n              AND tresults.StartTime BETWEEN \"2012-08-01\" AND \"2012-12-01\"              \n            GROUP BY\n              tresults.shopID) Sub1\nON tresults.StartTime = Sub1.MaxStartTime AND Sub1.shopID = tshops.shopID\nINNER JOIN (SELECT tresults.shopID\n             , tresults.StartTime\n             , min(tresults.Price) AS minprice\n        FROM\n          tresults\n        WHERE\n          tresults.pID = 7\n          AND tresults.websiteID = 1\n          AND tresults.StartTime BETWEEN \"2012-08-01\" AND \"2012-12-01\"\n        GROUP BY\n          tresults.shopID) Sub2\nON Sub2.shopID = tshops.shopID\nINNER JOIN (SELECT tresults.shopID\n             , round(count(tresults.StartTime)/3,0) AS daystoolow\n        FROM\n          tsupplierproducts\n        INNER JOIN tresults\n        ON tsupplierproducts.pID = tresults.pID AND tresults.Price &lt; tsupplierproducts.LowestPrice\n        WHERE\n          tresults.pID = 7\n          AND tresults.websiteID = 1\n          AND tresults.StartTime BETWEEN \"2012-08-01\" AND \"2012-12-01\"\n          AND tsupplierproducts.supplierID = 2\n        GROUP BY\n          tresults.shopID) Sub3\nON Sub3.shopID = tshops.shopID\nINNER JOIN tsupplierproducts\nON tsupplierproducts.pID = tresults.pID AND tsupplierproducts.supplierID = 2\nWHERE\n  tresults.pID = 7\n  AND tresults.websiteID = 1\nORDER BY\nnotavailable desc, tresults.Price DESC\n</code></pre>\n\n<p>The explain result:</p>\n\n<pre><code>1, PRIMARY, tsupplierproducts, const, PRIMARY,fk_SupplierID,fk_pID, PRIMARY, 8, const,const, 1, Using temporary; Using filesort\n1, PRIMARY, &lt;derived4&gt;, ALL, , , , , 27, \n1, PRIMARY, &lt;derived2&gt;, ALL, , , , , 43, Using where; Using join buffer\n1, PRIMARY, &lt;derived3&gt;, ALL, , , , , 43, Using where; Using join buffer\n1, PRIMARY, tshops, eq_ref, PRIMARY, PRIMARY, 4, Sub1.shopID, 1, Using where\n1, PRIMARY, tresults, eq_ref,     PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC,fk_shopID, PRIMARY, 20, Sub1.MaxStartTime,const,Sub3.shopID,const, 1, \n4, DERIVED, tsupplierproducts, const, PRIMARY,fk_SupplierID,fk_pID, PRIMARY, 8, , 1, Using temporary; Using filesort\n4, DERIVED, tresults, ref, PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC,     idxPID, 4, , 42048, Using     where\n3, DERIVED, tresults, ref, PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC,     idxPID, 4, , 42048,     Using     where; Using temporary; Using filesort\n2, DERIVED, tresults, ref, PRIMARY,idxPID,idxWebsite,idxStartTimeASC,idxStartTimeDESC, idxPID, 4, , 42048, Using where; Using index; Using temporary; Using filesort\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3325,"score":0,"question_id":8510112,"title":"How would you display the manager name from employee table in an SQL query?","body":"<p>I have an employee table that displays the employee number, name, and manager's employee number. I'm trying to create a query that displays the emp name, emp#, manager name and mgr#. </p>\n\n<p>The table looks like this:</p>\n\n<pre><code>EMPNO ENAME  JOB       MGR  HIREDATE  SAL COMM DEPTNO \n7839  KING   PRESIDENT -    17-NOV-81 5000 -   10 \n7698  BLAKE  MANAGER   7839 01-MAY-81 2850 -   30 \n7782  CLARK  MANAGER   7839 09-JUN-81 2450 -   10 \n7566  JONES  MANAGER   7839 02-APR-81 2975 -   20 \n7654  MARTIN SALESMAN  7698 28-SEP-81 1250 1400 30 \n7499  ALLEN  SALESMAN  7698 20-FEB-81 1600 300 30 \n7844  TURNER SALESMAN  7698 08-SEP-81 1500 0   30 \n7900  JAMES  CLERK     7698 03-DEC-81 950  -   30 \n7521  WARD   SALESMAN  7698 22-FEB-81 1250 500 30 \n7902  FORD   ANALYST   7566 03-DEC-81 3000 -   20 \n</code></pre>\n\n<p>Three of the columns are pretty simple since they are in the table but how would I add the manager name when all I have is the employee number of their manager?</p>\n\n<p>This is what I have so far that only displays the 3 colums</p>\n\n<pre><code>select ename as \"Employee\", empno as \"Emp#\", mgr as \"Mgr#\"  from emp;\n</code></pre>\n\n<p>Any help would be appreciated</p>\n"},{"tags":["android","query","sqlite"],"answer_count":5,"favorite_count":14,"up_vote_count":22,"down_vote_count":0,"view_count":17781,"score":22,"question_id":1296180,"title":"Android quotes within an sql query string","body":"<p>I want to perform a query like the following:</p>\n\n<pre><code>uvalue = EditText( some user value );\np_query = \"select * from mytable where name_field = '\" +  uvalue + \"'\" ;\nmDb.rawQuery( p_query, null );\n</code></pre>\n\n<p>if the user enters a single quote in their input it crashes.  If you change it to:</p>\n\n<pre><code>p_query = \"select * from mytable where name_field = \\\"\" +  uvalue + \"\\\"\" ;\n</code></pre>\n\n<p>it crashes if the user enters a double quote in their input.\nand of course they could always enter both single and double quotes.</p>\n"},{"tags":["php","sql","query","select","sql-order-by"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12969116,"title":"SQL Query SELECT,ORDER","body":"<p><strong>SQL Query SELECT,ORDER date</strong> </p>\n\n<p>Hi, I need to select the date from my table, the problem is that I have above 130 rows and it will grow every day. I want to short it and in the query to select the date that equal for today <code>date=date(\"Y-m-d\")</code> and the date that bigger from the date of today.</p>\n\n<p>It can be a variable the date of today because I'm using a date selection to paginated between the dates. I know I can use timestamp but I dont know how to implement it in the query.</p>\n\n<pre><code>  $r = mysql_query(\"SELECT  date FROM yoman  ORDER BY date ASC,time ASC  \") \n            or die(mysql_error()); \n</code></pre>\n\n<p>I hope you will unserstand, <a href=\"http://attiatech.com/projects/tours/index.php?db=cmVsXzIwMTI=\" rel=\"nofollow\">http://attiatech.com/projects/tours/index.php?db=cmVsXzIwMTI=</a> this is the link, try to pick the 1.10.2012 and see how many rows are printed, i have the second option of view paginated but i want in this query to filter it too.</p>\n"},{"tags":["mysql","sql","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12968538,"title":"MySQL: Combining two queries into one row result","body":"<p>First part of the query:</p>\n\n<pre><code>SET @centerLat = '48.531157';\nSET @centerLng = '-123.782959';\n\nSELECT user_id, lat, lng, ( 3959 * acos( cos( radians( @centerLat ) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(@centerLng) ) + sin( radians( @centerLat ) ) * sin( radians( lat ) ) ) ) AS distance FROM bid_userloc HAVING distance &lt; 25 ORDER BY distance LIMIT 0 , 20\n</code></pre>\n\n<p>Second aspect is taking the <code>user_id</code> and grabbing a bunch of information from the USERS table </p>\n\n<p>I'm still learning what JOIN even means and I don't quite understand how it all works best...</p>\n"},{"tags":["query","alfresco"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12909151,"title":"How to find content older than a specific number of days in Alfresco","body":"<p>I'm developing a number of scheduled tasks in Alfresco. One of these tasks should only run on nodes where a certain date property is older than a fixed number of days. I've looked into range queries: <code>date:[MIN TO NOW]</code>, but I don't want to use NOW, but a date that is <em>x</em> days in the past. </p>\n\n<p>Can this be specified in the query?</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12967812,"title":"Rewrite query without UNION","body":"<p>I am reading values from 4 tables </p>\n\n<pre><code>select '1' as htl_EventId,  \n    'Reading Records' + cast(rank() OVER (ORDER BY ReadingRecord_Id) as varchar)  as htl_EventTitle, \n     dateadd(dd,01,Reading_Date) as htl_StartDate ,dateadd(dd,01,Reading_Date) as htl_EndDate,'White' as htl_Colour,'ForestGreen' as htl_TextColour,'This is your Reading  no ' + cast(rank() OVER (ORDER BY ReadingRecord_Id) as varchar) as htl_EventDescription,\n     'http://google.co.in' as htl_UrlValue\n     from Reading_Records where User_Id=@UserID and Reading_Date between \n     convert(date, @StartDate, 103) and convert(date, @EndDate, 103) \n     --order by Start_Date ASC\n    --('#' + cast((select ABS(CHECKSUM(NEWID())) % 900000000 + 100000000) as nvarchar)) as htl_Colour,\n    union \n\n    select '2' as htl_EventId,  \n    'Incident Details' + cast(rank() OVER (ORDER BY Incident_Id ) as varchar)  as htl_EventTitle, \n     dateadd(dd,01,From_Date) as htl_StartDate ,dateadd(dd,01,coalesce(To_Date,from_Date)) as htl_EndDate,'maroon' as htl_Colour,'Black' as htl_TextColour, 'This is your Incident  no ' + cast(rank() OVER (ORDER BY Incident_Id ) as varchar) as htl_EventDescription,\n     'http://gmail.co.in' as htl_UrlValue\n     from User_Incidents where User_Id=@UserID and From_Date &gt;= \n     convert(date, @StartDate, 103) and To_Date &lt;= convert(date, @EndDate, 103) and status='True'\n     --order by From_Date ASC\n\n     union \n\n     select '3' as htl_EventId,  \n    'HealthConditions' + cast(rank() OVER (ORDER BY Condition_Id ) as varchar)  as htl_EventTitle, \n     dateadd(dd,01,Start_MonthYear) as htl_StartDate ,dateadd(dd,01,Start_MonthYear) as htl_EndDate,'maroon' as  htl_Colour,'Red' as  htl_TextColour,'This is your HealthCondition  no ' + cast(rank() OVER (ORDER BY Condition_Id ) as varchar) as htl_EventDescription,\n     'http://facebook.com' as htl_UrlValue\n     from User_Health_Condition where User_Id=@UserID and Start_MonthYear between \n     convert(date, @StartDate, 103) and convert(date, @EndDate, 103) and status='True'\n     order by 1 ASC \n</code></pre>\n\n<p>Please give any suggestion ? Thank you in advance . I need to add one more query for the above </p>\n\n<pre><code>select '1' as htl_EventId, \n dateadd(dd,01,Reading_Date) as htl_StartDate ,dateadd(dd,01,Reading_Date) as htl_EndDate,DR.Reading_Name as htl_ReadingName\n from Reading_Records RR LEFT OUTER JOIN DBO.[Defined_Readings] DR  ON RR.Reading_Id=DR.Reading_Id  where User_Id=@UserID\n</code></pre>\n"},{"tags":["mysql","sql","query","group-by","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12967982,"title":"Group By/Order By Two Columns - Get Data Without Losing Rows - MySQL","body":"<p>I have a table <code>number_color_style</code> with the structure as shown below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/xevDJ.png\" alt=\"Table Strcture\"></p>\n\n<p>This table contains data as shown below(8 rows)</p>\n\n<p><img src=\"http://i.stack.imgur.com/LPvKx.png\" alt=\"Table Data\"></p>\n\n<p>What I want as I output is All records grouped by <code>number_color_id</code> , <code>number_style_id</code></p>\n\n<p>I tried below query</p>\n\n<pre><code>SELECT *\nFROM `number_color_style`\nGROUP BY `number_color_id` , `number_style_id`\n</code></pre>\n\n<p>It gives me output but some rows are missing</p>\n\n<p><img src=\"http://i.stack.imgur.com/XJboK.png\" alt=\"Result\"></p>\n\n<p>What I want is <strong>four set of data</strong> without missing a single row(should contain all 8 rows).\nEG:</p>\n\n<ul>\n<li>1st set where <code>number_color_id = 1</code> , <code>number_style_id = 1</code></li>\n<li>2nd set where <code>number_color_id = 1</code> , <code>number_style_id = 2</code></li>\n<li>3rd set where <code>number_color_id = 2</code> , <code>number_style_id = 1</code></li>\n<li>4th set where <code>number_color_id = 2</code> , <code>number_style_id = 2</code></li>\n</ul>\n\n<p>How can I do it ? </p>\n\n<p>Create table query</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `number_color_style` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `img` varchar(100) NOT NULL,\n  `number_color_id` int(11) NOT NULL,\n  `number_style_id` int(11) NOT NULL,\n  `number_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`)\n);\n</code></pre>\n\n<p>Some sample data</p>\n\n<pre><code>INSERT INTO `jink`.`number_color_style` (`id`, `img`, `number_color_id`, `number_style_id`, `number_id`) VALUES (NULL, 'img1.png', '1', '1', '10'), (NULL, 'img2.png', '1', '1', '10'), (NULL, 'img3.png', '1', '2', '10'), (NULL, 'img4.png', '2', '1', '10'), (NULL, 'img5.png', '2', '1', '10');\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12965008,"title":"LOAD DATA LOCAL INFILE custom value","body":"<p>How to add a custom value using LOAD DATA LOCAL INFILE?\nThe column time_added is the 7th column and the file has only 2 values for the first and the second column. For the 7th column, time_added I want to use the unix timestamp when loading from file.</p>\n\n<p>This code isn't working:</p>\n\n<pre><code>$result = mysql_query(\"LOAD DATA LOCAL INFILE '{$myFile}' INTO TABLE {$table} FIELDS TERMINATED BY ':' LINES TERMINATED BY '\\n' SET `time_added`=unix_timestamp()\");\n</code></pre>\n"},{"tags":["php","mysql","query","data","while-loop"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12967399,"title":"while ($row=mysql_fetch_array($result)) is not working","body":"<p>I'm using the below code to get some data.</p>\n\n<pre><code>    $result = mysql_query($sql);\n    while($row = mysql_fetch_array($result)) {\n        $data[] = array(\n            $row['Qty'], \n            $row['Description'] \n        );      \n    }\n</code></pre>\n\n<p>This is giving an empty array.</p>\n\n<p>When I'm trying the $sql manually its getting the correct results.</p>\n\n<p>Is anything wrong with the code above..??</p>\n\n<pre><code>SELECT CO.order_id AS TaxNo, \nDATE_FORMAT(CO.created,'%d-%m-%Y') AS InvoiceDate, \nC.company_name AS Consumer, CONCAT(C.delivery_address1, ', ', \nC.delivery_address2) AS DelAdd, \nCOD.qty AS Qty, \nP.product_name AS Description, \nPP.amount AS Price, \n(COD.qty * PP.amount) AS Total, \nSUM(COD.qty * PP.amount) AS InvoiceTotal, \nCPH.discount_on_payment AS Discount, \nCPH.amount_paid AS AmountPaid, \n(SUM(COD.qty * PP.amount) - CPH.discount_on_payment - CPH.amount_paid) AS Balance,  \nCOUNT(COD.qty) AS TotLine \nFROM consumer_orders AS CO \nINNER JOIN consumer AS C ON CO.consumer_id = C.consumer_id \nINNER JOIN consumer_order_details AS COD ON CO.order_id = COD.order_id \nINNER JOIN product AS P ON COD.Product_id = P.product_id \nLEFT JOIN product_price AS PP ON P.product_id = PP.product_id \nLEFT JOIN tbl_customer_payment_history AS CPH \nON CO.order_id = CPH.order_id WHERE CO.order_id = '60' \nGROUP BY CO.order_id, CO.created, C.company_name, CONCAT(C.delivery_address1, ', ', C.delivery_address2), COD.qty, P.product_name, PP.amount \n</code></pre>\n"},{"tags":["oracle","query","plsql","oracle-apex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12956887,"title":"using between with apex item in Oracle apex_util.json_from_sql","body":"<p>Does anybody know how to use apex item in apex_util.json_from_sql in application process when we try to find a value between two number? My query just like this one below :</p>\n\n<pre><code>SELECT  \nID , locn_x lat, locn_y lon\nFROM database where locn_x between :P1_SEBOUNDLAT and :P1_NWBOUNDLAT\n</code></pre>\n\n<p>But it's return no result. Apex item :P1_SEBOUNDLAT and :P1_NWBOUNDLAT has a value cos i diplay it and i try to do query in database and give me result. it seem : without = become a problem in this query. Because when i try to query </p>\n\n<pre><code>where locn_x &gt; :P1_SEBOUNDLAT \n</code></pre>\n\n<p>it give me an error</p>\n\n<p>Please somebody give me an advice. </p>\n"},{"tags":["query","wordpress","post","parent","category"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":7873,"score":1,"question_id":1228130,"title":"How do I get the parent category name in wordpress template? And can I query post by the parent category?","body":"<p>I tried getting help on the wordpress forums but no luck. Anyways, heres my question...</p>\n\n<p>Lets say i am creating 10 parent categories and 2 sub categories to each parent. My wordpress post belongs to one sub category of a particular parent category</p>\n\n<p>How do i get the parent category name ONLY? i don't want subcategories names? what wordpress code would do that?</p>\n\n<p>And one more question...</p>\n\n<p>Is it possible to query post by the parent of a sub category by using</p>\n\n<p></p>\n\n<p>but instead of entering \"cat=1\" or the name of the particular category, can I do something like</p>\n\n<p></p>\n\n<p>so this way it would automatically insert and query post for the parent of any particular sub category that's clicked on?</p>\n"},{"tags":["sql","query","ms-access","expression","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12966356,"title":"Comparing data between reporting periods MS Access","body":"<p>I have a big table that contains records for each reporting period in my project.\nThe period is indentified by an integer 1, 2, 3, 4, 5, 6, 7.</p>\n\n<p>Each period contains about 7000 rows of tasks each identified a unique ID. These tasks all have a percent complete column which is an integer.</p>\n\n<p>I want to add a comparison column.\nso it would look up the unique id in the previous period then return the difference in percent complete.</p>\n\n<p>eg\nfor\nPeriod: 8 Item Unique ID: 42w3wer324wer32 Percent complete: 50</p>\n\n<p>it would find:\nPeriod: 7 Item Unique ID: 42w3wer324wer32 Percent complete: 40</p>\n\n<p>the fill in the field with: 10.</p>\n\n<p>If it could not find the Item Unique ID in the previous period then it would default to 0.</p>\n\n<p>thanks</p>\n"},{"tags":["query","sharepoint","caml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3537,"score":0,"question_id":5662386,"title":"SharePoint Cascading Dropdown with CAML query that filters one of the choices","body":"<p>I have made a cascading dropdown form using <a href=\"http://spservices.codeplex.com\" rel=\"nofollow\">http://spservices.codeplex.com</a> but want to add a filter to the third cascading dropdown. So SPServices have a function called CAMLQuery where I can add this filter but I want the filter to be specified with the value from the top dropdown on the form.</p>\n\n<p>One example that is given on the page is:</p>\n\n<pre><code>            CAMLQuery: \"&lt;Eq&gt;&lt;FieldRef Name='Status'/&gt;&lt;Value Type='Text'&gt;Active&lt;/Value&gt;&lt;/Eq&gt;\"\n</code></pre>\n\n<p>I want this Status column to get its value from the choice selected on of the fields on the form. Is this possible and how would I write that?</p>\n\n<hr>\n\n<p>Edit: I am trying to make an asset list with cascading choices to find the right asset after picking unit and department. \nCode example after trying the below answer and not getting anything coming up in the \"Asset\" chooser. There are two lists, one containing Units and Departments and one containing the assets with a Department and Unit key to filter with.\nIf I replace the \"dynamic\" queries with a static one such as:</p>\n\n<pre><code>CAMLQuery: \"&lt;Eq&gt;&lt;FieldRef Name='Unit'/&gt;&lt;Value Type='Text'&gt;Unit 1&lt;/Value&gt;&lt;/Eq&gt;\"\n</code></pre>\n\n<p>the assets appear filtered for that unit. Current code:</p>\n\n<pre><code>&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery-1.5.2.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery.SPServices-0.6.0.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\nvar sCamlQuery = \"\";\n\n$(document).ready(function() {\n    $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Departments\",\n        relationshipListParentColumn: \"Unit\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Unit\",\n        childColumn: \"Department\",\n        completefunc: function() {\n        sCamlQuery = \"&lt;Eq&gt;&lt;FieldRef Name='Unit'/&gt;&lt;Value Type='Text'&gt;\" + $(\"select[title='Unit']\").attr(\"spcascadedropdown_selected_\") + \"&lt;/Value&gt;&lt;/Eq&gt;\";\n        }\n    });\n        $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Asset Database\",\n        relationshipListParentColumn: \"Department\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Department\",\n        childColumn: \"Asset\",\n        CAMLQuery: sCamlQuery\n    });\n\n});\n</code></pre>\n\n<p>The HTML:</p>\n\n<pre><code>&lt;tr&gt;\n&lt;td width=\"190px\" valign=\"top\" class=\"ms-formlabel\"&gt;\n    &lt;H3 class=\"ms-standardheader\"&gt;&lt;nobr&gt;Unit&lt;/nobr&gt;&lt;/H3&gt;\n&lt;/td&gt;\n&lt;td width=\"400px\" valign=\"top\" class=\"ms-formbody\"&gt;\n    &lt;span dir=\"none\"&gt;\n        &lt;select name=\"ctl00$PlaceHolderMain$g_c482307d_1a31_4129_8a0a_376d70562746$ff3_1$ctl00$Lookup\" id=\"ctl00_PlaceHolderMain_g_c482307d_1a31_4129_8a0a_376d70562746_ff3_1_ctl00_Lookup\" title=\"Unit\"&gt;\n            &lt;option selected=\"selected\" value=\"0\"&gt;(None)&lt;/option&gt;\n            &lt;option value=\"1\"&gt;Unit 1&lt;/option&gt;\n            &lt;option value=\"2\"&gt;Unit 2&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;/span&gt;¨\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr&gt;\n&lt;td width=\"190px\" valign=\"top\" class=\"ms-formlabel\"&gt;\n    &lt;H3 class=\"ms-standardheader\"&gt;&lt;nobr&gt;Department&lt;/nobr&gt;&lt;/H3&gt;\n&lt;/td&gt;\n&lt;td width=\"400px\" valign=\"top\" class=\"ms-formbody\"&gt;\n    &lt;span dir=\"none\"&gt;\n        &lt;select name=\"ctl00$PlaceHolderMain$g_c482307d_1a31_4129_8a0a_376d70562746$ff4_1$ctl00$Lookup\" id=\"ctl00_PlaceHolderMain_g_c482307d_1a31_4129_8a0a_376d70562746_ff4_1_ctl00_Lookup\" title=\"Department\"&gt;\n            &lt;option selected=\"selected\" value=\"0\"&gt;(None)&lt;/option&gt;\n            &lt;option value=\"5\"&gt;Administration&lt;/option&gt;\n            &lt;option value=\"4\"&gt;IT&lt;/option&gt;\n            &lt;option value=\"1\"&gt;Kitchen&lt;/option&gt;\n            &lt;option value=\"2\"&gt;Production&lt;/option&gt;\n            &lt;option value=\"7\"&gt;Production&lt;/option&gt;\n            &lt;option value=\"6\"&gt;Sales&lt;/option&gt;\n            &lt;option value=\"3\"&gt;Warehouse&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;/span&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr&gt;    \n&lt;td width=\"190px\" valign=\"top\" class=\"ms-formlabel\"&gt;\n    &lt;H3 class=\"ms-standardheader\"&gt;&lt;nobr&gt;Asset&lt;/nobr&gt;&lt;/H3&gt;\n&lt;/td&gt;\n&lt;td width=\"400px\" valign=\"top\" class=\"ms-formbody\"&gt;\n    &lt;span dir=\"none\"&gt;\n        &lt;select name=\"ctl00$PlaceHolderMain$g_c482307d_1a31_4129_8a0a_376d70562746$ff5_1$ctl00$Lookup\" id=\"ctl00_PlaceHolderMain_g_c482307d_1a31_4129_8a0a_376d70562746_ff5_1_ctl00_Lookup\" title=\"Asset\"&gt;\n            &lt;option selected=\"selected\" value=\"0\"&gt;(None)&lt;/option&gt;\n            &lt;option value=\"3\"&gt;Computer&lt;/option&gt;\n            &lt;option value=\"2\"&gt;Copy machine&lt;/option&gt;\n            &lt;option value=\"1\"&gt;Dishwasher&lt;/option&gt;\n            &lt;option value=\"5\"&gt;Dishwasher&lt;/option&gt;\n            &lt;option value=\"4\"&gt;Oven&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;/span&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Verifying function:</p>\n\n<pre><code>&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery-1.5.2.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\" src=\"../../Hidden/jquery.SPServices-0.6.0.min.js\"&gt;&lt;/script&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\nvar sCamlQuery = \"\";\n\n$(document).ready(function() {\n\n    $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Departments\",\n        relationshipListParentColumn: \"Unit\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Unit\",\n        childColumn: \"Department\",\n        completefunc: function() {\n        sCamlQuery = window.alert(\"completefunc\");//\"&lt;Eq&gt;&lt;FieldRef Name='Unit'/&gt;&lt;Value Type='Text'&gt;\"+ $(\"select[title='Unit'] option:selected\").text() +\"&lt;/Value&gt;&lt;/Eq&gt;\";\n                                }\n    });\n\n        $().SPServices.SPCascadeDropdowns({\n        relationshipList: \"Asset Database\",\n        relationshipListParentColumn: \"Department\",\n        relationshipListChildColumn: \"Title\",\n        parentColumn: \"Department\",\n        childColumn: \"Asset\",\n        CAMLQuery: sCamlQuery\n    });\n\n});\n&lt;/script&gt;\n</code></pre>\n\n<p><strong>Departments list:</strong></p>\n\n<p><em>Title</em>  <em>Unit</em></p>\n\n<p>IT       Unit1</p>\n\n<p>Sales    Unit1</p>\n\n<p>IT       Unit2</p>\n\n<p>Sales    Unit2</p>\n\n<p><strong>Asset Database:</strong></p>\n\n<p><em>Title</em>  <em>Department</em> *Unit* </p>\n\n<p>Asset1    IT    Unit1</p>\n\n<p>Asset2    IT     Unit2</p>\n\n<p>David</p>\n"},{"tags":["mysql","query","transpose"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":12962000,"title":"join tables and transpose columns and rows","body":"<p>I have one table that looks like this called survey_1:</p>\n\n<pre><code>================================================\n|id  | token  |     1X2X1     |    1X2X2       |\n=====+========+===============+================|\n| 1  |   1    |    YES        | Justin Beiber  |\n|----+--------+---------------+----------------|\n| 2  |   1    |    YES        | Britney Spears |\n|----+--------+---------------+----------------|\n</code></pre>\n\n<p><strong>note</strong>: 1X2X1 represents- survey-id X group-id X question-id</p>\n\n<p>I have another table called survey_questions:</p>\n\n<pre><code>===============================================================\n|sid |   gid  |   qid  |             question                 |\n=====+========+===============+===============================|\n| 1  |  2     |    1   |  Do you listen to music?             |\n|----+--------+-----------------------------------------------|\n| 1  |  2     |    2   |  Who is your favorite music artists? |\n|----+--------+-----------------------------------------------|\n</code></pre>\n\n<p>The sid (survey-id), gid (group-id) and qid(question-id) define that specific question in this table   </p>\n\n<p>I need a query that will give me a result like this:</p>\n\n<pre><code>======================================================\n|           Question                  |   Answer     |\n=========+===========+===============================|\n| Do you listen to music?             |    YES       |            \n|----------------------------------------------------|\n| Who is your favorite music artists? | Justin Beiber| \n|----------------------------------------------------|\n</code></pre>\n\n<p><strong>NOTE</strong>: My database contains thousands of these columns, so it would be very time consuming to edit every survey to match up perfectly in this format.</p>\n\n<p>Can anyone help out with this? Thank you </p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12264669,"title":"Sql query- needs to extract records based on Datefield","body":"<p>I need to extract data from Table1 and insert it into Table2 on Last monday of every month. Basic version of my Tables are something like this..</p>\n\n<p>Table1 (ID,Name,EffectiveDate)</p>\n\n<p>Table2 (ID,Name,EffectiveDate,ProcessDate)</p>\n\n<p>I want to extract only those records where Effectivedate has been 4 months from current date (For Example: if EffectiveDate is 1st January then it should be extracted after 1st April...). Actually Table2 is being used for Reporting purpose so we have 'processDate' field that we can use while Filtering.</p>\n\n<p>Any help would be appreciated..thanks</p>\n\n<p>EDIT:</p>\n\n<p>well, i know we can do something like this </p>\n\n<p>EffectiveDate &lt; DATEADD(MM,-4,GetDate())</p>\n"},{"tags":["sql-server","query","coldfusion"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12961444,"title":"MS-SQL sort output in descending order","body":"<p>I have this MS-SQL query with thousands of row records in database:<br /></p>\n\n<pre><code>SELECT DISTINCT TOP 7 DATENAME(MM, mydatetime) + ' ' + CAST(DAY(mydatetime) AS VARCHAR(2)) as thedate\n    , MONTH(mydatetime)\n    , DAY(mydatetime)\n    , COUNT(Page) as totalcount\n    , count(DISTINCT Page) as visitors\n  FROM someTable\n  WHERE Page LIKE '%AEC%'\n  GROUP BY DATENAME(MM, mydatetime) + ' ' + CAST(DAY(mydatetime) AS VARCHAR(2))\n    , MONTH(mydatetime)\n    , DAY(mydatetime)\n  ORDER BY MONTH(mydatetime) DESC\n    , DAY(mydatetime) DESC\n</code></pre>\n\n<p>It will output this:<br/></p>\n\n<pre><code>thedate     | totalcount | visitors\n-----------------------------------\nOctober 17  |     4      |    1\nOctober 15  |     1      |    1\nOctober 12  |     1      |    1\nOctober 3   |     3      |    3\nOctober 2   |     42     |    22\nSeptember 28|     2      |    1\nSeptember 21|     14     |    10\n</code></pre>\n\n<p>My problem is that I simply cant output this in descending order so it will look like this:</p>\n\n<pre><code>thedate     | totalcount | visitors\n-----------------------------------\nSeptember 21|     14     |    10\nSeptember 28|     2      |    1\nOctober 2   |     42     |    22\nOctober 3   |     3      |    3\nOctober 12  |     1      |    1\nOctober 15  |     1      |    1\nOctober 17  |     4      |    1\n</code></pre>\n\n<p>So any help is greatly appreciated. </p>\n"}]}
{"total":20739,"page":10,"pagesize":100,"questions":[{"tags":["django","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":38,"score":-3,"question_id":12961545,"title":"Queries in Django, sql","body":"<p>I would be very grateful if you send me one sql-query.\nSo, columns are: <strong>even</strong> (contains strings '*' or '1' or '2') and <strong>weeks</strong> (contains strings '*' or '1 2 3 4 5 ' etc).\nI have 2 variables: </p>\n\n<ol>\n<li>even_week = int, 1 or 2</li>\n<li>today_week = int, num of the week</li>\n</ol>\n\n<p>I need all fields from that table, where </p>\n\n<pre><code>(even='*' OR even = even_week) AND (weeks='*' or today_week in weeks)\n</code></pre>\n\n<p>I am newbie in Django, please, help. Thanks</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12961437,"title":"mysql getting max value of a column group by many","body":"<p>I have a mysql table:</p>\n\n<pre><code>id       int\na        varchar\nb        varchar\nc        varchar\nversion  int\nactive   bool\n</code></pre>\n\n<p>I want to grab the max version group by a, b and c , so I have following query to do that:</p>\n\n<pre><code>select a, b, c, max(version) as version from mytbl where active = 1 group by (a, b, c)\n</code></pre>\n\n<p>but this returns </p>\n\n<pre><code>Operand should contain 1 column(s)\n</code></pre>\n\n<p>What is wrong here?</p>\n"},{"tags":["php","mysql","query","admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12960284,"title":"Searching Database column for certain numbers","body":"<p>I need a query to search a database for a specific number within a group of numbers listed in the same column on a database.</p>\n\n<p>The database <code>Access</code> will contain two columns</p>\n\n<p>First column: Page Name</p>\n\n<p>Second Column: Access</p>\n\n<p>And will be set up similar to:   Page Name: Blog-Admin   Access: 60,61,62,76,83,94</p>\n\n<p>where the numbers in the column Access are the ranks that are allowed to view the page.</p>\n\n<p>On each page, there will be a query that finds the users rank and stores it in a $URank variable.</p>\n\n<p>Each page is named in a variable ($PageName) which will match the column Page Name in the <code>Access</code> Database</p>\n\n<p>In this query, it needs to search the column Access for the users rank for that page (page name = $PageName)</p>\n\n<p>By storing this in a database, it will allow admins to modify who has access to what pages at any point in time.</p>\n\n<p>I just need the query that will search the database to make sure that user rank has permission to access that page.</p>\n\n<p>This may be very simple, not sure.</p>\n\n<p>I'm use to queries such as  mysql_query(\"select * from database where blahblah=viarable\")...so if it could be answered in this format, that would be fantastic.  Even if its the mysqli equivilant.</p>\n"},{"tags":["regex","query","postgresql","ruby-on-rails-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12960397,"title":"Query for only integers Rails 2.3","body":"<p>My environment is <code>Ruby 1.8.7-p358 with Rails 2.3.11</code>.  I am trying to query for all <code>accounts</code> that have a <code>first_name</code> containing only numbers (they are all 3 digit integers, i.e. 001, 143, 815, etc.).  I have been trying to use this query:</p>\n\n<pre><code>Account.find(:all, :conditions =&gt; [\"first_name LIKE ?\", \"[^0-9][^0-9][^0-9]\"])\n</code></pre>\n\n<p>All I get in return is <code>=&gt; []</code>.</p>\n\n<p>If I use the same query only with <code>NOT LIKE</code> I get all <code>accounts</code>, including the ones where <code>first_name</code> is an integer.</p>\n\n<p>I've also tried using:</p>\n\n<pre><code>Account.find(:all, :conditions =&gt; [\"first_name REGEXP ?\", \"[^0-9][^0-9][^0-9]\"])\n</code></pre>\n\n<p>but that only gives me:</p>\n\n<pre><code>ActiveRecord::StatementInvalid: PGError: ERROR:  syntax error at or near \"REGEXP\"\nLINE 1: SELECT * FROM \"accounts\" WHERE (first_name REGEXP '[0-9][0-9...\n                                               ^\n\n: SELECT * FROM \"accounts\" WHERE (first_name REGEXP '[0-9][0-9][0-9]')  ORDER BY first_name ASC\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/abstract_adapter.rb:227:in `log'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/postgresql_adapter.rb:520:in `execute'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/postgresql_adapter.rb:1002:in `select_raw'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/postgresql_adapter.rb:989:in `select'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/abstract/database_statements.rb:7:in `select_all_without_query_cache'\n      from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/connection_adapters/abstract/query_cache.rb:62:in `select_all'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/base.rb:665:in `find_by_sql'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/base.rb:1582:in `find_every'\n  from /Users/kyle/.rvm/gems/ruby-1.8.7-p358@popcorn_recruiter_portal/gems/activerecord-2.3.11/lib/active_record/base.rb:619:in `find'\n  from (irb):189\n  from :0\n</code></pre>\n\n<p>Are regular expressions not allowed?  How am I able to find each <code>account</code> with a <code>first_name</code> that's equal to a three digit integer?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12959849,"title":"Select products with users","body":"<p>I have not worked with SQL for quite a long time, and I need some help for a basic query. I have the three following tables:</p>\n\n<ul>\n<li><code>users (id, name)</code></li>\n<li><code>products (id, name)</code></li>\n<li><code>owners (userid, productid, date)</code></li>\n</ul>\n\n<p>One product can be sold by user A to user B and then back to A.</p>\n\n<p>Now, I want the list of all products currently owned by every single user with the date of transaction. </p>\n\n<p>Currently, my query is this one, but I'm stuck with old data (first association of one product to one user, and not the newest one):</p>\n\n<pre><code>SELECT users.name, products.name, date\nFROM products\n     JOIN owners ON products.id = owners.id\n     JOIN users ON owners.id = user.id\nGROUP BY product.id\n</code></pre>\n\n<p>Do you have some hints?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12959160,"title":"How to select next 4 consecutive rows from my resultant row?","body":"<p>I want to know, how can i select next 4 consecutive rows along with the resultant row in mysql?</p>\n\n<p>To explain:-</p>\n\n<p>i have following rows in table abc</p>\n\n<pre><code>name | amount \n\n a   -  1000\n\n b   -  2000\n\n c   -  3000\n\n d   -  4000\n\n e   -  5000\n\n f   -  6000\n</code></pre>\n\n<p>Now, \nif my selection criteria is name = a , then resultant rows returned should be</p>\n\n<pre><code> a   -  1000\n\n b   -  2000\n\n c   -  3000\n\n d   -  4000\n\n e   -  5000\n</code></pre>\n\n<p>In other words i want a query which will return result of query - \"select * from abc where name = 'a'\" plus next 4 consecutive rows to that row?</p>\n"},{"tags":["sql-server","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12959281,"title":"SQL Server partitioning monthly data by weeks and calculating weekly weighted average based on month days of that week belong to","body":"<p>I have a table like this:</p>\n\n<pre><code>Month          Value\n2012-08-01      0.345\n2012-09-01      0.543\n2012-10-01      0.321\n2012-11-01      0.234\n2012-12-01      0.234\n</code></pre>\n\n<p>User inputs week range from '2012-09-29' to '2012-10-13'\nOutput should show results for all weeks in requested range and average values for each week with the following logic:\n - if all weekdays are entirely in one month, just use monthly value for that month\n - if weekdays are spread out over two months, calculate weekly value as average between those two months giving preference to the month that contains the most days of that week.</p>\n\n<p>If someone can give me an idea how to do something like this in T-SQL that would be highly appreciated.</p>\n"},{"tags":["php","mysql","query","optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":12958828,"title":"adding and multiplying COUNT() of several tables","body":"<p>Is it possible to add and multiply the count of different tables where the id is the same?\nImagine:</p>\n\n<pre><code>Table_1       Table_2    Table_3\nid            id         id\n1             1          1\n1             2          2\n2             2          3\n3             2          3\n3             2          3\n3             3          3\n</code></pre>\n\n<p>So that the end result would be this table with 2 columns:</p>\n\n<pre><code>id        (COUNT(Table_1.id) + 2*COUNT(Table_2.id) + 3*COUNT(Table_3.id))\n1                                   7\n2                                   12\n3                                   17\n</code></pre>\n"},{"tags":["php","mysql","query","optimization","unlink"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12958777,"title":"There has got to be a more efficient way to do this","body":"<p>Basically I am trying to trim the images table down to 3,500 rows of unsaved or unfiltered images. Unsaved and unfiltered refer to other tables in the DB. A user can save an image as well as mark an image safe for work etc... I would like to keep all images in the saves table as well as the filter table. </p>\n\n<p>Ultimately, The images table will get trimmed down to (3,500 unsaved/unfiltered images) + (\"X\" saved)+(\"X\" unfiltered). The link between saves/filters/images is the auto_incremented id given to the record in the <code>images</code> table. So saves has an image_id field that gets the key of the record in the <code>images</code> table. same with the filters table </p>\n\n<pre><code>//connect to database\n$connect = xxxxxxxxxxx;\n\n\n//GET ALL IMAGES FROM `images` Table - NEWEST FIRST (`id` is auto_increment)\n$sql = mysql_query(\"SELECT * FROM `images` ORDER BY `id` DESC\") or die(mysql_error());\n$x = 0;\nwhile($row = mysql_fetch_array($sql)){\n    //GET CURRENT IMAGES ID AND URL\n    $id = $row['id'];\n    $file = $row['url'];\n\n    //SEE IF IMAGE IS IN THE saves Table\n    $saves = mysql_query(\"SELECT `id` FROM `saves` WHERE `img_id` = '\".$id.\"'\") or die(mysql_error());\n    if(mysql_num_rows($saves) == 0){$saved = FALSE;}\n    else {$saved = TRUE;}\n\n    //SEE IF IMAGE IS IN THE filters Table\n    $filter = mysql_query(\"SELECT `id` FROM `filter` WHERE `img_id` = '\".$id.\"'\") or die(mysql_error());\n    if(mysql_num_rows($filter) == 0){$filtered = FALSE;}\n    else {$filtered = TRUE;}\n\n    //If the image has not been saved or filtered then put it in a que for deletion\n    if(!$saved || !$filtered){\n        $IdQue[$x] = $id;\n        $FileQue[$x] = $file;\n        $x++;\n    }//END if   \n}//END while\n\n//Process the delete que: Delete node from database, delete file on server. Keep 3,500 of the newest images.\nfor($i=3500; $i&lt;$x; $i++){\n    mysql_query(\"DELETE FROM `images` WHERE id='\".$IdQue[$i].\"' LIMIT 1\") or die(\"line 33\".mysql_error());\n\n    if(file_exists($FileQue[$i])){\n        unlink($FileQue[$i]) or die(\"file Not deleted\");\n    }//END if\n}//END for\necho ($i-3500).\" files deleted&lt;br/&gt;\";\n\n//terminate connection\nmysql_close($connect);\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12957635,"title":"Sql query to insert datetime in SQL Server","body":"<p>I want to insert a <code>datetime</code> value into a table(SQL Server) using the sql query below</p>\n\n<pre><code>insert into table1(approvaldate)values(18-06-12 10:34:09 AM);\n</code></pre>\n\n<p>But I get this Error msg. <code>Incorrect syntax near '10'.</code></p>\n\n<p>I tried it with the quotes</p>\n\n<pre><code>insert into table1(approvaldate)values('18-06-12 10:34:09 AM');\n</code></pre>\n\n<p>I get this error message <code>Cannot convert varchar to datetime</code></p>\n\n<p>Kindly help! \nThanks.</p>\n"},{"tags":["mysql","database","query","many-to-many"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":11064275,"title":"Fetching data from many-to-many relationships","body":"<p>I want to fetch the title from book table and the subject name from subject table for all the books of a certain author</p>\n\n<p>Here is the tables relationships</p>\n\n<p><img src=\"http://i.stack.imgur.com/7suGS.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/vnrPp.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried to select the title and the subject from the tables but I can't get it to work with the many to many relationship</p>\n\n<pre><code>SELECT book_title,subject_name FROM book,subject WHERE $subject_ID = subject_ID INNER JOIN book_author ON author_ID = '$author_ID'\n</code></pre>\n\n<p>I thought about making two separate queries, if someone could help me on that I would be really glad.</p>\n"},{"tags":["query","node.js","mongodb","date","mongoose"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12855280,"title":"Querying by date, regardless time part","body":"<p>I want to show my blog posts, paginated by creation date. I will have a page for 5 posts written in 2012-10-01, a page for 11 posts written in 2012-10-03 and no page at all for 2012-10-02 (no posts written)</p>\n\n<p>Each post document is stored with a creation date which is a datetime value, here's a mongoose snippet:</p>\n\n<pre><code>var postSchema = new Schema({\n    url: String,\n    creationDate: {type: Date, default: Date.now},\n    contenuto: String,\n});\n</code></pre>\n\n<p>so it will have something like 2012-10-01 18:45:03... know what I mean.</p>\n\n<p>In my code, I will create a </p>\n\n<pre><code>var searchDate = new Date(yy,mm,dd);\n</code></pre>\n\n<p><strong>How can I use that for querying the posts collection, without considering the \"time part\" of creationDate?</strong></p>\n\n<p>I'm not sure this would always work:</p>\n\n<pre><code>Post.find({ creationDate:dataRicerca })\n</code></pre>\n"},{"tags":["sql-server","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12938332,"title":"Multiple COUNT SELECTS from the same table in one query","body":"<p>For some people it might look very simple, but I just simply can't get it.<br />\nI have multiple MS-SQL SELECT queries from the same table over and over:<br /></p>\n\n<pre><code>SELECT count(Page) as tAEC\nFROM someTable\nWHERE Page LIKE '%AEC%'\n</code></pre>\n\n<p>next one</p>\n\n<pre><code>SELECT count(Page) as tTOL\nFROM someTable\nWHERE Page LIKE '%TOL%'\n</code></pre>\n\n<p>and so on...<br /></p>\n\n<p>What would be more efficient way to write this query. I Googled bunch of similar questions but I couldnt make any of them to work. So any help is greatly appreciated.</p>\n"},{"tags":["php","mysql","sql","query","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12957327,"title":"Can't get query to work","body":"<p>I have a database containing 3 tables (member, boat, boatType) and in the method below two of them is affected. What I want is to list all boats that's registered on a member, but there's a problem with the code (at least with the SQL, but I suspect that's not all).</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>boatHandler.php:</strong></p>\n\n<pre><code>public function GetMembersBoats($memberId) {\n\n    $query = \"SELECT b.boatId, b.length, bt.type\n                  FROM boat AS b\n                      INNER JOIN member AS m\n                          ON b.memberId = m.memberId\n                              WHERE m.memberId = ?\n                      INNER JOIN boatType AS bt\n                          ON b.boatTypeId = bt.boatTypeId\n                      GROUP BY b.boatId\";\n\n    $stmt = $this-&gt;m_db-&gt;Prepare($query);\n    $stmt-&gt;bind_param('i', $memberId);\n\n    $boats = $this-&gt;m_db-&gt;GetBoats($stmt);\n}\n</code></pre>\n\n<p><strong>database.php:</strong></p>\n\n<pre><code>public function GetBoats($stmt) {\n    $boats = array(\n            0 =&gt; array(),\n            1 =&gt; array(),\n            2 =&gt; array()\n        );\n\n    $stmt-&gt;execute();\n\n    $stmt-&gt;bind_result($boatId, $length, $type);\n\n    while ($stmt-&gt;fetch()) {\n        array_push($boats[0], $boatId);\n        array_push($boats[1], $length);\n        array_push($boats[2], $type);\n    }\n\n    $stmt-&gt;Close();\n\n    return $boats;\n}\n</code></pre>\n\n<h3>Affected tables:</h3>\n\n<ul>\n<li><strong>boat:</strong> boatId, boatTypeId, length, memberId</li>\n<li><strong>boatType:</strong> boatTypeId, type</li>\n</ul>\n"},{"tags":["mysql","sql","query","metadata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12945702,"title":"SQL: Complicated Select Statement and returned radius","body":"<p>This query is driving me insane and I honestly just don't know how to accomplish it.</p>\n\n<p>I need to grab all USERS and SHOPS longitude and latitude that are within a certain radius, and return back some other information attached to those resulting IDs... the radius part, I have figured out:</p>\n\n<p><code>( 3959 * acos( cos( radians('48.453541') ) * cos( radians( lat ) ) * cos( radians( lng ) - radians('-123.491765') ) + sin( radians('48.453541') ) * sin( radians( lat ) ) ) ) AS distance</code></p>\n\n<p>^This radians in the statement above are just a random address that I want to query against.</p>\n\n<p>But grabbing results that essentially are two different rows AS ONE result confuses me right out. Both tables are constructed in this manner:</p>\n\n<pre><code>id\nmeta_key\nmeta_value\n</code></pre>\n\n<p>So I need to grab the \"meta_value\" of two keys for both a USER and a SHOP ... the \"meta_key\"  for the USER is \"bid_user_lat\" and \"bid_user_lng\" ... and the \"meta_key\" for the SHOP are \"bid_resource_lat\" and \"bid_resource_lng\"</p>\n\n<p>Ideal results (just showing one of each, but should be multiple, depending on radius):</p>\n\n<pre><code>id - 223\nfirst_name - \"Mark\"\nlast_name - \"Johnson\"\nbid_user_lat - 45.0000\nbid_user_lng - -150.0000\n\nid - 688\ncompany_name - \"Joe's Shop\"\nbid_resource_lat - 45.0000\nbid_resource_lng - -150.0000\n</code></pre>\n\n<p>I really hope I'm explaining this correctly, because this is just driving me nuts!</p>\n\n<hr>\n\n<p>My updated query is as follow, yet it's still not producing any results and it should:</p>\n\n<pre><code>SET @lat =  '48.453541';\nSET @lng =  '-123.491765';\nSET @radius =  '10000';\n\nSELECT\n    wp_usermeta.user_id,\n    bid_user_lat.meta_value,\n    bid_user_lng.meta_value,\n\n( 3959 * acos( cos( radians( @lat ) ) * cos( radians( bid_user_lat.meta_value ) ) * cos( radians( bid_user_lng.meta_value ) - radians( @lng ) ) + sin( radians( @lat ) ) * sin( radians( bid_user_lat.meta_value ) ) ) )  AS distance \n\nFROM\n    wp_usermeta\nJOIN \n    wp_usermeta bid_user_lat\n    ON wp_usermeta.user_id = bid_user_lat.user_id\n    AND wp_usermeta.meta_key = \"bid_user_lat\"\nJOIN\n    wp_usermeta bid_user_lng\n    ON wp_usermeta.user_id = bid_user_lng.user_id\n    AND wp_usermeta.meta_key = \"bid_user_lng\"\n\nHAVING distance &lt; @radius ORDER BY distance LIMIT 0 , 20;\n</code></pre>\n"},{"tags":["android","query","url","google","illegal"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1421,"score":1,"question_id":6868373,"title":"URL error, Exception:Illegal character in query at index 185","body":"<p>What's wrong with my URL :</p>\n\n<p><a href=\"http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28\" rel=\"nofollow\">http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28</a> Jul 2011 10:00:02 GMT&amp;did=10169</p>\n\n<p>i got in my log cat </p>\n\n<p>07-29 10:11:16.995: VERBOSE/Exception doing background(334): Exception:Illegal character in query at index 185: \n<a href=\"http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28\" rel=\"nofollow\">http://emapzoom.com/gpslocation/upload_location?status=1&amp;lat=0.422005&amp;lng=-122.084095&amp;alt=0&amp;mph=0.0&amp;dir=0.0&amp;dis=1.359023E7&amp;lm=GPS&amp;sid=4500352380545078953&amp;acc=0.0&amp;tm=1311847202000&amp;tm2=28</a> Jul 2011 10:00:02 GMT&amp;did=10169</p>\n"},{"tags":["oracle","query","date-arithmetic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":60,"score":-4,"question_id":12954947,"title":"How to add 2 dates in Oracle sp?","body":"<p>How can we add two dates in oracle? For example in sql we can do this, \" date_1 + date_2 \" how can we achieve the same thing in Oracle</p>\n"},{"tags":["php","mysql","query","cakephp","cakephp-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12938422,"title":"CakePHP Query & JSON output - Improve current solution","body":"<p>I'm coding a tagging system in CakePHP (latest release) but the solution I have made seems over complicated compared to how easy the rest of CakePHP is. Hopefully someone can point me in the right direction or help me improve my current solution.</p>\n\n<p>I need to pass to my view data in this format (JSON):</p>\n\n<pre><code>[{label:'actionscript', count: 14}, {label:'php', count: 2} ... ]\n</code></pre>\n\n<p>Now I know the following SQL query gives me the needed data:</p>\n\n<pre><code>SELECT tags.name, count(*)\nFROM tags\nRIGHT JOIN tags_users\nON tags.id=tags_users.tag_id\nGROUP BY name\";\n</code></pre>\n\n<p>So using CakePHP find method I made:</p>\n\n<pre><code>$options = array();\n$options['contain'] = '';   \n$options['recursive'] =  -1;            \n$options['joins'][0]['table'] = 'tags_users';\n$options['joins'][0]['type'] = 'RIGHT';\n$options['joins'][0]['conditions'] = 'Tag.id = tags_users.tag_id';\n$options['fields'] =  array('name', 'COUNT(*) as tag_counter');\n$options['group']  =  'Tag.name';\n$options['order']  =  'tag_counter DESC';       \n$availableTagsArray = $this-&gt;User-&gt;TagsUser-&gt;Tag-&gt;find('all', $options);\n</code></pre>\n\n<p>This give me an array out as:</p>\n\n<pre><code>Array\n(\n[0] =&gt; Array\n    (\n        [Tag] =&gt; Array\n            (\n                [name] =&gt; actionscript\n            )\n\n        [0] =&gt; Array\n            (\n                [tag_counter] =&gt; 14\n            )\n\n    )\n\n[1] =&gt; Array\n    (\n        [Tag] =&gt; Array\n            (\n                [name] =&gt; php\n            )\n\n        [0] =&gt; Array\n            (\n                [tag_counter] =&gt; 2\n            )\n\n    )\n)\n</code></pre>\n\n<p>I then convert this array to JSON by:</p>\n\n<pre><code>$availableTags = \"[\";\n\nforeach ($availableTagsArray as $tag) {\n        $availableTags .= \"{label:'{$tag['Tag']['name']}', count:{$tag[0]['tag_counter']}},\";   \n    }\n\n$availableTags = substr($availableTags, 0, -1);\n$availableTags .= \"]\";  \n$this-&gt;set(\"availableTags\", $availableTags);\n</code></pre>\n\n<p><strong>[UPDATE]</strong></p>\n\n<p>After doing a lot of research and using both answers. I've found there multiple ways to do this and that includes my original solution. You could also use virtual fields then the afterFind method and flattening the results there. </p>\n"},{"tags":["sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":12954730,"title":"count and group on multiple columns","body":"<p>I am totally new to SQL. I have created following tables..</p>\n\n<pre><code>Employee\n- employee_id\n- employee_name\n\nProjects\n- project_id\n- project_name\n\nRoles\n- role_id\n- role_name\n\nEmployee_project_role\n- employee_id\n- project_id\n- role_id\n</code></pre>\n\n<p>I have to write a query for: list employees with count of different roles and also list role.\ni.e. if an employee(emp1) works as Team Leader(TL) in one project and as Tester(TEST) in other two different projects then the output should be :</p>\n\n<pre><code>employee_name   count   Role\n---------------------------\n  emp1           1      TL\n  emp1           2      TEST\n</code></pre>\n"},{"tags":["sql","database","query","plsql","oracle10g"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12953580,"title":"SQL Query works different than expected","body":"<p>I have problems with understanding sql statement.\nWhen I execute the it(see below), I'm getting only people with sgtn_typ 'L'.   </p>\n\n<pre><code> SELECT DISTINCT kun_id kid\n                ,dep_id\n                ,ddg_rang_g RANG\n                ,dep_perf_g\n                ,TO_CHAR(dep_buchwert + dep_kasse, '999G999G990D99') WERT\n                ,kun_name1\n                ,Kun_vorname\n                ,kun_cust_id\n                ,kun_strasse\n                ,kun_plz\n                ,kun_ort\n                ,kun_e_mail\n                ,kun_pseudonym\n                ,kka_value\n   FROM ddg, dep, kun, kat, kka, sgtn\n  WHERE dep_spi_id = 245\n        AND dep_abr_id = 24\n        AND ddg_dgr_id = 3\n        AND ddg_abr_id = dep_abr_id\n        AND ddg_spi_id = dep_spi_id\n        AND ddg_dep_id = dep_id\n        AND dep_kun_id = kun_id\n        AND kun_aktiv = 'J'\n        AND dep_spi_id = kun_spi_id\n        AND dep_id IS NOT NULL\n        AND dep_id NOT IN (SELECT ddg_dep_id\n                             FROM ddg\n                            WHERE ddg_spi_id = 245\n                                  AND ddg_abr_id = 0\n                                  AND ddg_dgr_id = 1)\n        AND kun_id = kka_kun_id\n        AND kka_spi_id = 245\n        AND kat_spi_id = 245\n        AND kka_kat_kuerzel = kat_kuerzel\n        AND kat_kuerzel = 'NSCH'\n        AND kka_spi_id = sgtn_spi_id\n        AND kka_kun_id = sgtn_kun_id\n        AND sgtn_spi_id = 245\n        AND sgtn_e_mail = kun_e_mail\n        AND (sgtn_typ = 'L' \n           OR (sgtn_typ = 'T'\n              AND sgtn_e_mail NOT IN (SELECT sgtn_e_mail\n                                      FROM sgtn\n                                      WHERE sgtn_spi_id = 245\n                                      AND sgtn_typ = 'L'))\n          )\n  ORDER BY kun_id, sgtn_typ;\n</code></pre>\n\n<p>But when I execute this, I'm getting people with sgtn_typ 'T': </p>\n\n<pre><code> SELECT *\n   FROM sgtn\n  WHERE sgtn_spi_id = 245\n        AND (sgtn_typ = 'L' \n             OR (sgtn_typ = 'T'\n                 AND sgtn_e_mail NOT IN (SELECT sgtn_e_mail\n                                         FROM sgtn\n                                         WHERE sgtn_spi_id = 245\n                                         AND sgtn_typ = 'L'))\n )\n  ORDER BY sgtn_kun_id;\n</code></pre>\n\n<p>I don't understand why? Could someone give me any clue? I was expecting, that I substitute all people with type 'L' and will get people with type 'T': </p>\n\n<pre><code> AND (sgtn_typ = 'L'\n         OR (sgtn_typ = 'T' \n              AND sgtn_e_mail NOT IN (SELECT sgtn_e_mail\n                                     FROM sgtn\n                                     WHERE sgtn_spi_id = 245\n                                      AND sgtn_typ = 'L'))\n       )\n</code></pre>\n\n<p>There are 'duplicates' in sgtn table(some people are entered with 'T' and 'L'). And apart from that the whole record is the same. </p>\n\n<p>Table scheme are like the folowing:</p>\n\n<p>SGTN: </p>\n\n<pre><code>SGTN_ID             NUMBER(22)\nSGTN_SPI_ID             NUMBER(22)\nSGTN_KUN_ID             NUMBER(22)\nSGTN_TYP                VARCHAR2(4)\nSGTN_GESCHLECHT     VARCHAR2(4)\nSGTN_VORNAME        VARCHAR2(160)\nSGTN_NAME1              VARCHAR2(240)\nSGTN_STRASSE        VARCHAR2(240)\nSGTN_PLZ                VARCHAR2(60)\nSGTN_ORT                VARCHAR2(240)\nSGTN_E_MAIL             VARCHAR2(240)\nSGTN_GEB_DAT            DATE(7)\nSGTN_KLASSE             VARCHAR2(200)\nSGTN_SCHULE             VARCHAR2(200)\nSGTN_TELEFON        VARCHAR2(120)\nSGTN_KONTONUMMER        VARCHAR2(120)\n</code></pre>\n\n<p>KUN: </p>\n\n<pre><code>KUN_ID          NUMBER(22)\nKUN_SPI_ID          NUMBER(22)\nKUN_LAN_ID          NUMBER(22)\nKUN_MED_KBEZ    VARCHAR2(40)\nKUN_NAME1           VARCHAR2(240)\nKUN_MKZ         VARCHAR2(80)\nKUN_TS          DATE(7)\nKUN_AKTIV           VARCHAR2(12)\nKUN_KTOINH          VARCHAR2(240)\nKUN_BLZ         VARCHAR2(40)\nKUN_BANK            VARCHAR2(240)\nKUN_KTONR           VARCHAR2(80)\nKUN_ZAHLART         VARCHAR2(4)\nKUN_NAME2           VARCHAR2(240)\nKUN_VORNAME         VARCHAR2(160)\nKUN_STRASSE         VARCHAR2(240)\nKUN_PLZ         VARCHAR2(60)\nKUN_ORT         VARCHAR2(240)\nKUN_TEL1            VARCHAR2(120)\nKUN_TEL2            VARCHAR2(120)\nKUN_FAX         VARCHAR2(120)\nKUN_E_MAIL          VARCHAR2(240)\nKUN_PSEUDONYM   VARCHAR2(120)\nKUN_PWD         VARCHAR2(60)\nKUN_CUST_ID         VARCHAR2(240)\nKUN_GESCHLECHT  VARCHAR2(4)\nKUN_K_NAME          VARCHAR2(80)\nKUN_K_NR            NUMBER(22)\nKUN_K_VALID         VARCHAR2(40)\nKUN_ZUSATZ_1    VARCHAR2(400)\nKUN_ZUSATZ_DATUM    DATE(7)\nKUN_COMMENT         VARCHAR2(4000)\nKUN_EVT_SMS         VARCHAR2(80)\nKUN_EVT_E_MAIL  VARCHAR2(240)\nKUN_COMMENT2    VARCHAR2(4000)\nKUN_AKTIV_BIS   DATE(7)\nKUN_FLG_AGB         VARCHAR2(4)\nKUN_TITEL           VARCHAR2(200)\n</code></pre>\n\n<p>Thank you in advance for clues.</p>\n\n<p>Greetings</p>\n\n<p>R. Bada</p>\n"},{"tags":["mysql","performance","query","order"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12952903,"title":"MySQL ORDER BY - Slowing Down Query","body":"<p>Question pertains to a listing site that holds listing data and lead data in two tables.  When doing a query for listings and total number of leads for each listing, the results are extremely slow after adding an ORDER BY. Without the ORDER BY, the results are retrieved very fast.  Any advice or help with restructuring the query below would be awesome!! Fyi, there are 20k listings and 100k leads.</p>\n\n<pre><code>SELECT ls.*, IFNULL(ld.total_leads, 0) AS total_leads\nFROM listing ls \nLEFT JOIN (SELECT listing_id, COUNT(listing_id) AS total_leads \n            FROM lead GROUP BY listing_id) ld\nON (ls.listing_id = ld.listing_id)\nORDER BY ls.listing_id DESC LIMIT 0,20\n</code></pre>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12951690,"title":"Create INSERT statement using parameter","body":"<p>I need to create a INSERT statement using parameters. Say I have two variable name <code>@DestinationFields</code>, <code>@InsertValues</code>.</p>\n\n<p>Here <code>@DestinationFields</code> contain the column name like: <code>product,price</code> and <code>@InsertValues</code> contains the values for those two columns, like: <code>Book,100</code>. </p>\n\n<p>Now, How i create a insert command to insert those values where each value need to add a quotation mark .I already tried as </p>\n\n<p>I already tried as </p>\n\n<pre><code>EXEC('INSERT into tbl_test('+@DestinationFields+')values('+@InsertValues+')')\n</code></pre>\n\n<p>But it's returning an error.</p>\n\n<blockquote>\n  <p><em>The name \"book\" is not permitted in this context. Valid expressions are constants, constant expressions, and (in some\n  contexts) variables. Column names are not permitted.</em></p>\n</blockquote>\n\n<p>How do I do it? Thanks in advance.</p>\n"},{"tags":["query","syntax","solr","lucene"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12937432,"title":"How do I query a range and a missing in one lucene query?","body":"<p>The query:</p>\n\n<pre><code>start: [ 2012101700 TO * ] OR end: [* TO 2012101700]\n</code></pre>\n\n<p>will give me the result where the start is after today or the end is before today.</p>\n\n<p>This query will give me all the records with missing start or ends:</p>\n\n<pre><code> -(end: [ * TO *] OR start: [* TO *])\n</code></pre>\n\n<p>(<em>The strange bracketing is due to oddities in the query parser, see: <a href=\"http://stackoverflow.com/q/12935540/442351\">Solr query with grouping not working</a></em>)</p>\n\n<p>However, I want to combine these so that my results are all the records with results in the defined range or missing completely.  This query doesn't work though as the [* TO *] spoils it.</p>\n\n<pre><code>(end: [ * TO 2012101700] OR start: [2012101700 TO *])\n OR -(end: [ * TO *] \n OR start: [* TO *])\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>Thanks</p>\n\n<p>Dave</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":12931709,"title":"How to store data pairs in a mysql database?","body":"<p>I have to store a big amount of data pairs. Data pairs are in the form:</p>\n\n<blockquote>\n  <p>parameter = value</p>\n</blockquote>\n\n<p>and are related to a container. It's similar to a INI file. For example, I have a container that have these values:</p>\n\n<pre><code>p1 = 32\np2 = \"hello world\"\np3 = -54\n</code></pre>\n\n<p>and another one that have:</p>\n\n<pre><code>p1 = 32\np2 = 36\np5 = 42\np6 = \"bye\"\n</code></pre>\n\n<p>There is an undefined number of parameters per container. The values are numbers or strings of any length (numbers can be converted to strings). Data retrieval is made by parameter name (<em>\"all p1 values\"</em>) or value (<em>\"a 'p6' parameter with the value 'bye'\"</em>). The database will contain milions of pairs. Inserts and reads will be made very often and will be rare to delete or update a record.</p>\n\n<p>My first attempt has been make two tables. First one like this:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `container` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  OTHER CONTAINER INFO\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;\n</code></pre>\n\n<p>where <code>id</code> will be used in another table that contains the pairs:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `data` (\n  `container` int(11) NOT NULL,\n  `name` varchar(64) COLLATE utf8_unicode_ci NOT NULL,\n  `value` text COLLATE utf8_unicode_ci NOT NULL,\n  KEY `container` (`container`),\n  KEY `name` (`name`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;\n</code></pre>\n\n<p>Adding the data:</p>\n\n<pre><code>INSERT INTO `container` (`id`) VALUES ('1'), ('2');\nINSERT INTO  `data` (`container`, `name`, `value`) VALUES \n     ('1',  'p1',  '32'), \n     ('1',  'p2',  'hello world'), \n     ('1',  'p3',  '-54'), \n     ('2',  'p1',  '32'), \n     ('2',  'p2',  '36'), \n     ('2',  'p5',  '42'), \n     ('2',  'p6',  'bye');\n</code></pre>\n\n<p>It works, but it's not very \"usable\" and fast. For instance, if I need to find all parameters from each container that has a <code>p1=32</code> I have to make two SQL queries, first:</p>\n\n<pre><code>SELECT id FROM  `container` WHERE id IN (\n   SELECT container\n   FROM DATA WHERE name =  'p1'\n  AND value =  '32')\n</code></pre>\n\n<p>and then for each container <code>id</code> get all data:</p>\n\n<pre><code>SELECT * FROM  `data` WHERE container = '$id'\n</code></pre>\n\n<p>and then make a post-processing via PHP because it returns a table like this:</p>\n\n<pre><code>container   name    value\n    1       p1      32\n    1       p2      hello world\n    1       p3      -54\n</code></pre>\n\n<p>(post-processing is just a couple of calls to array_* functions, but it makes slower the processing).</p>\n\n<p>I've been testing with a database that contains 50000 data pairs and listing all the records using this procedure takes more than 5 seconds. The question is: how to store this kind of data? or how to improve the performance of my implementation?</p>\n\n<p><strong>NOTE</strong>: The problem is not the first SQL query (0'003 seconds) or the second one (0'002 seconds each one). The problem is to make a SQL query for each result of the first SQL sentence!!</p>\n\n<p><strong>NOTE 2</strong>: The goal is to have a PHP array that contains each result and for each result an  associative array with pairs key-value. The result for a <code>print_r</code>:</p>\n\n<pre><code>Array\n(\n    [1] =&gt; Array\n        (\n            [p1] =&gt; 32\n            [p2] =&gt; hello world\n            [p3] =&gt; -54\n        )\n    [2] =&gt; Array\n        (\n            [p1] =&gt; 32\n            [p2] =&gt; 36\n            [p5] =&gt; 42\n            [p6] =&gt; bye\n        )\n)\n</code></pre>\n\n<p>And, of course, the data structure I have shown here is my first attempt, I'm researching, that's not a production, so I can change, no problem at all.</p>\n"},{"tags":["database","query","sql-server-2005"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12914499,"title":"ROW_NUMBER() without over in SQL","body":"<p>Is there any way to use <code>ROW_NUMBER()</code> in SQL without using <code>OVER</code>, because I want to use sorting. </p>\n\n<p>I have a Grid with multiple sortable columns with configurable rows. In my scenario order by is variable that's why I am not able to put order by using ROWNUM.</p>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":53,"score":-1,"question_id":12950300,"title":"How to use for loop in mongodb","body":"<p>I need to insert a new field(column) to mongodb collection which has now 5246 documents. The field should be auto incremented . So that i use an for loop . My query is as follows `</p>\n\n<pre><code>for(i=1;i&lt;=5246;i++) {\n    db.coll.update({},{$set:{\"new_field\":i}},false,true)\n}; \n</code></pre>\n\n<p>But my bad the output is as, </p>\n\n<pre><code>{new_field:5246},{new_field:5246},{new_field:5246},.......\n</code></pre>\n\n<p>Is there any problem with query..?.</p>\n"},{"tags":["vb.net","query","odata"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":5792232,"title":"List of Titles for John Wayne","body":"<p>I know that there is another question similar to this, but none of the answers worked for me.  this is what I have been trying:</p>\n\n<pre><code>        cat = (From t In catalog.Titles.Expand(\"Cast\")\n               Where t.Name.Contains(\"John Wayne\")\n               Select t)\n\n        for each c in cat\n           listbox.items.add(c.titles)\n        next\n</code></pre>\n\n<p>I've tried all the different combinations, and always get some sort of error.\nAll I want to return is all the titles that John Wayne has been in.</p>\n"},{"tags":["sql-server-2008","query","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12919949,"title":"How to group by SqlFunction with VarArgsSQLFunction in NHibernate","body":"<p>I'm trying to implement the following SQL query with QueryOver:</p>\n\n<pre><code>SELECT [Time]/1000\nFROM TableName\nGROUP BY [Time]/1000\n</code></pre>\n\n<p>Here's my current attempt:</p>\n\n<pre><code>var result = session\n    .QueryOver&lt;TableName&gt;\n    .Select(Projections.GroupProperty(\n        Projections.SqlFunction(\n            new VarArgsSQLFunction(\"(\", \"/\", \")\"),\n            NHibernateUtil.Int64,\n            Projections.Property(\"Time\")\n            Projections.Constant(1000))\n    ))\n    .List&lt;object&gt;();\n</code></pre>\n\n<p>Unfortunately I get the following exception (GenericADOException):</p>\n\n<pre><code>could execute query\n[ SELECT (this_.Time/@p0) as y0_ FROM [TableName] this_ GROUP BY (this_.Time/?) ]\n</code></pre>\n\n<p>And the inner exception:</p>\n\n<pre><code>Incorrect syntax near ?.\n</code></pre>\n\n<p>I can replace the \"GroupProperty\" with a \"Sum\" and it works. Any idea what's missing?</p>\n\n<hr>\n\n<p><strong>Update</strong>:\nApparently it's a bug in NHibernate. See also <a href=\"http://stackoverflow.com/questions/10696539/incorrect-syntax-near-nhibernate-generated-query\">this question</a>.</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":12847704,"title":"sql concat query does not working correctly","body":"<p>SQL concat query does not working correctly</p>\n\n<pre><code>UPDATE product\nSET    pimg_mid1=concat('.jpg', pimg_mid1) \nWHERE  pid&gt;=21\n</code></pre>\n\n<p>The table column is named by <code>img_mid1</code> and currently it contains <code>xxxxx</code> type values after 21 rows (21 rows are correct). But required is <code>xxxxx.JPG</code>.</p>\n\n<p>All the row except the top 21 are incorrect. These rows should named <code>xxxxx.JPG</code> (postfix .JPG)</p>\n\n<p>What would be the right sql query?</p>\n"},{"tags":["javascript","query","sql-update","google-fusion-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":11866366,"title":"Google Fusion Table Javascript UPDATE Query?","body":"<p>I have looked everywhere for a way to update a Google Fusion table using an UPDATE query from a javascript. All I need to do is update one column with an array that is generated from the code itself, after the fusion table information is read and processed. I do not need the user to update the table. </p>\n\n<p>Is there a way to do this using Javascript alone? Or do I really need a combination of OAuth 2.0 and php? Is there a working example of this? All I find is extremely vague or fragmentary. </p>\n\n<p>Thank you.</p>\n"},{"tags":["php","database","arrays","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":47,"score":-3,"question_id":12946231,"title":"PHP selecting from database","body":"<p>I'm having trouble selecting data from inside one of the tables in the database.</p>\n\n<p>I'm trying to display a user's profile when their name is clicked on.</p>\n\n<pre><code>&lt;?php\n    $view = mysql_fetch_array(mysql_query(\"select * from users where id=$view\"));\n    if (empty ($view[id])) {\n    print \"No such user.\";\n    exit;\n    }\n    print \"&lt;center&gt;&lt;b&gt;&lt;u&gt;$view[user]&lt;/b&gt;&lt;/u&gt; ($view[id])&lt;/center&gt;&lt;br&gt;\";\n    print \"Rank: $view[rank]&lt;br&gt;\";\n?&gt;\n</code></pre>\n\n<p>The link they will click is:</p>\n\n<pre><code>viewpage.php?page_id=4&amp;view=....\n</code></pre>\n\n<p>I can't get this to work.</p>\n"},{"tags":["sql-server","query","reporting-services"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12918936,"title":"Improve performance that uses isnull in a where clause","body":"<p>There is a report whose query is using isnull in the where clause and it's causing some performance issues. \nHere is a very simplified example. \n<a href=\"http://www.sqlfiddle.com/#!6/79759/11\" rel=\"nofollow\">http://www.sqlfiddle.com/#!6/79759/11</a></p>\n\n<p>The query is using a multi-valued parameter, usually just returning one or two values. (I've tried to replicate the SSRS multi-value param using a table variable in sqlfiddle)</p>\n\n<pre><code>select \n  isnull(descrL,descr) as division,\n  product\nfrom Upper\nleft join Lower on product = productL\nwhere isnull(DescrL,Descr) in (@params)\n</code></pre>\n\n<p>There is an Upper division that has all the products. Some of the products exist on a child  division. If it exists in the lower division, that is the division that should be shown.</p>\n\n<p>The company parameter can accept the upper division, lower division, or both.</p>\n\n<p>Any ideas on how the query can be changed for better performance?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12851094,"title":"How can I write this MySQL query?","body":"<p>We have a system where users send in bags of goods to us.</p>\n\n<p>I am trying figure out how to pull users with a calculated field for the date they sent their 3rd bag of goods.  The state on the history table that would indicate this event is \"processed\".  If I wanted to just get the received date for a particular bag I would write:</p>\n\n<pre><code>SELECT bags.created_at FROM history \nWHERE history.state='received' AND history.bag_id LIMIT 1\n</code></pre>\n\n<p>Here are our tables:</p>\n\n<pre><code>users\n  id\n\nbags\n  user_id\n\nhistory\n  state\n  bag_id\n  created_at\n</code></pre>\n\n<p>The end goal is a select query that gives us user records and adds the \"field\" 3rd_bag_received_at</p>\n\n<p>Any ideas?</p>\n"},{"tags":["query","google-api","spreadsheet","google-spreadsheet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12942754,"title":"google spreadsheet: query in a script","body":"<p>Hy,\nmy question is:\nI'm working with spreadsheet of google.\nI'd like to insert query into a script.\nIs it possible?</p>\n\n<p>I need create a spreadsheet in which runs a query to create an effect \"post card\" (name of a people and salary in different years).</p>\n\n<p>I rescue to do it in a cell for only a man:</p>\n\n<pre><code> query(sheet1!1:100; \"select I, J,K, G, sum(H), F, L where B contains \"\"\"&amp;A6&amp;\"\"\" group by B,I, J, K, G, F, L \")  \n</code></pre>\n\n<p>\"\"\"&amp;A6&amp;\"\"\" is a cell in which i put a name.</p>\n\n<p>I need to do it for all my collegues (30) in a script.</p>\n\n<p>thanks</p>\n"},{"tags":["query","google-apps-script"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12943181,"title":"Query variable arrays","body":"<p>How do I use an array variable as a query argument instead of the literal array itself?</p>\n\n<p>For example, the documentation mentions the following:</p>\n\n<pre><code>var result = db.query({name: db.anyOf(['fred', 'barney', 'mark']});\n</code></pre>\n\n<p>But instead, I wish to do this:</p>\n\n<pre><code>var myTeam = [\"fred\",\"barney\",\"mark\"];\nvar result = db.query({name: db.anyOf(myTeam)});\n</code></pre>\n\n<p>So far, I have not been successful.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12921894,"title":"sql server 2008 query inline","body":"<p><code>select devicename, name, value, timestamp from table1</code> gives me the following,</p>\n\n<pre><code>DEVICENAME     NAME     VALUE    TIMESTAMP\n123            CURRENT  130      2012-10-16 13:00:00.000\n123            AVG      140      2012-10-16 13:00:00.000\n123            MIN      100      2012-10-16 13:00:00.000\n123            MAX      160      2012-10-16 13:00:00.000\n</code></pre>\n\n<p>How do i get them like this in sql query,</p>\n\n<pre><code>123, 130, 140, 100, 160 2012-10-16 13:00:00.000\n</code></pre>\n"},{"tags":["sql","database","oracle","query","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":166,"score":1,"question_id":12921792,"title":"Oracle database search all tables for string, return row data","body":"<p>I need to search all tables in an oracle database for a specific string and return all the records where that string is found. I am working with SQL Developer. There are several really useful scripts and stored procedures that have been posted online that provide a way to search the entire database and they all seem to be able to return the table name and the column name where the string is found. I actually want to see the rows like a select * statement but I would like it to be for all the tables in my database. I want to note that I am very much a beginner and I'm not familiar with advanced PL/SQL scripting and database concepts so though I've tried and tried I can't seem to figure it out so any input would be appreciated.</p>\n\n<p>Here is a script that I was trying to modify (someone else's solution)</p>\n\n<pre><code>declare\n l_count number := 0;\n l_str varchar2(20) := '%test%';\nbegin\n for rec in (select table_name, column_name\n             from user_tab_columns\n             where data_type in ( 'VARCHAR2' , 'VARCHAR', 'CHAR' ) ) loop\n  execute immediate 'select count(*) from '||rec.table_name||\n                ' where '||rec.column_name||' like '''||l_str||'''' into l_count;\n  if l_count &gt; 0 then\n   dbms_output.put_line('Table : '||rec.table_name||'  '||rec.column_name);\n  end if;\n end loop;\nend;\n/\n</code></pre>\n"},{"tags":["php","mysql","sql","query","rows"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":12937213,"title":"mysql_fetch_row() not a valid result resource","body":"<p>I am confused, I don't know what's wrong. I'm about to transfer all data from my first table to the other. Here is my code:</p>\n\n<pre><code>$getdata = mysql_query(\"SELECT Quantity, Description, Total FROM ordercart\");\n\nwhile($row = mysql_fetch_row($getdata))\n{\nforeach($row as $cell){\n\n$query1 = mysql_query(\"INSERT INTO ordermem (Quantity, Description, Total) VALUES \n($cell)\",$connect);\n\n}\nmysql_free_result($getdata);\n}\n</code></pre>\n\n<p>I get the error: Warning: mysql_fetch_row(): 5 is not a valid MySQL result resource.</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12905778,"title":"Converting numbers to text from mysql in PHP","body":"<p>In my MYSQL database I have many headers to columns that are in this format- <code>2345X32X12.......</code> <code>2345=survey id, 32=page id, 12= question id.</code>..</p>\n\n<p>Under each header contains the question of that specific ID set. With PHP I am trying to grab the text of each question of each ID set to place in a csv file. </p>\n\n<p>Right now when I open my csv file from my web server, I get that format as the headers <code>(2345X32X12)</code> in the columns of an excel file; </p>\n\n<p>I want to get the question under each column to look like this - What is your age?.........I hope this makes sense</p>\n\n<p>In another table in my database the numbered headers define the question-in A1: 2345X32X12 B1: What is your age?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>&lt;?php\n// connection with the database \n//$sid =$_SESSION['sid'];\n//echo $sid;\n$id=$_GET['sid']; \necho $id;\n\n$dbhost= \"\"; //your MySQL Server \n$dbuser = \"\"; //your MySQL User Name \n$dbpass = \"\"; //your MySQL Password \n$dbname = \"y\";    \n$link = mysql_connect($host, $user, $pass);\nmysql_select_db($dbname); \n$tablename = \"survey_\".$id; // this is the tablename that you want to export to csv from mysql. \n$sql = \"Select * from $tablename\"; \n//create  code for connecting to mysql \n$Connect = @mysql_connect($dbhost, $dbuser, $dbpass) \nor die(\"Couldn't connect to MySQL:&lt;br&gt;\" . mysql_error() . \"&lt;br&gt;\" . mysql_errno()); \n//select database \n$Db = @mysql_select_db($dbname, $Connect) \nor die(\"Couldn't select database:&lt;br&gt;\" . mysql_error(). \"&lt;br&gt;\" . mysql_errno()); \n//execute query \n$result = @mysql_query($sql,$Connect) \nor die(\"Couldn't execute query:&lt;br&gt;\" . mysql_error(). \"&lt;br&gt;\" . mysql_errno()); \n\n\nexportMysqlToCsv($tablename);\nfunction exportMysqlToCsv($tablename,$filename = 'Results.csv'){\n    $sql_query = \"select * from $tablename where id=2\";\n    // Gets the data from the database\n\n    $result = mysql_query($sql_query);\n\n    $f = fopen('php://temp', 'wt');\n    $first = true;\n\n    while ($row = mysql_fetch_assoc($result)) {\n\n        if ($first) {\n\n            fputcsv($f, array_keys($row));\n\n            $first = false;\n }\n  fputcsv($f, $row);\n\n    } // end while\n\n    $size = ftell($f);\n    rewind($f);\n    header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n    header(\"Content-Length: $size\");\n\n // Output to browser with appropriate mime type, you choose ;)\n    header(\"Content-type: text/x-csv\");\n    header(\"Content-type: text/csv\");\n    header(\"Content-type: application/csv\");\n    header(\"Content-Disposition: attachment; filename=$filename\");\n\n    fpassthru($f);\n\n    exit;\n}\n\n?&gt; \n</code></pre>\n"},{"tags":["query","data","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":11849425,"title":"Read all data from all databases in my server","body":"<p>I'm working with sql server 2000, and I need to read all data  from all databases\n  in my server, because then I will work with some data, how can I make ths query? \n  I´ll tryied this code, but doesn´t works as I want.</p>\n\n<pre><code>ALTER  PROCEDURE TMP_INGRESO_MASIVO_DAT_CLIENTES AS\n\ndeclare @Fila as int\ndeclare @Script_Dinamico as varchar(8000)\ndeclare @Script_Dinamico1 as varchar(8000)\ndeclare @Nro_Registros as int\n\nSelect Distinct  cod_empresa,Nombre_Base Into #Tmp_Bases1 From Estadistica_Cobranza.Dbo.Sis_Conexion_pagos Where Cod_Estado = 1 and Proc_Automaticos= 1--capturo nombre BD\nSelect Distinct  Identity(Int,1,1) As Fila, cod_empresa , Nombre_Base As Name  Into #Tmp_Bases From #Tmp_Bases1\n\n    Drop table #Tmp_Bases1\n    Select @Fila = 1\n    Select @Script_Dinamico = ''\n    Select @Script_Dinamico1 = ''\n    Select @Nro_Registros  =  (Select Count (*) From  #Tmp_Bases ) + 1--cantidad de filas  +1\n\n\n\n\n\n    While @Fila &lt; = @Nro_Registros \nBegin\n    Print(@Script_Dinamico)\n\nSelect @Script_Dinamico = 'INSERT INTO buc.dbo.tmp_DAT_CLIENTES '\nSelect @Script_Dinamico = @Script_Dinamico +'(COD_EMPRESA,'\nSelect @Script_Dinamico = @Script_Dinamico +'COD_SUCURSALEMPRESA,'\nSelect @Script_Dinamico = @Script_Dinamico +'RUT_CLIENTE,'\nSelect @Script_Dinamico = @Script_Dinamico +'RAZON_SOCIAL, '\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_CARGA,'\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_MODIFICACION'\nSelect @Script_Dinamico = @Script_Dinamico +')'\nSelect @Script_Dinamico = @Script_Dinamico +'Select '\nSelect @Script_Dinamico = @Script_Dinamico +'COD_EMPRESA, '\nSelect @Script_Dinamico = @Script_Dinamico +'COD_SUCURSALEMPRESA, '\nSelect @Script_Dinamico = @Script_Dinamico +'RUT_CLIENTE, '\nSelect @Script_Dinamico = @Script_Dinamico +'RAZON_SOCIAL, '\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_CARGA, '\nSelect @Script_Dinamico = @Script_Dinamico +'FECHA_MODIFICACION'\nSelect @Script_Dinamico = @Script_Dinamico + ' from ' + (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES '\nSelect @Script_Dinamico = @Script_Dinamico  + 'Where ' + (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES.cod_empresa =  '+ convert(varchar,(Select cod_empresa  From #tmp_bases  Where Fila = @Fila))\nSelect @Script_Dinamico = @Script_Dinamico  +'and '+ (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES.rut_cliente not in (select RUT_CLIENTE from tmp_dat_clientes'\nSelect @Script_Dinamico = @Script_Dinamico+' where '+ (Select Name  From #tmp_bases  Where Fila = @Fila) +'.Dbo.DAT_CLIENTES.rut_cliente = buc.dbo.tmp_DAT_CLIENTES.RUT_CLIENTE )'\n\n\n\n\n\n\n\n\n            Print ( @Script_Dinamico)\n            Exec (@Script_Dinamico )\n            Select  @Fila = @Fila +1\n            Select @Script_Dinamico = ''\n            Select @Script_Dinamico1 = ''\n\n\n\nEnd\nDrop Table #Tmp_Bases\n\nGO\nSET QUOTED_IDENTIFIER OFF \nGO\nSET ANSI_NULLS ON \nGO\n</code></pre>\n\n<p>thanks in advance.</p>\n"},{"tags":["java","query","parent-child","rally"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12697477,"title":"How to check the folders relationship toeach other in Rally using Java API","body":"<p>I am trying to use the <code>\"Parent\"</code> attribute of a folder inside the <code>\"QueryFilter\"</code> as shown:</p>\n\n<pre><code>myFolder.setQueryFilter(new QueryFilter(\"TestFolder.Name\", \"=\", foldername)\n    .and(new QueryFilter(\"Parent\", \"=\", ??????)));\n</code></pre>\n\n<p>I am trying to check whether this folder is a subfolder of another folder. </p>\n\n<p>I dont know what to put instead of <code>??????</code>.</p>\n\n<p>UPDATE: \nI am using following code but its throwing a nullpointer exception. I am trying to query for a parent folder, so I am putting Parent as null. I dont know if I should get nullpointer exception. If yes, how should I handle it?</p>\n\n<p>QueryRequest parent1 = new QueryRequest(\"TestFolder\");</p>\n\n<p>parent1.setFetch(new Fetch(\"Name\",\"Project\"));</p>\n\n<p>parent1.setQueryFilter(new QueryFilter(\"name\", \"=\", foldername).and(new \nQueryFilter(\"Parent\", \"=\", null)).and(new QueryFilter(\"Project\", \"=\", proj_ref)));</p>\n\n<p>QueryResponse parent2 = batman.query(parent1);</p>\n\n<p>parent_ref = parent2.getResults().get(0).getAsJsonObject().get(\"_ref\").getAsString();</p>\n\n<p>System.out.println(\"Parent ref: \"+parent_ref);</p>\n\n<p>System.out.println(\"Parent folder already exists.\");</p>\n\n<p>Thanks.</p>\n"},{"tags":["query","list","contains","sparql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12920215,"title":"How do I match records which have a certain entry IN their rdfs:label attribute?","body":"<p>I'm trying to query dbpedia for programming languages like D by name:</p>\n\n<p><a href=\"http://dbpedia.org/page/D_%28programming_language%29\" rel=\"nofollow\">http://dbpedia.org/page/D_(programming_language)</a></p>\n\n<p>And I figure <code>rdfs:label</code> is a good way to do this. But I'm having trouble coming up with syntax for searching by labels containing \"D (programming language)\". In dpbedia, <code>rdfs:labels</code> aren't simply strings, they're more like lists. How do I filter for records that have a certain entry IN the <code>rdfs:label</code>?</p>\n"},{"tags":["query","ms-access","date","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12929085,"title":"Access 2007 query to capture records that encompass 2 dates","body":"<p>I'm working on a query to get records based on two dates, start and end dates.</p>\n\n<p>What I need to obtain are records that are span some or all of the given period, in other words the start date maybe before the parameter date but less than the end date or start after the start date and end after the end date.</p>\n\n<p>I.e. Start date = 01 Oct 12 and end date 31 Oct 12. I would like to capture records where start date is before 1 Oct but spans this period whether it finishes in November or mid October. As well as records that are between 01 Oct 12 and 31 Oct 12.</p>\n\n<p>In reality I need the records that exclude this period, but first need to make sure I'm getting this dataset correct.</p>\n"},{"tags":["sql","sql-server","database","query","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12937829,"title":"Database engineering: Many Rows or extra backup columns for a scenario like Extendable Profile Table","body":"<p>I have a decision to make for a database with up to 20,000+ student profiles, Each student profile have more than 120+ Property, </p>\n\n<p>In many Enterprise projects like DOTNETNUKE CMS, the used method is two tables, one is\nUserProfile :</p>\n\n<pre><code>[ProfileID],[UserID],[PropertyDefinitionID],[PropertyValue]\n</code></pre>\n\n<p>and the other is : ProfilePropertyDefinition</p>\n\n<pre><code>[PropertyDefinitionID],[DataType] ,[PropertyCategory],[PropertyName]\n</code></pre>\n\n<p>If i used this method i will have 20,000 x 120 = 2.4 million row!</p>\n\n<p>I know this is the correct way, to have a normalized database, and I know, the Database servers were created to handle millions of records, but i am wondering, why don't we create one profile table with 120 column + enough backup columns for the extensibility? If the performance is important, Does it more harm than good? </p>\n"},{"tags":["oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":83,"score":4,"question_id":12922889,"title":"Substring inside string","body":"<p>Suppose this is my table:</p>\n\n<pre><code>ID  STRING\n1   'ABC'\n2   'DAE'\n3   'BYYYYYY'\n4   'H'\n</code></pre>\n\n<p>I want to select all rows that have at least one of the characters in the STRING column somewhere in another row's STRING variable.</p>\n\n<p>For example, <code>1</code> and <code>2</code> have an <code>A</code> in common and <code>1</code> ad <code>3</code> have a <code>B</code> in common, but <code>4</code> does not have any characters in common with any of the other rows. So my query should return only the first three lines.</p>\n\n<p>I don't need to know with which line it matched.</p>\n\n<p>Thanks!</p>\n"},{"tags":[".net","sql","query","tsql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12924154,"title":"Difficult T-SQL Join/Pivot","body":"<p>The original way I worded this question would be unhelpful to most, so I've reworked it significantly.</p>\n\n<p>I have a legacy database, whose schema <strong>I have no control over</strong> (nor ever have). The db schema was designed agnostic of the provider for consumption by unmanaged C++, so there are no FK constraints, etc. I come along and need to consume this from .NET, and also need to present the data much differently than it was originally intended.</p>\n\n<p>Here is the schema of the relevant tables (I've bolded/asteriskifed what amount to the keys for this question):</p>\n\n<pre><code>CREATE TABLE [dbo].[Formats](\n[GroupName] [varchar](255) NOT NULL,\n**[BatchID] [bigint] NOT NULL,**\n[SeriesNumber] [bigint] NOT NULL,\n**[SequenceID] [bigint] NOT NULL,**\n[SeqNum] [int] NOT NULL,\n[FormatName] [varchar](50) NOT NULL\n\nCREATE TABLE [dbo].[Fields](\n[GroupName] [varchar](255) NOT NULL,\n**[BatchID] [bigint] NOT NULL,**\n**[SequenceID] [bigint] NOT NULL,**\n[SeqNum] [int] NOT NULL,\n**[FieldName] [varchar](50) NOT NULL,**\n[FieldDisplayName] [varchar](50) NOT NULL,\n[FieldValue] [ntext] NULL\n</code></pre>\n\n<p>There is a 1:Many relationship between Formats:Fields.</p>\n\n<p>I need to query for a list of format rows. The challenges are several:\n   + There is a compound foreign key.\n   + I need to filter the formats to a subset that contains related Fields.\n   + The related fields must match an arbitrary number of filter criteria before being inner-joined to the formats.</p>\n\n<p>So to walk through this:\nThe Stored Proc receives the following table valued parameter:</p>\n\n<pre><code>_FieldDisplayName_  Field_Value\n Field 1             001\n Field 2             002\n</code></pre>\n\n<p>It then needs to filter the Fields table by those values.</p>\n\n<p>Since I needed to use ALL of the criteria and not just one of them, I did not know how work with this to retrieve something useful to join with, when I didn't know how many values I'd have, or what the FieldDisplayName values would be.</p>\n\n<p>@Joe Phillips was smart enough to see through the chaos and suggest that I needed to pivot the table. That's this:</p>\n\n<p><strong>Edit:</strong>\nThe following is working to pivot the data, but I am not sure it is ideal. Still waiting on other ideas before supplying an answer.</p>\n\n<p>Instead of using a TVP, I'm using a temp table and dynamic SQL (and yes, I see the injection vulnerability):</p>\n\n<pre><code>IF OBJECT_ID('[tempdb].[dbo].[#FilterFields]') is not null\nDrop Table dbo.#FilterFields\n\nCREATE Table #FilterFields (FieldDisplayName varchar(50), FieldValue nvarchar(max))\n/* Just some example data */\nINSERT INTO #FilterFields (FieldDisplayName, FieldValue) VALUES ('PTNUM', '011')\nINSERT INTO #FilterFields (FieldDisplayName, FieldValue) VALUES('SITENUM', '001')\n\nDeclare @column_names varchar(max)\nDeclare @dynamic_pivot_query as varchar(max)\n\nSELECT @column_names = Stuff((SELECT DISTINCT ',[' + FieldDisplayName + ']'\n                FROM #FilterFields FOR xml path('')),1,1,'')\n\nPRINT(@column_names)    \n\nSET @dynamic_pivot_query =\n'select * ' +\n'from tempdb.dbo.#FilterFields ' +\n'Pivot\n(\nMIN(\n    FieldValue\n    )\nFOR FieldDisplayName IN (' + @column_names + ')\n) as P'\n\nPRINT(@dynamic_pivot_query)\nEXEC(@dynamic_pivot_query)\n</code></pre>\n"},{"tags":["mysql","query","group-by","sql-order-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12936871,"title":"MySQL use of GROUP BY and ORDER BY","body":"<p>I have a table of people, each one has the <em>number of visits</em> and the <em>priority</em>:</p>\n\n<pre><code>ID | NAME          |  VISITS | PRIORITY\n---------------------------------------\n 1 |     John      |    1    |   0\n 2 |     Joe       |    2    |   1\n 3 |     Peter     |    1    |   1\n 4 |     Sara      |    0    |   2  \n 5 |     Phillip   |    5    |   0\n 6 |     Bob       |    3    |   1\n 7 |     Andrew    |    4    |   2\n</code></pre>\n\n<p>There are only certain allowed priorities: (0,1,2) </p>\n\n<p><strong>How do I create a query which gives me people ordered by the number of visits (starting from the lowest) but within their corresponding priority groups?</strong> </p>\n\n<p>So the result should look like this:</p>\n\n<pre><code>ID | NAME          |  VISITS | PRIORITY\n---------------------------------------\n 1 |     John      |    1    |   0\n 2 |     Philip    |    5    |   0\n 3 |     Peter     |    1    |   1\n 4 |     Joe       |    2    |   1  \n 5 |     Bob       |    3    |   1\n 6 |     Sara      |    0    |   2\n 7 |     Andrew    |    4    |   2\n</code></pre>\n\n<p>I suppose there has to be some use of the GROUP BY clause, but Im not sure how to use it.</p>\n"},{"tags":["sql","query","report"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12935755,"title":"SQL Report - Group by Query for getting data from 12 months ago (this month included)","body":"<p>So, I found this nice little query:</p>\n\n<pre><code>Select    count(*) \nFROM      Table_X \nWHERE     year(DATE) = '2012' \nGROUP BY  month(DATE)\n</code></pre>\n\n<p>Which does almost exactly what I need.. Except I need to query the data of current month, up until 1 year ago. So for October, sept, aug, jul, jun, may, apr, mar, feb, jan 2012 and dec, nov 2011.. </p>\n\n<p>So I could just wait till the end of december to make the report :) . But there must be some other way?</p>\n"},{"tags":["php","query","mongodb","key"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12935461,"title":"PHP MongoDB Query into an array with an unknown key","body":"<p>I have a mongoDB set up like so:</p>\n\n<pre><code>fieldName: {\n  \"1\": {\n      client: \"name-here\",\n      subfield: \"more-junk-here\"\n   },\n   \"2\": {\n      client: \"another-client-name-here\",\n      subfield: \"more-data\"\n   },\n   \"3\": {\n      client: \"client-num-3\",\n      subfield: \"i-like-turkey-sandwiches\"\n   }\n}\n</code></pre>\n\n<p>How do I query for \"i-like-turkey-sandwiches\", without knowing it's in position 3, and without doing a search of the whole document? I started writing this, but am completely stumped how to do the search...</p>\n\n<pre><code>$cursor = $collection-&gt;findOne(array('fieldName' =&gt; 'i-like-turkey-sandwiches));\n</code></pre>\n"},{"tags":["query","select","sap","abap"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":330,"score":3,"question_id":11623637,"title":"How do I group conditions in a SELECT statement in ABAP?","body":"<p>First off, I have no experience with ABAP, I'm operating on guesswork here.</p>\n\n<p>I want to add a condition to a SELECT in an existing report.\nThe existing code looks like this:</p>\n\n<pre><code>SELECT SINGLE *\n  FROM EKPO\n  WHERE EBELN = GT_MSEG-EBELN\n  AND   EBELP = GT_MSEG-EBELP.\n</code></pre>\n\n<p>I want to add a condition to exclude the record if field F1 is a certain value and field F2 is 0 (both conditions must be true to exclude the record). I've tried this:</p>\n\n<pre><code>SELECT SINGLE *\n  FROM EKPO\n  WHERE EBELN = GT_MSEG-EBELN\n  AND   EBELP = GT_MSEG-EBELP\n  AND NOT (F1 = 'value' AND F2 = '0').\n</code></pre>\n\n<p>I get a syntax error: Field \"F1 = 'value' AND F2 = '0'\" is unknown. It is neither in one of the specified tables nor defined by a \"DATA\" statement.</p>\n\n<p>Fields F1 and F2 definitely exist in the EKPO table, I've checked. It seems that the brackets are making the compiler look at the contents as a field name, but I don't know why.</p>\n\n<p>Is the syntax incorrect, am I missing a definition somewhere, or both?</p>\n"},{"tags":["sql-server","vb.net","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":12934506,"title":"Get one list from two table columns","body":"<p>I have two tables in SQL Server which have two similar columns.</p>\n\n<pre><code> table1 (\n     partID, PartName,  ....\n )\n\n table2 (\n    sekId,  Part2Name, ....\n )\n</code></pre>\n\n<p>I need to populate one combobox in vb.net with the cummulated values of <code>PartName</code> and <code>Part2Name</code> so that the list can appear like being sourced from one single column, because the user might require from either. The combobox must be one that's how the design has it. Is there an SQL statement to sort me out? </p>\n"},{"tags":["sql","sql-server-2008","query","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12933514,"title":"Sorting table data issue","body":"<p>I've quite bulky data in a Database table and I want to sort the data based on their ID (Primary Key). The data in the key column could be:</p>\n\n<pre><code>001/2011,\n002/2011,\n001/2012\n</code></pre>\n\n<p>When I use '<code>order by id</code>' it sorts the rows like</p>\n\n<pre><code>001/2011,\n001/2012,\n002/2011\n</code></pre>\n\n<p>However, what I am looking for is </p>\n\n<pre><code>001/2011,\n002/2011,\n001/2012\n</code></pre>\n\n<p>The data type of the id column is <code>varchar(50)</code>. Is there a special SQL function that I should use to sort such type of data?</p>\n"},{"tags":["mysql","query","count"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12932784,"title":"MySQL - Selecting Count with multiple tables and conditions for each","body":"<p>I am having a rather simple query in mind:</p>\n\n<p>I have three tables and I want to return the count of the rows which are used (have foreign key) of each table.</p>\n\n<p>This was my first attempt:</p>\n\n<pre><code>    SELECT \n        COUNT(at.code) AS atcount, \n        COUNT(de.code) AS decount, \n        COUNT(ch.code) AS chcount \n    FROM \n        table_at at, \n        table_ch ch, \n        table_de de \n    WHERE \n        at.teilnehmerid != 0\n    AND\n        de.teilnehmerid != 0\n    AND\n        ch.teilnehmerid != 0\n</code></pre>\n\n<p>But this somehow does not work, it does not generate any error, but the conditions are just not considered. I also thought about about subqueries, like:</p>\n\n<pre><code>    SELECT \n        (SELECT COUNT(code) FROM table_at at WHERE at.teilnehmerid != 0), \n        (SELECT COUNT(code) FROM table_de de WHERE de.teilnehmerid != 0), \n        (SELECT COUNT(code) FROM table_ch ch WHERE ch.teilnehmerid != 0)\n</code></pre>\n\n<p>But I was confused about something rather stupid with this attempt... what about the <code>FROM</code>?\nOf course I am getting an error: <code>Operand should contain 1 column(s)</code> - but I just want the counts...</p>\n\n<p>I also read about Joins, but did not understand how to get the <code>COUNT</code> via a <code>JOIN</code> inside my main <code>SELECT</code> statement.</p>\n\n<p>And yeah I have read some other questions around here, but did not see an answer applying to both problems:</p>\n\n<ul>\n<li>selecting multiple tables</li>\n</ul>\n\n<p>AND</p>\n\n<ul>\n<li>doing a <code>COUNT</code> on multiple table</li>\n</ul>\n\n<p>If I am wrong and just did not get the answer right, maybe a better explanation would help.</p>\n"},{"tags":["c#",".net","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":107,"score":5,"question_id":12859536,"title":"simple select query in linq","body":"<p>Lets say I have a student table and I want to display the student with ID 1.</p>\n\n<pre><code>SELECT *\nFROM STUDENT ST\nWHERE ST.ID = 1\n</code></pre>\n\n<p>This is how I achive this in Linq.</p>\n\n<pre><code>StudentQuery = from r in oStudentDataTable.AsEnumerable()\n                                     where (r.Field&lt;int&gt;(\"ID\") == 1)\n                                     select r;\n            oStudentDataTable = StudentQuery.CopyToDataTable();\n</code></pre>\n\n<p>but what if I want to display the students with these ids 1,2,3,4,5..</p>\n\n<pre><code>SELECT *\nFROM STUDENT ST\nWHERE ST.ID IN (1,2,3,4,5)\n</code></pre>\n\n<p>How can I achieve this in Linq?</p>\n"},{"tags":["android","sql","database","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12933758,"title":"SQLiteDatabase Query in android","body":"<p>Am having a table <strong>card</strong> with colums <strong>id,name, content,status, date.</strong></p>\n\n<p>i want to take <strong>id,name,content</strong> condition is <strong>status &lt;= cards.STATUS</strong> also have to <strong>sort it by date</strong></p>\n\n<p>How i have to do this.\nam doing like,</p>\n\n<pre><code>private Cursor c;\n\nString[] cols = { id,name, content };\nc = cardsDB.query(CARDS_TABLE_NAME, cols, \"status &lt;=\" + Card.STATUS, null, null, null, \"date desc\");\n\nif (c.moveToFirst()) {\n            do {\n                CardArray.add(new Card(c.getInt(0), c.getInt(1), c.getString(2)));\n            } while (c.moveToNext());\n        }\n        c.close();\n</code></pre>\n"},{"tags":["query","hibernate","many-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12932207,"title":"Hibernate: Inner Join Mapped and Unmapped Table using HibernateTempate","body":"<p>I have the following tables:</p>\n\n<pre><code>USER\n    ID VARCHAR(32) INTEGER NOT NULL\n\nROLE\n    ID INTEGER NOT NULL\n\nUSERROLE /*Many to Many*/\n    USER_ID VARCHAR(32) NOT NULL\n    ROLE_ID INTEGER NOT NULL\n</code></pre>\n\n<p>and I'm using annotations to Map the DB Tables to my Classes.</p>\n\n<pre><code>/* Mapping for USER table */\n@Entity\n@Table (name=\"USER\")\npublic class User{\n    @Id\n    @Column (name=\"ID\")\n    private String id;\n\n    @ManyToMany \n    @JoinTable (name=\"USERROLE\", joinColumns = {@JoinColumn (name=\"USER_ID\")}, \n            inverseJoinColumns = {@JoinColumn (name=\"ROLE_ID\")})\n    @LazyCollection (LazyCollectionOption.FALSE)\n    private List&lt;Role&gt; roles;\n}\n\n/* Mapping for ROLE table */\n@Entity\n@Table (name=\"ROLE\")\npublic class Role {\n    @Id\n    @Column (name=\"ID\")\n    private int id;\n\n}\n</code></pre>\n\n<p>Now I would like to do a query that Joins ROLE and USERROLE tables so that i could get those ROLEs that has user assigned to it.</p>\n\n<p>--EDIT</p>\n\n<p>I have the Role.id, and I want to check whether this Role is being referenced in the USERROLE table. in native SQL, I would do it this way:</p>\n\n<pre><code>SELECT DISTINCT A.* from ROLE A INNER JOIN USERROLE B \nWHERE A.ID = B.ROLE_ID AND A.ID = ?;\n</code></pre>\n\n<p>how to do it in hibernate using HibernateTemplate?</p>\n"},{"tags":["php","database","query","codeigniter","fatal-error"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":12931555,"title":"Codeigniter Fatal error: Call to a member function query() on a non-object","body":"<p>Now I am learning Codeigniter. I have more databases, so I choosed this time Anketa one.\nWhy is error :</p>\n\n<pre><code>**Fatal error: Call to a member function query() on a non-object in /var/www/domains/svastara/application/controllers/anketa.php on line 12** ???\n</code></pre>\n\n<p>I chacked, the user and pass in database is ok, database is loaded in conf, and chacked the table name. So what more?</p>\n\n<pre><code>$this-&gt;db = $this-&gt;load-&gt;database('anketa');\n\n        $q = $this-&gt;db-&gt;query(\"SELECT * FROM anketaip\");\n\n        if($q-&gt;num_rows()&gt;0){\n        foreach ($q-&gt;result() as $row)\n        {\n            $data[] = $row;\n        }\n\n        }return $data;\n\n        $this-&gt;load-&gt;view('anketa_nova', $data);\n</code></pre>\n"},{"tags":["mysql","sql","query","select"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":12893233,"title":"mysql select from different tables with if clause","body":"<p><strong>table: user</strong> </p>\n\n<pre><code>| userid | fullname |\n|   1    |  admin   |\n|   2    |  jimmy   |\n|   3    |  anton   |\n|   4    |  steven  |\n</code></pre>\n\n<p><strong>table: maschinen</strong>    </p>\n\n<pre><code>| maschine | maschine-name |\n|    1     |       M1      |\n|    2     |       M2      |\n|    3     |       M3      |\n|    4     |       M4      |\n</code></pre>\n\n<p><strong>table:    vorrichtungen</strong></p>\n\n<pre><code>| id | maschine | vorrichtung | createdby |      datecreated    | updatedby |     dateupdated     |\n| 1  |    1     |    11111    |     1     | 2012-06-23 17:10:25 |     1     | 2012-06-23 18:15:20 |\n| 2  |    1     |    22222    |     1     | 2012-06-25 07:50:49 |     0     | 0000-00-00 00:00:00 |\n| 3  |    2     |    33333    |     2     | 2012-06-27 10:22:29 |     0     | 0000-00-00 00:00:00 |\n| 4  |    3     |    44444    |     2     | 2012-06-28 09:41:27 |     1     | 2012-06-28 12:40:37 |\n| 5  |    4     |    11111    |     3     | 2012-06-29 15:53:47 |     0     | 0000-00-00 00:00:00 |\n| 6  |    4     |    33333    |     4     | 2012-06-29 22:30:02 |     2     | 2012-06-29 22:30:02 |\n</code></pre>\n\n<p><strong>my query looks like this:</strong>       </p>\n\n<pre><code>SELECT\n    vorrichtungen.`id`, \n    maschinen.`maschine-name` AS maschine, \n    vorrichtungen.`vorrichtung`, \n    vorrichtungen.`createdby`, \n    user.`fullname` AS creator, \n    vorrichtungen.`datecreated`, \n    vorrichtungen.`updatedby`, \n    vorrichtungen.`dateupdated`\nFROM \n    vorrichtungen,maschinen,user\nWHERE \n    maschinen.`maschine` = vorrichtungen.`maschine` \nAND \n    vorrichtungen.`createdby` =  user.`userid` \n</code></pre>\n\n<p><strong>and i recieve this result:</strong></p>\n\n<pre><code>| id | maschine | vorrichtung | createdby | creator |      datecreated    | updatedby |     dateupdated     |\n| 1  |    M1    |    11111    |     1     |  admin  | 2012-06-23 17:10:25 |     1     | 2012-06-23 18:15:20 |\n| 2  |    M1    |    22222    |     1     |  admin  | 2012-06-25 07:50:49 |     0     | 0000-00-00 00:00:00 |\n| 3  |    M2    |    33333    |     2     |  jimmy  | 2012-06-27 10:22:29 |     0     | 0000-00-00 00:00:00 |\n| 4  |    M3    |    44444    |     2     |  jimmy  | 2012-06-28 09:41:27 |     1     | 2012-06-28 12:40:37 |\n| 5  |    M4    |    11111    |     3     |  anton  | 2012-06-29 15:53:47 |     0     | 0000-00-00 00:00:00 |\n| 6  |    M4    |    22222    |     4     |  steven | 2012-06-29 22:30:02 |     2     | 2012-06-29 22:30:02 |\n</code></pre>\n\n<p>i try to explain what i want..</p>\n\n<p>if updatedby !=0 than select fullname from table user AS updatetor else 0 or something like that .. but i want all 6 rows</p>\n\n<p><strong>i want to receive this result:</strong></p>\n\n<pre><code>| id | maschine | vorrichtung | createdby | creator |      datecreated    | updatedby | updatetor |     dateupdated     |\n| 1  |    M1    |    11111    |     1     |  admin  | 2012-06-23 17:10:25 |     1     |   admin   | 2012-06-23 18:15:20 |\n| 2  |    M1    |    22222    |     1     |  admin  | 2012-06-25 07:50:49 |     0     |      0    | 0000-00-00 00:00:00 |\n| 3  |    M2    |    33333    |     2     |  jimmy  | 2012-06-27 10:22:29 |     0     |      0    | 0000-00-00 00:00:00 |\n| 4  |    M3    |    44444    |     2     |  jimmy  | 2012-06-28 09:41:27 |     1     |   admin   | 2012-06-28 12:40:37 |\n| 5  |    M4    |    11111    |     3     |  anton  | 2012-06-29 15:53:47 |     0     |      0    | 0000-00-00 00:00:00 |\n| 6  |    M4    |    22222    |     4     |  steven | 2012-06-29 22:30:02 |     2     |   jimmy   | 2012-06-29 22:30:02 |\n</code></pre>\n\n<p>is it possible to realize that? \nthanks for your help :)</p>\n\n<p>regards berni   </p>\n"},{"tags":["query","jasper-reports"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12930326,"title":"Parameter and single quotes: passing value to the IN clause","body":"<p>In my report's query I have a parameter that gets multiple values from a table which will be my barcode value. This is the query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT location_code, zone_code, check_digit_code\n  FROM location \n  WHERE location_code IN ($P!{LocationIn})\n</code></pre>\n\n<p>It works, but the value(s) that I input in the <em><code>LocationIn</code></em> parameter needs to be in single quotes (<code>'A01001'</code>, <code>'A1212'</code>) otherwise it fails with error : </p>\n\n<pre><code>Caused by: java.sql.SQLException: ORA-00904: \"A1212\": invalid identifier\n</code></pre>\n\n<p>I know the error is because of the two data types.</p>\n\n<p>I want to eliminate the effort of putting in the single quotes but I don't know how. Is this possible? I'm sure it is...</p>\n"},{"tags":["query","hibernate","jpa","jpql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12922320,"title":"Hibernate query - How to select those parents that have ALL the children matching a value?","body":"<p>I'm trying to write a Hibernate (JPA) query to select those parents where <strong>ALL</strong> their children match a property.</p>\n\n<p>Let's make a pratical example... </p>\n\n<p>I want to select those fathers who have <strong>ALL</strong> their children blond. If just one is black haired the father is not selected.</p>\n\n<p>How will the query look like?\nThank you in advance!</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12930802,"title":"How does COUNT behave when cross joins are involved in mysql?","body":"<p>I'm having a problem with counting the number of results of one of my queries that uses cross join.</p>\n\n<p>The data-gathering query is </p>\n\n<pre><code>SELECT CF.*, C.Type AS Ctype, C.Resp AS Resp \nFROM Campaigns C, CampaignEntities CF \nWHERE C.clientId = '10' AND LOWER(C.Resp) in ('resp1','resp2','resp3')\nORDER BY entityCode DESC \n</code></pre>\n\n<p>and it properly returns the rows that fit the criteria.</p>\n\n<p>However, when changing it to get the number of rows that fit:</p>\n\n<pre><code>SELECT COUNT(*) as RowNr \nFROM Campaigns C, CampaignEntities CF \nWHERE C.clientId = '10' AND LOWER(C.Resp) in ('resp1','resp2','resp3')\nORDER BY entityCode DESC\n</code></pre>\n\n<p>I get numbers in the millions (basically the result of the join without any of the WHERE conditions applied).</p>\n\n<p>Any idea why it's behaving like this or how I can possibly get the right number?</p>\n"},{"tags":["query","cassandra","range","astyanax"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":12762818,"title":"Astyanax key range query","body":"<p>trying to write a query which will paginate through all rows in a column family using astyanax client and RowSliceQuery.</p>\n\n<pre><code>keyspace.prepareQuery(COLUMN_FAMILY).getKeyRange(null, null, null, null, 100);\n</code></pre>\n\n<p>Done this successfully using hector where 1st call is done with null start and end keys. After retrieving 1st page I use last key from the result to make query for second page and etc.  This is code for 1st page using hector.</p>\n\n<pre><code>HFactory.createRangeSlicesQuery(keyspace,\nLongSerializer.get(), new CompositeSerializer(),\nBytesArraySerializer.get())\n.setColumnFamily(COLUMN_FAMILY)\n.setRange(null, null, false, 100).setRowCount(100);\n</code></pre>\n\n<p>Now when I am trying to do this with astyanax I am getting errors about null and non-null keys and tokens.  Not sure what tokens do in this query.  Also I am able to use allRows(), but would like to do this using key range query as it gives me more flexibility.</p>\n\n<p>Does anybody have an example of key range query using astyanax?  I cannot find an example neither in \"getting started\" documentation or anywhere else on the net.</p>\n\n<p>Thanks!\nAnton</p>\n"},{"tags":["sql","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12930621,"title":"select everything from one table, and array from another","body":"<p>I have one table that contains lots of data and I want to select everything from this one.</p>\n\n<p>Another table contains different statuscodes ( fields <code>ID</code> and <code>text</code> ), and I want to join this table into the first one so i get something like</p>\n\n<p>All data from first table <code>id1,text2,id2,text2</code> or <code>id1,id2,text1,text2</code> from the second table. </p>\n"},{"tags":["mysql","query","sql-order-by","subquery","group-concat"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12930715,"title":"GROUP_CONCAT with ORDER BY , but results are not orderd","body":"<pre><code>SELECT\n*,\n(SELECT\nGROUP_CONCAT(url SEPARATOR '$$' )\nFROM project_photos\nWHERE project_id = projects.id\nORDER BY priority) AS images\nFROM projects\nWHERE catID = 2\nLIMIT 0,5\n</code></pre>\n\n<p>above query works fine but the <code>images</code> coloumn are not ordered as priority , unable to understand why it is happening</p>\n\n<pre><code>// Structure for table project is\nCREATE TABLE `projects` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`catID` int(11) NOT NULL,\n`title` varchar(255) NOT NULL,\n`description` varchar(400) NOT NULL,\n`url` varchar(255) DEFAULT NULL,\n`tags` varchar(255) DEFAULT NULL,\n`featured` varchar(3) NOT NULL DEFAULT 'No',\n`featured_url` varchar(255) DEFAULT NULL,\n`order` int(11) DEFAULT NULL,\n`created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,\nPRIMARY KEY (`id`),\nKEY `catID` (`catID`),\nCONSTRAINT `FK_catID` FOREIGN KEY (`catID`) REFERENCES `category` (`catID`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB AUTO_INCREMENT=48 DEFAULT CHARSET=latin1;\n\n\n// Structure for table project_photos is\n\nCREATE TABLE `project_photos` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`url` varchar(250) DEFAULT NULL,\n`project_id` int(11) DEFAULT NULL,\n`priority` int(11) DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=347 DEFAULT CHARSET=utf8;\n</code></pre>\n"},{"tags":["mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12930545,"title":"MySQL Query - not interested in using inner query","body":"<p>I have a query say,</p>\n\n<pre><code>select col1,col2 from table1;\n</code></pre>\n\n<p>which return 2 columns of multiple rows. I want to use these two values in where condition of another query. Something like</p>\n\n<pre><code>select col3,col4 from table2 where col5=col1 and col6=col2;\n</code></pre>\n\n<p>where <code>col1</code> and <code>col2</code> are the resultant values of the first query.</p>\n\n<p>Currently I have used inner query something like</p>\n\n<pre><code>select col3,col4 from table2 \nwhere col5 in (select col1 from table1) \n  and col6 in (select col2 from table1);\n</code></pre>\n\n<p>But I dont want to use inner query like the one shown above as it slows down bring results. </p>\n\n<p>Please suggest.</p>\n"},{"tags":["query","session","mongodb","mongoose"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12929087,"title":"how to create a document in a mongodb collection and update another collection in the same time","body":"<p>here is my problem</p>\n\n<p>i have three schema</p>\n\n<pre><code>var UserSchema = new Schema({\n        username:String,\n        email:String,\n        hashed_password:String,\n        salt:String,\n        shop_id:{type:Schema.Types.ObjectId,ref:'Shop'},\n})\n\nvar ShopSchema = new Schema({\n       owner_id:{type:Schema.Types.ObjectId,ref:'User'},        \n       owner_real_id:String,                                    \n       owner_real_name:String,                                  \n       owner_real_location:String,                              \n\n       shop_name:String,\n       sell_product_ids:[Schema.Types.ObjectId],\n\n})\n\nvar ProductSchema = new Schema({\n\n\n})\n</code></pre>\n\n<p>it is necessary to sign up the userschema to use the app, but unnecessary to sign up the shopschema unless the user want to sell some stuff. however when the user do sign up the shopschema i need to update the userschema with the shop's _id, </p>\n\n<p>so here is what i did </p>\n\n<ol>\n<li>create the document in shop collection</li>\n<li>find the shops _id </li>\n<li>update the user collection</li>\n</ol>\n\n<p>as u can see i query the datebase three times,so i was wondering if this can be done in one query in order to save time like</p>\n\n<pre><code>Shop.create(regist_data,function(){\n    //update the user collection here\n})\n</code></pre>\n\n<p>Just in case u wondering why i need this, its becase i use 'passport' to log user in, and i want to acess the ProductShcema by shop's _id in the req.user, otherwise every time i want to acess the ProductShcema i nend to find the shop's _id and then get the product that belong to the shop's _id. </p>\n\n<p>any way if u have better solution,please let me know.thanx!!!</p>\n"},{"tags":["sql","query"],"answer_count":8,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":83,"score":1,"question_id":12929191,"title":"Join two sql result","body":"<p>my first result looks like this</p>\n\n<pre><code>ID       Name\n----------------------------------\n1        George\n2        Peter\n3        San\n</code></pre>\n\n<p>my other result looks like this</p>\n\n<pre><code>AnotherID     ID     Note\n-----------------------------------\n1             1      georgesnote1\n2             1      georgesnote2\n3             3      sansnote1\n4             1      georgesnote3\n</code></pre>\n\n<p>How I want them to look:</p>\n\n<pre><code>ID       Name        Note\n----------------------------------\n1        George      georgesnote1\n1        George      georgesnote2\n1        George      georgesnote3\n2        Peter       NULL\n3        San         sansnote1\n</code></pre>\n\n<p>My SQL knowledge pretty much limits me to achieve this. I guess I need something like UNION ALL. INNER JOIN OR LEFT OUTER JOIN doesnt work. My actual query is around 21 lines so this is not a beginner question. What I need is to join two results based on same IDs. Please someone guide me.</p>\n"},{"tags":["query","pymongo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12926808,"title":"advanced query combining or and gte and lt in pymongo","body":"<p>How can it implement this in pymongo?   </p>\n\n<p>number == 100 or (number >=10000 and number &lt; 10100)?  </p>\n\n<p>currently, I am doing it with<br>\n*condition['number'] = {'$gte':input_number * 100, '$lt':(input_number + 1) * 100}*<br>\nand then query with the condition.  </p>\n\n<p>But I don't know how to add \"number == 100\". Thanks!</p>\n"},{"tags":["sql","oracle","query","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12928798,"title":"What does this JDBC snippet achieves?","body":"<pre><code>String q = \"SELECT attr FROM students foo =? AND bar = ?\";\nPreparedStatement s= connection.prepareStatement(q);\ns.setString(1,\"a\");\ns.setString(2.\"b\");\nResultSet rs = s.executeQuery();\nif(rs.next())\n{\n System.out.println(\"aba\");\n}\nelse\n{\n System.out.println(\"zab\");\n}\n</code></pre>\n\n<p>I'm not entirely sure, but my interpretation is that it performs query to find \"attr\" from \"students\" where foo is something and bar is something. In case of successful results from query it prints out aba, otherwise it will print out zab. </p>\n\n<p>Correct me if i'm wrong.What s.setStrings(1,\"a\") are for? What exactly question mark stands for?</p>\n"},{"tags":["query","wordpress","pagination"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1614,"score":1,"question_id":2149416,"title":"How to set a variable in Wordpress's $wp_query","body":"<p>I'm trying to use the <code>set()</code> function, to set <code>$wp_query->query_vars['paged']</code>. </p>\n\n<p>What's the proper syntax for this function? </p>\n\n<p>Thanks.</p>\n"},{"tags":["javascript","mysql","query","node.js","image-uploading"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":100,"score":-2,"question_id":12927939,"title":"How to store image into a MySQL database using node.js and Javascript","body":"<p>I am developing web application using node.js. I want to store an image into MySQL database.Please give some suggestions.</p>\n\n<pre><code>var Client = require('mysql').Client,\n    client = new Client();\nclient.user = DB_USER;\nclient.password = DB_PASS;\nclient.host = DB_HOST;\nclient.connect(function(error, results) {\n    if(error) {\n        client.end();\n        return;\n    }\n    client.query('USE ' + DB_SCHEME, function(error, results) {\n        if(error) {\n            client.end();\n            return;\n        }\n\n        var sql = \"INSERT INTO b SET `data` = ?\";\n        var values = [buf];\n\n        client.query(sql, values,\n            function(error, results) {\n                if(error) {\n                    return;\n                }\n                return;\n            }\n        );\n    });\n});\n</code></pre>\n\n<p>Here <strong>data</strong> is blob type.</p>\n"},{"tags":["mysql","sql","query","database-backups"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":12556713,"title":"Query for mysql database backup (only data) without usin mysql dump","body":"<p>I need to fetch data from database for backup in the form of insert statements</p>\n\n<p>I need to do it against a user button click in c#. So i think an sql query or stored procedure will be appropriate to do this, rather than mysqldump.</p>\n\n<p>Secondly I need them for <strong>all tables</strong>. Instead of writing table and column names they should be fetched from information_schema, because with dynamic names, changes in schema would not affect the query</p>\n\n<p>If there already exists a solution, please guide me.</p>\n\n<p><strong>Edit</strong> : (Not necessary to read) Question included an unnecessary query which I have removed now. the first answer was not satisfactory but it was for outfile. I have left outfile because that works for single table and does not allow appending</p>\n\n<p><strong>Update</strong> : I have made a solution, it is posted, but looking for the better one.</p>\n"},{"tags":["mysql","query","left-join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12926870,"title":"Left join has me stumped","body":"<p>I have 2 tables, person and movie</p>\n\n<p>The person table has ID and gender, and the Movie table has ID, movie_type, and movie_attended. genderID and movie_attended can be null.</p>\n\n<p>I want to create a query that will return 3 columns: gender, movie_attended (but it must be a romance movie), and a count of the number of people who have that gender and movie_attended.</p>\n\n<p>Right now I have</p>\n\n<pre><code>select person.gender, movie.movie_attended, count(person.gender)\nfrom person left join movie\non person.ID = movie.ID\nwhere movie.movie_type = \"romance\"\norder by person.gender DESC\n</code></pre>\n\n<p>Unfortunately this just gives me one row of information. If I remove the count(person.gender) I get too many rows. Lets say there are only 3 romance movies to choose from. I want my first row to read Male - The Notebook - 12. Second row: Male - Casablanca - 8. Third row: Male - Romeo &amp; Juliet - 2. Fourth row: Male - Null - 2</p>\n\n<p>Then start over with Female</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12882515,"title":"Rails - use join only if a condition is true","body":"<p>How do I use joins only if a certain condition is true?\nFor example, I have this query:</p>\n\n<pre><code>@courses = Course.find(:all,\n    :order=&gt; 'courses.name asc',\n    :include =&gt; [:units],\n    :joins =&gt; :course_sub_responsibles,\n    :group =&gt; 'courses.name',\n    :conditions =&gt; conditions) \n</code></pre>\n\n<p>But I need to join the course_sub_responsibles table only in a certain condition.</p>\n"},{"tags":["css","query","internet-explorer","media","susy-compass"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12899945,"title":"susy, media queries, and lt IE9","body":"<p>I was wondering what (if any) shims you use to get the magic grids to respond correctly in <a href=\"http://susy.oddbird.net/\" rel=\"nofollow\">SUSY</a> in IE8 and under?</p>\n\n<p>On non-susy sites I've always used <a href=\"http://modernizr.com/\" rel=\"nofollow\">moderizr</a> or the shim from google and they worked as expected. I'm working on my first SUSY site and the media queries for the largest size won't kick in.</p>\n\n<p><a href=\"http://dev.apehangar.com\" rel=\"nofollow\">http://dev.apehangar.com</a></p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":64,"score":-1,"question_id":12924436,"title":"Query broke down and left me stranded in the woods","body":"<p>I am trying to execute a query that deletes all files from the images table that do not exist in the filters tables. I am skipping 3,500 of the latest files in the database as to sort of \"Trim\" the table back to 3,500 + \"X\" amount of records in the filters table.</p>\n\n<p>The filters table holds markers for the file, as well as the file id used in the images table. </p>\n\n<p>The code will run on a cron job. </p>\n\n<p>My Code:</p>\n\n<pre><code>$sql = mysql_query(\"SELECT * FROM `images` ORDER BY `id` DESC\") or die(mysql_error());\n\nwhile($row = mysql_fetch_array($sql)){\n    $id = $row['id'];\n    $file = $row['url'];\n\n    $getId = mysql_query(\"SELECT `id` FROM `filter` WHERE `img_id` = '\".$id.\"'\") or die(mysql_error());\n    if(mysql_num_rows($getId) == 0){        \n        $IdQue[] = $id;\n        $FileQue[] = $file;\n    }\n}\nfor($i=3500; $i&lt;$x; $i++){\n    mysql_query(\"DELETE FROM `images` WHERE id='\".$IdQue[$i].\"' LIMIT 1\") or die(\"line 18\".mysql_error());\n    unlink($FileQue[$i]) or die(\"file Not deleted\");\n}\necho ($i-3500).\" files deleted.\";\n</code></pre>\n\n<p>Output: 0 files deleted.</p>\n\n<p>Database contents:</p>\n\n<pre><code>images table: 10,000 rows\nfilters table: 63 rows\n</code></pre>\n\n<p>Amount of rows in filters table that contain an images table id: 63\nExecution time of php script: 4 seconds +/- 0.5 second</p>\n\n<p>Relevant DB structure</p>\n\n<ul>\n<li>TABLE: images </li>\n<li>id </li>\n<li>url </li>\n<li><p>etc...</p></li>\n<li><p>TABLE: filter </p></li>\n<li>id </li>\n<li>img_id (CONTAINS ID FROM images table) </li>\n<li>etc...</li>\n</ul>\n"},{"tags":["database","query","informix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":5013845,"title":"Tweak Informix query","body":"<p>I have a bunch of Informix queries and I need to verify the performance of each query.</p>\n\n<p>All these queries are long and contain a lot inner SELECT and JOINs. So I am wondering if there is any tool which can assist me to check which fragment in the query affects the whole query performance?  </p>\n\n<p>It would help a lot because it's hard to check only by eyes.</p>\n"},{"tags":["query","drop-down-menu","caml","sharepoint-list","sharepoint-object-model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":12185935,"title":"How to get a single listitem field value?","body":"<p>I have a SharePoint list with Roles as the columns(Admin, Viewer, Manager) and Document Types as the items (Word docs, PPtx docs, excel docs). I have filled in the corresponding values with the permissions each Role has per Doc Type. </p>\n\n<p>I have built a web part with 2 dropdowns. Dropdown1 has Roles and Dropdown2 has Doc Types.</p>\n\n<p>How can I use the selected value for each dropdown and query the corresponding value from the list?</p>\n\n<p>Do I use CAML or can I use SharePoint object model?</p>\n\n<pre><code>using (SPSite siteCol = new SPSite(\"http://mySharepoint/\"))\n{\n    using (SPWeb web = siteCol.RootWeb)\n    {\n        SPList list = web.GetList(\"/Lists/PermissionMatrix\");\n\n        SPListItem item = list.GetItemByIdSelectedFields([*Requires ID*], \"Role\");\n\n        String role1= (String)item[\"Roles\"];\n    }\n}\n</code></pre>\n\n<p>Doesn't work because I have to use the Item ID and I could only query the item using CAML</p>\n\n<p>Please help. Thanks</p>\n"},{"tags":["wordpress","query","sorting","sql-order-by","custom-fields"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3210,"score":1,"question_id":5396015,"title":"order by custom field - wordpress","body":"<p>I'm trying to sort a page of posts by a custom field. </p>\n\n<p>Here's what I have so far, I'm just not sure how or where to add the orderby</p>\n\n<pre><code>$args = array(\n    'post_type' =&gt; 'new',\n    'meta_query' =&gt; array(\n        array(\n            'key' =&gt; 'over-make',\n            'value' =&gt; 'Doral',\n            'compare' =&gt; 'LIKE'\n        )\n    )\n\n );\n$loop = new WP_Query( $args);\n</code></pre>\n"},{"tags":["php","query","button","submit","isset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12922810,"title":"intercept an sql query which is executed without push the right submit button correlated php","body":"<p>I have a submit type button called \"validate\" if user has allowed appeared in page.\nvalidate button set a row in db as validated (TRUE)</p>\n\n<p>i check first in db if validated field is true or false.</p>\n\n<p>if false and  isset($_POST['valid'])  i show up the button </p>\n\n<pre><code>                        &lt;input &lt;?php echo $disabledvalid; ?&gt; type=\"submit\" class=\"sub\" name=\"valid\"  id=\"valid\" value = \"validate\"   /&gt;\n</code></pre>\n\n<p>after i put the UPDATE query which change validated field from FALSE to true.</p>\n\n<p>When the page is processed the if is ignored and was executed update query?</p>\n\n<p>How can i fix this problem?</p>\n\n<pre><code>                &lt;form action=\"view_support.php\" method=\"post\"&gt;\n            &lt;?php\n\n            //check if validated field is true or false\n            $queryvalid = \"SELECT validated FROM support WHERE suppid = $suppid\";\n            $risqueryvalid = pg_query($queryvalid);\n            $row = pg_fetch_array($risqueryvalid);\n            $suppvalidated = $row['validated'];\n            //echo \"supp \" . $suppvalidated;\n\n\n\n            //$suppvalidated == \"f\";\n            unset($_POST['valid']);\n            //if validated field is false show me validate button\n            if ( $suppvalidated == FALSE &amp;&amp; (isset($_POST['valid'])  ){ \n                $suppvalidated = 'true';\n\n\n                    &lt;input &lt;?php echo $disabledvalid; ?&gt; type=\"submit\" class=\"sub\" name=\"valid\"  id=\"valid\" value = \"validate\"   /&gt;\n                &lt;?php\n\n                if(isset($_POST['valid'])){\n                    $vquery = \"UPDATE support SET validated = $suppvalidated WHERE suppid = $suppid\";\n                    $risvquery = pg_query($vquery);\n                    if (!$risvquery) {\n                        #die(\"Error during insert support\");    \n                        die(\"Errore nella query $risvquery: \" . pg_last_error());\n                    }\n                    unset($_POST['valid']);\n                }\n</code></pre>\n"},{"tags":["mysql","query","stored-procedures","timestamp","mysql-workbench"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12922972,"title":"Mysql query to copy timestamp data from another","body":"<p>I was working on mysql query and could not get it running. I am trying to copy timestamp field data from one table to another based on user id. It is not straight forward. Here is the story. In the score table I have User_id, question id Tag id and add_date field......   There are various Tag id for one user in that table and I want to copy add date field  for each user where tagid=627 in the other table called as User in its respective Date_record(timestap) field which is 0000 0000 right now .Once again, trying to Copy add_date field for each user where tagid=627(for each) and paste to the same user id(field name is id for this table which is same a suser id) in other table in the Date_record field which is time stamp and currently 0000-00-00 00:00:00.  For example, screen shot of tables.</p>\n\n<p><a href=\"http://minus.com/lw2prl55nTBHA\" rel=\"nofollow\">http://minus.com/lw2prl55nTBHA</a>\nuser table with empty Date_record field(timestamp) which will be having data from score table(next) for same user id(int this table id is same as user_id) and tag id=627][1]</p>\n\n<p><a href=\"http://minus.com/lby84cURuoD5DN\" rel=\"nofollow\">http://minus.com/lby84cURuoD5DN</a>\nscore table in which for same user id there are diff tag id and I want to copy tagid =627 add_date data field</p>\n"},{"tags":["android","query","sqlite","spatialite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12916041,"title":"Android: Failing to update row using SQL Extension function or builtin","body":"<p>I'm having a lot of trouble with SQLiteDatabase command.  I have loaded up spatialite and enabled the extension.  I want one of my values to be the output of the MakePoint function so I have a content value like this:</p>\n\n<pre><code>values.put(\"Location\", \"MakePoint(43.2, 27.345, 4326)\");\n</code></pre>\n\n<p>When this is passed into <code>SQLiteDatabase.Update()</code> it's escapsed so that the resulting string ends up being <code>\"UPDATE Targets SET Location='MakePoint(43.2, 27.345, 4326)'\"</code> SQLite hates this and throws an exception. </p>\n\n<p>Is there an easy way around this? Right now I'm trying to build up the string manually since I can't use Update.</p>\n"},{"tags":["ajax","query","postgresql","data-visualization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12897730,"title":"Efficiently Subsample Timeseries Data in Database","body":"<p>I have a timeseries of values (e.g., a random walk of stock market prices) stored in a PostgreSQL database. It's a very large table and I'd like to be able to handle queries for arbitrary time spans similarly fast. I have <a href=\"http://www.highcharts.com/stock/demo/lazy-loading\" rel=\"nofollow\">this chart</a> in the back of my mind, and I wonder how they did this.</p>\n\n<p>A simple Example: </p>\n\n<pre><code>WITH t(ts, val) AS ( VALUES\n    ('2012-10-04 00:00:00'::timestamp, 1.11::numeric),\n    ('2012-10-04 00:00:01', 1.21),\n    ('2012-10-04 00:00:02', 1.25),\n    ('2012-10-04 00:00:03', 1.41),\n    ('2012-10-04 00:00:04', 1.31),\n    ('2012-10-04 00:00:05', 1.25),\n    ('2012-10-04 00:00:06', 1.33))\n</code></pre>\n\n<p>(Assume there's an index on the timestamp column.) The table is large, and it takes a long time to retrieve all values of a time span of, e.g., a quarter of a year. However, as all I want to do with that data is to make a plot to visualize the global trend, I do not really need to get the entire data set from that period, but a representative subset would be fine.</p>\n\n<p>Things that came to my mind:</p>\n\n<ul>\n<li>generate a list of sub-statements, each of which retrieves one arbitrary value for a short sub-time-interval (e.g. one value per hour interval).</li>\n<li>aggregate values, e.g. <code>AVG()</code> and group by <code>date_trunc('hour', ts)</code> or similar (but would this be any faster on its own? Probably make another table that holds pre-aggregated values?)</li>\n</ul>\n\n<p>Is there a way-to-go to achieve this?</p>\n"},{"tags":["php","mysql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12911526,"title":"Any way to select from MySQL table where a field ends in certain character/number?","body":"<p>I am hoping to run a mysql_query where I can select a row if a certain field ends in a number. For example:</p>\n\n<pre><code>&lt;?php\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 0]\");\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 1]\");\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 2]\");\n$query = mysql_query(\"SELECT id FROM table WHERE [ID ENDS IN 3]\");\n//and so on...\n?&gt;\n</code></pre>\n\n<p>Is there a way to do this? Any help would be great. Thank you!</p>\n"},{"tags":["sql","query","relational","algebra"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":119,"score":0,"question_id":11106268,"title":"SQL relational query","body":"<p><img src=\"http://i.stack.imgur.com/Z0Bbg.jpg\" alt=\"enter image description here\"></p>\n\n<p>I have two example tables R,S as seen above, I want to write a query that returns all attributes A (left table) that are associated with exactly 'b2' and 'b4' from the other table, in this case it should return only a2.</p>\n\n<p>Using division returns both a1 and a2 since they both have that association, but a1 does not apply since it has association with other attributes, I am only allowed to use minimal relational algebra operators.</p>\n"},{"tags":["mysql","query","join","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12884035,"title":"Query with multiple joins and sum function giving wrong total or sum","body":"<p>Posted query retrieving all the relevant fields but the <strong><code>SUM(af_py_commission)</code></strong> function causing problem as in and it simply add an extra zero at the end and then on the right end. </p>\n\n<p>e.g. if the answer is 45 it will give 450 and data format of the field is float else this query is working perfect....</p>\n\n<p>I've tried a simple query with same function on the same field but without the joins so it work fine and give correct ans. Can anyone help what i'm doing wrong in this>??</p>\n\n<pre><code>SELECT f.af_id AS af_if\n   , aff_cust_tbl.af_id AS cu_af_id\n   , aff_payment_tbl.af_cust_id AS pym_cus_id\n   , SUM(af_py_commission)\nFROM aff_tbl AS f\nINNER JOIN aff_tbl ON f.af_id = 2\nINNER JOIN aff_cust_tbl ON aff_cust_tbl.af_id = 2\nINNER JOIN aff_payment_tbl ON aff_payment_tbl.af_id = 2;\n</code></pre>\n"},{"tags":["sql","query","aggregate-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12919802,"title":"Do several aggregates in one query using where clause SQL","body":"<p>Is it possible to do several aggregate functions inside a single query</p>\n\n<p>I know whe can use </p>\n\n<pre><code>SELECT SUM(value) FROM mytable WHERE date  between '2012-05-01' AND '2012-06-01'\n</code></pre>\n\n<p>I've been trying to make an example</p>\n\n<pre><code>CREATE TABLE mytable\n    (id varchar(10), value int, `date` date, situation varchar(10) ) ;\n\nINSERT INTO mytable\n    (id, value, date, situation)\nVALUES\n    ('id0', 1338, '2012-05-14','Urgent'),\n    ('id0', 3572, '2012-05-13','Urgent'),\n    ('id0', 3232, '2012-05-06','Urgent'),\n    ('id0', 3068, '2012-05-05','Post'),\n    ('id0', 3363, '2012-05-04','Urgent'),\n    ('id0', 2022, '2012-04-28','Anual'),\n    ('id0', 3193, '2012-04-24','Post')\n</code></pre>\n\n<p>But is it possible to use the same query to get other aggregate values?</p>\n\n<pre><code>SELECT SUM(value),SUM(value),Count(*) FROM mytable WHERE date  between '2012-05-01' AND '2012-06-01', WHERE date  between '2012-05-01' AND '2012-10-01', Where situation like 'Urgent' \n</code></pre>\n\n<p>instead of 3 queries:</p>\n\n<pre><code>SELECT SUM(value) FROM mytable WHERE date  between '2012-05-01' AND '2012-06-01'\nSELECT SUM(value) FROM mytable WHERE date  between '2012-05-01' AND '2012-10-01'\nSELECT Count(*)   FROM mytable Where situation like 'Urgent'\n</code></pre>\n"},{"tags":["query","file","process","count","descriptor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12914607,"title":"How can I read out how many file descriptors refer a file of a given name within an arbitrary process","body":"<p>On linux c(++): How can I count how many file descriptors refer a file of a given name in a given process. I would be pariculary interested in knowing, how many shm_open had added a reference on a file. How can I read this out from inside an arbitrary process? Because i dont want to unlink the files in other processes before everyone called close, because it will delete the file name, which I do not want.</p>\n\n<p>Ok, I found that most likely there is no way to do this without calling external utilities and that is very inefficient. So my question rather would be: how would you solve this problem (tracking open-close pairs across processes) without IPC stuff like message queues or SHM. I guess I'll go with message queue, but if anyone has a simpler solution feel free to recommend!</p>\n"},{"tags":[".net","query","sqlite","driver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12918126,"title":"C# application compiled with .NET SQLite driver?","body":"<p>Real quick question! <strong>*If I load an SQLite driver into my .NET project, when I save and compile this project (it's a simple Windows Forms application), will the SQLite driver form part of the application?</strong> Basically I'm planning on having one of my form controls execute an SQL query on an SQLite database which will exist on a user's machine. Obviously if this driver does not exist then the SQLite database file will not be able to be interpreted!</p>\n\n<p>Thanks for any input.</p>\n"},{"tags":["sql","database","sql-server-2008","query","sql-optimization"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12918362,"title":"Temporary table vs short-circuit operation for SQL query","body":"<p>Following is my query which I want to optimize, here the bottleneck for the optimization is CONDITION_B. </p>\n\n<pre><code>select @COMPUTE_X = count(distinct TABLEA.COLUMN_T5)\nfrom #TMP_TABLEA TABLEA\ninner join TABLEB on TABLEB.ID = TABLEA.ID\nleft join....\nwhere\n(\n  CONDITION_A --Complex condition\n) and\n(\n  CONDITION_B --Complex condition with some functions returning table\n)\n</code></pre>\n\n<p>If I put my result of above query leaving CONDITION_B to a temporary table and then apply CONDITION_B on that temporary table, I achieve a very good amount of performance gain. I think CONDITION_B always evaluated whether the result for CONDITION_A is false.</p>\n\n<p>Could anyone let me know if there is a better way of doing it. And does short-circuit operations work in SQL query statement, if yes what is the order of their processing.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":128,"score":4,"question_id":12904097,"title":"SQL Query to return maximums over decades","body":"<p><strong>THIS IS USING MYSQL</strong>\nMy question is the following. I have a baseball database, and in that baseball database there is a master table which lists every player that has ever played. There is also a batting table, which tracks every players' batting statistics. I created a view to join those two together; hence the <code>masterplusbatting</code> table. \n  I now want to find the highest HR hitter in each decade since baseball began. Here is what I tried.</p>\n\n<pre><code>    select f.yearID, truncate(f.yearid/10,0) as decade,f.nameFirst, f.nameLast, f.HR\n    from (\n    select yearID, max(HR) as HOMERS\n    from masterplusbatting group by yearID\n    )as x inner join masterplusbatting as f on f.yearID = x.yearId and f.HR = x.HOMERS\n    group by decade\n</code></pre>\n\n<p>You can see that I truncated the yearID in order to get <code>187, 188, 189</code> etc instead of <code>1897, 1885,</code>. I then grouped by the decade, thinking that it would give me the highest per decade, but it is not returning the correct values. For example, it's giving me Adrian Beltre with 48 HR's in 2004 but everyone knows that Barry Bonds hit 73 HR in 2001. Can anyone give me some pointers?</p>\n"},{"tags":["php","ajax","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12917033,"title":"AJAX, PHP DB Lookup","body":"<p>Currently I have a form and when the user is entering data, this code calls another page to check if the username is in use. This is the code from the main page that calls the DB Page(test.php)</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\nfunction showHint(str)\n{\nif (str.length==0)\n  { \n  document.getElementById(\"txtHint\").innerHTML=\"\";\n  return;\n  }\nif (window.XMLHttpRequest)\n  {// code for IE7+, Firefox, Chrome, Opera, Safari\n  xmlhttp=new XMLHttpRequest();\n  }\nelse\n  {// code for IE6, IE5\n  xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\");\n  }\nxmlhttp.onreadystatechange=function()\n  {\n    if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)\n    {\n        document.getElementById(\"txtHint\").innerHTML=xmlhttp.responseText;\n        if (xmlhttp.responseText.indexOf(\"green\") != -1) {\n            document.getElementById(\"submit\").disabled = false;\n        } else {\n            document.getElementById(\"submit\").disabled = true;\n        }\n    }\n  }\nxmlhttp.open(\"GET\",\"test.php=\"+str,true);\nxmlhttp.send();\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>I want to change this so when it calls test.php it passes a value to test.php based on what form field the user is entering into.</p>\n\n<p>That way I can use test.php to perform diffident DB lookups depending on the form field the user is completing.</p>\n\n<p>Can anyone help ?\nThanks :) </p>\n"},{"tags":["sql-server-2008","query","inner-join","multiple-columns"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12917711,"title":"In sql 2008 R2, how do i join 2 columns from one table with 2 columns in another table?","body":"<p>I have 2 tables. In table1 I have 2 columns -- cust_npa &amp; cust_nxx. In table2, I have 2 columns -- valid_npa &amp; valid_nxx. Each entry in table2.valid_npa has a corresponding entry in table2.valid_nxx.</p>\n\n<pre><code>valid_npa   valid_nxx\n201         551\n201         552\n201         553\n202         851\n202         852\n</code></pre>\n\n<p>I wish to return all the rows in table1 that have a combination of valid_nap &amp; valid_nxx from table2.</p>\n\n<p>For example, a row in table1 that has cust_npa of 201 and cust_nxx of 852 would not be returned (as this is not a valid combination from table2).</p>\n"},{"tags":["mysql","query","epoch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12916275,"title":"mysql update HH:MM:SS from an epoch time","body":"<p>I'm looking to do a mass query update on a column that is in ms from the epoch.  For each row returned according to my where clause, I would like to update the time value to something passed in, and have it still stored in ms.  What would my update clause need to look like?</p>\n\n<p>For example, I have two rows</p>\n\n<pre><code>MY_TIMESTAMP  | VALUE\n----------------------\n1281275302000 | some val 1\n1347198502000 | some val 2\n</code></pre>\n\n<p>Row 1 corresponds to Sun, 08 Aug 2010 13:48:22 UTC \nRow 2 corresponds to Sun, 09 Sep 2012 13:48:22 UTC</p>\n\n<p>Now I want to set both times, say to 07:00:00, but leave the dates as is.  So the result of the update statement should look like:</p>\n\n<pre><code>MY_TIMESTAMP  | VALUE\n----------------------\n1281250800000 | some val 1\n1347174000000 | some val 2\n</code></pre>\n\n<p>corresponding to Sun, 08 Aug 2010 07:00:00 UTC and Sun, 09 Sep 2012 07:00:00 UTC</p>\n"},{"tags":["java","query","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12900029,"title":"Hibernate Sorting by associated (optional) fields","body":"<p>I am trying to do a sort on a Hibernate dataset, ordering by a attribute of an (optionally) associated object. I followed the example from <a href=\"http://stackoverflow.com/questions/870029/hibernate-order-by-association\">hibernate order by association</a> - and that works to an extent. The problem comes when there is not an associated object, the whole record is ignored.</p>\n\n<p>If I change the association type of the object to be an outer join, will it help matters? And if so, can someone please point me towards the correct directive?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["mysql","query","join","left-join","limit"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12915374,"title":"Getting total mysql results returned from query with a limit: FOUND_ROWS error","body":"<p>I have this mysql query:</p>\n\n<pre><code>SELECT Files.GUID, Files.Name, Files.Type, Files.Visibility, Files.CreationDate, Files.OwnerUser, Date, BackupsCount\nFROM Files\n  LEFT JOIN (\n    SELECT FileGUID, Date, COUNT(*) AS BackupsCount\n    FROM Versions\n    GROUP BY FileGUID\n  ) Versions ON Files.GUID = Versions.FileGUID\nWHERE Files.ParentFolder = '96251A8B-B2A8-416B-92D7-3509E6A645C7'\nORDER BY Files.Type DESC, CreationDate ASC\nLIMIT 0, 50\n</code></pre>\n\n<p>I'd like to know how many record this query would return <strong>if the LIMIT directive was not there</strong>, I googled and found that I needed to add <code>SELECT SQL_CALC_FOUND_ROWS</code> and <code>SELECT FOUND_ROWS();</code></p>\n\n<p><strong>MY problem is:</strong> I couldn't get it to work:</p>\n\n<pre><code>SELECT SQL_CALC_FOUND_ROWS * FROM (\nSELECT Files.GUID, Files.Name, Files.Type, Files.Visibility, Files.CreationDate, Files.OwnerUser, Date, BackupsCount\nFROM Files\n  LEFT JOIN (\n    SELECT FileGUID, Date, COUNT(*) AS BackupsCount\n    FROM Versions\n    GROUP BY FileGUID\n  ) Versions ON Files.GUID = Versions.FileGUID\nWHERE Files.ParentFolder = '96251A8B-B2A8-416B-92D7-3509E6A645C7'\nORDER BY Files.Type DESC, CreationDate ASC\nLIMIT 0, 50)\n\n-- Find total rows\nSELECT FOUND_ROWS()\n</code></pre>\n\n<p>Assuming this is good idea (I mean doing one query vs two separate ones), <strong>how can I get the <code>FOUND_ROWS()</code> to work with this query?</strong></p>\n"},{"tags":["php","mysql","query","join","mybb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":167,"score":0,"question_id":3077336,"title":"How can I join 3 tables with mysql & php?","body":"<p>I have a page that pulls the users Post,username,xbc/xlk tags etc which is perfect... BUT since I am pulling information from a MyBB bulletin board system, its quite different. When replying, people are are allowed to change the \"Thread Subject\" by simplying replying and changing it.</p>\n\n<p>I dont want it to SHOW the changed subject title, just the original title of all posts in that thread.</p>\n\n<p>By default it repies with \"RE:thread title\". They can easily edit this and it will show up in the \"Subject\" cell &amp; people wont know which thread it was posted in because they changed their thread to when replying to the post.</p>\n\n<p>So I just want to keep the orginial thread title when they are replying.</p>\n\n<p>Make sense~??</p>\n\n<p>Tables:mybb_users\nFields:uid,username</p>\n\n<p>Tables:mybb_userfields\nFields:ufid</p>\n\n<p>Tables:mybb_posts\nFields:pid,tid,replyto,subject,ufid,username,uid,message</p>\n\n<p>Tables:mybb_threads\nFields:tid,fid,subject,uid,username,lastpost,lastposter,lastposteruid</p>\n\n<p>I haev tried multiple queries with no success:</p>\n\n<pre><code>$result = mysql_query(\"\n    SELECT * FROM mybb_users\n    LEFT JOIN (mybb_posts, mybb_userfields, mybb_threads)\n    ON (\n        mybb_userfields.ufid=mybb_posts.uid\n        AND mybb_threads.tid=mybb_posts.tid\n        AND mybb_users.uid=mybb_userfields.ufid\n    )\n    WHERE mybb_posts.fid=42\");\n\n\n$result = mysql_query(\"\n    SELECT * FROM mybb_users\n    LEFT JOIN (mybb_posts, mybb_userfields, mybb_threads)\n    ON (\n        mybb_userfields.ufid=mybb_posts.uid\n        AND mybb_threads.tid=mybb_posts.tid\n        AND mybb_users.uid=mybb_posts.uid\n    )\n    WHERE mybb_threads.fid=42\");\n\n$result = mysql_query(\"\n    SELECT * FROM mybb_posts \n    LEFT JOIN (mybb_userfields, mybb_threads) \n    ON (\n        mybb_userfields.ufid=mybb_posts.uid\n        AND mybb_threads.tid=mybb_posts.tid\n    )\n    WHERE mybb_posts.fid=42\");\n</code></pre>\n"},{"tags":["android","query","ormlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":192,"score":0,"question_id":11671791,"title":"ORMLite - Query foreign field","body":"<p>Using ORMLite for Android, I need to build a query that returns orders by order id or by customer name. Please consider the following class declarations:</p>\n\n<pre><code>@DatabaseTable(tableName = \"order\")\npublic class Order {\n    @DatabaseField(generatedId = true)\n    private Long id;\n\n    @DatabaseField(foreign = true, canBeNull = false, foreignAutoRefresh = true, columnName = \"customer_id\")\n    private Customer customer;\n\n    // default constructor, getters and setters...\n}\n\n@DatabaseTable(tableName = \"customer\")\npublic class Customer {\n    @DatabaseField(generatedId = true)\n    private Long id;\n\n    @DatabaseField\n    private String name;\n\n    // default constructor, getters and setters...\n}\n</code></pre>\n\n<p>The raw SQL I'm looking for would be something like this:</p>\n\n<pre><code>SELECT \n    o.* \nFROM\n    order o\n    JOIN customer c on\n        o.customer_id = c.id\nWHERE\n    (o.id = ?) OR (c.name = ?)\n</code></pre>\n\n<p>What is the best way to do this using ORMLite?</p>\n"},{"tags":["php","html","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12915677,"title":"PHP / MySQL String Search Query","body":"<p>I've got a database setup with \"customer\" information.  I've got a PHP form to search for the strings, first name (fname), last name (lname), and phone number (phone).  For some reason, I'm not even getting the helpers displayed that the functions are working?  I've re-read over this code over and over and can't seem to figure out where I'm missing something.</p>\n\n<pre><code>&lt;form name=\"search\" method=\"post\" action=\"&lt;?=$PHP_SELF?&gt;\"&gt;\n Seach for: &lt;input type=\"text\" name=\"find\" /&gt; in \n &lt;Select NAME=\"field\"&gt;\n &lt;Option VALUE=\"fname\"&gt;First Name&lt;/option&gt;\n &lt;Option VALUE=\"lname\"&gt;Last Name&lt;/option&gt;\n &lt;Option VALUE=\"phone\"&gt;Phone #&lt;/option&gt;\n &lt;/Select&gt;\n &lt;input type=\"hidden\" name=\"searching\" value=\"yes\" /&gt;\n &lt;input type=\"submit\" name=\"search\" value=\"Search\" /&gt;\n &lt;/form&gt;\n &lt;? \n //This is only displayed if they have submitted the form \n if ($searching ==\"yes\") \n { \n echo \"&lt;h2&gt;Results&lt;/h2&gt;&lt;p&gt;\"; \n\n //If they did not enter a search term we give them an error \n if ($find == \"\") \n { \n echo \"&lt;p&gt;You forgot to enter a search term\"; \n exit; \n } \n\n // We preform a bit of filtering \n $find = strtoupper($find); \n $find = strip_tags($find); \n $find = trim ($find); \n\n //Now we search for our search term, in the field the user specified \n $data = mysql_query(\"SELECT * FROM customer WHERE upper($field) LIKE'%$find%'\"); \n\n //And we display the results \n while($result = mysql_fetch_array( $data )) \n { \n echo $result['fname']; \n echo \" \"; \n echo $result['lname']; \n echo \"&lt;br&gt;\"; \n echo $result['phone']; \n echo \"&lt;br&gt;\"; \n echo \"&lt;br&gt;\"; \n } \n\n //This counts the number or results - and if there wasn't any it gives them a little message explaining that \n $anymatches=mysql_num_rows($data); \n if ($anymatches == 0) \n { \n echo \"Sorry, but we can not find an entry to match your query&lt;br&gt;&lt;br&gt;\"; \n } \n\n //And we remind them what they searched for \n echo \"&lt;b&gt;Searched For:&lt;/b&gt; \" .$find; \n } \n ?&gt;\n</code></pre>\n"},{"tags":["java","xml","query","relaxng","jing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":9465968,"title":"Querying a RelaxNG schema (xml syntax) in java, preferably using Jing","body":"<p>I am trying to find a way to query a RNG schema while avoiding reinvention of the wheel, in order to answer basic questions such as: what elements are valid children of an XML instance element, what can/must be it's attributes and so on.</p>\n\n<p>A post <a href=\"http://www.velocityreviews.com/forums/t170553-querying-schema-rng-files.html\" rel=\"nofollow\">here</a> raised my hopes of doing this with Jing/Trang, since I am already doing RNG validation with Jing, but after searching around I've found no source code examples which would confirm the claim and browsing API docs also did not help me much (which in turn also seems to be the only documentation bundled with Jing).</p>\n\n<p>I'd really like to avoid parsing schema into my own object model to do these queries and it also seems kinda redundant since I know Jing must also be doing it somewhere. The question is how to obtain the information I require from it.</p>\n\n<p>Is there another library I could use to query RNG schema from java code? Note that I'm not trying to validate instance files by using a schema, I am trying to query the schema itself.</p>\n"}]}
{"total":20740,"page":11,"pagesize":100,"questions":[{"tags":["java","xml","query","relaxng","jing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":9465968,"title":"Querying a RelaxNG schema (xml syntax) in java, preferably using Jing","body":"<p>I am trying to find a way to query a RNG schema while avoiding reinvention of the wheel, in order to answer basic questions such as: what elements are valid children of an XML instance element, what can/must be it's attributes and so on.</p>\n\n<p>A post <a href=\"http://www.velocityreviews.com/forums/t170553-querying-schema-rng-files.html\" rel=\"nofollow\">here</a> raised my hopes of doing this with Jing/Trang, since I am already doing RNG validation with Jing, but after searching around I've found no source code examples which would confirm the claim and browsing API docs also did not help me much (which in turn also seems to be the only documentation bundled with Jing).</p>\n\n<p>I'd really like to avoid parsing schema into my own object model to do these queries and it also seems kinda redundant since I know Jing must also be doing it somewhere. The question is how to obtain the information I require from it.</p>\n\n<p>Is there another library I could use to query RNG schema from java code? Note that I'm not trying to validate instance files by using a schema, I am trying to query the schema itself.</p>\n"},{"tags":["sql","query","join","inner-join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12906243,"title":"Inefficient JOIN Method?","body":"<p>I'm trying to query two fairly large tables here to pull some results and having some trouble with effeciency. </p>\n\n<p><em>Note: I've only included relevant columns to make this not look so messy!</em></p>\n\n<p>TableA (Stock) has productID, ownerID, and count columns</p>\n\n<p>TableB (Owners) has ID, accountHolderID, and name columns</p>\n\n<p>What I'm trying to do is query TableA and where productID = X pull up Stock.productID, Stock.accountHolderID and Owners.name. The relation between these two tables is Stock.ownerID = Owners.ID so if the WHERE condition pulled say five productIDs then I'd want the name from TableB that matched up to the ownerID from TableA.</p>\n\n<p>The only unique ID in this situation is Owners.ID from TableB</p>\n\n<p>Just doing a basic SELECT query on TableA for those products takes 15 seconds however when I add an INNER JOIN to match things up to TableB the query takes significantly longer, upwards of 10 minutes. I'm guessing I've designed this query inefficiently. </p>\n\n<pre><code>SELECT\nOwners.name,\nStock.productID,\nStock.ownerID\nFROM Stock\nINNER JOIN \nOwners\nON Stock.ownerID = Owners.ID\nWHERE\nStock.productID = 42301679\n</code></pre>\n\n<p>How can I make this query more efficient?</p>\n\n<p>Would adding ORs to the WHERE condition allow me to pull multiple productIDs at once? </p>\n"},{"tags":["android","database","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12913894,"title":"Sqlite select statement not working","body":"<p>I was making a sample app where I had created a database for sqlite, I have also inserted values inside the table. But when I am using the select query, I am getting nullpointer exception.</p>\n\n<p>This is my class:</p>\n\n<pre><code>public class MainActivity extends Activity {\n\n    Button insert;\n    Button show;\n    EditText name;\n    EditText mobile;\n    SQLiteDatabase db;\n    String name_str;\n    String mob_str;\n\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.main);\n\n\n        name = (EditText)findViewById(R.id.name_editText);\n\n\n        insert = (Button) findViewById(R.id.insert_button);\n\n        insert.setOnClickListener(new OnClickListener() {\n\n            @Override\n            public void onClick(View v) {\n                //Toast.makeText(getApplicationContext(), \"Onclick works\", Toast.LENGTH_LONG).show();\n\n\n\n                name_str=name.getText().toString();\n                Toast.makeText(getApplicationContext(), name_str, Toast.LENGTH_LONG).show();\n\n                // create or open database file\n                db = openOrCreateDatabase(\"Test.db\" , SQLiteDatabase.CREATE_IF_NECESSARY,  \n                                                                                      null);\n                db.setVersion(1);\n               // db.setLocale(Locale.getDefault());\n                db.setLockingEnabled(true);\n\n                //System.out.println(\"Database Created\");\n\n             // creating table in database\n                db.execSQL(\"CREATE TABLE IF NOT EXISTS \"+\"contacts\"+\" \" +\n                                \"( id INTEGER PRIMARY KEY AUTOINCREMENT,\" +\n                                \"  name varchar, \" +\n                                \"  mobile varchar ); \");\n\n                db.execSQL(\"INSERT INTO contacts(name, mobile)VALUES ('Swift','9830098300');\");\n\n                db.execSQL(\"drop table contacts\");\n\n\n                //Database Exists check\n                File database=getApplicationContext().getDatabasePath(\"Test.db\");\n\n                if (!database.exists()) {\n                    // Database does not exist so copy it from assets here\n                    Log.i(\"Database\", \"Not Found\");\n                } else {\n                    Log.i(\"Database\", \"Found\");\n                }\n\n\n\n\n\n\n            }\n\n\n\n        });\n        show = (Button) findViewById(R.id.show_button);\n\n        show.setOnClickListener(new OnClickListener() {\n\n            @Override\n            public void onClick(View v) {\n//                //Toast.makeText(getApplicationContext(), \"Onclick works\", Toast.LENGTH_LONG).show();\n                Cursor c =db.rawQuery(\"SELECT COUNT() FROM sqlite_master WHERE name ='contacts';\",null);\n                if (c != null ) {\n                    if  (c.moveToFirst()) {\n                          do {\n        String firstName = c.getString(c.getColumnIndex(\"name\"));\n\n                          }while (c.moveToNext());\n                    }\n               }\n\n            }\n        });\n\n    }\n\n\n\n\n\n    @Override\n    public boolean onCreateOptionsMenu(Menu menu) {\n        getMenuInflater().inflate(R.menu.main, menu);\n        return true;\n    }\n\n\n\n\n\n}\n</code></pre>\n\n<p>This is the main.xml:</p>\n\n<pre><code>&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\" &gt;\n\n    &lt;TextView\n        android:id=\"@+id/name_textView\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignParentLeft=\"true\"\n        android:layout_alignParentTop=\"true\"\n        android:layout_marginTop=\"60dp\"\n        android:text=\"Name:\"\n        android:textAppearance=\"?android:attr/textAppearanceMedium\" /&gt;\n\n    &lt;EditText\n        android:id=\"@+id/name_editText\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignBaseline=\"@+id/name_textView\"\n        android:layout_alignBottom=\"@+id/name_textView\"\n        android:layout_marginLeft=\"14dp\"\n        android:layout_toRightOf=\"@+id/name_textView\"\n        android:ems=\"10\" &gt;\n\n        &lt;requestFocus /&gt;\n    &lt;/EditText&gt;\n\n    &lt;TextView\n        android:id=\"@+id/mobile_textView\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignParentLeft=\"true\"\n        android:layout_below=\"@+id/name_editText\"\n        android:layout_marginTop=\"53dp\"\n        android:text=\"Mobile: \"\n        android:textAppearance=\"?android:attr/textAppearanceMedium\" /&gt;\n\n    &lt;EditText\n        android:id=\"@+id/mobile_editText\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignBaseline=\"@+id/mobile_textView\"\n        android:layout_alignBottom=\"@+id/mobile_textView\"\n        android:layout_alignLeft=\"@+id/name_editText\"\n        android:ems=\"10\"\n        android:inputType=\"phone\" /&gt;\n\n    &lt;Button\n        android:id=\"@+id/insert_button\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignLeft=\"@+id/mobile_editText\"\n        android:layout_centerVertical=\"true\"\n        android:text=\"Insert\" /&gt;\n\n    &lt;Button\n        android:id=\"@+id/show_button\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignBaseline=\"@+id/insert_button\"\n        android:layout_alignBottom=\"@+id/insert_button\"\n        android:layout_alignRight=\"@+id/mobile_editText\"\n        android:text=\"Show\" /&gt;\n\n&lt;/RelativeLayout&gt;\n</code></pre>\n\n<p>Logcat:</p>\n\n<pre><code>10-16 17:16:28.938: D/AndroidRuntime(413): Shutting down VM\n10-16 17:16:28.938: W/dalvikvm(413): threadid=1: thread exiting with uncaught exception (group=0x4001d800)\n10-16 17:16:28.958: E/AndroidRuntime(413): FATAL EXCEPTION: main\n10-16 17:16:28.958: E/AndroidRuntime(413): java.lang.NullPointerException\n10-16 17:16:28.958: E/AndroidRuntime(413):  at com.cyberswift.database.example.MainActivity$2.onClick(MainActivity.java:97)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.view.View.performClick(View.java:2408)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.view.View$PerformClick.run(View.java:8816)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.os.Handler.handleCallback(Handler.java:587)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.os.Handler.dispatchMessage(Handler.java:92)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.os.Looper.loop(Looper.java:123)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at android.app.ActivityThread.main(ActivityThread.java:4627)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at java.lang.reflect.Method.invokeNative(Native Method)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at java.lang.reflect.Method.invoke(Method.java:521)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)\n10-16 17:16:28.958: E/AndroidRuntime(413):  at dalvik.system.NativeStart.main(Native Method)\n10-16 17:16:30.998: I/Process(413): Sending signal. PID: 413 SIG: 9\n</code></pre>\n\n<p>Exactly where am I going wrong...............</p>\n"},{"tags":["mysql","performance","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12912890,"title":"Simple MySQL query with performance issues","body":"<p>I have the following simple MySQL query:</p>\n\n<pre><code>SELECT SQL_NO_CACHE mainID\nFROM tableName \nWHERE otherID3=19\nAND dateStartCol &gt;= '2012-08-01' \nAND dateStartCol &lt;= '2012-08-31';\n</code></pre>\n\n<p>When I run this it takes 0.29 seconds to bring back 36074 results. When I increase my date period to bring back more results (65703) it runs in 0.56. When I run other similar SQL queries on the same server but on different tables (some tables are larger) the results come back in approximately 0.01 seconds.</p>\n\n<p>Although 0.29 isn't slow - this is a basic part for a complex query and this timing means that it is not scalable.</p>\n\n<p>See below for the table definition and indexes.  </p>\n\n<p>I know it's not server load as I have the same issue on a development server which has very little usage.</p>\n\n<pre><code>+---------------------------+--------------+------+-----+---------+----------------+\n| Field                     | Type         | Null | Key | Default | Extra          |\n+---------------------------+--------------+------+-----+---------+----------------+\n| mainID                    | int(11)      | NO   | PRI | NULL    | auto_increment |\n| otherID1                  | int(11)      | NO   | MUL | NULL    |                |\n| otherID2                  | int(11)      | NO   | MUL | NULL    |                |\n| otherID3                  | int(11)      | NO   | MUL | NULL    |                |\n| keyword                   | varchar(200) | NO   | MUL | NULL    |                |\n| dateStartCol              | date         | NO   | MUL | NULL    |                |\n| timeStartCol              | time         | NO   | MUL | NULL    |                |\n| dateEndCol                | date         | NO   | MUL | NULL    |                |\n| timeEndCol                | time         | NO   | MUL | NULL    |                |\n| statusCode                | int(1)       | NO   | MUL | NULL    |                |\n| uRL                       | text         | NO   |     | NULL    |                |\n| hostname                  | varchar(200) | YES  | MUL | NULL    |                |\n| IPAddress                 | varchar(25)  | YES  |     | NULL    |                |\n| cookieVal                 | varchar(100) | NO   |     | NULL    |                |\n| keywordVal                | varchar(60)  | NO   |     | NULL    |                |\n| dateTimeCol               | datetime     | NO   | MUL | NULL    |                |\n+---------------------------+--------------+------+-----+---------+----------------+\n\n\n+--------------------+------------+-------------------------------+--------------+---------------------------+-----------+-------------+----------+--------+------+------------+---------+\n| Table              | Non_unique | Key_name                      | Seq_in_index | Column_name               | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |\n+--------------------+------------+-------------------------------+--------------+---------------------------+-----------+-------------+----------+--------+------+------------+---------+\n| tableName          |          0 | PRIMARY                       |            1 | mainID                    | A         |      661990 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_otherID1                  |            1 | otherID1                   | A         |      330995 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_otherID2                  |            1 | otherID2                   | A         |          25 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_otherID3                  |            1 | otherID3                   | A         |          48 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_dateStartCol              |            1 | dateStartCol               | A         |         187 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_timeStartCol              |            1 | timeStartCol               | A         |       73554 |     NULL | NULL   |      | BTREE      |         |\n|tableName          |          1 | idx_dateEndCol                 |            1 | dateEndCol                 | A         |         188 |     NULL | NULL   |      | BTREE      |         |\n|tableName          |          1 | idx_timeEndCol                 |            1 | timeEndCol                 | A         |       73554 |     NULL | NULL   |      | BTREE      |         |\n| tableName          |          1 | idx_keyword                   |            1 | keyword                    | A         |       82748 |     NULL | NULL   |      | BTREE      |         |\n| tableName           |          1 | idx_hostname                 |            1 | hostname                   | A         |        2955 |     NULL | NULL   | YES  | BTREE      |         |\n| tableName           |          1 | idx_dateTimeCol              |            1 | dateTimeCol                | A         |      220663 |     NULL | NULL   |      | BTREE      |         |\n| tableName           |          1 | idx_statusCode               |            1 | statusCode                 | A         |           2 |     NULL | NULL   |      | BTREE      |         |\n+--------------------+------------+-------------------------------+--------------+---------------------------+-----------+-------------+----------+--------+------+------------+---------+\n</code></pre>\n\n<p>Explain Output:</p>\n\n<pre><code>+----+-------------+-----------+-------+----------------------------------+-------------------+---------+------+-------+----------+-------------+\n| id | select_type | table     | type  | possible_keys                    | key               | key_len | ref  | rows  | filtered | Extra       |\n+----+-------------+-----------+-------+----------------------------------+-------------------+---------+------+-------+----------+-------------+\n|  1 | SIMPLE      | tableName | range | idx_otherID3,idx_dateStartCol | idx_dateStartCol | 3       | NULL | 66875 |    75.00 | Using where |\n+----+-------------+-----------+-------+----------------------------------+-------------------+---------+------+-------+----------+-------------+\n</code></pre>\n"},{"tags":["query","syntax","sparql","dbpedia"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12913389,"title":"How would I query dbpedia for a list of programming languages?","body":"<p>I go to the <a href=\"http://dbpedia.org/sparql\" rel=\"nofollow\">dbPedia SPARQL Endpoint</a> and type:</p>\n\n<pre><code>select distinct ?Programming_language where {[] a ?Programming_language} LIMIT 100\n</code></pre>\n\n<p>But it just spits out a generic list of concepts like Animal, Book, Place.</p>\n\n<p>What would be the correct syntax for listing 100 programming languages?</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":46,"score":0,"question_id":12912461,"title":"sql - How can I extract all information through one statement from 3 tables?","body":"<p>I have 3 tables.</p>\n\n<p><strong>First one:</strong></p>\n\n<p>Two columns (<code>StoreID</code>, <code>Name</code>)</p>\n\n<p><strong>Second one:</strong></p>\n\n<p>Two columns (StoreID, <code>ItemID</code>)</p>\n\n<p><strong>Third one:</strong></p>\n\n<p>Three columns (ItemID, <code>Name</code>, <code>Price</code>)</p>\n\n<p>How can I write a single statement, which get <code>all StoreID</code> and <code>all names</code> and <code>all items for each StoreID</code>?</p>\n\n<p>Should I use Join or something?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":12912139,"title":"Select from MySQL table","body":"<p>I have a table and I'm trying to retrieve any row which has a number in it </p>\n\n<p>For example this:</p>\n\n<pre><code>+----------+--------------+\n| Name     | age          | \n+----------+--------------+\n| name1    |      21      | \n| name2    |      22      | \n| name3    |      21      |\n+----------+--------------+\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>SELECT * FROM table WHERE 'age' = 21;\n</code></pre>\n\n<p>the message I get from the is </p>\n\n<pre><code>Empty set, 1 warning (0.00 sec)\n</code></pre>\n\n<p>I'm not to sure what I'm doing wrong?</p>\n"},{"tags":["sql","sql-server","query","select"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12911859,"title":"SQL Select part of string","body":"<p>I have a string that looks a bit like the following:</p>\n\n<blockquote>\n  <p>189 A 190 Merit 191 68.6</p>\n</blockquote>\n\n<p>Now I want the value that falls between <code>190</code> and <code>191</code> - <code>Merit</code>.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["php","mysql","sql","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12910885,"title":"Extract Unique Orders","body":"<p>Please help me to write a SQL query to extract unique orders from below tables.  To do that I Have prepared a SQL query. It’s working fine but in some place its returning some duplicate rows as some orders have more than one products. </p>\n\n<p><strong>For Example:</strong> </p>\n\n<p>Customer can buy “IPAD” in one order. However, if they purchase “Ipad” and “Android” as bundle they will receive 50% discount and they can save money. In this case, we will get two products under 1 order. However, customer will pay as one product(i.e $120). To allocate order properly, we have created an extra row for the extra product(if products  two). If bundle contain three products, it will create three rows in “product_orders” table respectively.</p>\n\n<p><strong>Example “product_orders”</strong> table for multiple products:</p>\n\n<pre><code>id orders_id product_id qty\n 1   3      2         1\n 2   2      1         1\n 3   3      3         1\n</code></pre>\n\n<p>Please check above example table, one order_id copied twice for the bundle order.\nIf we able to extract one order information, we will get the whole bundle information. So, we don’t need the extra row.</p>\n\n<p><strong>The Query I have applied:</strong></p>\n\n<pre><code>Select \n    orders.id, \n    orders.order_price, \n    orders.purchase_date,\n    customers.email, \n    product_orders.qty, \n    products.name \nfrom \n    orders \n    INNER JOIN product_orders on orders.id=product_orders.orders_id \n    INNER JOIN products on product_orders.product_id=products._id \n    INNER JOIN customers on orders.customer_id =customers.id\n</code></pre>\n\n<p><em><strong></em><code>Result of the above query:</code>**</strong></p>\n\n<pre><code>Id  order_price  purchase_date      email        qty         name \n3  20         12/6/2011     aa@gmail.com             1   Ipad\n\n3  20         12/6/2011     aa@gmail.com             1   Android\n1  40         10/5/2011     bb@gmail.com             2  Laser hair remover\n</code></pre>\n\n<p><strong>Required Result:</strong></p>\n\n<p>remove duplicate order ID</p>\n\n<pre><code>Id  order_price  purchase_date      email        qty         name \n    3  20         12/6/2011     aa@gmail.com             1   Ipad\n\n\n    1  40         10/5/2011     bb@gmail.com             2  Laser hair remover\n</code></pre>\n\n<p><strong>Table 1: orders</strong></p>\n\n<pre><code>id  customer_id order_price purchase_date\n1   1                   0.20    12/6/2011\n2   2                   0.20    12/6/2011\n3   1                   0.20    12/6/2011\n4   1                   0.20    12/6/2011\n5   1                   0.20    12/7/2011\n6   3                   199.00  12/7/2011\n7   4                   199.00  12/7/2011\n8   5                   199.00  12/7/2011\n9   6                   199.00  12/7/2011\n10  7                   199.00  12/7/2011\n</code></pre>\n\n<p><strong>Table 2 : customers</strong></p>\n\n<pre><code>id  email                   name\n1   aa@dealboard.com.au aa\n2   bb@dealboard.com.au bb\n3   cc@live.com.au          cc\n4   dd@acgglobal.com    dd\n5   ee.heinrich@det.nsw.edu.au  ee\n6   ff@optusnet.com.au  ff\n7   ssy@hotmail.com         ss\n</code></pre>\n\n<p><strong>table 3: products</strong></p>\n\n<pre><code>id  name\n1   A Home Portable Laser Hair Remover\n2   Ipad\n3   android\n4   Asus\n5   s\n6   10 inch Android\n7   A Fabric Steamer Cleaner\n8   A Magnetic Fly Screen Door\n9   pillopw\n10  LCD\n</code></pre>\n\n<p><strong>table 4: product_orders</strong></p>\n\n<pre><code>id orders_id product_id qty\n    1   1      1         1\n    2   3      3         1\n    3   3      4         1\n    4   4      1         1\n    5   4      2         1\n    6   6      1         1\n    7   7      1         1\n    8   4      2         1\n    9   4      3         1\n    10  10     1         1\n</code></pre>\n\n<p>Please help me to extract only 1 order from “product_orders” table and the query will omit other extra rows</p>\n"},{"tags":["css","query","html5boilerplate","breakpoint","min-width"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":137,"score":3,"question_id":12903150,"title":"Why min-width: 35em and not 480px or 30em?","body":"<p>In the latest version of h5bp, you guys are using min-width:35em for the first breaking point in your queries. I was curious as to why this number specifically? Is this based on the latest smartphone screen sizes or something? Typically its usually been 480px/30em for the first break point.</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","query","jsp","hosting","localhost"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12910000,"title":"mysql remote hosting","body":"<p>Hello I have hosted a small webpage (JSP+Mysql) on Eatj.com for trial offer of 15 days.My problem is that database connection on localhost is successful but after hosting my connection string is giving exception.\ncode:</p>\n\n<pre><code>try{\n  String connectionURL = \"jdbc:mysql://pulicipaddress/dbname\"; \n\n  Connection con= null; \n  Class.forName(\"com.mysql.jdbc.Driver\"); \n  con = DriverManager.getConnection(connectionURL, \"eatjid\", \"eatjpassword\");\n...\n</code></pre>\n\n<p>it says that my connection not defined.</p>\n"},{"tags":["c#","asp.net","sql","query","odbc"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1490,"score":2,"question_id":1535994,"title":"ASP.NET Query with parameters","body":"<p>Please help me, I don't know what can be wrong with the following code:</p>\n\n<pre><code>        OdbcConnection conn = new OdbcConnection(connString);\n        String query = \"INSERT INTO customer (custId, custName, custPass, \"+\n                       \"custEmail, custAddress, custAge) VALUES (\" +\n                       \"@ID, @Name, @Pass, @Email, @Address, @Age)\";\n\n        OdbcCommand exe = new OdbcCommand(query, conn);\n        exe.Parameters.Add(\"@ID\", OdbcType.UniqueIdentifier).Value = id;\n        exe.Parameters.Add(\"@Name\", OdbcType.VarChar).Value = name;\n        exe.Parameters.Add(\"@Pass\", OdbcType.VarChar).Value = pass;\n        exe.Parameters.Add(\"@Email\", OdbcType.VarChar).Value = email;\n        exe.Parameters.Add(\"@Address\", OdbcType.VarChar).Value = address;\n        exe.Parameters.Add(\"@Age\", OdbcType.Int).Value = age;\n        conn.Open();\n        exe.ExecuteNonQuery(); // ERROR [07002] [Microsoft][ODBC Microsoft Access Driver] Too few parameters. Expected 6.\n</code></pre>\n\n<p>This code throws me <code>Too few parameters.</code> error when I am trying to execute query. The database is fine, it works fine when I hardcode values into a query, instead of using parameters.</p>\n\n<p>Thank you.</p>\n"},{"tags":["php","mysql","query","query-optimization"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12910035,"title":"How to delete a column from a MySQL big table","body":"<p>I have a 250GB 500M rows MySQL table and would like to delete one of its columns. \nThe column is VARCHAR(255). I would like to perform this operation with as little as possible down-time. Thoughts:  </p>\n\n<ol>\n<li>Is there any configuration I can add that will help this operation?</li>\n<li>Would it be better to iterate in php before on each row and delete the value inside it?</li>\n<li>Would it require OPTIMIZE TABLE afterwards?</li>\n<li>What would be a reasonable time estimation for such a procedure?</li>\n</ol>\n"},{"tags":["mysql","query","variables","split"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12877234,"title":"Split table into new multiple tables with dynamic table name assignment","body":"<p>I've a \"<strong>TableOriginal</strong>\" that I want to \"split\" into multiple tables, each one with the <strong>name</strong> of the different values than can be found on \"<em>split</em>\" column in \"<strong>tableOriginal</strong>\". The name, therefore, must be dynamic (maybe formed by a variable that is the result of a previous query).</p>\n\n<p><strong>TableOriginal:</strong></p>\n\n<pre><code>+----+-------+-------+\n| id | split | value |\n+----+-------+-------+\n| 1  |   A   |  v1   |\n| 2  |   A   |  v2   |\n| 3  |   A   |  v3   |\n| 4  |   B   |  v4   |\n| 5  |   B   |  v5   |\n| 6  |   B   |  v6   |\n| 7  |   C   |  v7   |\n| 8  |   C   |  v8   |\n| 9  |   A   |  v9   |\n| 10 |   B   |  v10  |\n| 11 |   B   |  v11  |\n| 12 |   C   |  v12  |\n+----+-------+-------+\n</code></pre>\n\n<p><strong>TableSplit_A</strong></p>\n\n<pre><code>+----+-------------+-------+\n| id | original_id | value |\n+----+-------------+-------+\n| 1  |      1      |  v1   |\n| 2  |      2      |  v2   |\n| 3  |      3      |  v3   |\n| 4  |      9      |  v9   |\n+----+-------------+-------+\n</code></pre>\n\n<p><strong>TableSplit_B</strong></p>\n\n<pre><code>+----+-------------+-------+\n| id | original_id | value |\n+----+-------------+-------+\n| 1  |      4      |  v4   |\n| 2  |      5      |  v5   |\n| 3  |      6      |  v6   |\n| 4  |      10     |  v10  |\n| 5  |      11     |  v11  |\n+----+-------------+-------+\n</code></pre>\n\n<p><strong>TableSplit_C</strong></p>\n\n<pre><code>+----+-------------+-------+\n| id | original_id | value |\n+----+-------------+-------+\n| 1  |      7      |  v7   |\n| 2  |      8      |  v8   |\n| 3  |      12     |  v12  |\n+----+-------------+-------+\n</code></pre>\n\n<h1>SQLFiddle:</h1>\n\n<p><a href=\"http://sqlfiddle.com/#!2/61266\" rel=\"nofollow\"><strong>http://sqlfiddle.com/#!2/61266</strong></a></p>\n"},{"tags":["sql","query","join"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12908921,"title":"SQL join, getting multiple columns with same name","body":"<p>I have one table with a column <code>ID</code> and <code>SERVICE_TYPE_TEXT</code>, and another table with columns</p>\n\n<pre><code>ID, SERVICE_TYPE ... \n</code></pre>\n\n<p>and lots of other columns.</p>\n\n<p>The <code>SERVICE_TYPE</code> in the second table contains the <code>ID</code> from the first table. I want to query so I can get the <code>SERVICE_TYPE_TEXT</code> from the first table that matches the <code>ID</code> given in the second table.</p>\n\n<p>I've tried to join, and setting different names on <code>ID</code> with <code>AS</code>, but always at the end of the query result I get the original ID from the first table with column name <code>ID</code>, as well as the name I defined in the AS.</p>\n\n<p>Any suggestions on how I can get the ID from the first table to stay away ? :)</p>\n"},{"tags":["sql","query","select","null","record"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":788,"score":2,"question_id":8098795,"title":"Return a value if no record is found","body":"<p>I have this simple statement that works:</p>\n\n<pre><code>SELECT idnumber FROM dbo.database WHERE number = '9823474'\n</code></pre>\n\n<p>If the number does not exist anywhere in the table, it fails. I would like to add something to this statement that says:<br>\nIF NO RECORD IS FOUND RETURN NULL INSTEAD OF NO ROW.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["mysql","sql","query","max","composite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12908254,"title":"How to find max from a composite set of rows?","body":"<p>I have a table such as :</p>\n\n<pre><code>Year | Month\n------------\n2011    10   \n2011    11   \n2012    5   \n2012    6 \n</code></pre>\n\n<p>The query should return the latest \"Month\" for the latest \"year\". </p>\n\n<p>Currently I'm doing something like </p>\n\n<blockquote>\n  <p>Select MAX(\"Month\") from table where \"Year\" in (select MAX(\"Year\") from table)</p>\n</blockquote>\n\n<p>But I'm not satisfied with query. Can someone suggest a more compact and cleaner way? </p>\n"},{"tags":["sql","query","excel","parameters"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":106,"score":2,"question_id":12082688,"title":"Excel QueryTable Parameters do not bind Sql Parameters","body":"<p>I'm new in Excel development and I have an issue that It's driving me crazy. I hope you can help me.\nLet me explain the situation, \nI'm trying to create a QueryTable to import data from SQL , but ... I get an error at the moment to refresh the QueryTable, \nthe error message indicates that I'm not passing values for required parameters. ( It works hard coded :[ )</p>\n\n<p>After many hours of investigation, I wasn't able to find a solution or an example to guide me...  And here I am :|\nI don't know what I'm doing wrong,  Here is some code </p>\n\n<pre><code>foreach (Range row in main.Rows)\n    {\n            //row.Clear();\n            rowID = row.Row;\n            if (string.IsNullOrEmpty(getAccounts(rowID, columnID)) )  \n                continue;\n\n            /*  string connectionString = // \\\"\n                    string.Format(\"OLEDB;Provider=SQLOLEDB;Data Source={0};Initial Catalog={1};User ID={2};Password={3}\",\n             */      \n\n            //string sql = \"EXECUTE [Funciones].[Cuenta_Saldo_Anho] ?,?\";\n            //if (!string.IsNullOrEmpty(txtTipoSaldo.Text)) sql +=  \",?\";\n\n           string sql = \"{CALL [Funciones].[Cuenta_Saldo_Anho] (?, ?\";\n           sql += (!string.IsNullOrEmpty(txtTipoSaldo.Text))? \"\" : \", ?\" + \")}\"; // optional parameter\n\n           var qt = wSheet.QueryTables.Add( connectionString, row.Cells , sql);\n           qt.CommandType = XlCmdType.xlCmdSql;\n\n           var ctas = qt.Parameters.Add(\"@ctas\", XlParameterDataType.xlParamTypeLongVarChar);\n           //ctas.SetParam(XlParameterType.xlConstant, cuentas);\n           ctas.SetParam(XlParameterType.xlRange, wSheet.Cells[rowID, columnID]));\n           ctas.RefreshOnChange = true;\n\n           qt.Parameters.Add(\"@anho\", XlParameterDataType.xlParamTypeInteger)\n .SetParam(XlParameterType.xlConstant, Int32.Parse(anho));\n\n           qt.Parameters.Add(\"@tipoSaldo\", XlParameterDataType.xlParamTypeVarChar)\n .SetParam(XlParameterType.xlConstant, txtTipoSaldo.Text);\n\n            //qt.BackgroundQuery = true;\n            qt.FieldNames = false;\n            qt.AdjustColumnWidth = false;\n            qt.RefreshOnFileOpen = false;\n            qt.Refresh();\n      }\n</code></pre>\n\n<p>Any help is welcome.  Thanks.</p>\n"},{"tags":["sql","query","sqlite"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":12907178,"title":"Join Found and Not Fund records on same DataResult","body":"<p>I have a single table with Id, the thing is that i need to provide N number of Ids (using  WHERE id IN (1,5,101)) but i need to get the same number of records back (if i send 100 ids, i need a DataSet with 100 rows ..) even if Id doesn't exist on this table.</p>\n\n<p>I'm using SQLite so RIGHT JOIN is not an option.</p>\n\n<p>Here is some sample of what i have but cant make it work :S ..</p>\n\n<pre><code>SELECT * FROM (\n SELECT r.report_id, r.batch_name, tr.report_id id, tr.batch_name bn\n FROM reports tr\n LEFT OUTER JOIN (  SELECT report_id, batch_name FROM reports\n                    WHERE batch_name IN (\"L6964498\",\"AAAAAA\")) r on r.report_id = tr.report_id) as v \n LEFT JOIN reports ON v.id = reports.report_id\n</code></pre>\n\n<p>Thanks in advance ...</p>\n"},{"tags":["html","wordpress","query","slider","custom-post-type"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12907076,"title":"How do I use WP_Query for a custom post type of a specific taxonomy?","body":"<p>I have a slide custom post type and I need to be able to create a query for a selected tag of this custom post type so I can create a group of these custom slider post types to show up in the slider.  So far I can't figure it out.</p>\n"},{"tags":["mysql","database","query","join","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12906215,"title":"Mysql LEFT Join query only returns one row when adding Count() mysql function","body":"<p>I have this mysql query (evolving <strong>two tables</strong>: <code>Users</code> and <code>Files</code>) that's giving me headaches:</p>\n\n<pre><code>SELECT Users.GUID, Users.Name, Users.CreationDate, Files.Date, \n    Count(Files.GUID) As FilesCount\nFROM Users\n\n    LEFT JOIN Files ON Users.GUID = Files.UserGUID\n\nWHERE Users.Group =  '1'\n</code></pre>\n\n<p>When I execute it, it <strong>always</strong> return 1 row (which is not what I want). But if I remove this:</p>\n\n<pre><code>Count(Files.Date) As FilesCount\n</code></pre>\n\n<p>It correctly return all the rows that I expect.</p>\n\n<p><strong>I basically need to get the number of files that belongs to a user</strong> (along with the user info)</p>\n\n<p><strong>My question is:</strong> How can I fix this &amp; make the mysql query return the user basic info along with the files count?</p>\n\n<p>BTW, I'm using CodeIgniter 2 with PHP 5 (although I don't think it matters here...)</p>\n"},{"tags":["sql-server","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12904498,"title":"Join type to use for reading from tables that contain templates and different numbers of items?","body":"<p>I have two tables, one that contains questions (that are considered 'templates'):</p>\n\n<pre><code>|QuestionID|QuestionText      |\n|----------|------------------|\n|1         |What is your name?|\n|2         |What is your age? |\n|-----------------------------|\n</code></pre>\n\n<p>And one that contains answers to those questions, keyed by a separate Customer ID value:</p>\n\n<pre><code>|CustID    |QuestionID|Answer |\n|----------|------------------|\n|1000      |1         |John   |\n|1000      |2         |22     |\n|2000      |1         |Alice  |\n|-----------------------------|\n</code></pre>\n\n<p>As you can see, Customer #1000 answered questions 1 and 2, and customer #2000 answered only question 1.</p>\n\n<p>I need to load these into a grid on a web page by customer, and I thought I'd just do a left outer join between the template and answer tables to get something like this:</p>\n\n<pre><code>|CustID    |QuestionID|Answer |\n|----------|------------------|\n|2000      |1         |Alice  |\n|2000      |2         |&lt;null&gt; |\n|-----------------------------|\n</code></pre>\n\n<p>So in this case, cust #2000 would come back with the <code>Answer</code> column for question #2 as null and the application would know that it needs to be answered. This is an example of the SQL I tried but no matter how many combinations of <code>OUTER</code> and <code>LEFT</code> and so on I use for the <code>JOIN</code>, I just can't get this to work with a single query:</p>\n\n<pre><code>select \n    q.QuestionID,\n    q.QuestionText,\n    a.CustID,\n    a.Answer,\nfrom \n    SurveyAnswers a  \n        full outer join SurveyQuestions q\n        on a.QuestionID = q.QuestionID\n    where \n        a.CustID = @CustomerID\n</code></pre>\n\n<p>Basically I need <em>all</em> the records in the <code>SurveyQuestions</code> table, and the value of the <code>Answer</code> column from any records in <code>SurveyAnswers</code> that match the CustomerID.</p>\n\n<p>Instead I just get the one record in <code>SurveyAnswers</code> that has an answer, and therefore is a match (I guess?) in <code>SurveyQuestions</code>. My SQL-fu is not strong.</p>\n\n<p>I also tried <code>UNION</code> and friends, but the two tables have different structures so that didn't work too well.</p>\n\n<p>I could of course pull the questions and answers separately and do the 'coalescing' in my C# code but I wanted to see if I could do it directly from the stored procedure. Thanks!</p>\n"},{"tags":["php","mysql","query","excel","format"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":91,"score":0,"question_id":12845991,"title":"How to format a CSV file using PHP and MYSQL","body":"<p>Currently I am able to query a MYSQL database using PHP and my data is imported into a CSV with no problems. However, I need to take the column data on the top row, and put it in rows on the left side instead and i need my data under each column to correlate with the correct row. So basically, I need PHP to transpose data in excel exactly like the transpose tool in excel.</p>\n\n<p><strong>Here is my current code:</strong> </p>\n\n<pre><code>ExportMysqlToCsv($tablename);\n\nfunction exportMysqlToCsv($tablename,$filename = 'Results.csv')\n{\n    $csv_terminated = \"\\n\";\n    $csv_separator = \",\";\n    $csv_enclosed = '\"';\n    $csv_escaped = \"\\\\\";\n    $sql_query = \"select * from $tablename where id=2\";\n\n    // Gets the data from the database\n    $result = mysql_query($sql_query);\n    $fields_cnt = mysql_num_fields($result);\n\n    $schema_insert = '';\n\n    for ($i = 0; $i &lt; $fields_cnt; $i++)\n    {\n        $l = $csv_enclosed . str_replace($csv_enclosed, $csv_escaped . $csv_enclosed,\n            stripslashes(mysql_field_name($result, $i))) . $csv_enclosed;\n        $schema_insert .= $l;\n        $schema_insert .= $csv_separator;\n    } // end for\n\n    $out = trim(substr($schema_insert, 0, -1));\n    $out .= $csv_terminated;\n\n    // Format the data\n    while ($row = mysql_fetch_array($result))\n    {\n        $schema_insert = '';\n        for ($j = 0; $j &lt; $fields_cnt; $j++)\n        {\n            if ($row[$j] == '0' || $row[$j] != '')\n            {\n\n                if ($csv_enclosed == '')\n                {\n                    $schema_insert .= $row[$j];\n                } else\n                {\n                    $schema_insert .= $csv_enclosed . \n                    str_replace($csv_enclosed, $csv_escaped . $csv_enclosed, $row[$j]) . $csv_enclosed;\n                }\n            } else\n            {\n                $schema_insert .= '';\n            }\n\n            if ($j &lt; $fields_cnt - 1)\n            {\n                $schema_insert .= $csv_separator;\n            }\n        } // end for\n\n        $out .= $schema_insert;\n        $out .= $csv_terminated;\n    } // end while\n\n\n    header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n    header(\"Content-Length: \" . strlen($out));\n\n // Output to browser with appropriate mime type, you choose ;)\n    header(\"Content-type: text/x-csv\");\n    header(\"Content-type: text/csv\");\n    header(\"Content-type: application/csv\");\n    header(\"Content-Disposition: attachment; filename=$filename\");\n    echo $out;\n    exit;\n}\n</code></pre>\n"},{"tags":["sql","query","sql-server-2000"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12903154,"title":"SQL Query to convert columns to rows","body":"<p>I have a table say Timesheet, which is having one week hour entry stored as a row. Eg:</p>\n\n<pre><code>ID  Start Date  Sun  Mon  Tue  Wed  Thu  Fri  Sat\n-------------------------------------------------\n1   14-Oct-2012  0    1    1    2    3    5    0\n</code></pre>\n\n<p>The start date is always Sunday's date.\nI need to export this data into multiple rows, one row for each date, based on input criteria.</p>\n\n<p>For example, if the input criteria is: Date is between 15-Oct-2012 to 17-Oct-2012, my output should be something like:</p>\n\n<pre><code>Date   Hours\n------------\n15-Oct   1\n16-Oct   1\n17-Oct   2\n</code></pre>\n\n<p>I am using SQL Server 2000, please suggest me a way.</p>\n"},{"tags":["query","sparql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12902596,"title":"SparQL query displaying results","body":"<p>i want to display the names (?m), ordered by their overall scores. Displaying the names doesn't work. Any suggestions? </p>\n\n<pre><code> SELECT ?t ?o\n    {\n    ?t ?p ?o.\n     FILTER regex(?t, \"^http://..t/semweb/recourse/university/\"). \n     FILTER regex(?p, \"^http://../semweb/ontology/overall_score\").\n     FILTER regex(?m, \"^http://../semweb/ontology/name\")\n    }\n    ORDER BY DESC(?o)\n    LIMIT 1000\n</code></pre>\n"},{"tags":["sql","query","select","join","merge"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12901930,"title":"Merge / Join SQL Select Queries","body":"<p>I am struggling  with combining the below Select Statments, I know I could cheat and add some fake columns in and then use Union, but I want to do this correctly. \nOnce I have them joined, I will be putting the Statment in to a XML file for use with Word and CRM4.</p>\n\n<pre><code>SELECT BILLTO_NAME, \n       BILLTO_LINE1, \n       BILLTO_LINE2, \n       BILLTO_LINE3, \n       BILLTO_CITY, \n       BILLTO_COUNTRY, \n       BILLTO_POSTALCODE, \n       ORDERNUMBER, \n       REQUESTDELIVERYBY, \n       MODIFIEDON, \n       SHIPTO_NAME, \n       SHIPTO_LINE1, \n       SHIPTO_LINE2, \n       SHIPTO_LINE3, \n       SHIPTO_CITY, \n       SHIPTO_STATEORPROVINCE, \n       SHIPTO_COUNTRY, \n       SHIPTO_POSTALCODE, \n       CREATEDBY \nFROM   SALESORDERBASE \n\n\n\nSELECT QUANTITY, \n       DESCRIPTION \nFROM   SALESORDERDETAILBASE \n\nSELECT NEW_ORDERNOTES, \n       NEW_NOTES \nFROM   SALESORDEREXTENSIONBASE \n</code></pre>\n\n<p>They all have the common column of SalesOrderID, which I need to add in somewhere as well.</p>\n"},{"tags":["sql-server","query","coldfusion","user-agent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12901883,"title":"Filter browser information from stored useragent data in MS SQL database","body":"<p>I have stored visitors' <code>user_agent</code> info in my MS-SQL database. Each row has this regular format:</p>\n\n<p><code>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; F-6.0SP2-20041109; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 1.1.4322; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; AskTbORJ/5.14.1.20007)</code> </p>\n\n<p>Is it possible to filter and display browser information? Something like if string contains <code>%MSIE 8.0%</code> then output as IE8, if it contains <code>%Firefox%</code> then output as Firefox and etc.</p>\n\n<p>I have searched everywhere and I can't find any help.</p>\n"},{"tags":["mysql","sql","database","query","database-design"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12900677,"title":"Fundamental database design scenario","body":"<p><strong>Problem definition:</strong> a company wants to measure customers satisfaction of their products by asking some questions. company's prducts data stores in \"products\" table, customers data of each product stores in \"customers\" table and questions of each product stores in questions table. As simple as below:</p>\n\n<blockquote>\n  <p>products: [ id, name ]</p>\n  \n  <p>customers: [ id, product_id(fk), name ]</p>\n  \n  <p>questions: [ id, product_id(fk), text ]</p>\n</blockquote>\n\n<p>the question is, how can we design a table to store answers of each customer by considering that each customer can only answer its product's question. For example, if your answer is something like this:</p>\n\n<blockquote>\n  <p>customer_answer:[ id, customer_id(fk), question_id(fk), answer ]</p>\n</blockquote>\n\n<p>then its wrong because if our table's sample data is like the following:</p>\n\n<blockquote>\n  <p>products: [ 1, \"Chair\" ], [ 2, \"Table\" ]</p>\n  \n  <p>customers:[ 1, 1, \"Anthony Quinn\" ], [ 2, 2, \"Marilyn Monroe\" ]</p>\n  \n  <p>question: [ 1, 1, \"Any suggestion for this product ?\" ], [ 2, 1, \"How\n  do you estimate this chair ?\" ]</p>\n</blockquote>\n\n<p>then there <strong>might be</strong> a possible row with below data:</p>\n\n<blockquote>\n  <p>customer_answer: [ 2, 1, 'No, thanks' ]</p>\n</blockquote>\n\n<p>that is wrong, because the customer with id #2 don't have the product_id #1, so it can be wrong table for this problem.</p>\n\n<p>What can we do in such situations ? </p>\n\n<p>it doesn't matter but BTW I'm using mysql for solving this problem.</p>\n"},{"tags":["php","mysql","query","transactions","oscommerce"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12899666,"title":"Duplicate ID being sent to the payment processor","body":"<p>Here is the scenario. This table Orders has an auto_increment column called orders_id. The table uses InnoDB storage engine. (This is not about inserting new records in the Orders table, its about how to avoid sending duplicate IDs to the processor)</p>\n\n<pre><code>orders_id       cust_id       name       address \n100              55           abc        123 street    \n101              12           def        456 street   \n</code></pre>\n\n<p>For the next order, I calculate the next available Orders_id like so</p>\n\n<pre><code>$new_order_id_query = \"SHOW TABLE STATUS LIKE ORDERS\";\n$result = tep_db_query($new_order_id_query);\n$row = tep_db_fetch_array($result);\n$new_order_id = $row['Auto_increment'];\n</code></pre>\n\n<p>Then I collect other information like name, address, items_ordered... and send it to the payment processor like this</p>\n\n<pre><code>102              44           xyz         44 Street\n</code></pre>\n\n<p>The problem is <strong>only</strong> sometimes when there are two or more orders at exactly the same time, I end up sending <strong>two orders with the same orders_id</strong> to the payment processor.</p>\n\n<p>The question is how can I make sure that I am not sending a duplicate Orders_id to the Payment Processor?</p>\n\n<p>I have been suggested to use last_insert_id() which may be right or wrong but I dont know how I can implement it. </p>\n\n<p>I read about Locking Tables - Is that a good idea for a Transaction Environment and InnoDB? If so how can I implement it?</p>\n"},{"tags":["sql","sql-server","query","nhibernate"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":81,"score":4,"question_id":12897943,"title":"Select every nth row with NHibernate","body":"<p>How would you implement a query that selects every nth row, with NHibernate QueryOver, HQL or Criteria?</p>\n\n<p>Currently I use the following T-SQL query:</p>\n\n<pre><code>SELECT * FROM (\n    SELECT *, ROW_NUMBER() OVER (ORDER BY Id) AS [Row]\n    FROM [TABLE_NAME]\n) x WHERE (x.[Row] % 100) = 0\n</code></pre>\n\n<p>(Thanks to <a href=\"http://stackoverflow.com/questions/4208366/linq-to-sql-every-nth-row-from-table\">Marc Gravell</a>)</p>\n"},{"tags":["sql","query","db2","catalog"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12888463,"title":"How to find DB2 tables that do not exist","body":"<p>I have a list of tables, and I want to check which ones do not currently exist in the target database, I can't figure out a query to return only the tables from the list that do not exist? I am running DB2 9.7.</p>\n"},{"tags":["jquery","string","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":80,"score":-1,"question_id":12842146,"title":"How to filter the string data using jQuery","body":"<p>I have a data in a string which I need to further filter the data save it in another string  variable.using jQuery.</p>\n\n<p>For example, I have</p>\n\n<pre><code> var str= 'a=\"apple\",a=\"ajax\",b=\"boy\",b=\"bird\",b=\"ball\".........';\n</code></pre>\n\n<p>rom this I want data where a=\" \", so apple,ajaxneed to be saved</p>\n\n<p>The following data is returned from web service as string format:</p>\n\n<blockquote>\n  <p>&lt;?xml\n  version=\"1.0\" encoding=\"utf-16\"?&gt;&lt;TermStore&gt;&lt;T\n  a9=\"5af46de3-630b-4cd9-aff3-4d1fbb95333c\" a21=\"false\"\n  a61=\"0\"&gt;&lt;LS&gt;&lt;TL a32=\"SharePoint\" a31=\"true\" /&gt;&lt;TL\n  a32=\"MOSS\" a31=\"false\" /&gt;&lt;TL a32=\"SharePoint 2007\" a31=\"false\"\n  /&gt;&lt;TL a32=\"SharePoint 2010\" a31=\"false\" /&gt;&lt;TL\n  a32=\"SharePoint 2013\" a31=\"false\" /&gt;&lt;TL a32=\"SharePoint Admin\"\n  a31=\"false\" /&gt;&lt;TL a32=\"SharePoint Designer\" a31=\"false\"\n  /&gt;&lt;TL a32=\"SharePoint Developer\" a31=\"false\" /&gt;&lt;TL\n  a32=\"SharePoint Infopath\" a31=\"false\" /&gt;&lt;TL a32=\"WSS\"\n  a31=\"false\" /&gt;&lt;/LS&gt;&lt;DS&gt;&lt;TD a11=\"It is an extensible\n  web based Platfrom\" /&gt;&lt;/DS&gt;&lt;TMS&gt;&lt;TM\n  a24=\"f03e532e-6e71-48c4-b499-c93efc7a4f7b\" a12=\"Microsoft\" a40=\"\"\n  a17=\"true\"\n  /&gt;&lt;/TMS&gt;&lt;/T&gt;&lt;/TermStore&gt;`</p>\n</blockquote>\n\n<p>from this I need to filter only <code>a32=\"\"</code>, values and store it in different string.</p>\n"},{"tags":["query","twitter-bootstrap","media","tablet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12860258,"title":"Twitter Bootstrap 800px tablet media query issue?","body":"<p>I'm currently building a site with bootstraps responsive layout which I have working fine in my browser but for some reason when I view the same site on my Nexus 7 tablet (Screen 1200 x 800) in portrait format the site renders with the media query @media (max-width: 767px) instead of @media (min-width: 768px) and (max-width: 979px).</p>\n\n<p>Interestingly I checked this out on bootstraps [example sites][1] and exactly the same thing happens even though the screen size is big enough for the @media (min-width: 768px) and (max-width: 979px) media query.  The correct query is loaded when the tablet is in landscape format.</p>\n\n<p>Here's bootstraps break points.</p>\n\n<pre><code>/* Large desktop */\n@media (min-width: 1200px) { ... }\n\n/* Portrait tablet to landscape and desktop */\n@media (min-width: 768px) and (max-width: 979px) { ... }\n\n/* Landscape phone to portrait tablet */\n@media (max-width: 767px) { ... }\n\n/* Landscape phones and down */\n@media (max-width: 480px) { ... }\n</code></pre>\n\n<p>Is there anything I can do to make sure the correct media query is picked up by the tablet?</p>\n"},{"tags":["c#","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12897913,"title":"C# get specific database using GetScheme","body":"<p>I am trying to figure out how I can only list specific databases in my combo box for databases.  I have several database that all contain  _Logging.  I just want the logging ones to show up in the combo box.  How do I accomplish this?  After the getScheme is called, do I need to call another query to do something like '%Logging%' query or something like that?</p>\n\n<pre><code> var databases = sqlConnection1.GetSchema(\"Databases\");\n\n            foreach (DataRow database1 in databases.Rows)\n            {\n\n                String dbName = database1.Field&lt;String&gt;(\"database_name\");\n\n                Console.WriteLine(dbName);\n\n                cmbDatabaseList.Items.Add(dbName);\n\n            }\n</code></pre>\n"},{"tags":["mysql","query","stored-procedures","plsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12895082,"title":"Why stored procedure is not giving output in one string and the stored procedure executed on MySql 6.0 gives error on MySql 5.0","body":"<p>I have following table structure</p>\n\n<pre><code>id     |      Name     | senior id\n\n1      |   superadmin  |  -1\n2      |   abc         |   1     \n3      |   xyz         |   1\n4      |   pqr         |   2   \n5      |   vwx         |   3\n6      |   stu         |   3\n7      |   efg         |   4\n8      |   ijk         |   3\n9      |   nop         |   3\n10     |   rst         |   3\n11     |   uvw         |   9\n</code></pre>\n\n<p>Here I Wrote a stored procedure which takes id as a input and will return a string of concatanated names seperated by '/' from the name associated with id to the name whose seniorid is -1.</p>\n\n<p>for example if I pass the id as 10 to SP I will expect the return string as \n<code>rst/xyz/superadmin/</code></p>\n\n<p>Here is the stored procedure that I have written</p>\n\n<pre><code>DELIMITER $$;\n\nDROP PROCEDURE IF EXISTS `mydb`.`get_list_up_to_senior`$$\n\nCREATE DEFINER=`root`@`localhost` PROCEDURE `get_list_up_to_senior`(id int (8))\n\nBEGIN\nDECLARE strsenior VARCHAR(250);\nDECLARE strseniorlist VARCHAR(250);\nDECLARE temp int(8);\nSET strsenior =  '';\nSET strseniorlist = '';\nSET temp = id;\nWHILE temp  != -1 DO\n   SET  strsenior = (SELECT name FROM mydb.tblname WHERE id = temp limit 1);\n   SET  temp = (SELECT seniorid FROM mydb.tblname WHERE id = temp limit 1);\n   SET  strseniorlist = CONCAT(strseniorlist,strsenior,'/');\nEND WHILE;\n\nSELECT strseniorlist;\nEND$$\n\nDELIMITER ;$$\n</code></pre>\n\n<p>When I compiles this SP I get compiles with no error. But when I execute this SP; its get executed perfectly and returns</p>\n\n<pre><code>strseniorlist\nsuperadmin/\n</code></pre>\n\n<p>1)What is wrong in my SP so that I am not getting desired output.</p>\n\n<p>My database version is MySQL 6.0 and I am using Sqlyog to execute above SP.</p>\n\n<p>2)When I execute the above SP on MySql 5.0 Its not get created and gives following errors</p>\n\n<pre><code>ERROR :\n\n(0 row(s) affected)\n(0 ms taken)\n\nError Code : 1064\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'PROCEDURE `get_list_up_to_senior`(id int (8))\n\nBEGIN\nDECLARE strsenior VA' at line 1\n(16 ms taken)\n</code></pre>\n\n<p>Please guide me friends in this to solve the problems \nThank You!</p>\n"},{"tags":["sql","oracle","query","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":11196744,"title":"Get a certain number of contiguous rows","body":"<p>I've got a school project, kind of huge, and only a few days left, so here is one problem I'm stuck on, hope you can help.<br>\nI've got this table: </p>\n\n<pre><code>places(id, otherInfo)\n</code></pre>\n\n<p>Simple enough, well I need to make a SQL query or PL/SQL function to retrieve a certain number of contiguous rows. For instance if I call the function using <code>getContiguousPlaces(3);</code> On the table which has the rows:</p>\n\n<pre><code>ID\n1\n4\n5\n6\n18\n19\n</code></pre>\n\n<p>I want to get rows with <code>ID</code> 4, 5 and 6.</p>\n\n<p>How could I do that?</p>\n"},{"tags":["mysql","sql","query","hsqldb","dialect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12895425,"title":"How to deal with union/order by differences between HSQLDB and MySQL?","body":"<p>I am currently using hsqldb for testing and mysql for production. This combination has worked great for me on every recent project, but I've come across a situation where HSQLDB's syntax/dialect is different from MySQL, and I'm not really sure what the best strategy is to overcome it.</p>\n\n<p>In mysql, you can write a union query like this:</p>\n\n<pre><code>select ...\nunion\nselect ...\norder by created_on desc\nlimit 20 offset 0\n</code></pre>\n\n<p>However, in HSQLDB, it complains that <code>order by</code> clause has an error.</p>\n\n<p>Is there any way I can write the query so that both databases like the syntax?</p>\n"},{"tags":["query","postgresql","where-in"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12891971,"title":"PostgreSQL: WHERE IN and NOT WHERE IN","body":"<p>I have two tables <code>A</code> and <code>B</code>, <code>A</code> referred to <code>B</code> by field <code>A.id_b B.id</code>, so that any <code>id_b</code> value present in <code>B.id</code>.</p>\n\n<p>I have three queries:\nFirst one:</p>\n\n<pre><code>SELECT COUNT(b.id)\nFROM B b\nWHERE b.id NOT IN (\n    SELECT a.id_b\n    FROM A a)\n</code></pre>\n\n<p>It gives me <code>0</code>;</p>\n\n<p>Second one, difference only in <code>NOT</code>:</p>\n\n<pre><code>SELECT COUNT(b.id)\nFROM B b\nWHERE b.id IN (\n    SELECT a.id_b\n    FROM A a)\n</code></pre>\n\n<p>This query gives me: <code>1899</code></p>\n\n<p>Third one:</p>\n\n<pre><code>SELECT COUNT(b.id)\nFROM B b\n</code></pre>\n\n<p>And this query gives me <code>3599</code></p>\n\n<p>SAME result in:</p>\n\n<pre><code>SELECT a.id_b\nFROM A a\n</code></pre>\n\n<p>guaranty me spliting <code>B.id</code> on two sets, and count of elements in both sets must much total elements count, but I have: <strong>1899 + 0 != 3599</strong>.</p>\n\n<p>How that could be?</p>\n"},{"tags":["php","mysql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12893141,"title":"query mysql php","body":"<p>I'm trying to <code>select hora from entradas where data ='some date';</code>.</p>\n\n<p><strong>table <code>entradas</code></strong></p>\n\n<pre>\n+------------+----------+\n| data       | hora     |\n+------------+----------+\n| 2012-09-27 | 07:59:11 |\n| 2012-09-27 | 16:03:27 |\n| 2012-09-28 | 16:03:35 |\n| 2012-09-29 | 09:29:16 |\n| 2012-09-29 | 09:43:05 |\n| 2012-09-29 | 09:43:14 |\n| 2012-10-01 | 08:03:10 |\n+------------+----------+\n</pre>\n\n<p>I can do it in mysql:</p>\n\n<pre>\n+----------+\n| hora     |\n+----------+\n| 09:29:16 |\n| 09:43:05 |\n| 09:43:14 |\n+----------+\n</pre>\n\n<p>but when I try it in PHP:</p>\n\n<pre><code>$consulta_data = mysql_query(\"\n  select hora from entradas where data = '2012-09-29';\n\") or die(mysql_error());\n\nwhile($row = mysql_fetch_array($consulta_data))\n{\n  echo $row[0];\n}\n</code></pre>\n\n<p>the 3 rows turn in to one and give me the result <code>09:29:1609:43:0509:43:14</code>.</p>\n\n<p>How do I output the resultset as a table in HTML, as below:</p>\n\n<pre>\nrow[0]=09:29:16\nrow[1]=09:43:05\nrow[2]=09:43:14\n</pre>\n"},{"tags":["mysql","sql","query","distinct"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12188027,"title":"MySQL SELECT DISTINCT multiple columns","body":"<p>Let's say I have columns <code>a, b c, d</code> in a table in a MySQL database. What I'm trying to do is to select the distinct values of ALL of these 4 columns in my table (only the distinct values). I tried stuff like:</p>\n\n<pre><code>SELECT DISTINCT a,b,c,d FROM my_table;\nSELECT DISTINCT a,b,c,d FROM my_table GROUP BY a,b,c,d;\n</code></pre>\n\n<p>None of those worked. Can anybody help out here?</p>\n\n<p>Thank you</p>\n\n<p><strong>NOTE</strong> I want the distinct values of the columns <code>a, b, c d</code> separately. Not the distinct combination of values</p>\n"},{"tags":["mysql","query","insert","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12528140,"title":"Reducing time taken to execute mysql query","body":"<p>I have two databases with three similar tables(mdl_user, mdl_course and mdl_course_enrol).</p>\n\n<p>The id values for users and courses in mdl_user and mdl_course are different in both the databases. Both values are referred by the third table, namely mdl_course_enrol. In database 1 the table is empty and in database 2 (nlbdb1_9), the table is filled. I am trying to execute a query such that the correct values get inputted in mdl_course_enrol. Following is my query:-</p>\n\n<pre><code>Insert into mdl_course_enrol \n(userid, courseid, registrationdate, expirydate, status, startdate, enddate, roleassignmentid)\nSelect u1.id, c1.id, t2.registrationdate, t2.expirydate, t2.status, t2.startdate, t2.enddate, t2.roleassignmentid\nfrom \nnlbdb1_9.mdl_course_enrol as t2, mdl_user as u1, mdl_course as c1\nwhere \nt2.userid=(Select u1.id from nlbdb1_9.mdl_user as u2 where t2.userid=u2.id and BINARY u2.email=BINARY u1.email)\nand\nt2.courseid=(Select c1.id from nlbdb1_9.mdl_course as c2 where t2.courseid=c2.id and BINARY c2.fullname = BINARY c1.fullname);\n</code></pre>\n\n<p>Following are the table structures:-</p>\n\n<pre><code>CREATE TABLE `mdl_course_enrol` (\n  `id` bigint(10) unsigned NOT NULL AUTO_INCREMENT,\n  `userid` bigint(10) unsigned NOT NULL,\n  `courseid` bigint(10) unsigned NOT NULL,\n  `registrationdate` bigint(10) unsigned NOT NULL,\n  `expirydate` bigint(10) unsigned NOT NULL,\n  `status` varchar(32) NOT NULL DEFAULT 'Not Attempted',\n  `startdate` bigint(10) NOT NULL,\n  `enddate` bigint(10) NOT NULL,\n  `roleassignmentid` bigint(10) unsigned NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=MyISAM AUTO_INCREMENT=14962 DEFAULT CHARSET=utf8;\n\n\nCREATE TABLE `mdl_course` (\n  `id` bigint(10) NOT NULL AUTO_INCREMENT,\n  `category` bigint(10) NOT NULL DEFAULT '0',\n  `sortorder` bigint(10) NOT NULL DEFAULT '0',\n  `fullname` varchar(254) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `shortname` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `idnumber` varchar(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `summary` longtext CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n  `summaryformat` tinyint(2) NOT NULL DEFAULT '0',\n  `format` varchar(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT 'topics',\n  `showgrades` tinyint(2) NOT NULL DEFAULT '1',\n  `sectioncache` longtext CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n  `modinfo` longtext CHARACTER SET utf8 COLLATE utf8_unicode_ci,\n  `newsitems` mediumint(5) NOT NULL DEFAULT '1',\n  `startdate` bigint(10) NOT NULL DEFAULT '0',\n  `numsections` mediumint(5) NOT NULL DEFAULT '1',\n  `marker` bigint(10) NOT NULL DEFAULT '0',\n  `maxbytes` bigint(10) NOT NULL DEFAULT '0',\n  `legacyfiles` smallint(4) NOT NULL DEFAULT '0',\n  `showreports` smallint(4) NOT NULL DEFAULT '0',\n  `visible` tinyint(1) NOT NULL DEFAULT '1',\n  `visibleold` tinyint(1) NOT NULL DEFAULT '1',\n  `hiddensections` tinyint(2) NOT NULL DEFAULT '0',\n  `groupmode` smallint(4) NOT NULL DEFAULT '0',\n  `groupmodeforce` smallint(4) NOT NULL DEFAULT '0',\n  `defaultgroupingid` bigint(10) NOT NULL DEFAULT '0',\n  `lang` varchar(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `theme` varchar(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL DEFAULT '',\n  `timecreated` bigint(10) NOT NULL DEFAULT '0',\n  `timemodified` bigint(10) NOT NULL DEFAULT '0',\n  `requested` tinyint(1) NOT NULL DEFAULT '0',\n  `enablecompletion` tinyint(1) NOT NULL DEFAULT '0',\n  `completionstartonenrol` tinyint(1) NOT NULL DEFAULT '0',\n  `completionnotify` tinyint(1) NOT NULL DEFAULT '0',\n  `coursedisplay` tinyint(2) NOT NULL DEFAULT '0',\n  PRIMARY KEY (`id`),\n  KEY `mdl_cour_cat_ix` (`category`),\n  KEY `mdl_cour_idn_ix` (`idnumber`),\n  KEY `mdl_cour_sho_ix` (`shortname`),\n  KEY `mdl_cour_sor_ix` (`sortorder`)\n) ENGINE=InnoDB AUTO_INCREMENT=45 DEFAULT CHARSET=utf8 COMMENT='Central course table';\n\nCREATE TABLE `mdl_user` (\n  `id` bigint(10) unsigned NOT NULL AUTO_INCREMENT,\n  `auth` varchar(20) NOT NULL DEFAULT 'manual',\n  `confirmed` tinyint(1) NOT NULL DEFAULT '0',\n  `policyagreed` tinyint(1) NOT NULL DEFAULT '0',\n  `deleted` tinyint(1) NOT NULL DEFAULT '0',\n  `mnethostid` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `username` varchar(100) NOT NULL DEFAULT '',\n  `password` varchar(32) NOT NULL DEFAULT '',\n  `pwdlastchange` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `idnumber` varchar(255) NOT NULL DEFAULT '',\n  `firstname` varchar(100) NOT NULL DEFAULT '',\n  `lastname` varchar(100) NOT NULL DEFAULT '',\n  `email` varchar(100) NOT NULL DEFAULT '',\n  `emailstop` tinyint(1) unsigned NOT NULL DEFAULT '0',\n  `nric` varchar(15) NOT NULL DEFAULT '',\n  `skype` varchar(50) NOT NULL DEFAULT '',\n  `yahoo` varchar(50) NOT NULL DEFAULT '',\n  `aim` varchar(50) NOT NULL DEFAULT '',\n  `msn` varchar(50) NOT NULL DEFAULT '',\n  `phone1` varchar(20) NOT NULL DEFAULT '',\n  `phone2` varchar(20) NOT NULL DEFAULT '',\n  `institution` varchar(40) NOT NULL DEFAULT '',\n  `department` varchar(30) NOT NULL DEFAULT '',\n  `address` varchar(70) NOT NULL DEFAULT '',\n  `city` varchar(20) NOT NULL DEFAULT '',\n  `country` varchar(2) NOT NULL DEFAULT '',\n  `lang` varchar(30) NOT NULL DEFAULT 'en_utf8',\n  `theme` varchar(50) NOT NULL DEFAULT '',\n  `timezone` varchar(100) NOT NULL DEFAULT '99',\n  `firstaccess` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `lastaccess` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `lastlogin` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `currentlogin` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `lastip` varchar(15) NOT NULL DEFAULT '',\n  `secret` varchar(15) NOT NULL DEFAULT '',\n  `picture` tinyint(1) NOT NULL DEFAULT '0',\n  `url` varchar(255) NOT NULL DEFAULT '',\n  `description` text,\n  `mailformat` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `maildigest` tinyint(1) unsigned NOT NULL DEFAULT '0',\n  `maildisplay` tinyint(2) unsigned NOT NULL DEFAULT '2',\n  `htmleditor` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `ajax` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `autosubscribe` tinyint(1) unsigned NOT NULL DEFAULT '1',\n  `trackforums` tinyint(1) unsigned NOT NULL DEFAULT '0',\n  `timemodified` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `trustbitmask` bigint(10) unsigned NOT NULL DEFAULT '0',\n  `imagealt` varchar(255) DEFAULT NULL,\n  `screenreader` tinyint(1) NOT NULL DEFAULT '0',\n  `nlbid` bigint(10) unsigned DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `mdl_user_mneuse_uix` (`mnethostid`,`username`),\n  KEY `mdl_user_del_ix` (`deleted`),\n  KEY `mdl_user_con_ix` (`confirmed`),\n  KEY `mdl_user_fir_ix` (`firstname`),\n  KEY `mdl_user_las_ix` (`lastname`),\n  KEY `mdl_user_cit_ix` (`city`),\n  KEY `mdl_user_cou_ix` (`country`),\n  KEY `mdl_user_las2_ix` (`lastaccess`),\n  KEY `mdl_user_ema_ix` (`email`),\n  KEY `mdl_user_aut_ix` (`auth`),\n  KEY `mdl_user_idn_ix` (`idnumber`)\n) ENGINE=MyISAM AUTO_INCREMENT=5902 DEFAULT CHARSET=utf8 COMMENT='One record for each person';\n</code></pre>\n\n<p>I am trying to run the insert query but it is taking way too long. Is there any way to reduce the time?</p>\n\n<p>Following is the output after explain select:-</p>\n\n<p><img src=\"http://i.stack.imgur.com/lzONZ.png\" alt=\"enter image description here\"></p>\n"},{"tags":["xml","query","schema","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12885933,"title":"XQuery XML Schema","body":"<p>Can one use XQuery and a simple XQuery processor to get the XML schema from some files in a directory and then process some of those files (whose names are not known in advance)? Also, can you do this while the files are in-memory, or is it better to chose an XML db?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12886602,"title":"MySQL threeway triangle query","body":"<p>I have a database of teams, schools and assignments. After choosing an assignment, the school (its users anyway) can add a team to an assignment, so that they may start working on the assignment.  The ER-diagram looks like this:\n<img src=\"http://i.stack.imgur.com/TXUom.png\" alt=\"ER-diagram of the database\">\n<strong>Important:</strong> Even though the setup of the database suggests otherwise, the team&lt;-> assignment relationship is 1:N. A team can work on only one assignment. This is controlled through the ORM-system.  </p>\n\n<p>Now here's the catch: there are teams in the database that work on assignments which do not belong to their school: the school choose the assignment, created a team and removed their assignment choice. I need to find the schools (id, name) for which this is the case.</p>\n\n<p>The best query so far that I've managed to come up with is:</p>\n\n<pre><code>SELECT schools.school_id, schools.name\nFROM schools\nLEFT JOIN teams ON schools.school_id = teams.school_id\nLEFT JOIN assignment_teams ON teams.team_id = assignment_teams.team_id\nLEFT JOIN assignment_schools ON schools.school_id = assignment_schools.school_id\nWHERE assignment_teams.assignment_id != assignment_schools.assignment_id;\n</code></pre>\n\n<p>But it doesn't work when I checked the results manually. What's the correct query that I'm looking for?</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12890487,"title":"SQL query to search between two weeks from different years","body":"<p>I have a column with week number and a column with year number. I want to search into database for a time interval, for example:</p>\n\n<p>If I want to search between a week from this year, and a week from the next year, what query should I use?</p>\n\n<p>If the year was the same that would be easy and my query will look like:</p>\n\n<pre><code>Select *\nFrom mytable\nWhere (Finish_Week BETWEEN @Finish_Week1 AND @Finish_Week2) \n       AND (Finish_Year = @Finish_Year)\n</code></pre>\n"},{"tags":["mysql","sql","query","duplicates"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12890028,"title":"Displaying duplicate row numbers","body":"<p>I joined a table to itself to find duplicate rows</p>\n\n<pre><code>select a.data, a.rowNumber, b.rowNumber\nfrom DuplicateRows as a\njoin DuplicateRows as b \non\na.data = b.data and a.Id != b.Id\ngroup by a.data, a.rowNumber, b.rowNumber\n</code></pre>\n\n<p>This query gives the results like</p>\n\n<pre><code>\"content\" | 1 | 2\n\"content\" | 1 | 6\n\"content\" | 2 | 1\n\"content\" | 2 | 6 \n...and so on\n</code></pre>\n\n<p>Howcome I rewrite it to have results formed like</p>\n\n<pre><code>\"content\" | 1 | 2, 6\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I think the question should be a little bit corrected. \nYou see I don't want to get the inversed result, I mean I just want to get \none entry </p>\n\n<pre><code>`1 -&gt; 2, 6` \n</code></pre>\n\n<p>not </p>\n\n<pre><code>`1 -&gt; 2, 6 and `2 -&gt; 1, 6`\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":12889996,"title":"Multiple counts in SQL query (MS Access)","body":"<p>Given the following simple table structure:</p>\n\n<pre><code>Travel_Request\n\nPK- ID   From1   From2  From3   From4   To1   To2   To3   To4\n--------------------------------------------------------------\n1          A       B      C       D      A     A     C     B\n2          B       A      C       D      A     A     A     B          \n3          A       B      C       D      C     A     A     B\n4          A       C      C       D      B     A     A     B\n5          A       A      C       D      A     A     A     B\n</code></pre>\n\n<p>Is there a way without using subqueries (which is easy) where I could get this sample output:</p>\n\n<pre><code>Origin   Destination   Total\n-----------------------------\nA             A          3\nA             B          1\nA             C          1\n</code></pre>\n\n<p>And so on and so forth?</p>\n"},{"tags":["query"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12889412,"title":"Using Alias in Like Query","body":"<p>I have a Query \"namePrefix + ' ' + nameFirstname + ' ' + nameSurname AS salName\".\nHow can I use it in Store Procedure Like Query?</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12886752,"title":"Query - Trying to SUM one field based on content of another field","body":"<p><strong>Table:</strong> </p>\n\n<pre><code>DayOfWeek           Enrollments\nMonday                 35\nMonday                 12\nSaturday               25\nTuesday                15\nMonday                  9\nTuesday                15\n</code></pre>\n\n<p>Basically I'm trying to sum the total enrolments for each day. </p>\n\n<p>so the Output will look like:</p>\n\n<pre><code>DayOfWeek           Enrollments\nMonday                 56\nSaturday               25\nTuesday                30\n</code></pre>\n\n<p>I've spent around 4 hours trying to work this out trying many many different ways but no luck. </p>\n\n<p>The problem I'm having is i can count how many enrollments for each day but can't have it aligned with the correct day when i run the query e.g. I want The total to be on the same line as the day it was calculated from. (I hope that is clear enough)</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":12886551,"title":"sql query not working correctly (about picking the random records)","body":"<pre><code>USE [cms]\nGO\n/****** Object:  StoredProcedure [dbo].[SpCateProductsInfo]    Script Date: 10/14/2012 00:50:25 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER proc [dbo].[SpCateProductsInfo](@cate_id int)\nas\nbegin\nselect sb.subcate_name, sum(p.qty) as totalqty, \n(select top 1 pimg_mid1 from product join subcategory\non product.subcate_id=\n(\n    select top 1 subcate_id\n    from subcategory\n    where cate_id=@cate_id\n    order by NEWID()\n)\norder by NEWID()) as pimg_mid1\nfrom subcategory sb \n  join product p on p.subcate_id = sb.subcate_id\nwhere sb.cate_id = @cate_id\ngroup by sb.subcate_name\n\n\nend\n</code></pre>\n\n<p>It is working f9, But the problem is that the pimg_mid1 column contains same entries (<strong>every row regarding the pimg_mid1 column contains same data</strong>)</p>\n\n<p>can any one tell me abt this error and the solution ???</p>\n"},{"tags":["php","mysql","query","mvc","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12886621,"title":"HOW TO DB query multi-tables relational db","body":"<h1><code>Customer table</code></h1>\n\n<pre><code>///////////////////////////////////////////////////////////\n|      id[PR]  |      name        |       email           |  \n|      10      |      fabio       |     fab@fab.com       |   \n|      11      |      james       |     james@james.com   |   \n</code></pre>\n\n<h1><code>Order table</code></h1>\n\n<pre><code>//////////////////////////////////////////////////////////////////\n|  order_id[PR]  |  ship_to[FK]  |  bill_to[FK]   | customer[FK] |  product, total, etc\n|      251       |       3       |         2      |       10     |  . . . \n</code></pre>\n\n<h1><code>Ship to table</code></h1>\n\n<pre><code>//////////////////////////////////////////////////////////////////////\n|   customer[FK]  |  ship_to[PR]  |   label   |    address           |  city, state, zip, etc\n|       10        |      3        |   office  |  123 main st         |  . . .\n|       10        |      1        |   home    |  85 some place st    |  . . .\n</code></pre>\n\n<h1><code>Bill to table</code></h1>\n\n<pre><code>///////////////////////////////////////////////////////////////////////////\n|   customer[FK]  |  bill_to[PR]  |   label   |    account                |  billing details\n|       10        |      2        |   visa    |  AES_CRYPT(temp storage)  |   . . .\n|       10        |      1        |     mc    |  AES_CRYPT(temp storage)  |   . . .\n</code></pre>\n\n<p>Ok so each customer can have multi-ship to addresses and multi-payment methods on file in their account. When they place an order the order table stores the cart and session information.</p>\n\n<p>I need to generate <code>invoices</code> how do I structure my query so that when i lookup the order table i can see the row of <code>ship to table</code> and the row of <code>bill to table</code> instead of the <code>id</code> of the row in the associated table.</p>\n\n<p>Now mind you i don't expect anyone to write my code but if you can please give me some links to read up on that would be great or an example would be awesome. Please note im building on codeigniter so im using the MVC pattern.</p>\n\n<p>? - Should all of these lookups be structured in 1 model function or should they be spread over several functions in the model?</p>\n\n<pre><code>return $this-&gt;db-&gt;get('order_table')-&gt;result();\n#this would return all the orders in the order table . \n</code></pre>\n\n<p>in my <code>view</code> i would foreach these results and make the order-id a link to more details/ invoice   page. How do i pass the values from the row to the model query to generate the proper details/invoice page?</p>\n\n<p>E.g. - So if you click on order 251, you will see a details page with an invoice that will say </p>\n\n<ol>\n<li>customer id 10</li>\n<li>name: fabio</li>\n<li>email: fab@fab.com</li>\n<li>ship to: office, 123 main st...</li>\n<li>bill to: visa, acct#, etc...</li>\n</ol>\n"},{"tags":["sql","query","sql-server-2008-r2","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12886295,"title":"sql sum some column when all other columns match","body":"<p>I have the following SQL temp table which is a result of an SQL query</p>\n\n<p><img src=\"http://i.stack.imgur.com/ffL4C.png\" alt=\"enter image description here\"></p>\n\n<p>I am trying to SUM columns <code>numitems</code> and <code>ignoreditems</code> where all the other columns match</p>\n\n<p>I tried something like the following query:</p>\n\n<pre><code>SELECT \n    catalogid, \n    sum(numitems), sum(ignoreditesm) \nFROM ##temporderstable \nGROUP BY \n    catalogid, supplierid, cname, cprice, cstock, ccode, minstock, pother4\n</code></pre>\n\n<p>I can't seem to get it to work</p>\n\n<p>I get an error </p>\n\n<blockquote>\n  <p><em>numitems doesn't belong to the table</em></p>\n</blockquote>\n\n<p>although I can see it when I run the command </p>\n\n<pre><code>select * from ##temporderstable\n</code></pre>\n"},{"tags":["query","plugins","netbeans","autocomplete"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12886455,"title":"netbeans completion provider","body":"<p>I implement auto - complete function as Netbeans Plugin. </p>\n\n<pre><code>@Override\npublic CompletionTask createTask(int queryType, JTextComponent jtc) {\n\n    if (queryType != CompletionProvider.COMPLETION_QUERY_TYPE) {\n        return null;\n    }        \n\n    return new AsyncCompletionTask(new AsyncCompletionQuery() {\n\n        @Override\n        protected void query(CompletionResultSet completionResultSet, Document document, int caretOffset) {  \n            System.out.println(\"Document: \" + document); // document variable is null\n            System.out.println(\"Caret offset: \" + caretOffset); // caretOffset is -1\n\n            // Iterate through the available locales and assign each country display name\n            // to a CompletionResultSet:\n            Locale[] locales = Locale.getAvailableLocales();\n\n            for (int i = 0; i &lt; locales.length; i++) {\n                final Locale locale = locales[i];\n                final String country = locale.getDisplayCountry();\n                if (!country.equals(\"\")) {\n                    completionResultSet.addItem(new CountriesCompletionItem(country, caretOffset));\n                }\n            }\n\n            completionResultSet.finish();\n        }\n    });\n}\n</code></pre>\n\n<p>I have 2 problems with this code:</p>\n\n<ol>\n<li>document variable is always null</li>\n<li>caretOffset is always -1</li>\n</ol>\n\n<p>Why???</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","sql","database","query","data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12885607,"title":"Merge tables into One WITH same generated number in both new tables","body":"<p>I found some options to run a myslq query to migrate/split one table into 2 new tables, but one of the fields I would like to create on the new table has to be the same as in the other new table:</p>\n\n<p>So from the \"From_payments\" table, I would like to create 2 new tables called: \"To_paymenttransaction\" and \"To_paymentinfo\". A lof of the field are predefined and some are from the old table. The only problem is that the predefined field \"paymentinfoid\" has to be the same is both new tables. </p>\n\n<pre><code>**To_paymenttransaction** --- &lt; --- **From_payments**\n\npaymenttransactionid ------- &lt; --- (Generate next available number in this column)\n\npaymentinfoid -------------- &lt; --- (Generate next available number in this column)\n\ntransactionid --------------- &lt; --- txn_id\n\nstate ---------------------- &lt; --- (Set all to \"1\")\n\namount -------------------- &lt; --- mc_gross\n\ncurrency ------------------- &lt; --- mc_currency\n\ndateline -------------------- &lt; --- payment_date\n\npaymentapiid --------------- &lt; --- (Set all to \"1\")\n\nrequest -------------------- &lt; --- (Set all to \"NULL\")\n\nreversed ------------------- &lt; --- (Set all to \"0\")\n\n**To_paymentinfo** -----------&lt; \n\npaymentinfoid -------------- &lt; --- (Same generated number that goes to the paymentinfoif field in To_paymenttransaction table )\n\nhash ----------------------- &lt; --- (Set all to \"Imported\")\n\nsubscriptionid --------------- &lt; --- (Set all to \"1\")\n\nsubscriptionsubid ------------ &lt; --- (\"2\" IF above field mc_gross is 4, \"1\" IF above field mc_gross is 6, \"0\" IF above field mc_gross is 10)\n\nuserid   ---------------------- &lt; --- userid\n\ncompleted ------------------ &lt; --- (Set all to \"0\")\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>All help is greatly appreciated.</p>\n\n<p>Thanks you!</p>\n"},{"tags":["sql","sql-server","query","tsql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12863074,"title":"t-sql query with deep joining","body":"<p>I'm having a little trouble of getting a fast sql-query on this. I've managed to get a query to return the result I want but it takes about 2 sek to run even with the right indexes.</p>\n\n<p>I have these tables:</p>\n\n<pre><code>[Login]\nloginID\nloginTime\nuserID\n\n[user]\nuserID \nuserName\n\n[companyParticipant]\nuserID\ncompanyID\n\n[company]\ncompanyID\norganisationID\nCompanyName\n</code></pre>\n\n<p>What I want to show is all the top 10 latest logins persons with loginTime. Where the user is in a company that I am a participant or a company within the organisations where I am member of a company of that organisation</p>\n\n<p>To get my organisations:</p>\n\n<pre><code>SELECT organisationID \nFROM companys \nWHERE companyID IN (\n    SELECT companyID \n    FROM companyParticipant \n    WHERE userID = @userID) \nGROUP BY organisationID \n</code></pre>\n\n<p>So what i want i a query like this:</p>\n\n<pre><code>SELECT TOP 10 userName, LoginTime \nFROM ....\nORDER BY loginID\n</code></pre>\n"},{"tags":["sql","database","query","metadata"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":50,"score":-4,"question_id":12884953,"title":"Software that analyzes schema metadata and outputs user language queries","body":"<p>I am a student and I am planning to propose my own master thesis topic. </p>\n\n<p>I am interested in databases. So I am more inquisitive about database engine working and query parsers. </p>\n\n<p>I am wondering whether there exists any non-traditional software that analyzes the given db-schema and process the user custom queries (not in SQL format, in general language) and parses them against analyzed schema and retrieves the data by creating queries or dynamic queries. </p>\n\n<p>I mean user question to the engine can be like this: \"fetch me employees whose salary is greater than 10K and who work in CS department at senior management level\". </p>\n\n<p>My assumption is that the schema exists but no pre-query is written, and the engine should build the required SQL query dynamically for the user question (or can be any other alternative) and retrieve the results. My intention is work based on db-metadata and indexing it by engine to have faster results. </p>\n\n<p>If no such system exists,  I am interested to start it as my Master thesis project. On successful completion, it can completely eliminate manual sql queries. </p>\n"},{"tags":["mysql","sql","wordpress","query","csv"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12855854,"title":"Export WordPress Posts and Meta Information in CSV format using SQL Query","body":"<p><em>Apologies, this is a <a href=\"http://wordpress.stackexchange.com/questions/67798/export-wordpress-posts-and-meta-information-in-csv-format\">duplicate of entry of this post</a> but I found I'm not getting the right answer there and not sure how to ask to move it over to SO?</em></p>\n\n<p>I need to export all WordPress Posts and related Meta information using an SQL query in CSV format. I've managed to export just the Posts but realised that the Meta information is in another table.</p>\n\n<p>Could someone please tell me how I would go about doing this please?</p>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT: I have already tried a number of plugins, none of which have worked for this specific scenario. I really do need to work on the query itself. Thanks</strong></p>\n\n<p><strong>EDIT: The final outcome of the CSV file should look something like this. On one row, these are the columns that I will end up with. (I will delete the additional columns in CSV, I'm just giving a shortened version here)</strong></p>\n\n<pre><code>post_content | post_title | **meta_key** | *meta_value* | **meta_key** | *meta_value* | **meta_key** | *meta_value* | **meta_key** | *meta_value* | **meta_key** | *meta_value* \n</code></pre>\n\n<p>So one post per row with the meta information in the same row.</p>\n\n<p><strong>EDIT: With the S-ha-dum, I've managed to get some way, but I have about 12 meta_value > meta_key values to pull out of the DB so I need help to write the rest of the query please</strong></p>\n\n<pre><code>SELECT *,(SELECT meta_value FROM wp_postmeta WHERE wp_postmeta.meta_key = 'Publisher' AND wp_postmeta.post_id = wp_posts.ID) as Publisher FROM wp_posts\n</code></pre>\n"},{"tags":["query","sparql","ontology"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12817346,"title":"Sparql substract instance","body":"<p>I have an anthology, I created an interface for evaluation or there is a submit button. This button allows you to calculate the difference between the old value and the value 20. I try to select an instance with sparql and I would evaluate an instance subtracts the old value with the value 20.</p>\n\n<pre><code>valider.addActionListener(new ActionListener()\n    {\n        public void actionPerformed(ActionEvent e)\n        {\n            Model m=ModelFactory.createMemModelMaker().createModel(null);\n            FileManager.get().readModel( m, owlFile );\n            String myOntologyName = \"ProjetHela\";\n            String uri=\"file:///C:/Project/Krs1.owl\";\n            // Définition de prefixe pour simplifier l'utilisation de SPARQL\n            String reuses = \"maj: &lt;\"+RDF.getURI()+\"&gt;\" ;\n            // String myOntologyPrefix = \"PREFIX \"+myOntologyName+\": &lt;\"+myOntologyNS+\"&gt;\" ;\n            String myOntologyPrefix = \"PREFIX \"+myOntologyName+\": &lt;\"+uri+\"&gt;\" ;\n            // if (liste.getSelectedItem().toString().equals(\"GMP: Puissance=60352 Watt,limite supérieure= 73500 Watt\")) {\n            String queryString= \n                \"PREFIX maj: &lt;http://www.owl-ontologies.com/reuses.owl#&gt;\"\n                + \"SELECT ?hasnameevaluated\"\n                + \" WHERE \"\n                + \"{\"\n                + \"?Besoin maj:hasnameevaluated ?hasnameevaluated \"\n                +\"FILTER (?hasnameevaluated - 20)  \"\n                + \" } \";\n            Query query = QueryFactory.create(queryString) ;\n\n            QueryExecution qexec = QueryExecutionFactory.create(query, m) ;\n            try  {\n                ResultSet rs = qexec.execSelect() ;\n\n                // Affichage des resultats\n                for ( ; rs.hasNext() ; ){\n                //System.out.print(\"\");\n                QuerySolution rb = rs.nextSolution() ;\n                String y = rb.getLiteral(\"hasnameevaluated\").getString();\n                System.out.println( \" \" + y);\n                }}  finally {\n                    qexec.close() ;\n\n                    }\n                }   \n            }\n\n\n    );\n</code></pre>\n\n<p>but it doesn't work\nplease help me</p>\n"},{"tags":["sql","query","sql-server-2008-r2","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12884168,"title":"SQL join with sum","body":"<p>Hello i've the following SQL Query which produces the following result</p>\n\n<pre><code>SELECT * FROM\n     (\n     Select\n        catalogid, numitems, allitems - numitems ignoreditems\n     from\n         ( \n             select\n                 i.catalogid,\n                 case\n                     when Exists(select paymentodate from payentmethodvalidation q where q.paymentnoodate = o.ocardtype) AND NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) then sum(i.numitems)\n                     when Exists(select paymentodate from payentmethodvalidation q where q.paymentodate = o.ocardtype) AND odate is not null AND NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) then sum(i.numitems)\n                 else 0 end numitems,\n                 sum(numitems) allitems \n             from \n                 \"orders o\n             inner join\n                 \"oitems i \n             on \n                 \"i.orderid=o.orderid\n             inner join\n                 \"products T1\n             on \n                 \"T1.catalogid = i.catalogid\n             group by \n                 \"i.catalogid, ocardtype, odate,o.orderid\n         ) A\n     ) B\n     INNER JOIN\n     (\n         SELECT \n             catalogId, \n             ProcessedSucssessfully = \n                STUFF((SELECT ', ' + CAST( b.orderid as varchar(10))\n                       FROM oitems b JOIN orders o ON b.orderid = o.orderid \n                       WHERE b.catalogId = a.catalogId \n                       AND  NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) AND (Exists(select paymentodate from payentmethodvalidation q where q.paymentnoodate = o.ocardtype) OR Exists(select paymentodate from payentmethodvalidation q where q.paymentodate = o.ocardtype) and o.odate is not null)\n                       FOR XML PATH('')), 1, 2, ''), \n                           \"NotProcessed = \n                 STUFF((SELECT ', ' + CAST( c.orderid as varchar(10))\n                        FROM oitems c JOIN orders o ON c.orderId = o.orderid\n                        WHERE c.catalogid = a.catalogid \n                        AND (o.ocardtype in ('mastercard') OR o.ocardtype is null) and o.odate is null\n                        FOR XML PATH('')), 1, 2, '') \n         FROM \n             oitems a \n         GROUP BY \n             a.catalogid \n     )C\n         ON \n             B.catalogid = C.catalogid \n</code></pre>\n\n<p>the the result of this query you can see in the following image\n<img src=\"http://i.stack.imgur.com/T9k80.png\" alt=\"enter image description here\"></p>\n\n<p>you see those 2 circled rows, i want them to be in a one row that will only sum the numitems, the processed successfully value and all other values will be always the same for the records the share catalogid so no problem with them.</p>\n\n<p>basicly the result row should have the sum of the numitem valuse in all rows that have the same catalogid</p>\n\n<p>so how can i solve this problem?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12882875,"title":"returns sometimes blank row with the use of two random records","body":"<p>I have three tables:</p>\n\n<ul>\n<li><p><code>product (p_id(pk), subcate_id, pname)</code>.</p></li>\n<li><p><code>cate(cate_id(pk), cate_name)</code>.</p></li>\n<li><p><code>subcate(subcate_id(pk), cate_id, subcate_name )</code>.</p></li>\n</ul>\n\n<p>I want that pass a <code>cate_id</code> and get a random <code>subcate_id</code> and then on the behalf on those <code>subcate_ids</code>, get a random <code>record</code>(<code>pname</code>) from product table.</p>\n\n<p>So I have tried the following code:</p>\n\n<pre><code>select top 1 pname from product join subcategory\non product.subcate_id=\n(\n    select top 1 subcate_id\n    from subcategory\n    where cate_id=3\n    order by NEWID()\n)\norder by NEWID()\n</code></pre>\n\n<p>But the problem is that this code <em>returns sometimes blank row</em>. <strong>Why?</strong></p>\n\n<p>Is there any error in my code?</p>\n"},{"tags":["sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12883034,"title":"Receive (bind) the data coming from two select commands n a single proc in SQL Server","body":"<pre><code> create proc [dbo].[SpCateProducts](@cate_id int)\n    as\nbegin\n    select sb.subcate_name, sum(p.qty)\n    from subcategory sb \n      join product p on p.subcate_id = sb.subcate_id\n    where sb.cate_id = @cate_id\n    group by sb.subcate_name\n\n        select top 1 pname from product join subcategory\n    on product.subcate_id=\n    (\n        select top 1 subcate_id\n        from subcategory\n        where cate_id=3\n        order by NEWID()\n    )\nend\n</code></pre>\n\n<p>but it is returning two tables, then how can I bind it to the listview?</p>\n\n<p>Or is there any way that it will returns a single table, which will contain all these required rows of data?</p>\n\n<p>I mean that that 1st one select command already giving a table of 4 rows and 4 columns, then is there any way that it will contain one more column (<code>pname</code>) which is currently returning by 2nd select command</p>\n"},{"tags":["android","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":295,"score":0,"question_id":7882580,"title":"SQLite and Android Exception","body":"<p>I am facing problem in android application i want to create database with following script.</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS events (\n_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\nsource_device_id INT,\ntimestamp INT NOT NULL,\nprocessed BOOLEAN DEFAULT FALSE,\nevent_type TINYINT NOT NULL,\npayload BLOB);\n\nCREATE INDEX IF NOT EXISTS events_unprocessed ON events (processed, _id);\n</code></pre>\n\n<p>and my android code is </p>\n\n<pre><code>public void onCreate(SQLiteDatabase db) {\n  InputStream schemaStream = context.getResources().openRawResource(R.raw.logdb_schema);\n  Scanner schemaScanner = new Scanner(schemaStream, \"UTF-8\");\n  schemaScanner.useDelimiter(\";\");\n\n  Log.i(TAG, \"Creating database\");\n  try {\n    db.beginTransaction();\n    while (schemaScanner.hasNext()) {\n      String statement = schemaScanner.next();\n      Log.d(TAG, \"Creating database: \" + statement);\n      db.execSQL(statement);\n    }\n    db.setTransactionSuccessful();\n  }\n  finally {\n    db.endTransaction();\n  }\n}\n</code></pre>\n\n<p>Its not working its generating run-time exception:</p>\n\n<blockquote>\n  <p>android.database.sqlite.SQLiteException: not an error:</p>\n</blockquote>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":38,"score":-2,"question_id":12882404,"title":"How can I join 3 tables?","body":"<p>I have 3 mysql tables. The first table(<code>tb_user</code>) or the parent table have columns <code>region_id</code> and <code>institution_id</code> and both can also be found from a different tables:</p>\n\n<ul>\n<li><code>region_id</code>(table: <code>tb_region</code>), and </li>\n<li><code>institution_id</code>(table: <code>tb_institutional_profile</code>).</li>\n</ul>\n\n<p>How do I query it to get all the columns in <code>tb_user</code> and display names(<code>region_name</code> from <code>tb_region</code> and <code>institution_name</code> form <code>tb_institutional_profile</code>) and not <code>ID</code>s.?</p>\n"},{"tags":["ruby-on-rails-3","query","activerecord","active-relation"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":277,"score":0,"question_id":10042270,"title":"Rails 3 query in multiple date ranges","body":"<p>Suppose we have some date ranges, for example:</p>\n\n<pre><code>ranges = [\n          [(12.months.ago)..(8.months.ago)],\n          [(7.months.ago)..(6.months.ago)],\n          [(5.months.ago)..(4.months.ago)],\n          [(3.months.ago)..(2.months.ago)],\n          [(1.month.ago)..(15.days.ago)]\n         ]\n</code></pre>\n\n<p>and a <code>Post</code> model with <code>:created_at</code> attribute.</p>\n\n<p>I want to find posts where <code>created_at</code> value is in this range, so the goal is to create a query like:</p>\n\n<pre><code>SELECT * FROM posts WHERE created_at \n    BETWEEN '2011-04-06' AND '2011-08-06' OR\n    BETWEEN '2011-09-06' AND '2011-10-06' OR\n    BETWEEN '2011-11-06' AND '2011-12-06' OR\n    BETWEEN '2012-01-06' AND '2012-02-06' OR\n    BETWEEN '2012-02-06' AND '2012-03-23';\n</code></pre>\n\n<p>If you have only one range like this:</p>\n\n<pre><code>range = (12.months.ago)..(8.months.ago)\n</code></pre>\n\n<p>we can do this query:</p>\n\n<pre><code>Post.where(:created_at =&gt; range)\n</code></pre>\n\n<p>and query should be:</p>\n\n<pre><code>SELECT * FROM posts WHERE created_at \n    BETWEEN '2011-04-06' AND '2011-08-06';\n</code></pre>\n\n<p>Is there a way to make this query using a notation like this <code>Post.where(:created_at =&gt; range)</code>?</p>\n\n<p>And what is the <em>correct</em> way to build this query?</p>\n\n<p>Thank you</p>\n"},{"tags":["mysql","sql","performance","query","sql-update"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12812331,"title":"How to efficiently UPDATE a column when it requires joining 2 large tables in MySQL?","body":"<p>I've got 2 tables, named: <code>csv (a csv dump)</code>, and <code>items (primary data table)</code> with 7M (csv dump) and 15M rows respectively. I need to update a column in <code>items</code> that exists in table <code>csv</code>.</p>\n\n<p>Both tables have a commonly indexed join ID (a <code>VARCHAR(255)</code>).</p>\n\n<p>An UPDATE query with a join on the mutual ID column (indexed) still takes multiple days to run. After researching it  I believe the inefficiency is in MySQL scanning the <code>csv</code> table and making per-row random-access queries against the <code>items</code> table.</p>\n\n<p>Even though there are indexes, those indexes don't fit in memory, so the required 7M random access queries are nose diving performance.</p>\n\n<p>Are there \"typical\" ways of addressing this kind of issue?</p>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<blockquote>\n  <p>We're basically taking multiple catalogs of \"items\" and storing them\n  in our <code>items</code> table (this is bit of a simplification for discussion).\n  Each of say 10 catalogs will have 7M items (some duplicates across catalogs that we\n  normalize to 1 row in our item table). We need to compare and\n  verify changes to those 10 catalogs daily (<code>UPDATES</code> w/ joins between two big\n  tables, or other such mechanism).</p>\n  \n  <p>In reality we have an <code>items</code> table and an <code>items_map</code> table, but no\n  need to discuss that additional level of abstraction here. I'd be\n  happy to find a way to perform an update between the <code>csv</code> dump table\n  and an <code>items</code> table (given that they both have a common ID that's\n  indexed in both tables). But  given that the <code>items</code> table might have\n  20M rows, and the <code>csv</code> table might have 7M rows.</p>\n  \n  <p>In this case indexes don't fit in memory and we're hammering the drive with random seeks I believe</p>\n</blockquote>\n"},{"tags":["c#","database","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12880950,"title":"Calculate the retrieved rows in database","body":"<p><img src=\"http://i.stack.imgur.com/46urR.png\" alt=\"Form1\"></p>\n\n<p>I am new in Visual C# and would want to know how to calculate the retrieved data from a database.</p>\n\n<p>Using the above GUI, when \"Calculate\" is click, the program will display the number of students in textBox1, and the average GPA of all students in textBox2.</p>\n\n<p>Here is my database table \"Students\":</p>\n\n<p><img src=\"http://i.stack.imgur.com/rrNFp.png\" alt=\"enter image description here\"></p>\n\n<p>I was able to display the number of students but I'm still confused to how I can calculate the average GPA</p>\n\n<p>Here's my code:</p>\n\n<pre><code>    private void button1_Click(object sender, EventArgs e)\n    {\n            string connection = @\"Provider=Microsoft.ACE.OLEDB.12.0;Data  Source=C:\\Database1.accdb\";\n            OleDbConnection connect = new OleDbConnection(connection);\n\n        string sql = \"SELECT * FROM Students\";\n        connect.Open();\n        OleDbCommand command = new OleDbCommand(sql, connect);\n        DataSet data = new DataSet();\n        OleDbDataAdapter adapter = new OleDbDataAdapter(command);\n        adapter.Fill(data, \"Students\");\n\n        textBox1.Text = data.Tables[\"Students\"].Rows.Count.ToString();\n\n        double gpa;\n        for (int i = 0; i &lt; data.Tables[\"Students\"].Rows.Count; i++)\n        {\n            gpa = Convert.ToDouble(data.Tables[\"Students\"].Rows[i][2]);\n        }\n\n        connect.Close();\n    }\n</code></pre>\n"},{"tags":["php","mysql","query","logging","doctrine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12880976,"title":"MySQL - How to track every query?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6479107/how-to-enable-mysql-query-log\">How to enable MySQL Query Log?</a>  </p>\n</blockquote>\n\n\n\n<p>Is there a way to track every SQL query in MySQL?</p>\n\n<p>Im using Doctrine ORM to build entities and fetch them from database, and would like to see what queries is Doctrine producing. So when I refresh a webpage that uses Doctrine ORM to fetch some data from database, where could I see queries executed in database?</p>\n\n<p>Is this possible?</p>\n"},{"tags":["php","mysql","query","loops"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12880291,"title":"How to query all fields in a row","body":"<p>I know this is very simple, but I haven't used PHP/MySQL in a while and I have been reading other threads/php website and can't seem to get it.</p>\n\n<p>How can I query a single row from a MySQL Table and print out all of the fields that have data in them? I need to exclude the NULL fields, and only add those that have data to an html list.</p>\n\n<p>To clarify, I would like to display the field data without specifying the field names, just for the reason that I have a lot of fields and will not know which ones will be NULL or not.</p>\n"},{"tags":["php","mysql","query","insert","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12879294,"title":"First time mysqli, having INSERT error","body":"<p>I'm getting the following error from the following code. Connection works with no errors, all the input columns are correct, and I've dumbed down the inputs to just 0's to make sure it wasn't the variables I was passing. Any help would be greatly appreciated. MySQL ver 5.5.28.</p>\n\n<blockquote>\n  <p>FAILURE You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax to use\n  near 'keys, values, childID, accessID) VALUES ('0','0','0','0')' at\n  line 1</p>\n</blockquote>\n\n<pre><code>$query=\"INSERT INTO carts (keys, values, childID, accessID)\n                    VALUES\n                    ('0','0','0','0')\";\n                    echo $query;\nif (mysqli_query($link, $query) == FALSE) {echo \"FAILURE \" . mysqli_error($link);}\n</code></pre>\n\n<p>Been working 20 hours without sleep so if this a facepalm moment, I wont be surprised. I will say that I've never used mysqli, just mysql commands.</p>\n"},{"tags":["sql","query","select","sql-server-2008-r2","case"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12879041,"title":"SQL Cannot perform an aggregate function on an expression containing an aggregate or a subquery","body":"<p>I am new to SQL and I've the following SQL Query</p>\n\n<pre><code>select catalogid, numitems, allitems - numitems ignoreditems\n from (\n  select i.catalogid,\" \n    sum(case when (ocardtype in ('PayPal','Sofort') OR\n                   ocardtype in ('mastercard','visa') and\n                   odate is not null) AND NOT EXISTS (select CAST(booked AS INT) FROM bookedordersids b where b.booked = o.orderid)\n                   then numitems\n                   else 0 end) numitems,\n    sum(numitems) allitems\n  from orders o\n  join oitems i on i.orderid=o.orderid\n  group by i.catalogid\n ) X\n</code></pre>\n\n<p>and it gives me the following error</p>\n\n<pre><code>Cannot perform an aggregate function on an expression containing an aggregat or a subquery\n</code></pre>\n\n<p>When I remove the following line it works fine</p>\n\n<pre><code>AND NOT EXISTS (select CAST(booked AS INT) FROM bookedordersids b where b.booked = o.orderid)\n</code></pre>\n\n<p>but it's important to do this check; how can I fix this?</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12878973,"title":"Error in using EXCEPT with INTERSECT in SQL","body":"<p>Suppose I have three tables Table A,Table B and Table C.</p>\n\n<p>Table A contains the col t1 with entries 1,2,2,3,4,4.<br>\nTable B has col t2 with entries 1,3,4,4.<br>\nTable C has col t3 with entries 1,2,4,4. </p>\n\n<p>The query given was</p>\n\n<pre><code>SELECT * FROM  A EXCEPT (SELECT * FROM  B INTERSECT SELECT * FROM C ).\n</code></pre>\n\n<p>I saw this question in a test paper. It was mentioned that the expected answer was 2 but the answer obtained from this query was 1,2,4. I am not able to understand the principle behind this.</p>\n"},{"tags":["sql","query","postgresql","optimization","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":85,"score":3,"question_id":12875060,"title":"Optimizing an SQL query","body":"<p>Using PostgreSQL 8.4 and with a table such as this:</p>\n\n<pre><code>create table log (\n    id bigint primary key,\n    first_sn bigint not null,\n    last_sn bigint not null\n);\n</code></pre>\n\n<p>where first_sn and last_sn represent a range of serial numbers, and the table holding > 1 million rows, what sort of index and query should I use if I want to search for all rows where  the serial number range contain an element in a list of serial numbers.</p>\n\n<p>For example, for a list [5348491, 1230505, 5882233] I'm currently doing:</p>\n\n<pre><code>select 5348491, *\nfrom log\nwhere 5348491 between first_sn and last_sn\nunion\nselect 1230505, *\nfrom log\nwhere 1230505 between first_sn and last_sn\nunion\nselect 5882233, *\nfrom log\nwhere 5882233 between first_sn and last_sn;\n</code></pre>\n\n<p>But that's a bit slow.</p>\n\n<p>Edit: A query like that will take around 600ms and I would like to be able to search with a list of >10k serial numbers.</p>\n\n<p>Since someone requested it, here's the real table, query and an explain analyze (I hesitated since all the column names are in spanish, but in the previous example 'id' would be 'movimiento_id' here, 'first_sn' would be 'serial_inicial' , and 'last_sn' would be 'serial_final'. 'tipo_movimiento' is the type of event and really it's just a way to filter the resultset further):</p>\n\n<pre><code>    CREATE TABLE movimiento\n(\n  movimiento_id bigserial NOT NULL,\n  serial_inicial bigint NOT NULL,\n  serial_final bigint NOT NULL,\n  serial_chip bigint,\n  numero_telefono text,\n  fecha_movimiento timestamp without time zone DEFAULT now(),\n  producto_id integer NOT NULL,\n  usuario_id integer NOT NULL,\n  factura_proveedor text,\n  fecha_ingreso date,\n  fecha_venta date,\n  vendedor_id integer,\n  cliente_id integer,\n  tipo_movimiento text NOT NULL,\n  costo numeric(12,4),\n  precio numeric(10,2),\n  descuento double precision,\n  bodega_id integer NOT NULL DEFAULT 1,\n  fecha_activo timestamp without time zone,\n  factura text,\n  envio text,\n  documento text,\n  bodega_id_origen integer,\n  fecha date,\n  traslado_id integer,\n  detalle_factura_id bigint,\n  es_venta boolean DEFAULT false,\n  CONSTRAINT movimiento_pkey PRIMARY KEY (movimiento_id ),\n  CONSTRAINT movimiento_bodega_id_fkey FOREIGN KEY (bodega_id)\n      REFERENCES bodega (bodega_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_bodega_id_origen_fkey FOREIGN KEY (bodega_id_origen)\n      REFERENCES bodega (bodega_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_cliente_id_fkey FOREIGN KEY (cliente_id)\n      REFERENCES cliente (cliente_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_producto_id_fkey FOREIGN KEY (producto_id)\n      REFERENCES producto (producto_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_usuario_id_fkey FOREIGN KEY (usuario_id)\n      REFERENCES usuario (usuario_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_vendedor_id_fkey FOREIGN KEY (vendedor_id)\n      REFERENCES vendedor (vendedor_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT movimiento_check CHECK (serial_final &gt;= serial_inicial),\n  CONSTRAINT movimiento_costo_check CHECK (costo &gt;= 0::numeric),\n  CONSTRAINT movimiento_descuento_check CHECK (descuento &gt;= 0::double precision),\n  CONSTRAINT movimiento_precio_check CHECK (precio &gt;= 0::numeric),\n  CONSTRAINT movimiento_tipo_movimiento_check CHECK (tipo_movimiento = ANY (ARRAY['Ingresado'::text, 'Vendido'::text, 'Entregado'::text, 'Regresado'::text, 'Eliminado'::text, 'Devuelto'::text, 'Inconforme'::text, 'Trasladado'::text, 'Consignado'::text, 'Devolucion Consignado'::text, 'Activado'::text, 'Devolucion Claro'::text, 'Asignado'::text, 'Fusion-Sale'::text, 'Fusion'::text, 'Separacion-Sale'::text, 'Separacion'::text]))\n)\nWITH (\n  OIDS=TRUE\n);\n</code></pre>\n\n<p>Here's the query:</p>\n\n<pre><code>    explain analyze select 869461009867643, *\nfrom movimiento\nwhere (869461009867643 between serial_inicial and serial_final)\nand tipo_movimiento = 'Ingresado'\nunion all\nselect 12121001477546, *\nfrom movimiento\nwhere 12121001477546 between serial_inicial and serial_final\nand tipo_movimiento = 'Ingresado'\nunion all\nselect 354689040208615, *\nfrom movimiento\nwhere 354689040208615 between serial_inicial and serial_final\nand tipo_movimiento = 'Ingresado';\n</code></pre>\n\n<p>And the explain analyze:</p>\n\n<pre><code>Append  (cost=7542.94..185580.33 rows=232322 width=165) (actual time=93.222..571.928 rows=4 loops=1)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7542.94..61089.00 rows=90645 width=165) (actual time=93.220..206.248 rows=1 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        Filter: ((869461009867643::bigint &gt;= serial_inicial) AND (869461009867643::bigint &lt;= serial_final))\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=66.445..66.445 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7534.24..61080.30 rows=55815 width=165) (actual time=84.364..179.571 rows=2 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        Filter: ((12121001477546::bigint &gt;= serial_inicial) AND (12121001477546::bigint &lt;= serial_final))\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=60.282..60.282 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7541.75..61087.81 rows=85862 width=165) (actual time=173.876..186.082 rows=1 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        Filter: ((354689040208615::bigint &gt;= serial_inicial) AND (354689040208615::bigint &lt;= serial_final))\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=60.294..60.294 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\nTotal runtime: 572.138 ms\n</code></pre>\n\n<p>Here's the explain analyze with a_horse_with_no_name's example:</p>\n\n<pre><code>    Nested Loop  (cost=7614.18..98703.44 rows=125144 width=173) (actual time=629.373..2919.334 rows=4 loops=1)\n  Join Filter: ((lista.serie &gt;= movimiento.serial_inicial) AND (lista.serie &lt;= movimiento.serial_final))\n  CTE lista\n    -&gt;  Values Scan on \"*VALUES*\"  (cost=0.00..0.04 rows=3 width=8) (actual time=0.012..0.033 rows=3 loops=1)\n  -&gt;  Bitmap Heap Scan on movimiento  (cost=7614.14..59283.04 rows=375432 width=165) (actual time=110.909..460.563 rows=372409 loops=1)\n        Recheck Cond: (tipo_movimiento = 'Ingresado'::text)\n        -&gt;  Bitmap Index Scan on tipo_movimiento_index  (cost=0.00..7520.28 rows=375432 width=0) (actual time=107.182..107.182 rows=372409 loops=1)\n              Index Cond: (tipo_movimiento = 'Ingresado'::text)\n  -&gt;  CTE Scan on lista  (cost=0.00..0.06 rows=3 width=8) (actual time=0.001..0.003 rows=3 loops=372409)\nTotal runtime: 2919.514 ms\n</code></pre>\n\n<p>So combining a_horse_with_no_name and Craig Ringer's suggestions, searching for three serial numbers ran under 350ms. Tried with 10k and it did that in 3s+:</p>\n\n<pre><code>create temporary table lista (\n    serie bigint\n) on commit drop;\ncreate index lista_index on lista using btree (serie);\ninsert into lista (select distinct serial_inicial from movimiento limit 10000);\nanalyze lista;\nselect serie, movimiento.*\nfrom movimiento join lista on serie between serial_inicial and serial_final\nwhere tipo_movimiento = 'Ingresado';\n</code></pre>\n"},{"tags":["php","mysql","query","while-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12878249,"title":"Appending MySQL Results Together in a PHP Loop","body":"<p>Using PHP, for-each row in a MySQL query's result set, I need to execute another MySQL query. So far, I've got</p>\n\n<pre><code>$result = mysql_query(\"SELECT id, state FROM states WHERE region='given_region'\")\nor die(mysql_error());\n\nwhile($row = mysql_fetch_row($result))\n{\n    $state = $row['state'];\n    $r = mysql_query(\"SELECT * FROM locations WHERE state REGEXP '(^|,)\".$state.\"($|,)'\");\n}\n</code></pre>\n\n<p>Now I need to append all of the results $r into ONE result set that I can then iterate through with a standard while-loop, however, my very limited PHP skills are leaving me at a loss getting code to do that.</p>\n\n<p>Can anyone provide any insight into how I'd go about appending all the results into one set within the given while loop?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12878251,"title":"MySQL Join 2nd table with not Unique Foreign Key","body":"<p>I have got 2 Tables I need to query. I cannot unique values for the linked key.\nThe first Table stores stories or posts per child.</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `learning_story` (\n  `story_id` int(10) NOT NULL AUTO_INCREMENT,\n  `child_id` int(10) NOT NULL,\n  `img_file` varchar(250) NOT NULL,\n  `title` varchar(300) NOT NULL,\n  `description` text NOT NULL,\n  `link` varchar(300) NOT NULL,\n  `storydate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `teacher_id` int(11) NOT NULL,\n  `pro_id` int(10) NOT NULL DEFAULT '0',\n  `status` varchar(10) NOT NULL DEFAULT 'draft',\n  PRIMARY KEY (`story_id`),\n  KEY `child_id` (`child_id`),\n  KEY `pro_id` (`pro_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=0 ;\n</code></pre>\n\n<p>Each story or post is unique to a child (child_id Foreign Key).\nNow I am adding the ability to add posts that belong to a group of children.\nHere are 4 sample rows</p>\n\n<pre><code>INSERT INTO `learning_story` (`story_id`, `child_id`, `img_file`, `title`, `description`, `link`, `storydate`, `teacher_id`, `pro_id`, `status`) VALUES\n(1, 5, '', 'Story 1', '&lt;p&gt;&lt;img src=\"http://127.0.0.1/websites/my-books/assets/mercury_img/2dfeb1f41c48a308b7eee8526918ebb7.JPG\" style=\"cursor: default; width: 222.28915662650604px; height: 125px; float: right; margin: 0px 0px 10px 10px; \" alt=\"\"&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=\"http://127.0.0.1/websites/my-books/img/timbthumb.php?src=http://127.0.0.1/websites/my-books/assets/2/children/test_09.JPG&amp;q=100&amp;w=180&amp;h=130\" alt=\"imagetitle\" style=\"cursor: default; \"&gt;dsd sdsdsd s ds ffdfdf &lt;/p&gt;\\r\\n', '', '2012-10-08 20:42:05', 0, 2, 'draft'),\n(12, 5, '', 'Teachers Final Test 33', '&lt;p&gt;ds sd sd sd sd  dsdsd dsd sd s &lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tweety&lt;/p&gt;\\r\\n', '', '2012-10-12 12:19:45', 31, 2, 'draft'),\n(30, 6, '', 'Boys High Choir', '&lt;p&gt;sasassa&lt;/p&gt;', '', '2012-10-14 09:55:08', 0, 2, 'draft'),\n(32, 0, '', 'Story Not Mine ID 5', '&lt;p&gt;dsd sd sd s ds ds ds sd sd &lt;/p&gt;\\r\\n', '', '2012-10-14 12:21:36', 0, 2, 'draft');\n</code></pre>\n\n<p>Among these there is 1 record that has a child_id set to 0. This record belongs to the child_id's in the 2nd table.</p>\n\n<p>2nd table</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `story_groups` (\n  `id` int(10) NOT NULL AUTO_INCREMENT,\n  `child_id` int(10) NOT NULL,\n  `story_id` int(10) NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=112 ;\n\n\n\nINSERT INTO `story_groups` (`id`, `child_id`, `story_id`) VALUES\n(40, 7, 30),\n(41, 8, 30),\n(107, 8, 32),\n(108, 9, 32),\n(109, 11, 32),\n(110, 12, 32),\n(111, 5, 32);\n</code></pre>\n\n<p>So I want to get all stories/posts for a child. Including the Group Stories.</p>\n\n<p>I have tried UNION matching and a bunch of JOIN combinations but I just cant crack it.</p>\n\n<p>It is probably a simple JOIN operation which I just cant crack.</p>\n\n<p>Could somebody please help me write my query to include the rows from the story_groups table?</p>\n"},{"tags":["sql","query","search"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12877476,"title":"SQL: Searching at least 2 similar rows between different tables","body":"<p>This is my current setup:<br>\nI have 2 tables, <strong>RECIPE</strong> and <strong>INGREDIENTS</strong>.<br>\n<strong>RECIPE</strong> holds the <em>ID</em> among other data. <strong>INGREDIENTS</strong> has X rows needed for each RECIPE.<br>\nHow can one match 2 recipes with at least 2 matching ingredients?<br>\nI can do it specifying which ingredient must match, but my problem is when the recipe has more than 10 ingredients and I need two recipes that uses the same 2 ingredients, not knowing which ones.<br>\nSorry my English, is not my natural language. I'll post more details if needed, or if I wasn't clear enough.<br>\n<br>\nPratical example:<br>\nRecipe 1 has: fish, potatoes and salt.<br>\nRecipe 2 has: turkey and rice.<br>\nRecipe 3 has: fish, rice and salt.<br>\nRecipe 4 has: turkey, potatoes and salt.<br>\n<br>\nResult based on recipe 1 should be: 4<br>\nResult based on recipe 2 should be: None<br>\nResult based on recipe 3 should be: 1<br>\nResult based on recipe 4 should be: 1<br>\n(Yep, I need to run every recipe based on a filter not explained here)<br></p>\n"},{"tags":["python","django","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":6494350,"title":"Want to display the latest note entry only in Django","body":"<p>I have another Django form that stores notes and again it has the user, client and datetime stored automatically. What I want to do this time is create some note form that allows you to add a note for a particular client, and every time you add a note it displays the <strong>latest result and only</strong> the latest result in the <code>client_details.html</code>template. So every time add a new note it will keep on replacing the existing note. How can I achieve this? </p>\n\n<p><strong>forms.py</strong></p>\n\n<pre><code>class NoteForm(forms.ModelForm):\n    class Meta:\n        model = models.Note\n        exclude = ('client','user','datetime')\n</code></pre>\n\n<p><strong>Views.py</strong></p>\n\n<pre><code>@login_required\ndef get_client(request, client_id = 0):\n    client = None\n    try:\n        client = models.Client.objects.get(pk = client_id)\n        notes = client.note_set.all()\n        comments = client.comment_set.order_by('-datetime')\n    except:\n        pass\n    return render_to_response('client_details.html', {'client':client, 'notes':notes, 'comments':comments}, context_instance = RequestContext(request))\n\n@login_required\n    def add_notes(request, client_id = 0):\n        client = None\n        contact = None\n        try:\n            client = models.Client.objects.get(pk = client_id)\n        except:\n            return HttpResponseNotFound()\n\n        if request.method == 'POST':\n            form = forms.NoteForm(request.POST)\n            if form.is_valid():\n                note = form.save(commit=False)\n                note.user = request.user\n                note.client = client\n                note.save(True)\n                request.user.message_set.create(message = \"Note is successfully added.\")\n                return HttpResponse(\"&lt;script language=\\\"javascript\\\" type=\\\"text/javascript\\\"&gt;window.opener.location = window.opener.location; window.close();&lt;/script&gt;\")\n        else:\n            form = forms.NoteForm()\n        return render_to_response('note_form.html', {'form':form, 'client':client}, context_instance = RequestContext(request))\n</code></pre>\n"},{"tags":["query","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":6991786,"title":"Return only the latest records","body":"<p>I have a table that tracks the completion of interval tasks. for example, item a has to be completed every 7 days, item b every 1 days, and so on. The table logs the \"nextDue\" value on insert. I need a query that will return only the latest \"nextDue\" dates that are within 3 days of becoming due. This is what I have right now:</p>\n\n<pre><code>SELECT items.id, items.shortDescription, recs.nextDue, sup.name\nFROM lut_ResponsibleParties sup INNER JOIN(\n     rec_controlCompletion recs INNER JOIN lut_controlItems items\n          ON recs.controlItem = items.id)\n     ON items.responsiblePerson = sup.id\nWHERE datediff(\"d\",Now(),recs.nextDue) &lt;= 3\n</code></pre>\n\n<p>This was close, except it is returning ALL items that are less than or equal to 3 days, even if the latest completion date is beyond that. Does that make sense? I need the query to only return items based on the latest completion date. I don't know how else to explain that. Please let me know if I can clarify.</p>\n"},{"tags":["mysql","wordpress","query","posts"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":641,"score":0,"question_id":7426023,"title":"One query to get latest 7 posts from each category in WordPress","body":"<p>I'm looking to write a SINGLE custom SQL query to retrieve the latest 7 posts from each of my 6 specific categories of a custom post type.</p>\n\n<p>I know how to query custom post types and taxonomies, but my SQL knowledge is limited. I don't know how to get WordPress to give me 7 latest posts from each of the 6 categories. It doesn't really matter in what order it's returned, as long as the content is there.</p>\n\n<p>Example: If I have categories 1, 2, 3, 4, 5, 6, I would like to retrieve the 7 latest posts from each of those categories. Specifically, the query should pull the 7 latest posts for category 1, 7 latest posts for category 2, and so forth, all with a single query.</p>\n\n<p>I don't want to have 6 separate WP_Query instances as it's not efficient.</p>\n"},{"tags":["php","mysql","database","query","time"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12874814,"title":"Database time data retrieval, time based queries","body":"<p>I am new to time manipulation or time arithmetic operations\nand am currently developing a navigation system with Web server based information and currently I have this Database that contains a table peek hours whose columns are id, start_time, end_time , edge_id, day_of_the_week, edge_weight</p>\n\n<pre><code> ------------------------------------------------------------------------\n|                  Peek Hours                                           |\n ------------------------------------------------------------------------\n|    |            |           |         |                 |             |\n| id | start_time |  end_time | edge_id | day_of_the_week | edge_weight |\n|    |            |           |         |                 |             |\n ------------------------------------------------------------------------\n</code></pre>\n\n<p>I am using PHP as a webservice and so based on the current time i want to get all the records that would fit this equation </p>\n\n<p><code>start_time&lt; current_time &lt; end_time</code></p>\n"},{"tags":["php","sql","database","query","website"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":124,"score":3,"question_id":12876921,"title":"SQL Query only retrieving one row","body":"<p>I have a a php website with some code on it to pull from a database after the user has defined some search terms and then show them a table with all their information in it</p>\n\n<p>The problem is even when i do a select * from the tables, i am only getting the first row back.</p>\n\n<p>Code:</p>\n\n<pre><code>$result = mysql_query(\"SELECT trees.*     \nFROM trees \nINNER JOIN price \nON trees.ID=price.treeid  \n\");\n\n\n$num_rows = mysql_num_rows($result);\nif($num_rows == 0) {\necho \"No rows retrieved\";\n} else {\necho $num_rows;\n}\n</code></pre>\n\n<p>i have 2 rows in my database:</p>\n\n<pre><code>Spruce  El Sorbeous Sprucious   Green   Green   Green   100     200\nits a tree ma!  true    NULL    NULL    NULL\n\nMayday  el daymay   red green   white   10  4000000\nGOING DOWN  true    Grey    true    false\n</code></pre>\n\n<p>when i print out the $num_rows up there, it is only one.\nWhen i print out my table below, there is only one row:</p>\n\n<pre><code>echo '&lt;table border = 0 cellpadding=0 &gt;';\necho '&lt;tr&gt;';\necho '&lt;td&gt;&lt;b&gt;&lt;u&gt;Name&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Latin Name&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Primary Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Secondary Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Fall Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Trunk Color&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;';\n\necho '&lt;td&gt;&lt;b&gt;&lt;u&gt;Description&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Height&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Spread&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Drought Resistant?&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Flowering?&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;\n&lt;td&gt;&lt;b&gt;&lt;u&gt;Fruit Producing?&lt;/b&gt;&lt;/u&gt;&lt;/td&gt;';\n\necho '&lt;/tr&gt;';\n\nwhile ($row = mysql_fetch_assoc($result)) {\n     echo '&lt;tr&gt;';\n     echo '&lt;td&gt;';\n     echo $row['name'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['latinname'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['primarycolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['secondarycolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['fallcolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['trunkcolor'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['description'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['height'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['spread'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['droughtresistant'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['flowering'];\n     echo '&lt;/td&gt;';\n     echo '&lt;td&gt;';\n     echo $row['fruitproducing'];\n     echo '&lt;/td&gt;';\n\n     echo '&lt;/tr&gt;';\n\n}\necho '&lt;table&gt;';\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":12876858,"title":"Why is my NULL count returning 0 in MySQL? Very basic","body":"<p>I have an 2 easy questions that are puzzling me (I am new to Mysql)</p>\n\n<p>I have a table (survey) with 3 columns, UserID (primary), SkinColor, and HairColor. I wanted to count the number of people who have a hair color that is null (they didn't answer the survey).</p>\n\n<p>I did this with:</p>\n\n<pre><code>select count(id)\nfrom survey\nwhere haircolor is null\n</code></pre>\n\n<p>But I was puzzled why I couldn't do</p>\n\n<pre><code>select count(haircolor)\nfrom survey\nwhere haircolor is null\n</code></pre>\n\n<p>It returned 0. Why is this?</p>\n\n<p>Question 2: I want to return the total number of survey respondents (all ID's), number of people with null value for hair color, and null value for skin color. I tried this query</p>\n\n<pre><code>select count(id), count(skincolor), count(haircolor)\nfrom survey\nwhere skincolor is null and haircolor is null\n</code></pre>\n\n<p>But that just returned the the count where skincolor and haircolor are both null obviously, and not an individual count for each column. Is there a way to put the WHERE constraint up in the SELECT section so I can specify different constraints for each select? </p>\n\n<p>Thanks!</p>\n"},{"tags":["query","pointers","mysql++"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12875495,"title":"Mysql++ Query fails only when the query variable is a pointer... :S","body":"<p>I am having a problem which makes me think that I don't understand something fundamental. I am using MySQL++ and when calling query.execute() (where \"query\" is an instance of class mysqlpp::Query) it works, but when calling query->execute() (where \"query\" is a pointer to an instance of class myqslpp::Query) the same query fails! The error message is \"Query was empty\".</p>\n\n<p>Here is the code I used for testing this.</p>\n\n<p>The following runs without errors, and the table is created in the database.</p>\n\n<pre><code>void test1() {\n    mysqlpp::Connection conn;\n    conn.connect(0, \"server\", \"user\", \"password\");\n    conn.select_db(\"db_name\");\n\n    mysqlpp::Query query = conn.query();\n    try {\n        query &lt;&lt; \"CREATE TABLE IF NOT EXISTS MY_TABLE (MY_COLUMN SMALLINT)\";\n        query.execute();\n    }\n    catch (const mysqlpp::BadQuery&amp;) {\n        std::cerr &lt;&lt; query.error() &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>While the following produces output \"Query was empty\" and the table is not created in the database.</p>\n\n<pre><code>void test2() {\n    mysqlpp::Connection conn;\n    mysqlpp::Query *query = 0;\n    conn.connect(0, \"server\", \"user\", \"password\");\n    conn.select_db(\"db_name\");\n\n    query = &amp;conn.query();\n    try {\n        *query &lt;&lt; \"CREATE TABLE IF NOT EXISTS MY_TABLE (MY_COLUMN SMALLINT)\";\n        query-&gt;execute();\n    }\n    catch (const mysqlpp::BadQuery&amp;) {\n        std::cerr &lt;&lt; query-&gt;error() &lt;&lt; std::endl;\n    }\n    query = 0;\n}\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12869826,"title":"SQL Server Query for a DVD Rental Company","body":"<p>I've got a sample database for a movie rental business. I'm trying to write a query that finds all movie titles that are currently sold out. </p>\n\n<ul>\n<li>All DVDs for that film are currently rented. Or...</li>\n<li>No DVDs exist for that film</li>\n</ul>\n\n<p>Keep in mind I want to make sure this query doesn't capture DVDs that are in inventory but have never appeared in the rental table.</p>\n\n<p>Edit: this is what I have so far, but I can't account for the scenario in the line above^.</p>\n\n<pre><code>SELECT Count(DvdID) AS Inventory, Movie.Title\nFROM Dvd\nJOIN Movie on Dvd.MovieID = Movie.MovieID\nWHERE Dvd.DvdID IN\n    (SELECT RentalID\n    FROM Rental\n    WHERE Rental.ReturnDate IS NULL)\nOR Dvd.DvdID NOT IN\n    (SELECT Dvd.DvdID\n    FROM Dvd\n    WHERE DvdID NOT IN\n    (SELECT Rental.DvdID FROM RENTAL)\n    )\n\nGROUP BY Movie.Title\n</code></pre>\n\n<p>TABLES:</p>\n\n<h2>Movie</h2>\n\n<p>-MovieID</p>\n\n<p>-MovieTitle</p>\n\n<h2>Dvd</h2>\n\n<p>-DvdID</p>\n\n<p>-MovieID</p>\n\n<h2>Rental</h2>\n\n<p>-RentalID</p>\n\n<p>-DvdID</p>\n\n<p>-AccountID</p>\n\n<p>-RentalDate</p>\n\n<p>-ReturnDate</p>\n"},{"tags":["sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":75,"score":0,"question_id":12874183,"title":"SQL Server : get count and sum of columns","body":"<p>I am designing a website that people post text messages. users can rate the messages (1 to 5). I'm recording this ratings into a table to:</p>\n\n<ol>\n<li>avoid multiple rating by one user for the same post</li>\n<li>to be able get the average rating of a post.</li>\n</ol>\n\n<p>but I also the number of votes are important too. for example a post having 10 votes of 3 (makes 30) are valuable than the post with 2 votes of 5 (that makes 10). Now when I'm showing a page with 20 of this messages I want to show their rating too</p>\n\n<p>This is my rating table:</p>\n\n<pre><code>create table ratings(\n[id] int primary key identity(1,1),\n[msgid] int,\n[uid] int,\n[rating] tinyint\n)\n</code></pre>\n\n<p>I want to get to 20 messages from messages table with the sum of the ratings for each message and the count of ratings for each message.</p>\n\n<pre><code>select \n    msg.id, msg.text,\n    sum(rate.rating), \n    count(rate.id) \nfrom \n    messages as msg \ninner join \n    ratings as rate on msg.id = rate.msgid \ngroup by \n    msg.id\n</code></pre>\n\n<p>can any one please help me with the SQL query code?</p>\n"},{"tags":["ajax","wordpress","query","loops","category"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":572,"score":3,"question_id":10483925,"title":"Filtering the loop by category using Ajax in Wordpress","body":"<p>Well, I have been looking everywhere for hours and hours and it seems like there's so many ways to do this, since I have never used Ajax before and have little knowledge of havascript, its become too hard for me.</p>\n\n<p>I have the loop on my front page (index) or wordpress and I want to have a filter, a dropdown menu with different categories, that when clicked, the only posts showing in that same screen are the ones from that category. I need the loop to be refreshed with ajax, so the whole page is still left intact while you use the filter.</p>\n\n<p>this is what i have on my Index file:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://www.google.com/jsapi\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;google.load(\"jquery\", \"1.2.6\")&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\n$(function(){\n     $('#main_cat').change(function(){\n         var $mainCat=$('#main_cat').val();\n          $(\"#sub_cat\").empty();\n              // call ajax\n                  $.ajax({\n\n              url:\"&lt;?php bloginfo('wpurl'); ?&gt;/wp-admin/admin-ajax.php\",       \n              type:'POST',\n              data:'action=my_special_ajax_call&amp;main_catid=' + $mainCat,\n              success:function(results)\n              {\n            //  alert(results);\n              $('#sub_cat *').fadeOut(500);\n              $('#sub_cat + p').fadeOut(500);\n              $(\"#sub_cat\").append(results);\n                  $('#sub_cat').load('http://localhost:8888/public_html/wp-content/themes/twentyten-child/templateloop.php');\n              $('#sub_cat + p').fadeIn(1);\n                  }\n                      });\n\n            }\n    );\n});\n</code></pre>\n\n<p>The dropdown with the categories goes like this:</p>\n\n<pre><code>&lt;?php\nwp_dropdown_categories('show_count=0&amp;selected=-1&amp;hierarchical=1&amp;depth=1&amp;hide_empty=0&amp;exclude=1&amp;show_option_none=Main Categories&amp;name=main_cat');\n?&gt;\n</code></pre>\n\n<p>So, the dropdown works, and it's supposed to ajax load a wp template file with a query filtering only one category (grabbed from the wp_dropdown_categories). And the loading works fine if I have a dummy text in the templateloop.php file, but when I have the wp query, nothing happens. the #sub_cat div, which is where the loop is located and was supposed to be switched by the template file just dissapears with all the post listing and im left only with the top half of the page (until where the #sub_cat div used to be).</p>\n\n<p>There has been so much trial and error, ive tried with the query call in the template file, in the index file, in the functions, i never seem to get any result.</p>\n\n<p>on my functions.php file ive got this:</p>\n\n<pre><code>function implement_ajax() {\nif(isset($_POST['main_catid']))\n            {\n              echo '&lt;?php $paged = (get_query_var(\"paged\")) ? get_query_var(\"paged\") : 1; query_posts(\"cat='.$_GET['maincatid'].'&amp;paged=$paged\"); ?&gt;';\n\n            die();\n            } // end if\n}\nadd_action('wp_ajax_my_special_ajax_call', 'implement_ajax');\nadd_action('wp_ajax_nopriv_my_special_ajax_call', 'implement_ajax');//for users that are not logged in.\n</code></pre>\n\n<p>and the query line i used to use before all this, in the index file is:</p>\n\n<pre><code>       &lt;?php $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n query_posts(\"cat=1,2,3,4,5&amp;paged=$paged\"); ?&gt;\n</code></pre>\n\n<p>i've tried using the wp_query but it's just going nowhere, i really need guidance. Any help is appreciated. thank you.</p>\n"},{"tags":["c#","linq","query","data"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":12873855,"title":"C# Groupby Linq and foreach","body":"<p>I need a more efficient way of producing multiple files from my data group.\nIm using a <code>List&lt;MyObject&gt;</code> type and my object has some public properties in which I need to group the data by.</p>\n\n<p>I have heard of <em>Linq</em> and it sounds like something I could use. However Im not sure how to go about it.</p>\n\n<p>I need to produce a text file for each STATE, so grouping all the <code>MyObjects</code> (people) by state, then running a <code>foreach</code> look on them to build the TEXT file.</p>\n\n<pre><code>void Main()\n{\n\n    List&lt;MyObject&gt;   lst = new List&lt;MyObject&gt;();\n    lst.Add(new MyObject{ name = \"bill\", state = \"nsw\", url = \"microsoft.com\"});\n    lst.Add(new MyObject{ name = \"ted\",  state = \"vic\", url = \"apple.com\"});\n    lst.Add(new MyObject{ name = \"jesse\", state = \"nsw\", url = \"google.com\"});\n    lst.Add(new MyObject{ name = \"james\", state = \"qld\", url = \"toshiba.com\"});\n\n    string builder = \"\";\n    foreach (MyObject item in myObjects)  {\n\n        builder += item.name + \"\\r\\n\";\n        builder += item.url + \"\\r\\n\" + \"\\r\\n\\r\\n\";\n\n    }\n\nand out to the `StreamWriter` will be the filenames by state. \n</code></pre>\n\n<p>In total for the above data I need 3 files;</p>\n\n<pre><code>-nsw.txt\n-vic.txt\n-qld.txt\n</code></pre>\n"},{"tags":["mysql","query","date","select","ranges"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12873067,"title":"MySQL query date ranges","body":"<p>I have googled but did not find anything related. I have a MySQL table like this:</p>\n\n<pre>\n+++++++++++++++++++++++++++++++\n| roomID |    date    | price |\n+++++++++++++++++++++++++++++++\n|  1     | 2012-10-10 |   10  |\n|  1     | 2012-10-11 |   10  |\n|  1     | 2012-10-12 |   10  |\n|  1     | 2012-10-13 |   12  |\n|  2     | 2012-10-10 |   15  |\n|  2     | 2012-10-11 |   15  |\n|  2     | 2012-10-12 |   15  |\n|  2     | 2012-10-13 |   16  |\n|  2     | 2012-10-14 |   16  |\n|  2     | 2012-10-15 |   16  |\n+++++++++++++++++++++++++++++++</pre>\n\n<p>I need to get periods based on price and roomID:</p>\n\n<pre>\n++++++++++++++++++++++++++++++++++++++++++++\n| roomID |    from    |    till    | price |\n++++++++++++++++++++++++++++++++++++++++++++\n|    1   | 2012-10-10 | 2012-10-12 |   10  |\n|    1   | 2012-10-13 | 2012-10-13 |   12  |\n|    2   | 2012-10-10 | 2012-10-12 |   15  |\n|    2   | 2012-10-13 | 2012-10-15 |   16  |\n++++++++++++++++++++++++++++++++++++++++++++</pre>\n\n<p>Thank you!</p>\n"},{"tags":["php","mysql","query","relationship"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12872830,"title":"Find related artists - php and mysql","body":"<p>I just read a lot about finding related data with php and mysql. Maybe a little bit too much, because now I'm just totally confused, which is the right and easiest way for me.</p>\n\n<p>I have a table of artists, which can be tagged. I save the relationship between artists and tags in an extra table.</p>\n\n<p>So its</p>\n\n<p><code>artist_id | artist_name</code> , <code>artistXtag | artist_id | tag_id</code> and <code>tag_id | tag_name</code></p>\n\n<p>For my point of view only the artistXtag table is interesting for finding related artists, because all the relationships are made up in this table.</p>\n\n<pre><code>id   artist_id tag_id\n1        1       1\n2        2       1\n3        3       1\n4        2       2\n5        3       2\n6        1       3\n7        5       4\n8        4       4\n9        5       1\n10       3       4\n</code></pre>\n\n<p>So now i just want to find out which artists has the most overlaps of tags, based on one input artist_id for example \"1\" and the result sorted by the number of overlaps.</p>\n\n<p>In the End i want to have a function get_related_artists(id) and want to get an array of the most related artists as an result.</p>\n\n<p>I found some functions like this</p>\n\n<pre><code>SELECT t.item_id FROM tags t\n  JOIN tag_names tn\n    ON t.tag_id = tn.tag_id\nGROUP BY\n  t.item_id\nHAVING\n  COUNT(DISTINCT t.tag_id) = (SELECT COUNT(*) FROM tag_names)\n</code></pre>\n\n<p>which should do something like i want, but to be honest i do not understand this query at all :( I know basic mysql stuff like Joins etc. but i have problems to understand the query i want to have would work.</p>\n\n<p>Is it clear, what i want to do?</p>\n"},{"tags":["sql","query","sqlite","select","string-comparison"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12871988,"title":"SQL case sensitive string comparison with like and \"=\"","body":"<p>i have one table named category.</p>\n\n<p>in this table i have two columns 1st is cat_id, 2nd is cat_name.</p>\n\n<p>in this table i have added record with this value : cat_id = 1, cat_name = test</p>\n\n<p>Now when i am going to run select query</p>\n\n<pre><code>SELECT * FROM category WHERE cat_name = 'Test'\n</code></pre>\n\n<p>this query returns me null result. Instade of null result i want the result with 1st record.</p>\n\n<p>also i want same result in vice versa small and capital string.</p>\n\n<p>i am using sqlite as database.</p>\n"},{"tags":["php","mysql","xml","query","issues"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12870803,"title":"php query for iOS latitude and longitude not searching for nearby mysql lat and lon with a xml output","body":"<p>I am trying to get the output of the lat and lon coordinates from ios (this is working fine), send it to php to query with MySQL and have the php emit an xml document back to ios(this step is not working because it is refusing to read an uploaded data entry from mysql), then parsing it on iOS UItableview (this is working fine too). I am trying to get this to work with XML because parsing xml on iOS is really simple for me and I've gotten a simpler xml script running already on it, but probably due to mistakes from inexperience in php, I cannot get this php script working. What am I doing wrong in my php script? Thanks!</p>\n\n<pre><code>&lt;?php\n{ $lat = (float)$_GET['lat']; } //ios get \"lat\" value from: NSString *urlString = [NSString stringWithFormat:@\"http://www.mysite.com/loc.php?lat=%g&amp;lon=%g\", latitude, longitude];\n{ $lon = (float)$_GET['lon']; } //ios get \"lon\" value from: NSString *urlString = [NSString stringWithFormat:@\"http://www.mysite.com/loc.php?lat=%g&amp;lon=%g\", latitude, longitude];\n$minlat = $lat-.1;\n$maxlat = $lat+.1;\n$minlon = $lon-.1;\n$maxlon = $lon+.1;\n$dbh = new PDO('(censored personal information)');\n$sql = 'SELECT lat, lon, name FROM locations WHERE lat &gt;= ? AND lat &lt;= ? AND lon &gt;= ? AND lon &lt;= ?';\n$params = array( $minlat, $maxlat, $minlon, $maxlon );\n$q = $dbh-&gt;prepare( $sql );\n$q-&gt;execute( $params );\n$doc = new DOMDocument();\n$r = $doc-&gt;createElement( \"locations\" );\n$doc-&gt;appendChild( $r );\nforeach ( $q-&gt;fetchAll() as $row) {\n  {\n    $e = $doc-&gt;createElement( \"location\" );\n    $e-&gt;setAttribute( 'name', $row['name'] );\n    $e-&gt;setAttribute( 'd', $d );\n    $r-&gt;appendChild( $e );\n  }\n}\nprint $doc-&gt;saveXML();\n?&gt;\n</code></pre>\n"},{"tags":[".net","query","mongodb","datetime","mongodb-csharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12831025,"title":"How do I resolve a year/month/day date to a more specific date with time data in MongoDB?","body":"<p>I'm working on converting my blog over to use <code>/year/month/day</code> type URLs. I've ran into a pretty bad problem with the concept though. I want to only have down to hour/minute resolution, but of course all of my entries are stored with a full time specific as possible(and I don't want to change that). </p>\n\n<p>How exactly do I go about resolving a specific date to a less specific date with MongoDB? I'm using 10gen's official MongoDB mapper for .Net. </p>\n\n<p>My data-model looks like:</p>\n\n<pre><code>public class BlogEntryData{\n    [BsonId]\n    public ObjectId ID;\n    public string Title;\n    public string Text;\n    public DateTime Posted;\n    public DateTime Edited;\n    public List&lt;string&gt; Tags;\n    [BsonDefaultValue(true)]\n    public bool Publish;\n}\n</code></pre>\n\n<p>and I get an entry for my blog using</p>\n\n<pre><code>var c=Config.GetDB().GetCollection&lt;BlogEntryData&gt;(\"entries\");\nBlogEntryData entry;\ntry{\n    entry=c.FindOneByIdAs&lt;BlogEntryData&gt;(new ObjectId(RouteParams[\"id\"]));\n}catch{\n    throw new HttpException(404,\"Blog entry not found\");\n}\nif(entry==null){\n    throw new HttpException(404,\"Blog entry not found\");\n}\n</code></pre>\n\n<p>I'm know how to change it to use instead of ID something like a numerical search field or whatever, but I've never queried against dates.</p>\n\n<p>Also, as an aside, would it be better to store the \"URL date\" denormalized as a string in my entry model? I'd only want to do this if indexes didn't work properly on dates or something</p>\n"},{"tags":["php","mysql","xml","query","script"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12870393,"title":"php query for iOS latitude and longitude to search for nearby mysql lat and lon with a xml output issue","body":"<p>I am trying to get the output of the lat and lon coordinates from ios (this is working fine), send it to php to query with MySQL and have the php emit an xml document back to ios(this step is not working), then parsing it on iOS UItableview (this is working fine too). I am trying to get this to work with XML because parsing xml on iOS is really simple for me and I've gotten a simpler xml script running already on it, but probably due to mistakes from inexperience in php, I cannot get this php script working. What am I doing wrong in my php script? Thanks!</p>\n\n<pre><code>&lt;?php\n{ $lat = (float)$_GET['lat']; }\n{ $lon = (float)$_GET['lon']; }\n$minlat = $lat-.1;\n$maxlat = $lat+.1;\n$minlon = $lon-.1;\n$maxlon = $lon+.1;\n$dbh = new PDO('(censored personal information)');\n$sql = 'SELECT lat, lon, name FROM locations WHERE lat &gt;= ? AND lat &lt;= ? AND lon &gt;= ? AND lon &lt;= ?';\n$params = array( $minlat, $maxlat, $minlon, $maxlon );\n$q = $dbh-&gt;prepare( $sql );\n$q-&gt;execute( $params );\n$doc = new DOMDocument();\n$r = $doc-&gt;createElement( \"locations\" );\n$doc-&gt;appendChild( $r );\nforeach ( $q-&gt;fetchAll() as $row) {\n  {\n    $e = $doc-&gt;createElement( \"location\" );\n    $e-&gt;setAttribute( 'name', $row['name'] );\n    $e-&gt;setAttribute( 'd', $d );\n    $r-&gt;appendChild( $e );\n  }\n}\nprint $doc-&gt;saveXML();\n?&gt;\n</code></pre>\n"},{"tags":["php","mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12227236,"title":"2 JOINS MYSQL and LIMIT 1","body":"<p>I have 3 tables and want to make a sql query to proper view them.</p>\n\n<p>1.) Zakaz</p>\n\n<pre><code>id | Comment\n</code></pre>\n\n<p>2.) Tovar</p>\n\n<pre><code>id  | id_clients | zakaz\n</code></pre>\n\n<p>3.) Users</p>\n\n<pre><code>id | name\n</code></pre>\n\n<p>They are connected as:</p>\n\n<pre><code>zakaz.id = tovar.zakaz\ntovar.id_clients = users.id\n</code></pre>\n\n<p>I want to see</p>\n\n<pre><code>zakaz.id | users.name  \n</code></pre>\n\n<p>BUT I want to limit only to 1 string per zakaz, so I did:</p>\n\n<pre><code>SELECT zakaz.id, zakaz.comment, tovar.id_clients\n    FROM zakaz\n    JOIN tovar ON zakaz.id = tovar.zakaz\nGROUP BY zakaz.id\n</code></pre>\n\n<p>and then I want to JOIN users but it doesnt work</p>\n\n<pre><code>SELECT zakaz.id, zakaz.comment, tovar.id_clients, users.name\n    FROM zakaz\n    JOIN tovar ON zakaz.id = tovar.zakaz\n    GROUP BY zakaz.id\nJOIN users ON users.id = tovar.id_clients\n</code></pre>\n"},{"tags":["mysql","sql","database","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12766733,"title":"How to Avoid Complete Table Scan in Database?","body":"<p>I want to creating a website where users can sign up in website and upload 20 images to their account. (planning to allow users to upload unlimited images in future)</p>\n\n<p>I have two tables in database.\nOne for keeping user data\nTable name - members\nFields- userid, username, password, email.\nOther for saving image path\nTable name- images\nFields - userid, imagepath</p>\n\n<p>So I can display images of a user in his page searching image path from table 'images'</p>\n\n<p>Things are working fine. But if the number of users grow this will become slower.\nFor example - If there is 50000 users I should check all the rows to find images uploaded by a single user\nie;\n50000 userid * 20 images/user = 1000000 scans for table rows\nThis will make the system slow and make overload.\nWhat I should do to avoid this?</p>\n"},{"tags":["sql","query","scala","macros","compilation"],"answer_count":3,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":161,"score":9,"question_id":11777278,"title":"What's the recommended way to pass the results of macro computations to run-time?","body":"<p>I'm trying to build some SQL-like abstraction and I have hit a problem.</p>\n\n<p>This is a simplified “database table”:</p>\n\n<pre><code>trait Coffee {\n  def id: Long\n  def name: String\n  def brand: String\n}\n</code></pre>\n\n<p>This is my query abstraction:</p>\n\n<pre><code>import language.experimental.macros\n\nobject Query {  \n  def from[T] = \n    macro QueryMacros.fromMacro[T]\n}\n\nclass From[T] {  \n  def select[S](s: T =&gt; S): Select[T] =\n    macro QueryMacros.selectMacro[T, S]\n}\n\nclass Select[T] {\n  def where(pred: T =&gt; Boolean): Where =\n    macro QueryMacros.whereMacro[T]\n}\n\nclass Where(val result: String)\n</code></pre>\n\n<p>This is my macro implementation:</p>\n\n<pre><code>import scala.reflect.macros.Context\n\nobject QueryMacros {\n  val result = new StringBuilder\n\n  def fromMacro[T : c.WeakTypeTag](c: Context): c.Expr[From[T]] = { \n    result ++= (\"FROM \" + c.weakTypeOf[T])\n    c.universe.reify(new From[T])\n  }\n\n  def selectMacro[T : c.WeakTypeTag, S : c.WeakTypeTag](c: Context)(s: c.Expr[T =&gt; S]): c.Expr[Select[T]] = {\n    result ++= (\"SELECT \" + s.tree)\n    c.universe.reify(new Select[T])\n  }\n\n  def whereMacro[S](c: Context)(pred: c.Expr[S]): c.Expr[Where] = {\n    result ++= (\"WHERE \" + pred.tree)\n    c.universe.reify(new Where(result.toString))\n  }\n}\n</code></pre>\n\n<p>And this is my example code:</p>\n\n<pre><code>object Main extends App {\n  println(\"Query start\")\n  val query = \n    Query.from[Coffee]\n         .select(_.id)\n         .where(_.brand == \"FairTrade\")\n\n  println(query.result)\n  println(\"Query end\")\n}\n</code></pre>\n\n<p>It compiles and runs fine, but the output is:</p>\n\n<pre><code>Query start\n\nQuery end\n</code></pre>\n\n<p>Basically, <code>result</code> seems to be empty. I expected that it would hold the accumulated strings of the trees.</p>\n\n<p>How can I pass my data from the macro compile stage to the next stage, so it shows up at runtime?\nI could of course pass the current string to the next method  explicitly, but I would like to avoid that.</p>\n"},{"tags":["mysql","query","row","column"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12868047,"title":"Make row names of one table columns of the other MySQL","body":"<p>I don't know if this is possible or not.\nI have <code>Table1</code> with the following fields.</p>\n\n<pre><code>No\n\nA\nB\nC\nD\n</code></pre>\n\n<p>I want <code>table2's</code> column names to be table1's row names (varchar(20) each, all null's)</p>\n\n<pre><code>A B C D\n</code></pre>\n\n<p>If I add a row in table1, table2 column should get appended too.</p>\n\n<p>Any suggestions. </p>\n"},{"tags":["python","query","google-app-engine","gae-datastore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12868184,"title":"GAE Chaining Queries through tables","body":"<p>I have these models (below). I want to run a query that gets 10 recent entries from Result  where the \"site\" ReferenceProperty is one of mine, based on the \"users\" in Site.</p>\n\n<p>I tried:</p>\n\n<pre><code>user = users.get_current_user()\nsites = Site.all().filter('user =', user).order('name')\nresults = Result.all().filter('site IN', sites).fetch(limit=10)\n</code></pre>\n\n<p>The user and sites queries work, but the results one is not working because \"sites\" is not a list.</p>\n\n<pre><code>from google.appengine.ext import db\n\nclass Site(db.Model):\n\nusers = db.ListProperty(db.Key)\nname = db.StringProperty(required=True)\nslug = db.TextProperty(required=True)\nurl = db.TextProperty(required=True)\npage = db.TextProperty()\nactive = db.BooleanProperty()\nblackboard = db.BooleanProperty()\n\n\nclass Result(db.Model):\n\nsite = db.ReferenceProperty(Site)\ntimestamp = db.DateTimeProperty(auto_now_add=True)\nstatus = db.StringProperty(required=True)\nreason = db.StringProperty(required=True)\nheaders = db.TextProperty()\nextra_info = db.TextProperty()\n</code></pre>\n"},{"tags":["c#","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":12866274,"title":"C# SQL Query in public DataTable","body":"<p>I have this public DataTable that I am trying to run an sql query in, but the dang thing wont work...</p>\n\n<pre><code>public DataTable get_OrderTransaction_Master_ByOrderID(Int64 orderID)\n    {\n        cn = new SqlConnection(objCommon.IpcConnectionString);\n        cmd = new SqlCommand(\"select * from dbo.OrderTransaction_Master where orderID = \" + orderID, cn);\n        cmd.CommandType = CommandType.Text;\n        cn.Open();\n        cmd.ExecuteNonQuery();\n        cn.Close();\n    }\n</code></pre>\n\n<p>I get a red line under <code>get_OrderTransaction_Master_ByOrderID</code> saying</p>\n\n<pre><code>Error   3   'OrderTransaction_Master.get_OrderTransaction_Master_ByOrderID(long)': not all code paths return a value    C:\\IPC\\App_Code\\OrderTransaction_Master.cs  32  22  http://localhost/ipc/\n</code></pre>\n\n<p>What Am I doing wrong?</p>\n"},{"tags":["performance","query","innodb","longtext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12863549,"title":"query very slow longtext field innodb table","body":"<p>Well, firts of all, sorry by my english. I try to do a query in a table that the users can include some text, like a blog page. The users can design the content in a html format. In my table it is stored like this:</p>\n\n<pre><code>Estad&amp;amp;iacute;sticas&amp;lt;br /&amp;gt;\n&amp;lt;table border=&amp;quot;0&amp;quot;&amp;gt;\n&amp;lt;tbody&amp;gt;\n&amp;lt;tr&amp;gt;\n&amp;lt;td&amp;gt;Columna 1&amp;lt;/td&amp;gt;\n&amp;lt;td&amp;gt;Columna 2&amp;lt;/td&amp;gt;\n&amp;lt;/tr&amp;gt;\n&amp;lt;tr&amp;gt;\n&amp;lt;td&amp;gt;Columna 3&amp;lt;br /&amp;gt;&amp;lt;/td&amp;gt;\n&amp;lt;td&amp;gt;Columna 4&amp;lt;br /&amp;gt;&amp;lt;/td&amp;gt;\n&amp;lt;/tr&amp;gt;\n&amp;lt;/tbody&amp;gt;\n&amp;lt;/table&amp;gt;\n</code></pre>\n\n<p>I must serch in that content all that user's want. The field 'texto' (that I'm using for it) is a longtext field and the table is innodb. I can't use full text search, 'cause it is only for myisam tables. I made the query as:</p>\n\n<pre><code>\"SELECT * FROM texto WHERE texto like '%$variable%'\"\n</code></pre>\n\n<p>but the query is very, very slow, an it take an eternity. The table has a 849 records, that's isn't big. If I write the same query in a phpmyadmin also take a very, very long time. But there are big records in this field, some records have the video html, tables, images, but it's just that, text like the above.</p>\n\n<p>What I can do??? How can improve the performance of the query??? I appreciate all your help. Thanks a lot. And again, sorry for my english.</p>\n"},{"tags":["c#","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12867227,"title":"C# SQL query not returning anything","body":"<p>I have the public DataTable here and the code looks right, but its not returning anything, the OrderID is correct, the query itself is correct, its not returning anything...can anyone tell me why?</p>\n\n<pre><code>public DataTable get_OrderTransaction_Master_ByOrderID(Int64 orderID)\n    {\n\n        cn = new SqlConnection(objCommon.IpcConnectionString);\n        cn.Open();\n\n        string query = \"select transactionID from dbo.OrderTransaction_Master where orderID = \" + orderID;\n        SqlCommand queryCommand = new SqlCommand(query, cn);\n        SqlDataReader queryCommandReader = queryCommand.ExecuteReader();\n        DataTable dataTable = new DataTable();\n        dataTable.Load(queryCommandReader);\n        cn.Close();\n        return dataTable;\n\n    }\n</code></pre>\n"},{"tags":["android","database","query","sqlite","android-sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":12849622,"title":"Delete Query And Refresh in ListView in Android (sqlite)","body":"<p>I'm new to Java, Android, and SQLite, and I'm stuck at this. I have columns, namely <code>_id</code> (autoincrement), <code>type</code>, <code>amount</code> (int), <code>category</code>, and <code>description</code>. Three queries.</p>\n\n<p>Firstly, I am not able to delete a transaction (row) retrieved from database. (Please refer to the attached Logcat). </p>\n\n<p>Secondly, I need to know how to refresh the ListView after deleting the entry.</p>\n\n<p>And third, the silly issue I think. If I open the database once and retrieve data, it does so. Further, without closing the database, if I delete a transaction it does not delete it and gives the error \"database not open\". Further, if I close the database after retrieval and then open again at the time of deletion, it works. I dont get it. Main issue is the first one, but please answer if you know any of the above</p>\n\n<pre><code>    final ListView lv = getListView();\n    localArrayList.clear();                //To Stop the silly repeating issue\n    localDbCrud = new DbCrud(this);\n    localAdapter = new SimpleAdapter(\n            this,\n            localArrayList,\n            R.layout.transaction_list_item,\n            new String[]{\"Amount\",\"Category\",\"Date\",\"Description\"},\n            new int[]{R.id.tli_amount,R.id.tli_category,R.id.tli_date,R.id.tli_desc});\n\n    localDbCrud.open();\n    DbCrud.getAllTransaction();             //Using HashMap localHashMap , localHashMap.put(localArrayList) in loop\n    localDbCrud.close();\n    lv.setOnItemLongClickListener(new OnItemLongClickListener() {\n\n        public boolean onItemLongClick(final AdapterView&lt;?&gt; arg0, View arg1,\n                 final int arg2, final long arg3) {\n            // TODO Auto-generated method stub\n            AlertDialog.Builder ladbuilder = new Builder(TransactionList.this);\n            ladbuilder.setTitle(\"Choose Your Option\");\n            ladbuilder.setItems(R.array.alertdialog_prompt, new DialogInterface.OnClickListener() {\n\n                public void onClick(DialogInterface dialog, int selected_item) {\n                    // TODO Auto-generated method stub\n                    if (selected_item == 0){\n                        localDbCrud.open();\n                        HashMap itemMap = (HashMap)localAdapter.getItem(arg2);\n                        int item_id =(Integer) itemMap.get(\"Id\");\n                        DbCrud.deleteTransaction(item_id);\n                        //final int ite=  (Integer) arg0.getItemAtPosition(arg2);\n                         // final int item_id = c.getInt(c.getColumnIndex(DbCrud.TN_ID));\n                        //DbCrud.deleteTransaction(item_id);\n                        localDbCrud.close();\n\n                    }\n                    else{\n\n\n                        //update code\n\n                    }\n                }\n            });\n            AlertDialog localad = ladbuilder.create();\n            localad.show();\n\n\n            return false;\n        }\n    });\n\n    localDbCrud.close();\n\n    setListAdapter(localAdapter);\n\n}\n</code></pre>\n\n<p>Logcat</p>\n\n<pre><code>10-13 01:21:26.804: E/AndroidRuntime(22023): FATAL EXCEPTION: main\n10-13 01:21:26.804: E/AndroidRuntime(22023): java.lang.ClassCastException: java.lang.String\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.hishighness.budgetracker.TransactionList$1$1.onClick(TransactionList.java:62)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.android.internal.app.AlertController$AlertParams$3.onItemClick(AlertController.java:878)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.widget.AdapterView.performItemClick(AdapterView.java:284)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.widget.ListView.performItemClick(ListView.java:3701)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.widget.AbsListView$PerformClick.run(AbsListView.java:1970)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.os.Handler.handleCallback(Handler.java:587)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.os.Handler.dispatchMessage(Handler.java:92)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.os.Looper.loop(Looper.java:130)\n    10-13 01:21:26.804: E/AndroidRuntime(22023):    at android.app.ActivityThread.main(ActivityThread.java:3687)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at java.lang.reflect.Method.invoke(Method.java:507)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)\n10-13 01:21:26.804: E/AndroidRuntime(22023):    at dalvik.system.NativeStart.main(Native Method)\n</code></pre>\n\n<p>here's the getallTransaction() function.This is the only trace of hash map in my project</p>\n\n<pre><code>    public static void getAllTransaction(){\n\n    Cursor localCursor = localDatabase.query(true, TN_TABLE, null, null, null, null, null, null, null) ;\n    if (localCursor != null) {\n\n        localCursor.moveToFirst();\n            do{\n                HashMap&lt;String,String&gt; temp = new HashMap&lt;String,String&gt;();\n                temp.put(\"Amount\", localCursor.getString(localCursor.getColumnIndex(\"amount\")));\n                temp.put(\"Category\", localCursor.getString(localCursor.getColumnIndex(\"category\")));\n                temp.put(\"Date\", localCursor.getString(localCursor.getColumnIndex(\"date\")));\n                temp.put(\"Description\", localCursor.getString(localCursor.getColumnIndex(\"description\")));\n                temp.put(\"Id\", localCursor.getString(localCursor.getColumnIndex(\"_id\")));\n                TransactionList.localArrayList.add(temp);\n\n\n\n            }while (localCursor.moveToNext());\n\n    }\n</code></pre>\n"}]}
{"total":20740,"page":12,"pagesize":100,"questions":[{"tags":["mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12753865,"title":"Update field1 when field2 is duplicated","body":"<p>I would like to update latitude and longitude location from different records when their site_id is the same. </p>\n\n<p>For example if </p>\n\n<pre><code>ID | SiteID | Latitude | Longitude\n1      5      74.4545   -35.5466\n2      6      74.4545   -35.5466\n3      5      75.4584   -45.5966\n4      6      79.6545   -36.5496\n</code></pre>\n\n<p>I would like Records 3 and all the others that match SiteID 5 to take the Latitude and Longitude of Record 1. Similarly Records 2 and 4</p>\n\n<p>How can I do this in mysql.</p>\n"},{"tags":["php","mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":9,"view_count":50,"score":-9,"question_id":12867094,"title":"i need help to make function in php","body":"<p>i want to make a function on hotel management system in php if customer's net dues or amounts remaining are still not clear or still remaining in mysql database then checkout button disabled else customer's net dues or amounts remaining are null then enable checkout button. How can i make this type of function in php with mysql database please help thanks in advance</p>\n"},{"tags":["php","mysql","sql","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12866655,"title":"SQL query not in return specific result","body":"<p>I'm trying to create query to not include the cars where the part_id = '1'. This works, but the car continues to show up because the car_id is associated with multiple other part_id's.</p>\n\n<p>Here's my query:</p>\n\n<pre><code>SELECT\n    distinct car.car_id, \n             part.description\nFROM car\nJOIN car_parts part on (car.car_id = part.car_id)\nWHERE part.part_id &lt;&gt; '1'\n</code></pre>\n\n<p>My table: car_parts</p>\n\n<pre><code>Car ID | Part ID\n   1        1\n   1        3\n   1        4\n   2        2\n   2        5\n   2        7\n   3        1\n   3        4\n   3        9\n   4        1\n</code></pre>\n\n<p>The only car_id that should be returned from the query is car_id = 2.</p>\n"},{"tags":["mysql","sql","query","jdbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12865027,"title":"mysql queries based on a previous (mysql root password change) query","body":"<p>I have some methods to perform mysql queries using JDBC in the following sequence (with parameters of course):</p>\n\n<pre><code>testMysql(); \nchangeUserPassword(); \nflushPrivileges(); \nsomeMoreMethodsUsingNewPassword();\n</code></pre>\n\n<p>The result for these methods are</p>\n\n<pre><code>succes\nfail\nfail\nfail\n</code></pre>\n\n<p>The first one only succeeds after closing my application. I restart and see that the password has been changed.</p>\n\n<p>Now, why didnt it reflect imediately after the 3rd (<code>flushPrivileges()</code>) and why didnt it make <code>someMoreMethodsUsingNewPassword()</code> as success?</p>\n\n<p>well I am editing it from here</p>\n\n<p>I discovered that flushing priviliges is compulsory. As up to method 3 (flushprivs) is ok in the backend.</p>\n\n<p>I am using a method for all initializations as similer to this:</p>\n\n<pre><code>if(main.MainDB.changeUserPassword(host, user, pass/*old*/, newPassword)){\n    resultTextArea.setText(resultTextArea.getText()+\"\\r\\n\"\n            + \"- Root password change \\t\\t\\t\\t\\t Success !\");\n}else{\n    resultTextArea.setText(resultTextArea.getText()+\"\\r\\n\"\n            + \"- Root password change \\t\\t\\t\\t\\t Failed !\");\n}\n</code></pre>\n\n<p>and I always get failed results, despite success is in the back end.</p>\n\n<p>So any one knows whats wrong?</p>\n\n<pre><code>public static boolean testMysql(String host, String user, String password) {\n    Connection con = null;\n    try {\n        Class.forName(\"com.mysql.jdbc.Driver\");\n        con = DriverManager.getConnection(\n            \"jdbc:mysql://\"+host+\":3306/mysql\", user, password);\n        Statement stmt = con.createStatement();\n        boolean b = stmt.execute(\"show tables\");\n        con.close();\n        return b;\n    } catch (ClassNotFoundException | SQLException e) {\n        ErrorLogging.errorLog(e.toString());\n        e.printStackTrace();\n        return false;\n    } \n}\npublic static boolean changeUserPassword(String host, \n                                         String user, \n                                         String prevPass, \n                                         String newPass) {\n    Connection con = null;\n    int num = 0;\n    try {\n        Class.forName(\"com.mysql.jdbc.Driver\");\n        con = DriverManager.getConnection(\n            \"jdbc:mysql://\"+host+\":3306/mysql\", user, prevPass);\n        PreparedStatement pStmt = con.prepareStatement(\n            \"update user set password=PASSWORD(?) where User=?\");\n        pStmt.setString(1, newPass);\n        pStmt.setString(2, user);\n        //  PreparedStatement pStmt = con.prepareStatement(\n        //  \"SET PASSWORD FOR ?@? = PASSWORD(?)\");\n        //  pStmt.setString(1, user);\n        //  pStmt.setString(2, host);   \n        //  pStmt.setString(3, newPass); \n        num = pStmt.executeUpdate();\n        con.close();\n    } catch (ClassNotFoundException | SQLException e) {\n        main.ErrorLogging.errorLog(e.toString());\n    } \n    if(num == 1){\n        return true;\n    }else{\n        return false;\n    }  \n}\n\npublic static boolean flushPrivileges(String host, \n                                      String user, \n                                      String password) {\n    Connection con = null;\n    int num = 0;\n    try {\n        Class.forName(\"com.mysql.jdbc.Driver\");\n        con = DriverManager.getConnection(\n            \"jdbc:mysql://\"+host+\":3306/mysql\", user, password);\n        PreparedStatement pStmt = con.prepareStatement(\n            \"flush privileges\");\n        num = pStmt.executeUpdate();\n        con.close();\n    } catch (ClassNotFoundException | SQLException e) {\n        main.ErrorLogging.errorLog(e.toString());\n    } \n    if(num == 1){\n    return true;\n    }else{\n    return false;\n    }  \n}\n</code></pre>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12865935,"title":"how to write a fieldValue.contains(\"someString\") query in MongoDB that works for find and aggregation functions","body":"<p>I need to implement fieldValue.contains(\"someString\") search in MongoDB query?</p>\n\n<p>the solution that I found is </p>\n\n<pre><code>db.main.find(  { $where: \"this.content.indexOf('someString') != -1\" } );\n</code></pre>\n\n<p>and it works fine for a find function.</p>\n\n<p>but when I do the same in Aggregation function</p>\n\n<pre><code>db.foo.aggregate(\n    {\n        $match: \n                { $where: \"this.content.indexOf('someString') != -1\" }\n    },\n    {\n        $project :\n                {\n                    _id : 1,\n                    words : 1\n                }\n    },\n    {\n        $unwind : \"$words\"\n    },\n    {\n        $group : {\n                    _id : { tags : \"$words\" },\n                    count : { $sum : 1 }\n                }\n    },\n    {\n        $sort: {count:-1}\n    },\n    {\n        $limit : 5\n    }\n);\n</code></pre>\n\n<p>I've got this result:</p>\n\n<pre><code>{\n        \"errmsg\" : \"exception: $where is not allowed inside of a $match aggregation expression\",\n        \"code\" : 16395,\n        \"ok\" : 0\n}\n</code></pre>\n\n<p>The question: how to write a fieldValue.contains(\"someString\") query in MongoDB that works for find and aggregation functions.</p>\n"},{"tags":["sql","query","max","min","lag"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12856659,"title":"Check Sequence in Max Min Values","body":"<p>I have a database table that Stores Maximum and Minimum Price Breaks for a Product.\n<img src=\"http://i.stack.imgur.com/WBj4S.jpg\" alt=\"enter image description here\"></p>\n\n<p>Does anyone know of the SQL which say if I have a break from one Max to the Min of the next item.  E.g. 1-10 12-20  I would like it to return me either the numbers that are missing or at the very least a count or bool if it can detect a break from the Absolute Min and the Absolute Max by going through each range.</p>\n\n<p>SQL Server (MSSQL) 2008</p>\n"},{"tags":["query","mongodb","sorting","geospatial"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":508,"score":8,"question_id":6003943,"title":"Find most recent & closest posts, limit 20","body":"<p>Let's say I have a bunch of posts (for a feed, like a Twitter/Facebook/foursquare feed) in MongoDB, and each post has a <a href=\"http://www.mongodb.org/display/DOCS/Geospatial+Indexing\" rel=\"nofollow\">location</a> &amp; a <a href=\"http://www.mongodb.org/display/DOCS/Timestamp+Data+Type\" rel=\"nofollow\">timestamp</a>.</p>\n\n<p>What's the best way to get the most recent &amp; closest posts, limited to 20 posts?</p>\n\n<p>This is also a subjective question. Let's say that you can specify <code>$maxDistance</code> and the max time since now (I'm not sure how you'd do it otherwise.). How would you specify them? Would you sort by most recent or closest, or keep it random or sort some other way? Which sorting algorithm do you think is most interesting?</p>\n"},{"tags":["php","html","mysql","query","get"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12865435,"title":"PHP GET with multiple where clause in mySQL","body":"<p>Afternoon Stackers, </p>\n\n<p>Having a rough time with a PHP/mySql query through $_GET. </p>\n\n<p><strong><em>What I would like to accomplish</em></strong>\nUsing $_GET run a mySql query similar to the following URL:\n<code>http://localhost/searchresults.php?clause1=ABC&amp;clause2=XYZ</code></p>\n\n<p>Pull specific data from a table using the <em>WHERE = '' AND = ''</em> </p>\n\n<p>.......<br>\nI currently have a similar script in play using the following code string(s):</p>\n\n<p>i) Search string is created utilizing <code>$_POST['tableColumn']</code> data (currently working in a single WHERE clause)<br>\nii) searchstring passed via URL to .php page _http://localhost/example.php?clause=somesearch (this is working well but needs to include a second search clause)<br>\niii) <code>$search = searchQuery('search', 'example.php');</code><br>\niv) searchQuery defined as  </p>\n\n<pre><code>function searchQuery ($id, $location) {\nif (isset($_GET[$id])) {\n    return $_GET[$id];\n} elseif (isset($_POST[$id])) {\n    return $_POST[$id];\n} else {\n    header(\"Location: $location\");\n    exit;\n}\n}\n</code></pre>\n\n<p>v) search is run utilizing the URL $_GET data and runs with the script:</p>\n\n<pre><code>function pullQuery($read, $clause) {\n$sql = \"SELECT * FROM `table` WHERE `clause` = '$clause'\";\nreturn $read-&gt;fetchAll($sql);\n}\n</code></pre>\n\n<p>So up to this point things work out well, the single clause works just fine, my problem is creating a multiple clause search query. What would need to be modified to make this work. In effect the modified \"pullQuery\" would look like:</p>\n\n<pre><code>function pullQuery($read, $clause, $clause2) {\n$sql = \"SELECT * FROM `table` WHERE `clause` = '$clause' AND `clause2' = '$clause2'\";\nreturn $read-&gt;fetchAll($sql);\n}\n</code></pre>\n\n<p>Now this is far as I have gone in mySql cli.. this works but what needs to be done to make a link like: <code>http://localhost/example.php?clause=somesearch&amp;clause2=anothersearch</code></p>\n\n<p>Any help would be appreciated, have a wonderful weekend.</p>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12863606,"title":"SQL Optimization : How to optimize the query in MySQL?","body":"<p>I am writing a SQL query which requires highly optimized solution, so as to not timeout. But I have got no idea of how to continuously optimize the following SQL query:</p>\n\n<pre><code>select distinct j.job,f.path,p.path \nfrom fixes f, jobs j, paths p where f.job=j.id and p.id =f.path \nand (p.path like '//Tools/Web/%' or p.path = '//Tools/Web');\n</code></pre>\n\n<p>I have created indexes on the following fields(essentially everything):</p>\n\n<ul>\n<li>jobs.id</li>\n<li>jobs.job</li>\n<li>paths.path</li>\n<li>paths.id</li>\n<li>fixes.job</li>\n<li>fixes.path</li>\n</ul>\n\n<p>In each of the \"fixes\", \"jobs\", \"paths\" table there are ~50,000 rows, and current timeout is 6 min</p>\n\n<h3>The 'explain' command shows the following information, try to deciphering</h3>\n\n<pre><code>1   SIMPLE  j   index   PRIMARY         job     62   (null)    73226    Using index; Using temporary\n1   SIMPLE  f   ref     path,job        job     8    j.id      825  \n1   SIMPLE  p   eq_ref  PRIMARY,path    PRIMARY 8    f.path    1        Using where\n</code></pre>\n\n<h3>The table creation statements for the 'paths' table:</h3>\n\n<pre><code>CREATE TABLE `paths` (\n   `id` bigint(20) NOT NULL AUTO_INCREMENT,\n   `path` varchar(250) NOT NULL,\n   PRIMARY KEY (`id`),\n   UNIQUE KEY `path` (`path`),\n ) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n"},{"tags":["android","query","httpresponse","bufferedreader"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12855301,"title":"android calling php but response isn't readable","body":"<p>I'm trying to query from a php script as the following: </p>\n\n<pre><code>http://xxxx.com/ccvo/mel-asset-data/query.php?lon=144.963620993985&amp;lat=-37.8140023779914&amp;within=20&amp;category=Litter Bin\n</code></pre>\n\n<p>The results from the webpage query will be in plain text like the following: </p>\n\n<pre><code>4|Litter Bin,-37.8141472000103,144.963691391683,17.2492037024|Litter Bin,\n37.8141472763581,144.963685395193,17.0753971521|Litter Bin,\n37.8139653160326,144.963765797949,13.3704129156|Litter Bin,\n37.8139469233985,144.963755935562,13.3613106302\n</code></pre>\n\n<p>I need to pass values to the four parametsers. My code so far is getting error 200 which means it has access to the web. Also, the query is formated well, and when do Log.d I get the following: </p>\n\n<pre><code>query[lon=144.963620993985, lat=-37.8140023779914, within=4, keyword=Litter Bin]\n</code></pre>\n\n<p>Then I need to parse the results as the following: \nnumber of results, (lon and lat), within, keyword</p>\n\n<p>my could is: </p>\n\n<pre><code>    public class myMapService extends AsyncTask&lt;String, Void, Integer&gt; {\n        private ProgressDialog progressDialog;\n        private keyword activity;\n        private int id = -1;\n        private String rst = \" \" ; \n\n\n        public myMapService(keyword activity, ProgressDialog progressDialog)\n        {\n            this.activity = activity;\n            this.progressDialog = progressDialog;\n        }\n\n        @Override\n        protected void onPreExecute()\n        {\n            progressDialog.show();\n        }\n\n\n        @Override\n        protected Integer doInBackground(String... arg0) {\n            String result = \"\";\n            int responseCode = 0;\n            try \n            {\n                HttpClient client = new DefaultHttpClient();\n                HttpPost httppost = new HttpPost(\"http://xxxx.com/ccvo/mel-asset-data/query.php\");\n\n                List&lt;NameValuePair&gt; nameValuePairs = new ArrayList&lt;NameValuePair&gt;();\n                nameValuePairs.add(new BasicNameValuePair(\"lon\", \"144.963620993985\"));\n                nameValuePairs.add(new BasicNameValuePair(\"lat\", \"-37.8140023779914\"));\n                nameValuePairs.add(new BasicNameValuePair(\"within\", \"20\"));\n                nameValuePairs.add(new BasicNameValuePair(\"keyword\", \"Litter Bin\"));\n            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs,HTTP.UTF_8));\n\n            Log.v(\"URL\", \" with query\" + nameValuePairs);\n\n            int executeCount = 0;\n            HttpResponse response;\n            do\n            {\n                progressDialog.setMessage(\"Passing paratmeters.. (\"+(executeCount+1)+\"/5)\");\n                // Execute HTTP Post Request\n                executeCount++;\n                response = client.execute(httppost);\n                responseCode = response.getStatusLine().getStatusCode();                        \n                // If you want to see the response code, you can Log it\n                // out here by calling:\n                // Log.d(\"256 Design\", \"statusCode: \" + responseCode)\n                //InputStream content = response.getEntity().getContent();\n\n\n               // Log.d(\"256 Design\", \" Response print\" + response);\n\n\n            } while (executeCount &lt; 5 &amp;&amp; responseCode == 408);\n\n\n            BufferedReader rd = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));\n            StringBuilder sb = new StringBuilder();\n\n            //Log.d(\"Results\", \" Inside whileloops \" + rd);\n\n            String line;\n            while ((line = rd.readLine()) != null)\n            {\n                result = line.trim();\n                sb.append(line);\n\n                rst = result.toString();\n\n\n\n            }\n\n\n            Log.v(\"Results\", \"rst \" + sb);\n            id = Integer.parseInt(result);\n\n        }\n\n\n\n        catch (Exception e) {\n            responseCode = 408;\n            e.printStackTrace();\n        }\n\n        Log.d(\"Results\", \"from web: \" + rst);\n\n\n        return responseCode;\n\n    }\n\n\n\n@Override\nprotected void onPostExecute(Integer headerCode)\n{\n    progressDialog.dismiss();\n\n}\n}\n</code></pre>\n\n<hr>\n\n<p>when I do Log.d to the response or the BufferedReader , I get something like this : </p>\n\n<pre><code>-java.io.BufferedReader@40fc93c8\n-printorg.apache.http.message.BasicHttpResponse@40f746b8\n</code></pre>\n\n<p>I need help please to get the results and parse them. </p>\n\n<p>Thank you,\nA. </p>\n"},{"tags":["mysql","performance","query","group-concat"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12864693,"title":"Mysql, group_concat performance: split huge table","body":"<p>I've a huge table (231,451,584 rows, 14 columns, 15.1 GiB size). </p>\n\n<p>The last 3 columns have data that will be \"group_concated\" into 3 different tables (resuming the number of rows to ≈2,500 by eliminate the redundancy of the first 11 columns and merging the values of columns #12 or #13 or #14 into a big comma separated, csv formatted text).</p>\n\n<p>This operation (the group_concat insert on each new table) takes a huge time (≈18.000 seconds per new table).</p>\n\n<p>It should be fast if I split my first table into 3 (same 11 columns first, and just a last one with the different values I want to concat, for each new table)?</p>\n\n<p>I'm asking this here because it takes to long to get a benchmark for my case... </p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12863652,"title":"adding a column if record exists in two tables","body":"<p>I have two tables.  One is a list of all categories. The other is a list of categories a thing might belong to. A thing can belong to more than one category (it might have more than one record in table two)</p>\n\n<p>So, I have </p>\n\n<p>table: </p>\n\n<pre><code>categories \n1,   horror\n2,   romance\n3,   post modern\n4,   Canadian\n5,    English\n\n...\n2340  \n</code></pre>\n\n<p>Then another table, thingsToCategories, with two columns (thingID, categoryID)</p>\n\n<pre><code>thingID   categoryID\n6323-01    1\n6323-01    4\n6323-01    5\n1342-01    2\n1342-01    4\n</code></pre>\n\n<p>Given a thingID, I need a list of all categories (as in select * from table A), with an indication of whether that thing ID exists in table B</p>\n\n<p>So, given thingID of 6323-01, I need a list like this:</p>\n\n<pre><code>1,   horror    selected\n2,   romance\n3,   post modern\n4,   Canadian   selected\n5,    English   selected\n</code></pre>\n\n<p>My SQL skills are rusty and bad enough I'm not even sure what sort of join to use.  Can anyone give any pointers?</p>\n\n<p>(I inherited this database, fwiw)</p>\n"},{"tags":["php","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12544758,"title":"How to find the table name which the image randomly selected from","body":"<p>i have a query to randomly select 6 images from 3 sql table in same database and once some one clicked on that image i want to send them to separate page according from what table that image is selected from. to do that by the query i want to find out the table name which that random image was selected. \nmy sql query is </p>\n\n<pre><code>$sql=\"SELECT *\nFROM   salehotel\nUNION ALL\nSELECT *\nFROM   saleland\nUNION ALL\nSELECT *\nFROM   salehouse\nORDER BY RAND()\nLIMIT 6\n\";\n$result=mysql_query($sql)or die(mysql_error());\n?&gt;\n&lt;?php\n        while($row = mysql_fetch_array($result))\n        {?&gt;\n    &lt;div style=\"float: left; margin-left: 10px;\"&gt;\n        &lt;a href=\"sale_house_detail.php?id=&lt;?php echo $row['property_id'];  ?&gt;\"&gt;\n            &lt;img src=&lt;?= '\"admin/uploads/'.$row['image1'].'\"'; ?&gt; width=\"172px\" height=\"149px\" style='border:5px solid  #CCC' /&gt;\n        &lt;/a&gt;\n    &lt;p&gt;&lt;?php  echo $row['Type']; ?&gt;&lt;/p&gt;\n    &lt;p&gt;&lt;?php  echo $row['Location']; ?&gt;&lt;/p&gt;\n  &lt;/div&gt;\n\n    &lt;?php   }\n    ?&gt;\n</code></pre>\n"},{"tags":["android","database","query","sqlite","assets"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12832421,"title":"Read only SQLite DB update in assets folder for new app version","body":"<p>At the moment I am fiddling myself into working with sql databases in android and created my first app. now i wanted to update this app and the including database in the assets folder. I overwrote the old database with the new one but on my phone it doesnt show the new entries.</p>\n\n<p>It somehow is saving the old entries/queries or entirely the old Db. I checked on the net but couldnt really find a solution. Below my dbhelper code. Do i have to do something in <code>onUpgrade</code> or what would be the procedure?</p>\n\n<p>Many thanks for helping!</p>\n\n<pre><code>public class DataBaseHelper extends SQLiteOpenHelper {\nprivate static String DB_PATH;\n\nprivate static String DB_NAME;\n\nprivate SQLiteDatabase db_object;\n\nprivate final Context context;\n\npublic DataBaseHelper(Context context, String db) {\n    super(context, db, null, 80);\n    this.context = context;\n    DB_PATH = \"/data/data/\" + context.getPackageName() + \"/databases/\";\n //   DB_PATH = \"/data/data/com.comp.appname/databases/\";\n    DB_NAME = \"mydatabase.sqlite\";\n    try {\n        createDataBase();\n    } catch (IOException ioe) {\n        throw new Error(\"Unable to create database\");\n    }\n    try {\n        openDataBase();\n    } catch (SQLException sqle) {\n        throw sqle;\n    }\n}\n\n@Override\npublic void onCreate(SQLiteDatabase db) {\n    // TODO Auto-generated method stub\n}\n\n@Override\npublic void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {\n    // TODO Auto-generated method stub\n}\n\npublic void createDataBase() throws IOException {\n    boolean dbExist = checkDataBase();\n    if (dbExist) {\n    } else {\n        this.getReadableDatabase();\n        try {\n            copyDataBase();\n        } catch (IOException e) {\n            throw new Error(\"Error copying database\");\n        }\n    }\n}\n\nprivate boolean checkDataBase() {\n    SQLiteDatabase checkDB = null;\n    try {\n        String myPath = DB_PATH + DB_NAME;\n        checkDB = SQLiteDatabase.openDatabase(myPath, null,\n                SQLiteDatabase.OPEN_READONLY);\n    } catch (SQLiteException e) {\n    }\n    if (checkDB != null) {\n        checkDB.close();\n    }\n    return checkDB != null ? true : false;\n}\n\nprivate void copyDataBase() throws IOException {\n    InputStream myInput = context.getAssets().open(DB_NAME);\n    String outFileName = DB_PATH + DB_NAME;\n    OutputStream myOutput = new FileOutputStream(outFileName);\n    byte[] buffer = new byte[1024];\n    int length;\n    while ((length = myInput.read(buffer)) &gt; 0) {\n        myOutput.write(buffer, 0, length);\n    }\n    myOutput.flush();\n    myOutput.close();\n    myInput.close();\n}\n\npublic void openDataBase() throws SQLException {\n    String myPath = DB_PATH + DB_NAME;\n    db_object = SQLiteDatabase.openDatabase(myPath, null,\n            SQLiteDatabase.OPEN_READONLY);\n}\n\n@Override\npublic synchronized void close() {\n    if (db_object != null)\n        db_object.close();\n    super.close();\n}\n}\n</code></pre>\n"},{"tags":["mysql","query","left-join","tornado"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12860806,"title":"Exclusive queries, left outer join or addition of queries","body":"<p>I have two tables:</p>\n\n<pre><code>nets_permissions\n\n    user_id INT NOT NULL,\n    network_id BIGINT UNSIGNED NOT NULL,\n    perm INT(3) NOT NULL,\n    PRIMARY KEY(user_id, network_id)\n\n\ndevices_permissions\n\n    user_id INT NOT NULL,\n    network_id BIGINT UNSIGNED NOT NULL,\n    device_id INT UNSIGNED NOT NULL,\n    perm INT(3) NOT NULL,\n    PRIMARY KEY(user_id, network_id, device_id),\n</code></pre>\n\n<p>The <code>nets_permissions table</code> has permissions for each user. A user can have a different perm values: 1 for read permission, 2 for write permission, 4 for read+commands permission. The net admin have a perm value of 3.</p>\n\n<p>Same thing for the second table, but this time for the devices that are in the specific net. The users are added to this table when the admin of the net and devices give them a permission. But the admin of the net is not registered in this table. He is only in the nets_permission table with perm=3. </p>\n\n<p>I have to create a query that select the permission of the current user in an handler of Tornado Web Server. The code is in this form:</p>\n\n<pre><code># Retrieve the current user \n    usr = self.get_current_user()\n    usr_id = usr['id']\n    self.lock_tables(\"read\", ['nets_permissions as n, devices_permissions as d'])\n    usrperm = self.db.query(\"SELECT * FROM nets_permissions as n \n         LEFT OUTER JOIN devices_permissions as d \n              ON n.network_id = d.network_id WHERE d.user_id=%s \n                 AND d.device_id=%s\", \n         int(usr_id), sens.id);\n    self.unlock_tables()\n</code></pre>\n\n<p>In usr_id I retrieve is the id of the current user. </p>\n\n<p>The current user can be the admin of the net (so he is only in the table nets_permissions with perm=3) or a user with some permission on the specific device (so he is only in the devices_permissions table with some value for perm). </p>\n\n<p>In the query result 'userperm' I would use an integer to compare after in the html page with a permission value and to show or not something to the user.</p>\n\n<p>Sorry for my English but is difficult explain for me the problem. I don't know I can structure the query to obtain this result I want.</p>\n\n<p>Thank you very much for your help.</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12862535,"title":"Selecting chained records from a table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/53108/is-it-possible-to-make-a-recursive-sql-query\">Is it possible to make a recursive SQL query?</a>  </p>\n</blockquote>\n\n\n\n<p>Imagine an application where one would want to keep a history of the changes made to a 'record' in a database.</p>\n\n<p>This can be realized by introducing a column 'revised_id' which points to the newer version of the record.</p>\n\n<pre><code>id  value                               revised_id\n--------------------------------------------------\n1   Initial value...                    3\n2   Value of a different record         Null\n3   Value which has been altered        4\n4   Value which has been altered again  Null\n</code></pre>\n\n<p>The table illustrates two 'actual records', one of which has been altered two times</p>\n\n<p>Getting all the latest versions simply means adding revised_id = null to the WHERE clause. To get the previous version simply: SELECT * FROM table WHERE revised_id = $current_id</p>\n\n<p>My questing is: would it be possible to select all te previous versions of a given record?(The problem being that simple comparisons do not suffice because the records to be selected are 'chained' together.)</p>\n"},{"tags":["php","mysql","query","drop-down-menu","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12861936,"title":"Filtering MYSQL data using dropdown boxes","body":"<p>I have populated an html page with a table from the database. I want to add dropdown boxes at the top that can filter out unnecessary data. How would I go about sending this information to the database to make a query so that I can filter out data with multiple variables?</p>\n\n<p>For example, I have 5 categories, A, B, C, D, and E.\nI have used PHP code to populate the boxes with the possible values/entries for A, B, C, D, and E. I've also added a \"NULL entry\" in case the user does not want to include this column as part of the filter.</p>\n\n<p>So right now as it stands, for the respective columns we can have:</p>\n\n<pre><code>Apple, always, as, amazing, as, almonds, NULL.\nBelly, boosts, bad, NULL.\nCandy, can, create, NULL.\nDandy, does, do, don't, NULL.\nElements, exist, NULL.\n</code></pre>\n\n<p>How would I go about sending the information to the database when the variables are indefinite? They may or may not be set.</p>\n\n<p>I figured I'd start by seeing if the variables were set in the first place by using the isset(), but how would I proceed from there? It seems like a lot of 'if' statements. All I need to do is to change the query based on the values of the variables the user enters. But I don't see an easy way of doing that.</p>\n\n<p>I'll simply be adding \"WHERE A = this AND B = that AND C = thisthat AND ..\" to the end of the query but what if one or more or all of those entries are null? </p>\n\n<p>Thanks a lot for any help.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12861520,"title":"Non linear, three way sum of table data","body":"<p>My <a href=\"http://sqlfiddle.com/#!2/0dc39\" rel=\"nofollow\">table</a></p>\n\n<pre><code>user_name     id      status          calls\n===========================================\napple        21       BadAd             2\napple        21       Lead              5\napple        21       DNC               6\napple        21       pajs              2\norange       34       Lead              9\norange       34       disks             3\norange       34       BadAd             8\norange       34       pajs              5\n</code></pre>\n\n<p>My attempt</p>\n\n<pre><code> SELECT sum(calls) FROM (SELECT y.calls, y.user_name, y.status FROM stats\n INNER JOIN\n (select user_name, status, sum(calls) as calls\n from stats WHERE status = ('BadAD', 'Lead', 'DNC')\n group by user_name, status) y\n ON y.user_name = stats.user_name\n GROUP BY y.status) w WHERE w.user_name = y.username\n</code></pre>\n\n<p>My problem: I am trying to add up the values from the <code>calls</code> field of rows that only contain a certain <code>status</code> field value (<code>WHERE status = ('BadAD', 'Lead', 'DNC')</code>) and has the same user_name. So it would look like this.</p>\n\n<pre><code>user_name     id      status          calls\n===========================================\napple        21       BadAd             13           (BadAd 2 + Lead 5 + DNC 6)\norange       34       Lead              17           (etc..)\n</code></pre>\n"},{"tags":["mysql","query","mongodb","express","mongoose"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12858902,"title":"How can i repeat MySQL's WHERE 1 query in MongoDB?","body":"<p>I can do this in MySQL:</p>\n\n<pre><code>WHERE 1 AND 1 AND 1\n</code></pre>\n\n<p>How can i repeat it in MongoDB? What is MongoDB's equivalent for WHERE 1 ?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>So. I don't know how choose best answer ^^ and expanded question. As @mark-hillick noticed - i'm searching the best way to build query.\nNow I'm using this way (express+mongoose):</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>//req.query - get/post object in Express\n\nfor (var q in req.query) {\n  if (req.query[q]) { //simplified example\n    query[q] = req.query[q];\n  };\n}\n\nCollection.find(query)\n</code></pre>\n\n<p>Your suggestions?</p>\n"},{"tags":["sql-server","performance","query","large-data"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12460602,"title":"Large SQL Server database timing out PHP web application","body":"<p>We are running a hospital system which is web based created in PHP. The system was initially fast due to small size of the database but now it has become slow.</p>\n\n<p>The following is an example query</p>\n\n<pre><code>select pa.id, pa.date as date, pa.visitno, pa.receiptno, pa.debitnoteno, pad.id as padid,\n pad.serviceid as serviceid, pad.waitno, pa.paytype, s.id as doctorid, s.fullname as\n doctorname, p.id as patientid, p.name as patient, p.regno, p.age, p.gender, p.doc,\n p.department, p.telno, p.address, pa.ins_prov_id, ip.name as provider,\n pa.sicksheet_billcode as billcode, ds.id as serviceid, ds.name as servicename, ds.departid\n as departid, ds.servicetype as servicetype, pad.charge, pad.status as status, ts.id as\n timeslotid, ts.name as timeslot, pad.treatment, sd.anesthesiologist, sd.hospitalcharge,\n sd.anesthcharge from patientappointments as pa\nINNER JOIN patientappdetails as pad ON pa.id = pad.patappid \nINNER JOIN patients as p ON pa.patid = p.id \nINNER JOIN staffs as s ON pad.doctorid = s.id \nLEFT JOIN departmentalservices as ds ON pad.serviceid = ds.id \nLEFT JOIN insproviders as ip ON pa.ins_prov_id = ip.id \nLEFT JOIN timeslots as ts ON pad.timeslotid = ts.id \nLEFT JOIN surgerydetails as sd ON sd.appdetid = pad.id \nwhere 1 = 1 and pa.date &gt;= '01.Jul.2012' and ds.departgroupid = 16 and pad.charge != 0\n</code></pre>\n\n<p>As you can see the size of our queries (call them un-optimized) which shows the patient, doctor, service taken, what time and which ins company he came from. So now we created indexes that did help for a while but now again the speed has become slow. Running the system on localhost results in around 15 secs for the result to appear while on the live system, <strong>it times out</strong>.</p>\n\n<p>Can you suggest any method to improve the speed and exactly how to implement them. </p>\n\n<p>Just FYI, rows in each table are as follows:</p>\n\n<ul>\n<li>patientappdetails - 195k</li>\n<li>patients - 34k</li>\n<li>staffs - 200</li>\n<li>departmentalservices - 700</li>\n<li>insproviders - 2800</li>\n</ul>\n\n<p>Thank you</p>\n"},{"tags":["c#","linq","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12835851,"title":"Find closest location with longitude and latitude using linq c#","body":"<p>i am working on a application where i need to get nearby location, \nmy web service will receive 2 parametrs (decimal longitude, decimal latitude )</p>\n\n<p>i have a table where the locations are saved in database with longitude and latitude fields,</p>\n\n<p>i want to retrieve the nearest locations.</p>\n\n<p>can anyone help ?</p>\n\n<p>Thanks</p>\n\n<p>here is my code</p>\n\n<pre><code> var locations = from l in locations\n\n     select l\n</code></pre>\n\n<p>Here are further details about this :\ni have a 2 fields (decimal(18, 2) null) 1 latitude, 2 longitude inside a database table,</p>\n\n<p>and i have a method </p>\n\n<pre><code>public List&lt;Locations&gt;  GetLocation(decimal? Long, decimal? lat) \n{\nvar Loc = from l in Locations\n  //// now here is how to get nearest location ? how to query?\n  //// i have also tried Math.Abs(l.Lat - lat) its giving error about nullable decimal always hence i have seted decimal to nullable or converted to nullable\n //// also i have tried where (l.lat - Lat) * (l.lon - Long)  this is also giving error about can not convert decimal to bool\nreturn Loc.ToList();\n}\n</code></pre>\n"},{"tags":["java","database","query","wsdl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12845128,"title":"abstracting data-type heterogeneity of different database","body":"<p>In my current  project, I have a requirement of abstracting data-type heterogeneity among different database.</p>\n\n<p>For instance,  I have a table in MySQL database. Table name is <code>FIRSTTABLE(badgeID *Integer* , pref INT)</code>.</p>\n\n<p>I have a table in Apache-Derby database. Table name is <code>FIRSTTABLE (badgeID *varchar(12)*, pref INT)</code>.</p>\n\n<p>Now,  query component, which queries MySQL database and Apache Derby database at same time, has badgeID as \"double\".</p>\n\n<p>My requirement is that query-component should not know underlying database (either MySQL or Apache Derby). Its query should be independent of type of database.</p>\n\n<p>How could I resolve this issue ? My research problem is not limited to MySQL or Apach-Derby. For clarity, I have taken an example of Apache-Derby and MySQL.</p>\n"},{"tags":["performance","query","mongodb","limit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12859857,"title":"Find the next \"older\" document (performance)","body":"<p>I have a collection of posts (see the pseudo-json :-) ) : </p>\n\n<pre><code>[\n  {\"title\":\"First\",\"created\":\"2012-10-04 01:00:00\"},\n  {\"title\":\"Second\",\"created\":\"2012-10-04 03:30:00\"},\n  {\"title\":\"Third\",\"created\":\"2012-10-02 02:00:00\"}\n]\n</code></pre>\n\n<p>I am in the \"2012-10-04\" posts page and I want to know if there are older posts, just for displaying a \"next page\" button.</p>\n\n<p>I can think about a query like this:</p>\n\n<pre><code>db.posts.find({\"created\":{$lt:ISODate(\"2012-10-04\")} }).limit(1);\n</code></pre>\n\n<p>I still have to try it, but I think it will work... actually my question is:</p>\n\n<p><em>What about its performance? Will it run at the same speed with billions of documents in the collection?</em></p>\n"},{"tags":["mysql","sql","query","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":54,"score":4,"question_id":12859895,"title":"Mathematical SUM of multiple rows by value","body":"<p>I have a table</p>\n\n<pre><code>user_name     id      status          calls\n===========================================\napple        21       cars              67\napple        21       bikes             85\napple        21       skates            6\napple        21       pajs              56\norange       34       bikes             9\norange       34       disks             3\norange       34       cars              21\norange       34       pajs              76\n</code></pre>\n\n<p>I want to add up all the calls for <code>status's</code> that are cars, bikes and skates only and for each user_name. I have experminted with <code>SUM</code> but after several hours of late night, earnest attempts its pretty clear to me that this is going to require more than that. Can anyone point me in the right direction please?</p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/0dc39\" rel=\"nofollow\">My Table</a></p>\n"},{"tags":["sql","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12858915,"title":"How to update all varchar, nvarchar or char field of a SQL Server database and set empty string in the place of NULL?","body":"<p>In my database there are a lot of <code>NULL</code> values. Now I need to replace all the <code>NULL</code> values and set them to empty strings instead, because my existing software has problems with <code>NULL</code>  values.</p>\n\n<p>How can I do that?</p>\n"},{"tags":["sql","query","relational-database","left-join","relation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12847000,"title":"get a query which returns items associated with categories and subcategories?","body":"<p>I want to get a query which returns all items that belong to a category and subcategories.</p>\n\n<p>Here's the setup:</p>\n\n<pre><code>CREATE TABLE [dbo].[CategoriasProductos](\n    [IdCategoria] [int] IDENTITY(1,1) NOT NULL,\n    [IdGrupo] [int] NULL,\n    [Nombre] [varchar](50) NULL,\n    [Estado] [varchar](20) NULL,\n    [Descripcion] [text] NULL,\n    [IdCategoriaPadre] [int] NULL,\n    [Nivel] [nchar](10) NULL,\n CONSTRAINT [PK_CategoriasProductos] PRIMARY KEY CLUSTERED \n(\n    [IdCategoria] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\n\n\n\nCREATE TABLE [dbo].[Productos](\n    [IdProducto] [int] IDENTITY(1,1) NOT NULL,\n    [IdGrupo] [int] NULL,\n    [IdCategoria] [int] NULL,\n    [IdAlmacen] [varchar](50) NULL,\n    [Codigo] [varchar](50) NULL,\n    [Nombre] [varchar](50) NULL,\n    [Descripcion] [varchar](max) NULL,\n    [Cantidad] [int] NULL,\n    [Imagen] [varchar](max) NULL,\n    [StockMin] [int] NULL,\n    [StockMax] [int] NULL,\n    [Ancho] [varchar](50) NULL,\n    [Alto] [varchar](50) NULL,\n    [Largo] [varchar](50) NULL,\n    [Peso] [varchar](50) NULL,\n    [Volumen] [varchar](50) NULL,\n    [Color] [varchar](50) NULL,\n    [Material] [varchar](50) NULL,\n    [Presentacion] [varchar](50) NULL,\n    [bitPrecioVentaUnico] [int] NULL,\n    [PrecioCompra] [money] NULL,\n    [DescuentoCompra] [float] NULL,\n    [PrecioVenta] [money] NULL,\n    [DescuentoVenta] [float] NULL,\n    [Estado] [varchar](20) NULL,\n CONSTRAINT [PK_Productos] PRIMARY KEY CLUSTERED \n(\n    [IdProducto] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\n) ON [PRIMARY]\n</code></pre>\n\n<p>Now to add some data (at least for the categories only)</p>\n\n<pre><code>SET IDENTITY_INSERT [dbo].[CategoriasProductos] ON\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (1, 1, N'0')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (2, 1, N'1')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (3, 1, N'1')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (4, 2, N'2')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (5, 2, N'2')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (6, 4, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (7, 4, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (10, 5, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (11, 5, N'3')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (14, 3, N'2')\nINSERT [dbo].[CategoriasProductos] ([IdCategoria], [IdCategoriaPadre], [Nivel]) VALUES (15, 3, N'2')\nSET IDENTITY_INSERT [dbo].[CategoriasProductos] OFF\n</code></pre>\n\n<p>(I only inserted the data that I know that will or might be requiered for the query. Also, I have more rows in my original database but inserted fewer just to not make this anymore convoluted)</p>\n\n<p>Now, for the moment I tried this query out:</p>\n\n<pre><code>SELECT Productos.Codigo, Productos.Nombre, Productos.Descripcion, A.Nombre AS Categoria\nFROM Productos LEFT OUTER JOIN\nCategoriasProductos AS A ON Productos.IdCategoria = A.IdCategoria LEFT OUTER JOIN\nCategoriasProductos AS B ON B.IdCategoriaPadre = A.IdCategoria LEFT OUTER JOIN\nCategoriasProductos AS C ON C.IdCategoriaPadre = B.IdCategoria LEFT OUTER JOIN\nCategoriasProductos AS D ON D.IdCategoriaPadre = C.IdCategoria\nWHERE (A.IdCategoria = 1)\n</code></pre>\n\n<p>Also a picture of how I constructed the query:\n<a href=\"http://imageshack.us/a/img841/7029/pruebau.jpg\" rel=\"nofollow\">http://imageshack.us/a/img841/7029/pruebau.jpg</a></p>\n\n<p>Now... in the query, it states that if A.IdCategoria = 1, (in this case) it should display all products that their IdCategoria either equals to 1 or equals another value that is somehow linked to IdCategoria 1 (in the Categorias Table).</p>\n\n<p>Another example could be if I instead type WHERE B.IdCategoria = 2...\nThen it should only show products which have an IdCategoria of 2, 4, 5, 6, 7, 10 or 11.</p>\n\n<p>I tried with this query and it did not work. Maybe I'm not using joins in the correct way...</p>\n\n<p>I was wondering if someone could please tell me what I'm doing wrong here, or what I have to add to the query to make it work...</p>\n\n<p>I hope you can help me\nThanks in advance</p>\n"},{"tags":["mysql","sql","performance","query"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12858224,"title":"Why doesn't this query run?","body":"<p>I have this query that isn't finishing (I think the server runs out of memory)</p>\n\n<pre><code>SELECT fOpen.*, fClose.*\nFROM (\n    SELECT of.*\n    FROM fixtures of\n        JOIN (\n            SELECT MIN(id) id\n            FROM fixtures\n            GROUP BY matchId, period, type\n        ) ofi ON ofi.id = of.id\n) fOpen\nJOIN (\n    SELECT cf.*\n    FROM fixtures cf\n        JOIN (\n            SELECT MAX(id) id\n            FROM fixtures\n            GROUP BY matchId, period, type\n        ) cfi ON cfi.id = cf.id\n) fClose ON fClose.matchId = fOpen.matchId AND fClose.period = fOpen.period AND fClose.type = fOpen.type\n</code></pre>\n\n<p>This is the EXPLAIN of it:</p>\n\n<p><img src=\"http://i.stack.imgur.com/EP83o.png\" alt=\"\"></p>\n\n<p>Those 2 subqueries 'of' and 'cf' take about 1.5s to run, if I run them separately.</p>\n\n<p>'id' is a PRIMARY INDEX and there is a BTREE INDEX named 'matchPeriodType' that has those 3 columns in that order.</p>\n\n<p>More info: MySQL 5.5, 512MB of server memory, and the table has about 400k records.</p>\n"},{"tags":["mysql","sql","query","foreign-keys"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12857856,"title":"mysql foregin key error 150","body":"<p>i am trying to create an order management system \nbut after creating base tables ie (<code>Suppliers,Customers,Categories,Employees,Shippers</code>)\ni go to next level with creating product and orders, i am able to add foregin keys in those table.\nnow i added last level table <code>oderDetail</code> and trying to add foregin key to OrderID and ProdcuID but it just gives me error 150\nmysqldump</p>\n\n<pre><code>-- MySQL Administrator dump 1.4\n--\n-- ------------------------------------------------------\n-- Server version   5.5.8\n\n\n/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;\n/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;\n/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;\n/*!40101 SET NAMES utf8 */;\n\n/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;\n/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;\n/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;\n\n\n--\n-- Create schema testdrive\n--\n\nCREATE DATABASE IF NOT EXISTS testdrive;\nUSE testdrive;\n\n--\n-- Definition of table `categories`\n--\n\nDROP TABLE IF EXISTS `categories`;\nCREATE TABLE `categories` (\n  `CategoryID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `Description` varchar(45) NOT NULL,\n  `Picture` blob,\n  PRIMARY KEY (`CategoryID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `categories`\n--\n\n/*!40000 ALTER TABLE `categories` DISABLE KEYS */;\n/*!40000 ALTER TABLE `categories` ENABLE KEYS */;\n\n\n--\n-- Definition of table `customers`\n--\n\nDROP TABLE IF EXISTS `customers`;\nCREATE TABLE `customers` (\n  `CustomerID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CompanyName` varchar(255) NOT NULL,\n  `ContactName` varchar(255) NOT NULL,\n  `ContactTitle` varchar(255) NOT NULL,\n  `Address` text NOT NULL,\n  `City` varchar(255) NOT NULL,\n  `Region` varchar(255) NOT NULL,\n  `PostalCode` varchar(45) NOT NULL,\n  `Country` varchar(255) NOT NULL,\n  `Phone` varchar(255) NOT NULL,\n  `Fax` varchar(255) NOT NULL,\n  PRIMARY KEY (`CustomerID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `customers`\n--\n\n/*!40000 ALTER TABLE `customers` DISABLE KEYS */;\n/*!40000 ALTER TABLE `customers` ENABLE KEYS */;\n\n\n--\n-- Definition of table `employees`\n--\n\nDROP TABLE IF EXISTS `employees`;\nCREATE TABLE `employees` (\n  `EmployeeID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `LastName` varchar(255) NOT NULL,\n  `FirstName` varchar(255) NOT NULL,\n  `Title` varchar(255) NOT NULL,\n  `BirthDate` date NOT NULL,\n  `HireDate` date NOT NULL,\n  `Address` text NOT NULL,\n  `City` varchar(255) NOT NULL,\n  `Region` varchar(255) NOT NULL,\n  `PostalCode` varchar(45) NOT NULL,\n  `Country` varchar(255) NOT NULL,\n  `HomePhone` varchar(255) NOT NULL,\n  `Extension` varchar(255) DEFAULT NULL,\n  `Photo` blob NOT NULL,\n  `Notes` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`EmployeeID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `employees`\n--\n\n/*!40000 ALTER TABLE `employees` DISABLE KEYS */;\n/*!40000 ALTER TABLE `employees` ENABLE KEYS */;\n\n\n--\n-- Definition of table `orderdetail`\n--\n\nDROP TABLE IF EXISTS `orderdetail`;\nCREATE TABLE `orderdetail` (\n  `OrderDetailID` int(10) NOT NULL,\n  `ProductID` int(10) NOT NULL,\n  `OrderID` int(10) NOT NULL,\n  `Quantity` varchar(255) NOT NULL,\n  `Discount` varchar(255) NOT NULL,\n  PRIMARY KEY (`OrderDetailID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `orderdetail`\n--\n\n/*!40000 ALTER TABLE `orderdetail` DISABLE KEYS */;\n/*!40000 ALTER TABLE `orderdetail` ENABLE KEYS */;\n\n\n--\n-- Definition of table `ordres`\n--\n\nDROP TABLE IF EXISTS `ordres`;\nCREATE TABLE `ordres` (\n  `OrderID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CustomerID` int(10) unsigned NOT NULL,\n  `EmployeeID` int(10) unsigned NOT NULL,\n  `OderDate` date NOT NULL,\n  `RequiredDate` date NOT NULL,\n  `ShippedDate` date NOT NULL,\n  `ShipperID` int(10) unsigned NOT NULL,\n  PRIMARY KEY (`OrderID`),\n  KEY `Order_Customer` (`CustomerID`),\n  KEY `Order_Employee` (`EmployeeID`),\n  KEY `Order_Shipper` (`ShipperID`),\n  CONSTRAINT `Order_Customer` FOREIGN KEY (`CustomerID`) REFERENCES `customers` (`CustomerID`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `Order_Employee` FOREIGN KEY (`EmployeeID`) REFERENCES `employees` (`EmployeeID`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `Order_Shipper` FOREIGN KEY (`ShipperID`) REFERENCES `shippers` (`ShipperID`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `ordres`\n--\n\n/*!40000 ALTER TABLE `ordres` DISABLE KEYS */;\n/*!40000 ALTER TABLE `ordres` ENABLE KEYS */;\n\n\n--\n-- Definition of table `products`\n--\n\nDROP TABLE IF EXISTS `products`;\nCREATE TABLE `products` (\n  `ProductID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `ProductName` varchar(255) NOT NULL,\n  `SupplierID` int(10) unsigned NOT NULL,\n  `CategoryID` int(10) unsigned NOT NULL,\n  `QuantityPerUnit` varchar(255) NOT NULL,\n  `UnitPrice` varchar(255) NOT NULL,\n  PRIMARY KEY (`ProductID`),\n  KEY `Product_Supplier` (`SupplierID`),\n  KEY `Product_Category` (`CategoryID`),\n  CONSTRAINT `Product_Supplier` FOREIGN KEY (`SupplierID`) REFERENCES `suppliers` (`SupplierID`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `Product_Category` FOREIGN KEY (`CategoryID`) REFERENCES `categories` (`CategoryID`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `products`\n--\n\n/*!40000 ALTER TABLE `products` DISABLE KEYS */;\n/*!40000 ALTER TABLE `products` ENABLE KEYS */;\n\n\n--\n-- Definition of table `shippers`\n--\n\nDROP TABLE IF EXISTS `shippers`;\nCREATE TABLE `shippers` (\n  `ShipperID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CompanyName` varchar(255) NOT NULL,\n  `Phone` varchar(255) NOT NULL,\n  PRIMARY KEY (`ShipperID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `shippers`\n--\n\n/*!40000 ALTER TABLE `shippers` DISABLE KEYS */;\n/*!40000 ALTER TABLE `shippers` ENABLE KEYS */;\n\n\n--\n-- Definition of table `suppliers`\n--\n\nDROP TABLE IF EXISTS `suppliers`;\nCREATE TABLE `suppliers` (\n  `SupplierID` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `CompanyName` varchar(255) NOT NULL,\n  `ContractTittle` varchar(255) NOT NULL,\n  `Address` text NOT NULL,\n  `City` varchar(255) NOT NULL,\n  `Region` varchar(255) NOT NULL,\n  `PostalCode` varchar(255) NOT NULL,\n  `Country` varchar(255) NOT NULL,\n  `Phone` varchar(255) NOT NULL,\n  `Fax` varchar(255) NOT NULL,\n  `HomePage` text NOT NULL,\n  PRIMARY KEY (`SupplierID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `suppliers`\n--\n\n/*!40000 ALTER TABLE `suppliers` DISABLE KEYS */;\n/*!40000 ALTER TABLE `suppliers` ENABLE KEYS */;\n</code></pre>\n\n<p>and here is what i am trying to do</p>\n\n<pre><code>  ALTER TABLE testdrive.orderdetail\n ADD CONSTRAINT orderDetail_Product FOREIGN KEY (ProductID) REFERENCES testdrive.products (ProductID) ON UPDATE CASCADE ON DELETE CASCADE,\n ADD CONSTRAINT OrderDetail_Order FOREIGN KEY (OrderID) REFERENCES testdrive.ordres (OrderID) ON UPDATE CASCADE ON DELETE CASCADE;\n</code></pre>\n"},{"tags":["database","query","doctrine2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12858157,"title":"Query for ManyToMany Join between two tables using DOctrine 2","body":"<p>I have got two entities which are joined by a join table.</p>\n\n<p>Employee Entity</p>\n\n<pre><code>class Employee \n{    \n\n    /**\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\");\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    protected $employeeId;\n\n    /**\n     * @ORM\\Column(type=\"string\")\n     */\n    protected $employeeName;\n\n    /**\n     * @ORM\\ManyToMany( targetEntity=\"Manager\", inversedBy=\"employees\" )\n     * @ORM\\JoinTable( name=\"employee_manager\" )\n     */\n    protected $manager;\n\n    //Add and remove employee methods follow\n\n}\n</code></pre>\n\n<p>Manager Entity</p>\n\n<pre><code>class Manager\n{    \n\n    /**\n     * @ORM\\Id\n     * @ORM\\Column(type=\"integer\");\n     * @ORM\\GeneratedValue(strategy=\"AUTO\")\n     */\n    protected $managerId;\n\n    /**\n     * @ORM\\Column(type=\"string\")\n     */\n    protected $managerName;\n\n    /**\n     * @ORM\\ManyToMany(targetEntity=\"Employee\", cascade={\"ALL\"})\n     * @ORM\\JoinTable(name=\"employee_manager\",\n     *        joinColumns={@ORM\\JoinColumn(name=\"managerId\", referencedColumnName=\"managerId\")},\n     *        inverseJoinColumns={@ORM\\JoinColumn(name=\"employeeId\", referencedColumnName=\"employeeId\")}\n     * )\n     */\n    protected $manager;\n\n}\n</code></pre>\n\n<p>DataBase Structure:</p>\n\n<pre><code>employee Table-\n-- employeeId (PK, AI)\n-- employeeName\n\nmanager Table-\n-- managerId (PK, AI)\n-- managerName\n\nemployee_manager Table-\n--managerId (PK, FK references manager.managerId)\n--employeeId (PK, FK references employee.employeeId)\n</code></pre>\n\n<p>So basically that are my entities with mappings and database structure. I can assign multiple employees to a manager and update the join table as well. Until that it was no problem.</p>\n\n<p>What I am trying to get is that, I want to retrieve the names of the employees assigned to particular manager WHERE managerId equals to.</p>\n\n<p>Is there a way how I can query this using Doctrine 2.2 or above. In other words I want to get the names of the employees assigned to a particular manager using the managerId as WHERE condition.</p>\n\n<p>Any advice would be appreciated.</p>\n"},{"tags":["java","android","query","sqlite","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12857173,"title":"Sqlite query using dates as text in android?","body":"<p>I have an app tha has in a sqlite database some measures.</p>\n\n<p>From an activity(Email Activity) the user selects which data will be sent to doctor's email(the data of last 1/7/30 days).</p>\n\n<p><img src=\"http://i.stack.imgur.com/7imZD.png\" alt=\"enter image description here\"></p>\n\n<p>This is the code of this activity:</p>\n\n<pre><code>import com.oikonomopo.blood.pressure.tracker.dao.BpDAO;\n\n...\n\npublic class EmailActivity extends Activity implements OnItemSelectedListener {\n\n    Spinner spinner;\n    String[] measures = { \"today\", \"7 days\", \"30 days\" };\n\n    private Calendar theStart;\n    private Calendar theEnd;\n    SimpleDateFormat dateFormat;\n    String start;\n    String end;\n\n    //this refers to another class for the manipulate of my table\n    private BpDAO dao = null;\n\n    private Button sendEmailBtn;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.email);\n\n        // ////////////////////////////////////\n        theEnd = Calendar.getInstance();\n        theStart = (Calendar) theEnd.clone();\n        dateFormat = new SimpleDateFormat(\"yyyy-MM-dd HH:mm\");\n        // //////////////////////////////////\n\n        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(\n                EmailActivity.this, android.R.layout.simple_spinner_item,\n                measures);\n\n        sendEmailBtn = (Button) findViewById(R.id.button1);\n        spinner = (Spinner) findViewById(R.id.spinner1);\n        spinner.setAdapter(adapter);\n        spinner.setOnItemSelectedListener(this);\n\n        // BpDao - refers to my table - see later\n        dao = new BpDAO(this);\n\n        // add a click listener to the button\n        sendEmailBtn.setOnClickListener(new View.OnClickListener() {\n            public void onClick(View v) {\n/////////////////////////////////////////////////////////////////////////////////////////\n                Log.d(\"BPT\", \"before\"); // it works untill here\n                Cursor bpLastDaysList = dao.lastXdays_bp(start, end);\n                Log.d(\"BPT\", \"after\"); //doesn't reach the code here!!\n/////////////////////////////////////////////////////////////////////////////////////////\n            }\n        });\n    }\n\n    @Override\n    protected void onDestroy() {\n        super.onDestroy();\n        dao.close();\n    }\n\n    public void onItemSelected(AdapterView&lt;?&gt; arg0, View arg1, int arg2,\n            long arg3) {\n        int position = spinner.getSelectedItemPosition();\n        switch (position) {\n\n                // last day\n        case 0:\n            theStart.add(Calendar.DAY_OF_MONTH, -1);\n\n            // date boundaries in TEXT format\n            start = dateFormat.format(theStart.getTime());\n            end = dateFormat.format(theEnd.getTime());\n            //\n            break;\n\n        // last 7 days\n        case 1:\n            theStart.add(Calendar.DAY_OF_MONTH, -7);\n\n            // date boundaries in TEXT format\n            start = dateFormat.format(theStart.getTime());\n            end = dateFormat.format(theEnd.getTime());\n            //\n            break;\n\n        // last 30 days\n        case 2:\n            theStart.add(Calendar.DAY_OF_MONTH, -30);\n\n            // date boundaries in TEXT format\n            start = dateFormat.format(theStart.getTime());\n            end = dateFormat.format(theEnd.getTime());\n            //\n            break;\n        }\n    }\n\n}\n</code></pre>\n\n<p>But it gives me this <strong>logcat error</strong>:</p>\n\n<pre><code>    FATAL EXCEPTION: main\nandroid.database.sqlite.SQLiteException: near \"09\": syntax error: , while compiling: SELECT DISTINCT systolic, diastolic, datetime, _id, notes, pulses FROM bp_import WHERE datetime BETWEEN 2012-10-12 09:44 AND 2012-10-12 09:44 ORDER BY datetime DESC\nat android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)\n...\nat android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1405)\nat com.oikonomopo.blood.pressure.tracker.dao.BpDAO.lastXdays_bp(BpDAO.java:76)\nat com.oikonomopo.blood.pressure.tracker.EmailActivity$1.onClick(EmailActivity.java:70)\n</code></pre>\n\n<p><strong>android.database.sqlite.SQLiteException: near \"09\": syntax error: , while compiling: SELECT DISTINCT systolic, diastolic, datetime, _id, notes, pulses FROM bp_import WHERE datetime BETWEEN 2012-10-12 09:44 AND 2012-10-12 09:44 ORDER BY datetime DESC</strong></p>\n\n<hr>\n\n<p>The code for the function of the BpDAO class is :</p>\n\n<pre><code>    public class BpDAO {\n        private DatabaseHelper_bp dbHelper;\n        private SQLiteDatabase database;\n        /**\n         * Movie table related constants.\n         */\n        public final static String bp_TABLE = \"bp_import\";\n        public final static String bp_ID = \"_id\";\n        public final static String bp_DT = \"datetime\";\n        public final static String bp_SYS = \"systolic\";\n        public final static String bp_DIA = \"diastolic\";\n        public final static String bp_PUL = \"pulses\";\n        public final static String bp_NOT = \"notes\";\n\n        public BpDAO(Context context) {\n            dbHelper = new DatabaseHelper_bp(context);\n            database = dbHelper.getWritableDatabase();\n        }\n\n        /**\n         * \\ Creates a new blood pressure measure\n         * \n         * @param datetime\n         * @param systolic\n         * @param diastolic\n         * @param pulses\n         * @param notes\n         * @return\n         */\n        public long importBP(String datetime, String systolic, String diastolic,\n                String pulses, String notes) {\n            ContentValues values = new ContentValues();\n            values.put(bp_DT, datetime);\n            values.put(bp_SYS, systolic);\n            values.put(bp_DIA, diastolic);\n            values.put(bp_PUL, pulses);\n            values.put(bp_NOT, notes);\n            return database.insert(bp_TABLE, null, values);\n        }\n\n    // this is working perfect\n        /**\n         * Fetch all bps sorted DESCending\n         * @return\n         */\n        public Cursor fetchAll_bp() {\n            Cursor mCursor = database.query(true, bp_TABLE, new String[] { bp_SYS,\n                    bp_DIA, bp_DT, bp_ID, bp_NOT, bp_PUL }, null, null, null, null,\n                    bp_DT + \" DESC\", null);\n            if (mCursor != null) {\n                mCursor.moveToFirst();\n            }\n            return mCursor;\n        }\n    // here is the problem!\n        /**\n         * Fetch all bps sorted DESCending by date(yyyy-mm-dd hh:mm) of last\n         * X[1-7-30] days\n         * @return\n         */\n        public Cursor lastXdays_bp(String start, String end) {\n            Cursor mCursor = database.query(true, bp_TABLE, new String[] { bp_SYS,\n                    bp_DIA, bp_DT, bp_ID, bp_NOT, bp_PUL }, \"datetime BETWEEN \"\n                    + start + \" AND \" + end, null, null, null, bp_DT + \" DESC\",\n                    null);\n            if (mCursor != null) {\n                mCursor.moveToFirst();\n            }\n            return mCursor;\n        }\n//\n        public void close() {\n            database.close();\n        }\n    }\n</code></pre>\n\n<p>And the code of the DatabaseHelper_bp(extends SQLiteOpenHelper) is :</p>\n\n<pre><code>    public class DatabaseHelper_bp extends SQLiteOpenHelper {\n\n    private static final String DATABASE_NAME = \"bpDB\";\n    private static final int DATABASE_VERSION = 1;\n\n    // Database creation sql statement\n    private static final String DATABASE_CREATE = \"create table bp_import ( _id integer primary key, datetime text not null, systolic text not null, diastolic text not null, pulses text not null, notes text not null);\";\n\n    public DatabaseHelper_bp(Context context) {\n        super(context, DATABASE_NAME, null, DATABASE_VERSION);\n    }\n\n    // Method is called during creation of the database\n    @Override\n    public void onCreate(SQLiteDatabase database) {\n        database.execSQL(DATABASE_CREATE);\n    }\n\n    // Method is called during an upgrade of the database,\n    @Override\n    public void onUpgrade(SQLiteDatabase database, int oldVersion,\n            int newVersion) {\n        Log.w(DatabaseHelper_bp.class.getName(),\n                \"Upgrading database from version \" + oldVersion + \" to \"\n                        + newVersion + \", which will destroy all old data\");\n        database.execSQL(\"DROP TABLE IF EXISTS bp_import\");\n        onCreate(database);\n    }\n}\n</code></pre>\n\n<p>I save the datetime as text in sqlite. (2012-10-12 09:43)</p>\n"},{"tags":["php","sql-server","arrays","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12856662,"title":"Selecting one value from an array called by a query in PHP","body":"<p>Basically I have a query called using PHP:</p>\n\n<pre><code>&lt;?php $result = mssql_query(\"SELECT * FROM Colours WHERE Type = 'type1' \");\n\n\nwhile ($row = mssql_fetch_array($result)) { \n\nif ($row['ColourID'] == \"1\") {\n\n    $sayclass1=\"imgactive\";\n\n    }else{\n\n    $sayclass1=\"imginactive\"; }\n\n\n            ?&gt;\n</code></pre>\n\n<p>As you can see once I execute the query I then loop it, the problem is that it returns an array, now in some instances I need to use the full array, but I would like to be able to select one entry from it for if statements and such. For example:</p>\n\n<pre><code>&lt;img id=\"h\" src=\"&lt;?php echo $row['thumbimg']; ?&gt;\n</code></pre>\n\n<p>now thumbimg is a column in my DB, and it just holds a url. However due to the fact its an array the picture doesn't display because its echoing all the values, so instead of <strong>images/image1.png</strong> for example it is echoing <strong>images/image1.png images/image2.png images/image3.png</strong> etc etc...</p>\n\n<p>I hope that makes sense, and can anyone tell me how to manipulate the query/code slight to still return all the entries but to select certain values from the arrays please?</p>\n"},{"tags":["php","sql","query","injection","parameterized"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12856566,"title":"Is using parameterized in just the login script enough?","body":"<p>More of a risk assessment question than technical.</p>\n\n<p>So i have been reading a lot about protecting against SQL Injection. Lets assume i have a large web application that is mostly unprotected and i need to make some improvements to protect against this problem.  Read large as lots of SQL interaction using dynamic queries but on few (less than 100 registered users).</p>\n\n<p>My question is... If i have already secured the main login script (the only publicly available user input) using parameterized queries, is it really that necessary to do the same work for the rest of the site?  I mean if a potential attacker can't log in, how much other damage can he do? </p>\n\n<p>Assuming of course none of my registered users have malicious intent.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12855661,"title":"Calculate count of rows in MySQL query","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4483798/count-and-distinct-can-i-use-together\">COUNT() and DISTINCT can i use together?</a>  </p>\n</blockquote>\n\n\n\n<p>I have this sql statement:</p>\n\n<pre><code>SELECT * FROM wp_posts\nINNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id)\nWHERE ( wp_term_relationships.term_taxonomy_id IN (4,3) )\nAND wp_posts.post_type = 'post' AND (wp_posts.post_status = 'published')\n</code></pre>\n\n<p>and I get two rows with the same ID => expected</p>\n\n<p>adding <code>GROUP BY wp_posts.ID</code> will reduce the count of rows to one</p>\n\n<p>Now I would like to get the number of rows with and SQL query</p>\n\n<pre><code>SELECT COUNT(*) AS cnt FROM wp_posts\nINNER JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id)\nWHERE ( wp_term_relationships.term_taxonomy_id IN (4,3) )\nAND wp_posts.post_type = 'post' AND (wp_posts.post_status = 'published')\nGROUP BY wp_posts.ID\n</code></pre>\n\n<p>I'll get as result \"2\" instead of \"1\", even with the \"GROUP BY\".</p>\n\n<p>What is the correct statement to get the numbers of rows from the first statement?</p>\n"},{"tags":["php","query","count","google-api","google-index"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12856051,"title":"Google API for finding no. of domains and subdomains indexed in google","body":"<p>Well I am trying to do this for a long time but unable to finalize and I am almost stuck on a point.</p>\n\n<p>For now I am able to count the no. of results for a specific domain name but what I need next is to also find the no. of indexed results for all subdomains of a specific domain.</p>\n\n<p>I have this function for counting the number of results</p>\n\n<pre><code>function getGoogleCount($domain) {\n    $content = file_get_contents('http://ajax.googleapis.com/ajax/services/' .\n        'search/web?v=1.0&amp;filter=0&amp;q=site:' . urlencode($domain));\n\n\n    $data = json_decode($content);\n\n\n    return ($data-&gt;responseData-&gt;cursor-&gt;resultCount);\n</code></pre>\n\n<p>My Questioning Ideas:</p>\n\n<p>1) I don't think but is there any query that I can use in google for finding list of all the subdomains and then I can loop all of the subdomains through this function for finding index result count of each sub domain?</p>\n\n<p>(Saying something like <code>site:*.domain.com/</code> really doesn't help)</p>\n\n<p>2) Google API provides us the urls of all the indexed results. I think if I get all the urls and then shortlist the urls to find out the unique (non repeating) sub domains. Once I found the list of subdomains I can loop them through the function I already have to find count of each.?</p>\n\n<p>No doubt that link to this (deprecated) API is <a href=\"http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=\" rel=\"nofollow\">http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=</a></p>\n"},{"tags":["android","query","sqlite","sqliteopenhelper","android-sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":11283290,"title":"querying my database using cursor","body":"<p>I have a database set up and I know I am inserting to it correctly.  I am, however, having difficulty returning any data from it through a query.  This is my main class and database helper class.</p>\n\n<pre><code>public class DBTesterActivity extends Activity {\n\nMyDBAdapter db;\nCursor cursor;\n\n/** Called when the activity is first created. */\n@Override\npublic void onCreate(Bundle savedInstanceState) {\n    Item item1;\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.main);\n\n\n    db = new MyDBAdapter(this);\n    db.open();\n    db.insertEntry(item1 = new Item(\"Bathtub\", \"Bathroom\", \"Typical\", \"Clean\", \"fill, wash\", \"Round, deep\", \"Bathroom\", \"Toilet, Bathroom\", R.drawable.ic_launcher));\n    //this.populateDatabase();\n    //Cursor entryCursor = db.getAllEntries();\n    item1 = db.getEntry(1);\n    Log.i(\"db\", item1.toString());\n}\n</code></pre>\n\n<p>and my database adapter class here...</p>\n\n<pre><code>public class MyDBAdapter {\nprivate static final String DATABASE_NAME = \"myDatabase.db\";\nprivate static final String DATABASE_TABLE = \"mainTable\";\nprivate static final int DATABASE_VERSION = 1;\n\n//main table columns\npublic static final String KEY_ITEM              = \"itemName\";\npublic static final String KEY_GROUP             = \"itemGroup\";\npublic static final String ITEM_CLASSIFICATION   = \"classification\";\npublic static final String KEY_USE               = \"use\";\npublic static final String KEY_ACTION            = \"action\";\npublic static final String KEY_PROPERTIES        = \"properties\";\npublic static final String KEY_ASSOCIATION       = \"association\";\npublic static final String KEY_IMG_ID            = \"imgId\";\n\n// The index (key) column name for use in where clauses.\npublic static final String KEY_ID=\"_id\";\n\n// The name and column index of each column in your database.\npublic static final int NAME_COLUMN = 1;\npublic static final int GROUP_COLUMN = 2;\npublic static final int CLASSIFICATION_COLUMN = 3;\npublic static final int USE_COLUMN = 4;\npublic static final int ACTION_COLUMN = 5;\npublic static final int PROPERTIES_COLUMN = 6;\npublic static final int ASSOCIATION_COLUMN = 7;\npublic static final int IMG_ID_COLUMN = 8;\n// TODO: Create public field for each column in your table.\n\n// SQL Statement to create a new database.\nprivate static final String DATABASE_CREATE = \"create table \" + \n        DATABASE_TABLE + \" (\" \n        + KEY_ID + \" integer primary key autoincrement, \" \n        + KEY_ITEM + \" TEXT, \" \n        + KEY_GROUP + \" TEXT, \" \n        + ITEM_CLASSIFICATION + \" TEXT, \" \n        + KEY_USE + \" TEXT, \" \n        + KEY_ACTION + \" TEXT, \" \n        + KEY_PROPERTIES + \" TEXT, \" \n        + KEY_ASSOCIATION + \" TEXT, \" \n        + KEY_IMG_ID + \" INTEGER);\";\n\n// Variable to hold the database instance\nprivate SQLiteDatabase db;\n// Context of the application using the database.\nprivate final Context context;\n// Database open/upgrade helper\nprivate myDbHelper dbHelper;\n\npublic MyDBAdapter(Context _context) {\n    context = _context;\n    dbHelper = new myDbHelper(context, DATABASE_NAME, null, DATABASE_VERSION);\n}\n\npublic MyDBAdapter open() throws SQLException {\n    try {  \n        db = dbHelper.getWritableDatabase();\n    } catch (SQLiteException e) {\n        db = dbHelper.getReadableDatabase();\n    }\n    return this;\n}\n\npublic void close() {\n    db.close();\n}\n\npublic void insertEntry(Item item) {\n    // TODO: Create a new ContentValues to represent my row\n    // and insert it into the database.\n    SQLiteDatabase db = dbHelper.getWritableDatabase();\n\n    ContentValues values = new ContentValues();\n    values.put(KEY_ITEM, item.get_item_name());\n    values.put(KEY_GROUP, item.get_group());\n    values.put(ITEM_CLASSIFICATION, item.get_item_classification());\n    values.put(KEY_USE, item.get_use());\n    values.put(KEY_ACTION, item.get_action());\n    values.put(KEY_PROPERTIES, item.get_properties());\n    values.put(KEY_ASSOCIATION, item.get_association());\n    values.put(KEY_IMG_ID, item.get_img_id());\n\n    // insert row to table\n    try{\n        db.insertOrThrow(DATABASE_TABLE, null, values);\n        Log.i(\"success\", \"insert was successful\");\n    }catch (Exception e){Log.w(\"insertFail\", \"insert failed: \" + e.toString());}\n\n\n}\n  public Item getEntry(long _rowIndex) {\n// TODO: Return a cursor to a row from the database and\n// use the values to populate an instance of MyObject\n  SQLiteDatabase db = dbHelper.getReadableDatabase();\n\n  Cursor cursor = db.query(false, DATABASE_TABLE, new String[] { KEY_ID,\n          KEY_ITEM, KEY_GROUP, ITEM_CLASSIFICATION, KEY_USE, KEY_ACTION, KEY_PROPERTIES, KEY_ASSOCIATION, KEY_IMG_ID}, KEY_ID + \"=?\",\n          new String[] { String.valueOf(_rowIndex) }, null, null, null, null);\n  if (cursor != null)\n      cursor.moveToFirst();\n\n  Item item = new Item(Integer.parseInt(cursor.getString(0)),\n          cursor.getString(1), cursor.getString(2), cursor.getString(3), cursor.getString(4), cursor.getString(5), cursor.getString(6), cursor.getString(7), cursor.getString(8),  Integer.parseInt(cursor.getString(9)));\n  // return contact\n  return item;\n</code></pre>\n\n<p>}</p>\n\n<p>I am getting these in my logCat ----  Bad request for field slot 0,9. numRows = 1, numColumns = 9<br>\nand                             ----  java.lang.IllegalStateException: get field slot from row 0 col 9 failed</p>\n"},{"tags":["mysql","sql","query","join","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12853516,"title":"Reforming table structure of columns possible?","body":"<p>I have bee at this all day. I have played around with a lot of MySQL code and I am either inept, or not very good at coding.. </p>\n\n<p><strong>I have a table</strong></p>\n\n<pre><code>name     id       type      amount\n=================================\napple    21       cars      67\napple    21       bikes     85\napple    21       skates    557\napple    21       pajs      56\norange   34       bikes     345\norange   34       disks     678\norange   34       cars      234\norange   34       pajs      5678\n</code></pre>\n\n<p><strong>I want to write a query that will bring back the table in this form</strong></p>\n\n<pre><code>name    id cars bikes skates pajas disks\n=========================================\napple   21 67   85    557    56    0    \norange  34 234  345   0      5678  678\n</code></pre>\n\n<p>I really just have no clue where to start. Sorry if this is noobie question but MySQL is really hard to conceptualize sometimes.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12853529,"title":"MySQL Query: Consider A Value As Another Value","body":"<p>I need to do a query to count instances of different values and group them.</p>\n\n<pre><code>SELECT COUNT(*), Type FROM Table GROUP BY Type\n</code></pre>\n\n<p>The values for Type can be C, V, and I - but I want it to consider any values that are I to be V.</p>\n\n<p>So: <br>\n    C = C<br>\n    V = V<br>\n    I = V<br></p>\n\n<p>How can I do this in a query?</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12852692,"title":"Mysql squery to get the value not mapped","body":"<p>I got the table structure as follows</p>\n\n<pre>\n--------------------------------\nid   processId   newId     value\n--------------------------------\n1        1        1         a\n2        1        2         b\n3        1        4         c\n4        2        5         d\n--------------------------------\n</pre>\n\n<p>and </p>\n\n<pre>\n------------------------\nid   processId  mapnewId\n------------------------\n1        1        1\n2        1        2\n------------------------\n\n</pre>\n\n<p>How should i get the value \"<b>c</b>\" (that means i should get the value which is not mapped to \"<b>1</b>\" in the second table) from the table in which the id mapped.</p>\n"},{"tags":["query","sparql","ontology"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12816284,"title":"SPARQL: Query to get all Instances of two classes that share the same connections to a third class","body":"<p>Im trying to understand the capabilities of SPARQL an im wondering if this kind of query is possible:</p>\n\n<p><a href=\"http://www.pictureupload.de/originals/pictures/101012113644_ProblemDiagram.jpeg\" rel=\"nofollow\">Diagram of my Ontology structure</a> (sorry, Im not allowed to post pictures yet)</p>\n\n<p>I want to get all instances of class A and B that have connections to the same Instances of class B. So some kind of:</p>\n\n<pre><code>Select ?a, ?c\nWhere\n{\n ?a myOntology:ab ?c .\n ?c myOntology:cb ?B .\n}\n</code></pre>\n\n<p>Which would give me:</p>\n\n<pre><code>A:1 C:1\nA:2 C:1 (with B:2)\nA:2 C:1 (with B:3)\n</code></pre>\n\n<p>(Where the letter is the class and the number the instance, counted from the top)</p>\n\n<p>But with the difference that I only want the ones that have exactly the same related instances of B:</p>\n\n<pre><code>A:2 C:1 (with B:2 and B:3)\n</code></pre>\n\n<p>Is that possible or do I have to use external logic to get that?</p>\n\n<p>I would be pleased for any answers...</p>\n"},{"tags":["sql","oracle","query","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12849976,"title":"Oracle SQL Left Join with sum and fields other than \"join on\" fields","body":"<p>I have two tables.</p>\n\n<p>First table is \"a\" with fields a.pr, a.info and a.id.  Second table is \"b\" with fields b.id and b.amount.</p>\n\n<p>a.id = b.id, though multiple b.id's may match with a single a.id.</p>\n\n<p>My SQL statement is as follows:</p>\n\n<pre><code>SELECT a.pr, a.info, a.id, SUM(b.amount) AS total\nFROM   a \nLEFT JOIN b ON a.id=b.id\nWHERE  a.pr = \"549\"\nGROUP BY a.id\n</code></pre>\n\n<p>Now, this doesn't work.  It throws a \"not a GROUP BY expression\" error.  As I understand it, I need a subquery, but none of the examples I found seemed to exactly match what I am trying to accomplish here, and I couldn't get any of them to work right.</p>\n\n<p>What would the full SQL statement (with subquery) look like in this case?</p>\n"},{"tags":["vb.net","query","ms-access","odbc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":193,"score":1,"question_id":12851692,"title":"Get result of MS Access query into textbox in VB.NET","body":"<p>I have a table in MS Access which has a colum named NameC (using ODBC to connect to MS Access)</p>\n\n<p>I want the result of the following query to be saved in a txtField</p>\n\n<pre><code>Dim query = \"SELECT NameC FROM Table WHERE ClientID = \" &amp; Integer.Parse(clientID) \n</code></pre>\n\n<p>How to do that in VB.NET?</p>\n\n<p>I have a <code>txtNameC.Text</code> field</p>\n\n<p>I currently was reviewing some sample code and they do:</p>\n\n<pre><code>  Dim _consultationTable As DataTable\n  Public Sub Load()\n    Dim query = \"SELECT * FROM Table WHERE ClientID = \" &amp; Integer.Parse(clientID)\n    Me._consultationTable = DatabaseFunctions.GetDataTable(query)\n    dvgInfo.Rows.Clear()\n    For Each  dtRow In Me._consultationTable.Rows\n        dvgInfo.Rows.Add()\n        dvgInfo.Rows.Add(dvgInfo.RowCount-1).Cells(\"ColClientID\").Value = dtRow(\"ClientId\").ToString()\n   Next\n</code></pre>\n\n<p>but I do not want to fill a table I just want to get the result of a query into a text box\nHow can I do this?</p>\n\n<p>I want to do something like this but just return a value and save it into a textbox</p>\n\n<pre><code>Protected Sub BindData()  \n   strSQL = \"SELECT * FROM customer\"  \n\n   Dim dtReader As OdbcDataReader  \n   objCmd = New OdbcCommand(strSQL, objConn)  \n   dtReader = objCmd.ExecuteReader()  \n\n   '*** BindData to GridView ***'  \n   myGridView.DataSource = dtReader  \n   myGridView.DataBind()  \n\n   dtReader.Close()  \n   dtReader = Nothing  \nEnd Sub  \n\n\nProtected Sub BindData()  \n   strSQL = \"SELECT SpecificValue FROM customer where x = y...\"  \n\n   Dim dtReader As OdbcDataReader  \n   objCmd = New OdbcCommand(strSQL, objConn)  \n   dtReader = objCmd.ExecuteReader()  \n\n   '*** BindData to GridView ***'  \n   myGridView.DataSource = dtReader  \n   myGridView.DataBind()  \n\n   dtReader.Close()  \n   dtReader = Nothing  \nEnd Sub  \n</code></pre>\n"},{"tags":["sql","mysql","query","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1443,"score":3,"question_id":4561650,"title":"mysql GROUP_CONCAT duplicates","body":"<p>I make my join from a farmTOanimal table like this.  There is a similar farmTotool table</p>\n\n<pre><code>id | FarmID  | animal\n 1 |    1    | cat\n 2 |    1    | dog\n</code></pre>\n\n<p>When I join my tables in a view, I get a result that looks like this</p>\n\n<pre><code>FarmID | animal | tool\n   1   |  cat   | shovel\n   1   |  dog   | shovel\n   1   |  cat   | bucket\n   1   |  dog   | bucket\n</code></pre>\n\n<p>Now, I do GROUP BY FarmID, and GROUP_CONCAT(animal) and GROUP_CONCAT(tool), i get</p>\n\n<pre><code>FarmID |     animals     |         tools\n  1    | cat,dog,cat,dog | shovel,shovel,bucket,bucket\n</code></pre>\n\n<p>But, what I really want is a result that looks like this.  How can I do it?</p>\n\n<pre><code>FarmID | animals |    tools\n  1    | cat,dog | shovel,bucket\n</code></pre>\n"},{"tags":["database","oracle","query","plsql","oraclereports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12851617,"title":"oracle pl/sql how to call back this alias created for a parameter?","body":"<p>i have a query im doing to display records to oracle reports. the parameter i need as selection is the <code>class_code</code> but when user click on the dropdown value it's a bit messy for them(hard to explain here) so they ask to combine the <code>study_intake</code> and <code>class_code</code> as a word which would be clear to them.</p>\n\n<p>now what i did is use AS for alias of a new column which combines the two, but i cant call it back (since it's not the right syntax)</p>\n\n<p>here's a sample of my query:</p>\n\n<pre><code>SELECT DISTINCT STUDENT_ATTENDENTS.IC_PASSPORT, \nSTUDENT_ATTENDENTS.NAME,\n STUDENT_ATTENDENTS.A_DATE, \nSTUDENT_ATTENDENTS.A_TYPE, \nSTUDENT_ATTENDENTS.ATTEN, \nTUTORIAL_CLASSES_MASTER.LECTURER_NAME, \nSTUDENT_ATTENDENTS.COURSE_CODE, \nSTUDENT_ATTENDENTS.SUBJECT_CODE, \nSUBJECT_MASTER_TABLE.CREDIT_POINT,\nTUTORIAL_CLASSES_MASTER.STUDY_INTAKE || ' ' || STUDENT_ATTENDENTS.CLASS_CODE AS Study_Intake_Class_Code\n\n\nFROM STUDENT_ATTENDENTS, TUTORIAL_CLASSES_MASTER, SUBJECT_MASTER_TABLE\n\nWHERE Study_Intake_Class_Code = :CLASS_DODE\nAND STUDENT_ATTENDENTS.SUBJECT_CODE = SUBJECT_MASTER_TABLE.SUBJECT_CODE\nAND (STUDENT_ATTENDENTS.CLASS_CODE = TUTORIAL_CLASSES_MASTER.CLASS_CODE)\n</code></pre>\n\n<p>the line <code>WHERE Study_Intake_Class_Code = :CLASS_DODE</code> will return an error which is </p>\n\n<blockquote>\n  <p>ORA-00904: \"STUDY_INTAKE_CLASS_CODE\": invalid identifier </p>\n</blockquote>\n\n<p>i cant use back the alias. an idea i came up with is to create a <strong>view</strong> but this made the report haywire and affecting all the formulas(i didnt create the original report)</p>\n\n<p>how do i adjust this query to make it work? any ideas or other style of query?</p>\n"},{"tags":["query","select","oracle10g","intersection","ora-00932"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":222,"score":1,"question_id":5014952,"title":"Oracle Error: inconsistent datatypes","body":"<p>I am using the following query in my ORACLE(10g) DB. </p>\n\n<p><strong>SELECT * from student_table where student_no like '%STUDENT%' \nINTERSECT \nSELECT * from student_table where student_no in ('STUDENT1234','STUDENT5678')</strong></p>\n\n<p>I got error like:\n<strong>java.sql.SQLSyntaxErrorException: ORA-00932: inconsistent datatypes: expected - got CLOB</strong> </p>\n\n<p>Any Idea how to resolve this Error?</p>\n"},{"tags":["query","crystal-reports","report","feed"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":329,"score":0,"question_id":9920533,"title":"SAP Crystal reports for VS 2010. Change the query at run time","body":"<p>I am using SAP CR for VS 2010 in C sharp. i have five tables and i am linking them with the following query:</p>\n\n<p>query = \"SELECT Items.AccessionNo, Items.Name, Items.LocalName, Items.Usage, Items.Province, Items.District, Items.VillTown, Items.EthnicCommunity, Arts.Name, Items.PurchasedDonated, Items.PurchasedFrom, Items.YearOfCollection, Items.Material, Items.Height, Items.Width, Items.Length, Items.Circumference, Items.Diameter, Items.Color, Items.Age, Items.Weight, Items.PurchasedValue, Items.Rare, Items.LivingDyingTrad, Items.ManufacturingProcess, Items.PlaceOfManufacturing, Items.ConditionReport, Items.Recommandations, Items.DateOfAddition, Items.Placement, Donators.Name, Collectors.Name, Placement.Name FROM Items INNER JOIN Arts ON Items.ArtId=Arts.ArtId INNER JOIN Donators ON Items.DonatorId=Donators.id INNER JOIN Collectors ON Items.CollectorId=Collectors.id INNER JOIN Placement ON Items.PlacementId=Placement.id WHERE Items.id=\" + itemid;</p>\n\n<p>The problem is that the report still shows up multiple results using the already embedded query at the time of design.</p>\n\n<p>I am using the following code to pass the above query</p>\n\n<pre><code>           SqlCommand cmd = new SqlCommand(query, dbconn.conn);\n            if (dbconn.conn.State == ConnectionState.Closed)\n            {\n                dbconn.conn.Open();\n            }\n\n            SqlDataAdapter Datadpt = new SqlDataAdapter(cmd);\n\n            DataSet dtset = new DataSet(\"items\");\n            Datadpt.Fill(dtset);\n            //rep is the Report document object already defined\n            rep.Load(@\"..\\..\\Reports\\CRItem.rpt\");\n            rep.SetDataSource(dtset);\n            CRViewer.ReportSource = rep;\n            if (dbconn.conn.State == ConnectionState.Open)\n            {\n                dbconn.conn.Close();\n            }\n            this.CRViewer.RefreshReport();\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["php","mysql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12734020,"title":"php date and mysql timestamp comparison","body":"<p>How can I do a select from a db field that uses a timestamp when all I have from php is a date? </p>\n\n<pre><code>$date = 2012-10-03;\n</code></pre>\n\n<p>something like:</p>\n\n<pre><code>\"select value from table where completed_date = $date\" \n</code></pre>\n\n<p>only the value for completed_date is really something like \"2012-10-03 02:16:10\" what I really would like is all values that are the same day as $date and for the query to almost disregard the time aspect of the timestamp for this query. Is that possible? </p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","query","group-by","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12849720,"title":"GROUP CONCAT and GROUP BY issue","body":"<p>suppose an object can have multiple tids</p>\n\n<p>now suppose I do this query: </p>\n\n<pre><code>SELECT n.nid, t.tid, GROUP_CONCAT(t.tid) \nFROM node n JOIN term_node t ON t.nid = n.nid \nGROUP BY n.nid \nHAVING t.tid = 31;\n</code></pre>\n\n<p>In which I want to fetch entries in table node that has tid = 31...but then I also want a list of all the tids corresponding to that row (hence the GROUP_CONCAT) even if they are not 31</p>\n\n<p>Using WHERE t.tid = 31 will leave out the tids that are not 31 from the GROUP concat\nand using HAVING t.tid = 31 will leave out rows in which the tid column that appears in the GROUPed row is not 31</p>\n\n<p>Either way has the potential to make the GROUP_CONCAT list incomplete or the rows of nodes with at least one tid = 31 incomplete </p>\n\n<p>Is there a way to resolve this such that I am guaranteed to get ALL the nodes in which the node has at least one tid association equals to 31 AND that GROUP_CONCAT will list ALL The list of tids associated with that node?</p>\n"},{"tags":["sql","query","join","exists"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12849945,"title":"How to do WHERE ((SELECT COUNT(*) ...) = 0 OR EXISTS (SELECT * FROM ...))?","body":"<p>For example, I have a table <code>Person</code> having an ID for each entry and I have a table <code>PersonEvent</code> which records the <code>personID</code> of each person at an event.</p>\n\n<p>If <code>PersonEvent</code> contains no rows for the event, everyone in the <code>Person</code> table attended.  However if there are entries in the <code>PersonEvent</code> table, only those people attended the event.</p>\n\n\n\n<p>I want to do a query such as:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * \nFROM Person p \nWHERE ((SELECT COUNT(*)\n        FROM PersonEvent pe \n        WHERE pe.personID = p.ID \n        AND pe.eventID = '290') = 0 \n      OR EXISTS \n        (SELECT * \n         FROM PersonEvent pe \n         WHERE pe.personID = p.ID \n         AND pe.eventID = '290'))\n</code></pre>\n\n<p>How do I do this?</p>\n"},{"tags":["mysql","query","overhead-minimization"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12848758,"title":"MySQL Database Structure Decisions","body":"<p>I'm trying to decide between having 1 enormous table for all the possible data about a user, a lot of which won't apply to every user, and then having a separate table for the data that a user can have multiple instances of (for example, previous jobs) versus having the data about each user distributed between multiple tables. </p>\n\n<p>The first way is more streamlined but I feel like it would use a ton of unnecessary overhead, whereas the second way results is easier to work with but results in a lot of extra database queries.</p>\n"},{"tags":["query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12849035,"title":"\"Find Unmatched\" Query -- Using Queries instead of Tables","body":"<p>I'm using Access 2010.</p>\n\n<p>I have a database with multiple tables, each containing different components of teaching data.</p>\n\n<p>Ultimately, I'd like to find \"people who will be teaching a course in the upcoming semester and who have never taught before.\"</p>\n\n<p>Currently, I am doing this through a series of steps:</p>\n\n<ol>\n<li>Creating one table (through a query) that has a list of everyone who is teaching in the upcoming semester and what they are teaching (this data comes from multiple tables). <strong>(tbl_NewInstructors)</strong></li>\n<li>Creating another table (through a query) that has a list of everyone who has ever taught (but not including this upcoming semester). <strong>(tbl_NewInstructors2)</strong></li>\n<li><p>Running this select statement:</p>\n\n<pre><code>SELECT tbl_NewInstructors.Name, tbl_NewInstructors.Course \n\nFROM tbl_NewInstructors\n\nWHERE (((Exists (SELECT * from tbl_NewInstructors2 \n\nWHERE tbl_NewInstructors2.Name = tbl_NewInstructors.Name))=False));\n</code></pre></li>\n<li><p>Getting my list!</p></li>\n</ol>\n\n<p>The main issue is that I have to create two tables each time I want to run this, and I would RATHER just run a query of my two current select queries, than a query on tables that I create through those queries. Unfortunately, when I try to run a query on the queries, it doesn't work. </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12848733,"title":"SQL query using both LIKE and IN with wild cards","body":"<p>I have a database table where users can filter a single column using a large number of variables and currently my sql query strings look something like:</p>\n\n<pre><code>SELECT * \nFROM TABLE1\nWHERE COLUMN1 LIKE '%APPLE%'\nAND COLUMN1 LIKE '%ORANGE%'\nAND COLUMN1 LIKE '%GRAPE%'\nAND COLUMN1 LIKE '%LEMON%'\nAND COLUMN1 LIKE '%LIME%'\nAND COLUMN1 LIKE '%TOMATO%'\nAND COLUMN1 LIKE '%POTATO%'\n...\n</code></pre>\n\n<p>which becomes a pain to implement especially if I am using a parameterized query string in a table adapter to create fill and get methods that end up having 20 parameters.</p>\n\n<p>Is there any better way of doing this (like using the IN command so I only need one parameter)?</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":12847305,"title":"Building nested menus with one mysql table","body":"<p>Would be possible to build a nested menu with one mysql table? I have been making a table having the following structure but I'm having problem to build up the query </p>\n\n<pre><code>ID | Menu  | parent | position | active\n\n 1   test      0         1         1\n\n 2   test2     1         2         1\n</code></pre>\n\n<p>....</p>\n"},{"tags":["c#","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":82,"score":1,"question_id":12841168,"title":"Multiple linq joins but different operators","body":"<p>How would I express the following in LINQ?</p>\n\n<pre><code>select * from table_1 t1\njoin table_2 t2 on t1.col1 = t2.col1 and t1.col2 &lt;= t2.col2\n</code></pre>\n\n<p>Here's what I've tried, but I'm not getting the desired results. I'm trying to join\nthe 2 tables but since <code>table_1</code> quantity is not greater or equal than what's in <code>table_2</code> quantity for <code>WidgetA</code>\nI wouldn't expect there to be any records in the results (in xList ).</p>\n\n<pre><code>    List&lt;anObj&gt; table_1 = new List&lt;anObj&gt;();\n    table_1.Add(new anObj() { Product = \"WidgetA\", Quantity = 0 });\n    table_1.Add(new anObj() { Product = \"WidgetB\", Quantity = 3 });\n\n    List&lt;anObj&gt; table_2 = new List&lt;anObj&gt;();\n    table_2.Add(new anObj() { Product = \"WidgetA\", Quantity = 1 });\n    table_2.Add(new anObj() { Product = \"WidgetB\", Quantity = 1 });\n\n    var xList =\n    from t1 in table_1\n    join t2 in table_2\n        on t1.Product equals t2.Product\n    where t1.Quantity &gt;= t2.Quantity\n    select new\n    {\n        t1,\n        t2\n    };\n\n    if (xList.Any())\n        Console.WriteLine(\"Found\");\n    else\n        Console.WriteLine(\"None\"); //I'm looking for this result.           \n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12848192,"title":"Using COUNT() to find how many rows exist in another table","body":"<p>This is the query that's been getting me everything I wanted to know about photos in my database up until now:</p>\n\n<pre><code>SELECT\n      users.facebook_id,\n      users.first_name,\n      users.last_name,\n      photos.*,\n      bookmarks.photo_id AS bookmark\nFROM\n      photos\nJOIN users\n      ON photos.author = users.facebook_id\nLEFT JOIN bookmarks\n    ON photos.id = bookmarks.photo_id\n    AND bookmarks.facebook_id = 123456789\nWHERE photos.description &lt;&gt; ''\nORDER BY photos.id DESC\n</code></pre>\n\n<p>However now, I'd like to get one more piece of information. I'd like to know how many votes have been cast on a particular photo.</p>\n\n<p>Here is my votes table:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `votes` (\n  `photo_id` int(11) NOT NULL,\n  `facebook_id` bigint(20) NOT NULL COMMENT 'The user''s Facebook ID.',\n  `date` varchar(10) NOT NULL COMMENT 'Date formatted as YYYY-MM-DD.',\n  UNIQUE KEY `one_vote_per_day` (`photo_id`,`facebook_id`,`date`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n</code></pre>\n\n<p>And here is what I tried already:</p>\n\n<pre><code>SELECT\n      count(votes.photo_id) as vote_count,\n      users.facebook_id,\n      users.first_name,\n      users.last_name,\n      photos.*,\n      bookmarks.photo_id AS bookmark\nFROM\n      photos\nJOIN users\n      ON photos.author = users.facebook_id\nLEFT JOIN votes\n    ON votes.id = photos.photo_id\nLEFT JOIN bookmarks\n    ON photos.id = bookmarks.photo_id\n    AND bookmarks.facebook_id = 123456789\nWHERE photos.description &lt;&gt; ''\nORDER BY photos.id DESC\n</code></pre>\n\n<p>Obviously I'm doing something wrong, because when I tried this, I'd never get more than a single photo in the result.</p>\n\n<p>This method works fine for me when I only need information on a single photo, but this query needs to work for all photos at once...</p>\n"},{"tags":["query","api","date","music"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":10247227,"title":"Billboard Magazine API problems","body":"<p>I am trying to query the Billboard api to get the number one from a certain date. When I try and query their service I get no data sent back, even when I use thier examples.Does anyone have any ideas? Thanks</p>\n"},{"tags":["sql","query","cursor","sql-server-2000","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":12844109,"title":"Rows to Columns in SQL Server 2000","body":"<p>I have this..</p>\n\n<pre><code>IDProspecto | IDObservacionCustomer | Observacion\n---------------------------------------------------------    \n  2204078   | 275214                | 03/9 Hable con Claudia me informa que Roberto ya se termino le deje..\n  2204078   | 294567                | 19/09 SOLICITAN LLAME MAÑANA A ALEJANDRO   \n  2204078   | 295310                | 20/09 se envia mail a adrian \n  2204078   | 304102                | CIA SOLICITA NO INSTALE EQUIPO  \n</code></pre>\n\n<p>And I want to have this...</p>\n\n<pre><code>idprospecto | observacion1            | observacion2            | observacion3      | observacion4 | observacionN\n-----------------------------------------------------------------------------------------    \n  2204078   | 03/09 Hable con clau... | 19/09 solicitan llame... | 20/09 se envia... | CIA solicita..   | ...\n</code></pre>\n\n<p>I read a lot about this but I found it hard to implement, since I never used cursor and pivot is not available in SQL Server 2000, I hope someone here can help me, thanks.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":53,"score":-2,"question_id":12846021,"title":"SELECT and list children and parent - alternative","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12770436/select-and-list-children-and-parent\">SELECT and list children and parent</a>  </p>\n</blockquote>\n\n\n\n<p>I received this answer from xception:</p>\n\n<p><a href=\"http://stackoverflow.com/a/12770593/445820\">http://stackoverflow.com/a/12770593/445820</a></p>\n\n<p>Unfortunately, GROUP_CONCAT isn't the solution for me and the other question is too extended, therefore I am re-asking this question.</p>\n\n<p>I need an alternative to that query with subqueries. Since I'm not good enough with queries, this task is beyond my abilities too.</p>\n\n<p>Help please.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>// Prepare query\n$columns = \"c.rule_id, c.rule_title, GROUP_CONCAT(r.rule_description ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS rule_desc, \";\n$columns .= \"GROUP_CONCAT(r.parse_bbcode ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS bbcode, \";\n$columns .= \"GROUP_CONCAT(r.parse_links ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS links, \";\n$columns .= \"GROUP_CONCAT(r.parse_smilies ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS smilies\";\n\n$sql_array = array(\n    'SELECT'    =&gt; $columns,\n    'FROM'      =&gt; array(RULES_TABLE =&gt; 'c'),\n    'LEFT_JOIN' =&gt; array(\n        array(\n            'FROM'  =&gt; array(RULES_TABLE =&gt; 'r'),\n            'ON'    =&gt; 'r.parent_id = c.rule_id',\n        ),\n    ),\n    'WHERE'     =&gt; 'c.parent_id = 0 AND r.public = 1',\n    'GROUP_BY'  =&gt; 'c.rule_id',\n    'ORDER_BY'  =&gt; 'c.cat_position',\n);\n\n$sql = $db-&gt;sql_build_query('SELECT', $sql_array);\n$result = $db-&gt;sql_query($sql);\n\n$cat_count      = 1;\n$alpha_count    = 'abcdefghijklmnopqrstuvwxyz';\n\nwhile ($row = $db-&gt;sql_fetchrow($result))\n{\n    $template-&gt;assign_block_vars('rules', array(\n        'RULE_CATEGORY' =&gt; $row['rule_title'],\n        'ROW_COUNT'     =&gt; $cat_count,\n    ));\n\n    $rules_ary      = explode('~sep~', $row['rule_desc']);\n    $parse_bbcode   = explode('~sep~', $row['bbcode']);\n    $parse_links    = explode('~sep~', $row['links']);\n    $parse_smilies  = explode('~sep~', $row['smilies']);\n    $counter        = 0;\n\n    foreach ($rules_ary as $key =&gt; $rule)\n    {\n        $uid = $bitfield = $options = '';\n        generate_text_for_storage($rule, $uid, $bitfield, $options, $parse_bbcode[$key], $parse_links[$key], $parse_smilies[$key]);\n\n        $template-&gt;assign_block_vars('rules.rule', array(\n            'RULE_DESC'     =&gt; generate_text_for_display($rule, $uid, $bitfield, $options),\n            'ALPHA_COUNT'   =&gt; $alpha_count{$counter},\n        )); \n\n        $counter++;\n    }\n\n    $cat_count++;\n}\n$db-&gt;sql_freeresult($result);\n</code></pre>\n\n<p>Some of the functions might be unknown to you. FYI this is phpBB related code.</p>\n\n<p>Sorry for not adding the code in the first time.</p>\n"},{"tags":["sql","query","razor","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":12829291,"title":"how do i display the sum of a SQL query in HTML?","body":"<p>I tried to do this:</p>\n\n<pre><code>SELECT SUM(SUBTOTAL as TODAYSALES) FROM dbo.SALESORD_HDR where ORDERDATE &gt;=41187\n</code></pre>\n\n<p>But the browser throws an exception about the sum function saying 'SUM' is not a recognized built-in function name.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12846103,"title":"Generate values between range into temporary table","body":"<p>I am using MySQL database. I have one table with three columns -</p>\n\n<pre><code>CREATE TABLE Timing\n(\n    Id PRIMARY KEY,\n    Weekday INT NOT NULL,\n    StartTime TIME NOT NULL,\n    EndTime TIME NOT NULL,\n);\n</code></pre>\n\n<p>Another table -</p>\n\n<pre><code>CREATE TABLE Class\n(\n    Id INT PRIMARY KEY,\n    Title VARCHAR(100) NOT NULL,\n    Duration INT NOT NULL -- In Minutes\n);\n\nINSERT INTO Timing VALUES(1, 1, '10:00', '13:30');\nINSERT INTO Timing VALUES(1, 2, '11:00', '14:00');\n\nINSERT INTO Class VALUES(101, 'Class A', 60);\nINSERT INTO Class VALUES(102, 'Class B', 40);\n</code></pre>\n\n<p>These tables are not related with each other. I would like to create range of values between StartTime and EndTime (Timing table) incremented by Duration (<strong>Class</strong> table) into a temporary table, say, RangeTime. The Temporary Table <strong>RangeTime</strong> should look like -</p>\n\n<pre><code>Weekday        RTime\n    1        '10:00'\n    1        '11:00'\n    1        '12:00'\n    1        '13:00'\n    2        '11:00'\n    2        '11:40'\n    2        '12:20'\n    2        '13:00'\n    2        '13:40'\n</code></pre>\n\n<p>Though I need to fill times for a single Class at a time. So I'll pass Id of Class in store procedure. Could you please help me here?</p>\n\n<p>Ritesh</p>\n"},{"tags":["php","mysql","query","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12845464,"title":"Getting results quickly from multiple MySQL tables","body":"<p>I am working on the hotel booking site for a client using PHP, MySQL on which hotels will have their login and manage their room rates, special offers, minimum stay booking, last minute deals etc...\nI am done with that but facing issue with fetching rates fast from database as I have to fetch rates following tables and in following flow.\nWhen user selects dates, I search in table tbl_availability which stores date and no. of available rooms, then in special offer table I store offers available for selected dates to check if user is qualified for any special rate, then I check in minimum stay table to check if hotels has added any minimum stay limitation on dates selected by users and at last I check if the dates have any last minute deal available. I need to search this for all hotels and then show the result to user. This is working but taking very much time (almost 60-90 seconds to return the result) and on top of this if user selects 2 rooms then I need to check this for 2 rooms as offers and minimum stays are manage on room level.</p>\n\n<p>The one thing I think will help is, I will run cron and store everything in one table for next 1 year and update that table on each booking or every time hotel changes anything.</p>\n\n<p>Has anyone worked on similar scenario before and found a way to fetch the results very quickly from database?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":12844144,"title":"SQL query - how to construct multiple SUMs (based on different parameters) in one query","body":"<p>Please review my tables below... Is it possible to build a <strong>single</strong> query capable of<br/><br/> \n<strong>1)</strong> calculating the SUM of total_time for all vehicles that have class_id 1 (regardless of feature_id)<br/>(result would be 6:35) <br/>\n<strong>2)</strong> calculating the SUM of total_time for all vehicles that have class_id 1 AND have feature_id 2<br/>(result would be 5:35 based on vehicle_id 22 and 24)<br/></p>\n\n<p>I'm able to get the results in two seperate queries, but I was hoping to retrieve them in one single query.... something like:</p>\n\n<pre><code>SELECT \n    SUM((CASE WHEN (VEHICLE_TABLE.class_id = 1) then LOG_TABLE.total_time else 0 end)) **AS TOTAL_ALL**,\n    ...here goes statement for 2)... AS TOTAL_DIESEL...\nFROM LOG_TABLE, VEHICLE_TABLE .....\nWHERE VEHICLE_TABLE.vehicle_id = LOG_TABLE.vehicle_id ......\n</code></pre>\n\n<p><br/>\n<strong>TABLE 1: LOG_TABLE</strong> (vehicle_id is NOT unique)<br/>\nvehicle_id&nbsp;&nbsp;|&nbsp;&nbsp;total_time<br/>\n--------------|--------------<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:00<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0:30<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:00<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:20<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0:45<br/><br/>\n<strong>TABLE 2: VEHICLE_TABLE</strong> (vehicle_id is unique)<br/>\nvehicle_id&nbsp;&nbsp;|&nbsp;&nbsp;class_id<br/>\n--------------|--------------<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/><br/>\n<strong>TABLE 3: VEHICLE_FEATURES_TABLE</strong> (vehicle_id is NOT unique but feature_id is unique per vehicle_id)<br/>\nvehicle_id&nbsp;&nbsp;|&nbsp;&nbsp;feature_id<br/>\n--------------|--------------<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6<br/></p>\n"},{"tags":["c#","sql","query","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12828874,"title":"Struggling to combine two NHibernate queries in which I intersect the results","body":"<p>I've crafted two queries which both work fine, but I am really struggling to understand how to combine them. I think my biggest issue is the fact that I've used two different syntax for the queries, but I wasn't sure how to express my first query without using the \"SQL-esque\" mark-up.</p>\n\n<pre><code>List&lt;Task&gt; tasksFromQueue = NHibernateSession.CreateQuery(\n    \"Select t from Task t, QueueLocation q where q.Queue.ID = :queueID and (t.SiteID = q.ComponentID or t.OriginalSiteID = q.ComponentID)\")\n    .SetParameter(\"queueID\", queueID).List&lt;Task&gt;().ToList();\n\nList&lt;Task&gt; tasksFromWorkflow = NHibernateSession\n    .CreateCriteria(typeof(Task), \"Task\")\n    .CreateCriteria(\"Task.Order\", \"Order\")\n    .CreateAlias(\"Task.TaskDevice\", \"TaskDevice\").List&lt;Task&gt;();\n\nIEnumerable&lt;Task&gt; tasks = tasksFromWorkflow.Intersect(tasksFromQueue);\n</code></pre>\n\n<p>As you can see I have two issues:</p>\n\n<ul>\n<li>Using verbose syntax for the first query and the NHibernate mark-up for the second query.</li>\n<li>Hitting the DB twice and then intersecting the results.</li>\n</ul>\n\n<p>The tasksFromWorkflow query is actually a lot more complicated than seen above. If you'd like to see the whole query <a href=\"https://gist.github.com/0b29592051c85c5fb620\" rel=\"nofollow\">click here.</a> I wasn't sure if the extra code really changed anything about my problem -- so I decided to keep the immediately displayed snippet as short as possible while still explaining the problem.</p>\n\n<p>I read that NHibernate <a href=\"http://stackoverflow.com/questions/3803325/nhibernate-intersection\">doesn't support intersection</a>, so perhaps it isn't possible to achieve in one query without becoming extremely convoluted?</p>\n"},{"tags":["php","database","query","echo","fetch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12836098,"title":"Showing url/hyperlink database fetched data","body":"<p>I have a question about a well known problem: the messages of my users contain hyperlinks to other area's of my website. I fetch data from the database to show the last message a user has posted on his profile. This works, but I can't see the hyperlinks. I just see them as plain text. How can I make these things hyperlinks as they should be?</p>\n\n<p>I use this for example:</p>\n\n<pre><code>$lastpost = execute_scalar(\"SELECT message FROM messages where messages.user='$who' Order by date desc\");\n</code></pre>\n\n<p>@Prasath Albert here you go:</p>\n\n<pre><code>    $message = preg_replace(\"'\\look here: (.*)\\)'Ui\",\"(look here: &lt;a href=\\\"haha.php?&amp;q=\\\\1\\\"&gt;\\\\1&lt;/a&gt;)\",$message);\n</code></pre>\n"},{"tags":["ruby-on-rails-3","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12844330,"title":"Rails 3: Excluding Results by Default","body":"<p>On my site, moderators can flag spammy comments. When these comments are flagged, they get quarantined so they no longer appear in regular views, though they can still be seen in the administrative control panel. At the moment, I exclude them from regular views like so:</p>\n\n<pre><code>@comments = Comment.where(:flagged =&gt; false)\n</code></pre>\n\n<p>I do this in every controller that has comments in it, of which there are many. I get the feeling that there's a cleaner way to handle this in Rails. Perhaps somewhere in the comments model I can specify that when querying for comments, only retrieve those that aren't flagged. If so, how is that done? And even if that's not possible, is there some other way to dry this code?</p>\n"},{"tags":["python","query","gae-datastore","gql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12808083,"title":"GQL queries (GAE datastore Python): how to retrieve all entities with same tag and all entities containing a substring?","body":"<p>I have a bilingual dictionary database of 60000 pairs stored in GAE that's look like this:</p>\n\n<p>date, tag, value</p>\n\n<p>date, vis, screw</p>\n\n<p>date, vis, screws</p>\n\n<p>date, vis à bois, wood screw</p>\n\n<p>date, vis à bout pointu, cone point screw</p>\n\n<p>date, vis à braser, braze screw</p>\n\n<p>date, vis à métaux, machine screw</p>\n\n<p>.</p>\n\n<p>Today with the following python script:</p>\n\n<pre><code>def get_value(self, tag):\n  entry = db.GqlQuery(\"SELECT * FROM StoredData where tag = :1\", tag).get()\n  value = entry.value\n  value = unicode(value)\n  value = value.encode('ascii','xmlcharrefreplace')\n</code></pre>\n\n<p>if I ask for \"vis\" I only get \"screw\" in response.</p>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>I would like to get also \"screws\" as a second answer, that is to say retrieve all entities having the same tag.</p></li>\n<li><p>I would like to get also all entities containing the substring \"screw\" (with a minimum of 3 characters typed by user) :</p></li>\n</ol>\n\n<p>screw, screws, wood screw, cone point screw, braze screw, machine screw</p>\n\n<p>=> what GQL queries have I to make to show them in a table generated by this script ?</p>\n\n<pre><code>### Show the tags and values as a table.\n###def show_stored_data(self):\n###  self.response.out.write('''\n###    &lt;p&gt;&lt;table border=1&gt;\n###      &lt;tr&gt;\n###         &lt;th&gt;Key&lt;/th&gt;\n###         &lt;th&gt;Value&lt;/th&gt;\n###         &lt;th&gt;Created (GMT)&lt;/th&gt;\n###      &lt;/tr&gt;''')\n###  entries = db.GqlQuery(\"          ***GQL query n°1 or n°2***           \")\n###  for e in entries:\n###    entry_key_string = str(e.key())\n###    self.response.out.write('&lt;tr&gt;')\n###    self.response.out.write('&lt;td&gt;%s&lt;/td&gt;' % e.tag)\n###    self.response.out.write('&lt;td&gt;%s&lt;/td&gt;' % e.value)\n###    self.response.out.write('&lt;td&gt;&lt;font size=\"-1\"&gt;%s&lt;/font&gt;&lt;/td&gt;\\n' % e.date.ctime())\n###    self.response.out.write('''\n###      &lt;td&gt;&lt;form action=\"/deleteentry\" method=\"post\"\n###            enctype=application/x-www-form-urlencoded&gt;\n###     &lt;input type=\"hidden\" name=\"entry_key_string\" value=\"%s\"&gt;\n###     &lt;input type=\"hidden\" name=\"tag\" value=\"%s\"&gt;\n###            &lt;input type=\"hidden\" name=\"fmt\" value=\"html\"&gt;\n###     &lt;input type=\"submit\" style=\"background-color: red\" value=\"Delete\"&gt;&lt;/form&gt;&lt;/td&gt;\\n''' %\n###                            (entry_key_string, e.tag))\n###    self.response.out.write('&lt;/tr&gt;')\n###  self.response.out.write('&lt;/table&gt;')\n</code></pre>\n\n<p>Many thanks in advance for your help.</p>\n\n<p>Philippe</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12843362,"title":"copy all columns of a table in another table having different order of columns","body":"<p><strong>copy all columns of a table in another table having different order of columns</strong></p>\n\n<p>I have two tables named</p>\n\n<pre><code>1... product (pid, pname, pdesc, code, stock)\n2... product1(pid, pname, img1, img2, pdesc, code, stock)\n</code></pre>\n\n<p>actually there are two more (img1, img2) columns added as required, so new table created product</p>\n\n<p>have tried this out </p>\n\n<pre><code>[update product1\nset pdesc = (select pdesc from product )]\n</code></pre>\n\n<p>maybe it contains errorful code, (little lack of knowledge in sql)</p>\n\n<p>so just do me a favor, and rewrite it again... please</p>\n"},{"tags":["wordpress","query","while-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12840612,"title":"Wordpress: not stops or resets query","body":"<p>I am adding post thumbnail jquery slider to header part but it's resulting weird issue. It is somehow not ending while or stop query and so if I will go to single post or page it is keep displaying loop instead of page or post content.</p>\n\n<p>I have tried two different query but none of them stopping to this weird issue.</p>\n\n<p><strong>First Tried</strong></p>\n\n<pre><code>&lt;?php\n    query_posts( 'post_status=publish&amp;orderby=rand' );      \n    while (have_posts()) : the_post();              \n\n    $title_attr = array(\n        'title' =&gt; get_the_title(),\n        'alt' =&gt; get_the_title(),\n        'class' =&gt; get_the_title(),\n    );\n    echo '&lt;a href=\"#post-'.get_the_ID().'\" class=\"scroll theme\"&gt;';\n    the_post_thumbnail('thumbnail',$title_attr);\n    echo '&lt;/a&gt;';\n\nendwhile; ?&gt;\n</code></pre>\n\n<p><strong>Than Second Tried</strong></p>\n\n<pre><code>&lt;?php\n    $temp = $wp_query;\n    $wp_query = null;\n    $wp_query = new WP_Query();\n    $wp_query-&gt;query('post_status=publish&amp;orderby=rand');\n\n    // The Loop\n    if ( $wp_query-&gt;have_posts() ) : while ( $wp_query-&gt;have_posts() ) : $wp_query-&gt;the_post();\n\n    $title_attr = array(\n        'title' =&gt; get_the_title(),\n        'alt' =&gt; get_the_title(),\n        'class' =&gt; get_the_title(),\n    );\n    echo '&lt;a href=\"#post-'.get_the_ID().'\" class=\"scroll theme\"&gt;';\n    the_post_thumbnail('thumbnail',$title_attr);\n    echo '&lt;/a&gt;';\n\nendwhile; endif; wp_reset_query();?&gt;\n</code></pre>\n\n<p>None of these stopping to display loop ( all post like index page) in to single post or page. </p>\n"},{"tags":["mysql","query","integer","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2577,"score":5,"question_id":4061246,"title":"MySQL Cast NULL to integer 0","body":"<p>How can I cast something that returns NULL to 0?</p>\n\n<p>If this is my query: <code>select col from table;</code> would this be the right way to do it: <code>select cast(col as unsigned integer) from table;</code>?</p>\n\n<p>Thank you.</p>\n"},{"tags":["sql","query","postgresql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12829875,"title":"Query using ILIKE with IN","body":"<p>Is it possible to run a query using ILIKE with the IN function? For example:</p>\n\n<pre><code>SELECT store_names\nFROM stores\nWHERE states ILIKE IN (SELECT location\n                       FROM   locations\n                       WHERE  stateID = 1)\n</code></pre>\n\n<p>I want to run the results returned from the nested query through the ILIKE function. Is there a way to do this? </p>\n"},{"tags":["sql","query","sql-server-2008-r2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12839924,"title":"SQL Server: split a single row into 2 rows","body":"<p>I'm trying to import data from an excel spreadsheet into a SQL Server 2008 database and I need to massage the data a bit first.</p>\n\n<p>I've used the Data Import wizard to load it into a staging table in the database in the following format:</p>\n\n<pre><code>Id  ISOCode  Data\n1   US       Foo\n2   CA       Bar\n3   US or CA Blah\n</code></pre>\n\n<p>In cases where ISO is an OR-delimited string, eg <code>US or CA</code>, I need to split it into 2 rows, so in the final destination table it would look like this:</p>\n\n<pre><code>Id  ISOCode  Data\n1   US       Foo\n2   CA       Bar\n3   US       Blah\n3   CA       Blah\n</code></pre>\n\n<p>I do have a <code>SplitString</code> table-valued function available but I'm not sure how to work it into the equation.</p>\n"},{"tags":["sql","database","query"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":63,"score":4,"question_id":12835351,"title":"Find records using having clause","body":"<p>I would like to retrieve all records having the most recent modification time.\nFor example, taking this table:</p>\n\n<pre><code>|page_url|last_modified|\n---------\n|abc.com |2010-10-01 10:00:00|\n|xyz.com |2010-10-04 12:10:00|\n|xyz.com |2010-10-04 12:00:00|\n|xyz.com |2010-10-04 10:00:00|\n|abc.com |2010-10-01 08:00:00|\n</code></pre>\n\n<p>And output should contain following data:</p>\n\n<pre><code>|page_url|last_modified|\n---------\n|abc.com |2010-10-01 10:00:00|\n|xyz.com |2010-10-04 12:10:00|\n</code></pre>\n\n<p>I have tried using having clause like below but not working for me :(</p>\n\n<pre><code>SELECT page_url, last_modified \nFROM\nmy_table\nHAVING MAX(last_modified);\n</code></pre>\n\n<p>Edit 1 : I am having 25 fields in my table to use. But, I guess I can't apply group by for all. What to do now?</p>\n"},{"tags":["java","android","sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":12840472,"title":"Database query sometimes returns empty cursor","body":"<p>Database query sometimes returns empty cursor.\nMy android application is using database in order to store internal model structure. This structure is written only once and never modified.\nWhile navigating the application some objectlists are retrieved from database and displayed. But sometimes empty item list is retrieved. In case user navigates backward and reopens screen whole data will be displayed (so the second retrieving attempt is usually successfull). </p>\n\n<p>Facts:</p>\n\n<ul>\n<li>Dataset isn't modified while user is navigating the application;</li>\n<li>ObjectLists are empty because of empty cursor ( cursor.getCount() returns \"0\");</li>\n<li>Each request of same dataset may be failed (first, second,...);</li>\n<li>In case request fails - there is no sence in recall attempt (it will fail too), only delayed request will succeed. So, usually request recall triggered by UI action is successfull. But programmatic recall (without delay) will fail;</li>\n<li>All queries are valid;</li>\n</ul>\n"},{"tags":["sql","database","query","informix","rownumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1076,"score":1,"question_id":7420458,"title":"Row_number() function with Informix","body":"<p>Does informix has a function similar to the SQLServer and Oracle's <code>row_number()</code>?\nI have to make a query using <code>row_number()</code> <code>between</code> two values, but I don't know how.</p>\n\n<p>This is my query in SQLServer:</p>\n\n<pre><code>SELECT col1, col2 \nFROM (SELECT col1, col2, ROW_NUMBER() \nOVER (ORDER BY col1) AS ROWNUM FROM table) AS TB \nWHERE TB.ROWNUM BETWEEN value1 AND value2\n</code></pre>\n\n<p>Some help?</p>\n"},{"tags":["php","html","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12837378,"title":"It is displaying incorrect answers in a php/html table row","body":"<p>I have an \"Answer\" database table below:</p>\n\n<p>Answer Table</p>\n\n<pre><code>AnswerId SessionId QuestionId Answer\n13       AAA       1          A\n14       AAB2      2          A\n15       AAB2      2          B\n</code></pre>\n\n<p>Now as you can see there is 1 answer for question 1 in Exam (Session) AAA, and these is 2 answers for question 2 in Exam (Session) AAB2.</p>\n\n<p>Below is the \"Question\" Table:</p>\n\n<p>Question Table:</p>\n\n<pre><code>SessionId  QuestionId QuestionContent NoofAnswers ReplyId QuestionMarks OptionId\nAAA        1          What is 2+2?    1           1       5             2\nAAC        1          3+3 and 4+4 ?   2           2       10            6\n</code></pre>\n\n<p>Now I have a search function where the user enters in a term from a question and compiles the search. So for example if the user enters in \"+\", then below is what the results should display in the php/html table:</p>\n\n<pre><code>   QuestionContent Option Type  Number of Answers Answer Number of Replies  Number of Marks\n   What is 2+2?    A-D          1                 A      Single               5\n   3+3 and 4+4?    A-H          2                 AB     Multiple             5\n</code></pre>\n\n<p>But the problem is that it is displaying an extra answer, it is displaying this below:</p>\n\n<pre><code>   QuestionContent Option Type  Number of Answers Answer Number of Replies  Number of Marks\n   What is 2+2?    A-D          1                 A AB     Single               5\n   3+3 and 4+4?    A-H          2                 A AB     Multiple             5\n</code></pre>\n\n<p>Now my problem is that why is it displaying the wrong answers in both rows? The first row should only be \"A\" and second row should only be \"AB\".</p>\n\n<p>Below is the code (Which I have reduced so it is easier for you to read and hopefully see the problem) where it performs the query and outputs the results:</p>\n\n<pre><code>&lt;?php\n\n//connect to db\n\n\n    // Build the query\n    $questionquery = \"\nSELECT DISTINCT q.QuestionContent, o.OptionType, q.NoofAnswers, GROUP_CONCAT(DISTINCT Answer SEPARATOR '') AS Answer, r.ReplyType, \n       q.QuestionMarks, q.SessionId \n  FROM Answer an \n  INNER JOIN Question q ON q.QuestionId = an.QuestionId and an.SessionId = q.SessionId\n  JOIN Reply r ON q.ReplyId = r.ReplyId \n  JOIN Option_Table o ON q.OptionId = o.OptionId \n      WHERE \".implode(\" AND \", array_fill(0, $numTerms, \"q.QuestionContent LIKE ?\")).\"\n      GROUP BY an.SessionId, an.QuestionId\n      ORDER BY \".implode(\", \", array_fill(0, $numTerms, \"IF(q.QuestionContent LIKE ?, 1, 0) DESC\")).\"\n    \";\n\n    // Make the referenced array\n    $referencedArray = make_values_referenced(array_merge(\n      array(str_repeat(\"ss\", $numTerms)), // types\n      $termArray,                         // where\n      $termArray                          // order by\n    ));\n\n\n    // Bind parameters\n    if (!call_user_func_array(array($stmt, 'bind_param'), make_values_referenced($referencedArray))) {\n      die(\"Error binding parameters: $stmt-&gt;error\"); \n    }\n\n\n    // This will hold the search results\n    $searchResults = array();\n    $searchOption = array();\n    $searchNoofAnswers = array();\n    $searchAnswer = array();\n    $searchReply = array();\n    $searchMarks = array();\n\n    // Fetch the results into an array\n    if (!$stmt-&gt;num_rows()) {\n      $stmt-&gt;bind_result($dbQuestionContent,$dbOptionType,$dbNoofAnswers,$dbAnswer,$dbReplyType,$dbQuestionMarks, $dbSessionId); \n      while ($stmt-&gt;fetch()) {\n        $searchResults[] = $dbQuestionContent;\n        $searchOption[] = $dbOptionType;\n        $searchNoofAnswers[] = $dbNoofAnswers;\n        $searchAnswer[] = $dbAnswer;\n        $searchReply[] = $dbReplyType;\n        $searchMarks[] = $dbQuestionMarks;\n      }\n    }\n\n  }\n\n\n      $questionnum = sizeof($searchResults);\n\n    // If $searchResults is not empty we got results\n    if (!empty($searchResults)) {\n      echo \"&lt;p&gt;Your Search: '$inputValue'&lt;/p&gt;\";  \n      echo\"&lt;p&gt;Number of Questions Shown from the Search: &lt;strong&gt;$questionnum&lt;/strong&gt;&lt;/p&gt;\";\n      echo \"&lt;table border='1' id='resulttbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='optiontypeth'&gt;Option Type&lt;/th&gt;\n      &lt;th class='noofanswersth'&gt;Number of &lt;br/&gt; Answers&lt;/th&gt;\n      &lt;th class='answerth'&gt;Answer&lt;/th&gt;\n      &lt;th class='noofrepliesth'&gt;Number of &lt;br/&gt; Replies&lt;/th&gt;\n      &lt;th class='noofmarksth'&gt;Number of &lt;br/&gt; Marks&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n      $script = '';\n      foreach ($searchResults as $key=&gt;$question) {\n      $script .= 'var key_' . $key . '=\"' . str_replace('\"','\\\"', $question) . '\";' . PHP_EOL;\n        echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n        echo '&lt;td&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"optiontypetd\"&gt;'.htmlspecialchars($searchOption[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"noofanswerstd\"&gt;'.htmlspecialchars($searchNoofAnswers[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"answertd\"&gt;'.htmlspecialchars(implode(' ', $searchAnswer)).'&lt;/td&gt;' . PHP_EOL; \n        echo '&lt;td class=\"noofrepliestd\"&gt;'.htmlspecialchars($searchReply[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"noofmarkstd\"&gt;'.htmlspecialchars($searchMarks[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo \"&lt;td class='addtd'&gt;&lt;button type='button' class='add' onclick=\\\"parent.addwindow(key_$key,'$searchMarks[$key]','$searchNoofAnswers[$key]','$searchOption[$key]','$searchReply[$key]','$searchAnswer[$key]');\\\"&gt;Add&lt;/button&gt;&lt;/td&gt;&lt;/tr&gt;\";\n}\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n        echo '&lt;script type=\"text/javascript\"&gt;' . PHP_EOL;\n        echo $script;\n        echo '&lt;/script&gt;' . PHP_EOL;\n\n\n}\n?&gt;\n</code></pre>\n"},{"tags":["query","dynamic","sparql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12819683,"title":"dynamic sparql query with sgvizler","body":"<p>I am trying to create a dynamic sparql query within sgvizler.</p>\n\n<p>Current query is like this:</p>\n\n<pre><code>&lt;div id=\"query1\"\n                data-sgvizler-query=\"\n                    SELECT * \n                    WHERE {\n                    [] &lt;http://localhost:2020/resource/vocab/rankings_university&gt; ?Name ;\n                    &lt;http://localhost:2020/resource/vocab/rankings_id&gt; ?Id ;\n                    &lt;http://localhost:2020/resource/vocab/rankings_overall_score&gt; ?overall_score ;\n                    FILTER regex(?Name, '(here comes a variable')\n                    }\n                    LIMIT 10\"\n                data-sgvizler-chart=\"sText\"\n                data-sgvizler-loglevel=\"2\"\n            &gt;&lt;/div&gt;\n</code></pre>\n\n<p>with jquery I do the following:</p>\n\n<pre><code>$(function() {\n$(\"#searchsubmit\").click( function()\n{\nvalue1 = $(\"#uni1\").val(); \nalert(value1);\nsgvizler.go();\n}\n);\n});\n</code></pre>\n\n<p>All I get is a empty page without erros while the following does work:</p>\n\n<pre><code>$(document).ready(sgvizler.go());\n</code></pre>\n\n<p>Any idea how I can fix this? Thank you in Advance</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":62,"score":-3,"question_id":12837511,"title":"Why is one of the queries returning no rows?","body":"<p>I have 2 queries like this:</p>\n\n<p>Query #1:</p>\n\n<pre><code>SELECT * \nFROM dbo.Products \nWHERE CAST(ID AS VARCHAR) IN ('6', '8', '9', '10', '12', '14', '110', '106')\n</code></pre>\n\n<p>Query #2:</p>\n\n<pre><code>SELECT * \nFROM dbo.Products \nWHERE CAST(ID AS VARCHAR) IN (SELECT ('6'', ''8'', ''9'', ''10'', ''12'', ''14'', ''110'', ''106'))\n</code></pre>\n\n<p>Why does the second query return no rows? When 1st query is returning some rows.</p>\n"},{"tags":["mysql","query","select"],"answer_count":6,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":21623,"score":2,"question_id":544750,"title":"How to select multiple records (row) from a column in mysql?","body":"<p>I want to display four (4) items'name from these id:\nCan I do like this?</p>\n\n<p>SELECT item_name from items WHERE item_id IN ('001', '012', '103', '500')</p>\n\n<p>or</p>\n\n<p>SELECT item_name from items WHERE item_id = '001' or item_id = '012' or item_id = '103' or item_id = '500'</p>\n\n<p><strong>IN RESPONSE TO ALL ANSWERS</strong></p>\n\n<p>Well, most of the answers said it works, but it does not really work. Here is my code:</p>\n\n<p>$query = \"SELECT <code>item_name</code> from items WHERE item_id IN('s001','a012','t103','p500')\";</p>\n\n<p>$result = mysql_query($query, $conn) or die (mysql_error());\n$fetch =  mysql_fetch_assoc($result) or die (mysql_error());</p>\n\n<p>$itemsCollected = $fetch['item_name'];</p>\n\n<p>echo $itemsCollected;</p>\n\n<p>The item_id is alphanumeric</p>\n"},{"tags":["c#","mysql","query","load-data-infile"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12834675,"title":"LOAD DATA INFILE with variables","body":"<p>I was tring to use the LOAD DATA INFILE as a sotred procedure but it seems it cannot be done. Then i tried the usual way of embedding the code to the application itself like so,</p>\n\n<pre><code>conn = new MySqlConnection(connStr);\nconn.Open();\nMySqlCommand cmd = new MySqlCommand();\ncmd = conn.CreateCommand();\nstring tableName = getTableName(serverName);\nstring query = \"LOAD DATA INFILE '\" + fileName + \"'INTO TABLE \"+ tableName +\" FIELDS TERMINATED BY '\"+colSep+\"' ENCLOSED BY '\"+colEncap+\"' ESCAPED BY '\"+colEncap+\"'LINES TERMINATED BY '\"+colNewLine+\"' (\"+colUpFormat+\");\";\ncmd.CommandText = query;\ncmd.ExecuteNonQuery();\nconn.Close();\n</code></pre>\n\n<p>The generated query that gets saved in the string variable query is,</p>\n\n<pre><code>        LOAD DATA INFILE 'data_file.csv'INTO TABLE tbl_shadowserver_bot_geo FIELDS TERMINATED BY ',' ENCLOSED BY '\"' ESCAPED BY '\"'LINES TERMINATED BY '\\n' (timestamp,ip,port,asn,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy,url,agent,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy,@dummy);\n</code></pre>\n\n<p>But now when i run the program it gives an error saying,</p>\n\n<pre><code>        MySQLException(0x80004005) Parameter @dummy must be defined first.\n</code></pre>\n\n<p>I dont know how to get around this, but when i use the same query on mysql itself directly it works fine. PLEASE help me..thank you very much :)</p>\n"},{"tags":["query","date","datetime","vb6"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12828083,"title":"Date variable in vba using sql query","body":"<p>I have a query in VB6: </p>\n\n<pre><code>\"select plate_no from INFO where date_time between #07-10-2012 01:13:17# and #10/10/2012 11:30:25#\" \n</code></pre>\n\n<p>My Access database table has the column with datatype Data/Time in general format.</p>\n\n<p>How do I modify the query above to use variables like: </p>\n\n<pre><code>Public t1 As Date \nPublic t2 As Date \n</code></pre>\n"},{"tags":["sql","query","subquery","exists"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12835462,"title":"SQL query with NOT EXISTS to determine if another attribute has certain values","body":"<p>Struggling with a SQL query of mine here. \nI have a table: </p>\n\n<p>APPS(id, game)\nWhere id is the primary key. </p>\n\n<p>What I was trying to do is show all the id's who use at least all the games that the person with the id \"Tim\" does. \nI have a query that works, and returns what i need it to, but i cobbled it together from forums. \nSo what I'd really like is a quick and basic rundown of how the query works. Heavy detail isn't necessary, as i understand most of the terminology, but just what the query does, and how it determines the correct records. </p>\n\n<p>My query is:</p>\n\n<pre><code>SELECT id\nFROM APPS X\nWHERE NOT EXISTS\n     (SELECT *\n      FROM APPS Y\n      WHERE id='Tim' AND NOT EXISTS\n           (SELECT *\n            FROM APPS Z\n            WHERE Z.id = A.id AND Z.id = Y.id));\n</code></pre>\n\n<p>Thank you so much for any help!</p>\n\n<p>Edit: The query works fine, but what i was after is how it works and how it returns the records it does.</p>\n"},{"tags":["php","database","query","fetch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12835034,"title":"Adding who posted a topic in a database","body":"<p>I have a <code>table</code> <code>TOPICS</code> in my database, which does not state which user opened it. In my <code>MESSAGES</code> <code>table</code> however, there is a <code>USER column</code> which shows which user has opened it. My question is: how can I give my TOPICS table a column with users and get fetch this information?</p>\n\n<p>Now, I have the last message of a user in each profile, but as said, I can't <strong>show a link to the topic and the topicname</strong>, because there is no such column in TOPICS. How can I make this possible?</p>\n\n<p>I used this to fetch the last message of a user, which worked:</p>\n\n<pre><code>$lastpost = execute_scalar(\"SELECT message FROM messages where messages.user='$who' Order by date desc\");\n</code></pre>\n\n<p>Now I need the same for a topic.</p>\n"},{"tags":["query","batch-file","registry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12823049,"title":"Gettin to use the reg query in batch","body":"<p>I would like to know how I can use the reg query in batch to make if else decisions</p>\n\n<p>what I have sofar is:</p>\n\n<pre><code>    set ANSWR = ('reg query \"hklm\\system\\controlset001\\control\\nls\\language\" /v Installlanguage')\n\nif %ANSWR% == \"0415\" (goto DUTCH) else (goto OTHER)\n\n:DUTCH\nMSG * windows is in dutch\n\nEXIT\n\n:OTHER\n\nMSG * CANT FIND VERSION\n\nEXIT\npause\n</code></pre>\n"},{"tags":["query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12823742,"title":"Between two dates splitting data into different rows?","body":"<p>When I create a query in access and use <code>[forms]![frmmain]![txtfrom]</code> and <code>[forms]![frmmain]![txtto]</code> to choose to show data from a certain date if I choose two dates like 01/10/2012 to 08/10/2012 it splits the data out by date.</p>\n\n<p>Is there anyway to merge all the dates into one?</p>\n\n<p>Hi sorry here is what my query produces if it is between certain dates:</p>\n\n<p><a href=\"http://i.stack.imgur.com/vR7Zn.png\" rel=\"nofollow\">http://i.stack.imgur.com/vR7Zn.png</a></p>\n\n<p>I wanted to know if there was a way to merge all the dates into one when its the same person?</p>\n\n<p>Thanks very much!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12834388,"title":"My sql Error Subquery returns more than 1 row","body":"<pre><code>SELECT * ,\n  (SELECT ZoneName \n   FROM zone_message_master \n   WHERE ZoneID = zoneid) 'ZoneName' \nFROM zone_master \nWHERE ZoneID=zoneid;\n</code></pre>\n\n<p>This is a query running in stored procedure and I am getting Error </p>\n\n<blockquote>\n  <p>Subquery returns more than 1 row</p>\n</blockquote>\n\n<p>Can any one tell me what I have done wrong here?</p>\n"},{"tags":["linq","query","streaminsight"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12819642,"title":"StreamInsight complex query with filter on HoppingWindow","body":"<p>I'm trying out StreamInsight and I came across a problem with a query I need.</p>\n\n<p>I'm trying to throw a warning if there are several changes in my measured values (of up to 20% change) in the last 30 minutes.</p>\n\n<p>This is the query I came up with for now but it isn't working and it's not even correct I think.</p>\n\n<p>Apparently I can't filter on a window...?</p>\n\n<pre><code>var deviationQuery = from s in wcfStream\n                     group s by s.SensorId into grouped\n                     from window in grouped.HoppingWindow(TimeSpan.FromMinutes(30),TimeSpan.FromMinutes(1))\n                     where window.StdDev(e =&gt; e.Value) &gt; measurableValue * 1.2\n                     select new OutputEvent\n                     {\n                         Error = \"Deviation\"\n                     };\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["database","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12833905,"title":"Update a column after joining two tables with where clause","body":"<p>I have two tables</p>\n\n<p>threads table</p>\n\n<pre><code>_id   recipient_id    type\n 1     1\n 2     1\n 3     2\n</code></pre>\n\n<p>and addresses table  </p>\n\n<pre><code>_id    address\n1      HELLO\n2      BYE \n</code></pre>\n\n<p>recipient_id is mapped to addresses table's _id</p>\n\n<p>I need to update <code>type</code> to a specific value if address is HELLO. How do i do it? I have already tried</p>\n\n<pre><code>UPDATE   threads SET threads.type = 106 FROM threads  \n   INNER JOIN \n   addresses  ON addresses._id = threads.recipient_ids\n    AND\n   addresses.address LIKE '%HELLO%';\n</code></pre>\n\n<p>But i am getting an error <code>near \".\": syntax error</code> . \nWhat is the correct syntax to update a column?</p>\n"},{"tags":["sql","sql-server","performance","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":12832988,"title":"SQL Server query response time changes greatly with very little code change","body":"<p>I have a query that when modified ever so slightly will reduce its runtime from approx 37 seconds down to 4 seconds. There is no change to the joins, or the columns being returned.</p>\n\n<p><strong>SLOW query (37 seconds):</strong></p>\n\n<pre><code>declare @PeriodFrom DateTime\ndeclare @PeriodTo DateTime\nSet @PeriodFrom = '2012-06-01'\nSet @PeriodTo = '2012-06-30'\n\nSelect\n  0 as PrimaryAccount,\n  0 as PrintOrder,\n  Cast(Null as integer) as ID,\n  Sum(IsNull(MT.Amount, 0)) as Amount,\n  Cast(0 as Money) as NetAmount,\n  Cast(0 As Money) as TaxAmount,\n  Cast(0 as Money) as AmountOutstanding,\n  Cast(0 as Money) as AmountPaid,\n  'Balance brought forward' as Description\nFrom\n  db_site4.dbo.AccountReceivable P\nJoin\n  db_site4.dbo.ARType ART on ART.ARTypeID = P.ARTypeID and ART.ARTypeID = 24\nleft Join\n  db_site4.dbo.vw_MemberTransactions MT\non\n  P.AccountReceivableID = MT.AccountReceivableID\nwhere \n  (MT.AccountingDate &lt;= @PeriodFrom or MT.AccountingDate is null)\nand\n  (Authorised = 1 or Authorised is Null)\nand\n  IsHidden = 0\nand\n  P.MemberID = 123\n</code></pre>\n\n<p><strong>SQL I/O Statistics for the above:</strong></p>\n\n<pre><code>Table 'Payment'. Scan count 16, logical reads 23558, physical reads 19, read-ahead reads 5448.\nTable 'InvoiceItemPayment'. Scan count 4, logical reads 22237, physical reads 51, read-ahead reads 13432.\nTable 'UnallocatedPayment'. Scan count 12, logical reads 431, physical reads 1, read-ahead reads 80.\nTable 'AccountReceivable'. Scan count 1, logical reads 2, physical reads 0, read-ahead reads 0.\nTable 'ARType'. Scan count 1, logical reads 2, physical reads 0, read-ahead reads 0.\nTable 'Invoice'. Scan count 11116, logical reads 116984, physical reads 190, read-ahead reads 30910.\nTable 'InvoiceItem'. Scan count 5122, logical reads 99786, physical reads 316, read-ahead reads 46236.\n</code></pre>\n\n<p><strong>Now for the query that returns in 4 seconds:</strong></p>\n\n<pre><code>declare @PeriodFrom DateTime\ndeclare @PeriodTo DateTime\nSet @PeriodFrom = '2012-06-01'\nSet @PeriodTo = '2012-06-30'\n\nSelect\n  0 as PrimaryAccount,\n  0 as PrintOrder,\n  Cast(Null as integer) as ID,\n  Sum(IsNull(MT.Amount, 0)) as Amount,\n  Cast(0 as Money) as NetAmount,\n  Cast(0 As Money) as TaxAmount,\n  Cast(0 as Money) as AmountOutstanding,\n  Cast(0 as Money) as AmountPaid,\n  'Balance brought forward' as Description\nFrom\n  db_site4.dbo.AccountReceivable P\nJoin\n  db_site4.dbo.ARType ART on ART.ARTypeID = P.ARTypeID and ART.ARTypeID = 24\nleft Join\n  db_site4.dbo.vw_MemberTransactions MT\non\n  P.AccountReceivableID = MT.AccountReceivableID\nwhere \n  (MT.AccountingDate &lt;= @PeriodFrom or MT.AccountingDate is null)\nand\n  (Authorised = 1 or Authorised is Null)\nand\n  (IsHidden = 0 or IsHidden is null)\nand\n  P.MemberID = 123\n</code></pre>\n\n<p><strong>SQL I/O statistics for the above:</strong></p>\n\n<pre><code>Table 'Payment'. Scan count 6271, logical reads 19857, physical reads 0, read-ahead reads 0.\nTable 'UnallocatedPayment'. Scan count 2, logical reads 4, physical reads 0, read-ahead reads 0.\nTable 'InvoiceItemPayment'. Scan count 4399, logical reads 33400, physical reads 0, read-ahead reads 0.\nTable 'InvoiceItem'. Scan count 10581, logical reads 60682, physical reads 4, read-ahead reads 0.\nTable 'Invoice'. Scan count 3, logical reads 22102, physical reads 3, read-ahead reads 0.\nTable 'AccountReceivable'. Scan count 1, logical reads 2, physical reads 0, read-ahead reads 0.\nTable 'ARType'. Scan count 1, logical reads 2, physical reads 0, read-ahead reads 0.\n</code></pre>\n\n<p><strong>My question is:</strong> how can there be such a difference in execution time between the two, when the only change that is made is replacing <code>IsHidden = 0</code> with <code>(IsHidden = 0 or IsHidden IS NULL)</code> ? (3 lines from the bottom)</p>\n"},{"tags":["php","query","wordpress-arras"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":9412554,"title":"Query two different \"post type\" in Wordpress using Arras Theme","body":"<p>I'm working with WordPress and my problem is that I need to query for two different \"post type\" (posts and a just brewed custom type).</p>\n\n<p>A similar (yet slightly different) case has been resolved here:\n<a href=\"http://stackoverflow.com/a/5918012/982901\">http://stackoverflow.com/a/5918012/982901</a></p>\n\n<p>The thing is that I need to alter this query to query both posts and the custom type:</p>\n\n<p>The query variable to be passed looks like this:</p>\n\n<p>======</p>\n\n<p>$query = arras_prep_query( array(</p>\n\n<pre><code>'list'              =&gt; $slideshow_cat,\n\n'taxonomy'          =&gt; arras_get_option('slideshow_tax'),\n\n'query'             =&gt; array(\n\n'posts_per_page'    =&gt; arras_get_option('slideshow_count'),\n\n'exclude'           =&gt; $post_blacklist,\n\n'post_type'         =&gt; arras_get_option('slideshow_posttype'),\n\n'paged'             =&gt; $paged\n\n    )\n\n) );\n</code></pre>\n\n<p>=====</p>\n\n<p>I've tried to change the assignment of 'post_type' line to something like </p>\n\n<pre><code>'post_type'         =&gt; ('post', 'custom'),\n</code></pre>\n\n<p>to no luck :)</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks!</p>\n\n<p>Edited to add:</p>\n\n<p>It seems that the solution was to replace the line for:</p>\n\n<pre><code>'post_type'         =&gt; array('debate', 'post'),\n</code></pre>\n\n<p>If anyone has a more elegant/smart solution, remember you're always welcome :)</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12833227,"title":"Required single SQL query","body":"<p>I have a table with the name <code>empdetail</code> and columns:</p>\n\n<pre><code>   Id  Name  Gender\n    1  ABC   Male\n    2  XYZ   Female\n    3  PQR   Male\n</code></pre>\n\n<p>I want to change <code>Gender</code> of each emp from <code>Male</code> to <code>Female</code> and from <code>Female</code> to <code>Male</code> with single query</p>\n\n<p>Result should be this:</p>\n\n<pre><code>1 ABC Female\n2 XYZ Male\n3 PQR Female\n</code></pre>\n"},{"tags":["sql","query","magento"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1232,"score":1,"question_id":9840046,"title":"Magento: How to get SQL query of Product load?","body":"<p>What is the full SQL query for product load?</p>\n\n<p>I mean, how to get the full SQL query for this code:-</p>\n\n<pre><code>$productId = 52;\n$product = Mage::getModel('catalog/product')-&gt;load($productId);\n</code></pre>\n\n<p>I know, we can get the SQL query for collection object through printLogQuery. Example:-</p>\n\n<pre><code>$collection = Mage::getModel('catalog/product')-&gt;getCollection();\n$collection-&gt;printLogQuery(true);\n</code></pre>\n\n<p>I couldn't find such for product load(). Any idea?</p>\n"},{"tags":["query","reference","mongodb","pymongo","dbref"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2325,"score":2,"question_id":2867513,"title":"How to query through a DBRef in MongoDB/pymongo?","body":"<p>Is it possible to query <em>through</em> a DBRef using a single find spec?</p>\n\n<p><strong>user collection</strong></p>\n\n<pre><code>{\n    'age': 30\n}\n</code></pre>\n\n<p><strong>post collection</strong></p>\n\n<pre><code>{\n    'user': DBRef('user', ...)\n}\n</code></pre>\n\n<p>Is it possible to query for all post who's users are 30 in a single find step?  If not, would it be wise to create a javascript function to handle the multi-stage operation or will that cause blocking problems?</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":12831745,"title":"Filter orders by product","body":"<p>I am newbie in SQL development. I am not good in SQL join :( . </p>\n\n<p>please help me to write a SQL query to extract the following fileds from the below tables for the product \"<strong>A Home Portable Laser Hair Remover</strong>\".</p>\n\n<p><strong>Fileds required:</strong></p>\n\n<p>orders.id, orders.order_price, orders.purchase_date, customers.email, product_orders.qty, products.name</p>\n\n<p><strong>Table 1: orders</strong></p>\n\n<pre><code>id  customer_id order_price purchase_date\n1   1                   0.20    12/6/2011\n2   2                   0.20    12/6/2011\n3   1                   0.20    12/6/2011\n4   1                   0.20    12/6/2011\n5   1                   0.20    12/7/2011\n6   3                   199.00  12/7/2011\n7   4                   199.00  12/7/2011\n8   5                   199.00  12/7/2011\n9   6                   199.00  12/7/2011\n10  7                   199.00  12/7/2011\n</code></pre>\n\n<p><strong>Table 2 : customers</strong></p>\n\n<pre><code>id  email                   name\n1   aa@dealboard.com.au aa\n2   bb@dealboard.com.au bb\n3   cc@live.com.au          cc\n4   dd@acgglobal.com    dd\n5   ee.heinrich@det.nsw.edu.au  ee\n6   ff@optusnet.com.au  ff\n7   ssy@hotmail.com         ss\n</code></pre>\n\n<p><strong>table 3: products</strong></p>\n\n<pre><code>id  name\n1   A Home Portable Laser Hair Remover\n2   Ipad\n3   android\n4   Asus\n5   s\n6   10 inch Android\n7   A Fabric Steamer Cleaner\n8   A Magnetic Fly Screen Door\n9   pillopw\n10  LCD\n</code></pre>\n\n<p><strong>table 4: product_orders</strong></p>\n\n<pre><code>       id orders_id product_id qty\n        1   1      1         1\n        2   2      1         1\n        3   3      1         1\n        4   4      1         1\n        5   5      2         1\n        6   6      1         1\n        7   7      1         1\n        8   8      1         1\n        9   9      1         1\n        10  10     1         1\n</code></pre>\n\n<p>i wanna extract the all the order for the product id 1 or filter orders by product</p>\n\n<p>please help me</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12831335,"title":"MySQL reporting query","body":"<p>I have the following db schema (i'm only mentioning the columns for each table necessary for the query in mind):</p>\n\n<pre><code>bills\n-------\nid\namount (decimal)\ncollection_case_id\n\n\ncollection_case\n------------------\nid\n\n\npayments\n----------\nid\nbill_id\namount (decimal)\ntype (char(2)) - \"CH\" stands for check payment, field used for polymorphism \n\ncheck_payments\n---------------\npayment_id\n</code></pre>\n\n<p>For a set of collection cases, I need to get the total interest earned from check payments.\nI am currently doing these calculations in memory after retrieving all the bill records for my set of collection case criteria.  For each bill I simply add the sum of checks received -   bill amount if sum of checks received is greater than bill amount.</p>\n\n<p>for instance my total received query looks like this (collection cases 1 &amp; 2):</p>\n\n<pre><code>select sum(payment.amount) as received \nfrom bills bill\ncross join payments payment inner join check_payments checkpayment \non \npayment.id=checkpayment.payment_id \nwhere payment.type='CH'\n and payment.bill_id=bill.id \n and (bill.collection_case_id in (1 , 2))\n</code></pre>\n"},{"tags":["sql","query","postgresql","view"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":9523562,"title":"How can I use a created column within a query, within the same query?","body":"<p>Let says that I do</p>\n\n<p><code>CASE\nWHEN apples.fruits = 'Macintosh' THEN 'Green'\nEND AS FruitBasket</code></p>\n\n<p>How could I make changes using fruit basket now? within this very query?</p>\n\n<p>I'd like to say</p>\n\n<p><code>CASE\nWHEN FruitBasket = 'Green' THEN 'Awesome'\nEND AS IsItGood</code></p>\n\n<p>Keep in mind I'd like those 2 lines of code to run in the same query.</p>\n"},{"tags":["mysql","sql","database","query","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12830612,"title":"GROUP BY clause is not displaying rows correctly","body":"<p>I have an \"Answer\" database table below:</p>\n\n<p>Answer Table</p>\n\n<pre><code>AnswerId SessionId QuestionId Answer\n10       AAD       7          A\n11       AAD       7          B\n12       AAD       7          D\n13       AAA       1          A\n14       AAC       1          True\n</code></pre>\n\n<p>Now as you can see above there are 3 answers for question 7 in Exam (Session) AAD, there is 1 answer for question 1 in Exam (Session) AAA, and these is 1 answer for question 1 in Exam (Session) AAC.</p>\n\n<p>So When I output the table in php/html, it should display it like this:</p>\n\n<pre><code>  Question  Answer\n\n  7         ABD\n  1         A\n  1         True\n</code></pre>\n\n<p>But the problem is that it is displaying the table in 3 separate rows which I do not want:</p>\n\n<pre><code>Question  Answer\n7         ABD\n7         ABD\n7         ABD\n1         ATrue\n1         ATrue\n</code></pre>\n\n<p>So I am guessing that I have got my GROUP BY CLAUSE incorrect, my question is that what should the GROUP BY Clause be so that it is correct?</p>\n\n<pre><code> SELECT DISTINCT an.SessionId, an.QuestionId, q.QuestionContent, o.OptionType, q.NoofAnswers, GROUP_CONCAT( an.Answer\nORDER BY an.Answer\nSEPARATOR  ' ' ) AS Answer, r.ReplyType, q.QuestionMarks\nFROM Answer an\nINNER JOIN Question q ON q.QuestionId = an.QuestionId\nJOIN Reply r ON q.ReplyId = r.ReplyId\nJOIN Option_Table o ON q.OptionId = o.OptionId\nGROUP BY an.SessionId, an.QuestionId\n</code></pre>\n\n<p>Below I have included the SHOW CREATE TABLES for \"Question\" and \"Answer\" Tables:</p>\n\n<p>Question Table:</p>\n\n<pre><code> CREATE TABLE `Question` (\n     `SessionId` varchar(10) NOT NULL,\n     `QuestionId` int(10) NOT NULL,\n     `QuestionContent` varchar(5000) NOT NULL,\n     `NoofAnswers` int(2) NOT NULL,\n     `ReplyId` int(1) NOT NULL,\n     `QuestionMarks` int(4) NOT NULL,\n     `OptionId` int(2) NOT NULL,\n     PRIMARY KEY (`SessionId`,`QuestionId`)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>Answer Table:</p>\n\n<pre><code>CREATE TABLE `Answer` (\n `AnswerId` int(10) NOT NULL AUTO_INCREMENT,\n `SessionId` varchar(10) NOT NULL,\n `QuestionId` int(10) NOT NULL,\n `Answer` varchar(5) NOT NULL,\n PRIMARY KEY (`AnswerId`)\n) ENGINE=InnoDB AUTO_INCREMENT=40 DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>Below is the \"Question\" Table rows (I only include SessionId and QuestionId columns as they are relevant for this situation:</p>\n\n<pre><code>SessionId QuestionId \nAAA       1\nAAC       1\nAAD       7\n</code></pre>\n\n<p>The rows in the \"Answer\" table is at top of this question.</p>\n\n<p>UPDATE: With the query above I get these results (Only including relevant columns):</p>\n\n<pre><code>SessionId  QuestionId  Answer\nAAA        1           A A        // This row answer should only be \"A\"\nAAC        1           True True  //This row answer should only be \"True\"\nAAD        7           A B D      //This row is fine\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12829616,"title":"MYSQL query - how to construct total for only ids that have a particular value in another table?","body":"<p>I have the two following tables. <strong>In ONE query</strong>, how can I total the column TOTAL_TIME for only those VEHICLE_IDs that have a FEATURE_ID of 2 found in TABLE 2?<br/><br/>\nThus in my case <strong>the result of the query should be 2:30</strong> as it would add 2:00 and 0:30 because those vehicles have a FEATURE_ID of 2.<br/><br/>\n<strong>TABLE 1</strong><br/>\nVEHICLE_ID   |   TOTAL_TIME<br/>\n----------------+-----------------<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:00<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:30<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:25<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0:30<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;........<br/></p>\n\n<p><strong>TABLE 2</strong><br/>\nVEHICLE_ID   |   FEATURE_ID<br/>\n----------------+-----------------<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br/>\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;........</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12827542,"title":"trying to figure out how to properly write a select for a dataset","body":"<pre><code>table:\n--duedate timestamp\n--submissiondate timestamp\n--blocksreq numeric\n--file clob\n--email varchar2(60)\n</code></pre>\n\n<p>Each entry is a file which will take blocksreq to accomplish.  There are 8 blocks allotted per day (but could be modified later).  before i insert into the table, i want to make sure there are enough blocks to accomplish it in the timeframe of NOW() and @duedate</p>\n\n<p>I was thinking of the following, but i think i am doing it wrong:</p>\n\n<pre><code>R1 = select DAY(), @blocksperday - sum(blocksreq) as free \n     from table \n     where @duedate between NOW() and @duedate \n     group by DAY() \n     order by DAY() desc\n\nR2 = select sum(a.free) from R1 as a;\n\nif(R2[0] &lt;= @blocksreq){ insert into table; }\n</code></pre>\n\n<p>pardon the partial pseudocode.</p>\n\n<p>SQL FIDDLE:  <a href=\"http://sqlfiddle.com/#!2/5bda5\" rel=\"nofollow\">http://sqlfiddle.com/#!2/5bda5</a></p>\n\n<p><strong>warning:  My sql fiddle has garbage code... as i dont know how to make a lot of test cases.  nor set the duedate to NOW()+5 days</strong></p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12828357,"title":"Is it possible to find out which field matched in table mysql?","body":"<p>I'm trying to find duplicates in a table. The field that needs to be checked against duplicate is a serialized array from PHP. This is my query:</p>\n\n<pre><code>SELECT Blob, BID, ID\nFROM  `Statuses`\nWHERE ID &lt;&gt; :id AND (Blob LIKE :blob1 OR Blob LIKE :blob2)\n</code></pre>\n\n<p>now what i want from this query is that select all of those statuses that are not the status that im trying to match with and their serialized array contains :blob1 OR serialized array contains :blob2.</p>\n\n<p>This works, it returns the duplicates just fine but i need to know which one it matched, whether it matched blob1 or it matched blob2. Is it possible to do this directly from Query without using PHP? </p>\n\n<p>In other words, is it possible to find out which field matched to find the duplicate.</p>\n"},{"tags":["php","mysql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":12827705,"title":"Mysql query update","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11321491/mysql-when-to-use-single-quotes-double-quotes-and-backticks\">MySQL - when to use single quotes, double quotes, and backticks?</a>  </p>\n</blockquote>\n\n\n\n<p>i have this piece of code, i can't get to work properly.</p>\n\n<pre><code>require_once(\"../Packages/Connection.php\");\n\n        $text = mysql_real_escape_string($_POST[\"articleText\"]);\n\n        $method = $_POST['method'];\n        $articleId = $_POST['articleId'];\n\n        if($method == \"update\")\n        {\n            mysql_query(\"UPDATE Articles SET 'text'='\".$text.\"' WHERE 'id'='\".$articleId.\"'\") or die(mysql_error());\n        }\n</code></pre>\n\n<p>It is annoying me so much, \nThis is the error i get - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''text'='tester2' WHERE 'id'='29'' at line 1...</p>\n\n<p>Thank in advance</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12826797,"title":"How do I put a conditioned count of a joined table in a separate column of the same joined table","body":"<p>Lets say, I have two tables - <code>people</code> and <code>bonus</code></p>\n\n<pre><code>------------\npeople\n------------\npeople_id | company_id  | job_id\n  1       |     1       |    2\n  2       |     1       |    4\n  3       |     2       |    1\n  4       |     2       |    3\n  5       |     3       |    5\n\n------------\nbonus\n------------\njob_id    | bonus_id \n  1       |     101    \n  2       |     102    \n  3       |     103\n</code></pre>\n\n<p>Now, I want to have a joined table like the following</p>\n\n<pre><code>-------------\nJOINED TABLE \n-------------\npeople_id | company_id  | job_id | bonus_id | no_of_bonus_for_company\n  1       |     1       |    2   |   102    |      1\n  2       |     1       |    4   |   NULL   |      1\n  3       |     2       |    1   |   101    |      2\n  4       |     2       |    3   |   103    |      2\n  5       |     3       |    5   |   NULL   |      0\n</code></pre>\n\n<p>I need to have the main search term in <code>people_id</code> as in -</p>\n\n<pre><code>SELECT p.people_id,\n       p.company_id,\n       p.job_id,\n       b.bonus_id\nFROM people p\nLEFT JOIN bonus b\n     ON p.job_id = b.job_id\nWHERE p.people_id IN (1,2,3,4,5)\nORDER BY p.people_id ASC;\n</code></pre>\n\n<p>But how do I get the fifth column of the joined table? It actually counts the no. of bonus id's for each company id in the joined table itself.</p>\n"}]}
{"total":20740,"page":13,"pagesize":100,"questions":[{"tags":["c#","sql","linq","query","list"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12826886,"title":"c# linq not equals variation","body":"<p>I have a linq query w/ entity frameworks that works and gets the needed information, but now i am having trouble doing the opposite. </p>\n\n<p>Currently it gets all the data that is needed using the joins to link tables but i need to to get some data that is not match some of the joins.</p>\n\n<p>I know you can only use \"equals\" om linq, but i need info that is not equals\ni.e. join ec in c.IsoNe on ap.idLook not equals ec.idAll</p>\n\n<p>Below is the working code, but not how i need it now. any help would be appreciated...</p>\n\n<pre><code>var test = (from bil in bilats\n                join ap in c.Allegro on bil.idAll equals ap.idAll\n                join ec in c.IsoNe on ap.idLook equals ec.idAll\n                join cb in c.Comp on ap.idCompBuy equals cb.idComp\n                join cs in c.Com on ap.idCompSell equals cs.idComp\n                join iby in c.IsoNe on cb.idComp equals iby.idComp\n                join iss in c.IsoNe on cs.idComp equals isl.idComp\n             orderby bil.HBegin ascending\n             where bil.HBegin &gt;= ec.DateTStart\n             where bil.HBegin &lt; ec.DateTEnd\n             select new\n             {\n                 Cont = ec.ContractID,\n                 ContType = ap.idScheduleType,\n                 Sel = isel.ISONE1,\n                 Buy = ibel.ISONE,\n                 HBegin = bil.HBegin,\n              }).ToList();\n</code></pre>\n"},{"tags":["database","query","ms-access","filter","subforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12825530,"title":"filter data from one table based on second table without duplicates","body":"<p><em>Note: I'm working with a large complex database, so for clarity's sake I have simplified the set up below.</em></p>\n\n<p>I struggled a bit with how to title the question since it's a bit of a complex question. I hope it's accurate enough....</p>\n\n<p><strong>A bit of background first:</strong></p>\n\n<p>I have an Access 2010 database that contains a one-to-many relationship between a table Called \"Products\" and a table called \"Datasets\" (ie I have a bunch of products, and each product has multiple datasets). Each has an autonumber key field (p_ID and d_ID respectively) as well as numerous other fields.</p>\n\n<p>I have a form (lets call it frm_Main) that has two subforms: sub_Products (based on the \"Products\" table) and sub_Datasets (based on the \"Datasets\" table). On the main form I have a control ctrl_SelectedProduct which is linked to [sub_Products]![p_ID] to see which record in sub_Products is selected / has the focus, and the sub_Datasets subform is linked to this control so that it only displays Datasets records that belong to the selected Products record.</p>\n\n<p>On the main form I also have a number of controls that I'm using for filtering the data in the subforms. For example, I have a control ctrl_Category. I have this control coded so that when the user changes the value of the control, a filter is applied that limits the records in sub_Products to only those that have a p_Category value equal to whatever is chosen in ctrl_Category. If the control is blank, it will show all records. All this works great when if comes to filtering based on fields in the Products table.</p>\n\n<p><strong>Now the problem:</strong></p>\n\n<p>My problem is that I also want to be able to filter based on fields in the Datasets table. For example, Datasets has a field called d_Status. I want the user to be able to chose the status in a control (ctrl_Status), and based on this:</p>\n\n<p><strong>1)</strong> sub_Products will be filtered to display only those Products records that have an assotiated Datasets record (or records) that has d_Status equal to whatever was chosen in ctrl_Status</p>\n\n<p>then</p>\n\n<p><strong>2)</strong> when a Products record is selected in this filtered sub_Products, sub_Datasets will only show the Datasets records that has d_Status equal to whatever was chosen in ctrl_Status</p>\n\n<p>I know how to do part2. But I have no idea how to get part1 to work. Since sub_Products is currently based on the Products table, which does not have the d_Status field, I have no way to filter it based on that field. Thus, I'm assuming my first step will be to change my setup so that sub_Products is based on a query that combines the two tables (or at least adds the d_Status field).</p>\n\n<p>If I do that, however, I get duplicate Product records. I can't use the query's Unique Values property because if I have a product that has two datasets, one with status \"Current\" and a one with status \"Archived\", then those aren't considered duplicates, and the product info is there twice. If I don't have the status field displayed, it shows only unique products initially, but then I can't subsequently apply a filter based on that non-displayed field.</p>\n\n<p>I also tried basing sub_Products on a Totals query in order to utilize the Group By functionality, but I still couldn't get it to work right. Even if I could I don't think that's the best solution, because you can only have 10 fields with Group By, and my Products table has more than 10 fields that I need displayed in sub_Products.</p>\n\n<p>I feel like I'm now just going around in circles and am at a loss of what to try from here. Please help! </p>\n"},{"tags":["sql","database","query","hsqldb","embedded-database"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":5349,"score":3,"question_id":909702,"title":"How to do \"select current_timestamp\" in hsqldb?","body":"<p>Oracle:</p>\n\n<pre><code>select systimestamp from dual\n</code></pre>\n\n<p>MySQL:</p>\n\n<pre><code>select current_timestamp\n</code></pre>\n\n<p>SQL Server:</p>\n\n<pre><code>select current_timestamp\n</code></pre>\n\n<p>PostgreSQL:</p>\n\n<pre><code>select current_timestamp\n</code></pre>\n\n<p>The question is, how can I get the current timestamp in <a href=\"http://hsqldb.org/\" rel=\"nofollow\">HSQLDB</a>? I use version 1.8.0.10</p>\n"},{"tags":["php","mysql","query","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12826590,"title":"mysql similar search query results","body":"<p>I need to know how to display similar search query usernames like if there is a user names : johnhol , _john_ , donjohnqq , king_john , code_john\nand if we search john then all names starting from john must display currently iam using </p>\n\n<pre><code>$result = mysql_Query(\"SELECT user FROM UserData WHERE user LIKE '%$username%'\") or die(mysql_error());\n$fetch = mysql_num_rows($result);\n</code></pre>\n\n<p>but it's not displaying like what i told it's Displaying only some names like _john_ , king_john like names only displaying as per the code so please tell me how to search with search query and display all starting names in the mysql database.</p>\n"},{"tags":["sql","query","caching","yii"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12826096,"title":"Is it okay to create a expiring timestamp cache table?","body":"<p>I was reading about caching mechanism that Yii implements and possible other frameworks/techniques/databases as well. If I got that right, there's a step that you have to specify a condition to expire the cache. If you have a user row with a timestamp field, you could use this timestamp to verify it's (the row) consistency. If you have a log table with non erasable/updatable rows, you could use <strong>count(*)</strong> to make sure that you have an up to date cached result of that query/table.</p>\n\n<p>Now, to my question:</p>\n\n<p>Imagine that I have 13 tables. Is it <strong>useful</strong> to create another table (<strong>CacheTable</strong>) that has only one column of <strong>timestamp</strong> type and store <strong>13 rows</strong>, each row telling me when was the last time that one of the other tables was updated/deleted/inserted and use this <strong>CacheTable</strong> to verify the expiring condition of all my cached queries?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12826217,"title":"How to make a MySQL select for a tree structure?","body":"<p>I have a table in MySQL:</p>\n\n<pre><code>id       name        parent_id\n1        animals       null\n2        mammal         1\n3        feline         2\n4        human          2\n5        cat            3\n6        invertebrate   1\n7        snake          6\n8        objects        null\netc..\n</code></pre>\n\n<p>I want a MySQL query that displays the results in this order:</p>\n\n<pre><code>    Animals\n       Mammal\n          Feline\n             Cat\n          Human\n       Invertebrate\n    Objects\netc..\n</code></pre>\n\n<p>I'm still learning and am completely stuck with this one.</p>\n"},{"tags":["mysql","query","match"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":12825994,"title":"Match values from two different tables","body":"<p>Given 2 tables, TableA and TableB, how can I get the \"id\"s of TableA when the \"value\" doesn't match with any \"value\" of TableB?</p>\n\n<p><strong>Table A</strong></p>\n\n<pre><code>+----+-------+\n| id | value |\n+----+-------+\n| 1  |   a   |\n| 2  |   b   |\n| 3  |   c   |\n| 4  |   d   |\n| 5  |   e   |\n+----+-------+\n</code></pre>\n\n<p><strong>Table B</strong></p>\n\n<pre><code>+----+-------+\n| id | value |\n+----+-------+\n| 1  |   a   |\n| 2  |   b   |\n| 3  |   c   |\n| 4  |   c   |\n| 5  |   f   |\n+----+-------+\n</code></pre>\n\n<p><strong>Result Table</strong></p>\n\n<pre><code>+----+\n| id |\n+----+\n| 4  |\n| 5  |\n+----+\n</code></pre>\n\n<p><strong>EDITED (SQLFiddle):</strong> <a href=\"http://sqlfiddle.com/#!2/4c8c9\" rel=\"nofollow\">http://sqlfiddle.com/#!2/4c8c9</a></p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":64,"score":-3,"question_id":12815896,"title":"sql query not working correctly","body":"<pre><code>USE [cms]\nGO\n/****** Object:  StoredProcedure [dbo].[SpGetRelatedProducts]    Script Date: 10/10/2012 14:35:39 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER proc [dbo].[SpGetRelatedProducts](@pid int)\nAS\nDECLARE @subcate int;\nselect subcate_id as subcate from product where pid=@pid\nSELECT *\nFROM product\nwhere product.subcate_id=@subcate\n\n\n\n\nexec SpGetRelatedProducts 2\n</code></pre>\n\n<p>The above sql query is not working correctly as wanted.</p>\n\n<p>I want the product details of only those products, that have subcatid=(subcatid of given pid).</p>\n\n<p>There are 2 issues </p>\n\n<ol>\n<li><p>only 1 output should appear instead of 2</p></li>\n<li><p>2nd output is not working correctly</p></li>\n</ol>\n"},{"tags":["mysql","query","optimization","where"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12825279,"title":"Optimize Mysql for table 4.000.000 records","body":"<p>I have one table with 4.000.000 records.</p>\n\n<p>and i want to run single query to select male member</p>\n\n<pre><code>SELECT * FROM member WHERE gender='0' ORDER BY member_id DESC LIMIT 0,20;\n</code></pre>\n\n<p>it took 12 seconds to do this query.\ni already have INDEX with gender,member_id field.\n0: male\n1: female</p>\n\n<pre><code>Keyname Type    Unique  Packed  Field   Cardinality\ngender  BTREE   No  No  gender  2\n</code></pre>\n\n<p>so, how can i speed up this query :(</p>\n"},{"tags":["forms","query","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12825775,"title":"How to store sqlite select statements for later use?","body":"<p>I have a form where a user can choose columns from the various tables in my db that they want to use. When they submit the query, I have a function build the appropriate string to be sent to the database. Is there a way I can save this string, perhaps in a text file or in a database itself, so that I can just add a button to the form as a shortcut for that exact select statement? I want to do this as an alternative to saving a spreadsheet so the user automatically sees new updates without having to do them by hand or build a new query. </p>\n"},{"tags":["mysql","database","query","full-text-search","boolean-search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12824638,"title":"MySQL full text search with \"+\" and distance in same where clause","body":"<p>If i have the below data for example:</p>\n\n<p><strong>Model 5  Red Plastic 3 inches tall</strong></p>\n\n<p><strong>Model 3  Blue Metal 4 inches tall</strong></p>\n\n<p>When the user types into my search box the words \"Model 3\"  i want to make sure the results only show the 2nd row in the above data and that Model 5 is excluded(without distance it would find the \"3\" in 3 inches tall and match).  Is it possible to do the following in one statement.  I have tried</p>\n\n<pre><code>    SELECT *\n    FROM description \n    WHERE MATCH (description) AGAINST ('+Model +5 \"Model 5\" @5' in boolean mode)\n</code></pre>\n\n<p>and i still get all of the results.  However, if i run this:</p>\n\n<pre><code>   SELECT *\n   FROM description\n   WHERE MATCH (description) AGAINST ('+Model +5' in boolean mode)\n     AND MATCH (description) AGAINST ('\"Model 5\" @5' in boolean mode);\n</code></pre>\n\n<p>it will do exactly what i want.  This seems inefficient though, running and extra AND in the statement.  Am i missing something in the original statement causing it not to filter correctly?  I read the MySql reference manual and it does not mention not being able to combine other operators with distance?  I understand in normal circumstances these would each be different columns and the problem could easily be adverted.</p>\n\n<p>Thanks for the help!</p>\n"},{"tags":["mysql","sql","query","join","sql-order-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12824177,"title":"Adding new set of rows to result set to existing query","body":"<p>This are the tables that are used in the querys:</p>\n\n<p>HELPS (Fields relevant: id, id_user)</p>\n\n<p><img src=\"http://i.stack.imgur.com/5tZtF.png\" alt=\"enter image description here\"></p>\n\n<p>FRIENDS </p>\n\n<p><img src=\"http://i.stack.imgur.com/CmxOC.png\" alt=\"enter image description here\"></p>\n\n<p>SHARED_HELPS</p>\n\n<p><img src=\"http://i.stack.imgur.com/C2iTu.png\" alt=\"enter image description here\"></p>\n\n<p>So:</p>\n\n<p>This query (works) returns al the helps from a user and all from other users that he referenced:</p>\n\n<pre><code>$sql = 'SELECT\n                      helps.*,CASE WHEN shared_helps.userid IS NULL THEN 0 ELSE shared_helps.userid END as is_shared, CASE WHEN shared_helps.userid IS NULL THEN helps.fecha ELSE shared_helps.fecha END as ffecha\n                    FROM\n                      helps\n                    LEFT JOIN  shared_helps\n                        ON  shared_helps.helpid = helps.id\n                        AND shared_helps.userid = '.$value.'\n\n                    WHERE     (helps.id_user = '.$value.' AND helps.id_group &lt;= 0)  OR shared_helps.userid = '.$value.'\n\n\n\n                   ORDER BY ffecha DESC';\n</code></pre>\n\n<p>Also, this query (works) lists all the helps from a user an the ones from his friends</p>\n\n<pre><code>$sql = 'SELECT  id, title, content, id_user, id_group, id_type, id_loc, avatar, attached, fecha, likes, lan, needsCount, recivedCount\n                    FROM\n                        (\n                            SELECT *, 1 as OrderBy           \n                                FROM helps \n                             WHERE id_user = '.$value.' or id_user IN (SELECT helpid FROM shared_helps WHERE userid = '.$value.')\n                            UNION\n                            SELECT  h.*, 2 as OrderBy        \n                                 FROM    (\n                                        SELECT  id  AS friendsId,\n                                                CASE followerid \n                                                    WHEN '.$value.' THEN followingid \n                                                    ELSE followerid \n                                                END AS friend_id\n                                        FROM    friends\n                                        WHERE   acepted = 1 AND \n                                                (followerid  ='.$value.' OR followingid = '.$value.')\n                                    ) AS f\n                                        INNER JOIN helps AS h \n                                            ON h.id_user = f.friend_id where id_group &lt; 0\n                        ) x\n                    ORDER BY ID DESC\n                    ';\n</code></pre>\n\n<p>The thing is to the last one, i need to add the ones that are from other users but he referenced (is like a mix of the two query I posted..)</p>\n\n<p>I tried this:</p>\n\n<pre><code>$sql = 'SELECT  id, title, content, id_user, id_group, id_type, id_loc, avatar, attached, fecha, likes, lan, needsCount, recivedCount,\n                            CASE WHEN shared_helps.userid IS NULL THEN helps.fecha ELSE shared_helps.fecha END as ffecha\n                    FROM\n                        (\n                            SELECT *, 1 as OrderBy           \n                                FROM helps \n                             WHERE id_user = '.$value.' or id_user IN (SELECT helpid FROM shared_helps WHERE userid = '.$value.')\n                            UNION\n                            SELECT  h.*, 2 as OrderBy        \n                                 FROM    (\n                                        SELECT  id  AS friendsId,\n                                                CASE followerid \n                                                    WHEN '.$value.' THEN followingid \n                                                    ELSE followerid \n                                                END AS friend_id\n                                        FROM    friends\n                                        WHERE   acepted = 1 AND \n                                                (followerid  ='.$value.' OR followingid = '.$value.')\n                                    ) AS f\n                                        INNER JOIN helps AS h \n                                            ON h.id_user = f.friend_id where id_group &lt; 0\n                        ) x\n                    LEFT JOIN  shared_helps\n                            ON  shared_helps.helpid = x.id\n                            AND shared_helps.userid = '.$value.'\n\n                        WHERE     (x.id_user = '.$value.' AND helps.id_group &lt;= 0)  OR shared_helps.userid = '.$value.'\n\n\n\n                    ORDER BY ffecha DESC\n                    ';\n</code></pre>\n\n<p>But i got:</p>\n\n<pre><code>Column 'id' in field list is ambiguous\n</code></pre>\n\n<p>But this is obviously out of my knowledge.. Can anyone show me the ligth?</p>\n"},{"tags":["mysql","query","csv","substring"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12823451,"title":"Get the substring value of a table with delimiter count","body":"<p>I've a tableA with 2 columns (value1, value2) with a CSV formatted value. I want to create a tableB with the same fields as tableA but, in those 2 columns, with just a limit number of values (note that I don't know how many characters exists between commas). This \"limit\" is the first <em>n</em> elements of the CSV.</p>\n\n<p><strong>Table A</strong></p>\n\n<pre><code>+----+----------+----------------------+----------------------+\n| id |   other  |        value1        |        value2        |\n+----+----------+----------------------+----------------------+\n| 1  |  other1  | 111,222,333,444      | 1616,17,1,8,19,2020  |\n| 2  |  other2  | 55,6,7777,8,9        | 21,22,23             |\n| 3  |  other3  | 10101,11.11,13,14,15 | 242424,2525,26,27    |\n+----+----------+----------------------+----------------------+\n</code></pre>\n\n<p><strong>Table B (limit to 3 elements)</strong></p>\n\n<pre><code>+----+----------+----------------------+----------------------+\n| id |   other  |        value1        |        value2        |\n+----+----------+----------------------+----------------------+\n| 1  |  other1  | 111,222,333          | 1616,17,1            |\n| 2  |  other2  | 55,6,7777            | 21,22,23             |\n| 3  |  other3  | 10101,11.11,13       | 242424,2525,26       |\n+----+----------+----------------------+----------------------+\n</code></pre>\n\n<h2>EDITED:</h2>\n\n<p>I didn't mention that those tables have a huge number of elements (and many other columns like \"other\"). Therefore I prefer to use:</p>\n\n<pre><code>create table tableB LIKE tableA; \nINSERT tableB SELECT * FROM tableA; \n</code></pre>\n\n<p>and then update the value1 and value2 (in 2 distinct transactions - in fact I've 91 columns like that). This probably is more efficient then a \"create table\" with all the values inside in a single query...</p>\n\n<hr>\n\n<h2>EDITED2 (solution):</h2>\n\n<p><strong>SQLFiddle:</strong></p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/2e73a/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/2e73a/1</a></p>\n"},{"tags":["java","query","mongodb","conditional-operator"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12815517,"title":"How to query whole word in Java MongoDB","body":"<p>I'm using Java Mongo DB driver.<br>\nIm doing some OR and AND operation to query the collection.  </p>\n\n<pre><code>QueryObj = new BasicDBObject(\"key1\",Pattern.compile(\"v\",Pattern.CASE_INSENSITIVE));\nQueryList.add(QueryObj);\nDBObject OrQuery = new BasicDBObject(\"$or\", QueryList);\nDBCursor cursor = MyCollection.find(OrQuery);  \n</code></pre>\n\n<p>my Sample collection have 4 rows(JSON format might be wrong)    </p>\n\n<pre><code>{\n\"key1\": [\"val1\",\"val3\"]\n},\n{\n\"key1\": [\"val2\",\"val3\"]\n},\n{\n\"key1\": [\"val3\"]\n},\n{\n\"key1\": [\"val1\",\"val2\"]\n}\n</code></pre>\n\n<p>If i search for \"val2\"   </p>\n\n<pre><code>QueryObj = new BasicDBObject(\"key1\",Pattern.compile(\"val2\",Pattern.CASE_INSENSITIVE));  \n</code></pre>\n\n<p>i'm getting expected output 2nd and 4th row</p>\n\n<pre><code>{\n\"key1\": [\"val2\",\"val3\"]\n},\n{\n\"key1\": [\"val1\",\"val2\"]\n}  \n</code></pre>\n\n<p>if i search just \"v\"  </p>\n\n<pre><code>QueryObj = new BasicDBObject(\"key1\",Pattern.compile(\"v\",Pattern.CASE_INSENSITIVE));\n</code></pre>\n\n<p>i should get null set, but getting all the 4 rows, though the array have a character \"v\".<br>\ni need to search the whole word.</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12823835,"title":"MYSQL Best Row Count Method - Large Database","body":"<p>I have a MySQL database that contains over 400,000 rows. For my web based script, I have a page function. One of the steps to determine how many pages there should be is returning the number of rows in the table.</p>\n\n<p>Let's pretend the table name is <strong><code>data</code></strong>. </p>\n\n<p>I'm wondering what is the most efficient method to ONLY return the number of rows in the database.</p>\n\n<p>I could obviously do something like:</p>\n\n<pre><code>$getRows = mysql_query(\"SELECT id FROM `data`\") or die(mysql_error());\n$rows = mysql_num_rows($getRows);\n</code></pre>\n\n<p>So that it only selects the id. But still, that will be selecting 400,000 + ID's worth of data and storing it on the stack (i think?) and seems less efficient as using a method such as finding the table status. I'm just not 100% sure how to use the table status method.</p>\n\n<p>Feedback &amp; opinions would be awesome. Thanks guys!</p>\n"},{"tags":["mysql","database","query","table","auto-increment"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":715,"score":0,"question_id":7346934,"title":"mysql Failed to read auto-increment value from storage engine","body":"<p>i am having mysql table with one id field as auto-increment .</p>\n\n<p>When i insert values to the table am getting error as</p>\n\n<pre><code>1467 - Failed to read auto-increment value from storage engine\n</code></pre>\n\n<p>Also the <code>show table status</code> shows me that the field with auto increment  has </p>\n\n<p><code>18446744073709551615</code> as Auto_increment value.</p>\n\n<p>What would be the issue can any one help me ....?</p>\n"},{"tags":["query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12823492,"title":"convert query to a physical table in access 2010","body":"<p>I was trying to convert this query into a table that I can take screenshots of. Can anyone help:</p>\n\n<pre><code>INSERT INTO CUSTOMER VALUES(1000 ,'Smith'  ,'Jeanne' ,1050.11);\nINSERT INTO CUSTOMER VALUES(1001 ,'Ortega' ,'Juan'   ,840.92);\n\nINSERT INTO CUSTOMER_2 VALUES(2000 ,'McPherson' ,'Anne');\nINSERT INTO CUSTOMER_2 VALUES(2001 ,'Ortega'    ,'Juan');\nINSERT INTO CUSTOMER_2 VALUES(2002 ,'Kowalski'  ,'Jan');\nINSERT INTO CUSTOMER_2 VALUES(2003 ,'Chen'      ,'George');\n\nINSERT INTO INVOICE VALUES(8000 ,1000 ,'23-APR-2006' ,235.89);\nINSERT INTO INVOICE VALUES(8001 ,1001 ,'23-MAR-2006' ,312.82);\nINSERT INTO INVOICE VALUES(8002 ,1001 ,'30-MAR-2006' ,528.1);\nINSERT INTO INVOICE VALUES(8003 ,1000 ,'12-APR-2006' ,194.78);\n</code></pre>\n\n<p>INSERT INTO INVOICE VALUES(8004 ,1000 ,'23-APR-2006' ,619.44);</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12822927,"title":"Get the names of IDs from different table","body":"<p>I have an array with a lot of data from a database. In the array, there are two fields called <code>teameinsid</code> and <code>teamzweiid</code>.  The query is a very simple one : </p>\n\n<pre><code>$spiel = mysql_query(\"select teameinsid, teamzweiid from begegnung\", $connection) or die(\"Keine passende Begegnung\");\n</code></pre>\n\n<p>What I need is to search in the database for the names of these IDs. The names are in a different table. </p>\n\n<p>What I have now is the following: </p>\n\n<pre><code>while($tmp = mysql_fetch_array($spiel)){\n $teins = $tmp['teameinsid'];\n $tzwei = $tmp['teamzweiid'];\n}\n</code></pre>\n\n<p>So I know the two IDs, but I don't know where to save the names. If I try: </p>\n\n<pre><code>$name = mysql_query(\"select name from team where teameinsid = $teins\", $con) \n</code></pre>\n\n<p>it gets overwritten every time. How can I manage this?</p>\n\n<p>EDIT: </p>\n\n<p>Database Scheme: </p>\n\n<p>Table Team : id, name\nTable Begegnung: id, teameinsid, teamzweiid</p>\n"},{"tags":["mysql","sql","query","select","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12822952,"title":"MySQL: Select last from group, but with conditions","body":"<p>I have the following table:</p>\n\n<pre><code>name     created_for created_on            status\njen      2012-05-27  2012-02-15 12:14:09    Y\njoe      2012-10-01  2012-02-15 12:22:09    Y\nbob      2012-10-01  2012-02-15 12:47:09    N\njim      2012-10-01  2012-02-24 12:47:09    N\njim      2012-10-01  2012-02-29 12:47:09    Y\nsam      2012-10-01  2012-03-11 12:47:09    N\nsam      2012-10-01  2012-03-15 12:47:09    C\nsam      2012-10-01  2012-03-22 12:47:09    Y\ntom      2012-10-01  2012-04-10 12:47:09    N\ntom      2012-10-01  2012-04-11 12:47:09    N\n</code></pre>\n\n<p>What I want to return is the last row of name, created_on for each person that has a created_for date of 2012-10-01, but ONLY IF the status for that last entry is an N. So for the table above, I want to get back:</p>\n\n<pre><code>name     created_on\nbob      2012-02-15 12:47:09\ntom      2012-04-11 12:47:09\n</code></pre>\n\n<p>The status condition is what's throwing me. I can't seem to figure out where to place the \"where status='N'\" to get the right results.</p>\n"},{"tags":["query","postgresql","geospatial","postgis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12814784,"title":"PostGIS: Finding points within certain radius from other points","body":"<p>I have a table in PostgreSQL/PostGIS named 'trip' with two geometry columns: 'source_geom' ('POINT') and 'destination_geom' ('POINT') indicating starting and ending location of a journey.</p>\n\n<p>I have one more separate table named 'business' with geometry column 'office_geom' ('POINT') that indicates the location of offices.</p>\n\n<p>My aim is to select the records from the table 'trip' whose destination is within 1000 meters from <em>any of the office location</em>. </p>\n\n<p>What query do I need to fire to get the results that I require?</p>\n"},{"tags":["mysql","performance","algorithm","query","index"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12821936,"title":"Mysql implementation and efficiency querying on multiple fields","body":"<p>I want to search a table by two fields in MySQL:</p>\n\n<pre><code>select * from table where  \n90 &lt; x and x &lt; 100 and \n50 &lt; y and y &lt; 60\n</code></pre>\n\n<p>What is the efficiency of this search if optimised? O(log(n))? </p>\n\n<p>And what type of index and algorithm would it be implementing? (Am I correct in saying it would be O(n.log(n)) if using standard B-tree or hash map?)</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12822710,"title":"SQL Order by with Condition?","body":"<p>until now i have the following Query:</p>\n\n<pre><code>select dl \nfrom Dienstleistung as dl inner join \n     dl.DienstleistungsOrte as dlo with dlo.ID = :raumID \norder by dl.Bezeichnung\n</code></pre>\n\n<p>Is it possible to order two colums with a condition?</p>\n\n<p>What i want is to order by dl.Bezeichnung and dl.Sortierung. The Condition should be: </p>\n\n<pre><code>IF dl.Sortierung = 0 ---&gt; order by dl.Bezeichnung\nand\nIF dl.Sortierung &gt; 0 ---&gt;order by dl.Sortierung\n</code></pre>\n"},{"tags":["performance","sql-server-2008","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12822518,"title":"How to improve Query performance on large table in MS SQL Server 2008 R2","body":"<p>I have a table with 20 million records. What is the best option to improve query performance on this table. Is partitioning the table into filegroups  is a best option or splitting the table into multiple smaller tables? </p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12822550,"title":"fetch data from two tables with single query","body":"<p>Have two tables say ABC and XYZ and contain one column which data will be unique across these table. Now I have id with me but don't know in which table this id belongs. Is it possible to fetch record in single query with that id from ABC or XYZ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12818091,"title":"Mysql Query from Two table","body":"<p>Is it possible to join Two queries of mysql in a query ??</p>\n\n<p>Like: </p>\n\n<pre><code>select * from a + select * from b\n</code></pre>\n\n<p>So that I can use them in a single php loop.</p>\n"},{"tags":["sql","query","date","join","greatest-n-per-group"],"answer_count":6,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":2181,"score":11,"question_id":497535,"title":"How do I join the most recent row in one table to another table?","body":"<p>I have data that looks like this:</p>\n\n<pre><code>entities\nid         name\n1          Apple\n2          Orange\n3          Banana\n</code></pre>\n\n<p>Periodically, a process will run and give a score to each entity. The process generates the data and adds it to a scores table like so:</p>\n\n<pre><code>scores \nid  entity_id    score   date_added\n1    1            10       1/2/09\n2    2            10       1/2/09\n3    1            15       1/3/09\n4    2            10       1/03/09\n5    1            15       1/4/09\n6    2            15       1/4/09\n7    3            22       1/4/09\n</code></pre>\n\n<p>I want to be able to select all of the entities along with the most recent recorded score for each resulting in some data like this:</p>\n\n<pre><code>entities\nid name     score  date_added\n1  Apple     15     1/4/09\n2  Orange    15     1/4/09\n3  Banana    15     1/4/09\n</code></pre>\n\n<p>I can get the data for a single entity using this query:</p>\n\n<pre><code>SELECT entities.*, \n       scores.score, \n       scores.date_added \nFROM entities\n\nINNER  JOIN scores\nON entities.id = scores.entity_id\n\nWHERE entities.id = ?\n\nORDER BY scores.date_added DESC\nLIMIT 1\n</code></pre>\n\n<p>But I'm at a loss for how to select the same for all entities. Perhaps it's staring me in the face?</p>\n\n<p>Thank you very kindly for taking the time.</p>\n\n<p>Thanks for the great responses. I'll give it a few days to see if a preferred solution bubbles up then I'll select the answer.</p>\n\n<p>UPDATE:  I've tried out several of the proposed solutions, the main issue I'm facing now is that if an entity does not yet have a generated score they don't appear in the list. </p>\n\n<p>What would the SQL look like to ensure that all entities are returned, even if they don't have any score posted yet?</p>\n\n<p>UPDATE: Answer selected. Thanks everyone!</p>\n"},{"tags":["hibernate","query","table","jpa","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3023,"score":1,"question_id":2228513,"title":"JPA : optimize EJB-QL query involving large many-to-many join table","body":"<p>I'm using Hibernate Entity Manager 3.4.0.GA with Spring 2.5.6 and MySql 5.1.\nI have a use case where an entity called Artifact has a reflexive many-to-many relation with itself, and the join table is quite large (1 million lines). As a result, the HQL query performed by one of the methods in my DAO takes a long time.\nAny advice on how to optimize this and still use HQL ? Or do I have no choice but to switch to a native SQL query that would perform a join between the table ARTIFACT and the join table ARTIFACT_DEPENDENCIES ?</p>\n\n<p>Here is the problematic query performed in the DAO :</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\n   public List&lt;Artifact&gt; findDependentArtifacts(Artifact artifact) {\n      Query query = em.createQuery(\"select a from Artifact a where :artifact in elements(a.dependencies)\");\n      query.setParameter(\"artifact\", artifact);\n      List&lt;Artifact&gt; list = query.getResultList();\n      return list;\n   }\n</code></pre>\n\n<p>And the code for the Artifact entity :</p>\n\n<pre><code>package com.acme.dependencytool.persistence.model;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport javax.persistence.CascadeType;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.FetchType;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.JoinTable;\nimport javax.persistence.ManyToMany;\nimport javax.persistence.Table;\nimport javax.persistence.UniqueConstraint;\n\n@Entity\n@Table(name = \"ARTIFACT\", uniqueConstraints={@UniqueConstraint(columnNames={\"GROUP_ID\", \"ARTIFACT_ID\", \"VERSION\"})})\npublic class Artifact {\n\n   @Id\n   @GeneratedValue\n   @Column(name = \"ID\")\n   private Long id = null;\n\n   @Column(name = \"GROUP_ID\", length = 255, nullable = false)\n   private String groupId;\n\n   @Column(name = \"ARTIFACT_ID\", length = 255, nullable = false)\n   private String artifactId;\n\n   @Column(name = \"VERSION\", length = 255, nullable = false)\n   private String version;\n\n   @ManyToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)\n   @JoinTable(\n         name=\"ARTIFACT_DEPENDENCIES\",\n         joinColumns = @JoinColumn(name=\"ARTIFACT_ID\", referencedColumnName=\"ID\"),\n         inverseJoinColumns = @JoinColumn(name=\"DEPENDENCY_ID\", referencedColumnName=\"ID\")\n   )\n   private List&lt;Artifact&gt; dependencies = new ArrayList&lt;Artifact&gt;();\n\n   public Long getId() {\n      return id;\n   }\n\n   public void setId(Long id) {\n      this.id = id;\n   }\n\n   public String getGroupId() {\n      return groupId;\n   }\n\n   public void setGroupId(String groupId) {\n      this.groupId = groupId;\n   }\n\n   public String getArtifactId() {\n      return artifactId;\n   }\n\n   public void setArtifactId(String artifactId) {\n      this.artifactId = artifactId;\n   }\n\n   public String getVersion() {\n      return version;\n   }\n\n   public void setVersion(String version) {\n      this.version = version;\n   }\n\n   public List&lt;Artifact&gt; getDependencies() {\n      return dependencies;\n   }\n\n   public void setDependencies(List&lt;Artifact&gt; dependencies) {\n      this.dependencies = dependencies;\n   }\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT 1 :\nThe DDLs are generated automatically by Hibernate EntityMananger based on the JPA annotations in the Artifact entity. I have no explicit control on the automaticaly-generated join table, and the JPA annotations don't let me explicitly set an index on a column of a table that does not correspond to an actual Entity (in the JPA sense). So I guess the indexing of table ARTIFACT_DEPENDENCIES is left to the DB, MySQL in my case, which apparently uses a composite index based on both clumns but doesn't index the column that is most relevant in my query (DEPENDENCY_ID).</p>\n\n<pre>\nmysql> describe ARTIFACT_DEPENDENCIES;\n+---------------+------------+------+-----+---------+-------+\n| Field         | Type       | Null | Key | Default | Extra |\n+---------------+------------+------+-----+---------+-------+\n| ARTIFACT_ID   | bigint(20) | NO   | MUL | NULL    |       |\n| DEPENDENCY_ID | bigint(20) | NO   | MUL | NULL    |       |\n+---------------+------------+------+-----+---------+-------+\n</pre>\n\n<p>EDIT 2 :\nWhen turning on showSql in the Hibernate session, I see many occurences of the same type of SQL query, as below :</p>\n\n<pre>\nselect dependenci0_.ARTIFACT_ID as ARTIFACT1_1_, dependenci0_.DEPENDENCY_ID as DEPENDENCY2_1_, artifact1_.ID as ID1_0_, artifact1_.ARTIFACT_ID as ARTIFACT2_1_0_, artifact1_.GROUP_ID as GROUP3_1_0_, artifact1_.VERSION as VERSION1_0_ from ARTIFACT_DEPENDENCIES dependenci0_ left outer join ARTIFACT artifact1_ on dependenci0_.DEPENDENCY_ID=artifact1_.ID where dependenci0_.ARTIFACT_ID=?\n</pre>\n\n<p>Here's what EXPLAIN in MySql says about this type of query :</p>\n\n<pre>\nmysql> explain select dependenci0_.ARTIFACT_ID as ARTIFACT1_1_, dependenci0_.DEPENDENCY_ID as DEPENDENCY2_1_, artifact1_.ID as ID1_0_, artifact1_.ARTIFACT_ID as ARTIFACT2_1_0_, artifact1_.GROUP_ID as GROUP3_1_0_, artifact1_.VERSION as VERSION1_0_ from ARTIFACT_DEPENDENCIES dependenci0_ left outer join ARTIFACT artifact1_ on dependenci0_.DEPENDENCY_ID=artifact1_.ID where dependenci0_.ARTIFACT_ID=1;\n+----+-------------+--------------+--------+-------------------+-------------------+---------+---------------------------------------------+------+-------+\n| id | select_type | table        | type   | possible_keys     | key               | key_len | ref                                         | rows | Extra |\n+----+-------------+--------------+--------+-------------------+-------------------+---------+---------------------------------------------+------+-------+\n|  1 | SIMPLE      | dependenci0_ | ref    | FKEA2DE763364D466 | FKEA2DE763364D466 | 8       | const                                       |  159 |       |\n|  1 | SIMPLE      | artifact1_   | eq_ref | PRIMARY           | PRIMARY           | 8       | dependencytooldb.dependenci0_.DEPENDENCY_ID |    1 |       |\n+----+-------------+--------------+--------+-------------------+-------------------+---------+---------------------------------------------+------+-------+\n</pre>\n\n<p>EDIT 3 :\nI tried setting the FetchType to LAZY in the JoinTable annotation, but I then get the following exception :</p>\n\n<pre><code>Hibernate: select artifact0_.ID as ID1_, artifact0_.ARTIFACT_ID as ARTIFACT2_1_, artifact0_.GROUP_ID as GROUP3_1_, artifact0_.VERSION as VERSION1_ from ARTIFACT artifact0_ where artifact0_.GROUP_ID=? and artifact0_.ARTIFACT_ID=?\n51545 [btpool0-2] ERROR org.hibernate.LazyInitializationException - failed to lazily initialize a collection of role: com.acme.dependencytool.persistence.model.Artifact.dependencies, no session or session was closed\norg.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.acme.dependencytool.persistence.model.Artifact.dependencies, no session or session was closed\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:380)\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:372)\n    at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:119)\n    at org.hibernate.collection.PersistentBag.size(PersistentBag.java:248)\n    at com.acme.dependencytool.server.DependencyToolServiceImpl.createArtifactViewBean(DependencyToolServiceImpl.java:93)\n    at com.acme.dependencytool.server.DependencyToolServiceImpl.createArtifactViewBean(DependencyToolServiceImpl.java:109)\n    at com.acme.dependencytool.server.DependencyToolServiceImpl.search(DependencyToolServiceImpl.java:48)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:527)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:166)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.doPost(RemoteServiceServlet.java:86)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\n    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\n    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729)\n    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\n    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.handler.RequestLogHandler.handle(RequestLogHandler.java:49)\n    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.Server.handle(Server.java:324)\n    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\n    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843)\n    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647)\n    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:205)\n    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)\n    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\n    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)\n</code></pre>\n"},{"tags":["mysql","query","csv","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12768849,"title":"CSV formatted GROUP_CONCAT in MySQL","body":"<p>Let's say I have a <strong>Table A</strong> that I want to transform into <strong>Table B</strong>.</p>\n\n<p>The values in <strong>Table B</strong> should always be a CSV formated text with the <strong>same number of fields</strong>. </p>\n\n<p>First, I need to know what is the <strong>largest number</strong> of values that a given category handles (in this case, <strong>3</strong> values in category 1, 2 and 4);</p>\n\n<p>Secondly I also need to use that variable to \"add\" <strong>empty fields</strong>(\",\") to the end of the GROUP_CONCAT when a category has \"missing\" values.</p>\n\n<p>I need this to have a \"consistent\" CSV in each cell. The application I'm using to process this data doesn't interpret well CSVs with different column number by row...</p>\n\n<p><strong>Table A</strong></p>\n\n<pre><code>+----+----------+-------+\n| id | category | value |\n+----+----------+-------+\n| 1  |    1     |   a   |\n| 2  |    1     |   b   |\n| 3  |    1     |   c   |\n| 4  |    2     |   d   |\n| 5  |    2     |   e   |\n| 6  |    2     |   f   |\n| 7  |    3     |   g   |\n| 8  |    3     |   h   |\n| 9  |    4     |   i   |\n| 10 |    4     |   j   |\n| 11 |    4     |   k   |\n| 12 |    5     |   l   |\n+----+----------+-------+\n</code></pre>\n\n<p><strong>Table B</strong></p>\n\n<pre><code>+--------------+---------------------+\n| id(category) | value(group_concat) |\n+--------------+---------------------+\n|      1       |        a,b,c        |\n|      2       |        d,e,f        |\n|      3       |        g,h,         |\n|      4       |        i,j,k        |\n|      5       |        l,,          |\n+--------------+---------------------+\n</code></pre>\n\n<h2>EDITED (SQLFiddle):</h2>\n\n<p><a href=\"http://sqlfiddle.com/#!2/825f8\" rel=\"nofollow\">http://sqlfiddle.com/#!2/825f8</a></p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":187,"score":-1,"question_id":9592889,"title":"SQL query to find two rows with a same groupID","body":"<p>I need to SELECT all rows (*) in my table between rows with records (TIME = 08.38 AND LINE = 28) AND (TIME = 10.20 AND LINE = 28) only if these two rows has the same GROUP_ID (selected rows must have the same GROUP_ID of these two rows). </p>\n\n<p>db_table example with 4 rows:</p>\n\n<pre><code>       ID       TIME        LINE        GROUP_ID\n        __________________________________________\n    A)  1       08.32       28          5\n    B)  2       09.18       28          5\n    C)  3       10.20       28          5\n    D)  4       10.25       28          6\n</code></pre>\n\n<p>In my example the query must return row B) because ordering rows by ID it is between row A) with records (TIME = 08.32 AND LINE = 28) and row C) with records (TIME = 10.20 AND LINE = 28) and it has the same GROUP_ID = 5.</p>\n\n<p>Anyone can help me?</p>\n"},{"tags":["php","mysql","query","recordset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12821039,"title":"SQL,PHP, multiple tables, recordsets, advise needed","body":"<p>Tbl_bands PRI bid\n    Tbl_Albums PRI aid\n        Tbl_Tracks PRI tid\n            Tbl_Tabs PRI tabid</p>\n\n<p>PHP page for a band:\ni want to dispay all the albums for this band\nunder each album i want to display all the tracks of that album\nunder each track i want to list all the tabs if available assosiated with this track            </p>\n\n<p>What way do you recommend to achieve this with php/mysql</p>\n"},{"tags":["c#","query","linq-to-entities","oracle11g"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12820530,"title":"Entity Framework generates wrong query for Oracle DB. How to find the actual text of the query?","body":"<p>I use Entity Framework with ODP.NET 11.2.0.2.0, on Oracle 11g Express.</p>\n\n<p>I make certain authorization on fetched rows. Rules are written in C# and are used in <code>.Where</code> clause of my results, that is (simplified example):</p>\n\n<pre><code>var results = Source.Where(selectionPredicate);\nvar filtered = results.Where(authPredicate);\nreturn filtered.ToList(); &lt;-- exception thrown\n</code></pre>\n\n<p>It worked quite well, all the rules where translated to SQL. At one point I had to change one of the rules from</p>\n\n<pre><code>(x, y) =&gt; x.Declarations.Any(d =&gt; d.Employment.Id == y)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>(x, y) =&gt; x.Declarations.Any(d =&gt; d.Employment.Substitutions.Any())\n</code></pre>\n\n<p>It is again a simplified example. <code>x</code> is an object I would like to fetch, <code>y</code> is some constant parameter. <code>Declarations</code>, <code>Declarations.Employment</code> and <code>Declarations.Employment.Substitutions</code> are all navigation properties over some foreign keys. The code actually compiles, so these fields are there etc. I know these are massive joins but I don't care at the moment. All of the properties are loaded with <code>Load</code> method.</p>\n\n<p>Please notice, that only the longest navigation property does not work, filtering on <code>Declarations.Employment.Id</code> makes no problems.</p>\n\n<p>The problem is with the error itself. It's <code>System.Data.EntityCommandExecutionException</code> with ORA error <code>{\"ORA-00904: \\\"Extent1\\\".\\\"ID\\\": invalid identifier\"}</code>.</p>\n\n<p>While we do not rely on hand-written SQL, I believe there is a problem with translation process. I would like to see the actual query, for example to know which table is this <code>Extent1</code> (all my relations HAVE <code>ID</code> field...).</p>\n\n<p>When I try to view <code>ObjectSet.ToTraceString()</code> it only shows a basic fetch query with no <code>WHERE</code> clause, so I don't believe it includes the filtering predicates. The query itself is correct.</p>\n\n<p>Usually I retrieved queries from <code>v$sql</code> relation, but it won't contain wrong queries.</p>\n\n<p>How can I find what query is actually being sent to Oracle? Maybe there are tools working as proxies for database?</p>\n\n<p>Any suggestions why such a translations fails?</p>\n"},{"tags":["oracle","query","whitespace"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29567,"score":2,"question_id":1195566,"title":"Oracle - how to remove white spaces?","body":"<p>I am running this statement:</p>\n\n<pre><code>select trim(a),trim(b) from table x;\n</code></pre>\n\n<p>Even though I used the trim() statement, my output looks like this:</p>\n\n<pre><code>A                                                            B                              \n___                                                          ____\nkunjramansingh                                               smartdude\n</code></pre>\n\n<p>The datatype of column 'a' and 'b' is varchar2(255).</p>\n\n<p>There is a gap between the data of two output.  I want to show the data without the whitespace - in a format like this:</p>\n\n<pre><code>A             B\n___           ______ \nkunjramansinghsmartdude\n</code></pre>\n\n<p>How can I do this?</p>\n"},{"tags":["c","database","query","networking","database-server"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":12820101,"title":"Developing a database server: How to send results to a client?","body":"<p>I would like to create my own database server for educational purposes. My problem is, I cannot really find information about how these systems work. Now, I can create databases and tables and get data from it with basic select statements. </p>\n\n<p>But, when a client connects to the database server, how should I send the result of a query back to the client? What format should be used to get good performance? What other things may need to be taken care of, given the specific scenario?</p>\n"},{"tags":["php","mysql","query","sphinx"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":500,"score":2,"question_id":10545778,"title":"Sphinx_Query failed: no enabled local indexes to search","body":"<p>Hi I configured sphinx search in my test server.</p>\n\n<p>Now I am getting this kind of an error \"Sphinx_Query failed: no enabled local indexes to search\". </p>\n\n<p>I am not getting why this error. Any body can help me plese.</p>\n\n<p>This is my sphinx conf</p>\n\n<pre><code>source objectcollection\n{\n    type                    = mysql\n    sql_host                = localhost\n    sql_user                = root\n    sql_pass                = root\n    sql_db                  = mydatabase\n    sql_port                = 3306  \n\n    sql_query                       = \\\n        SELECT id, id as mid  obtype_id, searchtext from tab_objectcollection;\n\n    sql_attr_uint           = mid\n    sql_attr_uint           = obtype_id\n    sql_query_info      = SELECT * FROM tab_objectcollection WHERE id=$id\n\n}\n\n\nindex combinedobject\n{\n    source              = objectcollection\n    path                = /usr/local/sphinx/var/data/objectcollection\n    morphology          = stem_en\n    min_stemming_len    = 4\n    stopwords           = /usr/local/sphinx/var/data/stopwords.txt\n    min_word_len        = 3\n    min_prefix_len      = 3\n    min_infix_len       = 0\n    enable_star         = 1\n    phrase_boundary = ., ?, !, U+2026 # horizontal ellipsis\n    phrase_boundary_step = 100\n    html_strip = 1\n\n}\n\n\nindexer\n{\n        # memory limit, in bytes, kiloytes (16384K) or megabytes (256M)\n        # optional, default is 32M, max is 2047M, recommended is 256M to 1024M\n        mem_limit = 256M\n\n        # maximum xmlpipe2 field length, bytes\n        # optional, default is 2M\n        #\n        max_xmlpipe2_field = 16M\n\n\n        # write buffer size, bytes\n        # several (currently up to 4) buffers will be allocated\n        # write buffers are allocated in addition to mem_limit\n        # optional, default is 1M\n        #\n        #write_buffer = 16M\n}\n\nsearchd\n{\n    listen              = 3312\n    max_matches         = 10000\n    log                 = /usr/local/sphinx/var/log/searchd.log\n    query_log           = /usr/local/sphinx/var/log/query.log\n    pid_file            = /usr/local/sphinx/var/log/searchd.pid\n}\n</code></pre>\n\n<p>Thanks\nShobin sukumaran</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":61,"score":0,"question_id":12791107,"title":"Order of WHERE conditions in SQL query makes difference","body":"<p>I have two SQL tables <code>Student</code> and <code>Class</code>. </p>\n\n<p>In <code>Student</code> table, the fields are <code>studentNo, studentName, classNo</code></p>\n\n<p>In <code>Class</code> table, fields are <code>classNo, className, teacherName</code></p>\n\n<p>what I am trying to do is construct a query to list all students who are in the <code>history</code> class.</p>\n\n<p>Here is my query:</p>\n\n<pre><code>SELECT studentName\nFROM Student s, Class c\nWHERE s.classNo = c.classNo AND\n   c.className = ‘history’;\n</code></pre>\n\n<p>But I am not 100% sure about the above query. and I am thinking maybe the following one can work than the above one:</p>\n\n<pre><code>SELECT studentName\nFROM Student s, Class c\nWHERE c.className = ‘history’ AND\n   s.classNo = c.classNo;\n</code></pre>\n\n<p>Can anyone help me find the correct query to this problem? thank you</p>\n"},{"tags":["php","sql","query","pagination"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12818275,"title":"How to create pagination that based on two sql queries? (PHP)","body":"<p>I have page that display information from two different tables , and for that I have two queries.\nThere is no related info between these two tables.\nSince both queries may contain a lot of information, I need create pagination.\nBUT I don't want two separate paginations, I want only one that will contain results from query 1 and query 2 together.</p>\n\n<p>How can I do that?</p>\n\n<p>The only idea I have is to fetch all info of both queries into arrays, then combine the arrays into one, then create pagination that based on that array.\nThat of course would not help save resources.</p>\n"},{"tags":["oracle","query","table","alter"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12817599,"title":"Alter table modify column vs. multiply values query","body":"<p>My application interacts with an Oracle database in which a table has 1 million records.The problem is:</p>\n\n<p>In that table we have a column for numeric integer types.We want to store float values(2 digits).We could do that by multiplying with 100(from the application) and store them in that column or modify the column data type.The question is :</p>\n\n<p>What takes less time?\nThe alter table modify column or the query (update table set column = 100*val).</p>\n\n<p>Thanks :).</p>\n"},{"tags":["query","vba","if-statement","nested","statement"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12815918,"title":"VBA - Creating filter criteria from nested query","body":"<p>I am trying to create a filter criteria which checks the data and if it matches then it will print the data.\nI have the following and I get type mismatch error. for cTest.\nI have also tried the following (without quotes- but then it returns false): cTest = (InStr(getName(iVar), a1) > 0)</p>\n\n<p>Is there an easier way to create the filter criteria.</p>\n\n<p>If fields a1, a2, and a3 are filled in the criteria should check that the value contains all there before returning anything.</p>\n\n<pre><code>  Dim cTest As Variant\n\nIf a1 &lt;&gt; \"\" Or a2 &lt;&gt; \"\" Or a3 &lt;&gt; \"\" Then\nIf a1 &lt;&gt; \"\" Then\n  If a2 &lt;&gt; \"\" Then\n   If a3 &lt;&gt; \"\" Then\n   'Value entered in 1,2,3\n    cTest = \"(InStr(getName(iVar), a1) &gt; 0) And (InStr(getName(iVar), a2) &gt; 0) And (InStr(getName(iVar), a3) &gt; 0)\"\n    End If\n    ' Value entered in 1,2\n    cTest = \"(InStr(getName(iVar), a1) &gt; 0) And (InStr(getName(iVar), a2) &gt; 0)\"\n      End If\n      '(Value entered in 1 only\n   cTest = \"(InStr(getName(iVar), a1) &gt; 0)\"\nElseIf a2 &lt;&gt; \"\" Then\n  If a3 &lt;&gt; \"\" Then\n    'Value entered in 2,3\n    MsgBox (\"2nd, 3rd value entered\")\n  End If\n   ' Value entered in 2 only\nElseIf a3 &lt;&gt; \"\" Then\n    'Value entered in 3 only\n     MsgBox (\"3rd value entered\")\nElse\n     ' no value entered\n     MsgBox (\"no value entered\")\nEnd If\nEnd If\n\nFor iVar = 1 To Phrases.MaxIndex()\n\n\n        If (cTest) Then\n        'We want this one\n        .Cells(irow, 1).Value = getName(iVar)\n        irow = irow + 1\n      End If\n    Next iVar\n\n  End With\n</code></pre>\n"},{"tags":["mysql","query","substring"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12817664,"title":"How can I query all results matching a simple substring in MySQL?","body":"<p>This should be so simple but I must be missing something obvious.</p>\n\n<p>Table:</p>\n\n<pre><code>id    name\n===============\n1     Allison\n2     BethAnn\n3     Carly\n4     MaryAnn\n</code></pre>\n\n<p>Test Query:</p>\n\n<pre><code>SELECT id,SUBSTRING(name,5) FROM my_table;\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>1    son\n2    Ann\n3    y\n4    Ann\n</code></pre>\n\n<p>Great.  Now just get the id's where the characters 5+ = 'Ann':</p>\n\n<pre><code>SELECT id FROM my_table WHERE SUBSTRING(name,5) = 'Ann';\n</code></pre>\n\n<p>Expected Result:</p>\n\n<pre><code>2\n4\n</code></pre>\n\n<p>Instead I get nothing.  What am I missing?</p>\n\n<p>Waiting for facepalm.  Thanks in advance.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12715741,"title":"Sql select union with count","body":"<p>I have a stored procedure which returns rows with a bunch of unions. What I am trying to do is see if the select statement does not yield any rows, and if so, execute another script.</p>\n\n<p>This is the current sql select I am using in the stored procedure. Please let me know how I can achieve this.</p>\n\n<pre><code>SELECT  name AS [Name],  address1 AS Address1, address2 AS Address2, city AS City,  1 AS DeliveryTypeKey, email AS Email,  \n  ( SELECT TOP 1   c_phone_number   \n    FROM phone WITH (NOLOCK)  \n    WHERE value = @value) AS Fax \n    FROM #Cities x    \n INNER JOIN prov p WITH (NOLOCK) ON x.ckey = p.pkey  \n UNION \nSELECT  name AS [Name], address1 AS Address1, address2 AS Address2, city AS City,  1 AS DeliveryTypeKey, email AS Email,  \n  ( SELECT TOP 1 c_phone_number   \n    FROM phone WITH (NOLOCK)  \n    WHERE value = @value) AS Fax \n    FROM #Cities1 x    \n    INNER JOIN prov1 p WITH (NOLOCK) ON x.ckey = p.pkey  \n UNION \n SELECT  name AS [Name], address1 AS Address1, address2 AS Address2, city AS City,  1 AS DeliveryTypeKey, email AS Email,  \n  ( SELECT TOP 1 c_phone_number   \n    FROM phone WITH (NOLOCK)  \n    WHERE value = @value) AS Fax \n FROM #Cities2 x    \n INNER JOIN prov2 p WITH (NOLOCK) ON x.ckey = p.pkey \n</code></pre>\n"},{"tags":["query","vba","combobox","ms-access-2010","subforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12814810,"title":"Driving a MS Access query in a subform form from the main form","body":"<p>I have a subform in datasheet form.</p>\n\n<p>I want this subform to be filtered based on a combo box on the mainform.\nThe data for the subform comes from a query. I have set the criteria of one of the fields of this query to be equal to:</p>\n\n<pre><code>    [Forms]![Form_Data_Update]![cbo_ReportSelection]\n</code></pre>\n\n<p>The mainform is Form_Data_Update and the combo box is cbo_ReportSelection.</p>\n\n<p>to make the subform refresh when I change the combo box I have put in </p>\n\n<pre><code>    Private Sub cbo_ReportSelection_AfterUpdate()\n    DoCmd.OpenQuery (\"Aggregate_Leanboard_Discipline_Grouping\")\n    End Sub\n</code></pre>\n\n<p>Is there an alternate way that does not result in the query opening up in a new tab? I want it to just refresh in the subform. I tried:</p>\n\n<pre><code>    Me!Form_Leanboard_Discipline_Grouping_Subform.Requery\n</code></pre>\n\n<p>but that doesn't work i get an error '2465' Microsoft can't find the field 'Form_Leanboard_Discipline_Grouping_Subform'.</p>\n\n<p>I am using Access 2010.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12804225,"title":"Optimizing a query on large dataset - with JOIN or IN?","body":"<p>Given i have articles which are tagged, one article can have n tags.\nCurrently there are around 250k tag-entries which all point back \nonto their belonging article.</p>\n\n<p>Now i want to find all tags from articles matching certain criteria. \nI came up with two different approaches. Both which have drawbacks and are slow.\nMay be someone can point me in the right direction on how to speed them up or even come\nup with a better solution.  </p>\n\n<p><strong>Keys (ind,rindex) are varchar(255) unfortunately this cant be changed</strong></p>\n\n<h2>Query #1</h2>\n\n<p>taking 7.5  - subselect returns 60 records in 50ms</p>\n\n<pre><code>SELECT count(*) AS tagscount, tags.value FROM tags \n  WHERE tags.`rindex` IN \n  ( \n    SELECT article.ind \n       FROM article \n       INNER JOIN struktur ON (struktur.ind = article.struktur) \n    WHERE article.date = '2011-12-21'\n  ) \n  AND tags.`rtable` = 'article'\n  GROUP BY tags.value ORDER BY tagscount DESC LIMIT 20\n</code></pre>\n\n<h2>Query #2</h2>\n\n<p>taking 60ms</p>\n\n<pre><code>SELECT count(*) AS tagscount, tags.value FROM tags \n  INNER JOIN article ON (article.ind = tags.rindex AND tags.rtable = 'article')\n  LEFT JOIN structure ON (article.structure = structure.ind)\nWHERE article.date = '2011-12-21'\nGROUP BY tags.value ORDER BY tagscount DESC LIMIT 20 \n</code></pre>\n\n<h2>The Strange Part - <em>Important</em></h2>\n\n<p>When i change <code>article.date = '2011-12-21'</code> into <code>article.date &gt;= '2009-12-21'</code><br>\n<strong>Query #1</strong></p>\n\n<ul>\n<li>taking 10.1s - subselect returns 18k rows in 70ms   </li>\n</ul>\n\n<p><strong>Query #2</strong>  </p>\n\n<ul>\n<li>taking 14.2s</li>\n</ul>\n\n<p>If you need further information i'll be happy to provide</p>\n\n<h1>SCHEMAS</h1>\n\n<pre><code>mysql&gt; SHOW COLUMNS FROM tags;\n+---------+--------------+------+-----+---------+-------+\n| Field   | Type         | Null | Key | Default | Extra |\n+---------+--------------+------+-----+---------+-------+\n| ind     | varchar(255) | NO   | PRI |         |       |\n| rtable  | varchar(255) | NO   | MUL |         |       |\n| rindex  | varchar(255) | NO   | MUL |         |       |\n| value   | varchar(40)  | YES  | MUL | NULL    |       |\n+---------+--------------+------+-----+---------+-------+\n\nmysql&gt; SHOW indexes FROM tags\n+-------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+\n| Table | Non_unique | Key_name            | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |\n+-------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+\n| tags  |          0 | tags_ind            |            1 | ind         | A         |      275834 |     NULL | NULL   |      | BTREE      |         |\n| tags  |          1 | tags_tag            |            1 | tag         | A         |       27583 |     NULL | NULL   | YES  | BTREE      |         |\n| tags  |          1 | tags_rindex         |            1 | rindex      | A         |       55166 |     NULL | NULL   |      | BTREE      |         |\n| tags  |          1 | tags_rindex_tabelle |            1 | tabelle     | A         |           4 |       30 | NULL   |      | BTREE      |         |\n| tags  |          1 | tags_rindex_tabelle |            2 | rindex      | A         |       55166 |       50 | NULL   |      | BTREE      |         |\n+-------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+\n\nmysql&gt; SHOW COLUMNS FROM structure;\n+------------------------+--------------+------+-----+---------+-------+\n| Field                  | Type         | Null | Key | Default | Extra |\n+------------------------+--------------+------+-----+---------+-------+\n| ind                    | varchar(255) | NO   | PRI |         |       |\n+------------------------+--------------+------+-----+---------+-------+\n\nmysql&gt; SHOW COLUMNS FROM artikel;\n+--------------------+--------------+------+-----+------------+-------+\n| Field              | Type         | Null | Key | Default    | Extra |\n+--------------------+--------------+------+-----+------------+-------+\n| ind                | varchar(255) | NO   | PRI |            |       |\n| date               | date         | NO   | MUL | 0000-00-00 |       |\n+--------------------+--------------+------+-----+------------+-------+\n</code></pre>\n\n<h1>EXPLAIN</h1>\n\n<pre><code>mysql&gt; explain #1\n+----+--------------------+----------+--------+-------------------------------------------------------------------------------------+---------------------+---------+---------------------+--------+----------------------------------------------+\n| id | select_type        | table    | type   | possible_keys                                                                       | key                 | key_len | ref                 | rows   | Extra                                        |\n+----+--------------------+----------+--------+-------------------------------------------------------------------------------------+---------------------+---------+---------------------+--------+----------------------------------------------+\n|  1 | PRIMARY            | tags     | ref    | tags_rindex_tabelle                                                                 | tags_rindex_tabelle | 32      | const               | 177175 | Using where; Using temporary; Using filesort |\n|  2 | DEPENDENT SUBQUERY | artikel  | eq_ref | artikel_ind,zeitraum_start_i,freigabe_i,korrektur_i,struktur_i,artikel_start_slot_i | artikel_ind         | 257     | func                |      1 | Using where                                  |\n|  2 | DEPENDENT SUBQUERY | struktur | eq_ref | struktur_ind,struktur_host                                                          | struktur_ind        | 257     | ec.artikel.struktur |      1 | Using where                                  |\n+----+--------------------+----------+--------+-------------------------------------------------------------------------------------+---------------------+---------+---------------------+--------+----------------------------------------------+\nmysql&gt; explain #2\n+----+-------------+----------+--------+-------------------------------------------------------------------------------------+---------------------+---------+---------------------+--------+----------------------------------------------+\n| id | select_type | table    | type   | possible_keys                                                                       | key                 | key_len | ref                 | rows   | Extra                                        |\n+----+-------------+----------+--------+-------------------------------------------------------------------------------------+---------------------+---------+---------------------+--------+----------------------------------------------+\n|  1 | SIMPLE      | tags     | ref    | tags_rindex,tags_rindex_tabelle                                                     | tags_rindex_tabelle | 32      | const               | 177175 | Using where; Using temporary; Using filesort |\n|  1 | SIMPLE      | artikel  | eq_ref | artikel_ind,zeitraum_start_i,freigabe_i,korrektur_i,struktur_i,artikel_start_slot_i | artikel_ind         | 257     | ec.tags.rindex      |      1 | Using where                                  |\n|  1 | SIMPLE      | struktur | eq_ref | struktur_ind,struktur_host                                                          | struktur_ind        | 257     | ec.artikel.struktur |      1 | Using where                                  |\n+----+-------------+----------+--------+-------------------------------------------------------------------------------------+---------------------+---------+---------------------+--------+----------------------------------------------+\n</code></pre>\n"},{"tags":["database","query","mvc","kohana","prepared-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12810106,"title":"Kohana parameterised execution of query within view","body":"<p>I'm just trying to get my head around Kohana, so if I'm going about this the wrong way, let me know!</p>\n\n<p>I want to group results in my output. The way I did this in vanilla-PHP / PDO was to prepare a query, and then execute it within the output results. I can't get there in Kohana (3.2.2), though.</p>\n\n<p>In this case, on my 'terms' page, I want to group 'terms' by 'type', with each group of terms separated by a 'type' header.</p>\n\n<p>My 'terms' controller is (simplified):</p>\n\n<pre><code>class Controller_Terms extends Controller {\n\n  public function action_index() \n  {\n    $view = View::factory('terms');\n\n    // types of term - for grouping terms together\n    $sql = 'SELECT DISTINCT Type \n            FROM Term';\n    $view-&gt;types = DB::query(Database::SELECT, $sql)-&gt;as_object()-&gt;execute();\n\n    // list of terms - executed separately for each type\n    $sql = 'SELECT TermId, Term\n            FROM Term\n            WHERE Type = :type';\n    $view-&gt;terms = DB::query(Database::SELECT, $sql)-&gt;as_object();\n\n    $this-&gt;response-&gt;body($view);\n  }\n\n}\n</code></pre>\n\n<p>And the 'terms' view includes (simplified):</p>\n\n<pre><code>&lt;? foreach ($types as $type): ?&gt;\n&lt;h2&gt;&lt;?= $type-&gt;Type ?&gt;&lt;/h2&gt;\n&lt;? $params = array(':type' =&gt; $type-&gt;Type);\n   $terms-&gt;parameters($params)-&gt;execute(); \n   foreach ($terms as $term): ?&gt;\n    &lt;a href=\"term/&lt;?= $term-&gt;TermId ?&gt;\"&gt;&lt;?= $term-&gt;Term ?&gt;&lt;/a&gt;\n&lt;? endforeach // term ?&gt;\n&lt;? endforeach // type ?&gt;\n</code></pre>\n\n<p>I get the 'type' headers ok, but I don't get any terms within each type.</p>\n\n<p>Any suggestions appreciated!</p>\n"},{"tags":["javascript","string","query","forms","get"],"answer_count":10,"favorite_count":3,"up_vote_count":12,"down_vote_count":0,"view_count":12015,"score":12,"question_id":316781,"title":"How to build query string with Javascript","body":"<p>Just wondering if there is anything built-in to Javascript that can take a Form and return the query parameters, eg: \"var1=value&amp;var2=value2&amp;arr[]=foo&amp;arr[]=bar...\"</p>\n\n<p>I've been wondering this for years.</p>\n"},{"tags":["python","xml","query","minidom"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12815637,"title":"Python Minidom XML Query","body":"<p>I'm trying to query this XML with lxml:</p>\n\n<pre><code>&lt;lista_tareas&gt;\n    &lt;tarea id=\"1\" realizzato=\"False\" data_limite=\"12/10/2012\" priorita=\"1\"&gt;\n    &lt;description&gt;XML TEST&lt;/description&gt;\n&lt;/tarea&gt;\n&lt;tarea id=\"2\" realizzato=\"False\" data_limite=\"12/10/2012\" priorita=\"1\"&gt;\n    &lt;description&gt;XML TEST2&lt;/description&gt;\n&lt;/tarea&gt;\n</code></pre>\n\n<p>\nI wrote this code:</p>\n\n<pre><code>from lxml import etree\ndoc = etree.parse(file_path)    \n\nroot = etree.Element(\"lista_tareas\")\n\nfor x in root:\n    z = x.Element(\"tarea\")\n    for y in z:\n        element_text = y.Element(\"description\").text\n        print element_text\n</code></pre>\n\n<p>It doesn't print anything, could you suggest me how to do?</p>\n\n<p>Thanks a lot!</p>\n"},{"tags":["android","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12814732,"title":"SQL how many items of certain level are correct (query issue)?","body":"<p>To make a big sql structure simple: I am having next structure:</p>\n\n<pre><code>id    level    answercorrect    points\n1     1        0                0\n2     1        1                60\n3     1        1                80\n4     1        1                77\n5     1        1                92\n6     1        0                0\n7     2        0                0\n8     2        0                0\n9     2        0                0\n10    2        1                80\n11    2        0                0\n12    2        0                0\n</code></pre>\n\n<p>I now want to display two things: </p>\n\n<p><strong>1)</strong> how many levels were completed (this is min. half of the questions correct)</p>\n\n<p><strong>2)</strong> the level where you scored the most points. </p>\n\n<p>Now I can go and manually do a query for each level, then compare them and then output them. </p>\n\n<pre><code>SELECT (*) FROM QUESTIONS WHERE LEVEL = level AND ANSWERCORRECT = 1\n</code></pre>\n\n<p>But Is there a way to do this quicker? It just seems like a to big bunch of code to accomplish that on my way..?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12814346,"title":"MySQL slow query from intranet","body":"<p>This is a problem a friend of mine has. </p>\n\n<p>He has a table <code>keyword</code> with only <code>9000</code> records. The <code>MySQL</code> server has a public ip and when I execute <code>SELECT id, word FROM keyword</code> from my machine(I access the <code>MySQL</code> server over the Internet), the query is very fast(200 milliseconds). No matter how many times I run it, it is very fast as it should be. So far so good.</p>\n\n<p>Now he runs the same query from his machine in his intranet and accesses the <code>MySQL</code> server again with the public ip. The query sometimes takes as much as <code>40</code> seconds and it is logged as a slow query in the <code>MySQL</code> server log. He tried also from another machine in his intranet and again it takes sometimes as much as <code>40</code> seconds.</p>\n\n<p>How is this possible? If it is a network problem only in his intranet, then why <code>MySQL</code> logs it as a slow query? AFAIK, <code>MySQL</code> query time in the slow query log doesn't include network transfer?</p>\n\n<p>How to troubleshoot this problem? I am really frustrated.</p>\n\n<p>Greetings,</p>\n\n<p>Petar</p>\n"},{"tags":["mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":53,"score":-2,"question_id":12812756,"title":"encrypt password in database","body":"<p>This question might have been asked many times. But, my requirement is some what different here</p>\n\n<p>We have a column in database which contains info like ipaddress,username,password.</p>\n\n<p>I am aware that we can encrypt complete column, but is it possible to encrypt only part of string.</p>\n\n<p>Here I need to encrypt only password, ipaddress and username should be as it is\nAnd this table will be updated by user manually. Once user enters his details and clicks on Apply button in mysql the password should get encrypted.</p>\n"},{"tags":["php","mysql","query","table","results"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":76,"score":-1,"question_id":12813011,"title":"Why isn't my MySQL data being displayed in my table?","body":"<p>Ok, my question is: Why is my MySQL data not being displayed in my table?  Everything seems to work fine except that my data (which is a list of bird names and such) isn't showing up.  I need some fresh eyes who can see where my mistake is. And yes I know that there are probably easier ways to do this but this is what is required for my assignment so please don't offer other ways to do this.  All I need is help getting my data to populate in the HTML table.  Thank you, Jason  My php code is below:</p>\n\n<p>PHP Code</p>\n\n<pre><code>&lt;?php\n    $pageTitle = 'Mod06 Pagination| Jason McCoy ';\n    include('includes/header.inc.php');\n    include ('includes/db_connect.inc.php');\n\n    $display = 8;\n\n    // Determine how many pages there are...\n\n    if (isset($_GET['p']) &amp;&amp; is_numeric($_GET['p'])) { // Already been determined.\n        $pages = $_GET['pages'];\n    } else { \n        $query = \"SELECT COUNT(birdID) FROM birds\";\n        $result = @mysqli_query($dbc, $query);\n        $row = @mysqli_fetch_array($result, MYSQLI_NUM);\n        $records = $row[0];\n    }\n\n    // Calculate the number of pages...\n\n    if ($records &gt; $display) { \n        $pages = ceil($records/$display);\n    } else {\n        $pages = 1;\n    }\n\n    // Determine where in the database to start returning results...\n\n    if (isset($_GET['s']) &amp;&amp; is_numeric($_GET['s'])) {\n        $start = $_GET['s'];\n    } else {\n        $start = 0;\n    }\n\n    // Sort the columns \n    // Default is birdID\n\n        $sortDefault = 'birdID';\n\n        // Create an array for the columns\n\n        $sortColumns = array('birdID', 'nameGeneral', 'nameSpecific', 'populationTrend');\n\n        // Define sortable query ASC DESC\n\n        $sort =  (isset($_GET['sort'])) &amp;&amp; in_array($_GET['sort'], $sortColumns) ? $_GET['sort']: $sortDefault;\n        $order = (isset($_GET['order']) &amp;&amp; strcasecmp($_GET['order'], 'DESC') == 0) ? 'DESC' : 'ASC';\n\n        // Run the query \n\n    $query = \"SELECT birdID, nameGeneral, nameSpecific, populationTrend FROM birds ORDER BY $order LIMIT $start, $display\";\n    $result = @mysqli_query($dbc, $query);       \n?&gt;\n\n    &lt;!-- Table header: --&gt;\n    &lt;table align=\"center\" cellspacing=\"0\" cellpadding=\"5\" width=\"80%\"&gt;\n        &lt;tr&gt;\n            &lt;th&gt;&lt;a href='index.php?sort=birdID&amp;order=&lt;?php echo $order == 'DESC' ? 'ASC' : 'DESC' ?&gt;'&gt;Bird&lt;?\n                            if($_GET[\"order\"]==\"ASC\" &amp;&amp; $_GET[\"sort\"]==\"birdID\"){\n                                echo '&lt;img src=\"images/downArrow.jpg\" id=\"birdASC\" name=\"birdASC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                            } else {\n                    echo '&lt;img src=\"images/upArrow.jpg\" id=\"birdDESC\" name=\"birdDESC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                }?&gt;&lt;/a&gt;&lt;/th&gt;\n            &lt;th&gt;&lt;a href='index.php?sort=nameGeneral&amp;order=&lt;?php echo $order == 'DESC' ? 'ASC' : 'DESC' ?&gt;'&gt;General Name&lt;?\n                            if($_GET[\"order\"]==\"ASC\" &amp;&amp; $_GET[\"sort\"]==\"nameGeneral\"){\n                                echo '&lt;img src=\"images/downArrow.jpg\" id=\"nameGeneralASC\" name=\"nameGeneralASC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                            } else {\n                    echo '&lt;img src=\"images/upArrow.jpg\" id=\"nameGeneralDESC\" name=\"birdDESC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                }?&gt;&lt;/a&gt;&lt;/th&gt;\n            &lt;th&gt;&lt;a href='index.php?sort=nameSpecific&amp;order=&lt;?php echo $order == 'DESC' ? 'ASC' : 'DESC' ?&gt;'&gt;Name Specific&lt;?\n                            if($_GET[\"order\"]==\"ASC\" &amp;&amp; $_GET[\"sort\"]==\"nameSpecific\"){\n                                echo '&lt;img src=\"images/downArrow.jpg\" id=\"nameSpecificASC\" name=\"nameSpecificASC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                            } else {\n                    echo '&lt;img src=\"images/upArrow.jpg\" id=\"nameSpecificDESC\" name=\"birdDESC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                }?&gt;&lt;/a&gt;&lt;/th&gt;\n            &lt;th&gt;&lt;a href='index.php?sort=populationTrend&amp;order=&lt;?php echo $order == 'DESC' ? 'ASC' : 'DESC' ?&gt;'&gt;Population Trend&lt;?\n                            if($_GET[\"order\"]==\"ASC\" &amp;&amp; $_GET[\"sort\"]==\"populationTrend\"){\n                                echo '&lt;img src=\"images/downArrow.jpg\" id=\"populationTrendASC\" name=\"populationTrendASC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                            } else {\n                    echo '&lt;img src=\"images/upArrow.jpg\" id=\"populationTrendDESC\" name=\"birdDESC\" style=\"margin:-15px 0 0 13px;\" width=\"18px\" height=\"18px\"&gt;';\n                }?&gt;&lt;/a&gt;&lt;/th&gt;\n        &lt;/tr&gt;\n&lt;?php\n\n    // Display the database results in the table...\n\n    while ($row = @mysqli_fetch_array($result, MYSQL_ASSOC)) {\n        echo '&lt;tr&gt;\n            &lt;td align=\"left\"&gt;$row[birdID]&lt;/td&gt;\n            &lt;td align=\"left\"&gt;$row[nameGeneral]&lt;/td&gt;\n            &lt;td align=\"left\"&gt;$row[nameSpecific]&lt;/td&gt;\n            &lt;td align=\"left\"&gt;$row[populationTrend]&lt;/td&gt;\n         &lt;tr&gt;';\n    } \n\n    echo '&lt;/table&gt;';    \n    mysqli_close($dbc);\n\n    // Make the links to other pages, if necessary.\n    if ($pages &gt; 1) {\n        echo '&lt;br /&gt;&lt;p&gt;';\n        $currentPage = ($start/$display) + 1;\n    // If it's not the first page, make a Previous button:\n    if ($currentPage != 1) {\n        echo '&lt;a href=\"index.php?s=' . ($start - $display) . '&amp;pages=' . $pages . '&amp;sort=' . $sort . '\"&gt;Previous&lt;/a&gt; ';\n    }\n    // Make all the numbered pages:\n    for ($i = 1; $i &lt;= $pages; $i++) {\n        if ($i != $currentPage) {\n            echo '&lt;a href=\"index.php?s=' . (($display * ($i - 1))) . '&amp;pages=' . $pages . '&amp;sort=' . $sort . '\"&gt;' . $i . '&lt;/a&gt; ';\n        } else {\n            echo $i . ' ';\n        }\n    } // End of FOR loop.\n\n    // If it's not the last page, make a Next button:\n    if ($currentPage != $pages) {\n        echo '&lt;a href=\"index.php?s=' . ($start + $display) . '&amp;pages=' . $pages . '&amp;sort=' . $sort . '\"&gt;Next&lt;/a&gt;';\n    }\n\n    echo '&lt;/p&gt;'; \n\n} \n\n    include('includes/footer.inc.php');\n?&gt;\n\n\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["query","media","responsive-design"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12811458,"title":"Media queries loading styles from higher resolution stylesheet - why?","body":"<p>Please can someone point me in the right direction! I can't get the queries to work as intended.</p>\n\n<p>So, I have for example:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" href=\"/480.css\" type=\"text/css\" media=\"screen and (max-width:480px)\" /&gt;\n&lt;link rel=\"stylesheet\" href=\"/768.css\" type=\"text/css\" media=\"screen and (max-width:768px)\" /&gt;\n&lt;link rel=\"stylesheet\" href=\"/960.css\" type=\"text/css\" media=\"screen and (min-width:960px)\" /&gt;\n</code></pre>\n\n<p>In the 480 stylesheet:</p>\n\n<pre><code>#box{width:100px;height:100px;}\n</code></pre>\n\n<p>In the 960 stylesheet:</p>\n\n<pre><code>#box{width:200px;height:200px;}\n</code></pre>\n\n<p>When I resize the browser to 480px or less the 960 style is overriding the 480 style. I have tried loading all queries in the one stylesheet and I've tried using separate stylesheets for different resolutions but still not working. When testing it in either Chrome or FF Aurora it makes no difference. </p>\n\n<p>What am I doing wrong? Thanks!</p>\n"},{"tags":["sql","query","casting","int","varchar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12801446,"title":"casting varchar to numeric in case of null","body":"<p>How do I handle this conversion if the value is null, so that it does not give the error \"Error converting data type varchar to numeric\".</p>\n\n<pre><code>convert(numeric(19,2), mdmaster.check_no)as checkNbr,\n</code></pre>\n\n<p>Thanx </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":12810346,"title":"Alternative to using LIMIT keyword in a SubQuery in MYSQL","body":"<p>I have a table TEST with the following columns : \ncode_ver (VARCHAR)\nsuite (VARCHAR)\ndate (DATE)</p>\n\n<p>Now I want to select 10 rows with a distinct value of code_ver &amp; code_ver NOT LIKE '%DevBld%' sorted by date desc.</p>\n\n<p>So I wrote the following query:</p>\n\n<pre><code>select * \n  from test \n where code_ver IN (select DISTINCT code_ver \n                      from test \n                     where code_ver NOT LIKE '%DevBld%' \n                     ORDER by date DESC LIMIT 10);\n</code></pre>\n\n<p>This query should ideally work, but my version of MySQL says : This version of MySQL doesn't yet support 'LIMIT &amp; IN/ALL/ANY/SOME subquery'</p>\n\n<p>Can someone suggest me an alternative to this query?</p>\n"},{"tags":["ruby-on-rails","performance","query","many-to-many","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":12806991,"title":"Rails: Find entity by many-to-many association","body":"<p>I have a model A, and a model B. A <code>has_and_belongs_to_many</code> Bs, and vice versa.</p>\n\n<p>Now, I want to find an object/entity within A that has_and_belongs_to certain objects within B (say B1 and B2). How can I do that <em>efficiently</em> within Rails? My current solution is something like this:</p>\n\n<pre><code>A.all.select {|a| a.bs.sort == [B1, B2]}.first\n</code></pre>\n\n<p>It basically iterates through <em>all</em> objects within A and checks if it <code>has_and_belongs_to</code> the correct Bs. That is very inefficient. Is there a better way to do this?</p>\n"},{"tags":["android","database","query","sqlite","android-sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12809214,"title":"Sum query in sqlite in android","body":"<p>I'm new to java,android and sqlite and i'm stuck at this.\nI have columns namely _id,type,amount(int),category,description.what i'm trying is to fetch the sum of amount of a particular category and store them in int.\ni know i need to provide the errors but it is simply giving me force close.Please Help</p>\n\n<pre><code> public class TransactionReport extends Activity {\nprivate static SQLiteDatabase db;\nCursor c;\nint amount;\nDbCrud localDbCrud = new DbCrud(this);\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    // TODO Auto-generated method stub\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.report);\n    localDbCrud.open();                //localDatabase = localDbHelper.getWritableDatabase();  return this;\n    c.moveToFirst();\n    do{\n        c = db.rawQuery(\"select sum(amount) from transaction_table where category = Salary ;\", null);\n\n\n      }while(c.moveToNext());\n\n    amount = c.getInt(0);\n    c.close();\n    TextView ltxt = (TextView) findViewById(R.id.amt);\n    ltxt.setText(\"\"+amount);\n    localDbCrud.close();  //localDatabase.close();\n\n\n}\n\n}\n</code></pre>\n\n<p>Would be helpful if explained in detail as i am a complete noob and i did try to find the solution but didnt find any.Thanks in advance</p>\n\n<pre><code>10-10 03:55:29.828: E/AndroidRuntime(10229): FATAL EXCEPTION: main\n10-10 03:55:29.828: E/AndroidRuntime(10229): java.lang.RuntimeException: Unable to      start activity   ComponentInfo{com.hishighness.budgetracker/com.hishighness.budgetracker.TransactionReport}:     java.lang.NullPointerException\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at  android.app.ActivityThread.access$1500(ActivityThread.java:117)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.os.Handler.dispatchMessage(Handler.java:99)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.os.Looper.loop(Looper.java:130)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.app.ActivityThread.main(ActivityThread.java:3687)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at java.lang.reflect.Method.invokeNative(Native Method)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at java.lang.reflect.Method.invoke(Method.java:507)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at dalvik.system.NativeStart.main(Native Method)\n10-10 03:55:29.828: E/AndroidRuntime(10229): Caused by: java.lang.NullPointerException\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at com.hishighness.budgetracker.TransactionReport.onCreate(TransactionReport.java:27)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at  android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)\n10-10 03:55:29.828: E/AndroidRuntime(10229):    ... 11 more\n</code></pre>\n\n<p>Here's the log.</p>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":12809080,"title":"Query that does select and counts records in another table","body":"<p>I've been working on this issue for awhile and I can't seem to figure out a way to effectively do this.</p>\n\n<p>Basically I have a table that holds questions and I have a table that keeps track of answers to the questions as well as the user info of the user associated with that answer. The answers are all true or false and I want to keep track of the total true or false answers per each question.</p>\n\n<p>So the first query is selecting all records in the question table.\nThe second query selects the answers by questionID</p>\n\n<p>I want to create a query that does all of this simultaneously, what I have most recently tried with no success is as follows:</p>\n\n<pre><code>SELECT questions.*, count(answers.*) as total_answers FROM questions\nLEFT OUTER JOIN\n(\nSELECT answers.* AS true FROM votes\nWHERE answer = 1 AND questionID = THIS.ID\n)\n</code></pre>\n\n<p>This query doesn't work because I can't do another WHERE statement specifying that I want to only grab the records with the answer as 1 or 0 (the true or false answers are all binary). I haven't found a THIS selector or anything similar in SQL. I hope I have been clear enough. I thought I had a pretty good understanding of Querying until I came across this issue.</p>\n\n<p>Any help would be much appreciated </p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12808840,"title":"Joining two tables with a sum( ) table","body":"<p>I currently have a query that shows the people in my team, and their current role (which is looked up from another table):</p>\n\n<pre><code>SELECT firstName + ' ' + lastName as Name,\n       RTS_ROLE.roleDescription as `Current Role`, \nFROM RTS_STAFF, RTS_ROLE\nWHERE RTS_STAFF.staffRole = RTS_ROLE.roleID \nAND staffDeleted &lt;&gt; true\nORDER BY roleID;\n</code></pre>\n\n<p>And another query that lists the weekly hours worked by each person:</p>\n\n<pre><code>SELECT RTS_STAFF.staffId, Sum(IIf(Isnull(Monday),0,Monday)\n+IIf(Isnull(Tuesday),0,Tuesday)\n+IIf(Isnull(Wednesday),0,Wednesday)\n+IIf(Isnull(Thursday),0,Thursday)\n+IIf(Isnull(Friday),0,Friday)) AS `Weekly Hours`\nFROM WORKING_HOURS, RTS_STAFF\nWHERE RTS_STAFF.staffId = WORKING_HOURS.staffID \nAND Date() &gt; WORKING_HOURS.EffectiveFrom \nGROUP BY RTS_STAFF.staffId;\n</code></pre>\n\n<p>I've tried (unsuccessfully) to join these queries by placing the second query as a subquery in the first with no avail: I'm getting 'You have written a subquery that can return more than one field without using the EXIST keyword in the main query...\"</p>\n\n<p>I'm trying to get a query that will display the staff name, role name and 'current' total working hours from the same query. Can someone give me a clue how this could be achieved, or  what I'm doing wrong (no doubt something embarrassingly simple).</p>\n\n<p>Happy to provide more information if it will help.</p>\n\n<pre><code>Table structure:\nRTS_ROLE: (lookup table)\n(pk)RoleID: number\nroleDescription: string\n\nRTS_STAFF\n(pk)staffId: number\nfirstName: string\nlastName: string\nstaffRole: number (fk to RTS_ROLE.roleID)\nstaffDeleted: boolean\n\nWORKING_HOURS:\n(pk)workingWeekID: number\nstaffID: number (fk to RTS_STAFF.staffId)\nMonday: number\nTuesday: number\n...\nFriday:number\nEffectiveFrom: date\n</code></pre>\n\n<p>We're using (don't laugh) MS Access 2007</p>\n"},{"tags":["sql","query","multiple","sum","row"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12792011,"title":"Return values on multiple rows as one row with sum total","body":"<p>I need help with the SQL code in a Select ... From query. </p>\n\n<pre><code>SELECT Status FROM Table AA \n</code></pre>\n\n<p>(Example below)</p>\n\n<p>I need to return the Status field value, one from each type (5,17,6,4) AND where Value = the value corresponding to that Type And then display each status for Type &amp; Value on one row and add the sum total as such:</p>\n\n<pre><code>Status  Status  Status  Status  Total\n1       0       1       0       2\n\n\nModel#  Type    Value   Status\nLDIR_4-G    5   4W      0\nLDIR_4-G    5   4R      1\nLDIR_4-G    5   4S      1\nLDIR_4-G    17  Sat     1\nLDIR_4-G    17  Mil     1\nLDIR_4-G    17  Ham     1\nLDIR_4-G    6   4.0     1\nLDIR_4-G    6   2.0     0\nLDIR_4-G    4   1.0ct   0\nLDIR_4-G    4   0.5ct   0\n</code></pre>\n"},{"tags":["mysql","query","select","key","where"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12786598,"title":"MySQL return inverse? results of a search or results NOT containing","body":"<p>A complex one here? (for me at least). I have a table called \"tickets\", with the \"id\" column being the unique key. I have another table called \"Labels\", which doesnt have a unique key (from the looks of it). In \"Tickets\" we store ticket information (messages, who made the ticket etc). We can add a label to a ticket when we create it, so that we can search for tickets with those labels e.g. \"review later\".</p>\n\n<p>What I am trying to do, is a reverse type query e.g. show me all tickets that dont have a specific label associated to it e.g. dont show me any tickets with \"review later\". IF A TICKET DOESNT HAVE ANY LABELS NOTHING IS PUT IN THE LABEL TABLE. I just cant get any type of query I write, by hand or with a query builder to work. </p>\n\n<p>Im my image, you can see Tickets.id has 174 against it, which is also shown in Labels.ticket_id 174 with 2 x Labels set against it. </p>\n\n<p><img src=\"http://i.imgur.com/Vewmh.jpg\" alt=\"\"></p>\n\n<p>No matter what query, join, does, does not etc I try, I either get back no results OR for some strange reason, I still get ticket 174 showing up.</p>\n\n<p>Here is the most simple query I have tried.. however, I think Ive tried about 30 iterations by now from simple to very complex.</p>\n\n<pre><code>    SELECT tickets.id\n    FROM\n      tickets, labels_tickets\n    WHERE\n      tickets.id &lt;&gt; labels_tickets.ticket_id\n    GROUP BY\n      tickets.id\n</code></pre>\n\n<p>Can anyone suggest why this wouldnt work or think of any method to build a statment that says:</p>\n\n<p>Show me all tickets.id from tickets that doesnt have the label \"MyLabel\" or doesnt have a value at all in the Labels table.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12807072,"title":"SQL find the most recurring element based on different table relations","body":"<p>I have a question regarding how to do an SQL query (still learning here, fun!) I wrote a sample database that I am using here, I am trying to keep things simple for all of you who wish to help. (Do let me know of any ambiguities)</p>\n\n<pre><code>Officer              Permit               Vehicle              Dispatch\n\nOid | Dname | Rank   Oid | Type | Model   Vid | Type | Model   Did | Oid | Location\n------------------   ------------------   ------------------   --------------\n1   | John  |  Jr    1     D1     Ford    1     D1     Ford    1     1      Hill\n2   | Jack  |  Sr    1     D2     Ford    2     D2     Ford    2     2      Beach\n3   | Jay   |  Jr    2     D1     Ford    3     D3     Ford    3     3      Post\n4   | Jim   |  Jr    3     D1     Ford    4     D4     Ford    4     1      Beach\n5   | Jules |  Sr    5     D1     Ford    5     D5     Ford    5     2      Hill\n                     1     D3     Ford                         6     4      Post\n                     2     D2     Ford                         7     5      Hill\n                     4     D1     Ford                         8     5      Beach\n                     1     D5     Ford                         9     2      Post\n</code></pre>\n\n<p>The relation between the tables are:</p>\n\n<pre><code>Officer - lists the officer by OID(officer ID)/Name/Rank where Sr is highest, Jr is lowest.\nPermit - Officers are required to have a permit depending on the vehicle they will be using, Oid for Officer ID, Type for the vehicle and Model.\nVehicle - Vid for vehicle ID, Type and Model\nDispatch - Did for Dispatch ID, keeps track of which officer (Oid) was dispatched to which location (Location)\n</code></pre>\n\n<p>Question: I need to know a couple of things from here. \nFirst is how do I know which officer is permitted to drive all vehicle types?\nSecond is How do I know which officer has been dispatched to all the dispatched locations?</p>\n\n<p>Writing these two queries has been a nightmare for me, I have tried to join different tables but I still cannot get the most recurring element from either (I don't know how!) any assistance will be much appreciated!</p>\n"},{"tags":["query","mongodb","count","nosql","mapreduce"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12749900,"title":"MongoDB advanced count query, depending of document's content","body":"<p>I've got an issue with an advanced count query with MongoDB.</p>\n\n<p>I'm tring to count object <strong><em>inside</em></strong> a document field, but only if a previous element matching a query exist and <strong><em>is older</em></strong> in the array.  </p>\n\n<p>Let me explain....</p>\n\n<p>I have got a <strong>container document</strong>, lookin' like:</p>\n\n<pre><code>{\n \"_id\" : ...,\n [...]\n \"objects\" : [ ]\n}\n</code></pre>\n\n<p>Inside the objects fields:<br>\nI've got <strong>object document</strong> lookin' like:</p>\n\n<pre><code>[\n  {\n    \"_id\" : ...,\n    \"name\" : \"foo\",\n    \"properties\" = [ ],\n    \"time\" = 000000042\n  }\n\n  {\n    \"_id\" : ...,\n    \"name\" : \"bar\",\n    \"properties\" = [ ],\n    \"time\" = 000000424\n  }\n\n  {\n    \"_id\" : ...,\n    \"name\" : \"baz\",\n    \"properties\" = [ ],\n    \"time\" = 000004242\n  }\n</code></pre>\n\n<p>For now I count how many <strong>container documents</strong> contain:<br>\n<strong><em>count</em></strong> of container with object 1 (foo),<br>\n<strong><em>count</em></strong> of container with object 1 and 2 (foo and bar),<br>\n<strong><em>count</em></strong> of container with object 1, 2 and 3 (foo, bar, baz)  </p>\n\n<p>But now I want to count foo and bar only if <em>bar</em> is <strong>older</strong> than <em>foo</em> (using the time field)...<br>\n<strong><em>count</em></strong> of container with object 1 (foo),<br>\n<strong><em>count</em></strong> of container with object 1 and 2 (foo and bar), <strong>AND</strong> foo.time &lt; bar.time<br>\n<strong><em>count</em></strong> of container with object 1, 2 and 3 (foo, bar, baz) <strong>AND</strong> foo.time &lt; bar.time &lt; baz.time  </p>\n\n<p>The probleme is that the time field needs to change for each container.\nWith other words: How can I use dynamic query per document</p>\n\n<p>here a sample of code:</p>\n\n<pre><code>foreach ($COUNTER[ARRAY_FIELDS_NAME_TO_COUNT] as $key =&gt; $value)\n{\n// Build the query (Name &amp; properties)\n$match[$key] = array('$elemMatch' =&gt; array('name' =&gt; $value['name']));\nforeach ($value['properties'] as $propertyName =&gt; $propertyValue)\n  $match[$key]['$elemMatch'][\"properties.$propertyName\"] = $propertyValue;\n\n// Time checking\nif ($key &gt; 0)\n{\n  //FIXME with a... dynamics query searching inside current doc??\n  //           or   a special var set to the previous object matched...  or MapReduce..\n}\n\n\n// Make the query\n$query = array('objects' =&gt; array('$all' =&gt; $match));\n\n$result[$key]['count'] = $db-&gt;person-&gt;count($query);\n}\n</code></pre>\n\n<p>I'm new in MongoDB, and I really don't know what could be the best practice for doing that efficiently!</p>\n\n<p>Regards!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12806054,"title":"SQL: Query Entire Database","body":"<p>I am a complete beginner in SQL. I am using a program that queries a database, and then processes the results. The default query is:</p>\n\n<pre><code>SELECT * \nFROM data, \n     questions, \n     users \nwhere users.U_Id = data.Subj_Id \n  and data.Subj_Id between 1 and 10 \n  and data.Q_Id = questions.Q_Id \n  and questions.Q_Id between 1 and 10 \norder by Subj_Id;\n</code></pre>\n\n<p>I'd like it to query every <code>Subj_Id</code> and every <code>Q_Id</code>. I do not know how many there are of either, and different subjects have different numbers of questions. How should I alter the above query?</p>\n"},{"tags":["css","query","mobile","resize","media"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12801840,"title":"@media works on browser window resize, but not on mobile phone","body":"<p>SOLVED: Tom: You were so right. Unfortunately WordPress function wp_head() was adding the width=1100 because of a plugin. Thanks!</p>\n\n<p>I'm working on a new responsive website, but can't seem to get the @media query to work.\nIt does work when resizing the browser window on my desktop, but it won't work on my ipad, iphone or android phone.</p>\n\n<p>What am I doing wrong?!</p>\n\n<p>Here the link: <a href=\"http://demo.mindspins.com/atmnieuw/\" rel=\"nofollow\">http://demo.mindspins.com/atmnieuw/</a>\nHere's the link to the CSS: <a href=\"http://demo.mindspins.com/atmnieuw/wp-content/themes/atm/css/dynamic.php\" rel=\"nofollow\">http://demo.mindspins.com/atmnieuw/wp-content/themes/atm/css/dynamic.php</a></p>\n\n<p>Thanks in advance!</p>\n\n<p>On request the CSS code:</p>\n\n<pre><code>@media all and (max-width: 1460px) {\n    .site-width{ width: 1199px; }\n    .main-width{ width: 719px; }\n}\n@media all and (max-width: 1220px) {\n    .site-width{ width: 959px; }\n    .main-width{ width: 479px; }\n    #page-title h1.thetitle{\n        font-size: 20px;\n        line-height: 24px;\n    }\n    .sidebar .widget a.form-button-link, .sidebar .widget span.form-button-link{\n        font-size: 20px;\n        line-height: 24px;\n    }\n}\n@media all and (max-width: 980px) {\n    .site-width{ width: 719px; }\n    .main-width{ width: 479px; }\n    .right-width{ display: none; }\n    #header-right{ display: none; }\n    .widgets-wrapper-1{ display: block; }\n    .widgets-wrapper-3{ display: block; position: relative; padding: 20px 0 0 20px; }\n}\n@media all and (max-width: 740px) {\n    .site-width{ width: 95%; margin: 0 auto;}\n    #header-wrapper{ width: 100%; }\n    #header-left{ display: none; }\n    #header-mid{ height: 80px; }\n    #atmlogo a.atm {\n        z-index: 100;\n        top: 24px;\n        left: 0;\n    }\n    .main-width{ width: 100%; }\n    .left-width{ width: 100%; }\n    .sidebar-left{ display: none; }\n    .site-bg{ display: none; }\n    #header-left span.header-contact{ height: 80px; width: 100%;}\n    #main-nav{ height:auto !important; }\n    #mobile-nav{\n        margin: -4px 0 1px 0;\n        display: block;\n        position: relative;\n        width: 100%;\n    }\n    #mobile-nav .nav-wrapper{\n        display: block;\n        color:  #fff;\n        background: #cc0033;\n        margin: 1px 0;\n        height: 40px;\n        padding: 0 10px;\n    }\n    #mobile-nav .nav-wrapper select.atm-dropdown{\n        font-size: 12px;\n        display: block;\n        height: 40px;\n        width: 100%;\n        color:  #fff;\n        background: #cc0033;\n        border: 0;\n        clear: both;\n        -webkit-border-radius: 0;\n        -webkit-appearance: none;\n    }\n    #mobile-nav .theme-s{\n        width: 100%;\n        background: #cc0033;\n        color:  #fff;\n    }\n\n    #mobile-nav input.s{\n        background: #cc0033;\n        color:  #fff;\n    }\n\n    #mobile-nav input.searchsubmit{\n        border-left: solid 1px #dcdcdc;\n        color:  #fff;\n        background: #cc0033;\n        background-image: url(../images/icon_search.png);\n        background-repeat: no-repeat;\n        background-position: right top;\n        -webkit-border-radius: 0;\n        -webkit-appearance: none;\n    }\n\n    #primary{ display: none; }\n    #main-content-header{\n        height:auto !important;\n        margin: 0 0 1px 0;\n    }\n    #main-content-header span.header-image{\n        display: block;\n        float: left;\n        width: 25%;\n        height:auto !important;\n        margin: 0;\n    }\n    #main-content-header span.header-image img{\n        line-height: 0px;\n        margin: 0;\n        padding: 0;\n    }\n\n    #page-title{\n        height: 79px;\n    }\n}\n@media all and (max-width: 500px) {\n    body {\n        font-size: 12px;\n        line-height: 20px;\n    }\n        #footer-nav{ display: none; }\n        #copyrights{ display: none; }\n        .entry-content-bg{ padding: 20px; }\n        #page-title .title-wrapper{ padding: 0 20px }\n        #page-title h1.thetitle{\n        font-size: 16px;\n        line-height: 20px;\n    }\n}\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12806518,"title":"SQL - Selecting the most occurring value","body":"<p>I have a very simple database consisting of these tables. Here I am trying to write a query to select the player who played in the most games from the Games table. The answer is Ben of course, but I am still a beginner in SQL, so I am struggling quite a lot.</p>\n\n<pre><code>Players         Games          \n\nPID | name      GID | PID\n----|-----      ----|------\n1   |  Al       A   |  3\n2   |  Ben      A   |  2\n3   |  Carl     A   |  2\n4   |  Jack     A   |  1\n5   |  Ron      A   |  4\n</code></pre>\n\n<p>Does anyone have any suggestions? Thanks!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12806231,"title":"Alternative solutions to specifying qualified table names for fields","body":"<p>Regarding the <code>Column '' in field list is ambiguous</code> error in MySQL. Its caused if mysql cant figure what table the field name belongs to. Does anyone know a different approach to specifying the qualified table name for fields, other than prefixing the table name to the field itself. Say I have a list of fields like so</p>\n\n<pre><code>INSERT INTO dupes \n   ( lead_id,set_id,upload_date,agent,callcenter\n    ,generation_date,vendors,first_name\n    ,last_name,email,phone,address,city,state,zip,dob\n    ,gender,marital_status,rented,year,make,model,trim\n    ,vin,primary_use,miles_oneway,mileage,license_num,license_state\n    ,education,job_title,license_status)\n\n(SELECT lead_id,set_id,upload_date,agent,vendors,callcenter\n    ,generation_date,first_name,last_name\n    ,email,phone,address,city,state,zip,dob,gender,marital_status\n    ,rented,year,make,model,trim,vin,primary_use,miles_oneway\n    ,mileage,license_num,license_state,education,job_title\n    ,license_status \n FROM leads_auto \n JOIN (\n    SELECT vendors, email, MIN(lead_id) min_lead_id \n    FROM leads_auto \n    WHERE vendors = 1762\n    GROUP BY vendors, email) y \n ON    y.vendors = leads_auto.vendors \n   AND y.email = leads_auto.email \n   AND leads_auto.lead_id &lt;&gt; y.min_lead_id)\n</code></pre>\n\n<p>Now I was thinking of using <code>GROUP_CONCAT([fields] SEPARATOR ',[table name].')</code> to prefix the fields into a variable and then execute it. Does anyone else have any ideas?</p>\n"},{"tags":["sql","sql-server","query","tsql","sql-server-2000"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12790921,"title":"Query count with multiple table group by month return zero if month is null","body":"<p>I need some help one getting the project count per month for all of the projectTypes per region. I've tried the following statement but it didn't return what I need. \nThe problem with the statement below is that it only returns the projectType only if there a count for that month. I need to return zero if the month doesn't have a count. \nAny help is much appreciated.</p>\n\n<pre><code>SELECT r.region, pt.projectType, count(p.id) as totalCount, p.postedOn as monthCount\nFROM region r cross join ProjectTypes pt left join projects p on p.regionID = r.id and pt.id = p.TypeID \nWHERE year(p.postedOn) = '2012' \ngroup by r.region, pt.projectType, p.postedOn \norder by r.region\n</code></pre>\n\n<p>Please the sample here: <a href=\"http://sqlfiddle.com/#!3/6680f/18\" rel=\"nofollow\">http://sqlfiddle.com/#!3/6680f/18</a></p>\n\n<pre>\nregions:\n-------------------------\nid  | region    |\n-------------------------\n1   | East      |\n-------------------------\n2   | MidWest   |\n-------------------------\n3   | West      |\n-------------------------\n\n\nProject Type:\n-------------------------\nid  | projectType   | \n-------------------------\n1   | Web Desgin    |\n-------------------------\n2   | Database  |\n-------------------------\n3   | Development   |\n-------------------------\n\n\nProjects:\n-------------------------------------------------------------------------\nid  | projectName   | regionID  | projectTypeID | postedOn  |\n-------------------------------------------------------------------------\n1   | Project 1 | 1     | 2     | 2012-09-02    |\n-------------------------------------------------------------------------\n2   | Project 2 | 2     | 2     | 2012-09-02    |\n-------------------------------------------------------------------------\n3   | Project 3 | 1     | 1     | 2012-09-02    |\n-------------------------------------------------------------------------\n4   | Project 4 | 3     | 2     | 2012-09-02    |\n-------------------------------------------------------------------------\n5   | Project 5 | 3     | 1     | 2012-10-02    |\n-------------------------------------------------------------------------\n6   | Project 6 | 3     | 2     | 2012-10-02    |\n-------------------------------------------------------------------------\n7   | Project 7 | 3     | 3     | 2012-10-02    |\n-------------------------------------------------------------------------\n8   | Project 8 | 2     | 3     | 2012-10-02    |\n-------------------------------------------------------------------------\n9   | Project 9 | 1     | 2     | 2012-10-02    |\n-------------------------------------------------------------------------\n10  | Project 10    | 1     | 2     | 2012-10-02    |\n-------------------------------------------------------------------------\n\n\nDesired Results:\n---------------------------------------------------------\nRegion  | project Type  | totalCount    | monthCount    |\n---------------------------------------------------------\nEast    | Web Desgin    | 1     | September |\n---------------------------------------------------------\nEast    | Database  | 1     | September |\n---------------------------------------------------------\nEast    | Development   | 0     | September |\n---------------------------------------------------------\nMidwest | Web Desgin    | 0     | September |\n---------------------------------------------------------\nMidwest | Database  | 1     | September |\n---------------------------------------------------------\nMidwest | Development   | 0     | September |\n---------------------------------------------------------\nWest    | Web Desgin    | 0     | September |\n---------------------------------------------------------\nWest    | Database  | 1     | September |\n---------------------------------------------------------\nWest    | Development   | 0     | September |\n---------------------------------------------------------\nEast    | Web Desgin    | 0     | October   |\n---------------------------------------------------------\nEast    | Database  | 2     | October   |\n---------------------------------------------------------\nEast    | Development   | 0     | October   |\n---------------------------------------------------------\nMidwest | Web Desgin    | 0     | October   |\n---------------------------------------------------------\nMidwest | Database  | 0     | October   |\n---------------------------------------------------------\nMidwest | Development   | 1     | October   |\n---------------------------------------------------------\nWest    | Web Desgin    | 1     | October   |\n---------------------------------------------------------\nWest    | Database  | 1     | October   |\n---------------------------------------------------------\nWest    | Development   | 1     | October   |\n---------------------------------------------------------\n</pre>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":12764914,"title":"Duplicate information from sql result","body":"<p>I looked in about 18 other posts on here an most people are asking how to delete the records not just hide them. So my problem: I have a database with staff members who are associated with locations. Many of the staff members are associated with more than one location. What I want to do is to only display the first location listed in the mysql result and skip over the others. I have the sql query linking the tables together and it works aside from it showing the same information for those staff members that are in those other locations multiple times so example would be like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/YVBkF.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is the sql statement I have currently</p>\n\n<pre><code>    SELECT staff_tbl.staffID, staff_tbl.firstName, staff_tbl.middleInitial, staff_tbl.lastName,\n     location_tbl.locationID, location_tbl.staffID, \n    officelocations_tbl.locationID, officelocations_tbl.officeName, staff_title_tbl.title_ID,\n     staff_title_tbl.staff_ID, titles_tbl.titleID, titles_tbl.titleName\n\n    FROM staff_tbl \n\n    INNER JOIN location_tbl ON location_tbl.staffID = staff_tbl.staffID \n    INNER JOIN officelocations_tbl ON location_tbl.locationID = officelocations_tbl.locationID\n    INNER JOIN staff_title_tbl ON staff_title_tbl.staff_ID = staff_tbl.staffID \n    INNER JOIN titles_tbl ON staff_title_tbl.title_ID = titles_tbl.titleID \n</code></pre>\n\n<p>and my php is </p>\n\n<pre><code>      &lt;?php do { ?&gt;\n&lt;tr&gt;\n  &lt;td&gt;&lt;?php echo $row_rs_Staff_Info['firstName']; ?&gt;&amp;nbsp; &lt;?php echo $row_rs_Staff_Info['lastName']; ?&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;?php echo $row_rs_Staff_Info['titleName']; ?&gt;&amp;nbsp; &lt;/td&gt;\n  &lt;td&gt;&lt;?php echo $row_rs_Staff_Info['officeName']; ?&gt;&amp;nbsp; &lt;/td&gt;\n\n&lt;/tr&gt;\n&lt;?php } while ($row_mysqlResult = mysql_fetch_assoc($rs_mysqlResult)); ?&gt;\n</code></pre>\n\n<p></p>\n\n<p>What I would like to know is there a way using php to select only the first entry listed for each person and display that and just skip over the other two. I was thinking it could be done by possibly adding the staffID's to an array and if they are in there to skip over the next one listed in the staff_title_tbl but wasn't quite sure how to write it that way. Any help would be great thank you in advance.</p>\n"},{"tags":["php","sql","query","select","option"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12804922,"title":"How to select all option for multiple dropdowns and perform query in php and mysql? easier method?","body":"<p>I am new to php and sql so please bear with me. I did try and search but did not find quite wat i am looking for. Hope u can help me out. so here goes!</p>\n\n<p>I have a certain number of drop down menus with values. I like to include a select all option which will select all the options and does an sql query for all values.\nI have wriiten a sample code using if conditions to perform the query but the number of if cond increase exponentially based on the number of drop down menus. 2^n im guessing.\nI wanted to know if there is a better way of doing this. please find the code below.</p>\n\n<pre><code>$sql = mysql_query(\"SELECT distinct `Num. of Parts` from `$verb`\");\necho \"&lt;select name='filter1'&gt;\";\necho \"&lt;option value='1'&gt; Select all &lt;/option&gt;\";\nwhile($row = mysql_fetch_assoc($sql))\n{\n$filter1 = $row['Num. of Parts'];\necho \"&lt;option value='$filter1'&gt; $filter1 &lt;/option&gt;\";\n}\necho \"&lt;/select&gt;\";\n$sql = mysql_query(\"SELECT distinct `Type of positioning` from `$verb`\");\necho \"&lt;select name='filter2'&gt;\";\necho \"&lt;option value='1'&gt; Select all &lt;/option&gt;\";\nwhile($row = mysql_fetch_assoc($sql))\n{\n$filter2 = $row['Type of positioning'];\necho \"&lt;option value='$filter2'&gt; $filter2 &lt;/option&gt;\";\n}\necho \"&lt;/select&gt;\";\necho \"&lt;input type=\\\"submit\\\" name=\\\"submitC\\\" value=\\\"SUBMIT\\\"&gt;\";\n</code></pre>\n\n<p>the submitC value is passed here:</p>\n\n<pre><code>if($filter1==1 &amp;&amp; $filter2!=1)\n{$sql = mysql_query(\"SELECT * from `$verb` where `Num. of Parts` like '%' and `Type of positioning`='$filter2' and `Distance range`='$dist'\");\n}\nelseif($filter1!=1 &amp;&amp; $filter2==1)\n{$sql = mysql_query(\"SELECT * from `$verb` where `Num. of Parts`='$filter1' and `Type of positioning` like '%' and `Distance range`='$dist'\");\n}\nelseif($filter1==1 &amp;&amp; $filter2==1)\n{$sql = mysql_query(\"SELECT * from `$verb` where `Num. of Parts` like '%' and `Type of positioning` like '%' and `Distance range`='$dist'\");\n}\nelse\n{\n$sql = mysql_query(\"SELECT * from `$verb` where `Num. of Parts`='$filter1' and `Type of positioning`='$filter2' and `Distance range`='$dist'\");\n}\n</code></pre>\n\n<p>Thanks in advance guys!\nps EXCLUDE $dist</p>\n"},{"tags":["mysql","database","query","sql-update"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12798520,"title":"MYSQL - Update values of new column based on condition","body":"<p>I have the following table</p>\n\n<pre><code>+--------------+------------+------+-----+---------+-------+\n| Field        | Type       | Null | Key | Default | Extra |\n+--------------+------------+------+-----+---------+-------+\n| image_id     | int(11)    | YES  |     | NULL    |       |\n| image_status | bit(3)     | YES  |     | NULL    |       |\n| image_result | varchar(4) | YES  |     | NULL    |       |\n+--------------+------------+------+-----+---------+-------+\n</code></pre>\n\n<p>image_id and image_status columns are populated with values. The values in image_result are all NULL.</p>\n\n<p>I want to insert the following values into the image_result column based on the following conditions (I want to update all the rows in the table)- </p>\n\n<ul>\n<li>if image_status = '0' OR image_status = '3' then image_result =\n'Pass'</li>\n<li>if image_status = '1' OR image_status = '4' then image_result =\n'Warn'</li>\n<li>if image_status = '2' then image_result = 'Fail'</li>\n</ul>\n\n<p>How do I do the above?</p>\n"},{"tags":["sql","xml","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12805295,"title":"How to get XML attributes from XML with an unknown number of rows","body":"<p>I have the following query that allows me to get xml data from ONE row of xml from a specified column.</p>\n\n<p>However, Product can have 1 UPC child, or a lot.</p>\n\n<p>How can I alter my query to return all the existing children of Product?</p>\n\n<pre><code>DECLARE @MyXML XML\nSET @MyXML =\n    (SELECT ProductsXML\n     FROM Products\n     WHERE ProductId= 1)\nSELECT \n    a.b.value('Product[1]/UPC[1]/@upccode','DATE') as UPC,\n    a.b.value('Product[1]/UPC[1]/@dateadded','DATE') as DateAdded\n    FROM @MyXML.nodes('xml')a(b) \n</code></pre>\n"},{"tags":["php","arrays","query","codeigniter","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12804932,"title":"How to query the database with infromation from another query?","body":"<p>I have a mysql table with information about students and another will info about payments. I want to display a table with the student name and payment info. Is my code correct? or am I misunderstanding how it works because this results in an empty array.\nI want it, for every student it found in  $data['students'] to search for the payment info with same studentid be from this year and class id be the same as $id. Is there a simpler way to do this?</p>\n\n<pre><code>    $data['students'] = $this-&gt;db-&gt;get_where('students', array('class_id' =&gt; $id), 40);\n\n    foreach ($data['students']-&gt;result_array() as $student){        \n        $data['student_info'] = $this-&gt;db-&gt;get_where('student_payments', array('class_id' =&gt; $id, 'student_id' =&gt; $student['id'], 'year' =&gt; date(\"Y\")), 40);        \n    }\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Thaiscorpion.</p>\n"},{"tags":["facebook","query","facebook-graph-api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12802026,"title":"Get current user newsfeed along with post author picture","body":"<p>I'm trying to obtain all newsfeed posts of the current user along with each post author picture url in a single query, but I cannot succeed.</p>\n\n<p>I can get current user newfeed by calling \"/me/home\" in Graph Api, and I can get a specific user picture by calling \"{user_id}/picture\". How can I get every post author picture of my newsfeed in one single query?</p>\n\n<p>Thanks in advance!\nPablo</p>\n"},{"tags":["sql","query","tsql","query-optimization","query-execution-plans"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12801011,"title":"sql using different execution plans when running a query and when running that query inside a stored procedure?","body":"<p>I have this query,</p>\n\n<pre><code>Declare @Prcocessrate float\ndeclare @item varchar(20)\ndeclare @process varchar(20)\ndeclare @branch varchar(20)\nset @item = 'shirt'\nset @process = 'kt'\nset @branch = '1'\nselect @Prcocessrate =  ProcessPrice from itemwiseprocessrate where itemname=@Item and Process=@process and branchid=@branch\n</code></pre>\n\n<p>when I run it single handed, the execution plan only shows <strong>3 steps</strong>, see for youself..</p>\n\n<p><img src=\"http://i.stack.imgur.com/GI1cY.png\" alt=\"enter image description here\"></p>\n\n<p>but I have this <code>procedure</code> <code>sp_newBooking</code> as </p>\n\n<pre><code>ALTER PROC sp_newbooking\n-- other arguements--\nAS\nBEGIN\n\n--OTHER FLAGS--\n\nELSE IF (@Flag = 32)\n        BEGIN\n\n            declare @ItemId varchar(max),@ProcessRate float\n            --set @BranchId='1'\n            select @ProcessCode = DefaultProcessCode from mstconfigsettings where branchid=@BranchId\n            select @ItemId= DefaultItemId from mstconfigsettings where branchid=@BranchId\n            select @ItemName=  ItemName from itemmaster where itemid=@ItemId and branchid=@BranchId\n            select @ProcessRate =  ProcessPrice from itemwiseprocessrate where itemname=@ItemName and ProcessCode=@ProcessCode and branchid=@BranchId\n            if(@ProcessRate is not null)\n            select @ItemName as ItemName,@ProcessCode as ProcessCode,@ProcessRate as ProcessRate\n            else\n            select @ItemName as ItemName,@ProcessCode as ProcessCode,'0' as ProcessRate\n        END\n\n-- OTHER FLAGS --\n\n\nEND\n</code></pre>\n\n<p>Now!, when I run this</p>\n\n<pre><code>exec sp_newbooking\n@flag = 32,\n@Branchid = 1\n</code></pre>\n\n<p>The execution plan is showing <strong>6 steps!</strong> Here's the picture..!<br>\nSee the <strong>query 4</strong><img src=\"http://i.stack.imgur.com/at1Vf.png\" alt=\"\"></p>\n\n<p><strong>Why is it taking 6 steps to perform the same query</strong> when executing from the procedure, while its taking 3 steps when executing alone? Wtf is this?</p>\n"},{"tags":["android","query","null"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12803995,"title":"SQL query to check where values IS NOT NULL","body":"<p>I am getting a strange return on my query if I execute the following code:</p>\n\n<pre><code>public int getCountTriedAnswers() {\n        int count = 0;\n\n        Cursor c = myDataBase.rawQuery(\n                \"SELECT COUNT(*) FROM QUESTIONS WHERE ATTEMPTS IS NOT NULL\", null);\n        c.moveToFirst();\n        count = c.getInt(0);\n        c.close();\n\n\n        return count;\n\n    }\n</code></pre>\n\n<p>It gives me 10 although if I pull the database from me device, I clearly see that only 7 items have a value and not ten... Any ideas?</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12803040,"title":"sql get username twice in one query","body":"<p>I have the following 3 tables:</p>\n\n<pre><code>users:\nid, username\n\nfolders:\nid,fkuser(connects to user.id)\n\nfolder_comments:\nid,fkuser(connects to user.id), fkfolder(connects to folder.id)\n</code></pre>\n\n<p>I want to get the commenter username(<code>folder_comments.fkuser-&gt;user.id&lt;-&gt;user.username</code>) <strong>AND</strong> and the username of the folder owner (<code>folder_comments.fkfolder-&gt;folder.id&lt;-&gt;folder.fkuser-&gt;user.id&lt;-&gt;user.username</code>);</p>\n\n<p>The query I have thoght of is partial:</p>\n\n<pre><code>SELECT `folder_comments`.*, `folder`.`fkuser` as folderuserid, `user`.`firstname` as username\nFROM `folder_comments` \n                left join `folder` on `folder_comments`.`fkfolder` = `folder`.`id`\n                left join `user` on `folder_comments`.`userid` = `user`.`id`\n</code></pre>\n\n<p>How can I get the folder's owner username?</p>\n\n<p>edit :</p>\n\n<p>I tried:</p>\n\n<pre><code>    SELECT `folder_comments`.*, `folder`.`fkuser` as folderuserid, `user`.`firstname` as username, , `user`.`firstname` as folderowner\n        FROM `folder_comments` \n                        left join `folder` on `folder_comments`.`fkfolder` = `folder`.`id`\n                        left join `user` on `folder_comments`.`userid` = `user`.`id`\nleft join `user` on `folder`.`fkuser` = `user`.`id`\n</code></pre>\n\n<p>but I get an error <code>Not unique table/alias: 'user'</code></p>\n"},{"tags":["mysql","query","aggregate-functions","mysql-5.5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12800184,"title":"Need a query to find consecutive orders by month","body":"<p>I am having trouble writing this query.</p>\n\n<p>I need to get the current number of orders that were shipped in consecutive months.</p>\n\n<p>Example: if the current month is November and they placed orders in July, August, September, October, November, it would return 5 for that user. If they didn't place an order in November, it would return 0 because their streak is broken.</p>\n\n<p>The tables I'm concerned with are <code>customer</code>, <code>order</code>, and <code>date</code>.</p>\n"},{"tags":["sql-server","query","ios"],"answer_count":5,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":7526,"score":4,"question_id":4691420,"title":"Query SQL Server Database from native iOS Application","body":"<p>I am working on an in-house, iOS app that will need read-only access to a SQL Server with multiple databases. I know the stock answer here is \"write some web services\", but I'd like a solution that is self-contained. Is there any way to directly connect to a SQL Server database from an iOS application? I'm thinking something like a basic ODBC connection.</p>\n\n<p>I've seen a lot of users asking this question, but very few answers other than \"write a web service.\" Is that really the only way?</p>\n"},{"tags":["oracle","query","base64","converter","result"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12801755,"title":"Work with BLOB object in Oracle","body":"<p>I have an SQL statement like this-</p>\n\n<pre><code>select utl_encode.utl_encode.base64_encode(IMAGE1) \nfrom IPHONE.accidentreports \nwhere \"key\" = 66\n</code></pre>\n\n<p>But when I run it I get this error-</p>\n\n<pre><code>ORA-00904: \"UTL_ENCODE\".\"UTL_ENCODE\".\"BASE64_ENCODE\": invalid identifier\n00904. 00000 -  \"%s: invalid identifier\"\n*Cause:    \n*Action:\nError at Line: 2 Column: 8\n</code></pre>\n\n<p>I want to convert my <code>BLOB</code> object into <code>BASE64</code>. How could it be done?</p>\n"},{"tags":["oracle","query","plsql","cursor","conditional"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12801970,"title":"PL/SQL Dynamic SQL","body":"<p>I need help. I have a problem in constructing my PL/SQL block.\nIn the cursor, I have a query constructed, and i want to insert a filter on cursor. Below is an example:</p>\n\n<pre><code>DECLARE \ncode NUMBER;\nparameters_amb myOthertable%ROWTYPE;\n\nCURSOR test is SELECT id from mytable\n if parameters_amb.test2 is not null  then\n    where mytable.name = 'NAMETABLE'\n else\n    where mytable.name = 'NAMETABLE2';\n</code></pre>\n\n<p>Can anyone assist me in this construction?</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":226,"score":4,"question_id":9157097,"title":"Which is efficient? query with subquery or joined table","body":"<p>Here are two example of query for the same purpose\n(in this example, I want to fine salesman from same city where Patriks lives.)</p>\n\n<pre><code>select * \nfrom salesman \nwhere salesman.city = \n     ( select city \n       from salesman \n       where salesman_name='Patriks'\n     );\n</code></pre>\n\n<p>and</p>\n\n<pre><code>select s1.* \nfrom salesman s1,salesman s2 \nwhere s1.city=s2.city \n  and s2.salesman_name='Patriks';\n</code></pre>\n\n<p>Which is better or efficient and why?\n(I know this is small example, but I want to figure out, which will be good in complex situation, and for big database.)</p>\n"},{"tags":["query","jpa-2.0","eclipselink","jpql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":12758424,"title":"EclipseLink - How to use empty collection in IN operator?","body":"<p>Is there any way to use empty collection in IN operator?</p>\n\n<pre><code>List&lt;Integer&gt; idList = new ArrayList&lt;Integer&gt;();\nQuery query = em.createQuery(\"SELECT e FROM T e WHERE e.id IN ?1\").setParameter(1, idList);\nList results = query.getResultList();\n</code></pre>\n\n<p>produces:</p>\n\n<pre><code>Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException\nInternal Exception: org.postgresql.util.PSQLException: ERROR: syntax error at or near \")\"\n  Position: 48\nError Code: 0\nCall: SELECT id, other_id FROM t_table WHERE (id IN ())\nQuery: ReadAllQuery(referenceClass=T sql=\"SELECT id, other_id FROM t_table WHERE (id IN ?)\")\n</code></pre>\n\n<p>This one:</p>\n\n<pre><code>List&lt;Integer&gt; idList = new ArrayList&lt;Integer&gt;();\n\nCriteriaBuilder cb = EntityManagerProvider.getEmf().getCriteriaBuilder();\nCriteriaQuery&lt;T&gt; c = cb.createQuery(T.class);\nRoot&lt;T&gt; t_class = c.from(T.class);\nExpression&lt;String&gt; exp = t_class.get(\"id\");\nPredicate predicate = exp.in(idList);\n\nc.select(t_class).where(predicate);\n\nTypedQuery&lt;T&gt; q = em.createQuery(c);\nList results = q.getResultList();   \n</code></pre>\n\n<p>produces:</p>\n\n<pre><code>Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException\nInternal Exception: org.postgresql.util.PSQLException: ERROR: syntax error at or near \")\"\n  Position: 48\nError Code: 0\nCall: SELECT id, other_id FROM t_table WHERE (id IN ())\nQuery: ReadAllQuery(referenceClass=T sql=\"SELECT id, other_id FROM t_table WHERE (id IN ())\")       \n</code></pre>\n\n<p>Putting null explicity in IN:</p>\n\n<pre><code>Query query = em.createQuery(\"SELECT e FROM T e WHERE e.id IN (null)\");\n</code></pre>\n\n<p>produces:</p>\n\n<pre><code>    java.lang.IllegalArgumentException: An exception occurred while creating a query in EntityManager: \nException Description: Syntax error parsing the query [SELECT e FROM T e WHERE e.id IN (null)], line 1, column 33: unexpected token [null].\nInternal Exception: NoViableAltException(54@[709:9: (itemNode= scalarOrSubSelectExpression ( COMMA itemNode= scalarOrSubSelectExpression )* | subqueryNode= subquery )])\n</code></pre>\n\n<p>However, using native query works fine:</p>\n\n<pre><code>List&lt;Integer&gt; idList = new ArrayList&lt;Integer&gt;();\nQuery query = em.createNativeQuery(\"SELECT * FROM t_table WHERE t_table.id IN (null)\");\nList results = query.getResultList();   \n</code></pre>\n\n<p>Obviously, I don't want to use native queries. \nOf course I can do if-else checks before creating query and create different query for empty collection or in the most cases don't create it at all, because in simple queries there won't be any results. \nBut I have to change vendor from OpenJPA (which accepts empty collections) to EclipseLink in large project and sometimes queries contain few collections in different INs, so if-elsing this won't be so easy.</p>\n"},{"tags":["ruby-on-rails","ruby","query","mongodb","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":71,"score":0,"question_id":12801419,"title":"How to search in database by like query in ruby on rails?","body":"<p>i am using rails and mongo db as database\nsimply i want to search \nI have a field name role\nNow i send the search item in </p>\n\n<pre><code>params[:role]\nparams[:name]\n</code></pre>\n\n<p>Now i have the model User\nnow what could be my query to search the data in the User model like params[:name]\nI did like</p>\n\n<pre><code> @role = params[:role]\n    @name = params[:name] \n     @data = User.{where(:role =&gt; @role)}.where(\"description LIKE (?)\",\n    \"%#   {@name}%\").desc(:created_at).\n    excludes(:id    =&gt; current_user.id)\n</code></pre>\n\n<p>Above query is just analysis. I mean to say it should like in therotical but i didnt get id.</p>\n"},{"tags":["php","mysql","ios","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12800573,"title":"PHP to mySQL Query Fault","body":"<p>I get this error:</p>\n\n<pre><code>Query failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' ,,)' at line 2\n</code></pre>\n\n<p>On this PHP code:</p>\n\n<pre><code>&lt;?php\n\n$id = $_POST['id'];\n$longitude = $_POST['longitude'];\n$latitude = $_POST['latitude'];\n$timestamp = $_POST['stringFromDate'];\n\n\n\n$link = mysql_connect('server', 'user', 'pass')\nor die('Could not connect: ' . mysql_error());\n\nmysql_select_db('db_name') or die('Could not select database');\n\n// Performing SQL query\n$query=\"INSERT INTO locatie (id, longitude, latitude, timestamp) \nVALUES ($id, $longitude,$latitude,$timestamp)\";\n$result = mysql_query($query) or die('Query failed: ' . mysql_error());\necho \"OK\";\n\n// Free resultset\nmysql_free_result($result);\n\n// Closing connection\nmysql_close($link);\n?&gt;\n</code></pre>\n\n<p>Im a beginner, so i dont know what im doing wrong</p>\n\n<p><strong>EDIT:\nThis is the code that writes to the php file:</strong></p>\n\n<pre><code> - (void)myFuntionThatWritesToDatabaseInBackgroundWithLatitude:(NSString *)latitude  longitude:(NSString *)longitude date:\n\n (NSString *)stringFromDate {\n\n\n_phonenumber = [[NSUserDefaults standardUserDefaults] objectForKey:@\"phoneNumber\"];\n\nNSMutableString *postString = [NSMutableString stringWithString:kPostURL];\nNSString*jsonString = [[NSString alloc] initWithFormat:@\"{\\\"id\\\":\\\"%@\\\",\\\"longitude\\\":\\\"%@\\\",\\\"latitude\\\":\\\"%@\\\",\\\"timestamp\\\":\\\"%@\\\"}\",_phonenumber, longitude , latitude, stringFromDate];\n\n[postString appendString:[NSString stringWithFormat:@\"?data=%@\", jsonString]];\n[postString setString:[postString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];\nNSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:postString ]];\n[request setHTTPMethod:@\"POST\"];\n\n[[NSURLConnection alloc] initWithRequest:request delegate:self ];\nNSLog(@\"Post String =%@\", postString);\n\n\n//    LocationTestViewController*locationTestViewController = [[LocationTestViewController alloc]init];\n//    phonenumber = locationTestViewController.telefoonnummer;\nNSLog(@\"HERE1 : %@\", _phonenumber);\n\n\n\n\n\n }\n</code></pre>\n"},{"tags":["sql","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":12801236,"title":"Inner query and joins","body":"<p>I have written a query to get a code from table A which is not in table B for same ID. I have hardcoded the ID in the query, I want to know how to get the desired output for all the IDs not for 539 alone. Below is the query</p>\n\n<pre><code>SELECT\n    a.code\nFROM\n    A\nWHERE\n    a.code NOT IN(\n        SELECT\n            b.code\n        FROM\n            B b\n        WHERE\n           b.ID='539'\n        AND b.status &lt;&gt; 'D')\nAND \n     (a.id='539')\nAND \n     (a.status &lt;&gt; 'D')\n</code></pre>\n"},{"tags":["query","libreoffice","libreoffice-base"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12801451,"title":"LibreOffice Base - query - merge two rows","body":"<p>I'm learning LibreOffice Base (3.6.2). Unfortunatly the doc is pretty poor. The DB is a \".odb\" file format. Here's a simple multi-table query:</p>\n\n<p><img src=\"http://i.stack.imgur.com/UunRO.png\" alt=\"LibreOffice Base query\"></p>\n\n<p>I'd like to merge the field \"refLogiciel.name\" and \"tblPosteLogiciel.version\" in one field.</p>\n\n<p>Thank you!</p>\n"},{"tags":["mysql","query","row","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12794392,"title":"MySQL LEFT JOIN without WHERE clause returns no null rows ","body":"<p>EDIT:\nHere's my table:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `punch` (\n  `name` varchar(50) NOT NULL,\n  `date` varchar(50) NOT NULL,\n  `duration` int(11) NOT NULL\n) ENGINE=MyISAM DEFAULT CHARSET=latin1;\n\nINSERT INTO `punch` (`name`, `date`, `duration`) VALUES\n('foo', '1', 2),\n('bar', '1', 3),\n('bar', '2', 5),\n('foo', '3', 6),\n('foo', '4', 8),\n('bar', '4', 9);\n</code></pre>\n\n<p>I have table with values below:</p>\n\n<pre><code>SELECT * FROM `punch` P1 WHERE P1.date BETWEEN 1 AND 3 ORDER BY P1.name , date;\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>name    date    duration\nbar        1    3\nbar        2    5\nfoo        1    2\nfoo        3    6\n</code></pre>\n\n<p>I want to make a report for date 1 until 3 like this:</p>\n\n<pre><code>name    date    duration\nbar        1    3\nbar        2    5\nbar        3    null\nfoo        1    2\nfoo        2    null\nfoo        3    6\n</code></pre>\n\n<p>I tried this query (note the commented WHERE):</p>\n\n<pre><code>SELECT * FROM (\n    SELECT DISTINCT date FROM punch WHERE date BETWEEN 1 AND 3\n) P1\nLEFT JOIN (\n    SELECT * FROM punch -- WHERE name = 'bar'\n) P2 ON P1.date=P2.date\n\nORDER BY P2.name, P1.date\n</code></pre>\n\n<p>I got result:</p>\n\n<pre><code>date    name    date    duration\n1       bar     1       3\n2       bar     2       5\n1       foo     1       2\n3       foo     3       6\n</code></pre>\n\n<p>I was expecting something like:</p>\n\n<pre><code>date    name    date    duration\n2       NULL    NULL    NULL\n3       NULL    NULL    NULL\n1       bar     1       3\n2       bar     2       5\n1       foo     1       2\n3       foo     3       6\n</code></pre>\n\n<p>Now, when I remove the commented WHERE, I got result:</p>\n\n<pre><code>date    name    date    duration\n3       NULL    NULL    NULL\n1       bar     1       3\n2       bar     2       5\n</code></pre>\n\n<p>My question is, why LEFT JOIN above, behaves like INNER JOIN when there's no WHERE clause?</p>\n\n<p>And what is the correct query for my expected report above?</p>\n\n<p>Thanks</p>\n"},{"tags":["query","mongodb","querybuilder"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":79,"score":4,"question_id":12799256,"title":"How to build an $in query of ObjectIds using QueryBuilder with MongoDB","body":"<p>I am trying to build an $in query with QueryBuilder (MongoDB Java API 2.9.1).  I have no problem when the query is an array of strings but when I try with an array of ObjectIds it doesn't work (returns nothing).</p>\n\n<p>I am able to run the query successfully and get a result from the console:</p>\n\n<p>Query in console:\ndb.collection.find({removed:false,app_id: {$in : [ObjectId(\"4f75c533ac99d845186e19b2\"), ObjectId(\"4f75c533ac99d845186e19b3\")]}})</p>\n\n<p>Query created by QueryBuilder (MongoDB Java API 2.9.1):</p>\n\n<p>Object[] ids;</p>\n\n<p>Java code:\nDBObject query = QueryBuilder.start(\"app_id\").in(ids).and(\"removed\").is(false).get();</p>\n\n<p>ToString on DBObject produces:\n{ \"app_id\" : { \"$in\" : [ { \"$oid\" : \"4f75c533ac99d845186e19b2\"}]} , \"removed\" : false}</p>\n\n<p>Not sure if I am doing something wrong or the API doesn't support and $in query of type ObjectId.  Any ideas? </p>\n"},{"tags":["php","mysql","sql","query","full-text-search"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12799753,"title":"Search table for keyword","body":"<p>I have a website that basicly consists on a video search engine, I have the follow code that will query mysql for the given input criteria:</p>\n\n<pre><code>$search=htmlspecialchars($_GET['load']); \n$say=mysql_query(\"SELECT * FROM madvideo WHERE MATCH (baslik) AGAINST ('*$search*' IN BOOLEAN MODE)\"); \n</code></pre>\n\n<p>Then I have the follow code that will display the results:</p>\n\n<pre><code>     $katala=mysql_query(\"SELECT * FROM madvideo WHERE MATCH (baslik) AGAINST ('*$search*' IN BOOLEAN MODE) order by id asc limit $s,$perpage\");\n            $i=0;\n                    while ($sea=mysql_fetch_array($katala))  { \n            $i++;\n\n$idd=$sea['id']; $seoo=$sea['seo']; $baslikk=$sea['baslik']; $resimm=$sea['resim']; $suree=$sea['sure'];\n $izlenmee=$sea['izlenme']; $tarihh=$sea['tarih']; $katt=$sea['kat'];\n</code></pre>\n\n<p>Let me try to explain what's the problem with this.\nLets say you search on my website for \"I like to eat strawberry\"</p>\n\n<p>And lets suppose I have on mysql table an entry with the very same name \"I like to eat strawberry\"</p>\n\n<p>With my current code I will get the follow example results:</p>\n\n<p>\"I like to drive my car\"\n\"my car is super fast\"\n\"they eat to much\"\nand so on, and the relevant result might appear but not at first like I would like to be.</p>\n\n<p>How can I make it display the results in a more relevant way, like the google for example? </p>\n"},{"tags":["c#","asp.net","sql","sql-server","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":91,"score":-2,"question_id":12800430,"title":"General setup for an asp.net advanced search with SQL database","body":"<p>I need some recommendations (links, articles, books,...) how to start working on the following project:</p>\n\n<p>A MSSQL database which is yet to be created will contain a couple of dozen tables. I want to create an asp.net website where I search these tables and output the according result. Basically you can think of it as an \"advanced search\" where one can use multiple input fields to run a query.</p>\n\n<p>Do I need to create classes, objects, etc. in C# to deal with this and can/should I create the database with Visual Studio (maybe with a plugin)?\nFor example what do I do when a column is added or removed from a table? Or a new table needs to be added relating to another table? Does this break anything? - I'd like it to be flexible like I could with classes.</p>\n\n<p>I found some examples using only one table but I would like to see how this works with a relational db-setup. I'm not even thinking about the actual queries just the process of how to dig into this topic would already be helpful.</p>\n\n<p>I could also live with a non-asp approach like WPF for example but I doubt it would make things easier.</p>\n\n<p>Maybe you have some examples / design (brain) patterns that I could get started with.</p>\n\n<p>thank you.</p>\n"},{"tags":["mysql","query","stored-procedures","prepared-statement","procedure"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12800152,"title":"Inserting values in temporary table in mysql Procedure","body":"<p>I have a procedure like below </p>\n\n<pre><code>DROP PROCEDURE IF EXISTS mp_search_result;\nCREATE PROCEDURE mp_search_result()                                                   \nBEGIN\n      CREATE TEMPORARY TABLE temp_projids(projid int);\n\n       SET @strSearchSQL = 'SELECT DISTINCT project_id\n                             FROM tblProjects'; \n\n      PREPARE stmt FROM @strSearchSQL;\n      INSERT INTO temp_projids(projid) values ();\n      EXECUTE stmt;\n      DEALLOCATE PREPARE stmt;       \n\nEND;\n</code></pre>\n\n<p>Now I want to insert the project ids returned by the above query into a temporary table.</p>\n\n<p>I am confused with where to write the insert query before execution.</p>\n\n<p>Please note that my requirement is different from query which I posted above.</p>\n\n<p>I am using many if conditions and concatenation for forming <code>@strSearchSQL</code>.</p>\n\n<p>I removed those to prevent the complexity in code.</p>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12799419,"title":"MySQL: UPDATE query joining 3 tables runs long (15M row tables, indexed)","body":"<p>I have 15M rows in 3 tables (one table is the original CSV import, the other two are normalized versions of that CSV + some other data).</p>\n\n<p>I need to simply update one field from the original CSV table. The update query joining these tables has now run for 30 hours on my quad-core-8GB-ssd box. </p>\n\n<ul>\n<li>Is this normal? Is there a better way to perform this simple update?</li>\n</ul>\n\n<hr>\n\n<pre><code>Tables: ti (the CSV dump, denormalized, ~13M rows)\n        i (the primary, normalized table, ~17M rows)\n        icm (a map of ti.raw_id to i.item_id, ~17M rows)\n\nmysql&gt; explain select * from item AS i, item_catalog_map AS icm, temp_input AS ti WHERE i.id=icm.item_id AND icm.catalog_unique_item_id=ti.productID;\n+----+-------------+-------+--------+----------------------+----------------------+---------+------------+----------+-------------+\n| id | select_type | table | type   | possible_keys        | key                  | key_len | ref        | rows     | Extra       |\n+----+-------------+-------+--------+----------------------+----------------------+---------+------------+----------+-------------+\n|  1 | SIMPLE      | i     | ALL    | PRIMARY              | NULL                 | NULL    | NULL       | 13652592 |             |\n|  1 | SIMPLE      | icm   | ref    | IDX_ACD6184F126F525E | IDX_ACD6184F126F525E | 5       | frugg.i.id |        1 | Using where |\n|  1 | SIMPLE      | ti    | eq_ref | PRIMARY              | PRIMARY              | 767     | func       |        1 | Using where |\n+----+-------------+-------+--------+----------------------+----------------------+---------+------------+----------+-------------+\n3 rows in set (0.06 sec)\n\nmysql&gt; UPDATE item AS i, item_catalog_map AS icm, temp_input AS ti\n    -&gt; SET i.name=ti.productName,\n    -&gt;     icm.price=ti.retailPrice,\n    -&gt;     icm.conversion_url=productURL\n    -&gt; WHERE i.id=icm.item_id AND icm.catalog_unique_item_id=ti.productID;\n</code></pre>\n"},{"tags":["sql-server","tsql","query","select-query"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":18107,"score":3,"question_id":1943892,"title":"SQL Server PRINT SELECT (Print a select query result)?","body":"<p>I am trying to print a selected value, is this possible?</p>\n\n<p>Example:</p>\n\n<pre><code>PRINT \n    SELECT SUM(Amount) FROM Expense\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":660,"score":2,"question_id":5007122,"title":"How to select two additional columns from another table based on values in the main table?","body":"<p>I have a table named <code>maintable</code> with 3 columns: <code>id</code>, <code>userid1</code> and <code>userid2</code>.</p>\n\n<p>Another table named <code>users</code> is keyed by <code>userid</code>, and has <code>name</code> as a column.</p>\n\n<p><strong>I want to select something along the lines of:</strong></p>\n\n<pre><code>SELECT maintable.*, users.name AS username1, users.name AS username2 \nFROM maintable, users \nWHERE ...\n</code></pre>\n\n<p>Basically I want to get all the columns in the <code>maintable</code> row, and add two columns at the end that will draw the names for <code>userid1</code> and <code>userid2</code> from the <code>users</code> table.</p>\n\n<p>I'm unsure how to format the where clause for a query like this.</p>\n"},{"tags":["java","json","query","mongodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12795176,"title":"How to access array field from query result in MongoDB","body":"<p>I got a JSON object in Cursor as follows  </p>\n\n<pre><code>{\n        \"field1\": \"val1\",\n        \"field2\": [\n            {\n                \"field3\": \"val3\"\n            },\n            {\n                \"field4\": \"val4\"\n            }\n        ]\n}  \n</code></pre>\n\n<p>I'm able to access the feild1 and its value. How to access field3 and its value?<br>\nI tried the following code but not working  </p>\n\n<pre><code>System.out.println(cursor.next().get(\"field2.field3\"));  \n</code></pre>\n\n<p>Getting null as output.</p>\n"},{"tags":["mysql","database","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":37,"score":-3,"question_id":12798030,"title":"querying in MYSQL according to row number","body":"<p>If there is a way to query according to row number ? Like:</p>\n\n<pre><code>select rownumber from table;\n</code></pre>\n\n<p><strong>what i am trying to do:</strong>\nI have computed the total number of rows in a table using sub queries and now I want to display only the last one.</p>\n\n<p><strong>rookie answer:</strong></p>\n\n<p>I wanted to get the 2nd highest salary. so this is what i did:</p>\n\n<pre><code>select * from gg where salary&lt; (select max(salary) from gg) order by salary desc limit 1\n</code></pre>\n\n<p>This doesnot work for Nth highest salary its for 2nd highest only. AND I AM NEW TO THIS SO I JUST WANTED TO GET THE 2ND HIGHEST BY MY OWN METHOD.</p>\n"},{"tags":["sql","query","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":12795809,"title":"SQL to NHibernate Criteria Query Convert","body":"<p>Please help me convert this SQL to Criteria in Nhibernate. If you have any document teaching how to do it please give me:</p>\n\n<pre><code>select distinct visa \nfrom employee e ,\n    (select NumberOfEmployee,GroupLeaderId\n     from [Group] as G JOIN\n        (select count(distinct employeeid) as NumberOfEmployee, GroupId\n         from [Project]  p JOIN [EmployeeFunctionInProject] e\n         ON p.ProjectId = e.ProjectId\n         group by p.ProjectId,Name,GroupId )\n               as P\n     ON G.GroupId=P.GroupId\n          and NumberOfEmployee &gt;=3) as Result\nwhere e.EmployeeId = Result.GroupLeaderId\n</code></pre>\n"},{"tags":["wordpress","query","pagination"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12778304,"title":"Wordpress custom query missing two posts","body":"<p>I am running a custom query but when returning posts_per_page, it is always two behind. I am using a custom post type called events, that is pulling in the code to display the posts from the functions file. I also want to implement pagination(not working also), will this be a problem?</p>\n\n<p>I have ran var dump which returns everything in the query including posts before the current date. I imagine because it's dumping before the if statement? Any ideas?</p>\n\n<p>Any ideas?</p>\n\n<pre><code>&lt;?php\n    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n    //Current exhibitions\n    $args = array(\n           'post_type' =&gt; 'exhibitions',\n           'orderby'   =&gt; 'exhibition_start_date',\n           'meta_key'  =&gt; 'exhibition_start_date',\n           'order'     =&gt; 'ASC',\n           'posts_per_page' =&gt; 6,\n           'paged' =&gt; $paged\n       );\n\n        $my_query = new WP_Query( $args );\n\n      while ( $my_query-&gt;have_posts() ) : $my_query-&gt;the_post();\n           $exhibition_start_date = get_post_meta($post-&gt;ID, 'exhibition_start_date', true);\n           //Current\n\n           if ($exhibition_start_date &gt;= date('Y-m-d') ) {\n               get_exhibition_container();\n           }\n\n        endwhile;\n\n   wp_reset_postdata();\n?&gt;\n</code></pre>\n\n<p>New code: (I've also added in my initial loop which brings in the page content, thought it could interfear?)</p>\n\n<pre><code>&lt;div role=\"main\" class=\"clearfix\"&gt;  \n    &lt;div class=\"one-column\"&gt;\n    &lt;?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?&gt;\n    &lt;h2&gt;&lt;?php the_title(); ?&gt;&lt;/h2&gt;\n    &lt;?php the_content(); ?&gt;\n    &lt;?php endwhile; else: ?&gt;\n     &lt;?php endif; ?&gt;\n\n&lt;?php\n    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;\n    //Current exhibitions\n    $args = array(\n           'post_type' =&gt; 'exhibitions',\n           'meta_query' =&gt; array(\n           array (\n                    'key' =&gt; 'exhibition_start_date',\n                    'value' =&gt; date('Y-m-d'),\n                    'compare' =&gt; '&gt;='\n                 )\n            ),\n           'orderby'   =&gt; 'exhibition_start_date',\n           'meta_key'  =&gt; 'exhibition_start_date',\n           'order'     =&gt; 'ASC',\n           'posts_per_page' =&gt; 10,\n           'paged' =&gt; $paged\n       );\n\n        $my_query = new WP_Query( $args );\n\n\n      while ( $my_query-&gt;have_posts() ) : $my_query-&gt;the_post();\n           $exhibition_start_date = get_post_meta($post-&gt;ID, 'exhibition_start_date', true);\n           //Current\n            get_exhibition_container();\n\n\n        endwhile;\n\n   wp_reset_postdata();\n?&gt;\n\n&lt;div class=\"previous-holder\"&gt;\n&lt;?php previous_posts_link(); ?&gt;\n&lt;/div&gt;\n&lt;div class=\"next-holder\"&gt;\n&lt;?php next_posts_link(); ?&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["android","database","query","sqlite"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12797296,"title":"Problems with database Query when looking for a String","body":"<p><code>enter code here</code>I am trying to write a query to extract all rows in my Android SQLite database table where the location reference = \"a string\".  I am using the following code in my database helper class:</p>\n\n<pre><code>public Cursor fetchComponentsForLocation(String locationRef) {\n    Cursor mCursor =\n            rmDb.query(true, LOCATIONS_TABLE, new String[] {\n                    LOCATION_ID, RUN_LINK, AREA_LINK, INSPECTION_LINK, LOCATION_REF, RACKING_SYSTEM, COMPONENT, POSITION, RISK, ACTION_REQUIRED, NOTES_GENERAL, MANUFACTURER, TEXT1, TEXT2, TEXT3, TEXT4, NOTES_SPEC}, \n                    LOCATION_REF + \"=\" + locationRef, null,\n                    null, null, null, null);\n        if (mCursor != null) {\n            mCursor.moveToFirst();\n        }\n        return mCursor;\n}\n</code></pre>\n\n<p>And I call it in my activity as follows:</p>\n\n<pre><code>    // Get a Cursor for the list items\n    Cursor listComponentCursor = rmDbHelper.fetchComponentsForLocation(locationRef);\n    startManagingCursor(listComponentCursor);           \n\n    // set the custom list adapter     \n    setListAdapter(new MyListAdapter(this, listComponentCursor)); \n</code></pre>\n\n<p>Which then gets used in my ListAdapter to fill my list view.  Now in my other activities, when I am fetching rows based on the id (i.e. a long), this code works fine.  When I try it with String I get the following error:</p>\n\n<p><em><code>Caused by: android.database.sqlite.SQLiteException: **no such column: g:** , while compiling: SELECT DISTINCT _id, run_link, area_link, inspection_link, location_reference, racking_system, component, position, risk, action_required, notes_general, manufacturer, text1, text2, text3, text4, notes_spec FROM location_table WHERE location_reference=g</code></em></p>\n\n<p>As you can see, in this case the String = 'g', but it seems to looking for a column called 'g' instead of looking at the data!</p>\n\n<p>Very confused why this works with long but not String.  Help appreciated as always.</p>\n"},{"tags":["java","query","mongodb","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12796602,"title":"MongoDB Query with Java","body":"<p>I have the following database structure in MongoDB (see below) and I want to do a search query  on the fields 'name'</p>\n\n<p>Database structure:</p>\n\n<pre><code>         {\n            \"_id\" : ObjectId(\"505ad9a7ed5022cbe1f3dc2e\"),\n            \"id\" : \"10\",\n            \"description\" : \"\",  \n            \"members\" : [{\n              \"id\" : \"1\",\n              \"name\" : \"Jack\" \n            }, {\n              \"id\" : \"2\",\n              \"name\" : \"Mike\" \n            }, {\n              \"id\" : \"3\",\n              \"name\" : \"Laura\" \n            }, {\n              \"id\" : \"4\",\n              \"name\" : \"Sara\" \n            }, {\n              \"id\" : \"240\",\n              \"name\" : \"Ronald\" \n            }],\n            \"status\" : \"active\"\n        },  \n        {\n            \"_id\" : ObjectId(\"5059c214707747cbc5819f6f\"),\n            \"id\" : \"12\",\n            \"description\" : \"\",  \n            \"members\" : [{\n              \"id\" : \"19\",\n              \"name\" : \"Geoff\" \n            }, {\n              \"id\" : \"21\",\n              \"name\" : \"Andrew\" \n            }, {\n              \"id\" : \"23\",\n              \"name\" : \"Rachel\" \n            }, {\n              \"id\" : \"25\",\n              \"name\" : \"Susan\" \n            }],\n            \"status\" : \"active\"\n        },  \n</code></pre>\n\n<p>I have the following code will do a search on the field 'description' or 'status'.          DBCollection collection = database.getCollection(\"members\");</p>\n\n<pre><code>        BasicDBObject or1 = new BasicDBObject(); \n        or1.put(\"description\",  Pattern.compile(keyword, Pattern.CASE_INSENSITIVE)); \n\n        BasicDBObject or2 = new BasicDBObject(); \n        or2.put(\"status\",  Pattern.compile(keyword, Pattern.CASE_INSENSITIVE));         \n\n        BasicDBList or = new BasicDBList();\n        or.add(or1); \n        or.add(or2);        \n\n        BasicDBObject query = new BasicDBObject(); \n        query.put(\"$or\", or);\n\n        BasicDBObject select = new BasicDBObject();\n        select.put(\"description\", 1);  \n        select.put(\"status\", 1);    \n        DBCollection collection = collection.find(query, select);\n</code></pre>\n\n<p>Question is, how would I do an OR search on the field 'members.name' ? So if I would search for the name or text 'Laura' that the document/record with id 10 will be in the result set.</p>\n\n<p>Would I have to loop through all the results or something like that?</p>\n\n<p>Thanks for any help or suggestions!</p>\n"},{"tags":["query","postgresql","table","geospatial","postgis"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12779563,"title":"Creating PostGIS my first Table","body":"<p>I have about 2 million records in a table in PostgreSQL database with columns such as \"source_location\", \"destination_location\", \"source_lat\",\"source_long\",\"destination_lat\",\"destination_long\" etc.</p>\n\n<p>How do I make use of this table to convert it into Spatial table in PostGIS so that I can fire spatial queries on this data?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":12794237,"title":"SQL query to fetch records based on related id in the same table","body":"<p><strong>Table Structure:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/6WvvE.png\" alt=\"enter image description here\"></p>\n\n<p><strong>I Tried this:</strong></p>\n\n<pre><code>select Id, Name from Color where ParentId=4\nUNION\nselect Id, Name from Color where ParentId=(select Id from Color where ParentId=4)\n</code></pre>\n\n<p>Above approach is static in this case I have to know all the Ids. I'm looking something dynamic approach since I would have only Color's ParentId value.</p>\n\n<p>As example: For ParentId=4 there are two records; Name Blue and Red their Id is 6 and 10 respectively. Now here, I need to get all the records where Id 6 and 10.</p>\n"}]}
{"total":20740,"page":14,"pagesize":100,"questions":[{"tags":["mysql","sql","database","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12795473,"title":"Finding row index of a row from a selected number of row in mysql","body":"<p>Here is my mysql query</p>\n\n<pre><code>SELECT network_mst.NetworkId,network_mst.NetworkName,network_mst.InternationalDBStatus,network_mst.Of fshoreDBStatus,network_mst.InterDBStatus,network_mst.IntraDBStatus \nFROM network_mst INNER JOIN carrier_network ON network_mst.NetworkId=carrier_network.NetworkId\nINNER JOIN user_network ON network_mst.NetworkId=user_network.NetworkId WHERE UserId=1\nAND carrier_network.CarrierId IN (1) GROUP BY network_mst.NetworkId ORDER BY  network_mst.NetworkName;\n</code></pre>\n\n<p>The resulting data is \n<img src=\"http://i.stack.imgur.com/OvXXc.png\" alt=\"enter image description here\"></p>\n\n<p>Sorry for the small image.It has a field called NetworkId.\nSo my question is how to find the row index of a row with NetworkId 2.Here the answer is row index of row with NetworkId 2 is 3.\nBut how to find this using query</p>\n"},{"tags":["sql-server-2008","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12793566,"title":"How can I convert images into binary format and insert them into table?","body":"<p>I have 200 images that I have to convert into binary format. And then I have to insert all them into myImages table without make changes in the current name of my all images.\nMy table structure is :</p>\n\n<pre><code>Id              int             Unchecked\nPictureBinary   varbinary(MAX)  Checked\nMimeType        nvarchar(40)    Unchecked\nSeoFilename     nvarchar(300)   Checked\nIsDeleted       bit             Unchecked\n</code></pre>\n\n<p>Can any one help me to do that? I want to insert all binary images by single query or by store procedure.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":45,"score":-7,"question_id":12794991,"title":"Select rows with in particular range sql query","body":"<p>I have a table like below. </p>\n\n<p>It Stores Students Details.  </p>\n\n<p>I want a sql query to have students Name who are between age 15 and 27.   </p>\n\n<p><PRE></p>\n\n<pre><code>CREATE TABLE Students(Sno       INT NOT NULL PRIMARY KEY AUTO_INCREMENT,\n                      Name      VARCHAR(255),\n                      Age_Start INT,\n                      Grade     VARCHAR(255));\n\n\nINSERT INTO Students(Name, Age_Start, Grade)\n              VALUES('Student 1', 10, 'Grade A'),\n                    ('Student 2', 15, 'Grade B'),\n                    ('Student 3', 18, 'Grade C'),\n                    ('Student 4', 21, 'Grade D'),\n                    ('Student 5', 24, 'Grade E'),\n                    ('Student 5', 27, 'Grade F'),\n                    ('Student 5', 30, 'Grade G');\n</code></pre>\n\n<p></PRE></p>\n\n<p>Output\n<prE> \n  <strong>Students Name</strong>\n  Student 2\n  Student 3\n  Student 4\n  Student 5\n</prE></p>\n\n<p>Thanks in Advance</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":43,"score":-4,"question_id":12794880,"title":"table distinct and Group By","body":"<p>I have a table like</p>\n\n<pre><code>id   field\n\n1     1\n2     1\n3     1\n3     1\n3     1\n1     2\n1     2\n4     1\n4     1\n4     1\n3     2\n2     2\n1     2\n2     1\n2     1\n6     1\n2     3\n3     3\n1     3\n</code></pre>\n\n<p>It has many Duplicate values. How can I show record like</p>\n\n<pre><code>id   field\n 1     1\n 1     2\n 1     3\n 2     1\n 2     2\n 2     3\n 3     1\n 3     2\n 3     3\n 4     1\n 6     1\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12794552,"title":"MySQL SELECT based on aggregate of multiple columns","body":"<p>I have a table in MySQL with a number of normal fields and a number of \"approval\" fields that contain a <code>1</code> if the data in question is approved and a <code>0</code> otherwise. For example,</p>\n\n<pre><code>*==============================================================*\n* id  |  fname  | lname | fname_approved | lname_approved | ...*\n*--------------------------------------------------------------*\n* ... |   ...   |  ...  |        0       |        1       | ...*\n</code></pre>\n\n<p>In reality, there are many more columns, but it is just more of the same. What I would like to be able to do is select a single value, say <code>all_approved</code> that would be equal to 1 if <em>all</em> of the <code>_approved</code> fields contain 1 and would be equal to 0 if <em>any</em> of the fields contain a 0. Is there any easy way to do this in SQL, or do I need to handle it in my application logic?</p>\n"},{"tags":["sql","database","query","sql-order-by","distinct"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12794751,"title":"ORDER BY items must appear in the select list if SELECT DISTINCT is specified","body":"<p>I have sql query in which i want return rows with distinct value order by particular column.\nlike say,i want disntict batchno from ordertable order by locationid.</p>\n\n<p>i have tried google also but not able to find out solution </p>\n\n<pre><code>ORDER BY items must appear in the select list if SELECT DISTINCT is specified.\n</code></pre>\n\n<p>that what i got every time i tried.</p>\n\n<p>when not using distinct i got output but with duplicate rows using this query</p>\n\n<pre><code>Select Batchno,LocationId from Ordertbl order by case when[LocationId] =3 THEN 0 ELSE 1 END, [LocationId]\n</code></pre>\n\n<p>if i use distinct it gives me error these are query i tried out.</p>\n\n<pre><code>Select distinct CAST(Batchno as Varchar(MAX)),LocationId from Ordertbl order by case when[LocationId] =3 THEN 0 ELSE 1 END,[LocationId]\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Select distinct CAST(Batchno as Varchar(MAX)),LocationId from Ordertbl order by case when[LocationId] =3 THEN 0 ELSE 1 END,[LocationId],[Batchno]\n</code></pre>\n\n<p>so this is things i tried but no luck.please help me.</p>\n"},{"tags":["mysql","query","yii"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":12792018,"title":"YII SQL Query Optimization","body":"<p>I huge list of IDs that i need to query through a table to find if those IDs are available in the table, if yes fetch its model.</p>\n\n<p>Since there are few thousands of IDs this process is really slow as I'm using CActiveRecord::find() mothod </p>\n\n<p>ex. <code>$book = Book::model()-&gt;find('book_id=:book_id', array(':book_id'=&gt;$product-&gt;book_id));</code></p>\n\n<p>I even indexed all possible keys, still no improvement.\nAny suggestions to improve the execution speed?</p>\n\n<p>thanks in advance :)</p>\n"},{"tags":["mysql","database","query","join","many-to-many"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":12073177,"title":"MYSQL many to many 3 tables query","body":"<p>EDIT. I missed the one main issue I was having. I want to display all the unique 'device_MAC' rows. So I want this query to output 3 rows (as per the original query). The issue I am having is connecting the <code>data</code> table to the <code>remote_node</code> table via <code>dt_short</code> = <code>rn_short</code> where the maximum timestamp for <code>dt_short</code> in the <code>data</code> table.</p>\n\n<p>I am having trouble running a query on 3 tables (2 have many to many relations).</p>\n\n<p>What I am trying to do:</p>\n\n<ol>\n<li>Get each distinct <code>rn_IEEE</code> from the <code>remotenodes</code> table with the maximum timestamp (in the example this will get 3 rows with 3 distinct short addresses <code>rn_short</code>)</li>\n<li>Join with the <code>devicenames</code> table on device_IEEE</li>\n<li>Get each distinct <code>dt_short</code> from the <code>data</code> table with the maximum timestamp</li>\n<li>Join <code>dt_short</code> with <code>rn_short</code> from the query above</li>\n</ol>\n\n<p>Now the problem I am running into is that I can do the queries for the above individually, I have even gotten the first 3 of them together into a query but I cannot seem to properly join the last bit of data to get the result that I want.</p>\n\n<p>I have been going in circles trying to solve this. Here is a link to SQL Fiddle which contains all the test data and the query as far as I got it, it does what i want for the first line but from table 'data' after the first line is NULL:</p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/ccbe1/64\" rel=\"nofollow\">See this SQL fiddle</a></p>\n"},{"tags":["database","django","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12791219,"title":"Django Filter Returns 0 Results Even Though Database Table Has Data","body":"<p>I have been stumped with this one for hours.  A query filter in Django is not behaving as expected, and I'm wondering if it's related to either (a) reserved word or (b) unicode confusion or (c) something totally different. </p>\n\n<p>I have a model called Route with the following fields:</p>\n\n<pre><code>from_number = models.CharField(max_length=15)\nother_number = models.CharField(max_length=15) \n</code></pre>\n\n<p>I want to get a list of other_number's from the database where the from_number equals a variable from_number.</p>\n\n<p>This is the code I'm trying, but it returns an empty list:</p>\n\n<pre><code>list = Route.objects.filter(from_number=from_number).values_list('other_number', flat=True)\n</code></pre>\n\n<p>Even if I hard-code the value in the filter to a value that I know is in the database like this, I get an empty list:</p>\n\n<pre><code>list = Route.objects.filter(from_number='+18005551212').values_list('other_number', flat=True)\n</code></pre>\n\n<p>However, from inspecting the database (PostgreSQL), I know the database has several rows that should be returned.  For example, this code without the filter returns a list of all the values:</p>\n\n<pre><code>list = Route.objects.all().values_list('other_number', flat=True)\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","mysql","query","echo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12789826,"title":"Cannot print the results of MySQL query with PHP","body":"<p>I have the following MySQL query</p>\n\n<pre><code>$jokerQuery = mysql_query(\"SELECT `Joker sport`,\n        COUNT(`Joker sport`) AS jokerCount\n        FROM Profiles\n        WHERE `CompetitorID` = 5\n        GROUP BY `Joker sport`\n        ORDER BY COUNT(`Joker sport`) DESC\n        LIMIT 1\n    \");\n</code></pre>\n\n<p>which returns the following result in phpMyAdmin</p>\n\n<pre><code>Joker sport | jokerCount\n8           | 8\n</code></pre>\n\n<p>I thought the following php would display the result but it doesn't work. What should I write to echo the result?</p>\n\n<pre><code>$jokerResult = mysql_fetch_array($jokerQuery);\necho $jokerResult['Joker sport'];\necho $jokerResult['jokerCount'];\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12754587,"title":"Query count with three joining table","body":"<p>I been trying to figure this out all afternoon. I'm not even sure if it's possible with the current database structure. I've tried the following statement but it didn't return what I need. The problem with the statement below is that it only returns the projectType if it exists. I need to return zero if the projectType doesn't exists. Any help is much appreciated.</p>\n\n<pre><code>SELECT r.region, ISNULL(o.totalcount,0) AS TotalCount, o.projectType\n  FROM region r \n  LEFT JOIN (\n    SELECT COUNT(o2.id) AS TotalCount, o2.regionID, t2.projectType\n      FROM projects o2 \n      RIGHT JOIN projectTypes t2 on o2.typeID = t2.id\n      GROUP BY o2.regionId, t2.projectType\n  ) o ON r.id = o.regionId\n  ORDER by r.Region\n</code></pre>\n\n<pre>\nregions:\n-------------------------\nid  | region    |\n-------------------------\n1   | East      |\n-------------------------\n2   | MidWest   |\n-------------------------\n3   | West      |\n-------------------------\n\n\nProject Type:\n-------------------------\nid  | projectType   | \n-------------------------\n1   | Web Desgin    |\n-------------------------\n2   | Database  |\n-------------------------\n3   | Development   |\n-------------------------\n\n\nProjects:\n-------------------------------------------------------------------------\nid  | projectName   | regionID  | projectTypeID | postedOn  |\n-------------------------------------------------------------------------\n1   | Project 1 | 1     | 2     | 2012-09-02    |\n-------------------------------------------------------------------------\n2   | Project 2 | 2     | 2     | 2012-09-02    |\n-------------------------------------------------------------------------\n3   | Project 3 | 1     | 1     | 2012-09-02    |\n-------------------------------------------------------------------------\n4   | Project 4 | 3     | 2     | 2012-09-02    |\n-------------------------------------------------------------------------\n5   | Project 5 | 3     | 1     | 2012-10-02    |\n-------------------------------------------------------------------------\n6   | Project 6 | 3     | 2     | 2012-10-02    |\n-------------------------------------------------------------------------\n7   | Project 7 | 3     | 3     | 2012-10-02    |\n-------------------------------------------------------------------------\n8   | Project 8 | 2     | 3     | 2012-10-02    |\n-------------------------------------------------------------------------\n9   | Project 9 | 1     | 2     | 2012-10-02    |\n-------------------------------------------------------------------------\n10  | Project 10    | 1     | 2     | 2012-10-02    |\n-------------------------------------------------------------------------\n\n\n\nDesired Results:\n-----------------------------------------\nRegion  | project Type  | totalCount    |\n-----------------------------------------\nEast    | Web Desgin    | 1     | \n-----------------------------------------\nEast    | Database  | 3     |\n-----------------------------------------\nEast    | Development   | 0     |\n-----------------------------------------\nMidwest | Web Desgin    | 0     | \n-----------------------------------------\nMidwest | Database  | 2     |\n-----------------------------------------\nMidwest | Development   | 1     |\n-----------------------------------------\nWest    | Web Desgin    | 1     | \n-----------------------------------------\nWest    | Database  | 2     |\n-----------------------------------------\nWest    | Development   | 1     |\n-----------------------------------------\n</pre>\n"},{"tags":["android","query","count"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12790200,"title":"SQL query: certain items and all items in one query?","body":"<p>Is it possible in one query to select certain items (f.e. WHERE OK = 1) and to count all items? It seems better to me to do this in one query (if possible) to reduce the 'thinking time' of the phone... I just don't seem to find something about combining these two.</p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12775090,"title":"how to parsing array to MYSQL IN()?","body":"<p>I'm have a problem when I want to query to the database , in this case I want to using IN() mysql function for searching data by value field on array.</p>\n\n<p>example I have array from php </p>\n\n<pre><code>$data = array(1,2,3,4);\n</code></pre>\n\n<p>and this is my query code to selection data on table Employee</p>\n\n<pre><code>$query = 'SELECT * FROM employee_tbl \n    -&gt; WHERE daily_typing_pages IN ' .$data.;\n</code></pre>\n\n<p>when I'm execute that code I have error like this</p>\n\n<pre><code>Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Array \nSELECT * FROM employee_tbl \n        -&gt; WHERE daily_typing_pages IN Array;\n</code></pre>\n\n<p>I think that error is come because Array read as string,and don't parse to this format <code>(1,2,3,4)</code></p>\n\n<p>how i can convert to that format ? \nany suggestion?</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12789419,"title":"php mysql search by variable?","body":"<p>Please help me with how can I retrieve data from mysql having a variable in\nmy sql query.. my php code is</p>\n\n<pre><code>$status=$_GET['status'];\n$query=\"SELECT * FROM students WHERE status='$status' \";\n</code></pre>\n\n<p>When I run the query mysql generates </p>\n\n<pre><code> unknown column 'Lead'\n</code></pre>\n\n<p>where Lead is the value of $status. I tried it with \n\\'$status\\' , '{$status}' but same error..\nPlease help me I'm working on it since yesterday but found no solution.\nI tried mysql_real_escape_string() but same error.. may be I was using it with wrong syntax.</p>\n\n<pre><code>  $query=\"SELECT * FROM students WHERE status=\".mysql_real_escape_string($status);\n</code></pre>\n\n<p>Thanks in advance....</p>\n"},{"tags":["mysql","sql","query","yii"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12789026,"title":"Using Yii Querybuilder vs writing actual query","body":"<p>What are the pros and cons of using Yii QueryBuilder (or any other types of query builders) to construct actual queries instead of just writing out the queries?</p>\n"},{"tags":["mysql","database","query","joomla"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12786739,"title":"MYSQL query from different tables same ID","body":"<p>i'm really confused in how to do this in mysql and if it's possible at all. I have a table where i need to select articles which have id = idi:</p>\n\n<pre><code>$query-&gt;select('title, id, idi, introtext');\n$query-&gt;from('#__content');\n$query-&gt;where('idi = ' . $id);\n</code></pre>\n\n<p>So, now component shows main article ( id ) and extra articles which has same IDI as ID.</p>\n\n<h1>__content table</h1>\n\n<pre><code>ID IDI\n0    0\n1    0\n2    1\n3    1\n</code></pre>\n\n<p>So, article with ID 1 will have extra articles with ID 2,3 because IDI is 1. ID=IDI</p>\n\n<p>And now i need to get extra articles voting_results from table ratings where votings_results ID are equal to #__content id.</p>\n\n<h1>__ratings table</h1>\n\n<pre><code>ID voting_result1\n0           55\n1          123\n2           64          &lt;--\n3           42          &lt;--\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":348,"score":-2,"question_id":3689035,"title":"Oracle SQL Issue with Insert Statements","body":"<p>So I am a beginner to this, and trying to follow my professors instructions on how to complete this.  They are as follows:</p>\n\n<p>Consider the relational database described in Tables 1-3.  The underlined attribute(s) is the primary key for a table.  Use your Oracle account to create this database and to insert the tuples listed in each table.  Make sure you include the primary key and foreign key constraints.  Put check constraints on the following three attributes.  Rating (between 0 and 10), Lengith (greater than 0), ReleaseDate (after 1/1/1900). </p>\n\n<p>Table 1: Theatres<br>\nName (Underlined as Primary), City, State, Zip, Phone</p>\n\n<p>Table 2: Movies<br>\nTitle (Primary), Rating, Length, ReleaseDate</p>\n\n<p>Table 3: ShownAt<br>\nTheatreName, MovieTitle (BOTH listed as Primary)</p>\n\n<p>Here is how I have them declared:</p>\n\n<pre><code>CREATE TABLE Theatres (\nName   varchar2(50) not null,\nCity   varchar2(50) not null,\nState   varchar2(50) not null,\nZip   number not null,\nPhone   varchar2(50) not null,\nCONSTRAINT name_pk PRIMARY KEY (Name)\n);\n\ncreate table Movies (\nTitle   varchar2(100),\nRating NUMBER CONSTRAINT Rating_CHK CHECK (Rating BETWEEN 0 AND 10),\nLength NUMBER CONSTRAINT Length_CHK CHECK (Length &gt; 0),\nReleaseDate date CONSTRAINT RDATE_CHK CHECK (ReleaseDate &gt; to_date('1/January/1900', 'DD/MONTH/YYYY')),\nCONSTRAINT title_pk PRIMARY KEY (Title)\n);\n\ncreate table ShownAt (\nTheatreName varchar2(50),\nMovieTitle varchar2(100),\nCONSTRAINT moviet_fk FOREIGN KEY (MovieTitle) REFERENCES Movies(Title),\nCONSTRAINT shown_pk PRIMARY KEY (TheatreName, MovieTitle)\n);\n</code></pre>\n\n<p>This declares fine, and I get no errors.  Below are my inserts (I gave one example insert for each table):</p>\n\n<pre><code>insert into theatres values ( 'Great Escape 14', 'Wilder', 'KY', '41076', '(859) 442-0000' );\ninsert into movies values ( 'The Expendables', '7.6', '103', '13 August 2010' );\ninsert into shownat values ( 'Great Escape 14', 'The Expendables' );\n</code></pre>\n\n<p>All inserts into theatres and movies go off without a hitch.  For ShownAt, I get A LOT OF ERRORS, most of which look something like this:</p>\n\n<pre><code>Error starting at line 37 in command:\ninsert into shownat values ( 'Showcase Cinema De Lux Florence', 'The Pianist' )\nError report:\nSQL Error: ORA-02291: integrity constraint (LANGB1.MOVIET_FK) violated - parent key not found\n</code></pre>\n\n<p>Meaning:</p>\n\n<pre><code>02291. 00000 - \"integrity constraint (%s.%s) violated - parent key not found\"\n*Cause:    A foreign key value has no matching primary key value.\n*Action:   Delete the foreign key or add a matching primary key.\n</code></pre>\n\n<p>Any insert into ShownAt where the title is just one word (say the movie Up) works just fine, but anything with more than one word (like The Expendables) won't execute, and give the above error.  ANY HELP would be much appreciated.  I can post any other details that you need.</p>\n"},{"tags":["php","sql","query","sql-order-by"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12788173,"title":"SQL query: Can't order by column called \"order\"?","body":"<p>I am pulling a column in an existing script into my template files, and everything is working great.</p>\n\n<p>The only problem is, that this script has a column called <code>order</code>, and every row then has a number in that column to show which should be at the top etc. If I set my query to \"<code>ORDER BY name</code>\" for example, everything works fine, but when I use \"<code>ORDER BY order</code>\", then I get a SQL error.<br />\nCan I not have a column called <code>order</code>? I can't change column name, because it's part of the script. </p>\n\n<p>Is there a way around it?</p>\n\n<p>This is the line in my SQL query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM categories WHERE hide = 0 ORDER BY order \n</code></pre>\n"},{"tags":["php","mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12788334,"title":"How to exclude equal values from a query result","body":"<p>I have this query:</p>\n\n<pre><code>SELECT queue.first_dealer, queue.second_dealer, queue.status\nFROM queue\nWHERE queue.status = 3\nAND queue.first_dealer = $user_id\nOR queue.second_dealer = $user_id\nAND queue.status = 3\nORDER BY id DESC\nLIMIT 5\n</code></pre>\n\n<p>But sometimes the first_dealer or the second_dealer can be the same, I want to skip to the next records if they are the same.</p>\n"},{"tags":["php","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12788137,"title":"get count of posts based on count(*)","body":"<p>i am trying to get number of posts that i have</p>\n\n<p>Here is my query</p>\n\n<pre><code>$Query=\"\n    SELECT t.*,u.*,c.*\n    FROM posts as t\n    LEFT JOIN relations as r on r.post_id = t.post_id\n    LEFT JOIN users as u on t.auther_id = u.auther_id\n    LEFT JOIN categories as c on c.cate_id = r.cate_id\n    GROUP BY t.post_id\n\";\n\n    $Query=mysql_query($Query);\n    $numberOfPosts=mysql_num_rows($Query);\n</code></pre>\n\n<p>This query is works very well</p>\n\n<p>but i am trying to convert it, i want make it faster</p>\n\n<p>i want use <code>count(*)</code> instead of <code>t.*</code></p>\n\n<p>because when i use t.*, it gets the full data of posts and categories</p>\n\n<p>but i want to get count only, So i decided to use <code>count(*)</code> but i don't know how to use it with query like this</p>\n\n<h1>Edit</h1>\n\n<p>i've replaced SELECT <code>t.*,u.*,c.*</code> with SELECT <code>count(t.*)</code></p>\n\n<p>But i got mysql Error <code>Warning: mysql_fetch_assoc(): supplied argument</code></p>\n\n<h1>Edit 2:</h1>\n\n<p>i am trying SELECT <code>count(t.post_title)</code></p>\n\n<p>I Got this results</p>\n\n<pre><code>Array ( [count(t.post_id)] =&gt; 10 ) \n</code></pre>\n\n<p>But i have only 2 posts!</p>\n"},{"tags":["mysql","database","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12788098,"title":"Query help – distinct records with max","body":"<p>I have a table called <code>activities</code> with person, sport and the date the person played the sport. Example:</p>\n\n<pre><code>person | sport      | date\n--------------------------------\njane   | soccer     | 09/15/2012\nsam    | basketball | 09/10/2012\njane   | tennis     | 09/12/2012\nsam    | basketball | 09/08/2012\nsam    | soccer     | 09/04/2012\njane   | tennis     | 09/01/2012\nsam    | basketball | 08/27/2012\njane   | football   | 08/23/2012\n</code></pre>\n\n<p>I need the rows containing the newest date a person played a sport. The results would be:</p>\n\n<pre><code>person | sport      | date\n--------------------------------\njane   | soccer     | 09/15/2012\nsam    | basketball | 09/10/2012\njane   | tennis     | 09/12/2012\nsam    | soccer     | 09/04/2012 \njane   | football   | 08/23/2012\n</code></pre>\n\n<p>You can see here that, for example, the row for Jane playing tennis on 9/1 is excluded because she also played on a newer date of 9/12.</p>\n\n<p>What would this query be? I'd prefer non sub-query answers, but all answers are welcome. Also, both MySQL and PostgreSQL answers are welcome.</p>\n"},{"tags":["java","query","mongodb","conditional-operator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12780760,"title":"How to use AND & OR condition in JAVA mongo db array collection","body":"<p>I have the Java Mongo Collection in the following format.    </p>\n\n<pre><code>{\n\"field1\": [\"f1\",\"f2\"],\n\"field2\": [\"g1\",\"g2\"],        \n    \"Ans\": a1\n} \n{\n    \"field1\": [\"f4\",\"f5\"],\n    \"field2\": [\"g5\",\"g6\"],        \n        \"Ans\": a2\n} \n{\n    \"field1\": [\"f1\",\"f6\"],\n    \"field2\": [\"g2\",\"g3\"],        \n        \"Ans\": a3\n} \n</code></pre>\n\n<p>I need to do the \"OR\" condition in field1 and field2 separately<br>\nFrom the result i need to do and condition to select the row.<br>\nFor example: f1,f5,g2,g3 is the input i get.<br>\ni need to do or condtion in field 1 with f1,f5 so i will get all the three rows<br>\ni need to do or condtion in field 2 with g,g3 so i will get 1st and 3rd rows<br>\nwhile doing and condition of both i need to get only 1st and 3rd row.<br>\nFollwing is the code im using    </p>\n\n<pre><code>        DBObject query1 = new BasicDBObject(\"field1\",\"f1\");  \n        DBObject query2 = new BasicDBObject(\"field1\",\"f5\");  \n        BasicDBList condtionalOperator = new BasicDBList();\n        condtionalOperator.add(query1);\n        condtionalOperator.add(query2);\n        DBObject query = new BasicDBObject(\"$or\", condtionalOperator);    \n</code></pre>\n\n<p>Similar OR query for field 2 and And query for their result<br>\n  I know its pretty long. Any one knows simple code than this?</p>\n"},{"tags":["java","query","hibernate","collections"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":12784960,"title":"Hibernate: Select entities where collection contains all of the specified valus","body":"<p>I need assistance with a tricky hibernate query problem. I have the following entities:</p>\n\n<pre><code>public class Book {\n   private String bookId;\n   private String author;\n   private String isbn;\n   private Set&lt;Tag&gt; tags;\n   // getters, setters etc.\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>public class Tag  {\n   private String tagId;\n   private String tagName;\n  // getters, setters, etc.\n}\n</code></pre>\n\n<p>There is a many-to-many association between the two that is represented by a join table books_tags_mn with the columns book_id and tag_id.</p>\n\n<p>What I like to do is the following: I want to create a hibernate query/criteria query that returns all book that have <strong>all</strong> of a certain set of tags. What does work is to select all books that have <strong>any</strong> of a set of tags.</p>\n\n<p>I've been messing around with the criteria API but did not truly understand it. So what I am trying to do (in pseudo HQL)</p>\n\n<pre><code>from Book book where book.tags containsAll(:tags)\n</code></pre>\n\n<p>Any help on this would be highly appreciated, so thank you very much in advance.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":56,"score":-1,"question_id":12786853,"title":"Need Help regarding update query or append query","body":"<p>I need help related to update or append query.</p>\n\n<p>I have a table related to customer details. Previously it was with 2 fields for <code>address(address1, address2)</code>. I added another field <code>address3</code>. I copied some long addresses and split them over 3 address fields. That was for initial 1500 records. After that we added more records, and now the total is 3000 records. What I want is how I should update those 1500 records or what can be the solution so that I can update the table with this newly updated records. As from record no 1501 the data entry operator started working with three fields for address..</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":12786640,"title":"Removing data from 1 table using an entry list from 2 other tables","body":"<p>Right at this moment do I have in one table orders on which I need to delete data from. In the table from where I need to remove rows from are there 2 connections. One of the connections refers to a table with the name/sub name of the customer.\nI need to delete from these customers with a specific sub name in the orders table a certain number of product. To get the list of products I need to remove do I need to check into the third table at the price of it.</p>\n\n<p>Below is the following query I have created but returned me an error on which I'm not really surprised.</p>\n\n<pre><code>    DELETE FROM `table1`\nWHERE `entry` = (SELECT `entry` FROM `table2` WHERE `subname` = 'Buyer')\n    AND `item` = (SELECT `entry` FROM `table3` WHERE `Price` != '226' OR '232');\n</code></pre>\n\n<p>Running this query got me to the following error..</p>\n\n<blockquote>\n  <p>Error Code: 1242 Subquery returns more than 1 row</p>\n  \n  <p>Execution Time : 0 sec Transfer Time  : 0 sec Total Time     : 0.044\n  sec</p>\n</blockquote>\n\n<p>Can anybody help me with the proper query setup?</p>\n"},{"tags":["query","google-app-engine","gwt","gae-datastore","objectify"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12773632,"title":"Queries with Objectify: UmbrellaException","body":"<p>I am using Objectify to manage GAE Datastore for my GWT app. The problem is that I am not using queries properly and I get UmbrellaExceptions as per below:</p>\n\n<pre><code>Caused by: java.lang.RuntimeException: Server Error: java.lang.String cannot be cast to java.lang.Number\n    at com.google.web.bindery.requestfactory.shared.Receiver.onFailure(Receiver.java:44)\n</code></pre>\n\n<p>Say that I have a class <code>Box</code> with a unique field <code>String id</code>. I want to get the Box object whose <code>id == \"cHVQP6zZiUjM\"</code></p>\n\n<p>This is how I do it now:</p>\n\n<pre><code>public Box getBox(String boxId)\n{\n    Objectify ofy = ObjectifyService.begin();\n    Query&lt;Box&gt; q=ofy.query(Box.class).filter(\"id\",boxId);\n    Box targetBox = q.get();\n\n    return targetBox;\n}\n\n\n@Entity\npublic class Box extends DatastoreObject{\n    private String id;\n    private String title;\n}\n</code></pre>\n\n<p>I tried doing this with ofy.load() but that method is not defined in my class Objectify (I don't know why).</p>\n"},{"tags":["java","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12784297,"title":"unifying query language for accessing data from heterogeneous database","body":"<p>In my current project, I am trying to unify query language for accessing heterogeneous database. Heterogeneous database means their query language for accessing data is different. For instance, SQL is a query language for accessing data from Apache Derby, while nonSQL for MongoDB. </p>\n\n<p>My question is  \"Is there any domain specific language, which have been proposed to unify heterogeneous databases ? \"</p>\n\n<p>Please feel free to direct me other efforts as well.</p>\n"},{"tags":["sql-server-2008","query","duplicates"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12784540,"title":"Create duplicate records in a lookup table, for each unique value of a column id","body":"<p>I have a lookup table with id(primary key), name, value and branchId as the columns. Currently I have a set of data with the branchId being the same for the entire records. I need to duplicate the data with same values for the name and value columns, but a different value of branchId in the same table.</p>\n\n<p>Any help with the query/script to achieve this would be appreciated.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["mysql","query","limits"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12783932,"title":"How Can I Correctly Do this Limited Group By Query in MySQL?","body":"<p>I have a query that is returning a list of 25 doctors that needs to reflect their uploaded files (cloud_uploads) in a column.  The problem is, I do not want to limit the number of files that are listed, but the limit seems to be applying to the files as well. Other similar questions on SO that I've seen have the opposite problem - they want to limit the files without limiting the total rows returned.  I have doctors with more than 25 uploaded files, but the list is only showing the first 25 files rather than all of them.</p>\n\n<p>Because this is a programmatically generated query, I can't separate it into multiple queries.  It needs to be one.  So, if the answer is that it can't be done, I can accept that.</p>\n\n<p>Here is the current query:</p>\n\n<pre><code>SELECT SQL_CALC_FOUND_ROWS records.instance_id,\n        instances.patient_id,\n        TRIM(form_1_data.field_2) AS field_0,\n        TRIM(form_1_data.field_1) AS field_1,\n        TRIM(form_1_data.field_87) AS field_2,\n        GROUP_CONCAT(DISTINCT CONCAT (\n                        extensible_8_data.field_953,\n                        '|||',\n                        cloud_uploads.NAME\n                        ) SEPARATOR '&lt;br /&gt;') AS field_3\nFROM form_6_data AS records\nLEFT JOIN instances\n        ON instances.id = records.instance_id\nLEFT JOIN extensible_8_data\n        ON records.instance_id = extensible_8_data.instance_id\nLEFT JOIN cloud_uploads\n        ON extensible_8_data.field_953 = cloud_uploads.id\nLEFT JOIN form_1_data\n        ON records.field_89 = form_1_data.instance_id\nWHERE instances.form_id = 6\n        AND instances.active = 1\n        AND (\n                cloud_uploads.active = 1\n                OR cloud_uploads.active IS NULL\n                )\nGROUP BY records.instance_id\nORDER BY records.instance_id DESC LIMIT 0, 25\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","query","syntax"],"answer_count":10,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":8257,"score":4,"question_id":497241,"title":"How do I perform a GROUP BY on an aliased column in MS-SQL Server?","body":"<p>I'm trying to perform a <em>group by</em> action on an aliased column (example below) but can't determine the proper syntax.</p>\n\n<pre><code>SELECT       LastName + ', ' + FirstName AS 'FullName'\nFROM         customers\nGROUP BY     'FullName'\n</code></pre>\n\n<p>What is the correct syntax?</p>\n\n<p><hr />\n<strong>EDIT</strong></p>\n\n<p>Extending the question further (I had not expected the answers I had received) would the solution still apply for a CASEed aliased column?</p>\n\n<pre><code>SELECT       \n    CASE\n        WHEN LastName IS NULL THEN FirstName\n        WHEN LastName IS NOT NULL THEN LastName + ', ' + FirstName\n    END AS 'FullName'\nFROM         customers\nGROUP BY     \n    LastName, FirstName\n</code></pre>\n\n<p>And the answer is yes it does still apply.</p>\n"},{"tags":["mysql","sql","query","database-performance"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12784043,"title":"Select subset of records from very large SQL table","body":"<p>There are two tables, namely <code>LongTable</code> and <code>ShortTable</code>. For example, <code>LongTable</code> looks like:</p>\n\n<pre><code>personA | personB\n1 | 2\n1 | 3\n2 | 4\n2 | 5\n3 | 4\n3 | 5\n3 | 6\n4 | 5\n4 | 6\n</code></pre>\n\n<p>and <code>ShortTable</code> has the following content:</p>\n\n<pre><code>PersonA\n1\n2\n</code></pre>\n\n<p>I wonder how to select records from a <code>LongTable</code> (please note that this table is really long, i.e. about 2.000.000 rows) based on records in the <code>ShortTable</code>. So, the result for this particular case should be:</p>\n\n<pre><code>personA | personB\n1 | 2\n1 | 3\n2 | 4\n2 | 5\n</code></pre>\n\n<p>I started with the following query (but with failure: \"Can't reopen table: 'ShortTable'\"):</p>\n\n<pre><code>SELECT * FROM LongTable\n  WHERE\n    personA IN (SELECT * FROM ShortTable)\n    AND\n    personB IN (SELECT * FROM ShortTable)\n</code></pre>\n\n<p>Code to reproduce temporary tables is given below.</p>\n\n<p>Thanks in advance for any pointer.</p>\n\n<pre><code>CREATE TABLE LongTable (\n  personA INT,\n  personB INT\n);\n\nINSERT INTO LongTable VALUES\n(1,2),(1,3),(2,4),\n(2,5),(3,4),(3,5),\n(3,6),(4,5),(4,6);\n\nCREATE TABLE ShortTable (\n  personA INT\n);\n\nINSERT INTO ShortTable VALUES\n(1),(2);\n</code></pre>\n"},{"tags":["mysql","sql","query","select","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12784094,"title":"Update Query using SELECT results","body":"<p>As my application is expanding, I now am changing the structure of my database; I now want to control file types within the database.  I wanted to start with the current file types already in the database.  My Database now has a [simplified] 2 table structure like:</p>\n\n<p><code>tbFiles: pkFileID, fileType, fileName</code></p>\n\n<p><code>tblFileType: pkFileType, typeName, typeDesc</code></p>\n\n<p>I am trying to have the output of a <code>SELECT</code> query update into the newly created <code>tblFileType</code> table.  I have tried among other things:</p>\n\n<pre><code>UPDATE tblFileType\nINNER JOIN\n(SELECT DISTINCT fileType FROM tblFiles) as X\nSET typeName = fileType\n</code></pre>\n\n<p>but I always seem to get <code>0 row(s) affected</code>.  </p>\n\n<p>When I run</p>\n\n<pre><code>SELECT DISTINCT fileType\nFROM  `tblFiles`\n</code></pre>\n\n<p>I get <code>Showing rows 0 - 22 (~23 total, Query took 0.0074 sec)</code></p>\n\n<p>I know this must be simple, but why is the UPDATE query not affecting 23 rows?</p>\n"},{"tags":["java","query","mongodb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12784196,"title":"How to create query to update fields in deep array document?","body":"<p>I am using mongodb in my application, I have test collection in which i am having the following document:</p>\n\n<pre><code> \"_id\" : ObjectId(\"5072b33aa4e8dd3e359b8e94\"), \n \"menus\" : { \n    \"5072b8dda4e8dd3e359b8ea8\" :\n     { \n        \"_id\" : ObjectId(\"5072b8dda4e8dd3e359b8ea8\"), \n        \"description\" : \"hfghfgh\",\n         \"menuItems\" : \n            [   \n                {   \n                \"name\" : \"dfgdfg\",  \n                \"description\" : \"dgdfgd\", \n                \"_id\" : ObjectId(\"5072b91ba4e8dd3e359b8eaa\")\n                 },     \n                { \n                \"name\" : \"fgdfgdf\",     \n                \"description\" : \"gdfgg\",\n                 \"_id\" : ObjectId(\"5072bb92a4e8204e51de1084\") \n                }\n            ]\n    }\n}\n</code></pre>\n\n<p>Actually, i want to update sub-documents menuItems which is embedded inside the menus object,i tried to update the following object</p>\n\n<pre><code> { \n\"name\" : \"fgdfgdf\",     \n\"description\" : \"gdfgg\",\n\"_id\" : ObjectId(\"5072bb92a4e8204e51de1084\") \n }\n</code></pre>\n\n<p>to </p>\n\n<pre><code> { \n\"name\" : \"12345\",   \n\"description\" : \"gdfgdfgdfgfgdfdfgdfgf\",\n\"_id\" : ObjectId(\"5072bb92a4e8204e51de1084\") \n }\n</code></pre>\n\n<p>but i end up with the error.</p>\n\n<p>My updating stuff as below:</p>\n\n<pre><code>  BasicDBObject query=new BasicDBObject(\"_id\",ObjectId(\"5072b33aa4e8dd3e359b8e94\"));\n\n  BasicDBObject document = new BasicDBObject(\"menus.5072b8dda4e8dd3e359b8ea8.menuItems\",    new BasicDBObject(\"_id\":ObjectId(\"5072bb92a4e8204e51de1084\") );\n\n  document.put(\"menus.5072b8dda4e8dd3e359b8ea8.menuItems.$.name\",\"12345\");\n  document.put(\"menus.5072b8dda4e8dd3e359b8ea8.menuItems.$.description\",\n  \"gdfgdfgdfgfgdfdfgdfgf\");\n\n  BasicDBObject updateOps=new BasicDBObject(\"$set\", document);\n\n  db.collection.update(query,updateOps);\n</code></pre>\n\n<p>I don't know where i made a mistake...</p>\n\n<p>Any help is great...</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12775279,"title":"MySQL running time","body":"<p>So I have a table bj10dcmegablast with 20 million rows. Now I want to do a query as </p>\n\n<pre><code>select *, max(qEnd - qStart) \nfrom \n     (select qFileID,qLocus,qTranscript,qLength,sFileId,sLocus,sTranscript,\nsLength,qStart,qEnd,sStart,sEnd\n      from bj10dcmegablast\n      where (qLocus, qTranscript)\n      in     \n        (select distinct qLocus, qTranscript\n     from\n        (select qLocus, qTranscript, count(distinct sFileID) as counts\n         from bj10dcmegablast\n        group by qLocus, qTranscript\n         having counts &gt; 6) as middle1)) as middle2\ngroup by qLocus,sLocus;\n</code></pre>\n\n<p>I have no idea how long it will take. I ran this query for one hour. Not finished yet.</p>\n\n<p>So I did some test:</p>\n\n<pre><code>select qLocus, qTranscript, count(distinct sFileID) as counts\nfrom bj10dcmegablast\ngroup by qLocus, qTranscript\nhaving counts &gt; 6\n</code></pre>\n\n<p>This takes 40 seconds.</p>\n\n<pre><code>select distinct qLocus, qTranscript\n from\n    (select qLocus, qTranscript, count(distinct sFileID) as counts\n     from bj10dcmegablast\n    group by qLocus, qTranscript\n     having counts &gt; 6) as middle1;\n</code></pre>\n\n<p>This one takes 2 mins.</p>\n\n<p>Anyone can tell how long you think the full query will last?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12782249,"title":"MySQL SQL Query","body":"<p>I am trying to create a query which will check how many entries I have in my database for the last 7 days, it works, but it only returns the dates where records exist. I would like it to return a 0 for days where there is no data as I am producing a 7 day report.</p>\n\n<p>Any help gratefully received!</p>\n\n<pre><code>SELECT DATE(created_date) AS date, \n    (SELECT COUNT(id) \n    FROM records \n    WHERE DATE(created_date) = date AND method = 'tw') AS total_records \nFROM records \nWHERE created_date &gt; DATE_SUB(NOW(), INTERVAL 7 day) \nGROUP BY date\n</code></pre>\n"},{"tags":["python","sql","database","query","firebird"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":12783075,"title":"Continue Error: AttributeError: Transaction instance has no attribute 'trans_handle'","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12781696/error-attributeerror-transaction-instance-has-no-attribute-trans-handle\">Error: AttributeError: Transaction instance has no attribute &#39;trans_handle&#39;</a>  </p>\n</blockquote>\n\n\n\n<p>@glglgl, I act according to a simplification principle\nI act according to a simplification principle, I on wrote the program</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\ns1='''\ncreate table CLIENTS\n    (\n       ID    INTEGER NOT NULL,\n       COMPANY   VARCHAR(50),\n       \"LAST NAME\"   VARCHAR(50),\n       \"FIRST NAME\"   VARCHAR(50),\n       \"E-MAIL ADDRESS\"   VARCHAR(50),\n       \"JOB TITLE\"   VARCHAR(50),\n       \"BUSINESS PHONE\"   VARCHAR(25),\n       \"HOME PHONE\"   VARCHAR(25),\n       \"MOBILE PHONE\"   VARCHAR(25),\n       \"FAX NUMBER\"   VARCHAR(25),\n       ADDRESS   BLOB SUB_TYPE 1,\n       CITY   VARCHAR(50),\n       \"STATE/PROVINCE\"   VARCHAR(50),\n       \"ZIP/POSTAL CODE\"   VARCHAR(15),\n       \"COUNTRY/REGION\"   VARCHAR(50),\n       \"WEB-SITE\"   VARCHAR(25),\n       NOTES   BLOB SUB_TYPE 1,\n       INCLUDING   BLOB,\n       CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n    );\n'''\ns2='''create ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);'''\n#os.remove('D:/ThirdTask/test1.fdb')\nconn=firebirdsql.create_database(dsn='localhost/3050:/test.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\ncur.execute(s1)\ncur.execute(s2)\nconn.commit()\nconn.close()\n</code></pre>\n\n<p>s1 and s2 are strings which were transferred for performance (look <a href=\"http://stackoverflow.com/questions/12781696/error-attributeerror-transaction-instance-has-no-attribute-trans-handle\">Error: AttributeError: Transaction instance has no attribute &#39;trans_handle&#39;</a>). As a result the test1.fdb database wasn't created in the current folder </p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12782676,"title":"How to order by column if equal, order by another","body":"<p>Really I don't know how to say it as question, but with example it will be clear to everyone, I have data retrieved from MYSQL database sorted by one of columns , my question if one of those values in this column is equal, I need to use another column to set who is show first.</p>\n\n<pre><code>col1 - col2\n10 - 100\n20 - 120\n20 - 140\n30 - 90\n</code></pre>\n\n<p>see here value 20 mentioned twice so I need to show the 20 with 140 before the 20 with 120 using MYSQL Query.</p>\n"},{"tags":["python","sql","database","query","firebird"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12781696,"title":"Error: AttributeError: Transaction instance has no attribute 'trans_handle'","body":"<p>I wrote the program which creates the Firebird database on a descriptor of metadata</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\ncon = sqlite3.connect('borey.db')\nsampling_tables=con.cursor()\nsampling_fields=con.cursor()\nsampling_constraints=con.cursor()\nsampling_constraints_fields=con.cursor()\nsampling_indices=con.cursor()\nsampling_indices_fields=con.cursor()\nsampling_indices_props=con.cursor()\nsampling_fields_from_constraints=con.cursor()\njs=[]\n\nsampling_tables.execute(sql.sqltables)\n\nfor table in sampling_tables:\n    tabledict=dict(inform_about_table='?', fields='?', constraints='?', indices='?')\n    information_about_table_dict=dict(name=table[1], description=table[2], can_add=table[3], can_edit=table[4], can_delete=table[5])\n    #print(js_information_about_table)\n    tabledict['inform_about_table']=information_about_table_dict\n    #print(tabledict)\n    table_id=table[0]\n    sampling_fields.execute(sql.sqlfields,(table_id,))\n    listfields=[]\n    for field in sampling_fields:\n        fielddict=dict(position=field[0], name=field[1], description=field[2], datatype=field[3], char_length=field[4], can_input=field[5], can_edit=field[6], show_in_grid=field[7],\n                      is_mean=field[8], autocalculated=field[9], required=field[10])\n        listfields.append(fielddict)\n    tabledict['fields']=listfields\n    #print(tabledict)\n    sampling_constraints.execute(sql.sqlconstraints,(table_id,))\n    listconstraints=[]\n    for constraint in sampling_constraints:\n        constraintdict=dict(name=constraint[1], constrtype=constraint[2], items='?', reference=constraint[3])\n        sampling_constraints_fields.execute(sql.sql_constr_det,(constraint[0],table_id))\n        listitems=[]\n        for constr_det in sampling_constraints_fields:\n            listitems.append(constr_det[0])\n        constraintdict['items']=listitems\n        listconstraints.append(constraintdict)\n    tabledict['constraints']=listconstraints\n    #print(tabledict)\n    sampling_indices.execute(sql.sqlindices,(table_id,))\n    listindices=[]\n    for index in sampling_indices:\n        indexdict=dict(name=index[1], items='?', position='?', props='?')\n        index_id=index[0]\n        sampling_indices_fields.execute(sql.sql_indices_fields,(table_id,index_id))\n        #sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id, ))\n        listfields=[]\n        listpositions=[]\n        listprops=[]\n        for index_det in sampling_indices_fields:\n            listfields.append(index_det[0])\n            listpositions.append(index_det[1])\n            fieldinindex=index_det[0]\n        sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id,fieldinindex))            \n        for index_desc in sampling_indices_props:\n            listprops.append(index_desc[0])\n        indexdict['items']=listfields\n        indexdict['position']=listpositions\n        indexdict['props']=listprops\n        listindices.append(indexdict)\n    tabledict['indices']=listindices\n    print(tabledict)\n    js.append(tabledict)\nos.remove('D:/ThirdTask/test.fdb')\nconn=firebirdsql.create_database(dsn='localhost/3050:/test.fdb', user='sysdba', password='masterkey')\n#conn=firebirdsql.connect(host='localhost',database='D:/ThirdTask/test.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nfor nametable in js:\n    s=''\n    s+='create table '+nametable['inform_about_table']['name']+'\\n'\n    s+='('+'\\n'\n    countfield=0\n    for namefield in nametable['fields']:\n        s+='   '\n        if namefield['name']=='COUNT':\n            s+='QUANTITY'\n        else:\n            if namefield['name']=='MINIMUM QUANTITY FOR ORDER REPETITION':\n                s+='MINIMUM_QUANTITY'\n            else:\n                if namefield['name']=='PRICE ACCORDING TO THE PRICE-LIST':\n                    s+='LIST_PRICE'\n                else:\n                    if (namefield['name'].count(' ')!=0) or (namefield['name'].count('-')!=0) or (namefield['name'].count('/')!=0):\n                        s+='\"'+namefield['name']+'\"'\n                    else:                    \n                        s+=namefield['name']\n        if namefield['datatype']=='FMTBCD':\n            s+='   '+' INTEGER NOT NULL'\n        else:\n            if namefield['datatype']=='STRING': \n                s+='   '+'VARCHAR'\n            else:\n                if namefield['datatype']=='MEMO':\n                    s+='   '+'BLOB SUB_TYPE 1'\n                else:            \n                    if namefield['datatype']=='LARGEINT':\n                        s+='   '+'INTEGER'\n                    else:\n                        if namefield['datatype']=='SMALLINT':\n                            s+='   '+'INTEGER'\n                        else:\n                            if namefield['datatype']=='CURRENCY':\n                                s+='   '+'NUMERIC(18,2)'\n                            else:\n                                if namefield['datatype']=='BOOLEAN':\n                                    s+='   '+'INTEGER'\n                                else:    \n                                    s+='   '+namefield['datatype']           \n        if namefield['datatype']=='STRING':\n            s+='('+str(namefield['char_length'])+')'\n        countfield+=1\n        #if countfield!=len(nametable['fields']):\n        s+=','+'\\n'\n        #else:\n            #s+='\\n'\n            #s+='\\n'\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='PRIMARY':\n            s+='   CONSTRAINT '+nameconstraint['name']+ ' PRIMARY KEY('\n            countfieldinconstr=0\n            for namefield in nameconstraint['items']:\n                countfieldinconstr+=1\n                if countfieldinconstr!=len(nameconstraint['items']):\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+','\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+','\n                            else:    \n                                s+=namefield+','\n                else:\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+')'+'\\n'\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+')'+'\\n'\n                            else:       \n                                s+=namefield+')'+'\\n'\n    s+=');'+'\\n'\n    print s\n    cur.execute(s)\n    conn.commit()\n    for nameindex in nametable['indices']:\n        #print 'nameidex[props] ', nameindex['props']\n        s=''\n        for prop in nameindex['props']:\n            if prop==0:\n                if (nameindex['name'].count(' ')!=0) or (nameindex['name'].count('-')!=0) or (nameindex['name'].count('/')!=0):\n                    s+='create ascending index \"'+nameindex['name'] + '\" on '+nametable['inform_about_table']['name']+' ('\n                else:\n                    if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_INVENTORY_ID':\n                        s+='create ascending index ' + 'IDX_INVENTORY_ID' + ' on '+nametable['inform_about_table']['name']+' ('\n                    else:\n                        if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_ORDERDETAILS':\n                            s+='create ascending index ' + 'IDX_ORDERDETAILS' + ' on '+nametable['inform_about_table']['name']+' ('\n                        else:    \n                            if nameindex['name'].count('INFORMATION_ABOUT_ORDER_')!=0:\n                                s+='create ascending index ' + nameindex['name'][1:4]+nameindex['name'][-len(nameindex['name'])+28:] + ' on '+nametable['inform_about_table']['name']+' ('\n                            else:\n                                s+='create ascending index '+nameindex['name'] + ' on '+nametable['inform_about_table']['name']+' ('\n            countitem=0\n            for nameitem in nameindex['items']:\n                if countitem!=len(nameindex['items'])-1:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+', '\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+', '\n                            else:  \n                                s+=nameitem+', '\n                else:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+');'+'\\n'\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+');'+'\\n'\n                            else:  \n                                s+=nameitem+');'+'\\n'\n                countitem+=1\n        print s\n        cur.execute(s)\n        conn.commit()\nfor nametable in js:\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='FOREIGN':\n            s=''\n            s+='ALTER TABLE '+nametable['inform_about_table']['name']+'\\n'\n            s+='  '+'ADD CONSTRAINT '+nameconstraint['name']+' FOREIGN KEY ('  \n            for namefield in nameconstraint['items']:\n                if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                    s+='\"'+namefield+'\")'+'\\n'\n                else:\n                    s+=namefield+')'+'\\n'\n            s+='      '+'REFERENCES '+nameconstraint['reference']\n            sampling_fields_from_constraints.execute(sql.sql_fields, (nameconstraint['reference'],))\n            for fields in sampling_fields_from_constraints:\n                field=fields[0]\n                if (field.count(' ')!=0) or (field.count('-')!=0) or (field.count('/')!=0):\n                    s+=' (\"'+field+'\");'+'\\n'\n                else:\n                    s+=' ('+field+');'+'\\n'\n            print s\n            cur.execute(s)\n            conn.commit()            \ns=\"\"\"\ncreate table CLIENTS\n(\n   ID   INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"    VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB\n);\n\"\"\"\ns1='create ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);'\n\"\"\"db = 'D:/ThirdTask/Northwind.accdb' \nconnaccess = win32com.client.Dispatch(r'ADODB.Connection')\nDSN = ('PROVIDER = Microsoft.Jet.OLEDB.4.0;DATA SOURCE = ' + db +  ';') \nconnaccess.Open(DSN) \nrs = win32com.client.Dispatch(r'ADODB.Recordset') \nstrsql = \"select * from deer\" \nrs.Open(strsql, conn, 1, 3) \nt = rs.GetRows() \nconnaccess.Close() \n\"\"\"\n\n#print s\n#cur.execute(s)\n#conn.commit()\n#cur.execute(s1)\n#conn.commit()\n#cur=con.cursor()\ncon.close()\nconn.close()\n#print \"Connect succesfully\"\n</code></pre>\n\n<p>As a result I received a mistake\nThe corresponding conclusion to the screen in the program is carried out by means of print s</p>\n\n<pre><code>create table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\ncreate ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);\n\n\nTraceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 188, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 456, in _execute\n    self.transaction.trans_handle, query)\nAttributeError: Transaction instance has no attribute 'trans_handle'\n</code></pre>\n"},{"tags":["iphone","xcode","ipad","query","sqlite"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12280321,"title":"how to insert values in sqlite","body":"<pre><code>NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory , NSUserDomainMask, YES);\nNSString *documentsDir = [paths objectAtIndex:0];\n\nNSFileManager *fileManager = [NSFileManager defaultManager];\nNSError *error;\nNSString *dbPath =[documentsDir stringByAppendingPathComponent:@\"register.sqlite\"];\nBOOL success = [fileManager fileExistsAtPath:dbPath]; \nsqlite3_stmt *selectstmt;\nif(!success)\n        {\n             NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@\"register.sqlite\"];\n            success = [fileManager copyItemAtPath:defaultDBPath toPath:dbPath error:&amp;error];\n\n            if (!success) \n                NSAssert1(0, @\"Failed to create writable database file with message '%@'.\", [error localizedDescription]);\n        }\n\nif (sqlite3_open([dbPath UTF8String], &amp;database) == SQLITE_OK) {\n\n    sql = \"select lastname,email,firstname from reg_FORM\";\n\n    if(sqlite3_prepare_v2(database, sql, -1, &amp;selectstmt, NULL) == SQLITE_OK) {\n\n         while(sqlite3_step(selectstmt) == SQLITE_ROW) {\n\n             lastname = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 0)];\n                    email=[NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 1)];\n                    firstname=[NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 2)];\n                    NSLog(@\"----%@\",lastname);\n                    NSLog(@\"----%@\",email);\n                    NSLog(@\"----%@\",firstname);\n\n                }\n        sqlite3_finalize(selectstmt);\n            }     \n        sqlite3_close(database);\n        }\n</code></pre>\n\n<p>I am using this code to retrieve the values in db, but I did know how to insert data in db. I am trying this below code but it does not work</p>\n\n<pre><code>const char *sql = \"insert into reg_FORM (firstname,lastname,email,company,phone) VALUES (aaa,aaa,aaa,aaaa,1223)\";\n            sqlite3_exec(database, [[NSString stringWithFormat:@\"insert into reg_FORM (firstname,lastname,email,company,phone) VALUES (aaa,aaa,aaa,aaaa,1223)\"] UTF8String], NULL, NULL, NULL);    \n</code></pre>\n\n<p>//give code for insert values in db</p>\n"},{"tags":["sql","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":12780624,"title":"How to create this sql statment to seach in each record at the many table side?","body":"<p>now i have to create a query for search page depends on database that have 30 tables:</p>\n\n<p>i will describe my requirement with example:</p>\n\n<p>there is a relation between table A and table B -> one to many  relation</p>\n\n<p>if we consider that table A is for Students info and table B to save the courses for that student each year . it is only allowed to take 3 subjects each year so the structure will be as the following:</p>\n\n<p><strong>Table A:</strong> <em>ID ,Student-Name ,Tel#,Birthdate ......</em></p>\n\n<p><strong>Table B:</strong> :<em>ID,StudentID,Date,Subject-one,Subject-two,Subject-three</em></p>\n\n<p>so the student can take any 3 subjects per year\ni want to make a query for subject called X to get all students who take it at any year but only once </p>\n\n<p>example for valid student:</p>\n\n<pre><code>  StudentID  Sub1  Sub2  Sub3  Year  \n  60         Z     (X)    Y      1\n  60         L      W     V      2\n  60         M      P     Y      3\n</code></pre>\n\n<p>example for invalid student:</p>\n\n<pre><code>  StudentID  Sub1  Sub2  Sub3  Year  \n  10         Z     (X)    O      1\n  10         L      W     V      2\n  10         O      P    (x)     3\n</code></pre>\n\n<p>i hope that to be clear enough for my problem </p>\n"},{"tags":["mysql","query","optimization","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12769229,"title":"How to optimize my MySQL query?","body":"<p>I have two tables\nInvoice(\n  <code>Id</code>,\n  <code>Status</code>,\n  <code>VendorId</code>,\n  <code>CustomerId</code>,\n  <code>OrderDate</code>,\n  <code>InvoiceFor</code>,\n)</p>\n\n<p>InvoiceItem(\n  <code>Id</code>,\n  <code>Status</code>,\n  <code>InvoiceId</code>,\n  <code>ProductId</code>,\n  <code>PackageQty</code>,\n  <code>PackagePrice</code>,\n)</p>\n\n<p>here invoice.id=invoiceItem.invoiceId (Foregin key)\nand Id fields are primary key (big int)\nthese tables contains 100000(invoice) and 450000(invoiceItem) rows</p>\n\n<hr>\n\n<p>Now I have to write a query which will return the ledger of invoices where invoice for = 55 or 66 and in a certain date range.\nI also have to return a last taken date which will contain the previous taken date of product by that particular customer.</p>\n\n<hr>\n\n<p>The output should be\nOrderDate, InvoiceId, CustomerId, ProductId, LastTaken, PackageQty, PackagePrice</p>\n\n<hr>\n\n<p>So I write the following query</p>\n\n<pre><code>SELECT a.*, (\n    SELECT MAX(ivv.orderdate)\n    FROM invoice AS ivv , invoiceItem AS iiv \n    WHERE ivv.id=iiv.invoiceid\n    AND iiv.ProductId=a.ProductId AND ivv.CustomerId=a.CustomerId AND ivv.orderDate&lt;a.orderdate\n) AS lastTaken FROM (\n    SELECT iv.Id, iv.OrderDate, iv.CustomerId, iv.InvoiceFor, ii.ProductId,     \n    ii.PackageQty, ii.PackagePrice\n    FROM invoice AS iv, invoiceitem AS ii\n    WHERE iv.id=ii.InvoiceId \n    AND iv.InvoiceFor IN (55,66)\n    AND iv.Status=0 AND ii.Status=0 \n    AND OrderDate BETWEEN '2011-01-01' AND '2011-12-31'\n    ORDER BY iv.orderdate, iv.Id ASC \n) AS a\n</code></pre>\n\n<p><strong>But I always got the Time out. How Will I solve the problem???</strong></p>\n\n<p>the Explain for this query is as follows:\n<img src=\"http://i.stack.imgur.com/RzeEG.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["query","postgresql","metadata"],"answer_count":8,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1719,"score":4,"question_id":343138,"title":"Retrieving Comments from a PostgreSQL DB","body":"<p>Im running a project on a PostGres database and need to retrieve the comments on columns within the DB to be used as table headings and such. I have seen that there are a couple of built in functions (<a href=\"http://www.postgresql.org/docs/9.1/static/catalog-pg-description.html\" rel=\"nofollow\">pg_description</a> and <a href=\"http://www.postgresql.org/docs/9.1/static/functions-info.html\" rel=\"nofollow\">col_description</a>) but i haven't been able to find examples on how to use them and playing around with them has proved pretty futile.</p>\n\n<p>So I was wondering if any has been able to do this before and if so, How???</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1104,"score":3,"question_id":5664094,"title":"Getting list of table comments in PostgreSQL","body":"<p>Postgresql allows adding comments to objects such as tables. For example I've added a comment to table \"mytable\" by using this SQL command:</p>\n\n<pre><code>COMMENT ON TABLE mytable IS 'This is my table.';\n</code></pre>\n\n<p>My question is:\nIf I want to use a SQL-command to get all tables along with their respective comment - how would I do this? What would be the appropriate query for this?</p>\n\n<p>Thanks in advance!\nCheers!</p>\n"},{"tags":["mysql","query","search"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12774097,"title":"Mysql search query for whole database dont return some rows","body":"<p>here is my db: <a href=\"https://rapidshare.com/#!download|836p6|3764508570|sourcede_advoli.sql|3|0|0\" rel=\"nofollow\">https://rapidshare.com/#!download|836p6|3764508570|sourcede_advoli.sql|3|0|0</a></p>\n\n<p>Sorry for this external link with db dump but I dont how to show u my db in other way because it has a lot of code.</p>\n\n<p>I am try to search all db with this query: </p>\n\n<pre><code>select \n    main_section.naziv_fr as main_section_naziv, \n    sub_section_1.naziv_fr as sub_1_naziv, \n    sub_section_2.naziv_fr as sub_2_naziv, \n    sub_section_2.des_fr as sub_2_des,\n    sub_section_2.rich_des_fr as sub_2_rich, \n    sub_section_2.rich as ima_texta, \n    sub_section_2.linked, sub_section_2.url, \n    sub_section_2.link_fr as anchor, \n    sub_section_3.text_fr as sub_3_text \n        from \n            main_section join sub_section_1 on main_section.id= sub_section_1.id_main \n            join sub_section_2 on sub_section_2.id_sub_1 = sub_section_1.id \n            join sub_section_3 on sub_section_3.id_sub_2 = sub_section_2.id \n                where \n                    main_section.naziv_fr like '%%' or \n                    sub_section_1.naziv_fr like '%%' or \n                    sub_section_2.naziv_fr like '%%' or \n                    sub_section_2.des_fr like '%%' or \n                    sub_section_2.rich_des_fr like '%%' or \n                    sub_section_2.link_fr like '%%' or \n                    sub_section_3.text_fr like '%%'\n</code></pre>\n\n<p>and it is working fine but just for rows where strlen(naziv_fr) in sub_section_2 is gt then 0. I dont know how to select and other rows where strlen(naziv_fr) is not blank. </p>\n\n<p>Example: </p>\n\n<p>when I search for 'main_naziv' in main_section table id for this is 3, but in table sub_section_1 I have a child for this id with 13(sub_title_1) i 14(sub_title_2) also I have ids in sub_section_2 where ids 13 i 14 are parent from table sub_section_1 but here is problem, mysql return to me all rows where naziv_fr is not blank but no other rows.</p>\n\n<p>Why? Every help is welcome. </p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":161,"score":5,"question_id":12773116,"title":"Stuck with a MySQL query","body":"<p>I have a table schema as </p>\n\n<pre><code>create table Location(\nid int primary key,\ncity varchar(255),\nstate varchar(100),\ncountry varchar(255)\n);\ncreate table Person( \nid int primary key,\nname varchar(100)\n);\ncreate table Photographer(\nid int primary key references Person(id) on update cascade on delete cascade,\nlivesIn int not null references Location(id) on update cascade on delete no action\n);\ncreate table Specialty(\nphotographer int references Photographer(id) on update cascade on delete cascade,\ntype enum('portrait','landscape','sport'),\nprimary key(photographer, type)\n);\ncreate table Photo(\nid int primary key,\ntakenAt timestamp not null,\ntakenBy int references Photographer(id) on update cascade on delete no action,\nphotographedAt int references Location(id) on update cascade on delete no action\n);\ncreate table Appearance(\n  shows int references Person(id) on update cascade on delete cascade,\nisShownIn int references Photo(id) on update cascade on delete cascade,\nprimary key(shows, isShownIn)\n);\n</code></pre>\n\n<p>I am stuck at two queries : </p>\n\n<p>1) The photos such that the photo only shows photographers that live in the same location. List each photo once. That is, photos must have persons that are photographers, and they all need to live in the same place.</p>\n\n<p>2) The locations that have the property that every photo in the location was taken by a photographer who is not shown in any photo in Massachusetts? For each location show only the city, and show each location only once.</p>\n\n<p>My tries : \n1)</p>\n\n<pre><code>SELECT ph.id, ph.takenAt, ph.takenBy, ph.photographedAt FROM \n(SELECT * FROM Photo p, Appearance ap WHERE p.id = ap.isShownIn \nHAVING ap.shows IN (SELECT person.id FROM Person,Photographer WHERE person.id\nphotographer.id)) ph\nWHERE ph.photographedAt = (SELECT location.id FROM location WHERE location.id = \n(SELECT livesIn FROM Photographer WHERE id = ph.takenBy))\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>select distinct city from location where location.id in (\nselect photographedAt from photo, (select * from appearance where appearance.shows in\n(select photographer.id from photographer)) ph\nwhere photo.id = ph.isShownIn )\nand location.state &lt;&gt; 'Massachusetts'\n</code></pre>\n\n<p>Can anyone help in creating these queries ??</p>\n"},{"tags":["mysql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12777934,"title":"Counting with MySQL","body":"<p>Is there a way to count an Int in a MySQL Update Query?</p>\n\n<p>Currently i have</p>\n\n<pre><code>UPDATE mails SET uid = 4275\n</code></pre>\n\n<p>and i want something like</p>\n\n<pre><code>UPDATE mails SET uid = (4275++)\n</code></pre>\n"},{"tags":["query","sqlite","syntax","syntax-error","create-table"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":57,"score":-3,"question_id":12344887,"title":"syntax error in sql query?","body":"<p>I want to create some tables in database so for that i wright some queries to create table.\nbut i got an error \"there was a syntax error in your sql statement\". I check all my queries but i am not able to find what syntax i wright wrong. here i attached my sql queries please told me what is wrong with queries.\nThanks in advance.</p>\n\n<pre><code>CREATE TABLE \"WATER&amp;SEWAGE\" (\n \"CUSTOMER_ID\" VARCHAR,\n \"POTABLE_WATER\" VARCHAR,\n \"HOT_WATER\" VARCHAR,\n \"SAFETY\" VARCHAR,\n \"T/P_VALVE+EXT\" VARCHAR,\n \"HEATER_TYPE\" VARCHAR,\n \"GAS_VENT_CONDITION\" VARCHAR,\n \"FIRE_BOX_CONDITION\" VARCHAR,\n \"PRESSURE\" VARCHAR,\n \"BACK_FLOW\" VARCHAR,\n  \"PLUMBING_CONDITION\" VARCHAR,\n  \"CABINET_CONDITION\" VARCHAR,\n  \"3_COMP_SINK\" VARCHAR,\n  \"WATER_HEATER\" VARCHAR,\n  \"CLEAN_OUT_CONDITION\" VARCHAR,\n  \"FLOOR_DRAIN\" VARCHAR,\n  \"FLOOR_SINK\" VARCHAR,\n  \"MAINTANANCE\" VARCHAR,\n  \"COMMENTS\" VARCHAR,\n  \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"TIME_AND_TETMPERATURE_REL\" (\"CUSTOMER_ID\" INTEGER, \"THERMOMTE_AVAILABLE\" VARCHAR, \"THERMO_TYPE\" VARCHAR, \"COLD_TEMP\" VARCHAR, \"FOOD_TYPE1\" VARCHAR, \"PROPER_COOLING\" VARCHAR, \"FOOD_TYPE2\" VARCHAR, \"COMPLIANCE\" VARCHAR, \"FOOD_TYPE3\" VARCHAR, \"TPHC\" VARCHAR, \"HACCP\" VARCHAR, \"HOT_HOLDING_TEMP\" VARCHAR, \"FOOD_TYPE4\" VARCHAR, \"HOT_TEMP\" VARCHAR, \"FOOD_TYPE5\" VARCHAR, \"IMPROPER_REHEATING\" VARCHAR, \"FOOD_TYPE6\" VARCHAR, \"FOOD_OUT_OF_TEMP\" VARCHAR, \"WRITTEN_PLAN_FILES\" VARCHAR, \"EMPLOYEE_KNOWLEDGE\" VARCHAR, \"TIME_KEEPING_METHODS\" VARCHAR, \"HACCP_METHODS\" VARCHAR, \"CALIBRATION\" VARCHAR, \"COOKING_TEMP\" VARCHAR, \"EQUIP_CONDITION\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"PROTECTION_FROM_CONTAMINATION\" (\"FOOD_ADULTERATION\" VARCHAR, \"FOOD_SPOILAGE\" VARCHAR, \"CONTAMINATION\" VARCHAR, \"FOOD_STORAGE\" VARCHAR, \"REFRIGRATORS\" VARCHAR, \"FREEZER\" VARCHAR, \"FIFO\" VARCHAR, \"DRY\" VARCHAR, \"DISHWASHING_CHEMICALS\" VARCHAR, \"CLEANING\" VARCHAR, \"SANITIZER\" VARCHAR, \"SUPPLY_EQUIPMENT\" VARCHAR, \"PESTICIDES\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR, \"CUSTOMER_ID\" INTEGER)\n\n\nCREATE TABLE \"PHYSICAL_FACILITIES_2\" (\"CUSTOMER_ID\" VARCHAR, \"CEILING\" VARCHAR, \"WINDOWS\" VARCHAR, \"SPOILS_STORAGE\" VARCHAR, \"DOORS\" VARCHAR, \"PERSONAL_LOCKERS\" VARCHAR, \"FLOORS\" VARCHAR, \"CONDITION\" VARCHAR, \"HANDICAP\" VARCHAR, \"SELF_CLOSING_ROOM\" VARCHAR, \"TOILETS\" VARCHAR, \"TOILET_PAPER\" VARCHAR, \"TOILET_CONDITION\" VARCHAR, \"VENTILATION_CONDITION\" VARCHAR, \"MENS\" VARCHAR, \"MEN'S_VENTILATION\" VARCHAR, \"MEN'S_FLOOR_DRAWN\" VARCHAR, \"MEN'S_TOILET_STALLS\" VARCHAR, \"MEN'S_HAND_SINK\" VARCHAR, \"MEN'S_TOWELS\" VARCHAR, \"WOMEN'S\" VARCHAR, \"WOMEN'S_VENTILATION\" VARCHAR, \"WOMEN'S_FLOOR_DRAWN\" VARCHAR, \"WOMEN'S_TOILET_STALLS\" VARCHAR, \"WOMEN'S_HAND_SINK\" VARCHAR, \"WOMEN'S_TOWELS\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"PHYSICAL_FACILITIES_1\" (\"CUSTOMER_ID\" VARCHAR, \"LIGHTNING\" VARCHAR, \"KITCHEN\" VARCHAR, \"STORAGE\" VARCHAR, \"REFRIGRATION\" VARCHAR, \"JANITORIAL\" VARCHAR, \"INTERIOR\" VARCHAR, \"FIXTURE\" VARCHAR, \"FOOTCANDLES_1\" VARCHAR, \"FOOTCANDLES_2\" VARCHAR, \"FOOTCANDLES_3\" VARCHAR, \"FOOTCANDLES_4\" VARCHAR, \"FOOTCANDLES_5\" VARCHAR, \"EXTERIOR\" VARCHAR, \"WINDOWS\" VARCHAR, \"GLASS\" VARCHAR, \"SCREEN\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"PEST_CONTROL\" (\"CUSTOMER_ID\" VARCHAR, \"WALL/CEILING_PIPES\" VARCHAR, \"SANITATION\" VARCHAR, \"DOORS\" VARCHAR, \"SELF_CLOSING\" VARCHAR, \"RODENT_PROOF\" VARCHAR, \"VERMIN_PROOFING\" VARCHAR, \"FOUNDATION\" VARCHAR, \"ATTIC_VENTS\" VARCHAR, \"WINDOWS\" VARCHAR, \"TYPE_SCREENS\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"GENERAL_FOOD_SAFETY_REQ\" (\"CUSTOMER_ID\" VARCHAR, \"APPROVED_METHODS\" VARCHAR, \"DEFROST\" VARCHAR, \"FROZEN_FOOD\" VARCHAR, \"FOOD_WASHING\" VARCHAR, \"PRODUCE_1\" VARCHAR, \"FRUITS\" VARCHAR, \"GRAINS\" VARCHAR, \"VEGETABLES\" VARCHAR, \"SEPERATE_FROM_CONT\" VARCHAR, \"RAW\" VARCHAR, \"PRODUCE_2\" VARCHAR, \"STORED_BULK\" VARCHAR, \"STORAGE\" VARCHAR, \"FIFO\" VARCHAR, \"REFRIGRATAION\" VARCHAR, \"STORAGE_TEMP\" VARCHAR, \"HUMIDITY\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"FOOD_SAFETY_CERTIFICATION\" (\"CUSTOMER_ID\" INTEGER,\"OWNER\" VARCHAR,\"MANAGER\" VARCHAR,\"EMPLOYEE\" VARCHAR,\"NAME1\" VARCHAR,\"NAT'L_REGISTRY1\" VARCHAR,\"PROMETRIC1\" VARCHAR,\"SERVESAFE1\" VARCHAR,\"EXPIRATION1\" VARCHAR,\"NAME2\" VARCHAR,\"NAT'L_REGISTRY2\" VARCHAR,\"PROMETRIC2\" VARCHAR,\"SERVESAFE2\" VARCHAR,\"EXPIRATION2\" VARCHAR,\"COMMENTS\" VARCHAR,\"FOOD_TEMP\" VARCHAR,\"DISHWASHER\" VARCHAR,\"DANGER_ZONE\" VARCHAR,\"COOLING_FOODS\" VARCHAR,\"THAWING\" VARCHAR,\"REHEATING\" VARCHAR,\"THERMOMETERS\" VARCHAR,\"FIFO\" VARCHAR,\"HANDWASH\" VARCHAR,\"COOKING_TEMP\" VARCHAR,\"FOOD_POISONING_TYPES\" VARCHAR,\"EVEDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"FOOD_FROM_APPROVED_SOURCES\" (\"CUSTOMER_ID\" VARCHAR, \"RECEIPTS\" VARCHAR, \"DELIVERY_DOOR\" VARCHAR, \"AIR_CURTAIN\" VARCHAR, \"VELOCITY\" VARCHAR, \"OFF_LOAD\" VARCHAR, \"INSPECTS\" VARCHAR, \"RODENTS\" VARCHAR, \"WARNING\" VARCHAR, \"SHELL_FISH\" VARCHAR, \"GULF_OYSTER\" VARCHAR, \"FOOD_OUT_OF_TEMP\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTO\" VARCHAR)\n\nCREATE TABLE \"FOOD_FACILITY_SITE_FACTS\" (\"CUSTOMER_ID\" INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL  UNIQUE,\"DBA\" VARCHAR,\"DISTRICT\" VARCHAR,\"CITY\" VARCHAR,\"ZIPCODE\" VARCHAR,\"ADDRESS\" VARCHAR,\"SEAT_NO\" VARCHAR,\"PHONE_NO\" VARCHAR,\"OWNER\" VARCHAR,\"PERSON_IN_CHARGE\" VARCHAR,\"WEBSITE\" VARCHAR,\"EMAIL\" VARCHAR,\"FACILITY_TYPE\" VARCHAR,\"SQ_FOOTAGE\" VARCHAR,\"NO_OF_SEATS\" VARCHAR,\"ALCOHOL_SALES\" VARCHAR,\"LTD_PREP\" VARCHAR,\"BUSINESS_LICENCE_NO\" VARCHAR,\"EXPIRATION\" VARCHAR,\"COMMENTS\" VARCHAR,\"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"FOOD_DISPLAY_SELF_SERVICE\" (\"CUSTOMER_ID\" VARCHAR, \"SELF_SERVICE\" VARCHAR, \"LIDS\" VARCHAR, \"UTENSILS\" VARCHAR, \"HOW_OFTEN_CHANGED\" VARCHAR, \"SCOOP\" VARCHAR, \"SNEEZ_GUARD\" VARCHAR, \"DISHES\" VARCHAR, \"CROSS\" VARCHAR, \"SENITATION\" VARCHAR, \"MAINTANANCE\" VARCHAR, \"MECHANICAL_CONDITION\" VARCHAR, \"SERVICE_OF_UTENSIL\" VARCHAR, \"TIME\" VARCHAR, \"PRPER_FOOD_LABELING\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"EQUIPMENT/UTENSILS/LINES\" (\"CUSTOMER_ID\" VARCHAR, \"STORED_DISHES\" VARCHAR, \"CUPS\" VARCHAR, \"DAMAGED_DISHES\" VARCHAR, \"UTENSILS\" VARCHAR, \"LINES\" VARCHAR, \"COOLING_EQUIPMENT\" VARCHAR, \"COOK_WARE_STORAGE\" VARCHAR, \"CONDITION\" VARCHAR, \"STORAGE_LOCATION\" VARCHAR, \"NAPKINS\" VARCHAR, \"SANITATION\" VARCHAR, \"ADEQUATE_CAPACITY\" VARCHAR, \"HAZARDS\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"EMPLOYEE_HEALTH_AND_HYGENE\" (\"CSTOMER_ID\" INTEGER, \"COMUNICABLE_DIESEASE\" VARCHAR, \"WIPING_BAGS\" VARCHAR, \"DISCHARGE\" VARCHAR, \"LOCKERS\" VARCHAR, \"PROPER_HAND_WASH\" VARCHAR, \"RESTROOM_CONDITION\" VARCHAR, \"HANDWASH_STATION\" VARCHAR, \"HAIR_RESTRAINT\" VARCHAR, \"GLOVES_USED\" VARCHAR, \"WOUND_CARE\" VARCHAR, \"FOOD_SAMPLE_TESTING\" VARCHAR, \"GARMENT_CONDITION\" VARCHAR, \"HEALTH\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"DISH&amp;WARE_WASHING\" (\"CUSTOMER_ID\" INTEGER, \"TYPE_OF_COMPARTMENT_SINK\" VARCHAR, \"PLUMBING_ISSUE1\" VARCHAR, \"QUATERNARY_AMMONIA\" VARCHAR, \"IODINE\" VARCHAR, \"HOT_WTR_SANIT_TEMP\" VARCHAR, \"PLUMBING_ISSUE2\" VARCHAR, \"HOT_WATER\" VARCHAR, \"TEMP\" VARCHAR, \"DISHWASHER_TYPE\" VARCHAR, \"WAQLL_CONDITION\" VARCHAR, \"SANITIZER_LEVELS\" VARCHAR, \"CHLORINE\" VARCHAR, \"SINK_OR_DISHWASHER\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"CORRECTIVE_ACTIONS\" (\"CUSTOMER_ID\" VARCHAR, \"CORRECTIVE_ACTIONS\" VARCHAR)\n\nCREATE TABLE \"CONSUMER_ADVISORY\" (\"CUSTOMER_ID\" VARCHAR, \"TRUTH_IN_MENU\" VARCHAR, \"MAJOR_CHAIN\" VARCHAR, \"TRANS_FAT\" VARCHAR, \"SCHOOL\" VARCHAR, \"PROHIBITED\" VARCHAR, \"CALORIES\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVEDINCE_PHOTOS\" VARCHAR)\n\nCREATE TABLE \"COMPLAINS&amp;ENFORCEMENTS\" (\"CUSTOMER_ID\" VARCHAR, \"PLAN_SUBMITTED\" VARCHAR, \"APPROVEL\" VARCHAR, \"CERTIFICATE_OF_OCCU\" VARCHAR, \"PRIOR_INSPEK_REPORT\" VARCHAR, \"LAST_INSPECTION_DATE\" VARCHAR, \"PERMIT_STATUS\" VARCHAR, \"POSTED\" VARCHAR, \"EXPIRATION\" VARCHAR, \"PERMIT_DISPLAYED\" VARCHAR, \"INSPECTION_REPORT_POSTING\" VARCHAR, \"COMMENTS\" VARCHAR, \"EVIDENCE_PHOTOS\" VARCHAR)\n</code></pre>\n"},{"tags":["mysql","sql","query","join"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":118,"score":6,"question_id":12737572,"title":"Need SQL guru for a complex query","body":"<p>I have several tables that I am trying to get some data out of, and I am very close, but cannot quite close the deal.</p>\n\n<p>I have the following tables:</p>\n\n<ul>\n<li>EVENT</li>\n<li>USER</li>\n<li>FRIEND</li>\n<li>USER__FRIEND</li>\n<li>EVENT__INVITATION</li>\n</ul>\n\n<p>USER and FRIEND are linked via the USER__FRIEND table (which contains a USER_ID and a FRIEND_ID field)</p>\n\n<p>EVENT__INVITATION links an EVENT with a FRIEND (it has EVENT_ID and INVITEE_ID)</p>\n\n<p>I am trying to get all EVENTS where:</p>\n\n<ul>\n<li>I am the EVENT creator ($myUserID = EVENT.CREATOR_ID)</li>\n<li>or I am invited to the event ($myUserID = EVENT__INVITATION.INVITEE_ID)</li>\n<li>or one of my FRIENDs is the creator of the EVENT ($myUserID = USER__FRIEND.USER_ID AND EVENT.CREATOR_ID IN (list of my FRIENDs))</li>\n<li>or one of my FRIENDs is invited to the EVENT ($myUserID = USER__FRIEND.USER_ID AND EVENT__INVITATION.INVITEE_ID IN (list of my FRIENDs))</li>\n</ul>\n\n<p>There are some other WHERE conditions around other parameters, but I think I can sort those out on my own.</p>\n\n<p>Right now the only way I could get this to work was with a UNION, which I think must be a cop-out, and if I had better chops I could get around using it.</p>\n\n<p>So, the question is, can this be done with a single, inexpensive query that does not use a UNION?</p>\n\n<p>Here is what I have so far, which accomplishes everything except the EVENTs that my FRIENDs are invited to (23 is the passed in userID in this case):</p>\n\n<pre><code>SELECT e.*\nFROM event e\nLEFT JOIN event__invitation ei ON ei.event_id = e.id\nLEFT JOIN user__friend uf ON uf.friend_id = ei.invitee_id\nLEFT JOIN friend f ON f.id = uf.friend_id\nWHERE (ei.invitee_id = 23 OR e.creator_id = 23 OR uf.user_id = 23 OR f.user_id = e.creator_id)\nAND e.start_time &gt;= 1348000000\n</code></pre>\n\n<p>and this is the query with the UNION:</p>\n\n<pre><code>SELECT e.* FROM event e\nINNER JOIN event__invitation ei ON ei.event_id = e.id\nINNER JOIN user__friend uf ON uf.friend_id = ei.invitee_id\nWHERE (e.creator_id = 23 OR ei.invitee_id = 23 OR uf.user_id = 23)\nUNION\nSELECT e1.* FROM event e1\nWHERE e1.creator_id IN (\n    SELECT f1.user_id FROM friend f1\n    INNER JOIN user__friend uf1 ON uf1.friend_id = f1.id\n    WHERE uf1.user_id = 23\n    AND f1.user_id IS NOT NULL\n);\n</code></pre>\n\n<p>There is more to the query that makes the use of the UNION undesireable.  I have a complex trig calculation that I am doing in the main select, and am ordering the results by that value.  I think may mess up the result set.</p>\n\n<p>Thanks for any help!!</p>\n"},{"tags":["sql-server","query","tsql","select","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12775697,"title":"How to extract ids of the rows with minimum value in sql","body":"<p>I have the following table</p>\n\n<pre><code>RecordID     Group     Date        Value\n----------------------------------------\n 1           Test 1   1/01/2012     10\n 2           Test 1   1/01/2012     10\n 3           Test 1   1/01/2012     20\n 4           Test 2   1/01/2012     20\n 5           Test 1   2/01/2012     10\n 6           Test 2   2/01/2012     30\n 7           Test 1   2/01/2012     20\n 8           Test 1   2/01/2012     20\n 9           Test 2   2/01/2012     20\n10           Test 1   3/01/2012     10\n11           Test 2   3/01/2012     10\n12           Test 2   3/01/2012     20\n13           Test 3   3/01/2012     10\n14           Test 1   4/01/2012     10\n</code></pre>\n\n<p>I need to get all RecordIds, where for the same date and same group it has the lowest value and disregard all records for the same date and group that have greater value. So my query needs to group by \"date\" and \"group\" and find records with lowest value, that is result should be:</p>\n\n<p>RecordIds: 1, 2, 4, 5, 9, 10, 11, 13, 14</p>\n"},{"tags":["query","prolog","playing-cards","sicstus-prolog"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":11883842,"title":"Sicstus Prolog: Deck of Cards Query","body":"<p>I am working through this question:</p>\n\n<p>In a four-player game of bridge, each player gets 13 cards, dealt in order.\nWrite a predicate <code>deal(Cards, H1, H2, H3, H4)</code> that takes a deck as its first argument, and succeeds by binding <code>H1</code> to the 13 cards received by player 1 in the deal, etc.</p>\n\n<p>Hint: One strategy is to write four helper predicates <code>deal1</code> that deals to player\n1, <code>deal2</code> that deals to player 2, etc.</p>\n\n<p>Here is the code given:   </p>\n\n<pre><code>cards(ace).\ncards(deuce).\ncards(three).\ncards(four).\ncards(five).\ncards(six).\ncards(seven).\ncards(eight).\ncards(nine).\ncards(ten).\ncards(jack).\ncards(queen).\ncards(king).\n\nsuits(spades).\nsuits(hearts).\nsuits(clubs).\nsuits(diamonds).\n\n\ndeck([(ace,spades),(deuce,spades),(three,spades),(four,spades),\n    (five,spades),(six,spades),(seven,spades),(eight,spades),\n    (nine,spades),(ten,spades),(jack,spades),(queen,spades),\n    (king,spades),\n    (ace,hearts),(deuce,hearts),(three,hearts),(four,hearts),\n    (five,hearts),(six,hearts),(seven,hearts),(eight,hearts),\n    (nine,hearts),(ten,hearts),(jack,hearts),(queen,hearts),\n    (king,hearts),\n    (ace,clubs),(deuce,clubs),(three,clubs),(four,clubs),\n    (five,clubs),(six,clubs),(seven,clubs),(eight,clubs),\n    (nine,clubs),(ten,clubs),(jack,clubs),(queen,clubs),\n    (king,clubs),\n    (ace,diamonds),(deuce,diamonds),(three,diamonds),(four,diamonds),\n    (five,diamonds),(six,diamonds),(seven,diamonds),(eight,diamonds),\n    (nine,diamonds),(ten,diamonds),(jack,diamonds),(queen,diamonds),\n    (king,diamonds)]).\n</code></pre>\n\n<p>Here is my answer:</p>\n\n<pre><code>deal([],[],[],[],[]).\n\ndeal([C1,C2,C3,C4|Cards],[C1|H1],[C2|H2],[C3|H3],[C4|H4]) :-\n    deal(Cards,H1,H2,H3,H4).\n</code></pre>\n\n<p>I'm almost positive that my answer is correct, but I am having a problem querying.</p>\n\n<pre><code>?- deal(deck,A,B,C,D).\n</code></pre>\n\n<p>The query comes back <code>fail</code>, but putting in the actual list of cards, instead of <code>deck</code> works.\nI think the problem is where I'm trying to insert deck, when it's not a list, but I don't know how to get into the list in <code>deck</code>. I'm new to Prolog, so hopefully it's just a simple fix. Thanks</p>\n\n<p>EDIT:</p>\n\n<p>After adding the suggestion below. My new answer is</p>\n\n<pre><code>dealer([],[],[],[],[]).\ndealer([C1,C2,C3,C4|Cards],[C1|H1],[C2|H2],[C3|H3],[C4|H4]) :-\n    dealer(Cards,H1,H2,H3,H4).\n\ndeal(_,A,B,C,D) :-\n    deck(Deck),\n    dealer(Deck,A,B,C,D).\n</code></pre>\n"},{"tags":["php","mysql","database","query","pdo"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":68,"score":-1,"question_id":12774605,"title":"PHP Retrieve Column In Lowercase","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12656617/php-pdo-username-availability-checker\">PHP PDO Username Availability Checker</a>  </p>\n</blockquote>\n\n\n\n<p>I have a php script that checks the availability of a username (if it's taken already or not). But I want to compare the username typed in by the user and the usernames in the database in lowercase. I already put the input in lowercase, but how do I make the retrieved column in lower case. Here's the php script</p>\n\n<pre><code>&lt;?php \n    $usr = strtolower($_GET['username']);\n    $link = new PDO('mysql:host=***;dbname=***;charset=UTF-8','***','***');\n    $usr_check = $link-&gt;prepare(\"SELECT * FROM Conference WHERE Username = :usr\");\n    $usr_check-&gt;bindParam(':usr', $usr);\n    $usr_check-&gt;execute();\n    if($usr_check-&gt;rowCount()&gt;0)\n        echo \"false\";\n    else\n            echo \"true\";\n?&gt;\n</code></pre>\n\n<p>How do i set the username column to lowercase, then compare it to <code>$usr</code>? Thanks</p>\n"},{"tags":["mysql","sql","query","alter-table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":12774709,"title":"MySQL very slow for alter table query","body":"<p>I'm trying to figure out why it's taking more than an hour to simply update this table to add a column. This table has 15M rows, 2 indexes and a single key primary key. The ALTER TABLE query has been in \"copy to tmp table\" state for 1h15m now.</p>\n\n<p>ALTER TABLE <code>frugg</code>.<code>item_catalog_map</code> ADD COLUMN <code>conversion_url</code> TEXT NULL DEFAULT NULL</p>\n\n<pre><code>mysql&gt; describe item_catalog_map;\n+------------------------+---------------+------+-----+---------+-------+\n| Field                  | Type          | Null | Key | Default | Extra |\n+------------------------+---------------+------+-----+---------+-------+\n| catalog_unique_item_id | varchar(255)  | NO   | PRI | NULL    |       |\n| catalog_id             | int(11)       | YES  | MUL | NULL    |       |\n| item_id                | int(11)       | YES  | MUL | NULL    |       |\n| price                  | decimal(10,2) | YES  |     | 0.00    |       |\n+------------------------+---------------+------+-----+---------+-------+\n\nmysql&gt; show index from item_catalog_map;\n+------------------+------------+----------------------+--------------+------------------------+-----------+-------------+----------+--------+------+------------+---------+\n| Table            | Non_unique | Key_name             | Seq_in_index | Column_name            | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |\n+------------------+------------+----------------------+--------------+------------------------+-----------+-------------+----------+--------+------+------------+---------+\n| item_catalog_map |          0 | PRIMARY              |            1 | catalog_unique_item_id | A         |    15485115 |     NULL | NULL   |      | BTREE      |         |\n| item_catalog_map |          1 | IDX_ACD6184FCC3C66FC |            1 | catalog_id             | A         |          18 |     NULL | NULL   | YES  | BTREE      |         |\n| item_catalog_map |          1 | IDX_ACD6184F126F525E |            1 | item_id                | A         |    15485115 |     NULL | NULL   | YES  | BTREE      |         |\n+------------------+------------+----------------------+--------------+------------------------+-----------+-------------+----------+--------+------+------------+---------+\n</code></pre>\n"},{"tags":["hibernate","query","cancel"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1008,"score":4,"question_id":1888595,"title":"How can I cancel a hibernate query","body":"<p>If a user presses the \"search\" button and then they decide to do \"something else\", we have to cancel an already running query.</p>\n\n<p>We use Hibernate (and Oracle) as persistence solution. Hibernates Session interface provides a <code>cancelQuery()</code> method. After some testing, it seems that <code>cancelQuery()</code> has no effect.</p>\n\n<p>Does anybody have some experience with this <code>Session#cancelQuery()</code> method? </p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","vb.net","query","set","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12774336,"title":"vb.net set multiple SQL values to the same row in one query","body":"<p>i have the following code which will set 2 values in the same row, its really simple but i am not sure how to combine it in one query</p>\n\n<pre><code> Dim cnn As New SqlConnection\n            Dim sqlcmd As New SqlCommand(\"SELECT catalogid, delivered,nodilivary FROM supporder\", cnn)\n            sqlcmd.CommandText = \"update supporder SET delivered=@delivered WHERE catalogid=@catalogid\"\n            sqlcmd.Parameters.Add(New SqlParameter(\"@delivered\", GridControl2.GetCellValue(currentrowindex, \"delivered\")))\n            sqlcmd.Parameters.Add(New SqlParameter(\"@catalogid\", GridControl2.GetCellValue(currentrowindex, \"catalogid\")))\n            cnn.Open()\n            sqlcmd.ExecuteNonQuery()\n            sqlcmd.Parameters.Clear()\n            cnn.Close()\n            sqlcmd.CommandText = \"update supporder SET nodilivary=@nodilivary WHERE catalogid=@catalogid\"\n            sqlcmd.Parameters.Add(New SqlParameter(\"@nodilivary\", GridControl2.GetCellValue(currentrowindex, \"nodilivary\")))\n            sqlcmd.Parameters.Add(New SqlParameter(\"@catalogid\", GridControl2.GetCellValue(currentrowindex, \"catalogid\")))\n            cnn.Open()\n            sqlcmd.ExecuteNonQuery()\n            sqlcmd.Parameters.Clear()\n            cnn.Close()\n</code></pre>\n"},{"tags":["sql","database","query","sqlite","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12774181,"title":"SQL select with one clause subordinate to other","body":"<p>I have a table of quarterback statistics. Each row in the table represents one QB's performance in one game. The unique ID for each row is called gameId and is composed of the player's ID plus the game date.</p>\n\n<p>What I want to do is use a select statement to generate a list of all unique quarterbacks in the table, who have thrown at least one completion.</p>\n\n<p>I'm trying to do that with this statement:</p>\n\n<pre><code>SELECT * FROM swdata\nWHERE gameComp &gt; 0 AND gameId IN (\n   SELECT MAX(gameId) FROM swdata GROUP BY playerId)\nORDER BY playerLastName\n</code></pre>\n\n<p>The first clause is gameComp > 0, and the second clause is to winnow the list down to unique quarterbacks.</p>\n\n<p>What I want to happen is for the first clause to be run, and then for the second clause to be run on the results of the first clause. </p>\n\n<p>But what's actually happening is that they run concurrently, and this results in some players being omitted from the results.</p>\n\n<p>So, I know I've structured it wrong. Can anyone help me get it right?</p>\n"},{"tags":["php","sql","query","hidden"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12773777,"title":"SQL Query: Hide items based on column value?","body":"<p>I am pulling some data from table in a MySQL database. Inside this table is a column called \"hidden\", by default it is set to 0, but when an item needs to be hidden, it will be set to 1. So I need a code that I can use that will hide all rows if the \"hidden\" column is set to 1.</p>\n\n<p>Lets say my code is something simple like this:</p>\n\n<pre><code>&lt;?php\n$result = mysql_query(\"SELECT * FROM clients ORDER BY name\") \nor die(mysql_error());  \nwhile($row = mysql_fetch_array( $result )) {\necho $row['name'];\n} \n?&gt;\n</code></pre>\n\n<p>Is there a simple code I can add to it?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12773159,"title":"hyphen in ALTER SCHEMA sql query","body":"<p>I keep getting error for the following query </p>\n\n<pre><code>ALTER SCHEMA dbo TRANSFER domain-USERS\\user.tablename;\n</code></pre>\n\n<p>I tried other table of the same database with a different name and it works fine. (like username.tablename)</p>\n\n<p>So I think the problem is the hyphen in the username.</p>\n\n<p>I also tried the following query but no help.</p>\n\n<pre><code>ALTER SCHEMA dbo TRANSFER 'domain-USERS\\user'.tablename;\n\nALTER SCHEMA dbo TRANSFER 'domain-USERS\\user.tablename';\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["query","mongodb","sorting"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12770673,"title":"Sorting by relevance with MongoDB","body":"<p>I have a collection of documents in the following form:</p>\n\n<pre><code>{ _id: ObjectId(...)\n, title: \"foo\"\n, tags: [\"bar\", \"baz\", \"qux\"] \n}\n</code></pre>\n\n<p>The query should find all documents with any of these tags. I currently use this query:</p>\n\n<pre><code>{ \"tags\": { \"$in\": [\"bar\", \"hello\"] } }\n</code></pre>\n\n<p>And it works; all documents tagged \"bar\" or \"hello\" are returned.</p>\n\n<p>However, I want to sort by relevance, i.e. the more <em>matching tags</em> the earlier the document should occur in the result. For example, a document tagged <code>[\"bar\", \"hello\", \"baz\"]</code> should be higher in the results than a document tagged <code>[\"bar\", \"baz\", \"boo\"]</code> for the query <code>[\"bar\", \"hello\"]</code>. How can I achieve this?</p>\n"},{"tags":["query","postgresql","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":12767685,"title":"How does this PostgreSQL query slow down when the number of rows increases?","body":"<p>I have a table briefly structured like this:</p>\n\n<pre><code>tn( id integer NOT NULL primary key DEFAULT nextval('tn_sequence'),\n                 create_dt TIMESTAMP NOT NULL DEFAULT NOW(),\n                             ...............\n                 deleted boolean );\n</code></pre>\n\n<p><code>create_dt</code> is the timestamp when the row is inserted into the database.</p>\n\n<p><code>deleted</code> indicates that the row is or no longer useful.</p>\n\n<p>And I have the following queries:</p>\n\n<pre><code>select * from tn where create_dt &gt; ( NOW() - interval '150 seconds ) and deleted = FALSE;\nselect * from tn where create_dt &lt; ( NOW() - interval '150 seconds ) and deleted = FALSE;\n</code></pre>\n\n<p>My question is how these query will slow down when the number of rows increase? For instance, when the number of rows exceeds 10K, 20K, or 100K, will it make a big impact on the speed? Is there any way I can optimize these queries? Note that every 5 seconds I will turn the column 'deleted' of rows which are older than 150 seconds into 'TRUE'.</p>\n"},{"tags":["php","mysql","query","variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":60,"score":-3,"question_id":12772161,"title":"MySQL query doesnt work in PHP code","body":"<p>I got a MySQL query, it works if I do it manually in phpadmin, but it doesnt work in the code.\nCan anyone tell me why? I tried to google it and find answers, but I must be missing something very obvious here, I get the error in the execution line.</p>\n\n<pre><code>$stmt = $conn-&gt;prepare(\"SET @CURDATE = CURDATE(); SET @PREVDATE = DATE_ADD(@CURDATE ,INTERVAL -\" . $timeperiod . \"); SET @DIFF = DATEDIFF(@CURDATE, @PREVDATE); SELECT   `Poster`,   Round(Sum(1 / @DIFF), 0) AS `statistics` FROM `forenposts` WHERE  `Date`&gt;=@PREVDATE And `Date`&lt; @CURDATE GROUP BY `Poster` ORDER BY `statistics` DESC LIMIT 5;\");\n    echo  \"&lt;table&gt;\";\n    $stmt-&gt;execute();\n</code></pre>\n\n<p>Error message:\nFatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[HY000]: General error'</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12750835,"title":"mySQL Join Tables with Uneven Row Lengths","body":"<p>I have data for a game where in one table are the game stats and in another table is the game information like home team, away team, game date, and winner. I'm looking for a way to join the game info data with the stats data. The stats data is configured so that the first five players are the home team and the second five players are the away team. </p>\n\n<p>game info schema:\ngamelog( <em>gameid</em>, gamedate, hometeam, awayteam, winner )\ngamestats( <em>gameid</em>, <em>index</em>, player, points, rebounds, ... )</p>\n\n<p>I would like my output to be:</p>\n\n<ul>\n<li>home, hometeam, player, points, rebound</li>\n<li>home, hometeam, player, points, rebound </li>\n<li>home, hometeam, player, points, rebound </li>\n<li>home, hometeam, player, points, rebound </li>\n<li>home, hometeam, player, points, rebound </li>\n<li>away, awayteam, player, points, rebound </li>\n<li>away, awayteam, player, points, rebound </li>\n<li>away, awayteam, player, points, rebound</li>\n<li>away, awayteam, player, points, rebound </li>\n<li>away, awayteam, player, points, rebound</li>\n</ul>\n\n<p>I can't seem to find a way to do a join so that the team column has its first five names as the home team and the second five names as the away team. The only way I have managed to do it is with two additional columns each with ten team names in them ie:</p>\n\n<pre><code>SELECT gamelog.hometeam, gamelog.awayteam, gamestats.player, gamestats.points, gamestats.rebounds \n    WHERE gamestats.id = 18873\n    AND gamelog.id = gamestats.id;\n</code></pre>\n\n<ul>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n<li>hometeam, awayteam, player, points, rebound</li>\n</ul>\n\n<p>I guess another possibility would be to do multiple queries through PHP and then combine the data after the queries are done, though I am not sure if that would be more efficient. I could also add a column into the gamestats table that has the team names, but that seems redundant.</p>\n\n<p>Edit: Posted the schema's and cleared up the language</p>\n"},{"tags":["php","zend-framework","query","dom"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":893,"score":3,"question_id":5071653,"title":"How to use Zend Dom Query without Zend FW?","body":"<p>Is it possible to use Zend Dom Query without Zend Framework?</p>\n\n<p>If yes: Where to download Zend Dom Query and how to use it without Zend Framework?</p>\n"},{"tags":["query","node.js","mongodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12769252,"title":"Querying a MongoDB based on Mongo ID in a node.js app","body":"<p>I'm using a node.js and mongodb, and I'm trying to query the database based on the mongo generated ID using the following:</p>\n\n<pre><code>    collection.findOne( {_id:doc._id} , function(err, item) {});\n</code></pre>\n\n<p>I am 100% certain that my doc._id is an exact match to the doc _id that I am looking for in the collection, and yet I get a null response from the db query.</p>\n\n<p>I have tried this using other keys in the document and it returns the document just fine. It's only when I try to use the mongo ID.</p>\n"},{"tags":["mysql","sql","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":120,"score":10,"question_id":12327762,"title":"How to query a join table so that multiple criteria are met?","body":"<p>I have a table with 2 columns (see below).  A member can have multiple responses to a question:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>RESPONSES\n---------\nmember_id  INT\nresponse_id  INT\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>SAMPLE DATA\nmember_id -- response_id\n    1     --     3\n    1     --     5\n    2     --     1\n    2     --     5\n    2     --     9\n    3     --     1\n    3     --     5\n    3     --     6\n</code></pre>\n\n<p>What I need to do is query the table for member that meet ALL response criteria.  For example I need to select all members that have a response_id of 1 AND 5.  I am using the following query:</p>\n\n<pre><code>SELECT DISTINCT member_id \nFROM responses \nWHERE response_id = 1 AND response_id = 5\n</code></pre>\n\n<p>I would expect to get back member_id's 2 and 3.  However I am getting nothing returned.  I used EXPLAIN and it shows there is an error in my where query.  What am I doing wrong?</p>\n\n<p>Also, is there a function similar to IN where all the criteria must be met in order to return true?</p>\n"},{"tags":["mysql","sql","query","select","pivot"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":12667699,"title":"SQL Query fields as columns","body":"<p>I dont really know how to put this but please kindly check the details below.</p>\n\n<p><strong>Student</strong></p>\n\n<pre><code>|Student_ID|Student_Name|\n|1         |Ryan        |\n|2         |Camille     |\n|3         |George      |\n</code></pre>\n\n<p><strong>Grade</strong></p>\n\n<pre><code>|Student_ID|Subject |Grade\n|1         |Math    |5 \n|1         |English |3 \n|1         |History |1\n|2         |Math    |3 \n|2         |English |4 \n|2         |History |1 \n|3         |Math    |5 \n|3         |English |1 \n|3         |History |2 \n</code></pre>\n\n<p>Is it possible to get this result?</p>\n\n<pre><code>Student_Name|Math|English|History\nRyan        |5   |3      |1\nCamille     |3   |4      |1\nGeorge      |5   |1      |2\n</code></pre>\n\n<p>Now I've been doing this the hardway by populating an unbound datagrid with first the column name, then the student name then adding the the details for each student name. This is time consuming and I want to optimize the query better.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","query","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":46,"score":1,"question_id":12769756,"title":"Call to a member function query() on a non-object","body":"<p>I am kind of new to PHP, and very new to MySQLi and <strong>I am trying to insert a row into the database comprised of 5 variables.</strong></p>\n\n<pre><code>if($_POST['submit']) {\n            $title = mysqli_escape_string($_POST['title']);\n            $content = $_POST['content'];\n            $author = $_SESSION['fullname'];\n            $publishedtime = time();\n            $pageID = $_POST['pageid'];\n            $connection = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME);\n\n            if ($connection-&gt;errno) {\n                printf(\"Connection failed: %s\\n\", $connection-&gt;error);\n                exit();\n            }\n\n            $author = $_SESSION['fullname'];\n            $publishedtime = time();\n            $q = \"INSERT INTO posts (title, content, author, publishedtime, pageID) VALUES ('\".$title.\"', '\".$content.\"', '\".$author.\"', '\".$publishedtime.\"', '\".$pageID.\"')\";\n\n            if (!$dbc-&gt;query($q)) {\n                echo \"INSERT failed: (\" . $dbc-&gt;errno . \") \" . $dbc-&gt;error;\n            }    \n            echo \"Newest user id = \",$dbc-&gt;insert_id;\n\n            $connection-&gt;close();\n\n        }\n        else {\n            addPostForm();\n        }\n</code></pre>\n\n<p>and I get these errors:</p>\n\n<blockquote>\n  <p>Warning: mysqli_escape_string() expects exactly 2 parameters, 1 given in /admin/manage.php on line 11</p>\n  \n  <p>Fatal error: Call to a member function query() on a non-object in /admin/manage.php on line 27</p>\n</blockquote>\n\n<p>I can read the database fine but can't insert into it.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","query","date"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12769256,"title":"MySQL \"date_sub(now(), INTERVAL X\" Error Code: 1366 Incorrect string value: '\\xEF\\x80\\xA6Top...' for column 's' at row 3","body":"<p>I have a problem here thats really puzzling me. I have a MySQL query, that works fine.. for the most part. In the query, Im looking at dates and date ranges from a table, and returning results that are X days old from today. It looks like this:</p>\n\n<pre><code>    WHERE tickets.date_created &gt; date_sub(now(), INTERVAL 30 DAY)\n</code></pre>\n\n<p>Under most conditions, the query works fine. However, if I change the interval to a number between 80 to 97 my script fails to execute. The error I get is:</p>\n\n<pre><code>    Error Code: 1366 Incorrect string value: '\\xEF\\x80\\xA6Top...' for column 's' at row 3\n</code></pre>\n\n<p>Also, tryin 3 months, rather than 90 days doesnt work. There appear to be other numbers in the 100's that dont work too, however, if I set something like 10000 days, all results return ok.</p>\n\n<p>Is this something in my database? Is it my query? Has anyone seen this with a date interval? What am I doing wrong?</p>\n\n<p>Any thoughts anyone has :) </p>\n\n<p>Many thanks!</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12769015,"title":"Simple query taking long time in MySQL ","body":"<p>I must be overseeing something, but I have the following query:</p>\n\n<pre><code>SELECT\n    `Poster`, Round(Sum(If((`Date`&gt;=DATE_ADD(CURDATE(),INTERVAL -1 Month) And `Date`&lt;CURDATE()),1,0))/DATEDIFF(CURDATE(),DATE_ADD(CURDATE(),INTERVAL -1 Month)),0) AS `statistics`\nFROM `forenposts`\nGROUP BY `Poster`\nORDER BY `statistics` DESC\nLIMIT 5\n</code></pre>\n\n<p>This takes roughly 15 seconds in a database with more than 1.5 million entries.</p>\n\n<p>Is there an easy way to optimize it or is the If function just taking so long?</p>\n"},{"tags":["mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":70,"score":5,"question_id":12762073,"title":"MySQL order by the number of matches in an intermediate table","body":"<p>So I have a query that is trying to grab \"related posts\".</p>\n\n<p>Categories have a one-to-many relationship with posts.  Tags have a many-to-many relationship.  So my tables look roughly like this:</p>\n\n<pre><code>posts table:\nid | category_id | ... | ...\n\ntags table:\nid | ... | ...\n\npost_tag intermediate table:\nid | post_id | tag_id | ... | ...\n</code></pre>\n\n<p>So if I have a single Post row already, and what to grab its \"related\" posts.  My logic is roughly that I want to grab only posts that are in the same category, but to order those posts by the amount of tags that match the original post.  So another post in the same category that has the exact same tags as the original post, should be a very high match, whereas a post that only matches 3/4 of the tags will show up lower in the results.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>SELECT *\nFROM posts AS p\nWHERE p.category_id=?\nORDER BY ( SELECT COUNT(id) \n           FROM post_tag AS i \n           WHERE i.tag_id IN( ? )\n         )\nLIMIT 5\n</code></pre>\n\n<p>BINDINGS:\n  Initial Posts Category ID;\n  Initial Posts Tag IDs;</p>\n\n<p>Clearly this is not going to actually order the results by the correct values in the sub-select.  I am having trouble trying to think of how to join this to achieve the correct results.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","query","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":39,"score":-2,"question_id":12767414,"title":"Simple SQL query, but out of my field, help needed","body":"<p>I have 2 tables, SalesOrderHeader and SalesOrderDetail, connection between them is the SalesOrderID field, as it is presented.</p>\n\n<p><img src=\"http://i.stack.imgur.com/sirJF.jpg\" alt=\"\"></p>\n\n<p>I need to create a query which will show quantity (OrderQty) and sales value (OrderQty * UnitPrice) for every customer (CustomerID) in the month of August, 2012 (OrderDate). Just a heads up, OrderDate is a datetime type of field (example year-month-day 2012-09-18).</p>\n"},{"tags":["database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12767371,"title":"download pdf files from online database","body":"<p>I would like to download ~40,000 pdf files from an online database (westlaw). I can make a query to it which will return x files. Normally, I could just parse the html, find the download link for each pdf and go from there. However, it does not seem like it is possible this way because the webpage is created based on the database query, ie I believe that the links are just temporary links to the download files. When I do another get on the link file, it says page not available. (plus this way seems fairly tedious, given it's a database and I should just be able to do a lookup of the fields to get all the files)</p>\n\n<p>Any suggestions for how to do this for online db files in general? Or know specifically how to accomplish this on westlaw?</p>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12767130,"title":"How to multi update fields on a table excluding non existent ones","body":"<p>Okay so I made a query that takes a count of rows in <code>tableA</code> and groups the count by a <code>set_id</code> field into a temporary table <code>c</code>. It then does an <code>UPDATE</code> on <code>tableB</code> by changing the values of its <code>current_count</code> field to the values from table <code>c</code>'s  <code>count</code> if the <code>count</code> field from table <code>c</code> has the same <code>set_id</code> as the <code>current_count</code> field's <code>set_id</code> value.</p>\n\n<pre><code>UPDATE sets, (SELECT set_id, COUNT(set_id) AS count FROM leads_auto GROUP BY set_id) c \n    SET sets.current_count = c.count WHERE sets.set_id = c.set_id\n</code></pre>\n\n<p>The shortcoming of this query is that it cannot <code>UPDATE</code> <code>tableB</code> with a <code>current_count</code> value of zero if the no count exists in table <code>c</code> for <code>tableB</code>'s <code>set_id</code>.</p>\n\n<p>I tried this</p>\n\n<pre><code>UPDATE sets, (SELECT set_id, COUNT(set_id) AS count FROM leads_auto GROUP BY set_id) d\n     SET sets.current_count = 0 WHERE sets.set_id != d.set_id\n</code></pre>\n\n<p>But it does not effect any rows on <code>tableB</code> even though table <code>c</code> returns rows with a <code>set_id</code> in <code>tableB</code> and excludes some <code>set_id</code>'s that do exist in <code>tableB</code>.</p>\n\n<p>Anyone know how to accomplish this?</p>\n\n<pre><code>SELECT set_id, COUNT(set_id) AS count FROM leads_auto GROUP BY set_id\n</code></pre>\n\n<p><strong>Returns</strong></p>\n\n<p>set_id | count<br/> \n1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7<br/>\n5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5<br/>\n4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16<br/>\n7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2000000<br/></p>\n"},{"tags":["mysql","query","joomla"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":156,"score":-1,"question_id":12758621,"title":"joomla database select and insert query","body":"<p>i am trying to insert another info to joomla (2.5.7) database after user is registered. The user chooses his usergroup and I want the insertion to happen only when the user is in a specific group. So I am trying to use this code to get the group data from the databse first to be used in the insert query. Now it is just a testing ground, later this retrieved value be used in if statement.</p>\n\n<p>This is the code:</p>\n\n<pre><code>function onUserAfterSave($user, $isnew, $success, $msg)\n    {\n    if ($isnew &amp;&amp; $success) {\n  $db = &amp;JFactory::getDBO();\n  $query = \"SELECT #__k2_users.group FROM #__k2_users WHERE userID = \".$user['id'];\n  $db-&gt;setQuery($query);\n  $group = $db-&gt;loadResult();\n\n  $db-&gt;setQuery( 'INSERT INTO #__user_profiles (ordering) VALUES ('.$group.')' );\n  $db-&gt;query();\n   if (!$db-&gt;query()) \n   {\n    throw new Exception($db-&gt;getErrorMsg());\n   }  \n  }\n    return $this-&gt;onAfterStoreUser($user, $isnew, $success, $msg);\n}\n</code></pre>\n\n<p>and this is the error I am getting upon the failed registration:</p>\n\n<pre><code>Column count doesn't match value count at row 1 SQL=INSERT INTO std13_user_profiles (ordering) VALUES ()\n</code></pre>\n\n<p>If I read it correctly, it means that the select statement is not returning anything but why? Thank you for your help.</p>\n\n<p>UPDATE:</p>\n\n<pre><code> if ($isnew &amp;&amp; $success) {\n  $db = &amp;JFactory::getDBO();\n  $userId   = JArrayHelper::getValue($user, 'id', 0, 'int');\n  $query = \"SELECT #__k2_users.group FROM #__k2_users WHERE userID = \".$userId;\n  $db-&gt;setQuery($query);\n  $group = $db-&gt;loadResult();\n\n\n    $query2 = \"INSERT INTO #__user_profiles (ordering) VALUES ('\".$group.\"')\";\n    $db-&gt;setQuery($query2);\n    $db-&gt;query();\n   if (!$db-&gt;query()) \n   {\n    throw new Exception($db-&gt;getErrorMsg());\n   }  \n  }\n</code></pre>\n\n<p>with this code, I don't get any errors and the user is registered and the values are inserted. However the $group is always 0 and based on the value is only 1 or 3 in k2_users table, I am guessing that it returns nothing. I think it may be because the registered user is not stored in the databse yet and it doesn't have his ID yet to look for the group?</p>\n\n<p>UPDATE2:</p>\n\n<pre><code>if ($isnew &amp;&amp; $success) {\n\n    $count = JRequest::getVar('gender');\n    if($count == 3) {\n\n    $db = &amp;JFactory::getDBO();\n    $alias = $user['name'];\n    $table = array(\n    ' '=&gt;'-', 'Š'=&gt;'S', 'š'=&gt;'s', 'Ð'=&gt;'Dj', 'Ž'=&gt;'Z', 'ž'=&gt;'z', 'C'=&gt;'C', 'c'=&gt;'c', 'C'=&gt;'C', 'c'=&gt;'c',\n    'À'=&gt;'A', 'Á'=&gt;'A', 'Â'=&gt;'A', 'Ã'=&gt;'A', 'Ä'=&gt;'A', 'Å'=&gt;'A', 'Æ'=&gt;'A', 'Ç'=&gt;'C', 'È'=&gt;'E', 'É'=&gt;'E',\n    'Ê'=&gt;'E', 'Ë'=&gt;'E', 'Ì'=&gt;'I', 'Í'=&gt;'I', 'Î'=&gt;'I', 'Ï'=&gt;'I', 'Ñ'=&gt;'N', 'Ò'=&gt;'O', 'Ó'=&gt;'O', 'Ô'=&gt;'O',\n    'Õ'=&gt;'O', 'Ö'=&gt;'O', 'ě'=&gt;'e', 'Ù'=&gt;'U', 'Ú'=&gt;'U', 'Û'=&gt;'U', 'Ü'=&gt;'U', 'Ý'=&gt;'Y', 'Þ'=&gt;'B', 'ß'=&gt;'Ss',\n    'à'=&gt;'a', 'á'=&gt;'a', 'â'=&gt;'a', 'ã'=&gt;'a', 'ä'=&gt;'a', 'å'=&gt;'a', 'æ'=&gt;'a', 'ç'=&gt;'c', 'è'=&gt;'e', 'é'=&gt;'e',\n    'ê'=&gt;'e', 'ë'=&gt;'e', 'ì'=&gt;'i', 'í'=&gt;'i', 'î'=&gt;'i', 'ï'=&gt;'i', 'ð'=&gt;'o', 'ñ'=&gt;'n', 'ò'=&gt;'o', 'ó'=&gt;'o',\n    'ô'=&gt;'o', 'õ'=&gt;'o', 'ö'=&gt;'o', 'ø'=&gt;'o', 'ù'=&gt;'u', 'ú'=&gt;'u', 'û'=&gt;'u', 'ý'=&gt;'y', 'ý'=&gt;'y', 'þ'=&gt;'b',\n    'ÿ'=&gt;'y', 'R'=&gt;'R', 'r'=&gt;'r', \" \"=&gt;'-', '\"'=&gt;'-'\n);\n    $string = strtr($alias, $table);\n    $alias_low = strtolower($string);\n    $query = \"INSERT INTO #__menu (menutype, title, alias,  path, link, type, published, level, component_id, access) VALUES ('stavebnici','\".$user['name'].\"','\".$alias_low.\"','\".$alias_low.\"',\n    'index.php?option=com_k2&amp;view=itemlist&amp;layout=user&amp;id=\".$user['id'].\"&amp;task=user','component',1,1,10012,1)\";\n    $db-&gt;setQuery($query);\n    $db-&gt;query();\n   if (!$db-&gt;query()) \n   {\n    throw new Exception($db-&gt;getErrorMsg());\n   }\n   }  \n  }\n</code></pre>\n\n<p>OKAY! I got it working so now I can insert new menu every time a user is created, however th activation link is not created and the registration says that it failed. This is the error:</p>\n\n<pre><code>Duplicate entry '0-1-vojtech-plesner-' for key 'idx_client_id_parent_id_alias_language' SQL=INSERT INTO std13_menu (menutype, title, alias, path, link, type, published, level, component_id, access) VALUES ('stavebnici','Vojtěch Plešner','vojtech-plesner','vojtech-plesner', 'index.php?option=com_k2&amp;view=itemlist&amp;layout=user&amp;id=2789&amp;task=user','component',1,1,10012,1)\n</code></pre>\n\n<p>The client_id, parent_id and language have values of 1,1 and * abd they are in all the rows so why is it saying it is duplicate?</p>\n"},{"tags":["ios","query","core-data"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12760296,"title":"Core data query","body":"<blockquote>\n  <p>V &lt;-->> O &lt;&lt;--> P</p>\n</blockquote>\n\n<p>I am trying to write the right predicate so that I can get all <code>V</code> entities that have at least one or more <code>O</code> entities that match a certain <code>P</code> entity.</p>\n\n<p>I've tried something like this:</p>\n\n<pre><code>NSPredicate * predicate = [NSPredicate predicateWithFormat:@\"SUBQUERY(O, $b, ANY $bs.P == %@).@count &gt; 0\", P];\n</code></pre>\n\n<p>Not working. Obviously I am not thinking about this correctly so far. Any idea how I can get this query done properly?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12764049,"title":"shorthand notation for query in mysql","body":"<p>Is there a method to give a shorthand notation to a query?</p>\n\n<p>ex.</p>\n\n<pre><code>Q1 = (select * from tablename2) \n\nQ2 = (select * from tablename2)\n\nselect name from Q1; \nselect name from Q2;\n</code></pre>\n\n<p>I am aware of views but I do not intend to use them.</p>\n"},{"tags":["sql","database","query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12764393,"title":"working with select statement and joins in access 2007","body":"<p>guys i am trying to run a select statement in access 2007 and i have problems on how to go about them in access 2007 i want to perform an outer join on two tables but i guess i need some guidance on how to go about it below is my code i tried to run in sql view in access 2007 any ideas i will greatly appreciate</p>\n\n<p>this is my sql statement</p>\n\n<pre><code>SELECT  MENU.[C_MENU],  MENU.[C_REC],  AUTO.[C_GROUP]\nFROM  MENU\n JOIN  AUTO\nON MENU.[C_MENU]=AUTO.[C_GROUP]\n</code></pre>\n\n<p>first problem is that this sql statement above is giving an error a syntax error and i do not know why its any ideas on how i can correct my error???its flashing on the <code>Join</code></p>\n"},{"tags":["mysql","query","inner-join","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":12762512,"title":"Data transposition and concatenation, how to follow inner join condition?","body":"<p>I've a number of tables that are related between them with a foreign and primary key (basic) system. </p>\n\n<p>I want to concat (comma separated) the values of the last \"in-depth\" table, respecting to some conditions. </p>\n\n<p>Because it's hard to explain, I've made a draw that, I think, it's pretty explicit:\n<img src=\"http://i46.tinypic.com/2ngdaah.jpg\" alt=\"image\"></p>\n\n<p>Larger image can be found here: <a href=\"http://tinypic.com/r/2ngdaah/6\" rel=\"nofollow\">http://tinypic.com/r/2ngdaah/6</a></p>\n\n<p>Note: <strong>tableE</strong> is already created with the column name corresponding to the names presented in <strong>tableD</strong></p>\n\n<p>Thank you!</p>\n\n<h2>EDITED (fiddle):</h2>\n\n<p><a href=\"http://sqlfiddle.com/#!2/f28c8/1/0\" rel=\"nofollow\">http://sqlfiddle.com/#!2/f28c8/1/0</a></p>\n"},{"tags":["php","mysql","query","webpage"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12755631,"title":"Building a PHP page from a MySQL query (newbie)","body":"<p>Im pretty new to PHP, basic level at MySQL and so/so at HTML and ASP. In short, I have a MySQL database that I have built a SQL query that returns the results I want in MySQL.</p>\n\n<p>What I am trying to learn to do, is build a web page that will:</p>\n\n<ul>\n<li>Pull all known \"organizations.name\" from the database into a dropdown to select one. (Shown in my query where I want to put the variable as VARIABLENAME)</li>\n<li>Have a dropdown with a selection fo days 30 Days, 60 Days, 180 days etc. (Shown in my query as to where that needs to go as VARIABLEDAYS)</li>\n</ul>\n\n<p>Basically, Im trying to make something that looks like this <a href=\"http://i.imgur.com/dwwGl.jpg\" rel=\"nofollow\">http://i.imgur.com/dwwGl.jpg</a></p>\n\n<p>And also has the relevant look on the output (Im struggling with getting the message portion of the formatting to dump below the other fields, rather than alongside).</p>\n\n<p>Here is my MySQL query.</p>\n\n<pre><code>    SELECT tickets.ref AS `Ticket Number`\n      , concat_ws(' ', people.first_name, people.last_name) AS `User Name`\n      , DATE_FORMAT(tickets.date_created, get_format(DATE, 'EUR')) AS `Date/Time`\n      , left(tickets.subject, 80) AS Subject\n      , sec_to_time(tickets.total_to_first_reply) AS `Time 1st Response`\n      , sec_to_time(tickets.total_user_waiting) AS `Total Wait`\n      , mycleanup (left(tickets_messages.message, 250)) AS Message\n    FROM\n      tickets\n    INNER JOIN organizations\n      ON tickets.organization_id = organizations.id\n    INNER JOIN people\n      ON tickets.person_id = people.id AND people.organization_id = organizations.id\n    INNER JOIN tickets_messages\n      ON tickets_messages.ticket_id = tickets.id AND tickets_messages.person_id = people.id\n    WHERE\n      tickets.date_created &gt; date_sub(now(), INTERVAL VARIABLEDAYS DAY)\n      AND organizations.name = VARIABLENAME\n    GROUP BY\n      tickets.ref\n    ORDER BY\n     `Date/Time`\n</code></pre>\n\n<p>As I say, this one is a bit of a mix as I need help with:</p>\n\n<ul>\n<li>How to change my Query to a PHP statement, along with making VARIABLEDAYS and VARIABLENAME, things that are pulled in from the web form.</li>\n<li>How to make the inital Web form, and specifically, make it pull the data into the VARIABLENAME dropbox, so that its a pull down list.</li>\n<li>How to get my PHP form to connect to a MySQL database correctly (so far everything Ive tried incuding design packages, connect ok to make the form.. but dont do anything when on the server.. and I have changed the connection to LOCALHOST and I know PHP works fine on the server)</li>\n</ul>\n\n<p>So anyone who wants to take a shot at helping me with any of those bits, or recommending something that I could use to generate those easily, without having to take a course in every single bit.. it would be much appreciated.</p>\n\n<p>Thanks</p>\n\n<p>Will</p>\n"},{"tags":["php","query","table","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12762022,"title":"How to insert values in certain row from PHP","body":"<p>I have the following array that is describing my table header:</p>\n\n<pre><code>$aColumns = array( 'time1.Time', 'time2.Time' , 'time1.id' , 'time1.Signal' , 'v.Name' , 'v.Lastname'  );\n</code></pre>\n\n<p>I want to insert new values in the <code>time1.id</code> column.</p>\n\n<p>When I process the following code I got my data shown in the first column which is <code>time1.Time</code> and I need it to be in column <code>time1.id</code> why is this happening?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>if ( mysql_num_rows( $rResult ) &gt; 0 )\n    {\n        $aCols = array_keys( mysql_fetch_assoc( $rResult ) );\n        mysql_data_seek($rResult, 0);\n        $id= array_search( 'time1.id', $aCols );        \n        $value= \"NEW_VALUE\";\n\n        while ( $aRow = mysql_fetch_row( $rResult ) ) \n        { \n            $aRow[$id] = $value;\n            $aOutput['aaData'][] = $aRow; \n        }\n    }\n</code></pre>\n"},{"tags":["sql","query","where-clause"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12759427,"title":"Where clause in sql query remove also null values","body":"<p>I have this tables:</p>\n\n<p>'Users'</p>\n\n<pre><code>id  email   name    last_access\n1   luca@gmail.com  Luca Pluto  2012-10-05 17:21:22.0\n2   pippo@gmail.com Irene Pippo 2012-10-05 17:22:25.0\n</code></pre>\n\n<p>'Nets_permissions'</p>\n\n<pre><code>user_id network_id  perm\n1   1234    3\n1   1235    1\n2   1235    3\n</code></pre>\n\n<p>I've written this query:</p>\n\n<pre><code>SELECT u.id, u.name, n.perm\nFROM users as u LEFT OUTER JOIN nets_permissions as n\nON u.id = n.user_id\nWHERE n.network_id=1234 AND n.perm &lt;&gt; 3\n</code></pre>\n\n<p>because I want users that already have a permission for my (1234) net, but also users that don't have a permission for the net. In other words I would have this result query:</p>\n\n<pre><code>2    null    null\n</code></pre>\n\n<p>because the user Luca Pluto with id=1, for the net 1234, have perm=3 so I want left out. Instead, the user Irene Pippo with id=2 doesn't have any permission on the 1234 net. So it's row must have net_id and perm set to null.</p>\n\n<p>My query result is empty. I don't know why. Without the clause n.perm &lt;> 3 seems to work well, but after also the null value are left out, not only the rws with perm=3.</p>\n\n<p>I've also tried in this way:</p>\n\n<pre><code>SELECT u.id, u.name, n.perm FROM users as u LEFT OUTER JOIN \n(select * from nets_permissions WHERE network_id=1234) as n on u.id = n.user_id \nWHERE n.perm &lt;&gt; 3\n</code></pre>\n\n<p>but doesn't work... without the WHERE clause all works. After no. The result query is empty.</p>\n\n<p>How I can resolve this problem? I need that the perm colum is a value or null, I can't remove this column.</p>\n\n<p>Thak you very much.</p>\n"},{"tags":["sql","query","join","aggregate-functions","teradata"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12730275,"title":"TERADATA: Aggregate across multiple tables","body":"<p>Consider the following query where aggregation happens across two tables: Sales and Promo and the aggregate values are again used in a calculation. </p>\n\n<pre><code>SELECT\n\n  sales.article_id,\n  avg((sales.euro_value - ZEROIFNULL(promo.euro_value)) / NULLIFZERO(sales.qty - ZEROIFNULL(promo.qty)))\n\nFROM\n(   SELECT \n         sales.article_id,\n         sum(sales.euro_value),\n         sum(sales.qty)\n    from SALES_TABLE sales\n    where year &gt;= 2011\n    group by article_id\n) sales\nLEFT OUTER JOIN\n(   SELECT \n         promo.article_id,\n         sum(promo.euro_value),\n         sum(promo.qty)\n    from PROMOTION_TABLE promo\n    where year &gt;= 2011\n    group by article_id\n) promo\n\nON sales.article_id = promo.article_id\n\nGROUP BY sales.article_id;\n</code></pre>\n\n<p>Some notes on the query:</p>\n\n<ol>\n<li>Both the inner queries return huge number of rows due to large number of articles. Running explain on teradata, the inner queries themselves take very less time, but the join takes a long time.</li>\n<li>Assume primary key on article_id is present and both the tables are partitioned by year.</li>\n<li>Left Outer Join because second table contains optional data.</li>\n</ol>\n\n<p>So, can you suggest a better way of writing this query.  Thanks for reading this far :)</p>\n"},{"tags":["mysql","sql","query","stored-procedures","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":12761460,"title":"A CONCATENATED INSERT wont accept a WHERE clause","body":"<p>This has me seriously stumped. I have a MySQL stored procedure that looks like this.</p>\n\n<pre><code> DELIMITER $$\n\nCREATE PROCEDURE `lms`.`leads_to_bak` ()\nBEGIN\nSET @table1 = (SELECT `tabler_name` FROM `sets` WHERE `on_off`=0 LIMIT 1);\nSET @table2 = CONCAT(@table1, '_bak');\nSET @SQL1 = CONCAT('INSERT INTO ',@table2, '(', (SELECT REPLACE(GROUP_CONCAT(COLUMN_NAME), 'lead_id,', '') FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @table2), ')', ' SELECT ', (SELECT REPLACE(GROUP_CONCAT(COLUMN_NAME), 'lead_id,', '') FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @table1), ' FROM ', @table1);\nPREPARE stmt FROM @sql1;\nEXECUTE stmt;\nEND$$\n\nDELIMITER ;\n</code></pre>\n\n<p><strong>Now the part that is important is this:</strong></p>\n\n<pre><code>SET @SQL1 = CONCAT('INSERT INTO ',@table2, '(', (SELECT REPLACE(GROUP_CONCAT(COLUMN_NAME), 'lead_id,', '') FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @table2), ')', ' SELECT ', (SELECT REPLACE(GROUP_CONCAT(COLUMN_NAME), 'lead_id,', '') FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @table1), ' FROM ', @table1);\n</code></pre>\n\n<p>Now from the looks of it, the statement can be translated to</p>\n\n<p><code>INSERT INTO @table2 (col1, col2, col3, ...)[minus lead_id] SELECT (col1, col2, col3, ...)[minus lead_id] FROM @table1</code></p>\n\n<p>Pretty simple right? Well I am trying to attach a <code>WHERE</code> clause at the end the end of that there <code>INSERT</code> statement to make it look something like this:</p>\n\n<p><code>INSERT INTO @table2 (col1, col2, col3, ...) SELECT (col1, col2, col3, ...) FROM @table1 WHERE set_id = (SELECT set_id FROM sets WHERE on_off = 0);</code></p>\n\n<p><strong>But no dice. Errors galore. Heck I even tried:</strong></p>\n\n<p><code>INSERT INTO (col1, col2, col3, ...) SELECT (col1, col2, col3, ...) FROM @table1 WHERE set_id = 1;</code></p>\n\n<p><strong>The string output is:</strong></p>\n\n<p><code>INSERT INTO leads_auto_bak(set_id,new_old,upload_date,agent,vendors,callcenter,generation_date,first_name,last_name,email,phone,address,city,state,zip,dob,gender,marital_status,rented,year,make,model,trim,vin,primary_use,miles_oneway,mileage,license_num,license_state,education,job_title,license_status) SELECT set_id,new_old,upload_date,agent,vendors,callcenter,generation_date,first_name,last_name,email,phone,address,city,state,zip,dob,gender,marital_status,rented,year,make,model,trim,vin,primary_use,miles_oneway,mileage,license_num,license_state,education,job_title,license_status FROM leads_auto\n</code></p>\n\n<p>But still nothing. I played around with the different ways to <code>CONCAT</code> that line at the end but it wont budge. Anyone got some advise?</p>\n"},{"tags":["java","query","rally","testcase"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12730026,"title":"Rally (Java): I dont want to add a testresult if there is one already in the testcase","body":"<p>I am sending a query to check whether there is a testcaseresult associated with a testcase. I am using this:</p>\n\n<pre><code>    QueryRequest c = new QueryRequest(\"testcaseresult\");\n    c.setFetch(new Fetch(\"testcase\"));\n    c.setQueryFilter(new QueryFilter(\"testcase\", \"=\", testCaseRef));\n    QueryResponse cc = r.query(c);\n</code></pre>\n\n<p>//String testresultRef = cc.getResults().get(0).getAsJsonObject().get(\"_ref\").toString();</p>\n\n<p>I want to create a new testcaseresult only if there is no testcaseresult in the testcase so far. how can i use the query to do it?\nThank you.</p>\n"},{"tags":["html","ajax","query","asp-classic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12744772,"title":"Show A table only if it has some rows to show","body":"<p>I need to create a table which should be shown in the page only if it has some content (rows) inside it. The purpose of the table would primarily be to display the data (excel sheets) imported by the user. I am doing all the coding in ASP, how can I accomplish this?</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12761052,"title":"Multi Subquery count function unable to take the stress of multiple selects","body":"<p>This has me stumped.</p>\n\n<p><strong>MySQL</strong></p>\n\n<pre><code>UPDATE sets SET sets.current_count = (SELECT COUNT(leads_auto.set_id) AS current_count FROM leads_auto WHERE leads_auto.set_id =  (SELECT sets.set_id AS setID FROM sets WHERE sets.on_off = 0)) WHERE sets.on_off = 0\n</code></pre>\n\n<p>Seems right doesn't it? Update the record <code>current_count</code> with the total number of rows in <code>leads_auto</code> which have the <code>set_id</code> value of the <code>set_id</code> of the <code>sets</code> table where the value of its <code>on_off</code> column is 0. </p>\n\n<p><strong>yet I get this error</strong></p>\n\n<pre><code>#1093 - You can't specify target table 'sets' for update in FROM clause\n</code></pre>\n\n<p>I looked around and someone mentioned that it has to do with the operation being cyclic?</p>\n"},{"tags":["mysql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12760914,"title":"Designing an sql query","body":"<p>Say, I have 3 tables - <code>purchase</code>, <code>image</code>, <code>coupons</code></p>\n\n<p>The fields in <code>purchase</code> table are - <code>purchase_id</code>, <code>image_id</code>, <code>user_id</code>, <code>purchase_time</code>.</p>\n\n<p>The fields in <code>image</code> table are - <code>image_id</code>, <code>image_name</code>, <code>image_caption</code> and other image details.</p>\n\n<p>The fields in <code>coupon</code> table are - <code>image_id</code>, <code>user_id</code> and <code>coupon_id</code>.</p>\n\n<p>[Note: A single <code>purchase_id</code> has unique <code>image_id</code> and <code>user_id</code> (the person who purchased) but for <code>coupon</code> a single <code>image_id</code> can have multiple <code>user_id</code> (many people can generate coupon from the same image). ]</p>\n\n<p>First, I am selecting the list of images -</p>\n\n<pre><code>SELECT p.purchase_id, \n       p.purchase_time, \n       p.user_id, \n       i.image_name, \n       i.image_caption \nFROM purchase p \nLEFT JOIN image i ON p.image_id = i.image_id \nWHERE p.user_id IN ($friends_id_string) \nORDER BY p.purchase_time DESC\n</code></pre>\n\n<p>The <code>friends_id_string</code> is the list of <code>user_id</code> of all friends of a user</p>\n\n<p>Next, I need the <code>coupon_id</code> for every image (the value of which can be <code>NULL</code> as well)</p>\n\n<pre><code>SELECT c.coupon_id \nFROM coupon c \nWHERE c.image_id = $image_id AND c.user_id = $user_id\n</code></pre>\n\n<p>So this query tells me if there is an active <code>coupon_id</code> for that user and that image.</p>\n\n<p>The above queries involve querying on each image separately, which is hammering on the database. Can I join them together?</p>\n"},{"tags":["sql","query","mysql"],"answer_count":6,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":14415,"score":6,"question_id":1259458,"title":"sql pulling a row for next or previous row of a current row","body":"<pre>\nid    |  photo title     |  created_date\n\nXEi43 |  my family       |  2009 08 04\ndDls  |  friends group   |  2009 08 05\n32kJ  |  beautiful place |  2009 08 06\nEOIk  |  working late    |  2009 08 07 \n</pre>\n\n<p>Say I have the id <code>32kJ</code>.  How would I get the next row or the previous one?</p>\n"},{"tags":["query","sqlite","sqlite3","full-outer-join"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12759087,"title":"Full Outer Join in sqlite on 4 tables","body":"<p>I need to join 4 tables based on a common primary key. If sqlite implemented full outer joins it might look something like this (with optimization not taken into account).</p>\n\n<pre><code>SELECT S.pair, C.ball, P.bluejeans, B.checkered FROM Socks S FULL OUTER JOIN Caps C \nFULL OUTER JOIN Pants P FULL OUTER JOIN Boxers B WHERE S.color = C.color AND \nS.color = P.color AND S.color = B.color;\n</code></pre>\n\n<p>I've looked long and hard and the best I found was this 2 table sqlite full join implemented with left joins and union alls:</p>\n\n<pre><code>    SELECT employee.*, department.* FROM   employee LEFT JOIN department ON \nemployee.DepartmentID = department.DepartmentID UNION ALL SELECT employee.*, department.* \nFROM   department LEFT JOIN employee ON employee.DepartmentID = department.DepartmentID \nWHERE  employee.DepartmentID IS NULL;\n</code></pre>\n\n<p>I'm trying to modify this to work for more than 2 tables but I'm new to SQL and I'm not getting too far. Is it possible to get this result in a reasonable amount of time? </p>\n\n<p>I think I have a correct implementation for 3 tables (it might not be correct) but I still can't seem to get it for 4. Here's what I have for 3:</p>\n\n<pre><code>     SELECT S.pair, C.ball, P.bluejeans FROM Socks S LEFT JOIN Caps C LEFT JOIN Pants P \nON C.color = S.color AND P.color = S.color UNION ALL SELECT S.pair, C.ball, P.bluejeans FROM\n Socks S LEFT JOIN Caps C LEFT JOIN Pants P ON S.color = C.color AND S.color = P.color WHERE \nS.color IS NULL;\n</code></pre>\n\n<p>Any help is much appreciated</p>\n"},{"tags":["query","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":899,"score":0,"question_id":2674410,"title":"Is there any way to debug SQL Server 2008 query?","body":"<p>Is there any way to debug a SQL Server 2008 query?</p>\n"},{"tags":["mysql","query","join","syntax","null"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12759600,"title":"MYSQL syntax join not equal","body":"<p>A mysql query is vexing me.  I have some javascript that lets users assign people to a category by moving them back and forth between two buckets (boxes).  The first bucket should be all people except those in second bucket (assigned to category).  The second bucket consists of people in a category.  Therefore, I need a mysql query for the first bucket that pulls all the people except those pulled in the second query (assigned to category). </p>\n\n<p>I have one table of all people and a second of people assigned to categories.  (There is also a third table of categories ignored here.)  The following code returns the selected group for the second bucket (those in the category) but for the first bucket only pulls those already assigned to some category when I want it to include people who do not even appear in the catpeople table.</p>\n\n<p>I think problem has something to do with NULL or my join but cannot figure it out.  Would appreciate any suggestions:</p>\n\n<p>people</p>\n\n<pre><code>id | name\n</code></pre>\n\n<p>catpeople</p>\n\n<pre><code>id | catid | peopleid\n</code></pre>\n\n<p>First query should pull all people except those in second query but it only pulls people who show up in catpeople table. </p>\n\n<pre><code>$sql1 = \"SELECT * FROM `people` c\nLEFT JOIN `catpeople` c \non p.id = c.peopleid\nWHERE catid &lt;&gt; '2'\";\n</code></pre>\n\n<p>Second query works works fine (pulls people in category)</p>\n\n<pre><code>$sql2 = \"SELECT * FROM `people` p\nLEFT JOIN `catpeople` c \non p.id = c.peopleid\nWHERE catid = '2'\";\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12757797,"title":"What time does a SQL query like this one start and end?","body":"<p>I am using a SQL query like:</p>\n\n<pre><code>SELECT * FROM game_list \nWHERE  start_date &lt;= DATE(NOW()) AND end_date &gt;= DATE(NOW())\nORDER BY game_id DESC;\n</code></pre>\n\n<p>Now, what time will this actually start and end? I mean I know on what date but what will the time be, is it midnight, 12 am, pm or what?</p>\n"},{"tags":["java","database","query","servlets"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12759316,"title":"Servlets and JSP blank","body":"<p>hi all I've typed out a page that queries the database then inputs something into the database but when I go to load the servlet/jsp page its comes back blank and am unsure what is happening or why? I'm coding in eclipse and after looking at the console and not getting anything printing out I figured there was something wrong with my code but I cannot see the problem.</p>\n\n<p>Here is my servlet</p>\n\n<pre><code>import java.io.IOException;\nimport java.io.PrintWriter;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport java.util.ArrayList;\n\nimport javax.servlet.RequestDispatcher;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\n\n/**\n * Servlet implementation class TutorAssign\n */\n@WebServlet(\"/TutorAssign\")\npublic class TutorAssign extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public TutorAssign() {\n        super();\n        // TODO Auto-generated constructor stub\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        // TODO Auto-generated method stub\n    }\n\n    private void sendBack(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n         HttpSession session = request.getSession(true);\n            //Set data you want to send back to the request (will be forwarded to the page)\n            //Can set string, int, list, array etc.\n\n         String sql = \"SELECT l.id,s.name,l.day,l.time,l.room\" +\n                  \" FROM subject s, lab l \" +\n                    \" WHERE s.user_id=\"+(Integer)session.getAttribute(\"id\");\n\n          try{\n            Connection con = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/wae\",\"root\",\"\");\n            System.out.println(\"got boobs\");\n            System.out.println(session.getAttribute(\"id\"));\n\n              Statement stmt = con.createStatement();\n              ResultSet res = stmt.executeQuery(sql);\n              System.out.println(res);\n              ArrayList&lt;String&gt; list1 = new ArrayList&lt;String&gt;();\n              ArrayList&lt;String&gt; list2 = new ArrayList&lt;String&gt;();\n              if (res.next()){\n                  do{\n                       list1.add(res.getString(1));\n                       list2.add(res.getString(2)+\" \"+res.getString(3)+\" \"+res.getString(4)+\" \"+res.getString(5));\n\n\n                  }while(res.next());\n              System.out.println(\"Outside\");\n              String[] arr1 = list1.toArray(new String[list1.size()]);\n              String[] arr2 = list2.toArray(new String[list2.size()]);\n              System.out.println(list1);\n              request.setAttribute(\"res1\", arr1);\n              request.setAttribute(\"res2\", arr2);\n\n              }\n\n\n\n          }catch (SQLException e) {\n            } \n            catch (Exception e) {\n            } \n\n\n            //Decides what page to send the request data to\n            RequestDispatcher view = request.getRequestDispatcher(\"TutorAssign.jsp\");\n            //Forward to the page and pass the request and response information\n            view.forward(request, response); \n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n\n          int user_id = Integer.parseInt(request.getParameter(\"id\"));\n          int lab_id = 0;\n\n          String message = null; \n          try {\n              Class.forName(\"com.mysql.jdbc.Driver\");\n              Connection con = \n                DriverManager.getConnection(\"jdbc:mysql://localhost:3306/wae\",\"root\",\"\");\n            System.out.println(\"got connection\"); \n            System.out.println(user_id);\n            Statement s = con.createStatement(); \n\n            String sql = \"INSERT INTO user_lab\" + \n                      \" (user_id, lab_id)\" + \n                      \" VALUES\" + \n                      \" ('\" +  user_id + \"',\" + \n                         \" '\"  +  lab_id + \"')\"; \n\n              System.out.println(sql);\n              int i = s.executeUpdate(sql); \n              if (i==1) {\n                message = \"Successfully assigned a tutor.\"; \n                response.sendRedirect(\"Lecturer_labs\");\n              } \n\n              s.close(); \n              con.close(); \n            } \n            catch (SQLException e) {\n              message = \"Error.\" + e.toString(); \n              boolean error = true; \n            } \n            catch (Exception e) {\n              message = \"Error.\" + e.toString(); \n              boolean error = true; \n            } \n            if (message!=null) {\n              PrintWriter out = response.getWriter(); \n              out.println(\"&lt;B&gt;\" + message + \"&lt;/B&gt;&lt;BR&gt;\"); \n              out.println(\"&lt;HR&gt;&lt;BR&gt;\"); \n            } \n\n          } \n// TODO Auto-generated method stub\n\n\n}\n</code></pre>\n"},{"tags":["mysql","database","query","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":6624263,"title":"mysql DB design and query optimazation","body":"<p>I am working on a project where I need to design a table like directory management. I am just a beginner in DB, so I really need your guys' expertise. my current thought for database design can be illustred as below:</p>\n\n<pre><code> id   name       type        create_time       parent_id\n  1   folder1    folder      2011-2-3             \n  2   folder2    folder      2011-2-3             1\n  3   folder3    folder      2011-2-3             1\n  4   folder4    folder      2011-2-3             1\n  5   file1      file        2011-2-3             4\n  ....\n</code></pre>\n\n<p>as you can see the parent_id is pointing its own table PK id. the constrain complys with the real world like folders can contain folders, files can not has children,etc...</p>\n\n<p>most used query scenario would be:</p>\n\n<ol>\n<li><p>given an id, finds its all subfiles(include folder and file), for each file, indicates whether it has children or not.</p></li>\n<li><p>given an id, finds its all ancestors id(parents, grandparent...)</p></li>\n</ol>\n\n<p>considering a large scale application, questions:</p>\n\n<ol>\n<li>do you think the schema design reasonable? if not,please suggest one.</li>\n<li>for those two scenarios, how can I write robot queries that won't suffer the performance.</li>\n</ol>\n\n<p>thanks for any help.</p>\n"},{"tags":["javascript","jquery","query","date","datetime"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":94,"score":-2,"question_id":12757911,"title":"how to display current month, year in javascript using div","body":"<p>I'm trying to get a jquery or java-script code for displaying the current month and year in a div, but unable so far. I mean I want to display the current month and year in this format:<code>October 2012</code> so that every month I don't need to edit it or anything.</p>\n\n<p>I saw many questions here, but none shows how to display the variable in a div.</p>\n\n<p>Any idea how to accomplish that?</p>\n\n<p>Your help and ideas are much appreciated</p>\n"},{"tags":["sql","sql-server","query","valueconverter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":164,"score":0,"question_id":12757811,"title":"Converting Milliseconds to Days, hours, minutes and seconds","body":"<p>i have a bigint field in Microsoft SQL Server 2008R2 filled with ticks (A single tick represents one hundred nanoseconds or one ten-millionth of a second. There are 10,000 ticks in a millisecond.)</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx</a></p>\n\n<p>and i need to convert the sum of all records to Days:Hours:Minutes:Seconds:Milliseconds. </p>\n\n<p>it works for a single record:</p>\n\n<pre><code>SELECT CONVERT(TIME, DATEADD(ms, duration/10000, 0)) FROM tblMediaFileProperties WHERE FileId = '6C0A849D-95B4-4755-A923-B9DD8F1AF23E'\n</code></pre>\n\n<p>but if a sum it up to all records using: </p>\n\n<pre><code>SELECT CONVERT(TIME, DATEADD(ms, SUM(duration/10000), 0)) FROM tblMediaFileProperties \n</code></pre>\n\n<p>i get a:</p>\n\n<p>Arithmetic overflow error converting expression to data type int.</p>\n\n<p>i know the overflow comes from the CONVERT to Data Type TIME Function...</p>\n\n<p>help's appreciated, thanks!</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":7,"favorite_count":7,"up_vote_count":12,"down_vote_count":0,"view_count":50940,"score":12,"question_id":452464,"title":"How can I get column names from a table?","body":"<p>I need to query the database to get the column/field names, not to be confused with data in the table.  For example, if I have a table named EVENT_LOG that contains eventID, eventType, eventDesc, and eventTime, then I would want to retrieve those field names from the query and nothing else.</p>\n\n<p>Please help?  Thanks in advance.</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12756914,"title":"MySQL Query not displaying correctly","body":"<p>I am having to set up a query that retrieves the last comment made on a customer, if no one has commented on them for more than 4 weeks.  I can make it work using the query below, but for some reason the comment column won't display the latest record.  Instead it displays the oldest, however the date shows the newest.  It may just be because I'm a noob at SQL, but what exactly am I doing wrong here?</p>\n\n<pre><code>SELECT DISTINCT\n    customerid, id, customername, user, MAX(date) AS 'maxdate', comment\nFROM comments\nWHERE customerid IN \n   (SELECT DISTINCT id FROM customers WHERE pastdue='1' AND hubarea='1') \nAND customerid NOT IN \n   (SELECT DISTINCT customerid FROM comments WHERE DATEDIFF(NOW(), date) &lt;= 27)\nGROUP BY customerid\nORDER BY maxdate\n</code></pre>\n\n<p>The first \"WHERE\" clause is just ensuring that it shows only customers from a specific area, and that they are \"past due  enabled\". The second makes sure that the customer has not been commented on within the last 27 days. It's grouped by customerid, because that is the number that is associated with each individual customer. When I get the results, everything is right except for the comment column...any ideas?</p>\n"},{"tags":["query","codeigniter","search","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12756550,"title":"CodeIgniter and query string issue","body":"<p>Im not to good in php and codeigniter gives me maximum. My site is a search engine and after i do a search, url of my site is like this: <strong>mysite.com/?search=eminem&amp;type=mp3</strong> and i don't like it.\nI want to do it so when i type search eminem to give me this url: <strong>mysite.com/eminem/mp3</strong>\nHere is code from CI</p>\n\n<pre><code>&lt;?php\n\nclass Pages extends CI_Controller {\n\n    public function view($page = 'home')\n    {\n        if ( ! file_exists('application/views/pages/'.$page.'.php'))\n    {\n        // Whoops, we don't have a page for that!\n        show_404();\n    }\n\n    $data['title'] = ucfirst($page); // Capitalize the first letter\n    $this-&gt;load-&gt;view('templates/header', $data);\n    $this-&gt;load-&gt;view('pages/'.$page, $data);\n    $this-&gt;load-&gt;view('templates/footer', $data);\n    }\n}\n</code></pre>\n\n<p>what other code do i have to add here to transform the qwery strings to paths?</p>\n\n<p>here is routes.php</p>\n\n<pre><code>$route['default_controller'] = 'pages/view';\n$route['(:any)'] = 'pages/view/$1';\n\n$route['404_override'] = '';\n</code></pre>\n\n<p>Here is my search form from home.php</p>\n\n<pre><code>&lt;form id=\"searchwrapper\" name=\"searchform\"&gt;                                          &lt;input type=\"text\" class=\"searchbox\" id=\"txtSearch\" name=\"search\" /&gt;                                        &lt;input type=\"image\" src=\"../images/empty.png\" class=\"searchbox_submit\"/&gt;                                   \n\n&lt;p id=\"circ\"&gt;\n   &lt;input  type=\"radio\" id=\"mp3\" name=\"type\" checked value=\"mp3\"/&gt;\n   &lt;label class=\"circ-btn normal\" for=\"mp3\"&gt;Mp3&lt;/label&gt;&lt;/p&gt;\n&lt;p id=\"circ\"&gt;                   \n   &lt;input type=\"radio\" id=\"album\" name=\"type\" &lt;?php echo $radio2;?&gt; value=\"album\"/&gt;\n   &lt;label class=\"circ-btn normal\" for=\"album\"&gt;Album&lt;/label&gt;&lt;/p&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>here is .htaccess</p>\n\n<pre><code>&lt;IfModule mod_rewrite.c&gt;\n        RewriteEngine On\n        RewriteBase /ci/\n        #Checks to see if the user is attempting to access a valid file,\n        #such as an image or css document, if this isn't true it sends the\n        #request to index.php\n        RewriteCond %{REQUEST_FILENAME} !-f\n        RewriteCond %{REQUEST_FILENAME} !-d\n        RewriteRule ^(.*)$ index.php?/$1 [L]\n&lt;/IfModule&gt;\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12756309,"title":"mySQL error: You have an error in your SQL syntax (ENGINE=MyISAM)","body":"<p>At the first time I got such error, I realize the problem was similar to this question > <a href=\"http://stackoverflow.com/questions/9680349/error-1064-in-mysql\">Error #1064 in MySQL</a> So I changed the <code>TYPE=MyISAM</code> on my code to <code>ENGINE=MyISAM</code>.</p>\n\n<p>But even after the changing, I encountered similar error. It says, </p>\n\n<p><code>mySQL error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(14),\n                        PRIMARY KEY  (id)\n                    ) ENGINE=M' at line 7</code>.</p>\n\n<p>I thought changing to <code>ENGINE=MyISAM</code> would fix the error, but it doesn't. What should I do?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>  $queries[] = \"CREATE TABLE IF NOT EXISTS {$prefix}conversationlog (\n                    id int(11) NOT NULL auto_increment,\n                    input text default '',\n                    response text default '',\n                    thatresponse text default '',\n                    uid varchar(255) default NULL,\n                    enteredtime timestamp(14),\n                    PRIMARY KEY  (id)\n                ) ENGINE=MyISAM\";\n</code></pre>\n"},{"tags":["mysql","query","subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":12755432,"title":"MySQL - Count Yearly Totals when some Years have nulls","body":"<p>I have 1 table with similar data:</p>\n\n<pre><code>CustomerID | ProjectID | DateListed | DateCompleted\n123456     | 045       | 07-29-2010 | 04-03-2011\n123456     | 123       | 10-12-2011 | 11-30-2011\n123456     | 157       | 12-12-2011 | 02-10-2012\n123456     | 258       | 06-07-2011 | NULL\n</code></pre>\n\n<p>Basically, a customer contacts us, we get a project on our list, and we mark it completed when we're done with it.</p>\n\n<p>What I'm after is a simple (you'd think, at least) count of all projects, with expected output like below:</p>\n\n<pre><code>YEAR | TotalListed | TotalCompleted\n2010 |       1     |        0\n2011 |       3     |        2\n2012 |       0     |        1\n</code></pre>\n\n<p>However, my query below - because of the join - isn't showing 2012's count, because there's been no listed project for 2012.  However, I can't really reverse the query, as then 2010's count wouldn't show up (since nothing was completed in 2010).</p>\n\n<p>I'm open to any suggestions, or tips like how to do this.  I've pondered a temp table, is that the best way to go?  I'm open to anything that gets me what I need!</p>\n\n<p>(If the code looks familiar, ya'll helped me get the subquery made! <a href=\"http://stackoverflow.com/questions/6062975/mysql-subquery-with-main-query-data-variable\">MySQL Subquery with main query data variable</a>)</p>\n\n<pre><code>SELECT YEAR(p1.DateListed) AS YearListed, COUNT(p1.ProjectID) As Listed, PreQuery.Completed  \nFROM(\n    SELECT YEAR(DateCompleted) AS YearCompleted, COUNT(ProjectID) AS Completed \n    FROM projects \n    WHERE CustomerID = 123456 AND DateListed &gt;= DATE_SUB(Now(), INTERVAL 5 YEAR) \n    GROUP BY YEAR(DateCompleted)\n) PreQuery \nRIGHT OUTER JOIN projects p1 ON PreQuery.YearCompleted = YEAR(p1.DateListed)\nWHERE CustomerID = 123456 AND DateListed &gt;= DATE_SUB(Now(), INTERVAL 5 YEAR)\nGROUP BY YearListed \nORDER BY p1.DateListed\n</code></pre>\n"}]}
{"total":20740,"page":15,"pagesize":100,"questions":[{"tags":["sql","query","postgresql","query-plans"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12752109,"title":"how to make join table update efficient in sql (it's efficient from my ruby code!!)","body":"<p>This is something weird I can't really understand, I'm working in PostGreSql9.2 ...</p>\n\n<p>I have this database:</p>\n\n<pre><code>movies (id, title, votes)\ninfos (id, movie_id, info_type, value)\n</code></pre>\n\n<p>I want to update movies.votes with infos.value, joining on movies.id = infos.movie_if and only where info_type = 100 (which is the type for votes..)</p>\n\n<p>I tried 2 different queries:</p>\n\n<pre><code>update movies\nset votes = cast(i.value as integer)\nfrom movies m inner join infos i on m.id = i.movie_id\nwhere i.info_type = 100\n</code></pre>\n\n<p>which (using explain) predicts a running time of about 11 million seconds (too much!)</p>\n\n<p>second try:</p>\n\n<pre><code>update movies m\nset votes = cast(\n(\n  select value\n  from infos i\n  where i.info_type = 100 and i.movie_id = m.id\n  limit 1\n) AS integer);\n</code></pre>\n\n<p>this one whould be \"only\" 20 thousands seconds.. still far too much</p>\n\n<p>I don't really know how the query plan work, so I tries to do this with a ruby script (using active_record)... which is:</p>\n\n<pre><code>Info.find_in_batches(:conditions =&gt; \"info_type = 100\") do |group|\n    group.each{ |info|\n        movie = Movie.find(info.movie_id)\n        movie.votes = info.value.to_i\n        movie.save\n    }\nend\n</code></pre>\n\n<p>For those of you who don't read ruby, this query simply loops thru all infos that meet the info_type = 100 condition, then for each one it searches the corresponding movie and updates it..</p>\n\n<p>And it was very fast! just a few minutes, and with all the ruby/orm overhead!!</p>\n\n<p>Now, why?? Know that movies is about 600k records, but only 200k (a third) have an info record with the number of votes. Still this doesn't explain what is happening.</p>\n"},{"tags":["query","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12737940,"title":"Match Dates and Count in Entity Framework","body":"<p>I have two tables:</p>\n\n<pre><code>create table dbo.Dates (\n  Id int not null\n    constraint Dates_Id_PK primary key clustered (Id),\n  [DateValue] date not null\n}\n\ncreate table dbo.Posts (\n  Id int identity not null \n    constraint Posts_Id_PK primary key clustered (Id),\n  Created datetime not null,\n  Title nvarchar (200) not null\n)\n</code></pre>\n\n<p>For these tables I have Date and Post entities.</p>\n\n<p>How can I get a table that has the column DateValue from Dates and the number of Posts with that date.</p>\n\n<p>I need to match the datetime Created value to the date DateValue.</p>\n\n<p>Thank you,</p>\n\n<p>Miguel</p>\n"},{"tags":["mysql","database","query","mysql5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12732816,"title":"Finding Duplicates Of Table data : Optimized Way?","body":"<p>I have a main table with 80lacs record (say TABLE : MAIN_TABLE)\nI want to fire many queries in which i need to find all records matching approx 10 criteria that are register in 6 months(11 lacs)</p>\n\n<p>I have created a composite index on 2 column (col1 , col2) , however still queries is talking time in executing approx 30-50 seconds.</p>\n\n<p>there are approx 12 index on this table and approx 60columns.\nwhen i use explain , it shows 5102 rows will be examined and its using index.</p>\n\n<p>Solution I use :  i decide to create a trigger which will insert into this a new table(MAIN_TABLE_ACTIVE) with only one index and last 6 months records and limited columns(12)\nwhen i fire query on this tables results are coming in order of 2-6 seconds.</p>\n\n<p>Question : is this best approach as i use table of 11lacs instead of 80lacs ?</p>\n\n<p>Drawbacks : overhead for triggeer :-(</p>\n\n<p>suggest any new approach or please comment on my approach of this problem.</p>\n"},{"tags":["sql","query","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12749604,"title":"Oracle SQL *plus EXCEPT ORA-00907: missing right parenthesis","body":"<p>i wrote this query, but it gives me an error:</p>\n\n<pre><code>select c.sid\nfrom catalog c\nwhere exists ((select p.color from parts p)\nexcept (select p2.color from parts p2 where p2.color != 'Red'));\n</code></pre>\n\n<p>ORA-00907: missing right parenthesis</p>\n\n<p>can you tell me where is incorrect?</p>\n\n<p>catalog:   </p>\n\n<pre><code>   SID        PID       COST\n</code></pre>\n\n<hr>\n\n<pre><code>     1          3         .5\n     1          4         .5\n     1          8       11.7\n     2          3        .55\n     2          8       7.95\n     2          1       16.5\n     3          8       12.5\n     3          9          1\n     4          5        2.2\n     4          6 1247548.23\n     4          7 1247548.23\n</code></pre>\n\n<p>parts:        </p>\n\n<pre><code>   PID PNAME                               COLOR\n</code></pre>\n\n<hr>\n\n<pre><code>     1 Left Handed Bacon Stretcher Cover   Red\n     2 Smoke Shifter End                   Black\n     3 Acme Widget Washer                  Red\n     4 Acme Widget Washer                  Silver\n     5 I Brake for Crop Circles Sticker    Translucent\n     6 Anti-Gravity Turbine Generator      Cyan\n     7 Anti-Gravity Turbine Generator      Magenta\n     8 Fire Hydrant Cap                    Red\n     9 7 Segment Display                   Green\n</code></pre>\n"},{"tags":["osx","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12748470,"title":"Excel query to modify layout of records (Excel on a mac)","body":"<p>I have an excel document with 5 columns and 3,000+ records. Each set of useable data is broken up into 9 rows. So, consistently, every 9 rows is one data block pertaining to one client. How in the world can I convert this Excel document to combine each 9 records to only one record (row) for each client?</p>\n\n<p>I hope this makes sense! Any direction on how I can go about this?</p>\n"},{"tags":["mysql","sql","database","oracle","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12729260,"title":"Sql query to join two table for the final output","body":"<p>Below are the two tables, customer and department. I am struggling very hard to get the output.</p>\n\n<p>I want to write the query which shows only the department name which have maximum number of employees.</p>\n\n<p><img src=\"http://i.stack.imgur.com/kF2wQ.jpg\" alt=\"enter image description here\"></p>\n\n<p>Answer should be like this ...</p>\n\n<p><img src=\"http://i.stack.imgur.com/FMIeo.jpg\" alt=\"enter image description here\"></p>\n\n<p>Please help me to write the query.</p>\n"},{"tags":["java","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12310023,"title":"Select data from two tables using SQL","body":"<p>I have two tables linked by another table like this:</p>\n\n<pre><code>ROLES(RoleID, RoleName)\nEMPLOYEES(EmployeeID, E_Name, Address)\nROLE_EMPLOYEES(RoleID#,EmployeeID#).\n</code></pre>\n\n<p>I want a query that retrieves all from EMPLOYEES and RoleID from ROLES and displays on Java form.</p>\n\n<p>I have tried this but does not work:</p>\n\n<pre><code>rs=st.executeQuery(\"SELECT EMPLOYEES.*, ROLES.* FROM EMPLOYEES JOIN ROLES\");               \n\nwhile(rs.next()){\n    //MOVE THE CURSOR TO THE FIRST RECORD AND GET DATA\n    int employeeid=rs.getInt(\"EmployeeID\");\n    String id=Integer.toString(employeeid);\n    String name=rs.getString(\"E_Name\");\n    String addr=rs.getString(\"Address\");\n    String s = rs.getString(\"RoleID\");\n    jComboBox1.addItem(s.trim());\n\n    //DISPLAY THE FIRST RECORD IN THE TEXT FIELD\n    txtEmpNumber.setText(id);\n    txtEmpName.setText(name);\n    txtEmpAddress.setText(addr);\n    jComboBox1.setSelectedItem(s);\n}\n</code></pre>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":135,"score":4,"question_id":11421577,"title":"getting questions and answers in 1 single query","body":"<p>I need to make a query that fetches all the users questions and for every question, 3 answers from the database. This query needs to be as efficient as possible.</p>\n\n<p>I have the tables:</p>\n\n<pre><code>questions:\n  id\n  user_id\n  title\n  date_created\n  date_updated\n\nanswers:\n  id\n  question_id\n  user_id\n  body\n  date_created\n</code></pre>\n\n<p>Can I do it in 1 single query? Basically I need to display the question, to make a join with users table to get the username, display 3 answers for the question and show for each answer the username of the poster.</p>\n\n<p>What I dit is something like this:</p>\n\n<pre><code>SELECT questions.*, GROUP_CONCAT(answers.id) as answers \n  FROM (questions) \n  JOIN users ON users.id = questions.user_id \n  LEFT JOIN answers ON answers.question_id = questions.id \n WHERE questions.user_id = '1' \n GROUP BY questions.id \n ORDER BY questions.date_updated desc \n LIMIT 3\n</code></pre>\n\n<p>But this is not finished and also is not working well.</p>\n"},{"tags":["facebook","query","api","events","search"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":1834,"score":2,"question_id":7199498,"title":"facebook graph api - search event","body":"<p>In the event search, the query searches only by the Event Name:\nsample <a href=\"http://graph.facebook.com/search?q=party&amp;type=event\" rel=\"nofollow\">http://graph.facebook.com/search?q=party&amp;type=event</a></p>\n\n<ul>\n<li>Is there a way to query the Event Description? Or other fields ?</li>\n</ul>\n\n<p>I tried to use until or since, but i get the same results\n<a href=\"https://graph.facebook.com/search?q=party&amp;type=event&amp;until=today\" rel=\"nofollow\">https://graph.facebook.com/search?q=party&amp;type=event&amp;until=today</a>\nhttps://graph.facebook.com/search?q=party&amp;type=event&amp;until=yesterday</p>\n\n<ul>\n<li>FQL only accept search by event ID</li>\n</ul>\n"},{"tags":["c#","mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12749760,"title":"Separate Text Field into new rows","body":"<p>I'm running a query against a remote MySql server. It basically includes a field that is semi structured (Text field).\nEach value is on a new line:</p>\n\n<pre><code>uVal = 'Marvin'\nuConfigPath = .F.\n</code></pre>\n\n<p>Etc etc</p>\n\n<p>I want to be able to query the values and add a new column in my returned adaptor per item name, i.e.: <code>uVal</code> would be added as a colum and so would <code>uConfigPath</code>, but I'm failing badly. The query runs fine to select the rows I want but I cannot figure this out.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12748256,"title":"SQL nested query issue","body":"<p>I have a database with the Table MESSAGE and it contains all of my messages.\nI need to find all the last conversation messages.</p>\n\n<p>The table contains the following fields:\nId (int)\nFrom (int)\nTo (int)\nDate (date)\nMessage (varchar)</p>\n\n<p>I need to find a query that returns me all of the last messages.\nFor example:</p>\n\n<pre><code>1 -&gt; 3 : This is a first message; yesterday\n3 -&gt; 1 : This is the last one; today\n1 -&gt; 2 : Another message with 1 and 2; some time\n3 -&gt; 5 : Some message i don't need; some time\n</code></pre>\n\n<p>I need to find:</p>\n\n<pre><code>\"3 -&gt; 1 : This is the last one; today\"\n\"1 -&gt; 2 : Another message with 1 and 2; some time\"\n</code></pre>\n\n<p>I hope it's clear what I mean...\nI can already find the users i have a conversation with, with this query:</p>\n\n<p>in this example the user has Id = 47</p>\n\n<pre><code>select distinct m.To from MESSAGE m Where m.From = 47 union select distinct m2.from From MESSAGE m2 where m2.To = 47\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["php","query","mysqli","multiple","results"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12748780,"title":"mysqli multiple query","body":"<p>I do following:</p>\n\n<pre><code>$query .=\" SELECT * , COUNT(PRESENT) FROM seventh_a\";\n$query .=\" WHERE class ='0' AND NAME ='Alexander Kirkby Scherer'\";\n$query .=\" AND PRESENT = 'TS' GROUP BY lesson\";\n\n$query = \" SELECT * , COUNT(lesson) FROM seventh_a\";\n$query .=\" WHERE class ='0' AND NAME ='Alexander Kirkby Scherer'\";\n$query .=\" GROUP BY lesson\";\n</code></pre>\n\n<p>After that I can echo out $row['COUNT(PRESENT)'] but not $row['COUNT(lesson)'];</p>\n\n<p>Can anybody tell me what to do to get borth values, so that i am able to work with them?</p>\n"},{"tags":["mysql","sql","query","join","mysql-slow-query-log"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12748302,"title":"Mysql query severe slow down with joins","body":"<p>have a table with approx 20,000 rows. Everything works fine but one of the queries in it has slowed down to about 5+ seconds. All of the tables have primary keys and their related indexes. There are also foreign keys and their related indexes. I have tried adding new indexes and trimming back the query bit by bit but it does not make a huge difference. I removed the order by too, that does indeed help but only so much. I was wondering if I could get a fresh pair of eyes to see if I'm missing something here.</p>\n\n<pre><code>SELECT DISTINCT \nt1.my_key,\nt2.some_name,\nt3.the_weather,\nt4.another_value,\nt5.hello_world,\nt6.last_one\nFROM\ntable_1 AS t1\nINNER JOIN table_2 AS t2 \n  ON t1.t2_id_fk = t2.t2_id_pk \nINNER JOIN table_3 AS t3 \n  ON t1.t3_id_fk = t3.t3_id_pk\nINNER JOIN table_4 as t4\n  ON t1.t4_id_fk = t4.t4_id_pk \nLEFT JOIN table_5 AS t5 \n  ON t1.t5_id_fk = t5.t5_id_pk\nLEFT JOIN table_6 AS t6 \n  ON t1.t6_id_fk = t6.t6_id_pk\nLEFT JOIN (\n  table_7 AS t7\n  INNER JOIN table_8 AS t8\n    ON (t7.t8_id_fk = t8.t8_id_pk)\n           ) \n ON (t1.t1_id_pk = t7.t1_id_fk)  \n</code></pre>\n\n<p>I wonder what is causing the using_temporary especially when I have indexes defined for them all. For some reason when I run an explain it all looks good with only 1 row needed to be searched for each except for the first joined value from table 2. In this case it returns a using_temporary and needs to search almost 3000 rows each time.</p>\n\n<p>Update\nI added a unique index to table_1 made up of the keys from the other joining tables in the same ordering. Explain tells me that this reduces the amount of rows to be searched from 3000 to 294 but the query execution time is still excessive. Its unusual now I must say.</p>\n"},{"tags":["ruby-on-rails","ruby","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12747811,"title":"Selecting distinct through join","body":"<p>We have 2 tables: users and statuses</p>\n\n<p>The status table has a user_id, status and occured_on. The status is either 'removed' or 'added' and occured_on is the date the user was removed or added.</p>\n\n<p>I need the current added users. That is, all the (distinct) users whose newest status record is 'added'.</p>\n\n<p>I'm using Rails, and have tried:</p>\n\n<pre><code>User\n  .joins(:statuses)\n  .where('statuses.status = ?', 'added')\n  .order('statuses.occured_on DESC')\n  .uniq\n</code></pre>\n\n<p>Which translates to the SQL:</p>\n\n<pre><code>SELECT DISTINCT users.* \nFROM users\nINNER JOIN statuses\nON statuses.user_id = users.id \nWHERE statuses.status = 'added' \nORDER BY statuses.occured_on DESC\n</code></pre>\n\n<p>That gives me the error:</p>\n\n<pre><code>PG::Error: ERROR:  for SELECT DISTINCT, ORDER BY expressions must appear in select list\n   LINE 1: ...statuses.status = 'added') ORDER BY statuses.oc...\n</code></pre>\n\n<p>I'd be happy knowing either the Rails code that would work or the straight SQL.</p>\n\n<p>Also, I'd prefer no sub-selects if possible.</p>\n"},{"tags":["sql","oracle","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":95,"score":-1,"question_id":12740485,"title":"Usage of \"AND\" and \"OR\" in SQL queries","body":"<p>I have a the following tables</p>\n\n<ul>\n<li>students(sid, sname, age) </li>\n<li>course(cid, cname, duration) </li>\n<li>enroll(sid, cid, date) </li>\n</ul>\n\n<p>Find sids of students who have taken java <strong>or</strong> rdbms</p>\n\n<pre><code>select sid \nfrom enroll e, \n     course c \nwhere (c.cname like 'java' and c.cid=e.cid) \n   or (c.cname like 'rdbms' and c.cid=e.cid);\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>select sid \nfrom enroll e, \n     course c \nwhere cname like 'java' and c.cid=e.cid\nunion \nselect sid \nfrom enroll e, \n     course c \nwhere cname like 'rdbms' and c.cid=e.cid;\n</code></pre>\n\n<p>2nd alternative:</p>\n\n<pre><code>select sid \nfrom enroll \nwhere cid in (select cid \n              from course \n              where cname like 'java' \n                 or cname like 'rdbms');\n</code></pre>\n\n<p>All the above queires get me the expected results. </p>\n\n<p>To find  sids of students who have taken java <strong>and</strong> rdbms, I just modified all the 3 but 1st and 3rd queries below don't work.</p>\n\n<pre><code>select sid \nfrom enroll e, \n     course c \nwhere (c.cname like 'java' and c.cid=e.cid) \n  and (c.cname like 'rdbms' and c.cid=e.cid);\n</code></pre>\n\n<p>Alternative:</p>\n\n<pre><code>select sid \nfrom enroll e, \n     course c \nwhere cname like 'java' and c.cid=e.cid\nintersect \nselect sid \nfrom enroll e, \n     course c \nwhere cname like 'rdbms' and c.cid=e.cid;\n</code></pre>\n\n<p>2nd alternative:</p>\n\n<pre><code>select sid \nfrom enroll \nwhere cid in (select cid \n              from course \n              where cname like 'java' and cname like 'rdbms');\n</code></pre>\n"},{"tags":["query","google-app-engine","datastore"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12747321,"title":"appengine: How to query entities by key, in entities with ancester?","body":"<p>I have a problem with my app on Google AppEngine, especially with the datastore.\nThe story is a bit long. My data model looks like this:</p>\n\n<ol>\n<li>Users can create entities. Each entity has the following properties:\n#1). the auto generated key. #2). The creator. #3). A number.</li>\n<li>In the app, I'm doing the following queries:\na). Query entities by creator (#2). b). Query entities by the number property (#3). c). Query the entity by id(#1).</li>\n</ol>\n\n<p>I'm using the low level datastore API. Now, here are several problematic approaches I have tried:</p>\n\n<p>[Approach 1]: With the Datastore, if I make the entities parentless (no ancester), then things are good, especially the query 'c' can be easily achieved by Datastore.get(k). </p>\n\n<p>Problem of Approach1: Since the datastore is \"eventually consistent\", for query 'a' the result is ALWAYS not update to date. If a user creates an entity, then lists all entities he creates, the newly created one is always missing. It only appears by refresh in a few seconds later...Tried using memcache, does not help the case (or I'm not finding a good way?).</p>\n\n<p>To overcome the problem above, I changed the data structure. Here's [Approach 2]: when creating each entity, create a key based on the creator, and put the new entity as child of the key. So all entities created by a user are entities with an ancester. Thus query 'a' works in a timely manner, and query 'b' also seems to work. </p>\n\n<p>The new problem of Approach2: For query 'c', it always returns nothing. Here's my query 'c'. Both of them can not find the entity, always:</p>\n\n<p>method 1:<br>\n    Entity en = datastore.get(k)</p>\n\n<p>method2: </p>\n\n<pre><code>DatastoreService ds = DatastoreServiceFactory.getDatastoreService();\nQuery q = new Query(kind)\n    .setFilter(FilterOperator.EQUAL.of(Entity.KEY_RESERVED_PROPERTY, k));\nEntity en = ds.prepare(q).asSingleEntity();\n</code></pre>\n\n<p>Another try: Approach3:\nGroup all entities under one ancestor. This overcomes the problem in Approach1, and can be queried with an ancestor filter so it's ok to retrieve the result. </p>\n\n<p>Problem of Approach3: Such structure groups all entities as one entity group. Per Google datastore specification, write operation can happen 5 times at the most per second. This is a limit I'd not want to hit...</p>\n\n<p>I think this kind of data model is really common. Is there a proper way to structure the data? Any help is appreciated. Thanks...</p>\n"},{"tags":["mysql","database","query","sql-order-by","limit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12709499,"title":"MySQL query specific order by and limit","body":"<p>Suppose I have the following table structure:</p>\n\n<pre><code>Field1 Field2 Field3\nval1   valb_1 date\nval1   valb_2 date\nval1   valb_3 date\nval2   valb_4 date\nval3   valb_5 date\n</code></pre>\n\n<p>How would I limit for a maximum of 5 different values in Field1 in which the fields might be filled with the exact same value as the example suggest with \"val1\" , and a maximum of 200 values in Field2 in which the fields have always a different value. ordering by date desc.</p>\n\n<p>Also how to make it as equivalent as possible for the limit of 5 for Field1, example for the 200 limit : 50 belong to val1, 100 to val2, and 100 to val3 of field1, that is 250, there were 100 in val 2 and 100 in val 3, ideally the 200 limit would be a selection of 50 in val1 and 75 in each of val 2 and 3.</p>\n"},{"tags":["sql","database","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12746886,"title":"SQLite Update Method Not Failing for Invalid datatype","body":"<p>I'm having a strange problem with an SQLite Database, specifically with data validation on an UPDATE query. So let me begin, if i use the following query, i get a 'datatype mismatch' error when i try to run it. This is correct and expected because the field type is marked as an integer.</p>\n\n<pre><code>INSERT OR REPLACE INTO Table ('Column') VALUES ('shouldFail')\n</code></pre>\n\n<p>However, one would also expect that the following UPDATE query should return the same 'datatype mismatch' error, but it doesn't. I can run the following query perfectly fine, which allows me to end up with a 'String' data type in a column which is marked as INTEGER only...</p>\n\n<pre><code>UPDATE Table SET 'Column'='shouldFail' WHERE SecondColumn = 'Some value'\n</code></pre>\n\n<p>So can anyone tell me why the SQL datatype validation is working on the first query, but not on the second?</p>\n\n<p>Many Thanks\nSam</p>\n"},{"tags":["sql","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12746790,"title":"Update statement clarification","body":"<p>I'm extremely new to \"updating\" databases as I've only ever wrote queries as select statements.</p>\n\n<p>I have a record i need to delete or change from the database.  How would I go about doing that?  Lets take updating a column first.</p>\n\n<p>I want to update the \"Customer\" table and the \"SNumber\" column where the \"TicketNum\" Column is \"123\" Right now \"SNumber\" for that record is blank, and i'd like it to be \"115\"</p>\n\n<p>I was thinking: </p>\n\n<pre><code>update Customer\nset snumber = '115'\nwhere ticketnum = '123'\n</code></pre>\n\n<p>Obviously I do not want to run this query with fear of messing up the database.</p>\n\n<p>The second part of this is how would I delete the record all together?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12745774,"title":"Is it possible to add list of objects into embedded array document in mongo document?","body":"<p>I am having the mongo document as below:</p>\n\n<pre><code>  {\n  \"_id\" : ObjectId(\"506e9e54a4e8f51423679428\"),\n  \"description\" : \"ffffffffffffffff\", \n  \"menus\" : [  \n            {   \n              \"_id\" : ObjectId(\"506e9e5aa4e8f51423679429\"),     \n               \"description\" : \"ffffffffffffffffffff\",  \n                  \"items\" : [\n                           {    \n                          \"name\" : \"xcvxc\",     \n                          \"description\" : \"vxvxcvxc\",   \n                          \"text\" : \"vxcvxcvx\",  \n                          \"menuKey\" : \"0\",  \n                           \"onSelect\" : \"1\",    \n                          \"_id\" : ObjectId(\"506e9f07a4e8f5142367942f\") \n                          } ,\n                          {     \n                          \"name\" : \"abcd\",  \n                          \"description\" : \"qqq\",    \n                          \"text\" : \"qqq\",   \n                          \"menuKey\" : \"0\",  \n                           \"onSelect\" : \"3\",    \n                          \"_id\" : ObjectId(\"507e9f07a4e8f5142367942f\") \n                          }\n                         ] \n             }\n         ]\n  }\n</code></pre>\n\n<p>Now i want to change this to :</p>\n\n<pre><code>       {\n        \"_id\" : ObjectId(\"506e9e54a4e8f51423679428\"),\n        \"description\" : \"ffffffffffffffff\", \n        \"menus\" : [ \n            {   \n              \"_id\" : ObjectId(\"506e9e5aa4e8f51423679429\"),     \n               \"description\" : \"ffffffffffffffffffff\",  \n                  \"items\" : {\n                           {    \n                          \"name\" : \"xcvxc\",     \n                          \"description\" : \"vxvxcvxc\",   \n                          \"text\" : \"vxcvxcvx\",  \n                          \"menuKey\" : \"0\",  \n                           \"onSelect\" : \"1\",    \n                          \"_id\" : ObjectId(\"506e9f07a4e8f5142367942f\") \n                          } ,\n                          {     \n                          \"name\" : \"abcd\",  \n                          \"description\" : \"qqq\",    \n                          \"text\" : \"qqq\",   \n                          \"menuKey\" : \"0\",  \n                           \"onSelect\" : \"3\",    \n                          \"_id\" : ObjectId(\"507e9f07a4e8f5142367942f\") \n                          }\n                       } \n             }\n\n           ]\n\n   }\n</code></pre>\n\n<p>Is this possible in mongo?  In the first schema, updating is not possible atomically becoz we can't use two \"$\"  while updating deep layer. So i thought to change schema as same as second one, how can i achieve it?</p>\n\n<p>For first one i have used \"$push\" for adding <strong>items</strong> inside <strong>menus</strong>...</p>\n\n<p>Any help would be great..</p>\n"},{"tags":["ruby-on-rails","query","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12723811,"title":"How to calculate the max of the sums in Rails?","body":"<p>I've a set of Age Ranges, for which i'm calculating both a count and a total.</p>\n\n<p>On top of that i would like to calculate the max of these counts/sums...</p>\n\n<p>In sql it would be something with the same form as:</p>\n\n<pre><code>select max(stotal) from (select age, sum(total) as stotal from users inner join receipts on receipts.user_id = user.id group by users.age)\n</code></pre>\n\n<p>My method to get the group by is the following</p>\n\n<pre><code>def self.group_by_ageRange(user, begin_date=nil, end_date=nil, gender=nil)\n\n  min   = nil\n  max   = nil\n  now = Time.now\n  cases = AGE_RANGES.map do |r|\n\n      maxdate = now.years_ago(r[:min]).to_date\n      mindate = now.years_ago(r[:max]).to_date\n      max = [maxdate, max || maxdate].max\n      min = [mindate, min || mindate].min\n\n      \"when users_tags.birthdate between '#{mindate}' and '#{maxdate}' then '#{r[:min]} - #{r[:max]}'\"\n  end\n  query = User.joins(shops: {receipts: {tag: :user}})\n                .select(\"shops.name, \n                        count(*) as number_of_receipts,\n                        case #{cases.join(' ')} end as age_range, \n                          sum(total) as total\")\n                .where(\"users.id= :user_id \", user_id: user)\n                .where(\"users_tags.birthdate\" =&gt; min .. max)\n                .group(\"shops.name,age_range\")\n\n    if !(begin_date.blank? || end_date.blank?)\n     query = query.where('receipts.created_at between :begin_date and :end_date', :begin_date =&gt; begin_date, :end_date =&gt; end_date)\n      #query = query.where(created_at: begin_date .. end_date)\n    elsif(!begin_date.blank?)\n      query = query.where('receipts.created_at &gt;= :begin_date', :begin_date =&gt; begin_date)\n    elsif(!end_date.blank?)\n      query = query.where('receipts.created_at &lt;= :end_date', :end_date =&gt; end_date)\n    end\n\n    if !gender.nil?\n      query=query.where('users_tags.gender= ?', gender)\n    end\n\n    query.all\n\n\n  end\n</code></pre>\n\n<p>How can i calculate the max total or nr_of_receipts on top of this?</p>\n\n<p>Is there any \"clean\" way to do this, like : \n<code>group_by_ageRange(user, begin_date, end_date).max(\"total\")</code></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>In the meanwhile, i did this using SQL, but would still like to know if there is a better way to do it..Any suggestions? How do I replace that huge SQL monster inside the from?</p>\n\n<pre><code>def self.max_group_by_ageRange(user, dim, begin_date=nil, end_date=nil)\n\n    min   = nil\n    max   = nil\n    now = Time.now\n    cases = AGE_RANGES.map do |r|\n\n        maxdate = now.years_ago(r[:min]).to_date\n        mindate = now.years_ago(r[:max]).to_date\n        max = [maxdate, max || maxdate].max\n        min = [mindate, min || mindate].min\n\n        \"when users_tags.birthdate between '#{mindate}' and '#{maxdate}' then '#{r[:min]} - #{r[:max]}'\"\n    end                 \n    query= select(\"max(#{dim == :count ? \"number_of_receipts\" : \"total\"}) as maxim\")\n    .from(\"(Select count(*) as number_of_receipts,\n         case #{cases.join(' ')} end as age_range, \n         sum(total) as total\n         from users\n         inner join user_shops \n                on users.id=user_shops.user_id\n                and users.id = #{user.id}\n          inner join shops on shops.id=user_shops.shop_id\n          inner join receipts on receipts.shop_id= shops.id\n          inner join tags on tags.id=receipts.tag_id\n          inner join users as users_tags on users_tags.id = tags.user_id\n          where users_tags.birthdate BETWEEN  '#{min}' and '#{max}'\n          group by shops.name,age_range, users_tags.gender )\")\n\n      query.first.maxim\n\n\n  end\n</code></pre>\n"},{"tags":["sql","query","postgresql","sqlalchemy"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":12734486,"title":"How to order these SQL results in a certain way?","body":"<p>I'm making a sort of calendar of events app. There are 2 types of events shown on the users home page:</p>\n\n<ol>\n<li>nearby event - those with a schedule date within the next 3 days, or within the past 1 hour.</li>\n<li>normal event - those with either no schedule date, or a schedule date further than 3 days in the future.</li>\n</ol>\n\n<p>This is the <strong>events</strong> table: <code>id, user_id, content, occurs_at, created_at</code></p>\n\n<p>Currently, I'm showing these events ordered by date created to show the newly added stuff first. </p>\n\n<p>What I want is to show all nearby events first and have them ordered by schedule date, then show the normal events and have them ordered by date created. I think it makes for a better user experience, but I don't know how to go about it.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Ended up going with this query, which is a combination of a couple of answers.</p>\n\n<p><code>ORDER BY COALESCE(occurs_at &gt; :min_time AND occurs_at &lt; :max_time, 0) DESC, occurs_at ASC, created_at DESC</code></p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12745660,"title":"Removing union from mysql query to get 2 row output in a single row","body":"<p>Here is mysql query</p>\n\n<pre><code>SELECT CallDate,SUM(Hour0) AS FailedCalls FROM call_status WHERE CallDate='2012-09-14' AND CallStatusId NOT IN (42,52)\n\nUNION\n\nSELECT CallDate,SUM(Hour0) AS SuccessCalls FROM call_status WHERE CallDate='2012-09-14' AND CallStatusId IN (42,52);\n</code></pre>\n\n<p>Here is the output\n<img src=\"http://i.stack.imgur.com/Ii3pP.png\" alt=\"enter image description here\"></p>\n\n<p>Sorry for the small image.\nAs you can see i have selected Failed Calls from above query and SuccessCalls using second query.But what i want is CallDate,FailedCalls,SuccessCalls in a single row.</p>\n\n<p><em><strong>Update:</em></strong>\nHere is the correct query:</p>\n\n<pre><code>SELECT CallDate,\nSUM(CASE WHEN (CallStatusId NOT IN(42,52)) THEN Hour0\nELSE 0 \nEND) AS FailedCalls,\nSUM(CASE WHEN (CallStatusId IN (42,52)) THEN Hour0\nELSE 0\nEND) AS SuccessCalls\nFROM call_status\nWHERE CallDate='2012-09-14';\n</code></pre>\n"},{"tags":["query","plugins","entity","record","crm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12744967,"title":"CRM 2011 - Find a record by a field's value in C#","body":"<p>I have a basic problem. I need to find the guid of a record with a field set to a specific value.\nLike finding the only record with its \"favouritecolor\" attribute set to \"red\". (the field is unique, no double same colors)</p>\n\n<p>The record I'll be searching is not of the entity type that the plug-in works on.</p>\n\n<p>I've looked for this everywhere, but only found lots of tutorials about getting the Guid of a record that was just created, which doesn't help me much. Should a standard sqlconnection and select statement be used (like select guid from [table name] where favouritecolor = 'red'), or is there a more beautiful way?</p>\n\n<p>I'll appreciate any kind of guidance.</p>\n\n<p>Cheers!</p>\n"},{"tags":["php","mysql","query","insert","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12744953,"title":"mysqli returns true for INSERT query, row not inserted","body":"<pre><code> if ($word != '' &amp;&amp; $text != '') {\n    $result = $conn-&gt;query(\"SELECT * FROM variables WHERE `word` = '$word'\");\n    if ($source = $result-&gt;fetch_assoc()) {\n        $conn-&gt;query(\"UPDATE variables SET `text` = '$text' WHERE `word` = '$word'\");\n        echo 0;\n    } else {\n        if ($result = $conn-&gt;query(\"INSERT INTO variables (`word`, `text`) VALUES ('$word', '$text')\"))\n            echo 1;\n    }\n}\n</code></pre>\n\n<p>The above is the INSERT code (and update) the UPDATE code works fine, however when the INSERT query is called the query returns <code>true</code> but when i check the data, it hasn't been inserted. </p>\n\n<p>Any help is appreciated, thanks in advance.</p>\n\n<p>EDIT:</p>\n\n<p>variables table structure:</p>\n\n<pre><code>`word` varchar(100) NOT NULL, //also PRIMARY KEY\n`text` text NOT NULL\n</code></pre>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12744007,"title":"How to giving array result in relation table on mysql","body":"<p>i'm having problem when i want to select data from database.</p>\n\n<p>this is my query </p>\n\n<pre><code>SELECT J.id as id_job, J.title as job_title, J.companies_id, C.name as company_name,J.created_at, L.name as Location,CL.postal_code, CL.address\n                                FROM jobs J\n                                INNER JOIN bla1 C ON ( C.id = J.company_id )\n                                INNER JOIN bla2 CL ON ( CL.id = J.company_location_id )\n                                INNER JOIN bla3 L ON ( L.id = CL.location_id )\n                                WHERE J.status =1\n                                AND C.status =2\n                                And CL.status = 1\n                                AND L.status = 1\n                                ORDER BY J.created_at DESC\n                                LIMIT 0 , 30\n</code></pre>\n\n<p>and this is the result of that query using <code>var_dump()</code></p>\n\n<pre><code>[\"_result\":protected]=&gt;\n  array(15) {\n    [0]=&gt;\n    array(8) {\n      [\"id_job\"]=&gt;\n      string(2) \"27\"\n      [\"job_title\"]=&gt;\n      string(10) \"YUYUYUYUYU\"\n      [\"company_id\"]=&gt;\n      string(1) \"3\"\n      [\"company_name\"]=&gt;\n      string(16) \"voyage indonesia\"\n      [\"created_at\"]=&gt;\n      string(19) \"2012-10-03 09:35:37\"\n      [\"Location\"]=&gt;\n      string(4) \"Bali\"\n      [\"postal_code\"]=&gt;\n      string(6) \"989767\"\n      [\"address\"]=&gt;\n      string(11) \"dimana mana\"\n    }\n    [1]=&gt;\n    array(8) {\n      [\"id_job\"]=&gt;\n      string(2) \"23\"\n      [\"job_title\"]=&gt;\n      string(11) \"OYEEEEAAHHH\"\n      [\"company_id\"]=&gt;\n      string(1) \"3\"\n      [\"company_name\"]=&gt;\n      string(16) \"voyage indonesia\"\n      [\"created_at\"]=&gt;\n      string(19) \"2012-09-28 09:06:54\"\n      [\"Location\"]=&gt;\n      string(7) \"Bandung\"\n      [\"postal_code\"]=&gt;\n      NULL\n      [\"address\"]=&gt;\n      NULL\n    }\n    [2]=&gt;\n    array(8) {\n      [\"id_job\"]=&gt;\n      string(2) \"20\"\n      [\"job_title\"]=&gt;\n      string(14) \"TKPDKJKLADKSJA\"\n      [\"company_id\"]=&gt;\n      string(1) \"3\"\n      [\"company_name\"]=&gt;\n      string(16) \"voyage indonesia\"\n      [\"created_at\"]=&gt;\n      string(19) \"2012-09-20 09:24:50\"\n      [\"Location\"]=&gt;\n      string(7) \"Bandung\"\n      [\"postal_code\"]=&gt;\n      NULL\n      [\"address\"]=&gt;\n      NULL\n    }\n}\n[\"_total_rows\":protected]=&gt;\n  int(3)\n  [\"_current_row\":protected]=&gt;\n  int(0)\n  [\"_as_object\":protected]=&gt;\n  bool(false)\n</code></pre>\n\n<p>my goal : example in array index at 8 like this or something else better than this code</p>\n\n<pre><code>array(8) {\n          [\"id_job\"]=&gt;\n          string(2) \"27\"\n          [\"job_title\"]=&gt;\n          string(10) \"YUYUYUYUYU\"\n          [\"company_id\"]=&gt;\n          string(1) \"3\"\n          Array ( [companies] =&gt; array(1) {\n          [\"company_name\"]=&gt;\n          string(16) \"voyage indonesia\"\n          })\n          [\"created_at\"]=&gt;\n          string(19) \"2012-10-03 09:35:37\"\n          [\"Location\"]=&gt;\n          string(4) \"Bali\"\n          [\"postal_code\"]=&gt;\n          string(6) \"989767\"\n          [\"address\"]=&gt;\n          string(11) \"dimana mana\"\n        }\n</code></pre>\n\n<p>company_id is relation table database table bla1,\ni just want to giving array in relation table so i can easily to parse data,\nlike <code>array('bla1' = &gt; array('company_id',1));</code>\nhow about your suggestion ?</p>\n"},{"tags":["mysql","query","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12745352,"title":"how group_concat with like where condition in that case","body":"<p>I have tables(mysql 5.5 INNODB):sample small data + cut not relevant columns for questions - real data huge(more then 10,000,000 rows in meeting table) </p>\n\n<p><strong>INPUT:</strong></p>\n\n<pre><code>day:\n\nday_id(primary key)|sunday|monday|tuesday|wensday|thursday|friday|saturday\n---------------------------------------------------------------------------\n60                 |1     |1     |1      |1      |1       |1    |1\n74                 |0     |1     |0      |0      |0       |0     |0\n98                 |0     |0     |0      |0      |0       |0     |0\n..etc......................................................................\n\nmeeting:\n\nday_id(foreign key)|time    |type\n----------------------------------\n60                 |20:09:00|1\n98                 |07:00:00|1\n74                 |22:01:00|4\n98                 |10:00:00|1\n60                 |23:09:00|2\n98                 |06:00:00|2\n74                 |21:04:00|6\n98                 |08:00:00|6\n.....etc.....................\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<pre><code>sunday_times          |monday_times                           |....etc\n-------------------------------------------------------------------------------------------------\n20:09:00,etc...       | 20:09:00,etc..   |\n................etc..............................................................................\n</code></pre>\n\n<p>I think something like that (but I am new  with sql soo i don't know if it good or legal)</p>\n\n<pre><code> SELECT \n   GROUP_CONCAT(time where day.sunday=1 ORDER BY time) as sunday_times, \n   GROUP_CONCAT(time where day.monday=1 ORDER BY time) as monday_times,  \n   etc..\n FROM day\n JOIN meeting ON meeting.day_id=day.day_id\n GROUP BY type\n</code></pre>\n"},{"tags":["query","url","cakephp","routing","cakephp-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12745214,"title":"cakephp 2.x query url parameter are not passed true","body":"<p>I have the folowing url: <a href=\"http://www.domain.com/admin/posts/list_media?rand=554&amp;hash=&amp;id=25\" rel=\"nofollow\">http://www.domain.com/admin/posts/list_media?rand=554&amp;hash=&amp;id=25</a>\nCakephp genarates a Missing View error on the live server, the local server has no problems with this url.</p>\n\n<p>The controller is loaded, but the problem occurs when the view is loaded. When I remove everything after the question mark in the url it works fine.</p>\n\n<p>the params reach the the controller:</p>\n\n<pre><code>Array ( \n    [rand] =&gt; 554 \n    [hash] =&gt; \n    [id] =&gt; 25 \n)\n</code></pre>\n\n<p>What can be the problem?</p>\n"},{"tags":["sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":12744853,"title":"Getting a column of table using another table","body":"<p>I've question to ask.</p>\n\n<p>Let's say I 've 2 database table.</p>\n\n<pre><code>Table1          Table2\n------          ------\n\nid(PK)          id(FK)\n\ncolumn2         column2\n\ncolumn3         column3\n</code></pre>\n\n<p>What I need is to write 1 query so I can take Table1's column2 using Table2's id(FK).\nHow can I do this with just one query?</p>\n\n<p>Thank you</p>\n"},{"tags":["sql-server","query","menuitem","submenu"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12744266,"title":"How to write query menus and submenus n level using SQL Server?","body":"<p>I have SQL Server 2008 table <code>MenuItem</code> in following format.</p>\n\n<pre><code> MenuItemsID     MenuType     ItemsName  ParentID     URL          Images\n\n       1            1           Home         0         --            ---\n       2            1          Product       0         ---           ----\n       3            1          Catagories    0         ---            ----\n       4            1          Brand         0         Brand.aspx     ----\n       5            1          H1            1         ------          -----\n       6            1          H2            1         ------        --------\n       7            1          P1            2         ----           ------\n       8            1          c1            3         ----           ---\n       9            1          H1Submneu1    5         ---               ----\n       10           1           P1 subMenu   7         -------           ---\n</code></pre>\n\n<p>like that </p>\n\n<p>I have tried to write a query to retrieve up to one level of submenus </p>\n\n<pre><code>select \n    m.ItemName, STUFF((select ',' + s.ItemName \n                       from MenuItems s\n                       where s.ParentId = m.MenuItemsID FOR XML PATH('')), 1, 1, '') as SubMenus\nfrom MenuItems m \nwhere ParentId = 0\n</code></pre>\n\n<p>But I want m levels of submenues</p>\n\n<p>How to could be write that query? Can anyone please help me?</p>\n"},{"tags":["mysql","query","index"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12744562,"title":"Improve this very slow MySQL SELECT","body":"<p>I have this MySQL query that is very slow, I presume because of  all the JOINs (it seems complicated, but it's a matter of lot of tables):</p>\n\n<pre><code>SELECT DISTINCT doctors.doc_id, \n    doctors.doc_user, \n    doctors.doc_first, \n    doctors.doc_last, \n    doctors.doc_email, \n    doctors.doc_notes, \n    titles.tit_name, \n    specializations.spe_name, \n    activities.act_name, \n    users.use_first, \n    users.use_last,\n    (SELECT COUNT(*) FROM locations WHERE locations.loc_doctor = doctors.doc_id) AS loc_count,\n    (SELECT COUNT(*) FROM reception WHERE reception.rec_doctor = doctors.doc_id) AS rec_count,\n    (SELECT COUNT(*) FROM visits INNER JOIN reports ON visits.vis_report = reports.rep_id  WHERE visits.vis_doctor = doctors.doc_id AND reports.rep_user LIKE '%s') AS vis_count\nFROM\n    doctors\nINNER JOIN titles ON titles.tit_id = doctors.doc_title\nINNER JOIN specializations ON specializations.spe_id = doctors.doc_specialization\nINNER JOIN activities ON activities.act_id = doctors.doc_activity\nLEFT JOIN locations ON locations.loc_doctor = doctors.doc_id\nINNER JOIN users ON doctors.doc_user = users.use_id\nWHERE\n    ((doctors.doc_last LIKE %s) OR (doctors.doc_first LIKE %s) OR (doctors.doc_email LIKE %s)) \n    AND doctors.doc_user LIKE %s \n    AND locations.loc_province LIKE %s \n    AND doctors.doc_specialization LIKE %s \n    AND doctors.doc_activity LIKE %s \nORDER BY %s\n</code></pre>\n\n<p>All the %s are parameters in a sprintf() PHP function<br>\nThe most important thing to notice is... that I have NO indexes on MySQL! I presume that I can speed up the process adding some indexes... but what and where? There are so many joins and search parameters that I am in confusion about what would be efficient :-)</p>\n\n<p>Please can you help?\nThanks in advance!</p>\n"},{"tags":["sql","query","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12743916,"title":"Populate SQL Database column with repeating sequential values","body":"<p>I have an SQLite database <code>TestDB</code>. In this I have a table, say, <code>records</code>. I want to create a column <code>ID</code> that sequentially takes the value from 1 through 3 repeatedly. </p>\n\n<p>For instance:</p>\n\n<pre><code>**Record#**      **ID**\nRecord1            1\nRecord2            2\nRecord3            3\nRecord4            1\nRecord5            2\nRecord6            3\nRecord7            1\nRecord8            2\nRecord9            3\nRecord10           1\nRecord11           2\nRecord12           3\n</code></pre>\n\n<p>And so on...</p>\n\n<p>Is there an SQL query that can achieve this? Thanks for the inputs!</p>\n"},{"tags":["mysql","query","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12744059,"title":"Mysql query returns data set  but empty set when called  in servlet","body":"<p>I am using the query as follows:</p>\n\n<pre><code>String newq=\"select *from account\"; \nResultSet rs = s.executeQuery(newq);\n</code></pre>\n\n<p>The table contains two rows but it returns the empty set only. How can I overcome this?</p>\n"},{"tags":["java","query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12743125,"title":"How to construct query to update nested array document in mongo?","body":"<p>I am having following document in mongo,</p>\n\n<pre><code>  {\n   \"_id\" : ObjectId(\"506e9e54a4e8f51423679428\"),\n   \"description\" : \"ffffffffffffffff\", \n   \"menus\" : [  \n                {   \n                  \"_id\" : ObjectId(\"506e9e5aa4e8f51423679429\"),     \n                   \"description\" : \"ffffffffffffffffffff\",  \n                      \"items\" : [\n                               {    \n                              \"name\" : \"xcvxc\",     \n                              \"description\" : \"vxvxcvxc\",   \n                              \"text\" : \"vxcvxcvx\",  \n                              \"menuKey\" : \"0\",  \n                               \"onSelect\" : \"1\",    \n                              \"_id\" : ObjectId(\"506e9f07a4e8f5142367942f\") \n                              } ,\n                              {     \n                              \"name\" : \"abcd\",  \n                              \"description\" : \"qqq\",    \n                              \"text\" : \"qqq\",   \n                              \"menuKey\" : \"0\",  \n                               \"onSelect\" : \"3\",    \n                              \"_id\" : ObjectId(\"507e9f07a4e8f5142367942f\") \n                              }\n                             ] \n                 },\n                 {  \n                    \"_id\" : ObjectId(\"506e9e5aa4e8f51423679429\"),   \n                    \"description\" : \"rrrrr\",    \n                     \"items\" : [    {   \n                                 \"name\" : \"xcc\",    \n                                 \"description\" : \"vx\",  \n                                 \"text\" : \"vxc\",    \n                                 \"menuKey\" : \"0\",   \n                                \"onSelect\" : \"2\",   \n                              \"_id\" : ObjectId(\"506e9f07a4e8f5142367942f\") \n                         } ]\n                } \n            ]\n   } \n</code></pre>\n\n<p>Now , i want to update the following document :</p>\n\n<pre><code> {  \n     \"name\" : \"abcd\",   \n    \"description\" : \"qqq\",  \n    \"text\" : \"qqq\",     \n    \"menuKey\" : \"0\",    \n        \"onSelect\" : \"3\",   \n    \"_id\" : ObjectId(\"507e9f07a4e8f5142367942f\") \n  }\n</code></pre>\n\n<p>I am having main documnet id: <strong>\"_id\" : ObjectId(\"506e9e54a4e8f51423679428\")</strong> and <strong>menus id\n \"_id\" : ObjectId(\"506e9e54a4e8f51423679428\")</strong> as well as items id <strong>\"_id\" : ObjectId(\"507e9f07a4e8f5142367942f\")</strong> which is to be updated.</p>\n\n<p>I have tried using the following query:</p>\n\n<p><code>db.collection.update({ \"_id\" : { \"$oid\" : \"506e9e54a4e8f51423679428\"} ,       \"menus._id\" : { \"$oid\" : \"506e9e5aa4e8f51423679429\"}},{ \"$set\" : { \"menus.$.items\" : { \"_id\" : { \"$oid\" : \"506e9f07a4e8f5142367942f\"}} , \"menus.$.items.$.name\" : \"xcvxc66666\", ...}},false,false);</code></p>\n\n<p>but its not working...</p>\n"},{"tags":["mysql","query","delete","truncate"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1192,"score":1,"question_id":2601576,"title":"Delete, Truncate or Drop MySQL question","body":"<p>I am attempting to clean out a table but not get rid of the actual structure of the table, i have the following columns: id, username, date, text</p>\n\n<p>the id is auto incrementing, I don't need to keep the ID number, but i do need it to keep its auto-incrementing characteristic. I've found delete and truncate but I'm worried one of these will completely drop the entire table rendering future insert commands useless.</p>\n\n<p>Thank you, Everybody!</p>\n"},{"tags":["mysql","query","delete","count"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12742406,"title":"Improving a MySQL Delete Query when using COUNT","body":"<p>I found that the following query is causing some bottleneck (the execution time takes more than 40 seconds!)</p>\n\n<pre><code>DELETE FROM doctors \nWHERE (SELECT COUNT(loc_id) \n       FROM locations \n       WHERE locations.loc_doctor = doctors.doc_id) = 0 AND \n       doctors.doc_user = $myVar\n</code></pre>\n\n<p>I guess the problem lies in the \"(SELECT COUNT(loc_id) FROM locations WHERE locations.loc_doctor = doctors.doc_id) = 0\" section, am I right?\nIs there a way to improve it?\nThanks in advance!</p>\n"},{"tags":["database","query","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12741812,"title":"Internals of retrieving database result","body":"<p>I'm trying to learn more about database internals, but there is one thing I don't understand for which I've found no resources.</p>\n\n<p>When database has found requested rows, are they all sent to the client, or user has to retrieve rows one by one?\nIf second is true, shouldn't that generate many round time trips?</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12741234,"title":"How can I build this query to compare a id with two tables?","body":"<p><img src=\"http://i.stack.imgur.com/tcOeT.png\" alt=\"query logic\"></p>\n\n<p>I have drawn this image to explain what I need</p>\n\n<blockquote>\n  <p>1.to compare a user_id with the user_id's in two different tables</p>\n  \n  <p>2.the corresponding ref_global_id from both the tables are then matched to a events table</p>\n  \n  <p>3.matching global_id's from the events table are then arranged in ascending order.</p>\n</blockquote>\n"},{"tags":["php","wordpress","query","loops","while-loop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12741179,"title":"PHP: Variable/Value only available inside loop - using it outside?","body":"<p><em>I've already asked this question on <code>wordpress.stackexchange.com</code> but they told me this is a plain PHP question and might have nothing to do with wordpress.</em></p>\n\n<p>I have a fairly big problem with a function i wrote …</p>\n\n<p>The function lists all <code>posts</code> of a <code>custom-post-type</code> for \"events\".</p>\n\n<pre><code>function get_event_list( $latest = true, $order = 'ASC' ) {\n    echo '&lt;ul class=\"event-items\"&gt;';\n\n    $yesterday = time() - 24*60*60;\n    $compare = $latest ? '&gt;' : '&lt;';\n    $current_year = '';\n\n    $args = array(\n        'post_type' =&gt; 'wr_event',\n        'posts_per_page' =&gt; -1, // show all posts\n        'meta_key' =&gt; 'event_date',\n        'orderby' =&gt; 'meta_value_num',\n        'order' =&gt; $order,\n        'meta_value' =&gt; $yesterday,\n        'meta_compare' =&gt; $compare\n    );\n\n    $loop = new WP_Query( $args );\n    while ( $loop-&gt;have_posts() ) : $loop-&gt;the_post();\n        global $post;\n        $this_year = get_post_meta( $post-&gt;ID, 'event_date', true );\n        $this_year = date('Y', $this_year);\n\n        if ( !$latest &amp;&amp; ( $this_year != $current_year ) ) :\n            // new year, output the year header\n            // and reset current year to this new value\n            echo '&lt;li class=\"wrapper year\"&gt;&lt;h2&gt;' . $this_year . '&lt;/h2&gt;&lt;/li&gt;';\n            $current_year = $this_year;\n        endif;\n\n        get_template_part( 'inc/event', 'item' ); // creates the actual li-item\n    endwhile;\n    wp_reset_postdata();\n    echo '&lt;/ul&gt;';\n}\n</code></pre>\n\n<p>As you can see I compare the \"event-date\" against the current year, so I can split my list in different years. The <strong>problem I have</strong> is that <code>get_post_meta( $post-&gt;ID, 'event_date', true );</code> this is only available inside the <code>while</code> loop.</p>\n\n<p>Currently the function above outputs this …</p>\n\n<pre><code>&lt;ul class=\"event-items\"&gt;\n   &lt;li class=\"year\"&gt;2012&lt;/li&gt;\n   &lt;li&gt;Event 05&lt;/li&gt;\n   &lt;li&gt;Event 04&lt;/li&gt;\n   &lt;li&gt;Event 03&lt;/li&gt;\n   &lt;li&gt;Event 02&lt;/li&gt;\n   &lt;li&gt;Event 01&lt;/li&gt;\n   &lt;li class=\"year\"&gt;2011&lt;/li&gt;\n   &lt;li&gt;Event 03&lt;/li&gt;\n   &lt;li&gt;Event 02&lt;/li&gt;\n   &lt;li&gt;Event 01&lt;/li&gt;\n   &lt;li class=\"year\"&gt;2010&lt;/li&gt;\n   &lt;li&gt;Event 04&lt;/li&gt;\n   &lt;li&gt;Event 03&lt;/li&gt;\n   &lt;li&gt;Event 02&lt;/li&gt;\n   &lt;li&gt;Event 01&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>However this structure is fairly complicated to use and semantically not really correct and useful.</p>\n\n<p>I'd like to wrap <strong>each year</strong> into a new <code>&lt;ul&gt;</code>.</p>\n\n<p>Any idea how to do so? The <code>post_meta</code> \"event_date\" is only available inside the loop. How could I compare the \"event_date\" with the current year and wrap the queried results into a new <code>ul</code></p>\n\n<p>Like so …</p>\n\n<pre><code>&lt;ul class=\"event-items\"&gt;\n    &lt;li class=\"year\"&gt;&lt;div&gt;2012&lt;/div&gt;\n        &lt;ul&gt;\n            &lt;li&gt;Event 05&lt;/li&gt;\n            &lt;li&gt;Event 04&lt;/li&gt;\n            &lt;li&gt;Event 03&lt;/li&gt;\n            &lt;li&gt;Event 02&lt;/li&gt;\n            &lt;li&gt;Event 01&lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;/li&gt;\n    …\n&lt;/ul&gt;\n</code></pre>\n\n<p>Maybe there are some people who know a good and logical solution to this. Maybe I need to use <a href=\"http://codex.wordpress.org/Template_Tags/get_posts\" rel=\"nofollow\"><code>get_posts()</code></a> instead of <code>new WP_Query</code> however I'm not that good in PHP and have no idea how I could handle this.</p>\n\n<p>Please, if anybody has an idea let me know! Thank you in advance!</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12740968,"title":"What would cause this query to provide this error, when using the count function?","body":"<p>Up until today, this is the query that got everything I needed to know about a photo from my database:</p>\n\n<pre><code>SELECT \n    users.facebook_id, \n    users.first_name, \n    users.last_name, \n    photos.filename, \n    photos.description, \n    photos.finalist, \n    bookmarks.photo_id AS bookmark \nFROM `photos`, `users` \nLEFT JOIN bookmarks ON bookmarks.photo_id = 123 AND bookmarks.facebook_id = 123456789 \nWHERE \n    users.facebook_id = photos.author AND \n    photos.id = 123 \nLIMIT 1\n</code></pre>\n\n<p>However, now I'd like to also find out how many votes have been cast for this photo.</p>\n\n<p>Here is my 'votes' table:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `votes` (\n  `photo_id` int(11) NOT NULL,\n  `facebook_id` bigint(20) NOT NULL COMMENT 'The user''s Facebook ID.',\n  `date` varchar(10) NOT NULL COMMENT 'Date formatted as YYYY-MM-DD.',\n  UNIQUE KEY `one_vote_per_day` (`photo_id`,`facebook_id`,`date`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n</code></pre>\n\n<p>And here is my attempt to modify my SQL query to fetch a vote count:</p>\n\n<pre><code>SELECT \n    users.facebook_id, \n    users.first_name, \n    users.last_name, \n    photos.filename, \n    photos.description, \n    photos.finalist, \n    bookmarks.photo_id AS bookmark,\n    count(votes.*) AS vote_count\nFROM `photos`, `users` \nLEFT JOIN votes ON votes.photo_id = 123  \nLEFT JOIN bookmarks ON bookmarks.photo_id = 123 AND bookmarks.facebook_id = 123456789 \nWHERE \n    users.facebook_id = photos.author AND \n    photos.id = 123 \nLIMIT 1\n</code></pre>\n\n<p>The above attempt resulted in this error:</p>\n\n<pre><code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '*) AS vote_count FROM `photos`, `users` LEFT JOIN votes ON votes.photo_id = 1' at line 9\n</code></pre>\n"},{"tags":["mysql","sql","query","select","left-join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12739928,"title":"Why isn't my SQL LEFT JOIN query working?","body":"<p>It is returning 0 rows when there should be some results.</p>\n\n<p>This is my first attempt at using JOIN but from what I've read this looks pretty much right, right?</p>\n\n<pre><code>\"SELECT pending.paymentid, pending.date, pending.ip, pending.payer, pending.type, pending.amount, pending.method, pending.institution, payment.number, _uploads_log.log_filename \nFROM pending \nLEFT JOIN _uploads_log \nON pending.paymentid='\".$_GET['vnum'].\"' \nAND _uploads_log.linkid = pending.paymentid\"\n</code></pre>\n\n<p>I need to return the specified values from each table where both <code>pending.paymentid</code> and <code>_uploads_log.log_filename</code> are equal to <code>$_GET['vnum]</code></p>\n\n<p>What is the correct way to do this? Why am I not getting any results?</p>\n\n<p>If someone more experienced than me could point me in the right direction I would be much obliged.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>For <code>pending</code> the primary key is <code>paymentid</code>, for <code>_uploads_log</code> the primary is a col called <code>log_id</code> and <code>log_filename</code> is listed as index.</p>\n"},{"tags":["mysql","sql","query","triggers","mysql-5.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12733676,"title":"After insert trigger can do an update?","body":"<p>I'm new to the creation of triggers but I need it since I'm using a persistent storage for some IDs.</p>\n\n<p>I have the table <code>RECEIPT</code> with a column <code>RECEIPT_ID</code></p>\n\n<p>and the table <code>CONFIG_DB</code> with columns and values:</p>\n\n<pre><code>NAME               VALUE\n---------------    -----   \nNEXT_RECEIPT_ID      1\n</code></pre>\n\n<p>and I created this trigger</p>\n\n<pre><code>CREATE TRIGGER UPDATE_RECEPCION_ID\n\nAFTER INSERT ON RECEIPT\n\nFOR EACH ROW \n\nBEGIN\n\nUPDATE CONFIG_DB SET VALUE=VALUE+1;\n\nEND    \n;\n</code></pre>\n\n<p>I don't know if this is OK... all I want its that after I insert a new <code>RECEIPT_ID</code> the <code>VALUE</code> in <code>CONFIG_DB</code> increases by 1. Thank you very much.</p>\n\n<p>EDIT: I work in Mysql Workbench 5.2.40 with Mysql Server 5.5.25</p>\n"},{"tags":["database","query","codeigniter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12738326,"title":"Viewing a single record from a database using a link","body":"<p>I have a link for each record that is displayed on the screen and when i click on the link, I would like to show all the details of the record on a new page. </p>\n\n<p>Basically when i click the link, I get a url with the id no. of that item like:</p>\n\n<p>polls/index.php/user/vote/59</p>\n\n<p>NOw i am trying to display the title and text of that id no.</p>\n\n<p>IN my controller, I have a method to do this:</p>\n\n<pre><code>public function display_poll($id=0){\n\n    $this-&gt;load-&gt;helper('form');  \n    $this-&gt;load-&gt;helper('html'); \n    $this-&gt;load-&gt;model('polls_model');  \n\n    $data['polls_item'] = $this-&gt;polls_model-&gt;get($id);\n\n    if (empty($data['polls_item']))\n    {\n        show_404();\n    }\n\n    $this-&gt;load-&gt;helper('html');\n    $data['content'] = $this-&gt;load-&gt;view('user/view', $data, TRUE);\n    $data['id'] = $data['polls_item']['id'];\n    $data['title'] = $data['polls_item']['title'];\n    $data['text'] = $data['polls_item']['text'];\n\n    $this-&gt;load-&gt;view('user/vote',$data);   \n\n}\n</code></pre>\n\n<p>IN my view, I am doing it like this:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;h2&gt;Voting Page:&lt;/h2&gt;\n\n&lt;script type=\"text/javascript\" src=\"&lt;?php echo base_url();?&gt;js/jquery.js\"&gt;&lt;/script&gt;      \n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;?php echo form_open('user/vote'); ?&gt;\n&lt;?php echo form_hidden($polls_item['id']); ?&gt;\n&lt;?php echo $polls_item['title'] ?&gt;\n&lt;?php echo $polls_item['text'] ?&gt;\n\n&lt;?php echo form_close(); ?&gt;\n\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>and in my model, I have a function like this:</p>\n\n<pre><code>function get($id)\n{\n    $query = $this-&gt;db-&gt;get_where('polls', array('id'=&gt;$id));\n    return $query-&gt;row_array();       \n}\n</code></pre>\n\n<p>I am getting this sort of error: </p>\n\n<p>A PHP Error was encountered</p>\n\n<p>Severity: Notice</p>\n\n<p>Message: Undefined variable: polls_item</p>\n\n<p>Filename: user/vote.php</p>\n\n<p>Line Number: 27</p>\n\n<p>How can i fix this? YOur help will be greatly appreciated.\nTHankyou.</p>\n"},{"tags":["query","list","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12739299,"title":"How to query MongoDB for matching documents where item is in document array","body":"<p>If my stored document looks like this:</p>\n\n<pre><code>doc = {\n    'Things' : [ 'one' , 'two' , 'three' ]\n    }\n</code></pre>\n\n<p>How can I query for documents which contain <code>one</code> in <code>Things</code>?</p>\n\n<p>I know the <code>$in</code> operator queries a document item against a list, but this is kind of the reverse.  Any help would be awesome.</p>\n"},{"tags":["android","query","sqlite","android-cursor"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12739207,"title":"I want to display table field ExpNo in TextView","body":"<p>I want to display <code>table field ExpNo</code> in <code>TextView,</code> Please help me to write query in cursor or which way that you know...</p>\n\n<p>Sql Query is like : <code>Select Max(ExpNo) from table;</code>\n(how to write this query in android)</p>\n\n<p>please help me...</p>\n\n<p>i was write like :</p>\n\n<pre><code>public void dispExpNo()  \n   {\n    String[] exno = {\"ExpNo\"};  \n    Cursor c = db.query(\"tb_expense\",exno,null,null,null,null,null);                \n    txtExpno.setText(\"\"+c.getInt(0));\n    c.close();          \n   }\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12736376,"title":"Comparing an id to id of different tables rows mysql","body":"<p>So I am trying to retrieve all interests from someone, and be able to list them. This works with the following query.</p>\n\n<pre><code>SELECT *,(\n    SELECT GROUP_CONCAT(interest_id SEPARATOR \",\")\n    FROM people_interests\n    WHERE person_id = people.id\n) AS interests\nFROM people\nWHERE id IN (\n    SELECT person_id\n    FROM people_interests\n    WHERE interest_id = '.$site-&gt;db-&gt;clean($_POST['showinterest_id']).'\n)\nORDER BY lastname, firstname\n</code></pre>\n\n<p>In this one which I am having trouble with, I want to select only those who happen to have their id in the table named <code>volleyballplayers</code>. The table just has an id, person_id, team_id, and date fields.</p>\n\n<pre><code>SELECT *,(\n    SELECT GROUP_CONCAT(interest_id SEPARATOR \",\")\n    FROM people_interests\n    WHERE person_id = people.id\n) AS interests\nFROM people\nWHERE id IN (\n    SELECT person_id\n    FROM people_interests\n    WHERE volleyballplayers.person_id = person_id\n)\nORDER BY lastname, firstname\n</code></pre>\n\n<p>I just want to make sure that only the people who are in the volleyballplayers table show up, but I am getting an error saying that <code>Unknown column 'volleyballplayers.person_id' in 'where clause'</code> although I am quite sure of the name of table and I know the column is named person_id. </p>\n"},{"tags":["php","query","join","mysqli"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12735831,"title":"Whats wrong with my join?","body":"<p>simplified db setup </p>\n\n<p>table:clients \nfields: clientId(autoinc/primary), customerId, clientName</p>\n\n<p>table:projects \nfields: projectId(autoinc/primary), customerId, projectName</p>\n\n<p>table:items\nfields: itemId(autoinc/primary), customerId, itemName</p>\n\n<p>query:</p>\n\n<pre><code>include('includes/conn.inc.php'); \n$query = \"SELECT customerId \n         FROM items, projects, clients \n         WHERE customerId= 135\";\n$stmt = $mysql-&gt;prepare ($query);\n$stmt-&gt;execute();\n$stmt-&gt;bind_result($customerId);\n\nwhile($row = $stmt-&gt;fetch()) : \n      echo $customerId;\nendwhile; $stmt-&gt;close();\n</code></pre>\n\n<p>question: whats wrong with the query? Be gentle, Im trying to figure out joins for the first time. Ive tried a bunch of different ways but cant get any of them to work, this one seemed the simplest and most explanatory for what i want to do. There is an entry on each table that corresponds (customerId=135) so if the query works i would expect it to return 3 of them.\nerror: calling execute on a non-object</p>\n\n<p>Thanks to everyone in advance</p>\n\n<p>------- update</p>\n\n<p>Thanks everyone for your help! I actually got it to work by using this query:</p>\n\n<pre><code>        SELECT clients.customerId, projects.customerId, items.customerId \n        FROM clients, projects, items \n        WHERE  clients.customerId = projects.customerId AND   \n        projects.customerId = items.customerId;\n</code></pre>\n\n<p>although that kinda seems clunky especially in the end. If anyone knows a shorthand for \"WHERE table.column = table.column = table column that would be excellent considering they are all 3 the same value. </p>\n"},{"tags":["query","mdx","pentaho"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":12049835,"title":"How to query in mdx between two dates where the date is not exist in the cube","body":"<p>i've some problem in query the data in mdx between two dates DateFrom and DateTo. simplely the problem is, assume we have 3 records of [Year][Month][Day]:</p>\n\n<pre><code>[2012][8][21]\n[2012][8][22]\n[2012][8][23]\n</code></pre>\n\n<p>if I pass the DateFrom and DateTo as something wasn't in the db, for example <code>DateFrom = [2012].[8].[20] and DateTo = [2012].[8].[24]</code>, it show the error \"Mondrian Error:MDX object '[Date].[2012].[8].[20]' not found in cube 'Email'\"</p>\n\n<p>but if i set DateFrom and DateTo as something in the db, for example <code>DateFrom = [2012].[8].[21] and DateTo = [2012].[8].[23]</code>, it works.</p>\n\n<p>because the DateFrom and DateTo was passed from the Frond end in web ui, so i can't contorl it, so i think i need to find the smallest value bigger than DateFrom and biggest value smaller than DateTo, But I don't how to, any idea? or do I have any other approach to solve this? thanks.</p>\n"},{"tags":["sql","query","coldfusion"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12733644,"title":"MS SQL query to calculate average monthly unique visitors","body":"<p>I made MSSQL query that calculates total unique IP address and total IP records for past 30 days.</p>\n\n<pre><code>SELECT count(IPAddress) AS totalPageHits, count(DISTINCT IPAddress) AS totalVisitors, count(DateTime)\nFROM recordTable\nWHERE DateTime &gt; GETDATE()-30\n</code></pre>\n\n<p>Now I am having a hard time to calculate average daily page hits and average daily unique visitors.\nI have tried to use <code>AVG</code> but it gives me an error message saying \"Operand data type varchar is invalid for avg operator.\" <br />\nAny help is greatly appreciated.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12735530,"title":"how to write sql query without alias","body":"<p>Is it possible to write this sql query without alias? I am using a PHP script that doesn't covers alias so I have problem with that.</p>\n\n<p>If this is possible please provide me with some help</p>\n\n<p>This is the code:</p>\n\n<pre><code>SELECT \n time1.Time, time2.Time, time1.Signal, v.name, v.lastname, k.vehicle, time1.Reg\nFROM\n data time1\n INNER JOIN data time2\n    ON  time1.id != time2.id \n    AND time1.serial= time2.serial\n INNER JOIN drivers v\n    ON time1.FK_ID_driver=v.ID_driver\n INNER JOIN vehicles k\n    ON time1.Reg=k.Reg\n\nWHERE\n   TIMEDIFF(time2.Time, time1.Time) BETWEEN '00:15:00' AND '00:30:00';\n</code></pre>\n"},{"tags":["query","jointable"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":12734186,"title":"joining 3 tables mysql_num_rows() not working","body":"<p>i have 3 tables</p>\n\n<p>packages\n-package_id ex. E001\n-description ex. Princess Sofia</p>\n\n<p>customerinfo\n-fname ex. anna\n-lname ex. stelle\n-cus_id ex. 1</p>\n\n<p>tailoringservice\n-ts_id ex. 1\n-cus_id ex. 1\n-package_id ex. 1</p>\n\n<p>how will i be able to connect join tables?</p>\n\n<p>my sql query goes like this but it wont work.</p>\n\n<pre><code>SELECT customerinfo.FNAME, customerinfo.LNAME, packages.DESCRIPTION, DATE_EVENT, EVENT_TYPE, REMARKS, STATUS, TS_ID\n                 FROM customerinfo, tailoringservice, packages\n                 WHERE  customerinfo.CUS_ID = tailoringservice.CUS_ID AND tailoringservice.PACKAGE_ID = packages.PACKAGE_ID\n</code></pre>\n\n<p>please help.</p>\n"},{"tags":["php","mysql","database","query","mysqli"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":12733813,"title":"\"bind_param() on a non-object\" and \"mysqli_fetch_array() expects parameter 1 to be mysqli_result, boolean given\"","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2077263/warning-problem-expects-parameter-1-to-be-mysqli-result\">warning problem: expects parameter 1 to be mysqli_result</a><br>\n  <a href=\"http://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select\">mysql_fetch_array() expects parameter 1 to be resource, boolean given in select</a>  </p>\n</blockquote>\n\n\n\n<p><strong>I'm having trouble with a piece of my log-in code. I tried writing it in two different ways but both fail and I just can't understand why >.&lt;</strong></p>\n\n<p><strong>screenshot of the table:</strong>\n<img src=\"http://i.stack.imgur.com/QhtBx.png\" alt=\"enter image description here\">\n<strong>first way code:</strong></p>\n\n<pre><code>$user = 'batman';\n$query = \"SELECT user_id, username FROM Accounts WHERE username = '$user'\";\n$data = mysqli_query($db, $query);\n$row = mysqli_fetch_array($data); //line 166\nvar_dump(mysqli_query($db, $query));\necho \"test $user $row\";\n</code></pre>\n\n<p><strong>first result:</strong></p>\n\n<p>Warning: mysqli_fetch_array() expects parameter 1 to be mysqli_result, boolean given in /home/mysitepath/public_html/auth.php on line 166</p>\n\n<p>bool(false) test batman </p>\n\n<p><strong>Second way code:</strong></p>\n\n<pre><code>$user = 'batman';\n($stmta = $db-&gt;prepare('SELECT user_id, username FROM Accounts WHERE username =?'))\n        || fail('MySQL prepare', $db-&gt;error);\n\n    //check whether $stmta returns an object or false\n    var_dump($stmta);\n\n    $stmta-&gt;bind_param('s', $user) //line 178\n        || fail('MySQL bind_param', $db-&gt;error);\n    $stmta-&gt;execute()\n        || fail('MySQL execute', $db-&gt;error);\n    $stmta-&gt;bind_result($row)\n        || fail('MySQL bind_result', $db-&gt;error);\n    if (!$stmta-&gt;fetch() &amp;&amp; $db-&gt;errno)\n        fail('MySQL fetch', $db-&gt;error);\n</code></pre>\n\n<p><strong>Second result:</strong></p>\n\n<p>Fatal error: Call to a member function bind_param() on a non-object in /home/mysitepath/public_html/auth.php on line 178</p>\n\n<p>When I comment out the part after the var_dump() in the \"second way\" code, allowing the var_dump to be displayed, it showed <code>bool(false)</code> </p>\n\n<p>Entering the query in phpadmin like this works:<img src=\"http://i.stack.imgur.com/URmuo.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Anyone an idea as to why me query keeps returning false?</strong></p>\n\n<p><strong>EDIT:</strong> The function fail()</p>\n\n<pre><code>function fail($pub, $pvt = '')\n{\n    global $debug;\n    $msg = $pub;\n    if ($debug &amp;&amp; $pvt !== '')\n        $msg .= \": $pvt\";\n/* The $pvt debugging messages may contain characters that would need to be\n * quoted if we were producing HTML output, like we would be in a real app,\n * but we're using text/plain here.  Also, $debug is meant to be disabled on\n * a \"production install\" to avoid leaking server setup details. */\n    if (!$msg == 'nothing')\n    exit(\"An error occurred ($msg).\\n\");\n}\n</code></pre>\n\n<p>It's taken from Alexander Peslyak's(better known as Solar Designer, Openwall Project leader) <a href=\"http://www.openwall.com/articles/PHP-Users-Passwords\" rel=\"nofollow\">article</a> </p>\n"},{"tags":["c#","linq","query","weighted-average"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1955,"score":2,"question_id":2714639,"title":"Weighted Average with LINQ","body":"<p>My goal is to get a weighted average from one table, based on another tables primary key.</p>\n\n<p>Example Data:</p>\n\n<p>Table1</p>\n\n<pre><code>Key     WEIGHTED_AVERAGE\n\n0200    0\n</code></pre>\n\n<p>Table2</p>\n\n<pre><code>ForeignKey    LENGTH    PCR\n0200          105       52\n0200          105       60\n0200          105       54\n0200          105       -1\n0200          47        55\n</code></pre>\n\n<p>I need to get a weighted average based on the length of a segment and I need to ignore values of -1. I know how to do this in SQL, but my goal is to do this in LINQ. It looks something like this in SQL:</p>\n\n<pre><code>SELECT Sum(t2.PCR*t2.LENGTH)/Sum(t2.LENGTH) AS WEIGHTED_AVERAGE\nFROM Table1 t1, Table2 t2\nWHERE t2.PCR &lt;&gt; -1\nAND t2.ForeinKey = t1.Key;\n</code></pre>\n\n<p>I am still pretty new to LINQ, and having a hard time figuring out how I would translate this.  The result weighted average should come out to roughly 55.3. Thank you.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":58,"score":-1,"question_id":12732810,"title":"using a php function inside of mysql SELECT query?","body":"<p>We have a database with millions of products and prices. We're trying to add a filter onto our sql statement so that we can narrow down what we're looking for and then display it on our table. Some of the things we wanted to filter are related to pricing which is giving us a problem. </p>\n\n<p>Since our prices are fairly dynamic, we currently use a php function to calculate our fees in real time rather than store them inside the database. We pass the current price through the function and then display it in the table:</p>\n\n<pre><code>echo profit('99.99'); // output: 12.19\n</code></pre>\n\n<p>The problem with this is we can't run these calculations inside the query using our function to find results:</p>\n\n<pre><code>$query = \"SELECT * FROM `products` WHERE \".profit(.\"`price` + `shipping` + `acquisition` + `fees`\".).\" &gt; 10 \";\n</code></pre>\n\n<p>Is there anyway to get around this? Do we need to iterate through all the table values? We're trying to avoid this since the database is so large. Thanks for any help!</p>\n"},{"tags":["php","query","mongodb","upsert"],"answer_count":4,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":3446,"score":6,"question_id":4434009,"title":"get mongodb _id object after upsert with php","body":"<p>is it possible to get the new/updated _id after the query?\nexample code:</p>\n\n<pre><code>$key = array( 'something' =&gt; 'unique' );\n$data = array( '$inc' =&gt; array( 'someint' =&gt; 1 ) );\n$mongodb-&gt;db-&gt;collection-&gt;update( $key, $data, array( 'upsert' =&gt; true ) );\n</code></pre>\n\n<p>$key is not holding the new/old _id object and i assume that $data will not either because its just an instruction. </p>\n"},{"tags":["sql","database","oracle","query","timestamp"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":85,"score":0,"question_id":12730681,"title":"How can I update column with type TIMESTAMP in Oracle via sql query?","body":"<p>I have column:</p>\n\n<pre><code>\"LASTTOUCH\" TIMESTAMP(9) NOT NULL ENABLE\n</code></pre>\n\n<p>and I must set current date to this column.</p>\n\n<p>But I have no idea how I can do it.</p>\n\n<p>Could you help me, please?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":194,"score":1,"question_id":11084373,"title":"Select random N records (not top) from each category in MySql","body":"<p>I have the following <code>destination</code>, <code>image</code> and <code>destination_image</code> tables:</p>\n\n<p>(MYSQL):</p>\n\n<ul>\n<li>destination: id_destination</li>\n<li>image: id_image, filePath, size</li>\n<li>destination_image: id_destination, id_image</li>\n</ul>\n\n<p>I need to select <s>random</s> N images of a given size, per destination; where N is defined at runtime and destinations are selected from a range of <code>id_destination</code>.</p>\n\n<p>I don't need <code>top</code> N images, just <s>random</s> N images.</p>\n\n<p>Can someone point me in the right direction of what would be the correct SQL query for this ?</p>\n"},{"tags":["mysql","query","substring"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":8810782,"title":"MySQL end SUBSTRING with sentence","body":"<p>Here is my example. When I run this query:</p>\n\n<pre><code>SELECT SUBSTRING('Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae odio tellus, sit amet facilisis neque. Cras sapien nulla, suscipit non imperdiet ac, aliquet vitae lectus. Nulla a varius dolor. Nunc convallis, augue et fermentum volutpat, lectus urna sagittis risus, vel iaculis diam est convallis lectus. Suspendisse potenti. Morbi malesuada tristique varius.', 1, 300)\n</code></pre>\n\n<p>I get the first 300 chars of the sentence. That is good. Except that I want it to end where the last dot (.) is in the result.</p>\n\n<p>So the query result is this:</p>\n\n<pre><code>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae odio tellus, sit amet facilisis neque. Cras sapien nulla, suscipit non imperdiet ac, aliquet vitae lectus. Nulla a varius dolor. Nunc convallis, augue et fermentum volutpat, lectus urna sagittis risus, vel iaculis diam est convalli\n</code></pre>\n\n<p>But I want it to be this:</p>\n\n<pre><code>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae odio tellus, sit amet facilisis neque. Cras sapien nulla, suscipit non imperdiet ac, aliquet vitae lectus. Nulla a varius dolor.\n</code></pre>\n\n<p>Can I do that with a MySQL query, and how?</p>\n\n<p>Tnx</p>\n\n<hr>\n\n<p>UPDATE 1,\nThis is what I had so far:</p>\n\n<pre><code>SET @longtext = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae odio tellus, sit amet facilisis neque. Cras sapien nulla, suscipit non imperdiet ac, aliquet vitae lectus. Nulla a varius dolor. Nunc convallis, augue et fermentum volutpat, lectus urna sagittis risus, vel iaculis diam est convallis lectus. Suspendisse potenti. Morbi malesuada tristique varius.';\n\nSELECT SUBSTRING_INDEX(\n    @longtext,\n    SUBSTRING_INDEX(\n        SUBSTRING(\n            @longtext,\n            1,\n            300\n        ),\n        '.',\n        -1\n    )\n    , 1\n);\n</code></pre>\n\n<hr>\n\n<p>UPDATE 2,\nTnx @Ben</p>\n\n<p>My solution is:</p>\n\n<pre><code>SET @longtext = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec vitae odio tellus, sit amet facilisis neque. Cras sapien nulla, suscipit non imperdiet ac, aliquet vitae lectus. Nulla a varius dolor. Nunc convallis, augue et fermentum volutpat, lectus urna sagittis risus, vel iaculis diam est convallis lectus. Suspendisse potenti. Morbi malesuada tristique varius.';\n\nSELECT SUBSTRING(\n    @longtext,\n    1,\n    300 - ifnull(\n        LOCATE(\n            '.',\n            REVERSE(\n                SUBSTRING(\n                    @longtext,\n                    1,\n                    300\n                )\n            )\n        ),\n    1)\n);\n</code></pre>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12729296,"title":"php query returns missing data","body":"<p>I have a problem with my php query for getting data. Let me explain what I want. I have a database which saves the active users for some hours in a day. For example 01-01-2012 13:00\nactive = 5 01-01-2012 14:00 active = 10. My php query should make an array which contains 2 columns which are date and active. But date must be like 01-01-2012 withour hours. So I grouped them as date2 but I couldn't find the active(sum) for each days. Here is my query which doesn't give the right active sums.</p>\n\n<pre><code>$query2 = mysql_query(\"SELECT DATE_FORMAT(date, '%Y-%m-%d') AS date2, SUM(active) FROM hit WHERE game= '\".$game.\"' AND source = '\".$source.\"' AND date &gt; '\".$dateFrom.\"' AND date &lt; '\".$dateTo.\"' GROUP BY date2 ORDER BY date2\");\n\nwhile($tuple=  mysql_fetch_array($query2)){\n    $myArr[] = $tuple;\n}\nprint_r($myArr);\n</code></pre>\n"},{"tags":["database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":12730555,"title":"What is considered as bad Query_time?","body":"<p>I just started logging my database and I saw some query_times. All queries have a maximum of 0.0003. I'm not surprised that they are low since I'm the only user at the moment. Though I don't know how it will look when the site starts to get some users that makes several queries at the same time.</p>\n\n<p>How do I know if my query times are good when I'm the only user testing some different things here and there?</p>\n"},{"tags":["python","query","join","sqlalchemy","class-table-inheritance"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12633197,"title":"SQLAlchemy, filtering joined queries with table inheritance","body":"<p>First off, sorry if it turns out that what I'm trying to do is smoke crack here, I'm by no means a DB or SQLA expert. =)</p>\n\n<p>I have two classes, Person and Organization, that use table inheritance to inherit from Contact. ( Person.id is an fkey to Contact.id ), which is working fine.</p>\n\n<p>I want to search from a search box and get a list of all contacts. Normally, when I'm after a set of things, I do this:</p>\n\n<pre><code>def build_query(self):\n  return self.session.query(Person)\n\ndef filter_query(self, query)\n    if self.search_form_values.get('name_last',None):\n        query = query.filter(\n            Person.name_last==self.search_form_values.get('name_last') \n        )\n    ...\n    return query\n</code></pre>\n\n<p>And then elsewhere the query gets executed. The problem is that I want to get back a list of Contact objects,\nbut I want to filter on Organization.name, Person.name_last, and Person.name_first, all from the values typed\ninto the 'name' box on the search form. I can't figure out how to do this with one query, not sure if it's even possible.\nI'd sure like to avoid having two separate queries with interleaved results though.</p>\n\n<p>Is there some filtering kung fu that would allow me to do the above? ie</p>\n\n<ul>\n<li>get back all Contacts that:\n<ul>\n<li>have name_last or name_first match, if the Contact is a Person</li>\n<li>have name match, if the contact is an Organization</li>\n</ul></li>\n</ul>\n\n<p>Thanks</p>\n\n<p>Iain</p>\n"},{"tags":["php","mysql","query","system","reservation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12727988,"title":"Reservation system - MySQL Query Help Needed","body":"<p>Ok, so I am making a reservation system for schoolwork.</p>\n\n<p>In this system, you can make a project and choose a begin and end date (DATEFROM &amp; DATETO) for the project. (These two dates are timestamps). For each project I can make a reservation of different items. According to the datefrom and dateto fields I need to query out the items which are not already between these two fields, so these can be chosen to be reserved for that particular project.</p>\n\n<p>So. My databases important fields for this query:</p>\n\n<p>[ITEM]<br />\n - itemid (pk)<br />\n - itemname<br />\n - itemgroupid (fk ITEMGROUP)</p>\n\n<p>[ITEMGROUP]<br />\n - itemgroupid (pk)<br />\n - itemgroupname</p>\n\n<p>[PROJECT]<br />\n - projectid (pk)<br />\n - datefrom<br />\n - dateto</p>\n\n<p>[RESERVELIST]<br />\n - reservelistnr (pk)<br />\n - itemid (fk ITEM)<br />\n - projectid (fk PROJECT)<br /></p>\n\n<p><br /><br />\nSo my query now is:</p>\n\n<pre><code>$itemavailablequery = \" \nSELECT *\nFROM item, itemgroup, project\nWHERE itemgroup.itemgroupid = item.itemgroupid\nAND project.projectid='\" . $_SESSION['projectidtoreserve'] . \"' // THIS SESSION TELLS WHICH PROJECT YOU ARE RESERVING FOR.\nAND item.itemid NOT BETWEEN datefrom AND dateto // datefrom AND dateto supposed to be the dates in the $_SESSION['projectidtoreserve']..is that right????\nGROUP BY item.itemid\n\";\n</code></pre>\n\n<p>But this gives all the [ITEM]'s in my database. I need this query to check if the ITEMID isn't already in the [RESERVELIST] between datefrom and dateto of the project so it won't be reserved twice. I'm not sure how to do it, UNION, INNER/RIGHT/LEFT joins? Tutorials on internet didn't help me anyhow. I just don't get the hang of it. Every time I try to put [RESERVELIST] into my query, all items dissapear. Im not a query genious (not at all x_x). Maybe someone can help me figure this out? Any tips? Or a whole working query xD?<br/></p>\n\n<p>DBS Design: <br/>\n[ITEM] -> [ITEMGROUPID] (each item is categorized)<br/> \nBecause [ITEM] &lt;-> [PROJECT] I do [ITEM] -> [RESERVELIST] &lt;- [PROJECT]</p>\n\n<p><br/><br/><br/></p>\n\n<p>Thanks alot. Getting closer.<br/></p>\n\n<pre><code>$itemavailablequery = \" \nSELECT *\nFROM item, itemgroup, project\nWHERE itemgroup.itemgroupid = item.itemgroupid\nAND project.projectid='\" . $_SESSION['projectidtoreserve'] . \"'\nAND project.datefrom NOT BETWEEN 'datefrom' AND 'dateto' \nAND item.itemid NOT IN (\n                        SELECT reservelist.itemid \n                        FROM reservelist, project \n                        WHERE reservelist.projectid = project.projectid \n                        )\nGROUP BY item.itemid\n\";\n</code></pre>\n\n<p>Problem now: if the item is in the reserved list, it will not be displayed. Datefrom and Dateto doesnt matter.</p>\n"},{"tags":["android","sql","database","query","cursor"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":965,"score":0,"question_id":10081631,"title":"android cursor.moveToNext()?","body":"<p>I am trying to query all the columns in a table into one long text view and/or string. I know this might not be the right way to do things but I have to do this. Correct me if I am wrong, I was under the impression that move next would get the next column in the row:</p>\n\n<pre><code>Cursor c = db.get();\nif(c.moveToFirst){\ndo{\nstring = c.getString(0);\n}while(c.moveToNext);\n</code></pre>\n\n<p>I thought that this would get the first column and display all of its contents instead I get the first column and first row. What am I doing wrong? Is there a better or real way to get this information without using a ListView?</p>\n"},{"tags":["php","sql","arrays","query","result"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12725337,"title":"Getting results from 2 consecutive queries (PHP, SQL)","body":"<p>I need to return data from 2 separate tables at the same time. The info I need from the 2nd table is determined by what is returned from the first table. Here's what I'm working with..</p>\n\n<pre><code>$query = \"SELECT * FROM pending WHERE paymentid = '\".$_GET['vnum'].\"'\";\n\n$result = mysql_query($query);\n$num = @mysql_num_rows($result);\n\n$linkid = $res['paymentid'];\n\nif ($num==0) {\necho \"Hello, \".$_SESSION['Fname'].\"&lt;br /&gt;There was an error, I cannot find this payment in the records.\";\n} else {\n\n$picquery = mysql_query(\"SELECT * FROM _uploads_log WHERE linkid = '\".$linkid.\"'\");\n$numb = @mysql_num_rows($picquery);\nif ($numb==0) {\necho \"there is no picture\"; }\nelse {\necho \"&lt;img src=\\\"\".$res['log_filename'].\"\\\" width=\\\"100\\\"&gt;\"; }\n</code></pre>\n\n<p>I don't understand how to return the results as an array, if $res[] returns the results for the first query, then what returns the results for the second one?</p>\n\n<p>or is there a better way to do this entirely?</p>\n\n<p>Thank you</p>\n"},{"tags":["oracle","query","oracle10g","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12727529,"title":"Oracle pivot query results in a \"command not properly ended\" error","body":"<p>When firing the following query to a 10g Oracle database:</p>\n\n<pre><code>    SELECT * FROM (\n        SELECT T1.ID, T2.ACCT_NO, ROW_NUMBER() OVER (PARTITION BY T1.ID ORDER BY T1.ID DESC) AS RRRRRRR \n        FROM TABLE1 T1\n        INNER JOIN TABLE T2 ON T1.ID = T2.ID\n        WHERE T1.ID = 666\n    )\n    PIVOT (MIN(T1.ID) AS ALIAS1 FOR RRRRRRR IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10));\n</code></pre>\n\n<p>I get an \"command not properly ended\" error.\nI've searched for Oracle pivot examples and they all pretty much showed the same example.\nWhat am I missing here?</p>\n"},{"tags":["mysql","query","select","join"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":12726919,"title":"Select from table a where a value from a is on table b mysql","body":"<p>Table a:</p>\n\n<pre><code>field1 field2\nx1     x1\n</code></pre>\n\n<p>Table b:</p>\n\n<pre><code>field 1\nx1\n</code></pre>\n\n<p>How would I select on table b where field1 = to field 1 of table a?</p>\n\n<p>What if the name of table b is field1 of table a, what is the syntax to perform the join as the selected table being a.field1</p>\n\n<p>This is the actual query I am using:</p>\n\n<pre><code>mysql_query(\"SELECT * FROM tags WHERE id3='$value' AND flag!='w' AND visibility='t' JOIN tags.albumid WHERE photoid=tags.photoid AND visibility!='d' ORDER BY datetimep DESC LIMIT 200\");\n</code></pre>\n"},{"tags":["java","query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12725809,"title":"How to create query for embedding object in another embedded object(already embedded object)?","body":"<p>I have added an embedded object in one collection. The object appears as below</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"506d3046a4e89e856eace0cc\"),\n    \"name\": \"new\"\n    \"menuList\":[{\n        \"name\":\"dssdfDS\",\n        \"des\":\"dsfsdf\",\n        \"_id\" : ObjectId(\"506d3046a4d89e856eace0cc\")\n    }]\n}\n</code></pre>\n\n<p>I have created BasicDBObject query to push \"menuList\" to the <strong>\"name\":\"new\"</strong>, I have done this successfully, Now i want to append menuList1 to menuList.</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"506d3046a4e89e856eace0cc\"),\n    \"name\": \"new\"\n    \"menuList\":[{\n        \"name\":\"dssdfDS\",\n        \"des\":\"dsfsdf\",\n        \"_id\" : ObjectId(\"506d3046a4d89e856eace0cc\")\n        \"menuList1\":[{\n            \"name\":\"dssdfDS\",\n            \"des\":\"dsfsdf\",\n            \"_id\" : ObjectId(\"506d3046a4d89e856eace0cc\")\n        }]\n    }]\n}\n</code></pre>\n\n<p>How do I make a <strong>BasicDBObject query</strong> to update <strong>menuList</strong> by pushing <strong>menuList1</strong> inside <strong>menuList</strong>?</p>\n"},{"tags":["sql","query","crystal-reports","report"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12604351,"title":"Crystal Report XI - Conditional Sum Issue","body":"<p>I have a table with data called <code>InvoiceShipments</code>. It continues a row for each product shipped on an invoice. Each product belongs to a product category, which I can query and filter by. Some of the products are finished good products with a <code>Bill of Material</code>, where the <code>Bill of Materials</code> (BOM) is a list of the parts that combine to make the finished good.</p>\n\n<p>In the <code>InvoiceShipments</code> table, the finished good is listed with a price but no cost. It is then followed by the components (BOM) of that finished good, which in turn have a cost but no price. I have a separate table that lists all of the component items and which finished goods it goes to. Note that component goods can belong to more than one BOM.</p>\n\n<p>I can currently filter the <code>InvoiceShipments</code> by the products that I want based on the product category (from a join to a different table). What I want to do is grab that finished good number, and get a list of all the part #s that make up that BOM, then go back to the InvoiceShipments and sum the costs for all of the rows that match those component #s and invoice#. But I haven't been using Crystal long enough to know what to do at the query level, what to do with a command table, what to do with a formula, etc.</p>\n\n<p><a href=\"http://imgur.com/a/RbCpJ\" rel=\"nofollow\">Sample Screenshots:</a></p>\n\n<p>Top table in the gallery is BOM table, second table is the <code>InvoiceShipments</code>, and the third is the desired outcome.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["mysql","query","delete","syntax-error"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12726282,"title":"mysql DELETE syntax error on trivial query","body":"<p>I am running ammps (a wamp version) on win7.\nI have created a DB with phpmyadmin and can manipulate it from there.\nI can query these databases in PHP with mysqli started by apache on an http request.\nSo login to mysql, connect to the DB, locate the table etc, running SELECT queries and INSERT queries OK.\nBut somehow the (trivial) DELETE query fails.\nI have checked the user privileges: but the user has all privileges.\nAlso logging in from the command prompt with mysql as the same user allows\nme te run the delete query; so there must be something wrong in the library,\nwith the query or some kind of permission issue I did not thnink of.</p>\n\n<p>Herewith the lines in the php file:</p>\n\n<pre><code>$result = $vardb-&gt;query(\"DETELE FROM ww1vars WHERE varname='lastName';\") ;\nif ($result=== false) {\n   die('(1)error in accessing ww1vars: '. $vardb-&gt;error) ;\n}\n</code></pre>\n\n<p>Produces this:</p>\n\n<blockquote>\n  <p>(1)error in accessing ww1vars: You have an error in your SQL syntax;\n  check the manual that corresponds to your MySQL server version for the\n  right syntax to use near 'DETELE FROM ww1vars WHERE\n  varname='lastName'' at line 1</p>\n</blockquote>\n\n<p>VERY frustrating!</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12724406,"title":"SQL search and replace advanced","body":"<p>Usually when I search and replace I use this code:</p>\n\n<pre><code>UPDATE wp_posts SET post_content = REPLACE (post_content, 'old string', 'new string');\n</code></pre>\n\n<p>Now I'd like to replace <code>&lt;h1&gt;Title&lt;/h1&gt;</code>with <code>&lt;table&gt;...&lt;h1&gt;Title&lt;/h1&gt;...&lt;/table&gt;</code></p>\n\n<p>Problem is of course that the text in between  tags is different for all pages (it is a wordpress homepage).</p>\n\n<p>Any ideas on how to solve this? Is it possible?</p>\n"},{"tags":["php","query","yii"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":12730,"score":5,"question_id":4021890,"title":"How to make criteria with complex query in Yii framework?","body":"<p>I have query like this:</p>\n\n<pre><code>SELECT * FROM activity\nWHERE (((userId = 1 OR userId IN(SELECT userId FROM follower WHERE followerId = 1))\nAND activityType IN(1, 2, 3))\nOR (targetId = 24 AND aType IN(1, 2, 3, 4, 5)))\nORDER BY id DESC;\n</code></pre>\n\n<p>I have try to use <code>model()-&gt;findAllBySql($sql)</code> and it works. But I want to make it using <code>CDbCriteria</code>, if you have another solutions let me know it :D</p>\n"},{"tags":["sql","database","query","date"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12720589,"title":"Sql query issue with date","body":"<p>I have a database as attached, in which i have a BirthDate column which is split into BirthYear, BirthMonth and BirthDayNumber.</p>\n\n<p><img src=\"http://i.stack.imgur.com/WBjaM.png\" alt=\"Database Image\"></p>\n\n<p>eg. For BirthDate:</p>\n\n<pre><code>Wednesday, May 10, 1899\n\nBirthYear:1899\nBirthMonth : 5\nBirthDayNumber :10\n</code></pre>\n\n<p>I want to sort the database in the following format( the month and date should be in ascending order and in case if the month and date are equal then it should sort the year in descending order)</p>\n\n<pre><code>01 January 2011 \n02 January 2012 \n02 January 2008 \n05 August 2012 \n06 September 2001 \n12 December 1899 \n</code></pre>\n\n<p>Can you please help me out with the query for displaying the list in this format. </p>\n"},{"tags":["sql","database","query","sqlite","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":246,"score":1,"question_id":10603080,"title":"how to use like operator for complex query in sqlite","body":"<p>Hi all i have the following table called student in SQLite database.</p>\n\n<p>this is my table structure </p>\n\n<pre><code>id       name\n-----------------------\n\n\"3\"  \"Babu Qw\"  \n\"2\"  \"Ganesh Babu\"  \n\"1\"  \"Murali  Abb\"  \n\"4\"  \"ganesh1 Babu\"             \n\"5\"  \"hari murali\"              \n\"10\" \"Abbash abc\"   \n</code></pre>\n\n<p>name field is combined by first name and last name. for example \"Babu Qw\"  Babu is the first name and Qw is the last name its separated by a space.</p>\n\n<p>and name is the input field where 'ba' is my input parameter.(<strong>Ex .. name like 'ba'</strong>)</p>\n\n<p>now i want to fetch the records whatever name <strong>(first name or last name )</strong> starts with 'ba' not by any middle character.</p>\n\n<p>output would be:</p>\n\n<pre><code>id       name\n-----------------------\n\n\"3\"  \"Babu Qw\"  \n\"2\"  \"Ganesh Babu\"  \n\"4\"  \"ganesh1 Babu\" \n</code></pre>\n\n<p>here \"Abbash abc\" (first name Abbash or last name abc does not starts with ba) so that \"Abbash abc\" not listed.</p>\n"},{"tags":["sql","database","query","networking","social-networking"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12712963,"title":"SQL Query for network information","body":"<p>I have a network with 14 nodes. (say 1 -14)\nI am not sure how to show the network, but I can provide the database table which has the network information. The network information is as follows: </p>\n\n<pre>\nNodes   Connected to the nodes\n1            2,5\n2           1,3,4,5\n3            2,4\n4           2,3,5\n5           1,2,4\n6           5,11,12\n7           4,8,9\n8             7\n9           4,7,10,14\n10            9,11\n11            6,10\n12            6,13\n13           12,14\n14           9,13\n</pre>\n\n<p>Now, in this case I need the information of all nodes present 2 hops away from node-8(say suppose)</p>\n\n<pre>\nnode 8 - node 7(First Hop)\nnode 7 - node 4,8,9(Second Hop)\n</pre>\n\n<p>So, the solution is \" node4 and node9 are 2 hops away from node8.</p>\n\n<p>Is there a SQL Query that would help in resolving this? It may not just be 2 hops all the time. Given a question as 3 hops, we need to further our step as:</p>\n\n<p>node4,8,9 is connected to  2,3,5,7,4,10,14</p>\n\n<p>So, the solution is 2,3,5,7,10,14 (we excluded 4 because it is already 2 hops away from node8, we would consider shortest path) are 3 hops away from node8.</p>\n\n<p>Is there a SQL query that could handle this situation for the above table?\nPlease let me know if I am not clear about anything?</p>\n"},{"tags":["c#","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12720594,"title":"Get Foreign keys in the table","body":"<p>I created one script to display the foreign keys in the particular table.</p>\n\n<pre><code>SELECT  i.CONSTRAINT_NAME FROM information_schema.TABLE_CONSTRAINTS i\nLEFT JOIN information_schema.KEY_COLUMN_USAGE k ON\ni.CONSTRAINT_NAME = k.CONSTRAINT_NAME WHERE i.CONSTRAINT_TYPE = 'FOREIGN KEY'\nAND i.TABLE_NAME = 'sample';\n</code></pre>\n\n<p>When I execute this command in my host, it displays the list of foreign key constraints found in all the databases with <code>table</code> name <code>\"sample\"</code>.</p>\n\n<p>But i need particular database, sample table <code>foreign keys</code>.</p>\n"},{"tags":["query","hadoop","pig"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":12700003,"title":"How should I select top 10% of the table?","body":"<p>I need the select the top x% rows of a table in Pig. Could someone tell me how to do it without writing a UDF?</p>\n\n<p>Thanks!</p>\n"},{"tags":["hibernate","query","named"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":840,"score":0,"question_id":10812073,"title":"Error in named query (QuerySyntaxException: unexpected token)","body":"<p>I am currently working on a utility project which will help me to manage the users of an application (a user has one or more role, and a role has one or more rights).\nI am new to Hibernate, and I don't know why I have encountered the following issue :</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>ERROR [hibernate.internal.SessionFactoryImpl] HHH000177: Error in named query: right.findAllByRoleId\norg.hibernate.hql.internal.ast.QuerySyntaxException: unexpected token: right near line 1, column 8 [select right from com.google.code.jee.utils.user.management.model.Role as r left join r.rights as right where r.id = :roleId]\n    at org.hibernate.hql.internal.ast.QuerySyntaxException.convert(QuerySyntaxException.java:54)\n    at org.hibernate.hql.internal.ast.QuerySyntaxException.convert(QuerySyntaxException.java:47)\n    at org.hibernate.hql.internal.ast.ErrorCounter.throwQueryException(ErrorCounter.java:79)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.parse(QueryTranslatorImpl.java:276)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:180)\n    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)\n    at org.hibernate.engine.query.spi.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:106)\n    at org.hibernate.engine.query.spi.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:81)\n    at org.hibernate.engine.query.spi.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:167)\n    at org.hibernate.internal.SessionFactoryImpl.checkNamedQueries(SessionFactoryImpl.java:1130)\n    at org.hibernate.internal.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:523)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1740)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1778)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:189)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:350)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:335)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)\n    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)\n    at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:139)\n    at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:83)\n    at Demo.main(Demo.java:9)\n</code></pre>\n\n<p>Right class :</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Table(name = \"RIG_RIGHT\")\n@NamedQueries({\n    @NamedQuery(name = RightDao.COUNT_BY_NAME, query = \"select count(*) from Right as rig where rig.name = :name\"),\n    @NamedQuery(name = RightDao.FIND_BY_NAME, query = \"from Right as rig where rig.name = :name\"),\n    @NamedQuery(name = RightDao.COUNT_FOR_ROLE_ID, query = \"select count(*) from Role as r where r.id = :id\"),\n    @NamedQuery(name = RightDao.FIND_ALL_BY_ROLE_ID, query = \"select right from Role as r left join r.rights as right where r.id = :roleId\"),\n    @NamedQuery(name = RightDao.COUNT_FOR_ROLE_ID_AND_NAME, query = \"select count(*) from Role as r left join r.rights as right where r.id = :roleId and right.name = :rightName\"),\n    @NamedQuery(name = RightDao.FIND_BY_ROLE_ID_AND_NAME, query = \"select right from Role as r left join r.rights as right where r.id = :roleId and right.name = :rightName\") })\n@SuppressWarnings(\"serial\")\npublic class Right extends AbstractHibernateDto&lt;Integer&gt; {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"RIG_ID\", nullable = false)\n    private Integer id;\n\n    @Column(name = \"RIG_NAME\", nullable = false, unique = true, length = 50)\n    private String name;\n\n       // Getters &amp; Setters\n</code></pre>\n\n<p>Role class :</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Table(name = \"ROL_ROLE\")\n@NamedQueries({\n    @NamedQuery(name = RoleDao.COUNT_BY_NAME, query = \"select count(*) from Role as r where r.name = :name\"),\n    @NamedQuery(name = RoleDao.FIND_BY_NAME, query = \"from Role as r where r.name = :name\"),\n    @NamedQuery(name = RoleDao.COUNT_FOR_USER_ID, query = \"select count(*) from User as u where u.id = :id\"),\n    @NamedQuery(name = RoleDao.FIND_ALL_BY_USER_ID, query = \"select role from User as u left join u.roles as role where u.id = :userId\"),\n    @NamedQuery(name = RoleDao.COUNT_FOR_USER_ID_AND_NAME, query = \"select count(*) from User as u left join u.roles as role where u.id = :userId and role.name = :roleName\"),\n    @NamedQuery(name = RoleDao.FIND_BY_USER_ID_AND_NAME, query = \"select role from User as u left join u.roles as role where u.id = :userId and role.name = :roleName\") })\n@SuppressWarnings(\"serial\")\npublic class Role extends AbstractHibernateDto&lt;Integer&gt; {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"ROL_ID\", nullable = false)\n    private Integer id;\n\n    @Column(name = \"ROL_NAME\", nullable = false, unique = true, length = 50)\n    private String name;\n\n    @OneToMany(cascade = { CascadeType.ALL }, fetch = FetchType.LAZY)\n    @JoinColumn(name = \"RIG_ROLE_ID\", nullable = false)\n    private List&lt;Right&gt; rights;\n\n    // Getters &amp; Setters\n</code></pre>\n\n<p>Right DAO :</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public interface RightDao extends GenericDao&lt;Integer, Right&gt; {\n\n    public final String COUNT_BY_NAME = \"right.countByName\";\n    public final String FIND_BY_NAME = \"right.findByName\";\n    public final String COUNT_FOR_ROLE_ID = \"right.countForRoleId\";\n    public final String FIND_ALL_BY_ROLE_ID = \"right.findAllByRoleId\";\n    public final String COUNT_FOR_ROLE_ID_AND_NAME = \"right.countForRoleIdAndName\";\n    public final String FIND_BY_ROLE_ID_AND_NAME = \"right.findByRoleIdAndName\";\n\n    /**\n     * Search the number of elements with the 'name' parameter.\n     * \n     * @param name the name\n     * @return the number of element found\n     */\n    public Integer countByName(String name);\n\n    /**\n     * Search an element by its name.\n     * \n     * @param name the name\n     * @return the right\n     */\n    public Right findByName(String name);\n\n    /**\n     * Count the number of rights of a specific role\n     * \n     * @param roleId the role id\n     * @return the number of rights\n     */\n    public Integer countForRoleId(Integer roleId);\n\n    /**\n     * Finds all rights by roleId.\n     * \n     * @param roleId the role primary key\n     * @return the list\n     */\n    public List&lt;Right&gt; findAllByRoleId(Integer roleId);\n\n    /**\n     * Count the number of rights with a specific name and corresponding to\n     * a specific role\n     * \n     * @param roleId the roleId\n     * @param rightName the right name\n     * @return the number of rights\n     */\n    public Integer countForRoleIdAndName(Integer roleId, String rightName);\n\n    /**\n     * Finds the right.\n     * \n     * @param roleId the role primary key\n     * @param rightName the right name\n     * @return the right\n     */\n    public Right findByRoleIdAndName(Integer roleId, String rightName);\n\n}\n</code></pre>\n\n<p>Role DAO :</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public interface RoleDao extends GenericDao&lt;Integer, Role&gt; {\n\n    public final String COUNT_BY_NAME = \"role.countByName\";\n    public final String FIND_BY_NAME = \"role.findByName\";\n    public final String COUNT_FOR_USER_ID = \"role.countForUserId\";\n    public final String FIND_ALL_BY_USER_ID = \"role.findAllByUserId\";\n    public final String COUNT_FOR_USER_ID_AND_NAME = \"role.countForUserIdAndName\";\n    public final String FIND_BY_USER_ID_AND_NAME = \"role.findByUserIdAndName\";\n\n    /**\n     * Search the number of elements with the 'name' parameter.\n     * \n     * @param name the name\n     * @return the number of element found\n     */\n    public Integer countByName(String name);\n\n    /**\n     * Search an element by its name.\n     * \n     * @param name the name\n     * @return the user\n     */\n    public Role findByName(String name);\n\n    /**\n     * Count the number of roles of a specific user\n     * \n     * @param userId the user id\n     * @return the number of roles\n     */\n    public Integer countForUserId(Integer userId);\n\n    /**\n     * Finds all roles by user id.\n     * \n     * @param userId the user primary key\n     * @return the list\n     */\n    public List&lt;Role&gt; findAllByUserId(Integer userId);\n\n    /**\n     * Count the number of roles with a specific name and corresponding to\n     * a specific user\n     * \n     * @param userId the userId\n     * @param roleName the role name\n     * @return the number of roles\n     */\n    public Integer countForUserIdAndName(Integer userId, String roleName);\n\n    /**\n     * Finds the role.\n     * \n     * @param userId the user primary key\n     * @param roleName the role name\n     * @return the role\n     */\n    public Role findByUserIdAndName(Integer userId, String roleName);\n\n}\n</code></pre>\n\n<p>Any idea ? Thank you in advance !<br>\nJulien Neuhart</p>\n"},{"tags":["javascript","database","query","codeigniter"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12717273,"title":"Code Ignitor displaying one record from database","body":"<p>Can someone please help me with displaying one record from a database. So basically i have a page that has a list of records and a link for each record that says vote. When i click on the vote link for a particular record, I want it to display only that record. How would i do this?</p>\n\n<p>THankyou</p>\n\n<p>My code for displaying all the records in the view is:</p>\n\n<pre><code>&lt;h2&gt;List of all polls in this site:&lt;/h2&gt;\n&lt;?php echo '&lt;table&gt;';?&gt;\n&lt;h3&gt;Title&lt;/h3&gt;\n&lt;?php foreach ($polls as $polls_item): ?&gt;\n\n  &lt;tr&gt;&lt;td&gt;&lt;a href=\"http://studweb.cosc.canterbury.ac.nz/~njp63/365/polls/index.php/user\"&gt;Vote&lt;/a&gt;\n\n&lt;?php \n\n    echo $polls_item['title'] . \"&lt;/td&gt;\";?&gt;\n    &lt;div id=\"main\"&gt;\n        &lt;?php echo \"&lt;td&gt;\" .  $polls_item['text'] . \"&lt;/td&gt;\";\n\n?&gt;\n    &lt;/div&gt;\n   &lt;td&gt;&lt;a href=\"#\"&gt;Delete&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n\n\n&lt;?php endforeach ?&gt;\n&lt;?php echo \"&lt;/table&gt;\"; ?&gt;\n</code></pre>\n\n<p>My model:</p>\n\n<p>\n\n<pre><code>public function __construct()\n{\n    $this-&gt;load-&gt;database();\n    $this-&gt;load-&gt;helper('url');\n}\n\npublic function get_polls($slug = FALSE)\n{\n    if ($slug === FALSE)\n    {\n        $query = $this-&gt;db-&gt;get('polls');\n        return $query-&gt;result_array();\n    }\n\n    $query = $this-&gt;db-&gt;get_where('polls', array('slug' =&gt; $slug));\n    return $query-&gt;row_array();\n}\n\npublic function set_polls($title, $text)\n{\n\n    $slug = url_title($this-&gt;input-&gt;post($title), 'dash', TRUE);\n\n    $data = array(\n        //'title' =&gt; $this-&gt;input-&gt;post('title'),\n        //'slug' =&gt; $slug,\n        //'text' =&gt; $this-&gt;input-&gt;post('text')\n\n        'title' =&gt; $title,\n        'slug' =&gt; $slug,\n        'text' =&gt; $text\n    );\n\n    $this-&gt;db-&gt;insert('polls', $data);\n    return $this-&gt;db-&gt;insert_id();\n\n}\n\npublic function set_options($option, $pollid)\n{\n\n    $values = $option;\n\n    foreach ($values as $option){\n\n        $options = array(\n            'option_item' =&gt; $option,\n            'poll_id' =&gt; $pollid\n        );\n        $this-&gt;db-&gt;insert('pollOption', $options);\n    }\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>My controller:</p>\n\n<pre><code>&lt;?php\n\n// Debugging\nerror_reporting(E_ALL);\nini_set('display_error', '1');\n\nclass User extends CI_Controller {\n\n    public function __construct()\n    {\n        parent::__construct();\n        $this-&gt;load-&gt;model('polls_model');\n    }\n\n    public function index()\n    {\n        $data['polls'] = $this-&gt;polls_model-&gt;get_polls();\n        $this-&gt;load-&gt;helper('html');\n        $data['content'] = $this-&gt;load-&gt;view('user/index', $data, TRUE);\n        $data['title'] = 'Polls archive';\n        $this-&gt;load-&gt;view('templates/master', $data);\n\n    }\n\n    public function view($slug)\n    {\n        $data['polls_item'] = $this-&gt;polls_model-&gt;get_polls($slug);\n\n        if (empty($data['polls_item']))\n        {\n            show_404();\n        }\n\n        $this-&gt;load-&gt;helper('html');\n        $data['content'] = $this-&gt;load-&gt;view('user/view', $data, TRUE);\n        $data['title'] = $data['polls_item']['title'];\n        $this-&gt;load-&gt;view('templates/master', $data);\n\n    }\n}\n</code></pre>\n"},{"tags":["sql","query","sql-update"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":8427,"score":3,"question_id":1158094,"title":"How to update a column adding 1 to the current value","body":"<p>I can't do a relative simple update query in access or sql server. \nMy simple task is: adding 1 to the current value of a column. </p>\n\n<p>I'm using this syntax: </p>\n\n<pre><code>UPDATE MyTable SET ColumnA = ColumnA + 1 WHERE MyPrimaryKey= 100\n</code></pre>\n\n<p>But it does't work.</p>\n\n<p>Someone can help me ? </p>\n\n<p>Thanks bye!</p>\n"},{"tags":["mysql","query","automation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12719488,"title":"Complex sql query: grab multiple IDs from tableOne based on field from tableTwo, update into tableTwo","body":"<p>in a quandary here..</p>\n\n<p>I've got one table, let's call it bookshelves. The table has these fields:</p>\n\n<p>[shelf_id, title, latest_books]</p>\n\n<p>Then I've got a table for books with the fields:</p>\n\n<p>[book_id, shelf_id, title, date_added]</p>\n\n<p>Each book is assigned to a shelf. Here's what I want to do...</p>\n\n<p>for every bookshelf, look in books for books assigned to that bookshelf, grab the book_id from those books and feed them into the bookshelves field 'latest_books' separated by commas. To complicate things further(?) I only want five book_id's per shelf. I could do with just one from each if that made it easier..here's the query I can use to manually do this one by one:</p>\n\n<pre><code>update bookshelves\nset latest_books = \n    (select book_id from books \n        where shelf_id = 1 \n        order by date_added DESC \n        limit 0,1)\nwhere shelf_id = 1;\n</code></pre>\n\n<p>Both the bookshelves and books tables have tens of thousands of records so..I can do it one by one but I'll be at it all year.</p>\n\n<p>I'm working in MySQL on CentOS. I'm cool using scripting or whatever.</p>\n"},{"tags":["database","query","codeigniter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12719517,"title":"Getting ID from database and into the URI","body":"<p>I would like to get the ID of a value from a database and use it to delete an item.\nHeres my code:</p>\n\n<p>This code currently gets a set of records from a database, where each record has links. How can I do this?</p>\n\n<pre><code>&lt;h2&gt;List of all polls in this site:&lt;/h2&gt;\n&lt;?php echo '&lt;table&gt;';?&gt;\n&lt;table border=\"1\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Title&lt;/th&gt;\n    &lt;th&gt;Text&lt;/th&gt;    \n\n    &lt;th colspan=\"2\"&gt;Action&lt;/th&gt;        \n  &lt;/tr&gt;\n&lt;?php \nforeach($polls as $polls_item){\n  echo \"&lt;tr&gt;\";\n    echo \"&lt;td&gt;\". $polls_item['title'] .\"&lt;/td&gt;\";\n    echo \"&lt;td&gt;\". $polls_item['text'] .\"&lt;/td&gt;\";\n    echo \"&lt;td&gt;\". anchor('user/vote/'.$polls_item-&gt;id,'Vote') .\"&lt;/td&gt;\";\n    echo \"&lt;td&gt;\". anchor('admin/del/'.$polls_item-&gt;id,'Delete') .\"&lt;/td&gt;\";        \n  echo \"&lt;/tr&gt;\"; \n}\n?&gt;\n\n&lt;?php echo anchor('admin/del/1','Delete'); ?&gt;\n\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12719349,"title":"Query with Set operation rather than while loop","body":"<p>I am not very good at Set queries and need some help!\nI have a table containing 4 columns:</p>\n\n<p>UserId uniqueidentifier<br>\nDeviceSystemId uniqueidentifier<br>\nStartCount bigint<br>\nEndCount bigint</p>\n\n<p>I have a stored procedure to insert/update row in this table that represents an island (but may not be 100% - if count is smaller on subsequent invoke).</p>\n\n<p>First invoke has the countList = (4,5,6), the sproc inserts a row with StartCount=4, EndTime=6</p>\n\n<p>Next invoke has the countList =(3,5,6, 7,15,16,17), the sproc inserts 2 rows:<br>\n1. One row with StartCount=3, EndCount=3.<br>\n2. One row with StartCount=15, EndCount=17.<br>\n3. And update 1st row’s EndCount where StartCount=4, EndCount=7</p>\n\n<p>The stored procedure works with a while loop.  I want to use Set query.  How do I do that ?</p>\n\n<p>Here is the stored procedure:</p>\n\n<pre><code>`ALTER PROC [dbo].[DeviceValueCount_Store]  \n    @userId uniqueidentifier,     \n@deviceSystemId uniqueidentifier   \n@countList dbo.bigintTable readonly  -- in ascending order   \nAS   \nBEGIN   \nDECLARE @returnValue int = 0;   \n\nDECLARE @copyCountList dbo.bigintTable;   \n\nINSERT INTO @copyCountList  -- so it can be deleted by row   \nSELECT * FROM @countList;   \n\n-- Process one count value at a time because the check would be accurate for the first value only.   \n-- If the value is 1 bigger than an endValue (in sequence), replace the EndCount with new value;   \n-- otherwise, insert a new row with the value.   \n\nDECLARE @newCount BIGINT = 0;   \nWHILE (SELECT COUNT(*) FROM @copyCountList) &gt; 0   \nBEGIN         \nSELECT TOP 1 @newCount = BigintColumn  FROM @copyCountList  \nDELETE FROM @copyCountList WHERE BigintColumn = @newCount;  \n\n-- Skip count value already in stored intervals  \nIF EXISTS (  \n    SELECT 1  \n    FROM @countList C  \n    JOIN _Upload.DeviceValueCount_ D  \n        ON D.UserId = @userId  \n        AND D.DeviceSystemId = @deviceSystemId  \n        AND C.BigintColumn BETWEEN D.StartCount AND D.EndCount  \n        AND C.BigintColumn = @newCount)  \n    CONTINUE;  \n\nMERGE _Upload.DeviceValueCount_ WITH (HOLDLOCK, TABLOCK) AS T  \nUSING (SELECT @userId AS UserId, @deviceSystemId AS DeviceSystemId,    @newCount AS NewCount)   \nAS S   \nON (T.UserId = S.UserId   \nAND T.DeviceSystemId = S.DeviceSystemId   \nAND T.EndCount = S.NewCount-1)   \nWHEN NOT MATCHED BY TARGET THEN   \n    INSERT (UserId, DeviceSystemId, StartCount, EndCount)   \n    VALUES (UserId, DeviceSystemId, S.NewCount, S.NewCount)   \nWHEN MATCHED THEN       \n    UPDATE SET T.EndCount = S.NewCount   \n;   \nEND   \nEND    \n`\n</code></pre>\n"},{"tags":["wordpress","query","sorting","multiple","meta-key"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":12717408,"title":"WP_Query - filter by multiple meta values and order by other meta values","body":"<p>I'm trying to query posts using WP_Query and meta_query parameters:</p>\n\n<pre><code>$args = array(\n    'post_type' =&gt; 'produkty',\n    'meta_query' =&gt; array(\n            'relation' =&gt; 'AND',\n            array(\n                    'key' =&gt; 'produkt_aktywny',\n                    'value' =&gt; '1',\n                    'compare' =&gt; '='),\n            array(\n                    'key' =&gt; 'produkt_dostepnosc',\n                    'value' =&gt; '1',\n                    'compare' =&gt; '=')\n            )\n);\n$query = new WP_Query( $args );\n</code></pre>\n\n<p>What should I add to order the results by two other keys ('produkt_kategoria' and 'produkt_cena')? There's nothing about it in WP Codex, but this: </p>\n\n<pre><code>\"Do you know how to sort the query if the meta_value is an array? Write it here :)\" \n</code></pre>\n\n<p>According to this, I believe sorting by multiple meta values is possible.</p>\n"},{"tags":["ruby-on-rails","query","activerecord","boolean"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12717613,"title":"ActiveRecord query for FALSE attributes","body":"<p>I'm not sure what the correct terminology is so my Googling didn't help much.</p>\n\n<p>But anyways, ActiveRecord allows you to search all records with a boolean attribute TRUE with something like this:</p>\n\n<pre><code>@current_events = Event.current\n</code></pre>\n\n<p>So all events with attribute \"current\" equals TRUE is returned.</p>\n\n<p>Is there a nifty ActiveRecord method to return all that is FALSE?  Maybe something like:</p>\n\n<pre><code>@outdated_events = Event.not_current\n</code></pre>\n\n<p>?</p>\n\n<p>If not, then I can just use the \"where\" method.  But I was just curious.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","jquery","forms","query","url"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12717529,"title":"How to generate a query string (url) from a form, php or jquery?","body":"<p>I'm trying to generate a specific url from the form below.\nThere will be a calendar and the date will go into the url.\nAlso a value from 9 ticket types and quantities of each of those tickets.\nSo my url will look something like this</p>\n\n<p><a href=\"https://sales.site.com/?action=quicksale&amp;venueid=1&amp;businessdate=2012-10-05&amp;ticketids=6,8&amp;quantities=1,1\" rel=\"nofollow\">https://sales.site.com/?action=quicksale&amp;venueid=1&amp;businessdate=2012-10-05&amp;ticketids=6,8&amp;quantities=1,1</a></p>\n\n<p>With these values:\naction: always \"quicksale\",\nvenueid: always \"1\",\nbusinessdate: the sales date requested; can be either mm-dd-yyyy or yyyy-mm-dd,\nticketids: see chart below,\nquantities: in the order the ticketid's are listed.</p>\n\n<p>How would I approach this, and should I use php or jquery? Post or Get.\nShould the calendar be Jquery?</p>\n\n<p>Looking for advice, thanks</p>\n\n<pre><code>                        &lt;form method=\"post\" action=\"\"&gt;--&gt;\n            &lt;div class=\"quick-book-form-elements\"&gt;\n                &lt;table width=\"255\" class=\"quick-book-table\" cellpadding=\"4\"&gt;\n                    &lt;tbody&gt;\n                        &lt;tr class=\"quick-book-days\"&gt;\n                            &lt;th&gt;&amp;nbsp;&lt;/th&gt;\n                            &lt;th&gt;&lt;img src=\"../public/img/1day-small.png\" alt=\"\" /&gt;&lt;/th&gt;\n                            &lt;th&gt;&lt;img src=\"../public/img/2day-small.png\" alt=\"\" /&gt;&lt;/th&gt;\n                            &lt;th class=\"quick-book-last\"&gt;&lt;img src=\"../public/img/3day-small.png\" alt=\"\" /&gt;&lt;/th&gt;\n                        &lt;/tr&gt;\n\n                        &lt;tr class=\"quick-book-adults\"&gt;\n                            &lt;th class=\"quick-book-labels\"&gt;\n                                Adult\n                            &lt;/th&gt;\n                            &lt;td&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$40/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n\n                            &lt;td&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$50/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                            &lt;td class=\"quick-book-last\"&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$60/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                        &lt;/tr&gt;\n\n                        &lt;tr class=\"quick-book-child\"&gt;\n                            &lt;th class=\"quick-book-labels\"&gt;Child&lt;/th&gt;\n                            &lt;td&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$30/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$40/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                            &lt;td class=\"quick-book-last\"&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$50/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                        &lt;/tr&gt;\n\n                        &lt;tr class=\"quick-book-family\"&gt;\n                            &lt;th class=\"quick-book-labels\"&gt;Family&lt;/th&gt;\n                            &lt;td&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$125/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$155/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                            &lt;td class=\"quick-book-last\"&gt;\n                                &lt;div class=\"ticket-style-quick-book\"&gt;\n                                    &lt;select class=\"adult-ticket-select\"&gt;\n                                        &lt;option value=\"0\"&gt;0&lt;/option&gt;\n                                        &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                                    &lt;/select&gt;\n                                    &lt;span class=\"quick-book-price\"&gt;$185/ea&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                        &lt;/tr&gt;\n                    &lt;/tbody&gt;\n                &lt;/table&gt;\n            &lt;/div&gt;\n        &lt;a href=\"http://sales.site.com/\" title=\"\" class=\"quick-book-submit-btn\"&gt;&lt;/a&gt;\n        &lt;input type=\"submit\" class=\"quick-book-submit-btn\" name=\"quick-book-submit-btn\" value=\"\" /&gt;\n    &lt;/form&gt;\n&lt;/div&gt;&lt;!-- end quick-book-form div --&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["mysql","query","select","rows"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12717372,"title":"Mysql: Need help by selecting every nth row","body":"<p>Im searching for a way for selecting every row whichs id ends with f.e. \"4\". The search result should contain only following rows \"4,14,24,34,44,54,64 etc...\"</p>\n\n<p>Is this possible in MYSQL?  </p>\n"},{"tags":["query","hibernate","polymorphism","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12715145,"title":"hql on subclass property","body":"<p>I have a class A and sub-classes B and C which have different properties.\nHow can I do something like:\na from A a where ( a.class = B and a.specific-property-of-b = \"y\") or (a.class = C and a.specific-property-of-c =\"z\")</p>\n\n<p>Is it possible to get hibernate understand that when it's an instance of a certain class then it can access the specific properties of it or is it impossible to do something like that and I have to do:</p>\n\n<p>a from A a where a.id in (select b.id from B b where b.specific-property-of-b = \"y\")\n or a.id in (select c.id from C c where c.specific-property-of-c = \"z\")</p>\n\n<p>Thank you</p>\n"},{"tags":["php","mysql","sql","database","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":8,"view_count":78,"score":-8,"question_id":12715141,"title":"PHP MYSQL Update or Insert Query","body":"<p>So let's say I have a column named type. It can have three values, x y or z.</p>\n\n<p>So when a user does something they can change this type to any value at any time. So for my query code can I just use insert to just replace the old value with the new or do i <strong>have</strong> to use update?</p>\n"},{"tags":["sql","query","sqlite","insert","primary-key"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12714014,"title":"How does SQL check if a record exists?","body":"<p>I have a SQLite database and am using the <code>INSERT OR IGNORE</code> query. I have a table with an autoincrementing int as the primary key and also another unique column. My question is, how does SQLite check if the record already exists, so that it knows whether or not to ignore it? Does it scan the primary keys first and then any other unique columns? If so, it it possible for it to compare the unique column before the primary key for some queries? Also if a column is unique, is it already indexed? </p>\n"},{"tags":["sql","xml","query","sql-server-2005","xml-parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":12713871,"title":"How to read a xml in SQL Server 2005?","body":"<p>I have this query</p>\n\n<pre><code>WITH XMLNAMESPACES (DEFAULT 'http://www.w3.org/2005/Atom') \nselect \ncast(idsku as int) idsku,\ncast(entregado as int) entregado from #final1 final FOR XML AUTO, ROOT ('clientesxml'), ELEMENTS \n</code></pre>\n\n<p>this return  </p>\n\n<pre><code>&lt;clientesxml xmlns=\"http://www.w3.org/2005/Atom\"&gt;\n  &lt;final&gt;\n    &lt;idsku&gt;191&lt;/idsku&gt;\n    &lt;entregado&gt;159&lt;/entregado&gt;\n  &lt;/final&gt;\n&lt;/clientesxml&gt;\n</code></pre>\n\n<p>My question how do I create a stored procedure which reads the XML returned and converts it into a <code>#tempTable</code> ?</p>\n"},{"tags":["java","android","query","deprecated"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12714701,"title":"Deprecated ManagedQuery() issue","body":"<p>I have this method:</p>\n\n<pre><code>public String getRealPathFromURI(Uri contentUri) {\n    String[] proj = { MediaStore.Images.Media.DATA };\n    Cursor cursor = managedQuery(contentUri, proj, null, null, null);\n    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);\n    cursor.moveToFirst();\n    return cursor.getString(column_index);\n}\n</code></pre>\n\n<p>Unfortunately the compiler show me a problem on:</p>\n\n<pre><code>Cursor cursor = managedQuery(contentUri, proj, null, null, null);\n</code></pre>\n\n<p>Because <code>managedQuery()</code> is deprecated.</p>\n\n<p>How could I rewrite this method without use <code>managedQuery()</code>?</p>\n"},{"tags":["python","mysql","json","query","twitter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12714753,"title":"Convert JSON data into MySQL","body":"<p>I crawl twitter data for my search purpose and it give me result in form of JSON and now I want to convert it/ transfer it in MySQL using python in form of tables because further I want to put queries on it. Can anyone please give me a clue or better suggestion.</p>\n"},{"tags":["performance","oracle","query","partitioning"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12711094,"title":"Performance tuning - Query on partitioned vs non-partitioned table","body":"<p>I have two queries, one of which involves a partitioned table in the query while the other query is the same except that it involves the non-partitioned equivalent table. The original (non-partitioned table) query is performing better than the partitioned counter-part. I am not sure how to isolate the problem for this. Looking at the execution plan, I find that the indexes used are the same b/w the two queries and that the new query shows the PARTITION RANGE clause in its execution plan meaning that partition pruning is taking place. The query is of the following form:-</p>\n\n<pre><code>Select rownum, &lt;some columns&gt; \nfrom partTabA \ninner join tabB on condition1\ninner join tabC on condition2\nwhere partTabA.column1=&lt;value&gt; and &lt;other conditions&gt;\nand partTabA.column2 in (select columns from tabD where conditions) \n</code></pre>\n\n<p>where partTabA is the partitioned table and partTabA.column1 is the partitioning key(range partition). In the original query, this gets replaced by the non-partitioned equivalent of the same table. What parameters should I look at to find out why the new query performs badly. Tool that I have is Oracle SQL Developer.</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12713468,"title":"Can SQL determine which values from a set of possible column values do not exist?","body":"<p>I have a unique column.  I also have a known set of elements that are possible values for the column.  I need to know which of the possible values are not already in the table, and as such, are suitable for insertion.</p>\n\n<p>Is this possible with SQL or is post processing required?</p>\n\n<p>Currently, I am using the \"in\" operator to select all rows where the column value equals an element in my set.  Then I remove all matched elements from my set via post processing.</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12709573,"title":"Problems extracting statistics from a MySQL table","body":"<p>I have a problem creating some statistics for a conference where all visitors where scanned every time they entered and left the building.\nI used mySQL and 'stats' table looks like this:</p>\n\n<pre><code>id(int) | accesscode(text) | in(datetime) | out(datetime)\n</code></pre>\n\n<p>And contains stats from 3 different days in the same table.\nI want to get the statistics like this:</p>\n\n<pre><code>accesscode(text) first_entry(datetime) last_exit(datetime) no_of_exits(int) time_in day(int ex:1,2,3) \n</code></pre>\n\n<p>This will result in three entries for each accesscode defined by day.</p>\n\n<p>I tried several times but actually I have no clue how to do this. </p>\n"},{"tags":["query","mdx"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":365,"score":0,"question_id":11230110,"title":"MDX: How can I get MIN and MAX values for dimension members in a set that uses NON EMPTY","body":"<p>I have a problem where I need to get the high and low values for a set from the dimension members (not the measures) for a specific intersection (one customer and time period). We need to reference these for report parameters downstream.  I can only find examples for pulling the min and max measures.  I need the actualy dimension values.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks,</p>\n\n<p>Greg</p>\n"},{"tags":["mysql","query","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":12712647,"title":"When compiling a list of MySQL rows to exclude: to Pre-Compile or not to Pre-Compile?","body":"<p>On one of my PHP sites, I need to offer my Users the ability to select certain rows to exclude from all search results (queries) on the site.</p>\n\n<p>Which way should I go about handling the exclusions, should I:</p>\n\n<p>1) Pre-compile that list of excluded rows whenever the user logs in (or updates it) by querying it, save the list in a Session variable, and then simply add <code>$query .= \" AND userid NOT IN ({$_SESSION['ExclusionList']})\"</code> to every search query on the site,</p>\n\n<p>or</p>\n\n<p>2) Compile it always on-the-fly directly in each query by simply adding  <code>$query .= \" AND userid NOT IN (SELECT userid FROM Excluded WHERE excludedBy = '$currentUserID')\"</code> to every search query on the site?</p>\n\n<p>Method 1) seems more efficient since I'm only compiling the list once when the user logs in (or whenever they update it), rather than having to essentially compile the list every time any user runs a search query on the site.</p>\n\n<p>What do you suggest and why?</p>\n"},{"tags":["php","mysql","database","arrays","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12646374,"title":"How do I echo out a name -only if- specific rows in one table match specific rows in another based on an id?","body":"<p>Here's my problem: I'm making a crafting system for a game, and I already have my database filled with information for resources required to craft items.</p>\n\n<p>Here are what my relevant tables look like:</p>\n\n<blockquote>\n<pre><code>table #edible_resources\n(edible_resource_id, edible_resource_name, hunger_points, degeneration_id)\n\ntable #edible_ground\n(id, resource, amount, location)\n\ntable #req_crafting_edible\n(req_crafting_edible_id, edible_resource_id, req_resource_amount, created_item_id)\n\ntable #items\n(item_id, item_name, degeneration_id, is_grounded, is_stackable, can_equip, can_edit)\n</code></pre>\n</blockquote>\n\n<p>What I want to do is -only- echo out the craftable item's name if, and only if -all- required resources (and their required amounts) are on the ground in the location of the character.</p>\n\n<p>I have a query that comes close:</p>\n\n<pre><code>SELECT items.item_name, items.item_id FROM items\nINNER JOIN req_crafting_edible\nON req_crafting_edible.created_item_id = items.item_id\nINNER JOIN edible_ground\nON edible_ground.resource = req_crafting_edible.edible_resource_id\nAND edible_ground.amount &gt;= req_crafting_edible.req_resource_amount\nWHERE edible_ground.location = $current_location\nGROUP BY items.item_name\nORDER BY items.item_name\n</code></pre>\n\n<p>But this shows me craftable items regardless if I have ALL the required items in the area. It shows me items as long as I have -one- of their required resources.</p>\n\n<p>Is there a way to only show the name of a craftable item only if I have -all- the required resources (and their amounts) in edible_ground where location = $current_location?</p>\n\n<p>For more information on what I've tried:</p>\n\n<pre><code>$get_char = mysql_query(\"SELECT current_char FROM accounts WHERE account_id ='\".$_SESSION['user_id'].\"'\");\n$current_char = mysql_result($get_char, 0, 'current_char');\n\n$get_loc = mysql_query(\"SELECT current_location FROM characters WHERE character_id = $current_char\");\n$current_location = mysql_result($get_loc, 0, 'current_location');\n\n//---------------------------------------------------------------COOKED FOOD\n$get_food = mysql_query(\"SELECT items.item_name, items.item_id FROM items\nINNER JOIN req_crafting_edible\nON req_crafting_edible.created_item_id = items.item_id\nINNER JOIN edible_ground\nON edible_ground.resource = req_crafting_edible.edible_resource_id\nAND edible_ground.amount &gt;= req_crafting_edible.req_resource_amount\nWHERE edible_ground.location = $current_location\nGROUP BY items.item_name\nORDER BY items.item_name\");\nwhile ($food = mysql_fetch_array($get_food)){\n  echo $food['item_name'].'&lt;br&gt;';\n}\n</code></pre>\n\n<p>This returns:</p>\n\n<ul>\n<li>Baked Fish </li>\n<li>Charred Fish </li>\n<li>Fish Soup </li>\n<li>Glazed Berry </li>\n<li>Cake </li>\n<li>Grilled Fish</li>\n<li>Sashimi </li>\n<li>Seafood Soup </li>\n<li>Sushi </li>\n<li>Udon</li>\n</ul>\n\n<p>On the ground:</p>\n\n<ul>\n<li>1 fish </li>\n<li>1 honey</li>\n</ul>\n\n<p>Even though fish soup, berry cake, udon etc needs much more than just the one fish that's in the area.</p>\n\n<p>Can anyone help me figure this out? I'd be forever grateful; I've spent a few days already trying to myself. Please?</p>\n\n<p>And before anyone says anything, I know I need to start using mysqli; unfortunately I didn't even realize it existed when I started to make the game (and learn PHP at the same time months ago), so I'll have to painfully go back and change it all in an update.</p>\n"},{"tags":["mysql","sql","query","group-by","sql-order-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12629048,"title":"How do records get ordered in a mysql group by?","body":"<p>so suppose I do </p>\n\n<pre><code>SELECT * FROM table t GROUP BY t.id \n</code></pre>\n\n<p>Suppose there are multiple rows in the table with the same id, only one row of that id will ultimately come out...I suppose mysql will order the results that have the same id and the return the first one or something....my question is...how does mysql perform this ordering and is there a way that I can control its ordering so that for instance, it uses a certain field etc? </p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12712276,"title":"update table when subquery matches","body":"<p>I am trying this query but it outputs a syntax error in the subquery.</p>\n\n<p>What is the problem and how can be solved? thanks</p>\n\n<pre><code>  UPDATE CompradorCategorias_new as A\n    SET A.idParent=(\n        SELECT idcategoria \n        FROM categoriasi18n_new\n        WHERE \n        (\n            SELECT SUBSTRING_INDEX(NomeComPath, '&gt;', 2) \n            FROM CompradorCategorias_new\n            = \n            SELECT translationWithPath \n            FROM categoriasi18n_new\n        )\n    )\n</code></pre>\n"}]}
{"total":20740,"page":16,"pagesize":100,"questions":[{"tags":["query","format"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12711533,"title":"Getting the last insert of your table","body":"<p>I have a table RECEIPT and the ID that i created is</p>\n\n<p>REC-201290001 = \"REC-\"+\"YEAR\"+\"MONTH\"+\"0001\"</p>\n\n<p>I create the number with a String.Format but in order to create the next one i need the last ID i inserted so i can increase it.</p>\n\n<p>Thanks very much for your help.</p>\n"},{"tags":["sql","database","query","sqlite","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12711660,"title":"Sqlite query optimisation needed","body":"<p>I'm using sqlite for a small validation application. I have a simple one table database with 4 varhchar columns and one integer primary key. There are close to 1 million rows in the table. I have optimised it and done a vacuum on it.</p>\n\n<p>I am using the following query to retrieve a presence count from the table. I have changed the fields and names for privacy.</p>\n\n<pre><code>                  SELECT \n                  count(*) as 'test'\n                  FROM\n                  my_table\n                  WHERE\n                  LOWER(surname) = LOWER('Oliver')\n                  AND\n                  UPPER(address_line2) = UPPER('Somewhere over the rainbow')  \n                  AND\n                  house_number IN ('3','4','5');\n</code></pre>\n\n<p>This query takes about 1.5-1.9 seconds to run. I have tried indexes and they make no difference really. This time may not sound bad but I have to run this test about 40,000 times on a read in csv file so as you may imagine it adds up pretty quickly. Any ideas on how to reduce the execution time. I normally develop in mssql or mysql so if there are some tricks I am missing in sqlite I would be happy to hear them.</p>\n\n<p>All the best.</p>\n"},{"tags":["php","mysql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12711333,"title":"unexpected T_STRING for running mysql query in for loop","body":"<p>I am running a query inside a for loop and getting unexpected T_STRING error. Please help me. I just want to echo the query. Thanks</p>\n\n<pre><code>&lt;?php\n$row = 1;\nif (($handle = fopen(\"book1.csv\", \"r\")) !== FALSE) {\n    while (($data = fgetcsv($handle, 1000, \",\")) !== FALSE) {\n        $num = count($data);\n        $row++;\n        for ($c=0; $c &lt; $num; $c++) {\n\n\n    $query=\"UPDATE users SET email_alert=1 where email=\"trim($data[$c]\")\";\n    echo($query);\n\n    }\n}\n    fclose($handle);\n}\n?&gt;\n</code></pre>\n"},{"tags":["java","sql","query","prepared-statement"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12692046,"title":"java - how to inject custom PreparedStatement's paramters","body":"<p>I am trying to implement PreparedStatement, which won't work with sql DB.</p>\n\n<p>Suppose I have the following sql query:</p>\n\n<pre><code>String selectSqlQuery = \"SELECT * FROM customer WHERE f1 = ? AND f2 =? AND f3 &gt; ?\";\n</code></pre>\n\n<p>and the following code:</p>\n\n<pre><code>       //----\n\n        prest = con.prepareStatement(selectSqlQuery );\n        prest.setString(1, \"val1\");\n        prest.setString(2, \"val2\");\n        prest.setInt(3, 108);\n        ResultSet rs = prest.executeQuery();\n        //---\n</code></pre>\n\n<p>My question is how to implement setString and setInt methods for injecting params? </p>\n\n<p>For now I save parameters' indexes and values into HashMap, but after it I can't make injection into sql query string.</p>\n"},{"tags":["query","tsql","subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12699111,"title":"Update table using inner join with subquery","body":"<p>I've searched the web and have been unable to come up with a solution. I appreciate any help given.</p>\n\n<p>I've got a table with these values, among others.</p>\n\n<pre><code>Item Charge No  Item Ledger Entry No    IsReceivedInFull\n--------------------------------------------------------\nOcean Freight   1525593\nFactory Cost    1525593\nOverhead        1525593\nFactory Cost    1525593\nFee             1525593\nDuty            1525593\nLanding Freight 1525593\n</code></pre>\n\n<p>I'm trying to loop through my results to check that for each Item Ledger Entry No I've got these five components in my table; 'Ocean Freight', 'Factory Cost', 'Fee', 'Duty', and 'Landing Freight'. If an individual Item Ledger Entry No has atleast five rows, one for each of the above mentioned Item Charge No's then I'd like to set 'IsReceivedInFull' to \"Yes\"</p>\n\n<p>I come from an ABAP programming background and know this would be easily done with a couple of LOOP statements but I'm new to T-SQL and have struggled to solve this simple problem. Please help.</p>\n"},{"tags":["mysql","sql","query","refactoring","trac"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":129,"score":3,"question_id":12607667,"title":"Issues with a very large SQL query","body":"<p><strong>Problem:</strong></p>\n\n<p>I'm creating a Trac report that shows how many tickets are at each stage in our development cycle per chapter of our library. <em>A tickets represents a single piece of work, usually an individual routine.</em></p>\n\n<p>For instance how many tickets for the upcoming release (milestone) are at the peer review stage for chapter <em>X</em>. </p>\n\n<p>There are 10 development stages and 47 chapters.</p>\n\n<p>The given MySQL query is for all 10 development stages but for only one chapter and is 25 lines long, the whole query for all chapters is therefore over 1200 lines. </p>\n\n<p>The error given by Trac is <code>KeyError: 'numrows'</code> where the query gets to large. </p>\n\n<p>When entering the query directly into MySQL the error given is <code>Out of resources when opening file (Errcode: 24) (23)</code></p>\n\n<p><strong>Question</strong> :</p>\n\n<ul>\n<li><p>Refactoring - can this be done 'better' sql gurus, are there some clever tricks/advance techniques?</p></li>\n<li><p>Approach - do I need a different approach completely?</p></li>\n<li><p>Configuration - can MySQL and/or Trac be configured to accept very large queries</p></li>\n</ul>\n\n<p><em>Notes:</em> </p>\n\n<p><em>The data in the tables is small, the query doesn't take long to execute when it's under the apparent size limitations.</em>   </p>\n\n<p><em>The query is passed from the Trac system to MySQL which places some restrictions on what can be done, for example only a single query can be sent from trac to generate a report.</em></p>\n\n<p><em>An example of what a Trac report looks like can be seen <a href=\"http://trac.edgewall.org/report/37\" rel=\"nofollow\">here.</a></em></p>\n\n<p><em>The <code>%c%*</code> in the query is just the unique string I use for replacing the actual chapters when the query is generated via a script.</em></p>\n\n<pre><code>SELECT '%c%' as Chapter,\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status IN ('new','assigned') ) AS 'New',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='document_interface' ) AS 'Document\\\n Interface',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='interface_development' ) AS 'Inter\\\nface Development',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='interface_check' ) AS 'Interface C\\\nheck',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='document_routine' ) AS 'Document R\\\noutine',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='full_development' ) AS 'Full Devel\\\nopment',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='peer_review_1' ) AS 'Peer Review O\\\nne',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%'AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='peer_review_2' ) AS 'Peer Review Tw\\\no',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='qa' ) AS 'QA',\n(SELECT count(ticket.id) AS Matches FROM engine.ticket INNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%'AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine' AND ticket.status='closed' ) AS 'Closed',\ncount(id) AS Total,\nticket.id AS _id\nFROM engine.ticket\nINNER JOIN engine.ticket_custom ON ticket.id = ticket_custom.ticket\nWHERE ticket_custom.name='chapter' AND ticket_custom.value LIKE '%c%' AND type='New material' AND milestone='1.1.12' AND component NOT LIKE 'internal_engine'\n</code></pre>\n"},{"tags":["php","mysql","query","function","count"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12710505,"title":"How to make these two function merge in one?","body":"<p>Image to see: <img src=\"http://i.stack.imgur.com/sprt9.png\" alt=\"http://imm.io/Gy4v\"></p>\n\n<p>The above image shows that a section in my news-website to list \n1 - Number of articles in each category inside ()\n2 - Available articles in particular category. Those are marked with black lines</p>\n\n<p>Now, to do this I made 2 functions, because I don't have enough knowledge to make two different queries in one myql query. </p>\n\n<p>Here is the first function for getting titles in specific category: </p>\n\n<pre><code>function catagories($id){\n    $query = \"SELECT SUBSTRING(a_title, 1,54) as a_title, a_id FROM d_articles \n              WHERE a_catagory = '$id' ORDER BY a_date DESC LIMIT 10\";\n    $result = mysql_query($query) or die (mysql_error());\n    while($row=mysql_fetch_array($result))\n    {\n        echo \"&lt;a href=\\\"article.php?a_id=$row[a_id]\\\"&gt; \".$row['a_title'].\"...&lt;/a&gt;\"; \n    }\n}\n</code></pre>\n\n<p>Here is the second function for getting the number of titles in a category.</p>\n\n<pre><code>function catagory_no($id){\n$query =\"SELECT a_catagory, COUNT(a_title)\nFROM d_articles WHERE a_catagory = '$id' \nGROUP BY a_catagory \";\n$result =  mysql_query($query);\nwhile($row=mysql_fetch_array($result)) {\nreturn $row['COUNT(a_title)'];\n }\n}\n</code></pre>\n\n<p>How do I show these two function to appear as in one box in Categories page ? \nLike this: </p>\n\n<pre><code>&lt;?php echo \"Artists and Celeberities (\".catagory_no(\"Artist and Celeberities\"); \necho \")&lt;br/&gt;\"; ?&gt; \n&lt;?php echo catagories(\"Artist and Celeberities\"); ?&gt; \n</code></pre>\n"},{"tags":["wpf","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12709478,"title":"Problems with select distinct in wpf","body":"<p>I have a WPF application and when I run Select distinct query I am getting an error as</p>\n\n<p><code>Failed to enable constraints. \nOne or more rows contain values violating non-null, unique, or foreign-key constraints.</code></p>\n\n<p>.cs code:</p>\n\n<pre><code>            Saman.DatabaseDataSet databaseDataSet = ((Saman.DatabaseDataSet)(this.FindResource(\"databaseDataSet\")));\n            // Load data into the table Employee. You can modify this code as needed.\n            Saman.DatabaseDataSetTableAdapters.PartsTableAdapter databaseDataSetPartsTableAdapter = new Saman.DatabaseDataSetTableAdapters.PartsTableAdapter();\n            databaseDataSetPartsTableAdapter.FillBy(databaseDataSet.Parts);\n\n            System.Windows.Data.CollectionViewSource partsViewSource = ((System.Windows.Data.CollectionViewSource)(this.FindResource(\"partsViewSource\")));\n            partsViewSource.View.MoveCurrentToFirst();\n</code></pre>\n\n<p>and query is </p>\n\n<pre><code>Select DISTINCT Category from Parts\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":96,"score":3,"question_id":10471542,"title":"Querying special character sensitive","body":"<p>I have a problem with special characters in my database. They now display correct, but sql seems to ignore them in queries. For example, unfortunately I have these entries:\n<br />\n<code>Morgait</code><br />\n<code>Morgaít</code><br />\n<code>Mórgait</code><br /></p>\n\n<p>Now these names had a UNIQUE key, and while trying to add the second and third after the first one, it would already break saying that the last 2 couldn't be added since the name would no longer be unique. In short, í gets treated as a normal i, and ó as a normal o.</p>\n\n<p>When I query:\n<code>SELECT * FROM member WHERE charname = 'Morgait'</code>\nI get all 3 as result. Same for when I change the i to í, o to ó or even both at the same time.</p>\n\n<p>How can I make the database see these differences? I have the collation of the table set to ascii_general_ci (also tried UTF 8 unicode ci).</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12709663,"title":"Alter MySQL DB column value in SELECT","body":"<p>I have a MySQL DB with a column that sometimes has a value of \"-1\", how can I change that to \"0\" during the SELECT without doing a foreach loop on the result. Basically I want the 'display' value to be 0 if the DB value is -1. If the DB value is anything else then it should be displayed without modification.</p>\n\n<p>Any ideas???</p>\n"},{"tags":["sql","query","session-variables","where"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12709773,"title":"how to use session variables in sql queries?","body":"<p>i want to use the session['CUS_ID'] to get the customers appointment date, time and description. it does not work? why? tell me what i'm doing wrong.    </p>\n\n<pre><code>&lt;?php  \n$schedList = \"\";\n$sql = mysql_query(\"SELECT SCHED_DATE, SCHED_TIME, SCHED_DESC\n              FROM schedule\n              WHERE `CUS_ID`='\".$_SESSION[\"CUS_ID\"].\"' LIMIT 1\");//query the person\n$schedCount = mysql_num_rows($sql); // count the output amount\nif ($schedCount &gt; 0) {\nwhile($row = mysql_fetch_array($sql)){ \n         $SCHED_DATE = $row[\"SCHED_DATE\"];\n         $SCHED_TIME = $row[\"SCHED_TIME\"];\n         $SCHED_DESC = $row[\"SCHED_DESC\"];\n         $schedList .= \"Date: $SCHED_DATE - &lt;strong&gt;$SCHED_TIME&lt;/strong&gt; - &lt;em&gt;for $SCHED_DESC&lt;/em&gt;\";\n    }\n} else {\n$schedList = \"You haven't scheduled an appoinment yet\";\n}\n\necho $schedList\n?&gt;\n</code></pre>\n\n<p>in the login page ii have a code that goes like this </p>\n\n<p>\n\n<pre><code>session_start(); // This starts the session which is like a cookie, but it isn't saved on your hdd and is much more secure.\n$db_host = \"localhost\"; \n// Place the username for the MySQL database here \n$db_username = \"builder\";  \n// Place the password for the MySQL database here \n$db_pass = \"poopoo\";  \n// Place the name for the MySQL database here \n$db_name = \"sadsys1\"; \n\n// Run the actual connection here  \nmysql_connect(\"$db_host\",\"$db_username\",\"$db_pass\") or die (\"could not connect to mysql\");\nmysql_select_db(\"$db_name\") or die (\"no database\");  \n\nif(isset($_POST['submit']))\n{\n   $EMAIL = $_POST['EMAIL']; // The function mysql_real_escape_string() stops hackers!\n   $PASSWORD = mysql_real_escape_string($_POST['PASSWORD']); // We won't use MD5 encryption here because it is the simple tutorial, if you don't know what MD5 is, dont worry!\n   $mysql = mysql_query(\"SELECT * FROM customerinfo WHERE EMAIL = '$EMAIL' AND PASSWORD = '$PASSWORD'\"); // This code uses MySQL to get all of the users in the database with that username and password.\n\n   if(mysql_num_rows($mysql) &lt; 1)\n   {\n     die(\"&lt;script type=\\\"text/javascript\\\"&gt;\n                    alert(\\\"Invalid Username or Password!\\\")\n                    history.back()\n                    &lt;/script&gt;\");\n   } // That snippet checked to see if the number of rows the MySQL query was less than 1, so if it couldn't find a row, the password is incorrect or the user doesn't exist!\n    else{\n    mysql_query(\"INSERT INTO session (SESSION_START,SESSION_DATE) VALUES (now(),now())\"); \n    }\n\n\n    $_SESSION['loggedin'] = \"YES\"; // Set it so the user is logged in!\n        $_SESSION['EMAIL'] = $EMAIL;\n    $_SESSION['CUS_ID'] = $CUS_ID; // Make it so the username can be called by $_SESSION['name']\n        header(\"location: HOMEPAGEREG.php\");\n\n   // Kill the script here so it doesn't show the login form after you are logged in!\n} // That bit of code logs you in! The \"$_POST['submit']\" bit is the submission of the form down below\n</code></pre>\n\n<p>how will i get the CUS_ID and use it in the query?\nplease please help</p>\n"},{"tags":["php","mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12708494,"title":"Update via PHP a Mysql row at a $value change","body":"<p>I need some help. Please, note: below lines of codes are only for a main idea example.</p>\n\n<p>I have a php function to count some entries in a mysql table</p>\n\n<pre><code>$query = \"SELECT COUNT(my_matches) FROM my_table\";\n$db-&gt;setQuery($query);\n$value = $db-&gt;loadResult();\n</code></pre>\n\n<p>Now, I need to update another row of another table with $value</p>\n\n<pre><code>$query = \"UPDATE my_table_reviews SET user_rating = (user_rating + '$value') WHERE listing_id = 77\");\n$db-&gt;setQuery($query);\n$autorating = $db-&gt;loadResult();}\n</code></pre>\n\n<p>The problem is: how to update row user_rating from my_table_review ONLY WHEN $value change?</p>\n\n<p>In words... if $value is changed so to this (second query). If $value is stable, do nothing.</p>\n\n<p>I'm a little bit confused... any help would be really appreciated!</p>\n"},{"tags":["php","mysql","performance","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12708796,"title":"How to remove files after LOAD DATA INFILE?","body":"<p>I'm using the <code>LOAD DATA INFILE</code> solution to speed up big inserts, like outlined here: <a href=\"http://www.mysqlperformanceblog.com/2006/07/12/insert-into-select-performance-with-innodb-tables/\" rel=\"nofollow\">http://www.mysqlperformanceblog.com/2006/07/12/insert-into-select-performance-with-innodb-tables/</a>. </p>\n\n<p>It works brilliantly, and very fast. However, when I do the select, I create a file, which is then used by the <code>LOAD DATA INFILE</code> command. But after using this file, I don't need it any more. Can I get rid of it with an additional query? Or can I make it temporary somehow?</p>\n\n<p>I'm using it on my server, so the file stays on my server and doesn't involve the client in any way. I'm using PHP in conjunction with MySQL, so the solution may also be in PHP.</p>\n"},{"tags":["python","django","arrays","query","django-models"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12708539,"title":"Django - List index out of range","body":"<p>I have a ManyToManyField in my model. I need to get the third item for every query as below. </p>\n\n<pre><code>class Staff(models.Model):\n    status = models.BooleanField(default=True)\n    person = models.ForeignKey(Person)\n    staff_job_categories = models.ManyToManyField(StaffJobCategory)\n    staff_titles = models.ManyToManyField(PersonTitle, null=True, blank=True)\n\n    def get_job_categories(self):\n          return self.staff_job_categories.all()[3]\n</code></pre>\n\n<p>I use the get_job_categories function for admin list_filter but I want to show only the 3rd item in every many to many array.</p>\n\n<p>But get the \n  <strong>List index out of range</strong> ERROR;\nby the way;</p>\n\n<pre><code>    def get_job_categories(self):\n    return self.staff_job_categories.all()[:3]\n</code></pre>\n\n<p>works fine ; but gets all the objects till i get what i want.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12707955,"title":"Need to construct query which will find parents of a record in same table?","body":"<p>I need to construct a query on a single table. The table structure and some dummy data in it as follows</p>\n\n<pre><code>id  | username  | seniorid\n1   | Superuser |   -1\n2   | user1 |    1\n3   | user2 |    1\n4   | user3 |    3\n5   | user4 |    4\n6   | user5 |    1\n7   | user6 |    6\n8   | user7 |    6\n9   | user8 |    8\n10  | user9 |    9\n11  | user10    |    8\n12  | user11    |    8\n13  | user12    |    8\n14  | user13    |    6\n15  | user14    |    3\n16  | user15    |    2\n17  | user16    |    8\n18  | user17    |    8\n</code></pre>\n\n<p>Here in above table there is only one superuser. Which will be at the top level in hirarchy of users. This superuser is the only user who has seniorid as -1. superuser is parent of all users.\nIn above table every user may or may not have there child users.\nThe relation between parent user and child user is mentioned in table such that number in seniorid is nothing but id of the other user.</p>\n\n<p>For example:</p>\n\n<p>Consider following user</p>\n\n<pre><code>id  | username  | seniorid\n18  | user17    |    8\n</code></pre>\n\n<p>in above case seniorid is 8 and so that parent of above user is </p>\n\n<pre><code>8   | user7 |    6\n</code></pre>\n\n<p>where as seniorid of \"user7\" 6 so that parent is</p>\n\n<pre><code>6   | user5 |    1\n</code></pre>\n\n<p>in this way doing backtracking we will get following list of hirarchy from \"superuser\" to \"user17\"</p>\n\n<pre><code>id  | username  | seniorid\n1   | Superuser |   -1\n6   | user5 |    1\n8   | user7 |    6\n18  | user17    |    8\n</code></pre>\n\n<p>This hirarchy will have up to n level i.e. up to many levels</p>\n\n<p>I want above hirarchy result using single query.</p>\n\n<p>I need your help in constructing the above query. Please can anybody give me such query in mysql.</p>\n\n<p>I have id, username, seniorid of the user whose senior users list I need to find out in a single query. Here single query means It may have multiple nested querys in it. But as whole It will fired as single query.</p>\n"},{"tags":["java","query","mongodb"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12707977,"title":"How to construct query for getting value from mongo by matching the typed value in text box(like autocomplete)?","body":"<p>I am having test collection in mongodb, In that collection i am having many documents in same structure as below,</p>\n\n<pre><code>       { \"_id\" : ObjectId(\"5026176dcac010a752b0d3a9\"), \n         \"number\" : \"yes\",\n         \"url\" :\"www.emesene.com\"\n       }\n</code></pre>\n\n<p>Actually,I am creating auto-complete option for <strong>\"number\"</strong> and <strong>\"url\"</strong> fields in html, I have taken typed value , fields etc to backend..Now, I want to construct <strong>basicdbobject</strong> query using typedvalue and fields for getting stored values(as autocomplete) as based on the typed value.</p>\n\n<p>I have constructed basicdbobject query as below but its not working</p>\n\n<pre><code>      query={ \"url\" : { \"$regex\" : \"www\" , \"$options\" : \"i\"} }\n      collection.find(query).limit(5)\n\n      field=url\n      typed value=www\n</code></pre>\n\n<p>Anyone help me...\nThanks in advance...</p>\n"},{"tags":["jquery","string","query","url"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":824,"score":0,"question_id":8555412,"title":"add querystring to URL","body":"<pre><code>var EventAddress=$(\".EventAddress\").text();\n$(\".EventDirectionLink a\").attr(\"href\", url + EventAddress);  \n</code></pre>\n\n<p>This is the jquery I am using to get the address value from the table cell and pass it to the map url as a query string but its not working? What am I doing wrong??</p>\n\n<pre><code>&lt;div class=\"driving-directions-link\"&gt;\n&lt;a href=\"http://maps.google.com/maps?q=\"&gt;Get Direction&lt;/a&gt;\n&lt;/div&gt;\n\n&lt;table cellpadding=\"10\" class =\"EventDetail\"&gt;\n    &lt;tr&gt;\n        &lt;td class=\"TableFields\"&gt;Who Should Enroll?:&lt;/td&gt;\n        &lt;td&gt;Everyone 18 and older who would like to attend&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td class=\"TableFields\"&gt;Location:&lt;/td&gt;\n        &lt;td class=\"EventAddress\"&gt;1300 Albany Street,Beech Grove ,IN&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["c#","asp.net-mvc-3","query","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":32,"score":1,"question_id":12706703,"title":"EF query - getting entities of a certain type","body":"<p>I am trying to filter out entities of a certain type. I am using Entity Framework, and I have a parent entity, and various children that inherit from the parent entity. I am trying to filter out one of these children. </p>\n\n<p>For example, I have the following structure:</p>\n\n<ul>\n<li>Address : Entity\n<ul>\n<li>PostCode : Address</li>\n<li>Street : Address</li>\n</ul></li>\n</ul>\n\n<p>A User entity has a reference to one address. How can I obtain a list of users that are associated to an address of type PostCode?</p>\n\n<p>i.e. I tried: </p>\n\n<pre><code> var query = from User p in context.Users\n                        where p.Address.GetType() == typeof(PostCode)\n                        select p;\n</code></pre>\n\n<p>But I get: </p>\n\n<blockquote>\n  <p>LINQ to Entities does not recognize the method 'System.Type GetType()'\n  method, and this method cannot be translated into a store expression.</p>\n</blockquote>\n\n<p>I have seen couple of solutions that involve obtaining the list of Users first, and then selecting those of a certain type. Problem with this solution is that the query obtains all the users first; I would like my query to include the filter since I have quite a few Users.</p>\n\n<p>Thanks!</p>\n"},{"tags":["wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":12697366,"title":"Query next days from today in wordpress","body":"<p>I have a creepy site running Wordpress 2.8.5. Its purposed to show events in my state (Bahia/Brazil).<br>\nEvery event has it published date as the day of the event and the theme shows future posts bypassing WP's default to display until today.<br>\nIt has a slide with some featured events and this is how it now selects what is to be shown in the slides:</p>\n\n<pre><code>$mes = date('n');\n$ano = date('Y');\nquery_posts(\"\n  meta_key=dest_principal&amp;\n  meta_value=1&amp;\n  showposts=6&amp;\n  year=$ano&amp;\n  monthnum=$mes&amp;\n  order=ASC\n\");\n</code></pre>\n\n<p>With this code the slide shows the first 6 posts in the current month. The problem I have is not being able to show the next 6 posts begining <em>today</em>. (to be clear, by <em>today</em> i mean the day of access)<br>\nI found this entry \" <a href=\"http://stackoverflow.com/questions/8682804/wordpress-query-next-two-events-by-metadata-date\">wordpress query - next two events by metadata date</a> \" but could not translate it to my need.</p>\n"},{"tags":["sql","query","join","group-by"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12700362,"title":"group, sum and join combined in sql","body":"<p>I've got a table <code>spending</code>, which contains some basic fields which define the item of purchase, the time of purchase, and the value of purchase, and which account they were purchased from: <code>spItem</code>, <code>spAmount</code>, <code>spDate</code> and <code>spAccount</code>.</p>\n\n<p>I have made a query to group them per month, one Account at a time, which works fine:</p>\n\n<pre><code>SELECT YEAR(spDate) as spYear,\n       MONTH(spDate) as spMonth,\n       SUM(spAmount) AS TotalAmount\nFROM spending\nWHERE spAccount like 'Bank1'\nGROUP BY YEAR(spDate), MONTH(spDate)\nORDER BY YEAR(spDate), MONTH(spDate)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>SELECT YEAR(spDate) as spYear,\n       MONTH(spDate) as spMonth,\n       SUM(spAmount) AS TotalAmount\nFROM spending\nWHERE spAccount like 'Bank2'\nGROUP BY YEAR(spDate), MONTH(spDate)\nORDER BY YEAR(spDate), MONTH(spDate)\n</code></pre>\n\n<p>I'm trying to get one table which could combine both queries, and display <code>Bank1</code> into one column and <code>Bank2</code> into the next column. There may be some months where one of the Accounts has no spending. In this case it should show a zero value and not just skip it.</p>\n\n<p>Anyone that can point me in the right way will be very much appreciated.</p>\n"},{"tags":["sql","query","symfony2","doctrine2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12706337,"title":"Doctrine 2 Query with LIKE","body":"<p>I have this code for query: </p>\n\n<pre><code>$repository = $em-&gt;getRepository('AcmeCrawlerBundle:Trainings');\n       $query = $repository-&gt;createQueryBuilder('p')\n               -&gt;where('p.title LIKE :word')\n               -&gt;orWhere('p.discription LIKE :word')\n               -&gt;setParameter('word', $word)\n               -&gt;getQuery();\n$trainings = $query-&gt;getResult();\n</code></pre>\n\n<p>The problem is: even if matches exist, they not found by this query. I used this code to see full sql: </p>\n\n<pre><code>print_r(array(\n        'sql'        =&gt; $query-&gt;getSQL(),\n        'parameters' =&gt; $query-&gt;getParameters(),\n        ));\n</code></pre>\n\n<p>And what I've got:</p>\n\n<pre><code>FROM Trainings t0_ WHERE t0_.title LIKE ? OR t0_.discription LIKE ? [parameters] =&gt; Array ( [word] =&gt; Spoken ) \n</code></pre>\n\n<p>(last part of query)\nTell me please what to change?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":91,"score":-1,"question_id":12703322,"title":"How to fetch data with total count using mysql single query","body":"<p>I want to write one mysql query to fetch all my table data and with total records count.</p>\n\n<p>For eg. this is my table</p>\n\n<pre><code>ID     Name    typeId\n1      test1   1\n2      test2   1\n3      test3   2\n</code></pre>\n\n<p>If I am going to fetch data with type id 1 I need a result like this</p>\n\n<pre><code>Name    count \ntest1   2\ntest2   2\n</code></pre>\n\n<p>How can I write sql for this kind of a result. \nI dont want subquery. I want to fetch data with out subquery\nPlease help me.</p>\n\n<p>Thanks</p>\n"},{"tags":["python","mysql","django","query","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12704720,"title":"Custom MySQL bigint(11) comparisons are failing","body":"<p>there seems to be a bug in my program and it's quite weird. To test I was running some very simple commands on the manage.py shell.</p>\n\n<pre><code>models = Model.objects.all()\n\nfor model in models :\n   print model.field\n\noutput: \n0\n0\n0\n0\n100004398604871\n576962717\n576962717\n576962717\n</code></pre>\n\n<p>Now for the weird part:</p>\n\n<pre><code>Model.objects.extra(where = [\"field= 576962717\"])\noutput:\n[]\n\nModel.objects.extra(where = [\"field= 100004398604871\"])\noutput:\n[]\n\n# But!!\n\nModel.objects.extra(where = [\"field= 0\"])\noutput:\n[a bunch of models, aka this one worked]\n</code></pre>\n\n<p>So obviously something is wrong with the big int comparisons. I checked my mysql database structure and my models to make sure they aligned, and they did:</p>\n\n<p>My mysql cols were labeled as bigint(11)</p>\n\n<p>and my django models were BigIntegerField(editable=False)</p>\n\n<p>Any ideas? Thanks</p>\n"},{"tags":["sql","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":12696723,"title":"SQL Query Help (Advanced - for me!) ","body":"<p>I have a question about a SQL query I am trying to write. </p>\n\n<p>I need to query data from a database. \nThe database has, amongst others, these 3 fields: </p>\n\n<p>Account_ID #, Date_Created, Time_Created</p>\n\n<p>I need to write a query that tells me how many accounts were opened per hour. </p>\n\n<p>I have written said query, but there are times that there were 0 accounts created, so these \"hours\" are not populated in the results. </p>\n\n<p>For example: </p>\n\n<blockquote>\n  <p>Volume <strong><em>Date</em>_</strong>_Hour<br>\n  435    12-Aug-12  03<br>\n  213    12-Aug-12  04<br>\n  125    12-Aug-12  06 <br></p>\n</blockquote>\n\n<p>As seen in the example above, hour 5 did not have any accounts opened. </p>\n\n<p>Is there a way that the result can populate the hour but and display 0 accounts opened for this hour? \nExample of how I want my results to look like: </p>\n\n<p>Volume <strong><em>Date</em></strong>_Hour<br>\n435 12-Aug-12  03<br>\n213 12-Aug-12  04<br>\n0     12-Aug-12  05<br>\n125 12-Aug-12  06<br></p>\n\n<p>Thanks! </p>\n\n<p>Update: This is what I have so far</p>\n\n<pre><code>SELECT count(*) as num_apps, to_date(created_ts,'DD-Mon-RR') as app_date, to_char(created_ts,'HH24') as app_hour \nFROM accounts \nWHERE To_Date(created_ts,'DD-Mon-RR') &gt;= To_Date('16-Aug-12','DD-Mon-RR') \nGROUP BY To_Date(created_ts,'DD-Mon-RR'), To_Char(created_ts,'HH24') \nORDER BY app_date, app_hour\n</code></pre>\n"},{"tags":["query","stored-procedures","sql-server-2008-r2"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12702908,"title":"Retrieve rows from a database table (query error)","body":"<p>I have a database with a table <code>book</code> (<code>id, name, display, priority</code>)</p>\n\n<p>For example:</p>\n\n<pre><code> ________________________________________________________\n|    id    |    name    |    display    |    priority    |\n --------------------------------------------------------\n|    1     |    test1   |     True      |       5        |\n|    2     |    test2   |     True      |       3        |\n|    3     |    test3   |     False     |       4        |\n|    4     |    test4   |     True      |       1        |\n|    5     |    test5   |     True      |       2        |\n|    6     |    test6   |     False     |       1        |\n|    7     |    test7   |     True      |       1        |\n|    8     |    test8   |     True      |       4        |\n|    9     |    test9   |     True      |       3        |\n|    10    |    test10  |     False     |       2        |\n|    11    |    test11  |     True      |       3        |\n|    12    |    test12  |     True      |       5        |\n --------------------------------------------------------\n</code></pre>\n\n<p>I need to write a query to get only 3 rows with priority 1 and 2 and 3 and display is true</p>\n\n<p>I use this stored procedure to display books that have priority 1 and 2 and 3 (the most specific books)</p>\n\n<p><strong>Problem</strong>:</p>\n\n<ol>\n<li><p>when I try to <code>select top 3 order by priority</code> then the query get the first 3 rows with priority = 1, while I need 1-record with priority = 1 and 1-record with priority = 2 and 1-record with priority = 3.</p></li>\n<li><p>when I try to get <code>distinct book</code>, distinct works over all records not on priority only</p></li>\n</ol>\n\n<p><b>Result:</b></p>\n\n<p>I need the result to be like:</p>\n\n<pre><code> ________________________________________________________\n|    id    |    name    |    display    |    priority    |\n --------------------------------------------------------\n|    4     |    test4   |     True      |       1        |\n|    2     |    test2   |     True      |       3        |\n|    5     |    test5   |     True      |       2        |\n --------------------------------------------------------\n</code></pre>\n\n<p>How can I do that?</p>\n\n<p>thanks for help</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":28,"down_vote_count":0,"view_count":17126,"score":28,"question_id":1334012,"title":"Cannot insert explicit value for identity column in table 'table' when IDENTITY_INSERT is set to OFF","body":"<p>I have below error when i execute the following script;</p>\n\n<p>Could you specify what it is and how it can be resolved?</p>\n\n<pre><code>Insert table(OperationID,OpDescription,FilterID)\nvalues (20,'Hierachy Update',1)\n\n\nServer: Msg 544, Level 16, State 1, Line 1\n\nCannot insert explicit value for identity column in table 'table' when IDENTITY_INSERT is set to OFF.\n</code></pre>\n"},{"tags":["mysql","query","search","select"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12703382,"title":"mysql query multiple params from one table?","body":"<p>Okay i have mysql query, and i'd like to search both parameters  in table_1<br />\ni'll try showing the idea with \"php\"</p>\n\n<pre><code>if(table_2_params.params_id == 124){\n   //select LIKE  \"%EXTEC (Sandvik)%\" from  table_2_params.nosaukums\n}\nelseif(table_2_params.params_id == 126){\n  //SELECT  FROM table_2_params WHERE nosaukums is BETWEEN  \"2010\" AND  \"2012\"\n}\n</code></pre>\n\n<p>I want to query display first AND second parameter...(<strong>both of them to match</strong>) <br />\ndaymn i hope you will understand what i want to say... <br /></p>\n\n<p>Okay here's the\n<strong>mysql query:</strong></p>\n\n<pre><code> SELECT table_1 . * , table_2_params . * \n    FROM table_1, table_2_params\n    WHERE table_1.pamat_kat_sad =  '756'\n    AND table_1.preces_id = table_2_params.preces_id\n    AND (\n        (\n        table_2_params.params_id =124\n        AND table_2_params.nosaukums LIKE  \"%EXTEC (Sandvik)%\"\n        )\n        AND (\n        table_2_params.params_id =126\n        AND table_2_params.nosaukums\n        BETWEEN  \"2010\"\n        AND  \"2012\"\n        )\n    )\n    ORDER BY table_1.preces_id DESC\n</code></pre>\n\n<p>Problem might be that the <code>table_2_params.nosaukums</code> type is <code>longtext</code> ...</p>\n\n<p>If i select only with </p>\n\n<pre><code>    AND (\n    table_2_params.params_id =126\n    AND table_2_params.nosaukums\n    BETWEEN  \"2010\"\n    AND  \"2012\"\n    )\n</code></pre>\n\n<p>it displays correct year...\nAND if i select only with </p>\n\n<pre><code>(\n    table_2_params.params_id =124\n    AND table_2_params.nosaukums LIKE  \"%EXTEC (Sandvik)%\"\n    )\n</code></pre>\n\n<p>it also displays correct values...</p>\n\n<p>But i cant make them both work together..</p>\n\n<p>Please help me!</p>\n\n<p>Thank you!</p>\n"},{"tags":["forms","query","sql-update"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12703567,"title":"not updating with no error","body":"<p>this code is used to parse the form data and edit inventory item to the system \nit doesn't have any error but it wont update my database. mysql query look like it is also correct. what am i doing wrong?</p>\n\n<pre><code>&lt;?php \nif (isset($_POST['PRODUCT_NAME'])) {\n\n$PID = mysql_real_escape_string($_POST['thisID']);\n$PRODUCT_NAME = mysql_real_escape_string($_POST['PRODUCT_NAME']);\n$PRICE = mysql_real_escape_string($_POST['PRICE']);\n$CATEGORY = mysql_real_escape_string($_POST['CATEGORY']);\n$DETAILS = mysql_real_escape_string($_POST['DETAILS']);\n// See if that product name is an identical match to another product in the system\n$sql = mysql_query(\"UPDATE collection SET `PRODUCT_NAME`='$PRODUCT_NAME', `PRICE`='$PRICE', `CATEGORY`='$CATEGORY', `DETAILS`='$DETAILS', WHERE `PD_ID`='$PID'\");\nif ($_FILES['fileField']['tmp_name'] != \"\") {\n    // Place image in the folder \n    $newname = \"$pid.jpg\";\n    move_uploaded_file($_FILES['fileField']['tmp_name'], \"COLLECTION/$newname\");\n}\nif($CATEGORY == 'Debut'){\nheader(\"location: DEBUTADMIN.php\");\n}else if ($CATEGORY == 'Bridal') {\nheader(\"location: BRIDALADMIN.php\");\n}else if ($CATEGORY == 'Evening') {\nheader(\"location: EVENINGADMIN.php\");\n}else {\nheader(\"location: EVENINGADMIN.php\");\n}\nexit();\n}\n?&gt;\n</code></pre>\n\n<p>here is my form</p>\n\n<pre><code>&lt;form action=\"COLLECTIONEDIT.php\" enctype=\"multipart/form-data\" name=\"myForm\" id=\"myForm\" method=\"post\"&gt;\n&lt;table class='hovertable'&gt;\n&lt;tr&gt;\n&lt;td&gt;Product Name:&lt;/td&gt;\n&lt;td&gt;&lt;input name=\"PRODUCT_NAME\" type=\"text\" id=\"PRODUCT_NAME\" size=\"60\" value=\"&lt;?php echo $PRODUCT_NAME; ?&gt;\" /&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Price:&lt;/td&gt;\n&lt;td&gt;P&lt;input name=\"PRICE\" type=\"text\" id=\"PRICE\" size=\"12\" value=\"&lt;?php echo $PRICE; ?&gt;\"/&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Category&lt;/td&gt;\n&lt;td&gt;&lt;select name=\"CATEGORY\" id=\"CATEGORY\"&gt;\n  &lt;option value=\"&lt;?php echo $CATEGORY; ?&gt;\"&gt;&lt;?php echo $CATEGORY; ?&gt;&lt;/option&gt;\n  &lt;option value=\"Debut\"&gt;Debut Gown&lt;/option&gt;\n  &lt;option value=\"Bridal\"&gt;Bridal Gown&lt;/option&gt;\n  &lt;option value=\"Evening\"&gt;Evening Gown&lt;/option&gt;\n  &lt;option value=\"Barong\"&gt;Barong&lt;/option&gt;\n  &lt;option value=\"Suits\"&gt;Suits&lt;/option&gt;\n &lt;/select&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;td&gt;Details:&lt;/td&gt;\n&lt;td&gt;&lt;textarea name=\"DETAILS\" id=\"DETAILS\" cols=\"60\" rows=\"7\" &gt;&lt;?php echo $DETAILS; ?&gt;&lt;/textarea&gt;&lt;/td&gt;\n&lt;tr&gt;\n&lt;td&gt;Product Image:&lt;/td&gt;\n&lt;td&gt;&lt;input type=\"file\" name=\"fileField\" id=\"fileField\" /&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;&amp;nbsp;&lt;/td&gt;\n&lt;td&gt;\n&lt;input name=\"thisID\" id=\"thisID\" type=\"hidden\" value=\"&lt;?php echo $targetID; ?&gt;\" /&gt;\n&lt;input type=\"submit\" name=\"submit\" id=\"button\" value=\"Edit Product\"&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n"},{"tags":["query","tsql","sorting"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12702627,"title":"Sorting in T-SQL by alphanumeric","body":"<p>I have a SQL 2008 database with a table having a field 'Category' of type nvarchar, which has values such as :</p>\n\n<pre><code>A1\nA10\nA2\nB1/1\nB1/2\nB1/3\nD1(1)\nD1(2)\n</code></pre>\n\n<p>etc.</p>\n\n<p>I know this is not good structure for the data, but we now need to somehow narrow down searches to this table such that the user will enter a start and end category (i.e. A1 to A15, or B1/1 to B/3) and we want to only return records with these category values.</p>\n\n<p>Is there a way this can be done? The other thing is that we would also like to have the results sorted correctly (ie. A10 after A2).</p>\n\n<p>c.</p>\n"},{"tags":["html5","query","phonegap","ios6","media"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12702773,"title":"HTML5 Media Queries on iOS6","body":"<p>I have developed an iOS app in PhoneGap. It was working perfect but when i upgraded my iOS SDK to version 6.0, the media queries I was working with are now not effective anymore. Does iOS 6 has any issues regarding media queries?</p>\n"},{"tags":["ruby-on-rails","query","activerecord","join","eager-loading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":270,"score":0,"question_id":9594952,"title":"Rails 3: How to eager load an association AND apply a condition with includes()?","body":"<p>My app has <code>Question</code> models that <code>has_many</code> <code>UserResponse</code> models.  </p>\n\n<p>I'd like to get the last 5 questions that a particular <code>User</code> has answered with the associated <code>UserResponse</code> objects filtered on the <code>user_id</code> field.</p>\n\n<p>Here's what I currently have:</p>\n\n<pre><code>Question.group(\"questions.id\").\njoins(\"inner join user_responses r on r.question_id = questions.id\").\nwhere(\"r.user_id = #{user_id}\").\norder(\"questions.id asc\").limit(5)\n</code></pre>\n\n<p>This query gives me back what I want, but the problem is when I get a <code>Question</code> out of the array and do <code>question.user_responses</code> the result is all of the responses for that question, not just the ones that should be filtered by the join/where clause above.</p>\n\n<p>I've tried to do this:</p>\n\n<pre><code>Question.includes(:user_responses).group(\"questions.id\").\njoins(\"inner join user_responses r on r.question_id = questions.id\").\nwhere(\"r.user_id = #{user_id}\").\norder(\"questions.id asc\").limit(5)\n</code></pre>\n\n<p>thinking it would eager load each response...but it doesn't appear to function that way.</p>\n\n<p>Where am I going wrong?</p>\n\n<p>If it makes a difference, the reason I need everything eagerly loaded is because I want to take the array and call to_json on it and return the json from a web service for my mobile app, so I need the entire graph available.</p>\n"},{"tags":["android","query","sqlite","join"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":616,"score":0,"question_id":11349950,"title":"Android SQLite Join Query","body":"<p>I'm creating an app as a learning tool and am having difficulty with join queries.</p>\n\n<p>I have a database with two tables- horses and covers- declared as follows;</p>\n\n<pre><code>    private static final String HORSES_CREATE = \"create table horses (_id integer primary key autoincrement, \"\n        + \"name text not null, type integer not null, birthDate text not null, vaccineDate text not null, \"\n        + \"inFoal integer not null, notes text not null);\";\n</code></pre>\n\n<p>The 'type' field refers to stallion, mare, gelding etc and is selected from a spinner (populated from an XML String array).</p>\n\n<pre><code>private static final String COVERS_CREATE = \"create table covers (_id integer primary key autoincrement, \"\n        + \"stallionName integer not null, mareName integer not null, firstCoverDate text not null, lastCoverDate text not null, \"\n        + \"scan14Date text not null, scan28Date text not null, foalingDate text not null, inFoal integer not null, notes text not null);\";\n</code></pre>\n\n<p>stallionName is actually stored as the _id field of the horse from the horse table. It is selected from a spinner that only displays horses whose type defined as 'Stallion' in the horses table. (The same applies for Mare).</p>\n\n<p>I have a class 'DatabaseHelper' to create and upgrade the tables, and each table has its own adapter class 'horsesDbAdapter' and 'coversDbAdapter' that contains the methods to add, edit and delete entries, and relevant queries. (fetchAllHorses(), fetchHorse(long rowId) )</p>\n\n<p>eg:</p>\n\n<pre><code>    public Cursor fetchAllHorses() {\n\n    return mDb.query(DATABASE_TABLE,\n            new String[] { KEY_ROWID, KEY_NAME, KEY_TYPE, KEY_BIRTHDATE,\n                    KEY_VACCINEDATE, KEY_INFOAL, KEY_NOTES }, null, null,\n            null, null, null);\n}\n</code></pre>\n\n<p>(It's all adapted from the Android notepad example)</p>\n\n<p>I have the contents of the covers table displayed in a listview (just showing the stallionName and mareName). But as those fields just contain the unique reference to the horses table all that is displayed is the fairly uninformative _id field.</p>\n\n<p>My question is; how can I get the relevant name for the horses to display in the listView? I've read up on join queries etc but get lost when I try implement them. I assume I have to join on horses._id and covers.stallionName (then make an almost-identical one for MareName) but I can't find a concrete example of how to do this.</p>\n\n<p>Please let me know if any additional information/ code is needed.</p>\n\n<p>Any help would be greatly appreciated, thankyou in advance.</p>\n\n<p>EDIT:\nI have made stallionName and mareName foreign keys referencing (_id) in the horses table, but am still unsure how and where to implement the join query; should it be in the horsesDbAdapter, coversDbAdapter or the coversList class? (coversList is the class that creates and populates the listView)\nThe covers table declaration now reads;</p>\n\n<pre><code>    private static final String COVERS_CREATE = \"create table covers (_id integer primary key autoincrement, \"\n        + \"stallionName integer not null, mareName integer not null, firstCoverDate text not null, lastCoverDate text not null, \"\n        + \"scan14Date text not null, scan28Date text not null, foalingDate text not null, inFoal integer not null, notes text not null,\" +\n        \"FOREIGN KEY (stallionName) REFERENCES horses (_id), FOREIGN KEY (mareName) REFERENCES horses (_id));\";\n</code></pre>\n"},{"tags":["c#","jquery","asp.net","query","validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12701081,"title":"cannot call jquery dialog from code when there is validation in the front","body":"<p>I used a validation field and expression at the script in the front, but this prevents me from calling the jQuery dialog from the code-behind. When i remove the validation code I am able to call jQuery dialog.</p>\n\n<p>I'm calling the jQuery dialog in the code-behind using register script like this (not working if the validation is not removed).</p>\n\n<pre><code>string jqueryFunction = @\"My dialog codes\";\nClientScript.RegisterStartupScript(GetType(), \"js\", jqueryFunction, true);\n</code></pre>\n\n<p>Can anyone solve this problem? I want to put the database data into the dialog from the code-behind when I click on a link. If not calling the form from behind, but from the front, how do I pass the query data into the form when the link is clicked?</p>\n"},{"tags":["java","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":121,"score":1,"question_id":12684732,"title":"Result Set return null value","body":"<p>I'm having a trouble when retrieving in a very simple SELECT query.\nI'm trying to retrieve all information from table 'db_con_type' and put them in array String of dbChoices.</p>\n\n<p>Database:</p>\n\n<p>The Select query works fine in report designer. Sorry i can't upload the images since i'm new here.</p>\n\n<p>Code:</p>\n\n<pre><code>public void setDbTypeChoices()\n    {\n       try\n        {\n            con2db connect2db = new con2db();\n            con = connect2db.aksesDatabase();\n            stmt = con.createStatement();\n            String sql = \"SELECT * FROM db_con_type\";\n\n            rs = stmt.executeQuery(sql);\n\n            int i = 0;\n            while(rs.next())\n            {\n                this.dbChoices[i] = rs.getString(\"DB_Type\");\n                i++;\n            }\n\n            rs.close();\n            stmt.close();\n            ps.close();\n            con.close();\n\n            //Close Connection\n            connect2db.tutupKoneksi();\n        }\n       catch(Exception e)\n       {\n           System.out.println(\"SQL ERROR 1 = \" + e.getMessage());\n           System.out.println(\"SQL ERROR 2 = \" + e.toString());\n       }\n    }\n</code></pre>\n\n<p>Error: </p>\n\n<p>SQL ERROR 1 = null</p>\n\n<p>SQL ERROR 2 = java.lang.NullPointerException</p>\n\n<p>Question:</p>\n\n<p>Any idea what is happening? Any Solution?</p>\n\n<p>Thanks</p>\n"},{"tags":["database","query","dynamic"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12695546,"title":"Dynamic table name in select query","body":"<p>How can I put a table name dynamically in a query?</p>\n\n<p>Suppose I have a query as shown below:</p>\n\n<p>Am creating a table at runtime and inserted tablename on history table.<br>\nI found a table name and doing like this:</p>\n\n<pre><code>select @tablename = tablename1 from dividendCalc \nset @query = 'select * from '+@tablename+'' \nexec(@query)\n</code></pre>\n\n<p>But I don't want to use string query.</p>\n\n<p>There is way to finding table name as well as tables column name from database, but how to find table data? Please suggest me.</p>\n"},{"tags":["mysql","sql","query","optimization"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12700102,"title":"How do I speed up a SQL query that uses a BETWEEN condition?","body":"<p>I have a table that looks like this:</p>\n\n<pre><code>ID    StartRange    EndRange\n----------------------------\n 1        1            3\n 2        4            8\n 3        9           12\n</code></pre>\n\n<p>And so on and so forth, so that there are over 5 million records. The last record looks something like this:</p>\n\n<pre><code>ID        StartRange    EndRange\n---------------------------------\n5235976   9894727374   9894727378\n</code></pre>\n\n<p>In other words, the <code>StartRange</code> and <code>EndRange</code> will never overlap for each record.</p>\n\n<p>I need to do a query that finds the corresponding ID of a number that matches the range:</p>\n\n<pre><code>SELECT ID FROM BigTable WHERE '5000000' BETWEEN StartRange AND EndRange;\n</code></pre>\n\n<p>Unfortunately, this query takes several seconds to complete. I need to optimize it so that it takes the least amount of execution time. I did a little bit of research it looks like adding an index is not helpful because it would only apply if the number is exactly the <code>StartRange</code> or <code>EndRange</code> value, but not if it's between.</p>\n\n<p>Does anyone have any tips or tricks I can use to bring down the execution time? Ideally I'd want it to be under 1 second if possible.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","query","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12700059,"title":"Rails Active Record Query - problems retrieving a single object","body":"<p>My goal is to return a single object in a Rails Active Record query.  I want to retrieve the most recent record when the table is sorted by the created_at date. So, in the example below, that means I want to return the record with the ID of 2. I don't understand why the 4 queries below all return the same result?</p>\n\n<p><strong>Sales Table Records</strong></p>\n\n<pre><code> +----+---------+-------+------------+----------------------------+\n | ID | user_id | price | sale_date  |         created_at         |\n +----+---------+-------+------------+----------------------------+\n |  1 |       1 |   200 | 2012-08-07 | 2012-10-02 23:01:46.706727 |\n |  2 |       1 |   400 | 2009-05-11 | 2012-10-02 23:09:01.342879 |\n +----+---------+-------+------------+----------------------------+\n</code></pre>\n\n<p><strong>Queries:</strong></p>\n\n<pre><code> &lt;%= current_user.sales.order(\"created_at\").last.price %&gt;\n</code></pre>\n\n<p>returns: 200</p>\n\n<pre><code> &lt;%= current_user.sales.order(\"created_at DESC\").last.price %&gt;\n</code></pre>\n\n<p>returns: 200</p>\n\n<pre><code> &lt;%= current_user.sales.order(\"created_at ASC\").last.price %&gt;\n</code></pre>\n\n<p>returns: 200</p>\n\n<pre><code> &lt;%= current_user.sales.last.price %&gt;\n</code></pre>\n\n<p>returns: 200</p>\n\n<p>I also tried:</p>\n\n<pre><code> &lt;%= current_user.sales.last(\"created_at\").price %&gt;\n</code></pre>\n\n<p>returns: <code>undefined method 'assert_valid_keys' for \"created_at\":String</code></p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12699932,"title":"How to only return unique values without COUNT or GROUP in MySQL","body":"<p>My database class has me stumped on this problem. If anyone could help me that would be great</p>\n\n<p>I have a table that has 2 columns. Column 1 is soda types (Coke, Pepsi, Dr. Pepper, etc) and Column 2 is names of people. People can drink multiple types of soda.</p>\n\n<p>Some entries might be</p>\n\n<ol>\n<li>Coke Jeremy</li>\n<li>Diet Coke Sam</li>\n<li>Dr. Pepper Jeremy</li>\n</ol>\n\n<p>I have to write a query that returns people that only drink one kind of soda. So Jeremy would not be returned, but Sam would. THe problem is I can't use COUNT or GROUP (or any aggregate functions)! How would I do this without those?</p>\n\n<p>Thanks!</p>\n"},{"tags":["android","query","contacts","android-2.0"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3498,"score":3,"question_id":1987797,"title":"Android - Get All Contacts from All Sources","body":"<p>I have been attempting to make an Android application, built against 2.0, that requires getting all of the user's contacts and displaying them in a formatted way.</p>\n\n<p>I have been able to get a list using a <code>Cursor</code> and the <code>ContactsContract.Contacts</code> class. However, the list I get from that provider only gives me the contacts that are either from the user's Google account, or contacts that have two or more sources (e.g. Google + Facebook, Two Facebook accounts, etc). It does not give me the entire list.</p>\n\n<p>Those that seem left out are primarily those that come only from the user's Facebook account, and have no other source.</p>\n\n<p>This is the query call I'm using:</p>\n\n<pre><code>Cursor contactsCursor = getContentResolver()\n    .query(android.provider.ContactsContract.Contacts.CONTENT_URI, \n        null, null, null, null);\n</code></pre>\n\n<p>My question is is it possible to get all the contacts from every single source (Google, Facebook, etc) in the user's phonebook?</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":12698867,"title":"php while loop only displays one result for a mysql query across multiple tables","body":"<p>I am having an issue with a while statement only returning one result. this is my first time trying to display product information from several tables and I don't know what I'm doing wrong. here is the code:</p>\n\n<pre><code>&lt;?php\n    require('./includes/config.inc.php');\n    require(MYSQL);\n\n    $sql = sprintf(\"SELECT * FROM tea\");\n\n    $res = mysqli_query($dbc, $sql);\n\n    if(!$res){\n    die('Could not complete query: '.mysqli_error($dbc));\n    } else {\n\n    echo 'Success!&lt;br /&gt;';\n\n    while($row = mysqli_fetch_array($res)){\n        $table = $row['category'];\n        $inum = $row['item_number'];\n\n        echo $table.' '.$inum.'&lt;br /&gt;';\n\n        $fetch = sprintf(\"SELECT sub_category, item_name, description FROM $table WHERE item_number ='$inum'\");\n        $fetchRes = mysqli_query($dbc, $fetch);\n\n        if(!$fetchRes){\n            die('Could not fetch: '.mysqli_error($dbc));\n        } else {\n            while($fetchRow = mysqli_fetch_array($fetchRes)){\n                $subCat = $fetchRes['sub_category'];\n                $iNumber = $inum;\n                $iname = $fetchRes['item_name'];\n                $desc = $fetchRes['description'];\n\n                echo $id.' '.$subCat.' '.$iNumber.' '.$iname.' '.$desc.'&lt;br /&gt;';\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["oracle","query","logging","parameters"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12535114,"title":"Oracle: show parameters on error","body":"<p>When Oracle logs a parameterized SQL query failing, it shows \"?\" in place of the parameters, i.e. the query before replacing parameters. For example, </p>\n\n<pre><code>\"SELECT * FROM table where col like '?'\" \nSQL state [99999]; error code [29902]; \nORA-29902: error in executing ODCIIndexStart() routine ORA-20000: \n  Oracle Text error: DRG-50901: \n  text query parser syntax error on line 1, column 48\n</code></pre>\n\n<p>Is there a way to change logging so it shows the <strong>parameter values</strong>? The information above is absolutely useless unless I can see what the actual parsing problem was. </p>\n\n<p>In general, is there a way to set logs in Oracle to show parameters in parameterized query errors?</p>\n"},{"tags":["php","forms","query","onclick","radio"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12698551,"title":"Immediately update database on click of radio","body":"<p>I have several forms with radio buttons on a page. My goal is to have the database updated immediately on the click of a radio button. Here is what I have put together so far, but I'm not sure where to go from here.</p>\n\n<pre><code>&lt;? include 'dbconnect.inc.php';?&gt;\n&lt;script type=\"text/javascript\"&gt;function do_submit(){document.forms['decision'].submit();}&lt;/script&gt;\n\n&lt;? $result = $mysqli-&gt;query(\"SELECT * FROM items\");\n   while( $row = $result-&gt;fetch_assoc() ){ ?&gt;\n   &lt;form name='decision' method='post' action='action.php'&gt;\n       &lt;label&gt;Keep:&lt;/label&gt;&lt;input type='radio' name='dec' value='keep' onchange='do_submit()' &lt;? if($row['Dec1']=='keep'){echo \"checked='checked'\";} ?&gt; &gt;\n       &lt;label&gt;Donate:&lt;/label&gt;&lt;input type='radio' name='dec' value='donate' onchange='do_submit()' &lt;? if($row['Dec1']=='donate'){echo \"checked='checked'\";} ?&gt; &gt;\n       &lt;label&gt;Sell:&lt;/label&gt;&lt;input type='radio' name='dec' value='sell' onchange='do_submit()' &lt;? if($row['Dec1']=='sell'){echo \"checked='checked'\";} ?&gt; &gt;\n       &lt;label&gt;Trash:&lt;/label&gt;&lt;input type='radio' name='dec' value='trash' onchange='do_submit()' &lt;? if($row['Dec1']=='trash'){echo \"checked='checked'\";} ?&gt; &gt;\n       &lt;label&gt;Give To:&lt;/label&gt;&lt;input type='text' name='dec' size='15' onchange='do_submit()' &lt;? if($row['Dec1']!='keep' || $row['Dec1']!='donate' || $row['Dec1']!='sell' || $row['Dec1']!='trash'){echo $row['Dec1'];} ?&gt; &gt;\n       &lt;input type='hidden' name='Id' value='&lt;? echo $row['Id']; ?&gt;' /&gt;\n   &lt;/form&gt;\n   &lt;? } ?&gt;\n</code></pre>\n\n<p>action.php</p>\n\n<pre><code>&lt;? $mysqli-&gt;query(\"UPDATE items SET  Dec1 =  '{$_POST['dec']}' WHERE Id = '{$_POST['$Id']}'\") or die(mysqli_error($mysqli)); ?&gt;\n</code></pre>\n\n<p>Am I anywhere close? Can someone help me through this?</p>\n"},{"tags":["query","google-app-engine","store","synchronous","objectify"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12673255,"title":"Isolating app engine queries in java","body":"<p>Recently, I am trying to develop a simple chat server where its job is to query for unread messages, modify them to <code>read</code> (set them as <code>delivered</code>), save them back to db and return this list to the caller.</p>\n\n<p>The issue is that this action is not performed synchronously (isolated).\nIn other words it means that if I send a message (e.g. \"Hello World!\"), this message is queried twice. As long as there is a problem with setting its <code>delivered</code> attribute to <code>true</code>.</p>\n\n<p>What I found out by debugging is that the modification of message object and storing it back to DB does not finish even at second or third request for getting unread messages. \nI have read almost all Google tutorials but none of them help.</p>\n\n<p><strong>Here is the simplified code which does this:</strong></p>\n\n<pre><code>public class DBHandler {\n\n    private static Objectify ofy = null;\n\n    static {\n        ObjectifyService.register(MessageFromA.class);\n        ObjectifyService.register(MessageFromB.class);\n    }\n\n    public DBHandler() {\n        try {\n            ObjectifyService.register(MessageFromA.class);\n            } catch (Exception e) {\n        }\n\n        try {\n            ObjectifyService.register(MessageFromB.class);\n            } catch (Exception e){\n        }\n    }\n\n    private static boolean locked = false;\n\n    public static synchronized List&lt;? extends Message&gt; getUnreadMessagesFromA() {\n\n        while(locked); // wait if db is in access.\n        locked = true;\n        List&lt;MessageFromA&gt; returnList = new ArrayList&lt;MessageFromA&gt;();\n\n        try {\n            ObjectifyOpts oop = new ObjectifyOpts();\n            oop.setSessionCache(false);\n            oop.setGlobalCache(false);\n            oop.setConsistency(Consistency.STRONG);\n            ofy = ObjectifyService.begin(oop);\n            List&lt;MessageFromA&gt; tempResult =     ofy.query(MessageFromA.class).filter(\"delivered\", false).order(\"sendDate\").list();\n\n            for(MessageFromA message : tempResult) {\n                message.setDelivered(true);\n                returnList.add(message);\n            }\n\n            ofy.put(tempResult);\n            return returnList;\n\n        } catch (Exception e) {\n            e.printStackTrace();\n            return null;\n        } finally {\n            locked = false;\n        }\n    } \n}\n</code></pre>\n\n<p>Can somebody suggest me a solution? Any help is appreciated.</p>\n"},{"tags":["mysql","sql","query","view"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":156,"score":4,"question_id":10462103,"title":"How do I write a simple select query instead of using views?","body":"<p>Find patients who visited two different doctors of the same specialty in the same day.</p>\n\n<p>Example database: <a href=\"http://sqlfiddle.com/#!2/cdd98/68\" rel=\"nofollow\"><strong>Click here to view the sample data script in SQL Fiddle.</strong></a></p>\n\n<pre><code>CREATE VIEW DistinctVisits AS\nSELECT v.vid,v.pid,d.speciality,v.date\nFROM Visits v ,Doctors d\nWHERE d.did=v.did\nGROUP BY v.pid,v.did,v.date;\n\nCREATE VIEW DistinctVisits2 AS\nSELECT dv.pid,dv.speciality,dv.date, COUNT(dv.vid) as countv\nFROM DistinctVisits dv\nGROUP BY dv.pid,dv.speciality,dv.date;\n\nSELECT dv2.pid,dv2.speciality\nFROM DistinctVisits2 dv2\nWHERE dv2.countv=2;\n\nDROP VIEW DistinctVisits;\nDROP VIEW DistinctVisits2;\n</code></pre>\n\n<p>how do i repeat the same idea but on just one big query?\nanother solutions would be nice as well, but try to help me improve this one first.</p>\n"},{"tags":["mysql","query","reporting-services","parameters","report"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12692525,"title":"rs report design parametrized query for MySQL","body":"<p>I have a Mysql DB report with visual studio report server and is displaying correctly in report server.</p>\n\n<p>but i want to do a parametrized query and after reading and searching i know the obdc driver cant pass @ and i have to use '?' but after trying a lot i cant figured out how to implemented.</p>\n\n<p>I have a @parameter which use a secodn dataset that query the db for usernames</p>\n\n<p>i have my main dataset with the where (<code>user</code> = '?') and in the dataset parameter tab i try putting an expression with the select query for user and try use the actual parameter.</p>\n\n<p>am a little lost here.</p>\n"},{"tags":["mysql","sql","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":10030242,"title":"best query to update a big mysql database (rows) against a badword list","body":"<p>I have a table with 8 million rows, which needs to be scanned against a huge list of badwords.</p>\n\n<p>My first idea was to:</p>\n\n<pre><code>UPDATE `master` SET `blacklisted`='1' WHERE MATCH (`content-desc`, `content-title`) AGAINST ('\nbadword1 | badword2 | badword3 | \"and many more\"' IN BOOLEAN MODE)\n</code></pre>\n\n<p>unfortunately this version forgot some words and was not case-insensitive!</p>\n\n<p>next try was to </p>\n\n<pre><code>$badwords = array(\"badword1\",\"badword2\",\"badword3\",\"and-many-more\");\n\nforeach($badwords AS $name)\n   {\n        $sql = \"UPDATE `master` SET `blacklisted`='1' WHERE concat(`content-title(mediumtext)`,`content-desc(mediumtext)`)  LIKE '%\".$name.\"%'\";\n\n        sleep(6);\n\n// Could limit this query by 100.000 and adding another foreach loop help?\n// How would the foreach look like (select count(*) from master?)/100.000\n\n   }\n</code></pre>\n\n<p>a lot of queries which killed my server immediately!\nMaybe the commented idea could help?! (but howto?)</p>\n\n<p>Who has the best idea how to solve this query, without stressing the mysql server too much?\nThank you!</p>\n"},{"tags":["php","mysql","database","query","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12696302,"title":"PHP Retrieiving Column Data from database","body":"<p>I have an earlier post <a href=\"http://stackoverflow.com/questions/12695162/php-mysql-retrieve-name-based-on-another-criterion/12695505#12695505\">here</a>\nBut NONE of those answers worked. So here's my entire class code:</p>\n\n<pre><code>&lt;?php\nsession_start();\nclass Mysql {\n    private $conn;\n\n    function __construct() {\n        $this-&gt;conn =  new PDO('mysql:host=***;dbname=***;charset=UTF-8','***','***') or \n                      die('There was a problem connecting to the database.');\n    }\n\n    function verify_Username_and_Pass($un, $pwd) {\n        $query = \"SELECT Username\n                FROM Conference\n                WHERE Username = :un AND Password = :pwd\";\n\n        $stmt = $this-&gt;conn-&gt;prepare($query);\n\n        $stmt-&gt;bindParam(':un', $un);\n        $stmt-&gt;bindParam(':pwd', $pwd);\n        $stmt-&gt;execute();\n        if ($stmt-&gt;rowCount() &gt; 0) {\n            // User exist\n            $stmt-&gt;bindColumn('First Name', $firstName); \n            $_SESSION[\"FirstName\"] = $firstName; \n            die($_SESSION[\"FirstName\"]);\n            return true;\n            $stmt-&gt;close();\n        }\n        else {\n            // User doesn't exist\n            //die(\"failure\");\n            return false;\n            $stmt-&gt;close();\n        }\n    }\n}\n?&gt;\n</code></pre>\n\n<p>I've tried fetch, i've tried bind_result, etc and none of them print the correct value on the die statement. Now this <strong>worked</strong> when i stored username in session and tried to print that. What is wrong with the code? </p>\n"},{"tags":["php","mysql","query","mysql-error-1064"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12696154,"title":"Date when record was created in mysql datatabase","body":"<p>I have table in which I have birthdate , age location and Score and I want to retrieve the count of number of records created between two dates where score is not null and there is no time stamp field. How can I do it if there is no time stamp field. is there any meta data and if it is , how can I run the query? thanks for your help guys. </p>\n"},{"tags":["query","stored-procedures","execute","dapper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12694051,"title":"Dapper (connection.Query or connection.Execute)","body":"<p>I see the example of using Dapper in executing stored procedures with dynamic parameters, and returning the results of the procedure.  Usually, the examples use .Execute, but a few of them use .Query.  I have difficulty in using .Execute.  Which am I supposed to use in the case described above--query or execute AND in what cases would I use each?</p>\n\n<p>Thanks,\nKevin</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":12694113,"title":"How do I make sure a value is not returned if it is connected to multiple values, one which is undesired?","body":"<p>My question isn't perfectly phrased, but basically here's the question.</p>\n\n<p>I have two columns in a table \"works\". One column is a list of last names, and the other is a list of cities where the people live.</p>\n\n<p>I don't want my query to return anybody who lives in Chicago.</p>\n\n<p>My current code is:</p>\n\n<pre><code>select lives.last_name \nfrom lives  \nwhere lives.city &lt;&gt; \"Chicago\";\n</code></pre>\n\n<p>But some people live in both Chicago and somewhere else, say Miami, and they still show up. How do I only return people who don't live in Chicago without using group or count functions (not that far yet)</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","query","sql-in"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12688870,"title":"MSSQL: IN with hardcoded value vs. IN with SQL query","body":"<p>I have the following query:</p>\n\n<pre><code>SELECT c004, mesosafe, CAST(SUBSTRING (c000 ,1 , 5) as int) as sortorder, c001, c000, c002\nFROM DE_DATA.dbo.t309\nWHERE c001 IS NOT NULL\nAND c002 = 1\nAND mesocomp = 'EMTD'\nAND mesoyear IN (\n    SELECT MAX(mesoyear) AS currmesoyear\n    FROM DE_DATA.dbo.t001\n)\nAND CAST(SUBSTRING (c000 ,1 , 5) as int) &lt; 101\nORDER BY c000 ASC;\n</code></pre>\n\n<p>This query fails because some values of <code>c000</code> cannot be casted because they look like <code>008-</code> instead of <code>00052-</code>. Here the <code>mesoyear</code> is asked (mesoyear IN ...). If I query this SQL part alone I get <code>1344</code> as result.</p>\n\n<p>On the other side this query works:</p>\n\n<pre><code>SELECT c004, mesosafe, CAST(SUBSTRING (c000 ,1 , 5) as int) as sortorder, c001, c000, c002\nFROM DE_DATA.dbo.t309\nWHERE c001 IS NOT NULL\nAND c002 = 1\nAND mesocomp = 'EMTD'\nAND mesoyear IN (\n    '1344'\n)\nAND CAST(SUBSTRING (c000 ,1 , 5) as int) &lt; 101\nORDER BY c000 ASC;\n</code></pre>\n\n<p>So what is the difference between hardcoded values and the SQL query?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I think the reason is that the subquery is evaluated later than the main query. Can it be? What can I do against this?</p>\n"},{"tags":["sql","oracle","query","data-warehouse","analytic-functions"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":940,"score":1,"question_id":6847814,"title":"Group by vs Partition by in Oracle","body":"<p>I am writing a query to fetch records from a Oracle warehouse. Its a simple Select Query with joins on few tables and i have few columns to be aggregated. Hence i end up using Groupby on rest of the columns. </p>\n\n<p>Say I am picking some 10 columns and out of which 5 is aggregate columns. so i need to group by on the other 5 columns. I can even achieve the same by not doing a Groupby and using over (paritition by) clause on the each each aggregate column i want to derive. </p>\n\n<p>I am not sure which is better against a warehouse or in general.</p>\n"},{"tags":["query","postgresql","string-matching"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12214668,"title":"Check IF String1 = String2 (with just 1 typo) in postgresql (fuzzymatch & levenshtein unavailable)","body":"<p>I need to check if an e-mail address matches another with the possible exception of one typo (e.g. \"hormail\" instead of \"hotmail\", a letter missing, or an extra letter).</p>\n\n<p>It's a postgresql (version 9.1.4) query, and neither fuzzymatch nor levenshtein is available.</p>\n"},{"tags":["wordpress","query","permalinks"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":12692652,"title":"The permalinks in my wordpress post query will not work until the page is refreshed","body":"<p>I put a query post on the front page of our site that pulls my own posts out of the company blog. It works fine, but that the permalinks do not work unless the page is refreshed after loading. Any help understanding why would be very much appreciated. Thank you! </p>\n\n<p>Here is the code:</p>\n\n<pre><code>&lt;div style=\"float:left; display:inline; margin-left:385px; margin-top:-225px;\"&gt;\n&lt;?php query_posts('showposts=5&amp;author=4'); ?&gt;\n&lt;?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?&gt;\n\n&lt;div&gt;\n\n\n&lt;!-- Display the Title as a link to the Post's permalink. --&gt;\n\n&lt;div id=\"post-&lt;?php the_ID(); ?&gt;\" &lt;?php post_class(); ?&gt;&gt;&lt;a href=\"&lt;?php the_permalink() ?&gt;\" rel=\"bookmark\" title=\"&lt;?php the_title_attribute(); ?&gt;\"&gt;&lt;?php the_title(); ?&gt;&lt;/a&gt;&lt;/div&gt;\n</code></pre>\n"},{"tags":["mysql","query","blob","bitset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12688666,"title":"How to get bitset BLOBs from Mysql select ID queries?","body":"<p>It would be absolutely great if the following thing was possible:</p>\n\n<p>Let's say I've got a 'document' mysql table, with a document 'id' and a few other columns:</p>\n\n<pre><code>CREATE TABLE document(id INT AUTO_INCREMENT NOT NULL, ....);\n</code></pre>\n\n<p>There can be quite a lot of document, but let's say that for now I've got only 2 millions.</p>\n\n<p>I'd like to get the result of this query in my programming language space quickly:</p>\n\n<pre><code>SELECT id FROM document WHERE ... whatever ...;\n</code></pre>\n\n<p>The clause 'whatever' is potentially empty, so the set can contain the id's of all documents.</p>\n\n<p>So my question is: is there a way to get the result of this query as bit vector BLOB of size 2 million bits (~ 250k of data) instead of potentially 2 millions of stringified numbers ( ~ 14Mo .. not great).</p>\n\n<p>Extra kudos for blob compression in case of sparse sets :)</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12691294,"title":"How to replace only few characters from a string in mysql?","body":"<p>I have a field <code>urn_sem.studentid</code> that I'd like to replace a few characters in; for example:</p>\n\n<ul>\n<li><code>ABC/2011/BCOMH_NC/I/12</code> &rarr; <code>ABC/2011/BCOMH/I/12</code></li>\n<li><code>ABC/2011/BCOMH_NC/I/24</code> &rarr; <code>ABC/2011/BCOMH/I/24</code></li>\n</ul>\n\n<p>I've tried this query:</p>\n\n<pre><code>SELECT REPLACE(studentid, 'KNC/2011/BCOMH_NC/', ' KNC/2011/BCOMH/')\n  FROM urn_sem\n</code></pre>\n\n<p>but it doesn't show the new value.</p>\n"},{"tags":["php","mysql","query"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12690841,"title":"mysql query select count","body":"<p>I must use count and group and I'm a little confused.</p>\n\n<p>I have 2 tables:</p>\n\n<ul>\n<li><p><code>users</code></p>\n\n<pre>id_user | firstname | lastname | genre | logo_src</pre></li>\n</ul>\n\n<p>and</p>\n\n<ul>\n<li><p><code>user_stalking</code></p>\n\n<pre>user_id | user_stalking_id</pre></li>\n</ul>\n\n<p>At the moment, my query looks like:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT   us.user_id, us.user_stalking_id, us.notification_viewed, u.id_user,\n         u.firstname, u.lastname, u.logo_src, u.genre, us.id, us.date\nFROM     users u, user_stalking us\nWHERE    us.user_id = \".$_SESSION['user']['id_user'].\"\n     AND us.notification_viewed = 0\n     AND us.user_stalking_id = u.id_user\nORDER BY us.date DESC\n</code></pre>\n\n<p>and it returns:</p>\n\n<pre>John | Jonson | image1.png | male</pre>\n\n<p>Now I want to receive count of all rows that contains them same ID in the <code>user_stalking.user_id</code> and <code>user_stalking.user_stalking_id</code> fields.</p>\n"},{"tags":["query","data","dynamics-crm-2011","manipulation","programmming"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12681850,"title":"Simplest Method for getting data from Dynamic CRM","body":"<p>Our current setup is as follows, and fairly unmaintainable if our dataset changes.  </p>\n\n<p>We currently export data from CRM to an excel sheet which gets updated regularly through the use of a Excel-CRM plugin.  This already runs into a problem because the automated scripts that are in place can't update and save the file if someone leaves it open (currently running scripts during off hours but still sometimes people are a little \"special\").</p>\n\n<p>After pulling and saving the data we have some scripts that manipulate the data in python and output JSON to a metrics dashboard that is in the company breakroom, this dashboard is supplied information from multiple sources (this is why we can't just use Dynamics CRM's built in dashboard).</p>\n\n<p>My question is thus, I would like a more direct approach to getting the data from CRM to our Dashboard - thus cutting out the need for the excel-CRM plugin as a middle man - I've been looking into the options and I'm not sure which one would best suit our situation.</p>\n\n<p>Current options are as follows:</p>\n\n<ol>\n<li>Javascript and either the Microsoft REST API or SOAP transactions</li>\n<li>Python and SOAP transactions using PyCurl or some other system that can do SOAP calls (not sure if it allows for REST but I don't think so).</li>\n<li>Using the Microsoft SDK and C# to get the information needed (not a great option since I don't know C#)</li>\n<li>Using the Microsoft SDK and IronPython? (is this even viable? has anyone else tried it)</li>\n</ol>\n\n<p>These are the options that I've fleshed out, I'm looking for something simple and fairly easily implementable to reach the goal of getting CRM data and being able to manipulate it w/o having to pull the data to excel from the plugin.</p>\n"},{"tags":["c#","asp.net","sql-server","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12689996,"title":"SQL search problems","body":"<p>So here is my problem: I have a site where I have to search through the stuff on it.\nThis is my sql sentence:</p>\n\n<pre><code>public DataTable Search(string Keyword)\n{\n    return db.GetData(\"SELECT * FROM tblBehandlinger WHERE fldYdelse LIKE @1\", \n                  \"%\" + Keyword + \"%\");\n}\n</code></pre>\n\n<p>But as you can see it will only search through the table name \"fldYdelse\". And I works fine, but my problem is that it wont search through two things.\nThis I how I want it to be:</p>\n\n<pre><code>public DataTable Search(string Keyword)\n{\n    return db.GetData(\"SELECT * FROM tblBehandlinger WHERE fldYdelse LIKE \n                       @1 OR fldPris @2\", \"%\" + Keyword + \"%\");\n}\n</code></pre>\n\n<p>This is my backend of the <code>search.aspx</code> site:</p>\n\n<pre><code>string keyword = Request.QueryString[\"search\"].ToString();\n\nforeach (DataRow item in s.Search(keyword).Rows)\n{\n    //BLAH BLAH BLAH\n}\n</code></pre>\n\n<p>But I can't list it out.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12689782,"title":"How To Count Rows But Based On Another Column?","body":"<p>I have this table : </p>\n\n<pre><code>+--------------+-----------------------------+----------------+\n| Username     | Message                     | Status         |\n+--------------+-----------------------------+----------------+\n| jamesbond    | I need some help            | SendingOK      |\n| jamesbond    | I need some help            | SendingOK      |\n| jamesbond    | I need some help            | SendingFailed  |\n| jamesbond    | Mission accomplished        | SendingOK      |\n+--------------+-----------------------------+----------------+\n</code></pre>\n\n<p>produced by this SQL syntax :</p>\n\n<pre><code>SELECT A.Username, A.Message, B.Status\nFROM db1.SmsBroadcast as A\nINNER JOIN db2.sentitems as B \nON A.MessageSMS1 = B.TextDecoded\nWHERE A.Username = 'jamesbond'\nGROUP BY Message, Status\n</code></pre>\n\n<p>now how to have this output?</p>\n\n<pre><code>+--------------+-----------------------------+-----------+---------------+\n| Username     | Message                     | SendingOK | SendingFailed |\n+--------------+-----------------------------+-----------+---------------+\n| jamesbond    | I need some help            | 2         | 1             |\n| jamesbond    | Mission accomplished        | 1         | 0             |\n+--------------+-----------------------------+-----------+---------------+\n</code></pre>\n\n<p><code>SendingOK</code> and <code>SendingFailed</code> column is actually can be calculated using <code>COUNT(*)</code>, but I have no idea how to count based on same Message, while those message is executed in same SQL syntax. any idea how to do it?</p>\n"},{"tags":["django","query","orm","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12661502,"title":"How to get ForeignKey Object in one query","body":"<p>I have question about how to get Django ForeignKey Object in one query, I have taken an age to  make this work. </p>\n\n<pre><code>`#models.py`\nclass Brochure(models.Model):\n    title = models.CharField(max_length=64)\n    created = models.DateTimeField(auto_now_add=True)\n    update = models.DateTimeField(auto_now=True)\n\n    def __unicode__(self):\n        return self.title\n\nclass BrochureFile(models.Model):\n    file = models.FileField(upload_to='brochure/')\n    brochure = models.ForeignKey(Brochure, related_name='files')\n\nclass BrochureInline(admin.TabularInline):\n    model = BrochureFile\n    extra = 3\n\nclass BrochureAdmin(admin.ModelAdmin):\n    list_display = ['title', 'created']\n    search_fields = ['title']\n\n    inlines = [BrochureInline,]\n\nadmin.site.register(Brochure, BrochureAdmin)\n</code></pre>\n\n<p>In my template, i want to display list of brochure and files</p>\n\n<pre><code>My Template - brochure.html\n\n**Brochure 1 title**\n    Brochure 1 file 1\n    Brochure 1 file 2\n    Brochure 1 file 3\n\n**Brochure 2 title**\n    Brochure 2 file 1\n    Brochure 2 file 2\n    Brochure 2 file 3\n\nand so on...\n</code></pre>\n\n<p>anyone know how to solve this problem?</p>\n"},{"tags":["sql","query","select","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12688085,"title":"SQL Joining multiple tables, columns from 3rd table not showing","body":"<p>Hello i've the following SQL query</p>\n\n<pre><code> Select catalogid , numitems, allitems - numitems ignoreditems\n        from ( \n        select i.catalogid,\n         sum(case when (ocardtype in ('PayPal','Sofort') OR\n                        ocardtype in ('mastercard','visa') and\n                        odate is not null) then numitems\n                        else 0 end) numitems,\n         sum(numitems) allitems \n        from orders o\n        join oitems i on i.orderid=o.orderid\n        join products T1 on T1.catalogid = i.catalogid\n        group by i.catalogid\n        ) X \n</code></pre>\n\n<p>in the last join statement table products contains 8 columns and they don't show in the result query, i can only see the columns catalogid, numitems and ignoreditems, so what am i doing wrong, if i have to select those columns in order to make them appear how can i do it with this syntax?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12688080,"title":"sql query to combin results from same table","body":"<p>i have table <strong>Customers</strong> (id,name) <strong>Phones</strong> (id,customerId,phoneType,phone)\nis it posssible to write a query that return row like this:</p>\n\n<p>CustomerId, CustomerName, Phone1, Phone2, Mobile1, Mobile2 </p>\n\n<p>Phone1,Phone2,Mobile1,Mobile2 are phone types</p>\n\n<p>i tried </p>\n\n<pre><code>select id as CustomerId, name as CustomerName, phone as Phone1\nfrom Customers, Phones\nwhere Customers.id = Phones.customerId and \nPhones.phoneType = N'Phone1'\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":8,"view_count":185,"score":-4,"question_id":10462850,"title":"How can I improve this query to avoid using nested views?","body":"<p>Find patients who visited all orthopedists (specialty) associated with their insurance companies.</p>\n\n<p>Database: <a href=\"http://sqlfiddle.com/#!2/f1601/7\" rel=\"nofollow\"><strong>Click here to view the sample data script in SQL Fiddle.</strong></a></p>\n\n<pre><code>CREATE VIEW Orthos AS\nSELECT  d.cid,d.did\nFROM    Doctors d\nWHERE d.speciality='Orthopedist';\n\nCREATE VIEW OrthosPerInc AS\nSELECT  o.cid, COUNT(o.did) as countd4i\nFROM Orthos o\nGROUP BY o.cid;\n\nCREATE VIEW OrthoVisitsPerPat AS\nSELECT v.pid,COUNT(o.did) as countv4d\nFROM Orthos o,Visits v,Doctors d\nWHERE o.did=v.did and d.did=o.did\nGROUP BY v.pid,d.cid;\n\nSELECT  p.pname,p.pid,p.cid\nFROM  OrthoVisitsPerPat v, OrthosPerInc i,Patient p\nWHERE i.countd4i = v.countv4d and p.pid=v.pid and p.cid=i.cid;\n\nDROP VIEW IF EXISTS Orthos,OrthosPerInc,OrthoVisitsPerPat;\n</code></pre>\n\n<p>How can i write it on one query?</p>\n\n<h1>Attempt:</h1>\n\n<p>So far, here is my attempt at getting this resolved.</p>\n\n<pre><code>SELECT  p.pid,p.pname,p.cid,COUNT(v.did)\nFROM Visits v \nJOIN Doctors d ON v.did=d.did\nJOIN Patient p ON p.pid=v.pid\nWHERE d.cid=p.cid and d.speciality=\"Orthopedist\"\nGROUP BY p.pid,p.cid;\n\nINTERSECT \n\nSELECT  p.pid,d.cid,COUNT(d.did)\nFROM Doctors d \nJOIN Patient p ON p.cid=d.cid\nWHERE d.speciality='Orthopedist'\nGROUP BY d.cid;\n</code></pre>\n"},{"tags":["sql","forms","query","submit","isset"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12687469,"title":"form isset doesn't work with jquery","body":"<p>Hello I'm working on a image browser where I've a submit button to add a new row to the database. Unfortunately the isset function isn't working. When I remove this if statement it works fine, but when  use if(isset($_POST['addImg'])) nothing happens.</p>\n\n<p>image browser has the form:</p>\n\n<pre><code>&lt;div id=\"galleryAdd\"&gt;\n    &lt;form enctype=\"multipart/form-data\" method=\"post\" &gt;     \n        &lt;!-- een hidden id meegeven voor de plaatsing --&gt;\n        &lt;input type=\"hidden\" name=\"parentID\" value=\"&lt;? //$_GET['b']?&gt;40\"&gt;\n        &lt;input type=\"submit\" name=\"addImg\" value=\"Toevoegen\" /&gt;\n    &lt;/form&gt; \n&lt;/div&gt;\n&lt;div id=\"addExisting\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>javascript is calling page load when clicking on an image item:</p>\n\n<pre><code>$('.imgItem').click(function() {\n        $('.imgItem').removeClass(\"image_select\");\n        $(this).addClass(\"image_select\");   \n        var imgsource = $(this).find('img').attr('src'),\n            folderID = $(this).find('img').attr('rel');\n        $(\"#addExisting\").load(\"ajax.addExisting.php\", {parentID:folderID, imgsource:imgsource});\n        return false;   \n    });\n</code></pre>\n\n<p>ajax.existing.php : page that is loaded when clicking an image</p>\n\n<pre><code>/* Algemene Gegevens bestand */\n$bestand = $_POST['imgsource'];\n\n/* Meta Gegevens bestand */\n$file = substr($bestand, 0,strrpos($bestand,'.'));\n$ext = substr(strrchr($bestand,'.'),1);\n$base = basename($file);\n\n\nif(isset($_POST['addImg'])){\n/* Parent */\n$queryParent = mysql_query(\"SELECT * FROM `image_folders` WHERE id = \".$_POST['parentID'].\"\"); \n$parent = mysql_fetch_assoc($queryParent);\n$bestand_folder = \"../../images/\".$parent['dirname'].\"/\";\n\n\nmysql_query(\"INSERT INTO images (positie, parent, parentID, naam, alt, titel, extensie) VALUES ('99', '\".$parent['name'].\"', '\".$parent['id'].\"', '\".$base.\"', '\".$base.\"',     '\".$base.\"','\".$ext.\"')\")or die('kan niet uploaden'.mysql_error());\n\n  }\n</code></pre>\n"},{"tags":["c#",".net","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":652,"score":2,"question_id":3508024,"title":"sql \"LIKE\" Query syntax","body":"<p>what is the wrong in this Query ?</p>\n\n<pre><code>string command_get_pay = \"select Credit \n                          from Update_Company_Credit \n                          where (Update_Date LIKE '%\" +\n    System.DateTime.Today.ToShortDateString() + \"%')\";\n</code></pre>\n"},{"tags":["mysql","sql","query","count"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":236,"score":1,"question_id":9098265,"title":"mysql count not working properly?","body":"<p>I am trying to count the total comments posted by single user. Here is the table structure of the <code>comments</code> table:</p>\n\n<pre><code>CREATE TABLE `PLD_COMMENT` (\n   `ID` int(11) NOT NULL auto_increment,        \n   `ITEM_ID` varchar(11) NOT NULL,\n   `USER_ID` varchar(11) NOT NULL,\n   `USER_NAME` varchar(255) NOT NULL, \n   `COMMENT` longtext,\n   `COMMENT_TITLE` varchar(255) default NULL,\n   `COMMENT_RATING` tinyint(1) default '1', \n   `TYPE` int(11) NOT NULL, \n   `DATE_ADDED` timestamp NOT NULL \n       default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,\n   `IPADDRESS` varchar(15) default NULL,\n   `STATUS` varchar(11) NOT NULL, \n    PRIMARY KEY  (`ID`)  \n) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1\n</code></pre>\n\n<p>Here is the table structure for <code>user</code> table</p>\n\n<pre><code>CREATE TABLE `pld_user`(\n    `ID` int(11) NOT NULL auto_increment,\n    `LOGIN` varchar(100) NOT NULL,\n    `NAME` varchar(255) NOT NULL,\n    `PASSWORD` varchar(46) NOT NULL,\n    `LEVEL` tinyint(4) NOT NULL default '0',\n    `RANK` tinyint(4) NOT NULL default '0',\n    `ACTIVE` tinyint(4) NOT NULL default '0',\n    `LAST_LOGIN` timestamp NOT NULL \n        default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,\n    `REGISTRATION_DATE` timestamp NOT NULL default '0000-00-00 00:00:00',\n    `AUTH_IMG` varchar(255) default NULL,\n    `AUTH_IMGTN` varchar(255) default NULL,\n    `SUBMIT_NOTIF` tinyint(4) NOT NULL default '1', \n    `PAYMENT_NOTIF` tinyint(4) NOT NULL default '1', \n    `ADDRESS` varchar(255) default NULL, \n    `EMAIL` varchar(255) NOT NULL,\n    `WEBSITE` varchar(255) default NULL, \n    `WEBSITE_NAME` varchar(255) default NULL,\n    `INFO` varchar(255) default NULL, \n    `ANONYMOUS` tinyint(4) NOT NULL default '0', \n    `LANGUAGE` varchar(2) default NULL, \n    `AVATAR` varchar(100) default NULL,\n    `ICQ` varchar(15) default NULL, \n    `AIM` varchar(255) default NULL, \n    `YIM` varchar(255) default NULL, \n    `MSN` varchar(255) default NULL, \n    `CONFIRM` varchar(10) default NULL,\n    `NEW_PASSWORD` varchar(46) default NULL,\n    `EMAIL_CONFIRMED` int(11) NOT NULL default '1', \n    `LNAME` varchar(255) default NULL,\n    `CITY` varchar(255) default NULL, \n    `STATE` varchar(255) default NULL,\n    `DOB` date default NULL,\n    `UTYPE` tinyint(1) NOT NULL default '0',\n    PRIMARY KEY  (`ID`) \n) ENGINE=MyISAM AUTO_INCREMENT=8 DEFAULT CHARSET=latin1 \n COMMENT='Stores all the users with informations'\n</code></pre>\n\n<p>Here is my query:</p>\n\n<pre><code>SELECT count(c.USER_ID) as total_commments_user , \n  c.*, u.NAME, l.TITLE as LINK_TITLE, u.AUTH_IMG\nFROM `PLD_COMMENT` c\nleft outer join `PLD_USER` u ON (u.ID = c.USER_ID) \nleft outer join `PLD_LINK` l ON (l.ID = c.ITEM_ID AND l.STATUS='2') \nWHERE c.TYPE = '1' \n  AND c.STATUS = '2' \ngroup by c.ID ORDER BY c.ID DESC LIMIT 0 , 3\n</code></pre>\n\n<p>When I run this query I got 1 in each row under <code>total_comments_user</code>.</p>\n\n<p>Any idea?</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12686506,"title":"Select partial column title in MySQL","body":"<p>I am wondering if there is a way to select part of a column in mysql. For example, I want to select all statistics from my table that end in \"_sep_2012\". This would give me access to 1_sep_2012, 2_sep_2012, 3_sep_2012 etc...Is there a way to do this? </p>\n\n<pre><code>&lt;?php\n$query=mysql_query(\"SELECT %_sep_2012% FROM statistics WHERE id = '$id'\");\n\n$array = mysql_fetch_row($query);\n\n$monthly_total = $array[0];\n\necho \"$monthly_total\";\n?&gt;\n</code></pre>\n\n<p>Any assistance would be greatly appreciated. Thanks!</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":6,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":2200,"score":6,"question_id":5998084,"title":"Get the most recent Friday's date SQL","body":"<p>I'm trying to get the most recent Friday in SQL Server 2008.</p>\n\n<p>I have this. It gets the beginning of the week (monday) then subtracts 3 days to get Friday.</p>\n\n<pre><code>declare @recentFriday datetime =  DATEADD(ww, DATEDIFF(dd,0,GETDATE()), 0)-3\n</code></pre>\n\n<p>When this is run during the week, it gets last Friday's date which is correct. But when run on Friday (or Saturday), it still gets last week's date instead of the current week's Friday. I'm about to use if/else conditions but I'm sure there's an easier way.</p>\n"},{"tags":["php","mysql","query","select-query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":12684804,"title":"How to make value in ascending order in the mysql?","body":"<p>I want this type of output to fetch task_name from database like in this format</p>\n\n<pre><code>Task 10 Task 2 Task 3 Task 5........\n</code></pre>\n\n<p>My Query is </p>\n\n<pre><code> SELECT task_name, section_name, ref_student_id\n FROM scores\n WHERE ref_student_id = '\".$studentid.\"'\n    AND section_name = 'sm1'\n GROUP BY task_name\n</code></pre>\n\n<p>So I want to output like this..</p>\n\n<pre><code> Task 2 Task 3 Task 5 Task 10........\n</code></pre>\n"},{"tags":["c#","xml","linq","query","xml-parsing"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":12684213,"title":"Filter data from Xml according to date in C#","body":"<p>I need help filtering xml file according to dates , with this part of the code that i have it only prints out all average information according to user name and place</p>\n\n<pre><code>        Runner run = new Runner();\n       string filePath = \"runners.xml\"; //path\n        XDocument xDoc = XDocument.Load(filePath);\n        string userSelect = name;\n\n\n\n        var averageAddDistancequery = xDoc.Descendants(\"User\").Where(w =&gt; (string)w.Element(\"Name\") == user).Select(s =&gt; new\n        {\n            add = s.Elements(\"Attempts\").Where(w =&gt; (string)w.Element(\"Place\").Value == \"Paris\").Select(t =&gt; t.Element(\"Distance\").Value)\n        }).ToList();\n\n        if (averageAddDistancequery[0].add.Count() &gt; 0) \n        {\n            var aa = averageAddDistancequery[0].add.Average(a =&gt; float.Parse(a));\n            run.averageDistance = aa.ToString();        \n        }\n        else\n        {\n           // nothing\n        }\n\n        var averageAdd2Distancequery = xDoc.Descendants(\"User\").Where(w =&gt; (string)w.Element(\"Name\") == userSelector).Select(s =&gt; new\n        {\n            add = s.Elements(\"Attempts\").Where(w =&gt; (string)w.Element(\"Place\").Value == \"Madrid\").Select(t =&gt; t.Element(\"Distance\").Value)\n        }).ToList();\n\n        if (averageAdd2Distancequery[0].add.Count() &gt; 0)\n        {\n            var aa = averageAdd2DistanceSubquery[0].add.Average(a =&gt; float.Parse(a));\n            run.averageDistance2 = aa.ToString();\n        }\n        else\n        {\n           // nothing\n        }\n\n\n\n        xmlDoc.DocumentElement.SetAttribute(\"searching\", user);\n        XmlNodeList tests = xmlDoc.SelectNodes(\"//User[Name =/*/@searching]/Attempts\");\n        listBox1.Items.Clear();\n        listBox1.Items.Add(\"Runners Name: \" + user);\n        listBox1.Items.Add(\"Overall  Distance in Paris: \" + run.averageAdd);\n        listBox1.Items.Add(\"Overall Distance in Madrid: \" + run.averageSub);\n</code></pre>\n\n<p>For example if my xml file looks like this</p>\n\n<pre><code>    Users&gt;\n    &lt;User&gt;\n     &lt;Name&gt;David&lt;/Name&gt;\n      &lt;Attempts&gt;\n       &lt;Place&gt;Paris&lt;/Place&gt;\n       &lt;Date&gt;3/29/2012&lt;/Date&gt;\n       &lt;Distance&gt;100&lt;/Distance&gt;\n     &lt;/Attempts&gt;\n     &lt;Attempts&gt;\n      &lt;Place&gt;Madrid&lt;/Place&gt;\n      &lt;Date&gt;7/28/2012&lt;/Date&gt;\n      &lt;Distance&gt;100&lt;/Distance&gt;\n     &lt;/Attempts&gt;\n     &lt;Attempts&gt;\n      &lt;Place&gt;Paris&lt;/Place&gt;\n      &lt;Date&gt;8/19/2012&lt;/Date&gt;\n      &lt;Distance&gt;60&lt;/Distance&gt;\n     &lt;/Attempts&gt;\n     &lt;Attempts&gt;\n      &lt;Place&gt;Madrid&lt;/Place&gt;\n      &lt;Date&gt;9/29/2012&lt;/Date&gt;\n      &lt;Distance&gt;200&lt;/Distance&gt;\n    &lt;/Attempts&gt;  \n   &lt;/User&gt;\n   &lt;User&gt;\n    &lt;Name&gt;Lenny&lt;/Name&gt;\n     &lt;Attempts&gt;\n      &lt;Place&gt;Paris&lt;/Place&gt;\n      &lt;Date&gt;9/29/2012&lt;/Date&gt;\n      &lt;Distance&gt;130&lt;/Distance&gt;\n     &lt;/Attempts&gt;\n  &lt;/User&gt;\n &lt;/Users&gt;\n</code></pre>\n\n<p>If i run the code for david it will print out something like this</p>\n\n<p>User:David</p>\n\n<p>Average Distance in Paris:// data</p>\n\n<p>Average Distance in Madrid: // data</p>\n\n<p>This is not what i want, what i want is to select any two dates lets from a textbox and display only the information between those two dates\nFor example if i chose david, from date 3/29/2012 to 8/29/2012</p>\n\n<p>I would want and output something like this:</p>\n\n<p>User: David</p>\n\n<p>Average Distance in Paris from 3/29/2012 to 8/29/2012: //data</p>\n\n<p>Average Distance in Madrid from 3/29/2012 to 8/29/2012: //data</p>\n\n<p>Ive been trying for hours, i need help implementing this</p>\n"},{"tags":["sql","query","table","alias","linked-server"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12683913,"title":"How to shorten paths when accessing linked-server objects in SQL","body":"<p>Is there a way to shorted access paths in SQL? I am thinking somthing similar to alias's but i dont know how to ask this question in google to get the appropriate application of alias'ing</p>\n\n<p>This:</p>\n\n<pre><code>  select * from ServerName.DBName.dbo.TableName\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>  declare @RDB as RemoteDatabaseObject\n  set @RDB = ServerName.DBName.dbo\n\n  select * from @RDB.TableName\n</code></pre>\n\n<p>I know this doesnt work, but I want to know if there is a way to alias objects that have long paths.</p>\n"},{"tags":["mysql","sql","query","stored-procedures"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12669135,"title":"how to rename the Table based on the input in mysql","body":"<p>I'm new to mysql.\nThis is my table. Table name: <code>LOGDATETIME</code>:</p>\n\n<pre><code>2012-05-30   17:26:33  \n2012-05-30   17:26:33\n2012-05-30   17:26:33\n2012-05-31   17:26:33\n2012-05-31   17:27:22\n2012-05-31   17:27:22 \n2012-05-31   17:27:22\n2012-06-01   00:08:12\n2012-06-02   00:08:12\n2012-06-06   00:08:12 \n</code></pre>\n\n<p>I need to rename this table name based on the date. For example <code>LOGDATETIME_2012_05_30_TO_2012_06_06</code>. For this I need to write stored procedure in mysql. But I don't know how to write . </p>\n\n<p>Can any one please help me.</p>\n"},{"tags":["mysql","sql","query","magento"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12676227,"title":"SQL statement to replace field value in Magento","body":"<p>I need help replacing a value field in MySQL.</p>\n\n<p>I used an automated script to upload Coupons into Magento but the field \"<code>simple_action</code>\" imported values as \"<code>by_percent</code>\" instead of \"<code>cart_fixed</code>\". Can someone show me a query to replace the value \"<code>by_percent</code>\" with \"<code>cart_fixed</code>\"?</p>\n\n<p>The:</p>\n\n<ul>\n<li>table name is: <code>salesrule</code></li>\n<li>database name is: <code>magento</code></li>\n<li>field name is: <code>simple_action</code></li>\n<li>existing field value is: <code>by_percent</code></li>\n<li>needed field value(new value) is: <code>cart_fixed</code></li>\n</ul>\n"},{"tags":["mysql","query"],"answer_count":11,"favorite_count":8,"up_vote_count":35,"down_vote_count":0,"view_count":48903,"score":35,"question_id":639531,"title":"MySQL - Search in all fields from every table from a database","body":"<p>I know that probably it's not possible to do this, but just want to check it out with you, guys... Is it possible to do something like this, using MySQL? I want to search in all fields from all tables a given string:</p>\n\n<pre><code>SELECT * FROM * WHERE * LIKE '%stuff%'\n</code></pre>\n"},{"tags":["query","mdx","multidimensional","mondrian"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12666124,"title":"mdx query - merging two queries to one","body":"<p>I'm using Mondrian and I have this query (Let's call it [query A]):</p>\n\n<pre><code>SELECT\nNON EMPTY {Hierarchize({[Games].[**Some Game Name**]})} ON COLUMNS,\nNON EMPTY {Hierarchize({[Users].[User Name].Members})} ON ROWS\nFROM [Games_G]\n</code></pre>\n\n<p>Which returns me a list of users who are fan of a game given, and within the users returned from [query A] I have to run [query B]:</p>\n\n<pre><code>SELECT\nNON EMPTY {Hierarchize({[Games].[Game Name].Members})} ON COLUMNS,\nNON EMPTY {Hierarchize({[Measures].[Fans]})} ON ROWS\nFROM [Games_G]\nWHERE {Hierarchize({{[Users].[**Some Username**], [Users].[**Some UsernameTwo**], [Users].[**Some UsernameThree**], etc}})}\n</code></pre>\n\n<p>How can I merge between the two queries?\nThanks in advance and sorry for being a mdx-query-noob.</p>\n"},{"tags":["ruby-on-rails","query","has-many-through"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12681226,"title":"Rais has_many & through query","body":"<p>I'm using Rails 2.3 and I have 3 tables, which manages user permissions to buildings. The mygroups table is the list of groups users and buildings belong to. The mygroupsbuildings is the list of buildings with their associated group. The mygroupsusers is the list of users with their associated group.</p>\n\n<pre><code>create_table \"mygroups\", :force =&gt; true do |t|\n  t.string   \"name\"\n  t.integer  \"user_id\"\n  t.string   \"user_name\"\n  t.integer  \"permissions\"\nend\n\ncreate_table \"mygroupbuildings\", :force =&gt; true do |t|\n  t.integer  \"mygroup_id\"\n  t.integer  \"building_id\"\nend\n\ncreate_table \"mygroupusers\", :force =&gt; true do |t|\n  t.integer  \"mygroup_id\"\n  t.integer  \"user_id\"\n  t.string   \"user_name\"\nend\n</code></pre>\n\n<p>I would like to create a query that finds out if a particular user_id is a member of the same group as a particular building_id.</p>\n\n<p>I have setup the following associations:</p>\n\n<pre><code>class Mygroup &lt; ActiveRecord::Base  \n  has_many   :mygroupusers\n  has_many   :mygroupbuildings\nend\n\nclass Mygroubuilding &lt; ActiveRecord::Base  \n  belongs_to :mygroup\n  has_many   :mygroupusers, :through =&gt; :mygroup\nend\n\nclass Mygroupuser &lt; ActiveRecord::Base\n  belongs_to :mygroup\n  has_many   :mygroupbuildings, :through =&gt; :mygroup\nend\n</code></pre>\n\n<p>I wrote the following query:</p>\n\n<pre><code>Mygroupuser.find(:all,\n                 :include =&gt; :mygroupbuildings,\n                 :select =&gt; \"mygroupbuildings.building_id, mygroupusers.user_id\",\n                 :conditions =&gt; [\"mygroupbuildings.building_id = '#{building.id}' AND mygroupusers.user_id = '#{current_user.user_id}'\"])      \n</code></pre>\n\n<p>This give me the following error:</p>\n\n<p>ActiveRecord::StatementInvalid (Mysql::Error: Unknown column 'mygroups.mygroup_id' in 'on clause': SELECT <code>mygroupusers</code>.<code>id</code> AS t0_r0, <code>mygroupusers</code>.<code>mygroup_id</code> AS t0_r1, <code>mygroupusers</code>.<code>user_id</code> AS t0_r2, <code>mygroupusers</code>.<code>user_name</code> AS t0_r3, <code>mygroupusers</code>.<code>created_at</code> AS t0_r4, <code>mygroupusers</code>.<code>updated_at</code> AS t0_r5, <code>mygroupbuildings</code>.<code>id</code> AS t1_r0, <code>mygroupbuildings</code>.<code>mygroup_id</code> AS t1_r1, <code>mygroupbuildings</code>.<code>coursewalk_id</code> AS t1_r2, <code>mygroupbuildings</code>.<code>created_at</code> AS t1_r3, <code>mygroupbuildings</code>.<code>updated_at</code> AS t1_r4 FROM <code>mygroupusers</code>  LEFT OUTER JOIN <code>mygroups</code> ON (<code>mygroupusers</code>.<code>id</code> = <code>mygroups</code>.<code>mygroup_id</code>)  LEFT OUTER JOIN <code>mygroupbuildings</code> ON (<code>mygroupbuildings</code>.<code>mygroup_id</code> = <code>mygroups</code>.<code>id</code>) WHERE (mygroupbuildings.building_id = '2' AND mygroupusers.user_id = '55') ):</p>\n\n<p>Thanks,</p>\n\n<p>Nick,</p>\n"},{"tags":["mysql","database","performance","query","query-performance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12681907,"title":"MySQL query with limit and offset is running very slow","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12680738/mysql-query-with-limit-and-large-offset-taking-forever\">MySQL query with limit and large offset taking forever</a>  </p>\n</blockquote>\n\n\n\n<p>My table contains 25,000 rows and im using pagination to display all rows on page.\nIf my page limit is set to 10 rows per page then it displays very fast each page. However if i change the page limit size to 250 rows per page it takes 30 seconds to 1 minute to load the table (display records). The query that im using is this:</p>\n\n<pre><code>SELECT SQL_CALC_FOUND_ROWS Merchants.*, DataSources.DsISOName, PrName\nFROM Merchants \nINNER JOIN DataSources ON MDsID=DsID \nINNER JOIN Processors ON PrID = DsType\nORDER BY MDBA LIMIT 0, 250\n</code></pre>\n\n<p>This is what i get when i load the page first. Limit numbers 0, 250 get changes if i change the page, so if i visit page 2 Limit will change to : </p>\n\n<pre><code>  LIMIT 250, 500 \n</code></pre>\n\n<p>If anyone can see a problem with my query please let me know. I can not understand why does it take 1 minute to load the table when 250 rows are being fetched per page. \nOn mysql table i tried using indexes on various ID's but still same speed.</p>\n"},{"tags":["php","html","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":132,"score":-1,"question_id":12680738,"title":"MySQL query with limit and large offset taking forever","body":"<p>I have a directory that I've built with the PHP script below and it uses pagination to get 1002 results per page.  The problem is that the farther you get in the pages, the longer they take to load. For example, page 1 loads significantly faster than page 10,000.</p>\n\n<p>I'm guessing I did something wrong with the query and instead of just selecting the 1002 results that it should be limited, it's also cycling through all the ones from before it as well.  If someone could post the code that needs to be fixed, that would be great!</p>\n\n<p>Thanks for your time and help!</p>\n\n<pre><code>&lt;?php include(\"websites/header.html\"); ?&gt;\n\n&lt;center&gt;\n&lt;?php\n    /*\n        Place code to connect to your DB here.\n    */\n    include('websites/database.php');   // include your code to connect to DB.\n\n    $tbl_name=\"list\";       //your table name\n    // How many adjacent pages should be shown on each side?\n    $adjacents = 5;\n\n    /* \n       First get total number of rows in data table. \n       If you have a WHERE clause in your query, make sure you mirror it here.\n    */\n    $query = \"SELECT COUNT(*) as num FROM $tbl_name\";\n    $total_pages = mysql_fetch_array(mysql_query($query));\n    $total_pages = $total_pages[num];\n\n    /* Setup vars for query. */\n    $targetpage = \"websites.php\";   //your file name  (the name of this file)\n    $limit = 1002;                              //how many items to show per page\n    $page = $_GET['page'];\n    if($page) \n        $start = ($page - 1) * $limit;          //first item to display on this page\n    else\n        $start = 0;                             //if no page var is given, set start to 0\n\n    /* Get data. */\n    $sql = \"SELECT website FROM $tbl_name LIMIT $start, $limit\";\n    $result = mysql_query($sql);\n\n    /* Setup page vars for display. */\n    if ($page == 0) $page = 1;                  //if no page var is given, default to 1.\n    $prev = $page - 1;                          //previous page is page - 1\n    $next = $page + 1;                          //next page is page + 1\n    $lastpage = ceil($total_pages/$limit);      //lastpage is = total pages / items per page, rounded up.\n    $lpm1 = $lastpage - 1;                      //last page minus 1\n\n    /* \n        Now we apply our rules and draw the pagination object. \n        We're actually saving the code to a variable in case we want to draw it more than once.\n    */\n    $pagination = \"\";\n    if($lastpage &gt; 1)\n    {   \n        $pagination .= \"&lt;div class=\\\"pagination2\\\"&gt;\";\n        //previous button\n        if ($page &gt; 1) \n            $pagination.= \"&lt;a href=\\\"$targetpage?page=$prev\\\"&gt;&amp;lt; previous&lt;/a&gt;\";\n        else\n            $pagination.= \"&lt;span class=\\\"disabled\\\"&gt;&amp;lt; previous&lt;/span&gt;\";  \n\n        //pages \n        if ($lastpage &lt; 7 + ($adjacents * 2))   //not enough pages to bother breaking it up\n        {   \n            for ($counter = 1; $counter &lt;= $lastpage; $counter++)\n            {\n                if ($counter == $page)\n                    $pagination.= \"&lt;span class=\\\"current\\\"&gt;$counter&lt;/span&gt;\";\n                else\n                    $pagination.= \"&lt;a href=\\\"$targetpage?page=$counter\\\"&gt;$counter&lt;/a&gt;\";                 \n            }\n        }\n        elseif($lastpage &gt; 5 + ($adjacents * 2))    //enough pages to hide some\n        {\n            //close to beginning; only hide later pages\n            if($page &lt; 1 + ($adjacents * 2))        \n            {\n                for ($counter = 1; $counter &lt; 4 + ($adjacents * 2); $counter++)\n                {\n                    if ($counter == $page)\n                        $pagination.= \"&lt;span class=\\\"current\\\"&gt;$counter&lt;/span&gt;\";\n                    else\n                        $pagination.= \"&lt;a href=\\\"$targetpage?page=$counter\\\"&gt;$counter&lt;/a&gt;\";                 \n                }\n                $pagination.= \"...\";\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=$lpm1\\\"&gt;$lpm1&lt;/a&gt;\";\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=$lastpage\\\"&gt;$lastpage&lt;/a&gt;\";       \n            }\n            //in middle; hide some front and some back\n            elseif($lastpage - ($adjacents * 2) &gt; $page &amp;&amp; $page &gt; ($adjacents * 2))\n            {\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=1\\\"&gt;1&lt;/a&gt;\";\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=2\\\"&gt;2&lt;/a&gt;\";\n                $pagination.= \"...\";\n                for ($counter = $page - $adjacents; $counter &lt;= $page + $adjacents; $counter++)\n                {\n                    if ($counter == $page)\n                        $pagination.= \"&lt;span class=\\\"current\\\"&gt;$counter&lt;/span&gt;\";\n                    else\n                        $pagination.= \"&lt;a href=\\\"$targetpage?page=$counter\\\"&gt;$counter&lt;/a&gt;\";                 \n                }\n                $pagination.= \"...\";\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=$lpm1\\\"&gt;$lpm1&lt;/a&gt;\";\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=$lastpage\\\"&gt;$lastpage&lt;/a&gt;\";       \n            }\n            //close to end; only hide early pages\n            else\n            {\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=1\\\"&gt;1&lt;/a&gt;\";\n                $pagination.= \"&lt;a href=\\\"$targetpage?page=2\\\"&gt;2&lt;/a&gt;\";\n                $pagination.= \"...\";\n                for ($counter = $lastpage - (2 + ($adjacents * 2)); $counter &lt;= $lastpage; $counter++)\n                {\n                    if ($counter == $page)\n                        $pagination.= \"&lt;span class=\\\"current\\\"&gt;$counter&lt;/span&gt;\";\n                    else\n                        $pagination.= \"&lt;a href=\\\"$targetpage?page=$counter\\\"&gt;$counter&lt;/a&gt;\";                 \n                }\n            }\n        }\n\n        //next button\n        if ($page &lt; $counter - 1) \n            $pagination.= \"&lt;a href=\\\"$targetpage?page=$next\\\"&gt;next &amp;gt;&lt;/a&gt;\";\n        else\n            $pagination.= \"&lt;span class=\\\"disabled\\\"&gt;next &amp;gt;&lt;/span&gt;\";\n        $pagination.= \"&lt;/div&gt;\\n\";       \n    }\n?&gt;\n\n    &lt;?php\n$i = 0;\necho '&lt;table style=\"table-layout:fixed; width:1050px;\"&gt;&lt;tr&gt;'; \n        while($row = mysql_fetch_array($result))\n{\n    $i ++;\n    if ($i&lt;=3)\n    {\n      echo '&lt;td style=\"word-wrap: break-word;\"&gt;\n         &lt;div&gt;&lt;a href=\"http://www.mywebsite.com/check.php?site='.strtolower($row[website]).'\"&gt;'.strtolower($row[website]).'&lt;/a&gt;&lt;/div&gt;\n       &lt;/td&gt;'; \n    }\n\n    else\n    {       \n      echo '&lt;/tr&gt;&lt;tr&gt;';\n      echo '&lt;td style=\"word-wrap: break-word;\"&gt;&lt;div&gt;&lt;a href=\"http://www.mywebsite.com/check.php?site='.strtolower($row[website]).'\"&gt;'.strtolower($row[website]).'&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;'; \n      $i = 0;\n    $i++;\n   }\n}  \necho '&lt;/tr&gt;&lt;/table&gt;';\n    ?&gt;\n\n&lt;?=$pagination?&gt;\n&lt;/center&gt;\n\n&lt;?php include(\"websites/footer.html\"); ?&gt;\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12680843,"title":"Querying the length of the biggest stretch of a given character in a text field in MySQL","body":"<p>How can I create a query to find the length of the biggest stretch of a given character in a text field? For example:</p>\n\n<pre><code>283948XXXX92388888888X92380XXXX0983XXXXXXXXXXXXXXXXXX45\n</code></pre>\n\n<p>If I wanted the character to be an \"8\", it would return an integer value of \"8\"</p>\n\n<p>If I wanted the character to be an \"X\", it would return an integer value of \"18\"</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<p>-Raymosrunerx</p>\n\n<p>PS: I am using putty and remotely accessing a server that has MySQL</p>\n"},{"tags":["android","sql","query","inner-join","ormlite"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1832,"score":6,"question_id":7301418,"title":"Ormlite inner join on three tables","body":"<p>i want to create an inner join on three tables like this one for example:</p>\n\n<pre><code>SELECT C.Description, D.ItemDescription\n  FROM OrderDetailStatement AS D \n INNER JOIN OrderHeaderStatement AS H \n    ON H.OrderHeaderStatementRefID = D.OrderHeaderStatementRefID \n INNER JOIN customers AS C \n    ON H.CustomerRefID = C.CustomerRefID\n WHERE (D.MixedValue &gt; 1000)\n</code></pre>\n\n<p>but i'm a little bit confused, could you please provide me a walkthrough?</p>\n\n<p>thanks in advance</p>\n"},{"tags":["sql","query","sum","between"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12666461,"title":"Multiple Between Statements","body":"<p>I'm a student developer currently taking a SQL course. I'm currently trying to retrieve the sum of several groups of rows from a table. I'm very new to SQL development and I'm not too sure what the problem is in the following scenario. I have a large table of which I want to select specific rows from and then add the balance column.</p>\n\n<p>The following will not display any data in the results and I'm not too sure why. I have a hunch that the between statement can only be used once per table but maybe I'm wrong?</p>\n\n<pre><code>Select Description, SUM(Balance) AS Total_Balance\nFROM Chart_Of_Accounts\nWHERE (Account BETWEEN ('400401') AND ('400407')) \nAND (Account BETWEEN ('440094') AND ('440100')) \nAND (Account BETWEEN ('450094') AND ('450100'))\nGROUP BY Description, Balance \n</code></pre>\n\n<p><em><strong>Edit 10.1.2012</em></strong> As requested by (Richard aka cyberkiwi)</p>\n\n<p><strong>What I Have</strong></p>\n\n<pre><code>Set 1\n|Account        |Description         |Balance\n|4004xx         |Red Wine            |$2361.23\n|4004xx         |White Wine          |$3620.23\n|4004xx         |Rice Wine           |$1223.23\n\nSet 2\n|Account        |Description         |Balance\n|4400xx         |Red Wine            |$4361.23\n|4400xx         |White Wine          |$3260.23\n|4400xx         |Rice Wine           |$223.23\n\nSet 3\n|Account        |Description         |Balance\n|4500xx         |Red Wine            |$1361.23\n|4500xx         |White Wine          |$1620.23\n|4500xx         |Rice Wine           |$1223.23\n</code></pre>\n\n<p><strong>Result I'm Trying to Achieve</strong></p>\n\n<pre><code>Total\n|Description         |Total_Balance\n|Red Wine            |$8083.69\n|White Wine          |$8500.69\n|Rice Wine           |$2669.69\n</code></pre>\n\n<p>thank you for reading my post! I am also open to any advice in SQL development and any feedback is greatly appreciated.</p>\n"},{"tags":["php","mysql","query","transactions","insert"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":104,"score":3,"question_id":12679241,"title":"PHP/MySQL - \"BEGIN...COMMIT\" Not Working","body":"<p>I was searching for a way to insert data into two database tables in a single query in such a way that if one failed, neither saved (I don't want orphaned data).  I came across a Stack Overflow question that showed me how to use BEGIN...COMMIT to accomplish this, but it simply is not working.</p>\n\n<p>Here's the query I've set up:</p>\n\n<pre><code>$query = \"BEGIN;\n            INSERT INTO content_subpages (title, url_referer) VALUES ('$pagetitle','$url_referer');\n            INSERT INTO ccm_main_menu (sub_item, sub_item_link,sub_item_sort_order) VALUES ('$pagetitle','$url_referer','$newsort');\n            COMMIT;\";\nmysql_query($query) or die (mysql_error());\n</code></pre>\n\n<p>I get the following error:\n<code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INSERT INTO content_subpages (title, url_referer) VALUES ('TESTING','testing'); ' at line 2</code></p>\n\n<p>This is my first time using BEGIN...COMMIT, so it's reasonable that I might be doing something wrong, but I followed the syntax of the SQL Fiddle example given by the selected answer to the Stack Overflow question I mentioned (http://stackoverflow.com/questions/12649706/mysql-insert-into-multiple-tables-in-same-query-with-begincommit), but it still won't work.</p>\n\n<p>If I can easily achieve the \"all-or-nothing\" multiple INSERT result without BEGIN...COMMIT, that would be an acceptable solution.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12678275,"title":"How to group quantities in a period of time","body":"<p>Im trying to group quantities regarding a time or period, i have the next table</p>\n\n<p>SALES\nSALES_DATE\nSALES_ITEM\nSALES_QUANTITY</p>\n\n<p>The query that im doing it's </p>\n\n<pre><code>SELECT DATE,ITEM,SUM(QUANTITY) \nFROM SALES \nWHERE DATE BETWEEN \"DATE1\" AND \"DATE2\";\n</code></pre>\n\n<p>The problem is that i dont need the DATE to appear, if i look for the sales of october it should appear the sum of october without showing the date... Thank you very much for your help</p>\n\n<p>Example:\nWhat i get...</p>\n\n<pre><code>DATE         ITEM               SALES\n2012-06-12   14152              7\n2012-06-14   14152              15\n2012-06-16   14157              25\n</code></pre>\n\n<p>What i need: query between 06-12 and 06-16</p>\n\n<pre><code>ITEM         SALES\n14152        22\n14157        25\n</code></pre>\n\n<p>Thanks you very much</p>\n"},{"tags":["mysql","database","query","join","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12677840,"title":"Best way to join 3 mySQL tables","body":"<p>I have a tag name and I need to fetch the tag id from the tags table then lookup all the ids that match the tag id in a taxonomy table and then fetch all the items that match the id in the taxonomy table. Can I do it all in 1 query or will I need a subquery? Here is an example of the database structure</p>\n\n<pre><code>tags database\ntid, tag\n\ntags taxonomy database\nid, wid, tid\n\nitems databse\nwid, *\n</code></pre>\n\n<p>I have the tag from the tags database I need to fetch the tid from the tags database then return all the wid's from the taxonomy database where the tid equals what we just fetched and then return * from the items database. I can get this done running 2 separate queries but I'm looking to do it in just 1. \nThanks</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12677463,"title":"UNION statement in query","body":"<p>I wrote a query but I got following error, Any ideas ?!</p>\n\n<p>Error :</p>\n\n<pre><code>Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource in E:\\AppServ\\www\\admin\\index.php on line 545\n</code></pre>\n\n<p>Code :</p>\n\n<pre><code>                    require_once '../_db/databaseConnect.php';\n                    $db = new databaseConnect();\n                    $db-&gt;connect();\n                    $queryResult = mysql_query(\"(SELECT * FROM tabelcomments WHERE publishStatus = 2) UNION (SELECT appTitleFa FROM tableapps WHERE appID = '$appID');\");\n                    for ($dataCnt = 0; $dataCnt &lt; mysql_num_rows($queryResult); $dataCnt++) \n                      {\n                         //codes...\n                      }\n                    $db-&gt;close();\n</code></pre>\n"},{"tags":["mysql","performance","query","optimization","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12677054,"title":"efficiently use OR statement in LEFT JOIN","body":"<p>so I have this query</p>\n\n<pre><code>SELECT * FROM b \n   LEFT JOIN n ON b.id = n.id \n   LEFT JOIN nr ON (b.pid &lt;&gt; 0 AND b.pid = nr.vid) \n        OR (b.pid = 0 AND n.vid = nr.vid)\n</code></pre>\n\n<p>But an EXPLAIN statement on that query would reveal that in order to execute the OR in the join, it needs to search through all the entries in the nr table even though nr.vid is the primary key of that table AND there are indices on b.pid and n.vid..</p>\n\n<p>Any suggestion as to how to make this more efficient? </p>\n\n<p><strong>Explain Result</strong></p>\n\n<pre><code>1, 'SIMPLE', 'b', 'ref', 'PRIMARY,r_rID', 'r_rID', '197', 'const,const', 48, 'Using where; Using temporary; Using filesort'\n1, 'SIMPLE', 'n', 'eq_ref', 'PRIMARY,nst,nnc,ut,uid', 'PRIMARY', '4', 'b.nid', 1, 'Using where'\n1, 'SIMPLE', 'nr', 'ALL', '', '', '', '', 335654, ''\n1, 'SIMPLE', 'tn', 'ref', 'nid', 'nid', '4', 'n.nid', 1, ''\n</code></pre>\n"},{"tags":["php","mysql","sql","query","rank"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":86,"score":4,"question_id":12675166,"title":"Adding a rank value to my MySQL table","body":"<p>I have a fixed table that will not change. I have over 80,000 rows.</p>\n\n<pre><code>CREATE TABLE `word_list_master` (\n  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n  `word` varchar(64) NOT NULL,\n  `created` int(11) NOT NULL,\n  `frequency` int(11) NOT NULL,\n  `number_of_files` int(11) NOT NULL,\n  `combined_frequency` bigint(24) NOT NULL,\n  PRIMARY KEY (`id`)\n)\n</code></pre>\n\n<p>I want to create a 7th column 'rank' that will determine the rank of the rows ordered by the combined_frequency column. I am doing this to reduce overhead when the database is live.</p>\n\n<p>Can I do this via MySQL statement(s) or do I have to write a bunch of SELECT/INSERT statements in PHP (for example)? I have been doing most of the work so far in PHP but it is taking up to 24 hours to perform operations on the table.</p>\n\n<p>I was looking at the RANK function but as my MySQL ability is only fair in capacity, I ran into problems.</p>\n"},{"tags":["php","mysql","database","query","echo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":12675788,"title":"PHP - capture the username from a database based on a echo result on to another page","body":"<p>I have a search engine which displays a list of ads, i was wondering how i would capture the username from a result that a user clicks on (using a database query, PDO) </p>\n\n<p>so far i have this but am not sure how to make it relate to the exact result that a user clicks on:</p>\n\n<pre><code>$sql = \"SELECT * FROM user WHERE username=:username\";\n$q = $conn-&gt;prepare($sql);\n$q-&gt;bindParam(':username', $username, PDO::PARAM_STR);\n$q-&gt;execute();\n$row = $q-&gt;fetch(PDO::FETCH_ASSOC);\n\n$email1 = $row['email']; \n</code></pre>\n"},{"tags":["sql","query","join","left-join"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12675162,"title":"Left join that is not showing all left table values","body":"<p>A LEFT JOIN should show all rows on the left table however when running the following query, I am only getting place values where there is a count of 1 or more. Please can someone give me some guidance as to where I might be going wrong:</p>\n\n<pre><code>SELECT places.placeId,\n       placeName,\n       COUNT(orderId) AS orderCount\nFROM   places\n       LEFT JOIN orders\n         ON places.placeId = orders.placeId\nWHERE  places.companyId = 1\n       AND stateId = 1\n       AND orderstateId = 1\n       AND orderName NOT LIKE 'Delivery%'\nGROUP  BY places.placeId,\n          places.placeName\nORDER  BY orderCount DESC,\n          placeName ASC \n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","mysql","query","for-loop"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12668474,"title":"Use for loop to incrementally select values from MySQL query","body":"<p>I am trying to use a for loop to select an incremental value with a MySQL query. I have included sample code below:</p>\n\n<pre><code>&lt;?php\n\n$day_1=\"sep_28\";\n$day_2=\"sep_29\";\n$day_3=\"sep_30\";\n\n$query = mysql_query(\"SELECT * FROM table WHERE id = '$id'\");\n\nwhile ($row = mysql_fetch_assoc($query))\n{\nfor ($i = 1; $i &lt;= 3; $i++) \n    {\n        $dayVar = \"day_\".$i;\n        //$dayVarCount = $dayVar.\"_count\"; // Don't really need this anymore, so removed.\n        $dayVarCount = $row[$$dayVar];\n        echo \"$$dayVar.': '.$dayVarCount&lt;p&gt;\"; // Edited.\n    }      \n}\n?&gt;\n</code></pre>\n\n<p>I think I am getting close, but when I run the code my page is showing this:</p>\n\n<p>$day_1.': '.0</p>\n\n<p>$day_2.': '.2</p>\n\n<p>$day_3.': '.5</p>\n\n<p>Any additional recommendations? Thanks for the great help!</p>\n"},{"tags":["php","mysql","query","search","between"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12673810,"title":"PHP simple search between item range","body":"<p>First of all, before writing down PHP code. I have a table named as items in mySQL database.\nSuppose it has the following reocrds inside <strong>item_no</strong> :</p>\n\n<ul>\n<li>1L900BK</li>\n<li>1L900BE</li>\n<li>1L900BR</li>\n<li>2L900BK</li>\n<li>2L902BE</li>\n<li>2L910PU</li>\n</ul>\n\n<p>and the PHP code is :</p>\n\n<pre><code>require_once('connect_db.php');\n$from = $_POST['from'];\n$to = $_POST['to'];\n\n$query = \"SELECT * FROM items WHERE item_no BETWEEN '\".$from.\"' AND '\".$to.\"' ORDER BY item_no Asc\";\n$result = mysql_query($query);\n\nif(mysql_num_rows($result)&gt;0){\n$num = mysql_num_rows($result);\n\nfor($i=0;$i&lt;$num;$i++){\n$row = mysql_fetch_assoc($result);\necho $row['item_no'];\necho \"&lt;br /&gt;&lt;br /&gt;\";    \n}   \n}\n</code></pre>\n\n<p>Now the problem starts here : Suppose I wanted to search for an item FROM <strong>1l900bk</strong> TO <strong>2l900BK</strong>, it will outputs all item_no between them ( 1L900bk 1L900BE ------- 2L900BK) Which is perfect!</p>\n\n<p>But When i wanted to search for item_no FROM <strong>1L9</strong>  TO <strong>2L9</strong> ...The result or output is not correct ( 1L900BK - 1L900BE - 1L900BR - and stops !! ) Where is 2L900's ? It skips 2l9 when the for loop reaches this value. </p>\n\n<p>Now all i want is to output all the 2l900's when i write down 2l9...I think there is something wrong with BETWEEN inside the query but i could not find an alternative way of doing it.</p>\n\n<p>Thank You</p>\n"},{"tags":["sql","oracle","query","date","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12297143,"title":"Oracle SQL outer join query puzzle","body":"<pre><code>select\n  whatever\nfrom\n  bank_accs b1,\n  bank_accs b2,\n  table3 t3\nwhere\n  t3.bank_acc_id = t1.bank_acc_id and\n  b2.bank_acc_number = b1.bank_acc_number and\n  b2.currency_code(+) = t3.buy_currency and\n  trunc(sysdate) between nvl(b2.start_date, trunc(sysdate)) and nvl(b2.end_date, trunc(sysdate));\n</code></pre>\n\n<p>My problem is with the date (actuality) check on b2. Now, I need to return a row for each t3xb1 (t3 = ~10 tables joined, of course), even if there are ONLY INVALID records (date-wise) in b2. How do I outer-join this bit properly?\nCan't use ANSI joins, must do in a single flat query.\nThanks.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12671916,"title":"Running CREATE TABLE query throug PHP","body":"<p>I'm running the following query throug a PHP script</p>\n\n<pre><code>DROP TABLE IF EXISTS `address`;CREATE TABLE `address` (  `Id`\nint(11) NOT NULL auto_increment,   `EntityId` int(11) NOT NULL,  \n`sStreet1` varchar(50),   `sStreet2` varchar(50),   `sCity`\nvarchar(50),   `sLoc` varchar(50),   `sPv` char(2),   `sState`\nvarchar(50),   `sZip` varchar(10),   `sType` varchar(50),  \n`FiscalAddress` tinyint(1) NOT NULL,   PRIMARY KEY  (`Id`) );\n</code></pre>\n\n<p>I can run this query trough different clients (such as Navicat) without problems, but running this through PHP will output the following</p>\n\n<pre><code>$result = mysql_query($query);\nif (!$result) {\n    $message  = 'Invalid import content: ' . mysql_error() . \"\\n\\n\";\n    $message .= 'Whole query: ' . $query;\n    die($message);\n}\n</code></pre>\n\n<p>this will output the following:</p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE address ( Id int(11) NOT NULL AUTO_INCREMENT, EntityId int(11) ' at line 2 Whole query: DROP TABLE IF EXISTS address; CREATE TABLE address ( Id int(11) NOT NULL AUTO_INCREMENT, EntityId int(11) NOT NULL, sStreet1 varchar(50), sStreet2 varchar(50), sCity varchar(50), sLoc varchar(50), sPv char(2), sState varchar(50), sZip varchar(10), sType varchar(50), FiscalAddress tinyint(1) NOT NULL, PRIMARY KEY (Id) );</p>\n</blockquote>\n\n<p>what am I doing wrong???</p>\n"},{"tags":["database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":12673979,"title":"Is brute force the only way to make an update query in access?","body":"<p>I am trying to make an update query in Access right now. I have two teachers who have the same  data tables in a different database except for the information that they have entered in themselves. Other than their individually entered info, everything is the same. I am trying to merge their two tblDemographics tables so that they can see what each other has done in case a students moves to one of the schools they cover.  I was wondering if I have to basically enter in every field that has to be updated to, or is there some short hand that might make it to where I can basically say where Null, update to field of same name? </p>\n\n<p>Sorry if this doesn't make sense. I just am trying to see if there is a more efficient way to do it.</p>\n\n<pre><code>UPDATE tbleDemographics LEFT JOIN tbleDemographics1 ON tbleDemographics.[Local ID] = tbleDemographics1.[Local ID] SET tbleDemographics.FName = [tbleDemographics1.Fname], tbleDemographics.LName = [tbleDemographics1.LName], tbleDemographics.MName = [tbleDemographics1.MName]\nWHERE (((tbleDemographics.FName) Is Null) AND ((tbleDemographics.LName) Is Null) AND ((tbleDemographics.MName) Is Null) AND ((tbleDemographics.ClMgr) Is Null) AND ((tbleDemographics.School) Is Null) AND ((tbleDemographics.Grade) Is Null) AND ((tbleDemographics.[Prim Dis]) Is Null) AND ((tbleDemographics.[Sec Dis]) Is Null) AND ((tbleDemographics.[Third Dis]) Is Null) AND ((tbleDemographics.[Local ID]) Is Null) AND ((tbleDemographics.GTID) Is Null) AND ((tbleDemographics.Status) Is Null) AND ((tbleDemographics.[Homeroom Teacher]) Is Null) AND ((tbleDemographics.[GPS Math Teacher]) Is Null) AND ((tbleDemographics.[Number Worlds Teacher]) Is Null) AND ((tbleDemographics.IntervHMcCain) Is Null) AND ((tbleDemographics.InterMSmith) Is Null) AND ((tbleDemographics.InterALacey) Is Null) AND ((tbleDemographics.InterLDaughtry) Is Null) AND ((tbleDemographics.DelInclusion) Is Null) AND ((tbleDemographics.DelRegEd) Is Null) AND ((tbleDemographics.DelConsult) Is Null) AND ((tbleDemographics.DelRes) Is Null) AND ((tbleDemographics.DelPara) Is Null) AND ((tbleDemographics.[DelMIPull-out]) Is Null) AND ((tbleDemographics.DelMIInc) Is Null) AND ((tbleDemographics.OTServices) Is Null) AND ((tbleDemographics.PTServices) Is Null) AND ((tbleDemographics.OIServices) Is Null) AND ((tbleDemographics.SpServices) Is Null) AND ((tbleDemographics.Notes) Is Null));\n</code></pre>\n\n<p>That looks too messy for my taste, but I want to simply that if possible so that I don't actually have to qualify each entry.</p>\n\n<p>After looking at it some more, I feel quite silly about the SQL that I did put up here. SO yes, I see that I put the Is Nulls in the wrong place and that the way I have it set up with basically overwrite everything... oops. I hope though that the general idea is understood.</p>\n\n<p>Ok...so now that I am getting more and more into this database trying to figure this out myself... I see so many issues that it is not even funny. This database is set up horribly to the point to where it is a nightmare.... if anyone can still come up with a general idea to what I am getting up that would be greatly Appreciated. </p>\n"},{"tags":["mysql","database","query","join","left-join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12669430,"title":"MySQL query to select join from 5 tables","body":"<p>I have 5 tables:</p>\n\n<pre><code>tag: {tagID,tagDetails}\nuser: {userID,userDetails,u_status=[active or banned]}\nsubscribe: {tagID,userID}\nitem: {itemID, itemDetails,i_status=[active or banned]}\nitem_tag: {tagID,itemID}\n</code></pre>\n\n<p>I want to select these data:</p>\n\n<pre><code>result: {tagID, tagDetails, num_subscribers, num_items}\n</code></pre>\n\n<p>For each tagID, num_subscribers is the number of users under the table user whose u_status is 'active' and whose userID and the said tagID exists in the table subscribe</p>\n\n<p>For each tagID, num_items is the number of users under the table item whose i_status is 'active' and whose itemID and the said tagID exists in the table item_tag</p>\n\n<p>Also, I want all the tagID to appears in the result. If there are no users subscribing or items associated with that tagID, the record will be </p>\n\n<pre><code>{tagID,tagDetails,0,0}\n</code></pre>\n\n<p>What is the best (as 'human readable' as possible) one nested query that produce this result?</p>\n"},{"tags":["sql","ruby-on-rails","query","count","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12673562,"title":"Rails - Date Query using group by and count","body":"<p>I'm trying to get the number of calls by commercial week. I've written the sql: </p>\n\n<pre><code>select strftime('%W', date_time_origination) as week, count(*)\nfrom calls\ngroup by week;\n</code></pre>\n\n<p>I then tried to run this in rails, firstly using this:</p>\n\n<pre><code>calls_by_week = Call.select(\"strftime('%W',date_time_origination) as week, count(*) as total_number_of_calls\").group(\"week\")\n</code></pre>\n\n<p>This returned a collection of objects with the correct data but repeated multiple times (json representation):</p>\n\n<pre><code>[{ \"total_number_of_calls\": 5435, \"week\": 39 },.....]\n</code></pre>\n\n<p>Given that it should have returned one object, I tried changing the rails query structure:</p>\n\n<pre><code>calls_by_week = Call.select(\"strftime('%W', date_time_origination) as week\").group(\"strftime('%W', date_time_origination)\").count\n</code></pre>\n\n<p>This time, the query returned one hash, minus the named params:</p>\n\n<pre><code>{ \"31\": 3123, \"32\": 1231,... }\n</code></pre>\n\n<p>I'd like to have the data, in json, presented as follows:</p>\n\n<pre><code>{ \"week\": 31, \"total_number_of_calls\": 12412,.....}\n</code></pre>\n\n<p>Is there a way of eliminating the duplication produced by the first query? </p>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":585,"score":2,"question_id":576096,"title":"How do I select titles from a mysql DB that begin with a specific letter?","body":"<p>I need to make an alphabetical listing of movie titles, so I need to show only items that begin with a chosen letter. To make this slightly more complicated, many titles start with \"the\" or \"a\", which needs to be ignored.</p>\n\n<p>How would the mysql query look to achieve such a task?</p>\n\n<p>I could simply have an extra column with the search letter stored for every title, since its quite easy to do with php, but Im hoping for a cleaner solution than that. </p>\n"},{"tags":["php","mysql","sql","arrays","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12671768,"title":"select and then again select distinct values","body":"<p>I have 3 columns <code>questionid</code>, <code>replyid</code> and <code>userid</code>.</p>\n\n<p>I want to select all <code>questionid's from userid where userid is session[userid]</code>,\nAnd then select distinct <code>questionid</code> from it.</p>\n\n<p>Right now I take all those <code>questionid</code> belonging to <code>$_SESSION['user_id']</code> in an array( and remove duplicates from it) and then\nI again pass another query</p>\n\n<pre><code>foreach($array as $x)\n{\n$query=\"select questionid,replyid,userid from table where questionid=$x\"\n}\n</code></pre>\n\n<p>But I think that the above steps can be done in query itself(<strong>and the above step is not working also</strong>). I tried below but its not working.\nIf I try to pass this query then duplicate value still comes:</p>\n\n<pre><code>SELECT distinct(questionid),replyid,userid \nfrom table \nwhere userid=$_SESSION['user_id']\n</code></pre>\n\n<p>So what should be the query?</p>\n\n<pre><code>questionid,replyid,userid\n\n8          ,2     ,45\n\n8          ,3      ,45\n\n9           ,8      ,41\n</code></pre>\n\n<p>But as  <code>8,2</code> and <code>8,3</code> are in same webpage(one question and two answers), I want to avoid showing duplicate question...</p>\n\n<p>So I was trying the wrong way as I was taking distinct <code>questionid</code> and then again selecting <code>* from table where questionid</code> was previous one.</p>\n\n<p>But then as @ Mahmoud Gamal suggested I did </p>\n\n<pre><code> SELECT distinct questionid, `answerid`, `userid`\n FROM `table` \n WHERE  userid='$user' \n</code></pre>\n\n<p>But again I had done the same duplicate thing. So I added <code>limit 0,1</code></p>\n\n<pre><code> SELECT distinct questionid, `answerid`, `userid`\n FROM `table`\n WHERE  userid='$user' \n LIMIT 0,1\n</code></pre>\n"},{"tags":["php","mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12671976,"title":"SELECT QUERY structure","body":"<p>I have a query I am hoping to shorten.</p>\n\n<pre><code>SELECT date1, date2, date3, date4, date5, date6, date7 FROM dates_db \nWHERE date1 =('$date1') OR date1 =('$date2') OR date1=('$date3') \nOR date1=('$date4') OR date1=('$date5') OR date1=('$date6') \nOR date1=('$date7') OR date2 =('$date1') OR date2 =('$date2') \nOR date2=('$date3') OR date2=('$date4') OR date2=('$date5')\nOR date2=('$date6') OR date2=('$date7') OR date3 =('$date1') \nOR date3 =('$date2')OR date3=('$date3') OR date3=('$date4') \nOR date3=('$date5') OR date3=('$date6') OR date3=('$date7')\n</code></pre>\n\n<p>and so on for date 1-7 .</p>\n\n<p>This query is massive, is there any way of shortening it. This is for a calender type design where it is looking for data entries that are in different days. So if a date matches then it will post it to the calendar.</p>\n"}]}
{"total":20740,"page":17,"pagesize":100,"questions":[{"tags":["wordpress","query","taxonomy","custom-post-type"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12671165,"title":"How can I use WP_query for a custom post type by taxonomy?","body":"<p>I have this line of code that works:</p>\n\n<pre><code>WP_Query(array('slidecat' =&gt; 'extra', 'showposts'=&gt;$slides) )\n</code></pre>\n\n<p>This queries my custom slider post typecalled \"slidecat\" for anything with the custom taxonomy of \"extra\".  The problem is, the way the taxonomies are passed with my framework it is the taxonomy's id number that is passed rather than its slug name.  So if i were to replace the hard coded 'extra' with what the framework's settings would output, it would send '4', or if it were using multiple categories it would send an array with several numbers if several taxonomies were selected.</p>\n\n<p>Does anyone know how I can change my wp_query so that it can use the id number of the custom taxonomy instead of the name?  Right now it just doesn't query anything if that line looks like this:</p>\n\n<pre><code>WP_Query(array('slidecat' =&gt; '4', 'showposts'=&gt;$slides) )\n</code></pre>\n\n<p>// Short version:</p>\n\n<p>I want to use id numbers instead of slug names.  This works with slug names:</p>\n\n<pre><code>WP_Query(array('slidecat' =&gt; 'extra', 'showposts'=&gt;$slides) )\n</code></pre>\n\n<p>How can I make this work with id numbers?</p>\n\n<pre><code>WP_Query(array('slidecat' =&gt; '4', 'showposts'=&gt;$slides) )\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12669757,"title":"SQL, NOT IN within a group","body":"<p>I have a table T1 with fields f1 and f2 and a table T2 with fields f3 and f4.</p>\n\n<p>Let 's have some dummy values : </p>\n\n<pre><code>T1: (1,1) (2,3) (3,3) (4,3) (5,1)\nT2: (1,1) (1,2) (3,1) (3,3)\n</code></pre>\n\n<p>We can think of f2 and f3 as defining the same thing, a bridge between T1 and T2. I would like to retrieve every f1 that is not associated with a f4 value of 2 . So my expected output would be :</p>\n\n<p>(2),(3),(4) as at the 1 and 5 F1 value F2=F3=1 has f4=2 on T2.</p>\n\n<p>How can I achieve this ?</p>\n\n<p>Edit 2 : I forgot to mention that T1 is derived from a long process and expected to be a small table whereas T2 is massive, and impossible to operate on without indexes</p>\n"},{"tags":["php","mysql","query","insert"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":53,"score":-4,"question_id":12670979,"title":"MySQL INSERT two fields only","body":"<p>I have a table with quite a few columns. The total number of columns is not yet specified, and will change on a regular basis.</p>\n\n<p>In my insert query, I only need to put two values into the table. All other values will be ' '. is there a way to only specify the first fields, without having to include '','','',''...? Please see below for example:</p>\n\n<p>I would like to have this:</p>\n\n<pre><code>$query = mysql_query(\"INSERT INTO table VALUES('','$id')\");\n</code></pre>\n\n<p>Rather than this:</p>\n\n<pre><code>$query = mysql_query(\"INSERT INTO table VALUES('','$id','','','','','',''......and on and on...)\");\n</code></pre>\n\n<p>Is there a way to do this? Thanks!</p>\n"},{"tags":["mysql","sql","query","stored-procedures","mysql-workbench"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":42,"score":-2,"question_id":12669744,"title":"How to rename the table in mysql","body":"<p>This is my code to rename the table.</p>\n\n<pre><code>SELECT  @MinDate := MIN(time) FROM trans;\n\nSELECT  @MaxDate := MAX(time) FROM trans;\n\nset @NewTableName := CONCAT(@MinDate, '-' , @MaxDate );\n\nRENAME TABLE trans To @NewTableName;\n</code></pre>\n\n<p>In this I'm getting error like</p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax to use\n  near '@NewTableName</p>\n</blockquote>\n\n<p>I don't know What is the error.</p>\n\n<p>Can any one help me.</p>\n\n<p>Very Urgent</p>\n"},{"tags":["java","query","mongodb","object","nested"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12670195,"title":"MongoDB Query in Java, search/find in nested object","body":"<p>I'm having a little trouble with a query in Java on a MongoDB.</p>\n\n<p>I have the follow structure in the database:</p>\n\n<pre><code>            {\n              \"_id\" : ObjectId(\"5059c214707747cbc5819f6f\"),\n              \"id\" : \"7\",\n              \"title\" : \"test4\",\n              \"keywords\" : \"keyword 1, keyword 2\",\n\n              \"partner\" : {\n                \"id\" : \"1\",\n                \"name\" : \"partner\",\n                \"keywords\" : \"partner keyword 1, partner keyword 2\"\n              },\n              \"status\" : {\n                \"id\" : \"0\",\n                \"name\" : \"Expired\"\n              },\n\n              \"modified\" : \"2012-09-27\"\n            }\n</code></pre>\n\n<p>I want the query the database for the field 'Status.name', example \nSELECT * FROM table WHERE status.name = 'Expired'</p>\n\n<p>How would I do such a query in Java for MongoDB?</p>\n\n<p>Thanks for any help or suggestions!</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":144,"score":-1,"question_id":10146345,"title":"How to insert random values to a table field?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3371503/sql-populate-table-with-random-data\">SQL Populate table with random data</a>  </p>\n</blockquote>\n\n\n\n<p>How to insert random values to table field? like if i want to enter 100 virtual phone numbers of 100 students, how can i do that? Thanks.\nPs: It should be a 9 digit random number?</p>\n"},{"tags":["c#","xml","linq","query","xmldocument"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12668391,"title":"Getting last element of an xml file","body":"<p>let say i have the following xml file</p>\n\n<pre><code>&lt;Users&gt;\n &lt;User&gt;\n  &lt;Name&gt;David&lt;/Name&gt;\n  &lt;Date&gt;9/30/2012 10:52:00 PM&lt;/Date&gt;\n &lt;/User&gt;\n &lt;User&gt;\n  &lt;Name&gt;David&lt;/Name&gt;\n  &lt;Date&gt;9/30/2012 11:02:05 PM&lt;/Date&gt;\n &lt;/User&gt;\n &lt;User&gt;\n  &lt;Name&gt;David&lt;/Name&gt;\n  &lt;Date&gt;9/30/2012 11:52:00 PM&lt;/Date&gt;\n &lt;/User&gt;\n &lt;User&gt;\n &lt;Name&gt;Michelle&lt;/Name&gt;\n &lt;Date&gt;9/30/2012 11:02:13 PM&lt;/Date&gt;\n &lt;/User&gt;\n &lt;User&gt;\n  &lt;Name&gt;Michelle&lt;/Name&gt;\n  &lt;Date&gt;9/30/2012 11:02:54 PM&lt;/Date&gt;\n &lt;/User&gt;\n&lt;/Users&gt;\n</code></pre>\n\n<p>I will like to read the last date of David and put it on a string in my C# program, in this case it will be \"9/30/2012 11:52:00 PM\" I have the following code which is suppose to read the date of a particular User, but it is not working</p>\n\n<pre><code>       public void readLastDate(string name)\n        {      \n        string filePaths = \"logins.xml\";\n        XmlDocument xmlDoc = new XmlDocument();\n        xmlDoc.Load(filePaths);\n\n        xmlDoc.DocumentElement.SetAttribute(\"searching\",name);\n        XmlNodeList tests = xmlDoc.SelectNodes(\"//Users[Name =/*/@searching]/User\");\n        foreach (XmlNode test in tests)\n        {\n            string myDate = test.SelectSingleNode(\"LoginDate\").InnerText;\n            InfoBox.Items.Add(\"Last  Date:\" + myDate);\n\n        }   \n</code></pre>\n\n<p>Also, how would i handle an error if i want to read a date of a user that is not in the xml file.\n        }</p>\n"},{"tags":["php","mysql","query","for-loop"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12669242,"title":"Make variable variable accessible outside of loop","body":"<p>I am trying to make a looped variable variable accessible outside of the loop. Everything works, but I am having trouble with this piece of the code:</p>\n\n<pre><code>$dayVar.\"_count\" = $dayVarCount;\n</code></pre>\n\n<p>The full code is below:</p>\n\n<pre><code>&lt;?php\n\n$day_1=\"sep_28\";\n$day_2=\"sep_29\";\n$day_3=\"sep_30\";\n\n$query = mysql_query(\"SELECT * FROM table WHERE id = '$id'\");\n\nwhile ($row = mysql_fetch_assoc($query))\n{\n\nfor ($i = 1; $i &lt;= 3; $i++) \n    {\n        $dayVar = \"day_\".$i;\n        $dayVarCount = $row[$$dayVar];\n        echo $$dayVar . ': ' . $dayVarCount . '&lt;br&gt;';\n\n        $dayVar.\"_count\". = $dayVarCount;\n    }      \n}\n\necho \"$day_3_count\";\n\n?&gt;\n</code></pre>\n"},{"tags":["string","query",".htaccess","redirect"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":33,"score":-1,"question_id":12669055,"title":"htaccess: remove query strings","body":"<p>in my website I have a lot of images like these:</p>\n\n<p>www.mysite.com/images/a.jpg&amp;image=0</p>\n\n<p>www.mysite.com/images/bc.jpg&amp;image=0</p>\n\n<p>www.mysite.com/images/def.jpg&amp;image=0</p>\n\n<p>I would like to 301 redirect these images in order to remove the \"image=0\" query string so that the links would be rewritten like</p>\n\n<p>www.mysite.com/images/a.jpg</p>\n\n<p>How could I achieve this result? Thanks</p>\n"},{"tags":["mysql","query","sql-update"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12665827,"title":"MySQL update each record based on data at the same table","body":"<p>I have one table in MySQL database (just example)</p>\n\n<pre><code>CREATE  TABLE test.Names (\n    id INT NOT NULL ,  \n    salary INT NULL ,  \n    name VARCHAR(45) NULL , \n    tmpl INT,\n    PRIMARY KEY (`id`) ,  \n    UNIQUE INDEX `id_UNIQUE` (`id` ASC)\n);\n</code></pre>\n\n<p>I have these records</p>\n\n<pre><code>id,   salary, name, tmpl\n1,    10,     John, null \n2,    20,     Pat,  null \n3,    30,     Jane, null\n</code></pre>\n\n<p>I'd like update the table by this simple calculation for each person</p>\n\n<pre><code>salary of each person/Sum(salary)*100\n</code></pre>\n\n<p>So the result should be</p>\n\n<pre><code>id,   salary, name, tmpl\n1,    10,     John, 16.67 \n2,    20,     Pat,  33.33 \n3,    30,     Jane, 50\n</code></pre>\n\n<p>How to perform this by one SQL query? Or what is the best approach (I assume the real table will have >100 000 rows)</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12668701,"title":"subquery in where clause of UPDATE statement","body":"<p>I have the database of ATM card in which there are fields account_no,card_no,is_blocked,is_activated,issue_date \nFields account number and card numbers are not unique as old card will be expired and marked as is_block=Y and another record with same card number ,account number will be inserted into new row with is_blocked=N . Now i need to update is_blocked/is_activated with help of issue_date i.e </p>\n\n<pre><code>UPDATE card_info set is_blocked='Y' where card_no='6396163270002509' \nAND opening_date=(SELECT MAX(opening_date) FROM card_info WHERE card_no='6396163270002509')\n</code></pre>\n\n<p>but is doesn't allow me to do so\nit throws following error</p>\n\n<pre><code>1093 - You can't specify target table 'card_info' for update in FROM clause\n</code></pre>\n"},{"tags":["c#","query","entity-framework","entity-framework-5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12668469,"title":"Entity Framework partial load","body":"<p>I have the following columns in my table</p>\n\n<ul>\n<li>Id (int)</li>\n<li>Name (nvarchar) usually &lt; 100 characters</li>\n<li>Data (nvarchar) average 1MB</li>\n</ul>\n\n<p>I'm writing a program that will go through each row and perform some operations to the Name field. Since I'm only using the Name field and the Data field is very large, is it possible to direct EF to only load the Id and Name field?</p>\n"},{"tags":["mysql","query","mysql-workbench"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":12668576,"title":"how to drop foreign key relation in the mysql table","body":"<p>I have one table X. I need to drop all the foreign keys in the table. I don't know how to drop. Can any one please say the query. It's very urgent</p>\n\n<p>Thanks in Advance </p>\n"},{"tags":["query","status","completion","postgresql-8.4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12641676,"title":"How to get a status of a running query in postgresql database","body":"<p>I have a select query running since long.\nHow will I get a status of that query.\nLike how long will it running. Whether it is accessing a data from the tables or not.</p>\n\n<p>Note : As per pg_stat_activity the query is running a active. Not in waiting state.\nLike is oracle we can see the source/targeting and prcessing status of a query, is there any such sort of thing in postgresql</p>\n"},{"tags":["php","database","query","cakephp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12666611,"title":"How to approach showing articles in order for a specific user id?","body":"<p>guys how would you present data (articles) from a specific user but also showing this articles in groups according to a specific category? i have like 20 different categories.</p>\n\n<pre><code>$articles = $this-&gt;Article-&gt;find ( 'all', array ('conditions' =&gt; array ('Article.user_id' =&gt; $id ) ) );\n</code></pre>\n\n<p>so that line is throwing me all the articles for a specific user to my view, but then i would like to split in groups according to the article's category. I have like 20 different categories.</p>\n\n<p>Should i iterate throughout all my categories and show wich articles are laying in each of this cat?</p>\n\n<p>is there anyother way, a clever one, to accomplish this?</p>\n"},{"tags":["query","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12662620,"title":"Microsoft Access - Creating a Query based on the Results of Another Query","body":"<p>This query generates a table of customer id's:</p>\n\n<pre><code>SELECT Transactions.customerId\nFROM Transactions \nWHERE Transactions.purchaseDate &lt;#9/1/2012#\nGROUP BY Transactions.customerId\nHAVING  Sum(Transactions.amountPaid)&lt;&gt;0;\n</code></pre>\n\n<p>This query generates a table of transactions:</p>\n\n<pre><code>SELECT Customers.firstName, Customers.lastName, Transactions.transactionId, Transactions.product, Transactions.purchaseDate, Transactions.amountPaid, Customers.customerId\nFROM Customers INNER JOIN Transactions ON Customers.customerId = Transactions.customerId\nWHERE (((Transactions.refundTransaction)=False));\n</code></pre>\n\n<p>I want to select all of the transactions (second query) from only users generated by the first query. </p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":71,"score":7,"question_id":12666306,"title":"Properly using the Count Function","body":"<p>In the Enrollment_Changes table, the phone model listed is the phone the subscriber changed FROM on that date.</p>\n\n<p>If there is no subsequent change on Enrollment_Changes, the phone the subscriber changed TO is listed on the P_Enrollment table</p>\n\n<p>For example, subscriber 12345678 enrolled on 1/5/2011 with a RAZR.  On 11/1/2011 he changed FROM the RAZR.  You can see what he changed TO with the next transaction on Enrollment_Changes on 05/19/2012.  </p>\n\n<p>How would you find the Count of subs that first enrolled with the iPhone 3? </p>\n\n<p>Here is the code I have for creating the tables</p>\n\n<p>Create Tables: TBL 1</p>\n\n<pre><code>USE [Test2]\nGO\n\n/****** Object:  Table [dbo].[P_ENROLLMENT]    ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE TABLE [dbo].[P_ENROLLMENT](\n    [Subid ] [float] NULL,\n    [Enrollment_Date] [datetime] NULL,\n    [Channel] [nvarchar](255) NULL,\n    [Region] [nvarchar](255) NULL,\n    [Active_Status] [float] NULL,\n    [Drop_Date] [datetime] NULL,\n    [Phone_Model] [nvarchar](255) NULL\n) ON [PRIMARY]\n\nGO\n</code></pre>\n\n<p>TBL 2</p>\n\n<pre><code>USE [Test2]\nGO\n\n/****** Object:  Table [dbo].[ENROLLMENT_CHANGES]     ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE TABLE [dbo].[ENROLLMENT_CHANGES](\n    [Subid] [float] NULL,\n    [Cdate] [datetime] NULL,\n    [Phone_Model] [nvarchar](255) NULL\n) ON [PRIMARY]\n\nGO\n</code></pre>\n\n<p>Insert TBL1</p>\n\n<pre><code>INSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12345678, '2011-01-05 00:00:00', 'Retail', 'Southeast', 1, NULL, 'iPhone 4');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12346178, '2011-03-13 00:00:00', 'Indirect Dealers', 'West', 1, NULL, 'HTC Hero');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12346679, '2011-05-19 00:00:00', 'Indirect Dealers', 'Southeast', 0, '2012-03-15 00:00:00', 'Droid 2');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12347190, '2011-07-25 00:00:00', 'Retail', 'Northeast', 0, '2012-05-21 00:00:00', 'iPhone 4');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12347701, '2011-08-14 00:00:00', 'Indirect Dealers', 'West', 1, NULL, 'HTC Hero');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12348212, '2011-09-30 00:00:00', 'Retail', 'West', 1, NULL, 'Droid 2');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12348723, '2011-10-20 00:00:00', 'Retail', 'Southeast', 1, NULL, 'Southeast');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12349234, '2012-01-06 00:00:00', 'Indirect Dealers', 'West', 0, '2012-02-14 00:00:00', 'West');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12349745, '2012-01-26 00:00:00', 'Retail', 'Northeast', 0, '2012-04-15 00:00:00', 'HTC Hero');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12350256, '2012-02-11 00:00:00', 'Retail', 'Southeast', 1, NULL, 'iPhone 4');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12350767, '2012-03-02 00:00:00', 'Indirect Dealers', 'West', 1, NULL, 'Sidekick');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12351278, '2012-04-18 00:00:00', 'Retail', 'Midwest', 1, NULL, 'iPhone 3');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12351789, '2012-05-08 00:00:00', 'Indirect Dealers', 'West', 0, '2012-07-04 00:00:00', 'iPhone 3');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12352300, '2012-06-24 00:00:00', 'Retail', 'Midwest', 1, NULL, 'Droid 2');\n\nINSERT INTO [P_ENROLLMENT]([Subid ], [Enrollment_Date], [Channel], [Region], [Active_Status], [Drop_Date], [Phone_Model]) \n    VALUES(12352811, '2012-06-25 00:00:00', 'Retail', 'Southeast', 1, NULL, 'Sidekick');\n</code></pre>\n\n<p>Insert TBL2</p>\n\n<pre><code>INSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12345678, '2011-11-01 00:00:00', 'RAZR');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12346178, '2012-01-07 00:00:00', 'HTC Hero');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12348723, '2012-01-28 00:00:00', 'RAZR');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12350256, '2012-02-21 00:00:00', 'Blackberry Bold');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12349745, '2012-05-05 00:00:00', 'HTC Hero');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12345678, '2012-05-19 00:00:00', 'Palm Pre');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12347190, '2012-05-20 00:00:00', 'HTC Hero');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12350256, '2012-05-21 00:00:00', 'Blackberry Bold');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12349234, '2012-06-04 00:00:00', 'Palm Pre');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12346178, '2012-06-05 00:00:00', 'iPhone 3');\n\nINSERT INTO [ENROLLMENT_CHANGES]([Subid], [Cdate], [Phone_Model]) \n    VALUES(12350767, '2012-06-10 00:00:00', 'iPhone 3');\n</code></pre>\n"},{"tags":["database","query","search","conceptual"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12612756,"title":"Why does adding an index to a database field speed up searching over that field?","body":"<p>I'm new to databases and have been reading that adding an index to a field you need to search over can dramatically speed up search times.  I understand this reality, but am curious as to how it actually works.  I've searched a bit on the subject, but haven't found any good, concise, and not over technical answer to how it works.</p>\n\n<p>I've read the analogy of it being like an index at the back of a book, but in the case of a data field of unique elements (such as e-mail addresses in a user database), using the back of the book analogy would provide the same linear look up time as a non-indexed seach.</p>\n\n<p>What is going on here to speed up search times so much?  I've read a little bit about searching using <a href=\"http://en.wikipedia.org/wiki/B%2Btree#Search\" rel=\"nofollow\">B+-Trees</a>, but the descriptions were a bit too indepth.  What I'm looking for is a high level overview of what is going on, something to help my conceptual understanding of it, not technical details.</p>\n"},{"tags":["mysql","sql","query","windows-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12664796,"title":"How can I kill MySQL queries every 60 seconds in Windows?","body":"<p>I want to check my MySQL server every minute and kill queries that have run longer than 150 seconds. The main reason I want to do this is because I don't want queries from certain people to lock up the DB for everyone else. I know this is not the ultimate solution to the problem, but at least it's a fallback in case something goes wrong with a query. I don't have a slave DB (this is just an at-home project).</p>\n\n<p>I'd like to schedule a script to run that does this for me. I'm unfamiliar with Perl or Ruby and I need it done on my Windows 2008 Server box. I've looked into creating a simple cmd line script, but that doesn't seem to be possible. I know currently I can do something like this but I have to do it manually:</p>\n\n<pre><code>mysqladmin processlist\nmysqladmin kill\n</code></pre>\n\n<p>Anyone have any ideas or examples on how I could do this?</p>\n"},{"tags":["wordpress","query","api","data","request"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":12292271,"title":"Possible to Store API Data?","body":"<p>please forgive me for the newbie question, but your help would be most appreciated.</p>\n\n<p>I want to use an API to display product information on my Wordpress site but the company says it will charge me after 1000 server requests per month.  </p>\n\n<p>Is it possible to store the requested data so I can reuse it and not pass the quota?\nWould there be any potential problems?  </p>\n\n<p>Thank you so much in advance.</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12665900,"title":"Query to find one to many relationship between two tables and two columns (exclude anything one to one)","body":"<p>New to this forum, and new to SQL.  I'm trying to clean up some data and pull out the errors.  I have two tables, which both share the columns FILENAME, TYPE, SEC, I would like to pull out any records from both tables where there is a one to many relationship between SEC and TYPE, anything with a SEC and TYPE where only a one to one relationship can be ignored and is considered valid.</p>\n\n<p>For Example,\nI have in table1.</p>\n\n<pre><code>FILENAME TYPE SEC\n\na----------------x----1\n\nb----------------x----2\n\nc----------------y----1\n\nd----------------y----3\n</code></pre>\n\n<p>in table2 i would have something similar,</p>\n\n<pre><code>FILENAME TYPE SEC\n\ne----------------x----1 \n\nf----------------x----2\n\ng----------------z----1\n\nh----------------y----3\n</code></pre>\n\n<p>so i would like a query that would find</p>\n\n<pre><code>FILENAME TYPE SEC\n\na----------------x----1\n\nc----------------y----1\n\ne----------------x----1\n\ng----------------z----1\n</code></pre>\n\n<p>My database is very large and any help would be much appreciated!</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","query","select","join","inner-join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12665260,"title":"Select records where ID from one table is present in one or more other tables","body":"<p>OK, so I've found questions that cover how to do this with only two tables, tons of questions that explain how to do this if the ID does NOT exist in other tables, but not a solution to this query.</p>\n\n<p>Basically, I have one table of wine vintages. </p>\n\n<p>I then have four other tables that contain different types of content that is tied to a specific vintage (i.e. videos, blogs etc.)  </p>\n\n<p>I basically need to be able to pull a list of vintages that are in use i.e. where the vintage ID is used in one or more of the four content tables.  </p>\n\n<p>The closest I can get is this:</p>\n\n<pre><code>SELECT DISTINCT vintage_id FROM `pr_video_vintage`\nINNER JOIN pr_video ON pr_video.fk_vintage_id = pr_video_vintage.vintage_id\nINNER JOIN pr_reports ON pr_reports.fk_vintage_id = pr_video_vintage.vintage_id\nINNER JOIN pr_reports_notes ON pr_reports_notes.fk_vintage_id = pr_video_vintage.vintage_id\nINNER JOIN pr_blog_entries ON pr_blog_entries.fk_vintage_id = pr_video_vintage.vintage_id\nORDER BY `pr_video_vintage`.`vintage_id` ASC\n</code></pre>\n\n<p>But this (understandably I guess) only returns IDs that exist in ALL of the tables.</p>\n\n<p>What I need is some form of 'OR' JOIN, but can't find any information out about how to go about doing this.</p>\n\n<p>tips? :)</p>\n"},{"tags":["performance","query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12616281,"title":"How to Quickly Update Mongo Documents String Fields with Complex Functions","body":"<p>What is the fastest way to update documents in a Mongo database with complex functions, let's say a string search / replace or a <code>sqrt</code> calculation?</p>\n\n<p>Since such operations are missing, e.g. a <code>$replace</code>, it is not possible with <code>update</code> (which would probably be the fastest, since on my test collection it only takes about 50 ms to set a field on some 100k objects).</p>\n\n<p>When I simply iterate over all documents it takes about 45 seconds. It gets a little faster when I limit my query to the fields I'm using during the update.</p>\n\n<p>This time of course grow larger on larger collections, therefore the question whether there is a faster way than iterating over the collection (e.g. via a map reduce job?).</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12664215,"title":"Script for updating the database or inserting a new row","body":"<p>People</p>\n\n<p>I am trying to use the same script for approving a contact to be added to the database, but the query will do an update if the primary key (id) is already there.  So i set up a INSERT INTO .... ON DUPLICATE KEY UPDATE query, which is below:</p>\n\n<pre><code>$resultsc = mysql_query(\"INSERT INTO $contact     (id,First,Last,Companyid,userid,Title,PrimaryPhone,SecondaryPhone,PrimaryEmail,SecondayEmail,inserted) VALUES('$id','$first','$last','$companyid','$userid','$title','$phone1','$phone2','$email1','$email2',NOW()) ON DUPLICATE KEY UPDATE (First,Last,Companyid,userid,Title,PrimaryPhone,SecondaryPhone,PrimaryEmail,SecondayEmail) VALUES ('$first','$last','$companyid','$userid','$title','$phone1','$phone2','$email1','$email2') WHERE id='$id'\"); \n\nif(!$resultsc)\n        {\n            echo \"&lt;font face='Verdana' size='2' &gt;&lt;center&gt;You have successfully approved this user for access to this site.&lt;/center&gt;&lt;br&gt;&lt;center&gt;&lt;input type='button' value='Back' onClick='history.go(-2)'&gt;&lt;/center&gt;\"; die();\n        }\nelse\n    {\n\n        echo \"&lt;font face='Verdana' size='2' &gt;&lt;center&gt;You have not updated this contact for this site.&lt;/center&gt;&lt;br&gt;&lt;center&gt;&lt;input type='button' value='Back' onClick='history.go(-2)'&gt;&lt;/center&gt;\";\n    }\n</code></pre>\n\n<p>I am not getting any errors but the database is not updating or inserting a new record. So I checked my \"$contacts\" variable to ensure it is is pointing to the correct table, and it is.  If i just do an insert alone then the script is working fine.  But when i do this query nothing happens.  I am wondering what is wrong with it or should i just have a if/else with a select checking for a existing key?</p>\n"},{"tags":["query","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12663567,"title":"Access query: show the first records","body":"<p>I have a table like this:</p>\n\n<pre><code>name1      | name2  | value1\n-------------------------\nApple      | asdg   | 100\nApple      | ghf    |  50\nLemon      | dhjhgf |  60\nMeat       | iop    | 300\nMeat       | pdjs   |  70\nMeat       | ncm    |  10\nStrawberry | jdksa  |  20\n</code></pre>\n\n<p>What should I do to get this:</p>\n\n<pre><code>name1      | name2  | value1\n----------------------------\nApple      | asdg   | 100\nLemon      | dhjhgf |  60\nMeat       | iop    | 300\nStrawberry | jdksa  |  20\n</code></pre>\n"},{"tags":["mysql","sql","query","wildcard","mysql-like"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12662386,"title":"Error no 1064 when searching for last name ending with i","body":"<p>When Trying to do a wildcard search for the  last name ending with the letter <code>i</code>, I keep getting the error no 1064. Here is my query:</p>\n\n<pre><code>select fname , lname  \nfrom empinfo  \nwhere fname like '%i' \n</code></pre>\n\n<p>What I am doing wrong?</p>\n"},{"tags":["query","mvc","yii"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12661510,"title":"Yii MVC : how to select 1 registration using the best method","body":"<p>I have a table in the database and from this table i want to select 1 registration, using the UPDATE field, like: </p>\n\n<pre><code>select * from website order by update asc limit 1; \n</code></pre>\n\n<p>is there a better way to load the registration than using the createCommand ? </p>\n\n<p>and once i load the registration, how to i update the update field ?</p>\n\n<p>I would prefere using Active Records.</p>\n"},{"tags":["mysql","sql","query","group-by","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":12660167,"title":"Show datas from tables that can have a same data in a column in the same table","body":"<p>I crawled some datas from a web then directly save them in database, so I got <code>$title</code>, <code>$url</code>, and <code>$author</code>. But, the number of <code>$author</code> for one <code>title</code> can more than 1 data. So, I separated <code>$author</code> from <code>$title</code> and <code>$url</code>. all <code>id</code> is auto increment.</p>\n\n<pre><code>tb_wrapper            tb_author\n=================     ==================\n|id| title | url|    |id|author|$title|\n=================     ==================\n|1 |titleA |urlA|    | 1| A    |titleA|\n=================     | 2| B   |titleA|\n                    ===================\n</code></pre>\n\n<p>in the other process(from document files that I got that their filename is same with $title), i have a table also that contain <code>$title</code> : <code>tb_doc</code></p>\n\n<pre><code>======================\n|id | content | title|\n======================\n|1  | contentA|titleA|\n======================\n</code></pre>\n\n<p>I need to get datas from those 3 tables, so I can get the result like :\n<code>titleA has URLA contentA and author  A and B</code></p>\n\n<p>here's the code :</p>\n\n<pre><code>$query = mysql_query(\"SELECT\n                            tb_wrapper.url,\n                            tb_wrapper.title,\n                            tb_author.title,\n                            tb_author.author,\n                            tb_doc.content,\n                            tb_doc.title\n                       FROM\n                            tb_doc\n                       INNER JOIN tb_wrapper ON tb_doc.title = tb_wrapper.title\n                       INNER JOIN tb_author ON tb_wrapper.title = tb_author.title \");\n</code></pre>\n\n<p>But, from that,  I got duplicate result, author A and B are separated. please, help me, what join I have to do ? thank you very much :)</p>\n"},{"tags":["mysql","sql","query","group-concat"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":55,"score":2,"question_id":12661107,"title":"Selecting multiple rows of data from a subtable along with the parent row table in MySQL","body":"<p>I have two tables in my database roughly laid out as below</p>\n\n<p>Client</p>\n\n<pre><code>id |  other data\n1  |  data 1\n2  |  data 2\n3  |  data 3\n4  |  data 4\n</code></pre>\n\n<p>Employee assigned</p>\n\n<pre><code>id  | clientid | employee\n1   | 1        | Fred\n2   | 1        | Jim\n3   | 3        | Peter\n4   | 4        | Fred\n5   | 4        | Peter\n6   | 4        | James\n</code></pre>\n\n<p>Is there a way to return the client table with all of the employee records from the employee table?  Ideally I would want both the id of the row and the employee name so I don't think I can use GROUP_CONCAT to collect more than one column.  There is also no guarantee that there will always be an entry for each client in the employee table so it would need to return an empty/null result for those clients.</p>\n\n<p>I have tried two ways to get this so far in php, both are pretty inefficient in one way or another.  </p>\n\n<p>(A) The first was to effectively make a new database connection half way through the first one to return the list of employees associated with that client id but obviously that results in a significant number of database connections being made for just one query. </p>\n\n<p>(B) The second was to pull the entire employee table into an array at the beginning of the code and search through that array to pull out the rows relating to that client id which then have the employee name and row id in.  Over time this is going to end up with a pretty large array being dumped into php instantly.</p>\n\n<p>Is there some way of pulling this out using just a single SQL query?  I'm not all that fussed how the data would come out as I am sure I could sort through it in the php at the other end, but perhaps something along the lines of</p>\n\n<p>Results</p>\n\n<pre><code>id |  other data | employees\n1  |  data 1     | 1,Fred;2,Jim\n2  |  data 2     | \n3  |  data 3     | 3,Peter\n4  |  data 4     | 4,Fred;5,Peter;6,James\n</code></pre>\n\n<p>If this has been asked before somewhere I apologise, but I have been searching around a bit over the last week and haven't found all that much to help.</p>\n"},{"tags":["sql","query","select","union"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":12660775,"title":"Is it possible to set a flag during sql query","body":"<p>I'm trying to do an SQL query like that</p>\n\n<pre><code>(SELECT ID, Name FROM Book)\nUNION\n(SELECT ID, Name FROM Author)\n</code></pre>\n\n<p>and I would like to know in the final table which ids are from book and which ones from author\nsetting a flag or something like that.</p>\n"},{"tags":["mysql","database","query","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12657853,"title":"How to solve this query in mysql","body":"<p>I have this records in MySQL below </p>\n\n<pre><code>RecID | Description | Date | Hits | IsPublished \n1; \"Test\"; 04/10/2012; 45; True\n2; \"Test 1\"; 04/10/2012; 37; True\n3; \"Test 2\"; 05/10/2012; 12; True\n4; \"Test 3\"; 05/10/2012; 13; True\n5; \"Test 4\"; 07/10/2012; 14; True\n6; \"Test 5\"; 07/10/2012; 25; True\n7; \"Test 4\"; 08/10/2012; 23; True\n8; \"Test 5\"; 08/10/2012; 35; True\n9; \"Test 9\"; 12/10/2012; 7; True\n</code></pre>\n\n<p>Would like to achieve the following</p>\n\n<pre><code>9; \"Test 9\"; 12/10/2012; 7; True \n8; \"Test 5\"; 08/10/2012; 35; True\n4; \"Test 3\"; 05/10/2012; 13; True\n</code></pre>\n\n<p>Basically, the first rule is to group the date which is 08/10/2012, 07/10/2012 and 05/10/2012 and 04/10/2012. Use this 08/10/2012 as a starting point. Then remove any dates that is close to each other (min 1 day). </p>\n\n<p>BTW ... this is an Australian date (DD/MM/YYYY). Therefore, the result is 08/10/2012, 05/10/2012. Out of these 2 \"valid\" days and then pick the record that has more hits on that day. Then set the others as IsPublished = false.</p>\n\n<p>Any ideas to do this in MySQL? </p>\n"},{"tags":["query","hibernate","list","criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12659840,"title":"Hibernate Criteria in a list query","body":"<p>I have 2 classes. The first class Car has a list of passengers. I need a Hibernate Criteria that will return the Car for which I have a single passenger. So something like this </p>\n\n<pre><code>class Car {\n\n   @Id\n   private Long id;\n   @OneToMany\n   private List&lt;Passenger&gt; passengers;\n}\n</code></pre>\n\n<p>And in the Hibernate class</p>\n\n<pre><code>@Override\npublic Car retrieve(Passenger passenger) {\n    Criteria criteria = super.createCriteria();\n    criteria.add(Restrictions.eq(\"passengers\", passenger));\n    return (Car  ) criteria.uniqueResult();\n}\n</code></pre>\n\n<p>However the below wont really work. So any suggestions how to do this</p>\n"},{"tags":["mysql","sql","query","expression"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12660089,"title":"Can I run a MySQL query in a MySQL database field expression?","body":"<p>I'm wondering how to use expressions in a MySQL database (running <code>MySQL 5.0.88</code>). I recall from my dark MSAccess ages, that expressions where quite handy, but I never tried using a query in an expression. So:</p>\n\n<p>Say I have a table with fields:</p>\n\n<pre><code> dyn_usage  (True/False)\n actual_useage\n</code></pre>\n\n<p>First field indicates whether an item is billed on actual usage (or flat fee).</p>\n\n<p>Could I then add an expression to the <code>actual_usage</code> field which contains a MySQL query (querying for the usage of the current_user like so:</p>\n\n<pre><code> &lt;!--- if dyn_usage = 1 ---&gt;\n SELECT COUNT( a.id ) AS no_of_instances\n    FROM agents AS a\n    WHERE a.verkaeufer = &lt;cfqueryparam value = \"#Session.loginId#\" cfsqltype=\"cf_sql_varchar\" maxlength=\"13\"&gt;\n    AND a.status = \"active\"\n</code></pre>\n\n<p>If I can store SQL expressions, does this include parameters (I'm running Coldfusion, hence the cfqueryparam). </p>\n"},{"tags":["mysql","query","mysql-error-1064","backticks"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12658763,"title":"Why did I have to use backticks around the table name in my MySQL query?","body":"<p>As far as I have read, backticks are not required around, for example, table names in queries: (\"INSERT INTO table_name....\"). In addition, to my knowledge, underscores are perfectly acceptable syntax to use in names: foo_bar. My question then is, why did this query fail:</p>\n\n<pre><code>mysql_query(\"INSERT INTO quick_links WHERE ...etc\");\n</code></pre>\n\n<p>when this query worked perfectly:</p>\n\n<pre><code>mysql_query(\"INSERT INTO `quick_links` WHERE ...etc\");\n</code></pre>\n\n<p>Are \"quick\" or \"links\" reserved words??? I didn't think so, but then again, I'm fairly new to MySQL, so I apologize. Also,is using backticks necessary in certain \"Storage Engines\" (referencing phpMyAdmin for the terminology)? I happen to be using \"InnoDB\" if that makes any difference. </p>\n\n<p>Thanks for the answers, I'm new to MySQL, and I like to make sure I understand nuances like these. </p>\n\n<p>My full query was this:</p>\n\n<pre><code>mysql_query(\"INSERT INTO `quick_links` VALUES (\n    '$user_id', '$ql_name', '$ql_url', '$ql_img'\n)\"); \n</code></pre>\n\n<p>$ql_url and $ql_name were obtained via $_POST and then sanitized with trim and mysql_real_escape_string before being used in the query. $ql_img is simply a url referring to a directory in which a thumbnail is uploaded, and $user_id is there to, well, identify the particular user who is logged in. Both queries were exactly the same, literally, except for the backticks around the table_name. </p>\n"},{"tags":["query","google-app-engine","jdo","ancestor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":209,"score":0,"question_id":7124772,"title":"Using JDO with HRD on Google App Engine","body":"<p>To get consistent queries with HRD, we are told to use ancestor queries.</p>\n\n<p>i am using JDO, however i cannot find an example of an ancestor query using JDO Query.</p>\n\n<p>can someone tell me if its possible, and if so can you point me to an example?</p>\n\n<p>thank you.</p>\n"},{"tags":["php","query","communication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":11019582,"title":"make a php page load another php script server to server communication","body":"<p>I've tried looking for a solution to this issue for a few days now and am getting quite confused.</p>\n\n<p>Aim:</p>\n\n<blockquote>\n  <p>To have a PHP server (\"Server A\") communicate directly to another PHP\n  server (\"Server B\") when Server A is visited by user. It then sends a\n  query string to Server B to add in to Server B's database.</p>\n</blockquote>\n\n<p>Full story:</p>\n\n<blockquote>\n  <p>A visitor will visit Server A and register to their website, as part\n  of their registration Server A will write to Server A's database with\n  all the visitors information. At this point I'd like Server A to load\n  a .php file on Server B and send a query string with it, for example:\n  <a href=\"http://example.com/api/add.php?name=Craig&amp;age=21&amp;key=32r932r9832yr813hr813rh1389ry13r7y31r\" rel=\"nofollow\">http://example.com/api/add.php?name=Craig&amp;age=21&amp;key=32r932r9832yr813hr813rh1389ry13r7y31r</a>.\n  Server B, having a PHP file requested from it, will take the variables\n  and run the script on add.php (take the variables and add it to it's\n  database).</p>\n</blockquote>\n\n<p><strong>Important note: I don't want the client machine to know this, initially I wanted to use JQUERY but realised this sends the request from the client machine and not the server directly.</strong></p>\n\n<p>What is the best way to do this?</p>\n\n<p><em>Many thanks in advance!</em></p>\n\n<p>Craig</p>\n"},{"tags":["php","mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12657586,"title":"MySQL server has gone away - after a mysql php loop","body":"<p>I'm making a query over a database with over 20MM entries, that means im breaking the query into several smaller queries.</p>\n\n<p>The problem is if I try to fetch the 20MM entries the page does not load and gets the notice: MySQL server has gone away, and displays a blank screen, with no title and content. However, if I fetch 5MM entries, the page does load correctly, and displays the content:</p>\n\n<p>Here's my code</p>\n\n<pre><code>error_reporting(E_ALL);\nini_set('display_errors', TRUE);\nini_set('display_startup_errors', TRUE);\nini_set('memory_limit', '1000M');\nfor($n=0; $n&lt;20000000; $n=$n+500000){\n    $m=500000;\n$query = \"SELECT * FROM user_likes LIMIT \". $n .\",\". $m; \n//echo $query;\n$result = mysql_query($query) or die(mysql_error());\n\n// craete arrays\nwhile($row = mysql_fetch_array($result)){\n    set_time_limit(0);\n    $like[$row['name']]=$like[$row['name']]+1;\n    if($like[$row['name']]==375) $likes375 ++; \n\n}\n\n\n}\n\n// print the size\necho count($like).\"&lt;br&gt;\";\necho \"375: \".$likes375; \n</code></pre>\n\n<p>I would appreciate if someone can help me with this. Thanks</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12657252,"title":"blank page with big loops","body":"<p>I'm making a query over a database with over 20MM entries, that means im breaking the query into several smaller queries.</p>\n\n<p>The problem is if I try to fetch the 20MM entries the page does not load, and displays a blank screen, with no title and content. However, if I fetch 5MM entries, the page does load correctly, and displays the content:</p>\n\n<p>Here's my code</p>\n\n<pre><code>for($n=0; $n&lt;20000000; $n=$n+500000){\n    $m=500000;\n$query = \"SELECT * FROM user_likes LIMIT \". $n .\",\". $m; \n//echo $query;\n$result = mysql_query($query) or die(mysql_error());\n\n// craete arrays\nwhile($row = mysql_fetch_array($result)){\n    set_time_limit(0);\n    $like[$row['name']]=$like[$row['name']]+1;\n    if($like[$row['name']]==375) $likes375 ++; \n\n}\n\n\n}\n\n// print the size\necho count($like).\"&lt;br&gt;\";\necho \"375: \".$likes375; \n</code></pre>\n\n<p>I would appreciate if someone can help me with this.\nThanks</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>after adding <code>error_reporting(E_ALL);</code> it display this notice: MySQL server has gone away</p>\n"},{"tags":["sql","linq","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12657384,"title":"Need help to write complicated SQL query","body":"<p>I have this SQL query that return 3 rows of complete columns results.</p>\n\n<pre><code> select * from AcceptanceDocument a\n     right join Documents d on a.FkDocumentId = d.Id\n inner join ProjectDocuments td on d.Id = td.FkDocumentId \n     where d.FkDocumentTypeId = 1 and td.FkProjectId = 8\n</code></pre>\n\n<p>I have to add this condition « <strong>and a.FkSubId = 6</strong> » and get always the same three rows but with few empty column. </p>\n\n<p>The result should look like that : </p>\n\n<pre><code>Dave | Hello | NULL | NULL\n\nSome | What  | NULL | NULL\n</code></pre>\n\n<p>But I don't have any result and I don't know how write my query to do that. Usually the right join or left join should let you know that thing right ? </p>\n\n<p>What is wrong in my query ? </p>\n\n<p>Thank you for your help, </p>\n\n<p>Dave</p>\n\n<h2>Edit for comments below</h2>\n\n<p><strong>Here table structure</strong></p>\n\n<p><em>AcceptanceDocument</em> | \n Id, FkTenderId, FkSubmissionId, FkDocumentId</p>\n\n<p><em>Documents</em> | Id, FkDocumentTypeId, FriendlyName, Name, Path, RelativePath</p>\n\n<p><em>ProjectDocuments</em> | Id, FkTenderId, FkDocumentId</p>\n\n<p><strong>Here table data</strong></p>\n\n<p><em>AcceptanceDocument</em> | (1, 8, 4, 2), (2, 8, 4, 4), (3 ,8 ,4 ,5)</p>\n\n<p><em>Documents</em> | (1, 2, \"Some name\", \"Some name\", \"A path\", \"A path\")...</p>\n\n<p><em>ProjectDocuments</em> | (1, 8 , 1), (2, 8, 2), (3,8,3), (4,8,4), (5,8,5)</p>\n"},{"tags":["java","query","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12657283,"title":"Creating a hibernate disjunction query programatically","body":"<p>I have a chunk of java code which hard codes a hibernate disjunction query that looks like this </p>\n\n<pre><code>session = HibernateUtils.beginTransaction(\"outpatient\");\n        Criteria criteria = session.createCriteria(AugmentToken.class);\n        session.beginTransaction();\n        if (type == Constants.ICD9CPT) {\n            criteria.add(Restrictions.disjunction()\n                    .add(Restrictions.eq(\"codeType\", \"d\"))\n                    .add(Restrictions.eq(\"codeType\", \"p\"))\n                    .add(Restrictions.eq(\"codeType\", \"c\")));\n        } else if (type == Constants.EM) {\n            criteria.add(Restrictions.disjunction()\n                    .add(Restrictions.eq(\"codeType\", \"eros\"))\n                    .add(Restrictions.eq(\"codeType\", \"ehpi\"))\n                    .add(Restrictions.eq(\"codeType\", \"epe\")));\n        }\n</code></pre>\n\n<p>But this is not very elegant code.    What I would like to do is pass an array of codetypes to a method, and dynamically construct the dijunction criteria.   Every website I look at provides examples of disjunctive queries that look like the above, but this will not work for me because I don't want to hard code the construction of the restriction for the criteria since the number of code types can vary.   </p>\n\n<p>How do I do this?</p>\n\n<p>Thank you,</p>\n\n<p>Elliott</p>\n"},{"tags":["mysql","query","nested"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12657031,"title":"Queries and subqueries in MySQL, show customers with products purchased","body":"<p>i have one problem this is my simple diagram:</p>\n\n<p><img src=\"http://i45.tinypic.com/121c48m.png\" alt=\"relationship diagram\"></p>\n\n<p>Well I tried a lot and I can not do what I need, I need to display a list of customers who have made purchases, with most purchased products in every purchase made, for example</p>\n\n<p>Customer number 1 ---> BUY:</p>\n\n<ul>\n<li>4 chicken soups</li>\n<li>3 meat soups</li>\n<li>2 shrimp soup</li>\n</ul>\n\n<p>Customer number 2 --->BUY:</p>\n\n<ul>\n<li>1 chicken soups</li>\n<li>1 meat soups</li>\n<li>2 shrimp soup</li>\n</ul>\n\n<p>Customer number 3 --->BUY:</p>\n\n<ul>\n<li>4 chicken soups</li>\n<li>8 meat soups</li>\n<li>1 shrimp soup</li>\n</ul>\n\n<p>The result of my query must be:</p>\n\n<p><img src=\"http://i45.tinypic.com/2ni9w87.png\" alt=\"query result\"></p>\n\n<p>Please help me make this mysql query correctly</p>\n"},{"tags":["mysql","query","drupal-7","drupal-views"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12655868,"title":"How to see a valid mysql query from Drupal Views","body":"<p>I read some suggestions but couldn't figure out how to make the query that is generated and shown by views - valid in mysql. There are some variables closed in {} and also I think there are some tables in the query which don't exist in the DB. Im trying to extract a quite complicated query here it is. 10x in advance!</p>\n\n<pre><code>SELECT field_data_field_punch_status.field_punch_status_value AS field_data_field_punch_status_field_punch_status_value, users.name AS users_name, users.uid AS uid_1, field_data_field_punch_start.field_punch_start_value AS field_data_field_punch_start_field_punch_start_value, field_data_field_team.field_team_tid AS field_data_field_team_field_team_tid, users.access AS users_access, MIN(users.uid) AS uid, 'user' AS field_data_field_punch_status_user_entity_type, 'user' AS field_data_field_punch_start_user_entity_type, MIN(node_users.nid) AS node_users_nid, 'node' AS field_data_field_punch_end_node_entity_type, MAX(node_users__field_data_field_punch_end.field_punch_end_value) AS node_users__field_data_field_punch_end_field_punch_end_value, 'user' AS field_data_field_team_user_entity_type\nFROM \n{users} users\nLEFT JOIN {field_data_field_team} field_data_field_team ON users.uid = field_data_field_team.entity_id AND (field_data_field_team.entity_type = 'user' AND field_data_field_team.deleted = '0')\nINNER JOIN {taxonomy_term_data} taxonomy_term_data_field_data_field_team ON field_data_field_team.field_team_tid = taxonomy_term_data_field_data_field_team.tid\nLEFT JOIN {node} node_users ON users.uid = node_users.uid\nINNER JOIN {users_roles} users_roles ON users.uid = users_roles.uid\nLEFT JOIN {field_data_field_punch_status} field_data_field_punch_status ON users.uid = field_data_field_punch_status.entity_id AND (field_data_field_punch_status.entity_type = 'user' AND field_data_field_punch_status.deleted = '0')\nLEFT JOIN {field_data_field_punch_start} field_data_field_punch_start ON users.uid = field_data_field_punch_start.entity_id AND (field_data_field_punch_start.entity_type = 'user' AND field_data_field_punch_start.deleted = '0')\nLEFT JOIN {field_data_field_punch_end} node_users__field_data_field_punch_end ON node_users.nid = node_users__field_data_field_punch_end.entity_id AND (node_users__field_data_field_punch_end.entity_type = 'node' AND node_users__field_data_field_punch_end.deleted = '0')\nWHERE (( (field_data_field_team.field_team_tid IN('0', '10', '11', '22', '12', '2', '21', '3', '13', '4', '14', '5', '15', '6', '16', '7', '17', '18', '20', '19') ) AND (users_roles.rid IN  ('4', '5')) ))\nGROUP BY field_data_field_punch_status_field_punch_status_value, users_name, uid_1, field_data_field_punch_start_field_punch_start_value, field_data_field_team_field_team_tid, users_access\nORDER BY field_data_field_punch_start_field_punch_start_value DESC, users_access DESC\n</code></pre>\n"},{"tags":["sql","sql-server-2008","query","tsql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":180,"score":0,"question_id":11714915,"title":"FULL OUTER JOIN vs. FULL JOIN","body":"<p>Just playing around with queries and examples to get a better understanding of joins.  I'm noticing that in SQL Server 2008, the following two queries give the same results:</p>\n\n<pre><code>SELECT * FROM TableA\nFULL OUTER JOIN TableB\nON TableA.name = TableB.name\n</code></pre>\n\n<hr>\n\n<pre><code>SELECT * FROM TableA\nFULL JOIN TableB\nON TableA.name = TableB.name\n</code></pre>\n\n<p>Are these performing exactly the same action to produce the same results, or would I run into different results in a more complicated example?  Is this just interchangeable terminology?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12656418,"title":"MySQL limit inside of the subquery produces error","body":"<p>I'm receiving:</p>\n\n<p><code>[Err] 1235 - This version of MySQL doesn't yet support 'LIMIT &amp; IN/ALL/ANY/SOME subquery'</code></p>\n\n<p>While executing the following query:</p>\n\n<pre><code>UPDATE account.account\nSET STATUS = 'BLOCK'\nWHERE\n    id IN (\n        SELECT\n            p.account_id\n        FROM\n            log.log\n        LEFT JOIN player.player p ON (p.id = log.who)\n        WHERE\n            vnum = 71054\n        AND how = 'BUY'\n        GROUP BY\n            log.`who`\n        HAVING\n            COUNT(log.who) &gt; 2\n        LIMIT 10\n    );\n</code></pre>\n\n<p>Is there a posibility to rewrite this query so MySQL could execute it? </p>\n"},{"tags":["php","arrays","wordpress","query","options"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12656206,"title":"php echo of_get_option to use call categories","body":"<p>This is what i want to do . Currently I am using flex slider in my wordpress and i am using this code to pull the fixed category 'featured' --> </p>\n\n<pre><code>&lt;?php\nquery_posts(array('category_name' =&gt; 'featured', 'posts_per_page' =&gt; 3));\nif(have_posts()) :\n    while(have_posts()) : the_post();\n?&gt;\n</code></pre>\n\n<p>So i am going to set options for select a category . I did that and now i got the category by --></p>\n\n<pre><code>&lt;?php echo of_get_option('example_select_categories', 'no entry' ); ?&gt;\n</code></pre>\n\n<p>I am using default settings that's why i used example staffs just as default in option framework by wptheming .</p>\n\n<p>But i can not figure what how to call the categories in between the slider to fetch the categories from the option . because php echo is not working between the array (i actually don't know good php )</p>\n\n<p>Any help will be very much appreciated .</p>\n"},{"tags":["mysql","query","database-connection","freeze"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12656100,"title":"Lost connection to MySQL server during query. when other queries are working smoothly","body":"<p>Every time when I run the below query, server freezes and after canceling the query I'm receiving the following error message:</p>\n\n<p><code>[Err] 2013 - Lost connection to MySQL server during query</code></p>\n\n<p>My query:</p>\n\n<pre><code>UPDATE products.products\nSET state = 'BOUGHT'\nWHERE\n    id IN (\n        SELECT\n            s.aid\n        FROM\n            log.log\n        LEFT JOIN shop.shop s ON (s.id = log.who)\n        WHERE\n            product_id = 171054\n        AND action = 'BUY'\n        GROUP BY\n            log.`who`\n        HAVING\n            COUNT(log.who) &gt; 2\n    );\n</code></pre>\n\n<p>Could someone help me with that? Other queries and two servers are generating hundreds of queries per second and they did not freeze, everything is working smooth except this query.</p>\n"},{"tags":["query","datetime","criteria","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":12654492,"title":"Querry Date in access","body":"<p>I have a data base that stores Date and Time in a single column for each entry as -\n8/29/2012 6:09:45 AM - as an example. I am looking for a way to Querry just today's date all regardless of the time. </p>\n\n<p>Currently I use Criteria in a Query \"Like \"<em>9/29/2012</em>\". The issue is that each day that the report is needed the date in the criteria needs to be updated, eliminating the possibility to automate the report. </p>\n\n<p>Is there a way to just to query current date with out have to overhaul the target tables, or having to update the query criteria daily?</p>\n"},{"tags":["html","sql","sql-server-2008","query","sql-management-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12627676,"title":"Passing Html tag in Update query","body":"<p>There is an existing table in database where I want to update one column. If I right click on the table--->select edit 200 rows and try to edit the cell data it says that the cell is read-only. I am using SQL management studio 2008R2. \nSo I was trying to update it using an update Query but I am pretty new to the SQL queries and the whole database thing. Is this the proper way to pass an HTML tag in queries?</p>\n\n<pre><code>UPDATE OutputTemplate\n  SET emailText='(&lt;p&gt;Thank you for your  gift of {Amount} to the {CommunityName}&lt;/p&gt;&lt;br /&gt;Support &amp; Charity Campaign.&lt;br /&gt;\n --------------------------------------------\n ---          Transaction Detail          ---\n --------------------------------------------\n &lt;span&gt;Credit Card Details&lt;/span&gt; \n &lt;span style=\"text-decoration: underline;\"&gt;Personal Info Details &amp; Amount&lt;/span&gt;)'\n WHERE id='2'\n</code></pre>\n\n<p>It's showing some parsing error, incorrect syntax while executing the query.</p>\n\n<p>Sorry to ask such a basic question but I tried to google it, unfortunatelly nothing showed up useful.</p>\n\n<p>Thanks </p>\n"},{"tags":["sql","database","query","codeigniter","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12653023,"title":"SQL statement - how do I do this in active record?","body":"<p>I am struggling to create an active record statement to do what I want, here is my current attempt:</p>\n\n<pre><code>$this-&gt;db\n            -&gt;select('*')\n            -&gt;from('item_entries')\n            -&gt;where('is_pick', 'y')\n            -&gt;join('item_categories_rel', 'item_categories_rel.item_id = item_entries.item_id')\n            -&gt;join('item_categories', 'item_categories.cat_id = item_categories_rel.cat_id')\n            -&gt;join('ratings_total', 'ratings_total.item_id = item_entries.item_id')\n            -&gt;where('item_categories.cat_id', $cat_id)\n            -&gt;or_where('parent_id', $cat_id)\n            -&gt;or_where('gparent_id', $cat_id)\n            -&gt;order_by(\"item_name\", \"desc\");  \n        $query2 = $this-&gt;db-&gt;get();\n        if(is_object($query)){return $query2-&gt;result_array();}else{return $query2;}\n</code></pre>\n\n<p>This translates to the following sql:</p>\n\n<pre><code>SELECT *\nFROM (`item_entries`)\nJOIN `item_categories_rel` ON `item_categories_rel`.`item_id` = `item_entries`.`item_id`\nJOIN `item_categories` ON `item_categories`.`cat_id` = `item_categories_rel`.`cat_id`\nJOIN `ratings_total` ON `ratings_total`.`item_id` = `item_entries`.`item_id`\nWHERE `is_pick` =  'y'\nAND `item_categories`.`cat_id` =  '3'\nOR `parent_id` =  '3'\nOR `gparent_id` =  '3'\n</code></pre>\n\n<p>Now, what I want (although I am aware I cant do temp tables in active record) is the equivalent of this:</p>\n\n<pre><code>SELECT *\nFROM (\n    SELECT *\n    FROM (`item_entries`)\n    JOIN `item_categories_rel` ON `item_categories_rel`.`item_id` = `item_entries`.`item_id`\n    JOIN `item_categories` ON `item_categories`.`cat_id` = `item_categories_rel`.`cat_id`\n    JOIN `ratings_total` ON `ratings_total`.`item_id` = `item_entries`.`item_id`\n    WHERE `is_pick` =  'y'\n    AS T\n)\nWHERE `item_categories`.`cat_id` =  '3'\nOR `parent_id` =  '3'\nOR `gparent_id` =  '3'\n</code></pre>\n\n<p>How can retrieve this result in active record?</p>\n\n<p>Please note - I have not checked the above SQL so it may be slightly wrong but hopefully you get what I am trying to do.</p>\n"},{"tags":["json","query","google","spreadsheet"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12654289,"title":"Is it possible to combine a Google Spreadsheets JSON request with a data query?","body":"<p>I have successfully used the information in the link below to get a JSON output from a Google spreadsheet.  </p>\n\n<p><a href=\"https://developers.google.com/gdata/samples/spreadsheet_sample\" rel=\"nofollow\">https://developers.google.com/gdata/samples/spreadsheet_sample</a></p>\n\n<p>Is it possible to combine this JSON request with a data query, such as those seen in the link below this?</p>\n\n<p><a href=\"https://developers.google.com/chart/interactive/docs/querylanguage\" rel=\"nofollow\">https://developers.google.com/chart/interactive/docs/querylanguage</a></p>\n"},{"tags":["php","sql","query","query-performance"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":11505008,"title":"query to get multiple rows with or without group concat","body":"<p>I have the following table structure:</p>\n\n<pre><code> users:\n    id PK\n    username\n    email\n    salt\n    password\n    date_created\n\nquestions:\n    id PK\n    user_id FK(users)\n    title\n    date_created\n    date_updated\n\nanswers:\n    id PK\n    question_id FK(questions)\n    user_id FK(users)\n    body\n    date_created\n</code></pre>\n\n<p>So I need a query that gets data from these tables and displays the user's last 5 questions and for each question the first 3 answers. Something like this:\n\"What is my favorite color? posted by user\n    red - posted by user1\n    green - posted by user2\n    yellow - posted by user3</p>\n\n<p>.....\n\"\nSo this is the display I am aiming for. How can I do this in 1 query? Should I use group concat to group the multiple answers for 1 question? Or should I get the results and parse the array in PHP to group the answers by question_id. Also I need this query to be very fast. I am not sure if it will be faster making 1 query or making multiple queries that get the user questions and after that the question answers.</p>\n"},{"tags":["query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12650381,"title":"PostgreSQL - Limit join to one row","body":"<p>i have the following query:</p>\n\n<pre><code>SELECT sum((select count(*) as itemCount) * \"SalesOrderItems\".\"price\") as amount, 'rma' as     \n    \"creditType\", \"Clients\".\"company\" as \"client\", \"Clients\".id as \"ClientId\", \"Rmas\".* \nFROM \"Rmas\" JOIN \"EsnsRmas\" on(\"EsnsRmas\".\"RmaId\" = \"Rmas\".\"id\") \n    JOIN \"Esns\" on (\"Esns\".id = \"EsnsRmas\".\"EsnId\") \n    JOIN \"EsnsSalesOrderItems\" on(\"EsnsSalesOrderItems\".\"EsnId\" = \"Esns\".\"id\" ) \n    JOIN \"SalesOrderItems\" on(\"SalesOrderItems\".\"id\" = \"EsnsSalesOrderItems\".\"SalesOrderItemId\") \n    JOIN \"Clients\" on(\"Clients\".\"id\" = \"Rmas\".\"ClientId\" )\nWHERE \"Rmas\".\"credited\"=false AND \"Rmas\".\"verifyStatus\" IS NOT null \nGROUP BY \"Clients\".id, \"Rmas\".id;\n</code></pre>\n\n<p>The problem is that the table EsnsSalesOrderItems can have the same EsnId in different entries. I want to restrict the query to only pull the last entry in EsnsSalesOrderItems that has that EsnId. </p>\n\n<p>By last entry i mean the following:</p>\n\n<p>The one that appears last in the table \"EsnsSalesOrderItems\". So for example if \"EsnsSalesOrderItems\" has two entries with the EsnId=6 and createdAt = 6-19-2012 and 7-19-2012 respectively it should only give me the entry from 7-19-2012</p>\n"},{"tags":["sql","sql-server","query","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12618907,"title":"Rows to columns SQL query","body":"<p>I am writing a query that will be used in a .NET application, therefore I would like the SQL Server 2008 o do much of the processing for me instead of the client PC that the application will run on.</p>\n\n<p>I am trying to get data from some tables I joined together.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>SELECT SUBSTRING(CAST(CAST(HCPD.SeferCikisZamani AS TIME) AS VARCHAR), 1, 5) AS Kalkis, SUBSTRING(CAST(CAST(HCPD.DonusZamani AS TIME) AS VARCHAR), 1, 5) AS Donus, V.AracPlaka\nFROM HAT_CALISMA_PLANI HCP WITH(NOLOCK)\nINNER JOIN HAT_CALISMA_PLANI_DETAY HCPD WITH(NOLOCK) ON HCPD.HatCalismaPlaniKey = HCP.HatCalismaPlaniKey\nINNER JOIN VALIDATOR V WITH(NOLOCK) ON V.ValidatorKey = HCPD.ValidatorKey\nWHERE HCP.HatKey = 2 AND CAST(HCPD.SeferCikisZamani AS DATE) = '2012-09-25'\nORDER BY Kalkis\n</code></pre>\n\n<p>This query returns this result:</p>\n\n<pre><code>Kalkis  Donus   AracPlaka\n-------------------------\n01:51   02:01   07 ABY 04\n02:02   02:12   07 AB 978\n02:21   02:31   07 ABY 04\n02:32   02:42   07 AB 978\n03:01   03:11   07 ABY 04\n03:02   03:12   07 AB 978\n03:31   03:41   07 ABY 04\n03:42   03:52   07 AB 978\n04:01   04:11   07 ABY 04\n</code></pre>\n\n<p>However, In my report they are supposed to look like this,</p>\n\n<pre><code>        07 ABY 04   07 AB 978\nKalkis  06:15       06:30\nDonus   07:45       08:00\nKalkis  08:00       08:10\nDonus   09:30       09:40\nKalkis  10:00       10:15\nDonus   11:30       11:45\nKalkis  12:30       12:45\nDonus   14:00       14:15\n</code></pre>\n\n<p>By the way, these are like bus schedules.\nAnyone know a good way to achieve this?</p>\n"},{"tags":["asp.net","query","tsql","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12652186,"title":"Count the first row data in SSRS / SQL Query","body":"<p>In my SSRS report, there is a matrix showing following data... Every single of data in the matrix is dynamic.</p>\n\n<pre><code>Departure    Arravial     Bus name        Tour\n01:51        02:01        07 ABY 04\n02:02        02:12        07 AB 978\n02:21        02:31        07 ABY 04\n02:32        02:42        07 AB 978\n03:01        03:11        07 ABY 04\n03:02        03:12        07 AB 978\n03:31        03:41        07 ABY 04\n03:42        03:52        07 AB 978\n04:01        04:11        07 ABY 04\n</code></pre>\n\n<p>What I want to do is count the first row bus name and put it next to it. Can this be achievable with expressions? or how can I come up with such query in SQL? How can I solve this puzzle?</p>\n\n<pre><code>Departure    Arravial     Bus name        Tour\n01:51        02:01        07 ABY 04       1\n02:02        02:12        07 AB 978       \n02:21        02:31        07 ABY 04       2\n02:32        02:42        07 AB 978       \n03:01        03:11        07 ABY 04       3\n03:02        03:12        07 AB 978       \n03:31        03:41        07 ABY 04       4\n03:42        03:52        07 AB 978       \n04:01        04:11        07 ABY 04       5\n</code></pre>\n\n<p>This is my query by the way,</p>\n\n<pre><code>SELECT HCPD.DepartureTime, HCPD.ArrivalTime, V.BusName\nFROM HAT_CALISMA_PLANI HCP WITH(NOLOCK)\nINNER JOIN HAT_CALISMA_PLANI_DETAY HCPD WITH(NOLOCK) ON HCPD.HatCalismaPlaniKey = HCP.HatCalismaPlaniKey\nINNER JOIN VALIDATOR V WITH(NOLOCK) ON V.ValidatorKey = HCPD.ValidatorKey\nWHERE HCPD.DepartureTime = @Time AND HCP.HatKey = @HatKey\nORDER BY HCPD.DepartureTime\n</code></pre>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12652444,"title":"MySql Query to Change a lower case to upper case","body":"<p>I want to change all lower cases in a string to upper cases using MySql Query</p>\n"},{"tags":["php","mysql","sql","query","phpmyadmin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12652434,"title":"MySQL - Adding row total across multiple columns","body":"<p>I have a MySQL table with about 100 columns. All columns are INT. I want to be able to select a row by its ID, and get the total number of all of the columns added together.</p>\n\n<p>There are two additional considerations. The field titles vary significantly, so I would like to be able to have it work by referencing the field number, rather than the field title.</p>\n\n<p>Lastly, I would like to potentially be able to specify a range, for example, add total of field 35 through field 76 where id = 50.</p>\n\n<p>Is there a way to do this? Thank you very much!</p>\n"},{"tags":["mysql","query","dateformat"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":12652370,"title":"Changing dateformat of a column and creating a new column based on other column","body":"<p>I have a column \"date\" and its format (Y-m-d -time). I need to create a new column using a SQL query and it will be the same with \"date\" column but it's format will be (Y-m-d) only not with hours etc.</p>\n\n<p>And I want to group them with GROUP BY. How can I write this query? I have to create a temporary column to see them grouped.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":12652234,"title":"Sql Query to remove special Characters","body":"<p>I am having a <code>varchar</code> field in mysql table with special characters. I want to remove all those special characters in that string Using MYSQL QUERY.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":94,"score":-4,"question_id":5712673,"title":"query in mysql with range","body":"<p>. Write a single SQL query to determine the count of people in the following salary ranges \nless than 1,00,000\n(equal to or greater than 1,00,000) and less than 5,00,000\ngreater than or equal to 5,00,000</p>\n"},{"tags":["ruby-on-rails","query","activerecord","associations"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12645363,"title":"Simplify Rails Query","body":"<p>I'm trying to reduce the number of queries in my application and need some help with the following setup:</p>\n\n<p>I have 5 models:</p>\n\n<ul>\n<li>Bet</li>\n<li>Choice</li>\n<li>Spotprice</li>\n<li>Spotarea</li>\n<li>Product</li>\n</ul>\n\n<p>They are associated with the following:</p>\n\n<ul>\n<li>Bet belongs_to Choice</li>\n<li>Choice belongs_to Spotarea</li>\n<li>Choice belongs_to Product</li>\n<li>Choice has_many Bets</li>\n<li>Spotprice belongs_to Spotarea</li>\n<li>Spotprice belongs_to Product</li>\n<li>Spotarea has_many Spotprices</li>\n<li>Spotarea has_many Choices</li>\n<li>Product has_many Sprotprices</li>\n<li>Product has_many Choices</li>\n</ul>\n\n<p>My goal is to find the Spotprices that matches a Specific Bet. To do that I uses the following queries, but I'm sure it can be done in a better way, so when I run through 100 bets and want to see if they are above or below the corrosponding Spotprice I don't overload the DB with queries.</p>\n\n<pre><code>a = Bet.find(5)\n\nb = Choice.find(a.choice_id)\n\nc = Spotprice.where(:spotarea_id =&gt; b.spotarea_id, :product_id =&gt; b.product_id, \n    :deliverydate =&gt; b.deliverydate).first\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","query","join","sql-update"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":12650575,"title":"Update column based on matching values in other table in mysql","body":"<p>I have two tables calendar and customer table. Calendar table have a \"customer\" column which has customer table \"ID\" as value. But unfortunately, this calendar customer field value was wrongly populated with other values. Both tables have these common fields Date, SeatingID and BusID. How to update the calendar table customer field based on these common fields?.</p>\n\n<p>Below is the structure of both tables.</p>\n\n<p>Customer Table\n<img src=\"http://i.stack.imgur.com/jYYFZ.jpg\" alt=\"enter image description here\"></p>\n\n<p>calendar Table</p>\n\n<p><img src=\"http://i.stack.imgur.com/ODB8F.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["query","boost","solr","tokenize","term"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12650530,"title":"solr : how to boost query term after tokenizer","body":"<p>If the query word is \"ABCD\", then after being tokenized it is \"A\" \"BC\" \"D\". I want to boost term \"BC\", so the query word is like this:</p>\n\n<pre>A BC^10 D\" and phrase query \"ABCD\"</pre>\n\n<p>All query words users typing in will be processed like that automaticly so that important query terms will be boosted.</p>\n\n<p>I guess I can custom a new Tokenizer to do it, but I don't know if it is feasible, or is there some other methods simpler.</p>\n"},{"tags":["string","query","isapi","isapi-rewrite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12611274,"title":"isapi 3 - strip all query strings from domain and subpages","body":"<p>I would like to know how to strip out all query strings, i.e. </p>\n\n<pre><code>domain.com/?a=123 --&gt;&gt; domain.com\n</code></pre>\n\n<p>And</p>\n\n<pre><code>domain.com/page.asp?b=456 --&gt;&gt; domain.com/page.asp\n</code></pre>\n"},{"tags":["mysql","string","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":11624972,"title":"MySQL find last digit in colums using string function","body":"<p>I have to list all the details of a table where the colums event_id and horse_id end in a \"1\". I have achieved this by doing the following:</p>\n\n<pre><code>SELECT * FROM event \nWHERE event_id AND show_id LIKE '%1'\n</code></pre>\n\n<p>However the question specifies the use of a string function. The only string i can find that would be useful in this case is RIGHT(). I can't get this to perform as i wish though.</p>\n\n<pre><code>SELECT * FROM event\nWHERE RIGHT('1',1) \n</code></pre>\n\n<p>Displays all columns that end in a one. However i need to limit the search to event_id and horse_id.</p>\n\n<pre><code>SELECT * FROM event\nWHERE event_id AND show_id RIGHT('1',1) \n</code></pre>\n\n<p>Doesn't work. The \"right\" string is invalid.</p>\n\n<p>Any help appreciated.</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12641772,"title":"Native SQL , generic duplicate entries retrieval","body":"<p>I have a table T with fields <code>f1</code> , <code>f2</code> and <code>f3</code>.</p>\n\n<p>I would like to retrieve every <code>f1</code> which belongs to the row with duplicate <code>f2</code> and <code>f3</code> fields. How can this be done ?</p>\n\n<p>Edit : </p>\n\n<p>Such as for : </p>\n\n<pre><code>(1,2,3) \n(2,2,3) \n(4,1,1) \n(2,2,2) \n(3,4,3) \n(1,5,6)\n</code></pre>\n\n<p>Expected result being : </p>\n\n<pre><code>(1)\n(2)\n</code></pre>\n"},{"tags":["php","mysql","string","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12505446,"title":"Convert String into MySQL Query","body":"<p>I have this string in PHP:</p>\n\n<pre><code>$str = 1,3,6,5 \n</code></pre>\n\n<p>These numbers can change and the length of the set can change to more or less than four. I want to convert to a MySQL query like this in PHP:</p>\n\n<pre><code>$qry = mysql_query(\"SELECT * FROM tbl WHERE id = 1 or id = 3 or id = 6 or id = 5\")\n</code></pre>\n\n<p>It should be easy, but I don't know how to do it.</p>\n\n<p>I will be grateful for any help.</p>\n"},{"tags":["mysql","perl","query","magento"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12650094,"title":"Magento Unknown table 'REFERENTIAL_CONSTRAINTS' in information_schema","body":"<p>I have trying to debug an issue with our new Magento PIM scripts and in the PIM script logs I have noticed this error:</p>\n\n<blockquote>\n  <p>Unknown table 'REFERENTIAL_CONSTRAINTS' in information_schema</p>\n</blockquote>\n\n<p>Looking in the script that is having issue (mysql-quick-import.pl) it seems to be hanging on this query:</p>\n\n<pre><code>SELECT CONCAT(\"ALTER TABLE \", table_name, \" DROP FOREIGN KEY \", constraint_name, \";\" ) drop_command,\n     CONCAT(\"ALTER TABLE \", table_name, \" ADD CONSTRAINT FOREIGN KEY \", constraint_name, \" (\", column_name, \") \", \" REFERENCES \", REPLACE(referenced_table_name,'_old','') , \" (\", referenced_column_name, \") ON DELETE \", delete_rule, \" ON UPDATE \", update_rule, \";\" ) add_command\n     FROM (SELECT kcu.constraint_name, kcu.table_name, kcu.column_name, kcu.referenced_table_name, kcu.referenced_column_name, rc.update_rule, rc.delete_rule \n         FROM information_schema.KEY_COLUMN_USAGE kcu \n         INNER JOIN information_schema.REFERENTIAL_CONSTRAINTS rc \n         ON kcu.constraint_name = rc.constraint_name \n         WHERE kcu.referenced_table_name = 'atb_colors'\n         AND rc.constraint_schema='web1') stuff;\n</code></pre>\n\n<p>The exact error I'm seeing in the mysql-quick-import.pl Perl script:</p>\n\n<pre><code>Dropping indexes for atb_department_category_old\nDBD::mysql::st execute failed: Unknown table 'REFERENTIAL_CONSTRAINTS' in information_schema at /var/import/util/mysql-quick-import.pl line 197.\nDBD::mysql::st bind_columns failed: Statement has no result columns to bind (perhaps you need to successfully call execute first) at /var/import/util/mysql-quick-import.pl line 198.\nDBD::mysql::st fetch failed: fetch() without execute() at /var/import/util/mysql-quick-import.pl line 199.\n</code></pre>\n\n<p>The main purpose of this script from reviewing the code is that it will quickly import or clone a database. These PIM scripts import our product data and have notice after our initial import all our Magento Product Detail Pages we are seeing this error:</p>\n\n<pre><code>SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`web1/enterprise_targetrule_index`, CONSTRAINT `enterprise_targetrule_index_ibfk_1` FOREIGN KEY\n</code></pre>\n\n<p>I believe the error that I am seeing in Magento is related to the PIM Perl script that imports our product data. Can someone clarify or simplify what may be happening in the query that is causing issues. Where should I look? How would you proceed in looking to solve this issue? </p>\n\n<p>Any advice greatly appreciate. </p>\n"},{"tags":["php","html","mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":12649441,"title":"Query spitting out variable with extra values appended to it. Why?","body":"<pre><code>$currentFile = $_SERVER[\"SCRIPT_NAME\"];\n$img = array_pop(explode(\"/\", $currentFile));\n$fileName = basename($img, \".php\").PHP_EOL;\necho $fileName;\n</code></pre>\n\n<p><strong>Echo'd results:</strong>\n    placementName</p>\n\n<pre><code>$query = \"SELECT * FROM image_Name WHERE name = '\" . mysql_real_escape_string($fileName) . \"' LIMIT 1;\";\necho $query;\n</code></pre>\n\n<p><strong>Echo'd results:</strong>\n    SELECT * FROM image_name WHERE name = 'placementName\\r\\n' LIMIT 1;</p>\n\n<p>I'm trying to get a dynamic page to change its values in tables depending on what currentFile.php is open. Hence the script at the top. Script finds the fileName by chopping off the location and the ext and leaves the actual basename. Then the query looks for that basename in my database table, saves that data into an array which I want to be able to call for it to put it into a html table.</p>\n\n<p>The problem right now is, my query for some reason has extra values appended to placementName \"\\r\\n\"</p>\n\n<p>why is this ?</p>\n"},{"tags":["php","html","mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12648683,"title":"Need input on a dynamic query output script","body":"<p>I have a homepage that has a bunch of images as links to other pages that has info about that image. </p>\n\n<pre><code>Image Name: $varExampleNAME\nDamage: $varExampleDMG\nHealth: $varExampleHP\nMana: $varExampleMP\n</code></pre>\n\n<p>So the only info that will change on this page will be the variables.\nWhat I want is to run one query script so that depending on the $fileName of the $currentPage\nit grabs that row from the table if the $fileName matches a certain row name.</p>\n\n<p>This is the script to find out what my fileName is:</p>\n\n<pre><code>//include database connection file\ninclude_once 'connect_to_db.php';\n\n$currentFile = $_SERVER[\"SCRIPT_NAME\"];\n$img = array_pop(explode(\"/\", $currentFile));\n$fileName$ = basename($img, \".php\").PHP_EOL;\n</code></pre>\n\n<p>I'm having problems with the actual query script. Can anyone shed some light on how this will be done?</p>\n\n<p>My table name is image_Name</p>\n\n<p>Columns include id, name, damage, health, mana.</p>\n"},{"tags":["mysql","query","order"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12648661,"title":"MySQL ORDER BY order","body":"<p>Very short question:</p>\n\n<p>In MySQL, is there a difference between </p>\n\n<pre><code>SELECT * FROM .... ORDER BY Created,Id DESC \n</code></pre>\n\n<p>and</p>\n\n<pre><code>SELECT * FROM .... ORDER BY Created DESC, Id DESC\n</code></pre>\n\n<p>?</p>\n\n<p>Desired behaviour: order (descending ) by \"Created\" ( a timestamp) but when two items have the same \"Created\" value then fall back to ordering ( desc ) using the Id.</p>\n\n<p>Cheers!</p>\n"},{"tags":["sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":12645795,"title":"Concatenate bigint values in SQL Server","body":"<p>I have a table with 3 columns:</p>\n\n<ul>\n<li><code>PersonId uniqueidentifier</code> -- key</li>\n<li><code>DeviceId uniqueidentifier</code> -- key</li>\n<li><code>Counter bigint</code></li>\n</ul>\n\n<p>The <code>counter</code> comes in ascending value but sometimes has gaps. An example of the counter values is <code>(1,2,3,1000,10000,10001,10002,...)</code>. The counter value is saved one at a time. If I insert one row per counter value, the table gets big very fast. I must keep the last 1000 counter values and can delete early values.</p>\n\n<p>Is it possible to concatenate the counter values into 1 or a few rows in a <code>varbinary(8000)</code> type, and remove early values at the beginning of the binary as part of the insert operation? I would like help in writing this query. I prefer not to use <code>varchar</code> because each character would take up 2 bytes. There may be better way than I can envision. Any help is appreciated!</p>\n"},{"tags":["facebook","api","query","facebook-graph-api"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":467,"score":3,"question_id":4703965,"title":"facebook graph api friends_religion_politics permission problems","body":"<p>I'm working with facebook graph's api trying to get the users religion and political field.  I have the friends_religion_politics permission set and signed in but when I test the application on my account I only get one of my friends religion and political fields.</p>\n\n<p>The general inquiry I'm making is:\n<a href=\"https://graph.facebook.com/me/friends?access_token=%3Ctoken%3E&amp;fields=religion,political\" rel=\"nofollow\">https://graph.facebook.com/me/friends?access_token=%3Ctoken%3E&amp;fields=religion,political</a></p>\n\n<p>Confusingly enough when I run just that I get 4 friends religion and political views but still far from all of theres.</p>\n\n<p>Am I doing something wrong on the permissions or is it something like the default privacy settings doesn't give apps acess to those fields?</p>\n"},{"tags":["linq-to-sql","query","nullreferenceexception","contains"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":711,"score":1,"question_id":5757364,"title":"LINQ to SQL Contains Query on multiple columns","body":"<p>How do I search multiple columns using LINQ to SQL when any one of the column could be null? </p>\n\n<pre><code>IEnumerable&lt;User&gt; users = from user in databaseUsers\n        where\n             user.ScreenName.Contains(search)\n             || user.FirstName.Contains(search)\n             || user.LastName.Contains(search)\n        select user;\n</code></pre>\n\n<p>I keep getting this exception:</p>\n\n<blockquote>\n  <p>Object reference not set to an\n  instance of an object. </p>\n  \n  <p>Description: An\n  unhandled exception occurred during\n  the execution of the current web\n  request. Please review the stack trace\n  for more information about the error\n  and where  it originated in the code.</p>\n  \n  <p>Exception Details:\n  System.NullReferenceException: Object\n  reference not set to an  instance of\n  an object.</p>\n</blockquote>\n"},{"tags":["database","visual-studio-2010","visual-studio","query","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12647238,"title":"Check values of two tables?","body":"<p>I'm building an application for a University assignment, I'm using Visual Basic 2010 and Micrsoft Access for the database.</p>\n\n<p>I have a form where customers can order products each product will have a set price, for example product1 is £1, however some customers will get products for cheaper so I have a table 'special prices' the special price table will contain rows including the 'customerid' 'productid' and the 'specialprice'.</p>\n\n<p>I need to know how to display the price, if a customer chooses product1 I need my application to first check if they have a special price and if not just display the normal price,</p>\n\n<p>Thanks,</p>\n\n<p>Jack.</p>\n"},{"tags":["mysql","sql","query","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":112,"score":-3,"question_id":12646957,"title":"MySQL giving two different results at the same time for the same query","body":"<p>Whenever I do this query, for some reason <a href=\"http://www.mysql.com/\" rel=\"nofollow\">MySQL</a> returns an unexpected result (unexpected for me at least).</p>\n\n<pre><code>SELECT a.id\n     , (   a.last_response_time &lt; NOW() - INTERVAL 6 HOUR\n        OR a.number_of_responses &gt; 1000 \n        OR b.time &lt; NOW() - INTERVAL 12 HOUR)\nFROM thread AS a\nINNER JOIN activity AS b ON b.effective_id = a.id\nWHERE a.status = 'alive'\n</code></pre>\n\n<p>And this is the result:</p>\n\n<pre><code>id  (a.last_response_time &lt; NOW() - INTERVAL 6 HOUR OR a.number_of_responses &gt; 1000 OR b.time &lt; NOW() - INTERVAL 12 HOUR)\n5   1\n5   0\n6   1\n6   0\n</code></pre>\n\n<p>I know that in this case, the result should be <strong><code>false</code></strong> in both cases (for the <code>id</code> 5 and the <code>id</code> 6), but it's returning two different values each of the <code>id</code>'s? But I don't know what's going on here.\nBesides, I tried using the <code>DISTINCT</code> operator but it doesn't change the result.</p>\n"},{"tags":["php","mysql","sql","query","select"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12645358,"title":"select rows as well as a total count in one query in mysql","body":"<p>suppose I have a table t and table t has 15000 entries</p>\n\n<p>suppose the query </p>\n\n<pre><code>SELECT * FROM t WHERE t.nid &lt;1000\n</code></pre>\n\n<p>returns 1000 rows</p>\n\n<p>but then I only want the first 10 rows so I do a LIMIT</p>\n\n<pre><code>SELECT * FROM t WHERE t.nid &lt;1000 LIMIT 10\n</code></pre>\n\n<p>is it possible to construct a single query in which in addition to returning the 10 rows information with the LIMIT clause above, it also returns the total count of the rows that satisfy the conditions set in the WHERE clause, hence in addition to returning the 10 rows above, it also returns 1000 since there are a total of 1000 rows satisfying the WHERE clause...and have both returned in a single query </p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12631676,"title":"SQL Server: Selecting the next consecutive date in a partitioned group","body":"<p>This one is really stumping me, and I would greatly appreciate any help from you guys.  I have a pretty complex query in SQL Server 2005 that leaves me with the result set below.  In order to get the RSAssignmentRank field, I'm using </p>\n\n<pre><code>ROW_NUMBER() OVER\n    (PARTITION BY CHECKSUM(BR_ProviderID, PA_AssignmentType, BR_AddressID, BR_AddressTypeID)\n    ORDER BY \n    PA_RSAssignmentOrder ASC,\n    EffectiveDate ASC,\n    TerminationDate DESC,\n    PA_ReimbursementScheduleID ASC\n) AS RSAssignmentRank\n</code></pre>\n\n<p>This leaves me with a result set that is ordered exactly how I want it.  However, due to the way joins are done to generate this result set, there are some extra records in there I don't need.  So, here's a sample of the result set, note that RSAssignmentRank is a consecutive number, however I trimmed out from the result set to make this easier to read and because the deleted rows don't fit the criteria I'm using.</p>\n\n<pre><code>RowID   BR_ProviderID   PA_ReimbursementScheduleID  PA_AssignmentType   BR_AddressID    BR_AddressTypeID    PA_RSAssignmentOrder    BR_AddressTerminationDate   EffectiveDate   TerminationDate RSAssignmentRank\n7   D13Z0K6UHH  AJW Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   4/15/2004   12/31/2009  1\n10  D13Z0K6UHH  AJW Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   4/15/2004   12/31/2009  2\n12  D13Z0K6UHH  AJW Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   4/15/2004   12/31/2009  3\n14  D13Z0K6UHH  AJW Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   4/15/2004   12/31/2009  4\n268 D13Z0K6UHH  AJW Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   6/1/2007    12/31/2009  37\n311 D13Z0K6UHH  H15 Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   1/1/2010    7/31/2010   38\n343 D13Z0K6UHH  H15 Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   1/1/2010    7/31/2010   39\n421 D13Z0K6UHH  H15 Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   1/1/2010    7/31/2010   60\n653 D13Z0K6UHH  CZO Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   8/1/2010    3/14/2011   61\n655 D13Z0K6UHH  CZO Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   8/1/2010    3/14/2011   62\n730 D13Z0K6UHH  CZO Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   8/1/2010    3/14/2011   81\n732 D13Z0K6UHH  CZO Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   8/1/2010    3/14/2011   82\n763 D13Z0K6UHH  CZO Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   8/1/2010    3/14/2011   83\n775 D2V50Z1NT5  C11 Standard    D2V50UH142  _REI0PVM65  1   1/1/2500    12/28/2009  12/31/2010  1\n784 D2V50Z1NT5  C11 Standard    D2V50UH142  _REI0PVM65  2   1/1/2500    1/1/2011    5/17/2011   2\n790 D2V50Z1NT5  F11 Standard    D2V50UH142  _REI0PVM65  2   1/1/2500    5/18/2011   9/25/2012   3\n794 D2V50Z1NT5  C11 Standard    D2V50UH142  _REI0PVM65  2   1/1/2500    9/26/2012   1/1/2500    4\n</code></pre>\n\n<p>Now my goal: Select the row ranked 1, I want that for sure.  I can put it aside in a temp table and loop through the same result set to find the next valid row if need be.</p>\n\n<p>The next valid row is determined by by taking the TerminationDate of the last valid row and adding 1 day to it.  The first row within the partioned group that has an EffectiveDate of last selected row's TerminationDate + 1 is the row I want.</p>\n\n<p>I should note that 1/1/2500 is a date we use to specificy never ending.  I know when I have completed gathing all of the rows I need within each partition when the last row I selected has a TerminationDate = BR_AddressTerminationDate.</p>\n\n<p>I would sincerely apprecaite any assistance, I've been working on this for days.  Thank you everyone.</p>\n\n<p>If all goes well, I would end up with this result set:</p>\n\n<pre><code>RowID   BR_ProviderID   PA_ReimbursementScheduleID  PA_AssignmentType   BR_AddressID    BR_AddressTypeID    PA_RSAssignmentOrder    BR_AddressTerminationDate   EffectiveDate   TerminationDate RSAssignmentRank\n7   D13Z0K6UHH  AJW Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   4/15/2004   12/31/2009  1\n311 D13Z0K6UHH  H15 Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   1/1/2010    7/31/2010   38\n653 D13Z0K6UHH  CZO Standard    D1O90UXIBK  _REI0PVM65  2   3/14/2011   8/1/2010    3/14/2011   61\n775 D2V50Z1NT5  C11 Standard    D2V50UH142  _REI0PVM65  1   1/1/2500    12/28/2009  12/31/2010  1\n784 D2V50Z1NT5  C11 Standard    D2V50UH142  _REI0PVM65  2   1/1/2500    1/1/2011    5/17/2011   2\n790 D2V50Z1NT5  F11 Standard    D2V50UH142  _REI0PVM65  2   1/1/2500    5/18/2011   9/25/2012   3\n794 D2V50Z1NT5  C11 Standard    D2V50UH142  _REI0PVM65  2   1/1/2500    9/26/2012   1/1/2500    4\n</code></pre>\n\n<p><strong>EDIT</strong>\nI think the code below would work perfectly, if only you were allowed to use the TOP operator in the recursive portion of the CTE.</p>\n\n<pre><code>WITH\n    cteRSFinder (\n        RowID,\n        BR_ProviderID,\n        PA_ReimbursementScheduleID,\n        PA_AssignmentType,\n        BR_AddressID,\n        BR_AddressTypeID,\n        PA_AddressID,\n        PA_RSAssignmentOrder,\n        PA_AddressTypeID,\n        BR_AddressTerminationDate,\n        EffectiveDate,\n        TerminationDate,\n        RSAssignmentRank\n    )\nAS (\n    SELECT\n        RowID,\n        BR_ProviderID,\n        PA_ReimbursementScheduleID,\n        PA_AssignmentType,\n        BR_AddressID,\n        BR_AddressTypeID,\n        PA_AddressID,\n        PA_RSAssignmentOrder,\n        PA_AddressTypeID,\n        BR_AddressTerminationDate,\n        EffectiveDate,\n        TerminationDate,\n        @RSAssignmentRank\n\n    FROM\n        #TempAllPossibleRSAssignments taprsa\n\n    WHERE\n        RSAssignmentRank = 1\n\n    UNION ALL\n\n        SELECT TOP 1\n            taprsa.RowID,\n            taprsa.BR_ProviderID,\n            taprsa.PA_ReimbursementScheduleID,\n            taprsa.PA_AssignmentType,\n            taprsa.BR_AddressID,\n            taprsa.BR_AddressTypeID,\n            taprsa.PA_AddressID,\n            taprsa.PA_RSAssignmentOrder,\n            taprsa.PA_AddressTypeID,\n            taprsa.BR_AddressTerminationDate,\n            taprsa.EffectiveDate,\n            taprsa.TerminationDate,\n            taprsa.RSAssignmentRank\n\n        FROM\n            #TempAllPossibleRSAssignments taprsa\n\n        INNER JOIN cteRSFinder cteLoop\n            ON\n            taprsa.BR_ProviderID        =   cteLoop.BR_ProviderID       AND\n            taprsa.PA_AssignmentType    =   cteLoop.PA_AssignmentType   AND\n            taprsa.BR_AddressID         =   cteLoop.BR_AddressID        AND\n            taprsa.BR_AddressTypeID     =   cteLoop.BR_AddressTypeID\n\n        WHERE\n            taprsa.EffectiveDate = DateAdd( dd, 1, cteLoop.TerminationDate )\n            AND taprsa.RSAssignmentRank &gt; cteLoop.RSAssignmentRank\n)\n\nINSERT INTO #TempFinalRSAssignments\n    SELECT DISTINCT\n        cteRSFinder.BR_ProviderID               AS ProviderID,\n        cteRSFinder.PA_ReimbursementScheduleID  AS ReimbursementScheduleID,\n        cteRSFinder.PA_AssignmentType           AS AssignmentType,\n        cteRSFinder.BR_AddressID                AS AddressID,\n        cteRSFinder.BR_AddressTypeID            AS AddressTypeID,\n        cteRSFinder.EffectiveDate,\n        cteRSFinder.TerminationDate,\n        GetDate()                               AS MaintenanceDate,\n        0                                       AS RuleID,\n        cteRSFinder.BR_AddressTerminationDate,\n        cteRSFinder.RSAssignmentRank\n\n    FROM\n        cteRSFinder \n</code></pre>\n"},{"tags":["python","django","query","append","combine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12643460,"title":"Combine two Django queries in a certain order","body":"<p>I have two django queries in my view. They are as follows:</p>\n\n<pre><code>news = News.objects.all()[:8]\nposts = Post.objects.all()[:3]\n</code></pre>\n\n<p>I need to combine these two queries together in the following order:</p>\n\n<pre><code>[news, post, news, news, news, post, news, post, news, news, news]\n</code></pre>\n\n<p>I am pretty sure that I would have to use <code>lambda</code> or do some sort of <code>count</code>, but I am a little lost at this point. Should I just be using <code>count</code> and <code>append</code>?</p>\n"},{"tags":["sql","database","query","stored-procedures","statement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12641945,"title":"Insert stored procedure passing parameter","body":"<p>I have this SQL statement</p>\n\n<pre><code>INSERT housingSurvey ([nameID], [houseID], [jobID], [Active], [comment], [needsMaintenance], [lastUpdateDate) \nVALUES (@NAMEID, @HOUSEID, @JOBID, 1, @DUEDATE, @COMMENT, NULL, @LASTUPDATEDATE)\n</code></pre>\n\n<p>I tried this stored procedure, but I don't get the current date.</p>\n\n<pre><code>CREATE PROCEDURE housingSurveyS(\n                    @NAMEID INT,\n                    @HOUSEID INT,\n                    @JOBID INT, \n                    @COMMENT BIT,\n                    @DUEDATE NVARCHAR,\n                    CURRENTTIME)\nAS\nBEGIN\nINSERT INTO housingSurvey(\n    [nameID],\n    [houseID],\n    [jobID],\n    [Active],\n    [comment],\n    [dueDate],\n    [needsMaintenance],\n    [lastupdatedate])\nVALUES (\n    @NAMEID,\n    @HOUSEID,\n    @JOBID,\n    1,\n    @COMMENT,\n    @DUEDATE,\n    NULL,\n    @LASTUPDATEDATE)\nEND\n</code></pre>\n\n<p>Could you please take a look at what I did wrong. Thanks</p>\n\n<p><strong>UPDATE</strong>\nI changed it CURRENTTIME to DATETIME as parameter to insert current date to [lastupdatedate]... it still doesn't work...</p>\n"},{"tags":["sql","database","query","ms-access","asp-classic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12642969,"title":"SQL Statement- Sort by Another Table","body":"<p>I am trying to build a SQL statement which pulls records from a table but sorts them by another table.\nMain - is my Main Products Table\nMainCategory - is the Categorys of products</p>\n\n<p>Each product can be in multiple categories - so in Main I have a field called CategoryIds which containts the ID's of all the categories that product belongs to. (I know now that is the wrong way to do it)</p>\n\n<p>Tables Layout: </p>\n\n<p><img src=\"http://i.stack.imgur.com/gGfoo.gif\" alt=\"enter image description here\"></p>\n\n<p>So basically when I click on a Category, e.g. Brands I want to be able to sort the products in each category to display in the order I want - so thats why I have created the table CatSort\nI can put the CategoryId in there with the ProductId and DisOrder is the way they are displayed.</p>\n\n<p>So on my page the SQL statement:</p>\n\n<pre><code>Select * \nFrom Main  \nWhere CategoryIds = '11' OR \n      CategoryIds LIKE '11,%' OR \n      CategoryIds LIKE '%, 11,%' OR \n      CategoryIds LIKE '%, 11'\n</code></pre>\n\n<p>pulls all the products in the Category 'Brand' but how do I extend that SQL statement to sort them by CatSort, bearing in mind that not all the records in that Category will be in CatSort \n(or would it be better if they were? they only get added to CatSort when they actually sort them to order they prefer. But if a new product is added to that Category, it doesn't automatically get added to CatSort.) </p>\n"},{"tags":["query","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":3332,"score":4,"question_id":2997458,"title":"how to show only even or odd rows in sql server 2008?","body":"<p>i have a table MEN in sql server 2008 that contain 150 rows.</p>\n\n<p>how i can show only the even or only the odd rows ?</p>\n\n<p>thank's in advance</p>\n"},{"tags":["wordpress","query","wordpress-theming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12641687,"title":"Why is max_num_pages empty?","body":"<p>When doing something like:</p>\n\n<pre><code>global $wp_query;\n$total_pages = $wp_query-&gt;max_num_pages;\nvar_dump($total_pages); exit;\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>int(0)\n</code></pre>\n\n<p>when there are like 15, 16 posts. so it should go 1 -> 16</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12640816,"title":"SQL query efficiency","body":"<p>I have an working query and not sure if its efficient or not.</p>\n\n<p>Table columns: </p>\n\n<ol>\n<li>p_type: can be STRING sell, cancelsell, bank, cancelbank  </li>\n<li>id</li>\n<li>fid</li>\n<li>unit</li>\n</ol>\n\n<p>Operation to be performed: </p>\n\n<ol>\n<li>SUM(unit) for each process type sell,cancelsell,bank,cancelbank.</li>\n<li>SUM(UNIT for sell) - SUM(unit for cancelsell) , SUM(unit for bank) - SUM(unit for cancelbank) </li>\n</ol>\n\n<p>NOTE: I am also checking for id and fid in each select though I need to check with same values for all select.</p>\n\n<p>The existing query:</p>\n\n<pre><code>    select sell-cancelsell scount, bank-cancelbank bcount from\n\n    (select sum(a.unit) as sell from table1 a where   \n    a.p_type = 'Sell' and a.id=1 and a.fid=2 ),\n\n    (select sum(c.unit) as cancelsell from table1  c where      \n    c.p_type = 'CancelSell' and c.id=1 and c.fid=2),\n\n    (select sum(b.unit) as bank from table1  b where     \n    b.p_type = 'Bank' and b.id=1 and b.fid=2),\n\n    (select sum(d.unit) as cancelbank from table1  d where  \n    d.p_type = 'CancelBank' and d.id=1 and d.fid=2)\n</code></pre>\n\n<p>Is good enough? If anyone can suggest a way to make it more efficient that would be great.</p>\n"},{"tags":["mysql","sql","query","date","timespan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12638028,"title":"MySQL: Combine chunks of timespan with SQL","body":"<p>I have a table with timespan chunks. <br>\nA timespan has a start date and a length in days</p>\n\n<ol>\n<li><p>There are timespans in the table that do not overlap, e.g.:<br>\n2012-01-01 + 5 days  and  2012-05-01 + 3 days</p></li>\n<li><p>And there are timespans that overlap, e.g.:<br>\n2012-01-01 + 5 days  and  2012-01-03 + 3 days</p></li>\n<li><p>However, I am mostly interested in those occurring in a row, e.g.:<br>\n2012-01-01 + 5 days  and  2012-01-06 + 3 days  and  2012-01-09 + 13 days</p></li>\n</ol>\n\n<p>I need a query that selects 1. and 2. normally (each entry as a single row).<br>\nCase 3. must be selected combined as a single row, e.g.<br>\n<strong>2012-01-01 + 5</strong> days  and  2012-01-06 + <strong>3</strong> days = <strong>2012-01-01 + 8</strong> days<br>\n<strong>2012-01-01 + 5 days</strong>  and  2012-01-06 + <strong>3</strong> days  and  2012-01-09 + <strong>13</strong> days = <strong>2012-01-01 + 21 days</strong></p>\n\n<p>Here is an example DB:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `chunks` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`start` date NOT NULL,\n`length` smallint(4) unsigned NOT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=MyISAM ;\n\n\nINSERT INTO `chunks` (`id`, `start`, `length`) VALUES\n(1, '2012-01-01', 5),\n(2, '2012-05-01', 3),\n(3, '2012-01-03', 3),\n(4, '2012-01-06', 3),\n(5, '2012-01-09', 13);\n</code></pre>\n\n<p>Is this possible with MySQL? Or is it better done with Java later on?</p>\n"},{"tags":["sql","query","stackexchange"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":12628749,"title":"SQL query - invalid column name and parameter - data.SE","body":"<p>Not a programmer but using data.stackexchange.com. I'm querying the public SE data explorer and the column names that I'm specifying are invalid. Also, how do I specify Count (Posts) and Count (Votes)?\nIs anyone who queried data.se and knows the db schema able to help me correct this code?</p>\n\n<pre><code>Select Count (u.Id)\nFrom Users u \nLeft Join Posts p on u.Id = p.OwnerUserId\nLeft join SuggestedEdits e on u.Id = e.OwnerUserId\nleft join Votes v on u.Id = v.UserId\nWHERE ((u.CreationDate BETWEEN 'qwerty' AND 'qwerty')\nAND (p.CreationDate BETWEEN 'qwerty' AND 'qwerty')\nAND (p.ClosedDate is null)\nOR (e.CreationDate BETWEEN 'qwerty' AND 'qwerty'))\nAND Count (Posts) = x\nOR Count (Votes) = y\nGroup by u.CreationDate, p.OwnerUserId, UserTypeId, u.DisplayName, p.CreationDate\n</code></pre>\n"},{"tags":["php","mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12640407,"title":"Working on a simple CMS - how to handle what access which user has?","body":"<p>I'm working on a personal CMS and I've got a problem. I wanted to define access levels such as CAN_DELETE_THREAD, CAN_EDIT_MESSAGE or CAN_CREATE_THREAD as binary flags, but I don't know how a function 'has_flag' would work. For example, if I took a user from the db and wanted to check if he can edit messages, how would I go around doing that?</p>\n\n<p>Thanks!</p>\n"},{"tags":["query","fixed","asset"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12640023,"title":"Depreciation Calculations","body":"<p>I am using Java to designing an application that would calculate the total value of depreciation applicable for a Year. For that I have created the following tables (along with the sample data) in the database :</p>\n\n<p><strong>Sample Data Considerations :</strong></p>\n\n<pre><code>Opening Yr Date (DD/MM/YYYY) : 01/04/2012\nClosing Yr Date (DD/MM/YYYY): 31/03/2012\n</code></pre>\n\n<p><strong>Table : FixedAsset</strong></p>\n\n<pre><code>FixedAssetID Integer\nFixedAssetName Varchar(40)\nRateofdepr Decimal(7,2)\nDepr_Till_Opening_of_the_year Decimal(17,2)\nCost_of_Asset_At_Opening_of_the_year Decimal(17,2)\n</code></pre>\n\n<p><strong>Rows:</strong></p>\n\n<pre><code>(1,’Vehicle - 1’,5.00,1000.00,25000.00),\n(2,’Vehicle - 2’,6.00,0.00,0.00),\n(3,’Vehicle - 3’,6.00,500.00, 5000.00),\n(4,’Vehicle’,5.00,1000.00,2000.00),\n(5,’Machinery’,5.00,200.00,3000.00),\n(6,’Furniture’,5.00,300.00,4000.00)\n</code></pre>\n\n<p><strong>Table: Fixed_Asset_Purchase</strong></p>\n\n<pre><code>FixedAssetID Integer\nPurchase_Amount Decimal(17,2)\nPurchase_Date Date\n</code></pre>\n\n<p><strong>Rows:</strong></p>\n\n<pre><code>(3,500.00,’2012-07-01’),\n(2,1000.00,’2012-08-01’),\n(2,2000.00,’2012-11-01’),\n(5,500.00,’2012-07-01’)\n</code></pre>\n\n<p><strong>Table: Fixed_Asset_Sale</strong></p>\n\n<pre><code>FixedAssetID Integer\nCost_of_Fixed_Asset_Sold Decimal(17,2)\nSale_Value_of_Fixed_Asset Decimal(17,2)\nSale_Date Date\n**Rows:**\n(4,2000.00,500.00,’2012-07-01’),\n(5,3500.00,2500.00,’2012-09-01’),\n(6,500.00,300.00,’2012-06-01’),\n(6,500.00,200.00,’2012-10-01’)\n</code></pre>\n\n<p>With the Above data (Sample Data) I need to create a following a chart (or a ResultSet), with the following columns :</p>\n\n<pre><code>A.  Fixed Asset Name\nB.  Rate Of Depreciation\nC.  Cost of Asset at the Opening of Year\nD.   Purchase/Additions of Asset during the Year\nE.  Sale of Asset (ie.Cost of Asset Sold During the Year)\nF.  Cost of Asset at the Closing of Year = (C+D)-E\nG.  Total Value Of Depreciation Provided till the Opening of Year\nH.  Depreciation Provided During the Year\nI.  Value of Depreciation provided on Cost of Asset Sold till the Date they Were Sold on\nJ.  Total DepreciatioN = (G+H)-I\n</code></pre>\n\n<p>Please help in designing a SQL Query to get the Above Output with Proper Depreciated Values</p>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":51,"score":-2,"question_id":12639711,"title":"use of decode in oracle for two arguments","body":"<p>Scenerio is that: </p>\n\n<pre><code>decode(rslt1,\n       'stores',('stores,dead store'),\n       rslt1);\n</code></pre>\n\n<p>Explanation: if my <code>rslt1</code> is equal to <code>stores</code> then <code>rslt</code> should be <code>stores</code> and <code>dead store</code>. Mean two arguments against one argument.</p>\n\n<p>If there is anyother way kindly let me know?</p>\n"},{"tags":["java","mysql","sql-server","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":12639154,"title":"MySql Database keyword searching with like operator","body":"<p>I wanted to search some keywords from particular column and print all the column values corresponding to the keyword, Now the problem is if I use query </p>\n\n<p>Select * from Candidate where skills like %C% , and different rows in skills are:</p>\n\n<p>Java, C, C++, HTML, CSS, Net Beans, My Eclipse</p>\n\n<p>Java, Asp.Net, Eclipse</p>\n\n<p>C, PHP, CSS, Hibernate</p>\n\n<p>Now it is diplaying all the rows as C is a substring in every row, I tried to use C% rather than %C% but only 3rd line is displayed as it starts with C but I need to show all the Rowrs having \"C\" as a different word, How can I search the full world, Suggest piece of code.</p>\n\n<pre><code>import java.util.*;\nimport java.sql.*;\nimport java.io.*;\n\npublic class TokensOfString \n{\n    public static void main(String[] args) \n    {\n        String str;\n        String query = \"\";\n        try\n        {\n            int i =0, cntToken =0;\n            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n            System.out.println(\"Enter the keywords to be searched\");\n            str = br.readLine();\n            StringTokenizer words = new StringTokenizer(str, \",\");\n            cntToken = words.countTokens();\n            //System.out.println(\"No. of Tokens = \"+cntToken);\n\n            String token[]= new String[cntToken];\n\n            while(words.hasMoreElements())\n            {\n                token[i] = words.nextToken().trim();\n                //System.out.println(token[i]);\n                i++;\n            }\n                //System.out.println(++i+\" : \"+words.nextElement().toString().trim());    \n\n            query = \"SELECT * from can_skills where skills  like '\"+ token[0] +\"%'\";\n           // System.out.println(\"Query at 34 : \"+query);\n            if(cntToken == 1)\n            {\n                query =\"\";\n                query = \"SELECT * from can_skills where skills  like '\"+ str +\"%'\";\n            }\n            if(cntToken &gt; 1)\n            {\n                for( int j=1; j &lt; cntToken; j++)\n                query = query + \" or skills  like '\"+ token[j] +\"%'\";\n            }\n            System.out.println(\"Query at 43 : \"+query);\n\n            Connection con = null;\n            Class.forName(\"com.mysql.jdbc.Driver\");\n            String hostName = \"localhost\";\n            String port = \"3306\";\n            String userName = \"root\";\n            String password = \"root\";\n            con = DriverManager.getConnection(\"jdbc:mysql://\" + hostName + \":\" + port + \"/prem\", userName, password);\n            Statement statement= con.createStatement();\n            ResultSet rs = statement.executeQuery(query);\n            while(rs.next())\n            {\n                System.out.println(rs.getString(4));\n            }\n\n        }\n        catch(ClassNotFoundException e){ System.out.println(e); }\n        catch(Exception ex){ System.out.println(ex); }\n    }\n}\n</code></pre>\n"},{"tags":["php","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1489,"score":2,"question_id":5039561,"title":"PHP SQL database query error message","body":"<p>Is there anything wrong with this SQL code? I got it from a tutorial, but it's returning the following error message</p>\n\n<blockquote>\n  <p>Database query failed: You have an\n  error in your SQL syntax; check the\n  manual that corresponds to your MySQL\n  server version for the right syntax to\n  use near 'LIMIT 1' at line 1</p>\n</blockquote>\n\n<pre><code>function get_subject_by_id($subject_id) {\n    global $connection;\n    $query = \"SELECT * \";\n    $query .= \"FROM subjects \";\n    $query .= \"WHERE id=\" . $subject_id .\" \";\n    $query .= \"LIMIT 1\";\n    $result_set = mysql_query($query, $connection);\n    confirm_query($result_set);\n    // if no rows are returned, fetch array will return false\n    if ($subject = mysql_fetch_array($result_set)){\n    return $subject;\n    } else {\n    return NULL;\n\n    }\n    }\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12638912,"title":"native SQL query, getting max entry","body":"<p>Imagine a table T with two fields <code>f1</code> and <code>f2</code></p>\n\n<p>Lets put some dummy values:  </p>\n\n<pre><code>(1,2) , (1,3) , (1,4), (2,2), (4,1), (4,2) \n</code></pre>\n\n<p>I would like to retrieve the max value of <code>f2</code> for each <code>f1</code> namely I would like my query to return :</p>\n\n<pre><code>(1,4), (2,2), (4,2)\n</code></pre>\n\n<p>How can I achieve this ?</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12638642,"title":"Use already selected cells in query","body":"<p>I want to know if I in MySQL have the possibility to make a math statement with a selection I have made earlier in the query? E.g.:</p>\n\n<pre><code>SELECT\n t.date as the_date,\n TIMETODIFF(the_date, NOW()) as date_diff,\n t.time_interval as t_interval,\n (date_diff / t_interval) as intervals_left\nWHERE\n something = something\nORDER BY\n something DESC\n</code></pre>\n\n<p>My problem is, that i cant use the name, I give the selections. e.g when I use \"the_date\" to calculate the date_diff, it says \"unknown column\".</p>\n"},{"tags":["ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12636436,"title":"How to show Query result Activerecord Query Interface","body":"<p>I have а little question, write through Activerecord Query Interface\nIt's actually:</p>\n\n<p><code>Gp.select(\"date('gps'.'created_at') as date,('users'.'name') as name, SUM('gps'.'sum_issue') as sum_issue\").joins('LEFT  JOIN users  ON users.id = gps.user_id').where(\"users.ab_id = :abs_id  AND users.id != 20\", {:abs_id =&gt; current_user.ab_id}).group(\"users.name\")</code> </p>\n\n<p>Result of query must be user name, sum,and date. If i do this query directly from SQLlite it's work, But \nActive Record Query Interface give me </p>\n\n<pre><code>[#&lt;Gp sum_issue: 289000&gt;, #&lt;Gp sum_issue: 364130&gt;, #&lt;Gp sum_issue: 620000&gt;]\n</code></pre>\n\n<p>How i can get a name,date,sum_issue and show it in my helper.\nlike this:</p>\n\n<pre><code>{\n created_at: datet,\n sum_issue: sum_issue,\n name: name\n}\n</code></pre>\n"},{"tags":["php","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12637824,"title":"How to do mysql query based on the input textbox id?","body":"<p>I have a form with two input textboxs: mobile and extension, I want to provide an auto populate by jQuery to fill in another textbox like title, department and etc., I can do that like this</p>\n\n<p>index.php</p>\n\n<pre><code>//form start\n&lt;input type=\"text\" name=\"mobile\" id=\"mobile\" onchange = \"mobilecheck();\" size=\"10\" maxlength=\"30\" value=\"\" /&gt;\n&lt;input type=\"text\" name=\"extension\" id=\"extension\" onchange = \"extensioncheck();\" size=\"10\" maxlength=\"30\" value=\"\" /&gt;\n//form end\n//auto populate work well so I skip those codes\n\n//function start\nvar url = \"check.php?q=\";\n\nfunction mobilecheck() {\n   var idValue = document.getElementById(\"mobile\").value;\n   var myRandom=parseInt(Math.random()*99999999);  // cache buster\n   if (idValue==\"\") return;\n   http.open(\"GET\", url + escape(idValue) + \"&amp;rand=\" + myRandom, true);\n   http.onreadystatechange = handleHttpResponse;\n   http.send(null);\n}\n\nfunction extensioncheck() {\n   var idValue = document.getElementById(\"extension\").value;\n   //the other are same with mobilecheck() so skip it\n   //function end\n</code></pre>\n\n<p>use same php file to do the mysql query\ncheck.php</p>\n\n<pre><code>//query start\n$result = mysql_query(\"SELECT * FROM mycontact WHERE (mobile like '$q') or (extension like '$q')); \n//query end\n</code></pre>\n\n<p>it works well but I wonder is there a better way to do this like switch to combine two function in one.</p>\n\n<p>any suggestions? Thanks.</p>\n"},{"tags":["query","cassandra","fluentcassandra"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":12609008,"title":"Unable to perform range queries in Cassandra 1.2","body":"<p>I'm accessing Cassandra 1.2 via FluentCassandra and C#. I used the DataStax installation package. The issue I have is I cannot execute the range query I show below.</p>\n\n<p>I have tried the following table create methods:</p>\n\n<pre><code>CREATE TABLE Test (KEY text, p1 int, p2 int, p3 int, p4 int, p5 int, p6 int, \np7 int, p8 int, data text, PRIMARY KEY (KEY))\n\nCREATE TABLE Test (KEY text, p1 int, p2 int, p3 int, p4 int, p5 int, p6 int, \np7 int, p8 int, data text, PRIMARY KEY (KEY, p1, p2, p3, p4, p5, p6, p7, p8))\n</code></pre>\n\n<p>Here is the query:</p>\n\n<pre><code>SELECT Data FROM Test WHERE KEY IN ('           0', '           1', \n'           2', '           3', '           4', '           5', '           6', \n'           7', '           8', '           9', '          10', '          11', \n'          12', '          13', '          14', '          15') AND \np1 &gt;= 10 AND p1 &lt;= 40 AND p2 &gt;= 20 AND p2 &lt;= 80 AND \np3 &gt;= 30 AND p3 &lt;= 120 AND p4 &gt;= 40 AND p4 &lt;= 160 AND \np5 &gt;= 50 AND p5 &lt;= 200 AND p6 &gt;= 60 AND p6 &lt;= 240 AND \np7 &gt;= 70 AND p7 &lt;= 280 AND p8 &gt;= 80 AND p8 &lt;= 320;\n</code></pre>\n\n<p>The errors are:</p>\n\n<blockquote>\n  <p>\"No indexed columns present in by-columns clause with Equal operator\" /\n  \"PRIMARY KEY part p2 cannot be restricted (preceding part p1 is either\n  not restricted or by a non-EQ relation)\"</p>\n</blockquote>\n\n<p>My ConnectionBuilder:</p>\n\n<pre><code>ConnectionBuilder builder = new ConnectionBuilder(CDBkeyspace, \nnew Server(\"localhost\"), true, 0, 100, 0, ConnectionType.Framed, 4096, \nConsistencyLevel.QUORUM, Apache.Cassandra.ConsistencyLevel.QUORUM, \"3.0.0\");\n</code></pre>\n\n<p>How do I do this?</p>\n"},{"tags":["query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12637229,"title":"Basic SQL subqueries to get more than two table","body":"<p>Hi I have three table named <code>airports</code>, <code>flights</code>, <code>checkin</code>. From this table I need to retrive some fields like:</p>\n\n<pre><code>flight.code,\nflight.start_time,\nflight.end_time,\nflights.start_id,\nflights.endid,\nairports.name as sloc,\nairports.name as eloc\n</code></pre>\n\n<p>The conditions are:</p>\n\n<pre><code>ckeckin.flight_id = flights.id,\nairport.id = flights.startid, --for sloc\nairports.id = flights.endid --for eloc\n</code></pre>\n"},{"tags":["database","oracle","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12633906,"title":"Oracle Snapshot Not Working","body":"<p>I have created a snapshot that takes data from 2 tables and has a refresh rate of 1 day. The snapshot data is not refreshing it is still the same. is there something that i am missing ? </p>\n\n<p>Here is the code:</p>\n\n<pre><code> CREATE SNAPSHOT test\n REFRESH COMPLETE\n        START WITH SYSDATE \n        NEXT sysdate + 1\nAS\nselect item_code,item_conc_code,tran_bran_code,sum(tran_qty) bal_qty\nfrom tranhist a,\n     itemmast b\nwhere a.tran_item_code = b.item_code\ngroup by item_code,item_conc_code,tran_bran_code\n</code></pre>\n"},{"tags":["query","sql-server-2008","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":789,"score":0,"question_id":2449552,"title":"how to get time (hh:mm:ss) from sql query?","body":"<p>i have Database with date field.</p>\n\n<p>i see the time like: 1900-01-01 13:38:00.000</p>\n\n<p>how i can see it like: 13:38  ?</p>\n\n<p>(i work on sql server 2008)</p>\n\n<p>thank's in advance</p>\n"},{"tags":["sql","database","query","stored-procedures","statement"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":75,"score":-6,"question_id":12629146,"title":"How to create a stored procedure for select/update/delete statements","body":"<p>I have this sql statement that I want to convert to store procedure. How can I do that? </p>\n\n<pre><code>select a.name, a.lastname, from myTable where b.name= a.lastname\n</code></pre>\n\n<p>Thanks</p>\n\n<p>UPDATE\nWould this be right guys</p>\n\n<pre><code>CREATE PROCEDURE myProcedure\nAS\nBEGIN\nSELECT [a.name],\n       [a.lastname]\nFROM [myTable]\nWHERE [b.name] = a.lastname\nEND\n</code></pre>\n\n<p>This is one of the code that I am really working on</p>\n\n<p>sql statement</p>\n\n<pre><code>SELECT RTRIM(l.Lab1) + '/' + RTRIM(l.LabR) AS Lab, meta.Title,ls.[ID],ls.[surveyID], ls.[specialistID],ls.[isCompleted] FROM [MyDIM].[dbo].[lsLabSurvey] ls JOIN [MYDIM].[dbo].[dimDocMetaInfo] meta ON meta.id = ls.[surveyID] and specialistID = @PID and isCompleted=1 JOIN MyDatabase.DBO.PID_Table l ON ls.ID = l.ID\n</code></pre>\n\n<p>And My Attempted Stored Procedure</p>\n\n<pre><code>CREATE PROCEDURE PROCD1\nAS\nBEGIN\nSELECT RTRIM(l.Lab1) + '/' + RTRIM(l.LabR) \nAS Lab, \n   meta.Title,\n   la.[ID],\n   ls.[surveyID],\n   ls.[specialistID],\n   ls.[isCompleted]\nFROM [MyDIM].[dbo].[lsLabSurvey] ls \nJOIN [MyDIM].[dbo].[dimDocMetaInfo] meta \nON meta.id = ls.[surveyID] \nand specialistID = @PID \nand isCompleted=1 \nJOIN MyDatabase.DBO.PID_Table l \nON ls.ID = l.ID \n</code></pre>\n\n<p>END</p>\n"},{"tags":["sql","oracle","query","max","maximum"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1968,"score":1,"question_id":4483222,"title":"How to get second largest or third largest entry from a table","body":"<p>Can anyone please tell me how to find out the <strong>N th largest entry from a table</strong> in oracle?</p>\n\n<p><em>Like for largest we can use</em> MAX(column_name) <em>is there any efficient way to find nth largest also</em>?</p>\n"}]}
{"total":20740,"page":18,"pagesize":100,"questions":[{"tags":["php","mysql","query","join","multiple-tables"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12633984,"title":"Getting data from 2 related and 1 unrelated MySQL tables with one query?","body":"<p>I am trying to create an archives page for my blog, which is also still being built. I have three different MySQL tables I need to pull data from and 1 of them is unrelated from the other 2. I found a similar post <a href=\"http://stackoverflow.com/questions/11658191/getting-data-from-three-tables-in-one-query\">here</a> but seeing as how I am not very experienced with PHP I am not able to figure out how to convert that to what I need. I know this can easily be done by executing three different queries, but that will put an unnecessary load on the server and slow down page load times and everything else.</p>\n\n<p>The 2 related categories are \"blogs\" and \"categories\" while the third is for a different application built into the blog called the \"Brain Link\"</p>\n\n<p>Here are the two queries for the related tables:</p>\n\n<pre><code>    $blogQuery = mysqli_query($link, \"SELECT * FROM pub_blogs ORDER BY id DESC\") or die (\"Could not access DB: \" . mysqli_error($link));\n\n    $row = mysqli_fetch_assoc($blogQuery);  \n    $blogID = $link-&gt;real_escape_string($row['id']);\n    $title = $link-&gt;real_escape_string($row['title']);\n    $date = $link-&gt;real_escape_string($row['date']);\n    $category = $link-&gt;real_escape_string($row['category']);\n    $content = $link-&gt;real_escape_string($row['content']);\n\n    $blogID = stripslashes($blogID);\n    $title = stripslashes($title);\n    $date = stripslashes($date);\n    $category = stripslashes($category);\n    $content = stripslashes($content);\n\n    $catQuery = mysqli_query($link, \"SELECT * FROM categories ORDER BY id DESC\") or die (\"Could not access DB: \" . mysqli_error($link));\n\n    $row = mysqli_fetch_assoc($catQuery);\n    $catID = $link-&gt;real_escape_string($row['id']);\n    $catName = $link-&gt;real_escape_string($row['name']);\n    $description = $link-&gt;real_escape_string($row['descriptions']);\n\n    $catID = stripslashes($catID);\n    $catName = stripslashes($catName);\n    $description = stripslashes($description);\n</code></pre>\n\n<p>and here is the third unrelated query:</p>\n\n<pre><code>    $brainQuery = mysqli_query($link, \"SELECT * FROM brain_links ORDER BY id DESC\") or die (\"Could not access DB: \" . mysqli_error($link));\n\n    $row = mysqli_fetch_assoc($brainQuery);\n    $brainID = $link-&gt;real_escape_string($row['id']);\n    $site_name = $link-&gt;real_escape_string($row['site_name']);\n    $site_url = $link-&gt;real_escape_string($row['site_url']);\n    $post_date = $link-&gt;real_escape_string($row['post_date']);\n</code></pre>\n\n<p>Is it possible to get data from all three of these with one query? If not can someone point me in the direction of somewhere that will tell me how to join the two related ones?</p>\n\n<p><strong>The blog table saves the category ID under the 'category' column to identify which category it belongs to</strong></p>\n\n<p>I appreciate any help or suggestions! </p>\n"},{"tags":["mysql","query","restriction"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12634488,"title":"How can I write a MySQL query that will only return duplicate values, WITHOUT using aggregate functions?","body":"<p>I have a very basic table that consists of worker names and manager names: </p>\n\n<pre><code>CREATE TABLE Work (\nWorker_name varchar(50) NOT NULL \nManager_name varchar(50) NOT NULL;\n</code></pre>\n\n<p>This table allows a worker to be his own manager, a manager to be in charge of multiple workers, etc.</p>\n\n<p>I'm supposed to write a query that will show every manager who manages at least 2 different employees, BUT I can't use aggregate commands or GROUP BY.</p>\n\n<p>If somebody could give me a hint that would be great. I like figuring things out but this has really got me stumped.</p>\n\n<p>Thanks,\nAndrew</p>\n"},{"tags":["mysql","sql","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12633704,"title":"How to select different value from same column?","body":"<p>I have a <code>table</code> which has 2 <code>column</code>, Type and Age, but I want to display in 5 column due to it's condition like this example:\n|  TYPE  | Age &lt; 10 | 10&lt;=Age&lt;20 | Age > 20 |</p>\n\n<p>How can I achieve this since it has only 2 <code>column</code>?</p>\n\n<p>I've try selecting same table with different alias, but it was not good, long in execution time.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":9136648,"title":"How to query emails used by more than one user by using LEFT JOIN instead of GROUP BY?","body":"<p>Lets say I have a table called user_table:</p>\n\n<pre><code>user_table\n id\n first_name\n last_name\n gender\n email\n created_at\n</code></pre>\n\n<p>How would I write a query listing emails used by more than one user?</p>\n\n<p>EDIT:</p>\n\n<p>Can the same results be achieved by use LEFT JOIN instead of GROUP BY?</p>\n"},{"tags":["mysql","sql","query","select","sequence"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12628282,"title":"SQL query to find out of order records","body":"<p>I have a PHP program w/MySQL database which contains many records.  Two columns of particular relevance are incidentnumber and date.  These both move forward only.  However, sometimes a user enters data which is out of sequence; eg:</p>\n\n<pre><code>Incident Date\n1        Jan 1 2000\n2        Jan 1 2010\n3        Jan 1 2002\n</code></pre>\n\n<p>It appears that incident 2 was entered with the wrong date, it should be Jan 1 2001.</p>\n\n<p>Is there any way to query for records where the date is out of sequence?  Or do I have to iterate through all records tracking last date to find the error?</p>\n\n<p>ADDED NOTE: The incidents are not sequential (they might go 1,3,6,123, etc).  Nor are the dates sequential.  And these are columns in the same table.</p>\n"},{"tags":["sql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":12612927,"title":"What SQL query should I use?","body":"<p>This the table. The question is <strong>*<em>Find the pizza which uses the largest number of ingredients</em>*</strong></p>\n\n<p>I know the answer is special but I don't know how find it out using a query. I have tried many different ways, which didn't work. Thanks in advance.</p>\n\n<pre><code>   pizza    | ingredient | amount \n------------+------------+--------\n margarita  | cheese     |    120\n margarita  | spice      |      5\n ham        | ham        |    150\n ham        | spice      |      5\n napolitana | anchovies  |    100\n napolitana | olives     |     75\n napolitana | spice      |     10\n hawaiian   | ham        |    100\n hawaiian   | pineapple  |    100\n hawaiian   | spice      |      5\n cabanossi  | cabanossi  |    150\n cabanossi  | spice      |     10\n siciliano  | onion      |     50\n siciliano  | capsicum   |     75\n siciliano  | olives     |     50\n siciliano  | anchovies  |     50\n siciliano  | spice      |     15\n americano  | salami     |    120\n americano  | pepperoni  |     75\n americano  | spice      |     10\n mexicano   | onion      |     75\n mexicano   | capsicum   |     75\n mexicano   | mushroom   |     50\n mexicano   | chilli     |     25\n mexicano   | spice      |     20\n seafood    | seafood    |    200\n seafood    | spice      |      5\n garlic     | garlic     |     25\n garlic     | spice      |     10\n vegetarian | onion      |     50\n vegetarian | capsicum   |     50\n vegetarian | mushroom   |     50\n vegetarian | peas       |     50\n vegetarian | tomato     |     50\n vegetarian | spice      |      5\n mushroom   | mushroom   |    100\n mushroom   | spice      |      5\n special    | cheese     |     25\n special    | tomato     |     25\n special    | ham        |     25\n special    | anchovies  |     25\n special    | olives     |     25\n special    | mushroom   |     25\n special    | bacon      |     25\n special    | egg        |     25\n special    | pineapple  |     25\n special    | cabanossi  |     25\n special    | salami     |     25\n special    | capsicum   |     25\n special    | onion      |     25\n special    | peas       |     25\n special    | seafood    |     25\n special    | spice      |     10\n stagiony   | ham        |     75\n stagiony   | mushroom   |     50\n stagiony   | olives     |     50\n stagiony   | anchovies  |     25\n stagiony   | spice      |     10\n</code></pre>\n\n<hr>\n\n<p>I just needed to know the name of pizza which has used most ingredient. And the answer is <strong>Select pizza from recipe group by pizza having count(<em>)>=all (select count(</em>) from recipe group by pizza);</strong></p>\n\n<p>and the output is:</p>\n\n<h2>  pizza</h2>\n\n<p>special\n(1 row)</p>\n"},{"tags":["mysql","query","results","concat","mysql-like"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12631180,"title":"using mysql concat and searching for that field using like, does that work?","body":"<p>I am creating a query like the following</p>\n\n<p>SELECT CONCAT(u.firstName,\" \",u.lastName) as user</p>\n\n<p>then later on in the query I write:</p>\n\n<p>WHERE user LIKE '%jay%'</p>\n\n<p>I am getting no results.  Are you not able to use a concatenated field this way?</p>\n"},{"tags":["mysql","query","join","exists"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":12630487,"title":"MySQL select join many to many tables plus IN and NOT IN","body":"<p>I have 3 tables: Products, Tags, and products_tags(many to many between Products and Tags).\nin my schema, a product can have zero to many tags and a tag can have zero to many products.\nNow i want to select products that have certain tags and don't have certain tags.</p>\n\n<p>Products table:</p>\n\n<blockquote>\n  <p>idproducts  /  name</p>\n  \n  <p>1 / samsung galaxy</p>\n  \n  <p>2 / samsung note1</p>\n  \n  <p>3 / samsung note2</p>\n  \n  <p>4 / iphone 4gs</p>\n</blockquote>\n\n<p>Tags table:</p>\n\n<blockquote>\n  <p>idtags / word</p>\n  \n  <p>1 / samsung</p>\n  \n  <p>2 / galaxy</p>\n  \n  <p>3 / note1</p>\n  \n  <p>4 / note2</p>\n  \n  <p>5 / iphone</p>\n  \n  <p>6 / 4gs</p>\n  \n  <p>7 / apple</p>\n</blockquote>\n\n<p>Products_Tags Table:</p>\n\n<blockquote>\n  <p>product / tag</p>\n  \n  <p>1 / 1</p>\n  \n  <p>1 / 2  </p>\n  \n  <p>2 / 1</p>\n  \n  <p>2 / 3</p>\n  \n  <p>3 / 1</p>\n  \n  <p>3 / 4</p>\n  \n  <p>4 / 5</p>\n  \n  <p>4 / 6</p>\n</blockquote>\n\n<p>I have the query below, but it gives me the products with tags i <b>didn't</b> want cause they have some other tags and as result of join they appear in the result set.</p>\n\n<blockquote>\n  <p>SELECT * FR0M products AS p</p>\n\n<pre><code>JOIN products_tags AS pt ON pt.product = p.idproducts\n\nJOIN tags AS t ON t.idtags = pt.tag\n\nWHERE t.word IN ('samsung', 'mobile')\n\nAND t.word NOT IN ('note1', 'note2')\n</code></pre>\n</blockquote>\n\n<p>If i wanted Samsung Galaxy and i defined to have tags like 'samsung' and not have 'note1' and 'note2'. What would be the query for this?</p>\n\n<p>P.S. I thought maybe EXISTS or NOT EXISTS should be used, but i am just not able to figure out how i should use them.</p>\n\n<p>Thanks in Advance</p>\n"},{"tags":["mysql","query","group-concat"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12629815,"title":"How to group by / group_concat each set of results?","body":"<p>Image we have a table like this:</p>\n\n<p><strong>table1</strong></p>\n\n<pre><code>+----------+----------+--------+------------+\n| position | epoc     | name   | value      |\n+----------+----------+--------+------------+\n|    1     |    1     |   A    |        v01 |\n|    1     |    1     |   B    |        v02 |\n|    1     |    1     |   C    |        v03 |\n|    1     |    2     |   A    |        v04 |\n|    1     |    2     |   B    |        v05 |\n|    1     |    2     |   C    |        v06 |\n|    1     |    3     |   A    |        v07 |\n|    1     |    3     |   B    |        v08 |\n|    1     |    3     |   C    |        v09 |\n|    1     |    4     |   A    |        v10 |\n|    1     |    4     |   B    |        v11 |\n|    1     |    4     |   C    |        v12 |\n|    2     |    5     |   A    |        v13 |\n|    2     |    5     |   B    |        v14 |\n|    2     |    5     |   C    |        v15 |\n|    2     |    6     |   A    |        v16 |\n|    2     |    6     |   B    |        v17 |\n|    2     |    6     |   C    |        v18 |\n|    2     |    7     |   A    |        v19 |\n|    2     |    7     |   B    |        v20 |\n|    2     |    7     |   C    |        v21 |\n|    2     |    8     |   A    |        v22 |\n|    2     |    8     |   B    |        v23 |\n|    2     |    8     |   C    |        v24 |\n+----------+----------+--------+------------+\n</code></pre>\n\n<p>I want to be able to  get this table:</p>\n\n<p><strong>table2</strong></p>\n\n<pre><code>+----------+--------------------+\n| position | value              |\n+----------+--------------------+\n|    1     |    v01,v02,v04,v05 |\n|    2     |    v13,v14,v16,v17 | \n+----------+--------------------+\n</code></pre>\n\n<p>the conditions are:</p>\n\n<ul>\n<li>JUST the \"value\" of rows with \"name\" A OR B; </li>\n<li>JUST \"epocs\" that are the first 2 unique results in \"position\" (epoc 3,4,7,8 are discarded)</li>\n<li>GROUP by table1 position (for each position I want the concat of the values that match previous conditions)</li>\n</ul>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12630291,"title":"Need count in the query","body":"<p>In sp here I am trying to get a count of how many records meet the criteria so that I can display as a total in the tile of the app. But am not having success with this, can you tell me how to make a count and where to put that.</p>\n\n<pre><code>(\n  @P_FACILITY_KEY_CSV VARCHAR(MAX)\n, @DATEFROM DATETIME \n, @DATETHRU DATETIME\n, @P_TOTALS NUMERIC(1, 0)\n)\nAS\nBEGIN\n          DECLARE @DFACKEY CHAR(4)\n          DECLARE @IRENEWALLCYCLEPERIOD NUMERIC\n          SET @IRENEWALLCYCLEPERIOD = OGEN.READ_PARAM(349, @P_FACILITY_KEY_CSV, '') \n          EXEC OGEN.GET_CODE_FACILITY @P_FACILITY_KEY_CSV, 'OGEN.GEN_M_DOCTOR_MAST', 'BASE', @DFACKEY OUTPUT;\n\n     IF @P_TOTALS = 1 BEGIN\n\n         SELECT P.NURSING_UNIT,\n                ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) DUE_DATE,\n                CONVERT(NUMERIC, ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) - GETDATE()) REMAINING\n              FROM OGEN.GEN_M_PATIENT_MAST P\n              LEFT OUTER JOIN OGEN.GEN_M_DOCTOR_MAST D ON P.PRIMARY_DOCTOR_KEY = D.DOCTOR_KEY AND D.FACILITY_KEY = @DFACKEY\n              LEFT OUTER JOIN OPTC.ORD_D_SCHEDULED_RECERTS SR ON P.PAT_NUMBER = - SR.PAT_NUMBER\n              LEFT OUTER JOIN OGEN.GEN_M_USER U ON U.USER_ID = SR.RECERT_BY\n              WHERE P.FACILITY_KEY IN(SELECT VALUE FROM OGEN.COMMA_TO_TABLE(@P_FACILITY_KEY_CSV)) \n              AND DISCHARGE_DATE IS NULL\n              AND ( ( (@DATEFROM &gt; 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) &gt;= @DATEFROM) )\n                    OR\n                    (@DATEFROM = 0) )\n              AND ( ( (@DATETHRU &gt; 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) &lt;= @DATETHRU) )\n                    OR\n                   ( @DATETHRU = 0) )\n\n              ORDER BY REMAINING;\n\n     END ELSE BEGIN\n\n          SELECT P.*, D.DR_FULL_NAME PRIMARY_DOCTOR_NAME,\n                 SR.RECERT_DATE, SR.RECERT_BY, U.USER_NAME,\n                 ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) DUE_DATE,\n                 CONVERT(NUMERIC, ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD) - GETDATE()) REMAINING                           \n          FROM OGEN.GEN_M_PATIENT_MAST P\n          LEFT OUTER JOIN OGEN.GEN_M_DOCTOR_MAST D ON P.PRIMARY_DOCTOR_KEY = D.DOCTOR_KEY AND D.FACILITY_KEY = @DFACKEY\n          LEFT OUTER JOIN OPTC.ORD_D_SCHEDULED_RECERTS SR ON P.PAT_NUMBER = - SR.PAT_NUMBER\n          LEFT OUTER JOIN OGEN.GEN_M_USER U ON U.USER_ID = SR.RECERT_BY\n          WHERE P.FACILITY_KEY IN(SELECT VALUE FROM OGEN.COMMA_TO_TABLE(@P_FACILITY_KEY_CSV)) \n          AND DISCHARGE_DATE IS NULL\n          AND ( ( (@DATEFROM &gt; 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) &gt;= @DATEFROM) )\n                OR\n                (@DATEFROM = 0) )\n          AND ( ( (@DATETHRU &gt; 0) AND (OGEN.DATEONLY(ISNULL( SR.USER_DEFINED_DUE_DATE, ISNULL(SR.RECERT_DATE, P.ADMIT_DATE) + @IRENEWALLCYCLEPERIOD)) &lt;= @DATETHRU) )\n                OR\n               ( @DATETHRU = 0) )\n          ORDER BY DUE_DATE\n    END   \nEND\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":141,"score":0,"question_id":12572899,"title":"SQL get offline website by threshold","body":"<p>I have two tables (actually I have a lot more, but that doesn't matter):</p>\n\n<pre><code>sourcewebsite:\nid - int (PK)\nname - varchar\nofflinethreshold - int\n\nsourcewebsite_updatelog:\nid - int (PK)\nsourcewebsiteid - int (FK)\ndatetime_start - datetime\nepisodestotal - int\n</code></pre>\n\n<p>The sourcewebsite tables holds a couple of sourcewebsites, with an offlinethreshold that indicates how many hours the website is allowed to be offline.</p>\n\n<p>The sourcewebsite_updatelog table is a logging table that is filled with a new entry every time a sourcewebsite is checked. If 'episodestotal' equals 0, it means the website was offline when the check occured.</p>\n\n<p>What I want now is this: I want a list of all the websites that exceeded their offlinethreshold. So let's assume we have a sourcewebsite with ID 1, and an offlinethreshold of 6 hours. Let's assume that this website is checked 5 times during the last 6 hours, but every time it was checked, 'episodestotal' was 0. This means that this website exceeded its threshold and can therefore be considered to be offline.</p>\n\n<p>I came up with a little SQL query to determine all sourcewebsites that have been offline for the past 6 hours, but the problem is that these '6 hours' are hardcoded. I want to use the values from the 'offlinethreshold' column for each sourcewebsite.</p>\n\n<p>This is the query that I came up with so far:</p>\n\n<pre><code>SELECT `sourcewebsiteid`, `name`\nFROM `sourcewebsite_updatelog`\nJOIN `sourcewebsite`\nON `sourcewebsite_updatelog`.`sourcewebsiteid` = `sourcewebsite`.`id`\nWHERE `datetime_start` &gt; DATE_SUB(NOW(), INTERVAL 6 HOUR)\nGROUP BY `sourcewebsiteid`\nHAVING MAX(`episodestotal`) = 0\n</code></pre>\n\n<p>Here's some sample data:</p>\n\n<pre><code>sourcewebsite:\n1 - channel 1 - 5\n2 - channel 2 - 3\n3 - channel 3 - 10\n\nsourcewebsite_updatelog:\n1 - 1 - 2012-09-27 12:03:05 - 1\n2 - 2 - 2012-09-27 12:50:20 - 0\n3 - 3 - 2012-09-27 12:51:11 - 1\n4 - 1 - 2012-09-27 13:25:56 - 0\n5 - 2 - 2012-09-27 13:48:34 - 0\n6 - 3 - 2012-09-27 13:59:01 - 0\n7 - 1 - 2012-09-27 14:23:53 - 1\n8 - 1 - 2012-09-27 14:54:28 - 0\n9 - 2 - 2012-09-27 15:11:40 - 0\n</code></pre>\n\n<p>Let's assume that we check the data at 2012-09-27 15:30. Channel 1 has a threshold of 5 hours. It has been online 2 times during the last 5 hours (at 12:03 and 14:23) so it won't be flagged as 'offline'.</p>\n\n<p>Channel 2 has been offline every single time during the last 3 hours, so it must be flagged as offline.</p>\n\n<p>Channel 3 has been online 1 time during the last 10 hours, so it's okay. No flag needed.</p>\n\n<p>Can anyone help me?</p>\n"},{"tags":["database","query","indexing","mongodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":527,"score":0,"question_id":6516725,"title":"How do I index two arrays in MongoDB?","body":"<pre><code>db.hello.ensureIndex({\"array1\":1, \"array2\":1})\n</code></pre>\n\n<p>MongoDB does not allow that, because they say \"it can get out of hand\". However, I know that my arrays will never exceed length of 3. How can I hack MongoDB to allow indexing multiple arrays at once?</p>\n\n<blockquote>\n  <p>When using a compound index, at most\n  one of indexed values in any document\n  can be an array. So if we have an\n  index on {a: 1, b: 1}, the following\n  documents are both fine:</p>\n  \n  <p>{a: [1, 2], b: 1} {a: 1, b: [1, 2]}\n  This document, however, will fail to\n  be inserted, with an error message\n  \"cannot index parallel arrays\":</p>\n  \n  <p>{a: [1, 2], b: [1, 2]} The problem\n  with indexing parallel arrays is that\n  each value in the cartesian product of\n  the compound keys would have to be\n  indexed, which can get out of hand\n  very quickly.</p>\n</blockquote>\n"},{"tags":["query","sqlite","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12627848,"title":"Select attributes in descending order of # of word matches in comparison to a constant","body":"<p>I am faced with a database (sqlite specifically) query that I am not sure how to approach.</p>\n\n<p>I'm looking for all tuples that have 1-n word matches between their 'name' attribute and a constant.  Sorted in descending order.</p>\n\n<p>For example it is a database containing food items. If the constant is \"Maranatha Natural Almond Butter 26oz Lightly Roasted\" I would like any tuple in the database that contains atleast one of the words in that constant to be returned. For example \"Almond Butter Natural\" would come before \"Maranatha Natural\" which would come before \"Almond\", etc.</p>\n\n<p>Essentially as long as there is one intersecting word between the tuples attribute and the constant it qualifies a match.</p>\n"},{"tags":["python","query","sorting","elasticsearch"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":418,"score":2,"question_id":9084536,"title":"Sorting by multiple params in pyes and elasticsearch","body":"<p>I can pass a single <strong>sort</strong> parameter to the search query in pyes like this:</p>\n\n<pre><code>s = MatchAllQuery()\nconn.search(query=Search(s), indexes=[\"test\"], sort='_score')\n</code></pre>\n\n<p>But I need to pass an extra parameter to sort the docs with the same score, like this:</p>\n\n<pre><code>{\n  \"sort\": [\n    \"_score\",\n    {\n      \"extra_param\": {\n        \"order\": \"asc\"\n      }\n    }\n  ],\n  \"query\": {\n    \"term\": {\n      \"match_all\": {}\n    }\n  }\n}\n</code></pre>\n\n<p>How can I do this in pyes?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","query","indexing","performance","logging"],"answer_count":6,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":3272,"score":9,"question_id":1277865,"title":"MySQL indexes - how many are enough?","body":"<p>I'm trying to fine-tune my MySQL server so I check my settings, analyzing slow-query log, and simplify my queries if possible.</p>\n\n<p>Sometimes it is enough if I am indexing correctly, sometimes not. I've read somewhere (please correct me if this is stupidity) that more indexes than I need make the same effect, like if I don't have any of indexes.</p>\n\n<p>How many indexes are enough? You can say it depends on hundreds of factors, but I'm curious about how can I clean up my <code>mysql-slow.log</code> enough to reduce server load.</p>\n\n<p>Furthermore, I saw some \"interesting\" log entries like this:</p>\n\n<pre><code># Query_time: 0  Lock_time: 0  Rows_sent: 22  Rows_examined: 44\nSELECT * FROM `categories` ORDER BY `orderid` ASC;\n</code></pre>\n\n<p>The table in question contains exactly 22 rows, index set in <code>orderid</code>. Why is this query showing up in the log after all? Why examine 44 rows if it only contains 22?</p>\n"},{"tags":["sql","sql-server","query","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":12629312,"title":"Locate & count all duplicates of subset of columns in table with query","body":"<p>Can someone tell me what I'm doing wrong here and how to make the query work?</p>\n\n<p>I'm trying to return {OrgID, IdentifierTypeID, IdentifierOrder, ValidFrom} for all records where those 4 columns are duplicated along with the count of duplicates.  I only want duplicates shown in the result set, that's why I tried the > 1 part.</p>\n\n<pre><code>select count(*) Number, OrgID, IdentifierTypeID, IdentifierOrder, ValidFrom\n    from xdb.dbo.OrganizationIdentifier_IngestII\n    where Number &gt; 1\n    group by OrgID, IdentifierTypeID, IdentifierOrder, ValidFrom\n</code></pre>\n"},{"tags":["sql","query","select","join","null"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12629128,"title":"SQL query that can display data with a null ID and with not null id on the same Datatable?","body":"<p>Hello I have a question here...</p>\n\n<p>I'll show you my tables first...</p>\n\n<pre><code>[Vendedores](\n    [IdVendedor] [int] IDENTITY(1,1) NOT NULL,\n    [IdGrupo] [int] NULL,\n    [IdInfoContacto] [int] NULL,\n    [ApellidoPaterno] [varchar](30) NULL,\n    [ApellidoMaterno] [varchar](30) NULL,\n    [Nombre] [varchar](35) NULL,\n    [Estado] [varchar](10) NULL,\n CONSTRAINT [PK_Vendedores] PRIMARY KEY CLUSTERED \n\n[Clientes](\n    [IdCliente] [int] IDENTITY(1,1) NOT NULL,\n    [IdGrupo] [int] NULL,\n    [IdVendedor] [int] NULL,\n    [IdDireccion] [int] NULL,\n    [IdInfoContacto] [int] NULL,\n    [FechaAlta] [date] NULL,\n    [ApellidoPaterno] [varchar](30) NULL,\n    [ApellidoMaterno] [varchar](30) NULL,\n    [Nombre] [varchar](40) NULL,\n    [Empresa] [text] NULL,\n    [Estado] [varchar](20) NULL,\n    [Estatus] [varchar](20) NULL,\n CONSTRAINT [PK_Clientes] PRIMARY KEY CLUSTERED \n\n[dbo].[Mensajes](\n    [IdMensaje] [int] IDENTITY(1,1) NOT NULL,\n    [IdCliente] [int] NULL,\n    [IdVendedor] [int] NULL,\n    [CorreoRemitente] [varchar](100) NULL,\n    [CorreoCliente] [varchar](100) NULL,\n    [CorreosAdicionales] [varchar](max) NULL,\n    [Tema] [varchar](100) NULL,\n    [Mensaje] [varchar](max) NULL,\n    [Fecha] [date] NULL,\n    [Hora] [time](5) NULL,\n CONSTRAINT [PK_Mensajes] PRIMARY KEY CLUSTERED \n\n[Archivos](\n    [IdArchivo] [int] IDENTITY(1,1) NOT NULL,\n    [IdMensaje] [int] NULL,\n    [Nombre] [varchar](max) NULL,\n    [Ubicacion] [varchar](50) NULL,\n CONSTRAINT [PK_Archivos] PRIMARY KEY CLUSTERED \n</code></pre>\n\n<p>There are 2 ways to send messages in the system I'm developing...:</p>\n\n<p>the first one is, you select a client, and when the message is sent, the client's ID (IdCliente) is taken from Clientes Table and inserted in a new row in Mensajes table.\nthat way, when you want to check all of the sent messages, you can clearly see to which client was sent.</p>\n\n<p>the second one would be a free one, you send to whoever you want, you don't have to select a client. Therefore, when you register the new message, the IdCliente column would be null.</p>\n\n<p>Some notes out of the way now: Vendedor is the seller or user who sent the message, Archivos means files, and in case you want to attach files, for each one of them, a new row in Archivos would be inserted and each with the same IdMensaje.</p>\n\n<p>FOR THE moment, I have a query that allows me to see all my messages (with clients), and to also show how many files were attached to that message. HERE IT IS:</p>\n\n<pre><code>SELECT (Clientes.ApellidoPaterno + ' ' + Clientes.ApellidoMaterno + ' ' + Clientes.Nombre) AS Cliente, Mensajes.* FROM (SELECT Mensajes.IdMensaje, Mensajes.IdCliente, Mensajes.IdVendedor, Mensajes.CorreoRemitente, Mensajes.CorreoCliente, Mensajes.CorreosAdicionales, Mensajes.Tema, Mensajes.Mensaje, Mensajes.Fecha, Mensajes.Hora, COUNT(Archivos.IdArchivo) AS Archivos FROM Mensajes LEFT OUTER JOIN Archivos ON Mensajes.IdMensaje = Archivos.IdMensaje GROUP BY Mensajes.IdMensaje, Mensajes.IdCliente, Mensajes.IdVendedor, Mensajes.CorreoRemitente, Mensajes.CorreoCliente, Mensajes.CorreosAdicionales, Mensajes.Tema, Mensajes.Mensaje, Mensajes.Fecha, Mensajes.Hora) AS Mensajes JOIN Clientes ON Clientes.IdCliente = Mensajes.IdCliente ORDER BY Mensajes.Fecha DESC, Mensajes.Hora DESC\n</code></pre>\n\n<p>\"(Clientes.ApellidoPaterno + ' ' + Clientes.ApellidoMaterno + ' ' + Clientes.Nombre) AS Cliente\" Displays the full name of the client</p>\n\n<p>however, now I want to have a query in which displays the same information as above... plus the following...</p>\n\n<ul>\n<li>Messages with IdCliente = null</li>\n<li>if IdCliente = null then the Cliente Column that I mentioned above would be \"\" (blank space)</li>\n</ul>\n\n<p>If I need to be more specific, please let me know in what part must I give more information.</p>\n\n<p>I hope you guys can help me\nThanks in advance</p>\n"},{"tags":["php","mysql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":3,"view_count":44,"score":-3,"question_id":12628586,"title":"Mysql_query not pulling information from table","body":"<p>I've been using this method for years, but now for some reason I am unable to pull information from a table. The first two queries work just fine, but for some reason I am unable to get the third query to work. No errors are thrown out and this very same query works on other pages, but I'm thinking that maybe the issue here is because I'm pulling too many queries at one time? Not sure, but for the life of me I cannot figure out what's going wrong.</p>\n\n<hr>\n\n<p>The output at the end of the script:</p>\n\n<p>Customer ID outputs correctly</p>\n\n<p>Resource id #19</p>\n\n<p>And nothing gets put out for number of rows returned</p>\n\n<hr>\n\n<pre><code>$customer_id= $_GET['customer_id'];\n\nmysql_connect(\"localhost\", \"******\", \"******\") or die(mysql_error());\nmysql_select_db(\"database\") or die(mysql_error());\n\n$find = mysql_query(\"SELECT * FROM userInformation WHERE customer_id = '$customer_id' \");\n$user_information = mysql_fetch_array($find);\n\n$find = mysql_query(\"SELECT * FROM technicalInformation WHERE customer_id = '$customer_id' \");\n$technical_information = mysql_fetch_array($find);\n\n$find = mysql_query(\"SELECT * FROM network_information WHERE customer_id = '$customer_id' \") or die(mysql_error());\n\necho 'User ID is '.$customer_id.'&lt;BR&gt;';\necho $find.'&lt;BR&gt;';\n$rows = mysql_num_rows($find);\nexit($rows);\n\nmysql_close();\n</code></pre>\n"},{"tags":["query","postgresql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12627506,"title":"postgres sql query counting two sets of objects","body":"<p>I have this join query below. I am having one issue with it. \nThe shippedUnits column comes out wrong. It just counts the total items. The issue is I am counting two sets of objects that have everything in common except the shipped field.   </p>\n\n<pre><code>SELECT count(*) as \"units\", (select count(\"EsnsVmas\".*) from \"EsnsVmas\" where\n      \"EsnsVmas\".\"shipped\" = false AND \"EsnsVmas\".\"VmaId\" = 2 AND \"EsnsVmas\".\"approved\" = \n       true) as \"shippedUnits\", \"Vmas\".*, \"Vendors\".\"name\" as \"name\", \"EsnsVmas\".id as    \n       \"OrderItemId\", \"PurchaseOrderItems\".\"price\", \"Grades\".\"name\" as \"vendorGrade\", \n       \"Items\".\"name\" as \"model\", \"Items\".id as \"ItemId\", \"Grades\".id as \"GradeId\" \nFROM \"Vmas\" \n      JOIN \"EsnsVmas\" on (\"EsnsVmas\".\"VmaId\" = \"Vmas\".id) \n      JOIN \"Esns\" on (\"EsnsVmas\".\"EsnId\" = \"Esns\".id) \n      JOIN \"PurchaseOrderItems\"  on (\"Esns\".\"PurchaseOrderItemId\"  =  \n            \"PurchaseOrderItems\".id) \n      JOIN \"Items\" on (\"PurchaseOrderItems\".\"ItemId\" = \"Items\".id) \n      JOIN \"Grades\" on (\"PurchaseOrderItems\".\"GradeId\" = \"Grades\".id) \n      JOIN \"Vendors\" on (\"Vmas\".\"VendorId\"  = \"Vendors\".id)\n WHERE \"Vmas\".id =2 AND \"EsnsVmas\".\"approved\" = true \n GROUP BY \"Vmas\".id, \"PurchaseOrderItems\".id, \"Grades\".id, \"Items\".id, \"Vendors\".id, \"EsnsVmas\".id ;\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12627662,"title":"SQL Remove Row That Has The Same Values Into New Table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3671607/remove-duplicate-rows-leaving-oldest-row-only\">Remove Duplicate Rows Leaving Oldest Row Only?</a><br>\n  <a href=\"http://stackoverflow.com/questions/4712809/mysql-remove-duplicate-rows\">MySQL remove duplicate rows</a>  </p>\n</blockquote>\n\n\n\n<p>Say that i have the following table coolumns: <strong>int logicalid(pk) ,int home, int person</strong>  say the i have the following records...<br>\n1,5,6<br>\n2,5,6<br>\n3,5,5<br>\n4,5,5  </p>\n\n<p>after my query i want to place into the new table only one row with the same home,person column values so this will be the outptu reaults:<br>\n1,5,6<br>\n2,5,5<br>\nany ideas??</p>\n"},{"tags":["sql-server","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":12625832,"title":"Is there any query to generate dump of databases in SQL Server?","body":"<p>Is there any query to generate dump of databases? I want to generate the dump without gui, especially for mssql? I don't want to use any import/export tools. In short, I need to script all the objects in db with the query</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12625938,"title":"Which query has better performance - where clause with case statement?","body":"<p>Cars is a table that has a column CarType. CarType is non-null and can contain 2 values. CarDonated and CarSold.</p>\n\n<p>We pass in a parameter from a report to include either all CarTypes, or a specific CarType (such as CarDonated). </p>\n\n<p>The parameter in scenario 1 passes in either 'Car' (for all CarTypes), 'CarD' for CarDonated, 'CarS' for CarSold.</p>\n\n<pre><code>select *\nfrom Cars c\nwhere c.CarType like @CarTypeParam + '%'\n</code></pre>\n\n<p>OR</p>\n\n<p>The parameter in scenario 2 passes in '0' (for all CarTypes), 'CarDonated', 'CarSold'</p>\n\n<pre><code>select *\nfrom Cars c\nwhere c.CarType = case when @CarTypeParam = '0' \n                   then c.CarType\n                   else @CarTypeParam \n                  end\n</code></pre>\n\n<p>Which scenario/coding method is better? I'm not too familiar with using case statements in where clauses. Is the optimizer still able to use index on the CarType in both scenarios? Which is better coded?</p>\n\n<p>SQL Server 2008 R2 (along with SSRS)</p>\n"},{"tags":["sql","oracle","query","database-administration"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12624795,"title":"Oracle backup information","body":"<p>I am new in oracle . I am using exp &amp; imp utility for backup &amp; restoration of oracle database or schema. Am I using the right utility or something wrong in it. Actually there different developers working on different schema , in my case there are three schema or user working on the same database . I want to schedule backup for this. I am confused regarding backup policy that whether I should use imp &amp; exp utility or something else and why?</p>\n\n<p>which will be an efficient way to do this . Please help me out of it ?</p>\n\n<p>Thanks</p>\n\n<p>Nitesh Kumar</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12249409,"title":"Suppress repeating Columns","body":"<p>I have two tables:</p>\n\n<ul>\n<li><code>bpoint</code> -> table of all houses</li>\n<li><code>images</code> -> table of house images (max 3 per house).</li>\n</ul>\n\n<p>Here is my MySQL join query to fetch a house information and it's images:</p>\n\n<pre><code>SELECT \n    bpoint.*, bimages.iURL\nFROM\n    bpoint,\n    bimages\nWHERE\n    bpoint.pointID  = bimages.pointID\nAND bimages.pointID = '$tocka'\n</code></pre>\n\n<p>Since there are more image rows than house rows (there is always only one house result and 1-3 image results), is there a way to drop house result doubles which come with every image?</p>\n"},{"tags":["sql","query","select","oracle10g"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":12624457,"title":"Select Query to generate and exclude some results by joining two tables","body":"<p>I have two tables named, config and config_exceptions. Both has same structure. Columns are home, configName, data, active. </p>\n\n<p>config table has below data</p>\n\n<pre><code>0 config1 my_data1 active\n0 config1 my_data2 active\n0 config1 my_data3 active\n0 config2 my_data3 active\n2 config1 my_data1 active\n2 config2 my_data1 active\n</code></pre>\n\n<p>config_exceptions table has below data</p>\n\n<pre><code>10 config1 my_data1 active\n</code></pre>\n\n<p>I need to write a query to exempt config_exceptions data with home 0 alone to give results, like below</p>\n\n<pre><code>0 config1 my_data1 active\n0 config1 my_data2 active\n0 config1 my_data3 active\n0 config2 my_data3 active\n2 config1 my_data1 active\n2 config2 my_data1 active\n10 config1 my_data2 active\n10 config1 my_data3 active\n</code></pre>\n\n<p>This result is creating a new set of config results for home 10 using home 0 and exclude the config_exceptions table data. <strong>main columns for comparing is home and configName.</strong></p>\n\n<p>And I can't hard code as 10, they will be more, but 0 can be hard coded as it is used as base.</p>\n\n<p>Please help me to write this query, I don't have idea. Please give me some idea.</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12624322,"title":"Update Mysql Query Optimisation","body":"<p>I must create a mysql query with a large number of queries (about 150,000)</p>\n\n<p>For the moment the query is:</p>\n\n<pre><code>UPDATE table SET activated=NULL\nWHERE (\n        id=XXXX\n    OR  id=YYYY \n    OR  id=ZZZZ \n    OR  id=...\n    ...\n)\nAND activated IS NOT NULL\n</code></pre>\n\n<p>Do you know a best way for to do that please?</p>\n"},{"tags":["query","reporting-services","mdx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12609716,"title":"MDX Query Error on SSRS Report","body":"<p>Function expects a tuple set expression for the first argument. A string or numeric expression was used.\nI am designing the mdx query on my ssrs report.</p>\n\n<p>Here is my MDX query:</p>\n\n<pre><code>SELECT \n     NON EMPTY { [Measures].[Order Quantity], [Measures].[Discount Amount], [Measures].[Freight], [Measures].[Extended Amount] } ON COLUMNS, \n     NON EMPTY { ([Customer].[Customer Key].[Customer Key].ALLMEMBERS * [Currency].[Currency Key].[Currency Key].ALLMEMBERS * [Currency].[Currency Name].[Currency Name].ALLMEMBERS * [Customer].[Gender].[Gender].ALLMEMBERS ) } ON ROWS \nFROM (\n      SELECT ( STRTOSET ( '{\" &amp; Join(Parameters!CurrencyCurrencyKey.Value,\",\") &amp; \"}') ) ON COLUMNS\n      FROM [AWDW]\n     )\n</code></pre>\n\n<p>Any Idea?????</p>\n"},{"tags":["mysql","sql","database","performance","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12605137,"title":"Optimizing this piece of MYSQL Code for better execution time","body":"<p>This piece of mysql code</p>\n\n<pre><code>SELECT  id, value, LENGTH(stuffing)\nFROM  t_limit ORDER BY id LIMIT 150000, 10\n</code></pre>\n\n<p>can be optimized for better performance by rewriting it like this</p>\n\n<p><strong>Note:Table has Index on Id</strong> </p>\n\n<pre><code>SELECT  l.id, value, LENGTH(stuffing)\nFROM    (\n    SELECT  id\n    FROM    t_limit\n    ORDER BY\n            id\n    LIMIT 150000, 10\n    ) o\nJOIN    t_limit l\nON      l.id = o.id\nORDER BY\n    l.id\n</code></pre>\n\n<p><strong>Ref:http://explainextended.com/2009/10/23/mysql-order-by-limit-performance-late-row-lookups/</strong></p>\n\n<p>Now how to optimize this piece of code in a similar way</p>\n\n<pre><code>SELECT  id, value, LENGTH(stuffing)\nFROM  t_limit where value&gt;100 ORDER BY id LIMIT 150000, 10\n</code></pre>\n"},{"tags":["query","left-join","distinct"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12605948,"title":"Left or right outer join for a query","body":"<p>I have this query:</p>\n\n<pre><code>SELECT  DISTINCT \n        u.id, \n        u.name, \n        n.network_id, \n        n.perm \nFROM    users as u RIGHT OUTER JOIN \n        nets_permissions as n ON u.id = n.user_id AND n.perm&lt;&gt; 3 \nWHERE   u.id!=3\n</code></pre>\n\n<p>and the result is this:</p>\n\n<pre><code>id  name    network_id  perm\n1   Luca Niccolini  9124823324095   1\n2   Irene Pippo 9124823324095   0\n2   Irene Pippo 1234567812345678124 1\n</code></pre>\n\n<p>Now I want that the result of the query is:</p>\n\n<pre><code>id  name    network_id  perm\n1   Luca Niccolini  9124823324095   1\n2   Irene Pippo 9124823324095   0\n</code></pre>\n\n<p>Infact I want to grant the permission on a net to some users. This users can already have a permission on the net, but also on other nets. So in this case the user Luca has only the permission on the net 9124823324095, but the user Irene has two permissions, on two different nets. I want grant the permissions on the net 9124823324095, so I don't want the third record. </p>\n\n<p>But I can't filter with the net id, because i could have a user that have a permission on other nets, but not on my net. </p>\n\n<p>In other words I would that\n-for users that have two or more record in the query, I can take only the record of my net\n-for users with only a record I can take that record.</p>\n\n<p>It's difficult to explain. Thank you for your help!</p>\n"},{"tags":["mysql","query","foreign-keys","relationship","cardinality"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12618285,"title":"How to determine cardinality of foreign key using mysql","body":"<p>I am stuck in a problem where i have to find cardinality of a relationship between tables using mysql. Following this post <br /> <a href=\"http://stackoverflow.com/questions/273794/mysql-how-to-determine-foreign-key-relationships-programmatically\">MySQL: How to determine foreign key relationships programmatically?</a> <br />\nI have found all tables related to my table and the columns which are foreign key. Now i also want to find the cardinality of relationship i.e. one-to-one, one-to-many or many-to-many. Any ideas or snippets would be highly appreciated</p>\n"},{"tags":["database","query","mongodb","count","pymongo"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":757,"score":1,"question_id":4415514,"title":"In MongodB's pymongo, how do I do a count()?","body":"<pre><code>for post in db.datasets.find({\"test_set\":\"abc\"}).sort(\"abc\",pymongo.DESCENDING).skip((page-1)*num).limit(num):\n</code></pre>\n\n<p>This is my current code.</p>\n\n<p>How do I get the count() ?</p>\n"},{"tags":["query","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12520135,"title":"MongoDB $all/$elemMatch woes","body":"<p>I'm wondering if anyone else have run into this problem in MongoDB.</p>\n\n<p>I'm trying to search an array inside another array with <code>$elemMatch</code> and then see if a nested value inside of this document, is in an array of values I provide.</p>\n\n<p>Below there is a simple example:</p>\n\n<pre><code>db.p.insert({v: [{o: [{s: {e: [\"M\"] }} ]} ]});\ndb.p.findOne({\"v.o\": {\"$all\": [{\"$elemMatch\": {\"s.e\": {\"$in\": [\"M\"]}}}]}});\nnull\n</code></pre>\n\n<p>Note, the reason for the <code>$all</code> statement is that I want to be able to match several different fields, where each field doesn't necessarily exist on the documents in the array.</p>\n"},{"tags":["mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12620893,"title":"Compare time From DateTimeField-Mysql Quey","body":"<p>I have one table with field \"CreatedTime\" as datetime fileld(eg:2012-09-18 13:01:33).I want to fetch all the rows in that table with CreatedTime as \"AM\"(ie Before 12).How can i write a query for this??   </p>\n"},{"tags":["database","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12620605,"title":"Oracle WHERE clause performance","body":"<p>I have a statement similar to ; </p>\n\n<pre><code>SELECT tableA A, tableB B, tableC C\nWHERE a.ID = b.ID and \nC.level = '2'\n</code></pre>\n\n<p>If i perform </p>\n\n<pre><code>SELECT tableA A, tableB B, tableC C\nWHERE a.ID = b.ID and \n</code></pre>\n\n<p>My results are returned in 33 seconds. If i perform the original query the results are returned in 150 seconds. Why does <code>C.level = '2'</code> make it slower?</p>\n"},{"tags":["java","query","database-connection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":219,"score":-1,"question_id":9688952,"title":"Random Number Guessing Game - Player Logging","body":"<p>I was creating this Random Number Guessing Game and found out that I needed to store the username, time and date that user played, and his score.</p>\n\n<p>Here's the code I wrote regarding this logic I'm trying to create:</p>\n\n<p>This is the codes for the connection:</p>\n\n<pre><code>Connection cn=null;\nResultSet rs=null;\nStatement stat=null;\nStatement statement=null;\n</code></pre>\n\n<p>The insert statement im using:</p>\n\n<pre><code>            int ok;\n            try\n            {\n                ok=statement.executeUpdate(\"INSERT INTO Table1(Player_name,Play_date, Player_score) VALUES(\"+'\"'+username+\",\"+datetime+\",\"+scoretodb+'\"'+\")\");\n            }catch(SQLException bleh){}\n</code></pre>\n\n<p>And here's the Connection function im using:</p>\n\n<pre><code>public void setConnection()\n    {\n        try\n        {\n            try\n            {\n                Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n                cn=DriverManager.getConnection(\"jdbc:odbc:db1\");\n                stat=cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);\n                rs=stat.executeQuery(\"Select Player_name,Play_date,Player_score from Table1\");\n                rs.next();\n            }catch(ClassNotFoundException cnfe){}\n        }catch(SQLException sqle){}\n    }\n</code></pre>\n\n<p>The logic I'm trying to make here is that in every button click of the button I made for the purpose of writing a new record into my db which contains the following fields:</p>\n\n<pre><code>Player_name, Play_date, Play_score\n</code></pre>\n\n<p>which obviously requires the players' username, date and time when he played, and his/her score.</p>\n\n<p>But when I executed the query stated above(code), and click the button assigned for writing a new record, the button kind of sticks to the panel(which obviously is a sign for an error which im still thinking of what kind it might be) and the database doesn't have the values I have entered. By the way, my db is already connected to my program. and the username comes from a JTextField = txtuser, the date/time comes from the following code:</p>\n\n<pre><code>DateFormat dateFormat = new SimpleDateFormat(\"yyyy/MM/dd HH:mm:ss\");\n    //get current date time with Date()\n    Date date = new Date();\n</code></pre>\n\n<p>and the users' score comes from userscore=Integer</p>\n\n<p>How can I make it write a new record into my db? Is that possible with the code I've provided on this question?</p>\n"},{"tags":["php","mysql","query","limit"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":192,"score":1,"question_id":10415478,"title":"UPDATE query is not working with LIMIT","body":"<p>hi i am using an UPDATE query with limit 0,1 where i have to update the first row which matches the condition which i m giving in the query</p>\n\n<pre><code>mysql_query(\"UPDATE `product_option` SET `input_value`='$color_a',`input_price`='$color_price_a' WHERE `product_id`='$_REQUEST[pid]' and `input_type`='option' LIMIT 0,1\"); \n</code></pre>\n\n<p>in my sql table the $_request[pid] is repeating many times so on that rows in which $_request[pid] is matching, i want to update the first row on it but this query is not doing any thing the data is still same which i have added.</p>\n\n<p>any suggestion will be appreciated</p>\n\n<p>here is the image of the table</p>\n\n<p><img src=\"http://i.stack.imgur.com/T8e91.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","query","plsql","case","alias"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12619970,"title":"Can you give each case statement a column alias? SQL, pl/sql","body":"<p>I am trying to do a query where it counts the number of prorata, complete and random results in a column and displays them in 3 seperate columns counted.</p>\n\n<p>So far I am trying:</p>\n\n<pre><code>SELECT ot.ort_method,\nCASE ot.ort_method\n  WHEN 'PRORATE' THEN '1' AS 'Pro_Rata'\n  WHEN 'COMPLETE' THEN '2' AS 'Complete'\n  WHEN 'RANDOM' THEN '3' AS 'Random'\nEND\nFROM orders o, order_tranches ot\nWHERE o.ord_deal_code = 'EM0004357P';\n</code></pre>\n\n<p>Which doesn't work. Does anybody know how to do it?</p>\n"},{"tags":["php","xml","query","xpath"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":925,"score":1,"question_id":3122166,"title":"xpath query to xpath result of query","body":"<p>for example we have this xml:</p>\n\n<pre><code>&lt;body&gt;\n        &lt;a&gt;\n            &lt;b&gt;\n                &lt;c&gt;hello&lt;/c&gt;\n                &lt;c&gt;world&lt;/c&gt;\n            &lt;/b&gt;\n        &lt;/a&gt;\n        &lt;a&gt;\n            &lt;b&gt;\n                &lt;c&gt;another hello&lt;/c&gt;\n                &lt;c&gt;world&lt;/c&gt;\n            &lt;/b&gt;\n        &lt;/a&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>by Xpath query we can find all \"B\"-tags. But then we need to find all \"C\"-tags in every found \"B\"-tag.\nI wrote this code:</p>\n\n<pre><code>$dom = new DOMDocument();\n$dom-&gt;loadXML($xml);\n\n$xpath = new DOMXPath($dom);\n$btags = $xpath-&gt;query(\"//b\");\n\nforeach ($btags as $b)\n{\n  $ctags = $xpath-&gt;query(\"/b/c\", $b);\n      foreach ($ctags as $c) {\n        echo $c-&gt;nodeValue;\n      }\n\n}\n</code></pre>\n\n<p>But it doesn't work. \nIt possible to do this with XPath query's?</p>\n"},{"tags":["database","query","sqlite","filter","base64"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":383,"score":4,"question_id":6246538,"title":"Base64 in SQLite?","body":"<p>Is there something like</p>\n\n<pre><code>SELECT * FROM foo WHERE base64(bar) LIKE '%bararar%'\n</code></pre>\n\n<p>in SQLite?</p>\n\n<p>If not, are there other compareable functions in other SQL-style databases? (MySQL, MSSQL and so on)</p>\n\n<p>I really need to know this because I have a huge database where some base64-encodings of strings contain a specific character which I have to filter out. Hope someone can help me.</p>\n"},{"tags":["database","query","pig","piglatin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12146948,"title":"In Pig, finding complement of entries in a table","body":"<p>I have a table <code>A</code> which contains a list, a table <code>B</code> which contains a sub-list of the items in <code>A</code>. How should get a table <code>C</code> which contains a list which is the complement of <code>B</code> in <code>A</code>?</p>\n\n<p>I know how to do it in sql. Am not sure how to approach it in Pig.</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","performance","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12617750,"title":"MySQL select in join clause scanning too many rows","body":"<p>Oke guys, the following has been bugging me all day:</p>\n\n<p>I use the query below to select an overview of products and prices including the latest result-price based on field StartTime from another table (tresults). To do this I thought I would need a subselect in the join.</p>\n\n<p>The problem is that the EXPLAIN function is telling me that MySQL is scanning ALL result rows (225000 rows) not using any index.</p>\n\n<p>Is there some way I can speed this up? Preferably by adding a WHERE statement to have mysql look only at the rows with the corresponding pID's.</p>\n\n<pre><code>select p.pID, brandname, description, p.EAN, RetailPrice, LowestPrice, min(price), min(price)/lowestprice-1 as afwijking\nfrom tproducts p\n    join ( \n    select Max(tresults.StartTime) AS maxstarttime, tresults.pID\n    from tresults\n    -- maybe adding a where clause here?\n    group by tresults.pID\n    ) p_max on (p_max.pID = p.pID)\njoin tresults res on (res.starttime = p_max.maxstarttime and p.pID = res.pID and res.websiteID = 1)\njoin tsupplierproducts sp on (sp.pID = p.pID AND supplierID = 1)\njoin tbrands b on (b.brandID = p.BrandID)\ngroup by p.pID, brandname, description, p.EAN, RetailPrice, LowestPrice\n</code></pre>\n\n<p>Indexes are on all columns that are part of joins or where clauses.</p>\n\n<p>Any help would be appreciated. Thanks!</p>\n"},{"tags":["java","query","jdo","datanucleus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12457906,"title":"Can I stream query results using JDO?","body":"<p>I want to export all Objects (rows) in my database. They don't fit into memory at once, so I want to stream them instead of fetching all at once. Which approach has a low memory footprint? Does JDO (Datanucleus implementaion) support streaming?</p>\n\n<p>In another project I was able to do it using a jdbc ResultSet and a fetchsize of 100. However I'd like to use JDO's mapping if possible, rather than a plain JDBC implmenetation.</p>\n\n<p>Edit: I forgot to say: I use a strong cache for the PersistenceManager, can I disable it? The data is readonly anyway, no need to keep it.</p>\n\n<p>Edit: query code:</p>\n\n<p>Service method that calls the Repository Method is annotated with Springs @Transactional(readonly=true)annotation, persistenceManagerFactory is a Spring proxy, try-catch-finally handling omitted, level1 cache as already said is strong:</p>\n\n<pre><code>public class MyRepository extends AbstractRepository&lt;MyItem&gt; {\n    public Collection&lt;MyItem&gt; retrieve(Object value) {\n        return query(\"myfiel==:myvalue\",value)\n    }\n}\n\npublic class AbstractRepository&lt;T&gt; {\n    private Class&lt;T&gt; type;\n    private PersistenceManagerFactory persistenceManagerFactory;\n\n    public Collection&lt;T&gt; query(String query, Object value) {\n        return createManager().newQuery(type, query).execute(value);\n    }\n\n    public PersistenceManager createManager() {\n        return persistenceManagerFactory.getPersistenceManager();\n    }\n}\n</code></pre>\n"},{"tags":["c++","sql","oracle","query","odbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12617550,"title":"Empty blob insert query in ODBC c ++ (oracle)","body":"<p>I need to insert a blob in o oracle database. I am using c++ and ODBC library.\nI am stucked at the insert query and update query .It is abstract for me how to make an blob insert query.\nI know how to make an query for a non blob column.\nMy table structure is :</p>\n\n<pre><code>REATE TABLE t_testblob (\n     filename VARCHAR2(30) DEFAULT NULL NULL,\n     apkdata  BLOB         NULL\n)\n</code></pre>\n\n<p>I found an exemple on insert and update :</p>\n\n<pre><code> INSERT INTO table_name VALUES (memberlist,?,memberlist)\n UPDATE table_name SET ImageFieldName = ? WHERE ID=yourId\n</code></pre>\n\n<p>But these structure of querys or abstract to me . What should memberlist be ? why is there \"?\" where are the values to be inserted ? </p>\n"},{"tags":["asp.net-mvc","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":65,"score":-3,"question_id":12602939,"title":"MVC3 The model item passed into the dictionary ienumerable","body":"<p>I have a database of diffrent products and they have all an attribut(column) CATEGORY in a database (name,price,dimenison,category...) Example: TV is in a category Electronic devices, Bike is in a category Transport and so on. Whit this query I would like to group all producst by categories so that I can generate a dynamic MENU. When someone click on a menu on Electronic devices all devices in database that are in this categroy are shown.<br><br> MENU:<br>\n ELECTORNIC DEVICES <br>\n TRANSPORT<br>\n STORAGE<br>\n MEDICAL<br>\n DEVICES<br>\n .......<br>\n ......<br>\n ...<br>\n ..<br></p>\n\n<p>I need to make SQL query to get all categories from database throuhgt VIEWS QBLAGO_tbl_kontrolaZavod in MSSQL SERVER . How can I make QBLAGO_tbl_kontrolaZavod IEnumerable when I made GroupBy and Where statement on it or how can transform Igrouping to IEnumerable?</p>\n\n<p>When i use:</p>\n\n<p>var model = from r in db.QBLAGO_tbl_kontrolaZavod.Distinct()</p>\n\n<p>no Errors are shown but when i want to GroupBy </p>\n\n<p>var model = from r in db.QBLAGO_tbl_kontrolaZavod.GroupBy(...) error is shown.</p>\n\n<p>My Select query that i want to transform into Linq</p>\n\n<pre><code>SELECT zzc_skupinaMTP,naziv_skupineMTP\n     FROM MTP.dbo.QBLAGO_tbl_kontrolaZavod\n     where zzc_skupinaMTP is not null\n     group by zzc_skupinaMTP,naziv_skupineMTP\n     order by zzc_skupinaMTP \n</code></pre>\n\n<p>My Controller</p>\n\n<pre><code>    [ChildActionOnly]\n    public ActionResult KategorijaMeni()\n    {\n     /* that works but not  as i want.  */\n        var model = from r in db.QBLAGO_tbl_kontrolaZavod.Distinct() \n        select r;     \n\n       /* that is what would i like to do call with linq query */\n   var model2 = from r in db.QBLAGO_tbl_kontrolaZavod.Where(r =&gt; r.zzc_skupinaMTP !=null).GroupBy(r =&gt; r.naziv_skupineMTP &amp;&amp; r =&gt; r.zzc_skupinaMTP)\n           select new QBLAGO_tbl_kontrolaZavod {\n\n         naziv_skupineMTP = r.naziv_skupineMTP\n         zzc_skupinaMTP = r.zzc_skupinaMTP\n                                }\n\n         return PartialView(model2);\n    }\n</code></pre>\n\n<p>Showing Error</p>\n\n<p>The model item passed into the dictionary is of type 'System.Data.Entity.Infrastructure.DbQuery<code>1[System.Linq.IGrouping</code>2[System.String,MTP.Models.QBLAGO_tbl_kontrolaZavod]]', but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable`1[MTP.Models.QBLAGO_tbl_kontrolaZavod]'.</p>\n\n<p>My View</p>\n\n<pre><code>@model IEnumerable&lt;MTP.Models.QBLAGO_tbl_kontrolaZavod&gt;\n\n&lt;ul id=\"categories\"&gt;\n    @foreach (var genre in Model)\n    {\n        &lt;li&gt; @Html.ActionLink(genre.naziv_skupineMTP , \"Iskanje\", new { kategorija = genre.zzc_skupinaMTP }) &lt;/li&gt;\n    }\n&lt;/ul&gt;\n</code></pre>\n"},{"tags":["database","query","sqlite","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12616078,"title":"select attributes which are a substring of a constant","body":"<p>I am faced with a database (sqlite specifically) query that I am not sure how to approach.</p>\n\n<p>I am looking for all tuples who's name attribute is a substring of some provided constant.</p>\n\n<p>For example it is a database containing food items.  If the constant is \"Maranatha Natural Almond Butter 26oz Lightly Roasted\"  I would like any tuple in the database that contains the words \"Almond Butter\", \"Maranatha Natural\", etc to be returned as matches.</p>\n\n<p>I really am at a loss for how to approach this problem efficiently and any help would be greatly appreciated.</p>\n"},{"tags":["mysql","sql","query","join","data-modeling"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":81,"score":-2,"question_id":12615662,"title":"Ignore repeated rows with SELECT statement","body":"<p>I have a table like below.</p>\n\n<p>One table for storing fruits and one for its type.</p>\n\n<pre><code>create table fruits(fruit_id int, fruit_name VARCHAR(255));  \ncreate table type(fruit_id int, status VARCHAR(255));\n\nINSERT INTO fruits(fruit_id, fruit_name) \n            values(101, 'Apple'),\n                  (102, 'Mango'),\n                  (103, 'Lemon'),\n                  (104, 'Grape'),\n                  (105, 'Orange');\n\nINSERT INTO type(fruit_id, status) \n          values(101, 'Edible');\n                (101, 'Sweet'),\n                (102, 'Edible'),\n                (103, 'Edible'),\n                (103, 'Salty'),\n                (103, 'Sour'),\n                (104, 'Sour');\n</code></pre>\n\n<p>Now I want a output like below</p>\n\n<pre><code>  Fruit_id    FruitName\n    101       Apple\n    102       Mango\n    103       Lemon\n    104       Grape \n</code></pre>\n\n<p>I used <code>INNER JOIN</code> but its getting repeated rows for apple, lemon and Grapes</p>\n\n<pre><code>SELECT fruits.* \nFROM fruits INNER JOIN type \nON type.fruit_id = fruits.fruit_id\n</code></pre>\n"},{"tags":["mysql","query","delete","substr"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12616210,"title":"MYSQL DELETE rows in query with substr","body":"<p>I would like to remove rows table1.name from table where table1.name starts with 'product-'</p>\n\n<pre><code>mysql_request(\"DELETE FROM table1 WHERE substr(name, 0, 8) = 'product-'\");\n</code></pre>\n\n<p>It's very rediculous but this query doesn't work at all. Any ideas how to make it?</p>\n"},{"tags":["php","mysql","query","multiple"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12615943,"title":"how can I avoid to many OR statements in a mysql query?","body":"<p>I am writing a code, where I have to produce a query with many OR statements, and I think there is a more comfortable way to this than:</p>\n\n<pre><code>   foreach ($plz as &amp;$value) {\n    if(empty($i)){\n        $query = \"WHERE plz='$value'\";\n    }else{\n        $query = \"$query OR plz='$value'\";\n    }\n    $i++;\n}\n$sql = mysql_query(\"SELECT * FROM table $query);\nwhile($data = mysql_fetch_array($sql)){\n//do something\n}\n</code></pre>\n\n<p>Thanks for your attention! </p>\n"},{"tags":["query","mdx","period"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12591170,"title":"MDX parallel period for last week's sales data","body":"<p>I have a weird problem. I want to run a sales comparison between this week and last week in our cube. When I used the mdx query below, if gives this week's sales properly. But it didn't give the last week's sales from  [Measures].[Net Sales Last Week]. Any suggestions? </p>\n\n<pre><code>with\nmember [Measures].[Net Sales Last Week] \nas (\n(ParallelPeriod([Date].[Calendar].[Week],1,[Date].[Calendar].[Week].currentmemeber),[Measures].[Ticket Net Sales])\n) \nselect non empty {\n    [Measures].[Net Sales Last Week]\n    ,[Measures].[Ticket Net Sales]\n} on 0,\n\nnon empty  {\n( \n    strtomember(\"[Date].[Fiscal Year].&amp;[\"+Format(NOW(),\"yyyy\")+\"]\")\n    ,strtomember(\"[Date].[Week Of Year].[\" + right(cstr(datepart (\"ww\", Now())),2) + \"]\")\n,[Date].[Week Of Period Name].[Week Of Period Name] \n,[Date].[Day Of Week Name].[Day Of Week Name]\n,[Date].[Day Of Week].[Day Of Week]\n,[Date].[Date].[Date]\n\n)} \non 1\nfrom spbi\n</code></pre>\n"},{"tags":["database","algorithm","query","search","storage"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12596045,"title":"Algorithms and data structures for 'tag' or key word based query on large data set?","body":"<p>I am trying to implement a storage system to support tagging on data. A very simple application of this system is like questions on Stackoverflow, which are tagged with multiple tags. And a query may consist of multiple tags. This also looks like search on Google with multiple key words. </p>\n\n<p>The data set maintained by this system will be very large, like several or tens of terabytes with billions of entries.</p>\n\n<p>So what data structures and algorithms should I use in this system for maintaining and query data? And the data may be stored across a cluster of machines.</p>\n\n<p>Are there any guide or papers to describe such problem and solutions?</p>\n"},{"tags":["asp.net","sql","linq","query","join"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":12610600,"title":"Consolidating values from multiple tables","body":"<p>I have an application which has data spread accross 2 tables.</p>\n\n<p>There is a main table Main which has columns - Id , Name, Type.\nNow there is a Sub Main table that has columns - MainId(FK),  StartDate,Enddate,city\nand this is a 1 to many relation (each main can have multiple entries in submain).</p>\n\n<p>Now I want to display columns Main.Id, City( as comma seperated from various rows for that main item from submain), min of start date(from submain for that main item) and max of enddate( from sub main).</p>\n\n<p>I thought of having a function but that will slow things up since there will be 100k records. Is there some other way of doing this. btw the application is in asp.net. Can we have a sql query or some linq kind of thing ?</p>\n"},{"tags":["query","nhibernate","composite-key"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12101376,"title":"Using NHibernate to retrieve a set of records with a single query and composite keys","body":"<p>I am using Nhibernate and it's mapping-by-code flavour to retrieve a set of records using a list of composite keys. I am using composite keys like this:</p>\n\n<pre><code>public class PersonAccountKey : IKey\n{\n        public virtual string PersonId { get; set; }\n        public virtual string AccountNo{ get; set; }\n\n        public override bool Equals(object obj)\n        {\n            if (obj == null)\n                return false;\n            var t = obj as PersonKey;\n            if (t == null)\n                return false;\n            if (PersonId == t.PersonId &amp;&amp; AccountNo == t.AccountNo)\n                return true;\n            return false;\n        }\n        public override int GetHashCode()\n        {\n            return (PersonId).GetHashCode() + \"|\" + (AccountNo).GetHashCode();\n        }\n}\n</code></pre>\n\n<p>With a list of PersonAccountKey objects, I am trying to get NHibernate to send a single query down to database. I would imagine the query would look like this:</p>\n\n<pre><code>Select PersonId, AccountNo, AccountNickName \nFrom PersonAccount \nWhere (PersonId = '11' and AccountNo = '10001111') \nor (PersonId = '22' and AccountNo = '10001150')\n</code></pre>\n\n<p>I'm not sure how to achieve this? I tried to use Criteria with composite keys, but I don't think it was meant to be used together. I am trying now Linq 2 NHibernate but am not really getting anywhere either.</p>\n\n<p>Ideally, I would like a method that would take a IEnumerable of keys such as <code>Session.Get&lt;T&gt;(IEnumerable&lt;object&gt;)</code>, but this doesn't exist from my searching.</p>\n\n<p>Is this possible out of the box with NHibernate?</p>\n\n<p>Cheers.</p>\n"},{"tags":["mysql","sql","query","optimization","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12500180,"title":"MySQL Query Optimization for complex query","body":"<p>I am working with an existing site and I came across the following MySQL query that needs optimization:</p>\n\n<pre><code>select\n    mo.mmrrc_order_oid,\n    mo.completed_by_email,\n    mo.completed_by_name,\n    mo.completed_by_title,\n    mo.order_submission_oid,\n    mo.order_dt,\n    mo.center_id,\n    mo.po_num_tx,\n    mo.mod_dt,\n    ste_s.state_cd,\n    group_concat(distinct osr.status_cd order by osr.status_cd) as test,\n    case group_concat(distinct osr.status_cd order by osr.status_cd)\n        when 'Fulfilled' then 'Fulfilled'\n        when 'Fulfilled,N/A' then 'Fulfilled'\n        when 'N/A' then 'N/A'\n        when 'Pending' then 'Pending'\n        else 'In Process'\n    end as restriction_status,\n    max(osr.closed_dt) as restriction_update_dt,\n    ot.milestone,\n    ot.completed_dt as tracking_update_dt,\n    dc.first_name,\n    dc.last_name,\n    inst.institution_name,\n    order_search.products as products_ordered,\n    mo.other_emails,\n    mo.customer_label,\n    mo.grant_numbers\nfrom\n    t_mmrrc_order mo\n    join ste_state ste_s using(state_id)\n    left join t_order_contact oc \n        on oc.mmrrc_order_oid=mo.mmrrc_order_oid and oc.role_cd='Recipient'\n    left join t_distrib_cont_instn dci using(distrib_cont_instn_oid)\n    left join t_institution inst using(institution_oid)\n    left join t_distribution_contact dc using(distribution_contact_oid)\n    left join t_order_tracking ot \n        on ot.mmrrc_order_oid=mo.mmrrc_order_oid \n            and ifnull(ot.order_tracking_oid, '0000-00-00')= ifnull(\n                (\n                select max(order_tracking_oid) \n                from t_order_tracking ot3 \n                where \n                    ot3.mmrrc_order_oid=mo.mmrrc_order_oid \n                    and ot3.completed_dt= (\n                            select max(completed_dt) \n                            from t_order_tracking ot2 \n                            where ot2.mmrrc_order_oid=mo.mmrrc_order_oid\n                        )\n                ), '0000-00-00')\n    left join t_order_strain_restriction osr \n        on osr.mmrrc_order_oid = mo.mmrrc_order_oid\n    left join order_search on order_search.mmrrc_order_oid=mo.mmrrc_order_oid\ngroup by\n    mo.mmrrc_order_oid\nLIMIT 0, 5\n</code></pre>\n\n<p>this query takes 10+ seconds to run regardless of the limit. When run without a limit, there are a total of 5,727 results and runtime is 10.624 seconds.</p>\n\n<p>With \"LIMIT 0, 5\" it took 18.47 seconds.</p>\n\n<p>I understand that there are a bunch of joins and nested selects, which is why it is so slow. Any ideas on how to optimize this without having to change the database structure?</p>\n\n<p>MySQL version: 5.0.95</p>\n\n<p>Most tables have over 10,000 records.</p>\n\n<p>This simpler query takes about 9 seconds:</p>\n\n<pre><code>select\n    mo.mmrrc_order_oid,\n    mo.completed_by_email,\n    mo.completed_by_name,\n    mo.completed_by_title,\n    mo.order_submission_oid,\n    mo.order_dt,\n    mo.center_id,\n    mo.po_num_tx,\n    mo.mod_dt,\n    dc.first_name,\n    dc.last_name,\n    inst.institution_name,\n    order_search.products as products_ordered,\n    mo.other_emails,\n    mo.customer_label,\n    mo.grant_numbers\nfrom\n    t_mmrrc_order mo\n    join ste_state ste_s using(state_id)\n    left join t_order_contact oc \n        on oc.mmrrc_order_oid=mo.mmrrc_order_oid and oc.role_cd='Recipient'\n    left join t_distrib_cont_instn dci using(distrib_cont_instn_oid)\n    left join t_institution inst using(institution_oid)\n    left join t_distribution_contact dc using(distribution_contact_oid)\n    left join t_order_strain_restriction osr \n        on osr.mmrrc_order_oid = mo.mmrrc_order_oid\n    left join order_search on order_search.mmrrc_order_oid=mo.mmrrc_order_oid\ngroup by mo.mmrrc_order_oid\nlimit 0,5\n</code></pre>\n\n<p>I suppose the grouping slows it down the most. In this case, without grouping takes only 0.17 seconds. Any help would be appreciated. Thanks.</p>\n\n<p>Additional details - here is what EXPLAIN gives me for the first query:\n<a href=\"http://i.stack.imgur.com/RmxmT.png\" rel=\"nofollow\">View Image</a>\n<img src=\"http://i.stack.imgur.com/RmxmT.png\" alt=\"enter image description here\"></p>\n\n<p>I found that order_search is a view that is causing most of the slow down. The query for the view is:</p>\n\n<pre><code>SELECT \n    t_oi.mmrrc_order_oid AS mmrrc_order_oid,\n    group_concat(t_im.icc_item_code separator ',') AS products\nFROM \n    t_order_item t_oi\n    JOIN t_item_master t_im on t_oi.item_master_oid = t_im.item_master_oid\n    JOIN t_strain_archive on t_im.strain_archive_oid = t_strain_archive.strain_archive_oid\nWHERE t_oi.item_status_cd IN (_utf8'Active',_utf8'Modified')\nGROUP BY t_oi.mmrrc_order_oid\nORDER BY t_im.icc_item_code\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":12465790,"title":"MySQL Query Where NOT","body":"<p>How would I create a MySQL query like this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM users WHERE ip NOT '66.249.73.202' ORDER BY lastlogin DESC\n</code></pre>\n"},{"tags":["xml","query","xquery"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":11787206,"title":"XQuery Query counting","body":"<p>I'm learning XQuery for the first time and I'm running into a spot of trouble with a particular query.  </p>\n\n<p>Find the names of the Makers who produce at least two PC's with speed of at least 2.00.</p>\n\n<p>I've gotten the Speed&lt;=2.00 part of the query down pat, but I can't quite figure out how to group this by number of occurrences.</p>\n\n<p>Attempt: (outputs nothing)</p>\n\n<pre><code>let $doc := doc(\"PC.xml\")\nfor $x in $doc/Products/Maker/PC\nwhere $x/Speed&gt;=2.00 and count($x)&gt;=2\nreturn $x/../@name\n</code></pre>\n\n<p>PC.xml:</p>\n\n<pre><code>&lt;Products&gt;\n    &lt;Maker name = \"A\"&gt;\n        &lt;PC model = \"1001\" price = \"2114\"&gt;\n            &lt;Speed&gt;2.66&lt;/Speed&gt;\n            &lt;RAM&gt;1024&lt;/RAM&gt;\n            &lt;HardDisk&gt;250&lt;/HardDisk&gt;\n        &lt;/PC&gt;\n        &lt;PC model = \"1002\" price = \"995\"&gt;\n            &lt;Speed&gt;2.10&lt;/Speed&gt;\n            &lt;RAM&gt;512&lt;/RAM&gt;\n            &lt;HardDisk&gt;250&lt;/HardDisk&gt;\n        &lt;/PC&gt;\n        &lt;Laptop model = \"2004\" price = \"1150\"&gt;\n            &lt;Speed&gt;2.00&lt;/Speed&gt;\n            &lt;RAM&gt;512&lt;/RAM&gt;\n            &lt;HardDisk&gt;60&lt;/HardDisk&gt;\n            &lt;Screen&gt;13.3&lt;/Screen&gt;\n        &lt;/Laptop&gt;\n        &lt;Laptop model = \"2005\" price = \"2500\"&gt;\n            &lt;Speed&gt;2.16&lt;/Speed&gt;\n            &lt;RAM&gt;1024&lt;/RAM&gt;\n            &lt;HardDisk&gt;120&lt;/HardDisk&gt;\n            &lt;Screen&gt;17.0&lt;/Screen&gt;\n        &lt;/Laptop&gt;\n    &lt;/Maker&gt;\n    &lt;Maker name = \"E\"&gt;\n        &lt;PC model = \"1011\" price = \"959\"&gt;\n            &lt;Speed&gt;1.86&lt;/Speed&gt;\n            &lt;RAM&gt;2048&lt;/RAM&gt;\n            &lt;HardDisk&gt;160&lt;/HardDisk&gt;\n        &lt;/PC&gt;\n        &lt;PC model = \"1012\" price = \"649\"&gt;\n            &lt;Speed&gt;2.80&lt;/Speed&gt;\n            &lt;RAM&gt;1024&lt;/RAM&gt;\n            &lt;HardDisk&gt;160&lt;/HardDisk&gt;\n        &lt;/PC&gt;\n        &lt;Laptop model = \"2001\" price = \"3673\"&gt;\n            &lt;Speed&gt;2.00&lt;/Speed&gt;\n            &lt;RAM&gt;2048&lt;/RAM&gt;\n            &lt;HardDisk&gt;240&lt;/HardDisk&gt;\n            &lt;Screen&gt;20.1&lt;/Screen&gt;\n        &lt;/Laptop&gt;\n        &lt;Printer model = \"3002\" price = \"239\"&gt;\n            &lt;Color&gt;false&lt;/Color&gt;\n            &lt;Type&gt;laser&lt;/Type&gt;\n        &lt;/Printer&gt;\n    &lt;/Maker&gt;\n    &lt;Maker name = \"H\"&gt;\n        &lt;Printer model = \"3006\" price = \"100\"&gt;\n            &lt;Color&gt;true&lt;/Color&gt;\n            &lt;Type&gt;ink-­-jet&lt;/Type&gt;\n        &lt;/Printer&gt;\n        &lt;Printer model = \"3007\" price = \"200\"&gt;\n            &lt;Color&gt;true&lt;/Color&gt;\n            &lt;Type&gt;laser&lt;/Type&gt;\n        &lt;/Printer&gt;\n    &lt;/Maker&gt;\n&lt;/Products&gt;\n</code></pre>\n"},{"tags":["c#","sql","query","webmatrix"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":12610801,"title":"Why does my SQL query select all rows when comparing date after casting?","body":"<p>I am using WebMatrix with SQL Server Compact, and just have a simple question.  I have a line of code:</p>\n\n<pre><code>if(cndDateLastModified==\"gteq\"){stringCompiler+=\"'CAST(DateLastModified AS datetime)' &gt;= 'CAST(\" + DateLastModified + \" AS datetime)' \";}////\n</code></pre>\n\n<p>By plotting the output on the screen the query specifically looks like:</p>\n\n<pre><code>SELECT * FROM POITable WHERE 'CAST(DateLastModified AS datetime)' &gt;= 'CAST(09/25/2012 AS datetime)'\n</code></pre>\n\n<p>For some reason, it returns all rows before, on, and after the date specified.\nI'm still a little green when it comes to querying, but by all researched accounts, this should work.  Clearly it is doing something I don't quite expect, which is understandable, considering.</p>\n\n<p>Any ideas on how I can get this to work the way I want it?  Is it still trying to compare strings or some other format?</p>\n\n<p>Note:  I did try this with CONVERT(datetime, DateLastModified) and CONVERT(datetime, DateLastModified, 1) for both conversions.</p>\n\n<p>Another Note:  It is stored in the database as a string.</p>\n\n<p>Another Note:  If I switch the condition (from >= to &lt;=) it does the opposite and returns no rows, which I would kind of expect considering the first unexpected result set, but still don't know why.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["mysql","regex","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12610069,"title":"How can I identify duplicate data in 3 different columns within the same row and delete second set of duplicate data?","body":"<p>I have a data set that looks something like this:</p>\n\n<pre><code>ID | ItemName  | Category1 | Category2 | Category3\n1  |  HALv1    | Computer  | Computer  | AI\n2  |  HALv2    | Computer  | AI        | AI\n3  |  HALv3    | AI        | AI        | AI\n</code></pre>\n\n<p>Ideally I need it to look like this:</p>\n\n<pre><code>ID | ItemName  | Category1 | Category2 | Category3\n1  |  HALv1    | Computer  | AI        | \n2  |  HALv2    | Computer  | AI        | \n3  |  HALv3    | AI        |           | \n</code></pre>\n\n<p>More specificaly, I need something (SQL or regular expression) that will evaluate 3 columns (like Category1, 2, 3 in the example above) in a row of data and return a row that has no duplicate values within the 3 designated columns.</p>\n\n<p>The data is currently in a .csv file, but can be easily put into a mySQL database if needed. </p>\n\n<p>Tools available are TextPad for executing regular expressions or MySQL 5.5.8 with PHPMyAdmin 3.3.9 if the solution is SQL based. Thank you in advance for your help.</p>\n"},{"tags":["php","mysql","query","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12610469,"title":"How to select rows that have a column that matches a value and fall between a date range using PHP's PDO and MySQL?","body":"<p>Can someone help me with my query below? I need to select all users who subscribe to the \"Food Specials\" newsletter (that has to be passed in through a form variable because there are different newsletter names) and have a value of \"1\" and that fall between the sign up dates that were selected in a form:</p>\n\n<pre><code>$sql = 'SELECT * FROM users WHERE :newsletter = 1 AND signed_up &lt; \":start\" AND signed_up &lt; \":end\"';\n$result-&gt;bindValue(\":newsletter\", \"food_specials\", PDO::PARAM_STR);\n$result-&gt;bindValue(\":start\", \"2012-09-01 12:00:00\", PDO::PARAM_STR);\n$result-&gt;bindValue(\":end\", \"2012-09-25 12:00:00\", PDO::PARAM_STR);\n</code></pre>\n"},{"tags":["sql","query","tsql","logic"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":12605096,"title":"Perplexing SQL statement","body":"<p>Given a table with this data:</p>\n\n<pre><code>   L    |    N\n-------------------\n   A    |    1\n   A    |    3\n   A    |    5\n   B    |    5\n   B    |    7\n   B    |    9\n   C    |    1\n   C    |    2\n   C    |    3\n</code></pre>\n\n<p>Write an elegant SQL query that achieves this:</p>\n\n<p>FIND Letters (L) that include ALL of 1, 2, and 3</p>\n\n<p>The expected outcome is obvious:\nA single row with \"C\"</p>\n\n<p>Anyone have solution?  And no, this isn't a CS homework question. Just curious how you would write a SQL query to find the solution.</p>\n\n<p>Thanks in advance,\nDaniel</p>\n"},{"tags":["linq","query","list","dictionary","ravendb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12589914,"title":"LINQ query to output key count value pairs","body":"<p>There are about half a million RavenDB documents of Customers. One of the properties is \"City\".. how can I write a LINQ query to get a list of all occurence of a each city with its count. For example, if a thousand customer documents have \"NY\" as city value, then I need a list of cities with count like NY 1000; LA 200, OR 1300 , BO 5000 etc..</p>\n\n<p>This is what I wrote initially..</p>\n\n<pre><code> Dictionary&lt;string,int&gt; cityStats = session.Query&lt;Customer&gt;()\n                    .ToList()\n                    .GroupBy(x =&gt; x.City)\n                    .OrderBy(x =&gt; x.Count())\n                    .ToDictionary(x =&gt; x.Key, x =&gt; x.Count());\n</code></pre>\n\n<p>But this does not look like its giving me accurate results.. so i changed the maximum requests allowed property (I know its not recommended) just to see if it changes the result.. but keeping maxrequest value to 500000 also brings me same result. I know for sure there are about half a million customer documents , so it needs to add up to match.</p>\n"},{"tags":["query","cakephp","authentication","login","generating"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12607258,"title":"Auth login action not generating query in CakePHP","body":"<p>It's my first question here at stackoverflow. I did a deep research in many sites but i decided that is time to ask for help. Btw, sorry for my english. Here it goes:</p>\n\n<p>I have a simple login form, just like the Cake Blog Tutorial.\nIt works like a charm when I use 'UsersController' and 'User' model naming conventions, passing the rights queries in debug.</p>\n\n<p>But when I change it to other name, Alunos in my case, it generates no QUERY and give me 'Incorrect username and/or password.'.</p>\n\n<p>My login.ctp</p>\n\n<pre><code>&lt;H1&gt; Login &lt;/H1&gt;\n\n&lt;?php\n    debug($this-&gt;data);\n    echo $this-&gt;Form-&gt;create('Aluno', array('action' =&gt; 'login'));\n    echo $this-&gt;Form-&gt;input('username');\n    echo $this-&gt;Form-&gt;input('password');\n    echo $this-&gt;Form-&gt;end('Login');\n?&gt;\n</code></pre>\n\n<p>My AppController</p>\n\n<pre><code>&lt;?php\n\nclass AppController extends Controller {\n\n    public $components = array (\n        'Session',\n        'Auth' =&gt; array (\n            'loginAction' =&gt; array ('controller'=&gt;'alunos', 'action'=&gt;'login'),\n            'loginRedirect'=&gt;array ('controller'=&gt;'alunos', 'action'=&gt;'inicio'),\n            'logoutRedirect'=&gt;array ('controller'=&gt;'alunos', 'action'=&gt;'index'),\n            'authError'=&gt;\"Ops, você não está autorizado a fazer isso.\",\n            'authorize'=&gt;array('Controller'),\n        )\n    );\n\n    public function isAuthorized($user) {\n        return true;\n    }\n\n    public function beforeFilter() {\n        $this-&gt;Auth-&gt;allow('index', 'add');\n        $this-&gt;set('logged_in', $this-&gt;Auth-&gt;loggedIn());\n        $this-&gt;set('current_user', $this-&gt;Auth-&gt;user());\n\n    }\n\n}\n</code></pre>\n\n<p>And my 'AlunosController.php' (see that its not USERSController, like common codes)</p>\n\n<pre><code>&lt;?php\n\nclass AlunosController extends AppController {  \n\n    public $name = 'Alunos';    \n\n    public function beforeFilter(){\n        parent::beforeFilter();\n    }\n\n    public function index() {}\n\n    public function login(){\n        debug($this-&gt;Auth-&gt;login());\n        if ($this-&gt;request-&gt;is('post')) {\n            if ($this-&gt;Auth-&gt;login()){\n                $this-&gt;redirect($this-&gt;Auth-&gt;redirect());\n            } else {\n                $this-&gt;Session-&gt;setFlash('Incorrect username and/or password.');\n            }\n        }\n    }\n\n    public function logout() {\n        $this-&gt;redirect($this-&gt;Auth-&gt;logout());\n    }\n\n    public function add() {\n        debug($this-&gt;Auth-&gt;login());\n            if($this-&gt;request-&gt;is('post')) { \n                if ($this-&gt;Aluno-&gt;save($this-&gt;request-&gt;data)) {\n                    $this-&gt;Session-&gt;setFlash('Cadastrado.');\n                }else {\n                    $this-&gt;Session-&gt;setFlash('Falha no cadastro.');\n                }\n            }   \n    }\n\n    public function inicio() {\n        debug($this-&gt;Auth-&gt;login());\n    }\n\n}\n\n?&gt;\n</code></pre>\n\n<p>My debug($this->data) in login.ctp result:</p>\n\n<pre><code>array(\n    'Aluno' =&gt; array(\n        'password' =&gt; '*****',\n        'username' =&gt; 'anyuser'\n    )\n)\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["django","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12605292,"title":"How can i do such query in multiple tables at the same time in django","body":"<p>I happen on some query like this below:</p>\n\n<pre><code>bphoto = B_Photo.objects.filter(q_user).order_by('-pub_date')\nbactivity = B_Activity.objects.filter(q_user).order_by('-pub_date')\nbpart = B_Part.objects.filter(q_user).order_by('-pub_date')\n</code></pre>\n\n<p>q_user is a Q object,and what i want is to sort all results in the three tables,use the 'pub_date' field.</p>\n\n<p>how can i simplify this kind of query?</p>\n"},{"tags":["javascript","query","extjs","extjs4","components"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12605986,"title":"Extjs 4: what is the proper way to retrieve components?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11872261/extjs4-1-up-down-versus-ext-getcmp\">Extjs4.1, up() down() versus Ext.getCmp()</a>  </p>\n</blockquote>\n\n\n\n<p>I worked a lot with ExtJS (always with version 4) but I still have problems to understand what is the proper way to retrieve components.</p>\n\n<p>There are many ways to do it, both global:</p>\n\n<ul>\n<li><code>Ext.getCmp ()</code></li>\n<li><code>Ext.ComponentQuery.query ()</code></li>\n</ul>\n\n<p>and internal:</p>\n\n<ul>\n<li><code>Ext.container.AbstractContainer.down ()</code></li>\n<li><code>Ext.container.AbstractContainer.up ()</code></li>\n<li><code>Ext.container.AbstractContainer.nextSibling ()</code></li>\n<li><code>Ext.container.AbstractContainer.nextNode ()</code></li>\n<li><code>Ext.container.AbstractContainer.previousSibling ()</code></li>\n<li><code>Ext.container.AbstractContainer.previousNode ()</code></li>\n<li><code>Ext.container.AbstractContainer.child ()</code></li>\n<li><code>Ext.container.AbstractContainer.findParent ()</code></li>\n<li><code>Ext.container.AbstractContainer.findParentBy ()</code></li>\n<li><code>Ext.container.AbstractContainer.query ()</code></li>\n<li><code>Ext.container.AbstractContainer.queryBy ()</code></li>\n<li><code>Ext.container.AbstractContainer.queryById ()</code></li>\n</ul>\n\n<p>Now, if I use an <strong>id</strong> for every component (like buttons, checkboxes, grids, etc) I'm sure to get them always, even if the layout of main containers change: I can do it following the global way.\nHowever, this kind of search could affect the performance of the application: honestly, I don't know how <code>Ext.getCmp ()</code> works but I think that the search is done in the whole variables namespace.</p>\n\n<p>So, this problem led me to follow occasionally the second way.\nThe problems come when I change the layout of main containers. Take the example as follows:</p>\n\n<pre><code>Ext.create ('Ext.panel.Panel', {\n    title: 'Main Container' ,\n    width: 300 ,\n    renderTo: Ext.getBody () ,\n    items: [{\n        xtype: 'textfield' ,\n        fieldLabel: 'First name'\n    } , {\n        xtype: 'textfield' ,\n        id: 'tfLastName' ,\n        fieldLabel: 'Last name'\n    } , {\n        xtype: 'checkbox' ,\n        boxLabel: 'Alive'\n    }] ,\n\n    bbar: {\n        xtype: 'toolbar' ,\n        items: [{\n            xtype: 'button' ,\n            text: 'Get CheckBox' ,\n            // Gets the checkbox starting from the second textfield (Last Name)\n            handler: function (btn) {\n                var tfLastName = Ext.getCmp ('tfLastName');\n                console.log (tfLastName.nextSibling ('checkbox'));\n            }\n        }]\n    }\n});\n</code></pre>\n\n<p>When I click <em>Get Checkbox</em> button it returns the checkbox I requested but If I change the order of <em>Main Container</em> items (suppose to put the checkbox declaration before <em>Last Name</em> textfield) it returns null, as expected.\nNow, this is <strong>the problem</strong>: I don't want to change the logic when I'm changing the view.</p>\n\n<p><strong>So, my questions are:</strong></p>\n\n<ul>\n<li><em>Does exist a function that allows me to retrieve components without the use of Ids and to leave unchanged the logic while the view is changing?</em></li>\n<li><em>Does exist a proper way to do the retrieval of components? If yes, what?</em></li>\n</ul>\n"},{"tags":["query","sql-server-ce","vb.net-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12604874,"title":"Data fetch and insert in SQL Server Compact Edition database using VB.net","body":"<p>I am new to VB.net and creating an application so that user needs login username and password.</p>\n\n<p>I am using a SQL Server Compact Edition database.</p>\n\n<p>This is my code which works perfect:-</p>\n\n<pre><code>Imports System.Data.SqlClient\nImports System.Data.SqlServerCe\n\nPublic Class frm_edit_patient\n    Dim con As New SqlCeConnection\n    Try\n        Dim SQLquery As String\n        Dim da As SqlCeDataAdapter\n        Dim ds As New DataSet\n        Dim myConString As String = My.Settings.Database1ConnectionString\n        con.ConnectionString = myConString\n        MsgBox(\"Database is now open\")\n        MessageBox.Show(\"connected\")\n    Catch ex As Exception\n        MessageBox.Show(ex.ToString)\n    End Try\nEnd Sub\n</code></pre>\n\n<p>The above code works fine and shows me <code>connected</code></p>\n\n<p>However when I add this piece of code</p>\n\n<pre><code>        SQLquery = \"SELECT id FROM user where username=John Doe\"\n        da = New SqlCeDataAdapter(SQLquery, con)\n        da = New SqlCeDataAdapter(SQLquery, con)\n        da.Fill(ds, \"db1\")\n</code></pre>\n\n<p>It gives me this exception error:-\n<img src=\"http://i.stack.imgur.com/SuYwx.jpg\" alt=\"enter image description here\"></p>\n\n<p>What does it mean? how to get the userid of that particular person?</p>\n\n<p>Also if i just put the insert query in <code>SQLquery</code>, will it work? As i have been doing this by watching few video tutorials, but further they don't have tutorials on this, also my book does not explains anything about Compact databases and as i am so far with this application dont want to switch...</p>\n"},{"tags":["query","ms-access","crosstab","relationships"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12605299,"title":"Can you use Pivot View to enter data in Microsoft Access","body":"<p>I have an application that is currently using Microsoft SQL Server Lite, however I'm building a Microsoft Access database to replace the SQL Server Lite so that I can use Pivot Table Queries. For the time being, I'm working in Microsoft Access until I get the database setup the way I want it.</p>\n\n<p>I have three tables tables, Players, Coaches, Ratings. Each coach must rate each player, therefore I have the following relationships:</p>\n\n<pre><code>Coaches --&gt; Ratings\nPlayers --&gt; Ratings\n</code></pre>\n\n<p>Each coach may only rate each player once, and I want a crosstab view that will show the players as rows and the coaches as columns so that the ratings can be entered in the cells of the table.</p>\n\n<p>Creating the crosstab query was easy enough to do, however it won't allow me to enter data in the cells. I'm pretty sure that this is happening because of the One-to-Many relationship. Each coach must rate multiple players, and each player must be rated by multiple coaches, so they must be one-to-many relationships in both cases. That said, each coach will only rate each player once.</p>\n\n<p>Is there a way to create a compound primary key, something I need to do differently in the relationships or maybe a preliminary query that would solve this?</p>\n\n<p>Thank you.</p>\n"},{"tags":["sql-server","query","schema","left-join","where-clause"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":12604057,"title":"Query ignores filtering in WHERE-clause","body":"<p>I get unexpected results from a query against a <b>Micrsoft SQL Server 2008</b> (10.0.1600.22 / Service Pack 2).</p>\n\n<p>Could it be a bug?</p>\n\n<p>I have tried to create a similar query to replicate the problem - without success. So I guess there's nothing wrong with the query itself, but something else is causing this somewhat strange behaviour.</p>\n\n<p>I hope for some suggestions on what might be causing the problem.</p>\n\n<p>First, take a look at this working example:</p>\n\n<pre><code>DROP TABLE #TempType\nDROP TABLE #TempData\n\nSELECT * INTO #TempType FROM (\n    SELECT 1 AS Id, 10 AS TempDataFK, 'Do' AS Name, 'CODE1' AS Type   UNION\n    SELECT 2 AS Id, 10 AS TempDataFK, 'Re' AS Name, 'CODE2' AS Type   UNION\n    SELECT 3 AS Id, 20 AS TempDataFK, 'Mi' AS Name, 'CODE2' AS Type   UNION\n    SELECT 5 AS Id, 10 AS TempDataFK, 'Fa' AS Name, 'CODE3' AS Type   UNION\n    SELECT 6 AS Id, 20 AS TempDataFK, 'So' AS Name, 'CODE4' AS Type\n) sub\n\nSELECT * INTO #TempData FROM (\n    SELECT 10 AS Id, 150 AS Number   UNION\n    SELECT 20 AS Id, 150 AS Number   UNION\n    SELECT 30 AS Id, 150 AS Number   UNION\n    SELECT 40 AS Id, 180 AS Number\n) sub\n\nSELECT C1.Name Name1,\n       C2.Name Name2,\n       C3.Name Name3,\n       C4.Name Name4,\n       #TempData.Id,\n       #TempData.Number\nFROM #TempData\n    LEFT JOIN #TempType C1 (NOLOCK)\n        ON #TempData.Id = C1.TempDataFK \n        AND C1.Type = 'CODE1'\n    LEFT JOIN #TempType C2 (NOLOCK)\n        ON #TempData.Id = C2.TempDataFK \n        AND C2.Type = 'CODE2'\n    LEFT JOIN #TempType C3 (NOLOCK)\n        ON #TempData.Id = C3.TempDataFK \n        AND C3.Type = 'CODE3'\n    LEFT JOIN #TempType C4 (NOLOCK)\n        ON #TempData.Id = C4.TempDataFK \n        AND C4.Type = 'CODE4'\nWHERE 1=1\n    AND (#TempData.Number = 150)\n    AND (C1.Name='Mi' OR C2.Name='Mi' OR C3.Name='Mi' OR C4.Name='Mi')\n</code></pre>\n\n<p>As you can see I'm LEFT JOINing the table <code>TempType</code> to <code>TempData</code> four times. Each time giving it a different alias. I then filter by a certain number (150) and want that at least one of the Names should be 'Mi'.</p>\n\n<p>The result is as expected:</p>\n\n<pre><code>--------------------------------------------\nName1   Name2   Name3   Name4   Id   Number\nNULL    Mi      NULL    So      20   150\n--------------------------------------------\n</code></pre>\n\n<p>Nevertheless if I run a similar query against my clients database I get:</p>\n\n<pre><code>--------------------------------------------\nName1   Name2   Name3   Name4   Id   Number\nDo      Re      Fa      NULL    10   150\nNULL    Mi      NULL    So      20   150\nNULL    NULL    NULL    NULL    30   150\n--------------------------------------------\n</code></pre>\n\n<p>It is as if the part similar to <code>(C1.Name='Mi' OR C2.Name='Mi' OR C3.Name='Mi' OR C4.Name='Mi')</code> is not used in the filtering.</p>\n\n<p><b>Different query, but same structure</b><br>\nOn the clients database the tables are not temporary and they already contain data. The tables also have various other fields, but I'm still only left joining with one other table. So same structure as above.</p>\n\n<p><b>Couldn't replicate in new database</b><br>\nI tried to replicate the problem by creating a new database with only the tables and fields affected - no succes in replicating the problem.</p>\n\n<p><b>Schemas</b><br>\nWorth mentioning also is that the clients database contain several schemas. Both tables similar to TempData and TempType belongs to the same schema (not dbo). \nAlso, the field similar to TempType.Type is a foreign key to another table in another schema, but as we're not joining with that I don't see that it would be relevant?</p>\n\n<p><b>Another peculiarity</b><br>\nIf I put C1.Name etc, as part of my SELECT, like this:</p>\n\n<pre><code>SELECT C1.Name Name1,\n       C2.Name Name2,\n       C3.Name Name3,\n       C4.Name Name4,\n       #TempData.Id,\n       #TempData.Number,\n       CASE WHEN (C1.Name = 'Mi' AND C1.Name IS NOT NULL) THEN 1 ELSE 0 END,\n       CASE WHEN (C2.Name = 'Mi' AND C2.Name IS NOT NULL) THEN 1 ELSE 0 END,\n       CASE WHEN (C3.Name = 'Mi' AND C3.Name IS NOT NULL) THEN 1 ELSE 0 END,\n       CASE WHEN (C4.Name = 'Mi' AND C4.Name IS NOT NULL) THEN 1 ELSE 0 END\n</code></pre>\n\n<p>I get the expected result against my clients database (only one row):</p>\n\n<pre><code>Name1   Name2   Name3   Name4   Id   Number   (No column name)   (No column name)   (No column name)   (No column name)\nNULL    Mi      NULL    So      20   150        0                  1                  0                  0\n</code></pre>\n\n<p><br>\n<em>Any suggestions what could be causing this?</em></p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12603677,"title":"SQL - Using the results of subquery in SELECT in the SELECT","body":"<p>Example:</p>\n\n<pre><code>SELECT\n    (\n        ...\n    ) AS imageName,\n    (\n        ...\n    ) AS imageURL,\n    CONCAT(imageName, ' ', imageURL)\n</code></pre>\n\n<p>How could I achieve this?</p>\n"},{"tags":["sql","query","ms-access","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":12603277,"title":"Transpose and aggregate SQL query in MS Access","body":"<p>Hi i'm looking for help with a query. I currently have a table that looks like this:  </p>\n\n<pre><code> BP          I/E\n\nAN02           I  \nBN02           ECN  \nEN89           ECN  \nAN02           I  \nBN02           ECC  \nEN89           ECN  \nAN02           ECC  \nBN02           ECC  \nEN89           ECN \nAN02           ECC  \nBN02           ECN  \nEN89           ECN \nAN02           I  \nBN02           I \nEN89           ECN \n</code></pre>\n\n<p>Im looking to make an SQL query that counts the number of I's, ECN's, and ECC's per BP. Hopefully a query that would look like this:  </p>\n\n<pre><code>BP    I    ECN   ECC  \n\nAN02  2    3      1\nBN02  1    6      9\nEN89  4    2      3  \n</code></pre>\n\n<p>Can anyone help? Thank You</p>\n"},{"tags":["mysql","performance","query"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12600301,"title":"MySQL: how to increase speed of a select query with 2 joins and 1 subquery","body":"<p>In a table 'ttraces' I have many records for different tasks (whose value is held in 'taskid' column and is a foreign key of a column 'id' in a table 'ttasks'). Each task inserts a record to 'ttraces' every 8-10 seconds, so caching data to increase performance is not a good idea. What I need is to select only the newest records for each task from 'ttraces', that means the records with the maximum value of the column 'time'. At the moment, I have over 500000 records in the table. The very simplified structure of these two tables looks as follows:</p>\n\n<pre><code>-----------------------\n|       ttasks        |\n-----------------------\n| id | name | blocked |\n-----------------------\n\n---------------------\n|      ttraces       |\n---------------------\n| id | taskid | time |\n---------------------\n</code></pre>\n\n<p>And my query is shown below:</p>\n\n<pre><code>SELECT t.name,tr.time\nFROM \n    ttraces tr \n    JOIN \n    ttasks t ON tr.itask = t.id \n    JOIN (\n        SELECT taskid, MAX(time) AS max_time\n        FROM ttraces \n        GROUP BY itask\n    ) x ON tr.taskid = x.taskid AND tr.time = x.max_time\nWHERE t.blocked\n</code></pre>\n\n<p>All columns used in WHERE and JOIN clauses are indexed. As for now the query runs for ~1,5 seconds. It's extremely crucial to increase its speed. Thanks for all suggestions. BTW: the database is running on a hosted, shared server and I can't move it anywhere else for the moment.</p>\n\n<p>[EDIT]\nEXPLAIN SELECT... results are:</p>\n\n<pre><code>--------------------------------------------------------------------------------------------------------------\nid   select_type   table        type     possible_keys   key       key_len   ref          rows     Extra\n--------------------------------------------------------------------------------------------------------------\n1   PRIMARY        &lt;derived2&gt;   ALL      NULL            NULL      NULL      NULL         74   \n1   PRIMARY        t            eq_ref   PRIMARY         PRIMARY   4         x.taskid     1        Using where\n1   PRIMARY        tr           ref      taskid,time     time      9         x.max_time   1        Using where\n2   DERIVED        ttraces      index    NULL            itask     5         NULL         570853   \n--------------------------------------------------------------------------------------------------------------\n</code></pre>\n\n<p>The engine is InnoDB. Thenk you.</p>\n"},{"tags":["android","query","login","sup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":11463484,"title":"Android login: Dynamic queries to retrieve data from MBO(SUP)","body":"<p>I've searched around but cant seem to find the answer that could solve my problem.\nIm trying to check that if the user login, it should check with the database &amp; navigates to the next page if the username &amp; pw matches in the database. I dont know where i went wrong because with the following codes below, im able to login even when the username &amp; password doesnt match(Username wrong whereas password is correct), but if the password is wrong(username correct or wrong doesnt matters), the error message that i set shows up.\nIs it because the password is the only one being read and username has already been overwrite? Im new to android &amp; java, so please help. Thanks alot!</p>\n\n<pre><code>$   public void run()\n                {\n                    button.setOnClickListener(new OnClickListener() {\n                        public void onClick(View v) {       \n\n                            Query query = new Query();\n                            query.select(\"x.username, x.password\");\n                            query.from(\"AccountLogin\", \"x\");\n                            AttributeTest ts = new AttributeTest();\n                            ts.setOperator(AttributeTest.EQUAL);\n                            ts.setAttribute(\"username\");\n                            ts.setValue(un.getText());\n                            ts.setAttribute(\"password\");\n                            ts.setValue(pw.getText());\n                            query.setTestCriteria(ts);\n\n\n\n                            QueryResultSet qs = FinalDB.executeQuery(query);\n                            if (!qs.isEmpty()) {\n\n                                Intent goToNextActivity = new Intent(FinalActivity.this,    HomePage.class);\n                                startActivity(goToNextActivity);\n                            } else {\n                                error.setText(\"Login failed. Username and/or password doesn't match.\");\n                            }\n                        }\n                    });\n                }\n            });\n\n        }\n\n\n    }).start();\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":10145784,"title":"How to create a relation table in MySQL?","body":"<p>I have 3 tables, <code>students</code>, <code>courses</code>, <code>enroll</code> with relation as \"students enroll in courses\"</p>\n\n<p>I have created <code>students</code> table with <code>sid</code> as primary key</p>\n\n<p>I have created <code>courses</code> table with <code>cid</code> as primary key</p>\n\n<p>Now I have to create <code>enroll</code> table which I did as follows, but it shows an error on the keyword <code>references</code>, what is the mistake ?</p>\n\n<pre><code>create table enroll(\n    grade char(2),\n    sid int not null,\n    cid int not null,\n    primary key(sid,cid),\n    foreign key cid references courses on delete cascade,\n    foreign key sid references students on delete cascade\n);\n</code></pre>\n"},{"tags":["oracle","query","types","oracle11g","precision"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12598427,"title":"Storing an ISBN in an OracleDB gives precision error?","body":"<p><strong>Why am I getting a precision error?</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO ISBN_LIST (ISBN) VALUES (9780261102354);\n</code></pre>\n\n<p>Given the table:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE ISBN_LIST ( \n    ISBN NUMBER (20,20)  NOT NULL -- NUMBER(13) also didn't work\n);\nALTER TABLE ISBN_LIST\n    ADD CONSTRAINT PK_ISBN_LIST PRIMARY KEY ( ISBN );\n</code></pre>\n\n<p>[bonus points if you recognise the ISBN!]</p>\n"},{"tags":["oracle","query","join","oracle11g","insert-update"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12597491,"title":"Update_or_insert (merge into) not working in Oracle","body":"<p><strong>What's wrong with my UPDATE_OR_INSERT code below?</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>MERGE INTO EMAIL_LIST d USING (SELECT 'foo@gmail.com' EMAIL) s\n    ON (d.EMAIL = s.EMAIL)\n        WHEN MATCHED THEN\n            UPDATE SET d.EMAIL = s.EMAIL\n        WHEN NOT MATCHED THEN\n            INSERT (EMAIL) VALUES (s.EMAIL);\n</code></pre>\n\n<p>Given the table:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE EMAIL_LIST ( \n    EMAIL VARCHAR2 (100)  NOT NULL\n);\nALTER TABLE EMAIL_LIST\n    ADD CONSTRAINT PK_EMAIL_LIST PRIMARY KEY ( EMAIL ) ;\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<blockquote>\n  <p>Error report:</p>\n  \n  <p>SQL Error: ORA-00923: FROM keyword not found where expected\n  00923. 00000 -  \"FROM keyword not found where expected\"</p>\n</blockquote>\n"},{"tags":["query","search","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":312,"score":0,"question_id":7792280,"title":"How to send boost values while querying in elastic search?","body":"<p>I need to add a search relevancy score to a particular query in elastic search.\nHow can I add a boosting score for a particular filed while querying?</p>\n"},{"tags":["sql-server","database","query","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12597047,"title":"Exceed capacity of String when working with Dynamic Pivot","body":"<p>I have walked one round on some sites and see that the (only) way to solve Dynamic Pivot is to store the query as a string, then execute that string query. But, in my case, I seem not to be able to apply this solution because the number of columns exceed the capacity of one string.</p>\n\n<pre><code>declare @columns nvarchar(max)\n\nselect @columns = COALESCE(@columns + ', ','') + QUOTENAME(name)\nfrom table1\n</code></pre>\n\n<p>Although I declare maximum capacity for @columns, it is still not enough space and causes error. \nIs there any way to work around this case, or how can I build a dynamic pivot without storing query as a string?</p>\n"},{"tags":["mysql","performance","query","tags","aggregate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12595964,"title":"How to speed up MySQL query: order by count","body":"<p>I have tried everything I could think of to speed up this query, but it still takes about 2.5 seconds.</p>\n\n<p>The table is images_tags (~4 Million Rows):\nHere is the table EXPLAIN:</p>\n\n<pre><code>Field       Type               Null     Key     Default\nimage_ids   int(7) unsigned    NO       PRI     NULL\ntags_id     int(7) unsigned    NO       PRI     NULL\n</code></pre>\n\n<p>Here are the Indexes:</p>\n\n<pre><code>Table         Non_unique  Key_name      Seq_in_index  Column_name  Collation  Cardinality  Sub_part  Packed  Null  Index_type\nimages_tags   0           PRIMARY       1             image_ids    A          NULL         NULL      NULL          BTREE\nimages_tags   0           PRIMARY       2             tags_id      A          4408605      NULL      NULL          BTREE\nimages_tags   1           image_ids     1             image_ids    A          734767       NULL      NULL          BTREE\n</code></pre>\n\n<p>And here is the query:</p>\n\n<pre><code>select image_ids\nfrom images_tags\nwhere tags_id in (1, 2, 21, 846, 3175, 4290, 6591, 9357, 9594, 14289, 43364, 135019, 151295, 208803, 704452)\ngroup by image_ids\norder by count(*) desc\nlimit 10\n</code></pre>\n\n<p>And here is the query EXPLAIN:</p>\n\n<pre><code>select_type  table        type   possible_keys  key                 key_len  ref   rows     Extra\nSIMPLE       vids_x_tags  index  join_tags_id   join_vids_id_unique  8       NULL  4408605  Using where; Using index; Using temporary; Using filesort\n</code></pre>\n\n<p>The goal is to get the 10 images that match those tags the most.\nI have tried messing around with these variables with little to no improvement:</p>\n\n<ul>\n<li>max_heap_table_size</li>\n<li>tmp_table_size</li>\n<li>myisam_sort_buffer_size</li>\n<li>read_buffer_size</li>\n<li>sort_buffer_size</li>\n<li>read_rnd_buffer_size</li>\n<li>net_buffer_length</li>\n<li>preload_buffer_size</li>\n<li>key_buffer_size</li>\n</ul>\n\n<p>Is there any way to speed up this query considerably? There are about 700K images and it's always growing, so I wouldn't want to cache the result for more than a day or 2, and it has to be done for each image, so re-caching that many queries would be impossible.</p>\n"},{"tags":["mysql","query","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12591437,"title":"Grouping results in MySQL","body":"<p>My brain is turning into tapioca trying to figure this one out. I have a table of subordinates and supervisors. Every employee has a number of course. Here's an example.</p>\n\n<p>I have three fields: \nemployee_id, name, supervisor_id</p>\n\n<p>Fred Wilkie is a supervisor and his record is ....</p>\n\n<pre><code>employee_id: 1\nname: Fred Wilkie\nsupervisor_id: NULL \n</code></pre>\n\n<p>Ted Wilkie is a lowly worker and Fred is his boss. His entry looks like this....</p>\n\n<pre><code>employee_id: 2\nname: Ted Wilkie\nsupervisor_id: 1\n</code></pre>\n\n<p>What I would like my query to look like is employee_id, name and supervisor_id but the supervisor_id should be equal to the employee_id if the supervisor_id is NULL.</p>\n\n<p>This kinda works... ( I think I just need to refine it somehow)</p>\n\n<pre><code>select employee_id, name, supervisor_id case when supervisor_id is NULL then employee_id else supervisor_id end from employees order by supervisor_id;\n</code></pre>\n\n<p>Problem with this is that it orders all of the records first where the employee_id is equal to the supervisor_id and then it just spits out the subordinates that are left.... </p>\n\n<pre><code>employee_id, name, supervisor_id\n1, Fred Wilkie, 1\n4, Gail Winston, 4\n2, Ted Wilkie, 1\n3, Lisa Wilkie, 1\n5, Russ Cablas, 4\n6, Ben Reynolds, 4\netc, etc, etc...\n</code></pre>\n\n<p>what I would like is this......</p>\n\n<pre><code>employee_id, name, supervisor_id\n1, Fred Wilkie, 1\n2, Ted Wilkie, 1\n3, Lisa Wilkie, 1\n4, Gail Winston, 4\n5, Russ Cablas, 4\n6, Ben Reynolds, 4\netc, etc, etc...\n</code></pre>\n\n<p>In the example above I have the the first supervisor (Fred) listed (employee_id = supervisor_id) and then all of his subordinates. After that is Gail, and all of her subordinates, etc. I think my group-fu is weak.</p>\n\n<p>We run a large company (250 employees) so we'd like a way to keep this in the MySQL logic. Does anyone have an idea?</p>\n\n<p>Many thanks!\nJanie</p>\n"},{"tags":["query","api","url","search","website"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12594916,"title":"Manipulating query strings in the url of websites I do not own","body":"<p>can anyone tell me if it is really frowned upon to programatically change search parameters in a url to search a website? Like if I want to search say google for say \"pizza\", from my code I could first search for say \"beer\" and then just have my code replace \"beer\" with \"pizza\". Google isn't a great example for this question but a lot of other websites don't have an api that you can use to search their website. Even when they do, it is usually to pull data into your website, whereas I would like to just open the 3rd party website using passing in a user search parameter. This method of manipulating the url usually works as long as you delete other parameters after the search word. Just hoping for some opinion on this practice and how it might be viewed in regards to typical website terms of service. Thanks and sorry if this is a totally ignorant question. Any other suggestions to accomplish passing in search criteria and opening 3rd party websites without an api that allows this would be greatly appreciated. </p>\n"},{"tags":["ruby-on-rails","performance","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":10031393,"title":"Rails Optimizing Complicated Query","body":"<p>Here's the background, I have an API method thats sending a normalized list of names to my server which then matches up the names to given Persons objects. Each person has many Post objects related to them that I want to return. My database query looks like this:</p>\n\n<pre><code> @articles = Article.joins(:artists).select(\"artists.*\").where({:artists=&gt;{:name=&gt;keys}}).group(\"#{Article.col_list}\").order(\"articles.publish_date DESC\").limit(25)\n</code></pre>\n\n<p>This query can take as long as 2 seconds on my production server when the list of names is large (over 100). How can I optimize this query so its fast?</p>\n\n<p>Here is the EXPLAIN for the query.</p>\n\n<pre><code> Limit  (cost=9144.19..9144.20 rows=25 width=802) (actual time=4341.409..4341.431 rows=25 loops=1)\n   -&gt;  Sort  (cost=9144.19..9150.74 rows=13096 width=802) (actual time=4341.408..4341.416 rows=25 loops=1)\n         Sort Key: articles.publish_date\n         Sort Method:  top-N heapsort  Memory: 47kB\n         -&gt;  HashAggregate  (cost=9030.99..9070.28 rows=13096 width=802) (actual time=4255.854..4315.125 rows=3916 loops=1)\n               -&gt;  Nested Loop  (cost=1581.27..8978.60 rows=13096 width=802) (actual time=7.443..3337.624 rows=39920 loops=1)\n                     -&gt;  Hash Join  (cost=1581.27..7650.04 rows=13096 width=4) (actual time=7.426..2627.426 rows=39920 loops=1)\n                           Hash Cond: (articles_artists.artist_id = artists.id)\n                           -&gt;  Seq Scan on articles_artists  (cost=0.00..5476.38 rows=737461 width=8) (actual time=0.019..1310.806 rows=737515 loops=1)\n                           -&gt;  Hash  (cost=1579.83..1579.83 rows=413 width=4) (actual time=7.383..7.383 rows=300 loops=1)\n                                 Buckets: 1024  Batches: 1  Memory Usage: 8kB\n                                 -&gt;  Bitmap Heap Scan on artists  (cost=477.60..1579.83 rows=413 width=4) (actual time=4.959..7.152 rows=300 loops=1)\n                                       Recheck Cond: ((name)::text = ANY ('{\"A BOY NAMED EARTH\",\"A ROCKET TO MOON\",\"A SKYLIT DRIVE\",\"A VISIBLE BOY\",\"AARON GILLESPIE\",AB,\"ABBIE BARRETT\",ABERFELDY,\"ABRA NIIRE\",\"ABSOLUTE ZERO\",ACDC,\"ADAM GREEN\",ADELE,ADO,\"ADRINA THORPE\",ADVENTURE,AEROSMITH,\"AESOP ROCK\",AFI,AIR,\"AIR TRAFFIC\",AKON,\"AL GREEN\",\"ALANIS MORISSETTE\",ALCENDOR,\"ALEX CHILTON\",\"ALEXI MURDOCH\",\"ALIAS EHREN\",\"ALICE RUSSELL\",\"ALICIA KEYS\",\"AMANDA PALMER\",\"AMERICAN FOOTBALL\",\"AMY MACDONALD\",\"AMY WINEHOUSE\",\"ANALOG REBELLION\",ANBERLIN,\"ANDREW BIRD\",\"ANDREW HILL\",\"ANGELS AIRWAVES\",AQUEDUCT,\"ARCADE FIRE\",\"ARETHA FRANKLIN\",\"ART BRUT\",\"ART GARFUNKEL\",\"ARTIC MONKEYS\",\"ARTIC MONKEYS\",\"AS TALL AS LIONS\",ASHANTI,\"ATLAS SOUND\",\"ATTACK ATTACK!\",AUTOLUX,\"AVENUE D\",\"AVRIL LAVIGNE\",\"B JU\",BACK2SQUARE1,\"BAD ENGLISH\",BALMORHEA,\"BAND OF HORSES\",BARCELONA,\"BAXTER DURY\",\"BEASTIE BOYS\",BEATLES,BECK,\"BELLE AND SEBASTIAN\",\"BEN FOLDS FIVE\",\"BEN MARTIN\",\"BETTE MIDLER\",\"BETTIE SERVEERT\",BEYONCE,\"BIFFY CLYRO\",\"BILLY BRAGG\",\"BILLY BRAGG AND BLOKES\",\"BILLY JOEL\",\"BILLY OCEAN\",BIRDY,\"BLACK EYED PEAS\",\"BLACK KIDS\",BLACKSTONE,\"BLIND PILOT\",\"BLINK 182\",\"BLOC PARTY\",\"BLOODHOUND GANG\",BLUEBOY,BLUR,\"BOB DYLAN\",\"BOB MARLEY\",\"BOB MARLEY WAILERS\",\"BOMBAY BICYCLE CLUB\",\"BON IVER\",\"BONNIE TYLER\",BONOBO,\"BOX CAR RACER\",\"BOYS LIKE GIRLS\",\"BOYZ II MEN\",BREAKBOT,\"BRENDAN BENSON\",\"BRETT ANDERSON\",BRICOLAGE,\"BRITNEY SPEARS\",BRONCO,\"BRUCE SPRINGSTEEN\",\"BRUNO MARS\",BUSH,\"BUSTA RHYMES\",BUSTED,CAESARS,\"CAGE ELEPHANT\",CAKE,CALLA,\"CALVIN HARRIS\",CAMRON,CAMRON,CAMP,CAMPING,\"CANDIE PAYNE\",CASHEW,\"CASSANDRA WILSOM\",CASSIDY,\"CATE LE BON\",\"CHARLIE FEATHERS\",\"CHERRY GHOST\",CHIC,CHICAGO,CHINGY,\"CHRIS BROWN\",\"CHRISTINA AGUILERA\",\"CHRISTINA STURMER\",CHUMBAWAMBA,CIRCLE,\"CLARENCE CARTER\",CLIPSE,\"COBRA STARSHIP\",COLDPLAY,COMMON,CONSPIRATORS,COOLIO,COPELAND,\"COPY HAHO\",CORNELIUS,CREED,CULTS,\"CYNDI LAUPER\",\"CYPRESS HILL\",\"CAT EMPIRE\",CURE,\"DA LATA\",\"DAFT PUNK\",DALMINJO,DAMERO,\"DARREN HANLON\",\"DASHBOARD CONFESSIONAL\",DATAROCK,\"DAVID BOWIE\",\"DAVID E SUGAR\",\"DAVID GUETTA\",\"DAVID KITT\",\"DEATH CAB FOR CUTIE\",\"DIANA KRALL\",DIGITALISM,\"DINOSAUR JR\",\"DISCO INFERNO\",DISCOVERY,\"DIZZEE RASCAL\",DMX,\"DON BLACKMAN\",\"DR DOG\",DRAKE,DRUGSTORE,DIPLOMATS,DREAM,EAGLES,EDITORS,ELBOW,ELECTRELANE,\"ELIZA DOOLITTLE\",\"ELLE MILANO\",\"ELLIE GOULDING\",\"ELTON JOHN\",\"ELVIS COSTELLO WITH BURT BACHARACH\",\"ELVIS PRESLEY\",EMBRACE,EMINEM,\"EMMY GREAT\",\"EMPIRE! EMPIRE!\",\"ERIC CHURCH\",\"ERIC CLAPTON\",\"ERIN MCCARLEY\",ERRORS,\"EUGENE KELLY\",\"EXPLOSIONS IN SKY\",FABOLOUS,FAILURE,\"FAITH EVANS\",\"FAR EAST MOVEMENT\",FAUNTS,FEIST,FELT,FIELDS,\"FLEET FOXES\",\"FLIGHT OF CONCHORDS\",\"FLORENCE MACHINE\",FOALS,\"FOO FIGHTERS\",\"FOSTER PEOPLE\",\"FOUR TET\",\"FRANK TURNER\",\"FRANZ FEDINAND\",FREE,\"FLAMING LIPS\",GORILLAZ,\"GRATEFUL DEAD\",IDLEWILD,\"IMANI COPPOLA\",\"IMOGEN HEAP\",INCUBUS,INCUBUS,\"IRON WINE\",\"J DILLA\",\"J COLE\",JACK,\"JACK JOHNSON\",JACOBITES,\"JAMES BLAKE\",\"JAMES BLUNT\",\"JAMES BONG\",\"JAMES BROWN\",\"JAMIE T\",\"JAN DELAY\",\"JANE CULLUM\",\"JASON DERULO\",\"JASON MORAN\",\"JAY Z\",\"JAY Z\",\"JEFF WAYNE\",\"JENNIFER LOPEZ\",\"JENNY LEWIS\",JEREMIH,\"JIM JONES\",\"JIMMY EAT WORLD\",\"JOHN COLTRANE\",\"JOHN LEGEND\",\"JOHN MAYER\",\"JOY DIVISION\",\"JUELZ SANTANA\",\"JUNIOR BOYS\",\"JUSTIN TIMBERLAKE\",\"KAISER CHEIFS\",KANTE,\"KANYE WEST\",KARMA,\"KATE NASH\",\"KATE NASH\",\"KATY PERRY\",KESHA,KEANE,KEANE,\"KELLY ROWLAND\",\"KENNY G\",\"KERI HILSON\",\"KEVIN AYERS\",\"KID CUDI\",\"KID HARPOON\",\"KID LOCO\",\"KID ROCK\",\"KINGS OF LEON\",KILLERS,KOOKS,\"LADY GAGA\",\"LADY SOVEREIGN\",\"LED ZEPPELIN\",\"LEE DORSEY\",LEMAR,LEMONGRASS,\"LEROY HUTSON\",\"LIL WAYNE\",\"LILY ALLEN\",\"LITTLE COMETS\",\"LITTLE JOY\",\"LL COOL J\",LLOYD,\"LLOYD BANKS\",\"LONDON LOUNGE\",LOST,LOVE,LUDACRIS,LUDIQUE,\"LUPE FIASCO\",\"LUTHER VANDROS\",\"MACHINE HEAD\",\"MACY GRAY\",MADONNA,MAINO,\"MANU CHAO\",\"MAREN MONTAUK\",\"MARIAH CAREY\",\"MARK FRY\",\"MARK MORRISON\",\"MARK RONSON\",\"MAROON 5\",\"MARY J BLIGE\",\"MASSIVE ATTACK\",\"MAT KEARNEY\",\"MATTHEW DEAR\",\"MEAT LOAF\",METALLICA,MGMT,\"MICHAEL GIACCHINO\",\"MICHAEL JACKSON\",\"MILES DAVIS\",\"MISSY ELLIOTT\",\"MOBB DEEP\",\"MODEST MOUSE\",\"MODEST MOUSE\",MONK,MOON,MORRISSEY,MOTZ,\"MOVING HEARTS\",MUSE,MUTEMATH,\"MY WRITES\",\"MORNING OF\",NAS,\"NE YO\",\"NICKI MINAJ\",\"NINE INCH NAILS\",\"P DIDDY\",\"PATRICK WATSON\",\"PAUL MCCARTNEY\",\"PEARL JAM\",\"PEPE ALGILAR\",\"PEPE WHITE\",\"PETER GABRIEL\",PHARRELL,\"PHIL COLLINS\",PHISH,PITBULL,PIXIES,POLICE,PRINCE,\"R KELLY\",RADIOHEAD,RAKIM,RANK,\"RASCAL FLATTS\",\"RAY CHARLES\",\"RED HOT CHILI PEPPERS\",REDNEX,REENO,\"RELIENT K\",\"RICK ROSS\",\"RICKY NELSON\",RIFT,RIHANNA,\"ROBBIE WILLIAMS\",\"ROD STEWART\",\"RODNEY HUNTER\",ROKOKO,\"ROLLING STONES\",\"ROSCOE DASH\",\"ROY DAVIS JR\",\"RYAN LESLIE\",\"RYAN LESLIE\",RZA,\"SARAH MCLACHLAN\",\"SARAH RUSSELL\",SEAL,\"SHANIA TWAIN\",SHERWOOD,\"SMASH MOUTH\",SMITHS,\"SNOOP DOGG\",\"SOMETHING CORPORATE\",SPOON,SPOON,\"ST LUNATICS\",STARS,\"STAT QUO\",\"STEELY DAN\",\"STEVIE WONDER\",\"STYLES P\",\"SUNSET RUBDOWN\",SUPERCHUNK,\"SWIZZ BEATZ\",\"SECRET HANDSHAKE\",SMITHS,\"T PAIN\",TI,\"TALIB KWELI\",\"TAYLOR SWIFT\",\"THROWING MUSES\",TLC,\"TOM JONES\",\"TOM PETTY\",\"TONY YAYO\",TOOL,\"TORI AMOS\",TORTOISE,TRAIN,\"TREY SONGZ\",\"TRIBE CALLED QUEST\",TUBBS,TYCHO,\"WHITE STRIPES\",\"WAKA FLOCKA FLAME\",WALE,WILCO,\"WILL SMITH\",U2,USHER,\"YEAH YEAH YEAHS\",\"YEAR OF RABBIT\",\"YOUNG BUCK\",\"YOUNG JEEZY\",\"ZAC BROWN BAND\",2PAC,\"50 CENT\"}'::text[]))\n                                       -&gt;  Bitmap Index Scan on index_artists_on_name  (cost=0.00..477.58 rows=413 width=0) (actual time=4.897..4.897 rows=311 loops=1)\n                                             Index Cond: ((name)::text = ANY ('{\"A BOY NAMED EARTH\",\"A ROCKET TO MOON\",\"A SKYLIT DRIVE\",\"A VISIBLE BOY\",\"AARON GILLESPIE\",AB,\"ABBIE BARRETT\",ABERFELDY,\"ABRA NIIRE\",\"ABSOLUTE ZERO\",ACDC,\"ADAM GREEN\",ADELE,ADO,\"ADRINA THORPE\",ADVENTURE,AEROSMITH,\"AESOP ROCK\",AFI,AIR,\"AIR TRAFFIC\",AKON,\"AL GREEN\",\"ALANIS MORISSETTE\",ALCENDOR,\"ALEX CHILTON\",\"ALEXI MURDOCH\",\"ALIAS EHREN\",\"ALICE RUSSELL\",\"ALICIA KEYS\",\"AMANDA PALMER\",\"AMERICAN FOOTBALL\",\"AMY MACDONALD\",\"AMY WINEHOUSE\",\"ANALOG REBELLION\",ANBERLIN,\"ANDREW BIRD\",\"ANDREW HILL\",\"ANGELS AIRWAVES\",AQUEDUCT,\"ARCADE FIRE\",\"ARETHA FRANKLIN\",\"ART BRUT\",\"ART GARFUNKEL\",\"ARTIC MONKEYS\",\"ARTIC MONKEYS\",\"AS TALL AS LIONS\",ASHANTI,\"ATLAS SOUND\",\"ATTACK ATTACK!\",AUTOLUX,\"AVENUE D\",\"AVRIL LAVIGNE\",\"B JU\",BACK2SQUARE1,\"BAD ENGLISH\",BALMORHEA,\"BAND OF HORSES\",BARCELONA,\"BAXTER DURY\",\"BEASTIE BOYS\",BEATLES,BECK,\"BELLE AND SEBASTIAN\",\"BEN FOLDS FIVE\",\"BEN MARTIN\",\"BETTE MIDLER\",\"BETTIE SERVEERT\",BEYONCE,\"BIFFY CLYRO\",\"BILLY BRAGG\",\"BILLY BRAGG AND BLOKES\",\"BILLY JOEL\",\"BILLY OCEAN\",BIRDY,\"BLACK EYED PEAS\",\"BLACK KIDS\",BLACKSTONE,\"BLIND PILOT\",\"BLINK 182\",\"BLOC PARTY\",\"BLOODHOUND GANG\",BLUEBOY,BLUR,\"BOB DYLAN\",\"BOB MARLEY\",\"BOB MARLEY WAILERS\",\"BOMBAY BICYCLE CLUB\",\"BON IVER\",\"BONNIE TYLER\",BONOBO,\"BOX CAR RACER\",\"BOYS LIKE GIRLS\",\"BOYZ II MEN\",BREAKBOT,\"BRENDAN BENSON\",\"BRETT ANDERSON\",BRICOLAGE,\"BRITNEY SPEARS\",BRONCO,\"BRUCE SPRINGSTEEN\",\"BRUNO MARS\",BUSH,\"BUSTA RHYMES\",BUSTED,CAESARS,\"CAGE ELEPHANT\",CAKE,CALLA,\"CALVIN HARRIS\",CAMRON,CAMRON,CAMP,CAMPING,\"CANDIE PAYNE\",CASHEW,\"CASSANDRA WILSOM\",CASSIDY,\"CATE LE BON\",\"CHARLIE FEATHERS\",\"CHERRY GHOST\",CHIC,CHICAGO,CHINGY,\"CHRIS BROWN\",\"CHRISTINA AGUILERA\",\"CHRISTINA STURMER\",CHUMBAWAMBA,CIRCLE,\"CLARENCE CARTER\",CLIPSE,\"COBRA STARSHIP\",COLDPLAY,COMMON,CONSPIRATORS,COOLIO,COPELAND,\"COPY HAHO\",CORNELIUS,CREED,CULTS,\"CYNDI LAUPER\",\"CYPRESS HILL\",\"CAT EMPIRE\",CURE,\"DA LATA\",\"DAFT PUNK\",DALMINJO,DAMERO,\"DARREN HANLON\",\"DASHBOARD CONFESSIONAL\",DATAROCK,\"DAVID BOWIE\",\"DAVID E SUGAR\",\"DAVID GUETTA\",\"DAVID KITT\",\"DEATH CAB FOR CUTIE\",\"DIANA KRALL\",DIGITALISM,\"DINOSAUR JR\",\"DISCO INFERNO\",DISCOVERY,\"DIZZEE RASCAL\",DMX,\"DON BLACKMAN\",\"DR DOG\",DRAKE,DRUGSTORE,DIPLOMATS,DREAM,EAGLES,EDITORS,ELBOW,ELECTRELANE,\"ELIZA DOOLITTLE\",\"ELLE MILANO\",\"ELLIE GOULDING\",\"ELTON JOHN\",\"ELVIS COSTELLO WITH BURT BACHARACH\",\"ELVIS PRESLEY\",EMBRACE,EMINEM,\"EMMY GREAT\",\"EMPIRE! EMPIRE!\",\"ERIC CHURCH\",\"ERIC CLAPTON\",\"ERIN MCCARLEY\",ERRORS,\"EUGENE KELLY\",\"EXPLOSIONS IN SKY\",FABOLOUS,FAILURE,\"FAITH EVANS\",\"FAR EAST MOVEMENT\",FAUNTS,FEIST,FELT,FIELDS,\"FLEET FOXES\",\"FLIGHT OF CONCHORDS\",\"FLORENCE MACHINE\",FOALS,\"FOO FIGHTERS\",\"FOSTER PEOPLE\",\"FOUR TET\",\"FRANK TURNER\",\"FRANZ FEDINAND\",FREE,\"FLAMING LIPS\",GORILLAZ,\"GRATEFUL DEAD\",IDLEWILD,\"IMANI COPPOLA\",\"IMOGEN HEAP\",INCUBUS,INCUBUS,\"IRON WINE\",\"J DILLA\",\"J COLE\",JACK,\"JACK JOHNSON\",JACOBITES,\"JAMES BLAKE\",\"JAMES BLUNT\",\"JAMES BONG\",\"JAMES BROWN\",\"JAMIE T\",\"JAN DELAY\",\"JANE CULLUM\",\"JASON DERULO\",\"JASON MORAN\",\"JAY Z\",\"JAY Z\",\"JEFF WAYNE\",\"JENNIFER LOPEZ\",\"JENNY LEWIS\",JEREMIH,\"JIM JONES\",\"JIMMY EAT WORLD\",\"JOHN COLTRANE\",\"JOHN LEGEND\",\"JOHN MAYER\",\"JOY DIVISION\",\"JUELZ SANTANA\",\"JUNIOR BOYS\",\"JUSTIN TIMBERLAKE\",\"KAISER CHEIFS\",KANTE,\"KANYE WEST\",KARMA,\"KATE NASH\",\"KATE NASH\",\"KATY PERRY\",KESHA,KEANE,KEANE,\"KELLY ROWLAND\",\"KENNY G\",\"KERI HILSON\",\"KEVIN AYERS\",\"KID CUDI\",\"KID HARPOON\",\"KID LOCO\",\"KID ROCK\",\"KINGS OF LEON\",KILLERS,KOOKS,\"LADY GAGA\",\"LADY SOVEREIGN\",\"LED ZEPPELIN\",\"LEE DORSEY\",LEMAR,LEMONGRASS,\"LEROY HUTSON\",\"LIL WAYNE\",\"LILY ALLEN\",\"LITTLE COMETS\",\"LITTLE JOY\",\"LL COOL J\",LLOYD,\"LLOYD BANKS\",\"LONDON LOUNGE\",LOST,LOVE,LUDACRIS,LUDIQUE,\"LUPE FIASCO\",\"LUTHER VANDROS\",\"MACHINE HEAD\",\"MACY GRAY\",MADONNA,MAINO,\"MANU CHAO\",\"MAREN MONTAUK\",\"MARIAH CAREY\",\"MARK FRY\",\"MARK MORRISON\",\"MARK RONSON\",\"MAROON 5\",\"MARY J BLIGE\",\"MASSIVE ATTACK\",\"MAT KEARNEY\",\"MATTHEW DEAR\",\"MEAT LOAF\",METALLICA,MGMT,\"MICHAEL GIACCHINO\",\"MICHAEL JACKSON\",\"MILES DAVIS\",\"MISSY ELLIOTT\",\"MOBB DEEP\",\"MODEST MOUSE\",\"MODEST MOUSE\",MONK,MOON,MORRISSEY,MOTZ,\"MOVING HEARTS\",MUSE,MUTEMATH,\"MY WRITES\",\"MORNING OF\",NAS,\"NE YO\",\"NICKI MINAJ\",\"NINE INCH NAILS\",\"P DIDDY\",\"PATRICK WATSON\",\"PAUL MCCARTNEY\",\"PEARL JAM\",\"PEPE ALGILAR\",\"PEPE WHITE\",\"PETER GABRIEL\",PHARRELL,\"PHIL COLLINS\",PHISH,PITBULL,PIXIES,POLICE,PRINCE,\"R KELLY\",RADIOHEAD,RAKIM,RANK,\"RASCAL FLATTS\",\"RAY CHARLES\",\"RED HOT CHILI PEPPERS\",REDNEX,REENO,\"RELIENT K\",\"RICK ROSS\",\"RICKY NELSON\",RIFT,RIHANNA,\"ROBBIE WILLIAMS\",\"ROD STEWART\",\"RODNEY HUNTER\",ROKOKO,\"ROLLING STONES\",\"ROSCOE DASH\",\"ROY DAVIS JR\",\"RYAN LESLIE\",\"RYAN LESLIE\",RZA,\"SARAH MCLACHLAN\",\"SARAH RUSSELL\",SEAL,\"SHANIA TWAIN\",SHERWOOD,\"SMASH MOUTH\",SMITHS,\"SNOOP DOGG\",\"SOMETHING CORPORATE\",SPOON,SPOON,\"ST LUNATICS\",STARS,\"STAT QUO\",\"STEELY DAN\",\"STEVIE WONDER\",\"STYLES P\",\"SUNSET RUBDOWN\",SUPERCHUNK,\"SWIZZ BEATZ\",\"SECRET HANDSHAKE\",SMITHS,\"T PAIN\",TI,\"TALIB KWELI\",\"TAYLOR SWIFT\",\"THROWING MUSES\",TLC,\"TOM JONES\",\"TOM PETTY\",\"TONY YAYO\",TOOL,\"TORI AMOS\",TORTOISE,TRAIN,\"TREY SONGZ\",\"TRIBE CALLED QUEST\",TUBBS,TYCHO,\"WHITE STRIPES\",\"WAKA FLOCKA FLAME\",WALE,WILCO,\"WILL SMITH\",U2,USHER,\"YEAH YEAH YEAHS\",\"YEAR OF RABBIT\",\"YOUNG BUCK\",\"YOUNG JEEZY\",\"ZAC BROWN BAND\",2PAC,\"50 CENT\"}'::text[]))\n                     -&gt;  Index Scan using articles_pkey on articles  (cost=0.00..0.10 rows=1 width=802) (actual time=0.006..0.006 rows=1 loops=39920)\n                           Index Cond: (articles.id = articles_artists.article_id)\n Total runtime: 4343.603 ms\n(18 rows)\n</code></pre>\n"},{"tags":["query","azure","azure-storage-tables"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12583894,"title":"Rowkey.ToLower() while querying on Azure table throws Exception","body":"<p>Querying for an specific entity having e.RowKey.ToLower() throws an exception</p>\n\n<pre><code>CustomerEntity customerEntity = (from e in serviceContext.CreateQuery&lt;CustomerEntity&gt;(\"Customer\")\n                                     where e.RowKey.ToLower() == firstName.ToLower()                                         \n                                     select e).FirstOrDefault();\n</code></pre>\n\n<p>Basically i want to check for case insensitive username..Azure table is managed by our partner so i can not instruct them to enter the User entry into table in lower case.</p>\n\n<p>I need to handle this in code.</p>\n\n<p>REgards,\nVivek</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":224,"score":-2,"question_id":9741378,"title":"How to check if a column is equal to a variable which can be null","body":"<p>I have a table that contains a varchar column that allows null or empty values.</p>\n\n<p>I'm writing a stored procedure that contains a variable that can be assigned to a null value or a regular string (not empty)</p>\n\n<p>It's defined like this:</p>\n\n<pre><code>declare @myvar varchar(50)\n</code></pre>\n\n<p>Now I'm trying to write a query that returns the rows where the column is equal to this variable or it is empty or null. So far I thought this was going to work:</p>\n\n<pre><code>select * from mytable where mycolumn =@myvar or mycolumn =''\n</code></pre>\n\n<p>However if the column is null and the variable is null it will not return any values.</p>\n\n<p>I know I can make it work doing something like this:</p>\n\n<pre><code>select * from mytable where (mycolumn = @myvar and mycolum is not null) or mycolumn is null or mycolumn =''\n</code></pre>\n\n<p>Is there a better way of doing this?</p>\n\n<p>PS: I would prefer not to do ANSI_NULLS OFF</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server-2008","query","sql-server-2005","parameters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12591872,"title":"Multiple table query not working on certain databases","body":"<p>I have 12 locations each running their own database.  Each database is setup exactly the same, with their own information.  The databases are all SQL2005 or 2008 server.  I wrote a multiple table query to pull information for paying commission on sales.  This query works on 10 of the 12 databases, the other 2 databases do not return any results.  If I run the query with 2 joined tables (on the 2 databases it does not work on) it works, however the other tables in question have nothing to do with the \"where\" statement.  Could anyone shed some light on why it would not work on 2 of the 2005 server databases if it works on all of the others?  My Code is:</p>\n\n<pre><code>SELECT        Customers.sBarcode AS Barcode, Customers.dtCreated AS Created, CustomerUnlimitedTransactions.sCreatedBy AS [Commission pays], \n                         Surcharges.sDescription AS [Unlimited Package], Surcharges.dblCommission AS [Commission Amount], Users.sUserName AS Greeter, @startdate AS Start_Date, \n                         @enddate AS End_Date\nFROM            CustomerUnlimitedTransactions INNER JOIN\n                         Customers ON CustomerUnlimitedTransactions.lCustomerId = Customers.lCustomerID INNER JOIN\n                         VIPAccountTypes ON CustomerUnlimitedTransactions.lMonthlyAccountTypeId = VIPAccountTypes.lAccountType INNER JOIN\n                         Surcharges ON VIPAccountTypes.lSurchargeId = Surcharges.Surcharge_ID INNER JOIN\n                         Users ON Customers.lGreeterID = Users.ID_User\nWHERE        (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102)) AND \n                         (CustomerUnlimitedTransactions.sTransactionType = N'sale') AND (CustomerUnlimitedTransactions.lMonthlyAccountTypeId = '11') OR\n                         (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102)) AND \n                         (CustomerUnlimitedTransactions.sTransactionType = N'sale') AND (CustomerUnlimitedTransactions.lMonthlyAccountTypeId = '12')\nORDER BY Created\n</code></pre>\n\n<p>If I run the query like this I still do not return any results:</p>\n\n<pre><code>SELECT        Customers.sBarcode AS Barcode, Customers.dtCreated AS Created, CustomerUnlimitedTransactions.sCreatedBy AS [Commission pays], \n                             Surcharges.sDescription AS [Unlimited Package], Surcharges.dblCommission AS [Commission Amount], Users.sUserName AS Greeter, @startdate AS Start_Date, \n                             @enddate AS End_Date\n    FROM            CustomerUnlimitedTransactions INNER JOIN\n                             Customers ON CustomerUnlimitedTransactions.lCustomerId = Customers.lCustomerID INNER JOIN\n                             VIPAccountTypes ON CustomerUnlimitedTransactions.lMonthlyAccountTypeId = VIPAccountTypes.lAccountType INNER JOIN\n                             Surcharges ON VIPAccountTypes.lSurchargeId = Surcharges.Surcharge_ID INNER JOIN\n                             Users ON Customers.lGreeterID = Users.ID_User\n    WHERE        (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102))\n    ORDER BY Created\n</code></pre>\n\n<p>If I run the query like this I DO get results:</p>\n\n<pre><code>SELECT        Customers.sBarcode AS Barcode, Customers.dtCreated AS Created, CustomerUnlimitedTransactions.sCreatedBy AS [Commission pays], \n                                 Surcharges.sDescription AS [Unlimited Package], Surcharges.dblCommission AS [Commission Amount], Users.sUserName AS Greeter, @startdate AS Start_Date, \n                                 @enddate AS End_Date\n        FROM            CustomerUnlimitedTransactions INNER JOIN\n                                 Customers ON CustomerUnlimitedTransactions.lCustomerId = Customers.lCustomerID \n        WHERE        (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102))\n        ORDER BY Created\n</code></pre>\n\n<p>There are not any Null's associated with any of the above query's.  Again this works on 10 of 12... and yes the databases are EXACTLY the same.  (if I run this query out for a year date range I get results) however I should show 25 results from last week alone, and I am showing none on each of the 2.</p>\n"},{"tags":["xml","query"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":256,"score":5,"question_id":3571476,"title":"XML and its uses in Databases","body":"<p>What is XML and how is it used in  databases?  If this looks like a homework assignment, it is.</p>\n"},{"tags":["sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12592755,"title":"Simple Select returning null instead of value","body":"<p>I have a table like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/8VLf9.png\" alt=\"enter image description here\"></p>\n\n<p>and what I need is a sum of amounts in given year for given department.</p>\n\n<p>I tried this:</p>\n\n<pre><code>SELECT SUM(amount) FROM `spendings` WHERE dept_name='fiz' AND YEAR(date)=2012\n</code></pre>\n\n<p>but it only returns <code>NULL</code>. <code>dept_name</code> is a <code>varchar</code>, <code>amount</code> is a <code>double</code> and <code>date</code> - well, it's a <code>date</code>, what a surprise.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["sql","xml","sql-server-2005","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":567,"score":2,"question_id":8421509,"title":"How to add attributes to xml nodes in sql server 2005","body":"<p>If i wanted to add an attribute to the root element record, can i do this from the sql side?</p>\n\n<pre><code>SELECT top 1 'text' as nodeA\n                from test as z\nFOR XML AUTO, ELEMENTS, root('record')\n</code></pre>\n\n<p>i would like to produce the xml like this:</p>\n\n<pre><code> &lt;Root attribute=\"value\"&gt;\n     &lt;z&gt;\n         &lt;NodeA&gt;text&lt;/NodeA&gt;\n     &lt;/z&gt;\n &lt;/Root&gt;\n</code></pre>\n"},{"tags":["sql","oracle","query","database-partitioning"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":148,"score":0,"question_id":9425421,"title":"How can I write a query for Partitioned SQL tables?","body":"<p>Here is my Create tabled and partition query:\nHow can I insert Data into my Partitioned tables? AND\nHow can I make a select statement that displays ROWID , ID, TITLE, PUBID and PUBDATE for all rows of data in my lab6_zl table I created.</p>\n\n<pre><code>create table lab6_zl (\nID number not null, \nTITLE varchar2(40), \nPUBID char(3), \nPUBDATE date,\nconstraint lab6_pk primary key(ID))\nPartition by range (pubdate)\n(\nPartition p1 values less than (to_date('01-JAN-2000','DD-MON-YYYY')),\nPartition p2 values less than (to_date('01-JAN-2010','DD-MON-YYYY')),\nPartition p3 values less than (MAXVALUE)\n)\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12591498,"title":"MySQL - Using 'AS var_name' in SELECT","body":"<p>How can I use a variable such as 'AS uniqueName' in the select in the same select later on?</p>\n\n<p>I am trying to put some simple logic inside the select so I dont have to iterate through the result set just to do something easy:</p>\n\n<pre><code>SELECT\nCASE emp_crns.ansi_class\n    when -1 then 'N'\n    when 150 then 0\n    when 300 then 1\n    when 600 then 2\n    when 900 then 3\n    when 1500 then 4\n    when 2500 then 6\n    when 3500 then 8\n    else 'X'\nend AS crnAnsiClassCode,\nCONCAT('REV. ', crnAnsiClassCode, ' ', emp_models.name) AS modelName\nFROM\nemp_models\nJOIN\nemp_revisions ON emp_revisions.id=emp_models.revision_id\nJOIN\nemp_crns ON emp_crns.id=emp_revisions.crn_id\n</code></pre>\n"},{"tags":["sql","sql-server","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":88,"score":-1,"question_id":12590987,"title":"Correlated Subquery and Joins","body":"<p>Please can anyone give me the difference between using a Correlated sub-query over a JOIN ? Are they not meant to solve the same problem. Is there a performance Hit over one. I am using SQL server and I tend to use FOR XML PATH('') to select multiple columns that occur in subqueries. Any example to explain the difference will be appreciated.</p>\n"},{"tags":["sql","sql-server","query","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12589963,"title":"T-SQL Query against previous queries results","body":"<p>I'm having a hard time searching the internet for this, so thought I would ask the T-SQL question here.  I have a table called CUST.  CUST contains customer entrydate, name, company, address, email, among other things.  I wrote a simple query to find new customers based off entrydate;</p>\n\n<pre><code>Select * from CUST WHERE ENTRYDATE between '2012-08-01' and '2012-08-30'\n</code></pre>\n\n<p>This works great, except I found a problem.  When our webstore creates new orders, if the customer details don't match EXACTLY, a new customer is created.  That being the case, I want to take my original results, and trim the results set if I have more than one occurrence of cust.firstname + cust.lastname + cust.company.  I can write these in individual queries, just unsure how to do this in a single sql script.</p>\n\n<p>I thought about doing a join on name back to the table, and while the join doesn't error, I don't know how to count the occurrences, I was thinking of counting customer numbers.</p>\n\n<p>My join looks like this (stripped out the group by and column selection to make it easier to read;</p>\n\n<pre><code>from CUST\n    Right Outer Join \n    (\n    select *\n    from CUST \n    WHERE ENTRYDATE between '2012-08-01' and '2012-08-30'\n            AND LTRIM(RTRIM(Firstname + Lastname + Company)) &lt;&gt; ''\n    Group By *     \n    ) as newcs\n\n    on LTRIM(RTRIM(CUST.Firstname + CUST.Lastname + CUST.Company)) = LTRIM(RTRIM(newcs.Firstname + newcs.Lastname + newcs.Company))\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql","query","sql-server-2005","join","query-optimization"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12519692,"title":"How does SQL OR query works","body":"<p>To my understinding it should be simple, does colA='X' or ColB='X', if any one of them is true then return the result otherwise not. </p>\n\n<pre><code>TableA\n╔════╦═══╦═══╦═══╦═══╗\n║ id ║ A ║ B ║ C ║ D ║\n╠════╬═══╬═══╬═══╬═══╣\n║ 1  ║ x ║ x ║ x ║ x ║\n║ 2  ║ x ║ x ║ x ║ x ║\n║ 3  ║ x ║ x ║ x ║ x ║\n╚════╩═══╩═══╩═══╩═══╝\n\nTableB\n╔════╦═══╗\n║ id ║ A ║\n╠════╬═══╣\n║  1 ║ x ║\n║  2 ║ x ║\n║  3 ║ x ║\n╚════╩═══╝\n\nselect T2.ID from tableA T1\nJOIN TableB T2\nON T1.A=T2.A OR T1.B=T2.A OR T1.C=T2.A OR T1.D=T2.A /* **takes 6+ min** */\n</code></pre>\n\n<p><strong>This simple join takes 6+ minutes.</strong> If I join using only one field, then it is pretty quick. <strong>Also if I write 4 different queries, one for each OR and then Union the result, it is very quick also</strong>.</p>\n\n<p>My question is, <strong>How does SQL OR Query works?</strong> Does it work on current row, does all the ORING and move on to the next or does it do the <em>complete OR</em> of the two tables for <em>each OR</em>. Even then it should take long as seperate queries are fast enough. I out think an internal optimiser can optiise this really quick: I am comparing one column from one table to 4 column of second table. It should be easy to optimise. Why is it taking so long? <strong>Is there a way to manually optimize this query</strong>. Btw I tried changing = to != or Or to AND but it takes the same amount of time.</p>\n"},{"tags":["php","mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12590158,"title":"SQL Query Error #1054 - Unknown column 'avgRatingID' in 'where clause, using subquery in select","body":"<p>I am using the following query and always getting error #1054 - Unknown column 'avgRatingID' in 'where clause' I am try to detect the error but couldn't found that anywhere. If the style I'm using subquery is wrong?</p>\n\n<pre><code>SELECT ID, name, avgRating, description, thumbImage, tableName\nFROM (\n (\n  SELECT rides.rideID AS ID, avgRatingID,concat( rideName, concat( '::NEWLINE', parkName ) ) AS name, avgRating, rideDescription AS description, rideThumb AS thumbImage, \"rides\" AS tableName, submitDate\n  FROM review_rides, rides, parks,(\n    SELECT rides.rideID as avgRatingID,ceil( sum( review_rides.rating ) / count( * ) ) as avgRating\n    FROM review_rides,rides\n    WHERE review_rides.rideID = avgRatingID\n    GROUP BY avgRatingID\n    ) as avgRatingTable\n    WHERE review_rides.rideID = rides.rideID\n    AND rides.parkID = parks.parkID\n    AND rides.rideID = avgRatingID\n    GROUP BY ID\n   )\n UNION\n   (\n   SELECT parks.parkID AS ID, avgRatingID,parkName AS name, avgRating, parkDescription AS description, parkThumb AS thumbImage, \"parks\" AS tableName, submitDate\n   FROM parks, review_parks, (\n     SELECT parks.parkID as avgRatingID,ceil( sum( review_parks.rating ) / count( * )      ) as avgRating\n     FROM review_parks,parks\n     WHERE review_parks.parkID = avgRatingID\n     GROUP BY avgRatingID\n) as avgRatingTable\n     WHERE parks.parkID = review_parks.parkID\n   AND  parks.parkID = avgRatingID\n   GROUP BY ID\n   )\n) AS customTableReviews\nORDER BY submitDate DESC \n</code></pre>\n"},{"tags":["sql","database","oracle","query","manipulation"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":157,"score":2,"question_id":12392111,"title":"SQL mass string manipulation","body":"<p>I'm working with an oracle DB and need to manipulate a string column within it. The column contains multiple email addresses in this format:</p>\n\n<p>jgooooll@gmail.com;dhookep@gmail.com;amoore@outlook.com</p>\n\n<p>What I want to do is take out anything that does <strong>not</strong> have '@gmail.com' at the end (in this example amoore@outlook.com would be removed) however amoore@outlook.com may be the first email in the next row of the column so in this way there is no real fixed format, the only format being that each address is seperated by a semi-colon.</p>\n\n<p>Is there anyway of implementing this through one command to run through every row in the column and remove anything thats not @gmail.com?  I'm not really sure if this kind of processing is possible in SQL. Just looking for your thoughts!!</p>\n\n<p>Thanks a lot you guys. Look forward to hearing from you!</p>\n"},{"tags":["oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":154,"score":0,"question_id":12589937,"title":"ORA-00932 inconsistent datatypes: expected - got BLOB","body":"<p>I have this query I am trying to run but I keep running into this error.  I am trying to do a <code>Where</code> clause that compares the data (BLOB column) to :var2 which is a blob object.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>SELECT max(id) \nINTO :var1\nFROM table_name \nwhere data = :var2;\n</code></pre>\n\n<p>Any suggestions to why I would be getting this <code>ORA-00932</code> error?</p>\n\n<p>I am comparing a <code>blob</code> to a <code>blob column</code>, shouldn't that be fine?</p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12589861,"title":"In MySQL is it possible to keep the results of a query independent from the results of a subquery?","body":"<p>I need to output a list of search results to a user.</p>\n\n<p>However which results i choose to display are contingent upon the results of another query.</p>\n\n<p>So:</p>\n\n<pre><code>Query 1,\nQuery 2,\n\nwhile($row=mysql_fetch_array($result)\n    {\n    (IF (Query 2 is xyz)\n       {\n        Output $row[1]\n       }\n    }\n</code></pre>\n\n<p>So only query1 results that pass the specific query 2 parameters get printed.</p>\n\n<p>Ultimately, my question is, can i keep 2 separate queries at the same time, by putting their results into different variables? i.e. $result1 and $result2?   or does making a new query override the last one?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","duplicates"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":122,"score":2,"question_id":12585550,"title":"SQL Server 2008, how to check if multi records exist in the DB?","body":"<p>I have 3 tables:</p>\n\n<ul>\n<li>recipe:\n<ul>\n<li>id, name</li>\n</ul></li>\n<li>ingredient:\n<ul>\n<li>id, name</li>\n</ul></li>\n<li>recipeingredient:\n<ul>\n<li>id, recipeId, ingredientId, quantity</li>\n</ul></li>\n</ul>\n\n<p>Every time, a customer creates a new recipe, I need to check the <code>recipeingredient</code> table to verify if this recipe exists or not.  If <code>ingredientId</code> and <code>quantity</code> are exactly the same, I will tell the customer the recipe already exists.  Since I need to check multiple rows, need help to write this query.</p>\n"},{"tags":["mysql","query","transactions","e-commerce","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12522087,"title":"What is the ideal MySQL transaction isolation mode for an e-commerce site?","body":"<p>What is the best transaction isolation mode for an e-commerce site that has to do the typical run-down of database operations for subtracting inventory? Should I be using <code>READ COMMITTED</code> to protect against reading in-transaction data?</p>\n"},{"tags":["mysql","query","group-by"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":12589249,"title":"mysql Group by : Slow query","body":"<p>Here is my query</p>\n\n<pre><code>SELECT file_id, file_name, file_date, file_email\nFROM (SELECT *\n      FROM `file`\n      ORDER BY file_date DESC\n     ) AS t\nWHERE file_domains = ''\nGROUP BY file_name\nORDER BY file_date DESC\nLIMIT 0 , 100\n</code></pre>\n\n<p>primary key is file_id and index is file_name. Records about 900k\nIt took about 2 seconds in my local computer.\nIs there any optimize for this query?\nthanks in advance.</p>\n"},{"tags":["php","database","query","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":12589168,"title":"Php search form to display similar names?","body":"<p>Dear Guys i need to know how to create a search form and when a user is searched for a username the username must be displayed with all similar name and all that usernames must be in link form i means if a username is clicked then the user must redirected to mydomain.com/user.php?username= HERE SEARCHED USERNAME</p>\n\n<p>I have the user.php file with user.php?username= USERNAME </p>\n\n<p>I Need to know how to like this page with searched users name in link form.</p>\n"},{"tags":["query","view","datatables","server-side"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12585353,"title":"DataTables Server Side Processing from Query/View not Single Table","body":"<p>I am using the DataTables jQuery plugin to display data from a query that performs several calculations involving joins and subqueries.  I have it working fine using client side processing, with the data coming from sAjaxSource.  I would like to implement server side processing - but am not sure the most appropriate way to do this since my data is not coming from a single table.</p>\n\n<p>A basic example of server side processing can be found at <a href=\"http://datatables.net/release-datatables/examples/data_sources/server_side.html\" rel=\"nofollow\">http://datatables.net/release-datatables/examples/data_sources/server_side.html</a></p>\n\n<p>What is the best way to address this?  If only it were as simple as using a view here...</p>\n\n<pre><code>/* DB table to use */\n$sTable = \"ajax\";\n</code></pre>\n\n<p>changed to</p>\n\n<pre><code>    /* DB table to use */\n    $sTable = \"myView\";\n</code></pre>\n\n<p>Also I would prefer to implement this using PDO rather than the basic mysql_query, etc.. - but any suggestions are appreciated.</p>\n"},{"tags":["sql","sql-server-2008","query","tsql","insert"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12587929,"title":"Using Case statement to either Insert into a table or Update an existing row","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/108403/solutions-for-insert-or-update-on-sql-server\">Solutions for INSERT OR UPDATE on SQL Server</a><br>\n  <a href=\"http://stackoverflow.com/questions/3407857/only-inserting-a-row-if-its-not-already-there\">Only inserting a row if it&#39;s not already there</a>  </p>\n</blockquote>\n\n\n\n<p>My title pretty much explains what I'm trying to do, but I'll go into a little more detail. I'm creating a stored procedure when called it first checks to see if the row already exists (by comparing against two parameters) and if it does, it will update a specific column in the row and if the row doesn't exist already it will insert a new row into the table. </p>\n\n<pre><code>BEGIN\nSELECT \n(\nCASE WHEN [Site] = @site and Plant = @plant\nthen \nUPDATE [Status]\nFROM Server_Status\nWHERE [Site] = @site\nELSE\nInsert into Server_Status(Name, [Path], [Site], Plant, [Status])\nValues (@name, @path, @site, @plant, @status)\nend\n)\nFROM Server_Status \nEND\n</code></pre>\n\n<p>Is what I have so far, but doesn't work (obviously). Does anyone with more SQL knowledge than I have any suggestions?</p>\n\n<p>-J</p>\n"}]}
{"total":20740,"page":19,"pagesize":100,"questions":[{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12588258,"title":"how does below query work","body":"<p>Can someone explain me how below query will work.. i have table called employee</p>\n\n<pre><code>id FirstName LastName   Email            Groupid\n1 Paula      Brown    pb@testdomain.org    12\n2 James      Smith    jim@test.co.uk       12\n3 James      Connor   jc@tes.co.uk         13\n\n\nselect * from employee where groupid=12 AND id NOT IN (1) OR id NOT IN (2)\n</code></pre>\n\n<p>how does this query works? Am trying to understand how AND clause works with OR. Any help would be appreciated...</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12586712,"title":"Need a MySQL query to obtain dates not registered in a table","body":"<p>I have a little problem with a specific functionality. I have a table of reservations for rooms.</p>\n\n<p>Table: Reservations</p>\n\n<pre><code>room (BIGINT), date (DATE)\n            4,  2012-09-25\n            4,  2012-09-27\n            4,  2012-09-30\n</code></pre>\n\n<p>I need to obtain the dates when room with id = 4 is available between a date range. For example, if i want the dates that the room is available between 2012-09-25 and 2012-10-01 (inclusive) i have to obtain the next result:</p>\n\n<pre><code>date (DATE)\n 2012-09-26\n 2012-09-28\n 2012-09-29\n 2012-10-01\n</code></pre>\n\n<p>Any help will be appreciated. Thanks in advance.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12581251,"title":"Mysql query with Union All and Join for League table","body":"<p>for a soccer league i have two tables: </p>\n\n<ul>\n<li>\"teams\" is a table that lists all teams as unique entries ('id',\n'team_name')</li>\n<li>\"matches\" is a table that shows the match results: In the columns\n'home' and 'away' i save each game result. 'home_team_id' and\n'away_team_id' is the association to the teams-table.</li>\n</ul>\n\n<p>This is how my query looks like:</p>\n\n<pre><code>SELECT Teams, Sum(P) as 'Matches', Sum(W) as 'win', Sum(D) as 'draw', Sum(L) as 'lost',\n       SUM(Pts) as 'points'\n  FROM (\n        SELECT home Teams, 1 P,\n                IF (home &gt; away,1,0) W,\n                IF (home = away,1,0) D,\n                IF (home &lt; away,1,0) L,\n                CASE \n                    WHEN home &gt; away THEN 3\n                    WHEN home = away THEN 1 \n                    ELSE 0\n                END PTS\n          FROM `matches`\n\n        UNION ALL\n        SELECT away Teams, 1,\n                IF (home &lt; away,1,0),\n                IF (home = away,1,0),\n                IF (home &gt; away,1,0),\n                CASE \n                    WHEN home &lt; away THEN 3\n                    WHEN home = away THEN 1\n                    ELSE 0\n                END\n          FROM `matches`\n        ) AS ERG\nGROUP BY Teams\nORDER BY SUM(Pts) DESC \n</code></pre>\n\n<p>Now i want the team names (teams.team_name) from the team-table. To achieve this i tried several join-statements with no luck. </p>\n\n<p>It's obvious that the teams-table can contain teams who did not attend a match. These teams need to be displayed with zero-results. </p>\n\n<p>Therefore I tried a LEFT JOIN:</p>\n\n<pre><code>SELECT team_name AS 'Teams'\n  FROM `teams`\n  LEFT JOIN matches ON ( teams.id = matches.home_team_id )\n</code></pre>\n\n<p>right after the ORDER-line in the end. I got an error message.\nI use MySQL 5.1.44, so nested selects shouldn't be a problem.</p>\n\n<p>Any idea? </p>\n"},{"tags":["sql-server-2008","query","constraints"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12583910,"title":"SQL Server constraint check not working ","body":"<p>I'm using <code>constraint</code> to force business rule in sql server 2008 database as,</p>\n\n<pre><code>alter table TableName with check  \nAdd check    \n(\n    (col1 = 1 and col2 &gt; 0)  \n    or   \n    col1 = 0  \n)\n</code></pre>\n\n<p>when i try to execute insert query in Management Studio</p>\n\n<pre><code>update TableName set col1 = 1 where Id = 1; --the col2 =0 so it is not valid according to above constraint\n</code></pre>\n\n<p>after execute, i get the message <code>(1 row(s) affected)</code> without any error message!!</p>\n\n<p>but actually when i check the data in table, it didnt change (which is right action).    </p>\n\n<p>Edit: so the unusual behavior is executed with <code>1 row(s) affected</code> although there is no row effected...</p>\n"},{"tags":["iphone","database","query","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12584533,"title":"Open table from database sqlite in iphone?","body":"<p>I have a database called China.sqlite nel Bundle, which consist of 16 tables. I have to open the table elements from the table called Menu.How can I do? Thanks in advance</p>\n"},{"tags":["sql","query","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":136,"score":0,"question_id":11229316,"title":"Selecting the 2nd row in sql","body":"<p>I want to select the second row only from the table. From the ClientUserName column.</p>\n\n<pre><code>SELECT\n    ClientUserName, DestHost, count(DestHost) counts  \nFROM \n    #ProxyLog_record  \nWHERE\n    ClientUserName = (Select top 1 ClientUserName from #ProxyLog_count_2)  \nGROUP BY \n    ClientUserName, DestHost \nORDER BY \n    counts DESC\n</code></pre>\n\n<p>The <code>(Select top 1 ClientUserName from #ProxyLog_count_2)</code> shows <code>top 1</code> only but I need to get the 2nd data from that table. How can I do this?</p>\n"},{"tags":["sql","query","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":278,"score":0,"question_id":2852144,"title":"SQL Query with computed column","body":"<p>Please help me with a query. Assume that we have a table with columns:</p>\n\n<ul>\n<li>Transaction</li>\n<li>StartTime </li>\n<li>EndTime</li>\n</ul>\n\n<p>Now, I need a query with computed column of (value = EndTime-Startime).\nActually I need to group Users(Transaction has a FK for Users) and sort them by average time spent for transaction.</p>\n"},{"tags":["sql","query","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12583063,"title":"How can I JOIN tables conditionally?","body":"<p>I am working with a badly designed database and I ran into some problem.</p>\n\n<p>I have two tables that I need to join on a 'not unique ID'.\nThe software that currently works with the database sets a '0 value' in the id if there is an error. This means if I try to join them a massive amount of records is joined on the 0 values.</p>\n\n<p>Underneath an example of two tables and their not unique id fields i want to join them on</p>\n\n<pre><code>tbl1    tbl2\n-----------       \n2        2\n3        6\n4        5\n0        3\n0        4\n6        0\n5        0\n----------\n</code></pre>\n\n<p>What I want to achieve is this</p>\n\n<pre><code>tbl1    tbl2\n-----------         \n2        2\n3        3\n4        4\n0        * (no join)\n0        * (no join)\n6        6\n5        5\n----------\n</code></pre>\n\n<p>In other words, I don't want the '0 values' from tbl1 to join with all other '0 values' from tbl2. I still want to have the record tbl1 without a join though.</p>\n\n<p>Is this possible in 1 query?</p>\n\n<p>extra information: SQL SERVER 2005 and there is no option to make the ID's unique.</p>\n"},{"tags":["c#","asp.net","sql-server","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3433,"score":1,"question_id":6601302,"title":"Using a View from SQL Server 2008 in C# & Asp.net","body":"<p>I have a C#/ASP.net project has included a database that I have developed that includes a nice and convenient View that would be handy to use.</p>\n\n<p>I have the SQL connection setup to a SQL Server 2008 DB I created.  It seems as though it is connecting fine, but I don't understand how to actually use the View that I created without hard coding the query into the program (been told this is bad sometimes?).  </p>\n\n<p>This is my connection I setup:</p>\n\n<pre><code>    SqlConnection conn = null;\n    conn = new SqlConnection(\"Data Source=raven\\\\sqlexpress;Initial Catalog=ucs;Integrated Security=True;Pooling=False\");\n    conn.Open(); \n    SqlCommand command = new SqlCommand(query, conn);\n</code></pre>\n\n<p>Basically, I need some code to query using this View.  I can see the View and look at the results that would be obtained, but not access it in the program!\nThe view is named \"UserView\". Help is much appreciated!</p>\n"},{"tags":["wordpress","query","taxonomy","custom-taxonomy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12583759,"title":"Wordpress Query Taxonomy Wildcard","body":"<p>how can i get all posts <strong>with any</strong> term of a custom taxonomy and all posts <strong>without any</strong> term of a custom taxonomy?</p>\n\n<p>This is how i could get the terms by manually specifying all existing terms:</p>\n\n<pre><code>$args = array(\n    'actor'    =&gt; 'Actor 1, Actor2',\n    'order'    =&gt; 'ASC'\n);\nquery_posts($args);\n</code></pre>\n\n<p>So if a new term is added to the taxonomy i would have to change the sourcecode.</p>\n\n<p>This won't work to get all posts <strong>with any</strong>:</p>\n\n<pre><code>$args = array(\n    'actor'    =&gt; *,\n    'order'    =&gt; 'ASC'\n);\nquery_posts($args);\n</code></pre>\n\n<p>And this won't work to get all posts <strong>without any</strong>:</p>\n\n<pre><code>$args = array(\n    'actor'    =&gt; '',\n    'order'    =&gt; 'ASC'\n);\nquery_posts($args);\n</code></pre>\n\n<p>How can i do this?</p>\n"},{"tags":["mysql","sql","performance","query","join"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":12582162,"title":"Mysql: get 2 result from every cat [one to many relation ship]","body":"<p><strong>I'm searching for the best method to get result with database contain more than 100000 Post and more than 100000 Cat</strong> </p>\n\n<p>Here is my tables</p>\n\n<p><strong>Cats</strong></p>\n\n<pre><code>-----------------\n-  id   | name  |\n-----------------\n-  1    | x     |\n-----------------\n-  2    | y     |\n-----------------\n</code></pre>\n\n<p><strong>Post</strong></p>\n\n<pre><code>--------------------------------------\n-  id   | cat_id | title  | content  |\n--------------------------------------\n-  1    | 1      | Post 1 | .. . .  .|\n--------------------------------------\n-  2    | 1      | Post 2 | . . . . .|\n--------------------------------------\n-  3    | 2      | Post 3 | .. . .  .|\n--------------------------------------\n-  4    | 1      | Post 4 | . . . . .|\n--------------------------------------\n-  5    | 1      | Post 5 | .. . .  .|\n--------------------------------------\n-  6    | 2      | Post 6 | . . . . .|\n--------------------------------------\n-  7    | 1      | Post 7 | .. . .  .|\n--------------------------------------\n-  8    | 2      | Post 8 | . . . . .|\n--------------------------------------\n</code></pre>\n\n<p>Here's the Result I want to get</p>\n\n<p><strong>Result</strong></p>\n\n<pre><code>--------------------------------------\n-Postid | cat_id | title  | content  |\n--------------------------------------\n-  1    | 1      | Post 1 | .. . .  .|\n--------------------------------------\n-  2    | 1      | Post 2 | . . . . .|\n--------------------------------------\n-  3    | 2      | Post 3 | .. . .  .|\n--------------------------------------\n-  6    | 2      | Post 4 | . . . . .|\n--------------------------------------\n</code></pre>\n\n<p><strong>Here is Query I Just Write , But i look for Best query</strong></p>\n\n<pre><code>SELECT\n  *\nFrom \n  post\nWHERE posts.cat_id = 1 limit 2\n\nUNION\n\nSELECT\n  * \nFrom \n  post\nWHERE posts.cat_id = 2 limit 2\n</code></pre>\n\n<p><strong>What Happen if i want to get from 10 cats in one query</strong></p>\n"},{"tags":["mysql","query","group-by","sql-order-by","limit"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12580010,"title":"list record by MySQL query","body":"<p>I have mysql tables as below:</p>\n\n<pre><code>STORES\nstore_id, rating\n 10023      5\n 10024      5\n 10025      4\n 10026      4\n\nPRODUCTS\nproduct_id, store_id, price\n  10023         10023      5.00\n  10045         10023     130.00\n  10056         10023      10.00\n  10057         10024      20.00\n  10058         10024      12.00\n  10059         10025       7.00\n\n\nI need MYSQL query to retrieve records as below:\n  store_id,  product_id  Price\n    10023       10056    5.00\n    10023       10023    10.00\n    10024       10058    12.00\n    10024       10057    20.00\n    10025       10059     7.00\n</code></pre>\n\n<p>What's correct SQL query to list records based on Highest store rating first followed by cheapest price &amp; limit 2 from per stores?</p>\n"},{"tags":["c#","query","oracle10g","dumps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12421133,"title":"Best practices for querying large Oracle dumps","body":"<p>My customer wants to consolidate information from two oracle dumps into a report. These dumps are placed on a server by some interval and are both there size are about 5GB.\nI need to read the data from both dumps and group them into something useful. The big issue here is the performance, so my question is: How should you handle these kind of dumps, in a way that the performance stays acceptable?</p>\n\n<p>The relation of the dumps look like this:</p>\n\n<p>Orders(DUMP1) 1---* (DUMP1)products 1---* (DUMP2)transactions </p>\n\n<p>I hope you can give some guidance in how to approach such a project with large data queries.</p>\n"},{"tags":["sql","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12582047,"title":"select from db sql query","body":"<p>I have this query : </p>\n\n<pre><code>$query = mysql_query (\"SELECT *\n                         FROM saledb.application\n                       WHERE app_id = (\n                                       SELECT app_id\n                                         FROM saledb.applicationdetails\n                                        WHERE is_hot = '1'\n                                      ) LIMIT $Kvet,$Zet\n                      \");\n</code></pre>\n\n<p>And I have the following error:</p>\n\n<blockquote>\n  <p>Unable to save result set in\n  /home/lemondo/lemondosales.itnovations.ge/content/tpl/gtpl/main.php on\n  line 68</p>\n</blockquote>\n\n<p>When I changing select item with MAX(app_id) it works but i need show all results. i know where is problem mysql cant choose in one query meny ID but i need alternativ query.</p>\n"},{"tags":["mysql","database","query","migration","many-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12579635,"title":"MySQL: Migrating data into a many to many relationship from an OldDB plain table","body":"<p><em><strong>This is a very simplified graphical situation of the matter:</em></strong> <a href=\"http://i.stack.imgur.com/5NoRe.png\" rel=\"nofollow\">http://i.stack.imgur.com/5NoRe.png</a></p>\n\n<p>There are two DBs in different schemas, the old yellow one (one simple and plain table) and the new green one (with some relations like the one described above).</p>\n\n<p>The matter is that I want to migrate the info on the OldDB (over 40k rows) into the NewDB and I'm stucked with this relationship transformation. In the OldDB we had different fields for each center and depending on if their CHAR(1) = Y or = N, they were under some action or not.</p>\n\n<p>Now in the NewDB we have those centers in another table with their own id, and related with a Many to Many to the main table (b).</p>\n\n<p>So what I want is to go through each single center in the Old.DB (up to 20) and when it turns to be for example <code>center14 CHAR(1) = Y</code>, to set the <code>NewDB.center_has_b.center_id = 14</code> and <code>NewDB.center_has_b.b_id = OldDB.oldb.oldb_id</code>.</p>\n\n<p>I'm a newbie in MySQL but I was thinking on doing something like this, with no luck:</p>\n\n<pre><code>INSERT NewDB.center_has_b (center_id, b_id) (N, (SELECT oldb_id from OldDB.oldb WHERE centerN = 1));\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","database","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12493955,"title":"Query using joins (many m:n relations)","body":"<p>I have to do the following query either with Rails' active record or sql (sqlite). </p>\n\n<p>Let's start with the description of the model. </p>\n\n<ul>\n<li>User  1:n  Interest</li>\n<li>Interest  m:n  Category</li>\n<li>Interest  m:n  Location</li>\n<li>Event  m:n  Category</li>\n<li>Event  m:n  Location</li>\n</ul>\n\n<p>m:n relationships are being made possible through a third table with the pattern interests_categories, events_categories, etc.</p>\n\n<p>I've got users and those users have interests (Categories -> e.g. Sport, Music and locations he likes). Events get tagged with locations and categories.</p>\n\n<p>Now I'd like to list all the users that might fit to a specific events. For example, if there's an event that takes place in NYC and has something todo in sports, I'd like to get a list of users that might be interested in this event based on the location and categories.</p>\n\n<p>I'd like to do it in a single database access instead of multiple. \nHow would that look like in ActiveRecord or sql? (The more efficient way would be prefered)\nI'll probably have to join the Category/Location tables first, join the interests based on all the tables of the previously join and then select all the users based on the interests.\nUnfortunately I have limited knowledge of joins sql. Or is there even a different approach available?</p>\n"},{"tags":["oracle","query","schema"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12579767,"title":"Query which will bring table names according column name","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1953239/oracle-column-query-or-search\">Oracle column query or search</a>  </p>\n</blockquote>\n\n\n\n<p>I need a query which will bring name of the tables that contains that column name in oracle.</p>\n\n<p><strong>Example:</strong> Lets say that I have <code>table1</code> with columns <code>(a,b)</code>, <code>table2</code> with columns <code>(b,c)</code> and <code>table3</code> with columns <code>(a,b,c,d)</code> so I need a know which tables contain <code>C</code> column so I need a query which will bring table names, how I can do that ? </p>\n\n<p>Thanks</p>\n"},{"tags":["oracle","query","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12577221,"title":"Copy entire values of 2 columns from one table to another ensuring the relationship","body":"<p>I have a table <code>STUDENT</code> with columns <code>st_id,name,age,dept_name</code>. Now I want to create a new table <code>STUDENT_DESC</code> with columns <code>st_id,dept_name,st_desc</code>. So I need to copy all the values of <code>st_id</code> and <code>dept_name</code> to the newly created table <code>STUDENT_DESC</code>. I need to ensure relationship while copying <code>st_id</code> and <code>dept_name</code> , the <code>dept_name</code> should be corresponding to <code>st_id</code>.So how can I do it in PL/SQL?</p>\n"},{"tags":["ruby-on-rails","query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12578678,"title":"Append the query result to the first query result at the end","body":"<p>Suppose i have query 1 and query 2 in postgresql then i want a combine result of both the queries such that first i will get result set of query 1 and at the end of result set 1, result set 2 should get added.\nSuppose query 1 result set has 10 records and query 2 has 5 records then order should be\n1 to 10 -- first result set\n11 to 15 -- second result set</p>\n\n<p>Please suggest as i am confused because my 1st query contains order by for 5 types of data.   </p>\n"},{"tags":["php","mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12574980,"title":"How can i search all tables for a specific node value's parent_id?","body":"<p>There are several other posts like this but none which match my specific parameters/needs.</p>\n\n<p>How do i find the <code>parent_id</code> associated with one of 50 different outputted query results a user could click on?</p>\n\n<p>Like, if the user clicks on \"<code>Transportation</code>\" I need code that can find the <code>parent_id</code> corresponding to the transportation node.</p>\n\n<p>Problem is, my data is structure over multiple tables, so if they click on a link I don't necessarily know which table to search.</p>\n\n<p>Essentially what I want is <code>SELECT parent_id FROM * WHERE * = communication</code></p>\n\n<p>But I can't <code>*</code> for parameters such as table name.</p>\n\n<p>So how do I create code to automatically find the <code>parent_id</code> of a specific query once the user selects it?</p>\n\n<p>There must be a better option than listing all my <code>20 tables</code> in the query parameters? </p>\n\n<p>Should I restructure my data into 1 table?</p>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12578210,"title":"How to address column names with spaces in oracle, when the query is already inside double quotes?","body":"<p>I've a query like this, which is already in double quotes.</p>\n\n<pre><code>result = db.Query(\"SELECT ACTUAL_N_WELLS, TARGET_N_WELLS, YTD ACTUAL AS YTD_ACTUAL, \nYTD BUDGET AS YTD_BUDGET, (CONVERT(DATETIME,PERIOD,112)) AS DATES \nFROM DASH_GL_DRILLING_PERF\n WHERE ASSET_NAME='Bab &amp; Gas Asset' \nAND (  to_date(DASH_GL_DRILLING_PERF.PERIOD,'yyyy/mm/dd') &gt; \n(SELECT add_months(max(to_date(DASH_GL_DRILLING_PERF.PERIOD,'yyyy/mm/dd')),-3) \nfrom DASH_GL_DRILLING_PERF))\");\n</code></pre>\n\n<p>In this the column \"YTD ACTUAL\" and \"YTD BUDGET\" have spaces, but since the query is already inside double quotes, how do I write the column names? How can I escape the double quotes in this case?</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12576742,"title":"How to add the sum of totals in a single mysql table","body":"<p>I have the following MySQL table:</p>\n\n<p><li>Site_ID<br>\n<li>Serial Number<br>\n<li>cost_per_month<br>\n<li>cost_per_unit_A<br>\n<li>cost_per_unit_B<br>\n<li>opening_unit_A<br>\n<li>closing_unit_A<br>\n<li>opening_unit_B<br>\n<li>closing_unit_B<br></p>\n\n<p>I execute the folowing MySQL query:<br></p>\n\n<pre><code>select \nSITE_ID as 'Site', Serial Number,cost_per_month\ncost_per_unit_A, cost_per_unit_B,opening_unit_A, closing_unit_A, opening_unit_B, closing_unit_B\nformat(cost_per_month+(closing_unit_A-opening_unit_A)*cost_per_unit_A+(closing_unit_B-opening_unit_B)*cost_per_unit_A,2) as 'Total Vat Ex',\nformat((cost_per_month+(closing_unit_A-opening_unit_A)*cost_per_unit_A+(closing_unit_B-opening_unit_B)*cost_per_unit_A,*0.14,2)) as 'Vat',\nformat((cost_per_month+(closing_unit_A-opening_unit_A)*cost_per_unit_A+(closing_unit_B-opening_unit_B)*cost_per_unit_A,*1.14,2)) as 'Total Vat inclusive'\nwhere SITE_ID ='Site Name'\n</code></pre>\n\n<p>I would like to change this query so that the totals of the sum of the last addition queries are totaled.</p>\n\n<p>Would I use a group by statement?</p>\n"},{"tags":["query","jira"],"answer_count":7,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":920,"score":4,"question_id":7239532,"title":"JIRA - Resolved by me query","body":"<p>How to write query that will select only issues resolved by me.</p>\n\n<p>I have found some old post that says its no possible, but it might have changed.</p>\n"},{"tags":["mysql","sql","query","foreign-keys","inner-join"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":12488073,"title":"Selecting Rows Where Conditions Match A Single Row?","body":"<p>I have two tables that are connected via a Foreign Key. In table A I'm trying to get all the rows where the data in the time column is greater than or equal to the table B start column and where the data in the time column is less than or equal to the table b end column. I was thinking that an inner join might work for this, however, the results are not what I expected. It is returning some data but they are repeating themselves.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>SELECT * FROM columnA\nINNER JOIN columnB\nON columnA.time &gt;= columnB.start\nOR columnA.time &lt;= columnB.stop\n</code></pre>\n\n<p>Am I looking at this wrong? Is an inner join even the right way of collecting this data?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Actually tableA's Foreign Key is connecting to the Primary Key on tableB. Anyways I did this:</p>\n\n<pre><code>SELECT * FROM tableA\nINNER JOIN tableB\nON tableA.time &gt;= tableB.start\nAND tableA.time &lt;= tableB.stop\n</code></pre>\n\n<p>The reason I didn't do what you did for the on is because the data has been in the database for a couple years now and I just recently added the column with the foreign key. So that column doesn't have any data in it yet. That's why I'm querying it so I can know which columns to update with the information. It returned the data to me but also returned other data that didn't meet the requirements.</p>\n"},{"tags":["php","wordpress","query","function","meta-boxes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12575205,"title":"WordPress Get Page By ID returns strange results","body":"<p>I have a CMS setup for a client with three meta boxes for related content. All the client has to do is eneter a page slug (one in each) and the site will return the three related products.</p>\n\n<p>Everything was working fine until my client accidentally misspelled one of the slugs. Instead of returning nothing for this spot, WordPress returns about 6 random items.</p>\n\n<p>IN FUNCTIONS.PHP:</p>\n\n<pre><code>function get_ID_by_page_name($page_name) {\nglobal $wpdb;\n$page_name_id = $wpdb-&gt;get_var(\"SELECT ID FROM $wpdb-&gt;posts WHERE post_name = '\".$page_name.\"' AND post_type = 'page'\");\nreturn $page_name_id;\n</code></pre>\n\n<p>}</p>\n\n<p>IN THE TEMPLATE FILE:</p>\n\n<pre><code>$goesWith = get_post_meta($post-&gt;ID, 'goes_with', true);\n\nif (($goesWith) or ($goesWith2) or ($goesWith3)) {\n\n            echo \"&lt;div class='goes-with'&gt;\";\n\n            echo  \"&lt;h2&gt;Goes Great With:&lt;/h2&gt;\";                      \n\n            // OPTION ONE\n\n                $pageID = get_ID_by_page_name($goesWith);\n\n                    if ($goesWith) { \n\n                        $args = array(\n                            'post_type'      =&gt; 'page',\n                            'page_id'     =&gt; $pageID,\n                            'post_status' =&gt; 'publish'\n                        );\n                        query_posts( $args );\n\n                        while(have_posts()) {\n\n                            the_post(); // vital                                                        \n\n                            echo \"&lt;div class='post-product'&gt;\";\n                            echo \"&lt;a href=\";\n                            the_permalink();\n                            echo \"&gt;\";\n                            thumbPath(140, 140);\n                            echo \"&lt;/a&gt;&lt;a href=\";\n                            the_permalink();\n                            echo \"&gt;&lt;p&gt;\";\n                            the_title();\n                            echo \"&lt;/p&gt;&lt;/a&gt;&lt;/div&gt;&lt;!--end post-product--&gt;\";\n\n                       }\n\n\n\n                    }\n\n                    else {\n\n                        echo \"\";\n\n                    } \n\n\n            wp_reset_query();  \n</code></pre>\n"},{"tags":["android","query","api","google","checkout"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12506237,"title":"How do I query Google Checkout using an order number?","body":"<p>I have a merchant account on Google checkout.  I can view all the orders buyers put when I log on to <a href=\"https://checkout.google.com/sell/orders\" rel=\"nofollow\">https://checkout.google.com/sell/orders</a>.  From there, I can search for a specific order number and view details about it.<br>\nI want to do the same programmatically, but after looking through the checkout API I can not find anything related to this issue.  Basically my input will be an order number and the output I want will be details regarding that ordre, or at least a boolean indicating whether that order exists or not.</p>\n\n<p>Thanks!!</p>\n"},{"tags":["query","mongodb","index","sharding","optimizer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12569522,"title":"MongoDB uses wrong index","body":"<p>I am having trouble understanding this issue - I have a sharded cluster in which one of the shards (Shard 2) seems to use the wrong index.  Im querying by the shard key, which is site id and first request time <code>{ site.id: 1, frt: 1 }</code>.  I also have an index on site id and last request time.</p>\n\n<p>In this query, I am also trying to limit returned documents by a couple booleans I have set in the document. </p>\n\n<p>Reading the docs on how Mongo's Query Optimizer works, this seems especially weird to me looking at the returned Explains.  Docs here: <a href=\"http://www.mongodb.org/display/DOCS/Query+Optimizer\" rel=\"nofollow\" title=\"Query Optimizer\">Query Optimizer</a></p>\n\n<p>I also included an explain from Shard 1 where the query returns as expected.  Lastly, if I use a site id which does not have chunks stored on Shard 2, it uses the correct index, though it has nothing to scan nor return.  Added explain for this to the end for completeness.</p>\n\n<p>Any ideas why this would happen and/or if this is a bug?</p>\n\n<p><strong>Basic query (bad index):</strong></p>\n\n<pre><code>shard2:PRIMARY&gt; db.visit.find({ \"site.id\": 128, \"frt\": { $gte: new Date(2012, 8, 24 ) }, \"ue\": false, \"bot\": false }).explain()\n{\n    \"cursor\" : \"BtreeCursor site.id_1_lrt_-1\",\n    \"isMultiKey\" : false,\n    \"n\" : 198,\n    \"nscannedObjects\" : 61204,\n    \"nscanned\" : 61204,\n    \"nscannedObjectsAllPlans\" : 61537,\n    \"nscannedAllPlans\" : 61537,\n    \"scanAndOrder\" : false,\n    \"indexOnly\" : false,\n    \"nYields\" : 122,\n    \"nChunkSkips\" : 0,\n    \"millis\" : 727,\n    \"indexBounds\" : {\n        \"site.id\" : [\n            [\n                128,\n                128\n            ]\n        ],\n        \"lrt\" : [\n            [\n                {\n                    \"$maxElement\" : 1\n                },\n                {\n                    \"$minElement\" : 1\n                }\n            ]\n        ]\n    },\n    \"server\" : \"ip-10-4-211-107:2200\"\n}\n</code></pre>\n\n<p><strong>Supplying a Hint:</strong></p>\n\n<pre><code>shard2:PRIMARY&gt; db.visit.find({ \"site.id\": 128, \"frt\": { $gte: new Date(2012, 8, 24 ) }, \"ue\": false, \"bot\": false }).hint(\"site.id_1_frt_1\").explain()\n{\n    \"cursor\" : \"BtreeCursor site.id_1_frt_1\",\n    \"isMultiKey\" : false,\n    \"n\" : 198,\n    \"nscannedObjects\" : 486,\n    \"nscanned\" : 486,\n    \"nscannedObjectsAllPlans\" : 486,\n    \"nscannedAllPlans\" : 486,\n    \"scanAndOrder\" : false,\n    \"indexOnly\" : false,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"millis\" : 5,\n    \"indexBounds\" : {\n        \"site.id\" : [\n            [\n                128,\n                128\n            ]\n        ],\n        \"frt\" : [\n            [\n                ISODate(\"2012-09-24T07:00:00Z\"),\n                ISODate(\"292278995-01--2147483647T07:12:56.808Z\")\n            ]\n        ]\n    },\n    \"server\" : \"ip-10-4-211-107:2200\"\n}\n</code></pre>\n\n<p><strong>Same query WITHOUT additional boolean constraints (uses correct Index):</strong></p>\n\n<pre><code>shard2:PRIMARY&gt; db.visit.find({ \"site.id\": 128, \"frt\": { $gte: new Date(2012, 8, 24 ) } }).explain()\n{\n    \"cursor\" : \"BtreeCursor site.id_1_frt_1\",\n    \"isMultiKey\" : false,\n    \"n\" : 486,\n    \"nscannedObjects\" : 486,\n    \"nscanned\" : 486,\n    \"nscannedObjectsAllPlans\" : 486,\n    \"nscannedAllPlans\" : 486,\n    \"scanAndOrder\" : false,\n    \"indexOnly\" : false,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"millis\" : 1,\n    \"indexBounds\" : {\n        \"site.id\" : [\n            [\n                128,\n                128\n            ]\n        ],\n        \"frt\" : [\n            [\n                ISODate(\"2012-09-24T07:00:00Z\"),\n                ISODate(\"292278995-01--2147483647T07:12:56.808Z\")\n            ]\n        ]\n    },\n    \"server\" : \"ip-10-4-211-107:2200\"\n}\n</code></pre>\n\n<p><strong>On Shard 1, Original Query uses expected index:</strong></p>\n\n<pre><code>shard1:PRIMARY&gt; db.visit.find({ \"site.id\": 253, \"frt\": { $gte: new Date(2012, 8, 24 ) }, \"ue\": false, \"bot\": false }).explain()\n{\n    \"cursor\" : \"BtreeCursor site.id_1_frt_1\",\n    \"isMultiKey\" : false,\n    \"n\" : 15615,\n    \"nscannedObjects\" : 15950,\n    \"nscanned\" : 15950,\n    \"nscannedObjectsAllPlans\" : 16152,\n    \"nscannedAllPlans\" : 16152,\n    \"scanAndOrder\" : false,\n    \"indexOnly\" : false,\n    \"nYields\" : 125,\n    \"nChunkSkips\" : 0,\n    \"millis\" : 237,\n    \"indexBounds\" : {\n        \"site.id\" : [\n            [\n                253,\n                253\n            ]\n        ],\n        \"frt\" : [\n            [\n                ISODate(\"2012-09-24T07:00:00Z\"),\n                ISODate(\"292278995-01--2147483647T07:12:56.808Z\")\n            ]\n        ]\n    },\n    \"server\" : \"ip-10-6-50-253:2100\"\n}\n</code></pre>\n\n<p><strong>Query on Shard 2 for Site with no chunks here ( Uses correct index ):</strong></p>\n\n<pre><code>shard2:PRIMARY&gt; db.visit.find({ \"site.id\": 253, \"frt\": { $gte: new Date(2012, 8, 24 ), \"ue\": false, \"bot\": false } }).explain()\n{\n    \"cursor\" : \"BtreeCursor site.id_1_frt_1\",\n    \"isMultiKey\" : false,\n    \"n\" : 0,\n    \"nscannedObjects\" : 0,\n    \"nscanned\" : 0,\n    \"nscannedObjectsAllPlans\" : 0,\n    \"nscannedAllPlans\" : 0,\n    \"scanAndOrder\" : false,\n    \"indexOnly\" : false,\n    \"nYields\" : 0,\n    \"nChunkSkips\" : 0,\n    \"millis\" : 0,\n    \"indexBounds\" : {\n        \"site.id\" : [\n            [\n                253,\n                253\n            ]\n        ],\n        \"frt\" : [\n            [\n                ISODate(\"2012-09-24T07:00:00Z\"),\n                ISODate(\"292278995-01--2147483647T07:12:56.808Z\")\n            ]\n        ]\n    },\n    \"server\" : \"ip-10-4-211-107:2200\"\n}\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12573002,"title":"MYSQL Tuple in IN CLause with wildcard matching","body":"<p>I have the following problem. suppose I have a table containing an inventory of cars:</p>\n\n<pre><code>VIN, MAKE, MODEL, PRICE\n</code></pre>\n\n<p>AND I have another table containing various car classes( eg, compact, mid-sized, suv, etc)</p>\n\n<pre><code>MAKE, MODEL, CLASS\nJEEP, NULL , SUV\nFORD, EXPLORER, SUV\nTOYOTA, YARIS, COMPACT\nNULL, CUBE, COMPACT\n...\n</code></pre>\n\n<p>I am wondering how can I select all cars in the database of a certain class? Perhaps, I want to know how many cars of each class exists?</p>\n\n<p>I can write a query like this.</p>\n\n<pre><code>SELECT COUNT(*) FROM CARS WHERE (MAKE, MODEL) IN (SELECT MAKE, MODEL FROM CLASSES WHERE CLASS = 'SUV')\n</code></pre>\n\n<p>The problem here, I wont actually be able to deal with NULLs in my data. I want to say that all models of JEEP are SUVs, or any MAKE car that's called CUBE would be a compact car. </p>\n\n<p>Could this be done assuming there are no conflicts? Can I have a priority set up, like All Porches are CARS except the Cayenne which is an SUV by doing something like this:</p>\n\n<pre><code>MAKE, MODEL, CLASS\nPORCHE, NULL , CAR\nPORCHE, CAYENNE, SUV\n</code></pre>\n\n<p>If this isn't possible with MySQL, is there a better DB technology out there that would be good at this. Lets assume that The CLASSES Table would Contain 50K+ Rows and The CARS Table would contain 5M+ Rows. I am looking for a fast way of performing such a query in the database, and not needing to fetch millions of rows to process in a script? Also What if its not just Make and Model, but also sub-model, engine, etc.. </p>\n\n<p>Also, I simplified the data quite a bit, there are 4 levels of hierarchy.</p>\n\n<p>Thanks In advanced</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":112,"score":0,"question_id":12540115,"title":"SQL: Rank ordered query","body":"<p>I am in Access 2010 and am trying to create a rank or row number field for a query which is ordered in a specific way. I have tried <code>Rank: DCount(\"id\",\"[Query1]\",\"id &lt;= \" &amp; [id])</code> but it ignores my Query's sort, since the order is NOT as the ID Primary Key.</p>\n"},{"tags":["android","sql","query","sqlite","select"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12573036,"title":"How do I combine two queries into one?","body":"<p>This is for Android SQLite. I have two queries like this:</p>\n\n<pre><code>select * from table where name='name';\n</code></pre>\n\n<p>and</p>\n\n<pre><code>select * from table where name!='name' order by name;\n</code></pre>\n\n<p>I want to create a statement which combines these two queries. I tried union all but I can't do order by one statement and then combine. I tried this:</p>\n\n<pre><code>select * from table where name='name'\nunion all\nselect * from table where name!='name' order by name;\n</code></pre>\n\n<p>All it did is to combine the queries and then order by name. I don't want that. I want to do order by on the second statement first and then combine them.</p>\n\n<p>To put the question differently, here is my data:</p>\n\n<pre><code>Name\n\na\nb\nc\nd\ne\nf\ng\nh\ni\nj\n</code></pre>\n\n<p>But I want the output to be:</p>\n\n<pre><code>Name\n\ng\na\nb\nc\nd\ne\nf\nh\ni\nj\n</code></pre>\n\n<p>I want to get one row to the top and then order the rest of the rows. Any help is appreciated.</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12573526,"title":"How do i assign a specific node as a variable value without outputting it?","body":"<p>I only have 5 days of experience with MySQL so have not yet developed a natural understanding of the capabilities of the language.</p>\n\n<p>I have created a database where a query is performed and output is generated as links which, when clicked, perform  another query in the database for all subcategories of the clicked node.</p>\n\n<p>Up until now, i have literally been passing the name of the query onclick as a variable in order to allow for the next search.</p>\n\n<p>i.e. if the user clicks on \"health and fitness\", the string \"health and fitness\" is literally passed via variable and plugged in to the next query.</p>\n\n<p>However i have realized i need a more powerful method of transferring the appropriate data about each node from search to search.</p>\n\n<p>i.e. if someone clicks on \"health and fitness\" i want to not only pass that string via url as a variable, but also pass other information related to that category, i.e. its id number and parent_id.</p>\n\n<p>So essentially, whichever of several queries a user clicks on, i want to be able to send that query as a string, and its parent id through to the php page which will query and display data accordingly.</p>\n\n<p>I'm thinking i should create a variable to hold the data i want which gets put in the onclick url on each repetition of the query results loop.</p>\n\n<p>However I'm still not sure how to navigate databases or assign specific row/column values to a variable.</p>\n"},{"tags":["sql-server","xml","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":10810957,"title":"Query inside WITH XMLNAMESPACE clause","body":"<p>is it possible to get some data of the namespaces in the result xml of FOR XML Clause \nfrom database </p>\n\n<p>e.g. </p>\n\n<pre><code>WITH XMLNAMESPACES ('uri1' as ns1, \n                'uri2' as ns2,\n                DEFAULT 'uri2')\nSELECT ProductID, \n  Name,\n  Color\nFROM Production.Product \nWHERE ProductID=316 or ProductID=317\nFOR XML RAW ('ns1:Product'), ROOT('ns2:root'), ELEMENTS\n</code></pre>\n\n<p>RESULTS : </p>\n\n<pre><code>     &lt;ns2:root xmlns=\"uri2\" xmlns:ns2=\"uri2\" xmlns:ns1=\"uri1\"&gt;\n   &lt;ns1:Product&gt;\n&lt;ProductID&gt;316&lt;/ProductID&gt;\n&lt;Name&gt;Blade&lt;/Name&gt;\n  &lt;/ns1:Product&gt;\n  &lt;ns1:Product&gt;\n&lt;ProductID&gt;317&lt;/ProductID&gt;\n&lt;Name&gt;LL Crankarm&lt;/Name&gt;\n&lt;Color&gt;Black&lt;/Color&gt;\n &lt;/ns1:Product&gt;\n  &lt;/ns2:root&gt;\n</code></pre>\n\n<p>WHAT IF I'D LIKE TO GET THE VALUE OF  FROM INSIDE DATABASE ? </p>\n\n<p>something like this : </p>\n\n<pre><code>WITH XMLNAMESPACES ('uri1' as ns1, \n           **(SELECT namespace from tableName)** as ns2,\n            DEFAULT 'uri2')\n</code></pre>\n"},{"tags":["php","query","limit","limit-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12572977,"title":"Where to place limit clause?","body":"<p>I am trying to place a limit clause on the database query to only show the first 4 results.</p>\n\n<p>The current code I am working with is</p>\n\n<pre><code>    $categories_query = \"select c.categories_id, cd.categories_name, c.parent_id\n                      from \" . TABLE_CATEGORIES . \" c, \" . TABLE_CATEGORIES_DESCRIPTION . \" cd \n                       where c.categories_id = cd.categories_id\n                       and c.categories_status=1 \" .\n//                             \"and c.categories_id = ptc.category_id \" .\n//                             \"and ptc.category_id = cd.categories_id \" .\n//                             \"and ptc.product_type_id not in  \" . $this-&gt;document_types_list . \"\n                       \" and cd.language_id = '\" . (int)$_SESSION['languages_id'] . \"'\n                         order by c.parent_id, c.sort_order, cd.categories_name\";\n         $categories = $db-&gt;Execute($categories_query);\n         while (!$categories-&gt;EOF) {\n           $this-&gt;data[$categories-&gt;fields['parent_id']][$categories-&gt;fields['categories_id']] = array('name' =&gt; $categories-&gt;fields['categories_name'], 'count' =&gt; 0);\n           $categories-&gt;MoveNext();\n         }\n</code></pre>\n\n<p>The problem that I am having is I found a way to limit only 4 results by placing <code>LIMIT 4</code> after the order query, and it shows the first 4 parent categories, but it also removes the sub categories from the list. </p>\n\n<p>So I want to take this </p>\n\n<pre><code>&lt;ul&gt;\n   &lt;li&gt;Menu One&lt;/li&gt;\n   &lt;li&gt;Menu Two\n      &lt;ul&gt;\n         &lt;li&gt;Submenu One&lt;/li&gt;\n         &lt;li&gt;Submenu Two&lt;/li&gt;\n         &lt;li&gt;Submenu Three&lt;/li&gt;\n      &lt;/ul&gt;\n   &lt;/li&gt;\n   &lt;li&gt;Menu Three&lt;/li&gt;\n   &lt;li&gt;Menu Four&lt;/li&gt;\n   &lt;li&gt;Menu Five&lt;/li&gt;\n   &lt;li&gt;ect...&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>and see this</p>\n\n<pre><code>&lt;ul&gt;\n   &lt;li&gt;Menu One&lt;/li&gt;\n   &lt;li&gt;Menu Two\n      &lt;ul&gt;\n         &lt;li&gt;Submenu One&lt;/li&gt;\n         &lt;li&gt;Submenu Two&lt;/li&gt;\n         &lt;li&gt;Submenu Three&lt;/li&gt;\n      &lt;/ul&gt;\n   &lt;/li&gt;\n   &lt;li&gt;Menu Three&lt;/li&gt;\n   &lt;li&gt;Menu Four&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>and when placing 'LIMIT 4' in the query it only shows this</p>\n\n<pre><code>&lt;ul&gt;\n   &lt;li&gt;Menu One&lt;/li&gt;\n   &lt;li&gt;Menu Two&lt;/li&gt;\n   &lt;li&gt;Menu Three&lt;/li&gt;\n   &lt;li&gt;Menu Four&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>How do I keep the subcategories with the parent categories? Aparently calling only the first 4 does not call the categories under it</p>\n"},{"tags":["query","drupal","views","glossary"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12571227,"title":"Drupal 7 views how to modify where clause?","body":"<p>I have a situation whereby i have to add a 0-9 link in the contextual filter of the glossary view</p>\n\n<p>How do i change the where clause part?\ni need to change </p>\n\n<pre><code>SUBSTRING(node.title, 1, :node_title) = :node_title1\n</code></pre>\n\n<p>to</p>\n\n<pre><code>SUBSTRING(node.title, 1, 1) =REGEXP ('[0-9]')\n</code></pre>\n\n<p>if certain value == '0-9'\ni tried to implement hook_views_query_alter but it is not working</p>\n\n<pre><code>function  custom_views_query_alter(&amp;$view, &amp;$query){\n\n  $current_view=&amp;$view;\n\n  switch($current_view-&gt;name){\n\n    case  'glossary':\n\n  if($query-&gt;where[0]['conditions'][0]['value'][':node_title1']=='0-9'){\n    $query-&gt;where[0]['conditions'][0]['field']= \"SUBSTRING(node.title, 1, 1) =REGEXP ('[0-9]')\";\n    echo \"YES\";\n\n    dpm($query-&gt;where);\n        }  } }\n</code></pre>\n"},{"tags":["php","mysqli","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":2382373,"title":"MySQLi query in PHP isn't working right, is there a way to get the exact query?","body":"<p>Is there a way to get the query after <a href=\"http://en.wikipedia.org/wiki/MySQLi\" rel=\"nofollow\">MySQLi</a> prepares it? My query is messing up:</p>\n\n<pre><code>$query = \"UPDATE event SET group=?, boxed=?, name=?, location=?, time=?, day=?, type=? WHERE id=? LIMIT 1\";\nif($stmt = $db -&gt; prepare($query))\n{\n    $stmt -&gt; bind_param(\"iisssssi\", $group, $boxed, $name, $location, $time, $day, $etype, $id);\n    $stmt -&gt; execute();\n    $stmt -&gt; close();\n}\nelse\n</code></pre>\n\n<p>Error message:</p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'group=?, boxed=?, name=?, location=?, time=?, day=?, type=? WHERE id=? LIMIT 1' at line 1</p>\n</blockquote>\n\n<p>Variable <code>group</code> is an int, <code>boxed</code> is an int, the rest are strings, and <code>id</code> is an int.</p>\n"},{"tags":["mysql","sql","query","gtfs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":11913508,"title":"Sql queries for getting information from GTFS files in Java","body":"<p>I'm working on a project for school which uses <a href=\"http://code.google.com/p/gtfsdb/\" rel=\"nofollow\">gtfs database</a> (MySQL).\nI wrote some code that parses the gtfs files and inserts them into MySQL DB (each file is a table in my DB).\nI'm trying to write two SQL queries:</p>\n\n<ol>\n<li><p>Given a <code>stationId</code>, <code>time</code>, and <code>line number</code> - I want to get all trips that pass by this station in the next 10 minutes.</p></li>\n<li><p>Given a <code>tripId</code>, <code>directionId</code> and <code>stopId</code> - I want to get all the remaining stations in this trip (in order to draw on a map the stations to come in my trip). </p></li>\n</ol>\n\n<p>Does anyone knows how can I state this SQL queries in Java? </p>\n\n<hr>\n\n<p>I tried this:</p>\n\n<pre><code>SELECT * FROM stops, routes, stop_times, calendar, trips\nwhere departure_time &gt; \"08:24:00\"\n  and departure_time &lt; \"16:40:00\"\n  and route_short_name = \"10\"\n  and stops.stop_id = 29335\n  and stops.stop_id = stop_times.stop_id\n  and stop_times.trip_id = trips.trip_id\n  and calendar.service_id = trips.service_id\n  and calendar.sunday = 1\n</code></pre>\n"},{"tags":["c#","query","ddd-repositories"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12569294,"title":"Abstraction layer between repository and data access code","body":"<p>I try to isolate repository from actual data storage implementation. I have little problem to create some simple query with this abstraction.</p>\n\n<p>Example I need list of orders with number of order lines in order.</p>\n\n<p>Repository method returns list of OrderInfo objects.</p>\n\n<pre><code>class OrderInfo\n{\n    string Title { get; set; }\n    int NumberOfLines { get; set; }\n}\n</code></pre>\n\n<p>Data storage does not contain any field directly containing order line count so it must be calculated on the fly.</p>\n\n<p>This can be easily archived with simple sql query (count + group by) when query is directly written into repository method.</p>\n\n<p>If I try to create some kind of abstraction layer I got lost how to \"define query without using any storage dependant thing with it including that it should return number of order lines for each order\".</p>\n\n<p>Or am I totally going to wrong direction?</p>\n"},{"tags":["php","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12475710,"title":"How do i create a searchable database within a section of a web page?","body":"<p>I'm trying to create a catalogue that site users can search to find products and stores. However I want the catalogue to be browsable via a portion of a web page without reloading or changing the page every time, because there are nav bars and other contents which i want to remain on the page and because reload is way too slow and unseemly.</p>\n\n<p>The necessary components:\n1. I want the catalogue to be browsable either by a search bar, or by clicking on predefined categories displayed within the \"frame\" of the catalogue.\n2. I want to be able to apply filters to results via a pane external to the catalogue but on the same page.</p>\n\n<p>So let's say i have categories:</p>\n\n<p>Health\nHome\nFinance\netc.</p>\n\n<p>Displayed in the \"frame.\"</p>\n\n<p>How could i make it so a user could click on one of those categories and the database search results of that category would populate in that space, which would be filtered into further sub categories which could also be clicked?</p>\n\n<p>So basically i want database navigation within a portion of a web page.</p>\n\n<p>How can i do this without using iframe? Ajax or something?</p>\n\n<p>I feel like there's a really easy way but I'm not familiar enough with web development yet to know...</p>\n\n<p>Thanks for all the help!</p>\n"},{"tags":["mysql","query","optimization","social-networking","social"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12568131,"title":"Query Optimization for Friends Feed - MySQL","body":"<p>I'm having my weird trouble with a friends feed query - here is the background:</p>\n\n<p>I have 3 tables</p>\n\n<pre><code>checkin - around 13m records\nusers - around 250k records\nfriends - around 1.5m records\n</code></pre>\n\n<p>In the checkin table - it lists activity that are performed by users. (here are numerous indexes, however there is an index on user_id, created_at, and (user_id,created_at).\nThe users table is just the basic user information There is an index on user_id.\nThe friends table has a user_id, target_id and is_approved. There is an index on the (user_id, is_approved) fields.</p>\n\n<p>In my query, I am trying to pull down just a basic friends feed of any users - so I have been doing this:</p>\n\n<pre><code>SELECT checkin_id, created_at\nFROM checkin\nWHERE (user_id IN (SELECT friend_id from friends where user_id = 1 and is_approved = 1) OR user_id = 1)\nORDER by created_at DESC\nLIMIT 0, 15\n</code></pre>\n\n<p>The goal of the query is just to pull the checkin_id and created_at for all the users' friend plus their activity. It's a pretty simple query, but when a user's friends have tons of recent activity, this query is very quick, here is the EXPLAIN:</p>\n\n<pre><code> id     select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n 1  PRIMARY     checkin     index   user_id,user_id_2   created_at  8   NULL    15  Using where\n 2  DEPENDENT SUBQUERY friends  eq_ref    user_id,friend_id,is_approved,friend_looku...     PRIMARY     8   const,func  1   Using where\n</code></pre>\n\n<p>As an explanation, user_id is a simple index on user_id - while user_id_2 is an index on user_id and created_at. On the friends table, friends_lookup is the index of user_id and is_approved.</p>\n\n<p>This is a very simple query and get's completed in: Showing rows 0 - 14 (15 total, Query took 0.0073 sec).</p>\n\n<p>However when a user's friends activity is not very recent and there isn't a lot of the data, the same query takes around 5-7 seconds and it has the same EXPLAIN as the previous query - but takes longer.</p>\n\n<p>It doesn't seem to have an affect on more friends, it seems to speed up with more recent activity.</p>\n\n<p>Is there any tips that anyone have to optimize these queries to makes sure they run the same speed irregardless of activity?</p>\n\n<p><strong>Server Setup</strong></p>\n\n<p>This is a dedicated MySQL server running 16GB of RAM. It is running Ubuntu 10.10 and the version of MySQL is 5.1.49</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>So most people have suggested remove the IN piece and move them into a INNER JOIN:</p>\n\n<pre><code>SELECT c.checkin_id, c.created_at\nFROM checkin c\nINNER JOIN friends f ON c.user_id = f.friend_id\nWHERE f.user_id =1\nAND f.is_approved =1\nORDER BY c.created_at DESC\nLIMIT 0 , 15\n</code></pre>\n\n<p>This query is 10x worse - as reported in the EXPLAIN:</p>\n\n<pre><code> id     select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n 1  SIMPLE  f   ref     PRIMARY,user_id,friend_id,is_approved,friend_looku...   friend_lookup   5   const,const     938     Using temporary; Using filesort\n 1  SIMPLE  c   ref     user_id,user_id_2   user_id     4   untappd_prod.f.friend_id    71  Using where\n</code></pre>\n\n<p>The goal of this query to get all the friends activity, and yours in the same query (instead of having to create two queries and merge the results together and sort by created_at). I also can't remove the index on user_id as it's important piece of another query.</p>\n\n<p>The interesting part is when I run this query on a user account that doesn't have a lot activity, I get this explain:</p>\n\n<pre><code> id     select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n 1  SIMPLE  f   index_merge     PRIMARY,user_id,friend_id,is_approved,friend_looku...    user_id,friend_lookup  4,5     NULL    11  Using intersect(user_id,friend_lookup); Using wher...\n 1  SIMPLE  c   ref     user_id,user_id_2   user_id     4   untappd_prod.f.friend_id    71  Using where\n</code></pre>\n\n<p>Any advice?</p>\n"},{"tags":["python","django","query"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2087,"score":2,"question_id":852404,"title":"How to dynamically compose an OR query filter in Django?","body":"<p>From an example you can see a multiple OR query filter:</p>\n\n<blockquote>\n  <blockquote>\n    <blockquote>\n      <p>Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))</p>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>For example, this results in:</p>\n\n<pre><code>[&lt;Article: Hello&gt;, &lt;Article: Goodbye&gt;, &lt;Article: Hello and goodbye&gt;]\n</code></pre>\n\n<p>However, I want to create this query filter from a list. How to do that?</p>\n\n<p>e.g. [1, 2, 3] -> Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))</p>\n"},{"tags":["python","django","query"],"answer_count":6,"favorite_count":13,"up_vote_count":8,"down_vote_count":0,"view_count":3601,"score":8,"question_id":852414,"title":"How to dynamically compose an OR query filter in Django?","body":"<p>From an example you can see a multiple OR query filter:</p>\n\n<blockquote>\n  <blockquote>\n    <blockquote>\n      <p>Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))</p>\n    </blockquote>\n  </blockquote>\n</blockquote>\n\n<p>For example, this results in:</p>\n\n<pre><code>[&lt;Article: Hello&gt;, &lt;Article: Goodbye&gt;, &lt;Article: Hello and goodbye&gt;]\n</code></pre>\n\n<p>However, I want to create this query filter from a list. How to do that?</p>\n\n<p>e.g. [1, 2, 3] -> Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))</p>\n"},{"tags":["mysql","query","zend-framework","date","zend-db"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12567197,"title":"use part of string in query","body":"<p>i have a mysql table with date of birth, so an example field would be:</p>\n\n<pre><code>dob\n----\n1989-01-01\n</code></pre>\n\n<p>I have pulled todays date in zend framework with the following code:</p>\n\n<pre><code>public function todaysDate()\n    {\n        $date = new Zend_Date();\n        $date = $date-&gt;get(Zend_Date::MONTH_SHORT . '-' . Zend_Date::DAY_SHORT);\n        return $date;\n    }\n</code></pre>\n\n<p>This shows current date in format:</p>\n\n<pre><code>9-24\n</code></pre>\n\n<p>Now i want to search the dob field in my mysql table for anyway with the month 9 and day 24 in their dob disregarding year. how do i do this?</p>\n\n<p>please note the dob is not a date field, its a text field</p>\n"},{"tags":["mysql","sql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":81,"score":3,"question_id":12563065,"title":"SQL: Need help selecting distinct ID's from a table that matches two similar columns","body":"<p>*<strong><em>UPDATED QUESTION</em>*</strong></p>\n\n<p>Sorry since this question evolved so much, here's an updated version so hopefully things are slightly clearer :-)</p>\n\n<p>If you can help me solve this I'd be really grateful!</p>\n\n<p>I have this table of data:</p>\n\n<pre><code>+-----+-----------+------------------------------------+---------+\n| ID  | post_type | name                               | term_id |\n+-----+-----------+------------------------------------+---------+\n| 278 | supplier  | Heating                            |      15 |\n| 282 | supplier  | Central Heating                    |      16 |\n| 278 | supplier  | Biomass                            |      17 |\n| 278 | supplier  | Ground Source Heat Pumps           |      18 |\n| 278 | supplier  | Passive Solar                      |      19 |\n| 282 | supplier  | Air Source Heat Pumps              |      21 |\n| 278 | supplier  | Air Conditioning                   |      22 |\n| 278 | supplier  | Boilers                            |      23 |\n| 277 | supplier  | Lighting                           |      25 |\n| 277 | supplier  | LED's                              |      26 |\n| 282 | supplier  | Halogen                            |      28 |\n| 277 | supplier  | CFL                                |      29 |\n| 282 | supplier  | Sustainable Construction Materials |      31 |\n| 282 | supplier  | Plaster                            |      33 |\n| 282 | supplier  | Floors                             |      37 |\n| 282 | supplier  | Water                              |      38 |\n| 282 | supplier  | Showers &amp;amp; Baths                |      43 |\n| 278 | supplier  | Cooling                            |      44 |\n| 278 | supplier  | Refrigeration                      |      46 |\n| 282 | supplier  | Passive Design                     |      47 |\n| 278 | supplier  | Chillers                           |      48 |\n| 282 | supplier  | Renewable Energy                   |      49 |\n| 282 | supplier  | Air Source Heat Pumps              |      53 |\n| 282 | supplier  | Biomass Heating                    |      55 |\n| 282 | supplier  | Biofuels                           |      57 |\n| 282 | supplier  | Insulation                         |      61 |\n| 282 | supplier  | Wall                               |      63 |\n| 282 | supplier  | Floor                              |      64 |\n| 282 | supplier  | Draught Proofing                   |      65 |\n| 282 | supplier  | Energy Efficiency                  |      70 |\n| 282 | supplier  | Gas Boiler Management Systems      |      71 |\n| 282 | supplier  | Low Energy Lighting                |      72 |\n| 282 | supplier  | Voltage Control                    |      73 |\n| 282 | supplier  | Smart Meters                       |      74 |\n| 282 | supplier  | Electric Heating                   |      75 |\n+-----+-----------+------------------------------------+---------+\n</code></pre>\n\n<p>And need to extract a list of <code>ID</code>s that apply to BOTH a specified <code>name</code> (wildcard string) and a <code>term_id</code> (integer). So for example I'd search for the <code>ID</code>s that have a <code>name LIKE '%Lighting%'</code> and a <code>term_id = 26</code>...which should return <code>ID 277</code>.</p>\n\n<p>The following query works but isn't pretty:</p>\n\n<pre><code>SELECT a.ID, d.name, d.term_id\nFROM cn_posts AS a\nINNER JOIN cn_postmeta AS b ON a.ID = b.post_id\nINNER JOIN cn_term_relationships AS c ON a.ID = c.object_id\nINNER JOIN cn_terms AS d ON c.term_taxonomy_id = d.term_id\nWHERE a.post_status = 'publish'\nAND d.name LIKE '%Lighting%'\nAND a.ID IN (\n    SELECT a.ID\n    FROM cn_posts AS a\n    INNER JOIN cn_postmeta AS b ON a.ID = b.post_id\n    INNER JOIN cn_term_relationships AS c ON a.ID = c.object_id\n    INNER JOIN cn_terms AS d ON c.term_taxonomy_id = d.term_id\n    WHERE d.term_id = '26'\n)\nGROUP BY a.ID\n</code></pre>\n\n<p>I've tried the following queries but they all return no results:</p>\n\n<pre><code>SELECT DISTINCT a.ID, d.name, d.term_id\nFROM cn_posts AS a\nLEFT JOIN cn_postmeta AS b ON a.ID = b.post_id\nLEFT JOIN cn_term_relationships AS c ON a.ID = c.object_id\nLEFT JOIN cn_terms AS d ON c.term_taxonomy_id = d.term_id\nWHERE a.post_status = 'publish'\nAND d.name LIKE '%Lighting%'\nAND d.term_id = '26'\n\nSELECT a.ID, d.name, d.term_id, a.post_status\nFROM cn_posts AS a\nJOIN cn_postmeta AS b ON a.ID = b.post_id\nJOIN cn_term_relationships AS c ON a.ID = c.object_id \nJOIN cn_terms AS d ON c.term_taxonomy_id = d.term_id\nWHERE a.post_status = 'publish'\nAND d.name LIKE '%Lighting%'\nAND d.term_id = '26'\nGROUP BY a.ID\n</code></pre>\n\n<p>These both return posts:</p>\n\n<pre><code>SELECT a.ID, d.name, d.term_id, a.post_status\nFROM cn_posts AS a\nJOIN cn_postmeta AS b ON a.ID = b.post_id\nJOIN cn_term_relationships AS c ON a.ID = c.object_id \nJOIN cn_terms AS d ON c.term_taxonomy_id = d.term_id\nWHERE a.post_status = 'publish'\nAND d.name LIKE '%Lighting%'\n\nSELECT a.ID, d.name, d.term_id, a.post_status\nFROM cn_posts AS a\nJOIN cn_postmeta AS b ON a.ID = b.post_id\nJOIN cn_term_relationships AS c ON a.ID = c.object_id \nJOIN cn_terms AS d ON c.term_taxonomy_id = d.term_id\nWHERE a.post_status = 'publish'\nAND d.term_id = '26'\n</code></pre>\n\n<p>But when you include both the name and term_id in the query it returns nothing?</p>\n\n<p>Thanks guys, sorry about the messy question.</p>\n\n<p>Dave</p>\n"},{"tags":["mysql","sql","query"],"answer_count":9,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":87,"score":-5,"question_id":12567253,"title":"basic mysql code not working","body":"<pre><code>CREATE TABLE users (\n    user_id PRIMARY KEY AUTO_INCREMENT(10000,1), \n    first_name varchar(20), \n    last_name varchar(20), \n    email_address varchar(50), \n    facebook_url varchar(50), \n    bio varchar(20)\n);\n</code></pre>\n\n<p>the error given is </p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax : check the manual that corresponds to you MySQL server for the right syntax to use <strong>'PRIMARY KEY AUTO_INCREMENT(10000,1), first_name varchar(20), last_name varchar(2'</strong> at line 1</p>\n</blockquote>\n"},{"tags":["android","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":12567489,"title":"Update SQLite error","body":"<p>To update a value in my SQLite database (android) I use following method. The table is calles objects, the field I want to update is showinfo1, of a specific item with a certain id and level.</p>\n\n<pre><code>public void insertString(int id, int level, String field, String value){\n\n        myDataBase.execSQL(\"UPDATE OBJECTS SET \" + field + \"=\" + value + \" WHERE _ID=\" + id + \" AND LEVEL =\" + level);\n\n    }\n</code></pre>\n\n<p>I have an error which I think is strange. It says there is 'nosuchcolumn' while there actually is one..:</p>\n\n<pre><code>android.database.sqlite.SQLiteException: no such column: true: UPDATE OBJECTS set showinfo1=true WHERE _ID=6 AND LEVEL =1\n</code></pre>\n\n<p>Any ideas how to solve this? Maybe my query is wrong?</p>\n"},{"tags":["php","mysql","query","aes"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":553,"score":0,"question_id":9721398,"title":"AES_ENCRYPT with MYSQL UPDATE","body":"<p>I am trying to do a basic mysql update but using AES_ENCRYPT - can anyone explain why i'm getting an error message? Below is the query :-</p>\n\n<pre><code>UPDATE MailList \nSET Email = AES_ENCRYPT( arandomemail@hotmail.com, 'jkfdsfsaKJjdsf' ) \nWHERE ID =  '138142'\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '@hotmail.co.uk,'jkaKJjkH87') WHERE MailListID = '138142'' at line 1 \n</code></pre>\n"},{"tags":["query","cakephp","search"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":12564288,"title":"CakePHP Search Bar","body":"<p>I have created a search bar for my application but its not working and giving error. here is the code</p>\n\n<p>Controller:</p>\n\n<pre><code>public function search()\n{\n    if (!empty($this-&gt;data)) {\n    $searchstr = $this-&gt;data['User']['search'];\n    $conditions = array(\n        'conditions' =&gt; array(\n            \"User.name LIKE\" =&gt; \"%$searchstr%\",\n            \"User.email LIKE\" =&gt; \"%$searchstr%\"\n\n                    )   \n                );\n\n    $this-&gt;set('searchresult', $this-&gt;User-&gt;findByname($searchstr, $conditions));\n    }\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>    &lt;?php echo $searchresult['User']['id']; ?&gt;\n    &lt;?php echo $this-&gt;html-&gt;link($searchresult['User']['name'],'/users/view/'.$searchresult['User']['id']);?&gt;\n    &lt;?php echo $searchresult['User']['email']; ?&gt;\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Database Error\n\nError: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'User.' in 'field list'\n\nSQL Query: SELECT DISTINCT `User`.`` FROM `fyp`.`users` AS `User` WHERE `User`.`name` IS NULL LIMIT 1\n\nNotice: If you want to customize this error message, create app\\View\\Errors\\pdo_error.ctp\n</code></pre>\n"},{"tags":["sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12564898,"title":"Converting string to date in SQLServer, Arithmetic Overflow","body":"<p>I want to convert a string \"<code>PERIOD</code>\" in this form <code>yyyymmdd</code> (eg: 20120701) into date in SQLServer.\nSo I used the convert function like this: </p>\n\n<pre><code>CONVERT(DATETIME,PERIOD,102);\n</code></pre>\n\n<p>and</p>\n\n<pre><code> CONVERT(DATETIME,PERIOD,120);\n</code></pre>\n\n<p>but I'm getting an    </p>\n\n<blockquote>\n  <p>SqlException: \"Arithmetic overflow error converting expression to\n  data type datetime.\"</p>\n  \n  <p>This is the whole query, is there any other mistake in this?</p>\n</blockquote>\n\n<pre><code>\"SELECT ACTUAL_N_WELLS, TARGET_N_WELLS, [YTD ACTUAL] AS YTD_ACTUAL, [YTD BUDGET] AS YTD_BUDGET FROM DASH_GL_DRILLING_PERF WHERE ASSET_NAME='Bu Hasa Asset' AND ( CONVERT(DATETIME,PERIOD,112) &gt; (SELECT DATEADD(MONTH,-3,MAX(CONVERT(DATETIME,PERIOD,112))) from DASH_GL_DRILLING_PERF))\");\n</code></pre>\n\n<p>What is the correct way to do this?</p>\n"},{"tags":["android","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12566207,"title":"How do I make a case insensitive query with ContentResolver in Android?","body":"<p>My goal is to get all rows from native db with a specific email address on Android Gingerbread and above.</p>\n\n<p>This query gets only the rows where the case also matches.</p>\n\n<pre><code>Cursor cursor = context.getContentResolver().query(ContactsContract.CommonDataKinds.Email.CONTENT_URI,\n            new String[] {Contacts._ID}, ContactsContract.CommonDataKinds.Email.ADDRESS + \"=?\",\n            new String[] {email}, null);\n</code></pre>\n\n<p>I've read about WHERE clauses to sql where one use lower('xx') but I can't figure out how to use it. Also I learned to you can make the column not care about case when creating the table, but that ship has sailed.</p>\n"},{"tags":["mysql","database","query","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12565780,"title":"merging of rows along with getting other data in same query","body":"<p>Ok, sorry if I was not clear earlier </p>\n\n<p>Following is one of the tables in my database</p>\n\n<pre><code>col1 col2  type  \n  1     2    3  \n  2     1    4  \n  1     3    0   \n  1     4    0\n</code></pre>\n\n<p>Now my joining itself I am trying to get resultant like </p>\n\n<pre><code>  1 - 2 - 3 \n  1 - 3 - 0 \n  1 - 4 - 0 \n</code></pre>\n\n<p>but not able to. </p>\n\n<p>If in table if any data happens to be like </p>\n\n<pre><code>Col1    Col2 \n 1   -  2  \n 2   -  1\n</code></pre>\n\n<p>Then result should contain only one row either 1-2 or 2-1 which will be decided on basis of type - whichever row has smaller type value.</p>\n\n<p>I have been trying with join since last two hours but not exactly able to do in just one single query. </p>\n\n<p>I can use inner query but, I want to explore or possible solution and then and then only at last resort will use inner query.</p>\n"},{"tags":["php","wordpress","query","search","custom-fields"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1090,"score":0,"question_id":7760533,"title":"Wordpress: Multiple Search Criteria on Custom Fields?","body":"<p>I'm just an basic Wordpress user. I need to make search box with <strong>multiple criteria</strong> inputs (multiple conditions) to search <strong>inside various Custom Fields</strong>.</p>\n\n<p>For example including following <strong>Custom Fields</strong>:</p>\n\n<p>Color: <strong><em>_</em>___<em></strong><br>\nSize: <strong></em>__<em>_</em>_</strong><br>\nPrice: <strong><em>_</em>__<em></strong><br>\nCondition: <strong></em>__<em>_</em></strong><br>\nDiscount %: <strong><em>_</em>__<em></strong><br>\nHit Count: <strong></em>__<em>_</em></strong><br></p>\n\n<p>User may input <strong>1 or more</strong> fileds.<br>\nResult should be filtered for multiple input also.<br>\nSo, how can i handle this multiple conditions in Query?</p>\n\n<p>It is <strong>ok for every single inputs</strong>.<br>\nBut, problem with more then 1.<br>\nI'm confusing how to write query <strong>for multiple criteria</strong> (in former way).<br></p>\n\n<p>A simple sample please.</p>\n"},{"tags":["c#","arrays","silverlight","query","automation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12521608,"title":"automation dynamic remote query in silverlight","body":"<p>I am having a bit of an issue in utilizing an automation remote query within silverlight and gathering the info into an array.  I can gather one item at a time, but cannot grab the whole array and use a 'foreach' statement to cycle through them.  If you can please take a glance at this code and tell me where my fault is or if this is possible, I would be very appreciative.  Thank you so much.</p>\n\n<pre><code>using (dynamic SWbemLocator = AutomationFactory.CreateObject(\"WbemScripting.SWbemLocator\"))\n{\n    SWbemLocator.Security_.ImpersonationLevel = 3;\n    SWbemLocator.Security_.AuthenticationLevel = 4;\n    dynamic IService = SWbemLocator.ConnectServer(\".\", @\"root\\cimv2\");\n    dynamic QueryResults = IService.ExecQuery(@\"SELECT Product, SerialNumber FROM Win32_BaseBoard\");\n    //dynamic QueryResult = QueryResults.ItemIndex(0);\n    foreach (Array QueryResult in QueryResults) //System.runtime.InteropServices.Automation.AutomationMetaObjectProvider\n    {\n        string moboname = QueryResult[\"Product\"];\n        string moboserial = QueryResult[\"SerialNumber\"];\n        MessageBox.Show(moboname + \"\\r\\n\" + moboserial);\n    }\n}\n</code></pre>\n"},{"tags":["mysql","query","utf-8","utf8-decode"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12533678,"title":"mysql_query on utf8_general_ci collation","body":"<p>I'm having some trouble with running a query on a database using utf8 encoding.\nEverything works fine until I try a string with special characters.\nI can't really make a lot of changes to the database since I'm adding some separate pages to an existing prestashop template.</p>\n\n<p>This is my code (sorry, but some of it is in Romanian)</p>\n\n<pre><code>$acces_server=mysql_connect($db_host, $db_user, $db_pass);\n    if(!$acces_server) die (\"Server-ul nu este disponibil momentan !\");\n    mysql_set_charset('utf8');\n     echo mysql_client_encoding();\n\n$acces_bd = mysql_select_db($db_name);\n    if (!$acces_bd) die (\"Ne pare rau, dar baza de date nu poate fi accesata momentan !\");\nmysql_query('SET NAMES utf8') or die(mysql_error());\nmysql_query('SET CHARACTER SET utf8') or die(mysql_error());\nmysql_query('SET COLLATION_CONNECTION=\"utf8_general_ci\" ') or die(mysql_error());\n</code></pre>\n\n<p>If I try to make a query  like this I get 0 rows: </p>\n\n<pre><code>$experienta= $_GET['name'];\n$rez=mysql_query(\"SELECT nume_cutie FROM rez_experiente WHERE nume = '\".$experienta.\"'\"); \n</code></pre>\n\n<p>I've used echo to display the query and then typed it in phpMyAdmin and it worked .\nAlso  the head section has this line : </p>\n\n<pre><code>&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n</code></pre>\n\n<p>I really don't know what else to do  , all the solutions I've found so far don't seem to work. I have even tried using mysqli instead and the result was the same.\nPlease help me , and thank you for your time.</p>\n\n<p>*Edit \nI tried using stmt->prepare with mysqli and that didn't work.\nI've also tried doing this : </p>\n\n<pre><code>$experienta2=str_replace(\"?\",\"%\",utf8_decode($experienta));\n        $rez=mysql_query(\"SELECT nume_cutie FROM rez_experiente WHERE nume LIKE '\".$experienta2.\"'\"); \n</code></pre>\n\n<p>Wich turns this : </p>\n\n<pre><code>SELECT nume_cutie FROM rez_experiente WHERE nume LIKE '5th Avenue Beauty Center  - Răsfăţ'\n</code></pre>\n\n<p>Into this: </p>\n\n<pre><code>SELECT nume_cutie FROM rez_experiente WHERE nume LIKE '5th Avenue Beauty Center - R%sf%%'\n</code></pre>\n\n<p>And again the query works in phpMyAdmin but mysql_query() returns nothing\nI switched to utf8_unicode_ci and nothing changed.</p>\n"},{"tags":["sql","sql-server","query","clear"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12559148,"title":"How to clear auto-incremented value that is assigned to a table variable in a stored procedure","body":"<p>I have a stored procedure with a table variable containing one of the attribute as a <code>Id int NOT NULL IDENTITY(1,1)</code>. In each execution, its value gets appended with the previous one.</p>\n\n<p>I want to clear the value of <code>Id</code> in each execution and in every execution it should <em>start with 1</em>.</p>\n\n<p>This is the code I have created</p>\n\n<pre><code>create procedure OnetPlus_processing \nas\nbegin\ndeclare @input_data table (\n  Id int NOT NULL IDENTITY(1,1),\n  jobid int,\n  title varchar(400),\n  jobtitle varchar(400),\n  titlerev varchar(400),\n  jobtitlerev varchar(400)\n)\n\ninsert into @input_data\nselect jobid ,title,jobtitle,titlerev,jobtitlerev\nfrom job.dbo\nleft outer join .....................\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":12560935,"title":"Multiple entries per day, converted to day to day and average of value per day","body":"<p>In SQL, 3 tables joined together, retreving 3 values: <code>value</code>, <code>time</code>, <code>value_name</code>. Value is the one I want averaged by day, <code>time</code> is in datetime format on about 10 mins - this one I want it to be converted in day to day, resulting in one row for every day - and my value_name witch cand be any selected value.</p>\n\n<p>Here is my syntax:</p>\n\n<pre><code>select time.entry_time, value_type.value_name, \n       avg(value.value) AVG_VALUE\nFROM Value\ninner join time on value.time_id = time.id\ninner join value_type on value.type_id = value_type.id\nWHERE value_type.value_name = 'CUSTOM'\nGROUP BY DATEPART(DAY, time.entry_time)\n</code></pre>\n\n<p>Here I get an error: </p>\n\n<blockquote>\n  <p>Column <code>time.entry_time</code> is invalid in the select list because it is not contained in either an aggregate function or the <code>GROUP BY</code> clause.</p>\n</blockquote>\n\n<p>Can you please help me with this syntax?</p>\n"},{"tags":["mysql","query","date","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12560152,"title":"MySQL query why does my INNER JOIN group date result","body":"<p>I have the following database tables and columns:</p>\n\n<pre><code>students\n+------------+-------------------+------------------+\n| student_id | student_firstname | student_lastname |\n+------------+-------------------+------------------+\n|         95 | John              | Doe              |\n+------------+-------------------+------------------+\n\nstudentcourseplan\n+--------+------------+\n| cpl_id | student_id |\n+--------+------------+\n|    209 |         95 |\n|    273 |         95 |\n+--------+------------+\n\nstudentdates\n+------------+-------------------+-----------------+\n| student_id | student_startdate | student_enddate |\n+------------+-------------------+-----------------+\n|         95 | 2012-07-02        | 2012-08-17      |\n|         95 | 2012-08-20        | 2012-11-16      |\n+------------+-------------------+-----------------+\n</code></pre>\n\n<p>If I run this query...</p>\n\n<pre><code>SELECT \n    scp.cpl_id,\n    s.student_id,\n    s.student_firstname,\n    s.student_lastname,\n    sd.student_startdate,\n    sd.student_enddate\nFROM\n    studentcourseplan scp\n        INNER JOIN\n    students s ON s.student_id = scp.student_id\n        INNER JOIN\n    studentdates sd ON sd.student_id = s.student_id\n</code></pre>\n\n<p>... I get the following output:</p>\n\n<pre><code>+--------+------------+-------------------+------------------+-------------------+-----------------+\n| cpl_id | student_id | student_firstname | student_lastname | student_startdate | student_enddate |\n+--------+------------+-------------------+------------------+-------------------+-----------------+\n| 209    |         95 | John              | Doe              | 2012-07-02        | 2012-08-17      |\n| 273    |         95 | John              | Doe              | 2012-07-02        | 2012-08-17      |\n+--------+------------+-------------------+------------------+-------------------+-----------------+\n</code></pre>\n\n<p>Notice the dates from result compared to the values in the table <code>studentdates</code>. They are wrong. I want something like the following output instead:</p>\n\n<pre><code>+--------+------------+-------------------+------------------+-------------------+-----------------+\n| cpl_id | student_id | student_firstname | student_lastname | student_startdate | student_enddate |\n+--------+------------+-------------------+------------------+-------------------+-----------------+\n| 209    |         95 | John              | Doe              | 2012-07-02        | 2012-08-17      |\n| 273    |         95 | John              | Doe              | 2012-08-20        | 2012-11-16      |\n+--------+------------+-------------------+------------------+-------------------+-----------------+\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12559419,"title":"How can I execute two stored procedure at a time in sql","body":"<p>I have two stored procedures <code>input_data</code> and <code>Processing_data</code>. The <code>input_data</code> sends data to the <code>Processing_data</code> and it will send back another id to the <code>input_data</code>. So I need to run both the stored procedure at a same time? How can I do this? Please help me. Thanks in advance.</p>\n"},{"tags":["php","ajax","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12556657,"title":"How do i create a directory for a product catalogue im making?","body":"<p>I am creating a product catalogue which will be browsed through database queries with the results displayed in a div, without page refresh-via ajax.</p>\n\n<p>Category examples would be:</p>\n\n<p>Home\nHealth\nEntertainment</p>\n\n<p>There are also subcategories for each category, i.e:</p>\n\n<p>HOME:\nGarden\nFurniture\nPlumbing\nEtc.</p>\n\n<p>I want to make a little directory thing that shows exactly where they are, something like:</p>\n\n<p>Home >>> Garden >>> Lawn care </p>\n\n<p>With each of those as a clickable link to take the person back to that specific query level.</p>\n\n<p>My code is 1 .php document, involving a query and code to output the query. If output is clicked on, it triggers an ajax script which points back to and reruns the same query/output, but with different results.</p>\n\n<p>This being said, i dont know how i would create a way to store and display the directory path. That i mentioned above.</p>\n\n<p>I was thinking of some way that takes the category that was clicked on and passes it through the url so that the php has the value when it reloads. And then i work that variable into a clickable directory link. But the problem is I'm not sure how to do that for multiple layers.</p>\n\n<p>i.e.\nIf someone just clicked on \"garden\" i could pass the garden variable through and use that in the nav, but then if someone clicked on \"lawn care\" i wouldnt be sure how to keep the \"garden\" variable because the variable i brought over via the url would now read \"lawn care.\"</p>\n\n<p>I feel like it has something to do with dynamically adding and storing the cumulative values in an array, but I'm really out of ideas...</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12558981,"title":"update sql query where select max","body":"<p>I want a query that updates the max number of the id... here is my code..</p>\n\n<pre><code>UPDATE `jobs` SET `sectors` = '12' WHERE `id` = (SELECT MAX(`id`) FROM `jobs`)\n</code></pre>\n\n<p>the error says : <code>#1093 - You can't specify target table 'wpjb_job' for update in FROM clause</code></p>\n\n<p>what can I do to make this happen?</p>\n"},{"tags":["php","mysql","query","syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":12550100,"title":"Trying to translate a MySQL query into a PHP query","body":"<p>I'm still kinda new to PHP and MySQL and I've tried so many times to do this and I just can't figure out how. </p>\n\n<p>I have a query that returns the results I want in PHPMyAdmin as a straight MySQL query but I'm trying to get this to generate on a webpage using a PHP <code>$query</code> and I just can't get the syntax right.</p>\n\n<p>this is the working MySQL query:</p>\n\n<pre><code>SELECT fk_toon_no, fk_actor_no, actor_no, actor FROM cartoon_characters, \ncharacters WHERE fk_toon_no=50 HAVING fk_actor_no=actor_no;\n</code></pre>\n\n<p>The kicker is that I also want to have a variable <code>$new_toon_id</code> as the <code>=</code> for the <code>WHERE</code> statement, so, something like: (but only displaying the row as I will eventually plug this into a table and know how to do that fine)</p>\n\n<pre><code>    WHERE fk_toon_no=$new_toon_id\n</code></pre>\n\n<p><code>fk_actor_no</code> is the foreign key of the <code>cartoon_characters</code> table to the primary key <code>actor_no</code> in the characters table.</p>\n\n<p>I'm trying to get it so that I can print out every character associated with a particular cartoon so it would look something like</p>\n\n<pre><code>    (toon id)      (character id #)     (character name)\n    ($fk_toon_no)  (actor_no)           (actor)   \n    3               5                    Eisenhower\n    3               9                    Nixon\n    3               12                   Uncle Sam\n</code></pre>\n\n<p>Any help would be greatly appreciated. I think I've included all the relevant information but if I forgot anything please ask. </p>\n\n<p>I'm in desperate need of help. Thanks!!</p>\n"},{"tags":["php","query","magento","join"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1195,"score":0,"question_id":6708808,"title":"Magento join tables","body":"<p>i need make a join costum tables in my query.\nI need to do a cycle of all products ordered by categories of \"entity_id\" and join this select if is valid</p>\n\n<pre><code>SELECT *,\n    pps_product_id, \n    MIN(pps_last_unit_price) AS pps_last_unit_price, \n    pps_quantity_product\n    FROM\n    \".Mage::getSingleton('core/resource')-&gt;getTableName('purchase_product_supplier').\"\n    WHERE\n    pps_last_unit_price &gt; '0'\n    AND pps_last_unit_price != '' AND pps_product_id = \".$data['entity_id'].\"\n    GROUP BY\n    pps_product_id\n</code></pre>\n\n<p>and join with <code>SELECT *, COUNT(entity_id) AS conta FROM \n    \".Mage::getSingleton('core/resource')-&gt;getTableName('catalog_category_entity_varchar').\" \n    WHERE attribute_id = 192 AND entity_id = \".$IDProduto.\" AND value != '' AND value != '0'</code>\nif is valid.\nAnybody can help me?\nThanks</p>\n"},{"tags":["c#","query","excel","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":92,"score":-1,"question_id":12550493,"title":"Error when Querying/Selecting excel column","body":"<p>I followed tutorial in here: <a href=\"http://codehill.com/2009/01/reading-excel-2003-and-2007-files-using-oledb/\" rel=\"nofollow\">http://codehill.com/2009/01/reading-excel-2003-and-2007-files-using-oledb/</a></p>\n\n<p>but i want only view some columns ,so i edit the query into</p>\n\n<pre><code>\"select F1,F3,F6 from [\" + worksheetName + \"$]\", con);\n</code></pre>\n\n<p>but i got this error on line</p>\n\n<pre><code>cmd.Fill(excelDataSet);\n\n\nSystem.Data.OleDb.OleDbException was unhandled\n  Message=No value given for one or more required parameters.\n  Source=Microsoft Access Database Engine\n  ErrorCode=-2147217904\n  StackTrace:\n       at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr)\n       at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object&amp; executeResult)\n       at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object&amp; executeResult)\n       at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)\n       at System.Data.OleDb.OleDbCommand.ExecuteReader(CommandBehavior behavior)\n       at System.Data.OleDb.OleDbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)\n       at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)\n       at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)\n       at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)\n       at ExcelReader.mainForm.GetWorksheet(String worksheetName) in D:\\PLN\\ExcelReader\\ExcelReader\\Main.cs:line 112\n       at ExcelReader.mainForm.sheetsToolStripComboBox_SelectedIndexChanged(Object sender, EventArgs e) in D:\\PLN\\ExcelReader\\ExcelReader\\Main.cs:line 125\n       at System.Windows.Forms.ComboBox.OnSelectedIndexChanged(EventArgs e)\n       at System.Windows.Forms.ComboBox.set_SelectedIndex(Int32 value)\n       at ExcelReader.mainForm.openToolStripButton_Click(Object sender, EventArgs e) in D:\\PLN\\ExcelReader\\ExcelReader\\Main.cs:line 51\n       at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)\n       at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)\n       at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ToolStrip.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)\n       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)\n       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)\n       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)\n       at ExcelReader.Program.Main() in D:\\PLN\\ExcelReader\\ExcelReader\\Program.cs:line 17\n       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n       at System.Threading.ThreadHelper.ThreadStart()\n  InnerException: \n</code></pre>\n\n<p>any idea?</p>\n"},{"tags":["wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12539952,"title":"Two loops, exclude post from first loop in second loop","body":"<p>I have a wordpress page which has two loops like so...</p>\n\n<pre><code>&lt;?php \nglobal $post;\n$args = array(\n    'showposts'        =&gt; 1,\n    'category_name'    =&gt; 'videos',\n    'meta_key'         =&gt; 'feature-image',\n);\n\n$myposts = get_posts($args);  \nforeach( $myposts as $post ) :  setup_postdata($post);\n$exclude_featured = $post-&gt;ID;\n?&gt;\n&lt;span class=\"featured\"&gt;\n&lt;?php the_title(); ?&gt;\n&lt;/span&gt;\n&lt;?php endforeach; ?&gt;\n\n&lt;?php while ( have_posts() ) : the_post(); ?&gt;\n&lt;?php the_title(); ?&gt;\n&lt;?php endwhile; ?&gt;\n</code></pre>\n\n<p>Now I need to use $exclude_featured in my second loop some how to exclude that post from that loop. I've tried a few implementations but none of them have worked. I have tried adding the following above the while statement for the second loop...</p>\n\n<pre><code>global $query_string;\nquery_posts( $query_string . '&amp;exclude='.$exclude_featured );\n</code></pre>\n\n<p>and this...</p>\n\n<pre><code>global $wp_query;\n$args = array_merge( $wp_query-&gt;query_vars, array( 'exclude' =&gt; $exclude_featured ) );\nquery_posts( $args );\n</code></pre>\n\n<p>.. and have had no luck. I've noticed that by using either of these two snippets they also render my pre_get_posts function which sets the number of posts to display useless.</p>\n\n<p>Any help would be appreciated</p>\n\n<p>EDIT:</p>\n\n<p>I've tried adding the following lines before the <code>while</code> statement on the second loop..</p>\n\n<pre><code>global $wp_query;\n$args = array_merge( $wp_query-&gt;query_vars, array( 'post__not_in' =&gt; $exclude_featured ) );\nquery_posts( $args );\n</code></pre>\n\n<p>However I still have not had any success, it brings up the following error:</p>\n\n<blockquote>\n  <p>Warning: array_map() [function.array-map]: Argument #2 should be an\n  array in\n  /home/myuser/public_html/mysitedirectory/wp-includes/query.php on line\n  2162</p>\n  \n  <p>Warning: implode() [function.implode]: Invalid arguments passed in\n  /home/myuser/public_html/mysitedirectory/wp-includes/query.php on line\n  2162</p>\n</blockquote>\n"},{"tags":["php","mysql","query","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12556961,"title":"How to do an update or delete query based on a condition?","body":"<p>So when users are online on my website, if they go inactive for more than 15 minutes I want to set their status to idle represented by a column in my \"online\" table within my database, if they go inactive for more than 30 minutes I want to completely delete the row rather than update a column.</p>\n\n<p>Is there a way to do this in one query? Thanks.</p>\n"},{"tags":["sql","sql-server-2005","query"],"answer_count":10,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":19579,"score":8,"question_id":591853,"title":"Search for a string in an all the tables, rows and columns of a DB","body":"<p>I am lost in a big database and I am not able to find where the data I get comes from. I was wondering if it is possible with SQL Server 2005 to search for a string in an all the tables, rows and columns of a DB?</p>\n\n<p>Does anybody has an idea if it is possible and how?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","query","date","range"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12549756,"title":"MySQL creating date ranges based on another column","body":"<p>I have a calendar table that looks like this:</p>\n\n<pre><code>    date   |  qty\n-------------------\n1998-11-18 |  2\n1998-11-19 |  0\n1998-11-20 |  0\n1998-11-21 |  0\n1998-11-22 |  3\n1998-11-23 |  0\n1998-11-24 |  0\n1998-11-25 |  3\n</code></pre>\n\n<p>I am trying to generate a report which would give the ranges of the entries with the <code>0</code> values for quantity (<code>qty</code>). I can't hard code the dates, they need to be determined by the value of the second column. From the above, the report should look like this:</p>\n\n<pre><code>1998-11-19 - 1998-11-21  \n1998-11-23 - 1998-11-24\n</code></pre>\n\n<p>All the <code>GROUP BY</code> and <code>UNION</code> queries give me the individual entries but I can't figure out how to create the date ranges.</p>\n"},{"tags":["php","mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12557018,"title":"MySQL explode array of values to use to ORDER the result by","body":"<p>I have to store a different number of values in a column called, date_of, for the date of an event. There can be multiple dates that it takes place, for instance Oct 1st, 2nd, and 6th. And I need to store that in that column as three different dates. Now I do this like this: </p>\n\n<pre><code>1350619200, 1350705600, 1350792000\n</code></pre>\n\n<p>So what I want to be able to do is order the mysql result by the date(s). The first date should be the one that it gets ordered by, however if there are multiple dates as shown above, if the date is pass then it should go to the second date, then third date etc. </p>\n\n<p>I'm not sure how to get started with this, my main priority is to just order the results by the first date in the array, the other part of my question isn't as important. </p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":12555439,"title":"How to make this specific MySQL query?","body":"<p>I have two tables, <code>users</code> and <code>messages</code>.</p>\n\n<p><code>users</code> has the fields <code>userId</code>(int) and <code>username</code>(string) and\n<code>messages</code> has the fields <code>userId</code>(int) and <code>message</code>.</p>\n\n<p>I have the username, and want to grab all messages related to that username's <code>userId</code>.</p>\n\n<p>Would the join function work in this case (and if so, how?), or would I have to make two separate queries?</p>\n"},{"tags":["javascript","jquery","html","query","hover"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12538729,"title":"Hovering on text to open image","body":"<p>I would like to open a image when I hover on a word \"PIC\" but I have on the same section 10 or more of this &amp; each of them must show the specific image of the element of the PIC.</p>\n\n<pre><code>&lt;h6 id=\"pic1\" class=\"pic\"&gt; PIC&lt;/h6&gt;\n&lt;div id=\"img_pic1\" class=\"imgpic\" style=\"display:none\"&gt;&lt;imgsrc=\"img/image1.jpg\"/&gt;&lt;/div&gt;\n\n&lt;h6 id=\"pic2\" class=\"pic\"&gt; PIC&lt;/h6&gt;\n&lt;div id=\"img_pic2\" class=\"imgpic\" style=\"display:none\"&gt;&lt;img src=\"img/image2.jpg\"/&gt;/div&gt;\n\n&lt;h6 id=\"pic3\" class=\"pic\"&gt; PIC&lt;/h6&gt;\n&lt;div id=\"img_pic3\" class=\"imgpic\" style=\"display:none\"&gt;&lt;img src=\"img/image3.jpg\"/&gt;/div&gt;\n</code></pre>\n\n<p>ect.....</p>\n\n<pre><code>&lt;script&gt;\n$('h6.pic').mouseenter(function(){\n$('div.img_pic').fadeIn();\n}).mouseleave(function(){\n$('div.img_pic').fadeOut();\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>Thhis work fine but it open all the images instead to open only the image of the PIC I hovered ?\nAny help will be appreciate. Thank you very much.</p>\n"},{"tags":["java","query","text"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12553271,"title":"Writing values of various data types onto a text file for querying","body":"<p>What would be an ideal constructs / design for a program intended for querying lines of strings from a text file as a database? My main problem here is how do I make an object holding values of different data types (UUID, string, string, double, double, int) be written as a single package onto a text file of which these data will also be queried. I'm thinking of an array-like container for these values so that when queried, the output would print out the data in that package. </p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":37,"score":-3,"question_id":12554738,"title":"Copy BLOB data MySQL PHP","body":"<p>I am currently making an PHP script which is posting auctions for my marketplace. I use Ajax to post the $_POST variables, including: title, description, price, tags and SupportedOSes. The image as a blob in an external table called 'temp_images'. </p>\n\n<p>The way I create the auction is by inserting a new auction into 'MarketDatas'. This is pretty straight forward for the most part. However; when I am trying to insert the BLOB it throws me an error:</p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax near\n  '?+Qi}'?m?Am............' at line 2</p>\n</blockquote>\n\n<p>The PHP script for creating auctions looks following: </p>\n\n<pre><code>/*\n    .... connect to database, etc!! I will spare you this and skip to the important part:\n*/\n\n// Get the posted variables\n$title = $_POST[\"title\"];\n$descr = $_POST[\"description\"];\n$price = $_POST[\"price\"];\n$tagsx = $_POST[\"tags\"];\n$supOS = $_POST[\"SupportedOS\"];\n\n// Get our session variables\n$Authenticated = ($_SESSION[\"LoggedIn\"] == \"1\" ? true : false);\n$User = $_SESSION[\"User\"];\n$Username = $_SESSION[\"username\"];\n\n// If we are authenticated, continue!\nif ($Authenticated) {\n    // Get our temporary image\n    $ImgResult = mysql_query(\"SELECT * FROM temp_images WHERE User='$Username'\");\n    if (mysql_num_rows($ImgResult) &lt; 1) { die(\"NoImage\"); }\n\n    // Get image blob\n    $image = mysql_result($ImgResult, 0, 'Image');\n\n    // Delete image\n    if (!mysql_query(\"DELETE FROM temp_images WHERE User='$Username'\")) { die(\"Error deleting temp image from DB\"); }\n\n    // Post auction on market\n    if (!mysql_query(\"INSERT INTO MarketDatas (Description, Price, Tags, Title, SupportedOS, image)\n    VALUES ('$descr', '$price', '$tagsx', '$title', '$supOS', '$image')\")) { echo \"Error posting auction [48]: syntax[\" . mysql_error() . \"]\"; }\n\n}\n</code></pre>\n\n<p>As you can see, I try to store the BLOB as an string value. But it throws me an error.</p>\n\n<p>How do I solve this?</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12539209,"title":"My SQL query to find the max <= date with a matching primary key","body":"<p>I have two tables that represent a historical data they both have a “src” column that represents the primary key in the primary table for that data.</p>\n\n<p>For example</p>\n\n<p>The primary tables would be</p>\n\n<pre><code>tbl_user        tbl_email\n________        _________\nuser_pk         email_pk\nusername        email\nemail_pk        tstamp\ntstamp\n</code></pre>\n\n<p>The history tables basically match the original with a \"src\" column indicating the source primary key record from the primary table.</p>\n\n<pre><code>tbl_user_hist                 tbl_email_hist\n______________                ______________\nuser_pk                       email_pk\nsrc_user_pk                   src_email_pk\nusername                      email\nemail_pk                      tstamp\ntstamp                      \n</code></pre>\n\n<p>so if you had an email record of primary key 1 and you changed the email from bob@gmail.com to bob@hotmail.com and then again to bob@yahoo.com</p>\n\n<p>your tbl_email_hist would look like this</p>\n\n<pre><code>email_pk     src_email_pk     email                tstamp\n1                   1         bob@gmail.com        2012-01-01 04:06:28\n2                   1         bob@hotmail.com      2012-03-01 04:06:28\n3                   1         bob@yahoo.com        2012-07-01 04:06:28\n</code></pre>\n\n<p>And lets say that bobs original user name was  rsmith and then it was changed to bsmith and then back to rsmith2. But these user name changes do NOT NECESSARILY coincide with the timestamps of the email changes. </p>\n\n<p>SO similarly the user history table would look like </p>\n\n<pre><code>tbl_user_hist\nUser_pk     src_user_pk     username    email_pk      tstamp\n1           1               rsmith      1             2012-01-01 04:08:28\n2           1               bsmith      1             2012-02-01 04:01:28\n3           1               rsmith2     1             2012-05-01 04:05:28\n</code></pre>\n\n<p>SO what I WANT is to create a query that  will be able to find the correct email history record based on time stamp and the related email_pk record…meaning what was the value of that field at the time the user record was changed.\nSo in some way I need to find the record in the email hist table where the src_email_pk matches the email_pk in the user hist table but the tstamp for that email history record is the highest date while still &lt;= the timestamp in the user table. </p>\n\n<p>In the end my Data would look like this</p>\n\n<pre><code>Username     email              username_timestamp\nRsmith       bob@gmail.com      2012-01-01 04:08:28\nBsmith       bob@hotmail.com    2012-02-01 04:01:28\nRsmith2      bob@hotmail.com    2012-05-01 04:05:28\n</code></pre>\n\n<p>In other words reflecting the value of the email column at the time the username record was modified/created.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","view"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12553711,"title":"How to create a \"materialized something\" that accesses different tables, depending on a specific setting","body":"<p>I want a program to access a table/view/stored procedure, etc. (<strong>something materialized, let's call it X</strong>)  that abstracts the real location of the data contained in three basic tables (the tables have the same definition in all locations).</p>\n\n<p>I would want <strong>X</strong> to fetch the server name, catalog name and table name from somewhere (a table, probably) and access the specific three basic tables. The caller of <strong>X</strong> would not know which specific tables were being called.</p>\n\n<p>How can I do this in SQL Server (2008)?</p>\n"},{"tags":["database","query","joomla2.5"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12438362,"title":"Database query to get decimal value in Joomla 2.5","body":"<p>I'm trying to make a query to a database in Joomla 2.5. I have a db named 'example', and I'm trying to get certain value named 'value' (very original) for a user whose id is 949:</p>\n\n<pre><code>$db =&amp; JFactory::getDBO();\n$query = $db-&gt;getQuery(true);\n$user = 949;\n$db-&gt;setQuery( 'SELECT value FROM example WHERE user_id = ' . $user ); \n$result = $db-&gt;loadObjectList();\necho $result;\n</code></pre>\n\n<p>However, I'm just getting 'Array' as result (the expected value is a decimal, e.g. 4.5).</p>\n\n<p>Could someone please tell me what am I doing wrong?</p>\n"},{"tags":["sql","database","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12472571,"title":"Alter table then update","body":"<p>How can I achieve this in transact sql.</p>\n\n<p>I want to add new column to existing table and then update it with some values. Is it possible to do it in one sql script or I should use separate scripts?</p>\n\n<p>Here is a samples code</p>\n\n<pre><code> ALTER TABLE my_table ADD my_new_column bit NULL;\n\n UPDATE my_table SET my_new_column = 0;\n</code></pre>\n\n<p>I know that I am doing writing while the column still doesn't exist so thats why these two lines are not working. But how to acheve this in one script, i.e use some delay or how to be sure the column is created and then write data to it?</p>\n\n<p>I used IF EXISTS with select from the table but it doesn't work.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","database","query","random"],"answer_count":8,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":9786,"score":13,"question_id":580639,"title":"How to randomly select rows in SQL?","body":"<p>In my db, I have a table \"customerNames\" which has two columns \"Id\" and \"Name\" and approx. 1,000 results. I am creating a functionality where I have to pick up the 5 customers randomly every time. Can anyone tell me how to create a query which will get random 5 rows (Id, and Name) every time  when query is executed.</p>\n\n<p><strong>edited</strong></p>\n\n<p>I am using MSSQL Server 2005. </p>\n"},{"tags":["sql","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":12550500,"title":"Query for most frequent value or neither","body":"<p>I need to show the most frequent value between two groups on a selection, and it has to go along a message, so bear with me. I'm using Oracle XE and this is what I've got so far:</p>\n\n<pre><code>SELECT (\n    CASE type\n        WHEN 0 THEN 'heroes'\n        WHEN 1 THEN 'villains'\n        ELSE 'neither'\n    END\n) AS MostFrequent\nFROM (\n    SELECT type\n    FROM mutants\n    GROUP BY type\n    ORDER BY count(*) DESC\n) WHERE rownum &lt;= 1\n</code></pre>\n\n<p>So far if there are more Mutants with type 0 than type 1 it shows Heroes and then when there are more of type 1 than type 0, it shows villains, but when they're tied, it shows no data, and that doesn't work for me :( I need it to say 'neither', so any help will be widely appreciated.</p>\n"},{"tags":["database","query","algebraic-data-types"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12547599,"title":"How to find the minimum using algebraic query language","body":"<p>I need to find the cheapest Honda Civic sold in this table</p>\n\n<pre><code>Sell(DName, Make, ModelNum, Price)\n</code></pre>\n\n<p>There are other tables, but I am assuming that no other manufacturers have named their make Civic.</p>\n\n<p>So I'm looking to find the lowest price that is of Make Civic. But how exactly do I find the lowest price? I would know if there was a set price (<code>SELECT the make WHEN price &lt; \"x amount\"</code>), but how about to I go do find the lowest price in the table.</p>\n"},{"tags":["sql","query","parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12550640,"title":"Parse error: syntax error, unexpected 'from' (T_STRING), expecting ']'","body":"<p>I am making a simple newsfeed like on facebook, and I have this error:</p>\n\n<blockquote>\n  <p>Parse error: syntax error, unexpected 'from' (T_STRING), expecting ']' in C:\\wamp\\www\\facebook\\newfeed.php on line 8 </p>\n</blockquote>\n\n<p>I don't know what's wrong, my query works when I tested it in WAMP. I need help. </p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;?php\nrequire(\"opendb.php\");\n\n$userid = (int) $_SESSION[`fb128_userid];\n$query = mysql_query (\" SELECT * FROM posts WHERE userid= ANY (\nSELECT `from` as id FROM friends WHERE `to`= $userid and status='Confirmed' UNION \nSELECT `to` as id FROM friends WHERE `from`= $userid and status='Confirmed') \nORDER BY date_created DESC LIMIT 1,10\" );\n\nrequire(\"closedb.php\");\n$promt = \"\";\nwhile(list($id,$userid,$from,$content,$date_created) = mysql_fetch_array($query)){  \n        $promt .=\"&lt;hr&gt;\";\n        $promt .='&lt;p&gt;'.substr($content,0,150).\"...&lt;a href='post.php'&gt;see more&lt;/a&gt;&lt;/p&gt;\";\n        $promt .=\"&lt;a href='like.php'&gt;    like&lt;/a&gt; |  \";\n        $promt .=\"&lt;a href='comment.php?id=$id'&gt;Comment |&lt;/a&gt;\";\n        $promt .= \"&lt;p class='post-info'&gt; | Date Created: $date_created &lt;/p&gt; \";\n        $promt .=\"&lt;hr&gt;\";\n    }\n    ?&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;&lt;b&gt;NewsFeed&lt;/b&gt; &lt;hr&gt;&lt;/p&gt;\n&lt;?php echo $promt; ?&gt;\n&lt;hr&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["wordpress","query","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12542039,"title":"WordPress Limit Search to Custom Post Type","body":"<p><strong>I'm trying to limit my WordPress search to a single, custom post type.</strong></p>\n\n<p>It seems I can change most parameters of the search query, except the post type variable.</p>\n\n<pre><code>$query_args = explode(\"&amp;\", $query_string);\n$search_query = array();\n\nforeach($query_args as $key =&gt; $string) {\n    $query_split = explode(\"=\", $string);\n    $search_query[$query_split[0]] = urldecode($query_split[1]);\n}\n\n$search_query['post_type'] = 'thread';\n\n$search = new WP_Query($search_query);\n</code></pre>\n\n<p>This query will still return all post types. But if I set a different parameter, like 'posts_per_page', it works fine.</p>\n\n<p>What's going on? How can I limit my search query to a custom post type?</p>\n\n<p>Thanks for your help!</p>\n\n<p><strong>EDIT: btw, I'm using WP 3.4.2</strong></p>\n"},{"tags":["php","mysql","query","limit","greatest-n-per-group"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12546282,"title":"Mysql select 5 rows of every item (using IN operator)","body":"<p>I have been trying to figure this out for hours and seems that I'm stuck.</p>\n\n<p>When I want to do in the query below is that I am passing some location IDs to <code>IN</code> operator and I don't want MySQL to return ALL the results (table is too large) but only 5 items of every location ID (if items exist).</p>\n\n<p>I have temporarily put a <code>LIMIT 100</code> until I get it done with your help.</p>\n\n<p>Here's the query:</p>\n\n<pre><code>$sql = \"SELECT SQL_CACHE deals.deal_ID, deals.slug, deals.url, deals.previous_price, deals.title, deals.image, deals.price, deals.end, deals.purchases, deals.date_added,\n        deals_locations.location_ID, deals.hits\n        FROM deals\n        INNER JOIN deals_locations\n        WHERE deals.status = 'active'\n        AND deals_locations.deal_ID = deals.deal_ID\n        AND deals_locations.location_ID IN (\".implode(', ', $location_IDs).\")\n        GROUP BY deals.deal_ID\n        LIMIT 100;\";\n</code></pre>\n\n<p>Thank you very much for your time.</p>\n\n<p><strong>EDIT:</strong> Now my query output looks like this:</p>\n\n<pre><code>SELECT SQL_CACHE deals.deal_ID, deals.slug, deals.url, deals.previous_price, deals.title, deals.image, deals.price, deals.end, deals.purchases, deals.date_added,\ndeals_locations.location_ID, deals.hits\nFROM deals\nINNER JOIN deals_locations\nWHERE deals.status = 'active'\nAND (\nSELECT COUNT(*) FROM deals\nWHERE deals.deal_ID = deals_locations.deal_ID\n) &lt;= 5\nAND deals_locations.deal_ID = deals.deal_ID\nAND deals_locations.location_ID IN (1, 2, 3, 5, 7, 12, 13, 26, 27, 28, 29, 30, 31, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 46, 49, 52, 53, 54, 55, 56, 60, 62, 64, 65, 66, 67, 68, 69, 70, 72, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 97, 107, 10, 21, 32, 33, 37, 51, 4, 6, 8, 9, 11, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 45, 47, 48, 50, 57, 58, 59, 61, 63, 71, 73, 84, 85, 86, 87, 88, 91, 92, 93, 94, 95, 96, 98, 99, 100, 101, 102, 103, 104, 105, 106, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160)\nGROUP BY deals.deal_ID;\n</code></pre>\n\n<p>But still shows more than 5 records for the same location.</p>\n\n<p><strong>EDIT 2:</strong> I have tried the <code>UNION ALL</code> approach and seems to be working. Now I get a total result of 30 rows but I am concerned about the size of the query.</p>\n\n<p>Here's what my query looks like now: <a href=\"http://pastebin.com/r6vyG594\" rel=\"nofollow\">http://pastebin.com/r6vyG594</a></p>\n\n<p>The <code>explain</code> is huge so I can't post it online. What should I do to make the query efficient and smaller in size?</p>\n\n<p>It takes about 0.2158 sec to execute.</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12546518,"title":"getting id of last query when multiple queries are made","body":"<p>In php have a form with a textarea and a file upload. In mysql I have table 1 with rows for each uploaded file having data like name, size, etc... and I have table 2 with the data entered in the textarea and a column with the id of the file uploaded.</p>\n\n<p>I'm using <code>mysql_insert_id</code> to get the id of the last inserted row in table 1 (the id of file uploaded). Then I insert that id in table 2. </p>\n\n<p>Assuming that multiple uploads are made at the same by different users will <code>mysql_insert_id</code> return the proper id each time? What happens if 2 users upload at the exact time.. Or there is a timeout.. I guess I'm asking if there's a better way to insert a newly created id to 2 tables at the same time?</p>\n"},{"tags":["php","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12546267,"title":"Mysql safely using reserved word in query","body":"<p>I need to return a multidimensional array from a query with the id keys named <code>key</code>. (needed for <em>object keys</em> in amazon s3 API)</p>\n\n<p>example:</p>\n\n<pre><code>Array ( [0] =&gt; Array ( [key] =&gt; 8 ) [1] =&gt; Array ( [key] =&gt; 7 ) [2] =&gt; Array ( [key] =&gt; 6 ) )\n</code></pre>\n\n<p>The problem: <code>key</code> is a reserved name in MYSQL. I <strong>have</strong> to use the name key.</p>\n\n<p>The following query gives an error</p>\n\n<pre><code>SELECT `file_name` AS key FROM (`uploads`)\n</code></pre>\n\n<p>but adding backticks around <code>key</code> doesn't give errors</p>\n\n<pre><code>SELECT `file_name` AS `key` FROM (`uploads`)\n</code></pre>\n\n<p>Is it safe to continue like this or is there a better way? I was thinking to rename the id key in the array in php but doing it in the query seems faster </p>\n"},{"tags":["database","query","elasticsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12538920,"title":"How can I do a prefix search in ElasticSearch in addition to a generic query string?","body":"<p>I have a very basic index of \"users\" with a single type \"user\" that has several fields to it. I don't have anything defined on the index besides that.</p>\n\n<p>What I need to do is provide autocomplete results that prioritize prefix matches (for usernames) but also contain other matches from the users bio and website and substring matches of other fields.</p>\n\n<p>How does one accomplish this with the query DSL?</p>\n"},{"tags":["php","query","href"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":11677492,"title":"PHP passing variable through href","body":"<p>I'm having a little problem with passing a parameter for a query to another page.</p>\n\n<p>I want to make the name of the restaurant a link that would pass the name of the product to process a query on the next page. </p>\n\n<pre><code>echo \"&lt;p class='p2'&gt;&lt;a class='link' href='restaurant.php?name=\". $row['name'] .\"'&gt;&lt;strong&gt;\". $row['name'] .\"&lt;/strong&gt;&lt;/a&gt;\n</code></pre>\n\n<p>on the restaurant page</p>\n\n<pre><code>&lt;?php\nrequire (\"db.php\");\n$name = $_GET['name'];\n\n$query = \"SELECT * FROM restaurant WHERE name =\\\"$name\\\"\";\n$result = mysql_query($query);\n$row = mysql_fetch_array($result);   \n?&gt;\n</code></pre>\n\n<p>but nothing is displayed. </p>\n\n<p>Any idea what I'm doing wrong?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","placeholder"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12537629,"title":"How to pass a column name value as SQL argument using placeholders","body":"<p>How to pass a column name value as a SQL argument using parameter placeholders ?</p>\n\n<p>The goal is having this working:</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE @0 LIKE @1\";\nvar sqlData = db.Query(sql,choice,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p><code>choice</code> is a variable that will store the <code>column name</code></p>\n\n<p><code>@0</code> is a <code>column name</code> (and I don't succeed to pass it as an argument)</p>\n\n<p><code>@1</code> is a <code>search string</code> (and I have no problem with it)</p>\n\n<p>Have read and tried a lot of things:</p>\n\n<p>Below one doesn't throw any error but doesn't bring any data</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE @0 LIKE @1\";\nvar sqlData = db.Query(sql,choice,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one throws <code>Column name not valid = '@0'</code></p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE [@0] LIKE @1\"\nvar sqlData = db.Query(sql,choice,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one throws <code>Column name not valid = 'choice'</code></p>\n\n<pre><code>var sql \"SELECT * FROM Condos WHERE choice LIKE @0\");\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one throws <code>Must declare scalar variable \"@choice\"</code></p>\n\n<pre><code>var sql \"SELECT * FROM Condos WHERE @choice LIKE @0\");\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one doesn't throw any error but doesn't bring any data</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE '@choice' LIKE @0\";\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one doesn't throw any error but doesn't bring any data</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE '@choice' LIKE @0\";\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one doesn't throw any error but doesn't bring any data</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE '\"+choice+\"' LIKE @0\";\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one: BIG CRASH</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE '\"+@choice+\"' LIKE @0\";\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one throws <code>Column name not valid = 'NameShort'</code></p>\n\n<p><strong>This is precisely the correct column name</strong></p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE ['\"+choice+\"'] LIKE @0\";\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p>Below one: BIG CRASH</p>\n\n<pre><code>var sql = \"SELECT * FROM Condos WHERE ['\"+@choice+\"'] LIKE @0\";\nvar sqlData = db.Query(sql,\"%\"+searchString+\"%\");\n</code></pre>\n\n<p><strong>HELP !!!!!!!!!!!!!!</strong></p>\n"},{"tags":["mysql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12544406,"title":"if(isset($_GET[\"id\"])){ need revealed gaps","body":"<p>actually I'm new learner php Development ..\ntoday I've written a script that is allow to explorer items by ID .. \nbut I need to Strengthen protection my Code .. </p>\n\n<p>So .. please Help me to Revealed gaps  </p>\n\n<pre><code>    &lt;?php \ninclude \"config.php\";\n\nif(isset($_GET[\"id\"])){\n$gid = mysql_real_escape_string($_GET[\"id\"]);\n\n$result = mysql_query(\"SELECT * FROM software WHERE id = $gid \");\n\nwhile ($row = mysql_fetch_array($result)) {\n$name = $row{'name'};\necho \"&lt;title&gt;\".$name.\"&lt;/title&gt;\";\necho $row{'name'}; \necho \"&lt;br /&gt;\"; \n?&gt;\n&lt;a href=\"&lt;?php echo $row{'url_1'}; ?&gt;\"&gt;download&lt;/a&gt;\n&lt;?php \n}}\n?&gt;\n</code></pre>\n"},{"tags":["php","mysql","query","file-upload","insert"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":4,"view_count":104,"score":-4,"question_id":12535424,"title":"MySql insert into query not working in PHP page","body":"<p>Hi i am new to PHP and MySql and I'm facing one problem: </p>\n\n<p>I am having a page that allows users to upload an image and some details like their name and their email address to my database but <strong>the code that i have used is not working</strong>. </p>\n\n<p>In fact, <strong>it is not adding data to my database but the image is being uploaded</strong>. </p>\n\n<p>I also want to ask that <strong>is there any way to make all the form fields compulsory for users to fill in the form</strong>. </p>\n\n<p>The html form is as below:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"content\"&gt;&lt;br&gt;&lt;div align=\"center\"&gt;\n            &lt;form enctype=\"multipart/form-data\" action=\"upload1.php\" method=\"POST\"&gt; \n                Your Full Name: &lt;input type=\"text\" name=\"name\" maxlength=\"40\"&gt;&lt;br&gt; \n                Your Image Please: &lt;input type=\"file\" name=\"photo\"&gt;&lt;br&gt;\n                &lt;input type=\"submit\" value=\"Upload!\"&gt; \n            &lt;/form&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And this is the code of <code>upload1.php</code>:</p>\n\n<pre><code>&lt;?php \n\n    // random 4 digit  to add to our file name \n\n    // some people use date and time in stead of random digit \n\n    $random_digit=rand(00000000000000,99999999999999);\n\n    //combine random digit to you file name to create new file name\n\n    //use dot (.) to combile these two variables\n\n    $new_file_name=$random_digit.$file_name;\n\n    //This is the directory where images will be saved \n    $target = \"g/\".$new_file_name; \n    $target = $target . basename( $_FILES['photo']['name']); \n\n    //This is our size condition \n    if ($photo_size &gt; 350000) \n    { \n        echo \"Your file is too large.&lt;br&gt;\"; \n        $ok=0; \n    } \n\n    if (!($uploaded_type==\"image/gif\")) {\n        $ok=0;\n    } \n    if (!($uploaded_type==\"image/jpg\")) {\n        $ok=0;\n    } \n    if (!($uploaded_type==\"image/png\")) {\n        $ok=0;\n    } \n    if (!($uploaded_type==\"image/bmp\")) {\n        $ok=0;\n    } \n    if (!($uploaded_type==\"image/jpeg\")) {\n        $ok=0;\n    } \n\n    if ($ok=0) \n    { \n        Echo \"Sorry your file was not uploaded\"; \n    } \n\n    else \n    { \n\n        //This gets all the other information from the form \n        $name=$_POST['name'];\n        $email=$_POST['email'];\n        $pic=($_FILES['photo']['name']); \n        $banner=\"/$target\";\n        $url=\"xxxxxxxxxx\";\n        $clicks='0';\n\n        // Connects to your Database \n        mysql_connect(\"xxxxxxxxxxx\", \"xxxxxxxxxxx\", \"xxxxxxxxx\") or die(mysql_error()) ; \n        mysql_select_db(\"xxxxxxx\") or die(mysql_error()) ;\n\n\n        //Writes the information to the database \n        mysql_query(\"INSERT INTO girls (name, banner, clicks, url, email) VALUES ('{$name}','{$banner}','{$clicks}','{$url}','{$email}') \"); \n\n\n        //Writes the photo to the server \n        if(move_uploaded_file($_FILES['photo']['tmp_name'], $target)) \n        { \n\n            //Tells you if its all ok \n            echo \" The file has been uploaded and renamed to '$target' your information has also been added to the database.&lt;br&gt;To view your image online visit www.facesnap.tk/$target \";\n        } \n        else { \n\n            //Gives and error if its not \n            echo \"Sorry, there was a problem in your upload. Be sure that you follow instructions.\"; \n        } \n    }\n?&gt; \n</code></pre>\n"},{"tags":["php","database","query","phpmyadmin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":147,"score":-1,"question_id":12543312,"title":"Parse error: syntax error, unexpected T_PAAMAYIM_NEKUDOTAYIM","body":"<p>I am using objects in php. I have an object to connect to database server $con object and $opt (operation) object to send query to database server, till now there is no problem, the problem is that I defined the $con object as static and I defined it in $opt object as it shows in below code</p>\n\n<pre><code>  class operations{\n\n   public static $con = null;\n   public function __construct($tableName = null){\n\n     // Creating  an object of connection \n     self::$con = new config();\n     self::$con = self::$con-&gt;getConnection();\n   }\n\n  } \n</code></pre>\n\n<p>So when I want to call the $con object there is no problem</p>\n\n<pre><code>mysql_query($query,$opt::$con) or die (mysql_error());  \n</code></pre>\n\n<p>but on server it appears with this error </p>\n\n<pre><code>Parse error: syntax error, unexpected T_PAAMAYIM_NEKUDOTAYIM\n</code></pre>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":12269394,"title":"I am having trouble writing my SQL query","body":"<p>I have an sql query like this...</p>\n\n<pre><code>SELECT c.clientid, c.clientname, c.billingdate, \n       (SELECT ifnull(sum(total), 0) \n          FROM invoice i\n         WHERE i.client = c.clientid AND i.isdeleted = 0) -\n       (SELECT ifnull(sum(p.amount), 0) \n          FROM payment p\n         INNER JOIN invoice i ON p.invoice = i.invoiceid\n         WHERE i.client = c.clientid and i.isdeleted = 0) as balance, \n        CASE c.isactive+0 WHEN '1' THEN 'Stop'\n                                   ELSE 'Start' END as Active\nFROM client c\nORDER BY clientname\n</code></pre>\n\n<p>This works fine with no errors, but notice this part....</p>\n\n<pre><code>(SELECT ifnull(sum(total), 0) \n          FROM invoice i\n         WHERE i.client = c.clientid AND i.isdeleted = 0) -(SELECT ifnull(sum(p.amount), 0) \n   FROM payment p\n  INNER JOIN invoice i ON p.invoice = i.invoiceid\n  WHERE i.client = c.clientid AND i.isdeleted = 0) as balance\n</code></pre>\n\n<p>I wrote a PHP script...</p>\n\n<pre><code>if($remaining &lt; 0){\n    $remaining = $row['total'];\n}else{\n    $remaining = $remaining + $row['total'];\n}\n</code></pre>\n\n<p>What I am trying to do is incorporate what I wrote in my PHP to my SQL query, but I have never wrote an SQL query with if statements before (if they are allowed). How would incorporate my PHP script to my SQL query? Any suggestions?</p>\n"},{"tags":["asp.net-mvc","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12541449,"title":"give type to anonymous type in linq query","body":"<p>What I'm trying to do is to get particular values from my DB and parse that into view to display it in the table.\nI had same problem as in <a href=\"http://stackoverflow.com/questions/6521775/the-model-item-passed-into-the-dictionary-is-of-type-models-app-but-what\">The model item passed into the dictionary is of type .... {Models.App} but what I passed is {Models.App, System.Double}</a> and tried to solve my problem in the similar way. So basically I created a class in the model that has:</p>\n\n<pre><code> public Vehicle manur_name {get; set;}\n public Vehicle manur_date { get; set; }\n public Vehicle daily_hire_rate { get; set; }\n</code></pre>\n\n<p>but then when I use it in my controller in the linq query it gives me and error.</p>\n\n<pre><code> var s = from veh in db.Vehicles\n join c in db.VehicleCategories on veh.vehicle_category_code equals  c.\n join m in db.Models on veh.model_code equals m.model_code\n join man in db.Manufacturers on veh.manufacturer_code equals man.manufacturer_code\n where c.vehicle_category_description == cat &amp;&amp; m.body_style == b                         \n            select new CarClass {\n                          manur_name = man.manufacturer_name, \n                          manur_date = m.model_code, \n                          daily_hire_rate = veh.daily_hire_rate};\n</code></pre>\n\n<p>It gives me the error:</p>\n\n<blockquote>\n  <p>error:Cannot implicitly convert type 'decimal' to\n  'carRentalMVC.Models.Vehicle'  Cannot implicitly convert type 'string'\n  to 'carRentalMVC.Models.Vehicle'   Cannot implicitly convert type\n  'string' to 'carRentalMVC.Models.Vehicle'</p>\n</blockquote>\n\n<p>Here is what I have in controller after fixing the problem:</p>\n\n<pre><code>        CarRentalDatabaseDataContext db = new CarRentalDatabaseDataContext();\n    public ActionResult Index(String cat, String b, String sort)\n    {\n        String day_hire = \"Daily hire rate\";\n        String man_date = \"Manufacturing date\";\n        string man_n = \"Manufacturer's name\";\n\n        var s = db.Vehicles.Where(c =&gt; c.Model.body_style == b)\n             .Select(u =&gt; new CarClassViewModel { \n                 manur_name = u.Manufacturer.manufacturer_name, \n                 model_code = u.model_code,\n                 daily_hire_rate = u.daily_hire_rate,\n                 manur_date = u.manufacturing_date\n             })\n             .Distinct(); //I don't need repeating data\n\n        //this is for sorting them, but I haven't implemented this in the view yet. \n        if (sort == man_n){s = s.OrderBy(c=&gt;c.manur_name);}\n        else if (sort == man_date){s = s.OrderBy(c =&gt;c.manur_date);}\n        else if (sort == day_hire){s = s.OrderBy(c =&gt; c.daily_hire_rate);}\n        else{s = s.OrderBy(c =&gt; c.daily_hire_rate);}\n\n        var v = s.Select(u =&gt; new CarClassViewModel\n        {\n            manur_name = u.manur_date,\n            model_code = u.model_code,\n            daily_hire_rate = u.daily_hire_rate,\n        }); //this is for returning values I need\n\n        return View(v); //I've tried View(v.ToList()) as well\n    }\n</code></pre>\n\n<p>Now this returns empty rows in my table. Does it matter that I'm not parsing in data for the method?</p>\n"},{"tags":["mysql","database","query","stored-procedures","pdo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12542878,"title":"Mysql Syntax Error when running as prepared statment","body":"<p>I've this stored procedure in which I am using a prepared statment to perform two queries.Here's the procedure.</p>\n\n<pre><code>SET @uid    = puserid;\nSET @rangee = plimit * 50;\nSET @post = 'post';\n\nPREPARE STMT FROM \n'\nSELECT  notifications.postid,victims.victimid,friends.friendsname,notificationrecievers.status \n\nFROM friends,victims,notifications,notificationrecievers\n\nWHERE victims.postid=notifications.postid \n\nAND notificationrecievers.notificationid=notifications.notid\n\nAND notificationrecievers.recieverid=?\n\nAND notifications.type=? \n\nAND friends.friendsid=victims.victimid\n\nAND notificationrecievers.notificationid &lt;=\n(\n   SELECT MAX(notid) FROM\n   (\n      SELECT n.notid FROM user u,notifications n,notificationrecievers nr WHERE\n      nr.recieverid=? AND u.userid=n.senderid AND nr.notificationid=n.notid ORDER BY n.notid DESC\n      LIMIT 50 OFFSET ?\n   )a\n)\nAND notificationrecievers.notificationid &gt;=\n(\n   SELECT MIN(notid) FROM\n   (\n      SELECT n.notid FROM user u,notifications n,notificationrecievers nr WHERE\n      nr.recieverid=? AND u.userid=n.senderid AND nr.notificationid=n.notid ORDER BY n.notid DESC\n      LIMIT 50 OFFSET ?\n   )b\n)\nORDER BY notifications.postid DESC;\n\nUPDATE notificationrecievers \n\nSET notificationrecievers.status=1 \n\nWHERE notificationrecievers.status=0\nAND   notificationrecievers.recieverid=? \n\nAND\n\nnotificationrecievers.notificationid &lt;=\n(\n     SELECT MAX(notid) FROM\n     (\n      SELECT n.notid FROM user u,notifications n,notificationrecievers nr WHERE\n      nr.recieverid=? AND u.userid=n.senderid AND nr.notificationid=n.notid ORDER BY n.notid DESC\n      LIMIT 50 OFFSET ?\n     )e\n)   \n\nAND\n\nnotificationrecievers.notificationid &gt;=\n(\n     SELECT min(notid) FROM\n     (\n      SELECT n.notid FROM user u,notifications n,notificationrecievers nr WHERE\n      nr.recieverid=? AND u.userid=n.senderid AND nr.notificationid=n.notid ORDER BY n.notid DESC\n      LIMIT 50 OFFSET ?\n     )g\n);\n\n';\nEXECUTE STMT USING @uid,@post,@uid,@rangee,@uid,@rangee,@uid,@uid,@rangee,@uid,@rangee;\n</code></pre>\n\n<p>When I run this query in the procedure it gives me syntax error.But when I use it directly by giving hard coded values in place of <code>?</code> than it works fine.Why is this happening? <code>puserid</code> and <code>plimit</code> are the parameters which i pass to this procedure.</p>\n\n<p>This is the error:</p>\n\n<pre><code>Code: 1064\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ';\n\nUPDATE \nnotificationrecievers \nSET notificationrecievers.st' at line 25\n</code></pre>\n"},{"tags":["php","mysql","sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":12542449,"title":"Migrate PHP code from MSSQL to MySQL","body":"<p>I currently have a large web application that connects to MSSQL to fetch its data. This web app has hundreds of .php files. I have a new customer, and he doesn't want to use MSSQL, but MySQL instead. </p>\n\n<p>I've searched and found lots of articles on how to migrate data. But that's not my problem. I know how to do that, besides we'll be starting with a blank database, except for a few default catalogs.</p>\n\n<p>What I need to know is if there's a way to automatically change the mssql_query code to mysqli code. For example:</p>\n\n<pre><code>$SqlText = 'SELECT a, b, c FROM table WHERE x=y';\nif (!$result = mssql_query($SqlText) {\n   die('Error');\n}\nwhile ($row = mssql_fetch_assoc($result) {\n   echo '&lt;td&gt;' . $row['a'] . '&lt;/td&gt;';\n   echo '&lt;td&gt;' . $row['b'] . '&lt;/td&gt;';\n   echo '&lt;td&gt;' . $row['c'] . '&lt;/td&gt;';\n}\n</code></pre>\n\n<p>Into something like:</p>\n\n<pre><code>$SqlText = 'SELECT a, b, c FROM table WHERE x=y';\nif (!$result = mssqli_query($db, $SqlText) {\n   die('Error');\n}\nwhile ($row = mssqli_fetch_assoc($result) {\n   echo '&lt;td&gt;' . $row['a'] . '&lt;/td&gt;';\n   echo '&lt;td&gt;' . $row['b'] . '&lt;/td&gt;';\n   echo '&lt;td&gt;' . $row['c'] . '&lt;/td&gt;';\n}\n</code></pre>\n\n<p>Besides, as you can see, I was using the old mssql_query code which is not even supported in the newer versions of PHP. Is there at least a tool that could change my code from mssql_query into the new version of sqlserv_query type of commands?</p>\n\n<p>Any help greatly appreciated.</p>\n"},{"tags":["php","jquery","mysql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":12519517,"title":"fire single query to fetch records for grid pagination","body":"<p>I am fetching records from database in PHP and MySQL and showing it into the jqgrid.</p>\n\n<p>Now i request 1 page which encompass 10 rows data in first request.</p>\n\n<p>to achieve that i fire <code>one</code> query to get <code>total number of records</code> and then calculate \n<code>totalpages</code> which contains all total records.</p>\n\n<p>and <code>second</code> query to fire limited records i.e. <code>1 to 10</code> and next time <code>11 to 20</code> and so on.</p>\n\n<p>so the problem is every time i have to fire two queries one to fetch the total number of records and other to fetch limited rows for a grid.</p>\n\n<p>is it possible to fire only one query to achieve above thing ? </p>\n\n<p>to fetch record in a normal fashion the above scenario is fine but if i preform serch then i have to fire two queries one to fetch total number of rows that matches the criteria and other to fetch only limited rows that meets the criteria</p>\n\n<p><strong>Update</strong></p>\n\n<p>Well my limits to access rows is depends upon the total number of records so i dont see any option to fire only one query. Please look how my PHP code is counting limit</p>\n\n<p>1) Fire the query to access total records </p>\n\n<pre><code>$selectMemberData = \"SELECT * FROM tbl_member\";\n    //some db code  ... \n    // store the total records value\n    $count = $dbMemberData-&gt;numRows; \n\n\n\nif( $count &gt;0 ) {\n    $total_pages = ceil($count/$limit);\n} else {\n    $total_pages = 0;\n}\n\nif ($page &gt; $total_pages) $page=$total_pages;\n\n\n$start = ( $limit * $page ) - $limit; // do not put $limit*($page - 1)\n\n   //Fire another query to fetch limited records \n\n    $selectMember = \"SELECT * FROM tbl_member   LIMIT \"  .$start.\", \". $limit;\n</code></pre>\n\n<p>so my concern is when i use autocomplete search at that moment it would be pretty expensive to fire the two queries. and the issue is i have dependent on total records to get <code>start</code> and <code>end</code> limit</p>\n"},{"tags":["query","mongodb","mongoid"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":263,"score":2,"question_id":9688007,"title":"Mongoid limit parameter ignored","body":"<p>I tried to grab the latest N records with a unique value (first_name).</p>\n\n<p>So far: </p>\n\n<pre><code>@users = User.all(:limit =&gt; 5, :sort =&gt; [:created_at, :desc]).distinct(:first_name)\n</code></pre>\n\n<p>almost works..But ignores the limit and sort order<br>\nAlso:</p>\n\n<pre><code>@users = User.limit(5).desc(:created_at).distinct(:first_name)\n</code></pre>\n\n<p>Ignores both 'limit' and 'desc'</p>\n\n<pre><code>@users = User.limit(5)\n</code></pre>\n\n<p>Works..</p>\n\n<p>What am I doing wrong?<br>\nAny help would be greatly appreciated!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":12541040,"title":"How to calculate Rank from mysql table","body":"<p>I have the following table in MySQL:</p>\n\n<pre><code>===================================================================\nid  | member|  total_correct_question | time_taken_in_seconds |\n\n===================================================================\n1   |  abc  |     2                    |       4              |\n2   |  def  |     3                    |       6              |\n3   |  ghi  |     3                    |       4              |\n4   |  jkl  |     3                    |       5              |\n====================================================================\n</code></pre>\n\n<p>I want to show the rank of each user from mysql query. Can any one suggest me a query for this?</p>\n"},{"tags":["mysql","sql","ruby-on-rails","query","date-range"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":173,"score":1,"question_id":10849467,"title":"Using user variable to show data between dates in mysql","body":"<p>I want to show all the data between given dates. date for which no data is found i want to show null for all the columns</p>\n\n<p>Table Schema</p>\n\n<pre><code>TimeEntry(id: integer, project_id: integer, user_id: integer, hours: float, comments: string, spent_on: date)\n</code></pre>\n\n<p>What i tried so far,</p>\n\n<pre><code>set @num = -1;\nSELECT DATE_ADD(  '2009-01-01', INTERVAL @num := @num +1\nDAY ) AS date_sequence, time_entries.id\nFROM time_entries\nWHERE user_id =55\nHAVING DATE_ADD(  '2009-01-01', INTERVAL @num DAY ) &lt;=  '2012-01-01'\n</code></pre>\n\n<p>It gives following output</p>\n\n<pre><code>date_sequence id\n2009-01-01  46\n2009-01-02  50\n2009-01-03  55\n2009-01-04  01\n2009-01-05  02\n2009-01-06  24\n2009-01-07  57\n2009-01-08  59\n2009-01-09  74\n2009-01-10  78\n</code></pre>\n\n<p>Expected output is</p>\n\n<pre><code>date_sequence id\n2009-01-01  NULL\n2009-01-02  NULL\n2009-01-03  NULL\n2009-01-04  NULL\n2009-01-05  NULL\n2009-01-06  NULL\n2009-01-07  NULL\n2009-01-08  NULL\n2009-01-09  74\n2009-01-10  78\n</code></pre>\n\n<p>because id exists only for 09 and 10</p>\n\n<p>How to match the dates with other fields?</p>\n\n<p>Hints/Comments?</p>\n\n<p>Rails based solution would be also be useful.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>what i tried in rails so far</p>\n\n<pre><code>def create_dates(from_time,till_time)\n  dates = []\n  date_from = from_time.to_time\n  while date_from &lt;= till_time.to_time &amp;&amp; periods.length &lt;= 100          \n      dates &lt;&lt; \"#{date_from.to_date}\"\n      date_from = date_from + 1.day\n  end\ndates\n</code></pre>\n\n<p>end</p>\n\n<p>It returns me the dates between given period. but i cant get to match my data with these dates</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":11716954,"title":"Update command fails. Can someone check my query?","body":"<p>I have a table (<code>custTAB</code>) which has some <em>zip</em> codes missing, but has  <em>city</em>, <em>state</em> names. I have a <code>zipTAB</code> which has a <em>city</em>, <em>state</em> and <em>zip</em> codes. My intent is to copy the missing zip codes from zipTAB to custTAB. However, for some reason my update doesn't work as intended. If there were 10K NULL cust_zips, after the update I get 20K NULL cust_zips. Can someone check what's going on? ) </p>\n\n<pre><code>update custTAB \n   set cust_zip = (select zip \n                     from zipTAB \n                    where custTAB.cust_zip  is null and \n                          custTAB.cust_city   =  zipTAB.city and \n                          custTAB.cust_state  =  zipTAB.state \n                    limit 1 \n                  );\n</code></pre>\n\n<p>Thanks.\nPS: The row numbers are edited for easier reading.</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":11236511,"title":"Selecting the complement of distinct triples in mySQL","body":"<p>I have tables like these two</p>\n\n<pre><code>test_table\ndate        student     test\n2012-05-31  Alice       Math\n2012-05-31  Alice       Math\n2012-05-31  Bob         Math\n2012-05-31  Bob         Spelling\n2012-06-01  Alice       Math\n2012-06-01  Alice       Spelling\n\nscore_table\ndate        student     test        best_daily_score\n2012-05-31  Alice       Math        90\n2012-05-31  Bob         Math        50\n2012-05-31  Bob         Spelling    50\n2012-06-01  Alice       Math        95\n</code></pre>\n\n<p>I'd like to detect that Alice's <code>best_daily_score</code> for the <code>Spelling</code> test on <code>2012-06-01</code> hasn't been recorded yet. I'm looking for the query that returns</p>\n\n<pre><code>2012-06-01  Alice       Spelling\n</code></pre>\n\n<p>which is the only row of</p>\n\n<pre><code>SELECT DISTINCT date, student, test FROM test_table\n</code></pre>\n\n<p>that is not in </p>\n\n<pre><code>SELECT DISTINCT date, student, test FROM score_table\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<pre><code>SELECT DISTINCT date, student, test FROM test_table WHERE date, student, test NOT IN (SELECT DISTINCT date, student, test FROM score_table)\n</code></pre>\n\n<p>I assume because the left side of <code>NOT IN</code> should not be a list of three things.</p>\n"},{"tags":["mysql","query","phpmyadmin"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12540578,"title":"Why doesn't this query work? Combining Having and Where","body":"<pre><code>SELECT fileUser FROM `images` \nHAVING min(imageid) AND \nWHERE (finished=0 and processing=0)\n</code></pre>\n\n<p>It seems a simple thing to get the <code>fileUser</code> index with the least <code>imageID</code> where finished and processing also = 0. But, I cannot seem to come up with a query that works? Any help would be great.</p>\n"}]}
{"total":20740,"page":20,"pagesize":100,"questions":[{"tags":["sql-server","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12535764,"title":"Retrieve records above and below a specific record","body":"<p>I often verify logs in SQLServer and my query usually looks like this (where Type = 0 means error):</p>\n\n<pre><code>SELECT * \nFROM Logs \nWHERE Type = 0 \nORDER BY Timestamp\n</code></pre>\n\n<p>But most of the time, I'm not only interested by the error itself but also at what happened immediately before the error.</p>\n\n<p>Is it possible, with SQLServer, to query n lines above/under (relative to the primary key) each line matching the WHERE clause of the query?</p>\n\n<p>Ex. With my query I would only get lines 125 &amp; 130. I would like [123, 124, 125] and [128, 129, 130].</p>\n\n<pre><code>PrimaryKey  Timestamp             Type  Description\n123         2012-09-17 03:41:46.240 1   Working.\n124         2012-09-17 03:42:46.240 1   Database backup.\n125         2012-09-17 03:43:46.240 0   Access violation.\n126         2012-09-17 03:44:46.240 1   Working.\n127         2012-09-17 03:45:46.240 1   Working.\n128         2012-09-17 03:46:46.240 1   Working.\n129         2012-09-17 03:47:46.240 1   Backup.\n130         2012-09-17 03:48:46.240 0   Corrupted.\n131         2012-09-17 03:49:46.240 1   Working.\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["c#","linq","query","linq-to-sql","dynamic"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12538332,"title":"C# Dynamic Query Without A Database Model","body":"<p>I have been searching the web for a solution to dynamic queries.</p>\n\n<p>I have found many different solutions (e.g. Linq to Sql, Dynamic Linq Expressions, Dynamic Query), but all of these solutions involve some sort of previous knowledge of the database (like a model in code).  Maybe what I am asking is way off the deep end, but is there any possible way to dynamically query a database without a model?</p>\n\n<p>For example, a database has a <code>Customers</code> table with the following columns:</p>\n\n<ul>\n<li>CustomerID</li>\n<li>Name</li>\n<li>FavoriteColor</li>\n</ul>\n\n<p>I want to create a query as <code>SELECT Name FROM Customers WHERE @0 = @1</code>, where the two placeholders are populated dynamically.  The resulting data does not tie to a model class and I would prefer to use some sort of framework to build the queries, not simple string concatenation.</p>\n\n<p>The System.Linq.Dynamic namespace came really close to fulfilling this request, but it uses a database model.</p>\n\n<p>I realize this is crazy, but I was just curious.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12537941,"title":"MySQL select most recent record IDs","body":"<p>I have a Message table that has following two columns:</p>\n\n<pre><code>- ID\n- SENT_DATE\n</code></pre>\n\n<p>Say I have the following records ordered by SENT_DATE:</p>\n\n<pre><code>ID              SENT_DATE\n\n54              2012-09-21 13:25:20\n53              2012-09-21 13:25:17\n32              2012-09-21 13:25:15\n52              2012-09-21 13:25:14\n51              2012-09-21 13:25:12\n46              2012-09-21 13:25:12\n50              2012-09-21 13:25:11\n</code></pre>\n\n<p>How do I get all new message IDs sent after ID=46 (exclusive)? The query should return the following list:</p>\n\n<pre><code>ID\n\n54\n53\n32\n52\n51\n</code></pre>\n\n<p>Notice that the message IDs don't increase monotonically overtime, as they are generated by different message queues. But the IDs are unique. Also, two messages can be sent at the same time.</p>\n"},{"tags":["sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12538301,"title":"extract data from two tables in a relationship, but have the data in one table only appear once","body":"<p>I have two tables that I need to pull data from, 'Table A' and 'Table B'.  There is a a 1:M relationship between 'Table A' and 'Table B', with A.IDNumber as a Foreign Key in 'Table B'.</p>\n\n<p>What I want to do is to extract the values from Table A once, and the corresponding values from 'Table B' without repeating the 'Table A' data.  </p>\n\n<p>What would my query look like to do this?  To help, let's say I want the following values from 'Table A': A.IDNumber, A.Amount, and from 'TableB' values B.IDNumber, B.Address, B.State, B.City, B.State, B.Zip.  </p>\n\n<p>Thanks for any help with this!</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12538352,"title":"SQL Sorting within a sort","body":"<p>Okay, this should be a fairly easy question I think, but haven't been able to figure it out yet.</p>\n\n<p>I have a table entitled Staff. The staff DESC is below:</p>\n\n<pre><code>SQL&gt; DESC Staff\nName                                      Null?    Type\n----------------------------------------- -------- ----------\nSNO                                       NOT NULL CHAR(5)\nFNAME                                              VARCHAR2(3\nLNAME                                              VARCHAR2(3\nPOSITION                                           VARCHAR2(1\nSEX                                                CHAR(1)\nDOB                                                DATE\nSALARY                                             NUMBER(9)\nBNO                                                CHAR(4)\n</code></pre>\n\n<p>Here is the current query I am using:</p>\n\n<pre><code>SELECT bNo, lName||' '||fName, position, salary\nFROM Staff\nWHERE bNo 'b009'\nOR bNo = 'b005'\nORDER BY \n    case position\n        when 'Manager' then 1\n        when 'Secretary' then 2\n        when 'Supervisor' then 3\n        when 'Assistant' then 4\n    else 99\nend;\n</code></pre>\n\n<p>The problem I am having is that within each position group, I need to sort by lName as well. Any tips would be greatly appreciated. Thanks in advance.</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12506623,"title":"How to use 'replace' function in PostgreSQL to string replace","body":"<p>I want to do string replace in some data in <code>pgsql</code> database column. I tried </p>\n\n<pre><code>CASE\n    WHEN (po.siteid IS NOT NULL) THEN replace('po.html_content', 'abcd', 'xxx')\n        ELSE pc.html_content\n END  \n</code></pre>\n\n<p>I want to replace string in <code>po.html_content</code> column. But above code is not working. Query get the data in  <code>po.html_content</code> column without replacing. \nIs my code is wrong or any idea...</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12537134,"title":"Querying a database with oop","body":"<p>I have connected to a database for the first time with oop and stright away come up with an issue, below is my code which i'm struggling with:</p>\n\n<pre><code>$q = 'SELECT * FROM test';\n       $sqli-&gt;query($q);\n\n       if($sqli-&gt;query($q)){\n           echo \"worked\";               \n       }\n\n       if($sqli-&gt;error){\n           echo $sqli-&gt;error;\n       }\n</code></pre>\n\n<p>I have checked for errors when connecting to the db and that works fine, but when I run this query I get no output, why? I expected an error or \"worked\", but have got neither.</p>\n\n<p>Whats happening?</p>\n"},{"tags":["php","sql","query","cart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12534431,"title":"php sql multiple queries. Is it a big deal?","body":"<p>I have a cart class, where I store the product ids. The user can open the cart through a button that opens the cart in a popup, so the cart content has to be loaded in every page.</p>\n\n<p>I can store only the ids of the products because of the size limits, but I want to show the product names to the final user, so for each element I need to make a query and get the product data from the database.</p>\n\n<p>Is there any major drawback by doing this? Or are there better solutions?</p>\n\n<p>PS: I could get the id of all the products in the cart, and then do one single query that gets the data of any needed product. I’d rather avoid this since I would need to rewrite parts of the class, so is there any actual difference with the previous solution?</p>\n\n<p>PPS: The total number of sql queries shouldn’t be too high in any case. Of course I wouldn’t mind, but I strongly doubt any user will purchase hundreds of different products at one time.</p>\n"},{"tags":["mysql","query","countif"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12536388,"title":"MySQL Count If DateDiff","body":"<p>I would like to count different conditions in one table:</p>\n\n<pre><code>SELECT gt.smechanic as 'Mech ID', \n       gm.mechanic_name as 'Mech Name', \n       count(gt.smechanic) as 'Total Invoices Not Received',\n       count(if(datediff(gt.dispatch_date, curdate()) &lt; 10,1,0)) as 'Within 10 days' \nfrom gt \nstraight_join gm on gt.smechanic = gm.mechanic_id \nwhere gt.status = 3 or gt.status = 5 \ngroup by gt.scheduled_mechanic\n</code></pre>\n\n<p>I am not sure if I am cancelling myself out with this statement because in both columns that I am counting the same value is returned.</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":29,"score":1,"question_id":12536394,"title":"Doing addition and comparing columns in WHERE statement","body":"<p>So I am trying to run a query which does some math in the <code>WHERE</code> statement.  It seems that what I wrote is correct, yet it does not seem to work.</p>\n\n<pre><code>SELECT *\nFROM table\nWHERE col_a + col_b != col_d\n</code></pre>\n\n<p>Basically I want to see all records where <code>col_a</code> added to <code>col_b</code> does not add up to <code>col_d</code>.</p>\n"},{"tags":["mysql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12502483,"title":"'Cannot add or update a child row: a foreign key constraint fails' in transaction","body":"<p>I got three tables, a parent one (called <strong>profiles</strong>) and two tables one can consider a child (<strong>values</strong> and <strong>url</strong>). This is just a test to play around so don't mind missing SQL injection security.</p>\n\n<pre><code>CREATE TABLE `profiles` (\n `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n `profile` int(10) unsigned NOT NULL,\n `url_hash` varchar(32) NOT NULL,\n PRIMARY KEY (`id`,`profile`,`url_hash`),\n UNIQUE KEY `id` (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=latin1\n\n\nCREATE TABLE `urls` (\n `id` int(10) unsigned NOT NULL,\n `url` text NOT NULL,\n `title` text,\n PRIMARY KEY (`id`),\n CONSTRAINT `urls_ibfk_1` FOREIGN KEY (`id`) REFERENCES `profiles` (`id`) \nON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n\n\nCREATE TABLE `values` (\n `id` int(10) unsigned NOT NULL,\n `seller` text NOT NULL,\n `seller_language` text,\n `quality` tinyint(3) unsigned NOT NULL,\n `note` text,\n `price` int(10) unsigned NOT NULL,\n `count` tinyint(3) unsigned NOT NULL,\n PRIMARY KEY (`id`),\n CONSTRAINT `values_mtg_ibfk_1` FOREIGN KEY (`id`) REFERENCES `profiles` (`id`) \nON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n</code></pre>\n\n<p>I'm executing the following three queries as transaction (surrounding autocommit(false), commit() &amp; rollback() omitted):</p>\n\n<pre><code>$db-&gt;query('INSERT INTO profiles(id, profile, url_hash) \nVALUES (null, ' . $profile . ', \"' . md5($url) . '\")')\nor throwException(...);\n\n$db-&gt;query('INSERT INTO urls(id, url, title) \nVALUES (' . mysqli_insert_id($db) . ', \"' . $url . '\", \"' . $c-&gt;data('title') . '\")')\n or throwException(...);\n\n$db-&gt;query('INSERT INTO values(id, seller, seller_language, quality, \nnote, price, count) \nVALUES (' . mysqli_insert_id($db) . ', \"'. $seller .'\", \"'. $seller_lang .'\", \n'. $qual .', \"'. $notice .'\", '. $price .', '. $ount .')') \nor throwException(..);\n</code></pre>\n\n<p>Resulting in</p>\n\n<pre><code>exception 'Exception' with message 'Query failed (table: values): \n(1452) Cannot add or update a child row: a foreign key constraint fails\n(`crawler`.`values`, CONSTRAINT `values_ibfk_1` FOREIGN KEY (`id`) REFERENCES\n`profiles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)'\n</code></pre>\n\n<p>and I just don't get why. It is stating the corresponding <strong>id</strong> in the parent table is missing. If that's the case why does the second query work since its table <strong>urls</strong> got the very same foreign key relationship to table <strong>profiles</strong> like table <strong>values</strong>?</p>\n\n<p><strong>Edit</strong>: there is a huge flaw in my database design, regarding the FK in <strong>values</strong> which can't be unique. Gonna think about it tomorrow. :)</p>\n"},{"tags":["database","query","table","prefix"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12535116,"title":"How to define table prefix in variable","body":"<p>I want to define prefix in variable</p>\n\n<pre><code>global $wpdb;\n    $prefix = 'qa_';\n    $titles = $wpdb-&gt;get_results(\"\n        SELECT title\n        FROM \"$prefixpages\"\n        }\n    \");\n</code></pre>\n\n<p>Can anyone guide why its not working and hot to make it works.</p>\n\n<p>Thanks a lot</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":67,"score":-1,"question_id":12535400,"title":"Writing a SQL query involving aggregate functions","body":"<p>I have created a the following view in my Database after combining multiple tables. A <code>select * from MYViEW</code> gives the following result below.</p>\n\n<pre><code>ProductID | TechID | ContactID | Priority | FIRSTNAME | MIDDLEINI | LASTNAME | \n1123         2406       1371        1        Pradeep       X          Nayak      \n1123         2406       1368        2        Hello         W          World      \n1123         2406       1363        3        Foo           Y          World    \n1299         2279       1208        2        Some          Z          Dude     \n</code></pre>\n\n<p>And I need the OUTPUT result to below to be displayed:</p>\n\n<pre><code>ProductID | TechID | ContactID | Priority | FIRSTNAME | MIDDLEINI | LASTNAME | Buyers                                        |\n1123         2406       1371        1        Pradeep    X           Nayak      Nayak, Pradeep X; World, Hello W; World, Foo Y  \n1299       2279         1208        2        Some       Z           Dude       Dude, Some Z\n</code></pre>\n\n<p>For every Product ID and Tech ID have a single record, and all the Buyers must be combined in a column in the format <code>LastName, FirstName MiddleIni</code> and each name separated by a space. I have already tried to use the custom aggregate function from <a href=\"http://msdn.microsoft.com/en-us/library/ms131056.aspx\" rel=\"nofollow\">here</a> for combing the results to a single column. Please let me know if you can help me with a query for this.</p>\n"},{"tags":["query","mongodb","data-structures","nosql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":12535621,"title":"How to Model and Index User Actions on a Resource in an optimal way ( for performance)","body":"<p>In a blogging system, if I want to store user actions on a particular blog post, what would be  the best way to model it ? </p>\n\n<p>A user can perform some action on a blog post, such as 'edit' , 'comment' , 'share'. </p>\n\n<pre><code>Option 1:\n\nUse an int to represent n! probable actions that may have been taken. n! options due to the lack of bitwise operation support in mongo. \n\nActionIds: ( 1: edit, 2:comment, 3:share, 4: edit&amp;comment, 5: comment&amp;share, 6: edit&amp;share, 7: edit,comment &amp; share) \n\nUserId BlogId ActionId\n1       1       1 \n1       2       5\n2       1       2\n2       2       3\n\n\nOption 2:\n\nModel each action in a different collection\n\nEdit Collection:\n\nUserId BlogId\n1       1\n\nComment Collection\n\nUserId BlogId\n2       1\n1       2\n\nShare Collection\n\nUserId BlogId\n1       2\n2       2\n</code></pre>\n\n<p>There are a couple of use cases for querying: </p>\n\n<p>1) The application is likely to query for a list of users who performed a set of actions in on a given blog. \n2) It will also query for a list of blogs on which a certain action was performed by a given user.</p>\n\n<p>Given these two use cases, what would be the best way to <strong>model and index</strong> this information in mongo. </p>\n"},{"tags":["mysql","database","query","pdo","sqlbindparameter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12535382,"title":"PDO - How to update firstname where username=:user_id, bind value","body":"<p>I am trying to run this query however, i keep getting the error \"Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1' in /home/a7668955/public_html/uploadproc1.php:106 Stack trace: #0 /home/a7668955/public_html/uploadproc1.php(106): PDOStatement->execute() #1 {main} thrown in /home/a7668955/public_html/uploadproc1.php on line 106\" </p>\n\n<p>i am sure it is to do with the way i have written the SQL statement, I am not sure how to bind the values when user_id is used twice?</p>\n\n<pre><code> $sql1 = \"UPDATE people SET firstname = (SELECT firstname FROM user WHERE username=:user_id) WHERE username=:user_id)\";\n                            $q = $conn-&gt;prepare($sql1) or die(\"failed!\");\n                            $q-&gt;bindParam(':user_id', $user_id, PDO::PARAM_STR);\n                            $q-&gt;execute();\n</code></pre>\n\n<p>Thanks for any help! (This query ran successfully using the old mysql_*)</p>\n"},{"tags":["query","go"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12534326,"title":"Why are there only two query types in the Go Database library?","body":"<p>From what I can tell, there are only two types of results the Go <code>database/sql</code> interface library expects back - <a href=\"http://golang.org/pkg/database/sql/#DB.QueryRow\" rel=\"nofollow\">a row</a> or an <a href=\"http://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow\">array of rows</a>. However, there is at least one more type of result - a single column.</p>\n\n<pre><code>DB.column('SELECT COUNT(*) FROM `user` WHERE `banned` IS NOT NULL')\n</code></pre>\n\n<p>Is there any way to handle this - or do I just have to fetch a row and then access the <code>COUNT(*)</code> from that?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":49,"score":-1,"question_id":12534987,"title":"how to select query using two tables with condition","body":"<p>I have 2 tables, Table A for Student_Record and Table B for Student_Subject linked by the Student_ID field.<br/><br/></p>\n\n<pre><code>Table A (Student_Record)\nStudent_ID | Name  | School_Year\n1          | Jane  | 2010-2011\n2          | Amy   | 2010-2011\n3          | Dave  | 2011-2012\n4          | Roger | 2010-2011\n</code></pre>\n\n<p><br/></p>\n\n<pre><code>Table B (Student_Subject)\nStudent_ID | Subject | Grade\n1          | Math    | Passed\n1          | Physics | Passed\n1          | History | Passed\n2          | Math    | Failed\n2          | Physics | Passed\n2          | History | Passed\n3          | Math    | Passed\n3          | Physics | Passed\n3          | History | Passed\n4          | Math    | Passed\n4          | Physics | Passed\n4          | History | Passed\n</code></pre>\n\n<p><br/></p>\n\n<p>Based on the sample table above, I want to select the students enrolled in 2010-2011 and who passed all the subjects. <br/><br/>The result should return <strong>Jane</strong> and <strong>Roger</strong> because they passed all their 3 subjects and are enrolled in 2010-2011 compared to <strong>Amy</strong> which Failed on Math and <strong>Dave</strong> whose school_year is 2011-2012.</p>\n"},{"tags":["php","mysql","query","table","switch-statement"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12534893,"title":"Switch Between two Seperate Table Queries PHP MySQL","body":"<p>I'm trying incorporate a \"News Feed\" into my site, pulling information from two different tables (Using two seperate queries). One feed pulls current stories \"$newsfeed\" and the other pulls history stories \"$historyfeed\". <strong>Both tables need to remain seperate</strong>. I'm attempting to place these queries in a random order for a set number or rows. For example, I want 5 stories listed, with history and news choosen randomly. </p>\n\n<p>The order might be: <em>History, News, History, History, History</em></p>\n\n<p>the next visit might produce: <em>News, News, New, History, News</em></p>\n\n<p>This part seems to work fine...</p>\n\n<p>However, I've been unable to move to the next row in the query. So five of the exact same news stories are produced, instead of moving to the next row of the query. See the example code below:</p>\n\n<pre><code>//DB connection established earlier\n$newsfeed = mysql_query(\"SELECT * FROM newsfeed WHERE story_type='business'\"); //News Story Query\n$row_newsfeed = mysql_fetch_assoc($newsfeed);\n\n$historyfeed = mysql_query(\"SELECT * FROM newsfeed WHERE story_type='business'\"); //History Story Query\n$row_historyfeed = mysql_fetch_assoc($historyfeed);\n\n$storycount = 0;\nwhile ($storycount &lt; 5) {\n\n$storytype = rand(1,2); //randomly select next story type\n\nswitch ($storytype){\n    case: \"1\" //if next story is a new story\n            storybubble($row_newsfeed); //function to echo newsfeed content\n            $storycount++;\n    break;\n    case: \"2\" //if next story is a history story\n            storybubble($row_historyfeed); //function to echo historyfeed content\n            $storycount++;\n    break;\n    default:\n            echo \"Error\";\n} //switch statement\n} //story count while statement\n</code></pre>\n"},{"tags":["sql","oracle","query","count","aggregate-functions"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":88,"score":4,"question_id":12534177,"title":"Using count distinct to find records with 2 or more different values in a field","body":"<p>I have a simple question: How can I use Count(Distinct) in SQL (Oracle to be exact) to return only the rows where there are two or more different values in a given field.</p>\n\n<p>This is easier understood by example:</p>\n\n<pre><code>ACCOUNT     SALESMAN\n123         Abc\n123         Abc\n\n246         Abc\n246         Def\n246         Def\n\n369         Hij\n\n456         Abc\n456         Def\n</code></pre>\n\n<p>In this example, the only Accounts with 2 <strong>different</strong> sales reps would be 246 and 456, and thus, I'd want the query's result to just show the the accounts shared by 2 or more salesmen:</p>\n\n<pre><code>ACCOUNT     SALESMAN\n246         Abc\n246         Def\n456         Abc\n456         Def\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","sql","query","request","datatables"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":10719235,"title":"MYSQL request from two tables with CONCAT","body":"<p>maybe you can help me:</p>\n\n<p>If have a table1: accounts</p>\n\n<pre><code>user_id   account_id   \n39        3799207\n39        80286966\n40        3789458\n</code></pre>\n\n<p>...</p>\n\n<p>table2: subscribers</p>\n\n<pre><code>id   client_id  master_id   master_account_id   active \n1    43         39          3799207             1\n2    43         39          80286966            1\n3    44         39          80286966            1\n4    45         39          80286966            1\n</code></pre>\n\n<p>...</p>\n\n<p>Using this request:</p>\n\n<pre><code>'SELECT account_id FROM accounts WHERE user_id = \"39\"';\n</code></pre>\n\n<p>I can get this table:</p>\n\n<pre><code>Account\n3799207\n80286966\n</code></pre>\n\n<p>How can I get this table:</p>\n\n<pre><code>Account      Subscribers     Count\n3799207      43              1\n80286966     43,44,45...     3\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","query","select"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":11879112,"title":"MySQL Query Not Working Properly","body":"<p>Where is the mistake?</p>\n\n<p>Thank you!</p>\n\n<pre><code>SELECT Table.id,\n       Table.name,\n   Table.kommentar,\n   Table.pictureurl\n\n   WHERE Table.news_id = 5, //without this line the query works!\n\n   COUNT( Table1.comment_id ) AS numComments\n   FROM DATABASE.news_comments          AS Table\n   LEFT JOIN DATABASE.news_comments_comments AS Table1\n   ON Table1.comment_id = Table.id\n\n   GROUP BY Table.id\n   ORDER BY Table.id DESC LIMIT 0,50\n</code></pre>\n"},{"tags":["sql","query","ssas","max","mdx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12515417,"title":"Regarding Max function in MDX","body":"<p>I have a fact table with structure: (objectid, fromLoc, toLoc, duration).</p>\n\n<p>I need the equivalent MDX for the following SQL:</p>\n\n<pre><code>select fromLoc, toLoc, max(duration) from fact group by fromLoc, toLoc;\n</code></pre>\n\n<p>I tried with the following MDX but it's showing wrong results. It's showing sum(duration) instead of showing max value for each grouping:</p>\n\n<pre><code>WITH\n  MEMBER [Measures].[MaxValue] AS\n  max([Measures].[Duration]) \n select FromLoc.members on axis(1),\ntoLoc.members  on axis(0)\nfrom [cube1]\nwhere [Measures].[MaxValue]\n</code></pre>\n\n<p>Please help me by providing the correct MDX which can answer the queries like the above SQL.</p>\n"},{"tags":["query","ssas","mdx","dimensions"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12532704,"title":"MDX Get MAX MEMBER_KEY from Dimension","body":"<p>I have a very simple SSAS dimension which looks like this:</p>\n\n<p>Dimension Name: <strong>DimKeyword</strong></p>\n\n<p>1 Attribute: <strong>Keyword</strong> with KeywordID as the <strong>KeyColumn</strong> and Keyword (name) as the <strong>NameColumn</strong></p>\n\n<p>Using MDX, I want to get one row with the <strong>Max</strong> MEMBER_KEY for the DimKeyword dimension (without listing all the Keywords), so far I have:</p>\n\n<pre><code>WITH MEMBER KeywordID as\n[Dim Keyword].[Keyword].currentmember.MEMBER_KEY\nSELECT {KeywordID} on COLUMNS\nFROM [Some Cube]\n</code></pre>\n\n<p>Although this seems to only return 0 (which I assume is for the member ). Can anyone help?</p>\n\n<p>Thanks!</p>\n"},{"tags":["query","mongodb","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12525170,"title":"Can I add or sort by a MongoDB match object?","body":"<p>So I have two collections, Trait and Question. For a given user, I iterate over the user's traits, and I want to query all of the questions that correspond to missing traits:</p>\n\n<pre><code>linq.From(missingTraits)\n.ForEach(function(trait)\n{\n    match.$or.push({ \"Trait\": trait });\n});\n\ndatabase.collection(\"Questions\", function(err, collection)\n{\n    collection.find(match).limit(2).toArray(function(err, questions)\n    {\n        next(err, questions);\n    });\n});\n</code></pre>\n\n<p>This works, but I'd like the objects to come back sorted by a field on the Trait document  (which is NOT on the Question document):</p>\n\n<pre><code>Traits\n[\n  { \"Name\": \"Height\", \"Value\": \"73\", \"Importance\": 15 },\n  { \"Name\": \"Weight\", \"Value\": \"230\" \"Importance\": 10 },\n  { \"Name\": \"Age\", \"Value\": \"29\", \"Importance\": 20 }\n]\n\nQuestions\n[\n  { \"Trait\": \"Height\", \"Text\": \"How tall are you?\" },\n  { \"Trait\": \"Weight\", \"Text\": \"How much do you weight?\" },\n  { \"Trait\": \"Age\", \"Text\": \"How old are you?\" }\n]\n</code></pre>\n\n<p>So in the above example, if all three traits were missing, I'd want to bring back only Age and height (in that order). Is it possible to modify the query or the match object in some way to facilitate this?</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12532114,"title":"Group by X and count the NULLS in the same col","body":"<p>Hi here is my query:</p>\n\n<pre><code>SELECT \n    CONCAT( YEAR( prm.fromdt ) , '|', MONTH( prm.fromdt ) ) AS k, \n    CONCAT( YEAR( prm.fromdt ) , ' - ', MONTH( prm.fromdt ) ) AS v,\nFROM prm\nGROUP BY k\nORDER BY `k` DESC\n</code></pre>\n\n<p>Wich returns:</p>\n\n<pre><code>K       V\n2009|7  2009 - 7\n2009|6  2009 - 6\nNULL    NULL\n</code></pre>\n\n<p>Is there a way Instead <code>NULL NULL</code> to get how many nulls I have. Something like</p>\n\n<pre><code>K       V\n2009|7  2009 - 7\n2009|6  2009 - 6\nNulls   6\n</code></pre>\n"},{"tags":["query","postgresql","postgresql-8.4","generate-series"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12444142,"title":"PostgreSQL: How to figure out missing numbers in a column using generate_series()?","body":"<pre><code>SELECT commandid \nFROM results \nWHERE NOT EXISTS (\n    SELECT * \n    FROM generate_series(0,119999) \n    WHERE generate_series = results.commandid \n    );\n</code></pre>\n\n<p>I have a column in <code>results</code> of type <code>int</code> but various tests failed and were not added to the table.  I would like to create a query that returns a list of <code>commandid</code> that are not found in <code>results</code>.  I thought the above query would do what I wanted. However, it does not even work if I use a range that is outside the expected possible range of <code>commandid</code> (like negative numbers).</p>\n"},{"tags":["sql","query","excel","ms-access"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":102,"score":2,"question_id":12529113,"title":"SQL Sort table and Update Column","body":"<p>Hi can anyone tell me the how I can do the following with SQL In an MS Access Database.?</p>\n\n<p>I have a table that looks like this:</p>\n\n<p>MyTable</p>\n\n<pre><code>Plan    Item        Sort_Number\n-------------------------------------\n11026    ZSC1753D   \n11018    PS13-2     \n11026    ZSC1753B   \n11018    PSHH278B   \n11026    ZSO1753A   \n11018    PS3169     \n11027    ZSC1754B   \n11027    ZSC1754A   \n11026    ZSC1753A   \n11026    ZSC1753C   \n</code></pre>\n\n<p>I have a table (above) which needs to be sorted first by the Plan (Column 1), then by Ascending order of Item (Column 2) and the third column Sort Number needs to be populated with sequential numbers of 1 to xx.. for each of the different plans.</p>\n\n<p>So the final sorted table will look like this:</p>\n\n<p>MyTable</p>\n\n<pre><code>Plan    Item    Sort_Number\n-------------------------------------\n11018   PS13-2      1\n11018   PS3169      2\n11018   PSHH278B    3\n11026   ZSC1753A    1\n11026   ZSC1753B    2\n11026   ZSC1753C    3\n11026   ZSC1753D    4\n11026   ZSO1753A    5\n11027   ZSC1754A    1\n11027   ZSC1754B    2\n</code></pre>\n\n<p>Can I do this with SQL? In an MS Access Database.</p>\n\n<p>Thanks  in Advance</p>\n"},{"tags":["php","mysql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12530351,"title":"Display the date of creation of a row in mysql","body":"<p>I added a new row to my users' table to show the date of creation of each user.\nI tried both timestamp and datetime types for that but it still displays me 0000-00-00 00:00:00 next to each user.</p>\n\n<p>here's my code for adding the rows to the users's table </p>\n\n<pre><code>$first_name = trim($_REQUEST['first_name']);\n$last_name = trim($_REQUEST['last_name']);\n$username = trim($_REQUEST['username']);\n$password = trim($_REQUEST['password']);\n$email = trim($_REQUEST['email']);\n$created = strftime(\"%Y-%m-%d %H:%M:%S\", time());\n$insert_sql = sprintf(\"INSERT INTO users (first_name, last_name, username, password, email, created)\" .\n\"VALUES('%s', '%s', '%s', '%s', '%s', '%s');\",\nmysql_real_escape_string($first_name),\nmysql_real_escape_string($last_name),\nmysql_real_escape_string($username),\nmysql_real_escape_string(crypt($password, $username)),\nmysql_real_escape_string($email),\nmysql_real_escape_string($created));\nmysql_query($insert_sql) or die(mysql_error());\n</code></pre>\n\n<p>And here's the code that displays the informations</p>\n\n<pre><code>$select_users = \"SELECT * FROM users\";\n$result =  mysql_query($select_users);\nwhile ($user = mysql_fetch_array($result)) {\n$user_row = sprintf(\n\"&lt;td&gt;&lt;input type='checkbox' name='checkbox[]' id='checkbox[]' value='%d'/&gt;&lt;/td&gt;\" .\n\"&lt;td&gt;%s %s&lt;/td&gt; \" .\n\"&lt;td&gt;%s&lt;/td&gt;\" .\n\"&lt;td&gt;&lt;a href='mailto:%s'&gt;%s&lt;/a&gt;&lt;/td&gt; \" .\n\"&lt;td&gt;%s&lt;/td&gt;\" .\n\"&lt;td&gt;&lt;a href='javascript:delete_user(%d);'&gt;&lt;img class='delete_user' src='images/trash.png' alt='' title='' border='0' /&gt;&lt;/a&gt;&lt;/td&gt;\",\n$user['user_id'], $user['first_name'], $user['last_name'], $user[username],\n$user['email'], $user['email'], $user['created'], $user['user_id']);\necho $user_row;\n</code></pre>\n\n<p>I got all the fields displayed correctly except for the creation date which shows 0000-00-00 00:00:00 .\nI don't know what I did wrong.\nThank you for the help.</p>\n\n<p>EDIT : I already have a field called \"updated\" which uses \"Current_timestamp\".</p>\n"},{"tags":["mysql","performance","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":6902636,"title":"Performant check for existence of values","body":"<p>I have a little performance problem with an MySQL-Query and don't know how to build it right, so it does work with as little as possible effort.</p>\n\n<p>Problem:</p>\n\n<p>Imagine a table with two columns: user(int), item(int)</p>\n\n<p>The users have different items associated with. Maybe user-1 has item-1, item-2, item-3 and user-2 has item-1, item-3, item-4.</p>\n\n<p>What I want to know is for a specific user-X and each item in seperate if at least one other user has this items also.</p>\n\n<p>What I started with was</p>\n\n<pre><code>SELECT item\nFROM table\nWHERE item IN (SELECT item FROM table WHERE user = X) AND user != X\nGROUP BY item\n</code></pre>\n\n<p>... but this was inefficient because in this case the query searchs through the whole table and checks for each item even then if each one was already found.\nI can't LIMIT the query because I don't know how many items user-X actually has.\nAnd sending a search query with LIMTI 1 for each item individually is also not such a good idea.</p>\n\n<p>For abstraction you can also say I want to know if a set of item-X, ..., item-Y (not order or continous numbering) are associated with at least one user.</p>\n\n<p>I don't care for how often the item is around at all, just want to know if at least once.</p>\n\n<p>So, how can this be done right?\nThanks for any suggestions!</p>\n"},{"tags":["oracle","query","date-arithmetic"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1568,"score":3,"question_id":6926923,"title":"How to get a list of months between 2 given dates using a query?","body":"<p>I have 2 dates, say 28-Mar-2011 and 29-Jun-2011. I need an sql query that will display the months between these 2 dates including the months containing the dates, ie. June, May, April and March.</p>\n"},{"tags":["mysql","query","loops"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12531775,"title":"mysql query with subquery loop?","body":"<p>I have a query</p>\n\n<pre><code>SELECT \n  count(product) as amount,\n  product, \n  sum(price) AS price \nFROM `products` \nWHERE \n  brid = 'broker' \nAND \n  cancelled is null \nGROUP BY product \nWITH ROLLUP\n</code></pre>\n\n<p>Is it possible to query a table to get a brokers id and then for each broker run the query above written as 1 query?</p>\n\n<p>Almost like:</p>\n\n<pre><code>SELECT brid FROM membership\nTHEN\n\nSELECT \n  count(product) as amount,\n  product, \n  sum(price) AS price \nFROM `products` \nWHERE \n  brid = membership.brid \nAND \n  cancelled is null \nGROUP BY product \nWITH ROLLUP\n\nTHEN\nSELECT NEXT brid\n</code></pre>\n\n<p>Is this possible? i know how to do it in PHP but i would prefer 1 query that can create an array rather than tons of queries for each.</p>\n\n<p>Thanks\nAdam.</p>\n"},{"tags":["query","grails","gorm","dry"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":12531433,"title":"What is the safest most maintainable practice for working with queries in Grails?","body":"<p>I am new to Grails. I have noticed that most tutorials show queries being created and stored in the Controller. It seems like this could really bloat the controller over time, especially as queries grow in greater number and complexity.</p>\n\n<p>In my research, I read that controllers should stay as lean as possible (having to do with requesting and submitting data to/from the model/view, and that heavy querying is discouraged.</p>\n\n<p>How have you gone about creating, storing, and calling queries for your Grails application?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":10,"favorite_count":5,"up_vote_count":14,"down_vote_count":0,"view_count":18096,"score":14,"question_id":3930338,"title":"SQL Server: Get table primary key using sql query","body":"<p>I want to get a particular table's primary key using SQL query for <strong>SQL Server</strong> database.</p>\n\n<p>In <strong>MySQL</strong> I am using following query to get table primary key:</p>\n\n<pre><code>SHOW KEYS FROM tablename WHERE Key_name = 'PRIMARY'\n</code></pre>\n\n<p>What is equivalent of above query for <strong>SQL Server</strong> ?.</p>\n\n<p>If There is a query that will work for both <strong>MySQL</strong> and <strong>SQL Server</strong> then It will be an ideal case.</p>\n\n<p>Thanks </p>\n"},{"tags":["mysql","query","timeout"],"answer_count":6,"favorite_count":10,"up_vote_count":17,"down_vote_count":0,"view_count":19501,"score":17,"question_id":2137084,"title":"Setup MySQL query timeout","body":"<p>Hey guys, it's possible to timeout query in MySQL?\nSo if any query will exceed this timeout, it will be killed by MySQL and it will return error instead of waiting for eternity.</p>\n"},{"tags":["sql","ruby-on-rails","query","optimization","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12508424,"title":"Rails SQL query optimization","body":"<p>I have a featured section in my website that contains featured posts of three types: normal, big and small. Currently I am fetching the three types in three separate queries like so:</p>\n\n<pre><code>@featured_big_first = Post.visible.where(pinged: 1).where('overlay_type =?', :big).limit(1)\n@featured_big_first = Post.visible.where(pinged: 1).where('overlay_type =?', :small).limit(1)\n@featured_big_first = Post.visible.where(pinged: 1).where('overlay_type =?', :normal).limit(5)\n</code></pre>\n\n<p>Basically I am looking for a query that will combine those three in to one and fetch 1 big, 1 small, 5 normal posts.</p>\n"},{"tags":["mysql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":12529468,"title":"Finding the difference in days between different entries with same ticket","body":"<p>I have the following table:</p>\n\n<pre><code>ticket    arrivaltime        resolution time    status\n\nt1        '2012-09-03'        null               new\nt2        '2012-09-04'        null               new\nt1        (can be anything)   '2012-09-14'       verified    \nt1        (can be anything)   '2012-09-16'       verified\nt2        (can be anything)   '2012-09-06'       verified\n</code></pre>\n\n<p>Now I want to find, for example, for t1 the difference in days:</p>\n\n<pre><code>Age(t1)=(resolution time of last entry) - (arrival time of first entry)\n</code></pre>\n\n<p>Similarly I'll find it for t2.</p>\n\n<p>How can I find this?</p>\n"},{"tags":["java","query","hibernate","hql","named-query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12521431,"title":"Named Query parameter in hour interval","body":"<p>I'm currently having trouble to execute this query using HQL.</p>\n\n<pre><code>String queryString = \"SELECT o FROM Orders o WHERE o.orderMade &gt;= DATE_SUB(NOW(), INTERVAL :fetchTime HOUR)\";\n</code></pre>\n\n<p>this will fetch the last orders from the last \":fetchTime\" hours.</p>\n\n<p>The problem is, how to set this parameter using HQL ?</p>\n\n<p>I tryed</p>\n\n<pre><code>.em.createQuery(queryString).setParameter(\"fetchTime\", fetchTime).getResultList();\n</code></pre>\n\n<p>but it results in a hibernate error.</p>\n\n<p>I also tryed to use \"?\" instead a named parameter, but without success.</p>\n\n<p>Even writing a number into the queryString and not setting any parameters, I still getting this error:</p>\n\n<pre><code>unexpected token: 6\n</code></pre>\n\n<p>I know this is referred to the number 6 I've used instead the fetchTime.</p>\n\n<p>The only way I got this working was by using this as a NativeQuery, but this one returns a list of detached Objects and I really wanted to use a NamedQuery.</p>\n\n<p>Thank you for your time!</p>\n"},{"tags":["query","select","sap","abap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":12527176,"title":"Not getting data with right conditions?","body":"<p>In select statement i gave right conditions but not getting data back.</p>\n\n<p>When i try from se16n with these conditions it turns me one row but when i try in a program with select statement it turns me empty internal table. Here is the sample code.</p>\n\n<p>gt_tcurr is an internal table that contains kurst fcurr tcurr gdatu ukurs components.</p>\n\n<pre><code>SELECT kurst fcurr tcurr gdatu ukurs\n    INTO TABLE gt_tcurr\n    FROM tcurr\n    WHERE kurst = p_kurst    \" as M\n      AND gdatu = p_budat    \" as 21.09.2011\n      AND fcurr = p_waers    \" as EUR\n      AND tcurr = lv_waers.  \" as TRY\n</code></pre>\n\n<p>as i said; with these conditions se16n->tcurr table turns me one row, but select statement turns me an empty row. Does anyone has any idea? </p>\n"},{"tags":["sql","database","query","sqlanywhere"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12530029,"title":"Why Temporally Rotate Database Tables?","body":"<p>I'm working with the back-end database to a 3rd party system at the moment (SQL Anywhere), and need to start querying data from their system and storing it in a more sane repository. The problem is, that the system stores regular time-based data (actually bandwidth statistics), of varying resolution (seconds, minutes, hours, etc) with some sort of bespoke compression mechanism, so that after x minutes the second data will be compressed into minute data etc... fine. The problem arises in that data is being inserted for each resolution into a seemingly random set of tables. To illustrate, the storage data for customer's bandwidth at the second resolution is stored in one or more of 400 tables running from STAT_SEC_1 to STAT_SEC399. A Stored Procedure is provided to allow you to ask for data for a specific customer at a specific time and resolution, it will return a list of tables containing that data. </p>\n\n<p>I'm trying to come up with an effective way to extract ALL the second-resolution data as it arrives, so in order to cut through the random way it is stored, I'm trying to undestand the rationale behind it. No-one I've spoken to in the dev team here has come across this before, can any of you see the benefits of storing data this way?</p>\n"},{"tags":["java","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12529462,"title":"Java query find only the first entry","body":"<p>If I try the following query in Java, Java returns without any error only the first entry of the table. But if I copy the same query to Access, Access returns all 33 entries.</p>\n\n<p>Query:</p>\n\n<p><code>SELECT Country, Sum(SumOfNumber) AS number FROM CountryList WHERE Year=2012 AND (Month=1 Or Month=2 Or Month=3) AND Entity='xxx' GROUP BY Country ORDER BY Sum(SumOfNumber) DESC\n</code></p>\n\n<pre><code>rs.last();\nSystem.out.println(rs.getRow());\n</code></pre>\n\n<p>returns 1.</p>\n\n<p>Any advice?</p>\n\n<p>Okay guys, now I deleted therm \"ORDER BY Sum(SumOfNumber) DESC\" and Java returned all Countries and throwed an exception at the end \"invalid cursor status\"</p>\n\n<pre><code>public void doconnect(){\n    try{\n        Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\").newInstance();\n        conn = DriverManager.getConnection(ConnectURL,user,pw);\n        Statement stmt = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n\n\n        String query = \"SELECT Country, Sum(SumOfNumbers) AS number FROM CountryList WHERE Year=2012 AND (Month=1 Or Month=2 Or Month=3) AND Entity='xxx' GROUP BY Country ORDER BY Sum(SumOfNumbers) DESC\";\n        System.out.println(query);\n        ResultSet rs = stmt.executeQuery(query);\n\n        while(rs.next()){\n            System.out.println(rs.getString(\"Country\"));\n        }\n        rs.close();\n\n    }\n    catch(Exception e){\n        System.err.println(e);\n        e.printStackTrace();\n    }\n    finally{\n        if(conn!=null){\n            try{\n                conn.close();\n\n            }\n            catch(Exception e){\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["sql","query","auto-increment"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":12529873,"title":"How should I declare auto increment variable in the virtual table of stored procedure","body":"<p>I have a stored procedure like this</p>\n\n<pre><code>create procedure onedata\n\nas\n\nbegin\n\ndeclare @input_data table (Id int NOT NULL AUTO_INCREMENT, name varchar(500) . .... )\n\ninsert into @input_data .....\n....\n\nend\n</code></pre>\n\n<p>But i am not able to declare Id to be <strong>AUTO_INCREMENT</strong>.It showing some error.<br>Please suggest some solution.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["arrays","json","query","limit","jsonpath"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12529133,"title":"JSON Array limit ¿sixty objects?","body":"<p>I'm working with Twitter API and i have checked that json doesn't recognize arrays of more than sixty members.</p>\n\n<p>I have check this issue with this tool: <a href=\"http://jsonpath.curiousconcept.com/\" rel=\"nofollow\">http://jsonpath.curiousconcept.com/</a></p>\n\n<p>If i put sixty objects in the array, it stops parsing the json, for example if you query $..results[*] (although it's valid). Any clues about this issue?</p>\n\n<p>The json with only one object in the array</p>\n\n<pre><code>{\"completed_in\":0.138,\"max_id\":249066208408788992,\"max_id_str\":\"249066208408788992\",\"next_page\":\"?page=2&amp;max_id=249066208408788992&amp;q=bezoya%20OR%20lanjar%EF%BF%BD&amp;lang=es&amp;rpp=100\",\"page\":1,\"query\":\"bezoya+OR+lanjar%EF%BF%BD\",\"refresh_url\":\"?since_id=249066208408788992&amp;q=bezoya%20OR%20lanjar%EF%BF%BD&amp;lang=es\",\"results\":[{\"created_at\":\"Wed, 19 Sep 2012 14:58:39 +0000\",\"from_user\":\"villarroya093\",\"from_user_id\":781564459,\"from_user_id_str\":\"781564459\",\"from_user_name\":\"Javier Villarroya\",\"geo\":null,\"id\":248435942728290304,\"id_str\":\"248435942728290304\",\"iso_language_code\":\"es\",\"metadata\":{\"result_type\":\"recent\"},\"profile_image_url\":\"http:\\/\\/a0.twimg.com\\/profile_images\\/2550477368\\/IMG-20120824-WA002_normal.png\",\"profile_image_url_https\":\"https:\\/\\/si0.twimg.com\\/profile_images\\/2550477368\\/IMG-20120824-WA002_normal.png\",\"source\":\"&amp;lt;a href=&amp;quot;http:\\/\\/blackberry.com\\/twitter&amp;quot;&amp;gt;Twitter for BlackBerry\\u00ae&amp;lt;\\/a&amp;gt;\",\"text\":\"RT @Xarlyfrasno: @villarroya093 #villarroyarules\\nBeba agua mineral Bezoya, entra por la boca y sale..... muy bien de precio.\",\"to_user\":null,\"to_user_id\":0,\"to_user_id_str\":\"0\",\"to_user_name\":null}],\"results_per_page\":100,\"since_id\":0,\"since_id_str\":\"0\"}\n</code></pre>\n"},{"tags":["php","forms","query","doctrine","symfony-1.4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12509567,"title":"How to extend a query that is generating backend-form-field in Symfony 1.4?","body":"<p>I want to filter the options of a select-box in a SF-1.4 backend-module according to the logged-in user.\nWhere is the right place to modify/extend the SQL-query, that is creating the SELECT-Box?</p>\n"},{"tags":["string","query",".htaccess","edit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12527454,"title":".htaccess - drop/edit/remove query string parameter/flag","body":"<p>I'm trying to turn this:</p>\n\n<blockquote>\n  <p>/index.php?param1=1&amp;param2=1&amp;param3=1</p>\n</blockquote>\n\n<p>into this:</p>\n\n<blockquote>\n  <p>/index.php?param1=1&amp;param3=1</p>\n</blockquote>\n\n<p>I would have thought this would work:</p>\n\n<pre><code>RewriteCond %{QUERY_STRING} param2 [NC]\nRewriteRule ^index.php?(.*)param2=([0-9]+)(.*)$ index\\.php\\?$1&amp;$3 [R=301,QSA,L]\n</code></pre>\n\n<p>...but it and other variations are doing sod all :(</p>\n\n<p>any ideas?</p>\n"},{"tags":["android","database","query","cursor","max"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12498906,"title":"Failing to query the max number in database","body":"<p>I am trying to find the max number in a column of one of the tables in my database.</p>\n\n<p>I thought I had this one sorted (I posted similar question previously), however after some testing I have realised my code isn't working as I thought.</p>\n\n<p>The database consists of a table with the following columns:</p>\n\n<p>_id, inspection_link, area_number, area_reference</p>\n\n<p>I have created the following code in my database helper class:</p>\n\n<pre><code>public static final String AREAS_TABLE = \"areas\";\npublic static final String AREA_ID = \"_id\";\npublic static final String AREA_NUMBER = \"area_number\";\npublic static final String AREA_REF = \"area_reference\";\npublic static final String AREA_LINK = \"area_link\";\npublic static final String INSPECTION_LINK = \"inspection_link\";\n\npublic Cursor selectMaxAreaNumber (long inspectionId) {\n    String inspectionIdString = String.valueOf(inspectionId);\n    String[] tableColumns = new String[] { \n            AREA_NUMBER, \n            \"(SELECT max(\" + AREA_NUMBER + \") FROM \" + AREAS_TABLE + \") AS max\" \n        }; \n    String whereClause = INSPECTION_LINK + \" = ?\";\n    String[] whereArgs = new String[] {\n            inspectionIdString          \n        };\n    Cursor c = rmDb.query(AREAS_TABLE, tableColumns, whereClause, whereArgs, \n            null, null, null);\n\n\n    if (c != null) {\n        c.moveToFirst();\n    }\n    c.close();\n    return c;\n}\n</code></pre>\n\n<p>Then in the activity where I want to query the database I have written the following:</p>\n\n<pre><code>public class AreaEdit extends Activity {\n\nprivate EditText AreaNumber;\nprivate EditText AreaReference;\nprivate Button saveButton;\nprivate Button cancelButton;\nprotected boolean changesMade;\nprivate AlertDialog unsavedChangesDialog;\n\n\nprivate RMDbAdapter rmDbHelper;\nprivate long inspectionId;\nprivate long areaId;\nprivate int nextAreaNumber = 0;\n\n@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    rmDbHelper = new RMDbAdapter(this);\n    rmDbHelper.open();\n    Intent i = getIntent();\n    inspectionId = i.getLongExtra(\"Intent_InspectionID\", -1);\n    areaId = i.getLongExtra(\"Intent_AreaID\", -1);\n    if (areaId == -1) {\n        Cursor c = rmDbHelper.selectMaxAreaNumber(inspectionId);\n        startManagingCursor(c);\n        c.moveToFirst();\n        nextAreaNumber = c.getInt(c.getColumnIndex(\"max\")) + 1; \n    }\n    setContentView(R.layout.edit_area);\n    setUpViews();\n    populateFields();\n    setTextChangedListeners();\n}\n\nprivate void setUpViews() {\n    AreaNumber =(EditText)findViewById(R.id.area_number);\n    AreaReference =(EditText)findViewById(R.id.area_reference);\n    saveButton = (Button)findViewById(R.id.area_save_button);\n    cancelButton = (Button)findViewById(R.id.area_cancel_button);\n\n\n}\n\n  private void populateFields() {\n        if (areaId &gt; 0) {\n            Cursor c = rmDbHelper.fetchArea(areaId);\n            startManagingCursor(c);\n            c.moveToFirst();\n            AreaNumber.setText(c.getString(\n                    c.getColumnIndexOrThrow(RMDbAdapter.AREA_NUMBER)));\n            AreaReference.setText(c.getString(\n                    c.getColumnIndexOrThrow(RMDbAdapter.AREA_REF)));\n            c.close();\n        }\n        else {\n            AreaNumber.setText(String.valueOf(nextAreaNumber));\n        }\n    }\n</code></pre>\n\n<p>However, when it returns the wrong number - it seems to pick up the maximum number from the whole table which includes data from other inspections.</p>\n\n<p>I guess this may be down to the conversion between Strings and Longs etc maybe, but I have a brickwall with this?  </p>\n\n<p>Any help much appreciated.</p>\n"},{"tags":["sql","query","parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12525664,"title":"SQL Syntax in MS Access Form","body":"<p>I have a problem of SQL syntax which I have been struggling for days.</p>\n\n<p>I have created an MS Access 2010 Form called <code>IP Country Form</code> into which I want to insert into a TextBox called <code>Country</code> the Country obtained from the following query which queries a table called <code>IPLocation</code> which contains the Countries according to IP Numbers with the fields:</p>\n\n<pre><code>IPNS IPNE CY2(2 letter Country Code) CY3(3 Letter country Code) Country (full Country Name)\n</code></pre>\n\n<p>The table rows looks like this:</p>\n\n<pre><code>IPNS     | IPNE     | CY2 | CY3 | COUNTRY\n19791872 | 19922943 | TH  | THA | THAILAND\n</code></pre>\n\n<p>The form calculates the IP Number from the IP address and places it in a TextBox called <code>IPNumber</code>, which I then use in an SQL Query to obtained the Country which corresponds to it.</p>\n\n<p>My current query is:</p>\n\n<pre><code>SELECT IPLocation.IPNS, IPLocation.IPNE, IPLocation.CY2, IPLocationCY3, IP.Location.Country \n  FROM IPLocation \n WHERE (((IPLocation.IPNS)&lt;\" &amp; [Forms]![IP Country Form]![IPNumber]) \n   And ((IPLocation.IPNE) &gt; \" &amp; [Forms]![IP Country Form]![IPNumber]))\n</code></pre>\n\n<p>IPNS, IPNE are Numbers as is IPNumber</p>\n\n<p>Essentially the query is designed to find the Country where the IPNumber lies between IPNS and IPNE.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>A test query I use:</p>\n\n<pre><code>Set rst = dbs.OpenRecordset(\"\n                 SELECT IPLocation.IPNS, IPLocation.IPNE, IPLocation.CY2, IPLocation.CY3,\n                        IPLocation.Country \n                   FROM IPLocation \n                  WHERE (((IPLocation.IPNS)&gt;19791871) \n                    AND ((IPLocation.IPNE)&lt;19922944))\n           \")\n</code></pre>\n\n<p>Works fine and returns the correct country</p>\n"},{"tags":["sql","query","rowcount"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12526225,"title":"How to get the first row details using rowcount?","body":"<p>I have a temp variable called @rows having nearly 10000 records in a stored procedure like this</p>\n\n<pre><code>Create Procedure input\nas\nbegin\ndeclare @input_data table(......)\ninsert into (.....) from ....\n@rows= select @@rowcount\nwhile(@rows &gt; o)\nbegin\n--- I need to process each row like\nselect ... where @row=1 --like this repeatedly upto @rows = 10000\nend\n</code></pre>\n\n<p>How should I achieve this.Please help me\nThanks in advance</p>\n"},{"tags":["sql","query","azure","unique"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12524931,"title":"How to create two or more Unique Columns in SQL Azure?","body":"<p>I want to select two columns in my table and make them <code>unique</code> but I don't know how to do it in SQL Azure database. As you can see in the image below, it doesn't show any option to modify the table properties, so everything is done using sql queries:<br>\n<img src=\"http://i.stack.imgur.com/Rk9TO.png\" alt=\"enter image description here\">  </p>\n\n<p>Here is the generated script of the table:  </p>\n\n<pre><code>USE [mydbase]\nGO\n\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE TABLE [dbo].[clientaccess](\n    [ID] [bigint] IDENTITY(1,1) NOT NULL,\n    [ModuleName] [nvarchar](50) NOT NULL,\n    [ClientAuthenticationId] [bigint] NOT NULL,\n    [HasAccess] [bit] NOT NULL,\n CONSTRAINT [PK_clientaccess_ID] PRIMARY KEY CLUSTERED \n(\n    [ID] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON)\n)\n\nGO\n\nALTER TABLE [dbo].[clientaccess]  WITH CHECK ADD  CONSTRAINT [CAI_caID] FOREIGN KEY([ClientAuthenticationId])\nREFERENCES [dbo].[clientauthentication] ([ID])\nGO\n\nALTER TABLE [dbo].[clientaccess] CHECK CONSTRAINT [CAI_caID]\nGO  \n</code></pre>\n\n<p>This is the preview where I encountered the problem, it contains duplicate records:<br>\n<img src=\"http://i.stack.imgur.com/a8ud6.png\" alt=\"enter image description here\">  </p>\n\n<p>Hope someone understand my explanation.</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":46,"score":5,"question_id":12521582,"title":"MySQL query not returning all records","body":"<p>I have a few tables in my database and am using left outer joins to join the tables and perform a query. The problem is that, not all of the matching records are returned, the first one always gets skipped out from the results for some reason.</p>\n\n<p>Here's the link to the <a href=\"http://sqlfiddle.com/#!2/7da28/1\" rel=\"nofollow\">SQL Fiddle</a>,</p>\n\n<p><em>Schema + Test data:</em></p>\n\n<pre><code>mysql&gt; select * from main;\n+----------+------------+----------------+---------------+-------------+-------------+----------------+----------------+-----------------+------------+------------+----------------+-----------------+---------------+--------------------------+--------------+\n| username | date       | water_quantity | water_chilled | smoked_what | smoke_count | sleep_duration | study_duration | screen_duration | loud_level | heat_level | humidity_level | stress_physical | stress_mental | stress_notes             | menstruation |\n+----------+------------+----------------+---------------+-------------+-------------+----------------+----------------+-----------------+------------+------------+----------------+-----------------+---------------+--------------------------+--------------+\n| test123  | 2012-09-16 |              1 | no            | cigarettes  |          20 |            480 |              0 |             420 |          2 |          7 |              7 |               6 |             4 | Roamed a lot on the bike | no           |\n| test123  | 2012-09-13 |              2 | no            | cigarettes  |          12 |            300 |              0 |               0 |          1 |          1 |              1 |               6 |             3 | met friends              | no           |\n+----------+------------+----------------+---------------+-------------+-------------+----------------+----------------+-----------------+------------+------------+----------------+-----------------+---------------+--------------------------+--------------+\n2 rows in set (0.00 sec)\n\nmysql&gt; select * from food;\n+----------+------------+--------------+\n| username | date       | food         |\n+----------+------------+--------------+\n| test123  | 2012-09-16 | rice         |\n| test123  | 2012-09-16 | pizza        |\n| test123  | 2012-09-16 | french fries |\n| test123  | 2012-09-16 | burger       |\n| test123  | 2012-09-13 | naan         |\n| test123  | 2012-09-13 | fried rice   |\n| test123  | 2012-09-13 | lemon juice  |\n+----------+------------+--------------+\n7 rows in set (0.00 sec)\n\nmysql&gt; select * from alcohol;\n+----------+------------+--------------+------------------+\n| username | date       | alcohol_type | alcohol_quantity |\n+----------+------------+--------------+------------------+\n| test123  | 2012-09-16 | beer         |                0 |\n| test123  | 2012-09-16 | beer_ale     |                0 |\n| test123  | 2012-09-16 | absinthe     |                0 |\n| test123  | 2012-09-13 | rum          |                0 |\n| test123  | 2012-09-13 | tequila      |                0 |\n+----------+------------+--------------+------------------+\n5 rows in set (0.00 sec)\n\nmysql&gt; select * from headache;\n+----------+------------+-----------+----------+---------------------+\n| username | date       | intensity | duration | notes               |\n+----------+------------+-----------+----------+---------------------+\n| test123  | 2012-09-16 |         6 |       12 | something something |\n+----------+------------+-----------+----------+---------------------+\n1 row in set (0.00 sec)\n\nmysql&gt; select * from headache_areas;\n+----------+------------+-----------------+\n| username | date       | area            |\n+----------+------------+-----------------+\n| test123  | 2012-09-16 | left_temple     |\n| test123  | 2012-09-16 | right_temple    |\n| test123  | 2012-09-16 | behind_left_ear |\n+----------+------------+-----------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; select * from headache_symptoms;\n+----------+------------+-----------+\n| username | date       | symptoms  |\n+----------+------------+-----------+\n| test123  | 2012-09-16 | aura      |\n| test123  | 2012-09-16 | vertigo   |\n| test123  | 2012-09-16 | dizziness |\n+----------+------------+-----------+\n3 rows in set (0.00 sec)\n\nmysql&gt; select * from alcohol;\n+----------+------------+--------------+------------------+\n| username | date       | alcohol_type | alcohol_quantity |\n+----------+------------+--------------+------------------+\n| test123  | 2012-09-16 | beer         |                0 |\n| test123  | 2012-09-16 | beer_ale     |                0 |\n| test123  | 2012-09-16 | absinthe     |                0 |\n| test123  | 2012-09-13 | rum          |                0 |\n| test123  | 2012-09-13 | tequila      |                0 |\n+----------+------------+--------------+------------------+\n5 rows in set (0.00 sec)\n\nmysql&gt; select * from drugs;\n+----------+------------+----------+\n| username | date       | drug     |\n+----------+------------+----------+\n| test     | 2012-08-21 | crocin   |\n| test     | 2012-08-21 | azithral |\n| test     | 2012-08-21 | crocin   |\n| test     | 2012-08-21 | azithral |\n| test     | 2012-08-21 | crocin   |\n| test     | 2012-08-21 | azithral |\n| test123  | 2012-09-13 | ching    |\n| test123  | 2012-09-13 | chong    |\n| test123  | 2012-09-13 | blah1    |\n| test123  | 2012-09-13 | blurg2   |\n+----------+------------+----------+\n10 rows in set (0.00 sec)\n</code></pre>\n\n<p><em>Query I tried with the result:</em></p>\n\n<pre><code>mysql&gt; SELECT m.*,\n    -&gt;                 GROUP_CONCAT(DISTINCT f.food SEPARATOR ',') AS food, \n    -&gt;                 GROUP_CONCAT(DISTINCT a.alcohol_type SEPARATOR ',') AS alcohol,\n    -&gt;                 a.alcohol_quantity,\n    -&gt;                 GROUP_CONCAT(DISTINCT d.drug SEPARATOR ',') AS drug,\n    -&gt;                 h.intensity AS headache_intensity,\n    -&gt;                 h.duration AS headache_duration,\n    -&gt;                 GROUP_CONCAT(DISTINCT ha.area) AS headache_areas,\n    -&gt;                 GROUP_CONCAT(DISTINCT hs.symptoms) AS headache_symptoms,\n    -&gt;                 h.notes AS headache_notes\n    -&gt;             FROM main AS m \n    -&gt;                 LEFT OUTER JOIN food AS f ON f.username = m.username AND f.date = m.date \n    -&gt;                 LEFT OUTER JOIN headache AS h ON h.username = m.username AND h.date = m.date\n    -&gt;                 LEFT OUTER JOIN headache_symptoms AS hs ON hs.username = m.username AND hs.date = m.date\n    -&gt;                 LEFT OUTER JOIN headache_areas AS ha ON ha.username = m.username AND ha.date = m.date\n    -&gt;                 LEFT OUTER JOIN drugs AS d ON d.username = m.username AND d.date = m.date\n    -&gt;                 LEFT OUTER JOIN alcohol AS a ON a.username = m.username AND a.date = m.date\n    -&gt;            ;\n+----------+------------+----------------+---------------+-------------+-------------+----------------+----------------+-----------------+------------+------------+----------------+-----------------+---------------+--------------------------+--------------+------------------------------------------------------------+------------------------------------+------------------+--------------------------+--------------------+-------------------+------------------------------------------+------------------------+---------------------+\n| username | date       | water_quantity | water_chilled | smoked_what | smoke_count | sleep_duration | study_duration | screen_duration | loud_level | heat_level | humidity_level | stress_physical | stress_mental | stress_notes             | menstruation | food                                                       | alcohol                            | alcohol_quantity | drug                     | headache_intensity | headache_duration | headache_areas                           | headache_symptoms      | headache_notes      |\n+----------+------------+----------------+---------------+-------------+-------------+----------------+----------------+-----------------+------------+------------+----------------+-----------------+---------------+--------------------------+--------------+------------------------------------------------------------+------------------------------------+------------------+--------------------------+--------------------+-------------------+------------------------------------------+------------------------+---------------------+\n| test123  | 2012-09-16 |              1 | no            | cigarettes  |          20 |            480 |              0 |             420 |          2 |          7 |              7 |               6 |             4 | Roamed a lot on the bike | no           | rice,pizza,french fries,burger,naan,fried rice,lemon juice | beer,beer_ale,absinthe,rum,tequila |                0 | ching,chong,blah1,blurg2 |                  6 |                12 | left_temple,right_temple,behind_left_ear | aura,vertigo,dizziness | something something |\n+----------+------------+----------------+---------------+-------------+-------------+----------------+----------------+-----------------+------------+------------+----------------+-----------------+---------------+--------------------------+--------------+------------------------------------------------------------+------------------------------------+------------------+--------------------------+--------------------+-------------------+------------------------------------------+------------------------+---------------------+\n1 row in set (0.00 sec)\n</code></pre>\n\n<p>It doesn't show me the other record in the table. Could someone please help me out with this? Thanks in advance.</p>\n"},{"tags":["query","peoplesoft"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":11940179,"title":"Selecting the most recent date from a table in PeopleSoft using Peoplesoft Query (Max() doesn't work)","body":"<p>I am building a query in people soft using Peoplesoft query manager.  </p>\n\n<p>I am trying to pull the most recent date from the date column. I have tried using max() as an expression, however, the query doesn't pull any records. \nI have checked with another co-worker and they have never been able to pull records using max(). </p>\n\n<p>Is there any other way or workaround to pull the most recent record?</p>\n"},{"tags":["sql-server","query","select","ado.net"],"answer_count":9,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":228,"score":3,"question_id":7107033,"title":"select * only return one value","body":"<p>I want select multiple (all) values from table Account. </p>\n\n<pre><code>string query = \"SELECT * FROM Account\";\n        SqlConnection connection = new SqlConnection(connectionString);\n        SqlCommand command = new SqlCommand(query, connection);\n        SqlDataReader reader;\n        connection.Open();\n        reader = command.ExecuteReader();\n        reader.Read();\n        label1.Text = reader[\"PasswordHash\"].ToString();\n        connection.Close();\n</code></pre>\n\n<p>Why is this always returning only the first row. Actually it return one row, because if I set in where clause something like <code>where id = 2 and id = 3</code> it still returns only one value.\nTable have more than one value i checked form Management Studio, there query run as they should.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["query","import","hbase","sqoop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12443142,"title":"How to modify query content in sqoop import?","body":"<p>Sorry for my poor English...</p>\n\n<p>Here is my problem. I have to import data from MySQL to HBase. In order to improve performance a big table is divided into some small tables in MySQL. For example, a 'message' table is divided into 'message_0', 'message_1', ... 'message_100'.</p>\n\n<p>I need to import those message tables into a single table (such as 'message') in HBase. The PK in each table is message_id and it is auto-increment. As we know, HBase has a unique row key. I want to add a prefix to the message_id column. </p>\n\n<p>I can't add a hbase-row-key column in those tables so that I want to modify the column content in sqoop query argument. I used the import command looks like below:</p>\n\n<pre><code>sqoop import --connect jdbc:mysql://host:port/message \n--username message --password message \\\n--query \"select 't0_'+ message_id as message_key, some_split_id, some_other_columns\\\nfrom message_0 where message_id &gt;30000 and message_id &lt;= 31000 and \\$CONDITIONS\" \n--split-by some_split_id --hbase-row-key message_key \n--hbase-table message --column-family cf1\n</code></pre>\n\n<p>I can successfully map the column alias <code>message_key</code> as the HBase row key. But row key is 30001.0 which is expected as 't0_30001'.</p>\n\n<p>It seems that the query didn't return the expect value of 't0_' + message_id but directly the message_id.</p>\n\n<p>I also tried to modify the sqoop-generated java source to add 't0_' to message_id, then specify the compiled class to perform input action, but it dose not work neither.</p>\n\n<p>Looks like this</p>\n\n<p>java source:</p>\n\n<pre><code>public void set_message_key(String message_key) {\n    this.message_key = \"t0_\" + message_key;\n}\npublic MessageImporter with_message_key(String message_key) {\n    this.message_key = \"t0_\" + message_key;\n    return this; \n}\n...\npublic void readFields(DataInput __dataIn) throws IOException {\n    if (__dataIn.readBoolean()) { \n        this.message_key = null;\n    } else {\n        this.message_key = \"t0_\" + Text.readString(__dataIn);\n    }\n    ...\n...\n}\n...\nprivate void __loadFromFields(List&lt;String&gt; fields) {\n    Iterator&lt;String&gt; __it = fields.listIterator();\n    String __cur_str;\n    __cur_str = __it.next();\n    if (__cur_str.equals(\"null\") || __cur_str.length() == 0) { this.message_key = null; } else {\n    this.message_key = \"t0_\" + __cur_str;\n    }\n    ...\n}\n...\npublic void setField(String __fieldName, Object __fieldVal) {\n    if (\"message_key\".equals(__fieldName)) {\n        this.message_key = \"t0_\" + (String) __fieldVal;\n    }\n    ...\n}\n</code></pre>\n\n<p>command line(add arguments below):</p>\n\n<pre><code>--jar-file someJar.jar --class-name com.foo.SomeImportClass \\\n</code></pre>\n\n<p>Is it possible to modify the column content in the --query argument? Do I have to write mapred jobs myself to import data from multiple tables into one single table in HBase?</p>\n\n<p>Thank you for your patience to read this long question.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":101,"score":0,"question_id":8248582,"title":"Refactored SQL query not working correctly - not returning any rows","body":"<p>This works perfectly and returns rows ok:</p>\n\n<pre><code>$buy_array = $wpdb-&gt;get_results(\"\nSELECT * FROM deals \nWHERE deal_id IN \n    (SELECT deal_id FROM deals_location \n     WHERE location_id IN \n        (SELECT ref_id FROM location \n         WHERE name = '\" . $current . \"')) \nAND expired != 1 ORDER BY end_date ASC\");\n</code></pre>\n\n<p>The refactored query that i have created however does not work and does not return any rows.</p>\n\n<pre><code>$buy_array = $wpdb-&gt;get_results(\"\nSELECT * FROM deals \nWHERE deal_id IN \n    (SELECT deal_id FROM deals_location \n     WHERE location_id IN \n         (SELECT ref_id FROM location \n          WHERE name = '\" . $current . \"')) \nAND deal_id IN \n    (SELECT deal_id FROM deals_category \n     WHERE category_id IN \n         (SELECT id FROM category \n          WHERE name = '\" . $category . \"')) \nAND expired != 1 ORDER BY end_date ASC\");\n</code></pre>\n\n<p>Any help would be appreciated. If you have any questions please ask.</p>\n\n<p>As requested here is a rough layout of the tables used.</p>\n\n<pre><code>deals           deals_location      location\n-&gt;deal_id       -&gt;deal_id           -&gt;location_id\n                -&gt;location_id       -&gt;name\n\ndeals_category       category\n-&gt;deal_id            -&gt;category_id\n-&gt;category_id        -&gt;name\n</code></pre>\n\n<p>Those are the fields that are required for this query.</p>\n"},{"tags":["query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":12522814,"title":"Update query with one table and one view","body":"<p>I have one table inventories having field product_id, quantity_on_hand and one view update view having product_id and sum_quantity </p>\n\n<p>Now i want to modify the quantity_on_hand = quantity_on_hand+sum_quantity. </p>\n\n<p>I tried to do inner join on product_id field but it shows me and error that ORA-01779: cannot modify a column which maps to a non key-preserved table. </p>\n\n<p>can any one help me with this? How can i update the quantity_on_hand field?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":96,"score":-2,"question_id":12434423,"title":"Regarding primary key of one table to act as a foreign key in another table","body":"<p>I have two tables named EMPLOYEE and DEPARTMENT as follows:</p>\n\n<pre><code>CREATE table \"EMPLOYEE\" (\n    \"EMP_ID\"     NUMBER,\n    \"ENAME\"      VARCHAR2(4000),\n    \"SALARY\"     VARCHAR2(4000),\n    \"COMPANY\"    VARCHAR2(4000),\n    \"CONTACTNO.\" NUMBER,\n    \"GENDER\"     CHAR(100),\n    constraint  \"EMPLOYEE_PK\" primary key (\"EMP_ID\")\n)\n\nCREATE TABLE  \"DEPARTMENT\" \n(   \n    \"DEPT_ID\" NUMBER, \n    \"DEPT_NAME\" VARCHAR2(4000), \n    \"LOCATION\" VARCHAR2(4000), \n    \"CONTACTNO.\" NUMBER, \n     CONSTRAINT \"DEPARTMENT_PK\" PRIMARY KEY (\"DEPT_ID\") ENABLE\n)\n</code></pre>\n\n<p>Now I am trying to make Emp_ID of EMPLOYEE table as primary key in EMPLOYEE table itself but it should act as a foreign key for DEPT_ID in DEPARTMENT table, please advise how to achieve this!</p>\n"},{"tags":["php","mysql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":12520617,"title":"Remove same values rows over different column mysql","body":"<p>I 'm stuck on a very basic problem, I want to skip the row which has duplicate values over three columns.</p>\n\n<p>Table feeds</p>\n\n<pre><code>id,type,user_id,friend_id,date\n1, 'friend', 4 , 5 , 5/5/2010\n2, 'friend', 5 , 4 , 5/5/2010\n</code></pre>\n\n<p>Now this is how the data is saved (I can't change the saving module)</p>\n\n<p>since both have same thing, so I want to pick them only as a 1 row not 2.\nI don't want to validate and remove it at PHP end, b/c if I'll do at PHP the pagination would be disturb</p>\n\n<p>Edit:</p>\n\n<p>Table Structure</p>\n\n<pre><code>create table `feed` (\n    `id` double ,\n    `type` blob ,\n    `user_id` double ,\n    `type_id` double ,\n    `date` datetime \n); \ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('78','friends','1314','1313','2012-09-03 19:48:14');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('79','friends','1313','1314','2012-09-03 19:48:14');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('80','friends','1314','1312','2012-09-03 19:49:07');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('82','friends','1313','1312','2012-09-03 19:49:09');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('84','friends','1315','1312','2012-09-03 19:49:24');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('86','friends','1315','1313','2012-09-03 19:49:33');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('87','friends','1313','1315','2012-09-03 19:49:33');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('97','friends','1317','1312','2012-09-03 19:55:06');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('99','friends','1313','1317','2012-09-03 19:56:01');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('100','friends','1317','1313','2012-09-03 19:56:01');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('101','friends','1315','1317','2012-09-03 19:56:58');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('102','friends','1317','1315','2012-09-03 19:56:58');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('104','following','1313','1193','2012-09-03 19:59:39');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('105','following','1313','1308','2012-09-03 19:59:51');\ninsert into `feed` (`id`, `type`, `user_id`, `type_id`, `date`) values('106','following','1313','1098','2012-09-03 19:59:58');\n</code></pre>\n"},{"tags":["query","mongodb","bit-manipulation","bit-masks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12520937,"title":"Bitmask comparisons Mongo queries","body":"<p>For a Blog webapp, I am trying to model a set of users, blogs and actions on resources in mongo. Users can perform a no of actions such as 'like', 'star', 'feature' resources of a blog post such as 'blog posts' ,'links', 'images', etc. </p>\n\n<p>The model will look like</p>\n\n<p>User(user_id: long) Resource(resource_id: long) Resource/Action(int)</p>\n\n<p>The first 16 bits are used to store actions and the next 15 for identifying what type of resource it is.</p>\n\n<p>So given a query, - find the list of users who have liked an blog post. </p>\n\n<p>What would be the best way to model and query this in mongo ?</p>\n\n<p>I thought of something like</p>\n\n<pre><code>User(user_id: long) Resource(resource_id: long) Resource/Action(int)\n2421423                 4325235234                 17\n4223545                 3454235432                 18\n4235234                 4343453425                 17\n</code></pre>\n\n<p>and using bitmask AND operations on the query parameters and the Resource/Action field to filter correct records. But looks like mongo does not support bitwise operations. I read $where javascript functions could be used for this purpose - but I am concerned about the performance of using js function calls for querying.  </p>\n\n<p>What would be a good way to achieve this use case ?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query","optimization"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":134,"score":5,"question_id":7973559,"title":"What would be an optimal SQL query to retrieve the following result set","body":"<p>I will say in advance, and out of respect for your time and the site - this <em>is</em> a homework assignment. <strong>However</strong>, I have already <em>thought of</em> and written a solution, but I am a bit aggravated by the fact that I am unable to profile it successfully or obtain a relevant third party opinion elsewhere as to whether it is in fact a good one. </p>\n\n<p>Say I have a simple table of film participation information (person, film, persons relationship to the film) like the following:</p>\n\n<pre><code>create table film\n(\n    person_name varchar(48) not null,\n    film_title varchar(128) not null,\n    relation varchar(48) not null\n);\n\n-- { 'Mel Gibson', 'Braveheart', 'director' }\n-- { 'Mel Gibson', 'Braveheart', 'cast' }\n-- { 'Steven Spielberg', 'A.I.' , 'director' }\n-- { 'Hilary Swank', 'Million Dollar Baby', 'cast' }\n-- etc\n</code></pre>\n\n<p>The database and the table are not created or maintaned by me, I am simply to query information from it.</p>\n\n<p>I need to produce a set of person names for directors who are cast (act in front of the camera) in <em>each and every</em> film they have directed. The condition should <strong>not</strong> hold for people who have directed at least one film in which they didn't act, or for people who haven't directed anything.</p>\n\n<p>My query (that as far as I can attest produces correct result set), lo and behold:</p>\n\n<pre><code>(   \n    select  person_name \n    from    film \n    where   relation = 'director'\n)\nexcept \n(\n    select person_name\n    from \n    (   \n        (\n            select  person_name, film_title \n            from    film \n            where   relation = 'director'\n        ) \n        except \n        (   \n            select  person_name, film_title \n            from    film \n            where   relation = 'cast'\n        )\n    ) as director_behind_camera_for_film\n)\n</code></pre>\n\n<p>I would like to know whether the query is sound, or if I have been thinking completely wrong about this? If the latter, could you please provide me with a better solution or an explanation thereof?</p>\n\n<p>Don't pay much attention to the fact that I use strings everywhere (where surrogate keys could have been used insted) - this is a simplified example, yet it still demonstrates my challenge.</p>\n"},{"tags":["sql","query","duplicates","foxpro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12520349,"title":"how to delete duplicate based on multiple criteria?","body":"<p>I have a table with 4 columns : <strong>customerid</strong> , <strong>purchasedate</strong>, <strong>purchasenumber</strong>, <strong>and operationid</strong>. This table is returned as a result of another query. </p>\n\n<p>I would like to eliminate any duplicate customers except the one that has the most recent date.</p>\n\n<p>For example: If I have 4 entries with different purchasedates but the same operationid and same customerid then I would like to keep the most recent.</p>\n"},{"tags":["php","wordpress","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12520536,"title":"wordpress pagination with custom permalinks","body":"<p>I use this \"custom\" pagination script for my wordpress template:</p>\n\n<pre><code>$temp = $wp_query;\n$wp_query= null;\n$wp_query = new WP_Query();\n$wp_query-&gt;query('showposts='.get_option( 'posts_per_page' ).'&amp;paged='.$paged);\n\nwhile ($wp_query-&gt;have_posts()) : $wp_query-&gt;the_post();\n    echo '&lt;a class=\"current\";\n    echo '\" href=\"';\n    the_permalink();\n    echo '\"&gt;';\n    the_title();\n    echo '&lt;/a&gt;';\nendwhile;\nnext_posts_link('Load more articles...'); \n$wp_query = null; $wp_query = $temp;\n</code></pre>\n\n<p>So in the end, it creates a \"load more\" button that goes to <a href=\"http://blog.com\" rel=\"nofollow\">http://blog.com</a><strong>/page/2</strong>\nNow the problem is that with custom permalinks the url resembles this: <a href=\"http://blog.com\" rel=\"nofollow\">http://blog.com</a><strong>/custom/stuff</strong>/page/2 which breaks the script and does not display the next result but the originals.</p>\n\n<p>Might nay of you know how I can fix this? or maybe force <a href=\"http://blog.com\" rel=\"nofollow\">http://blog.com</a><strong>/page/2</strong> in functions.php?</p>\n\n<p>Thanks for your help guys!</p>\n"},{"tags":["sql","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12519764,"title":"BULK INSERT adding two spaces at the beginning of each row after the first one","body":"<p>The below script is being use to do a BULK INSERT but some reason when executing the script after the first line it adds two space at the beginning of each row. Any idea why it might be doing that? I have search online but I can't find anything so far. </p>\n\n<pre><code> BULK INSERT IMPORT_DATA\n FROM 'C:\\Users\\jam\\Desktop\\JamWMS\\Inbound\\IG00000002.txt'\n WITH\n (\n     ROWTERMINATOR = ';',\n     CHECK_CONSTRAINTS\n )\n</code></pre>\n\n<p>Here is some sample data of what is happening:</p>\n\n<pre><code>IG0000002     312344001052      301234     23        2         S         43012342324         1001      5          \n  IG0000002     312344001052      301234     23        2         S         43012342324         1002      3          \n  IG0000002     312344001052      301234     23        2         S         43012342324         1003      4          \n  IG0000002     312344001052      301234     23        2         S         43012342324         1004      2          \n  IG0000002     312344001052      301234     23        2         S         43012342324         1005      1          \n</code></pre>\n\n<p>This is how the file IG00000002.txt looks like</p>\n\n<pre><code>IG0000002     312344001052      301234     23        2         S         43012342324         1001      5          ;\nIG0000002     312344001052      301234     23        2         S         43012342324         1002      3          ;\nIG0000002     312344001052      301234     23        2         S         43012342324         1003      4          ;\nIG0000002     312344001052      301234     23        2         S         43012342324         1004      2          ;\nIG0000002     312344001052      301234     23        2         S         43012342324         1005      1          ;\n</code></pre>\n\n<p>Any help will be greatly appreciated.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":83,"score":0,"question_id":12500905,"title":"mysql particular query","body":"<p>I have two table: <code>teams</code> and <code>formations</code>:</p>\n\n<p>Table <strong>teams</strong>:</p>\n\n<pre><code>team_id | team_name\n   1    | Barcelona\n   2    | Real Madrid\n   3    | PSG\n</code></pre>\n\n<p>Table <strong>formations</strong>:</p>\n\n<pre><code>formation_id | team_id | module\n    1        |    2    | 5-3-2\n    2        |    1    | 4-4-2\n    3        |    3    | 4-4-2\n    4        |    2    | 4-4-3\n</code></pre>\n\n<p>Pratically i have need of \"join\" between the 2 table GROUP BY team_id but with the last \"formation_id\"</p>\n\n<p>The result my be this:</p>\n\n<pre><code> team_id | team_name  | formation_id  | module\n    1    | Barcelona  |     2         |  4-4-2\n    2    | Real Madrid|     4         |  4-4-3\n    3    | PSG        |     3         |  4-4-2 \n</code></pre>\n\n<p>Actually my query is:</p>\n\n<pre><code>SELECT *\n  FROM formations f\n INNER JOIN teams t \n    ON (f.team_id = t.team_id)\n GROUP BY t.team_id\n</code></pre>\n\n<p>With my query I selected the first insert formation for each team, instead I must select the last formations for each team.</p>\n"},{"tags":["database","query","plsql","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":140,"score":1,"question_id":9672707,"title":"Pareto analysis in Oracle SQL without iterative procedures and hardcoding of valid values","body":"<p>Say, you have table T(C1, C2, C3) and there is a set of valid values for C1, V={v1,v2,v3...}. Now, without resorting to cursors - i.e., completely staying in the domain of set-based logic, you want to see what proportion of rows is of type v1, what proportion of rows is of type v2, and what proportion of rows is of type v3 and so on - without having to write a case if for each valid value. So, for each distinct valid value in C1, display in the result set the sorted frequency of type V rows and the corresponding value (ie, v1,v2,v3...). What is the query in PL/SQL?</p>\n\n<p>EDIT: the count is straightforward:</p>\n\n<pre><code>select count(*) count, c1 from T group by c1 order by count\n</code></pre>\n\n<p>but what if you want to show the frequency proportions?</p>\n"},{"tags":["sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12518294,"title":"SQL Server query to pull a combination values from the table","body":"<p>I have a table T as below. </p>\n\n<p>I would like to pick a client who has their status <code>Processed, InProgress</code> combination.  </p>\n\n<p>Please could you help, how can I do it?  </p>\n\n<p><strong>Table</strong>  </p>\n\n<pre><code>ClientId    ClientName  Status\n1           A           Processed\n1           A           Processed\n2           b           InProgress\n2           b           Processed\n3           c           Processed\n3           c           Processed\n4           d           InProgress\n4           d           Processed\n5           e           InProgress\n5           e           Processed  \n</code></pre>\n\n<p><strong>Result should be</strong>  </p>\n\n<pre><code>ClientId    ClientName  Status\n2           b           InProgress\n2           b           Processed\n4           d           InProgress\n4           d           Processed\n5           e           InProgress\n5           e           Processed  \n</code></pre>\n\n<p>Thank you in advance</p>\n"},{"tags":["mysql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12517678,"title":"How to define a range query depending on the count?","body":"<p>The tuples in my table look like this: (value, date, attribute). Now I want to query the database and get a range, but not depending on the date, but on the count \"the last x entries in the range of ...\". The following example shall clarify: I have a time bar where all entries with the attribute=\"x\" are ordered by the date column, so the date of point s and t are smaller that the date in point 0 and the date in point x and y are bigger than in point 0, of course. All the points have attribute = \"a\".</p>\n\n<pre><code>      s        t  0  x        y\n------|--------|--|--|--------|------&gt; t\n</code></pre>\n\n<p>Now I want to get all entries with the following characteristics: Get all entries from s - t and x - y, where attribute=\"a\" and choose s and t in a way that I get 60 entries in this range, choose t in a way that 5 entries are between t and 0, and x and y respectively.</p>\n\n<p>Here is a sample data:</p>\n\n<pre><code>(xyz, 01.02.2000, a)\n(xyz, 02.02.2000, a)\n(xyz, 01.02.2000, b)\n(xyz, 03.02.2000, a)\n(xyz, 01.02.2000, b)\n(xyz, 04.02.2000, a)\n(xyz, 06.02.2000, a)\n(xyz, 01.02.2000, b)\n(xyz, 07.02.2000, a)\n(xyz, 01.02.2000, b)\n(xyz, 10.02.2000, a)\n(xyz, 12.02.2000, a)\n</code></pre>\n\n<p>The desired output for date = 06.02.2000 and range s-t = 3, t-0=1 would be </p>\n\n<pre><code>s = (xyz, 01.02.2000, a)\n(xyz, 02.02.2000, a)\nt = (xyz, 03.02.2000, a)\n(xyz, 04.02.2000, a) NOT because between t and 0 should be 1 free\n0 = (xyz, 06.02.2000, a)\n</code></pre>\n\n<p>And in the other direction, the \"right\" direction on the time bar exactly the same...</p>\n\n<p>At the moment I use two queries with order by date and limits (5, 60), but I would guess that there is a better way... I only don't know this way ;-)</p>\n"},{"tags":["mysql","database","query","search","full-text-search"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":46,"score":1,"question_id":12516307,"title":"Finding a text from single or multiple Mysql databases using a query","body":"<p>Is there any way to find a text from single or multiple databases using a mysql query.\n<strong>Note:</strong> i know  the database can be downloaded into a file and searched but i want to know if its possible using a mysql query</p>\n"},{"tags":["sql","query","delete","duplicates"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12515651,"title":"deleting duplicates in a table based on a criteria only in SQL","body":"<p>Let's say I have a table with columns:</p>\n\n<pre><code>CustomerNumber\nLastname\nFirstname\nPurchaseDate\n</code></pre>\n\n<p>...and other columns that do not change anything in the question if they're not shown here.</p>\n\n<p>In this table I could have many rows for the same customer with different purchase dates (I know, poorly designed... I'm only trying to fix an issue for reporting, not really trying to fix the root of the problem).</p>\n\n<p>How, in SQL, can I keep one record per customer with the latest date, and delete the rest?  A <code>group by</code> doesn't seem to be working for my case</p>\n"},{"tags":["php","query","oop","pdo"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":22,"score":-2,"question_id":12515277,"title":"PDO Error In SignUp Class","body":"<p>I'm working on my own SignUp class but it seems I have a problem with the PDO calls\nThe browser returns this to me:</p>\n\n<blockquote>\n  <p>Fatal error: Call to a member function query() on a non-object</p>\n</blockquote>\n\n<p>I have my database configuration in a file included then on the main page. It's as follows:</p>\n\n<pre><code>   &lt;?\n   $dsn = 'mysql:dbname=magazin-online;host=localhost;';\n   $username = 'root';\n   $password = '';\n\n   try{\n       $pdo = new PDO($dsn, $username, $password);\n   }catch(PDOException $e){\n       echo 'Connection failed!: '.$e-&gt;getMessage();\n   }\n</code></pre>\n\n<p>An the line in the SignUp class causing the error is this:</p>\n\n<pre><code>   $pdo-&gt;query(\"insert into ... () ... values ());\n</code></pre>\n\n<p>Now, I don't make any db connection in my SignUp class because I already included the file resposible for it.</p>\n\n<p>How can I get rid of that error?</p>\n"},{"tags":["mysql","query"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12503525,"title":"MySQL: How to retrieve all rows with a duplicate field, matching a LIKE on a certain field in any matched row","body":"<p>I have a database containing about 300,000 rows of product information.<br>\nI need to retrieve rows with <strong>duplicate UPCs</strong> (COUNT(upc) > 1), where <strong>at least one</strong> of the results' descriptions matches a certain string (\"Reed\", for example.)</p>\n\n<p>For example, the following rows would all be selected (desc, upc pairs)</p>\n\n<pre><code>Deer D7394    62226173\nReed R2536    62226173\nDeer D7217    62226173\n</code></pre>\n\n<p>but none of</p>\n\n<pre><code>Deer D0173    62278389\nDeer D7289    62278389\nDeer D9272    62278389\n</code></pre>\n\n<p>Here is the query I'm working with:</p>\n\n<pre><code>SELECT a.desc, a.upc, a.sku, a.short_description \nFROM inventory a \nJOIN \n    (SELECT upc, desc \n    FROM inventory \n    GROUP BY upc \n    HAVING COUNT(upc) &gt; 1) b \nON a.upc = b.upc \nWHERE ((a.desc LIKE '%Reed%') OR (b.desc LIKE '%Reed%'))\nAND a.upc != '' \nAND a.upc != 0 \nORDER BY upc;\n</code></pre>\n\n<p>I am relatively new to MySQL, but this seems like it should work. However, <strong>some</strong> results are failing to return the non-matching row (i.e. Reed R2536 will be returned, but not Deer D7394).</p>\n\n<p>Any insight would be greatly appreciated!</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","aggregate-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":76,"score":0,"question_id":12511894,"title":"Sum of single column for different conditions","body":"<p>I have two columns in my table <strong>colum#1</strong> is <code>varchar(MAX)</code> and column#2 is <code>int</code>.</p>\n\n<p>In <strong>column#2</strong> I have negative and positive entries I want sum of positive entries in one column and sum of negative entries in other column in my select query </p>\n\n<p>To achieve this I did</p>\n\n<pre><code>SELECT SUM(atbl.M),SUM(atbl.p)    \nfrom (select M=case when column#2&lt;0 \n                    then column#2 else 0 end,\n             P=case when column#2 &gt; 0 \n                    then column#2 else 0 end \n        from testTable) atbl\n</code></pre>\n\n<p>or</p>\n\n<pre><code>select SUM(case when column#2&lt;0 then column#2 else 0 end) as M\n      ,SUM(case when column#2 &gt; 0 then column#2 else 0 end) as P \n from testTable\n</code></pre>\n\n<p>Is there any better way to achieve this.</p>\n"},{"tags":["c#","sql","query","datatable","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":130,"score":1,"question_id":12513853,"title":"How to apply SQL query to a C# DataTable/Dataset?","body":"<p>I have an application, where users can enter an sql query as text, and I need to run it against a C# DataTable/Dataset inside my application.  Is it possible to do?</p>\n\n<p>EDIT:\nBased on the answers, and some more research it cannot be done - there is no way to apply an SQL query to a table that you already read into your application.  Look at answers for possible workarounds.</p>\n"},{"tags":["mysql","query","parallel-processing","storm"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":12514233,"title":"parallelism with mysql queries","body":"<p>I have the following problem:</p>\n\n<p>I'm dealing with multiple parallel threads at the moment which simultaneously should get data from the same data base via a mysql query (I'm using Java for this - more precisely, storm with Java). But instead of doing this parallely it seems to be done sequentally and therefore, the time needed for the whole process more or less is the added-up time of each query from every thread.</p>\n\n<p>Is there a way to actually perform these threads (and the queries from the same data base coming along with them) parallely? I really need to speed up the process by a lot.</p>\n\n<p>Unofortunately, there are way too many lines of code to be able to present you some usefull extracts of it...</p>\n\n<p>I hope you can still help me out with this.</p>\n\n<p>Thanks1</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","null"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":77,"score":0,"question_id":12513385,"title":"Count number of null column in a row of table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9079037/how-to-count-in-sql-all-fields-with-null-values-in-one-record\">How to count in SQL all fields with null values in one record?</a>  </p>\n</blockquote>\n\n\n\n<p>I have table with five columns: </p>\n\n<pre>\nName     DOB    Email      phone   jobtitle\nabc     null   a@c.com      null       null\nbbc     null    null        null       null\n</pre>\n\n<p>How do I write a query so that I can find the number of null columns in a row?</p>\n\n<p>(e.g. Row 1 is having 3 null value, and row 2 is  having 4 null values.)</p>\n\n<p>I am using SQL Server 2008. </p>\n"},{"tags":["android","query","select","sms","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12512978,"title":"Android Cursor select parameter for SMS DB querying","body":"<p>I am trying to get all SMSes from and to a single address.</p>\n\n<p>So while using a Cursor to scan the DB, I tried to use select. But, no values were returned. I suspect that this was caused because the numbers in the \"address\" colum in the DB were containing space and/or hyphens (-).</p>\n\n<p>My question is that can I make a query to ignore spaces and hyphens in the string?</p>\n\n<p>P.S.: the address I have has been trimmed down to not include spaces and hyphens, and that is unchangeable as per my requirements.</p>\n"},{"tags":["mysql","sql","query","select","count"],"answer_count":8,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":98,"score":4,"question_id":12512512,"title":"MySQL count only new records","body":"<p>How to write a MySQL query to achieve this task?</p>\n\n<p><strong>Table:</strong> writers</p>\n\n<pre><code>w_id    w_name\n---------------\n  1     Michael\n  2     Samantha\n  3     John\n---------------\n</code></pre>\n\n<p><strong>Table:</strong> articles</p>\n\n<pre><code>a_id   w_id   timestamp   a_name\n----------------------------------------\n  1      1        1       PHP programming\n  2      3        3       Other programming languages\n  3      3        5       Another article\n  4      2       15       Web design\n  5      1       20       MySQL\n----------------------------------------\n</code></pre>\n\n<p>Need to <b>COUNT</b> only those <b>writers</b> who published their <b>first article</b> not earlier than <b>5</b>.<br> <i>(only writers who published at least one article can be counted)</i></p>\n\n<p><br>\nIn this example the result would be: <b>1</b> <i>(one writer - Samantha)</i>\n<br><br>\nSQL code can be tested <a href=\"http://sqlfiddle.com/#!2/0e90f\" rel=\"nofollow\">in this SQLFiddle</a></p>\n"},{"tags":["php","mysql","sql","query","duplicates"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12512996,"title":"duplicate data dispay when i have two entries for the same user in mysql","body":"<p>So I have a two quesies that the first one select an array based on the $_SESSION and then is used in the second select.</p>\n\n<p>My problem is that when I have for example for one use one entrie every thing is ok the table will be like this:</p>\n\n<pre><code>|DATA| USER1|\n|DATA| USER2|\n|DATA| USER3|\n</code></pre>\n\n<p>But if I have to entries for the same user I got duplicate like this:</p>\n\n<pre><code>|DATA| USER1| [1]\n|DATA| USER1| [2]\n|DATA| USER2|\n|DATA| USER3|\n|DATA| USER1| DUPLICATE of FIRST ENTRY USER ABOVE [1]\n|DATA| USER1| DUPLICATE OF SECOND ENTRY USER ABOVE [2]\n</code></pre>\n\n<p>My code looks like this :</p>\n\n<pre><code>function make_table($user_id){\n   first_query with this select `Select U.user_id\n                                   from users U, tasks T\n                                  where T.assigned_to = U.user_id \n                                    and T.status='Assigned'\n                                    and U.parent_id = $_SESSION[userid]`;\n\n  foreach ($query_result_worker as $row){\n            $user_id_worker = $row['user_id'];\n\n  //second_query with this select \n\n    SELECT T.task_id, T.job_server_id, T.TIMESTAMP, TT.task_type_name, T.STATUS,\n           UO.username AS customer_name, UO.user_id AS customer_id, T.STATUS, T.quantity,\n           T.order_id, U.username, T.priority, T.assigned_time, U.username, O.order_id\n     FROM task_type TT, orders O, users UO, task_assignment T\n     LEFT JOIN users U\n        ON T.assigned_to = U.user_id\n     WHERE T.task_type_id = TT.task_type_id\n        AND O.order_id = T.order_id\n        AND O.user_id = UO.user_id\n        AND T.STATUS = 'Assigned'\n        AND T.assigned_to = $ROW [user_id]\n        AND T.TIMESTAMP &lt;= CURRENT_TIMESTAMP\n     ORDER BY T.priority DESC, DATE (T.TIMESTAMP), T.quantity DESC, T.task_id\n\n    foreach ($result as $tablerow) {\n    make the printing table stuff\n\n     }\n}\n</code></pre>\n\n<p>So I don't know why it's duplicating when I got two entries, any help please?</p>\n\n<p>PS: if I have 3 entries for the same user it will be 6 for the same user, duplicates too.</p>\n"},{"tags":["c#","query","active-directory","ldap","ldap-query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":586,"score":2,"question_id":10284806,"title":"How can I better query multiple domains in Active Directory using C#?","body":"<p>I am attempting to expand a LDAP / AD search from only searching in the currently logged in domain to searching all domains in the AD. The method takes in the string with the query and returns and return an LDAPInformation object. </p>\n\n<p>While I am asking, is there any better way to search for the name than in this way? It is user unfriendly due to needing to use wildcards if looking for a person by last name (example: Doe*).</p>\n\n<pre><code>    public static LDAPInformation[] GetGlobalAddressListVIAName(string nameQuery)\n    {\n        var currentForest = Forest.GetCurrentForest();\n        var globalCatalog = currentForest.FindGlobalCatalog();\n\n        using (var searcher = globalCatalog.GetDirectorySearcher())\n        {\n            using (var entry = new DirectoryEntry(searcher.SearchRoot.Path))\n            {\n                searcher.Filter = \"(&amp;(mailnickname=*)(objectClass=user)(displayName=\" + nameQuery + \"))\";\n                searcher.PropertyNamesOnly = true;\n                searcher.SearchScope = SearchScope.Subtree;\n                searcher.Sort.Direction = SortDirection.Ascending;\n                searcher.Sort.PropertyName = \"displayName\";\n                return searcher.FindAll().Cast&lt;SearchResult&gt;().Select(result =&gt; new LDAPInformation(result.GetDirectoryEntry())).ToArray();\n            }\n        }\n    }\n</code></pre>\n\n<p>Here is the object:</p>\n\n<pre><code>    class LDAPInformation\n{\n    internal LDAPInformation(DirectoryEntry entry)\n    {\n        //Section: HASH\n        this.sAMAccountName = (string)entry.Properties[\"sAMAccountName\"].Value;\n\n        //Section: Email\n        this.Mail = (string)entry.Properties[\"mail\"].Value;\n\n        //Section: Organziation\n        this.Description = (string)entry.Properties[\"description\"].Value;\n        this.Company = (string)entry.Properties[\"company\"].Value;\n        this.Title = (string)entry.Properties[\"title\"].Value;\n        this.Department = (string)entry.Properties[\"department\"].Value;\n\n        //Section: Name\n        this.DisplayName = (string)entry.Properties[\"displayName\"].Value;\n        this.FirstName = (string)entry.Properties[\"firstName\"].Value;\n        this.MiddleName = (string)entry.Properties[\"middleName\"].Value;\n        this.LastName = (string)entry.Properties[\"lastName\"].Value;\n\n        //Section: Address\n        this.StreetAddress = (string)entry.Properties[\"streetAddress\"].Value;\n        this.City = (string)entry.Properties[\"city\"].Value;\n        this.State = (string)entry.Properties[\"state\"].Value;\n        this.PostalCode = (string)entry.Properties[\"postalCode\"].Value;\n        this.TelephoneNumber = (string)entry.Properties[\"telephoneNumber\"].Value;\n    }\n\n    public string DisplayName\n    {\n        get;\n        private set;\n    }\n\n    public string Mail\n    {\n        get;\n        private set;\n    }\n\n    public string sAMAccountName\n    {\n        get;\n        private set;\n    }\n\n    public string Description\n    {\n        get;\n        private set;\n    }\n\n    public string Company\n    {\n        get;\n        private set;\n    }\n\n    public string Title\n    {\n        get;\n        private set;\n    }\n\n    public string Department\n    {\n        get;\n        private set;\n    }\n\n    public string FirstName\n    {\n        get;\n        private set;\n    }\n\n    public string MiddleName\n    {\n        get;\n        private set;\n    }\n\n    public string LastName\n    {\n        get;\n        private set;\n    }\n\n    public string StreetAddress\n    {\n        get;\n        private set;\n    }\n\n    public string City\n    {\n        get;\n        private set;\n    }\n\n    public string State\n    {\n        get;\n        private set;\n    }\n\n    public string PostalCode\n    {\n        get;\n        private set;\n    }\n\n    public string TelephoneNumber\n    {\n        get;\n        private set;\n    }\n}\n</code></pre>\n"},{"tags":["sql","database","oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":111,"score":5,"question_id":8211935,"title":"Query with join equivalency?","body":"<p>Are these two queries equivalent (assuming varying/any kinds of data in the table)? Are there any scenarios in which they would return different results?</p>\n\n<p>Query 1:</p>\n\n<pre><code>select * from tablea a\nleft join tableb b on a.keyacol = b.keybcol\ninner join tablec c on c.keyccol = b.keybcol;\n</code></pre>\n\n<p>Query 2:</p>\n\n<pre><code>select * from tablea a\nleft join (\nselect b.*, c.* from tableb b\ninner join tablec c on c.keyccol = b.keybcol\n) sub on a.keyacol = sub.keybcol;\n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":12511645,"title":"How to use variable as the table identifier in MYSQL","body":"<p>If i have this:</p>\n\n<pre><code>CREATE TABLE ftable (\nid     INT,\nfvalue VARCHAR(14)\n);\n\nINSERT INTO ftable VALUES (1,'tableB'),(2,'tableA');\n\nCREATE TABLE tableA (\nvalue VARCHAR(14)\n);\n\nSELECT @tmp:=fvalue FROM ftable WHERE id=2;\n</code></pre>\n\n<p>How do I make it so I can do this:</p>\n\n<pre><code>INSERT INTO @tmp VALUES ('buhambug');\n</code></pre>\n\n<p>Becuase as far I know that throws a mysql error.Can someone show me a sqlfiddle of the solution? Or maybe I'm thinking about this the wrong way?</p>\n"},{"tags":["sql","query","cross-product"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1782,"score":1,"question_id":267530,"title":"query: cross product instead of join","body":"<p>I have two tables that I would like to join but I am getting an error from MySQL</p>\n\n<pre><code>Table: books\nbookTagNum ShelfTagNum\nbook1      1\nbook2      2\nbook3      2\n\nTable: shelf\nshelfNum   shelfTagNum\n1          shelf1\n2          shelf2\n</code></pre>\n\n<p>I want my results to be:</p>\n\n<pre><code>bookTagNum ShelfTagNum shelfNum\nbook1      shelf1           1\nbook2      shelf2           2\nbook3      shelf2           2\n</code></pre>\n\n<p>but instead I am also getting an extra result:</p>\n\n<pre><code>book1      shelf2           2\n</code></pre>\n\n<p>I think my query is doing a cross product instead of a join:</p>\n\n<pre><code>SELECT `books`.`bookTagNum` , `books`.`shelfNum` , `shelf`.`shelfTagNum` , `books`.`title`\nFROM books, shelf\nwhere `books`.`shelfNum`=`books`.`shelfNum`\nORDER BY `shelf`.`shelfTagNum` ASC\nLIMIT 0 , 30\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12510141,"title":"SQL Query Optimisation - taking too long","body":"<p>Wondering if someone could help me optimise this query better as it's taking about 4 seconds to execute.</p>\n\n<pre><code>SELECT discount.*, retailer.name AS retailer_name, \nsub_category.type AS subcategory_type \nFROM discount \n  JOIN retailer ON retailer.id = discount.retailer \n  JOIN sub_category ON sub_category.id = discount.sub_category \nWHERE discount.start_date &lt;= 1348133607 \nAND retailer.closed = 0  \nAND ( discount.only_for = 'PROC' OR discount.only_for = '' ) \nORDER BY discount.updated_on DESC LIMIT 25\n</code></pre>\n\n<p>I have indexes on:</p>\n\n<ul>\n<li>discount.retailer</li>\n<li>discount.sub_category</li>\n<li>discount.start_date</li>\n<li>retailer.closed</li>\n<li>discount.only_for</li>\n</ul>\n"},{"tags":["sql-server","query","percentage"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":11525449,"title":"Returning percentage according to age intervals from employees table SQL Server","body":"<p>I have a table employees[employee_id,age] and I wish to return the percentage of employees age between 18 and 20, and  26-40, something like:</p>\n\n<pre><code>Age Interval Percent\n18-20          35%\n26-40          40 %\n</code></pre>\n\n<p>Thanks</p>\n\n<pre><code>Select t.range as [age interval] , Count(*) as 'number of appereances' from\n(Select case when age between 18 and 26 then '18-26'\nwhen age between 26-40 then '26-40' end as range from employees) t\ngroup by t.range\n</code></pre>\n"},{"tags":["android","database","image","query","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12507971,"title":"sql where clause for managedQuery android method","body":"<p>I am trying to write the parameters to the managedQuery method in android and having trouble with the WHERE clause,  here is what i wrote;</p>\n\n<pre><code>Cursor imageCursor;\n\n// lots of other junk\n\nString[] proj = {MediaStore.Images.Media.TITLE};\n\nimageCursor = managedQuery(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, proj, MediaStore.Images.Media.DATA = filename, proj, null );\n</code></pre>\n\n<p>\"filename\" is a <code>string</code> variable holding the path of an image,  example <code>/mnt/sdcard/pic05.png</code></p>\n\n<p>I want it to return a cursor holding a record that is the same record for the pic05.png image and the cursor returned would hold the TITLE column information for this specific picture.  How did i mess up the sql WHERE CLAUSE?  I thought that my syntax must be wroing on the where clause</p>\n"},{"tags":["mysql","performance","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12507789,"title":"query takes too much time while sorting in MySQL","body":"<p>Query :\nselect field1 as Word,count(*) as Count from TestAdd1214190 group by field1 order by count desc</p>\n\n<p>Btree Index created on field1 column</p>\n\n<p>Data In table 50 lac</p>\n\n<p>Engine : MEMORY</p>\n\n<p>Explain\nTYPE: SIMPLE</p>\n\n<p>USING INDEX;USING TEMPORORY;USING FILESORT</p>\n\n<p>Please suggest how do i make this query fast</p>\n"},{"tags":["mysql","query","select","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12506610,"title":"mysql Select from Select","body":"<p>I have this query:</p>\n\n<pre><code>    SELECT DATE( a.created_at ) AS order_date, count( * ) as cnt_order\n    FROM `sales_order_item` AS a\n    WHERE MONTH( a.created_at ) = MONTH( now())-1\n    GROUP BY order_date\n</code></pre>\n\n<p>which will return result something like this (snapshot only otherwise will return per 31 days):</p>\n\n<pre><code>order_date  cnt_order \n2012-08-29  580\n2012-08-30  839\n2012-08-31  1075\n</code></pre>\n\n<p>and my full query is selecting based on above selection:</p>\n\n<pre><code>SELECT order_date\n    , MAX(cnt_order) AS highest_order\nFROM (\n        SELECT DATE (a.created_at) AS order_date\n            , count(*) AS cnt_order\n        FROM `sales_order_item` AS a\n        WHERE MONTH(a.created_at) = MONTH(now()) - 1\n        GROUP BY order_date\n    ) AS tmax\n</code></pre>\n\n<p>But it result :</p>\n\n<pre><code>order_date  highest_order\n2012-08-01  1075\n</code></pre>\n\n<p>Which has the date wrong and always pick the first row of date where it suppose 2012-08-31. Maybe this is a simple error that I dont know. So how to get the date right point to 2012-08-31? Any help would be great.</p>\n"},{"tags":["sql","sql-server","query","select","select-query"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":800,"score":1,"question_id":7151073,"title":"Return result of select query only if not empty","body":"<p>Working with Sql Server. Writing a stored procedure. Here is the pseudocode for what I want to achieve:</p>\n\n<pre><code>    IF EXISTS ( SELECT  field1\n                FROM    t1\n                WHERE   field1 = ... AND field2 = ...) \n        BEGIN\n            SELECT  field1\n                FROM    t1\n                WHERE   field1 = ... AND field2 = ...\n        END\n</code></pre>\n\n<p>any better way of doing this? Any help appreciated.</p>\n\n<p>Chirayu</p>\n\n<p>Update: The problem is that the same query is executed twice. I cannot also just the run query once and return null (if the result is null i would like to return an alternative result).</p>\n"},{"tags":["sql","query","if-statement","spreadsheet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12459434,"title":"query and if function google spreadsheet","body":"<p>My question:</p>\n\n<p>I have a long long query function into a if function from 3 cells (under is a simple version with  two cells)</p>\n\n<p><code>=IF(B2=\"All\";Query(Sheet!1:100000;\"select B,C,F\"); Query(Sheet!1:100000;\"select B,C,F where C contains \"\"\"&amp;B2&amp;\"\"\" and B contains \"\"\"&amp;D2&amp;\"\"\"  \")</code></p>\n\n<p>B2 and D2 are the cells where i have item lists that fill my query.</p>\n\n<p>Now I want:\ninsert a blank value at the start of the query. I can use <code>if (isblank(B2);iferror(1/0)</code>\nbut doesn't go with two or more cells. </p>\n\n<pre><code>=if (isblank(B2);iferror(1/0), if(isblank(D2);iferror(1/0),,IF(B2=\"All\";Query(Sheet1!1:100000;\"select B,C,F\"); Query(Sheet1!1:100000;\"select B,C,F, where C contains \"\"\"&amp;B2&amp;\"\"\" and B contains \"\"\"&amp;D2&amp;\"\"\" \"))))\n</code></pre>\n\n<p>More, I want learn to use different conditions (with OR and AND ).</p>\n\n<p>Can you help me?</p>\n"},{"tags":["php","mysql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12507846,"title":"display a part of a tab mysql that do not exist in an other tab","body":"<p>I have two tabs named respectly liste_pieces and client_pieces.</p>\n\n<p>The first contain a list of many elements about 1000. the second contain some element of the first. </p>\n\n<p>Actually I'm doing a query to fullfill the second tab with the first.</p>\n\n<p>Also I would like to display all element from the first that are not in the second. </p>\n\n<p>I've thought I could do a joint pas a joint will only display elements that are in both tab.</p>\n\n<p>And actually that is not what I'm looking for.</p>\n\n<p>I've done that query for the moment</p>\n\n<pre><code>      &lt;table id=\"box-table-a\" width=\"100%\"&gt;\n    &lt;tr&gt;\n        &lt;th scope=\"col\" width=\"50%\"&gt;LISTE DES PI&amp;Egrave;CES&lt;/th&gt;\n        &lt;th scope=\"col\" width=\"50%\"&gt;AJOUT ?&lt;/th&gt;\n    &lt;/tr&gt;\n\n&lt;?php $sql=\"SELECT * FROM `liste_pieces`\";\n$result=mysql_query($sql) or die;$i=0;\nwhile($data=mysql_fetch_assoc($result))\n\n{?&gt;\n&lt;tr&gt;\n    &lt;td&gt;&lt;?php echo $data['libelle'] ; ?&gt;&lt;/td&gt;\n    &lt;td style=\"text-align:center\" align=\"center\"&gt;\n  &lt;p align=\"center\"&gt;  &lt;input type=\"hidden\" name=\"piece[&lt;?php echo $i ; ?&gt;]\" value=\"0\" /&gt;&lt;input type=\"checkbox\" class=\"checkbox\" value=\"1\" name=\"piece[&lt;?php echo ++$i ; ?&gt;]\" id=\"piece[&lt;?php echo ++$i ; ?&gt;]\" /&gt;&lt;/p&gt;&lt;/td&gt;\n\n&lt;/tr&gt;\n&lt;?php } ?&gt;\n</code></pre>\n\n<p>But this display to me all elements from the first tab. I do not really know how to remove elements that exists in the second tab.</p>\n\n<p>I have the column id on liste_pices that is the same in the second tab except that it is called id_piece.</p>\n\n<p>I'm a bit lost.</p>\n\n<p>I do not know how to process.</p>\n\n<p>Receive All my utmost Respect.</p>\n\n<p>Kind regards.</p>\n\n<p>SP.</p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12507460,"title":"Joining 2 Select statements and limiting the 2nd to the results of the first","body":"<p>I'm trying to join the first 100 results fron one inner select to a second. </p>\n\n<p>My example is a little contrived, but I have a table of email addresses with a number of them that get marked as dirty, and a table of observations that I map emails and names to (they both comprise the primary key in this table).  I want the result to be the number of distinct names per email address.</p>\n\n<pre><code>SELECT ea.email, tmp.uniques FROM \n  (SELECT email FROM emails WHERE dirty = 1 LIMIT 100) ea\n  INNER JOIN \n  (SELECT email, COUNT(DISTINCT(name)) as uniques FROM nameEmailObservations GROUP BY email ) tmp \n  ON (tmp.email = ea.email);\n</code></pre>\n\n<p>The query appears to be valid, but it's taking a long time.  Any idea why or what I can do?   I suspect it's because the 2nd query isn't having its results limited to the first query.  The second query does take a long time by itself, because <code>nameEmailObservations</code> is huge.</p>\n"},{"tags":["sql-server","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12506659,"title":"How can I calculate time duration between two rows of a column in SQL Server?","body":"<p>I have a data like this in the database</p>\n\n<pre><code>ID  Server DownTime          ServerStatus\n--- -----------------------  ------------\n1   2012-03-30 00:00:00.000  1\n2   2012-03-30 00:30:00.000  0\n3   2012-03-30 01:00:00.000  0\n4   2012-03-30 01:30:00.000  0\n5   2012-03-30 02:00:00.000  1\n6   2012-03-30 02:30:00.000  1\n7   2012-03-30 03:00:00.000  0\n8   2012-03-30 03:30:00.000  1\n</code></pre>\n\n<p>I need a query or stored procedure that will give me output as </p>\n\n<pre><code>Start Time    EndTime       TotalDownTimeinMinutes\n------------  ------------  ----------------------\n3/30/12 0:30  3/30/12 2:00  90\n3/30/12 3:00  3/30/12 3:30  30\n</code></pre>\n"},{"tags":["php","mysql","query","pdo","modx"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12489479,"title":"ModX and PDO: querying with PHP variables","body":"<p>I am new to PDO and have the follow code which recieves 2 PHP vars from a form and uses them in a query:</p>\n\n<pre><code>$loginemail = $_REQUEST['loginemail'] ;\n$loginpassword = $_REQUEST['loginpassword'] ;\n\n$logincheck = \"SELECT * FROM `ft_gameusers` WHERE `email` = '$loginemail' AND `password` = '$loginpassword'\";\n\n$query = $modx-&gt;query($logincheck);\n\nif ($query) {\n    while ($row = $query-&gt;fetch(PDO::FETCH_ASSOC)) {\n\n echo $row['email'];\n\n    }\n}\n</code></pre>\n\n<p>The thing is if I hard code the email and password variables into the MySQL query it works fine - its just doesnt seem to like them as PHP variables.</p>\n\n<p>Does anyone know what Im doing wrong? (PS: this is a snippet within ModX Revo)</p>\n\n<p>EDIT: form tag:</p>\n\n<pre><code>&lt;form id=\"loginform\" action=\"mysite.com/formprocess\" method=\"post\"&gt;\n\nEmail:\n&lt;input type=\"text\" id=\"loginemail\" name=\"loginemail\"&gt;\nPassword:\n&lt;input type=\"password\" id=\"loginpassword\" name=\"loginpassword\"&gt;\n&lt;button type=\"submit\"&gt;Login&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n"},{"tags":["mysql","query","magento"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12452316,"title":"category_ids to category in magento","body":"<p>I am exporting products in magento 1.3 to magento 1.6, in magento 1.3's .csv it has a field category_ids and in magento 1.6's .csv has _category field. I just want to have same .csv attribute field of magento 1.3 the same with .csv magento 1.6 so that I can import the .csv in magento 1.3 to magento 1.6.</p>\n\n<p>My problem now is that how can I query in my mysql to get the category name from category_ids in magento 1.3 ?</p>\n\n<p>I look in the tables in magento 1.3 but there is no category name in there. </p>\n\n<p>In the .csv of magento 1.3 it has this table</p>\n\n<pre><code>category_ids\n------------\n154\n154\n154\n59\n63,88\n63\n61\n</code></pre>\n\n<p>i try this sql query but nothing return..</p>\n\n<pre><code>SELECT catalog_category_entity_varchar.value FROM catalog_category_entity_varchar WHERE value_id = 154;\n</code></pre>\n\n<p>Do anyone have an idea about my case? thanks in advance ...</p>\n"},{"tags":["asp.net","query","nhibernate","union","subclass"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12475914,"title":"nhibernate: get different subclasses with paging","body":"<p>I have the following entities</p>\n\n<pre><code>class BaseClass\n{\n  public int Id{get; set;}\n}\n\nclass SubClassOne : BaseClass\n{\n  public string MyPropertyOne{get; set;}\n}\n\nclass SubClassTwo : BaseClass\n{\n  public string MyPropertyTwo{get; set;}\n}\n</code></pre>\n\n<p>Now I need to display all existing entities (of type SubClassOne and SubClassTwo) in one grid, including paging.</p>\n\n<p>Problem is that every Subclass has properties of its own on which the user can search and therefore needed in the query.</p>\n\n<p>So, Future() is, as far as I can tell, no option because paging would not work.\nIn pure sql I would construct a big query with UNION. As far as I know nhibernate does not directly work with UNION. Is it somehow possible to use direct sql and then convert the result to the entities SubClassOne and SubClassTwo? </p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":107,"score":0,"question_id":12506257,"title":"SQL select query taking long time","body":"<p>I am using the below SQL query  but it takes more than 180 sec to execute. Is there a way to speed it up ? This SQL give me the pic_id and of all the females.</p>\n\n<pre><code>SELECT pic_id, small\nFROM picture\nWHERE hide =0\nAND userhide =0\nAND  `fbid` \nIN (\n\n      SELECT fbid\n      FROM user\n      WHERE gender =  \"female\"\n   )\n\nORDER BY  `picture`.`pic_id` ASC \nLIMIT 1500 , 200\n</code></pre>\n\n<p>The Explain SQL</p>\n\n<pre><code>id select_type         table    type   possible_keys  key      key_len  ref   rows  Extra\n1  PRIMARY             picture  index  NULL           PRIMARY  4        NULL  1700  Using where\n2  DEPENDENT SUBQUERY  user     ALL    NULL           NULL     NULL     NULL  7496  Using where\n</code></pre>\n\n<p>--- Result of explain statement for Tim's sql answer --</p>\n\n<pre><code>id  select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  picture ALL NULL    NULL    NULL    NULL    41443   Using where; Using temporary; Using filesort\n1   SIMPLE  user    ALL NULL    NULL    NULL    NULL    7501    Using where; Using join buffer\n</code></pre>\n\n<p>-- Structure ---</p>\n\n<pre><code>CREATE TABLE `user` (\n`sid` int(11) NOT NULL AUTO_INCREMENT,\n`name` varchar(255) CHARACTER SET utf8 NOT NULL,\n`first_name` varchar(255) CHARACTER SET utf8 NOT NULL,\n`username` varchar(255) CHARACTER SET utf8 NOT NULL,\n`birthday` date NOT NULL,\n`location` varchar(255) CHARACTER SET utf8 NOT NULL,\n`gender` varchar(6) CHARACTER SET utf8 NOT NULL,\n`created` date NOT NULL,\n`fbid` bigint(50) NOT NULL,\n`token` varchar(255) CHARACTER SET utf8 NOT NULL,\n`relationship_status` varchar(20) CHARACTER SET utf8 NOT NULL,\n`smallest` varchar(255) CHARACTER SET utf8 NOT NULL,\n`email` varchar(40) CHARACTER SET utf8 NOT NULL,\n`ref` varchar(15) NOT NULL,\nPRIMARY KEY (`sid`),\nKEY `gender` (`gender`),\nKEY `fbid` (`fbid`)\n) ENGINE=MyISAM AUTO_INCREMENT=7595 DEFAULT CHARSET=latin\n</code></pre>\n\n<p>---- structure of picture table ---</p>\n\n<pre><code>CREATE TABLE `picture` (\n `fbid` bigint(50) NOT NULL,\n `pic_id` int(11) NOT NULL AUTO_INCREMENT,\n `pic_location` varchar(255) NOT NULL,\n `hide` int(1) NOT NULL,\n `small` varchar(255) NOT NULL,\n `userhide` int(1) NOT NULL,\n `likes` int(10) NOT NULL,\n `hot` int(1) NOT NULL,\n PRIMARY KEY (`pic_id`),\n UNIQUE KEY `pic_location` (`pic_location`),\n UNIQUE KEY `small` (`small`),\n KEY `fbid` (`fbid`),\n KEY `hide` (`hide`),\n KEY `userhide` (`userhide`)\n) ENGINE=MyISAM AUTO_INCREMENT=42749 DEFAULT CHARSET=latin1\n</code></pre>\n"},{"tags":["database","image","query","sd-card","pictures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12506523,"title":"database name for android SD card stored images","body":"<p>what do i put for database name,  like SQLiteDatabase db;  and you put \"db\" for the name of the database when using the query method.  however what do you put for the name when using the query method on the built in database that is used by the android system when storing pictures on the external SD card.  on my phone the file is called external7e47564.db or just external7e47564 and the table name is images.</p>\n\n<pre><code>  SQLiteDatabase db...\n  String displayName;\n  Cursor c = db.query( \"pictures\", null, \"fileName=pic01.png\", null, null, null, null );\n  c.moveToFirst();\n  if( !c.isAfterLast() )\n  displayName = c.getString(1);\n</code></pre>\n"},{"tags":["sql","query","join","isnull"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12506048,"title":"Changing IS NULL with (+) Syntax","body":"<p>I have this query :</p>\n\n<pre><code>SELECT B.id, B.name, D.id, D.name FROM TBB B, TDD D\nWHERE (D.id = B.id OR D.id IS NULL)\n</code></pre>\n\n<p>From what I thought, <code>(D.id = B.id OR D.id IS NULL)</code> will show record that have id in both table TBB and TDD the but also show all of <code>B.id</code> records even if both table doesn't have the same id because of <code>D.id IS NULL</code></p>\n\n<p>So, Is this the same one like my above query :</p>\n\n<pre><code> SELECT B.id, B.name, D.id, D.name FROM TBB B, TDD D\n    WHERE B.id = D.id (+)\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","query","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12500772,"title":"Anyone advise about SQL queries and grouping 15 min interval data in to days?","body":"<p>I'm hoping someone can answer this question about an SQL query I'm tyring to write, it's probably fairly basic but it's driving me nuts.</p>\n\n<p>I have a table which contains data which is written every 15 minutes for some agents logged in to a telephone system.  Here's a sample of some of the fields setup, there's more but I'm keeping things simple and quick to type</p>\n\n<pre><code>FieldName          Size  Type\nBeginTimePeriodDt  93    datetime\nUser_Id            12    varchar\nEndTimePeriodDt    93    datetime\nTotalLoginTime      4    int\n</code></pre>\n\n<p>And a sample of what the data is.  There's a lot more agents but I've kept it simple again.</p>\n\n<pre><code>BeginTimePeriodDT    User_ID EndTimePeriodDt      TotalLoginTime\n2012-09-10 13:30:00  XXXXXX  2012-09-10 13:45:00  35\n2012-09-10 13:30:00  YYYYYY  2012-09-10 13:45:00  900\n2012-09-10 13:45:00  XXXXXX  2012-09-10 14:00:00  900\n2012-09-10 13:45:00  YYYYYY  2012-09-10 14:00:00  600\n2012-09-10 14:00:00  XXXXXX  2012-09-10 14:15:00  250\n2012-09-10 14:00:00  YYYYYY  2012-09-10 14:15:00  95\n2012-09-11 13:30:00  XXXXXX  2012-09-11 13:45:00  35\n2012-09-11 13:30:00  YYYYYY  2012-09-11 13:45:00  900\n2012-09-11 13:45:00  XXXXXX  2012-09-11 14:00:00  900\n2012-09-11 13:45:00  YYYYYY  2012-09-11 14:00:00  600\n2012-09-11 14:00:00  XXXXXX  2012-09-11 14:15:00  250\n2012-09-11 14:00:00  YYYYYY  2012-09-11 14:15:00  95\n</code></pre>\n\n<p>As you can see every agent logged in gets a record written every 15 minutes.  What I'm trying to do is takes those records and add up the log in time.  Now if the table only contained 1 days records per agent then it would be a very easy thing to do, but...</p>\n\n<p>the table contains records for multiple days 15 minute intervals per agent :-(</p>\n\n<p>The bit I'm having the trouble with is figuring out how to group and add an agents intervals per day up and return a daily total.</p>\n\n<p>So I want to end up with something like</p>\n\n<pre><code>2012-09-10 XXXXXX 1185\n2012-09-11 XXXXXX 1185\n2012-09-10 YYYYYY 2000\n2012-09-11 YYYYYY 1300\n</code></pre>\n\n<p>(I know my maths don't add up to the data above, I  can't be arsed working the sums out :-P)</p>\n\n<p>I'd be much appreciated if someone could come up with an answer for me.</p>\n"},{"tags":["sql-server","query"],"answer_count":6,"favorite_count":6,"up_vote_count":20,"down_vote_count":0,"view_count":56655,"score":20,"question_id":1136380,"title":"SQL WHERE.. IN clause multiple columns","body":"<p>i need to implement the following query in SQL Server</p>\n\n<pre><code>select *\nfrom table1\nWHERE  (CM_PLAN_ID,Individual_ID)\nIN\n(\n Select CM_PLAN_ID, Individual_ID\n From CRM_VCM_CURRENT_LEAD_STATUS\n Where Lead_Key = :_Lead_Key\n)\n</code></pre>\n\n<p>but the WHERE..IN clause allows only 1 column. How to compare 2 or more columns with another inner select?</p>\n"},{"tags":["query","commit","derby","rollback","javadb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12505817,"title":"How to insert data to different table and rollback if transaction fails in Java DB derby","body":"<p>How to Insert / delete / Update two or more queries. Commit the Transaction if all query executed else roll back to previous.</p>\n"},{"tags":["php","mysql","wordpress","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12489015,"title":"mysql query returns only one word of string","body":"<p>I am using php and javascript to create a dynamicly populated autocomplete search engine for my wordpress site.</p>\n\n<p>Example: user wants to search for \"Nike Shoes\" so they type in Nike Shoes into the search engine and they should see Nike Shoes as a suggestion after they type the first 3 letters.</p>\n\n<p>I am having an issue where only the word Nike shows up as a suggestion. This happens with any terms you type into the search engine. Only the first word of the string will show up. I am sure it's to do with the spaces in between words but not so sure on how to fix it. </p>\n\n<p>Here is my code that is populating the autocomplete dynamically:</p>\n\n<pre><code>var availableTags = '&lt;?php $result = mysql_query(\"select * from state\"); \n                    $row = mysql_fetch_array($result); \n                    echo $row['name']; ?&gt;'.split(\" \");\n                    $( \"#title\" ).autocomplete({\n                    source: availableTags,\n                    minLength: 3,\n                    position: { my : \"left top\", at: \"left top\" },\n                    appendTo: \"#search-container\"\n                    });\n                    });\n</code></pre>\n\n<p>I created this code from this site: <a href=\"http://www.tizag.com/mysqlTutorial/mysqlquery.php\" rel=\"nofollow\">http://www.tizag.com/mysqlTutorial/mysqlquery.php</a></p>\n\n<p>If someone could please help me I would be very greatful.</p>\n\n<p>Thanks,</p>\n\n<p>Steve</p>\n"}]}
