{"total":102597,"page":1,"pagesize":100,"questions":[{"tags":["sql","asp.net-mvc","vb.net","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13297880,"title":"Sequence contains no elements - LINQ, MVC, Average","body":"<p>I am running into this error. I see that the reason is because the average returned at times is 0.00 which from a data stand point is accurate. This SQL query works fine, but that is because it puts in 0.00 automatically. </p>\n\n<p>LINQ complains and so I tried using DefaultIfEmpty() but it says it is expecting my ViewModel.</p>\n\n<pre><code>Dim ticketCounts = From t In queue _\n   Where _\n    (t.StatusId = 2) And _\n    (t.CloseDate.Year = Convert.ToDateTime(DateTime.Now).Year) And _\n    (t.ResolutionDays &gt; 0)\n   Group t By _\n    Column1 = CType(t.CloseDate.Month, Integer), _\n    Column2 = CType(t.CloseDate.ToString(\"MMMM\"), String) _\n    Into g = Group _\n   Order By Column1 _\n   Select _\n    Id = Column1, _\n    Month = Column2, _\n    Critical = g.Where(Function(t) t.PriorityId = 1).Average(Function(t) t.ResolutionDays), _\n    High = g.Where(Function(t) t.PriorityId = 2).Average(Function(t) t.ResolutionDays), _\n    Normal = g.Where(Function(t) t.PriorityId = 3).Average(Function(t) t.ResolutionDays), _\n    Low = g.Where(Function(t) t.PriorityId = 4).Average(Function(t) t.ResolutionDays), _\n    Total = g.Where(Function(t) t.Id &lt;&gt; Nothing).Average(Function(t) t.ResolutionDays)\n</code></pre>\n\n<p><strong>UPDATED!</strong>\nThis is the SQL query doing the same thing I need VB to do.</p>\n\n<pre><code>SELECT\n    DATENAME(MONTH,t.CloseDate) AS 'Month',\n    AVG(CASE WHEN (t.PriorityId = 1) THEN CAST(t.ResolutionDays AS Decimal(18, 2)) ELSE 0 END) AS 'Critical',\n    AVG(CASE WHEN (t.PriorityId = 2) THEN CAST(t.ResolutionDays AS Decimal(18, 2)) ELSE 0 END) AS 'High',\n    AVG(CASE WHEN (t.PriorityId = 3) THEN CAST(t.ResolutionDays AS Decimal(18, 2)) ELSE 0 END) AS 'Normal',\n    AVG(CASE WHEN (t.PriorityId = 4) THEN CAST(t.ResolutionDays AS Decimal(18, 2)) ELSE 0 END) AS 'Low',\n    AVG(CAST(t.ResolutionDays AS Decimal(18, 2))) AS 'Monthly Average'\nFROM\n    tblMaintenanceTicket t\nWHERE\n    t.StatusId = 2\n    AND YEAR(t.CloseDate) = year(getdate())\nGROUP BY \n    MONTH(t.CloseDate),\n    DATENAME(MONTH,t.CloseDate)\nORDER BY\n    MONTH(t.CloseDate)\n</code></pre>\n"},{"tags":["sql","sql-server","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13298432,"title":"SQL Nested JOIN","body":"<p>I am attemping to do a nested join from 2 sets of unioned tables.   I do not understand why I am getting the following errors:</p>\n\n<blockquote>\n  <p>Msg 156, Level 15, State 1, Line 15 Incorrect syntax near the keyword\n  'INNER'. Msg 156, Level 15, State 1, Line 24 Incorrect syntax near the\n  keyword 'On'.</p>\n</blockquote>\n\n<p>I assume based on the errors there is a problem with my ()'s but the syntax does follow the language shown from <a href=\"http://msdn.microsoft.com/en-us/library/office/bb208854%28v=office.12%29.aspx\" rel=\"nofollow\">Inner Join Operation</a>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>SELECT TOP 1000\n\nPus.SerialnoId,Hus.RT,Hus.DIVISION,Hus.REGION,Hus.ADJHSG,Hus.ADJINC,Hus.WGTP,Hus.NP,Hus.TYPE,Hus.ACR,Hus.AGS,Hus.BLD,Hus.BUS,Hus.CONP,Hus.ELEP,Hus.FS,Hus.FULP,Hus.GASP,Hus.HFL,Hus.INSP,Hus.KIT,Hus.MHP,Hus.MRGI,Hus.MRGP,Hus.MRGT,Hus.MRGX,Hus.RNTM,Hus.RNTP,Hus.SMP,Hus.TEL,Hus.TEN,Hus.VACS,Hus.VEH,Hus.WATP,Hus.YBL,Hus.FES,Hus.FINCP,Hus.FPARC,Hus.GRNTP,Hus.GRPIP,Hus.HHL,Hus.HHT,Hus.HINCP,Hus.HUGCL,Hus.HUPAC,Hus.HUPAOC,Hus.HUPARC,Hus.LNGI,Hus.MV,Hus.NOC,Hus.NPF,Hus.NPP,Hus.NR,Hus.NRC,Hus.OCPIP,Hus.PARTNER,Hus.PSF,Hus.R18,Hus.R60,Hus.R65,Hus.RESMODE,Hus.SMOCP,Hus.SMX,Hus.SRNT,Hus.SVAL,Hus.TAXP,Hus.WIF,Hus.WKEXREL,Hus.WORKSTAT,Hus.FACRP,Hus.FAGSP,Hus.FBDSP,Hus.FBLDP,Hus.FBUSP,Hus.FCONP,Hus.FELEP,Hus.FFSP,Hus.FFULP,Hus.FGASP,Hus.FHFLP,Hus.FINSP,Hus.FKITP,Hus.FMHP,Hus.FMRGIP,Hus.FMRGP,Hus.FMRGTP,Hus.FMRGXP,Hus.FPLMP,Hus.FRMSP,Hus.FRNTMP,Hus.FRNTP,Hus.FSMP,Hus.FSMXHP,Hus.FSMXSP,Hus.FTAXP,Hus.FTELP,Hus.FTENP,Hus.FVACSP,Hus.FVALP,Hus.FVEHP,Hus.FWATP,Hus.FYBLP,Hus.WGTP1,Hus.WGTP2,Hus.WGTP3,Hus.WGTP4,Hus.WGTP5,Hus.WGTP6,Hus.WGTP7,Hus.WGTP8,Hus.WGTP9,Hus.WGTP10,Hus.WGTP11,Hus.WGTP12,Hus.WGTP13,Hus.WGTP14,Hus.WGTP15,Hus.WGTP16,Hus.WGTP17,Hus.WGTP18,Hus.WGTP19,Hus.WGTP20,Hus.WGTP21,Hus.WGTP22,Hus.WGTP23,Hus.WGTP24,Hus.WGTP25,Hus.WGTP26,Hus.WGTP27,Hus.WGTP28,Hus.WGTP29,Hus.WGTP30,Hus.WGTP31,Hus.WGTP32,Hus.WGTP33,Hus.WGTP34,Hus.WGTP35,Hus.WGTP36,Hus.WGTP37,Hus.WGTP38,Hus.WGTP39,Hus.WGTP40,Hus.WGTP41,Hus.WGTP42,Hus.WGTP43,Hus.WGTP44,Hus.WGTP45,Hus.WGTP46,Hus.WGTP47,Hus.WGTP48,Hus.WGTP49,Hus.WGTP50,Hus.WGTP51,Hus.WGTP52,Hus.WGTP53,Hus.WGTP54,Hus.WGTP55,Hus.WGTP56,Hus.WGTP57,Hus.WGTP58,Hus.WGTP59,Hus.WGTP60,Hus.WGTP61,Hus.WGTP62,Hus.WGTP63,Hus.WGTP64,Hus.WGTP65,Hus.WGTP66,Hus.WGTP67,Hus.WGTP68,Hus.WGTP69,Hus.WGTP70,Hus.WGTP71,Hus.WGTP72,Hus.WGTP73,Hus.WGTP74,Hus.WGTP75,Hus.WGTP76,Hus.WGTP77,Hus.WGTP78,Hus.WGTP79,Hus.WGTP80 \n,Pus.RT,Pus.SPORDER,Pus.ST,Pus.ADJINC,Pus.PWGTP,Pus.AGEP,Pus.CIT,Pus.COW,Pus.DDRS,Pus.DEYE,Pus.DOUT,Pus.DPHY,Pus.DREM,Pus.ENG,Pus.FER,Pus.GCL,Pus.GCM,Pus.GCR,Pus.INTP,Pus.JWMNP,Pus.JWRIP,Pus.JWTR,Pus.LANX,Pus.MAR,Pus.MIG,Pus.MIL,Pus.MLPA,Pus.MLPB,Pus.MLPC,Pus.MLPD,Pus.MLPE,Pus.MLPF,Pus.MLPG,Pus.MLPH,Pus.MLPI,Pus.MLPJ,Pus.MLPK,Pus.NWAB,Pus.NWAV,Pus.NWLA,Pus.NWLK,Pus.NWRE,Pus.OIP,Pus.PAP,Pus.RETP,Pus.SCH,Pus.SCHG,Pus.SCHL,Pus.SEMP,Pus.SEX,Pus.SSIP,Pus.SSP,Pus.WAGP,Pus.WKHP,Pus.WKL,Pus.WKW,Pus.YOEP,Pus.ANC,Pus.ANC1P,Pus.ANC2P,Pus.DECADE,Pus.DRIVESP,Pus.ESP,Pus.ESR,Pus.HISP,Pus.INDP,Pus.JWAP,Pus.JWDP,Pus.LANP,Pus.MIGPUMA,Pus.MIGSP,Pus.MSP,Pus.NAICSP,Pus.NATIVITY,Pus.OC,Pus.PAOC,Pus.PERNP,Pus.PINCP,Pus.POBP,Pus.POVPIP,Pus.POWPUMA,Pus.POWSP,Pus.QTRBIR,Pus.RAC1P,Pus.RAC2P,Pus.RAC3P,Pus.RACAIAN,Pus.RACASN,Pus.RACBLK,Pus.RACNHPI,Pus.RACNUM,Pus.RACSOR,Pus.RACWHT,Pus.RC,Pus.SFN,Pus.SFR,Pus.VPS,Pus.WAOB,Pus.FAGEP,Pus.FANCP,Pus.FCITP,Pus.FCOWP,Pus.FDDRSP,Pus.FDEYEP,Pus.FDOUTP,Pus.FDPHYP,Pus.FDREMP,Pus.FENGP,Pus.FESRP,Pus.FFERP,Pus.FGCLP,Pus.FGCMP,Pus.FGCRP,Pus.FHISP,Pus.FINDP,Pus.FINTP,Pus.FJWDP,Pus.FJWMNP,Pus.FJWRIP,Pus.FJWTRP,Pus.FLANP,Pus.FLANXP,Pus.FMARP,Pus.FMIGP,Pus.FMIGSP,Pus.FMILPP,Pus.FMILSP,Pus.FOCCP,Pus.FOIP,Pus.FPAP,Pus.FPOBP,Pus.FPOWSP,Pus.FRACP,Pus.FRELP,Pus.FRETP,Pus.FSCHGP,Pus.FSCHLP,Pus.FSCHP,Pus.FSEMP,Pus.FSEXP,Pus.FSSIP,Pus.FSSP,Pus.FWAGP,Pus.FWKHP,Pus.FWKLP,Pus.FWKWP,Pus.FYOEP,Pus.PWGTP1,Pus.PWGTP2,Pus.PWGTP3,Pus.PWGTP4,Pus.PWGTP5,Pus.PWGTP6,Pus.PWGTP7,Pus.PWGTP8,Pus.PWGTP9,Pus.PWGTP10,Pus.PWGTP11,Pus.PWGTP12,Pus.PWGTP13,Pus.PWGTP14,Pus.PWGTP15,Pus.PWGTP16,Pus.PWGTP17,Pus.PWGTP18,Pus.PWGTP19,Pus.PWGTP20,Pus.PWGTP21,Pus.PWGTP22,Pus.PWGTP23,Pus.PWGTP24,Pus.PWGTP25,Pus.PWGTP26,Pus.PWGTP27,Pus.PWGTP28,Pus.PWGTP29,Pus.PWGTP30,Pus.PWGTP31,Pus.PWGTP32,Pus.PWGTP33,Pus.PWGTP34,Pus.PWGTP35,Pus.PWGTP36,Pus.PWGTP37,Pus.PWGTP38,Pus.PWGTP39,Pus.PWGTP40,Pus.PWGTP41,Pus.PWGTP42,Pus.PWGTP43,Pus.PWGTP44,Pus.PWGTP45,Pus.PWGTP46,Pus.PWGTP47,Pus.PWGTP48,Pus.PWGTP49,Pus.PWGTP50,Pus.PWGTP51,Pus.PWGTP52,Pus.PWGTP53,Pus.PWGTP54,Pus.PWGTP55,Pus.PWGTP56,Pus.PWGTP57,Pus.PWGTP58,Pus.PWGTP59,Pus.PWGTP60,Pus.PWGTP61,Pus.PWGTP62,Pus.PWGTP63,Pus.PWGTP64,Pus.PWGTP65,Pus.PWGTP66,Pus.PWGTP67,Pus.PWGTP68,Pus.PWGTP69,Pus.PWGTP70,Pus.PWGTP71,Pus.PWGTP72,Pus.PWGTP73,Pus.PWGTP74,Pus.PWGTP75,Pus.PWGTP76,Pus.PWGTP77,Pus.PWGTP78,Pus.PWGTP79,Pus.PWGTP80\n\nFROM \n\n    (select * FROM \n        (select serialnoId,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,KIT,MHP,MRGI,MRGP,MRGT,MRGX,RNTM,RNTP,SMP,TEL,TEN,VACS,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,LNGI,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP,FPLMP,FRMSP,FRNTMP,FRNTP,FSMP,FSMXHP,FSMXSP,FTAXP,FTELP,FTENP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80 from dbo.AcsBy320052007Hus\n        UNION ALL \n        select serialnoId,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,KIT,MHP,MRGI,MRGP,MRGT,MRGX,RNTM,RNTP,SMP,TEL,TEN,VACS,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,LNGI,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP, FPLMP,FRMSP,FRNTMP,FRNTP,FSMP,FSMXHP,FSMXSP,FTAXP,FTELP,FTENP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80 from dbo.AcsBy320082010Hus \n        ) AS Hus\n    )\n    INNER JOIN \n    (select * FROM \n        (\n        SELECT serialnoId,RT,SPORDER,PUMA,ST,ADJINC,PWGTP,AGEP,CIT,COW,DDRS,DEYE,DOUT,DPHY,DREM,ENG,FER,GCL,GCM,GCR,INTP,JWMNP,JWRIP,JWTR,LANX,MAR,MIG,MIL,MLPA,MLPB,MLPC,MLPD,MLPE,MLPF,MLPG,MLPH,MLPI,MLPJ,MLPK,NWAB,NWAV,NWLA,NWLK,NWRE,OIP,PAP,RETP,SCH,SCHG,SCHL,SEMP,SEX,SSIP,SSP,WAGP,WKHP,WKL,WKW,YOEP,ANC,ANC1P,ANC2P,DECADE,DRIVESP,ESP,ESR,HISP,INDP,JWAP,JWDP,LANP,MIGPUMA,MIGSP,MSP,NAICSP,NATIVITY,OC,PAOC,PERNP,PINCP,POBP,POVPIP,POWPUMA,POWSP,QTRBIR,RAC1P,RAC2P,RAC3P,RACAIAN,RACASN,RACBLK,RACNHPI,RACNUM,RACSOR,RACWHT,RC,SFN,SFR,VPS,WAOB,FAGEP,FANCP,FCITP,FCOWP,FDDRSP,FDEYEP,FDOUTP,FDPHYP,FDREMP,FENGP,FESRP,FFERP,FGCLP,FGCMP,FGCRP,FHISP,FINDP,FINTP,FJWDP,FJWMNP,FJWRIP,FJWTRP,FLANP,FLANXP,FMARP,FMIGP,FMIGSP,FMILPP,FMILSP,FOCCP,FOIP,FPAP,FPOBP,FPOWSP,FRACP,FRELP,FRETP,FSCHGP,FSCHLP,FSCHP,FSEMP,FSEXP,FSSIP,FSSP,FWAGP,FWKHP,FWKLP,FWKWP,FYOEP,PWGTP1,PWGTP2,PWGTP3,PWGTP4,PWGTP5,PWGTP6,PWGTP7,PWGTP8,PWGTP9,PWGTP10,PWGTP11,PWGTP12,PWGTP13,PWGTP14,PWGTP15,PWGTP16,PWGTP17,PWGTP18,PWGTP19,PWGTP20,PWGTP21,PWGTP22,PWGTP23,PWGTP24,PWGTP25,PWGTP26,PWGTP27,PWGTP28,PWGTP29,PWGTP30,PWGTP31,PWGTP32,PWGTP33,PWGTP34,PWGTP35,PWGTP36,PWGTP37,PWGTP38,PWGTP39,PWGTP40,PWGTP41,PWGTP42,PWGTP43,PWGTP44,PWGTP45,PWGTP46,PWGTP47,PWGTP48,PWGTP49,PWGTP50,PWGTP51,PWGTP52,PWGTP53,PWGTP54,PWGTP55,PWGTP56,PWGTP57,PWGTP58,PWGTP59,PWGTP60,PWGTP61,PWGTP62,PWGTP63,PWGTP64,PWGTP65,PWGTP66,PWGTP67,PWGTP68,PWGTP69,PWGTP70,PWGTP71,PWGTP72,PWGTP73,PWGTP74,PWGTP75,PWGTP76,PWGTP77,PWGTP78,PWGTP79,PWGTP80 FROM dbo.AcsBy320052007Pus\n        UNION ALL \n        select serialnoId,RT,SPORDER,PUMA,ST,ADJINC,PWGTP,AGEP,CIT,COW,DDRS,DEYE,DOUT,DPHY,DREM,ENG,FER,GCL,GCM,GCR,INTP,JWMNP,JWRIP,JWTR,LANX,MAR,MIG,MIL,MLPA,MLPB,MLPC,MLPD,MLPE,MLPF,MLPG,MLPH,MLPI,MLPJ,MLPK,NWAB,NWAV,NWLA,NWLK,NWRE,OIP,PAP,RETP,SCH,SCHG,SCHL,SEMP,SEX,SSIP,SSP,WAGP,WKHP,WKL,WKW,YOEP,ANC,ANC1P,ANC2P,DECADE,DRIVESP,ESP,ESR,HISP,INDP,JWAP,JWDP,LANP,MIGPUMA,MIGSP,MSP,NAICSP,NATIVITY,OC,PAOC,PERNP,PINCP,POBP,POVPIP,POWPUMA,POWSP,QTRBIR,RAC1P,RAC2P,RAC3P,RACAIAN,RACASN,RACBLK,RACNHPI,RACNUM,RACSOR,RACWHT,RC,SFN,SFR,VPS,WAOB,FAGEP,FANCP,FCITP,FCOWP,FDDRSP,FDEYEP,FDOUTP,FDPHYP,FDREMP,FENGP,FESRP,FFERP,FGCLP,FGCMP,FGCRP,FHISP,FINDP,FINTP,FJWDP,FJWMNP,FJWRIP,FJWTRP,FLANP,FLANXP,FMARP,FMIGP,FMIGSP,FMILPP,FMILSP,FOCCP,FOIP,FPAP,FPOBP,FPOWSP,FRACP,FRELP,FRETP,FSCHGP,FSCHLP,FSCHP,FSEMP,FSEXP,FSSIP,FSSP,FWAGP,FWKHP,FWKLP,FWKWP,FYOEP,PWGTP1,PWGTP2,PWGTP3,PWGTP4,PWGTP5,PWGTP6,PWGTP7,PWGTP8,PWGTP9,PWGTP10,PWGTP11,PWGTP12,PWGTP13,PWGTP14,PWGTP15,PWGTP16,PWGTP17,PWGTP18,PWGTP19,PWGTP20,PWGTP21,PWGTP22,PWGTP23,PWGTP24,PWGTP25,PWGTP26,PWGTP27,PWGTP28,PWGTP29,PWGTP30,PWGTP31,PWGTP32,PWGTP33,PWGTP34,PWGTP35,PWGTP36,PWGTP37,PWGTP38,PWGTP39,PWGTP40,PWGTP41,PWGTP42,PWGTP43,PWGTP44,PWGTP45,PWGTP46,PWGTP47,PWGTP48,PWGTP49,PWGTP50,PWGTP51,PWGTP52,PWGTP53,PWGTP54,PWGTP55,PWGTP56,PWGTP57,PWGTP58,PWGTP59,PWGTP60,PWGTP61,PWGTP62,PWGTP63,PWGTP64,PWGTP65,PWGTP66,PWGTP67,PWGTP68,PWGTP69,PWGTP70,PWGTP71,PWGTP72,PWGTP73,PWGTP74,PWGTP75,PWGTP76,PWGTP77,PWGTP78,PWGTP79,PWGTP80 FROM dbo.AcsBy320082010Pus\n        ) AS Pus\n    )\n\nOn Hus.SerialNoId = Pus.SerialNoId\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13298029,"title":"How to get rolling yearly totals for a range months","body":"<p>I am trying to get a rolling 12 month total from a set of data that provides the minutes for a given month and year.  In many cases, I will not have a a record for a month.  Is there a way to display the missing months with a zero (0) for the value and then roll it up or not display them but have the query acknowledge this as part of the 12 month range.  The below query is what I was trying to use but it just grabs the prior records and does not take into account missing months.  The query below does not seems to be off a little with some of the totals.  Any assistance would be greatly appreciated.</p>\n\n<pre><code>    Select year\n         , month\n         , SUM(NVL(minutes, 0)) OVER (order by year,month rows between 11 preceding and current row) as total_minutes\n    from\n    (\n    Select *  \n    from test_table\n    Order by year, month\n    )\n    Order by year desc , month desc\n</code></pre>\n\n<p>Here is the sql to create the test table and data.</p>\n\n<pre><code>      drop table test_table;\n            create table test_table (\n      month    number(2),\n      year     number(4),\n      minutes  number(4,2)\n    );\n\n    insert into test_table values ( 1, 2012, 3 );\n    insert into test_table values ( 2, 2012, 3 );\n    insert into test_table values ( 3, 2012, 3 );\n    insert into test_table values ( 4, 2012, 4 );\n    insert into test_table values ( 5, 2012, 5 );\n    insert into test_table values ( 7, 2012, 5 );\n    insert into test_table values ( 8, 2012, 5 );\n    insert into test_table values ( 9, 2012, 5 );\n    insert into test_table values (10, 2012, 4 );\n    insert into test_table values (11, 2012, 3 );\n    insert into test_table values (12, 2012, 3 );\n    insert into test_table values ( 1, 2011, 3 );\n    insert into test_table values ( 2, 2011, 3 );\n    insert into test_table values ( 5, 2011, 5 );\n    insert into test_table values ( 6, 2011, 5 );\n    insert into test_table values ( 7, 2011, 5 );\n    insert into test_table values ( 8, 2011, 5 );\n    insert into test_table values ( 9, 2011, 5 );\n    insert into test_table values (10, 2011, 4 );\n    insert into test_table values (11, 2011, 3 );\n    insert into test_table values (12, 2011, 3 );\n    insert into test_table values ( 1, 2010, 3 );\n    insert into test_table values ( 2, 2010, 3 );\n    insert into test_table values ( 3, 2010, 3 );\n    insert into test_table values ( 4, 2010, 4 );\n    insert into test_table values ( 5, 2010, 4 );\n    insert into test_table values ( 6, 2010, 5 );\n    insert into test_table values ( 7, 2010, 5 );\n    insert into test_table values (10, 2010, 4 );\n    insert into test_table values (11, 2010, 4 );\n    insert into test_table values (12, 2010, 3 );\n\n    COMMIT;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":31,"score":0,"question_id":13297547,"title":"SQL Server and implicit conversion of types","body":"<p>Where does SQL Server do implicit conversion and what are the rules it follows? I.E when does it convert the left side of the equality operator over the right side?</p>\n\n<pre>Foobar\nid int not null \nquantity int not null\nquantityTest byte not null\ndate varchar(20) not null\ndateTest datetime</pre>\n\n<pre><code>SELECT id\nFROM Foobar\nWHERE quantity &gt; '3'\n\nSELECT id\nFROM foobar\nWHERE quantityTest &gt; 3\n\nSelect id\nFROM foobar\nWHERE date = 20120101\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12,"score":2,"question_id":13298196,"title":"Configure SQL server to store UTC date Time","body":"<p>Is There some way to configure sql server to store UTC time in the database if passed local date time values??</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13278535,"title":"Joining 3 tables to return each user's questionnaires between two dates (my challenging query)","body":"<p>I'll try to be brief and cut-to-the-chase as possible here.\nThese are my tables:</p>\n\n<p><strong>questionnaire:</strong> </p>\n\n<ul>\n<li>id[pk], </li>\n<li>name, </li>\n<li>type</li>\n</ul>\n\n<p><strong>user_x_questionnaire:</strong> </p>\n\n<ul>\n<li>id[pk],</li>\n<li>userid[fk],</li>\n<li>questionnaireid[fk references questionnaire.id]</li>\n<li>completedstate,</li>\n<li>iteration</li>\n</ul>\n\n<p><strong>questionnaire_time</strong></p>\n\n<ul>\n<li>id[pk]</li>\n<li>questionnaireid[fk references questionnaire.id]</li>\n<li>iteration</li>\n<li>publishdate[date/time]</li>\n<li>deadline[date/time]</li>\n</ul>\n\n<p>So, users want to fill out some questionnaires. Each user can be assigned to one or more that one questionnaire to fill (user_x_questionnaire). depending on the questionnaire type (one time or frequent) each questionnaire can be filled by the user more than once, therefore questionnaire_time table stores the publishdate and deadline of each of these times.</p>\n\n<p>What I want is a query that displays all the current questionnaires that the user is supposed to answer. That means the time of the questionnaire should be between publishdate and deadline. I went very close to the answer of this query until I realized all my returned results produce the same publish and deadline which is not what I wanted. This is my solution so far.</p>\n\n<pre><code>SELECT * FROM (\n   SELECT DISTINCT questionnaire.id\n        , questionnaire.`name`\n        , user_x_questionnaire.iteration\n        , completedstate\n        , questionnaire_time.publishdate\n        , questionnaire_time.deadline\n   FROM user_x_questionnaire\n      , questionnaire_time\n      , questionnaire \n   WHERE  userid={USERID} \n      AND user_x_questionnaire.questionnaireid=questionnaire.id\n      AND questionnaire.`type`='frequent' \n      AND user_x_questionnaire.questionnaireid=questionnaire_time.questionnaireid\n   ) As result\nWHERE '{CURRENT DATE}' BETWEEN publishdate AND deadline; \n</code></pre>\n\n<p>{USERID} and {CURRENT DATE} will be provided by the program.</p>\n"},{"tags":["mysql","sql","polling"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13298185,"title":"Polling every 40 secs, is this MySQL query inefficient?","body":"<p>I have a webpage which auto-updates a list of users and their comments every 30 seconds.</p>\n\n<p>There could be up to 300-400 users users on the site at a time.</p>\n\n<p>So every 30 secs, a PHP script is called via AJA which runs this:</p>\n\n<pre><code>SELECT `user` .*, by_user.name as updated_by \n                \"FROM `user`\n                \"LEFT JOIN `user` by_user ON ( `user`.last_updated_by = by_user.user_id ) \n                WHERE `user`.active= 1 AND `user`.group_id =.$group_id.\n                AND `user`.last_updated &gt; (NOW() - INTERVAL 30 SECOND)\n</code></pre>\n\n<p>Would it be better to not use that date calculation (NOW and INTERVAL) and instead record the datetime of the last poll and then check against that?</p>\n"},{"tags":["sql","azure","sync","schema-compare","azure-data-sync"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13290355,"title":"SQL Azure Data Sync service and schema update (Visual Studio Schema Compare)","body":"<p>I have a local SQL database (database first EF application) and an Azure database which are synced by the azure data sync service. </p>\n\n<p>Now what do I have to do to when I update the local schema of an table? Of course I have to update the schema in the sync service but that is not enough. The schema of the azure database isn't updated by the sync service itself.</p>\n\n<p>Before I used azure data sync I could simply call the sql schema compare from Visual Studio but now there are so many new tables that I don't know what to update and what not. </p>\n\n<p>When I update the azure database manually with the management portal the sync does work. But isn't this also possible via Visual Studio schema compare (or SQL SMMS)?</p>\n"},{"tags":["php","sql","magento"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13294786,"title":"Magento, programmatically adding category to products in script with SQL","body":"<p>I am in the process of determining the best way to programmatically add Categories to Products.  The Categories are obtained from third party data outside of the magento install, I then parse this data and want to update the magento: \"catalog_category_product\" table, associating found categories to their respective products.</p>\n\n<p>After adding a category to product association in \"catalog_category_product\" as test, the category did not appear on the magento front-end site.  After more searching I added an entry to the \"catalog_category_product_index\" table, the product now shows in the proper category on the front-end site.</p>\n\n<p>Is this all that is necessary?  I am afraid there are additional magento event hooks tied to the Products and Categories and they may be updating additional tables that I am not aware of.</p>\n\n<p>Can I add rows to these two tables with SQL without incident, or do I need to load the magento app and do this through the EAV Product and Category models?  Am I on the right track?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I am not actually 'importing' any new data.  The Products and Categories are in-place in the system already. I have also not added any custom observers and am using the vanilla Products and Categories models.</p>\n\n<p>I am parsing the text file to get the proper values and then using plain SQL UPDATE statements.</p>\n\n<p>I simply want to make sure that by taking this route, the only tables I need to programmatically update are 'catalog_category_product' and 'catalog_category_product_index'.  </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13296400,"title":"MSSQL select single row with all references counted","body":"<p>I am attempting to do something using MSSQL that I believe is possible (easily) but I do not know how to vocalize the correct search string. I have the situation below.</p>\n\n<pre><code>Table A\nUID  | Value....\n1    | a\n2    | b\n3    | c\n\n\nTable B\nPartTypes_uid_fk   | Value....\n1           | a\n1           | b\n1           | c\n1           | d\n1           | e\n3           | 67\n3           | 1354\n</code></pre>\n\n<p>I am attempting to get the following result, query Table A for all results {TableA.*} and on the same row result show the number of table b references {count TableB.tableA_fk}\nWhat I have so far is the following.</p>\n\n<p><code>SELECT DISTINCT t1.uid, CONVERT(varchar(MAX), t1.Name) AS Name, CONVERT(varchar(MAX), t1.Description) AS Description, \nCount(t2.Items_uid_fk) OVER (Partition By t2.PartTypes_uid_fk) as Count \nFROM [Table1] as t1 left outer join Table2 as t2 on t2.PartTypes_uid_fk=t1.uid;</code></p>\n\n<p>This works for all of Table A records with an associated record in Table B but if there are 0 entries in Table B it won't work. The conversion of the varchars was required due to the fact they are ntext format and it was distinct.</p>\n\n<p>Thank you for all your help in advance.\nStephen</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":6,"favorite_count":7,"up_vote_count":18,"down_vote_count":0,"view_count":2043,"score":18,"question_id":1597442,"title":"Subquery using Exists 1 or Exists *","body":"<p>I used to write my EXISTS checks like this:</p>\n\n<pre><code>IF EXISTS (SELECT * FROM TABLE WHERE Columns=@Filters)\nBEGIN\n   UPDATE TABLE SET ColumnsX=ValuesX WHERE Where Columns=@Filters\nEND\n</code></pre>\n\n<p>One of the DBA's in a previous life told me that when I do an <code>EXISTS</code> clause, use <code>SELECT 1</code> instead of <code>SELECT *</code></p>\n\n<pre><code>IF EXISTS (SELECT 1 FROM TABLE WHERE Columns=@Filters)\nBEGIN\n   UPDATE TABLE SET ColumnsX=ValuesX WHERE Columns=@Filters\nEND\n</code></pre>\n\n<p>Does this really make a difference?</p>\n"},{"tags":["sql","sql-server","reporting-services","sql-server-2008-r2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13297717,"title":"How can we send email with an attachment to 500 people using SQL Server (SSIS, SSRS or SQL AGENT)","body":"<p>I need your advice. How can we send email with an attachment to 500 users. We are using SQL Server 2008 R2 Enterprise edition in our company.</p>\n\n<p>I had tried using the <code>Send Mail</code> task from SSIS, but seems we can send maximum of 18 recipients due to the constraint in <code>To: Cc: Bcc:</code>.</p>\n\n<p>Is there any way we can send using SQL Agent or SSRS ??</p>\n\n<p>I have another doubt regarding SSRS report subscription recipients. </p>\n\n<p>To how many maximum number of recipients we can send report using subscription. The reason i am asking this second is if i can send a report to 500 users by using SSRS report subscription then i can use SSRS.</p>\n\n<p>Thanks for your time!! </p>\n"},{"tags":[".net","sql","json"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13298010,"title":"Need sample VB.NET Object to JSON","body":"<p>Trying to get pure JSON from .asmx page with SQL calls. Can't seem to get it. Every post I find is either in c# or not what I'm after. Serialization causes a 1 dimensional array issue. I need to get data from MS access database on my web server for small java app.</p>\n\n<pre><code>&lt;%@ WebService class=\"GetDBStudent\" %&gt;\n\nImports System.Web\nImports System.Web.Services\nImports System.Xml\nImports System.Web.Services.Protocols\nImports System.Web.Script.Services\nImports System.Data\nimports System.Web.Script.Serialization\n\n'&lt;System.Web.Script.Services.ScriptService()&gt; _\n&lt;WebService(Namespace:=\"com.mcfrsit.GetDBStudent\")&gt; _\n&lt;WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)&gt; _\nPublic Class GetDBStudent\nInherits System.Web.Services.WebService\nPublic Class Students\n    Public StudentID As String\n    Public LastName As String\n    Public FirstName As String\n    Public Affiliation As String\n    Public ClassName As String\n    Public DateCompleted As DateTime\nEnd Class\n\n&lt;WebMethod()&gt; _\n&lt;ScriptMethod(UseHttpGet:=False, ResponseFormat:=ResponseFormat.Json)&gt; _\nPublic Function GetArray() As Students()\n\n    ' Create a connection string\n    Dim DBConnection As String =        ConfigurationManager.ConnectionStrings(\"OdbcServices\").ToString\n    Dim sql As String = \"SELECT * FROM ClassRecordsEnrollmentsQry WHERE [Affiliation] = 'DFRS'\"\n    Dim Conn As New ADODB.Connection()\n    Dim rs As New ADODB.Recordset()\n\n    Dim daTitles As New Data.OleDb.OleDbDataAdapter()\n\n    Dim dsTitles As New DataSet(\"CrossTab\")\n    Conn.Open(DBConnection, \"\", \"\", -1)\n\n    Try\n        rs.Open(sql, DBConnection, ADODB.CursorTypeEnum.adOpenStatic, ADODB.LockTypeEnum.adLockBatchOptimistic, 1)\n\n        daTitles.Fill(dsTitles, rs, \"Students\")\n        'create object array, using row count as upper dim\n        Dim objStudents As Students() = New Students(dsTitles.Tables(0).Rows.Count - 1) {}\n\n        'loop through dataset to add data to object array\n        Dim intRsCount As Int16\n        For intRsCount = 0 To dsTitles.Tables(0).Rows.Count - 1\n            Dim intCsCount As Int16\n            For intCsCount = 0 To dsTitles.Tables(0).Columns.Count - 1\n                'Dim strColName As String = dsTitles.Tables(0).Columns(intCsCount)\n            Next\n            objStudents(intRsCount) = New Students\n            objStudents(intRsCount).StudentID = dsTitles.Tables(0).Rows(intRsCount)(0)\n            objStudents(intRsCount).LastName = dsTitles.Tables(0).Rows(intRsCount)(1)\n            objStudents(intRsCount).FirstName = dsTitles.Tables(0).Rows(intRsCount)(2)\n            objStudents(intRsCount).Affiliation = dsTitles.Tables(0).Rows(intRsCount)(3)\n            objStudents(intRsCount).ClassName = dsTitles.Tables(0).Rows(intRsCount)(4)\n            objStudents(intRsCount).DateCompleted = dsTitles.Tables(0).Rows(intRsCount)(5)\n        Next\n\n        'Return new JavaScriptSerializer().Serialize(objStudents)\n        Return objStudents\n\n    Catch ex As Exception\n        'Response.Write(\"Sorting is not supported in the view\")\n    Finally\n        Conn.Close()\n    End Try\nEnd Function\n\n\nEnd Class\n</code></pre>\n"},{"tags":["php","sql","fetchall"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":38,"score":0,"question_id":13297094,"title":"How do I use fetchAll in php?","body":"<p>I am using this statement to fetch the elements in a column in my db</p>\n\n<pre><code>$result = $stmt-&gt;fetchAll(PDO::FETCH_COLUMN, 0);\n</code></pre>\n\n<p>but I get this error when trying to run it.</p>\n\n<p>Call to undefined method <code>mysqli_stmt::fetchAll();</code></p>\n\n<p>Is there something I need to add to my php file to include that method or something?</p>\n\n<p>UPDATE 1:</p>\n\n<pre><code>class LoginAPI\n{\nprivate $db;\n\nfunction __construct() \n{\n    $this-&gt;db = new mysqli('xxx', 'xxx', 'xxx', 'xxx');\n    $this-&gt;db-&gt;autocommit(FALSE);\n}\n\nfunction __destruct() \n{\n    $this-&gt;db-&gt;close();\n}\n\nfunction login() \n{\n    if(isset($_POST[\"lang\"]))\n    {\n        $stmt = $this-&gt;db-&gt;prepare(\"SELECT code FROM locations\");\n        $stmt-&gt;execute();\n        $stmt-&gt;bind_result($code);\n\n        //while($stmt-&gt;fetch())\n        //{\n        //  result[] = \"code\"=&gt;$code;\n        //  break;\n        //}\n        $codeArr = array();\n        $result = $stmt-&gt;fetch_all();//|PDO::FETCH_GROUP;\n\n\n\n\n        sendResponse(200, json_encode($result));\n        return true;\n    }\n    sendResponse(400, 'Invalid Request');\n    return false;\n}\n}\n</code></pre>\n"},{"tags":["sql","sql-server","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13241518,"title":"sql query including month columns?","body":"<p>I was wondering if I could get some ideas or direction on a sql query that would output column months. Here is my current query..</p>\n\n<pre><code>select A.assetid, A.Acquisition_Cost, B.modepreciaterate from FA00100 A\ninner join FA00200 B on A.assetindex = B.assetindex\nwhere MoDepreciateRate != '0'\n</code></pre>\n\n<p>I would like to add more columns that look as such:</p>\n\n<pre><code>select assetid, acquisition_cost, perdeprrate, Dec_2012, Jan_2013, Feb_2013....\n\nwhere Dec_2012 = (acquisition_cost - MoDepreciateRate*(# of months))\nand Jan_2013 = (acquisition_cost - MoDepreciateRate*(# of months))\n</code></pre>\n\n<p>where # of months can be changed.</p>\n\n<p>Any help would be really appreciated. Thank you!</p>\n\n<p>Here is an example of what I would like the output to be with '# of months' = 4</p>\n\n<pre><code>assetid SHRTNAME    Acquisition_Cost    perdeprrate Dec_2012    Jan_2013    Feb_2013    Mar_2013\nCS-013  GEH INTEG   17490.14            485.83      17004.31    16518.48    16032.65    15546.82\nCS-014  WEB BRD     14560               404.4507    14155.5493  13751.0986  13346.6479  12942.1972\n</code></pre>\n"},{"tags":["php","mysql","sql","database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13200676,"title":"Multiple MySQL Database user logins conflicting","body":"<p>I have 2 databases that I INSERT INTO on my php page. I have anti-injection, however my problem lies in the following mysql_error(); message: INSERT command denied to user 'username'@'50.63.197.56' for table 'something_clients'.</p>\n\n<p>My first database is the 'username', and it cannot access the other database, which is good. However, I would my 2nd connection to access its database. Any help is greatly appreciated! Here is my code: \n</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php  \n{  \nrequire_once('client-config.php');  \n$link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);  \nif(!$link) {  \n    die('Failed to connect to server: ' . mysql_error());  \n}  \n$DBName1 = mysql_select_db(DB_DATABASE);  \nif(!$DBName1) {  \n    die(\"Unable to select database\");  \n}  \n    $sqv = \"CREATE TABLE `$DBName1`.`{$login}_weekly` (  \nDate1 int,  \nDate2 int,  \nDate3 int,   \nDate4 int,  \nDate5 int,  \nDate6 int,  \nDate7 int,  \nClientTotal int  \n)\";   \n    mysql_query($sqv,$link);  \n    mysql_close($link);  \n}  \n{  \nrequire_once('agent-config.php');  \n//Connect to mysql server  \n$link2 = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD, true);  \nif(!$link2) {  \n    die('Failed to connect to server: ' . mysql_error());  \n}  \n$DBName2 = mysql_select_db(DB_DATABASE);  \nif(!$DBName2) {  \n    die(\"Unable to select database\");  \n}  \n//Create INSERT query  \n$qry2 = \"INSERT INTO `$DBName2`.`{$agentlogin}_clients` (AgentClients)   VALUES('$login')\";  \n$result2 = @mysql_query($qry2);  \n    echo mysql_error($link2);  \nif($result2) {  \n    header(\"location: client-register-success.php\");  \n    exit();  \n}else {     \n    die(\"Query failed\");  \n}  \n}   \n?&gt;\n</code></pre>\n"},{"tags":["asp.net","sql","sql-server"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":12177545,"title":"Counting Duplicates from table","body":"<p>I have got a table which i have mentioned below, i need to get a total results avoiding duplicates , can any one provide any assistance or suggestions on how to get the results mentioned below, thankyu</p>\n\n<pre><code>ID      name    Total   Used\n24     John     5        2\n24     John     10       6\n27     Peter    20       0\n27     Peter    20       5\n</code></pre>\n\n<p>Result should be something like this </p>\n\n<pre><code>ID      name    Total   Used\n24     John     15       8\n27     Peter    40       5\n</code></pre>\n"},{"tags":["sql","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13297681,"title":"how to limit SQL query results based on data in second table?","body":"<p>I have an existing system with a USERS and GROUPS table.  I have JPA objects for User and Group.  </p>\n\n<p>Table USERGROUPS is a mapping of which users are in which groups, this table is not mapped to an object, I pretty much do a straight SQL query on it like so:</p>\n\n<pre><code>public List&lt;User&gt; getUsersByGroupId(long groupId) {\n  List&lt;User&gt; users = new ArrayList&lt;User&gt;();\n  String query = \"select USERGROUPS.USER_ID from USERGROUPS where USERGROUPS.GROUP_ID = ?1\";\n  Query q = getEntityManager().createNativeQuery(query, Long.class);\n  q.setParameter(1, groupId);\n  List&lt;Long&gt; userIds = new ArrayList&lt;Long&gt;();\n  usersIds.addAll(q.getResultList());\n  for (Long id : userIds) {\n    users.add(getUser(id));\n  } \n  return users;\n}\n</code></pre>\n\n<p>Everything works fine.</p>\n\n<p>Now I have a new application which wants to use a subset of the Users in the USERS table.</p>\n\n<p>The plan is to add a new table (because we don't want to modify the existing one) called MYAPP_USERS which consists of one column, the USER_ID of the users to list in MYAPP.</p>\n\n<p>So my question is, how to I modify my query to only return members of the group that are in the MYAPP_USERS table?</p>\n\n<p>That is, how do I do:</p>\n\n<pre><code>  String query = \"select USERGROUPS.USER_ID from USERGROUPS where USERGROUPS.GROUP_ID = ?1 and WHERE ?1 IS IN MYAPP_USERS\";\n</code></pre>\n\n<p>?</p>\n\n<p>Any help is greatly appreciated!</p>\n"},{"tags":["sql","query","coldfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13297652,"title":"Using BETWEEN on a varchar field not a numeric field?","body":"<p>I am using ColdFusion 8 and SQL Server 2008 R2.</p>\n\n<p>I am trying to query a column of values to get rows with a value within a range.  The column SHOULD be numeric, but it's not. It's setup as a varchar (by someone else). There are 100,000+ rows of data. Here's a FAKE sample of the data:</p>\n\n<pre><code>ID COLUMN\n1  1\n2  1.2 \n3  0.9 \n4  5 \n5  -6\n</code></pre>\n\n<p>My query looks like this:</p>\n\n<pre><code>select column\nfrom table\nwhere column between 1 and 2\n</code></pre>\n\n<p>This query won't run because the where statement's column is a varchar, and I get a conversion error, so I have to change the where statement to this:</p>\n\n<pre><code>where column between '1' and '2'\n</code></pre>\n\n<p>Now, when I run a query like this, it runs, but I don't get results. But I know that I should be seeing results, because I know that many of the values in the column field are within that range I am querying. </p>\n\n<p>I am wondering if I am seeing no results due to the field being a varchar and not a numeric. Might that be messing up my results?</p>\n\n<p>Also, we have 100,000+ records we are searching through, would there be a big performance hit by using a varchar field instead of a numeric field?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13297530,"title":"Retrieve a column from a table then insert it to a new table","body":"<p>I just created a table in SQL 2008. This table has two columns.</p>\n\n<pre><code>CREATE TABLE [dbo].[MyTable]\n(\n[pkey] [bigint] not null,\n[Number] [int]  not null\n)\n</code></pre>\n\n<p>Now I want to insert values into it. The first column can be obtained from another table <code>dbo.OldTable</code>. It has many records and I don't want to manually insert the data. The second column <code>Number</code> can be a <code>0</code> in each row. What is the best way to do this?</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":27,"score":4,"question_id":13297140,"title":"select where a and next is c, skipping b","body":"<p>I am wondering if it is possible in SQL to return a single row to show, using the table below as an example, only a row for id 2:</p>\n\n<pre><code>table1  ( id 2 and 4 are missing value b)\nid      value\n1         a\n1         b\n1         c\n1         d\n2         a\n2         c\n2         d \n3         a\n3         b\n3         c\n3         d\n4         a\n4         c\n4         d\n</code></pre>\n\n<p>i basically want to find all instances where 'b' does not exist but 'a' still does exist for any id and return a single row for that any given id. i have tried something like this, but its not working as i would want it to:</p>\n\n<pre><code>select * from table1 \n    where not exists (select distinct value from table1 where value b)   \n</code></pre>\n\n<p>i would like the end result to be something this, identifying the values where 'b' does not exist but 'a' does(not showing the value, is unneeded for final goal):</p>\n\n<pre><code>result table\nid        \n2           \n4          \n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13296853,"title":"SQL Server: how do I get data from a history table?","body":"<p>Can you please help me build an SQL query to retrieve data from a history table?</p>\n\n<p>I'm a newbie with only a one-week coding experience. I've been trying simple SELECT statements so far but have hit a stumbling block.</p>\n\n<p>My football club's database has three tables. The first one links balls to players:</p>\n\n<pre><code>BallDetail\n\n| BallID | PlayerID | TeamID |\n|-------------------|--------|\n|      1 |       11 |     21 |\n|      2 |       12 |     22 |\n</code></pre>\n\n<p>The second one lists things that happen to the balls:</p>\n\n<pre><code>BallEventHistory\n\n| BallID | Event |  EventDate |\n|--------|------ |------------|\n|      1 |  Pass | 2012-01-01 |\n|      1 | Shoot | 2012-02-01 |\n|      1 |  Miss | 2012-03-01 |\n|      2 |  Pass | 2012-01-01 |\n|      2 | Shoot | 2012-02-01 |\n</code></pre>\n\n<p>And the third one is a history change table. After a ball changes hands, history is recorded:</p>\n\n<pre><code>HistoryChanges\n\n| BallID | ColumnName | ValueOld | ValueNew |\n|--------|------------|----------|----------|\n|      2 |   PlayerID |       11 |       12 |\n|      2 |     TeamID |       21 |       22 |\n</code></pre>\n\n<p>I'm trying to obtain a table that would list all passes and shoots Player 11 had done to all balls before the balls went to other players. Like this:</p>\n\n<pre><code>| PlayerID | BallID | Event | Month |\n|----------|--------|-------|-------|\n|       11 |      1 |  Pass |   Jan |\n|       11 |      1 | Shoot |   Feb |\n|       11 |      2 |  Pass |   Jan |\n</code></pre>\n\n<p>I begin so:</p>\n\n<pre><code>SELECT PlayerID, BallID, Event, DateName(month, EventDate)\nFROM BallDetail bd INNER JOIN BallEventHistory beh ON bd.BallID = beh.BallID\nWHERE PlayerID = 11 AND Event IN (Pass, Shoot) ...\n</code></pre>\n\n<p>But how to make sure that Ball 2 also gets included despite being with another player now? </p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":32,"score":-2,"question_id":13296725,"title":"JOIN-ON vs just = in WHERE clause","body":"<p>Most RDBMSs support both syntaxes:</p>\n\n<pre><code>SELECT ...\nFROM table1 t1 JOIN table2 t2\nON t1.jfield = t2.jfield\n</code></pre>\n\n<p>as well as</p>\n\n<pre><code>SELECT ...\nFROM table1 t1, table2 t2\nWHERE t1.jfield = t2.jfield\n</code></pre>\n\n<p>Personally, I prefer the latter version because of less verbosity but does it presents any difference in performance and query execution?  I have seen people on this forum making remarks that the 2nd style is obsolete and does not perform as well.</p>\n"},{"tags":["sql","sql-server","stored-procedures","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13297046,"title":"How can I check one table for an entry but use default value if it doesn't exist?","body":"<p>I have 2 tables. <code>TableA</code> has columns <strong>OldLogin</strong> and <strong>NewLogin</strong>. <code>TableB</code> has <strong>ID</strong>, <strong>IsManager</strong>, and <strong>CanChange</strong>.</p>\n\n<p>I'm writing a stored procedure with an input parameter <code>login</code>. It needs ultimately return all columns in <code>TableB</code> where <code>login = ID</code> but it first needs to check <code>TableA</code> to see if it needs to use <strong>NewLogin</strong>. </p>\n\n<p>So, can someone help me write a query that says \"show me all columns in <code>TableB</code> where ID = (login OR NewLogin)\"?</p>\n\n<p>Thanks!</p>\n\n<p>EDIT: Added code:</p>\n\n<pre><code>DECLARE @login varchar(30) = 'test'\n\nSELECT ISNULL(NewLogin, @login) AS NewLogin, TableB .IsManager, TableB.CanChange\nFROM TableA\nLEFT JOIN TableB ON TableB.ID = ISNULL(NewLogin, @login)\nWHERE OldLogin = @login\n</code></pre>\n\n<p>THe above code works only if @login exists in TableA. I get no results if it doesn't exist in that table.</p>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13295323,"title":"sql query joining two columns with one","body":"<p>I have 2 tables in ms access 2010 as below  </p>\n\n<pre><code>USERS (u_id, u_name)\nLOAN (l_id, l_from[ref users.u_id], l_to[ref users.u_id], l_amount)\n\nUsers\n+------+--------+\n| u_id | u_name |\n+------+--------+ \n| 1    | abc    |\n| 2    | def    |\n+------+--------+\n\nLoan\n+-----+--------+------+----------+\n|l_id | l_from | l_to | l_amount |\n+-----+--------+------+----------+\n| 1   | 2      | 1    | 100      |\n| 2   | 2      | 1    | 100      |\n| 3   | 1      | 1    | 50       |\n+-----+--------+------+----------+\n</code></pre>\n\n<p>I want to select names instead of numbers(l_from &amp; l_to) from loan table</p>\n\n<pre><code>select\n  loan.l_id,\n  loan.l_from,\n  users.u_name user_from,\n  loan.l_to,\n  users.u_name as user_to,\n  loan.l_amount\nfrom loan, users\nwhere ???\n</code></pre>\n"},{"tags":["sql","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13297191,"title":"Raise Error Message","body":"<p>In SQL Server 2000, where we don't have SQL Mail set up(for whatever reason) I have a SQL Job that runs the packages on a timer, but even though I have an ActiveX message box in the package it still doesn't raise. I am aware that the message probably does pop up, I don't know where, but I still need to warn the user something as simple as \"Package Completed.\"</p>\n\n<p>Any ideas?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":29,"score":4,"question_id":13297312,"title":"Add two SQL fields together in new column","body":"<p>I want to add together two numerical values in my database (STOCKVOLUME and UNITS) and insert the result into a different field in a column (NEWVAL). I want this code to do this for every row in the database.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13257698,"title":"calculating total rows from one table with 2 level child","body":"<p>I have one table of \"galleries\" and one for \"images\".. the galleries table goes like this..</p>\n\n<pre><code>gal_id|name\n</code></pre>\n\n<p>and images is like</p>\n\n<pre><code>img_id|gal_id|name\n</code></pre>\n\n<p>now I have say 20 galleries, and I want to display total number of images in each gallery, so I want to use one query to return the array with total images in each gallery something like this</p>\n\n<pre><code>Gallery A (Total Images : 23)\nGallery B (Total Images : 33)\nGallery C (Total Images : 523)\nGallery D (Total Images : 25)\n</code></pre>\n\n<p>What would be the best approach to do this, I dont want to put the query in loop it will put load on server, please advise..</p>\n\n<p>thanks</p>\n"},{"tags":["sql","query","sqlite","parsing"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13242543,"title":"Parsing simplified SQL queries with Perl into SQLite","body":"<p>I am trying to turn a \"simplified\" sql query into a working SQLite one to use against XnViews databases, meaning the database layout is at best suboptimal for what I'm trying to do AND I can't change anything about that.</p>\n\n<p>Example would be \"(cat_10 and cat_12) and (cat_5 or cat_7)\".</p>\n\n<p>This should be used against the table \"t3\", which has the fields \"if\" (fileID) and \"ic\" (categoryID).</p>\n\n<p>The entries look like this:</p>\n\n<pre><code>if, ic\n7, 10\n7, 12\n7, 4\n9, 10\n9, 12\n9, 5\n10, 10\n10, 12\n10, 7\n</code></pre>\n\n<p>The simplified query above should only select the files 9 and 10 as 7 does have the wanted categories 10 and 12 but has neither 5 nor 7.</p>\n\n<p>The actual problem now is building that hell of a query statement because it took me already some hours to simply get an AND between two categories working.</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\n</code></pre>\n\n<p>This gives me all fileIDs that contain category 10 and 12, but I have no idea how I should combine that with the remaining \" and (cat_5 or cat_7)\".</p>\n\n<p>When I planned these simplified sql statements (made by a click-it-together-builder made in html and js) I was planning to simply replace \"cat_5\" with \"t3.ic = 5\" and leave the rest as it is.</p>\n\n<p>Of course I didn't forsee that it wouldn't work as where checks the entry as a whole and there can't be ic = 5 AND ic = 7. That pretty much broke everything.</p>\n\n<p>So I'm wondering if anyone would have an idea how I could translate these simple queries in actual working ones, keeping in mind that it might not be limited to ( x and y ) pairs.</p>\n\n<p>Edit: I worked out how to do the example I've given, I think atleast:</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\nINTERSECT \nSELECT if FROM t3 WHERE ic IN (5, 7) GROUP BY if\n</code></pre>\n\n<p>But the main problem now is resolving the ( ) in the right order.</p>\n\n<p>Edit 2: I think I'm giving grouping the categories into one field with group_concat() a try, then I should be able to simply to cats LIKE \"  \" AND which would be small blocks I could easy throw together, then just the brackets and it should work. Highlighting the 'should'.</p>\n"},{"tags":["sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13294164,"title":"How to efficiently track number of logged in users from a large userbase","body":"<p>If you have a user base of a million users for a game but only expect a dozen to be logged in at once, how is best to structure things so you can display the number of active users on your website? You wouldn't want (I think) to do a naive <code>SELECT count(*) FROM users WHERE logged_in = 1</code></p>\n"},{"tags":["sql","sql-server","pivot","case"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13295301,"title":"Select In PIVOT","body":"<p>Is there any way to have a CASE SELECT Statement in a PIVOTED Column. My Code is as follows</p>\n\n<pre><code>SELECT PName, [RN], [HA], [LVN], [MSW], [SC] \nFROM \n(\n   Query\n\n ) src \n\n  pivot\n    (\n     max(Visits)\n    for Discipline in ([RN], [HA], [LVN], [MSW], [SC])\n    ) piv\n</code></pre>\n\n<p>I am getting the output as follows</p>\n\n<pre><code>   Pname        RN         HA          LVN        MSW        SC\n    AA        AG-2/W    LO-1/W       NA-1/W     SK-2/W     NO-2/MON\n    AA        JL-2/W     NULL         NULL        NULL       NULL\n</code></pre>\n\n<p>Because there have been 2 RNs assigned to 1 PN I want to summarize the results only in 1 Row and select only 1 value to be displayed in the RN column so that the result is only as follows based on my condition. </p>\n\n<pre><code>    Pname        RN         HA          LVN        MSW        SC\n    AA        JL-2/W    LO-1/W       NA-1/W     SK-2/W     NO-2/MON\n</code></pre>\n"},{"tags":["php","sql","query","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13286725,"title":"how to use php variables in postgresql query","body":"<p>I have two php variables, one integer and other json, which I convert into string variable and then inserting them inside a postgresql database.</p>\n\n<p>Converting integer into string variable:</p>\n\n<pre><code>$string1 = (string)$integer;\n</code></pre>\n\n<p>Coneverting json from facebook api into string variable:</p>\n\n<pre><code>$string2 = json_encode($json);\n</code></pre>\n\n<p>Now, I have to insert these two string variables into postgres database:</p>\n\n<pre><code>$query = \"INSERT INTO interests VALUES(\". $string1 .\" ,\" . $string2 .\")\"; \npg_query($con, $query) or die(\"Cannot execute query: $query\\n\");\n</code></pre>\n\n<p>This is not working. I have tried a lot of solutions but still not working. </p>\n\n<p>I changed my function to insert into database</p>\n\n<pre><code>function push_interests(){\n$id = $facebook-&gt;getUser();\n$int = $facebook-&gt;api('/me/interests');     \n$host = \"hostname\"; \n$user = \"user\"; \n$pass = \"password\"; \n$db = \"database\"; \n\n$con = pg_connect(\"host=$host dbname=$db user=$user password=$pass\")\n    or die (\"Could not connect to server\\n\"); \n\n\n$id = (string)$id;\n$int = json_encode($int);\n\n$sql = \"INSERT INTO interests VALUES($1,$2)\"; \npg_prepare($con,'my_insert', $sql) or die (\"Cannot prepare statement1\\n\") ;\npg_execute($con,'my_insert', array($id,$int)) or die (\"Cannot execute statement1\\n\");\n\npg_close($con); \n\n}\n</code></pre>\n\n<p>Output is: cannot execute statement1\nI have created database as below:</p>\n\n<pre><code>$query = \"DROP TABLE IF EXISTS interests\"; \npg_query($con, $query) or die(\"Cannot execute query: $query\\n\");\n\n$query = \"CREATE TABLE interests(id VARCHAR(25) PRIMARY KEY, interests VARCHAR(500))\";  \npg_query($con, $query) or die(\"Cannot execute query: $query\\n\"); \n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13294468,"title":"Alter column in SQL Server","body":"<p>What is correct syntax for an <code>ALTER</code> statement to add a default value to an existing column?</p>\n\n<p>I can add new column with no errors:</p>\n\n<pre><code>ALTER TABLE tb_TableName ADD Record_Status varchar(20)\n</code></pre>\n\n<p>But If I try to alter existing column to apply default value by using the following statement:</p>\n\n<pre><code>ALTER TABLE tb_TableName \nALTER COLUMN Record_Status VARCHAR(20) NOT NULL DEFAULT ''\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ALTER TABLE tb_TableName \nALTER Record_Status VARCHAR(20) NOT NULL DEFAULT ''\n</code></pre>\n\n<p>I have get an error: </p>\n\n<blockquote>\n  <p>Incorrect syntax near 'Record_Status'.</p>\n</blockquote>\n"},{"tags":["sql"],"answer_count":6,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":7431,"score":6,"question_id":2956048,"title":"SQL: ... WHERE X IN (SELECT Y FROM ...) ","body":"<p>Is the following the most efficient in SQL to achieve its result:</p>\n\n<pre><code>SELECT * \n  FROM Customers \n WHERE Customer_ID NOT IN (SELECT Cust_ID FROM SUBSCRIBERS)\n</code></pre>\n\n<p>Could some use of joins be better and achieve the same result?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13296788,"title":"NULL & Distinct in oracle","body":"<p>I have a situation where I want to return null values from the customer table and essentialy the equivalent of a select distinct on the Bill code from the bill table.</p>\n\n<p>How would I do this?</p>\n\n<p>Table Customer</p>\n\n<pre>\nID\nName\nCustNumber\nBILLCODE\n</pre>\n\n<p>Table Bill</p>\n\n<pre>\nID\nBILLCODE\n</pre>\n\n<p>I'm trying to do something like</p>\n\n<pre><code>Select Null ID, Null NAME, Null CUSTNUMBER\nfrom CUSTOMER\nRIGHT JOIN ID, BILLCODE \non customer.billcode = bill.billcode\n</code></pre>\n\n<p>I only want 1 record for each billcode in the table.</p>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13294317,"title":"Sql Query to count in group by with specific condition","body":"<p><strong>My Table data</strong></p>\n\n<pre><code>id      fieldId  Name   Text\n----    ------  -----   ----\n1        101    name1   a1\n2        102    name2   a2\n3        101    name1   a1\n4        103    name3   a2\n5        102    name2   a3\n6        101    name1   c1\n7        101    name1   a3\n8        102    name2   \n9        101    name1   b2\n10       103    name3   c1\n</code></pre>\n\n<p>I need out put like </p>\n\n<pre><code>Name    Count(fieldId)  Count_id_text_is_either_a1_or_a2_a3\n------      ------        -------\nname1   4                   2\nname2   3                   2\nname3   2                   1\n</code></pre>\n\n<p><code>Name</code> = I need to group by fieldId. </p>\n\n<p><code>Count(fieldId)</code> = Count each group records.</p>\n\n<p><code>Count_id_text_is_either_a1_or_a2_a3</code> = This is the coloum I want the count of records of group only if <code>Text like 'a1-%' or 'a2-%' or 'a3-%'</code>.</p>\n\n<p>Can this be done by single query? if yes the please explain how? if no then what is the most effecient way to do this? </p>\n"},{"tags":["sql","ms-access","duplicates","union","priority"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13291949,"title":"Union of SQL tables, but only taking the first instance of an ID","body":"<p>I have three tables with identical columns that I need to union together into one table. Some IDs appear in more than one table, and I need to use the ID from the lowest numbered table first, and ignore that ID in any subsequent tables. Note that only the ID is the same, there aren't any duplicate rows between the tables.</p>\n\n<p>So as an example, these three tables need to be transformed to the final table:</p>\n\n<pre><code>**Table 1**\n+----+----+----+\n| ID | C1 | C2 |\n+----+----+----+\n| 01 | AA | BB |\n| 02 | CC | DD |\n| 03 | EE | FF |\n+----+----+----+\n\n**Table 2**\n+----+----+----+\n| ID | C1 | C2 |\n+----+----+----+\n| 03 | GG | HH |\n| 04 | II | JJ |\n| 05 | KK | LL |\n+----+----+----+\n\n**Table 3**\n+----+----+----+\n| ID | C1 | C2 |\n+----+----+----+\n| 01 | MM | NN |\n| 04 | OO | PP |\n| 06 | QQ | RR |\n+----+----+----+\n\n**Resulting Table**\n+----+----+----+\n| ID | C1 | C2 |\n+----+----+----+\n| 01 | AA | BB |\n| 02 | CC | DD |\n| 03 | EE | FF |\n| 04 | II | JJ |\n| 05 | KK | LL |\n| 06 | QQ | RR |\n+----+----+----+\n</code></pre>\n\n<p>I have a vague idea of a solution using left joins and 'IS NULL' conditions, but that could get complicated very quickly, especially if the number of tables increases.</p>\n\n<p>Is there a way of specifying duplicates only on one column, not on a whole row?</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1002,"score":0,"question_id":5043443,"title":"Delete with inner join across 3 tables","body":"<p>I have three tables one of this storing users basic information, the other one is profile information and the last one is storing user picture.</p>\n\n<p>When i deleting these user i need to delete all of the data in these tables. So i write a query like this.</p>\n\n<pre><code>DELETE Kullanicilar FROM Kullanicilar \nINNER JOIN ProfilBilgileri ON Kullanicilar.ID = ProfilBilgileri.UyeID \nINNER JOIN UyeResim ON Kullanicilar.ID = UyeResim.UyeID \nWHERE Kullanicilar.ID=@ID\n</code></pre>\n\n<p>But it just deleting the data from \"Kullanicilar\" table.<br />\nAny suggestions?</p>\n\n<p>EDIT : I'm using MSSQL 2008 but hosting firm 2000 so i need compatible code.</p>\n"},{"tags":["c#","sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13296412,"title":"The update statement works in SSMS but not in code","body":"<p>I've been beating my head against the wall for 2 days now.  This update statement works when run in ssms</p>\n\n<pre><code>update dbo.DEMOGRAPHICS \nset ETHNICITY = (select distinct(ethnicity) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, GENDER = (select distinct(GENDER) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, MARITAL_STATUS = (select distinct(MARITAL_STATUS) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, RELIGION = (select distinct(RELIGION) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\n, VETERAN = (select distinct(VETERAN) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID =  'P000084716' and ACADEMIC_SESSION != '')\n, CITIZENSHIP = (select distinct(CITIZENSHIP) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = 'P000084716'and ACADEMIC_SESSION != '')\n,RETIRED = (select distinct(RETIRED) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '000084716' and ACADEMIC_SESSION != '')\n, LEGAL_RESIDENCE = (select distinct(LEGAL_RESIDENCE) from dbo.DEMOGRAPHICS where   PEOPLE_CODE_ID = 'P000084716' and ACADEMIC_SESSION != '')\nwhere PEOPLE_CODE_ID = 'P000084716'  and ACADEMIC_SESSION = ''\n</code></pre>\n\n<p>but doing the update in the code doesn't</p>\n\n<pre><code>string updDemoRecords = @\"update dbo.DEMOGRAPHICS \nset ETHNICITY = (select distinct(ethnicity) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, GENDER = (select distinct(GENDER) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, MARITAL_STATUS = (select distinct(MARITAL_STATUS) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, RELIGION = (select distinct(RELIGION) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, VETERAN = (select distinct(VETERAN) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, CITIZENSHIP = (select distinct(CITIZENSHIP) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}'and ACADEMIC_SESSION != '')\n,RETIRED = (select distinct(RETIRED) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\n, LEGAL_RESIDENCE = (select distinct(LEGAL_RESIDENCE) from dbo.DEMOGRAPHICS where PEOPLE_CODE_ID = '{0}' and ACADEMIC_SESSION != '')\nwhere PEOPLE_CODE_ID = '{0}'  and ACADEMIC_SESSION = ''\";\nupdDemoRecords = string.Format(updDemoRecords, peopleOrgCodeID);\npcCon = new SqlConnection(pcConnString);\nSqlCommand doUpdDemoRecords = new SqlCommand(updDemoRecords, pcCon);\npcCon.Open();\ndoUpdDemoRecords.ExecuteNonQuery();\npcCon.Close();\n</code></pre>\n\n<p>Tried it from a stored proc also and it doesn't update the relevant rows either.  It is sql server 2008 and c#.net</p>\n"},{"tags":["sql","sql-server-2005","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13296654,"title":"SQL multiple column index","body":"<p>I'm using SQL Server 2012. What is the difference between indexing a single non clustered non-key column and putting multiple columns and then indexing?</p>\n\n<p>If I have table with </p>\n\n<blockquote>\n  <ul>\n  <li>EmployeeID</li>\n  <li>DepartmentID</li>\n  <li>LocationID</li>\n  <li>Name</li>\n  <li>Address</li>\n  </ul>\n</blockquote>\n\n<p>If I create a single index on </p>\n\n<blockquote>\n  <ul>\n  <li>EmployeeID</li>\n  <li>DepartmentID</li>\n  </ul>\n</blockquote>\n\n<p>instead of just</p>\n\n<blockquote>\n  <ul>\n  <li>EmployeeID</li>\n  </ul>\n</blockquote>\n\n<p>What is the difference? I created <code>EmployeeID, DepartmentID</code> index, when I was searching any employee with <code>DepartmentID = X</code>, the SQL Management Studio Actual Execution Plan was suggesting that I create an index on <code>DepartmentID</code> even though the table had a non clustered index on <code>EmployeeID, DeparmentID</code>?</p>\n"},{"tags":["sql","vba","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13270849,"title":"Link multiple tables from one database","body":"<p>I have actually this little function working as supposed:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function createAttached(strTable As String, strPath As String, strBaseTable As String) As Boolean\n    On Error GoTo CreateAttachedError\n\n    Dim tdf As TableDef\n    Dim strConnect As String\n    Dim fRetval As Boolean\n    Dim myDB As Database\n\n    DoCmd.SetWarnings False\n\n    Set myDB = CurrentDb\n    Set tdf = myDB.CreateTableDef(strTable)\n\n    With tdf\n        .Connect = \";DATABASE=\" &amp; strPath\n        .SourceTableName = strBaseTable\n    End With\n\n    myDB.TableDefs.Append tdf\n    myDB.TableDefs.Refresh\n\n    fRetval = True\n\n    DoCmd.SetWarnings True\n\nCreateAttachedExit:\n    createAttached = fRetval\n    Exit Function\n\nCreateAttachedError:\n    If Err = 3110 Then\n        Resume CreateAttachedExit\n    Else\n        If Err = 3011 Then\n            Resume Next\n        Else\n            If Err = 3012 Then\n                Set tdf = myDB.TableDefs(strTable)\n                tdf.Connect = \";DATABASE=\" &amp; strPath\n                tdf.RefreshLink\n                fRetval = True\n                GoTo CreateAttachedExit\n            End If\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>This code works fine, I can call the function as many times as I want to add links to tables from another database. However, I have about 30 tables to import from the same database and this script restarts from scratch everytime I call it. Because the database is located on another server, it takes about 1 min to link the 30 tables.</p>\n\n<p>Is there anything I could do with that function to make it work faster when I need to link multiple tables from the same database? I would like it to work with multiple strTable and strBaseTable in parameters instead of one (maybe arrays?), but I don't know how to do this.</p>\n\n<p>Thank you.</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13296501,"title":"Optimising Queries With Already Low Cost","body":"<p>I've been doing some basic optimising of my SQL queries by indexing and clustering but have come upon what is perhaps an odd question. Most of my queries have costs that range from the high hundreds to the low thousands and I've added indices for them, bringing their costs down.</p>\n\n<p>However, some of my queries already have a very low cost, usually a single digit. Can I forget about these? Is it still worth optimising these queries or should I not put in the effort?</p>\n\n<p>Basically, I'd like to know if there's a general range or metric I can use to determine if a query should be optimised further or not. If I should determine this on a case-by-case basis, it would be helpful to have some guidelines to use in deciding which queries to optimise.</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13296175,"title":"Are there any succinct approaches to this left join?","body":"<p>A simple inner join</p>\n\n<pre><code>select * from table1 a\ninner join \ndbo.table2 b\non a.inventory_id = b.inventory_id\n</code></pre>\n\n<p>Wouldn't it be nice and intuitive to put it like this?</p>\n\n<pre><code>select * from table1 a\ninner join \ndbo.table2 b\non inventory_id\n</code></pre>\n\n<p>Are there any comparable succinct approaches?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript","mysql","sql","mongodb","mongoose"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13295820,"title":"mongoose query for top 5 viewed projects (sorted) using nodeJS","body":"<p>i have a site with multiple projects. and each project has a different view count. \nWhat i want to do is <strong>to retrieve an array of the top 5 viewed projects in this order <code>[max, max-1, max-2, max-3, max-4].</code></strong> </p>\n\n<p>here's the schema:</p>\n\n<pre><code>var mongoose = require('mongoose');\n\n// defines the database schema for this object\nvar schema = mongoose.Schema({\n  projectName : String,\n  authorName : String,\n  viewCount : Number\n\n   comment : [{\n      id : String,                                  \n      authorName : String,\n      authorEmailAddress : { type : String, index : true }  \n    }]\n  });\n</code></pre>\n\n<p><code>})</code></p>\n\n<pre><code>// Sets the schema for model\nvar ProjectModel = mongoose.model('Project', schema);\n\n// Create a project\nexports.create = function (projectJSON) {\n\n  var project = new ProjectModel({\n\n    projectName : projectJSON.projectName ,\n    authorName : projectJSON.authorName,    \n    viewCount :  projectJSON.viewCount,    \n\n    comment : [{\n      id : projectJSON.comments.id,                                         \n      authorName : projectJSON.comments.authorName,                         \n      authorEmailAddress : projectJSON.authorEmailAddress\n    });\n\n  project.save(function(err) {\n    if (err) {\n      console.log(err);\n    }\n    else{\n      console.log(\"success\");\n    }\n  });\n\n\n}\n</code></pre>\n\n<p>Below is my attempt to retrieve an array of the top 5 viewed articles in this order <code>[max, max-1, max-2, max-3, max-4]</code>. Bearing in mind that articles view rank change in real time.</p>\n\n<p><code>// because i am familiar with SQL, i start with a SQL query and convert it later to mongoose</code></p>\n\n<p>SQL version: </p>\n\n<p><code>SELECT MAX(viewCount) FROM project where projectName=1   --this only give the MAX when i want the top 5</code></p>\n\n<p>mongoose version:</p>\n\n<pre><code>exports.getTopViewedProject = function(rank, callback)\n   ProjectModel.findOne({ projectName: 1 }).sort(viewCount, -1).run( \n       function(err, viewCOunt) {\n         var max = viewCount;\n    });\n</code></pre>\n"},{"tags":["sql","linq"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13292834,"title":"How to build the correct LINQ query (generate OR instead of AND)","body":"<p>I need some help in building the correct query. I have an Employees table. I need to get a list of all employees, that EENO (Employee ID) contains a string from a supplied array of partial Employee IDs.</p>\n\n<p>When I use this code</p>\n\n<pre><code>// IEnumerable&lt;string&gt; employeeIds is a collection of partial Employee IDs\nIQueryable&lt;Employee&gt; query = Employees;\nforeach (string id in employeeIds)\n{\n    query = query.Where(e =&gt; e.EENO.Contains(id));\n}\nreturn query;\n</code></pre>\n\n<p>I will get something like:</p>\n\n<pre><code>SELECT * \nFROM Employees \nWHERE EENO LIKE '%1111111%' \n  AND EENO LIKE '%2222222%' \n  AND EENO LIKE '%3333333%' \n  AND EENO LIKE '%4444444%' \n</code></pre>\n\n<p>Which doesn't make sense. \n<strong>I need \"OR\" instead of \"AND\" in resulting SQL.</strong></p>\n\n<p>Thank you!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>This code I wrote using PredicateBuilder <strong>works perfectly</strong> when I need to include these employees.</p>\n\n<pre><code>var predicate = PredicateBuilder.False&lt;Employee&gt;();\nforeach (string id in employeeIds)\n{\n    var temp = id;\n    predicate = predicate.Or(e =&gt; e.EENO.Contains(temp));\n}\nvar query = Employees.Where(predicate);\n</code></pre>\n\n<p>Now, I need to write an opposite code, to exclude these employees, \nhere it is <strong>but it is not working</strong>: the generated SQL is totally weird.</p>\n\n<pre><code>var predicate = PredicateBuilder.False&lt;Employee&gt;();\nforeach (string id in employeeIds)\n{\n    var temp = id;\n    predicate = predicate.And(e =&gt; !e.EENO.Contains(temp)); // changed to \"And\" and \"!\"\n}\nvar query = Employees.Where(predicate);\nreturn query;\n</code></pre>\n\n<p>It's supposed to generate SQL  Where clause like this one:</p>\n\n<pre><code>WHERE EENO NOT LIKE '%11111%'\n       AND NOT LIKE '%22222%'\n       AND NOT LIKE '%33333%'\n</code></pre>\n\n<p><strong>But it's not happening</strong></p>\n\n<p>The SQL generated is this: <a href=\"http://i.imgur.com/9MDP7.png\" rel=\"nofollow\">http://i.imgur.com/9MDP7.png</a></p>\n\n<p>Any help is appreciated. Thanks.</p>\n"},{"tags":["sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13296436,"title":"Do I have to list all the possible FK in the database design?","body":"<p>Here is the situation:</p>\n\n<p>I got a database which record the relationship between CUSTOMER and ORDER, INVOICE, PAYMENT etc.</p>\n\n<p>My current design is: CUSTOMER links to ORDER, ORDER links to INVOICE, and INVOICE links to PAYMENT.</p>\n\n<p>My question is, I actually want to know which CUSTOMER is dealing with the ORDER, the INVOICE and the PAYMENT. So do I have to put the CUSTOMER_ID in every table which I want to show the CUSTOMER in as a FK? Will it </p>\n\n<p>Or I can just present it by query?</p>\n"},{"tags":["sql","foreign-keys"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13296313,"title":"SQL: FOREIGN KEY prevents destruction of links between tables","body":"<p>Refer: <a href=\"http://www.w3schools.com/sql/sql_foreignkey.asp\" rel=\"nofollow\">w3schools-SQL</a></p>\n\n<p>It states:</p>\n\n<p><strong>The FOREIGN KEY constraint is used to prevent actions that would destroy links between tables.</strong> Can someone give an example of an action that foreign key would prevent ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["php","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":24,"score":-2,"question_id":13296351,"title":"how SQL structure and php for movies site","body":"<p>Hello I'm building a site Watch Series\nNow I was the structure of the SQL and PHP because each series has seasons and I want to display a page like this:</p>\n\n<hr>\n\n<p>Here's a list of series</p>\n\n<hr>\n\n<p>Here each series</p>\n\n<p>Series Name\n![enter image description here][1]\nBox [here Seasons]</p>\n\n<hr>\n\n<p>Here a list of episodes of the series by season</p>\n\n<p><img src=\"http://i.stack.imgur.com/7XngG.jpg\" alt=\"\"></p>\n"},{"tags":["sql","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13295376,"title":"How to set BEGIN_TRANSACTION automatically in SSMS (SQL Server Management Studio)?","body":"<p>With <code>Options &gt; Query Execution &gt; ANSI &gt; SET IMPLICIT_TRANSACTIONS</code>, each batch is not committed automatically. </p>\n\n<p>Even so, I have to run <code>begin transaction</code> in batch explicitly, i.e. if I just run <code>update table_name set col_name = 'something'</code> without the <code>begin trans</code>, the update is automatically committed, can I actually ask set up SSMS such that it will automatically create a transaction when I execute a <code>update\\insert\\delete</code> batch? </p>\n"},{"tags":["sql","select","aggregate-functions","ormlite"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13223264,"title":"How to evaluate a SQL function result and query from nested SELECT","body":"<p>How can I implement this SQL query in ORMLite and evaluate the result?</p>\n\n<pre><code>SELECT SUM(column1 * column2) AS total FROM (ANOTHER_SELECT_QUERY)\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13295521,"title":"I'd like to create a series of tables on which I'll loop to do some scenario analysis","body":"<p>Planning to use cursors (simply preference) to do the looping and wondering if there's a better way of setting something like this up than creating dummy tables to house the variables (eg, create table, then populate via INSERT INTO/VALUES() calls) and then selecting from those created tables into the cursors to do the looping.  </p>\n\n<p>I estimate I'll have three sets of parameters, so in setting this up I'll have three nested cursors.  </p>\n\n<p>My big question is in getting my parameters into the cursors for looping, something like this seems sloppy and I'm wondering if there's a better way (simply selecting 10,20,30 within the cursor declaration results in them being housed as columns rather than rows):</p>\n\n<pre><code>CREATE TABLE #countTable (\ncnt SMALLINT )\n\nINSERT INTO #countTable\nVALUES (10,20,30) \n</code></pre>\n\n<p>Any more efficient approaches for this type of scenario analysis?</p>\n\n<p>EDIT:  Related to the set-based comments...I'm trying to create distinct portfolios of securities with different characteristics (as described in my comment below:  X total securities, Y max single security portfolio weight, and Z sector allocation).  From what I've just read on set-based approaches, set-based logic aims to effectively borrow parts of processing for subsequent 'scenarios' (ie, if I pull the top 50 securities, I can, from the resulting set, also pull the top 40 securities rather than querying the original data set again, as the top 40 is a subset of the top 50).  </p>\n\n<p>It seems to me this would be possible for the example laid out above (ie, top 40 from top 50), but NOT for the other examples (max security allocation or sector allocation), as different scenarios aren't subsets of others as they are for the number of securities (eg, a 10% max security weight scenarios isn't either a sub- or superset of a 5% max weight scenario).  Does this sound accurate or is there something I'm missing?</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13295236,"title":"Sql Select from another table (loop?)","body":"<p>My SQL skills aren't great hence the post.</p>\n\n<p>I'm trying to get all the contact names based on a company out.</p>\n\n<p>For example I  have two statements:</p>\n\n<pre><code>Select Id, CompanyName, Address From Clients\nSelect ClientId, ContactName From Contacts\n</code></pre>\n\n<p>You may have many contacts to a single client</p>\n\n<p>Result: (I need all the contact names in a single column)</p>\n\n<pre><code>ContactName         Company    Address\n----------------------------------------\nJohh, Steve         123 Comp   12345 Address\nDavid,Mike, Sarah   44 Comp    111 Address\n</code></pre>\n\n<p>A working example would be very much appreciated.</p>\n"},{"tags":["sql","select"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13295221,"title":"Trouble Combining two SELECT Statements","body":"<p>I am sure there is some easy fix to this.  I just have basically no experience with writing SQL statements and so I don't know all of the commands, tricks or syntax to get what I need.</p>\n\n<p>I have the following two SQL <code>SELECT</code> statements I need to combine:  </p>\n\n<p><strong>1:</strong></p>\n\n<pre><code>SELECT \n    h.jhhold, h.jhjob, h.jhrev, o.jadesc, o.jaoqty, o.jacqty, o.japo, o.javend  \nFROM \n    Jhead AS h  \nLEFT JOIN \n    jjops AS o ON h.jhjob = o.jajob  \nWHERE \n    h.jhpcmp = 0 \n    AND o.jatype = 2 \n    AND o.jacqty &lt; o.jaoqty \n    AND o.japcmp = 0 \n    AND o.japo = 0  \n</code></pre>\n\n<p><strong>2:</strong>  </p>\n\n<pre><code>SELECT \n    h.jhhold, h.jhjob, h.jhrev, o.jadesc, o.jaoqty, o.jacqty, o.japo, o.javend, \n    p.hdprcd, p.hdrecd, p.hdseq  \nFROM \n    Jhead AS h \nLEFT JOIN \n    jjops AS o ON h.jhjob = o.jajob   \nLEFT JOIN \n    hpodt AS p ON h.jhjob = p.hdjob   \nWHERE \n    h.jhpcmp = 0 \n    AND o.jatype = 2 \n    AND o.jacqty &lt; o.jaoqty \n    AND o.japcmp = 0 \n    AND p.hdjob = h.jhjob \n    AND p.hdpo = o.japo \n    AND p.hdseq = o.jaseq\n</code></pre>\n\n<p>Both of these two statements return the results I need.  The first statement basically returns results where o.japo = 0 (it is never null).  The second returns a result where o.japo is not zero and then I attempt to join another table to the data.  I did try stick a UNION ALL in between but all union examples I looked up did not have unqiue WHERE statement per select statement.</p>\n\n<p>.<br>\nI had initially attempted the following statement (below) but was getting multiple lines of data when o.japo = 0 and I could not figure out why it was picking up the extra lines but I suspect it was the second left join joining incorrect/unwanted data.  When o.japo = 0 all of the hpodt (p.) fields should have been null but instead were populated with data from somewhere.</p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd, p.hdseq \nFROM Jhead AS h \nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND o.japcmp = 0 AND p.hdjob = h.jhjob AND o.japo != 0 AND p.hdpo = o.japo AND p.hdseq = o.jaseq AND o.jaopr != 'PT') OR (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND o.japcmp = 0 AND o.japo = 0 AND o.jaopr != 'PT')\nORDER BY h.jhjob, o.jaseq, p.hdrecd\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","sql-server-2012"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13295559,"title":"Remove extra blank lines in Alter stored procedure or function","body":"<p>In SQL Server 2012 when I write code for a stored procedure and for any function. After that when I want to alter it added extra blank line gap Each and Every time, that's why it seem very bad..</p>\n\n<p><img src=\"http://i.stack.imgur.com/xOec6.png\" alt=\"enter image description here\"></p>\n\n<p>I want to know some SQL Server setting or any other to resolve this issue</p>\n"},{"tags":["sql","sql-server","datetime-operation","sql-convert"],"answer_count":14,"favorite_count":8,"up_vote_count":38,"down_vote_count":0,"view_count":202970,"score":38,"question_id":74385,"title":"How to convert DateTime to VarChar","body":"<p>I am working on a query in Sql Server 2005 where I need to convert a value in DateTime variable into a varchar variable in 'yyyy-mm-dd' format (without time part). </p>\n\n<p>Please help, thanks.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13295748,"title":"sql how to insert into a column like it was an identity column","body":"<p>I have a table with three columns</p>\n\n<pre>KeyID   | nvarchar(10)  \nColumnA | nvarchar(max)  \nColumnB | Nvarchar(max)</pre>\n\n<p>What i'm trying to do is a select insert, however with keyID i need to treat it like an indentity column.</p>\n\n<p>For example if I had 3 rows I wanted to insert it would be :</p>\n\n<pre>1001 | Apple     | Pear  \n1002 | Pear      | Mango  \n1003 | Pineapple | Pine\n</pre>\n\n<p>But i'm trying to do this with an insert select, for example:</p>\n\n<pre><code>insert into myTable(KeyId,ColumnA,ColumnB) select 'x',OrigColA,OrigColB from myTableB\n</code></pre>\n\n<p>obviously 'x' is where i'm having the issue.</p>\n\n<p>Thanks in advance!</p>\n\n<p>This is no KeyId located in myTableB</p>\n"},{"tags":["sql","excel","vba","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13293366,"title":"Excel QueryTable object querying an Excel workbook limit 1000 rows","body":"<p>I'm trying to query another sheet in one of my workbooks to be able to use SQL queries to retrieve data however I notice that the querytable will only return 1000 rows even though my data ranges from 20k to 40k rows depending on which sheet I query. Is it a property of QueryTables or is there something I am missing ?</p>\n\n<pre><code>Option Explicit\n\nPrivate connection As ADODB.connection\nPrivate conn_string As String\nPrivate recordset As ADODB.recordset\n\nPublic Sub ouvre_connexion(pathwb As String)\n    ' That double-backslash is just to prevent SO color highlighting\n    ' going nuts.\n    conn_string = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" _\n        &amp; ActiveWorkbook.path &amp; \"\\\\\" &amp; ActiveWorkbook.Name &amp; _\n        \";Extended Properties=Excel 8.0;Persist Security Info=False;\"\n\n    Set connection = New ADODB.connection\n    connection.ConnectionString = conn_string\n    connection.Open\nEnd Sub\n\nPublic Sub execute_requete(sql_query As String, ws As Worksheet, rng As Range)\n    Dim i As Integer\n    Dim query_table As QueryTable\n\n    If rng.Worksheet.Name &lt;&gt; ws.Name Then\n        MsgBox (\"Erreur ! La feuille soumise et la feuille parent du range\" &amp; _\n            \" doivent être la même !\")\n    Else\n        Set recordset = New ADODB.recordset\n        recordset.Source = sql_query\n        recordset.ActiveConnection = connection\n        recordset.Open\n        If ws.QueryTables.Count &lt;&gt; 0 Then\n            For i = 1 To ws.QueryTables.Count\n                ws.QueryTables(i).Delete\n            Next i\n        End If\n        Set query_table = ws.QueryTables.Add(recordset, rng)\n        query_table.Refresh\n    End If\nEnd Sub\n\nPublic Sub ferme_connexion()\n    connection.Close\nEnd Sub\n</code></pre>\n\n<p>The query used is very simple and is in the form:</p>\n\n<pre><code>SELECT * FROM Sheetsomething$\n</code></pre>\n\n<p>Obviously I want to be able to do more complex queries in the future but for now I just wanted to test my tool with the simplest query.</p>\n\n<p>I searched on MSDN and Google but couldn't find a single occurence of people talking about limits on query tables :|</p>\n\n<p>This is on Excel 2007.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13295636,"title":"Filter out rows returned in subquery","body":"<p>I have a temp table that stores rollup data and would like to create a query to see if I could clean up the data a little bit.  I thought it would be pretty easy but it has turned out to be much more difficult.  Maybe it is easy and I'm just approaching it all wrong.</p>\n\n<p>What I'm trying to do is simply remove rows where Item = 'TOTALS' but where a name only shows up twice. So in the table below, rows 7 and 9 should be removed.  Just so you know, there are no keys.</p>\n\n<p>Name . Item ......Dlvrd<br/>\n--------------------------<br/>\nBob .       102 ..........          18<br/>\nBob .       106 ..........          32<br/>\nBob .       108 ..........          34<br/>\nBob .       999 ..........          184<br/>\nBob ..      TOTALS .    702<br/>\nJohn .      64 ...........          86<br/>\nJohn .      TOTALS .    86<br/>\nJim  ..     112 ..........          131<br/>\nJim  ..     TOTALS ..   131<br/>\nJane .      10 ..........           720<br/>\nJane .      12 ........ .       217<br/>\nJane .      999 ........            867<br/>\nJane .      TOTALS  1848<br/>\n</p>\n\n<p>My first attempt consisted of adding a column with the count of the name column, then using a where clause like:  where name != '2' and Item != 'TOTALS'.  Didn't work, even putting parenthesis around them.  It just removes any row with a 2 or where Item = 'TOTALS'.  It's totally ignoring the 'AND'.  Here my sql:</p>\n\n<pre><code>select t.count, tr.*\nFrom #TempRollup tr\njoin (\n    select \n      Name\n    , COUNT(Name) count\n    from #TempRollup\n    Group by Name\n    ) as t on t.Name = tr.Name\nwhere (\nt.count != 2\nand Item != 'TOTALS'\n)\n</code></pre>\n\n<p>Then I tried this method that involves creating a subquery to find the rows I want to ignore and then just not selecting them.  My subquery grabs the correct rows but when the whole thing is run, nothing is returned.:</p>\n\n<pre><code>Select *\nFROM #TempRollup\nWHERE NOT EXISTS(  \n    select tr.*\n    From #TempRollup tr\n    join (\n            select \n              Name\n            , COUNT(Name) count\n            from #TempRollup\n            Group by Name\n            ) as t on t.Name = tr.Name\n    where t.count = 2\n    and Item = 'TOTALS'\n)\n</code></pre>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13295731,"title":"Saving a Sql View Error, runs fine but cannot save \"incorrect syntax near the keyword declare\"","body":"<pre><code>Declare @DaysLeft as INT\n\n\n;With MyCTE AS\n(\n    SELECT number + 1 as 'CurrentDay'\n    FROM   master..spt_values\n    WHERE  type='p'\n    AND    number &lt; datepart(dd, DateAdd(day,-1,DateAdd(Month,1,DateAdd(Month,\n                                          DateDiff(Month, 0, GETDATE()),0))))\n    AND    datename(WEEKDAY,DateAdd(Month, DateDiff(Month, 0, GETDATE()),\n                                         number) ) not in ('Saturday','Sunday')\n)\n\nSelect @DaysLeft = (Select COUNT(*) As MyTotal from MyCTE\nWHERE CurrentDay &gt;= DATEPART(DD, GETDATE()))\n\nSelect @DaysLeft\n</code></pre>\n"},{"tags":["c++","sql","database","sqlite","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13295739,"title":"c++ sqlite3 insert or replace query i think is erroring","body":"<p>I am corrected to my database, but when i fire off a command, i get an error.  </p>\n\n<p>my table:</p>\n\n<pre><code>a{ id int primary key not null, name varchar not null, and order int not null }\n</code></pre>\n\n<p>My statement:</p>\n\n<pre><code>string query = \"insert or replace into a (id,name,order) values (5,'hi',10)\"\nint rc;\nrc = sqlite3_exec(db, query.c_str(), 0,0,&amp;errMsg);\nif(rc != SQLITE_OK){\n    cout &lt;&lt; \"Error Code: \" &lt;&lt; rc &lt;&lt; \" SQLError: \" &lt;&lt; errMsg&lt;&lt;endl;\n}\n</code></pre>\n\n<p>I wasnt sure how this is suppose to work.  It is triyng to insert.  It will see the PK matches.... Then after that, it will replace, will it try to replace the PK with itself?  I wasnt sure.   The Returned ErrorCode which RC gives is:  </p>\n\n<pre><code>1   /* SQL error or missing database */\n</code></pre>\n"},{"tags":["sql","query","postgresql"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13285985,"title":"Recursive query (postgresql 9) - number of files in subfolders","body":"<p>I do have a table with list of files. There is id_folder, id_parrent_folder, size (file size):</p>\n\n<pre><code>create table sample_data (\n    id_folder bigint ,\n    id_parrent_folder bigint,\n    size bigint\n);\n</code></pre>\n\n<p>I would like to know, how many files are in every subfolder (including current folder) for each folder (starting wigh given folder). Given the samle data posted below I expect the following output:</p>\n\n<pre><code>id_folder     files\n100623           35\n100624           14\n</code></pre>\n\n<p>Sample data:</p>\n\n<pre><code>insert into sample_data values (100623,58091,60928);\ninsert into sample_data values (100623,58091,59904);\ninsert into sample_data values (100623,58091,54784);\ninsert into sample_data values (100623,58091,65024);\ninsert into sample_data values (100623,58091,25600);\ninsert into sample_data values (100623,58091,31744);\ninsert into sample_data values (100623,58091,27648);\ninsert into sample_data values (100623,58091,39424);\ninsert into sample_data values (100623,58091,30720);\ninsert into sample_data values (100623,58091,71168);\ninsert into sample_data values (100623,58091,68608);\ninsert into sample_data values (100623,58091,34304);\ninsert into sample_data values (100623,58091,46592);\ninsert into sample_data values (100623,58091,35328);\ninsert into sample_data values (100623,58091,29184);\ninsert into sample_data values (100623,58091,38912);\ninsert into sample_data values (100623,58091,38400);\ninsert into sample_data values (100623,58091,49152);\ninsert into sample_data values (100623,58091,14444);\ninsert into sample_data values (100623,58091,33792);\ninsert into sample_data values (100623,58091,14789);\ninsert into sample_data values (100624,100623,16873);\ninsert into sample_data values (100624,100623,32768);\ninsert into sample_data values (100624,100623,104920);\ninsert into sample_data values (100624,100623,105648);\ninsert into sample_data values (100624,100623,31744);\ninsert into sample_data values (100624,100623,16431);\ninsert into sample_data values (100624,100623,46592);\ninsert into sample_data values (100624,100623,28160);\ninsert into sample_data values (100624,100623,58650);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\ninsert into sample_data values (100624,100623,162);\n</code></pre>\n\n<p>I've tried to use example from postgresql (<a href=\"http://www.postgresql.org/docs/9.1/static/queries-with.html\" rel=\"nofollow\">postgresql docs</a>), but it (obviously) can't work this way. Any help appreciated.</p>\n\n<p>-- Edit</p>\n\n<p>I've tried the following query:</p>\n\n<pre><code>WITH RECURSIVE included_files(id_folder, parrent_folder, dist_last_change) AS (\nSELECT \n    id_folder, \n    id_parrent_folder, \n    size\nFROM \n    sample_data p \nWHERE \n    id_folder = 100623\nUNION ALL\nSELECT \n    p.id_folder, \n    p.id_parrent_folder, \n    p.size\nFROM \n    included_files if, \n    sample_data p\nWHERE \n    p.id_parrent_folder = if.id_folder\n)\nselect * from included_files\n</code></pre>\n\n<p>This won't work, because for every child there is a lot of parents and as a result rows in child folders are multiplied.</p>\n"},{"tags":["sql","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13293558,"title":"SQL - extract multiple values","body":"<p>I have an SQL table with Member ID's. </p>\n\n<p>Each member has information regarding their insurance claims listed in the table. </p>\n\n<p>One column lists insurance ID's in relation to <code>Member-ID</code>.</p>\n\n<p>for example:-</p>\n\n<pre><code>|Member ID    | Insurance Code   |\n----------------------------------\n|C#$#@@!1231  | 67               |\n</code></pre>\n\n<p>Now the issue is the same member could have different Insurance Code#'s as a part of previous claims.</p>\n\n<p>For example between 2010 -2011, the member had a claim Code = 67\nBut for 2011 - 2012, the member had a claim Code = 3</p>\n\n<p>Now when I create a SQL query, I only get one value for claim code.... how can I get all the values, say 67, 3, and 110? Such that I can respond to all claims that the member has been a part of.</p>\n\n<pre><code>// SQL QUERY to gather member information.\nDMS.ADOQuery1.SQL.Clear;\nDMS.ADOQuery1.SQL.Add('select HPFROMDT, HPthruDt, MEMBERKEY, MEMBHPKEY, OPFROMDT, OPTHRUDT, HPCODEKEY' +\n                      ' from MEMBHP' +\n                      ' where MEMBERKEY = ''' + MembKey + '''  and OPTHRUDT &gt;= ''' + init_date + ''' and OPFROMDT &lt;= ''' + final_date +''' and OPFROMDT &lt; OPTHRUDT'\n                     );\n\n//  Showmessage(DMS.ADOQuery1.SQL[0]);\n\nDMS.ADOQuery1.Open;\n\n// Adding the query values to the appropriate variables.\nHPCodeKey := (DMS.ADOQuery1.FieldByNAme('HPCODEKEY').AsString);\n\nDMS.ADOQuery1.Close;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13294593,"title":"Trimming spaces out of a string based on a pattern in SQL Server","body":"<p>I have a varchar(max) field with XML data in it. I need to clean it by removing the spaces between the tags. For eg:</p>\n\n<pre><code>&lt;/tns:time_changed&gt;   &lt;tns:changed_properties&gt;  \n</code></pre>\n\n<p>should be cleaned as </p>\n\n<pre><code>&lt;/tns:time_changed&gt;&lt;tns:changed_properties&gt;  \n</code></pre>\n\n<p>I need to do this in a single query and I cannot use replace all white spaces as there are other relevant spaces in the content.</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13295520,"title":"Oracle SQL - how to group and aggregate results?","body":"<p>I am trying to query an audit table in Oracle to pull out a list of how popular a document is during a given timeframe (number of unique hits).</p>\n\n<p>The SQL that I've developed so far is:</p>\n\n<pre><code>select distinct dt.name \"Document name\", ku.name \"User name\", count(*) \"Number of hits\" \n  from dauditnew da, \n       kuaf ku, \n       dtree dt \n where ku.id=da.performerid \n   and (da.auditstr='Fetch') \n   and dt.dataid = ANY(DOCID1,DOCID2) \n   and da.dataid = ANY(DOCID1,DOCID2) \n   and da.auditdate between TO_DATE('01-JAN-12') and TO_DATE('31-OCT-12') \n group by dt.name, ku.name\n</code></pre>\n\n<p>And it spits out data similar to:</p>\n\n<pre><code>Document name       User name           Hit count\ndocument1.pdf   rimnet\\user1    1\ndocument1.pdf   rimnet\\user2    1\ndocument1.pdf   rimnet\\user3    17\ndocument1.pdf   rimnet\\user4    1\ndocument2.pdf   rimnet\\user5    1\ndocument1.pdf   rimnet\\user6    1\ndocument3.pdf   rimnet\\user7    1\n</code></pre>\n\n<p>But what I really need is for it to group the results and count each unique user once:</p>\n\n<pre><code>Document name       User name           Hit count\ndocument1.pdf       n/a                 5\ndocument2.pdf       n/a                 1\ndocument3.pdf       n/a                 1\n</code></pre>\n\n<p>Can anyone point me in the right direction?</p>\n"},{"tags":["sql","xml","asp.net-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13288466,"title":"SQL Query to XML?","body":"<p>I have one SQL Query on my C# project with MVC3, that builds a menu structure.\nThis works but I can not embed my ASPxMenu into the project because for some reason is not compatible with Master page.</p>\n\n<p>Can i convert that Query to XML?</p>\n\n<p>If it will be an XML file, than it`s possible to attach to Html.Devexpress().Menu with .BindToXML</p>\n"},{"tags":["sql","sql-server","tree","root","adjacency-list"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":11646409,"title":"Finding the root node of a descendant in an Adjacency List","body":"<p>In an <strong>Adjacency List</strong> table, given the id of a node, how can I find it's associated <strong>root node</strong>?</p>\n\n<p><em>Note:</em></p>\n\n<p><em>The table contains multiple trees so I cannot simply search for the null parentId.</em></p>\n\n<p><strong>Further Information:</strong></p>\n\n<p>This is what I currently have, any issues or improvements to this?</p>\n\n<pre><code>with tree as\n(\n    select \n        t.*\n\n    from table1 t\n    where t.id = @id\n\n    union all \n\n    select \n        t2.*\n\n    from tree\n    join table1 t2 on tree.parentId = t2.id\n) \n\nselect * \nfrom tree\nwhere parentId is null\n</code></pre>\n"},{"tags":["mysql","sql","query","explain"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13291062,"title":"Mysql: Large Query with subqueries optimization","body":"<p>Any query optimization gurus in the house??  </p>\n\n<p>Anyway, I trying to attach this on two fronts, one I'm trying to code a way around it but secondly, I'm thinking some real optimization might help in the short trem while we create a more complex, more robust fix.  So without further exposition, here's the query:</p>\n\n<pre><code>select \n      Date(events.start_time) as event_date, \n      if(transactions.type = 'BoxOfficeTransaction', \n         (select sales_outlets.name \n            from \n                  ticket_agents, \n                  sales_outlets \n            where \n                  transactions.ticket_agent_id = ticket_agents.id \n              and ticket_agents.sales_outlet_id = sales_outlets.id), \n         transactions.type) as location, \n      ticket_types.name as price_type, \n      ticket_types.price as cost, \n      if (transactions.type = 'WebTransaction', \n          ( select count(tickets.id) \n               from \n                  tickets, \n                  transactions, \n                  events, \n                  ticket_types \n               where \n                      tickets.transaction_id = transactions.id \n                  and tickets.event_id = events.id \n                  and tickets.ticket_type_id = ticket_types.id \n                  and transactions.type = 'WebTransaction' \n                  and ticket_types.name = price_type \n                  and Date(events.start_time) = event_date \n                  and tickets.status = 'active'), \n          ( select count(tickets.id) \n               from \n                  tickets, \n                  transactions, \n                  events, \n                  ticket_types, \n                  ticket_agents, \n                  sales_outlets \n               where \n                      tickets.transaction_id = transactions.id \n                  and tickets.event_id = events.id \n                  and tickets.ticket_type_id = ticket_types.id \n                  and transactions.ticket_agent_id = ticket_agents.id \n                  and ticket_agents.sales_outlet_id = sales_outlets.id \n                  and ticket_types.name = price_type \n                  and Date(events.start_time) = event_date \n                  and tickets.status = 'active' \n                  and sales_outlets.name = location) \n         ) as quantity, \n      ( select quantity * ticket_types.price) as value, \n      ( select tickets.purchase_price * quantity) as revenue \n   from \n      events, \n      transactions, \n      tickets, \n      ticket_types \n   where \n          transactions.event_id = events.id \n      and tickets.transaction_id = transactions.id \n      and tickets.ticket_type_id = ticket_types.id \n      and events.start_time &gt;= '2012-11-15 05:00:00' \n      and events.start_time &lt;= '2013-01-06 04:59:59' \n   group by \n      event_date, \n      location, \n      ticket_types.name\n</code></pre>\n\n<p>A doozy I know.  Here's the explain:</p>\n\n<pre><code>+----+--------------------+---------------+--------+-------------------------------------+-------------------+---------+---------------------------------------+------+-----------------------------------------------------------+\n| id | select_type        | table         | type   | possible_keys                       | key               | key_len | ref                                   | rows | Extra                                                     |\n+----+--------------------+---------------+--------+-------------------------------------+-------------------+---------+---------------------------------------+------+-----------------------------------------------------------+\n|  1 | PRIMARY            | events        | index  | PRIMARY,event_date                  | event_date        | 13      | NULL                                  |   53 | Using where; Using index; Using temporary; Using filesort |\n|  1 | PRIMARY            | transactions  | ref    | PRIMARY,event_id                    | event_id          | 5       | abg_dev.events.id                     |   23 | Using where                                               |\n|  1 | PRIMARY            | tickets       | ref    | trans_id,ticket_types_id            | trans_id          | 5       | abg_dev.transactions.id               |    2 | Using where                                               |\n|  1 | PRIMARY            | ticket_types  | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.ticket_type_id        |    1 |                                                           |\n|  4 | DEPENDENT SUBQUERY | sales_outlets | ref    | PRIMARY,sales_outlet_name           | sales_outlet_name | 767     | func                                  |    1 | Using where; Using index                                  |\n|  4 | DEPENDENT SUBQUERY | ticket_types  | ref    | PRIMARY,type_name,ticket_types_name | type_name         | 767     | func                                  |    4 | Using index                                               |\n|  4 | DEPENDENT SUBQUERY | tickets       | ref    | trans_id,ticket_types_id            | ticket_types_id   | 5       | abg_dev.ticket_types.id               |  441 | Using where                                               |\n|  4 | DEPENDENT SUBQUERY | events        | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.event_id              |    1 | Using where                                               |\n|  4 | DEPENDENT SUBQUERY | transactions  | eq_ref | PRIMARY,ticket_agent_id             | PRIMARY           | 4       | abg_dev.tickets.transaction_id        |    1 |                                                           |\n|  4 | DEPENDENT SUBQUERY | ticket_agents | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.transactions.ticket_agent_id  |    1 | Using where                                               |\n|  3 | DEPENDENT SUBQUERY | ticket_types  | ref    | PRIMARY,type_name,ticket_types_name | type_name         | 767     | func                                  |    4 | Using index                                               |\n|  3 | DEPENDENT SUBQUERY | tickets       | ref    | trans_id,ticket_types_id            | ticket_types_id   | 5       | abg_dev.ticket_types.id               |  441 | Using where                                               |\n|  3 | DEPENDENT SUBQUERY | transactions  | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.transaction_id        |    1 | Using where                                               |\n|  3 | DEPENDENT SUBQUERY | events        | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.tickets.event_id              |    1 | Using where                                               |\n|  2 | DEPENDENT SUBQUERY | ticket_agents | eq_ref | PRIMARY                             | PRIMARY           | 4       | transactions.ticket_agent_id          |    1 |                                                           |\n|  2 | DEPENDENT SUBQUERY | sales_outlets | eq_ref | PRIMARY                             | PRIMARY           | 4       | abg_dev.ticket_agents.sales_outlet_id |    1 |                                                           |\n+----+--------------------+---------------+--------+-------------------------------------  +-------------------+---------+---------------------------------------+------+-----------------------------------------------------------+\n16 rows in set, 2 warnings (0.00 sec) \n</code></pre>\n\n<p>Indexes:</p>\n\n<pre><code>mysql&gt; show indexes from events;\n+--------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table  | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+--------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| events |          0 | PRIMARY    |            1 | id          | A         |          53 |     NULL | NULL   |      | BTREE      |         |               |\n| events |          1 | event_date |            1 | start_time  | A         |          53 |     NULL | NULL   | YES  | BTREE      |         |               |\n| events |          1 | event_date |            2 | id          | A         |          53 |     NULL | NULL   |      | BTREE      |         |               |\n+--------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; show indexes from transactions;\n+--------------+------------+---------------------+--------------+---------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table        | Non_unique | Key_name            | Seq_in_index | Column_name         | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+--------------+------------+---------------------+--------------+---------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| transactions |          0 | PRIMARY             |            1 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | ticket_agent_id     |            1 | ticket_agent_id     | A         |          41 |     NULL | NULL   | YES  | BTREE      |         |               |\n| transactions |          1 | ticket_agent_id     |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | user_id             |            1 | user_id             | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | user_id             |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | payment_method_type |            1 | payment_method_type | A         |           5 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | payment_method_type |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at          |            1 | created_at          | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at          |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at_by_user  |            1 | created_at          | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | created_at_by_user  |            2 | user_id             | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n| transactions |          1 | event_id            |            1 | event_id            | A         |          55 |     NULL | NULL   | YES  | BTREE      |         |               |\n| transactions |          1 | event_id            |            2 | id                  | A         |        1274 |     NULL | NULL   |      | BTREE      |         |               |\n+--------------+------------+---------------------+--------------+---------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n13 rows in set (0.00 sec)\n\nmysql&gt; show indexes from tickets;\n+---------+------------+-----------------+--------------+----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table   | Non_unique | Key_name        | Seq_in_index | Column_name    | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+---------+------------+-----------------+--------------+----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| tickets |          0 | PRIMARY         |            1 | id             | A         |        4330 |     NULL | NULL   |      | BTREE      |         |               |\n| tickets |          0 | barcode_index   |            1 | barcode        | A         |        4330 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tickets |          1 | trans_id        |            1 | transaction_id | A         |        2165 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tickets |          1 | trans_id        |            2 | id             | A         |        4330 |     NULL | NULL   |      | BTREE      |         |               |\n| tickets |          1 | ticket_types_id |            1 | ticket_type_id | A         |           9 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tickets |          1 | ticket_types_id |            2 | id             | A         |        4330 |     NULL | NULL   |      | BTREE      |         |               |\n+---------+------------+-----------------+--------------+----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n6 rows in set (0.00 sec)\n\nmysql&gt; show indexes from sales_outlets;\n+---------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table         | Non_unique | Key_name          | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+---------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| sales_outlets |          0 | PRIMARY           |            1 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| sales_outlets |          1 | sales_outlet_name |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| sales_outlets |          1 | sales_outlet_name |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n+---------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n3 rows in set (0.00 sec)\n\nmysql&gt; show indexes from ticket_types;\n+--------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table        | Non_unique | Key_name          | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+--------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| ticket_types |          0 | PRIMARY           |            1 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | type_name         |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | type_name         |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | price             |            1 | price       | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | price             |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | ticket_types_name |            1 | name        | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n| ticket_types |          1 | ticket_types_name |            2 | id          | A         |           2 |     NULL | NULL   |      | BTREE      |         |               |\n+--------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n7 rows in set (0.00 sec)\n</code></pre>\n\n<p>Transactions is about 3000 rows\nTickets is about 6000 rows\nSales Outlets is 3 rows\nTicket_types is 18 rows</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13290804,"title":"How do I change the Data source into Microsoft SQL Server in Visual C#?","body":"<p>I was using this <a href=\"http://razibdeb.wordpress.com/2011/01/23/sql-server-2008-basics-connection-with-vs2010/\" rel=\"nofollow\">tutorial</a> and I'm stuck in this <a href=\"http://razibdeb.files.wordpress.com/2011/01/ms-sql.png\" rel=\"nofollow\">part</a>. The guide tells me to choose 'Microsoft SQL Server', however this is not included in the options of my computer. I only have 'Microsoft Database File', 'Microsoft Server Compact', and 'Microsoft Database Server File'. </p>\n\n<p>How could I add the option 'Microsoft SQL Server'?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13293975,"title":"Month year back (SQL)","body":"<p>I m trying to dig more in the SQL query , I'm with it.</p>\n\n<pre><code>Yearmo      Back_1_month\n-------     ------------\n 201202      201201            Where 201202 is Feb 2012 , 201201 is Jan 2012\n 201201      201112            \n 201204      201203            \n 201212      201211\n</code></pre>\n\n<p>I m confused , how can make it for 201201.</p>\n"},{"tags":["mysql","sql","database-design","foreign-keys","primary-key"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13292050,"title":"Composite primary key in identifying relationship: why?","body":"<p>OK, I hope this is an appropriate question for stackoverflow as I'm trying to understand a concept rather than fixing a piece of code that won't work.</p>\n\n<p>I'll take a general example of a <strong>form</strong> (parent table) and a <strong>form field</strong> (child table). <strong>Logically</strong>, this would be an identifying relationship, since a form field cannot exist without a form.</p>\n\n<p><img src=\"http://i.stack.imgur.com/CaC1h.png\" alt=\"form and form_field tables\"></p>\n\n<p>This would make me think that in order to translate the <strong>logical</strong> relationship into the <strong>technical</strong> relationship, a simple <code>NOT NULL</code> for the form_id field in the form_field table would suffice. (see the left part of above screenshot)</p>\n\n<p>However, when I add an identifying relationship using MySQL Workbench, form_id is not only <code>NOT NULL</code> but also part of the primary key. (see the right part of above screenshot)<br>\nAnd when I add a non-identifying relationship, <code>NOT NULL</code> is still applied so logically it would actually be an identifying relationship as well.</p>\n\n<p>I guess this confuses me a little, as well as the fact that until now I always simply used the id field as primary key.</p>\n\n<p>So I understand the <strong>logical</strong> concept of identifying vs. non-identifying relationships, but I don't understand the <strong>technical</strong> part. Why is it, as <a href=\"http://stackoverflow.com/a/762994/1001110\">this answer</a> states, 'the \"right\" way to make the foreign key part of the child's primary key'? What is the benefit of these composite primary keys?</p>\n"},{"tags":["sql","ruby-on-rails","postgresql","database-design","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":13272776,"title":"What to use instead of Polymorphic Associations?","body":"<p>So for a number of reasons Polymorphic Associations are considered bad database design, e.g. you can't have foreign keys on the polymorphic id columns so referential integrity is gone.</p>\n\n<p>And, STI is also considered bad <em>unless</em> the sub-types only differ on behavior.</p>\n\n<p>So my question is <b>for Rails / ActiveRecord</b> what is the lesser evil in the following scenario:</p>\n\n<p>I need to allow my users to create a hand-ordered collection of multiple types of entities.</p>\n\n<p>Using Polymorphic Associations the schema would look something like this:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, exhibitable_type, exhibitable_id, position\n\n-- photographs\nid, ...\n\n-- films\nid, ...\n\n-- paintings\nid, ...\n\n-- songs\nid, ...\n\n-- sculptures\nid, ...\n</code></pre>\n\n<p>I could use STI and have something like this:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, artwork_id, position\n\n-- artworks\nid, type, &lt;photograph columns&gt;, &lt;film columns&gt;, &lt;painting columns&gt;, etc.\n</code></pre>\n\n<p>But, because my artworks differ on data (and not just behavior), I now have NULLs all over the artworks table. I've also introduced an inheritance hierarchy to my objects which previously wasn't there and I am generally wary of, particularly when its only purpose is to serve the database design.</p>\n\n<p>STI does seem like it would at least be simpler to query and code for.</p>\n\n<p>So which is the lesser evil?</p>\n\n<p>Then, the other option is multi-table inheritance:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, artwork_id, position\n\n-- artworks\nid\n\n-- photographs\nartwork_id, &lt;photograph columns&gt;\n\n-- films\nartwork_id, &lt;film columns&gt;\n</code></pre>\n\n<p>This would get rid of STI's NULL problem and also keep the table sizes down. We still have object hierarchy that I don't think is strictly necessary. But the biggest problem in my eyes: Rails doesn't support it. The <a href=\"https://github.com/peterhamilton/citier/\" rel=\"nofollow\">CITIER</a> gem looks very nice and it has recent commits but it is not that widely used so I am cautious of using it in my app's foundation. I guess I could also look at using Sequel or another ORM that has CTI support.</p>\n\n<p>Truth be told I think I like the multi-table inheritance solution the best</p>\n\n<p>If I didn't need the position column I would simply use separate join tables like <code>collections_photographs</code>, <code>collections_paintings</code>, <code>collections_films</code>, etc. but I do need that manual ordering.</p>\n\n<p>So, it seems the options are:</p>\n\n<ul>\n<li>PA: loss of referential integrity (does it matter in practice if always using ActiveRecord for database access?)</li>\n<li>STI: big table with lots of nulls</li>\n<li>CTI/MTI: relying on a gem that isn't widely used</li>\n</ul>\n\n<p>Which is the lesser evil and are there any other options? I am using Postgres.</p>\n"},{"tags":["sql","table","alias"],"answer_count":18,"favorite_count":4,"up_vote_count":24,"down_vote_count":0,"view_count":8708,"score":24,"question_id":11043,"title":"SQL Table Aliases - Good or Bad?","body":"<p>What are the pros and cons of using table aliases in SQL?  I personally try to avoid them, as I think they make the code less readable (especially when reading through large where/and statements), but I'd be interested in hearing any counter-points to this.  When is it generally a good idea to use table aliases, and do you have any preferred formats?</p>\n"},{"tags":["sql","asp.net-mvc","asp.net-mvc-3","foreach"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13294801,"title":"SQL View + foreach not looping through results","body":"<p>I have a view that is returning a resultset LEFT OUTER JOIN from a SQL Database.  I'm using MVC 3 to display a partial view based on the resultset.  But....</p>\n\n<pre><code>@foreach (var category in Model.FeeScheduleRates().Distinct())\n{\n     &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n     foreach (var item in Model.FeeScheduleRates()\n                               .Where(i=&gt;i.Cat_ID == category.Cat_ID))\n     {                               \n         &lt;tr&gt; \n             &lt;td&gt;@item.Fee_Title - @item.Description&lt;/td&gt;\n             &lt;td&gt;@item.Amount&lt;/td&gt;                                        \n         &lt;/tr&gt;\n     }                                   \n}\n</code></pre>\n\n<p>The view isn't looping through the second foreach loop.  Rather, it repeats the first entry as many times as there are matching records.  So it should create a table with a row spanning two columns for each category, and then display the items in that category (Title, Description and amount.</p>\n\n<p>Why doesn't the second foreach loop work?</p>\n\n<p>EDIT:  As requested The View</p>\n\n<pre><code>SELECT  TOP (100) PERCENT a.Cat_ID, a.Fee_Title, a.Description, a.Amount, b.Category\nFROM     dbo.Fee_Schedule AS a LEFT OUTER JOIN\n           dbo.Fee_Categories AS b ON a.Cat_ID = b.Cat_ID\nORDER BY a.Cat_ID\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":20,"score":0,"question_id":13294882,"title":"Have one part of a query update based on another","body":"<p>I'm not looking for a specific answer to a question so much as a general direction of what to look for when doing further research.  I have a query which is very useful and a certain aspect, <code>mytable.column1</code> I frequently change.  Depending on what <code>mytable.column1</code> is, there is an alias in the table that I would like to change as well.  So, if <code>mytable.column1</code> is 1 the alias needs to be something like <code>aliasFor1</code>, if it's two, then the alias needs to be <code>aliasFor2</code>.  What is the nomenclature for doing something such as this, and what are some good resources for reading up on it?  </p>\n\n<p>If you're going to down vote a question, please respectfully say why you believe it to be not a valid question.</p>\n"},{"tags":["php","sql","arrays","query","variables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13295163,"title":"Store data in PHP Array from Query","body":"<p>I would like to store this data in a variable line by line.  I already have the query written and this is what it returns.  Some are missing because there were 0 results.  But I would like to account for those, too.</p>\n\n<pre><code>    total   unique  uristem\n\n    1665    320     /Run\n    2103    845     /Add\n    5114    267     /Download\n    2576    720     /Time\n    8246    1252    /RunBegin\n    856     257     /Edit\n    1226    369     /Open\n</code></pre>\n\n<p>I want each one to look something like this:</p>\n\n<pre><code>Array\n(\n    [a] =&gt; 1665\n    [b] =&gt; 320\n    [c] =&gt; /Run\n)\n\nArray\n(\n    [a] =&gt; 2103\n    [b] =&gt; 845\n    [c] =&gt; /Add\n)\n</code></pre>\n\n<p>I'm thinking of storing this output in a temporary file and then parsing through it.  Any ideas?</p>\n\n<p>Thanks!</p>\n\n<p>--</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13294961,"title":"Sql query to check for name in perticular pattern","body":"<p>How do I efficiently find names that don't follow firstname,lastname pattern? I am using my SQL id is the primary key.</p>\n\n<pre><code>select name \n    from  Person where name not like '%,%' \n</code></pre>\n\n<p>This include patterns like firstname which is valid. How do I get rid of those results?</p>\n"},{"tags":["sql","oracle","datapump","impdp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13292135,"title":"Oracle data pump import into existing table","body":"<p>i need an efficient way to copy data from one database to another.\nBoth are based on Oracle 11g.</p>\n\n<ol>\n<li>Step: (Re)create new tables</li>\n<li>Step: Install pl sql packages</li>\n<li>Step: export tables tab_old1 and tab_old2 from database 1 with expdp</li>\n<li>Step: import into tab_new1 and tab_new2 database 2 with impdp</li>\n<li>+x Step: Use installed pl sql procedures </li>\n</ol>\n\n<p>Challenges:\nThe pl sql procedures uses already tab_new1 and tab_new2. Thus, I create both tables in step 1 and 2. \nIn step 3 and 4 I import and export only data.\nBut tab_new1 and tab_new2 have additional columns -> import fails. \nI tried to create views without the new columns. </p>\n\n<p>Import fails with the following error message:</p>\n\n<pre><code>ORA-31693: Table data object \"Schema\".\"tab_old1\" failed to load/unload and is being skipped due to error:\nORA-31603: object “tab_old1” of type TABLE not found in schema “Schema” \n\nORA-31693: Table data object \"Schema\".\"tab_old2\" failed to load/unload and is being skipped due to error:\nORA-31603: object “tab_old2” of type TABLE not found in schema “Schema” \n</code></pre>\n\n<p>The views are called tab_old1 and tab_old2, but of course they are not of type TABLE.</p>\n\n<p>Any ideas?</p>\n\n<p>How can I import my data from tab_old1 in an existing table with additional columns?</p>\n\n<p>I don't want to export / import the tables in the first step, rename them, and install pl sqls procedures afterwards. </p>\n\n<p>Could you help me?</p>\n\n<p><strong>edit:</strong></p>\n\n<p>Thanks for your answer. I tried it twice, but the remap_table function does not work for me:</p>\n\n<pre><code>host impdp test/testtables=foo remap_table=foo:foo2 directory=data_pump_dir content=data_only\n\nImport: Release 11.1.0.6.0 - 64bit Production on Donnerstag, 08 November, 2012 17:15:33\n\nCopyright (c) 2003, 2007, Oracle.  All rights reserved.\n\n...\nORA-31693: Table data object \"TEST\".\"FOO\" failed to load/unload \nand is being skipped due to error: \nORA-00942: table or view does not exist\n</code></pre>\n\n<p>?! I really did what you described. </p>\n\n<p>Maybe because of the release version? Release 11.1 instead of 11.2?</p>\n\n<p>Any ideas? Workarounds?</p>\n\n<p><strong>edit 2:</strong>\nto be more precise, what I did.</p>\n\n<p>I created a new table called foo :)</p>\n\n<pre><code>SQL*Plus: Release 11.1.0.6.0 - Production on Do Nov 8 18:37:10 2012\n\nCopyright (c) 1982, 2007, Oracle.  All rights reserved.\n\n\nVerbunden mit:\nOracle Database 11g Enterprise Edition Release 11.1.0.6.0 - 64bit Production\nWith the Partitioning, OLAP, Data Mining and Real Application Testing options\n\nSQL&gt; create table foo(id number);\n\nTabelle wurde erstellt.\n\nSQL&gt; insert into foo select rownum from dual connect by level &lt;= 5;\n\n5 Zeilen wurden erstellt.\n\nSQL&gt; commit;\n\nTransaktion mit COMMIT abgeschlossen.\n</code></pre>\n\n<p>Export :)</p>\n\n<pre><code>SQL&gt; host expdp test/test tables=foo directory=data_pump_dir reuse_dumpfiles=y\n\nExport: Release 11.1.0.6.0 - 64bit Production on Donnerstag, 08 November, 2012 18:38:31\n\nCopyright (c) 2003, 2007, Oracle.  All rights reserved.\n\nAngemeldet bei: Oracle Database 11g Enterprise Edition Release 11.1.0.6.0 - 64bit Production\nWith the Partitioning, OLAP, Data Mining and Real Application Testing options\n\"TEST\".\"SYS_EXPORT_TABLE_01\":  test/******** tables=foo directory=data_pump_dir reuse_dumpfiles=y  wird gestartet\nSchÃ¤tzung erfolgt mit Methode BLOCKS...\nObjekttyp TABLE_EXPORT/TABLE/TABLE_DATA wird verarbeitet\nGesamte SchÃ¤tzung mit BLOCKS Methode: 64 KB\nObjekttyp TABLE_EXPORT/TABLE/TABLE wird verarbeitet\n. . \"TEST\".\"FOO\"                                5.031 KB       5 Zeilen exportiert\nMaster-Tabelle \"TEST\".\"SYS_EXPORT_TABLE_01\" erfolgreich geladen/entladen\n******************************************************************************\nFÃ¼r TEST.SYS_EXPORT_TABLE_01 festgelegte Dump-Datei ist:\n  /opt/oracle/admin/plis/dpdump/expdat.dmp\nJob \"TEST\".\"SYS_EXPORT_TABLE_01\" erfolgreich um 18:38:39 abgeschlossen\n</code></pre>\n\n<p>Foo -> Foo2 :)</p>\n\n<pre><code>SQL&gt; delete from foo;\n\n5 Zeilen wurden gelÃ¶scht.\n\nSQL&gt; alter table foo add (a varchar2(200));\n\nTabelle wurde geÃ¤ndert.\n\nSQL&gt; alter table foo rename to foo2;\n\nTabelle wurde geÃ¤ndert.\n</code></pre>\n\n<p>Expected error without remap_table. But the error messages are different. ORA-31693 (Table data object \"TEST\".\"FOO\" failed to load/unload and is being skipped due to error ) and ORA-00942 (table or view does not exist). :| </p>\n\n<pre><code>SQL&gt; host impdp test/test tables=foo directory=data_pump_dir content=data_only\n\nImport: Release 11.1.0.6.0 - 64bit Production on Donnerstag, 08 November, 2012 18:39:27\n\nCopyright (c) 2003, 2007, Oracle.  All rights reserved.\n\nAngemeldet bei: Oracle Database 11g Enterprise Edition Release 11.1.0.6.0 - 64bit Production\nWith the Partitioning, OLAP, Data Mining and Real Application Testing options\nMaster-Tabelle \"TEST\".\"SYS_IMPORT_TABLE_01\" erfolgreich geladen/entladen\n\"TEST\".\"SYS_IMPORT_TABLE_01\":  test/******** tables=foo directory=data_pump_dir content=data_only  wird gestartet\nObjekttyp TABLE_EXPORT/TABLE/TABLE_DATA wird verarbeitet\nORA-31693: Tabellendatenobjekt \"TEST\".\"FOO\" konnte nicht geladen/entladen werden und wird wegen Fehler Ã¼bersprungen:\nORA-00942: Tabelle oder View nicht vorhanden\nJob \"TEST\".\"SYS_IMPORT_TABLE_01\" mit 1 Fehler(n) um 18:39:29 abgeschlossen\n</code></pre>\n\n<p>Export with remap_table. Failed. ORA-31693 and ORA-00942, again. :(</p>\n\n<pre><code>SQL&gt; host impdp test/test tables=foo remap_table=foo:foo2 directory=data_pump_dir content=data_only\n\nImport: Release 11.1.0.6.0 - 64bit Production on Donnerstag, 08 November, 2012 18:40:14\n\nCopyright (c) 2003, 2007, Oracle.  All rights reserved.\n\nAngemeldet bei: Oracle Database 11g Enterprise Edition Release 11.1.0.6.0 - 64bit Production\nWith the Partitioning, OLAP, Data Mining and Real Application Testing options\nMaster-Tabelle \"TEST\".\"SYS_IMPORT_TABLE_01\" erfolgreich geladen/entladen\n\"TEST\".\"SYS_IMPORT_TABLE_01\":  test/******** tables=foo remap_table=foo:foo2 directory=data_pump_dir content=data_only  wird gestartet\nObjekttyp TABLE_EXPORT/TABLE/TABLE_DATA wird verarbeitet\nORA-31693: Tabellendatenobjekt \"TEST\".\"FOO\" konnte nicht geladen/entladen werden und wird wegen Fehler Ã¼bersprungen:\nORA-00942: Tabelle oder View nicht vorhanden\nJob \"TEST\".\"SYS_IMPORT_TABLE_01\" mit 1 Fehler(n) um 18:40:16 abgeschlossen\n</code></pre>\n\n<p>I don't see my mistake(s). Any ideas?</p>\n"},{"tags":["android","sql","sqlite","distance"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13293582,"title":"from sqlite to sql android","body":"<p>i have this query</p>\n\n<pre><code>\"SELECT  id, ssid, bssid, capabilities, level, frequency,geolat, geolong, nickname, ( \"+rangeDouble+ \" * ACOS( (SIN( \" +pi+ \" * \" +geoLat+\"/180 ) * SIN( \" +pi+ \" * lat /180 ) ) + ( COS( \" +pi+ \" * \" +geoLat+ \" /180 ) * COS( \" +pi+\" * lat /180 ) * COS( ABS( ( \" + pi +\" * \" + geoLng + \"  /180 ) - ( \" +pi+ \" * longg /180 ) ) ) ) )) AS distanza FROM wifiTable HAVING distanza &lt;\"+ rangeDouble  +\" ORDER BY  distanza LIMIT 0 , 20\", null)\n</code></pre>\n\n<p>distanza is like distance in english.</p>\n\n<p>how can i transform this query from sql to sqlite? Because i don't know how to use \"lat\" obtained by select in java code!</p>\n\n<p>please help me :)</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13294401,"title":"SQL Server Availability Group Issue - Removed from primary and secondary stucking in resolving","body":"<p>I have an availability group that was removed on the primary server.  The secondary server has this availability in a resolving state.</p>\n\n<p>When I try to drop the availability group I get cannot drop the availability group 'Name', because it does not exist or you do not have permission (I am an admin).</p>\n\n<p>I try to remove the database by issuing:</p>\n\n<pre><code>ALTER DATABASE [DATABASE NAME] SET HADR OFF \n</code></pre>\n\n<p>And I get:</p>\n\n<blockquote>\n  <p>The availability group 'group guid' and/or its local availability replica does not exist.  Verify that the specified availability group name is correct, and that the local availability replica has joined the availability group, then retry the operation.</p>\n</blockquote>\n\n<p>Anyone know how to permanently remove this availability group?  Cannot do anything with the 2 databases that are in it.</p>\n"},{"tags":["sql","database","visual-studio-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13293827,"title":"How to configure visual basic application to connect to remote sql database","body":"<p>I just created my Visual basic application which connects and uses Sql database on my system.\nAnd its working properly.</p>\n\n<p>My Stupid problem is when i distribute my application to my friends on INTRANET/LAN, how do i make them communicate to my SQL Database on my system.</p>\n\n<p>If this needs some study, kindly refer me the topics and references to learn.</p>\n"},{"tags":["c#","sql","database","api","concurrency"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":184,"score":3,"question_id":13224787,"title":"Database recommendations needed -> Columnar, Embedded (if possible), fast, fast, fast","body":"<p>I am searching for the ideal database structure/solution that meets most of my below requirements but so far I utterly failed. Can you please help?</p>\n\n<p>My tasks: I run a process in .Net 4.5 (C#) and generate (generally) value types that I want to use for further analysis in other applications and therefore like to either preserve in-memory or persist on disk. More below. The data is generated within different tasks/threads and thus a row based data format does not lend itself well to match this situation (because the data generated in different threads is generated at different times and is thus not aligned). Thus I thought a columnar data structure may be suitable but please correct me if I am wrong.</p>\n\n<p>Example:</p>\n\n<p>Tasks/Thread #1 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000001 233.23</p>\n\n<p>1000000002 233.34</p>\n\n<p>1000000006 234.23\n...</p>\n\n<p>Taks/Thread #2 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000002 33.32</p>\n\n<p>1000000005 34.34</p>\n\n<p>1000000015 54.32\n...</p>\n\n<p>I do not need to align the time stamps at the .Net run-time, I am first and foremost after preserving the data and to process the data within R or Python at a later point.</p>\n\n<p>My requirements:</p>\n\n<ul>\n<li><p>Fast writes, fast writes, fast writes: It can happen that I generate 100,000- 1,000,000 data points per second and need to persist (worst case) or retain in memory the data. Its ok to run the writes on its own thread so this process can lag the data generation process but limitation is 16gb RAM (64bit code), more below.</p></li>\n<li><p>Preference is for columnar db format as it lends itself well to how I want to query the data later but I am open to any other structure if it makes sense in regards to the examples above (document/key-value also ok if all other requirements are met, especially in terms of write speed). </p></li>\n<li><p>API that can be referenced from within .Net. Example: HDF5 may be considered capable by some but I find their .Net port horrible.Something that supports .Net a little better would be a plus but if all other requirements are met then I can deal with something similar to the HDF5 .Net port.  </p></li>\n<li><p>Concurrent writes if possible: As described earlier I like to write data concurrently from different tasks/threads.</p></li>\n<li><p>I am constrained by 16gb memory (run .Net process in 64bit) and thus I probably look for something that is not purely in-memory as I may sometimes generate more data than that. Something in-memory which persists at times or a pure persistence model is probably preferable. </p></li>\n<li><p>Preference for embedded but if a server in a client/server solution can run as a windows service then no issue. </p></li>\n<li><p>In terms of data access I have strong preference for a db solution for which interfaces from R and Python already exist because I like to use the Panda library within Python for time series alignments and other analysis and run analyses within R.</p></li>\n<li><p>If the API/library supports in addition SQL/SQL-like/Linq/ like queries that would be terrific but generally I just need the absolute bare bones such as load columnar data in between start and end date (given the \"key\"/index is in such format) because I analyze and run queries within R/Python.</p></li>\n<li><p>If it comes with a management console or data visualizer that would be a plus but not a must. </p></li>\n<li><p>Should be open source or priced within \"reach\" (no, KDB does not qualify in that regards ;-)</p></li>\n</ul>\n\n<p>OK, here is what I have so far, and again its all I got because most db solution simply fail already on the write performance requirement:</p>\n\n<ul>\n<li>Infobright and Db4o. I like what I read so far but I admit I have not checked into any performance stats</li>\n<li>Something done myself. I can easily store value types in binary format and index the data by datetime.ticks , I just would need to somehow write scripts to load/deserialize the data in Python/R. But it would be a massive tasks if I wanted to add concurrency, a query engine, and other goodies. Thus I look for something already out there. </li>\n</ul>\n"},{"tags":["sql","superset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13292136,"title":"SQL: find all the courses in which the set of enrolled students is a superset of the students who have enrolled in some course C","body":"<p>i was thinking on the sql query in a student database :\nstudent(sid,sname)\n,course(cid,cname)\n,enrol(sid,cid)</p>\n\n<p>find all the courses in which the set of enrolled students is a superset of the students who have enrolled in some course C</p>\n\n<p>how will this query be written?</p>\n"},{"tags":["sql","sql-server","tsql","date"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":12474658,"title":"Calculate total working days left of the month","body":"<p>Below is my code to calculate the total amount of working days in the current month.</p>\n\n<pre><code>DECLARE @my int\nDECLARE @myDeduct int\nDECLARE @day INT\nDECLARE @mydate DATETIME\n\nSET @mydate = getDate()\n\nSET @myDeduct = 0\nSET DateFirst 1 -- Set it monday=1 (value)\n\n--Saturday and Sunday on the first and last day of a month will Deduct 1\nIF (DATEPART(weekday,(DATEADD(dd,-(DAY(@mydate)-1),@mydate))) &gt; 5)\nSET @myDeduct = @myDeduct + 1\n\nIF (DATEPART(weekday,(DATEADD(dd,-(DAY(DATEADD(mm,1,@mydate))),\n                                                 DATEADD(mm,1,@mydate)))) &gt; 5)\nSET @myDeduct = @myDeduct + 1\n\nSET @my = day(DATEADD(dd,-(DAY(DATEADD(mm,1,@mydate))),DATEADD(mm,1,@mydate)))\n\nselect (((@my/7) * 5 + (@my%7)) - @myDeduct) as Working_Day_per_month\n</code></pre>\n\n<p>How can I now calculate how many of those working days are left for the current month?\nNot worried about public holidays.</p>\n"},{"tags":["sql","sql-server","function","scalar"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13293516,"title":"When is the dm_db_partition_stats updated?","body":"<p>I want to create a scalar SQL function that checks the row count of a table using dm_db_partition_stats. I have a handful of tables that get pushed to me and during that time the tools that use those tables are rendered useless. </p>\n\n<p>I have these tables backed up on another server. What I'd like to do is run a check on the row count. If the results are 0 then the scalar function will return a 1. In the .NET front-end if a 1 is returned then it can query the backup data.</p>\n\n<p>My question is when will the row count get updated in dm_db_partition_stats? Is it immediately or is there some lag involved?</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008-r2","common-table-expression"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13293359,"title":"Joining massive CTE tables (13,000,000 rows+) performance problems","body":"<p>We have a production database that manages personnel booking at 100s of branches for years in advance with minute level accuracy.</p>\n\n<p>Part of this system are reports that highlight gaps, i.e. compare branch opening hours and staff bookings to see if any branches are open with nobody booked.</p>\n\n<p>It also checks for overlaps, double bookings etc all at the same time, basically minute level accuracy is required.</p>\n\n<p>The way we're doing this is to expand the start and end times of openings hours and bookings into minutes with an integer tally table:</p>\n\n<pre><code>--===== Create and populate the Tally table on the fly\n SELECT TOP 16777216\n        IDENTITY(INT,1,1) AS N\n   INTO dbo.Tally\n   FROM Master.dbo.SysColumns sc1,\n        Master.dbo.SysColumns sc2,\n        Master.dbo.SysColumns sc3\n\n--===== Add a Primary Key to maximize performance\n  ALTER TABLE dbo.Tally\n    ADD CONSTRAINT PK_Tally_N \n        PRIMARY KEY CLUSTERED (N) WITH FILLFACTOR = 100\n</code></pre>\n\n<p>We utilise this static indexed tally table to expand opening hours and bookings as follows:</p>\n\n<pre><code>SELECT   [BranchID] ,\n        [DayOfWeek] ,\n        DATEADD(MINUTE, N - 1, StartTime)\nFROM     OpeningHours\n        LEFT OUTER JOIN tally ON tally.N BETWEEN 0\n                                         AND     DATEDIFF(MINUTE, OpeningHours.StartTime, OpeningHours.EndTime) + 1\n</code></pre>\n\n<p>The problem is, once we have the 13,000,000 \"open minutes\" and the \"booked minutes\" we then need to join the results to see what's covered:</p>\n\n<pre><code>SELECT   OpenDatesAndMinutes.[Date] ,\n                                OpenDatesAndMinutes.[Time] ,\n                                OpenDatesAndMinutes.[BranchID] ,\n                                ISNULL(BookedMinutes.BookingCount, 0) AS BookingCount\n                       FROM     OpenDatesAndMinutes\n                                LEFT OUTER JOIN BookedMinutes ON OpenDatesAndMinutes.BranchID = BookedMinutes.BranchID\n                                                                 AND OpenDatesAndMinutes.[Date] = BookedMinutes.[Date]\n                                                                 AND OpenDatesAndMinutes.[Time] = BookedMinutes.[Time]\n</code></pre>\n\n<p>As you can imagine, joining on the branch, date &amp; time with 13,000,000 rows all stored in CTE tables takes AGES - running it for a week isnt too bad, about 10 seconds but if we run it for 6 months (13,000,000 minutes) bloats to 25 minutes+</p>\n\n<p>Once we have joined the open minutes to the booked minutes we then group the data on islands and present to the user:</p>\n\n<pre><code>CrossTabPrep ( [Date], [Time], [BranchID], [BookingCount], [Grp] )\n  AS ( SELECT   [Date] ,\n                [Time] ,\n                [BranchID] ,\n                [BookingCount] ,\n                DATEPART(HOUR, Time) * 60 + DATEPART(MINUTE, Time) - ROW_NUMBER() OVER ( PARTITION BY [BranchID], Date, [BookingCount] ORDER BY Time ) AS [Grp]\n       FROM     PreRender\n     ),\nFinalRender ( [BranchID], [Date], [Start Time], [End Time], [Duration], [EntryCount], [EntryColour] )\n  AS ( SELECT   [BranchID] ,\n                [Date] ,\n                MIN([Time]) AS [Start Time] ,\n                MAX([Time]) AS [End Time] ,\n                ISNULL(DATEDIFF(MINUTE, MIN([Time]), MAX([Time])), 0) AS Duration ,\n                [BookingCount] AS EntryCount ,\n                CASE WHEN [BookingCount] = 0 THEN 'Red'\n                     WHEN [BookingCount] = 1 THEN 'Green'\n                     ELSE 'Yellow'\n                END AS EntryColour\n       FROM     CrossTabPrep\n       GROUP BY [BranchID] ,\n                [Date] ,\n                [BookingCount] ,\n                [Grp]\n     )\n</code></pre>\n\n<p>Quite simply, is my method efficient? is there any way i can improve on this method whilst retaining minute level accuracy? When dealing with massive CTE tables such as this, would there be any benefit in dumping this data to indexed temp tables &amp; joining them instead?</p>\n\n<p>Another thing I was considering is replacing the DATE &amp; TIME(0) data types that the big join uses, would is be more efficient if I cast these to integers?</p>\n\n<p>Here is the Full CTE in case that helps:</p>\n\n<pre><code>WITH    OpeningHours ( [BranchID], [DayOfWeek], [StartTime], [EndTime] )\n          AS ( SELECT   BranchID ,\n                        DayOfWeek ,\n                        CONVERT(TIME(0), AM_open) ,\n                        CONVERT(TIME(0), AM_close)\n               FROM     db_BranchDetails.dbo.tbl_ShopOpeningTimes (NOLOCK)\n                        INNER JOIN @tbl_Days Filter_Days ON db_BranchDetails.dbo.tbl_ShopOpeningTimes.DayOfWeek = Filter_Days.DayNumber\n               WHERE    CONVERT(TIME(0), AM_open) &lt;&gt; CONVERT(TIME(0), '00:00:00')\n               UNION ALL\n               SELECT   BranchID ,\n                        DayOfWeek ,\n                        CONVERT(TIME(0), PM_open) ,\n                        CONVERT(TIME(0), PM_close)\n               FROM     db_BranchDetails.dbo.tbl_ShopOpeningTimes (NOLOCK)\n                        INNER JOIN @tbl_Days Filter_Days ON db_BranchDetails.dbo.tbl_ShopOpeningTimes.DayOfWeek = Filter_Days.DayNumber\n               WHERE    CONVERT(TIME(0), PM_open) &lt;&gt; CONVERT(TIME(0), '00:00:00')\n               UNION ALL\n               SELECT   BranchID ,\n                        DayOfWeek ,\n                        CONVERT(TIME(0), EVE_open) ,\n                        CONVERT(TIME(0), EVE_close)\n               FROM     db_BranchDetails.dbo.tbl_ShopOpeningTimes (NOLOCK)\n                        INNER JOIN @tbl_Days Filter_Days ON db_BranchDetails.dbo.tbl_ShopOpeningTimes.DayOfWeek = Filter_Days.DayNumber\n               WHERE    CONVERT(TIME(0), EVE_open) &lt;&gt; CONVERT(TIME(0), '00:00:00')\n             ),\n        DateRange ( [Date], [DayOfWeek] )\n          AS ( SELECT   CONVERT(DATE, DATEADD(DAY, N - 1, @StartDate)) ,\n                        DATEPART(WEEKDAY, DATEADD(DAY, N - 1, @StartDate))\n               FROM     tally (NOLOCK)\n               WHERE    N &lt;= DATEDIFF(DAY, @StartDate, @EndDate) + 1\n             ),\n        OpenMinutes ( [BranchID], [DayOfWeek], [Time] )\n          AS ( SELECT   [BranchID] ,\n                        [DayOfWeek] ,\n                        DATEADD(MINUTE, N - 1, StartTime)\n               FROM     OpeningHours\n                        LEFT OUTER JOIN tally ON tally.N BETWEEN 0\n                                                         AND     DATEDIFF(MINUTE, OpeningHours.StartTime, OpeningHours.EndTime) + 1\n             ),\n        OpenDatesAndMinutes ( [Date], [Time], [BranchID] )\n          AS ( SELECT   DateRange.[Date] ,\n                        OpenMinutes.[Time] ,\n                        OpenMinutes.BranchID\n               FROM     DateRange\n                        LEFT OUTER JOIN OpenMinutes ON DateRange.DayOfWeek = OpenMinutes.DayOfWeek\n               WHERE    OpenMinutes.BranchID IS NOT NULL\n             ),\n        WhiteListEmployees ( [DET_NUMBERA] )\n          AS ( SELECT   DET_NUMBERA\n               FROM     [dbo].[tbl_ChrisCache_WhiteList]\n               WHERE    [TimeSheetV2_SecurityContext] = @TimeSheetV2_SecurityContext\n             ),\n        BookedMinutesByRole ( [Date], [Time], [BranchID], BookingCount )\n          AS ( SELECT   [BookingDate] ,\n                        DATEADD(MINUTE, N - 1, StartTime) ,\n                        BranchID ,\n                        COUNT(BookingID) AS Bookings\n               FROM     tbl_Booking (NOLOCK)\n                        INNER JOIN tbl_BookingReason  (NOLOCK) ON dbo.tbl_BookingReason.ReasonID = dbo.tbl_Booking.ReasonID\n                        INNER JOIN tbl_ChrisCache  (NOLOCK) ON dbo.tbl_Booking.DET_NUMBERA = dbo.tbl_ChrisCache.DET_NUMBERA\n                        INNER JOIN @ValidPosCodes AS Filter_PostCodes ON dbo.tbl_ChrisCache.POS_NUMBERA = Filter_PostCodes.POSCODE\n                        LEFT OUTER JOIN tally (NOLOCK) ON tally.N BETWEEN 0\n                                                                  AND     DATEDIFF(MINUTE, tbl_Booking.StartTime, tbl_Booking.EndTime) + 1\n               WHERE    ( Void = 0 )\n                        AND tbl_BookingReason.CoverRequired = 0 --#### Only use bookings that dont require cover\n                        AND tbl_booking.BranchID &lt;&gt; '023'   --#### Branch 23 will always have messy data\n                        AND ( dbo.tbl_Booking.BookingDate BETWEEN @StartDate\n                                                          AND     @EndDate )\n               GROUP BY [BookingDate] ,\n                        BranchID ,\n                        DATEADD(MINUTE, N - 1, StartTime)\n             ),\n        BookedMinutesByWhiteList ( [Date], [Time], [BranchID], BookingCount )\n          AS ( SELECT   [BookingDate] ,\n                        DATEADD(MINUTE, N - 1, StartTime) ,\n                        BranchID ,\n                        COUNT(BookingID) AS Bookings\n               FROM     tbl_Booking(NOLOCK)\n                        INNER JOIN tbl_BookingReason (NOLOCK) ON dbo.tbl_BookingReason.ReasonID = dbo.tbl_Booking.ReasonID\n                        INNER JOIN tbl_ChrisCache (NOLOCK) ON dbo.tbl_Booking.DET_NUMBERA = dbo.tbl_ChrisCache.DET_NUMBERA\n                        INNER JOIN WhiteListEmployees Filter_WhiteList ON dbo.tbl_Booking.DET_NUMBERA = Filter_WhiteList.DET_NUMBERA\n                        LEFT OUTER JOIN tally (NOLOCK) ON tally.N BETWEEN 0\n                                                                  AND     DATEDIFF(MINUTE, tbl_Booking.StartTime, tbl_Booking.EndTime) + 1\n               WHERE    ( Void = 0 )\n                        AND tbl_BookingReason.CoverRequired = 0 --#### Only use bookings that dont require cover\n                        AND tbl_booking.BranchID &lt;&gt; '023'   --#### Branch 23 will always have messy data\n                        AND ( dbo.tbl_Booking.BookingDate BETWEEN @StartDate\n                                                          AND     @EndDate )\n               GROUP BY [BookingDate] ,\n                        BranchID ,\n                        DATEADD(MINUTE, N - 1, StartTime)\n             ),\n        BookedMinutes ( [Date], [Time], [BranchID], BookingCount )\n          AS ( SELECT   [Date] ,\n                        [Time] ,\n                        [BranchID] ,\n                        BookingCount\n               FROM     BookedMinutesByRole\n               UNION\n               SELECT   [Date] ,\n                        [Time] ,\n                        [BranchID] ,\n                        BookingCount\n               FROM     BookedMinutesByWhiteList\n             ),\n        PreRender ( [Date], [Time], [BranchID], [BookingCount] )\n          AS ( SELECT   OpenDatesAndMinutes.[Date] ,\n                        OpenDatesAndMinutes.[Time] ,\n                        OpenDatesAndMinutes.[BranchID] ,\n                        ISNULL(BookedMinutes.BookingCount, 0) AS BookingCount\n               FROM     OpenDatesAndMinutes\n                        LEFT OUTER JOIN BookedMinutes ON OpenDatesAndMinutes.BranchID = BookedMinutes.BranchID\n                                                         AND OpenDatesAndMinutes.[Date] = BookedMinutes.[Date]\n                                                         AND OpenDatesAndMinutes.[Time] = BookedMinutes.[Time]\n             ),\n        CrossTabPrep ( [Date], [Time], [BranchID], [BookingCount], [Grp] )\n          AS ( SELECT   [Date] ,\n                        [Time] ,\n                        [BranchID] ,\n                        [BookingCount] ,\n                        DATEPART(HOUR, Time) * 60 + DATEPART(MINUTE, Time) - ROW_NUMBER() OVER ( PARTITION BY [BranchID], Date, [BookingCount] ORDER BY Time ) AS [Grp]\n               FROM     PreRender\n             ),\n        DeletedBranches ( [BranchID] )\n          AS ( SELECT   [ShopNo]\n               FROM     [dbo].[vw_BranchList]\n               WHERE    [Branch_Deleted] = 1\n             ),\n        FinalRender ( [BranchID], [Date], [Start Time], [End Time], [Duration], [EntryCount], [EntryColour] )\n          AS ( SELECT   [BranchID] ,\n                        [Date] ,\n                        MIN([Time]) AS [Start Time] ,\n                        MAX([Time]) AS [End Time] ,\n                        ISNULL(DATEDIFF(MINUTE, MIN([Time]), MAX([Time])), 0) AS Duration ,\n                        --dbo.format_timeV2(ISNULL(DATEDIFF(SECOND, MIN([Time]), MAX([Time])), 0)) AS DurationF ,\n                        [BookingCount] AS EntryCount ,\n                        CASE WHEN [BookingCount] = 0 THEN 'Red'\n                             WHEN [BookingCount] = 1 THEN 'Green'\n                             ELSE 'Yellow'\n                        END AS EntryColour\n               FROM     CrossTabPrep\n               GROUP BY [BranchID] ,\n                        [Date] ,\n                        [BookingCount] ,\n                        [Grp]\n             )\n            SELECT  [BranchID] ,\n                    CONVERT(VARCHAR(10), DATEADD(DAY, 7, CONVERT(DATETIME, CONVERT(VARCHAR(10), DATEADD(day, -1 - ( DATEPART(dw, [Date]) + @@DATEFIRST - 2 ) % 7, [Date]), 103) + ' 23:59:59', 103)), 103) AS WeekEnding ,\n                    [Date] ,\n                    [Start Time] ,\n                    [End Time] ,\n                    [Duration] ,\n                    CONVERT(VARCHAR, ( [Duration] * 60 ) / 3600) + 'h ' + CONVERT(VARCHAR, ROUND(( ( CONVERT(FLOAT, ( ( [Duration] * 60 ) % 3600 )) ) / 3600 ) * 60, 0)) + 'm' AS [DurationF] ,\n                    [EntryCount] ,\n                    [EntryColour] ,\n                    CASE WHEN [EntryCount] = 0 THEN 'Red'\n                         WHEN [EntryCount] &gt;= 1 THEN 'Green'\n                    END AS DurationColour ,\n                    CASE WHEN [EntryCount] = 0 THEN 'This period of open-time isnt covered'\n                         WHEN [EntryCount] &gt;= 1 THEN 'This period of open-time is covered by ' + CONVERT(VARCHAR, [EntryCount]) + ' booking(s)'\n                    END AS [DurationComment]\n            FROM    FinalRender\n            WHERE   FinalRender.BranchID NOT IN ( SELECT    [BranchID]\n                                                  FROM      DeletedBranches )\n</code></pre>\n"},{"tags":["java","sql","hsqldb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13291970,"title":"Execute Immediate for hsqldb","body":"<p>I have an HSQL 2.x database with a stored procedure. This procedure generates a dynamic SQL string that I want to execute. On Oracle I do this with the <em>execute immediate</em> command. I am having a hard time finding the equivalent for HSQLDB. Could someone please help out?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13151650,"title":"SQL Converting an INSERT SELECT to UPDATE as well","body":"<p>I have some SQL written up to address my problem but it is not quite ready. I have been attempting different queries for days now without much luck. FYI I inherited this DB so it may be a bit more advanced than what I am used to. </p>\n\n<p>There is a many-to-many relationship between Formula and Color using the bridge table FormulaColor. FormulaColor has the columns (FormulaId, ColorId, Percentage).</p>\n\n<p>My Business problem, we are converting all the formulas that use color A with the colors B(1%), C(2.8%) and D(96.2%). So if a Formula currently uses the color A as 50% of the formula then I would add a row for that formula with the B color and a percentage of .5%, a row for C color with a percentage of 1.4% and a row for D color with a percentage of 48.1%.</p>\n\n<p>The problem though, is a given formula that contains color A, may also already contain one or more of colors B, C or D. In that case I need to update the percentage by simply adding what was calculated above.</p>\n\n<p>The actual sql that I have so far is as follows. *Note that this is just for handling 1 of the new colors (ColorId=2594)</p>\n\n<pre><code>INSERT INTO FormulaColor (FormulaId, ColorId, Percentage) \nSELECT FormulaId, 2594 as ColorId, round((.01*FormulaColor.Percentage),2) as Percentage\nFROM FormulaColor WHERE ColorId=2595;\nDELETE FROM FormulaColor WHERE ColorId = 2595;\n</code></pre>\n\n<p>I was thinking that using the upsert method that uses @@rowscount is what I need? If so, I can't figure out how to do the update to just add the calculated amount to the percentage.</p>\n\n<p>Any help or resources is appreciated!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I ended up using the solution from Andriy M. In case it helps someone else out I am posting the actual SQL that I used.</p>\n\n<pre><code>DECLARE @DeletedColor int;\nDECLARE @Replacement TABLE (ColorId int, Percentage float);\n\n-- old ColorId getting replaced\nSET @DeletedColor = 2595\n\n-- new ColorId's and the percentages needed to recalculate\nINSERT INTO @Replacement (ColorId, Percentage) VALUES (2594, .01)\nINSERT INTO @Replacement (ColorId, Percentage) VALUES (2521, .028)\nINSERT INTO @Replacement (ColorId, Percentage) VALUES (2533, .962)\n\nSELECT\n  fc.FormulaId,\n  r.ColorId,\n  Percentage = round(fc.Percentage * r.Percentage, 2)\nINTO #FormulaColor\nFROM FormulaColor fc\nCROSS JOIN @Replacement r\nWHERE fc.ColorId = @DeletedColor\n;\n\nUPDATE old\nSET old.Percentage = old.Percentage + new.Percentage\nFROM FormulaColor old\nINNER JOIN #FormulaColor new\n ON old.FormulaId = new.FormulaId\nAND old.ColorId   = new.ColorId\n;\n\nINSERT INTO FormulaColor (FormulaId, ColorId, Percentage)\nSELECT new.FormulaId, new.ColorId, new.Percentage\nFROM #FormulaColor new\nLEFT JOIN FormulaColor old\n ON old.FormulaId = new.FormulaId\nAND old.ColorId   = new.ColorId\nWHERE old.FormulaId IS NULL\n;\n\nDELETE FROM FormulaColor WHERE ColorId = @DeletedColor;\n</code></pre>\n"},{"tags":["sql","sql-server","sqlcmd"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1090,"score":1,"question_id":1174231,"title":"How do we tell sqlcmd to continue \"on error\" with next batch?","body":"<p>Any ideas on how to accomplish this?</p>\n\n<pre><code>USE [db_name]\nBEGIN TRANSACTION\n...TONS OF INSERTS\nCOMMIT;\nRAISERROR (..) WITH NOWAIT;  //If error continue with next batch\n\nBEGIN TRANSACTION\n...TONS OF INSERTS\nCOMMIT;\nRAISERROR (..) WITH NOWAIT;\n\n...\n</code></pre>\n"},{"tags":["sql","sql-server","query","sql-server-2005","split"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13291954,"title":"SQL Query to split shipping cost over multiple items / rows","body":"<p>I am trying to create a query that will allow me to split a single figure over multiple rows.</p>\n\n<p>For example, purchase order x may have 15 items allocated to it.  Shipping cost is, say, 9.95.  How can I calculate 1/15th of 9.95 and then update the cost price of the stock with 1/15th of the shipping cost?</p>\n\n<p>Therefore the cost price of the item would increase from 4.50 to 5.16 (4.50 + 0.66).</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13293426,"title":"Conditional SQL select: when select has a value select all but the smallest date","body":"<p>Looking at the following SQL fiddle: <a href=\"http://sqlfiddle.com/#!2/962496/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/962496/1</a></p>\n\n<p>How could one select all orders from user b@b.cn with userpk = 2 and reg = 1 but only\nthe two most recent orders from a@a.cn with userpk = 1 and reg = 0. So the query will show 3 orders for userpk = 2 but only 2 orders (not the earliest order 2012-01-01 from userpk = 1</p>\n\n<p>So the condition would be reg, if reg = 0 then ignore first order</p>\n"},{"tags":["java","sql","casting","blob","bytearrayoutputstream"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13293828,"title":"java insert Blob as ByteArrayOutputStream get ClassCastException","body":"<p>I've to save a pdf file represented as a ByteArrayOutputStream into a Blob SQL field of a table, here's my code:</p>\n\n<pre><code>public boolean savePDF(int version, ByteArrayOutputStream baos) throws Exception{\n    boolean completed = false;\n    ConnectionManager conn = new ConnectionManager();\n    try {\n        PreparedStatement statement = conn.getConnection().prepareStatement(INSERT_PDF);\n        statement.setLong(1, version);\n        statement.setBlob(2, (Blob)baos);           \n        statement.execute();\n        conn.commit();\n        completed = true;\n    } catch (SQLException e) {\n        conn.rollbackQuietly();\n        e.printStackTrace();\n        throw e;\n    } catch (ClassNotFoundException e) {\n        e.printStackTrace();\n    }finally{\n        conn.close();\n    }                           \n    return completed;       \n}\n</code></pre>\n\n<p>But I get a java.lang.ClassCastException:</p>\n\n<pre><code>java.io.ByteArrayOutputStream cannot be cast to java.sql.Blob\n</code></pre>\n\n<p>How can I manage that? Thanks</p>\n"},{"tags":["sql","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13293662,"title":"VB.Net SQL insert from datagrid","body":"<p>I am currently building an application whereby a user inputs data into a grid and this is then inserted into a SQl table.\nHowever i am having issues getting it to insert more than the top row. I get an error stating too many parameters have been declared for the procedure.\nam trying to execute a loop with the insert occuring for each row. \nWhen run the top row is inserted but anything else is ignored</p>\n\n<pre><code>    For i = 0 To dgvRI.Rows.Count - 1\n            sqlRI.CommandText = \"dbo.vb_insert\"\n            sqlRI.CommandType = CommandType.StoredProcedure\n            sqlRI.Parameters.Add(\"@accid\", SqlDbType.VarChar).Value = accid\n            sqlRI.Parameters.Add(\"@rnum\", SqlDbType.Int).Value = dgvRI.Rows(i).Cells(0).Value\n            sqlRI.Parameters.Add(\"@rilim\", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(1).Value\n            sqlRI.Parameters.Add(\"@riatt\", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(2).Value\n            sqlRI.Parameters.Add(\"@rishare\", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(3).Value\n            sqlRI.Parameters.Add(\"@rname\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(4).Value\n            sqlRI.Parameters.Add(\"@bname\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(5).Value\n            sqlRI.Parameters.Add(\"@type\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(6).Value\n            sqlRI.Parameters.Add(\"@cov\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(7).Value\n            sqlRI.Parameters.Add(\"@prop\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(8).Value\n            sqlRI.Parameters.Add(\"@loc\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(9).Value\n            sqlRI.Parameters.Add(\"@con\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(10).Value\n            sqlRI.Parameters.Add(\"@prem\", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(11).Value\n            sqlRI.Parameters.Add(\"@curr\", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(12).Value\n            i += sqlRI.ExecuteNonQuery()\n        Next\n    Catch ex As Exception\n        MessageBox.Show(ex.Message)\n    End Try\n</code></pre>\n"},{"tags":["sql","oracle","collections","user-defined-types"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13292658,"title":"Get information about collection element type","body":"<p>I have two user types:</p>\n\n<pre><code>create type TEST_TYPE_WITH_CHAR as table of varchar2(100 char);\ncreate type TEST_TYPE_WITH_BYTE as table of varchar2(100 byte);\n</code></pre>\n\n<p>How to determine what type contains char, and which byte?</p>\n\n<p>View <code>SYS.USER_COLL_TYPES</code> does not provide such information. <a href=\"http://sqlfiddle.com/#!4/c92b2/2/0\" rel=\"nofollow\">sqlfiddle</a>.</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13292691,"title":"SQL Query to find unique count","body":"<p>Here's a little bit of background.  I have a database like this:</p>\n\n<pre><code>    uristem       username\n  +------------+  +-------+\n  | /uristem/1 |  | user1 |\n  | /uristem/2 |  | user2 |\n  | /uristem/3 |  | user3 |\n  | /uristem/3 |  | user4 |\n  | /uristem/1 |  | user1 |\n  | /uristem/7 |  | user5 |\n  | /uristem/5 |  | user3 |\n  | /uristem/5 |  | user1 |\n  | /uristem/3 |  | user1 |\n  +------------+  +-------+\n</code></pre>\n\n<p>I need to count the number of (<strong>unique</strong>) users that hit <code>/uristem/3</code>.  What operators can I use in a query to do this?</p>\n\n<p>Your help is greatly appreciated,</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","database","script"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13291043,"title":"Script to get detached databases from folder and subfolders","body":"<p>Is there a way to find out if SQL Server databases are attached from a directory with many subfolders apart from going to properties of each .mdf and checking if it is attached?</p>\n\n<p>Is there a script that can check folders/subfolders an write to file to accomplish this?</p>\n\n<p>THanks all.</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13279388,"title":"Subquery, Nested Select, Join, something else? - not sure","body":"<p>When I try limiting my results, I limit them too much.</p>\n\n<pre><code>Select Distinct Agreements.AgrmntID, Agreements.Status, JobSites.SiteName,\n  AgreementCharges.TotalSaleAmt, AgreementCharges.PartID,\n  AgreementSchedules.FormanEmpID, LaborCodeTypes.RepairCode\nFrom Agreements Inner Join\n  AgreementCharges On Agreements.AgrmntID = AgreementCharges.AgrmntID Inner Join\n  JobSites On JobSites.CustSiteID = Agreements.CustSiteID Left Outer Join\n  AgreementSchedules On Agreements.AgrmntID = AgreementSchedules.AgrmntID\n  Left Outer Join\n  LaborCodeTypes On LaborCodeTypes.RepairID = AgreementSchedules.RepairID\nWhere Agreements.Status = 2 And AgreementCharges.PartID = 31 And\n  LaborCodeTypes.RepairCode = '04 - LS'\n</code></pre>\n\n<p>If there is no RepairCode matching '04 - LS' I still need the AgrmntID and TotalSaleAmt.  Likewise, if there is no AgreementSchedule at all, I need AgrmntID and TotalSaleAmt.</p>\n\n<p>Output:</p>\n\n<pre><code>AgrmntID  Status  SiteName  TotalSaleAmt  PartID  FormanEmpID  RepairCode\n-------------------------------------------------------------------------\n2         2       TEST01    $100.00       31      66           04 - LS\n2         2       TEST03    $300.00       31      21           04 - LS\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>AgrmntID  Status  SiteName  TotalSaleAmt  PartID  FormanEmpID  RepairCode\n-------------------------------------------------------------------------\n2         2       TEST01    $100.00       31      66           04 - LS\n2         2       TEST02    $200.00       31\n2         2       TEST03    $300.00       31      21           04 - LS\n</code></pre>\n\n<p>I've looked and looked and am now coming here for help.  Thank you in advance!!</p>\n"},{"tags":["sql","html5","relational-database","indexeddb"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13226840,"title":"Relational IndexedDB Wrapper","body":"<p>I am planning to use IndexedDB to support offline database but having trouble in performing queries and understanding the underlying mechanics of it. Is there a indexeddb wrapper that can enable me to query against indexeddb using SQL queries? Thanks!</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","query-optimization"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13290797,"title":"Is there any potential probelm removing this ISNULL statement?","body":"<p>So recently we uncovered a long running proc and one of my colleagues pointed out that that dropping the ISNULL in the where clause sped things up for reasons pointed out in this post <a href=\"http://stackoverflow.com/questions/8924913/is-there-is-any-performance-issue-while-using-isnull-in-sql-server\">Is there is any Performance issue while using ISNULL() in SQL Server?</a>. I did some Google searching but couldn't find out for sure if there was any danger in missing data. I know if you say something like this </p>\n\n<pre><code>WHERE ID NOT IN (SELECT MemberID FROM Person WHERE MemberId IS NOT Null)\n</code></pre>\n\n<p>and MemberId is nullable you won't get any matches if you don't include the \"IS NOT NULL\" but I think that is a different issue? Maybe not? </p>\n\n<p>Here is the change my coworker is proposing. </p>\n\n<pre><code>where ISNULL(ct.DisabilityBenefitsConnectAuthorized,0) = 1\n</code></pre>\n\n<p>Would become</p>\n\n<pre><code>where ct.DisabilityBenefitsConnectAuthorized = 1\n</code></pre>\n\n<p>It doesn't seem to be effecting results however I am not 100% sure that it couldn't and we just don't know it. </p>\n"},{"tags":["sql","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13291046,"title":"Update Table to order child records by date","body":"<p>I have two tables:</p>\n\n<p>PARENT (EMAIL,NAME,ETC)<br>\nCHILD (EMAIL,DOC_DOC_ID,DOWNLOAD_DATE,RANK)</p>\n\n<p>I need to generate a query that will update the CHILD.RANK Field, with a numerical sorting that will rank each distinct DOC_ID by the date that it was downloaded (1 = latest doc download) </p>\n\n<pre><code>SELECT\n    P.EMAIL,\n    C.DOC_ID,\n    MAX(C.DOWNLOAD_DATE)\nFROM\n    PARENT P,\n    CHILD C\nWHERE\n    P.EMAIL = C.EMAIL\n</code></pre>\n\n<p>Please dont laugh at what i have come up with so far!... i think my brain is fried!</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":5564,"score":0,"question_id":7430560,"title":"How to check if cursor exists (open status)","body":"<p>How do I check if a cursor is open or not? Because many times I am encountering the error 'Cursor already exists'. Please let me know how can I check whether a cursor is already in open status.</p>\n\n<p>In fact I have closed as well as Deallocated it at the end (CLOSE ppm_cursor; DEALLOCATE ppm_cursor;) But Still i am getting the same error what could be the reason.</p>\n"}]}
{"total":102597,"page":2,"pagesize":100,"questions":[{"tags":["sql","sql-server","sql-server-2008","formatting","sql-update"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13291207,"title":"how to format date in sql server","body":"<p>I am trying to update a date field in my table but would to convert the date format into dd/mm/yy.\n    i have tried this method but it is still showing like this yyyy-mm-dd</p>\n\n<pre><code> UPDATE MyTable \n        SET MyField = convert (varchar,GETDATE(), 101)\n       where ID = '221'\n</code></pre>\n"},{"tags":["mysql","sql","sqlite3"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13290014,"title":"show by example: row vs field?","body":"<p>Various documents define row as being synonymous with record. Unfortunately, a record can be a list or a single item. All the same, a row usually contains more than one item but is sometimes called \"a single entry\".</p>\n\n<p>A field can be a container (for example, in html), which could be considered a place to input one item, or it could be considered a place where many items are entered (albeit on different occasions, sometimes).</p>\n\n<p>It sure would be nice if someone could put it in simple terms. For example, a row is the result of a single-item, single-field entry via an insert statement. A field represents all rows and intersects a column. </p>\n\n<p>Can anybody provide a clear answer because google just isn't cutting it. Thank you. </p>\n\n<p>Edit:</p>\n\n<p>In excel it sure is cut-and-dry. Column is all horizontal. Row is all vertical. Cell is a row-column pair; a single entry. Even though relational database languages are like working with multiple spreadsheets (tables), the column, row, cell approach seems to make the most sense. </p>\n\n<p>I am looking at various different explanations that don't seem to agree with one another in the answers. Can we operationally define the terms for the tutorial I am presently working on, which is not clear? Link: <a href=\"http://zetcode.com/databases/sqlitetutorial/introduction/#about\" rel=\"nofollow\">http://zetcode.com/databases/sqlitetutorial/introduction/#about</a></p>\n"},{"tags":["java","sql","hibernate","orm","criteria"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":9051595,"title":"Logical OR between a Criterion and Criteria","body":"<p>I have the following model classes:</p>\n\n<pre><code>@Entity\n@Table(name = \"title\")\npublic final class Title extends ModelData&lt;Title&gt;\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Integer titleID;\n\n    @Column(name = \"title\")\n    private String title;\n\n    @Column(name = \"description\")\n    private String description;\n\n    @OneToMany(cascade = CascadeType.ALL, mappedBy = \"title\")\n    private Set&lt;Book&gt; books;\n}\n\n@Entity\n@Table(name = \"book\")\npublic final class Book extends ModelData&lt;Book&gt;\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = \"bookID\")\n    private int bookID;\n\n    @ManyToOne(cascade = CascadeType.PERSIST, fetch = FetchType.EAGER)\n    @JoinColumn(name = \"titleID\")\n    private Title title;\n\n    @Column(name = \"edition\")\n    private Integer edition;\n\n    @Column(name = \"isbn\")\n    private String ISBN;\n}\n</code></pre>\n\n<p>I want to write a Criteria query that is equivalent to the following SQL;   </p>\n\n<pre><code>Select \n        t.title, b.edition \n    from \n        books b, title t\n    where \n        b.titleID = t.titleID\n    and \n        (b.edition=4 OR t.title LIKE '%Java%);\n</code></pre>\n\n<p>I tried the following:</p>\n\n<pre><code>Criteria c = session.createCriteria(Book.class);\n\nCriteria titleCriteria = c.createCriteria(\"title\");\ntitleCriteria.add(Restrictions.like(\"title\", \"%Java%\");\n\nCriterion edition = Restrictions.eq(\"edition\", 4);\n\nLogicalExpression orExp = Restrictions.or(edition, titleCriteria); //cannot do this\n</code></pre>\n\n<p>How do I achieve the above?</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13292715,"title":"SQL query between statement","body":"<p>I have a problem using mySQL with my PHP admin and have a problem querying my DB\nThis is the query statement:</p>\n\n<pre><code>SELECT Record_ID, Datalog_ID, TIME, AVG( Value ) \nFROM  `Datalog_Values` \nWHERE Datalog_ID =  '241'\nAND TIME\nBETWEEN  '2012-06-01'\nAND  '2012-06-30'\nGROUP BY HOUR( TIME ) \n</code></pre>\n\n<p>The result i am getting is only the results from the first day and not the period.i.e. the month.</p>\n\n<p>what is wrong with my statement????</p>\n"},{"tags":["sql","sql-server","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13292631,"title":"Database query to handle when specific rows don't exist","body":"<p>Sorry for the bad title, it is hard to explain in one sentence what I am having problems with. So I have a stats database for basketball. What I am trying to do is group the stats for one team in one row then group all the stats this team played against in one other row. What I have now works if there are opponent stats in the database, but it is possible to not have opponent stats and just have the team stats. Hard to explain why, so please just go with that.</p>\n\n<p>So lets say I have 3 rows like this:</p>\n\n<pre><code>COMP_ID | TEAM_ID | OFF_REB | DEF_REB\n  1     |  100   |   5     |    4\n  2     |  100   |   1     |    1\n  3     |  100   |   3     |    7\n</code></pre>\n\n<p>Basically, there are 3 games, and I only have team 100's stats. I would like to get all of the OFF and DEF rebounds for team 100 in a row and then all of the opponent OFF and DEF rebounds in another row. If there are no opponent stats, just 0's will be fine.</p>\n\n<p>FYI - What I do now is do a group by to package the team 100's stats together and also to package the opponent stats together. For the TEAM_ID of the opponent stats, I group them into -999 value so I know they are opponent values.</p>\n\n<p>Here is the query I have now:</p>\n\n<pre><code>SELECT CASE WHEN TEAM_ID &lt;&gt; 100 THEN -999 ELSE 100 END AS TEAM_ID, SUM(OFF_REB+DEF_REB) REBS\nFROM V_STATS_COMP\nWHERE COMP_ID IN (SELECT COMP_ID FROM COMPETITIONS WHERE HOME_ID = 100 OR VIS_ID = 100)\nGROUP BY CASE WHEN TEAM_ID &lt;&gt; 100 THEN -999 ELSE 100 END\nORDER BY TEAM_ID\n</code></pre>\n\n<p>With this query, I get only 1 row back and thats for team 100. How do I adjust it to get the -999 row even if there are no stats available?</p>\n\n<p>Edit to show desired results: </p>\n\n<pre><code>TEAM_ID | REBS\n  100   |  21\n -999   |  0\n</code></pre>\n\n<p>Of course if there were opponent stats, id like to see their REBS value.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":80,"score":0,"question_id":13079127,"title":"Whats wrong with the following mysql code","body":"<pre><code>Insert into hotel('fname', 'lname'...\nvalues\n  ('null', 'abc'....\nON DUPLICATE KEY UPDATE \n  fname = 'null',\n  lname = 'abc',.....\n</code></pre>\n\n<p>Solve the above mysql query.</p>\n"},{"tags":["sql","forms","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":113,"score":0,"question_id":8913446,"title":"Table row as column in Access form","body":"<p>I am trying to create a form in Access based on a table and I would like to use the table's rowdata as the column title in the form.</p>\n\n<p>What I mean is, I have a table as follows which shows the effort booked by employees towards specific projects on a monthly basis:</p>\n\n<pre><code>ProjectNo  EmployeeName  HoursBooked  Month/Year\n23            Mark          68         01/01/2012\n23            Mark          55         01/02/2012\n54            John          22         01/02/2012\n23            John          52         01/02/2012 \n</code></pre>\n\n<p>...etc</p>\n\n<p>and from this I would like to create a singular form where the data is displayed as follows for each project. For example, for project 23:</p>\n\n<pre><code>Month/Year   Mark     John\n01/01/2012   68        0\n01/02/2012   55        52\n</code></pre>\n\n<p>and someone should be able to go to this form, edit the numbers and the table should reflect these changes.</p>\n\n<p>Could someone guide me on how to achieve this? I have been trying to achieve this in Access but unfortunately my Forms knowledge is not that great.</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13292327,"title":"Select rows which match common criterias","body":"<p>I can't seem to twist my brain to this, I believe simple, question.</p>\n\n<p>I have the below table (Id and Value together forms the key), the table will be large with millions of entries.</p>\n\n<p><strong>table</strong></p>\n\n<pre><code>ID      Value\nID_A    VAL_1\nID_A    VAL_2\nID_A    VAL_3\nID_B    VAL_1\nID_B    VAL_2\nID_C    VAL_3\n</code></pre>\n\n<p>I want to get all ids who match an arbitrary selection, it could be:</p>\n\n<p>GIVE ME ALL IDS WHO HAVE <code>(Value = 'val_1') AND (value = 'val_3')</code></p>\n\n<p>This should return <code>(ID_A)</code> as its the only id who have both val1 and val3. How do I accomplish this in a performance vice clever manner.</p>\n"},{"tags":["sql","oracle11g","alter-table","table-rename"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13292652,"title":"Changing Oracle table name","body":"<p>I'm trying to change a table name in oracle.\nI first run this script to declare the table</p>\n\n<pre><code>CREATE TABLE CUSTOMER\n(\n  C_ID NUMBER(6,0),\n  C_LAST VARCHAR2(25),\n  C_FIRST varchar2(25),\n  C_MI char(1),\n  C_DOB DATE,\n  C_ADDRESS varchar2(100),\n  C_CITY varchar2(35),\n  C_STATE char(2),\n  C_ZIP varchar2(10),\n  C_DPHONE varchar2(12),\n  C_EPHONE varchar2(12),\n  C_USERID varchar2(20),\n  C_PASSWORD VARCHAR2(30),\n  CONSTRAINT CUSTOMER_PK PRIMARY KEY(C_ID)\n);\n\nCREATE TABLE ORDER_SOURCE\n(\n  OS_ID NUMBER(6),\n  OS_DESC varchar2(255),\n  CONSTRAINT ORDER_SOURCE_PK PRIMARY KEY(OS_ID)\n);\n\nCREATE TABLE ORDERS\n(\n  O_ID NUMBER(6),\n  O_DATE DATE,\n  O_METHPMT varchar2(25),\n  C_ID NUMBER(6),\n  OS_ID NUMBER(6),\n  CONSTRAINT ORDERS_PK PRIMARY KEY(O_ID),\n  CONSTRAINT ORDERS_CUSTOMER_FK FOREIGN KEY(C_ID) REFERENCES CUSTOMER(C_ID),\n  CONSTRAINT ORDERS_ORDER_SOURCE_FK FOREIGN KEY(OS_ID) REFERENCES ORDER_SOURCE(OS_ID)\n);\n</code></pre>\n\n<p>It runs correctly, I then try to run </p>\n\n<pre><code>alter table ORDERS\nrename to ORDER;\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Error starting at line 1 in command: alter table ORDERS rename to\n  ORDER Error report: SQL Error: ORA-00903: invalid table name\n  00903. 00000 -  \"invalid table name\"\n  *Cause:<br>\n  *Action:</p>\n</blockquote>\n"},{"tags":["sql","sql-server-2008","sql-server-express"],"answer_count":3,"favorite_count":3,"up_vote_count":0,"down_vote_count":0,"view_count":2695,"score":0,"question_id":7313103,"title":"create table permission denied in database 'master'","body":"<p>I have installed the free version of sql server 2008 (sql server management studio express edition) on my PC. After installation I get the following error</p>\n\n<pre><code>create table permission denied in database 'master'\n</code></pre>\n\n<p>I tried reinstalling several times, but I keep getting the same error. When i checked </p>\n\n<pre><code>select user_account();\n</code></pre>\n\n<p>It showed that I was logged in as guest. How do I solve this? since I am not permitted to create a new login. </p>\n"},{"tags":["python","sql","if-statement","python-2.7","firebird"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":80,"score":-4,"question_id":13289545,"title":"Incorrect work of the if","body":"<p>I wrote the following functions on transfer of data from Access to Firebird</p>\n\n<pre><code>def getFirebirdFieldNames(firebird_cursor, tablename):\n    firebird_cursor.execute('select rdb$field_name from rdb$relation_fields where rdb$relation_name=\\'%s\\' order by rdb$field_position' % (tablename,))\n    field_names = list()\n    for c in firebird_cursor.fetchall():\n        field_names.append(c[0])\n    return field_names\n\ndef FirebirdDatetime(dt):\n    return '\\'%s.%s.%s\\'' % (str(dt.day).rjust(2,'0'),\n                                   str(dt.month).rjust(2,'0'),\n                                   str(dt.year).rjust(4,'0'))\n\ndef SelectFromAccessTable(tablename):\n    return 'select * from [' + tablename+']'\n\ndef InsertToFirebirdTable(tablename, row):\n    values=''\n    #values=values.encode('cp1251', 'replace')\n    #   copyrow=[]\n    #   print type(values)\n    for i in range(len(row)):\n    #print row[i]\n    #print type(row[i])\n    #temp=''\n    if (i&lt;len(row)-1):\n        if type(row[i]) == int:\n            temp = str(row[i])\n        elif type(row[i]) == str:\n            temp = '\\'%s\\'' % (row[i],)\n        elif type(row[i]) == datetime.datetime:\n            temp =FirebirdDatetime(row[i])\n        elif type(row[i]) == decimal.Decimal:\n             temp = str(row[i])\n        elif row[i]==None:\n             temp='null'\n        values+=temp+', '                 \n    else:\n        if type(row[i]) == int:\n            temp = str(row[i])\n        elif type(row[i]) == str:\n            temp = '\\'%s\\'' % (row[i],)\n        elif type(row[i]) == datetime.datetime:\n            temp =FirebirdDatetime(row[i])\n        elif type(row[i]) == decimal.Decimal:\n            temp = str(row[i])\n        elif row[i]==None:\n            temp='null'\n        values+=temp\n    print temp\n    return 'insert into '+tablename+' values ('+values+')'\n\ndef AccessToFirebird(accesstablename, firebirdtablename, accesscursor, firebirdcursor):\n    SelectSql=SelectFromAccessTable(accesstablename)\n    for row in accesscursor.execute(SelectSql):\n        InsertSql=InsertToFirebirdTable(firebirdtablename, row)\n        InsertSql=InsertSql\n        print InsertSql\n        firebirdcursor.execute(InsertSql)\n</code></pre>\n\n<p><code>AccessToFirebird</code> function call in the main module calls the <code>InsertToFirebirdTable</code>, in which the screen output generated insert queries. As the following output temp assigned row [0] and will not change, contrary to the logic of the program (in the cycle is bypassing the whole row in the result should be a query inserts all transmitted values). Why is this happening and how do I make the result to the goal? Here is the output generated queries (Northwind database in Access)</p>\n\n<pre><code>1\n1\n1\n1\n1\n1\n1\n1\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (1, 1, 1, 1, 1, 1, 1, 1, null, null, null, null, null, null, null, null, null, null)\n2\n2\n2\n2\n2\n2\n2\n2\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (2, 2, 2, 2, 2, 2, 2, 2, null, null, null, null, null, null, null, null, null, null)\n3\n3\n3\n3\n3\n3\n3\n3\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (3, 3, 3, 3, 3, 3, 3, 3, null, null, null, null, null, null, null, null, null, null)\n4\n4\n4\n4\n4\n4\n4\n4\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (4, 4, 4, 4, 4, 4, 4, 4, null, null, null, null, null, null, null, null, null, null)\n5\n5\n5\n5\n5\n5\n5\n5\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (5, 5, 5, 5, 5, 5, 5, 5, null, null, null, null, null, null, null, null, null, null)\n6\n6\n6\n6\n6\n6\n6\n6\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (6, 6, 6, 6, 6, 6, 6, 6, null, null, null, null, null, null, null, null, null, null)\n7\n7\n7\n7\n7\n7\n7\n7\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (7, 7, 7, 7, 7, 7, 7, 7, null, null, null, null, null, null, null, null, null, null)\n8\n8\n8\n8\n8\n8\n8\n8\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (8, 8, 8, 8, 8, 8, 8, 8, null, null, null, null, null, null, null, null, null, null)\n9\n9\n9\n9\n9\n9\n9\n9\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into EMPLOYEES values (9, 9, 9, 9, 9, 9, 9, 9, null, null, null, null, null, null, null, null, null, null)\n2\n2\ninsert into ROLES values (2, 2)\n2\n2\ninsert into EMPLOYEES_ROLES values (2, 2)\n1\n1\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into DELIVERY values (1, 1, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)\n2\n2\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into DELIVERY values (2, 2, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)\n3\n3\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\nnull\ninsert into DELIVERY values (3, 3, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)\n</code></pre>\n"},{"tags":["mysql","sql","date"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":1004,"score":0,"question_id":7830987,"title":"How do I extract Month and Year in a MySQL date and compare them?","body":"<p>How do I extract the month and date from a mySQL date and compare it to another date?</p>\n\n<p>I found this MONTH() but it only gets the month. I looking for month and year.</p>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13291211,"title":"Generating serial numbers in Rails ActiveRecord","body":"<p>In a Rails app I need a source of unique, sequential (no gaps) integers to use as serial numbers. It must be persistent and allow concurrent access. </p>\n\n<p>Database auto-increment isn't adequate because most don't guarentee the \"no gaps\" property.</p>\n\n<p>In straight SQL I would just create a one-line table and say (in PostgreSQL) something like:</p>\n\n<pre><code>update sequence set value = value + 1 returning value\n</code></pre>\n\n<p>This is apparently standard practice in the SQL world. References exist.</p>\n\n<p>In ActiveRecord I easily created a model the model and found <code>.increment!</code> and <code>.increment_counter</code> in the documentation. But I can't figure out how to <em>atomically</em> retrieve the incremented value.  Locks and transactions don't seem to help.</p>\n"},{"tags":["sql","sql-server-2008","telerik","telerik-grid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13292090,"title":"sql date difference issue","body":"<p>I am working on a telerik gridview and I supposed to display a warning on certain conditions and 1 of them is that:</p>\n\n<p>if the due date is bigger than today's date and also the warning days are 3, then it will show all the records who's due date is bigger than today but only if they come with in warning period then it supposed to show.</p>\n\n<p>so if today's date is  22-12-2012 and due date is 25-12-2012 and warn days are 3 then it should select that record</p>\n\n<p>what I tried so far:</p>\n\n<pre><code> DateTime dtTodayDate = DateTime.Today;\n   string strTodayDate = dtTodayDate.ToString(\"yyyy/MM/dd 00:00:00\");\n    strFilter += @\"OR ( [DueDate] &gt;= #\" + strTodayDate + @\"# AND [Warn_Days] &gt; 0 AND [DueDate] - [Warn_Days] =#\" + strTodayDate + @\"# )\";\n</code></pre>\n\n<p>Cannot perform '-' operation on System.DateTime and System.Int32. </p>\n"},{"tags":["sql","sql-server","sql-server-2005","etl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13292222,"title":"ETL SQL Server 2008 - How to handle non-matching records?","body":"<p>I am fairly new to ETL. I am working on this proc and what it does is it loads birthdates of people. This is loaded from a fact table onto a different table. There is no key to join them by, all the three tables involved. I am going to split the Name field and do match with the split name. This loads the matching ones, but my question is I have to load the non matching ones to a different third table. How do I do that logic? </p>\n\n<pre><code>update FactTableEmp F\n       set Bdate = S.Birthdate\n\nfrom   FactTableEmp\n       cross apply dbo.split(Name) as u\n       join SourceTableEmp S on u.Fname = s.FirstName and u.LName = S.Lastname  \n\n--Is using the one below going to work using the same way above?\nu.Fnames != S.FirstName\nu.Lname != S.Lastname\n</code></pre>\n"},{"tags":["c#","sql","sql-server","smo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12704919,"title":"Create a copy of partitioned tables using SMO","body":"<p>I'm trying to use SMO to replicate a copy of a partitioned table:</p>\n\n<pre><code>using (var scope = new TransactionScope()) \n{ \n    var copiedtable = CreateTable(sourcetable);\n\n    createColumns(sourcetable, copiedtable);\n    CreateIndexes(sourcetable, copiedtable);\n    CreateForeignKeys(sourcetable, copiedtable);\n\n    sourcetable.PartitionScheme = sourcetable.PartitionScheme + \"1\";\n\n    scope.Complete();\n    return copiedtable; \n } \n</code></pre>\n\n<p>The copy is created but the partition scheme is ignored, is there a way to align to the partition scheme?  Am I going about things the wrong way?  I receive no error message or exception the code silently creates an unpartitioned copy of the partitioned table.</p>\n\n<p>I want to automate as I have several hundred tables where the partitions are aligned to the wrong schema.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1159,"score":1,"question_id":7700216,"title":"get the date and time for today at midnight and add to it","body":"<p>Is there a sql command to get today's date at midnight and be able to add a number of minutes to it?</p>\n"},{"tags":["php","sql","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13291181,"title":"Call to a member function setFetchMode() on a non-object PDO","body":"<p>Here is a sample of $message's content :</p>\n\n<blockquote>\n  <p>String(108) \"\\n      cc je t'ai envoy� une invitation  A plus :p\\n    \"</p>\n</blockquote>\n\n<p>Here is the error message : </p>\n\n<blockquote>\n  <p>Fatal error: Call to a member function setFetchMode() on a non-object\n  in  B:\\wamp\\www\\messages.php on line 101</p>\n</blockquote>\n\n<p>My request that doesn't work :</p>\n\n<pre><code>    $resultats = $connexion-&gt;query(\"SELECT * FROM messages WHERE message LIKE '%$message%'\");\n    $resultats-&gt;setFetchMode(PDO::FETCH_OBJ);\n    $occurences= $resultats-&gt;rowCount();\n</code></pre>\n\n<p>Why does this one work? (I changed $message by a) :</p>\n\n<pre><code> $resultats = $connexion-&gt;query(\"SELECT * FROM messages WHERE message LIKE '%a%'\");\n        $resultats-&gt;setFetchMode(PDO::FETCH_OBJ);\n        $occurences= $resultats-&gt;rowCount();\n</code></pre>\n"},{"tags":["sql","parent","parent-child"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13280016,"title":"SQL - How to Query Parent Child Records by Descending TimeStamp","body":"<p>Here is my table</p>\n\n<pre><code>+------------+-----------+---------------+--------------+\n| CommentId  | ParentId  |  Timestamp    | CommentText  |\n+------------+---------+-----------+--------------------+\n|          1 |      NULL |  Jan 1 2:00pm |          a   |\n|          2 |      NULL |  Jan 1 2:01pm |          b   |\n|          3 |         1 |  Jan 1 3:03pm |          c   |\n|          4 |         2 |  Jan 1 5:00pm |          d   |\n|          5 |         2 |  Jan 1 5:01pm |          e   |\n|          6 |      NULL |  Jan 1 8:00pm |          f   |\n|          7 |         1 |  Jan 1 7:00pm |          g   |\n|          8 |         6 |  Jan 1 9:04pm |          h   |\n|          9 |         1 |  Jan 1 8:05pm |          i   |\n|         10 |      NULL |  Jan 1 9:04pm |          k   |\n+------------+-----------+---------------+--------------+\n</code></pre>\n\n<p>Currently I am using the following SQL to return the comments ordered by parent</p>\n\n<pre><code>SELECT c.*\nFROM Comments c\nORDER BY COALESCE(c.ParentId, c.Id)\n</code></pre>\n\n<p>The result is this:</p>\n\n<pre><code>+------------+-----------+---------------+--------------+\n| CommentId  | ParentId  |  Timestamp    | CommentText  |\n+------------+---------+-----------+--------------------+\n|          1 |      NULL |  Jan 1 2:00pm |          a   |\n|          3 |         1 |  Jan 1 3:03pm |          c   |\n|          7 |         1 |  Jan 1 7:00pm |          g   |\n|          9 |         1 |  Jan 1 8:05pm |          i   |    \n|          2 |      NULL |  Jan 1 2:01pm |          b   |    \n|          4 |         2 |  Jan 1 5:00pm |          d   |\n|          5 |         2 |  Jan 1 5:01pm |          e   |\n|          6 |      NULL |  Jan 1 8:00pm |          f   |    \n|          8 |         6 |  Jan 1 9:04pm |          h   |    \n|         10 |      NULL |  Jan 1 9:04pm |          k   |\n+------------+-----------+---------------+--------------+\n</code></pre>\n\n<p>I need to get the results in a Descending timestamp order. The result set should look like:</p>\n\n<pre><code> +------------+-----------+---------------+--------------+\n| CommentId  | ParentId  |  Timestamp    | CommentText  |\n+------------+---------+-----------+--------------------+         \n|         10 |      NULL |  Jan 1 9:04pm |          k   |\n|          6 |      NULL |  Jan 1 8:00pm |          f   |    \n|          8 |         6 |  Jan 1 9:04pm |          h   |    \n|          2 |      NULL |  Jan 1 2:01pm |          b   |    \n|          4 |         2 |  Jan 1 5:00pm |          d   |\n|          5 |         2 |  Jan 1 5:01pm |          e   |\n|          1 |      NULL |  Jan 1 2:00pm |          a   |\n|          3 |         1 |  Jan 1 3:03pm |          c   |\n|          7 |         1 |  Jan 1 7:00pm |          g   |\n|          9 |         1 |  Jan 1 8:05pm |          i   |    \n+------------+-----------+---------------+--------------+\n</code></pre>\n\n<p>The following does not work:</p>\n\n<pre><code>SELECT c.*\nFROM Comments c\nORDER BY COALESCE(c.ParentId, c.Id), Timestamp DESC\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13291770,"title":"mysql max() without being able to group","body":"<p>I'm trying to return all values of foo joined with the max values of bar where foo.val > bar.val</p>\n\n<pre><code>CREATE TABLE `foo` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `val` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n);\n\nCREATE TABLE `bar` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `val` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n);\n\ninsert into foo (val) values (3), (5), (7), (10);\ninsert into bar (val) values (1), (1), (2), (3), (4), (5), (6), (7), (8), (20);\n</code></pre>\n\n<p>The expected output would be like:</p>\n\n<pre><code>+--------+---------+------------------------+\n| foo.id | foo.val | max(bar.val) &lt; foo.val |\n+--------+---------+------------------------+\n|  1     | 3       | 2                      |\n|  2     | 5       | 4                      |\n|  3     | 7       | 6                      |\n|  4     | 10      | 8                      |\n+--------+---------+------------------------+\n</code></pre>\n\n<p>Can this be done with a single query rather than looping through in code-land?</p>\n\n<pre><code>SELECT max(val) from bar where val &lt; 3;\nSELECT max(val) from bar where val &lt; 5;\nSELECT max(val) from bar where val &lt; 7;\nSELECT max(val) from bar where val &lt; 10;\n</code></pre>\n\n<p>Anyone have any ideas on this?</p>\n\n<p>Fiddle is here if anyone wants to try it <a href=\"http://sqlfiddle.com/#!2/de0f9/7\" rel=\"nofollow\">http://sqlfiddle.com/#!2/de0f9/7</a></p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","regex","oracle","oracle11g","check-constraints"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1030,"score":0,"question_id":7621568,"title":"Oracle 11g - Check constraint with RegEx","body":"<p>I'm using Oracle 11g, and trying to create a table define constraints on the creation.</p>\n\n<p>I was trying to add check constraint to validate some information (like e-mail address, phone number, etc...)</p>\n\n<p>Is there something in Oracle 11g that would allow me to do something like this?</p>\n\n<pre><code>constraint CK_CONSTRAINT_NAME check (EMAIL like 'REGEX')\n</code></pre>\n\n<p>The regEx I wanted to use (grabbed from regexLib) is:</p>\n\n<pre><code>^[a-zA-Z][a-zA-Z0-9_\\.\\-]+@([a-zA-Z0-9-]{2,}\\.)+([a-zA-Z]{2,4}|[a-zA-Z]{2}\\.[a-zA-Z]{2})$\n</code></pre>\n\n<p>I think Oracle 11g (correct me if I'm wrong) doesn't support this format for RegEx...</p>\n\n<p>I've seen methods using REGEX_LIKE, but it seems to only work in <code>WHERE</code> clauses.</p>\n\n<p>I'd like to keep it as a check constraint and not a trigger or an external function/script.</p>\n\n<p>Also, I've read in other threads here, someone saying RegEx' are not a good way of verifying e-mail address format and such information. No reason was given in the comment, and I'd like to know why, if a reason there is!</p>\n\n<p>Thanks for your inputs and your help.</p>\n\n<p>much appreciated.</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13288742,"title":"Linking IDs of the same row to other tables","body":"<p>I have a mapping table that can hold IDs from the same table.</p>\n\n<p>For example I have :</p>\n\n<p>Variables ( Table )\nValues ( Table)\nVariables_Values ( Mapping table )</p>\n\n<p>The mapping table has the following fields :</p>\n\n<pre><code>VariableID\nTo_VariableID\nTo_ValueID\n</code></pre>\n\n<p>So it is possible for a row to have two variable IDs, or a variable ID and a value ID.\nIt is always a pair, so there cannot be two variable IDs and a value ID at the same time.</p>\n\n<p>Now, in the Variables and Values tables, there is a Name field, so variables and values also have names.</p>\n\n<p>I want to create a query that will display the names based on the IDs in the mapping table, but I am not sure how.</p>\n\n<p>Right now I have a query that returns results that look like this :</p>\n\n<p>VariableName To_VariableID To_ValueID</p>\n\n<p>I would like to display VariableName_2, ValueName instead of To_VariableID To_ValueID.</p>\n\n<p>Is there a technique for this?\nCould it be a combination of the following queries? </p>\n\n<pre><code>SELECT map.ID, map.TransitionID, variable.Name\nFROM Variables AS variable INNER JOIN Mapping AS map \nON variable.VariableID = map.VariableID\n\nSELECT variable.VariableID, variable.Name\nFROM Variable AS variable\nWHERE variable.VariableID IN ( SELECT map.To_VariableID FROM Mapping AS map)\n\nSELECT value.Name\nFROM Values AS value\nWHERE value.ValueID IN ( SELECT map.To_ValueID FROM Mapping AS map)\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":55,"score":-2,"question_id":13291609,"title":"Need correct SQL query","body":"<p>Table:</p>\n\n<pre><code>+----+----------+-----------+---------+\n| id | topic_id | from_user | to_user |\n+----+----------+-----------+---------+\n|  6 |        5 | 4         | 5       |\n|  2 |        6 | 5         | 2       |\n|  3 |        5 | 2         | 5       |\n|  4 |        4 | 5         | 4       |\n|  5 |        4 | 5         | 4       |\n|  7 |        6 | 5         | 2       |\n|  8 |        5 | 2         | 5       |\n|  9 |        5 | 4         | 5       |\n| 10 |        0 | 2         | 5       |\n| 11 |        6 | 5         | 2       |\n| 12 |        3 | 5         | 2       |\n| 13 |        0 | 5         | 2       |\n+----+----------+-----------+---------+\n</code></pre>\n\n<p>This is messages table ( something like private messages), from_user and to_user is self descriptive, topic_id is not important for this purpose </p>\n\n<p>Now, I need to select list of messages which I will display in inbox of a user who is logged in currently. I will refer to this user with session variable <code>$this_user = $_SESSION['id']</code></p>\n\n<p>I have this query:</p>\n\n<pre><code>SELECT * FROM messages WHERE from_user = '$this_user' OR to_user = '$this_user' \n</code></pre>\n\n<p>but this will take repeating messages like 4 - 5, 5 - 4, 5 - 4,</p>\n\n<p>I tried with DISTINCT but isn't going to work either </p>\n\n<p>Any help appriciated </p>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1844,"score":0,"question_id":4068588,"title":"Validate telephone number in SQL Server 2000","body":"<p>Does anyone have a nifty way of validating telephone numbers using sql (SQL Server 2000).</p>\n\n<p>I need to select all users fro ma Db that have valid phone number</p>\n\n<p>Thanks\nSp</p>\n\n<pre><code>Valid number \n08450000000\n01332000000\n07444000000\n+441332000000\n</code></pre>\n\n<p>Standard UK numbers</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":13291098,"title":"How to string-compare for a single space","body":"<p>I want to check whether a column has any values that are a single space character.</p>\n\n<p>I initially thought that</p>\n\n<pre><code>WHERE my_column = ' '\n</code></pre>\n\n<p>would be sensible.  But no.  That will also match columns which have multiple spaces for some reason:</p>\n\n<pre><code>SELECT '    ' = ' '           =&gt; true\n</code></pre>\n\n<p>So I can use a regular express or hex encoding to test:</p>\n\n<pre><code>WHERE HEX(my_column) = '20'\nWHERE my_column REGEXP '^\\ $'\n</code></pre>\n\n<p>Both work.  But I suspect both (certainly the latter) will be quite inefficient.</p>\n\n<p>Is there a better way?</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13291693,"title":"Using EXIST in SQL","body":"<pre><code>SELECT allele.allele as allele,site.allele_id as allele_id, site.genome_site_id as genome_site_id, popl.popl_id as popl_id,popl.frequency as frequency \nFROM kref.allele as allele \n    join kref.genome_site_allele as site using (allele_id) \n    LEFT JOIN kref.genome_site_allele_popl as popl USING (ref_genome_id, allelism_start, allelism_end, chrom_id, allele_id) \nWHERE ref_genome_id= 2 AND allelism_start=25710014 AND allelism_end=25710015 \n    AND chrom_id ='22' \n    AND site.allele_id IN (\n        SELECT allele_id \n        from kref.allele \n        where allele IN ('-','C' )\n        )\n</code></pre>\n\n<p>How Can I modefy the above query using exists</p>\n\n<p>Kindly Update</p>\n"},{"tags":["sql","sql-server","regex","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13291639,"title":"TSQL Simple Regex Matching","body":"<p>I need to check if a variable is a value 10.00 through 10.09. How can I do this by regex ?</p>\n\n<pre><code>IF SomeRegExFunction(@var, '10.0*')\n    print 'It worked'\n</code></pre>\n\n<p>Is there some way to do this? </p>\n\n<p>Thanks</p>\n"},{"tags":["sql","reporting-services","rdl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13289590,"title":"SSRS Parameter Passing Issue","body":"<p>We're using SSRS within an application where users login and are authenticated based on their Store.  When they generate reports, we pass their store name to SSRS to generate report for their store. Everything works fine on the first report generation.  But when the user picks a different date range, they get report for all of the stores in the system.  We use MDX to feed the default and available parameter for store name in the .rdl as follows:</p>\n\n<pre><code>SELECT NON EMPTY { [Measures].[MTDActiveMembers], [Measures].[YTDActiveMembers],\n [Measures].[MTDMembers], [Measures].[YTDMembers], [Measures].[Members], \n[Measures].[Members-Active] } \nON COLUMNS, NON EMPTY { ([Store].[Store].[Store].ALLMEMBERS ) } DIMENSION \nPROPERTIES MEMBER_CAPTION, MEMBER_UNIQUE_NAME ON ROWS FROM ( SELECT ( \nSTRTOSET(@StoreStore, CONSTRAINED) ) ON COLUMNS \nFROM ( SELECT ( STRTOMEMBER(@FromCalendarDateHierarchy, CONSTRAINED) : \nSTRTOMEMBER(@ToCalendarDateHierarchy, CONSTRAINED) ) ON COLUMNS FROM [Members])) \nCELL PROPERTIES VALUE, BACK_COLOR, FORE_COLOR, FORMATTED_VALUE, FORMAT_STRING, \nFONT_NAME, FONT_SIZE, FONT_FLAGS\n</code></pre>\n\n<p>Stepping through the app revealed that when the user picks a different date range, all the parameters are intact, correct store name is preserved, but when the user hits \"View Report\" parameter for store name changes to ALL.  :w00t:  What could be wrong?  As far as app is concerned \"View Report\" is a black box, so don't know what to change with the rdl :(  Thanks in advance for your input.</p>\n\n<p>--Edited\nSorry, the query I provided above is the actual report query.  Parameter query is this: WITH MEMBER [Measures].[ParameterCaption] AS [Store].[Store].CURRENTMEMBER.MEMBER_CAPTION MEMBER [Measures].[ParameterValue] AS [Store].[Store].CURRENTMEMBER.UNIQUENAME MEMBER [Measures].[ParameterLevel] AS [Store].[Store].CURRENTMEMBER.LEVEL.ORDINAL SELECT {[Measures].[ParameterCaption], [Measures].[ParameterValue], [Measures].[ParameterLevel]} ON COLUMNS , [Store].[Store].ALLMEMBERS ON ROWS FROM ( SELECT ( STRTOMEMBER(@FromCalendarDateHierarchy, CONSTRAINED) : STRTOMEMBER(@ToCalendarDateHierarchy, CONSTRAINED) ) ON COLUMNS FROM [Members])</p>\n"},{"tags":["sql","tsql","sql-server-2012"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":46,"score":-1,"question_id":13291007,"title":"SQL Server 2012 Joining columns from two tables into one","body":"<p>I have two tables in different places</p>\n\n<p>the end result has to be</p>\n\n<pre><code>VendorName  InvoiceNumber  InvoiceTotal\n</code></pre>\n\n<p><code>VendorName</code> is in a table called <code>Vendors</code></p>\n\n<p><code>InvoiceNumber</code> and <code>InvoiceTotal</code> are in a table called <code>Invoices</code></p>\n\n<p>it needs to show all the vendors in the result even if the vendors dont have any invoices, display the largest invoice totals first DESC and sort the Vendor Names in Alphabetical order.</p>\n\n<p>I tried to Join the Invoices into my </p>\n\n<pre><code>SELECT VendorName FROM Vendors \n</code></pre>\n\n<p>but I cannot figure out the syntax :/</p>\n"},{"tags":["sql","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13288511,"title":"Mapping a table to lots of other tables?","body":"<p>I have a website I develop that is structured a little like stackoverflow. I have a <code>Posts</code> table and a <code>PostImages</code> table in the database. The <code>PostImages</code> table looks like this:</p>\n\n<pre><code>PostImageId PK\nPostId      FK\nUri\nMimeType\n</code></pre>\n\n<p>So posts can have lots of images associated with them.</p>\n\n<p>I now have the requirement that other places on the site should have images: <code>Users</code> should be able to have images on their profile, <code>Categories</code> should be able to have images, and <code>Addresses</code> should be able to have images.</p>\n\n<p>It seems best to only have a single <code>Images</code> table in my database. How should I model this? I could have a single table like this:</p>\n\n<pre><code>ImageId    PK\nPostId     FK\nCategoryId FK\nAddressId  FK\nUserId     FK\nUri\nMimeType\n</code></pre>\n\n<p>I could have a single <code>images</code> table, then extra tables for each kind of object:</p>\n\n<pre><code>PostImageId      PK FK\nPostId           FK\n\nCategoryImageId  PK FK\nCategoryId       FK\n</code></pre>\n\n<p>(where the PK of each item is also FK to an image from the <code>Images</code> table)</p>\n\n<p>There are some other strategies, too: for instance, I could have a <code>___Images</code> table for each type, and no shared <code>Images</code> table. I could have a many-to-many mapping table for each, and perhaps there are some other solutions I haven't thought of.</p>\n\n<p>What is best? I don't know that much about database design - which will be the most flexible and easiest to use?</p>\n"},{"tags":["sql","sql-server","tsql","math","calculator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":32,"score":-4,"question_id":13291491,"title":"SQL Server 2012 Calculate total with tax","body":"<p>there needs to be 3 columns </p>\n\n<p>the tax needs to be 13%</p>\n\n<p>the tax amount needs to be added to the InvoiceTotal the amount that it adds needs to be put in the tax column and the InvoiceTotal needs to be added by the Tax amount and put into the Total Column but only if the InvoiceTotal is greater then 0$ aka if there is a balance owed </p>\n\n<p>InvoiceTotal is the only place you need to draw data from and InvoiceTotal is a column in the tables called Invoices</p>\n\n<p>Structure below: </p>\n\n<p>InvoiceTotal  Tax  Total</p>\n"},{"tags":["sql","sql-server-2005","sql-server-2008"],"answer_count":6,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":17167,"score":13,"question_id":545316,"title":"Is it possible to restore Sql Server 2008 backup in sql server 2005","body":"<p>Is it possible to restore a backup of a SQL Server 2008 database onto an instance of SQL Server 2005?</p>\n\n<p>I need to work on an sample application for which database backup is in sql server 2008.\nBut I'll not be able to install 2008. So is it possible to restore that back up in 2005?</p>\n"},{"tags":["sql","tsql","sql-server-2012"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":27,"score":-2,"question_id":13290738,"title":"How to join two SQL queries?","body":"<p>Making two SQL queries into the same table</p>\n\n<pre><code>SELECT FirstName,\n       LastName,\n       LEFT(FirstName, 1) + '.' + LEFT(LastName, 1) AS Initial\nFROM   ContactUpdates\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>FirstName    LastName    Initial\n</code></pre>\n\n<p>I want this to join this other one on the right side where Initial ends</p>\n\n<pre><code>SELECT LOWER(LEFT(FirstName, 1) + REPLACE(LastName,'''','' ) )\n         + '@email.com' AS Email\nFROM   ContactUpdates\n</code></pre>\n\n<p>In the end I want it to be</p>\n\n<pre><code> FirstName    LastName    Initial    Email \n</code></pre>\n\n<p>But I can't figure out how to make them join any help?</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13291423,"title":"SQL Server 2005 Import and Export Wizard","body":"<p>With reference to Import and Export Wizard, in SQL Server 2005 environment, I would like to receive some suggestions on how to select the best field separator: the table I need to export as flat file for example contains columns with commas inside them, so I can't use comma as field separator.</p>\n\n<p>I have thought to search in all tables what is the ASCII character (0-255) NOT PRESENT, and use this character as separator, but this search operation is computationally heavy.</p>\n\n<ul>\n<li>What type of character could I use for exporting a table as flat file?</li>\n<li>Could I use a couple of characters, for example <code>,$</code>    ?</li>\n<li>Is it preferable to use fixed length fields?</li>\n</ul>\n\n<p>Any suggestion would be appreciated.</p>\n\n<p>The best suggestion will be accepted.</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13289214,"title":"consecutive dates and appointments in sql","body":"<p>I've got a sql table that holds engineer, appt_date and appt_slot. </p>\n\n<pre><code>engineer_id, visit_date, visit_slot\n\n1,           20/10/12,   All Day\n1,           21/10/12,   AM\n2,           20/10/12,   All Day\n2,           21/10/12,   All Day\n2,           22/10/12,   All Day\n3,           20/10/12,   PM\n3,           21/10/12,   All Day\n3,           22/10/12,   PM\n</code></pre>\n\n<p>What I'd like to show is</p>\n\n<pre><code>Engineer_id, start_visit,      end_visit\n\n1,           20/10/12 All Day, 21/10/12 AM\n2,           20/10/12 All Day, 22/10/12 All Day\n3,           20/10/12 PM,      21/10/12 All Day\n3,           22/10/12 PM,      22/10/12 PM\n</code></pre>\n\n<p>I'm struggling with the sql to show the breaks in the bookings, any help would be greatly appreciated.\nThanks</p>\n"},{"tags":["sql","sql-server","xml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13289773,"title":"Sql server xml select query xpath is slow","body":"<p>My XML structure:</p>\n\n<pre><code>&lt;Items&gt;\n  &lt;Item&gt;\n    &lt;guid&gt;FC550573-7171-997F-752D-8D65590CBFD6&lt;/guid&gt;\n    &lt;Objects&gt;\n       &lt;Object&gt;\n         &lt;type&gt;0&lt;/type&gt;\n         &lt;guid&gt;E10D9DA9-2C8D-8024-2F07-DF21395811BF&lt;/guid&gt;\n       &lt;/Object&gt;\n       &lt;Object&gt;\n         &lt;type&gt;0&lt;/type&gt;\n         &lt;guid&gt;D8338400-35C7-781E-A039-C0FDDF80714A&lt;/guid&gt;\n       &lt;/Object&gt;\n    &lt;/Objects&gt;\n  &lt;/Item&gt;\n&lt;/Items&gt;\n</code></pre>\n\n<p>When filling the Objects Table:</p>\n\n<pre><code>CREATE TABLE [dbo].[Objects](\n    [item_guid] [varchar](36) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n    [type] [int] NOT NULL,\n    [guid] [varchar](36) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL\n) ON [PRIMARY]\n</code></pre>\n\n<p>Using the Query:</p>\n\n<pre><code>INSERT INTO [dbname].[dbo].[Objects]\n           ([item_guid]\n           ,[type]\n           ,[guid])\nSELECT\n X.source.query('../../guid').value('.','VARCHAR(36)') as item_guid,\n X.source.query('type').value('.','INT') as type,\n X.source.query('guid').value('.','VARCHAR(36)') as guid\nFROM(\nSelect xmldata from XmlFiles where fullpath=@fp\n) AS T(x)\nCROSS APPLY x.nodes('Items/Item/Objects/Object') As X(source)\n</code></pre>\n\n<p>This line is making the query VERY slow:</p>\n\n<pre><code>X.source.query('../../guid').value('.','VARCHAR(36)') as item_guid\n</code></pre>\n\n<p>What is the proper approach here?</p>\n"},{"tags":["sql","sql-server","view","yield"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13290847,"title":"Yield Return equivalent in SQL Server","body":"<p>I am writing down a view in SQL server (DWH) and the use case pseudo code is:</p>\n\n<pre><code>-- Do some calculation and generate #Temp1\n-- ... contains other selects\n\n-- Select statement 1\nSELECT * FROM Foo\nJOIN #Temp1 tmp on tmp.ID = Foo.ID\nWHERE Foo.Deleted = 1\n\n-- Do some calculation and generate #Temp2\n-- ... contains other selects\n\n-- Select statement 2\nSELECT * FROM Foo\nJOIN #Temp2 tmp on tmp.ID = Foo.ID\nWHERE Foo.Deleted = 1\n</code></pre>\n\n<p>The result of the view should be:</p>\n\n<pre><code>Select Statement 1\nUNION\nSelect Statement 2\n</code></pre>\n\n<p>The intended behavior is the same as the <code>yield return</code>in C#. Is there a way to tell the view which <code>SELECT</code> statements are actually part of the result and which are not? since the small calculations preceding what I need also contain selects.</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","asp.net","sql","reporting-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13290940,"title":"SQL Server 2008 R2 reporting services web service fails to load report","body":"<p>I am working on displaying a report hosted in SQL server 2008 R2 reporting services from an asp.net web application.</p>\n\n<p>The web application and the reporting server are on the same machine. The report is loaded in a report viewer control on an aspx page. The problem I am encountering is, whenever I load the page that displays the report, I get a prompt to enter a user name and password. When I enter a user name and password,  the page displays the report manager interface (shows report folders, data sources and reports on the server) instead of loading the actual report. This does not happen on the development machine (here the report displays without any prompts). Please help me troubleshoot this problem. Why I'm I being prompted for a username and password? Why is the page displaying the report server instead of the report?</p>\n\n<p>Here is the code I use to load the report.</p>\n\n<pre><code>reportViewer.ProcessingMode = Microsoft.Reporting.WebForms.ProcessingMode.Remote;\n//AppReportServerCredentials contains the user name and password of a user allowed to view reports on the server\nreportViewer.ServerReport.ReportServerCredentials = new AppReportServerCredentials();\nreportViewer.ServerReport.ReportServerUrl = new Uri(\"http://localhost/reportserver\");\nreportViewer.ServerReport.ReportPath = \"/reports_folder/report_name\";\nparam1 = new ReportParameter(\"param1\", 1234);\nparam2 = new ReportParameter(\"param2\", \"abcd\");\nreportViewer.ServerReport.SetParameters(new ReportParameter[] { param1, param2 });\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13290325,"title":"Output parameter in stored procedure is null","body":"<p>I can't seem to get the output parameter right, it's empty where I'm exepecting 'TEMPTABLE'?</p>\n\n<pre><code>create table TEMPTABLE\n(\n  Id int identity primary key,\n  Name nvarchar(50) not null,\n);\nGO\n\ninsert into TEMPTABLE(Name) values('Name 1');\nGO\n\nDECLARE @PARMOUTP nvarchar(50)\nDECLARE @ParameterDefinition AS NVARCHAR(2000)\nDECLARE @DestTable VARCHAR(50)\ndeclare @sql nvarchar(max)\n\n    set @sql = 'SELECT   OBJECT_NAME(OBJECT_ID) AS TABLENAME \n                FROM     SYS.IDENTITY_COLUMNS  \n                WHERE OBJECT_NAME(OBJECT_ID) = @DestTable'\n\nset @DestTable = 'TEMPTABLE'\n\nset @ParameterDefinition = '@DestTable VARCHAR(50), @PARMOUTP VARCHAR(50) OUTPUT'\n\n\nEXECUTE sp_executesql @sql,\n                  @ParameterDefinition,\n                  @DestTable,\n                  @PARMOUTP OUTPUT\n\nprint @PARMOUTP;\nprint isnull(@PARMOUTP, 'PARMOUTP is null!');\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n\n<p>Regards,</p>\n\n<p>Mike</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13290576,"title":"SELECT query and sub-select query with dynamic table names","body":"<p>I have an interesting situation about my MySQL db structure.</p>\n\n<p>Let's assume I have three database tables: table_Main, table_sub_A, table_sub_B</p>\n\n<p>\"table_Main\" fields:</p>\n\n<ul>\n<li>RowID</li>\n<li>Code (this field is used to find the \"table_sub_\" table</li>\n<li>Name</li>\n</ul>\n\n<p>Example \"table_Main\" rows:</p>\n\n<pre><code>1,A,Test A\n2,B,Test B\n</code></pre>\n\n<p>Now, I want to build an SQL query which will retrieve all rows from table_Main but also get count(*) from corresponding tables for each table_Main row.</p>\n\n<pre><code>SELECT *, (SELECT COUNT(*) FROM table_sub_XXXX) AS TotalRecords  FROM table_Main\n</code></pre>\n\n<p>Problem starts here. XXXX should be the \"Code\" column value for each corresponding table_Main row. How can I generate a dynamic table name inside sub-select query?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["mysql","sql","table","show","ordering"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13290384,"title":"MySQL: sort order \"SHOW TABLES\"","body":"<p>How are the tables ordered returned by \"SHOW TABLES\"?</p>\n\n<p>For example the output for the <code>information_schema</code> database looks like this: </p>\n\n<pre><code>CHARACTER_SETS\nCOLLATIONS\nCOLLATION_CHARACTER_SET_APPLICABILITY\nCOLUMNS\nCOLUMN_PRIVILEGES\nENGINES\nEVENTS\nFILES\nGLOBAL_STATUS\nGLOBAL_VARIABLES\nKEY_COLUMN_USAGE\nPARAMETERS\nPARTITIONS\nPLUGINS\nPROCESSLIST\nPROFILING\nREFERENTIAL_CONSTRAINTS\nROUTINES\nSCHEMATA\nSCHEMA_PRIVILEGES\nSESSION_STATUS\nSESSION_VARIABLES\nSTATISTICS\nTABLES\nTABLESPACES\nTABLE_CONSTRAINTS\nTABLE_PRIVILEGES\nTRIGGERS\nUSER_PRIVILEGES\nVIEWS\nINNODB_CMP_RESET\nINNODB_TRX\nINNODB_CMPMEM_RESET\nINNODB_LOCK_WAITS\nINNODB_CMPMEM\nINNODB_CMP\nINNODB_LOCKS\n</code></pre>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13289571,"title":"check at least a record exists","body":"<p>two tables:</p>\n\n<pre><code>== customers ==\ncust_id\n\n== attachments ==\natt_id\ncust_id\n</code></pre>\n\n<p>1 customer -> MANY attachments</p>\n\n<p>i would retrieve all the custmers and, adding the boolean virtual field \"has_attach\" to select, know if a customer have got attachments.</p>\n\n<p>without GROUP BY, if this is possibile :-)</p>\n"},{"tags":["mysql","sql","tsql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13289546,"title":"Which query is the correct way?","body":"<p>Can somebody please tell me which is the better way, they both produce the same results but which is more 'correct'?</p>\n\n<p>Personally I feel the first query is easier to read, but I seem to read elsewhere that aliases should always be used.</p>\n\n<p>Thanks</p>\n\n<pre><code>SELECT Patient.PatientSurname, Doctor.DoctorSurname\nFROM Patient\nJOIN Operation\nON Operation.PatientCode=Patient.PatientCode\nJOIN Doctor\nON Doctor.DoctorCode=Operation.DoctorCode\nWHERE Operation.OperationType='Broken Arm'\nGROUP BY Patient.PatientSurname\nHAVING count(Patient.PatientSurname) &gt; 0\n\n\nSELECT PatientSurname, DoctorSurname\nFROM Patient as p, Operation as o, Doctor as d\nWHERE o.PatientCode=p.PatientCode\nAND  d.DoctorCode=o.DoctorCode\nAND o.OperationType='Broken Arm'\nGROUP BY p.PatientSurname\nHAVING count(p.PatientSurname) &gt; 0\n</code></pre>\n"},{"tags":["sql","silverlight","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13289834,"title":"Silverlight website with SQL Server Compact database","body":"<p>I created a Silverlight website with a database in SQL Server Compact Edition a few months ago.</p>\n\n<p>Now, I reinstalled my PC and when I open my project in Visual Studio and press F5 then everything works perfect but if I go to the <code>.web</code> folder and open the <code>.html</code> page then it doesn't show my data, it only shows my page.</p>\n\n<p>Anyone got any idea why this is?</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13290021,"title":"How to get Unique records via LINQ","body":"<pre><code>var EmpRecList = (from ur in db.Users\n  join ug in db.UserGroups on ur.UserGroupID equals ug.UserGroupID\n  select new\n  {\n      lastName = ur.LastName, \n      userID = ur.UserID,\n      firstName = ur.FirstName,\n      userGroupName = ug.UserGroupNameLang1\n  }).Where(oh =&gt; oh.userGroupName.StartsWith(userCur.UserGroupName))\n                                  .OrderBy(x =&gt; x.lastName);\n</code></pre>\n\n<p>I have this code snippet. The problem here is, im getting 2 records with the same user ID. I would like to have a distinct record based on the User ID. Thanks. Tried using distinct method but no success.</p>\n"},{"tags":["php","sql","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13290044,"title":"I need to output my Access table to a website using PHP","body":"<p>Alright, I have no problem outputting multiple lines of data out of the database, I just have no idea how to get it out in the format I want. </p>\n\n<p>Here's my basic issue.</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;?php               \n    //make connection to database, bail if no connection\n    $connection = odbc_pconnect('sitedata','','');\n    if (!$connection) { exit(\"Connection Failed: \" . $connection); }\n\n    //retrieve relevant data\n    $Date = \"SELECT EntryDate AS DT FROM TimeSheet WHERE EmployeeID = 'AA01'\";\n\n    $rs = odbc_exec($connection, $Date);\n\n    //output data\n    while(odbc_fetch_row($rs)) {\n        $Line1 = odbc_result($rs, 'DT');\n        printf(\"&lt;td&gt;&lt;center&gt;%s&lt;/center&gt;&lt;/td&gt;\", $Line1);                 \n    }\n    ?&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>What this will do is output a one row table, with each new date creating a new column.</p>\n\n<p>Now then, this is sort of useless to me as these need to be output into a single column, where each new datavalue is the beginning of a row. After this, I need to expand the table width wise, adding new data values such as:</p>\n\n<pre><code>$Time = \"SELECT TotalTime as EN FROM TimeSheet WHERE EmployeeID = 'AA01'\";\n$JobName = \"SELECT JobName as JN FROM TimeSheet WHERE EmployeeID = 'AA01'\";\n</code></pre>\n\n<p>Where Time is it's own column, JobName is it's own column, etc.</p>\n\n<p>How exactly do I do this? There obviously must be a way, I'm just new at this. Any help is greatly, greatly appreciated!</p>\n"},{"tags":["sql","sql-server","sql-server-2005","sql-update","database-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":9053805,"title":"Update statement issue","body":"<p>I have an issue that, while using sql server 2005 i have executed update query without where clause (by mistake) and all the original values of the column get lost.</p>\n\n<p>How can I get old values??</p>\n\n<p>Any suggestion/tips/solution is welcome and will be highly appreciated.</p>\n"},{"tags":["sql","oracle","join","filter","count"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13290105,"title":"Selecting top results from SQL Count query, including table join - Oracle","body":"<p>I have this query currently, which selects the top \"number of pickups\" in descending order. I need to filter only the top 10 rows/highest numbers though. How can I do this? </p>\n\n<p>I have tried adding 'WHERE ROWNUM &lt;= 10' at the bottom, to no avail.</p>\n\n<pre><code>SELECT customer.company_name, COUNT (item.pickup_reference) as \"Number of Pickups\" \nFROM customer\nJOIN item ON (customer.reference_no=item.pickup_reference) \nGROUP BY customer.company_name, item.pickup_reference\nORDER BY COUNT (customer.company_name) DESC;\n</code></pre>\n\n<p>Thanks for any help!</p>\n"},{"tags":["sql","sql-server","ssis","ssas","business-intelligence"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13288749,"title":"Is it necessary to use SSIS to create SSAS cubes using Oracle data?","body":"<p>I'm working on research project using Microsoft BI Stack and Oracle Database. When working with these two technologies I was able to use SSIS and SSRS. </p>\n\n<p>My process was connecting Oracle database through SSIS and SSAS.</p>\n\n<p>Yes, it has worked but SSIS is responsible for the ETL process. I was still able to create cubes in SSAS without using SSIS. </p>\n\n<p>What's the difference between these two processes?</p>\n\n<ol>\n<li><p>When using SSAS without SSIS, is it automatically invoking the SSIS process (ETL) behind the scenes?</p></li>\n<li><p>If yes, what's the point of having SSIS?</p></li>\n</ol>\n"},{"tags":["sql","postgresql","postgresql-9.1"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13289304,"title":"PostgreSQL - dynamic value as table name","body":"<p>I wish to use the returned string from the query about as a table name for other query.</p>\n\n<pre><code>SELECT 'backup_' || TO_CHAR(CURRENT_DATE,'yyyy-mm-dd')\n</code></pre>\n\n<p>as you can see it return a string. I wish to use it as an input for another query, e.g.</p>\n\n<pre><code>CREATE TABLE (SELECT 'backup_' || TO_CHAR(CURRENT_DATE,'yyyy-mm-dd')) \nAS * SELECT FROM backup\n</code></pre>\n\n<p>Can it be done? Any clue how?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13289331,"title":"Insert multiple rows with given values and values from related table","body":"<p>I have a large insert query like this:</p>\n\n<pre><code>INSERT INTO video_tags\n  (vid_id, tag_id)\nVALUES\n  (1,7),\n  (2,46),\n  (2,52) Etc. Etc.\n</code></pre>\n\n<p>However I don't have the tag_ids to insert, only the tag string. Therefore I need to lookup the tag id as I am inserting them. The tags are stored in a lookup table with two columns:</p>\n\n<pre><code>+-----+---------+\n| id  | int     |\n| tag | varchar |\n+-----+---------+\n</code></pre>\n\n<p>I want to do something like this:</p>\n\n<pre><code>INSERT INTO video_tags\n  (vid_id, tag_id)\nVALUES\n  (1, SELECT id FROM tags WHERE tag = 'banana'),\n  (2, SELECT id FROM tags WHERE tag = 'tree')\n  (2, SELECT id FROM tags WHERE tag = 'chimps')\n</code></pre>\n\n<p>...but this doesn't work and anyway looks cumbersome and inefficient.</p>\n\n<p>I have also seen this done:</p>\n\n<pre><code>INSERT INTO video_tags\n  (vid_id, tag_id)\nVALUES\n  SELECT '1', id FROM tags WHERE tag = 'banana')\n</code></pre>\n\n<p>...but I can't get this to work with multiple selects.</p>\n"},{"tags":["sql","zend-framework2","quote"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13287731,"title":"Quote value into Zend Framework 2","body":"<p>I'm working on an application using ZF2. In my application, I have to insert many rows in a database (about 900).</p>\n\n<p>I've got a table model for this, so I first try to do :</p>\n\n<pre><code>$table-&gt;insert(array('x' =&gt; $x, 'y' =&gt; $y));\n</code></pre>\n\n<p>in my loop. This technically work, but this is so slow that I can hardly insert half of the datas before php's timeout (and I can't change the timeout).</p>\n\n<p>Then, I've decide to use a prepared statment. So I've prepared it outside of the loop, then execute it in my loop... it was even slower.</p>\n\n<p>So, I decide to stop using ZF2 tools, as they seems to be too slow to be used in my case, and i've created my own request. I'm using mysql, so i can do a single request with all my values. But I can't find any method in any of the interface to escape my values...</p>\n\n<p>Is there any way to do this ?</p>\n\n<p>Thank you for your help and sorry for my poor english.</p>\n"},{"tags":["mysql","sql","database","query","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":39,"score":4,"question_id":13288764,"title":"Nested queries (dependent queries)","body":"<p>I need to store a family (i.e. some childs of a parent. Those childs have their own childs and so on..)</p>\n\n<p>So, I created a table family that has following structure</p>\n\n<blockquote>\n  <p>id&nbsp;&nbsp;&nbsp;&nbsp;child&nbsp;&nbsp;&nbsp;&nbsp;child_id&nbsp;&nbsp;&nbsp;&nbsp;parent_id</p>\n</blockquote>\n\n<p>When I save a child, I store a parent_id along with it.</p>\n\n<p>Now,</p>\n\n<p>when I want to fetch all childs of given parent, I can easily do.</p>\n\n<pre><code>select child_id from family where parent_id = &lt;given parent id&gt;\n</code></pre>\n\n<p>But, </p>\n\n<p>now I want to fetch the complete family (all descendants of a given parent)</p>\n\n<p>i.e.</p>\n\n<p>I want to fetch all childs which have a given parent_id + all childs that are childs of fetched childs in first query and so on.</p>\n\n<p>Can somebody help me ?</p>\n\n<p>I also, thing there could be better way to store the data initially, so I can fetch it later. Can somebody point out a better way ?</p>\n"},{"tags":["sql","oracle","execution"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12687371,"title":"Slow view execution using ADF and OracleSQL","body":"<p>I have an unusual problem when trying to execute a view object in a Oracle database. The query itself executes using Toad for Oracle within 10 seconds, while executing the same query in a view object takes more than a minute. I am using JDeveloper 10.1.3.3.0.4157 with ADF, and am connecting to an 10g Oracle database.</p>\n\n<p>What I found is that while the execution is taking place, the database server is constantly being \"pinged\" with 128 bytes of data (I've done this using Wireshark). This, in turn, clogs the connection and is the reason it takes long for the data to get to the application. I've tested this theory with session tracing, and it turns out the query itself executes in the same time-frame as the one from Toad.</p>\n\n<p>I suppose the problem is somewhere in the database driver, but since I cannot debug it, I'm left empty handed.</p>\n\n<p>Any suggestion would be appreciated!</p>\n\n<p>MORE INFO:</p>\n\n<p>The query in question is somewhat large. It is also built in run-time and is variable (however, the number, name and type of the attributes is constant). The interesting part is that when the query is small(er), the execution time falls to the one present in the Toad execution.</p>\n\n<p>A similar \"pinging\" effect was detected in another view that belongs to the same application module, but testing implied that this was not a problem with the AM configuration, since it's identical to all the other ones, and they are working fine. Plus, other views in the same AM as the query in question do not show any signs of the same problem.</p>\n\n<p>I've been playing with the view Tuning settings, but with no difference to the execution time.</p>\n"},{"tags":["php","html","sql","database","escaping"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":13289166,"title":"Trouble inserting content to database, need help escaping PHP code","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3446216/difference-between-single-quote-and-double-quote-string-in-php\">Difference between single quote and double quote string in php</a>  </p>\n</blockquote>\n\n\n\n<p>Hey I'm having trouble inserting page content into my database.</p>\n\n<p>I'm trying to store:</p>\n\n<pre><code>&lt;p class=\\\"heading_large\\\"&gt;&lt;?php echo $Topic2C2A[data]; ?&gt;&lt;/p&gt;\n</code></pre>\n\n<p>Using this code:</p>\n\n<pre><code>$sql=\"UPDATE event SET \n  data='&lt;p class=\\\"heading_large\\\"&gt;&lt;?php echo $Topic2C2A[data]; ?&gt;&lt;/p&gt;' \n  WHERE id='2'\";\n</code></pre>\n\n<p>But when I look at the table all I see is:</p>\n\n<pre><code>&lt;p class=\"heading_large\"&gt;&lt;?php echo ; ?&gt;&lt;/p&gt;\n</code></pre>\n\n<p>I've obviously escaped the HTML with slashes, is there something similar I need to do with the PHP so <code>$Topic2C2A[data]</code> is displayed?</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13275969,"title":"Cannot insert duplicate key row in object with unique index 'SAXXIRPT while updating","body":"<p>I am writing a SQL statement to update a table in SQL from a temp table. I keep getting this error message: <code>Cannot insert duplicate key row in object with unique index 'SAXXIRPT'</code>.</p>\n\n<p>Here is my update statement: </p>\n\n<pre><code>Update dbo.sat_ser_rpt_itm\nSET itm_key_cd = n.itm_key_cd,\n  itm_typ_cd  = n.itm_typ_cd,\n  ser_id  = n.ser_id ,\n  as_of_dt = n.as_of_dt,\n  ocrn_nr  = n.ocrn_nr ,\n  id_rssd = n.id_rssd,\n  ocrn_day_txt = n.ocrn_day_txt ,\n  ocrn_dt = n.ocrn_dt ,\n  hol_flg = n.hol_flg ,\n  ocrn_val_nr = n.ocrn_val_nr \n  from #LookupTable n\n  on sat_ser_rpt_itm.id_rssd = n.id_rssd \nAND sat_ser_rpt_itm.as_of_dt = n.as_of_dt \nAND sat_ser_rpt_itm.ser_id = n.ser_id \nand sat_ser_rpt_itm.itm_typ_cd = n.itm_typ_cd \nand sat_ser_rpt_itm.ocrn_nr = n.ocrn_nr \nwhere t.id_rssd is not null and  t.as_of_dt is not null  and  t.ser_id is not null and  t.itm_typ_cd is not null and t.ocrn_nr is not null  \n</code></pre>\n\n<p>These are my indexes (clustered):</p>\n\n<pre><code>id_rssd, as_of_dt, ser_id, itm_key_cd and ocrn_nr\n</code></pre>\n\n<p>What's causing this error message?</p>\n"},{"tags":["sql","teradata"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13286440,"title":"Calculating sales for a particular weekday in a given period in teradata","body":"<p>I have  a table with transaction, date and their respective sales value. I need to calculate  sum of Sales of all the distinct transactions on all Saturdays between date x and y. Teradata doesn't have a datename, datepart function. How can I do this?</p>\n"},{"tags":["c#","java","sql","database","mysqli"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":13288737,"title":"Handle multi biilion row table","body":"<p>Think about facebook , they have billions of post , if they want to put all post in a table , they have to have about 1 billion insertion per day and really more than them of Read .</p>\n\n<p>my way is to break all post in separate table that has max 1 billion row and if they reached that max count , a new table will create and store until it reaches max row . (it is only suggestion )</p>\n\n<p><strong>what is your suggested way ?\nwhat is your suggestion DB for this ?</strong></p>\n"},{"tags":["sql","sql-server","sql-server-2005","stored-procedures","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13288803,"title":"SQL Server : update multiple rows dynamically","body":"<p>I want to update multiple rows in my database, the values might be different. Imagine this table:</p>\n\n<pre><code>Username   FirstName   LastName \n-------------------------------\nuser1      John        Doe \nuser2      Jane        Doe\nuser3      bill        gates\n</code></pre>\n\n<p>If I want to update the table so it looks like this:</p>\n\n<pre><code>Username   FirstName   LastName \n-------------------------------\nuser1      John        Deer \nuser2      Jane        Farmer\nuser3      Gill        Bates\n</code></pre>\n\n<p>Is it best to use one <code>UPDATE</code> statement for each user? Or is it possible to do this with one query?</p>\n\n<p>Also is it possible to put it in a stored procedure and provide a collection of values?</p>\n\n<p>Second question is it best to check if the values are changed before doing an update? Or just update everyone even if the value is the same? </p>\n\n<p>I am currently using SQL Server 2005 and C# for the application if that is relevant.</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13289019,"title":"Rails 3.2: Ordering a has_many :through selection, when the through-model has a default_scope","body":"<p>I have a simple time-tracking app, that has projects, tasks, and entries.</p>\n\n<p>The setup is straight-forward:</p>\n\n<pre><code>class Project &lt; ActiveRecord::base\n  has_many :tasks\n  has_many :entries, :through =&gt; :tasks\nend\n\nclass Task &lt; ActiveRecord::base\n  belongs_to :project\n  has_many :entries\n\n  default_scope order(\"name asc\") # this causes problems\nend\n</code></pre>\n\n<p>(<code>Entry</code> is entirely straight-forward, so I've left it out)</p>\n\n<p>However, I'm running into trouble when trying to do custom ordering of entries selected from a project. Specifically, I'm trying to select the latest entry like so:</p>\n\n<pre><code>latest_entry = project.entries.order(\"created_at desc\").first\n</code></pre>\n\n<p>But due to the <code>:through =&gt; :tasks</code> and the <code>default_scope</code> that <code>Task</code> has, the actual query that Rails executes becomes:</p>\n\n<pre><code>SELECT `entries`.* FROM `entries`\nINNER JOIN `tasks` ON `entries`.`task_id` = `tasks`.`id`\nWHERE `tasks`.`project_id` = 23\nORDER BY name asc, entries.date desc LIMIT 1 -- wrong order!\n</code></pre>\n\n<p>Note the <code>ORDER BY clause</code> - it includes the <code>default_scope</code> from <code>Task</code>, and only after that does it include the order I specified.</p>\n\n<p>So basically, I <em>don't</em> get the latest entry of all entries in the project, but only the latest in the first task.</p>\n\n<p>Is there any way around that? Seems like there should be a way to ignore/negate <code>default_scope</code> on a <code>through</code>-model (without completely dropping the <code>default_scope</code>)</p>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13288909,"title":"Retrieve information from two different tables","body":"<p>I am currently new in SQL language and I am struggling to understand how to retrieve correct information from tables below:</p>\n\n<p>staff table</p>\n\n<pre><code>+------+----------+---------+-----------------+------+------+\n| s_id | initials | s_name  | pos             | qual | d_id |\n+------+----------+---------+-----------------+------+------+\n| AA   | A.       | Tom     | Lecturer        | PhD  | RELI |\n| BBB  | J.J.     | Jason   | Senior Lecturer | PhD  | RELI |\n| CCC  | B.A.     | Andy    | Senior Lecturer | PhD  | BIOL |\n| DD   | M.       | Mark    | Professor       | PhD  | BIOL |\n| EE   | W.       | Alen    | Professor       | BA   | BIOL |\n+------+----------+---------+-----------------+------+------+\n</code></pre>\n\n<p>research table</p>\n\n<pre><code>+------+-------+------------+-----------+\n| s_id | r_id  | str_date   | fin_date  |\n+------+-------+------------+-----------+\n| BBB  | RESH1 |       1990 |      1998 |\n| BBB  | RESH2 |       1980 |      1985 |\n| DD   | RESH4 |       1995 |      1999 |\n| AA   | RESH4 |       1992 |      1999 |\n| CCC  | RESH8 |       1989 |      1994 |\n| EE   | RESH5 |       1988 |      1989 |\n+------+-------+------------+-----------+\n</code></pre>\n\n<p>I am trying to create a new table that will contains, staff s_name and how many different researches has each person did.</p>\n\n<p>What I have until now is</p>\n\n<pre><code>select distinct s.s_name, count(r.s_id) \nfrom staff s \ninner join research r \non s.s_id = r.s_id \nwhere s.s_id = r.s_id;\n</code></pre>\n\n<p>My result is,</p>\n\n<pre><code>+---------+---------------+\n| s_name  | count(r.s_id) |\n+---------+---------------+\n| Jason   |             6 |\n+---------+---------------+\n</code></pre>\n\n<p>What I am doing wrong?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":24,"score":1,"question_id":13264109,"title":"Oracle:Set default value for number column","body":"<p>How can we set default value for a number typed column has '00'?I tried this but it still saved it has '0',I need to do this.</p>\n\n<pre><code>//alter table table_name add column column1 default '00';\n</code></pre>\n\n<p>Please suggest a way for me.</p>\n"},{"tags":["sql","database","sap","abap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13285983,"title":"Mapping the fields of two database tables in ABAP","body":"<p>The scenario is that, I have 2 database tables A and B. The table B is an upgraded version of the table A. (ie It might possibly have different field names and some extra fields). I need to compare these 2 tables to inform the user about these extra fields and propose to him a mapping of the fields between the tables.</p>\n\n<p>Currently I am thinking of comparing them using info like field name, data element and domain in that order.\nIs there a standard way to do this? Thanks in advance.</p>\n\n<hr>\n"},{"tags":["php","sql","phpmyadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13288821,"title":"PHP: Missing value in the form","body":"<p>I am trying to import these sql statements.</p>\n\n<p>I get the error </p>\n\n<blockquote>\n  <p>Missing value in the form!</p>\n</blockquote>\n\n<pre><code>CREATE DATABASE IF NOT EXISTS `login`;\n\nCREATE TABLE IF NOT EXISTS `login`.`users` (\n  `user_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'auto incrementing user_id of each user, unique index',\n  `user_name` varchar(64) COLLATE utf8_unicode_ci NOT NULL COMMENT 'user''s name',\n  `user_password_hash` text COLLATE utf8_unicode_ci NOT NULL COMMENT 'user''s password in salted and hashed format',\n  `user_email` text COLLATE utf8_unicode_ci COMMENT 'user''s email',\n  PRIMARY KEY (`user_id`),\n  UNIQUE KEY `user_name` (`user_name`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='user data' AUTO_INCREMENT=1 ;\n</code></pre>\n"},{"tags":["sql","duplicate-data"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13288888,"title":"Designing a duplicate check","body":"<p>We are building an mRSS feeds processing machine. Partners give us feeds (xml formatted, containing various metadata) and we scan those feeds continuously, looking for new items to process.</p>\n\n<p>Once we have processed an item, we need to know if it has already been processed. We rely on several fields to do that, for simplicity sake we have one string field and one int field. Each item's identifying field (string/int/combination of both) is looked up in the DB and if it exists, it is marked \"duplicate\" and not processed.</p>\n\n<p>Today we find ourselves in a situation where our current duplicate check is ineffective and causes timeouts. We are looking to redesign the duplicate check and looking for real world solutions to similar problems.</p>\n\n<p>Solutions that we've gone through are better indexing (didn't help significantly, it was already well indexed), converting the check from int/string to hash/checksum (combining several fields is an issue since the checksum has to be on every possible combination).</p>\n\n<p>We'd appreciate your thoughts on this, real world solutions, anything that can help us.</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13288527,"title":"How to group and count items in groups and get the full row?","body":"<p>This query gets the desired rows -grouped by subject- and I also want to know the items count in each group.</p>\n\n<pre><code>SELECT log.* FROM [hm_deliverylog] AS log\nWHERE log.deliveryid IN\n    (\n        SELECT MAX([deliveryid])  FROM [hm_deliverylog]\n        WHERE [deliverytime] &gt; DATEADD(HOUR, -12, GETDATE())\n        GROUP BY deliverysubject\n    )\n\nORDER BY deliveryid DESC\n</code></pre>\n\n<p>How can I count the groups? Like below?</p>\n\n<pre><code>SELECT joined.groupcount, log.* FROM [hm_deliverylog] AS log\n</code></pre>\n\n<p>P.S: Imagine the Gmail inbox; it displays the newest message and shows the message count. I want to group the messages with same subject and count them...</p>\n"},{"tags":["sql","oracle","sqlplus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13288132,"title":"SQL movie database querying","body":"<p>I'm having trouble solving the following SQL requests:</p>\n\n<ol>\n<li><p>Give the names of the actors that have acted in more films than 'sara allgood' and who have acted in films that won the 'cannes film festival'. Also, give the filmname.</p></li>\n<li><p>Get the percentage of movies who won awards out of all movies produced between the years 1970 and 1990.</p></li>\n</ol>\n\n<p>There are several tables but I'm assuming that only 4 are needed: \n'films','remakes','casts', 'awtypes'</p>\n\n<ul>\n<li><p>'films' attributes: filmid, filmname, year, director, studio, award </p></li>\n<li><p>'remakes' attributes: filmid, title, year, priorfilm, prioryear</p></li>\n<li><p>'casts' attributes: filmid, filmname, actor, award(10)</p></li>\n<li><p>'awtypes' attributes: award(10), org(100), country, colloquial(50), year</p></li>\n</ul>\n\n<p>It's a bit unclear to me how to match the award to the 'Cannes film festival' in the first query since the award field is only 10 characters meaning it is a reference to the awtypes table but I don't know which field in the awtypes table contains the name of the award and I don't have access to the database at the moment so it's either org or colloquial.</p>\n\n<p>As for the second I don't know how I could compute the percentage but it seems that it should be solved using a union operator for the movies produced between 1970 and 1990 and the films that have won an award (I don't know how to place a condition for having at least one award). </p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13288375,"title":"How to get value from sql of newly increment id PHP","body":"<p>I will first show you the code, it's easier to discuss this way.</p>\n\n<pre><code> $message = $_GET['r'];\n    $message = str_replace(\"%20\", \" \", $message);\n    echo $message;\n\n    mysql_query(\"INSERT INTO `uniform` (`note`,`cadetID) \n    VALUES ('$message','$cadet')\");\n\n    $query = mysql_query(\"SELECT `uniformID` FROM `cadets` WHERE id = '$cadet'\");\n    while ($row = mysql_fetch_array($query)) {\n      $uniformA = $row['uniformID'];\n    }\n\n    if($uniformA == \"0\"){\n      mysql_query(\"UPDATE `cadets` SET `uniformID` = '\" .  .\"'\n      WHERE id = '$cadet'\");\n    }\n</code></pre>\n\n<p>Don't worry about sanatisation for now.</p>\n\n<p>I got to the line: </p>\n\n<pre><code>mysql_query(\"UPDATE `cadets` SET `uniformID` = '\" .  .\"' WHERE id = '$cadet'\");\n</code></pre>\n\n<p>and  realised I need the ID of the sql insert</p>\n\n<pre><code>mysql_query(\"INSERT INTO `uniform` (`note`,`cadetID) VALUES ('$message','$cadet')\");\n</code></pre>\n\n<p>Is there an efficient way of getting the newly incremented ID from the database? Table structure as follows:</p>\n\n<p><code>cadet(id[primary key, auto increment],...,uniformID)</code></p>\n\n<p><code>uniform(id[prim key, auto inc], note, cadetID)</code></p>\n\n<p>Data:</p>\n\n<p><code>Cadet: 1,...,[1,2,3]</code> &lt;- all in the [] are in cadetID, array delimited by ','</p>\n\n<p><code>Uniform: 1, need a new blahh blahh, 1</code></p>\n\n<p><code>Uniform: 2, new shoes needed, 1</code></p>\n\n<p>And so forth.</p>\n\n<p>So, in E-R speak, one cadet can have many uniform ID's.</p>\n\n<p><strong>TL;DR</strong> I need to store the new ID in the database (auto incremented by SQL db) on a <code>insert into</code></p>\n"},{"tags":["java","sql","oracle","java-ee","ansi"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":27,"score":-1,"question_id":13287890,"title":"Java code equivalent to oracle feature START WITH....CONNECT BY","body":"<p>I am working on a project which uses oracle database. I needed to make a hierarchial tree structure from a self-referencing table similar to the well known 'employee' sample table in the database,which has a relation between manager and emp code. But now i need to do the same using proper sql specification not specific to any particular database. Need to know how to write a java code doing the same thing from the data received after querying from the database just the columns from the table</p>\n"},{"tags":["c#","sql","wpf","listview","datatable"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13288467,"title":"Update listView bound to dataSet dataTable which looks up data from SQL c# wpf","body":"<p>I have a bit of an odd problem when trying to update a listView which is bouund to a dataSet.</p>\n\n<p>The dataSet gets its information from SQL and needs to auto update every 5 mins. At the moment I am using a backgroudWorker to get the new info and insert it into the dataSet.</p>\n\n<p>Then on the RunWorkerCompleted Event I do this</p>\n\n<pre><code>listView1.DataContex = dataSet.Tables[\"table\"].DefaultView\n</code></pre>\n\n<p>The DoWork Event contains something like this </p>\n\n<pre><code>dataSet.Clear();\n\nSqlDataAdapter adapter = new SqlDataAdapter(\n                \"SELECT [ContainerID] ,[UserID], [Spur], [Wave] ,[Date] FROM [ScannedItems] \" + \n                \"WHERE [Message] LIKE '%Success%'\" + \n                \"UNION ALL \" +\n                \"SELECT [ContainerID] ,[UserID], [Spur], [Wave] ,[Date] FROM [Workstation].[dbo].[AllSpurs] \" +\n                \"WHERE [Message] LIKE '%\" + \"Success\" + \"' ORDER BY [Date] DESC\", connection);\n\n\n            DataTableMapping mapping = adapter.TableMappings.Add(\"Table\", \"Packages Scanned\");\n            mapping.ColumnMappings.Add(\"ContainerID\", \"Cont\");\n            mapping.ColumnMappings.Add(\"UserID\", \"User\");\n            mapping.ColumnMappings.Add(\"Spur\", \"Spur\");\n            mapping.ColumnMappings.Add(\"Wave\", \"Wave\");\n            mapping.ColumnMappings.Add(\"Date\", \"Date\");\n\n            connection.Open();\n\n            adapter.FillSchema(dataSet, SchemaType.Mapped);\n            adapter.Fill(dataSet);\n\n            connection.Close();\n</code></pre>\n\n<p>This works when I call worker.RunWorkerAsync(); at startup.</p>\n\n<p>However when the timer calls it the tables go blank (all data removed). And if I try and scroll in the listVIew I get an error</p>\n\n<pre><code>Object reference not set to the instance of an object\n</code></pre>\n\n<p>However if I click the header of one of the columns the new data becomes visible and scrolling works.</p>\n\n<p>Could anyone let me know what I'm doing wrong.</p>\n\n<p>This is the XAML for the listView</p>\n\n<pre><code>&lt;ListView ItemContainerStyle=\"{StaticResource cnListView}\" ItemsSource=\"{Binding Path=Table}\" Margin=\"7,5,31,7\" Name=\"listView2\" SelectionMode=\"Multiple\" util:GridViewSort.AutoSort=\"True\" LostFocus=\"LostFocus\"&gt;\n                    &lt;ListView.View&gt;\n                        &lt;GridView x:Name=\"gridView1\" AllowsColumnReorder=\"False\" ColumnHeaderTemplate=\"{StaticResource cnDataViewHeader}\"&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Cont}\" util:GridViewSort.PropertyName=\"Cont\" Header=\"ContainerID\" Width=\"350\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=User}\" util:GridViewSort.PropertyName=\"User\" Header=\"User\" Width=\"200\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Spur}\" util:GridViewSort.PropertyName=\"Spur\" Header=\"Spur\" Width=\"120\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Wave, StringFormat='dd-MM-yyyy HH:mm:ss'}\" util:GridViewSort.PropertyName=\"Wave\" Header=\"Wave\" Width=\"250\" /&gt;\n                            &lt;GridViewColumn DisplayMemberBinding=\"{Binding Path=Date, StringFormat='dd-MM-yyyy HH:mm:ss'}\" util:GridViewSort.PropertyName=\"Date\" Header=\"Time Scanned\" Width=\"250\" /&gt;\n                        &lt;/GridView&gt;\n                    &lt;/ListView.View&gt;\n                &lt;/ListView&gt;\n</code></pre>\n\n<p>Thank You so much</p>\n"},{"tags":["sql","oracle","to-date","to-char"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13288169,"title":"How can I convert a complex sysdate + something else with a to_date function?","body":"<p>Bit stuck here. Say I run the following SQL query:</p>\n\n<pre><code>select to_char(sysdate, 'DD/MON/YY') || ' 15:32:00' from dual;\n</code></pre>\n\n<p>The result gives me this:</p>\n\n<pre><code>08/NOV/12 15:32:00\n</code></pre>\n\n<p>Now I want to take that result and use it in a to_date function (long story as to why, but I'll go into detail in a sec):</p>\n\n<pre><code>select to_date((to_char(sysdate, 'DD/MON/YY') || ' 15:32:00'), 'DD/MON/YY HH24:MI:SS') from dual;\n</code></pre>\n\n<p>I was expecting the result to be the same as the previous one, except it isn't. Instead it gives me this:</p>\n\n<pre><code>08/NOV/12\n</code></pre>\n\n<p>Question is this: Is there a way I can use a concatenation of a to_char(sysdate, 'DD/MON/YY') and any combo of HH24:MI:SS in a to_date?</p>\n\n<p>Additional detail that may or may not be of any additional use:\nReason I need to do this is because I was provided a query that has a table with an SLA time. The format is just a time in HH24:MI, however it's not a DATETIME type (I suspect it's a VARCHAR, but can't tell for sure as it's likely a view or function of some sort that I cannot dissect. Partially due to me not knowing how to and partially to me not having the necessary access due to my DB user.</p>\n\n<p>EDIT: On reading the above again I realized I left out some additional detail (though this does not relate to my question at all I think):\nI want to take today's date (DD/MON/YY), combine that with the SLA time of HH:MI, combine that with ':00' for :SS, convert the whole thing to a date, then do a comparison between the resultant abomination and the finish time for each row returned. If the finish time is bigger/ newer/ later than my combination-and-conversion-deluxe, then return something specific, in not, return something like \"All OK\". Not sure if that makes sense or not, but in summary, I want to get something that I can use to compare to another DATETIME type, so I think I need to somehow get the SLA time converted to a DATETIME type as well.</p>\n\n<p>Any help on this will be greatly appreciated.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13288180,"title":"query update or insert","body":"<p>hello I would like to update or insert an application but it shows me error. knowing that if I remove the update or query works</p>\n\n<pre><code>UPDATE OR INSERT  INTO stat_alert(`DAT`,`provider`,`CI`,`cell`,`BSC`,`cmts`,`nbr`,`TYPE`)\n     SELECT CC.DAT,CC.provider,CC.CI,CC.cell,CC.BSC,CC.cmts, CONCAT(CC.C,'C, ',MM.M ,'M') AS nbr,'C' AS TYPE  FROM \n     (SELECT DAT,provider,CI,cell,BSC,cmts,COUNT(*) AS C FROM alertes_bss2 WHERE Criticity = 'C' GROUP BY cell,Criticity ) AS CC,\n     (SELECT DAT,provider,CI,cell,BSC,cmts,COUNT(*) AS M FROM alertes_bss2 WHERE Criticity = 'M' GROUP BY cell,Criticity) AS MM WHERE MM.cell = CC.cell\n      UNION SELECT DAT,provider,CI,cell,BSC,cmts, CONCAT(COUNT(*) ,'C') AS nbr,'C' AS TYPE FROM alertes_bss2 WHERE Criticity = 'C' AND cell NOT IN\n       (SELECT cell FROM alertes_bss2 WHERE Criticity = 'M') GROUP BY DAT,provider,CI,cell,BSC,Criticity \n      UNION SELECT DAT,provider,CI,cell,BSC,cmts, CONCAT(COUNT(*) ,'M') AS nbr,'M' AS TYPE FROM alertes_bss2 WHERE Criticity = 'M' AND cell NOT IN \n      (SELECT cell FROM alertes_bss2 WHERE Criticity = 'C') GROUP BY DAT,provider,CI,cell,BSC,Criticity;\n</code></pre>\n\n<p>I have this error :</p>\n\n<pre><code>Query: UPDATE OR INSERT INTO stat_alert(`DAT`,`provider`,`CI`,`cell`,`BSC`,`cmts`,`nbr`,`TYPE`) SELECT CC.DAT,CC.provider,CC.CI,CC.cell...\n\nError Code: 1064\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'OR INSERT  INTO stat_alert(`DAT`,`provider`,`CI`,`cell`,`BSC`,`cmts`,`nbr`,`TYPE' at line 1\n\nExecution Time : 0 sec\nTransfer Time  : 0 sec\nTotal Time     : 0.003 sec\n---------------------------------------------------\n</code></pre>\n\n<p>who can help me  </p>\n"},{"tags":["php","sql","forms","post","insert"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13288330,"title":"Form: Insert multivalue answers ( one answer per row)","body":"<p>In this form I can build and show questions and answers (that are values inside of a tables in my data base) without problems. But now how can i insert answers selected?. Because i need insert one answer per row and answers would be multivalue on one question.</p>\n\n<p>The table where i want insert has this structure : Tbluseranswer<code>(</code>UserIDFKPK<code>,</code>AnswerIDFKPK<code>,</code>QuestionIDFK<code>,</code>AnswerValue`)</p>\n\n<pre><code> &lt;?php\n    $query_questionset= \"SELECT Constructor, QuestionIDFKPK, OnPage, QuestionValue, tblquestionset.SortOrder\n    FROM tblquestion, tblquestionset, tbluser\n    WHERE tbluser.QuestionSetIDPK = tblquestionset.QuestionSetIDPK\n    AND tblquestionset.QuestionIDFKPK = tblquestion.QuestionIDPK\n    AND tbluser.UserIDPK = \".@$UserId.\"\n    AND tblquestionset.OnPage= '\".@$Screen.\"'\n    ORDER BY tblquestionset.SortOrder\";\n\n    $QuestionSet_Constructors = mysql_query($query_questionset);\n\n\nif(isset($_POST['submit'])){\n\n//Inserts here\n\n}\n\n?&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;!--BUILDING QUESTIONARE --&gt;\n\n    &lt;?php  while( $row_questionset=mysql_fetch_array($QuestionSet_Constructors)){?&gt; \n\n            &lt;?php $QuestionID=$row_questionset['QuestionIDFKPK'];   \n\n\n                    $query_Answer=\"SELECT * FROM tblanswer WHERE tblanswer.QuestionIDFK = '\".@$QuestionID.\"'\";\n                    $AnswersValue= mysql_query($query_Answer);\n\n            ?&gt;\n        &lt;?php if($row_questionset['Constructor']==\"CheckBox\"){?&gt;\n\n\n                &lt;!--SPACE--&gt;\n                &lt;div&gt;\n                &lt;label class=\"desc\" &gt;\n                &lt;/label&gt;\n                &lt;/div&gt;\n                &lt;!--/SPACE--&gt;\n\n                        &lt;!--CHECK BOX--&gt;    \n\n                        &lt;div&gt;\n                        &lt;label class=\"desc\" name=\"question\" value= \"&lt;?php $row_questionset['QuestionIDFKPK'];?&gt;\" &gt;\n                        &lt;?php echo $row_questionset['QuestionValue']; ?&gt;\n\n                        &lt;/label&gt;\n                        &lt;/div&gt;\n\n                            &lt;!--SPACE--&gt;\n                            &lt;div&gt;\n                            &lt;label class=\"desc\" &gt;\n                            &lt;/label&gt;\n                            &lt;/div&gt;\n                            &lt;!--/SPACE--&gt;\n\n                                &lt;fieldset class=\"checkboxes\"&gt;\n                                &lt;?php while ($row_Answer=mysql_fetch_array($AnswersValue)){ ?&gt;  \n                                    &lt;label class=\"label_check\" &gt;\n                                    &lt;input name=\"samplecheckbox\"  value=\"&lt;?= $row_Answer['AnswerValue']; ?&gt;\" type=\"checkbox\" /&gt;\n\n\n\n\n                                    &lt;?php echo $row_Answer['AnswerValue']; ?&gt;   \n                                    &lt;/label&gt;    \n\n\n                                &lt;?php }  ?&gt; \n                                &lt;/fieldset&gt;\n\n                        &lt;!--/CHECK BOX--&gt;   \n\n    &lt;!--RADIO BUTTON--&gt; \n\n                        &lt;div&gt;\n                            &lt;label class=\"desc\"name=\"question\" value=\" &lt;?php $row_questionset['QuestionIDFKPK'];?&gt;\"&gt;\n                            &lt;?php echo $row_questionset['QuestionValue']; ?&gt;\n\n                            &lt;/label&gt;\n                        &lt;/div&gt;\n                            &lt;?php while ($row_Answer=mysql_fetch_array($AnswersValue)){ ?&gt;  \n                            &lt;fieldset class=\"radios\"&gt;\n\n                                &lt;label class=\"label_radio\"&gt;\n                                &lt;input name=\"sample-radio\"  value=\" &lt;?= $row_Answer['AnswerValue']; ?&gt;\" type=\"radio\" checked /&gt;\n                                &lt;?php echo $row_Answer['AnswerValue']; ?&gt; \n                                &lt;/label&gt;\n                                &lt;?php   \n\n                                &lt;?php $AnswerId=$row_Answer['AnswerIDPK'];  ?&gt;\n                                &lt;?php \n                            &lt;?php }  ?&gt;\n                            &lt;/fieldset&gt;\n\n                    &lt;!--RADIO BUTTON--&gt; \n\n        &lt;?php } ?&gt;\n\n    &lt;?php } ?&gt;\n\n    &lt;!--BUILDING QUESTIONARE --&gt;    \n\n\n\n\n&lt;input  name=\"submit\" type=\"submit\"  value=\"Next &amp;#8594\"  &gt;\n\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["mysql","sql","date"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13287827,"title":"sum of debit on the base of month in sql","body":"<p>I have a table name receipt the scema is as follow <br/></p>\n\n<pre><code>account_no  date        transaction_type  amount\n   s1       2012-7-7    opening           500\n   s1       2012-8-13   deposit           1000\n   s1       2012-7-17   deposit           400\n</code></pre>\n\n<p>Now I have the following query </p>\n\n<pre><code>select  month(r.date),\n  sum(case when (month(r.date))='7' and r.transaction_type='opening' and r.transaction_type='deposit' then r.amount else '' end )as debit \nfrom receipt r \nwhere r.account_no='s1'\n</code></pre>\n\n<p>But it is giving me output as:</p>\n\n<pre><code>month  debit \n7      0\n</code></pre>\n\n<p>can any one tell me why it is giving me this output ?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>if i want to place the name of month instead of number then how to do that</p>\n"},{"tags":["sql","join","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13288050,"title":"Sum of multiple tables in SQL","body":"<p>I think what I want to do is fairly straightforward but the data I get back varies greatly. </p>\n\n<pre><code>select sum(cast(vi.qty - vi.unredeemed as bigint))\n  from red.dbo.setup vc\n  full join red.dbo.test bt\n    on bt.batch_no = vc.batch_no\n  join red.dbo.live vi\n where vi.date_issued between '2012-01-01' and '2012-01-01' \n   and vc.denom ='1' \n   and substring(vi.issue_id,3,1) = '4'\n</code></pre>\n\n<p>What I am trying to do is join 3 tables together then sum of <code>qty</code> of the results of the join and then minus the unredeemed so as to give a redeemed total in one row.</p>\n\n<p>I have tried various amendments to my sum field but the numbers back seem huge so I think it is multiplying them.</p>\n\n<p>I haven't used joins for a while and I am a bit rusty.</p>\n"},{"tags":["sql","sql-server-2008","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":9482640,"title":"SQL Server - stored procedure","body":"<p>I am trying to create a stored procedure in SQL Server 2008. According to the parser, the syntax is OK. However, when I try to execute the stored procedure and pass actual values, the following error comes up:</p>\n\n<blockquote>\n  <p>Msg 201, Level 16, State 4, Procedure\n  SaveOneTimeDonation, Line 0<br>\n  Procedure or function 'SaveOneTimeDonation' expects parameter '@donation', which was not\n  supplied.</p>\n</blockquote>\n\n<p>Strange enough, the data is actually inserted into the table so I don't know why it is displaying this error.</p>\n\n<p>How can I solve this problem please?  Here is the code:</p>\n\n<pre><code>SET ANSI_NULLS ON\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER PROC [dbo].[SaveOneTimeDonation]\n  @donation float,\n  @date nvarchar\nAS\n   INSERT INTO OneTime_Trans(Donation, Trans_Date) VALUES (@donation, @date)\n\n   exec SaveOneTimeDonation\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":91,"score":1,"question_id":13250635,"title":"how i can get these with mysql?","body":"<p>I am new to mysql.</p>\n\n<p>I have on survey with clicks, period(date). Now i have to find out number of clicks per month, like:</p>\n\n<pre><code>MON  CLICKS\nnov  0 \noct  34 \nsep  67 \naug  89\n</code></pre>\n\n<p>I have used code like this:</p>\n\n<pre><code>select MONTHNAME(period) mon,  IFNULL(count(id),0) as Clicks\nfrom survey\nwhere period &gt; DATE_SUB(now(), INTERVAL 3 MONTH)\ngroup by EXTRACT(MONTH FROM period)\n</code></pre>\n\n<p>It is not working for with no records.</p>\n\n<p>Here one thing I suppose there is no record in that month it should show 0: if there is no record in <code>nov</code> the number of clicks should be <code>0</code>.</p>\n\n<pre><code>my table structure was like this \nCREATE TABLE `survey` (\n  `id` int(2) NOT NULL auto_increment,\n   `period` datetime default NULL)\n</code></pre>\n\n<p>for last four weeks i have used </p>\n\n<pre><code> SELECT uq.timespan, COALESCE(tsq.TotalClicks, 0) as Clicks FROM (\nSELECT '22-28 days' as timespan\nunion SELECT '15-21 days'\nunion SELECT '8-14 days'\nunion SELECT 'up to 7 days'\n\n)uq LEFT JOIN (\nSELECT CASE \n    WHEN submitdate &gt;= NOW() - INTERVAL 4 WEEK\n                AND submitdate &lt; NOW() - INTERVAL 3 WEEK THEN '22-28 days'\n    WHEN submitdate &gt;= NOW() - INTERVAL 3 WEEK\n           AND submitdate &lt; NOW() - INTERVAL 2 WEEK THEN '15-21 days'\nWHEN submitdate &gt;= NOW() - INTERVAL 2 WEEK\n    AND submitdate &lt; NOW() - INTERVAL 1 WEEK THEN '8-14 days'\nWHEN submitdate &gt;= NOW() - INTERVAL 1 WEEK THEN 'up to 7 days'\n       END Weeksubmitdate, \n           count(id) TotalClicks\nFROM  survey \nWHERE submitdate &gt;= NOW() - INTERVAL 4 WEEK\nGROUP BY Weeksubmitdate\n)tsq ON uq.timespan = tsq.Weeksubmitdate\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":["php","sql","rowspan"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13285861,"title":"Php - rowspan shows all records from database at the same row","body":"<p>i've a problem with rowspan , it prints out all the data from the database into one row!\neven though the one with different id! \nthe output should be Course name and all student that are taken that course , put my code take only the first course name in the database and print it out with all student names in the database!</p>\n\n<p>my code is </p>\n\n<pre><code>                      &lt;h2&gt; List of course Name with students names&lt;/h2&gt;\n\n&lt;?php\n\n\n        include('../connect.php');\n        $id=$_SESSION['login_user'];\n\n\n        $sql = \"SELECT C.CourseName ,GROUP_CONCAT(s.Studntname) AS Studntname\n                FROM course AS c\n                INNER JOIN student AS s\n                ON s.CourseID = c.CourseID\"; \n\n        $result = mysql_query ($sql, $connection); \n\n\n          echo \"&lt;center&gt;\";\n\n        echo \"&lt;table&gt;\";\n        echo \"&lt;tr&gt; &lt;th&gt;Course Name&lt;/th&gt; &lt;th&gt; Student Name&lt;/th&gt;  &lt;/tr&gt;\";\n\n        // loop through results of database query, displaying them in the table\n        while($row = mysql_fetch_array( $result )) {\n                // echo out the contents of each row into a table\n               echo \"&lt;tr&gt;\";\n\n                echo '&lt;td&gt;' . $row['CourseName'] . '&lt;/td&gt;';\n                echo \"&lt;td rowspan='' &gt;\" .$row['Studentname'] . \"&lt;/td&gt;\";\n\n\n                echo \"&lt;/tr&gt;\";\n\n\n        }\n        echo \"&lt;/table&gt;\"; \n         echo \"&lt;/center&gt;\";\n\n\n\n?&gt;\n</code></pre>\n\n<p>My two tables are:  </p>\n\n<p><strong>Course</strong></p>\n\n<pre><code>CourseName var(30)\nCourseID   int(7)\n</code></pre>\n\n<p><strong>Student</strong></p>\n\n<pre><code>Studentname var(30)\nStudentID   int(7) \nCourseID    int(7)  \n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":7,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":24373,"score":2,"question_id":1781946,"title":"Getting only Month and Year from SQL DATE","body":"<p>I need to access only Month.Year from Date field in SQL Server.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13286621,"title":"Does ROLLBACK TRANSACTION imply a commit if not rolled-back","body":"<p>My <code>SQL-Server</code> learning curve has been back-to-front and after several yrs I'm battling to use <code>TRANSACTION</code> code effectively. </p>\n\n<p>If <code>COMMIT TRANSACTION</code> is not explicitly stated then at the point of <code>ROLLBACK TRANSACTION</code> if no errors have occurred in preceding code will the transaction then be committed? The question is in connection with a structure like the following:</p>\n\n<pre><code>USE MyDataBase;\nGO\n     BEGIN TRANSACTION;\n        --complex query X here  \n     ROLLBACK TRANSACTION; PRINT N'Rolled back the transaction.';\nGO\n</code></pre>\n\n<p>...I thought <code>ROLLBACK TRANSACTION</code> was used in a situation where you do not want changes to be made to a db if an error has occured in the <em>preceding</em> script - in the above this would be <code>X</code>. If i wanted to explicitly state <code>COMMIT TRANSACTION</code> in the above then where should it be located?</p>\n\n<p>To confuse myself even more I've got the following - why is it rolling back twice? Is an error occuring to create the <code>ROLLBACK</code>?</p>\n\n<pre><code>USE WHAnalysis;\nGO\n    BEGIN TRANSACTION;\n\n        IF @@TRANCOUNT = 1\n            SELECT @@TRANCOUNT\n            --do a complex query here\n\n    ROLLBACK TRANSACTION; PRINT N'Rolled back the transaction.';\nGO\n</code></pre>\n"},{"tags":["sql","avg"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13287199,"title":"SQL AVG() function returning incorrect values","body":"<p>I want to use the AVG function in sql to return a working average for some values (ie based on the last week not an overall average).  I have two values I am calculating, <em>weight</em> and <em>restingHR</em> (heart rate).  I have the following sql statements for each:</p>\n\n<pre><code>SELECT AVG( weight ) AS average \nFROM   stats \nWHERE  userid='$userid' \nORDER BY date DESC LIMIT 7\n\nSELECT AVG( restingHR ) AS average \nFROM   stats \nWHERE  userid='$userid' \nORDER BY date DESC LIMIT 7\n</code></pre>\n\n<p>The value I get for <em>weight</em> is <strong>82.56</strong> but it should be <strong>83.35</strong>\nThis is not a massive error and I'm rounding it when I use it so its not too big a deal.</p>\n\n<p>However for <em>restingHR</em> I get <strong>45.96</strong> when it should be <strong>57.57</strong> which is a massive difference.</p>\n\n<p>I don't understand why this is going so wrong.  Any help is much appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13286714,"title":"Check SQL reference constraint on INSERT but not on DELETE","body":"<p>I have a Logs table in my database where I'm storing records of user actions. There's a column for UserID, which is foreign-keyed to the Users table to check that the UserID exists when a log is added. However, attempting to delete a user causes a constraint failure because it leaves a UserID in the Logs table that no longer exists in the Users table. Deleting the offending rows from Logs isn't an option, because the whole point is to have persistent records (so that we can find out who broke what, basically) so deleting all actions by that user rather defeats the purpose.</p>\n\n<p>Is there a simple way to have it check the constraint when inserting new logs (to make sure the user exists at the time) but not when deleting a user? I'm accessing the DB via LINQ, so my queries are in C#, not SQL, so anything that requires that is out, but I have access to the database through MS SQL Server Management Studio, so I can do what I like with it.</p>\n\n<p>EDIT for slight clarification: the value of knowing who made an action is not just in accountability; it's useful in determining if an issue is user-specific, organisation-specific, or system-wide, which can greatly narrow down the list of possible causes. Once a user is deleted, it's still worth keeping their actions, and it's still useful to know which actions were by that user, for various reasons - for example, when tracking down an issue caused by one user doing a certain combination of things (eg. two actions that are fine separately but cause errors when one immediately follows another).</p>\n"},{"tags":["sql","oracle","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13287102,"title":"Transformation of row and column of a database table","body":"<p>I have database table. As I further saw that the data was in a particular format. How to perform the following transformation without creating temporary table directly using query?col2 is not static field X and Y it is dynamically determined i.e no of columns is dynamic.\n<img src=\"http://i.stack.imgur.com/M05Lj.png\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","activerecord","yii"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13286619,"title":"Yii SQL query from CDbCriteria","body":"<p>I have a model with complex relations which uses CDbCriteria for filtering data to be viewed in CGridView.\nI need to be able to export the filtered results also as a CSV file. \nFor that, using ActiveRecords is too resource consuming (20000+ records), so it would be a lot faster to use CDbCommand to get the same results and export them.</p>\n\n<p>The problem is, I cannot find a way to get the raw sql query that ActiveRecords builds from CDbCriteria. \nDoes anyone know a way to do it?</p>\n"},{"tags":["sql","sql-server-2008","sql-agent"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1519,"score":0,"question_id":5748526,"title":"SQL Agent -- Mail Error 5.7.1 Client does not have permissions to send as this sender","body":"<p>So I have recently configured an entire lab environment with the following servers:</p>\n\n<p>Domain: mytekkilab.com</p>\n\n<p>Server 1: DC-08-01\nServer 2: SQL-03-01\nServer 3: MAIL-08-01\nServer 4: TS-08-01\nServer 5: WS-08-01</p>\n\n<p>My terminal server (TS-08-01) has Microsoft Office installed with outlook configured on user sqlagent@mytekkilab.com. Sends and receives e-mail fine from the exchange server (2007 SP3 -- MAIL-08-01). The problem lies within the SQL Agent Database Mail. When configuring the profile and the account using sqlagent. I try to send a test e-mail and get the following line wihtin my mail log of the sql server:</p>\n\n<blockquote>\n  <p>04/21/2011 11:22:05,,Error,23,The mail\n  could not be sent to the recipients\n  because of the mail server failure.\n  (Sending Mail using Account 2\n  (2011-04-21T11:22:05). Exception\n  Message: Cannot send mails to mail\n  server. (Mailbox unavailable. The\n  server response was: 5.7.1 Client does\n  not have permissions to send as this\n  sender). ),256,10,,4/21/2011 11:22:05\n  AM,sa</p>\n</blockquote>\n\n<p>I have been researching for the last 2.5 hours and cannot seem to find a solution to this issue. If you can please let me know when you think. Again smtp works for this user everywhere. OWA, Outlook, command smtp etc...</p>\n\n<p>Thanks for your help in advance!\n-Mike D</p>\n"},{"tags":["sql","mysql","sql-server","oracle"],"answer_count":5,"favorite_count":7,"up_vote_count":16,"down_vote_count":0,"view_count":2644,"score":16,"question_id":697671,"title":"Stored Procedure with optional \"WHERE\" parameters","body":"<p>I have a form where users can specify various parameters to dig some data (status, date ecc).</p>\n\n<p>I can producea query that is:\nSELECT * FROM table WHERE:\nstatus_id = 3\ndate = \nother_parameter = </p>\n\n<p>etc. Each WHERE is optional (i can select all the rows with status =3, or all the rows with date = 10/10/1980, or all the rows with status = 3 AND date = 10/10/1980 ecc.</p>\n\n<p>Given a large number of parameters, all optional, what is the best way to make up a dynamic stored procedure?</p>\n\n<p>I'm working on various DB:\nMySQL, Oracle and SQLServer.</p>\n"},{"tags":["java","sql","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13286477,"title":"java API to run sql script","body":"<p>What java API's are available to run a sql script. How do i get certain data read in the script -like count of processes accessing the database in the below script.</p>\n\n<pre><code>DECLARE @DatabaseName nvarchar(50)\nDECLARE @SPId int\nDECLARE @SQL nvarchar(100)\n\n SET @DatabaseName = N&lt;dbname&gt;\n\nDECLARE my_cursor CURSOR FAST_FORWARD FOR\nSELECT SPId FROM MASTER..SysProcesses\nWHERE DBId = DB_ID(@DatabaseName) AND SPId &lt;&gt; @@SPId\n\nOPEN my_cursor\n\nFETCH NEXT FROM my_cursor INTO @SPId\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n SET @SQL = 'KILL ' + CAST(@SPId as nvarchar(10))\n print @SQL\nEXEC sp_executeSQL @SQL\n\n\n FETCH NEXT FROM my_cursor INTO @SPId\nEND\n\nCLOSE my_cursor\nDEALLOCATE my_cursor \n\nGO\n\nDROP DATABASE &lt;dbname&gt;\nGO \n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":45,"score":2,"question_id":13276922,"title":"moving an entry form the end of table to the top","body":"<p>I am using mySql  and I have a record with is in end of the table.  I want to bring it to the top of the table. How can move it? I mean there are entries at top of the table, how can i replace ids of both the entries with each other.</p>\n\n<p>I want to do this because i want to move the last item to the start of the list, so that it appears first on my website.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","sql-server","query","select"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":42,"score":0,"question_id":13286661,"title":"what does a select statement returns if condition doesn't match?","body":"<p>For example if I have following statement</p>\n\n<pre><code>declare @uid int;\nset @uid = (select id from tablename where condition)\n</code></pre>\n\n<p>In this case if condition doesn't match then what it will return to <code>@uid</code>.</p>\n"},{"tags":["sql","sql-server","oracle","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":38,"score":-6,"question_id":13286424,"title":"difference between oracle sql and sql server?","body":"<p>I  want to know the difference between Oracle SQL, PL/SQL and SQL Server's T-SQL. </p>\n\n<p>Right now I'm using SQL Server (Management Studio) and I'm accessing data using SQ. </p>\n\n<p>Is Oracle's SQL different from the SQL that is used by SQL Server? </p>\n\n<p>Also what is PL/SQL, is it different from Oracle SQL?</p>\n"},{"tags":["sql","database","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":342,"score":-1,"question_id":5796256,"title":"Select and Project Operations SQL","body":"<pre><code>Salesperson(SSN, Name, StartYear, DeptNo) \nTrip(SSN, FromCity, ToCity, DepartureDate, ReturnDate, TripId) \nExpense(TripId, Account, Amount)\n</code></pre>\n\n<ol>\n<li>Give all details (all attributes of trip relation) for trips that exceeded $2,000 in expenses.</li>\n<li>Print the SSNs of sales people who took trips to Honolulu.</li>\n<li>Print the total trip expenses incurred by the salesperson with SSN = ‘234-56-7890’</li>\n</ol>\n\n<p>I cannot figure out how to do these there.. Thanks in advance</p>\n"},{"tags":["sql","magento","coupon"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13268938,"title":"Magento - Single Coupon marqued as used when payment pending","body":"<p>I've got a problem with magento single coupon code that is marked as having been used at the time the customer click on the ‘Place Order’ button. If the Paypal payment fails or the client abandon, he won't able to go back and re-order with this coupon which is set to be only used once, and has been marqued already been used...</p>\n\n<p>I've found a piece of code that decrease in the database the number of times the coupons is been used by the user and allows him to use the coupon once again. Unfortunately, he gets an error when trying to connect the Paypal page when clicking the place order button. In order to be able to use the coupon another time and acces the Paypal page, I have to delete lines in sql database at salesrule_coupon_usage AND salesrule_customer concerning the customer id ! </p>\n\n<p>Here is the code I need to upgrade to automatically delete coupon usage information for customer id :</p>\n\n<pre><code>public function cancel($observer)\n{\n  $event = $observer-&gt;getEvent();\n  $order = $event-&gt;getPayment()-&gt;getOrder();\n  if ($order-&gt;canCancel()) {\n    if ($code = $order-&gt;getCouponCode()) {\n      $coupon = mage::getModel('salesrule/coupon')-&gt;load($code, 'code');\n      if ($coupon-&gt;getTimesUsed() &gt; 0) {\n        $coupon-&gt;setTimesUsed($coupon-&gt;getTimesUsed()-1);\n        $coupon-&gt;save();\n      }\n\n      $rule = Mage::getModel('salesrule/rule')-&gt;load($coupon-&gt;getRuleId());\n      error_log(\"\\nrule times used=\" . $rule-&gt;getTimesUsed(),3,\"var/log/debug.log\");\n      if ($rule-&gt;getTimesUsed() &gt; 0) {\n        $rule-&gt;setTimesUsed($rule-&gt;getTimesUsed()-1);\n        $rule-&gt;save();\n      }\n      if($customerId = $order-&gt;getCustomerId()) {\n        if ($customerCoupon = Mage::getModel('salesrule/rule_customer')-&gt;loadByCustomerRule($customerId, $rule-&gt;getId())) {\n          $couponUsage = new Varien_Object();\n          Mage::getResourceModel('salesrule/coupon_usage')-&gt;loadByCustomerCoupon($couponUsage, $customerId, $coupon-&gt;getId());\n\n          if ($couponUsage-&gt;getTimesUsed() &gt; 0) {\n\n            /* I can't find any #@$!@$ interface to do anything but increment a coupon_usage record */\n            $resource = Mage::getSingleton('core/resource');\n            $writeConnection = $resource-&gt;getConnection('core_write');\n            $tableName = $resource-&gt;getTableName('salesrule_coupon_usage');\n\n            $query = \"UPDATE {$tableName} SET times_used = times_used-1 \" .\n              \" WHERE coupon_id = {$coupon-&gt;getId()} AND customer_id = {$customerId} AND times_used &gt; 0\";\n\n            $writeConnection-&gt;query($query);\n          }\n          if ($customerCoupon-&gt;getTimesUsed() &gt; 0) {\n            $customerCoupon-&gt;setTimesUsed($customerCoupon-&gt;getTimesUsed()-1);\n            $customerCoupon-&gt;save();\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n"},{"tags":["java","sql","oracle","hql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13247774,"title":"stuck with the sql / hql query group by","body":"<pre><code>id          device_id   config_status   update_finished\n1           5015001     SUCCESS     11-OCT-2012\n2           5015001     SUCCESS     23-OCT-2012\n3           5015001     PENDING     23-OCT-2012\n4           5015001     PENDING     23-OCT-2012\n5           5016222     PENDING     12-OCT-2012\n6           5016222     PENDING     22-OCT-2012\n</code></pre>\n\n<p>Hi, above is my table with some example data. What I'd like to achieve is to get for each device_id last SUCCESS status (date is in update_finished field) and all PENDING statuses. From the example above the result query should have:</p>\n\n<pre><code>id          device_id   config_status   update_finished\n2           5015001     SUCCESS     23-OCT-2012\n3           5015001     PENDING     23-OCT-2012\n4           5015001     PENDING     23-OCT-2012\n5           5016222     PENDING     12-OCT-2012\n6           5016222     PENDING     22-OCT-2012\n</code></pre>\n\n<p>So that means only the last SUCCESS status by date column update_finished and all PENDING statuses for each device_id.</p>\n\n<p>Currently I'm trying to mess with GROUP BY: <code>SELECT device_id, config_status, max(update_finished) AS \"LastUpdate\"\nfrom config_status WHERE config_status = 'SUCCESS' group by device_id, config_status</code></p>\n\n<p>This returns only the last SUCCESS statuses for each device_id indeed, but it misses the PENDING statuses and it doesn't have <code>id</code> column. If I add <code>id</code> field to the GROUP BY then the grouping would be by <code>id</code> anyway.</p>\n\n<p>Could anyone help me with the proper query? Is it supposed to have subqueries also? In the end I need to have it as HQL, but I think it will be very similar to SQL.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks everybody for helping me out. All these queries work but most fitted my the query provided by @Remigio because it was easiest to transform it into HQL query that returns me parametrized object, not just Object.</p>\n\n<p>Here is my working HQL query with additional fields that I have omitted in my initial example</p>\n\n<pre><code>List&lt;ConfigStatus&gt; statuses = getHibernateTemplate().find(\"select c from ConfigStatus c \" +\n                \"where (configStatus = 'SUCCESS' and updateFinished = (select max(updateFinished) from \" +\n                \"ConfigStatus c1 where c1.device.deviceId = c.device.deviceId and c1.configStatus = 'SUCCESS' and c1.configFile.configFileId = ?)) \" +\n                \"or configStatus = 'PENDING' and configFile.configFileId = ?\", new Object[] {configFileId, configFileId});\n</code></pre>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":23,"score":-3,"question_id":13285816,"title":"SQL results in Hebrew don't show up properly","body":"<p>I wrote a stored procedure which returns a table with 2 columns storing Hebrew text. In the output window the columns appear in the opposite order they should appear in.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql","postgresql","subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13285885,"title":"SQL: return comments from other users that occur after my comment on a post I didn't create","body":"<p>Sorry for the ridiculous question title. I didn't know how to generalize it.</p>\n\n<p>I need a list of comments that occur after my comments left on a post I did not create.</p>\n\n<p>I'm using postgres. My post table structure:</p>\n\n<pre><code>CREATE TABLE posts (\n    id integer NOT NULL,\n    parent_id integer DEFAULT (-1),\n    msg character varying(140),\n    user_id integer,\n    create_dte numeric(10,0) DEFAULT 0\n);\n</code></pre>\n\n<p>There can only be one level of comments. Original posts\nhave a <code>parent_id</code> of -1. Comments have a <code>parent_id</code> of an original post's <code>id</code>.</p>\n\n<p>I can get my comments on posts I didn't create:</p>\n\n<pre><code>select p1.id, p1.msg \nfrom   posts p1 \nwhere  p1.user_id = MY_USER_ID \nand    p1.parent_id in (\n    select p2.id \n    from   posts p2 \n    where  p2.parent_id = -1 \n    and    p2.user_id != MY_USER_ID)\n</code></pre>\n\n<p>Can someone give me a hint on how to select the posts that have the same <code>parent_id</code>\nand a greater <code>create_dte</code>?</p>\n"},{"tags":["mysql","sql","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13285854,"title":"MYSQL : Left outer join sql takes long time","body":"<p>I have this query , take long time when I executed it  </p>\n\n<pre><code>SELECT DISTINCT ticket.`id`, \n                `sender`, \n                `text`, \n                `receivedtime`, \n                `priorityid`, \n                `cityid`, \n                `categoryid`, \n                `statusid`, \n                `activeuserid`, \n                `note`, \n                `operationid`, \n                '' AS SMSHistory, \n                '' AS replySMS, \n                '' AS ticketHistory \nFROM   `ticket` \n       LEFT OUTER JOIN tickethistory \n                    ON tickethistory.ticketid = ticket.id \n       LEFT OUTER JOIN users \n                    ON tickethistory.uid = users.uid \nORDER  BY ticket.`id` DESC \nLIMIT  0, 50 \n</code></pre>\n\n<p>and here is the table structure :</p>\n\n<h2>Ticket:</h2>\n\n<pre><code>CREATE TABLE   `ticket` (\n    `id` int(10) NOT NULL AUTO_INCREMENT,\n    `sender` varchar(50) NOT NULL,\n    `text` text NOT NULL,\n    `receivedTime` datetime NOT NULL,\n    `priorityId` int(10) NOT NULL,\n    `cityId` int(10) NOT NULL,\n    `categoryId` int(10) NOT NULL,\n    `statusId` int(10) NOT NULL,\n    `activeUserId` int(11) NOT NULL,\n    `note` text NOT NULL,\n    `operationId` int(10) NOT NULL,\n    `gateway` varchar(80) NOT NULL,\n    KEY `Index 1` (`id`),\n    KEY `sender` (`sender`),\n    KEY `priorityId` (`priorityId`),\n    KEY `cityId` (`cityId`),\n    KEY `categoryId` (`categoryId`),\n    KEY `statusId` (`statusId`)\n  ) ENGINE=MyISAM DEFAULT CHARSET=utf8;\n\n  ----\n</code></pre>\n\n<h2>Tickethistory :</h2>\n\n<pre><code>  CREATE TABLE   `tickethistory` (\n    `id` int(10) NOT NULL AUTO_INCREMENT,\n    `ticketId` int(10) NOT NULL,\n    `uid` int(11) NOT NULL,\n    `actionId` int(10) NOT NULL,\n    `time` datetime NOT NULL,\n    `param1` text NOT NULL,\n    `param2` text NOT NULL,\n    `param3` text NOT NULL,\n    KEY `Index 1` (`id`),\n    KEY `ticketId` (`ticketId`),\n    KEY `uid` (`uid`)\n  ) ENGINE=MyISAM DEFAULT CHARSET=utf8;\n\n  ---- \n</code></pre>\n\n<p>users :</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `users` (\n  `Uid` int(11) NOT NULL AUTO_INCREMENT,\n  `UserName` varchar(255) NOT NULL,\n  `Upassword` varchar(32) NOT NULL,\n  `UName` text NOT NULL,\n  `Ucountry` text NOT NULL,\n  `Umobile` varchar(255) NOT NULL,\n  `UregisterDate` date NOT NULL DEFAULT '0000-00-00',\n  `Ugroup` char(1) NOT NULL DEFAULT 'U',\n  `Usender` varchar(11) NOT NULL DEFAULT 'SMS',\n  `Ucredits` decimal(11,2) NOT NULL DEFAULT '0.00',\n  `Uemail` varchar(255) NOT NULL,\n  `CreditUpdatedDate` date DEFAULT NULL,\n  `USMSC` varchar(30) NOT NULL,\n  `repeatedDuration` int(10) DEFAULT '0',\n  `langid` varchar(10) DEFAULT 'Ar',\n  `parentId` int(11) NOT NULL DEFAULT '0',\n  `Usess` varchar(255) NOT NULL DEFAULT '0',\n  PRIMARY KEY (`Uid`),\n  UNIQUE KEY `UserName` (`UserName`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8;\n</code></pre>\n\n<hr>\n\n<p>Here is the explain command result:</p>\n\n<pre><code>  'id';'select_type';'table';'type';'possible_keys';'key';'key_len';'ref';'rows';'Extra'\n  '1';'SIMPLE';'ticket';'ALL';'';'';'';'';'348580';'Using temporary; Using filesort'\n  '1';'SIMPLE';'tickethistory';'ref';'ticketId';'ticketId';'4';'ticket.id';'2';'Distinct'\n  '1';'SIMPLE';'users';'eq_ref';'PRIMARY';'PRIMARY';'4';'tickethistory.uid';'1';'Using index; Distinct'\n</code></pre>\n"},{"tags":["sql","sql-server","pivot","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13285264,"title":"need help in writing pivot query to select columns from different select statements","body":"<p>I am using SQL Server 2012, i need help in getting the following output. My table structure is as follows:</p>\n\n<pre><code>declare @TestTable table (MaterialCode char(5), ItemCode char(5), ItemName varchar(50))\n\ninsert into @TestTable values ('AA-01', 'A0001', 'iPhone')\ninsert into @TestTable values ('AA-02', 'A0001', 'iPad')\ninsert into @TestTable values ('AA-03', 'A0001', 'iPod')\n\ninsert into @TestTable values ('AA-01', 'B0001', 'Galaxy Tab')\ninsert into @TestTable values ('AA-02', 'B0001', 'Galaxy Note')\n\ninsert into @TestTable values ('AA-01', 'C0001', 'Nokia Lumnia')\ninsert into @TestTable values ('AA-02', 'C0001', 'Motorola')\ninsert into @TestTable values ('AA-03', 'C0001', 'Samsung S3')\ninsert into @TestTable values ('AA-04', 'C0001', 'Sony')\n\n--select * from @TestTable\n\nselect MaterialCode, ItemCode as [A_ItemCode], ItemName as [A_ItemName] \nfrom @TestTable where ItemCode='A0001'\n\nselect MaterialCode, ItemCode as [B_ItemCode], ItemName as [B_ItemName] \nfrom @TestTable where ItemCode='B0001'\n\nselect MaterialCode, ItemCode as [C_ItemCode], ItemName as [C_ItemName] \nfrom @TestTable where ItemCode='C0001'\n</code></pre>\n\n<p>And the output i need should produced from the above three select statements, which should be as follows:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xpRV8.png\" alt=\"enter image description here\"></p>\n\n<p>As you can see, when there is no record, NULLs are displayed there. Can anyone help me getting this output. TIA.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>@JohnLBevan, I tried your pivot approach and when I have another record which is has ItemCode = D0001</p>\n\n<pre><code>insert into @TestTable values ('AA-05', 'D0001', 'Test1')\n</code></pre>\n\n<p>now even that record is being displayed as</p>\n\n<pre><code>AA-05   NULL    NULL    NULL    NULL    NULL    NULL\n</code></pre>\n\n<p>How to avoid these type of records.</p>\n"},{"tags":["sql","database","oracle","database-design","oracle10g"],"answer_count":5,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":11043,"score":5,"question_id":3980462,"title":"How to compare two tables column by column in oracle","body":"<p>I have two similar tables in oracle in two different databases. \nFor example : my table name is EMPLOYEE and primary key is employee id. The same table with same columns(say 50 columns are is avlbl in two databases and two databases are linked.</p>\n\n<p>I want to compare these two tables column by column and find out which records are not matching. i want the specific column in each row in two tables that are not matching.</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13281784,"title":"Rails ActiveRecord query using inner join","body":"<p>I have two tables that I'm attempting to do an inner join with.</p>\n\n<p>One is a <code>users</code> table where the primary key is <code>id</code>. </p>\n\n<p>Another table is <code>bars</code> where <code>user_id</code> is a foreign key. <code>bars</code> also has a column called <code>foo_id</code> where <code>food_id</code> is a foreign key to the <code>foos</code> table. </p>\n\n<p>I am trying to put together an ActiveRecord query where I can select all users that were created on or before N days ago and do not have any <code>foos</code> where <code>bars.foo_id</code> equal to a particular id. I tried doing something like this:</p>\n\n<pre><code>users = User.where(\"users.created_at &lt;= ?\", 50.days.ago).joins(:bars).where(\"bars.foo_id != 5\")\n</code></pre>\n\n<p>This query fields over 30,000 results, which is incorrect, cause the Users table only has 12,000 rows. </p>\n\n<p>What exactly am I doing wrong here?</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13261674,"title":"insert data from a table to another table sorted by column","body":"<p>There is a temp table <code>TMP_OA_PSTN_CMP_11035</code> with fields:</p>\n\n<pre><code>ACTION_OBJID NUMBER,\nCONTRACT_OBJID NUMBER,\nSTATUS varchar2(40),\nUPDATE_DATE DATE\n</code></pre>\n\n<p>This contains 7 million data.i want to create seven different temp tables with data from TMP_OA_PSTN_CMP_11035 sorted by action_objid and each containing  1 million records. <strong>The column ACTION_OBJID is not a sequence .</strong></p>\n\n<p>I tried using rownum but that inputs random  data.</p>\n\n<p>For EG:</p>\n\n<p>Temp1 : data containing action_objid from 5 ,8...to 1100000(as action_objid is not a sequence,this much is 1 million data).\nSimilarly, for other 6 temp tables.\nI am using oracle 10g.</p>\n"}]}
{"total":102597,"page":3,"pagesize":100,"questions":[{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13285207,"title":"mysql: error code [1267]; Illegal mix of collations (latin1_general_cs,IMPLICIT) and (latin1_swedish_ci,IMPLICIT) for operation '='","body":"<p>I want to make the <code>password</code> column of my User table to be <code>case sensitive</code> in mysql.</p>\n\n<p>Following is the description of the table:</p>\n\n<pre><code>/*Table: mst_user*/\n\n   FIELD          TYPE          COLLATION        \n-------------  ------------  -----------------\nuser_id        VARCHAR(100)  latin1_swedish_ci\nfirst_name     VARCHAR(25)   latin1_swedish_ci\nlast_name      VARCHAR(25)   latin1_swedish_ci\nUSER_PASSWORD  VARCHAR(50)   latin1_swedish_ci\nuser_status    INT(11)       (NULL)           \nversion_id     INT(11)       (NULL)           \nactive_status  INT(11)       (NULL)           \nuser_type      INT(11)       (NULL)    \n</code></pre>\n\n<p>To make the <code>USER_PASSWORD</code> field case sensitive I executed following query:</p>\n\n<pre><code>ALTER TABLE `mst_user` MODIFY `USER_PASSWORD` VARCHAR(50) COLLATE `latin1_general_cs`;\n</code></pre>\n\n<p>This worked and the field is now case sensitive.</p>\n\n<p>But I have a store procedure which executes a <code>SELECT</code> query on this table to check if the user exists for the given credentials. </p>\n\n<p>Stored Proc::</p>\n\n<pre><code>CREATE PROCEDURE `usp_password_verify`(ip_login_id         VARCHAR(200),\n                                 ip_user_password    VARCHAR(200),\n                                INOUT success     INT(1),\nINOUT tbl_usr_password          VARCHAR(100),\nINOUT  pkg_user_password         VARCHAR(100))\nBEGIN\n  SELECT COUNT(*)\n    INTO success\n    FROM mst_user\n   WHERE UPPER (user_id) = UPPER (ip_login_id)\n   AND USER_PASSWORD=ip_user_password;\n\n   SET tbl_usr_password = '';\n   SET pkg_user_password= '';\nEND$$\n</code></pre>\n\n<p>When I call this stored proc from my java code I am getting the following error:</p>\n\n<pre><code>**error code [1267]; Illegal mix of collations (latin1_general_cs,IMPLICIT) and (latin1_swedish_ci,IMPLICIT) for operation '='**\n</code></pre>\n\n<p>Can anyone help what is wrong with this? \nSomething that works as a simple query gives error while executing it in a stored proc!?</p>\n"},{"tags":["sql","oracle","recursion","recursive-query"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":3988,"score":4,"question_id":87877,"title":"Building a Table Dependency Graph With A Recursive Query","body":"<p>I am trying to build a dependency graph of tables based on the foreign keys between them.  This graph needs to start with an arbitrary table name as its root.  I could, given a table name look up the tables that reference it using the all_constraints view, then look up the tables that reference them, and so on, but this would be horrible inefficient.  I wrote a recursive query that does this for all tables, but when I add:</p>\n\n<pre><code>START WITH Table_Name=:tablename\n</code></pre>\n\n<p>It doesn't return the entire tree.</p>\n"},{"tags":["java","sql","database","jdbc","resultset"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":5,"view_count":69,"score":-5,"question_id":13285256,"title":"Java codes to avoid data duplication inside database not working","body":"<p>I am doing an input for classroom records.  In my form I want to include a check which prevents the user to re-enter the same records thus duplicating data inside database table.<br>\nI have tried...yet I dont know why my code is not working.</p>\n\n<p>No output message is being given and the data is being added inside the database table.</p>\n\n<p>Please help me to find my mistake.</p>\n\n<p><strong>Here is the structure of classroom table:</strong></p>\n\n<pre><code>COLUMNNAME      TYPE \n\nclass_no        Text primary key\nbuilding name   Text\nfloor           Text\nsize            Text\nresources       Text\n</code></pre>\n\n<p>I just wanted to implement a method that can notify the user that he is re-entering the same data again and to prevent him to save the data as well.</p>\n\n<p><strong>Here are my codes:</strong></p>\n\n<pre><code>public class addclassroom extends JFrame{\npublic JTextField txt_classno,txt_bname,txt_size,txt_resources;\npublic JComboBox cmbfloor;\npublic JLabel label1, label2, label3, label4, label5, label6;\npublic JButton Save;\npublic JButton Reset;\npublic JButton Back;\nJFrame ciFrame = new JFrame(\"Classroom Records Input Form\");\n\npublic addclassroom(){\n\n\n    label1 = new javax.swing.JLabel();\n    label1.setFont(new java.awt.Font(\"Verdana\", 3, 14)); // NOI18N\n    label1.setForeground(Color.BLACK);\n    label1.setText(\"Classroom Records Input\");\n\n\n    label2 = new javax.swing.JLabel(\"Classroom_No:\");\n    txt_classno = new javax.swing.JTextField(8);\n\n    label3 = new javax.swing.JLabel(\"Building Name:\");\n    txt_bname = new javax.swing.JTextField(15);\n\n    label4 = new javax.swing.JLabel(\"Building Floor:\");\n    String floor[] = {\"Ground floor\",\"1st floor\",\"2nd floor\",\"3rd floor\",\"4th floor\", \"5th floor\", \"6th floor\", \"7th floor\", \"8th floor\"};\n    cmbfloor = new javax.swing.JComboBox(floor);\n\n    label5 = new javax.swing.JLabel(\"Size Capacity:\");\n    txt_size = new javax.swing.JTextField(5);\n\n\n    label6 = new javax.swing.JLabel(\"Resources\");\n    txt_resources = new javax.swing.JTextField(20);\n\n\n\n\n    Save = new javax.swing.JButton();\n    Save.setText(\"Save\");\n\n    Reset = new javax.swing.JButton();\n    Reset.setText(\"Reset\");\n\n    Back = new javax.swing.JButton();\n    Back.setText(\"Back\");\n\n\n    label1.setBounds(100, 25, 200, 50);\n\n    label2.setBounds(50, 100, 100, 50);\n    txt_classno.setBounds(180, 100, 100, 30);\n\n\n\n    label3.setBounds(50, 150, 100, 50);\n    txt_bname.setBounds(180, 150, 140, 30);\n\n    label4.setBounds(50, 200, 100, 50);\n    cmbfloor.setBounds(180, 200, 115, 30);\n\n\n\n    label5.setBounds(50, 250, 100, 50);\n    txt_size.setBounds(180, 250, 65, 30);\n\n\n\n    label6.setBounds(50, 300, 100, 50);\n    txt_resources.setBounds(180, 300, 175, 30);\n\n\n\n    Save.setBounds(100, 400, 75, 20);\n    Reset.setBounds(200, 400, 75, 20);\n    Back.setBounds(300,400,75,20);\n\n    ciFrame.add(label1);\n    ciFrame.add(label2);\n    ciFrame.add(txt_classno);\n    ciFrame.add(label3);\n    ciFrame.add(txt_bname);\n    ciFrame.add(label4);\n    ciFrame.add(cmbfloor);\n    ciFrame.add(label5);\n    ciFrame.add(txt_size);\n    ciFrame.add(label6);\n    ciFrame.add(txt_resources);\n\n    ciFrame.add(Save);\n    ciFrame.add(Reset);\n    ciFrame.add(Back);\n    ciFrame.setLayout(null);\n    ciFrame.setVisible(true);\n    ciFrame.setSize(500, 500);\n    ciFrame.setResizable(false);\n    ciFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); \n\n    Save.setMnemonic('S');\n    Save.addActionListener(new ActionListener() {\n        public void actionPerformed(ActionEvent e)\n        {\n            Save.setEnabled(true);\n            }\n    });\n\n    Reset.setMnemonic('R');\n    Back.setMnemonic('B');\n    Handleraddclassroom h = new Handleraddclassroom();\n    Save.addActionListener(h);\n    Reset.addActionListener(h);\n    Back.addActionListener(h);\n\n}\n\npublic class Handleraddclassroom implements ActionListener{\n    public void actionPerformed(ActionEvent event){\n\n        String name = ((JButton)event.getSource()).getText();\n\n\n        if (name.equals(\"Back\")){\n\n            ciFrame.setVisible(false);\n            Classroomdetails cm = new Classroomdetails();\n            dispose();  \n\n        }\n\n\n        if (name.equals(\"Reset\")){\n\n            txt_classno.setText(\"\");\n            txt_bname.setText(\"\");\n            txt_size.setText(\"\");\n            txt_resources.setText(\"\");\n\n        }\n\n        if (name.equals(\"Save\")){\n            String filename = \"C:/JAVA/schedule.accdb\";\n            String database = \"jdbc:odbc:scheduling\";\n\n\n\n            if(txt_classno.getText().equals(\"\")){\n                JOptionPane.showMessageDialog(addclassroom.this,\"Classroom No field should not be blank\");\n\n            }\n\n\n\n        else{\n\n            try {\n                Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n\n                Connection con = DriverManager.getConnection(database ,\"\",\"\");  //username &amp;password not being used\n\n                String flr=\"\";\n                if(cmbfloor.getSelectedIndex()==0){\n                    flr=\"Ground floor\"; }\n                    else if(cmbfloor.getSelectedIndex()==1){\n                        flr=\"1st floor\";}\n\n                    else if(cmbfloor.getSelectedIndex()==2){\n                        flr=\"2nd floor\";}\n                    else if(cmbfloor.getSelectedIndex()==3){\n                        flr=\"3rd floor\";}\n                    else if(cmbfloor.getSelectedIndex()==4){\n                        flr=\"4th floor\";}\n                    else if(cmbfloor.getSelectedIndex()==5){\n                        flr=\"5th floor\";}\n                    else if(cmbfloor.getSelectedIndex()==6){\n                        flr=\"6th floor\";}\n                    else if(cmbfloor.getSelectedIndex()==7){\n                        flr=\"7th floor\";}\n                    else if(cmbfloor.getSelectedIndex()==8){\n                        flr=\"8th floor\";}\n\n            Statement s = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY); //The Result set can now scroll forward and back\n\n            String sq = \"SELECT * FROM classroom WHERE class_no = '\" + txt_classno.getText() + \"' \";\n            s.execute(sq);\n\n            ResultSet r = s.getResultSet();\n\n            String display = null;\n\n            if (r! = null){\n            while (r.next()){\n            display = r.getString(1);\n            }\n            }\n\n            if (txt_classno.getText().equals(display){\n            JOptionPane.showMessageDialog(addclassroom.this,\"You have already input this data earlier.\");\n\n            }\n\n\n\n            String sql = \"INSERT INTO classroom VALUES('\" \n\n                + txt_classno.getText()+ \"','\"\n                + txt_bname.getText() + \"','\"\n\n                + flr + \"','\" \n                + txt_size.getText() + \"','\"\n                + txt_resources.getText()+ \"' )\";\n\n            JOptionPane.showMessageDialog(addclassroom.this,\"Classroom Records Saved.\");\n\n            s.execute(sql);\n\n            s.close();\n            con.close();\n\n            } catch (Exception e) {System.out.print(\"Error: \" + e);}\n            }\n        }\n    }   \n\n\n}\n\n\n\n}\n</code></pre>\n"},{"tags":["sql","sql-server","database","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13284952,"title":"Add join results as new column based on values from join","body":"<p>I've never done something like this, and I tried finding it on google but without result.</p>\n\n<p>I have 3 tables that look like this:</p>\n\n<p><strong>Orders:</strong></p>\n\n<pre><code>OdredID (int) PK,\nUserID (int) FK,\nOdredDate (datetime)\n</code></pre>\n\n<p><strong>Components:</strong></p>\n\n<pre><code>ComponentID (int) PK,\nName (nvarchar(50)),\nType (nvarchar(max))\n</code></pre>\n\n<p><strong>OrderComponent:</strong></p>\n\n<pre><code>OrderComponentID (int) PK,\nOrderID (int) FK,\nComponentID (int) FK,\nValue (nvarchar(max))\n</code></pre>\n\n<p>Lets say one order has 3 components with names: <code>[CPU, Motherboard, Memory]</code> and values <code>[1GHz, AsusP5, 2GB Kingston DDR3]</code></p>\n\n<p>I need a result has columns like this:</p>\n\n<pre><code>OrderID  UserID   Date          CPU    Motherboard   Memory\n   1        1     2012-05-21    1GHz   AsusP5        2GB Kingston DDR3\n</code></pre>\n\n<p>Basically I need every join row to go as new column with name taken from <code>Name</code> column of join table and value from <code>Value</code> column.</p>\n"},{"tags":["sql","excel","excel-vba","excel-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13284597,"title":"How to make sql queries run faster in excel?","body":"<p>In order to optimize a report i changed all the pivot tables present in it to sql queries since using pivot is not an effective way to code. However to my surprise , sql queries are taking more time than pivot . Are there any standard ways to optimize sql queries or connection  to make my tool run faster?</p>\n"},{"tags":["sql","sql-server","tsql","sql-function"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":51,"score":5,"question_id":13284222,"title":"Database Function VS Case Statement","body":"<p>Yesterday we got a scenario where had to get type of a <code>db field</code> and on base of that we had to write the description of the field. Like </p>\n\n<pre><code>Select ( Case DB_Type When 'I' Then 'Intermediate'\n                      When 'P' Then 'Pending'\n                      Else 'Basic'\n         End)\nFrom DB_table\n</code></pre>\n\n<p>I suggested to write a db function instead of this case statement because that would be more reusable. Like</p>\n\n<pre><code>Select dbo.GetTypeName(DB_Type) \nfrom DB_table\n</code></pre>\n\n<p>The interesting part is, One of our developer said using database function will be <strong>inefficient</strong> as <code>database functions</code> are <strong>slower</strong> than <code>Case statement</code>. I searched over the internet to find the answer which is better approach in terms of efficiency but unfortunately I found nothing that could be considered satisfied answer. Please enlighten me with your thoughts, which approach is better?</p>\n"},{"tags":["sql","charts","subselect","avg"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13275135,"title":"SQL AVG in subselect","body":"<p>I want to get rates from a product (productId) that is in a specific category (fk_rate_category) and the overall average rates from all products in the category.</p>\n\n<p>To be more specific: I need the data for a chart. One line in the chart represents the rate of a product(y-axis = rate ; x-axis = date_added) and the other line shows the average rates of all products.</p>\n\n<p>I had the following approach:</p>\n\n<pre><code>SELECT        id, productId, rate, fk_rate_category, date_added,\n                             (SELECT        AVG(rate) AS Expr1\n                               FROM            rates\n                               WHERE        (fk_rate_category = r.fk_rate_category)) AS avgRate\nFROM            rates AS r\nWHERE        (productId = @productId) AND (fk_rate_category = @fk_rate_category)\n</code></pre>\n\n<p>The problem is, that with my approach the avgRates value is the same in every record returned. </p>\n\n<p>Any  idea?</p>\n"},{"tags":["mysql","sql","interop","case-sensitive","string-comparison"],"answer_count":4,"favorite_count":3,"up_vote_count":20,"down_vote_count":0,"view_count":8701,"score":20,"question_id":5629111,"title":"How can I make SQL case sensitive string comparison on MySQL?","body":"<p>I have a function that returns five characters with mixed case. If I do a query on this string it will return the value regardless of case.</p>\n\n<p>How can I make MySQL string queries case sensitive?</p>\n"},{"tags":["iphone","sql","objective-c","core-data"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1359,"score":1,"question_id":4865686,"title":"GROUP BY equivalent for Core Data","body":"<p>I know that I can use @distinctUnionOfObjects to find something like the following in SQL:</p>\n\n<pre><code>SELECT a_value\nFROM my_table\nGROUP BY a_value;\n</code></pre>\n\n<p>What I'm looking for is <em>all of the data</em> returned in an array, not just the array of values that matches the group by expression.  Essentially, I'm looking for the equivalent of the following SQL query for core data:</p>\n\n<pre><code>SELECT *\nFROM my_table\nGROUP BY a_value;\n</code></pre>\n"},{"tags":["sql","sql-server","select","distinct"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":49,"score":-2,"question_id":13285092,"title":"How to get Distinct values from all columns of a table in SQL Server","body":"<p>I want to retrieve record for distinct value with it's ID ,Table is like this ::</p>\n\n<pre><code>ID     Name\n1      Soap\n2      eridu\n3      Soap\n4      rewfig\n5      Soap\n</code></pre>\n\n<p>Now I want result:</p>\n\n<pre><code>ID  Name\n1   Soap\n2   eridu\n3   rewfig\n</code></pre>\n\n<p>I use like this: [Table Name is tblRecord</p>\n\n<pre><code>select Distinct(Name) ,ID\n  from tblRecord\n where Name in (select Distinct(Name) \n                  from tblRecord\n               )\n</code></pre>\n"},{"tags":["sql","sql-server","query","graph","subgraph"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13281776,"title":"SQL: Finding a subgraph","body":"<p>I have a graph network stored in an SQL server. The graph network ( collection of labeled, undirected and connected graphs) is stored in Vertex-Edge mapping scheme (i.e there are 2 tables..one for vertices and one for edges) :</p>\n\n<p>Vertices ( graphID , vertexID, vertexLabel )</p>\n\n<p>Edges  ( graphID , sourceVertex  , destinationVertex ,edgeLabel )</p>\n\n<p>I am looking for a simple way of counting a particular subgraph in this network. For example: I would like to find how many instances of \"A-B-C\" are present in this network : \"C-D-A-B-C-E-A-B-C-F\". I have a few ideas on how this can be done in say Java or C++ ...but I have no clue how to approach this problem using SQL. any ideas?</p>\n\n<p>A little background: I'm no student..this is a small project I would like to pursue. I do a lot of social media analysis (in memory) but have little experience mining graphs against an SQL database.</p>\n"},{"tags":["sql","utf-8","c++builder"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13285025,"title":"How to change the character encoding to utf-8 in C++ builder 5","body":"<p>Im having a problem where a program i made cant display a string because it contains a unknown char. The program is encoded in latin i guess but how can it to utf-8? </p>\n\n<p>I cant simply change the char because we are receiving this from our clients.</p>\n\n<p>Or do i need to change this in SQL?</p>\n"},{"tags":["sql","c3p0","database-deadlocks"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13284359,"title":"C3p0 APPARENT DEADLOCK exception even though statement caching is disabled","body":"<p>I am using C3p0 connection pool and I am observing following exception in my server. </p>\n\n<pre><code> com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@ed866f -- APPARENT DEADLOCK!!! Complete Status:\n    Managed Threads: 1\n    Active Threads: 1\n    Active Tasks:\n        com.mchange.v2.resourcepool.BasicResourcePool$1DestroyResourceTask@995ec2 (com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0)\n    Pending Tasks: \n            com.mchange.v2.resourcepool.BasicResourcePool$1RefurbishCheckinResourceTask@11c3ceb\n            com.mchange.v2.resourcepool.BasicResourcePool$1RefurbishCheckinResourceTask@e392ed\n            com.mchange.v2.resourcepool.BasicResourcePool$1RefurbishCheckinResourceTask@c33853\n            com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@a6f77d\n            com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@1c25bfc\n            com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@12534a9\n            com.mchange.v2.resourcepool.BasicResourcePool$1RefurbishCheckinResourceTask@1a4564c\nPool thread stack traces:\n        Thread[com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0,5,main]\n                oracle.jdbc.driver.OracleStatement.close(OracleStatement.java:1338)\n                com.mchange.v2.c3p0.impl.NewPooledConnection.cleanupUncachedStatements(NewPooledConnection.java:651)\n                com.mchange.v2.c3p0.impl.NewPooledConnection.close(NewPooledConnection.java:539)\n                com.mchange.v2.c3p0.impl.NewPooledConnection.close(NewPooledConnection.java:234)\n                com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.destroyResource(C3P0PooledConnectionPool.java:470)\n                com.mchange.v2.resourcepool.BasicResourcePool$1DestroyResourceTask.run(BasicResourcePool.java:964)\n               com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)\n</code></pre>\n\n<p>My configuration is</p>\n\n<pre><code>&lt;property name=\"initialPoolSize\" value=\"1\" /&gt;\n    &lt;property name=\"minPoolSize\" value=\"1\" /&gt;\n    &lt;property name=\"maxPoolSize\" value=\"20\" /&gt;\n    &lt;property name=\"maxIdleTime\" value=\"240\" /&gt;\n    &lt;property name=\"checkoutTimeout\" value=\"60000\" /&gt;\n    &lt;property name=\"acquireRetryAttempts\" value=\"0\" /&gt;\n    &lt;property name=\"acquireRetryDelay\" value=\"1000\" /&gt;\n    &lt;property name=\"debugUnreturnedConnectionStackTraces\" value=\"true\" /&gt;\n    &lt;property name=\"unreturnedConnectionTimeout\" value=\"300\" /&gt;\n    &lt;property name=\"numHelperThreads\" value=\"1\" /&gt;\n    &lt;property name=\"preferredTestQuery\" value=\"SELECT 1 FROM DUAL\" /&gt;\n</code></pre>\n\n<p>After some googing I found following threads. \n<a href=\"https://forum.hibernate.org/viewtopic.php?t=947246\" rel=\"nofollow\">https://forum.hibernate.org/viewtopic.php?t=947246</a></p>\n\n<p>It is suggested to disable the statement caching to avoid this problem. But in my configuration I didn't enable the statement caching(maxStatements, maxStatementsPerConnection are 0 by default). </p>\n\n<p>Please suggest any alternatives. </p>\n"},{"tags":["sql","sql-server","insert","left-join","statement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":13284959,"title":"How can I Insert all statement to sql?","body":"<p>i need insert all statement but it's don't insert all record.\nsample query 100 record but insert 20 record?</p>\n\n<p>how can i insert all record.</p>\n\n<p><strong>Table filesTA2</strong></p>\n\n<pre><code>EmpNo     ChkDate\n00001     2012-10-15 00:00:00.000\n00002     2012-10-15 00:00:00.000\n00003     2012-10-15 00:00:00.000\n00004     2012-10-15 00:00:00.000\n00005     2012-10-15 00:00:00.000\n</code></pre>\n\n<p><strong>Table LeaveRecord:</strong></p>\n\n<pre><code>EmployeeRun    StartDate\n00008          2012-10-15 00:00:00.000\n00009          2012-10-15 00:00:00.000\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>INSERT INTO filesTA2 (EmpNo,ChkDate)\nSELECT DISTINCT em.EmployeeNo, coalesce(tf.ChkDate, lr.StartDate) as 'Date'\nFROM Employee em\nLEFT JOIN filesTA2 tf on tf.EmpNo = em.EmployeeNo and tf.ChkDate = '2012-10-15'\nLEFT JOIN LeaveRecord lr on lr.EmployeeRun = em.EmployeeNo and lr.StartDate = '2012-10-15'\nWHERE em.Resigned = '0' and em.Terminated = '0' and em.EmployeeNo not Between '1000001' and '1000004' and tf.ChkDate is null\nOrder By em.EmployeeNo\n</code></pre>\n\n<p><strong>This code get output:</strong></p>\n\n<pre><code>Employee     Date\n00006        NULL\n00007        NULL\n00008        2012-10-15 00:00:00.000\n00009        2012-10-15 00:00:00.000\n00010        NULL\n</code></pre>\n\n<p><strong>when i insert to table filesTA2 get output:</strong></p>\n\n<pre><code>EmpNo     ChkDate\n00001     2012-10-15 00:00:00.000\n00002     2012-10-15 00:00:00.000\n00003     2012-10-15 00:00:00.000\n00004     2012-10-15 00:00:00.000\n00005     2012-10-15 00:00:00.000\n00008     2012-10-15 00:00:00.000\n00009     2012-10-15 00:00:00.000\n</code></pre>\n\n<p><strong>But I need insert all record output. How can I?</strong></p>\n\n<p>Thanks for you time. :)</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13284650,"title":"to display all records from one table and sum of rows from another table","body":"<p>I have two tables HouseKeeping with fields RoomNo,FloorNo,StockItem,Requirement and Stock table with fields Item ,Available.I want to select all rows from HouseKeeping table and sum of requirement from stock table.I have used this query to get sum of requirement from stock table</p>\n\n<p><code>SELECT SUM(Requirement) AS Requirement, StockItem\nFROM  HouseKeeping\nGROUP BY StockItem</code></p>\n\n<p>in addition to this i also want all records(select * from Stock).How to do it? please reply as soon as possible.Thanks</p>\n"},{"tags":["sql","oracle","concatenation","pivot","string-aggregation"],"answer_count":10,"favorite_count":12,"up_vote_count":23,"down_vote_count":0,"view_count":89720,"score":23,"question_id":468990,"title":"How can I combine multiple rows into a comma-delimited list in Oracle?","body":"<p>I have a simple query:</p>\n\n<pre><code>select * from countries\n</code></pre>\n\n<p>with the following results:</p>\n\n<pre><code>country_name\n------------\nAlbania\nAndorra\nAntigua\n.....\n</code></pre>\n\n<p>I would like to return the results in one row, so like this:</p>\n\n<pre><code>Albania, Andorra, Antigua, ...\n</code></pre>\n\n<p>Of course, I can write a PL/SQL function to do the job (I already did in Oracle 10g), but is there a nicer, preferably non-Oracle-specific solution (or may be a built-in function) for this task?</p>\n\n<p>I would generally use it to avoid multiple rows in a sub-query, so if a person has more then one citizenship, I do not want her/him to be a duplicate in the list.</p>\n\n<p>My question is based on the similar question on <a href=\"http://stackoverflow.com/questions/180032/how-can-i-combine-multiple-rows-into-a-comma-delimited-list-in-sql-server-2005\">SQL server 2005</a>.</p>\n\n<p><strong>UPDATE</strong>:\nMy function looks like this:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION APPEND_FIELD (sqlstr in varchar2, sep in varchar2 ) return varchar2 is\nret varchar2(4000) := '';\nTYPE cur_typ IS REF CURSOR;\nrec cur_typ;\nfield varchar2(4000);\nbegin\n     OPEN rec FOR sqlstr;\n     LOOP\n         FETCH rec INTO field;\n    \t EXIT WHEN rec%NOTFOUND;\n         ret := ret || field || sep;\n     END LOOP;\n     if length(ret) = 0 then\n          RETURN '';\n     else\n          RETURN substr(ret,1,length(ret)-length(sep));\n     end if;\nend;\n</code></pre>\n"},{"tags":["java","mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13284138,"title":"Using SQL REGEXP to find mobile number","body":"<p><br>\nOur DB can contain the mobile number in different formats, like: '(731) 123-4567' or '731-123 45 67' or '731-12-3-[4567]', etc. <br>\nAlso, the input I get in the API for search can be in any of the format.<br>\nSo, when I need to find a user with mobile in db, I clean up the input number, so it will look like '7311234567' and then wrap/padd it with regexp <code>'(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*'</code>, so for example, the SQL looks like this:<br></p>\n\n<pre><code>select * from contact where mobile REGEXP '(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*\n             1(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*7(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*\n             3(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*1(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*\n             2(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*9(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*\n             8(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*0(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*\n             7(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*4(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*\n             0(\\\\+|\\\\-|\\\\(|\\\\)|\\\\[|\\\\]| )*';\n</code></pre>\n\n<p>The problem is when I get input like this '11234567' which is like '7311234567' but without the '73' - when the query executes - it also finds the user with '7311234567'.<br>\n<br>\nQuestion: How do I wrap my regexp better so it will fit only full number with regexp?</p>\n"},{"tags":["c#","sql","entity-framework","sync"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13284661,"title":"EF synchronic savings of local and remote database","body":"<p>I have a local and remote database which are accessed with EF. The databases are in sync at initial state.</p>\n\n<p>Now I want to save the changes done locally, also save on the remote database. This should be possible without downloading the whole remote database?.</p>\n\n<p>Can I just change the connection string of the context and then call SaveChanges() on remote?.</p>\n"},{"tags":["mysql","sql","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13284410,"title":"in sql how to write sub query which provides two value in where clause","body":"<p>I use mysql.\nHere is my sql</p>\n\n<pre><code>select *\nfrom releases\nwhere  id &gt;\n(\n    select min(id) as x\n    from releases \n    where released &gt; \"2011-12-01\"\n) \nlimit 0,30 \n</code></pre>\n\n<p>This is right.\nBut I want to find items which id are in the range(not only greater than) like this:</p>\n\n<pre><code>select *\nfrom releases\nwhere  id &gt;\n    ((\n        select min(id) as x , max(id) as y\n        from releases \n        where released &gt; \"2011-12-01\"\n    ) as D ) D.x and id &lt; D.y\nlimit 0,30 \n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13284293,"title":"How to store array or record in SQL Server 2008","body":"<p>Anyone please tell me how to store n x n matrix data into SQL Server 2008?</p>\n\n<p>I want to store thousand of pieces of data into SQL Server at the same time from my ASP.NET page so if I pass an array of row and column then how can I store at the same time in SQL Server</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13274556,"title":"SQL Conversion Error","body":"<p>I really need a second pair of eyes on this... I have a Stored Procedure with a variable:</p>\n\n<pre><code>DECLARE @date_period_end int \n\nIF @date_period_end = '' or @date_period_end is null  \nBEGIN \n    SET @date_period_end = 'DATEDIFF(dd, ''1/1/1753'', CONVERT(datetime,getdate())) + 639906 ' \nEND\n</code></pre>\n\n<p>Here is the error SQL returning when I execute:</p>\n\n<blockquote>\n  <p>Conversion failed when converting the varchar value 'DATEDIFF(dd, '1/1/1753', CONVERT(datetime,getdate())) + 639906 ' to data type int.</p>\n</blockquote>\n\n<p>I'm pretty certain I'm missing or have added an incorrect amount of quotes somewhere.  Thanks.</p>\n"},{"tags":["sql","vb.net","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13135085,"title":"datagridview update to database","body":"<p>please help me...</p>\n\n<p>I load my database in the datagrid view and edit some cells.\nNow I just need to update my database</p>\n\n<p>here are my codes</p>\n\n<pre><code>  Dim dT As DataTable = MyDB.ExecCommand(\"SELECT `Field Name` FROM `tblfield`\", \"wellsfargo\").Tables(0)\n\n    Dim sSQL As String = \"\"\n\n    Dim dZ As DataTable = MyDB.ExecCommand(\"SELECT \" &amp; sColumn &amp; \" FROM `\" + cboJob.Text.Trim + \"`\", \"wellsfargo\", 0).Tables(0)\n\n    dColumn = New DataTable\n    dColumn = MyDB.ExecCommand(\"SHOW COLUMNS IN tblrecord\", \"wellsfargo\", 0).Tables(0)\n\n\n    If dZ.Rows.Count &lt;&gt; 0 Then\n        sSQL = \"UPDATE \" &amp; sColumn &amp; \" FROM `\" + cboJob.Text.Trim + \"`\"\n        MyDB.ExecQuery(sSQL, \"wellsfargo\")\n    Else\n        Dim sColumn As String = \"\"\n\n        For z As Integer = 0 To dT.Rows.Count - 1\n            If z = 0 Then\n                sColumn = \"`\" &amp; dT.Rows(z).Item(0).ToString &amp; \"`\"\n            Else\n                sColumn = sColumn &amp; \",`\" &amp; dT.Rows(z).Item(0).ToString &amp; \"`\"\n            End If\n        Next\n        sSQL = \"INSERT INTO `\" + MyJob + \"` (\" + sColumn + \") \"\n\n        MyDB.ExecQuery(sSQL, \"wellsfargo\")\n    End If\n</code></pre>\n"},{"tags":["c#","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":57,"score":-2,"question_id":13284024,"title":"Addition is not working in the following query","body":"<p>hi i used the following query as stored procedure, when i run this query in sql it returns the  correct result, but when i use the same query in c#, its not working. can u plz tell where i made the mistake</p>\n\n<pre><code>select a.Itemcode,a.Description,a.Category,a.Location,a.Quantity,b.count,    (isnull(a.Quantity,0)+isnull(c.count,0)-isnull(b.count,0)) as Stockin \nfrom (select Itemcode,Description,Category,Location,isnull(Quantity,0) as Quantity from   Totalitemsinstock)a \nleft join (select sum(ISNULL(StocktransferlocationDetails.count,0))as count,\nleft(StocktransferlocationDetails.Itemcode,10) as Itemcode from   StocktransferlocationDetails where Status='Open'\ngroup by left(StocktransferlocationDetails.Itemcode,10))b on a.Itemcode=b.Itemcode\nleft join(select sum(ISNULL(StocktransferlocationDetails.count,0))as count,\nleft(StocktransferlocationDetails.Itemcode,10) as Itemcode from   StocktransferlocationDetails where Status='Closed'\ngroup by left(StocktransferlocationDetails.Itemcode,10))c on a.Itemcode=c.Itemcode\n</code></pre>\n\n<p>i used this query as stored procedure</p>\n\n<pre><code>con.Open();\n                SqlCommand cm_stockin = new SqlCommand(\"StoredProcedure2\", con);\n                cm_stockin.CommandType = CommandType.StoredProcedure;\n                SqlDataAdapter da_stockin = new SqlDataAdapter(cm_stockin);\n\n                DataSet ds_stockin = new DataSet();\n                da_stockin.Fill(ds_stockin);\n                dataGridView_stockin.DataSource = ds_stockin.Tables[0];\n                con.Close();\n</code></pre>\n"},{"tags":["java","mysql","sql","query","statement"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1903,"score":2,"question_id":10797794,"title":"Multiple queries executed in java in single statement","body":"<p>Hi I was wondering if it is possible to execute something like this using JDBC as it currently provides an exception even though it is possible in the MySQL query browser.</p>\n\n<pre><code>\"SELECT FROM * TABLE;INSERT INTO TABLE;\"\n</code></pre>\n\n<p>While I do realize that it is possible with having the SQL query string being split and the statement executed twice but I was wondering if there is a one time approach for this.</p>\n\n<pre><code>    String url = \"jdbc:mysql://localhost:3306/\";\n    String dbName = \"databaseinjection\";\n    String driver = \"com.mysql.jdbc.Driver\";\n    String sqlUsername = \"root\"; \n    String sqlPassword = \"abc\";\n\n    Class.forName(driver).newInstance();\n\n    connection = DriverManager.getConnection(url+dbName, sqlUsername, sqlPassword);\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13281741,"title":"SQL Trigger is Updating random row not the joined row","body":"<p>I have this query in a update trigger</p>\n\n<pre><code>UPDATE [FSSQLPROD01].[collectionsDELETE].[dbo].[collections] \nSET \n    Defendant_1 = i.DisplayName \n    , Loan_Number_1 = i.Comments \n    , Client = i.KS_BookName \n    , Date_Instructed = i.OpenDate \n    , Person_Responsible_name = i.ResponsibleFeeEarnerName \n    , Person_Responsible_Email = i.ResponsibleFeeEarnerEmail \n    , Person_Acting_name = i.BillingFeeEarnerName \n    , Person_Acting_email = i.BillingFeeEarnerEmail \n    , Agent_Acting_name = i.BillingFeeEarnerName \n    , Agent_Acting_email = i.BillingFeeEarnerEmail \n    , CBA_Panel_Service_Area = i.KS_ServiceCat \n    , HBN_Number = i.KS_ClientAcctRef \n    , St_George_Contact = i.KS_Instructor \nFROM \n    [FSSQLPROD01].[collectionsDELETE].[dbo].[collections] c\nINNER JOIN \n    Inserted i\nON\n    Left(c.file_number, 6) COLLATE DATABASE_DEFAULT = i.MatterNumber COLLATE DATABASE_DEFAULT\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/cjJ1P.jpg\" alt=\"enter image description here\">\nNow the Join connection matches up on the File_Number e.g. 70003-1 but for some unknown reason the data that should be updated to this Row is been updated to a toally random row 614864-7 </p>\n\n<p>I can continue to execute the trigger and tring to update the 70003-1 row but i continues to update the other row  614864-7 </p>\n\n<p>This is also running across a linked server the trigger is on one server up dating the other servers</p>\n\n<p>Server tigger sits on Microsoft SQL Server 2005 - 9.00.3042.00 (X64)   Feb 10 2007 00:59:02   Copyright (c) 1988-2005 Microsoft Corporation  Enterprise Edition (64-bit) on Windows NT 5.2 (Build 3790: Service Pack 2) </p>\n\n<p>Server trigger is updating Microsoft SQL Server 2005 - 9.00.3042.00 (X64)   Feb 10 2007 00:59:02   Copyright (c) 1988-2005 Microsoft Corporation  Enterprise Edition (64-bit) on Windows NT 5.2 (Build 3790: Service Pack 2) </p>\n\n<p>I have been thinking that updating the servers SP to SP4 may fix the problem?</p>\n\n<p>Does anyone have a reson why this might be haapening the Server </p>\n\n<p>Ammendment </p>\n\n<p>Yeah i actually hardcoded the values and simplified the SQL Statement it works as it should </p>\n\n<pre><code>DECLARE @MatterNumber as varchar(50)\nSET @MatterNumber = (SELECT i.MAtternumber FRom Inserted as i) + '-1'\nPrint @MatterNumber\n\nUPDATE [FSSQLPROD01].[collectionsDELETE].[dbo].[collections] \n       SET Loan_Number_1 = ‘123’\n       WHERE file_number =  @MatterNumber\n</code></pre>\n\n<p>But as soon as I set a Declared Varible value to Loan_Number_1 or any of the other columes this is when the problem starts to happen</p>\n\n<pre><code>DECLARE @LoanNumber as varchar(50)\nSET @LoanNumber =    (SELECT i.Comments FRom Inserted as i)\n    Print @LoanNumber\nDECLARE @MatterNumber as varchar(50)\nSET @MatterNumber = (SELECT i.MAtternumber FRom Inserted as i) + '-1'\n\nPrint @MatterNumber –-I print here I see 70003-1\n\nUPDATE [FSSQLPROD01].[collectionsDELETE].[dbo].[collections] \n       SET Loan_Number_1 = @LoanNumber\n\n       WHERE file_number =  @MatterNumber\n\nPrint @MatterNumber –-I print here I see 70003-1\n</code></pre>\n"},{"tags":["c#","sql","winforms","telerik"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13182654,"title":"From DataTable to DataGridView including image path","body":"<p>I am building a small application. This application stores customer information and customer pictures.\nHere I have a problem where I want to show data from datatable to datagridview with pictures. My application does not store the image in a database, but stored in a folder. </p>\n\n<p>So in my database just store image path. But not full path, only the name of the folder or file. I use combine path on each name. It is easier to manage folders if the root directory has been changed compared to if I keep the full path.</p>\n\n<p>For example, if I want to display the image in picture box, I'll do this.</p>\n\n<pre><code>//consider the record has been selected from table\n\nclassDirectory cd = new classDirectory();\n\n// it will check current directory combine application name folder and branch name folder.\n\nstring branchFolderPath = cd.getBranchFolderPath(branchName); \n\nstring branchPanelPath = cd.getPanelFolderPath(branchFolderPath,panelName);\n\nstring customerPath = cd.getCustomerFolderPath(branchPanelPath,customerID + \" - \" + customerName);\n\nstring customerImage = path.Combine(customerPath,customerPicPath);\n\npicCustomer.Image = new Bitmap(customerImage);\n</code></pre>\n\n<p>After combine, it will return string <strong>\"C:\\Users\\My Name\\Documents\\My Application Name\\Branch Name\\Panel Name\\1235 - HIDAYAH\\Pictures\\HIDAYAH - Picture.jpg\"</strong></p>\n\n<p>So I can see the pictures.</p>\n\n<p>But, I do not know how to display the data in grid view.</p>\n\n<p>So only so far I've just made.</p>\n\n<pre><code>Customer.classDataBinding cdb = new Customer.classDataBinding();\n\nDataTable dataCustomer = cdb._listOfCustomer();\n\ndgvCustomer.DataSource = dataCustomer;\n\nthis.dgvCustomer.Columns[\"Customer Image\"].Width = 120; //For a while, this code return the string only.\nthis.dgvCustomer.Columns[\"Customer ID\"].Width = 120;\nthis.dgvCustomer.Columns[\"Name\"].Width = 120;\nthis.dgvCustomer.Columns[\"Branch\"].Width = 120;\nthis.dgvCustomer.Columns[\"Panel\"].Width = 120;\n</code></pre>\n\n<p>Code in <strong>cdb._listOfCustomer()</strong></p>\n\n<pre><code>  public DataTable _listOfCustomer()\n    {\n        cs.testConnection();\n\n        DataTable dtCustomer = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(cs.connString))\n        {\n            string query = \"SELECT tbl_customer.customerPicPath as [Customer Image], tbl_customer.customerID as [Customer ID],tbl_customer.customerName as Name, tbl_branch.branchName as Branch, tbl_panel.panelName as Panel FROM (tbl_branch INNER JOIN tbl_panel ON tbl_branch.branchID = tbl_panel.branchID) INNER JOIN tbl_customer ON tbl_panel.panelID = tbl_customer.panelID;\";\n\n            using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))\n            {\n                adap.Fill(dtCustomer);\n\n            }\n        }\n\n        return dtCustomer;\n</code></pre>\n\n<p>Any suggestion? Hope someone can help me to resolve this problem. Thanks a lot!</p>\n"},{"tags":["python","sql","database","ms-access","firebird"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13283309,"title":"The function does not work on all the tables","body":"<p>I wrote the following code by data transfer from Access to Firebird</p>\n\n<pre><code>def getFirebirdFieldNames(firebird_cursor, tablename):\n    firebird_cursor.execute('select rdb$field_name from rdb$relation_fields where rdb$relation_name=\\'%s\\' order by rdb$field_position' % (tablename,))\n    field_names = list()\n    for c in firebird_cursor.fetchall():\n        field_names.append(c[0])\n    return field_names\n\ndef SelectFromAccessTable(tablename):\n    return 'select * from [' + tablename+']'\n\ndef InsertToFirebirdTable(tablename, row):\n    values=''\n    values=values.encode('cp1251', 'replace')\n    for i in range(len(row)):\n        if (i!=len(row)-1):\n                if type(row[i])==int:\n                      temp=str(row[i])\n                else:\n                      if type(row[i])==decimal.Decimal:\n                          temp=str(row[i])\n                      else:\n                          temp='\\'%s\\'' % (row[i],)\n                values+=temp+', '                 \n        else:\n                if type(row[i])==int:\n                      temp=str(row[i])\n                else:\n                      if type(row[i])==decimal.Decimal:\n                          temp=str(row[i])\n                      else:\n                          temp='\\'%s\\'' % (row[i],)\n                values+=temp\n    return 'insert into '+tablename+' values ('+values+')'\n\ndef AccessToFirebird(accesstablename, firebirdtablename, accesscursor, firebirdcursor):\n    SelectSql=SelectFromAccessTable(accesstablename)\n    for row in accesscursor.execute(SelectSql):\n        InsertSql=InsertToFirebirdTable(firebirdtablename, row)\n        InsertSql=InsertSql\n        print InsertSql\n        firebirdcursor.execute(InsertSql)\n</code></pre>\n\n<p>In the main program there is a call of these functions</p>\n\n<pre><code>conAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nconn.begin()\ncur=conn.cursor()\nsql.AccessToFirebird('Customers', 'CLIENTS', SqlAccess, cur)\nconn.commit()\nconn.begin()\ncur=conn.cursor()\nsql.AccessToFirebird('Сотрудники', 'EMPLOYEES', SqlAccess, cur)\nconn.commit()\nconAcc.commit()\nconn.close()\nconAcc.close();\n</code></pre>\n\n<p>As a result of filling in the table CLIENTS, EMPLOYEES is not filled (Northwind database). Why?\nHere is the text output (sql-query inserts)</p>\n\n<pre><code>insert into EMPLOYEES values (1, 'Борей', 'Ильина', 'Юлия', 'julia@northwindtraders.com', 'Сотрудник отдела сбыта', '(123)555-0100', '(123)555-0102', 'None', '(123)555-0103', '1-й проспект, д. 12', 'Сочи', '(нет)', '999999', 'Россия', '#http://northwindtraders.com#', 'None', '')\ninsert into EMPLOYEES values (2, 'Борей', 'Гладких', 'Андрей', 'andrew@northwindtraders.com', 'Вице-президент', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '2-й проспект, д. 12', 'Томск', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Принят в компанию в качестве сотрудника отдела сбыта, затем назначен начальником отдела сбыта, в настоящее время занимает должность вице-президента по продажам.', '')\ninsert into EMPLOYEES values (3, 'Борей', 'Куликов', 'Евгений', 'evgeny@northwindtraders.com', 'Сотрудник отдела сбыта', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '3-й проспект, д. 12', 'Псков', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Прошел стажировку в отделе сбыта, в настоящее время является штатным сотрудником.', '')\ninsert into EMPLOYEES values (4, 'Борей', 'Сергиенко', 'Мария', 'mariya@northwindtraders.com', 'Сотрудник отдела сбыта', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '4-й проспект, д. 12', 'Самара', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'None', '')\ninsert into EMPLOYEES values (5, 'Борей', 'Новиков', 'Николай', 'nikolay@northwindtraders.com', 'Начальник отдела сбыта', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '5-й проспект, д. 12', 'Сочи', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Принят в компанию в качестве сотрудника отдела сбыта, затем назначен начальником отдела сбыта. Свободно владеет французским языком.', '')\ninsert into EMPLOYEES values (6, 'Борей', 'Корепин', 'Вадим', 'vadim@northwindtraders.com', 'Сотрудник отдела сбыта', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '6-й проспект, д. 12', 'Псков', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Свободно владеет японским языком, читает и пишеть на французском, португальском и испанском.', '')\ninsert into EMPLOYEES values (7, 'Борей', 'Климов', 'Сергей', 'sergey@northwindtraders.com', 'Сотрудник отдела сбыта', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '7-й проспект, д. 12', 'Сочи', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'None', '')\ninsert into EMPLOYEES values (8, 'Борей', 'Ожогина', 'Инна', 'inna@northwindtraders.com', 'Координатор продаж', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '8-й проспект, д. 12', 'Псков', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Читает и пишет по-французски.', '')\ninsert into EMPLOYEES values (9, 'Борей', 'Попкова', 'Дарья', 'darya@northwindtraders.com', 'Сотрудник отдела сбыта', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '9-я улица, д.12', 'Сочи', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Свободно владеет французским и немецким языком.', '')\n</code></pre>\n\n<p>P.S. In case of attempt to execute request in ibexpert</p>\n\n<pre><code> insert into EMPLOYEES values (1, 'Борей', 'Ильина', 'Юлия', 'julia@northwindtraders.com', 'Сотрудник отдела сбыта', '(123)555-0100', '(123)555-0102', 'None', '(123)555-0103', '1-й проспект, д. 12', 'Сочи', '(нет)', '999999', 'Россия', '#http://northwindtraders.com#', 'None', '')\n</code></pre>\n\n<p>I receive</p>\n\n<pre><code>can't format message 13:198 -- message file C:\\Windows\\firebird.msg not found.\narithmetic exception, numeric overflow, or string truncation.\nstring right truncation.\n</code></pre>\n\n<p>Also I had a question from where in</p>\n\n<pre><code>insert into EMPLOYEES values (2, 'Борей', 'Гладких', 'Андрей', 'andrew@northwindtraders.com', 'Вице-президент', '(123) 555-0100', '(123) 555-0102', 'None', '(123) 555-0103', '2-й проспект, д. 12', 'Томск', '(нет)', '999999', 'Россия', 'http://northwindtraders.com#http://northwindtraders.com/#', 'Принят в компанию в качестве сотрудника отдела сбыта, затем назначен начальником отдела сбыта, в настоящее время занимает должность вице-президента по продажам.', '')\n</code></pre>\n\n<p>there was a line</p>\n\n<pre><code>'http://northwindtraders.com#http://northwindtraders.com/#'\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>'http://northwindtraders.com'.\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13279666,"title":"how can I insert data in oracle AFTER a particular row that exist in the data table?","body":"<p>i have 10 rows of data in my table. now i want to insert a row of data just after the 9th data and before row 10..if am not mistaken ,in mysql db this thing is possible before there's a before and after clause, how bout in oracle ?</p>\n\n<p>here's my starting insert statement, let's say i want to insert it after the 9th data ,how?</p>\n\n<pre><code>INSERT INTO MYTABLE (TITLE,DESCRIPTION,STATUS) VALUES ('blahblah','descriptionblah',1);\n</code></pre>\n"},{"tags":["mysql","sql","database"],"answer_count":4,"favorite_count":4,"up_vote_count":34,"down_vote_count":0,"view_count":30733,"score":34,"question_id":5951157,"title":"MySQL 'IF' in 'SELECT' statement","body":"<pre><code>SELECT id, amount from report\n</code></pre>\n\n<p>I need <code>amount</code> to be <code>amount</code> if <code>report.type='P'</code> and <code>-amount</code> if <code>report.type='N'</code>. How do I add this to the above query?</p>\n"},{"tags":["php","mysql","sql","database","schema"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13282377,"title":"How to structure my database for game stats tracking?","body":"<p>I have been over this issue for the last year or so, changing what I am doing and trying different things. The issue is to do with the schema so I can still order nicely in player/clan ladders but if we want to add a stat later it won't lock our table changing every row due to one stat per column. </p>\n\n<p>I see two options for how to do this but both don't seem to be right. One is one stat per column. There would be 4 tables, user_stat_summary (for basic stats shown on ladders), user_stat_beast (teams are human vs beast), user_stat_human and user_stat_overall. Stats are shown everywhere from the last 30 days. A cron job will take any dated stats by getting a query on matches that happened after the 30 days and taking away those stats from the 3 main tables and putting them into the overall one. Matches will have blobs for the stats each player got for that match. The issue I see here is when we have a lot of rows that we can't easily add more stats when say the game changes a little. What I was thinking was a extra_stats blob column on each table and if we add new stats they simply aren't going to be sortable on the ladders. </p>\n\n<p>The other option is an EAV model which is what I have been playing around with but can't seem to get it right. I would be getting many more rows per query and then grouping them into users and the order would work for the most part but I couldn't get limits right for pagination since there was generally an unknown number of rows selected. </p>\n\n<p>What I was thinking is the EAV model with a table that stores ranks per stats which could be used for ordering. So the EAV tables are currently as follows...</p>\n\n<pre><code>CREATE TABLE `user_stat` (\n    `user_id` int(10) unsigned NOT NULL,\n    `stat_id` varchar(50) NOT NULL,\n    `value` int(10) unsigned NOT NULL,\n    PRIMARY KEY (`user_id`,`stat_id`),\n    CONSTRAINT `user` FOREIGN KEY (`user_id`) REFERENCES `xf_user` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\nCREATE TABLE `user_human_stat` (\n     `user_id` int(10) unsigned NOT NULL,\n     `stat_id` varchar(50) NOT NULL,\n     `value` int(10) unsigned NOT NULL,\n     PRIMARY KEY (`user_id`,`stat_id`),\n     CONSTRAINT `human_user` FOREIGN KEY (`user_id`) REFERENCES `xf_user` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\nCREATE TABLE `user_beast_stat` (\n     `user_id` int(10) unsigned NOT NULL,\n     `stat_id` varchar(50) NOT NULL,\n     `value` int(10) unsigned NOT NULL,\n     PRIMARY KEY (`user_id`,`stat_id`),\n     CONSTRAINT `beast_user` FOREIGN KEY (`user_id`) REFERENCES `xf_user` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\nCREATE TABLE `user_stat_overall` (\n     `user_id` int(10) unsigned NOT NULL,\n     `human` blob NOT NULL,\n     `beast` blob NOT NULL,\n     `total` blob NOT NULL,\n     PRIMARY KEY (`user_id`),\n     CONSTRAINT `user_overall` FOREIGN KEY (`user_id`) REFERENCES `xf_user` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>So I was thinking I could add a user_stat_rank table which would be user_id, stat_id, rank. Then say I want to get the first page of the ladder ordered by the 'kills' stat I could get all the user_ids order by rank where stat_id is kills. Then make a second query to populate all the users stats. </p>\n\n<p>After writing all this out it seems like it would work fine but I might not be seeing something. I also understand this question is all over the place so if you would like me to edit in details at places just say so.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13283361,"title":"Why is IFNULL() not working here","body":"<p>I'm checking if a column value is blank because I need to add 1 to it. This is actually a follow up of my question here</p>\n\n<p><a href=\"http://stackoverflow.com/questions/13282116/insert-into-table-select-maxcolumn-name1/13282214#13282214\">My Previous Question</a></p>\n\n<p>I'm doing </p>\n\n<pre><code>INSERT INTO posts (post_user_id, gen_id)  SELECT 1, IFNULL((MAX(gen_id)+1 FROM\nposts),0);\n</code></pre>\n\n<p>What's wrong here? </p>\n\n<p>I keep getting some kind of error.</p>\n"},{"tags":["sql","xml","variables","xslt","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13279400,"title":"Can we store SQL query in XSL variable","body":"<p>Can we store a SQL query in a xsl variable?</p>\n\n<pre><code>&lt;xsl:variable name=\"Query\" select=\"'SELECT X FROM ABC WHERE ID&gt;=2'\"/&gt;\n</code></pre>\n\n<p>If I write like that I am getting error for illegal '>' found,and I have tried another way like this</p>\n\n<pre><code> &lt;xsl:variable name=\"Query\" select=\"'SELECT X FROM ABC WHERE ID gt;=2'\"/&gt;\n</code></pre>\n\n<p>Then I am getting illegal '&gt;' element error...</p>\n\n<p>Please help me how to store a query in a variable.</p>\n\n<p>I am using a big query which involves joins and all SQL stuff..I facing the same issue please help me out..</p>\n"},{"tags":["php","sql","relational-database","entity-relationship"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":282,"score":2,"question_id":8558777,"title":"SQL Members table to show family relationships between members","body":"<p>I've been trying for days to design this database. I'm designing it in access then implementing on MYSQL Server as a PHP Web Application.</p>\n\n<p>I have a table:</p>\n\n<p><strong>Members</strong></p>\n\n<ul>\n<li>MemberID (autoNumber, PK) </li>\n<li>MemberName </li>\n<li>MemberDetails</li>\n</ul>\n\n<p>Members can have many relationships with other members, this may be Child, Parent, Friend, Spouse etc. Looking at one Member, I'd like to be able to create new relationships with existing members and then have that relationship also be visible from the related member without further input. Members should also be able to list all their relationships.</p>\n\n<p>Can you please advise how I should do this? I've tried a few options but none seem to work as intended. I'm comfortable with SQL, I'm just having trouble with the Unary relationship design.</p>\n\n<p>-edit-\nAlso, I forgot to add, this is not going to be able to use INNODB due to server restrictions. Most likely will be MYISAM, though i still want referential integrity :(</p>\n"},{"tags":["sql","replication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13278138,"title":"SQL Server MergeReplication with single GUID colum","body":"<p>i have an table which contains an single column, which is the Primary key, uniqueidentified, rowguid = true. if creating an merge replication, the Agent Fails to start with:</p>\n\n<p>\"The article includes only the rowguidcol column. You must publish at least one other column.\"</p>\n\n<p>is there any way to publish this table, without removing the rowguid and adding an second column?</p>\n\n<p>thx</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13266766,"title":"How can i skip extra rows in excel while importing it into database using SqlBulkCopy?","body":"<p>I am importing ExcelSheet into SQL server database, the problem I have is that the ExcelSheet has around 25 columns while the database table has 15 rows. I need to skip the extra unwanted rows in excel, e.g:</p>\n\n<pre><code>using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n{                  \n   bulkCopy.ColumnMappings.Add(\"PP NO\", \"passportnumber\");\n   bulkCopy.ColumnMappings.Add(\"COVER NO\", \"covernumber\");\n   bulkCopy.ColumnMappings.Add(\"NAME\", \"paxname\");\n   .....\n}\n</code></pre>\n\n<p>The error I am getting is \n<code>The given ColumnMapping does not match up with any column in the source or destination.</code></p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008-r2"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13274628,"title":"SQL Server - Count characters between two characters","body":"<p>How would one count the number of letters (alphabetically a to z or z to a) between two characters?</p>\n\n<p>For example:</p>\n\n<pre><code>WITH    ExampleData\n          AS ( SELECT   'a' AS StartChar, 'e' AS EndChar\n               UNION ALL\n               SELECT   'm', 'r'\n               UNION ALL\n               SELECT   'f', 'a'\n             )\n    SELECT  StartChar ,\n            EndChar\n    FROM    ExampleData\n</code></pre>\n\n<p>Would need to produce:</p>\n\n<pre><code>StartChar   EndChar    Diff\na           e          4\nm           r          5\nf           a          -5\n</code></pre>\n\n<p>I see how this could easily be done using udf's and a while loop but I was wondering if there was a faster way?</p>\n"},{"tags":["php","mysql","sql","image","image-processing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13282975,"title":"Filtering the images from source folder to another folder","body":"<p>I have one folder named SOURCE.  In that folder around 10,000 images are there.  The folder containing images of various category.  For a particular category the image names are stored in a table.  Now i want to copy all the images which belongs to particular category from that folder and then copy all those images into another folder.</p>\n\n<p>Say there is a table like this,</p>\n\n<pre><code>id  imagename\n1    abc_1\n2    abc_2\n3    abc_3\n4    abc_4\n5    abc_5\n</code></pre>\n\n<p>All those images are in the same source folder.  I need to run a query to filter this category images and copy all those to another folder.  In that particular category i have around 1500 Images.  I am working in PHP &amp; MYSQL Environment.  How to do this? Hope my question is clear.</p>\n\n<p>Thanks in Advance !!</p>\n"},{"tags":["sql","sql-server","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13276318,"title":"Returning not found values in query","body":"<p>I'm working on a project, and I have a list of several thousand records that I need check.  I need to provide the list of the ones NOT found, and provide the query I use to locate them so my superiors can check their work.</p>\n\n<p>I'll admit I'm relatively new to SQL. I don't have access to create temporary tables, which is one way I had thought of to do this.</p>\n\n<p>A basic idea of what I'm doing:</p>\n\n<pre><code>select t.column1, t.column2\nfrom table1 t\nwhere t.column1 in ('value1','value2','value3')\n</code></pre>\n\n<p>If value1 and value3 are in the database, but value2 is not, I need to display value2 and not the others.</p>\n\n<p>I have tried <code>ISNULL</code>, embedding the query, and trying to select <code>NOT</code> values from the query.  </p>\n\n<p>I have searched for returning records not found in a query on Google and on this site, and still found nothing.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":38,"score":0,"question_id":13269638,"title":"Custom Group By and place some records in one group","body":"<p>please consider data:</p>\n\n<pre><code> Id          Group            Value\n -----------------------------------\n 1            1                10\n 2            1                12\n 3            1                10\n 4            2                90\n 5            2                10\n 6            3                30\n 7            4                12\n 8            4                11\n 9            5                10\n 10           5                11\n</code></pre>\n\n<p>I want to do <code>Group By</code> on this data as <code>1,2,3</code> place in one group and <code>4,5</code> place in another group. How I can do this with <code>SQL Server</code>?</p>\n\n<p>thanks</p>\n\n<hr>\n\n<p><strong>Edit 1)</strong></p>\n\n<p>I want this result:</p>\n\n<pre><code>Groups                              Count\n-----------------------------------------\nGroup for 1,2,3                       6\nGroup for 4,5                         4\n</code></pre>\n"},{"tags":["sql","sql-server","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13282223,"title":"Using cast in SQL with multiple column selections","body":"<p>Basically I'd like to get this command to work:</p>\n\n<pre><code>$sql = \"SELECT (EntryDate + TotalTime) as DataLine FROM TimeSheet WHERE EmployeeID='AA01'\";\n</code></pre>\n\n<p>EntryDate is in the database as a text, but TotalTime is a Number. I need to cast TotalTime as a text, because I've noticed if I combine two differing types of values, it just blanks out the output. </p>\n\n<p>I know I'm supposed to use CAST(TotalTime as XXX) but I'm not sure what I can legally cast it to (char/nchar doesn't seem to work, neither does string nor text). I always get an error of the form...</p>\n\n<pre><code>Syntax error (missing operator) in query expression '(EntryDate + CAST(TotalTime as string) as DataLine FROM TimeSheet WHERE EmployeeID='AA01''\n</code></pre>\n\n<p>Could I get some help? Thank you!</p>\n\n<p><strong>EDIT</strong> I would like to note this isn't intended to add together the values of EntryDate and TotalTime together to produce a single value. I simply want it to give me the EntryDate value as well as the TotalTime value combined into a single line that would read something like:</p>\n\n<p>\"10/31/12 9.25\"</p>\n\n<p><strong>EDIT AGAIN</strong> I'm sorry for not specifying before, I'm using MSSQL</p>\n"},{"tags":["sql","query","dynamics-crm","dynamics-crm-2011","dynamic-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13273956,"title":"SQL Query in CRM Report","body":"<p>A \"Case\" in CRM has a field called \"Status\" with four options.  </p>\n\n<p>I'm trying to\n build a report in CRM that fills a table with every week of the year (each row is a different week), and then counts the number of cases that have each Status option (the columns would be each of the Status options).</p>\n\n<p>The table would look like this </p>\n\n<pre><code>         Status 1    Status 2    Status 3\nWeek 1       3         55          4\nWeek 2       5         23          5\nWeek 3       14        11          33\n</code></pre>\n\n<p>So far I have the following: </p>\n\n<pre><code>SELECT \n    SUM(case WHEN status = 1 then 1 else 0 end) Status1,\n    SUM(case WHEN status = 2 then 1 else 0 end) Status2,\n    SUM(case WHEN status = 3 then 1 else 0 end) Status3,\n    SUM(case WHEN status = 4 then 1 else 0 end) Status4,\n    SUM(case WHEN status = 5 then 1 else 0 end) Status5\nFROM [DB].[dbo].[Contact]\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   2         43          53\n</code></pre>\n\n<p>Now I need to somehow split this into 52 rows for the past year and filter these results by date (columns in the Contact table).  I'm a bit new to SQL queries and CRM - any help here would be much appreciated.  </p>\n\n<p>Here is a SQLFiddle with my progress and sample data: <a href=\"http://sqlfiddle.com/#!2/85b19/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/85b19/1</a></p>\n"},{"tags":["sql","spring","java-ee","callback","jdbctemplate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13268675,"title":"What's wrong with this data retrieval code?","body":"<p>I am new at Java EE and have written a piece of code to populate a List. But while debugging I have found that the Callback fuction is not getting executed and no data is being retrieved. Please Help.</p>\n\n<pre><code>public List&lt;VDRNote&gt; getStdVDRNotes()\n{\n     final List&lt;VDRNote&gt; notes=new ArrayList&lt;VDRNote&gt;();\n     String sql=\"Select NOTE_ID, NOTES from DCTM_VDR_STD_NOTES ORDER BY NOTE_ID ASC\";\n         RowCallbackHandler rch1=new RowCallbackHandler() {\n             public void processRow(ResultSet rs) throws SQLException\n             {\n                 VDRNote note=new VDRNote();\n                 note.setNoteId(rs.getInt(\"NOTE_ID\"));\n                 note.setNote(rs.getString(\"NOTES\"));\n                 notes.add(note);\n             }};\n         jdbcTemplate.query(sql,rch1);\n         return notes;\n}\n</code></pre>\n"},{"tags":["ios","sql","database","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13282272,"title":"SQLite DateTime columns accepting any value... normal?","body":"<p>I have an iOS app that takes use of SQLite. I use FireFox and the plugin SQLite Manager for managing the database.</p>\n\n<p>Now I have a table like this:</p>\n\n<pre><code>CREATE TABLE \"someTable\" (\"id\" INTEGER NOT NULL , \"timeOfEvent\" DATETIME NOT NULL)\n</code></pre>\n\n<p>I am however able to input practically any value I want into the DateTime column like so:</p>\n\n<pre><code>INSERT INTO sometable (id, timeOfEvent) VALUES (1,'2012-99-99')\nINSERT INTO sometable (id, timeOfEvent) VALUES (2,'yyyy-mm-dd')\n...etc\n</code></pre>\n\n<p>Why is this possible?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13282116,"title":"insert into table select max(column_name)+1","body":"<p>I have this mysql table built like this:</p>\n\n<pre><code>CREATE TABLE `posts` (\n    `post_id` INT(10) NOT NULL AUTO_INCREMENT,\n    `post_user_id` INT(10) NOT NULL DEFAULT '0',\n    `gen_id` INT(10) NOT NULL DEFAULT '0',\n    PRIMARY KEY (`post_user_id`, `post_id`)\n)\nCOLLATE='utf8_general_ci'\nENGINE=MyISAM;\n</code></pre>\n\n<p>When I do:</p>\n\n<pre><code>insert into posts (post_user_id) values (1);\ninsert into posts (post_user_id) values (1);\ninsert into posts (post_user_id) values (2);\ninsert into posts (post_user_id) values (1);\nselect * from posts;\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>post_id | post_user_id | gen_id\n1                  1     0\n2                  1     0\n1                  2     0\n3                  1     0\n</code></pre>\n\n<p>A unique post_id is generated for each unique user.</p>\n\n<p>I need the gen_id column to be 1 2 3 4 5 6 etc. How can I increment this column when I do an insert. I tried the one below, but it won't work. What's the right way to do this?</p>\n\n<pre><code>insert into posts (post_user_id,gen_id) values (1,select max(gen_id)+1 from posts);\n//Select the highest gen_id and add 1 to it.\n</code></pre>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":615,"score":2,"question_id":6611957,"title":"DefaultIfEmpty in LINQ-to-SQL join causing duplicates","body":"<p>Here is an extract of my query:</p>\n\n<pre><code>...\njoin p in dc.PODs on c.ID equals p.Consignment into pg\nfrom pgg in pg.DefaultIfEmpty()\n...\n</code></pre>\n\n<p>What the query should do is get all the 'PODs' associated with a consignment, store it as an IEnumerable object (which seems to work) so I can run through it when querying the main IEnumerable generated from the query. </p>\n\n<p>The problem is, I am getting duplicate main rows with the DefaultIfEmpty line, which only happens when a row has multiple PODs - so it's returning a row for each POD, which is incorrect. If I take out the pg.DefaultIfEmpty() line, it <em>seems</em> to work a bit better, but I still want to get the rows without PODs.</p>\n\n<p>Any ideas guys?</p>\n"},{"tags":["mysql","sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278741,"title":"Mysql MATCH AGAINST and IN","body":"<p>I need to search some data in my database. But main problem is that i search with match against:</p>\n\n<pre><code>...MATCH(description) AGAINST (\"*52*\" in boolean mode)\n</code></pre>\n\n<p>But on one iteration (or more, but with one query) i must search not only for 52, but for <code>50,51,52,...,59</code>  as before...\nBut is it real to do? \nAlso i do it with RoR:</p>\n\n<pre><code> @accums = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", size])\n</code></pre>\n\n<p>Or i will need to do iterator on rails, and search for all of them iteration by iteration?</p>\n"},{"tags":["sql","oracle"],"answer_count":8,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9783,"score":0,"question_id":5515514,"title":"How to get first and last day of week in Oracle?","body":"<p>I need to get the first day and the last day of the week from some strings that have the format like this:</p>\n\n<p>'201118' </p>\n\n<p>where 2011 is the year and 18 is the number of the week. Knowing the number of the week, how do I get the first and the last day of the week?</p>\n\n<p>How do I do this?</p>\n"},{"tags":["mysql","sql","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13280677,"title":"How to do a moving average on a range of dates in SQL?","body":"<p>Let's just say I have two columns, DATE and VALUE. The dates are not necessarily regularly spaced intervals. How can I create a moving average on VALUE over the past N days? I'm using postgres but mysql solutions would also be helpful.</p>\n\n<p>Data:</p>\n\n<pre><code>DATE    VALUE\n2012-11-05 10\n2012-10-29 31\n2012-10-22 108\n2012-10-17 3654\n2012-10-16 1187\n2012-10-15 12033\n2012-10-09 41\n2012-10-01 85\n2012-09-25 20\n2012-09-24 285\n2012-09-17 20\n2012-09-10 20\n2012-09-04 41\n2012-08-27 63\n2012-08-20 52\n2012-08-13 160\n</code></pre>\n"},{"tags":["php","sql","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13281099,"title":"Single Quotes in PDO Prepared Statments","body":"<p>I have always had issues with getting single quotes into PDO prepared statements. Here is what I have:  </p>\n\n<pre><code>$query2 = $dbh2-&gt;prepare(\"SELECT um.uploadID,\n\nselCol = CASE WHEN linkID = 1 THEN 'uploadDataMapID' ELSE 'uploadData' END\n\nFROM UploadMappings as um\");\n</code></pre>\n\n<p>When this is passed to SQL it ends up with ' 'uploadDataMapID' ' and ' 'uploadData' ' </p>\n\n<p>What is the best way to pass single quotes to MSSQL server using PDO prepared statements?</p>\n\n<p>Any help would be great.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13281693,"title":"Comparing number in formatted string in MySQL?","body":"<p>I have a <code>PolicyNo</code> column in my table in MySQL with a format like this:</p>\n\n<pre><code>XXXX-000000\n</code></pre>\n\n<p>A four capital-case <strong>characters</strong> followed by a <strong>dash</strong> and a six digit <strong>number</strong>.</p>\n\n<p>The six digit number is incremental, adding <code>1</code> for the next row, and the the four characters is always the same for all rows. The <code>PolicyNo</code> column is unique with a type of <code>varchar(11)</code>.</p>\n\n<p>If ordered, it will look like this:</p>\n\n<pre><code>XXXX-000001\nXXXX-000002\nXXXX-000003\n...\n</code></pre>\n\n<p>Now I want to get all <code>PolicyNo</code> whose number is greater than a specified number.</p>\n\n<p>For example: Retrieve all <code>PolicyNo</code> greater than <code>'XXXX-000100'</code>:</p>\n\n<pre><code>XXXX-000101\nXXXX-000102\nXXXX-000103\n...\n</code></pre>\n\n<p>I test this query and it works fine, but I just didn't know if it is really <em>safe</em> to do such:</p>\n\n<pre><code>SELECT  'XXXX-000099' &gt; 'XXXX-000098'\n    ,   'XXXX-000099' &gt; 'XXXX-000100'\n    ,   'XXXX-000099' &gt; 'XXXX-000101'\n\nResult:\n+-------------------------------+-------------------------------+-------------------------------+\n| 'XXXX-000099' &gt; 'XXXX-000098' | 'XXXX-000099' &gt; 'XXXX-000100' | 'XXXX-000099' &gt; 'XXXX-000101' |\n+-------------------------------+-------------------------------+-------------------------------+\n|                             1 |                             0 |                             0 |\n+-------------------------------+-------------------------------+-------------------------------+\n</code></pre>\n\n<p>Is there any other way to do this or is it already OK to use this?</p>\n"},{"tags":["sql","object","data","invalid","dbo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13281474,"title":"Invalid object name error while trying to populate table. (SOLVED)","body":"<p><strong>Found answer: I wasn't in create new query I was in create new database query which i assume are completely different. I assume thats why it wasn't recognizing the tables that were clearly there.</strong> </p>\n\n<p>I'm trying to load data into my tables but SQL wont recognize any of my tables, the error i get is invalid Data Object. I used a visio plugin Forwarded Engineer to create the tables from ERD diagrams, this is a sample SQL the plugin generated:</p>\n\n<pre><code>CREATE TABLE [dbo].[VEHICLE] (\n[VEH_ID] INTEGER  NOT NULL  \n, [VEH_YEAR] CHAR(10)  NOT NULL  \n, [VEH_MILAGE] NUMERIC(10,0)  NOT NULL  \n, [VEH_DESC] CHAR(10)  NULL  \n, [VEH_AC] BINARY(10)  NOT NULL  \n, [VEH_RADIO] BINARY(10)  NOT NULL  \n, [VEH_TYPE] BINARY(10)  NOT NULL  \n, [VEH_PRICE] DECIMAL  NOT NULL  \n, [COLOUR_ID] INTEGER  NOT NULL  \n, [CLASS_ID] INTEGER  NOT NULL  \n, [ORI_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[VEHICLE] ADD CONSTRAINT [VEHICLE_PK] PRIMARY KEY CLUSTERED (\n[VEH_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EMPLOYEE]') AND type in (N'U'))\n    DROP TABLE [dbo].[EMPLOYEE]\nGO\nCREATE TABLE [dbo].[EMPLOYEE] (\n[EMP_LNAME] CHAR(10)  NOT NULL  \n, [EMP_FNAME] CHAR(10)  NOT NULL  \n, [EMP_PHONE] CHAR(10)  NOT NULL  \n, [EMP_ID] INTEGER  NOT NULL  \n, [EMP_SALARY] NUMERIC(10,2)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[EMPLOYEE] ADD CONSTRAINT [EMPLOYEE_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CUSTOMER]') AND type in (N'U'))\n    DROP TABLE [dbo].[CUSTOMER]\nGO\nCREATE TABLE [dbo].[CUSTOMER] (\n[CUS_ID] INTEGER  NOT NULL  \n, [CUS_FNAME] CHAR(10)  NOT NULL  \n, [CUS_LNAME] CHAR(10)  NOT NULL  \n, [CUS_INITIAL] CHAR(10)  NULL  \n, [CUS_PHONE] CHAR(10)  NOT NULL  \n, [CUS_ADDRESS] CHAR(10)  NOT NULL  \n)\nGO\n\nCREATE TABLE CATS ( \nV_CODE      INTEGER PRIMARY KEY, \nV_NAME      VARCHAR(35) NOT NULL, \nV_CONTACT   VARCHAR(15) NOT NULL, \nV_AREACODE  CHAR(3) NOT NULL, \nV_PHONE     CHAR(8) NOT NULL, \nV_STATE     CHAR(2) NOT NULL, \nV_ORDER     CHAR(1) NOT NULL);\n\nALTER TABLE [dbo].[CUSTOMER] ADD CONSTRAINT [CUSTOMER_PK] PRIMARY KEY CLUSTERED (\n[CUS_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CLASS]') AND type in (N'U'))\n    DROP TABLE [dbo].[CLASS]\nGO\nCREATE TABLE [dbo].[CLASS] (\n[CLASS_ID] INTEGER  NOT NULL  \n, [CLASS_NAME] CHAR(10)  NOT NULL  \n, [CLASS_TYPE] CHAR(10)  NOT NULL  \n, [CLASS_DESC] CHAR(10)  NULL  \n, [CLASS_INV] CHAR(10)  NOT NULL  \n, [MODEL_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[CLASS] ADD CONSTRAINT [CLASS_PK] PRIMARY KEY CLUSTERED (\n[CLASS_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[COMMISSION]') AND type in (N'U'))\n    DROP TABLE [dbo].[COMMISSION]\nGO\nCREATE TABLE [dbo].[COMMISSION] (\n[COMM_ID] INTEGER  NOT NULL  \n, [COMM_Percentage] NUMERIC(2,0)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[COMMISSION] ADD CONSTRAINT [COMMISSION_PK] PRIMARY KEY CLUSTERED (\n[COMM_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[INVOICE]') AND type in (N'U'))\n    DROP TABLE [dbo].[INVOICE]\nGO\nCREATE TABLE [dbo].[INVOICE] (\n[EMP_ID] INTEGER  NOT NULL  \n, [CUS_ID] INTEGER  NOT NULL  \n, [WAR_ID] INTEGER  NOT NULL  \n, [INV_ID] INTEGER  NOT NULL  \n, [INV_DATE] DATETIME  NOT NULL  \n, [INV_PRICE] DECIMAL  NOT NULL  \n, [INV_TAX] DECIMAL  NOT NULL  \n, [INV_TOTAL] DECIMAL  NOT NULL  \n, [INV_NOTES] CHAR(10)  NULL  \n, [REP_ID] INTEGER  NULL  \n, [FIN_ID] INTEGER  NULL  \n)\nGO\n\nALTER TABLE [dbo].[INVOICE] ADD CONSTRAINT [INVOICE_PK] PRIMARY KEY CLUSTERED (\n[INV_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[COLOUR]') AND type in (N'U'))\n    DROP TABLE [dbo].[COLOUR]\nGO\nCREATE TABLE [dbo].[COLOUR] (\n[COLOUR_ID] INTEGER  NOT NULL  \n, [COLOUR_NAME] CHAR(10)  NULL  \n)\nGO\n\nALTER TABLE [dbo].[COLOUR] ADD CONSTRAINT [COLOUR_PK] PRIMARY KEY CLUSTERED (\n[COLOUR_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[WARRANTY]') AND type in (N'U'))\n    DROP TABLE [dbo].[WARRANTY]\nGO\nCREATE TABLE [dbo].[WARRANTY] (\n[WAR_ID] INTEGER  NOT NULL  \n, [WAR_TYPE] CHAR(10)  NOT NULL  \n, [WAR_TERM] CHAR(10)  NOT NULL  \n, [WAR_DESC] CHAR(10)  NULL  \n)\nGO\n\nALTER TABLE [dbo].[WARRANTY] ADD CONSTRAINT [WARRANTY_PK] PRIMARY KEY CLUSTERED (\n[WAR_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CAR_OWNERSHIP]') AND type in (N'U'))\n    DROP TABLE [dbo].[CAR_OWNERSHIP]\nGO\nCREATE TABLE [dbo].[CAR_OWNERSHIP] (\n[VEH_ID] INTEGER  NOT NULL  \n, [CUS_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[CAR_OWNERSHIP] ADD CONSTRAINT [CAR_OWNERSHIP_PK] PRIMARY KEY CLUSTERED (\n[CUS_ID]\n, [VEH_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ORIGIN]') AND type in (N'U'))\n    DROP TABLE [dbo].[ORIGIN]\nGO\nCREATE TABLE [dbo].[ORIGIN] (\n[ORI_ID] INTEGER  NOT NULL  \n, [ORI_NAME] CHAR(10)  NOT NULL  \n, [ORI_LOCATION] CHAR(10)  NULL  \n, [ORI_PHONE] CHAR(10)  NULL  \n, [ORI_DATE] DATETIME  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[ORIGIN] ADD CONSTRAINT [ORIGIN_PK] PRIMARY KEY CLUSTERED (\n[ORI_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FINANCING]') AND type in (N'U'))\n    DROP TABLE [dbo].[FINANCING]\nGO\nCREATE TABLE [dbo].[FINANCING] (\n[FIN_ID] INTEGER  NOT NULL  \n, [FIN_OPTION] CHAR(10)  NOT NULL  \n, [FIN_RATE] DECIMAL(10,4)  NOT NULL  \n, [FIN_LENGHT] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[FINANCING] ADD CONSTRAINT [FINANCING_PK] PRIMARY KEY CLUSTERED (\n[FIN_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ADMINISTRATOR]') AND type in (N'U'))\n    DROP TABLE [dbo].[ADMINISTRATOR]\nGO\nCREATE TABLE [dbo].[ADMINISTRATOR] (\n[EMP_ID] INTEGER  NOT NULL  \n, [QUALIFICATION] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[ADMINISTRATOR] ADD CONSTRAINT [ADMINISTRATOR_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REPAIRS]') AND type in (N'U'))\n    DROP TABLE [dbo].[REPAIRS]\nGO\nCREATE TABLE [dbo].[REPAIRS] (\n[REPAIR_DESC] CHAR(10)  NOT NULL  \n, [REPAIR_COST] DECIMAL  NOT NULL  \n, [REP_ID] INTEGER  NOT NULL  \n, [EMP_ID] INTEGER  NULL  \n)\nGO\n\nALTER TABLE [dbo].[REPAIRS] ADD CONSTRAINT [REPAIRS_PK] PRIMARY KEY CLUSTERED (\n[REP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TASK]') AND type in (N'U'))\n    DROP TABLE [dbo].[TASK]\nGO\nCREATE TABLE [dbo].[TASK] (\n[task_ID] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[TASK] ADD CONSTRAINT [TASK_PK] PRIMARY KEY CLUSTERED (\n[task_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SALESPERSON]') AND type in (N'U'))\n    DROP TABLE [dbo].[SALESPERSON]\nGO\nCREATE TABLE [dbo].[SALESPERSON] (\n[EMP_ID] INTEGER  NOT NULL  \n, [COMM_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[SALESPERSON] ADD CONSTRAINT [SALESPERSON_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MECHANIC]') AND type in (N'U'))\n    DROP TABLE [dbo].[MECHANIC]\nGO\nCREATE TABLE [dbo].[MECHANIC] (\n[EMP_ID] INTEGER  NOT NULL  \n, [LICENSE] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[MECHANIC] ADD CONSTRAINT [MECHANIC_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REPAIR_TASK]') AND type in (N'U'))\n    DROP TABLE [dbo].[REPAIR_TASK]\nGO\nCREATE TABLE [dbo].[REPAIR_TASK] (\n[REP_ID] INTEGER  NOT NULL  \n, [PART_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[REPAIR_TASK] ADD CONSTRAINT [REPAIR_TASK_PK] PRIMARY KEY CLUSTERED (\n[REP_ID]\n, [PART_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PARTS]') AND type in (N'U'))\n    DROP TABLE [dbo].[PARTS]\nGO\nCREATE TABLE [dbo].[PARTS] (\n[SUPP_ID] INTEGER  NOT NULL  \n, [PART_ID] INTEGER  NOT NULL  \n, [PART_NAME] CHAR(10)  NOT NULL  \n, [PART_DESC] CHAR(10)  NULL  \n, [VENDOR_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[PARTS] ADD CONSTRAINT [PARTS_PK] PRIMARY KEY CLUSTERED (\n[PART_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VENDOR]') AND type in (N'U'))\n    DROP TABLE [dbo].[VENDOR]\nGO\nCREATE TABLE [dbo].[VENDOR] (\n[VENDOR_ID] INTEGER  NOT NULL  \n, [VEN_NAME] CHAR(10)  NOT NULL  \n, [VEN_LOCATION] CHAR(10)  NOT NULL  \n, [VEN_PHONE] CHAR(10)  NOT NULL  \n, [VEN_ADDRESS] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[VENDOR] ADD CONSTRAINT [VENDOR_PK] PRIMARY KEY CLUSTERED (\n[VENDOR_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Table1]') AND type in (N'U'))\n    DROP TABLE [dbo].[Table1]\nGO\nCREATE TABLE [dbo].[Table1] (\n)\nGO\n\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CAR_BRAND]') AND type in (N'U'))\n    DROP TABLE [dbo].[CAR_BRAND]\nGO\nCREATE TABLE [dbo].[CAR_BRAND] (\n[BRAND_ID] INTEGER  NOT NULL  \n, [BRAND_NAME] CHAR(10)  NOT NULL  \n, [BRAND_COUNTRY] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[CAR_BRAND] ADD CONSTRAINT [CAR_BRAND_PK] PRIMARY KEY CLUSTERED (\n[BRAND_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CAR_MODEL]') AND type in (N'U'))\n    DROP TABLE [dbo].[CAR_MODEL]\nGO\nCREATE TABLE [dbo].[CAR_MODEL] (\n[BRAND_ID] INTEGER  NOT NULL  \n, [MODEL_ID] INTEGER  NOT NULL  \n, [MODEL_NAME] CHAR(10)  NOT NULL  \n, [MODEL_DESC] CHAR(10)  NULL  \n)\nGO\n\nALTER TABLE [dbo].[CAR_MODEL] ADD CONSTRAINT [CAR_MODEL_PK] PRIMARY KEY CLUSTERED (\n[MODEL_ID]\n)\nGO\nGO\n\nALTER TABLE [dbo].[VEHICLE] WITH CHECK ADD CONSTRAINT [ORIGIN_VEHICLE_FK1] FOREIGN KEY (\n[ORI_ID]\n)\nREFERENCES [dbo].[ORIGIN] (\n[ORI_ID]\n)\nALTER TABLE [dbo].[VEHICLE] WITH CHECK ADD CONSTRAINT [COLOUR_VEHICLE_FK1] FOREIGN KEY (\n[COLOUR_ID]\n)\nREFERENCES [dbo].[COLOUR] (\n[COLOUR_ID]\n)\nALTER TABLE [dbo].[VEHICLE] WITH CHECK ADD CONSTRAINT [CLASS_VEHICLE_FK1] FOREIGN KEY (\n[CLASS_ID]\n)\nREFERENCES [dbo].[CLASS] (\n[CLASS_ID]\n)\nGO\n\nGO\n\nGO\n\nALTER TABLE [dbo].[CLASS] WITH CHECK ADD CONSTRAINT [CAR_MODEL_CLASS_FK1] FOREIGN KEY (\n[MODEL_ID]\n)\nREFERENCES [dbo].[CAR_MODEL] (\n[MODEL_ID]\n)\nGO\n\nGO\n\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [REPAIRS_INVOICE_FK1] FOREIGN KEY (\n[REP_ID]\n)\nREFERENCES [dbo].[REPAIRS] (\n[REP_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [CUSTOMER_INVOICE_FK1] FOREIGN KEY (\n[CUS_ID]\n)\nREFERENCES [dbo].[CUSTOMER] (\n[CUS_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [WARRANTY_INVOICE_FK1] FOREIGN KEY (\n[WAR_ID]\n)\nREFERENCES [dbo].[WARRANTY] (\n[WAR_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [FINANCING_INVOICE_FK1] FOREIGN KEY (\n[FIN_ID]\n)\nREFERENCES [dbo].[FINANCING] (\n[FIN_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [SALESPERSON_INVOICE_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[SALESPERSON] (\n[EMP_ID]\n)\nGO\n\nGO\n\nGO\n\nALTER TABLE [dbo].[CAR_OWNERSHIP] WITH CHECK ADD CONSTRAINT [VEHICLE_CAR_OWNERSHIP_FK1] FOREIGN KEY (\n[VEH_ID]\n)\nREFERENCES [dbo].[VEHICLE] (\n[VEH_ID]\n)\nALTER TABLE [dbo].[CAR_OWNERSHIP] WITH CHECK ADD CONSTRAINT [CUSTOMER_CAR_OWNERSHIP_FK1] FOREIGN KEY (\n[CUS_ID]\n)\nREFERENCES [dbo].[CUSTOMER] (\n[CUS_ID]\n)\nGO\n\nGO\n\nGO\n\nALTER TABLE [dbo].[ADMINISTRATOR] WITH CHECK ADD CONSTRAINT [EMPLOYEE_ADMINISTRATOR_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[EMPLOYEE] (\n[EMP_ID]\n)\nGO\n\nALTER TABLE [dbo].[REPAIRS] WITH CHECK ADD CONSTRAINT [MECHANIC_REPAIRS_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[MECHANIC] (\n[EMP_ID]\n)\nGO\n\nGO\n\nALTER TABLE [dbo].[SALESPERSON] WITH CHECK ADD CONSTRAINT [COMMISSION_SALESPERSON_FK1] FOREIGN KEY (\n[COMM_ID]\n)\nREFERENCES [dbo].[COMMISSION] (\n[COMM_ID]\n)\nALTER TABLE [dbo].[SALESPERSON] WITH CHECK ADD CONSTRAINT [EMPLOYEE_SALESPERSON_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[EMPLOYEE] (\n[EMP_ID]\n)\nGO\n\nALTER TABLE [dbo].[MECHANIC] WITH CHECK ADD CONSTRAINT [EMPLOYEE_MECHANIC_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[EMPLOYEE] (\n[EMP_ID]\n)\nGO\n\nALTER \n</code></pre>\n\n<p>Here's what i wrote to load the tables, which is giving me errors.</p>\n\n<pre><code>/* LOAD EMPLOYEE DATA*/\nINSERT INTO dbo.EMPLOYEE VALUES ('ANDERSON','MIKE',6135796468,1,63768);\nINSERT INTO [dbo].[EMPLOYEE] VALUES ('STEVENS','JERRY',6139175631,2,83420);\nINSERT INTO [EMPLOYEE] VALUES ('ANDRES','GEORGE',6137909602,3,79999);\nINSERT INTO EMPLOYEE VALUES ('ANDRES','GEORGE',6137909602,3,79999);\n</code></pre>\n\n<p>I tried a few different naming conventions but nothing seemed to work. Sorry if the formatting here is incorrect, not used to it yet. </p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13281628,"title":"SELECT INTO local variable undeclared?","body":"<p>I have the following in an sql file I am executing...</p>\n\n<pre><code>DECLARE rowcount INT;\n\nSELECT COUNT(*) INTO rowcount\nFROM VRG_PROBLEM_ACCOUNT PA \nWHERE NEW.CustName = PA.CustNAME \nAND NEW.AreaCode = PA.AreaCode \nAND NEW.PhoneNumber = PA.PhoneNumber;\n</code></pre>\n\n<p>And yet I'm getting</p>\n\n<pre><code>ERROR 1327 (42000): Undeclared variable: rowcount\n</code></pre>\n\n<p>In another file I am doing the same type of SELECT...INTO localvariable and it works.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13277674,"title":"convert string to date in sql server","body":"<p>How do I convert <code>YYYY-MM-DD</code> (<code>2012-08-17</code>) to a date in SQL Server?</p>\n\n<p>I don't see this format listed on the help page: <a href=\"http://msdn.microsoft.com/en-us/library/ms187928.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms187928.aspx</a></p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13281277,"title":"SQL: How to get the original sorting when joining two tables","body":"<p>I have two tables</p>\n\n<p>The first looks like this:</p>\n\n<pre><code>Name|Sir Name|Adress\nMax1|Musterma|Muster Street\nMax2|Musterma|Muster Street\nMax3|Musterma|Muster Street\nMax4|Musterma|Muster Street\nMax5|Musterma|Muster Street\n</code></pre>\n\n<p>The second looks like this:</p>\n\n<pre><code>Name|Money\nMax3|50.00\nMax1|40.00\nMax3|43.00\nMax2|77.00\nMax3|18.00\nMax1|97.00\nMax1|87.00\n</code></pre>\n\n<p>I want to use Left Join and make an Output like this:</p>\n\n<pre><code>Max1|Musterma|Muster Street|40.00\nMax1|Musterma|Muster Street|97.00\nMax1|Musterma|Muster Street|87.00\nMax2|Musterma|Muster Street|77.00\nMax3|Musterma|Muster Street|50.00\nMax3|Musterma|Muster Street|43.00\nMax3|Musterma|Muster Street|18.00\nMax4|Musterma|Muster Street|\nMax5|Musterma|Muster Street|\n</code></pre>\n\n<p>What I get is like:</p>\n\n<pre><code>Max3|Musterma|Muster Street|50.00\nMax1|Musterma|Muster Street|40.00\nMax3|Musterma|Muster Street|43.00\nMax2|Musterma|Muster Street|77.00\nMax3|Musterma|Muster Street|18.00\nMax1|Musterma|Muster Street|97.00\nMax1|Musterma|Muster Street|87.00\nMax4|Musterma|Muster Street|\nMax5|Musterma|Muster Street|\n</code></pre>\n\n<p>What I get is sorted after the position of the entries of the second (right) table.</p>\n\n<p>But I want to get the list sorted</p>\n\n<ol>\n<li>after the position of the user in the first</li>\n<li>after the position of the money in the second</li>\n</ol>\n\n<p>Can anyone tell me what i further have to write?</p>\n"},{"tags":["sql","oracle"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":33925,"score":5,"question_id":1766445,"title":"Oracle: how to set user password unexpire?","body":"<p>There is some construction</p>\n\n<pre><code>ALTER USER scott PASSWORD EXPIRE\n</code></pre>\n\n<p>But how can I similair set password to unexpired state?</p>\n"},{"tags":["sql","wordpress"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13267446,"title":"wordpress get_results($sql, ARRAY_A) query comments has duplicate comment","body":"<p>When using <code>get_results($sql, ARRAY_A)</code> to query wp_comments, there is a comment in the result.</p>\n\n<p>The sql is below</p>\n\n<pre><code>SELECT comment_ID,comment_parent,comment_author,comment_author_url,comment_author_email,comment_content,comment_date,comment_type,ck_rating_up,ck_rating_down \nFROM $wpdb-&gt;comments \nLEFT JOIN $comment_rating_table \nON ($wpdb-&gt;comments.comment_ID = $comment_rating_table.ck_comment_id) \nWHERE comment_post_ID = $post_id AND comment_approved = 1 \norder by comment_id ASC\n</code></pre>\n\n<p>How to avoid duplicate comments?</p>\n"},{"tags":["mysql","sql","innodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13279681,"title":"innoDB - should i turn innodb_flush_log_at_trx_commit off?","body":"<p>I have a database table that has 100s of thousands of rows. Entering a new row or updating a row takes a little bit of time. To do 50 updates (in the format of 'update table set field = 1234 where id = 5678; update table set field = 912 where id = 582; ...') it can take 4 or 5 seconds.</p>\n\n<p>How can i reduce this time? Is it worth playing with the innodb_flush_log_at_trx_commit setting? How can I set that setting just for certain connections/queries?</p>\n\n<p>Is it safe to play with innodb_flush_log_at_trx_commit? The data isn't important, as long as one copy (either before the UPDATE command or after) is in tact (it is only setting some somewhat random data updates... no important data gets changed in these queries)</p>\n\n<p>the bulk of the queries on this tables are SELECTS so that is why i use innodb.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","ruby-on-rails","database","performance","postgresql"],"answer_count":2,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":933,"score":17,"question_id":9407442,"title":"Optimise PostgreSQL for fast testing","body":"<p>I am switching to PostgreSQL from SQLite for a typical Rails application.</p>\n\n<p>The problem is that running specs became slow with PG.<br>\nOn SQLite it took ~34 seconds, on PG it's ~76 seconds which is <strong>more than 2x slower</strong>.</p>\n\n<p>So now I want to apply some techniques to <strong>bring the performance of the specs on par with SQLite</strong> with no code modifications (ideally just by setting the connection options, which is probably not possible).</p>\n\n<p>Couple of obvious things from top of my head are:</p>\n\n<ul>\n<li>RAM Disk (good setup with RSpec on OSX would be good to see)</li>\n<li>Unlogged tables (can it be applied on the whole database so I don't have change all the scripts?)</li>\n</ul>\n\n<p>As you may have understood I don't care about reliability and the rest (the DB is just a throwaway thingy here).<br>\nI need to get the most out of the PG and make it <strong>as fast as it can possibly be</strong>.</p>\n\n<p><strong>Best answer</strong> would ideally describe the <em>tricks</em> for doing just that, setup and the drawbacks of those tricks.</p>\n\n<p><strong>UPDATE:</strong> <code>fsync = off</code> + <code>full_page_writes = off</code> only decreased time to ~65 seconds (~-16 secs). Good start, but far from the target of 34.</p>\n\n<p><strong>UPDATE 2:</strong> I <a href=\"https://gist.github.com/1573414\">tried to use RAM disk</a> but the performance gain was within an error margin. So doesn't seem to be worth it.</p>\n\n<p><strong>UPDATE 3:*</strong>\nI found the biggest bottleneck and now my specs run as fast as the SQLite ones.</p>\n\n<p>The issue was the database cleanup that did the <strong>truncation</strong>. Apparently SQLite is way too fast there.</p>\n\n<p>To \"fix\" it I open a <strong>transaction</strong> before each test and roll it back at the end.</p>\n\n<p>Some numbers for ~700 tests.</p>\n\n<ul>\n<li>Truncation: SQLite - 34s, PG - 76s.</li>\n<li>Transaction: SQLite - 17s, PG - 18s.</li>\n</ul>\n\n<p>2x speed increase for SQLite.\n4x speed increase for PG.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13278058,"title":"SQL Server LIKE on datepart doesnt work for the time element","body":"<p>I am trying to return rows in my table that have a certain date but also a certain hour.</p>\n\n<p>At the moment I can handle the date part of the query just fine by using:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05%' \n</code></pre>\n\n<p>That works perfectly and returns all rows where col1 has a value of the 5th November. However when I also want to add the hour to the end like this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05 15%' \n</code></pre>\n\n<p>That query returns no rows, even though there are rows with the hour set to 15.</p>\n\n<p>It looks like the time element of the query needs some kind of different syntax? I just wondered if anyone can confirm this?</p>\n"},{"tags":["mysql","sql","arrays","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13280875,"title":"JOIN on array of ids in sql","body":"<p>I have three tables:\nTABLE 1 contracts</p>\n\n<pre><code>-------------------\nid  |  contract_name\n--------------------\n1      test name\n2      test name 2\n2      test name 3\n4      test name 4\n</code></pre>\n\n<p>TABLE 2 rooms</p>\n\n<pre><code>-------------------\nid  |  room_name\n--------------------\n1      test name\n2      test name 2\n2      test name 3\n4      test name 4\n</code></pre>\n\n<p>TABLE 3 promos</p>\n\n<pre><code>    ----------------------------------\n    id  |  contracts_id  |   rooms_id\n    ----------------------------------\n    1          1,3            1,3,4\n    1          2              1,2,3\n</code></pre>\n\n<p>No I am trying to do an inner join to get the names of the contract and the rooms according to the ids in the array saved in database. I know this is not ideal at all, but I can not change the database set up. So here is what I would like to do with my query, but obviously it is impossible. Does anyone have any idea on how I can accomplish this?</p>\n\n<pre><code>mysql_query(\"SELECT pb.*, c.contract_name, r.room_name FROM promo_blackouts AS pb\nINNER JOIN contracts as c ON c.contract_id IS IN pb.contracts_id\nINNER JOIN rooms as r ON r.room_id IS IN pb.rooms_id \nWHERE pb.promo_id = '$promo_id'\") or die(mysql_error());\n</code></pre>\n"},{"tags":["sql","postgresql","cpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13280769,"title":"postgreSQL join gives error","body":"<p>This join is </p>\n\n<pre><code>SELECT \ns.id,\ns.sector_abbr,\ns.sector_desc,\nl.id,\nl.sector_id,\nl.vendor_address_id\nFROM sectors s\nLEFT JOIN sector_vendor_address_link l\nON s.id = l.sector_id\n</code></pre>\n\n<p>is giving me this error</p>\n\n<p><code>ERROR: ERROR: permission denied for relation sector_vendor_address_link</code></p>\n\n<p>Using this id and password through razorSQL, I was able to do updates to these same tables, so I can't imagine it is a permissions problem. Perhaps I am wrong. Is my join just malformed?</p>\n\n<p>Thanks!</p>\n\n<p>EDIT:</p>\n\n<p>It seems that I must manually set All privileges for each table. Is there any way using phpPgAdmin to globally set a users permission for the entire database?</p>\n"},{"tags":["php","sql","flex","mobile-application"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":33,"score":-3,"question_id":13280729,"title":"Need various help building a flex mobile application that connects to a database","body":"<p>Need various help building a flex mobile application that connects to a database.  </p>\n\n<p>I know that I can ask my questions here, but the thing is I have a deadline ( :( ) and some of my questions are not being answered... don't get me wrong I DO appreciate your help and I know I should do  a lot myself. is there a place where I can ask for help from someone... for a small amount of money (I wish I was rich but I am not)</p>\n"},{"tags":["sql","sql-server","sql-server-2008","hierarchical-data"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13280265,"title":"Flattening a SQL hierarchical data structure in SQL without cursors","body":"<p>Let's say I have the following table</p>\n\n<pre><code>SectionID ParentIDSection DatumID\n   1           NULL         1\n   2            1           2\n   3            1           3\n   4            2           4\n</code></pre>\n\n<p>Now, let's  pretend I want to select all DatumIDs under SectionID = 1, even if it is part of its descendants children so that I would get</p>\n\n<pre><code>SectionID DatumID\n  1         1\n  1         2\n  1         3\n  1         4\n</code></pre>\n\n<p>Is it possible to this without explicitly iterating over the first table recursively with a cursor?</p>\n"},{"tags":["sql","sql-server","performance","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13280548,"title":"Performance issue in retrieving multiple output of the same column with different values from a single table","body":"<p>is there anyway to get the following results from query without joining the same table three times (or) without reading the same \"wordlocation\" table three times (or more if there are more words)? If there are three or more words, it takes about over a minute for the results to be returned.</p>\n\n<p>Currently \"wordlocation\" table has three rows being (\"bookid\",\"wordid\",\"location\") and it currently has 917802 rows.</p>\n\n<p>What I am trying to do is </p>\n\n<ol>\n<li>retrieve the \"bookid\" that contains all the words specified in the query by \"wordid\".</li>\n<li>sum word count of all words (from the query) from each book</li>\n<li>minimum values of each word location, e.g. (min(w0.location), min (w1.location)</li>\n</ol>\n\n<p>I have tried commenting out count(w0.wordid) and min(location) calculations to see whether they are affecting the performance but this is not the case. Joining the same table multiple time was the case.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SYLB7.jpg\" alt=\"enter image description here\"></p>\n\n<p>(this is the same code as the above image)   </p>\n\n<pre><code>select \n    w0.bookid, \n    count(w0.wordid) as wcount, \n    abs(min(w0.location) + min(w1.location) + min(w2.location)) as wordlocation, \n    (abs(min(w0.location) - min(w1.location)) + abs(min(w1.location) - min(w2.location))) as distance \n    from \n    wordlocation as w0 \n    inner join \n    wordlocation as w1 on w0.bookid = w1.bookid \n    join \n    wordlocation as w2 on w1.bookid = w2.bookid \n    where \n    w0.wordid =3 \n    and \n    w1.wordid =52 \n    and \n    w2.wordid =42\n    group by w0.bookid \n    order by wcount desc;\n</code></pre>\n\n<p>This is the result that I am looking for, and which I got from running the above query, but it takes too long if I specify more than 3 words, e.g. (w0 = 3, w1 = 52 , w2 = 42, w3 = 71)</p>\n\n<p><img src=\"http://i.stack.imgur.com/08dD5.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","datanucleus","jdoql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13168112,"title":"JDOQL: How to execute \"CREATE USER\"?","body":"<p>I'm trying to create a USER (in this case using a H2 database) using JDOQL in DataNucleus</p>\n\n<pre><code>PersistenceManager pm=pmf.getPersistenceManager();\nQuery query = pm.newQuery(\"javax.jdo.query.SQL\", \"CREATE USER GUEST PASSWORD 'abc'\");\nquery.execute();\n</code></pre>\n\n<p>result: <strong>org.h2.jdbc.JdbcSQLException: Method is only allowed for a query. Use execute or executeUpdate instead of executeQuery</strong>;</p>\n\n<p>How can i execute this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13279901,"title":"Grouping by Week in SQL, but displaying full datetime?","body":"<p>the following statement: </p>\n\n<pre><code>group by datepart(wk, createdon)\n</code></pre>\n\n<p>Groups the selected rows according to the week in which they fall.  My select statement shows the following: </p>\n\n<pre><code>SELECT \n    datepart(wk, createdon) week,\n</code></pre>\n\n<p>How do I display the actual datetime of the week(\"12-10-2012\"), instead of the number (\"12\")?</p>\n"},{"tags":["python","sql","query","sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13271894,"title":"Interfacing with Sqlalchemy query object to extend, custom query types","body":"<p>I'm working on adding pagination functionality to my models. I could do this with a method in a mixin, I think I understand what pagination is in this context, but I'm looking to add queries so I can pass in pagination wherever I want without hard coding a model method and without a mixin e.g.:</p>\n\n<pre><code>Mymodel.query.filter(Mymodel.attr=='X').paginate(**args, **kwargs)\n</code></pre>\n\n<p>flask-sqlalchemy does this, but I'm not using that, though I've gone over it to attempt to extract some of the functionality.</p>\n\n<p>So if I have something like this method:</p>\n\n<pre><code>def paginate(self, page, per_page=20):\n        items = self.limit(per_page).offset((page - 1) * per_page).all()\n        return Pagination(self, page, per_page, self.count(), items)\n</code></pre>\n\n<p>How do I insert that as something with an interface in and out in the sqlalchemy query chain? I somewhat do and don't follow how it is being done in flask-sqlalchemy, but I want to extract/learn how to do this and more control over querying in the future, refine my use of sqlalchemy, so I do not exactly know where I'm going with it, just asking a question and going from there.</p>\n\n<p>Long answer: to keep reading the sqlalchemy docs and code until I achieve greater understanding. I'm looking to extend orm.Query -- which I've done, but I don't see how I can tie this into my project yet because I don't understand the underlying mechanics of sqlalchemy, but I think I just need to add my paginate query to the declarative base Base I'm using but will see once I get back to working on it. </p>\n"},{"tags":["sql","database","sqlite","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13280165,"title":"SQLite3 do a SELECT, order by multiple cross-table columns","body":"<p>I'm trying to produce a \"history/logs page\" out of 3 tables, tables looks like this:</p>\n\n<h2>TableA</h2>\n\n<pre><code>CreationDate\nModifDate\nLastAccessedDate\nFileName\n</code></pre>\n\n<h2>TableB</h2>\n\n<pre><code>Guid_TableA\nCreationDate\nModifDate\nLastAccessedDate\nFileName\n</code></pre>\n\n<h2>TableC</h2>\n\n<pre><code>Guid_TableA\nLastModifDate\nFileName\n</code></pre>\n\n<p>FWIW, despite the similarities in columns names, <strong>there's no relation between dates in these tables</strong>. The only valid column that related between them is <strong>Guid_TableA</strong></p>\n\n<h2>What I want is...</h2>\n\n<p>Select records &amp; order them by date. <strong>I'm trying to build an event log, so returning duplicated entries like this is valid</strong> (as long as results are ordered correctly by dates)</p>\n\n<pre><code>(TableA)  file-1.txt    '01/01/2012 00:00:00' (CreationDate)\n(TableA)  file-1.txt    '01/01/2012 00:00:01' (ModifDate)\n(TableB)  file-2.txt    '01/01/2012 00:00:02' (CreationDate)\n(TableA)  file-1.txt    '01/01/2012 00:00:03' (LastAccessedDate)\n</code></pre>\n\n<p>Hopefully my intention is clear; I basically want to select records ordered by date (that is, ordered against multiple cross-tables columns, <strong>including duplicated entries</strong>)</p>\n\n<p><strong>My question is:</strong> Is this possible? If so, how?</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13280164,"title":"MySQL: Column count doesn't match value count at row 1","body":"<p>I apologise for the lengthy code, but I am trying to create an audit table (called aud_candles) which is a duplicate of 'candles' but with a new unique key, aud_can_id.  Before an update takes place on 'candles', I want the trigger to save the current state of that row in 'aud_candles'.</p>\n\n<pre><code>Target Server Type    : MySQL\nTarget Server Version : 50165\nFile Encoding         : utf-8\n\nDate: 11/07/2012 23:05:38 PM\n*/\n\nSET NAMES utf8;\nSET FOREIGN_KEY_CHECKS = 0;\n\n-- ----------------------------\n--  Table structure for `candles`\n-- ----------------------------\nDROP TABLE IF EXISTS `candles`;\nCREATE TABLE `candles` (\n  `can_id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `can_name` varchar(255) NOT NULL,\n  `can_description` varchar(1024) NOT NULL,\n  `can_dye_id` int(10) unsigned NOT NULL,\n  `can_snt_id` int(10) unsigned NOT NULL,\n  `can_wick_id` int(10) unsigned NOT NULL,\n  `can_wax_id` int(10) unsigned NOT NULL,\n  `can_retail_cost` float(10,2) NOT NULL,\n  `can_materials_cost` float(10,2) NOT NULL,\n  `can_dye_used` float(10,2) NOT NULL,\n  `can_snt_used` float(10,2) NOT NULL,\n  `can_wick_used` float(10,2) NOT NULL,\n  `can_wax_used` float(10,2) NOT NULL,\n  `can_updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`can_id`),\n  KEY `idx_candles_dyes_id` (`can_dye_id`) USING BTREE,\n  KEY `idx_candles_scents_id` (`can_snt_id`) USING BTREE,\n  KEY `idx_candles_wax_id` (`can_wax_id`) USING BTREE,\n  KEY `fk_candles_wick_id` (`can_wick_id`),\n  CONSTRAINT `fk_candles_dye_id` FOREIGN KEY (`can_dye_id`) REFERENCES `dyes` (`dye_id`),\n  CONSTRAINT `fk_candles_scent_id` FOREIGN KEY (`can_snt_id`) REFERENCES `scents` (`snt_id`),\n  CONSTRAINT `fk_candles_wax_id` FOREIGN KEY (`can_wax_id`) REFERENCES `wax` (`wax_id`),\n  CONSTRAINT `fk_candles_wick_id` FOREIGN KEY (`can_wick_id`) REFERENCES `wicks` (`wic_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;\n\ndelimiter ;;\nCREATE TRIGGER `trg_audit_update_candles` BEFORE UPDATE ON `candles` FOR EACH ROW BEGIN  \n    INSERT INTO aud_candles \n(can_id, \ncan_name, \ncan_description, \ncan_dye_id, \ncan_snt_id, \ncan_wick_id, \ncan_wax_id, \ncan_materials_cost, \ncan_retail_cost,\ncan_updated)  \n    VALUES \n(OLD.can_id, \nOLD.can_name, \nOLD.can_description, \nOLD.can_dye_id, \nOLD.can_snt_id, \nOLD,can_wick_id, \nOLD.can_wax_id, \nOLD.can_materials_cost, \nOLD.can_retail_cost,\nOLD.can_updated);  \nEND;\n ;;\ndelimiter ;\n\n-- ----------------------------\n--  Records of `candles`\n-- ----------------------------\nBEGIN;\nINSERT INTO `candles` VALUES ('1', 'Test Name', 'Test Description', '12', '10', '102', '1', '0.00', '0.00', '5', '25.00', '15.00', '500.00', '2012-11-07 13:29:02');\nCOMMIT;\n\n\nDROP TABLE IF EXISTS `aud_candles`;\nCREATE TABLE `aud_candles` (\n  `aud_can_id` int(11) NOT NULL AUTO_INCREMENT,\n  `can_id` int(10) unsigned NOT NULL,\n  `can_name` varchar(255) CHARACTER SET latin1 NOT NULL,\n  `can_description` varchar(1024) CHARACTER SET latin1 NOT NULL,\n  `can_dye_id` int(10) unsigned NOT NULL,\n  `can_snt_id` int(10) unsigned NOT NULL,\n  `can_wick_id` int(10) unsigned NOT NULL,\n  `can_wax_id` int(10) unsigned NOT NULL,\n  `can_retail_cost` float(10,2) NOT NULL,\n  `can_materials_cost` float(10,2) NOT NULL,\n  `can_dye_used` float(10,2) NOT NULL,\n  `can_snt_used` float(10,2) NOT NULL,\n  `can_wick_used` float(10,2) NOT NULL,\n  `can_wax_used` float(10,2) NOT NULL,\n  PRIMARY KEY (`aud_can_id`),\n  KEY `idx_candles_dyes_id` (`can_dye_id`) USING BTREE,\n  KEY `idx_candles_scents_id` (`can_snt_id`) USING BTREE,\n  KEY `idx_candles_wax_id` (`can_wax_id`) USING BTREE,\n  KEY `fk_candles_wick_id` (`can_wick_id`),\n  CONSTRAINT `fk_aud_candles_dye_id` FOREIGN KEY (`can_dye_id`) REFERENCES `dyes` (`dye_id`),\n  CONSTRAINT `fk_aud_candles_scent_id` FOREIGN KEY (`can_snt_id`) REFERENCES `scents` (`snt_id`),\n  CONSTRAINT `fk_aud_candles_wax_id` FOREIGN KEY (`can_wax_id`) REFERENCES `wax` (`wax_id`),\n  CONSTRAINT `fk_aud_candles_wick_id` FOREIGN KEY (`can_wick_id`) REFERENCES `wicks` (`wic_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\n\n\n\nSET FOREIGN_KEY_CHECKS = 1;\n\nUPDATE candles set can_name = 'Test Name 2' WHERE can_id = 1;\n</code></pre>\n\n<p>When performing the update I receive:</p>\n\n<p>Error</p>\n\n<blockquote>\n  <p>Column count doesn't match value count at row 1</p>\n</blockquote>\n\n<p>If I remove the trigger everything works fine, so it must be related to the trigger?</p>\n"},{"tags":["java","sql","el","predicate","lambdaj"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":112,"score":4,"question_id":13237998,"title":"Is there a Java library for defining predicates as SQL-like strings?","body":"<p>Lambdaj (and some other similar libraries) provides a <code>having</code> function which allows me to define predicates like so (example directly from the <a href=\"http://code.google.com/p/lambdaj/wiki/LambdajFeatures\" rel=\"nofollow\">lambdaj Features</a> page):</p>\n\n<pre><code>List&lt;Person&gt; oldFriends = \n    filter(having(on(Person.class).getAge(), greaterThan(30)), meAndMyFriends);\n</code></pre>\n\n<p>I'd quite like to be able to define my Java predicate object using a straightforward string syntax, <code>\"age &gt; 30\"</code> - similar to a SQL where clause - so the filter above becomes something like:</p>\n\n<pre><code>List&lt;Person&gt; oldFriends = \n    filter(having(Person.class, \"age &gt; 30\"), meAndMyFriends);\n</code></pre>\n\n<p>Does such a library exist, or can anyone recommend some building blocks for the query parsing part I could use to build one myself? I don't actually mind what kind of predicate (hamcrest, guava etc) it creates.</p>\n\n<p>Off the top of my head I can think of a number of things it would be awesome for it to support: equalities and inequalities, on custom and primitive types, and/or/not, parentheses, <code>LIKE</code> (for Strings), <code>in(...)</code>, interpretiation of enum names, properties of properties.</p>\n\n<p>Here's an example of a more complex predicate:</p>\n\n<pre><code>\"salesCount &gt; 10 and (country='UK' or city='New York')\nand attitude not in (MENACING, RUDE)\nand product.name &lt;&gt; 'Widget' \"\n</code></pre>\n\n<p>(This example assumes that the class the predicate is applied to (say a <code>SalesPerson</code> class) has methods getSalesCount(), getCountry(), and getCity(), as well as getAttitude() (which returns an enum). It also has a property getProduct which returns a type with method getName). </p>\n\n<p><strong>Motivation</strong>: we have a client-server system that has multiple language APIs (currently Java &amp; C#); I'm looking for a language-agnostic way for a user to specify a predicate that filters on a set of objects the exact contents of which are known only to the server process (which is written in Java).</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":277,"score":0,"question_id":7471131,"title":"copy table from one database to another, maintaining table's structure and renaming it too","body":"<p>I want to copy a table (say tbl_1) from one database (say source_db) to another database (say target_db), with <strong>following things in consideration</strong>:</p>\n\n<ul>\n<li><p>Structure of table should be preserved, including primary key and\nauto-increment key</p></li>\n<li><p>While creating a copy of tbl_1, I need to rename it to cpy_tbl_1</p></li>\n</ul>\n\n<p>How it is possible <strong>using query</strong>?</p>\n\n<p>P.S. I know there will be many similar questions like mine, but I have those special considerations too.</p>\n"},{"tags":["java","sql","spring-jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":7695445,"title":"spring-jdbc for IN query having more than 1000 ids","body":"<p>I have a query like this -</p>\n\n<pre><code>SELECT * FROM mytable WHERE id IN()\n</code></pre>\n\n<p>The IN will get list of ids which are more than <code>1000</code>. So my query fails on Oracle.</p>\n\n<p>One option is that I insert the ids in a temp table and change the above query to join with this new table.</p>\n\n<p>Does spring-jdbc provides anything to solve this? Is there any pattern I can follow to write my DAO?</p>\n"},{"tags":["sql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13279685,"title":"Joining SQL tables on the column that has a value","body":"<p>Let's say I have the following tables</p>\n\n<pre><code>Collection DirectorId StudioId\n   1             NULL      1\n   2             2         NULL\n   3             NULL      2\n\n\nDirector MovieId\n  1        1\n  2        4\n\nStudio   MovieId\n  1        1\n  2        3\n  2        4\n  1        2\n</code></pre>\n\n<p>The collection table will always have either director or studio id but never both.</p>\n\n<p>How could I write a query to get all the movies in one a collection so that I end up with</p>\n\n<pre><code>CollectionID MovieID\n1            1\n1            2\n2            4\n3            3\n3            4\n</code></pre>\n\n<p>I hope this makes sense</p>\n"},{"tags":["sql","oracle","plsql","plsqldeveloper"],"answer_count":6,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1964,"score":0,"question_id":11003918,"title":"Oracle Convert Seconds to Hours:Minutes:Seconds","body":"<p>I have a requirement to display user available time in Hours:Minutes:Seconds format from a given total number of seconds value. Appreciate if you know a ORACLE function to do the same. I'm using Oracle.</p>\n\n<p>Thank you for your time.</p>\n"},{"tags":["php","mysql","sql","mysqli","mysql-num-rows"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13279248,"title":"mysqli_num_rows = 0 when it should be 1","body":"<p>I've been trying to resolve this problem on my own and for the life of me can't fix it..</p>\n\n<pre><code>//If they are, retreive them from the Person table    \nvar_dump($_POST['username']);\nvar_dump($_POST['password']);\n$select = $this-&gt; doQuery(\"SELECT * FROM Person WHERE username = '{$_POST['username']}' AND password = '\".md5($_POST['password']).\"'\");\nvar_dump($select);  \n\ntry {    \n    if (mysqli_num_rows($select) &gt; 0){\n        var_dump(mysqli_num_rows($select));\n        //fetching username and password from database\n        $fetch_array = mysqli_fetch_assoc($select);\n        var_dump($fetch_array);     \n        //Building a session for the user\n        $_SESSION['username'] = $fetch_array['username'];\n\n        //var_dump($_SESSION['username']);\n\n        //Redirecting the user to the index page        \n        header('Location:index.php');\n        return true;\n    }\n</code></pre>\n\n<p>The two var_dumps on the username and password on the 4th and 5th lines returned this: </p>\n\n<pre><code>string(8) \"johnny03\" \nstring(9) \"password3\" \nobject(mysqli_result)#3 (5) { [\"current_field\"]=&gt; int(0) [\"field_count\"]=&gt; int(8) [\"lengths\"]=&gt; NULL [\"num_rows\"]=&gt; int(0) [\"type\"]=&gt; int(0) } \n</code></pre>\n\n<p>The values that I entered for both the password and username are both valid (they are in the database under the correct columns, trust me). I have a feeling that something is wrong with my select query because the var dump on mysqli_num_rows($select) doesn't return anything.That being said, I've tried just about every change to the query that I could think of to make it work and still nothing :[  Can anyone help? </p>\n"},{"tags":["android","sql","sqlite"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":566,"score":1,"question_id":10491646,"title":"Importing SQL to SQLite","body":"<p>I have a database in sql format, and I need to make an sqlite copy in order to add it in an Android App I'm making.</p>\n\n<p>So far, I haven't got anything working for me. I tried to import the sql into SQLite Database Browser but it doesn't import properly, it always gives out an error statement. I tried creating a database then import the tables but it crashed.</p>\n\n<p>I tried using sqlite3 via Terminal (I'm using a Mac if that would make any difference), however the .import FILE TABLE format doesn't work, it says: \"Error: no such table: TABLE\". I tried creating an empty table using \"create table test42\" then \".import test.sql test42 and variants but it says \"Error: near \"test\": Syntax error\".</p>\n\n<p>I'm stuck. </p>\n\n<p>Any help would greatly help. Thanks.</p>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":300,"score":0,"question_id":7843296,"title":"How to drop tables with cyclic foreign keys in MySQL","body":"<p>I have two tables, Parent and Child. The column Parent.favorite_child has a foreign key constraint pointing to Child.id. And the column Child.parent has a foreign key constraint pointing to Parent.id.</p>\n\n<p>Now here's the weird part. I'm trying to drop my Child table, which <strong>contains no records</strong>, but MySQL is giving me the error:</p>\n\n<pre><code>ERROR 1217: Cannot delete or update a parent row: a foreign key constraint fails\nSQL Statement:\ndrop table `mydatabase`.`Child`\n</code></pre>\n\n<p>Why is MySQL throwing this error? There are literally no records in the Child table with which anything could be pointing to or from.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13277973,"title":"SQL average number of requests per user over time period","body":"<p>I have a table (Requests) with the following fields:</p>\n\n<p>id, requestType, userEmail, date</p>\n\n<p>I want to find the average number of requests per user over a given period (i.e. over the last month). Any suggestions?</p>\n\n<p>Thanks!\nGreg</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13278632,"title":"Not sure how to write a query to return column associated with max value in group by","body":"<p>This query in postgres 9.2:</p>\n\n<pre><code>select max(amount) as max_analyte,concat(sarea,' ',sloc) as location,analyte\nfrom sample natural join station\ngroup by analyte,location\norder by max_analyte desc;\n</code></pre>\n\n<p>returns the following results:</p>\n\n<pre><code>max_analyte;location;analyte\n24196;\"CANDLESTICK POINT WINDSURFER CIRCLE\";\"COLI_TOTAL  \"\n19863;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_TOTAL  \"\n14136;\"CRISSY FIELD EAST\";\"COLI_TOTAL  \"\n12033;\"CHINA BEACH/BAKER BEACH BAKER BEACH WEST\";\"COLI_TOTAL  \"\n4352;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_E      \"\n3076;\"CHINA BEACH/BAKER BEACH BACKER BEACH EAST\";\"COLI_TOTAL  \"\n2851;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"ENTERO      \"\n2064;\"AQUATIC PARK SHORELINE\";\"COLI_TOTAL  \"\n1918;\"CRISSY FIELD EAST\";\"ENTERO      \"\n...\n...\n\n74;\"CHINA BEACH/BAKER BEACH CHINA BEACH\";\"ENTERO      \"\n41;\"CRISSY FIELD WEST\";\"ENTERO      \"\n41;\"OCEAN BEACH NORTH LINCOLN WAY\";\"ENTERO      \"\n31;\"OCEAN BEACH NORTH LINCOLN WAY\";\"COLI_E      \"\n</code></pre>\n\n<p>The data set contains the levels of 3 types of bacteria (COLI_TOTAL, COLI_E, ENTERO) sampled at various locations around the Bay Area on many different dates. The query above finds the max value at each location for each type of bacteria, but now I'd like to find which type of bacteria is associated with the maximum value for each location. I'm just not sure how to write that query. I should mention I'm doing this to improve my SQL skills. Thanks for any help/suggestions.</p>\n\n<p>The tables schemas are as follows:</p>\n\n<pre><code>CREATE TABLE sample\n(\n  analyte character(12),\n  amount integer,\n  sdate date,\n  sid character varying(20)\n)\n\nCREATE TABLE station\n(\n  sid character(20),\n  sarea character varying(24),\n  sloc character varying(24),\n  sfreq character varying(24)\n)\n</code></pre>\n"},{"tags":["sql","postgresql","database-design","openerp","relational-division"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13253420,"title":"Many-to-many relation filter","body":"<p>I need to filter my query with categories table which has many2many relation with another table. Is it possible to filter query with many2many relation? Everything I tried with it, didn't give any good results.</p>\n\n<p>So there is table <code>res_partner</code> which has many2many field <code>category_id</code> relating to table <code>res_partner_category.res_partner</code>, or just let say partners can have many categories. What I need is to filter <code>res_partners</code> table where it has category named 'business' or 'retail'. If it doesn't have any of these categories, it should not be showed.</p>\n\n<p>Also there is another field in <code>res_partner</code> which is <code>category_value_ids</code> and has <code>one2many</code> relation with <code>res_partners_category_value</code>.\nSo to make it more clear:</p>\n\n<p><strong><code>res_partner</code></strong> has following fields with relations:</p>\n\n<ul>\n<li><p><code>category_id</code> to <code>res_partner_category</code> (many2many)</p></li>\n<li><p><code>category_value_ids</code> to <code>res_partner_category_value</code> (one2many)</p></li>\n<li><p><code>name</code> (char)</p></li>\n</ul>\n\n<p><strong><code>res_partner_category</code></strong> has following fields with relations:</p>\n\n<ul>\n<li><p><code>partner_ids</code> to <code>res_partner</code> (many2many)</p></li>\n<li><p><code>name</code> (char)</p></li>\n</ul>\n\n<p><strong><code>res_partner_category_value</code></strong> has following fields with relations:</p>\n\n<ul>\n<li><p><code>category_group_id</code> to <code>res_partner_category</code> (many2one)</p></li>\n<li><p><code>category_id</code> to <code>res_partner_category</code> (many2one)</p></li>\n<li><p><code>object_id</code> to<code>res_partner</code> (many2one)</p></li>\n</ul>\n\n<p>But if I try to use <code>res_partner_category_value</code> table in SQL query I get error that I can't use it in query.</p>\n\n<p>So for example: let say there are 4 partners, which have following categories:</p>\n\n<ul>\n<li>first: categ1, categ2, business</li>\n<li>second: retail</li>\n<li>third: retail, business</li>\n<li>fourth: categ1, categ2</li>\n</ul>\n\n<p>The query should return first, second and third partners.<br>\nOne person said to me its not possible to filter like this with many2many relation. So I wonder is it really not possible or just complicated?</p>\n\n<p>EDIT.\nOk so I found that there is one more table which is called res_partner_category_rel. Why I didn't see it, was because through Openerp administration interface, where you can see all objects of database, that table is not showed. You can only see it directly through database.\nSo table that I was missing and was confused because of that:</p>\n\n<p><strong>res_partner_category_rel:</strong></p>\n\n<ul>\n<li>partner_id (many2one)</li>\n<li>category_id (many2one)</li>\n</ul>\n"},{"tags":["sql","sybase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13265755,"title":"\"optimizer was unable to construct a valid access plan\" after Update ASA9 to SA12","body":"<p>After an update from ASA9 to SA12, there seems to be a problem with several procedures.\nThis occurs only if the user does not have DBA authority. In ASA9 everything worked fine.</p>\n\n<pre><code>SELECT * FROM UDP_ErmittleOffeneSaldenAuslagen('', '');\n</code></pre>\n\n<p>Brings up the following error:</p>\n\n<blockquote>\n  <p>Could not execute statement. The optimizer was unable to construct a\n  valid access plan SQLCODE=-727, ODBC 3 State=\"HY000\" Line 1, column 1</p>\n</blockquote>\n\n<p>But if I use the following statement, it works flawlessly:</p>\n\n<pre><code>CALL UDP_ErmittleOffeneSaldenAuslagen('', '');\n</code></pre>\n\n<p>The problem is, that I need the SELECT statement.\nThe procedure itself looks (for example) like this:</p>\n\n<pre><code>CREATE PROCEDURE \"FCAdmin\".\"UDP_ErmittleOffeneSaldenAuslagen\"() \nBEGIN\n  SELECT * FROM Akte\nEND\n</code></pre>\n\n<p>It looks like the error comes up if a specific table is used inside the procedure. If I use another table instead of \"Akte\" in the procedure's select statement, it works.\nAlso executing the statement</p>\n\n<pre><code>SELECT * FROM Akte\n</code></pre>\n\n<p>itself works.</p>\n\n<p>Any clues?</p>\n"},{"tags":["sql","sql-server-2005","query-optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":540,"score":0,"question_id":2355231,"title":"Problem using ROW_NUMBER() to get records randomly (SQL Server 2005)","body":"<p>I want to get 1000 records from a table randomly, so I use:</p>\n\n<pre><code>SELECT top 1000 \n       mycol1\n     , mycol2\n     , ROW_NUMBER() OVER (ORDER BY NEWID()) rn\nFROM mytable\n</code></pre>\n\n<p>However, I don't want to see <code>rn</code> in my resultset, so I do:</p>\n\n<pre><code>SELECT mycol1\n     , mycol2\nFROM (\n    SELECT top 1000 \n           mycol1\n         , mycol2\n         , ROW_NUMBER() OVER (ORDER BY NEWID()) rn\n    FROM mytable\n) a\n</code></pre>\n\n<p>When I do this, the results do not come randomly anymore. They come as if I just said top 10000 <strong>without</strong> randomization using row_number().</p>\n\n<p>When I change the query to </p>\n\n<pre><code>SELECT mycol1\n     , mycol2\n     , rn\nFROM (\n    SELECT top 1000 \n           mycol1\n         , mycol2\n         , ROW_NUMBER() OVER (ORDER BY NEWID()) rn\n    FROM mytable\n) a\n</code></pre>\n\n<p>they are random again.</p>\n\n<p>I guess sql server does some kind of optimization, saying \"hey, this guy doesn't need the column <code>rn</code> anyway, so just ignore it\". But this results to an unexpected behavior in this case. Is there any way to avoid this?</p>\n\n<p>PS: I use the ROW_NUMBER() trick because mytable has 10 mio. rows and </p>\n\n<pre><code>SELECT top 10000 *\nFROM mytable\nORDER BY NEWID()\n</code></pre>\n\n<p>runs forever, whereas with ROW_NUMBER() it takes only up to 30 secs.</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13277445,"title":"SQL query to find a winner depending on winning odds","body":"<p>I need a SQL query to determine a random winner. Each user has it's own winning odds. The more the winning_odds value is high, the more the user has chances to win. Here's a look at the table structure:</p>\n\n<pre><code>id    email            winning_odds\n1     test@test.com    3\n2     test2@test.com   5\n3     test3@test.com   2\n4     test4@test.com   1\n5     test5@test.com   9\n</code></pre>\n\n<p>MySQL database. Table has approximately 100000 rows. There's only one winner, one time. Emails are unique. Anyone has a solution?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13278880,"title":"sql query returning multiple result using WHERE","body":"<p>There is a table name <code>Top_Up</code>. Its current snapshot is:\n<img src=\"http://i.stack.imgur.com/5CQha.png\" alt=\"Top_Up Table\">  </p>\n\n<p>When I run query <code>SELECT * FROM Top_Up WHERE Top_up_ID = (round(random() * 9 ) + 1);</code> on it, I am getting random result. Sometimes it is returning with two tuples, sometimes no tuples and sometime one tuple.  </p>\n\n<p>To debug I run the query <code>Select (round(random() * 9 ) + 1);</code> and it is always returning only one tuple in the result.  </p>\n\n<p><strong>Why I am getting this vague and random result?</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":14,"score":-1,"question_id":13273869,"title":"Update sql column by adding two fields together","body":"<p>I have a table with several columns.  I need to add data from one column(money) to another column(money) and then update then table row by row. </p>\n\n<p>I have tried select this creates a tempory column but no data gets saved into database</p>\n\n<p>I have tried insert but I need the new total to update into the field that is calculating</p>\n\n<p>I think my solution is an update but so far this is not working for me.</p>\n\n<p>Before update;</p>\n\n<pre><code>ID  ColumnNameCurrent   ColumnNameYTD\nA               20.20                       89.60 \nb               55.00                       147.38\nc               60.98                       258.46\nd               38.43                     7,894.32\n</code></pre>\n\n<p>After Update (what I hope for)</p>\n\n<pre><code>ID  ColumnNameCurrent   ColumnNameYTD\nA    20.20                    109.80 \nb    55.00                    202.38 \nc    60.98                    319.44 \nd    38.43                   7,932.75 \n</code></pre>\n\n<p>What I think the code should be;</p>\n\n<pre><code>UPDATE TableName\nSET ColumnNameYTD = ColoumNameYTD + ColumnNameCurrent\n</code></pre>\n\n<p>Can you please explain to me what I can change in the above to get the desired results.</p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13278552,"title":"GROUP BY WEEK with SQL","body":"<p>I have the following: </p>\n\n<p><a href=\"http://sqlfiddle.com/#!6/226ae/1\" rel=\"nofollow\">http://sqlfiddle.com/#!6/226ae/1</a></p>\n\n<p>I'm trying to now add one row for each week of the year, and filter the contacts accordingly.  CONTACTS has a datetime column.  The new table will look like: </p>\n\n<pre><code>        Status 1    Status 2    Status 3\nWeek 1      3          4           2\nWeek 2      1          5           3\nWeek 3      2          2           4\n</code></pre>\n\n<p>I think that DATEADD needs to be used, however I'm at a loss in terms of how to begin changing my query.  </p>\n\n<p>I do know that MySQL has a GROUP BY WEEK command, but I don't think that SQL has an equivalent.  What's the best way to accomplish this? </p>\n"},{"tags":["sql","query","dbms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":9593727,"title":"Inverted SQL query on a movie DBMS","body":"<p>I've got a task that says, find all firstname and surnames for those people who have been casting and directing in exactly same amount off movies, but where he/she has not been acting but only directing. Take in account only those who have been directing more than ten(10) movies.</p>\n\n<p>Here is the new query I tried:</p>\n\n<pre><code>SELECT p.firstname, p.lastname, COUNT(*) as CASTDIRECTING from PERSON p\n  INNER JOIN Filmparticipation fpCast ON fpCast.personid = p.personid\n  INNER JOIN Filmparticipation fpDirector ON fpDirector.personid = p.personid\n  INNER JOIN FilmItem fi ON fi.filmid = fpCast.filmid AND fi.filmid = fpDirector.filmid\n  INNER JOIN Film f ON f.filmid = fi.filmid\nWHERE (fpCast.parttype = 'cast' AND fpDirector.parttype = 'director' AND fpCast.personid = fpDirector.personid)\nGROUP BY p.lastname, p.firstname\nHAVING count(*) = (SELECT count(*) as DirectedOnly FROM Person p \n       INNER JOIN filmparticipation fpDirector ON fpDirector.personid = p.personid \n       INNER JOIN filmparticipation fpCast ON fpCast.personid = p.personid \n       WHERE (fpCast.parttype!='cast' AND fpDirector.parttype = 'director' AND \n           fpDirector.personid = fpCast.personid) \n       HAVING count(*) &gt; 10)\nORDER BY p.lastname ASC, p.firstname ASC;\n</code></pre>\n\n<p>Now it's returning empty rows. Do anyone see the errors in the query?</p>\n\n<p>Here are some relevant tables regarding the task..</p>\n\n<pre><code>create table filmparticipation (\n    partid int primary key,\n    personid int not null references person (personid),\n    filmid int not null references filmitem (filmid),\n    parttype text not null);\n\n\ncreate table person (\n    personid int primary key,\n    lastname text not null,\n    firstname text not null,\n    gender char(1),\n    check (gender = 'M' or gender = 'F'));\n\ncreate table filmitem (\n    filmid int primary key,\n    filmtype varchar(4) not null);\n\ncreate table film (\n    filmid int primary key references filmitem (filmid),\n    title text not null,\n    prodyear int);\n\ncreate index filmtitleindex on film (title);\ncreate index filmyearindex on film (prodyear);\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13277646,"title":"SQL Grouping by predefined date range","body":"<p>I have the following: </p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/fca3d/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/fca3d/1</a></p>\n\n<p>I'm trying to now add one row for each week in the year, and filter the contacts accordingly.  The new table will look like: </p>\n\n<pre><code>        Status 1    Status 2    Status 3\nWeek 1      3          4           2\nWeek 2      1          5           3\nWeek 3      2          2           4\n</code></pre>\n\n<p>I think that DATEADD needs to be used, however I'm at a loss in terms of how to begin changing my query.  Any help would be much appreciated!  </p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","sqlite3","amazon-ec2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":132,"score":3,"question_id":12812721,"title":"Rails: SQLite3::CantOpenException: unable to open database file","body":"<p>I'm trying to use <code>delayed_job</code> to schedule tasks using Sqlite3, and it looks like apache isn't able to read my <code>production.sqlite3</code> file.</p>\n\n<p>Here's my <code>database.yml</code>:</p>\n\n<pre><code>production:\n  adapter: sqlite3\n  database: db/production.sqlite3\n  pool: 5\n  timeout: 5000\n</code></pre>\n\n<p>Here's the error I am getting (in log/production.log):</p>\n\n<pre><code>ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file:) \n</code></pre>\n\n<p>I have run <code>RAILS_ENV=production rake db:create</code> and <code>RAILS_ENV=production rake db:migrate</code>. The <code>db/production.sqlite3</code> file exists, and the db directory and all its subfolders are owned by <code>apache:apache</code>, which is who apache runs as. I'm using Phusion Passenger on Amazon EC2.</p>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["sql","plsql","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13255193,"title":"How to get the 'top most' data","body":"<p>I want to get the 'top most' data from a table similar:</p>\n\n<pre>\nA B C | Id\n1 2 3 | 1\n  4 5 | 1\n    6 | 1</pre>\n\n<p>A-C=Columns<br>\n1-6 values (field not set are empty)<br>\nData is in descending order according to it's id in sequence<br>\n<br></p>\n\n<p>When I query I want to get the latest written data, in this example the query should give me 1, 4 and 6 in a single row:</p>\n\n<pre>\na b c | Id\n1 4 6 | 1\n</pre>\n\n<p>This is what I've tried but then I get the correct result but in different rows:</p>\n\n<pre><code>select * from\n( select id, a from dataTable where id=(select max(dt.dataRow) from dataTable dt where dt.id = 1)) a_query\nfull outer join\n( select id, b from dataTable where id=(select max(dt.dataRow) from dataTable dt where dt.id = 1)) b_query\non a_query.id=b_query.id \nfull outer join\n( select id, c from dataTable where id=(select max(dt.dataRow) from dataTable dt where dt.id = 1)) c_query \non nvl(a_query.id, b_query.id)=c_query.id\n</code></pre>\n\n<p>Preferable Oracle SQL</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":28,"score":4,"question_id":13278315,"title":"SQL Statement that Subs 0 for no Results","body":"<p>I am having an issue getting the results I want from my SQL statement. I know I'm probably missing something simple but I just can't see it.</p>\n\n<p>Here are my tables.<br></p>\n\n<pre><b>Table: Users</b> <i>(RoleID is linked to ID in Roles Table)</i>\n<b>ID</b>,   <b>FirstName</b>,   <b>LastName</b>,   <b>RoleID</b> \n1,    Matt,        Ryan,       1\n2,    Chipper,     Jones,      1\n3,    Julio,       Jones,      2\n4,    Jason,       Bourn,      3\n\n<b>Table: Roles</b>\n<b>ID</b>,    <b>Name</b>\n1,     Field Rep\n2,     Tech\n3,     Admin\n\n<b>Table: FRrequests</b> <i>(UserID is linked to ID in Users table)</i> \n<b>ID</b>,   <b>UserID</b>,    <b>Status</b>\n1,    1,         Open\n2,    1,         Submitted\n3,    1,         Delayed\n4,    1,         Complete\n</pre>\n\n<p>What I want is an SQL statement that shows me a count of all the \"Submitted\" &amp; \"Delayed\" requests for all the Field Reps. Below is an example of desired results.</p>\n\n<pre>\n<b>Name</b>             <b>Count</b>\nChipper Jones    0\nMatt Ryan        2\n</pre>\n\n<p>Here is the statement I have so far and the results it gives me.</p>\n\n<pre>\nSELECT Users.FirstName + ' ' + Users.LastName AS Name, COUNT(FRrequests.ID) AS 'Open Requests'\nFROM Users INNER JOIN\n          Roles ON Users.RoleID = Roles.ID LEFT OUTER JOIN\n          FRrequests ON Users.ID = FRrequests.UserID\nWHERE (Roles.Name = N'Field Rep') AND (FRrequests.Status = 'Submitted' OR FRrequests.Status = 'Delayed')\nGROUP BY Users.FirstName, Users.LastName\n\n<b>Name</b>             <b>Count</b>\nMatt Ryan        2\n\n</pre>\n\n<p>I know that the \"AND (FRrequests.Status = 'Submitted' OR FRrequests.Status = 'Delayed')\" part is what is breaking it. If I run it without that in the statement I get all the users but it counts all status not just submitted and delayed. I just can't figure out what I'm missing to get this to work. Any help would be greatly appreciated.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":44,"score":-2,"question_id":13105583,"title":"Two CTEs in one query in PostgreSQL","body":"<p>Could we have two CTEs in one query in Postgresql?    </p>\n"},{"tags":["sql","query","mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13278372,"title":"Calculate mode in SQL","body":"<p>I have seen the answer from a previous post, which works fine but I have a small dilemma.\nTaking the same scenario:</p>\n\n<p><br>A table that list students' grades per class. I want a result set that looks like: </p>\n\n<pre><code>BIO...B \nCHEM...C \n</code></pre>\n\n<p><br>Where the \"B\" and \"C\" are the modes for the class and want to get the mode for the class.</p>\n\n<p>Once I applied the below query, i got the following output:</p>\n\n<pre><code>Class | Score | Freq  |  Ranking \n2010  |   B   | 8     |    1 \n2010  |   C   | 8     |    1 \n2011  |   A   | 10    |    1 \n2012  |   B   | 11    |    1\n</code></pre>\n\n<p>In 2010, I have two grades with the same frequency. What if..I just want to display the highest score, in this case will be \"B\". How can I achieve that? I would need to assign rankings to the letter grades, but I'm not sure how. Please advise.\nThanks.</p>\n\n<p>Prior post:\n<a href=\"http://stackoverflow.com/questions/2045075/sql-server-mode-sql\">SQL Server mode SQL</a></p>\n\n<p>The query I used to retrieve the data was the answer from Peter:</p>\n\n<pre><code>;WITH Ranked AS ( \nSELECT \n    ClassName, Grade \n    , GradeFreq = COUNT(*) \n    , Ranking = DENSE_RANK() OVER (PARTITION BY ClassName ORDER BY COUNT(*) DESC) \nFROM Scores \nGROUP BY ClassName, Grade \n) \nSELECT * FROM Ranked WHERE Ranking = 1\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13278147,"title":"Iterate through sql script using different values","body":"<p>Here is part of my script:</p>\n\n<pre><code>DECLARE @dataId int = 123               \n\n-- Here I run more SQL scripts using @dataId\n\nSelect from table A where id = @dataId \n\n-- So on it goes in other tables and delete and update other tables\n</code></pre>\n\n<p>My question is there a way I can enter 100 values in <code>@dataId</code> and it will iterate through the script in an order? Is there a simpler way to do this in SQL Server 2008 rather then manually entering <code>@dataId</code> each time?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":39,"score":1,"question_id":13277588,"title":"SQL INNER JOINS in SP converting date and/or time from character string getting error message","body":"<p>I have searched about 20 results apertaining to the error message \"Conversion failed when converting date and/or time from character string.\" and none seem to address my issue.</p>\n\n<p>A little history, last Friday the queries were working just fine and the data returned was proper. On the following Monday, the queries no longer worked and gave this error message, \"Conversion failed when converting date and/or time from character string.\"  So, after a few hours of battling it was able to run a function with the offending code in it and the query ran perfect again. Until this morning. I came into the office and ran the query and received the error \"Conversion failed when converting date and/or time from character string.\"  So now I am pulling my hair out.</p>\n\n<p>I started by verifying each record being returned is, in fact, a valid date using the isDate function. All the dates are valid dates in string format. I am simply doing a check to see whether or not the record is older than 1 year. </p>\n\n<p>I do have several INNER JOINS and have been wondering if they are affecting the output.</p>\n\n<pre><code>SELECT \ngc2p.partnumber, gc2p.orderby, gc2p.campaigncode, gp2a.assetfilename\nFROM [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2productrefs] gc2p\n,[StepMirror].[dbo].[stepview_nwppck_ngn_getpimweblegalattrlist1] gpwa\n,[StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2assetrefs] gc2a \n,[StepMirror].[dbo].[stepview_nwppck_ngn_getproduct2assetrefs] gp2a \nWHERE gc2p.partnumber=gpwa.PARTNUMBER and\ngc2p.id=gc2a.id and\ngp2a.PRODUCTNAME=gpwa.PARTNUMBER and\nATTRIBUTENAME='New Date' AND \nATTRIBUTEVALUE &gt; dateadd(month,-12,getdate()) AND \ngc2p.id = '5665976' and \ngc2a.assettype='Primary Image' AND \ngp2a.ASSETTYPE = 'Primary Image'\norder by gc2p.orderby\n</code></pre>\n\n<p>If anyone could give me a helping hand that would be wonderful.</p>\n\n<p>Edit: The query runs fine when I remove 'ATTRIBUTEVALUE > dateadd(month,-12,getdate())'. I forgot to mention the exact part of the query throwing the error.</p>\n\n<p>Edit: Updated Query - <strong>Now Working Query</strong> for those seeking a similar answer.</p>\n\n<pre><code>SELECT TOP 18 gc2p.partnumber, gpwa.ATTRIBUTECNAME,gp2a.ASSETFILENAME, gpwa.ATTRIBUTEVALUE\nFROM [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2productrefs] gc2p\nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getpimweblegalattrlist1] gpwa ON gc2p.partnumber=gpwa.PARTNUMBER and gpwa.ORDERBY='96'\nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2assetrefs] gc2a ON gc2p.id=gc2a.id\nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getproduct2assetrefs] gp2a ON gc2p.partnumber=gp2a.PRODUCTNAME\nWHERE gc2p.id = 5665976 AND gp2a.assettype='Primary Image' AND gc2a.assettype='Primary Image' \nAND(CASE WHEN ISDATE(ATTRIBUTEVALUE)  = 0 then NULL ELSE ATTRIBUTEVALUE END) &gt; dateadd(month,-12,getdate())\norder by gc2p.orderby\n</code></pre>\n"},{"tags":["mysql","sql","mysql-error-1005"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":180,"score":1,"question_id":9986287,"title":"Cannot create table with underscore in table name MySQL v5.5.14","body":"<p>I'm using Mysql v5.5.14 and when I try to execute:</p>\n\n<pre><code>mysql&gt; CREATE TABLE IF NOT EXISTS LONGBOW_products.universal_partname (\n    -&gt;    part_id SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,\n    -&gt;    PRIMARY KEY (part_id)\n    -&gt; );\n</code></pre>\n\n<p>It is returning me an error:</p>\n\n<pre><code>ERROR 1005 (HY000): Can't create table 'LONGBOW_products.universal_partname' (errno: -1)\n</code></pre>\n\n<p>However, when I tried removing the underscore from the table name, it returns true:</p>\n\n<pre><code>mysql&gt; CREATE TABLE IF NOT EXISTS LONGBOW_products.universal (\n    -&gt;    part_id SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,\n    -&gt;    PRIMARY KEY (`part_id`)\n    -&gt; );\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>\n\n<p>I wonder if you cannot use underscores anymore in table name on newer versions of Mysql?</p>\n"},{"tags":["sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":179,"score":1,"question_id":10640743,"title":"SQL query, join multiple tables, Oracle","body":"<p>I have an assignment where I need to write a SQL Query that would retrieve the player number and the total amount paid in penalties for players who are captains and have paid more than £80 in total for penalties.</p>\n\n<p>I've got three tables</p>\n\n<p>Players (<strong>playerNo</strong>, name, initials, street, town, postcode)</p>\n\n<p>Teams (<strong>teamNo</strong>, playerNo, division)</p>\n\n<p>Penalties (<strong>paymentNo</strong>, playerNo, penDate, amount)</p>\n\n<p>bold text indicates the primary key. The playerNo in Teams table indicates the team captain.</p>\n\n<p>I don't know how to join three tables. But my attempt at this is:</p>\n\n<pre><code>SELECT p1.playerNo, SUM(p2.amount)\nFROM Players p1 INNER JOIN Teams t\n   ON p1.playerNo = t.playerNo \nJOIN penalties p2\n   ON p2.playerNo = p1.playerNo\nGROUP BY playerNo\nHAVING SUM(p2.amount) &gt; 80;\n</code></pre>\n\n<p>Is any of this correct?</p>\n"},{"tags":[".net","sql"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13278234,"title":"How to do a SQL with an IF condition on one column","body":"<p>I got a quick question about if this is possible within a SQL statement for an ASPX page. </p>\n\n<p>Let's say there are three columns, <code>USER</code>, <code>Password</code>, and <code>permission</code>. </p>\n\n<p>If within my <code>SELECT</code> statement I want to only select <code>USER</code> and <code>PASSWORD</code> only when <code>Permission</code> is <code>&gt; 2</code>, and if it is less than 2 I only want to show <code>USER</code>. </p>\n\n<p>Is this possible? Or will I have to do this within my presentation layer?</p>\n"},{"tags":["sql","sql-server","percentile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13278051,"title":"SQL Percercentile Calculation","body":"<p>I have the following query, which even without a ton of data (~3k rows) is still a bit slow to execute, and the logic is a bit over my head - was hoping to get some help optimizing the query or even an alternate methodology:</p>\n\n<pre><code>Select companypartnumber, (PartTotal + IsNull(Cum_Lower_Ranks, 0) ) / Sum(PartTotal) over() * 100 as Cum_PC_Of_Total\nFROM PartSalesRankings PSRMain\nLeft join \n    (\n        Select PSRTop.Item_Rank, Sum(PSRBelow.PartTotal) as Cum_Lower_Ranks\n          from partSalesRankings PSRTop\n          Left join PartSalesRankings PSRBelow on PSRBelow.Item_Rank &lt; PSRTop.Item_Rank\n         Group by PSRTop.Item_Rank \n    ) as PSRLowerCums on PSRLowerCums.Item_Rank = PSRMain.Item_Rank\n</code></pre>\n\n<p>The PartSalesRankings table simply consists of CompanyPartNumber(bigint) which is a part number designation, PartTotal(decimal 38,5) which is the total sales, and Item_Rank(bigint) which is the rank of the item based on total sales.</p>\n\n<p>I'm trying to end up with my parts into categories based on their percentile - so an \"A\" item would be top 5%, a \"B\" item would be the next 15%, and \"C\" items would be the lower 80th percentile.  The view I created works fine, it just takes almost three seconds to execute, which for my purposes is quite slow.  I narrowed the bottle neck to the above query - any help would be greatly appreciated.</p>\n"}]}
{"total":102597,"page":4,"pagesize":100,"questions":[{"tags":["sql","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13277875,"title":"How to return the most repeated value using a foreign key from a referring table","body":"<p>I need to create a SQL query to retrieve all the values from one unique row entry in a table called <code>JOBS</code>.</p>\n\n<p>But to do so I need to use a table called <code>EMPLOYEES</code> which has a foreign key to the <code>JOBS</code> table.\nThe condition is to return the job_title from the table JOBS that has its job_id more times repeated in the <code>EMPLOYEES</code> table.</p>\n\n<p>I need to do it with one SQL statement.</p>\n\n<p>Desired output:</p>\n\n<pre><code>Stock Clerk\n</code></pre>\n\n<p>This is the query I have</p>\n\n<pre><code>SELECT job_id  \nFROM (SELECT job_id FROM employees GROUP BY job_id ORDER BY COUNT(*) desc)  \nWHERE ROWNUM &lt;= 1;\n</code></pre>\n\n<p>but is not good enough because it is <code>job_title</code> from <code>EMPLOYEES</code> what I need.</p>\n\n<p>Do you have any idea how can I do it? I am using an Oracle 11g database</p>\n\n<p>This is how my tables look like:</p>\n\n<p><strong>EMPLOYEES</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/3vCp3.jpg\" alt=\"EMPLOYEES\"></p>\n\n<p><strong>JOBS</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/jHTQ6.jpg\" alt=\"JOBS\"></p>\n"},{"tags":["sql","xcode","uitableview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13278134,"title":"Repopulate UITableView with New Data","body":"<p>I am implementing a search functionality using UIAlertView that will search a SQL Table for a match and repopulate the UITableView. So far I have this code below. \"results\" is array of match returned data from the search query. Then, I checked if the \"elements\" are empty which means it does not match any item in SQL Table. If it does then I would like to erase the data currently on UITableView and replace with the \"results\" data.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>            NSUInteger *elements = [results count];\n            if(elements == 0)\n            {\n                UIAlertView *av = [[UIAlertView alloc]initWithTitle:@\"Item Not Found\" message:@\"Sorry the item was not found\" delegate:self cancelButtonTitle:@\"Cancel\"\n                                                  otherButtonTitles:nil, nil];\n                [av show];\n            }\n            if(elements &gt;= 1)\n            {\n                    //Repopulate UITableView with Data\n                    self.itemTitles = itemstitle;\n                    self.itemPrices = itemsprice;\n                    self.itemCategory = itemscategory;\n            }\n</code></pre>\n\n<p>Note: I tried to use <code>[tableView reloadData]</code> but not sure how to implement it in this case.</p>\n\n<p>Thanks in advance for the help.</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":39,"score":-1,"question_id":13274255,"title":"Complex SQL query on one table","body":"<p>Have forgotten SQL queries as have not used it for a long time.</p>\n\n<p>I have a following requirement.\nHave a table called match where I keep my competitor details with respect to matches my team have played against them. So some important fields are like this</p>\n\n<pre><code>match_id\ncompetior_id\nmatch_winner_id\nismatchtied\ngoals_scored_my_team\ngoals_scored_comp\n</code></pre>\n\n<p>From this table I want to get the head to head information for all my competitors.\nlike this</p>\n\n<pre><code>Competitor Matches Wins Losses Draws \nA          10      5    4      1\nB          8       3    2      1\n</code></pre>\n\n<p>Draw information I can get from ismatchtied is set to 'Y' or 'N'.\nI want to get all the info from one query. I can get all the info from executing queries separately and do complex logic processing in my server code. But my performance will take a hit.</p>\n\n<p>Any help will be hugely appreciated.</p>\n\n<p>cheers,\nSaurav</p>\n"},{"tags":["php","sql","insert","condition"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13277663,"title":"Insert into“Table1” if a condition is met in “Table” 2 SQL","body":"<p><strong>I posted a similar question to this which was about deleting, This one is about inserting.</strong></p>\n\n<p>Hello,</p>\n\n<p>I'm making a little messaging application in PHP using a SQL database but have faced a small problem. I will try explain this as best as possible so here goes...</p>\n\n<p>I have a table called \"users\" as following:</p>\n\n<pre><code>ID | Username | Password | Email \n-------------------------------------------\n1  | Account1 | Pass 1   | email1@mail.com\n2  | Account2 | Pass 2   | email2@mail.com\n</code></pre>\n\n<p>I then have another called \"friends\" as following:</p>\n\n<pre><code>UserID | FriendID\n------------------\n   1   |     2    \n</code></pre>\n\n<p>So what I need is a query that will insert data into the \"friends\" table if a condition is met in the \"users\" table</p>\n\n<p>Example:</p>\n\n<pre><code>INSERT INTO 'friends' VALUES('$UserID', '$FriendID') IF (users.Password = $Password WHERE users.ID = $UserID)\n</code></pre>\n\n<p>I hope that was a good enough explanation but I'm finding this difficult to explain.</p>\n\n<p>Thank for your help :)</p>\n"},{"tags":["php","sql","propel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13265518,"title":"Chaining filterByXXX bug?","body":"<p>I have the following code:</p>\n\n<pre><code>$somethingArray = array( 3, 4, 5 );\n\n$myObjects = MyObjQuery::create()\n  -&gt;filterBySomething( $somethingArray )\n  -&gt;filterById( array( 'min' =&gt; $minMyObjID ) )\n  -&gt;orderByObjTimestamp('DESC')\n  -&gt;find();\n</code></pre>\n\n<p>Which according to the Propel documentation, should result in a SQL command that ends up checking if the 'something' is IN the somethingArray array, and that the id is > $minMyObjID. But instead, the id is IN instead of >. </p>\n\n<p>If I do the following instead:</p>\n\n<pre><code>$myObjects = MyObjQuery::create()\n  -&gt;filterBySomething( $somethingArray )\n  -&gt;where( 'id &gt; ' . $minMyObjID )\n  -&gt;orderByObjTimestamp('DESC')\n  -&gt;find();\n</code></pre>\n\n<p>The resulting SQL is what I would expect. Is this a Propel bug, or am I misunderstanding the documentation when it comes to filterByXXX parameters?</p>\n"},{"tags":["php","mysql","sql","delete","condition"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13277225,"title":"Deleting from \"Table1\" if a condition is met in \"Table\" 2 SQL","body":"<p>I'm making a little messaging application in PHP using a SQL database but have faced a small problem. I will try explain this as best as possible so here goes...</p>\n\n<p>I have a table called \"users\" as following:</p>\n\n<pre><code>ID | Username | Password | Email \n-------------------------------------------\n1  | Account1 | Pass 1   | email1@mail.com\n2  | Account2 | Pass 2   | email2@mail.com\n</code></pre>\n\n<p>I then have another called \"friends\" as following:</p>\n\n<pre><code>UserID | FriendID\n------------------\n   1   |     2    \n</code></pre>\n\n<p>So what I need is a query that will delete A row from the \"Friends\" table if a condition is met in the second table.</p>\n\n<p>Example:</p>\n\n<pre><code>DELETE FROM 'friends' WHERE UserID = 1 AND (users.Password = $Password WHERE users.ID = 1)\n</code></pre>\n\n<p>I hope that was a good enough explanation but I'm finding this difficult to explain.</p>\n\n<p>Thank for your help :)</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13277549,"title":"SQL server exclude anything but a number","body":"<p>is their a way to exclude results pulled in a query that start with anything but a number. Exclude anytXing starting in a letter.</p>\n\n<p>I tried</p>\n\n<pre><code> Where a.value like '0%'\n       And a.value  like '1%'\n       And a.value like '2%' \n         .......3-9\n</code></pre>\n"},{"tags":["sql","query","ms-access","ms-jet-ace"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13277677,"title":"SQL for the following equation. Todays EMA = (Price * (2/11)) + ((1 - (2/11)) * Yesterdays EMA)","body":"<p>May I ask for your help with the following, please?</p>\n\n<p>I want to create an MS Jet/Ace/Access Query that returns a 10 day Exponential Moving Average (EMA) from a table of price data. The table format and a small set of its data is as follows …</p>\n\n<pre><code>TableName = Spot\nID (AutoNumber) aDate (DateTime)        Settle (Double)\n1               01/10/2007              16.056\n2               02/10/2007              15.625\n3               03/10/2007              15.655\n4               04/10/2007              15.686\n5               05/10/2007              15.810\n6               08/10/2007              15.665\n7               09/10/2007              15.908\n8               10/10/2007              16.004\n9               11/10/2007              16.319\n10              12/10/2007              16.233\n</code></pre>\n\n<p>In case you are not aware of Exponential Moving Averages, the following websites may help explain them …</p>\n\n<p><a href=\"http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a\" rel=\"nofollow\">http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a</a></p>\n\n<p><a href=\"http://www.pandacash.com/technical-analysis/moving-average/exponential.htm\" rel=\"nofollow\">http://www.pandacash.com/technical-analysis/moving-average/exponential.htm</a></p>\n\n<p>However, hopefuly I can explain the equation to you. </p>\n\n<pre><code>Todays EMA = (Settle * Exponent) + ((1 - Exponent) * Yesterdays EMA)\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>Settle = Closing price of the Stock / Asset\nExponent = (2 / (10 Days + 1)) ie 0.1818\n</code></pre>\n\n<p>I have a query that returns some of the values I need, but I am unable to find a solution to the whole thing.</p>\n\n<p>My Query, so far (hopefully the formatting makes it clearer to read)</p>\n\n<pre><code>SELECT aDate, Settle, \n\n   (SELECT((SELECT Settle \n            FROM   SPOT AS SubQ \n            WHERE  SubQ.ID = SS.ID)) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS YesterdaySettle,\n\n   ( 2 / 11 ) AS Exponent,\n\n   (SELECT Settle \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID) * ( Exponent ) AS [Part A],\n\n   ( 1 - Exponent ) AS [Part B],\n\n   (SELECT ((SELECT Settle \n              FROM   SPOT AS SubQ \n              WHERE  SubQ.ID = SS.ID) * ( 2 / 11 )) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS [Yesterdays Part A],\n\n   (SELECT SUM(Settle) \n    FROM   SPOT AS SubQ \n    WHERE  ID BETWEEN Spot.ID AND Spot.ID -9) / Iif(Spot.id &gt; 10, 10, Spot.id) AS [10DMA] \n\nFROM   SPOT\nORDER  BY aDate; \n</code></pre>\n\n<p>Based on the field names of my Query, my equation would be …</p>\n\n<pre><code>Todays EMA = ([Part A])  + ([Part B] * [Part C])\n</code></pre>\n\n<p>And I would expect results similar to the following.</p>\n\n<pre><code>[10DMA] [Exponent]  [Part A]    [Part B]    [Part C] (Previous EMA)     [EMA]\n15.896  0.181818182 2.919272727 0.818181818     USE 10DMA ie 15.896     15.925\n15.911  0.181818182 2.840909091 0.818181818                 15.925      15.871\n15.945  0.181818182 2.846363636 0.818181818                 15.871      15.831\n15.985  0.181818182 2.852       0.818181818                 15.831      15.805\n16.027  0.181818182 2.874545455 0.818181818                 15.805      15.806\n16.037  0.181818182 2.848181818 0.818181818                 15.806      15.780\n16.052  0.181818182 2.892363636 0.818181818                 15.780      15.803\n16.054  0.181818182 2.909818182 0.818181818                 15.803      15.840\n16.039  0.181818182 2.967090909 0.818181818                 15.840      15.927\n16.025  0.181818182 2.951454545 0.818181818                 15.927      15.983                  \n</code></pre>\n\n<p>The problem is I can’t figure out how to create the [Part C] field.</p>\n\n<p>Some points are …</p>\n\n<ul>\n<li>If there is no EMA for a day, then the [Part C] value should be\n[10DMA]. For example, the first record will not have a EMA so I need\nto use [10DMA]. </li>\n<li>If there is an EMA from yesterday, then use that value for todays [Part C].</li>\n</ul>\n\n<p>May I ask for some advice please. I kind of stumbled across what I have so far, But I am stumped for the Part C value.</p>\n\n<p>I thought I could do something along the lines of …</p>\n\n<pre><code>iif (EMA &lt;&gt; 0, EMA, [10DMA]) AS [Part C],\n    (([Part A]) + ([Part B] * [Part C])) AS EMA\n</code></pre>\n\n<p>However, I get an error relating to </p>\n\n<pre><code>Circular reference caused by alias 'Part C'.\n</code></pre>\n\n<p>Any advice would be gratefully received. Many thanks for your time.</p>\n\n<p>John.</p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13275431,"title":"Finding the total amount for my query","body":"<p>I have a query that allows me to retrieve customer orders.</p>\n\n<pre><code>Select ID, OrderID, Item, Price from customerOrders\nWhere Order = 1\n</code></pre>\n\n<p>is there a way of totalling up the final amount to pay and have it visible below, but still be able to view all details needed in the sql query, for example</p>\n\n<pre><code>ID    |  OrderID |  Item  | Price\n1     |   1      |  Book  | 9.99\n2     |   1      |  DVD   | 12.99\n\n                    total = 22.98\n</code></pre>\n\n<p>Many thanks in advance</p>\n"},{"tags":["mysql","sql","sql-update"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13276480,"title":"Updating where another table equals some value","body":"<p>How do I do the following in MySQL:</p>\n\n<pre><code>UPDATE PartTbl SET aFlag = 0 \nWHERE PartId = (SELECT PartId FROM CategoryTbl WHERE cat = 100)\n</code></pre>\n"},{"tags":["c#",".net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13266324,"title":"accessing database","body":"<p>Here is my problem; I have a hosted and published database on godaddy servers. I have also published my website. However, when I tried to use one of visual studio's tools such as chart, or data view or any tool that wants me to specify a data source, I get the </p>\n\n<pre><code>\"error 40: could not open a connection to sql server\".\n</code></pre>\n\n<p>In most cases, I have worked around this issue by writing the code instead of using these tools on the \".cs\" sections, but now I need to update my database model and I really would prefer not to write that amount of code. The connection string I choose works perfectly, it can update and gather values from database on the published website. But when I Right click on the models section and select \"update model from database\" the update wizard cannot access the database with the very same connection string. Like I said, this problem occurs on every tool that wants me to select a data source.</p>\n\n<p>Is this a permission issue regarding visual studio or something else? \nThanks in advance.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13276778,"title":"Changing the name of a SQL database missing tables","body":"<p>when changing the name of a SQL server 2005 database moving mdf and ldf files.</p>\n\n<p>First i run a script in my program's install:</p>\n\n<pre><code>Alter Database [[DBNAME]] MODIFY NAME = [[RENAMEDBNAME]] \n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =  [[DBNAME]], NEWNAME = [[RENAMEDBNAME]] )\n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =  [[DBNAME]_log], NEWNAME = [[RENAMEDBNAME]_log] )\n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =[[RENAMEDBNAME]]  , FILENAME  ='[DBPATH][RENAMEDBNAME].mdf'  )\n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =[[RENAMEDBNAME]_log]  , FILENAME  ='[DBPATH][RENAMEDBNAME]_log.ldf'  )\n</code></pre>\n\n<p>ALTER DATABASE  [[RENAMEDBNAME]] SET OFFLINE GO</p>\n\n<p>then I move the files in code.</p>\n\n<p>then in the next script I use</p>\n\n<pre><code>ALTER DATABASE  [[RENAMEDBNAME]] SET ONLINE GO\n</code></pre>\n\n<p>The tables are missing from the database - Any ideas?\nShould I use backup and restore?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","ms-access-2007","database-performance"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13275113,"title":"Can Long Integer store letters?","body":"<p>I ran 'Analyze Performance' feature in Access and it had an \"idea\" to improve performance; Access said I should convert items that are alphanumeric mixes that look like this <code>12BB1-DF740</code>§ from <code>text</code> data type into <code>long integer</code> (the specific name from the idea). Whether Access is right that this would improve performance is secondary to whether long integer can store letters at all.</p>\n\n<p><em>[§ About the data - the hyphen in the data provided to me is always present at that location; the letters are always A-F]</em></p>\n\n<p>From what I can tell, <a href=\"http://www.w3schools.com/sql/sql_datatypes.asp\" rel=\"nofollow\">w3schools</a> is indicating that <code>Long</code> will only store numbers</p>\n\n<blockquote>\n  <p><code>Long</code> - Allows whole numbers between -2,147,483,648 and 2,147,483,647    </p>\n</blockquote>\n\n<ul>\n<li>Am I conflating data types? (Further, when I pull up the design view, it only offers <code>number</code> as a data type; there is no <code>long</code> or <code>long integer</code>)</li>\n<li>Can <code>Long Integer</code> store letters?</li>\n<li>If my column is already populated, and I convert the data type, will I lose data?</li>\n</ul>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13273264,"title":"Finding related article based on multiple criteria","body":"<p>This question is similar to <a href=\"http://stackoverflow.com/questions/4717093/mysql-find-related-articles\">this one</a> but with a difference: I have eight different types of tags.</p>\n\n<p>Something like this:</p>\n\n<pre><code>videos      [id, title]\ntags1       [id, tag]\ntags2       [id, tag]\ntags3       [id, tag]\ntags4       [id, tag]\ntags5       [id, tag]\ntags6       [id, tag]\ntags7       [id, tag]\ntags8       [id, tag]\nvideo_tags1 [vid_id, tag_id]\nvideo_tags2 [vid_id, tag_id]\nvideo_tags3 [vid_id, tag_id]\nvideo_tags4 [vid_id, tag_id]\nvideo_tags5 [vid_id, tag_id]\nvideo_tags6 [vid_id, tag_id]\nvideo_tags7 [vid_id, tag_id]\nvideo_tags8 [vid_id, tag_id]\n</code></pre>\n\n<p>Given a single video.id I want to pick out related videos based on which have the most tags in common. I'm finding it hard to find a way to do this, let alone a way that won't bring the server to it's knees.</p>\n"},{"tags":["asp.net","sql","visual-studio-2010","ddl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13276517,"title":"VS 2010 --- DDL How to get ID but show a different column for options","body":"<p>I have a quick question (hopefully quick). I'm still learning, so please bear with me.</p>\n\n<p>I'm trying to get a DDL working, where my drop down shows the user one column of options, but in reality, the option they pick will use the DeviceID for that particular option in the other column. Here is what I have for my Data Source:</p>\n\n<pre><code>    &lt;asp:SqlDataSource ID=\"RetrieveComputerSQL\" runat=\"server\" \n        ConnectionString=\"&lt;%$ ConnectionStrings:SynInventory %&gt;\" \n        SelectCommand=\"SELECT DeviceID + ' ' + Computer as Combo,Computer as Computer,DeviceID AS DeviceID from Hardware\"&gt;\n</code></pre>\n\n<p>Now the Hardware Table has 2 colunns.</p>\n\n<p>DeviceID = IDs of the items in the table\nComputer = The type of machines attached to that DeviceID</p>\n\n<p>So for example, the Hardware table looks like this:</p>\n\n<pre><code>&gt;Computer (Column)        DeviceID (Column)\n&gt;------------------       ----------------------   \n&gt; Thin Client                      0\n&gt; Desktop                          1\n&gt; Laptop                           2\n</code></pre>\n\n<p>Now, here is my DDL:</p>\n\n<pre><code>                    &lt;asp:DropDownList ID=\"ddlComputer\" runat=\"server\" AutoPostBack=\"true\"\n                    DataSourceID=\"RetrieveComputerSQL\" DataTextField=\"Combo\" DataValueField=\"Computer\"                      \n                    SelectedValue='&lt;%# Bind(\"Computer\") %&gt;' AppendDataBoundItems=\"true\"&gt;\n</code></pre>\n\n<p>What I want to do is still show the \"friendly\" name of the object, but in reality, grab the DeviceID of the selected object in the drop down box, then report that value back to my main DataSource (which is: UPDATE MainAsset SET [site] = @Site,[os] = @os,[device] = @Computer WHERE [pk] = @pk\") where [device] IS my Hardware table.</p>\n\n<p>I've tried this every which way I can think of, and manipulted my RetrieveComputerSQL DS in many ways. I decided to end on the \"Combo\" option, but nothing I've tried seems work.</p>\n\n<p>Any constructive ideas or comments sure would be appreciated. Hope this all makes sense.</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13276240,"title":"SQL query - whats the best way to do this","body":"<p>I have this query...</p>\n\n<pre><code>select * from selection_value where id = 14702\n14702\n14704\n14724\n14710\n14738\n14717\n14719\n14719\n14738\n14722\n14721\n14724\n14725\n14706\n14730\n14708\n14731\n14715\n14708\n14749\n14752\n14754\n14755\n14757\n14795\n14753\n14760\n14761\n14759\n14762\n14763\n14785\n14764\n14765\n14785\n14766\n14768\n14796\n14771\n14772\n14774\n14776\n14764\n14780\n14781\n14767\n14784\n14785\n14786\n14788\n14789\n14790\n14791\n14785\n14772\n14792\n14796\n14785\n14797\n14798\n14799\n14800\n14802\n14778\n14803\n14758\n14765\n14762\n14781\n14785\n14786\n14808\n14793\n14805\n14807\n14808\n</code></pre>\n\n<p>Now I know this will not work, I was just wondering whats the best way to get the data for all of these ids in this order?</p>\n\n<p>Is this possible?</p>\n"},{"tags":["mysql","sql","exception-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13276337,"title":"Error While importing Schema in sql","body":"<p>Hey guys im trying to import schema from mysql vesion 5.0 to 5.1. Every time i'm trying to import schema I got this error:</p>\n\n<p>Error near Drop Proceduer service_tt_yes'\nMySql.Data.MySqlClient.MySqlException: Column count of mysql.proc is wrong. Expected 20, found 16. The table is probably corrupted.</p>\n\n<p>I try to skip that procedure but error occur in next procedure.</p>\n\n<p>Any solution!</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13275696,"title":"need assistance on constructing sql query","body":"<p>i have three tables like follows:</p>\n\n<p>this one table : <code>m_application_resources</code></p>\n\n<pre><code> resourceid resource_name   menu_group_id   menu_name   creation_date   last_created_by updation_date   last_updated_by\n</code></pre>\n\n<p>and the second table : <code>m_roles</code></p>\n\n<pre><code>roleid  rolename    description creation_date   last_created_by updation_date   last_updated_by\n</code></pre>\n\n<p>and the third table is : <code>m_access_matrix</code></p>\n\n<pre><code>accessid    resourceid  roleid  creation_date   last_created_by updation_date   last_updated_by\n</code></pre>\n\n<p>Relationship for the table is : resourceid and roleid</p>\n\n<p>and this my query </p>\n\n<pre><code>select  am.accessid, ar.resource_name,rls.rolename\nfrom m_application_resources ar, m_roles rls,m_access_matrix am \nwhere ar.resourceid=am.resourceid \n</code></pre>\n\n<p>this returns the following :</p>\n\n<pre><code>ccessid resource_name   rolename\n1   DepartmentAction    Admin\n1   DepartmentAction    Client\n1   DepartmentAction    Doctors\n2   PositionsAction     Admin\n2   PositionsAction     Client\n2   PositionsAction     Doctor\n</code></pre>\n\n<p>the result is wrong and i don't know how to go about.</p>\n\n<p>Ex : DepartmentAction should come only once and the role name should be any one.</p>\n\n<p>Sqlfiddle<a href=\"http://www.sqlfiddle.com/#!2/2fca3/3\" rel=\"nofollow\">Fiddle</a></p>\n\n<p>Please help</p>\n"},{"tags":[".net","sql","vb.net","cryptography","sha1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":165,"score":1,"question_id":11233394,"title":".Net SHA1CryptoServiceProvider not matching SQL Hashbytes","body":"<p>After converting some plaintext passwords stored in SQL using Hashbytes can't seem to get .Net to generate a proper matching hash.</p>\n\n<p>SQL used to convert the passwords:</p>\n\n<pre><code>UPDATE Users\nSET UserPassword = HASHBYTES('SHA1', UserPassword + CAST(Salt AS VARCHAR(36)))\n</code></pre>\n\n<p>Now the .Net code used to generate the hash:</p>\n\n<pre><code>Dim oSHA1 As New System.Security.Cryptography.SHA1CryptoServiceProvider\nDim bValue() As Byte\nDim bHash() As Byte\n\nbValue = System.Text.Encoding.UTF8.GetBytes(sPlainTextPass)\nbHash = oSHA1.ComputeHash(bValue)\noSHA1.Clear()\n\nDim sEncryptPass As String = String.Empty\nFor i As Integer = 0 To bHash.Length - 1\n    sEncryptPass = sEncryptPass + bHash(i).ToString(\"x2\").ToLower()\nNext\n</code></pre>\n\n<p>A few added notes: The salt is stored in the database. sPlainTextPass contains the password+salt in plain text. I tried several different encodings including ASCII, UTF7, and UTF8. The database field is a varchar which is supposed to match to UTF8 from what I understand.</p>\n\n<p>Help?</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13273966,"title":"SQL: unique constraint and aggregate function","body":"<p>Presently I'm learning (MS) SQL, and was trying out various aggregate function samples. The question  I have is: Is there any scenario (sample query that uses aggregate function) where having a unique constraint column (on a table) helps when using an aggregate function.</p>\n\n<p>Please note: I'm not trying to find a solution to a problem, but trying to see if such a scenario exist in real world SQL programming.</p>\n"},{"tags":["sql","sql-server","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13268760,"title":"Alter stored procedure or function added extra blank line gap","body":"<p>In SQL Server 2012 when I write code for stored procedure and for any function. After that when I want to alter it added extra blank line gap, that's why it seem very unacceptable lenghty..</p>\n\n<pre><code>CREATE proc sp_delete_Rte_article_admin_Latest   \n(    \n@id int    \n)    \nas    \nbegin    \nif exists (select * from tblRte where Id=@id )    \nbegin    \n    declare @IvanID bigint  \n\n    set @IvanID=(select [IvanArtId] from tblRte where Id=@id )  \n    insert into tblRteOnDelete([IvanArtId],[StoryType],[ChannelType],[Filename],\n                [Headline],[PublishDate],[Title],[DocScope],[KeyWord],[Byline],[City],\n                [State],[StoryDate],[BodyContents],[DownloadedDate],DeleteDate)\n    select [IvanArtId],[StoryType],[ChannelType],[Filename],[Headline],[PublishDate],\n           [Title],[DocScope],[KeyWord],[Byline],[City],[State],[StoryDate],\n           [BodyContents],[DownloadedDate],GETDATE()\n      from tblIvanhoeXmlFeeds\n     where Id=@id   \n\n    delete from tblRte where Id=@id   \n    delete from tblUpdatedRteTopics where IvanArtId=@IvanID  \n    delete from tblCheckAllowRte where ArticleID=@IvanID  \n    delete from tblAddRteeApprove where ArticleID=@IvanID  \n\n    return 1    \nend    \nelse    \nbegin    \n    return 0    \nend    \nend\n</code></pre>\n\n<p>What should do for moving this for all time..any setting ?</p>\n"},{"tags":["sql","sql-server-2008","database-design","denormalization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":58,"score":-1,"question_id":13255736,"title":"Does table size have an effect on a denormalized database?","body":"<p>I am designing a duplicate of an existing database, and moving all the old data to it for reporting purposes. I have to denormalize the tables to improve the reporting performance, so I am trying to figure out which tables to join.</p>\n\n<p>I have examined the table relationships and have made a list of parent/child tables respectively, but I have also found that some of the tables have around 30 columns each. </p>\n\n<p>Will this have a negative effect on the performance if I join these tables in a denormalized database?</p>\n"},{"tags":["sql","windows","script","sqlplus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13264923,"title":"Prompt during sql script","body":"<p>My windows batch script calls a <code>sql</code> script in which a user is required to press <code>ENTER</code> during a prompt. This causes the program to pause during execution and wait for user input. Is it possible to preset the <code>ENTER</code> key in the <code>sql</code> script using a command?</p>\n"},{"tags":["sql","database","postgresql","datetime","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13272022,"title":"Declaring timestamp in postgres","body":"<p>I have to insert a timestamp value into a table. I am inserting values by writing an stored procedure.<br>\nThis is the code to my stored procedure.  </p>\n\n<pre><code>CREATE OR REPLACE FUNCTION dataInsert_Schedule() RETURNS boolean As\n$$\nDECLARE\n    i integer;\n    j integer;\n    dur integer;\n    tup Channel%rowtype;\nBEGIN\n    FOR tup IN SELECT * FROM Channel\n    LOOP\n        for i in 0..6 LOOP --days\n            for j in 0..23 LOOP  --hours\n                dur = round((random() * 2) + 1);\n                IF i + dur &gt; 24 then\n                    dur = 24 - i;\n                END IF;\n                INSERT INTO Schedule VALUES(tup.Channel_ID, round((random() * 999) + 1),( current_date + (integer to_char(i,'9')) )+ (interval to_char(j,'99') || ' hour'), (interval  dur ||' hour'));\n                i = i + dur - 1;\n            END LOOP;\n        END LOOP;\n    END LOOP;\n    return true;\nEND\n$$ LANGUAGE plpgsql;\n</code></pre>\n\n<p>When I write the query <code>Select * From dataInsert_Schedule();</code> I got the following error :  </p>\n\n<pre><code>ERROR:  syntax error at or near \"to_char\"\nLINE 1: ...d((random() * 999) + 1),( current_date + (integer to_char( $...\n                                                             ^\nQUERY:  INSERT INTO Schedule VALUES( $1 , round((random() * 999) + 1),( current_date + (integer to_char( $2 ,'9')) )+ (interval to_char( $3 ,'99') || ' hour'), (interval  $4  ||' hour'))\nCONTEXT:  SQL statement in PL/PgSQL function \"datainsert_schedule\" near line 15\n\n********** Error **********\n\nERROR: syntax error at or near \"to_char\"\nSQL state: 42601\nContext: SQL statement in PL/PgSQL function \"datainsert_schedule\" near line 15\n</code></pre>\n\n<p>I First tried this</p>\n\n<blockquote>\n  <p><code>INSERT INTO Schedule VALUES(tup.Channel_ID, round((random() * 999) + 1),( current_date + (integer ''||i) )+ (interval (j ||' hour')), (interval  dur ||' hour'));</code>  </p>\n</blockquote>\n\n<p>way of inserting, but I was getting the same kind of error.</p>\n\n<p><strong>Why I am getting this error?</strong></p>\n\n<p>And the <code>schedule</code> table is defined as following:  </p>\n\n<pre><code>CREATE TABLE Schedule(\nChannel_ID Integer  REFERENCES Channel(Channel_ID),\nProgram_ID Integer  REFERENCES Program(Program_ID),\nStart_Time Timestamp NOT NULL,\nDuration Interval NOT NULL,\nCONSTRAINT Schedule_Key PRIMARY KEY(Channel_ID, Program_ID)\n);\n</code></pre>\n"},{"tags":["mysql","sql","database","wordpress","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13275271,"title":"SQL Joining another table based on the ID of the initial table","body":"<p>I really just can't seem to grasb the sytanx of SQL Joins, etc ... so I'm needing some help with this (which I think is quite simple)</p>\n\n<p>I'm querying <code>bid_tag</code> as follows:</p>\n\n<pre><code>SELECT paid_date, term, pet_id FROM bid_tag WHERE active = 1\n</code></pre>\n\n<p>And I need to use the <code>pet_id</code> to then grab some information from another table <code>wp_postmeta</code>, where the table is actually in a <code>meta_key</code> <code>meta_value</code> structure (WordPress) ...</p>\n\n<p>So I need to grab the <code>meta_value</code> of <code>meta_key</code> \"bid_name\", for example... amongst other values.</p>\n\n<pre><code>TABLE\nid | meta_key | meta_value\n1    bid_name    Max\n</code></pre>\n\n<p>That <code>ID</code> is the same <code>ID</code> that I need to connect the initial table to...</p>\n\n<p>I really appreciate it!</p>\n"},{"tags":["javascript","asp.net","sql","vb.net","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12519462,"title":"Getting value from SQL query to textbox","body":"<pre><code>Protected Sub Button3_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button3.Click\n    Dim cons, query As String\n    Dim con As OdbcConnection\n    Dim adpt As OdbcDataAdapter\n    'Dim num As Integer\n    cons = \"dsn=Courier; UID=Courier; PWD=123;\"\n    con = New OdbcConnection(cons)\n\n    con.Open()\n\n    query = \"select Name from EMPLOYEE where EMPLOYEE_ID=\" + DropDownList1.SelectedValue\n    Dim ds As DataSet\n    adpt = New OdbcDataAdapter(query, con)\n    ds = New DataSet\n    adpt.Fill(ds, \"Courier\")\n\n    ' TextBox1.Text = ds\n\n    con.Close()\nEnd Sub\n</code></pre>\n\n<p>I want to display the name of the employee in Textbox whoos ID is specified in query, what can I do for that?</p>\n"},{"tags":["sql","sql-order-by","order","limit","parent-child"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13266614,"title":"Parent-child sql query with order by and limit","body":"<p>I have two tables DOCUMENT and ATTRIBUTES like these</p>\n\n<ul>\n<li><code>DOCUMENT(id)</code>,</li>\n<li><code>ATTRIBUTE(name, value, doc_fk)</code>.</li>\n</ul>\n\n<p>I need to run a query that works like this \"abstract query\"</p>\n\n<pre><code>select top 100 documents\nwhere $state='COMPLETED'\norder by $creationDate\n</code></pre>\n\n<p>Where <code>$state</code> and <code>$creationDate</code> are two attributes.</p>\n\n<p>Note that the limit is on documents, not attributes, and sort and filter are on two different attributes. The final query should return all document attributes, not only the filtered/sorted ones.</p>\n\n<p>I was able to write this with a very complex query and I'm looking for better alternatives. I could post my solution if useful, but I do not want to point you in the, possibly, wrong direction.</p>\n\n<p>It's ok to get a FEW extra documents, like 1000 instead of 100, and filter/sort in memory.\nCould be ok for the limit not to be exact, like 74 instead of the required limit 100, but not too far from it.</p>\n\n<p>Extra \"soft\" requirements:</p>\n\n<ul>\n<li>the query should work with several databases (oracle, mysql and sqlserver), so weird analytic functions should be avoided unless available on all platforms</li>\n<li>should work with JPA (eclipselink 2.4.0 implementation)</li>\n</ul>\n\n<p>The expected output is something like this</p>\n\n<pre><code>DOC_ID   ATTRIBUTE_NAME          VALUE\n  123       state              COMPLETED\n  123       creationDate       21/11/2012\n  123       userid             someone\n  456       state              COMPLETED\n  ...\n</code></pre>\n"},{"tags":["sql","ruby-on-rails-3","postgresql","activerecord","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":107,"score":3,"question_id":13133553,"title":"Rails 3 Applying limit and offset to subquery","body":"<p>I have a query that goes something like this (in song.rb):</p>\n\n<pre><code>def self.new_songs\n  Song.where(id: Song.grouped_order_published).select_important_stuff\nend\n</code></pre>\n\n<p>Later on in my app, it is then passed the limit and offset, lets say in the controller:</p>\n\n<pre><code>@songs = Song.new_songs.limit(10).offset(10)\n</code></pre>\n\n<p>The way my app is structured, I'd like to keep this method of setting things, but unfortunately it is really slow as it is limiting the outer query rather than the subquery.</p>\n\n<p>Is there a way I can expose the subquery such that it receives the limit and offset rather than the outer query?</p>\n\n<p><strong>Edit</strong>: I should add I am using postgres 9.2.</p>\n\n<p><strong>Edit 2</strong>:  The reason why I want to do it in this fashion is I am doing pagination and I need to get the \"count\" of the total number of rows.  So I do something like this:</p>\n\n<pre><code>@songs = Song.new_songs\n...\n@pages = @songs.count / 10\n...\nrender @songs.limit(params[:page]).offset(0)\n</code></pre>\n\n<p>If I were to change it somehow, I'd have to redo this entirely (which is in a ton of places).  By not limiting it until it's actually called, I can do the count in between and then get just the page at the end.  I guess I'm looking more for advice on how this can be done with the inner query, without becoming horribly slow as the database grows.</p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13274991,"title":"Generate 6 numbers without repetition from the set 1 ... 49","body":"<p>I need to generate 6 numbers without repetition from 1 to 49.\nI have something like that:</p>\n\n<pre><code>create table zadanie1(\nNAZWISKO varchar2(30),\nPUNKTY number,\nID number,\nconstraint stud1_nazw primary key(NAZWISKO)\n);\n\n\n\ncreate or replace procedure \"LOTTO\" IS\npkt number;\nbegin\n   loop\n       BEGIN\n       pkt := round(dbms_random.value(1,14),0);\n       INSERT INTO ZADANIE1(PUNKTY) VALUES (pkt);\n       exit;\n       Exception When DUP_VAL_ON_INDEX Then 0;\n       END;\nend loop;\nEND;\n</code></pre>\n\n<p>but this doesn't seem to work. Can somebody help me ?</p>\n"},{"tags":["sql","sql-server","database","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13274950,"title":"list all tables that don't exist but are used in a view sql server","body":"<p>I can't seem to get all the table names that a view is trying to use.</p>\n\n<p>Currently, I am using <code>INFORMATION_SCHEMA.VIEW_COLUMN_USAGE</code> to find which tables are used. But, it only finds tables that currently exist. I want to find out if that view is trying to use tables that don't exist.</p>\n\n<p><code>View_Column_Usage</code> will only find columns that are used in the view. You can check to see if those columns are in any of the current tables columns to find which columns aren't used, but you can't find which tables aren't used.</p>\n\n<p>Does anyone know a table I can use to find which tables are used in a view, but do not exist?</p>\n"},{"tags":["sql","query","search","search-engine","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13275510,"title":"How to retrieve records based on multiple bit of strings present in those records?","body":"<p>I am using Ruby on Rails v3.2.2 and the MySQL database. I have a database table containing data as-like the following (note: the <code>column1</code> contains comma separated strings):</p>\n\n<pre><code>id   | column1                          | column2 | columnM    \n-----|-----------------------------------------------------\n1    | one1                             | value1  |  ...\n2    | one1, two1                       | value1  |  ...\n3    | one1, two1, three1               | value1  |  ...\n4    | one2                             | value2  |  ...\n5    | one2, two2                       | value2  |  ...\n6    | one2, two2, three2               | value2  |  ...\n...  | ...                              | ...     |  ...\n1000 | oneN                             | valueN  |  ...\n1001 | oneN, twoN                       | valueN  |  ...\n1002 | oneN, twoN, threeN               | valueN  |  ...\n1003 | oneN, twoN, threeN, fourN        | valueN  |  ...\n</code></pre>\n\n<p>I would like to write a SQL query so to retrieve <em>records starting at the same time with one or more bit of strings</em> present in the <code>column1</code>. That is, for instance, given I search the <code>column1</code> for <em>strings</em></p>\n\n<pre><code>Case 1: \"thr\"\nCase 2: \"two1 thr\"\nCase 3: \"two thr\"\nCase 4: \"wo\"\nCase 5: \"one\"\nCase 6: \"four one\"\n</code></pre>\n\n<p>Then, I would like to get respectively records with following <code>id</code>s:</p>\n\n<pre><code>Case 1: 3, 6, 1002, 1003                         # returns all records starting with \"thr\"\nCase 2: 3                                        # returns all records starting with \"two1\" and at the same time starting with \"thr\" \nCase 3: 3, 6, 1002, 1003                         # returns all records starting with \"two\" and at the same time starting with \"thr\"\nCase 4:                                          # nothing to return\nCase 5: 1, 2, 3, 4, 5, 6, 1000, 1001, 1002, 1003 # returns all records starting with \"one\"\nCase 6: 1003                                     # returns all records starting with \"four\" and at the same time starting with \"one\"\n</code></pre>\n\n<p><em>How can I make the SQL query to behave as the above</em> (maybe, by using something as like wildcards or other things unknown to me)<em>?</em> Since I am trying to implement a \"simple\" search engine, what do you advice about? Is there some prescriptions?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13267949,"title":"Update field in Source table with Identity after insert target with merge statement","body":"<p>I have a table Items which should have a corresponding record in the table LanguageText. The ID (Identity) of LanguageText is registered in the Items.LanguageTextId field in my Items table.</p>\n\n<p>What I want to accomplish is a merge between LanguageText and Items for all records with null in Items.LanguageTextId and insert the itemname / text of these Item records in LanguageText plus update the LanguageTextId with the ID value from the newly inserted LanguageText record (SCOPE_IDENTITY()?)</p>\n\n<p>The insert works fine:</p>\n\n<pre><code>MERGE [dbo].[LanguageText] AS target\nUSING (SELECT [Items].* from [dbo].Items ) AS source \nON (TARGET.Id = SOURCE.LanguageTextId) \nWHEN NOT MATCHED By Target THEN \n    INSERT   \n       ([Text])\n VALUES\n       (source.[ItemName]);\n</code></pre>\n\n<p>end</p>\n\n<p>But I don't know how to update my items.Languagetextid, can I do something with:\nOUTPUT $action, INSERTED.ID ?\nOr is there a better way to have this done??</p>\n\n<p>Thanks in advance,</p>\n\n<p>Mike</p>\n"},{"tags":["mysql","sql","database","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13275137,"title":"Regarding formatting of the query","body":"<p>I have made an application in which I have put the sql queries in java method as below..</p>\n\n<pre><code>private static String getSaleTransactionsQuery(final String currentTradingDate){\n\n        final String query =\n            \" SELECT '990' line_code, \" +\n            \" sum(toti_wag.TTIW_CUST_CNT) amount \" +\n            \" FROM total_till_wag toti_wag \" +\n            \" where toti_wag.TOTI_TRADING_DATE = '\" + currentTradingDate + \"' \";\n\n        return query;\n    }\n</code></pre>\n\n<p>Now when I want to filter out sql queries then I have to copy this query on the sql file and have to manually remove the quotes(\"\") and the plus(+) sign in order to make them as pure sql and then have to execute them to see the query output , is there any other tool which will format all these means remove the quotes and the plus sign ,please advise</p>\n"},{"tags":["sql","sql-server","sql-server-2008","version-control"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13274498,"title":"Add version control to existing SQL Server database","body":"<p>I am part of a development team currently working with a database that does not have any kind of source control. We work with SQL Server 2008 R2 and have always managed the DB directly with SSMS. It now has ~340 tables and ~1600 stored procedures, plus a few triggers and views, so it is not a small DB.</p>\n\n<p>My goal is to have the DB under version control, so I have been reading articles, like <a href=\"http://bitly.com/9cJmGR\" rel=\"nofollow\">Scott Allen's series</a> and many old SO related questions. But I am still unable to decide on how to proceed.</p>\n\n<p>What I'm thinking of is to script the database schema in one file, then procedures, triggers and views in one file each. Then keep everything versioned under Mercurial. But of course, every member of the team can access SSMS and directly change the schema and procedures, with the possibility that any of us can forget to replicate those changes in the versioned files.</p>\n\n<p>What better options are there? And, did I forget any element worth having source control of? My biggest concern is that most of the literature I found explains how to do version control when creating a new database, but not when it is already old and relatively big.</p>\n"},{"tags":["mysql","sql","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13274746,"title":"Count popular tags with comma delimited field on MySQL","body":"<p>I have a comma delimited field on my table, it stores Tags like:</p>\n\n<pre><code>avengers, heroes, marvel, 2012, hulk, captain america\n</code></pre>\n\n<p>And i want to get the most used tags.</p>\n\n<p>How can i do this on one single SELECT query?</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13262657,"title":"Date calculation in variable","body":"<p>I'm doing my best to set a date variable so I can compare it later.  I would like something that basically says:</p>\n\n<p>If the current day-of-month is less than 11, then date is 10th of LAST month<br>\nIf the current day-of-month is greater-than-or-equal-to 11, then date is 10th of THIS month</p>\n\n<p>Date is 11/6/2012 expected output:</p>\n\n<pre><code>@PODate = 10/10/2012\n</code></pre>\n\n<p>Date is 11/16/2012 expected output:</p>\n\n<pre><code>@PODate = 11/10/2012\n</code></pre>\n\n<p>Currently all I have is this:</p>\n\n<pre><code>DECLARE @PODate as DATETIME\nSet @PODate = Convert(varchar(8),GetDate(),1)\n</code></pre>\n\n<p>Any tips or help would be greatly appreciated.  Thank you!!</p>\n"},{"tags":["java","sql","database","jdbc","odbc"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":4,"view_count":75,"score":-3,"question_id":13266332,"title":"Strange SQL statements being inserted into database","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13263493/java-not-recognising-sql-statement-to-retrieve-data-from-database\">Java not recognising SQL statement to retrieve data from database</a>  </p>\n</blockquote>\n\n\n\n<p>I have a problem with my Java application. The application is based on users who have to enter their <code>username (their email address)</code> so as to fill in an input form. The functionality of the input form is that the user has to enter for <code>book names</code> in order of priority. </p>\n\n<p>In the application, suppose a user's email address is <code>\"david.ferno@gmail.com\"</code>. He will have to input only <code>\"david.ferno\"</code> in the <code>JTextBox</code>, and a <code>SQL LIKE</code> statement is used check the corresponding User ID from the \"bookuser\" table and store it into the <code>\"priority\" table</code> along with the <code>book priority choices</code>. </p>\n\n<p>I have used <code>PreparedStatement</code> for the <code>SQL</code> retrieval from <code>database</code> but when values are being inserted to the , instead of saving <code>User ID</code> like <code>\"user88\"</code>, it is <code>saving the SQL statement</code> itself inside the database.  </p>\n\n<p>What I mean to say is, in the <code>\"priority\"</code> table, instead of saving <code>user88</code> (as an example), it is saving <code>\"SELECT User_ID FROM user WHERE email_address\"</code></p>\n\n<p>Please help me to find out what is wrong with my code.</p>\n\n<p><strong>Here are my codes</strong></p>\n\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport javax.swing.*;\nimport java.sql.*;\nimport javax.*;\n\npublic class addpriority extends JFrame{\npublic JTextField txt_email, txt_book1, txt_book2,txt_book3, txt_book4;\npublic JLabel label1;\npublic JButton confirm;\n\npublic addpriority(){\n    super(\"Book Choice Input Menu\");\n    this.setSize(506,620);\n    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n    this.setVisible(true);\n\n    Toolkit toolkit =  Toolkit.getDefaultToolkit ();\n    Dimension dim = toolkit.getScreenSize();\n\n    setLocation((int) (dim.width*0.25), 50);\n\n    JPanel label = new JPanel();\n    JLabel welcome = new JLabel(\"Input Book Priorities\");\n\n    Font f = new Font(\"Verdana\", Font.BOLD,16);\n    welcome.setForeground(Color.BLACK);\n    welcome.setFont(f);\n    add(label);\n    label.add(welcome);\n\n    GridLayout g1 = new GridLayout(15, 2, 0, 10);\n    setLayout(g1);\n\n    JPanel textfield1 = new JPanel();\n    JLabel userid = new JLabel(\"Please Enter your username:\");\n    txt_mail = new JTextField(20);\n    JLabel lect2 = new JLabel(\"@gmail.com\");\n    add(textfield1);\n    textfield1.add(userid);\n    textfield1.add(txt_mail);\n    textfield1.add(lect2);\n\n\n    JPanel textfield2 = new JPanel();\n    add(textfield2);\n\n    JPanel textfield3 = new JPanel();\n    JLabel lbl1 = new JLabel(\"Set Priority by entering Books' name:\");\n    add(textfield3);\n    textfield3.add(lbl1);\n\n\n    JPanel textfield4 = new JPanel();\n    JLabel lbl2 = new JLabel(\"1st Priority:\");\n    txt_module1 = new JTextField(10);\n    add(textfield4);\n    textfield4.add(lbl2);\n    textfield4.add(txt_module1);\n\n    JPanel textfield5 = new JPanel();\n    JLabel lbl3 = new JLabel(\"2nd Priority:\");\n    txt_module2 = new JTextField(10);\n    add(textfield5);\n    textfield5.add(lbl3);\n    textfield5.add(txt_module2);\n\n\n    JPanel textfield6 = new JPanel();\n    JLabel lbl4 = new JLabel(\"3rd Priority:\");\n    txt_module3 = new JTextField(10);\n    add(textfield6);\n    textfield6.add(lbl4);\n    textfield6.add(txt_module3);\n\n    JPanel textfield7 = new JPanel();\n    JLabel lbl5 = new JLabel(\"4th Priority:\");\n    txt_module4 = new JTextField(10);\n    add(textfield7);\n    textfield7.add(lbl5);\n    textfield7.add(txt_module4);\n\n    JPanel button = new JPanel();\n    confirm = new JButton(\"Confirm\");\n    confirm.setMnemonic('C');\n    confirm.addActionListener(new ActionListener() {\n        public void actionPerformed(ActionEvent e)\n        {\n            confirm.setEnabled(true);\n            }\n    });\n\n\n    Handleraddclassroom h = new Handleraddclassroom();\n    confirm.addActionListener(h);\n\n    button.add(confirm);\n    add(button);\n\n\n}\n\n\npublic class Handleraddclassroom implements ActionListener{\n    public void actionPerformed(ActionEvent event){\n\n        String name = ((JButton)event.getSource()).getText();\n\n\n        if (name.equals(\"Confirm\")){\n\n            String filename = \"C:/JAVA/book.accdb\";\n            String database = \"jdbc:odbc:booking\";\n\n            if(txt_mail.getText().equals(\"\")){\n                JOptionPane.showMessageDialog(addpriority.this,\"Your Username Field cannot be blank\");\n\n\n            }\n\n            else{\n\n\n            try {\n                Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                Connection con = DriverManager.getConnection(database ,\"\",\"\");  //username &amp;password not being used\n\n                Statement s = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY); //The Result set can now scroll forward and back\n\n\n\n\n            String squery = \"SELECT User_ID FROM bookuser WHERE email_address LIKE ? \";\n            PreparedStatement pstmt = con.prepareStatement(squery);\n            pstmt.setString (1, txt_mail.getText() + '*');\n                            pstmt.executeQuery();\n\n            String sql = \"INSERT INTO priority VALUES('\" \n\n                + squery + \"','\"\n                + txt_book1.getText() + \"','\"\n                + txt_book2.getText() + \"','\" \n                + txt_book3.getText() + \"','\"\n                + txt_book4.getText()+ \"' )\";\n\n            JOptionPane.showMessageDialog(addpriority.this,\"Choice Records Saved.\");\n\n            dispose();\n\n            Mainmenulecturer mml = new Mainmenulecturer();\n\n            s.execute(sql);\n\n            s.close();\n            con.close();\n\n            } catch (Exception e) {System.out.print(\"Error: \" + e);}\n            }\n        }\n    }   \n\n\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["php","jquery","html","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13274593,"title":"PHP, Jquery and DOM manipulation","body":"<p>I have a list that's being populated from the database it's sorted using the time field by ASC dates. I'm using the <code>&lt;?php foreach() :?&gt;</code> to loop through and populate the list .</p>\n\n<pre><code>&lt;li id=\"events\"&gt;\nTime: &lt;?php echo $venue['time']; ?&gt; \nEvent: &lt;?php echo $venue['location']; ?&gt; \n&lt;/li&gt; \n</code></pre>\n\n<p>I have a variable in php called ($time_left ) that keeps track of the days left till <em>each</em> event begins I calculate this by taking the time field from the database subtracting today's current date with <code>php date()</code> <strong>when this reaches 0 how can I remove the expired event from the start of the list and append it to the end.</strong></p>\n\n<p>This can be done on page refresh I don't need it to be asynchronous.  Can I do this just in PHP with DOM manipulation?  or should I use Jquery and if so how do I pass the $time_left variable from PHP to my Jquery script?</p>\n"},{"tags":["mysql","sql","query","sql-order-by","order"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13271667,"title":"MySQL order by multiple columns while grouping by one","body":"<p>So I have a weird scenario where I want the following data to be ordered in a certain way. Let the table data be:</p>\n\n<pre><code>abc 111 2     priority\nabc 111 blah  data\nabc 222 1     priority\nabc 222 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>I want to order that data based on column three (where column 4 is priority) but keep the return order grouped by column 2. So the expected query result would look like:</p>\n\n<pre><code>abc 222 1     priority\nabc 222 blah  data\nabc 111 2     priority\nabc 111 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>What's the best possible way of doing this. I can think of doing a query up front and an in clause, but then I would have to account for all possible priorities.</p>\n\n<p>Thanks in advance. FYI, its MySQL that I am using.</p>\n\n<p>ANSWER (but still looking to see if someone has a more efficient way)\ngiven - </p>\n\n<pre><code>CREATE TABLE my_data( name VARCHAR(20),groupid INT(5), attributekey VARCHAR(10),attributevalue VARCHAR(10));\n\nINSERT INTO my_data VALUES(\"abc\", 111, \"priority\", \"2\");\nINSERT INTO my_data VALUES(\"abc\", 111, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"priority\", \"1\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"priority\", \"3\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"someattr\", \"blah\");\n</code></pre>\n\n<p>solution -</p>\n\n<pre><code>SELECT m1.*,\n(select attributevalue from my_data m2\n   where m1.groupid=m2.groupid \n   AND m2.attributekey='priority' \n) groupidpriority \nFROM my_data m1\norder by groupidpriority;\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13274296,"title":"Auto Increment feature of SQL Server","body":"<p>I have created a table named as ABC. It has three columns which are as follows:-</p>\n\n<p><img src=\"http://i.stack.imgur.com/3sx3t.png\" alt=\"enter image description here\">              </p>\n\n<p>The column <code>number_pk</code> <code>(int)</code> is the <strong>primary key</strong> of my table in which I have made the <code>auto increment</code> feature on for that column.</p>\n\n<p>Now I have deleted two rows from that table say <code>Number_pk= 5</code> and <code>Number_pk =6</code>.</p>\n\n<p>The table which I get now is like this:-</p>\n\n<p><img src=\"http://i.stack.imgur.com/bTpbm.png\" alt=\"enter image description here\"></p>\n\n<p>Now if I again enter two new rows in this table with the same value I get the two new <code>Number_pk starting from 7 and 8</code> i.e,</p>\n\n<p><img src=\"http://i.stack.imgur.com/Y3fLv.png\" alt=\"enter image description here\"></p>\n\n<p>My question is that what is the logic behind this since I have deleted the two rows from the table. I know that a simple answer is because I have set the auto increment on for the primary key of my table. But I want to know is there any way that I can insert the two new entries starting from the last Number_pk without changing the design of my table?</p>\n\n<p>And how the <strong><em>SQL Server manage this record since I have deleted the rows from the database??</em></strong></p>\n"},{"tags":["mysql","sql","query","optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13241119,"title":"Problems with a slow Dependent Subquery","body":"<p>I have a query I'm running in MySQL.  As you can see, every part of the query is on indexed fields.  Nevertheless, the query takes forever (tens of minutes, longer than I'm willing to wait).  The Connect tables consist of two integers and two indexes (one field one, field two, the other field two, field one). Source and target are tables with a single indexed int field.  Given all the indexes, I expected this query to finish in seconds.  Any suggestions on 1: why it's taking so long, and 2: how to make it faster?</p>\n\n<p>Thanks!</p>\n\n<pre><code>mysql&gt; explain \nSELECT DISTINCT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n  JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n  JOIN InDels2 AS source ON source.id = snpEConnect.indelID \n  WHERE geneConnect.geneSymbolID NOT IN (\n    SELECT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n    JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n    JOIN InDels3 AS target ON target.id = snpEConnect.indelID);\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n| id | select_type        | table       | type  | possible_keys     | key      | key_len | ref                                                                   | rows | Extra                          |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n|  1 | PRIMARY            | source      | index | id                | id       | 4       | NULL                                                                  | 5771 | Using index; Using temporary   |\n|  1 | PRIMARY            | snpEConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.source.id                                           |    2 | Using index                    |\n|  1 | PRIMARY            | geneConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.snpEConnect.snpEffectID                             |    1 | Using where; Using index       |\n|  2 | DEPENDENT SUBQUERY | geneConnect | ref   | snpEList,geneList | geneList | 4       | func                                                                  |    1 | Using index                    |\n|  2 | DEPENDENT SUBQUERY | target      | index | id                | id       | 4       | NULL                                                                  | 6297 | Using index; Using join buffer |\n|  2 | DEPENDENT SUBQUERY | snpEConnect | ref   | snpEList          | snpEList | 8       | treattablebrowser.target.id,treattablebrowser.geneConnect.snpEffectID |    1 | Using index                    |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n</code></pre>\n\n<p>6 rows in set (0.01 sec)</p>\n"},{"tags":["sql","database","query","count","db2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13273023,"title":"DB2 - Printing info in a Count","body":"<p>Here is the question and my attempt at an answer. I believe that it's successfully selecting records that have borrowed more than one book, I just don't know how to print the book info.</p>\n\n<p>--Find the cardholders (b_name, b_addr) who have borrowed exactly 3 books. Include in your answer the author and title of the borrowed books. </p>\n\n<pre><code>SELECT DISTINCT b_name, b_addr\nFROM cardholder ch, copy c, book k\nWHERE ch.borrowerid IN (SELECT borrowerid\n                        FROM borrows b\n                        WHERE b.borrowerid = ch.borrowerid \n                        AND c.accession_no = b.accession_no\n                        GROUP BY borrowerid\n                        HAVING COUNT(DISTINCT l_date) = 3);\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13217854,"title":"SQL query combined column values","body":"<p>I'm really not sure how to title this question... Imagine that we have a table looking like this:</p>\n\n<pre><code>object | attribute | value\n------------------------------\n   7     country     Germany\n   7     position    12\n   7     points      12\n   8     country     Germany\n   8     position    10\n   8     points      3\n</code></pre>\n\n<p>Now I want to select all object identifiers that has country germany and position 12 or 5</p>\n\n<p>I have no idea how to write this query, is it possible?</p>\n"},{"tags":["sql","sql-server","query","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13274256,"title":"Swapping rows and columns in a \"Group by\" query","body":"<p>I currently have the following: </p>\n\n<pre><code>SELECT status,count(status) AS count\n  FROM [DB].[dbo].[contact]\n  GROUP BY status\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   |   12\nStatus 2   |   23\nStatus 3   |   63\n</code></pre>\n\n<p>I'm trying to get the table to look like this: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   12        23         63\n</code></pre>\n\n<p>Eventually the table will look like this: </p>\n\n<pre><code>                 Status 1   Status 2   Status 3  \nDate Range 1        12        23         63\nDate Range 2        23        2           3       \n</code></pre>\n\n<p>I'm just not sure what to do now.  What kind of SQL commands / syntax should I study to get this done?  This is my first time looking at SQL so any pointers would be awesome.  </p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13274340,"title":"Create SEQUENCE such that it should initialize on every next day","body":"<p>Suppose SEQUENCE starts from \"1\", today it generated some sequences then on next day it should again start from \"1\".</p>\n\n<p>Is it possible or need to find any workaround ?</p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13267870,"title":"optimizing a delete query for table with no index?","body":"<p>Let's say we have the following tables:\nr(a, b, c)\nwhere a is some integer, and the table has 50 rows\ns(d, e, f, a)\ns.a is a foreign key onto t.a.\neach tuple is 400 bytes and s is a multiset since this is a SQL database.\ns holds about 1 million tuples. \nwhen a table is added, the database server automatically creates an index on the primary-­‐key columns in the table so for example t has an index on a. However, Oracle does not create indexes on columns that are foreign keys. So s has no index.\nWe want to delete 15 rows from t. So here is what we do:\n1) We remove rows from s that have the same a values in t. This takes 10 minutes.\n2) Then we run the statement DELETE FROM t WHERE a IN (values we are trying to remove, 15 of them to be exact)\nThis takes about 6 hours. </p>\n\n<p>So my guess is the second step takes a long time because for every tuple in t, we are comparing the value of a to every value within the query list. So how can we optimize this query to get the same result but much faster!?</p>\n"},{"tags":["sql","sql-server","vbscript","connection-string","adodb"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":1,"question_id":13089112,"title":"Unable to use vbscript to connect to sql server on diffrenet domain","body":"<p>I'm using vbscript to try to connect to a sql server on another domain. The server is part of a cluster and is SQL Server Data Center Edition (64bit). I can ping the server from my machine. I'm using the IP address to connect which works fine on SSMS.\nThe vbscript code I'm using is:</p>\n\n<pre><code>Set cn = CreateObject(\"ADODB.Connection\")\ncn.Open \"DRIVER={SQL Server};Server=123.456.345.567\\instance;Database=MyDB;User\nID=domain\\myuserid;Password=mypass;\"\nstrCommandText = \"Select * from mytable\"\ncn.Execute strCommandText\n</code></pre>\n\n<p>When I run this, I get the following error: \nMicrosoft OLE DB Provider for\nODBC Drivers: [Microsoft][ODBC SQL Server Driver][SQL Server]Login failed for user 'domain\\myuserid'.</p>\n\n<p>I can't join my test machine to the domain and I can't use sql authentication as it's disabled on the sql server.</p>\n\n<p>What do I need to do to get this to work?</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":13273333,"title":"Compare two Tables SQLSE","body":"<p>I want to know if that possible to compare two columns in two different tables in one database using C# with SQLSE.  if the two table has the same data in order, i can say the two tables are match; otherwise, there is no match.</p>\n\n<p>// More info </p>\n\n<p>I want to compare two column has repeated value the two column vlaues come from actual combination of visits for two patients and i want to check do they visit the hospital on the same date and rational insted to go for every 5 combination and compare the match i want to compare the whole table</p>\n"},{"tags":["sql","list","vba","ms-access","northwind"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13273393,"title":"Access DB GUI. Loop through","body":"<p>Well, I need a code to loop through all the records in a table so I can extract some data.Right now I doing it using SQL-queries but it's not good thing. Here's the code</p>\n\n<pre><code>Private Sub booklist_Click()\n    Dim dbs As Database, curBookList As Recordset, qdf As QueryDef, strQuery As String\n\n    strQuery = \"SELECT [Authors].[first_name] as [Name], [Authors].[last_name] as [Surname],[Books].[book_name] as [Book] FROM [Books], [Authors] WHERE [Books].[author_id] = [Authors].[author_id] AND [Books].[taken] = False\"\n\n    Set dbs = CurrentDb()\n\n    Set curBookList = dbs.OpenRecordset(strQuery, dbOpenSnapshot)\n\n\n\n    With dbs\n        Set qdf = .CreateQueryDef(\"Booklist\", strQuery)\n        DoCmd.OpenQuery \"Booklist\"\n        .QueryDefs.Delete \"Booklist\"\n    End With\n\n        dbs.Close\n        qdf.Close\n\nEnd Sub\n</code></pre>\n\n<p>I need to output data in some form and there list should look someting like <code>Inventory List</code> Form in <code>Northwind</code> but an example if book is taken line should be highlighted by red color and if not - green (this thing is responsible for dat in table <code>[Books].[taken]</code> ).</p>\n"},{"tags":["sql","sql-server-2008","udf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13273350,"title":"Splitting long strings in SQL","body":"<p>The inline solution suggested here: <a href=\"http://stackoverflow.com/questions/2647/split-string-in-sql\">Split string in SQL</a> by vzczc only works for strings containing less than 100 elements because of the limit of recursion depth (and you can't change the limit inside a UDF).</p>\n\n<p>Any other ways of splitting long strings with good performance? The UDF I've been using (not inline) has been very slow:</p>\n\n<pre><code>CREATE FUNCTION [dbo].[fn_ParseDelimitedStrings](@String nvarchar(MAX), @Delimiter char(1))\nRETURNS @Values TABLE\n(\n RowId int Not Null IDENTITY(1,1) PRIMARY KEY\n,Value nvarchar(255) Not Null\n)\nAS\nBEGIN\n    DECLARE  @startPos smallint\n        ,@endPos smallint\n\n    IF (@String = '')\n    RETURN\n\n    IF (RIGHT(@String, 1) != @Delimiter)\n        SET @String = @String + @Delimiter\n    SET @startPos = 1\n    SET @endPos = CharIndex(@Delimiter, @String)\n    WHILE @endPos &gt; 0\n    BEGIN\n        INSERT @Values(Value)\n        SELECT LTRIM(RTRIM(SUBSTRING(@String, @startPos, @endPos - @startPos)))\n        -- remove the delimiter just used\n        SET @String = STUFF(@String, @endPos, 1, '')\n        -- move string pointer to next delimiter\n        SET @startPos = @endPos\n        SET @endPos = CHARINDEX(@Delimiter, @String)\n    END\n    RETURN\nEND\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","ssis","ssis-data-transformations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13273885,"title":"How do I fetch only records created in the past year from a table within SSIS package?","body":"<p>I have a column <strong>CT_DT</strong> in a  table. I have to process only transactions created within the past <code>365 days</code>.</p>\n\n<p>For example, suppose the current date is <strong>Nov 7, 2012</strong>, I have to process only those transaction that were created since <strong>Nov 7, 2011</strong>. I am using conditional filter within the SSIS package.</p>\n"},{"tags":["sql","join","syntax","runtime-error"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":5,"view_count":32,"score":-5,"question_id":13255132,"title":"Error in Left Join Syntax when using identical structure of working query","body":"<p>This query is  not working:</p>\n\n<pre><code>Select *\nFrom TableA \nLeft Join TableB on TableA.Parameter_ID = TableB.ID\nWhere TableA.Field = var\n</code></pre>\n\n<p>Table B is a table of multiple parameters to different types given by a 1-->n relationship inside Table A:</p>\n\n<pre><code>Select * \nFrom TableC \nleft join TableB on TableC.Parameter_ID = TableB.ID \nWhere TableC.Field= var\n</code></pre>\n\n<p>I have triple checked spellings and am quite sure I have nothing misspelled. Also I should've got an <code>item could not be found in requested ordinal error</code> if that had been the case. var is different vars btw.</p>\n\n<p>Desired output is max 3 records to a recordset that are then read out by do while loop.</p>\n\n<p>EDIT:\nI tried to handle this via While loop now, meaning I saved the common parameter in a var and now walk through TableB. Now i get \"Runtime Error 80040e14: Syntax error in From Clause\"</p>\n\n<pre>\nSelect * \nFrom TableB \nWhere Id =\" & Var\n</pre>\n"},{"tags":["sql","sqlplus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13273894,"title":"SQL film database queries","body":"<p>I'm having trouble solving the following SQL requests:</p>\n\n<p>1) \"Give the original name and year, also the current name and year, and the studio of the films that were made before '1960' then remade after '2000'.\"</p>\n\n<p>2) \"Get the filmname of all films created before ‘1951’ and remade after ‘2000’\"</p>\n\n<p>There are several tables but I'm assuming that only 2 are needed: 'films' and 'remakes'</p>\n\n<p>'films' attributes: filmid, filmname, year, director, studio</p>\n\n<p>'remakes' attributes: filmid, title, year, priorfilm, prioryear</p>\n\n<p>My understanding is that remakes are included in films so the priorfilm in 'remakes' table corresponds to a filmid in the 'films' table. I'm having trouble linking the two to be able to place the year conditions.</p>\n"},{"tags":["c#","sql","xml","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13273860,"title":"Backslashes in XML returned from stored procedure","body":"<p>I have written a stored procedure that returns my rows as XML with the following syntax:</p>\n\n<pre><code>FOR XML PATH ('customer'), ROOT ('customers'), TYPE\n</code></pre>\n\n<p>Running the query from the stored procedure in SSMS produces output that when clicked, looks just fine.  </p>\n\n<p>However, calling that stored procedure from C# gives me XML that I assume has double quotes that are escaped, thus:</p>\n\n<pre><code>&lt;customers&gt;&lt;customer id=\\\"123456\\\" firstName=\\\"ABE\\\" lastName=\\\"LINCOLN\\\" dob=\\\"02/12/1809\\\"&gt;\n</code></pre>\n\n<p>My C# code looks like this:</p>\n\n<pre><code>public string GetCustomerXML()\n{\n     string xml = string.Empty;\n     XmlDocument xmlDoc = new XmlDocument();\n\n     using (SqlConnection myConnection = new SqlConnection(connectionString))\n     {\n          myConnection.Open();\n\n          using (SqlCommand cmd = new SqlCommand(\"GetData_CreateXML\", myConnection))\n          {\n               cmd.CommandType = CommandType.StoredProcedure;\n\n               using (XmlReader reader = cmd.ExecuteXmlReader())\n               {\n                   while (reader.Read())\n                   {\n                       xmlDoc.Load(reader);\n                       xml = xmlDoc.OuterXml.ToString();\n                   }\n               }\n           }\n     }\n\n     return xml;\n}\n</code></pre>\n\n<p>What am I getting wrong here? </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","sql-server","sql-server-2008-r2","common-table-expression"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13271764,"title":"Split rows in table using CTE","body":"<p>I have the following rows from a table in SQL Server 2008 R2</p>\n\n<pre><code>+-------------------------------------------+\n|  ID          EntryType dt         price   |\n+-------------------------------------------+\n| 14          4         2012-11-07 0.025000 |\n| 16          5         2012-11-07 0.026000 |\n| 18          6         2012-11-07 0.026000 |\n| 20          7         2012-11-07 0.026000 |\n+-------------------------------------------+\n</code></pre>\n\n<p>What I would like to do is spread the rows based on the EntryType (the EntryType doesn't change)</p>\n\n<pre><code>For EntryType = 4 (1 row)\nFor EntryType = 5 (2 row)\nFor EntryType = 6 (3 row)\nFor EntryType = 7 (9 row)\n</code></pre>\n\n<p>and the dt field will be incremented (in a Month interval), so the output looks like this:</p>\n\n<pre><code>+-----------+-----------+-------+\n| EntryType |    dt     | Price |\n+-----------+-----------+-------+\n|         4 | 11/7/2012 | 0.024 |\n|         5 | 12/7/2012 | 0.025 |\n|         5 | 1/7/2013  | 0.025 |\n|         6 | 2/7/2013  | 0.026 |\n|         6 | 3/7/2013  | 0.026 |\n|         6 | 4/7/2013  | 0.026 |\n|         7 | 5/7/2013  | 0.027 |\n|         7 | 6/7/2013  | 0.027 |\n|         7 | 7/7/2013  | 0.027 |\n|         7 | 8/7/2013  | 0.027 |\n|         7 | 9/7/2013  | 0.027 |\n|         7 | 10/7/2013 | 0.027 |\n|         7 | 11/7/2013 | 0.027 |\n|         7 | 12/7/2013 | 0.027 |\n|         7 | 1/7/2014  | 0.027 |\n+-----------+-----------+-------+\n</code></pre>\n\n<p>Is it possible to do that with CTE and SQL?</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13273795,"title":"primary key in many to many table","body":"<p>let say i have two table, User and Language</p>\n\n<pre><code>user (Table Name)\n-----------------\nuser_id (PK)\nuser_name\nmobile\n...\n....\n\nlanguage (Table Name)\n---------------------\nlang_code (PK)\nlang_name\n...\n....\n</code></pre>\n\n<p>The Question is, if i want to add relationship between user and language table(Many to many) which is a right way ?</p>\n\n<pre><code>solution 1\n\nuser_language (Table Name)\n--------------------------\nuser_id (FK)\nlang_code (FK)\n\n\nor solution 2\n\nuser_language (Table Name)\n--------------------------\nuser_id (PK)\nlang_code (PK)\n\n\nor solution 3\n\nuser_language (Table Name)\n--------------------------\nuser_lang_id (PK)\nuser_id (FK)\nlang_code (FK)\n</code></pre>\n\n<p>i saw many people add primary key on many to many table, but i think that not important and wasting space. so which is right ?</p>\n\n<p>btw i'm using PostgreSQL</p>\n"},{"tags":["sql","sql-server-2008","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13273705,"title":"SQL to bring back material names","body":"<p>The below code is a result of a query i have created, it all works fine apart from one thing.  I have Material ID's for material names:</p>\n\n<pre><code>1 = bath\n2 = sink\n3 = toilet\n</code></pre>\n\n<p>The below works but displays sink for every material</p>\n\n<pre><code>Select cu.FName + '  ' + cu.SName as 'Name', \ncu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', \ncu.PostCode, \nco.DateOrdered,\nco.Material1,\nma.MaterialName,\nco.material2, \nma.MaterialName, \nma.Price as 'Item Price' \nfrom Customers cu \nleft join CustomerOrder co on co.CustomerID = cu.CustomerID\nleft join ItemOrder it on it.OrderID = co.OrderID \nleft join Materials ma on ma.MaterialID = co.Material1 \nor co.material2 = ma.MaterialItemID or co.material3 = ma.MaterialItemID\n</code></pre>\n\n<p>it displays as follows (just the materials are listed to stop confusion)</p>\n\n<pre><code>Material1 | MaterialName | Material2 | Material2Name | Material3 | Material3Name\n    1          Sink            2           Sink           3             Sink\n</code></pre>\n\n<p>Can anybody help with this?</p>\n"},{"tags":["sql","drupal","iis","production-environment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13270161,"title":"Is it safe/wise to run Drupal alongside bespoke business web apps in production?","body":"<p>I'm interested to know the general community feeling about the safety of running Drupal alongside bespoke, business critial ASP.NET MVC apps on a production server.</p>\n\n<p>Previously my employer's Drupal based 'visitor website' was hosted as a managed service with a 3rd party. While the LoB sites were hosted in-house. That 3rd party is no longer available so I'm considering my options:</p>\n\n<ol>\n<li>Bring Drupal in-house</li>\n<li>Find another 3rd party</li>\n</ol>\n\n<p>My concern is that I have little experience with Drupal administration (and no experience securing it) and that the addition of PHP to my IIS server poses a security risk.</p>\n\n<p>Is there a best practice that I can follow in this situation?</p>\n"},{"tags":["c#","sql","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13095357,"title":"VS 2010 SQL Update for SQL Statement","body":"<p>Please bear with me as I'm just beginning to learn this stuff. </p>\n\n<p>I have a VS 2010 Web project up and I'm trying to understand how I can make a custom <code>UpdateCommand</code> (Because I chose to write my own SQL statement, I do not have the option for VS 2010 to auto generate an update command for me.) Problem is: I don't know what the <code>UpdateCommand</code> should look like. Here is my Select:</p>\n\n<pre><code>SELECT * FROM Dbo.MainAsset, dbo.Model, dbo.Hardware WHERE MainAsset.device = Hardware.DeviceID AND MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>Which, VS 2010 turns into:</p>\n\n<pre><code>SELECT MainAsset.pk, MainAsset.img, MainAsset.device, MainAsset.model, MainAsset.os, MainAsset.asset, MainAsset.serial, MainAsset.inyear, MainAsset.expyear, MainAsset.site, MainAsset.room, MainAsset.teacher, MainAsset.FirstName, MainAsset.LastName, MainAsset.Notes, MainAsset.Dept, MainAsset.AccountingCode, Model.Model AS Hardware, Model.pk AS Model, Model.DeviceID, Hardware.Computer, Hardware.pk AS Expr3, Hardware.DeviceID AS Expr4 FROM MainAsset INNER JOIN Hardware ON MainAsset.device = Hardware.DeviceID INNER JOIN Model ON MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>How would I approach updating one column, say \"MainAsset.site\" if that's changed in the Gridview DDL? Any help constructive help would be appreciated. Thank you.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273343,"title":"REPLACE new line character in MYSql not working","body":"<p>I executed following query and for some reason its not replacing new line character in database . It says Rows matched 1 but no change . What can be wrong ?</p>\n\n<pre><code>mysql&gt; UPDATE aboutme SET abouttext=REPLACE(abouttext,'\\\\n','') WHERE userid='5099a95cd944b8.22468149';\nQuery OK, 0 rows affected (0.00 sec)\nRows matched: 1  Changed: 0  Warnings: 0\n</code></pre>\n"},{"tags":["php","html","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":41,"score":1,"question_id":13273302,"title":"SQL PHP form error on line 23","body":"<p>I have been trying to write code to insert into different tables but it keeps giving me error on line 23.</p>\n\n<p>This is for a college project registration form.</p>\n\n<pre><code>&lt;?php\n\n$con = mysql_connect(\",\"\",\"\");\nif (!$con)\n{\ndie('Could not connect: ' . mysql_error());\n}\n\nmysql_select_db(\"HNDGeorgeMason\", $con);\n\n$firstname=$_POST['firstname'];\n$surname=$_POST['surname'];\n$username=$_POST['username'];\n$password=$_POST['password'];\n$address=$_POST['address'];\n$postcode=$_POST['postcode'];\n$userid=$_POST['userid'];\n$type=$_POST['type'];\n\nswitch ($_POST['type'])\n{\ncase guides\n $sql=\"INSERT INTO Guides (firstname, surname, type, username, password)\n VALUES ('$firstname', '$surname', '$type', '$username', '$password')\";\n\ncase parents\n $sql=\"INSERT INTO Parents (firstname, surn ame, type, username, password)\nVALUES ('$firstname', '$surname', '$type', '$username', '$password')\"; \n\ncase leaders\n $sql=\"INSERT INTO Leaders (firstname, surname, type, username, password)\n VALUES ('$firstname', '$surname', '$type', '$username', '$password')\"; \n}\n\n mysql_close($con);\n?&gt;\n</code></pre>\n"},{"tags":["mysql","sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13273045,"title":"Converting mySQL select to SQL select","body":"<p>I have this mySQL select statement that works just as I need it to;</p>\n\n<pre><code>SELECT `requires`, `level` FROM `fp` WHERE `model` = '\".$model.\"' GROUP BY `level` ORDER BY `menu_order`\n</code></pre>\n\n<p>In the table both <em>requires</em> and <em>level</em> are char fields. When sorted by *menu_order* the first row of each value of <em>level</em> will always be the value of <em>requires</em> that I want to retrieve.</p>\n\n<p>For the SQL version I use;</p>\n\n<pre><code>SELECT requires, level FROM fp WHERE model = '\" &amp; model &amp; \"' GROUP BY level ORDER BY menu_order\n</code></pre>\n\n<p>Now when I try to run this same query on SQL I get;</p>\n\n<p>requires'_is_invalid_in_the_select_list_because_it_is_not_contained_in_either_an_aggregate_function_or_the_GROUP_BY_clause</p>\n\n<p>I found many examples of this error but all seem to be way more complicated than what I'm trying to do. Maybe I've been using mySQL for so long that my brain is stuck in that way of thinking.</p>\n\n<p>How should that select statement be written in SQL?</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13272148,"title":"DISTINCT ON multiple columns, Order matters?","body":"<p>How is it possible that the order of columns matter in a distinct. I get a different number of rows for</p>\n\n<p><code>\n SELECT DISTINCT ON (the_geom,plz) the_geom\n</code></p>\n\n<p>and </p>\n\n<pre><code>SELECT DISTINCT ON (plz,the_geom) the_geom\n</code></pre>\n\n<p>Any ideas where I am thinking wrong? I am using postgreSQL 9.1.5.</p>\n"},{"tags":["sql","oracle","plsql","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13261037,"title":"Insert into table when data missing","body":"<p>I have the following table, for readability I broke down the after every manager for every case number. </p>\n\n<p>The last column is the cumulative sum of the second last column. </p>\n\n<p>Value for month should ideally run from 1-3 (Like you see for both the cases for Chicago). </p>\n\n<p>But from the table you can see in some cases some entries are missing (marked by &lt;-----). </p>\n\n<pre><code>CITY     CASE   CASE_NUMBER   MANAGER  MONTH  MONTHLY_TOTAL   FISCAL_TOTAL \n---------------------------------------------------------------------------\nchicago  case_1   1             John       1         2              2     \nchicago  case_1   1             John       2         3              5  \nchicago  case_1   1             John       3         5              10\n\nchicago  case_1   1             Jeff       1         4              4     \nchicago  case_1   1             Jeff       2         2              6  \nchicago  case_1   1             Jeff       3         3              9\n\nchicago  case_2   2             John       1         3              3     \nchicago  case_2   2             John       2         2              5  \nchicago  case_2   2             John       3         4              9\n\nchicago  case_2   2             Jeff       1         2              2     \nchicago  case_2   2             Jeff       2         7              9 &lt;----\n\nnewyork  case_1   1             Lee        1         3              3     \nnewyork  case_1   1             Lee        2         4              7 &lt;----\n\nnewyork  case_1   1             Sue        1         2              2     \nnewyork  case_1   1             Sue        2         3              5     \nnewyork  case_1   1             Sue        3         2              7 \n\nnewyork  case_1   2             Lee        1         2              2     \nnewyork  case_1   2             Lee        2         4              6  \nnewyork  case_1   2             Lee        3         4              10  \n\nnewyork  case_1   2             Sue        1         3              3     \nnewyork  case_1   2             Sue        2         2              5 &lt;----\n</code></pre>\n\n<p>What I want is to first find out those missing rows and insert values. </p>\n\n<p>For those missing ones monthly_total = 0</p>\n\n<p>fiscal_total = value in previous row. </p>\n\n<p>E.g. for first missing row it should be:    </p>\n\n<pre><code>CITY     CASE   CASE_NUMBER   MANAGER  MONTH  MONTHLY_TOTAL   FISCAL_TOTAL \n---------------------------------------------------------------------------\nchicago  case_2   2             Jeff       3         0              9\n</code></pre>\n"},{"tags":["sql","database","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13272764,"title":"Retrieve values In the same order of values given in IN caluse","body":"<p>I have a query like (MS ACCESS). \nThe <code>number values in the IN caluse is a variant</code>.In the given example I given only 4.somethimes its more than 30 numbers.</p>\n\n<pre><code>SELECT        ID\nFROM          TableName\nWHERE        (ID IN (16, 18, 15, 20 ))\n\nResult : 15 ,16,18,20 \n</code></pre>\n\n<p>Is there any way to  retrieve values In the <code>same order</code> of values given in <code>IN</code> caluse.<br>\nResult should like  this  <code>Result : 16,18,15,20</code></p>\n"},{"tags":["sql","database","oracle","sql-developer","database-administration"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13272225,"title":"Oracle SQL Developer copy database step by step","body":"<p>I'm having big trouble in copying an Oracle DB to the same server but with another name, to use as a development DB.</p>\n\n<p>I'm used to SQL Server, I'm new to Oracle (11g).</p>\n\n<p>I wanted to use the 'Database copy' from SQL Developer, but I'm getting errors all the way. First it was about missing tablespaces.\nThen when I manually created them in my new empty DB the errors were about missing users.\nI wanted to create the users manually, but then I first needed to create missing roles.\nWhen all that was done, it failed on missing indexes...</p>\n\n<p><strong>How do I copy everything I need with 'Database copy'?</strong></p>\n\n<p>Any advice is greatly appreciated!</p>\n"},{"tags":["sql","model","yii","relations"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13156854,"title":"retrieving a sum of two columns from two related models in yii","body":"<p>I'm fairly new working with yii but have plenty of experience with php and sql.\nI'm hoping that someone more experienced with yii can point me in the right direction. I have two models, Project and Costs, which are related to each other in a many to many relationship through a project_cost table. The reason for this is that costs can be shared between projects. In the project_cost table there is an additional column containing how much of the cost is assigned to the specific project.</p>\n\n<p>So the Project model relations looks like this which is working perfectly fine for getting all the details:</p>\n\n<pre><code>class Project extends CActiveRecord\n{\n\n    /**\n    * @return array relational rules.\n    */\n    public function relations()\n    {\n    return array(\n        'projectcost'   =&gt; array(self::HAS_MANY,   'ProjectCost',    'project_id'),\n        'cost'      =&gt; array(self::HAS_MANY, 'Cost', array('cost_id'=&gt;'id'),'through'=&gt;'projectcost'),\n        //i.e. a many to many relation of cost through the projectcost model\n\n        );\n    }\n    ...\n}\n</code></pre>\n\n<p>In the cost model there is a column named Value and  in the project_cost table there is column name Percent. It is easy to construct a funtion that contains a sql query that gives me the sum for the project cost like this:</p>\n\n<pre><code>select sum(project_cost.Percent*cost.Value) \nfrom project_cost join cost on project_cost.cost_id=cost.id \nwhere project_cost.project_id=1     \n</code></pre>\n\n<p>but is there a way to do the same via relations in yii? I know about STAT relations but am unclear on how they can be applied in this case as most of what I have read so far indicates that relations work best if there are only two models in the relationship.</p>\n\n<p>Any and all help would be greatly appreciated.</p>\n"},{"tags":["android","sql","database","sqlite","upgrade"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13266667,"title":"How to modify type in a table of SQLite in Android, using onUpgrade method?","body":"<p>Following this good example <a href=\"http://code.google.com/p/openintents/source/browse/trunk/notepad/NotePad/src/org/openintents/notepad/NotePadProvider.java?r=3878\" rel=\"nofollow\">http://code.google.com/p/openintents/source/browse/trunk/notepad/NotePad/src/org/openintents/notepad/NotePadProvider.java?r=3878</a></p>\n\n<p>I implement my sqlite database upgrade system. But in the link above the only example show how add new column in a table. The piece of code in the onUpgrade method is</p>\n\n<pre><code> try {\n      db.execSQL(\"ALTER TABLE \" +   NOTES_TABLE_NAME + \" ADD COLUMN \"\n                                                                    + Notes.TAGS + \" TEXT;\");\n      db.execSQL(\"ALTER TABLE \" + NOTES_TABLE_NAME + \" ADD COLUMN \"\n                                                                    + Notes.ENCRYPTED + \" INTEGER;\");\n      db.execSQL(\"ALTER TABLE \" + NOTES_TABLE_NAME + \" ADD COLUMN \"\n                                                                    + Notes.THEME + \" TEXT;\");\n      } catch (SQLException e) {\n      Log.e(TAG, \"Error executing SQL: \", e);\n      // If the error is \"duplicate column name\" then everything is fine,\n      // as this happens after upgrading 2-&gt;3, then downgrading 3-&gt;2, \n      // and then upgrading again 2-&gt;3.\n      }\n      //  *** other upgrade from version x-&gt;y\n      // ***\n</code></pre>\n\n<p>and in onCreate, something like this:</p>\n\n<pre><code>  public void onCreate(SQLiteDatabase db) {\n      db.execSQL(\"CREATE TABLE \" + NOTES_TABLE_NAME + \" (\"\n           // Version 2:\n           + Notes._ID + \" INTEGER PRIMARY KEY,\"\n           + Notes.TITLE + \" TEXT,\"\n           + Notes.NOTE + \" TEXT,\"\n           + Notes.CREATED_DATE + \" INTEGER,\"\n           + Notes.MODIFIED_DATE + \" INTEGER,\"\n           // Version 3:\n           + Notes.TAGS + \" TEXT,\"\n           + Notes.ENCRYPTED + \" INTEGER,\"\n           + Notes.THEME + \" TEXT,\"\n           // Version 4:\n           + Notes.SELECTION_START + \" INTEGER,\"\n           + Notes.SELECTION_END + \" INTEGER,\"\n           + Notes.SCROLL_POSITION + \" REAL\"\n           + \");\");\n          }\n</code></pre>\n\n<p>Now I want a new database version where no column is added, but I want just change type of some field in a table. How can I do this?</p>\n\n<p>Here <a href=\"http://sqlite.org/lang_altertable.html\" rel=\"nofollow\">http://sqlite.org/lang_altertable.html</a> is said that is not possible to change a field type. How can I circumvent the problem?</p>\n\n<p>I'm inserting data in database in this way:</p>\n\n<pre><code>   ContentValues v = new ContentValues();\n   v.put(\"field1\", myString); // fileld1 in db is defined as integer\n\n   dbManager.updateTable(\"mytable\", v, whereClause);\n</code></pre>\n\n<p>How can I make a CAST in this situation?</p>\n"},{"tags":["asp.net","sql","ado.net-entity-data-model"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12707938,"title":"Selecting Data from Different Databases","body":"<p>I have two DB's and an application that gets/sets data using an Entity Data Model in VS 2010.</p>\n\n<p>I do my full stored procedure in DB(A) and then use the EXEC statement in DB(B) to return the data. The data returns fine and is correct, but whenever I run the program I get the following Exception in C#:</p>\n\n<p>The 'AbandonTime' property on 'GetAverageTimes_Result' could not be set to a 'String' value. You must set this property to a non-null value of type 'Decimal'. </p>\n\n<p>I have checked everwhere in the Data Model, the values are Decimal and set as nullable etc etc. Even if I change this to any other type or non-nullable value, I still get the same error. It is incredibly frustrating.</p>\n\n<p>Any help will be appreciated.</p>\n"},{"tags":["php","sql","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":13272591,"title":"Can't fetch results of an SQL statement in PHP","body":"<p>i'm working on a search function in <strong>PHP</strong>, so i do want to be able to research any keyword in all database tables, but i can't fetch the result of the SQL statement which will do :</p>\n\n<pre><code>SELECT * FROM All_Tables\n</code></pre>\n\n<p>here's my code :</p>\n\n<pre><code>$getTables = $this-&gt;db-&gt;query(\"show tables\");\n$tmpString = '';\n\nwhile ($table_data = $getTables-&gt;fetch(PDO::FETCH_NUM))\n{\n    $tmpString.=$table_data[0].',';\n}\n\n$ALL_DATABASE_TABLES = substr($tmpString,0,strlen($tmpString)-1); //Remove the last ,\n\necho \" $ALL_DATABASE_TABLES \"; //  Works, it shows all database tables\n\n$query = \"SELECT * FROM $ALL_DATABASE_TABLES\" ; \n\n$stmt = $this-&gt;db-&gt;query($query) or die(print_r($this-&gt;db-&gt;errorInfo())) ;\n\necho \"Cool1\"; // Works\necho \"$ALL_DATABASE_TABLES \"; //Works\n\n// This Loop doesn't work-----------------------\nwhile ($row = $stmt-&gt;fetch(PDO::FETCH_NUM)) \n{\n    echo \"Cool2\"; // Doesn't work\n\n    echo \"$row[0]\" ; // Doesn't work\n}\n//----------------------------------------------\n\n$stmt-&gt;closeCursor();\n</code></pre>\n\n<p>Do you have any idea about that ? Thank you guys</p>\n"},{"tags":["mysql","sql","select"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13271843,"title":"MySQL Count matching records from multiple tables","body":"<p>Considering the following 4 tables</p>\n\n<pre><code>entity  table1        table2        table3       \n------  ------------- ------------- -------------\nid      ei(entity.id) ei(entity.id) ei(entity.id)\nname    something     somethingelse yetanother\n</code></pre>\n\n<p><strong>How can I figure out entity usage in all three tables</strong>, represented like<br></p>\n\n<pre><code>---------------------\n| id | t1 | t2 | t3 |\n---------------------\n|  1 | 14 | 23 |  0 |\n|  2 | 66 |  9 |  5 |\n...\n</code></pre>\n\n<p>My Original approach was to select from entity then left join other tables but MySQL doesn't seem to like it</p>\n\n<pre><code>SELECT e.id,count(t1.id) FROM entity AS e LEFT JOIN table1 AS t1 on e.id=t1.ei;\n</code></pre>\n\n<p>Edit: Here is the output for 1 table </p>\n\n<pre>mysql> explain select e.id,count(o.id) from entity e left join table1 t1 on e.id=o.ei where e.ty=3;\n+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+\n| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows  | Extra       |\n+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+\n|  1 | SIMPLE      | e     | ALL  | NULL          | NULL | NULL    | NULL |  1083 | Using where |\n|  1 | SIMPLE      | o     | ALL  | NULL          | NULL | NULL    | NULL | 90201 |             |\n+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+\n2 rows in set (0.04 sec)</pre>\n\n<p>The opposite works much better, but doesn't scale to multiple tables</p>\n\n<pre><code>SELECT e.id,count(t1,id) FROM table1 AS t1 LEFT JOIN entity AS e ON t1.ei=e.id\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":57,"score":1,"question_id":13270945,"title":"MySql multiple queries or temporary table?","body":"<p>I need help from a SQL guru here...</p>\n\n<p>I have data in the following format:</p>\n\n<pre><code>Key  Value\n100  A\n100  B\n300  A\n400  B\n500  A\n500  B\n500  C\n600  B\n600  W\n</code></pre>\n\n<p>If I want to find all keys with A or B and A and B, but not AB with anything else...how would I do this?  Would I need a temp table or can I somehow join the table to itself?</p>\n\n<p>EDIT:  The desired output would be Key 100 since it has A &amp; B, Key 300 since it has A, Key 400 since it has B.  Not Key 500 because it also contains a C, and not key 600 because it also contains a W</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13210454,"title":"sql cte if statement","body":"<p>This might be a bad idea but just wondering?</p>\n\n<pre><code>;with Products\nAS\n(\n/* can you have an if statement in here? */\nselect * from products\n\n/* or */\n\nselect * from products \nwhere condition\n\n)\n</code></pre>\n\n<p>what i'm thinking is what if sometimes you have a search string or not. How do you make that a consideration in cte?</p>\n\n<p>Or maybe it would be a better idea to have 2 cte in one procedure?</p>\n"},{"tags":["asp.net","sql","vb.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13271951,"title":"If/Else Statements in VB.NET (SQL) Query?","body":"<p>I just wanted to know what's the best way to add <code>If/Else</code> statements in a SQL query within VB.Net code?</p>\n\n<p>This is my current query (doesn't work):</p>\n\n<pre><code>SELECT \n   FIRSTNAME, LASTNAME \nFROM \n   TBL_USERS \nORDER BY \n   If(SortSelect() Is \"\"lastname\"\", LASTNAME, FIRSTNAME) \n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13272407,"title":"Using a column in USING and WHERE clause","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/456684/mixing-using-and-on-in-oracle-ansi-join\">Mixing “USING” and “ON” in Oracle ANSI join</a>  </p>\n</blockquote>\n\n\n\n\n\n<p>I like the way <code>USING</code> coalesces the columns, so I tried the following on Oracle's example database:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT *\nFROM employees workers\nJOIN jobs USING (JOB_ID)\nJOIN departments USING (DEPARTMENT_ID)\nLEFT JOIN employees managers ON workers.manager_id = managers.employee_id\nWHERE workers.job_id LIKE '%CLERK'\nORDER BY workers.employee_id;\n</code></pre>\n\n<p>With MySQL this runs fine, but Oracle says \"ORA-25154: column part of USING clause cannot have qualifier\". Is there a way to keep using <code>USING</code> or what is the optimal solution?</p>\n\n<p>Regards</p>\n\n<p>TC</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":32,"score":1,"question_id":13272045,"title":"mysql nested select statement","body":"<p>I am newbie for relational tables. As i learn more, i see many advantages of sql statement. However i stuck on some point. </p>\n\n<p>i look for if can get a single table for desired data-set from 5 tables. One of the table named 'eta' is used to connect other 4 tables.</p>\n\n<p>Aim:\nA phone number or email can be used by many users, and users may also have multiple phone number or email address. I want to list the phone numbers or email addresses with the user name that uses them.  </p>\n\n<p>Sample Data:\nPlease  check <a href=\"http://sqlfiddle.com/#!2/60acce\" rel=\"nofollow\">http://sqlfiddle.com/#!2/60acce</a>  for the table structure and sample data-set</p>\n\n<p>The final expected final result for the phone case as follow:</p>\n\n<pre><code>  phone            name    extra\n  45336467      ABC Co.   \n  45336467      Gery      114\n  45336467      Todd      117\n  45336467      Adam      119\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Edit: Explanation for the table relation.</p>\n\n<p>table 'eta' has 4 fields which have table relations. column 'own' shows the company, person etc  value 'f' for company and 'k' for person others will used for different tables </p>\n\n<p>v1_id for id of own field's referred table..</p>\n\n<p>column 'res' refers to email and phone tables. value 't' for phone and 'e' for email.\nv2_id for id of res field's referred table</p>\n"},{"tags":["mysql","sql","database","query","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13272230,"title":"mysql - sum columns from multiple tables based on multiple id's","body":"<p>I have a mySQL database with a couple of identical tables. I need to join all the tables and sum up the views and hits every time the <code>id1</code> and <code>id2</code> are equal in at least 2 tables, or simply show the row if not. </p>\n\n<p>Please see below the tables structure:</p>\n\n<pre><code>Table1:\nid..id2...views...hits\n1...102...55......12\n2...103...12......22\n\nTable2:\nid..id2...views...hits\n1...123...512......13\n2...103...123......43\n\nTable3:\nid..id2...views...hits\n1...102...232......43\n2...103...100......70\n</code></pre>\n\n<p>The end result should be the following table:<br></p>\n\n<pre><code>id...id2...views...hits\n1....102...287....65   &lt;-- This one is the result of adding 1st row of table1 and 2nd row of table 2\n1....123...512....13   &lt;-- This is the 1st row of table2 as there's no other id2 = 123\n2....103...235....135 &lt;-- This is the sum of 2nd row in table1 + 2nd row in table2 + 2nd row in table3\n</code></pre>\n\n<p>I hope this makes sense and someone can help with it.</p>\n\n<p>Thanks !</p>\n"},{"tags":["sql","db2","timestamp","last-modified"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12801289,"title":"Db2 change a column to row update timestamp","body":"<p>In my table I've a column MODIFIED with type TIMESTAMP.\nI want to update this column automatically when the row is updated</p>\n\n<p>I can use this for a new column </p>\n\n<pre><code>alter table my_table add column last_updated timestamp not null\n generated by default for each row on update as row change timestamp \n</code></pre>\n\n<p>But I can't use this to edit the existing column to do the updating automatically</p>\n\n<pre><code>alter table my_table alter column modified set data type timestamp \n not null generated by default for each row on update as row change timestamp\n</code></pre>\n\n<p>Am I using the alter correctly? </p>\n\n<p>the error message is </p>\n\n<pre><code>Error: DB2 SQL Error: SQLCODE=-104, SQLSTATE=42601, SQLERRMC=alter table my_table alter column modified;BEGIN-OF-STATEMENT;&lt;values&gt;, DRIVER=3.50.152\nSQLState:  42601\nErrorCode: -104\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13272029,"title":"Efficient Way to Select if a database row value match a group of string","body":"<p>Efficient Way to Select if a database row value match a group of string</p>\n\n<pre><code>  SELECT id FROM tablename where \n    LeadStatus like \"%Contact Attempt 1%\" or \n    LeadStatus like \"%Contact Attempt 2%\" or \n    LeadStatus like \"%Contact Attempt 3%\" or \n    LeadStatus like \"%Contact Attempt 4%\" or \n    LeadStatus like \"%Contact Attempt 5%\" or \n    LeadStatus like \"%Contact Attempt 6%\" or \n    LeadStatus like \"%Contact Attempt 7%\" or \n    LeadStatus like \"%Call Back/Follow-up%\" or \n    LeadStatus like \"%Working%\" or \n    LeadStatus like \"%Credit Pulled%\" or \n    LeadStatus like \"%Selected other Lender%\" or \n    LeadStatus like \"%Pre-Approved%\" or \n    LeadStatus like \"%Application Taken/Sent%\" or \n    LeadStatus like \"%Application Received%\" or \n    LeadStatus like \"%Submitted%\" or \n    LeadStatus like \"%Funded%\" or \n    LeadStatus like \"%Future Opportunity%\" or \n    LeadStatus like \"%Manager Review%\"\n</code></pre>\n\n<p>I think it clear enough that what I want?</p>\n\n<p><strong>Note :</strong> I can't change the <code>LeadStatus</code> value as it is fetched from a API not in my control </p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13271874,"title":"How to write SQL statement in this case?","body":"<p>For some reason, I'd like to change the database. </p>\n\n<p>It's not possible to change these values manually one by one as there are so much records. </p>\n\n<p>Please advise how to write this SQL, thanks.</p>\n\n<p>From:</p>\n\n<pre><code> id  percentage    type\n  1     6        services\n  1     10       testing\n  3     8        services\n  3     20       testing\n  6     61       services\n  6     90       testing\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>id percentage    type\n1     10       services\n1     10       testing\n3     20       services\n3     20       testing\n6     90       services\n6     90       testing\n</code></pre>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13271676,"title":"LEFT JOIN - How to join tables and include extra row even if you have right match","body":"<p>I have two tables</p>\n\n<pre><code>Table A\n-------\nID\nProductName\n\nTable B\n-------\nID\nProductID\nSize\n</code></pre>\n\n<p>I want to join these two tables</p>\n\n<pre><code>SELECT * FROM\n   (SELECT * FROM A)\n   LEFT JOIN\n   (SELECT * FROM B)\nON A.ID = B.ProductID\n</code></pre>\n\n<p>This is easy, I will get all rows from A multiplied by rows matched in B, and NULL fields if there is no match.</p>\n\n<p>But here comes the tricky question, how can I get all rows from A with NULL fields for table B, even if there is a match, so I get an extra line with NULL values plus all the matches?</p>\n"},{"tags":["sql","tsql","entity-attribute-value"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13270727,"title":"Recreating historical field changes from an EAV audit table","body":"<p>Given the following tables recs and audit, how would one in SQL transform into the resultant table.</p>\n\n<p>A little background, the former table is a simplified example of an standard SQL table used in a CRUD application collecting data. On any update to a column a record is written to an audit table in EAV form. There is now a requirement to transform the recs table into a historical table with a copy of each row as it was at a point in time for reporting (the data will be stored in a star schema data warehouse ultimately.</p>\n\n<p>It seems like this would be straightforward enough in a procedural language and manageable (if ugly) using cursors, but is there a set based approach that would work?</p>\n\n<p>I'm using T-SQL right now, but I imagine that I could port any examples or ideas from any sufficiently rich SQL dialect.</p>\n\n<h2>Setup</h2>\n\n<pre><code>create table recs\n(\n    ID int identity(1,1) not null primary key,\n    Column1 nvarchar(30) not null,\n    Column2 nvarchar(30) not null,\n    sys_updated_on datetime not null\n)\n\ncreate table audit\n(\n    ID int identity(1,1) not null primary key,\n    recs_id int not null,\n    fieldname nvarchar(30) not null,\n    old_value nvarchar(30) not null,\n    new_value nvarchar(30) not null,\n    sys_updated_on datetime not null\n)\n\ninsert into recs (Column1, Column2, sys_updated_on)\nvalues ('A', 'B', '2012-10-31 22:00')\n    , ('C', 'D', '2012-10-31 22:30')\n\ninsert into audit (recs_id, fieldname, old_value, new_value, sys_updated_on)\nvalues (1, 'Column1', 'Z', 'A', '2012-10-31 22:00')\n    , (2, 'Column2','X', 'D', '2012-10-31 22:30')\n    , (1, 'Column1', 'Y', 'Z', '2012-10-31 21:00')\n</code></pre>\n\n<h2>Resultant Data</h2>\n\n<pre>\nRecs            \n\nID  Column1 Column2 sys_updated_on\n1         A       B 31/10/2012 22:00:00\n2         C       D 31/10/2012 22:30:00\n</pre>\n\n<pre>\nAudit                   \n\nID  recs_id fieldname   old_value   new_value   sys_updated_on\n1         1   Column1           Z           A   31/10/2012 22:00:00\n2         2   Column2           X           D   31/10/2012 22:30:00\n3         1   Column1           Y           Z   31/10/2012 21:00:00\n</pre>\n\n<h2>Desired result</h2>\n\n<pre>           \nrecs_id              sys_updated_on       Column1   Column2\n1                          null             Y             B\n1           31/10/2012 21:00:00             Z             B\n1           31/10/2012 22:00:00             A             B\n2                          null             C             X\n2           31/10/2012 22:30:00             C             D\n\n</pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13271400,"title":"Allowing * in SQL query","body":"<p>I have a stored procedure and I want to allow * in it so that if user:</p>\n\n<ul>\n<li>types t* then taller, tea returns</li>\n<li>types * or <em>.</em> then all results are returned</li>\n<li>types t then all results which have t are returned like ptv, tall, sit</li>\n</ul>\n\n<p>my stored procedure is this:</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[SearchEntityDataNew]\n    @SearchText varchar(100) = '*'\n\nAS\nBEGIN\n    SELECT 'Entity' as pagetype,EntityID,EntityData,EntityDataID \n    FROM EntityData \n    WHERE  EntityData LIKE '%' + @SearchText+ '%'\n    OR @SearchText = '*'\n\n    union all\n\n    SELECT 'Property' as pagetype,PropertyID,PropertyValue,EntityDataID  \n    FROM EntityDataProperty \n    WHERE  PropertyValue LIKE '%' + @SearchText+ '%'\n    OR @SearchText = '*'\nEND\n</code></pre>\n"},{"tags":["sql","sql-server","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13260441,"title":"SQL query group by nearby timestamp","body":"<p>I have a table with a timestamp column. I would like to be able to group by an identifier column (e.g. cusip), sum over another column (e.g. quantity), but only for rows that are within 30 seconds of each other, i.e. <strong>not</strong> in fixed 30 second bucket intervals. Given the data:</p>\n\n<pre>\n       cusip| quantity|    timestamp\n============|=========|=============\nBE0000310194|      100| 16:20:49.000\nBE0000314238|       50| 16:38:38.110\nBE0000314238|       50| 16:46:21.323\nBE0000314238|       50| 16:46:35.323\n</pre>\n\n<p>I would like to write a query that returns:</p>\n\n<pre>\n       cusip| quantity\n============|=========\nBE0000310194|      100\nBE0000314238|       50\nBE0000314238|      100\n</pre>\n\n<p>Edit:\nIn addition, it would greatly simplify things if I could also get the MIN(timestamp) out of the query.</p>\n"},{"tags":["sql","db2","ibm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13200776,"title":"Pivoting on a field?","body":"<p>I use IBM DB2 SQL.</p>\n\n<p>Here is my current query:</p>\n\n<pre><code>select \nEXSHPE as \"Shape\",\nEXDLVY as \"Delivery\",\n\n  Sum(Case When EXSURF = 'Print' Then EXRLTO Else 0 End) As Retail_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXRLTO Else 0 End) as Retail_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXRLTO Else 0 End) As Retail_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXRLTO Else 0 End) as Retail_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXRLTO Else 0 End) As Retail_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXRLTO Else 0 End) as Retail_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXWHLO Else 0 End) As Wholesale_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXWHLO Else 0 End) as Wholesale_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXWHLO Else 0 End) As Wholesale_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXWHLO Else 0 End) as Wholesale_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXWHLO Else 0 End) As Wholesale_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXWHLO Else 0 End) as Wholesale_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXUNTO Else 0 End) As Units_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXUNTO Else 0 End) as Units_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXUNTO Else 0 End) As Units_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXUNTO Else 0 End) as Units_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXUNTO Else 0 End) As Units_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXUNTO Else 0 End) as Units_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXAURA Else 0 End) As Actual_AUR_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXAURA Else 0 End) as Actual_AUR_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXAURA Else 0 End) As Actual_AUR_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXAURA Else 0 End) as Actual_AUR_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXAURA Else 0 End) As Actual_AUR_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXAURA Else 0 End) as Actual_AUR_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXMERA Else 0 End) As Merch_AUR_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXMERA Else 0 End) as Merch_AUR_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXMERA Else 0 End) As Merch_AUR_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXMERA Else 0 End) as Merch_AUR_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXMERA Else 0 End) As Merch_AUR_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXMERA Else 0 End) as Merch_AUR_UnknownC\n\nfrom EXOWMSPD\nWhere (EXCO || '/' || EXDIV)  = ?\nGroup By\n  EXSHPE,\n  EXDLVY\nOrder By\n  EXSHPE DESC,\n  EXDLVY DESC\n</code></pre>\n\n<p>Database looks like this:\n<img src=\"http://i.stack.imgur.com/ahMt0.png\" alt=\"enter image description here\"></p>\n\n<p>I need to pivot of Surface, but dynamically.\nThe issue is, I only know the first 3 surface descriptions. But I need to be ready for up to 6.</p>\n\n<p>Is there a way I could pivot this dynamically to grab the first 6 surfaces. </p>\n\n<p>Example, </p>\n\n<pre><code>RETAIL_DOLLARS_1   10.00\nRETAIL_DOLLARS_2   20.00\nRETAIL_DOLLARS_3   50.00\nRETAIL_DOLLARS_4   0.00\nRETAIL_DOLLARS_5   0.00\nRETAIL_DOLLARS_6   0.00\n</code></pre>\n\n<p>In this example, data was found for 3 surfaces, the other 3 I want filled with 0s.</p>\n\n<p>I'm using this to make a report and I'll hide columns which will have SURFACE_DESCRIPTION_X equal to \"\".</p>\n\n<p>Is there a way to do this?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","postgresql","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13270848,"title":"Optimizing PostgreSQL query with multiple joins, order by and small limit","body":"<p>I need some tips for optimizing queries fetching from large tables.</p>\n\n<p>In this example I have 5 tables:</p>\n\n<pre><code>Brands\n- id_brand\n- b_name\n\nProducts\n- id_product\n- p_name\n- ean\n...\n- fk_brand\n\nProd_attributes\n- id_prod_att\n- size_basic\n...\n- fk_product\n\nStores\n- id_store\n- s_name\n...\n\nStocks\n- id_stock\n- stock_amount\n- fk_prod_att\n- fk_store\n</code></pre>\n\n<p>I need a query with ordered list of stocks, limited, so this is the general approach I used:</p>\n\n<pre><code>SELECT stores.s_name, stocks.stock_amount, prod_attributes.size_basic, \nproducts.p_name, products.ean, brands.b_name \n\nFROM (stocks \n    INNER JOIN stores \n    ON stocks.fk_store = stores.id_store) \n    INNER JOIN (prod_attributes \n        INNER JOIN (products \n            INNER JOIN brands \n            ON products.fk_brand = brands.id_brand) \n        ON prod_attributes.fk_product = products.id_product) \n    ON stocks.fk_prod_att = prod_attributes.id_prod_att \n\nORDER BY s_name, p_name, size_basic \n\nLIMIT 25 OFFSET 0\n</code></pre>\n\n<p>This works fast on small tables, but when the tables grow the query gets very expensive. With 3,5M rows in Stocks, 300K in Prod_attributes, 25K Products it executes in over 8800ms, which is not acceptable for me.</p>\n\n<p>All forgein keys have indexes and DB has been vacuum-analyzed recently.</p>\n\n<p>I know that the issue lies in the ORDER BY part, because of it the query does not use indexes and does sequential scans. If I remove the ordering then the query is very fast.</p>\n\n<p>For solving this I know the I can remove ORDER BY, but it's not feasible option for me. De-normalization of the DB or materialized view could help here also - again I would like to avoid this if possible.</p>\n\n<p>What else I can do to speed this query up?</p>\n\n<p>EXPLAIN ANALYZE:<br>\n- slow with order by: <a href=\"http://explain.depesz.com/s/AHO\" rel=\"nofollow\">http://explain.depesz.com/s/AHO</a><br>\n- fast without order by: <a href=\"http://explain.depesz.com/s/NRxr\" rel=\"nofollow\">http://explain.depesz.com/s/NRxr</a></p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":34,"score":-3,"question_id":13271591,"title":"tsql : Delete query","body":"<pre><code>DELETE abc \nFROM abc INNER JOIN xyz ON \nabc.RECORD_TYPE = xyz.RECORD_TYPE AND \nabc.IN = xyz.IN \nOPTION (MERGE JOIN, LOOP JOIN)\n</code></pre>\n\n<p>can anyone tell me what exactly the query doing ? </p>\n"},{"tags":["sql","powershell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13270668,"title":"How to check if a composite primary key values exist in sql table using powershell?","body":"<p>I have 2 primary keys in an sql table, say for eg: ApID and AnID. I want to update the sql table (dbo.ApAn) if the particular composite primary key values exist or else insert new values into the table <strong>through powershell</strong></p>\n\n<p><strong>How can I get the sql table's composite primary keys in powershell?</strong> using a join or something?</p>\n\n<p>Something like:</p>\n\n<pre><code>IF (ApId_AnID-eq 0) { \n#SQL INSERT CODE\n} else { \n#SQL UPDATE CODE\n}\n</code></pre>\n"},{"tags":["sql","database-design","foreign-keys","relational-database","normalization"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13257336,"title":"How best to normalize and reference (FK) locations (Neighborhood/City/Region/Country/Continent)","body":"<p>So I have searched around but haven't found a satisfactory answer.</p>\n\n<p>I have different types of locations, as stated in the title. Given a type of location (i.e. city), the less granular locations can be inferred. I.e. if you know you're in Oregon, it implies you're in the United States, which implies you're in North America.</p>\n\n<p>We have Objects that reference locations, but the granularity is not all the same. Some items might point to neighborhoods, others are only known down to the city level, while some are only known to a region, etc. </p>\n\n<p>There were two ways in which I thought of organizing the data, this is the way I am leaning towards:</p>\n\n<ul>\n<li>Have a generic \"Locations\" table, with a location \"type\" and a \"parent location\" referencing itself. So there'd be an entry for United States of type country, and an entry for Oregon type state which references United States. \ni.e.</li>\n</ul>\n\n<p><img src=\"http://i.stack.imgur.com/KXDz6.png\" alt=\"enter image description here\"></p>\n\n<p>You can then have the object reference the location off its primary key, and then other locations can be inferred. Does this make sense or is there a better way I could be organizing the data?</p>\n\n<ul>\n<li>The other way I considered was with a different table for each location \"type\" but then the problem is having our objects referencing it, since the most granular type of location for an object isn't always the same.</li>\n</ul>\n\n<p>If I were to slip other location types in later, for example counties in between Cities and Regions, might this present a problem? I'm thinking it would be no more a problem than with separate tables, but perhaps there's a better way I can keep track of things in a logical way.</p>\n"},{"tags":["android","sql","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13270649,"title":"Get all dates with optional further data, if a condition is met (Android - SQLite)","body":"<h1>What I have</h1>\n\n<p>I'm working on an Android app with a menu of school canteens. I download data from a remote website and save them to the internal SQLite database to such table (SO Markdown doesn't support tables, hence I'll make it a list):</p>\n\n<ul>\n<li>ID</li>\n<li>TEXT - The name of the meal</li>\n<li>NUMBER - The number of the meal (we can choose from more)</li>\n<li>ORDERED - Boolean, whether the particular meal is ordered or not</li>\n<li>DATE - The date (timestamp) when the meal is server</li>\n</ul>\n\n<p>(and a few more unimportant columns)</p>\n\n<h1>What I need</h1>\n\n<p>I want to provide the user with a list, where for every day when the canteen cooks there is either the meal he has ordered or information, that he hasn't ordered anything for that day.</p>\n\n<p>The question is, how should look my query when I need to get:</p>\n\n<ul>\n<li>Every date that is in the table (once).</li>\n<li>For each date either the info about the ordered meal, or (if there isn't any ordered meal) something from which I can tell that the user will be hungry that day.</li>\n</ul>\n\n<p>Because I want my users to be able to see also the meals they didn't order (so that their friends can look, what they might have), I refuse to keep only the ordered meals.</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["sql","oracle10g","adding","two-columns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13270261,"title":"Add 2 coloumn values together and format output Oracle SQL","body":"<p>I am guessing this is a straight forward task but just cannot seem to get this to work. I want to add to column values together and then format the result in Oracle SQL. So i thought i could do something like:</p>\n\n<pre><code>to_char(INVOICE_NET, '9,999,999.99') + to_char(INVOICE_TAX, '9,999,999.99')  AS GROSS_PRICE\n</code></pre>\n\n<p>This fails as i guess these are no longer numbers\nThen i thought this may work:</p>\n\n<pre><code>INVOICE_NET + INVOICE_TAX AS to_char(GROSS_PRICE, '9,999,999.99')\n</code></pre>\n\n<p>This also fails.\nCan anyone put me straight please on this.</p>\n\n<p>many thanks</p>\n\n<p>JC</p>\n"},{"tags":["sql","vb.net","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13270967,"title":"how to get autoincrement id after tableAdapter.update vb","body":"<p>I am using compactSQL.</p>\n\n<p>I am able to make commit changes but don't know how to get the autoincrement id inserted in table.</p>\n\n<pre><code>  Dim row As Integer = CustomerTableAdapter.Update(ArfDynamicsDataSet.Customer)\n</code></pre>\n\n<p>the row shows number of rows added in db but how can i get the newly added autoincement id.</p>\n\n<p>Thanks </p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13270431,"title":"SQL query and string search","body":"<p>I have that database diagram (MySQL). Each <code>Book</code> has assigned a <code>BookLanguage</code>. Each <code>BookLanguage</code> has two different <code>LanguageNames</code> (the globalization purpose). And also, each <code>Book</code> can have an additional <code>BookLanguage</code> <strong>(but it's not required)</strong>.</p>\n\n<p>And here's the problem - I'm stuck here while building a SQL query for searching for that <code>Books</code>, whose have some string in the <code>BookLanguageNames</code>. It's simple to build the query with joining the <code>BookLanguage</code> and <code>BookLanguageNames</code> but how to cope with the <code>AdditionalBookLanguages</code> ?</p>\n\n<p><img src=\"http://i.stack.imgur.com/QSDM4.png\" alt=\"enter image description here\"></p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":65,"score":3,"question_id":13244369,"title":"MySql Query for generating report","body":"<p>I have one table which is having three fields:</p>\n\n<pre><code>Id, Creation Time, Fuel Level\n</code></pre>\n\n<p>Every two minutes we are getting data and inserting to database.For generating a fuel credit/debit statement i want to get starting(Stating of the day) and ending(End of the Day) Fuel Level.Can anyone help to form a query to generate this report?</p>\n\n<p>Search parameters will be date range.</p>\n\n<p>Id=10;creation time =2019-02-15 16:32:59;Fuel Level =20</p>\n\n<p>I created one sample schema here\n<a href=\"http://sqlfiddle.com/#!2/76dd5\" rel=\"nofollow\">http://sqlfiddle.com/#!2/76dd5</a></p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13270462,"title":"Case when in variable declaration","body":"<p><img src=\"http://i.stack.imgur.com/jvpqC.jpg\" alt=\"enter image description here\"></p>\n\n<p>I'm looking for another column that will give the overall total counts from each gender next to the <code>eduCounts</code> column.  The rest of the query works fine.  Finding the distinct gender counts in this case has to be done by <code>select count(distinct patid) from...</code></p>\n\n<p>first try:</p>\n\n<pre><code>declare @sexcounts int\nset @sexcounts = case when members.sex 'm' then (select COUNT(distinct patid) from members where sex='m')\n                 when members.sex 'f' then (select COUNT(distinct patid) from members where sex='f')\n\nselect sex, edutext, COUNT(*) as eduCounts from \n(\nselect distinct m.patid, m.sex, e.eduText\n    from members as m\n    inner join claims as c on c.patid=m.PATID\n    inner join icdClm as ic on ic.clmid=c.clmid\n    inner join tblICD as t on t.ICD=ic.icd\n    inner join EducationTable as e on e.eduID=m.education\n    inner join IncomeTable as i on i.incomeID=m.income\n    where ISNUMERIC(ic.icd)=1 and SUBSTRING(ic.icd,1,3)='707'\n)t\ngroup by sex, eduText\norder by sex\n</code></pre>\n\n<p>second try:</p>\n\n<pre><code>declare @sexcounts int\nset @sexcounts = (select COUNT(distinct patid),case when sex 'm' then (select COUNT(distinct PATID) from members where sex='m') else (select COUNT(distinct patid) from members where sex='f') \n                    from members)\n\n    select sex, edutext, COUNT(*) as eduCounts from \n    (\n    select distinct m.patid, m.sex, e.eduText\n        from members as m\n        inner join claims as c on c.patid=m.PATID\n        inner join icdClm as ic on ic.clmid=c.clmid\n        inner join tblICD as t on t.ICD=ic.icd\n        inner join EducationTable as e on e.eduID=m.education\n        inner join IncomeTable as i on i.incomeID=m.income\n        where ISNUMERIC(ic.icd)=1 and SUBSTRING(ic.icd,1,3)='707'\n    )t\n    group by sex, eduText\n    order by sex\n</code></pre>\n\n<p>I know I could make a derived table and join on the sex column, but I'd like to know how to do it with a variable if at all possible.</p>\n"},{"tags":["sql","orm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13271185,"title":"Run arbitrary SQL before and after every SQL statement in ORM environment","body":"<p>We use ORM (to be specific, Hibernate as ORM provider and JPA as abstraction) as our database accessing jobs. Now we have to introduce new database auditing platform which needs to run a special SQL before and after every sql statement in order to inject application user name into this platform. How do we integrate this audit sql into ORM's find() save() delete() method?</p>\n"},{"tags":["sql","sql-order-by","temptables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13270543,"title":"Ordered data before update in SQL Server 2008 R2","body":"<p>I have a temp table inside a stored procedure. </p>\n\n<p>What I am doing is fetching data from different table and inserting it into temp table using </p>\n\n<pre><code>INSERT INTO #TempTable\n  SELECT * FROM t1\n  INNER JOIN t2 ON t1.ID = t2.ID\n</code></pre>\n\n<p>After inserting, I need to update one column. Before updating the temp table I want to order the temp table data by another column.</p>\n\n<p>How can I apply <code>ORDER By</code> clause before update clause on temp table?</p>\n"},{"tags":["sql","distinct","collation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13270733,"title":"SQL - distinct case-insensitive collation query - retrieve lower case row instead of first","body":"<p>Using a distinct query with a case-insensitive collation like <code>SQL_Latin1_General_CP1_CI_AS</code> will retrieve the first occurrence of any case-insensitive rows.</p>\n\n<p>But I want to retrieve the lower case if both cases are present.</p>\n\n<p><em>If only one case is present in the data I want to retrieve that case. (unique occurrences of capital case should remain in capital case in the result set)</em></p>\n\n<p><strong>Table:</strong></p>\n\n<pre><code>id | col1  \n----------\n1 | Ab  \n2 | ab  \n3 | cd  \n4 | Cd  \n5 | Ef \n</code></pre>\n\n<p>Query:</p>\n\n<pre><code>SELECT DISTINCT [col1] COLLATE SQL_Latin1_General_CP1_CI_AS \nFROM dbo.table\n</code></pre>\n\n<p>Will retrieve: <code>Ab, cd, Ef</code></p>\n\n<p><strong>But I want to retrieve:</strong> <code>ab, cd, Ef</code></p>\n\n<p><strong>Are there collation that can give me my desired results?</strong> </p>\n\n<p>Give priority to lower case instead of first case.</p>\n\n<p>If not I have to use subselects.</p>\n\n<ol>\n<li>Select all distinct values using case-sensitive collation (strangely is automatically sorted, almost the use case I wanted!)</li>\n<li>Select from 1 using case-insensitive collation</li>\n</ol>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13218282,"title":"sql ce to ms sql server paging query (for razor web pages)","body":"<p>recently i read this article\n<a href=\"http://www.mikesdotnetting.com/Article/150/Web-Pages-Efficient-Paging-Without-The-WebGrid\" rel=\"nofollow\">http://www.mikesdotnetting.com/Article/150/Web-Pages-Efficient-Paging-Without-The-WebGrid</a>\nbut my problem is that article uses sql server ce but im using MS sql server and i want to \nwrite this codes:</p>\n\n<pre><code>sql = \"Select Title, ISBN, Description, FirstName, LastName, Category From Books \" + \n       \"Inner Join Authors on Books.AuthorId = Authors.AuthorId \" + \n       \"Inner Join Categories on Books.CategoryId = Categories.CategoryId \" +\n       \"Order By BookId OFFSET @0 ROWS FETCH NEXT @1 ROWS  ONLY;\";\n\nvar result = db.Query(sql, offset, pageSize);\n</code></pre>\n\n<p>now what is the same query for \"Order By BookId OFFSET @0 ROWS FETCH NEXT @1 ROWS  ONLY;\"\nin sql server,\n and if you know another article to do this in another way thats fine too\n thank u so much guys</p>\n"},{"tags":["java","sql","database","query","jdbc"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":69,"score":-2,"question_id":13270154,"title":"SQL statements are being stored into database instead of values (simple but challenging )","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their username (their email address) so as to fill in an input form. The functionality of the input form is that the user has to enter for book names in order of priority.</p>\n\n<p>In the application, suppose a user's email address is \"david.ferno@gmail.com\". He will have to input only \"david.ferno\" in the JTextBox, and a SQL LIKE statement is used check the corresponding User ID from the \"bookuser\" table and store it into the \"priority\" table along with the book priority choices.</p>\n\n<p>I have used PreparedStatement for the SQL retrieval from database but when values are being inserted to the , instead of saving User ID like \"user88\", it is saving the SQL statement itself inside the database.</p>\n\n<p>What I mean to say is, in the \"priority\" table, instead of saving user88 (as an example), it is saving \"SELECT User_ID FROM user WHERE email_address\"</p>\n\n<p>Please help me to find out what is wrong with my code.</p>\n\n<p><strong>Here is the \"user\" table structure >></strong> <br/></p>\n\n<pre><code> COLUMNNAME     TYPE\n ------------------- \n User_ID        Text\n full_name      Text \n last_name      Text\n email_address  Text\n phone          Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key</p>\n\n<p><strong>Here is the \"priority\" table structure >></strong> <br/></p>\n\n<pre><code>COLUMNNAME  TYPE \n----------------\nUser_ID     Text \nBook1       Text \nBook2       Text \nBook3       Text\nBook4       Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key </p>\n\n<p><strong>Here are my codes</strong></p>\n\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport javax.swing.*;\nimport java.sql.*;\nimport javax.*;\n\n  public class Handleraddclassroom implements ActionListener{\n\n      public void actionPerformed(ActionEvent event) {\n          String name = ((JButton)event.getSource()).getText();\n\n          if (name.equals(\"Confirm\")) {\n              String filename = \"C:/JAVA/book.accdb\";\n              String database = \"jdbc:odbc:booking\";\n\n              if(txt_mail.getText().equals(\"\")) {\n                   JOptionPane.showMessageDialog(\n                                     addpriority.this, \n                                     \"Your Username Field cannot be blank\");\n              } else {\n                   try {\n                       Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                       //username &amp;password not being used\n                       Connection con = DriverManager.getConnection(database ,\"\",\"\"); \n                       Statement s = con.createStatement(\n                                          ResultSet.TYPE_SCROLL_INSENSITIVE, \n                                          ResultSet.CONCUR_READ_ONLY);\n\n                       String squery = \"SELECT User_ID FROM bookuser WHERE \" +\n                                        + \"email_address LIKE ?\";\n                       PreparedStatement pstmt = con.prepareStatement(squery);\n                       pstmt.setString (1, txt_mail.getText() + '*');\n                       pstmt.executeQuery();\n\n                       String sql = \"INSERT INTO priority VALUES('\" \n                                                 + squery + \"','\"\n                                                 + txt_book1.getText() + \"','\"\n                                                 + txt_book2.getText() + \"','\" \n                                                 + txt_book3.getText() + \"','\"\n                                                 + txt_book4.getText()+ \"')\";\n\n                       JOptionPane.showMessageDialog(addpriority.this,\n                                                     \"Choice Records Saved.\");\n\n                       dispose();\n                       Mainmenulecturer mml = new Mainmenulecturer();\n\n                       s.execute(sql);\n\n                       s.close();\n                       con.close();\n\n                   } catch (Exception e) {\n                        System.out.print(\"Error: \" + e);\n                   }\n              }\n          }\n      }   \n\n}\n</code></pre>\n"}]}
{"total":102597,"page":5,"pagesize":100,"questions":[{"tags":["sql","oracle","plsql","oracle11g"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":35,"score":6,"question_id":13269676,"title":"Issue when comparing result of to_char(myDate, 'DAY') to a string","body":"<p>I have been trying to find what the issue might be but I am just out of luck and don't understand this problem at all.I have the following code:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION ckeckDay(dateC in date)\nRETURN VARCHAR\nIS\n  day VARCHAR(15);\n  checkFriday VARCHAR(1);\nBEGIN\n  checkFriday := 'N';\n  day := to_char(dateC, 'DAY');\n  IF day = 'FRIDAY' THEN\n    checkFriday := 'Y';\n  END IF;\n  RETURN day;\nEND;\n/\n</code></pre>\n\n<p>the <code>dateC</code> is set to Friday (even tested it by returning <code>day</code> instead of the <code>day</code> variable and it returns Friday.) However the <code>IF</code> statement never evaluates to true even though the <code>day</code> variable is indeed Friday.Any ideas how to go around this issue.Thanks</p>\n"},{"tags":["sql","sql-server","sql-server-2008","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13267862,"title":"Where I can check user-define table type in SQL Server 2008 in SSMS? and how can I insert new column into it?","body":"<p>I need to add some more columns into my current <code>user-define table type in SQL Server 2008</code></p>\n\n<p>But I didn't see any table type in particular database under <code>Tables</code> .</p>\n\n<p>Where exactly I need to check and how can I modify the design of existing <code>user-define table type in SQL Server 2008</code></p>\n\n<p>I'm using <code>SQL SERVER 2008</code> and <code>SSMS</code></p>\n\n<p>Where I can find that table in <code>SSMS</code> , </p>\n\n<p>so that I can go and modify table type.</p>\n\n<p>thanks</p>\n\n<p>for previous question answer </p>\n\n<p>Please can any one help to sql <code>alter type table</code> syntax <code>add column</code> ?\nhow can I insert any new column ... as ALTER is not working.. it is disable </p>\n"},{"tags":["sql","sql-server-2000","default"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":592,"score":2,"question_id":1865657,"title":"Alter column's default value","body":"<p>I  have a table which has a column 'CompanyID int not null' and its default value is set to 10. Now I want to write a query which will alter this default value to 1. How can can I do it?</p>\n\n<p>Any help will be appreciated. I am using SQL server 2000.</p>\n"},{"tags":["mysql","sql","sql-update","ranking"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1315,"score":4,"question_id":3196971,"title":"MySQL update statement to store ranking positions","body":"<p>I'm trying to get my head around a query and I just can't figure it out. I would appreciate if someone give me a pointer. As a simple example of what I'm trying to achieve, I have these records in the database</p>\n\n<pre><code>Score|Ranking\n-------------\n100  |0\n200  |0\n300  |0\n</code></pre>\n\n<p>And I would like the Ranking field to contain 1,2,3 based on who's got the highest score so the result should be:</p>\n\n<pre><code>Score|Ranking\n-------------\n100  |3\n200  |2\n300  |1\n</code></pre>\n\n<p>At the moment, I'm doing a for next loop for all these records but given that in reality that could be a few thousand - that could take forever! Does anyone have an idea on a magic query which would do this in one go?</p>\n"},{"tags":["sql","performance"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":42,"score":-2,"question_id":13270502,"title":"sql - what is the difference between these two queries?","body":"<pre><code>select a.Name from rat. Assessment a where a.AssessmentId = '3'\nselect a.Name from rat. Assessment a where a.AssessmentId = 3\n</code></pre>\n\n<p>whats the difference performance wise ?\nis it slow for the first one ?</p>\n\n<p>How can i know if sql server has casted the the column or value to match the the column type or value type ?</p>\n\n<p>I saw the execution plan. cant understand much.</p>\n"},{"tags":["sql","sql-server","query","datepart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13270325,"title":"Using DATEPART for AM works correctly but does not work for PM query","body":"<p>I'm using a query to pull a report for our 3rd shift folks.  </p>\n\n<p>The issue I just noticed when the report was mailed with 0 results is that I have it set right now to run from 6pm to 5:59am the next morning.  Since I have the date field = the <code>GETDATE</code>, it doesn't see the results from the night prior(1800-2359).  I was thinking of having this just pull from like -12 hours, but the button can be pressed at anytime to look at results.  </p>\n\n<p>So if they pushed it before the end of the shift, it would show some of 1st shifts entries.  I want it to only run from 1800-0559 the next morning, no matter if the button is pressed before midnight or after midnight.  I hope this makes sense.  I'm not even sure if the between recognizes to go to 00 after it's hit 2359.  I have this built into a VB.net application, and they can press the button anytime they want to get results.  This is for management to track what is being done as the employees are required to enter data real time when issues are taking place.  </p>\n\n<p>Thanks for any help.  Hope I made enough sense!  :D</p>\n\n<pre><code>SELECT \n   Assignment, Datemodified, General, \n   IncNumber, NextSteps, PDCRStatus, \n   RootCause, Status, Summary, \n   Timings, UserID \nFROM \n   Turnover \nWHERE DATEPART(HOUR, datemodified) between 18 and 05 \nAND CONVERT(NVARCHAR(50),datemodified,103) = CONVERT(NVARCHAR(50),GETDATE(),103);\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13263023,"title":"Need advice to re-create history of a table based on audit tables","body":"<p>OK folks, I have an urgent need. I am tasked with re-creating an accurate history of changes to  multiple fields of an active table retroactively based on individual audit tables for each field.  I have a SQL Server Agent job that does this currently on a daily basis starting 10/16/2012, but need to immediately add records to retrofit the history back to 1/1/2012.</p>\n\n<p>To compound my issue, I need to reflect daily changes to the full hierarchy from the top down based on these audit records.</p>\n\n<p>Here's what I have:</p>\n\n<p>Active Table:</p>\n\n<pre><code>empId varchar(20),\nfirst_name varchar(50),\nlast_name varchar(50),\ncost_center varchar(20), -- need to re-create history\nmgr_empId varchar(20), -- need to re-create history\nstart_dt date, -- starting date range of active record\nend_dt date, -- end of active record - default value of 12/31/2999 = active record\nhierarchy_empId varchar (200), --derived field from a nasty self-referencing function (12x)\nhierarchy_name varchar(1000) -- derived from the same functino as the field above.\n</code></pre>\n\n<p>Example:</p>\n\n<p>Employee A1000, Tim Lee enters the org on 3/1/2012 with manager Bill A with emp Id B1000 into cost center 01552.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   12/31/2999   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999   B1000         Bill A\n</pre>\n\n<p>On 5/1/2012 the nightly job picks up a delta for Tim, and Tim's cost center changes to  31550.  So his current record is updated with an end date of yesterday, and a new \"current\" record is entered, reflected below:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   4/30/2012   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999  B1000         Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012   12/31/2999  B1000>A1000   Bill A>Tim Lee\n</pre>\n\n<p>On 6/15/2012, a new manager Ben C, emp Id C1000, was hired underneath Tim's manager:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000         Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    12/31/2999  B1000               Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000         Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   12/31/2999  A1000>C1000         Bill A>Ben C\nA1000  Tim Lee  31550   B1000   6/15/2012   12/31/2999  B1000>C1000>A1000   Bill A>Ben C>Tim Lee\n</pre>\n\n<p>These updates must trickle down the hierarchy.  So, if something changes above Tim, it also must be reflected in his record.   </p>\n\n<p>On 7/15, Tim's original manager Bill A gets a new manager, Mark S, emp Id X3000.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000               Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    7/14/2012   B1000                     Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000               Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   7/14/2012   A1000>C1000               Bill A>Ben C\nA1000  Tim Lee  31550   C1000   6/15/2012   7/14/2012   B1000>C1000>A1000         Bill A>Ben C>Tim Lee\nX3000  Mark S   01000   NULL    7/15/2012   12/31/2999  X3000                     Mark S\nA1000  Tim Lee  31550   C1000   7/15/2012   12/31/2999  X3000>B1000>C1000>A1000   Mark S>Bill A>Ben C>Tim Lee\nB1000  Bill A   01552   X3000   7/15/2012   12/31/2999  X3000>B1000               Mark S>Bill A\nC1000  Ben C    31550   B1000   7/15/2012   12/31/2999  X3000>B1000>C1000              Mark S>Bill A>Ben C\n\n</pre>\n\n<p>I have these audit tables:</p>\n\n<p><strong>tblManagerAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimestamp datetime,\noldMgr varchar(20),\nnewMgr varchar(20)\n</code></pre>\n\n<p><strong>tblCostCenterAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimnestamp datetime,\noldCostCenter varchar(20),\nnewCostCenter varchar(20)\n</code></pre>\n\n<p>I have struggled with how to combine the audit records for a very long time and appreciate any input.</p>\n"},{"tags":["sql","scala","jdbc","playframework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13260429,"title":"Sql Update command used in play framework (scala) does not seem to be working","body":"<p>I have my Sql table setup as follows</p>\n\n<pre><code>create table contact(\nid                      bigint not null,\nfirst_name                varchar(255) not null,\nlast_name                 varchar(255) not null,\nphone                     varchar(255) not null,\nemail                     varchar(255) not null,\ncompany                   varchar(255) not null,\nexternal_access           varchar(255),\nonline_status             varchar(12),\nconstraint pk_computer primary key (id));\n</code></pre>\n\n<p>So initially i input data values into the table except for external_access and online_status.Then I try to update online_status using the function below.</p>\n\n<pre><code>DB.withConnection { implicit connection =&gt;\nSQL(\n  \"\"\"\n     update contact\n     set online_status = online\n     where email = {email}\n  \"\"\"\n     ).on(\n       'email -&gt; email\n         ).executeUpdate()\n  } \n</code></pre>\n\n<p>So after the online status is updated, I try to display the page again by using </p>\n\n<pre><code>  select * from contact  \n</code></pre>\n\n<p>(The above code is just the gist. Actual display function is the page display function List of <a href=\"https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala\" rel=\"nofollow\">https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala</a>)</p>\n\n<p>However, the online_status is not yet updated. It continues to display nothing(in the online_status column). Can someone help me debug this </p>\n"},{"tags":["java","sql","netbeans","derby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13267627,"title":"Netbeans java application - executing query on derby database","body":"<p>I'm building a Java Application with an embedded database on Netbeans 7.2.1. For now, i'm able to establish a connection with the derby database through the following code:</p>\n\n<pre><code>Connection con = DriverManager.getConnection(\n                     \"jdbc:derby:database;create=true\",\n                     uName,\n                     uPass);\n</code></pre>\n\n<p>However, i'm not being able to execute queries on the tables of the database. After some research, i tried to execute the following code, but without success:</p>\n\n<pre><code>Statement stmt = con.createStatement();\n    ResultSet rs;\n    rs = stmt.executeQuery(\"SELECT descricao FROM fichas\");\n\nwhile (rs.next()) {\n    String s = rs.getString(\"descricao\"); \n    System.out.println(s);\n}\n</code></pre>\n\n<p>I have two problems here. First, based on the search i do i should use Statement stmt as in the example above but netbeans gives me an error. To being able to execute the method \"stmt.executeQuery()\" that follows him i have to define statement as:</p>\n\n<pre><code>java.sql.Statement stmt = con.createStatement();\n</code></pre>\n\n<p>if i don't use it like this i can't pick the method \"executeQuery\". Second, even using this the querie doesn't execute. It gives me the error on console: \"java.sql.SQLSyntaxErrorException: Schema 'ADMIN_DATABASE' does not exist\".</p>\n\n<p>Any hints how can i solve this? Thank you!</p>\n\n<p>NEW UPDATES:</p>\n\n<p>I was running some tests and here they are some new conclusions. If instead of creating the tables through the services panel of the netbeans, i run the code:</p>\n\n<pre><code>stmt.execute(\"create table test_table (name varchar(128))\");\n</code></pre>\n\n<p>it works. The table is created and if i try again it gives the expected error that the table already exists. However, i look at the services panel, att the app embedded derby database and this 'test-table' is not there together it the others.</p>\n\n<p>Adding to that, if i execute a select on that table it gives no schema error but in the others i created manually on the services panel it continues to give the error.</p>\n\n<p>So, can anyone please explain to me what's the diference? Where the test_table i created goes? What's the difference between this mode of creation and the one of creating the tables on derby? Why i receive schema erros with ones and not with the others?</p>\n\n<p>Sorry for so many questions but now i'm very confused. Thank you!</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13269545,"title":"SQL View creation error","body":"<p>I am trying to copy a view from one database to another and get the error :</p>\n\n<blockquote>\n  <p>Msg 4121, Level 16, State 1, Procedure vwPAProjects_Summary_New_2 \n  Line 2<br>\n  <em>Cannot find either column \"dbo\" or the user-defined function or\n  aggregate \"dbo.GetContractName\", or the name is ambiguous</em></p>\n</blockquote>\n\n<p>The view I am copying over is:</p>\n\n<pre><code>USE [GRAUD]\nGO\n/****** Object:  View [dbo].[vwPAProjects_Summary_New_2]    Script Date: 11/07/2012 11:57:30 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE VIEW [dbo].[vwPAProjects_Summary_New_2] AS \nselect\n dbo.GetContractName(PAPROJNUMBER) 'CONTRACT',\nPACONTNUMBER,\nisnull(dbo.GetEmployeeName(PABusMgrID),dbo.GetContractPartner(PACONTNUMBER)) 'Project Manager ID',\ncase PASTAT\nwhen 1 then 'Open'\nelse 'Closed'\nend 'Status',\ncase PAProjectType\nwhen 3 then 'Fixed Price'\nelse 'Time and Materials'\nend 'Project Type',\nPAProject_Fee_Amount 'Project Fee Amount',\nPAFTotalCost 'Forecast Total Cost',\n(PAProject_Fee_Amount - PAFTotalCost) 'Forcast Profit',\ncase\n    when PAProject_Fee_Amount = 0 then '0.00%'\n    else cast(cast(((PAProject_Fee_Amount - PAFTotalCost)/PAProject_Fee_Amount)*100 as decimal(19,2)) as varchar(21)) + '%'\nend 'Forcast %',\nPAPostedBillingsN 'Actual Billings',\nPAPostedTotalCostN 'Actual Total Cost',\n(PAPostedBillingsN - PAPostedTotalCostN) 'Current Actual Profit',\ncase\n    when PAPostedBillingsN = 0 then '0.00%'\n    else cast(cast(((PAPostedBillingsN - PAPostedTotalCostN)/PAPostedBillingsN)*100 as decimal(19,2)) as varchar(21)) + '%'\nend 'Current %'\n\nfrom PA01201\nwhere PASTAT = 1\n</code></pre>\n\n<p>Can anybody advise on how I can get this to copy over?  It has worked on other databases after I have copied it over but I cannot see any differences that would stop it this time?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13269787,"title":"SQL Server backup failing. Error: 3041, Severity: 16, State: 1","body":"<p>First of all, I'm very new at stackoverflow, so please bear with me.</p>\n\n<p>I'm running a SQL Server 9.0.4060.</p>\n\n<p>My problem is: my SQL Server backup keeps failing on a lot of the databases.</p>\n\n<p>The Maintenance plan runs to different backup jobs:</p>\n\n<p>DIFF backup everyday at 20:30 and FULL backup every Sunday at 20:30.</p>\n\n<p>I get these two errors foreach database that fails to complete the backup:</p>\n\n<pre><code>Date        06-11-2012 20:31:06\nLog     SQL Server (Current - 07-11-2012 11:43:00)\nSource      Backup\nMessage\nBACKUP failed to complete the command BACKUP DATABASE (dbname) WITH DIFFERENTIAL. Check the backup application log for detailed messages.\n\nDate        06-11-2012 20:31:06\nLog     SQL Server (Current - 07-11-2012 11:43:00)\nSource      Backup\nMessage\nError: 3041, Severity: 16, State: 1.\n</code></pre>\n\n<p>If you guys need any other information, just say the word.</p>\n"},{"tags":["sql","compare","temp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13269327,"title":"SQL Comparing Information in Tables","body":"<p>I want to know how I would compare two pieces of information such as say I have two columns in my query: <code>surname</code> and <code>forename</code>. How could I check to see whether the <code>forename</code> exists in the <code>surname</code> column and visa versa?</p>\n\n<p>So far I've created two temporary tables, one which selects just the <code>surname</code>, and one which selects all the other information. I was going to compare them by doing a join but im having no luck.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13269586,"title":"SQL adding additional columns to a query","body":"<p>I'm trying to create a query that allows me to see all of the customers orders and to add an additional column using sql to view the total amount that the customer owes.</p>\n\n<p>the following code retrieves the correct data:</p>\n\n<pre><code>SELECT\n    cu.FName + '  ' + cu.SName as 'Name', \n    cu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', \n    cu.PostCode, \n    co.DateOrdered, co.DateDispatched, \n    ma.MaterialName, \n    it.Quantity, \n    ma.Price as 'Total' \nFROM\n    Customers cu \nLEFT JOIN \n    CustomerOrder co ON co.CustomerID = cu.CustomerID \nLEFT JOIN\n    ItemOrder it ON it.OrderID = co.OrderID \nLEFT JOIN \n    Materials ma ON ma.MaterialID = it.MaterialID \n</code></pre>\n\n<p>I now need to add additional code to the above to add a column to show the total amount the customer owes, but I'm stuck, can anybody help?</p>\n\n<pre><code>Date Order   |    Dispatch Date | Item  | QTY  |   Price | TOTAL AMOUNT FOR BOTH ROWS\n2012-10-30   |    2012-11-25    | Bath  | 1    |   49.99 |  \n2012-10-30   |    2012-11-25    | Sink  | 1    |   55.99 |\n</code></pre>\n"},{"tags":["c#","asp.net","sql","database","polling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13269609,"title":"Datatable: Does it retrieve all data at once or when it is needed","body":"<p>We have a performance problem in production, we are trying to solve. During our attempt to solve it, we have our eyes on the datatable. </p>\n\n<p><strong>Our flow</strong>:</p>\n\n<ol>\n<li>We run a select query on the database</li>\n<li>Put the data into a <code>DataTable</code></li>\n<li>We write out all the data into a <code>StringBuilder</code> with a separator</li>\n<li>The <code>StringBuilder</code> writes all text into the <code>Response.Write</code>, which builds a CSV file</li>\n</ol>\n\n<p>The problem is in production, our client says the operation times out. We can't reproduce the timeout in development, which might be because of the amounts of data in production.</p>\n\n<p><strong>Step 1</strong>:</p>\n\n<p>We've run a profiler on the select query, and that runs really fast.</p>\n\n<p><strong>Step 2</strong>:</p>\n\n<p>We have the following code:</p>\n\n<pre><code>SqlDataReader reader = searchQuery.ExecuteReader();\nreturnTable.Load(reader);\n</code></pre>\n\n<p><strong>Step 3</strong>:</p>\n\n<p>We iterate the <code>returnTable</code> like this:</p>\n\n<pre><code>foreach (DataRow order in orders.Rows)\n{\n      trackingNumber = order[\"TrackingNumber\"] != null ? order[\"TrackingNumber\"].ToString() : errString;\n      created = order[\"Created\"] != null ? ((DateTime)order[\"Created\"]).ToString() : errString;\n      // rest of the fields\n}\n</code></pre>\n\n<p><strong>Step 4:</strong></p>\n\n<pre><code>HttpContext.Current.Response.Write(bld.ToString());\n</code></pre>\n\n<p>Now, when we have run step 2, what happens? Is the <code>DataTable</code> fully loaded? </p>\n\n<p>I could see a problem if we poll the database in each and every row in step 3, as that could slow our process. But if it loads it all at once, I can't see how this could be a problem.</p>\n\n<p>So basically: does the <code>DataTable</code> load everything at once, or does it use lazy loading?</p>\n"},{"tags":["mysql","sql","wordpress","wordpress-mu"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":483,"score":4,"question_id":3817540,"title":"How can I simultaneously query all blog options table in a Wordpress multisite installation (3.0)?","body":"<p>In our Wordpress 3.0 multi-site installation, we have a custom option for all of our blogs called something like 'platform'. Admins can enter in a value for this platform when creating or editing a blog. Some blogs may have no platform.</p>\n\n<p>We need to be able to create a list of all platforms, and their associated blogs. The problem is, we dynamically create and delete blogs through other site mechanisms, so we have lots of blog options tables with numbers that are not necessarily contiguous. (ie wp_2_options, wp_4_options, wp_12_options, etc.)</p>\n\n<p>My question is this, is there a way in Wordpress to grab an option across all blogs? Conversely, is there a query I could run that would do this manually? I've tried something like this to no effect:</p>\n\n<p>SELECT * FROM\n  (SELECT table_name\n  FROM information_schema.tables\n  WHERE table_name like 'wp_%_options') as t\nWHERE option_name='platform'</p>\n\n<p>Does it make sense what I'm trying to do? Again, I apologize for my lack of MySql knowledge, but I haven't been able to find any answers about how to do this. I could also query all these table names first, and then query each table separately, but thats not really an option because we have many blogs, and we may need to run this query for many page requests simultaneously, and this would be adding hundreds of queries to each of these requests.</p>\n\n<p>Any advice or help you guys could give would be greatly appreciated.</p>\n"},{"tags":["sql","ibm","clearquest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":7178329,"title":"Rational ClearQuest : sql query get Watchers accociated with a particular CQ issue","body":"<p>I am trying to query this database cq_production_user that is part of IBM Rational ClearQuest.</p>\n\n<p>I have been launching these queries from sql server express 2008 client.</p>\n\n<p>How do I get all of the Watchers associated with a particular ClearQuest issue?</p>\n\n<p>Your help in this matter would be greatly appreciated.</p>\n\n<p>Thank You</p>\n"},{"tags":["sql","reference","updates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13268724,"title":"SQL How to change value With all References","body":"<p>Is there an easier way to change a single value in a row together with its Reference , and that Reference's reference, Instead of backtracking through 20 tables to find the beginning of it all?</p>\n\n<p>Links to Answers\n--<a href=\"http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls118.htm\" rel=\"nofollow\">On Cascade</a> (Thanks Javier)</p>\n\n<pre><code>ALTER TABLE catalog DROP CONSTRAINT aa\n\nALTER TABLE catalog ADD CONSTRAINT\n   (FOREIGN KEY (stock_num, manu_code) REFERENCES stock\n   ON DELETE CASCADE CONSTRAINT ab)\n</code></pre>\n"},{"tags":["c#","sql","xml","nodelist","xmlnodelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13269221,"title":"Reading XML file via XML nodes","body":"<p>I have this XML document I am trying to read in and insert into a data base. There will only ever be one GamePlay node however GamePlayStep may repeat so I have created a node list for this. For some reason GamePlayStep isn't receiving data. Here is the XML file: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;GameData&gt;\n  &lt;GamePlay&gt;\n    &lt;type&gt;add&lt;/type&gt;\n    &lt;GamePlayID&gt;1&lt;/GamePlayID&gt;\n    &lt;ParticipantID&gt;1&lt;/ParticipantID&gt;\n    &lt;GameID&gt;1&lt;/GameID&gt;\n    &lt;GameDifficultyID&gt;1&lt;/GameDifficultyID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;Success&gt;False&lt;/Success&gt;\n  &lt;/GamePlay&gt;\n  &lt;GamePlayStep&gt;\n    &lt;GamePlayStepID&gt;1&lt;/GamePlayStepID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;SortOrder&gt;1&lt;/SortOrder&gt;\n    &lt;Score&gt;1&lt;/Score&gt;\n    &lt;hintUsed&gt;True&lt;/hintUsed&gt;\n    &lt;GamePause&gt;\n      &lt;GamePauseID&gt;1&lt;/GamePauseID&gt;\n      &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n      &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n      &lt;Order&gt;1&lt;/Order&gt;\n      &lt;Duration&gt;05:01&lt;/Duration&gt;\n    &lt;/GamePause&gt;\n  &lt;/GamePlayStep&gt;\n&lt;/GameData&gt;\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>public static void start()\n        {\n            string[] filePaths = Directory.GetFiles(System.Configuration.ConfigurationManager.ConnectionStrings[\"filePath\"].ConnectionString);\n            List&lt;GamePlay&gt; gameObj = new List&lt;GamePlay&gt;();\n            List&lt;GamePlayStep&gt; gameStepObj = new List&lt;GamePlayStep&gt;();\n            foreach (string value in filePaths)\n            {\n                XmlDocument xd = new XmlDocument();\n                XmlNodeList GameSteps;\n                xd.Load(value);\n                XmlNode documentNode = xd.SelectSingleNode(\"/GameData/GamePlay\");\n                GameSteps = xd.SelectNodes(\"/GameData/GamePlay/GamePlayStep\");\n\n                GamePlay newGamePlay = new GamePlay();\n                newGamePlay.setType(Convert.ToString(documentNode.SelectSingleNode(\"type\").InnerText));\n                newGamePlay.setGamePlayID(Convert.ToInt32(documentNode.SelectSingleNode(\"GamePlayID\").InnerText));\n                newGamePlay.setParticipantID(Convert.ToInt32(documentNode.SelectSingleNode(\"ParticipantID\").InnerText));\n                newGamePlay.setGameDifficultyID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameDifficultyID\").InnerText));\n                newGamePlay.setGameID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameID\").InnerText));\n                newGamePlay.setStartDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"Start\").InnerText));\n                newGamePlay.setEndDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"End\").InnerText));\n                newGamePlay.setSuccess(Convert.ToBoolean(documentNode.SelectSingleNode(\"Success\").InnerText));\n                newGamePlay.setFile(value);\n                newGamePlay.addNewGamePlay();\n\n                foreach (XmlNode documentNode2 in GameSteps)\n                {\n\n                    GamePlayStep newGamePlayStep = new GamePlayStep();\n                    newGamePlayStep.setGamePlayStepID(Convert.ToInt32(documentNode2.SelectSingleNode(\"GamePlayStepID\").InnerText));\n                    newGamePlayStep.setGamePlayID(newGamePlay.getGamePlayID());\n                    newGamePlayStep.setStartDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"Start\").InnerText));\n                    newGamePlayStep.setEndDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"End\").InnerText));\n                    newGamePlayStep.setOrderPlayed(Convert.ToInt32(documentNode2.SelectSingleNode(\"SortOrder\").InnerText));\n                    newGamePlayStep.setScore(Convert.ToInt32(documentNode2.SelectSingleNode(\"Score\").InnerText));\n                    newGamePlayStep.setHintUsed(Convert.ToBoolean(documentNode2.SelectSingleNode(\"hintUsed\").InnerText));\n                    newGamePlayStep.addNewGamePlayStep();\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The GamePlay is filling the variables properly and inserting into the database however the GamePlaySteps in the NodeList are not. Does anyone see the problem or how I can improve this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","sqlite"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13269314,"title":"Multiple SELECT on the same field in one statement","body":"<p>I got the following table:</p>\n\n<pre><code>**stats**\n\nid INT FK\nday INT    \nvalue INT\n</code></pre>\n\n<p>I would like to create an SQL query that will sum the values in value column in the last day, last week and last month, in one statement.</p>\n\n<p>So Far i got this:</p>\n\n<pre><code>select sum(value) from stats as A where A.day &gt; now() - 1\nunion\nselect sum(value) from stats as B where B.day &gt; now() - 7\nunion\nselect sum(value) from stats as C where C.day &gt; now() - 30\n</code></pre>\n\n<p>This returns just the first sum(value), i was expecting 3 values to return.</p>\n\n<p>Running: <code>select sum(value) from stats as A where A.day &gt; now() - X ( Where x = 1/7/30)</code> in different queries works as it should.</p>\n\n<p>What's wrong with the query? Thanks!</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13269026,"title":"SQL - choose number from string, and replace it","body":"<p>I hav the next query in SQL:\nSELECT id FROM student WHERE DATE LIKE '%$inputdate'\nthe inputDate is in the next format: 2010.08.03\nI also want to change the date of the date, by increasing the day in a week (+7).</p>\n\n<p>I try this:</p>\n\n<pre><code>SELECT id\nFROM student\nWHERE DATE LIKE '%$inputdate'\n     OR DATE Like '%CAST(RIGHT(\"2012-11-03\", 2)AS INT) + 7;\n</code></pre>\n\n<p>But it gives me SQL syntax error. How can I write it correctly?</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":6168434,"title":"Activerecord Where with a hash value","body":"<p>I have a City model with a cached_info field which is a serialized hash. </p>\n\n<pre><code>{:population=&gt;20000, :more_stuff =&gt;....}\n</code></pre>\n\n<p>If I make the following query in Activerecord.</p>\n\n<pre><code>City.where('cached_info[:population] &gt; 300').count\n</code></pre>\n\n<p>I get back...</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: \nYou have an error in your SQL syntax; \ncheck the manual that corresponds to your MySQL server version for the right syntax to use near '[:population] &gt; 300)' at line 1: SELECT COUNT(*) FROM `places` WHERE `places`.`type` = 'City' AND (cached_info[:population] &gt; 3)\n</code></pre>\n\n<p>Anybody have a workaround for this?</p>\n"},{"tags":["sql","sqlplus"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":37,"score":-1,"question_id":13269317,"title":"SQL selection statement","body":"<p>I'm having some trouble writing the SQL statement for the following request: \"Find the actors that acted in the movie and in the remake of that same movie\".</p>\n\n<p>The three tables are 'films', 'remakes' and 'casts': \nfilms attributes: filmid, filmname, year, director \nremakes attributes: filmid, title, year, priorfilm, priortitle, prioryear\ncasts attributes: filmid, filmname, actor</p>\n\n<p>So far I know that the priorfilm attribute should correspond with the filmid of the film being tested so I started with this:</p>\n\n<pre><code>select actor\nfrom casts, remakes, actors\nwhere casts.filmid = remakes.priorfilm\n</code></pre>\n\n<p>But I have no clue how I should proceed with this.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13269038,"title":"Mixing update/insert records in a single invocation of \"Instead of insert, update\" - Is that possible?","body":"<p>I would like to know whether an \"instead of insert, update\" trigger can be called to both \"UPDATE\" A records in the table while \"INSERTING\" B records in a <strong>single invocation</strong>?</p>\n\n<p>Actually, I'm just curious to know whether SQL Server could call the mentioned trigger for updating and inserting records, at once? or it just calls the trigger once for updating some records, and once for inserting some others?</p>\n\n<p>Consider this, for example:</p>\n\n<pre><code>ALTER TRIGGER [dbo].[MyTable_DoWhatever] \n   ON  [dbo].[MyTable] \n   INSTEAD OF INSERT, UPDATE\nAS \nBEGIN\n    SET NOCOUNT ON;\n\n    DECLARE @Updating BIT = 0;\n    IF EXISTS(SELECT * FROM INSERTED i INNER JOIN DELETED d ON i.Id = d.Id) SET @Updating = 1\n\nEND\n</code></pre>\n\n<p>Does the above @Updating flag valid to determine whether the trigger is called for \"INSTEAD OF INSERTED\" or \"INSTEAD OF UPDATE\"?</p>\n\n<p>Thanks.</p>\n"},{"tags":["asp.net","sql","sql-server","sql-server-2005","sql-server-2008"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":479,"score":0,"question_id":6120957,"title":"SQL Query Problem in Inline Query in Asp.net","body":"<p>My sql table structure is this</p>\n\n<pre><code>ID  DataName\n1   Lipsum lorem \n3   lipsum's lorem\n</code></pre>\n\n<p>My inline query in asp.net is that</p>\n\n<pre><code>select * from table where DataName like 'lipsum's lorem'\n</code></pre>\n\n<p>It gives the following errors:</p>\n\n<pre><code>Msg 102, Level 15, State 1, Line 1\nIncorrect syntax near 's'.\nMsg 105, Level 15, State 1, Line 1\nUnclosed quotation mark after the character string ''.\n</code></pre>\n\n<p>I don't want to create a stored procedure to prevent this, I want a solution to this using inline queries.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":11676,"score":10,"question_id":1383494,"title":"Alter user defined type in Sql Server","body":"<p>I created few user defined types in DB as below</p>\n\n<pre><code>CREATE TYPE [dbo].[StringID] FROM [nvarchar](20) NOT NULL\n</code></pre>\n\n<p>and assigned to various tables. My tables in db are in various schemas (not only dbo)</p>\n\n<p>But I realized I need bigger field, and I need to alter, e.g increase from nvarchar to nvarchar, but there is no ALTER TYPE statement</p>\n\n<p>I need a script that temp table/ cursor whatever and save there all tables and fields where my type is used. Then change existing fields to base type - e.g. from CustID [StringID] to CustID [nvarchar(20)].\nDrop the user type and recreate it with new type - e.g. nvarchar(50)\nand finally set back fields to user type</p>\n\n<p>I do not have rules define on types, so don't have to drop rules and re-add them</p>\n\n<p>I'm not very familiar with T-Sql, so any help is appreciated.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13269067,"title":"Constructing UPDATE statements using associative arrays in PHP","body":"<p>What is the best way to construct an UPDATE statement using associative arrays in PHP?</p>\n\n<p>For example, say I have a function like so:</p>\n\n<pre><code>/**\n * For update queries\n * \n * @param string $tableName Name of the table we're wanting to update.\n * @param array $values Associative array of columns / values to update. e.g. array('name' =&gt; 'John', 'age' =&gt; 29)\n * @param array $conditions Associative array of conditions. e.g. array('user_id' =&gt; 1) equates to \"WHERE user_id = 1\"\n */\n public function update($tableName, $values, $conditions = array()){\n      //Construct SQL\n }\n</code></pre>\n\n<p>So far, I've been able to construct simple UPDATE statements such as:</p>\n\n<pre><code>UPDATE `myTableName` SET `name` = :name, `age` = :age WHERE `user_id` = :user_id\n</code></pre>\n\n<p>Now I'm left wondering: What is the best way to approach constructing the WHERE clause? Are there similar implementations in other libraries and code bases that I can look into? For example: How do I approach the construction of WHERE clauses that have OR and AND and IN() etc? </p>\n\n<pre><code>UPDATE example SET col = :val WHERE user_id = :user_id AND (age = :age OR name = :name)\n</code></pre>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13248287,"title":"appending 2 columns into one list in sql","body":"<p>I have 2 tables and each table has some 3 columns. i want to get one column such that one column from each table are apended one after the other</p>\n\n<pre><code> eg:- suppose one column in a table contains  hai, how, are, you.\n and another column in another column contains i, am, fine.\n i want a query which gives hai, how, are, you,i,am,fine. in just one column\n</code></pre>\n\n<p>can anybody give a query for this in sql...</p>\n"},{"tags":["mysql","sql","database","database-design","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13268579,"title":"PHP/MySQL Many to Many. How?","body":"<p>I recently thought that storing an array in MySQL database would solve my problems... then I went and banged my head on a wall until I realised that there was an easier solution to my problem. Unfortunately I can't seem to figure out what the hell I need to do. </p>\n\n<p>I have two tables. User and Entry. Each user can be the Author of any number of entries. One to many right? Well the problem comes from the fact that each entry can have many users. -_-;</p>\n\n<p>As you can imagine, doing this using arrays would be...not only cumbersome but also stupid, especially if someone managed to accumulate 2000 entries. I had anticipated that I might need to create an extra table and some resources do seem to suggest it but the resources aren't as clear as I would have hoped. I will need to get all the users for a post and somewhere else, I'll need to get all the posts for a user. </p>\n\n<p>Can someone explain the best way of doing this? (Without using arrays of course =p)</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13267739,"title":"I want get sales for year using MySQL","body":"<p>I want to get following result for given year </p>\n\n<pre><code>month | sales\njan     0.00\nfeb     4.00\nmar     0.00\napr     45.00\n.\n.\n.\n.\ndec    0.00\n</code></pre>\n\n<p>table that i have is \"sales\" and it has salse_value, sales_date as columns.</p>\n\n<p>question is how can get above result using case when statement in MYSQL </p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":3086,"score":4,"question_id":528529,"title":"Self-referencing constraint in MS SQL","body":"<p>Is it true that MS SQL restrict self-referencing constraints with ON DELETE CASCADE option? \nI have a table with parent-child relation, PARENT_ID column is foreign key for ID. Creating it with ON DELETE CASCADE option causes error </p>\n\n<blockquote>\n  <p>\"Introducing FOREIGN KEY constraint\n  may cause cycles or multiple cascade\n  paths. Specify ON DELETE NO ACTION or\n  ON UPDATE NO ACTION, or modify other\n  FOREIGN KEY constraints.\"</p>\n</blockquote>\n\n<p>I can't believe that I have to delete this hierarchy in recursive mode. Is there any issue except triggers?</p>\n"},{"tags":["sql","dynamic-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13268728,"title":"How to pass an output variable in dynamic sql query","body":"<p>I was reviewing a stored procedure where I found piece of code below. Looking at the code, my perception is that we are creating a variable  named @QuestionInclude and passing its value in dynamic sql statement. But how this code is working? </p>\n\n<p>This is something strage and new to me.</p>\n\n<pre><code>declare @QuestionInclude varchar(10)\nselect @sqln =  'select @QuestionInclude = 1 from ##Stg_Prelim' \nexec sp_executesql @sqln,N'@QuestionInclude varchar(10) output',@QuestionInclude output\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13268241,"title":"Random Function behavior in SELECT query in MS SQL server","body":"<p>I have a written a random function[dbo.UDF_Q_RandomNumber()] that generates a floating type random number between 0 and 1. </p>\n\n<pre><code>DECLARE @upper=10    \nDECLARE @lower=1    \nSELECT  ROUND(CAST((@lower+(@upper-@lower)*dbo.UDF_Q_RandomNumber())AS INT),0) \n</code></pre>\n\n<p>The above code generates a random number between 1 and 10.</p>\n\n<p>Now i made a temporary table #tempTable with 10 rows in it with coulumns 'Id' and 'Number'</p>\n\n<pre><code>Id  Number\n1   1\n2   2\n3   3\n4   4\n5   5\n6   6\n7   7\n8   8\n9   9\n10  10 \n</code></pre>\n\n<p>SQL Query:</p>\n\n<pre><code>CREATE TABLE #tempTable(Id INT,Number INT)\nINSERT INTO #tempTable VALUES (1,1)\nINSERT INTO #tempTable VALUES (2,2)\nINSERT INTO #tempTable VALUES (3,3)\nINSERT INTO #tempTable VALUES (4,4)\nINSERT INTO #tempTable VALUES (5,5)\nINSERT INTO #tempTable VALUES (6,6)\nINSERT INTO #tempTable VALUES (7,7)\nINSERT INTO #tempTable VALUES (8,8)\nINSERT INTO #tempTable VALUES (9,9)\nINSERT INTO #tempTable VALUES (10,10)\nDECLARE @maxCount INT;\nSELECT @maxCount=  COUNT(1) FROM #tempTable\nSELECT * FROM #tempTable\nSELECT Number FROM #tempTable WHERE Id= ROUND(CAST((1+(@maxCount-1)*dbo.UDF_Q_RandomNumber())AS INT),0)\nDROP TABLE #tempTable\n</code></pre>\n\n<p>Here the query </p>\n\n<pre><code>**SELECT Number FROM #tempTable WHERE Id= ROUND(CAST((1+(@maxCount-1)*dbo.UDF_Q_RandomNumber())AS INT),0)**\n</code></pre>\n\n<p>sometimes gives 2 rows and sometimes null which should not come as Id selected is between 1 and 10 (the rows in temptable) and  every Id has value too.\nPlease help .</p>\n"},{"tags":["php","mysql","sql","opencart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13268233,"title":"Product Name Print Several times, How to fix.?","body":"<p>i had added the following Opencart module for my order report list...\n<a href=\"http://www.opencart.com/index.php?route=extension/extension/info&amp;extension_id=3597&amp;filter_search=order%20list%20filter%20model&amp;page=4\" rel=\"nofollow\">http://www.opencart.com/index.php?route=extension/extension/info&amp;extension_id=3597&amp;filter_search=order%20list%20filter%20model&amp;page=4</a></p>\n\n<p>I have problems with the column \"Products\". If there are more than one option the products name prints several times. So if I got a product with three options the product name prints three times. Is there any way to fix this problem?</p>\n\n<p>i want print product name and model number only once, any idea.?</p>\n\n<p><strong>i will attach the results what i got now...</strong>\n<img src=\"http://i.stack.imgur.com/6U18X.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>this is my sql query...</strong></p>\n\n<pre><code>public function getOrders($data = array()) { \n$sql = \"select o.order_id,o.email,o.telephone,CONCAT(o.shipping_address_1, ' ', o.shipping_address_2) AS address,CONCAT(o.firstname, ' ', o.lastname) AS customer,o.payment_zone AS state,o.payment_address_2 AS block, o.payment_address_1 AS address,o.payment_postcode AS postcode,(SELECT os.name FROM \" . DB_PREFIX . \"order_status os WHERE os.order_status_id = o.order_status_id AND os.language_id = '\" . (int)$this-&gt;config-&gt;get('config_language_id') . \"') AS  status,o.payment_city AS city,GROUP_CONCAT(pd.name) AS pdtname,GROUP_CONCAT(op.model) AS model,o.date_added,sum(op.quantity) AS quantity,GROUP_CONCAT(opt.value ) AS options, GROUP_CONCAT(opt.order_product_id )  AS ordprdid,GROUP_CONCAT(op.order_product_id )  AS optprdid, GROUP_CONCAT(op.quantity) AS opquantity from `\" . DB_PREFIX . \"order` o LEFT JOIN \" . DB_PREFIX . \"order_product op ON (op.order_id = o.order_id)  LEFT JOIN \" . DB_PREFIX . \"product_description pd ON (pd.product_id = op.product_id and pd.language_id = '\" . (int)$this-&gt;config-&gt;get('config_language_id') . \"') LEFT JOIN \" . DB_PREFIX . \"order_option opt ON (opt.order_product_id = op.order_product_id) \";\n</code></pre>\n\n<p>Product Name = <code>GROUP_CONCAT(pd.name) AS pdtname,</code></p>\n"},{"tags":["sql","sql-server","sql-server-2008","merge","case"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13268170,"title":"Merge Statement: Don't update blank field","body":"<p>I'm performing a MERGE statement from a temp table <code>t</code> into the main table <code>ts</code>, matching on an ID field. It contains the following:</p>\n\n<pre><code>WHEN MATCHED THEN UPDATE\n   SET ts.username = t.username, ts.password = t.password, ts.title = t.title, ts.firstname = t.firstname, ts.surname = t.surname, ts.email = t.email\n</code></pre>\n\n<p>If the username and password is blank in the temp table <code>t</code>, I don't want to update the main table <code>ts</code>. How can I do this?</p>\n\n<p>EDIT: Seems like a <code>CASE</code> statement or using <code>COALESCE(NULLIF(t.username, ''), ts.username)</code> will work. Which is best?</p>\n"},{"tags":["sql","sql-server","vb.net","sql-server-2008"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3372,"score":1,"question_id":1513438,"title":"How do I return a value to a sqldatareader if value is null?","body":"<p>I am currently using a sql data reader (in vb.net) to extract an article object via a stored proc from a SQL Server 2008 database. Part of this object includes the two properties shown below:</p>\n\n<pre><code>theArticle.Truthfulness = ((myReader.GetInt32(myReader.GetOrdinal(\"Truthfulness\"))))\ntheArticle.Relevance = ((myReader.GetInt32(myReader.GetOrdinal(\"Relevance\"))))\n</code></pre>\n\n<p>My problem is that the Truthfulness and Relevance may return a null value and this is causing the function to fall over.</p>\n\n<p>I think I understand why. I am asking for an integer value (getin32) and because null is returned it fails.</p>\n\n<p>How do I accommodate the null value from the database so it does not fall over?</p>\n"},{"tags":[".net","sql","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12929992,"title":"Crystal report 10 Error : Failed to open a rowset","body":"<p>I am using Crystal Reports 10, running on SQL Server 2008 R2. The backend is in the server. When I run a report, it is working fine with my Admin userid and password but if I login with the client userid and password, I get the</p>\n\n<p><img src=\"http://i.stack.imgur.com/CQUHB.png\" alt=\"Error Message\"></p>\n\n<p>Error Message :Failed to open a rowset. 42000:[Microsoft][ODBC SQL Server Driver][SQL Server]</p>\n\n<p>It sound like \"Access Violation or syntax error\".How to run the report in the client PC ?</p>\n"},{"tags":["sql","sql-server","computed-columns"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13267855,"title":"MS SQL format calculated column","body":"<p>I have a computed column which is calculated this way:</p>\n\n<pre><code>(dateadd(month,[amorted_months],[real_date_start]))\n</code></pre>\n\n<p>The above stays in the Formula property of the column. This formula displays for example </p>\n\n<p>'2013-02-28 10:22:15.583'</p>\n\n<p>Now I want to format the column and to display only the date , not the time. When I use the FORMAT function like this:</p>\n\n<pre><code>(FORMAT(dateadd(month,[amorted_months],[real_date_start]), 'YYYY-MM-DD'))\n</code></pre>\n\n<p>It says that there's an error in validation the formula. I'm not good at SQL syntax and I suppose this is really stupid. Thanks for the help!</p>\n"},{"tags":["sql","query","left-join","where-clause"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13266786,"title":"How to use where clause in Query with LEFT JOIN?","body":"<p>how to write my sql query correct? I would like to use WHERE clause in query, but I don't know  how is correct. This is my query with mistake:</p>\n\n<pre><code>**SELECT pil.[Buy-from Vendor No_],  pil.No_, pil.Amount, pil.Quantity \nFROM dbo.[„blk“ 2011$Purch_ Inv_ Line]AS pil\nWHERE pil.Type=5\nLEFT JOIN dbo.[„blk“ 2011$Purch_ Inv_ Header] AS pih\nON pil.[Document No_]=pih.No_\nORDER BY pil.amount**\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13266068,"title":"Update column with select","body":"<p>hello I would like to set a table column I tried with the update query but I have syntax error</p>\n\n<pre><code>  $cmts=\"UPDATE stat_alert INNER  JOIN cell_cmt  ON stat_alert.cell = cell_cmt.cell SET stat_alert.`cmts` = cell_cmt.`Cmts`\";\n$cmt= mysql_query($cmts)OR DIE(\"Erreur sur la requete\");\n</code></pre>\n\n<p>I have erreur sur la requete \nwho can help me </p>\n"},{"tags":["sql","sql-server","tsql","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13267349,"title":"T-SQL stored procedure - how to make parameter that accepts either integer or text","body":"<p>I have created a stored procedure that accepts 3 parameters.</p>\n\n<pre><code>@row int\n,@column VARCHAR(17)\n,@value int\n</code></pre>\n\n<p>I want the <code>@value</code> parameter to accept either text or integer because it updates different columns depending on <code>@column</code> parameter.</p>\n\n<p>Please advise</p>\n"},{"tags":["sql","mysql","stored-procedures","ide"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":832,"score":0,"question_id":1122875,"title":"Developing MySQL Stored Procedures with Intellisense?","body":"<p>i've looking for an IDE for MySQL with intellisense, which would help a lot. Any suggestions? Thanks!</p>\n"},{"tags":["sql","sybase","linear-algebra","transpose","unpivot"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":13258984,"title":"Taking the \"transpose\" of a table using SQL","body":"<p>I don't know if there is a name for this operation but it's similar to the transpose in linear algebra. </p>\n\n<p>Is there a way to turn an 1 by n table T1 such as </p>\n\n<pre><code>c_1|c_2|c_3|...|a_n\n-------------------\n1  |2  |3  |...|n\n</code></pre>\n\n<p>Into a n by 2 table like the following</p>\n\n<pre><code>key|val\n-------\nc_1|1\nb_2|2\nc_3|3\n.  |.\n.  |.\na_n|n\n</code></pre>\n\n<p>I am assuming that each column c_i in T1 can be unlikely identified.</p>\n"},{"tags":["sql","sql-server"],"answer_count":6,"favorite_count":7,"up_vote_count":53,"down_vote_count":0,"view_count":101753,"score":53,"question_id":31057,"title":"How to insert a line break in a SQL Server VARCHAR/NVARCHAR string","body":"<p>I didn't see any similar questions asked on this topic, and I had to research this for something I'm working on right now. Thought I would post the answer for it in case anyone else had the same question.</p>\n"},{"tags":["sql","sql-server"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13266534,"title":"Extract hostname from a URL","body":"<p>I have to trim the website name upto \".com\" or\"co.in\" in sql</p>\n\n<p>example: lets assume i have  site address as\"http://stackoverflow.com/questions/ask?title=trim\".\nI need to get the result as \"stackoverflow.com\".</p>\n\n<p>some scenario it may be like \"www.google.co.in\" then i need it to be \"google.co.in\"</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13266772,"title":"How can I select the latest event for a given user in Microsoft SQL Server 2008?","body":"<p>I have a database in Microsoft SQL Server 2008</p>\n\n<p>I have a table <code>[eventlog].[dbo].[USER_OPERATION]</code> with columns <code>[userID], [event_description], [event_date], [event_type], [eventID]</code></p>\n\n<p><code>eventID</code> is unique for, well, every given event that can happen.</p>\n\n<p>A given <code>UserID</code> is, of course, not unique for events (every user may have a lot of events associated with him) but is associated with a single individual user</p>\n\n<p>What I want is to create a query that would give me a list which only has the <em>latest</em> event for every user (that is to say, every <code>UserID</code>) and its associated info (the <code>event_type</code>, <code>eventID</code> and <code>event_description</code> of a given specific event).</p>\n\n<p>To illustrate:</p>\n\n<p>When performing</p>\n\n<pre><code>SELECT * \nFROM [eventlog].[dbo].[USER_OPERATION] \nORDER BY userID ASC\n</code></pre>\n\n<p>I get something along the lines of </p>\n\n<pre><code>|====================================================================================|\n|  eventID  |  userID  |        event_description        |  event_date  | event_type |\n|           |          |                                 |              |            |\n|   123     |    2     |  USER 2 broke something         |  03.11.11    |   CRASH    |\n|   391     |    2     |  USER 2 filed a complaint       |  30.04.10    |  COMPLAINT |\n|   392     |    2     |  USER 2 has bought beer         |  31.10.09    |  PURCHASE  |\n|   32      |    3     |  USER 3 broke something         |  22.10.11    |   CRASH    |\n|   568     |    4     |  USER 4 has requested support   |  05.12.11    |  SUPP_REQ  |\n|   691     |    4     |  USER 4 has bought beer         |  01.12.10    |  PURCHASE  |\n|   81      |    4     |  USER 4 updated personal data   |  17.07.11    |  PDAT_UPD  |\n|   141     |    5     |  USER 5 has bought beer         |  16.08.11    |  PURCHASE  |\n|   142     |    5     |  USER 5 broke something         |  16.08.11    |   CRASH    |\n|   269     |    6     |  USER 6 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|   845     |    7     |  USER 7 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|           |          |                                 |              |            |\n|====================================================================================|\n</code></pre>\n\n<p>As you can see, some users have multiple events with different dates associated with them.</p>\n\n<p>What I want is a query that will show me a list of users and what was the most recent date users had an event on (the output would, essentially, be a table which lists each users once, and shows the most recent event associated with each user, and associated event_description, event_date and event_type info). </p>\n\n<p>Let's call such a query result \"Recent Event Table\".</p>\n\n<p><b>Do note the \"unusual condition\" of User 5 (UserID 5) who broke something and bought beer at the same date. </p>\n\n<p>In such cases, I don't care WHICH of the two same-day events would go into the \"Recent Event Table\"</b>, it can be picked by random or whatever (though I would still would need the associated event_description and event_type info).</p>\n\n<p><b>Ideally</b>, the result would look like this (for same set of users as above):</p>\n\n<pre><code>|====================================================================================|\n|  eventID  |  userID  |        event_description        |  event_date  | event_type |\n|           |          |                                 |              |            |\n|   123     |    2     |  USER 2 broke something         |  03.11.11    |   CRASH    |\n|   32      |    3     |  USER 3 broke something         |  22.10.11    |   CRASH    |\n|   568     |    4     |  USER 4 has requested support   |  05.12.11    |  SUPP_REQ  |\n|   141     |    5     |  USER 5 has bought beer         |  16.08.11    |  PURCHASE  |\n|   269     |    6     |  USER 6 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|   845     |    7     |  USER 7 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|           |          |                                 |              |            |\n|====================================================================================|\n</code></pre>\n\n<p>If there is no way to just <i>\"pick any one of the two randomly or per some rule\"</i> for such \"date-dupes\" as User 5, having two entries in the \"Recent Event Table\" would be acceptable for such special cases, since they are very rare and I can handle them manually.</p>\n\n<p>In such (a little bit less fortunate) case the \"Recent Event Table\" would look like </p>\n\n<pre><code>|====================================================================================|\n|  eventID  |  userID  |        event_description        |  event_date  | event_type |\n|           |          |                                 |              |            |\n|   123     |    2     |  USER 2 broke something         |  03.11.11    |   CRASH    |\n|   32      |    3     |  USER 3 broke something         |  22.10.11    |   CRASH    |\n|   568     |    4     |  USER 4 has requested support   |  05.12.11    |  SUPP_REQ  |\n|   141     |    5     |  USER 5 has bought beer         |  16.08.11    |  PURCHASE  |\n|   142     |    5     |  USER 5 broke something         |  16.08.11    |   CRASH    |\n|   269     |    6     |  USER 6 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|   845     |    7     |  USER 7 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|           |          |                                 |              |            |\n|====================================================================================|\n</code></pre>\n\n<p>Which is also acceptable (but would need a bit additional pruning later).</p>\n\n<p>So, to summarize my question, is it possible to construct such a Microsoft SQL query that would give me a Recent Event Table along the lines of what was described above ?</p>\n\n<p>Thank you very much for your help in advance </p>\n"},{"tags":["mysql","sql","datatable","field","record"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":26,"score":-4,"question_id":13267390,"title":"search field name by record","body":"<pre><code>number | no1 | no2 | no3 | no4 | no5 |\n--------------------------------------\n1      |0    | 3   | 4   | 15  |  23 |\n2      |0    | 3   | 3   | 14  |  16 |\n3      |0    | 3   | 0   | 12  |  37 |\n4      |0    | 3   | 1   | 13  |  53 |\n5      |0    | 3   | 2   | 16  |  13 |\n6      |0    | 3   | 1   | 11  |  22 |\n7      |0    | 3   | 0   |  2  |  23 |\n8      |0    | 3   | 4   | 35  |  25 |\n</code></pre>\n\n<p>i have this table,,\ni want to know the name field by the record,,\nfor ex,,\ni have record '2',,i wanna know the record's field(no4),,</p>\n"},{"tags":["mysql","sql","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13264581,"title":"Nested queries to get count with two conditions","body":"<p>I have these 3 tables,</p>\n\n<pre><code>tbl_1-\nip  |isp    |infection\n----------------------\n1   |aaaa   |malware\n2   |bbbb   |malware\n3   |cccc   |ddos\n3   |cccc   |trojan\n4   |dddd   |ddos\n\ntbl_2-\nip  |isp    |infection\n----------------------\n1   |aaaa   |malware\n3   |cccc   |ddos\n4   |dddd   |trojan\n5   |eeee   |trojan\n6   |ffff   |other\n\ntbl_3-\nip  |isp    |infection\n----------------------\n1   |aaaa   |ddos\n6   |ffff   |\n2   |bbbb   |other\n</code></pre>\n\n<p>Which i need to get the result as follows,</p>\n\n<pre><code>result-\nip  |isp    |infection  |ipCount    |ispCount   |infectionCount\n--------------------------------------------------------------\n1   |aaaa   |malware    |3          |3          |2\n1   |aaaa   |ddos       |3          |3          |1\n2   |bbbb   |other      |2          |2          |1\n2   |bbbb   |malware    |2          |2          |1\n3   |cccc   |ddos       |3          |3          |2\n3   |cccc   |trojan     |3          |3          |1\n4   |dddd   |ddos       |2          |2          |1\n4   |dddd   |trojan     |2          |2          |1\n5   |eeee   |trojan     |1          |1          |1\n6   |ffff   |other      |2          |2          |1\n6   |ffff   |           |2          |2          |1\n\nipCount, ispCount -&gt; count of matching ip and isp\n    eg-there are 3 records with ip = 1 and isp = aaaa\n\ninfectionCount -&gt; count of matching infections per ip and isp\n    eg-there are 2 infections that says malware where ip = 1 and isp = aaaa\n</code></pre>\n\n<p>I think I need a nested a query but I don't know how to count with two conditions; can you help?</p>\n\n<p><strong>EDIT</strong> : Code I tried,</p>\n\n<pre><code>SELECT ip, isp, infection, count(ip), count(isp), count(infection)\nFROM (\n\nSELECT ip, isp, infection\nFROM tbl_1\nUNION ALL\nSELECT ip, isp, infectionType\nFROM tbl_2\nUNION ALL\nSELECT ip, isp, infection\nFROM tbl_3\n)x\n\nGROUP BY ip, isp, infection\n</code></pre>\n\n<p>But it doesnt give the result I desire cause I don't know how to do 2 types of counts in one query</p>\n"},{"tags":["sql","codeigniter","function"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13267243,"title":"A Database Error Occurred Error Number: 1054","body":"<p>i tried to make option delete for my CI with sql, but why its still error?</p>\n\n<p><strong>error warning:</strong></p>\n\n<pre><code>A Database Error Occurred\n\nError Number: 1054\n\nUnknown column 'sip' in 'where clause'\n\nselect * from t_label where label = sip\n\nFilename: E:\\web\\rbt.new\\system\\database\\DB_driver.php\n\nLine Number: 330\n</code></pre>\n\n<p><strong>code:</strong></p>\n\n<pre><code>function hapus($id_user){\n            if($this-&gt;session-&gt;userdata('username')==TRUE) {\n                $name = $this-&gt;db-&gt;query(\"select USER_NAME from t_user where USER_ID = $id_user\")-&gt;row();\n                $id_label = $this-&gt;db-&gt;query(\"select * from t_label where label = $name-&gt;USER_NAME\")-&gt;row();\n                $this-&gt;db-&gt;query(\"delete from t_label, t_publisher where t_label.id_label = t_publisher.id_label and t_label.id_label = $id_label-&gt;id_label\");\n                $this-&gt;db-&gt;delete('t_user', array('USER_ID' =&gt; $id_user));\n                redirect(\"registrasi/reg\");\n            }\n        }\n</code></pre>\n\n<p>whats wrong with my code? really need help here</p>\n"},{"tags":["sql","postgresql","escaping","like"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13258735,"title":"How escape without using replace function in LIKE with PostgreSQL","body":"<p>Short version: I need a function to escape strings for use in <code>LIKE</code> expressions, so <code>fr_e%d</code> becomes <code>fr\\_e\\%d</code>.</p>\n\n<hr>\n\n<p>I'm looking for escape the result of a query without the need to use replace.\nBecause in this result I have path with this char  _  inside. And because I use this result in a LIKE statement, it make the \"_\" a joker like start *.</p>\n\n<p>I have to use LIKE because I'm doing some stuff concatenation in this same statement who need the fact that I use LIKE.</p>\n\n<p>I tried ~ to replace LIKE but I will have the same problem with the char '.' because ~ is to use regex just skip this solution too.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","database","sql-server-2008","query","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":26,"score":-2,"question_id":13261087,"title":"How to generate the mapping table in a many to many insert","body":"<p>I have a table of trades for Companys in an exchange. So for a given day I can have many trades for a company. I now want to take these trades and group them into positions.</p>\n\n<p>A trade can below to many positions depending on its attributes like country, type etc\na position can be made up of many trades.</p>\n\n<p>So I have the following tables</p>\n\n<p><strong>Table Trades</strong><br/></p>\n\n<pre><code>Id   Date      Company   Trade  Type\n1 2012-11-01     IBM     1000    A\n2 2012-11-01     IBM     3000    B\n3 2012-11-01     Dell    1000    A\n4 2012-11-01     HP      5000    A\n5 2012-11-01     HP      6000    A\n6 2012-11-01     HP      7000    B\n</code></pre>\n\n<p><strong>Table TradePositionMapping</strong><br/></p>\n\n<pre><code>PK     TableTradeID      PositionID\n1          1                100      --IBM 1000\n2          1                101      --IBM 1000\n3          2                101      --IBM 3000\n4          3                102      --Dell 1000\n5          4                103      --HP 5000\n6          5                103      --HP 6000\n7          4                104      --Hp 5000\n7          5                104      --Hp 6000\n7          6                104      --Hp 7000\n</code></pre>\n\n<p><strong>Table Position</strong><br/></p>\n\n<pre><code>PK   Company Position\n100   IBM      1000\n101   IBM      4000\n102   Dell     1000\n103   Hp      11000\n104   Hp      18000\n</code></pre>\n\n<p>So in the Positions above the IBM Trade ID 1 went to 2 Positions 100 and 101. Trade Id 2 also went to Position 101 giving a total of 4000</p>\n\n<p>Ok so the idea being that a trade can make up 1 or more positions and a position can have many trades. The business logic will determine what positions the trades flow to, so I have used A and B as flags for now just as an example.</p>\n\n<p>So to the question which is..</p>\n\n<p>When I select and aggregate from the Trades Table, I insert all the new positions that are made up from the various trades into the Positions table. Now what is the best way to create the mapping table.</p>\n\n<p>What I do at the moment is that I store the newly created Position Ids in a tempory table and then repeat the select that I would do to generate the postions in the first place.. and join to the tempory table. THis seems like a lot of duplication of code and I would like to know what the best practice is out there to do such a thing.</p>\n\n<p>best regards Mick</p>\n"},{"tags":["php","mysql","sql","query","opencart"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13257360,"title":"Using quotation mark in MySQL","body":"<p>I have a list of 1000 products I am currently importing into OpenCart. Some of the product titles contains an quotation mark to symbolise the inches (for example 5\").</p>\n\n<p>I have imported all of these products successfully using this query:</p>\n\n<pre><code>$data['name'] = mysql_escape_string($data['name']);\n$sql = \"INSERT INTO \".DB_PREFIX.\"product-description SET language_id = '1', name = '\".$data['name'].\"'\";\n$query = mysql_query($sql);\n</code></pre>\n\n<p>When I am in OpenCart the list of products also show proberly however when I go to edit the product the title input field (which is meant to show the title) cuts out the title from the \" symbol onwards.</p>\n\n<p>Here is a visual example:\n<img src=\"http://i.stack.imgur.com/HIpsV.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title is complete\n<img src=\"http://i.stack.imgur.com/93t7G.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title as been cut out after the \".</p>\n\n<p>I can confirm it is not an OpenCart coding error because if I manually insert products from the interface with a \" it works fine. The error must lie within my query.</p>\n\n<p>If there is a problem with my query, is there a query where I can update all the products rather than re-insert them?</p>\n"},{"tags":["sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":31,"score":0,"question_id":13266346,"title":"unable to convert SQL query to Linq","body":"<p>Please help me try and convert this join query. I am trying to convert the following SQL query into a LINQ query, but can not get it working. Can any one help me solve this?  </p>\n\n<pre><code>SELECT T1.BoCode, case when T2.qty is null then 0 else T2.qty end \nFROM  \n    (SELECT bocode from TABLE1) as T1\nleft join\n    (SELECT cBoCode, sum(qty) as qty    FROM TABLE2 where ncampnurn in \n        (select nurn FROM TABLE3 INNER JOIN TABLE4 ON TABLE3.CampaignCode = \n         TABLE4.CampaignCode  \n         where TABLE3.Month = 'Sep12' and TABLE4.ReportGroup = 'testgroup' )\n    GROUP BY cBoCode) as T2 \nON T1.BoCode = T2.cBoCode\norder by T1.BoCode\n</code></pre>\n\n<p>I have only been able to do the middle bit and then get stuck on whether I need to use <code>Contains</code> or <code>Any</code>.</p>\n\n<pre><code>from t3 in table3\njoin t4 in table4 on t3.CampaignCode equals t4.CampaignCode\nwhere t3.Month == \"Sep12\" &amp;&amp; t4.ReportGroup == \"testgroup\"\nselect t3.Nurn \n</code></pre>\n"},{"tags":["sql","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":827,"score":1,"question_id":6452038,"title":"SOLite:Date formatter in SQLite","body":"<p>I am a beginner to SQLite. I have to insert as well as retrieve data in <code>DD/MM/YYYY</code> format.\nAs in oracle there are function <code>TO_DATE()</code>,<code>TO_CHAR()</code> similarly, are there any date formatter functions in SQLite.</p>\n\n<p>I want my date in DD/MM/YYYY format. Can any one help me please?</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13249894,"title":"IN Mysql Function how can return more than one row","body":"<p>I am using MySQL.I able get more row in MySQL procedure but not in function . I want to write the function by returning values more than one row .  I attach my partial code:</p>\n\n<pre><code>drop function if exists test_splitfn;\nDELIMITER $$\n\nCREATE Function test_splitfn( sSepar VARCHAR(255), saVal TEXT )\nReturns @MyTable table \nbody:\n\nBEGIN\n\n  DROP TEMPORARY TABLE IF EXISTS lib_Explode;\n  CREATE TEMPORARY TABLE lib_Explode(\n    pos int unsigned NOT NULL auto_increment,\n    val VARCHAR(255) NOT NULL,\n    PRIMARY KEY  (pos)\n  ) ENGINE=Memory COMMENT='Explode() results.';\n\n  IF sSepar IS NULL OR saVal IS NULL THEN LEAVE body; END IF;\n\n  SET @saTail = saVal;\n  SET @iSeparLen = LENGTH( sSepar );\n\n  create_layers:\n  WHILE @saTail != '' DO\n\n    # Get the next value\n    SET @sHead = SUBSTRING_INDEX(@saTail, sSepar, 1);\n    SET @saTail = SUBSTRING( @saTail, LENGTH(@sHead) + 1 + @iSeparLen );\n    INSERT INTO lib_Explode SET val = @sHead;\n\n  END WHILE;\n\n     Insert @MyTable\n      SELECT val  FROM lib_Explode;\n\n\n    return @MyTable;\nEND; $$\nDELIMITER ;\n</code></pre>\n"},{"tags":["sql","sqlite","android-sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13263528,"title":"sql query to filter dates of this week","body":"<p>I am new to <code>sql</code> queries, can anyone help me for writing query for the following condition\nI have a column named \"dob\" in table \"members\". <strong>Note: dob datatype is text.</strong>\nAnd the values like : </p>\n\n<pre><code>dob\n===\n7-November-1980\n9-November-1981\n10-November-1982\n5-May-1990\n</code></pre>\n\n<p>Now to get birthdays of this week (i.e) from 7-11-2012 to 13-11-2012 , I want to get the result as first 3 records. For that I wrote query like this</p>\n\n<pre><code>select * from members where dob in('7-November','8-November','9-November','10-November','11-November','12-November','13-November')\n</code></pre>\n\n<p>But it never returns any results. Anyone please help me that how can I get it. Big thanks to you.</p>\n"},{"tags":["java","mysql","sql","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13266393,"title":"How to monitor database connection in java?","body":"<p>i have created web application using java. In that i am using tomcat server and SQL server. I need to implement watch dog service for monitoring database connection and server connection. I mean if database is not connecting or tomcat server is down then i need to write a code for send a alerting mail to my mail id. </p>\n\n<p>pls someone help me...</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13266334,"title":"Substring method's in SQL query","body":"<p>This is the query which i am using to reduce the length of the character.</p>\n\n<p>these are some example char(\"For more information about the valid SQL Server 2005 data types that can be ... Is an integer that specifies where the substring starts. start can be of type bigint.\")</p>\n\n<p>if i give substring to fix the length up to 15 . the rest of the char should show like this way(...)</p>\n\n<p>my sql query is this.....</p>\n\n<pre><code>select substring('For more information about the valid SQL Server 2005 data types that can be ... Is an integer that specifies where the substring starts. start can be of type bigint.',0,15) from Admin\n</code></pre>\n\n<p>for example: it should show like this</p>\n\n<pre><code>For more information about the valid SQL Server 2005 data.\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13266299,"title":"Query to Update Table using another table as information?","body":"<p>I have two tables, <code>Staff</code> and <code>Wages</code></p>\n\n<p><code>Staff</code> Contains </p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        \n  2   Name2       4      \n  3   Name3       1      \n  4   Name4       2      \n</code></pre>\n\n<p><code>Wages</code> Contains</p>\n\n<pre><code> JobID, Wage\n   1    1500\n   2    800\n   3    1600\n   4    2000\n</code></pre>\n\n<p>(There are alot more columns in the actual one I have just took the top 4)</p>\n\n<p>I am missing the wages inside the <code>Staff</code> table, and the wages I need in the staff table are the rates in the <code>Wages</code> table..</p>\n\n<p>So I need a query which would make the <code>Staff</code> table look like:</p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        800\n  2   Name2       4        2000\n  3   Name3       1        1500\n  4   Name4       2        800\n</code></pre>\n\n<p>An example Query which I tried was:</p>\n\n<pre><code>UPDATE `Staff` \nSET wage = (SELECT wage FROM `Wages`) \nWHERE jobID = (Select jobId FROM `Wages`)\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3086,"score":2,"question_id":2712336,"title":"What is the maximum length of a string parameter to Stored procedure?","body":"<p>I have a string of length 1,44,000 which has to be passed as a parameter to a stored procedure which is a select query on a table.\nWhen a give this is in a query (in c# ) its working fine. But when i pass it as a parameter to stored procedure its not working.</p>\n\n<p>Here is my stored procedure where in i have declared this parameter as NVARCHAR(MAX)</p>\n\n<pre><code>------------------------------------------------------\nset ANSI_NULLS ON\nset QUOTED_IDENTIFIER ON\ngo\n\nCREATE PROCEDURE [dbo].[ReadItemData](@ItemNames NVARCHAR(MAX),@TimeStamp as DATETIME)\n\nAS\n\nselect * from ItemData\n\nwhere ItemName in (@ItemNames) AND TimeStamp=@TimeStamp\n\n---------------------------------------------------------------------\n</code></pre>\n\n<p>Here the parameter @ItemNames is a string concatinated with different names such as \n'Item1','Item2','Item3'....etc.</p>\n\n<p>Can anyone tell what went wrong here?</p>\n\n<p>Thanks &amp; Regards</p>\n\n<p>Padma </p>\n"},{"tags":["php","mysql","sql","pdo","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13263094,"title":"MYSQL select field1, field2 only where field1 or field2 does not equal text","body":"<p>I have the following 2 SQL syntax that I'm looking to combine into 1 SQL syntax</p>\n\n<pre><code>SELECT sentFrom \nFROM tableName \nWHERE id = :varid \nAND sentFrom != :vartext\n\nSELECT sentTo \nFROM tableName \nWHERE id = :varid \nAND sentTo != :vartext\n</code></pre>\n\n<p>I guess I should give an example:</p>\n\n<p>MYSQL TABLE</p>\n\n<pre><code>-----------------------------------\nsentFrom          sentTo\n1                 2\n1                 3\n2                 1\n2                 3\n</code></pre>\n\n<p>query </p>\n\n<pre><code>select sentFrom where sentFrom != 1 and select sentTo where sentTo != 1\n</code></pre>\n\n<p>Returns:</p>\n\n<p>sentTo 2 but not sentFrom 1</p>\n\n<p>sentTo 3 but not sentFrom 1</p>\n\n<p>sentFrom 2 but not sentTo 1</p>\n\n<p>sentFrom 2 and sentTo 3</p>\n"},{"tags":["php","mysql","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":57,"score":-4,"question_id":13262882,"title":"How to display incorrect answers in example below","body":"<p>Below I have 4 database tables, Session, Question, Answer and Option_Type.</p>\n\n<p><strong>Session Table:</strong></p>\n\n<pre><code>SessionId  SessionName\n1          AAA\n</code></pre>\n\n<p><strong>Question Table:</strong></p>\n\n<pre><code>SessionId   QuestionId  QuestionContent       OptionId\n1           1           What is 1+1 and 4+4   2\n1           2           Does 2+2 = 4          26\n1           3           What is 3+3 and 5+5   3\n</code></pre>\n\n<p><strong>Answer Table:</strong></p>\n\n<pre><code>AnswerId  SessionId QuestionId  Answer\n1         1         1           B\n2         1         1           C\n3         1         2           Yes\n4         1         3           A\n5         1         3           C\n</code></pre>\n\n<p><strong>Option_Type</strong></p>\n\n<pre><code>OptionId OptionType\n1        A-C\n2        A-D\n3        A-E\n4        A-F\n\n.... goes up to 24 where it goes up to A-Z\n\n25       True or False\n26       Yes or No\n</code></pre>\n\n<p>Now in a jsfiddle here I have created a demo html table which you can see <a href=\"http://jsfiddle.net/WHUkh/6/\" rel=\"nofollow\">here</a></p>\n\n<p>Now if you have a good look at the html table, you will realise that what I am trying to do is display the incorrect answers under the \"Incorrect Answer\" column.</p>\n\n<p>So what I want to do is that for example for Question 1, if you look in the database table, the \"OptionId\" for Question 1 is 2, which means if you look up \"OptionId\" under the \"Option_Type\" table that \"OptionType\" for this OptionId is \"A-D\". So the options are \"A\", \"B\", \"C\" and \"D\". The answers for Question 1 are \"B\" and \"C\". So I don't want to display these answers in the table as they are correct but I want to display the other options \"A\" and \"D\" as that they are incorrect.</p>\n\n<p>Does this make sense? My question is virtually how can I not show the correct answers under the \"Incorrect Answer\" column but instead show the other options under this column per question in the code below:</p>\n\n<pre><code>   $query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, an.Answer, q.QuestionMarks \n   FROM Session s \n   INNER JOIN Question q ON s.SessionId = q.SessionId\n   JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId\n   WHERE s.SessionName = ?\n   ORDER BY q.QuestionId, an.Answer\n   \";\n\n   // prepare query\n   $stmt=$mysqli-&gt;prepare($query);\n   // You only need to call bind_param once\n   $stmt-&gt;bind_param(\"s\", $assessment);\n   // execute query\n   $stmt-&gt;execute(); \n\n\n       // This will hold the search results\n    $searchQuestionId = array();\n    $searchQuestionContent = array();\n    $searchAnswer = array();\n    $searchMarks = array();\n\n    // Fetch the results into an array\n\n   // get result and assign variables (prefix with db)\n   $stmt-&gt;bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionContent, $dbAnswer, $dbQuestionMarks);\n      while ($stmt-&gt;fetch()) {\n        $searchQuestionId[] = $dbQuestionId;\n        $searchQuestionContent[] = $dbQuestionContent;\n        $searchAnswer[] = $dbAnswer;\n        $searchMarks[] = $dbQuestionMarks;\n      } \n\n?&gt;      \n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;form id=\"QandA\" action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n\n&lt;?php \n\necho \"&lt;table border='1' id='markstbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question No.&lt;/th&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='answerth'&gt;Incorrect Answer&lt;/th&gt;\n      &lt;th class='answermarksth'&gt;Penalty per Incorrect Answer&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n$previous_question_id = null;\n$rowspans = array_count_values($searchQuestionId);\nforeach ($searchQuestionContent as $key=&gt;$question) {\n\n    // removed logic, not necessary to set empty strings if you're skipping them\n\n    echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n\n    if ($previous_question_id != $searchQuestionId[$key]) {\n        echo '&lt;td class=\"questionnumtd\" name=\"numQuestion\" rowspan=\"'.$rowspans[$searchQuestionId[$key]].'\"&gt;'.htmlspecialchars($searchQuestionId[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"questioncontenttd\" rowspan=\"'.$rowspans[$searchQuestionId[$key]].'\"&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n    }\n\n    echo '&lt;td class=\"answertd\" name=\"answers[]\"&gt;';\n    echo $searchAnswer[$key];\n    echo '&lt;/td&gt;' ;\n    echo '&lt;td class=\"answermarkstd\"&gt;&lt;input class=\"individualMarks\" name=\"answerMarks[]\" id=\"individualtext\" type=\"text\" /&gt;&lt;/td&gt;' . PHP_EOL;\n\n    // moved this to the end\n    if ($previous_question_id != $searchQuestionId[$key]) {\n        $previous_question_id = $searchQuestionId[$key];\n    }\n}\n        echo '&lt;/tr&gt;';\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n\n        ?&gt;\n\n&lt;/form&gt;\n</code></pre>\n\n<p>At the moment the code above is showing the correct answers under the \"Incorrect Answers\" column, not the incorrect answers.</p>\n"},{"tags":["sql"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2649,"score":0,"question_id":3905633,"title":"passing a parameter into a subquery","body":"<p>i was wondering if it is possible to pass a parameter into a select subquery.</p>\n\n<p>What i want to do is collect some product data from one table and then crossref the weight of the item to it's carriage cost in a shipping table to return a cost.</p>\n\n<p>something like:</p>\n\n<pre><code>select cataloguenumber, productname, \n      (select shipping.carriagecost \n       from shipping \n       where shipping.carriageweight = weight) as carriagecost\nfrom products\n</code></pre>\n\n<p>Regards</p>\n\n<p>DPERROTT</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13265160,"title":"LEFT JOIN 2 Table but will only return the 1st Record from Table2","body":"<p>table1</p>\n\n<pre><code>cid\nitemdesc\nitemprice\n</code></pre>\n\n<p>table2</p>\n\n<pre><code>cid\nimagename\nstatus\n</code></pre>\n\n<p>My 1st table is has unique cid (no duplicate) I want it to LEFT JOIN TO table2 but it has multiple rows per cid</p>\n\n<pre><code>cid      imagename           status\n1        image1-of-cid1      test1\n1        image2-of-cid1      test2\n2        image1-of-cid2      test3\n2        image2-of-cid2      test4\n2        image3-of-cid2      test5\n</code></pre>\n\n<p>But I only want the Query to return the the 1st row only of the each record fom table 1</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":394,"score":1,"question_id":5563141,"title":"Convert text to date format","body":"<p>How do I convert a text format e.g. </p>\n\n<blockquote>\n  <p>Thursday, 1 January 2009</p>\n</blockquote>\n\n<p>to a date in <code>sql</code>?</p>\n\n<p>Thank you </p>\n"},{"tags":["sql","sqlite","sqlite3"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13265244,"title":"shift id's of table alike (id = id + 1) where id is primary key","body":"<p>I need to shift all the primary keys for table alike</p>\n\n<pre><code>UPDATE TODO SET id = id + 1 \n</code></pre>\n\n<p>but I can't do it (  <a href=\"http://sqlfiddle.com/#!5/bd109/2\" rel=\"nofollow\">Demo</a> from Ahmad Al-Mutawa answer ) descript why. primary key can't be changed like this.</p>\n\n<p>Also I can't ALTER the table according that this is sqlite: <a href=\"http://www.sqlite.org/omitted.html\" rel=\"nofollow\">http://www.sqlite.org/omitted.html</a></p>\n\n<p>I'm thinking about some hardcoded recursive change for other columnts but without tsql and stored procedures it's hard for me to get how can I make it?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":13254052,"title":"Reorder list by column","body":"<p>I have a column \"SortIndex\" in a table, and I would like to add a \"case update\" to reorder that table by passing in ID and the new position of the chosen one.</p>\n\n<p><a href=\"http://sqlfiddle.com/#!3/d41d8/5831\" rel=\"nofollow\">SQL Fiddle</a></p>\n\n<pre><code>DECLARE @T TABLE\n(\n    ID int,\n    Name char(1),\n    SortIndex int\n)\n\nINSERT @T \nSELECT 21, 'A', 1 UNION ALL\nSELECT 23, 'B', 2 UNION ALL\nSELECT 35, 'C', 3 UNION ALL\nSELECT 45, 'D', 4 UNION ALL\nSELECT 55, 'E', 5\n\nSELECT * FROM @T    \n\nDECLARE @SortIndex int\n\n/* MOVE A -&gt; 4 */\n\nSET @SortIndex = (SELECT SortIndex FROM @T WHERE ID = 23)\n\n/*\nUPDATE @T\n    SET \n        SortIndex = CASE ... ??\n*/      \n\n/* MOVE D -&gt; 2 */\n\nSELECT * FROM @T\n</code></pre>\n\n<p>Is this possible to solve this by only using the case statement to rebuild the sortindex'es?</p>\n\n<p><em>UPDATE</em></p>\n\n<p>Desired results</p>\n\n<pre><code>A -&gt; 4\n\n    Name SortIndex\n    B     1 \n    C     2\n    D     3\n    A     4\n    E     5\n\n    D -&gt; 2\n\n    A     1 \n    D     2\n    B     3\n    C     4\n    E     5\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":13265567,"title":"SQL for getting sum of a column","body":"<p>I have three tables linked each other.</p>\n\n<pre><code>mysql&gt; select * from tablea;\n+----+--------+\n| id | name   |\n+----+--------+\n|  1 | Item 1 |\n|  2 | Item 2 |\n+----+--------+\n2 rows in set (0.00 sec)\n\nmysql&gt; select * from tableb;\n+----+------+----------+\n| id | Aid  | name     |\n+----+------+----------+\n|  1 |    1 | B Item 1 |\n|  2 |    2 | B Item 2 |\n|  3 |    1 | B Item 3 |\n+----+------+----------+\n3 rows in set (0.00 sec)\n\nmysql&gt; select * from tablec;\n+----+------+----------+-------+\n| id | Bid  | name     | value |\n+----+------+----------+-------+\n|  1 |    1 | C Item 1 |    10 |\n|  2 |    2 | C Item 2 |    20 |\n|  3 |    1 | C Item 3 |    15 |\n|  4 |    2 | C Item 4 |     5 |\n|  5 |    3 | C Item 5 |    12 |\n+----+------+----------+-------+\n5 rows in set (0.00 sec)\n</code></pre>\n\n<p>TableA is linked to TableB with Aid, TableC is linked with TableB with Bid.</p>\n\n<p>What I want is the id of tableA and the sum of values of all the TableC items comes under it.</p>\n\n<p>The result set I expect for the above example is </p>\n\n<pre><code>+-----------+--------+\n| tablea.id | sum    |\n+-----------+--------+\n|         1 |     37 |\n|         2 |     25 |\n+-----------+--------+\n</code></pre>\n"},{"tags":["sql","sql-server","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13265369,"title":"SQL Update Select The multi-part identifier \"OLD_SP.Num\" could not be bound","body":"<pre><code>Declare @modCode varchar(3)\nSET @modCOde = 'SOR';\n\nUPDATE  Doc_SalesOrder\nSET     OLD_SP.Num = NEW_SP.NewNum\nFROM    Doc_SalesOrder as OLD_SP\nINNER JOIN\n(\n     Select\n       Id,\n       dbo.ApplyModuleCode(@modCode,Num) as NewNum \n     From Doc_SalesOrder\n     Where Num not LIKE '%'+@modCOde+'%'\n)NEW_SP ON OLD_SP.Id = NEW_SP.Id\n</code></pre>\n\n<p>When I  run the query the error is:</p>\n\n<blockquote>\n  <p>The multi-part identifier \"OLD_SP.Num\" could not be bound.</p>\n</blockquote>\n\n<p>Why?</p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13258755,"title":"How to load image into varbinary column","body":"<p>I have table like this</p>\n\n<pre><code>CREATE TABLE [dbo].[Product](\n    [Id] [int] IDENTITY(1,1) NOT NULL,\n    [Name] [nvarchar](100) NOT NULL,\n    [Description] [nvarchar](max) NOT NULL,\n    [Price] [decimal](16, 3) NOT NULL,\n    [SmallPhoto] [varbinary](max) NULL);\n</code></pre>\n\n<p>I want load image into [SmallPhoto] field</p>\n\n<p>Main script looks like this</p>\n\n<pre><code>declare @filePath varchar(max)\ndeclare @productId int\n\nset @filePath = 'D:\\myfile.png'\nset @productId = 1\n\nupdate Product\nset SmallPhoto = -- some actions\nwhere Id = @productId\n</code></pre>\n\n<p>Expected result</p>\n\n<p>Command(s) completed successfully. :)</p>\n\n<p>UPD:</p>\n\n<p>1) My database located in other machine</p>\n\n<p>2) I do not have opportunity to copy file to remote machine</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13265209,"title":"Executing SQL Function Using Linq","body":"<p>I have created a function in MSSQL 2005 and I want to run this function using linq. My function has 2 parameters. The definition is seen below:</p>\n\n<pre><code>USE [MobileGateway]\nGO\n/****** Object:  UserDefinedFunction [dbo].[Fn_GetNoLocationAddress]    Script Date: 11/07/2012 08:27:58 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER FUNCTION [dbo].[Fn_GetNoLocationAddress] \n(   \n    -- Add the parameters for the function here\n    @Site nvarchar(255),\n    @ReceivedDate int\n)\nRETURNS @noLocationAddress TABLE (\n\nRequestID int NOT NULL,\nBarcode varchar(50) NOT NULL,\nAdrID int NOT NULL,\nName varchar(50) NOT NULL,\nStreet varchar(50) NOT NULL,\nHouseNo varchar(4) NOT NULL,\nPostal varchar(8) NOT NULL,\nCity varchar(50) NOT NULL,\nCountry varchar(50) NOT NULL,\nLatitude varchar(50) NOT NULL,\nLongitude varchar(50) NOT NULL,\nReveivedDate datetime NOT NULL\n)\nAS \nBEGIN\n    -- Add the SELECT statement with parameter references here\nINSERT INTO @noLocationAddress \nSELECT     TOP (100) PERCENT Request1.RequestID, TrackIT.dbo.Sending.Barcode, TrackIT.dbo.Address_View.AdrID, TrackIT.dbo.Address_View.Name, \n                      TrackIT.dbo.Address_View.Street, TrackIT.dbo.Address_View.HouseNo, TrackIT.dbo.Address_View.Postal, TrackIT.dbo.Address_View.City, \n                      TrackIT.dbo.Address_View.Country, Request1.Latitude, Request1.Longitude, Request1.ReceivedDate\nFROM         (SELECT DISTINCT RequestID, LTRIM([Content]) AS Barcode, Latitude, Longitude, ReceivedDate\n                       FROM          dbo.RequestWithLocation\n                       WHERE      (Site LIKE @Site) AND ([Content] &lt;&gt; '') AND (AddressID = '0') AND (ReceivedDate &gt; DATEADD(day, -@ReceivedDate, GETDATE()))) AS Request1 INNER JOIN\n                      TrackIT.dbo.Sending ON Request1.Barcode = TrackIT.dbo.Sending.Barcode INNER JOIN\n                      TrackIT.dbo.Address_View ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\n\nORDER BY TrackIT.dbo.Address_View.AdrID\n\nRETURN\n\nEND\n</code></pre>\n\n<p>As you can see I have 2 parameters and I'm returning a table with the information. But I need to use linq for executing the this function.\nCan anyone help? thanks</p>\n"},{"tags":["mysql","sql","wordpress","query","posts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13071035,"title":"SQL query to extract all WordPress posts with categories","body":"<p>I need to extract all posts from my WordPress DB along with the associated categories and not sure how to write this query. I've taken a couple of stabs at it already with no joy and would appreciate the help?</p>\n\n<p><strong>EDIT: Here's what I have tried already:</strong></p>\n\n<pre><code>SELECT post_title, wpr.object_id, wp_terms.name\nFROM wp_terms\nINNER JOIN wp_term_taxonomy ON wp_terms.term_id = wp_term_taxonomy.term_id\nINNER JOIN wp_term_relationships wpr ON wpr.term_taxonomy_id = \nwp_term_taxonomy.term_taxonomy_id\nINNER JOIN wp_posts ON ID = wpr.object_id\nWHERE taxonomy = 'category' \nAND post_type = 'post' \nORDER by post_title\n</code></pre>\n\n<p>This seems to work but it returns 1,553 where I know I only have 1343 in my DB.</p>\n\n<p><strong>EDIT:</strong> \nWe did the same thing on another SQL query a little while ago and found that it was pulling in the revisions and other post types but thought that this was resolved using post_type = 'post'</p>\n\n<p><strong>EDIT:</strong>\nUpon looking at the number of categories in the DB, I come up with a total number of 216, 6 off the number if you subtract 1553 - 1343 = 216. So I think this total number of 1553 is coming from the wp_terms table which needs to be excluded and only those that are active with published posts should be shown?</p>\n\n<p><strong>EDIT:</strong>\nThe other possibility is that each post can have multiple categories, hence the reason for having more posts (1553). So how could I separate each posts into multiple categories?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["php","mysql","sql","date"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13192083,"title":"combining results of 3 queries in one result","body":"<p>i have 3 queries and i want all result be in only one result using array_merge and array_unique.</p>\n\n<p>here's the queries:</p>\n\n<pre><code>            $query1 = mysql_query(\"SELECT * FROM prereservation where '$arival' BETWEEN arrival and departure and room_id ='11' and status = 'active'\");  \n        while($rows1 = mysql_fetch_assoc($query1)){\n        echo $rows1['id']. \" - \". $rows1['qty'];\n        echo \"&lt;br /&gt;\";\n        }\n\n        $query2 = mysql_query(\"SELECT * FROM prereservation where '$departure' BETWEEN arrival and departure and room_id ='11' and status = 'active'\");\n        while($rows2 = mysql_fetch_assoc($query2)){\n        echo $rows2['id']. \" - \". $rows2['qty'];\n        echo \"&lt;br /&gt;\";\n        }\n\n        $query3 = mysql_query(\"SELECT * FROM prereservation where arrival &gt; '$arival' and departure &lt; '$departure' and room_id ='11' and status = 'active'\");\n        while($rows3 = mysql_fetch_assoc($query3)){\n        echo $rows3['id']. \" - \". $rows3['qty'];\n        echo \"&lt;br /&gt;\";\n        }\n\nexample result is:    \nfor       $rows1     |     $rows2     |     $rows3\n        id  |  qty   |   id  |  qty   |   id  |  qty\n       -----|--------|-------|--------|-------|------\n        01  |   1    |   01  |   1    |   02  |   1\n        03  |   1    |   02  |   1    |   03  |   1\n        04  |   1    |   03  |   1    |   04  |   1\n        08  |   1    |   05  |   1    |   05  |   1\n</code></pre>\n\n<p>i dont know if this is right? </p>\n\n<pre><code>$sample = array_unique(array_merge($rows1['id'], $rows2['id'], $rows3['id']))\n</code></pre>\n\n<p>i want to use array_merge and array_unique for id's of each results\nso the final result for id's that will be left is </p>\n\n<pre><code>01, 02, 03, 04, 05, 08.\n</code></pre>\n\n<p>and for the next query all i want is the sum(qty) of those id's.\nbut i don't know how to write a query for this, here's my sample:</p>\n\n<pre><code>$query = mysql_query(\"SELECT sum(qty) FROM prereservation where id = $sample\");\n\n        while($rows = mysql_fetch_array($query))\n          {\n          $total_qty = $rows['sum(qty)'];\n          }     \n</code></pre>\n\n<p>so the sum(qty) is equal to 6.\nplease correct my mistakes for coding, thanks guys...</p>\n\n<p><strong>Finally i found the solution, here it is..</strong></p>\n\n<pre><code>$a = $p['id'];\n        $query1 = mysql_query(\"SELECT DISTINCT id, SUM(qty)\n        FROM prereservation \n        WHERE \n        (\n            ( '$arival1' BETWEEN arrival AND departure ) OR \n            ( '$departure1' BETWEEN arrival AND departure ) OR \n            ( arrival &gt; '$arival1' AND departure &lt; '$departure1' )\n        )\n            AND room_id ='$a' \n            AND STATUS = 'active'\");  \n        while($rows1 = mysql_fetch_assoc($query1)){\n        $set1 = $rows1['SUM(qty)'];\n        }   \n        ?&gt; \n        &lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n        &lt;option value=\"0\"&gt;&lt;/option&gt;\n        &lt;? $counter = 1; ?&gt;\n        &lt;? while ($counter &lt;= ($p['qty']) - $set1){ ?&gt;\n        &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n        &lt;? $counter++;\n        }?&gt;\n        &lt;/select&gt;\n</code></pre>\n\n<p><strong>solution was made by combining all of your answers, thank you guys..</strong></p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13242249,"title":"Sorting mysql results by times from 3 tables","body":"<p>I have 3 tables: <code>questions</code>, <code>articles</code> and <code>pictures</code></p>\n\n<p>The rows in each table contain a current_timestamp column <code>posted</code>, and link to an id. I'd like to sort the results of the rows of all three by their timestamp and only echo the newest of the three (for example: if the question is newest from the ID, display that only)</p>\n\n<pre><code>if(count($interests) != 0){ foreach($interests as $interests_following){\n    $interestid = mysql_result(mysql_query(\"SELECT `id` FROM `interests` WHERE `name` = '$interests_following'\"),0);\n    $interestquestions = @mysql_result(mysql_query(\"SELECT `question_text`, `posted` FROM `questions` WHERE `interest` = '$interests_following'\"),0);\n    $interestarticles = @mysql_result(mysql_query(\"SELECT `article_title`, `posted` FROM `articles` WHERE `interest_id` = '$interestid'\"),0);\n    $interestpictures = @mysql_result(mysql_query(\"SELECT `interest_pic_title`, `posted` FROM `interest_pictures` WHERE `interest_id` = '$interestid'\"),0);\n\necho '.$interests_following.': //&lt;Only display 1 newest item (article/picture/question here&gt;\n</code></pre>\n"},{"tags":["php","mysql","sql","date"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":13089536,"title":"Query for hotel reservation","body":"<p>I have three queries in a hotel reservation system where reserves are automatic deducted from the total number of rooms. All I want those three queries goes all in only one query. My query looks like this: </p>\n\n<p><code>$p =</code> is in a <code>foreach</code> loop where <code>$p['id']</code> is the <em>id</em> of each room class and <code>$p['qty']</code> is the maximum rooms of each room class.</p>\n\n<pre><code>$a = $p['id'];\n$query = mysql_query(\"SELECT sum(qty) FROM prereservation where '$arrival' BETWEEN arrival and departure and room_id ='$a' and status = 'active'\");\n        while($rows = mysql_fetch_array($query))\n          {\n          $inogbuwin=$rows['sum(qty)'];\n          }\n$query = mysql_query(\"SELECT sum(qty) FROM prereservation where departure BETWEEN '$arrival' and '$departure' and room_id ='$a' and status = 'active'\");\n        while($rows = mysql_fetch_array($query))\n          {\n          $inogbuwin2=$rows['sum(qty)'];\n          }\n$query = mysql_query(\"SELECT sum(qty) FROM prereservation where '$departure' BETWEEN arrival and departure and room_id ='$a' and status = 'active'\");\n        while($rows = mysql_fetch_array($query))\n          {\n          $inogbuwin3=$rows['sum(qty)'];\n          }\n\n&lt;select&gt;\n &lt;option value=\"0\"&gt;&lt;/option&gt;\n &lt;? $counter = 1; ?&gt;\n &lt;? while ($counter &lt;= ($p['qty'])-($inogbuwin + $inogbuwin2 + $inogbuwin3)){ ?&gt;\n &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n &lt;? $counter++;\n }?&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>Every time I put a date between the range of those three queries, the total deducted is also tripled which is the reason I want those three queries to be all in one.</p>\n\n<p>for example i have a record in database of \n<code>arrival = 27/10/2012 and departure = 29/10/2012</code></p>\n\n<p>and the input dates that are not available in range is</p>\n\n<pre><code> $arrival = 27/10/2012 and $departure = 29/10/2012 \n $arrival = 26/10/2012 and $departure = 27/10/2012 \n $arrival = 29/10/2012 and $departure = 30/10/2012 \n $arrival = 26/10/2012 and $departure = 30/10/2012 \n $arrival = 29/10/2012 and $departure = 29/10/2012 \n</code></pre>\n\n<p>so each date that in rance of those three queries are also the deductions, so i want those queries to be in one. thanks guys</p>\n\n<p>after all i fixed the errors but only one preblem left. i fixed the reservation dates in only a single month, the problem is when the inputs of arrival and departure are not in the same month it does'nt work either. here's my code again below.</p>\n\n<pre><code>&lt;?\n$a = $p['id'];\n    $query = mysql_query(\"SELECT\n    SUM(IF('$arrival' BETWEEN arrival and departure, qty, 0)) AS bu1,\n    SUM(IF('$departure' BETWEEN arrival and departure, qty, 0)) AS bu2,\n    SUM(IF(arrival &gt; '$arrival' and departure &lt; '$departure', qty, 0)) AS bu3\n    FROM prereservation WHERE room_id ='$a' and status = 'active'\");\n    $row = mysql_fetch_array($query);\n\n    $test1 = $row['bu1'];\n    if ($row['bu1'] == $row['bu2']){\n        $test2 = $row['bu2'] - $row['bu1'];\n    }else{\n        $test2 = $row['bu2'];\n    }       \n        $test3 = $row['bu3'];\n    ?&gt;      \n&lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n&lt;option value=\"0\"&gt;&lt;/option&gt;\n    &lt;? $counter = 1; ?&gt;\n&lt;? while ($counter &lt;= ($p['qty']) - ($test1 + $test2 + $test3)){ ?&gt;\n    &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n    &lt;? $counter++;\n    }?&gt;\n</code></pre>\n\n<p>please help me guys how to solve this reservation query, or maybe there's an other way to solve this in php code. thanks guys.</p>\n\n<p><strong>Finally i'm finished and found the solution, here it is:</strong></p>\n\n<pre><code>            $a = $p['id'];\n        $query1 = mysql_query(\"SELECT DISTINCT id, SUM(qty)\n        FROM prereservation \n        WHERE \n        (\n            ( '$arival1' BETWEEN arrival AND departure ) OR \n            ( '$departure1' BETWEEN arrival AND departure ) OR \n            ( arrival &gt; '$arival1' AND departure &lt; '$departure1' )\n        )\n            AND room_id ='$a' \n            AND STATUS = 'active'\");  \n        while($rows1 = mysql_fetch_assoc($query1)){\n        $set1 = $rows1['SUM(qty)'];\n        }   \n        ?&gt; \n        &lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n        &lt;option value=\"0\"&gt;&lt;/option&gt;\n        &lt;? $counter = 1; ?&gt;\n        &lt;? while ($counter &lt;= ($p['qty']) - $set1){ ?&gt;\n        &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n        &lt;? $counter++;\n        }?&gt;\n        &lt;/select&gt;\n</code></pre>\n\n<p><strong>thank you guys for sharing your ideas, this solution is the combinations of your answers.. thanks again!!</strong></p>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13264779,"title":"How to display a null row between 2 tables","body":"<p>Using a view in SQL Server 2000</p>\n\n<p>Table1:</p>\n\n<pre><code>id  z1      z2      z3      z4   type\n--------------------------------------\n01A 300     400     300     400  01\n2B  300     400     300     500  02\n3C  700     600     400     300  01\n04A 500     400     800     900  01\n05B 400     300     400     300  02\n06  150     200     200     150  03\n....\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>type  value1         value2\n------------------------------------    \n01    0      300\n01    301    500          \n02    0      200\n02    201    400\n03\n.....\n</code></pre>\n\n<p>I want to select the table1 rows based on table2 range:</p>\n\n<p>Combination for table1- <code>max(Z1, Z2) and max(Z3, Z4)</code></p>\n\n<p>If Max(z1,z2)  range is less than or equal to table2 max(value2) where table1.type = table2.type\nIf Max(z1, z2)  range is less than or equal to table2 max(value2) where table1.type = table2.type</p>\n\n<p>If z1, Z2 range less than or equal to table2 then i want to display the z1, z2 rows otherwise null\nIf z3, z4 range less than or equal to table2 then i want to display the z3, z4 rows otherwise null</p>\n\n<p>Expected output</p>\n\n<p>Table1:</p>\n\n<pre><code> id  z1      z2      z3      z4   type\n    --------------------------------------\n\n01A 300     400     300     400  01 ' `Both (z1, z2), (z3, z4) rows are matching with table2 for type 01`\n2B  300     400     null     null  02 ' (z1, z2) are matching, (z3, z4) rows are not matching with table2 for type 02\n3C  null    null     400     300  01 ' (z1, z2) rows are not matching, (z3, z4) rows are matching with table2 for type 01\n04A 500     400     null     null  01 ' (z1, z2) rows are matching, (z3, z4) rows are not matching with table2 for type 01\n05B 400     300     400     300  02 ' Both (z1, z2), (z3, z4) rows are matching with table2 for type 02\n\n....\n</code></pre>\n\n<p>Currently I'm using a view, I don't want to change to stored procedure because most of the report are using this view.</p>\n\n<p>How to do it in sql..?</p>\n"},{"tags":["c#","asp.net","sql","database","informix"],"answer_count":7,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":9533,"score":11,"question_id":7026566,"title":"Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints","body":"<p>I make an outer join and executed successfully in the <code>informix</code> database but I get the following exception in my code:</p>\n\n<pre><code>DataTable dt = TeachingLoadDAL.GetCoursesWithEvalState(i, bat);\n</code></pre>\n\n<blockquote>\n  <p>Failed to enable constraints. One or more rows contain values\n  violating non-null, unique, or foreign-key constraints.</p>\n</blockquote>\n\n<p>I know the problem, but I don't know how to fix it.</p>\n\n<p>The second table I make the outer join on contains a composite primary key which are null in the previous outer join query.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<pre><code>    SELECT UNIQUE a.crsnum_e,  a.crsnum_e  || '/ ' || a.crstteng crs_name, b.period,\n           b.crscls, c.crsday, c.from_lect, c.to_lect,\n           c.to_lect - c.from_lect + 1 Subtraction, c.lect_kind, e.eval, e.batch_no,\n           e.crsnum, e.lect_code, e.prof_course\n    FROM rg1course a, rg3crsgrp b, ct1table c, ct1tablelect d,\n         OUTER(cc1assiscrseval e)  \n    WHERE a.crsnum = b.crsnum \n    AND b.crsnum = c.crsnum \n    AND b.crscls = c.crscls \n    AND b.batch_no = c.batch_no \n    AND c.serial_key = d.serial_key  \n    AND c.crsnum = e.crsnum  \n    AND c.batch_no = e.batch_no  \n    AND d.lect_code= e.lect_code \n    AND d.lect_code = .... \n    AND b.batch_no = ....\n</code></pre>\n\n<p>The problem happens with the table <code>cc1assiscrseval</code>. The primary key is (batch_no, crsnum, lect_code).</p>\n\n<p>How to fix this problem?</p>\n\n<p>EDIT:</p>\n\n<p>According to @PaulStock advice:\nI do what he said, and i get:</p>\n\n<blockquote>\n  <p>? dt.GetErrors()[0] {System.Data.DataRow} HasErrors: true ItemArray:\n  {object[10]} RowError: \"Column 'eval' does not allow DBNull.Value.\"</p>\n</blockquote>\n\n<p>So I solve my problem by replacing  <code>e.eval</code> to ,<code>NVL (e.eval,'') eval</code>.and this solves my problem.\nThanks a lot.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13264519,"title":"Getting weekly data from sql","body":"<p>I have a table which has a date column ands values according to dates.Normally if i want to select the data between two dates we use the <code>BETWEEN</code> syntax but it brings each day between those 2 values i have given.Is it possible to change it so it brings the dates with sopme interval i have given? For example if do a simple </p>\n\n<pre><code>SELECT * FROM METABLE WHERE DATE BETWEEN '2012-06-11' AND '2012-07-11'\n</code></pre>\n\n<p>It should bring me the dates as:</p>\n\n<pre><code>2012-06-11 myValue Stuff \n2012-06-12 myValue Stuff \n.\n.\n.\n2012-07-11 myValue Stuff.\n</code></pre>\n\n<p>IS it possible to change it to,</p>\n\n<pre><code>2012-06-11 myValue Stuff \n2012-06-18 myValue Stuff \n2012-06-25 myValue Stuff \n.\n.\n.\nUntil my end date.\n</code></pre>\n\n<p>So this gives me my weekly values.\nHow can i achieve that?</p>\n"},{"tags":["sql","postgresql","dblink"],"answer_count":4,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":8330,"score":9,"question_id":3862648,"title":"How to use (install) dblink in postgresql?","body":"<p>I am used to Oracle and to create a dblink in my schema and then access to a remote database like this : <code>mytable@myremotedb</code>, is there anyway do to the same with PostgreSQL ?</p>\n\n<p>Right now I am using dblink like this : </p>\n\n<pre><code>SELECT logindate FROM dblink('host=dev.toto.com\n                              user=toto\n                              password=isok\n                              dbname=totofamily', 'SELECT logindate FROM loginlog');\n</code></pre>\n\n<p>When I execute this command I get the following error : <code>HINT:  No function matches the given name and argument types. You might need to add explicit type casts.</code></p>\n\n<p>Does anybody have an idea ? Do we have to \"activate\" dblinks or do something before using them ? </p>\n\n<p><strong>Edit</strong></p>\n\n<p>Is there something to do on the remote database we are going to query? Do we have to activate dblink too ? I keep having a <code>could not establish connection</code>. This is the line is type :</p>\n\n<pre><code>SELECT dblink_connect_u('host=x.x.x.x dbname=mydb user=root port=5432');\n</code></pre>\n\n<p>IP Address is correct and postgres is running on the remote server. Any idea ?</p>\n"},{"tags":["c#","sql","ms-access","exception-handling","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13264491,"title":"Syntax error in FROM clause on DataAdapter.Fill()","body":"<p>I am having a problem with my codes, not knowing whats the issue. Can anyone advise?</p>\n\n<p>The whole program is for a biometric program. This is just the login User controller. How can i solve this problem?</p>\n\n<p>I am facing this problem in the line: </p>\n\n<pre><code>dbAdapter.Fill(uds);\n</code></pre>\n\n<p>Stating:</p>\n\n<blockquote>\n  <p>OleDbException was unhandled:Syntax error in FROM clause. </p>\n</blockquote>\n\n<p>My codes are below: \n<strong>USER CONTROLLER</strong> </p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\n    class UserController\n    {\n        User[] user;\n        User searchUser;\n        DataRowCollection rows;\n        DataSet uds;\n        OleDbDataAdapter dbAdapter;\n        DataTable userTable;\n\n        //A kind of gobal var to share in project\n        public static string uNameExist;\n        public static string passwordExist;\n        public static string roleExist;\n\n        public UserController(){\n\n        // Set up Connection String\n        OleDbConnection dbConn = new  OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=PrivacyDefenderDatabase.mdb\");\n\n        // Setup SQL select statement\n        string sqlStatement = \"Select * from User\";\n\n        // Setup DBAdapter (Scientist Table)\n\n        dbAdapter = new OleDbDataAdapter(sqlStatement, dbConn);\n        OleDbCommandBuilder OrderDetailsCmdBuilder = new OleDbCommandBuilder(dbAdapter);\n\n        // Create a Data Set to hold data from DB\n        uds = new DataSet();\n\n        // fill ds with data from DB\n        dbAdapter.Fill(uds);\n\n        // get contacts table\n        DataTable userTab = uds.Tables[0];\n\n        // get all rows\n        rows = userTab.Rows;\n        }\n\n        public User[] GetAllUsers()\n        {\n            DataRow row;\n\n            user = new User[rows.Count];\n\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                row = rows[i];\n                user[i] = new User();\n                user[i].SetId((Int32)row[\"ID\"]);\n                user[i].SetEmployeeID((string)row[\"EmployeeID\"]);\n                user[i].SetUsername((string)row[\"Username\"]);\n                user[i].SetFName((string)row[\"FName\"]);\n                user[i].SetLName((string)row[\"LName\"]);\n                user[i].SetPassword((string)row[\"Password\"]);\n                user[i].SetEmail((string)row[\"Email\"]);\n                user[i].SetContact((Int32)row[\"Contact\"]);\n                user[i].SetRole((string)row[\"Roles\"]);\n            }\n            return user;\n        }\n\n        public User SearchUser(string uname)\n        {\n            searchUser = new User();\n\n            //get all rows from DB\n            GetAllUsers();\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                if (user[i].GetUsername() == uname)\n                {\n                    searchUser.SetId(user[i].GetId());\n                    searchUser.SetEmployeeID(user[i].GetEmployeeID());\n                    searchUser.SetUsername(user[i].GetUsername());\n                    searchUser.SetFName(user[i].GetFName());\n                    searchUser.SetLName(user[i].GetLName());\n                    searchUser.SetPassword(user[i].GetPassword());\n                    searchUser.SetEmail(user[i].GetEmail());\n                    searchUser.SetContact(user[i].GetContact());\n                    searchUser.SetRole(user[i].GetRole());\n                }\n            }\n            return searchUser;\n        }\n\n        public User SearchUserName(string userName)\n        {\n        User searchUserName = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get UserName to store in this container\n            string checkUname = user[i].GetUsername();\n            if (checkUname == userName)\n            {\n                uNameExist = \"Exists\";\n                roleExist = user[i].GetRole();\n            }\n        }\n        return searchUserName;\n        }\n\n        // Search password for Login function\n        public User SearchPassword(string password)\n        {\n        User searchPassword = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get password to store in this container\n\n            string checkPassword = user[i].GetPassword();\n            if (checkPassword == password)\n            {\n                passwordExist = \"Exists\";\n            }\n        }\n        return searchPassword;\n    }\n        public static string GetSHA512(string text)\n        {\n            UnicodeEncoding UE = new UnicodeEncoding();\n            byte[] hashValue;\n            byte[] message = UE.GetBytes(text);\n\n            SHA512Managed hashString = new SHA512Managed();\n            string hex = \"\";\n\n            hashValue = hashString.ComputeHash(message);\n            foreach (byte x in hashValue)\n            {\n                hex += String.Format(\"{0:x2}\", x);\n            }\n            return hex;\n        }\n    }\n}\n</code></pre>\n\n<p>This is my login page form: With the following codes. Whenever i click login, the errors come up. Whats wrong with my codes?</p>\n\n<p>My codes are below:<strong>LOGIN PAGE FORM</strong></p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\npublic partial class Login : Form\n{\n    //A kind of gobal var to share in project\n    public static string fixedUName;\n\n    public Login()\n    {\n        InitializeComponent();\n    }\n\n    private void LoginClearButton_Click(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Clear();\n        LoginPasswordTextBox.Clear();\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void Login_Load(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void LoginButton_Click(object sender, EventArgs e)\n    {\n\n        string userName = this.LoginUsernameTextBox.Text;\n        MessageBox.Show(\"Codes Stops Here\");\n        UserController cont1 = new UserController();\n        User SearchUserName = new User();      \n        // Passing textbox input to Controller\n        fixedUName = LoginUsernameTextBox.Text;\n        SearchUserName = cont1.SearchUserName(userName);\n\n        string passwd = this.LoginPasswordTextBox.Text;\n        UserController cont2 = new UserController();\n        User SearchPassword = new User();\n        // Passing textbox input to Controller\n        SearchPassword = cont2.SearchPassword(UserController.GetSHA512(passwd));\n\n        // Collect information from Controller\n        string checkUnameExist = UserController.uNameExist;\n        string checkPasswordExist = UserController.passwordExist;\n        string checkRoleExist = UserController.roleExist;\n\n        if (checkPasswordExist == \"Exists\" &amp;&amp; checkUnameExist == \"Exists\")\n        { \n            MessageBox.Show(\"Login Successfully\");\n        }\n        else\n        {\n            MessageBox.Show(\"Login Unsuccessfully!\");\n        }   \n    }\n\n    private void LoginUsernameTextBox_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["sql","sql-server","database","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13258850,"title":"table name of column from view","body":"<p>I have a view which returns 30 columns. The view is created by inner join of three tables. I wish to find out which column was taken from which table using a query rather than going through the view line by line.\nIs there a way to do that in sql server 2008?\nthanks in advance </p>\n"},{"tags":["mysql","sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13263497,"title":"SQL compare strings having version as value","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6855588/split-a-string-and-return-greatest-in-mssql\">Split a string and return greatest in mssql</a>  </p>\n</blockquote>\n\n\n\n<p>I need to compare strings which have version value, for example:\nstring1 = 2.3.4\nstring2 = 2.5.6\nNow in the above case i need to check which string version is greater?</p>\n"},{"tags":["sql","table","jointable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13263391,"title":"Joining Table error","body":"<p>I've Table1 created that has composite keys (column1,column2,column3)</p>\n\n<pre><code>CONSTRAINT table_PK PRIMARY KEY (column1,column2,column3)\n</code></pre>\n\n<p>Table 2 has composite key (column1,column4)</p>\n\n<pre><code>CONSTRAINT table2_FK FOREIGN KEY (column1)\n  REFERENCES table1 (column1)\nCONSTRAINT table2_column4_FK FOREIGN KEY (column4)\n  REFERENCES table3 (column4)\n</code></pre>\n\n<p>However i'm not able to join table 2 to table 1. Between the 2 tables, the only referencing column should only be column1</p>\n\n<p>however i'm receiving an error.</p>\n\n<pre><code>SQL Error: ORA-02270: no matching unique or primary key for this column-list\n02270. 00000 -  \"no matching unique or primary key for this column-list\"\n*Cause:    A REFERENCES clause in a CREATE/ALTER TABLE statement\n           gives a column-list for which there is no matching unique or primary\n           key constraint in the referenced table.\n*Action:   Find the correct column names using the ALL_CONS_COLUMNS\n           catalog view\n</code></pre>\n\n<p>I've tried check the constraint and everything seems right.</p>\n\n<p>When i tried using the interface to create table, it did not work as well.</p>\n\n<pre><code>The number of FK columns (2) does not equal to the number of referenced columns (3)\n</code></pre>\n\n<p>From what i see, they require me to have an equal amount of column to have reference to another table. However i dun think it's necessary. It should only require 1 column right? Pls correct me if I'm wrong.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","wpf","textbox","intellisense"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13263046,"title":"SQL Intellisense in WPF Textbox","body":"<p>I am building an application which contains Textbox. I want the Textbox to act just like SQl Server Editor with intellisense. I need help, can i make my Textbox act like a Sql Server Query Editor WITH Intellisense.</p>\n"},{"tags":["java","sql","database","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":52,"score":-1,"question_id":13263493,"title":"Java not recognising SQL statement to retrieve data from database","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their username (their email address) so as to fill in an input form. The functionality of the input form is that the user has to enter for book names in order of priority. In the application, suppose a user's email address is \"david.ferno@gmail.com\"....he will have to input only \"david.ferno\" in the JTextBox...and a SQL LIKE statement is used check the corresponding User ID from the \"bookuser\" table and store it into the \"priority\" table along with the book priority choices. </p>\n\n<p>The issue is that everytime java is displaying syntax error. </p>\n\n<p>Here is the error appearing>>> </p>\n\n<pre><code>Error: java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Syntax error (missing operator) in query expression ''SELECT User_ID FROM bookuser WHERE email_address Like 'david.ferno%' ''.\n</code></pre>\n\n<p>I can't figure out where is my mistake...please help. </p>\n\n<pre><code>    import java.awt.*;\n    import java.awt.event.*;\n    import java.sql.Connection;\n    import java.sql.DriverManager;\n    import java.sql.ResultSet;\n    import java.sql.SQLException;\n    import java.sql.Statement;\n    import javax.swing.*;\n    import java.sql.*;\n    import javax.*;\n\n    public class addpriority extends JFrame{\n    public JTextField txt_email, txt_book1, txt_book2,txt_book3, txt_book4;\n    public JLabel label1;\n    public JButton confirm;\n\n    public addpriority(){\n        super(\"Book Choice Input Menu\");\n        this.setSize(506,620);\n        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n        this.setVisible(true);\n\n        Toolkit toolkit =  Toolkit.getDefaultToolkit ();\n        Dimension dim = toolkit.getScreenSize();\n\n        setLocation((int) (dim.width*0.25), 50);\n\n        JPanel label = new JPanel();\n        JLabel welcome = new JLabel(\"Input Book Priorities\");\n\n        Font f = new Font(\"Verdana\", Font.BOLD,16);\n        welcome.setForeground(Color.BLACK);\n        welcome.setFont(f);\n        add(label);\n        label.add(welcome);\n\n        GridLayout g1 = new GridLayout(15, 2, 0, 10);\n        setLayout(g1);\n\n        JPanel textfield1 = new JPanel();\n        JLabel userid = new JLabel(\"Please Enter your username:\");\n        txt_mail = new JTextField(20);\n        JLabel lect2 = new JLabel(\"@gmail.com\");\n        add(textfield1);\n        textfield1.add(userid);\n        textfield1.add(txt_mail);\n        textfield1.add(lect2);\n\n\n        JPanel textfield2 = new JPanel();\n        add(textfield2);\n\n        JPanel textfield3 = new JPanel();\n        JLabel lbl1 = new JLabel(\"Set Priority by entering Books' name:\");\n        add(textfield3);\n        textfield3.add(lbl1);\n\n\n        JPanel textfield4 = new JPanel();\n        JLabel lbl2 = new JLabel(\"1st Priority:\");\n        txt_module1 = new JTextField(10);\n        add(textfield4);\n        textfield4.add(lbl2);\n        textfield4.add(txt_module1);\n\n        JPanel textfield5 = new JPanel();\n        JLabel lbl3 = new JLabel(\"2nd Priority:\");\n        txt_module2 = new JTextField(10);\n        add(textfield5);\n        textfield5.add(lbl3);\n        textfield5.add(txt_module2);\n\n\n        JPanel textfield6 = new JPanel();\n        JLabel lbl4 = new JLabel(\"3rd Priority:\");\n        txt_module3 = new JTextField(10);\n        add(textfield6);\n        textfield6.add(lbl4);\n        textfield6.add(txt_module3);\n\n        JPanel textfield7 = new JPanel();\n        JLabel lbl5 = new JLabel(\"4th Priority:\");\n        txt_module4 = new JTextField(10);\n        add(textfield7);\n        textfield7.add(lbl5);\n        textfield7.add(txt_module4);\n\n        JPanel button = new JPanel();\n        confirm = new JButton(\"Confirm\");\n        confirm.setMnemonic('C');\n        confirm.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent e)\n            {\n                confirm.setEnabled(true);\n                }\n        });\n\n\n        Handleraddclassroom h = new Handleraddclassroom();\n        confirm.addActionListener(h);\n\n        button.add(confirm);\n        add(button);\n\n\n    }\n\n\n    public class Handleraddclassroom implements ActionListener{\n        public void actionPerformed(ActionEvent event){\n\n            String name = ((JButton)event.getSource()).getText();\n\n\n            if (name.equals(\"Confirm\")){\n\n                String filename = \"C:/JAVA/book.accdb\";\n                String database = \"jdbc:odbc:booking\";\n\n                if(txt_mail.getText().equals(\"\")){\n                    JOptionPane.showMessageDialog(addpriority.this,\"Your Username Field cannot be blank\");\n\n\n                }\n\n                else{\n\n\n                try {\n                    Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                    Connection con = DriverManager.getConnection(database ,\"\",\"\");  //username &amp;password not being used\n\n                    Statement s = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY); //The Result set can now scroll forward and back\n\n\n\n\n                String squery = \"SELECT User_ID FROM bookuser WHERE email_address = '\"+txt_mail.getText()+\"%' \";\n                s.executeQuery(squery);\n\n                String sql = \"INSERT INTO priority VALUES('\" \n\n                    + squery + \"','\"\n                    + txt_book1.getText() + \"','\"\n                    + txt_book2.getText() + \"','\" \n                    + txt_book3.getText() + \"','\"\n                    + txt_book4.getText()+ \"' )\";\n\n                JOptionPane.showMessageDialog(addpriority.this,\"Choice Records Saved.\");\n\n                dispose();\n\n                Mainmenulecturer mml = new Mainmenulecturer();\n\n                s.execute(sql);\n\n                s.close();\n                con.close();\n\n                } catch (Exception e) {System.out.print(\"Error: \" + e);}\n                }\n            }\n        }   \n\n    }\n\n}\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13264168,"title":"Query to delete where id is other than multiple values?","body":"<p>How would I make a query to  delete the column where id is other than multiple values?</p>\n\n<p>I tried</p>\n\n<pre><code>DELETE FROM `Player` WHERE `Player`.`Squad` != 3,\n4,\n8,\n9,\n10,\n11,\n21, \n31,\n36,\n43,\n64,\n65,\n66,\n71,\n74,\n103,\n105,\n154,\n171,\n190;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server-2008","tsql","subquery","cross-join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13263856,"title":"SQL Server subquery in cross join returns error","body":"<p>I have tables <code>A</code>, <code>B</code> and <code>C</code>. Now table <code>A</code> as column <code>A1</code>(Primary Key), table <code>B</code> has column <code>B1</code>(Primary Key) and table <code>C</code> has columns <code>A1</code>(Foreign Key to Table <code>A.A1</code>), <code>B1</code>(Foreign Key to Table <code>B.B1</code>).</p>\n\n<p>Now I'm writing a query which list all rows from <code>A</code> and <code>B</code> and a bit column which will be set to to 1 if a row is found matching in table <code>C</code> otherwise 0.</p>\n\n<pre><code>SELECT \n     ISNULL((SELECT CAST(1 AS BIT) \n             FROM C \n             WHERE C.A1 = A.A1 AND C.B1 = B.B1),0) AS [TAG],\n     A.A1,\n     B.B1\nFROM A CROSS JOIN B\n</code></pre>\n\n<p>This query is producing an <code>Subquery returned more than 1 value.</code> error even though the query has no duplicate rows after combining the <code>A1</code> and <code>B1</code> columns.</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13264140,"title":"Refencing an array element in select Query in PL/SQL","body":"<p>I am writing a Pl/SQl in which I used an array Variable of Length 5.</p>\n\n<p>then I stored all the Column name of another table into the above declared array.\nNow I am looking  for a solution by which I can use the Array element in select Query to fech the data from another table which exactly has the column name.\nLike </p>\n\n<pre><code>arr(1):='Name'\narr(2):='Course'\n</code></pre>\n\n<p>the Query in Pl/Sql should be something like this (for reference only) </p>\n\n<pre><code>select arr(1) from Mttable;\n</code></pre>\n\n<p>==== This generates error when I write the Query in this way</p>\n\n<p>Note- All work should be done in Pl/SQL on Oracle 10g</p>\n\n<p>Please Help.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13263615,"title":"sql error(1242) : sub query returns more than 1 row","body":"<p>i have two tables <code>a_daily</code> and <code>o_daily_lcsgeneration</code>:</p>\n\n<p>i am trying this query : </p>\n\n<pre><code>update a_daily\nset\n  a_daily.Turbine_Generation =  \n   (\n     select sum(o_daily_lcsgeneration.Turbine_Generation) \n     from o_daily_lcsgeneration \n     where o_daily_lcsgeneration.Location = 1 \n     group by o_daily_lcsgeneration.Date\n  ) \n</code></pre>\n\n<p>but received the above error saying sub query more than 1 row</p>\n"},{"tags":["php","sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13263569,"title":"Getting only the same result to appear in SQL","body":"<p>This is my code, later I will be putting it into php, but for the time being I am using it in a provided Query tester. We are doing the first degree of kevin bacon instead of the 6th.</p>\n\n<p><strong>My query is as follow:</strong> </p>\n\n<pre><code>SELECT name,year\nFROM actors\nJOIN roles ON roles.actor_id = actors.id\nJOIN movies ON movies.id=roles.movie_id\nWHERE actors.first_name= 'kevin' AND actors.last_name='bacon' OR actors.first_name= 'sean' AND actors.last_name='penn'\nORDER BY movies.name;\n</code></pre>\n\n<p><strong>it results in</strong> </p>\n\n<pre><code>Animal House 1978\nApollo 13 1995 \nFew Good Men, A 1992 \nFootloose 1984 \nHollow Man 2000 \nJFK 1991 \nMystic River 2003 \nMystic River 2003 \nPlanes, Trains &amp; Automobiles 1987 \nStir of Echoes 1999 \n</code></pre>\n\n<p><strong>How do I get it to show only Mystic River?</strong></p>\n"},{"tags":["sql","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13262295,"title":"convert csv to .sql","body":"<p>is there any tool that I can convert my CSV file which contains chinese characters and about 500 records to .sql format? </p>\n\n<p>I have tried Advanced CSV converter but it only allows me to convert 50 records.</p>\n"},{"tags":["sql","db2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13262301,"title":"Sql - add row when not existed","body":"<p>Suppose I have a query that returns result like this:  </p>\n\n<pre><code>Project Year Type Amt\nPJ00001 2012 1    1000\nPJ00001 2012 2    1000\nPJ00001 2011 1    1000\nPJ00002 2012 1    1000\n</code></pre>\n\n<p>What I want: Every Project will have 2 rows of Types for each Year. If the row is not there, add it to the result with Amt = 0.<br>\nFor example:<br>\n- PJ00001 have 2 rows of type 1,2 in 2012 --> OK. But in 2011, it only have 1 row of Type 1 --> We add one row:<code>PJ00001 2011 2 0</code><br>\n- PJ00002 have only 1 row of type 1 --> add:<code>PJ00002 2012 2 0</code>  </p>\n\n<p>Is there a way to easily do it. The only way I know now is to create a view like: PJ_VIEW. And then:</p>\n\n<pre><code>SELECT *\nFROM PJ_VIEW\nUNION ALL\nSELECT t.PROJECT, t.YEAR_NO, 1 AS TYPE_NO, 0 AS AMT\nFROM PJ_VIEW t\nWHERE NOT EXISTS (SELECT 1 FROM PJ_VIEW t2 WHERE t2.PROJECT = t.PROJECT AND t2.YEAR_NO = t.YEAR_NO AND t2.TYPE_NO = 1)\nUNION ALL\nSELECT t.PROJECT, t.YEAR_NO, 2 AS TYPE_NO, 0 AS AMT\nFROM PJ_VIEW t\nWHERE NOT EXISTS (SELECT 1 FROM PJ_VIEW t2 WHERE t2.PROJECT = t.PROJECT AND t2.YEAR_NO = t.YEAR_NO AND t2.TYPE_NO = 2)\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13263698,"title":"Mysql Prepared Statement using same parameter multiple times","body":"<p>I wrote stored procedure like this:</p>\n\n<pre><code>  DELIMITER $$\n   CREATE PROCEDURE searchByTerm(term VARCHAR(300))\n    BEGIN\n    SET @statment = \"Select name,description from products where name like '%?%' OR description like '%?%'\";\n    PREPARE stmt FROM @statment;\n    SET @a = term;\n    SET @b = term;\n    EXECUTE stmt USING @a,@b;\n    DEALLOCATE PREPARE stmt; \n  END$$\n</code></pre>\n\n<p>calling it as :</p>\n\n<pre><code>CALL searchByTerm('xyz');\n</code></pre>\n\n<p>it results in following error:</p>\n\n<pre><code>Error Code : 1210\nIncorrect arguments to EXECUTE\n</code></pre>\n\n<p>Am i doing anythng wrong? I know it can be done with concat statement but why it's not working like this? Can't i use same parameter multiple times? Thanks for any help..</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13177874,"title":"combine multiple rows int one row with many to many","body":"<p>Using SQL Server I have the following tables/ data</p>\n\n<p><strong>CUS_VISIT</strong></p>\n\n<pre><code>Cus_ID    Cus_Vis_ID\n1           01\n1           02\n2           01\n</code></pre>\n\n<p>and</p>\n\n<p><strong>CUS_EVENT</strong></p>\n\n<pre><code>Cus_Event_ID    Cus_ID    Cus_Vis_ID\n001               1            01\n002               1            01\n</code></pre>\n\n<p>and</p>\n\n<p><strong>CUS_XREF</strong></p>\n\n<pre><code>Cus_ID    Cus_Event_ID    Cus_Prt_ID    Cus_Seq_No\n1            001               1           1\n1            001               2           1\n</code></pre>\n\n<p>and</p>\n\n<p><strong>CUS_PRT</strong></p>\n\n<pre><code>Cus_ID    Cus_Prt_ID    Prt_Cd\n1            1            1A\n1            2            2A\n</code></pre>\n\n<p>I have tried numerous queries but didn't include them as i thought it would confuse things... most of them have used the xml path functionality but to no avail (i haven't been trying pivot since there is a massive list of codes).</p>\n\n<p>I am trying to get the following</p>\n\n<pre><code>SQL RESULTS\n\nCus_ID     Prt_Cd     Cus_Vis_ID\n1           1A,2A        1\n</code></pre>\n\n<p>what I end up with is</p>\n\n<pre><code>SQL RESULTS\n\nCus_ID     Prt_Cd     Cus_Vis_ID\n1           1A           1\n1           2A           1\n</code></pre>\n\n<p>The tables are linked by ...</p>\n\n<pre><code>CUS_VISIT.Cus_ID    = CUS_EVENT.Cus_ID \nCUS_VISIT.Cus_Vis_ID  = CUS_EVENT.Cus_Vis_ID\nCUS_VISIT.Cus_ID = CUS_XREF.Cus_ID\nCUS_EVENT.Cus_Event_ID = CUS_XREF.Cus_Event_ID    \nCUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID \nCUS_XREF.Cus_ID = CUS_PRT.Cus_ID \n</code></pre>\n\n<p>I can almost get what I am after if I drop the <code>CUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID</code> \njoin but then I get all of the part codes (<code>Prt_Cd</code>) for the customer not just the ones for that visit. </p>\n\n<p>If it would help to see my unsuccessful queries or if I have left anything out sorry just let me know. Thanks for any help.</p>\n\n<p>--</p>\n\n<p>here is my subquery</p>\n\n<pre><code>stuff((\n                  select ',' + B.prt_cd\n                    from CUS_PRT B \n                    WHERE B.prt_cd = XREF.prt_cd  -- this is killing me\n                    and XREF.cus_id=B.cus_id and \n                    -- some extra criteria i need but didn't think involved in my issue\n                    B.prt_typ='1'  \n                    and B.valid_entry='Y' and B.cur_entry_ind='Y'\n                    for xml path('')),1,1,'')\n</code></pre>\n\n<p>here is my latest attempt. I added a new post because I didn't realize an edit would move it to the top of the list again... I think i need another subquery somewhere but not sure where and how to tie it to the other two queries.</p>\n\n<pre><code>select distinct CUS_EVENT.cus_id, CUS_EVENT.cus_visit_id,\n    (Select CUS_PRT.prt_cd + ',' AS [text()]\n    From CUS_PRT, CUS_XREF\n    where \n    CUS_EVENT.cus_id=XREF.cus_id\n    and CUS_EVENT.cus_event_id = XREF.cus_event_id \n    and CUS_XREF.cus_id=CUS_PRT.cus_id \n    and CUS_XREF.cus_prt_id = CUS_PRT.cus_prt_id \n    and CUS_XREF.prt_seq_no ='1'\n    order by CUS_PRT.prt_cd\n    for XML PATH('')) [Codes]\nfrom CUS_EVENT\n</code></pre>\n"},{"tags":["sql","oracle","parameterized"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":728,"score":6,"question_id":7383121,"title":"Embedded SQL vs Dynamic SQL","body":"<p>I am currently doing a *cough*Oracle*cough* database subject. The lecturer is introducing <a href=\"http://en.wikipedia.org/wiki/Embedded_SQL\" rel=\"nofollow\">embedded SQL</a> as the way you get other languages (e.g. C, C++) to interact with the (Oracle) database.</p>\n\n<p>I have done some database work myself (on mysql) where I use dynamic sql.</p>\n\n<p>As embedded SQL seems to be limited to a few Oracle and a few others, so is this more an attempt at lock-in, or is there real value in embedded SQL?</p>\n\n<p><strong>Edit:</strong> I just realized that the fact this lesson was right after a lesson on PL/SQL may be important.</p>\n\n<p><strong>Original question</strong> asked about parameterized SQL (now replaced by \"dynamic sql\" to improve question).</p>\n\n<p><strong>Aside:</strong> I am thinking that the ~$30 \"SQL and relational theory\" book I bought is teaching me more than this database class. </p>\n"},{"tags":["sql","sql-server","sql-server-2008","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13261497,"title":"incorrect syntax near in creating stored procedure on a remote db","body":"<p>I am trying to recreate a stored procedure on a database which is hosted on a remote server.\nWhen creating the same SP locally I don't get any errors but when I am trying to create the SP on the remote server I am getting this errors:</p>\n\n<pre><code>Msg 102, Level 15, State 1, Procedure MySP, Line 26\nIncorrect syntax near 'MERGE'.\nMsg 102, Level 15, State 1, Procedure MySP, Line 27\nIncorrect syntax near 'S'.\n</code></pre>\n\n<p>Those errors are repeating in multiple SP and I didn't get them when I created the SP's on my local server.\nAny idea what can that be?\nHere is a sample SP:</p>\n\n<pre><code>USE [MyDatabase]\nGO\n/****** Object:  StoredProcedure [dbo].[InsertContractorInfo]    Script Date: 11/07/2012 01:08:31 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n-- =============================================\n-- Author:      &lt;Author,,Name&gt;\n-- Create date: &lt;Create Date,,&gt;\n-- Description: &lt;Description,,&gt;\n-- =============================================\n--exec [dbo].[InsertContractorInfo] \nCREATE PROCEDURE [dbo].[InsertContractorInfo]\n(@CompanyName nvarchar(50), \n @LicenseNumber nvarchar(50),\n @MailingAddress1 nvarchar(200),\n @MailingAddress2 nvarchar(200),\n @Phone nvarchar(10),\n @Fax nvarchar(10),\n @Mobile nvarchar(10),\n @Email nvarchar(200),\n @PercentCommercial int,\n @PercentResidental int,\n @TotalEmployees int,\n @AnnualSales decimal(18,2),\n @InsuranceCompanyContact nvarchar(100)=null,\n @InsuranceCompanyContactEmail nvarchar(100)=null,\n @InsuranceCompanyContactPhone nvarchar(100)=null,\n @ContractorID uniqueidentifier)\nAS\nBEGIN\nMERGE dbo.Contractor con\nUSING(SELECT 1 S) S\nON con.Oid = @ContractorID\nWHEN MATCHED THEN UPDATE \n   SET       \n      [CompanyName] = @CompanyName      \n      ,[LicenseNumber] = @LicenseNumber\n      ,[MailingAddress1] = @MailingAddress1\n      ,[MailingAddress2] = @MailingAddress2\n      ,[Phone] = @Phone\n      ,[Fax] = @Fax\n      ,[EMail] =@Email\n      ,[Mobile] =@Mobile      \n      ,[PercentCommercial] = @PercentCommercial\n      ,[PercentResidental] = @PercentResidental\n      ,[TotalEmployees] = @TotalEmployees\n      ,[ApproximateAnnualSales] = @AnnualSales      \n      ,[InsuranceCompanyContact] = @InsuranceCompanyContact\n      ,[InsuranceCompanyContactPhone] = @InsuranceCompanyContactPhone\n      ,[InsuranceCompanyContactEmail] = @InsuranceCompanyContactEmail      \nWHEN NOT MATCHED THEN\nINSERT \n           ([Oid]       \n           ,[CompanyName]           \n           ,[LicenseNumber]\n           ,[MailingAddress1]\n           ,[MailingAddress2]\n           ,[Phone]\n           ,[Fax]\n           ,[EMail]\n           ,[Mobile]                      \n           ,[PercentCommercial]\n           ,[PercentResidental]\n           ,[TotalEmployees]\n           ,[ApproximateAnnualSales]                      \n           ,[InsuranceCompanyContact]\n           ,[InsuranceCompanyContactPhone]\n           ,[InsuranceCompanyContactEmail])\n     VALUES\n           (@ContractorId           \n           ,@CompanyName           \n           ,@LicenseNumber\n           ,@MailingAddress1\n           ,@MailingAddress2\n           ,@Phone\n           ,@Fax\n           ,@EMail\n           ,@Mobile\n           ,@PercentCommercial\n           ,@PercentResidental\n           ,@TotalEmployees\n           ,@AnnualSales                     \n           ,@InsuranceCompanyContact\n           ,@InsuranceCompanyContactPhone\n           ,@InsuranceCompanyContactEmail\n           );\nEND\nGO\n</code></pre>\n\n<p>Thanks, Laziale</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13252165,"title":"concatenate with 3 or 4 joins","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13177874/combine-multiple-rows-int-one-row-with-many-to-many\">combine multiple rows int one row with many to many</a>  </p>\n</blockquote>\n\n\n\n<p>Using SQL Server I have the following tables/ data</p>\n\n<pre><code>CUS_VISIT\n\nCus_ID    Cus_Vis_ID\n1           01\n1           02\n2           01\n</code></pre>\n\n<p>and</p>\n\n<pre><code>CUS_EVENT\n\nCus_Event_ID    Cus_ID    Cus_Vis_ID\n001               1            01\n002               1            01\n</code></pre>\n\n<p>and</p>\n\n<pre><code>CUS_XREF\n\nCus_ID    Cus_Event_ID    Cus_Prt_ID    Cus_Seq_No\n1            001               1           1\n1            001               2           1\n</code></pre>\n\n<p>and</p>\n\n<pre><code>CUS_PRT\n\nCus_ID    Cus_Prt_ID    Prt_Cd\n1            1            1A\n1            2            2A\n</code></pre>\n\n<p>I am trying to get the following</p>\n\n<p>SQL RESULTS</p>\n\n<pre><code>Cus_ID     Prt_Cd     Cus_Vis_ID\n1           1A,2A        1\n</code></pre>\n\n<p>what I end up with is</p>\n\n<p>SQL RESULTS</p>\n\n<pre><code>Cus_ID     Prt_Cd     Cus_Vis_ID\n1           1A           1\n1           2A           1\n</code></pre>\n\n<p>The tables are linked by ...</p>\n\n<pre><code>CUS_VISIT.Cus_ID    = CUS_EVENT.Cus_ID \nCUS_VISIT.Cus_Vis_ID  = CUS_EVENT.Cus_Vis_ID\nCUS_VISIT.Cus_ID = CUS_XREF.Cus_ID\nCUS_EVENT.Cus_Event_ID = CUS_XREF.Cus_Event_ID    \nCUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID \nCUS_XREF.Cus_ID = CUS_PRT.Cus_ID \n</code></pre>\n\n<p>I can almost get what I am after if I drop the CUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID join but then I get all of the part codes (Prt_Cd) for the customer not just the ones for that visit. </p>\n\n<p>here is what i have</p>\n\n<pre><code>select distinct CUS_EVENT.cus_id, CUS_EVENT.cus_visit_id,\n    (Select CUS_PRT.prt_cd + ',' AS [text()]\n    From CUS_PRT, CUS_XREF\n    where \n    CUS_EVENT.cus_id=XREF.cus_id\n    and CUS_EVENT.cus_event_id = XREF.cus_event_id \n    and CUS_XREF.cus_id=CUS_PRT.cus_id \n    and CUS_XREF.cus_prt_id = CUS_PRT.cus_prt_id \n    and CUS_XREF.prt_seq_no ='1'\n    order by CUS_PRT.prt_cd\n    for XML PATH('')) [Codes]\nfrom CUS_EVENT\n</code></pre>\n\n<p>i made a similar post recently but didn't get any specific help. i think i need another sub-query some where. thanks for looking at this.</p>\n"},{"tags":["sql","sql-server-2008","query","stored-procedures","triggers"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13193745,"title":"update column1 based on another column2 from same table without using trigger","body":"<p>scenario is :\nThere are many columns in my table like Col1 Col2 Col3 Col4.\nI want to set data of Col4 if VALUE of Col1 is changed. On firing update query value of Col1 may or may not change.</p>\n\n<p>I have implemented it through trigger.</p>\n\n<pre><code>Select @ISTDNotPossibleI = I.ISTDNotPossible From inserted i\nSelect @IsTDCompletedD = D.IsTDCompleted from deleted d\n\nIf (\n  (@IsTDCompletedD != @IsTDCompletedI) Or\n  (@ISTDNotPossibleD != @ISTDNotPossibleI) Or\n  (@IsTDDirectD != @IsTDDirectI) Or (\n    @IsTDCompletedD Is Null And\n    @IsTDCompletedI Is Not Null\n  ) Or (\n    @ISTDNotPossibleD Is Null And\n    @ISTDNotPossibleI Is Not Null\n  ) OR (\n    @IsTDDirectD Is Null And\n    @IsTDDirectI Is Not Null\n  )\n)\nBegin\n  Update \n    CRM_CarTDLog \n  Set\n    TDCompletedEventBy = @UpdatedBy,\n    TDCompletedEventOn = GetDate() \n  Where\n    Id = @UpdateID \nEnd\n</code></pre>\n\n<p>Problem is : this field is not likely to be updated regularly. But Col2 and Col3 are likely to be updated frequently. And since update query is being fired on this table frequently the trigger will be  fired frequently too. And it is increasing the overhead without serving any purpose.</p>\n\n<p>I want to solve this without using trigger. Please help me.</p>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13255427,"title":"Replace first Letter in a field Oracle","body":"<p>Hi Guys I have this Table\n<img src=\"http://i.stack.imgur.com/EvXt6.png\" alt=\"My Original table\"></p>\n\n<p>I need to replace the First Letter in ACCT_NAME with the First Name of ACCT_SHORT_NAME. Records like the Higliighted(RAFFMAN) should not be changed. I have tried:</p>\n\n<pre><code>select acct_name, ACCT_SHORT_NAME,replace(acct_name, substr(acct_name, 1, 1),      ACCT_SHORT_NAME)\n from tbaadm.gam where schm_type = 'TDA' and rcre_user_id  = 'SYSTEM' and substr(acct_name,2,1) = ' '\n</code></pre>\n\n<p>I am getting:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Mvl1k.png\" alt=\"Table after select\"></p>\n\n<p>This means that am Picking the whole value in ACCT_SHORT_NAME. WHat is the best way to do what am trying to do?</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13262283,"title":"Sql query join if table result is not null","body":"<p>I am trying to get some data from a table and possibly filtering it depending on the result from another query.</p>\n\n<p>The code is something like this:</p>\n\n<pre><code>DECLARE @TestTable  TABLE(TestID INT)\n\nINSERT INTO @TestTable\nSELECT TestID from v_Lookuptable Where SomeID = @input\n\n\nSELECT DISTINCT\nC.[Level],\nC.Name\nFROM\ndbo.CPackage CP \nRight outer join @TestTable TT on TT.TestID = CP.TestID\nWHERE\nAND (TT.TestID is null OR Exists( Select TT.TestID from @TestTable \n                                    inner join dbo.CProduct CP on CP.TestID = MT.TestID\n                                    where TT.TestID = CP.TestID\n                                    ))\n</code></pre>\n\n<p>My problem is that if I pass in my currently scenario the <code>@input</code> as 1, then the top part returns some numbers: 1, 2, 3</p>\n\n<p>But if I pass <code>@input</code> as 2, then the top part returns nothing because nothing matches.</p>\n\n<p>The idea is that if nothing matches, return everything in the bottom query, so from <code>dbo.CPackage</code>, else, only return those things where the <code>TestID</code> match.</p>\n\n<p>I have tried various things like changing the joins, case statements, using <code>ISNULL</code> and <code>collasce</code>. Also I have tried to remove the part <code>TT.TestID is null</code> and it then works if the top table returns something, but when I add it again it returns everything and never filters. So I know the logic is wrong... I just can't figure out the correct logic for this.... :S</p>\n\n<p>Is it possible? I presume it is... </p>\n\n<p>Cheers\nRobin</p>\n\n<p>** Solution **</p>\n\n<p>Remove the join and just put it in the where filter...</p>\n\n<pre><code>SELECT DISTINCT\nC.[Level],\nC.Name\nFROM\ndbo.CPackage CP \n\nWHERE\nCP.TestID = coalesce( (select distinct TestID from v_Lookuptable LT\n        where LT.SomeID =  @input), CP.TestID )\n</code></pre>\n"},{"tags":["sql","db2"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":4500,"score":2,"question_id":1018469,"title":"SQL (DB2) Return multiple conditional counts in a single query","body":"<p>I am trying select multiple conditional summaries into a single table result on a DB2 based database. </p>\n\n<p>Example:</p>\n\n<pre><code>SELECT COUNT(FOO) FROM T1 WHERE T1.A=1 AS A_COUNT,\nSELECT COUNT(FOO) FROM T1 WHERE T1.B=2 AS B_COUNT\nExt...\n</code></pre>\n\n<p>Any help is appreciated. </p>\n"}]}
{"total":102597,"page":6,"pagesize":100,"questions":[{"tags":["mysql","sql","relational-database","relation","relational-algebra"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13262481,"title":"Writing a query in strictly relational algebra (AS IN NOT SQL/MYSQL)","body":"<p>So here are three relations:</p>\n\n<p><strong>Table Members</strong></p>\n\n<blockquote>\n  <p>Members(member_id, name, city, state)</p>\n</blockquote>\n\n<p>where member_id is the primary key</p>\n\n<p><strong>Table Borrowed</strong></p>\n\n<blockquote>\n  <p>Borrowed(borrow_id, lib_id, member_id)</p>\n</blockquote>\n\n<p>where borrow_id is the primary key </p>\n\n<p><strong>Table Libraries</strong></p>\n\n<blockquote>\n  <p>Libraries(lib_id, lib_address, lib_city, lib_state)</p>\n</blockquote>\n\n<p>where lib_id is the primary key</p>\n\n<p>Both lib_id and member_id are foreign keys</p>\n\n<p>So I am trying to write a query that finds all of the member_id of members that have borrowed a book at EVERY library in their city. This means that </p>\n\n<pre><code>members.city = libraries.lib_city AND members.state = libraries.lib_state\n</code></pre>\n\n<p>I was thinking about using relational division. For example you have a relation consisting of the member_id's and all of the lib_id where they have borrowed a book. And you divide this by a relation that consists of all of the lib_id in that member's city. </p>\n\n<p>However, I am confused as to how to write this in relational algebraic terms.</p>\n\n<p>In mysql/sql it is very easy but the translation to relational algebra is where I get stuck.</p>\n"},{"tags":["sql","sqlite","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13263045,"title":"Grouping sql statement","body":"<p>I'm using SQLite and have a table like this:</p>\n\n<pre><code>CREATE TABLE stream_activity(\n    id INTEGER PRIMARY KEY,\n    username TEXT,\n    time INTEGER,\n    viewers INTEGER\n);\n</code></pre>\n\n<p>I'm keeping time as a unix timestamp. Now here's what I want to do -- have a table that shows the most viewed streams over the course of an hour (with data recorded every 5 minutes), but also sorted by time ascending and grouped by username, kind of like this (x = now, y = some random value):</p>\n\n<pre>\nTime     Username      Viewers\nx - 1h   GuyOne        y\nx - 55m  GuyOne        y\n....\nx - 5m   GuyOne        \nx        GuyOne        highest_view_count\nx - 1h   GuyTwo\nx - 55m  GuyTwo        y\n....\nx - 5m   GuyTwo        y\nx        GuyTwo        secondhighest_view_count\n</pre>\n\n<p>Also feel free to tell me if it's not possible with sqlite (and what type of sql server can do this)</p>\n"},{"tags":["sql","data-modeling"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":324,"score":1,"question_id":6192396,"title":"Are dimension tables and domain tables the same thing?","body":"<p>I think I know what a domain table is (it basically contains all the possible values that some other column can contain), and I've looked up dimension table in Wikipedia. Unfortunately, I'm having a hard time understanding the description they have there, because they explain it in terms of another piece of jargon: \"fact table\", which is explained to \"consists of the measurements, metrics or facts of a business process.\" To me, that's very tautological, which is <a href=\"http://xkcd.com/703/\" rel=\"nofollow\">not helpful</a>. Can someone explain this in <em>plain English</em>?</p>\n"},{"tags":["php","mysql","sql","phpmyadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13244406,"title":"MySQL Tables for School Website","body":"<p>Right now I have 40+ tables for my website and I don't think I'm using MySQL to it's full power quite right. I am making a website similar to Moodle. It basically just holds tests for students grouped by courses.</p>\n\n<p><strong>Origonal Tables</strong>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>courses - Lists all courses (ID, Name)\nc_$id   - Lists all the Tests (ID, Name, etc) for course number $id\na_$id   - Lists all questions for the test number $id (Question, A, B, C, D)\ng_$id   - Lists all grades for the course with course number $id.\nc_a     - Lists course ID and assignment ID pairs ex: (1,2) (1,3) (2,2) (2,3)\n</code></pre>\n\n<p><strong>Tables Revision 1:</strong>\n</p>\n\n<pre><code>courses   - Lists all courses (ID, Name, etc)\ntests     - Lists all tests (ID, Name, etc)\nquestions - Lists all questions from all tests (ID, Ques, Ans)\ngrades*   - Lists all grades (studentID, courseID, testID, grade)\nstudents* - Lists all students and their courses (StudentID, courseID)\n</code></pre>\n\n<p>The grades* table, it's basically 3 primary keys and a value. Something seems odd about it. Is there a better way? Same goes for the students table. Both are basically connections of the other tables. Primary key for fast searching is not possible?</p>\n\n<p><strong>Origonal Post:</strong></p>\n\n<p>What is the most efficient way to recreate this to utilize the power of MySQL?</p>\n\n<p>As of right now when a new course is made it creates a new table for that course (<code>c_$id</code>), then a table for each assignment and a list of grades for that course <code>g_$id</code>. Then when creating an assignment it creates a new <code>a_$id</code> table,adding that course and assignment pair to <code>c_a</code>.</p>\n\n<p>I have removed the \"<code>*</code>\" from most of my select statements and added \"<code>LIMIT 1</code>\" to any that are selecting a primary key, next is solving this OOP issue.</p>\n"},{"tags":["sql","linq","predicatebuilder"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":38,"score":5,"question_id":13261700,"title":"need help in using predicate builder","body":"<p>I need to know about using predicatebuilder. On almost every example of how to use it, they show the code as follows</p>\n\n<pre><code>    var predicate = PredicateBuilder.True&lt;employee&gt;();\n\n    if(!string.IsNullOrEmpty(txtAddress.Text))\n        predicate = predicate.And(e1 =&gt; e1.Address.Contains(txtAddress.Text));\n    if (!string.IsNullOrEmpty(txtEmpId.Text))\n        predicate = predicate.And(e1 =&gt; e1.Id == Convert.ToInt32(txtEmpId.Text));\n    if (!string.IsNullOrEmpty(txtDesc.Text))\n        predicate = predicate.And(e1 =&gt; e1.Desc.Contains(txtDesc.Text));\n    if (!string.IsNullOrEmpty(txtName.Text))\n        predicate = predicate.And(e1 =&gt; e1.Name.Contains(txtName.Text));\n\n    EmployeeDataContext edb= new EmployeeDataContext();\n    var emp = edb.Employees.Where(predicate);\n    grdEmployee.DataSource = emp.ToList();\n    grdEmployee.DataBind();\n</code></pre>\n\n<p>What is that employee object, the one between the greater than and less than brackets? I have racked my brains on that one. I am using linq to sql entities and I get compile errors when I try this myself. I think the errors are something like, cannot cast from a linq table to . . . I am a beginner. Please forgive me for asking what may be an obvious thing. Thank you.</p>\n\n<p>ed Cohen</p>\n"},{"tags":["sql","database","database-design","sqlite3","one-to-many"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":364,"score":1,"question_id":7541595,"title":"How to create one to many in SQLITE3?","body":"<p>How to create one to many in SQLITE3?\nI have 2 tables:</p>\n\n<pre><code>    Mans:\n   _id   name\n     1    antony\n     2    fred\n</code></pre>\n\n<p>and </p>\n\n<pre><code>       point\n  _id   date   point   \n   1     23     77\n         24     99 \n\n   2     25     78\n          5     0\n</code></pre>\n\n<p>i dont now SQL syntax, help me , please.</p>\n"},{"tags":["sql","database","database-design"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13260262,"title":"Data separated by commas inside a field vs new table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3653462/is-storing-a-comma-separated-list-in-a-database-column-really-that-bad\">Is storing a comma separated list in a database column really that bad?</a>  </p>\n</blockquote>\n\n\n\n<p>This is a problem I often encounter when trying to expand the database.</p>\n\n<p>For example:</p>\n\n<p>I want to keep track of how many users saw a particular article in my website, so in the database I added a <code>views</code> field to the <code>article</code> table. Now, if I wanted to make sure that these are <em>unique</em> views then this is clearly not enough.</p>\n\n<p>So let's say that in my design I can identify a user (or at least a computer) with a single number that's stored along with an IP or something.</p>\n\n<p>Then, if I wanted to keep track of how many <em>unique</em> users saw a particular article which is the best way to go?</p>\n\n<ul>\n<li>To create another table <code>article_views</code> with the fields <code>article_id</code> and\n<code>user_id</code>.</li>\n<li>To save the <code>user_id</code>s separated by commas inside the <code>views</code> field of the <code>article</code> table.</li>\n</ul>\n"},{"tags":["mysql","sql","service","random"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13262068,"title":"Is there / would be feasible a service providing random elements from a given SQL table?","body":"<p><strong>ABSTRACT</strong></p>\n\n<p>Talking with some colleagues we came accross the \"extract random row from a big database table\" issue. It's a classic one and we know the naive approach (<a href=\"http://stackoverflow.com/questions/580639/how-to-randomly-select-rows-in-sql\">also on SO</a>) is usually something like:</p>\n\n<blockquote>\n  <p>SELECT * FROM mytable ORDER BY RAND() LIMIT 1</p>\n</blockquote>\n\n<p><strong>THE PROBLEM</strong></p>\n\n<p>We also know a query like that is utterly inefficient and actually usable only with very few rows. There are some approaches that could be taken to attain better efficiency, like <a href=\"http://stackoverflow.com/questions/211329/quick-selection-of-a-random-row-from-a-large-table-in-mysql\">these ones</a> still on SO, but they won't work with arbitrary primary keys and the <em>randomness</em> will be skewed as soon as you have holes in your numeric primary keys. An answer to the last cited question links to <a href=\"http://jan.kneschke.de/projects/mysql/order-by-rand/\" rel=\"nofollow\">this article</a> which has a good explanation and some bright solutions involving an additional \"equal distribution\" table that must be maintained whenever the \"master data\" table changes. But then again if you have frequent DELETEs on a big table you'll probably be screwed up by the constant updating of the added table. Also note that many solutions rely on <code>COUNT(*)</code> which is ridiculously fast on MyISAM but \"just fast\" on InnoDB (I don't know how it performs on other platforms but I suspect the InnoDB case could be representative of other transactional database systems).</p>\n\n<p>In addition to that, even the best solutions I was able to find are fast but not <em>Ludicrous Speed</em> fast.</p>\n\n<p><strong>THE IDEA</strong></p>\n\n<p>A separate service could be responsible to generate, buffer and distribute random row ids or even entire random rows:</p>\n\n<ul>\n<li>it could choose the best method to extract random row ids depending on how the original PKs are structured. An ordered list of keys could be maintained in ram by the service (shouldn't take too many bytes per row in addition to the actual size of the PK, it's probably ok up to 100~1000M rows with standard PCs and up to 1~10 billion rows with a beefy server)</li>\n<li>once the keys are in memory you have an implicit \"row number\" for each key and no holes in it so it's just a matter of choosing a random number and directly fetch the corresponding key</li>\n<li>a buffer of random keys ready to be consumed could be maintained to quickly respond to spikes in the incoming requests</li>\n<li>consumers of the service will connect and request N random rows from the buffer</li>\n<li>rows are returned as simple keys <em>or</em> the service could maintain a (pool of) db connection(s) to fetch entire rows</li>\n<li>if the buffer is empty the request could block or return EOF-like</li>\n<li>if data is added to the master table the service must be signaled to add the same data to its copy too, flush the buffer of random picks and go on from that</li>\n<li>if data is deleted from the master table the service must be signaled to remove that data too from both the \"all keys\" list and \"random picks\" buffer</li>\n<li>if data is updated in the master table the service must be signaled to update corresponding rows in the key list and in the random picks</li>\n</ul>\n\n<p><strong>WHY WE THINK IT'S COOL</strong></p>\n\n<ul>\n<li>does not touch disks other than the initial load of keys at startup or when signaled to do so</li>\n<li>works with any kind of primary key, numerical or not</li>\n<li>if you know you're going to update a large batch of data you can just signal it when you're done (i.e. not at every single insert/update/delete on the original data), it's basically like having a fine grained lock that only blocks requests for random rows</li>\n<li>really fast on updates of any kind in the original data</li>\n<li>offloads some work from the relational db to another, memory only process: helps scalability</li>\n<li>responds really fast from its buffers without waiting for any querying, scanning, sorting</li>\n<li>could easily be extended to similar use cases beyond the SQL one</li>\n</ul>\n\n<p><strong>WHY WE THINK IT COULD BE A STUPID IDEA</strong></p>\n\n<ul>\n<li>because <em>we</em> had the idea without help from any third party</li>\n<li>because nobody (we heard of) has ever bothered to do something similar</li>\n<li>because it adds complexity in the mix to keep it updated whenever original data changes</li>\n</ul>\n\n<p><strong>AND THE QUESTION IS...</strong></p>\n\n<p>Does anything similar already exists? If not, would it be feasible? If not, why?</p>\n"},{"tags":["php","mysql","sql","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13244328,"title":"Updating a MySQL database via PDO and tokens - all parameters being set to last value in dataset","body":"<p>As the title states: I am trying to update specific records in a MySQL data base using PDO and tokens to secure against any injection.</p>\n\n<p>Here is my code:</p>\n\n<p>Some arrays to help build the query:</p>\n\n<pre><code>$id = 1234\n$values = array ('a','b','c',);\n$variables = array ($A, $B, $C);\n</code></pre>\n\n<p>The query built via loop:</p>\n\n<pre><code>$sql =  \"UPDATE table1 SET \";   \n        foreach($values as $value)\n        {\n        $sql .=\"$value = :$value, \";\n        }\n        $sql = rtrim($sql,', ');    \n        $sql .=\" WHERE id = '$id'\";\n</code></pre>\n\n<p>Execution of query via PDO:</p>\n\n<pre><code>try     \n{\n$pdo = new PDO('mysql:host=localhost; dbname=db01', $username, $password);\n$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n$stmt = $pdo-&gt;prepare($sql);\nforeach(array_combine($values, $variables) as $value=&gt;$variable)\n{\n$stmt-&gt;bindParam(\":$value\", $variable);\n}\n\n$stmt-&gt;execute();\n</code></pre>\n\n<p>The result:\nEvery field in the specified record (matching $id) is set to the same value, which is always equal to the contents of the last variable listed in the array (in this example they would all contain the value held in $C)</p>\n\n<p>echoing the SQL query shows it has been constructed correctly.</p>\n\n<p>Any ideas? Thanks for your consideration</p>\n"},{"tags":["sql","sql-server-2008","locking"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":6745120,"title":"Creation time of a lock in SQL Server 2008","body":"<p>So I'm trying to monitor the longest living lock in my database. The idea is that if a lock has been held for a certain amount of time, I will receive a warning in my application.</p>\n\n<p>But for the life of I can't find the creation time of the locks.</p>\n\n<p>I have used:</p>\n\n<pre><code>exec msdb..sp_lock\nexec msdb..sp_who2\nSELECT * FROM sys.dm_tran_locks\nselect * from sys.syslockinfo\nselect cmd, * from sys.sysprocesses where blocked &gt; 0\n</code></pre>\n\n<p>But none of these seem to have the information I need.</p>\n\n<p>Any ideas?</p>\n\n<p>G</p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13261071,"title":"Where clause on subquery statement in select","body":"<p>Let's say I have a query like this:</p>\n\n<pre><code>   Select col1, \n          col2, \n          (select count(smthng) from table2) as 'records'\n   from table1\n</code></pre>\n\n<p>I want to filter it to be not null for 'records' column.</p>\n\n<p>I cannot do this:  </p>\n\n<pre><code>         Select col1, \n                col2, \n               (select count(smthng) from table2) as 'records'\n          from table1\n        where records is not null  \n</code></pre>\n\n<p>The best I came up with is to write this resultset to a Table Value parameter and have a separate query on that resultset. Any ideas?</p>\n"},{"tags":["sql","installer","localdb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13142160,"title":"Way to deploy VS2010 WinForms application with SQL 2012 LocalDb with VS 2010 Installer","body":"<p>Is there a reference on creating a Visual Studio 2010 Installer project for a WinForms application that uses SQL 2012 LocalDb?</p>\n"},{"tags":["mysql","sql","sql-order-by","order","union"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13261113,"title":"mysql order by and union and parentheses","body":"<p>so I have a query like this:</p>\n\n<pre><code>(SELECT last_updated FROM ...) UNION (SELECT last_updated FROM ...) ORDER BY last_updated\n</code></pre>\n\n<p>Notice that the ORDER BY statement is outside both parentheses...When I run the query it appears that it does a combined order by last_updated (which is what I want to do). IE. it took the combined unioned result set and order them all by last_updated as a single set.</p>\n\n<p>However, I want to confirm that this is indeed what this will do, so does anyone have any link to some docs that confirm that this will indeed happen? Can anyone confirm for a FACT that this will indeed happen if you perform the query this way? </p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1526,"score":2,"question_id":2561130,"title":"Merge overlapping date intervals","body":"<p>Is there a better way of merging overlapping date intervals?<br>\nThe solution I came up with is so simple that now I wonder if someone else has a better idea of how this could be done.</p>\n\n<pre><code>/***** DATA EXAMPLE *****/\nDECLARE @T TABLE (d1 DATETIME, d2 DATETIME)\nINSERT INTO @T (d1, d2)\n        SELECT '2010-01-01','2010-03-31' UNION SELECT '2010-04-01','2010-05-31' \n  UNION SELECT '2010-06-15','2010-06-25' UNION SELECT '2010-06-26','2010-07-10' \n  UNION SELECT '2010-08-01','2010-08-05' UNION SELECT '2010-08-01','2010-08-09' \n  UNION SELECT '2010-08-02','2010-08-07' UNION SELECT '2010-08-08','2010-08-08' \n  UNION SELECT '2010-08-09','2010-08-12' UNION SELECT '2010-07-04','2010-08-16' \n  UNION SELECT '2010-11-01','2010-12-31' UNION SELECT '2010-03-01','2010-06-13' \n\n/***** INTERVAL ANALYSIS *****/\nWHILE (1=1)  BEGIN\n  UPDATE t1 SET t1.d2 = t2.d2\n  FROM @T AS t1 INNER JOIN @T AS t2 ON \n            DATEADD(day, 1, t1.d2) BETWEEN t2.d1 AND t2.d2 \n  IF @@ROWCOUNT = 0 BREAK\nEND\n\n/***** RESULT *****/\nSELECT StartDate = MIN(d1) , EndDate = d2\nFROM @T\nGROUP BY d2\nORDER BY StartDate, EndDate\n\n/***** OUTPUT *****/\n/*****\nStartDate   EndDate\n2010-01-01  2010-06-13 \n2010-06-15  2010-08-16 \n2010-11-01  2010-12-31 \n*****/\n</code></pre>\n"},{"tags":["sql","increment"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13260813,"title":"Limitations on incrementing values (standard sql)","body":"<p>Given a table of students and grades, is there a way to increment each student's grade by 10%,  but without going over 100?</p>\n\n<p>Right now I do </p>\n\n<pre><code>UPDATE studentCourse\nSET grade = grade + 10 * (grade/100) \nWHERE csid = 1\n</code></pre>\n\n<p>In other words, if a student has 60, after the update he should have 66. But if a student has a 98, after the update his grade should be 100 (and not 108).</p>\n\n<p>All this has to be done in standard SQL</p>\n"},{"tags":["sql","visual-studio","encryption","ssdt"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":50,"score":5,"question_id":13256026,"title":"Stored procedure ENCRYPTION option depending on build mode","body":"<p>I'm working on stored procedures encryption in enterprise project. We have a bunch of SP's that should be protected on production.<br> \nThere is no problem to set <code>WITH ENCRYPTION</code> parameter in each SP that is in <code>sqlproj</code>. But I want to make this directive optional: if I'm building project in debug mode - do not apply this procedure option, otherwise - use it. Actually main goal here is to get database for developers without encryption, but on production - encrypted SP's. \n<br>Using <code>PowerShell</code> script in build task I can modify generated sql file and as a result get script with encryption parameter, but I'm wondering how it would work with <code>dacpac</code>.<br>\nAny suggestions? </p>\n"},{"tags":["mysql","sql","perl","relationship"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13259737,"title":"Perl/MySQL Relationship Query","body":"<p>I have the following perl code that will eventually be a webpage:</p>\n\n<pre><code>my($dbh) = DBI-&gt;connect(\"DBI:mysql:host=dbsrv;database=database\",\"my_sqlu\",\"my_sqlp\") or die \"Canny Connect\";\nmy($sql) = \"SELECT * FROM hardware where srv_name = \\\"$srv_name\\\"\";\nmy($sth) = $dbh-&gt;prepare($sql);\n$sth-&gt;execute();\n\n$sth-&gt;bind_col( 1, \\my($db_id));\n$sth-&gt;bind_col( 2, \\my($db_srv_name));\n$sth-&gt;bind_col( 5, \\my($db_site));\n$sth-&gt;fetchrow();\n$sth-&gt;finish ();\nmy($sql) = \"SELECT sites.\\`site_code\\`, sites.\\`long_name\\` FROM \\`hardware\\` JOIN \\`sites\\` ON \\`sites\\`.id=\\`hardware\\`.\\`site\\` where \\`hardware\\`.\\`id\\`=\\'$db_id\\'\";\nmy($sth) = $dbh-&gt;prepare($sql);\n$sth-&gt;execute();\n$sth-&gt;bind_col( 1, \\my($db_site_code));\n$sth-&gt;bind_col( 2, \\my($db_long_name));\n$sth-&gt;fetchrow();\n$sth-&gt;finish ();\n$dbh-&gt;disconnect;\nprint \"$db_site_code&lt;br&gt;$db_long_name\";\n</code></pre>\n\n<p>The query above does work however what I'm trying to find out is there any way I can run one SQL query and get the db_site_code and db_long_name from the sites DB without running the 2nd query? The hardware DB has the foreign key 'id' in the sites Db.</p>\n\n<p>When you read anything about relational DBs they all say it's by far the most efficient method of getting data from your database but I just can't see how this is any quicker than just running 2 select queries. What I've done above would surely take longer than <code>\"select from hardware where srv_name = $srv_name\"</code> then <code>\"select from sites where id = db_site_id\"</code>? Any comments are greatly appreciated.</p>\n"},{"tags":["mysql","sql","sharding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12997895,"title":"Sharding and ID generation as instagram","body":"<p>My question is regarding ID generation for sharded environment. I am following the same steps as <a href=\"http://instagram-engineering.tumblr.com/post/10853187575/sharding-ids-at-instagram\" rel=\"nofollow\">instagram did</a> for generating unique ids. I have a few question on the implementation of this id generation in MySQL.</p>\n\n<p>This is how the ID is being generated (This is a PGQL stored procedure.)</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION insta5.next_id(OUT result bigint) AS $$\nDECLARE\n    our_epoch bigint := 1314220021721;\n    seq_id bigint;\n    now_millis bigint;\n    shard_id int := 5;\nBEGIN\n    SELECT nextval('insta5.table_id_seq') %% 1024 INTO seq_id;\n\n    SELECT FLOOR(EXTRACT(EPOCH FROM clock_timestamp()) * 1000) INTO now_millis;\n    result := (now_millis - our_epoch) &lt;&lt; 23;\n    result := result | (shard_id &lt;&lt; 10);\n    result := result | (seq_id);\nEND;\n$$ LANGUAGE PLPGSQL;\n\n\n\nCREATE TABLE insta5.our_table (\n    \"id\" bigint NOT NULL DEFAULT insta5.next_id(),\n    ...rest of table schema...\n)\n</code></pre>\n\n<p><strong>MY question is</strong> how can I do that in MySQL (equivalent code).  This stored procedure should be called from a query to get the next id.</p>\n\n<p><strong>My other question</strong> is regarding querying the shards.  From what I understand they use logical shards that are maps to actual servers. If they decide to map a logical shard to a new server, this means that they have to query two servers at the same time to aggregate the results, because before they assigned a new server for the same logical shard, some data was added to the older server. I just wanted to know if there's a better way to use logical shards and having the option to query a single server where the data resides instead of querying all the servers that are and were belong to that logical shard?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","gaps-and-islands"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13260329,"title":"Break a single record into multiple","body":"<p>Usually this works the other way around, but I'd like to break single records into multiple records through SQL.</p>\n\n<p>We store a range of with a begin and end date, but are needing to export a record for each year in the range. </p>\n\n<p>Example: <code>TECH_ID</code> has a <code>begin_date</code> of 2009 and <code>end_date</code> of 2011. We need to export 3 records of 2009, 2010, and 2011.</p>\n\n<p>How can this be accomplished?</p>\n"},{"tags":["sql","postgresql","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13260218,"title":"Creating a Trigger To Delete Records","body":"<p>I have a table which we can call decks. Decks has an id used as its primary key along with some other attributes. The cards table contains a foreign key reference to the deck id and has a primary key of cardid as well. Another table exists called answers where its foreign key is the cardid. </p>\n\n<p>So in order to delete from decks, the database requires I delete from answers first, then cards, and then finally from decks. </p>\n\n<p>I would like to create a trigger which takes care of the first and second delete so that I only have to specify a delete statement from the decks table to completely destroy a deck.</p>\n\n<p>Below is an example PostgreSQL trigger I've found, but I am not sure if its even possible to do what I am asking as I can find no examples online of anyone creating a trigger this way.</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION autoCalculate() RETURNS TRIGGER AS $$\n        BEGIN\n\n        IF NEW.wins &lt; 0 THEN\n                RAISE EXCEPTION 'Wins cannot be negative';\n        END IF;\n\n        IF(OLD.wins &lt;&gt; NEW.wins_ OR (OLD.losses &lt;&gt; NEW.losses) THEN\n                NEW.Winning_Percentage := calc_winning_percentage(NEW.Wins, NEW.Losses);\n        END IF\n\n        RETURN NEW;\n        END;\n$$ LANGUAGE plpgsql;\n\nDROP TRIGGER update_winning_percentage ON standings;\nCREATE TRIGGER update_winning_percentage BEFORE INSERT OR UPDATE ON standings\nFOR EACH ROW EXECUTE PROCEDURE autoCalculate();\n</code></pre>\n\n<p>If anyone has knowledge to do this, if they could nudge me in the right direction or provide an example of how to do this I'd be grateful!</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13259913,"title":"Using Sum() with multiple where clauses","body":"<p>I'm pretty new to this, so forgive if this has been posted (I had no idea what to even search on).</p>\n\n<p>I have 2 tables, Accounts and Usage</p>\n\n<pre><code>AccountID  AccountStartDate  AccountEndDate\n-------------------------------------------\n1          12/1/2012         12/1/2013\n2          1/1/2013          1/1/2014\n\n\nUsageId   AccountID EstimatedUsage  StartDate  EndDate\n------------------------------------------------------\n1         1         10              1/1        1/31\n2         1         11              2/1        2/29\n3         1         23              3/1        3/31\n4         1         23              4/1        4/30\n5         1         15              5/1        5/31\n6         1         20              6/1        6/30\n7         1         15              7/1        7/31\n8         1         12              8/1        8/31\n9         1         14              9/1        9/30\n10        1         21             10/1        10/31\n11        1         27             11/1        11/30\n12        1         34             12/1        12/31\n13        2         13              1/1        1/31\n14        2         13              2/1        2/29\n15        2         28              3/1        3/31\n16        2         29              4/1        4/30\n17        2         31              5/1        5/31\n18        2         26              6/1        6/30\n19        2         43              7/1        7/31\n20        2         32              8/1        8/31\n21        2         18              9/1        9/30\n22        2         20             10/1        10/31\n23        2         47             11/1        11/30\n24        2         33             12/1        12/31\n</code></pre>\n\n<p>I'd like to write one query that gives me estimated usage for each month (starting now until the last month that we serve an account) for all accounts being served during that month.</p>\n\n<p>The results would be as follows:</p>\n\n<pre><code>Month-Year     Total Est Usage\n------------------------------\nOct-12            0  (none being served)\nNov-12            0  (none being served)\nDec-12           34  (only accountid 1 being served)\nJan-13           23  (accountid 1 &amp; 2 being served)\nFeb-13           24  (accountid 1 &amp; 2 being served)\nMar-13           51  (accountid 1 &amp; 2 being served)\n...\nDec-13           33  (only accountid 2 being served)\nJan-14           0   (none being served)\nFeb-14           0   (none being served)\n</code></pre>\n\n<p>I'm assuming I need to sum and then do a Group By...but not really sure logically how I'd lay this out.  </p>\n"},{"tags":["sql","query","razor","webmatrix"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12854901,"title":"how to add and divide results from sql queries","body":"<p>I have a database which I am trying to create a webpage summary widget for. I am using MS Webmatrix and razor.</p>\n\n<p>I have several select queries set as variables, then my html asks for their values as a string and displays them. So far so good.<br>\nNow I want to add two results together, then subtract a third. EG: add todays processed orders ( I called it itotl) and todays partly processed orders (ppr) and subtract todays credits (ctotl).<br>\nThus, i want (itotl + ppr) - ctotl.<br>\nIf I try and do this by entering the @itotl and @ppr variables etc in my html, it fails.<br>\nThere will be a simple, industry best practice way to do it but I'm only learning, and the hard way at that!</p>\n\n<p>Any Suggestions? I can paste the whole code in here if it will help.\nHere:<br>\n<code>@{<br>\n    Layout = \"~/_SiteLayout.cshtml\";<br>\n    Page.Title = \"SCOREBOARD\";<br>\n    var db = Database.Open(\"data\");<br>\n    var itot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and SUBTOTAL &gt;0\");<br>\n    var isum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.DR_TRANS where TRANSDATE = 41192 and Subtotal &gt;0\");<br>\n    var qsum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Subtotal &gt;0\");<br>\n    var ppr = db.QueryValue(\"select sum(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0 and status = 1\");<br>\n    var psum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Status =1\");<br>\n    var qtot = db.QueryValue(\"SELECT SUM(SUBTOTAL) FROM dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0\");<br>\n    var ctot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    var csum = db.QueryValue(\"SELECT COUNT(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    &lt;META HTTP-EQUIV=\"REFRESH\" CONTENT=\"15\"&gt;&lt;/META&gt;;<br>\n}</code>\n<code>&lt;!DOCTYPE html&gt;</code></p>\n\n<p><code>&lt;html lang=\"en\"&gt;</code>\n   <code>&lt;head&gt;<br>\n        &lt;meta charset=\"utf-8\" /&gt;<br>\n        &lt;title&gt;&lt;/title&gt;<br>\n        &lt;style&gt;<br>\n            .column1 {color: blue; font-weight: bold; font-size: 1.6em;}<br>\n            .column2 {color: red;}<br>\n        &lt;/style&gt;<br>\n    &lt;/head&gt;<br>\n    &lt;body&gt;<br>\n        &lt;p&gt;@qsum.ToString() Quotes:<br>\n            &lt;span class=@(qtot &gt; 20000 ? \"column1\" : \"column2\")&gt;@qtot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@psum.ToString() Partly Processed:<br>\n            &lt;span class=@(ppr &gt; 18000 ? \"column1\" : \"column2\")&gt;@ppr.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@isum.ToString() Invoices:<br>\n            &lt;span class=@(itot &gt; 18000 ? \"column1\" : \"column2\")&gt;@itot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@csum.ToString() Credits:<br>\n            &lt;span class=@(ctot &gt; 18000 ? \"column1\" : \"column2\")&gt;@ctot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;Nett Sales:&lt;/p&gt;<br>\n    &lt;/body&gt;<br>\n&lt;/html&gt;</code>  </p>\n\n<p>How do I get my markup to show tidily in stack? This has rendered a little hard to read!</p>\n"},{"tags":["php","sql","cookies","registration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13259966,"title":"Create a random, sequenced id based on cookie session?","body":"<p>I have a user sign up or registration form to allow guests to my site become registered members. The form consists of first name, last name, email etc, the action goes to process_reg.php on submit.</p>\n\n<p>The information is then inserted into an sql table 'ptb_registrations'. but it doesn't work yet because i am trying to randomly generate a new user id with the form from a cookie session. I'm not sure if what i'm doing is right. can people please correct me where I'm wrong or point me in the right direction. Thanks.</p>\n\n<p>here's my script for process_reg.php:</p>\n\n<pre><code>&lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\n?&gt;\n&lt;?php \n\nsession_start();\n\ninclude '_config/connection.php'; \n\n\nfunction get_user_id() {\n    global $connection;\n    global $email;\n    $query = \"SELECT *\n                FROM ptb_registrations\n                WHERE email = \\\"$email\\\"\n                \";\n        $user_id_set = mysql_query($query, $connection);\n        confirm_query($user_id_set);\n        return $user_id_set;\n        }\n?&gt;\n&lt;?php\n$user_id_set = get_user_id();\nwhile ($user_id = mysql_fetch_array($user_id_set)) {\n    $cookie1 = \"{$user_id[\"id\"]}\";\n    setcookie(\"ptb_registrations\", $cookie1, time()+3600);  /* expire in 1 hour */\n\n}\n?&gt;\n&lt;?\n\n$first_name = $_POST['first_name'];\n$last_name = $_POST['last_name'];\n$email = $_POST['email'];\n$display_name = $_POST['display_name'];\n$date_of_birth = $_POST['date_of_birth'];\n$contact_number = $_POST['contact_number'];\n$station = $_POST['station'];\n$hobbies = $_POST['hobbies'];\n$gender = $_POST['gender'];\n$password = $_POST['password'];\n\n\n\n\n\n\n\n\n$result = mysql_query(\"SELECT first_name FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT last_name FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT display_name FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT email FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT contact_number FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT date_of_birth FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT hobbies FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT station FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT gender FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT password FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n\n\n\n\n\n\nif(!$result) \n{ \necho \"The username you entered does not exist\"; \n} \nelse \nif($email!= mysql_result($result, 0)) \n{ \necho \"\"; \n\n\n    $sql=mysql_query(\"INSERT ptb_registrations SET first_name='$first_name' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET last_name='$last_name' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET display_name='$display_name' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET email='$email' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET contact_number='$contact_number' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET date_of_birth='$date_of_birth' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET hobbies='$hobbies' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET station='$station' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET gender='$gender' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET password='$password' WHERE id=\".$cookie1['user_id'].\"\"); \n\n\n}\n    if($sql) \n    { \n    echo \"&lt;div class=\\\"infobox-profile\\\"&gt; &lt;strong&gt;Thank You&lt;/strong&gt; - We have received your registration details.&lt;/div&gt;\"; \n    }\nelse\n{ \necho \"&lt;div class=\\\"infobox-profile\\\"&gt; &lt;strong&gt;Oooops!&lt;/strong&gt; - Something went wrong. &lt;a href=\\\"../edit_contact_number.php\\\"&gt;Click here&lt;/a&gt; to try again.&lt;/div&gt;\"; \n}  \n?&gt;\n&lt;? ob_flush(); ?&gt;\n\n&lt;style&gt;\n.infobox-profile {\n    background-color: #e1e0f7;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 14px;\n    color: #181469;\n    padding-top: 20px;\n    padding-right: 10px;\n    padding-bottom: 20px;\n    padding-left: 70px;\n    margin-bottom: 20px;\n    background-image: url(../img/icons/info-icon.png);\n    background-repeat: no-repeat;\n    background-position: 15px center;\n    border-top-width: 1px;\n    border-top-style: solid;\n    border-top-color: #8f8fdb;\n    border-right-width: 1px;\n    border-bottom-width: 1px;\n    border-left-width: 1px;\n    border-right-style: solid;\n    border-bottom-style: solid;\n    border-left-style: solid;\n    border-right-color: #8f8fdb;\n    border-bottom-color: #8f8fdb;\n    border-left-color: #8f8fdb;\n    border-radius: 4px;\n    width: 385px;\n    margin-left:8px;\n}\n&lt;/style&gt;\n</code></pre>\n"},{"tags":["python","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13254268,"title":"Split column defintions of SQL create table query","body":"<p>I want to split all column definitions of a sql query into seperate strings. </p>\n\n<p>So:</p>\n\n<pre><code> `citizen_group` int(10) NOT NULL,\n  `container_group` int(10) NOT NULL,\n  PRIMARY KEY (`citizen_group`,`container_group`),\n  KEY `fk_containergroup_readeraccess` (`container_group`)\n</code></pre>\n\n<p>Into:</p>\n\n<pre><code>['`citizen_group` int(10) NOT NULL', '`container_group` int(10) NOT NULL','PRIMARY KEY (`citizen_group`,`container_group`)',' KEY `fk_containergroup_readeraccess` (`container_group`)']\n</code></pre>\n\n<p>First I used <code>split(',')</code>. But this gives a problem when the sql has a multicolumn primary key. I cannot expect that each definition is on a new line, so I can't split on newlines. </p>\n\n<p>How can I split these column definitions?</p>\n"},{"tags":["mysql","sql","triggers","cascade"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13259887,"title":"trigger called on cascade : MYSQL","body":"<p>I have one table in my db that is called products. Another table is called cart and another one is called user. cart is the bridge table that connects the table user with the table products. </p>\n\n<p>Now, I have specified all the foreign keys with the option CASCADE, so that if I delete one product it will be deleted also from the table cart.</p>\n\n<p>In the user table I have one attribute that is called ProductsInTheCart that counts the number of products in the cart immediately, without having to do a query every time. When I insert a new tuple in the table cart this number will increase. (and this is ok) This works also if I delete one tuple from the table cart.</p>\n\n<p>Instead, the problem is that if I delete one tuple from the table products, the tuples in tha table cart with the same key will be deleted but the attribute in the table users doesn't change. \nMaybe because the elimination of one tuple of the table cart is a consequence of the cascade?</p>\n\n<p>How Can I DO?\nthanks!</p>\n\n<p>this is the trigger:</p>\n\n<pre><code>CREATE\nDEFINER=`root`@`localhost`\nTRIGGER `m4af`.`DecrementaProdottiNelCarrello`\nAFTER DELETE ON `m4af`.`carrello`\nFOR EACH ROW\nupdate utente as U, prodotto as P\nset U.ProdottiNelCarrello = U.ProdottiNelCarrello - 1,\nP.NelCarrelloDi=P.NelCarrelloDi-1\nwhere U.username = OLD.Username AND P.barcode=OLD.Barcode$$\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13258893,"title":"MySql - Joining another table with multiple rows, inserting a query into a another query?","body":"<p>I've been racking my brain for hours trying work out how to join these two queries..</p>\n\n<p>My goal is to return multiple venue rows (from venues) based on certain criteria... which is what my current query does....</p>\n\n<pre><code>SELECT venues.id AS ven_id, \n   venues.venue_name, \n   venues.sub_category_id, \n   venues.score, \n   venues.lat, \n   venues.lng, \n   venues.short_description, \n   sub_categories.id, \n   sub_categories.sub_cat_name, \n   sub_categories.category_id, \n   categories.id, \n   categories.category_name, \n   ((ACOS(  SIN(51.44*PI()/180)*SIN(lat*PI()/180) + COS(51.44*PI()/180)*COS(lat*PI()/180)*COS((-2.60796 - lng)*PI()/180)) * 180/PI())*60 * 1.1515) AS dist\n\nFROM venues, \n  sub_categories, \n  categories \nWHERE \n  venues.sub_category_id = sub_categories.id \n  AND sub_categories.category_id = categories.id \nHAVING \n  dist &lt; 5 \nORDER BY score DESC \nLIMIT 0, 100\n</code></pre>\n\n<p>However, I need to include another field in this query (thumbnail), which comes from another table (venue_images). The idea is to extract one image row based on which venue it's related to and it's order. Only one image needs to be extracted however. So LIMIT 1.</p>\n\n<p>I basically need to insert this query:</p>\n\n<pre><code>SELECT \n  venue_images.thumb_image_filename, \n  venue_images.image_venue_id,  \n  venue_images.image_order \nFROM venue_images \nWHERE venue_images.image_venue_id = ven_id //id from above query\nORDER BY venue_images.image_order \nLIMIT 1\n</code></pre>\n\n<p>Into my first query, and label this new field as \"thumbnail\".</p>\n\n<p>Any help would really be appreciated. Thanks!</p>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13259028,"title":"SQL Server bulk insert - \"Bulk load data conversion error\"","body":"<pre><code>bulk insert dbo.A\nFROM 'd:\\AData.csv'\nWITH \n(\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\n</code></pre>\n\n<p>Inserting bulk data into a database, I approached an unexplainable error after review of the suspect data:</p>\n\n<blockquote>\n  <p><em>Msg 4867, Level 16, State 1, Line 6</em><br>\n  <em>Bulk load data conversion error (overflow) for row 1, column 42 (FES).</em></p>\n</blockquote>\n\n<p>Column FES was <code>tinyint</code>, now <code>smallint</code>. <code>d:\\AData.csv</code> contains a <code>2</code> in row 1, column 42. Are there any other sources for this type of error?</p>\n\n<p>---APPEND---</p>\n\n<p>I'm not sure how to properly post this. </p>\n\n<p>Create Table Script </p>\n\n<pre><code>create table AcsBy320082010Hus(\nserialnoId bigint,\nRT char,\nDIVISION tinyint,\nPUMA int,\nREGION tinyint,\nST tinyint,\nADJHSG int,\nADJINC int,\nWGTP int,\nNP tinyint,\nTYPE tinyint,\nACR tinyint,\nAGS tinyint,\nBDS tinyint,\nBLD tinyint,\nBUS tinyint,\nCONP smallint,\nELEP smallint,\nFS smallint,\nFULP int,\nGASP int,\nHFL tinyint,\nINSP varchar(6),\nKIT tinyint,\nMHP int,\nMRGI tinyint,\nMRGP int,\nMRGT tinyint,\nMRGX tinyint,\nPLM tinyint,\nRMS tinyint,\nRNTM tinyint,\nRNTP int,\nSMP int,\nTEL tinyint,\nTEN tinyint,\nVACS tinyint,\nVAL tinyint,\nVEH tinyint,\nWATP int,\nYBL tinyint,\nFES tinyint,\nFINCP int,\nFPARC tinyint,\nGRNTP int,\nGRPIP tinyint,\nHHL tinyint,\nHHT tinyint,\nHINCP int,\nHUGCL bit,\nHUPAC tinyint,\nHUPAOC tinyint,\nHUPARC tinyint,\nLNGI tinyint,\nMV tinyint,\nNOC tinyint,\nNPF tinyint,\nNPP bit,\nNR bit,\nNRC tinyint,\nOCPIP tinyint,\nPARTNER tinyint,\nPSF bit,\nR18 bit,\nR60 tinyint,\nR65 tinyint,\nRESMODE tinyint,\nSMOCP int,\nSMX tinyint,\nSRNT bit,\nSVAL bit,\nTAXP tinyint,\nWIF tinyint,\nWKEXREL tinyint,\nWORKSTAT tinyint,\nFACRP bit,\nFAGSP bit,\nFBDSP bit,\nFBLDP bit,\nFBUSP bit,\nFCONP bit,\nFELEP bit,\nFFSP bit,\nFFULP bit,\nFGASP bit,\nFHFLP bit,\nFINSP bit,\nFKITP bit,\nFMHP bit,\nFMRGIP bit,\nFMRGP bit,\nFMRGTP bit,\nFMRGXP bit,\nFMVYP bit,\nFPLMP bit,\nFRMSP bit,\nFRNTMP bit,\nFRNTP bit,\nFSMP bit,\nFSMXHP bit,\nFSMXSP bit,\nFTAXP bit,\nFTELP bit,\nFTENP bit,\nFVACSP bit,\nFVALP bit,\nFVEHP bit,\nFWATP bit,\nFYBLP bit,\nWGTP1 int,\nWGTP2 int,\nWGTP3 int,\nWGTP4 int,\nWGTP5 int,\nWGTP6 int,\nWGTP7 int,\nWGTP8 int,\nWGTP9 int,\nWGTP10 int,\nWGTP11 int,\nWGTP12 int,\nWGTP13 int,\nWGTP14 int,\nWGTP15 int,\nWGTP16 int,\nWGTP17 int,\nWGTP18 int,\nWGTP19 int,\nWGTP20 int,\nWGTP21 int,\nWGTP22 int,\nWGTP23 int,\nWGTP24 int,\nWGTP25 int,\nWGTP26 int,\nWGTP27 int,\nWGTP28 int,\nWGTP29 int,\nWGTP30 int,\nWGTP31 int,\nWGTP32 int,\nWGTP33 int,\nWGTP34 int,\nWGTP35 int,\nWGTP36 int,\nWGTP37 int,\nWGTP38 int,\nWGTP39 int,\nWGTP40 int,\nWGTP41 int,\nWGTP42 int,\nWGTP43 int,\nWGTP44 int,\nWGTP45 int,\nWGTP46 int,\nWGTP47 int,\nWGTP48 int,\nWGTP49 int,\nWGTP50 int,\nWGTP51 int,\nWGTP52 int,\nWGTP53 int,\nWGTP54 int,\nWGTP55 int,\nWGTP56 int,\nWGTP57 int,\nWGTP58 int,\nWGTP59 int,\nWGTP60 int,\nWGTP61 int,\nWGTP62 int,\nWGTP63 int,\nWGTP64 int,\nWGTP65 int,\nWGTP66 int,\nWGTP67 int,\nWGTP68 int,\nWGTP69 int,\nWGTP70 int,\nWGTP71 int,\nWGTP72 int,\nWGTP73 int,\nWGTP74 int,\nWGTP75 int,\nWGTP76 int,\nWGTP77 int,\nWGTP78 int,\nWGTP79 int,\nWGTP80 int)\n</code></pre>\n\n<p>Headers row </p>\n\n<blockquote>\n  <p>serialno,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BATH,BDSP,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,MHP,MRGI,MRGP,MRGT,MRGX,REFR,RMSP,RNTM,RNTP,RWAT,SINK,SMP,STOV,TEL,TEN,TOIL,VACS,VALP,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,KIT,LNGI,MULTG,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PLM,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBATHP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP,FMVP,FPLMP,FREFRP,FRMSP,FRNTMP,FRNTP,FRWATP,FSINKP,FSMP,FSMXHP,FSMXSP,FSTOVP,FTAXP,FTELP,FTENP,FTOILP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80</p>\n</blockquote>\n\n<p>Row 1</p>\n\n<blockquote>\n  <p>2008000000023,H,6,01300,3,01,1012650,1031272,00043,04,1,1,,1,02,02,2,0000,150,2,0002,020,3,00150,,2,00980,1,1,1,03,,,1,1,,1,1,1,1,,0210000,2,0080,09,2,000058100,2,,,4,1,000058100,0,3,3,3,1,1,1,3,02,04,0,0,02,024,0,1,0,1,0,0,1,01170,3,0,1,19,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,00112,00045,00068,00017,00044,00091,00071,00032,00036,00042,00048,00041,00013,00031,00063,00013,00037,00017,00063,00098,00026,00036,00017,00065,00036,00020,00014,00035,00037,00046,00047,00048,00080,00034,00012,00061,00031,00069,00043,00060,00011,00050,00016,00057,00050,00013,00016,00068,00056,00039,00042,00049,00081,00041,00012,00092,00050,00055,00049,00016,00062,00041,00103,00012,00048,00060,00073,00052,00063,00038,00047,00040,00017,00040,00059,00020,00042,00010,00038,00018</p>\n</blockquote>\n\n<p><a href=\"http://www.census.gov/acs/www/Downloads/data_documentation/pums/DataDict/PUMS_Data_Dictionary_2008-2010.pdf\" rel=\"nofollow\">Link to ACS 2008-2010 Data Dictionary</a></p>\n"},{"tags":["c#","sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13257925,"title":"Update the dataset after rows changed","body":"<p>Scenario:</p>\n\n<ol>\n<li>Excel file is read and displayed in datagrid.</li>\n<li>Values in sql server must be updated  if excel values are different.</li>\n<li>Table in Sql server don't have primary key</li>\n</ol>\n\n<p>After all these steps, when I am about to update the table, it throws the error saying \"Update requires a valid UpdateCommand when passed DataRow collection with modified rows.\" </p>\n\n<p>There is no primary key. So I need to use update command. BUt how and what would be in update command? importdata is dictionary where data from excel are stored. PLz help!!! What should I do now? I have No idea....</p>\n\n<pre><code>foreach (DataColumn column in ds.Tables[0].Columns)\n{\n    string fieldName = column.ColumnName;\n    string fieldNameValueE = string.Empty;\n    if (importdata.ContainsKey(fieldName))\n    {\n        fieldNameValueE = importdata[fieldName];\n        foreach (DataRow dr in ds.Tables[0].Rows)\n        {\n            string fieldNameValueD = dr[fieldName].ToString();\n            if (fieldNameValueD != fieldNameValueE)\n            {\n                dr[fieldName] = fieldNameValueE;\n\n            }\n        }\n\n    }\n\n}\n\nda.Update(ds);\nconnection.Close();    \n</code></pre>\n"},{"tags":["sql","vba","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13259730,"title":"Execute VBA using SQL","body":"<p>Ok, this may be a long shot but in MS Access, is it possible to execute VBA using SQL? I'm looking to write a query that runs either a single VBA statement or a Sub. Basically, what I'm trying to do is modify the hidden attribute of a table using SQL.</p>\n\n<p>MS makes enough weird decisions with Office implementations that I'm mildly hopeful this is one of those cases.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13259576,"title":"PHP saving mysql info to php variables","body":"<p>So, what i'm trying to do is that I want this to happen basically, here's my code:</p>\n\n<p>mysql_query(\"SELECT account.id FROM account WHERE account.username= \"\"\");</p>\n\n<p>I want the result of that code stored in a variable named account_id in PHP. But I wasn't able to find anything online that I was able to understand.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13258932,"title":"Query giving undesirable results","body":"<p>I have the following two tables:</p>\n\n<pre><code>lab_assistant\nla_id - la_firstname - la_lastname\n1 - Dennis - Rodman\n2 - Michael - Jordan\n3 - Horace - Grant\n\nhours_worked\nhw_semester - hw_date - hw_hours - la_id\nFall 2012 - 2012-11-01 - 4 - 2\nFall 2012 - 2012-11-04 - 5 - 3\nSpring 2012 - 2012-02-12 - 4 - 1\nSpring 2012 -2012-03-10 - 4 - 1\n</code></pre>\n\n<p>The result of my query is supposed to look like the following:</p>\n\n<p>and I'm trying to run the following query in order to list the Lab Assistant and the number of hours they worked each semester</p>\n\n<pre><code>SELECT DISTINCT(CONCAT(la.la_firstname, ' ', la.la_lastname)) AS 'Lab Assistant',\n   hw.hw_semester AS 'Semester Worked', hw.hw_hours AS 'Hours Worked'\nFROM lab_assistant la\n    JOIN hours_worked hw\n        ON la.la_id = hw.la_id;\n</code></pre>\n\n<p>The results of my quere are SUPPOSED to look like this:</p>\n\n<pre><code>Michael Jordan - Fall 2012 - 4\nHorace Grant - Spring 2012 - 5\nDennis Rodman - Fall 2012 - 8\n</code></pre>\n\n<p>BUT the results I'm getting are as follows:</p>\n\n<pre><code>Michael Jordan - Fall 2012 - 4\nHorace Grant - Fall 2012 - 5\nDennis Rodman - Spring 2012 - 4\n</code></pre>\n\n<p>So basically, it just isn't counting the proper hours for Dennis Rodman. It should be 8 and not 4.</p>\n\n<p>And I probably shouldn't use DISTINCT here because it's possible the same person could work different semesters.</p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13254141,"title":"How do I use DateTime from one result set as start and end date for another query?","body":"<p>OK, I have product with serial numbers running through a production line. I read and store times when these serial number are read at different locations. </p>\n\n<p>I can query this data and get:</p>\n\n<pre><code>Tagname - Barcode reader identifier.\nDateTime - DateTime of read.\nValue - Serial Number.\n</code></pre>\n\n<p>I need to look at the process values of a tool from the time that the reader reads a specific Serial Number before the tool and the time it reads that same serial number after the tool. I would like to average, min/max, etc. the values but I haven't figured out how to use the DateTime of the barcode reads to act as the StartDate and EndDate of the process values query.</p>\n\n<p>Any help would be very much appreciated.</p>\n\n<p>Process Query:</p>\n\n<pre><code>SET NOCOUNT ON\nDECLARE @StartDate DateTime\nDECLARE @EndDate DateTime\nSET @StartDate = '20121106 08:48:26.000'\nSET @EndDate = '20121106 08:53:26.000'\nSET NOCOUNT OFF\nSELECT  * \nFROM (SELECT History.TagName, DateTime, Value, vValue, StartDateTime\n      FROM History\n      WHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\n      AND wwRetrievalMode = 'Average'\n      AND wwCycleCount = 10\n      AND wwVersion = 'Latest'\n      AND DateTime &gt;= @StartDate\n      AND DateTime &lt;= @EndDate) temp \nWHERE temp.StartDateTime &gt;= @StartDate\n</code></pre>\n\n<p>I want to get the data based on barcode reads before and after the tool. I tried some things like:</p>\n\n<pre><code>SELECT History.TagName, DateTime, Value\nFROM History\nWHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\nAND DateTime &gt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber',\n                                           'MES_110A.PVD1101R_In_SerialNumber' )\n                 AND Value = '100056134')\nAND DateTime &lt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110B.SCR1101_SerialNumber',\n                                           'MES_110B.SCR1102_SerialNumber')\n                 AND Value = '100056134')\n</code></pre>\n\n<p>OK, I made some changes. Now I have:</p>\n\n<pre><code>    SET NOCOUNT ON\n    DECLARE @StartDate DateTime\n    DECLARE @EndDate DateTime\n    SET @StartDate = (SELECT DateTime\n                              FROM History\n                              WHERE History.TagName IN  ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n                              AND Value = '100056130'\n                              AND DateTime &gt;= '20121106 05:39:48.000'\n                              AND DateTime &lt;= '20121106 23:39:48.000')\n    SET @EndDate = (SELECT DateTime\n                           FROM History\n                           WHERE TagName IN ('MES_110B.SCR1101_In_SerialNumber', 'MES_110B.SCR1102_In_SerialNumber' )\n                           AND Value = '100056130'\n                           AND DateTime &gt;= '20121106 05:39:48.000'\n                           AND DateTime &lt;= '20121106 23:39:48.000')\n    SET NOCOUNT OFF\n\n    SELECT TagName, AVG (Value) AS \"Average\"\n     FROM History\n     WHERE History.TagName IN  ('PVD1101_01.CHU1_Return_Water_Pressure', 'PVD1101_01.CHU1_Return_Water_Temp', 'PVD1101_01.5CT11_IN_Supply_Temp', 'PVD1101_01.5CT11_Out_Return_Temp')\n     AND DateTime &gt;= @StartDate\n     AND DateTime &lt;= @EndDate\n    GROUP BY TagName\n</code></pre>\n\n<p>This returns the values I am looking for. I will make the serial number value a parameter for the reports and it should work. Does this look totally convoluted and inefficient?</p>\n\n<p>I do need one more thing. This subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n</code></pre>\n\n<p>Returns Null. This Subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n     AND DateTime &gt;= '20121106 05:39:48.000'\n     AND DateTime &lt;= '20121106 23:39:48.000'\n</code></pre>\n\n<p>Returns a value. Why?</p>\n"},{"tags":["sql","google","schema","google-docs","database-schema"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1033,"score":6,"question_id":2518277,"title":"Online Collaborative Schema Design (leverage google docs?)","body":"<p>I'm looking for an online, collaborative database schema designer.  App is for MySQL specifically, but generic DB designer is fine too.\nIt's important that it can handle revisions (history of changes).</p>\n\n<p>This looks cool, and I could host it on a server - but doesn't look like it would handle multi-user:\n<a href=\"http://ondras.zarovi.cz/sql/demo/\">http://ondras.zarovi.cz/sql/demo/</a></p>\n\n<p>Currently we're doing a lot of design collaboration on google docs/spreadsheets.  Has anyone had any success using google spreadsheet for schema design?  Even if there were just a gadget for drawing lines/connections, I might give Google Docs a shot.</p>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13258801,"title":"Pulling Data in PHP from SQL Server","body":"<p>I have an issue with my script somewhere but do not know exactly where it is incorrect.  Here is the code:</p>\n\n<pre><code>&lt;title&gt;Log&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;h1&gt; Log &lt;/h1&gt;\n\n&lt;form method=\"get\" action=\"getlog.php\"&gt; \n\n&lt;table width=\"300\" border=\"0\"&gt;\n  &lt;tr&gt;\n    &lt;td&gt; Forte ID:&lt;/td&gt;\n    &lt;td&gt;&lt;select id=\"ForteID\" name=\"ForteID\"&gt;                    \n                    &lt;option value=\"nc4682\"&gt;nc4682&lt;/option&gt;\n                    &lt;option value=\"bs1441\"&gt;bs1441&lt;/option&gt;\n                    &lt;option value=\"sp3212\"&gt;sp3212&lt;/option&gt;                 \n        &lt;/select&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n\n &lt;input type=\"submit\" name=\"getLog\" value=\"Get Log\"&gt;\n &lt;/form&gt; \n\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&lt;?php\n/*print_r($_POST);*/\n$serverName = 'SRB-Nick_Desktop\\SQLEXPRESS';\n$connectionInfo = array('Database'=&gt;'cslogs', 'UID'=&gt;'cslogslogin', 'PWD'=&gt;'123456');\n$connection = sqlsrv_connect($serverName, $connectionInfo);\n\n$query = 'SELECT    ForteID, Disposition, appNumber, Finance_Num, Num_Payments, ACH_CC,     Notes from logs';\n\n$result = sqlsrv_query($connection,$query);\n\nif (!$result) \n{\n    $message = 'ERROR: ' . sqlsrv_errors();\n    return $message;\n}\nelse\n{\n    $i = 0;\n    echo '&lt;html&gt;&lt;body&gt;&lt;table&gt;&lt;tr&gt;';\n    while ($i &lt; sqlsrv_num_rows($result))\n    {\n        $meta = sqlsrv_fetch($result, $i);\n        echo '&lt;td&gt;' . $meta-&gt;name . '&lt;/td&gt;';\n        $i = $i + 1;\n    }\n    echo '&lt;/tr&gt;';\n\n    while ( ($row = sqlsrv_fetch_array($result))) \n    {\n        $count = count($row);\n        $y = 0;\n        echo '&lt;tr&gt;';\n        while ($y &lt; $count)\n        {\n        $c_row = current($row);\n        echo '&lt;td&gt;' . $c_row . '&lt;/td&gt;';\n        next($row);\n        $y = $y + 1;\n    }\n    echo '&lt;/tr&gt;';\n}\nsqlsrv_free_stmt ($result);\n\necho '&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;';\n}\nsqlsrv_close( $connection);\n?&gt;\n</code></pre>\n\n<p>And this is what I get in result, no matter what is selected in the drop down box and hit the button get log.</p>\n\n<p>nc4682  nc4682  Save    Save    asdf    asdf    fdas    fdas    1   1   cc  cc  asdf    asdf\nbs1441  bs1441  LOC LOC AN00336862  AN00336862  None    None    0   0   ach ach Backout Backout\nnc4682  nc4682  Save    Save    AN00336862  AN00336862  easdf   easdf   2   2   ach ach asdf    asdf\nsp3212  sp3212  Sale    Sale    NCXXXXXX1   NCXXXXXX1   none    none    1   1   cc  cc  asdfasdfasdf    asdfasdfasdf</p>\n\n<p>Each column is duplicated.  There are supposed to be 7 columns.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13258759,"title":"Update a DateTimes's Time, but not the date","body":"<pre><code>MyTable:\n id     int\n Date1  DateTime\n Date2  DateTime\n</code></pre>\n\n<p>How can I set the time of Date2 to be the same as Date1 without affecting the date of Date2?</p>\n"},{"tags":["sql","database","null","nullable"],"answer_count":6,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":4180,"score":6,"question_id":1833949,"title":"why is null not equal to null false","body":"<p>I was reading this article:\n<a href=\"http://stackoverflow.com/questions/191640/get-null-null-in-sql\">http://stackoverflow.com/questions/191640/get-null-null-in-sql</a></p>\n\n<p>And the consensus is that when trying to test equality between two (nullable) sql columns, the right approach is:</p>\n\n<pre><code>where ((A=B) OR (A IS NULL AND B IS NULL))\n</code></pre>\n\n<p>When A and B are NULL, (A=B) still returns FALSE, since NULL is not equal to NULL. That is why the extra check is required.</p>\n\n<p>What about when testing inequalities? Following from the above discussion, it made me think that to test inequality I would need to do something like:</p>\n\n<pre><code>WHERE ((A &lt;&gt; B) OR (A IS NOT NULL AND B IS NULL) OR (A IS NULL AND B IS NOT NULL))\n</code></pre>\n\n<p>However, I noticed that that is not necessary (at least not on informix 11.5), and I can just do:</p>\n\n<pre><code>where (A&lt;&gt;B)\n</code></pre>\n\n<p>If A and B are NULL, this returns FALSE. If NULL is not equal to NULL, then shouldn't this return TRUE?</p>\n\n<p><strong>EDIT</strong><br>\nThese are all good answers, but I think my question was a little vague. Allow me to rephrase:</p>\n\n<p>Given that either A or B can be NULL, is it enough to check their inequality with</p>\n\n<pre><code>where (A&lt;&gt;B)\n</code></pre>\n\n<p>Or do I need to explicitly check it like this:</p>\n\n<pre><code>WHERE ((A &lt;&gt; B) OR (A IS NOT NULL AND B IS NULL) OR (A IS NULL AND B IS NOT NULL))\n</code></pre>\n\n<p>REFER to this <a href=\"http://stackoverflow.com/questions/1835546/testing-inequality-with-columns-that-can-be-null\">thread</a> for the answer to this question.</p>\n"},{"tags":["php","sql","user","expire"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13258951,"title":"redirect to page if expiration date = today's date?","body":"<p>I have a site with users on. Each users account has an expiration date in mysql table 'subscription_expires'.</p>\n\n<p>Is there a way to redirect a user to another page other than dashboard.php if their profile or the 'subscription_expires' is = to todays date after an attempt of login in which says their profile has expired. </p>\n\n<p>I've tried to have a go by using 'sub_expires' etc but no luck it still logs the user in if their profile is expired. </p>\n\n<p>here's my login script:</p>\n\n<pre><code>&lt;?php\n\n    if (logged_in()) {\n        redirect_to(\"dashboard.php\");\n    }\n\n    include_once(\"includes/form_functions.php\");\n\n    // START FORM PROCESSING\n    if (isset($_POST['submit'])) { // Form has been submitted.\n        $errors = array();\n\n        // perform validations on the form data\n        $required_fields = array('email', 'password');\n        $errors = array_merge($errors, check_required_fields($required_fields, $_POST));\n\n        $fields_with_lengths = array('email' =&gt; 30, 'password' =&gt; 30);\n        $errors = array_merge($errors, check_max_field_lengths($fields_with_lengths, $_POST));\n\n        $email = trim(mysql_prep($_POST['email']));\n        $password = trim(mysql_prep($_POST['password']));\n        $hashed_password = md5($password);\n\n        if ( empty($errors) ) {\n            // Check database to see if email and the hashed password exist there.\n            $query = \"SELECT id, email, close_account \";\n            $query .= \"FROM ptb_users \";\n            $query .= \"WHERE email = '{$email}' \";\n            $query .= \"AND password = '{$hashed_password}' \";\n            $query .= \"AND close_account = '0' \";\n            $query .= \"LIMIT 1\";\n            $result_set = mysql_query($query);\n            confirm_query($result_set);\n            if (mysql_num_rows($result_set) == 1) {\n                // email/password authenticated\n                // and only 1 match\n                $found_user = mysql_fetch_array($result_set);\n                $_SESSION['user_id'] = $found_user['id'];\n                $_SESSION['email'] = $found_user['email'];\n                $_SESSION['sub_expires'] = $found_user['subscription_expires'];\n\n                $result = mysql_query(\"UPDATE ptb_users SET user_online='Online' WHERE id=\".$_SESSION['user_id'].\"\") \nor die(mysql_error());\n\n\n                redirect_to(\"dashboard.php\");\n            } else {\n                // email/password combo was not found in the database\n                $message = \"&lt;div class=\\\"infobox\\\"&gt;&lt;strong&gt;Email/Password combination incorrect.&lt;/strong&gt;&lt;br /&gt;\n                    Please make sure your caps lock key is off and try again.&lt;/div&gt;\";\n            }\n\n                } else {\n            if (count($errors) == 1) {\n                $message = \"&lt;div class=\\\"infobox\\\"&gt;There was 1 error in the form.&lt;div&gt;\";\n\n\n            } else {\n                $message = \"&lt;div class=\\\"infobox\\\"&gt;There were \" . count($errors) . \" errors in the form.&lt;div&gt;\";\n            }\n        }\n\n\n    } else { // Form has not been submitted.\n        if (isset($_GET['logout']) &amp;&amp; $_GET['logout'] == 1) {\n            $message = \"&lt;div class=\\\"infobox\\\"&gt;You are now logged out.&lt;/div&gt;\";\n        } \n        $email = \"\";\n        $password = \"\";\n    }\n?&gt;\n            &lt;?php if (!empty($message)) {echo \"&lt;p class=\\\"message\\\"&gt;\" . $message . \"&lt;/p&gt;\";} ?&gt;\n            &lt;?php if (!empty($errors)) { display_errors($errors); } ?&gt;\n            &lt;form action=\"login.php\" method=\"post\"&gt;\n\nEmail&lt;br /&gt;\n&lt;input name=\"email\" type=\"text\" value=\"&lt;?php echo htmlentities($email); ?&gt;\" size=\"40\" maxlength=\"50\" /&gt;\n\n  &lt;br /&gt;\n  &lt;br /&gt;\n  Password&lt;br /&gt;\n  &lt;input name=\"password\" type=\"password\" value=\"&lt;?php echo htmlentities($password); ?&gt;\" size=\"40\" maxlength=\"30\" /&gt;\n\n  &lt;br /&gt;\n  &lt;br /&gt;\n&lt;input type=\"submit\" name=\"submit\" value=\"Login\" /&gt;\n\n\n            &lt;/form&gt;\n</code></pre>\n"},{"tags":["sql","stored-procedures","if-statement","null"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12932065,"title":"SQL: @somevalue = null is not working properly","body":"<p>I tried @somevalue = null and it worked that time. But now its not working. How to check if the value is null?\nIn brief what I need to do is if @existPerson is equal to null then INSERT the values into the database. But if it exists then return -2. I have checked in the database made sure that there are no same value as @nic = 100. Even so its returning me -2. What could be the possible reason ?  Thanks a lot!</p>\n\n<pre><code>CREATE PROCEDURE [dbo].[addStudent] \n    @stuName varchar(50), \n    @address varchar(100),\n    @tel varchar(15),\n    @etel varchar(15),\n    @nic varchar (10),\n    @dob date\n\n\nAS \nBEGIN   \n    SET NOCOUNT ON;\n\n    DECLARE @currentID INT\n    DECLARE @existPerson INT\n    SET @existPerson = (SELECT p_ID FROM Student WHERE s_NIC = @nic);\n    IF @existPerson = null\n        BEGIN\n            INSERT INTO Person (p_Name, p_RegDate, p_Address, p_Tel, p_EmergeNo, p_Valid, p_Userlevel)\n            VALUES (@stuName,  GETDATE(), @address, @tel, @etel, 0, 'Student' );\n            SET @currentID = (SELECT MAX( p_ID) FROM Person); \n            INSERT INTO Student (p_ID, s_Barcode, s_DOB, s_NIC) VALUES (@currentID , NULL, @dob, @nic);\n            return 0;\n        END\n    ELSE\n        return -2;\nEND \n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13258021,"title":"distinct condition in case statement","body":"<p>I have a SQL that returns a cnt1 and cnt2 for each Event_ID, while testing a condition for column \"POSA\" </p>\n\n<p>this returns the following as desired:</p>\n\n<p>Event_ID | CNT1 | CNT2</p>\n\n<p>I would like to add another condition to each CASE statement that tests if another column \"S\" in the same table is distinct.  Below is the code snippet:</p>\n\n<pre><code>SELECT Event_ID, \n sum  \n (CASE WHEN POSA IN ('SX', 'DX')  THEN 1 \n    ELSE 0 \n END) \n AS cnt1,\nsum \n(CASE  \n    WHEN POSA IN ('SP', 'DP')  THEN 1 \n    ELSE 0 \n END) AS cnt2\n\n\nFROM Station_Processed_Info GROUP BY EVENT_ID;\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13258442,"title":"SELECT DISTINCT HAVING Count unique conditions","body":"<p>I've searched for an answer on this but can't find quite how to get this distinct recordset based on a condition.  I have a table with the following sample data:</p>\n\n<pre><code>Type    Color   Location    Supplier\n----    -----   --------    --------\nApple   Green   New York    ABC\nApple   Green   New York    XYZ\nApple   Green   Los Angeles ABC\nApple   Red     Chicago     ABC\nApple   Red     Chicago     XYZ\nApple   Red     Chicago     DEF\nBanana  Yellow  Miami       ABC\nBanana  Yellow  Miami       DEF\nBanana  Yellow  Miami       XYZ\nBanana  Yellow  Atlanta     ABC\n</code></pre>\n\n<p>I'd like to create a query that shows the count of unique locations for each distinct Type+Color where the number of unique locations is more than 1, e.g.</p>\n\n<pre><code>Type    Color   UniqueLocations\n----    -----   --------\nApple   Green   2\nBanana  Yellow  2\n</code></pre>\n\n<p>Note that {Apple, Red, 1} doesn't appear because there is only 1 location for red apples (Chicago).  I think I've got this one (but perhaps there is a simpler method).  I'm using:</p>\n\n<pre><code>SELECT Type, Color, Count(Location) FROM\n(SELECT DISTINCT Type, Color, Location FROM MyTable)\nGROUP BY Type, Color HAVING Count(Location)&gt;1;\n</code></pre>\n\n<p>How can I create another query that lists the <code>Type, Color</code>, and <code>Location</code> for each distinct <code>Type,Color</code> when the count of unique locations for that <code>Type,Color</code> is greater than 1?  The resulting recordset would look like:</p>\n\n<pre><code>Type    Color   Location\n----    -----   --------\nApple   Green   New York\nApple   Green   Los Angeles\nBanana  Yellow  Miami\nBanana  Yellow  Atlanta\n</code></pre>\n\n<p>Note that <code>Apple, Red, Chicago</code> doesn't appear because there is only 1 location for red apples.  Thanks!</p>\n"},{"tags":["sql","mysql","query","table","drop"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":5119,"score":11,"question_id":1589278,"title":"SQL: deleting tables with prefix","body":"<p>i know how to delete my tables in MySQL, </p>\n\n<pre><code>DROP TABLE\n</code></pre>\n\n<p>but now i need to know how to delete my tables who all have the prefix</p>\n\n<pre><code>myprefix_\n</code></pre>\n\n<p>How to?</p>\n\n<p>--I NEED TO DO THIS IN PHPMYADMIN, IN A BROWSER. NO TERMINAL STUFF PLEASE. BATCH STUFF IS ALWAYS APRECIATED.--</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":13255829,"title":"Dynamic WHERE condition based on variable","body":"<p>I have the follow line in SQL Server</p>\n\n<pre><code>((@data_inicial IS NULL OR @data_inicial = '') \nOR \ntbSO.dt_criacao &gt;= CAST(@data_inicial AS DATE))\n</code></pre>\n\n<p>I need to use the field tbSO.dt_criacao depending one parameter that I receive @cod_status.</p>\n\n<p>If @cod_status = 1 I have to use tbSO.dt_criacao <br/>\nIf @cod_status = 2 I have to use tbSO.dt_abertura <br/>\nIf @cod_status = 3 I have to use tbSO.dt_fechamento</p>\n\n<p>Can you help me in this issue?</p>\n\n<p>Best Regards</p>\n\n<p>Milton Camara</p>\n"},{"tags":["mysql","sql"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13257629,"title":"Update value based on subquery returning more than one row","body":"<p>I have this probably simple SQL question.</p>\n\n<pre><code>UPDATE parts\nSET partscnt=partscnt-1\nWHERE idparts = (SELECT idparts FROM ordercontent WHERE idOrder=4);\n</code></pre>\n\n<p>Problem is that the subquery returns 5 values, and i want the update done on each of the values.</p>\n\n<p>Update:\nThe ordercontent table has an ID for the order and a row idparts. If several of the same parts are hooked to the same order the table looks like this:</p>\n\n<pre><code>ID idparts\n4  147\n4  147\n4  147\n4  55\n4  33\n</code></pre>\n\n<p>So I need to decrement the partscount three times for the part with id 147.</p>\n\n<p>How can I change this query to achieve that?</p>\n"},{"tags":["sql","oracle","plsql","oracle11g"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":70,"score":2,"question_id":13257632,"title":"Oracle 11g: How to union an oracle table with itself?","body":"<p>I have a table which looks like the following: </p>\n\n<pre><code>date          code                name    score         set\n09/09/12     967873         Team A         24            1\n09/09/12     967873         Team B         22            1\n09/09/12     967873         Team A         21            2 \n09/09/12     967873         Team B         16            2\n02/04/12     965454         Team X         21            1\n02/04/12     965454         Team Y         19            1\n02/04/12     965454         Team X         21            2\n02/04/12     965454         Team Y         19            2\n</code></pre>\n\n<p>you guessed it right! it's a volleyball match! however, I would like my output to be in a single line. For example: </p>\n\n<pre><code>date           code               Teams                 Set-1    Set-2     Set-3\n09/09/12      967873             Team A VS.Team B       24-22    21-16       -\nand so on.... \n</code></pre>\n\n<p><code>**Notice that the game could have a third set as well</code></p>\n\n<p>I will need some kind of self join to refine the above format to the format that is easier for Users view...Let me know if you need more details.</p>\n\n<p>Thanks,</p>\n"},{"tags":["asp.net","sql","sql-server-2008","compression","sharpziplib"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13202578,"title":"Most Space-Efficient Way to Store a Byte Array in a Database Table - ASP.NET","body":"<p>Right now we have a database table (SQL Server 2008 R2) that stores an uploaded file (PDF, DOC, TXT, etc.) in an image type column. A user uploads this file from an ASP.NET application. My project is to get a handle on the size at which this table is growing, and I've come up with a couple of questions along the way.</p>\n\n<ol>\n<li><p>On the database side, I've discovered the image column type is supposedly somewhat depreciated? Will I gain any benefits to switching over to varbinary(max), or should I say varbinary(5767168) because that is my file size cap, or might as well I just let it stay as an image type as far as space-efficiency is concerned?</p></li>\n<li><p>On the application side, I want to compress the byte array. Microsoft's built in GZip sometimes made the file bigger instead of smaller. I switched over to SharpZipLib, which is much better, but I still occasionally run into the same problem. Is there a way to find out the average file compression savings before I implement it on a wide scale? I'm having a hard time finding out what the underlying algorithm is that they use.</p></li>\n<li><p>Would it be worth writing a Huffman code algorithm of my own, or will that present the same problem where there is occasionally a larger compressed file than original file?</p></li>\n</ol>\n\n<p>For reference, in case it matters, here's the code in my app:</p>\n\n<pre><code>    using ICSharpCode.SharpZipLib.GZip;\n\n    private static byte[] Compress(byte[] data)\n    {\n        MemoryStream output = new MemoryStream();\n\n        using (GZipOutputStream gzip = new GZipOutputStream(output))\n        {\n            gzip.IsStreamOwner = false;\n            gzip.Write(data, 0, data.Length);\n            gzip.Close();\n        }\n        return output.ToArray();\n    }\n\n    private static byte[] Decompress(byte[] data)\n    {\n        MemoryStream output = new MemoryStream();\n        MemoryStream input = new MemoryStream();\n        input.Write(data, 0, data.Length);\n        input.Position = 0;\n\n        using (GZipInputStream gzip = new GZipInputStream(input))\n        {\n            byte[] buff = new byte[64];\n            int read = gzip.Read(buff, 0, buff.Length);\n\n            while (read &gt; 0)\n            {\n                output.Write(buff, 0, read);\n                read = gzip.Read(buff, 0, buff.Length);\n            }\n\n            gzip.Close();\n        }\n        return output.ToArray();\n    }\n</code></pre>\n\n<p>Thanks in advance for any help. :)</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13258412,"title":"How to write an alter table statement to add a constraint","body":"<p>I'm, new to SQL. I have created few tables:</p>\n\n<pre><code>CREATE TABLE MAINTINANCE\n(Maint_mname char(10),\nMaint_date date,\nMaint_duedate date NOT NULL,\nMaint_mdesc char (15));    \n\nCREATE TABLE DESIGNERR\n(Dez_emp_number varchar(11),\nDez_field char(12),\nDez_qualification char(10) NOT NULL,\nDez_experience smallint);\n</code></pre>\n\n<p>For the first table I am adding the following constraint:</p>\n\n<pre><code>ALTER TABLE MAINTINANCE ADD CONSTRAINT CHK_maintdate CHECK(Maint_date&lt;MAint_duedate);\n</code></pre>\n\n<p>but I am getting the error <code>invalid ALTER TABLE option</code>. Could you please let me know why this is appearing? The same is working for a friend but not for me.</p>\n\n<p>For the second table I have to write a SQL command for the business rule:</p>\n\n<blockquote>\n  <p>If the Qualification of a Designer is BS then a Minimum of 4 years\n  Experience is required. But, if the Qualification of the Designer is\n  MS then a Minimum of 2 years Experience is sufficient.</p>\n</blockquote>\n\n<p>How can we define this business rule in SQL?</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13193574,"title":"Searching a GridView bound to SQLDataSource using Textboxes","body":"<p>My scenario is a Gridview which is bound to a stored procedure using asp:SQLDataSource. This was quickly done using the wizard where i selected the SP and all data was dispalyed.\nThe SP was created in such a way that it contains 4 parameters. When such parameters are null, they will return all values in the query.</p>\n\n<p>I have created 3 textboxes and a dropdown list to populate these parameters, binding them to a  button in an attempt to create a search functionality. I have tried many ways and methods, especially by research on this site but none seem to work. I cant quite find my issue so I appreciate any help on the matter. Below is my code.</p>\n\n<pre><code>&lt;asp:SqlDataSource ID=\"sqlSourceID\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:DBCONNSTRING%&gt;\"\n            SelectCommand=\"storedProcedureName\" SelectCommandType=\"StoredProcedure\"&gt;                \n        &lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>The above is the SQL stored procedure bind.</p>\n\n<p>I have attemtped to bind the controls as parameters for the SQL server. Prior to this code, the page used to load all records fine without search parameters as the SP was assuming a null value. Now nothing loads.</p>\n\n<pre><code>            &lt;SelectParameters&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox1\" PropertyName=\"Text\" Name=\"1\" Type=\"DateTime\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox2\" PropertyName=\"Text\" Name=\"2\" Type=\"DateTime\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox3\" PropertyName=\"Text\" Name=\"3\" Type=\"String\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"ddl1\" PropertyName=\"SelectedText\" Name=\"4\" Type=\"String\" /&gt;\n            &lt;/SelectParameters&gt;\n</code></pre>\n\n<p>Where the Control ID represents the textbox ID</p>\n\n<p>Below is my code behind.</p>\n\n<pre><code>        sqlSourceID.SelectParameters[\"textbox1\"].DefaultValue = this.textbox.Text;\n        sqlSourceID.SelectParameters[\"textbox2\"].DefaultValue = this.textbox1.Text;\n        sqlSourceID.SelectParameters[\"textbox3\"].DefaultValue = this.textbox2.Text;\n        sqlSourceID.SelectParameters[\"ddl1\"].DefaultValue =    Convert.ToString(this.ddl.SelectedText);\n</code></pre>\n\n<p>Well that is my problem. I need to find a way to pass parameters from the textboxes when the Search Button is clicked and assume null on page load or if nothing is written.</p>\n\n<p>Thanks to all those who contribute in advance.</p>\n"},{"tags":["mysql","sql","query","reservation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13239084,"title":"MySQL Reservation System - Testing for multiple conditions","body":"<p>I'm working on a reservation system in MySQL and I'm having a bit of trouble with my query for finding the next available appointment slots.</p>\n\n<p>My days are broken down into 15-minute slots (00:00:00 - 00:14:59, 00:15:00 - 00:29:59, etc.).  Table structure so far:</p>\n\n<p><strong>appointments table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `appointments` (\n`appointmentID` int(9) unsigned NOT NULL AUTO_INCREMENT,\n`patientID` int(9) unsigned NOT NULL,\n`apptTitle` varchar(50) NOT NULL,\n`apptDT` datetime NOT NULL,\n`apptLength` int(4) NOT NULL,\n`apptStatus` varchar(25) NOT NULL,\n`physician` int(9) unsigned NOT NULL,\n`apptType` varchar(30) NOT NULL,\n`apptLocation` varchar(25) NOT NULL,\nPRIMARY KEY (`appointmentID`),\nKEY `patientID` (`patientID`),\nKEY `physician` (`physician`),\nKEY `apptStatus` (`apptStatus`),\nKEY `apptLocation` (`apptLocation`),\nKEY `apptType` (`apptType`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n</code></pre>\n\n<p><strong>apptSlots Table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `apptSlots` (\n`startDT` datetime NOT NULL,\n`endDT` datetime NOT NULL,\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>The apptSlots table is already filled with all the 15 minute slots for 2012, as I explained above.</p>\n\n<p>I have a query that can successfully show me the slots that aren't taken in any way (no appointments scheduled at all).</p>\n\n<pre><code>SELECT a.*\nFROM apptSlots AS a\nLEFT JOIN appointments AS b\nON a.endDT\nBETWEEN b.apptDT AND DATE_ADD(b.apptDT, INTERVAL b.apptLength MINUTE)\nAND b.appointmentID IS NULL\n</code></pre>\n\n<p>What I need to do now is search for appointment slots across multiple physicians, multiple rooms, etc.  For example, if Physician A makes an appointment for 7am - 8am, that time slot no longer shows up in my query above.  But Physician B and C don't have any appointments for that slot, so I need to be able to schedule them.  The same goes for rooms, Room A is used by the 7am appointment, but room B and C are still free to be scheduled.</p>\n\n<p>How can I determine open slots with all these variables?  I know I can test with WHERE conditions for each combination and this works if I need to test for a specific doctor, or a specific room for a treatment.  But, if I just want to see all slots across all doctors and rooms, my query doesn't work and testing all possible combinations individually doesn't seem right, it's just a matter of how to get the right conditions into the LEFT JOIN clause.</p>\n\n<p>Please let me know if I'm being unclear, but I think this is enough info.  If not, I'll add in whatever you ask for!</p>\n\n<p>Thank you for your help, my previous question on here got me as far as my query above, now I just need some refinement.  Ask any questions you need, I'll be here to answer them!</p>\n"},{"tags":["php","sql","database","function"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13257934,"title":"PHP SQL Discount Code For Specific Items?","body":"<p>This function successfully calculates a global percentage using a single discount code, although I'm having problems making the code discount a specific range of items instead of globally.   The basket session holds id, name, desc, price, qty etc... but everything I've tried thus far has failed, I realize I need to implement it into the foreach loop (which I keep breaking or updates every item one way or another) or use a different method entirely but I'm really unsure as how to proceed.</p>\n\n<p>I'm not an experienced PHP Dev by the way I just enjoy learning and working basic markup.  Any helpful pointers someone can provide would be very much appreciated.  Thanks!</p>\n\n<pre><code>    $code = $this-&gt;request['code'];\n\n    $discount_status = 'NONE'; // no discount available / applied\n    if ( !empty($this-&gt;config['DISCOUNT_CODE']) &amp;&amp; !empty($this-&gt;config['DISCOUNT_PERCENT']) &amp;&amp; !empty($code) ) {\n        if ( $code == $this-&gt;config['DISCOUNT_CODE'] ) {\n            $discount_status = 'OK';\n        }\n        else {\n            $discount_status = 'ERROR';\n        }\n    }       \n\n    // calculate basket total\n    $basket_value = 0;\n    $discount_factor = 1;\n    if ( $discount_status == 'OK' ) {\n        // apply discount\n        $discount_factor = ( 100 - $this-&gt;config['DISCOUNT_PERCENT'] ) / 100;\n    }   \n\n    if ( !empty($_SESSION['basket']) &amp;&amp; is_array($_SESSION['basket']) ) {       \n    foreach( $_SESSION['basket'] as $basketItem ) {                 \n        // Apply discount to each item separately       \n        $basket_value += sprintf(\"%.02f\", $basketItem['detail_price'] * $discount_factor) * $basketItem['qty'];  \n        }       \n    }   \n\n    // check delivery cost\n    $delivery_area = $this-&gt;DeliveryAreaManager-&gt;getRecord($this-&gt;request['da']);\n    if ( !empty($delivery_area['cost']) &amp;&amp; ( $delivery_area['free_from'] &lt;= 0 || $basket_value &lt; $delivery_area['free_from'] ) ) {\n        $basket_value += $delivery_area['cost'];\n    }\n\n    // return JSON response\n    $data = JSONUtils::encode(\n        array(\n            'discount_status' =&gt; $discount_status,\n            'basket_value' =&gt; sprintf(\"%.02f\", $basket_value),\n        )\n    );\n\n    return $data;\n</code></pre>\n"},{"tags":["sql","postgresql","plpgsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":500,"score":1,"question_id":7945932,"title":"How return result of a select inside a function in PostgreSQL?","body":"<p>I have this function in PostgreSQL, but I don't know how to do to return the result of the query.</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION wordFrequency(maxTokens INTEGER) RETURNS SETOF RECORD AS $$\nBEGIN\n    SELECT text, count(*), 100 / maxTokens * count(*)\n    FROM (\n        SELECT text\n    FROM token\n    WHERE chartype = 'ALPHABETIC'\n    LIMIT maxTokens\n    ) as tokens\n    GROUP BY text\n    ORDER BY count DESC\nEND\n$$\nLANGUAGE plpgsql;\n</code></pre>\n\n<p>But I don't know how return the result of query inside PostgreSQL function.</p>\n\n<p>I found that the return type should be <code>SETOF RECORD</code>. right? But the return command is not right.</p>\n\n<p>What is the right way to do this?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13258297,"title":"A script to test existence of primary keys","body":"<p>Trying to figure out a SQL script to test the existence of primary keys in cerain tables.  If the table has no primary key, then the script should output the table name.</p>\n\n<pre><code>Tables to test:\nTableA\nTableB\nTableC\n</code></pre>\n\n<p>After running the script (and lets say TableA and TableC have PKs, but not TableB), then the output would be below:</p>\n\n<pre><code>NoKeys\nTableB\n</code></pre>\n"},{"tags":["php","sql","ini"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":5217542,"title":"Is it dangerous to remove \"magic_quotes_gpc\" from .htaccess file?","body":"<p>I'm installing <code>phplist</code> under my server that is based on cgi mode. I read that I have to hide the part related to \"magic_quotes_gpc\" on .htaccess file and that I also need to configure php.ini file so to allow magic quotes.</p>\n\n<p>I have configured a separate database for phplist different from that of my site.\nSo is there anything dangerous about that? What is it about \"sql injectors\" ?</p>\n\n<p>I'm using PHP Version 4.4.9</p>\n"},{"tags":["sql","join","sybase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13255780,"title":"How to join by column name","body":"<p>I have a table T1 such that </p>\n\n<pre><code>gsdv   |nsdv  |esdv\n-------------------\n228.90 |216.41|0.00\n</code></pre>\n\n<p>and a table T2 such that</p>\n\n<pre><code>ds                 |nm\n--------------------------\n'Non-Revenue Sales'|'ESDV'\n'Gross Sales'      |'GSDV'\n'Net Sales'        |'NSDV'\n</code></pre>\n\n<p>How do I get the following table?</p>\n\n<pre><code>ds                 |nm    |val\n---------------------------------\n'Non-Revenue Sales'|'ESDV'|0.00\n'Gross Sales'      |'GSDV'|228.90\n'Net Sales'        |'NSDV'|216.41\n</code></pre>\n\n<p>I know that I can do this with the following </p>\n\n<pre><code>SELECT ds,nm,esdv val FROM T1,T2 WHERE nm = 'esdv'\nUNION\nSELECT ds,nm,gsdv val FROM T1,T2 WHERE nm = 'gsdv'\nUNION\nSELECT ds,nm,nsdv val FROM T1,T2 WHERE nm = 'nsdv'\n</code></pre>\n\n<p>but I am looking for a more generic/nicer solution. I am using Sybase, but if you can think of a way to do this with other DBMS, please let me know. \nThanks.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256604,"title":"MySql adding new column results in Too many connections","body":"<p>My problem is MySQL runs into a 'Too many connections' error when I add a new column to my live database.</p>\n\n<p>The database has 1 million records so it takes a while to add this. </p>\n\n<ul>\n<li>What is the reason the table locks? </li>\n<li>What to do to keep table running?</li>\n</ul>\n\n<p>The query I execute on the table with 1 million records (InnoDB)</p>\n\n<pre><code>ALTER TABLE table_name \nADD COLUMN new_table_column INT(11) NULL \nDEFAULT NULL ;\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","query","tsql","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13257860,"title":"When I run simple select query, is it possible not to show number of rows affected at the end?","body":"<p>I try to use OSQL in order to save query results in text file and later bulk insert those text file to a table. OSQL part is ok, however, in bulk insert, number of rows affected at the end of query results causes error. Here is an example;</p>\n\n<pre><code>select item_number, description, price from item\n\n3536114   Fruit mix     $3.99\n\n3536229   DO 20 liquid  $9.99\n\n3536251   Peppermint    $7.99\n\n(3 rows affected) ------&gt; I do not need this line.\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":8,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1603,"score":5,"question_id":9740256,"title":"How to compare if two strings contain the same words in T-SQL for SQL Server 2008?","body":"<p>When I compare two strings in SQL Server, there are couple of simple ways with <code>=</code> or <code>LIKE</code>.</p>\n\n<p>I want to redefine equality as:  </p>\n\n<p><em>If two strings contain the same words - no matter in what order - they are equal, otherwise they are not.</em></p>\n\n<p>For example:  </p>\n\n<ul>\n<li><code>'my word'</code> and <code>'word my'</code> are equal</li>\n<li><code>'my word'</code> and <code>'aaamy word'</code> are not</li>\n</ul>\n\n<p>What's the best simple solution for this problem?</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":428,"score":2,"question_id":6612306,"title":"prevent sql injection","body":"<p>Is there  a way to prevent sql injection by using stored procedures?</p>\n\n<p>I have a sql query as </p>\n\n<pre><code>select column name from table where field ='@value'\ncmd.parameters.add('@value', value);\n</code></pre>\n\n<p>I am using parameterized queries with least privileges. How can i write a basic stored procedure to prevent an sql injection.  Is that possible?</p>\n"},{"tags":["php","sql","sql-server"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13257659,"title":"sqlsrv returns empty query","body":"<p>I got a weird problem, on a other webserver (and other mssql server) there wasn't a problem.\nBut now I can connect to the server, I can connect to the database.</p>\n\n<p>And I can execute a query (at least I can use the syntax and it doesn't show an error) but it has no results. Also a <code>sqlsrv_fetch_array</code> returns <code>false</code>..</p>\n\n<p>And I don't have that much mssql knowledge, so I just have a very basic installation.</p>\n\n<p>What did I do wrong or what information do you need?</p>\n\n<p>PS. I'm using windows sql server 2008 R2.</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["mysql","sql","wordpress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13257548,"title":"MySQL - Search for column value based on another column value","body":"<p>I have the following SQL statement to calculate several fields based on 3 Wordpress tables. What I need is to calculate the <code>SUM</code> and <code>AVG</code> which are not working in the statement below. </p>\n\n<p>I need to sum all meta_values '3279' only when <code>meta_key = image</code>. The same applies to the <code>AVG</code> formula, ie, avg all meta_values when <code>meta_key=odd</code>.</p>\n\n<p>Any help is much appreciated!</p>\n\n<pre><code>SELECT (user_nicename) AS user,\n       SELECT SUM(IF('meta_key' = 'image', 'meta_value' = '3279', 1,0)) AS won,\n       SELECT SUM(IF('meta_key' = 'image', 'meta_value' = '3280', 1,0)) AS lost,\n       COUNT('meta_key'='odd') AS total,\n       FORMAT (AVG('meta_key' = 'odd', 'meta_value'),1) AS 'average odd',\n       FORMAT (AVG ('meta_key' = 'bet', 'meta_value'),1) AS 'average bet',\n       SUM('meta_key' = 'roi', 'meta_value') AS ROI\nFROM wp_9691postmeta pm, wp_9691posts p\nINNER JOIN wp_9691posts p ON pm.post_id = p.ID \nINNER JOIN wp_9691users u ON p.post_author = u.ID\nWHERE Month(data) = MONTH(CURRENT_DATE)\nGROUP BY (user_nicename)\nORDER BY ROI DESC\n</code></pre>\n"},{"tags":["java","sql","locking","db2","cluster-computing"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3296,"score":3,"question_id":1228833,"title":"Sharing a Java synchronized block across a cluster, or using a global lock?","body":"<p>I have some code that I want to only allow access to by one thread.  I know how to accomplish this using either <code>synchronized</code> blocks or methods, but will this work in a clustered environment?</p>\n\n<p>The target environment is WebSphere 6.0, with 2 nodes in the cluster.</p>\n\n<p>I have a feeling that <code>synchronized</code> won't work, since each instance of the application on each node will have its own JVM, right?</p>\n\n<p>What I am trying to do here is perform some updates to database records when the system is booted.  It will look for any database records that are older that the version of the code, and perform specific tasks to update them.  I only want one node to perform these upgrades, since I want to be sure that each work item is only upgraded once, and performance of these upgrades is not a big concern, since it only happens at application startup, and it only really does anything when the code has been changed since the last time it started up.</p>\n\n<p>The database is DB2v9, and I am accessing it directly via JNDI (no ORM layer).</p>\n\n<p>It has been suggested that a global lock might be the way to go here, but I'm not sure how to do that.</p>\n\n<p>Does anyone have any pointers in this arena?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","asp.net-mvc","amazon-web-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13252686,"title":"Can't connect website to database on amazon web services","body":"<p>I've just loaded my mvc.net 3 website up onto a micro instance on Amazon Web Services and put the database up there on a RDS as well. I can connect to the database via AWS Explorer in VS2010 just fine but when I add the connection string to my <code>web.config</code> it times out trying to access the database. Is there something else I need to do?</p>\n\n<p>The web site loads fine, it just times out when accessing the DB.</p>\n\n<p>Sorry if this is a but vague, the whole AWS thing is new to me.</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13253438,"title":"SQL join on table different from source table","body":"<p>I have the following SQL statement:</p>\n\n<pre><code>select distinct\n  u.id, \n  v1.code,\n  v2.code,\n  a1.phone,\n  a1.phone1,\n  SUM(o1.totalprice) as SALES\n  SUM(ot4.numbers) as NUMBERS\nfrom \n  users u,\n  orders o2\n inner join values v1 on v1.pk = u.gender\n inner join values v2 on v2.pk = u.egistration\n inner join addresses a1 on a1.owner = u.pk \n inner join orders o1 on o1.userpk = u.pk\n inner join orderthings ot4 on ot4.orderpk = o2.pk \nwhere \n  u.cccustomer = 1\nand\n  v2.code = 'REGISTERED'\ngroup by\n  u.id, \n  v1.code,\n  v2.code,\n  a1.phone,\n  a1.phone1\norder by \n  id;\n</code></pre>\n\n<p>Basically the join on orders doesn't work but I need to get the additional relation on the two tables that have no relation to users u. How can I accomplish that?</p>\n"},{"tags":["mysql","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":208,"score":2,"question_id":5532684,"title":"inner join for a query?","body":"<p>I want to do a sql query and have some problems:</p>\n\n<ol>\n<li><p>I want to select from table_1 the ID's Where parent_id is the value I have:</p>\n\n<pre><code>SELECT ID \n  FROM table_1 \n WHERE parent_ID = 'x'\n</code></pre></li>\n<li><p>I want to use the ID'S I got in 1. and </p>\n\n<pre><code>SELECT \n  FROM table_2 \n WHERE ID = 'The ID's from Query 1.'\n</code></pre></li>\n</ol>\n"},{"tags":["mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13253814,"title":"MySQL query to retrieve items that have an exact match in a many-to-many relationship","body":"<p>I have the following tables:</p>\n\n<pre><code>Media:\n- mediaid\n- mediatitle\n\n\nMediaTag:\n- mediaid\n- mediatag\n\n\nTag:\n- tagid\n- tagname\n</code></pre>\n\n<p>The following tags:</p>\n\n<pre><code>Tag: (1) - Public\nTag: (2) - Premium\nTag: (3) - Restricted\n</code></pre>\n\n<p>The following media with tags:</p>\n\n<pre><code>Media: (1) - Public\nMedia: (2) - Premium &amp; Restricted\nMedia: (3) - Premium\nMedia: (4) - Restricted\nMedia: (5) - No tags\n</code></pre>\n\n<p>Assume that a user has permissions to see only <code>Public (1)</code> and <code>Restricted (3)</code> tags. If a media has a combination of tags that the user doesn't have explicit access to, he's not allowed to see it. If a media has no tag it's not visible at all. So the user in this case would be able to see only <code>Media 1</code> and <code>Media 4</code>.</p>\n\n<p>Is it possible to write a MySQL query to retrieve the media assuming I have the user permissions in the form of an array with tag IDs <code>(1,3)</code> ?</p>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13257118,"title":"Link field values and ID to another table?","body":"<p>How do I link or add the field with all my users called \"username\" from my main table to another table so I can run checks and compare values without having to add a ton of rows to my main table? This would be a much cleaner and more organized setup. </p>\n\n<p>Table called login_users. This is my main table that stores their basic information</p>\n\n<pre><code>username       email                 password\nAnthony        user@email.com\nJosh           user@email.com\nTsuyoshi       user@email.com\n</code></pre>\n\n<p>Table 2 called badge_status. This table will hold their status with whether or not they have unlocked an achievement on my site. I want to bring in the <strong>usernames.</strong></p>\n\n<pre><code>username       badge1               badge2\nAnthony        locked               unlocked\nJosh           unlocked             locked\nTsuyoshi       unlocked             locked\n</code></pre>\n\n<p>Also, could table 2 automatically be updated with a new user when they sign up since all new sign ups are imported into the first table. As a side note, I am using phpmyadmin.</p>\n\n<p>Thanks for any help with getting this set up. Very much appreciated.</p>\n"},{"tags":["sql","database","performance","query","filter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257155,"title":"Architecture for a fast screener","body":"<p>I'm building a screener that should be able to search through a table about 50 columns wide and 7000 rows long really fast.</p>\n\n<p>Each row is composed of the following columns.</p>\n\n<p>primary_key, quantity1, quantity2, quantity3...quantity50.</p>\n\n<p>All quantities are essentially floats or integers. Hence a typical screener would look like this.</p>\n\n<pre><code>Get all rows which have quantity1 &gt; x and quantity2 &lt; y and quantity3 &gt;= z.\n</code></pre>\n\n<p>Indexing all columns should lead to really fast search times however some of the columns will be updating in realtime. Indexing everything obviously leads to very low insert/update times.</p>\n\n<p>A portion of the columns are fairly static though. Hence an idea was to segregate the data into two tables, one containing all columns that are static while the other containing data that is dynamic. Any screener would then be applied to both tables based on the actual query. And the results combined in the end.</p>\n\n<p>I am currently planning on using a MySQL engine, most probably INNoDB. However I'm looking to get much faster response times. An implementation of the same problem on a certain site was very snappy. Regardless of the query size, i was getting the results within 500 ms. Wondering what other options are available out there to implement this function.</p>\n\n<p>Any thoughts/hints towards a potential solution would be greatly appreciated.</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13256685,"title":"Optimization of query with counts of distinct column based on value of other column","body":"<p>There must be a better way to write this, but I'm just not sure what that is. Basically I'm trying to count the distinct values from one column where a condition is met in a separate column. I found this <a href=\"http://stackoverflow.com/questions/11853065/trying-to-count-distinct-values-of-a-field-based-on-value-of-a-different-field\">link</a>, but am not sure how to apply it here.</p>\n\n<p>Here is the query, I am using SQL Server 2008R2</p>\n\n<pre><code>SELECT lot,\n    (SELECT COUNT(DISTINCT d.pid) FROM invdet d WHERE upk = 0 and d.lot = [invdet].lot) as noUpk,\n    (SELECT COUNT(DISTINCT d.pid) FROM invdet d WHERE upk = 1 and d.lot = [invdet].lot) as isUpk\nFROM invdet\nWHERE ([status] in ('PQ','P2','FA','F2','BH','RL','SC','LD','PS'))\nGROUP BY lot\nHAVING COUNT(CASE WHEN invdet.upk = 1 THEN 1 ELSE null END) &gt; 0\n</code></pre>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13256882,"title":"SQL - Select Columns from table where another table column value equals column name list","body":"<p>seen a lot of similar posts about parsing data based on values but nothing quite what I want to get the result column from one table that contains the column names for another table. For example:</p>\n\n<pre><code> Select [col1], [col2]\n from Table1\n where (select changes as (col#)\n        from table2)\n</code></pre>\n\n<p>The col# is a list of the column names I want from Table1. Table2 changes column is a comma separated list. I wanted to figure a way to be able to get each column from Table1 that's in the list from table2. Any help is greatly appreciated.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13256813,"title":"SELECT SUM() FROM (SELECT (SELECT ())","body":"<p>I have a correct working T-SQL-script in this form</p>\n\n<pre><code>SELECT  columnA\n        AS\n        'numbers'\nFROM    tableA\nWHERE   clause\n</code></pre>\n\n<p>This script gives me as one column, called numbers, of integers. I want to sum these.</p>\n\n<p>Calling the above lines 'script' I tried the following setup</p>\n\n<pre><code>SELECT  SUM(numbers)\nFROM    (\n            script\n        )\n</code></pre>\n\n<p>Reading <a href=\"http://stackoverflow.com/questions/10439122/select-count-from-select\">select count(*) from select</a> I supposed this to work, however, it does not. I keep getting \"Incorrect syntax near.\"</p>\n\n<p>I do not know if it is important but that is here named columnA is itself maked by a SELECT statement.</p>\n"},{"tags":["sql","query","optimization","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13256383,"title":"SQL query: how to distinct count of a column group by another column","body":"<p>In my table I need to know if each <code>ID</code> has one and only one <code>ID_name</code>. How can I write such query?</p>\n\n<p>I tried:</p>\n\n<pre><code>select ID, count(distinct ID_name) as count_name \nfrom table \ngroup by ID \nhaving count_name &gt; 1\n</code></pre>\n\n<p>But it takes forever to run. </p>\n\n<p>Any thoughts?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13256336,"title":"fill empty column with sequence","body":"<p>Is there any way to fill an empty column with a ascending sequence of numbers starting from 1, without using identity?</p>\n\n<p>I tried the following cursor but it is filling the same value (450) for all rows in the column:</p>\n\n<pre><code>declare cur3 cursor for\nselect new_id from sheet1$\ndeclare @no int\ndeclare @no1 int\nset @no1 = 1\nopen cur3\nfetch next from cur3 into @no\nwhile(@@FETCH_STATUS = 0)\nbegin\nupdate sheet1$ set new_id = @no1\nset @no1 = @no1 + 1\nfetch next from cur3 into @no\nend\nclose cur3\ndeallocate cur3\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13254417,"title":"trying to create a trigger that check age from an insert and place into another table if less than 18","body":"<p>Develop a trigger that will be placed on the marketing list table that will insert a record into the child table if the person's age is less than 18 once an insert is attempted.</p>\n\n<p>SEE the code below: </p>\n\n<pre><code>Create Trigger on_insert_marketing_list\nOn marketing_list for insert\nAs\nBEGIN\n        Declare @Name varchar (100)\n        Declare @Dob date\n        Declare @Gender char(1)\n        Declare @Parish VARCHAR(50)\n        Declare @Mobile varchar(50)\n        Declare @Provider varchar(50)\n        Declare @age int\n\n        Select @age = datediff(year,@dob,getdate())from inserted\n\n        If (@age) &lt; 18      \n        BEGIN\n        Insert Into Childlist values(@Name,@Dob,@Gender,@Parish,@Mobile,@Provider)\n        END\n\nEnd\n\ninsert into marketing_list (Name, Dob, Gender,  Parish,  Mobile, Mobile_Provider) values\n('Kendrick Lamar', '3/4/2005','M','Kingston', '18764532345','LIME')\n</code></pre>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13256290,"title":"EF get Keyvalues of added objects","body":"<p>Is it possible to get the entity keyvalues of added objects?</p>\n\n<p>The keyvalues are set after context.SaveChanges(). But unfortunately after context.SaveChanges the EntityState.Added is gone.</p>\n"},{"tags":["php","sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13255566,"title":"SQL - Select IDs from two different tables","body":"<p>I have two tables that have logging information for different actions. I want to select information from both logging tables and display it. I cannot modify the application, so I can't modify the table structure. Assuming I wanted, say, 30 records, I figured I could write some kind of join query that would just return the IDs for each table, in order by time. Then I could simply run two separate queries selecting those IDs from the individual tables. I'm not sure how to do this, or if you even can do this, and I'm kind of at a loss. Can anyone help? If there's a cleaner solution I'd be happy to hear that as well, I'm working in PHP.</p>\n\n<p>Example data:</p>\n\n<p>MAGICAL SELECT ? FROM table1 MAGIC JOIN table2 MAGICALLY ORDER BY date DESC LIMIT 3</p>\n\n<p>Table 1</p>\n\n<pre><code>|------|-------|------------|\n| id   | date  | other data |\n|------|-------|------------|\n| 1    | 8     | ...        |\n| 2    | 5     | ...        |\n| 3    | 3     | ...        |\n|------|-------|------------|\n</code></pre>\n\n<p>Table 2</p>\n\n<pre><code>|------|-------|------------|\n| id   | date  | other data |\n|------|-------|------------|\n| 1    | 6     | ...        |\n| 2    | 4     | ...        |\n| 3    | 12    | ...        |\n|------|-------|------------|\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>|-----------|-----------|\n| table1_id | table2_id |\n|-----------|-----------|\n| NULL      | 3         |\n| 1         | NULL      |\n| NULL      | 1         |\n|-----------|-----------|\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","join","db2","left-join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13246686,"title":"2 Joins on the same table","body":"<p>I have, once again, a little problem with joins. I would like to refere to the same table which causes seem to cause some problems. I originally wanted to use left join (for both joins), because there are results where BBNR has no KVNR refered to it.\nI believe the problem is in the second left join, but so far I didnt find a way to solve this. A normal join won't work and a right join seems to end in nothingsness.</p>\n\n<pre><code>SELECT btst.Ordnungsbegriff AS BBNR, \n       COUNT(vp.KVNR) AS GKV, \n       COUNT (vp1.KVNR) AS PKV\nFROM T_Betriebsstaette btst\nLEFT JOIN T_VERSICHERUNGSZEIT vz \nON vz.BETRIEBSNUMMER = btst.Ordnungsbegriff\nAND vz.VALIDTO = date('2999-12-31')\nAND vz.PERSONENKREIS = 'Beschäftigte'\nAND vz.BEITRAGSGRUPPEKV_IID &gt; 0\nAND vz.PERSONENGRUPPENSCHLUESSEL IN (101, 102, 103, 118, 119)\nLEFT JOIN T_VERSICHERTEPERSON vp\nON vp.OID = vz.VERSPERS_VERSPERSON_ID\nAND ('1' = '0' \n     OR '1' = '1' \n     AND (vp.VIPKENNZEICHEN IS NULL \n          OR NOT vp.VIPKENNZEICHEN IS NULL\n          AND vp.VIPKENNZEICHEN  NOT IN (5, 6)))\nLEFT JOIN T_VERSICHERUNGSZEIT vz1\nON vz1.BETRIEBSNUMMER = btst.Ordnungsbegriff\nAND vz1.VALIDTO = date('2999-12-31')\nAND vz1.PERSONENKREIS = 'Beschäftigte'\nAND vz1.BEITRAGSGRUPPEKV_IID = 0\nAND vz1.BEITRAGSGRUPPEPV_IID = 0\nAND vz1.PERSONENGRUPPENSCHLUESSEL IN (101, 103, 118, 119)\nJOIN T_VERSICHERTEPERSON vp1\nON vp1.OID = vz1.VERSPERS_VERSPERSON_ID\nAND ('1' = '0' \n     OR '1' = '1' \n     AND (vp1.VIPKENNZEICHEN IS NULL \n          OR NOT vp1.VIPKENNZEICHEN IS NULL \n          AND vp1.VIPKENNZEICHEN  NOT IN (5, 6)))\nGROUP BY btst.Ordnungsbegriff\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13207075,"title":"Format a number with commas but without decimals in SQL Server 2008 R2?","body":"<p>I am using the following to create a comma formatted number in T-SQL. How can I get rid of the decimal point and the digits after decimal. So if I get 1,112.00 after formatting, how would I get only 1,112?</p>\n\n<pre><code>SELECT CONVERT(varchar, CAST(1112 AS money), 1)\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13255030,"title":"Oracle SQL - How to use the data dictionary","body":"<p>Oracle SQL - How to use the data dictionary</p>\n\n<p>I was trying oracle sql and was trying to find the name of all indexes owned by a user with the names of index keys in each index.</p>\n\n<p>I try to find from user_indexes in system catalogue view and display INDEX_NAME, INDEX_TYPE, COLUMN_NAME, COLUMN_POSITION but </p>\n\n<p>Below is what I tried:</p>\n\n<pre><code>select table_name, column_name, data_type from user_tab_columns;\n</code></pre>\n\n<p>But its seems insufficient to display all the user_indexes.. what should i do</p>\n"},{"tags":["php","html","sql","sharepoint","web"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13254863,"title":"Query Sharepoint for Table presentation on Web","body":"<p>I already have the ability to use PHP to send SQL queries to a connected Access file and display the output on a website.</p>\n\n<p>I need to implement automation so:</p>\n\n<p>Instead of exporting the Access file every time and overwriting the old file manually in the web dir, I would like to connect to and query the sharepoint directly.</p>\n\n<p>This way, every time the site was loaded/refreshed, it would be grabbing the latest data from the sharepoint.</p>\n\n<p>Is there any way to do this or is there a better meathod?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":594,"score":1,"question_id":6068619,"title":"Merging date intervals in SQL Server","body":"<p>I have the following data:</p>\n\n<pre><code>StartDate   |  EndDate\n-------------------------\n1982.03.02  |  1982.09.30 \n1982.10.01  |  1985.01.17 \n1985.06.26  |  1985.07.26 \n1985.07.30  |  1991.12.31 \n1992.01.01  |  1995.12.31 \n1996.01.01  |  2004.05.31 \n2004.06.05  |  2006.01.31 \n2006.02.01  |  2011.05.20              \n</code></pre>\n\n<p>I need to merge any intervals that are adjacent (both start and the end date are included in the intervals, so an interval ending on 2003.05.06 is adjacent with an interval starting on 2003.05.07), so in this case, the resulting set should be:</p>\n\n<pre><code>StartDate   |  EndDate\n-------------------------\n1982.03.02  |  1985.01.17 \n1985.06.26  |  1985.07.26 \n1985.07.30  |  2004.05.31 \n2004.06.05  |  2011.05.20              \n</code></pre>\n\n<p>For me, the obvious way to do this is to iterate the set with a cursor, and construct a result set row-by-row. However, this functionality will be within code that could potentially be called thousands of times in a day, on a server under heavy load, so I'd prefer not having any performance issues. Any data set is small (20 rows tops), and the data range is large, so any solution that generates all the dates in a range is unfeasible.</p>\n\n<p>Is there a better way I'm not seeing?</p>\n\n<hr>\n\n<p>Initialization code (from Damien's answer):</p>\n\n<pre><code>CREATE TABLE Periods (\n    StartDate datetime NOT NULL CONSTRAINT PK_Periods PRIMARY KEY CLUSTERED,\n    EndDate datetime NOT NULL\n)\n\nINSERT INTO Periods(StartDate,EndDate)\nSELECT '19820302', '19820930'\nUNION ALL SELECT '19821001', '19850117'\nUNION ALL SELECT '19850626', '19850726'\nUNION ALL SELECT '19850730', '19911231'\nUNION ALL SELECT '19920101', '19951231'\nUNION ALL SELECT '19960101', '20040531'\nUNION ALL SELECT '20040605', '20060131'\nUNION ALL SELECT '20060201', '20110520'\n</code></pre>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":54,"score":4,"question_id":13254224,"title":"SQL Order by a float column not working","body":"<p>I have the following rows in my db:</p>\n\n<pre><code>ID       Weight\n-----------------------------\n897      1.46357497509608E-11\n689      6.67145488899268E-12\n896      6.63573718293682E-12\n615      5.14817058560092E-12\n822      5.14806820534293E-12\n</code></pre>\n\n<p>When I execute the following SQL query: </p>\n\n<pre><code>SELECT * \nFROM mytable \nORDER BY weight DESC\n</code></pre>\n\n<p>the data is being returned in the same order.</p>\n\n<p>P.S. the same thing is happening from a Linq query in an ASP.NET C# application</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13249671,"title":"SQL Selecting Two Tables","body":"<p>I dont know how to write the select statement to get the information about details of intervention with only the student id.</p>\n\n<p>If the student id is 2. I would want to find the information about intervention named MENTORING.</p>\n\n<h2>student_intervention table</h2>\n\n<pre><code>id   student_id inter_details_id   start_date                   end_date         staff_id\n 1      2          1            2029-09-12 00:00:00     2029-10-12 00:00:00 0\n 2      2          1            2029-09-12 00:50:00     2029-10-12 00:00:00 0\n</code></pre>\n\n<h2>intervention_details</h2>\n\n<pre><code>   id      name           description\n    1      MENTORING      MENTORING2\n    2      BESPOKE        BESPOKE\n</code></pre>\n"},{"tags":["sql","oracle","olap","cube"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12081229,"title":"Oracle OLAP Expression/Analytical Functions and NA Values","body":"<p>This question is specific to NA values and Oracle OLAP Expression Syntax.</p>\n\n<p><a href=\"http://docs.oracle.com/cd/E11882_01/olap.112/e23381.pdf\" rel=\"nofollow\">http://docs.oracle.com/cd/E11882_01/olap.112/e23381.pdf</a></p>\n\n<p>I am trying to perform some simple avg and sum calculations and there are specific cases where I will have NA values.  It does not appear to exist as part of the Expression Syntax, but is there anyway to perform one of these calcs and skip these values?</p>\n"},{"tags":["php","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13254743,"title":"Session variable not being stored","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8028957/warning-headers-already-sent-in-php\">“Warning: Headers already sent” in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>Why does this not work? I expect to see whatever is input into the text box in first.php displayed back out in test.php.</p>\n\n<pre><code>    &lt;html&gt;\n&lt;body&gt;\n&lt;form action=\"test.php\"&gt;\nTest: &lt;input type=\"text\" name=\"test\" /&gt;\n&lt;br&gt; &lt;input type=\"submit\" name=\"submit\" /&gt;\n    &lt;?php\n    session_start();\n    $_SESSION['test'] = $_POST['test'];\n    ?&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Here is test.php</p>\n\n<pre><code>    &lt;?php\n    session_start();\n    $check = $_SESSION['test'];\n    echo $check; \n    ?&gt;\n</code></pre>\n"},{"tags":["sql","printing","console","sybase","output"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13252089,"title":"Sybase - Setting console output on for printing log statements","body":"<p>Does somebody know how to turn the console output on in Sybase. The usual statement like - ptint 'Hello', is not working for me, it just says command executed successfully without printing the log statement</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13225424,"title":"Insert elements/values into specific child element of XML column in t-sql","body":"<p>In SQL Server 2008, I would like to insert some elements and values into a specific child element of an xml column based on the value of another of that element's children (ID in this case). The xml currently looks like this: </p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;16&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;test&lt;/Name&gt;\n    &lt;Activities /&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>However, there could potentially be multiple <code>&lt;User&gt;</code> elements within the xml, and I need to insert only into the <code>&lt;User&gt;</code> of a specific <code>&lt;ID&gt;</code> value. How can I achieve this in MS SQL Server 2008/ t-sql? Thanks in advance.</p>\n\n<p><strong>Edit:</strong>\nTo simplify, I am grabbing the xml from that column and setting it to a variable:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nDECLARE @profile_id int\nSET @profile_id = 16\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE\nprofiles.value('(Profile/ID)[1]','int')= @profile_id)\n</code></pre>\n\n<p>The resulting xml value of @profiles_xml looks like what I have above.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13237477,"title":"How do I retrieve decimals when rounding an average in SQL","body":"<p>Here is my SQL statement</p>\n\n<pre><code>SELECT ROUND(AVG(column_name), 100) \nFROM [database].[dbo].[table]\n</code></pre>\n\n<p>The answer I retrieve is <code>3</code> with a possible range of numbers between <code>1 - 5</code> in 908 rows.</p>\n\n<p>I need it to say <code>3.0</code> or <code>3.09</code>. Is this possible?</p>\n"},{"tags":["sql","select","where"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13254884,"title":"Accessing results through WHERE","body":"<p>Well after my first question <a href=\"http://stackoverflow.com/questions/13230685/fetching-a-result-twice-with-deferend-name\">here</a> I came the below code which is correct and tested:<br/></p>\n\n<pre><code>SELECT DISTINCT\nid, title, description, expires,\ncreator_id,executer_id,\noc_opentask.priority_id,\noc_opentask.status_id, priority_name, status_name,\noc_user1.username AS executer_username,\noc_user2.username AS creator_username\nFROM oc_opentask\nINNER JOIN oc_opentask_priority \nON oc_opentask.priority_id=oc_opentask_priority.priority_id\nINNER JOIN oc_opentask_status \nON oc_opentask.status_id=oc_opentask_status.status_id\nINNER JOIN oc_user AS oc_user1 \nON oc_opentask.executer_id=oc_user1.user_id\nINNER JOIN oc_user AS oc_user2 \nON oc_opentask.creator_id=oc_user2.user_id\n</code></pre>\n\n<p>My next question is: I want to access those <code>executer_username</code> and <code>creator_username</code> with a WHERE attribute to compare it with a value, so what I am trying which is poping mystake is:</p>\n\n<pre><code>SELECT DISTINCT\nid, title, description, expires,\ncreator_id,executer_id,\noc_opentask.priority_id,\noc_opentask.status_id, priority_name, status_name,\noc_user1.username AS executer_username,\noc_user2.username AS creator_username\nFROM oc_opentask\nINNER JOIN oc_opentask_priority \nON oc_opentask.priority_id=oc_opentask_priority.priority_id\nINNER JOIN oc_opentask_status \nON oc_opentask.status_id=oc_opentask_status.status_id\nINNER JOIN oc_user AS oc_user1 \nON oc_opentask.executer_id=oc_user1.user_id\nINNER JOIN oc_user AS oc_user2 \nON oc_opentask.creator_id=oc_user2.user_id\nWHERE oc_opentask.creator_username='bill' \n</code></pre>\n\n<p>bill does exists in db, but my command to access that value is not correct, can any1 help me on this? Thanks</p>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13250882,"title":"Getting a SQL View via Entity Framework returns incorrect result","body":"<p>I have a very simple View in SQL Server which looks something like this, Where the <strong>Show</strong> is a result of <strong>LEFT JOIN</strong> with <strong>Character</strong> table:</p>\n\n<pre><code>+---------+----------+----------------------+  \n|  Name   | Surname  |         Show         |  \n+---------+----------+----------------------+  \n| Enoch   | Thompson | The Boardwalk Empire |  \n| Anthony | Soprano  | The Sopranos         |  \n| Walter  | White    | Breaking Bad         |  \n+---------+----------+----------------------+  \n</code></pre>\n\n<p>When I get this table via Entity Framework's <code>context.CharacterView.ToList()</code> in my application, the result looks like this: </p>\n\n<pre><code>+---------+----------+----------------------+  \n|  Name   | Surname  |         Show         |  \n+---------+----------+----------------------+  \n| Enoch   | Thompson | The Boardwalk Empire |  \n| Anthony | Soprano  | The Boardwalk Empire |  \n| Walter  | White    | The Boardwalk Empire |  \n+---------+----------+----------------------+  \n</code></pre>\n\n<p>However, in DB the CharacterView is <em>as it should be.</em></p>\n\n<hr>\n\n<h2>Create view query</h2>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE VIEW CharacterView AS\nSELECT c.Name AS [Name], \n       c.Surname AS [Surname], \n       s.Name AS [Show]\n\nFROM   [dbo].[Characters] AS c LEFT OUTER JOIN\n       [dbo].[Shows] AS scen ON c.ShowId = s.Id\n</code></pre>\n\n<hr>\n"},{"tags":["sql","erd"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13253996,"title":"Is there any way to represent many to many relationship without using junction tables?","body":"<p>And in addition to that, when you are drawing out ERD diagrams should you include the \"junction\" tables as entities, even though they are not explicitly mentioned in the spec, but you can clearly see that it is many to many relationship?</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13254504,"title":"Aggregation for join ON clause","body":"<p>I have a table <code>item_table</code> like this:</p>\n\n<pre><code>item   age\n--------------    \n1      1 \n1      6 \n2      2    \n</code></pre>\n\n<p>I have the other table <code>price_table</code> like this:</p>\n\n<pre><code>item    pricetype    price\n--------------------------    \n1       O             5\n1       P             6\n1       V             7\n2       O             8\n2       P             9\n2       V             10\n</code></pre>\n\n<p>So, I want to inner join above two tables.</p>\n\n<pre><code>select *\nfrom item_table i\ninner join price_table p\non ...\n</code></pre>\n\n<p>There are some conditions about the <code>on</code>:</p>\n\n<ol>\n<li>if <strong>the average of age</strong> of an item is bigger than <code>3</code>, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P'</code></li>\n<li>If not, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P' or pricetype = 'V'</code></li>\n</ol>\n\n<p>So there are conditions for <code>on</code> conditions.</p>\n\n<p>I then write the query like this:</p>\n\n<pre><code>select i.item, i.type, p.pricetype, p.price\nfrom item_table i\ninner join price_table p on i.item = p.item \n    and (avg(i.age) &gt;= 3 and p.pricetype in ('O', 'P'))\n        or (avg(i.age) &lt; 3 and p.pricetype in ('O', 'P', 'V'))\n</code></pre>\n\n<p>The error is given: <code>An aggregate cannot appear in an ON clause unless it is in a subquery contained in a HAVING clause or select list, and the column being aggregated is an outer reference.</code></p>\n\n<p>I can't move the <code>avg</code> to <code>Having</code> because other conditions are depending on the <code>avg</code>.</p>\n\n<p><strong>How can I write the select query?</strong></p>\n"},{"tags":["php","mysql","sql","table","mysql-num-rows"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":36,"score":-4,"question_id":13254860,"title":"PHP/MYSQL mysql_num_row() error","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3698740/mysql-num-rows-supplied-argument-is-not-a-valid-mysql-result-resource\">mysql_num_rows(): supplied argument is not a valid MySQL result resource</a>  </p>\n</blockquote>\n\n\n\n<pre><code>$actcheck = \"SELECT * FROM users WHERE username='$username' AND password='$password' AND  = activated = '1'\";\n$query2 = mysql_query($actcheck);\n$count2 = mysql_num_rows($query2);\nif(!($count2==1)){\necho \"You have not activated\";\nexit();\n}\n</code></pre>\n\n<p><strong>Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource</strong>\nAny help?</p>\n"},{"tags":["sql","ruby","activerecord","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13221902,"title":"Return rows where the count of a character is?","body":"<p>I'm developing a rudimentary word finder app with sql and ruby where I have an array of letters to find available words.  It's easier to make the query by narrowing down what alphabetic letters aren't in the array. For ex.</p>\n\n<pre><code>alphabet= %w{a b c d e f g h i j k l m n o p q r s t u v w x y z}\n\navailable_letters = %w{p k z l p m t l n g g r u a r t n d z w a l m n e}\n</code></pre>\n\n<p>I can then subtract from alphabet, letters to exclude from my search and end up with an sql query like the one below.</p>\n\n<pre><code>select * from words\nwhere word not like '%b%' and word not like '%c%' and word not like '%f%'.....\n</code></pre>\n\n<p>This gives me all the available words with a combination of all available letters.  It does not narrow them down by the number of times that letter occurs.  So if I only have one \"E\",  I would like the query to narrow down words that only contain one e.  I'm not sure if this can be done with an sql query or whether I will need to use a procedure.  Anyone know a good way of solving this?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13254694,"title":"insert into with select","body":"<p>hello I would like to insert the values ​​in a column from a select query</p>\n\n<pre><code>insert into (cmts) stat_alert \nvalues(SELECT stat_alert.cell,stat_alert.cmts,cell_cmt.cmts FROM stat_alert`LEFT OUTER JOIN cell_cmt ON cell_cmt.`cell`=stat_alert.cell WHERE stat_alert.`cell`=cell_cmt.cell )\n</code></pre>\n\n<p>I have syntax error\nwho can help me??</p>\n"},{"tags":["sql","database","data","dbms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13254791,"title":"I'm looking for literature about theory of data management","body":"<p>I seek basic and common theoretical literature about DBMS and data managing. I found books only about concrete technologies like MySQL.</p>\n"},{"tags":["sql","oracle"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13253009,"title":"Oracle SQL , how to use current date - a specified date","body":"<p>For getting current date i use this..</p>\n\n<pre><code>select extract(year from sysdate) from dual;\n</code></pre>\n\n<p>For getting the date that my database hold i use this..</p>\n\n<pre><code>select extract(year from startdate) from staff;\n</code></pre>\n\n<p>But now i am trying to update a field call serviceYears inside staff, by using </p>\n\n<p><code>current year - year of start date</code> </p>\n\n<p>to get the amount of years the staff have committed to work. how do i achieve it..</p>\n\n<p>i am using oracle sql</p>\n\n<p><strong>Thanks!</strong></p>\n\n<p>I tried to use </p>\n\n<pre><code>SQL&gt; select dual.sysdate-staff.startdatefrom dual,staff;\n\nselect dual.sysdate-staff.startdatefrom from dual,staff\n            *\nERROR at line 1:\nORA-01747: invalid user.table.column, table.column, or column specification\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>select SYSDATE-to_date('01-jan-2007','dd-mon-yyyy') from dual;\n\nBut it return me\nSYSDATE-TO_DATE('01-JAN-2007','DD-MON-YYYY')\n--------------------------------------------\n                                  2136.93719\n</code></pre>\n\n<p>How do i just get the year?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13254109,"title":"How to determine the place of a row in ordered SQL table?","body":"<p>I have a table of users and a 'points' column. I would like to determine the number/place of the row across all the users ordered by 'points'.</p>\n\n<p>I could just get result of all users data and then do while loop, and stop when id equals necessary user. But I believe there is a more efficient way do to that because my table will contain ~100 000 rows.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":11110775,"title":"How to generate table name by datetime?","body":"<p>I realize this is syntactically bad but I figure it somewhat explains what I'm trying to do. Essentially, I have a batch job that is going to run each morning on a small table and as a part of the spec I need to create a backup prior to each load that can be accessed by a report.</p>\n\n<p>What I have so far is:</p>\n\n<pre><code>select  *\ninto    report_temp.MSK_Traffic_Backup_ + getdate()\nfrom    property.door_traffic\n</code></pre>\n\n<p>How can I make this function or should I consider doing this a better way?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13251097,"title":"Find all users at a certain stage in the process","body":"<p>I have a <code>Patient</code> which follows a process defined with multiple <code>Phase</code>s. When a patient is at a phase, there is a <code>Status</code> created, connecting patient and phase at a specific time stamp.</p>\n\n<p>In MySQL my tables look like:</p>\n\n<pre><code>patient:\n  id (int)\n\nphase:\n  id     (int)\n  order: (int)\n  name:  (varchar)\n\nstatus:\n  patient_id: (int, FK)\n  phase_id:   (int, FK)\n  timestamp:  (datetime)\n</code></pre>\n\n<p>Now I have phases A > B > C > D. I want to select all patients who are <strong>now</strong> at phase B or C. Patients only at phase A must be excluded, patients at phase D (so having a status for B and C) must be excluded too.</p>\n\n<p><strong>My trials</strong></p>\n\n<p>So I want a select something like this to start with:</p>\n\n<pre><code>SELECT p.*, s.*, ph.*\nFROM patient p\nLEFT JOIN status s on p.id  = s.patient_id\nLEFT JOIN phase ph on ph.id = s.phase_id\nWHERE s.id IN \n(\n  // sub query\n)\nORDER BY s.timestamp\n</code></pre>\n\n<p>I thought to select all patients with a given status x. The status x is something like this to start with:</p>\n\n<pre><code>SELECT status.*, phase.name\nFROM status\nLEFT JOIN phase ON phase.id=status.phase_id\nWHERE phase.name IN ('B', 'C')\nGROUP BY status.patient_id\n</code></pre>\n\n<p>But I cannot solve the rest: obviously there is no exclusion made for people further in the process. If I add a <code>max(status.timestamp) as max_timestamp</code> in the select, I see the <code>status.timestamp</code> and <code>max_timestamp</code> differ.</p>\n\n<p>In this query I haven't even used the <code>order</code> in the phase table, I simply wanted to order on <code>id</code> first, but since the process might change over time, I thought that would be a bad idea. So that's missing as well.</p>\n\n<p><strong>Question</strong></p>\n\n<p>Perhaps I am completely on the wrong track and I do not need the subquery at all. I think the problem is quite clear: how can I select the patients based on a list of given phases?</p>\n"},{"tags":["sql","postgresql","cost","explain"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":43,"score":2,"question_id":13240724,"title":"Cost for nested anti loop on Explain Analyze","body":"<p>I am getting the followig output with explain analyze:</p>\n\n<pre><code>Nested Loop Anti Join  (cost=0.00..36.92 rows=83 width=3) (actual time=0.303..1 0.631 rows=83 loops=1)\n-&gt;  Seq Scan on paises p  (cost=0.00..5.46 rows=246 width=3) (actual time=0.0 43..0.336 rows=246 loops=1)\n-&gt;  Index Scan using ciudades_pkey on ciudades c  (cost=0.00..12.92 rows=192 width=3) (actual time=0.038..0.038 rows=1 loops=246)\n      Index Cond: (c.pais_codigo = (p.pais_codigo)::bpchar)\nTotal runtime: 10.897 ms\n(5 rows)\n</code></pre>\n\n<p>I cant understand why is the loop anti join cost 36.92.</p>\n\n<p>In other sites I have seen the formula for the loop: cost of upper scan + upper row * inner cost.</p>\n\n<p>But I am getting a cost of 36.92, so no way.\nHow is the dbmanager resolving this query?</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13253275,"title":"IF ELSE for the conditions of join?","body":"<p>I am using SQL Server.</p>\n\n<p>I have a table <code>item_table</code> like this:</p>\n\n<pre><code>item   age\n--------------    \n1      1 \n1      6 \n2      2    \n</code></pre>\n\n<p>I have the other table <code>price_table</code> like this:</p>\n\n<pre><code>item    pricetype    price\n--------------------------    \n1       O             5\n1       P             6\n1       V             7\n2       O             8\n2       P             9\n2       V             10\n</code></pre>\n\n<p>So, I want to inner join above two tables.</p>\n\n<pre><code>select *\nfrom item_table i\ninner join price_table p\non ...\n</code></pre>\n\n<p>There are some conditions about the <code>on</code>:</p>\n\n<ol>\n<li>if <strong>the average of age</strong> of an item is bigger than <code>3</code>, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P'</code></li>\n<li>If not, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P' or pricetype = 'V'</code></li>\n</ol>\n\n<p>So there are conditions for <code>on</code> conditions.</p>\n\n<p><strong>How can I write the select query?</strong></p>\n\n<p><strong>Edit:</strong>\nI changed the condition to be <strong>average of age</strong>, instead of <code>type</code></p>\n"}]}
{"total":102597,"page":7,"pagesize":100,"questions":[{"tags":["sql","sql-server","performance"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13253522,"title":"Fast SQL Server search on 40M text records","body":"<p>I have a SQL Server 2005 database with a table containing 40 million records. Each record contains a column that stores a comma separated list of keywords. Each keyword is a combination of letters and numbers. The keywords are up to 7 characters long and on average there are 15 keywords per record. The keywords are not unique across rows.</p>\n\n<p>I want to search on full or part of the keyword.</p>\n\n<p>I've created Full text index which shows 328,245,708 unique key count. The search efficiency is fine for queries of 4 or more characters (around <strong>100ms</strong> on the test machine), but too slow for queries that have 3 or less characters (up to <strong>3s</strong> on the test machine).</p>\n\n<p>I've been trying both <code>CONTAINSTABLE</code> and <code>CONTAINS</code> queries of a sort <code>'[query]*'</code> with similar result.</p>\n\n<p>I believe the performance of the short queries is slower, because short words repeat across different records more frequently.</p>\n\n<p>Sorting the results is not crucial, and I've been trying to return <code>TOP X</code> results sorted on Rank from <code>CONTAINSTABLE</code>. This doesn't provide the desired performance.</p>\n\n<p>How can I make this search faster for short queries?</p>\n"},{"tags":["sql","sql-server","query","sql-server-2005"],"answer_count":9,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":76,"score":-1,"question_id":13253445,"title":"Select Part of Column","body":"<p>I was wondering if anyone could help with a query to select part of a column.</p>\n\n<p>The column 'criteriadata' contains data that would look like this:</p>\n\n<blockquote>\n  <p><strong>CriteriaData</strong></p>\n  \n  <p>14 27 15 C</p>\n  \n  <p>14 30 15 DD</p>\n  \n  <p>14 38 15 Pass</p>\n  \n  <p>14 33 15 Pass</p>\n</blockquote>\n\n<p>How can I select just the data that appears after the number 15.</p>\n\n<p>Many thanks.</p>\n"},{"tags":["sql","ado.net","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13253235,"title":"Dataset vs Pure queries","body":"<p>Friends,</p>\n\n<p>I have seen many examples in ADO.NET that load entire data into Dataset, set up relationships, etc., and manipulate data in disconnected manner.  Could someone please cast some light onto the pros and cons of this approach versus reading/writing data as and when required using pure sql queries?  I find in some applications the dataset loading time is too long, especially when there are thousands of records.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13252987,"title":"Inner Join two table-Valued Parameters doesn't work","body":"<p>I am trying to 'inner join' two table values parameters but when i execute the query it takes for ever and i have to stop debug in ms sql server management studio 2008.</p>\n\n<p>The query:</p>\n\n<pre><code>    @allClients [dbo].[ImportedClients] READONLY,\n    @NewClients [dbo].[ImportedClients] READONLY\n\n--Update Clients table in db with new clients\n\n    UPDATE [dbo].[Clients]\n        SET \n\n            Email = ISNULL(ct.Email, x.Email), \n            FirstName = ISNULL(ct.FirstName, x.FirstName), \n            LastName = ISNULL(ct.LastName, x.LastName), \n            Telephone = ISNULL(ct.Telephone, x.Telephone), \n            Cellphone = ISNULL(ct.Cellphone, x.Cellphone), \n\n\n\n        FROM @NewClients ct\n        inner join @allClients x \n        ON (x.Email = ct.Email)     \n\n        WHERE ct.Status &gt; -1 \n</code></pre>\n\n<p>What i am trying to do is: Update all the clients information for rows that exist in both @NewClients and @allClients so i used inner join. \nIs it possible to JOIN two  table-Valued Parameters?\nThis query doesn't (query doesn't complete without an error) work even with a few rows.</p>\n\n<p>any suggestions?</p>\n"},{"tags":["mysql","sql","database","database-design"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13250277,"title":"Designing the database layout for a webshop plugin","body":"<p>I'm working on a webshop plugin for a small Content Management System.</p>\n\n<p>The idea is that a <strong>product</strong> is within a certain <strong>category</strong> (for instance T-shirts). The category determines which <strong>attributes</strong> (for instance Color and Size in case of the T-shirt, or capacity in case of an MP3 player) can apply to the product. Based on those attributes, a product can have multiple <strong>variants</strong>.</p>\n\n<p>In case of the t-shirt, those variants could be:</p>\n\n<ul>\n<li>Small Black</li>\n<li>Medium Black</li>\n<li>Large Black</li>\n<li>Small White</li>\n<li>Medium White</li>\n<li>Large White</li>\n</ul>\n\n<p>This is what I currently have:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FNTlq.png\" alt=\"current database layout\"></p>\n\n<p>Does this make sense? Or can I improve this design?</p>\n\n<p>Second question is, I want to display a list of attributes to provide a way of filtering products. For instance, for attribute Color one should be able to click 'Black', which displays a list of products that</p>\n\n<ul>\n<li>have a row in product_attribute with value 'Black', or</li>\n<li>have a variant with a row in product_variant_attribute with value 'Black'</li>\n</ul>\n\n<p>Would that be possible, and how?</p>\n\n<p>Currently I have the following SQL:</p>\n\n<pre><code>SELECT\n    variant_attr.*,\n    COUNT(DISTINCT prod.id) AS prod_count\nFROM catalog_product_variant_attribute AS variant_attr\nINNER JOIN catalog_product_variant AS variant ON variant.id = variant_attr.variant_id\nINNER JOIN  catalog_product AS prod ON prod.id = variant.product_id\nWHERE variant_attr.attribute_id = 1 AND prod.category_id IN (4,6,7,5,2)\nGROUP BY variant_attr.value ASC\n</code></pre>\n\n<p>1 is the attribute's <code>id</code> and (4,6,7,5,2) are the id's of the current category and all it's children (because if category T-shirts has a parent category Clothing, I want to display all the t-shirts in Clothing as well)</p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13252840,"title":"Select rows which don't have a field specified","body":"<p>I have a table with the following fields:</p>\n\n<pre><code>object_id\nattr_id\nstring_value\n</code></pre>\n\n<p>The object_id refers to an object in another table, as does the attribute id (they are both foreign keys).</p>\n\n<p>So for example I have rows like this:</p>\n\n<pre><code>22, 14, blah\n22, 30, argh\n22, 31, moo\n44, 30, argh\n44, 31, kaw\n</code></pre>\n\n<p>As you can see object 44, does not have attribute 14 set with a value.</p>\n\n<p>What I want to do is select all objects which do not have attribute 14 defined.</p>\n\n<p>Does anyone have any idea how to do this?</p>\n"},{"tags":["ios","sql","phonegap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13253228,"title":"Get resultSet keys in phonegap?","body":"<p>With say 5 fields in the DB, I know the columns that can be queried and use:</p>\n\n<pre><code>function getDetails_success (tx, results) {\n    var len = results.rows.length;\n\n    for (var i=0; i&lt;len; i++) {\n\n        var content = results.rows.item(i);\n        buf += '&lt;tr '+ content.OID+'&gt;';\n        buf += '&lt;tr '+ content.KID+'&gt;';\n    }\n}\n</code></pre>\n\n<p>and so on.</p>\n\n<p>What if I have 50 fields, of which 5 random fields has to be displayed. Do I get the keys from the resultset? What are the various ways I can approach this?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13253259,"title":"SQL Server Replace Command with WIldcard","body":"<p>I am in need of some help. Thanks to fellow user davids, I was able to get certain things working within SQL Server and am in need of some more help. Here is what I am trying to do:</p>\n\n<pre><code>UPDATE Table1 SET keyfield=(REPLACE(REPLACE(Column1,'http://*/folder/',''),'.avi',''))\nUPDATE Table2 SET keyfield=(REPLACE(REPLACE(Column2,'http://server2/folder/',''),'.mpg',''))\n</code></pre>\n\n<p>Can anyone help me out or point me in the right direction to get the wildcard to work? This particular column, the * is an IP Address and it will change all the time. Granted I will know the IP's ahead of time and can probably do it one by one, but I would prefer to have it automatically replace. Thanks in advance!</p>\n"},{"tags":["sql","string","tsql","count","symbols"],"answer_count":3,"favorite_count":2,"up_vote_count":18,"down_vote_count":0,"view_count":12364,"score":18,"question_id":1860457,"title":"How to count instances of character in SQL Column","body":"<p>I have an sql column that is a string of 100 'Y' or 'N' characters. For example: </p>\n\n<blockquote>\n  <p>YYNYNYYNNNYYNY...</p>\n</blockquote>\n\n<p>What is the easiest way to get the count of all 'Y' symbols in each row.</p>\n"},{"tags":["sql","doctrine","left-join"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":113,"score":4,"question_id":12533223,"title":"How to use left join like right join in Doctrine","body":"<p>So I've been racking my brain for a while now. In Doctrine there is no concept of right join. I know that you can use a left join like a right join but I can't figure it out for my example which is why I'm here.</p>\n\n<p>My example:\nI have an entity in Doctrine which has a one-to-one relationship with itself called \"parent\".\nI am trying to get all entities and their children(if they exist) with no duplicates. </p>\n\n<p>With a right join this is simple because I can say: </p>\n\n<pre><code>    SELECT parent.*, child.*\n    FROM table child\n    RIGHT JOIN table parent ON parent.id = child.parent_id\n    WHERE parent.parent_id is null;\n</code></pre>\n\n<p>But using a left join I am returned results that I can not figure out what the where clause should be to filter them out.</p>\n\n<p>So my question is \"Does doctrine have a way of doing right join\" or \"How can I use the left join operation like a right join\"?</p>\n\n<p>---EDIT---</p>\n\n<p>You guys are correct in what you are saying about changing the ordering of tables I select from but I am using Doctrine so the relationship does child->parent. Here is my doctrine query:</p>\n\n<p>My Entity:</p>\n\n<pre><code>/**\n * @Entity\n * @Table(name=\"entity\")\n */\nclass Entity\n{\n...\n/**\n * @OneToOne(\n *     targetEntity=\"Entity\",\n *     fetch=\"EAGER\"\n * )\n * @JoinColumn(name=\"parent_id\", referencedColumnName=\"id\")\n */\nprivate $parent;\n...\n}\n</code></pre>\n\n<p>My doctrine select statement:</p>\n\n<pre><code>$em-&gt;createQueryBuilder()\n-&gt;select(array('child', 'parent'))\n-&gt;from('Entity', 'child')\n-&gt;leftjoin('child.parent', 'parent')\n-&gt;orderBy('parent.id','asc')\n-&gt;getQuery()\n-&gt;execute();\n</code></pre>\n\n<p>I am not sure how and IF I can switch the ordering of tables. I also tried creating another relationship from entity to itself (like the way I did parent) but called it child. But when I updated the db with the new schema doctrine threw errors.</p>\n\n<p>Any ideas? And Thanks for the quick responses!</p>\n\n<p>---EDIT 2---</p>\n\n<p>Left join sql and results:</p>\n\n<pre><code>SELECT child.id, child.changed_timestamp, child.parent_entity_id, parent.id, parent.changed_timestamp, parent.parent_entity_id \nFROM content child \nLEFT JOIN content parent ON child.parent_entity_id = parent.id   \nORDER BY parent.id ASC\n\nchild_id    child_timestamp parent_entity_id    parent_id   parent_timestamp    parent_entity_id\n1   8/16/12 20:29   NULL    NULL    NULL    NULL\n7   9/20/12 16:07   NULL    NULL    NULL    NULL\n8   8/17/12 16:08   NULL    NULL    NULL    NULL\n9   8/17/12 20:44   NULL    NULL    NULL    NULL\n10  8/17/12 21:03   NULL    NULL    NULL    NULL\n11  8/17/12 21:17   NULL    NULL    NULL    NULL\n194 9/19/12 9:58    NULL    NULL    NULL    NULL\n195 9/20/12 10:38   NULL    NULL    NULL    NULL\n196 9/19/12 11:58   NULL    NULL    NULL    NULL\n197 NULL            196 196 9/19/12 11:58   NULL\n200 9/20/12 16:02   1   1   8/16/12 20:29   NULL\n202 9/20/12 16:35   NULL    NULL    NULL    NULL\n204 9/21/12 8:41    NULL    NULL    NULL    NULL\n206 NULL            204 204 9/21/12 8:41    NULL\n</code></pre>\n\n<p>Right join results:</p>\n\n<pre><code>SELECT child.id, child.changed_timestamp, child.parent_entity_id, parent.id, parent.changed_timestamp, parent.parent_entity_id \nFROM content child \nRIGHT JOIN content parent ON child.parent_entity_id = parent.id   \nWHERE parent.parent_entity_id is null\nORDER BY parent.id ASC\n\nchild_id    child_timestamp parent_entity_id    parent_id   parent_timestamp    parent_entity_id\n200 9/20/12 16:02   1   1   8/16/12 20:29   NULL\nNULL    NULL    NULL    7   9/20/12 16:07   NULL\nNULL    NULL    NULL    8   8/17/12 16:08   NULL\nNULL    NULL    NULL    9   8/17/12 20:44   NULL\nNULL    NULL    NULL    10  8/17/12 21:03   NULL\nNULL    NULL    NULL    11  8/17/12 21:17   NULL\nNULL    NULL    NULL    194 9/19/12 9:58    NULL\nNULL    NULL    NULL    195 9/20/12 10:38   NULL\n197 NULL    196 196 9/19/12 11:58   NULL\nNULL    NULL    NULL    202 9/20/12 16:35   NULL\n206 NULL    204 204 9/21/12 8:41    NULL\n</code></pre>\n\n<p>I want to achieve the results with the right join sql. Unique parent entities with their associated children(if they exists) but I need to achieve it using doctrine. Thanks again!</p>\n"},{"tags":["mysql","sql","inner-join"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13253050,"title":"MySQL select row from two tables even though only one table may have the row","body":"<p>I have two tables, <code>posts</code> and <code>pages</code>. The <code>posts</code> table has more columns than the <code>pages</code> table, but other than that they are the same in terms of schema. </p>\n\n<p>If a <code>slug</code> is given, the row with the right <code>slug</code> could exist in the <code>pages</code> table, or the <code>posts</code> table. I was thinking of something like</p>\n\n<pre><code>SELECT * \nFROM pages \nWHERE slug = 'about'\n\nUNION \n\nSELECT * \nFROM posts \nWHERE slug = 'about'\n</code></pre>\n\n<p>but that requires the row with the <code>slug</code> of \"about\" to be in both tables. There's probably a simple <code>INNER JOIN</code> I could use, but my SQL knowledge is limited.</p>\n\n<p>To clarify, I want to be able to search across both tables as if they were one.</p>\n\n<p>Here is the <code>posts</code> table structure:</p>\n\n<pre><code>`slug` varchar(128) NOT NULL,\n`id` varchar(100) NOT NULL,\n`title` text NOT NULL,\n`published` bigint(20) NOT NULL,\n`content` longtext NOT NULL,\n`author` text NOT NULL,\n`status` enum('published','draft','trashed') NOT NULL\n</code></pre>\n\n<p>and the <code>pages</code> structure:</p>\n\n<pre><code>`slug` varchar(128) NOT NULL,\n`id` varchar(100) NOT NULL,\n`title` text NOT NULL,\n`content` longtext NOT NULL,\n`menu_order` int(11) DEFAULT NULL,\n`status` enum('published','drafted','trashed') NOT NULL\n</code></pre>\n"},{"tags":["sql","sql-server-2008","csv"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13252580,"title":"Importing a CSV into SQL when there is a \",\" in the field","body":"<p>I need to import a CSV into a SQL 2008 database.  One of the fields is a directory, and apparently there are over 1600 rows that have a \",\" in the field name.  This field is now broken out incorrectly in my database.  There are over 100000 rows total.</p>\n\n<p>How can I avoid this and modify my statement?</p>\n\n<p>Here is the creation of the table:</p>\n\n<pre><code>create table tablename\n(\nDirectory       varchar(1000),\nName            varchar(1000),\nSize            varchar(50),\nCreationTime    varchar(100),\nLastAccessTime  varchar(100),\nLastWriteTime   varchar(100)\n)\n</code></pre>\n\n<p>Below is the code I used to import it:</p>\n\n<pre><code>BULK\nINSERT tablename\nFROM 'c:\\EmailCSVs\\myfile.csv'\nWITH\n(\nFIRSTROW = 2,\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\nGO\n</code></pre>\n\n<p>An example in the directory field looks like this:</p>\n\n<pre><code>\\\\drive\\share\\nightly.175\\savemail\\user\\(Monday, January 10, 2011, 500 PM)\n</code></pre>\n\n<p>And here is an example row in the CSV:</p>\n\n<pre><code>\"\\\\drive\\share\\nightly.175\\savemail\\user\\(Monday, January 10, 2011, 500 PM)\",\"Archive #1.1.pst\",\"271360\",\"1/14/2011 8:37:05 AM\",\"6/1/2011 12:00:38 AM\",\"1/14/2011 2:45:27 PM\"\n</code></pre>\n"},{"tags":["c#",".net","sql","performance","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13252966,"title":"Fastest Get data from remote server","body":"<p>I'm creating a windows application in which I need to get data using ado.net/(Or any other way using C# if any ). From one table. The database table apparently has around <code>100000</code> records and it takes forever to download.</p>\n\n<p>Is there any faster way where I could get data into faster? </p>\n\n<p>I tried the <code>DataReader</code> but still isn't fast enough. </p>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13252846,"title":"Understanding sql queries fired by ActiveRecord","body":"<p>I have two tables one trip and one txns having one to many relationship in oracle db.\nWhen i fire the below query </p>\n\n<pre><code>Trip.where(\"upper(trips.domain) = 'FOOBAR.COM'  and txns.user_id = 50001 and txns.txn_type = '1'\").includes([:txns]).order('trips.created_at desc').limit(10).offset(0)\n</code></pre>\n\n<p>For this there were two queries in the sql log.</p>\n\n<pre><code>    Trip Load (4920.4ms)   SELECT * FROM (\n    SELECT raw_sql_.*, rownum raw_rnum_\n    FROM (SELECT DISTINCT \"TM\".\"TRIPS\".id, FIRST_VALUE(trips.created_at)\n OVER (PARTITION BY \"TM\".\"TRIPS\".id ORDER BY trips.created_at desc) AS alias_0__ FROM \"TM\".\"TRIPS\" LEFT OUTER JOIN \"TXNS\" ON \"TXNS\".\"TRIP_ID\" = \"TM\".\"TRIPS\".\"ID\"\n WHERE (upper(trips.domain) = 'FOOBAR.COM' and txns.txn_type = '1') \nORDER BY alias_0__ DESC) raw_sql_\n    )\n    WHERE raw_rnum_ between 1 and 10\n\n    SQL (186.2ms)  SELECT \"TM\".\"TRIPS\".\"ID\" AS t0_r0, \"TM\".\"TRIPS\".\"TRIP_REF\" AS t0_r1, \"TM\".\"TRIPS\".\"TRIP_NAME\" AS t0_r2, \n\"TM\".\"TRIPS\".\"START_DATE_TIME\" AS t0_r3, \"TM\".\"TRIPS\".\"END_DATE_TIME\" AS t0_r4, \"TM\".\"TRIPS\".\"AMOUNT\" AS t0_r5, \"TM\".\"TRIPS\".\"CREATED_AT\" AS t0_r6,\n \"TM\".\"TRIPS\".\"UPDATED_AT\" AS t0_r7, \"TM\".\"TRIPS\".\"USER_ID\" AS t0_r8, \n\"TM\".\"TRIPS\".\"BOOKING_STATUS\" AS t0_r9, \"TM\".\"TRIPS\".\"TRAVELLERS\" AS t0_r10, \n\"TM\".\"TRIPS\".\"USER_TRIP_NAME\" AS t0_r11, \"TM\".\"TRIPS\".\"CONTACT_DETAIL_ID\" AS t0_r12, \n\"TM\".\"TRIPS\".\"AIR\" AS t0_r13, \"TM\".\"TRIPS\".\"HOTEL\" AS t0_r14, \"TM\".\"TRIPS\".\"DOMAIN\" AS t0_r15, \"TM\".\"TRIPS\".\"TRAIN\" AS t0_r16, \"TM\".\"TRIPS\".\"TAGS\" AS t0_r17, \"TM\".\"TRIPS\".\"CURRENCY\" AS t0_r18, \"TM\".\"TRIPS\".\"CUR_INR_VALUE\" AS t0_r19, \n\"TM\".\"TRIPS\".\"COMPANY_ID\" AS t0_r20, \"TXNS\".\"ID\" AS t1_r0, \"TXNS\".\"TRIP_ID\" AS t1_r1,\n \"TXNS\".\"USER_ID\" AS t1_r2, \"TXNS\".\"TXN_TYPE\" AS t1_r3, \"TXNS\".\"STATUS\" AS t1_r4, \"TXNS\".\"SOURCE_TYPE\" AS t1_r5, \"TXNS\".\"SOURCE_ID\" AS t1_r6, \"TXNS\".\"EXTERNAL_REFS\" AS t1_r7, \"TXNS\".\"CREATED_AT\" AS t1_r8, \"TXNS\".\"IP_NUMBER\" AS t1_r9, \"TXNS\".\"MISC\" AS t1_r10 FROM \"TM\".\"TRIPS\" LEFT OUTER JOIN \"TXNS\" ON \"TXNS\".\"TRIP_ID\" = \"TM\".\"TRIPS\".\"ID\" WHERE \"TM\".\"TRIPS\".\"ID\" IN (11620660, 11620651, 11620649, 11620647, 11620646, 11620645, 11620644, 11620642, 11620641, 11620636) AND (upper(trips.domain) = 'FOOBAR.COM' and txns.txn_type = '1') ORDER BY trips.created_at desc\n</code></pre>\n\n<p>I want to know why does active record fire two queries</p>\n"},{"tags":["php","mysql","sql","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13247996,"title":"How to group exact Tandem values from 2 column of table?","body":"<p>I have a table with 2 column <code>latitude</code> and <code>longitude</code>.<br>\nsome of data rows have exact match tandem values on 2 columns  .</p>\n\n<pre><code>/* Points Table */\nlat |long\n2.1 |5.8\n2.1 |5.6    -Set as Group\n2.1 |5.6    -Set as Group\n2.1 |5.6    -Set as Group\n2.3 |5.2\n2.4 |5.3\n2.5 |5.3    -Set as Group\n2.5 |5.3    -Set as Group\n2.6 |5.3\n2.5 |5.3\n</code></pre>\n\n<p>I want to set as Group tandem values of 2 columns , for example the result of my SQL Query Like :  </p>\n\n<pre><code>/* Points Table */\nlat |long\n2.1 |5.8\n2.1 |5.6    -Grouped\n2.3 |5.2\n2.4 |5.3\n2.5 |5.3    -Grouped\n2.6 |5.3\n2.5 |5.3\n</code></pre>\n\n<p>How can i do this ?</p>\n"},{"tags":["mysql","sql","group-by","union"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1039,"score":2,"question_id":8572821,"title":"Group by with union mysql select query","body":"<pre><code>(SELECT COUNT(motorbike.`owner_id`) as count,owner.`name`,transport.`type` FROM transport,owner,motorbike WHERE transport.type='motobike'\nAND owner.`owner_id`=motorbike.`owner_id`\nAND transport.`type_id`=motorbike.`motorbike_id` GROUP BY motorbike.owner_id)\nUNION ALL\n(SELECT COUNT(car.`owner_id`) as count,owner.`name`,transport.`type` FROM transport,owner,car WHERE transport.type='car'\nAND owner.`owner_id`=car.`owner_id`\nAND transport.`type_id`=car.`car_id` GROUP BY car.`owner_id`)\n</code></pre>\n\n<p>The query above returns a result like this below,</p>\n\n<pre><code>count          name\n1              Linda\n2              Mary\n1              Steve\n1              Linda\n</code></pre>\n\n<p>This query is to count how many transport that owned by an owner. Linda have one car and one motorcycle,so the result should:</p>\n\n<pre><code>count          name\n2              Linda\n2              Mary\n1              Steve\n</code></pre>\n\n<p>I have tried this query,but return error:</p>\n\n<pre><code>(SELECT COUNT(motorbike.`owner_id`),owner.`name`,transport.`type` FROM transport,owner,motorbike WHERE transport.type='motobike'\nAND owner.`owner_id`=motorbike.`owner_id`\nAND transport.`type_id`=motorbike.`motorbike_id`)\nUNION ALL\n(SELECT COUNT(car.`owner_id`),owner.`name`,transport.`type` FROM transport,owner,car WHERE transport.type='car'\nAND owner.`owner_id`=car.`owner_id`\nAND transport.`type_id`=car.`car_id`)  GROUP BY motorbike.owner_id\n</code></pre>\n\n<p>Can anyone help me please?</p>\n"},{"tags":["sql","sql-server","ssms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13252501,"title":"SQL Server Management Studio print in color","body":"<p>I am using SQL Server Management Studio 2012. I am trying to print a stored procedure in the color-coded syntax that it loves showing me, but cannot find an option to enable this. Any ideas?</p>\n\n<p>I know on VS2010 that we (finally) got color output for text, via an add-in on MS's site, but I cannot seem to locate anything for SQL Server Management Studio via Google. Why am I printing this thing out? Because it's 15 pages long, and I am trying to clean it up.  </p>\n"},{"tags":["mysql","sql","alias","nested-queries","inner-query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13251164,"title":"How to solve unknown alias column issue without using nested queries?","body":"<p>I've the querry</p>\n\n<pre><code>SELECT ID, \n  post_title, \n  post_author,\n  max(case when meta_key='geo_latitude' then meta_value end) latitude,\n  max(case when meta_key='geo_longitude' then meta_value end) longitude,\n ( 3959 * acos( cos( radians(18.204540500000) ) \n                   * cos( radians( latitude ) ) \n                   * cos( radians( longitude ) \n                       - radians(-66.450958500000) ) \n                   + sin( radians(18.204540500000 ) )\n                   * sin( radians( latitude ) ) \n                 )\n   ) AS distance \nFROM `wp_posts` \nLEFT JOIN `wp_postmeta` \n  on ID=post_id \nWHERE post_type='place' \n  AND (meta_key='geo_latitude' OR meta_key='geo_longitude') \nGROUP BY ID, post_title, post_author\nORDER BY ID ASC\n</code></pre>\n\n<p>which results </p>\n\n<pre><code>Error Code: 1054. Unknown column 'latitude' in 'field list'\n</code></pre>\n\n<p>Is there any way to solve this without using inner/nested queries?</p>\n"},{"tags":["php","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":13250975,"title":"PHP SQL No result returned","body":"<p>$block is not being returned. The problem seems to arise during the while statement. I have used this script before, only slightly different, so i know it is something fairly minor. Any help would be greatly appreciated, thanks in advance. </p>\n\n<pre><code>&lt;?php\nif (isset($_GET['filter_tag'])) {\n    $filter_tag = $_GET['filter_tag'];\n}\n\n    if (@mysql_connect('xxxxxxxxx','xxxxxxxxxx','xxxxxxxxxx')) {\n        if (mysql_select_db('xxxxx')) {\n                $query = \" SELECT blocks . CNO, blocks . CName, blocks . URL, images . Ipath FROM blocks LEFT JOIN images ON blocks . INO = images . INO WHERE CNO LIKE 'mysql_real_escape_string($filter_tag)' \";\n        $query_run = mysql_query($query);\n        } while ($query_row = mysql_fetch_assoc($query_run)) {      \n            echo $block =   '&lt;li id=\"'.$query_row['CNO'].'\" class=\"block\" data-toggle=\"modal\" data-target=\"#blocklModal\" &gt;\n        &lt;a href=\"'.$query_row['URL'].'\" target=\"_blank\"&gt;\n        &lt;img class=\"b\" src=\"'.$query_row[\"Ipath\"].'\" alt=\"\" data-controls-modal=\"block-modal\" data-backdrop=\"static\"&gt;\n        &lt;/a&gt;\n        &lt;p class=\"c-title\"&gt;'.$query_row['Name'].'&lt;/p&gt;\n        &lt;/li&gt;';\n        }\n    }\n?&gt;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13252567,"title":"sql - How to selectively select by combining multiple conditions?","body":"<p>I am not sure how to describe my question (maybe title is not proper). </p>\n\n<h2>Here it is:</h2>\n\n<p>I have a table like this:</p>\n\n<pre><code>item   type stockdate    saledate\n\n1      1    2012-11-06   2012-11-05\n\n2      2    2012-11-06   2012-11-07\n\n3      2    2012-11-06   2012-11-05\n</code></pre>\n\n<p>So, I want to select from the above table.</p>\n\n<p>There are two conditions:</p>\n\n<ol>\n<li>if the <code>type</code> of an item is <code>1</code>, then I anyway show this item</li>\n<li>If the <code>type</code> of an item is <code>2</code>, but its <code>saledate &gt;= stockdate</code>, then I show; otherwise, I don't show</li>\n</ol>\n\n<p>So from the above table, I want to <code>show only item 1 and 2</code>, because item 1 has <code>type of 1</code>, item 2 has <code>type of 2</code> but its <code>saledate &gt;= stockdate</code>, item 3 cannot be shown because its <code>saledate&lt;stockdate</code>.</p>\n\n<p><strong>How can I write the select query?</strong></p>\n\n<p>I am using MS SQL Server.</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13252444,"title":"Oracle SQL vs Oracle PL/SQL","body":"<p>I have to learn Oracle SQL for work and am very tempted by the O'Reilly book 'Oracle PL/SQL Programming' as it has been so highly reviewed. However, I am unclear as to whether or not PL/SQL is a different language to SQL or if it is just a superset or if it something else. Can  someone please help me here? Thanks. </p>\n"},{"tags":["php","sql","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13252358,"title":"cursor in sqlsrv_query not working","body":"<p>Given this SQL statement that uses a cursor to loop through each row of a table and update a row in another table:</p>\n\n<pre><code>DECLARE @x varchar(100)\nDECLARE @y varchar(100)\nDECLARE c CURSOR FOR\nSELECT col1, col2 FROM table\nOPEN c\nFETCH NEXT FROM c INTO @x, @y\nWHILE @@FETCH_STATUS = 0\nBEGIN\nUPDATE table2 SET cola = @x WHERE colb = @y\nFETCH NEXT FROM c INTO @x, @y\nEND\nCLOSE c\nDEALLOCATE c;\n</code></pre>\n\n<p>If I run this statement directly within SQL console or Navicat, everything works as expected.  But if I run it in PHP using:</p>\n\n<pre><code>sqlsrv_query($sql)\n</code></pre>\n\n<p>only SOME of the rows in table2 are actually updated.  It seems the cursor in the SQL statement does not properly execute, perhaps sqlsrv_query returns while the statement's cursor is still running?  </p>\n\n<p>Is there a way to instruct sqlsrv_query to 'wait' until the statement is fully done executing before returning a result?</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2000","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2470,"score":1,"question_id":3867164,"title":"SQL update query syntax with inner join","body":"<p>Can anyone find my error in this query?  I'm using SQL Server 2000 and I want to update all entries in the CostEntry table to the corresponding value in the ActiveCostDetails table.  The where clause DOES work with a select statement.</p>\n\n<pre><code>    UPDATE CostEntry CE \nINNER JOIN ActiveCostDetails As AD ON CostEntry.lUniqueID = ActiveCostDetails.UniqueID\n       SET CostEntry.sJobNumber = ActiveCostDetails.JobNumber\n     WHERE CostEntry.SEmployeeCode = '002'\n       AND SubString(CostCentre, 1, 1) = sDepartmentCode\n       AND substring(CostCentre, 3, 1) = sCategoryCode\n       AND substring(CostCentre, 5, 2) = sOperationCode\n</code></pre>\n"},{"tags":["mysql","sql","join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":13252492,"title":"mysql query (combine 2 queries into 1)","body":"<p>I'm pretty new with sql possibilities and need help with the following:\nI have two queries, both of them work correct:</p>\n\n<pre><code> select id, text, gt, gg, status, 'XXX' as xxx, 'ZZZ' as zzz, \n concat(md5(concat('str1', 'str2')), sha1(concat('str1', 'str2'))) as yyy\n from table limit 1;\n</code></pre>\n\n<p>and</p>\n\n<pre><code> SELECT c.id \n FROM table2 c \n LEFT JOIN table3 m ON c.id = m.cid \n WHERE c.channel_type = 2 \n    and (m.mid IN ('2')) ;\n</code></pre>\n\n<p>How I can convert it into one query (with two select statements), while '2' which is used in 'IN' clause in the 2nd query is the 'id' from the 1st query?</p>\n\n<p>thanks in advance!</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13251933,"title":"SQL : Match IN operator with anything","body":"<p>I am trying to build a dynamic query.</p>\n\n<p>This works fine :</p>\n\n<pre><code>$qstring=\"10000, 10001, 10003, 10005\";\n\nSELECT *\nFROM orders\nWHERE order_id in ($qstring);\n</code></pre>\n\n<p>This also works fine when I have no data to match and select.</p>\n\n<pre><code>$qstring=\"\";\n\nSELECT *\nFROM orders\nWHERE order_id in ($qstring);\n</code></pre>\n\n<p>Does something like below exists to match any data? I checked out the pattern matching for SQL but found nothing that could match everything.</p>\n\n<pre><code>$qstring=\"*\";\n\nSELECT *\nFROM orders\nWHERE order_id in ($qstring);\n</code></pre>\n\n<p>Any hints? Thanks!</p>\n"},{"tags":["sql","syntax","db2","spss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13230754,"title":"SPSS syntax to connect to database","body":"<p>I've successfully connected to a IBM DB2 database in SPSS using the connection wizard. However, I haven't found a working method to do this using SPSS syntax. Has anyone any experience with this?</p>\n"},{"tags":["c#","sql","sql-server","database"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13251809,"title":"how to re-order IDs after deleting a row in database","body":"<p>Im using C# to make program that has a sql database, in the database I have a table named <code>Workers</code>, it has an auto increament and Primary key <code>ID_column</code>, when I delete a record the IDs will have a gap between each other.</p>\n\n<p>what should I do re-order the IDs after deleting a record??</p>\n\n<p>UPDATE</p>\n\n<p>what i am going to do is to display the record on the screen after finding it,\nso I tried to do that using the <code>ID</code> but it make some exception because of these gaps !!</p>\n\n<p>UPDATE 2</p>\n\n<p>this is the code I tried to use</p>\n\n<pre><code>private void btnFind_Click(object sender, EventArgs e)\n    {\n        string searchFor = \"\";\n        string searchOn = \"\";\n        string searchString = \"\";\n        int results = 0;\n\n        if (searchTextBox.Text.Trim() == \"\")\n            MessageBox.Show(\"Nothing to search for\");\n\n        if (cb1.Text == \"Last Name\")\n        {\n            searchFor = searchTextBox.Text.Trim();\n            searchOn = \"last_Name=\";\n            searchString = searchOn + \"'\" + searchFor + \"'\";\n        }\n\n        if (cb1.Text == \"Job Title\")\n        {\n            searchFor = searchTextBox.Text.Trim();\n            searchOn = \"job_Title=\";\n            searchString = searchOn + \"'\" + searchFor + \"'\";\n        }\n\n        DataRow[] returnedRows;\n\n        returnedRows = ds1.Tables[\"Workers\"].Select(searchString);\n\n        results = returnedRows.Length;\n\n        if (results &gt; 0)\n        {\n            DataRow dr1;\n\n            dr1 = returnedRows[0];\n            inc = (int)dr1[\"Worker_ID\"]-1;\n\n            NavigateRecords();\n\n        }\n        else\n        {\n            MessageBox.Show(\"No such Record\");\n        }\n\n    }\n</code></pre>\n\n<p><code>inc</code> is the currently displayed record and <code>NavigateRecords()</code> is do display the recored with the giving number <code>inc</code></p>\n\n<pre><code>void NavigateRecords()\n    {\n        DataRow dRow = ds1.Tables[\"Workers\"].Rows[inc];\n\n        textBox1.Text =  dRow.ItemArray.GetValue(1).ToString();\n        textBox2.Text =  dRow.ItemArray.GetValue(2).ToString();\n        textBox3.Text =  dRow.ItemArray.GetValue(3).ToString();\n    }\n</code></pre>\n"},{"tags":["sql","performance","query","postgresql","postgresql-performance"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":83,"score":3,"question_id":13234812,"title":"Improving query speed: simple SELECT in big postgres table","body":"<p>I'm having trouble regarding speed in a SELECT query on a Postgres database.</p>\n\n<p>I have a table with two integer columns as key: (int1,int2)\nThis table has around 70 million rows.</p>\n\n<p>I need to make two kind of simple SELECT queries in this environment:</p>\n\n<pre><code>SELECT * FROM table WHERE int1=X;\nSELECT * FROM table WHERE int2=X;\n</code></pre>\n\n<p>These two selects returns around 10.000 rows each out of these 70 million. For this to work as fast as possible I thought on using two HASH indexes, one for each column. Unfortunately the results are not that good:</p>\n\n<pre><code>                                                               QUERY PLAN                                                               \n----------------------------------------------------------------------------------------------------------------------------------------\n Bitmap Heap Scan on lec_sim  (cost=232.21..25054.38 rows=6565 width=36) (actual time=14.759..23339.545 rows=7871 loops=1)\n   Recheck Cond: (lec2_id = 11782)\n   -&gt;  Bitmap Index Scan on lec_sim_lec2_hash_ind  (cost=0.00..230.56 rows=6565 width=0) (actual time=13.495..13.495 rows=7871 loops=1)\n         Index Cond: (lec2_id = 11782)\n Total runtime: 23342.534 ms\n(5 rows)\n</code></pre>\n\n<p>This is an EXPLAIN ANALYZE example of one of these queries. It is taking around 23 seconds. My expectations are to get this information in less than a second.</p>\n\n<p>These are some parameters of the postgres db config:</p>\n\n<pre><code>work_mem = 128MB\nshared_buffers = 2GB\nmaintenance_work_mem = 512MB\nfsync = off\nsynchronous_commit = off\neffective_cache_size = 4GB\n</code></pre>\n\n<p>Any help, comment or thought would be really appreciated.</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["sql","oracle"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":106,"score":1,"question_id":12564918,"title":"Why Oracle is saying not a GROUP BY expression?","body":"<p>I am Trying to retrive data from the Oracle database table with following conditions </p>\n\n<ol>\n<li>All entries found by zip-code should be grouped, sorted by zip-code descending.</li>\n<li>entries found by city should be grouped, sorted alphabetically.</li>\n<li>All entries found by dealername should be grouped, sorted alphabetically.</li>\n</ol>\n\n<p>To staisfy the above conditions I wrote the query like below</p>\n\n<pre><code> SELECT DISTINCT ba.uuid AS uuid, COUNT(*) over() AS rowcount FROM basicaddress ba \n    WHERE ba.postalcode='143456' OR ba.lastname LIKE '%143456%' OR ba.city LIKE '%143456%'\n    GROUP BY\n            CASE WHEN ba.postalcode='143456' THEN ba.postalcode END \n    ORDER BY \n            CASE WHEN ba.postalcode='143456' THEN ba.postalcode END DESC, \n            CASE WHEN ba.lastname LIKE '%143456%' THEN ba.lastname END ASC, \n            CASE WHEN ba.city LIKE '%143456%' THEN ba.city ELSE ba.postalcode END DESC\n</code></pre>\n\n<p>This query is working fine in MYSQL but in oracle it is saying <em>\"not a GROUP BY expression\"</em></p>\n\n<p>Any help will be greatly appriciated</p>\n"},{"tags":["sql","design"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":45,"score":6,"question_id":13250417,"title":"Is one big domain table considered bad design?","body":"<p>I have to add some features to a web application I'm maintaining, and I have to decide which path to follow to modify the database (Sql Server 2010) in order to store and retrieve the new data the application needs.</p>\n\n<p><em><strong>\"Ugly but fast\"</em> path:</strong><br>\nThe web application already has this \"Generic domain table\" that stores different domains data that can be retrieved and filtered via Stored Procedure, specifying a Domain field.<br>\nSomething like:</p>\n\n<pre><code>| Id         | Description | Domain       |\n|------------|-------------|--------------|\n| 001        |    Apple    |     Fruit    |\n| 002        |    Peach    |     Fruit    |\n| 003        |    Banana   |     Fruit    |\n| A01        |    Yellow   |     Color    |\n| A02        |     Red     |     Color    |\n| A03        |     Green   |     Color    |\n\n\nSP_GetDomainValues @Domain='Fruit'\n</code></pre>\n\n<p>The table already has the application layer to store and retrieve data without effort.<br>\nAll I need is to create a database script to populate the table with the new records I need with the proper new domains.<br>\nI should add that this application has also several domains table each storing just one domain.</p>\n\n<p><em><strong>\"Good but slow\"</em> path:</strong><br>\nI have to create different tables, Stored Procedures and DAL methods to store and retrieve the data.</p>\n\n<p>Personally I like the second approach for these two <a href=\"http://sqlblog.com/blogs/louis_davidson/archive/2010/11/20/one-domain-table-or-many.aspx\" rel=\"nofollow\">main reasons</a>:</p>\n\n<ul>\n<li><p>Using the data in a query is much easier, as you join naturally to\ntables, not subsets of one big table</p></li>\n<li><p>Data can be validated using foreign key constraints very naturally,\nsomething not feasible if you have one table, perhaps named\n“genericDomain”. It isn’t that it isn’t totally possible, it is just\nmessy to use constraints</p></li>\n</ul>\n\n<p>I tend to think that if you don't have some sort of rigid ratio that can help to decide which way to pick, you'll end up to take the quick and dirty path every time.</p>\n\n<p>In your experience, is the first choice a bad design or there are cases where it can be used without feeling too guilty? </p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13251672,"title":"How to return the table using mysql Function","body":"<p>I am using MySQL. I want to return the table using MySQL  function. In SQL its working fine but not in MySQL.    I attach my partial code</p>\n\n<pre><code> DELIMITER $$\n\n    CREATE FUNCTION myFunction() RETURNS @tmptable TABLE (item varchar(20))\n    BEGIN  \n\n        insert  into @tmptable(item) values('raja')     \n\n\n        return\n     END; $$\n</code></pre>\n"},{"tags":["mysql","sql","oracle","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":57,"score":-4,"question_id":13251647,"title":"SQL query to get one distinct row in a table","body":"<p>In my table i am having 20 columns with redundant rows.</p>\n\n<p>What is the SQL query to get only one distinct row. <code>SELECT DISTINCT(COL1) FROM TABLE1;</code> this gives unique record for that column but i want all the rows how to do it??</p>\n"},{"tags":["mysql","sql","query","normalization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13242840,"title":"SQL query - Two tables with relation many to one (Normalization issue)","body":"<p>I have this example tables:</p>\n\n<pre><code>table ORDERS\n\nclient   orderno   cant1   code1   notes1   cant2   code2   notes2   cant[i]   code[i] [...]\n--------------------------------------------------------------------------------------\n1          1        3      AA01    Test      4      BB01    Testing\n2          2        10     XX05    Test      \n\n\n\ntable PRODUCTS\n\ncode   prod    price\n---------------------\nAA01   Engine   100  \nBB01   Wheel     50  \n\n\n\ntable CLIENTS\n\nclient   name      address     telephone\n-----------------------------------------\n  1     Maxwell   24 1st st    0987654321\n  2     Hammer    77 main st   1234567890\n</code></pre>\n\n<p>I need to relate them to get the quantity, name of the product and price for each of the product lines (they are 30 cant[i], code[i] and notes[i]) and the customer's information (name, address, etc)</p>\n\n<p>I found this case, but I don't understand how to apply it to mine: <a href=\"http://stackoverflow.com/questions/9420475/sql-query-two-tables-with-relation-one-to-many\">SQL query two tables with relation one-to-many</a></p>\n\n<p>I hope it's not too complex.</p>\n\n<p>Thanks in advance!</p>\n\n<h1>EDIT</h1>\n\n<p>Thanks to ElectricLlama I realized the problem here is the table where the order is storaged. According to his answer, the normalization of the database would improve the way I'm able to get the info.</p>\n\n<p>For anyone interested in this solution, I found this great website: <a href=\"http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/\" rel=\"nofollow\">http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/</a></p>\n\n<p>This SO answer clears it ALL! Super clear and understandable!\n<a href=\"http://stackoverflow.com/a/1258776/888292\">http://stackoverflow.com/a/1258776/888292</a></p>\n"},{"tags":["sql","sqlite","sqlite3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13250386,"title":"Sqlite - SELECT or INSERT and SELECT in one statment","body":"<p>I'm trying to avoid writing different SQL queries to achieve the following scenario:</p>\n\n<p>I have a Table called Values:</p>\n\n<p>Values:</p>\n\n<pre><code>id INT (PK)\ndata TEXT\n</code></pre>\n\n<p>I would like to check if a certain data exists in the table, if it is return it's id, if it does not exists, then insert it and return it's id.</p>\n\n<p>The (very) naive way would be:</p>\n\n<pre><code>select id from Values where data = \"SOME_DATA\";\n</code></pre>\n\n<p>if id is not null, great use it.\nif id is null then:</p>\n\n<pre><code>insert into Values(data) values(\"SOME_DATA\");\n</code></pre>\n\n<p>and then select it again to see its id or use the returned id.</p>\n\n<p>I am trying to make the above functionality in one line.\nI think i'm getting close, but i couldn't make it yet:\nSo far i got this:</p>\n\n<pre><code>select id from Values where data=(COALESCE((select data from Values where data=\"SOME_DATA\"), (insert into Values(data) values(\"SOME_DATA\"));\n</code></pre>\n\n<p>I'm trying to take advantage of the fact that the second select will return null and then the second argument to COALESCE will be returned. No success so far. What am I missing?</p>\n\n<p>Reminder, this is a sqlite3 engine! :P</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","join"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13251407,"title":"PHP/MYSQL join fieldname in array","body":"<p>I have a query that joins two tables that share a field name.  I want to grab the field name of one, not the other after converting the results into an array using fetch_array.</p>\n\n<p>I feel like I have accomplished this with a simple alias numerous times but this time it is not working.  Can anyone please help me find the error.  Many thanks.</p>\n\n<p>Code is:</p>\n\n<pre><code>$sql = \"SELECT i.*,ic.* FROM `items` i \n  LEFT JOIN `itemcat` ic ON i.id= ic.itemid \n  WHERE (shortdescript LIKE '%%' OR longdescript LIKE '%%') \n    AND ic.catid='23' limit 0,20 \";\n\n$res = mysql_query($sql) or die(mysql_error());  //query executes no problem\nwhile($row = mysql_fetch_array($res)) {\n$id = $row['i.id'];//I do not understand why this is not getting anything.\n$id2 = $row['id'];//returns id but from wrong table.\n\necho $id; //returns blank.  \necho $id2; //returns id of itemcat table when I want id of items table.\n}\n</code></pre>\n"},{"tags":["mysql","sql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13250645,"title":"SQL syntax error - Haversine formula","body":"<p>I'm trying to <a href=\"http://stackoverflow.com/questions/4645490/get-nearest-places-google-maps-mysql-spatial-data/4979891\">get nearest places</a> from a WordPress database using <a href=\"http://en.wikipedia.org/wiki/Haversine_formula\" rel=\"nofollow\">Haversine formula</a></p>\n\n<p>My table structure below</p>\n\n<p><strong>posts</strong></p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| ID           |\n| post_author  |\n| post_title   | \n| post_type    | \n+--------------+\n</code></pre>\n\n<p><strong>postmeta</strong></p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| meta_id      |\n| post_id      |\n| meta_key     |\n| meta_value   |\n+--------------+\n</code></pre>\n\n<p>and have records with <code>meta_key</code> values <code>latitude</code> and <code>longitude</code> </p>\n\n<p>See the <a href=\"http://stackoverflow.com/questions/13249724/selecting-a-join-tables-column-values-as-result-column-name\">answer to my previous question</a> for the SQL I've used to get the latitude and longitude.</p>\n\n<pre><code>SELECT p.ID, \n  p.post_title, \n  p.post_author,\n  max(case when pm.meta_key='latitude' then pm.meta_value end) latitude,\n  max(case when pm.meta_key='longitude' then pm.meta_value end) longitude\nFROM `wp_posts` p\nLEFT JOIN `wp_postmeta` pm\n  on p.ID=pm.post_id \nWHERE p.post_type='place' \n  AND (pm.meta_key='latitude' OR pm.meta_key='longitude') \nGROUP BY p.ID, p.post_title, p.post_author\nORDER BY p.ID ASC\n</code></pre>\n\n<p>Now I want to incorporate above query into <a href=\"http://stackoverflow.com/questions/4645490/get-nearest-places-google-maps-mysql-spatial-data/4979891#4979891\">answer for this question</a></p>\n\n<pre><code>SELECT item1, item2, \n    ( 3959 * acos( cos( radians(37) ) \n                   * cos( radians( lat ) ) \n                   * cos( radians( lng ) \n                       - radians(-122) ) \n                   + sin( radians(37) ) \n                   * sin( radians( lat ) ) \n                 )\n   ) AS distance \nFROM geocodeTable \nHAVING distance &lt; 25 \nORDER BY distance LIMIT 0 , 20;\n</code></pre>\n\n<p>Below is by combined query</p>\n\n<pre><code>SELECT ID, \n  post_title, \n  post_author,\n  max(case when meta_key='latitude' then meta_value end) latitude,\n  max(case when meta_key='longitude' then meta_value end) longitude,\n  ( 3959 * acos( cos( radians(18.204540500000) ) \n                   * cos( radians( latitude ) ) \n                   * cos( radians( longitude ) \n                       - radians(-66.450958500000) ) \n                   + sin( radians(18.204540500000 ) \n                   * sin( radians( latitude ) ) \n                 )\n   ) AS distance \nFROM `wp_posts` \nLEFT JOIN `wp_postmeta` \n  on ID=post_id \nWHERE post_type='place' \n  AND (meta_key='latitude' OR meta_key='longitude') \nGROUP BY ID, post_title, post_author\nORDER BY ID ASC\n</code></pre>\n\n<p>But this yields syntax error </p>\n\n<pre><code>#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS distance FROM `wp_posts` LEFT JOIN `wp_postmeta` on ID=post_id WHERE po' at line 13\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13250851,"title":"how to detect a faulty sequence column with sql?","body":"<p>I have this table</p>\n\n<pre><code>ID  |  Seq  \n------------\n A      1      \n A      2      \n A      3      \n B      1      \n B      2     \n B      3     \n B      3     &lt;--duplicate seq where ID=B\n C      1     \n C      2\n C      4     &lt;--missing seq id number 3\n D      1\n D      2\n .      .\n .      .\n</code></pre>\n\n<p>Is there a way to detect if/when there is an error in the logic of the Seq column, specifically if there are jumps and/or duplicates. </p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13250660,"title":"query the second table with the result of first","body":"<p>I need to bind two tables into a dataset. I have three table named, Students, StudentMarks.</p>\n\n<p>Here if I know the studentId I can query the student table like</p>\n\n<pre><code>DataSet ds=new DataSet();\n\nSqlCommand cmd=new SqlCommand(\"\nSELECT * \nFROM STUDENTS\nWHERE STUDENTID=1; \nSELECT *\nFROM STUDENTS\nWHERE STUDENTID=1\");\n\nSqlDataAdapter da=new SqlDataAdapter(cmd);\nda.Fill(ds);\n</code></pre>\n\n<p>like this. So that I can access these two tables like ds.Table[0] and ds.Table[1].</p>\n\n<p>But my question is, if I dont know the studentid and if I want to query all the students as well as their marks and I've to get these details in two different tables how can I get?</p>\n\n<p>If I join these two tables, the result will be in a single table, I dunno how to do this, can anyone help me out here? thanks in advance.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","guid","entropy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":23,"score":-1,"question_id":13251251,"title":"SQL Server 2008 GUID generation","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3242287/how-are-guids-generated-in-sql-server\">how are GUIDs generated in SQL Server?</a>  </p>\n</blockquote>\n\n\n\n<p>I wonder how SQL Server 2008 GUIDs are generated? Entropy bits</p>\n"},{"tags":["sql","oracle","transitive-closure-table"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":197,"score":3,"question_id":5264637,"title":"How can I speed up queries that are looking for the root node of a transitive closure?","body":"<p>I have a historical transitive closure table that represents a tree.</p>\n\n<pre><code>create table TRANSITIVE_CLOSURE\n  (\n    CHILD_NODE_ID number not null enable,\n    ANCESTOR_NODE_ID number not null enable,\n    DISTANCE number not null enable,\n    FROM_DATE date not null enable,\n    TO_DATE date not null enable,\n    constraint TRANSITIVE_CLOSURE_PK unique (CHILD_NODE_ID, ANCESTOR_NODE_ID, DISTANCE, FROM_DATE, TO_DATE)\n  );\n</code></pre>\n\n<p>Here's some sample data:</p>\n\n<pre><code>CHILD_NODE_ID | ANCESTOR_NODE_ID | DISTANCE \n--------------------------------------------\n1             | 1                | 0\n2             | 1                | 1\n2             | 2                | 0\n3             | 1                | 2\n3             | 2                | 1\n3             | 3                | 0\n</code></pre>\n\n<p>Unfortunately, my current query for finding the root node causes a full table scan:</p>\n\n<pre><code>select *\nfrom transitive_closure tc\nwhere \n  distance = 0\n  and not exists (\n  select null\n  from transitive_closure tci\n  where tc.child_node_id = tci.child_node_id\n    and tci.distance &lt;&gt; 0\n);\n</code></pre>\n\n<p>On the surface, it doesn't look too expensive, but as I approach 1 million rows, this particular query is starting to get nasty... especially when it's part of a view that grabs the adjacency tree for legacy support.</p>\n\n<p>Is there a better way to find the root node of a transitive closure? I would like to rewrite all of our old legacy code, but I can't... so I need to build the adjacency list somehow.  Getting everything except the root node is easy, so is there a better way?  Am I thinking about this problem the wrong way?</p>\n\n<p>Query plan on a table with 800k rows.</p>\n\n<pre><code>OPERATION                                  OBJECT_NAME        OPTIONS         COST \nSELECT STATEMENT                                                              2301 \n  HASH JOIN                                                   RIGHT ANTI      2301 \n    Access Predicates\n      TC.CHILD_NODE_ID=TCI.CHILD_NODE_ID \n    TABLE ACCESS                           TRANSITIVE_CLOSURE FULL            961 \n      Filter Predicates \n        TCI.DISTANCE = 1 \n    TABLE ACCESS                           TRANSITIVE_CLOSURE FULL            962 \n      Filter Predicates \n        DISTANCE=0\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","join","duplicate-removal"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13250247,"title":"Join Tables SQL Server with duplicates","body":"<p>I have a table </p>\n\n<pre><code>col1\n\n1\n2\n</code></pre>\n\n<p>and other table </p>\n\n<pre><code>col1    col2    col3\n\n1          1    data value one                                    \n1          2    data value one                                    \n2          3    data value two   \n</code></pre>\n\n<p>and I want to join both tables to obtain the following result</p>\n\n<pre><code>col1  col2  col3\n\n1       1    data value one\n2       3    data value two\n</code></pre>\n\n<p>The second table have duplicates but I need to join only one (randomly). I've tried with Inner Join, Left Join, Right Join and always returns all rows. Actually I use <code>SQL Server 2008</code>.</p>\n"},{"tags":["sql","vb.net","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":530,"score":3,"question_id":12007723,"title":"insert date and time into acces with SQL visual basic","body":"<p>I am trying to use SQL in visual basic to insert Date and Time value into Access 2007 running in Access2002/3 mode. Using my code I have managed to insert text strings and numerical values into the table. However for the DateTime field get a syntax error. The field in Access is set as a Date/Time field type.</p>\n\n<p>Below is my first function which generates the queries for the Database Accessing function:</p>\n\n<pre><code>Public Function NewUpload(ByVal UploadType As String) As Single\n\n    Dim UploadNumber As Single\n    Dim ColumnString As String\n    Dim ValueString As String\n\n    If DatabaseConnection(\"SELECT ID_UPL FROM tabUpload\", \"Read Recordset\") = \"Error\" Then GoTo close\n    Do Until rdrOLEDB.Read = False\n        If Val(rdrOLEDB.Item(0).ToString()) &gt; UploadNumber Then UploadNumber = Val(rdrOLEDB.Item(0).ToString())\n    Loop\n    rdrOLEDB.Close()\n    cnnOLEDB.Close()\n\n    UploadNumber = UploadNumber + 1\n\n    'Update Uploads table:\n    ColumnString = \"ID_UPL,DateTime,IDUser,DataCalc\"\n    ValueString = Format(UploadNumber, \"0000\") &amp; \",#\" &amp; Now.ToLongDateString &amp; \" \" &amp; Now.ToLongTimeString &amp; \"#,'\" &amp; My.User.Name &amp; \"','\" &amp; UploadType &amp; \"'\"\n    If DatabaseConnection(\"INSERT INTO tabUpload(\" &amp; ColumnString &amp; \") VALUES(\" &amp; ValueString &amp; \")\", \"Non-Query\") = \"Error\" Then GoTo Close\n\n    NewUpload = UploadNumber\n</code></pre>\n\n<p>Close:\n        cnnOLEDB.Close()</p>\n\n<pre><code>End Function\n</code></pre>\n\n<p>Here is the second Function which connects to the Database</p>\n\n<pre><code>Public Function DatabaseConnection(ByVal Query As String, ByVal Task As String) As String\n    'On Error GoTo Err\n\n    cnnOLEDB.ConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; DataDirectoryName &amp; DatabaseFileName\n    cmdOLEDB.Connection = cnnOLEDB\n    cmdOLEDB.CommandText = Query\n    cnnOLEDB.Open()\n\n    Select Case Task\n        Case \"Read Recordset\"\n            rdrOLEDB = cmdOLEDB.ExecuteReader()\n            DatabaseConnection = \"Read Recordset\"\n        Case \"Read Scalar\"\n            DatabaseConnection = Str(cmdOLEDB.ExecuteScalar)\n        Case \"Non-Query\"\n            DatabaseConnection = Str(cmdOLEDB.ExecuteNonQuery())\n            DatabaseConnection = \"Non-Query\"\n    End Select\n\n    Exit Function\nErr:\n    MsgBox(\"Database connection error.\")\n    DatabaseConnection = \"Error\"\n\nEnd Function\n</code></pre>\n\n<p>When I run this code I get the Query:\n<code>INSERT INTO tabUpload(IDUPL, DateTime, User, DataCalc) VALUES(0003, #17 August 2012 14:23:27#, 'UK\\Pej', 'Calc')\"</code></p>\n\n<p>I have also tried several variations of DateTime using format and now(Year) giving yyyy-mm-dd etc.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["sql","sql-server","xml","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13249503,"title":"SQL XML query from column","body":"<p>How to select file names from this kind of XML in a SQL Server column?</p>\n\n<ol>\n<li><p>file name is in attribute <code>VALUE</code> only if high level tag is object with name <code>File</code>\nlike this</p>\n\n<pre><code>&lt;Object NAME=\"File\"&gt;\n    &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n&lt;/Object&gt;\n</code></pre></li>\n<li><p>This sub-hierarchy can be placed on any level of xml (see example below)</p></li>\n<li><p>XML column can contain 0-N file names, I need list like this:</p>\n\n<pre><code>id, filename\n--- ------------------------\n 1  \\\\mysvr\\fiels\\readme1.txt\n 1  \\\\mysvr\\fiels\\readme2.txt\n 2  \\\\mysvr\\fiels\\readme3.txt\n 2  \\\\mysvr\\fiels\\readme4.txt\n</code></pre></li>\n</ol>\n\n<p>Example of XML contents:</p>\n\n<pre><code>declare @t1 table\n(   id int,\n   x XML\n)\n\ninsert into @t1 (id, x)\nselect 1,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n   &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n&lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"10\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme2.txt\" /&gt;\n&lt;/Object&gt;\n&lt;Object NAME=\"bitmap\"&gt;\n              &lt;Parameter ID=\"11\" NAME=\"my1\" VALUE=\"bmp\" /&gt;\n&lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\nunion \nselect 2,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"13\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme3.txt\" /&gt;\n  &lt;/Object&gt;\n  &lt;Object NAME=\"Font\"&gt;\n              &lt;Parameter ID=\"22\" NAME=\"Tahoma\" VALUE=\"11\" /&gt;\n  &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"14\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme4.txt\" /&gt;\n  &lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13249936,"title":"Add a column to a table with a default value equal to the value of an existing column","body":"<p>How to add a column to a SQL Server table with a default value that is equal to value of an existing column?</p>\n\n<p>I tried this but its giving an error </p>\n\n<blockquote>\n  <p><em>The name \"oldcolumn\" is not permitted in this context. Valid\n  expressions are constants, constant expressions, and (in some\n  contexts) variables. Column names are not permitted.</em></p>\n</blockquote>\n\n<p>T-SQL statement:</p>\n\n<pre><code>ALTER TABLE tablename \nADD newcolumn type NOT NULL DEFAULT (oldcolumn) \n</code></pre>\n"},{"tags":["mysql","sql","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":13247632,"title":"postgresql query to mysql","body":"<p>I want create query in MySQL similiar to PostgreSQL below:</p>\n\n<pre><code>CREATE FUNCTION check_unique_pair(IN id1 INTEGER, IN id2 INTEGER) RETURNS INTEGER AS   $body$\nDECLARE retval INTEGER DEFAULT 0;\nBEGIN \n SELECT COUNT(*) INTO retval FROM (\n  SELECT * FROM edges WHERE a = id1 AND b = id2\n  UNION ALL\n  SELECT * FROM edges WHERE a = id2 AND b = id1\n)  AS pairs;\nRETURN retval;\nEND\n$body$\nLANGUAGE 'plpgsql';\n\nALTER TABLE edges ADD CONSTRAINT unique_pair CHECK (check_unique_pair(a, b) &lt; 1);\n</code></pre>\n\n<p>I am new to MySQL.</p>\n"},{"tags":["sql","join","doctrine2","dql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13137908,"title":"What is the difference between JOIN ON and JOIN WITH in Doctrine2?","body":"<p>What is the difference between JOIN ON and JOIN WITH in Doctrine2?</p>\n\n<p>I couldn't find any relevant info in the manual.</p>\n"},{"tags":["mysql","sql","datetime","time"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13250531,"title":"Retrieve time from MySQL as HH:MM format","body":"<p>I used <code>DATETIME</code> datatype to store date and time in my Database.  It saved date as  </p>\n\n<pre><code>YY-MM-DD HH:MM:SS (2012-11-06 10:45:48)  \n</code></pre>\n\n<p>I can retrieve the time from database as <code>HH:MM:SS</code> format but I want to retrieve it in <code>HH:MM</code> format.  </p>\n\n<p>How can I do this?</p>\n"},{"tags":["mysql","sql","wordpress","join","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13249724,"title":"Selecting a join table's column values as result column name","body":"<p>I've a WordPress database with following tables</p>\n\n<p>posts</p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| ID           |\n| post_author  |\n| post_title   | \n| post_type    | \n+--------------+\n</code></pre>\n\n<p>postmeta</p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| meta_id      |\n| post_id      |\n| meta_key     |\n| meta_value   |\n+--------------+\n</code></pre>\n\n<p>and have records with <code>meta_key</code> values <code>latitude</code> and <code>longitude</code> </p>\n\n<p>How can I write SQL to show <code>latitude</code> and <code>longitude</code> as result column names?</p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| ID           |\n| post_author  |\n| post_title   |\n| latitude     |\n| longitude    | \n+--------------+\n</code></pre>\n\n<p>Below query is my starting point</p>\n\n<pre><code>SELECT ID, post_title, meta_key, meta_value FROM `wp_posts` \nLEFT JOIN `wp_postmeta` on ID=post_id \nWHERE post_type='place' AND (meta_key='latitude' OR meta_key='longitude') \nORDER BY ID ASC\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":41,"score":0,"question_id":13248598,"title":"SQL join clause to return rows with more than one occurrence without grouping","body":"<p>I want to extract the records which appear more than once from a JOIN query, but without them getting grouped.</p>\n\n<p>Example tables:</p>\n\n<pre><code>tbl_names\nid    Name\n1     Mark\n2     John\n3     Jane\n4     Paul\n\ntbl_locations\nid    Location\n1     Berlin\n2     Frankfurt\n2     Stockholm\n3     Helsinki\n3     Madrid\n3     London\n4     Paris\n</code></pre>\n\n<p>ID is a foreign key.</p>\n\n<p>Now, the result of the query would be:</p>\n\n<pre><code>id     Name    Location\n2      John    Frankfurt\n2      John    Stockholm\n3      Jane    Helsinki\n3      Jane    Madrid\n3      Jane    London\n</code></pre>\n\n<p>i.e. all JOIN records in which the record in the first table appears more than once in the JOIN clause result.</p>\n\n<p>I can get it grouped of course:</p>\n\n<pre><code>SELECT tbl_names.id, tbl_names.Name, tbl_locations.Location FROM tbl_names\n INNER JOIN tbl_locations ON (tbl_names.id = tbl_locations.id)\n GROUP BY tbl_names.id\n HAVING COUNT(tbl_names.id) &gt; 1\n</code></pre>\n\n<p>What I want is to have them not grouped at all. I have tried with a sub-clause and <code>NOT IN</code> but it is extremely slow and doesn't give me the results I want.</p>\n\n<p>Any enlightenment will be welcome.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13249974,"title":"Removing intermediate table","body":"<p>Given the following tables:</p>\n\n<pre><code>Table1\n| id | intermediate_id |\n\nItermediate\n| id |\n\nTable2\n| id | intermediate_id | table1_id|\n</code></pre>\n\n<p><strong>How do i update Table2 with Table1.ids?</strong></p>\n\n<p>I'm trying the following: </p>\n\n<pre><code>update Table2\nset table1_id = \n(select table1.id \n from table1\n where table1.intermediate_id = table2.intermediate_id);\n</code></pre>\n\n<p>which gives me \"ERROR:  more than one row returned by a subquery used as an expression\"</p>\n"},{"tags":["sql","sql-server","oracle","common-table-expression"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":45,"score":4,"question_id":13153819,"title":"how to select only row with max sequence without using a subquery?","body":"<p>I'm trying to select only the row with the highest seq for each ID</p>\n\n<pre><code>ID  |  Seq   |  Age\n-------------------\n A      1       20   \n A      2       30\n B      1       25\n B      2       32\n B      3       44\n B      4       48\n C      1       11\n</code></pre>\n\n<p>This appears to work</p>\n\n<pre><code>SELECT ID, Age\nFROM Persons a\nWHERE Seq = (SELECT MAX(Seq) FROM Persons b WHERE a.ID = b.ID)\n</code></pre>\n\n<p>But is this the best way, the only way? I don't like using subqueries if I don't have to and I recall you can use something but I forget what it is. Any idea?</p>\n"},{"tags":["sql","sql-server","xml"],"answer_count":2,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":16678,"score":8,"question_id":869405,"title":"SQL Server: How to get hold of XML attributes in a query?","body":"<p>I'm currently trying to get all of the attributes from some XML with an SQL query.</p>\n\n<p>I've been attempting the following to retrieve it, but I must be missing something rather fundamental.</p>\n\n<pre><code>DECLARE @T varchar(max) \nSET @T = \n'&lt;root&gt;\n    &lt;Field FieldRowId=\"1000\"&gt;\n\t&lt;Items&gt;\n\t\t&lt;Item Name=\"CODE\"/&gt;\n\t\t&lt;Item Name=\"DATE\"/&gt;\n\t&lt;/Items&gt;\n    \t&lt;Attributes&gt;\n\t\t&lt;Attribute ID =\"1\"/&gt;\n    \t&lt;/Attributes&gt;\n    &lt;/Field&gt;\n    &lt;Field FieldRowId=\"2000\"&gt;\n\t&lt;Items&gt;\n                &lt;Item Name=\"CODE\"/&gt;\n                &lt;Item Name=\"DATE\"/&gt;\n\t&lt;/Items&gt;\n\t&lt;Attributes&gt;\n\t\t&lt;Attribute ID =\"2\"/&gt;\n\t&lt;/Attributes&gt;\n    &lt;/Field&gt;\n&lt;/root&gt;'\n\nDECLARE @X xml\n\nSET @X = CAST(@T as xml)\nSELECT Y.ID.value('@FieldRowId', 'int') as FieldID, \n   Y.ID.value('/Items/@Name', 'varchar(max)') as \"Name\",\n   Y.ID.value('/Attributes/@ID', 'int') as AttributeID\nFROM @X.nodes('/root/Field') as Y(ID)\n</code></pre>\n"},{"tags":["c#","sql","sql-server","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":13249220,"title":"Using text SQL with LINQ","body":"<p>I'm currently having issues with using LINQ to SQL for my project. This is because most of the lengthy SQL queries (or <em>views</em>, rather) are hard-coded into C#, and what we've been doing all along is to use <code>context.Database.SqlQuery&lt;ClassName&gt;(sql, sqlParams)</code>.</p>\n\n<p>It's been generally very effective, but right now we need something more dynamic. We need to plug in stuff like <code>.Where(x =&gt; x.Name.Contains(\"Anonymous\")).Take(20)</code> or something else along the lines. However, plugging in directly to the previously mentioned line of code would result in the following:</p>\n\n<p><code>context.Database.SqlQuery&lt;ClassName&gt;(sql, sqlParams).Where(x =&gt; x.Name.Contains(\"Anonymous\")).Take(20);</code></p>\n\n<p>While it actually works and pulls the top 20 records where the name contains \"Anonymous\", the performance is pretty bad. What it does behind the scenes is to take all the records from that table and then finally filtering them after having loaded them to memory.</p>\n\n<p>I would then like to ask, is there any way to translate the text SQL to LINQ, or translate the LINQ to SQL, such that I can execute both my text SQL and LINQ in one single statement. If you don't actually have a solution, I'd gladly appreciate suggestions too...!</p>\n\n<p><strong>EDIT:</strong> I've considered using Expression Trees, but I'm not sure how they can actually fit into the picture. Also, I've considered using database views. But there are so many views (quite a number per table) it would definitely be a hassle to port everything over to MS SQL and then rewriting all the querying logic.</p>\n"},{"tags":["sql","query","group","wise","sub-query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13245223,"title":"SQL Inner/Sub group wise Query for a specific scenario","body":"<p>I have a table as below</p>\n\n<blockquote>\n  <p>Schema: ID | Category | Keyword | Bid Price</p>\n</blockquote>\n\n<p>Write a sql to fetch out top 5 keywords based on the bid price per category.</p>\n\n<p>Details:</p>\n\n<p>Table definition considered on oracle 10.x:</p>\n\n<pre><code>create table test (\n    ID number,\n    Category varchar (20),\n    Keyword varchar (20),\n    BidPrice number\n);\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>insert into test values (1, 'Category-A', 'Keyword-A1', 110);\ninsert into test values (2, 'Category-A', 'Keyword-A2', 121);\ninsert into test values (3, 'Category-A', 'Keyword-A3', 130);\ninsert into test values (4, 'Category-A', 'Keyword-A4', 125);\ninsert into test values (5, 'Category-A', 'Keyword-A5', 115);\ninsert into test values (6, 'Category-A', 'Keyword-A6', 133);\ninsert into test values (7, 'Category-B', 'Keyword-B1', 105);\ninsert into test values (8, 'Category-B', 'Keyword-B2', 111);\ninsert into test values (9, 'Category-B', 'Keyword-B3', 108);\ninsert into test values (10, 'Category-B', 'Keyword-B4', 128);\ninsert into test values (11, 'Category-B', 'Keyword-B5', 144);\ninsert into test values (12, 'Category-B', 'Keyword-B6', 101);\ninsert into test values (13, 'Category-C', 'Keyword-C1', 150);\ninsert into test values (14, 'Category-C', 'Keyword-C2', 137);\ninsert into test values (15, 'Category-C', 'Keyword-C3', 126);\ninsert into test values (16, 'Category-C', 'Keyword-C4', 121);\ninsert into test values (17, 'Category-C', 'Keyword-C5', 112);\ninsert into test values (18, 'Category-C', 'Keyword-C6', 118);\n</code></pre>\n\n<p><strong>Output expected:</strong></p>\n\n<pre><code>KEYWORD        CATEGORY        BIDPRICE\n-------------- --------------- ----------\n</code></pre>\n\n<blockquote>\n  <p><br>Keyword-A6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;133\n  <br>Keyword-A3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;130\n  <br>Keyword-A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;125\n  <br>Keyword-A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-A5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;115\n  <br>Keyword-B5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;144\n  <br>Keyword-B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;128\n  <br>Keyword-B2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;111\n  <br>Keyword-B3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;108\n  <br>Keyword-B1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;105\n  <br>Keyword-C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;150\n  <br>Keyword-C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;137\n  <br>Keyword-C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;126\n  <br>Keyword-C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-C6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;118\n  <br></p>\n</blockquote>\n\n<p><em>Note:  Answer has to be only in SQL without use of any Oracle or database specific function.</em></p>\n"},{"tags":["sql","select","asp-classic"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13249492,"title":"Select statement to check multiple rows against 2 variables","body":"<p>I have the following table :</p>\n\n<pre><code>alertID inspectorID datelive                dateread\n1       none       2012-11-06 10:36:03.350  NULL\n2       none       2012-11-06 10:36:25.043  NULL\n3       none       2012-11-06 10:36:42.433  NULL\n1       31030      2012-11-06 10:37:19.193  2012-06-11 10:34:47.000\n</code></pre>\n\n<p>I want to select the alerts that dont have the inspectors ID against it AND where the alert ID doesn't match the one that has the inspectorID against it, ie inspector has read alert 1 so i only want it to return alerts 2 &amp; 3</p>\n\n<p>Am using Classic ASP and MS-SQL</p>\n"},{"tags":["sql","tsql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13249308,"title":"T-SQL Unpivot with column values","body":"<p>I have a table like below:</p>\n\n<blockquote>\n  <h2>Check |  Bill Total  | D1 | D2 | D3 | D4 | D5 |</h2>\n\n<pre><code>1              100       10           2\n2               50       10                   5    7\n</code></pre>\n</blockquote>\n\n<p>D1 - D5 stands for different discount type, how can I get to the following?</p>\n\n<blockquote>\n  <h2>Check |  Bill Total  | Discount Type | Discount |</h2>\n\n<pre><code>1        100            D1             10\n1        100            D3              2\n2        100            D1             10\n2        100            D4              5\n2        100            D5              7\n</code></pre>\n</blockquote>\n\n<p>Many Thanks.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13248976,"title":"How to insert, update, delete when import data from table to table?","body":"<p>I have a query that I need to run more than once a day. This query is importing data from a database to another. </p>\n\n<p>The target table structure is:  </p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2\n</code></pre>\n\n<p>An application can also insert data to the target table. The records that are inserted by the application may not be updated also when this record exists in the source(temp table) table with another state.</p>\n\n<p>To make this possible I have an solution created. I will create an new column in the target table with a second state so that I can check.</p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State   StateSource\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2       2\n</code></pre>\n\n<p>Some Requirements:</p>\n\n<p>If a record is added by the application than StateSource will be NULL. Means that this record may not be deleted, updated or inserted again from the source table.</p>\n\n<p>If a Record is updated by the application than the value State and StateSource will be different. In this case I do not update this record.</p>\n\n<p>I will update if the state from the sourcetable and targettable are not same and the values from target table State = StateSource.</p>\n\n<p>I will INSERT a record when this is not exists in the target table. When records already exists do not insert (no matter if this is added by the application or my query on the first run).</p>\n\n<p>I will delete the records from the target when they are no more exists in my sourcetable and State=StateSource.</p>\n\n<p>I already have the following queries. I have decided to make 3 statements.</p>\n\n<pre><code>--Delete Statement first\nDelete from t\nfrom TargetTable t LEFT JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\nand t.State=t.StateSource\n\n--Just delete if a date is no more exists from the source table and this records is NOT\n--changed by the application (t.State=t.StateSource)\n\n\n--Update statement second\nUpdate t\nset t.State = s.State\nFrom Targettable t INNER JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\n\nThe problem here is:\n--when I have State 2 already in the targettable and in my sourcetable i have\n--another state then the state in the targettable changes. This would not be the case.\n\n\n--Insert Statement thirth\n\ninsert into TargetTable (Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource)\nselect Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource\nfrom SourceTable s \nWHERE Date not in (select Date \n                   from TargetTable t \n                   where t.id=s.id \n                   and t.PersonId=s.PersonId\n                   and t.date=s.date\n                   and t.department=s.department)     \n\n--I have no idea about how the insert should be because the application also can\n--insert records. When a record exists then no insert. What to do with the State?\n</code></pre>\n\n<p>Remember that the states that are changed by the application are leading.</p>\n\n<p>Can anyone help me with the desired result? </p>\n"},{"tags":["sql","indexes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13249042,"title":"Find out which indexes have been created using ONLINE = ON","body":"<p>Please could someone let me know if there is a way to identify which indexes have been created using the <code>ONLINE = ON</code> statement</p>\n\n<pre><code>CREATE INDEX idx_Table\nON MyTable (MyColumn)\nWITH (ONLINE = ON)\n</code></pre>\n\n<p>On of our system suppliers requested that we upgrade our installation from Standard to Enterprise edition to support online indexes.  The work has been completed and the new database implemented but would like to identify the online indexes.</p>\n"},{"tags":["sql","database","query","postgresql","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13249348,"title":"Extrude 2d polygon into 3d polygon","body":"<p>I am using postgresql and I have a table containing 2d polygons. Now my question is how can I extrude this polygon into a nice 3d building.? </p>\n\n<p>Can anyone help please? because I couldn't find a good tutorial on it.</p>\n\n<p>Many thanks</p>\n"},{"tags":["sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13248614,"title":"Providing a join count and total count in the same query with Active Record","body":"<p>One <strong>style</strong> has many <strong>reviews</strong>.</p>\n\n<p>Let's say I am doing: </p>\n\n<pre><code>Style.select('styles.id').\n    joins(:reviews).\n    select('reviews.style_id, count(reviews.id) AS review_count')\n</code></pre>\n\n<p>... but I also want to know the total number of reviews! Is it possible to pull that information as well. I tried count(*) as total_reviews, but this still returns the review count per style.</p>\n"},{"tags":["java","mysql","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13248737,"title":"Java Hibernate constant in sql-query","body":"<p>Below is the original content of a hibernate sql query I have:</p>\n\n<pre><code>&lt;sql-query name=\"countryOfOrigin-limit-country-city-location\"&gt;\n&lt;return alias=\"rb\" class=\"RecentBooking\"/&gt;\n    SELECT \n        bb.reserv_num as {rb.reservNum}, \n        bb.origin as {rb.countryOfOrigin}, \n        bb.pick_up_loc as {rb.locationId}, \n        bb.first_date as {rb.bookingDate}, \n        bb.pick_up_time as {rb.pickUpDate}, \n        bb.drop_off_time as {rb.dropOffDate},  \n        bb.car_price as {rb.carPrice}, \n        bb.discount as {rb.discount}, \n        bb.exchange_rate as {rb.exchangeRate},\n        SUBSTRING(a.internal_class,1,1)as {rb.carClass},\n        a.car_type as {rb.carType}, \n        bb.vehicle_type as {rb.vehicleType}, \n        s.name as {rb.supplier}, \n        vv.country as {rb.country}, \n        vv.city as {rb.city}, \n        vv.location as {rb.location}, \n        bb.cur as {rb.currency}, \n        a.pics as {rb.carImage}\n    FROM (SELECT * FROM b  WHERE first_date &gt; DATE(NOW()-1)AS bb  \n    JOIN a a ON a.id = bb.car_id\n    JOIN d  d ON d.id = bb.pick_up_loc\n    JOIN supplier s ON s.id = d.supplier_id\n    JOIN v_location_trans vv ON vv.location_id = d.location_id\n    AND vv.lang=33\n    AND vv.country = :country\n    AND vv.city = :city\n    AND vv.location = :location\n    AND bb.origin = :countryOfOrigin\n    ORDER BY bb.id DESC\n    LIMIT :limit\n&lt;/sql-query&gt;\n</code></pre>\n\n<p>The sql runs fast enough, but as you might have noticed there is a big, the NOW()-1 should be NOW() - INTERVAL 1 DAY.</p>\n\n<p>I modified the nested select statement as follows:</p>\n\n<pre><code>FROM (SELECT * FROM b WHERE first_date &gt; DATE(NOW() - INTERVAL 1 DAY)) AS bb\n</code></pre>\n\n<p>The fix works fine in terms of results, however the query slows down massively (pretty much almost instant up to a few seconds).</p>\n\n<p>I believe this is because the DATE(NOW() - INTERVAL 1 DAY) is being evaluated a large number of times (we have a very large data set). How would I go about seperating this calculation so that it only occurs once, without having to pass it in from java code like the country, city, limit, etc?</p>\n\n<p>I have very little experience with hibernate or SQL, and I have tried seperating the calculation out into a variable before the select statement, which isnt allowed. I have also tried making small changes to the SQL query but I keep getting runtime errors, presumably due to invalid SQL.</p>\n\n<p>How would I go about doing this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":13249048,"title":"Relational SQL query","body":"<p>There are two tables which have a relation via a distinct so called PK.</p>\n\n<pre><code>Email     Gender  \na@a.cn    12345  \nb@b.cn    12365\n\nPK     String    \n12345  MALE  \n12365  FEMALE\n</code></pre>\n\n<p>What would a query look like to get E-Mail and the String of the gender? </p>\n\n<pre><code> select \n  user.Email,\n  users.Gender\nfrom\n  users,\nvalues\n</code></pre>\n"},{"tags":["sql","asp.net-mvc-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13234449,"title":"Displaying SQL view with Left Outer Join in MVC3","body":"<p>I'm using a simple view which is a left outer join on two tables to get the CATEGORY name that each FEE would fall under and group them for display.  When I simply run the view and iterate through the items it repeats the items like it isn't using the same view.  </p>\n\n<pre><code>    @foreach (var category in Model.FeeScheduleRates())\n{\n    &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n    foreach (var item in Model.FeeScheduleRates())\n    {                                  \n\n    &lt;tr&gt; \n        &lt;td&gt;@item.Fee_Title - @item.Description&lt;/td&gt;\n        &lt;td&gt;@item.Amount&lt;/td&gt;                                        \n    &lt;/tr&gt;\n    }                                   \n}\n</code></pre>\n\n<p>So I changed my approach to a while loop for the second set of items, but that brought on OUT OF MEMORY errors and doesn't seem to work.  </p>\n\n<pre><code>@foreach (var category in Model.FeeScheduleRates())\n{   \n    &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n    var cid = category.Cat_ID;                             \n    while (category.Cat_ID == cid)\n    {\n         &lt;tr&gt; \n            &lt;td&gt;@category.Fee_Title - @category.Description&lt;/td&gt;\n            &lt;td&gt;@category.Amount&lt;/td&gt;                                        \n        &lt;/tr&gt;       \n    }                            \n}\n</code></pre>\n\n<p>So the questions is, how to iterate through a view and group the items into their categories, displaying the category only once></p>\n\n<p>I've gone back to the drawing board and using this:</p>\n\n<pre><code>                             @foreach (var category in Model.FeeScheduleRates().Distinct())\n                            {\n                                &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n                                foreach (var item in Model.FeeScheduleRates().Where(i=&gt;i.Cat_ID == category.Cat_ID))\n                                {                               \n                                    &lt;tr&gt; \n                                        &lt;td&gt;@item.Fee_Title - @item.Description&lt;/td&gt;\n                                        &lt;td&gt;@item.Amount&lt;/td&gt;                                        \n                                    &lt;/tr&gt;\n                                }                                   \n                            }\n</code></pre>\n\n<p>Have experienced some some form of success in that the categories are appearing as rows and then items beneath.  The funny thing is, it still just repeats the same item as many times as their are records matching that category.  I\"m still curious why it isn't iterating through the items properly and giving me each Fee_Title and Description.\nExample:</p>\n\n<p>`FREE Services</p>\n\n<p>Bank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nSavings and Money Market Account<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2`</p>\n\n<p>So there are 12 items in the DB under the category free and 7 under the Savings and Money Market Account.  It just repeats the first one of each category as many times as there are records in the category.  I do get it!!!</p>\n"},{"tags":["sql","parameters","append","ado"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":61,"score":5,"question_id":13034479,"title":"Use variable to append field parameter","body":"<p>Cross Posted Here:</p>\n\n<p><a href=\"http://www.vbforums.com/showthread.php?696163-Use-variable-to-append-field-parameter&amp;p=4264077#post4264077\">http://www.vbforums.com/showthread.php?696163-Use-variable-to-append-field-parameter&amp;p=4264077#post4264077</a></p>\n\n<p>I am using ADO to retrieve data from MS Access into Excel, and I want to append an Iif statement into the SELECT part of my query. My SQL string is stored in a text file, and any parameters are being appended via ADO.</p>\n\n<p>I know how to append parameters in the WHERE clause, and can even append parameters in the SELECT statement like this:</p>\n\n<pre><code>SELECT BA, Iif(QA=[@somestring],[@somestring2], [@somestring3])\nFROM myData\nWHERE BA = 'some person'\n</code></pre>\n\n<p>But what I am trying to accomplish is to transform a placeholder [@somestring] into a variable length Iif statement, such as:</p>\n\n<pre><code>SELECT BA, [@somestring]    \n</code></pre>\n\n<p>And the placeholder translates to a string I have built using a function:</p>\n\n<pre><code>Iif(QA='Jon Doe', 'Jon', Iif(QA='Jane Doe', 'Jane', 'Nobody')).  \n</code></pre>\n\n<p>Right now, the result I get is the literal string I pass to the parameter populating the entire field.  So the Iif statement is literally written out for each record, rather than being evaluated by SQL.</p>\n\n<p>Is what I am trying to do even possible, or does SQL need the Field for the Iif statement predefined in the initial command?     </p>\n\n<p>ie, Iif(QA=[@somestring], [@sometstring2], [@somestring3])</p>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13193557,"title":"SQL pad query result for missing groups","body":"<p>Assume the following table:</p>\n\n<p>TableA:  </p>\n\n<pre><code>ID  GroupName SomeValue\n1   C         1\n2   C         1\n2   B         1\n2   A         1\n</code></pre>\n\n<p>I need to construct a query that selects the following result:  </p>\n\n<pre><code>ID  GroupName SomeValue\n1   C         1\n1   B         0\n1   A         0\n2   C         1\n2   B         1\n2   A         1\n</code></pre>\n\n<p>The GroupName is actually derived from TableA column's CASE expression and can take only 3 values: A, B, C.  </p>\n\n<p>Are the analytic functions the way to go?  </p>\n\n<p><strong>EDIT</strong>  </p>\n\n<p>Sorry, for not mentioning it, but the ID could consist of multiple columns. Consider this example:  </p>\n\n<pre><code>ID1 ID2 GroupName SomeValue\n1   1   C         1\n\n1   2   C         1\n\n2   2   C         1\n2   2   B         1\n2   2   A         1\n</code></pre>\n\n<p>I need to pad <code>SomeValue</code> with 0 for each unique combination ID1+ID2. So the result should be like this:  </p>\n\n<pre><code>ID1 ID2 GroupName SomeValue\n\n1   1   C         1\n1   1   B         0\n1   1   A         0\n\n1   2   C         1\n1   2   B         0\n1   2   A         0\n\n2   2   C         1\n2   2   B         1\n2   2   A         1  \n</code></pre>\n\n<p><strong>EDIT2</strong><br>\nSeems like solution, proposed by @Laurence should work even for multiple-column 'ID'. I couldn't rewrite the query proposed by @Nicholas Krasnov to conform to this requirement. But could somebody compare these solutions performance-wise? Will the <code>analytic function</code> work faster than 'cross join + left outer join'?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13246447,"title":"One date check for entire query","body":"<p>I have the following query:</p>\n\n<pre><code>select \n    fp.id, \n    fr.id,\n    sum(case \n        when to_date(fp.offered_date) BETWEEN TO_DATE( :ad_startdate, 'YYYY-MM-DD') \n             AND TO_DATE(:ad_enddate, 'YYYY-MM-DD') and fp.result &lt;&gt; 'E'\n             then 1 \n        else 0 \n        end) total,\n    sum(case when fp.result = 'G' \n        and  to_date(fp.offered_date) &gt;=  :ad_startdate\n        and  to_date(fp.offered_date) &lt;= :ad_enddate then 1 else 0 end) colorgreen,\n    sum(case when fp.resultat = 'R' \n        and  to_date(fp.offered_date) &gt;=  :ad_startdate\n        and  to_date(fp.offered_date) &lt;= :ad_enddate then 1 else 0 end) colorred\nFROM \n    fruit_properties fp, fruit fr\nWHERE \n    fp.id = fr.id\nGROUP BY \n    fp.id, fr.id\n</code></pre>\n\n<p>I'm checking dates 1 time for each sum column and have a feeling this can be made once somehow? Right now if I check only once at the total column, then colorgreen + colorred might be larger than the total since it counts no matter what date they have.</p>\n\n<p>Can my query be enhanced somehow?</p>\n"},{"tags":["java","sql","hibernate","netbeans"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13247006,"title":"Error in HIbernate Querying Language","body":"<p>I am pretty new to Hibernate based Application Developing.\nRecently i run the same code(which is shown in the below) in Eclipse Juno IDE. It works fine.\nBut when coming to Netbeans it doesn't work.And it shows the error as </p>\n\n<blockquote>\n  <p>SEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='username'' at line 1</p>\n</blockquote>\n\n<p>Here Iam using the Mysql 5.5,IDE-NetBeans-7.2.1.</p>\n\n<p>Here the code i am executing is,</p>\n\n<p>Hibernate.cfg.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt;\n    &lt;mapping resource=\"hibernatefiles/Users.hbm.xml\"/&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Hibernating Mapping File:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Nov 6, 2012 12:42:42 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"hibernatefiles.Users\" table=\"users\" catalog=\"OFFICE MANAGER\"&gt;\n        &lt;id name=\"uid\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"Uid\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"uname\" type=\"string\"&gt;\n            &lt;column name=\"uname\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"upass\" type=\"string\"&gt;\n            &lt;column name=\"upass\" length=\"30\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"ename\" type=\"string\"&gt;\n            &lt;column name=\"ename\" length=\"100\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"edesg\" type=\"string\"&gt;\n            &lt;column name=\"edesg\" length=\"100\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"contactnumber\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"contactnumber\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Users.java(POJO File)</p>\n\n<pre><code>package hibernatefiles;\npublic class Users  implements java.io.Serializable {\n\n\n     private Integer uid;\n     private String uname;\n     private String upass;\n     private String ename;\n     private String edesg;\n     private Integer contactnumber;\n\n    public Users() {\n    }\n\n    public Users(String uname, String upass, String ename, String edesg, Integer contactnumber) {\n       this.uname = uname;\n       this.upass = upass;\n       this.ename = ename;\n       this.edesg = edesg;\n       this.contactnumber = contactnumber;\n    }\n\n    public Integer getUid() {\n        return this.uid;\n    }\n\n    public void setUid(Integer uid) {\n        this.uid = uid;\n    }\n    public String getUname() {\n        return this.uname;\n    }\n\n    public void setUname(String uname) {\n        this.uname = uname;\n    }\n    public String getUpass() {\n        return this.upass;\n    }\n\n    public void setUpass(String upass) {\n        this.upass = upass;\n    }\n    public String getEname() {\n        return this.ename;\n    }\n\n    public void setEname(String ename) {\n        this.ename = ename;\n    }\n    public String getEdesg() {\n        return this.edesg;\n    }\n\n    public void setEdesg(String edesg) {\n        this.edesg = edesg;\n    }\n    public Integer getContactnumber() {\n        return this.contactnumber;\n    }\n\n    public void setContactnumber(Integer contactnumber) {\n        this.contactnumber = contactnumber;\n    }\n\n}\n</code></pre>\n\n<p>I am Executing the HQL in the below JSP File by using Query Class.</p>\n\n<pre><code>&lt;%@page import=\"hibernatefiles.Users\"%&gt;\n&lt;%@page import=\"java.util.Iterator\"%&gt;\n&lt;%@page import=\"org.hibernate.Query\"%&gt;\n&lt;%@page import=\"org.hibernate.Session\"%&gt;\n&lt;%@page import=\"org.hibernate.Transaction\"%&gt;\n&lt;%\n    String user_id = request.getParameter(\"uid\");\n    String u_pass = request.getParameter(\"upass\");\n    out.println(\"got it dude we get the details...\"+user_id+\"\\n\"+u_pass);\n\n    //writing the hibernate code\n\n    Transaction transaction;\n\n    Session ses = hibernatefiles.NewHibernateUtil.getSessionFactory().openSession();\n    try{\n             transaction = ses.beginTransaction();\n             String HQL = \"FROM Users u WHERE u.uname='\"+user_id+\"'\";\n             Query query = ses.createQuery(HQL);\n            java.util.List li = query.list();\n            Iterator itera = li.iterator();\n            while(itera.hasNext()){\n        //getting record\n                Users u= (Users) itera.next();\n        out.println(\"user name is:\"+u.getUname());\n                out.println(\"user password is :\"+u.getUpass());         \n\n            }\n\n    }\n    catch(Exception error){\n        error.printStackTrace();\n\n    }\n\n%&gt;\n</code></pre>\n\n<p>Here NetBeans Log</p>\n\n<pre><code>Nov 06, 2012 2:31:27 PM org.apache.catalina.core.StandardContext reload\nINFO: Reloading Context with name [/Office_Manager] is completed\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.annotations.Version &lt;clinit&gt;\nINFO: Hibernate Annotations 3.3.1.GA\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: Hibernate 3.2.5\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: hibernate.properties not found\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: Bytecode provider name : cglib\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: using JDK 1.4 java.sql.Timestamp handling\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration configure\nINFO: configuring from resource: /hibernate.cfg.xml\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration getConfigurationInputStream\nINFO: Configuration resource: /hibernate.cfg.xml\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : hibernatefiles/Users.hbm.xml\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.Configuration doConfigure\nINFO: Configured SessionFactory: null\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nINFO: Mapping class: hibernatefiles.Users -&gt; users\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.AnnotationConfiguration secondPassCompile\nINFO: Hibernate Validator not found: ignoring\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: Using Hibernate built-in connection pool (not for production use!)\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: Hibernate connection pool size: 20\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: autocommit mode: false\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: using driver: com.mysql.jdbc.Driver at URL: jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: connection properties: {user=root, password=****}\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: RDBMS: MySQL, version: 5.5.25a\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC driver: MySQL-AB JDBC Driver, version: mysql-connector-java-5.1.18 ( Revision: tonci.grgin@oracle.com-20110930151701-jfj14ddfq48ifkfq )\nNov 06, 2012 2:31:47 PM org.hibernate.dialect.Dialect &lt;init&gt;\nINFO: Using dialect: org.hibernate.dialect.MySQLDialect\nNov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionFactoryFactory buildTransactionFactory\nINFO: Using default transaction strategy (direct JDBC transactions)\nNov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionManagerLookupFactory getTransactionManagerLookup\nINFO: No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Automatic flush during beforeCompletion(): disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Automatic session close at end of transaction: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC batch size: 15\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC batch updates for versioned data: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Scrollable result sets: enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC3 getGeneratedKeys(): enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Connection release mode: auto\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Maximum outer join fetch depth: 2\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Default batch fetch size: 1\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Generate SQL with comments: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Order SQL updates by primary key: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Order SQL inserts for batching: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createQueryTranslatorFactory\nINFO: Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory\nNov 06, 2012 2:31:47 PM org.hibernate.hql.ast.ASTQueryTranslatorFactory &lt;init&gt;\nINFO: Using ASTQueryTranslatorFactory\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Query language substitutions: {}\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JPA-QL strict compliance: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Second-level cache: enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Query cache: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createCacheProvider\nINFO: Cache provider: org.hibernate.cache.NoCacheProvider\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Optimize cache for minimal puts: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Structured second-level cache entries: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Echoing all SQL to stdout\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Statistics: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Deleted entity synthetic identifier rollback: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Default entity-mode: pojo\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Named query checking : enabled\nNov 06, 2012 2:31:47 PM org.hibernate.impl.SessionFactoryImpl &lt;init&gt;\nINFO: building session factory\nNov 06, 2012 2:31:48 PM org.hibernate.impl.SessionFactoryObjectFactory addInstance\nINFO: Not binding factory to JNDI, no JNDI name configured\nNov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nWARNING: SQL Error: 1064, SQLState: 42000\nNov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nSEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1\norg.hibernate.exception.SQLGrammarException: could not execute query\nHibernate: \n    select\n        users0_.Uid as Uid0_,\n        users0_.uname as uname0_,\n        users0_.upass as upass0_,\n        users0_.ename as ename0_,\n        users0_.edesg as edesg0_,\n        users0_.contactnumber as contactn6_0_ \n    from\n        OFFICE MANAGER.users users0_ \n    where\n        users0_.uname='manikanta'\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.doList(Loader.java:2223)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\n    at org.hibernate.loader.Loader.list(Loader.java:2099)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)\n    at org.apache.jsp.Employers.checking_jsp._jspService(checking_jsp.java:88)\n    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)\n    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)\n    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n    at com.mysql.jdbc.Util.getInstance(Util.java:386)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)\n    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2293)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n    at org.hibernate.loader.Loader.doList(Loader.java:2220)\n    ... 33 more\n</code></pre>\n"},{"tags":["sql","select","groovy","named-parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13248084,"title":"groovy - Sql eachRow named parameters with map","body":"<p>I'm trying to perform select like this:</p>\n\n<pre><code>def queries = [\n    [\n        paramQuey: \"\",\n        mainQuery: \"SELECT * FROM SOME_TABLE\"\n    ],\n    [\n        paramQuey: \"SELECT SOME_COLUMN AS COUNT FROM A_TABLE WHERE SOMETHING=3\",\n        mainQuery: \"SELECT * FROM OTHER_TABLE WHERE ROWNUM&lt;:COUNT\"\n    ]\n]\n\nqueries.each {\n    def params = [:]\n    if(!it.paramQuery.isEmpty()) {\n        params = sql.firstRow(it.paramQuery)\n    }\n    sql.eachRow(mainQuery, params) { //&lt;--here's my problem\n        //do something\n    }\n}\n</code></pre>\n\n<p>However, program throws </p>\n\n<pre><code>Exception in thread \"main\" groovy.lang.MissingMethodException: No signature of method: groovy.sql.Sql.eachRow() is applicable for argument types: (java.lang.String, java.util.LinkedHashMap, MyClass$_execute_closure4) values: [SELECT * FROM SOME_TABLE, [:], MyClass$_execute_closure4@b3600d]\nPossible solutions: eachRow(java.lang.String, groovy.lang.Closure), eachRow(java.lang.String, groovy.lang.Closure, groovy.lang.Closure), eachRow(java.lang.String, java.util.List, groovy.lang.Closure), eachRow(groovy.lang.GString, groovy.lang.Closure), eachRow(groovy.lang.GString, groovy.lang.Closure, groovy.lang.Closure), eachRow(java.lang.String, int, int, groovy.lang.Closure)\n</code></pre>\n\n<p>which clearly shows that there's no method for handling eachRow with named parameters. However according to <a href=\"http://groovy.codehaus.org/api/groovy/sql/Sql.html\" rel=\"nofollow\">http://groovy.codehaus.org/api/groovy/sql/Sql.html</a> there are:</p>\n\n<pre><code>    void    eachRow(java.lang.String sql, java.util.Map params, Closure closure)\n    void    eachRow(java.lang.String sql, java.util.Map params, Closure metaClosure, Closure rowClosure)\n    void    eachRow(java.lang.String sql, java.util.Map map, Closure metaClosure, int offset, int maxRows, Closure rowClosure)\n    void    eachRow(java.lang.String sql, java.util.Map params, int offset, int maxRows, Closure closure)\n    void    eachRow(java.util.Map params, java.lang.String sql, Closure closure)\n    void    eachRow(java.util.Map params, java.lang.String sql, Closure metaClosure, Closure rowClosure)\n    void    eachRow(java.util.Map map, java.lang.String sql, Closure metaClosure, int offset, int maxRows, Closure rowClosure)\n    void    eachRow(java.util.Map params, java.lang.String sql, int offset, int maxRows, Closure closure)\n</code></pre>\n\n<p>which leaves me wondering: what am I doing wrong, and how can I handle named parameters with eachRow.</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":53,"score":0,"question_id":13230750,"title":"How to display Month Names from month numbers","body":"<p>Now i am in a condition, Where I am just displaying the month names and some data grouped by month number. There is a small issue. I need to get month names instead of month numbers from Oracle.</p>\n"},{"tags":["c#","javascript","asp.net","sql","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":13220979,"title":"How to create hot spots on an image with mouse over and clickable area?","body":"<p>I have a scenario where i want to create hot spot on image.I want to let the hot spots on image be created by the user.Suppose user want to create rectangle on image then he just need to left click with mouse and create rectangle and this rectangle should be displayed with clickable area(Hot spot.).I need it because I need to create a page where a user can select specific area and should be the clickable in future.Can any one please suggest me the way.  </p>\n\n<p>here is the example image.I am now able to draw lines on image but i want to create rectangle which should be clickable with mouse over.\n<img src=\"http://i.stack.imgur.com/K0Gun.png\" alt=\"enter image description here\"> </p>\n\n<p>the background is an image and blue thin line is drawn by mouse.</p>\n"},{"tags":["mysql","sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13242892,"title":"SQL query using group by","body":"<p>I have a table called \"EMP\" and two collumns one called \"deptno\" and the other called \"job\". I need a query to find out how many people there are in each type of job within each department.</p>\n\n<p>I know I need to use count() and group by but im not sure how to do this, any help would be appreciated.</p>\n\n<p>Thanks James. </p>\n"},{"tags":["sql","c","web-services","embedded","point-of-sale"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13227288,"title":"web service access in mobile POS device","body":"<p>i have a web service which  will  return a single dimensions array  or string, if some parameters are passed to it eg,(1,1, ,dd/mm/yyyy hh:mm).It would be really helpful if iam able to get some idea on how this web service can be accessed from a gprs enabled mobile device (Point of sale- ARM9 device with 256MB of NAND flash for the Operating System,\nUser application and the remaining for the user data[Files, Databases and other\nuser requirement].\n ) using <strong>C</strong>( as it is having its self-diagnosing  application developed in C (host os- fedora) for displaying menus,printing bills etc which i also need in my project).i need to store this accessed data temporarily as text file in this device itself for later use.im quite new in this and i couldnt find anything useful on POS software development.so pls help as i cant go forward in developing without proper understanding.pls pardon for posting this here.thanks in advance.</p>\n\n<p>ps:I  mainly need Help  in the portion of temporary storage of data from the web service on the device (to work off-line) and query it when needed.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13246598,"title":"Join two tables and group by xyz","body":"<p>I have two tables</p>\n\n<p>Table 1:</p>\n\n<pre><code>    ref       status\n\n    abc     1\n    abc     1\n    abc     2\n    abc     3\n    abc     5(not in Table2)\n    abc     5(not in Table2)\n</code></pre>\n\n<p>Table 2:</p>\n\n<pre><code>    ref          status\n\n    abc     1\n    abc     1\n    abc     2\n    abc     3\n    abc             4(not in Table1)\n    abc     4(not in Table1)\n</code></pre>\n\n<p>I want to join these two tables and perform a grouping so that the final result looks like this:</p>\n\n<p>Resultant Table:\n        ref       status</p>\n\n<pre><code>    abc     1\n    abc     2\n    abc     3\n    abc     4\n    abc     5\n</code></pre>\n\n<p>I have tried this</p>\n\n<pre><code>    SELECT DISTINCT Table1.ref, Table1.status, Table2.ref, Table2.status\n    FROM Table1, Table2\n    GROUP BY Table1.ref, Table1.status, Table2.ref, Table2.status;\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13246561,"title":"select data vice versa","body":"<p>I have two table in my database.</p>\n\n<pre><code>1) User Table\n\nid  username    password    logo    email\n1   admin        admin      NULL    1   \n2   support     support     NULL    NULL    \n3   test        test        NULL    NULL    \n\n\n2) Link Account Table\n\nID  AccountID   LinkAccountID\n1       1           2\n</code></pre>\n\n<p>Now if i select username with accountid 1 then it will return me Admin and Support\n    same way if i select username with accountid 2 then also it will return admin and support\n    and if i select username with accountid 3 then it will return only test</p>\n\n<p>something like vice versa if in link account table account id is 1 or linkaccountid is 1 that will return both id</p>\n\n<p>Thanks in advance</p>\n\n<p>Regards</p>\n\n<p>Amit Vyas</p>\n"},{"tags":["java","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13247844,"title":"Delete state for sql query","body":"<p>I've met up with some problems regarding to sql statement. I screenshot a photo of tables for you guys to see.</p>\n\n<p><img src=\"http://i.stack.imgur.com/pXzYD.png\" alt=\"Picture delete\"></p>\n\n<p>Okay, so what I'm trying to do here is that i retrieve a parameter from the user, which is '14' in this case. So the query has to link the other foreign keys and delete them off. For this, 'User' table is the \"Parent\" of the other 2 tables which is 'camera' and 'mob_dev'. However, camera can't be deleted as there is another foreign key connected to the table 'camera' which is 'device'. So is there any idea on how I can delete the 4 tables by only inputting a single parameter at 'User' table 'userid'. I tried it by doing this in the controller:</p>\n\n<pre><code>String querycam = \"DELETE FROM ip_camera where user_id =\"  +params.userinput\nString querydevice = \"DELETE FROM mobile_device where user_id =\"  +params.userinput\nString queryvalue = \"DELETE FROM sec_user where id =\"  +params.userinput\n</code></pre>\n\n<p>Or is there a better way for doing this? Thanks in advance to anyone who can solve this :).</p>\n"},{"tags":["c#","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13247500,"title":"Is it bad practice to store SQL stored procedures and parameters in a database table","body":"<p>We have a use case where an app that sends out emails finds a specific string ('smart tag')  in an email and replaces it with the results of a stored procedure. </p>\n\n<p>So for example the email could have <code>Dear &lt;ST:Name&gt;</code> in the body, and then the code would identify this string, run the stored procedure to find the client name passing in the client id as a parameter.</p>\n\n<p>The list of these tags and the stored procedures that need to be run are currently hard coded, so every time a new 'smart tag' needs to be added, a code change and deployment is required. </p>\n\n<p>Our BA's our skilled in SQL and want to be able to add new tags manually. </p>\n\n<p>Is it bad practice to store the procedure and parameters in a database table? Would this be a suitable design for such a table? Would it be necessary to store parameter type?</p>\n\n<p><strong>SmartTag</strong> </p>\n\n<pre><code>SmartTagId   SmartTag   StoredProcedure\n</code></pre>\n\n<p><strong>SmartTagParameters</strong> </p>\n\n<pre><code>SmartTagParameterId   SmartTagId   ParameterName\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13246326,"title":"sql query in where condition","body":"<p>Is it good if i write query like this:- (see query in where condition)</p>\n\n<pre><code>SELECT distinct(id) \"idea_id\" \nFROM ideas \nWHERE deleted_by_user = 0 AND moderation_flag = 1 AND \nuser_id in (select id \n            from users \n            where confirm like \"yes\") \nORDER BY time_of_creation DESC\n</code></pre>\n\n<p>let me know if there is some issue in this query :\nthanx in advance..</p>\n"},{"tags":["sql","database","web-applications","rdbms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13213706,"title":"Ready web query interface to SQL databases","body":"<p>Do you know any free tool which would constitute a <strong>web-based SQL database generic query interface</strong>, incl.:</p>\n\n<ul>\n<li>(mainly) allowing to type in an SQL query and display the result in some nice way</li>\n<li>the interface should allow for some basic security - allowing only <code>SELECT</code> queries </li>\n<li>the very need is to support MS SQL Server, but Oracle support would be useful</li>\n<li>should run against an existing database instance without any re-configuration needed</li>\n<li>might be simple, no need to browse tables, analyze database columns or anything else you would experience in SQLDeveloper or SQL Server Management Studio</li>\n</ul>\n\n<p>Platform / language / etc. is of second importance.</p>\n"},{"tags":["sql","query","postgresql","otrs"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13237579,"title":"querying otrs database","body":"<p>I have a problem with creating a query on a postgresql database from OTRS.  I need to get an asset list with some data that is stored in the CMDB, but I am having trouble with the way that the data is stored.</p>\n\n<p>This query works ok as far as it goes but as soon as I add another left join to get some more data it just runs for ever without returning any results.</p>\n\n<p>As far as I can see, the problem is that all the information is contained in the xml_storage table without any relationships so I need to repeatedly query that table to get the data.  There is also a mix of data types where an integer is stored as a varyable character in some cases and this prevents me from using that value to get additional information from the general catalog.</p>\n\n<p>I have been banging my head against a brick wall for days on this so i would really appreciate any help</p>\n\n<pre><code>SELECT \n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      array_agg(service),\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    FROM \n      public.configitem_version,\n      public.general_catalog,\n      public.configitem \n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS asset_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Asset Number''}[1]{''Content''}')   as select_asset on last_version_id::int = select_asset.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS manufacturer_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Manufacturer''}[1]{''Content''}' ) as select_manufacturer on last_version_id::int = select_manufacturer.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS model_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Model''}[1]{''Content''}' ) as select_model on last_version_id::int = select_model.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS serial_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''SerialNumber''}[1]{''Content''}' ) as select_serial on last_version_id::int = select_serial.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS fqdn_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''FQDN''}[1]{''Content''}' ) as select_fqdn on last_version_id::int = select_fqdn.xml_key::int\n\n    left join\n      (SELECT \n      link_relation.source_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.target_key::int = service.id AND\n      link_relation.target_object_id::int = 2 AND link_relation.source_object_id::int = 3\n      UNION\n      SELECT \n      link_relation.target_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.source_key::int = service.id AND\n      link_relation.target_object_id::int = 3 AND link_relation.source_object_id::int = 2) as select_service on configitem.id = configitem_id::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS purchasedate_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''PurchaseDate''}[1]{''Content''}' ) as select_purchasedate on last_version_id::int = select_purchasedate.xml_key::int\n\n    left join\n      (SELECT\n      general_catalog.name AS status_value,\n      general_catalog.id\n      FROM\n      public.general_catalog) as select_status on configitem.cur_depl_state_id::int = select_status.id::int\n\n    WHERE\n      configitem.last_version_id = configitem_version.id AND\n      configitem.class_id = general_catalog.id AND\n      (configitem.class_id = 32 OR configitem.class_id = 33)\n\n\n    GROUP BY\n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    ;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13245663,"title":"SQL Server format decimal places with commas","body":"<p>How can I convert the decimal values to have some commas?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4269529/sql-server-2005-currency-format-with-commas-and-period\">this</a> Helps me. But my problem the decimal places are set to 2 only..I want the decimal to be 2, 3, or 4..example</p>\n\n<pre><code>1,234.123   or    1,234.12345\n</code></pre>\n\n<p>I tried</p>\n\n<pre><code>convert(varchar, convert(decimal(18, 4), 1234.1234567), 1) \n</code></pre>\n\n<p>Output : 1234.1234</p>\n\n<p>There is no comma. But if I use money the decimal are 2 only</p>\n\n<blockquote>\n  <p>convert(varchar, convert(money, 1234.1234567), 1) </p>\n  \n  <p>Output : 1,234.12</p>\n</blockquote>\n"},{"tags":["c#","sql","sql-server","sqldatareader"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13247241,"title":"DataReader problems getting data from 2 classes","body":"<p>I am very inexperienced with SQL, and have only had one lesson. I am trying to figure out how to get information from 2 classes using a DataReader. </p>\n\n<p>My Customer class:</p>\n\n<pre><code>public class Customer\n{\n    private CreditCard _creditCard;\n    private List&lt;Subscription&gt; _subscriptions;\n    private int _customerId;\n    private string _name;\n    private string _address;\n    private int _zipCode;\n    private string _city;\n    private string _email;\n    private string _password;\n\n\n    public Customer(int id, string name, string email, string password)\n    {\n        this._customerId = id;\n        this._name = name;\n        this._email = email;\n        this._password = password;\n        this._subscriptions = new List&lt;Subscription&gt;();\n    }\n\n    public Customer(int id, string name)\n    {\n        this._customerId = id;\n        this._name = name;\n        _subscriptions = new List&lt;Subscription&gt;();\n    }\n\n    public override string ToString()\n    {\n        return _customerId + \" \" + _name;\n    }\n\n    public int CustomerId\n    {\n        get { return _customerId; }\n        set { _customerId = value; }\n    }\n\n    public string Name\n    {\n        get { return _name; }\n        set { _name = value; }\n    }\n\n    public string Address\n    {\n        get { return _address; }\n        set { _address = value; }\n    }\n\n    public int ZipCode\n    {\n        get { return _zipCode; }\n        set { _zipCode = value; }\n    }\n\n    public string City\n    {\n        get { return _city; }\n        set { _city = value; }\n    }\n\n    public string Email\n    {\n        get { return _email; }\n        set { _email = value; }\n    }\n\n    public string Password\n    {\n        get { return _password; }\n        set { _password = value; }\n    }\n\n\n\n    public List&lt;Subscription&gt; Subscriptions\n    {\n        get { return _subscriptions; }\n    }\n\n    public void AddSubscription(Subscription s)\n    {\n        _subscriptions.Add(s);\n    }\n\n    public Subscription FindSubscription(int sId)\n    {\n        bool found = false;\n        int i = 0;\n        while (!found &amp;&amp; i &lt; _subscriptions.Count)\n        {\n            if (_subscriptions[i].SubscriptionId == sId)\n                found = true;\n            else\n                i++;\n        }\n        if (found)\n            return _subscriptions[i];\n        else\n            return new Subscription();\n    }\n\n}\n</code></pre>\n\n<p>My Subscription Class:</p>\n\n<pre><code>public class Subscription\n{\n    private SubscriptionType _subscriptionType;\n    private CarModel _carModel;\n    private List&lt;Booking&gt; _bookings;\n    private int _subscriptionId;\n\n    public Subscription(int subscriptionId, SubscriptionType subscriptionType, CarModel carModel)\n    {\n        this._subscriptionId = subscriptionId;\n        this._subscriptionType = subscriptionType;\n        this._carModel = carModel;\n        _bookings = new List&lt;Booking&gt;();\n    }\n\n    public Subscription()\n    { }\n\n    public int SubscriptionId\n    {\n        get { return _subscriptionId; }\n        set { _subscriptionId = value; }\n    }\n\n    public SubscriptionType SubscriptionType\n    {\n        get { return _subscriptionType; }\n    }\n\n    public CarModel CarModel\n    {\n        get { return _carModel; }\n    }\n\n    public override string ToString()\n    {\n        return this.SubscriptionId + \"\\t \" + this.SubscriptionType + \"\\t \" + this.CarModel;\n    }\n}\n</code></pre>\n\n<p>My Database class:</p>\n\n<pre><code>public class DBCustomer\n{\n    private static SqlCommand dbCmd = null;\n\n    public static List&lt;Customer&gt; GetCustomers()\n    {\n        List&lt;Customer&gt; returnList = new List&lt;Customer&gt;();\n        string sql = \"select * from Customer\";\n        dbCmd = AccessDBSQLClient.GetDbCommand(sql);\n\n        IDataReader dbReader;\n        dbReader = dbCmd.ExecuteReader();\n\n        Customer c;\n\n        while (dbReader.Read())\n        {\n            c = new Customer(Convert.ToInt32(dbReader[\"cId\"].ToString()), dbReader[\"cName\"].ToString());\n            returnList.Add(c);\n        }\n        AccessDBSQLClient.Close();\n        return returnList;\n\n    }\n\n    public static List&lt;Customer&gt; GetCustomersByEmail(string email)\n    {\n        List&lt;Customer&gt; returnList = new List&lt;Customer&gt;();\n        string sql = \"select * from Customer where cEmail = '\" + email+\"'\";\n        dbCmd = AccessDBSQLClient.GetDbCommand(sql);\n\n        IDataReader dbReader;\n        dbReader = dbCmd.ExecuteReader();\n\n        Customer c;\n\n        while (dbReader.Read())\n        {\n            c = new Customer(Convert.ToInt32(dbReader[\"cId\"].ToString()), dbReader[\"cName\"].ToString());\n            returnList.Add(c);\n        }\n        AccessDBSQLClient.Close();\n        return returnList;\n\n    }\n\n    public static List&lt;Subscription&gt; GetCustomerSubscriptions(int cId)\n    {\n        List&lt;Subscription&gt; returnList = new List&lt;Subscription&gt;();\n        string sql = \"select S.sId, ST.stName,CM.cmDescription \"\n                   + \"from Customer C, Subscription S, SubscriptionType ST, CarModel CM \"\n                   + \"where C.cId = S.cId \"\n                   + \"and S.stId = ST.stId \"\n                   + \"and S.cmId = CM.cmId \"\n                   + \"and C.cId = \" + cId;\n        dbCmd = AccessDBSQLClient.GetDbCommand(sql);\n\n        IDataReader dbReader;\n        dbReader = dbCmd.ExecuteReader();\n\n        Subscription s;\n\n        while (dbReader.Read())\n        {\n            //s = new Subscription();\n            s = new Subscription((int)(dbReader[\"sId\"]).ToString(),\n                    dbReader[\"stName\"],\n                    dbReader[\"cmDescription\"]);\n            returnList.Add(s);\n        }\n        AccessDBSQLClient.Close();\n        return returnList;\n\n    }\n</code></pre>\n\n<p>Obviously the GetCustomers and GetCustomersByEmail methods are working, but I have no idea how to make the GetCustomerSubscriptions method, as it has to return data fra 2 classes, and I cant just build a Customer to add to the resultset. </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13245044,"title":"corelated query","body":"<p>I have a table where I have some records as follows <br/></p>\n\n<pre><code>Model            Make            Color\n==================================================\nMaruti 800       2008            Black\nMaruti 800       2009            White\nMaruti Esteem    2000            Yelow\nMaruti Esteem    2010            Red\n</code></pre>\n\n<p>Now I want the Model, Make and Color which has maximum make in the list.<br/>\nI have tried writing query like this<br/></p>\n\n<pre><code>SELECT \n     Model,\n     MAX(Model),\n     Color\nfrom \n     tableName\nGROUP BY \n     Model,\n     Color\n</code></pre>\n\n<p>But the result are not coming which I would like<br/>\nIt should be like</p>\n\n<pre><code>Model            Make            Color\n===================================================\nMaruti 800       2009            White    \nMaruti Esteem    2010            Red\n</code></pre>\n\n<p>But the result is the whole table.</p>\n\n<p>I need only those record which has max Make Model Wise.<br/>\nI have also tried inner Query (co-related query) But in that also it is asking for group by.</p>\n"},{"tags":["sql","table","loops","plsql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3448,"score":0,"question_id":5326698,"title":"Loop through multiple tables to execute same query","body":"<p>I have a database wherein per day a table is created to log process instances.\nThe tables are labeled MESSAGE_LOG_YYYYMMDD</p>\n\n<p>Currently i want to sequentially execute the same QUERY against all those tables.\nI wrote the PL/SQL below, but got stuck at line 10. How can i execute the SQL statement against successfully against all tables here ? </p>\n\n<pre><code>DECLARE\n  CURSOR all_tables IS\n    SELECT table_name\n            FROM all_tables \n            WHERE TABLE_NAME like 'MESSAGE_LOG_2%' \n            ORDER BY TABLE_NAME ;\n\nBEGIN\n  FOR msglog IN all_tables LOOP\n    SELECT count(*) FROM TABLE msglog.TABLE_NAME ;\n  END LOOP;\nEND;\n/\n</code></pre>\n\n<p>Cheers,</p>\n\n<p>Peter</p>\n"},{"tags":["sql","sql-server","performance","nested-sets","hierarchyid"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":115,"score":4,"question_id":12568201,"title":"SQL Server Nested set vs Hierarchyid performance","body":"<p>I have a hierarchical data. The most common queries will be \"get parent branch for node\" and \"get subtree of node\". Updates and inserts are not likely to occur often. I am choosing between nested sets and hierarchyid. As far as I am concerned, search on nested set should be pretty fast on indexed columns, however, I have no clue about internal implementation of hierarchyid. What should I use in order to achieve highest performance possible?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13244889,"title":"SQL Oracle How to Alter Constraint","body":"<p>SQL How to Alter Constraint</p>\n\n<p>Below is 1 of my constraint</p>\n\n<pre><code>CONSTRAINT ACTIVEPROG_FKEY1 FOREIGN KEY(ActiveProgCode) REFERENCES PROGRAM(ActiveProgCode),\n</code></pre>\n\n<p>I want to add in </p>\n\n<pre><code>ON DELETE CASCADE\n</code></pre>\n\n<p>to the constraint above. </p>\n\n<p>How do i alter that existing constraint ACTIVEPROG_FKEY1 and add  </p>\n\n<pre><code>ON DELETE CASCADE\n</code></pre>\n\n<p>to constraint ACTIVEPROG_FKEY1</p>\n\n<p>Consider ACTIVEPROG_FKEY1 is at Table ACTIVEPROG</p>\n"},{"tags":["java","sql","mysql","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1179,"score":1,"question_id":2854774,"title":"sql jdbc getgeneratedkeys returns column \"id\" not found, column type unknown","body":"<p>I want to retrieve the most recently updated value in the table using an insert query.</p>\n\n<p>these are the datatypes in my sql table.</p>\n\n<pre><code>int(11) // primary key auto increment, not being assigned by sqlQuery\n\nvarchar(30)\n\ntimestamp  // has a default value. but i am explicit assigning it using CURRENT_TIMESTAMP\n\nvarchar(300)\n\nvarchar(300)\n\nvarchar(300)\n\nint(11)\n\nvarchar(300)\n\n\n        // java code\n        statement.executeUpdate(sqlQuery, Statement.RETURN_GENERATED_KEYS);\n        ResultSet rs = statement.getGeneratedKeys();\n        System.out.println(\"here: \" + rs.getMetaData().getColumnCount());\n        System.out.println(\"here1: \" + rs.getMetaData().getColumnName(1));\n        // none of the following 3 works\n        System.out.println(\"id: \" + rs.getInt(1));\n        System.out.println(\"id: \" + rs.getInt(\"GENERATED_KEY\"));\n        System.out.println(\"id: \" + rs.getInt(\"id\"));\n</code></pre>\n\n<p>for a bit of background see <a href=\"http://stackoverflow.com/questions/2853066/sql-java-get-value-assigned-to-auto-increment-primary-key\">this</a></p>\n\n<p><code>rs.getMetaData().getColumnTypeName(1)</code> tells me column type <code>UNKNOWN</code></p>\n\n<p>stack trace\n        SEVERE: null\n        java.sql.SQLException\n        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)\n        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)\n        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:926)\n        at com.mysql.jdbc.ResultSetImpl.checkRowPos(ResultSetImpl.java:815)\n        at com.mysql.jdbc.ResultSetImpl.getStringInternal(ResultSetImpl.java:5528)\n        at com.mysql.jdbc.ResultSetImpl.getString(ResultSetImpl.java:5448)</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":20,"score":0,"question_id":13246339,"title":"Delete from ALL_DB_LINKS","body":"<p>i've problem here. </p>\n\n<p>i write a simple (just trying) query for creating database links.</p>\n\n<pre><code>CREATE DATABASE LINK XXX.US.ORACLE.XXX;\n</code></pre>\n\n<p>after that i wanna delete it. but it said \"ERROR at line 1:\nORA-01031: insufficient privileges\n\"</p>\n\n<p>how i can delete that data since it is a data dictionary view</p>\n"},{"tags":["sql","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":145,"score":3,"question_id":8667077,"title":"SQL Lite blank row id even after deleting the row","body":"<p>I have a SQLite DB file lets say a.db. And I have 100 rows in table a. When I give </p>\n\n<pre><code>SELECT * FROM a WHERE rowid BETWEEN 1 AND 100\n</code></pre>\n\n<p>it gives me the first 100 results. Now if I delete the first 2 rows from the table and run the </p>\n\n<pre><code>SELECT * FROM a WHERE rowid BETWEEN 1 AND 100 \n</code></pre>\n\n<p>it gives me only 98 rows. And when I give the query</p>\n\n<pre><code>SELECT * FROM a WHERE rowid = 1 \n</code></pre>\n\n<p>it gives me an empty row. The database doesn't seem to rearrange the rowid.</p>\n\n<p>Please help.. Is there any way to force the SQLite to rearrange the row ids ?</p>\n"},{"tags":["sql","sql-server","query","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13244832,"title":"SQL Server 2000 Query of total value and value from max date","body":"<p>I have this RoomTable with value</p>\n\n<pre><code>SID   Room   Date        APhase   BPhase   ACount  BCount\n1     One    10/28/2012  4        5         3       6\n2     One    10/29/2012  2        3        -1      -1\n3     One    10/30/2012  4        5         7      -1\n4     Two    10/28/2012  8        3         2       3\n5     Two    10/30/2012  3        5         4       6\n6     Three  10/29/2012  5        8         2      -1\n7     Three  10/30/2012  5        6        -1       4\n8     Four   10/29/2012  6        2        -1      -1\n9     Four   10/30/2012  5        8        -1      -1\n</code></pre>\n\n<p>What I want is to return the following:</p>\n\n<ol>\n<li>Total sum of APhase and BPhase of each Room.</li>\n<li>Value of ACount and BCount from max date of each Room</li>\n<li>If ACount value is -1 then use the previous date. Same as BCount.</li>\n<li>If ACount value is -1 and the previous date is -1 and so on. Then use 0. Same as BCount.</li>\n</ol>\n\n<p>I can get the query of number 1 with this query</p>\n\n<pre><code>SELECT Room, sum(APhase) as TotalAPhase, sum(BPhase) as TotalBPhase \nFROM RoomTable \nWHERE Date between '10/28/2012' and '10/30/2012'\ngroup by Room\norder by Room\n</code></pre>\n\n<p>But I'm confused on how to include the number 2-4 query.</p>\n\n<p>This is the output I want</p>\n\n<pre><code>Room  TotalAPhase  TotalBPhase  ACount   BCount\nOne   10           13           7        6\nTwo   11           8            4        6\nThree 10           13           2        4\nFour  11           10           0        0\n</code></pre>\n\n<p>Any ideas will be much appreciated. Thanks. </p>\n"},{"tags":["sql","firebird"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13243026,"title":"Firebird 1.5 : How to get the logarithm of a number","body":"<p>We are using Firebird 1.5 database. we need to calculate the logarithm of a number in the query, how can we do that?</p>\n\n<p>I have tried : </p>\n\n<pre><code>LOG(3, number_field)\n</code></pre>\n\n<p>but got an error :</p>\n\n<pre><code>Error: GDS Exception. 335544569. Dynamic SQL Error\nSQL error code = -804\nFunction unknown\nLOG\nSQLState:  42000\nErrorCode: 335544569\n</code></pre>\n\n<p>thanks for the help.</p>\n"},{"tags":["sql","query","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13245424,"title":"Join in Db2 query","body":"<p>I have joined two tables using inner join. Here primary key of table <code>TPREG</code> is <code>co_id</code> and <code>pol_id</code></p>\n\n<pre><code> SELECT (SELECT etbl_desc_txt\n       FROM uding604.tedit e\n       WHERE etbl_typ_id = 'PITCD'\n       AND   co_id = 'CP'\n       AND   etbl_valu_id = p.pol_ind_typ_cd) pol_ind_typ_cd,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYT'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_TYP_CD) POL_BILL_TYP_CD,\n       POL_PAC_DRW_DY,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYM'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_MODE_CD) POL_BILL_MODE_CD,\n       t.SOURCE_CD\nFROM uding604.tpol p,\n     uding604.TPREG t\nWHERE p.co_id = t.co_id\nAND   p.pol_id = t.pol_id\nAND   p.co_id = 'CP'\nAND   p.pol_id = '000000011'\nAND   t.co_id = 'CP'\nAND   t.pol_id = '000000011'\n</code></pre>\n\n<p>How to make this query more simple?</p>\n\n<p>Please guide.</p>\n"},{"tags":["sql","subquery","pivot","clause"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13245364,"title":"MS SQL Server pivot table with subquery in column clause","body":"<p>Im sure this is a simple technique although I can't find an answer so far!</p>\n\n<p>I have       </p>\n\n<pre><code>TIMESTAMP           | POINTNAME | VALUE\n2012-10-10 16:00:00   AHU01       20\n2012-10-10 16:00:00   AHU02       25\n2012-10-10 16:00:15   AHU01       26\n2012-10-10 16:00:15   AHU02       35\n</code></pre>\n\n<p>etc... ( for approx 800 POINTNAMES)  </p>\n\n<p>with many pointnames I dont want to list each one in the 'IN' clause of the pivot 'FOR'\n(as syntax given below) definition but would like to use perhaps a subquery.</p>\n\n<p>So what I would like is all the POINTNAME values as columns with A TIMESTAMP AND VALUE column, so I will get one TIMESTAMP value and many columns with each POINTNAME, there is only one value per POINTNAME PER TIMESTAMP so I don't need to aggregate anything so just choose max anyway?</p>\n\n<p>Something like:</p>\n\n<pre><code>SELECT [TIMESTAMP] FROM ( SELECT * FROM POINT_TABLE)\nPIVOT( Max[Value] FOR [POINTNAME] IN (SELECT DISTINCT [POINTNAME] FROM POINT_TABLE)\n</code></pre>\n\n<p>would produce-</p>\n\n<pre><code>   TIMESTAMP              AHU01          AHU02\n 2012-10-10 16:00:00        20             25\n 2012-10-10 16:15:00        26             35\n</code></pre>\n\n<p>I realise it is probably no this simple but hopefully you get what I'm trying to achieve?</p>\n\n<p>PIVOT SYNTAX:</p>\n\n<pre><code>SELECT &lt;non-pivoted column&gt;,\n    [first pivoted column] AS &lt;column name&gt;,\n    [second pivoted column] AS &lt;column name&gt;,\n    ...\n    [last pivoted column] AS &lt;column name&gt;\nFROM\n    (&lt;SELECT query that produces the data&gt;) \n    AS &lt;alias for the source query&gt;\nPIVOT\n(\n    &lt;aggregation function&gt;(&lt;column being aggregated&gt;)\nFOR \n[&lt;column that contains the values that will become column headers&gt;] \n    IN ( [first pivoted column], [second pivoted column],\n    ... [last pivoted column])\n) AS &lt;alias for the pivot table&gt;\n&lt;optional ORDER BY clause&gt;;\n</code></pre>\n"},{"tags":["sql","join","oledb"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13245727,"title":"Sql query with complex joins","body":"<p>I am developing c# application.\nI am using OLEDB connections.</p>\n\n<p>I have following two tables>></p>\n\n<p>payment</p>\n\n<pre><code>AdmissionNumber  | StudName |\n\n       1            John\n       2            Smith\n</code></pre>\n\n<p>paymentDetails</p>\n\n<pre><code>   AdmissionNumber  | RemainingFee |    Date         | Payment\n\n        1                5000         10/10/2012         3000\n        1                3000         10/11/2012         2000\n        2                4000         15/11/2012         3000\n        1                1000         10/12/2012         2000\n</code></pre>\n\n<p>In this I want to get the table result as following>></p>\n\n<pre><code> AdmissionNumber | Name | Date           |RemainingPayment|Payment|\n       1           John    10/12/2012          1000         2000\n</code></pre>\n\n<p>In this case Admission number and date is already provided in the form via textbox and datetimepicker.</p>\n"},{"tags":["sql","sql-server","logic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13245652,"title":"Can any body explain the logic mentioned in the description?","body":"<p>The best way to get the month name when you have the month number is </p>\n\n<p>Select DateName( month , DateAdd( month , @MonthNumber , 0 ) - 1 )</p>\n"},{"tags":["sql","codeigniter","error-handling"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":22,"score":-2,"question_id":13244343,"title":"data inside table wont appear","body":"<p>i have tried to make edit option, firstly, i must make my data appear on th table but my data wont appear.</p>\n\n<pre><code>function edit($id_publisher=null){\nif (!empty($_POST['submit'])){\n\n         $id_label=$_POST['id_label'];\n         $artis=$_POST['artis'];\n         $publisher=$_POST['publisher'];\n\n         $a = array('id_label'=&gt;$id_label,'artis'=&gt;$artis,'publisher'=&gt;$publisher);\n         $this-&gt;db-&gt;where('id_publisher',$id_publisher);\n         $this-&gt;db-&gt;update('t_publisher',$a);\n         redirect(\"mapping/mapp\");\n        }else{\n         $data['data'] = $this-&gt;db-&gt;query(\"SELECT b.id_publisher, a.label,  b.artis, b.publisher from t_label a, t_publisher b where a.id_label=b.id_label\")-&gt;row();\n         $this-&gt;load-&gt;view('edit',$data);\n          }\n\n        }\n</code></pre>\n\n<p>whats wrong with my code?\nhelp, please :)</p>\n\n<p>this is the views' code</p>\n\n<pre><code>&lt;form action=\"&lt;?php echo base_url().\"mapping/edit/\".$data-&gt;ID_PUBLISHER;?&gt;\" method=\"POST\"&gt;\n    &lt;table border=\"2\" align=\"center\"&gt;\n        &lt;tr&gt;\n            &lt;td&gt;LABEL&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"label\" value=\"&lt;?php echo $data-&gt;LABEL; ?&gt;\"/&gt;&lt;td&gt;&lt;/tr&gt;\n            &lt;td&gt;ARTIS&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"artis\" value=\"&lt;?php echo $data-&gt;ARTIS; ?&gt;\"/&gt;&lt;td&gt;&lt;/tr&gt;\n            &lt;td&gt;PUBLISHER&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"publisher\" value=\"&lt;?php echo $data-&gt;PUBLISHER; ?&gt;\"/&gt;&lt;td&gt;&lt;/tr&gt;\n            &lt;td colspan=\"2\" align=\"center\"&gt;&lt;input type=\"submit\" name=\"submit\" value=\"Edit\" /&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n</code></pre>\n"},{"tags":["sql","sql-server-2008","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13245451,"title":"Execute the value of a varchar returned from a \"OUTPUT DELETED.[ColumnName]\" statement","body":"<p>I am trying to use a table as a <a href=\"http://rusanu.com/2010/03/26/using-tables-as-queues/\" rel=\"nofollow\">heap queue</a>. However I am having a little trouble figuring out how to take the text that is generated in the dequeue function and perform a execute on it.</p>\n\n<p>Here is the table storing the queue and the dequeue method.</p>\n\n<pre><code>CREATE TABLE [dbo].[Merge_Queued_Work](Sql_Text varchar(2000) NOT NULL)\nGO\n\ncreate procedure usp_dequeueWork\nas\n  set nocount on;\n  delete top(1) from [Merge_Queued_Work] with (rowlock, readpast)\n      output deleted.[Sql_Text];      \ngo\n</code></pre>\n\n<p>How do I get the varchar from <code>deleted.[Sql_Text]</code> to a <code>execute</code> statement?</p>\n"},{"tags":["java","sql","prepared-statement","sqlexception"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13041817,"title":"java.sql.SQLSyntaxErrorException: Syntax error: Encountered \"(\" at line","body":"<p>I'm executing the following:</p>\n\n<pre><code>private void createTable() {\n    try {       \n        PreparedStatement psCreateTable = con.prepareStatement(\"CREATE TABLE     COMPANIES(\" +\n                \"name VARCHAR(50), \" +\n                \"location VARCHAR(50), \" +\n                \"address VARCHAR(50), \" +\n                \"website VARCHAR(50), \" +\n                \"pit VARCHAR(50), \" +\n                \"asset_class VARCHAR(50), \" +\n                \"telephone INTEGER, \" +\n                \"shares INTEGER, \" +\n                \"value DOUBLE(,2) UNSIGNED)\");\n        psCreateTable.execute();\n    } catch (SQLException e) {\n        System.out.println(\"already exists\");\n        e.printStackTrace();\n        ; //bestaat al\n    }\n}\n</code></pre>\n\n<p>And I get the following error: \n    java.sql.SQLSyntaxErrorException: Syntax error: Encountered \"(\" at line 1, column 195.</p>\n\n<p>Not really sure what to do now, as the SQL query seems valid to me and rechecked it. </p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":59,"score":-1,"question_id":13243047,"title":"Converting row to columns in SQL Server","body":"<p>I have a query that returns the following result set:</p>\n\n<pre><code>patName  SName   DISC    SCHEDULE   \nJM       AA      HA      2 per  Week\nJM       MAC     MSW     1 per  Month\nJM       ANG     RN      1 per  Week\nJM       JON     RN      1 per  Week\nJM       LRH     RN      1 per  Week\n</code></pre>\n\n<p>Is there any way I could display the result as follows using <code>PIVOT</code></p>\n\n<pre><code>PATNAME    HA           MSW             RN \n  JM    AA 2/Week   MAC 1/Month    ANG 1/week \n                                   JON 1/Week \n                                   LRH 1/Week\n</code></pre>\n\n<p>Edit, my query is as follows:</p>\n\n<pre><code>SELECT PatientName, [RN], [HA], [LVN], [MSW], [SC] \n  FROM \n  ( \n   SELECT DISTINCT (tblPatient.FirstName +' '+ tblPatient.LastName) As PatientName,\n   (tblStaff.StaffFirstName+' '+tblStaff.StaffLastName) As StaffName, \n    (tblStaffDiscipline.Discipline)As Discipline, \n    CAST(tblFrequencyOfVisit.NoOfVisit As Varchar)+' per '\n     + REPLACE (tblFrequencyOfVisit.Period,'/','') AS Visits new_value,\n   row_number() over(partition by PatientName, Discipline order by Discipline) rowNum\n   FROM tblPatient INNER JOIN\n   tblFrequencyOfVisit \n   ON tblPatient.PatientId = tblFrequencyOfVisit.PatientId \n   INNER JOIN tblStaffAssignment \n   ON tblPatient.PatientId = tblStaffAssignment.PatientId \n   AND tblFrequencyOfVisit.PatientId = tblStaffAssignment.PatientId \n   INNER JOIN tblStaffDiscipline \n   ON tblFrequencyOfVisit.DisciplineId = tblStaffDiscipline.DisciplineId \n   INNER JOIN tblStaff \n   ON tblStaffAssignment.StaffId = tblStaff.StaffId \n   AND tblStaffDiscipline.Discipline = tblStaff.StaffDisciplane \n )src  \n pivot\n (\n  max(new_value)\n  for Discipline in ([RN], [HA], [LVN], [MSW], [SC])\n) piv\n\n  WHERE\n  tblpatient.PatientId = '138' \n  AND NOT tblPatient.SOC IS NULL \n  AND tblPatient.EOC IS NULL \n  AND tblPatient.Hospiceid = '1' \n  AND tblFrequencyofVisit.FromDate = \n   (Select MAX(FROMDATE) \n   From tblfrequencyofVisit \n   Where tblFrequencyOfVisit.PatientId = tblPatient.PatientId \n   AND tblFrequencyofVisit.Disciplineid = tblStaffDiscipline.Disciplineid )\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13245112,"title":"Oracle SQL Set Foreign Key Check OFF","body":"<p>Oracle SQL Set Foreign Key Check OFF</p>\n\n<p>I tried to use this..</p>\n\n<pre><code>SQL&gt; SET FOREIGN_KEY_CHECKS = 0;\nSP2-0735: unknown SET option beginning \"FOREIGN_KE...\"\n</code></pre>\n\n<p>But it say unknown set option</p>\n\n<p>I am using oracle sql 11g express e</p>\n\n<p>I also tried</p>\n\n<pre><code>begin\nfor i in (select constraint_name, table_name from user_constraints where constraint_type ='R'\nand status = 'ENABLED') LOOP\nexecute immediate 'alter table '||i.table_name||' disable constraint '||i.constraint_name||'';\nend loop;\nend;\n</code></pre>\n\n<p>But the console stuck at line 7, not executing or something..</p>\n\n<p>Heres what happen..</p>\n\n<p>Connected.</p>\n\n<pre><code>SQL&gt; begin\n  2  for i in (select constraint_name, table_name from user_constraints where co\nnstraint_type ='R'\n  3  and status = 'ENABLED') LOOP\n  4  execute immediate 'alter table '||i.table_name||' disable constraint '||i.c\nonstraint_name||'';\n  5  end loop;\n  6  end;\n  7\n</code></pre>\n\n<p>It show the 7 then no longer work</p>\n\n<p><strong>Thanks for all help !!</strong></p>\n"},{"tags":["sql","oracle","create-table"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":131,"score":0,"question_id":11863244,"title":"missing right parenthesis in create table","body":"<p>I searched the forum but didn't find the right answer sorry if I double post\nI want to create this Table</p>\n\n<pre><code>create table HUB_SHIFT_REPORT\n(\n  Da_te timestamp(8) not null\n, Week_Day varchar2(10) not null constraint cnstrnt_day check (Week_Day in('Su','Mo','Tu','We','Th','Fr','Sa'))\n, Shift varchar2(10) not null constraint cnstrnt_shift check (Shift in('Morning','Evening','Night'))\n, Handled_by varchar2(60) not null constraint cnstrnt_handled check (Handled_by in('Artyom','Natan','Asaph','Yaniv','Fadi','AdiG','AdiF','Paul','Benjamin','Matan','Yosef'))\n, Incident_Number number(10) not null PRIMARY KEY\n, Centreon_Duration varchar2(10) not null\n, Time_received varchar2(10) not null\n, Time_restored varchar2(10) not null\n, Time_closed varchar2(10) not null\n, Product varchar2(60) not null constraint cnstrnt_product check (Product in ('Primo','MetaLib','SFX','bX','Primo Central','USTAT','Alma','Aleph','voayger','Marcit','ARC','Verde','Rosetta','Digitool','MetaLib+','NUUL','Not product related'))\n, Service_name varchar2(400) not null\n, Data_Center varchar2(10) constraint cnstrnt_dc check (Data_Center in ('DC01','DC02','DC03','DC04','DC05','Amazon','NULL'))\n, HOST VARCHAR2(40) \n, GUEST VARCHAR2(40) \n, Alert_Name varchar2(400) not null\n, Alert_Status varchar2(40) cnstrnt_status check (Alert_Status in ('CRITICAL','WARNING','UNKNOWN','DOWN','NULL'))\n, Affected_Customers varchar2(400) not null\n, Is_Escalated varchar2(10) default ('No') cnstrnt_yes check (Is_Escalated in('Yes','No'))\n, Escalated_at varchar2(10) default ('NULL') \n, Escalated_to varchar2(100) default ('NULL')\n, Open_Action_items varchar2(400) default ('NULL')\n, Time_Resolved varchar2(10) default ('NULL')\n, Related_alerts varchar2(50) default ('NULL')\n, Related_critical_alert_host varchar2(100) default ('NULL')\n, Is_Reported varchar2(10) default ('No') cnstrnt_yes check (Is_Reported in('Yes','No'))\n, Alert_Accuracy varchar2(10) default ('Real alert') not null cnstrnt_alert check (Alert_Accuracy in ('Real alert','False Positive'))\n, SI_number varchar2(10) default ('NULL')\n, Customer_Type varchar2(15) default ('Direct') not null cnstrnt_type check (Customer_Type in ('Total Care','Direct','SaaS','Local'))\n, Resolved varchar2(20) default ('No') cnstrnt_yes2 check (Resloved in('Yes','No','Cleared Itself'))\n, in_ERD varchar2(10) default ('Yes') cnstrnt_yes check (In_ERD in('Yes','No'))\n, In_XLS varchar2(10) default ('Yes') cnstrnt_yes check (In_XLS in('Yes','No')) \n, Actions_Taken varchar2(10) default ('No') cnstrnt_yes check (Actions_Taken in('Yes','No'))\n, Notes varchar2(800)\n, Root_cause varchar2(200) not null\n, Can_be_prevented varchar2(10) default ('No') cnstrnt_yes check (Can_be_prevented in('Yes','No'))\n, log varchar2(1800)\n)\n</code></pre>\n\n<p>But I get </p>\n\n<blockquote>\n  <p>Error at Command Line:14 Column:27 Error report: SQL Error: ORA-00907:\n  missing right parenthesis\n  00907. 00000 -  \"missing right parenthesis\"\n  *Cause:<br>\n  *Action:</p>\n</blockquote>\n\n<p>I count the right and left paranthesis and get 83 in both cases\nAny Idea?\nThanks</p>\n"}]}
{"total":102597,"page":8,"pagesize":100,"questions":[{"tags":["mysql","sql","tsql","group"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":51,"score":4,"question_id":13238464,"title":"Group data based on certain value","body":"<p>I have a table called x, the table has id column and repeat status column. The id can store same values even 6 of them while the repeat status increments each time an id is inserted 1,2...n. If a new different id is inserted the repeat status starts from 1 e.g</p>\n\n<pre><code> xid       repeat_status\nxx123           1\nxx123           1\nxx123           2\nxx123           3\nxx123           3 \nxxx45           1\nxxx45           2\nxxx45           2\n</code></pre>\n\n<p>How can i modify the query below to return something like this:</p>\n\n<pre><code> xid           repeat_status\nxx123             1\nxx123             2\nxx123             3\n\nxxx45             1\nxxx45             2\n\nSELECT xid\n      ,repeat_status \nFROM x \nGROUP BY repeat_status;\n</code></pre>\n"},{"tags":["sql","sql-server-2008-r2","query-optimization"],"answer_count":0,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":43,"score":6,"question_id":13243809,"title":"Performance Tuning for Huge Table (SQL Server 2008 R2)","body":"<p><strong>Background:</strong><br>\nI have a fact table in UAT Phase. Objective to load 5 yrs of data in Prod (expected size 400 Mn records). Currently it has only 2 years of data in Test. </p>\n\n<p><strong>Table Features:</strong></p>\n\n<ol>\n<li>No of Dimensions ~ 45 </li>\n<li>Measures ~ 30</li>\n<li>Non-additive measures and other columns~ 25</li>\n<li>Current data size ~ 200 Million (2 years data)</li>\n<li>Time View: 3 different Month views: Fiscal/Calendar/Adjusted (i.e same row can fall in different months based on which view one is looking for)</li>\n<li>Only One view will be required at a time by a user. (ie. only one Month Column will be used in the query, it's stopping us to do partitioning on time view)</li>\n<li>Indexes: 1 Clustered Index on the Natural Keys (8 columns).Created 3 covering Non Clustered Indexes one on the each Month column including few Dimension SKs (FKs) and all the measures).</li>\n<li>Indexes are huge(total 190 GB) because of this. </li>\n<li>Space is not constraint (1 TB allocated)</li>\n<li>64 GB of RAM available in server.</li>\n<li>Table compression also done.</li>\n</ol>\n\n<p><strong>Requirement:</strong><br>\nQueries on this Fact table should give result within 30 seconds (General queries select sum(measure) joining few Dims group by Dim Values). Reports are directly done on top of this Fact table.</p>\n\n<p><strong>Issue:</strong><br>\nAny query which includes columns available in the Index works fine, but if we include any other columns which are not in the include..It sucks. It takes more than 5-10 minutes. Can any one suggest some solution where it works fine for any dimension/column we select. Can Index view help in this situation?</p>\n"},{"tags":["c#",".net","sql","datatable"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12947872,"title":"Quickest way to create DataTable from query?","body":"<p>What is the code with the smallest number of lines that will generate a <code>DataTable</code> from this SQL query?</p>\n\n<pre><code>SELECT * \nFROM [Table1] \nWHERE ([Date] BETWEEN @Date1 AND @Date2) AND \n      ([Field1] IS NULL OR [Field2] IS NULL)\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13244288,"title":"ERROR calling out CURDATE()","body":"<p>Why is there an error when i called out the CURDATE?</p>\n\n<pre><code>UPDATE TABLENAME\n    SET DATEATR= (TO_DATE(CURDATE() ,'DD-MM-YYYY') - WORKDATE /365 );\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13243626,"title":"Efficient Query, Table Bridge/Indexing and strucuture","body":"<p>In my PhpMyAdmin database I have 9 tables. 8 of those tables are relevant to me at this moment. I would like my queries to be executed quickly enough but I am not sure the design/structure of the tables are the most effecient. Any suggestion of merging a table with another or creating another bridge table?  Also, I am struggling in building a query that will display bridge results from the following tables: <code>semester</code>, <code>schedule</code>, <code>office_hours</code>, <code>faculty</code>, <code>section</code>, <code>major_minor</code>, <code>major_class_br</code>, <code>class</code>?</p>\n\n<p><a href=\"http://webprolearner2346.zxq.net/class_des/\" rel=\"nofollow\">TABLE STRUCTURE</a></p>\n\n<p>Basic Query- that shows class details</p>\n\n<pre><code>SELECT  class_name, class_caption, class_credit_hours, class_description\nFROM class  \n</code></pre>\n"},{"tags":["sql","asp.net-mvc","json"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13243673,"title":"How to you implement the Like operator in ASP.NET MVC?","body":"<p>I'm still working on my autocomplete textbox using data from the databse (SQL) and I think I'm not getting any result for the textbox because there's something wrong or missing on my select statement here's how my current code looks like. This is my json code for the view:</p>\n\n<pre><code>       $(function () {\n        $(\"#autoCompleteText\").autocomplete({\n            source: function (request, response) {\n                var autoSearch = { searchText: $(\"#autoCompleteText\").val() };\n                $.ajax({\n                    type: \"POST\",\n                    traditional: true,\n                    url: \"/Products/jsonAutoComplete\",\n                    data: autoSearch,\n                    dataType: \"json\",\n                    success: function (data) {\n                        response(data.d);\n                    },\n                    error: function (result) {\n                        alert(\"Error\");\n                    }\n                });\n            },\n            delay: 0,\n            minLength: 2\n        });\n    });\n</code></pre>\n\n<p>I'm very sure that it works because whenever I run a breakpoint on my controller, the method jsonAutoComplete runs but the productName which is what I want to appear on the autcomplete, is always null. Here's my code with the select statement:</p>\n\n<pre><code>    public JsonResult jsonAutoComplete(string searchText)\n    {\n        JsonResult data= new JsonResult();\n        IList&lt;Products&gt; products = null; products = (from c in db.Products where c.CompanyId.Equals(companyId) &amp;&amp; (c.ProductName.Contains(\"'%\" + searchText + \"%'\")) select c).ToList();\nProducts prod = new Products();\n        int productId = prod.Id;\n        string productName = prod.ProductName;\n        data.Data = new { productId = productId, productName = productName };\n        return data;\n    }`\n</code></pre>\n"},{"tags":["sql","oracle","yii"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13244057,"title":"how to get the second batch and 3rd batch in the same query result in oracle sql + yii framework?","body":"<p>let' say i have 20 results in the sql query. if am gonna use the limit in the yii active record, I'll obviously get the first four from the result, but what if i wanna get the 2nd four and then 3rd four in the same query result ? how to query that via sql ?</p>\n\n<p>e.g </p>\n\n<pre><code>        $criteria2 = new CDbCriteria();\n        $criteria2-&gt;select = 'USERID, ADID ,ADTYPE, ADTITLE, ADDESC, PAGEVIEW, DISPPUBLISHDATE';\n        $criteria2-&gt;addCondition(\"STATUS = 1\");\n        $criteria2-&gt;order = '\"t\".PAGEVIEW DESC,\"t\".PUBLISHDATE DESC';\n        $criteria2-&gt;limit = 4;\n        $criteria2-&gt;with = array('subcat','adimages');\n        $result = $this-&gt;findAll($criteria2);\n        return $result;\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13244172,"title":"SQL Check Constraint cannot reference other column","body":"<p>I trying to add this sql check in</p>\n\n<pre><code>ALTER TABLE School\nadd Role check_role\n  CHECK (check_role IN ('Teaching Assistant', 'Lecturer', 'Professor'));\n</code></pre>\n\n<p>I get the error below</p>\n\n<pre><code>ERROR at line 3:\nORA-02438: Column check constraint cannot reference other columns\n\nSQL&gt; desc School;\n Name                                      Null?    Type\n ----------------------------------------- -------- ----------------------------\n\n STAFFNUM                                  NOT NULL VARCHAR2(12)\n NAME                                      NOT NULL VARCHAR2(50)\n ADDRESS                                   NOT NULL VARCHAR2(300)\n DOB                                                DATE\n</code></pre>\n\n<p>I am trying add a column call Role, with the check constraint check_role</p>\n\n<p>I am using Oracle SQL.</p>\n\n<p><strong>Thanks for all help!</strong></p>\n"},{"tags":["c#","sql","datagridview","tableadapter","dataadapter"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2486,"score":1,"question_id":9770561,"title":"Updating MS Access Database from Datagridview","body":"<p>I am trying to update an ms access database from a datagridview.</p>\n\n<p>The datagridview is populated on a button click and the database is updated when any cell is modified.</p>\n\n<p>The code example I have been using populates on form load and uses the cellendedit event.</p>\n\n<pre><code>private OleDbConnection connection = null;\nprivate OleDbDataAdapter dataadapter = null;\nprivate DataSet ds = null;\nprivate void Form2_Load(object sender, EventArgs e)\n{\n\n    string connetionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='C:\\\\Users\\\\Peter\\\\Documents\\\\Visual Studio 2010\\\\Projects\\\\StockIT\\\\StockIT\\\\bin\\\\Debug\\\\StockManagement.accdb';Persist Security Info=True;Jet OLEDB:Database Password=\";\n    string sql = \"SELECT * FROM StockCount\";\n    connection = new OleDbConnection(connetionString);\n    dataadapter = new OleDbDataAdapter(sql, connection);\n    ds = new DataSet();\n    connection.Open();\n    dataadapter.Fill(ds, \"Stock\");\n    connection.Close();\n\n    dataGridView1.DataSource = ds;\n    dataGridView1.DataMember = \"Stock\";\n\n}\nprivate void addUpadateButton_Click(object sender, EventArgs e)\n{\n\n}\n\nprivate void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)\n{\n    try\n    {\n        dataadapter.Update(ds,\"Stock\");\n    }\n    catch (Exception exceptionObj)\n    {\n        MessageBox.Show(exceptionObj.Message.ToString());\n    }\n}\n</code></pre>\n\n<p>The error I receive is </p>\n\n<blockquote>\n  <p>Update requires a valid UpdateCommand when passed DataRow collection\n  with modified rows.</p>\n</blockquote>\n\n<p>I'm not sure where this command needs to go and how to reference the cell to update the value in the database.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13244489,"title":"INSERT INTO Table from multiple tables","body":"<p>Hey so I have a Junction table linking two unrelated tables. Both the tables have ID's. I need to select the ID from each table using WHERE with different values, for example this is how I see it.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO c (aID, bID)\nVALUES (SELECT a.ID WHERE a.Name=\"Me\", SELECT b.ID WHERE b.Class=\"Math\");\n</code></pre>\n\n<p>All the examples I've seen use a join statement but the two tables have a common value, in this case they don't. </p>\n"},{"tags":["sql","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13244173,"title":"RE : setting value to age but getting errors with null on other keys","body":"<p>I am working on a script (setage) which automatically sets the age from dob date in my table.</p>\n\n<p>this is my table (mytable) desc :</p>\n\n<pre><code>ID, NOT NULL, varchar(20)\nDOB, DATE\nAGE, int\n\n\ninsert into MYTABLE(AGE)\nSELECT TRUNC(MONTHS_BETWEEN(SYSDATE,DOB)/12)\nFROM MYTABLE;\n</code></pre>\n\n<p>But I am receiving an  error of</p>\n\n<pre><code>cannot insert NULL into (\"my-PC\".\"MYTABLE\".\"ID\")\n</code></pre>\n\n<p>I am sure that I several records inside my table with ID and DOB inputs, but not my age.\nBut why is the system saying I could not inside due to my ID field ?</p>\n"},{"tags":["mysql","sql","subquery"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13244144,"title":"Delete from table where key not found in other table?","body":"<p>Table 1: </p>\n\n<ul>\n<li>id </li>\n<li>name</li>\n</ul>\n\n<p>Table 2: </p>\n\n<ul>\n<li>id</li>\n<li>other_table_id </li>\n<li>table_1_id </li>\n<li>..</li>\n</ul>\n\n<p>Basically what I want to do is</p>\n\n<pre><code>Delete from table_1 \nwhere id not in (select table_1_id \n                 from table_2 \n                 group by table_1_id);\n</code></pre>\n\n<p>Which should work, what I am wondering is if the sub query is the best way to do this/ is there any other way?</p>\n"},{"tags":["c#","sql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13244052,"title":"Linq query using only year part of datetime","body":"<p>One of the column in my sqlserver table is datetime. In the where clause I have query just by the year (not month and date). I have to do it in LINQ using C#. Please let me know how could do it.</p>\n\n<p>For example if the following are the values in the table</p>\n\n<p>02/12/2010\n07/14/2011\n11/15/2012</p>\n\n<p>and if I query by '2011', only the middle row should be fetched.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","database"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13242427,"title":"How to structure my Users Database?","body":"<p>I have a website that allows users to be different types. Each of these types can do specific things. I am asking if I should set up 1 table for ALL my users and store the types in an enum, or should I make different tables for each type. Now, if the only thing different was the type it would be easy for me to choose only using one table. However, here's a scenario.</p>\n\n<p>The 4 users are A, B, C, D.</p>\n\n<p>User A has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n</ul>\n\n<p>User B has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n<li>phone</li>\n</ul>\n\n<p>User C has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n<li>phone</li>\n<li>about</li>\n</ul>\n\n<p>User D has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n<li>phone</li>\n<li>about</li>\n<li>address</li>\n</ul>\n\n<p>If I were to create a single table, should I just leave different fields null for the different users? Or should I create a whole separate table for each user?</p>\n"},{"tags":["mysql","sql","select","uppercase"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13243594,"title":"sql : select uppercase columns in database","body":"<p>I need to select columns that end in an uppercase extension.</p>\n\n<p>for example, look at the following table.</p>\n\n<pre><code>id - picture\n1 - abc.JPG\n2 - def.jpg\n3 - 123.jpg\n4 - xyz.JPG\n</code></pre>\n\n<p>the results should give me the rows 1 and 4 because JPG are in uppercase.</p>\n\n<p>can anyone help?</p>\n"},{"tags":["sql","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4065,"score":1,"question_id":4714239,"title":"How to delete last record(on condition) from a table in MySql","body":"<p>I have a <strong>LoginTime</strong> table like this:</p>\n\n<pre><code>id | user_id | datetime\n1  |   1     | 2011-01-17 18:51:05\n2  |   1     | 2011-01-18 18:51:05  \n3  |   1     | 2011-01-19 18:51:05  \n4  |   2     | 2011-01-19 18:51:05  \n</code></pre>\n\n<p>I want to delete last record for <code>user_id=1</code>. Last record of a user can be recognized by <code>datetime</code>.</p>\n\n<p>How can I do this with one query. </p>\n"},{"tags":["sql","mysql","sql-order-by","ordering"],"answer_count":9,"favorite_count":9,"up_vote_count":24,"down_vote_count":0,"view_count":10391,"score":24,"question_id":396748,"title":"Ordering by the order of values in a SQL IN() clause","body":"<p>I am wondering if there is away (possibly a better way) to order by the order of the values in an IN() clause.</p>\n\n<p>The problem is that I have 2 queries, one that gets all of the IDs and the second that retrieves all the information. The first creates the order of the IDs which I want the second to order by. The IDs are put in an IN() clause in the correct order.</p>\n\n<p>So it'd be something like (extremely simplified):</p>\n\n<pre><code>SELECT id FROM table1 WHERE ... ORDER BY display_order, name\n\nSELECT name, description, ... WHERE id IN ([id's from first])\n</code></pre>\n\n<p>The issue is that the second query does not return the results in the same order that the IDs are put into the IN() clause.</p>\n\n<p>One solution I have found is to put all of the IDs into a temp table with an auto incrementing field which is then joined into the second query.</p>\n\n<p>Is there a better option?</p>\n\n<p><strong>Note:</strong> As the first query is run \"by the user\" and the second is run in a background process, there is no way to combine the 2 into 1 query using sub queries.</p>\n\n<p>I am using MySQL, but I'm thinking it might be useful to have it noted what options there are for other DBs as well.</p>\n"},{"tags":["sql","sql-server","database","query","sql-server-2008-r2"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":11666009,"title":"SQL server query to get this output","body":"<p>I have a query which i am unable to get the output.\nBelow is the query to be executed</p>\n\n<p>Q: 2.   Write a query to find the city Name, Id and Count that has got maximum number of vehicles associated.</p>\n\n<p>Now, Given is the one table on which the query should be executed.</p>\n\n<pre><code>Vehicle_Detail_ID   City_ID\n56                    242\n57                    242\n58                    242\n59                    243\n60                    241\n61                    242\n62                    245\n</code></pre>\n\n<p>Another table which has the city name</p>\n\n<pre><code>City_ID City_Name\n242          Bangalore\n243          ChamarajNager\n241          Bellary\n245          Chitradurga\n</code></pre>\n\n<p>EXPECTED OUTPUT: </p>\n\n<pre><code>City_ID No_Vehicles\n242          4\n</code></pre>\n\n<p>Please tell me how to write the query which fetches me the right output.</p>\n\n<p>Given below is the query which gives the city Id and its vehicle count.\nTRIED: </p>\n\n<pre><code>SELECT c.city_id, COUNT(c.City_ID) AS NO_vehicles\n  FROM city c, vehicle_details v \n WHERE c.City_ID = v.City_ID\n GROUP BY c.City_ID\n</code></pre>\n\n<p>ACTUAL OUTPUT </p>\n\n<pre><code>City_ID No_Vehicles\n242             4\n243             1\n241             1\n245             1\n</code></pre>\n\n<p>Please help me to get max of these as shown in EXPECTED OUTPUT.</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13243425,"title":"Oracle error sql","body":"<p>I have to create a table and insert values into the tables. The tables is being created but it wont insert values.\nheres my code-</p>\n\n<pre><code>CREATE TABLE CUSTOMER(\nCID         number(20) not null primary key,        \nFNAME       varchar2(50) not null,                  \nMIDDLE      varchar2(50) null,\nLNAME       varchar2(50) not null,\nSTREET      varchar2(50) not null,\nCITY        varchar2(50) not null,\nSTATE       char(2) not null,\nZIP         varchar2(5) not null,\nPHONE       varchar2(20) not null,\nBIRTH_YR    date);\n\nINSERT INTO CUSTOMER VALUES(\n'1','john','paul','connor','Broad st','newark','nj','07103','2018643110','1992');\n</code></pre>\n\n<p>I keep getting an error </p>\n\n<pre><code>[Error] Script lines: 12-14 ------------------------\nORA-01861: literal does not match format string\nScript line 14, statement line 2, column 85 \n</code></pre>\n\n<p>Can somebody help me out? What am i doing wrong?</p>\n"},{"tags":["sql","sql-server-2005","sql-server-2008","bulkinsert"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":543,"score":3,"question_id":7937581,"title":"Issue with bulk insert","body":"<p>I am trying to insert the data from this link to my SQL server \n<a href=\"https://www.ian.com/affiliatecenter/include/V2/CityCoordinatesList.zip\" rel=\"nofollow\">https://www.ian.com/affiliatecenter/include/V2/CityCoordinatesList.zip</a></p>\n\n<p>I created the table </p>\n\n<pre><code>CREATE TABLE [dbo].[tblCityCoordinatesList](\n[RegionID] [int] NOT NULL,\n[RegionName] [nvarchar](255) NULL,\n[Coordinates] [nvarchar](4000) NULL\n</code></pre>\n\n<p>) ON [PRIMARY]</p>\n\n<p>And I am running the following script to do the bulk insert</p>\n\n<pre><code>BULK INSERT tblCityCoordinatesList\nFROM 'C:\\data\\CityCoordinatesList.txt' \nWITH \n( \n    FIRSTROW = 2, \n    MAXERRORS = 0, \n    FIELDTERMINATOR = '|', \n    ROWTERMINATOR = '\\n'\n)\n</code></pre>\n\n<p>But the bulk insert fails with following error</p>\n\n<pre><code>Cannot obtain the required interface (\"IID_IColumnsInfo\") from OLE DB provider \"BULK\" for linked server \"(null)\".\n</code></pre>\n\n<p>When I google, I found several articles which says the issue may be with RowTerminator, but I tried everything like /n/r, /n etc, but nothing is working. </p>\n\n<p>Could anyone please help me to insert this data into my database?</p>\n\n<p>Thank you so much for your help.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":1048,"score":5,"question_id":3650690,"title":"SQL SERVER Foreign Keys and Indexes","body":"<p>Is it a good practice to create an index to every foreing key  in my database?</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13243488,"title":"Difference of \"FROM a LEFT JOIN b\" vs. \"FROM a, b\"","body":"<p>Do the queries do the same? What is the standard?</p>\n\n<p>Will I lose performance if I change one of these ways of write the query?</p>\n\n<p>Query 1</p>\n\n<pre><code>   SELECT a.*, b.id AS b_id\n     FROM table_a AS a\nLEFT JOIN table_b AS b\n       ON a.id = b.id\n</code></pre>\n\n<p>Query 2</p>\n\n<pre><code>   SELECT a.*, b.id AS b_id\n     FROM table_a a, table_b b\n    WHERE a.id = b.id\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13243552,"title":"I'm trying to use the MySQL NOT IN command, but to no avail, could anyone point out the error in my syntax?","body":"<pre><code>(SELECT s\nFROM enrolls\nWHERE s)\nNOT IN\n(SELECT s\nFROM likes\nWHERE s);\n</code></pre>\n\n<p>I've got two tables, <code>enrolls</code> and <code>likes</code>, and I'm trying to find s from enrolls where all of the tuples of s <code>likes</code> and <code>enrolls</code> have in common are removed (or <code>enrolls - likes</code>, basically).</p>\n\n<p>I get the following error, though:</p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax to use\n  near 'NOT IN (SELECT s FROM likes WHERE s)' at line 4</p>\n</blockquote>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13242632,"title":"SQL Query with INI data?","body":"<p>I have a simple data table with the a column structure including: name, email, paid, and params</p>\n\n<p>The 'params' column contains custom fields filled in by a form from the user.  I have provided a sample submission value AT THE BOTTOM OF THIS QUESTION.  I i would like to display:</p>\n\n<p>custom_field_value_1_person_1</p>\n\n<p>custom_field_value_2_person_1</p>\n\n<p>custom_field_value_3_person_1</p>\n\n<p>custom_field_value_4_person_1</p>\n\n<p>Is there any way to retrieve these from such data?</p>\n\n<p>Right now my simple query reads: </p>\n\n<pre><code>SELECT\n  R.ohanah_registration_id,\n  E.title AS Event,\n  R.name,\n  R.email,\n  R.paid\nFROM\n waqcl_ohanah_registrations R LEFT JOIN waqcl_ohanah_events E\n  ON R.ohanah_event_id = E.ohanah_event_id\n</code></pre>\n\n<p>SAMPLE SUBMISSION VALUE:\nfield_name_person_1=field_name_person_2=field_name_person_3=field_name_person_4=field_name_person_5=custom_field_value_1_person_1=\\CrossFit Gold\\\"custom_field_value_1_person_2=\\\"\\\"custom_field_value_1_person_3=\\\"\\\"custom_field_value_1_person_4=\\\"\\\"custom_field_value_1_person_5=\\\"\\\"custom_field_value_2_person_1=\\\"XL\\\"custom_field_value_2_person_2=\\\"\\\"custom_field_value_2_person_3=\\\"\\\"custom_field_value_2_person_4=\\\"\\\"custom_field_value_2_person_5=\\\"\\\"custom_field_value_3_person_1=\\\"m\\\"custom_field_value_3_person_2=\\\"\\\"custom_field_value_3_person_3=\\\"\\\"custom_field_value_3_person_4=\\\"\\\"custom_field_value_3_person_5=\\\"\\\"custom_field_value_4_person_1=\\\"916-952-..  </p>\n"},{"tags":["sql","google-bigquery"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13203402,"title":"Maximum number of allowed datasets in one project","body":"<p>Is there a limit on how many datasets I can create in one BigQuery project? I did not find this limit anywhere mentioned in documentations.</p>\n\n<p>I am asking this because I want to create a dataset per day. Under the daily dataset, there will be the same number of tables being created with the daily data. E.g.,</p>\n\n<pre><code>dataset_20121101\n   - table1\n   - table2\ndataset_20121102\n   - table1\n   - table2\n...\ndataset_201XXXXX\n   - table1\n   - table2\n</code></pre>\n\n<p>Also if I want to do a query over a range of datasets, can I do something better than explicitly selecting from every single dataset? For instance,</p>\n\n<pre><code>select date, sum(price) from \n dateset_20121101.table1, \n dateset_20121102.table1,\n dateset_20121103.table1,\n dateset_20121104.table1\n group by date order by date\n</code></pre>\n\n<p>I guess not, but just try to confirm. </p>\n\n<p>Thanks. </p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13243171,"title":"select into vs insert sql statement","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6947983/insert-into-vs-select-into\">INSERT INTO vs SELECT INTO</a>  </p>\n</blockquote>\n\n\n\n<p>I have a really hard time understanding what is the difference between select into and a insert statement, I always use insert, but, for some reason, I think having a select into will maximize insertion from a table, am I right? I'm new to SQL queries, please understand me.</p>\n\n<p>Could you please give me some hint on what is there difference? Is it possible to have a statement like</p>\n\n<pre><code>select * into northwind from northwind2\n</code></pre>\n\n<p>where northwind has equal tables with northwind2? like its just a backup?\nor could there be a select like an insert like...</p>\n\n<p>(excuse me for being noobish)</p>\n\n<pre><code>select lastname+firstname+middlename as [name] into northwind from northwind2?\n</code></pre>\n\n<p>thanks!</p>\n"},{"tags":["php","sql","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13243092,"title":"UPDATE inside a WHILE statement","body":"<p>So, I have a page with a bunch of workorders on it. Each workorder is a row in a single table, and gets put on the page with a while() statement. \nI'm trying to update each row with a simple form that I put inside the while(), and an UPDATE/WHERE statement to actually add the information to the table.</p>\n\n<p>Instead of adding it to the specific row, it adds it to Every row. The only thing I can think of is that my WHERE condition is wrong, but I can't seem to figure it out. Maybe it just needs fresh eyes, or maybe I'm heading in Completely the wrong direction.</p>\n\n<p>Also, any specific instructions on security, a better way to do it, etc. would be very helpful. I'm learning PHP on the fly and could use a helping hand. :)</p>\n\n<pre><code>&lt;?php\n\n        $query = \"SELECT * FROM client_information\"; \n\n        $result = mysql_query($query) or die(mysql_error());\n\n\n        while($row = mysql_fetch_array($result)){ \n\n        $which_ad = $row['ID'];?&gt;\n\n            &lt;b&gt;Name:&lt;/b&gt; &lt;? echo $row['billing_name']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Job Type:&lt;/b&gt; &lt;? echo $row['job_type']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Size:&lt;/b&gt; &lt;? echo $row['size']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Text:&lt;/b&gt; &lt;? echo $row['text']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Notes:&lt;/b&gt; &lt;? echo $notes; ?&gt; &lt;br&gt;\n\n            &lt;br&gt;&lt;br&gt;\n\n        &lt;form action=\"small_update.php\" method=\"POST\"&gt;\n        &lt;strong&gt;Email Message:&lt;/strong&gt;&lt;br&gt;\n        &lt;textarea rows=\"8\" cols=\"60\" name=\"email_message\"&gt;&lt;/textarea&gt;        \n        &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;&lt;/form&gt;\n\n\n&lt;?\n$email_message = htmlspecialchars (\"{$_POST['email_message']}\", ENT_QUOTES);\n\n\nif (mysql_errno() != 0) {\ndie(mysql_error());\n}\n\nmysql_query(\n\"UPDATE client_information\nSET email_message='$email_message'\n\nWHERE ID='$which_ad'\"\n);\n\n\nif (mysql_errno() != 0) {\ndie(mysql_error());\n}\n\n    }\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","ruby","postgresql","timezone","dst"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":60,"score":6,"question_id":13239534,"title":"Accounting for DST in Postgres, when selecting scheduled items","body":"<p>I have a <strong>Postgres</strong> table of <strong>clock alarms</strong> (not really, but this is analogous, and easier to explain). Alarms are set by users with a 1 hour resolution, and users can be from many different timezones. The alarms are repeating daily. I want to reliably fetch the alarms that are supposed to go off at a particular hour of the day, and I am <strong>having problems with daylight saving time</strong>. How do I do this in the best way?</p>\n\n<h3>Example</h3>\n\n<blockquote>\n  <p>Alfred and Lotta both live in Stockholm (+1 hour from UTC, but +2h\n  when it's DST).<br> Sharon lives in Singapore (+8 hours from UTC, no\n  DST)</p>\n  \n  <p>During winter, Alfred sets an alarm for 4 AM. The alarm should go off\n  at 4 AM local time, all year.<br> During summer, Lotta sets an alarm\n  for 5 AM. Again, it should go off at 5 AM all year round.<br>\n  Meanwhile, Sharon has set an alarm for 11 AM.</p>\n  \n  <p>All of these can be stored in the database as 03:00 UTC.</p>\n  \n  <p>If I query the database in the winter for alarms that should go off at\n  03:00 UTC, I want Alfred's and Sharon's alarms. Singapore is now +7h\n  from Sweden, so 11 AM in Singapore is 4 AM in Sweden. Lotta's alarm\n  should not go off for another hour.</p>\n  \n  <p>Conversely, if I query the database in the summer for alarms that\n  should go off at 03:00 UTC, I want Lotta's and Sharon's alarms.\n  Singapore is +6h from Sweden now, so 11 AM in Singapore is 5 AM in\n  Sweden now. Sven's alarm went off an hour ago.</p>\n</blockquote>\n\n<p><strong>How do I store this, and query the database?</strong></p>\n\n<p>I can change the db schema if necessary. At the moment, we don't adjust for DST at all, and in fact just have an \"hour\" integer field (which seems dumb, a time field would be better).</p>\n\n<p>It seems I need to store both a UTC time and timezone information, but I don't know how to best achieve this in Postgres. I've found that Postgres has some sort of concept of timezones, but no timezone field type as far as I can tell. Also, I guess I need to do some calculations in SQL to determine how to offset the UTC time in the select, based on the timezone data and the creation date. I'm not great with SQL…</p>\n\n<p>I do want to solve this in Postgres, as there can be a lot of \"alarms\", and I want to avoid the performance issues that come with fetching all of them into Ruby and filter there. (Yes, this is a Rails app.)</p>\n"},{"tags":["mysql","sql","mysql-workbench","alter-table"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":113,"score":2,"question_id":12542409,"title":"MySQL Workbench alter table","body":"<p>I create a table with mysql workbench. </p>\n\n<p>The screenshot before \"Apply\";</p>\n\n<p><img src=\"http://i.stack.imgur.com/mru4J.png\" alt=\"enter image description here\"></p>\n\n<p>It creates the table without any error.</p>\n\n<p>After \"Alter Table...\" the screenshot;</p>\n\n<p><img src=\"http://i.stack.imgur.com/zSVwD.png\" alt=\"enter image description here\"></p>\n\n<p>Is this a turkish character problem?\nHow can i fix it?</p>\n"},{"tags":["mysql","sql"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":104,"score":3,"question_id":12469270,"title":"MySQL Get Time of Old Record Insert?","body":"<p>I have a table in my database which contains all of the users for my application. Unfortunately, when I launched my application, I didn't think to include a column which tracked the time at which a particular user signed up, and now I wish I had (bad idea, yes indeed).</p>\n\n<p>Is there, by any shred of luck, a way that MySQL tracks when a particular record is inserted (such as in record metadata???), and would allow me to grab it and insert in into a new dedicated column for this purpose?</p>\n\n<p>I am running on a shared cPanel host, so I doubt I have access to the MySQL logs.</p>\n\n<p>Thank you for your time.</p>\n"},{"tags":["sql","vba","ms-access","access-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13242692,"title":"Subform \"assigned\" control not updating","body":"<p>I'm creating a MS Access 2010 database to allow users enter series of data which would be used in a query.</p>\n\n<p>I have a Main form named \"Entry\" and a bounded subform named \"SubEntry\" (used to view the entered records).\nThe main form (Entry) consists of text/combo box controls that allows users to key in values, such as:</p>\n\n<pre><code>**Controls       ControlSource**\n\nDate             \"Entered by the user\"\nCompanyID        \"Entered by the user\"\nTicketID         \"Entered by the user\"\nTicketPrice      \"Automatic retrieved by a query based on the entered 'Date' and 'TicketID' \"\nPieces           \"Entered by the user\"\nTotalPrice       \"TicketPrice * Pieces\"\nCorrectedPrice   \"Entered by the User\"\nRevenue          \"=IIf([CorrectPrice]=0,[TotalPrice],[CorrectPrice])\"\n</code></pre>\n\n<p>This works fine with entering and viewing record-sets. But the problem is, at the initial stage when the user adds recordset to the subform, the exact \"Revenue\" value is added to the subform's \"Revenue\" field. But after then, when the user scrolls in the subfrom and chooses a recordset (which appears in the main form's respective controls) and changes the values. For instance chooses another ticketID or Date, the \"Revenue\" value in the main form changes but not updated in Subform's Revenue field. Meanwhile anyother changes made main form automatically updates in the subform but not that of the \"Revenue\" value.</p>\n\n<p>I'm not that conversant with MS Access nor VBA, just wondering if there is something obvious that is missing? How to deal with the SubEntry's \"Revenue\" field to automatically updates like any other fields in the subform does. </p>\n\n<p>Thanks for your time and assistance.</p>\n"},{"tags":["sql","logic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13242001,"title":"SQL Logic issue","body":"<p>I am in quite the pickle! I am checking a table that contains information related to patient vaccines. For each patient, there are three possible vaccines stored in four rows. These vaccines have a related yes/no value that depicts whether or not the vaccine was in effect. These vaccine rows each had a 'static' de_name column that held the name of the vaccine that was potentially being administered. If the vaccine had a yes value, there is also a related row that holds a date value of when the vaccine was administered. Luckily, this second row containing dates also contained the name of the field, which could be used to deduce which vaccine was administered. Due to the row nature of this table, there was no obvious way (to me) to search through each patient other than to turn each possibility into it's own column and coalesce the results. This allowed me to create two pretty columns for both the administered vaccines and the date the vaccines were administered. This worked because I did not need to reference the rows that pertained to the yes/no value because the name of the vaccine and the fact that the date existed allowed me to use just the date field itself. </p>\n\n<p>Everything was fine and dandy until I was asked to add a fourth vaccine, which instead of holding a yes/no value, contained free-text. I was asked to place the free-text in the same column as the other vaccines 'static' text. This is an issue because unlike the rest of the vaccines, there was no column in the fourth vaccines date row that displayed the non-date row vaccine free-text entry. I had to reference the fourth row's free-text while also referencing the fourth row's related vaccine date row's date value. The issue comes in when, I have no idea how to join to rows (by a permanent visit number) within a Case statement within a coalesce statement! Any help would be wonderful!</p>\n\n<p>Please let me know if there is any other data you need me to include. I am including apprehensively some dummy data and what my query would currently display.</p>\n\n<p>Data_Points Table:</p>\n\n<pre><code> De_Num       De_Name                        De_Value     Perm_Visit_Num    PatientID\n\n 6224       Flu vaccine                        yes             10111           12\n 6225    Flu vaccine date administered       11/00/2012        10111           12\n 6226     Pneumonia vaccine                    yes             10112           12\n 6227  Pneumonia vaccine date administered   11/01/2012        10112           12\n 6228      Tetanus vaccine                     yes             10113           12\n 6229   Tetanus vaccine date administered    11/02/2012        10113           12\n 6230      Other vaccine                 arbitrary free-text   10114           12\n 6231  Other vaccine date administered       11/03/2012        10114           12\n 6224       Flu vaccine                        yes             10115           10\n 6225    Flu vaccine date administered       11/00/2012        10115           10\n 6226     Pneumonia vaccine                    yes             10116           10\n 6227  Pneumonia vaccine date administered   11/01/2012        10116           10\n 6228      Tetanus vaccine                     yes             10117           10\n 6229   Tetanus vaccine date administered    11/02/2012        10117           10\n 6230      Other vaccine              more arbitrary free-text 10118           10\n 6231  Other vaccine date administered       11/03/2012        10118           10    \n</code></pre>\n\n<p>My Query</p>\n\n<pre><code>select * \nfrom\n(select\n        COALESCE(\n            CASE\n                WHEN de_num = '6225' THEN DE_Name\n            END,\n            CASE\n                WHEN de_num = '6227' THEN DE_Name\n            END,\n            CASE\n                WHEN de_num = '6229' and perm_visit_num in (select perm_visit_num from data_points where de_num = '6228' and de_value = 'Yes') THEN de_name\n            END,\n            CASE\n                WHEN de_num = '6230' THEN DE_Value\n            END\n        ) VaccineAdministered,\n        COALESCE(\n            CASE\n                WHEN de_num = '6225' THEN CASE DE_Value WHEN null THEN null ELSE DE_Value END\n            END,\n            CASE\n                WHEN de_num = '6227' THEN CASE DE_Value WHEN null THEN null ELSE DE_Value END\n            END,\n            CASE\n                WHEN de_num = '6229' and perm_visit_num in (select perm_visit_num from data_points where de_num = '6228' and de_value = 'Yes') THEN CASE DE_Value WHEN null THEN null ELSE DE_Value END\n            END,\n            CASE\n                WHEN de_num = '6230' THEN 'foo'\n            END\n        )\nfrom data_points\nWHERE DE_Num in ('6227','6225','6229','6230')\n)\nwhere vaccineadministered != ''\n</code></pre>\n\n<p>The result set with that dummy data and the current sql query above:</p>\n\n<pre><code>Vaccine Administered                   DateAdministered\n\nFlu vaccine date administered             11/00/2012\nPneumonia vaccine date administered       11/01/2012\nTetanus vaccine date administered         11/02/2012\narbitrary free-text                          foo\nFlu vaccine date administered             11/00/2012\nPneumonia vaccine date administered       11/01/2012\nTetanus vaccine date administered         11/02/2012\nmore arbitrary free-text                     foo\n</code></pre>\n\n<p>My issue is that I cannot figure out a way to pull both the free-text AND the associated date. I can get either or, and in this query I get the free-text.</p>\n\n<p>Please understand this is a very hard thing to explain and I am really in need of help. Thanks!</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2008-r2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13242261,"title":"sql server query on condition","body":"<p>There is a table:</p>\n\n<pre><code>ID   Name   Rank\n1    X       Professor\n2    X       Principal\n3    X       Term Prof\n4    X       assistant\n</code></pre>\n\n<p>What I want is want to write the stored procedure to select the last professor rank or assistant rank depending on the input. Here is the format of the stored proc:</p>\n\n<pre><code>create procedure proc_name(@includeassistant varchar(3))\n\nend\n</code></pre>\n\n<p>if includeassistant is \"yes\" then assistant then the last row must be displayed if include assistant is no then Term prof row must be given.\n</p>\n"},{"tags":["sql","math","regression"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":310,"score":3,"question_id":9292209,"title":"Need SQL Server Query to solve 3rd Order Polynomial Regression","body":"<p>Can anyone help with some SQL query code to provide estimates of the co-efficients for a 3rd order Polynomial regression?</p>\n\n<p>Please assume that I have a table of X and Y data values and want to estimate a, b and c in:</p>\n\n<pre><code>Y(X) = aX + bX^2 + cX^3 + E \n</code></pre>\n"},{"tags":["mysql","sql","join","query-optimization","outer-join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13242293,"title":"Simplifying a query (with left outer join)","body":"<p>Our app has been using this query for a while now:</p>\n\n<pre><code>SELECT id \nFROM invoice \nWHERE id NOT IN \n(SELECT invoice_id FROM invoice_transaction) \n\n#437 rows returned\n</code></pre>\n\n<p>In a code review, this query was rewritten with a left outer join:</p>\n\n<pre><code>SELECT invoice.id \nFROM invoice \nLEFT OUTER JOIN invoice_transaction on invoice.id=invoice_transaction.invoice_id \n\n#586 rows returned\n</code></pre>\n\n<p>The first query returns 437 rows and the second (supposedly identical) query returns 586 rows.  Is this not a valid use of the left outer join?  </p>\n\n<p>What would be a better way to rewrite this query?</p>\n\n<p>Thank you!</p>\n"},{"tags":["mysql","sql","query","group-by","case"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13228875,"title":"Using CASE WHEN with GROUP BY","body":"<p>Background: I'm trying to display a table with the headings: id, full_name, position_7, position_8, position_9...etc if a person was an active employee for Jul and Aug, then 2012_Jul and 2012_Aug will be displayed in position_7 and 8 on one line. If I don't use GROUP BY I get the output but on 2 lines. The reason this is happening is because in the BLMths table a single person will have multiple entries due to being employed for more than 1 month. </p>\n\n<p>The below query will get every persons id, full_name and month successfully...if I don't use GROUP BY. But the problem is, if I neglect to use GROUP BY I will have 4 lines (or more) for each person in my table.   When I do use GROUP BY, I have the desired output of 1 line for each person, but the data I need in the table isn't all there.</p>\n\n<p>Does anyone know what I'm doing wrong?  Or does anyone know why when I use GROUP BY the data from some of my CASE statements appear to be missing?</p>\n\n<p>I know the answer to this has to be simple, but I can't seem to solve it.  Any help is appreciated.   Many thanks in advance.</p>\n\n<pre><code>SELECT Blm.Ags, Blmths.Id, Ie.Full_Name, Blmths.Month,\n       CASE month\n       WHEN \"2012-07-01\" THEN 1\n           ELSE NULL\n       END AS Position_7,\n       CASE month\n       WHEN \"2012-08-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_8,\n       CASE Blmths.Month\n       WHEN \"2012-09-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_9,\n       CASE month\n       WHEN \"2012-10-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_10,\n       CASE Blmths.Month\n       WHEN \"2012-11-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_11,\n       CASE Blmths.Month\n       WHEN \"2012-12-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_12,\n       CASE month\n       WHEN '2013-01-01' THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_1,\n       CASE month\n       WHEN \"2013-02-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_2,\n       CASE month\n       WHEN \"2012-03-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_3,\n       CASE Blmths.Month\n       WHEN \"2013-04-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_4,\n       CASE Blmths.Month\n       WHEN \"2013-05-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_5,\n       CASE Blmths.Month\n       WHEN \"2013-06-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_6\n  FROM Bogus_Leadership_Months AS Blmths, Injection_Employees AS Ie,\nBogus_Leadership_Members AS Blm\n  WHERE Blmths.Id = Blm.Id\n    AND Ie.Ags = Blm.Ags\n    AND Ie.Centre_Id = '666'\n  GROUP BY Blm.Ags\n</code></pre>\n"},{"tags":["sql","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13202376,"title":"How to write this SQL for linking data in DB2?","body":"<p>For example, there are two columns - ID1 and ID2 which are linked to each other. It is possible that the IDs are linked with other IDs in the table.</p>\n\n<pre><code>ID1         ID2\n------------------\n001         002\n001         003\n004         005\n002         006\n005         007\n</code></pre>\n\n<p>In the above table, 001, 002, 003, 006 are linked and 004, 005, 007 are linked.</p>\n\n<p>Is it possible to query this information in SQL for DB2?</p>\n\n<p>The format is similar as the following:</p>\n\n<pre><code>Group       ID\n--------------\n1           001\n1           002\n1           003\n1           006\n2           004\n2           005\n2           007\n</code></pre>\n\n<p>On the other hand, if one more record (008, 007) is added to the table</p>\n\n<pre><code>ID1         ID2\n------------------\n001         002\n001         003\n004         005\n002         006\n005         007\n008         007  (Newly added)\n</code></pre>\n\n<p>The expected result will be:</p>\n\n<pre><code>Group       ID\n--------------\n1           001\n1           002\n1           003\n1           006\n2           004\n2           005\n2           007\n2           008\n</code></pre>\n\n<p>because 004, 005, 007, 008 are linked.</p>\n\n<p>The DB2 Version is 9.7.</p>\n"},{"tags":["sql","sql-server","xml","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13242295,"title":"Add elements and attributes to XML column based on criteria?","body":"<p>With the following, I'd like to add <code>../attrdomv/udom/'some text'</code> within each <code>attr</code> node, of which there are many. However, based on the value of <code>attrlab</code>, 'some text' will be different for each element. I hope that makes sense. I initially considered reconstructing the entire xml column, but <code>'many nodes and elements'</code> contains attributes that are specific to a row, and not easy to reproduce prorgammatically. <code>../attrdomv/udom/'some text'</code> will be the same across each row. Here is a snippet of an existing column:</p>\n\n<pre><code>&lt;metadata xml:lang=\"en\"&gt;\n&lt;many nodes and elements&gt;\n  &lt;eainfo&gt;\n    &lt;detailed Name=\"fire.DBO.labels\"&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;OBJECTID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;OBJECTID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;OID&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdef Sync=\"TRUE\"&gt;Internal feature number.&lt;/attrdef&gt;\n        &lt;attrdefs Sync=\"TRUE\"&gt;Esri&lt;/attrdefs&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Sequential unique whole numbers that are automatically generated.&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;FeatureID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;FeatureID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;ZOrder&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;ZOrder&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;SymbolID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;SymbolID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n      &lt;/attr&gt;\n    &lt;/detailed&gt;\n  &lt;/eainfo&gt;\n&lt;/metadata&gt;\n</code></pre>\n\n<p>...and here is my desired result:</p>\n\n<pre><code>&lt;metadata xml:lang=\"en\"&gt;\n&lt;many nodes and elements&gt;\n  &lt;eainfo&gt;\n    &lt;detailed Name=\"fire.DBO.labels\"&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;OBJECTID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;OBJECTID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;OID&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdef Sync=\"TRUE\"&gt;Internal feature number.&lt;/attrdef&gt;\n        &lt;attrdefs Sync=\"TRUE\"&gt;Esri&lt;/attrdefs&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Sequential unique whole numbers that are automatically generated.&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;FeatureID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;FeatureID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Sequential unique GUID's that are automatically generated.&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;ZOrder&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;ZOrder&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Order of the Z&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;SymbolID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;SymbolID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Symbol Identifier GUID &lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n    &lt;/detailed&gt;\n  &lt;/eainfo&gt;\n&lt;/metadata&gt;\n</code></pre>\n"},{"tags":["sql","postgresql","plpgsql","upsert","postgresql-performance"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13233369,"title":"Replace looping with a single query for INSERT / UPDATE","body":"<p>I am writing a function in PostgreSQL. It does basically 3 steps:</p>\n\n<ol>\n<li>Fetch a record from source table.</li>\n<li>check the value from the fetched record in target table, if record is found in target table then update all values of target table with fetched record otherwise insert fetched record to target table.</li>\n</ol>\n\n<p>Instead of doing this looping, if I write <strong>single query</strong> for insert/update, will it be faster than above mentioned approach? How can I achieve same result by writing single query instead looping through every records and doing updation/insertion.</p>\n\n<p>My current approach is as below </p>\n\n<pre><code>CREATE OR REPLACE FUNCTION fun1()\n  RETURNS void AS\n$BODY$DECLARE\n   source_tab_row RECORD;\n\n   v_col1 TEXT;\n   v_col2 TEXT;\n   v_col3 TEXT;\n   v_col4 double precision ;\n   cnt integer;\n\nBEGIN\n    FOR source_tab_row IN (SELECT * FROM source_tab where col5='abc')\nLOOP\n    v_col1=source_tab_row.col1;   \n    v_col2=source_tab_row.col2;\n    v_col3=source_tab_row.col3;\n    v_col4=source_tab_row.col4;\n\n    select count(*) INTO cnt from dest_tab where col1=v_col1;\n\n     if (cnt =0) then\n     -- If records is not found\n       INSERT INTO dest_tab(col1, col2, col3,col4)\n       VALUES( v_col1, v_col2, v_col3,v_col4)   ;\n    else\n     --if records found then update it\n       update dest_tab set col1=v_col1, col2=v_col2, col3=v_col3,col4=v_col4\n       where col1=v_col1;\n\n     end if;         \nEND LOOP;\nEND;\n$BODY$ LANGUAGE plpgsql;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13242004,"title":"How do I display different values as different columns in SQL?","body":"<p>I have a table with columns <code>UserID, SiteID, SiteViews</code> and another with <code>UserID, First, Last</code></p>\n\n<p>And I need to display the data as <code>First + Last, Site1Views, Site2Views</code></p>\n\n<p>There are only 2 site IDs and I need to have the sum of the SiteViews per User.</p>\n\n<p>Currently I have:</p>\n\n<pre><code>select s.UserFirstName + ' ' + s.UserLastName as 'Name', \nj1.SiteViews as 'Site1Name',\nj2.SiteViews as 'Site2Name' \nfrom (Users s INNER JOIN Usage j on s.UserID = j.UserID)\n</code></pre>\n\n<p>I don't know how to do this. Any help would be appreciated.</p>\n"},{"tags":["python","sql","postgresql","pgadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":93,"score":2,"question_id":13239004,"title":"Create SQL table with correct column types from CSV","body":"<p>I've looked a a number of questions on this site and cannot find an answer to the question: How to create <strong>multiple NEW tables</strong> in a database (in my case I am using PostgreSQL) <strong>from multiple CSV source files</strong>, where the new database table columns accurately reflect the data within the CSV columns?</p>\n\n<p>I can write the CREATE TABLE syntax just fine, and I can read the rows/values of a CSV file(s), but does a method already exist to inspect the CSV file(s) and accurately determine the column type?  Before I build my own, I wanted to check if this already existed.</p>\n\n<p>If it doesn't exist already, my idea would be to use Python, CSV module, and psycopg2 module to build a python script that would:</p>\n\n<ol>\n<li>Read the CSV file(s).</li>\n<li>Based upon a subset of records (10-100 rows?), iteratively inspect each column of each row to automatically determine the right column type of the data in the CSV.  Therefore, if row 1, column A had a value of 12345 (int), but row 2 of column A had a value of ABC (varchar), the system would automatically determine it should be a format varchar(5) based upon the combination of the data it found in the first two passes.  This process could go on as many times as the user felt necessary to determine the likely type and size of the column.</li>\n<li>Build the CREATE TABLE query as defined by the column inspection of the CSV.</li>\n<li>Execute the create table query.</li>\n<li>Load the data into the new table.</li>\n</ol>\n\n<p>Does a tool like this already exist within either SQL, PostgreSQL, Python, or is there another application I should be be using to accomplish this (similar to pgAdmin3)?</p>\n"},{"tags":[".net","sql","frameworks"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":13240513,"title":"Value of Developing a SQL Framework Similar to .NET","body":"<p>With the widespread support of Microsoft's .NET Framework for C#, Visual Basic, F#, PowerShell, etc.., I've been wondering why there hasn't been any similar database development frameworks created (I haven't been able to find any at least).</p>\n\n<p>This lead me to consider developing my own framework, but I can't help but think that if it there was a significant need for something like this, that surely someone would have started a project like this already, either commercially or as an open source project.</p>\n\n<p>My preliminary thoughts about the technical aspects are:</p>\n\n<ul>\n<li>The framework would be modeled after the Microsoft .NET Framework as much as possible. Personally, I'm somewhat biased towards .NET &amp; T-SQL, but I think that by providing similar functionality to .NET would help ease the learning curve for new developers too.</li>\n<li>There would be an installer of some type with the option to deploy the framework objects in a separate, dedicated database, or include the objects in another database's schema. Also, with an option to simply generate the scripts to create the objects.</li>\n<li>Ability to select which objects to install (similar to how jQuery UI lets you choose which components you want in your <a href=\"http://jqueryui.com/download/\" rel=\"nofollow\">custom download package</a>) to keep databases from becoming bloated.</li>\n<li>Support for strict ANSI SQL, as well as vendor-specific versions (e.g. SQL Server, Oracle, MySQL).</li>\n</ul>\n\n<p>I guess what I'm really looking for is:</p>\n\n<ol>\n<li>Has anyone has come across anything like this that has already been developed?  </li>\n<li>Do you have any pertinent insight as to why this would be good or bad idea, either generally speaking or in regards to the things I mentioned here?</li>\n</ol>\n\n<p><strong>Edit</strong></p>\n\n<p>Basically, I'm envisioning the framework as providing a common set of helper functions/procedures, tally/number tables, etc...</p>\n\n<p>A prime example would be a function to format a date into a string that could be used with SQL Server pre-2012 versions (SQL Server 2012 introduced this as a built-in function).</p>\n\n<p>And, by framework, I'm thinking along the lines of development within the database (i.e. programming functions, stored procedures, ad-hoc scripts, etc...) vs. interacting with or connecting to the database externally (e.g. Ling2Sql, ORM's).</p>\n"},{"tags":["sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13241622,"title":"Rails: OUTER JOIN with condition","body":"<p>I have 2 models Show and Booking. A show has many bookings. Each booking has a start_date and end_date. I want to find the shows that either i) have no bookings or ii) have bookings that do not overlap with a time interval [start, end]. So far I have:</p>\n\n<pre><code>Show.joins(\"LEFT JOIN bookings ON bookings.show_id = shows.id\").where(\"bookings.start_date &gt; ? OR bookings.end_date &lt; ?, end, start)\n</code></pre>\n\n<p>But it doesn't return the shows that have no bookings. How can I include the shows that have no bookings in the query result?</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":10883930,"title":"Create a view that shows from which table content comes","body":"<p>I have a little problem with a postgreSQL view I have to create for a school project.</p>\n\n<p>I have five tables named:</p>\n\n<ul>\n<li>Input(inputId , distributorId , date)</li>\n<li>Inputline(InputId, ObjectId, ammount)</li>\n<li>Output(outputId, clientId, date)</li>\n<li>Outputline(outputId, ObjectId, ammount)</li>\n<li>Stock(ObjectId, ammount)</li>\n</ul>\n\n<p>Now I need a view which shows me the changes (per objectId) made in chronological order like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>| Date       | type   | ammount In | ammount out |\n+------------+--------+------------+-------------+\n| 10-10-2007 | Input  | 10         |             |\n| 11-10-2007 | Output |            | 5           |\n| 12-10-2007 | Input  | 20         |             |\n</code></pre>\n\n<p>I have absolutely no clue on how to do this so I would really appreciate your help.\nIf more details are needed, don't hesitate to ask =)</p>\n"},{"tags":["sql","postgresql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":83,"score":0,"question_id":10885499,"title":"SQL, select in tables","body":"<p>Hey I don't know how to do it....</p>\n\n<p>Its a homework: List the code and the consumers who bought cars only 'Argentina' country.</p>\n\n<blockquote>\n<pre><code>Table sell:\n</code></pre>\n</blockquote>\n\n<pre><code>customer | resell  | veicle    |    date    |  value\n---------+---------+-----------+------------+----------\n 02      | 01      | 03        | 2010-02-05 | 17500.00\n 04      | 02      | 01        | 2010-01-07 | 28000.00\n 01      | 03      | 08        | 2010-02-15 | 28000.00\n 02      | 03      | 02        | 2010-03-12 | 42000.00\n 03      | 04      | 06        | 2010-02-06 | 11500.00\n 03      | 02      | 05        | 2010-01-25 | 22100.00\n 01      | 01      | 04        | 2010-01-21 | 15500.00\n</code></pre>\n\n<blockquote>\n  <p>Table customer:</p>\n</blockquote>\n\n<pre><code> cod    |    name    | lastname\n--------+------------+------------\n 01     | Jose       | Alves\n 02     | Paulo      | Cunha\n 03     | Maria      | DPaula\n 04     | Joana      | Silveria\n</code></pre>\n\n<blockquote>\n  <p>Table veicle:</p>\n</blockquote>\n\n<pre><code> cod    |manufacturer|     model       | year |  country  |  price\n--------+------------+-----------------+------+-----------+----------\n 01     | 01         | Gol             | 2000 | Brasil    | 25000.00\n 02     | 01         | Golf            | 2005 | Argentina | 39000.00\n 03     | 04         | Ford Ka         | 1990 | Brasil    | 15000.00\n 04     | 03         | Corsa Seda      | 1995 | Brasil    | 12500.00\n 05     | 04         | Fiesta          | 2003 | Argentina | 20000.00\n 06     | 03         | Corsa Seda      | 1995 | Argentina | 10000.00\n 07     | 05         | Palio           | 2002 | Brasil    | 15000.00\n 08     | 05         | Siena           | 2006 | Brasil    | 26000.00\n</code></pre>\n\n<p>I guess it to start:</p>\n\n<pre><code>SELECT customer.cod, customer.name \nFROM sell, customer \nWHERE (SELECT cod \n        FROM veicle \n        WHERE veicle.country = 'Argentina') = sell.veicle;\n</code></pre>\n\n<p>To select only the argentine cars...\nPlease guide-me to the answer.</p>\n"},{"tags":["sql","hive","hiveql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13166708,"title":"How to use min() in where/having clause (to avoid subquery) in Hive/SQL","body":"<p>I have a large table of events. Per user I want to count the occurence of type A events before the earliest type B event.</p>\n\n<p>I am searching for an elegant query. Hive is used so I can't do subqueries </p>\n\n<pre><code>Timestamp Type User \n...        A    X\n...        A    X\n...        B    X\n...        A    X\n...        A    X\n\n...        A    Y\n...        A    Y\n...        A    Y\n...        B    Y\n...        A    Y\n</code></pre>\n\n<p>Wanted Result:</p>\n\n<pre><code>User Count_Type_A \nX    2\nY    3\n</code></pre>\n\n<p>I could not get the \"cut-off\" timestamp by doing:</p>\n\n<pre><code>Select User, min(Timestamp) \nWhere Type=B \nGroup BY User;\n</code></pre>\n\n<p>But then how can I use that information inside the next query where I want to do something like:</p>\n\n<pre><code>SELECT User, count(Timestamp) \nWHERE Type=A AND Timestamp&lt;min(User.Timestamp_Type_B) \nGROUP BY User;\n</code></pre>\n\n<p>My only idea so far are to determine the cut-off timestamps first and then do a join with all type A events and then select from the resulting table, but that feels wrong and would look ugly.</p>\n\n<p>I'm also considering the possibility that this is the wrong type of problem/analysis for Hive and that I should consider hand-written map-reduce or pig instead. </p>\n\n<p>Please help me by pointing in the right direction.</p>\n"},{"tags":["sql","query","caching","ruby-on-rails-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13239510,"title":"Caching database data","body":"<p>I am trying to cache some data from the database to reduce number of SQL queries to the database. Currently, what I am doing is that I will load a set of records from the database:</p>\n\n<pre><code>@records = Record.find(:all, :conditions =&gt; [\"id &lt; ?\", 100])\n</code></pre>\n\n<p>and then iterate through this array to find the records that I really want:</p>\n\n<pre><code>@needed_records = Array.new\n@records.each do |record|\n  if record.is_needed\n    @needed_records.push(record)\n  end\nend\n</code></pre>\n\n<p>So that whenever I need, i can just pass @records instead of actually accessing the database.</p>\n\n<p>My question is, is there any shortcoming doing it this way? Is there any better way to do the equivalent?</p>\n"},{"tags":["php","html","sql","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13240521,"title":"How to display answers in separate rows in a HTML table","body":"<p>I have this query below:</p>\n\n<pre><code>SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, q.QuestionMarks\nFROM Session s\nINNER JOIN Question q ON s.SessionId = q.SessionId\nJOIN Answer an ON q.QuestionId = an.QuestionId\nAND an.SessionId = q.SessionId\nWHERE s.SessionName =  \"GHWSW1\" AND q.QuestionId = 1\nGROUP BY an.SessionId, an.QuestionId\nORDER BY q.QuestionId, an.Answer\n</code></pre>\n\n<p>The query above outputs this result below:</p>\n\n<pre><code>SessionId   SessionName QuestionId  QuestionContent         Answer  QuestionMarks\n1           GHWSW1       1          Here are 2 answers      BD      5\n</code></pre>\n\n<p>So I included the query in the code below and set up a html table:</p>\n\n<pre><code>$assessment = \"GHWSW1\";\n$number = 1;\n\n$query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, \nGROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, q.QuestionMarks \n   FROM Session s \n   INNER JOIN Question q ON s.SessionId = q.SessionId\n   JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId\n   WHERE s.SessionName = ? AND q.QuestionId = ?\n   GROUP BY an.SessionId, an.QuestionId\n   ORDER BY q.QuestionId, an.Answer\n   \";\n\n   // prepare query\n   $stmt=$mysqli-&gt;prepare($query);\n   // You only need to call bind_param once\n   $stmt-&gt;bind_param(\"si\", $assessment, $number);\n   // execute query\n   $stmt-&gt;execute(); \n\n\n       // This will hold the search results\n    $searchQuestionId = array();\n    $searchQuestionContent = array();\n    $searchAnswer = array();\n    $searchMarks = array();\n\n    // Fetch the results into an array\n\n   // get result and assign variables (prefix with db)\n   $stmt-&gt;bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionContent, $dbAnswer, $dbQuestionMarks);\n      while ($stmt-&gt;fetch()) {\n        $searchQuestionId[] = $dbQuestionId;\n        $searchQuestionContent[] = $dbQuestionContent;\n        $searchAnswer[] = $dbAnswer;\n        $searchMarks[] = $dbQuestionMarks;\n      } \n\n?&gt;      \n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n\n\n&lt;form id=\"QandA\" action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n&lt;?php \n\necho \"&lt;table border='1' id='markstbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question No.&lt;/th&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='answerth'&gt;Answer&lt;/th&gt;\n      &lt;th class='noofmarksth'&gt;Total Marks&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n\n          foreach ($searchQuestionContent as $key=&gt;$question) {\n\n        echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n        echo '&lt;td class=\"optiontypetd\"&gt;'.htmlspecialchars($searchQuestionId[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"answertd\"&gt;'.htmlspecialchars($searchAnswer[$key]).'&lt;/td&gt;' ;\n        echo '&lt;td class=\"noofmarkstd\"&gt;'.htmlspecialchars($searchMarks[$key]).'&lt;/td&gt;' . PHP_EOL;\n}\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n\n        ?&gt;\n</code></pre>\n\n<p>So the HTML table displays it like this:</p>\n\n<pre><code>QuestionId  QuestionContent         Answer  QuestionMarks\n1           Here are 2 answers      BD      5\n</code></pre>\n\n<p>But I want it like this in the html table:</p>\n\n<pre><code>QuestionId  QuestionContent         Answer  QuestionMarks\n1           Here are 2 answers      B       5\n                                    D\n</code></pre>\n\n<p>The second Answer <code>D</code> should be in a seperate row and the other rows should have a rowspan. But how can this be achieved?</p>\n\n<p>Session Table:</p>\n\n<pre><code>SessionId (auto)  SessionName\n1                 AAA\n</code></pre>\n\n<p>Question Table:</p>\n\n<pre><code>SessionId  QuestionId (auto)  QuestionContent\n1          1                  What is 2+2?\n</code></pre>\n\n<p>Answer Table:</p>\n\n<pre><code>AnswerId (auto) SessionId  QuestionId   Answer\n1               1          1           B   \n2               1          1           D\n</code></pre>\n"},{"tags":["sql","asp.net-mvc","sql-server-2008","asp.net-mvc-4","getdate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13239675,"title":"Executing table-less SQL in MVC4","body":"<p>What is the best practice for executing a generic, table-less SQL query within an MVC architecture?</p>\n\n<p>I'm trying to use commands such as these:</p>\n\n<pre><code>SELECT getdate();\nSELECT user;\n</code></pre>\n\n<p><strong>Update:</strong>\nThis is actually for part of another project that co-exists alongside the MVC project. All of my tables so far are mapped using edmx from an existing database.</p>\n\n<p>I'd like to use the date from the database in some internal calculations, rather than using the date from the server where the application/site are installed. My formulas go down to the milliseconds, and the time difference between the two servers involved throws off the math.</p>\n"},{"tags":["c#",".net","sql","c#-4.0","ado.net"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13240854,"title":"SCOPE_INDENTITY() not working is it returning null?","body":"<p>Having read around this site I thought the following code would return the ID of the item  I add to my database but the int value I am trying to fill isn't showing up in scope. Here is the code for my insert statement:</p>\n\n<pre><code>  foreach (ExOb exc in exobject)\n            {\n\n                Type type = exc.GetType();\n                //Add a weight exercise\n                if (type == typeof(Weights))\n                {\n\n                    Weights thisweight = (Weights)exc;\n                    string InsertWeight = (\"INSERT INTO WeightExercise (ExcerciseName, Duration, Sets, DiaryId) VALUES (@name, @time, @sets, @DiaryId) SET @ID = SCOPE_IDENTITY();\");\n\n                        com = new SqlCommand(InsertWeight, con);\n                        com.Parameters.AddWithValue(\"@name\", thisweight.ExcerciseName);\n                        com.Parameters.AddWithValue(\"@time\", thisweight.WeightDuration);\n                        com.Parameters.AddWithValue(\"@sets\", thisweight.TotalSets);\n                        com.Parameters.AddWithValue(\"@DiaryId\", results[0]);\n                        com.Parameters.Add(\"@ID\", SqlDbType.Int, 4).Direction = ParameterDirection.Output;\n                        con.Open();\n                        com.ExecuteNonQuery();\n                        int ID = (int)com.Parameters[\"@ID\"].Value;\n\n                        con.Close();\n\n\n                }\n                else if (type == typeof(Cardio))\n                {\n                    Cardio thiscardio = (Cardio)exc;\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The database is updated with the Weight Exercise details. I have checked when debugging and the command parameter @ID holds the ID of the latest entry. Int ID does not show up in locals when debugging and if I Watch it I get:</p>\n\n<pre><code>    ID  The name 'ID' does not exist in the current context \n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["sql","sql-server","stored-procedures","return-value"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":7166,"score":7,"question_id":1035789,"title":"Return value from a stored proc on error","body":"<p>I have an sp in SQL Server that when errors returns -4</p>\n\n<p>What does -4 mean? Is there a table somewhere explaining what the possible return values are?</p>\n\n<hr>\n\n<p>There must be some standard</p>\n\n<p>For example</p>\n\n<pre><code>declare @RetVal int  \nEXEC @RetVal = stpTest  \nselect @RetVal\n</code></pre>\n\n<p>where stpTest is \"SELECT 1/0\" returns -6. </p>\n\n<p>-6 must mean something!</p>\n\n<hr>\n\n<p>The sp that returned -4 only has UPDATE and SELECT INTO statements in it.</p>\n\n<p>At no point does it do 'SELECT -4' so how can I \"find out what -4 means in that particular stored procedure\"?</p>\n\n<p>Also, if there is no standard then why does a divide by zero error always return -6?</p>\n\n<hr>\n\n<p>If you have an sp that does not return anything i.e. it doesn't have any select statements in it and you do:    </p>\n\n<pre><code>declare @RetVal int  \nEXEC @RetVal = yourSPName  \n</code></pre>\n\n<p>Then @RetVal will have a value of 0. </p>\n\n<p>If there is an error then @RetVal will be a value other then zero, for example if the only thing your sp does is \"SELECT 1/0\" then @RetVal will be -6.</p>\n\n<p>Try it and see</p>\n\n<p>My question is what do these return values mean? They must have some logical meaning! </p>\n"},{"tags":["php","html","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13241102,"title":"Store values to database without using form action","body":"<p>I have several web pages created that captures information from user inputs and stores them into session variables in PHP tags inside the html. Finally I echo back the values from the session all on the same page and ask the user if all inputs are correct. I would like to include a submit button at the bottom of the page for the user to submit the session values into the database. I am not sure how to take the values from inside the current page in session variables and store to database. Here is an example of code I currently have.</p>\n\n<pre><code>   &lt;?php\n   session_start();\n   $name = $_SESSION['name'];\n\n   echo \"&lt;br&gt;Is this name right?: \".$name;\n   ?&gt;\n</code></pre>\n\n<p>I have already created the database and respective columns. I am familiar with storing values in form submission, however I have always done this by embedding a file in the form action and obtaining the values using $_POST[''] to get values of inputs of current form. </p>\n"},{"tags":[".net","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13240728,"title":"JS to SQL datetime","body":"<p>I am passing from the client a date time that looks something like this...</p>\n\n<p>\"Mon Nov 05 2012 21:27:58 GMT+0000 (GMT Standard Time)\"</p>\n\n<p>I want to save this into a sql datetime field while retaining as much of the date data as possible.</p>\n\n<p>At the moment I'm doing a conversion like this in the .net backend before I save the datetime to the database....</p>\n\n<pre><code>DateTime.ParseExact(date.Substring(0, 24),\n                             \"ddd MMM d yyyy HH:mm:ss\",\n                             CultureInfo.InvariantCulture);\n</code></pre>\n\n<p>This loses the GMT part. </p>\n\n<p>Is there a way that I can keep it in a ParseExact that will be suitable for SQL?</p>\n"},{"tags":["sql","asp-classic"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":33,"score":6,"question_id":13240833,"title":"Trouble combining 3 different SQL tables items and getting the sum","body":"<p>I am having trouble with a system that my dad uses for reporting at his company. I didn't build it but I am trying my best to wrap my head around it. It's ASP and I am not so well versed in it (or writing sql for that matter).</p>\n\n<p>Basically I have three tables I am working with, Item, ItemHistory, and Devices. In those tables what I am trying to do is </p>\n\n<ul>\n<li>Get the items a user has worked on via the \"serialnumber\" column from the \"Item History\" table</li>\n<li>Compare that serial number to the \"serialnumber\" column in the \"Item\" table to get the device type (from the device column)</li>\n<li>Use the device type to grab a predetermined number value from \"points\" column in the \"Devices\" table</li>\n<li>Store the value and add it to any other values that were pulled back by the query then display the total.</li>\n</ul>\n\n<p>ItemHistory Table</p>\n\n<blockquote>\n<pre><code>Date      | SerialNumber |  DeviceType | User\n----------|--------------|-------------|-------\n11/1/12   | 123-456-789  |     NULL    | Bill\n11/1/12   | 456-123-987  |     NULL    | Bill\n11/1/12   | 987-654-321  |     NULL    | Bill\n</code></pre>\n</blockquote>\n\n<p>Item Table  </p>\n\n<blockquote>\n<pre><code>  SerialNumber |  DeviceType\n  -------------|-------------\n  123-456-789  |  Device1\n  456-123-987  |  Device2\n  987-654-321  |  Device3\n</code></pre>\n</blockquote>\n\n<p>Devices Table</p>\n\n<blockquote>\n<pre><code>  Device   |  Points\n ----------|----------\n  Device1  |    20\n  Device2  |    25\n  Device3  |    40\n</code></pre>\n</blockquote>\n\n<p>And what I am hoping the output will be is</p>\n\n<blockquote>\n<pre><code>  User   |  Points\n --------|----------\n  Bill   |    85\n</code></pre>\n</blockquote>\n\n<p>As you can see, it would have been much easier if the Device Type was included in the ItemHistory table, but it wasn't. I've tried JOINing the tables but keep getting errors (which is from my lack of knowledge im fairly certain). The query is by date range and user (from the ItemHistory table), but I think I've got that figured out. I just can't get it to reference all the tables and add the \"points\" together.</p>\n\n<p>Any help is greatly appreciated! If you need any more info let me know. Thank you in advance.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","table-valued-parameters"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13240720,"title":"Doing an existance check using a subquery with 'LIKE' on a table valued parameter","body":"<p>I am doing an import from excel into the database. I am passing a table valued parameter with a bunch of values, one of them being a foreign key. The catch is that in the database the key value is an <code>nvarchar</code> that always will have 2 or 3 zeroes in front of it, however the people that send the excel files did not properly format the column and those leading zeroes are cut off.</p>\n\n<p>The first thing I need to do in the procedure is to check that all these values exist in a parent table using <code>LIKE</code> (since the leading zeroes are missing). If any of the values don't exist in the parent table then the transaction does not proceed.</p>\n\n<p>I need some help with the MS SQL syntax for this.</p>\n"},{"tags":["sql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13240543,"title":"group invoices with transaction value greater or smaller then zero","body":"<p>Im trying to make a query out of this but im having no luck yet. The tables are as following:</p>\n\n<pre><code>INVOICE\nID | INVOICENUMBER | CUSTOMER | VALUE\n1 | 999 | 8 | 9000\n2 | 999 | 8 | 1000\n\n\nINVOICE_TRANSACTION\nInvoiceID | TYPE | VALUE\n1 | cust | 5000\n1 | cust | 2000\n2 | cust | 1000\n2 | cust | -1000\n\nINVOICE_DETAIL\nInvoiceID | PURCHASEORDERID\n1 | 7777\n\nPURCHASE_ORDER\nPURCHASEORDERID | ORDERTYPE\n7777 | gross\n\nPURCASE_ORDER_DETAILS\nPURCHASEORDERID | ROW | STATUS\n7777 | 1 | 1\n7777 | 2 | 2\n7777 | 3 | 3\n</code></pre>\n\n<p>The result I want is this:</p>\n\n<pre><code>INVOICE VALUE TRANSACTION VALUE PURCHASEORDERID ORDERTYPE HIGH STATUS LOW STATUS\n------- ----- ----------------- --------------- --------- ----------- ----------\n1       9000  7000              7777            gross     3           1\n</code></pre>\n\n<p>In other words I want the result to group all invoice numbers that has a total <code>invoice_transaction.value</code> greater or smaller then 0. I'm new to all this, can anyone give me a hand to get me started?</p>\n"},{"tags":["c#","sql","ado.net","oledb","sql-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13211812,"title":"In ADO.NET, are there restrictions where SQL parameters can be used in the SQL query?","body":"<p>This question is merely for educational purposes, as I'm not currently building any application that builds SQL queries with user input.</p>\n\n<p>That said, I know that in ADO.NET you can prevent SQL Injection by doing something like this:</p>\n\n<pre><code>OleDbCommand command = new OleDbCommand(\"SELECT * FROM Table WHERE Account = @2\", connection);\ncommand.Parameters.AddWithValue(\"@2\", \"ABC\");\n</code></pre>\n\n<p>But assuming that your application is designed in such a way that the user can actually enter the name of the table, can you do the following? (I don't care if it's a bad idea to allow the users to supply the name of the table, I just want to know if the following is possible...) </p>\n\n<pre><code>OleDbCommand command = new OleDbCommand(\"SELECT * FROM @1 WHERE Account = @2\", connection);\ncommand.Parameters.AddWithValue(\"@1\", \"Table\");\ncommand.Parameters.AddWithValue(\"@2\", \"ABC\");\n</code></pre>\n\n<p>I keep getting an exception when I run the second code, saying that the SQL query is incomplete, and I was wondering if the problem is that what I am trying to do simply cannot be done or if I am overlooking something.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":13240298,"title":"Remove numbers from string sql server","body":"<p>I have a large database in which I want to do a part string search. The user will enter characters: <code>JoeBloggs.</code></p>\n\n<p>For arguments sake if I had a name <code>Joe 23 Blo Ggs 4</code> in the database. I want to remove everything in the name other than A-Z. </p>\n\n<p>I have the <code>REPLACE(Name, ' ','')</code> function to remove spaces and the <code>UPPER()</code> function to capitalize the name.</p>\n\n<p>Is there a more efficient fast way maybe by terms of regex to replace anything other than A-Z. I cannot change the values in the database.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239768,"title":"PHP and SQL Server Express to retrieve and show data","body":"<p>I am looking to take a PHP page to retrieve data based on the selection from a drop down list, then show the results based on that selection.  I am not even sure where to begin except my connection to the database.  I do also know that I have to have a query statement, like I would in SQL, which here is a little bit of that:</p>\n\n<pre><code>$sql = \"SELECT ForteID, Disposition, appNumber, Finance_Num, Num_Payments, ACH_CC, Notes, Date\nFROM   cslogs.dbo.Logs\nWHERE  ForteID = 'bs1441'\";\n</code></pre>\n\n<p>The bs1441 is just an example of one option that would be in the drop down list.  I am not sure what I would put there for it to put in there automatically from the list.</p>\n\n<p>Thanks for the help in advance.  Sorry if there is not enough information to go on, but not sure what even would be needed at this point.</p>\n\n<p>EDIT:</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>&lt;form method=\"get\" action=\"getlog.php\"&gt; \n\n&lt;table width=\"300\" border=\"0\"&gt;\n&lt;tr&gt;\n&lt;td&gt; Forte ID:&lt;/td&gt;\n&lt;td&gt;&lt;select id=\"ForteID\" name=\"ForteID\"&gt;                    \n                &lt;option value=\"nc4682\"&gt;nc4682&lt;/option&gt;\n                &lt;option value=\"bs1441\"&gt;bs1441&lt;/option&gt;\n                &lt;option value=\"sp3212\"&gt;sp3212&lt;/option&gt;                 \n    &lt;/select&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n\n&lt;input type=\"submit\" name=\"getLog\" value=\"Get Log\"&gt;\n&lt;/form&gt; \n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&lt;?php\n$serverName = 'SRB-Nick_Desktop\\SQLEXPRESS';\n$connectionInfo = array('Database'=&gt;'cslogs', 'UID'=&gt;'cslogslogin', 'PWD'=&gt;'123456');\n$connection = sqlsrv_connect($serverName, $connectionInfo);\n\n$result = sqlsrv_query( $connection, \n                'SELECT ForteID, Disposition, appNumber, Finance_Num, Num_Payments, ACH_CC, Notes, Date\n                FROM    Logs\n                WHERE   (ForteID = $ForteID)', \n                   array($ForteID));\n\nwhile($row = sqlsrv_fetch_array($result))\n{\necho($row['ForteID'] . ', '.\n     $row['Disposition'] . ', '.\n     $row['appNumber'] . ', '.\n     $row['Finance_Num'] . ', '.\n     $row['Num_Payments'] . ', '.\n     $row['ACH_CC'] . ', '.\n     $row['Notes'] . ', '.\n     $row['Date']);\n}\nsqlsrv_close( $connection);\n?&gt;\n</code></pre>\n\n<p>Then when I look at the page it throws this error:</p>\n\n<p>Parse error: syntax error, unexpected T_STRING in C:\\wamp\\www\\cslogs\\getlog.php on line 46</p>\n\n<p>Line 46 is this line:</p>\n\n<pre><code>    echo($row['ForteID'] . ', '.\n</code></pre>\n\n<p>Let me know if that helps!</p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13239911,"title":"Decreasing execution time with sql left outer join query","body":"<p>How can I decrease the execution time with this sql squery? it is taking over a minute to execute and return rows.(executed in Sql server management studio 2008)</p>\n\n<pre><code>if(@NotInvoiced =1)\nBEGIN\nSelect @Command = \n'select Distinct C.FileID, C.FileName, convert(nvarchar,C.DateReported,111) AS ''DateReported'', \nC.FileDetailsPlainText, CFIT.Level3 as ''InvestigationType'', INV.FName + '' '' + INV.LName AS ''Name'', \nconvert(nvarchar,DD,111) AS ''DD'', i.FirstName + '' '' + i.LastName AS ''ReportedBy''\nfrom CaseFiles C \njoin InvestigatorCaseFileAccess IA on C.FileID=IA.CaseFileID \nLEFT OUTER JOIN CaseFileTimeBills tb on C.FileID=tb.FileID\nLEFT OUTER JOIN CaseFileExpenses e on C.FileID=e.FileID\n\nleft join Element07a_Persons i on i.PersonID = c.PersonID\nLEFT OUTER JOIN CaseFileInvestigationTypes CFIT ON C.InvestigationTypeID = CFIT.InvestigationTypeID \nLEFT OUTER JOIN Investigators INV ON C.InvestigatorID = INV.InvestigatorID\nwhere (tb.InvNumber IS null OR e.InvNumber IS null) and Deleted=0 and IA.InvestigatorID=' + CONVERT (nvarchar(max),@InvestigatorID) + ' and IA.AllowAccess = ''True''\n and tb.FileID = C.FileID or e.FileID=C.FileID '\nEND\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13240116,"title":"Cannot create TABLESPACE as datafile file already part of database","body":"<p>I accidentally somehow remove a tablespace without removing the datafile(forget how..), now the datafile become lost in the woods but when I try to create the TABLESPACE again with the same datafile:</p>\n\n<pre><code>CREATE BIGFILE TABLESPACE SERVER01_DAT DATAFILE 'D:/Oracle11g/app/INSTANCE/dbf/SERVER01_DAT.DBF'\nSIZE 200M REUSE AUTOEXTEND ON NEXT 100M MAXSIZE 2048M LOGGING EXTENT MANAGEMENT LOCAL SEGMENT\nSPACE MANAGEMENT AUTO;\n</code></pre>\n\n<p>then Oracle reject me like this:</p>\n\n<pre><code>cannot add file 'D:/Oracle11g/INSTANCE/INSTANCE/dbf/SERVER01_DAT.DBF' - file already part of database\n</code></pre>\n\n<p>It's interesting as no tablespace occupies this data file then how come it can be in use so oracle service should allow attach this data file back to any tablespace. Anyway I would really appreciate for an idea to re-attache the tablespace with this data file, or help me delete current data file. Thanks a lot.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13238866,"title":"Stored procedure containing inner join with count not working","body":"<p>Let's say i've got a databasetable looking a bit like this, containing information about some assignments.</p>\n\n<pre><code>Id   | ProfessionId      | Title       | Deadline     | DateCreated | ClosingDate\n1    |  5                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n2    |  6                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n3    |  7                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n4    |  7                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n</code></pre>\n\n<p>I want to generate an overview foreach profession (assignments belong to a certain profession) and count the number of assignment in each profession. The overview coming from the database should look like this;</p>\n\n<pre><code>Id | Name           | FriendlyUrl     | Ordinal   | NumberOfAssignments\n5  | Profession 1   | profession-1    | 1         | 1\n6  | Profession 2   | profession-2    | 1         | 1\n7  | Profession 3   | profession-3    | 1         | 2\n8  | Profession 4   | profession-4    | 1         | 0\n</code></pre>\n\n<p>I've currently got a stored procedure returning the overview above, except that the amount of assignments isn't correct. Assignments with a closingdate in the past (we then assume the assignment is closed) shouldn't be taken into the the total number of assignment.</p>\n\n<p>The current stored procedure is like this:</p>\n\n<pre><code>BEGIN\n    SELECT  p.Id, \n            p.Naam, \n            p.FriendlyUrl, \n            p.Ordinal, \n            COUNT(a.ProfessionId) AS NumberOfAssignments\n    FROM ME_Profession AS p \n    LEFT OUTER JOIN ME_Assignment AS a ON a.ProfessionId = p.Id\n    INNER JOIN ME_Client AS c ON a.ClientId = c.Id\n    INNER JOIN aspnet_Membership AS m ON m.UserId = c.UserId\n    WHERE m.IsApproved = 1 \n    GROUP BY p.Id, p.Naam, p.FriendlyUrl, p.Ordinal\nEND\n</code></pre>\n\n<p>I've already came up with and modified procedure like the one below, but it doesn't work. It feels like i'm either thinking too difficult or missing something obvious. What could go wrong?</p>\n\n<pre><code>SELECT        p.Id, p.Naam, p.FriendlyUrl, p.Ordinal, pc.NumberOfAssignments\nFROM            ME_Profession AS p \nINNER JOIN ME_Assignment AS a ON a.ProfessionId = p.Id \nINNER JOIN ME_Client AS c ON a.ClientId = c.Id\nINNER JOIN aspnet_Membership AS m ON m.UserId = c.UserId\nINNER JOIN (SELECT a2.ProfessionId, COUNT(*) AS NumberOfAssignments FROM ME_Assignment AS a2 GROUP BY a2.ProfessionId WHERE a2.Closingdate &gt; GETDATE()) pc ON p.ProfessionId = pc.ProfessionId\nWHERE        m.IsApproved = 1 AND a.Closingdate &gt; GETDATE()\nGROUP BY p.Id, p.Naam, p.FriendlyUrl, p.Ordinal\n</code></pre>\n\n<p><strong>UPDATE 1:</strong> Added where condition for date</p>\n"},{"tags":["sql","oracle10g"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13227349,"title":"how to minimize the usage of conversion functions in SQL queries?","body":"<p>My SQL Queries contain lots of ltrim() , rtrim() , substring() etc conversion functions...They are significantly impacting query performance... Please answer my following queries :</p>\n\n<ul>\n<li>How to minimize usage of conversion functions in my queries? </li>\n<li>What are the possible alternatives instead of conversion functions that could be used in queries ? </li>\n<li>will the alternatives significantly improve my query performance ? </li>\n</ul>\n\n<p>...please guide me  </p>\n"},{"tags":["mysql","sql","left-join"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13239485,"title":"Ordering joined query by multiple rows of the joined table","body":"<p>I've got a <code>posts</code> table and a <code>postmeta</code> table which contains <code>meta_key</code> and <code>meta_value</code> columns. I've included a simplified table structure below (with some demo data).</p>\n\n<pre><code>CREATE TABLE `posts` (\n  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n  `title` varchar(200) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;\n\nINSERT INTO `posts` (`id`, `title`) VALUES\n    (1,'First post'),\n    (2,'Second post'),\n    (3,'Third post'),\n    (4,'Fourth post');\n\nCREATE TABLE `postmeta` (\n  `meta_id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n  `post_id` int(11) NOT NULL,\n  `meta_key` varchar(200) NOT NULL DEFAULT '',\n  `meta_value` text NOT NULL,\n  PRIMARY KEY (`meta_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;\n\nINSERT INTO `postmeta` (`meta_id`, `post_id`, `meta_key`, `meta_value`) VALUES\n    (1,1,'rating','80'),\n    (2,1,'total_votes','500'),\n    (3,2,'rating','80'),\n    (4,2,'total_votes','501'),\n    (5,3,'rating','95'),\n    (6,3,'total_votes','200');\n</code></pre>\n\n<p>The posts need to be ordered by rating. Post without any rating need to be included too, hence the <code>LEFT JOIN</code>. No problem:</p>\n\n<pre><code>SELECT *\nFROM posts p\nLEFT JOIN postmeta m ON p.id = m.post_id AND m.meta_key = 'rating'\nORDER BY m.meta_value DESC\n</code></pre>\n\n<p>However, <strong>for posts with the same rating, I'd like to further order them by the total vote count</strong> which is stored in another row in the <code>postmeta</code> table. In the example above, the first and second post have a rating of 80 but since the second post has more votes, it should be ordered before the first post. How would you pull that off in a single query?</p>\n"},{"tags":["sql","sql-server","query","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13239312,"title":"Return 4 separate counts for single column in SSRS DataSet","body":"<p>I want to provide 5 counts to SSRS from a conditional count on a column.  For instance, suppose the column held the color of a product -- green ,blue, red and yellow.  What I would like to do is return the count of each in a single query.</p>\n\n<p>Although I can accomplish getting this done using a case statement:</p>\n\n<pre><code>Select\n      COUNT(*) 'Count',\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GR' then 'Green\n            Else 'All Others'\n      End as Payment\nFrom COLORS(NoLock)\nGroup by\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GRthen ‘Green’\n            Else 'All Others'\n      End\n</code></pre>\n\n<p>When I use the dataset is SSRS, all I get is the a single count.  I don't want to create 4 dataset queries as I'm actually selection the records by the parameters start and end date and I would end up having 5 sets of date parameters. </p>\n"},{"tags":["sql","database-schema"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":35,"score":-4,"question_id":13238679,"title":"creating views SQL","body":"<p>database consists of (primary keys and foreign keys are in bold)</p>\n\n<p>department (<strong>dept_name</strong>, building, budget)</p>\n\n<p>course(<strong>course_id,</strong> title, dept_name, credits)</p>\n\n<p>instructor(<strong>ID</strong>, name, dept_name, salary)</p>\n\n<p>section(<strong>course_id, sec_id, semester, year,</strong> building, room_number, time_slot_id)</p>\n\n<p>teahces(<strong>ID, course_id, sec_id, semester</strong>, year)</p>\n\n<p>student(<strong>ID</strong>, name, dept_name, tot_cred)</p>\n\n<p>takes(<strong>ID, course_id, sec_id, semester, year</strong>, grade)</p>\n\n<p>I don't know how to write a query for the following question as I am a newbie and have just touched on views:</p>\n\n<p>Create a view consisting of the titles of all courses that are taught in room LG115 in Northern Wing Building in the autumn semester 2010.</p>\n\n<p>Thanks! :)</p>\n\n<p>Kirsty</p>\n"},{"tags":["sql","asp.net-mvc","linq","telerik"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13239333,"title":"Telerik MVC grid - sorting pre-sorted data on a per-page basis","body":"<p>I have a Telerik grid with paging enabled, at 100 items per page.  I want to sort only these 100 items, per page.</p>\n\n<p>This is my controller, it's returning pre-sorted data:</p>\n\n<pre><code>var listInflows = (from inf in db.CI_INFLOWS\n                                   orderby inf.InvoiceDt descending\n                                   select new InflowsGetModel\n                                   {\n                                     [omitted for brevity]\n</code></pre>\n\n<p>These is my Telerik settings:</p>\n\n<pre><code>.Sortable(sorting =&gt; sorting.OrderBy(so =&gt; so.Add(a =&gt; a.InvoiceDt).Ascending()))\n.Pageable(paging =&gt; paging.PageSize(100)\n                          .Style(GridPagerStyles.NextPreviousAndNumeric)\n                          .Position(GridPagerPosition.Top)\n         )\n</code></pre>\n\n<p>Here, I am telling the db to sort the data.  Then I want the 100-per-page displayed items to sort in the reverse order.  It's not behaving as expected.</p>\n"},{"tags":["mysql","sql","triggers","referencing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13237288,"title":"MySQL: how to refer to transition tables","body":"<p>:) I have these two tables:</p>\n\n<pre><code>create table possiede (\nsoc1 integer not null,\nsoc2 integer not null,\nprimary key (soc1,soc2),\nperc double\n);\n\ncreate table contr (\nsoc1 integer not null,\nsoc2 integer not null,\nprimary key(soc1, soc2)\n);\n</code></pre>\n\n<p>I have these two triggers in a generic SQL syntax and I need to translate them into MySQL syntax:</p>\n\n<pre><code>create trigger contrDir\nafter insert on possiede\nfor each row\nwhen percent &gt; 0.5 and (soc1,soc2) not in (select * from contr)\ninsert into contr values (soc1,soc2);\n\ncreate trigger contrIndir\nafter insert on possiede\nreferencing new table as newTable\nfor each row\ninsert into possiede values\n(select P.soc1, N.soc2, P.perc+N.perc\nfrom newTable as N join possiede as P on N.soc1 = P.soc2);\n</code></pre>\n\n<p>this was my first try, but it gives me an error on \"referencing\" keyword (\"syntax error, unexpected IDENT_QUOTED, expecting FOR_SYM\") and I'm not sure the translation is correct:</p>\n\n<pre><code>create trigger controllo\nafter insert on possiede\nREFERENCING new table as newTable\nfor each row\nbegin\n    insert into possiede (select P.soc1, N.soc2, P.perc+N.perc from\n    newTable as N join possiede as P on N.soc1=P.soc2);\n    if percent &gt; 0.5 and (soc1,soc2) not in (select * from contr) then\n    insert into contr values (soc1,soc2);\n    end if;\nend;\n</code></pre>\n\n<p>also as you noticed I had to compress two triggers into one because of some MySQL constraints. Could somebody give me the right translation?</p>\n"},{"tags":["mysql","sql","query","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13238850,"title":"Override column value in WHERE clause?","body":"<p>I was wondering if it was possible to override column value in the Where clause of a SQL query (MySQL in my case).</p>\n\n<p>To be more clear, here is an example :</p>\n\n<p>Suppose a basic query is :</p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = \"Doe\";\n</code></pre>\n\n<p>Is it possible to force <code>lastname</code> and <code>firstname</code> to return value from an other table, just by modifying what is after the WHERE part ? Something like </p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = (SELECT name FROM companies);\n</code></pre>\n\n<p>I am currently testing a web application, and I found a SQL Injection flaw where I can change <code>Doe</code> to whatever I want, but I'm limited with only one query (<a href=\"http://php.net/mysql_query\" rel=\"nofollow\">mysql_query restriction of PHP</a>) and <code>addslashes</code> (so no \" and ').</p>\n"},{"tags":["php","sql","authentication","permissions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13238890,"title":"Design help: Multiple User Roles","body":"<p>I'm currently in the process of designing a web app that requires the use of user permissions and roles. The roles will be stored within the SQL database (using MS SQL but this should be a design independent of the implementation).</p>\n\n<p>What is the standard practice for allowing a user to have multiple roles, a \"One to Many\" relationship if you will.</p>\n\n<p>What I came up with conceptually is the idea of a int field that uses a bit flag to determine if the user has that role:</p>\n\n<pre><code>User Group | Permission Mask | Value\n-------------------------------------\nBasic      | 0 0 0 0 1       | 1\nAdvanced   | 0 0 0 1 0       | 2\n...        |    ...          | ...\nAdmin      | 1 0 0 0 0       | 16\n</code></pre>\n\n<p>This way, on my PHP side's authentication I can quickly math out if a user belongs to the role or not. The biggest drawback I see with this is readability and understanding. For someone not involved with this design decision would they be able to figure out what's going on when maintenance/upgrades (new roles) come along?</p>\n\n<p><strong>Is this appropriate for my needs? Is there a more standardized way of allowing users to have multiple roles/groups?</strong></p>\n"},{"tags":["sql","sql-server","database","database-design","database-schema"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13238584,"title":"good ebooks/resources for designing a database for Reporting & analysis purposes","body":"<p>I am working on designing a seperate database in Sql Server for analysis and reporting purposes.</p>\n\n<p>I searched online and found the below link to be somewhat useful:\n<a href=\"http://stackoverflow.com/questions/3331637/when-to-build-a-separate-reporting-database\">When to build a separate reporting database?</a></p>\n\n<p>I also denormalized some of the tables where I felt are necessary.</p>\n\n<p>I would like to know if someone could point me out to any resources ebooks/tutorials/blogs that would exclusively focus on designing of databases for analysis and reporting purposes.</p>\n\n<p>We currently have around 1TB of data within the database and the data is expected to grow\ntremendously within the coming months.</p>\n"},{"tags":["c#",".net","sql","regex","vb.net"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":542,"score":1,"question_id":9842991,"title":"Regex to remove single-line SQL comments (--)","body":"<p>Question:</p>\n\n<p>Can anybody give me a working regex expression (C#/VB.NET) that can remove single line comments from a SQL statement ?</p>\n\n<p>I mean these comments:</p>\n\n<pre><code>-- This is a comment\n</code></pre>\n\n<p>not those</p>\n\n<pre><code>/* this is a comment */\n</code></pre>\n\n<p>because I already can handle the star comments.</p>\n\n<p>I have a made a little parser that removes those comments when they are at the start of the line, but they can also be somewhere after code or worse, in a SQL-string <code>'hello --Test -- World'</code> \nThose comments should also be removed (except those in a SQL string of course - if possible).</p>\n\n<p>Surprisingly I didn't got the regex working. I would have assumed the star comments to be more difficult, but actually, they aren't.</p>\n\n<p>As per request, here my code to remove /**/-style comments\n(In order to have it ignore SQL-Style strings, you have to subsitute strings with a uniqueidentifier (i used 4 concated), then apply the comment-removal, then apply string-backsubstitution.</p>\n\n<pre><code>    static string RemoveCstyleComments(string strInput) \n    { \n        string strPattern = @\"/[*][\\w\\d\\s]+[*]/\"; \n        //strPattern = @\"/\\*.*?\\*/\"; // Doesn't work \n        //strPattern = \"/\\\\*.*?\\\\*/\"; // Doesn't work \n        //strPattern = @\"/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/ \"; // Doesn't work \n        //strPattern = @\"/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/ \"; // Doesn't work \n\n        // http://stackoverflow.com/questions/462843/improving-fixing-a-regex-for-c-style-block-comments \n        strPattern = @\"/\\*(?&gt;(?:(?&gt;[^*]+)|\\*(?!/))*)\\*/\";  // Works ! \n\n        string strOutput = System.Text.RegularExpressions.Regex.Replace(strInput, strPattern, string.Empty, System.Text.RegularExpressions.RegexOptions.Multiline); \n        Console.WriteLine(strOutput); \n        return strOutput; \n    } // End Function RemoveCstyleComments \n</code></pre>\n"},{"tags":["sql","search"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13231892,"title":"SQL search query based on separate words","body":"<p>I currently have a SQL stored procedure that is set up that is based on receiving a parameter search string, (for example 'Netgear WiFI Switch') the stored procedure then does a wildcard LIKE search on this .i.e.  </p>\n\n<pre><code>WHERE COL1 LIKE '%Netgear WiFi Switch'%\n</code></pre>\n\n<p>This works fine however I want to elaborate on this by searching on any of the words. For example the example query would miss out products that say 'Netgear Switch WiFi' because of the different order.</p>\n\n<p>So I need to split the words and do a wildcard search on each word. (%Netgear% AND %Switch% AND %WiFi%)</p>\n\n<p>So my question is how would I begin to look at splitting the string into the necessary words, apply these to variables and then do a dynamic WHERE based on how many variables have been created from the splitting of the search string.</p>\n\n<p>Thank you</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13238668,"title":"Select into a view","body":"<p>I have a simple CTE <code>x</code> and I wish to select its contents into a view.  Can you select into a view using the same type of syntax that you can for a table? i.e.</p>\n\n<pre><code>SELECT * \nINTO newTable\nFROM OldTable\n</code></pre>\n\n<p>Can new views be created dynamically like this?</p>\n"},{"tags":["sql","postgresql","null","aggregate-functions","window-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":43,"score":4,"question_id":13237801,"title":"Average over hard to define partition","body":"<p>I have this table:</p>\n\n<pre><code>create table t (value int, dt date);\n\n value |     dt     \n-------+------------\n    10 | 2012-10-30\n    15 | 2012-10-29\n  null | 2012-10-28\n  null | 2012-10-27\n     7 | 2012-10-26\n</code></pre>\n\n<p>And I want this output:</p>\n\n<pre><code> value |     dt     \n-------+------------\n    10 | 2012-10-30\n     5 | 2012-10-29\n     5 | 2012-10-28\n     5 | 2012-10-27\n     7 | 2012-10-26\n</code></pre>\n\n<p>I want the null values, as well as the one previous non null value, to be replaced by the average of the previous not null value when the table is ordered by date descending. In this example the value 15 is the previous not null value of the next two nulls. So 15 / 3 = 5.</p>\n\n<p><a href=\"http://www.sqlfiddle.com/#!12/6a0c7/1\" rel=\"nofollow\">SQL Fiddle</a></p>\n"},{"tags":["sql","oracle"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12361,"score":2,"question_id":1387612,"title":"How can i introduce multiple conditions in LIKE operator","body":"<p>I want to write an SQL statement like below:</p>\n\n<pre><code>select * from tbl where col like ('ABC%','XYZ%','PQR%');\n</code></pre>\n\n<p>I know it can be done using <code>OR</code>. But I want to know is there any better solution.</p>\n"},{"tags":["sql","condition","assertion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13238838,"title":"Why does a syntax error come up when I use the \"CREATE ASSERTION <name>\" in SQL?","body":"<p>I just used the \"CREATE ASSERTION \" to check a condition, but the sql says \"Unknown object type 'ASSERTION' used in a CREATE, DROP, or ALTER statement.\"\nMy code is below:</p>\n\n<pre><code>CREATE ASSERTION SectionLimit\n    CHECK (SELECT COUNT(DISTINCT StudentNo), Capacity\n            FROM Enrollments, CourseSections\n            GROUP BY Capacity\n            HAVING Capacity &gt; COUNT(DISTINCT StudentNo) OR Capacity = COUNT(DISTINCT StudentNo))\n</code></pre>\n\n<p>Does anyone know how to fix this error please?\nThanks in advance!!!</p>\n"},{"tags":["sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13238036,"title":"Please review my database schema - need input","body":"<p>I am researching database design and theory and have finally made a thoughtful attempt at creating a schema that would be based upon SQL.  I would like, if someone has time, to review my layout and make sure that it is logical.  Tips and criticism aimed at bettering my knowledge is of course welcome! :)</p>\n\n<p>Here is my general goal:\nCreate a database that will allow for a business with multiple stores to be able to track employee training progress by simply marking date trained and date verified.  Basically, this would be the hierarchy:</p>\n\n<pre><code>Business 1 \n--Store Location (a)\n----Employee\n----Employee\n----Employee\n--Store Location (b)\n----employee\n----employee\n----employee\n\nBusiness 2\n--Store Location (a)\n----employee\n----employee\n--Store Location (b)\n----employee\n----etc...\n</code></pre>\n\n<p>This schema should allow for unlimited businesses, stores, and employees.</p>\n\n<p>As far as the training goes, there should be this type of hierarchy:</p>\n\n<pre><code>Business 1\n--Employee Class           (Manager, Employee, Salesman, Associate, etc)\n----Training Category      (Sales, Stocking, Manufacturing, etc)\n------Training Activity    (How to sell X product, How to stock Y aisle, etc)\n------Training Activity\n------Training Activity\n----Training Category\n------Training Activity\n------Training Activity\n--Employee Class\n----Training Category\n----Training Category\n\nBusiness 2\n--Employee Class           \n----Training Category     \n------Training Activity    \n------Training Activity\n------Training Activity\n----Training Category\n------Training Activity\n------Training Activity\n--Employee Class\n----Training Category\n----Training Category\n</code></pre>\n\n<p>The following things should be variable based on business needs and created upon creation of business's account:</p>\n\n<pre><code>*Number of Stores\n*Number of Employees \n*Employee Classes\n\n*Training Categories\n*Training Activities\n</code></pre>\n\n<p>So the grand questions are: <br>\n1) How close did I get?<br>\n2) How can it be done better?</p>\n\n<p>Thanks in advance!</p>\n\n<p>Here is the link to the picture of the Diagram:\n<a href=\"http://i1227.photobucket.com/albums/ee422/CorySCline/diagram.jpg\" rel=\"nofollow\">http://i1227.photobucket.com/albums/ee422/CorySCline/diagram.jpg</a></p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13238568,"title":"Filling Missing Values in Column","body":"<pre><code>Item  ID\nNULL  1\nNULL  2\n3     3\nNULL  4\nNULL  5\n</code></pre>\n\n<p>Im trying to get the output as</p>\n\n<pre><code>Item  ID\n1     1\n2     2\n3     3\n4     4\n5     5\n</code></pre>\n\n<p>using cursors i updated the bottom 2 nulls as 4 and 5 \nand using flags i have counted the NULLs above 3 but i cant access the top 2 positions ?\nis the approach correct ? </p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13238580,"title":"Sql Where condition not returning rows specified","body":"<p>I have a sql select query that is supposed to return a bunch of rows filter by a where clause. Everything works until I add an \"OR\" then it doesn't seem to return the correct rows.(Sql server management Studio 2008)</p>\n\n<p>Here is my query:</p>\n\n<pre><code>Select @Command = \n'select DISTINCT C.FileID, C.FileName, convert(nvarchar,C.DateReported,111) AS ''DateReported'', \nC.FileDetailsPlainText, CFIT.Level3 as ''InvestigationType'', INV.FName + '' '' + INV.LName AS ''Name'', \nconvert(nvarchar,DD,111) AS ''DD'', i.FirstName + '' '' + i.LastName AS ''ReportedBy''\nfrom CaseFiles C \njoin InvestigatorCaseFileAccess IA on C.FileID=IA.CaseFileID \nJOIN CaseFileTimeBills tb on C.FileID=tb.FileID\nJOIN CaseFileExpenses e on C.FileID=e.FileID\n\nleft join Element07a_Persons i on i.PersonID = c.PersonID\nLEFT OUTER JOIN CaseFileInvestigationTypes CFIT ON C.InvestigationTypeID = CFIT.InvestigationTypeID \nLEFT OUTER JOIN Investigators INV ON C.InvestigatorID = INV.InvestigatorID\nwhere Deleted=0 and IA.InvestigatorID=' + CONVERT (nvarchar(max),@InvestigatorID) + ' and IA.AllowAccess = ''True'' \nand tb.InvNumber IS NULL OR e.InvNumber IS NULL '\nEND\n</code></pre>\n\n<p>The \"tb.Invnumber IS NULL OR e.Invnumber IS NULL' aren't returning the rows it is supposed to return. When I run the query it returns 5 rows, but I know that it is suppose to return more than 5.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13237736,"title":"How Can we use ISNULL to all Column Names in SQL Server 2008?","body":"<p>I have a question </p>\n\n<p>I tried to <code>google</code> it but looks like they don't like <code>*</code> </p>\n\n<p>I'm using SQL Server 2008.</p>\n\n<p>I have the following database table: </p>\n\n<pre><code> P_Id   ProductName UnitPrice   UnitsInStock    UnitsOnOrder\n------------------------------------------------------------------------\n   1    Jarlsberg   10.45                 16    15\n   2    Mascarpone  Null                  23    NULL \n   3    Gorgonzola  15.67                  9    20\n</code></pre>\n\n<p>If I need to replace the <code>null</code> with a string I know I do :</p>\n\n<pre><code> SELECT ISNULL(UnitsOnOrder,'No Data') FROM tbl\n</code></pre>\n\n<p><strong>Questions</strong> </p>\n\n<ul>\n<li>How can I use <code>ISNULL()</code> with multi column names ?</li>\n<li>is it possible to use it with <code>*</code> </li>\n</ul>\n\n<p><em>Like</em></p>\n\n<pre><code>SELECT ISNULL(* , 'NO data') FROM tbl \n</code></pre>\n\n<p>I think this will be tricky because of the datatype, you can't pass string to <code>INT</code> datatype  so how can I fix this too </p>\n\n<p><strong>Update</strong> </p>\n\n<p>Okay if i use <code>ISNULL(</code>) with a datatype of <code>int</code> it will return <code>0</code> \nwhich will be a value to me , how can i pass empty string instead ? </p>\n\n<p>Thanks </p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13234067,"title":"How to write IN clause query to replace null for no value parameter","body":"<p>I am writing a query in which where clause have IN clause and there are large number of values in this IN clause , I want to fetch the result such that if there is no value exist in table for value given in IN clause then a raw containing 0 or null should return for that value. for example..</p>\n\n<pre>\nselect age,sex,date_joining from emp where name IN ('amit','john','paul','dilip')\n</pre>\n\n<p>Now assume for this query ,data for john and paul does not exist in database then result should be like below..</p>\n\n<pre>\n21    male   21-AUG-2011\nnull  null   null\nnull  null   null\n25    male   9-aug-2010\n</pre>\n\n<p>we can also have 0 instead of null if null is not possible</p>\n\n<p>Thanks...</p>\n"},{"tags":["php","mysql","sql","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13238280,"title":"In SQL, how do I get the awards total for each player","body":"<p>I have two tables, one called Players and one called Awards. End-users give an \"award\" to a player, and players can receive the same award multiple times. </p>\n\n<pre><code> Awards Table\n----+------------------------------------------------------------------------+\n| ID | name                             |  player_id                         |\n+----+-----------------------------------------------------------------------+\n|  1 | Free-throw Excerpt               |  1                                 |\n|  2 | Free-throw Excerpt               |  6                                 |\n|  3 | Top Earner                       |  1                                 |\n|  4 | Top Player                       |  5                                 |\n|  5 | Free-throw Excerpt               |  1                                 |\n|  6 | Free-throw Excerpt               |  1                                 |\n|  7 | Top Earner                       |  1                                 |\n|  8 | Top Player                       |  1                                 |\n       ...\n+----+-----------------------------------------------------------------------\n\n\n `Players Table`\n----+------------------------------------------------------------------------+\n| ID | name                                                                  |\n+----+-----------------------------------------------------------------------+\n|  1 | Player A                                                              |\n|  2 | Player B                                                              |\n|  3 | Player C                                                              |\n|  4 | Player D \n       ...                                                                   |  \n+----+-----------------------------------------------------------------------\n</code></pre>\n\n<p>In my app, each player has a page, and on that page, I want to display all the awards that the player has won. For example, for Player B's page: </p>\n\n<p><strong>Player A Stats:</strong> </p>\n\n<ul>\n<li>Free Throw Excerpt: 3 votes</li>\n<li>Top Earner:         2 Votes</li>\n<li>Top Player:         1 Vote</li>\n</ul>\n\n<p>I can query the the awards table to get all the awards given to Player A, but I'm stuck here and don't know where to go. Do I need to then do a COUNT(*) to get the number of each award received? (1 for Top Player, 3 for Free Throw Excerpt).</p>\n\n<p>Thanks,</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13237570,"title":"MySQL query consuming an inordinate amount of processor time of the system's CPU","body":"<p>I have the following MySQL query which seems to be consuming an inordinate amount of processor time of the system's CPU.</p>\n\n<p>The query is suppose to get the news that has the highest number of comments in last week:</p>\n\n<pre><code>$timeago = strtotime(\"-1 week\");\n\n$query = \"SELECT * , \n    news.id, \n    news.title, \n    news.state, \n    news.date, \n    COUNT(comments.module_id) as comments_count, \n    comments.module, \n    comments.state \n    FROM news \n    LEFT OUTER JOIN comments on comments.module_id = news.id AND comments.module = 'news' AND comments.state = '1' \n    WHERE news.state = '2' \n    GROUP BY news.id, news.title, news.date \n    ORDER BY news.date &gt;= $timeago DESC, comments_count DESC limit 6\";\n\n$result = mysql_query($query) or die (mysql_error());\n$data = mysql_fetch_assoc($result);\n</code></pre>\n\n<p>The query servers me just right, it sorts out the news which has the highest number of comments in the last week. There is 17,290 record in news table. For this reason I am try to figure out to fix the query in a way that would be healthy for the CPU consumption.</p>\n\n<p>Any suggestions would be welcome.</p>\n\n<p>Explain plan says</p>\n\n<p>| id    | select_type   | table     | type  | possible_keys     | key   | key_len   | ref   | rows  | Extra</p>\n\n<p>| 1     | SIMPLE    | news  | ref   | state     | state     | 4     | const     | 17282     | Using where; Using temporary; Using filesort</p>\n\n<p>| 1     | SIMPLE    | comments  | ref   | module_id     | module_id     | 101   | saidasea_v2.news.id,const,const   | 4     </p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13237015,"title":"scope_identity returns null","body":"<p>I am writing a SP in SQL server</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[spAddUserBadge]\nAS\nBEGIN\nINSERT INTO dbo.SE_UserBadge\n(    \n[UID],\nBadgeID,\nBadgeAssignmentOrRenewalDate,\nBadgeExpiryDate ,\nAmountPaid, \nRemarks ,\nAssignedBy          \n)\nVALUES\n(\n17,1, 12-12-2012, 12-12-2013, 0.00, '', ''\n)\nSELECT SCOPE_IDENTITY() AS id    \nEND\nGO\n</code></pre>\n\n<p>SCOPE_IDENTITY is coming as NULL. where I am wrong?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":456,"score":0,"question_id":10834610,"title":"Date of inserting a row into table ","body":"<p>Is it possible to find date+time when a row was inserted into a table in SQL Server 2005?</p>\n\n<p>Does SQL Server log insert commands?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13237853,"title":"SQL Server Procedure Bad Cache Planning","body":"<p>I have some SQL code that uses PetaPoco that executes using sp_executesql. The query has 3 parameters: 2 dates and one string (as varchar(5)).</p>\n\n<p>The query takes 3 minutes to run - from the app or SSMS. If I run the same code in SSMS without sp_executesql (or parameters) it runs in 10 seconds and if I add the OPTION (OPTIMIZE FOR UNKNOWN) hint to the original code (using the sp) it runs in 3 seconds. I have cleared the cache using </p>\n\n<pre><code>  CHECKPOINT;\n  GO\n  DBCC DROPCLEANBUFFERS;\n  GO\n  DBCC FREEPROCCACHE;\n  GO\n</code></pre>\n\n<p>And I still can't get it to run as expected. It seems that adding the option to every query is a hack. Am I missing something?</p>\n"},{"tags":["php","sql","date-of-birth"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":58,"score":-3,"question_id":13237602,"title":"get age from date of birth?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1572110/how-to-calculate-age-in-years-based-on-date-of-birth-and-getdate\">How to calculate age (in years) based on Date of Birth and getDate()</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to echo a persons age from their date of birth which is stored in mysql table. is there a piece of code i can put in?</p>\n\n<p>At the moment it just displays the date of birth, because that's all i've asked it to do but i would like a way of showing the age instead if this is possible.</p>\n\n<p>Here's the while loop in users.php:</p>\n\n<pre><code> &lt;?\n\n            $platinum_set = get_platinum_user();\n            while ($platinum = mysql_fetch_array($platinum_set)) {\n                echo\"\n                &lt;div class=\\\"platinumcase\\\"&gt;\n                &lt;a href=\\\"profile.php?id={$platinum['id']}\\\"&gt;&lt;img width=80px height= 80px src=\\\"data/photos/{$platinum['id']}/_default.jpg\\\" class=\\\"boxgrid\\\"/&gt;&lt;/a&gt;&lt;h58&gt; {$platinum['first_name']} {$platinum['last_name']}&lt;/h58&gt;&lt;br/&gt;&lt;br/&gt;\n\n    &lt;h52&gt;{$platinum['dob']}&lt;br/&gt;\n\n\n&lt;br/&gt;{$platinum['location']}&lt;/h52&gt;\n                    &lt;/div&gt;\";\n                }\n            ?&gt;\n</code></pre>\n\n<p>Here's the function:</p>\n\n<pre><code>function get_platinum_user() {\n            global $connection;\n            $query = \"SELECT *\n                        FROM ptb_users, ptb_profiles\n                        WHERE ptb_users.account_type = \\\"User\\\"\n                        AND ptb_users.account_status = \\\"Active\\\"\n                        AND ptb_profiles.user_id = ptb_users.id\n                        AND ptb_users.subscription = \\\"Platinum\\\"\n                        LIMIT 0 , 30\";\n            $platinum_set = mysql_query($query, $connection);\n            confirm_query($platinum_set);\n            return $platinum_set;\n        }\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13232097,"title":"how i can get 0 for no records using mysql?","body":"<p>I am new to mySql.  I have to calculate the count of clicks from table as per the week days.</p>\n\n<p>Here period depends upon database. But what happens is if last week does not have records, it was not in the list. But I need it as 0. So for that how I can do?</p>\n\n<pre><code>SELECT CASE \n    WHEN PERIOD &gt;= NOW() - INTERVAL 4 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 3 WEEK THEN '22-28 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 3 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 2 WEEK THEN '15-21 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 2 WEEK\n        AND PERIOD &lt; NOW() - INTERVAL 1 WEEK THEN '8-14 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 1 WEEK\n                THEN 'up to 7 days ago'\n           END WeekPeriod, IFNULL(count(CLICKS),0) TotalClicks\n\nFROM TABLE\n\nWHERE PERIOD &gt;= NOW() - INTERVAL 4 WEEK\n\nGROUP BY CASE \n    WHEN PERIOD &gt;= NOW() - INTERVAL 4 WEEK\n                    AND PERIOD &lt; NOW() - INTERVAL 3 WEEK THEN '22-28 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 3 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 2 WEEK THEN '15-21 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 2 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 1 WEEK THEN '08-14 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 1 WEEK\n                THEN '01 to 7 days ago'\n\nEND\n ORDER BY WeekPeriod\";\n</code></pre>\n\n<p>answer should be like this </p>\n\n<pre><code>1-7 0 \n8-15 14 \n16-21 34 \n21-28 45\n</code></pre>\n"},{"tags":["sql","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13236643,"title":"SQL (Access) - Only Show Row With More Information","body":"<p>Good morning.</p>\n\n<p>I am currently building a report that features Name, Document type, and Expiration Date. The query is based on whether or not the document was ever requested (=yes) and the individual's role/position. Sadly, due to how the database was designed and how the users have used it, a person may have two roles (Lead Coordinator/Coordinator), and as such, two separate entries (IDs) in the database. However, the users have often only entered in the \"Expiration Date\" for one of those entries.</p>\n\n<p>Thus, now when I have queries gathering Name, Document, and Expiration Date for each role and then combining them via Union, there may be multiple entries per person, such as:</p>\n\n<pre><code>Smith, John AAA 11-5-2012\nSmith, John AAA\nDoe, Jane AAA \nDoe, Jane AAA 11-11-2011\n</code></pre>\n\n<p>Is there a way that I am able to keep the row that has more information? </p>\n\n<p><em>NOTE</em> I do NOT want to due it based on \"Date &lt;> Null\" because sometimes we may have requested the document but we have not received it yet to enter the Expiration Date and we need to be able to see this data in case we need to request it once again.</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":13237623,"title":"Copy data into another table","body":"<p>How to copy (append) data from one table into another table with same schema in SQL Server?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I mean to say there is query </p>\n\n<pre><code>select * \ninto table1 \nfrom table2 \nwhere 1=1 \n</code></pre>\n\n<p>which creates <code>table2</code> with the same structure as <code>table1</code>. </p>\n\n<p>So is there any short query like this to only copy entire data only into an already existing table?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13237509,"title":"New user with just USAGE previleges was able to drop a table (MySQL)","body":"<p>I logged into MySQL from root user.</p>\n\n<p>Ran the command:-</p>\n\n<pre><code>create user new;\n</code></pre>\n\n<p>Then I logged in as user new. Ran the following commands:-</p>\n\n<pre><code>use test;\nshow grants;\n</code></pre>\n\n<p>The Output was:-</p>\n\n<pre><code>GRANT USAGE ON *.* TO ''@'LOCALHOST'\n</code></pre>\n\n<p>As I understand, the new user does not have the drop table permissions or any permissions for that matter (except USAGE) on this table.</p>\n\n<p>However when I run the following:-</p>\n\n<pre><code>DROP TABLE test_table;\n</code></pre>\n\n<p>The query is successful. Could you please explain why is this happening? How do I disable this user from dropping tables and revoke other permissions from this user.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13237659,"title":"is there a mechanism similar to operator overload in mysql?","body":"<p>suppose I have a table which has a column days('mon','tue','wed','thu','fri'), how do I implement a days-of-week order (rather than lexicographical order) to them?</p>\n\n<p>eg.</p>\n\n<pre><code>'mon'&lt;'tue' //produce true\n\n'fri'&gt;'wed' //true\n\n'fri'&lt;'thu' //false\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","sql-server","xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13237407,"title":"SQL Server XML query: how to select values?","body":"<p>How to select file names from xml like this, i.e.\nI need only names:</p>\n\n<pre><code>c:\\temp\\f1.txt\nc:\\temp\\f2.txt\n</code></pre>\n\n<p>XML like this:</p>\n\n<pre><code>&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n     &lt;file name=\"c:\\temp\\f1.txt\"&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n   &lt;subclass1&gt;\n        &lt;file name=\"c:\\temp\\f2.txt\"&gt;\n    &lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;\n</code></pre>\n"},{"tags":["php","mysql","sql","api","rate-limiting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13237287,"title":"How to manage request limited API calls","body":"<p>I am using tmdb API that has a new limit on requests which is 30 requests in 10 seconds per IP. I could track these calls by having a table in MySQL that holds the amount of requests per the last 10 seconds but how can I accomplish this with the different IP addresses?</p>\n\n<p>The way my app works is:</p>\n\n<ol>\n<li><p>request is made to the application server from a desktop app. Server side php then makes a search and returns data.</p></li>\n<li><p>desktop app then makes a different call to app server and that in turns makes several api calls to tmdb (4-7) and other api's.</p></li>\n</ol>\n\n<p>There can be anywhere from a few search requests to a few thousands in some cases. What's the best way to keep track and delay api calls to keep it below the limit?</p>\n"},{"tags":["sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13235236,"title":"Can't add new SQL database - error 26 - web developer 2010","body":"<p>My whole project is a Default.aspx and a web.config. When i go to add new item > SQL Server Database, i get this error:</p>\n\n<pre><code>i.stack.imgur.com/0kbia.png\n</code></pre>\n\n<p>I have looked around the internet for the past couple of hours and i just cant find anything :(\nplease keep in mind i am still a beginner so simple, detailed explanations are very welcome\nthank you! :)</p>\n"},{"tags":["mysql","sql","mysql-workbench"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":48,"score":-1,"question_id":13236745,"title":"Count query with 3 columns in SQL","body":"<p>I have one database named \"Library\" with table named \"Medien\".\nHaving multiple columns among them i need to query for the following coloumn named as Fname,Mname,Lname and ISBN.</p>\n\n<p><strong>I want to calculate database total records with ISBN and without ISBN?</strong></p>\n\n<ul>\n<li>Fname = First Name of Author</li>\n<li>Mname = Middle Name of Author</li>\n<li>Lname = Last Name of Author</li>\n</ul>\n\n<p>I want to count how many record are for ISBN and how many without ISBN ?</p>\n\n<p>I have execute following command</p>\n\n<pre><code> Select COUNT(ISBN) as Fname FROM  `library`.`MEDIEN` where  Fname = `isbn`;\n Select COUNT(ISBN) as Mname FROM  `library`.`MEDIEN` where  Mname = `isbn`;\n Select COUNT(ISBN) as Lname FROM  `library`.`MEDIEN` where  Lname = `isbn`;\n Select COUNT(ISBN) as NtFname FROM `library`.`MEDIEN`where  Fname != `isbn`;\n Select COUNT(ISBN) as NtMname FROM `library`.`MEDIEN`where  Mname != `isbn`;\n Select COUNT(ISBN) as NtLname FROM `library`.`MEDIEN`where  Lname != `isbn`;\n</code></pre>\n\n<p>I am not sure i execute correct command or not.\nBecause some ISBN records have Fname,Mname or Fname,Lname or Mname,Lname or Fname , Lname,Mname only respectively.</p>\n\n<p>For example </p>\n\n<p><strong>First Author</strong></p>\n\n<p>Fname: asher\nLname: baig</p>\n\n<p>have written 5 books records but two of them with ISBN so </p>\n\n<p>Total output will be ISBN = 2</p>\n\n<p>Desire output will be like this</p>\n\n<p><code>ISBN=value and NtISBN=value</code></p>\n\n<p>Please kindly help me solving this query</p>\n"},{"tags":["c#",".net","sql","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13236919,"title":"Querying highest value by keys from database","body":"<p>With the following table:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    1    |\n|      1      |     1     |    5    |\n|      1      |     1     |    4    |\n|      1      |     2     |    7    |\n|      1      |     2     |    2    |\n|      2      |     1     |    2    |\n|      2      |     1     |    3    |\n|      2      |     2     |    2    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p>I would like to get the highest available count for given <code>Parent_ID</code> and <code>Item_ID</code>, like the following:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    5    |\n|      1      |     2     |    7    |\n|      2      |     1     |    3    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p><strong>How would I go about doing this using LINQ/SQL in C#?</strong> For example, I would like the highest item counts for parent id 1.  This would be something like:</p>\n\n<pre><code>int parentId = 1;\nvar counts = from c in database.Items where parentId == c.parentId \n//this gets all counts from items for parent id 1, but I am just looking\n//for the highest count per item for parent id 1\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13237186,"title":"Divide one select result by another select result","body":"<p>I've looked at the other similar questions, and they seem to be a little bit different than what I'm trying to do.</p>\n\n<p>I have a single query, where I'm selecting two count values, and I want to divide one by the other.</p>\n\n<p>Here is my working code:</p>\n\n<pre><code>SELECT (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid='109'\n           AND c.course_name LIKE 'AP %' \n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY') AND  \n               to_date('08/01/2011','MM/DD/YYYY')) as AP, \n       (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid = '109'\n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY') \n           AND to_date('08/01/2011','MM/DD/YYYY')) as ttl\n FROM DUAL\n</code></pre>\n\n<p>Here is where I break it:</p>\n\n<pre><code>SELECT (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid='109'\n           AND c.course_name LIKE 'AP %' \n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY') \n           AND to_date('08/01/2011','MM/DD/YYYY')) as AP, \n       (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid = '109'\n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY')\n           AND to_date('08/01/2011','MM/DD/YYYY')) as ttl,\n      (AP / ttl) as pcnt\n FROM DUAL\n</code></pre>\n\n<p>Could somebody please tell me the <em>proper</em> way to do this?</p>\n\n<p>Thank You</p>\n"},{"tags":["sql","tsql"],"answer_count":6,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":13640,"score":5,"question_id":808611,"title":"SQL Count for each date","body":"<p>I have the following need</p>\n\n<p>I have a logging table which logs som leads generated each day.</p>\n\n<p>Now I need to pull a report over the amount of leads for each day over the last 10 days.</p>\n\n<p>Lets say the table looks like this:</p>\n\n<pre><code>tbl_leads\nid int,\nfirst_name nvarchar(100),\nlast_name nvarchar(100),\ncreated_date datetime\n</code></pre>\n\n<p>And I need to count the number of leads for each day, 10 days total.\nSO the result set should look something like this:</p>\n\n<pre><code>counted_leads | count_date\n5             | 2009-04-30\n7             | 2009-04-29\n5             | 2009-04-28\n7             | 2009-04-27\n</code></pre>\n\n<p>... and so on</p>\n\n<p>Anyone know how to do this the best possible way?\nMy current solution is iterating with a foreach in c# but I would very much like to hand it on the sql server instead in a sp.</p>\n"}]}
{"total":102597,"page":9,"pagesize":100,"questions":[{"tags":["sql","oracle","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":76,"score":4,"question_id":13235099,"title":"Primary Key and Unique Index -- sql scripts generated by SQL Developer","body":"<p>When export sql scripts by SQL Developer there are multiple options available, but either way there have to generate a <code>UNIQUE INDEX</code> on primary key like this</p>\n\n<pre><code>CREATE UNIQUE INDEX \"SYS_C0018099\" ON \"TRANSACTION\" (\"ID\") \n</code></pre>\n\n<p>and add <code>PRIMARY KEY</code> to the same table and same column</p>\n\n<pre><code>ALTER TABLE \"TRANSACTION\" ADD PRIMARY KEY (\"ID\")\n</code></pre>\n\n<p>So the question is: does it looks like kind of redundancy? I thought creating a primary key on a column should by default create an unique index on that column too? So why the first command is necessary?</p>\n\n<p>And this may cause data redundancy?</p>\n\n<p>I am on Oracle 11g so please share any ideas about why it should look like above.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","mysql","sql","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13236742,"title":"SQL Databases and table design/organization","body":"<p><em>(NOOB disclaimer)</em></p>\n\n<p>I'm working on a system (a type of map), that is accessed mostly via 3 fields: ID (auto incremented), X coordinate, and Y coordinate.</p>\n\n<p>As it is right now, i have all data on the map, stored in 1 table. Whenever the map display is loaded it simply queries the database for contents in x and y, and the DB gives the data (other fields in the same entry). If an item on the map is doing something, it has a flag saying its doing something, and then has an ID of the action in another table holding that type of 'actions'.</p>\n\n<p>Essentially, for all map data, its stored in 1 table. All actions of a certain type are stored in their own table.</p>\n\n<p>I'm a noob, and i'm wondering what the most effective/efficient structure for such a design? (a map that has items, and each item has stats/actions).</p>\n\n<p>I'm using PHP atm, using standard SQL queries to get my data. </p>\n\n<p>Should i split up the tables so that there are only x number of entries on a table? (coord range limits)? Should it just keep growing and growing?</p>\n\n<p>There's a lot of queries to the table... so just tryin to see what is best :/</p>\n"},{"tags":["sql","sql-parametrized-query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13231800,"title":"Parametrized query in Oracle","body":"<p>I have a <code>WARNINGS_INFO</code> table that contains some info on a specific warning message, such as it's code and level, and a string that describes how to print the output message.</p>\n\n<pre><code>  ID  |     CODE       | LEVEL | STR_FORMAT\n------|----------------|-------|----------------------------------------------\n  5   | attrib_missing |   3   | On cell $R:$C, attribute $ATTRIB not found\n</code></pre>\n\n<p>Let's assume I have a table <code>GENERATED_WARNINGS</code> with all the warnings generated from a SQL batch:</p>\n\n<pre><code>  WARN_ID  |  WARN_ROW_ID   \n-----------|---------------\n    5      |      32      \n</code></pre>\n\n<p>Also, I have another table with the columns <code>R</code>, <code>C</code> and <code>ATTRIB</code> and obviously a <code>ROW_ID</code> primary key column which <code>WARN_ROW_ID</code> refers to.</p>\n\n<p>Is there a way in SQL to dynamically trasduce the <code>STR_FORMAT</code> string to a string with the data from the columns of the last table?</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":69,"score":6,"question_id":13222525,"title":"Can I order by IN value","body":"<p>Can I sort by the value of an IN query?</p>\n\n<p>The following defaults to \"order item_id lowest first\" but i actually want the sort as entered... is this possible?</p>\n\n<p>e.g.</p>\n\n<pre><code>select item_id, item_title, item_source from items where item_id IN ('1676','1559','1672')\n</code></pre>\n\n<p>I want to return:</p>\n\n<pre><code>item_id     item_title    item_source\n-------     ----------    -----------\n1676        item_a        source_a\n1559        item_f        source_f\n1672        item_c        source_c\n</code></pre>\n"},{"tags":["asp.net",".net","sql","sql-server","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13235490,"title":"Archive checked records in grid view (Change 0 to 1 in database)","body":"<p>I have a grid view which pulls through data dictated by a stored procedure.</p>\n\n<p><img src=\"http://i.stack.imgur.com/S89rn.png\" alt=\"screen shot 1\"></p>\n\n<p>The stored procedure is called GetEverything.\nThe statement is made up of information from 2 tables, one with person detail, and one with vessel detail. The stored procedure select statement contains the following Where clause:</p>\n\n<pre><code>WHERE Vessel.ArchiveStatus = 0\n</code></pre>\n\n<p>By default, every new record that is created using the front end application is given a '0' for ArchiveStatus in the db.</p>\n\n<p>So, the gridview will only show me the records where the ArchiveStatus is 0, which by default is evertything.</p>\n\n<p>The 2 boxes, Check All and Uncheck All are working fully.</p>\n\n<p>What I need now is when a REF or REF(s) are selected and the button 'Archive Records' is clicked, for the 0 in the database to be updated to a 1 for that VesselREF.</p>\n\n<p>Can anoyone advise how to do this and give me some example code to put in the Default.aspx.vb file/ Event Handler for the archive records button.</p>\n\n<p>With this is place, the grid view will only display the non-archived records, and I can create a seperate grid view with its own SQL to bring through the archived records.</p>\n\n<pre><code>GridView.aspx\n\n    &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"False\" \n        DataKeyNames=\"REF,VesselREF\" DataSourceID=\"SqlDataSource1\" Height=\"132px\" \n        style=\"text-align: center; font-family: Calibri; font-size: medium\" \n        Width=\"508px\" BackColor=\"#C4FFC4\"&gt;\n        &lt;AlternatingRowStyle BackColor=\"White\" /&gt;\n        &lt;Columns&gt;\n            &lt;asp:TemplateField HeaderText=\"REF\" InsertVisible=\"False\" SortExpression=\"REF\"&gt;\n\n                &lt;ItemTemplate&gt;\n                    &lt;a href=\"Details.aspx?REF=&lt;%# Eval(\"REF\")%&gt;\"&gt;&lt;%# Eval(\"REF\")%&gt;&lt;/a&gt;\n                    &lt;asp:CheckBox ID=\"RecordSelector\" runat=\"server\" /&gt;\n                &lt;/ItemTemplate&gt;\n            &lt;/asp:TemplateField&gt;\n            &lt;asp:BoundField DataField=\"Title\" HeaderText=\"Title\" SortExpression=\"Title\" /&gt;\n            &lt;asp:BoundField DataField=\"FirstName\" HeaderText=\"FirstName\" \n                SortExpression=\"FirstName\" /&gt;\n            &lt;asp:BoundField DataField=\"Surname\" HeaderText=\"Surname\" \n                SortExpression=\"Surname\" /&gt;\n            &lt;asp:BoundField DataField=\"VesselName\" HeaderText=\"VesselName\" \n                SortExpression=\"VesselName\" /&gt;\n            &lt;asp:BoundField DataField=\"VesselREF\" HeaderText=\"VesselREF\" \n                InsertVisible=\"False\" ReadOnly=\"True\" SortExpression=\"VesselREF\" /&gt;\n\n        &lt;/Columns&gt;\n    &lt;/asp:GridView&gt;\n</code></pre>\n"},{"tags":["php","sql","mysql-table"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13235492,"title":"Select a specific row in PHP/MYSQL","body":"<p>Let's say i have a user table. And i got colomuns like ID, Username, Password and Activated.\nAll i want to know is how to write the MYSQL sentence :\nSELECT into USERS WHERE ID = $ID, INSERT (activated) Values (0)\nCan somebody say it in the right grammar?\nThanks in advance.</p>\n"},{"tags":["mysql","sql","flyway"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13235438,"title":"flyway executes \"alter table ... modify `col` auto_increment\" on MySQL but doesn't change `col` values","body":"<p>When I execute these sentences from MySQL command line or Workbench...</p>\n\n<pre><code>-- 1) Add a column `id`\nALTER TABLE `DEVICES` ADD `id` BIGINT(20) NOT NULL;\n-- 2) Add an index, necessary for auto_increment\nALTER TABLE `DEVICES` ADD index `devices_id_index`(`id`);\n-- 3) Makes `id` auto_increment and inserts sequential numbers it (from 1 to N)\nALTER TABLE `DEVICES` MODIFY `id` BIGINT(20) AUTO_INCREMENT;\n</code></pre>\n\n<p>... what I get is a new column <code>id</code> that is filled with auto-increment values from 1 to N.</p>\n\n<p>But when I execute it from <strong>flyway</strong>, the column <code>id</code> has a zero in every row because the last sentence doesn't change its values.</p>\n\n<p>Do you know why?</p>\n\n<p>Any solution/workaround besides inserting those values using a procedure?</p>\n\n<p>Thank you!</p>\n\n<p>Ferran</p>\n"},{"tags":["sql","sql-server","date","time"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2192,"score":6,"question_id":7105093,"title":"Difference between datetime and timestamp in sqlserver?","body":"<p>What is the difference between <code>Timestamp</code> and <code>Datetime</code> SQL Server?</p>\n\n<p>I thought Both formats are capable of storing date + time. Then, Where the difference is lying between them?</p>\n\n<p>But <code>Timestamp</code> is not capable of storing date, time information.</p>\n\n<p>Still Whats the difference?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":66,"score":0,"question_id":13235616,"title":"Converting INT to Time","body":"<p>I have a column in sql that is an INT and I have to convert it to time.</p>\n\n<p>I've tried </p>\n\n<pre><code>         CONVERT (VARCHAR, columnA / 600000)\n   + ':'\n   + RIGHT ('00' + CONVERT (VARCHAR, c_columnA % 60), 2)\n</code></pre>\n\n<p>but that's not the result.  Any idea's how the data might be being casted?</p>\n\n<p>Here a sample of the data:</p>\n\n<pre>\nINT |TIME\n4680001|13:00\n4680001|13:00\n4596001|12:45\n3846001|10:41\n4320001|12:00\n</pre>\n"},{"tags":["sql","query","count"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13235981,"title":"Count number of occurrences for each unique value","body":"<p>Basically I have a table similar to this:</p>\n\n<pre><code>time.....activities.....length  \n13:00........3.............1  \n13:15........2.............2  \n13:00........3.............2  \n13:30........1.............1  \n13:45........2.............3  \n13:15........5.............1  \n13:45........1.............3  \n13:15........3.............1  \n13:45........3.............2  \n13:45........1.............1  \n13:15........3.............3  \n</code></pre>\n\n<p>A couple of notes:</p>\n\n<ul>\n<li>Activities can be between 1 and 5</li>\n<li>Length can be between 1 and 3</li>\n</ul>\n\n<p>The query should return:</p>\n\n<pre><code>time........count  \n13:00.........2  \n13:15.........2  \n13:30.........0  \n13:45.........1  \n</code></pre>\n\n<p>Basically for each unique time I want a count of the number of rows where the activities value is 3.</p>\n\n<p>So then I can say: </p>\n\n<pre><code>At 13:00 there were X amount of activity 3s.\nAt 13:45 there were Y amount of activity 3s.\n</code></pre>\n\n<p>Then I want a count for activity 1s,2s,4s and 5s. so I can plot the distribution for each unique time.</p>\n"},{"tags":["sql","vb.net","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13236085,"title":"VB.NET MDB creating a table command and Autonumber type","body":"<p>i am using the following command to create a table in an mdb database, it works fine when i remove the autonumber type</p>\n\n<pre><code>\"CREATE TABLE pxs(sid Autonumber , Adress Text , Port Text, user Text, pass Text, sreq Integer, freq Integer)\"\n</code></pre>\n\n<p>so how should i define an id column as autonumber?</p>\n"},{"tags":["php","sql","mysql","sql-injection"],"answer_count":22,"favorite_count":518,"up_vote_count":855,"down_vote_count":4,"view_count":114358,"score":851,"question_id":60174,"title":"Best way to prevent SQL injection?","body":"<p>If user input have inserted into an SQL query directly, the application becomes vulnerable to <a href=\"http://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain/332367#332367/1228\">SQL injection</a>, like in the following example:</p>\n\n<pre><code>$unsafe_variable = $_POST['user_input'];\n\nmysql_query(\"INSERT INTO table (column) VALUES ('\" . $unsafe_variable . \"')\");\n</code></pre>\n\n<p>That's because the user can input something like <code>VALUE'); DROP TABLE table;--</code>, making the query:</p>\n\n<pre><code>INSERT INTO table (column) VALUES('&lt;strong&gt;VALUE'); DROP TABLE table;--&lt;/strong&gt;')\n</code></pre>\n\n<p>What should one do to prevent this?</p>\n"},{"tags":["sql","database","sql-server-2008","query","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13235606,"title":"SQL query :Copy one table to another from different servers","body":"<p>What's wrong with my query, I want to copy three columns to another server\\table if one of the column (ID_DIRCT) is not null :</p>\n\n<pre><code>INSERT INTO  System\\Syst3.Server1.dbo.TABLE_RESRC (NO_EMPLY,PR,NM_FAML,CO_DIRCT)\nSELECT NO_EMPLY, PR_EMPLY, NM_EMPLY, ID_DIRCT \nFROM System\\Syst3.Server2.dbo.RESRC\nWHERE System\\Syst3.Server2.dbo.RESRC.ID_DIRCT IS NOT NULL\n</code></pre>\n\n<p>Using SQL Server 2008 R2.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":135,"score":10,"question_id":13235382,"title":"Double IN Statements in SQL","body":"<p>Just curious about the IN statement in SQL.\nI know I can search multiple columns with one value by doing</p>\n\n<pre><code>'val1' IN (col1,col2)\n</code></pre>\n\n<p>And can search a column for multiple values</p>\n\n<pre><code>col1 IN ('val1','val2')   \n</code></pre>\n\n<p>But is there a way to do both of these simultaneously, without restorting to an repeating AND / OR in the SQl? I am looking to do this in the most scalable way, so independent of how many vals / cols i need to search in.\nSo essentially:</p>\n\n<pre><code>('val1','val2') IN (col1,col2)\n</code></pre>\n\n<p>but valid.</p>\n"},{"tags":["sql","tsql","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13235429,"title":"Tsql subquery in where clause","body":"<p>I have an error message:</p>\n\n<blockquote>\n  <p>There was an error parsing the query. [ Token line number = 5,Token\n  line offset = 4,Token in error = select ]</p>\n</blockquote>\n\n<p>When I try to execute this query:</p>\n\n<pre><code>select ename, loc\nfrom emp e join dept on (e.deptno = dept.deptno)    \nwhere\n    e.sal &gt;\n        (select avg(sal)\n        from emp\n        group by job\n        having job = e.job);\n</code></pre>\n"},{"tags":["sql","oracle","constraints","check"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13235273,"title":"SQL CHECK CONSTRAINT VARCHAR","body":"<pre><code>create table table1\n(\n  column1 varchar2(8)\n  check constraint column1_ch check ........\n);\n</code></pre>\n\n<p>How do I do a check for a data that the first 4 char is a specific set of alphabets while the last 4 is numbers? and as well as a range of values.</p>\n\n<p>examples, data can be ABCD2121, ABCD1111.</p>\n\n<p>range - ABCD0001 to ABCD9999</p>\n\n<p>So 'ABCD' is fixed while the numbers are changing.</p>\n\n<p>I've foudn online about using '[]\" to define the numbers but i'm not able to integrate it into my constraint.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13186889,"title":"Getting multiple different values from a joined table","body":"<p>I can't figure out a good way of querying this without multiple sub-queries. I can't restructure the tables, so that's not an option. Here's the setup:</p>\n\n<pre><code>person:\nperson_id\nperson_want_id,\nperson_need_id,\nperson_ability_id,\nperson_willingness_id\n\nperson_status_types:\nstatus_type_id\nstatus_type_name\n</code></pre>\n\n<p>Each one of the id's that are in person is of type person_status_types. What I need to pull out is the status_type_name for each of the id's in person. </p>\n\n<p>So the return statement would look like this:</p>\n\n<pre><code>person_id | person_want_name | person_need_name | person_ability_name | person_willingness_name\n</code></pre>\n\n<p>Right now I'm just doing 4 subqueries, but there has to be a cleaner way of doing it. Also, if you want to mention a better database structure, I'm open minded to it for future database production.</p>\n"},{"tags":["sql","sql-server-2008","where-clause"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13234075,"title":"Filtering data from 3 tables on 2 columns not giving good result","body":"<p>so i have 3 tables 1 table is used to get all the good numbers from \nthe second table will contain the date thats needs to be between 2 dates \nand the third table has the information numbers i whant so i tryd something like this but getting wrong results.</p>\n\n<pre><code> select columns,\n   (\n     select \n       SUM(column) \n     from \n       table3 \n     where \n       (column is null or column &lt;&gt; 4) \n         and table3nrcolumn = table1nrcolumn \n         and othercolumnnr from table3 in\n           (\n             select \n               column \n             from \n               table2 \n             where \n               (column is null or column &lt;&gt; 4) \n               and (column_datum between '2012-10-29' and '2012-11-04'))) \n                  as result\nfrom \n  table1\n</code></pre>\n\n<p>but i am getting wrong results i think because of the date between but i cant figure out wy hope someone can help</p>\n\n<p>Sorry for the late reaction but i whas working on on something else and Tanx for the fast reaction il try to make it a bit more clear</p>\n\n<p>select id, naam, prijs,\n(select SUM(aantal) from TABLE2 where (nr is null or nr &lt;> 4) and id_TABLE2 = id_TABLE1 and other_nr_TABLE2 in\n(select other_nr from TABLE3 where (nr is null or nr &lt;> 4) and (datum >= '2012-10-29' and datum &lt;= '2012-11-04'))) as resultset\nfrom TABLE1</p>\n\n<p>Table 1 contains writing material Contains All posible rows \nTable 2 contains writing material thats packed togetor under other_nr Can Contain more ROWS\nTable 3 contains packed name under other_nr with a date Contains 1 row</p>\n\n<p>so i need the material from a date range out table 2 that has a connection with table 3 under other_nr And i need to select a date range from table 3 and get the Materials from table 2</p>\n\n<p>hope its a bit more clear now\nVerry srry but i still dont get the tags needed for code</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198395,"title":"Select with SQL the oldest payment associated to a list of persons","body":"<p>Having troubles with a SQL query on an Oracle database (11G I think).</p>\n\n<p>I need to make a query on two tables. The first one contains identifiers of persons. The second one contains payments (you can consider it as salaries), each record associated to the person with a foreign key.</p>\n\n<p>What I need to do is retrieve, for a known list of persons (let's say identifiers 1, 2, 5 and 10), the oldest payment (based on the payment date).</p>\n\n<p>What I made first is this : </p>\n\n<pre><code>select id_person, MIN(payment_date) \nfrom payment where id_person in (1, 2, 5, 10)\ngroup by id_person;\n</code></pre>\n\n<p>This retrieves something like :</p>\n\n<pre><code>1   19940623\n2   20100429\n5   20100204\n10  20100111\n</code></pre>\n\n<p>Now, how do I get, for each person, the complete record of the ´payment´ table which correspond to the oldest payment ?</p>\n\n<p>I cannot figure out a way of doing this...</p>\n\n<p>The answer must be in a single SQL query (I cannot make a call for each person, which would be very easy to do...)</p>\n"},{"tags":["java","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13234550,"title":"how to use specials characters in the variables declaration in java?","body":"<p>Is it possible to declare java attribute name using specials characters, exemple:</p>\n\n<pre><code>private String var/name;\nprivate int one+one;\n</code></pre>\n\n<p>I ask this question because I need to retrieve data from DB, whose the name of one colomn is <code>annoces/status</code>, And I need to use sql query (not hql or criteria)</p>\n"},{"tags":[".net","sql","intersect"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13234872,"title":"Intersect between some DbGeography elements doesn´t work with Entity Framework 5","body":"<p>What is wrong with that?</p>\n\n<pre><code>const string lonMin=\"-19\";      \nconst string latMin = \"25\";\nconst string lonMax = \"-24\";\nconst string latMax = \"25.6\";\n\n//Create a polygon\nvar geoEncuadre = DbGeography.FromText(\"POLYGON ((\" + lonMin + \" \" + latMin + \",\" +\n            lonMax + \" \" + latMin + \",\"+ lonMax + \" \"+ latMax +\",\"+lonMin+\" \" + latMax +\",\"+lonMin + \" \"+latMin +  \"))\", 4326);\n//Check for every node if intersects with the polygon\nvar nodos = (from n in _bd.Nodo\n             where n.Geo.Intersects(geoEncuadre)\n             select n).ToList();\n</code></pre>\n\n<p>This throws an <code>EntityCommandExecutionException</code>. It´s weird because if I use <em>DbGeometry</em> instead <em>DbGeography</em> it works fine. \nWhat happen with the <em>DbGeography</em> and the <em>Intersect</em> operation?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":13235042,"title":"Changing order row in MySQL table","body":"<p>Is there any way to change the order of rows in a MySQL table?<br>\nI want to change the order what will be returned for the most basic query:</p>\n\n<pre><code>SELECT * FROM table\n</code></pre>\n\n<p>I have access just to the database. The query doesn't contain ORDER BY part.</p>\n"},{"tags":["c#","sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13234505,"title":"Function remains INVALID only when using System.Data.OracleClient, works through SQL Developer","body":"<p>I'm using C# and System.Data.OracleClient to add functions to a database. This works for most functions, except one. The function is created but its state is INVALID. After examining the cause for this invalid state, I noticed I could simply compile the function within SQL Developer, but not from my c# application.</p>\n\n<p>Any ideas why there is a difference using .NET  and SQL Developer?</p>\n\n<p>This is the function I use</p>\n\n<pre><code>string sql =\n   @\"CREATE OR REPLACE FUNCTION MYUSER.TEMPJOINSTRINGS \n    ( P_CURSOR SYS_REFCURSOR, \n      P_DEL VARCHAR2 := ', '\n    ) RETURN VARCHAR2\n   IS\n     L_VALUE VARCHAR2(32767);\n     L_RESULT VARCHAR2(32767);\n   BEGIN\n   LOOP\n     FETCH P_CURSOR INTO L_VALUE;\n     EXIT WHEN P_CURSOR%notfound;\n     IF L_RESULT IS NOT NULL THEN\n       L_RESULT := L_RESULT || P_DEL;\n     END IF;\n     L_RESULT := L_RESULT || L_VALUE;\n   END LOOP;\n   RETURN L_RESULT;\n   END;\";\n\ntry\n{\n    using (OracleConnection connection = new OracleConnection(@\"Data source=TEST10;User Id=MYUSER;Password=MYPASS;\"))\n    {\n        connection.Open();\n        DbCommand cmd = connection.CreateCommand();\n        cmd.CommandText = sql;\n        cmd.ExecuteNonQuery();\n        connection.Close();\n        return true;\n    }\n}\ncatch (Exception ex)\n{\n    MessageBox.Show(ex.Message);\n}\n</code></pre>\n\n<p>and after that I execute</p>\n\n<pre><code>ALTER FUNCTION MYUSER.TEMPJOINSTRINGS COMPILE\n</code></pre>\n\n<p>But compiling will only work from SQL Developer, not my c# application.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13235048,"title":"Multiple Rows in INSERTED table","body":"<p>On a table in MS SQL Server I need to run a CLR Stored Procedure on new rows if those rows meet certain criteria.  I thought that would be more or less straightforward:</p>\n\n<pre><code>if ((SELECT Cabinet FROM INSERTED) = 1 OR (SELECT Cabinet FROM INSERTED) = 3) AND (SELECT Result_02 FROM INSERTED) = 'N'\nBEGIN\n    DECLARE @id int\n    SET @id = (SELECT ID FROM INSERTED)\n    exec PrintLabel\n        @id,\n        N'LP 2844 LGE'\nEND;\n</code></pre>\n\n<p>However, this recently started throwing errors about a subquery returning multiple rows. I learned that INSERT triggers run once for each statement, not necessarily on individual rows. So, that IF statement can be working on multiple rows, and thus the error.</p>\n\n<p>My question is: how can I iterate over each new row if the rows are added in a batch (in this case via a MERGE statement). </p>\n"},{"tags":["asp.net","sql","asp.net-mvc","ms-access","gridview"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":13055331,"title":"How to alter table (add/delete column) dynamically and update it to gridview","body":"<p>I need gridview to get updated after I add new field to the table, below is the code</p>\n\n<pre><code>Protected Sub drpDataType_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles drpDataType.SelectedIndexChanged\n    Dim cnnOLEDB As New OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:/Documents and Settings/My Documents/Visual Studio 2008/Projects/WebApplication1/WebApplication1/App_Data/Asset.mdb;\")\n    Dim alterSql As String\n    alterSql = \"ALTER TABLE LAB1 ADD \" + txtColumnName.Text + \" \" + drpDataType.SelectedValue\n    Dim type As String = drpDataType.SelectedValue\n    Dim cmdOLEDB As New OleDbCommand        \n    cnnOLEDB.Open()\n    cmdOLEDB = New OleDbCommand(alterSql, cnnOLEDB)\n    cmdOLEDB.ExecuteNonQuery()\n    cnnOLEDB.Close()\n    Dim tb1 As New DataTable\n    tb1.Columns.Add(txtColumnName.Text)\n    GridView1.DataSourceID = String.Empty\n    Me.GridView1.DataSource = tb1\n    Me.GridView1.DataBind()\nEnd Sub\n</code></pre>\n\n<p>I get this error \"Both DataSource and DataSourceID are defined on 'GridView1'.  Remove one definition\" I understand this because I have set the DataSourceID to AccessDataSource, now if I set it to empty I don't see anything in the gridview not even the tb1. Can anyone help me get this working, any help is appreciated. Thanks!</p>\n\n<p>Edit: Gridview </p>\n\n<pre><code> &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AllowSorting=\"True\" \n              ShowFooter=\"True\" EmptyDataText=\"There are no records for the selection\"  \n              AutoGenerateColumns=\"False\" AutoGenerateDeleteButton=\"False\"  \n              AutoGenerateEditButton=\"False\" CellPadding=\"4\"  OnRowCommand=\"Insert_Click\"\n              DataKeyNames=\"Lab Name\" DataSourceID=\"AccessDataSource8\"/&gt;\n              &lt;Columns&gt;\n                  &lt;asp:TemplateField ShowHeader=\"False\"&gt;\n                      &lt;EditItemTemplate&gt;\n                          &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" CausesValidation=\"True\" \n                              CommandName=\"Update\" Text=\"Update\"&gt;&lt;/asp:LinkButton&gt;\n                          &amp;nbsp;&lt;asp:LinkButton ID=\"LinkButton2\" runat=\"server\" CausesValidation=\"False\" \n                              CommandName=\"Cancel\" Text=\"Cancel\"&gt;&lt;/asp:LinkButton&gt;\n                      &lt;/EditItemTemplate&gt;\n                      &lt;ItemTemplate&gt;\n                          &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" CausesValidation=\"False\" \n                              CommandName=\"Edit\" Text=\"Edit\"&gt;&lt;/asp:LinkButton&gt;\n                          &amp;nbsp;&lt;asp:LinkButton ID=\"LinkButton2\" runat=\"server\" CausesValidation=\"False\" \n                              CommandName=\"Delete\" Text=\"Delete\" OnClientClick=\"return confirm('Are you sure?');\" &gt;&lt;/asp:LinkButton&gt;\n                      &lt;/ItemTemplate&gt;\n                      &lt;FooterTemplate&gt;\n                     &lt;asp:LinkButton ID=\"LinkButton\" runat=\"server\" CommandName=\"Insert\" Text=\"Insert\" ValidationGroup=\"validate\" &gt;&lt;/asp:LinkButton&gt;\n                     &lt;/FooterTemplate&gt;\n                  &lt;/asp:TemplateField&gt;\n\n                  &lt;asp:TemplateField HeaderText=\"Lab Name\" SortExpression=\"Lab Name\"&gt;\n                      &lt;ItemTemplate&gt;\n                          &lt;asp:Label ID=\"Label1\" runat=\"server\" Text='&lt;%# Bind(\"[Lab Name]\") %&gt;'&gt;&lt;/asp:Label&gt;\n                      &lt;/ItemTemplate&gt;\n                      &lt;EditItemTemplate&gt;\n                          &lt;asp:Label ID=\"Label1\" runat=\"server\" Text='&lt;%# Eval(\"[Lab Name]\") %&gt;'&gt;&lt;/asp:Label&gt;\n                      &lt;/EditItemTemplate&gt;\n                      &lt;FooterTemplate&gt;\n                          &lt;asp:TextBox ID=\"txtLabname\" runat=\"server\" &gt;&lt;/asp:TextBox&gt;\n                          &lt;asp:RequiredFieldValidator ID=\"LabName\" runat=\"server\" ControlToValidate=\"txtLabname\" Text=\"*\" ValidationGroup=\"validate\"/&gt;\n                      &lt;/FooterTemplate&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt; \n</code></pre>\n"},{"tags":["sql","database","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13233495,"title":"Using \"power of two numbers\" for length of database columns","body":"<p>I always try to use power of two numbers to define the length of my database columns, either VARCHAR or CHAR type.</p>\n\n<p>Researching by Internet and debate with partners we do not achieve clarify anything about that, if it take advantaged of full clusters usage or something like that, so the question es simple:</p>\n\n<p><strong>Is it better use power of two numbers to define the length of the database VARCHAR and CHAR columns?</strong></p>\n"},{"tags":["php","mysql","sql","sql-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13234068,"title":"PHP Mail sanitisation techniques","body":"<p>Im working on building my first contact form. </p>\n\n<p>I have a page similar to this with a lot of fields... \n<a href=\"http://www.missingpeople.org.uk/component/option,com_rsform/Itemid,144/lang,en/view,rsform/\" rel=\"nofollow\">http://www.missingpeople.org.uk/component/option,com_rsform/Itemid,144/lang,en/view,rsform/</a></p>\n\n<p>The form, when submitted then redirects to my process page that contains...</p>\n\n<pre><code>&lt;?php\n\nforeach ($_POST as $key =&gt; $value)\n$message .= \"Field \".htmlspecialchars($key).\" is \".htmlspecialchars($value).\"\\r\\n\";\n\nmail('liam@site.co.uk', 'sghting', $message); \n\n?&gt;\n</code></pre>\n\n<p>From what I've been reading on the process though this seems vulnerable to injections? sorry if this sounds naive im new to the process. What Im asking is where do i start in reading up on sanitizing this code? </p>\n"},{"tags":["html","sql","xml","sql-server-2008","import"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13234725,"title":"Importing XML into SQL Server 2008 including html tags","body":"<p>I need to import an XML file into a SQL Server 2008 table. One of the XML tags contains valid HTML tags which I want also want imported. Below is one of my elements, as you can see the descriptor tag contains HTML tags which I would like included in the import.</p>\n\n<pre><code>&lt;criterionlist&gt;\n    &lt;element&gt;\n         &lt;subjectname&gt;Humanities&lt;/subjectname&gt;\n         &lt;criterion&gt;A&lt;/criterion&gt;\n         &lt;phase&gt;1&lt;/phase&gt;\n         &lt;level&gt;1&lt;/level&gt;\n         &lt;descriptor&gt;The student: &lt;li&gt; makes &lt;b&gt;a limited attempt&lt;/b&gt; to use &lt;b&gt;some&lt;/b&gt; relevant terminology &lt;/li&gt;\n        &lt;li&gt; demonstrates &lt;b&gt;basic&lt;/b&gt; knowledge and understanding of content and concepts through &lt;b&gt;some&lt;/b&gt; descriptions and/or examples.&lt;/li&gt; &lt;/descriptor&gt;\n    &lt;/element&gt;\n</code></pre>\n\n<p>Is this possible? I managed to import the file into a table using <code>OPENROWSET</code>, but it ignores the HTML tags..</p>\n\n<p>Many thanks,\nDave.</p>\n"},{"tags":["sql","sql-server","ssas","sql-server-2012","xmla"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13148511,"title":"Add attribute to cube and reprocess without original database","body":"<p>Every year we keep a historical copy of one of our cubes. This year someone decided they wanted to pay us money to add an attribute to the cube which did not previously exists. Fine, I like money,  but the issue is we don't have a backup of the database that we built this cube off of. </p>\n\n<p>So a question arises in my head, do we need that original database to add a new attribute to this cube? Is it possible for us to add a new attribute to the cube and only process this attribute without having the cube orignal datasource? </p>\n\n<p>Not having a great understanding of what is happening under the hood when I add an attribute to a SSAS cube and process, I can't say if this is or isn't possible. I could imagine that possibly, the cube has a snapshot in memory of the datasource that it can work off of. I can also imagine that this would be ridiculously inefficient so there is a chance this is no way in heck possible</p>\n\n<p>EDIT: It at least would seem feasible to add a calculated member that makes use of existing data in the cube.</p>\n\n<p>I also should mention that I tried to add an attribute to such a cube and received an error:</p>\n\n<blockquote>\n  <p>\"Dimension [Partner] cannot be saved  File system error failed to copy\n  file C:\\\\MYSQLSERVER\\OLAP\\DATA\\2013_Cube.db\\\\.dim\\.dstore  to C:\\\\MYSQLSERVER\\OLAP\\DATA\\2013_Cube.db\\\\.dim\\.dstore  file exists\"</p>\n</blockquote>\n\n<p>Sorry I faked those filepaths a little. </p>\n"},{"tags":["sql","oracle","max","top-n"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13233620,"title":"Returning max value and value prior","body":"<p>I have a query I run to tell me the latest note for active participants:</p>\n\n<pre><code>select notes.applicant_id,\n   reg.program_code,\n   reg.last_name,\n   reg.first_name,\n   reg.status_cd,\n   MAX(notes.service_date) as \"Last Note\"\nfrom reg inner join notes on reg.applicant_id=notes.applicant_id\nwhere reg.status_cd='AC'\ngroup by notes.applicant_id, reg.program_code, \n         reg.last_name, reg.first_name, reg.reg_date, \n         reg.region_code, reg.status_cd\norder by MAX(notes.service_date)\n</code></pre>\n\n<p>But I would also like this query to give me the result of the <code>note.service_date</code> just prior to the max <code>service_date</code> as well. </p>\n\n<p>Results would look like this </p>\n\n<pre><code>notes.applicant_id   reg.last_name  reg.first_name reg.status_cd  Last Note    Prior Note\n 12345                 Johnson          Lori           AC        01-NOV-2011   01-OCT-2011\n</code></pre>\n\n<p>I am working in oracle.</p>\n"},{"tags":["sql","sql-server","sql-server-2005","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13202697,"title":"Updating a set of data from the output of a Table Valued Function","body":"<p>I am trying to write up a query that are merging duplicate client records in to a single record. Right now I am just building a mapping table to know what I should map with what.</p>\n\n<p>Here are the two functions I wrote to aid me in this</p>\n\n<pre><code>CREATE FUNCTION FindDuplicateClients ()\nRETURNS TABLE AS RETURN \n(\n    select distinct CLIENT_GUID \n    from CLIENTS c\n    inner join\n    (\n        select FIRST_NAME, LAST_NAME, HOME_PHONE\n        from CLIENTS\n        group by FIRST_NAME, LAST_NAME, HOME_PHONE\n        having COUNT(*) &gt; 1\n    ) t on c.FIRST_NAME = t.FIRST_NAME and c.LAST_NAME = t.LAST_NAME and c.HOME_PHONE = t.HOME_PHONE)\ngo\n\n--Find other clients that map to this client\nCREATE FUNCTION FindDuplicateClientsByClient (@Client uniqueidentifier)\nRETURNS TABLE AS RETURN \n(\n    select distinct CLIENT_GUID \n    from CLIENTS c\n    inner join\n    (\n        select x.FIRST_NAME, x.LAST_NAME, x.HOME_PHONE\n        from CLIENTS x\n        inner join \n        (\n            select FIRST_NAME, LAST_NAME, HOME_PHONE\n            from CLIENTS\n            where CLIENT_GUID = @Client\n        ) y on x.FIRST_NAME = y.FIRST_NAME and x.LAST_NAME = y.LAST_NAME and x.HOME_PHONE = y.HOME_PHONE\n        group by x.FIRST_NAME, x.LAST_NAME, x.HOME_PHONE\n        having COUNT(*) &gt; 1\n    ) t on c.FIRST_NAME = t.FIRST_NAME and c.LAST_NAME = t.LAST_NAME and c.HOME_PHONE = t.HOME_PHONE\n    where CLIENT_GUID &lt;&gt; @Client)\ngo\n</code></pre>\n\n<p>The first function successfully returns all <code>CLIENT_GUID</code>'s that have more than 1 record, the second you pass in a GUID and it returns all other guids that share the \"Common Information\" (first name, last name, and home phone in this case)</p>\n\n<p>The problem is filling out my mapping table. I have some rules I need to follow to give priority to some of the duplicates. For example anyone who has had transactions needs to not have their <code>CLIENT_GUID</code> changed, but they are able to have other GUIDs merged in to them (if the other GUIDs had no transactions)</p>\n\n<pre><code>--Create Mapping table\nselect CLIENT_GUID, CAST(null as uniqueidentifier) as NEW_CLIENT_GUID\ninto #mapping\nfrom FindDuplicateClients()\n\n--Do not map people who have transactions\nupdate #mapping\nset NEW_CLIENT_GUID = CLIENT_GUID\nwhere CLIENT_GUID in (select CLIENT_GUID from trnHistory)\n</code></pre>\n\n<p>Now here is where I am running in to trouble. I don't know how to get the list of people who had <code>NEW_CLIENT_GUID</code> set in the previous query, run <code>FindDuplicateClientsByClient</code> against that GUID, and set <code>NEW_CLIENT_GUID</code> of any result to the <code>NEW_CLIENT_GUID</code> that was fed in to the function without using a cursor.</p>\n\n<p>Here is the method I came up with using a cursor</p>\n\n<pre><code>declare cur cursor LOCAL FAST_FORWARD for select NEW_CLIENT_GUID from #mapping where NEW_CLIENT_GUID is not null\ndeclare @NEW_CLIENT_GUID uniqueidentifier\n\nopen cur\nfetch next from cur into @NEW_CLIENT_GUID\nwhile @@fetch_status = 0\nbegin\n    update #mapping\n    set NEW_CLIENT_GUID = @NEW_CLIENT_GUID\n    where CLIENT_GUID in (select CLIENT_GUID from FindDuplicateClientsByClient(@NEW_CLIENT_GUID)) --Find duplicates to this record\n        and NEW_CLIENT_GUID is null --Do not reassign values that are already set (ie: duplicates that have transactions)\n\n    fetch next from cur into @NEW_CLIENT_GUID\nend \n\nclose cur\ndeallocate cur\n</code></pre>\n\n<p>To me, iterating over each result in <code>#mapping</code> that has a value set does not seem correct to me. What would be the correct way to do this? I am using SQL Server 2008 R2 but I would prefer if it was compatible with SQL Server 2005 too.</p>\n"},{"tags":["php","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13234466,"title":"PHP inbox System","body":"<p>I have a problem with creating an inbox System. \nWhat i'm trying to do is in \"ViewMessages.php\" I am trying to pull information from a MYSQL Table to show messages. </p>\n\n<p>My First Statement is: </p>\n\n<pre><code>    $MessageQuery = mysql_query(\"SELECT * FROM messages WHERE ToUName='$ToUName' AND FromUName='$FromUName'\");\n</code></pre>\n\n<p>But I realised a flaw, it will only show  messages sent 1 way. I Tried something like:</p>\n\n<pre><code>    $MessageQuery = mysql_query(\"SELECT * FROM messages WHERE ToUName='$ToUName' AND FromUName='$FromUName' OR FromUName='$ToUName' AND ToUName='$FromUName'\");\n</code></pre>\n\n<p>This failed. Can anyone shed some light to show both messages from both parties? </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":13233649,"title":"MySQL: Impossible WHERE noticed after reading const table","body":"<p>A very simple query always returns an empty result set, after running EXPLAIN, this is what I got:</p>\n\n<pre><code>EXPLAIN SELECT u.id, fname\nFROM user u\nWHERE (birthdate\nBETWEEN \"1992-04-05\"\nAND \"1990-04-05\")\nLIMIT 0,20\n</code></pre>\n\n<p>No matter, if I turn birthdays arround (1990-1992), it's the same... </p>\n\n<pre><code>id  select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  NULL    NULL    NULL    NULL    NULL    NULL    NULL    Impossible WHERE noticed after reading const table...\n</code></pre>\n\n<p>What does this error say? I only found other issues on SO where people tried to join tables, but this query is so simple, what is the matter with it? Any ideas would be highly appreciated, thank you already!</p>\n"},{"tags":["sql","oracle","database-design","constraints","data-modeling"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13233008,"title":"Foreign key on a non-unique index? (oracle)","body":"<p>I'm trying to create a constraint on table A to check if a set of records exists in a table B. I could use a foreign key, but the problem is that the data in the table B is non-unique.</p>\n\n<p>Is there a way to create such a constraint without creating a trigger?</p>\n\n<p>Edit: I can't change table B structure.</p>\n"},{"tags":["sql","oracle","unix","plsql","ksh"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6501,"score":1,"question_id":2551210,"title":"Oracle PL/SQL: Dump query result into file","body":"<p>I'm working on a pl sql stored procedure. \nWhat I need is to do a select, use a cursor and for every record build a string using values.\nAt the end I need to write this into a file.\nI try to use dbms_output.put_line(\"toto\") but the buffer size is to small because I have about 14 millions lines.\nI call my procedure from a unix ksh.\nI'm thinking at something like using \"spool on\" (on the ksh side) to dump the result of my procedure, but I don' know how to do it (if this is possible)</p>\n\n<p>Anyone has any idea?</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13234175,"title":"Use of xml.modify to insert parameters into specific element of an xml column","body":"<p>I would like to use a stored procedure to insert some values passed in as parameters into elements in the xml of a column. I have this so far\nThe following parameters:</p>\n\n<pre><code>@profile_id int,\n@user_id nvarchar(50),\n@activity_name nvarchar(50),\n@display_name nvarchar(50)\n</code></pre>\n\n<p>Retrieve the desired xml:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE profiles.value('(Profile/ID)[1]','int')= @profile_id)\n</code></pre>\n\n<p>The xml from the column inside the @profiles_xml looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;20&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;somename&lt;/Name&gt;\n    &lt;Activities&gt;\n      &lt;Activity&gt;\n         &lt;Name&gt;activity1&lt;/Name&gt;\n      &lt;/Activity&gt;\n    &lt;/Activities&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>Attempt to Insert into User with specific ID the activity name and display name:</p>\n\n<pre><code>SET @profiles_xml.modify('\n    insert\n    if(/Profile/User/ID=sql:variable(\"@user_id\"))\n    then Activity[Name=sql:variable(\"@activity_name\")][DisplayName=sql:variable(\"@display_name\")]\n    else()\n    as first\n    into (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>I have also tried this with no success:</p>\n\n<pre><code> SET @devices_xml.modify('\n    insert /Profile/User[ID=sql:variable(\"@user_id\")]/Activity[Name=sql:variable(\"@activity_name\")][DisplayName=sql:variable(\"@display_name\")]\n    into (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>And this:</p>\n\n<pre><code> SET @devices_xml.modify('\ninsert\n /Profile/User[ID=sql:variable(\"@user_id\")]/Activities/Activity[Name=sql:variable(\"@activity_name\")][DisplayName=sql:variable(\"@display_name\")]\n    into (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>What is the correct way to do this?</p>\n"},{"tags":["mysql","sql","select"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13232649,"title":"Join multiple tables","body":"<p>I have 3 tables. First one is a list of personnel:\n<p>Table <code>Personnel<pre><code>Id_personnel         Name\n1                    John\n2                    Alice\n3                    Tom\n4                    Charles\n5                    Ben</code></pre></p>\n\n<p>Table <code>Department</code></p>\n\n<pre><code>Id_personnel         Department\n1                    Department 1\n2                    Department 2\n3                    Department 3\n4                    Department 4\n5                    Department 5\n</code></pre>\n\n<p>and table with medical leave:</p>\n\n<p>Table <code>Medical</code></p>\n\n<pre><code>Id_personnel         Start_date         End_date\n1                    2012-08-02         2012-08-05\n2                    2012-08-02         2012-08-15\n3                    2012-10-04         2012-10-06\n4                    2012-10-04         2012-10-06\n5                    2012-09-20         2012-09-21\n</code></pre>\n\n<p>For a given date (let's say 2012-10-05) I want to have something like</p>\n\n<pre><code>Department 1                    John\nDepartment 2                    Alice\nDepartment 3                    Tom             2012-10-04         2012-10-06\nDepartment 4                    Charles         2012-10-04         2012-10-06\nDepartment 5                    Ben\n</code></pre>\n\n<p>Using INNER JOIN I am able to get only those sick. I have something like this:</p>\n\n<pre><code>    SELECT a.Name, b.Department, c.Start_date, c.End_date FROM Personnel a\n      INNER JOIN Department b ON a.Id_personnel = b.Id_personnel\n      INNER JOIN Medical c ON a.Id_personnel = c.Id_personnel\n   WHERE c.Start_date &lt;= 2012-10-05  AND c.End_date &gt;= 2012-10-05\n</code></pre>\n\n<p>And the obvious wrong result is:</p>\n\n<pre>Department 3                    Tom             2012-10-04         2012-10-06\nDepartment 4                    Charles         2012-10-04         2012-10-06\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13234465,"title":"Multiple variables assignment using SET and SELECT","body":"<p>I use the following t-sql code for assign to variable a value obtained from select statement</p>\n\n<pre><code> DECLARE @cfMitt nvarchar(16)\n\n SET @cfMitt = (SELECT CfMittente\n    FROM Messaggi\n    WHERE IDMessaggio = @IDMessaggio)\n</code></pre>\n\n<p>If I want use multiple assignement I try with the following  code, but something is wrong:</p>\n\n<pre><code>DECLARE @cfMitt nvarchar(16)\nDECLARE @cfDest nvarchar(16)\n\nSET @cfMitt, @cfDest= (SELECT CfMittente, CfDestinatario\nFROM Messaggi\nWHERE IDMessaggio = @IDMessaggio)\n</code></pre>\n\n<p>Where is the error?</p>\n"},{"tags":["sql","performance","stored-procedures"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13202227,"title":"SQL stored proc runs extremely slow when filtering by high row numbers","body":"<p>This query is generated from a very long dynamic sequel stored procedure -- the procedure returns the requested number of records starting at a given index to be displayed in a Telerik Radgrid, effectively handling paging.  A simplified version of the stored proc's output:</p>\n\n<pre><code>SELECT r.* FROM (\n       SELECT ROW_NUMBER() OVER(ORDER BY InventoryId DESC) as row,\n       v.* FROM vInventorySearch v\n       ) as R WHERE [ROW] BETWEEN 1 AND 10\n</code></pre>\n\n<p>When the \"BETWEEN\" clause is between 1 and 10, it runs in a fraction of a second, but if it's between something like 10000 and 1010 it takes almost a full minute to execute.</p>\n\n<p>I feel like I may be missing something fundamental here, but it seems to me that it shouldn't matter which 10 records I'm retrieving, it should take the same amount of time.</p>\n\n<p>Thanks for any input, I'm looking forward to being embarrassed!</p>\n\n<hr>\n\n<p>Solution, courtesy Martin Smith (below) :</p>\n\n<pre><code>SELECT r.*, inv.* FROM \n(\n    SELECT ROW_NUMBER() OVER(ORDER BY InventoryId DESC) as row, v.InventoryID\n    FROM vInventorySearch v\n    WHERE 1=1 \n) as R \ninner join vInventory inv on r.InventoryID = inv.InventoryID\nWHERE [ROW] BETWEEN 10001 AND 10010\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["php","sql","arrays","search","results"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13233798,"title":"How to include the value of an array in a query","body":"<p>I have the following array:</p>\n\n<pre><code> $rqt=\"SELECT * FROM `client_gestion_compte` WHERE `id_company`='\".$societe['id'].\"' AND `id_gestionnaire_client`='\".$_SESSION['id'].\"'\" ;\n $res=mysql_query($rqt);\n\n $values = array();\n while($donnees=mysql_fetch_assoc($res))\n {\n     $values[] = $donnees['compte'] ;\n }\n</code></pre>\n\n<p>I would like to use the value of this array in order to make a search query in the database. I have to use all value of the array, but the trouble is that I don't know how many items are in the array so I can not do manually where this criteria LIKE $value and so on...</p>\n\n<p>So I've tried like this.</p>\n\n<pre><code>`$sql=\"SELECT * FROM `debiteur` INNER JOIN `creance` ON `creance`.`n_doss` = `debiteur`.`n_doss` WHERE `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`nom` LIKE '%\".$_GET['s'].\"%' AND `creance`.`code_client` LIKE '%\".$values.\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`prenom` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`raison_sociale` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`siret` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`adresse` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`adresse2` LIKE '%\".$_GET['s'].\"%' Or `debiteur`.`ville` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`code_postal` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`tel` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`tel2` LIKE '%\".$_GET['s'].\"%' Or `debiteur`.`fax` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`fax2` LIKE '%\".$_GET['s'].\"%' Or `debiteur`.`gsm` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`gsm2` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`e_mail` LIKE '%\".$_GET['s'].\"%' GROUP BY `creance`.`n_doss`  \";\n</code></pre>\n\n<p>The trouble is on this line  <code>creance.code_client LIKE '%\".$values.\"%'</code></p>\n\n<p>Because I never know how to search with all the custom values of the array and not only with one value like that values[1] for example.</p>\n"},{"tags":["sql","postgresql","primary-key","auto-increment"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3259,"score":3,"question_id":7718585,"title":"Set auto increment primary key in postgres","body":"<p>I have a table called iti. I want to add an auto increment primary key to this table (after already creating 22 columns).</p>\n\n<p>So I tried to create a column called id of type bigserial but pgadmin responds with a \"ERROR: sequence must have same owner as table it is linked to\".</p>\n\n<p>Does anyone know how to fix this issue?</p>\n\n<p>It's especially annoying because I just recreated the whole table (22 columns...) and I created a column id of type bigint and I set the constrained to primary key. But it looks like that is not solution because there is no increment for this solution.</p>\n\n<p>Is there a way to fix this without recreating the whole table again?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13232177,"title":"Getting all related rows that a value is included in, in a mapping table","body":"<p>I don't even know how to start my search on this one.</p>\n\n<p>Let me explain what I'm trying to do :</p>\n\n<p>I have a variable - value mapping table.\n<strong>Several values can be assigned to a variable, and the same value can be assigned to many variables</strong>.</p>\n\n<p>The user is able to delete variables/values.\nHowever, <strong>a value should not be allowed to be deleted if there are any variables that only have this specific value assigned to them</strong>. Otherwise the variables would remain undeleted, but with 0 values assigned, which is wrong.</p>\n\n<p>Now, at the point where the user tries to delete a value from a specific variable, I want to check :</p>\n\n<p><strong>IF for the selected valueID there are any variableIDs that only have one valueID assigned to them, and that valueID is the one the user is trying to delete.</strong>\nIf so, then abort. Otherwise proceed.</p>\n\n<p>Is this possible in any way?</p>\n\n<p>Table Names : </p>\n\n<pre><code>Variable\nValue\nVariable_Value ( mapping table )\n</code></pre>\n\n<p>Field Names ( in all tables ) :</p>\n\n<pre><code>Variable_ID\nValue_ID\n</code></pre>\n\n<p>Example below :</p>\n\n<pre><code>For example Variable_ID 5 only has Value_ID 10 assigned to it. \nIf a user selects a Variable_ID, he sees all assigned Value_IDs \nand is able to select one and try to delete it. So, a user could click \non Variable_ID 3 and try to delete Value_ID 10. That shouldn't \nbe possible if that specific Value_ID is the only assigned \nvalue to any other Variable, because that would leave that \nvariable with no Value_IDs.\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/9ezry.jpg\" alt=\"\"></p>\n"},{"tags":["sql","database","oracle"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":367,"score":0,"question_id":9930364,"title":"How do I print a triangle of stars using SQL","body":"<p>Is it practically possible to create a triangle of stars like this as below in SQL.I know that this could be done easily in any other programming language like C,C++,Java but want to know whether it is really possible with just SQL or PL/SQL.I tried working on it with dual table in Oracle but couldn't get through it.</p>\n\n<pre><code>  *              *\n * *             * * \n* * *    or      * * *\n</code></pre>\n\n<p>Can someone please shed somelight if anyone knows about it.</p>\n"},{"tags":["sql","sql-server","select","parameters","where-clause"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13233676,"title":"How to improve performance of SQL query with parameters?","body":"<p>I'm using SQL Server 2005. </p>\n\n<p>I have a problems with executing SQL statements like this</p>\n\n<pre><code>DECLARE @Param1 BIT\nSET @Param1 = 1\n\nSELECT \n    t1.Col1,\n    t1.Col2\nFROM\n    Table1 t1\nWHERE\n    @Param1=0 OR\n    (t1.Col2 in \n        (SELECT  t2.Col4\n            FROM \n                Table2 t2\n            WHERE \n                t2.Col1 = t1.Col1 AND \n                t2.Col2 = 'AAA' AND \n                t2.t3 &lt;&gt; 0)\n    )\n</code></pre>\n\n<p>This query executes very long time.</p>\n\n<p>But if I replace <code>@Param1</code> with <code>1</code>, than query execution time is ~2 seconds. </p>\n\n<p>Any information how to resolve the problem would be greatly appreciated.</p>\n"},{"tags":["java","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13233029,"title":"How to query a maximum of a list?","body":"<p>I have a list (in this example: list of cars) in my stock. I want to query for the stock and find the highest price that is available within the cars list.</p>\n\n<pre><code>class Stock {\n    List&lt;Car&gt; cars;\n}\n\nclass Car {\n    int price;\n}\n</code></pre>\n\n<p>Tried:</p>\n\n<pre><code>SELECT DISTINCT s.cars.price FROM Stock s;\n</code></pre>\n\n<p>But this always gives an \"error in named query\". What could be wrong, or how could this be done better?</p>\n"},{"tags":["sql","sql-server","foreign-keys","sql-update","revert"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13233742,"title":"How to revert update query in sql server?","body":"<p>I am using SQL Server for my database. now there is table which has following columns.</p>\n\n<pre><code>PK_ID   FK_ID   Name   Description\n1        5       ABC      ABCDE\n2        7       EFG      EFT\n3        8       XUZ      Xyz\n4        11      TEF      TEF\n</code></pre>\n\n<p>Now by mistake i update some Fk_ID field with null value. Now I want to get back my all fk_id which is updated by null value. So is there any way to revert back fk_id's which has value previously?</p>\n\n<p>Can any one help me out to find out solution for the same?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13233325,"title":"Get the ID for range with smallest difference","body":"<p>Lets say that I have a table A. This table has ID, X_value, Y_value. Here is content of table A:</p>\n\n<p>Table A</p>\n\n<pre><code>ID X_value Y_value\n1  100     150\n2  110     170\n3  120     190\n</code></pre>\n\n<p>Now, if I'm comparing number <strong>130</strong> with range numbers(X_value - Y_value) I would like to get ID of range with smallest(minimal) difference! If I can name it that way? Right away we see that number <strong>130</strong> will fall into all this ranges, but I need ID of range with smallest(minimal) difference between <strong>130</strong> and numbers of range. To elaborate that difference:</p>\n\n<pre><code>For range 1: 130-100=30 and 150-130=20\nFor range 2: 130-110=20 and 170-130=40\nFor range 3: 130-120=10 and 190-130=60\n</code></pre>\n\n<p>From this elaboration we see that minimal difference is at third range(that is <strong>10</strong>) so I would like to get ID <strong>3</strong>. What will be a query for this example if I have this table within MySQL db?! </p>\n"},{"tags":["sql","firebird"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13233634,"title":"How to speed up a simple join query in Firebird 2.5.1","body":"<p>When executing a simple inner join query on two large tables the result is returned after several seconds in Firebird 2.5.1 In other databases the result is returned after several milliseconds. The question is how to speed up this query and why is Firebird using A NATURAL instead of the index?</p>\n\n<p>The query is:</p>\n\n<pre><code>SELECT FIRST 20 * FROM A INNER JOIN B ON A.ID = B.AID;\n</code></pre>\n\n<p>Resulting plan is:</p>\n\n<pre><code>PLAN JOIN (A NATURAL, B INDEX (IDX_B_1))\n</code></pre>\n\n<p>Statistics:</p>\n\n<p><img src=\"http://i.stack.imgur.com/2QaSC.jpg\" alt=\"Statistics\"></p>\n\n<p>Table and index metadata:</p>\n\n<pre><code>CREATE TABLE \"A\" \n(\n  \"ID\"   INTEGER NOT NULL,\nCONSTRAINT \"PK_A\" PRIMARY KEY (\"ID\")\n);\n\n\nCREATE TABLE \"B\" \n(\n  \"ID\"   INTEGER NOT NULL,\n  \"AID\"  INTEGER,\nCONSTRAINT \"PK_B\" PRIMARY KEY (\"ID\")\n);\n\n\nCREATE INDEX \"IDX_B_1\" ON \"B\"(\"AID\");\n</code></pre>\n\n<p>To populate you can use this procedure:</p>\n\n<pre><code>declare variable nba integer;\ndeclare variable nbb integer;\ndeclare variable nbc integer;\n\nbegin\n  nba = 0;\n  nbb = 0;\n  nbc = 0;\n  while (nba &lt; 100000) do begin\n    insert into A (ID) values (:nba);\n    nbc = 0;\n    while (nbc &lt; 50) do begin\n      insert into B (ID, AID)\n      values (:nbb, :nba);\n      nbb = nbb + 1;\n      nbc = nbc + 1;\n    end\n    nba = nba + 1;\n  end\nend\n</code></pre>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13233034,"title":"Use of logical and for an xquery delete in tsql","body":"<p>Is it possible to use a logical and operator with an xquery statement inside a stored procedure to delete an element only if its parent element has a specific value AND it has a specific value? Such as:</p>\n\n<pre><code>SET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE profiles.value('(Profile/ID)[1]','int')= @profile_id)\n    SET @profiles_xml.modify('\n    delete\n    if(/Profile/User/ID=sql:variable(\"@user_id\")) and (/Profile/User/Activities/Activity/Name = sql:variable(\"@activity_name\"))\n    then (/Profile/User/Activities/Activity)\n    else()\n    ')\n</code></pre>\n\n<p>I would like to delete the Activity only if the User ID element and Activity Name element match the given parameters.\nThe xml in profiles_xml looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;20&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;somename&lt;/Name&gt;\n    &lt;Activities&gt;\n      &lt;Activity&gt;\n         &lt;Name&gt;activity1&lt;/Name&gt;\n      &lt;/Activity&gt;\n    &lt;/Activities&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>But in the future there will potentially be multiple  elements in each  and Multiple  elements as children of the  element.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13231825,"title":"SET datatype set in SQL Server","body":"<p>While creating a table I have to use the datatype <code>SET</code>, but it looks like there is no datatype <code>SET</code> in SQL Server. I was looking on the Microsoft's website and those are the datatypes that it supports: <a href=\"http://msdn.microsoft.com/en-us/library/ms187752.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms187752.aspx</a></p>\n\n<p>Which one should I use to replace the <code>SET</code>?</p>\n\n<p>I have used <code>SET</code> in MySQL database like this:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `configurations` (\n`index` int(11) NOT NULL AUTO_INCREMENT,\n`user_id` int(11) NOT NULL,\n`configDuration` int(5) NOT NULL,\n`configDurationPerspective` set('list_this_day','list_remaining') NOT NULL,\nPRIMARY KEY (`index`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1;\n</code></pre>\n\n<p>And then when I insert data into the table it looks like this:</p>\n\n<pre><code>INSERT INTO 'configurations' (index, user_id, configDuration, configDurationPerspective) VALUES (1, 1, 2, 'list_this_day');\n</code></pre>\n\n<p>Never mind the quotes. Something messed up while pasting the code.</p>\n\n<p>Now I want to do the same thing, but in SQL Server.</p>\n"},{"tags":["sql","sql-server"],"answer_count":8,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":5231,"score":7,"question_id":331157,"title":"Does SQL Server CheckSum calculate a CRC? If not how can I get MS SQL to calculate a CRC on an arbitrary varchar column?","body":"<p>Does SQL Server CheckSum calculate a CRC? If not how can I get SQL Server to calculate a CRC on an arbitrary varchar column?</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13233124,"title":"How to get sp_send_dbmail to format the body that is sourced from a table","body":"<p>I'm using sp-send_dbmail to send an email. I populate the @body content by selecting from a table where the column is defined as text. The actual content of the email is stored in the tables column.</p>\n\n<p>How do I get the email to show the line breaks and format accordingly? I tried the format as HTML and TEXT.</p>\n"},{"tags":["sql","sql-server","variables"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":1,"view_count":59,"score":5,"question_id":13233129,"title":"Declared variable behaving differently to hard coded string","body":"<p>I am trying to set a like parameter into a variable and allow that variable to accept wild cards (mssql 2005). If I use my parameter set to '%' it only returns a partial subset but if I hard code the query to use '%' it returns the full set. Why might the variable behave differently to the string?</p>\n\n<pre><code>DECLARE @wareno char(4); \nSET @wareno = '%';\nselect @wareno as a, * from waredesc where wareno like @wareno;\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>DECLARE @wareno char(4); \nSET @wareno = '%';\nselect @wareno as a, * from waredesc where wareno like '%';\n</code></pre>\n\n<p>The full scenario is switching based on a flag but is reproducible under the code above</p>\n\n<pre><code>DECLARE @wareno char(4); \nDECLARE @delprods bit;\n\n/**\nSET THESE PARAMETERS\n**/\nSET @wareno = '1'; \nSET @delprods = 'true'; /** if true all the warehouses should also be emptied for safety - products are held at a company level!**/\n\nIF @delprods = 1\nBEGIN\n    SET @wareno = '%';\nEND\nselect @wareno as a, * from waredesc where wareno like @wareno;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":13231884,"title":"How can I speed up this SQL query","body":"<p>I have a piece of code in an ASP.NET application that builds a SQL query from a list of parameters. The number of parameters can vary, so various criteria can be added to this query.  The database is Microsoft SQL Server 2008.</p>\n\n<p>All the AND and OR's are generated programmatically.</p>\n\n<p>The query took more than 3 seconds to execute, but after some profiling and indexes it runs less than a second. Still I think the query itself can be optimized. I've looked at execution plans, but that doesn't mean much to me - not being a SQL guru.</p>\n\n<p>I wonder if the query can be done in a more intelligent fashion - I haven't been able to figure it out. Here's an example of the query:</p>\n\n<pre><code> SELECT [id], [WorkTitle], [CreateDate], [UpdateDate], [Writer], [ValidFrom], \n\n[ValidTo], [Text] \n FROM dbo.Texts T  \n WHERE Category_id = 3 AND '2012-11-06' BETWEEN ValidFrom AND ValidTo  \n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 1 AND CL.Value = '95068')       \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 1))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 2 AND CL.Value = 'C')       \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 2))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 3 AND CL.Value = 'HEL')       \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 3))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 4 AND CL.Value = 'CC')      \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 4))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 5 AND CL.Value = NULL)     \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 5))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 7 AND CL.Value = '321')      \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 7))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 9 AND CL.Value = 'DK7778')    \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 9))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 10 AND CL.Value = 'TFS')   \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 10)) \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 11 AND CL.Value = 'TMP')   \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 11)) \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 13 AND CL.Value = 'OY-VKB')   \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 13)) \n</code></pre>\n\n<p>Any tips and tricks are appreciated.</p>\n\n<p>Cheers\nJens</p>\n"},{"tags":[".net","sql","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":155,"score":5,"question_id":5226928,"title":"Is it possible to see the SQL query of a LINQ command?","body":"<p>It would help me understand LINQ a little bit better that's all.</p>\n\n<p>I tried using the SQL Profiler but I'm not sure how I can get it to show the actual SQL commands.</p>\n"},{"tags":["c#",".net","sql","asp.net-mvc","asp.net-membership"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13224405,"title":"Update custom user profile fields with SimpleMembershipProvider?","body":"<p>I added a custom field to the <code>UserProfile</code> table named <code>ClassOfYear</code> and I'm able to get the data into the profile during registration like this:</p>\n\n<pre><code>var confirmationToken = WebSecurity.CreateUserAndAccount(model.UserName,\n    model.Password,\n    propertyValues: new { ClassOfYear = model.ClassOfYear },\n    requireConfirmationToken: true);\n</code></pre>\n\n<p>However, now I want to be able to update the profile when I manage it but I can't seem to find a method to do so. <strong>Do I need to simply update the <code>UserProfile</code> table myself? If not, what is the appropriate way of doing this?</strong></p>\n\n<p>FYI, I'm using Dapper as my data access layer, just in case it matters. But, like stated, I can just update the <code>UserProfile</code> table via Dapper if that's what I'm supposed to do, I just figured that the <code>WebSecurity</code> class, or something similar, had a way already since the custom user profile fields are integrated with the <code>CreateUserAndAccount</code> method.</p>\n\n<p>Thanks all!</p>\n"},{"tags":["python","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13232555,"title":"Debug Executed Sql in Python","body":"<p>I am executing some sql in python as follows </p>\n\n<pre><code>statement = \"select * from TEST_TABLE\"\ndebug(\"Statement: %s\" % (statement, ))\ncursor = gblDBConnection.cursor()\ncursor.execute(statement)\n</code></pre>\n\n<p>I can debug the statement using a debug function I have written but would also like to debug the actual values returned ie after sql execution.</p>\n\n<p>Is there a way of doing this?</p>\n"},{"tags":["sql","report","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13232486,"title":"Grouping / Multiple Queries in one report in Microsoft Access Report","body":"<p>I have a contacts database in Microsoft Access with all of the data in one table. I'm trying to create a report that groups the users by 'status' and I'm having trouble trying to determine how to do this.</p>\n\n<p>Each contact has two fields, Status 1 and Status 2.  Status 1 can be null, A or B and Status 2 can be either true or false. </p>\n\n<p>The report should group them something like this:</p>\n\n<pre><code>Status 1 Null\n    Contact name and details (repeated for every contact with this status)\nStatus 1 A\n    Contact name and details (repeated for every contact with this status)\nStatus 1 B\n    Contact name and details (repeated for every contact with this status)\nStatus 2 True\n    Contact name and details (repeated for every contact with this status)\n</code></pre>\n\n<p>There is going to be some overlap with these statuses as some records match more than one status, but that's fine.  Showing duplicates on this page is perfectly acceptable.</p>\n\n<p>If this were a web app, I would simply write 4 queries and loops through the resulting record set, displaying the results under each appropriate header.  But in an Access report I cannot figure out what to do.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","html","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13224737,"title":"Want to get the data in the html table displayed correctly","body":"<p>I have a question on how to display the correct table layout in my php code:</p>\n\n<p>I want to display answers and their text inputs in a table.. Now at the moment it is displayed as below:</p>\n\n<pre><code>QuestionNo   Question             Answer        Marks Per Answer     \n1            What is 2+2          B             (text input)         \n2            Name the 3 hobbits?  BCE           (text input)  \n</code></pre>\n\n<p>I want to change the display of the table so that it looks like this below:</p>\n\n<pre><code> QuestionNo  Question             Answer        Marks Per Answer \n 1           What is 2+2?          B             (text input)\n 2           Name the 3 Hobbits?   B             (text input)                   \n                                   C             (text input)\n                                   E             (text input) \n</code></pre>\n\n<ol>\n<li>As you can see from the new display. I want the each answer per question to be displayed in thier own row, not all answers per question in in one row which is what it is doing at moment.</li>\n<li>I want the text inputs to also be display in its own row, like the answers:</li>\n</ol>\n\n<p>My question is that how can point 1 and 2 be achieved so that it can match the new layout?</p>\n\n<p>Below is the code for the current display:</p>\n\n<pre><code>  &lt;?php  \n    $assessment = $_SESSION['id'] . $sessionConcat;\n    include('connect.php');\n\n    $query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, \n      GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, \n    q.QuestionMarks \n    FROM Session s \n    INNER JOIN Question q ON s.SessionId = q.SessionId\n    JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId\n    WHERE s.SessionName = ?\n    GROUP BY an.SessionId, an.QuestionId\n    ORDER BY q.QuestionId, an.Answer\n    \";\n\n    // prepare query\n    $stmt=$mysqli-&gt;prepare($query);\n    // You only need to call bind_param once\n    $stmt-&gt;bind_param(\"s\", $assessment);\n    // execute query\n    $stmt-&gt;execute(); \n\n    // This will hold the search results\n    $searchQuestionId = array();\n    $searchQuestionContent = array();\n    $searchAnswer = array();\n\n    // Fetch the results into an array\n    // get result and assign variables (prefix with db)\n    $stmt-&gt;bind_result($dbQuestionId, $dbQuestionContent, $dbAnswer);\n    while ($stmt-&gt;fetch()) {\n    $searchQuestionId[] = $dbQuestionId;\n    $searchQuestionContent[] = $dbQuestionContent;\n    $searchAnswer[] = $dbAnswer;\n    }   \n    ?&gt;      \n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;form id=\"QandA\" action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n    &lt;?php \necho \"&lt;table border='1' id='markstbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question No.&lt;/th&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='answerth'&gt;Answer&lt;/th&gt;\n      &lt;th class='answermarksth'&gt;Marks per Answer&lt;/th&gt;\n      &lt;th class='noofmarksth'&gt;Total Marks&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n      $previous_question_id = null;\n      foreach ($searchQuestionContent as $key=&gt;$question) {\n        if ($previous_question_id == $searchQuestionId[$key]) {\n      $searchQuestionId[$key] = '';\n      $question = '';\n  }else{\n      $previous_question_id = $searchQuestionId[$key];\n  }\n        echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n        echo '&lt;td class=\"optiontypetd\"&gt;'.htmlspecialchars($searchQuestionId[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"answertd\"&gt;';\n        echo $searchAnswer[$key];\n        echo '&lt;/td&gt;' ;\n        echo '&lt;td class=\"answermarkstd\"&gt;&lt;input class=\"individualMarks\" name=\"answerMarks[]\" id=\"individualtext\" type=\"text\" \"/&gt;&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"noofmarkstd\"&gt;'.htmlspecialchars($searchMarks[$key]).'&lt;/td&gt;' . PHP_EOL;\n}\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n\n    ?&gt;\n    &lt;/form&gt;\n    &lt;/body&gt;\n</code></pre>\n\n<p>Below is what the Session, Question and Answer Table looks like:</p>\n\n<p>Session Table:</p>\n\n<pre><code>SessionId (auto)  SessionName\n1                 AAA\n2                 AAB\n</code></pre>\n\n<p>Question Table:</p>\n\n<pre><code>SessionId  QuestionId (auto)  QuestionContent\n1          1                  What is 2+2?\n1          2                  Name the 3 hobbits?\n</code></pre>\n\n<p>Answer Table:</p>\n\n<pre><code>AnswerId (auto) SessionId  QuestionId   Answer\n1               1          1           B   \n2               1          2           B\n3               1          2           C\n4               1          2           E\n</code></pre>\n"},{"tags":["sql","oracle","oracle10g","pivot"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":901,"score":1,"question_id":3512140,"title":"convert row into columns in oracle10g","body":"<p>how can i convert rows in to columns in  oracle 10g( like pivot in oracle 11g),so that i can add multiple 'and' conditions for the primary key.</p>\n\n<p>ex: select emp_name from emp</p>\n\n<p>where empid = 1 and emp_age = 21;\nwhere empid = 12 and emp_age = 23;</p>\n\n<p>without using 'in' ,i have to get records which satisfies all the above condtions(Like 'and ' operation).</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13230850,"title":"How can i improve the performance of this oracle query?","body":"<p>I have three database tables which contains large amount of data(6000). I wrote the following query for some operaton which is working fine.</p>\n\n<pre><code>UPDATE productlistprice prl SET prl.value = (\n    SELECT minprice FROM(\n       SELECT  MIN(prl.value) AS minprice, prv.productmasterid AS masterprid \n            FROM product pr , productlistprice prl, productvariation prv \n              WHERE prv.productmasterid = (\n       SELECT prv.productmasterid  FROM  productvariation pv \n              WHERE pv.productid = pr.uuid) \n              AND prl.productid = pr.uuid AND prl.productid  = prv.productid \n                    GROUP BY prv.productmasterid) \n              WHERE masterprid = (SELECT prv.productmasterid\n              FROM productvariation prv WHERE prv.productmasterid = prl.productid \n                    GROUP BY prv.productmasterid)) \n              WHERE prl.productid = (\n       SELECT prv.productmasterid FROM productvariation prv \n              WHERE prv.productmasterid = prl.productid \nGROUP BY prv.productmasterid );\n</code></pre>\n\n<p>But the performance of this query is bit slow. it is taking 21 seconds to update the records. Where can i improve this query. Any suggestions will be greatly appriciated </p>\n"},{"tags":["java","sql","database","hibernate","jpql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13230956,"title":"conditional left outer join SQL query To JPQL","body":"<p>What is a <strong>jpql</strong> equivalent of following <strong>SQL</strong> query :</p>\n\n<pre><code>select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=1;\n</code></pre>\n\n<p><strong>Sample Data:</strong></p>\n\n<pre><code>ij&gt; select * from App;\nID         |STATUS\n----------------------\n1          |active\n2          |active1\n3          |active3\n5          |active\n\n4 rows selected\nij&gt; select * from App_Child;\nID         |STATUS    |D\n----------------------------------\n1          |active    |1\n2          |active11  |2\n1          |active111 |3\n1          |active    |4\n\n4 rows selected\nij&gt; select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=1;\nID         |STATUS    |ID         |STATUS    |D\n---------------------------------------------------------\n1          |active    |1          |active    |1\n1          |active    |1          |active    |4\n\n2 rows selected\nij&gt; select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=5;\nID         |STATUS    |ID         |STATUS    |D\n---------------------------------------------------------\n5          |active    |NULL       |NULL      |NULL\n\n1 row selected\n</code></pre>\n\n<p>EDIT : We are using <strong>jpa 2.0</strong></p>\n"},{"tags":["sql","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13231865,"title":"SELECT refering value to sub query","body":"<p>I am trying to get a random id value from my table. The condition is that the selected value must not exist for the same id and different language (language is <code>lang</code> field)</p>\n\n<p><strong>I do this:</strong></p>\n\n<pre><code>SELECT id_v as p,cont FROM value_phrase WHERE lang=1 AND\nNULL IN (SELECT cont FROM value_phrase WHERE id_v=p AND lang=2)\nORDER BY RAND() LIMIT 0,1\n</code></pre>\n\n<p>... but I do not get any results (It must be an error in my query, because there are many rows satisfying the <em>desired</em> condition.) How should I fix it?</p>\n\n<p>-- SOLVED --</p>\n\n<p>the solution is to use NOT EXISTS instead of NULL IN, and use table aliases to refer the first id_v into the sub query. This way (thanks to  Mark Byers):</p>\n\n<pre><code>SELECT first.id_v, first.cont\nFROM value_phrase AS\nFIRST WHERE lang =1\nAND NOT\n EXISTS (\n SELECT cont\n FROM value_phrase\n WHERE id_v = first.id_v\n AND lang =2\n )\nORDER BY RAND( )\nLIMIT 0 , 1\n</code></pre>\n"},{"tags":["sql","sql-server","reporting-services","ssrs-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":211,"score":2,"question_id":8527249,"title":"Multiple Versions of SQL Reporting Services ReportViewer","body":"<p>I have a simple ASP.NET application that use the SSRS ReportViewer control.  </p>\n\n<p>I was wondering if it is possible to support multiple versions of this control within the application?  </p>\n\n<p>My application is used by users who use a mixed bag of reporting services and the SQL Reporting Services ReportViewer 2010 (version 10.0) is not compatible with SSRS 2005, but the SQL Reporting Services ReportViewer version 9.0 is.  </p>\n\n<p>I would like them to be able to choose which version of reporting services they have and then the application choose the correct control.  </p>\n\n<p>Will having multiple versions of this referenced within the application cause conflicts?</p>\n"},{"tags":["sql","sql-server","sql-server-2005","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":79,"score":-1,"question_id":13227560,"title":"SQL Server 2005 query optimization","body":"<p>My application need to get data from a SQL Server database. My problem is that there is 3 tables that has to be joined into a view. This takes a lot of time (about 30 sec to generate the view) So I was wondering if there is a way to optimize this SQL query?</p>\n\n<p>SQL query: </p>\n\n<pre><code>SELECT TOP (100) PERCENT Request1.RequestID,\n                         TrackIT.dbo.Sending.Barcode,\n                         TrackIT.dbo.Address_View.AdrID,\n                         TrackIT.dbo.Address_View.Name,\n                         TrackIT.dbo.Address_View.Street,\n                         TrackIT.dbo.Address_View.HouseNo,\n                         TrackIT.dbo.Address_View.Postal,\n                         TrackIT.dbo.Address_View.City,\n                         TrackIT.dbo.Address_View.Country,\n                         Request1.Latitude,\n                         Request1.Longitude,\n                         Request1.ReceivedDate\nFROM   (SELECT DISTINCT RequestID,\n                        Ltrim([Content]) AS Barcode,\n                        Latitude,\n                        Longitude,\n                        ReceivedDate\n        FROM   RequestWithLocation\n        WHERE  ( Site LIKE '%Z' )\n               AND ( [Content] &lt;&gt; '' )\n               AND ( AddressID = '0' )\n               AND ReceivedDate &gt; Dateadd(day, -7, Getdate())) AS Request1\n       INNER JOIN TrackIT.dbo.Sending\n         ON Request1.Barcode = TrackIT.dbo.Sending.Barcode\n       INNER JOIN TrackIT.dbo.Address_View\n         ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\nORDER  BY AdrID \n</code></pre>\n\n<p>Can anyone help ?</p>\n"},{"tags":["sql","database","core-data"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13221068,"title":"How to download data from web server and save for core data","body":"<p>I have an app I'm working on that will have about 500 contacts, names, email addresses, website addresses ,etc. I will be updating the contacts frequently adding new contacts, and updating emails that change. I was advised the best way to do this with core data would be to do a fetch to find the youngest record and ask my server for all the records that are even younger.</p>\n\n<p>My question is how to download the youngest record from my server and save it for use with core data.</p>\n\n<p>I've looked around, but dont see anything on using core data with a database stored on a server. Or am I missing something, is there another way to go about creating this app. </p>\n\n<p>I need to be able to update my database frequently and for the results to reach the app user</p>\n"},{"tags":["mysql","sql","optimization","database-indexes"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13230629,"title":"How to optimize MySQL database/query","body":"<p>Hi I was hoping I could get some help on how to optimize my database so it doesn't take a year. I know that to speed it up I need to add indexes, but I'm not exactly sure on what I should be adding them on.</p>\n\n<p>Heres the three tables in my database:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `journeyPattern2` (\n  `journeyPatternId` int(11) NOT NULL AUTO_INCREMENT,\n  `serviceId` int(11) NOT NULL,\n  `direction` enum('inbound','outbound') NOT NULL,\n  PRIMARY KEY (`journeyPatternId`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;\n\nCREATE TABLE IF NOT EXISTS `journeyPatternTimingLink2` (\n  `journeyPatternTimingLinkId` int(11) NOT NULL AUTO_INCREMENT,\n  `journeyPatternId` int(11) NOT NULL,\n  `from` varchar(15) NOT NULL,\n  `to` varchar(15) NOT NULL,\n  `direction` enum('inbound','outbound') NOT NULL,\n  `runTime` varchar(15) NOT NULL,\n  PRIMARY KEY (`journeyPatternTimingLinkId`),\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n\nCREATE TABLE IF NOT EXISTS `line` (\n  `lineId` int(11) NOT NULL AUTO_INCREMENT,\n  `serviceId` int(11) NOT NULL,\n  `lineName` tinytext NOT NULL,\n  PRIMARY KEY (`lineId`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n\nCREATE TABLE IF NOT EXISTS `service` (\n  `serviceId` int(11) NOT NULL AUTO_INCREMENT,\n  `serviceCode` varchar(50) NOT NULL,\n  `registeredOperatorRef` varchar(50) NOT NULL,\n  `origin` tinytext NOT NULL,\n  `destination` tinytext NOT NULL,\n  PRIMARY KEY (`serviceId`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n</code></pre>\n\n<p>The table journeyPattern2 contains about 33000 rows, journeyPatternTimingLink2 contains around 13 million, and line and service around 70000.</p>\n\n<p>The query I'm trying to optimize is the following </p>\n\n<pre><code>SELECT DISTINCT lineName,line.serviceId  FROM `journeyPatternTimingLink2` \nINNER JOIN journeyPattern2\nON journeyPattern2.journeyPatternId=journeyPatternTimingLink2.journeyPatternId\nINNER JOIN line\nON journeyPattern2.serviceId = line.serviceId\nWHERE `from` = '13006785E'\n</code></pre>\n\n<p>I've never really worked with tables of this size before so I'm not sure if I'm joining correctly in the first place. I've also uploaded a <a href=\"http://i.imgur.com/eTO4v.png\" rel=\"nofollow\">screenshot</a> of me running EXPLAIN on the query from phpmyadmin, but I'm not exactly sure how to interpret the results so any help would be appreciated.</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13231312,"title":"group by with value of column SQL","body":"<p>I would like to display for a given user percentages by type (M or C)\nI tried with this query:</p>\n\n<pre><code> SELECT TYPE,user_name,pourcentage_c,pourcentage_m,id_user,COUNT(TYPE) AS crtitique ,COUNT(TYPE) AS majeur\n    FROM stat_alert  \n    LEFT OUTER JOIN user_qdf  \n    ON user_qdf.`id` = id_user   \n    WHERE user_qdf.`id`=id_user AND TYPE='C'\n    GROUP BY id_user \n\n   UNION ALL\n\n SELECT TYPE,user_name,pourcentage_c,pourcentage_m,id_user,COUNT(TYPE) AS        crtitique,COUNT(TYPE) AS majeur \n    FROM stat_alert  \n    LEFT OUTER JOIN user_qdf  \n    ON user_qdf.`id` = id_user   \n    WHERE user_qdf.`id`=id_user AND TYPE='M'\n    GROUP BY id_user\n</code></pre>\n\n<p>I want to display in the same line the  percentage and the number of critical and important for a single user</p>\n\n<p><img src=\"http://i.stack.imgur.com/QEctj.png\" alt=\"enter image description here\"></p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13231501,"title":"sql sum repeats from sql query?","body":"<p>I have a sql output which shows the sales_id and the car manufacturers(car_info) they have sold. </p>\n\n<p>I want to create an extra column in the output which shows a total of the manufacturers sold instead as it shows currently just the sales_id and repeats manufacturers associated to each sale</p>\n\n<p>The query I am currently using is :</p>\n\n<pre><code>SELECT i.car_info \n  FROM inventory i \n  JOIN sales s ON s.car_id = i.car_id\nWHERE s.sales_id = 'sales_id1';\n</code></pre>\n\n<p>I have attempted to use the  sum and the count function but have had no luck.</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":70,"score":2,"question_id":13158137,"title":"how to separate field in oracle contain data varchar and number and date","body":"<p>how to separate field in oracle contain data var char and number and date \nex:</p>\n\n<pre><code>table1:\ncolumn1:MohammadBadarneh_07889855_12021990\n\ncreate procedure to separate and insert into table2:\ntable2:\nname:Mohammad Badarneh\nphone number: 07889855\ndate: 12-02-1990 \n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13231395,"title":"SQLPLUS ORACLE select statement","body":"<p>List the student number, subject code, year, and the term of the students\nwho register to only ONE subject in 2012 session 3.</p>\n\n<pre><code>SELECT StudentNum, RSubjectCode, Year, SessionTerm \n FROM &lt;TABLE&gt; \nWHERE Year ='2012' \n  AND SESSIONTERM = '3';\n</code></pre>\n\n<p>This selects everyone from year 2012 and session 3. How do I only find out the student who registered ONE subject only?</p>\n"},{"tags":["mysql","sql","sql-order-by","case"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13231167,"title":"Aliases not working in ORDER BY clause","body":"<p>This will work fine in MySQL 5:</p>\n\n<pre><code>SELECT INSTR(foo, 'Bar') as foobar\nFROM Table\nORDER BY CASE WHEN foobar = 1 THEN foo END DESC;\n</code></pre>\n\n<p>Bu in MySQL 4, I get the error:</p>\n\n<pre><code>ERROR 1054 (42S22): Unknown column 'foobar' in 'order clause'\n</code></pre>\n\n<p>However, if I change the clause to this, it will work on both versions:</p>\n\n<pre><code>SELECT INSTR(foo, 'Bar') as foobar\nFROM Table\nORDER BY CASE WHEN INSTR(foo, 'Bar') = 1 THEN foo END DESC;\n</code></pre>\n\n<p>To ensure compatibility, do I have to always use the second way?</p>\n"},{"tags":["sql","if-statement","case","outer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13231003,"title":"if statements inside outer apply or case when","body":"<p>is it possible to have if statements inside an outer apply? I can't seem to get it work.</p>\n\n<p>this is the existing code that works:</p>\n\n<pre><code>select id\nfrom\nresidentmemberlease rml\nleft outer join lease l on rml.leaid = l.leaid\nouter apply\n(SELECT TOP(1) * FROM dbo.RentalHistory a WITH(NOLOCK) WHERE a.resmID = RML.resmID and rthDisplayBit='1'\nORDER BY ISNULL(a.rthMoveOutDate, a.rthMoveInDate) DESC) AS RH\n</code></pre>\n\n<p>i want it to look like this depending on the value of the codeleasestatuscode(if its 1 or 2):</p>\n\n<pre><code>select id\nfrom\nresidentmemberlease rml\nleft outer join lease l on rml.leaid = l.leaid\nouter apply\nif(select codeleasestatuscode from lease) = '1'\nbegin\n(SELECT TOP(1) * FROM dbo.RentalHistory a WITH(NOLOCK) WHERE a.resmID = RML.resmID and rthDisplayBit='1'\nORDER BY ISNULL(a.rthMoveOutDate, a.rthMoveInDate) DESC) AS RH\nend\nif(select codeleasestatuscode from lease) = '2'\nbegin\n(SELECT TOP(1) * FROM dbo.RentalHistory a WITH(NOLOCK) WHERE a.resmID = RML.resmID and rthDisplayBit='0'\nORDER BY ISNULL(a.rthMoveOutDate, a.rthMoveInDate) DESC) AS RH\nend\n</code></pre>\n"},{"tags":["sql","oracle","plsql","oracle-apex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13183322,"title":"Filter out duplicate entries in report in Oracle 11g","body":"<p>We're running Oracle 11g on Windows Server 2008 R2</p>\n\n<p>I currently have an application that used nationally for managing our recruiting system, we're a contract engineering staffing firm.</p>\n\n<p>Now, we have a pretty decently sized database of candidates we've previously worked with and I used Oracle Text to make the attached resumes searchable, which works out great, the only issue is that we often send the same candidate to multiple jobs in order to put them to work faster, which means I may get the same candidate's resume turning up 6 or 7 times in the search results, I'm looking to have it filter out duplicates based on candidate's name and recruiter name since I don't want to only filter out candidate names since some people have the same name, but usually 1 recruiter works with 1 candidate, I know it's not perfect, but could help to narrow things down.</p>\n\n<p>I've tried a few things to remove the dupes, but I can't get it to work, here's the current query that we use to generate the search results.</p>\n\n<pre><code>select score(1) relevance,\n\"PKEY\",\n\"DATE_SUB\",\n\"CLIENT\",\n\"CANDIDATE\",\n\"RECRUITER\",\n\"SALES\",\ndbms_lob.getlength(\"RESUME\") \"RESUME\",\n+\"MIMETYPE\",\n\"FILENAME\",\n\"POSITION\",\n\"AVAILABILITY\",\n\"RATE\",\n\"ISSUES\",\n\"WHEN_INT\",\n\"FEEDBACK\",\n\"NOTES\"\nfrom \"SUBMITTALS\"\nwhere CONTAINS (resume, :P11_SEARCH, 1) &gt; 0 order by 1 desc\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Thanks again.</p>\n"},{"tags":["javascript","sql","sql-server","asp-classic"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13176438,"title":"Adding form data to a database ASP and SQL Server","body":"<p>I have been googling the net for hours and i still can't get my head around this!</p>\n\n<p>to start with, i have this code which is the form i have created.</p>\n\n<pre><code>&lt;!-- #include file=\"Header.asp\" --&gt;\n&lt;!-- #include file=\"Tauthenticate.asp\" --&gt;\n&lt;!--#include file=\"database.asp\"--&gt;\n\n&lt;SCRIPT LANGUAGE=\"JavaScript\"&gt;\n\nfunction confirmSubmit()\n{\nvar agree=confirm(\"Confirm?\");\nif (agree)\nreturn true ;\nelse\nreturn false ;\n}\n&lt;/script&gt;\n\n\n    &lt;table border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" id=\"table17\"&gt;\n        &lt;tr&gt;\n            &lt;td background=\"../images/bar1.jpg\"&gt;&lt;font size=\"2\"&gt;&amp;nbsp;&lt;b&gt;Add \n            Skill&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;/table&gt;\n            &lt;table border=\"0\" width=\"100%\" id=\"table18\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n                &lt;form method=\"POST\" action=\"SaveNewSkill.asp\"&gt;\n                &lt;tr&gt;\n\n                &lt;/tr&gt;\n\n                &lt;td width=\"108\"&gt;&lt;font face=\"Verdana\" size=\"2\" &gt;Employee &lt;/font&gt; &lt;/td&gt;\n    &lt;td&gt;\n\n\n        &lt;p&gt;&lt;font face=\"Verdana\"&gt;&lt;select size=\"1\" name=\"D1\"&gt;\n        &lt;%\n            sql=\"select User_ID, First_Name, Surname from Company Where Status not like 'left%' and (Company.Office='Manchester' or Company.Office='Romania') order by Surname\"\n            set users=conn.execute(sql)\n            do while not users.eof \n                %&gt;\n                    &lt;option value=\"&lt;%=users(\"User_ID\")%&gt;\"&gt;&lt;%=users(\"First_Name\") &amp; \" \" &amp; users(\"Surname\")%&gt;&lt;/option&gt;\n                &lt;%\n                users.movenext\n                loop\n                set users=nothing\n                %&gt;\n        &lt;/select&gt;&lt;/font&gt;&lt;/p&gt;\n\n    &lt;/td&gt;\n\n\n                &lt;tr&gt;\n                    &lt;td width=\"142\"&gt;&lt;b&gt;&lt;font size=\"2\" face=\"Verdana\"&gt;Skill&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;\n                    &lt;select size=\"1\" name=\"D3\"&gt;\n                    &lt;option value=\"AutoCad 2D\"&gt;AutoCAD 2D&lt;/option&gt;\n                    &lt;option value=\"3D Modeling\"&gt;3D Modeling&lt;/option&gt;\n                    &lt;option value=\"Sketchup\"&gt;Sketchup&lt;/option&gt;\n                    &lt;/select&gt;&lt;/td&gt;\n\n                &lt;/tr&gt;\n\n                &lt;tr&gt;\n                    &lt;td width=\"142\"&gt;&lt;b&gt;&lt;font size=\"2\" face=\"Verdana\"&gt;Current Skill Level&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;\n                    &lt;select size=\"1\" name=\"D4\"&gt;\n                    &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                    &lt;option value=\"2\"&gt;2&lt;/option&gt;\n                    &lt;option value=\"3\"&gt;3&lt;/option&gt;\n                    &lt;option value=\"4\"&gt;4&lt;/option&gt;\n                    &lt;option value=\"5\"&gt;5&lt;/option&gt;\n                    &lt;/select&gt;&lt;/td&gt;\n\n                &lt;/tr&gt;\n\n                    &lt;tr&gt;\n                    &lt;td width=\"142\"&gt;&lt;b&gt;&lt;font size=\"2\" face=\"Verdana\"&gt;Required Skill Level&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;\n                    &lt;select size=\"1\" name=\"D4\"&gt;\n                    &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                    &lt;option value=\"2\"&gt;2&lt;/option&gt;\n                    &lt;option value=\"3\"&gt;3&lt;/option&gt;\n                    &lt;option value=\"4\"&gt;4&lt;/option&gt;\n                    &lt;option value=\"5\"&gt;5&lt;/option&gt;\n                    &lt;/select&gt;&lt;/td&gt;\n\n                &lt;/tr&gt;\n\n                &lt;/form&gt;\n                &lt;/table&gt;\n    &lt;form&gt;&lt;p&gt;&lt;font size=\"2\"&gt;&lt;input type=\"submit\" value=\"Save\" name=\"B1\" onclick=\"return confirmSubmit()\"&gt;&lt;/font&gt;&lt;/form&gt;\n    &lt;td width=\"75\"&gt;\n            &lt;!-- #include file=\"footer.asp\" --&gt;\n</code></pre>\n\n<p>the files that are included are for the header, connection to the database and authentication to view the page in the first place (which all works).</p>\n\n<p>the form queries the database for our list of users then allows the user to select a skill from a list and define their current level of expertise.</p>\n\n<p>i have then created this \"save skill\" asp page.</p>\n\n<pre><code>&lt;!--#include file=\"database.asp\"--&gt;\n&lt;!--#include File=\"TUauthenticate.asp\"--&gt;\n\n\n&lt;%\n\n\nUser_ID=request.querystring(\"User_ID\")\nsql=\"select * from company where User_ID=\" &amp; User_ID\nset rs=conn.execute(sql)\nSession(\"User_ID\")=User_ID\n\n\nSkill=request.form(\"D3\")\nCurrent_Level=Request.form(\"D4\")\nUser_ID=request.form(\"D1\")\nRequired_Level=request.form(\"D5\")\n\nif request.form(\"B1\")&lt;&gt;\"\" then\nif skill = \"AutoCAD 2D\" then\nsqlq=\"insert into skills (User_ID, AutoCad_2D, AutoCad_2DR) Values (\" &amp; User_ID &amp; \",'\" &amp;    Current_Level &amp; \"','\" &amp; Required_Level &amp; \"')\"\nresponse.write(sqlq)\nset rs=conn.execute(sqlq)\nend if\nend if\n\n%&gt;\n</code></pre>\n\n<p>i have put this together using various pieces of working code but it will not save to the database... i understand its not very neat but i will sort that once i know whats wrong with it.</p>\n\n<p>i know i've included a little bit of javascript but i'd prefare if answers were in asp code (as im currently trying to study asp) </p>\n\n<p>Thanks in advance guys! :D</p>\n"},{"tags":["sql","sql-server","stored-procedures","openquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13230430,"title":"Insert Into a Table Across Linked Server From SP Using Openquery","body":"<p>I want to send data across from one server to another, I wish to improve my performance and wondered if OpenQuery is a good route to go down?</p>\n\n<p>I tried to do something like this;</p>\n\n<pre><code>INSERT INTO OPENQUERY (SERVERNAME, '(SELECT Num1, Num2, Num3 FROM [DBName].[dbo].TableName)')\n(Num1, Num2, Num3)\nSELECT Num1, Num2, Num3\n FROM #Temp\n</code></pre>\n\n<p>However this returns the error</p>\n\n<pre><code>The provider indicates that conflicts occurred with other properties or requirements.\n</code></pre>\n\n<p>I don't understand this as the query does run fine and produce the required results without OpenQuery...</p>\n\n<p>Could any of you advise me on this please?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":94,"score":6,"question_id":13229946,"title":"Difference between Tables and Temp Tables","body":"<p>why this code work without problem :</p>\n\n<pre><code>drop table t1 \nselect * into t1 from  master..spt_values\ndrop table t1 \nselect * into t1 from  master..spt_values\n</code></pre>\n\n<p>Output </p>\n\n<pre><code>Msg 3701, Level 11, State 5, Line 1\nCannot drop the table 't1', because it does not exist or you do not have permission.\n\n(2508 row(s) affected)\n\n(2508 row(s) affected)\n</code></pre>\n\n<p>but this code does not :</p>\n\n<pre><code>drop table #t1 \nselect * into #t1 from  master..spt_values\ndrop table #t1 \nselect * into #t1 from  master..spt_values\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Msg 2714, Level 16, State 1, Line 4\nThere is already an object named '#t1' in the database.\n</code></pre>\n\n<p>what is the difference between Tables and Temp Tables in this code ?</p>\n"},{"tags":["c#","javascript","sql","json","razor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2330,"score":0,"question_id":9416380,"title":"Creating a JSON result from SQL server database","body":"<p>I have an SQL server with the following layout </p>\n\n<pre><code>Table (    id int\n           title varchar(40),\n           start Date(),\n           end Date(),\n           allDay bool,\n           username varchar(40)\n      );\n</code></pre>\n\n<p>I have gotten the following code from <a href=\"http://weblogs.asp.net/gunnarpeipman/archive/2010/02/03/using-fullcalendar-jquery-component-with-asp-net-mvc.aspx\" rel=\"nofollow\">this blog</a> to create a JSON object from the data I wish to use, however his data is stored differently. How do I create the same object, extracted from my database?</p>\n\n<p>I am guessing I need to make the file a .cshtml file rather than a .js file and use this :</p>\n\n<pre><code>@{\n    var db = Database.Open(\"events\"); \n    var selectQueryString = \"SELECT * FROM events\";\n}\n\n @foreach(var row in db.Query(selectQueryString)){ }\n</code></pre>\n\n<p>But how do I adapt this code to produce the same JSON object?</p>\n\n<p>Here is the relevant code from the blog, my attempt is below :</p>\n\n<pre><code>public JsonResult GetEvents(double start, double end)\n{\n    var userName = Session[\"UserName\"] as string;\n    if(string.IsNullOrEmpty(userName))\n    {\n        return null;\n    }\n\n    var fromDate = ConvertFromUnixTimestamp(start);\n    var toDate = ConvertFromUnixTimestamp(end);\n\n    var rep = Resolver.Resolve&lt;IEventRepository&gt;();\n    var events = rep.ListEventsForUser(userName,fromDate,toDate);\n\n    var eventList = from e in events\n                    select new {\n                                id = e.Id,\n                                title = e.Title,\n                                start = e.FromDate.ToString(\"s\"),\n                                end = e.ToDate.ToString(\"s\"),\n                                allDay = false\n                            }; \n\n    var rows = eventList.ToArray();\n    return Json(rows,JsonRequestBehavior.AllowGet);           \n}\n</code></pre>\n\n<p>Edit :</p>\n\n<p>I am now working with the following .cshtml code for the GetEvents command, but it will not work. Does anybody have any ideas ?</p>\n\n<pre><code>   @{ \n        var origin = new DateTime(1970, 1, 1, 0, 0, 0, 0);\n        var fromDate = origin.AddSeconds((Request[\"start\"]));\n        var toDate = origin.AddSeconds(Request[\"end\"]);\n\n        var db = Database.Open(\"events\");\n        var result = db.Query(\"SELECT * FROM events\");\n        var data = result.Select(x =&gt; new \n        {\n            id = x.id,\n            title = x.title,\n            start = x.start.ToString(\"s\"),\n            end = x.end.ToString(\"s\"),\n            allDay = false            \n        }).ToArray();\n\n        Json.Write(data, Response.Output);\n        Response.ContentType = \"application/json\";\n    }\n</code></pre>\n"},{"tags":["c#","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13230878,"title":"need solution for dispaly data using asp.net from sql server","body":"<p>I can insert data to sql server using asp.net. And I also display this data easily using data grid. But I need to display this data in bangali language. I don't know how to display this. I need help for this problem. </p>\n"},{"tags":["mysql","sql","datetime-generation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":68,"score":3,"question_id":13225902,"title":"Get sum of fields","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3954200/mysql-count-data-for-last-7-days\">MySQL Count data for last 7 days</a>  </p>\n</blockquote>\n\n\n\n<p>I have an issue where i need to show the sum of fields. Lets say I have a recordset as follows,</p>\n\n<pre><code>detectDate      |isp    |infection  | count\n--------------------------------------\n2012-10-02 01:00|aaaa   |malware    |3\n2012-10-02 01:30|bbbb   |malware    |2\n2012-10-02 01:33|bbbb   |spy-eye    |2\n2012-10-02 01:45|aaaa   |DDos       |1\n2012-10-03 01:50|cccc   |malware    |2\n2012-10-03 02:00|dddd   |TDSS       |2\n2012-10-03 04:50|dddd   |TDSS       |3\n</code></pre>\n\n<p>And i want to display an output which will show the sum of all the infections for each day as follows,</p>\n\n<pre><code>detectDate  |infection  | count\n-------------------------------\n2012-10-02  |DDos       |1\n2012-10-02  |malware    |5\n2012-10-02  |spy-eye    |2\n2012-10-02  |TDSS       |0\n2012-10-03  |DDos       |0\n2012-10-03  |malware    |2\n2012-10-03  |spy-eye    |0\n2012-10-03  |TDSS       |5\n</code></pre>\n\n<p>I used this query,</p>\n\n<pre><code>SELECT DATE_FORMAT( detectDate, '%Y-%m-%d' ) AS detectDate, infection, SUM( count )\nFROM `tbl_correlateddata`\nGROUP BY DATE_FORMAT( detectDate, '%Y-%m-%d' ) , infection\n</code></pre>\n\n<p>but it only gives an out put as follows which is <strong>NOT</strong> my requirement..</p>\n\n<pre><code>detectDate  |infection  | count\n-------------------------------\n2012-10-02  |DDos       |1\n2012-10-02  |malware    |5\n2012-10-02  |spy-eye    |2\n2012-10-03  |malware    |2\n2012-10-03  |TDSS       |5\n</code></pre>\n\n<p>any help would be much helpful :)\nThank you very much :) much appreciated :)</p>\n\n<p><strong>EDIT:</strong>\nPossible duplicate of : <a href=\"http://stackoverflow.com/questions/3954200/mysql-count-data-for-last-7-days\">MySQL Count data for last 7 days</a></p>\n\n<p><strong>but not similar</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13229558,"title":"An expression of non-boolean type specified in a context where a condition is expected, near ','","body":"<p>I've reviewed other similar questions on this however I do not have a <code>Where</code> clause in my query which leaves me a little confused as to how to resolve it.</p>\n\n<pre><code>INSERT INTO #tmpCombined  \nSELECT A.Region  \n    , 'MyLocation' AS 'Location'  \n    , c.Id AS 'CompID'  \n    , c.Name AS 'CompName'  \n    , 'Cash' AS 'Context'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;= 0 and CASE WHEN T.TranAge &lt; 1 THEN 1 ELSE 0 END,0 )) AS 'ZeroDays0'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;= 1 and CASE WHEN T.TranAge &lt; 8 THEN 1 ELSE 0 END ), 0 ) AS '1to7Days'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;=  8 and CASE WHEN T.TranAge &lt; 16 THEN 1 ELSE 0 END ), 0 ) AS '8to15Days'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;=  16 and CASE WHEN T.TranAge &lt; 20 THEN 1 ELSE 0 END ), 0 ) AS '16to20Days'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;=  20 THEN 1 ELSE 0 END ), 0 ) AS '20DaysPlus'  \n    , COUNT(1) AS 'Total'  \n    , A.Level as 'Level'  \n    , sum(T.USDDifference) AS 'USDRevaluation'  \n    from MyLocation.dbo.Company C  \n    inner join #tmpCashTBResults T on T.CompanyId = C.Id  \n    inner join #tmpCashAccounts A on T.CompanyId = A.CompanyId  \n    group by A.Region, C.Id, C.Name, A.Level  \n</code></pre>\n"},{"tags":["sql","json","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13226760,"title":"Execute SQL script in Entity Framework & convert the result to JSON","body":"<p>Hey Guys I want to execute this SQL script in Entity Framework &amp; return the result in <code>JSONResult</code> format to access in jQuery.. Please help!!!</p>\n\n<p>My Entity Framework model contains the tables &amp; databases mentioned in SQL script </p>\n\n<p>THANKS :-)</p>\n\n<pre><code>DECLARE @listCol VARCHAR(2000)\nDECLARE @query VARCHAR(4000)\nSELECT  @listCol = STUFF(( SELECT distinct  '], [' + [PSize]\n                           FROM     Pattern\n                         FOR\n                           XML PATH('')\n                         ), 1, 2, '') + ']'\nSET @query = 'SELECT * FROM\n      (SELECT PColour as Colour_Size_Matrix, PSize, PCode\n            FROM Pattern\n            ) src\nPIVOT (Count(PCode) FOR PSize\nIN (' + @listCol + ')) AS pvt'\nEXECUTE ( @query )\n</code></pre>\n"},{"tags":["python","sql","database","firebird","firebird2.5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":40,"score":-2,"question_id":13230203,"title":"Receiving quantity and list of fields of the table in Firebird","body":"<p>What sql request receives quantity of fields of the table Firebird in firebirdsql connection with database? What sql request receives the list of fields of the table Firebird in firebirdsql connection with database? It is not duplicate of <a href=\"http://stackoverflow.com/questions/13227764/receiving-quantity-and-list-of-fields-of-the-table\">Receiving quantity and list of fields of the table</a>, Now I want to know this for firebird database with firebirdsql connection in Python?</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":28,"score":4,"question_id":13230133,"title":"Selecting all uppercased-value rows of a table in SQL Navigator","body":"<p>I have a table with an email address column. Some email addresses in the table contain uppercase letters. I would like to fetch all the rows with uppercase emails (in order to set them to lowercase). How do I select all the rows where the email address contains uppercase letters?</p>\n"},{"tags":["sql","query","typo3","raw","extbase"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13084863,"title":"Extbase - get created sql from query","body":"<p>i want to get some database tables from my typo3 extensions.\nThe Extension is based on extbase.</p>\n\n<p>The query always returns nothing but the data exists</p>\n\n<p>I've tried this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n$query-&gt;statement('SELECT * FROM `my_table`\n    WHERE field = ? ORDER BY date DESC LIMIT 1',\n    array($condition));\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n\n$query-&gt;matching($query-&gt;equals('field', $condition));\n$query-&gt;setOrderings(array('date' =&gt; Tx_Extbase_Persistence_QueryInterface::ORDER_DESCENDING));\n$query-&gt;setLimit(1);\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>both returns <em>null</em> as result.</p>\n\n<p>Is it possible to get the sql that the class creates to look where the bug is?</p>\n\n<p>I've looked in some extbase persistent classes but didn't find a clue</p>\n\n<p>EDIT: \nFor those who are interested.. i found a \"solution\".</p>\n\n<p>If you create the query with the statement() method, you can print the query with this function</p>\n\n<pre><code>echo $query-&gt;getStatement()-&gt;getStatement();\n</code></pre>\n\n<p>It doesn't replace the placeholder.\nBut you can get the Variables with this method</p>\n\n<pre><code>var_dump($query-&gt;getStatement()-&gt;getBoundVariables());\n</code></pre>\n\n<p>Thats the best Solution that i found, without editing the extbase extenstions</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13229350,"title":"Sql query join?","body":"<p>I have one table containing car inventory. This has two columns one is car_id and the other is car_info e.g. bmw 320</p>\n\n<p>The other table also contains a table with two columns. One is sales_ids and the other is car_id they have sold.</p>\n\n<p>I want to create an sql query were the output will be the sales_id and the car name which was sold by that sales_id. </p>\n\n<p>I have tried using a join query but have had no sucess thus far. Can anyone offer some help</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2305,"score":0,"question_id":763802,"title":"How to permit update of a view's results in Oracle?","body":"<p>I understand that database views are read-only, or at least read-only by default.</p>\n\n<p>Is it possible to enable the change of data brought by an oracle view?</p>\n\n<p><strong>Rephrasing:</strong> If I make a view of just one table, just to hide some columns, will changes to this data be updated on the table?</p>\n"},{"tags":["sql","oracle11g"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13160074,"title":"Oracle 11g and SQL TOP query","body":"<p>While using <code>SELECT TOP 5 * FROM SOMETABLE</code> gives me an error </p>\n\n<p><em>ORA-00923: FROM keyword not found where expected</em></p>\n\n<p>I am using Oracle 11g . I am aware of using <code>rownum</code> for doing the same thing but just wondering SQL TOP usage is not at all supported in Oracle ? Anything need to do extra to make SQL TOP working in Oracle ?? </p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":13229138,"title":"Get the last 4 months of the year in MySQL?","body":"<p>i am new to mysql.  I want to know about last 4 month names from sql.</p>\n\n<p>like</p>\n\n<pre><code>  SELECT TO_CHAR(ADD_MONTHS(SYSDATE, -level), 'Month') AS month\n    FROM dual\n    CONNECT BY LEVEL &lt; 4 \n</code></pre>\n\n<p>but how this can be done with mysql?</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":10430335,"title":"sql query to find absent tables from database","body":"<p>I am using ORACLE database. \n<strong>EDIT</strong>:</p>\n\n<p>I want only tables not present in a list, not all those tables in database.</p>\n\n<p>Ex: In my database following tables are present:</p>\n\n<pre><code>a\nb\nc\nd\ne\nr\ns\n</code></pre>\n\n<p>I am being given a list of tables:</p>\n\n<pre><code>a\nb\nc\nv\nh\n</code></pre>\n\n<p>out of which i want to find out which tables are <strong>absent(not present)</strong> in my database.</p>\n\n<p>so: a, b, c are those tables which are present in my database. So excluding these tables my answer will be:</p>\n\n<pre><code>v and h \n</code></pre>\n\n<p><strong>My answer is not d,e,r,s</strong></p>\n\n<p>How can i write a query for this to find out?</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13229461,"title":"C# change date between different formats","body":"<p>I want to know if there's a way to change the date format depending on the users local date format setting. The date I will store in the DB it's <code>YYYY-MM-DD</code> but the users have different formats, like <code>DD-MM-YYYY</code> or <code>DD.MM.YYYY</code>. What is a clean, elegant way to ensure that my application always retrives the date in local date format, and SQL server always receives the date in <code>YYYY-MM-DD</code> to be stored.</p>\n"},{"tags":["sql","sql-server-2005","quotes","quotations"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":20215,"score":4,"question_id":775687,"title":"How to insert text with single quotation sql server 2005","body":"<p>I want to insert text with single quote \nEg john's to table  in sql server 2005 database</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":13745,"score":6,"question_id":1586560,"title":"How do I escape a single quote in sqlserver?","body":"<p>I'm trying to insert some text data into a table in SQLServer 9.\nThe text includes a single quote.\nHow do I escape that?\nI tried using two single quotes, but it threw me some errors.\neg. insert into my_table values('hi, my name''s tim.');</p>\n"},{"tags":["sql","mongodb","database-design","nosql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13228880,"title":"Category Implementation in a database","body":"<p>I'm building a system that involves users and teachers. In this particular system however I would like to categorize the teachers, but the tricky part is the categories are dynamic thus they can change anytime.</p>\n\n<p>I have to have some functions, since I'm developing the backend;</p>\n\n<ul>\n<li> The first one is <b>showAllCategories()</b>, that shows all the <b>main</b> categories.</li>\n<li>Second is the <b>showSubcategories()</b> which shows the subcategories of a category() </li>\n<li>Third is the <b>showContent()</b>, which in this case shows the teacher's information.</li>\n</ul>\n\n<p>Before asking mighty Stack-Overflowers how would this be efficiently implemented, I thought I could use a doubly linked list approach where in categories table <b>CategoryName</b>, <b>Before</b>, <b>After</b>, <b>Content</b> and if the category did not have the after, the content would be pointing to the teacher's table. This is my classic SQL approach however I'm using <b>MongoDB</b> and since I'm a beginner I wonder if I could take the advantage of NoSQL in this particular situation?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13229241,"title":"How to create procedure with the same WHERE column","body":"<p>How can I create one procedure and the <code>WHERE</code> column is the same?</p>\n\n<p>The <code>WHERE</code> column is <code>QuotationNo</code></p>\n\n<p>This is the procedure signature:</p>\n\n<pre><code>create procedure (QUO1 int, QUO2 int, QUO3 int, QUO4 int)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Quote     price     quantity\n---------------------------------\n1234       2000        1000\n5678       2500        4000\n9012        3000        4500 \n3456        1000        1000\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Captain16</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13228765,"title":"Move values from table to another in PostgreSQL","body":"<p>Hello I have a PostgreSQL 9.1 database with such tables [tables are simplified]</p>\n\n<p><img src=\"http://i.stack.imgur.com/2ZoJ0.jpg\" alt=\"enter image description here\"></p>\n\n<p>For now I use only tables: account, account_word and word. But I wanted to add groups of words into my database. So I created tables wordgroup and wordgroup_word. Now my table account_word is no longer needed so I would like to move all words from account_word to wordgroup_word. In general:</p>\n\n<p><strong>I would like to move all account's word to his wordgroup where group's \"is_all\" is true and then delete account_word table</strong></p>\n\n<p>Could someone help me to achieve this? </p>\n\n<p>Cheers</p>\n"},{"tags":["sql","database","oracle","left-join","oracle9i"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13194453,"title":"leftouter join in sql","body":"<p>I have two tables initially in the application. They are as</p>\n\n<pre><code>user                       \n------------------------      \nuser_id                      \ncolumn1                         \ncolumn2\n..\n\nColumnn\n</code></pre>\n\n<h2>user_account_info</h2>\n\n<pre><code>user_id                   \naccount_number (can have multiple a/c number on single user_id)        \ncolumn1                      \ncolumn2          \n..            \nColumnn  \n</code></pre>\n\n<hr>\n\n<p>the query is like </p>\n\n<pre><code>SELECT u.column1, uai.column1, uai.Keycolumn2\n        FROM user u\n        LEFT OUTER JOIN user_account_info uai on u.user_id  = uai.user_id\n</code></pre>\n\n<p>But later a new table user_account_map is added and user_account_info is changed</p>\n\n<h2>user</h2>\n\n<pre><code>user_id                 \ncolumn1                                        \ncolumn2             \n..               \nColumnn   \n</code></pre>\n\n<h2>user_account_info</h2>\n\n<pre><code>account_number (can have multiple a/c number on single user_id)                       \ncolumn1                  \ncolumn2               \n..               \nColumnn \n</code></pre>\n\n<h2>user_account_map</h2>\n\n<pre><code>user_id                      \naccount_number (can have multiple a/c number on single user_id)                \ncolumn1              \ncolumn2 \n</code></pre>\n\n<p>How to rewrite the query to match the output that of the previous query.\n Is it ok to write like                   </p>\n\n<pre><code>SELECT u.column1, uai.column1, uai.Keycolumn2\nFROM user u\nLEFT OUTER JOIN user_account_map uam on u.user_id  = uam.user_id\nLEFT OUTER JOIN user_account_info uai on u.account_number  = uai.account_number\n</code></pre>\n"},{"tags":["sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":54,"score":0,"question_id":13228969,"title":"How to combine these SQL queries so that it can display one output?","body":"<p>Help needed to combine the output of this query together.How it can be done??TQ</p>\n\n<pre><code>select facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('6910','7976')\nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n\n\nselect facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('6912','7976') \nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n\nselect facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('7344','7976') \nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n\nselect facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('8344','7976')\nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n</code></pre>\n"},{"tags":["sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13193770,"title":"EF generated SQL Query returns wrong result","body":"<p>I want to filter on a specific date. Because of the control I use I can also filter on a range of dates, but when I filter on a single date it should also work so I have total flexibility.</p>\n\n<p>When I filter on 2004-11-24 my code generates the following query with Entity Framework. However somehow the query returns me the results of 2004-11-25 instead of 2004-11-24.</p>\n\n<p>What is wrong with this query? </p>\n\n<pre><code>SELECT TOP (26) \n[Filter1].[Id] AS [Id], \n[Filter1].[AliquotId] AS [AliquotId], \n[Filter1].[ScientificStudyId] AS [ScientificStudyId], \n[Filter1].[ExpectedSpecimenId] AS [ExpectedSpecimenId], \n[Filter1].[ExpectedAliquotId] AS [ExpectedAliquotId], \n[Filter1].[VisitId] AS [VisitId], \n[Filter1].[BoxId] AS [BoxId], \n[Filter1].[ParticipantId] AS [ParticipantId], \n[Filter1].[Product] AS [Product], \n[Filter1].[BodyMaterial] AS [BodyMaterial], \n[Filter1].[AliquotNr] AS [AliquotNr], \n[Filter1].[ReservationName] AS [ReservationName], \n[Filter1].[Visit] AS [Visit], \n[Filter1].[Win32Color] AS [Win32Color], \n[Filter1].[Position] AS [Position], \n[Filter1].[Barcode] AS [Barcode], \n[Filter1].[Temperature] AS [Temperature], \n[Filter1].[DivergentStorageTemperature] AS [DivergentStorageTemperature], \n[Filter1].[BoxName] AS [BoxName], \n[Filter1].[CollectionDate] AS [CollectionDate], \n[Filter1].[Positioned] AS [Positioned], \n[Filter1].[CheckedOut] AS [CheckedOut], \n[Filter1].[CheckinDate] AS [CheckinDate], \n[Filter1].[CheckoutDate] AS [CheckoutDate], \n[Filter1].[LabelsPrinted] AS [LabelsPrinted], \n[Filter1].[ParticipantNr] AS [ParticipantNr], \n[Filter1].[Specimen] AS [Specimen], \n[Filter1].[ContainerType] AS [ContainerType], \n[Filter1].[ContainerTypeId] AS [ContainerTypeId], \n[Filter1].[Quantity] AS [Quantity], \n[Filter1].[Unit] AS [Unit], \n[Filter1].[QuantityUnit] AS [QuantityUnit], \n[Filter1].[StudyVersion] AS [StudyVersion], \n[Filter1].[ThawCount] AS [ThawCount], \n[Filter1].[Sop] AS [Sop], \n[Filter1].[NrOfRemarks] AS [NrOfRemarks], \n[Filter1].[RemarkSummary] AS [RemarkSummary]\nFROM ( SELECT [Extent1].[Id] AS [Id], [Extent1].[AliquotId] AS [AliquotId], [Extent1]. [ScientificStudyId] AS [ScientificStudyId], [Extent1].[ExpectedSpecimenId] AS [ExpectedSpecimenId], [Extent1].[ExpectedAliquotId] AS [ExpectedAliquotId], [Extent1].[VisitId] AS [VisitId], [Extent1].[BoxId] AS [BoxId], [Extent1].[ParticipantId] AS [ParticipantId], [Extent1].[Product] AS [Product], [Extent1].[BodyMaterial] AS [BodyMaterial], [Extent1].[AliquotNr] AS [AliquotNr], [Extent1].[ReservationName] AS [ReservationName], [Extent1].[Visit] AS [Visit], [Extent1].[Win32Color] AS [Win32Color], [Extent1].[Position] AS [Position], [Extent1].[Barcode] AS [Barcode], [Extent1].[Temperature] AS [Temperature], [Extent1].[DivergentStorageTemperature] AS [DivergentStorageTemperature], [Extent1].[BoxName] AS [BoxName], [Extent1].[CollectionDate] AS [CollectionDate], [Extent1].[Positioned] AS [Positioned], [Extent1].[CheckedOut] AS [CheckedOut], [Extent1].[CheckinDate] AS [CheckinDate], [Extent1].[CheckoutDate] AS [CheckoutDate], [Extent1].[LabelsPrinted] AS [LabelsPrinted], [Extent1].[ParticipantNr] AS [ParticipantNr], [Extent1].[Specimen] AS [Specimen], [Extent1].[ContainerType] AS [ContainerType], [Extent1].[ContainerTypeId] AS [ContainerTypeId], [Extent1].[Quantity] AS [Quantity], [Extent1].[Unit] AS [Unit], [Extent1].[QuantityUnit] AS [QuantityUnit], [Extent1].[StudyVersion] AS [StudyVersion], [Extent1].[ThawCount] AS [ThawCount], [Extent1].[Sop] AS [Sop], [Extent1].[NrOfRemarks] AS [NrOfRemarks], [Extent1].[RemarkSummary] AS [RemarkSummary], row_number() OVER (ORDER BY [Extent1].[CollectionDate] ASC) AS [row_number]\nFROM [dbo].[ClaimedAliquotPositionsReadModels] AS [Extent1]\nWHERE (cast('0ebebae6-594d-4be0-ac8b-a078013f1370' as uniqueidentifier) = [Extent1].[ScientificStudyId])\nAND ([Extent1].[CheckoutDate] &gt;= convert(datetime2, '2004-11-24 00:00:00.0000000', 121))\nAND ([Extent1].[CheckoutDate] &lt; convert(datetime2, '2004-11-25 00:00:00.0000000', 121))\n)  AS [Filter1]\nWHERE [Filter1].[row_number] &gt; 0\nORDER BY [Filter1].[CollectionDate] ASC\n</code></pre>\n"},{"tags":["mysql","sql","stored-procedures","view","sql-view"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13228026,"title":"MySQL design; View or Stored Procedure with variable","body":"<p>I've to execute a complex query, selecting several columns from 7-8 tables.</p>\n\n<p>We don't want to write that query in programming language (PHP - Symfony 1.4/Propel 1.4 in our case) but to create a view or stored procedure to have very simple select query for developers. I'm confused what will be better approach.</p>\n\n<p>We need query in following format:</p>\n\n<pre><code>SET @PlayerId = 1;\n\nSELECT CASE WHEN mat.player1id = @PlayerId THEN mat.player2id ELSE mat.player1id END as opponent\n    /*plus many other columns*/\nFROM `wzo_matches` as mat /*plus few other tables*/\nWHERE (mat.player1id =@PlayerId OR mat.player2id=@PlayerId)\n    /*plus other join conditions*/\n</code></pre>\n\n<p>Problem with view is, <code>SET @PlayerId=xx</code> statement. We don't know player id in advance but will be passed through PHP. I hope this is the reason to rule out views; is there any workaround for that?</p>\n\n<p>Other option will be stored procedure. Only issue with that is, it will create a new view for every query so operation will be very heavy for DB.</p>\n\n<p>Can someone suggest best approach so that developers can get required data from above query without writing above complex query in PHP. (Obviously through SP or view &amp; simple select query from there)</p>\n"}]}
{"total":102597,"page":10,"pagesize":100,"questions":[{"tags":["sql","oracle","database-design","data-modeling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":61,"score":-3,"question_id":13225928,"title":"difference between Surrogate key,Synthetic Key, Artificial key","body":"<p>Is there any difference in Surrogate Key, Synthetic Key and Artificial Key ?\nI didn't get the exact difference.</p>\n"},{"tags":["sql","sorting","report","birt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":49,"score":-2,"question_id":13030227,"title":"Is there any way by which we can fix the rows and column in BIRT?","body":"<p>I want the first row and first column to be fixed in the report.\nSo that when I scroll through the report I always see the first row/column.</p>\n\n<p>Thanks in Advanace!!!!</p>\n"},{"tags":["java","sql","validation","jdbc","prepared-statement"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":86,"score":5,"question_id":13228362,"title":"Using prepared statement in the most secure way","body":"<p>From a security validation perspective, is there a difference between:  </p>\n\n<p><code>stmt.setObject(1, theObject);</code>  </p>\n\n<p>and  </p>\n\n<p><code>stmt.setString(1, theObject);</code>?  </p>\n\n<p>I know that in this case <code>theObject</code> is a <code>String</code> but I am interested in making part of this code more general to cover other cases and was wondering if the security perspective of input validation is affected</p>\n"},{"tags":["php","mysql","html","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":492,"score":1,"question_id":11908111,"title":"Inserting SQL data into HTML textarea","body":"<p>I've been reading lots of questions at stackoverflow that have made my life easier, first time I ask something though.</p>\n\n<p>Here is my problem. I need to be able to insert different values from my SQL database into a selected &lt; textarea > field, depending on what option is selected in a &lt; select > input on the same form.</p>\n\n<p>The basic idea is that I want to edit news from the database, edit title and body. To do that, I want to show what (title / body) data contains my db to the user, by getting them from my SQL db. User may have multiple entries in the database, so when I select one entry at the &lt; select > combobox, I'd like to change the  contents to those from the selected entry from the db.</p>\n\n<p>Its a simple idea difficult to express due to my poor English...</p>\n\n<p>HTML form would be more or less as follows:</p>\n\n<pre><code>&lt;form action=\"edit.php\" method=\"post\"&gt;\n    &lt;select name=\"id\"&gt;\n       &lt;option value=\"1\"&gt;Option 1&lt;/option&gt;\n       &lt;option value=\"2\"&gt;Option 2&lt;/option&gt;\n    &lt;/select&gt;\n    &lt;textarea name=\"newsBody\"&gt;&lt;/textarea&gt;\n    &lt;input name=\"submit\" type=\"submit\" value=\"Edit\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>SQL database structure goes more or less as follows:</p>\n\n<p>DB name: database</p>\n\n<p>DB table: news (fields id, body, title, author, timestamp)</p>\n\n<p>I'd like to be able to select news from my &lt; select > getting their 'id' / 'option value', then get from the DB the corrrect value, and show it in the corresponding &lt; textarea >.</p>\n\n<p>I'm new into website coding, and do it just as a hobby, so my knowledge in PHP, MySQL is very basic. I dont provide any PHP code or options, simply because I have no idea how to resolve it... I can understand sql, php syntax though.</p>\n\n<p>I thought using &lt; select > event 'onchange' and javascript, but couldn't make it work... Neither could I using jQuery / ajax, probably because the lack of useful examples!!</p>\n\n<p>Hope that someone understands and can provide a solution!</p>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":11771230,"title":"php + mysql converting multiple rows into columns in a single row","body":"<p>I have a following details in my database table with columns:</p>\n\n<pre><code>currency code\ncurrency rate\ncurrency trade type\n</code></pre>\n\n<p>Eg, I had the following rows in details (database):</p>\n\n<pre><code>USD  3.33  buy \nUSD  3.43  sell\nSGD  4.33  buy\nSGD  4.43  sell\n</code></pre>\n\n<p>And then, I want to bring my database tables into PHP/HTML tables as following:</p>\n\n<pre><code>     BUY   SELL\nUSD  3.33  3.43 \nSGD  4.33  4.43\n</code></pre>\n\n<p>How to use looping to make them be like that?</p>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13228447,"title":"Getting duplicate count and data from table","body":"<p>I have 3 tables like this:</p>\n\n<p>table_1</p>\n\n<pre><code>+-ID-+-table_3_id-+\n|  1 |          1 |\n|  2 |          1 |\n|  3 |          2 |\n+----+------------+\n</code></pre>\n\n<p>table_2</p>\n\n<pre><code>+-ID-+-table_1_id-+-name--+-value-+\n|  1 |          1 | Name1 | Data1 |\n|  2 |          1 | Name2 | Data2 |\n|  3 |          1 | Name3 | Data3 |\n|  4 |          2 | Name1 | Data1 |\n|  5 |          2 | Name2 | Data4 |\n|  6 |          2 | Name3 | Data5 |\n|  7 |          3 | Name1 | Data6 |\n|  8 |          3 | Name2 | Data2 |\n+----+------------+-------+-------+\n</code></pre>\n\n<p>table 3 consists of IDs and other data that is irrelevant to this question. However, I need to be able to filter on <code>table_3_id</code>.</p>\n\n<p>This is what I need: \nTable 2 has multiple rows that have information of the rows in table_1. I need to have a query that checks if there are duplicates in the 'data' column, which have the same 'name'. The result I need would be this (with a WHERE table_3_id = 1):</p>\n\n<pre><code>+-table_3_id-+-name--+-value-+-duplicate-+\n|          1 | Name1 | Data1 | true      |\n|          1 | Name2 | Data2 | false     |\n|          1 | Name3 | Data3 | false     |\n+------------+-------+-------+-----------+\n</code></pre>\n\n<p>Or, if possible, only return the data from table_2 where it actually is a duplicate. The 'duplicate' field can be a count too, since I do know the amount of rows that have the same table_3_id.</p>\n\n<p>I hope I have made my question clear enough. If it is not clear enough I will try to improve it. I have tried it with joins and subqueries, but my knowledge of SQL isn't enough to make an advanced query like this. I'd prefer this in a single query instead of multiple in PHP.</p>\n"},{"tags":["mysql","sql","oracle","updatable-views"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13215119,"title":"How can I update a view with columns that is derived from case statement?","body":"<p>I created a view using this (neglected other columns):</p>\n\n<pre><code>create view view_table (is_root) as select\n  case when C1 = 'Yes' then 1\n       when C1 = 'No' then 0\n       else 0\n  end as is_root\n  from remote_db_table\n</code></pre>\n\n<p>But when I tried to update the view using:</p>\n\n<pre><code>update view_table set is_root=1\n</code></pre>\n\n<p>It does not work. Any way to do it? The view is in Oracle but the remote table is in mySQL</p>\n"},{"tags":["sql","performance","postgresql"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":112,"score":3,"question_id":12848711,"title":"CTE scan is far far slower than it should be","body":"<p>The following query is being run on about 4 million rows. The first two CTE statements execute in about an hour. The final one however is on track to last more than 15 years.</p>\n\n<pre><code>WITH parsed AS (\n   SELECT name, array(...) description FROM import\n), counts AS (\n   SELECT unnest(description) token, count(*) FROM parsed GROUP BY 1\n) \nINSERT INTO table (name, description) \nSELECT name, ARRAY(\n    SELECT ROW(token, count)::a \n    FROM (\n        SELECT token, (\n            SELECT count \n            FROM counts \n            WHERE a.token=counts.token\n            ) \n        FROM UNNEST(description) a(token)\n        ) _\n    )::a[] description \nFROM parsed;\n\n                                                                  QUERY PLAN                                                                   \n-----------------------------------------------------------------------------------------------------------------------------------------------\n Insert on table  (cost=55100824.40..162597717038.41 rows=3611956 width=96)\n   CTE parsed\n     -&gt;  Seq Scan on import  (cost=0.00..51425557.67 rows=3611956 width=787)\n           Filter: ((name IS NOT NULL) AND (description IS NOT NULL))\n           SubPlan 1\n             -&gt;  HashAggregate  (cost=11.59..12.60 rows=101 width=55)\n                   -&gt;  Append  (cost=0.00..11.34 rows=101 width=55)\n                         -&gt;  Result  (cost=0.00..0.01 rows=1 width=0)\n                         -&gt;  Index Scan using import_aliases_mid_idx on import_aliases  (cost=0.00..10.32 rows=100 width=56)\n                               Index Cond: (mid = \"substring\"(import.mid, 5))\n           SubPlan 2\n             -&gt;  HashAggregate  (cost=0.78..1.30 rows=100 width=0)\n                   -&gt;  Result  (cost=0.00..0.53 rows=100 width=0)\n   CTE counts\n     -&gt;  HashAggregate  (cost=3675165.23..3675266.73 rows=20000 width=32)\n           -&gt;  CTE Scan on parsed  (cost=0.00..1869187.23 rows=361195600 width=32)\n   -&gt;  CTE Scan on parsed  (cost=0.00..162542616214.01 rows=3611956 width=96)\n         SubPlan 6\n           -&gt;  Function Scan on unnest a  (cost=0.00..45001.25 rows=100 width=32)\n                 SubPlan 5\n                   -&gt;  CTE Scan on counts  (cost=0.00..450.00 rows=100 width=8)\n                         Filter: (a.token = token)\n</code></pre>\n\n<p>There are about 4 million rows in both <code>parsed</code> and <code>counts</code>. The query's currently running, and the final statement's inserting a row roughly every 2 minutes. It's barely touching disk, but eating CPU like crazy, and I'm confused.</p>\n\n<p>What's wrong with the query?</p>\n\n<p>The final statement's supposed to look up each element of <code>description</code> in <code>counts</code>, transforming something like this <code>[a,b,c]</code> to something like this <code>[(a,9),(b,4),(c,0)]</code> and inserting it.</p>\n\n<p><br/>\n<strong>Edit</strong></p>\n\n<p>With parsed and counts as tables, and <code>token</code> in counts indexed, this is the plan:</p>\n\n<pre><code>explain INSERT INTO table (name, mid, description) SELECT name, mid, ARRAY(SELECT ROW(token, count)::a FROM (SELECT token, (SELECT count FROM counts WHERE a.token=counts.token) FROM UNNEST(description) a(token)) _)::a[] description FROM parsed;\n                                              QUERY PLAN                                              \n------------------------------------------------------------------------------------------------------\n Insert on table  (cost=0.00..5761751808.75 rows=4002061 width=721)\n   -&gt;  Seq Scan on parsed  (cost=0.00..5761751808.75 rows=4002061 width=721)\n         SubPlan 2\n           -&gt;  Function Scan on unnest a  (cost=0.00..1439.59 rows=100 width=32)\n                 SubPlan 1\n                   -&gt;  Index Scan using counts_token_idx on counts  (cost=0.00..14.39 rows=1 width=4)\n                         Index Cond: (a.token = token)\n</code></pre>\n\n<p>Which is much more reasonable. The arrays have an average of 57 elements, so I guess it was just the sheer number of lookups against the presumable fairly inefficient CTE table that was killing performance. It's now going at 300 rows per second, which I'm happy with.</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13226450,"title":"Get latest updated records","body":"<p>I have an \"Observation\" table in SQL Server 2008. This table has a locationId column for a bunch of geographic locations, a few columns for observation details and a column for latest updated date.</p>\n\n<p>Every week, a new observation record for each location is appended. So a location has many occurrences in the table.</p>\n\n<p>What I want to achieve is to be able to get the most recent observation record for each location.</p>\n\n<p>Can anyone help with any idea?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Cheers,\nAlex</p>\n"},{"tags":["python","sql","database","ms-access","pyodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13227764,"title":"Receiving quantity and list of fields of the table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4539254/how-to-get-datatypes-of-specific-fields-of-an-access-database-using-pyodbc\">How to get datatypes of specific fields of an Access database using pyodbc?</a>  </p>\n</blockquote>\n\n\n\n<p>What sql request receives quantity of fields of the table Access in pyodbc connection with database? What sql request receives the list of fields of the table Access in pyodbc connection with database?</p>\n"},{"tags":["mysql","sql","select","variable-declaration","variable-initialization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13226745,"title":"What are the differences in the following variable initialization styles in MySQL?","body":"<p>I'm fairly new to queries which involve variable declaration in MySQL. I have seen various styles and I'm not fully clear of what these actually do. I've questions about what these actually do.</p>\n\n<p>1)</p>\n\n<pre><code>set @row:=0;\nSELECT name, @row:=@row + 1 AS rownum\nFROM animal\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>SELECT name, @row:=@row + 1 AS rownum\nFROM (SELECT @row:= 0) c, animal\n</code></pre>\n\n<p>Both returns the same:</p>\n\n<pre><code>  name rownum\n|| cat || 1 ||\n|| cat || 2 ||\n|| dog || 3 ||\n|| dog || 4 ||\n|| dog || 5 ||\n|| ant || 6 ||\n</code></pre>\n\n<p><strong>What are the differences in the above two queries and which of the two to adopt as to their scope, efficiency, coding habit, use-cases?</strong></p>\n\n<p>3) Now if I do this: </p>\n\n<pre><code>set @row:=0;\nSELECT name, @row:=@row + 1 AS rownum\nFROM (SELECT @row:= 123) c, animal\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>  name  rownum\n|| cat || 124 ||\n|| cat || 125 ||\n|| dog || 126 ||\n|| dog || 127 ||\n|| dog || 128 ||\n|| ant || 129 ||\n</code></pre>\n\n<p><strong>So doesn't that mean that the inner variable initialization is overriding the outer initialization and leaving the latter redundant hence (and hence its always a better practice to initialize in a <code>SELECT</code>?</strong></p>\n\n<p>4) If I merely do: </p>\n\n<pre><code>SELECT name, @row:=@row + 1 AS rownum\nFROM animal\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>   name  rownum\n|| cat || NULL ||\n|| cat || NULL ||\n|| dog || NULL ||\n|| dog || NULL ||\n|| dog || NULL ||\n|| ant || NULL ||\n</code></pre>\n\n<p>I can understand that since <code>row</code> isn't initialized. But if I run any of the other queries (may be variable <code>row</code> is getting initialized?) I see that <code>row</code> variable is incremented every time I run the above query. That is it gives me the result on first run:</p>\n\n<pre><code>  name rownum\n|| cat || 1 ||\n|| cat || 2 ||\n|| dog || 3 ||\n|| dog || 4 ||\n|| dog || 5 ||\n|| ant || 6 ||\n</code></pre>\n\n<p>and then when re-run it yields in </p>\n\n<pre><code>  name rownum\n|| cat || 7  ||\n|| cat || 8  ||\n|| dog || 9  ||\n|| dog || 10 ||\n|| dog || 11 ||\n|| ant || 12 ||\n</code></pre>\n\n<p><strong>So is <code>row</code> being stored somewhere? And what is its scope and lifespan?</strong></p>\n\n<p>5) If I have query like this: </p>\n\n<pre><code>SELECT (CASE WHEN @name &lt;&gt; name THEN @row:=1 ELSE @row:=@row + 1 END) AS rownum, \n       @name:=name AS name\nFROM animal\n</code></pre>\n\n<p>This always yields the right result:</p>\n\n<pre><code>rownum  name\n|| 1 || cat ||\n|| 2 || cat ||\n|| 1 || dog ||\n|| 2 || dog ||\n|| 3 || dog ||\n|| 1 || ant ||\n</code></pre>\n\n<p><strong>So doesn't that mean its not always necessary to initialize variable at the top or in a <code>SELECT</code> depending on the query?</strong></p>\n"},{"tags":["sql","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1378,"score":3,"question_id":4389930,"title":"Exporting data from SQLite 3","body":"<p>I need a simple way to export data from an SQLite database of multiple tables, then import them into another database.</p>\n\n<p>Here is my scenario.  I have 5 tables: A, B, C, D, E.</p>\n\n<p>Each table has a primary key as the first column called ID.  I want a Unix command that will dump ONLY the data in the row from the primary key in a format that can be imported into another database.  </p>\n\n<p>I know I can do a </p>\n\n<pre><code>sqlite3 db .dump | grep INSERT\n</code></pre>\n\n<p>but that gives me ALL data in the table.  I'm not a database expert, and I'm trying to do this with all unix commands in which I can write a shell script, rather than writing C++ code to do it (because that's what people are telling me that's the easiest way).  I just refuse to write C++ code to accomplish a task that possible can be done in 4-5 statements from the command line.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["mysql","sql","database-design","foreign-keys","composite-key"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13225813,"title":"composite foreign key referencing one or more columns","body":"<p>I have a table (tableA) that joins 3 other tables with primary keys 'vehicle','engine','transmission' I would like to be able to assign parts to one or more of these eg 'only this vehicle' or 'only this vehicle with this engine' or 'any vehicle with this engine'</p>\n\n<p>My plan is to have a parts table (tableB) with also primary keys 'vehicle','engine','transmission' and I'd like to be able to insert for example:</p>\n\n<ul>\n<li><code>4844, null, null</code> to assign a part to only 'vehicle' or </li>\n<li><code>4844, 240,  null</code> to assign a part to 'only this vehicle with this engine'.</li>\n</ul>\n\n<p>Is there some way I can enforce integrity at the database level so that. </p>\n\n<ol>\n<li>the fields that are filled in in tableB must reference fields in tableA.</li>\n<li>at least one of the fields must be filled in.</li>\n<li>the option exists not to insert data into them all?</li>\n</ol>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13226351,"title":"How to retrieve the column value based on formula","body":"<p>Using a view in SQL Server 2000</p>\n\n<p><code>Table1</code>:</p>\n\n<pre><code>id  z1      z2      z3      z4   type\n--------------------------------------\n01A 300     400     300     400  01\n2B  300     400     300     400  02\n3C  500     300     400     300  01\n04A 500     400     500     400  01\n05B 400     300     400     300  02\n06  150     200     200     150  03\n....\n</code></pre>\n\n<p><code>Table2</code>:</p>\n\n<pre><code>type  Formula1           Formula2\n------------------------------------    \n01    ((Z1+Z2)/1000)*2   null\n02    null               ((Z3+Z4)/1000)*2\n03    ((Z1+Z2)/1000)*2   ((Z3+Z4)/1000)*2\n</code></pre>\n\n<p>I want to select the <code>table1</code> rows based on <code>table2</code> formula:</p>\n\n<ul>\n<li>in table2 type - 01 (z1 and z2 found) then i want to consider table1 z1 z2 columns</li>\n<li>in table2 type - 02 (z3 and z4 found) then i want to consider table1 z3 z4 columns</li>\n<li>in table2 type - 03 (z1, z2, z3 and z4 found) then i want to consider table1 z1, z2, z3 z4 columns</li>\n</ul>\n\n<p>Expected output</p>\n\n<p><code>Table1</code>:</p>\n\n<pre><code>id   z1     z2     z3     z4    type\n-------------------------------------    \n01A  300    400    null   null  01\n2B   null   null   300    400   02\n3C   500    300    null   null  01\n04A  500    400    null   null  01\n05B  null   null   400    300   02\n06   150    200    200    150   03\n</code></pre>\n\n<p>Currently I'm using a view, I don't want to change to stored procedure because most of the report are using this view.  </p>\n\n<p>How to do it in sql..?</p>\n"},{"tags":["c#","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":70,"score":0,"question_id":13227796,"title":"sql like query issue","body":"<p>I am trying to fetch data , which has the description keyword at the start or in the middle or at the end.</p>\n\n<p>Following is my query </p>\n\n<pre><code>like '%\" + description + \"' or '\" + description + \"%' or '%\" + description + \"%'\n</code></pre>\n\n<p>Problem is it is returning irrelevant data.</p>\n\n<p>E.g if i have given 'as' in description then it also choses 'cake' in result.</p>\n\n<pre><code>Description\n------------------------------------------------------------\nasd\nasdasd\ncake\nNaw\nTast\nad\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13209331,"title":"How to split the row value","body":"<p>table1</p>\n\n<pre><code>value\n\n100 x 200 x 300 x 400  `I want to split this row bcoz more than 2 values`\n100 x 200\n1300 x 1400\n200 x 300 x 1200 x 2200  `I want to split this row bcoz more than 2 values`\n....\n</code></pre>\n\n<p>Value column is not fixed length, it may also contain <code>10 x 200 x 3000 x 5</code></p>\n\n<p>I want to take the first 2 values then the next 2 values will go to the next row after <code>x</code></p>\n\n<p>I want to split the rows like this:</p>\n\n<p>Expected Output</p>\n\n<pre><code>100 x 200 \n300 x 400\n100 x 200\n1300 x 1400\n200 x 300 \n1200 x 2200\n....\n</code></pre>\n\n<p><strong>Hint:</strong></p>\n\n<p>We can split the value for each x then we can join 2 values </p>\n\n<p>for example <code>20 x 10 x 5 x 1</code></p>\n\n<p>Split like this <code>20, 10 5, 1</code> then join <code>20 x 10, 5 x 1</code> </p>\n\n<p>The above method will work out, if it work out means then can i get some query for splitting and joining the rows..</p>\n\n<p>How can I do this in SQL?</p>\n\n<p>Need SQL Query Help</p>\n"},{"tags":["php","mysql","sql","pdo"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":55,"score":1,"question_id":13223483,"title":"php - Invalid parameter number: parameter was not defined","body":"<p>i have some problems with executing a simple INSERT request.\nAs said in the title, i have this message \"Invalid parameter number: parameter was not defined\". the first value is an id (primary with auto increment)</p>\n\n<pre><code>$req = $pdo-&gt;prepare('INSERT INTO championnat_classement \n                        VALUES (\n                        \"\",\n                        :Equipe,\n                        :Championnat,\n                        :Saison,\n                        :Journee,\n                        :Points,\n                        :NbMatch,\n                        :Position,\n                        :Victoire,\n                        :Nul,\n                        :Defaite,\n                        :MatchJoueDomicile,\n                        :PointsDomicile,\n                        :VictoireDomicile,\n                        :NulDomicile,\n                        :DefaiteDomicile,\n                        :ButPourDomicile,\n                        :ButContreDomicile,\n                        :MatchJoueExterieur,\n                        :PointsExterieur,\n                        :VictoireExterieur,\n                        :NulExterieur,\n                        :DefaiteExterieur,\n                        :ButPourExterieur,\n                        :ButContreExterieur     \n                        )');\nif ($req-&gt;execute(array(\n                        \"Equipe\" =&gt; $this-&gt;idEquipe1,\n                        \"Championnat\" =&gt; $this-&gt;idChamp,\n                        \"Saison\" =&gt; $this-&gt;saison,\n                        \"Journee\" =&gt; $this-&gt;journee,\n                        \"Points\" =&gt; $this-&gt;pointsTotaux,\n                        \"NbMatch\" =&gt; $this-&gt;matchJouesTotal,\n                        \"Position\" =&gt; $this-&gt;position,\n                        \"Victoire\" =&gt; $this-&gt;matchGagneeTotal,\n                        \"Nul\" =&gt; $this-&gt;matchNulTotal,\n                        \"Defaite\" =&gt; $this-&gt;matchPerduTotal,\n                        \"MatchJoueDomicile\" =&gt; $this-&gt;matchJouesDomicile,\n                        \"PointsDomicile\" =&gt; $this-&gt;pointsDomicile,\n                        \"VictoireDomicile \" =&gt; $this-&gt;matchJouesDomicile,\n                        \"NulDomicile\" =&gt; $this-&gt;matchNulDomicile,\n                        \"DefaiteDomicile\" =&gt; $this-&gt;matchPerduDomicile,\n                        \"ButPourDomicile\" =&gt; $this-&gt;butMarquesDomicile,\n                        \"ButContreDomicile\" =&gt; $this-&gt;butEncaissesDomicile,\n                        \"MatchJoueExterieur\" =&gt; $this-&gt;matchJouesExterieur,\n                        \"PointsExterieur\" =&gt; $this-&gt;pointsExterieur,\n                        \"VictoireExterieur\" =&gt; $this-&gt;matchGagneeExterieur,\n                        \"NulExterieur\" =&gt; $this-&gt;matchNulExterieur,\n                        \"DefaiteExterieur\" =&gt; $this-&gt;matchPerduExterieur,\n                        \"ButPourExterieur\" =&gt; $this-&gt;butMarquesExterieur,\n                        \"ButContreExterieur\" =&gt; $this-&gt;butEncaissesExterieur\n                    ))) {\n                return \"ok\";\n            }\n</code></pre>\n\n<p>How to solve this?</p>\n"},{"tags":["mysql","sql","relational"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13226777,"title":"Complex query taking too long to run","body":"<p>I have a query (<a href=\"http://stackoverflow.com/questions/11336651/adding-a-sub-query-to-an-already-giant-query\">original question that has table structure too</a>) that is perfect, but it creates a temporary table which unfortunately takes like 12 seconds due to amount of data.  (1 table has 95k records, another 155k, and another 21k).</p>\n\n<p>Is there any way to go around the temporary table solution or make it run faster?  Maybe suggest which fields should be indexed?  I have ID fields, date fields, etc... indexed, but that's not helping at all.</p>\n\n<pre><code>SELECT\n    (\n        CASE\n            WHEN a.winner = a.f_a THEN \"Win\"\n            WHEN a.winner = a.f_b THEN \"Loss\"\n            WHEN a.winner IS NULL THEN a.method\n        END\n    ) AS result,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.winner &lt;=&gt; a.f_a) AS fighter_wincount,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.winner IS NOT NULL AND d.winner &lt;&gt; a.f_a) AS fighter_losscount,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.method = \"Draw\") AS fighter_drawcount,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.method = \"No Contest\") AS fighter_nocontestcount,\n    b.name AS opponent,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.winner &lt;=&gt; a.f_b) AS opponent_wincount,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.winner IS NOT NULL AND d.winner &lt;&gt; a.f_b) AS opponent_losscount,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.method = \"Draw\") AS opponent_drawcount,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.method = \"No Contest\") AS opponent_nocontestcount,\n    b.fighter_id AS opponent_id,\n    b.fighting_out_of_country AS opponent_country,\n    a.method AS method,\n    a.method_type AS method_type,\n    a.round AS round,\n    a.time AS time,\n    c.event_id AS event_id,\n    c.event_name AS event,\n    c.event_date AS date,\n    c.event_city AS event_city,\n    c.event_state AS event_state,\n    c.event_country AS event_country\nFROM\n    (\n        SELECT \n            fight_id,\n            IF(fighter_b = :fighter_id_3, fighter_b, fighter_a) AS f_a,\n            IF(fighter_b = :fighter_id_4, fighter_a, fighter_b) AS f_b,\n            winner,\n            method,\n            method_type,\n            round,\n            time,\n            event\n        FROM \n            fights\n        WHERE\n            :fighter_id_5 IN (fighter_a, fighter_b)\n    ) a\nINNER JOIN\n    fighters b ON a.f_b = b.fighter_id\nINNER JOIN\n    events c ON a.event = c.event_id\nLEFT JOIN\n    (\n        SELECT \n            a.fighter_a,\n            a.fighter_b,\n            a.winner,\n            a.method,\n            b.event_date\n        FROM\n            fights a\n        INNER JOIN\n            events b ON a.event = b.event_id\n    ) d ON \n        (a.f_a IN (d.fighter_a, d.fighter_b) OR a.f_b IN (d.fighter_a, d.fighter_b)) AND\n        d.event_date &lt;= c.event_date\nGROUP BY\n    a.fight_id\nORDER BY\n    date DESC\n</code></pre>\n"},{"tags":["sql","oracle","alias","decode","ora-00904"],"answer_count":3,"favorite_count":4,"up_vote_count":14,"down_vote_count":0,"view_count":12033,"score":14,"question_id":356675,"title":"Using an Alias in a WHERE clause","body":"<p>I have a query which is meant to show me any rows in table A which have not been updated recently enough. (Each row should be updated within 2 months after \"month_no\".):</p>\n\n<pre><code>SELECT A.identifier\n     , A.name\n     , TO_NUMBER(DECODE( A.month_no\n             , 1, 200803 \n             , 2, 200804 \n             , 3, 200805 \n             , 4, 200806 \n             , 5, 200807 \n             , 6, 200808 \n             , 7, 200809 \n             , 8, 200810 \n             , 9, 200811 \n             , 10, 200812 \n             , 11, 200701 \n             , 12, 200702\n             , NULL)) as MONTH_NO\n     , TO_NUMBER(TO_CHAR(B.last_update_date, 'YYYYMM')) as UPD_DATE\n  FROM table_a A\n     , table_b B\n WHERE A.identifier = B.identifier\n   AND MONTH_NO &gt; UPD_DATE\n</code></pre>\n\n<p>The last line in the WHERE clause causes an \"ORA-00904 Invalid Identifier\" error. Needless to say, I don't want to repeat the entire DECODE function in my WHERE clause. Any thoughts? (Both fixes and workarounds accepted...)</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13227030,"title":"Finding first matched string in a column in SQL Server","body":"<p>I have a table as follows:</p>\n\n<pre><code>TABLE1\n\nNo  Description\n1   Hello Hai Hello\n2   Good Bad Good\n3   Hello Good Hai\n4   Hai Hello Bad\n5   Hello Hello Hello\n</code></pre>\n\n<p>Now if I run the following query:</p>\n\n<pre><code>Select * \nfrom TABLE1 \nwhere Description like '%Hai%' \n   OR  Description like '%Hello%' \n   OR Description like '%Good%'\n</code></pre>\n\n<p>I want the result as follows ( By adding one extra column \"FIRST MATCHED WORD\"):</p>\n\n<pre><code>No  Description     First Matched Word\n1   Hello Hai Hello     Hai\n2   Good Bad Good       Good\n3   Hello Good Hai      Hai\n4   Hai Hello Bad       Hai\n5   Hello Hello Hello   Hello\n</code></pre>\n\n<p>Hear my intention is to find out the first matched word depends on our query. Kindly help me.</p>\n"},{"tags":["java","sql","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":77,"score":3,"question_id":13226613,"title":"MS Access ODBC: Syntax error .. LIKE 'thomas%'","body":"<p>I am working on a mini application and I have to retrieve and save USER_ID in a table.</p>\n\n<p>It works like this; I input the email address of the user and then the statement has to retrieve USER_ID and save it into a table.</p>\n\n<p>I am having problem with my SQL Like statement.  Its just that I have to insert only the first part of the email address.  For example, \"thomas@yahoo.com\".  I insert only \"thomas\"; not remaining part.</p>\n\n<p>Here are sample of the statement and resulting message I am getting in my Java console:</p>\n\n<p><strong>Code:</strong> </p>\n\n<pre><code>String ea = txt_email.getText();\nString lid = \"SELECT USER_ID FROM user WHERE email_address Like  '\"+ea+\"%' \";\n</code></pre>\n\n<p><strong>Error Message:</strong></p>\n\n<blockquote>\n  <p>Error: java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Syntax error (missing operator) in query expression ''SELECT USER_ID FROM user WHERE email_address Like  'thomas%' ''.         </p>\n</blockquote>\n"},{"tags":["sql","plsql","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13225050,"title":"comparing cursor values for equality in plsql","body":"<pre><code>declare\n  course_id char(10);\n  course_idA char(10);\n\ncursor task3 \n  is\n      select c_id from certificationrequirement\n      where pcp_id = 101;\n\ncursor task3A\n  is \n      select o.c_id from courseoffering o\n      join co_enrolment ce\n      on o.co_id = ce.co_id\n      where ce.s_regno = 401 and ce.coe_completionstatus = 'P';\n\nBegin\n  open task3;\n\n    DBMS_OUTPUT.PUT_LINE ( 'List of Course to take ');\n    loop\n\n      FETCH task3 into course_id;\n      exit when task3%NOTFOUND;\n\n      DBMS_OUTPUT.PUT_LINE ( course_id);\n\n    end loop;\n  close task3;\n\n  open task3A;\n\n    DBMS_OUTPUT.PUT_LINE ( 'List of Courses student has passed ');\n\n    loop\n\n      FETCH task3A into course_idA;\n      exit when task3A%NOTFOUND;\n\n      DBMS_OUTPUT.PUT_LINE (course_idA);\n\n    end loop;\n  close task3A;\n\n  if (cursor task3 = cursor task3A )\n  Then\n    DBMS_OUTPUT.PUT_LINE ( 'Student can attempt the Certification exam ');\n  Else\n    DBMS_OUTPUT.PUT_LINE ( 'Student cannot attempt the Certification exam ');\n  END if;\nend;\n</code></pre>\n\n<p>I'm using one cursor to list all courses student need to take for particular degree.\nSecond cursor to list how many courses student have passed for degree he is studying.\nIf both values in both the cursor are equal he would be eligible to take exit exam otherwise he won't be able to. I have written down the comparing code but I think above is not the correct way to do it.</p>\n"},{"tags":["mysql","sql","perl","query","dbi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":13172755,"title":"Replace quotation marks in sql query in perl script","body":"<p>I have a text file of data that I am importing into a MySQL database. Some of the lines unfortunatley contain quotation marks, which causes my SQL queries to go haywire. I would like to get rid of any field that has quotation marks, or at very least ignore them in my query.</p>\n\n<p>I found something that might work, but being as this is run through a Perl script I am having issues \"escaping\" the quotation marks. I really don't know how and can't figure it out. I would like to just search through my table and delete any quotation marks (\") that it may find or replace it with a single quotation mark or space or anything really.</p>\n\n<pre><code>my $myreplacequery = \"REPLACE(s.Title, '\"','')\";\n$sth = $dbh-&gt;prepare($myreplacequery);\n$sth-&gt;execute;\n</code></pre>\n\n<p>Anyone have any ideas?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13226399,"title":"How can I write a query that returns \"between\" to return alphabetic data, not just numeric?","body":"<p>I have a <code>Daily_account</code> table:</p>\n\n<pre><code>customer_id    account_id            current_balance\n\n1                 D1                       200\n2                 d2                       300\n3                 d10                      400\n4                 d100                     500\n5                 d101                     600\n</code></pre>\n\n<p>Now I have a query: </p>\n\n<pre><code>select customer_id,account_id,current_balance\nfrom daily_account\nwhere account_id between 'D1' and'D100'\n</code></pre>\n\n<p>It is giving me output of account no of D1,D10,D100, but I want to get output of every no.\nHow to get output of every account which comes between D1 and d100?  </p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":13226890,"title":"Can't drop temp table SQL","body":"<p>Hi Im creating a Temp table and inserting data to the Table. Im going to use the Temp table to Join it to the specific User. </p>\n\n<pre><code>CREATE TABLE #MyTempTable\n(\n    UsersId int,\n    ValautionCount int \n)\n\n    SELECT\n        U.UserId, \n        COUNT(*) AS ValautionCount\n    INTO  #MyTempTable\n    FROM \n        Users U\n        Right JOIN Valuation V ON V.ValuationUser = U.UserId\n    GROUP BY \n        U.UserId\n\n\n\nDROP TABLE #MyTempTable\n</code></pre>\n\n<p>When I run this query I get this error : There is already an object named '#Temp' in the database.</p>\n\n<p>But when I run this query <code>DROP TABLE #MyTempTable</code> I get this error: Cannot drop the table '#Temp', because it does not exist or you do not have permission.\nIm using SQL 2012</p>\n"},{"tags":["php","sql","user","limit"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13226335,"title":"Limit number of profiles a free user can view?","body":"<p>Is there a way that will allow me to limit the amount of profiles a user can look at on my site per day. so for instance each user has an id 1, 2, 3 etc. and if the one user views 5 profiles all together in one day then it stops them viewing any more and redirects them to a sign up page to become a paid member where they can view unlimited profiles?</p>\n\n<p>I'm quite new to php and sql but this is primarily what i am working in if there's a way to do it in that.</p>\n\n<p>Thanks</p>\n"},{"tags":["php","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13226866,"title":"insert apostrophe in sql text table?","body":"<p>I have an sql insert script that updates the sql table in the database when a user types text in a text area, but if a user uses an apostrophe in their text this will not insert the information into the table. this is because sql reads the apostrophe as a closing statement or whatever. but is there a way to use a statement that will allow users to put apostrophes in, i.e. tell sql to use '%s%' or whatever to represent an apostrophe?</p>\n\n<p>Heres the sql update code I'm using:</p>\n\n<pre><code>   &lt;?php \n\nsession_start();\n\ninclude '_config/connection.php'; \n\n$status = $_POST['status'];\n\n$result = mysql_query(\"SELECT status FROM ptb_profiles WHERE id=\".$_SESSION['user_id'].\"\");\n\n\n\n\n\nif(!$result) \n{ \necho \"The username you entered does not exist\"; \n} \nelse \nif($status!= mysql_result($result, 0)) \n{ \necho \"\"; \n\n\n    $sql=mysql_query(\"UPDATE ptb_profiles SET status ='$status' WHERE id=\".$_SESSION['user_id'].\"\"); \n}\n    if($sql) \n    { \n\n\n}\nheader('Location: http://localhost/ptb1/profile.php?id=' . $_SESSION['user_id'] );\n?&gt;\n</code></pre>\n"},{"tags":["sql","database-design","calendar","relational-database","database-schema"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":40,"score":4,"question_id":13220386,"title":"Table structure for Scheduling App in SQL DB","body":"<p>I'm working on a database to hold information for an on-call schedule.  Currently I have a structure that looks about like this:</p>\n\n<pre><code>Table - Person: (key)ID, LName, FName, Phone, Email\nTable - PersonTeam: (from Person)ID, (from Team)ID\nTable - Team: (key)ID, TeamName\nTable - Calendar: (key dateTime)dt, year, month, day, etc...\nTable - Schedule: (from Calendar)dt, (id of Person)OnCall_NY, (id of Person)OnCall_MA, (id of Person)OnCall_CA\n</code></pre>\n\n<p>My question is: With the <strong>Schedule</strong> table, should I <em>leave it</em> structured as is, where the dt is a unique key, or should I <em>rearrange it</em> so that dt is non-unique and the table looks like this:</p>\n\n<pre><code>Table - Schedule: (from Calendar)dt, (from Team)ID, (from Person)ID\n</code></pre>\n\n<p>and have multiple entries for each day, <strong>OR</strong> would it make sense to just use:</p>\n\n<pre><code>Table - Schedule: (from Calendar)dt, (from PersonTeam)KeyID - [make a key ID on each of the person/team pairings]\n</code></pre>\n\n<p>A team will always have someone on call, but a person can be on call for more than one team at a time (if they are on multiple teams).</p>\n\n<p>If a completely different setup would work better let me know too!</p>\n\n<p>Thanks for any help! I apologize if my question is unclear.  I'm learning fast but nevertheless still fairly new to using SQL daily, so I want to make sure I'm using best practices when I learn so I don't develop bad habits. </p>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13226657,"title":"Insert text in each row of mysql field","body":"<p>I have a table with this structure :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | img.jpg\n2  | otherimg.png\n3  | img2.png \n4  | someimg.gif\n5  | otherelseimg.jpg\n6  | dummy.jpg\n7  | jusimg.jpg\n</code></pre>\n\n<p>How can I modified each row to become like this :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | folder/img.jpg\n2  | folder/otherimg.png\n3  | folder/img2.png \n4  | folder/someimg.gif\n5  | folder/otherelseimg.jpg\n6  | folder/dummy.jpg\n7  | folder/jusimg.jpg\n</code></pre>\n"},{"tags":["mysql","sql","phpmyadmin"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13226520,"title":"Selecting MYSQL column conditionally","body":"<p>Example schema for my question is given at <a href=\"http://sqlfiddle.com/#!2/bbe5b\" rel=\"nofollow\">SQLFiddle</a> and as follow:</p>\n\n<pre><code>CREATE TABLE `players` (\n  `player1id` int(11) NOT NULL,\n  `player2id` int(11) NOT NULL,\n  PRIMARY KEY (`player1id`,`player2id`)\n) ENGINE=InnoDB;\n\nINSERT INTO `players` values\n(1,5),\n(1,7),\n(5,3),\n(5,4),\n(2,1);\n</code></pre>\n\n<p>In a online game, I want to select opponent, which could be in player <code>player1id</code> or <code>player2id</code>.</p>\n\n<p>Example Input/ output needed</p>\n\n<pre><code>Input 1: Output 5, 7, 2\nInput 5: Output 1, 3 ,4\n&amp; so on.\n</code></pre>\n\n<p>That is, required data could be in any column but I need output in single column conditionally or any other way. I heard about MySQL conditional column but could not create query to get required output. Can someone please help with required query.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Based on <a href=\"http://forums.mysql.com/read.php?10,6639,6677#msg-6677\" rel=\"nofollow\">this link</a>, I run following query but failed.</p>\n\n<pre><code>SELECT IF(PLAYER1ID IS 1,PLAYER2ID as opponent,PLAYER1ID as opponent) \nFROM players\nWHERE PLAYER1ID = 1 OR PLAYER2ID = 1;\n</code></pre>\n"},{"tags":["sql","oracle","greatest-n-per-group","correlated-subquery"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":13223035,"title":"how do I get the oldest date without using a correlated subquery sql","body":"<p>The following code list all the invoices, and I just want the oldest invoice from a vendor:</p>\n\n<pre><code>SELECT DISTINCT vendor_name, i.invoice_number AS OLDEST_INVOICE, \n    MIN(i.invoice_date), i.invoice_total\nFROM vendors v\nJOIN invoices i\nON i.vendor_id = v.vendor_id\nGROUP BY vendor_name, invoice_number, invoice_total\nORDER BY MIN(i.invoice_date);\n</code></pre>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13226529,"title":"sql query error - logical or syntax","body":"<p>At the moment I am running an update query which is working, however it allows null values to be inserted which I don't want.</p>\n\n<pre><code>mysql_query('UPDATE community_table SET \nage = \"'.$age.'\", \ngender = \"'.$gender.'\", \npregnant = \"'.$pregnant.'\", \ndiet = \"'.$diet.'\",\nsmoker = \"'.$smoker.'\",\nalcohol = \"'.$alcohol.'\",\nexercise = \"'.$exercise.'\",\nbmi = \"'.$bmi.'\",\nsleeping = \"'.$sleeping.'\",\nstress = \"'.$stress.'\", \neducation = \"'.$education.'\"\nWHERE username = \"' . $_SESSION['user'] . '\" ');\n</code></pre>\n\n<p>I tried this query which seems to prevent null values being entered, however it also prevents values being entered when the variables are not null.</p>\n\n<pre><code>age = \"'.$age.'\", \ngender = \"'.$gender.'\", \npregnant = \"'.$pregnant.'\", \ndiet = \"'.$diet.'\",\nsmoker = \"'.$smoker.'\",\nalcohol = \"'.$alcohol.'\",\nexercise = \"'.$exercise.'\",\nbmi = \"'.$bmi.'\",\nsleeping = \"'.$sleeping.'\",\nstress = \"'.$stress.'\", \neducation = \"'.$education.'\"\n\nWHERE age IS NOT NULL,\ngender     IS NOT NULL,\npregnant   IS NOT NULL,\ndiet       IS NOT NULL,\nsmoker     IS NOT NULL, \nalcohol    IS NOT NULL,\nexercise   IS NOT NULL,\nbmi        IS NOT NULL,\nsleeping   IS NOT NULL,\nstress     IS NOT NULL,\neducation  IS NOT NULL and where\nusername = \"' . $_SESSION['user'] . '\" ');\n</code></pre>\n\n<p>Is there something wrong with the above query, or do I perhaps have a null value in my input?</p>\n\n<p>Thanks. </p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13225619,"title":"Error when using modify and insert on XML data retreived from table: Must be single node","body":"<p>I am attempting to insert into some xml I am retreiving from a column in a table. I retrieve it as follows:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nDECLARE @profile_id int\nSET @profile_id = 16\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE\nprofiles.value('(Profile/ID)[1]','int')= @profile_id)\n</code></pre>\n\n<p>The resulting xml looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;16&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;test&lt;/Name&gt;\n    &lt;Activities /&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>However when I try and insert an element into it like this:</p>\n\n<pre><code>SET @devices_xml.modify('insert &lt;Activity&gt;&lt;Name&gt;testname&lt;/Name&gt;&lt;/Activity&gt;\n as first into (Profiles/User/Activities[1])')\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>XQuery [modify()]: The target of 'insert' must be a single node, found 'element(Activities,xdt:untyped) *'\n</code></pre>\n\n<p>I don't understand why there is an error, as there is only one Activities element currently. Thanks in advance.</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13226336,"title":"Use varchar stored procedure parameter in If condition of xquery insert","body":"<p>Is it possible to use a nvarchar type sproc variable in an xquery insert statement within the stored procedure?\nWhat I mean is something like this, in which an element is inserted only if a child element with the sought for value is present:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nDECLARE @profile_id int\nDECLARE @user_id nvarchar(50)\nSET @profile_id = 20\nSET @user_id ='BC4A18CA-AFB5-4268-BDA9-C990DAFE7783'\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE profiles.value('(Profile/ID)[1]','int')= @profile_id)\nSET @profiles_xml.modify('\ninsert\nif(/Profile/User/ID=\"user_id\")\nthen &lt;Activity&gt;activity_name5&lt;/Activity&gt;\nelse()\nas first\ninto (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>The xml which @profiles_xml contains looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;20&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;somename&lt;/Name&gt;\n    &lt;Activities&gt;\n      &lt;Activity&gt;activity_name2&lt;/Activity&gt;\n    &lt;/Activities&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n"},{"tags":["sql"],"answer_count":9,"favorite_count":2,"up_vote_count":21,"down_vote_count":0,"view_count":18101,"score":21,"question_id":46385,"title":"Delete all but top n from database table in SQL","body":"<p>What's the best way to delete all rows from a table in sql but to keep n number of rows on the top?  </p>\n"},{"tags":[".net","sql","sql-server","sql-server-2005"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3461,"score":0,"question_id":4941489,"title":"Query vs Stored procedure; difference between two approaches","body":"<p>I am developing a web page for search. I have two options to build this page</p>\n\n<ol>\n<li><p>To build the query on page according to parameter enter by the user and send it to server.</p></li>\n<li><p>To send parameters to stored procedure and build query there and get it executed.</p></li>\n</ol>\n\n<p>I want to know that which approach I should adopt and why. </p>\n\n<p>I want to know the advantages or disadvantages of both approaches. </p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13226070,"title":"SQL select all the orders for employees with minimum sales","body":"<p>I'm attempting to select all the employees with minimum sales from the following database schema:</p>\n\n<blockquote>\n  <p>Employees(eno, ename, zip, hdate)</p>\n  \n  <p>Parts(pno, pname, qoh, price, level)</p>\n  \n  <p>Customers(cno, cname, street, zip, phone)</p>\n  \n  <p>Orders(ono, cno, eno, received, shipped)</p>\n  \n  <p>Odetails(ono, pno, qty)</p>\n  \n  <p>Zipcodes(zip, city)</p>\n</blockquote>\n\n<p>I can't get the query I was working on to work for total sales per employee without an error.  My problem is getting the quantity * price per order related to the employee.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13225824,"title":"How to generate random codes, and run an sql multiple times","body":"<p>I have a query I need to run and I have 2 problems. </p>\n\n<p>first here is my query:</p>\n\n<pre><code>INSERT INTO  `anzie_oscommerce`.`discount_codes` (\n`discount_codes_id` ,\n`discount_description` ,\n`products_id` ,\n`categories_id` ,\n`manufacturers_id` ,\n`excluded_products_id` ,\n`customers_id` ,\n`orders_total` ,\n`order_info` ,\n`exclude_specials` ,\n`discount_codes` ,\n`discount_values` ,\n`minimum_order_amount` ,\n`expires_date` ,\n`number_of_orders` ,\n`number_of_use` ,\n`number_of_products` ,\n`status`\n)\nVALUES (\n'' ,  'GALA 2012', '' , '' , '' , '' , '' ,  '2',  '1',  '0',  substr(md5(uniqid(rand(), true)), 0, 8),  250,  '0.0000',  '2013-22-06',  '0',  '1',  '0',  '1'\n);\n</code></pre>\n\n<p>The first problem is I need to generate the random code which I am trying to do with the uniqid function I took from php but I know that is not possible. Is there a way to do something similar in sql?</p>\n\n<p>The second problem is I need to run this 250 times to generate 250 different discount codes. Is there a quick way to run an sql multiple times?</p>\n"},{"tags":["sql","postgresql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13223985,"title":"Using sub-queries and joins","body":"<p>I have got the following statement:</p>\n\n<blockquote>\n  <p>List of names and addresses from the customers who made purchases in 1997.</p>\n</blockquote>\n\n<p>So I thought the two following ways were correct but they aren't; why?</p>\n\n<pre><code>select contactname, address from customers\n       inner join orders\n       on customers.customerid = orders.customerid\n       where date_part('year', orderdate) = 1997\n       order by contactname\n\nselect contactname, address from customers\n       where customerid in\n             (select customerid from orders \n              where date_part('year', orderdate) = 1997)\n       order by contactname\n</code></pre>\n"},{"tags":["sql","sql-server-2008-r2","sql-management-studio"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13129678,"title":"Fast way to build database alteration queries in SQL server","body":"<p>(sorry - the question wasn't originally clear.  I'm not looking for the fastest ways to build insert, delete statements etc, but the fastest way to build queries to alter, for example, tables in the database e.g. adding or removing a column)</p>\n\n<p>So, what's the fastest and best way to build database alteration queries in SQL server?  I'm going down the manual route of writing the SQL as it's given me the best result in the past with the IBM Informix database.  Points to note:</p>\n\n<ul>\n<li>I've found that using the table designer in management studio is a poor method (in my experience this is too simplistic and GUI driven to be of use, and often requires tables to be completely rebuilt to work well)</li>\n<li>The query designer only allows simple select, update delete etc. queries to be built</li>\n<li>Any recommended tools that make this easier?</li>\n<li>Am I missing something about the SQL management studio that I should know?  Seems to create overly complex SQL for building a table, that's difficult to comprehend and edit</li>\n</ul>\n"},{"tags":["sql","shell","sqlplus","ksh"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13224945,"title":"to pass an numeric value to sqlplus","body":"<p>i want to pass a ksh shell variable as an integer to sqlplus or convert the variable to number before using it .This is the code i have written (not working):</p>\n\n<pre><code>echo\necho \"Enter the day of run (1,2,3,..,N ) :\" | tee -a $sqllog\nread day\n\ntypeset -i first_range\n\nif [ $day -eq 1 ]; then\nfirst_range=5000\nelif [[ $day -eq 2 ]]; then\nfirst_range=105000\nelif [[ $day -eq 3 ]]; then\nfirst_range=205000\nelif [[ $day -eq 4 ]]; then\nfirst_range=305000\nelif [[ $day -eq 5 ]]; then\nfirst_range=405000\nelif [[ $day -eq 6 ]]; then\nfirst_range=505000\nelif [[ $day -eq 7 ]]; then\nfirst_range=605000\nfi\n\necho \"first_range value : ${first_range}\" | tee -a $sqllog\n{\nsqlplus -S ${SF_PSTN_CONN_STRING} &lt;&lt; EOF\n\nalter session enable parallel DML;\n--alter session set  db_file_multiblock_read_count=128;\nalter session enable parallel query;\n\nset heading off\nset verify off\nset echo off\nset pages 0\nset timi on\nset lines 300\nset trimspool on\n\n# Drop table TMP_DAILY_PSTN_CMP_11035\n\ndrop table TMP_DAILY_PSTN_CMP_11035;\n\n\n# Create TMP Table TMP_DAILY_PSTN_CMP_11035 from TMP_OA_PSTN_CMP_11035\n\nCreate table TMP_DAILY_PSTN_CMP_11035 (\n        ACTION_OBJID NUMBER,\n        CONTRACT_OBJID NUMBER,\n        STATUS varchar2(40),\n        UPDATE_DATE DATE\n)\npartition by range(ACTION_OBJID)(\npartition p1 values less than (${first_range})) NOLOGGING parallel;\n\nprompt the day of run is $day;\n\nbegin\n        for k in 2..200\n        loop\n                execute immediate\n                        'alter table TMP_DAILY_PSTN_CMP_11035 add partition p'||k||' values less than ('||${first_range}+(k*5000)||')';\n        end loop;\nend;\n/\n</code></pre>\n\n<p>The error i am getting for it is:</p>\n\n<pre><code>Enter the day of run (1,2,3,..,N ) :\n2\nfirst_range value : 105000\n\nSession altered.\n\n\nSession altered.\n\n\nTable dropped.\n\nElapsed: 00:00:00.03\n\nTable created.\n\nElapsed: 00:00:00.02\nthe day of run is 2\nbegin\n*\nERROR at line 1:\nORA-06502: PL/SQL: numeric or value error: character to number conversion error\nORA-06512: at line 4\n</code></pre>\n\n<p>how do i solve this problem,ie to convert the char to number,even <code>typeset -i</code> does not seem to be working.passing a variable to sqlplus is easy and many question refer to it but i specifically want to pass an integer value and use it</p>\n\n<p>EDIT:\ni am using oracle 10g db.</p>\n"},{"tags":["sql","sql-server-2008","ssis","ssis-data-transformations","collate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13180214,"title":"How can I convert \"SQL_Latin1_ General\" Collate Using an SSIS Package?","body":"<p>We've just noticed 2 of our servers have been set up using <strong>SQL_Latin1_General_CP1_CI_AS</strong> and <strong>Latin1_General_CI_AS</strong>. </p>\n\n<p>I've created a script which compares two sources of data again each other (as it's a simple SELECT statement I haven't included it, it uses the same columns but from different sources) when I tried to union them together I received the collate error.</p>\n\n<blockquote>\n  <p>Msg 468, Level 16, State 9, Line 2\n      Cannot resolve the collation conflict between \n      \"<strong>SQL_Latin1_General_CP1_CI_AS</strong>\" and \"<strong>Latin1_General_CI_AS</strong>\" in the UNION operation.</p>\n</blockquote>\n\n<p>One of the sources is a table which is being populated by an <strong>SSIS</strong> package, is there a way of adapting the SSIS project to convert the \"SQL_Latin1_General_CP1_CI_AS\" format to \"Latin1_General_CI_AS\" before it's sent to the destination table?</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","pdo","dynamic-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13225448,"title":"SQLSTATE[HY000]: General error","body":"<p>I have a mysql dynamic-sql statement and I want to run it using pdo, and I get the following error message:</p>\n\n<blockquote>\n  <p>Warning: PDOStatement::fetchAll() [pdostatement.fetchall]:\n  SQLSTATE[HY000]: General error in C:\\xampp\\htdocs\\tags\\cobasql.php on\n  line 29</p>\n</blockquote>\n\n<p>Here's my php code:</p>\n\n<pre><code>&lt;?php \n   $uname = 'root'; //nama username database \n   $pwd = ''; //Password database \n   $dbname = 'eav_latihan'; //nama Database \n\n   /* Initialisasi database */ \n   $db = new PDO('mysql:host=localhost;dbname='.$dbname, $uname, $pwd); \n   $db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING); \n\n\n   $query = \"SET @sql = NULL; \". \n            \" SELECT GROUP_CONCAT(DISTINCT CONCAT('MAX(IF(a.Name = ''', \". \n            \" a.Name, ''', ca.value, NULL)) AS ', a.Name )) INTO @sql \". \n            \" FROM cust_attribute ca \". \n            \" INNER JOIN attribute a ON ca.idAttribute = a.idAttribute \". \n            \" INNER JOIN customer c ON c.idCustomer = ca.idCustomer \". \n            \" WHERE a.publish = 'Y'; \". \n            \" SET @sql = CONCAT('SELECT c.idCustomer, c.namaCustomer, ' \". \n            \" ' c.email, c.noTelp, ', @sql, ' FROM cust_attribute ca', \". \n            \" ' INNER JOIN attribute a ON ca.idAttribute = a.idAttribute', \". \n            \" ' INNER JOIN customer c ON c.idCustomer = ca.idCustomer', \". \n            \" ' GROUP BY c.idCustomer'); \". \n            \" SELECT @sql; \". \n            \" prepare stmt FROM @sql; \". \n            \" execute stmt;\"; \n\n   $result_array = array();\n   $queryku = $db-&gt;query($query);\n   $result_array = $queryku-&gt;fetchAll(PDO::FETCH_OBJ);\n   echo $result_array;\n?&gt;\n</code></pre>\n\n<p>Anyone here can help me or give me a suggest please??</p>\n"},{"tags":["php","sql","redirect"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13225690,"title":"Redirect to page only once?","body":"<p>I have this piece of php code that looks up the account prompt function on my website. basically if a user has violated a term and condition on the site, at login they are redirected to a prompt page that says you are very naughty and here's a warning.</p>\n\n<p>My code is this:</p>\n\n<pre><code> &lt;?php\n\n$account_prompt = account_prompt();\nwhile ($prompt = mysql_fetch_array($account_prompt)) \n\n\n if ($prompt['account_prompt'] == '1')  {\n    redirect_to(\"prompt.php\"); \n }\n ?&gt;\n</code></pre>\n\n<p>My question is how can i get it to only redirect once? \nThanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13225326,"title":"SQL Server Column Mapping","body":"<p>I have three scenarios that i'd like to handle, with some remapping i'm doing. </p>\n\n<p>Scenario #1\nI have Table A</p>\n\n<blockquote>\n  <p>Column A, Column B<br>   1, NULL  <br> 2, NULL  <br> 3, NULL  <br> 4,\n  NULL  <br> 5, NULL  <br> 6, NULL  <br></p>\n</blockquote>\n\n<p>How Can I Update Column B such that I begin with the next value of Column A  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, 7  <br> 2, 8  <br> 3, 9  <br> 4, 10  <br>\n  5, 11  <br> 6, 12  <br></p>\n</blockquote>\n\n<p>Scenario #2\nI have Table A  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, NULL  <br> 1, NULL  <br> 2, NULL  <br> 2,\n  NULL  <br> 3, NULL  <br> 3, NULL  <br> 3, NULL  <br></p>\n</blockquote>\n\n<p>How Can I Update Column B such that I begin with the next value of Column A but insuring I only update the values as a group like so  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, 4  <br> 1, 4  <br> 2, 5  <br> 2, 5  <br>\n  3, 6  <br> 3, 6  <br> 3, 6  <br></p>\n</blockquote>\n\n<p>Scenario #3\nI have Table A that contains gaps in Column A  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, NULL  <br> 1, NULL  <br> 4, NULL  <br> 4,\n  NULL  <br> 6, NULL  <br> 6, NULL  <br> 6, NULL  <br></p>\n</blockquote>\n\n<p>How Can I Update Column B such that I begin with the next value of Column A but insuring I only update the values as a group like so  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, 7  <br> 1, 7  <br> 4, 8  <br> 4, 8  <br>\n  6, 9  <br> 6, 9  <br> 6, 9  <br></p>\n</blockquote>\n\n<p>Can I possibly handle all three of these scenario's in one statement? If so, how?\nAny help is much appreciated!  </p>\n"},{"tags":["mysql","sql","query","constraints"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":769,"score":0,"question_id":5156281,"title":"Mysql adding a constraint: force a field to get specific values","body":"<p>I have a simple mysql table with the following attributes: <code>Name, Surname, Role</code>.</p>\n\n<p>I want the Role field to get only 2 possible values: <code>Supervisor</code> or <code>Operator</code> and to result in error when a query tries to insert something different from that 2 values.</p>\n\n<p>For example, i want the following query to return an error:</p>\n\n<pre><code>INSERT INTO tablename (name,surname,role) VALUES ('max','power','footballplayer');\n</code></pre>\n\n<p>I tried setting the field <code>Role</code> as a <code>ENUM</code> or <code>SET</code> type but it will just leave the field empty instead of firing and error :(</p>\n"},{"tags":["php","html","mysql","sql","website"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":71,"score":0,"question_id":13224549,"title":"Am I protecting my website enough from sql injection?","body":"<p>I have made a website where I only display items from my db tables, I pass variables from one page to the other to display certain items, there is no adding, deleting or editing to my table items in my website is just displaying information. </p>\n\n<pre><code>$aaa = _POST['aaa'];\n\n$databasehost = \"localhost\";\n$databasename = \"mydb\";\n$databaseusername = \"user\";\n$databasepassword = \"password\";\n\n// Connect to the database server\n$dbcnx = @mysql_connect($databasehost, $databaseusername, $databasepassword);\n if (!$dbcnx) {\n echo( \"&lt;font color='red'&gt;&lt;P&gt;can't connect to server.&lt;/P&gt;&lt;/font&gt;\" );\n exit();\n  }\n // Select the database\n if (! @mysql_select_db($databasename) ) {\n echo( \"&lt;font color='red'&gt;&lt;P&gt;can't connect to db &lt;/P&gt;&lt;/font&gt;\");\n exit();\n  }\n\n $aaa = mysql_real_escape_string($aaa)\n\n // and with $aaa I do my query\n</code></pre>\n\n<p>I have read that protecting my variables with the mysql_real_escape_string() I stop any injections into my query's but I feel vulnerable with:</p>\n\n<pre><code> $databasehost = \"localhost\";\n $databasename = \"mydb\";\n $databaseusername = \"user\";\n $databasepassword = \"password\";\n</code></pre>\n\n<p>Am I just paranoid or is there a way protect this information that connects to y server and data base?</p>\n"},{"tags":["sql","postgresql","datetime","aggregate","generate-series"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13201077,"title":"Min, Max, Avg for 2-hour intervals","body":"<p>In below query, I am calculating the minimum, the maximum, and the average for a two hour interval using PostgreSQL.</p>\n\n<p>The query works fine for even start hours <code>(..04:00:00+05:30)</code>, but it gives similar result as that of even start time for odd start hours <code>(..05:00:00+05:30)</code>.\nThe multiple by 2 returns even hours which is the problem.</p>\n\n<pre><code>SELECT tagid, CAST(sample_time_stamp as Date) AS stat_date, \n       (floor(extract(hour from sample_time_stamp)/2) * 2)::int AS hrs,\n       min(sensor_reading) AS theMin,   \n       max(sensor_reading) AS theMax,\n       avg(sensor_reading) AS theAvg\nFROM sensor_readings WHERE tagid =1 AND \nsample_time_stamp BETWEEN '2012-10-23 01:00:00+05:30'\n                  AND     '2012-10-23 05:59:00+05:30'\nGROUP BY tagid,CAST(sample_time_stamp as Date),\n         floor(extract(hour from sample_time_stamp)/2) * 2\nORDER BY tagid,stat_date, hrs\n</code></pre>\n\n<h3>OutPut for Odd start Hour ('2012-10-23 01:00:00+05:30')</h3>\n\n<pre><code>tagid    date          hrs  theMin  themax    theAvg \n1        2012-10-23    0    6       58        30.95\n1        2012-10-23    2    2       59        29.6916666666667\n1        2012-10-23    4    3       89        31.7666666666667\n</code></pre>\n\n<h3>OutPut for Even start Hour ('2012-10-23 02:00:00+05:30')</h3>\n\n<pre><code>tagid    date          hrs  theMin   themax    theAvg\n1        2012-10-23    2    2        59        29.6916666666667\n1        2012-10-23    4    3        89        31.7666666666667\n</code></pre>\n"},{"tags":["sql","constraints","foreign-key-relationship","sql-server-2012"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13224918,"title":"SQL Foreign Key Constraint or a static value?","body":"<p>I have two tables:</p>\n\n<ul>\n<li>Customer (Id, Name, HomeAddressId)</li>\n<li>Address (Id, Street, City, State)</li>\n</ul>\n\n<p>I want to place a foreign key constraint on <code>Customer</code> so that the HomeAddressId is valid, but I also want to allow -1 as a valid value (even if it isn't one of the <code>Address.Id</code> values). Is this actually possible? And, if so... how?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13224886,"title":"Why does a left join return differently to a NOT IN?","body":"<p>The following query is behaving somewhat strangely:</p>\n\n<pre><code>SELECT #batches.OutTo, PO_Number, CONVERT(varbinary, #batches.OutTo) , convert     (varbinary, PO_Number), \n    CASE WHEN convert(varbinary, #batches.OutTo) NOT IN (SELECT convert(varbinary,    PO_Number) FROM #pos) \n         THEN 'NOT IN' ELSE 'IN' END\nFROM #batches LEFT JOIN #pos ON \n    convert(varbinary, #batches.OutTo) = CONVERT(varbinary, PO_Number)\nWHERE #batches.OutTo IS NOT NULL\nGROUP BY #batches.OutTo, #pos.PO_Number\n\n\nOutTo       PO_Number   (No column name)    (No column name)    (No column name)\n311117      NULL        0x333131313137      NULL                    IN\n311130      311130      0x333131313330      0x333131313330          IN\n311259      NULL        0x333131323539      NULL                    IN\nL001934     L001934     0x4C303031393334    0x4C303031393334        IN\nL001988     NULL        0x4C303031393838    NULL                    IN\nL002002     NULL        0x4C303032303032    NULL                    IN\n</code></pre>\n\n<p>As you can see, the left join behaves correctly, but the NOT IN does not, returning IN for values that should be NOT IN. Why is this? Is it a bug, or a feature of SQL I don't know about?</p>\n"},{"tags":["php","mysql","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13224614,"title":"If string in database contains number at end, it still should not generate string in php","body":"<p>I have a application which you can view <a href=\"http://helios.hud.ac.uk/u0867587/Mobile_app/Text6.php\" rel=\"nofollow\">here</a>. When you open the app, you will see a submit button, simply click on the button and you will see that it will generate  string underneath. If you keep clicking on the button it keeps generating 2 letter strings between letters \"A\" and \"B\". </p>\n\n<p>If in the database under the \"SessionId\" column, I have in a row string \"AB\". Then it would not generate string \"AB\" when I keep clicking on the submit button. I have tested this and this works fine. So this is not an issue if the string contains no number at the end.</p>\n\n<p>The problem I have is this. If I want to create multiple exams. Lets say the string is \"AA\" and that I have 3 exams, it does not insert string \"AA\" in the database as there are multiple \"AA\", so instead it concatenate a number after each \"AA\" in the database so that it displays it as \"AA1\", \"AA2\" and \"AA3\".</p>\n\n<p>But the problem is that if it does this then when you use the app again and keep clicking on the \"Submit\" button, you see that it still generates string \"AA\" when it shouldn't do as string \"AA\" was used in the database as \"AA1\", \"AA2\" and \"AA3\". I have these three values in the database at the moment yet it still generates the string in the application.</p>\n\n<p>So my question is that how can I stop it from generating the string in the application if the string is in the database with a number concatenated at the end of it?</p>\n\n<p>Below is the code for the application:</p>\n\n<pre><code>&lt;?php\n\n // connect to the database\n include('connect.php');\n\n  /* check connection */\n  if (mysqli_connect_errno()) {\n    printf(\"Connect failed: %s\\n\", mysqli_connect_error());\n    die();\n  }\n\n\nfunction id_generator(){ \n\n          $id = \"\"; \n          $a = array( \"A\" , \"B\", \"C\" ); \n\n      for( $i = 0 ; $i &lt; 2 ; $i++ ){ $r = rand( 0 , 1 );\n       $id .= $a[ $r ]; \n\n   }\n\n   return $id;\n\n   };\n\n   $is_there = true;\n\n      while( $is_there ){\n    $id = id_generator(); // your function to generate id;\n    $result = \"SELECT SessionId FROM Session WHERE SessionId LIKE CONCAT(?, '%')\";\n\n    $stmt=$mysqli-&gt;prepare($result);\n    // You only need to call bind_param once\n    $stmt-&gt;bind_param(\"1\",$id);\n    // execute query\n    $stmt-&gt;execute(); \n    // get result and assign variables (prefix with db)\n    $stmt-&gt;bind_result($dbSessionId);\n\n    $stmt-&gt;store_result();\n\n    $stmtnum = $stmt-&gt;num_rows();\n\n    if($stmtnum == 0) {\n    $is_there = false;\n}\n}\n\n ?&gt;\n\n    &lt;h1&gt;CREATING A NEW ASSESSMENT&lt;/h1&gt;\n\n        &lt;form action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n        &lt;p&gt;\n        &lt;input id=\"courseSubmit\" type=\"submit\" value=\"Submit\" name=\"submit\" /&gt;\n        &lt;/p&gt;\n        &lt;/form&gt;\n\n        &lt;?php\nif (isset($_POST['submit'])) {\n\n        ?&gt;\n\n\n\n\n        &lt;br/&gt;\n\n         &lt;form action=\"QandATable.php\" method=\"post\" id=\"sessionForm\"&gt;\n         &lt;p&gt;&lt;strong&gt;1: Your Assessment ID: &lt;/strong&gt;&lt;span id=\"idFont\"&gt;&lt;?php echo $id; ?&gt;&lt;/span&gt;&lt;/p&gt;\n         &lt;input type='hidden' name='id' value='&lt;?php echo $id; ?&gt;' /&gt;\n\n\n        &lt;/form&gt;\n\n\n\n        &lt;?php\n\n        }\n        ?&gt;\n\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["php","sql","arrays","zend-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13224811,"title":"Zend SQL Array Select with Limit","body":"<p>I have a table, where I need to select rows that correspond to say some item. But from each of those items, I want to select only one of the rows!</p>\n\n<p>So how do I select multiples rows (saying <code>where('search_id = ?' $searchID)</code> with searchID being an array), but for each, I only select one of the rows?</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13224764,"title":"Conditional statements in query designer report builder 3.0","body":"<p>I am using report builder with Excel as my data source. I am having a hard time creating a query text in the query designer. I get errors when i try conditional statements of simple group statements.</p>\n\n<p>I have this statement:</p>\n\n<pre><code> SELECT [Flight No],[Full Name],[Date],[Selected Routing 1] AS Routing,\n [Selected ETD 1] AS ETD,[Selected ETA 1] AS ETA\n FROM [Sheet1$]\n</code></pre>\n\n<p>this will return these values:</p>\n\n<pre><code> Flight No   Full Name     Date       Routing   ETD   ETA\n 1           Peter Hansen  10/1/2012  BNE-MEL   1755  2020\n 2           Black Hansen  10/2/2012  BNE-MEL   1756  2021+1\n</code></pre>\n\n<p>Now, i want to create a conditional statement that when ETA has a +1 on its number then the date will add 1. so the table should look like these:</p>\n\n<pre><code> Flight No   Full Name     Date       Routing   ETD   ETA\n 1           Peter Hansen  10/1/2012  BNE-MEL   1755  2020\n 2           Black Hansen  10/3/2012  BNE-MEL   1756  2021+1\n</code></pre>\n\n<p>I seem to get an error when i try to have an SQL statement like this in the report builder:</p>\n\n<pre><code> SELECT [Flight No],[Full Name],If([Selected ETA 1] LIKE '*+*',[Date]+1,[Date]) \n AS DATE, [Selected Routing 1] AS Routing,[Selected ETD 1] AS ETD,\n [Selected ETA 1] AS ETA\n FROM [Sheet1$]\n</code></pre>\n\n<p>The error says:</p>\n\n<pre><code> An error occurred while executing the query.\n ERROR [42000撛] [Microsoft][ODBC Excel Driver] Undefined function 'if' in expression.\n (Microsoft SQL Server Report Builder)\n\n ERROR [42000撛] [Microsoft][ODBC Excel Driver] Undefined function 'if' in expression.     \n (ACEODBC.DLL)\n</code></pre>\n\n<p>Please give me references if possible. Thanks!</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13223781,"title":"XML parsing error: 'A string literal was expected' when inserting values into table","body":"<p>In Microsoft SQL Server 2008 I am attempting to insert values into an sql table with the columns <strong>type_id of datatype int</strong> and <strong>xml_info of datatype XML</strong>. I am using the following query:</p>\n\n<pre><code>INSERT INTO tbl_applied_devices ([type_id],[xml_info])\nVALUES (1,'&lt;Profile ID=99&gt;&lt;Server&gt;&lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;  &lt;Name&gt;localhost&lt;/Name&gt;&lt;Services&gt;&lt;/Services&gt;&lt;/Server&gt;&lt;/Profile&gt;')\n</code></pre>\n\n<p>But I keep getting this error:</p>\n\n<blockquote>\n  <p>Msg 9413, Level 16, State 1, Line 4<br>\n  XML parsing: line 1, character 13, A string literal was expected  </p>\n</blockquote>\n\n<p>What am I doing incorrectly?</p>\n\n<p><strong>EDIT:</strong>\nI found that the source of the error is the xml element's ID attribute, <code>&lt;Profile ID=99&gt;</code> seems to be what is causing the error. How can I correctly insert xml with an attribute ? Do I need to somehow escape one of the characters?</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":50,"score":4,"question_id":13224164,"title":"ORDER BY depending on the column type","body":"<p>My table is as below:</p>\n\n<pre><code>a | b\n-----\n1 | a\n2 | b \n</code></pre>\n\n<p>In my query, I want to change the order by clause depending on the type of the column.</p>\n\n<p>So something like</p>\n\n<pre><code>get_data($order_by_column) {\n\n  ....\n  ORDER BY\n    CASE \n      WHEN is_numeric($order_by_column) THEN $order_by_column\n      ELSE CHAR_LENGTH($order_by_column)\n    END\n}\n</code></pre>\n\n<p>I've checked and it seems it's quite difficult to determine the column type dynamically like in the above query. What would be an alternative (or alternatives) to achieve this?</p>\n"},{"tags":["sql","ssrs-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13224365,"title":"SSRS - Drillthrough Expression","body":"<p>This is my expression for my drilldown....The field where I have set my drilldown has two values\n - Vacant\n - Occupied</p>\n\n<p>When vacant, it wil do this (it will do nothing and stay on the same report i.e. no drilldown.</p>\n\n<p>=iif(Fields!status.Value = \"Vacant\", Nothing, Globals!ReportName)</p>\n\n<p>But when 'Occupied' I want the drilldown to launch another report.  This is the path of the report.</p>\n\n<p>/RANNNIP/FYTR Reports/FYTRReport_Detail_drill</p>\n\n<p>Is it possible to have this in the same expression ? </p>\n\n<p>This is my current expression - but obviosuly not working</p>\n\n<p>=iif(Fields!status.Value = \"Vacant\", Nothing, Globals!ReportName) &amp; iif(Fields!status.Value = \"Occupied\", Globals!ReportFolder /RAN NGN/FYTR Reports/FYTRReport_Detail_drill)</p>\n"},{"tags":["sql","datetime","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13134334,"title":"SSRS Date time picker: allow user to pick the time component","body":"<p>I want to use a date-time picker to select a date <em>as well as the</em> time component. The calender allows me to pick a date but there's no possibility to choose the a specific time. </p>\n\n<p>I want to choose a start and end time, to select a subset out of lot of a data.</p>\n"},{"tags":["c#","sql","parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13218843,"title":"SQL Statement after adding parameters","body":"<p>Is it possible to see the sql statement after parameters have been replaced?</p>\n\n<pre><code>using(SqlCommand cmdInsert = new SqlCommand(\"INSERT INTO Table(Value_fkey) VALUES(@ValueKey)\", Database.Connection))\n{\n    cmdInsert.Parameters.AddWithValue(\"@ValueKey\", ValueKey);\n    System.Convert.ToInt32(cmdInsert.ExecuteScalar());\n}\n</code></pre>\n\n<p>I'd like it to log my sql statements, so rather not via SQL Server, but I don't mind whether it is before, or after calling the statement.</p>\n"},{"tags":["php","sql","pdo","adodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":318,"score":0,"question_id":8580021,"title":"Method \"moveFirst()\" ADODB, PDO equivalence","body":"<p>Currently I use in my projects <strong>ADODB</strong> library for integration with the database.\nI want to migrate to <strong>PDO</strong>, but I have a question about the consultations.</p>\n\n<p>Currently, with the ADODB I do a query and use the row with the set numerous times using the method <strong>MoveFirst()</strong>.</p>\n\n<p>Example:</p>\n\n<pre><code>//I consultation\n$rs = $conn-&gt;execute('select * from mytable');\n\n//Loop through the results\nwhile(!$rs-&gt;EOF) {\n    echo $rs-&gt;fields('name');\n    $rs-&gt;MoveNext();\n}\n\n//I move the \"pointer\" to the beginning of the list\n$rs-&gt;MoveFirst();\n\n//I can go over the results without needing to re-select\nwhile(!$rs-&gt;EOF) {\n    echo $rs-&gt;fields('name');\n    $rs-&gt;MoveNext();\n}\n</code></pre>\n\n<p>I wonder if there is any way similar in PDO, so I do not need to run the query again.\nThe goal is to avoid unnecessary queries on the bench more often since they use the same query.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1402,"score":3,"question_id":6134016,"title":"How to escape back slash in SQL server","body":"<pre><code>DECLARE @Query nvarchar(max)\nSET @Query ='DECLARE @Test nvarchar(max)\nSELECT @Test = ''\\a'\\b'\\c''\nSELECT @Test\nPRINT @Query\nexec sp_executesql @Query\n</code></pre>\n\n<p>I am trying to get an output as \\a\\b\\c. The above error is probably because I am not able to escape the \\ character.</p>\n"},{"tags":["mysql","sql","facebook","database-design","twitter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13223270,"title":"Database design pattern for storing user data coming from external websites","body":"<p>I'm working on an application which will allow users to register via <code>facebook</code> or <code>twitter</code> and I want to be able to use their personal data from these websites and wondering how I should store it. here is what I have come up with so far:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FnNlf.png\" alt=\"enter image description here\"></p>\n\n<p>The <code>user</code> table would store information that should be present regardless of how the user registered, such as the <code>first_name</code>.</p>\n\n<p>The <code>user_property</code> table would work as a <code>key-value</code> cache and store information that is specific to <code>facebook</code> or <code>twitter</code> (represented by the <code>origin</code> field). I would store properties that can be used as part of <code>API</code> calls or <code>SQL</code> queries individually, such as users' <code>facebook id</code> and I would store results of other <code>API</code> calls serialized in <code>JSON</code> format, such as users' <code>facebook friends</code>. </p>\n\n<p>That way:</p>\n\n<ul>\n<li>I have common information in <code>user</code> table and with one single <code>SELECT</code> I can get some basic useful info on a user</li>\n<li>I have some additional properties coming from <code>facebook/twitter</code> (e.g. user id) stored individually that I can still lookup with a <code>JOIN</code> between <code>user</code> and <code>user_property</code>.</li>\n<li>I can retrieve information that would too expensive to store normalized (e.g. creating a table to store people's friends and have 1 table entry per friend) still with a <code>JOIN</code> between <code>user</code> and <code>user_property</code>.</li>\n</ul>\n\n<p>And here is what I'm wondering right now:</p>\n\n<p><strong>Q1: Could this be a somewhat sustainable database design or am I getting it wrong and going to run into some issues, and if so, which ones?</strong> </p>\n\n<p><strong>Q2: When storing information that is subject to frequent changes (e.g. list of friends/followers), how do you go about keeping the information up to date (do you store information in the DB in the first place? if so what criteria/triggers do you use to decide when to pull information again)?</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13217122,"title":"Comma-separated string in IN clause of SQL query","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4462415/how-to-pass-a-variable-in-where-in-clause-of-oracle-sql\">how to pass a variable in WHERE IN clause of oracle sql?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a column <code>Prefix</code> in my table <code>Tbl_Prefix</code> with value as string separated by comma like this:</p>\n\n<pre><code>'aaa','bbb','ccc'\n</code></pre>\n\n<p>I have an employee table <code>Tbl_Employee</code> like this:</p>\n\n<pre><code>Empno Prefix\n------------\n1000  aaa\n2000  eee\n3000  ccc\n4000  aaa\n5000  ddd\n</code></pre>\n\n<p>I need to use this prefix in the <code>IN</code> portion of my <code>WHERE</code> clause in this query:</p>\n\n<pre><code>Select * \nfrom Tbl_Employee  \nwhere Tbl_Employee.Prefix  in (select  Tbl_Prefix.prefix \n                               from Tbl_Prefix \n                               where Tbl_Prefix.flag = 'y') \n</code></pre>\n\n<p>The inner select query <code>select Tbl_Prefix.prefix from Tbl_Prefix where Tbl_Prefix.flag='y'</code> has the result <code>'aaa','bbb','ccc'</code></p>\n\n<p>How to use this string in the 'IN' clause so that I will get a proper result?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13156617,"title":"SQL query caching","body":"<p>The first run of following query takes about 45 seconds and all the next ones only 1 second. Can you please explain what is the reason and how is it possible to make query run faster on the first execute too?</p>\n\n<pre><code>OPEN SYMMETRIC KEY TEST_KEY DECRYPTION BY PASSWORD='password'\n\nSELECT this.ID FROM SeparationFiles this\nINNER JOIN BarcodeValues b ON this.FIRST_BARCODE_ID = b.ID\nWHERE DecryptByKey(b.ENCRYPTED_VALUE, 0) = 'Peter'\n</code></pre>\n\n<p>Here is execution plan: </p>\n\n<p><img src=\"http://i.stack.imgur.com/u6dJt.png\" alt=\"Execution plan\"></p>\n"},{"tags":["sql","email","redis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13221475,"title":"Is Redis a good option in this scenario?","body":"<p>The company sends emails (thousands) only during 2 hours (i.e. from 1am to 3am), some days even less, during the night, to thousands users. Later it stops, and does nothing else; the next day we use the same process but with new data in those emails.</p>\n\n<p>The process we follow to send them is this:</p>\n\n<ol>\n<li><p>Take content-data/personal-information for emails from SQL database</p></li>\n<li><p>Build queues with these contents-data/personal-information in memory by using Redis</p></li>\n<li><p>Send emails taking content-data/personal-information from memory Redis</p></li>\n<li><p>Delete all content-data/personal-information in memory Redis.</p></li>\n</ol>\n\n<p>The problem is that I'm not sure about if Redis is a good option in this case. It's working, but I think that for only two hours it's not necessary to use Redis. I'm new in the company, so I didn't build that, but I don't understand why they made it like this. </p>\n"},{"tags":["sql","postgresql","date"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13222967,"title":"How to provide a date variable an interval that consists of an integer variable in Postgresql","body":"<p>I am trying to extract an amount of years from a specific date for this the correct syntax is</p>\n\n<pre><code>&lt;date&gt; - interval '5 years';\n</code></pre>\n\n<p>But I dont want to extract a specific amount of years but a variable, which user will provide as a parameter. I have tried the following the variable name is years :</p>\n\n<pre><code>date+interval '% years',years;\n</code></pre>\n\n<p>I am getting an error and it doesn't let me do it that way. What would be the right way to do it.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13223565,"title":"How can I split one record into two and set null values?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning TuesdayEvening and so on\n1   2012-01-01          2               3               2              2\n2   2012-01-02          2               2               2              2\n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning  TuesdayEvening\n1   2012-01-01          2               NULL          2                 2\n1   2012-01-01          NULL            3             NULL              NULL\n2   2012-01-02          2               2             2                 2\n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>I already have a query but, neem some changes. See the query on\n<a href=\"http://sqlfiddle.com/#!3/d41d8/5712\" rel=\"nofollow\">SQL Fiddle</a>.\nThe output you can see here is the case where it goes wrong. For TuesdayEvening and MondayEvening I am expecting 2.</p>\n\n<p>The information on SQL Fiddle is:</p>\n\n<pre><code>Declare @t Table(Id int identity,[Date] Datetime,MondayMorning Int,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int)\nInsert Into @t Select '2012-01-01',0,2,0,2\n\nSELECT id\n    ,date\n    ,MondayMorning\n    ,(CASE WHEN MondayEvening &lt;&gt; MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,TuesdayMorning\n    ,(CASE WHEN TuesdayEvening &lt;&gt; TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t \n\nUNION ALL \n\nSELECT id\n    ,date\n    ,NULL AS MondayMorning\n    ,(CASE WHEN MondayEvening = MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,NULL AS TuesdayMorning\n    ,(CASE WHEN TuesdayEvening = TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t\nWHERE --MondayMorning &lt;&gt; MondayEvening\n--OR TuesdayMorning &lt;&gt; TuesdayEvening\nMondayMorning &lt;&gt; MondayEvening\nAND (MondayMorning != 0 and MondayEvening != 0)\nOR TuesdayMorning &lt;&gt; TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\n</code></pre>\n"},{"tags":["sql","postgresql","constraints"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13219121,"title":"\"Column ’x’ does not exist\" error for string literal ’x’ in PostgreSQL","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13196572/column-mary-does-not-exist\">Column ‘mary’ does not exist</a>  </p>\n</blockquote>\n\n\n\n<p>I need to check the values that can be accepted to a column through a check constraint. I need to use the check constraint, because this is for a college assignment.</p>\n\n<p>I use this code to create and add the constraint to the table.</p>\n\n<pre><code>CREATE TABLE Ereignis(\n  E_Id Serial PRIMARY KEY,\n  Typ varchar(15),\n  Zeitpunkt timestamp,\n  Ort varchar(32),\n  Anzahl_Pers int\n);\n\nALTER TABLE Ereignis ADD \nCONSTRAINT typ_ch CHECK (Typ in (’Verkehrsunfall’, ’Hochwasser’, ’Sonstiges’));\n</code></pre>\n\n<p>Here is the error I get: </p>\n\n<pre><code> ERROR:  column \"’verkehrsunfall’\" does not exist\n</code></pre>\n\n<p>As I get from this error it tries to compare column typ with column verkehrsunfall, where as I try to check the values that column try can get is one of the (’Verkehrsunfall’, ’Hochwasser’, ’Sonstiges’) strings.</p>\n\n<p>This is exactly the same syntax what our lecturer showed us at the lecture. I am not sure if it is possible to compare varchars with check? Or what am I doing wrong?</p>\n\n<p>Here is the example from the lecture:</p>\n\n<pre><code>CREATE TABLE Professoren \n(PersNr INTEGER PRIMARYKEY,\n Name VARCHAR( 3 0 ) NOT NULL ,\n Rang CHAR(2) CHECK (Rang in ('C2' ,'C3' ,'C4')) , \n Raum INTEGER UNIQUE) ;\n</code></pre>\n"},{"tags":["c#","sql","nosql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":29,"score":-5,"question_id":13223528,"title":"how to transfer all data from a SQL database to NoSQL database?","body":"<p>I am new to NoSQL.\nI have a task, where i should store all the data from a SQL database to a NoSQL database.\nMy question is how to handle this situation and where i should start? </p>\n"},{"tags":["sql","ms-access"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2384,"score":1,"question_id":6018172,"title":"Update A multi-valued field in Access","body":"<p>I have created a lookup table in Access to provide the possible values for a column. Now I need to update this column with the data it had before I converted the column. I am unable to figure out a SQL Query that will work. I keep getting the error \"An UPDATE or DELETE query cannot contain a multi-valued field.\" My research has suggested that I just need to set the value of the column but this always updates 0 records:</p>\n\n<pre><code>UPDATE [table_name] SET [column_name].Value = 55 WHERE [table_name].ID = 16;\n</code></pre>\n\n<p>I know this query will work if I change it to update a text column, so it is definitely a problem with just this column.</p>\n"},{"tags":["sql","distributed-system","filetable"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":32,"score":-1,"question_id":13223217,"title":"Want to sort of create a distributed file system?","body":"<p>Where I work there is about 400 employees split between several campuses at the two main campuses we have servers set up and shared folders on the servers. I want to setup a system so  we have one shared folder that users see but then have copies of all the files on both servers and access the files based on which campus the user is at to stop people having wait while files transfer, and then only if a file is changed force them to have to access the latest copy of the file, and then transfer all files changed overnight so it is not slowing down the network during the day. </p>\n\n<p>Can anyone tell me is there a system that already does this? Or what keywords I should be using when trying to search for a system that does this?</p>\n\n<p>I have been looking at creating a system to do this using MS SQL Server 2012 FileTables and putting triggers on the tables to check which table had the latest copy of the file and creating a store procedure to compress and transfer changed files overnight.</p>\n"},{"tags":["mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13213624,"title":"How to find percentages of values in SQL?","body":"<p>I use following query to find out percentage of winning by Hero in games:</p>\n\n<pre><code>SELECT Hero, (COUNT(*) * g.games) AS p\nFROM gamestatistics\nJOIN (\nSELECT 100/COUNT(*) AS games\nFROM gamestatistics\n) AS g\nWHERE PointEarned&gt;0\nGROUP BY Hero\nORDER BY p DESC\n</code></pre>\n\n<p>But this gives me percent for ALL games. And I want  to know</p>\n\n<blockquote>\n  <p><code>percentage(for Hero)=(Won games by this player)/(Played games by this hero)</code></p>\n</blockquote>\n\n<p>instead of</p>\n\n<blockquote>\n  <p>percentage(for Hero)=(Won games by this player)/(All games)<br>\n  Thanks.</p>\n</blockquote>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13223223,"title":"mysql query getting all fields in table 1 and partial in from table two","body":"<p>Coming back to my very old mysql skills I have need of the following query.</p>\n\n<p>I have two tables </p>\n\n<p>One is a table of all items called products with cols item name, item num</p>\n\n<p>Two is a table of purchased items with cols item num, date</p>\n\n<p>What I need as a result is something like this</p>\n\n<pre><code>ITEM-----PURCHASED\nitem1-------0 \nitem2-------0\nitem3-------0\nitem4-------1  This item purchased\nitem5-------0\nitem6-------1  This item purchased\nitem7-------0\nitem8-------0\n.\n.\n.\nitemX-------0\n</code></pre>\n\n<p>Output contains all items and a 1 in the purchased col if the item exist in the purchased items table\nand a 0 if it has NOT been purchased.</p>\n\n<p>I am sorry if this is easy my brain is in meltdown mode currently and it has been a long time I have needed something like this</p>\n"},{"tags":["mysql","sql","visitor-statistic"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13220121,"title":"SQL , count equivalent values in each column","body":"<p>I'm working on a URL shortener project with PHP &amp; MYSQL which tracks visits of each url. I've provided a table for visits which mainly consists of these properties :  </p>\n\n<pre><code>time_in_second | country | referrer |  os   | browser | device | url_id\n#####################################################################\n1348128639     |    US   |   direct |  win  | chrome  | mobile | 3404  \n1348128654     |    US   |   google | linux | chrome  | desktop| 3404  \n1348124567     |    UK   |   twitter| mac   | mozila  | desktop| 3404  \n1348127653     |    IND  |   direct | win   | IE      | desktop| 3465  \n</code></pre>\n\n<p>Now I want to make a query on this table. for example I want to get visits data for the url with <code>url_id=3404</code>. Because I should <em>provide statistics and draw graphs</em>, for this url, I need these data:  </p>\n\n<ul>\n<li>Number of each kind of OS for this URL , for example 20 windows, 15 linux , ...</li>\n<li>Number of visits in each desired period of time , for example each 10 minutes in past 24 hour</li>\n<li>Number of visits for each country</li>\n<li>...  </li>\n</ul>\n\n<p>As you see, some data like country may accept lots of different values.  </p>\n\n<p>One good idea which I can imagine is to make query which outputs number of each unique value in each column, for example in the country case for the data given above, on column for <code>num_US</code>, one for <code>num_UK</code>, and one for <code>num_IND</code>.  </p>\n\n<p>Now the question is how to implement such a high-performance query in sql (MYSQL) ?  </p>\n\n<p>Also if you think this is not an efficient query for performance, what's your suggestion?  </p>\n\n<p>Any help will be appreciated deeply. </p>\n\n<p><strong>UPDATE:</strong> look at this question : <a href=\"http://stackoverflow.com/questions/915260/sql-only-count-the-values-specified-in-each-column\">SQL; Only count the values specified in each column</a> . I think this question is similar to mine , but the difference is in variety of values possible (as lots of values are possible for <code>country property</code>) for each column which makes the query more complex.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13210510,"title":"Dragging some rows in the middle of the table","body":"<p>So as i say , is possible copy each row and put it on the row below or as the same move field rows to the fields below? ( have and index auto increment of course ).The result should be the old row 40 content (fields) in the row 41 and so. </p>\n\n<pre><code>REPLACE table SET column1 = previuos(column1), column2= previous(column2), column3=(previous(column3)  where id &gt; 20 and id &lt; 300 \n</code></pre>\n\n<p>They are not the last inserted, they are in the middle of the table and want to move it down , so that let me some empty rows ( with the index ) at the beginning of the selected ones</p>\n\n<pre><code>  INSERT INTO table (\n  SELECT column1,column2,column3 \n  FROM  table  WHERE id &gt; 20 AND id &lt; 200\n  ) WHERE id = 30 \n</code></pre>\n\n<p>selected row from 21 to 199 then inserted on 30 and ahead</p>\n\n<p>thank you</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13222602,"title":"The min () to improve","body":"<p>This is my database project.</p>\n\n<p>table <strong>user_</strong></p>\n\n<pre><code>select id, name from user_;\n\n id |   name\n----+----------\n  1 | bartek\n  2 | bartek_m\n  3 | bartek_k\n  4 | bartek_b\n</code></pre>\n\n<p>table <strong>order_</strong></p>\n\n<pre><code>select id, employee_id, user_id from order_;\n\n id | employee_id | user_id\n----+-------------+---------\n  1 |           3 |       1\n  2 |           4 |       1\n  3 |           4 |       1\n  4 |           4 |       1\n  5 |           3 |       1\n</code></pre>\n\n<p>Every user has a role(I don't add table role_ here but it exist).\nID of every user with role employee can be assigned to order_.employee_id \nI need obtain user with minimum number of orders </p>\n\n<pre><code>select a.id, min(a.count) from (\n    select u.id, count(u.id) from user_ u, order_ o\n    where u.id = o.employee_id\n    group by u.id\n) as a group by a.id, a.count\n\n id | min\n----+-----\n  4 |   3\n  3 |   2\n</code></pre>\n\n<p>I think that my query is wrong. Could anyone change query to return \n only ID this user which have minimum number of orders?</p>\n"},{"tags":["sql","count","group-by","inner-join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13222218,"title":"SQL Count Innerjoin by Grouping","body":"<p>I have searched all the SQL questions and I have found every version of what I don't want - so I need to ask.  I am in a brain lock - knowing there is a count and sum and group and a join all thrown together.</p>\n\n<p><strong>2 Tables</strong> </p>\n\n<ol>\n<li>CustomerTable - CustID, CustQuality (values are good customer, bad customer, new customer etc)</li>\n<li>PurchaseTable (PurchID, PurchItem, PurchDate)</li>\n</ol>\n\n<p>I am trying to count how many purchases by Good, Bad, New Customers in the last 30 days.</p>\n\n<p>I have tried the join and group count etc and I keep getting:</p>\n\n<ul>\n<li>GoodCustomer - CustID2 - 1 purch</li>\n<li>GoodCustomer - CustID3 - 3 purch</li>\n<li>GoodCustomer - CustID4 - 2 purch</li>\n<li>BadCustomer - CustID7 - 2 purch</li>\n<li>BadCustomer - CustID1 - 4 purch</li>\n<li>NewCustomer - CustID9 - 1 purch</li>\n<li>NewCustomer - CustID4 - 4 purch etc etc.</li>\n</ul>\n\n<p><strong>I just want the overall results</strong></p>\n\n<ul>\n<li>3 Good Customers made 6 Purchases </li>\n<li>2 Bad Customers made 6 Purchases </li>\n<li>2 New Customers made 5 Purcahses</li>\n</ul>\n\n<p>THEN FOR ADDITIONAL functioning...  I have a 3rd table that I need to join as well. CustomerLocation (CLID, CLLocation (values of North, South, East, West))</p>\n\n<p>So if I wanted to know the following break down of the groups</p>\n\n<ul>\n<li>3 Good Customers made 6 Purchases - 1 Customer was from the North, 2 Customers From South</li>\n<li>2 Bad Customers made 6 Purchases - 5 Customer from East, 1 West</li>\n<li>2 New Customers made 5 Purcahses - 2 Customer from South</li>\n</ul>\n\n<p>And the last new query would be...\nWHERE CLLocation = South</p>\n\n<p>Or if I wanted to look up by region...</p>\n\n<ul>\n<li>1 Good Customers made 3 Purchases</li>\n<li>2 Bad Customers made 2 Purchases</li>\n<li>0 New Customers made 0 Purcahses</li>\n</ul>\n\n<p><strong>I KNOW I AM ASKING A LOT - BUT ANY AND ALL HELP WOULD BE GREATLY APPRECIATED!</strong></p>\n"},{"tags":["c#","sql","nhibernate","datetime","like"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13220787,"title":"NHibernate LIKE query on date column","body":"<p>I'm using the following code to dynamically filter data (I'm using MySQL as a DB engine):</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var filter = string.Empty;\nif (!string.IsNullOrWhiteSpace(filterNumber))\n{\n    filter = \"t.Number LIKE :filterNumber\";\n}\nvar query = string.Format(\"SELECT t FROM Table t WHERE 1=1 AND {0} ORDER BY {1} {2}\", filter, orderBy, orderDirection);\nvar q = Session.CreateQuery(query);\nif (!string.IsNullOrWhiteSpace(filterNumber))\n{\n    q.SetParameter&lt;string&gt;(\"filterNumber\", \"%\" + filterNumber + \"%\");\n}\nq.SetFirstResult(offset);\nq.SetMaxResults(limit);\nreturn q.List&lt;Table&gt;();\n</code></pre>\n\n<p>(assume that <code>filterNumber</code>, <code>orderBy</code>, <code>orderDirection</code>, <code>offset</code> and <code>limit</code> are method's parameters and <code>1=1</code> was added only for the sake of this question so the query always work)</p>\n\n<p>It does work when Number is a string (VARCHAR in MySQL) column but it does not work when it is a datetime or integer column.</p>\n\n<p>For datetime it raises the exception:\n<code>could not execute query […] Name:filterDate - Value:%2012%</code> and inner exception is <code>Specified cast is not valid</code>.</p>\n\n<p>For integer/float columns the exception is:\n<code>could not execute query […] Name:filterPrice - Value:%100%</code> and inner exception is <code>Input string was not in a correct format</code>.</p>\n\n<p>(<code>Date</code> and <code>Price</code> are another columns in the table)</p>\n\n<p>How to dynamically create such a LIKE query on date/numbers columns? This kind of query works well in MySQL:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM `Table` WHERE `Date` LIKE '%2012%'\n</code></pre>\n"},{"tags":["sql","vb.net","tsql","ado.net","oledb"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2997,"score":0,"question_id":6414032,"title":"VB.NET Using a SELECT statement to return a row where a DateTime column = variable of type Date?","body":"<p>I am using OleDb, trying to do this:</p>\n\n<pre><code>Dim d as Date = DateSerial(Year(rptDate), Month(rptDate), 1 - 1)\n\nDim conn as OleDbConnection = new OleDbConnection(connStr)\nDim cm as OleDbCommand = new OleDbCommand()\n\nconn.Open()\ncm.Connection = conn\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = \" &amp; d\n</code></pre>\n\n<p>Okay, so I know it returns 1 row because I'm staring at it in SQL Server. Here is what I've tried so far for the query in the last line, none work:</p>\n\n<pre><code>\"SELECT * FROM history WHERE ReportDate = \" &amp; d\n\"SELECT * FROM history WHERE ReportDate = \" &amp; d.toString(\"G\")\n\"SELECT * FROM history WHERE ReportDate = '\" &amp; d &amp; \"'\"\n\"SELECT * FROM history WHERE ReportDate = '\" &amp; d.toString(\"G\") &amp; \"'\"\n\"SELECT * FROM history WHERE ReportDate = '#\" &amp; d &amp; \"#'\"\n\"SELECT * FROM history WHERE ReportDate = #\" &amp; d &amp; \"#\" 'These last 2 with toString\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>cm.CommandText = \"SELECT * FROM history WHERE ReportDate = ?\"\ncm.Parameters.Add(d)\n\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = ?\"\ncm.Parameters.Add(d.toString(\"G\"))\n\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = '?'\"\ncm.Parameters.Add(d.toString(\"G\"))\n\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = '?'\"\ncm.Parameters.Add(d)\n</code></pre>\n\n<p>Clearly I am missing something here, help? I know that <code>d</code> is the same date as the one in SQL server, specifically <code>3/31/2011 12:00:00 AM</code>.</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","postgresql","pivot"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13168066,"title":"How do I transpose rows and columns (a.k.a. perform a pivot) in PostgreSQL only for rows and columns with a minimum COUNT()?","body":"<p>Here's my table 'tab_test':</p>\n\n<pre><code>year    animal  price\n2000    kittens 79\n2000    kittens 93\n2000    kittens 100\n2000    puppies 15\n2000    puppies 32\n2001    kittens 31\n2001    kittens 17\n2001    puppies 65\n2001    puppies 48\n2002    kittens 84\n2002    kittens 86\n2002    puppies 15\n2002    puppies 95\n2003    kittens 62\n2003    kittens 24\n2003    puppies 36\n2003    puppies 41\n2004    kittens 65\n2004    kittens 85\n2004    puppies 58\n2004    puppies 95\n2005    kittens 45\n2005    kittens 25\n2005    puppies 15\n2005    puppies 35\n2006    kittens 50\n2006    kittens 80\n2006    puppies 95\n2006    puppies 49\n2007    kittens 40\n2007    kittens 19\n2007    puppies 81\n2007    puppies 38\n2008    kittens 37\n2008    kittens 51\n2008    puppies 29\n2008    puppies 72\n2009    kittens 84\n2009    kittens 26\n2009    puppies 49\n2009    puppies 34\n2010    kittens 75\n2010    kittens 96\n2010    puppies 18\n2010    puppies 26\n2011    kittens 35\n2011    kittens 21\n2011    puppies 90\n2011    puppies 18\n2012    kittens 12\n2012    kittens 23\n2012    puppies 74\n2012    puppies 79\n</code></pre>\n\n<p>Here's some code that transposes the rows and columns so I get an average for 'kittens' and 'puppies':</p>\n\n<pre><code>SELECT\n    year,\n    AVG(CASE WHEN animal = 'kittens' THEN price END) AS \"kittens\",\n    AVG(CASE WHEN animal = 'puppies' THEN price END) AS \"puppies\"\nFROM tab_test\nGROUP BY year\nORDER BY year;\n</code></pre>\n\n<p>The output for the code above is:</p>\n\n<pre><code>    year    kittens puppies\n    2000    90.6666666666667    23.5\n    2001    24.0    56.5\n    2002    85.0    55.0\n    2003    43.0    38.5\n    2004    75.0    76.5\n    2005    35.0    25.0\n    2006    65.0    72.0\n    2007    29.5    59.5\n    2008    44.0    50.5\n    2009    55.0    41.5\n    2010    85.5    22.0\n    2011    28.0    54.0\n    2012    17.5    76.5\n</code></pre>\n\n<p>What I'd like is a table like the second one, but it would only contain items which had a COUNT() of at least 3 in the first table. In other words, the goal is to have this as the output:</p>\n\n<pre><code>year    kittens\n2000    90.6666666666667\n</code></pre>\n\n<p>There were at least 3 instances of 'kitten' in the first table.</p>\n\n<p>Is this possible in PostgreSQL?</p>\n"},{"tags":["sql","sql-server","join","left-join","outer-join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13221154,"title":"How can I get join not duplicate?","body":"<p>I get join 2 tables but use 3 table. I need not duplicate values. But I try join have duplicate.</p>\n\n<p>Table <code>peopleAll</code>:</p>\n\n<pre><code>pNo    pName\n-------------\n00001  Sang\n00002  Janta\n00003  Els\n00004  Est\n00005  Sam\n00006  John\n00007  Misan\n00008  Wila\n00009  light\n00010  Smith\n00011  Ritpo\n</code></pre>\n\n<p>Table <code>fTime</code>:</p>\n\n<pre><code>cNo    cDate                     cIn                        cOut\n-----------------------------------------------------------------------------------\n00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n</code></pre>\n\n<p>Table <code>Leave</code>:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n</code></pre>\n\n<p>This SQL code:</p>\n\n<pre><code>SELECT lr.lNo, lr.lDate, lr.lStart, lr.lStop \nFROM Leave lr \nWhere lr.cStart = '2012-10-22'\n\nUNION ALL\n\nSELECT pa.pNo, ISNULL(tf.cDate, Convert(nvarchar(10),'2012-10-22',114)),tf.cIn, tf.cOut\nFROM fTime tf FULL OUTER join peopleAll pa On tf.cNo = pa.pNo AND \ntf.cDate = Convert(nvarchar(10),'2012-10-22',114)\n</code></pre>\n\n<p>returns this output:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000\n00006  2012-10-22 00:00:00.000   NULL                       NULL\n00007  2012-10-22 00:00:00.000   NULL                       NULL\n00008  2012-10-22 00:00:00.000   NULL                       NULL\n00009  2012-10-22 00:00:00.000   NULL                       NULL\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n</code></pre>\n\n<p>I try to change <code>FULL OUTER JOIN</code> then <code>LEFT OUTER JOIN</code> and I get output:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00007  2012-10-22 00:00:00.000   NULL                       NULL\n00008  2012-10-22 00:00:00.000   NULL                       NULL\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n</code></pre>\n\n<p>LEFT OUTER join have miss some field??</p>\n\n<p>I need this output:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000 \n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000\n00006  2012-10-22 00:00:00.000   NULL                       NULL\n00007  2012-10-22 00:00:00.000   NULL                       NULL\n00008  2012-10-22 00:00:00.000   NULL                       NULL\n00009  2012-10-22 00:00:00.000   NULL                       NULL\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n\n(00002,00003 from fTime)\n</code></pre>\n\n<p>Please help me. Thanks you for you time. :)</p>\n"},{"tags":["sql","sql-server","query","insert","character"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13218271,"title":"SQL statement using special charter","body":"<p>Can anyone please help me in correcting below statement:</p>\n\n<pre><code>SET @cmd='BULK INSERT ' + @Database + '.dbo.' + @tmp + ' from ' + @Out + @tmp + '.csv \nWITH (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)' \n</code></pre>\n\n<p>Output of the above query is: </p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)</p>\n</blockquote>\n\n<p>I want to print this in below manner:</p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR =',', ROWTERMINATOR = '\\n')</p>\n</blockquote>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13222135,"title":"Select mutiples of one field","body":"<p>Is it possible to select individual rows within a table from a list of one column variables?</p>\n\n<p>e.g. i'm trying to select just certain products from a table of products, using a list of ID numbers</p>\n\n<p>Example table \"items\":</p>\n\n<pre><code>item_id    item_title    item_source\n-------    ----------    -----------\n123        item A        place_a\n124        item B        place_b\n125        item C        place_c\n126        item D        place_d\n</code></pre>\n\n<p>Here's what I'm trying, but it's not working:</p>\n\n<pre><code>select item_title, item_source from items where item_id IN ('123','125','126')\n</code></pre>\n\n<p>I want to return:</p>\n\n<pre><code>item A        place_a\nitem C        place_c\nitem D        place_d\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","adventureworks"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13220573,"title":"Adventure Works Explanation","body":"<p>I've been looking at Microsoft's Adventure Works 2012 database. I'd be very interested if there's any information explaining why the tables were created as they are. Some sort of schema overview I guess.</p>\n\n<p>For example: </p>\n\n<p>Why they chose to create a <code>BusinessEntity</code> table as a sort of base class for Person, Employee, etc.</p>\n\n<p>Most of the data is normalized so why they chose to put the <code>CountryRegionCode</code> field into the <code>StateProvince</code> table instead of an ID to a separate table.</p>\n\n<p>Anyway I'm very interested in learning more about the decisions that went into the databases design. Anyone know a resource that goes into this sort of thing?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13221588,"title":"SQL retrieve info from multiple tables","body":"<p>i have a question about sql and i need to know if i can retrieve results using only sql.</p>\n\n<p>I need to find the distance in km of the route with the id=1 that starts from station 1 and arrive at station 4. So route 1 will pass from 4 stations (the number could be more or less). I need to find the distance that a train will cover crossing all the 4 stations. Which are: 5+10+15=30</p>\n\n<p>is it possible to get the answer using only SQL?</p>\n\n<p>below are the tables (i hope you understand the structure):</p>\n\n<p>you can see an image of the table <a href=\"http://studio9.com.cy/testing/sql.gif\" rel=\"nofollow\">here</a></p>\n\n<pre><code>route - station\n-----------------------\n1     - 1    \n1     - 2    \n1     - 3    \n1     - 4\n\n\nstation1 - station2 - distance (km)\n------------------------------------\n1        - 2        -   5\n2        - 3        -   10\n3        - 4        -   15\n</code></pre>\n"},{"tags":["sql","sql-server-2008","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13221690,"title":"Can I calculate there's how many weekend days between two dates in SQL Server?","body":"<p>I'm calculating income of hiring equipments for a report. In that, hiring cost in weekend days will be plus 10% more if compare with normal days. So how can I calculate there's how many weekend days between two dates. And in report query, I can't use DECLARE also. Can someone help me to do this. Thank you so much</p>\n"},{"tags":["android","sql","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13221839,"title":"Android SQLite values selection","body":"<p>I'm new to android and SQLite,</p>\n\n<p>is my following code correct?</p>\n\n<pre><code>SQLiteDatabase aa = openOrCreateDatabase(\"MLIdata\", MODE_WORLD_READABLE, null);\nCursor c = aa.rawQuery(\"SELECT CblocationName FROM MLITable WHERE CblocationCode = '\"+str+\"'\", null);\nc.moveToFirst();\nc.getString(c.getColumnIndex(\"CblocationName\"));\n</code></pre>\n\n<p>I doubt that my SQL query is wrong (i.e, rawQuery line in my above code).</p>\n\n<p>Thank you.</p>\n"},{"tags":["php","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13221762,"title":"I can't get INSERT INTO to work with php","body":"<p>I really have no idea what I am doing wrong. All other queries (SELECT-queries) work without any problem, but this doesn't seem to work. Any ideas?</p>\n\n<pre><code>&lt;?php\nsession_start();\n\n$host=\"*******\"; // Host name \n$username=\"*******\"; // Mysql username \n$password=\"*******\"; // Mysql password \n$db_name=\"*******\"; // Database name \n$from = $_GET['from'];\n$to = $_GET['to'];\n\n// Connect to server and select databse.\n$con = mysql_connect(\"$host\", \"$username\", \"$password\")or die(\"cannot connect\"); \nmysql_select_db(\"$db_name\",$con)or die(\"cannot select DB\");\n\n\nmysql_query(\"INSERT INTO message('from', 'to', 'message', 'confirm') VALUES (2,3,'would like to add you as a friend',1)\");\n\necho'The request has been sent.';\n\n\n\n\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","vb.net","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2101,"score":0,"question_id":9784301,"title":"Inserting data from a DataGridView to a database","body":"<p>I have a small DataGridView which lets the user enter data.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SljPE.png\" alt=\"Ths is the grid\"></p>\n\n<p>And I'm trying this code to enter the data in the DataGridView to the database.</p>\n\n<pre><code>    strQry = \"INSERT INTO Emp_Fam_Details (empID, famName, famAge, famRelation, famOccup)\" _\n            &amp; \"VALUES (@ID, @Name, @Age, @Rel, @Occ)\"\n    Dim adapFam As New SqlDataAdapter\n    adapFam.InsertCommand = New SqlCommand(strQry, sqlcon)\n\n    For i As Integer = 0 To grdFamily.Rows.Count - 1\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@ID\", txtEmpID.Text.Trim)\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Name\", grdFamily.Columns(0))\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Age\", grdFamily.Columns(1))\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Rel\", grdFamily.Columns(2))\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Occ\", grdFamily.Columns(3))\n\n        result2 = adapFam.InsertCommand.ExecuteNonQuery()\n    Next\n</code></pre>\n\n<p>When I run this, I come across this error.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Nf1X4.png\" alt=\"This is the error\"> </p>\n\n<p>I found <a href=\"http://stackoverflow.com/a/9391411/1077789\">this</a> solution here on SO but since I'm using Parameters not appended values, I'm having a hard time understanding how to do it with parameters. </p>\n\n<p>Can anyone please show me how to do this? </p>\n\n<p>Thank you all. </p>\n"},{"tags":["sql","sql-server","join","pagination"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13220743,"title":"Implement paging (skip / take) functionality with this query","body":"<p>I have been trying to understand a little bit about how to implement custom paging in SQL, for instance reading <a href=\"http://stackoverflow.com/questions/548475/efficient-way-to-implement-paging\">articles like this one</a>.</p>\n\n<p>I have the following query, which works perfectly. But I would like to implement paging with this one.</p>\n\n<pre><code>SELECT TOP x PostId FROM ( SELECT PostId, MAX (Datemade) as LastDate\n from dbForumEntry \n group by PostId ) SubQueryAlias\n order by LastDate desc\n</code></pre>\n\n<p><strong>What is it I want</strong></p>\n\n<p>I have forum posts, with related entries. I want to get the posts with the latest added entries, so I can select the recently debated posts.</p>\n\n<p>Now, I want to be able to get the \"top 10 to 20 recently active posts\", instead of \"top 10\".</p>\n\n<p><strong>What have I tried</strong></p>\n\n<p>I have tried to implement the ROW functions as the one in the article, but really with no luck. </p>\n\n<p>Any ideas how to implement it?</p>\n"},{"tags":["sql","mysql"],"answer_count":8,"favorite_count":7,"up_vote_count":12,"down_vote_count":0,"view_count":7645,"score":12,"question_id":3856435,"title":"How to convert all tables from MyISAM into InnoDB?","body":"<p>I know I can issue an alter table individually to change the table storage from MyISAM to InooDB.</p>\n\n<p>I am wondering if there is a way to quickly change all of them to InnoDB?</p>\n"},{"tags":["asp.net","sql","sql-management-studio","mdf","app-data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":239,"score":1,"question_id":11487170,"title":"Run SQL script on MDF file in App_Data","body":"<p>I have the following setup:</p>\n\n<ul>\n<li>Development: My own computer using an MDF file with a connectionstring which refers to my app_data folder. </li>\n<li>Production: An online server with its own SQL database</li>\n</ul>\n\n<p>When I want to create a new table / fields in my system, I create it in deployment and then run those scripts on production without data.</p>\n\n<p>Now, I am in the opposite situation: I've generated scripts from my production server, and wants to run those towards my local MDF file.</p>\n\n<p>How do I do that? All the answers i've seen so far doesn't help me.</p>\n\n<p><strong>I've tried the following</strong>:</p>\n\n<p>I've tried to run the whole SQL script in the \"Run query\" in Visual Studio, but I get a \"The Set SQL construct or statement is not supported.\" error.</p>\n\n<p>I guess I have to open the MDF file somehow in Microsoft SQL Management Studio - but I can't really find a way to get it all to work.</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>After half a year, I've been using the method suggested as the answer again and again. It is by far the best solution. No more MDF files in the project!</p>\n\n<p>I would strongly suggest anyone reading this to start having your databases in your local database.</p>\n"},{"tags":["c#","sql","linq","wildcard"],"answer_count":8,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":10023,"score":9,"question_id":1040380,"title":"Wildcard search for LINQ","body":"<p>I would like to know if it is possible to do a wildcard search using LINQ.</p>\n\n<p>I see LINQ has Contains, StartsWith, EndsWith, etc.</p>\n\n<p>What if I want something like %Test if%it work%, how do I do it?</p>\n\n<p>Regards</p>\n"},{"tags":["sql","sqlite","core-data"],"answer_count":3,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":494,"score":13,"question_id":13219472,"title":"Why SELECT 0, ... instead of SELECT","body":"<p>Lets say I have a SQLite database that contains a table:</p>\n\n<pre><code>sqlite&gt; create table person (id integer, firstname varchar, lastname varchar);\n</code></pre>\n\n<p>Now I want to get every entry which is in the table.</p>\n\n<pre><code>sqlite&gt; select t0.id, t0.firstname, t0.lastname from person t0;\n</code></pre>\n\n<p>This works fine and this it what I would use. However I have worked with a framework from Apple (Core Data) that generates SQL. This framework generates a slightly different SQL query:</p>\n\n<pre><code>sqlite&gt; select 0, t0.id, t0.firstname, t0.lastname from person t0;\n</code></pre>\n\n<p>Every SQL query generated by this framework begins with \"select 0,\". Why is that?</p>\n\n<p>I tried to use the explain command to see whats going on but this was inconclusive - at least to me.</p>\n\n<pre><code>sqlite&gt; explain select t0.id, t0.firstname, t0.lastname from person t0;\naddr        opcode      p1          p2          p3          p4          p5          comment   \n----------  ----------  ----------  ----------  ----------  ----------  ----------  ----------\n0           Trace       0           0           0                       00          NULL      \n1           Goto        0           11          0                       00          NULL      \n2           OpenRead    0           2           0           3           00          NULL      \n3           Rewind      0           9           0                       00          NULL      \n4           Column      0           0           1                       00          NULL      \n5           Column      0           1           2                       00          NULL      \n6           Column      0           2           3                       00          NULL      \n7           ResultRow   1           3           0                       00          NULL      \n8           Next        0           4           0                       01          NULL      \n9           Close       0           0           0                       00          NULL      \n10          Halt        0           0           0                       00          NULL      \n11          Transactio  0           0           0                       00          NULL      \n12          VerifyCook  0           1           0                       00          NULL      \n13          TableLock   0           2           0           person      00          NULL      \n14          Goto        0           2           0                       00          NULL \n</code></pre>\n\n<p>And the table for the second query looks like this:</p>\n\n<pre><code>sqlite&gt; explain select 0, t0.id, t0.firstname, t0.lastname from person t0;\naddr        opcode      p1          p2          p3          p4          p5          comment   \n----------  ----------  ----------  ----------  ----------  ----------  ----------  ----------\n0           Trace       0           0           0                       00          NULL      \n1           Goto        0           12          0                       00          NULL      \n2           OpenRead    0           2           0           3           00          NULL      \n3           Rewind      0           10          0                       00          NULL      \n4           Integer     0           1           0                       00          NULL      \n5           Column      0           0           2                       00          NULL      \n6           Column      0           1           3                       00          NULL      \n7           Column      0           2           4                       00          NULL      \n8           ResultRow   1           4           0                       00          NULL      \n9           Next        0           4           0                       01          NULL      \n10          Close       0           0           0                       00          NULL      \n11          Halt        0           0           0                       00          NULL      \n12          Transactio  0           0           0                       00          NULL      \n13          VerifyCook  0           1           0                       00          NULL      \n14          TableLock   0           2           0           person      00          NULL      \n15          Goto        0           2           0                       00          NULL     \n</code></pre>\n"},{"tags":["php","sql","passwords"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13212797,"title":"let user change their own password?","body":"<p>I am just starting to learn php and sql so please go easy on me, i know i'm going to be wrong in certain places. I am trying to allow a user to login and be able to change their password. I have made an attempt of a script which i believe should work, but i guess i'm doing something wrong as it will just link to the php function page and not change the password at all. Here's my script:</p>\n\n<p>HTML form:</p>\n\n<pre><code>&lt;form method=\"POST\" action=\"includes/changepassword.php\"&gt;\n&lt;p&gt;&lt;input type=\"password\" name=\"oldpasswd\" id=\"oldpasswd\" maxlength=\"30\" placeholder=\"Old Password\"&gt;&lt;/p&gt;\n&lt;p&gt;&lt;input type=\"password\" name=\"newpsswd1\" id=\"newpsswd1\" maxlength=\"30\" placeholder=\"New Password\"&gt;&lt;/p&gt;\n&lt;p&gt;&lt;input type=\"password\" name=\"newpsswd2\" id=\"newpsswd2\"maxlength=\"30\" placeholder=\"Confirm Password\"&gt;&lt;/p&gt;\n&lt;input type=\"submit\" name=\"submit\" id=\"submit\" value=\"change password\"&gt;\n</code></pre>\n\n<p>changepassword.php file:</p>\n\n<pre><code> &lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\nfunction changepassword ($oldpasswd, $newpasswd1, $newpasswd2) {\n    /*\n     * RETURNS\n     * 0 - if password changed\n     * 1 - if new passwords are not equal\n     * 2 - if user authentification problems\n     */\n\n\n        $oldpasswd = ($_POST['oldpasswd']);\n        $newpasswd1 = ($_POST['newpasswd1']);\n        $newpasswd1 = ($_POST['newpasswd2']);\n\n\n\n\n    if ($newpasswd1 != $newpasswd2) {\n        return 1;\n    }\n\n    //check user logged in changes OWN passwd\n    $sql = \"SELECT password FROM ptb_users WHERE id = \".$_SESSION['user_id'];\n    $result = mysql_query($sql)or die('User not found: ' . mysql_error());\n\n    if (md5($oldpasswd)==$result) { \n\n        //Encrypt $emailpassword in MD5 format for the database\n        $md5_np=md5($newpasswd1);\n\n        // Make a safe query\n        $query = sprintf(\"UPDATE `ptb_users` SET `password` = '%s' \n                    WHERE `id` = \".$_SESSION['user_id'],\n                    mysql_real_escape_string($md5_np));\n\n        mysql_query($query)or die('Could not update password: ' . mysql_error());\n        return 0;\n    } else {\n        return 2;\n    }\n\n\n}   \n?&gt;\n</code></pre>\n\n<p>What have I done wrong?</p>\n"},{"tags":["sql","sql-server-2008-r2","ssas","indexed-view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13191372,"title":"Indexed views, with (NOEXPAND), and SSAS cubes","body":"<p>I've set up an indexed view which I intend to use as a data source view for a SSAS cube. The indexed view looks something like this:</p>\n\n<pre><code>create view vw_indexed1 with schemabinding\nas\n\nselect \nkey1, \nkey2, \ncount_big(*) as bigcount \nfrom\ntable1\ngroup by\nkey1, \nkey2, \nGO\n\n\nCREATE UNIQUE CLUSTERED INDEX [PX_vw_indexed1] ON [dbo].[vw_indexed1] \n(\nkey1, \nkey2, \n)WITH \n(PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = ON, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\nGO\n</code></pre>\n\n<p>Now, when I go <code>select * from vw_indexed1</code> it takes ages, presumably because it is trying to expand the indexes in the underlying table, so I would then use <code>select * from vw_indexed1 with (noexpand)</code>, which performs just like a select directly on a table with a clustered index.</p>\n\n<p>My question is this: if I use this view as the DSV for a SSAS project, is it going to try to use the underlying indexes every time? And if so, how can I force it to consider <code>vw_indexed1</code> as a table with its own indexes?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13220322,"title":"Is there a way in SQL to determine if certain days are in the same week?","body":"<p>I have the following table 'Schedule' in my database:</p>\n\n<pre><code>**Schedule**\nPK Weekday (ie., November 11, 2012)\nPK Punch-In (ie., 1:00 PM)\nPK Punch-Out (ie., 9:00 PM)\n</code></pre>\n\n<p>I am tasked with totaling the number of hours worked per week.</p>\n\n<p>For my example Sunday is Day 1 of the week and Saturday is Day 7.</p>\n\n<p>My question is how do I determine which days are in a \"week.\" Is there an SQL command for this? In other words, how do I determine if November 10 is the same week as November 11.</p>\n"},{"tags":["sql","oracle","plsql","overloading","plsqldeveloper"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":48,"score":1,"question_id":13217166,"title":"overloading procedure in package","body":"<p>Below is the HEADER for the Package TASK5</p>\n\n<pre><code>CREATE OR REPLACE PACKAGE TASK5 \n    AS \nPROCEDURE  TASK5APROCEDURE ( \nREG_NO  IN  NUMBER,\nCERT_TITLE   OUT  VARCHAR2,\nE_DATE     OUT DATE,\n    C_MARKS OUT INTEGER);\n\n\nPROCEDURE  TASK5BPROCEDURE ( \nCERT_ID  IN  CHAR, \nC_T OUT CHAR) ;    \n\n END TASK5;\n</code></pre>\n\n<p>The BODY for the PACKAGE TASK5 </p>\n\n<pre><code>CREATE OR REPLACE PACKAGE BODY TASK5 \nAS \n\n\n PROCEDURE    TASK5APROCEDURE ( \n    REG_NO  IN  NUMBER,\n    CERT_TITLE   OUT  VARCHAR2,\n    E_DATE     OUT DATE,\n    C_MARKS OUT INTEGER)\n            IS\n            BEGIN\n\nSELECT \n    O.PCP_TITLE, \n    C.CERT_EXAMDATE, \n    C.CERT_MARKS \n\nINTO  \n    CERT_TITLE, \n    E_DATE, \n    C_MARKS\n\nFROM \n    PROFCERTPROGRAM O\nINNER JOIN \nCERTIFICATION C\n    ON O.PCP_ID = C.PCP_ID\nWHERE \n    C.S_REGNO LIKE REG_NO;\nEXCEPTION\n               WHEN NO_DATA_FOUND\nTHEN \n                  DBMS_OUTPUT.PUT_LINE('NO DATA FOUND');\n\n\nEND TASK5APROCEDURE;\n\n\nPROCEDURE    TASK5BPROCEDURE ( \nCERT_ID  IN  CHAR, C_T OUT CHAR)\n            IS\n    BEGIN\n\nDBMS_OUTPUT.PUT_LINE ('COURSE NAMES: ');\n\nFOR R IN (  \n    SELECT O.C_TITLE C_T\nFROM \n    COURSE O\nINNER JOIN \nCERTIFICATIONREQUIREMENT C\n    ON O.C_ID = C.C_ID\nWHERE \n    C.PCP_ID LIKE '%'||CERT_ID||'%')\n\nLOOP\n        DBMS_OUTPUT.PUT_LINE (R.C_T);\nEND LOOP ;\n\nEND TASK5BPROCEDURE;\n\nEND TASK5;\n</code></pre>\n\n<p>I wrote the package with two different procedure for 2 different input. \nBut, I want to rewrite the header and body with overloading procedure, any suggestions? </p>\n"},{"tags":["php","sql","select"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":61,"score":-1,"question_id":13212235,"title":"Combine Update and Select statments","body":"<p>I am using the following code to display stores and select one store works fine but I want to tune it a bit so I need some help on how to:</p>\n\n<pre><code>class ModelCatalogWinkel extends Model { \n    public function getWinkel($store_id) { \n        $query = $this-&gt;db-&gt;query(\"UPDATE store SET url='' = SELECT * FROM \" . DB_PREFIX . \"store WHERE store_id = '\" . $store_id . \"'\"); \n    if ($query-&gt;num_rows) {\n    return $query-&gt;row; \n    } else {\n    return false;\n    } }\n\n    public function getAllWinkel() {\n    $query = $this-&gt;db-&gt;query(\"SELECT * FROM \" . DB_PREFIX . \"store ORDER BY name DESC\");   \n    return $query-&gt;rows;\n    }}\n</code></pre>\n\n<p>==============</p>\n\n<p>Now I would like to add these 2 queries to the above script but I do not know how to combine update as a 1st time every time I select one store. </p>\n\n<ol>\n<li><code>UPDATE store SET url='';</code></li>\n<li><code>Update store SET url = 'http://localhost/mysite/' where name ='$store_id';</code></li>\n</ol>\n\n<p>I would like to clean the column url and update the url before I select the store-id.</p>\n\n<hr>\n\n<p>Table has 3 fields (based on opencart) </p>\n\n<pre><code>store_id, Name and url \n1         Store_1  (empty)\n2         Store_2  (empty)\n3         Store_3  [mysite]\n4         Store_4  (empty)\n5         Store_5  (empty)\n</code></pre>\n\n<p>I can have 100's of stores but the url is always the same, so what I want to do is every time I select one store from list, it should first get the column url cleaned ==> after that it should add the [mysite] to the selected store only and it opens the home page [index.php?route=common/home]. Why I do this because opencart always open the 1st record when they have all the same URL. This is a work around I see to open any store from the list. But I do not know what is the best a approach===>  to have the 3 queries in one or create 3 public functions. When I say the 3 queries I mean the  </p>\n\n<pre><code>public function getWinkel($store_id) { \n    $query = $this-&gt;db-&gt;query(\"UPDATE store SET url='' = SELECT * FROM \" . DB_PREFIX . \"store WHERE store_id = '\" . $store_id . \"'\");  \n    if ($query-&gt;num_rows) { \n    return $query-&gt;row; } else { return false; \n    } }\n</code></pre>\n\n<p></p>\n\n<pre><code>query(\" UPDATE store SET url=''\");\n</code></pre>\n\n<p></p>\n\n<pre><code>query (\"Update store Set url = '[mysite]' where store_id = '\" . $store_id . \"'\")\n</code></pre>\n"},{"tags":["c#","sql","sql-server","sql-server-2008","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":13216924,"title":"How can i update another tables after adding record to a table in sql server 2008","body":"<p>I have two same tables created in SQL Server 2008.</p>\n\n<p>What I need is:</p>\n\n<p><strong>Add the newest data inserted in <code>table1</code> into <code>table2</code>.</strong></p>\n\n<p>Is that possible? </p>\n\n<p>Something like services or triggers or stored procedures?</p>\n\n<p>I think that I have to use triggers, but I don't know how.</p>\n\n<p>I have these two tables:</p>\n\n<pre><code>table1  ( field1,field2,field3 )\ntable2  ( field1,field2,field3 )\n</code></pre>\n\n<p>when i insert into table1 i need table2 to be updated as the procedure below:    </p>\n\n<pre><code>&gt; IF NotExist(field1=value) in table2 THEN INSERT Into table2 ELSE UPDATE table2\n&gt; with new field1 value.\n</code></pre>\n"},{"tags":["sql","database","programming-techniques","technology-choice","tidesdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13209958,"title":"Best way for storing shared contents between different kind of apps","body":"<p>We are starting a new project in my company and I would like to get some opinions on what you think is the best way to go.</p>\n\n<p>There are 3 apps involved: 1 desktop app, an online app (accessible through the browser) and mobile apps, and all of them share most of their contents (text contents basically). Actually they will be quite similar.</p>\n\n<p>We will start with the desktop app. My approach is using TideSDK for developing it and using SQLite for storing those contents that are the same in all apps. This will save us time when we have to use that information for the browser app and for the mobile app although we will probabilly have to migrate from SQLite to mySQL when developing the \"big\" ones. I am thinking in a RESTful web service at this point.</p>\n\n<p>My main question here is, what do you think it is the best way for storing these contents in the database? I'm thinking on having just HTML snippets so that I can embed them on the different apps, but not sure wether using a JSON might be better.</p>\n\n<p>I hope it is clear enough... If any question, let me know. Your opinions will be of great help.</p>\n\n<p>Thanks in advance!</p>\n"}]}
{"total":102599,"page":11,"pagesize":100,"questions":[{"tags":["c#","sql","sql-server","sql-server-2008","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":13216924,"title":"How can i update another tables after adding record to a table in sql server 2008","body":"<p>I have two same tables created in SQL Server 2008.</p>\n\n<p>What I need is:</p>\n\n<p><strong>Add the newest data inserted in <code>table1</code> into <code>table2</code>.</strong></p>\n\n<p>Is that possible? </p>\n\n<p>Something like services or triggers or stored procedures?</p>\n\n<p>I think that I have to use triggers, but I don't know how.</p>\n\n<p>I have these two tables:</p>\n\n<pre><code>table1  ( field1,field2,field3 )\ntable2  ( field1,field2,field3 )\n</code></pre>\n\n<p>when i insert into table1 i need table2 to be updated as the procedure below:    </p>\n\n<pre><code>&gt; IF NotExist(field1=value) in table2 THEN INSERT Into table2 ELSE UPDATE table2\n&gt; with new field1 value.\n</code></pre>\n"},{"tags":["sql","database","programming-techniques","technology-choice","tidesdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13209958,"title":"Best way for storing shared contents between different kind of apps","body":"<p>We are starting a new project in my company and I would like to get some opinions on what you think is the best way to go.</p>\n\n<p>There are 3 apps involved: 1 desktop app, an online app (accessible through the browser) and mobile apps, and all of them share most of their contents (text contents basically). Actually they will be quite similar.</p>\n\n<p>We will start with the desktop app. My approach is using TideSDK for developing it and using SQLite for storing those contents that are the same in all apps. This will save us time when we have to use that information for the browser app and for the mobile app although we will probabilly have to migrate from SQLite to mySQL when developing the \"big\" ones. I am thinking in a RESTful web service at this point.</p>\n\n<p>My main question here is, what do you think it is the best way for storing these contents in the database? I'm thinking on having just HTML snippets so that I can embed them on the different apps, but not sure wether using a JSON might be better.</p>\n\n<p>I hope it is clear enough... If any question, let me know. Your opinions will be of great help.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","sql-server","join","distinct"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13219582,"title":"SQL Query - Combine DISTINCT and TOP?","body":"<p>I have the following query I want to fire:</p>\n\n<pre><code>SELECT DISTINCT TOP(5) fp.PostId FROM dbForumPosts fp\nLEFT JOIN dbForumEntry fe ON fp.PostId = fe.PostId\nOrder by fe.Datemade DESC\n</code></pre>\n\n<p>However, when I fire it, I get the error:</p>\n\n<pre><code>Msg 145, Level 15, State 1, Line 1\nORDER BY items must appear in the select list if SELECT DISTINCT is specified.\n</code></pre>\n\n<p>I tried to change the query, so it used GROUP BY instead, but then I have the following problem:</p>\n\n<pre><code>Msg 8127, Level 16, State 1, Line 4\nColumn \"dbForumEntry.Datemade\" is invalid in the ORDER BY clause because it is not contained in either an aggregate function or the GROUP BY clause.\n</code></pre>\n\n<p><strong>WHAT DO I WANT:</strong></p>\n\n<p>Think of this as a forum. There are posts (dbForumPosts) and entries (dbForumEntry). There are 0-many entries pr post.</p>\n\n<p>What I want is to the get posts with the most recent activity (posts with the latest updated entries in).</p>\n"},{"tags":["sql","database","oracle","database-design","audit"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13218873,"title":"General database design - can I reference field names in other tables","body":"<p>I have a table with various fields that can be updated.  Let's called it <code>table1</code> and assume it has these fields:</p>\n\n<pre><code>user VARCHAR2\nfirst_name VARCHAR2\nlast_name VARCHAR2\n</code></pre>\n\n<p>My question: I want to keep track of edits to these fields.  I have an application that allows these fields to be updated but I want to keep track of <em>when</em> a field is edited, <em>who</em> edited the field and <em>which</em> field was edited - the <em>which</em> is the bit I need help with.</p>\n\n<p>I could have a history table:</p>\n\n<pre><code>date_edited DATE\nwho_edited VARCHAR2\nfield_name_edited VARCHAR2\n</code></pre>\n\n<p>what if the field name got changed though?.. It would mean that <code>field_name_edited</code> would refer to a non-existent field.  This seems like a silly approach.</p>\n\n<p>There must be some common way of doing this sort of thing?</p>\n\n<p>Many thanks.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am using an Oracle DB - see new question tags.</p>\n"},{"tags":["php","sql","query","orm","kohana"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13219599,"title":"Kohana is not loading the result rows?","body":"<p>if i try to load a result with Kohana ORM, the query is correct, but the result is empty. If i copy the Query and use it in phpmyadmin, i receive 2 rows.</p>\n\n<p>This is the Kohana Code (ORM)</p>\n\n<pre><code>        // DB work\n        $ftps = ORM::factory('ftp');\n\n        // if we activate many (we load only ready)\n        if ($this-&gt;request-&gt;param('mode') == 'activate') {\n            $ftps-&gt;where('ready', '=', '1');\n\n        // if we activate many (we load only ready)\n        } elseif ($this-&gt;request-&gt;param('mode') == 'not_ready') {\n            $ftps-&gt;where('ready', '=', '0');\n        }\n\n        // DB work\n        $ftps-&gt;and_where('activated', '=', '0')\n             -&gt;order_by('lastcheck', 'ASC')\n             -&gt;limit(intval($post['number']))\n             -&gt;find_all();\n</code></pre>\n\n<p>This is the SQL Query (Debug) </p>\n\n<pre><code>SELECT `ftp`.* FROM `ftps` AS `ftp` WHERE `activated` = '0' ORDER BY `lastcheck` ASC LIMIT 100 (1)\n</code></pre>\n\n<p>Why is Kohana not able to load the same results like phpmyadmin does? It's the same query. I don't find a solution.</p>\n\n<p>Thank you for your help</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13219260,"title":"Determine values that are present in only one of two tables, or in both of them","body":"<p>I have two tables in a SQL Server 2008 database in which I want to find:</p>\n\n<ul>\n<li>values present in both tables (with all columns present in both tables)</li>\n<li>values present in first table but not in second table</li>\n<li>values present in second table but not in first table</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>CREATE TABLE #_temp\n(ATM INT, Fault INT)\n\nCREATE TABLE #_temp1\n(ATM INT, Fault INT)\n\nINSERT INTO #_temp  VALUES (10,101), (11,101), (12,101), (12,101), (10,105), (13,101)\nINSERT INTO #_temp1 VALUES (10,102), (11,101), (12,103), (12,100), (10,105), (13,101)\n\n/* My Try\n\nSELECT * FROM #_temp t RIGHT JOIN #_temp1 t1 ON t.ATM=t1.ATM AND t.Fault=t.Fault AND t.ATM IS NULL AND t.Fault IS NULL\n\nSELECT * FROM #_temp t JOIN #_temp1 t1 ON t.ATM=t1.ATM AND t.Fault=t.Fault\n\n*/\n\nDROP Table #_temp\nDROP Table #_temp1 \n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13218892,"title":"SQL Server: +(unary) operator on non-numeric Strings","body":"<p>I am surprised! This statement below is valid in <code>SQL SERVER</code>:</p>\n\n<pre><code>SELECT  +'ABCDEF'\n</code></pre>\n\n<p>Has <code>SQL Server</code> defined <code>+</code> as a <code>Unary</code> operator for string types?</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13219113,"title":"Import from excel to sql format error","body":"<p>hi I am trying to load data into sql from an excel spreadsheet from a web page, I am getting a  \"Cannot implicitly convert type '<code>string</code>' to '<code>decimal</code>\" error I have tried different ways to correct this but nothing is working.</p>\n\n<pre><code>namespace CarpartsStore.Dealers\n{\n\npartial class DealerHome : System.Web.UI.Page\n{\n\n    protected void ButtonUpload_Click(object sender, System.EventArgs e)\n    {\n        PanelUpload.Visible = true;\n        PanelView.Visible = false;\n        PanelImport.Visible = false;\n    }\n\n\n    protected OleDbCommand ExcelConnection()\n    {\n\n        // Connect to the Excel Spreadsheet\n        string xConnStr = \"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=\" + Server.MapPath(\"~/ExcelImport.xls\") + \";\" + \"Extended Properties=Excel 8.0;\";\n\n        // create your excel connection object using the connection string\n        OleDbConnection objXConn = new OleDbConnection(xConnStr);\n        objXConn.Open();\n\n        // use a SQL Select command to retrieve the data from the Excel Spreadsheet\n        // the \"table name\" is the name of the worksheet within the spreadsheet\n        // in this case, the worksheet name is \"Members\" and is coded as: [Members$]\n        OleDbCommand objCommand = new OleDbCommand(\"SELECT * FROM [Products$]\", objXConn);\n        return objCommand;\n\n\n\n    }\n\n    protected void ButtonView_Click(object sender, System.EventArgs e)\n    {\n        PanelUpload.Visible = false;\n        PanelView.Visible = true;\n        PanelImport.Visible = false;\n\n        // Create a new Adapter\n        OleDbDataAdapter objDataAdapter = new OleDbDataAdapter();\n\n        // retrieve the Select command for the Spreadsheet\n        objDataAdapter.SelectCommand = ExcelConnection();\n\n        // Create a DataSet\n        DataSet objDataSet = new DataSet();\n        // Populate the DataSet with the spreadsheet worksheet data\n        objDataAdapter.Fill(objDataSet);\n\n        // Bind the data to the GridView\n        GridViewExcel.DataSource = objDataSet.Tables[0].DefaultView;\n        GridViewExcel.DataBind();\n    }\n\n\n    protected void ButtonImport_Click(object sender, System.EventArgs e)\n    {\n        PanelUpload.Visible = false;\n        PanelView.Visible = false;\n        PanelImport.Visible = true;\n        LabelImport.Text = \"\";\n        // reset to blank\n\n        // retrieve the Select Command for the worksheet data\n        OleDbCommand objCommand = new OleDbCommand();\n        objCommand = ExcelConnection();\n\n        //  create a DataReader\n        OleDbDataReader reader;\n        reader = objCommand.ExecuteReader();\n\n\n        //  create variables for the spreadsheet columns\n        int ProductID = 0;\n        int MakeID = 0;\n        int DealerID = 0;\n        string PartNumber = \"\";\n        string Description = \"\";\n        decimal UnitCost = 0.00M;\n        decimal Postage = 0.00M;\n        int QtyAvailable = 0;\n        string UserName = \"\";\n        string Make = \"\";\n\n\n        int counter = 0;\n        // used for testing your import in smaller increments\n\n        while (reader.Read())\n        {\n            counter = counter + 1;\n            // counter to exit early for testing...\n\n            // set default values for loop\n            ProductID = 0;\n            MakeID = 0;\n            DealerID = 0;\n\n\n\n            PartNumber = GetValueFromReader(reader,\"PartNumber\");\n            Description = GetValueFromReader(reader,\"Description\");\n\n\n            UnitCost = GetValueFromReader(reader,\"UnitCost\");\n            Postage = GetValueFromReader(reader, \"Postage\"); \n\n\n            QtyAvailable = GetValueFromReader(reader,\"QtyAvailable\");\n            UserName = GetValueFromReader(reader,\"UserName\");\n            Make = GetValueFromReader(reader,\"Make\");\n\n\n            // Insert any required validations here...\n\n            MakeID = GetMakeID(Make);\n            DealerID = GetDealerID(UserName); \n\n\n            //retrieve the MakeID\n            ProductID = ImportIntoProducts(PartNumber, Description, UnitCost, Postage, QtyAvailable, MakeID, DealerID);\n\n            LabelImport.Text = LabelImport.Text + ProductID + PartNumber + \" \" + Description + \" \" + UnitCost + \" \" + Postage + \" \" + QtyAvailable + \" \" + UserName + \" Make_id: \" + MakeID + \" \" + Make + \"&lt;br&gt;\";\n            //If counter &gt; 2 Then ' exit early for testing, comment later...\n            //    Exit While\n            //End If\n\n        }\n        reader.Close();\n\n    }\n\n\n\n    protected string GetValueFromReader(OleDbDataReader myreader, string stringValue)\n    {\n        object val = myreader[stringValue];\n        if (val != DBNull.Value)\n            return val.ToString();\n        else\n            return \"\";\n    }\n\n\n    protected void ButtonUploadFile_Click(object sender, System.EventArgs e)\n    {\n\n        if (FileUploadExcel.HasFile)\n        {\n\n\n            try\n            {\n                // alter path for your project\n\n                FileUploadExcel.SaveAs(Server.MapPath(\"~/ExcelImport.xls\"));\n                LabelUpload.Text = \"Upload File Name: \" +\n                    FileUploadExcel.PostedFile.FileName + \"&lt;br&gt;\" +\n                    \"Type: \" + FileUploadExcel.PostedFile.ContentType +\n                    \" File Size: \" + FileUploadExcel.PostedFile.ContentLength +\n                    \" kb&lt;br&gt;\";\n            }\n            catch (System.NullReferenceException ex)\n            {\n                LabelUpload.Text = \"Error: \" + ex.Message;\n            }\n        }\n        else\n        {\n            LabelUpload.Text = \"Please select a file to upload.\";\n        }\n\n    }\n\n\n\n    protected int GetMakeID(string MakeName)\n    {\n\n        int makeID = 0;\n        try\n        {\n            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.MakesTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.MakesTableAdapter();\n            SSSProductsDataSet.MakesDataTable SSDataTable = null;\n            SSDataTable = SSAdapter.GetMakeByName(MakeName);\n            // see if the category already exists in the table, if not insert it\n            if (SSDataTable != null)\n            {\n                if (SSDataTable.Rows.Count &gt; 0)\n                {\n                    if (SSDataTable[0].MakeID &gt; 0)\n                    {\n                        makeID = SSDataTable[0].MakeID;\n                    }\n                }\n            }\n            if (makeID == 0)\n            {\n                // if it is still 0, then insert it into the table\n                // retrieve the identity key category_id from the insert\n                makeID = (int)SSAdapter.InsertMakeQuery(MakeName);\n                // if this fails to return the proper category_id, make sure to \n                // set the InsertCategoryQuery ExecuteMode Property to Scalar\n            }\n            return makeID;\n        }\n        catch (System.NullReferenceException ex)\n        {\n            LabelImport.Text = LabelImport.Text + ex.Message;\n            return 0;\n        }\n\n    }\n\n    protected int GetDealerID(string UserName)\n    {\n\n        int DealerID = 0;\n        try\n        {\n            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.DealersTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.DealersTableAdapter();\n            SSSProductsDataSet.DealersDataTable SSDataTable = null;\n            SSDataTable = SSAdapter.GetDealersByUserName(UserName);\n            // see if the User already exists in the table, if not insert it\n            if (SSDataTable != null)\n            {\n                if (SSDataTable.Rows.Count &gt; 0)\n                {\n                    if (SSDataTable[0].DealerID &gt; 0)\n                    {\n                        DealerID = SSDataTable[0].DealerID;\n                    }\n                }\n            }\n            if (DealerID == 0)\n            {\n                // if it is still 0, then insert it into the table\n                // retrieve the identity key category_id from the insert\n                DealerID = 0;\n                // if this fails to return the proper category_id, make sure to \n                // set the InsertCategoryQuery ExecuteMode Property to Scalar\n            }\n            return DealerID;\n        }\n        catch (System.NullReferenceException ex)\n        {\n            LabelImport.Text = LabelImport.Text + ex.Message;\n            return 0;\n        }\n\n    }\n\n\n    protected int ImportIntoProducts(string PartNumber, string Description, decimal UnitCost, decimal Postage, int QtyAvailable, int MakeID, int DealerID)\n    {\n\n\n        // make sure values don't exceed column limits\n        PartNumber = Left(PartNumber, 50);\n        Description = Left(Description, 300);\n        UnitCost = Convert.ToDecimal(UnitCost);\n\n\n\n\n\n        int ProductID = 0;\n        try\n        {\n            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.ProductsTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.ProductsTableAdapter();\n            SSSProductsDataSet.ProductsDataTable SSDataTable = null;\n            SSDataTable = SSAdapter.GetProductsByPartNumberDealer(PartNumber, DealerID);\n            // see if the category already exists in the table, if not insert it\n            if (SSDataTable != null)\n            {\n                if (SSDataTable.Rows.Count &gt; 0)\n                {\n                    if (SSDataTable[0].ProductID &gt; 0)\n                    {\n                        ProductID = SSDataTable[0].ProductID;\n                        LabelImport.Text = LabelImport.Text + \"&lt;font color=blue&gt;PartNumber Found, Not Imported: \" + \" ID: \" + ProductID + \" \" + PartNumber + \" \" + Description + \"\" + UnitCost + \"\" + Postage + \".&lt;/font&gt;&lt;br&gt;\";\n                    }\n                }\n            }\n            if (ProductID == 0)\n            {\n                // if it is still 0, then insert it into the table\n                // retrieve the identity key ProductID from the insert\n                ProductID = Convert.ToInt32(SSAdapter.InsertProductQuery(PartNumber, Description,UnitCost, Postage, QtyAvailable, MakeID, DealerID));\n                LabelImport.Text = LabelImport.Text + \"&lt;font color=white&gt;Part Number Imported: \" + \" ID: \" + ProductID + \" \" + PartNumber + \" \" + Description + \" Cost: \" + UnitCost + \".&lt;/font&gt;&lt;br&gt;\";\n            }\n            return ProductID;\n        }\n        catch (System.NullReferenceException ex)\n        {\n            LabelImport.Text = LabelImport.Text + \"&lt;font color=red&gt;\" + ex.Message      + \"&lt;/font&gt;&lt;br&gt;\";\n            return 0;\n        }\n\n    }\n\n\n\n    // http://www.mgbrown.com/PermaLink68.aspx\n    public static string Left(string text, int length)\n    {\n        if (length &lt; 0)\n            throw new ArgumentOutOfRangeException(\"length\", length, \"length must be &gt; 0\");\n        else if (length == 0 || text.Length == 0)\n            return \"\";\n        else if (text.Length &lt;= length)\n            return text;\n        else\n            return text.Substring(0, length);\n\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["sql","web-applications","backbone.js","twitter-bootstrap","typeahead"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13219067,"title":"Backbone.js + Twitter Bootstrap","body":"<p>I have been trying to follow the guide at <a href=\"http://coenraets.org/directory/\" rel=\"nofollow\">http://coenraets.org/directory/</a></p>\n\n<p>I have the contents of the \"Web\" folder copied onto the root of my website and the page appears just fine, I also installed his sql script into my database. The search bar isn't working (probably since my SQL database requires a username and password?). How do I fix this?</p>\n"},{"tags":["c#",".net","sql","entity-framework","entity-framework-4.1"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":102,"score":3,"question_id":13122940,"title":"String preparation when calling stored procedure in Entity Framework","body":"<p>Actually, I have code that uses Entity Framework 4.1 in Visual Studio 2010. Everything is working fine except for one thing : it doesn't seem to \"prepare\" the parameters like a good old <code>[parameters.Add]</code> habitually did.</p>\n\n<p>Here's my code : </p>\n\n<pre><code>using (MyEnterprisesEntities dataContext = new \n                             MyEnterprisesEntities(entityBuilder.ToString()))\n{\n         dataContext.CompanyInitializer(connection.Catalog,\n                                        args.CompanyId,\n                                        args.CompanyName);\n}\n</code></pre>\n\n<p>So, if my company's name is <code>O'Brian and sons</code> (actually it passed before through a WCF web service so it's more in this form: <code>O\\'Brian and sons</code>), it's seem to break my stored procedure (including the possibility of allowing SQL injection).</p>\n\n<p>Is there a way to avoid this situation with EDMX or the old way is more reliable ? </p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13218851,"title":"SQL : Update ID; According to Date","body":"<p>I have Table below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/GpVhy.jpg\" alt=\"enter image description here\"></p>\n\n<p>I like to <em>Update</em> <code>ID</code> according to date and then by User. </p>\n\n<h3>For Example</h3>\n\n<p><img src=\"http://i.stack.imgur.com/oyzfU.jpg\" alt=\"enter image description here\"></p>\n\n<h3>Thanks</h3>\n"},{"tags":["sql","oracle","if-statement","plsql"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":13217600,"title":"IF EXISTS condition not working with PLSQL","body":"<p>I am trying to print the TEXT when condition is TRUE. The select code is perfectly working fine. It's showing 403 value when i only run select code. But I have to print some text when condition exists. What's the problem with following code.</p>\n\n<pre><code>BEGIN\nIF EXISTS(\nSELECT CE.S_REGNO FROM\nCOURSEOFFERING CO\nJOIN CO_ENROLMENT CE\n  ON CE.CO_ID = CO.CO_ID\nWHERE CE.S_REGNO=403 AND CE.COE_COMPLETIONSTATUS = 'C' AND CO.C_ID = 803\n)\nTHEN\n    DBMS_OUTPUT.put_line('YES YOU CAN');\nEND;\n</code></pre>\n\n<p>Here is the error report:</p>\n\n<pre><code>Error report:\nORA-06550: line 5, column 1:\nPLS-00103: Encountered the symbol \"JOIN\" when expecting one of the following:\n\n   ) , with group having intersect minus start union where\n   connect\n06550. 00000 -  \"line %s, column %s:\\n%s\"\n*Cause:    Usually a PL/SQL compilation error.\n*Action:\n</code></pre>\n"},{"tags":["sql","triggers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13219053,"title":"IF condition in trigger uses query","body":"<blockquote>\n  <p>order_placed(order_no,mess_id,...) rates(mess_id,student_id,rating)</p>\n</blockquote>\n\n<p>I want to create a trigger that checks if a mess's rating is less than 4 when an order is being placed, and if so, the order can't be placed.</p>\n\n<pre><code>CREATE TRIGGER new_order\nAFTER INSERT ON order_placed\nFOR EACH NEW ROW\nBEGIN\nIF((SELECT AVG(rating) FROM rates WHERE rates.mess_id = NEW.mess_id) &lt; 4)\nROLLBACK TRAN\nEND;\n</code></pre>\n\n<p>I'm getting an <code>ERROR 1064</code>.</p>\n"},{"tags":["php","mysql","sql","database","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13216196,"title":"Database relation of purchased items","body":"<p>I'm trying to come up with a database relation to keep track of purchased items that will be used for look up afterwards--for example ebooks. Ignore the ellipses--they represent miscellaneous data such as timestamp, etc...</p>\n\n<p>Here's the table I have right now:</p>\n\n<pre><code>purchased:\ntransaction_id(int)(pk)(auto_inc) | username (varchar) | purchases (text) | ...\n</code></pre>\n\n<p>In this design, the column \"purchases\" is just a string of text that would contain the item_id of items purchased, separated by commas. Simplified example: \"book1, book23, book5, book8\".</p>\n\n<p>In a successful transaction, this query would insert the transaction data into the \"purchased\" table:</p>\n\n<pre><code>INSERT INTO purchased VALUES (null, username, purchases, ...)\n</code></pre>\n\n<hr>\n\n<p>From this point on, two things can happen:     </p>\n\n<ol>\n<li>The user can lookup what ebooks they've purchased</li>\n<li>The user can make another purchase transaction.</li>\n</ol>\n\n<p>If the user (theusername) wants to see their ebooks, the system performs a selection query e.g.</p>\n\n<pre><code>SELECT purchases FROM purchased WHERE username=theusername\n</code></pre>\n\n<p>which returns a string containing the item IDs.</p>\n\n<p>One a sidenot, is it possible to get an php array of purchases without having to use extra php code, i.e. explode? <b>Can you use something besides the data type \"text\" in SQL to store a list of items?</b> If not, that's okay.</p>\n\n<hr>\n\n<p>Either way, here's the main problem. Say the user makes another transaction--there will now be two rows in \"purchased\" that contains the user's purchased items. That means that in this table, the user's purchases are split into multiple rows.</p>\n\n<p>Ideally, I want these purchases to all be in the same row. I can't use an UPDATE statement because each purchase has it's own unique transaction_id.</p>\n\n<p>I was thinking that I could make another table that contains all purchases by a user</p>\n\n<pre><code>all_purchased:\nusername (pk) | purchases (text) | ...\n</code></pre>\n\n<p>and whenever the user makes another transaction, the \"all_purchased\" table would just update its purchases column with the item ID of any new ebooks.</p>\n\n<p>But this table seems redundant because the selection query I mentioned would get the task done.</p>\n\n<p><b>What would be the best way to structure the database relation(s)?</b></p>\n"},{"tags":["c#","sql","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":13218012,"title":"Linq query fails if the data is too big","body":"<p>I have the following linq query</p>\n\n<pre><code>var result=from cases in db.Cases\n           join cc in db.CaseConsents on cases.CaseID equals cc.CaseID into cc_join\n           from cc in cc_join.DefaultIfEmpty()\n           where cc.ConsentTypeID == null &amp;&amp; cc.MidwireEyeBankID == 1\n           &amp;&amp; !((from casedeterminations in db.CaseDeterminations\n           where casedeterminations.DeterminationTypeID == 5\n           select new { casedeterminations.CaseID })).Distinct().Contains(new { cases.CaseID })\n           &amp;&amp; !(from casedeterminations2 in db.CaseDeterminations\n           where\n               (new int[] { 3, 4 }).Contains(casedeterminations2.DeterminationID)\n           select new\n           {\n               casedeterminations2.CaseID\n               }).Distinct().Contains(new { cases.CaseID })\n           select cc;\n</code></pre>\n\n<p>If this part of the query returns more than <code>50000</code> records then the whole query returns no result </p>\n\n<pre><code>(from casedeterminations2 in db.CaseDeterminations\nwhere\n(new int[] { 3, 4 }).Contains(casedeterminations2.DeterminationID)\nselect new\n{\n    casedeterminations2.CaseID\n}).Distinct().Contains(new { cases.CaseID })\n</code></pre>\n\n<p>this is the SQL version of this Linq query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select * from Cases\nleft outer join CaseConsent CC on CC.CaseID = Cases.CaseID \nwhere\nCases.CaseID NOT IN \n(SELECT distinct CaseID  FROM    CASEDETERMINATIONS WHERE   DETERMINATIONTYPEID = 5 )\nAND CC.ConsenttypeID IS NULL\nAND Cases.CaseID NOT IN \n( SELECT    CaseID FROM      CaseDeterminations WHERE     DeterminationID IN ( 3, 4 ) )\nAND Cases.MidwireEyeBankID = 1\n</code></pre>\n"},{"tags":["sql","oracle","oracle-xe"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":19505,"score":4,"question_id":531969,"title":"Oracle 10g express home page is not coming up","body":"<p>I installed Oracle 10g express. Installation went well, But the home page is not coming up.\nI can connect using sqlplus but not with Sql Developer. \nI checked tnsnames.ora and listener.ora everything looks fine.\nListener is also started. I can always reinstall and see. But I thought better inquire the cause.</p>\n\n<p>Regarding the home page. This is the address that comes up in browser. Localhost:8080\n<a href=\"http://127.0.0.1:8080/apex\" rel=\"nofollow\">http://127.0.0.1:8080/apex</a>\nI did a netstat to see whether there is any port conflict for 8080, but that port is not in use.</p>\n\n<p>Have anybody faced this issue?</p>\n"},{"tags":["sql","doctrine2","native-sql","customcolumn"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13218693,"title":"Doctrine 2: How can extend entity with sql code column?","body":"<p>I have entity</p>\n\n<pre><code>mh\\BTBundle\\Entity\\Post:\n    type: entity\n    table: post\n    repositoryClass: mh\\BTBundle\\Repository\\PostRepository\n    fields:\n        id:\n            id: true\n            type: integer\n            unsigned: true\n            nullable: false\n            generator:\n                strategy: IDENTITY\n        title:\n            type: string\n            length: 255\n            nullable: false\n        content:\n            type: text\n            nullable: false\n        isModered:\n            type: boolean\n            nullable: false\n        isPublished:\n            type: boolean\n            nullable: false\n        pubDate:\n            type: datetime\n            nullable: false\n</code></pre>\n\n<p>and now once at 1 minute cron call script, that set isPublished = true if post have isModered = true and pubDate &lt; :now. </p>\n\n<pre><code>$this-&gt;getEM()-&gt;createQueryBuilder()\n            -&gt;update('BTBundle:Post p')\n            -&gt;set('p.isPublished', 'true')\n            -&gt;where('p.pubDate &lt; :date AND p.isModered = true')\n            -&gt;setParameter(':date', new \\DateTime())\n            -&gt;getQuery()-&gt;execute();\n</code></pre>\n\n<p>But i whant to define custom column isPublished with return true if SQL (<code>p.pubDate &lt; CURDATE() AND p.isModered = 1</code>). How can i make it? </p>\n\n<p>i whant to use </p>\n\n<pre><code>$posts = $this-&gt;getRepository('Post')-&gt;findBy(array(\n            'user' =&gt; $user,\n            'isPublished' =&gt; true,\n        ));\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>$this-&gt;getEM()-&gt;createQueryBuilder()\n                -&gt;select('p')\n                -&gt;from('BTBundle:Post', 'p')\n                -&gt;where('p.isModered = true')\n                -&gt;andWhere('p.pubDate &lt; :date')\n                -&gt;andWhere('p.user = :user')\n                -&gt;setParameter(':date', new \\DateTime())\n                -&gt;setParameter(':user', $user)\n                -&gt;getQuery()-&gt;execute();\n</code></pre>\n"},{"tags":["python","sql","database","python-2.7","firebird"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":46,"score":-3,"question_id":13218115,"title":"AttributeError: Transaction instance has no attribute 'trans_handle'","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13210956/programmingerror-42s02-42s02-microsoft\">ProgrammingError: ‘42S02’, &#39;[42S02] [Microsoft]</a>  </p>\n</blockquote>\n\n\n\n<p>I wrote this programm which should insert record into a database</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\nconn=firebirdsql.create_database(host='localhost', database='D:/test2.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nconn.begin()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\"\"\"\ncur.execute(s)\nconn.commit()\ns=\"INSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Organization A')\"\nconn.begin()\ncur.execute(s)\nconn.commit()\nconn.close()\n</code></pre>\n\n<p>As a result, when you run, I got the following error that very much afflicted me</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:/ThirdTask/connectthree.py\", line 37, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 456, in _execute\n    self.transaction.trans_handle, query)\nAttributeError: Transaction instance has no attribute 'trans_handle'\n</code></pre>\n\n<p>In the following version of the program</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\nconn=firebirdsql.create_database(host='localhost', database='D:/test2.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\"\"\"\ncur.execute(s)\ns=\"INSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Organization A')\"\ncur.execute(s)\nconn.commit()\nconn.close()\n</code></pre>\n\n<p>I received the following mistake that very much afflicted me</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:/ThirdTask/connectthree.py\", line 35, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 457, in _execute\n    (h, oid, buf) = self.transaction.connection._op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 764, in _op_response\n    return self._parse_op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 308, in _parse_op_response\n    raise OperationalError(message, gds_codes, sql_code)\nOperationalError: Dynamic SQL Error\nSQL error code = -204\nTable unknown\nCLIENTS\nAt line 1, column 13\n</code></pre>\n"},{"tags":["python","sql","caching","redis","data-mining"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":75,"score":4,"question_id":12938274,"title":"A good blobstore / memcache solution","body":"<p>Setting up a data warehousing mining project on a Linux cloud server. The primary language is Python .</p>\n\n<p>Would like to use this pattern for querying on data and storing data:</p>\n\n<ul>\n<li><strong>SQL Database</strong> - SQL database is used to query on data. However, the SQL database stores only fields that need to be searched on, it does NOT store the \"blob\" of data itself. Instead it stores a key that references that full \"blob\" of data in the a key-value Blobstore. </li>\n<li><strong>Blobstore</strong> - A key-value Blobstore is used to store actual \"documents\" or \"blobs\" of data.</li>\n</ul>\n\n<p>The issue that we are having is that we would like more frequently accessed blobs of data to be automatically stored in RAM. We were planning to use Redis for this. However, we would like a solution that automatically tries to get the data out of RAM first, if it can't find it there, then it goes to the blobstore.</p>\n\n<p>Is there a good library or ready-made solution for this that we can use without rolling our own? Also, any comments and criticisms about the proposed architecture would also be appreciated.</p>\n\n<p>Thanks so much!</p>\n"},{"tags":["sql","vb.net","query","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13209090,"title":"No effect on rowstate after editing data in textbox binded to a binding source VB","body":"<p>I have a sql Query using join that fills the binding source</p>\n\n<pre><code>SELECT        \n  CustomerServiceLocation.id, \n  CustomerServiceLocation.custId, \n  CustomerServiceLocation.custSubId, \n  CustomerServiceLocation.locationId, \n\n  cust.firstNamePri, \n  cust.lastNamePri, \n  cust.phonePriPri, \n  cust.phoneAltPri, \n  cust.extPri, \n  cust.firstNameAlt, \n  cust.lastNameAlt, \n  cust.phonePriAlt, \n  cust.phoneAltAlt, \n  cust.extAlt, \n  cust.id AS Expr1, \n\n  location.custId AS Expr2, \n  location.city, \n  location.unitNum, \n  location.zip, \n  location.gated, \n  location.height, \n  location.code, \n  location.street, \n  location.email, \n  location.comments,\n  location.id AS Expr3 \nFROM            \n  CustomerServiceLocation \nINNER JOIN\n  Customer AS cust ON CustomerServiceLocation.custId = cust.id \nINNER JOIN\n  ServiceLocation AS location ON CustomerServiceLocation.locationId = location.id \nWHERE        \n  (CustomerServiceLocation.custSubId = @custId)\n</code></pre>\n\n<p>The query runs fine and the text boxes binded also display the corect information. When I edit datain text box and select save from navigation then the dataset shows no change in row state. This is the code I use behind the save button in navigation binder:</p>\n\n<pre><code>    Me.Validate()\n\n    Me.CustomerServiceLocationBindingSource.EndEdit()\n\n\n    Dim deletedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n    CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Deleted), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim newChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Added), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim modifiedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Modified), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n</code></pre>\n\n<p>But none of the variables show any changes in <code>deletedChildRecords</code>, <code>newChildRecords</code> &amp; <code>modifiedChildRecords</code></p>\n\n<p>Can anyone help me figure out what I am doing wrong.</p>\n\n<p>Thanks.</p>\n\n<p>UPDATE: if I make changes in fields that are part of CustomerServiceLocation table only those fields value are detected in getChanges and not the Joined tables fields. Can anyone explain how to get changes for joined tables fields that have been binded.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","web-applications","graph-algorithm","pagerank"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13218102,"title":"WebGraph storage in Relational Databases","body":"<p>How one can efficiently store the WebGraph in Relational databases such MySQL for playing with algorithms like PageRank? I think of creating two tables: one for URLs where only distinct URLs will be stored and another outgoing links table, for each url store its outgoing URL. Any ideas or any suggestions for efficient storage?</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13217679,"title":"SHOW TABLES only shows tables starting with a space mysql","body":"<p>I have some code that needs to get a list of all of the tables in a database with a certain column equaling a certain thing. However, using the <code>SHOW TABLES</code> MySQL code is only listing tables that start with a space. Here is my code...</p>\n\n<pre><code>$result = mysql_query(\"SHOW FULL TABLES IN `db`\") or die(\"Error: \" . mysql_error());\nwhile ($word = mysql_fetch_array($result)) {\n    $word = $word[0];\n    $sql = \"SELECT * FROM `db`.`$word` WHERE col='$val'\";\n    $result = mysql_query($sql, $con) or die(\"Error: \" . mysql_error());\n    while ($col = mysql_fetch_array($result)) echo \"&lt;li&gt;&lt;a nav='$word' title='View $word'&gt;$word&lt;/a&gt;&lt;/li&gt;\";\n}\n</code></pre>\n\n<p>For some reason, the first <code>mysql_query()</code> is only returning one result, which happens to be a table beginning with a space. (It is the only table starting with a space in the whole thing)\nEdit: I just realized that I left out the line of code that turned $word from an array into a string... it's in there now.</p>\n"},{"tags":["sql","ms-access","delete"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13217716,"title":"How to delete all record on all table with SQL (1 time) (MS ACCESS)","body":"<p>I have 14 table in 1 file of ms access.</p>\n\n<p>I want to delete all record on these table on one time.</p>\n\n<p>I try with </p>\n\n<pre><code>DELETE FROM table1\nDELETE FROM table2\nDELETE FROM table3\n...\nDELETE FROM table12\nDELETE FROM table13\nDELETE FROM table14\n</code></pre>\n\n<p>and run it.</p>\n\n<p>But Can not to run</p>\n\n<p>How to do it ?\nThank you\nps.Sorry for bad english</p>\n"},{"tags":["sql","database","query","select"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13217069,"title":"Using max() in SQL","body":"<p>One part of my homework assignment is to find the student with the highest average from each department. </p>\n\n<p>QUERY: </p>\n\n<pre><code>SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\nFROM studentgrades g, student s\nWHERE g.sid = s.sid\nGROUP BY s.sid\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>1   Robert  ger 80.0000\n2   Julie   sta 77.0000\n3   Michael csc 84.0000\n4   Julia   csc 100.0000\n5   Patric  csc 86.0000\n6   Jill    sta 74.5000\n</code></pre>\n\n<p>To answer The question, I ran the query </p>\n\n<pre><code>SELECT dcode, averages.sfirstName, MAX(averages.average)\nFROM (\n    SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\n    FROM studentgrades g, student s\n    WHERE g.sid = s.sid\n    GROUP BY s.sid) averages\nGROUP BY dcode\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>csc Michael 100.0000\nger Robert  80.0000\nsta Julie   77.0000\n</code></pre>\n\n<p>Even though the averages are correct, the names are not!\nJulia is the one who has the average 100 in csc, so why does Michael show up?</p>\n\n<hr>\n\n<p>Here's an example:</p>\n\n<p>a student takes courses and gets grades for these courses. EG:</p>\n\n<pre><code>student1 from dept1 took course A and got grade 80\nstudent1 from dept1 took course B and got grade 90\nstudent2 from dept1 took course C and got grade 100\nstudent3 from dept2 took course X and got grade 90\n</code></pre>\n\n<p>AFTER RUNNING THE FIRST QUERY we get the averages for each student</p>\n\n<pre><code>student 1 from dept1 has average 85\nstudent 2 from dept1 has average 100\nstudent 3 from dept2 has average 90\n</code></pre>\n\n<p>Now we find the student with the highest average from each department</p>\n\n<pre><code>dept1, student2, 100\ndept2, student3, 90\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":212,"score":8,"question_id":12315573,"title":"How to write Oracle query to find a total length of possible overlapping from-to dates","body":"<p>I'm struggling to find the query for the following task</p>\n\n<p>I have the following data and want to find the total network day for each unique ID</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   03-Sep-12   07-Sep-12   5\n1   03-Sep-12   04-Sep-12   2\n1   05-Sep-12   06-Sep-12   2\n1   06-Sep-12   12-Sep-12   5\n1   31-Aug-12   04-Sep-12   3\n2   04-Sep-12   06-Sep-12   3\n2   11-Sep-12   13-Sep-12   3\n2   05-Sep-12   08-Sep-12   3\n</code></pre>\n\n<p>Problem is the date range can be overlapping and I can't come up with SQL that will give me the following results</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   31-Aug-12   12-Sep-12   9\n2   04-Sep-12   08-Sep-12   4\n2   11-Sep-12   13-Sep-12   3\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>ID  Total Network Day\n1   9\n2   7\n</code></pre>\n\n<p>In case the network day calculation is not possible just get to the second table would be sufficient.</p>\n\n<p>Hope my question is clear</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008","full-text-search"],"answer_count":4,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":9953,"score":10,"question_id":6003240,"title":"Cannot use a CONTAINS or FREETEXT predicate on table or indexed view because it is not full-text indexed","body":"<p>I am getting following error in my SQL server 2008 R2 database:</p>\n\n<blockquote>\n  <p>Cannot use a <code>CONTAINS</code> or <code>FREETEXT</code> predicate on table or indexed view 'tblArmy' because it is not full-text indexed.</p>\n</blockquote>\n"},{"tags":["python","sql","database","ms-access","firebird"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":68,"score":-1,"question_id":13216539,"title":"Error in INSERT query : Table unknown","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13210956/programmingerror-42s02-42s02-microsoft\">ProgrammingError: ‘42S02’, &#39;[42S02] [Microsoft]</a>  </p>\n</blockquote>\n\n\n\n<p>I wrote the program which on a descriptor (to a database, containing structure of a database Northwind - in the separate tables, containing the list of tables, indexes, restrictions, domains) databases Northwind builds it in Firebird. Then I am connected to the database Northwind (Access) and I want to copy by means of inquiry sql contents of tables of a database Northwind (Access) in tables of the created identical Firebird database.</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\ncon = sqlite3.connect('borey.db')\nsampling_tables=con.cursor()\nsampling_fields=con.cursor()\nsampling_constraints=con.cursor()\nsampling_constraints_fields=con.cursor()\nsampling_indices=con.cursor()\nsampling_indices_fields=con.cursor()\nsampling_indices_props=con.cursor()\nsampling_fields_from_constraints=con.cursor()\njs=[]\n\nsampling_tables.execute(sql.sqltables)\n\nfor table in sampling_tables:\n    tabledict=dict(inform_about_table='?', fields='?', constraints='?', indices='?')\n    information_about_table_dict=dict(name=table[1], description=table[2], can_add=table[3], can_edit=table[4], can_delete=table[5])\n    #print(js_information_about_table)\n    tabledict['inform_about_table']=information_about_table_dict\n    #print(tabledict)\n    table_id=table[0]\n    sampling_fields.execute(sql.sqlfields,(table_id,))\n    listfields=[]\n    for field in sampling_fields:\n        fielddict=dict(position=field[0], name=field[1], description=field[2], datatype=field[3], char_length=field[4], can_input=field[5], can_edit=field[6], show_in_grid=field[7],\n                      is_mean=field[8], autocalculated=field[9], required=field[10])\n        listfields.append(fielddict)\n    tabledict['fields']=listfields\n    #print(tabledict)\n    sampling_constraints.execute(sql.sqlconstraints,(table_id,))\n    listconstraints=[]\n    for constraint in sampling_constraints:\n        constraintdict=dict(name=constraint[1], constrtype=constraint[2], items='?', reference=constraint[3])\n        sampling_constraints_fields.execute(sql.sql_constr_det,(constraint[0],table_id))\n        listitems=[]\n        for constr_det in sampling_constraints_fields:\n            listitems.append(constr_det[0])\n        constraintdict['items']=listitems\n        listconstraints.append(constraintdict)\n    tabledict['constraints']=listconstraints\n    #print(tabledict)\n    sampling_indices.execute(sql.sqlindices,(table_id,))\n    listindices=[]\n    for index in sampling_indices:\n        indexdict=dict(name=index[1], items='?', position='?', props='?')\n        index_id=index[0]\n        sampling_indices_fields.execute(sql.sql_indices_fields,(table_id,index_id))\n        #sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id, ))\n        listfields=[]\n        listpositions=[]\n        listprops=[]\n        for index_det in sampling_indices_fields:\n            listfields.append(index_det[0])\n            listpositions.append(index_det[1])\n            fieldinindex=index_det[0]\n        sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id,fieldinindex))            \n        for index_desc in sampling_indices_props:\n            listprops.append(index_desc[0])\n        indexdict['items']=listfields\n        indexdict['position']=listpositions\n        indexdict['props']=listprops\n        listindices.append(indexdict)\n    tabledict['indices']=listindices\n    #print(tabledict)\n    js.append(tabledict)\nos.remove('D:/boreas.fdb')\nconn=firebirdsql.create_database(host='localhost', database='D:/boreas.fdb', user='sysdba', password='masterkey')\n#conn=firebirdsql.connect(host='localhost',database='D:/ThirdTask/test.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nfor nametable in js:\n    s=''\n    s+='create table '+nametable['inform_about_table']['name']+'\\n'\n    s+='('+'\\n'\n    countfield=0\n    for namefield in nametable['fields']:\n        s+='   '\n        if namefield['name']=='COUNT':\n            s+='QUANTITY'\n        else:\n            if namefield['name']=='MINIMUM QUANTITY FOR ORDER REPETITION':\n                s+='MINIMUM_QUANTITY'\n            else:\n                if namefield['name']=='PRICE ACCORDING TO THE PRICE-LIST':\n                    s+='LIST_PRICE'\n                else:\n                    if (namefield['name'].count(' ')!=0) or (namefield['name'].count('-')!=0) or (namefield['name'].count('/')!=0):\n                        s+='\"'+namefield['name']+'\"'\n                    else:                    \n                        s+=namefield['name']\n        if namefield['datatype']=='FMTBCD':\n            s+='   '+' INTEGER NOT NULL'\n        else:\n            if namefield['datatype']=='STRING': \n                s+='   '+'VARCHAR'\n            else:\n                if namefield['datatype']=='MEMO':\n                    s+='   '+'BLOB SUB_TYPE 1'\n                else:            \n                    if namefield['datatype']=='LARGEINT':\n                        s+='   '+'INTEGER'\n                    else:\n                        if namefield['datatype']=='SMALLINT':\n                            s+='   '+'INTEGER'\n                        else:\n                            if namefield['datatype']=='CURRENCY':\n                                s+='   '+'NUMERIC(18,2)'\n                            else:\n                                if namefield['datatype']=='BOOLEAN':\n                                    s+='   '+'INTEGER'\n                                else:    \n                                    s+='   '+namefield['datatype']           \n        if namefield['datatype']=='STRING':\n            s+='('+str(namefield['char_length'])+')'\n        countfield+=1\n        #if countfield!=len(nametable['fields']):\n        s+=','+'\\n'\n        #else:\n            #s+='\\n'\n            #s+='\\n'\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='PRIMARY':\n            s+='   CONSTRAINT '+nameconstraint['name']+ ' PRIMARY KEY('\n            countfieldinconstr=0\n            for namefield in nameconstraint['items']:\n                countfieldinconstr+=1\n                if countfieldinconstr!=len(nameconstraint['items']):\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+','\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+','\n                            else:    \n                                s+=namefield+','\n                else:\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+')'+'\\n'\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+')'+'\\n'\n                            else:       \n                                s+=namefield+')'+'\\n'\n    s+=');'+'\\n'\n    print s\n    cur.execute(s)\n    #conn.commit()\n    #conn.begin()\n    for nameindex in nametable['indices']:\n        #print 'nameidex[props] ', nameindex['props']\n        s=''\n        for prop in nameindex['props']:\n            if prop==0:\n                if (nameindex['name'].count(' ')!=0) or (nameindex['name'].count('-')!=0) or (nameindex['name'].count('/')!=0):\n                    s+='create ascending index \"'+nameindex['name'] + '\" on '+nametable['inform_about_table']['name']+' ('\n                else:\n                    if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_INVENTORY_ID':\n                        s+='create ascending index ' + 'IDX_INVENTORY_ID' + ' on '+nametable['inform_about_table']['name']+' ('\n                    else:\n                        if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_ORDERDETAILS':\n                            s+='create ascending index ' + 'IDX_ORDERDETAILS' + ' on '+nametable['inform_about_table']['name']+' ('\n                        else:    \n                            if nameindex['name'].count('INFORMATION_ABOUT_ORDER_')!=0:\n                                s+='create ascending index ' + nameindex['name'][1:4]+nameindex['name'][-len(nameindex['name'])+28:] + ' on '+nametable['inform_about_table']['name']+' ('\n                            else:\n                                s+='create ascending index '+nameindex['name'] + ' on '+nametable['inform_about_table']['name']+' ('\n            countitem=0\n            for nameitem in nameindex['items']:\n                if countitem!=len(nameindex['items'])-1:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+', '\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+', '\n                            else:  \n                                s+=nameitem+', '\n                else:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+');'+'\\n'\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+');'+'\\n'\n                            else:  \n                                s+=nameitem+');'+'\\n'\n                countitem+=1\n        print s\n        cur.execute(s)\n        #conn.commit()\nfor nametable in js:\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='FOREIGN':\n            s=''\n            s+='ALTER TABLE '+nametable['inform_about_table']['name']+'\\n'\n            s+='  '+'ADD CONSTRAINT '+nameconstraint['name']+' FOREIGN KEY ('  \n            for namefield in nameconstraint['items']:\n                if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                    s+='\"'+namefield+'\")'+'\\n'\n                else:\n                    s+=namefield+')'+'\\n'\n            s+='      '+'REFERENCES '+nameconstraint['reference']\n            sampling_fields_from_constraints.execute(sql.sql_fields, (nameconstraint['reference'],))\n            for fields in sampling_fields_from_constraints:\n                field=fields[0]\n                if (field.count(' ')!=0) or (field.count('-')!=0) or (field.count('/')!=0):\n                    s+=' (\"'+field+'\");'+'\\n'\n                else:\n                    s+=' ('+field+');'+'\\n'\n            print s\n            cur.execute(s)\n            #conn.commit()            \n#conn.commit()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID   INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"    VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB\n);\n\"\"\"\ns1='create ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);'\n\"\"\"db = 'D:/ThirdTask/Northwind.accdb' \nconnaccess = win32com.client.Dispatch(r'ADODB.Connection')\nDSN = ('PROVIDER = Microsoft.Jet.OLEDB.4.0;DATA SOURCE = ' + db +  ';') \nconnaccess.Open(DSN) \nrs = win32com.client.Dispatch(r'ADODB.Recordset') \nstrsql = \"select * from deer\" \nrs.Open(strsql, conn, 1, 3) \nt = rs.GetRows() \nconnaccess.Close() \n\"\"\"\nconAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nSqlAccess.execute(sql.sql_count_records_clients);\nCountOfRecords=SqlAccess.fetchone()[0];\nprint CountOfRecords\nid=0\nwhile id&lt;CountOfRecords:\n    id+=1\n    SqlAccess.execute(sql.sql_allfields_clients, (id,))\n    clientdict=dict(ident=id, organization=SqlAccess.fetchone()[1]);\n    print clientdict\n    s='INSERT INTO CLIENTS (ID, COMPANY) VALUES'\n    s+='('+str(clientdict['ident'])+', ' +'\\''+clientdict['organization']+'\\''+')';\n    print s\n    cur.execute(s)\nconn.commit()    \n#print s\n#cur.execute(s)\n#conn.commit()\n#cur.execute(s1)\n#conn.commit()\n#cur=con.cursor()\ncon.close()\nconn.close()\nconAcc.close();\n#print \"Connect succesfully\"\n</code></pre>\n\n<p>When the debugging I display text sql queries, which included (all output not cite)</p>\n\n<pre><code>create table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\ncreate ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);\n\ncreate ascending index IDX_CLIENTS_COMPANY on CLIENTS (COMPANY);\n\ncreate ascending index IDX_CLIENTS_FIRST_NAME on CLIENTS (\"FIRST NAME\");\n\ncreate ascending index IDX_CLIENTS_LAST_NAME on CLIENTS (\"LAST NAME\");\n\ncreate ascending index IDX_CLIENTS_POSTAL_CODE on CLIENTS (\"ZIP/POSTAL CODE\");\n\ncreate ascending index IDX_CLIENTS_PRIMARYKEY on CLIENTS (ID);\n\ncreate ascending index \"IDX_CLIENTS_STATE/PROVINCE\" on CLIENTS (\"STATE/PROVINCE\");\n29\n{'organization': u'\\u041e\\u0440\\u0433\\u0430\\u043d\\u0438\\u0437\\u0430\\u0446\\u0438\\u044f \\u0410', 'ident': 1}\nINSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Организация А')\n\nTraceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 263, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 457, in _execute\n    (h, oid, buf) = self.transaction.connection._op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 764, in _op_response\n    return self._parse_op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 308, in _parse_op_response\n    raise OperationalError(message, gds_codes, sql_code)\nOperationalError: Dynamic SQL Error\nSQL error code = -204\nTable unknown\nCLIENTS\nAt line 1, column 13\n</code></pre>\n\n<p>Specifically brought to the printing paste formed request</p>\n\n<pre><code>INSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Организация А')\n</code></pre>\n\n<p>and when it is running an error (see above). How to fix?</p>\n"},{"tags":["java","android","sql","cursor"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":136,"score":0,"question_id":12109861,"title":"Android cursor returns no rows for select-query","body":"<p>i'm currently trying to get a single row from my own database, located in the assets folder. Checking if there is a row in the table, with the SQLite Query Browser and the SELECT-Statement from the debugger got me a single row in the database. Anyway calling the statement from my code just gets me an empty cursor. I also added the method </p>\n\n<blockquote>\n  <p>cursor.moveToFirst()</p>\n</blockquote>\n\n<p>and avoided calling </p>\n\n<blockquote>\n  <p>myDataBase.close();</p>\n</blockquote>\n\n<p>Here is the method where i'm trying to append a single entry on a TextView:</p>\n\n<pre><code>private void getAdresses(Location location) { // TODO\n    double lat = location.getLatitude();\n    double lng = location.getLongitude();\n    Geocoder geocoder = new Geocoder(this, Locale.GERMAN);\n\n    try {\n        List&lt;Address&gt; addresses = geocoder.getFromLocation(lat, lng, 1);\n        if (addresses.size() != 0) {\n            Address address = addresses.get(0);\n\n            String addressString = address.getAddressLine(0).toString();\n            System.out.println(\"(geocoder) \" + addressString);\n            textView.append(addressString + \"\\n\");\n\n            Cursor cursor = mDbHelper.getAllEntrys(\"tblBar\", \"Adresse\",\n                    addressString);\n\n            if (cursor.moveToFirst()) {\n\n                String cursorContent = cursor.getString(cursor\n                        .getColumnIndexOrThrow(\"Name\"));\n                textView.append(cursorContent + \"\\n\");\n\n            } else {\n                System.out.println(\"No bar at current location\");\n            }\n        } else {\n            System.out.println(\"(geocoder) no address!\");\n        }\n    } catch (IOException e) {\n        System.out.println(e.toString() + \"(geocoder)\");\n    }\n}\n</code></pre>\n\n<p>Furthermore this is my method for calling the actual query on the database:</p>\n\n<pre><code>public Cursor getAllEntrys(String table, String column, String search) {\n    try {\n        String sSelect = \"SELECT * FROM \" + table + \" WHERE \" + column\n                + \" = '\" + search + \"'\";\n        Cursor cursor = mDb.rawQuery(sSelect, null);\n\n        if (cursor != null) {\n            cursor.moveToFirst();\n        }\n        return cursor;\n    } catch (SQLException mSQLException) {\n        System.out.println(\"getData &gt;&gt;\" + mSQLException.toString());\n        throw mSQLException;\n    }\n}\n</code></pre>\n\n<p>Hope someone can help me with this. Many thanks in advance!</p>\n"},{"tags":["sql","constraints","column"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13217385,"title":"Column Constraint Sql 2008","body":"<p>I have been trying to find out if I can make a column Open on Insert, and closed on Update.\nWhat I mean by that, is I need a column that I can give it a value only on Insert, but if I try to give it a value with Update, the statement would fail.</p>\n\n<p>I am working with SQL 2008... </p>\n"},{"tags":["c#","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":84,"score":2,"question_id":13172857,"title":"Splitting an array to another array","body":"<p>I have a list which contains </p>\n\n<ol>\n<li>The <code>Price</code></li>\n<li>The <code>Code</code></li>\n</ol>\n\n<p>I've managed to split the list to an array, but I want to further split the array so that I can get the <code>Price</code> and <code>Code</code> separately and sort the <code>Price</code> to ascending order. When the sorting occurs, I need the <code>Code</code> to be sorted together as well because the <code>Price</code> is for that particular <code>Code</code>.</p>\n\n<p>So it will be like this:\nOriginal List:</p>\n\n<pre><code>1588,8DNY;1488,ACNY;1288,7DPE;1888,8HUC;1488,8WNH;\n</code></pre>\n\n<p>After Splitting to arrPrice:</p>\n\n<pre><code>[1588,8DNY],[1488,ACNY],[1288,7DPE],[1888,8HUC],[1488,8WNH]\n</code></pre>\n\n<p>2nd Splitting 2ndarrPrice:</p>\n\n<pre><code>[1588],[1488],[1288],[1888],[1488]\n</code></pre>\n\n<p>2nd Splitting 2ndarrCode:</p>\n\n<pre><code>[8DNY],[ACNY],[7DPE],[8HUC],[8WNH]\n</code></pre>\n\n<p>Sort Price in ascending order:</p>\n\n<pre><code>[1288],[1488],[1488],[1588],[1888]\n</code></pre>\n\n<p>Code will be sorted accordingly:</p>\n\n<pre><code>[7DPE],[ACNY],[8HUC],[8WNH]\n</code></pre>\n\n<p>I am stuck after the 1st splitting.</p>\n\n<pre><code>  if (lblprices.Text != \"\")\n    {\n        arrprice = lblprices.Text.Split(new char[] { ';' }, StringSplitOptions.RemoveEmptyEntries);\n\n        Array.Sort(arrprice);\n\n        for (i = 0; i &lt; arrprice.Length; i++)\n        {\n            arr2 = arrprice[i].Split(',');\n            SQL2 = \"SELECT DISTINCT [TP].[TCode], \";\n            SQL2 += \"[TP].[TName], \";\n            SQL2 += \"[TP].[TName_CN],  \";\n            SQL2 += \"[TP].[TourType], \";\n            SQL2 += \"[TP].[LastUpdateDate], \";\n            SQL2 += \"[TP].[ValidityFrom],  \";\n            SQL2 += \"[TP].[ValidityTo], \";\n            SQL2 += \"[CL].[CountryCode], \";\n            SQL2 += \"[CL].[CityName] \";\n\n            SQL2 += \"FROM [CL], [TP], [TourItinerary],[TourHotel] \";\n\n            SQL2 += \"WHERE [TP].[Activation] = 1  \";\n            SQL2 += \"AND [TP].[TCode] = '\" + arr2[1] + \"' \";\n            SQL2 += \"ORDER BY [TP].[LastUpdateDate] DESC \";\n\n            objConnTour.Open();\n\n            SqlCommand command = new SqlCommand(SQL2, objConnTour);\n            SqlDataReader dataReader = command.ExecuteReader();\n\n            if (dataReader.Read())\n            {\n                html += \"&lt;tr&gt;&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TCode\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TName\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TName_CN\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TType\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"LastUpdateDate\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"ValidityFrom\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"ValidityTo\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"CountryCode\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"CityName\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;from&amp;nbsp;&lt;span class=\\\"price-red\\\"&gt;S$&lt;b&gt;\" + arr2[0] + \"&lt;/b&gt;&lt;/span&gt;&lt;td/&gt;&lt;/tr&gt;\";\n            }\n\n            dataReader.Close();\n\n            objConnTour.Close();\n        }\n    }\n    return html;\n</code></pre>\n\n<p>The code above will not be able to sort the price in ascending order. As you can see in my <code>arr2</code> split, I need the <code>Code</code> and <code>Price</code> together as I will be retrieving data from database based on the <code>Code</code>.</p>\n\n<p>--------Edit---------</p>\n\n<p>Ok so the problem is that if the prices are in the of 1000-1999, it gets sorted perfectly.\nBut if i have prices that is less than 1000, it will not be sorted in an ascending manner</p>\n\n<p>Example are the screenshots of the results using the code provided by @jekcom</p>\n\n<p>This is when i haven't split the List and retrieve them raw from the database</p>\n\n<p><img src=\"http://i.stack.imgur.com/7Z0Vz.png\" alt=\"Original, Unsorted\"></p>\n\n<p>And this is the Sorted one using @jekcom's code</p>\n\n<p><img src=\"http://i.stack.imgur.com/IuKTy.png\" alt=\"enter image description here\"></p>\n\n<p>Notice how the Price are not sorted in Ascending manner.</p>\n"},{"tags":["php","sql","select"],"answer_count":11,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":449,"score":0,"question_id":1472137,"title":"SQL: Select * from","body":"<p>i hava a query of the following form</p>\n\n<pre><code>select * from tablename where id= $var\n</code></pre>\n\n<p>now\nsometimes i need to select a recod with a particular id ,and\nsometimes i need to select recore with any id</p>\n\n<p>so i intent to something of follwoing form</p>\n\n<pre><code>$v = $_GET['id'];\nif($v== -1)\n   $var = '*' //here i want to select all recods\nelse\n   $var = $v  //select record recod with specifinc id\n\n//execure the SQL query now\n\nselect * from tablename where id= $var\n</code></pre>\n\n<p>but SQL dont support it when <code>$var = *</code></p>\n\n<p>How can this problem be solved by using the above technique\nNOTE: Actial scenirio is very different and complex so i have\n     just give a simple eg for others to get to know my requiremnt \nI know that the above thing can be handled in many diffret appooaches\nBut i want to solve it in the above descibed approach</p>\n"},{"tags":["c#","sql","sql-server","port","sqlclient"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13214174,"title":"Is the port automatically gathered from SQL Server?","body":"<p>I've noticed that if I don't supply a port when I build a connection string I can still connect to SQL Server via a named instance that looks like [SERVER][INSTANCE_NAME].</p>\n\n<p>Is sqlclient automatically gathering the port number for me? Do I have to concern myself with port number even if the instance is the default instance?</p>\n\n<p>I'm sorry if this question seems novice. Google just hasn't turned anything up for me.</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13198894,"title":"How can I select a ranged rows with order from a table in Oracle?","body":"<p>In Oracle there is no limit, so I used this:</p>\n\n<pre><code>SELECT * FROM ( \n    SELECT m.*, ROWNUM r from TABLE_NAME m  WHERE COL LIKE XYZ ORDER BY ID ASC\n    ) \nWHERE r BETWEEN 10 AND 20;\n</code></pre>\n\n<p>But it is still not ordered. It is ordered in the 10 from 20, but not the entire table. How can I do that? </p>\n\n<p>I want to ORDER THE ENTIRE TABLE with <code>WHERE</code> clause and get the ranged ones. The solution above only order within the range.</p>\n\n<hr>\n\n<p><strong>Maybe less confusing solution (in case anyone googled here):</strong></p>\n\n<pre><code>SELECT a.* from (\n  SELECT b.*, ROWNUM r FROM ( \n    SELECT * FROM table ORDER BY id ASC  \n  ) b  WHERE  (city LIKE '%abc%' OR city IS NULL)\n) a where r between 5 and 10\n</code></pre>\n\n<p>So it is a better idea to put order right in the middle criteria, and then put other criteria in the second level, and put row number in the outter-most level.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12065931,"title":"MySQL Select rows on first occurance of each unique value","body":"<p>Let's say you have the following table (the column of interest here is <code>cid</code>):</p>\n\n<pre><code>+-----+-------+-------+-------+---------------------+--------------+\n| cid | pid   | rid   | clink | time                | snippet      |\n+-----+-------+-------+-------+---------------------+--------------+\n| 155 | 11222 |  1499 |  1137 | 2012-08-22 03:05:06 | hi           |\n| 138 | 11222 |   241 |  1136 | 2012-08-21 05:25:00 | again        |\n| 138 | 11222 |   241 |  1135 | 2012-08-21 05:16:40 | hi           |\n| 155 | 11222 |  1499 |  1134 | 2012-08-21 05:11:00 | hi cute      |\n| 140 | 11222 | 11223 |  1133 | 2012-08-21 05:05:18 | hi           |\n| 154 | 11222 |   565 |  1132 | 2012-08-21 05:04:47 | 7            |\n| 153 | 11222 |   272 |  1131 | 2012-08-21 05:04:41 | 6            |\n| 146 | 11222 |   362 |  1130 | 2012-08-21 05:04:33 | 5            |\n| 152 | 11222 |   364 |  1129 | 2012-08-21 05:04:27 | 4            |\n| 151 | 11222 |   390 |  1128 | 2012-08-21 05:04:22 | 3            |\n| 150 | 11222 |   333 |  1127 | 2012-08-21 05:04:16 | 2            |\n| 148 | 11222 |   268 |  1126 | 2012-08-21 05:04:10 | 1            |\n| 140 | 11222 | 11223 |  1125 | 2012-08-21 04:59:57 | hi sir       |\n| 147 | 11222 |   283 |  1123 | 2012-08-21 03:29:55 | yo           |\n| 140 | 11222 | 11223 |  1121 | 2012-08-21 02:12:13 | hello!       |\n| 139 | 11222 |   249 |  1120 | 2012-08-21 02:11:53 | hi :)        |\n| 140 | 11222 | 11223 |  1119 | 2012-08-21 02:11:26 | hi :)        |\n| 140 | 11222 | 11223 |  1118 | 2012-08-21 02:11:08 | hi too       |\n| 139 | 11222 |   249 |  1117 | 2012-08-21 02:11:00 | :P           |\n| 139 | 11222 |   249 |  1116 | 2012-08-21 02:10:57 | hi           |\n| 139 | 11222 |   249 |  1115 | 2012-08-21 02:10:51 | helo         |\n| 139 | 11222 |   249 |  1114 | 2012-08-21 02:06:19 | hi           |\n| 139 | 11222 |   249 |  1113 | 2012-08-21 02:05:45 | hi baby      |\n| 139 | 11222 |   249 |  1112 | 2012-08-21 02:05:00 | hi           |\n| 139 | 11222 |   249 |  1111 | 2012-08-21 02:04:41 | hi           |\n| 140 | 11222 | 11223 |  1110 | 2012-08-21 02:04:26 | hi           |\n| 140 | 11222 | 11223 |  1108 | 2012-08-21 01:47:40 | hey :)       |\n| 139 | 11222 |   249 |  1107 | 2012-08-21 01:44:43 | hi           |\n| 138 | 11222 |   241 |  1106 | 2012-08-21 01:44:11 | hi           |\n| 138 | 11222 |   241 |  1105 | 2012-08-21 01:09:20 | conv 1 msg 1 |\n+-----+-------+-------+-------+---------------------+--------------+\n</code></pre>\n\n<p>How to extract only the first occurrence of each <code>cid</code>? The resulting table would be:</p>\n\n<pre><code>+-----+-------+-------+-------+---------------------+--------------+\n| cid | pid   | rid   | clink | time                | snippet      |\n+-----+-------+-------+-------+---------------------+--------------+\n| 155 | 11222 |  1499 |  1137 | 2012-08-22 03:05:06 | hi           |\n| 138 | 11222 |   241 |  1136 | 2012-08-21 05:25:00 | again        |\n| 140 | 11222 | 11223 |  1133 | 2012-08-21 05:05:18 | hi           |\n| 154 | 11222 |   565 |  1132 | 2012-08-21 05:04:47 | 7            |\n| 153 | 11222 |   272 |  1131 | 2012-08-21 05:04:41 | 6            |\n| 146 | 11222 |   362 |  1130 | 2012-08-21 05:04:33 | 5            |\n| 152 | 11222 |   364 |  1129 | 2012-08-21 05:04:27 | 4            |\n| 151 | 11222 |   390 |  1128 | 2012-08-21 05:04:22 | 3            |\n| 150 | 11222 |   333 |  1127 | 2012-08-21 05:04:16 | 2            |\n| 148 | 11222 |   268 |  1126 | 2012-08-21 05:04:10 | 1            |\n| 147 | 11222 |   283 |  1123 | 2012-08-21 03:29:55 | yo           |\n| 140 | 11222 | 11223 |  1121 | 2012-08-21 02:12:13 | hello!       |\n| 139 | 11222 |   249 |  1120 | 2012-08-21 02:11:53 | hi :)        |\n+-----+-------+-------+-------+---------------------+--------------+\n</code></pre>\n\n<p>Thanks in advance for any ideas.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13216408,"title":"Select MySQL row where column is closest to current date","body":"<p>I have a database with a bunch of rows. One of the columns is \"date\" which has a date for each row in the format: MM/DD/YYYY H:MM PM/AM</p>\n\n<p>How can I write PHP that selects the row where the date is the most recent date that has passed. Meaning if you have a date of tomorrow, a date of today, and a date of yesterday, it picks the row where the date is of yesterday.</p>\n\n<p>I've already connected to the database:</p>\n\n<pre><code>mysql_connect('localhost','username','pass');\nmysql_select_db('db_name');\n</code></pre>\n\n<p>How do I write a query to grab this?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13147991,"title":"For the following mysql query I got an output. But how to modify the query so that I get results for a range of date","body":"<pre><code>select hotel.*, hotels.type \nfrom pe,se \nwhere p.hotel_Id = s.S_Id \n  and Type=\"\";\n</code></pre>\n\n<p>The output I got is </p>\n\n<pre><code> pid     SId     PName     PPlan     PMethod     PDate     numberOfParents     SType    \n ---------------------  ----------  -------------------------  -------------------------  ---------------------------  -------------------------  ------------------  ------------ \n 4                      2           kjbkjbjkbk                 jkbjbkbl                   lkblknl                      10/5/2012                  234                 abc       \n 6                      2           dfvrvt                     rvrtv                      rvrtvrt                      1/1/2012                   3                   abc       \n 9                      2           er                         \n</code></pre>\n\n<p>Now my problem is I want query so that my output will be in a such way that the data are for a range of dates. For eg, 08/09/2012 to 10/12/2012.</p>\n\n<p>Separately I could write the mysql query for a date range using >= and &lt;=. But I could not combine that date range part in the present query. Please help me. </p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13216068,"title":"MySQL query to return AVG","body":"<p>Just a practice problem, little bit confusing I'd appreciate it if somebody could clear this up..</p>\n\n<p>I have a DB called Product and another one called PC. I'm trying to execute a query to \"find the average hard disk size of a PC for all those manufacturers who also make printers\"</p>\n\n<p>Here's my code:</p>\n\n<pre><code>SELECT maker, AVG(hd) \nFROM pc, product\nWHERE pc.model=product.model\nGROUP BY maker\nHAVING COUNT(type='PR')&gt;=1\n</code></pre>\n\n<p>type is an attribute of Product which either stands for printer(PR) laptop or PC, however the HAVING statement doesn't seem to single out only the makers who produce printers, instead I get back an AVG for each maker in the Product table.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>This is what the relations look like:</p>\n\n<pre><code>Product(maker, model, type)\nPC(model, hd, speed, ram, price)\nPrinter(model, color, type, price)\n</code></pre>\n"},{"tags":["php","sql","phpbb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13215749,"title":"Trouble With Understanding How PHPBB translates to regular PHP","body":"<p>I have been fiddling around with a third-party script for some time when I noticed there was some unusual PHPBB framework code put in randomly with the rest of the PHP.  What I need to understand is if there is anything particularly special about this code(can it do something regular PHP can't?) and how I can smoothly transition the code to PHP without a framework if there isn't anything special about the code.</p>\n\n<pre><code>&lt;?\ninclude('bar.php');\ninclude \"../includes/config.inc.php\";\ninclude \"loggedin.inc.php\";\ninclude \"../includes/countries.inc.php\";\n$auction_id = isset($_REQUEST['aid']) ? $_REQUEST['aid'] : \"\";\n?&gt;\n&lt;?\ndefine(\"DATAGRID_DIR\", \"../datagrid/\");\ndefine(\"PEAR_DIR\", \"../datagrid/pear/\");\nrequire_once(DATAGRID_DIR . 'datagrid.class.php');\nrequire_once(PEAR_DIR . 'PEAR.php');\nrequire_once(PEAR_DIR . 'DB.php');\n$DB_USER = $DbUser;\n$DB_PASS = $DbPassword;\n$DB_HOST = $DbHost;\n$DB_NAME = $DbDatabase;\nob_start();\n$db_conn     = DB::factory('mysql');\n$result_conn = $db_conn-&gt;connect(DB::parseDSN('mysql://' . $DB_USER . ':' . $DB_PASS . '@' . $DB_HOST . '/' . $DB_NAME));\nif (DB::isError($result_conn)) {\n    die($result_conn-&gt;getDebugInfo());\n}\n$sql = \"SELECT u.id, u.nick, COUNT(b.bidder) AS bid_count, 'View offers' AS link\n            FROM BPLA_bids b\n                INNER JOIN BPLA_users u ON b.bidder=u.id\n            WHERE b.auction=$auction_id\n            GROUP BY b.bidder\";\n$unique_prefix       = \"au_\";\n$dgrid               = new DataGrid($debug_mode, $messaging, $unique_prefix, DATAGRID_DIR);\n$default_order_field = \"nick\";\n$default_order_type  = \"ASC\";\n$dgrid-&gt;dataSource($db_conn, $sql, $default_order_field, $default_order_type);\n$dg_language = \"en\";\n$dgrid-&gt;setInterfaceLang($dg_language);\n$direction = \"ltr\";\n$dgrid-&gt;setDirection($direction);\n$modes = array(\n    \"add\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\"\n    ),\n    \"edit\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\",\n        \"byFieldValue\" =&gt; \"\"\n    ),\n    \"cancel\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\"\n    ),\n    \"details\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\"\n    ),\n    \"delete\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"image\"\n    )\n);\n$dgrid-&gt;setModes($modes);\n$http_get_vars = array(\n    \"aid\"\n);\n$dgrid-&gt;setHttpGetVars($http_get_vars);\n$printing_option = false;\n$dgrid-&gt;allowPrinting($printing_option);\n$exporting_option    = false;\n$exporting_directory = \"\";\n$dgrid-&gt;allowExporting($exporting_option, $exporting_directory);\n$sorting_option = true;\n$dgrid-&gt;allowSorting($sorting_option);\n$paging_option   = true;\n$rows_numeration = false;\n$numeration_sign = \"N #\";\n$dgrid-&gt;allowPaging($paging_option, $rows_numeration, $numeration_sign);\n$bottom_paging     = array();\n$top_paging        = array();\n$pages_array       = array(\n    \"10\" =&gt; \"10\",\n    \"25\" =&gt; \"25\",\n    \"50\" =&gt; \"50\",\n    \"100\" =&gt; \"100\",\n    \"250\" =&gt; \"250\"\n);\n$default_page_size = 10;\n$paging_arrows     = array(\n    \"first\" =&gt; \"|&amp;lt;&amp;lt;\",\n    \"previous\" =&gt; \"&amp;lt;&amp;lt;\",\n    \"next\" =&gt; \"&amp;gt;&amp;gt;\",\n    \"last\" =&gt; \"&amp;gt;&amp;gt;|\"\n);\n$dgrid-&gt;setPagingSettings($bottom_paging, $top_paging, $pages_array, $default_page_size, $paging_arrows);\n$dgrid-&gt;setViewModeTableProperties($vm_table_properties);\n$vm_colimns = array(\n    \"nick\" =&gt; array(\n        \"header\" =&gt; \"Nick\",\n        \"type\" =&gt; \"label\",\n        \"summarize\" =&gt; \"false\",\n        \"visible\" =&gt; \"true\"\n    ),\n    \"bid_count\" =&gt; array(\n        \"header\" =&gt; \"Bid count\",\n        \"type\" =&gt; \"label\",\n        \"summarize\" =&gt; \"false\",\n        \"visible\" =&gt; \"true\"\n    ),\n    \"link\" =&gt; array(\n        \"header\" =&gt; \"&amp;nbsp;\",\n        \"type\" =&gt; \"link\",\n        \"field_key\" =&gt; \"id\",\n        \"field_data\" =&gt; \"link\",\n        \"href\" =&gt; \"auction_users_bids.php?aid=$auction_id&amp;uid={0}\"\n    )\n);\n$dgrid-&gt;setColumnsInViewMode($vm_colimns);\n$dgrid-&gt;bind();\nob_end_flush();   \n?&gt;\n</code></pre>\n"},{"tags":["mysql","sql","database","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":7926904,"title":"CHADIM in information technology context","body":"<p>What is CHADIM in information technology context?\nMy assignment for one IT class(Relational database management system) is a investigation report on CHADIM.</p>\n\n<p>Can someone give me some pointers on the subject? i cant find anything related  on search engines.</p>\n"},{"tags":["php","mysql","sql","database","sync"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":32,"score":-1,"question_id":13216042,"title":"MySQL database sync betwen two servers using PHP","body":"<p>I have two same websites on two different servers. </p>\n\n<pre><code>Master Database - server1\nSlave Database - Server2\n</code></pre>\n\n<p>I wanna make PHP script which will check for changes in master database and if found any it will syncronize it with slave database. I will set chronjob for that script so it will run every few minutes.</p>\n\n<p>I found some scripts on Google but it doesn't work at all.\nI tried using PMS(<a href=\"http://sourceforge.net/projects/mysqlsync/\" rel=\"nofollow\">http://sourceforge.net/projects/mysqlsync/</a>) but i reciving:</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant user - assumed 'user' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant pass - assumed 'pass' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant base - assumed 'base' in /var/www/demos/pms/pmslib.php on line 63</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 79</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant user - assumed 'user' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant pass - assumed 'pass' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant base - assumed 'base' in /var/www/demos/pms/pmslib.php on line 63</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 79</p>\n"},{"tags":["c#","sql","linq-to-sql","datacontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13212055,"title":"New DataContext per second","body":"<p>I'm making a server for a game and I need to save everyone's second so I made :-</p>\n\n<pre><code>private static void SubmitChanges() {\n    while(true) {\n        try {\n            using(GameDBDataContext db = new GameDBDataContext()){\n                foreach(IHero hero in world.Entities.BattleEntities.OnlineHeros.Values) {\n                    hero.Update(db);\n                }\n            }\n        } catch(Exception ex) {\n            Console.WriteLine(ex.ToString());\n        }\n        Thread.Sleep(1000);\n    }\n}\n</code></pre>\n\n<p>Is that fine? and would it be fine if I have like 500 online heroes?</p>\n\n<p><strong>EDIT</strong>: Checking how long it takes :-</p>\n\n<pre><code>private void UpdateDatabase() {\n    try {\n        using(GameDBDataContext db = new GameDBDataContext()) {\n            foreach(IHero hero in world.Entities.BattleEntities.OnlineHeros.Values) {\n                DateTime now = DateTime.Now;\n                hero.Update(db);\n                DateTime after = DateTime.Now;\n                Console.WriteLine((now - after).Milliseconds);\n            }\n        }\n    } catch(Exception ex) {\n        Console.WriteLine(ex.ToString());\n    }\n}\n</code></pre>\n\n<p>result :- </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>-13\n-10\n-13\n-26\n-19\n-24\n-25\n-19\n-27\n-22\n-19\n-26\n-25\n-21\n-24\n-22\n</code></pre>\n"},{"tags":["sql","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13215553,"title":"Match a column from a column with concatenated values in sqlite","body":"<p>I have a table with a column that has concatenated values like this</p>\n\n<pre><code>Table CHILD:\n\n    ChildId       Values\n    2           x123,j455\n    3           f456,z789 \n    4           m333,y567\n    5           x123,h888\n</code></pre>\n\n<p>And I have a master table MASTER that has </p>\n\n<pre><code>Table MASTER:\n\n    MainValues\n    x123\n    f456\n    y567\n</code></pre>\n\n<p>I need to get a query that'll select the following data</p>\n\n<pre><code>ChildId MainValues\n2       x123\n3       f456\n4       y567\n5       x123\n</code></pre>\n\n<p>Basically match value from MASTER in child values and return only the master value. How can I do this ? I have tried IN and LIKE clause matching with second table but that doesnt help much since the values are csv. Is there a way to split and match in sqlite ? </p>\n\n<p>EDIT: Table and column names are fictional and intended just to explain this question better</p>\n"},{"tags":["sql","replace","bit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13215811,"title":"Can I replace values of bit field to text in creating Table","body":"<p>I tried but can't use CASE WHEN in CREATE TABLE code to replace 1 and 0 with text. Can someone help me to solve it. Thank you so much :D</p>\n"},{"tags":["sql","sql-server-2008","ssis"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2580,"score":2,"question_id":1596069,"title":"OnTaskFailed event handler in SSIS","body":"<p>If I use <strong>OnError</strong> event handler in my SSIS package, there are variables <strong>System::ErrorCode</strong> and <strong>System::ErrorDescription</strong> from which I can get the error information if any things fails while execution.</p>\n\n<p>But I cant the find the same for <strong>OnTaskFailed</strong> event handler, i.e. How to get the <strong>ErrorCode</strong> and <strong>ErrorDescription</strong> from the OnTaskFailed event handler when any things fails while execution in case we want to only implement OnTaskFailed event handler for our package?</p>\n"},{"tags":["android","sql","jquery-ajax","phonegap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13173475,"title":"phonegap $.ajax()","body":"<p>anyone know how to store the jsonp data from server in phonegap local database?</p>\n\n<p>the code below can help to connect the phonegap android app to the server, but how to store the data in the phonegap local database?</p>\n\n<pre><code>$.ajax({\n    url: 'http://172.18.75.156/deals.php',\n    dataType: 'jsonp',\n    jsonp: 'jsoncallback',\n    timeout: 5000,\n    success: function(data, status){\n        $.each(data, function(i,item){ \n            output.text('successful');\n        });\n    },\n    error: function(){\n       output.text('There was an error loading the data.');\n    }\n});\n</code></pre>\n"},{"tags":["sql","sql-server","stored-procedures"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":291,"score":2,"question_id":7421074,"title":"Is it possible to create a stored procedure with two insert statements where id/primary_key from the first insert statement will be used in second?","body":"<p>I see that there is a very similiar question already answered that discusses this same issue, but i just cannot seem to understand it. Below is a copy of my code that is in a stored procedure.  I need to somehow, have the second insert statement insert the CompanyID generated from the first, into this second Statement.  I appreciate any help i can get.</p>\n\n<p>Thank You!!</p>\n\n<pre><code>@comp_name nvarchar (50),\n@City nvarchar (50),\n@State nvarchar (10),\n@Address ntext,\n@Zip_Code nvarchar (50),\n@Country nvarchar (50),\n@cust_name nvarchar (50),\n@CompanyID int\nAS\nINSERT INTO Company_Listing\n(comp_name, City, State, Address, Zip_Code, Country)\nVALUES (@comp_name, @City, @State, @Address, @Zip_Code, @Country)\n\nINSERT INTO Customer_Listing\n(cust_name, City, State, Address, Zip_Code, Country, CompanyID)\nVALUES (@comp_name,@City,@State,@Address,@Zip_Code,@Country,@CompanyID)\n</code></pre>\n"},{"tags":["java","sql","mysql","jdbc"],"answer_count":8,"favorite_count":10,"up_vote_count":10,"down_vote_count":0,"view_count":9304,"score":10,"question_id":1044194,"title":"Running a .sql script using MySQL with JDBC","body":"<p>I am starting to use MySQL with JDBC.</p>\n\n<pre><code>Class.forName(\"com.mysql.jdbc.Driver\");\nconn = DriverManager.getConnection(\"jdbc:mysql:///x\", \"x\", \"x\");\nstmt = conn.createStatement();\nstmt.execute( \"CREATE TABLE amigos\" +\n            \"(\"+\n            \"id          int AUTO_INCREMENT          not null,\"+\n            \"nombre      char(20)                    not null,\"+\n            \"primary key(id)\" +\n            \")\");\n</code></pre>\n\n<p>I have 3-4 tables to create and this doesn't look good.</p>\n\n<p>Is there a way to run a .sql script from MySQL JDBC?</p>\n"},{"tags":["sql","database","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13214391,"title":"Can I create a foreign key for a table with elements which don't exist in the referenced table?","body":"<p>I'm working on an assignment which wants me to write some referential integrity constraints on a table.  It asks me to ensure that every battle in Outcomes is also mentioned in Battles and to handle all violations by setting the referencing value to NULL. </p>\n\n<p>I'm  working with the following schemas</p>\n\n<pre><code>Battles(\n    name VARCHAR(255) PRIMARY KEY, \n    date VARCHAR(255), \n)\nOutcomes(\n    ship VARCHAR(255),\n    battle VARCHAR(255),\n    RESULT VARCAHR(255),\n    PRIMARY KEY(ship, battle)\n)\n</code></pre>\n\n<p>I'm trying to add the foregin key like this:</p>\n\n<pre><code>alter table outcomes \nadd foreign key (battle) \nreferences battles(name) \non delete set null \non update cascade;\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>SQL error:\n\nERROR:  insert or update on table \"outcomes\" violates foreign key constraint \"outcomes_battle_fkey\"\nDETAIL:  Key (battle)=(Pearl Harbor \n</code></pre>\n\n<p>I know this is because \"Pearl Harbor\" is in OUTCOMES but not in BATTLES, what I want to know is if there is some way to ignore that fact and set the foreign key anyway? </p>\n"},{"tags":["apache2","postgresql","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13215332,"title":"error on sql data push","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12918630/error-on-windows-apache-data-push\">error on windows -&gt; apache data push</a>  </p>\n</blockquote>\n\n\n\n<p>On a scheduled data push to a postgre db on an apache server, an error has sort of just cropped up out of the blue. The server doing the push is Windows server 2003. The data push is a SQLserver agent job running a stored procedure.</p>\n\n<p>At first it seemed it was a memory issue that was making the push fail. Error message:</p>\n\n<pre><code>Msg 7300, Sev 16: OLE DB error trace [OLE/DB Provider 'MSDASQL' IOpenRowset::OpenRowset returned 0x8007000e:  The provider ran out of memory.]. [SQLSTATE 01000]\n</code></pre>\n\n<p>But after having restarted both servers, I now get this error:</p>\n\n<pre><code>Msg 7300, Sev 16: OLE DB error trace [OLE/DB Provider 'MSDASQL' ::Commit returned 0x8000ffff:  The provider reported an unexpected catastrophic failure.]. [SQLSTATE 01000]\n</code></pre>\n\n<p>Can someone help me figure out what exactly this means and how to correct it?</p>\n\n<p>Thank you very much</p>\n"},{"tags":["mysql","sql","database","structure","ranking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13215230,"title":"Ranking Script - Database Structure","body":"<p>For like 2 last months I was thinking about makin ranking site for an fps game. Suddenly I had no time to start the project, so it was waiting in my mind for better times :)\nNow I would like to start it and I consider what type of database I should do for it.\nIn my opinion the relation one, should be the best, but I am not 100% is it possible to do it like that, since I saw like 2-3 ranking systems where the tables had no relations at all.</p>\n\n<p>In fact I did, such structure for the database:\n<a href=\"http://postimage.org/image/n1lackjfz/\" rel=\"nofollow\">http://postimage.org/image/n1lackjfz/</a> (no dots means 1:1, white dot-black dot means 1:n)</p>\n\n<p>I would really appreciate, if you could give me some advices. If is okey or I should forget about InnoDB one and just make an simple MyISAM engine based database.</p>\n"},{"tags":["sql","xml","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13215005,"title":"Import data into SQLite from XML","body":"<p>I am trying to import data stored in a XML file into my SQLite database. The insert query looks something like the following:</p>\n\n<pre><code>INSERT INTO table1 VALUES (rank, name)\nSELECT X.record.query('rank').value('.', 'INT'),\n       X.record.query('name').value('.', 'VARCHAR(30)')\nFROM (\n  SELECT CAST(x AS XML)\n  FROM OPENROWSET(BULK 'data.xml', SINGLE_BLOB) AS T(x)\n     ) AS T(x)\nCROSS APPLY x.nodes('data/record') AS X(record);\n</code></pre>\n\n<p>The XML data looks like this:</p>\n\n<pre><code>&lt;data&gt;\n    &lt;record&gt;\n        &lt;rank&gt;1&lt;/rank&gt;\n        &lt;name&gt;One&lt;/name&gt;\n    &lt;/record&gt;\n    &lt;record&gt;\n        &lt;rank&gt;2&lt;/rank&gt;\n        &lt;name&gt;Two&lt;/name&gt;\n    &lt;/record&gt;\n    ...\n&lt;/data&gt;\n</code></pre>\n\n<p>However, I am getting \"SQL command not properly ended at the outer SELECT statement, and I can't figure out why. Any ideas?</p>\n"},{"tags":["sql","oracle","sql-developer","oracle-sqldeveloper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13214951,"title":"Internal error on Oracle SQL Developer 3.2.20.09","body":"<p>I am trying ton insert few data on my existing table but it's showing internal error on all tables. </p>\n\n<p>Here is my simple insert into code where sql developer shows the error:</p>\n\n<pre><code>Insert into STUDENTS (I_ID,C_ID) values (1,'801')\n</code></pre>\n\n<p><strong>ERROR:</strong></p>\n\n<pre><code>Error starting at line 1 in command:\nInsert into STUDENTS(I_ID,C_ID) values (1,'801')\nError at Command Line:1 Column:1\nError report:\nSQL Error: ORA-00600: internal error code, arguments: [kqd-objerror$], [U], [0], [373], [BIN$XQQxCzAhRPCuX323VsAKNA==$0], [], [], [], [], [], [], []\n00600. 00000 -  \"internal error code, arguments: [%s], [%s], [%s], [%s], [%s], [%s], [%s], [%s]\"\n*Cause:    This is the generic internal error number for Oracle program\n           exceptions.  This indicates that a process has encountered an\n           exceptional condition.\n*Action:   Report as a bug - the first argument is the internal error number\n</code></pre>\n\n<p>Do you guys have any idea?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":13162616,"title":"how can I fix this..in select query","body":"<p>this is a select query...</p>\n\n<pre><code>   $q = \"SELECT\n        tcs.tutor_id AS tid,\n        tcs.category_id AS cid,\n        tcs.subject_id AS sid,\n        GROUP_CONCAT( DISTINCT s.subjects SEPARATOR ', ') AS subjects,\n        t.tutor_name AS tname,\n        t.tutor_code AS tcode,\n        DATE_FORMAT(t.registration_date, '%b %D, %Y') AS date,\n        t.qualification AS qualifi,\n        GROUP_CONCAT( DISTINCT o.option_name SEPARATOR ', ') AS tutor_option,\n        timg.image_name AS img,\n        city_name AS city,\n        d.district_name AS district\n   FROM tutor_category_subject as tcs\n        INNER JOIN subject AS s ON tcs.subject_id = s.subject_id\n        INNER JOIN tutor_option AS toption ON toption.tutor_id = tcs.tutor_id\n        INNER JOIN options AS o ON toption.option_id = o.option_id\n        INNER JOIN tutors AS t ON tcs.tutor_id = t.tutor_id\n        INNER JOIN address ON address.address_id = t.address_id\n        INNER JOIN city ON city.city_id = address.city_id\n        INNER JOIN district AS d ON d.district_id = city.district_id\n        LEFT JOIN tutor_images AS timg ON timg.tutor_id = tcs.tutor_id AND timg.image_type = 'profile'\n   WHERE s.subjects LIKE '%$subject%'\n   GROUP BY tcs.tutor_id\";\n</code></pre>\n\n<p>this query is working now.. now I found a problem. it is..... so many subject may have to one particular tutor. I need to select all the subject that pertaining to a tutor with searching keyword to display with search result. In this query searching keyword is '$subject'.\nThis query only selecting subjects to the tutor similar to the given keyword. For an example if a user give a keyword like 'business' query selecting subjects to that tutor like 'business studies, business accounting., etc only'. so I need to select other subjects too through this query.. can anybody help me?</p>\n\n<p>thank you. </p>\n"},{"tags":["mysql","sql","pivot","aggregate-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13214601,"title":"MySQL Query: How to sum 3 different values in a column, showing total of each value in result set","body":"<p>I have a table called inventory that includes two columns as follows:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ST24o.png\" alt=\"enter image description here\"></p>\n\n<p>I would like to query this table to return a result set that lists how many items of each condition I have (column headers show in example below are not wanted in result set...just show here to give clarity):</p>\n\n<p><img src=\"http://i.stack.imgur.com/Xrylg.png\" alt=\"enter image description here\"></p>\n\n<p>I guess it would look something like:</p>\n\n<pre><code>  SELECT item, sum(condition???), sum(condition???), sum(condition???) \n    FROM inventory \nGROUP BY item\n</code></pre>\n\n<p>How can I accomplish this? Thanks.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13214465,"title":"Joining/Displaying Multiple Tables with Same Column Names","body":"<p>What I'm trying to do is set up a query that calls from a Database (the Chinook database in particular - <a href=\"http://chinookdatabase.codeplex.com/\" rel=\"nofollow\">http://chinookdatabase.codeplex.com/</a>)</p>\n\n<p>Now, in order to display the query output correctly, I need to join multiple tables - each that share similar column names.  With the Chinook database, there are multiple tables (Artist, Album, Genre, Media Type, Track, etc.).  Let's say I'm trying to display the contents of an Artist's Name with:</p>\n\n<pre><code>public function fetchArtistName(){\n    return $row['Name'];\n}\n</code></pre>\n\n<p>This is very ambiguous since this row would go and find the Name field for Media Type or Album Name before it finds the artist name.</p>\n\n<p>My SQL statement is as follows:</p>\n\n<pre><code>SELECT *  \nFROM track AS t  \nLEFT JOIN album al \nON t.AlbumId = al.AlbumId  \nLEFT JOIN artist ar ON al.ArtistId = ar.ArtistId  \nLEFT JOIN mediatype m ON t.MediaTypeId = m.MediaTypeId \nLIMIT 0,15; \n</code></pre>\n\n<p>Is there a way I could go about changing the table that is outputted to be like\n|  t.Name   |   al.Name   |    ar.Name    |    m.name    |</p>\n\n<p>so that I could essentially call these much easier with</p>\n\n<pre><code>public function fetchArtistName(){\n    return $row['ar.Name'];\n}\n</code></pre>\n\n<p>It has been so long since I've played with SQL and I'm really stuck.  Any help would be greatly appreciated, I've Googled and search here already.</p>\n\n<p>Thank you.</p>\n"},{"tags":["sql","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13214317,"title":"compare 2 columns from different tables","body":"<p>I have 2 tables with same column in each.. Lets call it colors. How do I compare the two to show the unique colors in table B that are not in table A?</p>\n"},{"tags":["php","sql","md5"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":13213237,"title":"encrypt password in md5?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2778915/need-help-how-to-add-md5-to-password-field-in-php\">Need help… how to add md5 to password field in php?</a>  </p>\n</blockquote>\n\n\n\n<p>I have got this script to allow users to change their passwords. But am wanting the 'newpassword' to be encrypted into the database with md5. Can anyone tell me how i can change this script to encrypt the 'newpassword' in md5 please?</p>\n\n<pre><code>    &lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\n?&gt;\n&lt;?php \n\nsession_start();\n\ninclude '_config/connection.php'; \n\n$email = $_POST['email'];\n$password = $_POST['password'];\n$newpassword = $_POST['newpassword'];\n$confirmnewpassword = $_POST['confirmnewpassword'];\n\n$result = mysql_query(\"SELECT password FROM ptb_users WHERE email='$email'\");\n\n\n\n\n\nif(!$result) \n{ \necho \"The username you entered does not exist\"; \n} \nelse \nif($password!= mysql_result($result, 0)) \n{ \necho \"You entered an incorrect password\"; \n} \nif($newpassword=$confirmnewpassword) \n    $sql=mysql_query(\"UPDATE ptb_users SET password='$newpassword' where email='$email'\"); \n    if($sql) \n    { \n    echo \"Congratulations You have successfully changed your password\"; \n    }\nelse\n{ \necho \"The new password and confirm new password fields must be the same\"; \n}  \n?&gt;\n</code></pre>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13214285,"title":"PHP - Using strcpsn() to protect against SQL injection?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php\">Best way to prevent SQL injection in PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>I am making a sort of form validation system and I need to check the SQL database to see if the username is already there.</p>\n\n<p>So, my question, is it effective to use a little if statement like this to protect against an attack?</p>\n\n<pre><code>if (strcspn($string, \"/\\?!@#$%^&amp;*()[]{}|:;&lt;&gt;,.\\\"\\'-+=\" == strlen($string)){\n    return true;    \n    }\n</code></pre>\n\n<p>So essentially, if the string contains any of these characters, <code>\"/\\?!@#$%^&amp;*()[]{}|:;&lt;&gt;,.\\\"\\'-+=\"</code>, then the length will not equal that of the original <code>$string</code>.</p>\n\n<p>I am just wondering if this is sufficient to protect, or if there is more that I must do.\nThanks.</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13213923,"title":"How to create sql query results in columns from rows?","body":"<p>From the following tables:</p>\n\n<ul>\n<li>store(store_id, ...) {1 ..., 2 ...} two stores</li>\n<li>film(film_id, ...)</li>\n<li>inventory(inventory_id, film_id, store_id)</li>\n<li>rental(rental_id, rental_date, inventory_id, return_date, ...)</li>\n<li>category(category_id, name)</li>\n<li>film_category(film_id, category_id)</li>\n<li>film(film_id, rental_duration, rental_rate, ...)</li>\n<li>customer(customer_id, store_id, ...)</li>\n</ul>\n\n<p>Can I have a query resutls on a table just like the follwoing?</p>\n\n<p>CategoryName | \"Store 1: avaliable items\" | \"Store 1: unavaliable items\" | \"Store 2: avaliable items\" | \"Store 2: unavaliable items\"</p>\n\n<p>Notice that the store fileds in the result table are inseperate columns not in the same columns !!</p>\n\n<p>I am not looking for the result query, I am looking for how to make them side by side store 1, store 2.</p>\n\n<p>Can case sql statement help here?</p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13213948,"title":"join two tables with different rows and multiple select statements","body":"<p>I have a result as</p>\n\n<pre><code>select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username\n</code></pre>\n\n<p>which gives me the columns as <code>username,EmaxViews</code> and gives me 93 rows</p>\n\n<p>and I have another table as <code>Users (username,date_registered,name)</code> which has 100 queries in it</p>\n\n<p>I would like to join my above two queries as a single table as</p>\n\n<pre><code>username, date_registered, EmaxViews\n</code></pre>\n\n<p>I tried like this</p>\n\n<pre><code>select name, date_registered,G.EmaxViews from Users F LEFT OUTER JOIN (select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username) G ON F.username=G.username ORDER BY F.date_registered;\n</code></pre>\n\n<p>Now I am getting 100 rows and proper values for name and date_registered but I am getting NULL for EmaxViews for all the rows..</p>\n\n<p>whats wrong in my query ?</p>\n"},{"tags":["sql","vb.net","stored-procedures","sqldatareader","datareader"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13213956,"title":"SqlDataReader does not read all records","body":"<p>I have a very weird problem in the most simple piece of VB.NET code:</p>\n\n<pre><code>Public Sub ReadIDs(i_oDataReader As Data.SqlClient.SqlDataReader)\n\n    m_aFullIDList = New Generic.List(Of Integer)\n\n    While i_oDataReader.Read\n        If i_oDataReader.IsDBNull(0) = False Then\n            m_aFullIDList.Add(i_oDataReader.GetInt32(0))\n        End If\n    End While\n\n    m_iTotalNumberOfRecords = m_aFullIDList.Count\n\nEnd Sub\n</code></pre>\n\n<p>Basically the procedure accepts a DataReader as a parameter, loops thru all the records in the reader, adding them to a Generic list of integer.</p>\n\n<p>When SQL Stored Procedure that is behind the reader returns relatively small amount of records (below 100K) reader reads all the records and the final count matches the resultset. But when the number of records is over 1 million - results become unpredictable.</p>\n\n<p>E.g. When I know that SP rerturns 1.5M of records - final count of records in Generic list could be 200K, 500K etc.</p>\n\n<p>Any idea what is causing it and how to fix it? Thanks!</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13213265,"title":"processing blocks of records in composite primary key order","body":"<p>I'm using mysql and would like to process a very large table with a primary key of 4 parts in blocks of 10,000 (marshalling data to another system). The database is offline when I am doing the processing so I don't have to worry about any modifications. Say the primary key is (<code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>) which are all integers. I first tried using <code>LIMIT OFFSET</code> to achieve this like this:</p>\n\n<pre><code>SELECT * FROM LargeTable ORDER BY (A, B, C, D) LIMIT 10000 OFFSET 0;\n</code></pre>\n\n<p>Where I increased the offset by 10000 on each call. This seemed to get very slow as it got towards the higher rows in the table. Is it not possible to do this <code>LIMIT OFFSET</code> efficiently?</p>\n\n<p>Then I tried a different approach that uses comparison on the composite primary key. I can get the first block like this:</p>\n\n<pre><code>SELECT * FROM LargeTable ORDER BY (A, B, C, D) LIMIT 10000;\n</code></pre>\n\n<p>If the last row of that block has <code>A = a</code>, <code>B = b</code>, <code>C = c</code>, and <code>D = d</code> then I can get the next block with:</p>\n\n<pre><code>SELECT * FROM LargeTable\nWHERE\n    A &gt; a OR\n    (A = a AND B &gt; b) OR\n    (A = a AND B = b AND C &gt; c) OR\n    (A = a AND B = b AND C = c AND D &gt; d)\nORDER BY (A, B, C, D) LIMIT 10000;\n</code></pre>\n\n<p>And then repeat that for each block. This also seemed to slow down greatly as I got to the higher rows in the table. Is there a better way to do this? Am I missing something obvious?</p>\n"},{"tags":["sql","tsql"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13213691,"title":"Noob Concern: Sub-query calculations","body":"<p>I've got a table <strong>bbc</strong> with the following columns:</p>\n\n<p><strong>name</strong> (refers to a name of a country within a particular region of the world)</p>\n\n<p><strong>region</strong> (continent of the world)</p>\n\n<p><strong>population</strong> (population of the country in the name name field)\nThe question I'm trying to answer:</p>\n\n<p>The <strong>question</strong> is as follows:<br>\n\"Some countries have populations more than three times that of any of their neighbours (in the same region). Give the countries and regions.\"</p>\n\n<p>I was thinking the answer might be something like:</p>\n\n<pre><code>SELECT a.name, a.region FROM bbc AS a\nWHERE a.region IN\n     (\n        SELECT b.region FROM bbc AS b \n        GROUP By b.region \n        HAVING MIN(b.population) &lt; 3*b.population)\n</code></pre>\n\n<p>But honestly, I lose it at that last line... I have no idea how I would find counteries that have more than three times that of any of their neighbours in the same region!  Quite tough.  O_o  </p>\n\n<p>Any and all help would be appreciated.  </p>\n"},{"tags":["mysql","sql","debugging"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":12885309,"title":"Please resolve the syntax error in the mysql insert query","body":"<p>I am using mysql 5.5.27</p>\n\n<p>At places where it looks like double quotes are two single quotes closer together, and they are actually null values in the excel sheetin the db.</p>\n\n<p>I get the following error,</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLS… You have an error in your SQL syntax; \n  check the manual that corresponds to your MySQL server version for the right \n  syntax to use near 'CASE,lname,fname,gender,dob,ssn,… at line 1\n</code></pre>\n\n<p>the actual query is</p>\n\n<pre><code>Insert into \n  work(CASE,lname,fname,gender,dob\n</code></pre>\n"},{"tags":["android","sql","database","eclipse","debugging"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6618,"score":1,"question_id":6333412,"title":"How to view SQL database in Eclipse Debug mode for android","body":"<p>I am looking for a way to see realtime (as I debug) what is in my SQL database.</p>\n\n<p>Does anyone know how to do this?  I have tried looking through the variables tab but can't seem to find anything.</p>\n"},{"tags":["php","jquery","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13213700,"title":"Drupal site crashing","body":"<p>I am not a developer, I am just ask for advice on what my next step should be.</p>\n\n<p>2 months ago I launched my site using Drupal. <a href=\"http://www.evolvefitwear.com\" rel=\"nofollow\">http://www.evolvefitwear.com</a> So far it has crashed 3 times and been down for about 1.5 days each time. I have been told that the issue was with certain plug-ins not being compatible with others on the site. </p>\n\n<p>My question: </p>\n\n<p>1) is this a common issue Drupal/ PHP developers face when working on the backend </p>\n\n<p>2) if so what steps do you take to prevent it- back up \"testing\" site with different URL?</p>\n\n<p>3) would you suggest me contacting another developer to review the code, but if its fixed now would they find anything?   </p>\n\n<p>I have a handful of other tasks to complete on the site and open to suggestions on where I could turn to for help</p>\n\n<p>thanks! Kyla</p>\n"},{"tags":["php","mysql","sql","group"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13213205,"title":"messages between users: show conversations","body":"<p>right now, I am coding a message system for user communication. In the inbox I do not want to show the user the messages he/she received. I just want to show the conversations. So as an example, if one user send or receive more than one message then in the inbox there should only be the conversation (which includes the newest message, either written or received) with the user and when the user clicks on the conversation he/she can see all past messages.</p>\n\n<p>The table structure (simplified) of 'messages' is as followed:</p>\n\n<pre><code>message_id\nuser_id_sender\nuser_id_recipient\nmessage\n</code></pre>\n\n<p>Now the problem is that the messages are saved in a database where each row is one message, so I have to group these messages in a certain way.</p>\n\n<p>The select statement I came up with is the following:</p>\n\n<pre><code>SELECT * FROM messages\nWHERE user_id_sender = 1 OR user_id_recipient = 1\nGROUP BY user_id_sender\n</code></pre>\n\n<p>But now I obviously get two messages because one which has been written by user '1' and one that he has received..</p>\n\n<p>Does anybody have an idea how to solve this?</p>\n\n<p>Thank you in advance,</p>\n\n<p>Freddy</p>\n"},{"tags":["sql","mysql","sql-order-by","group-concat"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2449,"score":3,"question_id":1577860,"title":"Ordering in a MySQL GROUP_CONCAT with a function in it","body":"<p>I want to order the results in a GROUP_CONCAT function. The problem is, that the selection in the GROUP_CONCAT-function is another function, like this (fantasy select):</p>\n\n<pre><code>SELECT a.name,\n    GROUP_CONCAT(DISTINCT CONCAT_WS(':', b.id, c.name) ORDER BY b.id ASC) AS course\nFROM people a, stuff b, courses c\nGROUP BY a.id\n</code></pre>\n\n<p>I want to get a result like (ordered by b.id):</p>\n\n<pre><code>michael    1:science,2:maths,3:physics\n</code></pre>\n\n<p>but I get:</p>\n\n<pre><code>michael    2:maths,1:science,3:physics\n</code></pre>\n\n<p>Does anyone know how I can order by b.id in my group_concat here?</p>\n"},{"tags":["sql","sql-server","tsql","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13212883,"title":"How can I PIVOT this data?","body":"<p>First, sorry for the middling title.  Didn't have a ton of success on that front.</p>\n\n<p>So - I have a table of data that has one row for each volunteer shift a person is scheduled for.  Many people, being generous with their time, have signed up for multiple shifts.  What I would like is to PIVOT this data s.t. I end up with one row per <em>person</em>, with sets of columns for each shift.  I've spent about 90 minutes on this so far, but can't figure out how to PIVOT without an aggregation function applied.</p>\n\n<p>What I mean by this is that each person is scheduled for at least one shift, so each person's row would have their unique ID, their name, their phone number, and their region.  Then there would be a set of columns for Shift1 - role/status/start time/end time/etc. - which everyone would have filled out since everyone has signed up for at least one shift.  Then, the Shift2 set of columns would be populated for people who have signed up for 2+ shifts, Shift3 for people who signed up for 3+ shifts, etc.</p>\n\n<p>My current table schema:</p>\n\n<pre><code>CREATE TABLE [dbo].[confirmexport](\n    [PersonID] [int] NULL,\n    [EventType] [varchar](14) NULL,\n    [Shift] [varchar](10) NULL,\n    [StartDate] [datetime] NULL,\n    [StartTime] [datetime] NULL,\n    [EndDate] [datetime] NULL,\n    [EndTime] [datetime] NULL,\n    [Location] [varchar](39) NULL,\n    [Role] [varchar](16) NULL,\n    [Status] [varchar](9) NULL,\n    [FirstName] [varchar](20) NULL,\n    [LastName] [varchar](22) NULL,\n    [Phone] [bigint] NULL,\n    [Region] [varchar](9) NULL\n) ON [PRIMARY]\n</code></pre>\n\n<p>All columns but <code>PersonID</code>, <code>FirstName</code>, <code>LastName</code>, <code>Phone</code>, and <code>Region</code> are shift-specific.</p>\n\n<p>In an ideal world, I'd end up with a table that looked something like so:</p>\n\n<pre><code>CREATE TABLE [dbo].[confirmexportpivoted](\n    [PersonID] [int] NULL,\n    [Phone] [bigint] NULL,\n    [FirstName] [varchar](20) NULL,\n    [LastName] [varchar](22) NULL,\n    [Region] [varchar](9) NULL,\n    [EventType1] [varchar](14) NULL,\n    [Shift1] [varchar](10) NULL,\n    [StartDate1] [datetime] NULL,\n    [StartTime1] [datetime] NULL,\n    [EndDate1] [datetime] NULL,\n    [EndTime1] [datetime] NULL,\n    [Location1] [varchar](39) NULL,\n    [Role1] [varchar](16) NULL,\n    [Status1] [varchar](9) NULL,\n    [EventType2] [varchar](14) NULL,\n    [Shift2] [varchar](10) NULL,\n    [StartDate2] [datetime] NULL,\n    [StartTime2] [datetime] NULL,\n    [EndDate2] [datetime] NULL,\n    [EndTime2] [datetime] NULL,\n    [Location2] [varchar](39) NULL,\n    [Role2] [varchar](16) NULL,\n    [Status2] [varchar](9) NULL\n) ON [PRIMARY]\n</code></pre>\n\n<p>Except with as many sets of columns as necessary for my data.  OR - if that's a deal-breaker, I can definitely make do with 3.  Any suggestions?</p>\n\n<p>Thanks in advance - I am super-confused and would appreciate any and all help.</p>\n"},{"tags":["sql","oracle","date-arithmetic"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":851,"score":2,"question_id":9568787,"title":"SQL: Get records created in time range for specific dates","body":"<p>I have a set of records that were created last week, and from those I want to retrieve only those that were created between 6h45 and 19h15. I have a column <code>creation_date</code> that I can use.</p>\n\n<p>How can I do this in sql?</p>\n"},{"tags":["php","mysql","sql","collate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13213103,"title":"MySQL Union illegal mix of collations","body":"<p>I have the following in my PHP query:</p>\n\n<pre><code>SELECT tags.tag, theValues.* \nFROM ch09.tbl_tags tags \nRIGHT JOIN ((SELECT 'dog' as 'Vals')\nUNION (SELECT 'cat' as 'Vals')) theValues on tags.tag = theValues.Vals\n</code></pre>\n\n<p>After the \"RIGHT JOIN\" everything within the brackets are created on the fly from user input.</p>\n\n<p>It worked fine in MySQL 4, but I just had a new computer and installed 5.5, imported the SQL dump as <code>UTF-8</code>. But I get: </p>\n\n<blockquote>\n  <p>\"Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation '='\"</p>\n</blockquote>\n\n<p>There's probably a better way to construct my query, all I need is everything the user inputs in one column as \"<code>Vals</code>\" and if there's a matching tag in <code>tbl_tags.tag</code> then it should be there in a column called \"tag\" else the tag column is blank.</p>\n\n<p>I have tried using Collate: <a href=\"http://www.answermysearches.com/mysql-fixing-illegal-mix-of-collations-message/352/\" rel=\"nofollow\">http://www.answermysearches.com/mysql-fixing-illegal-mix-of-collations-message/352/</a>, but I simply cannot get it to work.</p>\n\n<p>So I need to either construct a better query or use the collate function somehow, but how?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Craig</p>\n"},{"tags":["java","mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13166471,"title":"MySQL syntax error using Java in Eclipse","body":"<p>I have the following prepared statement for sql  in Java :</p>\n\n<p>com.mysql.jdbc.JDBC4PreparedStatement@6e56103e:</p>\n\n<pre><code>INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)VALUES(2502591,'2000-03-02 02:02:02','5x5 aptb wdw','00:55:48','DotA v6.75b.w3x','aptb ')ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameStart),`Name`=VALUES(Name),`Lenght`=VALUES(Lenght),`MapVersion`=VALUES(MapVersion),`Mode`=VALUES(Mode).\n</code></pre>\n\n<p>When I execute it in Eclipse I get the following error:</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?,?,?,?,?,?)ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameSta' at line 1.\n</code></pre>\n\n<p>But at the same time when I execute the same query in SQLyog I don't get an error. Rows are updated. What can be a problem? Thanks in advance</p>\n\n<p>Code:</p>\n\n<pre><code>  Class.forName(\"com.mysql.jdbc.Driver\");\n    Connection con = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/dota\",\"root\",\"root\");\n    PreparedStatement updateGame = null;\n    String updatingGame = \"INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)\" +\n                \"VALUES(?,?,?,?,?,?)\" +\n                \"ON DUPLICATE KEY UPDATE \" +\n                \"`Id`=VALUES(Id),\"+\n                \"`GameStart` = VALUES(GameStart),\" +\n                \"`Name`=VALUES(Name),\" +\n                \"`Lenght`=VALUES(Lenght),\" +\n                \"`MapVersion`=VALUES(MapVersion),\" +\n                \"`Mode`=VALUES(Mode)\";\n    con.setAutoCommit(false);\n    updateGame=con.prepareStatement(updatingGame);\n                updateGame.setInt(1, game.Id);\n                Timestamp timestamp = new Timestamp(100,2,2,2,2,2,2);\n                updateGame.setTimestamp(2,timestamp);\n                updateGame.setString(3, game.GameName);\n                updateGame.setTime(4, (Time) game.Time);\n                updateGame.setString(5, game.MapVersion);\n                updateGame.setString(6, game.Mode);\n                updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>And on:</p>\n\n<pre><code>updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>I get an error</p>\n"},{"tags":["mysql","sql","syntax","limit"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13213025,"title":"SQL Syntax, What am I doing wrong?","body":"<p>I have the following syntax, and all runs fine except for \"LIMIT\". All the results of the database display when only 9 results should. I have the \"0, 9\" coming from variables so they will change on each paginated link (ex. 0, 9; 10, 18; 19, 27; etc.). I checked and rechecked my syntax and I don't understand why all the results would show. Below is the exact query I'm testing.</p>\n\n<p>Also to note, I'm using XAMPP</p>\n\n<pre><code>FROM acb_accfitems WHERE itemtype = 'furniture' ORDER BY price DESC LIMIT 0, 9\n</code></pre>\n"},{"tags":["sql","python-3.x","kml","google-earth","pyodbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":10371935,"title":"Python generates KML but not displayed in google earth network link properly","body":"<p>If the cursor has many rows, the generated kml is not shown in google earth, but the code generated can be seen through python shell.. If there are fewer rows ( 7 or 8 ) then this script easily generates a network link for kml file in google earth.. Thanks for your kind help</p>\n\n<pre><code>import pyodbc\nkml = ('&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\\n'\n'&lt;kml xmlns=\"http://www.opengis.net/kml/2.2\"xmlns:gx=\"http://www.google.com/kml/ext/2.2\" xmlns:kml=\"http://www.opengis.net/kml/2.2\" xmlns:atom=\"http://www.w3.org/2005/Atom\"&gt;\\n'\n'&lt;Document&gt;\\n'\n'&lt;name&gt;documentname&lt;/name&gt;\\n'\n'&lt;StyleMap id=\"default\"&gt;\\n'\n'&lt;Pair&gt;\\n'\n'&lt;key&gt;normal&lt;/key&gt;\\n'\n'&lt;styleUrl&gt;#default0&lt;/styleUrl&gt;\\n'\n'&lt;/Pair&gt;\\n'\n'&lt;Pair&gt;\\n'\n'&lt;key&gt;highlight&lt;/key&gt;\\n'\n'&lt;styleUrl&gt;#hl&lt;/styleUrl&gt;\\n'\n'&lt;/Pair&gt;\\n'\n'&lt;/StyleMap&gt;\\n'\n'&lt;Style id=\"hl\"&gt;\\n'\n'&lt;IconStyle&gt;\\n'\n'&lt;scale&gt;1.2&lt;/scale&gt;\\n'\n'&lt;/IconStyle&gt;\\n'\n'&lt;/Style&gt;\\n'\n'&lt;Style id=\"default0\"&gt;\\n'\n'&lt;/Style&gt;\\n'\n'&lt;Folder&gt;\\n'\n'&lt;name&gt;foldername&lt;/name&gt;')\n\n print ('Content-Type: application/vnd.google-earth.kml+xml\\n')\n print (kml)        \n\n\ndef placemarkize(rowdata):\n placemark = (\n '&lt;Placemark&gt;\\n'\n '&lt;name&gt;%s&lt;/name&gt;\\n'\n '&lt;Point&gt;\\n'\n '&lt;coordinates&gt;%f,%f&lt;/coordinates&gt;\\n'\n '&lt;/Point&gt;\\n'\n '&lt;/Placemark&gt;'\n ) %(rowdata[1],rowdata[11],rowdata[10])\n print(placemark)\n return ()\n\n\nconn = pyodbc.connect('Driver={SQL Server};server=research;database=database;uid=;pwd=')\ncur=conn.cursor()\ncur.execute(\"select * from tbltvet where district like 'kas%'\")\nwhile 1:\nrow = cur.fetchone()\nif not row:\n    break\nplacemarkize(row)\n\n\nkml = ('&lt;/Folder&gt;\\n&lt;/Document&gt;\\n&lt;/kml&gt;')\n\nprint (kml)\nconn.close()\n</code></pre>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":54,"score":-1,"question_id":13209775,"title":"Creating table in Oracle","body":"<p>My requirement is that the column <code>accno</code> has no null value and no duplicates. The name column has no nulls and accepts only A to Z (no other like number or * $). The <code>acctype</code> columns is a character that allows only ( 'S'  , 'C' ,'R') and the <code>balance</code> column has no null values. If <code>acctype</code> is S then balance should be >= 5000, when C the balance should be > 10000 and when it's R >= 5000.</p>\n\n<p>I am trying to apply this with:</p>\n\n<pre><code>create table kcb_acc_tab\n (accno varchar2(20)\n    constraint kcb_acc_Pk\n      primary key, \n  name varchar2(20)\n    constraint kcb_name_NN\n      Not null\n    constraint kcb_name_CK \n      check((name =upper(name)) and (name like '[(A-Z)]')),\n  Acctype char\n    constraint kcb_acctype_ck\n      check (acctype in('S' ,'C' ,'R')) ,\n  Doo timestamp\n    default sysdate ,\n  bal number(7,2) kcb_bal_NN\n    constraint kcb_bal_ck\n      check((aacctype ='S' and bal &gt;=5000) or\n            (acctype = 'C' and bal &gt;=10000) or\n            (acctype ='R' and bal &gt;=5000));\n</code></pre>\n"},{"tags":["php","mysql","sql","sqlite","pdo"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":411,"score":1,"question_id":9244053,"title":"SQLite syntax not compatible with MySQL?","body":"<p>I'm using PDO and trying to make my application support both MySQL and SQLite, but in sqlite I get this error when I try to import my database schema:</p>\n\n<p><code>SQLSTATE[HY000]: General error: 1 near \"AUTO_INCREMENT\": syntax error</code></p>\n\n<p>The query looks like this:</p>\n\n<pre><code>CREATE TABLE events (\n\n  id INT UNSIGNED NOT NULL AUTO_INCREMENT,\n  name VARCHAR(32) NOT NULL,\n  title VARCHAR(64) NOT NULL,\n  description LONGTEXT,\n  starttime DATETIME DEFAULT '0000-00-00 00:00:00',\n\n  PRIMARY KEY(id),\n  KEY name(name)\n\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;\n</code></pre>\n\n<p>(and it works in a MySQL database.)</p>\n\n<p>I don't understand what the problem is here? Shouldn't both database systems be compatible?</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":313,"score":3,"question_id":3872173,"title":"Compare when value could be both NULL or text","body":"<p>Now I know you can't directly compare NULL to anything (as null is unknown) so how would I achieve the following:</p>\n\n<pre><code>select  *\n    from    Material as m\n    where   MtrlCode = 826 and\n            Exposlimit &lt;&gt; 'compareMe'\n</code></pre>\n\n<p>Where Exposlimit MAY be NULL or it may not be.\n'compareMe' may also be NULL.</p>\n\n<p>Therefore how do I compare the two?  Both sides could be either text or NULL.</p>\n"},{"tags":["android","sql","sqlite","bit-manipulation","where"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13211365,"title":"Android/SQLite - Bit operation on WHERE clause","body":"<p>I'd like to know if it's possible to do in Android something like this:</p>\n\n<pre><code>public Cursor getFlowsByCategory(int type, int categoryID, int limit) {\n\n    SQLiteDatabase db = dbHelper.getReadableDatabase();\n\n    final String[] columns = {ID, FLAGS, SUBJECT, AMOUNT, AMOUNT_NO, CATEGORY};\n    final String selection = \"((\" + FLAGS + \" &amp; ?) &gt;&gt; 1 = ?) AND (\" + CATEGORY + \" = ?)\";\n    final String[] selectionArgs = {Integer.toString(Flow.FLOW_TYPE), Integer.toString(type), Integer.toString(categoryID)};\n\n    return db.query(TABLE, columns, selection, selectionArgs, null, null, ID + \" DESC\", Integer.toString(limit));\n\n}\n</code></pre>\n\n<p>FLAGS is a 1-byte bit mask and I'd like to select only the rows which has the second bit (position 1) of the mask on. The mask (Flow.FLOW_TYPE) is 0b00000010 and the type parameter can be either 0 or 1. It should work but it doesn't: what am I doing wrong?</p>\n"},{"tags":["sql","sql-server-2008","database-design","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13211739,"title":"Bug Tracking How to design Project Access in Sql Database schema","body":"<p>I am working on a small open-source project on Bug Tracking.</p>\n\n<p>I am a little confused on something which I need help with.</p>\n\n<p>I have two tables, one is Users and other is Projects.</p>\n\n<p><strong>Users</strong></p>\n\n<ul>\n<li>UserId</li>\n<li>Username</li>\n</ul>\n\n<p><strong>Project</strong></p>\n\n<ul>\n<li>ProjectId</li>\n<li>ProjectName</li>\n<li>ProjectDescription</li>\n</ul>\n\n<p>I have more fields, but I have abstracted them now, to make this question small.</p>\n\n<p><strong>I wanted to know how to create a relationship between Projects and Users ?</strong></p>\n\n<p>Should I have one more table that stores User-Project relationships something like</p>\n\n<p><strong>ProjectAccess</strong></p>\n\n<ul>\n<li>Id</li>\n<li>ProjectId</li>\n<li>UserId</li>\n<li>AccessType (Admin/User)</li>\n</ul>\n\n<p>I am a little new to Database schema designing, so I am not very sure. So I'm here to have a second opinion on this.</p>\n\n<p>Also I would like to know how to provide the option for an admin to add a user and how to handle this at back end.</p>\n\n<p>Any thought, comment or answers will be highly appreciated. Thanks.</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13210493,"title":"appending row number in sql select statement with row value","body":"<p>I am trying to concatenate the select statment results in one row.<br>\nFor eg :\nFor this select statement output :  </p>\n\n<pre><code>Name  \nABC  \nDEF  \nGHI\n</code></pre>\n\n<p>I needed following Output :<br>\nName  </p>\n\n<pre><code>1 ABC, 2 DEF, 3 GHI  \n</code></pre>\n\n<p>(Means row number should be appended in front for each row)<br>\nI am using wm_concat() function but it is giving me the following o/p : <code>ABC,DEF,GHI</code><br>\nCan anyone help ?</p>\n"},{"tags":["python","sql","database","in-memory-database"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":936,"score":7,"question_id":3047412,"title":"in-memory database in Python","body":"<p>I'm doing some queries in Python on a large database to get some stats out of the database. I want these stats to be in-memory so other programs can use them without going to a database. </p>\n\n<p>I was thinking of how to structure them, and after trying to set up some complicated nested dictionaries, I realized that a good representation would be an SQL table. I don't want to store the data back into the persistent database, though. Are there any in-memory implementations of an SQL database that supports querying the data with SQL syntax?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13211268,"title":"returning total records in cte","body":"<p>With help from <a href=\"http://pratchev.blogspot.com/2008/11/paging-with-ranking-functions.html?m=1\" rel=\"nofollow\">article here</a> and recent answers from SO experts I have arrived with the following which will help me efficiently page through a set of records.</p>\n\n<p>I think my last couple of questions are </p>\n\n<ol>\n<li>See how I include the <code>Total Number of Records</code> in the payload at the end\nof SQL CTE called 'Total'. Is that how you would do this? </li>\n<li>Any other suggestions? Potential areas for being more concise or improvements? <code>Return Total Number of Pages</code></li>\n</ol>\n\n<hr>\n\n<pre><code>DECLARE @page_size INT = 5;\nDECLARE @page_nbr INT = 4;\nDECLARE @search NVARCHAR(MAX) = '';\nDECLARE @sort_order INT = 2;\n\nWITH AllProducts\nAS\n(\nSELECT *, \nCASE @sort_order\n    WHEN 1 THEN ROW_NUMBER() OVER ( ORDER BY ProductID )\n    WHEN 2 THEN ROW_NUMBER() OVER ( ORDER BY ProductName )\nEND AS 'Seq'    \nFROM Products\n),\nFiltered\nAS\n(\nSELECT * FROM AllProducts\nWHERE ProductName like '%'+@search+'%'\nOR\n@search is null\n)\nSELECT (select COUNT(*) from Filtered) as 'Total', * FROM Filtered\nWHERE seq &gt; (@page_nbr - 1) * @page_size\n  AND seq &lt;= @page_nbr * @page_size\n</code></pre>\n"},{"tags":["python","sql","ms-access","firebird","pyodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":60,"score":-2,"question_id":13210956,"title":"ProgrammingError: '42S02', '[42S02] [Microsoft]","body":"<p>I wrote the following code</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\ncon = sqlite3.connect('borey.db')\nsampling_tables=con.cursor()\nsampling_fields=con.cursor()\nsampling_constraints=con.cursor()\nsampling_constraints_fields=con.cursor()\nsampling_indices=con.cursor()\nsampling_indices_fields=con.cursor()\nsampling_indices_props=con.cursor()\nsampling_fields_from_constraints=con.cursor()\njs=[]\n\nsampling_tables.execute(sql.sqltables)\n\nfor table in sampling_tables:\n    tabledict=dict(inform_about_table='?', fields='?', constraints='?', indices='?')\n    information_about_table_dict=dict(name=table[1], description=table[2], can_add=table[3], can_edit=table[4], can_delete=table[5])\n    #print(js_information_about_table)\n    tabledict['inform_about_table']=information_about_table_dict\n    #print(tabledict)\n    table_id=table[0]\n    sampling_fields.execute(sql.sqlfields,(table_id,))\n    listfields=[]\n    for field in sampling_fields:\n        fielddict=dict(position=field[0], name=field[1], description=field[2], datatype=field[3], char_length=field[4], can_input=field[5], can_edit=field[6], show_in_grid=field[7],\n                      is_mean=field[8], autocalculated=field[9], required=field[10])\n        listfields.append(fielddict)\n    tabledict['fields']=listfields\n    #print(tabledict)\n    sampling_constraints.execute(sql.sqlconstraints,(table_id,))\n    listconstraints=[]\n    for constraint in sampling_constraints:\n        constraintdict=dict(name=constraint[1], constrtype=constraint[2], items='?', reference=constraint[3])\n        sampling_constraints_fields.execute(sql.sql_constr_det,(constraint[0],table_id))\n        listitems=[]\n        for constr_det in sampling_constraints_fields:\n            listitems.append(constr_det[0])\n        constraintdict['items']=listitems\n        listconstraints.append(constraintdict)\n    tabledict['constraints']=listconstraints\n    #print(tabledict)\n    sampling_indices.execute(sql.sqlindices,(table_id,))\n    listindices=[]\n    for index in sampling_indices:\n        indexdict=dict(name=index[1], items='?', position='?', props='?')\n        index_id=index[0]\n        sampling_indices_fields.execute(sql.sql_indices_fields,(table_id,index_id))\n        #sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id, ))\n        listfields=[]\n        listpositions=[]\n        listprops=[]\n        for index_det in sampling_indices_fields:\n            listfields.append(index_det[0])\n            listpositions.append(index_det[1])\n            fieldinindex=index_det[0]\n        sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id,fieldinindex))            \n        for index_desc in sampling_indices_props:\n            listprops.append(index_desc[0])\n        indexdict['items']=listfields\n        indexdict['position']=listpositions\n        indexdict['props']=listprops\n        listindices.append(indexdict)\n    tabledict['indices']=listindices\n    #print(tabledict)\n    js.append(tabledict)\nos.remove('D:/boreas.fdb')\nconn=firebirdsql.create_database(host='localhost', database='D:/boreas.fdb', user='sysdba', password='masterkey')\n#conn=firebirdsql.connect(host='localhost',database='D:/ThirdTask/test.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nfor nametable in js:\n    s=''\n    s+='create table '+nametable['inform_about_table']['name']+'\\n'\n    s+='('+'\\n'\n    countfield=0\n    for namefield in nametable['fields']:\n        s+='   '\n        if namefield['name']=='COUNT':\n            s+='QUANTITY'\n        else:\n            if namefield['name']=='MINIMUM QUANTITY FOR ORDER REPETITION':\n                s+='MINIMUM_QUANTITY'\n            else:\n                if namefield['name']=='PRICE ACCORDING TO THE PRICE-LIST':\n                    s+='LIST_PRICE'\n                else:\n                    if (namefield['name'].count(' ')!=0) or (namefield['name'].count('-')!=0) or (namefield['name'].count('/')!=0):\n                        s+='\"'+namefield['name']+'\"'\n                    else:                    \n                        s+=namefield['name']\n        if namefield['datatype']=='FMTBCD':\n            s+='   '+' INTEGER NOT NULL'\n        else:\n            if namefield['datatype']=='STRING': \n                s+='   '+'VARCHAR'\n            else:\n                if namefield['datatype']=='MEMO':\n                    s+='   '+'BLOB SUB_TYPE 1'\n                else:            \n                    if namefield['datatype']=='LARGEINT':\n                        s+='   '+'INTEGER'\n                    else:\n                        if namefield['datatype']=='SMALLINT':\n                            s+='   '+'INTEGER'\n                        else:\n                            if namefield['datatype']=='CURRENCY':\n                                s+='   '+'NUMERIC(18,2)'\n                            else:\n                                if namefield['datatype']=='BOOLEAN':\n                                    s+='   '+'INTEGER'\n                                else:    \n                                    s+='   '+namefield['datatype']           \n        if namefield['datatype']=='STRING':\n            s+='('+str(namefield['char_length'])+')'\n        countfield+=1\n        #if countfield!=len(nametable['fields']):\n        s+=','+'\\n'\n        #else:\n            #s+='\\n'\n            #s+='\\n'\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='PRIMARY':\n            s+='   CONSTRAINT '+nameconstraint['name']+ ' PRIMARY KEY('\n            countfieldinconstr=0\n            for namefield in nameconstraint['items']:\n                countfieldinconstr+=1\n                if countfieldinconstr!=len(nameconstraint['items']):\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+','\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+','\n                            else:    \n                                s+=namefield+','\n                else:\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+')'+'\\n'\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+')'+'\\n'\n                            else:       \n                                s+=namefield+')'+'\\n'\n    s+=');'+'\\n'\n    print s\n    cur.execute(s)\n    #conn.commit()\n    #conn.begin()\n    for nameindex in nametable['indices']:\n        #print 'nameidex[props] ', nameindex['props']\n        s=''\n        for prop in nameindex['props']:\n            if prop==0:\n                if (nameindex['name'].count(' ')!=0) or (nameindex['name'].count('-')!=0) or (nameindex['name'].count('/')!=0):\n                    s+='create ascending index \"'+nameindex['name'] + '\" on '+nametable['inform_about_table']['name']+' ('\n                else:\n                    if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_INVENTORY_ID':\n                        s+='create ascending index ' + 'IDX_INVENTORY_ID' + ' on '+nametable['inform_about_table']['name']+' ('\n                    else:\n                        if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_ORDERDETAILS':\n                            s+='create ascending index ' + 'IDX_ORDERDETAILS' + ' on '+nametable['inform_about_table']['name']+' ('\n                        else:    \n                            if nameindex['name'].count('INFORMATION_ABOUT_ORDER_')!=0:\n                                s+='create ascending index ' + nameindex['name'][1:4]+nameindex['name'][-len(nameindex['name'])+28:] + ' on '+nametable['inform_about_table']['name']+' ('\n                            else:\n                                s+='create ascending index '+nameindex['name'] + ' on '+nametable['inform_about_table']['name']+' ('\n            countitem=0\n            for nameitem in nameindex['items']:\n                if countitem!=len(nameindex['items'])-1:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+', '\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+', '\n                            else:  \n                                s+=nameitem+', '\n                else:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+');'+'\\n'\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+');'+'\\n'\n                            else:  \n                                s+=nameitem+');'+'\\n'\n                countitem+=1\n        print s\n        cur.execute(s)\n        #conn.commit()\nfor nametable in js:\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='FOREIGN':\n            s=''\n            s+='ALTER TABLE '+nametable['inform_about_table']['name']+'\\n'\n            s+='  '+'ADD CONSTRAINT '+nameconstraint['name']+' FOREIGN KEY ('  \n            for namefield in nameconstraint['items']:\n                if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                    s+='\"'+namefield+'\")'+'\\n'\n                else:\n                    s+=namefield+')'+'\\n'\n            s+='      '+'REFERENCES '+nameconstraint['reference']\n            sampling_fields_from_constraints.execute(sql.sql_fields, (nameconstraint['reference'],))\n            for fields in sampling_fields_from_constraints:\n                field=fields[0]\n                if (field.count(' ')!=0) or (field.count('-')!=0) or (field.count('/')!=0):\n                    s+=' (\"'+field+'\");'+'\\n'\n                else:\n                    s+=' ('+field+');'+'\\n'\n            print s\n            cur.execute(s)\n            #conn.commit()            \nconn.commit()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID   INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"    VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB\n);\n\"\"\"\ns1='create ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);'\n\"\"\"db = 'D:/ThirdTask/Northwind.accdb' \nconnaccess = win32com.client.Dispatch(r'ADODB.Connection')\nDSN = ('PROVIDER = Microsoft.Jet.OLEDB.4.0;DATA SOURCE = ' + db +  ';') \nconnaccess.Open(DSN) \nrs = win32com.client.Dispatch(r'ADODB.Recordset') \nstrsql = \"select * from deer\" \nrs.Open(strsql, conn, 1, 3) \nt = rs.GetRows() \nconnaccess.Close() \n\"\"\"\nconAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nSqlAccess.execute(sql.sql_count_records_clients);\nCountOfRecords=SqlAccess.fetchone();\n#print s\n#cur.execute(s)\n#conn.commit()\n#cur.execute(s1)\n#conn.commit()\n#cur=con.cursor()\ncon.close()\nconn.close()\nconAcc.close();\n#print \"Connect succesfully\"\n</code></pre>\n\n<p>As a result, when you run, I get the following error</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 250, in &lt;module&gt;\n    SqlAccess.execute(sql.sql_count_records_clients);\nProgrammingError: ('42S02', '[42S02] [Microsoft][\\xc4\\xf0\\xe0\\xe9\\xe2\\xe5\\xf0 ODBC Microsoft Access] \\xdf\\xe4\\xf0\\xee \\xe1\\xe0\\xe7\\xfb \\xe4\\xe0\\xed\\xed\\xfb\\xf5 Microsoft Office Access \\xed\\xe5 \\xec\\xee\\xe6\\xe5\\xf2 \\xed\\xe0\\xe9\\xf2\\xe8 \\xe2\\xf5\\xee\\xe4\\xed\\xf3\\xfe \\xf2\\xe0\\xe1\\xeb\\xe8\\xf6\\xf3 \\xe8\\xeb\\xe8 \\xe7\\xe0\\xef\\xf0\\xee\\xf1 \"\\xd1\\xef\\xe8\\xf1\\xee\\xea \\xea\\xeb\\xe8\\xe5\\xed\\xf2\\xee\\xe2\".  \\xcf\\xf0\\xee\\xe2\\xe5\\xf0\\xfc\\xf2\\xe5 \\xf1\\xf3\\xf9\\xe5\\xf1\\xf2\\xe2\\xee\\xe2\\xe0\\xed\\xe8\\xe5 \\xf2\\xe0\\xe1\\xeb\\xe8\\xf6\\xfb \\xe8\\xeb\\xe8 \\xe7\\xe0\\xef\\xf0\\xee\\xf1\\xe0 \\xe8 \\xef\\xf0\\xe0\\xe2\\xe8\\xeb\\xfc\\xed\\xee\\xf1\\xf2\\xfc \\xe8\\xec\\xe5\\xed\\xe8. (-1305) (SQLExeсDirectW)')\n</code></pre>\n\n<p>(in Russian language)\nThe module sql.py has the contents</p>\n\n<pre><code># -*- coding: cp1251 -*-\nsqltables='''SELECT id, name, description, can_add, can_edit, can_delete FROM tables'''\nsqlfields = '''SELECT fields.position,fields.name,fields.description,\ndata_types.type_id,domains.char_length,\nfields.can_input,fields.can_edit,\nfields.show_in_grid,fields.is_mean, fields.autocalculated,\nfields.required\nFROM fields\nJOIN domains ON fields.domain_id = domains.id\nJOIN data_types ON domains.data_type_id = data_types.id\nWHERE fields.table_id = ?\nORDER BY fields.position\n'''\nsqlconstraints='''SELECT constraints.id,\nconstraints.name, constraint_type, constraints.reference,\ntables.name\nFROM constraints\nLEFT JOIN tables ON constraints.table_id = tables.id\nWHERE table_id = ? '''\nsql_constr_det = '''SELECT fields.name, tables.name\nFROM constraint_details\nJOIN fields ON constraint_details.field_id = fields.id\nJOIN tables ON tables.id=fields.table_id\nWHERE constraint_id = ?\nAND tables.id= ? '''\nsqlindices = '''SELECT indices.id,indices.name\nFROM indices\nWHERE indices.table_id = ? '''\nsql_indices_fields = '''SELECT fields.name,\nindex_details.position\nFROM indices\nJOIN index_details ON index_id = indices.id\nJOIN fields ON field_id = fields.id\nWHERE indices.table_id = ?\nAND indices.id=?'''\nsql_indices_descend='''SELECT index_details.descend\nFROM index_details\nJOIN indices ON index_details.index_id = indices.id\nJOIN fields ON field_id = fields.id \nWHERE indices.table_id = ?\nAND indices.id = ?\nAND fields.name = ?'''\nsql_fields='''SELECT fields.name\nFROM fields\nJOIN tables ON tables.id=fields.table_id\nJOIN constraints ON (constraints.table_id=tables.id and constraints.constraint_type='PRIMARY')\nJOIn constraint_details ON (constraint_details.constraint_id=constraints.id and constraint_details.field_id=fields.id)\nWHERE tables.name= ?'''\nsql_count_records_clients='''SELECT COUNT(*) FROM \"Список клиентов\"'''\n</code></pre>\n\n<p>For this error and how to fix it? I would also like to know how to translate the text of the error on the normal encoding?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3823,"score":3,"question_id":3702576,"title":"SQL if no rows are returned do this","body":"<p>I have a select statement and I want to say if this select statement does not return any rows then put a '' in every cell. How do I do this?</p>\n"},{"tags":["php","sql","tags"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13211841,"title":"SQL Auto Increment ID","body":"<p>I have an SQL table with an auto-increment field. I know people have asked how to retrieve the ID of the 'last entry' after the insert has taken place, and I know how to do that. What I want to do is duplicate the auto-generated field in to a second column of the same table - how do I modify my insert code to do this:</p>\n\n<pre><code>mysql_query(\"INSERT INTO `tags` (`tid`,`tagid`,`tagname`) VALUES('','INSERTED.ID','{$tagname}')\");\n</code></pre>\n\n<p>The reason I want to do this is because I want to be able to make two rows equal each other. I.E. if two different tags (with different unique ids) have the same tagid, then I can use the 'tagid' reference elsewhere as a unique identifier and cycle through them. I can also retain knowledge of which tag is the parent tag - because it will have the same 'tid' as 'tagid'.</p>\n\n<p>I have a system for tagging events; but sometimes I miss-spell a tag... so rather than correcting all the mistakes, I want to make my system error proof by allowing miss-spelt tags to be joined up and treated the same way as a the correct tag. </p>\n\n<p>Would appreciate your help - even if that means doing this a completely different way.</p>\n\n<p>Thanks,</p>\n"},{"tags":["sql","oracle","oracle11g","top-n"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13209962,"title":"inner join on table with multiple record","body":"<p>I have two tables as follows</p>\n\n<h3>table1</h3>\n\n<pre><code>column1|column2\n----------------\na1     | c1\n----------------\na2     | c2\n</code></pre>\n\n<h3>table2</h3>\n\n<pre><code>column1|column2|column3\n----------------------\n1      | a1    | x\n-----------------------\n2      | a1    | y\n-----------------------\n3      | a1    | z\n-----------------------\n4      | a2    | ab\n-----------------------\n5      | a2    | cd\n-----------------------\n6      | a2    | ef\n</code></pre>\n\n<p>Table1 is the parent table and table2 is the child table.</p>\n\n<p>Column1 of table1 is mapped to column2 of table2.</p>\n\n<p>Table2 can contain multiple records for each entry of column1 in table1 some thing like this.</p>\n\n<p>I want to join table1 to table2, but I want only the first record of all entries of table2.</p>\n\n<p>So my result set will be </p>\n\n<pre><code>column1|column2|column3\n----------------------\n1      | a1    | x\n-----------------------\n2      | a2    | ab\n</code></pre>\n\n<p>How to make a join to achieve this in oracle 11 g. I use sql navigator +</p>\n"},{"tags":["sql","list"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":26,"score":-2,"question_id":13211459,"title":"Listing two tables","body":"<p>Here is the question I was asked:</p>\n\n<p>List the various vision powers of the heroes in alphabetical order. Each vision power should appear only once</p>\n\n<p>ID  codename    description</p>\n\n<p>I am trying to obtain the following description with the word \"Vision\" and \"vision\" I have tried to use wildcards but nothing seems to be working, in the discription it offers different types of Vision powers such as X-Ray vision</p>\n"},{"tags":["python","sql","ms-access","encoding","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13210697,"title":"SyntaxError: Non-ASCII character '\\xd1'","body":"<p>I wrote the following code</p>\n\n<pre><code>conAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nSqlAccess.execute(sql.sql_count_record_clients);\nCountOfRecords=SqlAccess.fetchone();\nconAcc.close();\n</code></pre>\n\n<p>where there is a line in module sql.py</p>\n\n<pre><code>sql_count_records_clients='''SELECT COUNT(*) FROM \"Список клиентов\"'''\n</code></pre>\n\n<p>As a result this line in sql.py gives out an error</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 5, in &lt;module&gt;\n    import json,sqlite3,sql\n  File \"D:\\ThirdTask\\sql.py\", line 48\nSyntaxError: Non-ASCII character '\\xd1' in file D:\\ThirdTask\\sql.py on line 48, but no encoding declared; see http://www.python.org/peps/pep-0263.html for details\n</code></pre>\n\n<p>What should be done to make the error disappear?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3803,"score":3,"question_id":1344401,"title":"How can I drop all indexes in a SQL database with one command?","body":"<p>So, how can I drop all indexes in a SQL database with one command?   I have this command that will get me all the 20 or so drop statements, but how can I run all of those drop statements from this \"result set\"?</p>\n\n<pre><code>select * from vw_drop_idnex;\n</code></pre>\n\n<p>Another variation that gives me the same list is:</p>\n\n<pre><code>SELECT  'DROP INDEX ' + ix.Name + ' ON ' + OBJECT_NAME(ID)  AS QUERYLIST\nFROM  sysindexes ix\nWHERE   ix.Name IS NOT null and ix.Name like '%pre_%'\n</code></pre>\n\n<p>I tried to do \"exec(select cmd from vw_drop_idnex)\" and it didn't work.  I am looking for something that works like a for loop and runs the queries one by one.</p>\n\n<h2>-----------------------</h2>\n\n<p>With Rob Farleys help, final draft of the script is:</p>\n\n<pre><code>declare @ltr nvarchar(1024);\nSELECT @ltr = ( select 'alter table '+o.name+' drop constraint '+i.name+';'\n  from sys.indexes i join sys.objects o on  i.object_id=o.object_id\n  where o.type&lt;&gt;'S' and is_primary_key=1\n  FOR xml path('') );\nexec sp_executesql @ltr;\n\ndeclare @qry nvarchar(1024);\nselect @qry = (select 'drop index '+o.name+'.'+i.name+';'\n  from sys.indexes i join sys.objects o on  i.object_id=o.object_id\n  where o.type&lt;&gt;'S' and is_primary_key&lt;&gt;1 and index_id&gt;0\nfor xml path(''));\nexec sp_executesql @qry\n</code></pre>\n"},{"tags":["sql","database","scala","jdbc"],"answer_count":15,"favorite_count":117,"up_vote_count":135,"down_vote_count":0,"view_count":32132,"score":135,"question_id":1362748,"title":"Wanted: Good examples of Scala database persistence","body":"<p>I would like to use Scala to persist data to a relational database, so what I am looking for are examples of CRUD operations using Scala.  </p>\n\n<p>I would like to code on a lower level of abstraction than an ORM like Hibernate/Toplink (read:JDBC), but between us, I would like to see examples of all types.</p>\n"},{"tags":["sql","mysql","join","query-optimization"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1931,"score":1,"question_id":3257575,"title":"Mysql query with Left Join is too very slow","body":"<p>Query:</p>\n\n<pre><code>   select `r`.`id` as `id` \n     from `tbl_rls` as `r` \nleft join `tblc_comment_manager` as `cm` on `cm`.`rlsc_id` != `r`.`id`\n</code></pre>\n\n<p>Both tables have 8k records but why is it very slow, taking 2-3 minutes and more sometimes?</p>\n\n<p>OMG , this query makes mysql server down. Will get back to you peoples in a second :(</p>\n\n<p>All peoples those suggested Indexing the columns are all Correct.\nYeh the query i wrote was silly and buggy. Thanks correcting me.</p>\n"},{"tags":["php","mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":13211439,"title":"SQL copy data from one column to another table specified column","body":"<p>i have two tables name called by <strong><code>order</code></strong> and <strong><code>order_product</code></strong>, both tables have a column same name <code>model</code>, <code>order_product</code> <code>model</code> column have lots of data, but <code>order</code> <code>model</code> empty field. </p>\n\n<p>i want copy <code>model</code> data from table <code>order_product</code> to <code>model</code> table <code>order</code>, how can i do this.? </p>\n\n<p>i tried some SQL query, but the result not like really what i want, its look all field will be duplicate...</p>\n\n<pre><code>INSERT INTO `order` (model) SELECT (model) FROM `order_product`\n</code></pre>\n"},{"tags":["c#","sql","winforms","string"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13211379,"title":"C# SQL login - Adding information fail","body":"<p>Ok so I have a string issue. Im not sure if its simple and ive just been stareing at it for ages and come to nothing, or it's something I can't avoid? </p>\n\n<p>So I am trying to login to an SQL server using C#. Once the login box shows up I pass the username and password to a connection class and the login is Sucessful. </p>\n\n<pre><code>    public void login(object sender, EventArgs e)\n    {\n        sqlconnect sql = new sqlconnect();\n\n        sql.us = textBox1.Text;\n        sql.pas = textBox2.Text;\n            try\n            {\n                sql.GetSqlConnection();\n                sql.myConnection.Open();\n                label3.Text = \"Connected\";\n                this.Hide();\n                fronthyb.Show();\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n        }\n</code></pre>\n\n<p><strong>So below is my connection class:</strong></p>\n\n<pre><code>    public class sqlconnect\n{\n    public SqlConnection myConnection { get; set; }\n    public String us;\n    public String pas;\n    Settings1 set = new Settings1();\n\n\n    public SqlConnection GetSqlConnection()\n    {\n        if (myConnection == null)\n            myConnection = new SqlConnection(\"user id=\"+(us)+\"; password=\"+(pas)+\";server=\"+(set.SelectServer)+\";Trusted_Connection=\"+(set.SelectContype)+\";database=\"+(set.SelectDataBase)+\"; connection timeout=\"+(set.Condrop)+\"\");\n\n        return myConnection;\n    }\n\n\n}\n</code></pre>\n\n<p><strong>The issue now arrises when I attempt to add information to the database:</strong></p>\n\n<pre><code>     private void button1_Click(object sender, EventArgs e)\n    {\n\n            sql.GetSqlConnection();\n\n            SqlCommand cm = new SqlCommand(\"insert into dbo.Employee(FirstName, LastName, DoB, UserName, Email, Role, JobTitle, MemberOf) values (@FirstName, @LastName, @DoB, @UserName, @Email, @Role, @JobTitle, @MemberOf)\", sql.myConnection);\n            cm.Parameters.AddWithValue(\"@FirstName\", textBox2.Text);\n            cm.Parameters.AddWithValue(\"@LastName\", textBox3.Text);\n            cm.Parameters.AddWithValue(\"@DoB\", textBox5.Text);\n            sql.myConnection.Open();\n            cm.ExecuteNonQuery();\n            sql.myConnection.Close();\n            this.Close();\n</code></pre>\n\n<p>I havnt got any catches yet since its still in development but the program crashes and basically says the User is not allowed. I tested the strings in the connection classes and when i call them after I have logged in it returns nothing. So it seems like its being replaced with \"null\" at somepoint? Im not sure. Anyone see anything obvious? Sorry for the long question. Thank you. </p>\n"},{"tags":["sql","c","odbc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13208087,"title":"exactly what does the statement handle(hstmt) do? in ODBC","body":"<p>I`m new to write c code for ODBC \nbut here I have question...\nafter searching for the tutorial for odbc function tutorials for C, I still caanot get exactly\nhow they work collaborately...</p>\n\n<p>what does the statement handle hstmt exactly do for database data?\nI knew it controls the SQL query statements that I give as a parameter. but,,\nthen every SQL statements that i give as query should have each statement handle(hstmt) for each of them? or one statement handle for several SQL query statements?</p>\n\n<p>for example,</p>\n\n<pre><code>lstrcpy((LPTSTR)update, L\"insert into employee values  ('Dshong','summer','LosAngeles');\");\nSQLExecDirect(hstmt1, update, SQL_NTS);\n\nlstrcpy((LPTSTR)update, L\"insert into works values ('Dshong','Small Bank',    2500);\");\nSQLExecDirect(hstmt3, update1, SQL_NTS);\n\nlstrcpy((LPTSTR)select, L\"select * from works;\");\nif (SQLExecDirect(hstmt, select, SQL_NTS) != SQL_SUCCESS)\n    return printf(\"can’t exec direct\");\n\n\nlstrcpy((LPTSTR)select1, L\"select * from employee;\");\nif (SQLExecDirect(hstmt2, select1, SQL_NTS) != SQL_SUCCESS)\n    return printf(\"can’t exec direct\");\n</code></pre>\n\n<p>should I give like this for two insert statements and two select statements with four hstmt?</p>\n\n<p>and if I give like this,</p>\n\n<pre><code>lstrcpy((LPTSTR)insert, L\"insert into employee values ('Dshong','summer','LosAngeles');\");\nSQLExecDirect(hstmt1, insert, SQL_NTS);\n</code></pre>\n\n<p>the SQLExecDirect has hstmt1 as parameter but I don`t know how SQLExecDirect works with it..</p>\n\n<p>And as I think, the result should be one line inserted, isnt it?</p>\n\n<p>but when I run the code, it inserts multi-same rows for <code>('Dshong','summer','LosAngeles')</code>...\nwhen I printed out the result, <code>('Dshong','summer','LosAngeles')</code> was inserted multiple times \neven though the insert line was not in the for loop or so...</p>\n\n<p>and how they work together with the functions below? </p>\n\n<ul>\n<li><code>SQLBindCol(hstmt, 1, SQL_C_CHAR, id, (SDWORD)sizeof(id), &amp;idlen);</code></li>\n<li><code>SQLFetch(hstmt)</code></li>\n</ul>\n\n<p>I know what they simply doing but.. here I want to know exactly in which way \nhstmt ( statement handle) work with them..</p>\n\n<p>thank you..\n:)</p>\n"},{"tags":["c#","sql","image","application","desktop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13211254,"title":"Rotating Image in C# Desktop Application from Image Location Only","body":"<p>I am writing a C# desktop application that involves importing images from a digital camera, and saving them in a SQL Compact Edition database. I'm not saving the actual images in the database, but the image file path (to save database space). I'm then pulling that image file path from the database and setting the Image Location property of a Picture Box to that path, for display purposes. </p>\n\n<p>My question is this... I would like to add a button that will allow the user to rotate the image after import. Is there a way to do this without creating a new image? I know of the RotateFlip method, but it only works with type Image. Basically, I want to rotate the image linked the file path instead of creating an image from that path, then rotating it. I would love some ideas. Thanks! </p>\n"},{"tags":["sql","query","table","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13205615,"title":"Advanced SQL SUM COLUMN FROM A SAME TABLE","body":"<p>I have this table...</p>\n\n<pre><code>+-----+--------+------+-----+-----+\n|categ| nAME   | quan |IDUNQ|   ID|\n+-----+--------+------+-----+-----+\n|   1 | Z      |    3 |   1 |  15 |\n|   1 | A      |    3 |   2 |  16 |\n|   1 | B      |    3 |   3 |  17 |\n|   2 | Z      |    2 |   4 |  15 |\n|   2 | A      |    2 |   5 |  16 |\n|   3 | Z      |    1 |   6 |  15 |\n|   3 | B      |    1 |   7 |  17 |\n|   2 | Z      |    1 |   8 |  15 |\n|   2 | C      |    4 |   8 |  15 |\n|   1 | D      |    1 |   8 |  15 |\n+-----+--------+------+-----+-----+\n</code></pre>\n\n<p>I need to get the <em>Z of category 1 + Z of category 2 - Z of category 3</em></p>\n\n<p>For example, <em>(3+3-1) = 5   ==>  3 of cat 1,  3 of cat 2, 1 of cat 3</em></p>\n\n<p>The final result should be...</p>\n\n<pre><code>Z ==&gt; 5\nA ==&gt; 5\nB ==&gt; 2\nC ==&gt; 4\n</code></pre>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13210930,"title":"How to select rows where an attribute can have two values","body":"<p>I have a table called site_attributes which looks similar to this:</p>\n\n<pre><code>siteId     attributeId     tier\n-------------------------------\nsite1id    attribute1id    1\nsite1id    attribute2id    1\nsite1id    attribute3id    1\n</code></pre>\n\n<p>How can I select from the table the unique site id where attributeId is equal to attribute1id AND attributeId is equal to attribute3id?</p>\n"},{"tags":["php","sql","css","span"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13211079,"title":"Sorting PHP echo output by time posted","body":"<p>Ok, so. I have asked about 5 questions on stackOverflow today, you've all been so helpful.</p>\n\n<p>Now, i'm a designer, learning to code, so bear with me.</p>\n\n<p>I have a mySQL table, with a small CMS/Blog im building.\nI have it styled how I want to now.\nThis is the code for the page.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM Blog\");\nwhile($row = mysql_fetch_array($result))\n{\n    echo \"&lt;h1&gt;\" . $row['Title'] . \"&lt;/h1&gt;\";\n    echo \"&lt;br&gt;\";\n    echo \"&lt;h2&gt;\" . \"Posted on:   \" . $row['Date'] . \"&lt;/h2&gt;\";\n    echo \"&lt;br&gt;\";\n    echo \"&lt;img src='\".$row['Image'].\"'/&gt;\";\n    echo \"&lt;br&gt;\";\n    echo $row['Message'];\n    echo \"&lt;br&gt;\";\n    echo \"&lt;br&gt;\";\n}\n</code></pre>\n\n<p>I'm still working on it so its all good.</p>\n\n<p>What I want to know is, this code is outputting my sql data into a page. Is there any way of telling the page what order to echo the data, for instance. in my SQL table i have:</p>\n\n<pre><code>2012-11-03 16:16:06     This is my First Blog Post  This is the first message of the first blog post. ...   http://blog.gettyimages.com/wp-content/uploads/201.\n</code></pre>\n\n<p>and next is </p>\n\n<pre><code>2012-11-03 16:17:29     This is my Second Blog Post     This is the second message of the Second Post, You...   http://www.aviation-images.com/user/zooms/118/451n...\n</code></pre>\n\n<p>How can i tell the page to Always display the most recent post at the top, and older ones below.?</p>\n"},{"tags":["sql","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13205031,"title":"JDBC getGeneratedKeys()","body":"<p>I obtained the following code example from <a href=\"http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/getstart/preparedstatement.html\" rel=\"nofollow\">http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/getstart/preparedstatement.html</a></p>\n\n<p>I have three questions:</p>\n\n<ol>\n<li>What does 'keyColumn' refer to considering that there are only three columns - LAST, FIRST, HOME.\n<li>Why is a loop used in iterating the generated keys?  Are multiple rows returned for that one insert statement?\n<li>Which databases support multiple generated keys per table?\n</ol>\n\n<pre><code>String sql = \"INSERT INTO AUTHORS (LAST, FIRST, HOME) VALUES \" +\n                                     \"(?, ?, ?, keyColumn)\";\n\nPreparedStatement addAuthor = con.prepareStatement(sql,\n                             Statement.RETURN_GENERATED_KEYS);\naddAuthor.setString(1, \"Wordsworth\");\naddAuthor.setString(2, \"William\");\naddAuthor.setString(3, \"England\");\n\nint rows = addAuthor.executeUpdate();\n\nResultSet rs = stmt.getGeneratedKeys();\nif (rs.next()) {\n    ResultSetMetaData rsmd = rs.getMetaData();\n    int colCount = rsmd.getColumnCount();\n    do {\n        for (int i = 1; i &lt;= colCount; i++) {\n            String key = rs.getString(i);\n            System.out.println(\"key \" + i + \"is \" + key);\n        }\n    }\n    while (rs.next();)\n} \nelse {\n    System.out.println(\"There are no generated keys.\");\n}\n</code></pre>\n"},{"tags":["java","sql","oracle","jdk"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":5699,"score":4,"question_id":7876502,"title":"How can I run Oracle SQL Developer on JDK 1.6 and everything else on 1.7?","body":"<p>How can I run Oracle SQL Developer on a version of Java it supports (1.6) while running Java 1.7 for everything else?</p>\n\n<p>I can install both JDK's on my system, but I'm concerned with changing environment variables and having it affect more than just SQL Developer. Curious if there's elegant solutions to this.</p>\n\n<p>I am having issues with SQL Developer (running off JDK 1.7) only returning 50 rows. &lt;-- Feel free to address this specific issue as well. EDIT: The problem is not that it returns only 50 rows, this is standard, the problem is the inability to scroll down to see more rows on demand.</p>\n"}]}
{"total":102599,"page":12,"pagesize":100,"questions":[{"tags":["mysql","sql","query","select","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13210900,"title":"Sql Insert default value if Select returns nothing","body":"<p>I have the following SQL query which populates a table with details of various phone calls.</p>\n\n<pre><code>INSERT tblCalls (callerID, destinationNum)\nSELECT tblCallerID.callerID, tblSkyNums.skyID\nFROM tblCallerID, tblSkyNums\nWHERE tblCallerID.callerNumber = '\".$caller_id.\"'\nAND tblSkyNums.skyNum = '\".$dest_no.\"'\n</code></pre>\n\n<p>The query grabs a callerID and a skyID from two seperate tables and inserts them into a third table; tblCalls.</p>\n\n<p>My problem is sometimes no skyID exists for the number entered, and when this happens nothing is entered into tblCalls. Which means no data is recorded for this call.</p>\n\n<p>What I have been trying to do is if no such skyID exists, simply enter 'n/a' into the skyID field for that particular call.</p>\n\n<p>I have been at this for over two days now and cant seem to find a way to get it to work.\nAny help would be geatly appreciated.</p>\n"},{"tags":["sql","android","multi-table"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6145,"score":1,"question_id":4002820,"title":"Creating a multi-table SQL database in android","body":"<p>I'm trying to create a multi-table database for my android application. I'm following the suggestion given on this site <a href=\"http://androidforbeginners.blogspot.com/2010/01/creating-multiple-sqlite-database.html\" rel=\"nofollow\">http://androidforbeginners.blogspot.com/2010/01/creating-multiple-sqlite-database.html</a> for doing it. I keep on getting the error below. The error seems to be cause by the onCreate of the databaes tables.</p>\n\n<p>If you look at my onCreate in the the DBHelper class I have two commented out. This allows it to work no matter which one is left uncommeted. </p>\n\n<p>There has to be a way to create a multi-table database because a single table in a database almost defeats the purpose of having a database.</p>\n\n<p>10-23 02:11:35.383: ERROR/AndroidRuntime(300): Caused by: android.database.sqlite.SQLiteException: Can't upgrade read-only database from version 0 to 1: /data/data/com.parkingticket/databases/Tickets.db</p>\n\n<p>Thanks in advance.</p>\n\n<p>Here is my code</p>\n\n<pre><code>package com.parkingticket;\n</code></pre>\n\n<p>import java.sql.SQLException;</p>\n\n<p>import android.content.ContentValues;\nimport android.content.Context;\nimport android.database.Cursor;\nimport android.database.sqlite.SQLiteDatabase;\nimport android.database.sqlite.SQLiteDatabase.CursorFactory;\nimport android.database.sqlite.SQLiteException;\nimport android.database.sqlite.SQLiteOpenHelper;\nimport android.util.Log;</p>\n\n<p>public class TicketDBAdapter \n{\n    private static final String DATABASE_NAME=\"Tickets.db\";\n    private static final int DATABASE_VERSION = 1;</p>\n\n<pre><code>private static final String PARKEDCARS_TABLE = \"ParkedCars\";\nprivate static final String PARKINGMETERS_TABLE = \"ParkingMeters\";\nprivate static final String PARKINGTICKETS_TABLE = \"ParkingTickets\";\nprivate static final String POLICEOFFICERS_TABLE = \"PoliceOfficers\";\n\n// The name and column index for each column in PARKEDCARS\npublic static final String KEY_CARID = \"carID\";\n    public static final int CARID_COLUMN = 0;\npublic static final String KEY_CARMAKE = \"Make\";\n    public static final int CARMAKE_COLUMN = 1;\npublic static final String KEY_CARMODEL = \"Model\";\n    public static final int CARMODEL_COLUMN = 2;\npublic static final String KEY_CARCOLOR = \"Color\";\n    public static final int CARCOLOR_COLUMN = 3;\npublic static final String KEY_CARLICENSENUMBER = \"LicenseNumber\";\n    public static final int CARLICENSENUMBER_COLUMN = 4;\npublic static final String KEY_CARMINUTESPARKED = \"MinutesParked\";\n    public static final int CARMINUTESPARKED_COLUMN = 5;\n\n// The name and column index for each column in PARKINGMETERS\npublic static final String KEY_METERID = \"meterID\";\n    public static final int METERID_COLUMN = 0;\npublic static final String KEY_MINUTESPURCHASED = \"MinutesPurchased\";\n    public static final int MINUTESPURCHASED_COLUMN = 1;\n\n// The name and column index for each column in PARKINGTICKETS\n    //TODO create the columns and indexs for parking tickets\n\n// The name and column index for each column in POLICEOFFICERS\npublic static final String KEY_OFFICERID = \"officerID\";\n    public static final int OFFICERID_COLUMN = 0;\npublic static final String KEY_OFFICERNAME = \"Name\";\n    public static final int OFFICERNAME_COLUMN = 1;\npublic static final String KEY_OFFICERBADGE = \"BadgeNumber\";\n    public static final int OFFICERBADE_COLUMN = 2;\n\n\n//Variable to hold the database instance\nprivate SQLiteDatabase ticketDB;\n\n//Context of the application using the database.\nprivate final Context context;\n\n//Database open/upgrade helper\nprivate TicketDBHelper ticketDBHelper;\n\npublic TicketDBAdapter(Context _context)\n{\n    context = _context;\n    ticketDBHelper = new TicketDBHelper(context, DATABASE_NAME, null, DATABASE_VERSION);\n}\n\npublic void open() throws SQLiteException\n{\n    try\n    {\n        ticketDB = ticketDBHelper.getWritableDatabase();\n    }\n    catch(SQLiteException ex)\n    {\n        ticketDB = ticketDBHelper.getReadableDatabase();\n    }\n}\n\npublic void close()\n{\n    ticketDB.close();\n}\n\n //Insert a new ParkedCar\npublic long insertParkedCar(ParkedCar _car)\n{\n    //Create a new row of values to insert\n    ContentValues newParkedCarValues = new ContentValues();\n\n    //Assign values for each row\n    newParkedCarValues.put(KEY_CARMAKE, _car.getMake());\n    newParkedCarValues.put(KEY_CARMODEL, _car.getModel());\n    newParkedCarValues.put(KEY_CARCOLOR, _car.getColor());\n    newParkedCarValues.put(KEY_CARLICENSENUMBER, _car.getLicenseNumber());\n    newParkedCarValues.put(KEY_CARMINUTESPARKED, _car.getMinutesParked());\n\n    //Insert the row\n    return ticketDB.insert(PARKEDCARS_TABLE, null, newParkedCarValues);\n}\n\n//Remove a ParkedCar based on its index\npublic boolean removeParkedCar(long _rowIndex)\n{\n    return ticketDB.delete(PARKEDCARS_TABLE, KEY_CARID + \"=\" + _rowIndex, null)&gt;0;\n}\n\n//Update a ParkedCar's MinutesParked\n//TODO Create an update for ParkedCar's minutesParked.\n\npublic Cursor getAllParkedCarsCursor()\n{\n    return ticketDB.query(PARKEDCARS_TABLE, new String[] {KEY_CARID, KEY_CARMAKE, KEY_CARMODEL, KEY_CARCOLOR, KEY_CARLICENSENUMBER, KEY_CARMINUTESPARKED}, null, null, null, null, null);\n}\n\npublic Cursor setCursorParkedCar(long _rowIndex) throws SQLException\n{\n    Cursor result = ticketDB.query(true, PARKEDCARS_TABLE, new String []{KEY_CARID}, KEY_CARID + \"=\" + _rowIndex, null, null, null, null, null);\n\n    if ((result.getCount() == 0) || !result.moveToFirst())\n    {\n        throw new SQLException(\"No ParkedCar found for row: \" + _rowIndex);\n    }\n\n    return result;\n}\n\npublic static class TicketDBHelper extends SQLiteOpenHelper\n{\n    public TicketDBHelper(Context context, String name, CursorFactory factory, int version)\n    {\n        super(context, name, factory, version);\n    }\n\n    //SQL Statement to create PARKEDCARS table\n    private static final String PARKEDCARS_CREATE = \"create table \" + PARKEDCARS_TABLE + \" (\" + KEY_CARID + \" integer primary key autoincrement, \" + KEY_CARMAKE + \" text not null,\" + KEY_CARMODEL + \" text not null,\" + KEY_CARCOLOR + \" text not null,\" + KEY_CARLICENSENUMBER + \" text not null,\" + KEY_CARMINUTESPARKED + \"int not null);\";\n\n    //SQL Statement to create ParkingMeters table\n    private static final String PARKINGMETERS_CREATE = \"create table\" + PARKINGMETERS_TABLE + \" (\" + KEY_METERID + \" integer primary key autoincrement, \" + KEY_MINUTESPURCHASED + \" int not null);\";\n\n    //SQL Statement to create ParkingTickets table\n    //TODO create the statement for parkingTickets\n\n    //SQL Statement to create PoliceOfficers table\n    private static final String POLICEOFFICERS_CREATE = \"create table\" + POLICEOFFICERS_TABLE + \" (\" + KEY_OFFICERID + \" integer primary key autoincrement, \" + KEY_OFFICERNAME + \" text not null,\" + KEY_OFFICERBADGE + \"text not null);\";\n\n    //Called when no database exists in disk and the helper class needs to create a new one.\n    @Override\n    public void onCreate(SQLiteDatabase _db)\n    {\n</code></pre>\n\n<p>//          _db.execSQL(PARKEDCARS_CREATE);\n            _db.execSQL(PARKINGMETERS_CREATE);\n//          _db.execSQL(POLICEOFFICERS_CREATE);\n        }</p>\n\n<pre><code>    //Called when there is a database verion mismatch meaning that the version of the database on disk needs to be upgraded to the current version\n    @Override\n    public void onUpgrade(SQLiteDatabase _db, int _oldVersion, int _newVersion)\n    {\n        //Log the version upgrade.\n        Log.w(\"TaskDBAdapter\", \"Upgrading from version \" + _oldVersion + \" to \" + _newVersion + \", which will destroy all old data\");\n\n        //Upgrade the existing database to conform to the new version\n        //Multiple previous versions can be handled by comparing _oldVersoin and _newVersion values\n\n        //The simplest case is to drop teh old table and create a new one.\n        _db.execSQL(\"DROP TABLE IF EXISTS \" + PARKEDCARS_TABLE);\n        _db.execSQL(\"DROP TABLE IF EXISTS \" + PARKINGMETERS_TABLE);\n        _db.execSQL(\"DROP TABLE IF EXISTS \" + POLICEOFFICERS_TABLE);\n\n        onCreate(_db);\n    }\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["php","sql","css","span"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13210552,"title":"How to style PHP echo output with span","body":"<p>I'm trying to style the output of each echo.</p>\n\n<p>Ideally I'd like to use <code>&lt;span class=\"\"&gt; &lt;/span&gt;</code> for each echo, but I'm not too sure how to achieve this.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM Blog\");\nwhile($row = mysql_fetch_array($result))\n{\n    echo $row['Date'];\n    echo $row['Title'];\n    echo $row['Message'];\n    echo \"&lt;img src='\".$row['Image'].\"'/&gt;\";\n}\n\nmysql_close($con);\n</code></pre>\n"},{"tags":["mysql","sql","in-clause"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":34,"score":-1,"question_id":13210233,"title":"Mysql empty in clause parameter list","body":"<p>I was wondering what happens when you do a sql query where the <code>IN</code> clause is empty. I.e :\n<code>SELECT user WHERE id IN ();</code>.</p>\n"},{"tags":["sql","oracle","stored-procedures","plsql","sqlplus"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13209175,"title":"PL/SQL : Encountered the symbol \"END\"","body":"<p>I get the following error, even though I have checked the code carefully. I don't know what I'm missing. </p>\n\n<p>LINE/COL ERROR</p>\n\n<hr>\n\n<p>31/1     PLS-00103: Encountered the symbol \"END\" when expecting one of the\n         following:</p>\n\n<p>CODE:</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE sp_ssjm_newworkorder\n(   workorderno IN NUMBER,\ncompany     IN CHAR,\nattention   IN CHAR,\ndatedue     IN DATE,\nloggedby    IN CHAR\n)\n\nAS  id     NUMBER;\ntoday         DATE:=SYSDATE;\nBEGIN\nSELECT  client_id   --grab client_id\nINTO id \nFROM    ssjm_client\nWHERE ssjm_client.name=company;\n\nIF id IS NULL THEN  --check if client exists by checking if client_id is there\n    dbms_output.put_line('Please create client first');\n    GOTO the_end;\nELSE\n    INSERT INTO ssjm_workorder      VALUES(workorderno,workorderno,company,loggedby,attention,'Received',today,datedue,id);\nEND IF;\n\nEXCEPTION\n    WHEN OTHERS THEN\n    raise_application_error(-20999,'An error occured in' ||\n        SQLCODE || '-ERROR-' || SQLERRM);\n\n&lt;&lt;the_end&gt;&gt;\n\nEND sp_ssjm_newworkorder;\n</code></pre>\n"},{"tags":["php","sql","database","append"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13208219,"title":"My SQL is not working","body":"<p>I'm trying to add a value to a row in a database table that currently has other values. I want to effect only one field in the table. here's what I'm doing:</p>\n\n<pre><code>$sql = \"UPDATE users SET photo = \".$m_fname.\" WHERE pin = \".$_SESSION['pin'].\";\";\n</code></pre>\n\n<p>What's the correct way to do this?</p>\n\n<p>Here's a little more:</p>\n\n<pre><code>  $m_fname = mysql_real_escape_string($dest_filename);\n  $sql = \"UPDATE users SET photo = \".$m_fname.\" WHERE pin = \".$_SESSION['pin'].\";\";\n  $res = @mysql_query($sql);\n  if (!$res) {\n    $errors[] = \"Could not run query.\";\n    break;\n  }\n</code></pre>\n\n<p><strong>Before anyone else downvotes..</strong>\nI'm aware I should be using mysqli. Sorry if I offended anyone by using an old function.</p>\n"},{"tags":["sql","database","dicom"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13134037,"title":"Storing file location of DICOM images in SQL database","body":"<p>I want to store <code>DICOM</code> images in a directory somewhere, create a database of specific parameters relating to the <code>DICOM</code> images and add the relative location of the <code>DICOM</code> files to the database. </p>\n\n<p>How do I go about doing this in Design view instead of coding explicitly? (I'm relatively new to database / SQL that sort of thing which is why I'd prefer doing it in design view at least at first). </p>\n\n<p>I have searched for questions related to this topic, however all I came up with was posts debating whether it was better to store the images themselves in the database or a pointer to the location. </p>\n\n<p>Can somebody tell me exactly how to go about doing it instead of the pros and cons of the different methods?</p>\n"},{"tags":["sql","sql-server","performance","sql-server-2008","query"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":35271,"score":7,"question_id":4193705,"title":"SQL Server SELECT LAST N Rows","body":"<p>This is a known question but the best solution I've found is something like:</p>\n\n<pre><code>SELECT TOP N *\nFROM MyTable\nORDER BY Id DESC\n</code></pre>\n\n<p>I've a table with lots of rows. It is not a posibility to use that query because it takes lot of time. So how can I do to select last N rows without using ORDER BY?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Sorry duplicated question of <a href=\"http://stackoverflow.com/questions/311054/how-do-i-select-last-5-rows-in-a-table-without-sorting\">this one</a></p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13208427,"title":"SQL how to avoid duplicate insert in a table","body":"<p>how to avoid duplicate insert in a table? I use below query to insert in to table:</p>\n\n<pre><code>insert into RefundDetails(ID,StatusModified,RefundAmount,OrderNumber) \n  select O.id,O.StatusModified,OI.RefundAmount,O.OrderNumber \n  from Monsoon.dbo.[Order] as O  \n  WITH (NOLOCK) JOIN Monsoon.dbo.OrderItem as OI  \n  WITH (NOLOCK)on O.Id = OI.OrderId \n  WHERE o.ID in (SELECT OrderID \n                 FROM Mon2QB.dbo.monQB_OrderActivityView \n                 WHERE ACTIVITYTYPE = 4 AND at BETWEEN '10/30/2012' AND '11/3/2012') AND (O.StatusModified &lt; '11/3/2012') \n</code></pre>\n"},{"tags":["mysql","sql","database","foreign-keys"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13210016,"title":"How to Ignore \"Cannot add or update a child row\" error","body":"<p>I have an sql query from my backup files, it has huge amount of insert statements.</p>\n\n<blockquote>\n  <p>INSERT INTO <code>tns_spo_hotel</code> (<code>id_spo</code>, <code>id_hotel</code>) VALUES\n  (523,149),(523,195), ...</p>\n</blockquote>\n\n<p>I have a foreign keys on both columns.</p>\n\n<p>When i run this query, it returns </p>\n\n<pre><code>#1452 - Cannot add or update a child row: a foreign key constraint fails (`tsakhkad_tour_new`.`tns_spo_hotel`, CONSTRAINT `tns_spo_hotel_22` FOREIGN KEY (`id_hotel`) REFERENCES `tns_hotel` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)\n</code></pre>\n\n<p>Because there are some rows, with missing values.</p>\n\n<p>Is it possible to ignore that error message and continue sql execution ?</p>\n"},{"tags":["sql","oracle","database-design","primary-key"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":13208403,"title":"What is the better way to organize primary keys in database?","body":"<p>My database holds two tables, one is distance matrix of cities, the other holds cities. My first structure was like this:</p>\n\n<ul>\n<li>City \n<ul>\n<li>Uuid</li>\n<li>Name</li>\n<li>Latitude</li>\n<li>Longitude</li>\n</ul></li>\n</ul>\n\n<p>and </p>\n\n<ul>\n<li>Distance\n<ul>\n<li>FromCityID</li>\n<li>ToCityID</li>\n<li>DistanceLength</li>\n</ul></li>\n</ul>\n\n<p><code>UUID</code> is a primary key of the CITY table, <code>FromCityID</code> and <code>ToCityID</code> reference CITY each as foreign key, and both are composite primary key of the DISTANCE table because the distance between two cities should be unique.</p>\n\n<p>But then a realised that I don't want to use <code>UUID</code> and auto-increment as primary keys because I upload data in this database from XML, which holds cities and distances. And as distances may include not only those cities that mentioned in current XML but any previously stored city from database.</p>\n\n<p>I need a system of IDs that is the same across the database and XML. Latitude / longitude seems the best option so I changed my tables to this:</p>\n\n<ul>\n<li>City \n<ul>\n<li>Name</li>\n<li>Latitude</li>\n<li>Longitude</li>\n</ul></li>\n</ul>\n\n<p>and </p>\n\n<ul>\n<li>Distance\n<ul>\n<li>FromCityIDLatitude</li>\n<li>FromCityIDLongitude</li>\n<li>ToCityIDLatitude</li>\n<li>ToCityIDLongitude</li>\n<li>DistanceLength</li>\n</ul></li>\n</ul>\n\n<p><code>Latitude</code> and <code>Longitude</code> are a composite primary key of the CITY table; <code>FromCityIDLatitude</code> / <code>FromCityIDLongitude</code> and <code>ToCityIDLatitude</code> / <code>ToCityIDLongitude</code> reference CITY each as foreign keys, and all four columns are composite primary key of the DISTANCE table.</p>\n\n<p>But it's a bad design to use 4 columns as a primary key. What is the best thing in this case?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13208958,"title":"Sql get name and parent in while loop","body":"<p>I have a table called tblmodules which has 3 columns: moduleid,name,parent_id. The column parent_id takes values of other modules. ex:</p>\n\n<pre><code>Moduleid      Name       Parentid\n--------     -----       --------\n1           grandparent    Null\n2            parent         1\n3           child           2\n</code></pre>\n\n<p>I want a stored procedure that takes the parent's Id and Name of a child giving a level. So i develop the following. </p>\n\n<pre><code>        @moduleid bigint,\n    @level int\n\nAS\nBEGIN\n    -- SET NOCOUNT ON added to prevent extra result sets from\n    -- interfering with SELECT statements.\n    SET NOCOUNT ON;\n\n    declare @parentid bigint\n    declare @name nvarchar(100)\n    set @parentid = (select parentid from tblModules where ModuleId = @moduleid)\n\n\n    declare @counter int\n    set @counter = 1\n\n    while @counter &lt; @level\n    begin\n\n        set @parentid = (select parentid from tblModules where ModuleId = @parentid)\n        set @name = (select Name from tblModules where ModuleId = @parentid)\n\n        set @counter = @counter + 1\n    end\n\n    select @parentid AS ID\n    select @name as Name\n\nend\n</code></pre>\n\n<p>The procedure works fine and gets the correct Id of the parent, but the name remains the same as the child. For ex i am executing it giving the values @moduleid: 3 and @level:2.\nI am getting result ID: 1 which is correct but Name: child instead of Grandparent. Any help?</p>\n"},{"tags":["php","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13209913,"title":"PHP variable needs to equal a value obtained from an sql query","body":"<p>I am trying to use php to plot a graph. I want to plot the values returned from a count of results within a table:</p>\n\n<pre><code>SELECT COUNT(*) FROM tAnswer WHERE Answer1 = '1';\n</code></pre>\n\n<p>The query returns 3. I now want this 3 to become stored within a php variable.</p>\n\n<p>How would I got about this?</p>\n"},{"tags":["sql","parsing","postgresql","syntax","cvs"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":778,"score":2,"question_id":8271606,"title":"postgresql syntax check without running the query","body":"<p>I want to verify the syntax of files containing sql queries before they can be committed in my CVS project. </p>\n\n<p>In order to do that, I have a commitinfo script, but I have trouble finding out if the sql commands are valid. <code>psql</code> does not seem to have a dryrun mode, and constructing my own postgresql-dialact tester from the grammar (that is in the source) seems like a long stretch. </p>\n\n<p>The scripts may contain multiple queries, so an <code>EXPLAIN</code> cannot be wrapped around them. </p>\n\n<p>Any hints?</p>\n"},{"tags":["mysql","sql","rank"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13209227,"title":"Getting rank of a row in mysql query","body":"<p>I was using this query to assign rank to every name according to the votes they have got, but it returns with the error :</p>\n\n<blockquote>\n  <p>1248 - Every derived table must have its own alias</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>SELECT @rownum:=@rownum+1 AS rank, name, vote \nFROM table, (SELECT @rownum:=0) ORDER BY vote DESC\n</code></pre>\n\n<p>On modifying the query to this :-</p>\n\n<pre><code>SELECT @rownum:=@rownum+1 AS rank, name, vote \nFROM table ORDER BY vote DESC\n</code></pre>\n\n<p>I get as expected rank of the queries as NULL. Any help , how to get rank at first place ?</p>\n\n<p><strong>NOTE:</strong> I am not looking for any alternative solution. Just trying to do it in the query itself.</p>\n"},{"tags":["sql","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13208158,"title":"Can't drop procedure if object_id is not null","body":"<p>I have a weird problem. I'm trying to drop a procedure only if it exists, and have this code: </p>\n\n<pre><code>IF OBJECT_ID(N'dbo.CreateBlogUser', N'U') IS NOT NULL\n    DROP PROCEDURE CreateBlogUser;\n    PRINT 'IS NOT NULL'\nGO\n</code></pre>\n\n<p>(the print is only there to try if it is true or not).\nAnd when I run it, \"IS NOT NULL\" is printed, but the procedure isn't dropped! It still exists in the database, so when I run my Create procedure, it fails. </p>\n\n<p>However! When I tried to remove the NOT from the code, it works! The procedure is dropped and \"IS NOT NULL\" is still printed. This seems totally backwards and I don't know why it does this. Is is something to do with the extra N:s and U:s in the OBJECT_ID? Found the code <a href=\"http://msdn.microsoft.com/en-us/library/ms190328.aspx\" rel=\"nofollow\">here</a></p>\n"},{"tags":["mysql","sql","database","table","import"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13209349,"title":"Can't see tables while importing database - MYSQL","body":"<p>Why can't I see tables while i am importing database in phpmyadmin. It shows me success but then still I am not able to see any tables. Though if i run any query it does show me the result. What is the problem? I have tried finding answers online but couldn't find anything.</p>\n"},{"tags":["c#","sql","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13208041,"title":"Desktop Application gridview cell values lock alternate according to cell values","body":"<p>I have a grid, It have 6 columns(item name,min quantity,max quantity,max amout,max amount,Discount).</p>\n\n<p><strong>Requirement</strong> </p>\n\n<p>When I select <strong>min Quantity</strong>, <strong>max Quantity column</strong> will Disable And its Value become Zero,when i select <strong>min amount ,max amout column</strong> will Disable and vice Versa. When i enter min value in quantity then row of grid contain max value from first row.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13209021,"title":"Return random image SQL","body":"<p>I have a database which holds information about user-created items. Each item can have a number of images associated with it, and I'd like to have an SQL query that 4 random item images, but should not return images from the same item twice.</p>\n\n<p>Here's a review of the table structures (not full, but including the pertinent information):</p>\n\n<p>Table 1 : <strong>item_images:</strong></p>\n\n<pre><code>+----------+--------------+\n| item_id  |   filename   |\n+----------+--------------+\n|    1     |   test.jpg   | \n|    1     |   test2.jpg  |\n|    5     |   testy.jpg  |\n+----------+--------------+\n</code></pre>\n\n<p>Table 2: <strong>item_link:</strong></p>\n\n<pre><code>+----------+-------------+\n| item_id  | category_id |\n+----------+-------------+\n|    1     |      1      |\n|    5     |      1      |\n+----------+-------------+\n</code></pre>\n\n<p>So given the above data, I'd like to return a random image for item # 1 and 5, since they both exist in category # 1.</p>\n\n<p>Here's the SQL query I have already tried, but for some reason, it always returns the same two images. How might I modify this to return a random image from the matched items?</p>\n\n<pre><code>SELECT `item_images`.`filename` AS `url` FROM `item_images`\n  INNER JOIN `item_link` ON `item_images`.`item_id` = `item_link`.`item_id`\n  WHERE `item_link`.`category_id` = 1 \n  GROUP BY `item_link`.`item_id`\n  ORDER BY RAND()\n  LIMIT 4\n</code></pre>\n"},{"tags":["sql","select","listbox","selected"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2856,"score":1,"question_id":2412863,"title":"Multiple Selected Values of ListBox as Parameters to SELECT SQL Query","body":"<p>I want to pass the Multiple selected values from ListBox as parameters to my Select SQL Query. </p>\n\n<p>I am using VB.NET, how can I achieve this ?...</p>\n"},{"tags":["sql","database","oracle","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2813,"score":1,"question_id":2690192,"title":"Combining multiple rows into one row, Oracle","body":"<p>I'm working with a database which is created in Oracle and used in a GIS-software through SDE. One of my colleuges is going to make some statistics out of this database and I'm not capable of finding a reasonable SQL-query for getting the data.</p>\n\n<p>I have two tables, one with registrations and one with registrationdetails. It's a one to many relationship, so the registration can have one or more details connected to it (no maximum number).</p>\n\n<ol>\n<li>table: Registration  </li>\n</ol>\n\n<pre>\nRegistrationID          Date       TotLenght\n1                    01.01.2010        5\n2                    01.02.2010        15\n3                    05.02.2009        10\n</pre>\n\n<p>2.table: RegistrationDetail</p>\n\n<pre>\nDetailID     RegistrationID   Owner      Type      Distance\n1                  1           TD          UB          1,5\n2                  1           AB          US          2\n3                  1           TD          UQ          4\n4                  2           AB          UQ         13\n5                  2           AB          UR         13,1\n6                  3           TD          US          5\n</pre>\n\n<p>I want the resulting selection to be something like this:</p>\n\n<pre>\nRegistrationID          Date       TotLenght DetailID     RegistrationID   Owner     Type      Distance  DetailID     RegistrationID   Owner      Type      Distance  DetailID     RegistrationID   Owner      Type      Distance\n1                    01.01.2010        5         1              1           TD        UB          1,5          2               1          AB        US          2         3                  1              TD          UQ          4\n2                    01.02.2010        15        4              2           AB        UQ         13            5               2          AB        UR         13,1\n3                    05.02.2009        10        6              3           TD        US          5\n</pre>\n\n<p>With a normal join I get one row per each registration and detail. Can anyone help me with this? I don't have administrator-rights for the database, so I can't create any tables or variables. If it's possible, I could copy the tables into Access.</p>\n"},{"tags":["php","sql","pdo","count","odbc"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":3985,"score":7,"question_id":2304315,"title":"Get Number of Rows from a Select statement","body":"<p>I have this:</p>\n\n<pre><code>$dbh = new PDO(\"odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=$mdbFilename\", $username, $password);\n\n$sql = \"SELECT * FROM this_table\";\n\n$stmt = $dbh-&gt;query($sql);\n\n//num of rows?\n</code></pre>\n\n<p>How do I get the number of rows returned from that SELECT statement?</p>\n\n<p>Thanks all</p>\n"},{"tags":["sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13208147,"title":"Multivalued Attribute","body":"<p>Assume here we have a column to describe the description of a product.</p>\n\n<p>I think I have to use multivalue to fill in the table.</p>\n\n<p>Is that kind of mistake to violate the principle of 1NF?</p>\n\n<p>I am beginner to database design, recently I feel really confused about it.</p>\n"},{"tags":["sql","count","having-clause","match-against"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13208085,"title":"SQL - MATCH AGAINST with HAVING and COUNT()","body":"<p>does someone knows why this first query works and this second not?</p>\n\n<p>first query (works):</p>\n\n<pre><code>SELECT *, \n       MATCH(username) AGAINST ('ergergergergergerg' IN BOOLEAN MODE) AS _score\nFROM (ci_users) HAVING _score &gt; '0';\n</code></pre>\n\n<p>second query (not working):</p>\n\n<pre><code>SELECT COUNT(id), \n       MATCH(username) AGAINST ('ergergergergergerg' IN BOOLEAN MODE) AS _score \nFROM (ci_users) HAVING _score &gt; '0';\n</code></pre>\n\n<p>the first query returns exactly 24 rows, the second query returns 0 rows, while i just changed <code>*</code> to <code>COUNT(id)</code></p>\n"},{"tags":["iphone","objective-c","sql","ios","xcode"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1033,"score":4,"question_id":9645021,"title":"Application users account registration and login, best way to handle?","body":"<p>First of all, i'm new to Objective-C, so please be patient with me.</p>\n\n<p>I want to add to my application users account management, users can register/log-in into a personal account that will synchronized with database on the internet. I dont have a clue how to do that. I know how to work with sqlite3. I was thinking maybe to create an sqlite3 database on the device. is it possible to store images into sqlite3 database? is it the best and efficient way to manage users on application?</p>\n\n<p>what does sign in with Facebook or Twitter do? is it possible to add them both and another option for someone who doesn't have Facebook or Twitter?</p>\n\n<p>What is the best way to handle account registration and login on iPhone?</p>\n\n<p>Thanks alot!</p>\n"},{"tags":["mysql","sql","select","limit","where"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13207746,"title":"SQL how limit and offset are executed?","body":"<p>i would like to know if limit and offset are executed after the row were selected:</p>\n\n<pre><code>SELECT * FROM users WHERE id &gt; 4 LIMIT 0,90 ORDER BY datetime DESC;\n</code></pre>\n\n<p>Does this query first selects all the users's rows then apply the <code>LIMIT</code>, or does this query first apply the <code>LIMIT</code> then selects the users's rows? </p>\n"},{"tags":["sql","sql-server","syntax"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":16403,"score":2,"question_id":1267427,"title":"SQL: Insert all records from one table to another table without specific the columns","body":"<p>I want to insert all the record from the back up table foo_bk into foo table without specific the columns.</p>\n\n<p>if i try this query</p>\n\n<pre><code>INSERT INTO foo \nSELECT *\nFROM foo_bk\n</code></pre>\n\n<p>i'll get error \"Insert Error: Column name or number of supplied values does not match table definition.\"</p>\n\n<p>Is it possible to do bulk insert from one table to another without supply the column name?\nI've google it but can't seem to find an answer. all the answer require specific the columns.</p>\n"},{"tags":["python","sql","list"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":49,"score":-3,"question_id":13206611,"title":"Python associating multiple values from one list to another list","body":"<p>I have a pretty simple idea in mind but don't exactly know how to go about doing it. I have two lists of different length (say 50 in one and 200 in the other). </p>\n\n<p>so</p>\n\n<pre><code>len(x) = 50\nlen(y) = 200\n</code></pre>\n\n<p>What I want to do is print out some lines where one value from x corresponds to multiple values of y (does not matter if numbers are repeated). </p>\n\n<pre><code>I.e. suppose x = [1,2,3,4]\ny = [7,8,9,10,11,12,13,14,15,16,17]\n\nI want to print out:\n1: 7\n1: 8\n1: 9\n1: 10\n2: 11\n2: 12\n2: 13\n3: 14\n3: 15\n3: 16\n4: 17\n</code></pre>\n\n<p>Randomization of values from y does not really matter.\nIt does not matter how many multiple values get printed out for each value of x. I am basically trying to write a sql script of inserting multiple elements from one table into another and using python to write the script.</p>\n\n<p>I know this can be done by simply iterating over the smallest list and having multiple f.write() statements while incrementing some variable to have multiple values of y associated to a single value of x. But this does not cover all the values of y and looks kind of silly. Is there a better way to go about doing this?</p>\n\n<p>Edit: For the question where how I came up with the association of keys to values, it does not really matter how many values 1 key is associated with (an upper bound of 8 exists). There can be only 1 value or multiple (up to 8). Then again, there can be repetitions of values between keys (i.e. in my example there is not but key 4 can say have values 7/8 also) </p>\n"},{"tags":["sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13207784,"title":"MAX function and GROUP BY function not working together","body":"<p>I want to list the name professor who teaches \"java\", number of times he taught and latest year and term he taught.</p>\n\n<p>I tried this query but it's giving two rows with same name.</p>\n\n<pre><code>SELECT i.I_FNAME, COUNT(f.I_ID) as myCount, f.CO_TERMNUMBER, f.CO_YEAR\nFROM \n  INSTRUCTOR i\nJOIN TEACHINGQUALIFICATION t\n  ON i.I_ID = t.I_ID\nJOIN COURSE c\n  ON c.C_ID = t.C_ID\nJOIN COURSEOFFERING f\n  ON i.I_ID = f.I_ID  \nWHERE c.C_TITLE =  'java'\n  GROUP BY t.I_ID, i.I_FNAME, f.CO_TERMNUMBER, f.CO_YEAR\n  ORDER BY f.CO_YEAR desc \n</code></pre>\n\n<p><strong>output:</strong></p>\n\n<pre><code>1    Gaurav    1    4   2006\n2    Gaurav    1    1   2000\n</code></pre>\n\n<p><strong>Expected output:</strong></p>\n\n<pre><code>1    Gaurav    2    4   2006\n</code></pre>\n\n<p><strong>code with error:</strong></p>\n\n<p>I also tried this code with the condition  \"AND f.CO_YEAR= MAX (f.CO_YEAR)\" but it's showing this error \" group function is not allowed here\" </p>\n\n<pre><code>SELECT  t.I_ID, i.I_FNAME, COUNT(f.I_ID) as Cnt, f.CO_TERMNUMBER, f.CO_YEAR\nFROM \n  INSTRUCTOR i\nJOIN TEACHINGQUALIFICATION t\n  ON i.I_ID = t.I_ID\nJOIN COURSE c\n  ON c.C_ID = t.C_ID\nJOIN COURSEOFFERING f\n  ON i.I_ID = f.I_ID  \nWHERE c.C_TITLE =  'itec801' AND f.CO_YEAR= MAX (f.CO_YEAR)\n  GROUP BY t.I_ID, i.I_FNAME, f.CO_TERMNUMBER, f.CO_YEAR\n  ORDER BY f.CO_YEAR desc \n</code></pre>\n\n<hr>\n\n<p><strong>UPDATED</strong></p>\n\n<hr>\n\n<p>This code is showing the output with latest year but the problem is when it fetches the latest row, counter stops there and it shows 1 value. But i want to count all the row and then only display latest year.</p>\n\n<pre><code>SELECT  t.I_ID, i.I_FNAME, COUNT(f.I_ID) as Cnt, f.CO_TERMNUMBER, f.CO_YEAR\n    FROM \n      INSTRUCTOR i\n    JOIN TEACHINGQUALIFICATION t\n      ON i.I_ID = t.I_ID\n    JOIN COURSE c\n      ON c.C_ID = t.C_ID\n    JOIN COURSEOFFERING f\n      ON i.I_ID = f.I_ID  \n JOIN\n    (\n    SELECT I_ID, MAX(CO_YEAR) LatestYear\n    FROM COURSEOFFERING GROUP BY I_ID\n    ) \n  f2 ON f.I_ID = f2.I_ID AND f.CO_YEAR = f2.LatestYear\n\n    WHERE c.C_TITLE =  'itec801' \n      GROUP BY t.I_ID, i.I_FNAME, f.CO_TERMNUMBER, f.CO_YEAR\n     having  f.CO_YEAR= MAX (f.CO_YEAR)\n      ORDER BY f.CO_YEAR desc \n</code></pre>\n\n<p><strong>New output:</strong></p>\n\n<pre><code>1    Gaurav    1    4   2006\n</code></pre>\n\n<p><strong>Expected output:</strong></p>\n\n<pre><code>1    Gaurav    2    4   2006\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1315,"score":0,"question_id":4582832,"title":"Repair all tables in one go","body":"<p>can anyone tell me how to check all the tables in the database in one go </p>\n\n<p>rather than typing the query  - check table ''tablename''; - for all the tables one by one.</p>\n\n<p>I mean is there any simple command like check all or anything like that..</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","r","data.table","xts","zoo"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":196,"score":3,"question_id":12557762,"title":"Splitting irregular time series into regular monthly averages - R","body":"<p>In order to establish seasonal effects on energy use, I need to align the energy use information that I have from a billing database with monthly temperatures.</p>\n\n<p>I'm working with a billing dataset that has bills of varying lengths and start and end dates, and I'd like to obtain the monthly average for each account within each month.  For example, I have a billing database that has the following characteristics:</p>\n\n<pre><code>   acct amount      begin        end days\n1  2242  11349 2009-10-06 2009-11-04   29\n2  2242  12252 2009-11-04 2009-12-04   30\n3  2242  21774 2009-12-04 2010-01-08   35\n4  2242  18293 2010-01-08 2010-02-05   28\n5  2243  27217 2009-10-06 2009-11-04   29\n6  2243    117 2009-11-04 2009-12-04   30\n7  2243  14543 2009-12-04 2010-01-08   35\n</code></pre>\n\n<p>I would like to figure out how to coerce these somewhat irregular time series (for each  account) to get the average amount per day within each month that is spanned within each bill, such that:</p>\n\n<pre><code>   acct amount      begin        end days avgamtpday\n1  2242  11349 2009-10-01 2009-10-31   31          X\n2  2242  12252 2009-11-01 2009-11-30   30          X\n3  2242  21774 2009-12-01 2010-12-31   31          X\n4  2242  18293 2010-01-01 2010-01-31   31          X\n4  2242  18293 2010-02-01 2010-02-28   28          X\n5  2243  27217 2009-10-01 2009-10-31   31          X\n6  2243    117 2009-11-01 2009-11-30   30          X\n7  2243  14543 2009-12-01 2009-12-31   30          X\n7  2243  14543 2010-01-01 2010-01-31   31          X\n</code></pre>\n\n<p>I'm fairly agnostic to whichever tool can do this, since I only have to do this once.</p>\n\n<p>An additional wrinkle is the table is about 150,000 rows long, which is not really very big by most standards, but big enough to make a loop solution in R difficult.  I've investigated using the zoo, xts, and tempdisagg packages in R.  I started writing a really ugly loop that would split each bill, then create one row for each month within an existing bill, and then tapply() to summarize by accts and months, but honestly, couldn't see how to do it efficiently.</p>\n\n<p>In MySQL, I've tried this:</p>\n\n<blockquote>\n  <p>create or replace view v3 as select 1 n union all select 1 union all select 1;<br>\n  create or replace view v as select 1 n from v3 a, v3 b union all select 1;<br>\n  set @n = 0;<br>\n  drop table if exists calendar; \n  create table calendar(dt date primary key);<br>\n  insert into calendar<br>\n     select cast('2008-1-1' + interval @n:=@n+1 day as date) as dt \n     from v a, v b, v c, v d, v e, v; </p>\n  \n  <p>select acct, amount, begin, end, billAmtPerDay, sum(billAmtPerDay), MonthAmt, \n  count(<em>) Days, sum(billAmtPerDay)/count(</em>) AverageAmtPerDay, year(dt), month(dt)\n     FROM ( select *, amount/days billAmtPerDay \n        from bills b \n           inner join calendar c on dt between begin and end and begin &lt;> dt) x \n  group by acct, amount, begin, end, billAmtPerDay, year(dt), month(dt);</p>\n</blockquote>\n\n<p>But for reasons I don't understand, my server doesn't like this table, and gets hung up on the inner join, even when I stage the different calculations.  I'm investigating if there are any temporary memory limits on it.</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":32,"score":-4,"question_id":13207832,"title":"delete multiple products in sql","body":"<p>I have many unused products how can i <strong>delete</strong> all unwanted prodcuts from my site.</p>\n\n<p>So that Server run fast.</p>\n\n<p>tell me some query for this.</p>\n\n<p>I want delete multiple products in single query.</p>\n"},{"tags":["sql","delphi","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13207224,"title":"Running a query and displaying result it in a TEdit","body":"<p>I have a <code>TComboBox</code> containing a list of names gathered from my database. Next to it is a <code>TEdit</code> that I intend on using for the purposes for displaying the ID number associated to each person. </p>\n\n<p>Since firstName and lastName are separate fields within the table, but displayed together in the TCombobox I have written a small section to split the firstName and lastName into two separate variables:</p>\n\n<blockquote>\n<pre><code> pos := AnsiPos(' ', cbStudents.Text); \n firstName := Copy(cbStudents.Text, 0, pos-1);\n lastName := Copy(cbStudents.Text, pos+1, Length(cbStudents.Text));\n</code></pre>\n</blockquote>\n\n<p>Then I execute the SQL code:</p>\n\n<pre><code>  try\n    query.Open;\n    query.SQL.Add('Select studentID');\n    query.SQL.Add('From student');\n    query.SQL.Add('Where firstName = ' + StrToQuote(firstName));\n    query.SQL.Add('And lastName = ' + StrToQuote(lastName));\n    editID.Text := query\n  finally\n    query.Free;\n  end;\n</code></pre>\n\n<p>Note: <code>StrToQuote</code> encapsulates the variable firstName and lastName with double quotes (\" \")</p>\n\n<p>The error that I am receiving is:</p>\n\n<p>Argument out of range</p>\n\n<p>What am I doing wrong? Thank you in advanced for the help.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13207618,"title":"MySQL JOIN query -","body":"<p>I know this question has already asked here, but I can't figure this one out from the previous answers.</p>\n\n<p>We've got 2 tables:</p>\n\n<pre><code>members\n-----------------------\n| id | country_iso_3 |\n-----------------------\n  1    USA\n  2    DZA\n  3    FRA\n  4    ILI\n  5    USA\n  6    USA\n\n\nmembers_details\n-----------------------\n| member_id | city    |\n-----------------------\n  1          AA\n  2          BB\n  3          CC\n  4          DD\n  5          EE\n  6          FF\n</code></pre>\n\n<p>Now I want to query members_details and select the cities which are from the same countries, here \"AA\", \"EE\" and \"FF\" should be the results (because the members are from USA)</p>\n\n<p>I know how to compare different cols from different tables, but here we need to check the second table 'member_id' and the first table 'id (country_iso_3)' somehow!</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13202621,"title":"check if record columns have some special values","body":"<p>I want to check to see if some of the fields have some unique values - for instance, I want to check if field1, field2 in my table have a value of \"YES\".  If both of them have \"Yes\" then I want to call some function, but if one of them has \"No\" value then I want to call some other function. Note in my select statement, I am passing an ID from the query-string.  How can I do this?</p>\n\n<pre><code>protected void Check_ItemUpdated(object sender, DetailsViewUpdatedEventArgs e) {\n    SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString);\n    SqlDataAdapter da = new SqlDataAdapter(\"SELECT ID, Field1, Field2 from MyTabel WHERE ID = '\" + Request.QueryString[\"ID\"] + \"'\", con);\n    DataTable dt = new DataTable();\n    da.Fill(dt);\n}\n</code></pre>\n"},{"tags":["c#","sql","sql-server","sql-server-2005","gridview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13207520,"title":"Pagination through Sql query","body":"<p>I am developing an application in which am using grid view. I want to use pagination for that grid view by using sql query.</p>\n\n<p>I want to display records with the help of <code>pagesize</code> and <code>pageindex</code>. </p>\n\n<p>How can I do this with sql query?</p>\n"},{"tags":["sql","oracle","optimization","query-optimization","partitioning"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":13173709,"title":"Optimize Oracle order by query","body":"<p>I have a table with around 5 million rows that look like this:  </p>\n\n<p><strong>Erp_in:</strong></p>\n\n<pre><code>corr_id varchar(50) (almost Unique)\ncorr_type nvarchar(1) (4 distinct values)\ninterface varchar(20) (around 10 distinct values)\nindate DateTime\n</code></pre>\n\n<p>With 3 different index on (corr_id, interface and indate)<br>\nAnd also I have another table which I usally left join with the original table, with about 100000 rows</p>\n\n<p><strong>Erp_In_failed:</strong></p>\n\n<pre><code>corr_id\ninterface\nerror (clob)   \ninput (clob)\n</code></pre>\n\n<p>with index on (corr_id and interface)</p>\n\n<p>The query I want to optimize is Simple as this:</p>\n\n<pre><code>SELECT a.corr_id, a.interface, a.indate, b.error \nFROM erp_in a left join erp_in_failed b on a.corr_id = b.corr_id and a.interface =          b.interface\nOrder by a.indate desc;\n</code></pre>\n\n<p>If I remove the order by, the query isn't taking that long, but ordering the data takes around 3 minutes if not more.</p>\n\n<p>What can I do to optimize the query?\nI was thinking on Partitioning / Removing old data to history table / maybe creating a sequence primary key and order by it or anything else you have in mind...</p>\n\n<p><strong>Edit:</strong><br>\nExecution plan says full table scan, and it's not the join that takes so long it's the order by.<br>\nEven this query takes forever:</p>\n\n<pre><code>SELECT * FROM erp_in\nORDER BY indate;\n</code></pre>\n\n<p>I have tried using Paging, but that doesn't work also, and takes few minutes for 20 results, maybe I am doing it wrong?</p>\n\n<p>If I add WHERE clause on indate field, it uses the index, but only when it is less than 20 days old, anything other than that still uses full table scan. (even with 40 days, adding INDEX hint made the query run faster, but still not enough).</p>\n\n<p>And just for the curiosity, I have a simple table with 1 million rows, and order by takes few seconds, what's the difference? is 1 million is enough to sort it in RAM?</p>\n\n<p>Thanks,</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":9,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3616,"score":1,"question_id":1647736,"title":"T-SQL - GROUP BY with LIKE - is this possible?","body":"<p>Is there a way to include a LIKE expression in a GROUP BY query?  For example:  </p>\n\n<pre><code>  SELECT Count(*) \n    from tblWhatever\nGROUP BY column_x [LIKE %Fall-2009%]\n</code></pre>\n\n<p>column_x:</p>\n\n<pre><code>--------\nBIOL-Fall_2009\nHIST Fall_2009\nBIOL Spring_2009\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>------\nFall_2009   2\nSpring_2009 1\n</code></pre>\n"},{"tags":["mysql","sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":35,"score":-1,"question_id":13206691,"title":"SQL Update latest column in master table from transaction table","body":"<p>I have two tables </p>\n\n<pre><code>customer_master\n&gt; cname\n&gt; lastreceiptdate\n&gt; lastreceiptamt\n\naccounts\n&gt; cname\n&gt; date\n&gt; amount\n</code></pre>\n\n<p>I need help in constructing a single update query. where the <code>customer_master</code> table is updated with the latest receipt date and receipt amount for a single customer code (cname like \"FRUITXXXXX\") from accounts table.</p>\n\n<p>It should work in mysql 5.0 and postgresql 9.0</p>\n\n<p>thanks</p>\n\n<p>so far we are using a select command to retrieve a record with max(Date) and then using another update command to update using results from the select query.</p>\n\n<pre><code>update customer_master \nset receiptdate = @_da, receiptamt=@_amt \nwhere cname = @_cn and (receiptdate &lt; @_da or receiptdate='null') \n</code></pre>\n"},{"tags":["mysql","sql","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13207069,"title":"Invalid use of group function while updating a table with sum function","body":"<p>I have two tables: <code>o_daily_lcsgeneration</code> and <code>o_daily_generation</code>.</p>\n\n<p>While trying to update the <code>o_daily_generation</code> I receive an error saying:</p>\n\n<pre><code>error(1111) invalid use of Group function\n</code></pre>\n\n<p>Here is the code I am running:</p>\n\n<pre><code>update o_daily_generation join o_daily_lcsgeneration \non o_daily_generation.Location =o_daily_lcsgeneration.Location \n   and o_daily_generation.Date =o_daily_lcsgeneration.Date  \nset o_daily_lcsgeneration.Turbine_Generation =sum(o_daily_generation.Turbine_Generation)\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","error-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13205827,"title":"Msg 203, Level 16, State 2, is not a valid identifier","body":"<p>I'm getting the following error:</p>\n\n<blockquote>\n  <p><em>Msg 203, Level 16, State 2, Procedure getQuestion, Line 18</em><br>\n  The name 'select top(1) * from tlb_Question inner join tlb_options on tlb_options.qID=tlb_Question.id and tlb_Question.qNumber=1 and tlb_Question.id not in (0,1)' is not a valid identifier</p>\n</blockquote>\n\n<p>from the following stored procedure:</p>\n\n<pre><code>ALTER proc getQuestion\n    @qNo bigint,\n    @total bigint,\n    @next nvarchar(max)\nas\nbegin \n    declare @hisa bigint\n    set @hisa=@total/3\n\n    if(@qNo&lt;=@total/3)\n    begin\n    declare @query nvarchar(max)\n    set @query=('select top(1) * from tlb_Question \n        inner join tlb_options on tlb_options.qID=tlb_Question.id and tlb_Question.qNumber=1 and tlb_Question.id not in ('+cast(@next as varchar)+')')\n    print @query\n    execute @query\n    end\nend\n</code></pre>\n"},{"tags":["c#","sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13206302,"title":"The DELETE statement conflicted with the REFERENCE constraint","body":"<p>In my project I am filling two database tables with two DataSets. The method which I am using to fill those database tables is shown  below:</p>\n\n<pre><code>SqlCommand sqlCommand = new SqlCommand();            \nSqlCommand command;\nusing (SqlConnection conn = new SqlConnection(strConn))\n{\n    using (SqlCommand cmd = new SqlCommand(strQuery, conn))\n    {\n        using (SqlCommand cmdReset = new SqlCommand(\"DBCC CHECKIDENT('Doctor', RESEED, 0)\", conn))\n        {\n            using (SqlCommand cmdUnCheck = new SqlCommand(\"alter table [dbo].[Doctor] nocheck constraint all\",conn))\n            {\n                using (SqlCommand cmdCheck = new SqlCommand(\"alter table [dbo].[Doctor] with check check constraint all\",conn))\n                {\n                    SqlDataAdapter da = new SqlDataAdapter(cmd);\n                    conn.Open();\n                    SqlTransaction sqlTransaction = conn.BeginTransaction();\n                    cmd.Transaction = sqlTransaction;\n                    cmdReset.Transaction = sqlTransaction;\n                    cmdUnCheck.Transaction = sqlTransaction;\n                    cmdCheck.Transaction = sqlTransaction;\n                    try\n                    {\n                        cmdUnCheck.ExecuteNonQuery();\n           /*ERROR*/    cmd.ExecuteNonQuery();\n                        cmdReset.ExecuteNonQuery();//deleting database table data\n                        foreach (DataRow dr in ds.Tables[0].Rows) //Inserting new data into the Database table\n                        {\n                            command = new SqlCommand(query.createDoctorRow(\"Doctor\",\n                            dr[1].ToString(), dr[2].ToString(), Convert.ToInt64(dr[3]), Convert.ToInt32(dr[4])), conn, sqlTransaction);\n                            command.ExecuteNonQuery();\n                        }\n                        cmdCheck.ExecuteNonQuery();\n                        sqlTransaction.Commit();\n                        conn.Close();\n                    }\n                    catch (Exception e)\n                    {\n                        sqlTransaction.Rollback();\n                        throw;\n                    }\n                }\n            }\n        }\n    }                \n}\n</code></pre>\n\n<p>The above code was working fine till the second Database table was empty but when I inserted some data in it and then run the code, VS is showing error --> </p>\n\n<blockquote>\n  <p>The DELETE statement conflicted with the REFERENCE constraint \"FK_Dr_ID\". The conflict occurred in database \"Hospital\", table \"dbo.Patient\", column 'Doctor_ID'.\n  The statement has been terminated.</p>\n</blockquote>\n\n<p>This seems clear that the foreign key is restricting the query to take place but as I am a beginner and dont know what to do I am asking your help..</p>\n\n<p>In the above code I made changes referring to this <a href=\"http://stackoverflow.com/a/1566552/1577396\">SO answer</a> but no joy, the error still exists at the same point.</p>\n\n<p><em>Optional</em>: Is there anyway to reduce the <code>using</code> statements in my code?</p>\n"},{"tags":["sql","architecture","connection-string"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13197105,"title":"SQL connection string broker","body":"<p>My company has a lot of SQL instances with a lot of databases on each instance. Those instances are referenced by a lot of custom code in a lot of different web and application servers. The technology stack on any given server can be at various stages of the lifecycle. It's a maintenance nightmare. I'm in the process of migrating a SQL 2000 instance with thousands of unorganized tables and an unknown set of apps hitting these tables.</p>\n\n<p>I realize my problem is a poorly architected and implemented infrastructure but there's nothing I can do about that right now. What I'm considering is setting up some type of central connection string broker that serve connection strings. Applications will call the broker to get the appropriate connection string.</p>\n\n<p>I guess my first question is - does anything like this exist? I'd much rather drop into an existing solution than roll my own. If not, what's the simplest, most transparent approach for creating something to handle this?</p>\n\n<p>My first thought at a solution is a REST web service running on a load balanced web server that stores the underlying connections in some type of configuration file.</p>\n\n<p>I would appreciate any ideas or potential tools to use.</p>\n"},{"tags":["sql","group-by","distinct"],"answer_count":18,"favorite_count":13,"up_vote_count":25,"down_vote_count":0,"view_count":9561,"score":25,"question_id":164319,"title":"Is there any difference between GROUP BY and DISTINCT","body":"<p>I learned something simple about SQL the other day:</p>\n\n<pre><code>SELECT c FROM myTbl GROUP BY C\n</code></pre>\n\n<p>Has the same result as:</p>\n\n<pre><code>SELECT DISTINCT C FROM myTble\n</code></pre>\n\n<p>What I am curious of, is there anything different in the way an SQL engine processes the command, or are they truly the same thing?  </p>\n\n<p>I personally prefer the distinct syntax, but I am sure it's more out of habit than anything else.</p>\n\n<p>EDIT: This is not a question about aggregates. The use of <code>GROUP BY</code> with aggregate functions is understood.</p>\n"},{"tags":["sql","ruby-on-rails","case-insensitive"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13204957,"title":"Rails / SQL: Find attributes with same value but different capitalization","body":"<p>This may be really basic, but I can't think of how to write a SQL query that would find strings that have the same characters but different capitalization.</p>\n\n<p>The context I'm working on is a Rails 3.2 app. I have a simple Tag model with a Name attribute. I've inherited data for this model that did not store values case-insensitively, so some users input things like \"Tree\" while others input \"tree\" and now we have two tags that really should be one.</p>\n\n<p>So, I'd like to do a query to find all these pairs so that I can go about merging them.</p>\n\n<p>The only thing I can think of so far is to write a rake task that loops through them all and checks for matching values... something like:</p>\n\n<pre><code>pairs = []\nTag.all.each do |t|\n  other = Tag.where( 'name LIKE ?', t.name )\n  pairs &lt;&lt; [t, other] if other\nend\n</code></pre>\n\n<p>However, I'm not sure the above would work, or that it makes sense performance-wise. Is there a better way to write a SQL query that would find these matching pairs?</p>\n"},{"tags":["sql","odbc"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13206626,"title":"creating sql script to import oracle database into ms access","body":"<p>We currently have a procedure at work where we import data from an Oracle database into a MS Access 2007 database. </p>\n\n<p>We start by creating a blank access database labelled as the days day (dd/mm/yy), then import ODBC database entering a username and password finally selecting the tables required.</p>\n\n<p>I am trying to find a way of streamlining this process, maybe with sql script.\nIs this possible?</p>\n\n<p>I have a basic sql understanding, creating scripts to query/insert in tables, but i am unsure where to start with this project.</p>\n\n<p>any help would be much appreciated.</p>\n"},{"tags":["sql","mysql","delete"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1442,"score":2,"question_id":2008916,"title":"DELETE data from a table, joining through two tables","body":"<p>I'm working with some rather sensitive data, so I want to be ABSOLUTELY sure I am doing it properly.</p>\n\n<p>I am trying to delete the rows in a table that are associated with another table</p>\n\n<p>The only way to associate the table is to join through two other tables...</p>\n\n<p>here is the exact query:</p>\n\n<pre><code>DELETE tt.Transaction_Amount, tt.Transaction_ID\n  FROM ItemTracker_dbo.Transaction_Type tt\n  JOIN ItemTracker_dbo.Transaction t ON tt.Transaction_ID = t.Transaction_ID\n  JOIN ItemTracker_dbo.Purchase p ON p.Transaction_ID = tt.Transaction_ID\n  JOIN ItemTracker_dbo.Item i ON i.Item_ID = p.Item_ID\n WHERE i.Client_ID = 1\n</code></pre>\n\n<p>As you can see, it ain't pretty.</p>\n\n<p>I'm getting an odd error though through the MySQL query browser...</p>\n\n<blockquote>\n  <p>Unkown table 'Transaction_Amount' in MULTI DELETE</p>\n</blockquote>\n\n<p>I've tried reading the mysql manual and it seems like this should work to me... any one have any idea's?</p>\n"},{"tags":["sql","type-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13206417,"title":"Error converting data type varchar to numeric in SQL","body":"<p>I have an <code>nvarchar</code> field in my SQL table where column <code>KPI_WT</code> stores int/decimal values for different employees, i.e. 5,10,7.5 etc.\nI am running a query to get sum of KPI_WT for different employees as follows :</p>\n\n<pre><code>select EMP_CODE , SUM(CONVERT(decimal(5,2), KPI_WT) )\nfrom Table_1\ngroup by EMP_CODE\n</code></pre>\n\n<p>It is giving me following error :\n<code>'Error converting data type nvarchar to numeric.'</code></p>\n\n<p>I have also tried to cast the <code>KPI_WT</code> column to decimal, numeric but to no avail. How to fix this?</p>\n"},{"tags":["php","mysql","sql","sql-order-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13205928,"title":"ORDER BY with WHERE","body":"<p>I can't seem to get ORDER BY to work with my current MySQL Query I'm using!</p>\n\n<pre><code>$query = \"SELECT * FROM games WHERE game_platform = '$gameType' ORDER BY ASC\";\n\n$result = mysql_query($query);\n</code></pre>\n\n<p>I just get the following error.</p>\n\n<p>Warning: </p>\n\n<blockquote>\n  <p>mysql_fetch_assoc() expects parameter 1 to be resource, boolean given\n  in</p>\n</blockquote>\n"},{"tags":["sql","vba","ms-access","ms-access-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12930401,"title":"Record source and control source in ms access","body":"<p>I am creating a continuous form in MS Access 2010. In the details section of the form, I have two text boxes (named txtProj and txtArtifact). </p>\n\n<p>There are 2 tables in the database. \ntblProject and tblArtifact. </p>\n\n<pre><code>tblProject has [Project ID] - autonumber and [Project Name] - string.\ntblArtifact has [Artifact ID] - autonumber, [Project] - number and [Artifact Name] - string. \n</code></pre>\n\n<p><code>[Project ID]</code> and <code>[Project]</code> are related by one-to-many relationship.</p>\n\n<p>The Record Source for the form is tblArtifact. Now, in the textbox named txtProject, I want to display name of the project, rather than Project ID. </p>\n\n<p>I am not able to figure out, how to refer to a control source of a table, which is not record source of the form.</p>\n\n<p>Please help me. </p>\n\n<p>I would be happy to provide any additional details, if required.</p>\n\n<p>Thanks in anticipation.</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":27,"score":3,"question_id":13206134,"title":"Combine multiple SQL queries in 1","body":"<p>I kinda got stuck at trying to combine a few queries.\nWhat I got is the table holding sort of statistics and reference to another table.</p>\n\n<p>to get statistics report I'm running (short version):</p>\n\n<pre><code>SELECT COUNT(id) \nfrom [Actions] \nwhere date between '2012-01-01 00:00:00' AND '2012-01-01 23:59:59' \n  AND [Action]='request'\n</code></pre>\n\n<p>The question is if I want to get every-day statistics during the specified time period, how should this query look like? I understand if I change start and end dates, I'll get statistics for the whole specified period and not grouped by day. What am I missing?</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13091850,"title":"How to sort data before joining","body":"<p>Trying to do a diff of 2 tables with same data layout and have mismatch records on sameline</p>\n\n<pre><code>Table1                   Table2\n------                   ------\n\nCUSTOMER PART            CUSTOMER  PART\n\nCUSTID1  PART1           CUSTID1  PART1\nCUSTID1  PART2           CUSTID1  PART2\nCUSTID1  PART3           CUSTID1  PART3\nCUSTUD1  PART4\n\n\nSELECT T1.CUSTID, T1.PART, T2.CUSTID, T2.PART FROM TABLE1 AS T1\nLEFT JOIN TABLE2 AS T2 ON T1.CUSTID = T2.CUSTID\nWHERE  T1.PART &lt;&gt;  T2.PaRT\nORDER BY T1.CUSTID \n</code></pre>\n\n<p>Sometimes the output look like below - it shows a mismatch when there isn't one.\nCAn I order the tables before the join to get the data to line up ?</p>\n\n<p>Thanks</p>\n\n<pre><code>CUSTID1  PART1           CUSTID1  PART3\nCUSTID1  PART2           CUSTID1  PART1\nCUSTID1  PART3           CUSTID1  PART2\nCUSTUD1  PART4           NULL     NULL\n</code></pre>\n"},{"tags":["mysql","sql","phpmyadmin","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":13205736,"title":"multiple attribute query from mysql","body":"<p>i have a question here... i have a 3 tables like this...</p>\n\n<p>customer</p>\n\n<pre><code>idCustomer | namaCustomer | email   | noTelp \n__________________________________________________\n1          |  Wawan       | a@a.com | 08985623895\n</code></pre>\n\n<p>attribute</p>\n\n<pre><code>idAttribute | Name   | publish\n______________________________\n1           | Gender |  Y\n2           | Hobby  |  Y\n3           | Job    |  Y\n4           | Mission|  N\n</code></pre>\n\n<p>Customer attribute</p>\n\n<pre><code>idCustomer  |  idAttribute   | value \n_____________________________________\n1           |   1            | Male\n1           |   2            | Hacking\n1           |   3            | IT Support\n</code></pre>\n\n<p>The question is.. what query statement if i want to get the query from that 3 tables and get the result like this</p>\n\n<pre><code>idCustomer | namaCustomer | email   | noTelp      | Gender  | Hobby   | Job\n___________________________________________________________________________________\n1          |  Wawan       | a@a.com | 08985623895 | Male    | Hacking | IT Support\n</code></pre>\n\n<p>So the table column was added from customer attribute data, but before that we must look attribute tabel that the attribute is published or not (looking for publish value) </p>\n\n<p>anyone can help me here???</p>\n\n<p>great thanks before</p>\n"},{"tags":["java","mysql","sql","swing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13205689,"title":"Java, MySQL updating table using ID (primary key)","body":"<p>I have a program in which working with MySql and Java JDBC.</p>\n\n<p>My question is:</p>\n\n<p>I have a table (<code>TEMP</code>) with <code>ID</code> as only 1 column and another table with user personal details like ID, name, age etc.. </p>\n\n<p>Im trying to retrieve the <code>ID</code> from <code>TEMP</code> table and update unfilled information like name, age, address etc in <code>USER</code> table.</p>\n\n<p>This is the query I wrote:</p>\n\n<pre><code>update m_auth_info \nset name  = '\"+name+\"', \n    addr  = '\"+addr+\"', \n    email = '\"+email+\"', \n    affiliation = '\"+affil+\"', \n    status = '\"+1+\"'  \nwhere a_id = '\"+ResultSet+\"'\";\n</code></pre>\n\n<p>and when my <code>getIdMethod</code> retrieves ID into <code>ResultSet</code> from <code>TEMP</code> table. I couldn't able to update <code>USER</code> TABLE. </p>\n\n<p>But it works if I give ID directly.. example.</p>\n\n<pre><code>update m_auth_info \nset name = '\"+name+\"', \n    addr = '\"+addr+\"', \n    email = '\"+email+\"', \n    affiliation = '\"+affil+\"', \n    status = '\"+1+\"'  \nwhere a_id = '\"+8989+\"'\";\n</code></pre>\n\n<p>Please tell me if I have to write which step to write in my <code>getIdMethod</code>, so that ill get the value into <code>ResultSet</code>.</p>\n"},{"tags":["java","sql","jdbc","resultset"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":87,"score":4,"question_id":13205500,"title":"Is a generic sql query possible in java?","body":"<p>If I have a method to create SQL queries, as below :</p>\n\n<pre><code>public List selectTuple() {\n   boolean status = true;\n   String query = \"SELECT \";\n   query += getFields() == null ? \" * \" : \" \" + getFields() + \" \";\n   query += \" FROM \" + tables;\n   if ( getSearchClause() != null ) {\n       query += \" \" + getSearchClause();\n   }\n   query += \";\";\n   Debug(\"SQL...........caleed selectTuple method, query is : \"+ query);\n   setQuery(query);\n   if ( getPrepared() ) {//If this is a Prepared query,\n      status = setPreparedStatement();\n   } else {\n      status = setNonPreparedStatement();\n   }\n   if ( ! status ) {\n      Log(\"[CRITICAL] (.........)..........\");\n   }\n   status = doExecuteQuery();\n   if ( ! status ) {\n      Log(\"[CRITICAL] (.........)..........\");\n   }\n   return( getResults() );\n}//method selectTuple\n</code></pre>\n\n<p>However, since this will be used for different tables, the fields will be of different data types (int, string, date etc). So how can I iterate through such a ResultSet ?</p>\n\n<p>Also, how can I create such an Insert query ?</p>\n\n<p>Thanks. </p>\n"},{"tags":["c#","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":89,"score":0,"question_id":13196496,"title":"Rollback changes when code not executed properly","body":"<p>I am new to SQL, In my project I am trying to fill the DataSet from the DataBase table and then inserting new rows in DataSet. After doing this, again I am filling the Database table with the DataSet data. Before filling I am clearing or deleting the Database table data. Well I achieved this by using the below code:</p>\n\n<pre><code>Database Table --&gt; myTable\nDataSet --&gt; ds\n</code></pre>\n\n<hr>\n\n<p><strong>OnButtonClick</strong></p>\n\n<pre><code>   string strQuery = \"delete from [dbo].[myTable]\"\n   SqlConnection conn = new SqlConnection(strConn);\n   SqlCommand cmd = new SqlCommand(strQuery, conn);\n   SqlCommand command;\n   SqlDataAdapter da = new SqlDataAdapter(cmd);\n   using (cmd)\n   {\n      using (conn)\n      {\n         conn.Open();\n         cmd.ExecuteNonQuery();                    //deleting database table data\n         foreach (DataRow dr in ds.Tables[0].Rows) //Inserting new data into the Database table\n         {\n             command = new SqlCommand(InsertQuery, conn);\n             command.ExecuteNonQuery();\n         }\n         conn.Close();\n      }\n   }\n</code></pre>\n\n<p>The above code is working fine but when there is any exception in <code>command</code> sqlCommand then it is deleting the database table completely and not filling the DataSet. Any suggestions to modify this code? please help.</p>\n\n<p>UPDATE:</p>\n\n<pre><code>            string strQuery = \"delete from [dbo].[myTable]\";\n            using (SqlCommand cmd = new SqlCommand(strQuery, conn))\n            {\n                using (SqlCommand cmdReset = new SqlCommand(\"DBCC CHECKIDENT('myTable', RESEED, 0)\", conn))\n                {\n                    SqlDataAdapter da = new SqlDataAdapter(cmd);\n                    conn.Open();\n                    SqlTransaction sqlTransaction = conn.BeginTransaction();\n                    cmd.Transaction = sqlTransaction;\n                    try\n                    {\n                        cmd.ExecuteNonQuery();                   //deleting database table data\n                        cmdReset.ExecuteNonQuery();               //Resetting Identity of first column\n                        foreach (DataRow dr in ds.Tables[0].Rows) //Inserting new data into the Database table\n                        {\n                            command = new SqlCommand(query.createDoctorRow(InsertQuery, conn);\n                            command.ExecuteNonQuery();\n                        }\n                        sqlTransaction.Commit();\n                        conn.Close();\n                    }\n                    catch (Exception e)\n                    {\n                        sqlTransaction.Rollback();\n         /*ERROR*/      throw;  \n                    }\n                }\n            }\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>ERROR -->  \"ExecuteNonQuery requires the command to have a transaction when the connection assigned to the command is in a pending local transaction.  The Transaction property of the command has not been initialized.\"</p>\n</blockquote>\n"},{"tags":["sql","sql-server-2008","search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13205487,"title":"Match \"word\"s or \"word\"(s)","body":"<p>I am query a data set using <code>field like '%search%'</code> in MS-SQL.  My data often times will contain values like <code>words</code> and <code>word(s)</code>.  I would like to be able to allow users to search for either of those values and get both of them back.  So searching for <code>words</code> would return both results containing <code>words</code> and <code>word(s)</code>, and visa-versa.</p>\n\n<p>Is there a good way of doing this?  Or do I just need to detect in code that the search ends in an <code>s</code> or <code>(s)</code> and update the search accordingly?</p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":135,"score":0,"question_id":7467438,"title":"How to move a table from system schema to scott schema in Oracle?","body":"<p>In some days ago...i was converting some Large MySQL Database to Oracle 10g R2 by using Oracle SQL Developer database migration tools.But unfortunately it was migrated on system schema.but i need to it on scott schema.\nAfter Googling i found this two links <a href=\"http://www.orafaq.com/forum/t/96818/2/\" rel=\"nofollow\">OraFAQ Forum</a> and <a href=\"http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:752030266230\" rel=\"nofollow\">ASK TOM Q&amp;A</a>.But I cannot find any appropriate answer. Any one Can help me to do , How it is possible.</p>\n\n<p>Thanks In Advance.</p>\n"},{"tags":["sql","sybase","sqlanywhere","dynamic-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12452128,"title":"Cannot Discern Apparent SQL Invalid Expression","body":"<p>I tried to run a dynamically generated SQL query within PHP targeting an Sybase SQL-Anywhere database and I got the following error:</p>\n\n<p><code>Warning: mssql_query(): message: SQL Anywhere Error -680: Invalid expression in WHERE clause of Transact-SQL outer join (severity 16) in /path/to/file.php</code></p>\n\n<p><strong>SQL Query String:</strong></p>\n\n<pre><code>SELECT DISTINCT v_InventoryMaster.INV_ScanCode, v_InventoryMaster.INV_ReceiptAlias \nFROM ecrs.v_InventoryMaster, ecrs.StockInventoryLinkDiscounts\nWHERE StockInventoryLinkDiscounts.ILD_INV_FK = v_InventoryMaster.INV_PK \nAND ( v_InventoryMaster.INV_DPT_FK = 9\n  AND v_InventoryMaster.INV_PI1_FK = 118\n  AND ( StockInventoryLinkDiscounts.ILD_DIS_FK IN( 14,6,8,9,10,11,12,17,18,4,2,7,15,16)\n    OR v_InventoryMaster.INV_PK NOT IN (\n      SELECT DISTINCT v_InventoryMaster.INV_PK \n      FROM ecrs.v_InventoryMaster, ecrs.StockInventoryLinkDiscounts\n      WHERE v_InventoryMaster.INV_PK = StockInventoryLinkDiscounts.ILD_INV_FK\n      AND StockInventoryLinkDiscounts.ILD_DIS_FK IN(13,5) \n    )\n  )  \n)\nORDER BY v_InventoryMaster.INV_ScanCode\n</code></pre>\n\n<p>I'm not completely new to SQL or interfacing with a database, but this message has me stumped. It claims that there is an invalid expression in the <code>WHERE</code> clause, probably the outer one, but I can't see how the query is illegally structured.</p>\n"},{"tags":["php","sql","codeigniter","iis-7.5","php-5.4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13203917,"title":"Unable to connect using sqlsrv on PHP 5.4 but works for 5.3","body":"<p>After upgrading to PHP 5.4 and using CodeIgniter's PHP framework my application refused to connect to the SQL Server 2005 database. There were no configuration changes performed, and I made sure to install the PHP SQLSRV drivers (3.0.3) as well. The specific message from CI was \"Unable to connect to your database server using the provided settings\".</p>\n\n<p>Switch back to PHP 5.3 and everything works.</p>\n\n<p>To make sure that the sqlsrv drivers are installed on PHP 5.4 I ran <code>php -m</code> and it displays \"sqlsrv\". phpinfo() looks good as well.</p>\n\n<p>I can't get any debug information on how/why sqlsrv isn't connecting with the new drivers. What's funny is that if I download sqlsrv-5.4-nts-snap.zip from <a href=\"http://downloads.php.net/pierre/\" rel=\"nofollow\">this funny page of drivers on MS's site</a> - then it works! However it seems to be using sqlsrv 2.0 drivers.</p>\n\n<p>Does SQLSRV work on PHP 5.4?</p>\n"},{"tags":["mysql","sql","database","schema","normalization"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13204690,"title":"Combine or Separate Tables","body":"<p>I'm confused on whether I should combine two tables or leave them separated. The ff is just one set of that problem of mine:</p>\n\n<pre><code>tblPhone(Phone_ID, Phone_Number, Phone_Type_ID, Person_ID)\ntblPhone(Phone_Type_ID, Phone_Type_Name)\n</code></pre>\n\n<p>or</p>\n\n<p>I should simply have it as:</p>\n\n<pre><code>tblPhone(Phone_ID, Phone_Number, Phone_Type_Name, Person_ID)\n</code></pre>\n\n<p><strong>Does one have advantage over the other?</strong> Is there like a <strong>standard guideline or practice</strong> for table creation? For example, I remember someone telling me if a table isn't 3 or more, just combine it to another table, something like that...how true is that? I remember a little bit of normalization rules...but it can be very confusing at times. I think this falls on the third normalization rule that's why they should be separated, am I mistaken? Thanks!</p>\n"},{"tags":["mysql","sql","insert"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13204445,"title":"Using MySQL session variable to increment a sort order / weight on Insert","body":"<p>Alright, my brain is a bit done for today and I might be approaching this completely wrong, so I'm hoping someone can give me a bit of insight on this.  </p>\n\n<p>I'm running an insert, through a loop in my code, though I'm wanting to use MySQL Session variables to increment the sort_order.</p>\n\n<p>Maybe I'm just overthinking, any suggestions?  The table is recursive, so it does have parent/child elements, so doing something like <code>SELECT MAX(sort_order)</code> wouldn't work unless explicitly defining the parent id..which could work.  Well talked myself out of that one, still curious.</p>\n\n<pre><code>INSERT INTO another_table (some_field, sort_order)\nVALUES\n    (\n        'some field value',\n        (\n            SELECT\n                @sort_order := @sort_order + 1 sort_order\n            FROM \n                (SELECT @sort_order := 0) so  \n        )\n    )\n</code></pre>\n"},{"tags":["c#","sql","linq-to-sql","datacontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13204076,"title":"System.InvalidOperationException: An entity can only be attached as modified","body":"<p>am trying to update table called \"Hero\" , am using <code>DataContext</code> , here is how the codes looks like:-</p>\n\n<pre><code>//linq to sql table (automatic generated)\n[global::System.Data.Linq.Mapping.TableAttribute(Name=\"dbo.Hero\")]\n    public partial class Hero : INotifyPropertyChanging, INotifyPropertyChanged\n    {\n          //fields methods etc..\n    }\n</code></pre>\n\n<p>and there is my own partial class Hero ...</p>\n\n<pre><code>    public partial class Hero : IHero {\n           //my fields and methods etc...\n\n            public void Save() {\n                using(GameDBDataContext db = new GameDBDataContext()) {\n                    db.Heros.Attach(this, true);\n                    db.SubmitChanges();\n                }\n        }\n}\n</code></pre>\n\n<p>but it's throwing this :- </p>\n\n<pre><code>System.InvalidOperationException: An entity can only be attached as modified without original state if it declares a version member or does not have an update check policy.\n</code></pre>\n\n<p>what is the solution for this problem?</p>\n\n<p>EDIT: I have tried this :-</p>\n\n<pre><code>public void Save() {\n    using(GameDBDataContext db = new GameDBDataContext()) {\n        db.Heros.Attach(this, db.Heros.SingleOrDefault(x =&gt; x.id == EntityID));\n    }\n}\n</code></pre>\n\n<p>and it throws :- <code>System.NotSupportedException: An attempt has been made to Attach or Add an entity that is not new, perhaps having been loaded from another DataContext.  This is not supported.</code></p>\n"},{"tags":["c#","sql","xsd"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13203292,"title":"Updating table adapter config reference error","body":"<p>When I try to update a project that was written last year, I am running into problems.</p>\n\n<p>I click configure on the xsd table adapter configuration and after my select statement I get:</p>\n\n<pre><code>Could not load file or assembly 'microsoft.sql.server.types, version = 11.0.0.0,\nculture=neutral,publickeytoken=89845dcd8080cc91 or one of its dependencies.\n</code></pre>\n\n<p>What is odd to me is that I can do a preview of the data and see the sample select, but I can not do a configure from the gui.</p>\n\n<p>I included the file <code>C:\\Program Files (x86)\\Microsoft SQL Server\\100\\SDK\\Assemblies\\Microsoft.SqlServer.Types.dll\nv. 10.0.0.0</code></p>\n\n<p>I have installed SQL Server 2008 R2 SP1.  Where can I find version 11 and why does the select work but not configure?</p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1049,"score":0,"question_id":7019197,"title":"Oracle SQL: Get the last eight months of data (with YEAR and MONTH columns)","body":"<p>I have a table that has columns YEAR and MONTH, which are varchars, which have a format like MONTH = '02', YEAR = '2011'.</p>\n\n<p>What query can I use to get the last eight months of data, excluding the current month?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13204080,"title":"Oracle SQL - Grouping by CASE","body":"<p>I have the following query:</p>\n\n<pre><code>Select Player_Id,\nPt_Credit As Total_Points\nFrom Player \nWhere Trunc(Create_Dtime) = Trunc(Sysdate) - 90\nAnd Trunc(Init_Dtime) &gt;= To_Date('2012-sep-1','yyyy-mon-dd')\nOrder by Total_Points Desc\n</code></pre>\n\n<p>Which gives me this result:</p>\n\n<pre><code>Player_ID      TOTAL_POINTS\n  23452         1500\n  23494         1000\n  30934         500\n</code></pre>\n\n<p>and so on. I want to group these player_ids results into groups like 0-300 points, 301-600 points, 601-900 points , and greater than 900 points...so it would look like this in the results:</p>\n\n<pre><code>Point_Level     Count(Player_ID)\n0-300            532\n301-600          444\n601-900          669\n&gt;900             185\n</code></pre>\n"},{"tags":["sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13203638,"title":"Lossless Decomposition","body":"<p>Consider a schema R(A, B, C, D) and functional dependencies A ⟶ B and C ⟶ D. Then why isn't the decomposition of R into R1(A, B) and R2(C, D) a lossless decomposition? Can you please explain with real life example that what info is lost here?</p>\n"},{"tags":["sql","sql-server","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13203682,"title":"I am stuck on creating constraint on SQL Server","body":"<p>I am totally new to SQL Server management, I tried to add a constraint in a table.</p>\n\n<p>The situation is that I created a column with <strong>only 'Y'or 'N' allowed to be valued</strong>.</p>\n\n<p>So I tried to create a constraint in Management Studio by right clicking \"Constraints\" in the table.</p>\n\n<p>However, I really have no idea about the syntax of creating a constraint. Finally, I tried to input the code into \"Check Constraint Expression\" window by referring the template from the Internet. The SQL Server always tell me \"Error Validating constaint\".</p>\n\n<p>Can you guys just help me to write the first constraint for me? Because I really dont know how to start.</p>\n\n<p>My requirement is:</p>\n\n<pre><code>I have a table called \"Customer\"\nI created a column called \"AllowRefund\"\nThe column \"AllowRefund\" is only allowed to 'Y' or 'N'\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["python","sql","mongodb","pymongo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13203294,"title":"MongoDB and PyMongo - SQL like columns","body":"<p>I have a MySQL database with a table called <strong><em>sources</em></strong>, there I have two columns called <strong><em>srctype</em></strong> and <strong><em>url</em></strong> where srctype is a name (e.g: Hello) and url is an url (e.g: <a href=\"http://google.com\" rel=\"nofollow\">http://google.com</a>)</p>\n\n<p>In Python using SQLAlchemy, I could filter the srctype and get a list of the urls, for example; </p>\n\n<pre><code>src = \"hello\"    \nlinks = session.query(sources).filter_by(srctype=src).all()\n</code></pre>\n\n<p>Easy, now I am migrating this data to a MongoDB, for this I am using <strong><em>pymongo</em></strong>.</p>\n\n<p>I have a function where it saves the srctype and url to mongodb's database</p>\n\n<pre><code>    def insertSources(self, srctype, link):\n        \"\"\" Insert rss sources so we can parse them \"\"\"\n        new = {srctype: link}\n        self.__sources.insert(new)\n</code></pre>\n\n<p>and a function that retrieves the srctype</p>\n\n<pre><code> def getSources(self, type=None, single=True): # type == srctype\n    if type:\n        if single:\n            return self.__sources.find_one()\n        else:\n            return iter(self.__sources.find({srctype:type}))\n    else:\n        if single:\n            return self.__sources.find_one()\n        else:\n            return iter(self.__sources.find())\n</code></pre>\n\n<p>The problem here is, since there is no column called srctype and no column called url, how can I do the same as the SQLAlchemy/MySQL example?</p>\n\n<p>In MySQL would be;</p>\n\n<pre><code>SELECT * FROM sources WHERE srctype=\"hello\"\n</code></pre>\n\n<p>I wonder how will that be in the retrieve function I have (also in the insert function, since I am not sure if what I did there is correct for the job I want). In the <em>insertSources</em> function I simple add a <em>dict</em> to MongoDB, clearly I won't be able to get the srctype in the getSources function, since srctype in MongoDB is no column. \nAny help would be great. </p>\n"},{"tags":["sql","sql-server","naming-conventions"],"answer_count":36,"favorite_count":51,"up_vote_count":188,"down_vote_count":0,"view_count":38881,"score":188,"question_id":338156,"title":"Table Naming Dilemma: Singular vs. Plural Names","body":"<p>Convention has it that table names should be the singular of the entity that they store attributes of.  </p>\n\n<p>I dislike any T-SQL that requires square brackets around names, but I have renamed a <code>Users</code> table to the singular, forever sentencing those using the table to sometimes have to use brackets.  </p>\n\n<p>My gut feel is that it is more correct to stay with the singular, but my gut feel is also that brackets indicate undesirables like column names with spaces in them etc.</p>\n\n<p>Should I stay, or should I go?</p>\n"},{"tags":["sql","entity-framework-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13203469,"title":"Entity Framework - Update many to many relationships","body":"<p>I'm having a problem attempting to update a Many to Many type relationship in my table.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>            foreach (ThingCategory category in this.unit.Context.ThingCategories.Where(c =&gt; c.ThingId == thingId))\n            {\n                if (this.unit.Context.Entry(category).State == EntityState.Detached)\n                {\n                    this.unit.Context.ThingCategories.Attach(category);\n                }\n\n                this.unit.Context.ThingCategories.Remove(category);\n            }\n\n            foreach (ThingCategory category in categories)\n            {\n                if (this.unit.Context.Entry(category).State == EntityState.Detached)\n                {\n                    this.unit.Context.ThingCategories.Attach(category);\n                    this.unit.Context.Entry(category).State = EntityState.Added;\n                }\n                else\n                {\n                   this.unit.Context.Entry(category).CurrentValues.SetValues(category);\n                   this.unit.Context.Entry(category).State = EntityState.Modified;\n                }\n            }\n\n            this.unit.Context.SaveChanges();\n</code></pre>\n\n<p>I'm getting:</p>\n\n<blockquote>\n  <p>An object with the same key already exists in the ObjectStateManager.\n  The ObjectStateManager cannot track multiple objects with the same\n  key.</p>\n</blockquote>\n\n<p>The ThingCategory entity uses a composite primary key made from a ThingId and CategoryId.</p>\n\n<p>Can someone please point me in the right direction to doing this the right way?</p>\n\n<p>Thanks,</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13198812,"title":"SQL Merge with two stage match","body":"<p>I want to merge two tables using SQL Server on the following basis:</p>\n\n<p>IF the primary key (Operation) matches THEN\n    If Source Date Matches Target Date\n        Do nothing\n    Else\n        SET Target Revised_Date to Source Date\nElse\n    Insert Target Row from Source Row</p>\n\n<p>I have built an SQL merge below that does the first stage but can't see how to do the second stage.</p>\n\n<pre><code>MERGE \n    Completed_Operations AS target\nUSING \n    @Completed_Operation_Table AS source ON (target.Operation = source.Operation)\nWHEN MATCHED THEN \n    UPDATE \n    SET target.Revised_Completion_Date  = source.Completion_Date,\n            target.Revised_Pln_Hrs          = source.Pln_Hrs,\n            target.Revised_Pln_Hrs_Capped   = source.Pln_Hrs_Capped,\n            target.Revised_Act_Hrs          = source.Act_Hrs\nWHEN NOT MATCHED THEN   \n    INSERT (Operation, Orig_Completion_Date, Orig_Pln_Hrs, Orig_Act_Hrs, Revised_Completion_Date, Revised_Pln_Hrs, Revised_Act_Hrs)\n    VALUES (source.Operation, source.Completion_Date, source.Pln_Hrs, source.Act_Hrs, NULL, NULL, NULL);\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13203108,"title":"Conditionally setting variable with case statment","body":"<p>I have the following query. I am trying to only add the values, if the value is not null so the whole variable doesnt end up as a null. Obviously this query below is erroring out, but I do not want to use an ISNULL check on the test column because it puts a comma at the end of the variable text. How would I do this without having the comma at the end of the variable text. Sometimes there will be nulls in the test column, and sometimes there will not be.</p>\n\n<pre><code>DECLARE @Test TABLE\n(\n    test varchar(20)\n)\n\nINSERT INTO @Test\nSELECT 'adfasdfasd'\nUNION ALL\nSELECT NULL\n\n\nDECLARE @DocID varchar(max)\n\nSELECT CASE WHEN test IS NOT NULL THEN @DocID = COALESCE(@DocID + ',' ,'')  + test END\nFROM @Test\n\nSELECT @DocID\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13203223,"title":"custom query to show records with duplicate count with its duplicate occurance","body":"<p>Please refer below script</p>\n\n<pre><code>            declare @table1 table\n            (\n            col1 int\n            )  \n\n            insert into @table1 values(1)\n            insert into @table1 values(3)\n            insert into @table1 values(3)\n            insert into @table1 values(6)\n            insert into @table1 values(4)\n            insert into @table1 values(4)\n            insert into @table1 values(4) \n</code></pre>\n\n<p>The below query gives </p>\n\n<pre><code>            select col1 ,COUNT(col1) cntCol1 from @table1 group by col1\n</code></pre>\n\n<p>this output</p>\n\n<pre><code>            ----------------\n            col1   | cntCol1\n            -------| -------\n            | 1    | 1    | \n            | 3    | 2    | \n            | 4    | 3    | \n            | 6    | 1    | \n            ---------------\n</code></pre>\n\n<p>is it possible to get the below output</p>\n\n<pre><code>            ----------------\n            col1   | cntCol1\n            -------| -------\n            | 1    | 1    | \n            | 3    | 1    | \n            | 3    | 2    |  \n            | 4    | 1    |  \n            | 4    | 2    |  \n            | 4    | 3    | \n            | 6    | 1    | \n            ---------------\n</code></pre>\n\n<p>If so, could you please help me with the query.</p>\n\n<p>Thanks, \nEsen.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13202809,"title":"Adding rows to SQL query for each element in WHERE sequence","body":"<p>I have an SQL query like the following:</p>\n\n<pre><code>SELECT store_id, SUM(quantity_sold) AS count\nFROM sales_table\nWHERE store_id IN ('Store1', 'Store2', 'Store3')\nGROUP BY store_id;\n</code></pre>\n\n<p>This returns a row for each store that has rows in <code>sales_table</code>, but does not return a row for those that do not. What I want is one row per store, with a <code>0</code> for <code>count</code> if it has no records.</p>\n\n<p>How can I do this, assuming that I do not have access to a <code>stores</code> table?</p>\n"},{"tags":["sql","ms-access","sum","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13203094,"title":"In SQL How is it possible to use the Sum Function in an Update","body":"<p>This is the code that i used</p>\n\n<pre><code>UPDATE Customers c   \nSET c.TotalP= \n   (SELECT SUM(b.Price) \n    FROM Products b\n   WHERE b.CustomerID= c.CustomerID)\n</code></pre>\n\n<p>I im trying to set a value x to the TotalP field in the Customers table.\nThe value x is equal to the sum of the coressponding prices in the Products table where the Customer ID's are the same.</p>\n\n<p>The above code returns an error of <code>\"Operation must be an Updateable query\"</code></p>\n"},{"tags":["sql","data","tree"],"answer_count":6,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":3033,"score":9,"question_id":2175882,"title":"How to represent a data tree in SQL?","body":"<p>I'm writing a data tree structure that is combined from a Tree and a TreeNode. Tree will contain the root and the top level actions on the data.\nI'm using a UI library to present the tree in a windows form where I can bind the tree to the TreeView.</p>\n\n<p>I will need to save this tree and nodes in the DB.\nWhat will be the best way to save the tree and to get the following features:</p>\n\n<ol>\n<li>Intuitive implementation.</li>\n<li>Easy binding. Will be easy to move from the tree to the DB structure and back (if any)</li>\n</ol>\n\n<p>I had 2 ideas. The first is to serialize the data into a one liner in a table.\nThe second is to save in tables but then, when moving to data entities I will loose the row states on the table on changed nodes.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["mysql","sql","database","database-design","aggregate-functions"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13199060,"title":"Finding the average age of users with 0 posts, 1-5 posts, and >5 posts","body":"<p>I need to generate a report on the age of some of our users with respect to their post count grouped by their country of residence.</p>\n\n<p>Here's a simplified version of my schema right now:</p>\n\n<pre><code>DESCRIBE countries;\n+-------+-------------+------+-----+---------+----------------+\n| Field | Type        | Null | Key | Default | Extra          |\n+-------+-------------+------+-----+---------+----------------+\n| id    | int(11)     | NO   | PRI | NULL    | auto_increment |\n| name  | varchar(45) | NO   |     | NULL    |                |\n+-------+-------------+------+-----+---------+----------------+\n\nDESCRIBE users;\n+------------+---------+------+-----+---------+----------------+\n| Field      | Type    | Null | Key | Default | Extra          |\n+------------+---------+------+-----+---------+----------------+\n| id         | int(11) | NO   | PRI | NULL    | auto_increment |\n| age        | int(11) | NO   |     | NULL    |                |\n| country_id | int(11) | NO   | MUL | NULL    |                |\n+------------+---------+------+-----+---------+----------------+\n\nDESCRIBE posts;\n+---------+-------------+------+-----+---------+----------------+\n| Field   | Type        | Null | Key | Default | Extra          |\n+---------+-------------+------+-----+---------+----------------+\n| id      | int(11)     | NO   | PRI | NULL    | auto_increment |\n| content | text        | NO   |     | NULL    |                |\n| user_id | int(11)     | NO   | MUL | NULL    |                |\n+---------+-------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>And I'd like a result set that looks something like this:</p>\n\n<pre><code>country.name | AVG(age of users with 0 posts) | AVG(age of users with 1-5 posts | AVG(age of users with 1-5 posts\n----------------------------------------\nDenmark  | 17.4   | 23.2   | NULL\nGermany  | 20.1   | 27.8   | 34.7\nEngland  | 31.1   | NULL   | 28.3\n</code></pre>\n\n<p>where NULL would represent a country who has no users at a particular post-count level. For example, everyone in Denmark has 0 through 5 posts, and no more. I suppose it doesn't have to say NULL, but it should be clear that this value is undetermined.</p>\n\n<p>So far, this is my query:</p>\n\n<pre><code>SELECT\n    c.name,\n    AVG(something) AS avg_age_with_no_posts,\n    AVG(something) AS `avg_age_with_1-5_posts`,\n    AVG(something) AS `avg_age_with_gt5_posts`\nFROM\n    users u\n    JOIN posts p ON p.user_id=u.id\n    JOIN countries c ON c.id=u.country_id\nGROUP BY c.id;\n</code></pre>\n\n<p>I know it's not much, but I've actually foiled with other clauses (nested selects, HAVING, COUNT(CASE ... WHEN ...)) quite a bit (several hours). The query above is just the fundamental things I know I need.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","syntax","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13202230,"title":"You have an error in your SQL syntax? Works on its own, but get error when doubled up","body":"<p>Bit puzzled by this, when i comment out the second query i get no error, the first query runs fine but when the second one (basicly the same query) is added i get you have an error in your sql syntax.\nLittle bit unsure why, any help is appreciated maybe there is a better way for me to do the query, thanks.</p>\n\n<p>SQL ERROR [ mysqli ]</p>\n\n<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1 [1064]</p>\n\n<p>SQL</p>\n\n<p>SELECT username FROM forum_users WHERE user_id = </p>\n\n<p>BACKTRACE</p>\n\n<pre><code>$challengingClan = $results-&gt;get('challengingClan');\n$query = \"SELECT username FROM forum_users WHERE user_id = $challengingClan\";\n$user1 = $db-&gt;sql_query($query);\n$user1 = $db-&gt;sql_fetchrow($user1);\n\n$opposingClan = $results-&gt;get('opposingClan');\n$query = \"SELECT username FROM forum_users WHERE user_id = $opposingClan\";\n$user2 = $db-&gt;sql_query($query);\n$user2 = $db-&gt;sql_fetchrow($user2);\n</code></pre>\n"},{"tags":["android","sql","sqliteopenhelper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13202837,"title":"get database called recursively error only on HTC Sensation XL","body":"<p>I'm working on a application where the database is imported like in this tutorial: <a href=\"http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/\" rel=\"nofollow\">http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/</a></p>\n\n<p>This works fine on most devices,only at HTC Sensation XL it doesn't work.</p>\n\n<p>Thanks for your Help</p>\n\n<p>Here is error code</p>\n\n<p>11-02 21:35:33.748: W/System.err(14878): java.lang.IllegalStateException: getReadableDatabase called recursively\n11-02 21:35:33.748: W/System.err(14878):    at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:245)\n11-02 21:35:33.748: W/System.err(14878):    at at.klettern.database.DatabaseHelper.createDataBase(DatabaseHelper.java:54)\n11-02 21:35:33.748: W/System.err(14878):    at at.klettern.database.DatabaseHelper.onCreate(DatabaseHelper.java:148)\n11-02 21:35:33.758: W/System.err(14878):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:183)\n11-02 21:35:33.758: W/System.err(14878):    at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:249)\n11-02 21:35:33.758: W/System.err(14878):    at at.klettern.database.DatabaseRouten.(DatabaseRouten.java:39)\n11-02 21:35:33.758: W/System.err(14878):    at at.klettern.wachauclimbing.SplashActivity.onCreate(SplashActivity.java:28)\n11-02 21:35:33.758: W/System.err(14878):    at android.app.Activity.performCreate(Activity.java:4531)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2150)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread.access$600(ActivityThread.java:139)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)\n11-02 21:35:33.778: W/System.err(14878):    at android.os.Handler.dispatchMessage(Handler.java:99)\n11-02 21:35:33.778: W/System.err(14878):    at android.os.Looper.loop(Looper.java:154)\n11-02 21:35:33.778: W/System.err(14878):    at android.app.ActivityThread.main(ActivityThread.java:4945)\n11-02 21:35:33.778: W/System.err(14878):    at java.lang.reflect.Method.invokeNative(Native Method)\n11-02 21:35:33.778: W/System.err(14878):    at java.lang.reflect.Method.invoke(Method.java:511)\n11-02 21:35:33.788: W/System.err(14878):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)\n11-02 21:35:33.788: W/System.err(14878):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)\n11-02 21:35:33.788: W/System.err(14878):    at dalvik.system.NativeStart.main(Native Method)</p>\n"},{"tags":["sql","drupal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13201521,"title":"Update SQL Records in Drupal","body":"<p>I need to update 50K records by changing the status of comments (turning read &amp; read/write into disabled) and want to make sure my SQL statement is correct:</p>\n\n<pre><code>$query = \"UPDATE node.nid AS nid, node.comment AS node_comment, node.type AS node_type\n        SET node.comment = '0'\n        WHERE (node.type in ('article', 'blog', 'event')) \n        AND  (node.comment in ('1','2'))\";\n\n$total = 0;\n$count = 0;\nwhile ($query_result = db_query($query)){\n    $count++;\n    $total++;\n    if($count&gt;200){\n        $count = 0;\n        sleep(300);\n    }    \n}\necho \"Updated records:\" . $total;\n</code></pre>\n\n<p>I added a periodic pause in there so it doesn't kill the server.  Does this look ok?</p>\n"},{"tags":["java","sql","vaadin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13181300,"title":"How to order Vaadin Table Rows?","body":"<p>I have a table <strong>phases</strong> that has values that reference to a <strong>repository</strong> table. In the repository each value has an order number.</p>\n\n<p>Normally in SQL, I would join them and then order by the order column. But if I want to do that in Vaadin I have to use the <code>FreeFormQuery</code> to make this join. </p>\n\n<p>The Problem is that I want to allow users to change values in the table <strong>phases</strong>. So I would need to implement the <code>FreeFormQueryDelegate</code>. Is there a way to make this work by using a standard <code>TableQuery</code> instead of a <code>FreeFormQuery</code> ?</p>\n\n<p>Maybe manually move the rows in a table ?</p>\n"},{"tags":["sql","sql-order-by","case"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13196010,"title":"SQL Case Order By specific order","body":"<p>Ok, I asked something similar before, but I've researched it and haven't found this specifically.\nI have a table that I need sorted on fields OptionName(NVarChar) and IsActive(BIT).</p>\n\n<p>I need the results to be in the following order for a DDL:</p>\n\n<pre><code>Option A\nOption B\nOption C\nOptions that are Active, by OptionName ASC \nOption D\nOptions that are Inactive, by OptionName ASC \n</code></pre>\n\n<p>So far I have</p>\n\n<pre><code>ORDER BY CASE WHEN PortalName = 'Company, Inc' THEN 0 ELSE 1 END,\n         CASE WHEN PortalName = 'Setup' THEN 1 ELSE 2 END,\n         CASE WHEN PortalName = 'Daily Routine' THEN 2 ELSE 3 END,\n         CASE WHEN IsActive = 1 THEN 3 ELSE 4 END, \n         CASE WHEN PortalName = 'Master Option' THEN 4 ELSE 5 END,\n         PortalName ASC\n</code></pre>\n\n<p>But this returns the results as:</p>\n\n<pre><code>Option A\nOption B\nOption C\nOption D\nOptions that are Active, by OptionName ASC \nOptions that are Inactive, by OptionName ASC \n</code></pre>\n\n<p>Any help would be great!</p>\n"},{"tags":["sql","query-optimization","database-performance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13202671,"title":"SQL Selecting a View Inside an Inline Table Value Function Performance","body":"<p>I have a query that takes about 14 minutes to complete using an inline table valued function that selects from a view on a linked server. However, if this query is changed to remove the function and select directly from the query it completes in about 20 seconds.</p>\n\n<p>Function:</p>\n\n<pre><code>CREATE FUNCTION [dbo].[fn_GetView](CompanyCharacters VARCHAR(4))\nRETURNS TABLE\nAS\nRETURN\n(\n    SELECT DISTINCT\n           [Some Rows]\n    FROM   LinkedServer.Database.dbo.LinkedView\n    WHERE  Co_char = RIGHT(REPLACE('0', 4) + \n                           CAST(@CompanyCharacters AS VARCHAR(4)), 4)\n)\n</code></pre>\n\n<p>Query that takes 14 minutes:</p>\n\n<pre><code>SELECT [Some Rows]\nFROM   fn_GetSomeCompanyData() AS Comp\n       JOIN CustomerData ON Comp.ID = CustomerData.CompID\n       JOIN fn_GetView('MSF') AS gv ON gv.CompanyChar = Comp.CompanyChar\n                                    AND gv.FirstName = Comp.FirstName\n                                    AND gv.FirstName = Comp.FirstName\n</code></pre>\n\n<p>Changed Query that takes 20 seconds:</p>\n\n<pre><code>SELECT [Some Rows]\nFROM   fn_GetSomeCompanyData() AS Comp\n       JOIN CustomerData ON Comp.ID = CustomerData.CompID\n       JOIN LinkedServer.Database.dbo.LinkedView AS gv ON gv.CompanyChar = Comp.CompanyChar\n                                    AND gv.FirstName = Comp.FirstName\n                                    AND gv.FirstName = Comp.FirstName\nWHERE [Some Data Filtering]\n</code></pre>\n\n<p>Anyone have any ideas why this behaves this way? Is there a best way to change the query so that it is fast but can also still keep the function?</p>\n"},{"tags":["sql","database","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13202148,"title":"How can I represent this idea to the database design?","body":"<p>I am new to database design, I am trying to build a database of shopping system.</p>\n\n<p>Assume we have a Customer table and a Staff table.</p>\n\n<p>The requirement is: </p>\n\n<ol>\n<li>To allow part of the customers to have privilege of \"Item return &amp; refund\".</li>\n<li>To allow part of the staff to have the authority to process the refund.</li>\n</ol>\n\n<p>My idea is to <strong>simply add a column with a Boolean value to \"Flag\" which customer or which staff has the authority or not?</strong></p>\n\n<p>Is that correct to solve this problem? Any potential problem?</p>\n"},{"tags":["sql","date","typo3","where","typoscript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13200407,"title":"SQL date comparison in WHERE clause, TypoScript","body":"<p>I want to compare dates in a TypoScript select.\nHere's what I have (note that I commented the <strong>were</strong> clauses) : </p>\n\n<pre><code>lib.my_val = CONTENT\nlib.my_val {\n  select {\n    pidInList = 100000\n    max = 1\n    #where = effective_date &lt; CURDATE()\n    #where = TIMESTAMP(effective_date) &lt; NOW()\n    orderBy = effective_date DESC\n  }\n  table = tx_my_table\n  renderObj = COA\n  renderObj {\n    5 = TEXT\n    5{\n      field = my_field\n      wrap = &lt;span&gt;|&lt;/span&gt;\n    }\n    [...]\n  }\n}\n</code></pre>\n\n<p>Which returns lines.</p>\n\n<p>I tried to add a <strong>where</strong> statement any way I could with static dates or variables... without success. My understanding of the <strong>where</strong> clause is that everything after the <code>=</code> is dumped <em>as is</em> in the SQL query. But it seems I missed something.</p>\n\n<p>Basically I want the TypoScript to generate a SQL Query smilar to this :</p>\n\n<p><code>SELECT * FROM tx_my_table WHERE effective_date &lt; NOW() ORDER BY effective_date DESC LIMIT 1;</code></p>\n\n<p>This should be simple. Has anyone done this in the past?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","google-app-engine","gwt","google-cloud-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13178439,"title":"Google Cloud SQL doesnt work when deployed to appspot","body":"<p>I have a GWT project, using google sql cloud database. Everything works fine when developing locally ( development mode ). But when I deploy it to appspot it can't connect to to the database. </p>\n\n<p>Doesn't anyone have an idea why this is? Should I change permissions somewhere ? I'm pretty much  lost.</p>\n\n<p>I must say there is another deployed project using this database.</p>\n\n<p>Thanks in advance :) </p>\n\n<p>UPDATE: </p>\n\n<pre><code>     2012-11-02 16:14:59.888\n     Uncaught exception from servlet\n     java.lang.UnsupportedClassVersionError: \n     com/layout/server/EntityServiceImpl :                \n     Unsupported major.minor version 51.0\n</code></pre>\n\n<p>My App Engine log gave the following error, which is not database related. I've been using JRE 7 which appearantly is not compatible with GAE. ( appengine.google.com -> log ).</p>\n\n<p>I'm trying to use JDK6 now and see what happens :)</p>\n\n<p>This was the problem, changed to JDK 6 and everything is solved now. Had nothing to do with my database. Just the Java Version.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13201715,"title":"Convert only the year part of the datetime in SQL server","body":"<p>Any other easier way to bring the year part of a datetime to current year? If not, which one is better performance wise?</p>\n\n<p>Attempt #1:</p>\n\n<pre><code>CAST(DATEPART(MONTH, mydate) AS VARCHAR) + '/' + \nCAST(DATEPART(DAY, mydate) AS VARCHAR) + '/' +\nCAST(YEAR(GETDATE()) AS VARCHAR) AS DATETIME \n</code></pre>\n\n<p>Attempt #2:</p>\n\n<pre><code>DATEADD(YEAR, DATEDIFF(YEAR,  mydate, GETDATE()), mydate)\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13197867,"title":"Find duplicate values over multiple databases","body":"<p>I'm trying to find a way to find duplicate email addresses in a table over multiple DB's.  I have 30 DB's, all with a \"Users\" table with identical fields (each DB is a different customer of ours).  I need to go through each DB, get the email address from this table, then search the current, and all other DB's for this email address.  If it exists, write out the record, if not, move on to the next user record and repeat.  Here's what I've got so far, but I'm stuck.  I think I have to create a cursor inside another cursor but don't know if it can be done dynamically:</p>\n\n<pre><code>DECLARE @DBName varchar(20)\nDECLARE @sSQL      varchar(2000)\n\nDECLARE LoopCursor CURSOR FOR\n    SELECT DBName\n    FROM Configuration\n\n    OPEN LoopCursor\n\n    FETCH NEXT FROM LoopCursor\n    INTO @DBName\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        SET @sSQL = '\n            Select EmailAddress\n            FROM ' + @DBName + '.dbo.Users'\n\n        --Not to sure what to do from here??\n\n        EXEC(@sSQL)\n\n        FETCH NEXT FROM LoopCursor\n        INTO @DBName\n    END\n\n    CLOSE LoopCursor\nDEALLOCATE LoopCursor\n\nSELECT 'DONE'\n</code></pre>\n\n<p>We are using SQL Server 2008 R2 btw.</p>\n"},{"tags":["sql","sql-server","int","guid","identifier"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":41,"score":-4,"question_id":13201183,"title":"ints or guids for table identifiers","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4557422/sql-primary-key-int-or-guid-or\">SQL primary key, INT or GUID or..?</a>  </p>\n</blockquote>\n\n\n\n<p>What is the best practise for using unique identifiers in sql server tables?</p>\n\n<p>I have seen articles regarding using guid's or int's with pros and cons for each. </p>\n\n<p>I am looking to go with the following principal, for external identifiers, guid's should be used but for internal identifiers, it best to go with int's. </p>\n\n<p>I am looking for feedback on this principal and guidelines as to the best approach.</p>\n"},{"tags":["sql","view","plsql","column"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13200547,"title":"Checking for the existence of a column in a view before searching for a value","body":"<p>I am trying to search every view in the database for a specific value of something like '%THIS%'</p>\n\n<p>I came up with this plsql code</p>\n\n<pre><code>DECLARE\n  match_count INTEGER;\nBEGIN\n  FOR t IN (SELECT name FROM user_dependencies where type = 'VIEW') LOOP\n\n    EXECUTE IMMEDIATE \n    'SELECT COUNT(*) FROM '|| t.name || ' Where Column_Name LIKE ''%THIS%'' '\n    INTO match_count;\n\n    IF match_count &gt; 0 THEN\n      dbms_output.put_line( t.name ||' '||match_count );\n    END IF;\n\n  END LOOP;\nEND;\n</code></pre>\n\n<p>But when I try to run it, I get an invalid identifier error for the column name in the execute immeadiate query. </p>\n\n<p>The problem to me is obvious that not every view has the Column_Name, but I can't figure out how I can check to see if the column exists before running the query as I loop through all of the views.</p>\n\n<p>I was also able to use a slightly modified version of this to run through all of the tables, and while they do not all have that column, I did not run in to this issue.</p>\n\n<p>Edit: I am including the plsql code that I was able to use to loop through the tables.</p>\n\n<pre><code>DECLARE\n  match_count INTEGER;\nBEGIN\n  FOR t IN (SELECT table_name, column_name FROM all_tab_columns \n            where table_name LIKE 'THIS%' and data_type = 'VARCHAR2' AND column_name = 'Column_name') LOOP\n\n    EXECUTE IMMEDIATE \n    'SELECT COUNT(*) FROM '||t.table_name || ' Where Column_name LIKE ''%THIS%'' '\n    INTO match_count;\n\n    IF match_count &gt; 0 THEN\n      dbms_output.put_line( t.table_name ||' '||t.column_name||' '||match_count );\n    END IF;\n\n  END LOOP;\nEND;\n</code></pre>\n"},{"tags":["java","sql","sql-server","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":79,"score":5,"question_id":13195935,"title":"Determine if an sql query modifies the database","body":"<p>I have a list of strings that contain valid <code>SQL</code> expressions.<br>\nI need to execute only those that do not modify the database.<br>\nWhat would be the best way to do this? Just doing something like:  </p>\n\n<pre><code>if(sqlQuery.contains(\"DELETE\")){  \n  //don't execute this\n}\n</code></pre>\n\n<p>seems like a bad hack  </p>\n\n<p><strong>Update:</strong><br>\nI'll make this more specific.<br>\nI already have a list of <code>SQL</code> queries that are allowed. I want to make sure only these are executed.<br>\nWhat would be the best way to match against these?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13200627,"title":"sql server external tools logging errorlog","body":"<p>In SQL Server 2008 I installed some external tools and then removed them.  Somehow I am getting this error in the error logs.  How can I remove this queue?</p>\n\n<pre><code>The activated proc '[LakeSideLockLogger].[_LakeSide_DbTools_LockMonitorEvents]' running on queue 'msdb.LakeSideLockLogger._LakeSide_DbTools_LockQueue' output the following:  'Could not find stored procedure 'LakeSideLockLogger._LakeSide_DbTools_LockMonitorEvents'.'\n</code></pre>\n"},{"tags":["php","javascript","jquery","sql","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13200690,"title":"Paginate records","body":"<p>I am generating records through PHP/SQL. The code displays 5 records. I'm trying to program so that when the next button is pressed, the next 5 records will show.</p>\n\n<p>The code:</p>\n\n<pre><code>function show(qstring,qtype)\n{\n $(\"#vsdiv\").show();\n var myurl=\"scripts/searchpage.php\"; \n $.ajax({url: myurl, \n         dataType:'json',  \n         data:{querystring:qstring,querytype:qtype},\n         success: function(member)\n         {\n            $(\"#results\").append('&lt;tr class=\"me\"&gt;'+'&lt;th&gt;#REC&lt;/th&gt; &lt;th&gt;name&lt;/th&gt;&lt;th&gt;surname&lt;/th&gt;');\n            var j=0;\n            var totrecs=1;\n            for(var i=0;i&lt;5;i++)\n            {\n                $(\"#results\").append('&lt;tr class=\"rows'+j+'\"&gt;'+'\n                                      &lt;td class=\"ids\" id=\"z'+i+'\"&gt;'+totrecs+'&lt;/td&gt;'+'\n                                      &lt;td&gt;'+name[i].bdate+'&lt;/td&gt;'+'\n                                      &lt;td class=\"users\" id=\"username'+i+'\"&gt;'+member[i].username+'&lt;/td&gt;'+'\n                                      &lt;td id=\"contact'+i+'\"&gt;'+member[i].fname+' '+member[i].lname+'&lt;/td&gt;'+'\n                                      &lt;td&gt;&lt;input type=\"checkbox\" name=\"whome\" id=\"showMe'+i+'\"'+'\n                                      class=\"boxes\" onclick=\"getMe('+i+')\" /&gt;&lt;/td&gt;&lt;/tr&gt;');  \n                totrecs++;\n                j++;\n            }\n         }\n       });\n}\n</code></pre>\n\n<p>And for the HTML button:</p>\n\n<pre><code>&lt;input type=\"button\" id=\"next5\" title=\"Next 5 Records\" disabled=\"disabled\" value=\"Next 5&gt;&gt;\" /&gt;\n</code></pre>\n"},{"tags":["sql","ssis","data-warehouse","dimensions","lookup-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13200869,"title":"SSIS Lookup multiple dates in my fact table, how to pull this off using one date dimension?","body":"<p>In my SSIS/DW project, I have a DIM.DATE dimension which is linked to my FACT table by a surrogate key as follows:</p>\n\n<pre><code>ALTER TABLE FACT.SALES ADD date_id INT NOT NULL\nALTER TABLE FACT.SALES WITH CHECK ADD CONSTRAINT FK_dim_date FOREIGN KEY (date_id) REFERENCES DIM.DATE(date_id)\n</code></pre>\n\n<p>This creates a \"date_id\" in my fact table, now during my SSIS import process I have a date column being passed (shipped_date), I use this to look up the DIM.DATE table and pass in the surrogate key in my dimension.</p>\n\n<p>This works great, but now I need to have a few different date dimensions for invoice date, received date, etc.</p>\n\n<p>I am confused as to how to make use of the existing DIM.DATE to do this?</p>\n\n<p>I could then add more columns into my fact table..</p>\n\n<pre><code>-- add column into fact table\nALTER TABLE FACT.SALES ADD shipped_date_id INT NOT NULL\nALTER TABLE FACT.SALES ADD invoice_date_id INT NOT NULL\n\n-- add foreign key\nALTER TABLE FACT.SALES WITH CHECK ADD CONSTRAINT FK_shipped_date FOREIGN KEY (shipped_date_id) REFERENCES DIM.DATE(date_id)\nALTER TABLE FACT.SALES WITH CHECK ADD CONSTRAINT FK_invoice_date FOREIGN KEY (invoice_date_id) REFERENCES DIM.DATE(date_id)\n</code></pre>\n\n<p>But when I do my lookup, I can only pass in the \"date_id\" column.. I am confused how to make this work all together.</p>\n\n<p>Anyone able to clear this up for me?<img src=\"http://i.stack.imgur.com/qDzpr.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":5,"up_vote_count":46,"down_vote_count":0,"view_count":101154,"score":46,"question_id":336268,"title":"SQL - Difference between Select Unique and Select Distinct","body":"<p>I thought these were synonomous, but I wrote the following in Microsoft SQL:</p>\n\n<pre><code>Select Unique col from \n     (select col from table1 union select col from table2) alias\n</code></pre>\n\n<p>And it failed.  Changing it to </p>\n\n<pre><code>Select Distinct col from \n     (select col from table1 union select col from table2) alias\n</code></pre>\n\n<p>fixed it.  Can someone explain?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2000"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13200024,"title":"SQL Server 2008 upgrade advisor tool","body":"<p>We upgraded to SQL Server 2008 from SQL Server 2000. But due to some legacy scripts/queries in our health care application, that run only in 2000, we had to run 2008 version on backwards compatibility mode. </p>\n\n<p>My question is what do I need to be aware of if I have to turn it on to full compatibility mode in terms of potential conflicts/issues etc. Is the Upgrade Advisor tool still useful in my case as we already upgraded but running in backwards compatibility mode. Is there value in running that tool? </p>\n\n<p>Any other information any one can share , will be useful. </p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13200609,"title":"How get around the arithmetic overflow error converting expression to data type int?","body":"<p>I have the following query:</p>\n\n<pre><code>-- CTE to remove outliers, e.g. remove the fastest and slowest results\n;WITH MinMaxCTE AS \n(\n  SELECT ServerName, CONVERT(VARCHAR(10), UpdatedOn, 101) AS [Date], Version, \n    MIN(JaguarStartupTime) AS MinStartTime, MAX(JaguarStartupTime) AS MaxStartTime\n  FROM dbo.MachineConfiguration (NOLOCK)\n  WHERE DomainLogin NOT IN (SELECT DomainLogin FROM dbo.SupportGroup)\n  GROUP BY ServerName, CONVERT(VARCHAR(10), UpdatedOn, 101), Version\n)\n\nSELECT  AVG(mc.JaguarStartupTime) AS AverageTime\n    , COUNT(*) AS NumEntries\n    , mc.Version\nFROM    #Eligible mc (NOLOCK)\nJOIN MinMaxCTE cte ON mc.ServerName = cte.ServerName \n  AND CONVERT(VARCHAR(10), mc.UpdatedOn, 101) = cte.[Date] \n  AND mc.Version = cte.Version \n  AND mc.JaguarStartupTime &lt;&gt; cte.MinStartTime \n  AND mc.JaguarStartupTime &lt;&gt; cte.MaxStartTime\nGROUP BY mc.Version\nORDER BY Version DESC, AVG(mc.JaguarStartupTime) ASC\n</code></pre>\n\n<p>The definition of the #Eligible temp table is </p>\n\n<pre><code>create table #Eligible (\n    Version nvarchar(50), JaguarStartupTime int, \n    ServerName nvarchar(50), UpdatedOn datetime )\n</code></pre>\n\n<p>No matter what condition or aggregation I comment out, I always get the following error: <code>Arithmetic overflow error converting expression to data type int</code>.</p>\n\n<p>Where can I go from here?  How do I debug this further?</p>\n\n<p>EDIT: Sample data</p>\n\n<pre><code>Version JaguarStartupTime    ServerName     UpdatedOn\n6.4.6.082      16040         NewOrleansLA   2012-08-08 12:34:12.330\n6.5.1.012      40390         BatonRougeLA   2012-08-08 18:33:17.440\n6.5.1.012      48379         HonoluluHI     2012-08-09 04:42:50.453\n</code></pre>\n"},{"tags":["sql","sql-server-2008","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13200511,"title":"How to Generate Scripts For All Triggers in Database Using Microsoft SQL Server Management Studio","body":"<p>I'd like to generate an SQL Script that contains the SQL to create all of the triggers that exist in our database.  The triggers were added directly via the SSMS query pane so, there is currently no source other than the trigger on the database itself.  </p>\n\n<p>I have already tried the method where you right-click the database, select <code>Tasks-&gt;Generate Scripts</code> and used the \"Script Entire Database and All Objects\" option.  While this does create a SQL script for the tables and constraints, it does not generate SQL for the triggers.  </p>\n\n<p>I also understand that I can right click on each trigger in the database and select the Generate SQL Script option but, there is currently 46 tables under audit (For Insert, Update, and Delete).  </p>\n\n<p>Rather manually generate an insert, update, and delete trigger script for each of the 46 tables, is there an easier way to do this?  Or, should I start clicking, copying, and pasting?</p>\n"},{"tags":["c#","sql","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":71,"score":6,"question_id":13198639,"title":"Can I artificially restrict a user's sql permissions to be read only for any connections from my application?","body":"<p>I'm having an issue regarding the security of an application that I'm building... It's a wrapper for a crystal report viewer that provides users with some additional functionality.</p>\n\n<p>There are many internal users with the ability to create/modify Crystal Reports. I've done some tests, and for an application that deals so intimately with connecting to various data sources, it doesn't seem to care the least bit about doing so safely. There is nothing stopping me from modifying an existing crystal report that everyone trusts to make it into something malicious and harmful. All it takes is an added command table with the following sql:</p>\n\n<pre><code>DELETE FROM tbl_Employees; SELECT FROM tbl_Employees;\n</code></pre>\n\n<p>In fact, you can do anything in a crystal report that the user has permissions to do... so long as it ends with a select. Which leads me to my question: Is there any way for me to ensure that my application limits any connections to our sql server to just selects? I can't temporarily modify user credentials, and I can't use a single read only account because I still need to limit the user to their normal permissions (i.e. which databases they can query).</p>\n\n<p>I'm not very hopeful, as nothing that I've read has led me to believe that I can restrict connections in such a manner.</p>\n\n<p>On the other hand, most of the people making the reports could take a much more direct approach to destroying our data, if they were so inclined... but I hardly think that that is a good excuse not to do my best to ensure that my application is as safe as I can make it. I just can't seem to find any viable answers.</p>\n"}]}
{"total":102599,"page":13,"pagesize":100,"questions":[{"tags":["php","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":13199855,"title":"Using A PHP variable within An SQL statement","body":"<p>I am very new to PHP and SQL... \nI cant get variables used within my SQL code to be recognised ?</p>\n\n<p>here is the full code, i am trying to populate a database table with answer to questions answered from a html page</p>\n\n<p>any help please?</p>\n\n<pre><code>&lt;?php\n\n$odbc = mysql_connect ('localhost', 'root', '') or die (\"Could not connect to database\");\nmysql_select_db('Questionaire', $odbc) or die (\"can not find database\");\n\n$sql;\n$quantity = 1;\n\n$id = 222;\n$r = 1;\n$course = '555';\n\n\n\nfor ($i = 1; $i &lt; $quantity; $i++)\n{   \n$answer = $_POST['q'.$r];\n\nif ($answer == 'a')\n{\n    $sql = \"INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES (\".$id.\", \".$i.\",       '1', '0', '0',  '0', '0', '')\";                         \n}\n\nif ($answer == 'b')\n{\n    $sql = 'INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES ('.$id.', '.$i.',               \"0\", \"1\", \"0\",  \"0\", \"0\", \"\")'; \n    echo'&lt;h2&gt; hello &lt;/h2&gt;'; \n    $result = mysql_query($sql,$odbc) or die (\"can not run query\");                 \n}\n\nif ($answer == 'c')\n{\n    $sql = \"INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES (\".$id.\", \".$i.\",       '0', '0', '1',  '0', '0', '')\";     echo $sql;                  \n}\n\nif ($answer == 'd')\n{\n    $sql = \"INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES (\".$id.\", \".$i.\", '0', '0', '0', '1', '0', '');\";                           \n}\n\n$r++;\n\n}\n\n\n\n?&gt;\n</code></pre>\n"},{"tags":["php","sql","mvc","relational-database","models"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13200282,"title":"The best way to organize MVC Model without using ORM?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5863870/how-should-a-model-be-structured-in-mvc\">How should a model be structured in MVC?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm playing around with my own little MVC framework. Until now I was using Doctrine for Object Relation Mapping and this was nice. At first it looked as the best way to setup your MVC. The way I was using it was something like this, I had folder Application/Model and this is where I would put all of the Model files, like Doctrine Entities, Services that would do some global tasks, validators etc... So Model was a folder where all of the meat of the MVC application would go. And then I would register Model folder as library with SPL Class loader and I was able to get any entity like this:</p>\n\n<pre><code>$users = new \\Application\\Model\\Entity\\User();\n</code></pre>\n\n<p>Now I decided to not use ORM since I dont really like it anymore, I wont talk about why but lets just say I want to use raw SQL instead of ORM. Now the question is what would be a proper way to organize my folder structure to achieve this?</p>\n\n<p>I'm thinking about creating new folder Tables in Model folder so I can have something like this: Application\\Model\\Tables\\User.php , and from that PHP file I can access all the actions on User table, like update, get, insert etc...</p>\n\n<p>Now the question is how would I organize my Model folder to use RDMS but without using ORM?\nSince Model is a layer, and Model should have Domain Objects and Data Mappers. Domain objects are objects representing current application Domain objects and Mappers would persist those Domain objects. How could I organize this to use raw SQL, but without ORM, and without building my own ORM?</p>\n\n<p>Is there any good framework that dosent use ORM or Active Record pettern so I could explore his code to see how are they doing this?</p>\n"},{"tags":["sql","sql-server","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12516357,"title":"Transposing data into multiple columns","body":"<p>I have numbers of clients and each client has 67 records. </p>\n\n<p>The record contains Activities, Dates, IDs, flags and many other columns. </p>\n\n<p>I would like the Activities names to be the headings and Dates underneath to those Activity headings. </p>\n\n<p>I am trying to explain it more using the tables below. This is the current output:</p>\n\n<pre><code>Client  Activity    Date \n1       A           21/15\n1       B           5/5/2012\n1       C           51/3115\n1       D           54/6/84\n2       A           8/6/99\n2       B           1/1/2011\n2       C           8/4\n2       D           9/81/1\n3       A           6/51/8\n3       B           1/61/8\n3       C           1/31\n3       D           3/2/1\n</code></pre>\n\n<p>And I would like it to be:</p>\n\n<pre><code>Client      A       B         C         D\n1           21/15   5/5/2012  51/31/15  54/6/84\n2           8/6/99  1/1/2011  8/4       9/81/1\n3           6/51/8  1/61/8    1/31      3/2/1\n</code></pre>\n"},{"tags":["sql","sql-server","pivot","sql-server-2012","pivot-without-aggregate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":12387548,"title":"Query to show customers and their contacts in columns side by side","body":"<p>I am trying to figure it out if it's possible to achieve something having this tables as example...</p>\n\n<pre><code>CustomersTable\n Id  | Name | Address\n  1  | John | Street A\n  2  | Paul | Street B\n  3  | Mary | Street C\n\nContactsTable\n Id  | CustomerId | ContactName | Contact\n  1  |     1      |  Contact A  |   123\n  2  |     1      |  Contact B  |   543\n  3  |     2      |  Contact 1  |   678\n  4  |     3      |  Contact A1 |   980\n  5  |     3      |  Contact B2 |   521\n</code></pre>\n\n<p>And get something like this...</p>\n\n<pre><code> Id  |  Name  |  Address   | ContactId_1 | ContactName_1 | Contact_1 | ContactId_2 | ContactName_2 | Contact_2\n  1  |  John  |  Street A  |      1      |   Contact A   |    123    |      2      |   Contact B   |    543\n  2  |  Paul  |  Street B  |      3      |   Contact 1   |    678    |     NULL    |     NULL      |    NULL\n  3  |  Mary  |  Street C  |      4      |   Contact A1  |    980    |      5      |   Contact B2  |    521\n</code></pre>\n\n<p>The idea is to get a table where the contacts are side by side of each customer where it belongs. And the contact columns contacts will depend of course on the number of contacts of each customer.</p>\n\n<p>This can be done? How?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["mysql","sql","pivot","pivot-without-aggregate"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":12382771,"title":"mysql pivot/crosstab query","body":"<p><strong>Question 1:</strong> I have a table with the below structure and data:</p>\n\n<pre><code>app_id  transaction_id  mobile_no   node_id  customer_attribute  entered_value \n100     111             9999999999  1        Q1                  2                             \n100     111             9999999999  2        Q2                  1                             \n100     111             9999999999  3        Q3                  4                             \n100     111             9999999999  4        Q4                  3                             \n100     111             9999999999  5        Q5                  2                             \n100     222             8888888888  4        Q4                  1                             \n100     222             8888888888  3        Q3                  2                             \n100     222             8888888888  2        Q2                  1                             \n100     222             8888888888  1        Q1                  3                             \n100     222             8888888888  5        Q5                  4                             \n</code></pre>\n\n<p>I want to display these records in the below format:</p>\n\n<pre><code>app_id  |  transaction_id  | mobile     |  Q1  |  Q2  |  Q3  |  Q4 |  Q5  |\n 100    |      111         | 9999999999 |   2  |   1  |   4  |  3  |  2   |\n 100    |      222         | 8888888888 |   3  |   1  |   2  |  1  |  4   |\n</code></pre>\n\n<p>I know I need to use crosstab/pivot query to get this display. For this I tried it based on the limited knowledge that I have about it. Following is my query:</p>\n\n<pre><code>SELECT app_id, transaction_id, mobile_no,\n  (CASE node_id WHEN 1 THEN entered_value ELSE '' END) AS user_input1,\n  (CASE node_id WHEN 2 THEN entered_value ELSE '' END) AS user_input2,\n  (CASE node_id WHEN 3 THEN entered_value ELSE '' END) AS user_input3,\n  (CASE node_id WHEN 4 THEN entered_value ELSE '' END) AS user_input4,\n  (CASE node_id WHEN 5 THEN entered_value ELSE '' END) AS user_input5\nFROM trn_user_log \nGROUP BY app_id, transaction_id, mobile_no, node_id\n</code></pre>\n\n<p>And based on this query I got the below display:</p>\n\n<pre><code>app_id  transaction_id  mobile_no   user_input1  user_input2  user_input3  user_input4  user_input5  \n100     111             9999999999  2                                                                \n100     111             9999999999               1                                                   \n100     111             9999999999                            4                                      \n100     111             9999999999                                         3                         \n100     111             9999999999                                                      2            \n100     222             8888888888  3                                                                \n100     222             8888888888               1                                                   \n100     222             8888888888                            2                                      \n100     222             8888888888                                         1                         \n100     222             8888888888                                                      4            \n</code></pre>\n\n<p>Can anyone help me with the proper changes that I need to make to my query to get the records in one single row and not multiple rows as above.</p>\n\n<p><strong>Question 2:</strong> Also is there a way to get the value of a particular field as the NAME of the column. As you can see above I have <code>user_input1</code>, <code>user_input2</code>,... as the header. Instead of that I want to have the values in <code>customer_attribute</code> as the header of the columns. </p>\n\n<p>For this I checked <code>NAME_CONST(name,value)</code> as below:</p>\n\n<pre><code>SELECT app_id, transaction_id, mobile_no,\nNAME_CONST(customer_attribute, (CASE node_id WHEN 1 THEN entered_value ELSE '' END))\nFROM trn_user_log \n</code></pre>\n\n<p>But it gives an error </p>\n\n<pre><code>Error Code : 1210 Incorrect arguments to NAME_CONST\n</code></pre>\n\n<p>Help required.</p>\n"},{"tags":["sql","sql-server","sql-server-2008-r2","pivot","pivot-without-aggregate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":12514192,"title":"SQL: Turn a row into a column (and include column names in a new column)","body":"<p>I'm busy writing a claims provider class to be used in a Security Token Service.</p>\n\n<p>User permissions are read from a SQL Server 2008 R2 database:</p>\n\n<pre><code>SELECT A, B, C, ..., X FROM Permissions WHERE UserId = @UserId\n</code></pre>\n\n<p>would give me a single row, for example: </p>\n\n<pre><code>A B C ... X\n1 0 1     1\n</code></pre>\n\n<p>it would be much easier to have this data in the form</p>\n\n<pre><code>Permission Value\nA          1\nB          0\nC          1\n...\nX          1\n</code></pre>\n\n<p>Since the actual table contains dozens of columns, I'd prefer to be able to do the transposition \"dynamically\" without really having to type up any column names by hand.</p>\n\n<p>It feels like the PIVOT/UNPIVOT functions and INFORMATION_SCHEMA.COLUMNS view are what I need, but I can't quite figure out what to do.</p>\n\n<p>Any ideas for a query that would do this?</p>\n\n<p>PS. I guess if push comes to shove, I'd just stick the result set in a DataTable and iterate over the columns in code to generate the user claims, but I'd like to find out if the above approach is possible first :)</p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12505079,"title":"Write advanced SQL Select","body":"<p>Item table:</p>\n\n<pre><code>|   Item    |   Qnty    |   ProdSched   |\n|    a      |    1      |       1       |\n|    b      |    2      |       1       |\n|    c      |    3      |       1       |\n|    a      |    4      |       2       |\n|    b      |    5      |       2       |\n|    c      |    6      |       2       |\n</code></pre>\n\n<p>Is there a way I can output it like this using SQL <code>SELECT</code>?</p>\n\n<pre><code>|   Item    |   ProdSched(1)(Qnty)  |   ProdSched(2)(Qnty)  |\n|    a      |           1           |       4               |\n|    b      |           2           |       5               |\n|    c      |           3           |       6               |\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13198079,"title":"how to rewrite the query to make it faster and sql compliant","body":"<p>This query:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        GROUP_CONCAT( DISTINCT t1.value SEPARATOR '|' ) AS 'Colors', GROUP_CONCAT( DISTINCT t2.value SEPARATOR '|' ) AS 'Languages'\nFROM `subscribers`\nLEFT JOIN `subscribers_multivalued` AS `t1` ON subscribers.subscriber_id = t1.subscriber_id AND t1.field_id = 112\nLEFT JOIN `subscribers_multivalued` AS `t2` ON subscribers.subscriber_id = t2.subscriber_id AND t2.field_id = 111\nWHERE (list_id = 40) AND (state = 1)\nGROUP BY `subscribers`.`email_address` , `subscribers`.`first_name` , `subscribers`.`last_name`\n</code></pre>\n\n<p>With execute plan:</p>\n\n<pre><code>id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n1   SIMPLE  subscribers     ref     FK_list_id,state_date_added     FK_list_id  4   const   1753610     Using where; Using filesort\n1   SIMPLE  t1  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n1   SIMPLE  t2  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n</code></pre>\n\n<p>Caused error for uknown reason: General error: 3 Error writing file '/tmp/MYzamaNT' (Errcode: 28) in mysql.</p>\n\n<p>I rewrote it like this groupy by subscriber_id insead:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        GROUP_CONCAT( DISTINCT t1.value SEPARATOR '|' ) AS 'Colors', GROUP_CONCAT( DISTINCT t2.value SEPARATOR '|' ) AS 'Languages'\nFROM `subscribers`\nLEFT JOIN `subscribers_multivalued` AS `t1` ON subscribers.subscriber_id = t1.subscriber_id AND t1.field_id = 112\nLEFT JOIN `subscribers_multivalued` AS `t2` ON subscribers.subscriber_id = t2.subscriber_id AND t2.field_id = 111\nWHERE (list_id = 40) AND (state = 1)\nGROUP BY `subscribers`.`subscriber_id`\n</code></pre>\n\n<p>The plan of this query is better (not filesort):</p>\n\n<pre><code>id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n1   SIMPLE  subscribers     ref     FK_list_id,state_date_added     FK_list_id  4   const   1753610     Using where\n1   SIMPLE  t1  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n1   SIMPLE  t2  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1   \n</code></pre>\n\n<p>It seems that it works in mysql and it much faster that previous query.\nAlthough it works in mysql it's not compliant sql standard there shouldn't be aggregated fields in fields' list that are not present in GROUP BY. I there a way to make the query as fast as the last one and make it sql compliant?</p>\n\n<p>I tried to rewrite it this way too:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        t1.colors AS 'Colors', t2.languages AS 'Languages'\nFROM `subscribers`\nLEFT JOIN (SELECT subscriber_id, GROUP_CONCAT( DISTINCT value SEPARATOR '|' ) AS 'colors'\n           FROM subscribers_multivalued\n           WHERE field_id = 112\n           GROUP BY subscriber_id)  t1 ON t1.subscriber_id = `subscribers`.`subscriber_id`\nLEFT JOIN (SELECT subscriber_id, GROUP_CONCAT( DISTINCT value SEPARATOR '|' ) AS 'languages'\n           FROM subscribers_multivalued\n           WHERE field_id = 111\n           GROUP BY subscriber_id)  t2 ON t2.subscriber_id = `subscribers`.`subscriber_id`         \n</code></pre>\n\n<p>The plan of this query is much worse:</p>\n\n<pre><code>1   PRIMARY     subscribers     ALL     NULL    NULL    NULL    NULL    23358546     \n1   PRIMARY     &lt;derived2&gt;  ALL     NULL    NULL    NULL    NULL    900000   \n1   PRIMARY     &lt;derived3&gt;  ALL     NULL    NULL    NULL    NULL    900000   \n3   DERIVED     subscribers_multivalued     ALL     field_fk    field_fk    4       20621115    Using filesort\n2   DERIVED     subscribers_multivalued     ALL     field_fk    field_fk    4       20621115    Using filesort\n</code></pre>\n\n<p>and I couldn't wait untill it  returns data;</p>\n"},{"tags":["sql","select","group","aggregate","greatest-n-per-group"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13199601,"title":"SQL GROUP BY - also SELECT not-constant columns","body":"<p>can someone please help me with this query?\nI have 2 tables in my database:</p>\n\n<pre><code>log_visitors:\n--------------------\nid | host_id\n\n\nlog_access:\n--------------------\nvisitor | document | timestamp\n</code></pre>\n\n<p>\"log_access.visitor\" links to \"log_visitors.id\"</p>\n\n<p>Currently, I'm using this query:</p>\n\n<pre><code>SELECT\n    log_visitors.host_id\n    , MIM(log_access.timestamp) AS min_timestamp\nFROM\n    log_access\n    INNER JOIN log_visitors\n        ON (log_access.visitor = log_visitors.id)\nGROUP BY log_visitors.host_id;\n</code></pre>\n\n<p>to get \"MIN(timestamp)\" for each \"host_id\" in the database.</p>\n\n<p>HERE'S MY QUESTION:</p>\n\n<p>I also need to get \"document\" for that access with that timestamp... I can't simply add \"log_access.document\" into SELECT list, since it's not constant and I am not grouping by document...\nAny ideas?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13187456,"title":"Oracle SQL Developer — separate time and date","body":"<p>I have a question with Oracle SQL Developer (I've installed Oracle 11g Express Edition).\nI want to insert values for 'date' and 'time', but I cannot separate them.</p>\n\n<pre><code>create table Match \n(\n    numMatch number(2) constraint PKMatch primary key,\n    dateM date, \n    heureM date,\n    numE_Eq number(2),\n    numE_Eq2 number(2),\n    nomTerrain varchar2(30)\n);\n</code></pre>\n\n<p>--\"tools\"=>\"preferences\"=>\"format de date:DD/MM/YYYY  HH24:MI:SS\"</p>\n\n<pre><code>insert into Match values (1,to_date\n('10/12/2010','DD/MM/YYYY'),to_date('15:00:00','HH24:MI:SS'),1,3,'Stade Argentina'\n);\n</code></pre>\n\n<p><em><strong>result:</em></strong></p>\n\n<pre><code>dateM: 10/12/2010 00:00:00\n\nheureM: 01/11/2012 15:00:00\n</code></pre>\n\n<p>PS: I've tried to_char instead of to_date, but it didn't work at all.</p>\n\n<hr>\n\n<p>thanks a lot for the responses.\nyes, i'm aware of that 'DATE datatype contains both date and time', but it's the prof who insists showing date and time seprately in the table,\nand i've seen your solutions before, but for me, it's a query, not to 'insert values' in the table.\nso i'd like to know how can i be able to have a table directly presente date and time.\nthanks again.</p>\n"},{"tags":["sql","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":21,"score":0,"question_id":13186039,"title":"nested cursor, code won't update table outside of cursors","body":"<p>I am working on this nested cursor. My update statement in the major_cursor is not updating the table. I know that all the looping is working because the print statements print what expect, but nothing is updating in edu_suffix_stage_test. I am hoping some one has a suggestion!</p>\n\n<p>For each id, there is row of data for a major, and the year that degree was obtained. I need to string them together.</p>\n\n<p>For example REID 10013 has two records for two degrees:</p>\n\n<p>Civil Engineering in '38, \nand Civil Engineering in '41.</p>\n\n<p>I need to build the edusuffix so it is equal to \"Civil Engineering'38, Civil Engineering in '41\".\nI need one edusuffix per reid in the end, in edu_suffix_stage_test.</p>\n\n<p>Thanks.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>DECLARE @reid_outside nvarchar(20), @major nvarchar(50), @classof nvarchar(5),\n @edusuffix_inside varchar(80), @note nvarchar(50), @reid_inside nvarchar(20),\n@edusuffix_outside varchar(80)\n\n\nDECLARE education_cursor CURSOR FOR \nSELECT  reid, edusuffix\nFROM edu_suffix_stage_test\nwhere reid &lt; 1005\n--ORDER BY reid\n\nOPEN education_cursor\n\nFETCH NEXT FROM education_cursor \nINTO @reid_outside, @edusuffix_outside\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n\n    SELECT @note = 'building edusuffix for ' \n    PRINT @note\n    PRINT @reid_outside\n\n    -- Declare an inner cursor based   \n    -- on reid from the outer cursor.\n\n    DECLARE major_cursor CURSOR FOR \n    SELECT v.reid, \n    v.EduMajor, v.EduClassOF\n    FROM  re_education v\n   WHERE v.REID = @reid_outside  -- Variable value from the outer cursor \n--order by v.REID \nFOR UPDATE of edusuffix\n\n\n    OPEN major_cursor\n    FETCH NEXT FROM major_cursor INTO @reid_inside, @major, @classof\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n\n        SELECT @edusuffix_inside = @major +' '+ @classof +', '\n        PRINT @edusuffix_inside\n\n    update edu_suffix_stage_test\n    set edusuffix = case when @edusuffix_outside = null then ''+ @edusuffix_inside \n            else @edusuffix_outside + ', '+@edusuffix_inside end\n    from edu_suffix_stage_test a\nwhere  -- a.reid = @reid_inside\ncurrent of education_cursor\nPrint ' updated edusuffix'\n\n        FETCH NEXT FROM major_cursor INTO @reid_inside, @major, @classof\n        END\n\n    CLOSE major_cursor\n    DEALLOCATE major_cursor\n\n    FETCH NEXT FROM education_cursor \n    INTO @reid_outside, @edusuffix_outside\nEND \nCLOSE education_cursor\nDEALLOCATE education_cursor\n</code></pre>\n"},{"tags":["mysql","sql","count","auto-increment"],"answer_count":10,"favorite_count":9,"up_vote_count":25,"down_vote_count":1,"view_count":50859,"score":24,"question_id":933565,"title":"Get Auto Increment value with MySQL query","body":"<p>I currently have a database with over 6 million rows and growing.  I currently do SELECT COUNT(id) FROM table; in order to display the number to my users, but the database is getting large and I have no need to store all of those rows except to be able to show the number.  Is there a way to select the auto_increment value to display so that I can clear out most of the rows in the database?  Using <code>LAST_INSERT_ID()</code> doesn't seem to work.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13199425,"title":"Multiple conditions on select query","body":"<p>I have a select statement and I wish to calculate the cubic volume based on other values within the table. However I want to check that neither pr.Length_mm or pr.Width_mm or pr.Height_mm are NULL prior. I've looked at CASE statements, however it only seems to evaluate one column at a time.</p>\n\n<pre><code>SELECT \n      sa.OrderName,\n      sa.OrderType,\n      pr.Volume_UOM\n ,pr.Length_mm*pr.Width_mm*pr.Height_mm AS Volume_Cubic\n ,pr.Length_mm*pr.Width_mm AS Volume_Floor\n ,pr.Length_mm\n ,pr.Height_mm\n ,pr.Width_mm\nFROM CostToServe_MCB.staging.Sale sa\nLEFT JOIN staging.Product pr\nON sa.ID = pr.ID\n</code></pre>\n"},{"tags":["sql","oracle","oracle11g","sql-developer"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2751,"score":4,"question_id":8842577,"title":"How to increase buffer size in Oracle SQL Developer to view all records?","body":"<p>How to increase buffer size in Oracle SQL Developer to view all records (there seems to be a certain limit set at default)? Any screen shots and/or tips will be very helpful.</p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13199422,"title":"How can I return several text fields with the same ID number in one row in SQL server?","body":"<p>I have table:</p>\n\n<pre><code>    ID   Note\n1   1    aaa\n2   1    bbb\n3   1    ccc\n4   2    ddd\n5   2    eee\n6   2    fff\n</code></pre>\n\n<p>I need to return it as:</p>\n\n<pre><code>   ID   Note1   Note2   Note3\n1  1    aaa     bbb     ccc\n2  2    ddd     eee     fff\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13199120,"title":"Export SQL data to Excel","body":"<p>I have a webpage requesting data data from an SQL database. I am using the sqldrv. I converted this code which was using the old mssql driver. but be aware I AM NOT A PROGRAMMER....  </p>\n\n<p>This data is then posted to a form in another page. This works perfectly with all the headers and data. What I would like to do is then export this to Excel keeping the same formatting.  </p>\n\n<p>I don't seem to be able to get any more than the headers and the first column of data into Excel. Could anyone point me in the right direction? Here is my code with the original code commented out.</p>\n\n<pre><code>/* Start of Formatting for Word or Excel */\n\n/* FORMATTING FOR EXCEL DOCUMENTS ('.xls') */\n//create title with timestamp:\nif ($Use_Title == 0)\n{\n    echo(\"$title\\n\");\n}\n//define separator (defines columns in excel &amp; tabs in word)\n$sep = \"\\t\"; //tabbed character\n\n//start of printing column names as names of sqlsrv fields\nforeach( sqlsrv_field_metadata($result) as $fieldMetadata)              \n//for($i = 0; $i &lt; sqlsrv_num_fields($result); $i++)\n{\n    echo $fieldMetadata['Name'] , \",\";\n    //echo  sqlsrv_field_metadata($result,$i) . \"\\t\";\n}\nprint(\"\\n\");\n//end of printing column names\n\n//start while loop to get data\nwhile( $row = sqlsrv_fetch_array($result, SQLSRV_FETCH_NUMERIC))\n{\n    //set_time_limit(60); // HaRa\n    //$schema_insert = \"\";\n    echo $row[0], \",\";\n\n//$schema_insert . \"$result\".$sep;\n//$schema_insert .= \"$row[$j]\".$sep;\n////$schema_insert = str_replace($sep.\"$\", \"\", $schema_insert);\n//following fix suggested by Josue (thanks, Josue!)\n//this corrects output in excel when table fields contain \\n or \\r\n//these two characters are now replaced with a space\n////$schema_insert = preg_replace(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n////$schema_insert .= \"\\t\";\n////print(trim($schema_insert));\nprint \"\\n\";\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":1988,"score":12,"question_id":6376866,"title":"TSQL - How to use GO inside of a BEGIN .. END block?","body":"<p>I am generating a script for automatically migrating changes from multiple development databases to staging/production.  Basically, it takes a bunch of change-scripts, and merges them into a single script, wrapping each script in a <code>IF whatever BEGIN ... END</code> statement.</p>\n\n<p>However, some of the scripts require a <code>GO</code> statement so that, for instance, the SQL parser knows about a new column after it's created.</p>\n\n<pre><code>ALTER TABLE dbo.EMPLOYEE \nADD COLUMN EMP_IS_ADMIN BIT NOT NULL\nGO -- Necessary, or next line will generate \"Unknown column:  EMP_IS_ADMIN\"\nUPDATE dbo.EMPLOYEE SET EMP_IS_ADMIN = whatever\n</code></pre>\n\n<p>However, once I wrap that in an <code>IF</code> block:</p>\n\n<pre><code>IF whatever\nBEGIN\n    ALTER TABLE dbo.EMPLOYEE ADD COLUMN EMP_IS_ADMIN BIT NOT NULL\n    GO\n    UPDATE dbo.EMPLOYEE SET EMP_IS_ADMIN = whatever\nEND\n</code></pre>\n\n<p>It fails because I am sending a <code>BEGIN</code> with no matching <code>END</code>.  However, if I remove the <code>GO</code> it complains again about an unknown column.</p>\n\n<p><strong>Is there any way to create and update the same column within a single <code>IF</code> block?</strong></p>\n"},{"tags":["sql","sql-order-by","teradata"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13199339,"title":"SQL Teradata query","body":"<p>I have a table abc which have many records with columns col1,col2,col3,</p>\n\n<pre><code>dept         | name |  marks |\n\nscience         abc      50\nscience         cvv      21\nscience         cvv      22  \nmaths           def      60\nmaths           abc      21\nmaths           def      62\nmaths           ddd      90\n</code></pre>\n\n<p>I need to order by dept and name with ranking as ddd- 1, cvv - 2, abc -3, else 4 then need to find out maximum mark of an individual. Expected result is   </p>\n\n<pre><code>dept         | name |  marks |\n\nscience         cvv      22\nscience         abc      50\nmaths           ddd      90\nmaths           abc      21\nmaths           def      62\n</code></pre>\n\n<p>. How may I do it.?            </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13198571,"title":"Restore Backup Fails - File 'Db' cannot be restored to '{...}.mdf'. Use WITH MOVE to identify a valid location for the file","body":"<p>I am getting the following errors trying to do a restore using the restore command on a backup file I recieved from a customer.</p>\n\n<p>RESTORE DATABASE SFDB FROM DISK = N'C:\\Backup\\Backup.bak' </p>\n\n<p>Any thoughts on what I can do to correct this?  It's looking for the mdf, so can I assume that the backup file I have is an incremental backup and not the full backup and that's why it's looking for the mdf?  </p>\n\n<p>I am not sure if 1) they have given all the data (the entire db) or 2) I have the right data - and I can do the restore with the right T-SQL commands - I just don't know how.</p>\n\n<p>Help is appreciated.</p>\n\n<pre><code>Msg 5133, Level 16, State 1, Line 2\nDirectory lookup for the file \"D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db.mdf\" failed with the operating system error 21(failed to retrieve text for this error. Reason: 15105).\nMsg 3156, Level 16, State 3, Line 2\nFile 'Db' cannot be restored to 'D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db.mdf'. Use WITH MOVE to identify a valid location for the file.\nMsg 5133, Level 16, State 1, Line 2\nDirectory lookup for the file \"D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db_log.LDF\" failed with the operating system error 21(failed to retrieve text for this error. Reason: 15105).\nMsg 3156, Level 16, State 3, Line 2\nFile 'DbDev_log' cannot be restored to 'D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db_log.LDF'. Use WITH MOVE to identify a valid location for the file.\nMsg 3634, Level 16, State 1, Line 2\nThe operating system returned the error '21(failed to retrieve text for this error. Reason: 15105)' while attempting 'GetVolumeInformation' on 'D:\\'.\nMsg 3013, Level 16, State 1, Line 2\nRESTORE DATABASE is terminating abnormally.\n</code></pre>\n\n<p>RESTORE FileListOnly FROM DISK = N'C:\\Backup\\Backup.bak' shows me the following...</p>\n\n<pre><code>LogicalName PhysicalName    Type    FileGroupName   Size    MaxSize FileId  CreateLSN   DropLSN UniqueId    ReadOnlyLSN ReadWriteLSN    BackupSizeInBytes   SourceBlockSize FileGroupId LogGroupGUID    DifferentialBaseLSN DifferentialBaseGUID    IsReadOnly  IsPresent   TDEThumbprint\nDb  D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db.mdf  D   PRIMARY 29622272    35184372080640  1   0   0   02925462-83CC-4222-8966-53229FA25B1C    0   0   29032448    512 1   NULL    269000000146900238  735C7F0E-F63D-4AA1-AC48-505A084AC00B    0   1   NULL\nDb_log  D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db_log.LDF  L   NULL    40239104    2199023255552   2   0   0   71038B04-CBC9-4E4A-93AD-4E1268859CB2    0   0   0   512 0   NULL    0   00000000-0000-0000-0000-000000000000    0   1   NULL\nDbDev_filestream    D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db  S   PRIMARY_FILESTREAM  4691012 0   65537   18000000011800001   0   627C9AAA-97BD-4991-9C8C-90C400226A9F    0   0   4784128 512 2   NULL    269000000146900238  735C7F0E-F63D-4AA1-AC48-505A084AC00B    0   1   NULL\n</code></pre>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13199051,"title":"How to set sql field value equal to another value in the same table","body":"<p>I have a table that contains values for different locations where the <code>location id and the item number combination form the primary key</code>.  A lot of the items are the same in both locations when it comes to cost etc.  I am needing to fix one locations information that got changed by a user somehow.  I am looking for advice on how to set the value for <code>location 1 for item 1</code> to be the same as <code>location 2 item 1</code>.  I know how to do this if the value is in a different table, but I am not sure how to accomplish this when the values are in the same table.  Any advice will be greatly apprciated</p>\n"},{"tags":["sql","database","tsql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13198746,"title":"sql - group/order same column DESC and with random values","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8305920/sql-how-to-sort-order-query-result-in-somewhat-arbitrary-manner\">SQL: How to sort / order query result in somewhat arbitrary manner?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to order a column like so (DESC values):\n c,b,a. \nHowever at the very end of the DESC, I want to display values g,h,i (if exist) . Do I need to do a union on the column from a sub-query?</p>\n\n<p>This is the SQL script so far:</p>\n\n<pre><code>SELECT cars,size from car_table\nGROUP BY cars, size\nORDER BY cars DESC,size ASC\n</code></pre>\n\n<p>Cars is the column I am trying to run my multi-sort on.</p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13198974,"title":"sql confusion with ANDs","body":"<p>I am having a bit of confusion with SQL querying using ANDs.</p>\n\n<p>the query is as follows:</p>\n\n<pre><code>SELECT  count(cdr.id) as callTotal,\n    sum(cdr.callDurationSeconds) as timeTotal,\n    users.firstname,\n    users.surname, \n    MAX(cdr.callDuration) as maxCallDuration,\n    AVG(cdr.answeredTime) as avgAnswerTime,\n    AVG(cdr.callDurationSeconds) as avgTimeTotal,\n    cdr.userId, \n    COUNT(IF(cdr.callDurationSeconds &gt; '0', 1, NULL)) AS answeredCalls\n                 FROM cdr \n                 LEFT JOIN users ON cdr.userId = users.id\n                 WHERE cdr.company = 'C47B0BCCDCE92F'\n                 AND cdr.dateCreated LIKE '2012-11-02%'  \n                 AND  cdr.userId = 'U4BC3128209B01'  \n   OR  cdr.userId = 'U4A9FCCD73C6BB'  \n   GROUP BY userId  ORDER BY users.surname ASC  ;\n</code></pre>\n\n<p>I want to query by the date on the second to last line, but then I wish to retrieve items with any of the posted cdr.userIds.\nHowever it seems to disregard the date in this instance. I need the date to be non-optional and retrieve any data with the select Ids on the chosen date.</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":65,"score":-3,"question_id":13199092,"title":"i want to calculate total child count with stored procedure","body":"<p>I have three table a parent table a left child table and a right child table and i want to traverse each node of tree and get child count on the basis of parent id how can i achieve this in c# or in sql </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13198805,"title":"Remove duplicate batches of data","body":"<p>Due to a bug in my application a table that was built to carry daily records of each delivery period, was populated many times.</p>\n\n<p>Lets say I have a delivery from 1st of June to 5 of June. My table should be populated with 5 records, one for each day. Now, I have havoc because I have many \"batches\" of the same content.</p>\n\n<p>The table layout is as:</p>\n\n<pre><code>dummy_id       -- identity column\ndelivery_id    -- id of the delivery\non_date        -- the day\ncharge         -- the daily cost\n</code></pre>\n\n<p>Is there an elegant way to keep only the first batch of records and delete the batches that were inserted by mistake for all the deliveries?</p>\n"},{"tags":["sql","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13195025,"title":"Return a substring from a field in SQL","body":"<p>I'm hoping one of you knowledgable lot can help me out with this...</p>\n\n<p>I have a field in my DB which contains HTML.  Within this HTML, in each record there is a link with parameters included.</p>\n\n<p>eg.</p>\n\n<pre><code>&lt;a href='http://mysite.com/clickme.aspx?ctid=31' title='Click Here !' target='_blank'&gt;Click this link&lt;/a&gt;\n</code></pre>\n\n<p>All I want to return is the ID of the record, and the value of the parameter CTid (CTid could be anything between 2 digits and 12 digits long)</p>\n\n<p>So, what I want returned is:</p>\n\n<pre><code>ID ¦ CTid ¦\n73 ¦ 31   ¦\n</code></pre>\n\n<p>I've tried using PATINDEX but it's not doing the trick for me (because I have to specify the length of the string returned)</p>\n\n<pre><code>SELECT id, SUBSTRING(content, PATINDEX('%CTid%', content), 12) AS CTid\nFROM ARTICLES\nWHERE content LIKE '%CTid%'\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>   ID ¦ CTid         ¦\n   73 ¦ ctid=31' tit ¦\n</code></pre>\n\n<p>Can anyone shed some light on a good way of doing this ?</p>\n\n<p>I'll be returning several thousand rows so would rather stay away from cursors and intensive operations if possible.</p>\n\n<p>Thanks a lot :) </p>\n"},{"tags":["c#","sql","sql-server","ado.net"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":677,"score":2,"question_id":4369315,"title":"Datetime has too many decimal places","body":"<p>I have the following code:</p>\n\n<pre><code>SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder();\n// set properties on  builder (omitted for brevity)\n\nusing (SqlConnection connection = new SqlConnection(builder.ToString()))\n{\n    connection.Open();\n    using (SqlCommand command = connection.CreateCommand())\n    {\n        command.CommandType = System.Data.CommandType.Text;\n        command.CommandText = \"SELECT * FROM Employee WHERE WhenHire &lt; @HireDate\";\n        SqlParameter hireDateParameter = new SqlParameter(\"@HireDate\", DateTime.Now);\n        command.Parameters.Add(hireDateParameter);\n        using (SqlDataReader reader = command.ExecuteReader())\n        {\n            while (reader.Read())\n            {\n                // do stuff\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Which shows up in SQL Profiler as:</p>\n\n<pre><code>exec sp_executesql N'SELECT * FROM Employee WHERE WhenHire &lt; @HireDate',\n                   N'@HireDate datetime',\n                   @HireDate='2010-12-06 11:43:23.573'\n</code></pre>\n\n<p>How is the precision of the datetime parameter determined?  I've seen this have 7 digits after the decimal.  </p>\n\n<pre><code>exec sp_executesql N'SELECT * FROM Employee WHERE WhenHire &lt; @HireDate',\n               N'@HireDate datetime',\n               @HireDate='2010-12-06 11:43:23.5733125'\n</code></pre>\n\n<p>In that case, the statement fails to execute with this error:</p>\n\n<blockquote>\n  <p>Msg 8114, Level 16, State 1, Line 1\n  Error converting data type varchar to\n  datetime.</p>\n</blockquote>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13186270,"title":"MySQL group by with lookahead?","body":"<p>I have a log of events for when a device either starts or stops with a failure code and I'm trying to calculate the average and mean times between a failure and a start. Here's a very simple example table of data:</p>\n\n<pre><code>+----+-----------+---------------------+\n| id | eventName | eventTime           |\n+----+-----------+---------------------+\n|  1 | start     | 2012-11-01 14:25:20 |\n|  2 | fail A    | 2012-11-01 14:27:45 |\n|  3 | start     | 2012-11-01 14:30:49 |\n|  4 | fail B    | 2012-11-01 14:32:54 |\n|  5 | start     | 2012-11-01 14:35:59 |\n|  6 | fail A    | 2012-11-01 14:37:02 |\n|  7 | start     | 2012-11-01 14:38:05 |\n|  8 | fail A    | 2012-11-01 14:40:09 |\n|  9 | start     | 2012-11-01 14:41:11 |\n| 10 | fail C    | 2012-11-01 14:43:14 |\n+----+-----------+---------------------+\n</code></pre>\n\n<p>Create code:</p>\n\n<pre><code>CREATE TABLE `test` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `eventName` varchar(50) NOT NULL,\n  `eventTime` datetime NOT NULL,\n  PRIMARY KEY (`id`)\n);\nINSERT INTO `test` (`id`, `eventName`, `eventTime`) VALUES (1,'start','2012-11-01 14:25:20'),(2,'fail A','2012-11-01 14:27:45'),(3,'start','2012-11-01 14:30:49'),(4,'fail B','2012-11-01 14:32:54'),(5,'start','2012-11-01 14:35:59'),(6,'fail A','2012-11-01 14:37:02'),(7,'start','2012-11-01 14:38:05'),(8,'fail A','2012-11-01 14:40:09'),(9,'start','2012-11-01 14:41:11'),(10,'fail C','2012-11-01 14:43:14');\n</code></pre>\n\n<p>I can get the times between a start and a failure using something like this:</p>\n\n<pre><code>SET @time_prev := -1;\nSELECT\n *\nFROM\n(\n  SELECT\n    eventName\n  , eventTime\n  , @ts := UNIX_TIMESTAMP(eventTime) AS ts\n  , @started := IF(eventName = 'start', 1, 0) AS started\n  , @failed := IF(eventName &lt;&gt; 'start', 1, 0) AS failed\n  , @time_diff := IF(@time_prev &gt; -1, @ts - @time_prev, 0) AS time_diff\n  , @time_prev := @ts AS time_prev\n  , @time_to_fail := IF(@failed, @time_diff, 0) AS time_to_fail\n  , @time_to_start := IF(@started, @time_diff, 0) AS time_to_start\n  FROM\n    test\n) AS t1;\n\n+-----------+---------------------+------------+---------+--------+-----------+------------+--------------+---------------+\n| eventName | eventTime           | ts         | started | failed | time_diff | time_prev  | time_to_fail | time_to_start |\n+-----------+---------------------+------------+---------+--------+-----------+------------+--------------+---------------+\n| start     | 2012-11-01 14:25:20 | 1351805120 |       1 |      0 |         0 | 1351805120 | 0            | 0             |\n| fail A    | 2012-11-01 14:27:45 | 1351805265 |       0 |      1 |       145 | 1351805265 | 0            | 145           |\n| start     | 2012-11-01 14:30:49 | 1351805449 |       1 |      0 |       184 | 1351805449 | 184          | 0             |\n| fail B    | 2012-11-01 14:32:54 | 1351805574 |       0 |      1 |       125 | 1351805574 | 0            | 125           |\n| start     | 2012-11-01 14:35:59 | 1351805759 |       1 |      0 |       185 | 1351805759 | 185          | 0             |\n| fail A    | 2012-11-01 14:37:02 | 1351805822 |       0 |      1 |        63 | 1351805822 | 0            | 63            |\n| start     | 2012-11-01 14:38:05 | 1351805885 |       1 |      0 |        63 | 1351805885 | 63           | 0             |\n| fail A    | 2012-11-01 14:40:09 | 1351806009 |       0 |      1 |       124 | 1351806009 | 0            | 124           |\n| start     | 2012-11-01 14:41:11 | 1351806071 |       1 |      0 |        62 | 1351806071 | 62           | 0             |\n| fail C    | 2012-11-01 14:43:14 | 1351806194 |       0 |      1 |       123 | 1351806194 | 0            | 123           |\n+-----------+---------------------+------------+---------+--------+-----------+------------+--------------+---------------+\n</code></pre>\n\n<p>But in order to get time between failure and start I have to move ahead to the next record and lose the grouping of that failure code. How can I move this to the next level and get the future to time start merged into a failed record so it can be grouped?</p>\n\n<p>Ultimately, after calculating averages and medians I would end up with a result set like this:</p>\n\n<pre><code>+-----------+-------------+----------------+--------------+-----------------+\n| eventName | avg_to_fail | median_to_fail | avg_to_start | median_to_start |\n+-----------+-------------+----------------+--------------+-----------------+\n|    fail A |      110.66 |         124.00 |       103.00 |           63.00 |\n|    fail B |      125.00 |         125.00 |       185.00 |          185.00 |\n+-----------+-------------+----------------+--------------+-----------------+\n</code></pre>\n"},{"tags":["sql","mongodb","design","schema"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":111,"score":3,"question_id":13190468,"title":"Pros and Cons of using MongoDB instead of MS SQL Server","body":"<p>I am new to NoSQL world and thinking of replacing my MS Sql Server database to MongoDB. My application (written in .Net C#) interacts with IP Cameras and records meta data for each image coming from Camera, into MS SQL Database. On average, i am inserting about 86400 records per day for each camera and in current database schema I have created separate table for separate Camera images, e.g. Camera_1_Images, Camera_2_Images ... Camera_N_Images. Single image record consists of simple metadata info. like AutoId, FilePath, CreationDate. To add more details to this, my application initiates separate process (.exe) for each camera and each process inserts 1 record per second in relative table in database.</p>\n\n<p>I need suggestions from (MongoDB) experts on following concerns:</p>\n\n<ol>\n<li><p>to tell if MongoDB is good for holding such data, which eventually will be queried against time ranges (e.g. retrieve all images of a particular camera between a specified hour)? Any suggestions about Document Based schema design for my case? </p></li>\n<li><p>What should be the specs of server (CPU, RAM, Disk)? any suggestion?</p></li>\n<li><p>Should i consider Sharding/Replication for this scenario (while considering the performance in writing to synch replica sets)?</p></li>\n<li><p>Are there any benefits of using multiple databases on same machine, so that one database will hold images of current day for all cameras, and the second one will be used to archive previous day images? I am thinking on this with respect to splitting reads and writes on separate databases. Because all read requests might be served by second database and writes to first one. Will it benefit or not? If yes then any idea to ensure that both databases are synced always.</p></li>\n</ol>\n\n<p>Any other suggestions are welcomed please.</p>\n\n<p>Regards.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13198298,"title":"Need to group only specific rows in a query","body":"<p>Please consider the following simplified MySQL table:</p>\n\n<pre><code>id  | docID  | docTypeID | makeID | desc\n1   | 1      | 1         | 1      | doc 1\n2   | 1      | 1         | 2      | doc 2\n3   | 2      | 2         | 1      | doc 3\n4   | 3      | 3         | 2      | doc 4\n5   | 1      | 1         | 4      | doc 5\n6   | 2      | 2         | 5      | doc 6\n7   | 4      | 1         | 1      | doc 7\n</code></pre>\n\n<p>In this example docID, docTypeID, and makeID are all foreign keys. </p>\n\n<p>When a doc of docTypeID 1 is associated with multiple makes, I need to group those docs together and return a special make description ('multiple makes found').</p>\n\n<p>What I need to return for this example table would be:</p>\n\n<pre><code>id  | docID  | docTypeID | makeID                | desc\n1   | 1      | 1         | multiple makes found  | doc 1\n3   | 2      | 2         | 1                     | doc 3\n4   | 3      | 3         | 2                     | doc 4\n6   | 2      | 2         | 5                     | doc 6\n7   | 4      | 1         | 1                     | doc 7\n</code></pre>\n\n<p>Note that in the case of id 7, only a single make is found so there is no grouping performed.</p>\n\n<p>I'm not sure how to limit grouping based on criteria or if that is even possible. I'm hopeful one of the SQL geniuses here can assist. Please let me know if any additional info is required. Thanks.</p>\n"},{"tags":["sql","oracle"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3598,"score":1,"question_id":6789010,"title":"distinct values from multiple fields within one table ORACLE SQL","body":"<p>How can I get distinct values from multiple fields within one table with just one request.</p>\n\n<p><strong>Option 1</strong></p>\n\n<pre><code>SELECT WM_CONCAT(DISTINCT(FIELD1)) FIELD1S,WM_CONCAT(DISTINCT(FIELD2)) FIELD2S,..FIELD10S\n  FROM TABLE;\n</code></pre>\n\n<p>WM_CONCAT is LIMITED</p>\n\n<p><strong>Option 2</strong></p>\n\n<pre><code>select DISTINCT(FIELD1) FIELDVALUE, 'FIELD1' FIELDNAME\n       FROM TABLE\nUNION\nselect DISTINCT(FIELD2) FIELDVALUE, 'FIELD2' FIELDNAME\n       FROM TABLE\n... FIELD 10\n</code></pre>\n\n<p>is just too slow</p>\n"},{"tags":["php","sql","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13198398,"title":"display image limit one per result?","body":"<p>I have a search script i am using. it finds users by name or location. i am trying to add a image to each user that is found in the search. but when i do it lists every users image even if not in the search and duplicates the searched name and image a dozen times like so:</p>\n\n<p>image1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael</p>\n\n<p>image2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric</p>\n\n<p>and so on. can someone please let me know how i can limit it to just show one image for each user profile that comes up in the search without limiting the users that show up in the search to 1 obviously?</p>\n\n<p>Heres my code:</p>\n\n<pre><code>&lt;form method=\"get\" action=\"\"&gt;\n&lt;input type=\"text\" name=\"query\" class=\"search\" placeholder=\"Search Name/Location\" style=\"width:120px;\"/&gt;\n&lt;input type=\"image\" src=\"../PTB1/assets/img/icons/loginarrow1.png\" class=\"searchbutton\" name=\"submit\" value=\"Start Search\" /&gt;\n&lt;/form&gt;\n\n&lt;?php\n//PHP CODE STARTS HERE\n\nif(isset($_GET['submit'])){\n\n// Change the fields below as per the requirements\n$db_host=\"localhost\";\n$db_username=\"root\";\n$db_password=\"\";\n$db_name=\"playtime\";\n$db_tb_atr_name=\"display_name\";\n\n//Now we are going to write a script that will do search task\n// leave the below fields as it is except while loop, which will display results on screen\n\nmysql_connect(\"$db_host\",\"$db_username\",\"$db_password\");\nmysql_select_db(\"$db_name\");\n\n$query=mysql_real_escape_string($_GET['query']);\n\n$query_for_result=mysql_query(\"SELECT *\n                        FROM ptb_profiles\n                        WHERE display_name like '%\".$query.\"%' \n        OR location LIKE '%\".$query.\"%' OR orientation LIKE '%\".$query.\"%'\");\necho \"&lt;div class=\\\"results\\\"&gt;\";\nwhile($data_fetch=mysql_fetch_array($query_for_result))\n{\n        $search_set = get_searched_escorts();\n        while ($searched = mysql_fetch_array($search_set)) {\n    echo \"&lt;div class=\\\"spacing\\\"&gt;&lt;a href=\\\"profile.php?id={$data_fetch['user_id']}\\\" class=\\\"search\\\"&gt;\";\n    echo \"&lt;img width=80px height= 80px src=\\\"data/photos/{$searched['id']}/_default.jpg\\\" class=\\\"boxgrid\\\"/&gt; \"; \n     echo substr($data_fetch[$db_tb_atr_name], 0,160);\n    echo \"&lt;/a&gt;&lt;/div&gt;\";\n\n}\n}\n\nmysql_close();\n}\n\n?&gt;\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["sql","sql-server","database","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13198384,"title":"What does &gt; 0 mean in SQL?","body":"<p>I have the following SQL statement. Please tell me if my translation of it is accurate. I'm using MS SQL Server 2008. Thanks</p>\n\n<pre><code>(bld_sqft &amp;gt; 0 OR bld_area &amp;gt; 0)\n</code></pre>\n\n<p>My translation</p>\n\n<pre><code>bld_sqft &gt; 0 OR bld_area &gt; 0\n</code></pre>\n"},{"tags":["sql","database","teradata"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13197934,"title":"SQL difference between =0, ='0', IN(0), IN('0')","body":"<p>I inherited some code from a coworker and I noticed that the way that some of the code is not consistent\nFor example, is ther any functional difference between the following:</p>\n\n<pre><code>sum(case when (elephants = 0)then 1 else 0 end),\n\nsum(case when (elephants = '0')then 1 else 0 end),\n\nsum(case when (elephants IN (0))then 1 else 0 end),\n\nsum(case when (elephants IN ('0'))then 1 else 0 end);\n</code></pre>\n\n<p>If there isn't a functional difference between using single qutoes or IN vs = when looking for a single value, what other reason could account for it (other than sloppy code)?</p>\n"},{"tags":["sql","vba","ado"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13197468,"title":"SQL Query & VBA error","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13197011/sql-query-vba-error\">SQL Query &amp; VBA error</a>  </p>\n</blockquote>\n\n\n\n<p>i'm keep getting this error:</p>\n\n<p>BOF or EOF set tu True, or the current record has been deleted. The requested operation requires a current record.</p>\n\n<pre><code>    MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n         &amp; \"WHERE [DateMad] Between #\" _\n         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \" Group By Destinataire\"\n\n         objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n\n         Feuil3.Cells(1, Col) = Entete\n         Feuil3.Cells(strLine, 2) = Entete2\n         Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>i get the error on the last line</p>\n\n<pre><code>  Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>why did it asks me for an BOF or EOF since i'm asking the SUM? also how to get this query to work plz ? \ni cannot breathe with this debugging</p>\n\n<p>the debug.print MyQuery give the following :</p>\n\n<pre><code> Select Destinataire, SUM(NbCompteurElecNR) AS NombreTotal FROM [Feuil1$] WHERE [DateMad] Between #2012/11/21# And #2012/11/26# And [Destinataire] = 'REL12' Group By Destinataire\n</code></pre>\n"},{"tags":["sql","clojure","clojureql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13198271,"title":"clojureql query with sub-select","body":"<p>Given a table with the following structure:</p>\n\n<pre><code>CREATE TABLE transitions (ordering INT, item_id INT, action_id INT)\n</code></pre>\n\n<p>Is it possible to get ClojureQL to generate a query like this one:</p>\n\n<pre><code>SELECT a.item_id, a.action_id\n  FROM transitions a\n WHERE a.ordering = (SELECT MAX(b.ordering)\n                       FROM transitions b\n                      WHERE b.item_id = a.item_id)\n</code></pre>\n\n<p>I've been looking at using <code>join</code>, but worry I might hit this bug: <a href=\"https://github.com/LauJensen/clojureql/issues/114\" rel=\"nofollow\">https://github.com/LauJensen/clojureql/issues/114</a></p>\n"},{"tags":["sql","database","count","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12693111,"title":"count multiple columns with group by in one query","body":"<p>I count values from multiple columns like this:   </p>\n\n<pre><code>SELECT COUNT(column1),column1 FROM table GROUP BY column1\nSELECT COUNT(column2),column2 FROM table GROUP BY column2\nSELECT COUNT(column3),column3 FROM table GROUP BY column3\n</code></pre>\n\n<p>This returns for example for column1 array(attr1 => 2000, attr2 => 3000...) (Each column has specific and few values). The problem is that \"table\" in my application can be a query with some joins and where clauses, that may take 0.1sec. By doing all that counts \"table\" is computed each time again which is not necessary. Is there any way to take the results i want with one query, or \"cache\" the query that produces table? Otherwise i believe denormalization would be the only solution here. And i want the same results with the above queries. I am using mysql-myisam.</p>\n"},{"tags":["sql","sql-server","string-concatenation","sql-server-group-concat"],"answer_count":11,"favorite_count":43,"up_vote_count":52,"down_vote_count":0,"view_count":62889,"score":52,"question_id":273238,"title":"How to use GROUP BY to concatenate strings in SQL Server?","body":"<p>How do I get:</p>\n\n<pre><code>id       Name       Value\n1          A          4\n1          B          8\n2          C          9\n</code></pre>\n\n<p>to</p>\n\n<pre><code>id          Column\n1          A:4, B:8\n2          C:9\n</code></pre>\n"},{"tags":["sql","mysql","performance","exists"],"answer_count":9,"favorite_count":12,"up_vote_count":36,"down_vote_count":0,"view_count":22835,"score":36,"question_id":1676551,"title":"Best way to test if a row exists in a MySQL table","body":"<p>I'm trying to find out if a row exists in a table. Using MySQL, is it better to do a query like this:</p>\n\n<pre><code>SELECT COUNT(*) AS total FROM table1 WHERE ...\n</code></pre>\n\n<p>and check to see if the total is non-zero or is it better to do a query like this:</p>\n\n<pre><code>SELECT * FROM table1 WHERE ... LIMIT 1\n</code></pre>\n\n<p>and check to see if any rows were returned?</p>\n\n<p>In both queries, the WHERE clause uses an index.</p>\n"},{"tags":["sql","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":49,"score":0,"question_id":13197011,"title":"SQL Query & VBA error","body":"<p>I keep getting this error:</p>\n\n<pre><code>BOF or EOF set tu True, or the current record has been deleted. The requested\noperation requires a current record.\n</code></pre>\n\n<p>My Code:</p>\n\n<pre><code>    MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n         &amp; \"WHERE [DateMad] Between #\" _\n         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \" Group By Destinataire\"\n\n         objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n\n         Feuil3.Cells(1, Col) = Entete\n         Feuil3.Cells(strLine, 2) = Entete2\n         Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>i get the error on the last line</p>\n\n<pre><code>  Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>why did it asks me for an BOF or EOF since i'm asking the SUM? also how to get this query to work plz ? \ni cannot breathe with this debugging</p>\n"},{"tags":["sql","database","indexing"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":6365,"score":2,"question_id":6593765,"title":"How to use index in select statement?","body":"<p>i have created an index suppose IDX_name on the name attribute.\nIs it necessary to use this index name in select clause or it will automatically used to speed up queries related to name attribute,</p>\n\n<p>If the index must be used in select clause then how to use it ?</p>\n"},{"tags":["sql","sql-server-2008","ssas","mdx","business-intelligence"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13184139,"title":"SQL Server MDX query parameter","body":"<p>I am very new to MDX query. I am trying to pass a parameter through my query. It is giving me this SQL error:</p>\n\n<blockquote>\n  <p><em>Query preparation failed.</em><br>\n  <em>The function expects a tuple expression for the 5 argument.</em><br>\n  <em>A tuple set expression was used.</em></p>\n</blockquote>\n\n<p>The query is:</p>\n\n<pre><code>SELECT \n{\n[Measures].[DENOMINATOR]\n,[Measures].[NUMERATOR]\n,[Measures].[Goal]\n}\nON COLUMNS,\nNON EMPTY\n(\n [Dim Indicator].[Indicator Set].[Indicator Set].ALLMEMBERS\n ,[Dim Indicator].[Indicator Group].[Indicator Group].ALLMEMBERS\n ,[Dim Indicator].[Indicator Name].[Indicator Name].ALLMEMBERS\n)\nON ROWS\nFROM [Dummy-Dashboard]\n\n--Parameter Queries goes here \n\nWHERE \n(\n    strtoset(@DimGenderGenderID)\n )\n</code></pre>\n"},{"tags":["sql","database-design","case","teradata"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13197950,"title":"How to re-design my current SQL Case Logic implementation in Teradata 13.0","body":"<p>I am building out a Staging layer for Master Data and have the following situation and current solution. My Transaction data has nothing but Master Data id's or \"codes\" and no text descriptions. Most all my text descriptions are delivered in a single generic table which has all the possible \"codes\" and their subsequent text values. In moving this data into the Staging layer I need to trim the codes from the VARCHAR(60) into their actual field length based on their original field length.</p>\n\n<p>in short, Master Data codes are moved from the source environment where they are correctly cast into this Landing environmental and a VARCHAR(60) where they get padded. I need to trim according to field length as I move into Staging.</p>\n\n<p>I am using the following SQL, but have wrapped it in CASE logic to manage the different possible field lengths I will see. I have to therefore reproduce this bit of logic for each different MD code I deal with. I am looking for a way to tweak this so that it handles all field lengths in one bit of logic. </p>\n\n<pre><code>SELECT ATTR_NM\n    , CASE \n        WHEN ATTR_NM = 'DOC_TYP'\n            THEN(\n                CASE WHEN CHARACTER_LENGTH (TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD)) &gt; 1\n                    THEN SUBSTRING( tx.MSTR_DATA_ATTR_CD FROM CHARACTER_LENGTH(TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD))-1)\n                    ELSE tx.MSTR_DATA_ATTR_CD\n                END\n                )\n    WHEN SAP_ATTR_NM = 'ACCT_GRP'\n        THEN(\n            CASE WHEN CHARACTER_LENGTH (TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD)) &gt; 4\n                THEN SUBSTRING( tx.MSTR_DATA_ATTR_CD FROM CHARACTER_LENGTH(TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD))-2)\n                ELSE tx.MSTR_DATA_ATTR_CD\n            END\n            )\n        END AS MSTR_DATA_ATTR_CD\n    , LANG_ISO_CD AS LANG_ISO_CODE\n    , tx.LANG AS LANG\n    , tx.END_DT AS END_DT\n    , tx.FRM_DT AS FRM_DT\nFROM MASTER_DATA_DESC_BASE_VOL tx;\n</code></pre>\n\n<p>I can't just Trim leading 0's since I can have a code with a leading 0. I need to know the field length and then apply that numeric value with the Trim function call. Or someone has a better way altogether. I am a longtime programmer consultant, but somewhat new to Teradata.</p>\n\n<p>Also, this is working and currently handles more than 20 different cases and runs rather efficiently. I just know there is a better way to do what I need and I will also have to continue to add more and more Cases.</p>\n\n<p>Thanks in advance, Pat</p>\n"},{"tags":["sql","vb.net","ms-access","delimited-text"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13197941,"title":"Updating Access Table from data in delimited text file... Syntax Error","body":"<p>I am attempting to use the Jet OleDB Provider in order to update rows in an access database table using data from a pipe (\"|\") delimited text file. I am getting a syntax error for some reason and need some assistance on it. I am used to Sql Server, and I know there are suttle differences between the two. I know the issue isn't my schema, because I have been able to do a straight insert. Here is the code: </p>\n\n<pre><code>   Dim dbConn As New OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; Set_Data_Directory() &amp; \"\\db.mdb\")\n   Dim a As String = \"UPDATE [tbl_EmployeeList] \" &amp; _\n                     \"INNER JOIN [[Text;DATABASE=\" &amp; Set_Data_Directory() &amp; \";].[extract_VendorID.txt]] ON ([tbl_EmployeeList].[empID] = [[Text;DATABASE=\" &amp; Set_Data_Directory() &amp; \";].[extract_VendorID.txt]].[Col2]) \" &amp; _\n                     \"SET [tbl_Employeelist].[pinNum] = [[Text;DATABASE=\" &amp; Set_Data_Directory() &amp; \";].[extract_VendorID.txt]].[Col3]\"\n   Dim dbCmd As OleDbCommand = New OleDbCommand(a, dbConn)\n</code></pre>\n\n<p>In the above code, tbl_EmployeeList is my access table, and the Set_Data_Directory is a custom function that simply gets the working directory path. Because I did not design the text files (I would have used XML personally) the txt files do not have headers and the schema uses Col0-ColX for the column names. </p>\n\n<p>For reference, the schema.ini for this source:</p>\n\n<pre><code>[extract_VendorID.txt]\nColNameHeader=False\nCharacterSet=ANSI \nFormat=Delimited(|)\nCol1=Col0 Text\nCol2=Col1 Text\nCol3=Col2 Text\nCol4=Col3 Text\nCol5=Col4 Text\nCol6=Col5 Text\nCol7=Col6 Text\n</code></pre>\n\n<p>As I said, the error that VS is throwing is a very general \"Syntax error in UPDATE statement.\"</p>\n\n<p>Thanks ahead of time.</p>\n"},{"tags":["java","sql","ubuntu","firebird","monitor"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":45,"score":4,"question_id":13195672,"title":"Monitoring SQL calls to Firebird under Ubuntu (Java app)","body":"<p>Having just moved platform from mySQL to firebird I am finding it difficult to find an acceptable way of capturing SQL commands being passed from a Java .jar application to the database server (Firebird). I need to analyse the commands as well as the \"cost\" of the queries being passed over in terms of execution time and so on.</p>\n\n<p>With MySQL it was possible to use the <a href=\"http://www.maatkit.org/\" rel=\"nofollow\">maatkit toolkit</a> but unfortunately this does not appear to work with Firebird.</p>\n\n<p>Does anyone have an appropriate and comparable approach to maatkit for Firebird?  Or using strace or similar?</p>\n"},{"tags":["mysql","sql","database-design","orm","relational-database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13197584,"title":"optional days of the week table design","body":"<p>I have the following form, similar to google's calendar event form:</p>\n\n<ul>\n<li>Interval (drop down) [Daily, Weekdays, Weekly, Monthly, Yearly]</li>\n<li>Starts on (date)</li>\n<li>Ends on (radio) either \"Never\" or \"On (and enters date)\"</li>\n</ul>\n\n<p>and if weekly is selected in interval, then 7 checkboxes appear for weekdays.</p>\n\n<p>I am trying to design the db table, but not sure what is the best way to do it. This is what I have so far (in mysql, excluding irrelavent details):</p>\n\n<pre><code>CREATE TABLE `schedule` (\n    `SCHEDULE_ID` int(11) NOT NULL auto_increment,\n    `START_DT` date NOT NULL,\n    `END_DT` date default NULL,\n    `INTERVAL_CD` tinyint NOT NULL,\n    `SUN_IN` tinyint default NULL,\n    `MON_IN` tinyint default NULL,\n    `TUE_IN` tinyint default NULL,\n    `WED_IN` tinyint default NULL,\n    `THU_IN` tinyint default NULL,\n    `FRI_IN` tinyint default NULL,\n    `SAT_IN` tinyint default NULL,\n    PRIMARY KEY (`SCHEDULE_ID`),\n);\n</code></pre>\n\n<p><code>INTERVAL_CD</code> will take a number defined in a tinyint_cd table, and maps to one of the values (daily, weekdays, etc).</p>\n\n<p><code>END_DT</code> will take a null value if 'Never' is selected, or date if a date is entered.</p>\n\n<p>The days, though, is what I am struggling with. Logic will be needed to interpret the table, and I am not so sure if this is the best way to do it. Thought about putting the days in a separate table that refers to the <code>SCHEDULE</code> tables on its id. I am not too stuck on using indicators (0,1), I even think I overuse them in my table design. If you have any suggestion please share it, and I would really appreciate some reasoning as to why the solution is a good design choice.</p>\n\n<p>Thanks in advance,<br/>\np.s. I use jdbc template now, but will potentially add hibernate support. </p>\n"},{"tags":["android","mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13197318,"title":"Storing line-by-line data in single database field","body":"<p>In MySQL database, I have a table in which there is a field named features. I have nearly 20 features to store there. I am trying to retrieve these features from my Android mobile application. In app, it has to be shown as line by line (so 20 lines in total). Is there anyway to store the 20 features in that single field by doing something like <code>\\n</code>? Or is there anyway to get those features in new lines by doing something in my android app?</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":13195515,"title":"How to set a NULL in the first and second record?","body":"<p>I have the following query:  </p>\n\n<pre><code>Declare @t Table(Id int identity,Groep int,[Date] Datetime,MondayMorning      \nInt,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int ,WednesdayMorning    \nInt,WednesdayEvening Int)\nInsert Into @t Select 2,'2012-01-01',2,0,2,2,2,2\nunion all\nSelect 2,'2012-01-02', 2,2,2,3,2,2\nunion all\nSelect 3,'2012-01-03', 2,2,2,2,2,2\n\n\nselect Id, Groep ,[Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nfrom @t t\nunion all\nselect Id, Groep, [Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nFrom @t tt\n\nWHERE tt.MondayMorning &lt;&gt; tt.MondayEvening\nAND (tt.MondayMorning != 0 and tt.MondayEvening != 0)\nOR tt.TuesdayMorning &lt;&gt; tt.TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\nOR tt.WednesdayMorning &lt;&gt; tt.WednesdayEvening\nAND (tt.WednesdayEvening != 0 and tt.WednesdayMorning != 0)\n</code></pre>\n\n<p>This query gives me a result that is actually correct. I just need to set in TuesdayEvening a Null value in the first record with Id=2. In the second record from that Id=2 set TuesdayMorning = null</p>\n\n<p>To see how this works just run the query.</p>\n\n<p>any ideas?</p>\n"},{"tags":["sql","oracle","instantclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13195457,"title":"Can I use Direct Path Loads in Oracle Instant Client?","body":"<p>I have used SQL*LOADER in Oracle full client for bulk upload using ctl files. But I am planning to move to instant client in which SQL*LOADER doesn't work. I found from the Oracle OCI reference <a href=\"http://oracle.su/docs/11g/appdev.112/e10646/oci13obn.htm#BAJJGACH\" rel=\"nofollow\">http://oracle.su/docs/11g/appdev.112/e10646/oci13obn.htm#BAJJGACH</a> that I can use Direct Path Loads in OCI. Does this mean, that I will be able to use Direct Path Loads using Oracle Instant Client? Can you point me how some good links\\tutorials how to use this?</p>\n"},{"tags":["sql","varchar","longtext"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13197127,"title":"VARCHAR versus TEXT or LONGTEXT","body":"<p>If a blog post is 200 characters long, will <code>varchar(6500)</code> only consume the space of <code>varchar(200)</code>?</p>\n\n<p>Will this be more efficient than using TEXT or LONGTEXT?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","ssis","tsqlt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13196802,"title":"SQL - Foreign Key Constraint Error with Update Statement","body":"<p>I am Trying to update my table (product) columns - ProductID(FK) and ProductType(FK). These two column has relation with MProduct table's column MProductID(PK) and MProductType(PK).</p>\n\n<p>I am trying to update </p>\n\n<pre><code>ProductID       ProductType\n9999            11\n9999            12\n</code></pre>\n\n<p>But I got the following error </p>\n\n<pre><code>The UPDATE statement conflicted with the FOREIGN KEY constraint \"FKHCR_MProduct\".\nThe conflict occurred in database \"XXXX\", table \"dbo.MProduct\".\n</code></pre>\n\n<p>I checked with MProduct table, It has all the valid records for look up. I can not change my Table Structure.</p>\n\n<p>I tried this Query too</p>\n\n<pre><code>Select ProductID,ProductType\nfrom dbo.Product P\nLeft Join dbo.MProduct M on M.ProductID = P.ProductID\n   and M.ProductType = P.ProductType\nwhere M.ProductType is null\n   and M.ProductID is null\n</code></pre>\n\n<p>and there is No Output, means there is No Null Data Inside the Look up table.</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13197033,"title":"Join Query which should return one row","body":"<p>I need to write a query which will retrieve me the fullname (available in fullname) of the ownerid and creatorid. Since both are referring the same table, it is retrieving me two rwo. But I need fullname for both ownerid and creatorid fullname in one row. How to do this? owner id and creator id is the reference name in userdetail table. </p>\n\n<p>create table page(page_key,page_number,ownerid,creatorid)</p>\n\n<p>create table userdetail(id,fullname,phonenumber)</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13196190,"title":"MySQL - Subtracting value from previous row, group by","body":"<p>I need to have the consumption value base on previous one by SN number.\nThis is my data:</p>\n\n<p>TABLE EnergyLog</p>\n\n<pre><code>SN     Date                 Value\n2380   2012-10-30 00:15:51  21.01\n2380   2012-10-31 00:31:03  22.04\n2380   2012-11-01 00:16:02  22.65\n2380   2012-11-02 00:15:32  23.11\n20100  2012-10-30 00:15:38  35.21\n20100  2012-10-31 00:15:48  37.07\n20100  2012-11-01 00:15:49  38.17\n20100  2012-11-02 00:15:19  38.97\n20103  2012-10-30 10:27:34  57.98\n20103  2012-10-31 12:24:42  60.83\n</code></pre>\n\n<p>This is the result I need:</p>\n\n<pre><code>SN      Date                 Value  consumption\n2380    2012-10-30 00:15:51  21.01  0\n2380    2012-10-31 00:31:03  22.04  1.03\n2380    2012-11-01 00:16:02  22.65  0.61\n2380    2012-11-02 00:15:32  23.11  0.46\n20100   2012-10-30 00:15:38  35.21  0\n20100   2012-10-31 00:15:48  37.07  1.86\n20100   2012-11-01 00:15:49  38.17  1.1\n20100   2012-11-02 00:15:19  38.97  0.8\n20103   2012-10-30 10:27:34  57.98  0\n20103   2012-10-31 12:24:42  60.83  2.85\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":13195741,"title":"SQL query - WHERE not working","body":"<p>I have got this query which works fine:</p>\n\n<pre><code>SELECT p.design_id, p.product_id, t.account_id, p.name, p.width, p.height, \n p.price, t.email \n FROM designs AS p\n INNER JOIN ( SELECT user_id, email, account_id FROM users ) AS t\n USING(user_id) ORDER BY p.design_id LIMIT 0, 300 );\n</code></pre>\n\n<p>Now I am trying to trim the result:</p>\n\n<pre><code>SELECT p.design_id, p.product_id, t.account_id, p.name, p.width, \n p.height, p.price, t.email \n FROM designs AS p\n INNER JOIN ( SELECT user_id, email, account_id FROM users \n WHERE account_id = 0) AS t\n USING(user_id) ORDER BY p.design_id LIMIT 0, 3 );\n</code></pre>\n\n<p>But the second query result is exactly the same as the first one.</p>\n\n<p>Please could somebody shine some light on this?</p>\n\n<p>//UPDATE</p>\n\n<p>I removed the php vaiables to stop the unnecessary confusion :)</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13195279,"title":"SQL mixed number and character type","body":"<p>I have a number of tables in an sqlite3 database which have a <code>cost INT</code> attribute.</p>\n\n<p>I now am in a situation where in one of my tables there are three possible valid values for cost: <code>NULL</code>, a number, or 'X'.</p>\n\n<p>Is there a way to allow entering both numbers and characters into an attribute.</p>\n\n<p>I had considered making cost a <code>CHAR(1)</code> and:</p>\n\n<pre><code>CONSTRAINT ck_cost CHECK (ISNUMERIC(cost) OR cost = 'X')\n</code></pre>\n\n<p>But then I would not be able to set cost values to literal integers, they would have to be placed in quotes (<code>'1'</code> instead of <code>1</code>). This would be inconsistent with my other tables.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":13196572,"title":"Column 'mary' does not exist","body":"<p>i'm doing a simple query here and it returns that column 'Mary' does not exist:</p>\n\n<pre><code>SELECT  telephone.telephonenumber as tel\nFROM    person, telephone\nWHERE   person.idperson = telephone.idperson\nAND person.personname = ‘Mary’;\n</code></pre>\n\n<p>Can someone explain what can be happening? I don't want Mary as a column, but as a value.</p>\n\n<p>Thanks in advance,\nGabriel</p>\n"},{"tags":["sql","oracle","error-handling"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13190059,"title":"ORA-00936 missing expression","body":"<p>The following statement:</p>\n\n<pre><code>INSERT INTO TABLE1(COL_1,COL2) VALUES(SELECT MAX(COL_1) FROM TABLE1), 'XYZ');\n</code></pre>\n\n<p>throws the error:</p>\n\n<pre><code>ERROR at line 1:\nORA-00936: missing expression\n at the select clause. \n1. The table is empty for now.\n2. COL_1 is a primary key intger field.\n</code></pre>\n\n<p>Can you help me please?</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13134638,"title":"getting the first date when record was created","body":"<p>I have a query where I need to display the user that first created a record of customer information.  See my query below:</p>\n\n<pre><code> select CustID, Title, Firstname, Surname, IDNumber, min(ModifyDate) as ModDate, sUsername\nfrom Customers\nwhere StatusCode = 'PI'\ngroup by CustlD,Title,Firstname,Surname,IDNumber,sUsername \n</code></pre>\n\n<p>My result is displayed below:</p>\n\n<pre><code>1    MR    CHARL    8607295    2012-10-23 14:20:31.407   User1\n1    MR    CHARL    8607295    2012-10-24 12:36:09.023   User2\n2    MISS  XABA     8307297    2012-10-23 14:23:08.593   User1\n2    MISS  XABA     8307297    2012-10-24 14:57:29.603   User2\n</code></pre>\n\n<p>I only need the first record and the 3rd record.  Any idea what I'm doing wrong here?</p>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13193665,"title":"Rails select rows from a table where a related table's all rows have a certain value","body":"<p>Basically I have 3 tables. Ignore the syntax. I just wanted to show the idea.</p>\n\n<pre><code>ModelA:\n    belongs_to :ModelB\n\nModelB:\n    has_many: ModelA\n    has_and_belongs_to_many :ModelC\n\nModelC\n    has_and_belongs_to_many :ModelB\n</code></pre>\n\n<p>How can I get all the rows from ModelA where all rows of ModelC have flag = 'Y'?<br>\nI've tried:  </p>\n\n<pre><code>ModelA.joins(:ModelB =&gt; :ModelC).where(\"#{ModelC.table_name}.flag = 'Y'\")\n</code></pre>\n\n<p>and dozen other ways without success. I know the code above doesn't check all the rows, but that's as far as I've got. I would prefer using ActiveRecord.</p>\n"},{"tags":["php","sql","css","select","div"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13195789,"title":"SQL Select, different color depending on result number","body":"<p>I have an SQL SELECT statement and after executing this I have a While statement to display every record in a div. These div are all under one another and I want the divs to alternate in color. So like this:</p>\n\n<pre><code>Result 1 = white div\nResult 2 = grey div\nResult 3 = white div\nResult 4 = grey div.\n</code></pre>\n\n<p>I actually have no idea how to accomplish this, anyone who could help me?\nThanks!</p>\n\n<p>EDIT: I can actually come up with the theory do to this, even numbers white, uneven numbers grey, but how do I code this?</p>\n"},{"tags":["c#","sql","sql-server","linq-to-sql","max"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13196085,"title":"How to do one-select linq-to-sql MAX query?","body":"<p>This code</p>\n\n<pre><code>int maxTrackId = dataContext.TicketTracks.Max(T =&gt; T.TrackId);\n</code></pre>\n\n<p>Generates the following <code>SQL</code> code:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT MAX([t0].[TrackId]) AS [value]\nFROM [dbo].[TicketTracks] AS [t0]\n</code></pre>\n\n<p>But if the table is empty, I got an exception saing that nullable value cannot be assigned to non-nullable variable.</p>\n\n<p>Then I write this code, explicitly telling the SQL provider that i need either maximum or null:</p>\n\n<pre><code>int? maxTrackId = dataContext.TicketTracks.Max(T =&gt; (int?)T.TrackId);\n</code></pre>\n\n<p>And it works fine on that non-nullable SQL column, giving me back either <code>null</code> or the number. But the <code>SQL</code> code generated is kind of strange:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT MAX([t1].[value]) AS [value]\nFROM (\n    SELECT [t0].[TrackId] AS [value]\n    FROM [dbo].[TicketTracks] AS [t0]\n    ) AS [t1]\n</code></pre>\n\n<p>So it seems weird, especially with two <code>SELECT</code>s. Is there any way to circumvent this?</p>\n"},{"tags":["java","sql","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13195841,"title":"how to access columns which are indexed from JAVA code?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6593765/how-to-use-index-in-select-statement\">How to use index in select statement?</a>  </p>\n</blockquote>\n\n\n\n<p>Let me be specific:</p>\n\n<p>I have certain tables x and y created in oracle 10g Database. I have indexed certain columns in my tables for faster retrieval of records using <code>CREATE INDEX</code> statement. </p>\n\n<p>I have Java code which accesses these tables to retrieve data using prepared statement object. However I am unclear on how to retrieve data from these indexed tables. Please help. A code snippet will be really helpful.</p>\n"},{"tags":["sql","sql-server","sql-server-2005","triggers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13195785,"title":"Is it possible for triggers not to fire?","body":"<p>On three different tables I have separate <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code> triggers.</p>\n\n<p>I know positively that they work as expected (tried adding, deleting, updating and confirmed the changes going to log-table). However, it happens that rows are removed or added, without my log tables having any content.</p>\n\n<p>So my question is: Is it possible for instance to add a record without the enabled INSERT trigger being triggered?</p>\n\n<p>This is on SQL Server 2005.</p>\n"},{"tags":["php","sql","cakephp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":210,"score":0,"question_id":3092944,"title":"converting simple query to cake query?","body":"<p>Actually I have 1 query but I am unable to convert it into CakePHP query format.</p>\n\n<pre><code>$result = \"select \n             * from esl_userresults\n           where \n             esl_userresults.esl_songID = esl_lyrics.id \n             and esl_lyrics.song_name like '%\".$esl_keyword.\"%'\" ;\n</code></pre>\n\n<p>When I convert this query into CakePHP it gives an error like:</p>\n\n<pre><code>esl_userresults.esl_songID unknown column. \n</code></pre>\n"},{"tags":["php","sql","cakephp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":157,"score":-3,"question_id":3101190,"title":"How can I convert this simple query to CakePHP?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3092944/converting-simple-query-to-cake-query\">converting simple query to cake query?</a>  </p>\n</blockquote>\n\n\n\n<p>Actually I have 1 query but I am unable to convert it into CakePHP query format.</p>\n\n<pre><code>$result = \"select \n             * from esl_userresults, esl_lyrics\n           where \n             esl_userresults.esl_songID = esl_lyrics.id \n             and esl_lyrics.song_name like '%\".$esl_keyword.\"%'\" ;\n</code></pre>\n\n<p>When I convert this query into CakePHP it gives an error like:</p>\n\n<pre><code>esl_userresults.esl_songID unknown column. \n</code></pre>\n"},{"tags":["sql","null","db2","ibm-midrange"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13190869,"title":"Db2 on AS400 and null values inserted on not nullable columns?","body":"<p>Is there a difference in behaviour of DB2 on AS400 machines when it comes to handling not-nullable columns?</p>\n\n<p>Someone just told me that if you insert a null value into a column with not null, on DB2 as400 it will work (sounds strange I know) , but will throw an error if Db2 is running on Windows.</p>\n\n<p>I am going to verify this as soon as I get hold of the environment, still want to know if someone has ever heard of such a thing.</p>\n\n<p>Closing Note:\nIt was a schema that had changed over time... so the column had changed across releases, which led to the confusion.</p>\n"},{"tags":["sql","excel","adodb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13195696,"title":"ADODB/Excel query error","body":"<p>When I try to use ADODB to connect on an Excel DB, it says:</p>\n\n<pre><code>you try to execute a query without a specified expression &lt;Destinataire&gt;\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n                         &amp; \"WHERE [DateMad] Between #\" _\n                         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n                         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \"\"\n\n                    objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n</code></pre>\n\n<p>What's wrong with it?</p>\n"},{"tags":["sql","sql-server","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13193693,"title":"SSIS Eror: insert values list doesnt match column list","body":"<p>In ssis component OLE DB Command:</p>\n\n<pre><code>insert into D_MAPPING_CLIENTS (ID, DIRECTORY_ID, SOURCE_ID, BASE_ID)\n  values (\n\n     case when exists ( select 1 from D_MAPPING_CLIENTS )\n           then ( select MAX(ID) + 1 from D_MAPPING_CLIENTS )\n\n         else 1\n     end\n\n  , ISNULL(?, \n      case when exists ( select 1 from D_MAPPING_CLIENTS )\n             then ( select MAX(DIRECTORY_ID) + 1 from D_MAPPING_CLIENTS )\n\n           else 1\n       end ) \n\n   , ( select ID from D_SOURCES_CLIENTS where SOURCE = 'D:\\load\\1\\clients.txt' )\n\n   , ?)\n</code></pre>\n\n<p>When I try to save it, i get an error: 'Insert value list does not match column list', although when i run this script in Management Studio it works fine. </p>\n\n<p>What's the problem?</p>\n\n<p>UPD: Where i replace last '?' to some value it works fine :o</p>\n"},{"tags":["php","mysql","sql","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13169425,"title":"Don't want string to be generated if string is in database and contains number at the end","body":"<p>I have a little situation here. If in my database in my \"Session\" Table if I have the data below:</p>\n\n<pre><code>SessionId\n\nC\n</code></pre>\n\n<p>Then what happens with my code is that it would not display the string above when user generates a new string as that it is already in the database. This works fine for example above</p>\n\n<p>The problem I have though is that if I have multiple sessions(exams), then in the database below it will display the strings as below in the database:</p>\n\n<pre><code>SessionId\n\nC1\nC2\nC3\n</code></pre>\n\n<p>The above is for 3 exams. But the problem is that the string \"ADERF\" can still be generated in the code below. What my question is that if there is a number at the end of the string like the table above, then how can I not generate the string as it is still in the database? The strings will always be 5 characters long:</p>\n"},{"tags":["java","sql","spring","parameters","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":11786534,"title":"Spring MVC 3.0 Getting Values Out From Sql Query","body":"<p>I am very new to using Spring MVC 3.0 and i am writing a custom authentication class and i would like to know how i can extract the values from an sql query into variables so i can do a comparison under is an example of what i am trying to achieve and some code is omitted which i am asking about;</p>\n\n<pre><code>import java.sql.ResultSet;\nimport java.sql.SQLException;\n\nimport org.apache.log4j.Logger;\nimport org.springframework.jdbc.core.simple.ParameterizedRowMapper;\nimport org.springframework.jdbc.core.support.JdbcDaoSupport;\n\nimport com.crimetrack.DAO.LoginDAO;\nimport com.crimetrack.business.Login;\n\npublic class JdbcLoginDAO extends JdbcDaoSupport implements LoginDAO {\n\n    private final Logger logger = Logger.getLogger(getClass()); \n    String dbUserName;\n    String dbPassword;\n\n    public boolean AuthenticateUser(Login login) {\n        logger.debug(\"Authenticating User\");\n\n        String sql = \"SELECT userName, password FROM tblofficers WHERE userName = :userName AND password = :password \";\n\n        //code for parameters : userName and password using login.getPassword() and login.getUsername()\n        //and code to get vaules out from query for comparison\n\n\n        if (dbUserName == login.getUserName()) {\n\n            if (dbPassword == login.getPassword()){\n                return true;\n            }\n        }\n\n        return false;\n\n    }\n\n\n    public static class LoginMapper implements ParameterizedRowMapper&lt;Login&gt;{\n\n         public Login mapRow(ResultSet rs, int rowNum) throws SQLException {\n                Login dbLogin = new Login();\n                dbLogin.setUserName(rs.getString(\"userName\"));\n                dbLogin.setPassword(rs.getString(\"password\"));\n                return dbLogin;\n            }       \n    }\n\n}\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13194630,"title":"SQL Server 2005 : conversion failed when converting the varchar value '0.00' to data type int","body":"<p>When adding this line into my query:</p>\n\n<pre><code>convert(varchar(20), convert(varchar(20),\nsum(case when tsr.other like '%aa%' then tsr.block1 else 0 end) +\nsum(case when tsr.other like '%aa%' then tsr.block2 else 0 end) +\nsum(case when tsr.other like '%aa%' then tsr.block3 else 0 end) +\nsum(case when tsr.other like '%aa%' then tsr.block4 else 0 end)) * 450) \n</code></pre>\n\n<p>I get this error message:</p>\n\n<blockquote>\n  <p><em>Conversion failed when converting the varchar value '0.00' to data\n  type int</em></p>\n</blockquote>\n\n<p>Data in block column is days - e.g. <code>10.0</code></p>\n\n<p>Any ideas?</p>\n\n<p>i've got it fixed, it was just changing the 450 to 450.0.</p>\n\n<p>The reason for the varchars is that this is just 1 line from 1 of multiple unioned select statements. </p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13192736,"title":"writing a Select query to deduct one table from another","body":"<p>I am just a little confuse to how write the below query :</p>\n\n<p>I have two tables</p>\n\n<pre><code>tbl_one\nID      TEXT\n1       test1\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tbl_two\nID      userID      tblone_ID\n1       50          1\n2       100         1\n3       100         2\n</code></pre>\n\n<p>I am looking to get rows of tbl_one which are not appear in tbl_two but for the certain user .</p>\n\n<p>for example by below select  :</p>\n\n<pre><code>select * from tbl_one, tbl_two \nwhere (tbl_two.tblone_ID !=tbl_one.ID and tbl_two.userID==50) \n</code></pre>\n\n<p>my desire resault will be </p>\n\n<pre><code>Desire resalt:\nID      TEXT\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","query","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13189390,"title":"Rails select and sort by aggregate of has_many","body":"<p>I have a Course model which has_many reviews. My Review model has a rating field. What I would like is a query to find the top rated courses. I want to do this in the SQL in order to avoid returning all the course objects and then trying to rank and sort them.</p>\n"},{"tags":["mysql","sql","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13195501,"title":"mySQL query using two tables","body":"<p>I have one table (config) with the field 'type' in and another table (users) with the field 'status' in.</p>\n\n<p>Some values for the field 'status' are blank.</p>\n\n<p>I want to change the field 'status' to 'applied' ONLY if the field 'type' in the other table equals '3'.</p>\n\n<p>Can you please explain how to do this query?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":109,"score":-1,"question_id":13193996,"title":"show multiple choice questions with answers to user","body":"<p>i have a problem about displaying multiple choice questions to user. i have the following tables:</p>\n\n<p><strong>multiple_choice_questions</strong> (quiz_id, question,c_answer) \nthis table have the questions with the right answers</p>\n\n<p><strong>multiple_choice_answers</strong> (answer_id, quiz_id,answer)\nthis table have the answers with the foreign key quiz_id</p>\n\n<p><strong>multiple_choice_info</strong> (info_id,quiz_id,name,class, lesson, subject, notes,date)\nhere are basic informations for each quiz which actually helps in choosing the appropriate quiz from the user. e.g. if a user puts as lesson mathematics it show the tests with \"lesson\" mathematics</p>\n\n<p>i want to display for example 10 random questions with their answers. note that each questions has plurality of different answers. e.g. question 1 have 3 different answers. question 2, 5 different answers. </p>\n\n<p>i made an effort to catch the data related with the quiz_id but this method is wrong. im new in php, mysql. </p>\n\n<pre><code>&lt;?php\ninclude('../connect_db.php');\n\n$sql = \"select * from multiple_choice_questions\ninner join multiple_choice_answers on (multiple_choice_questions.quiz_id =      multiple_choice_answers.quiz_id)\ninner join multiple_choice_info on (multiple_choice_questions.quiz_id = multiple_choice_info.quiz_id)\";\n$myData3 = mysql_query($sql);\nwhile($row = mysql_fetch_array($myData3)) {\necho '&lt;input type=\"text\" value=\"'.$row['question'].'\" name=\"q'.$row['quiz_id'].'\"/&gt;&lt;br&gt;';\necho '&lt;input type=\"radio\" value=\"'.$row['answer'].'\" name=\"q'.$row['answer'].'\"/&gt;\"'.$row['answer'].'\"';\n\n}\n?&gt;     \n</code></pre>\n"},{"tags":["sql","postgresql","many-to-many"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13179785,"title":"Uniqueness in many-to-many","body":"<p>I couldn't figure out what terms to google, so help tagging this question or just pointing me in the way of a related question would be helpful.</p>\n\n<p>I believe that I have a typical many-to-many relationship:</p>\n\n<pre><code>CREATE TABLE groups (\n  id integer PRIMARY KEY);\n\nCREATE TABLE elements (\n  id integer PRIMARY KEY);\n\nCREATE TABLE groups_elements (\n  groups_id integer REFERENCES groups,\n  elements_id integer REFERENCES elements,\n  PRIMARY KEY (groups_id, elements_id));\n</code></pre>\n\n<p>I want to have a constraint that there can only be one groups_id for a given set of elements_ids.</p>\n\n<p>For example, the following is valid:</p>\n\n<pre><code>groups_id | elements_id\n        1 | 1\n        1 | 2\n        2 | 2\n        2 | 3\n</code></pre>\n\n<p>The following is not valid, because then groups 1 and 2 would be equivalent.</p>\n\n<pre><code>groups_id | elements_id\n        1 | 1\n        1 | 2\n        2 | 2\n        2 | 1\n</code></pre>\n\n<p>Not every subset of elements must have a group (this is not the power set), but new subsets may be formed.  I suspect that my design is incorrect since I'm really talking about adding a group as a single entity.</p>\n\n<p>How can I create identifiers for subsets of elements without risk of duplicating subsets?</p>\n"},{"tags":["mysql","sql","comma"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":83,"score":-1,"question_id":13194711,"title":"Find distinct values from comma separated text column of mysql","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3653462/is-storing-a-comma-separated-list-in-a-database-column-really-that-bad\">Is storing a comma separated list in a database column really that bad?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a mysql db column of comma separated text:</p>\n\n<pre><code>  id  keys\n ------------\n  1  Key1, Key2\n  2  key3\n  3  key2, key3, key4\n  4  key5, key2\n</code></pre>\n\n<p><strong>Question 1</strong></p>\n\n<p>I need results like this:</p>\n\n<pre><code>id    keys\n----------\n1    Key1\n2    Key2\n3    key3\n4    key4\n5    key5\n</code></pre>\n\n<p><strong>Question 2</strong></p>\n\n<p>Also I need a second query to match the above condition. eg.</p>\n\n<p>select all the rows with <code>key2</code></p>\n\n<p>Output should be</p>\n\n<pre><code>id\n---\n1\n4\n</code></pre>\n\n<p><strong>NOTE:</strong> Only in a single query, no stored procedures, no functions.</p>\n\n<p>I have seen similar questions but with not the desired answer.</p>\n\n<p><strong>NOTE :</strong> Thanks for suggesting that data should not be stored in a comma seprated field.\n<strong>But I have not developed the system and database. I am just about to do a samll upgradation.</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13192667,"title":"Is there a Performance difference when we SET Encryption on Database ON and OFF?","body":"<p>I am just wondering to whether is there any performance difference in sprocs and inline queries when DB encryption is set to ON and OFF?</p>\n\n<p>If yes,could you please explain me in detail when the performance is good and when its bad?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","delete"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13195373,"title":"Delete where email is not a known email client","body":"<p>I'm trying to delete records from a table that is getting to much spam. So, the idea is delete all records that don't have email from hotmail, gmail or yahoo. But my sql looks like is returning some hotmail records:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT *\nFROM `users`\nWHERE email NOT LIKE '*hotmail.com*'\nAND email NOT LIKE '*gmail.com*'\nAND email NOT LIKE '*ymail.com*'\n</code></pre>\n\n<p>Applying the <code>OR</code> condition returns the same result. Can you guide to the right direction?</p>\n"},{"tags":["sql","jdbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13195360,"title":"Second ResultSet.next() reporting true but while loop existing","body":"<p>While using a JDBC connection I am trying to perform 2 SELECT statements. The first returns a single record from a table (SQL_IBGN), and the second is designed to return multiple records from another table (SQL_ITXN) using a column (BGNREF) from the first query.</p>\n\n<p>I have separate Statement and ResultSet objects for each query.</p>\n\n<p>Code for Query 1:</p>\n\n<pre><code>    Statement stmt = con.createStatement();\n    String sql = \"SELECT BGNREF..... FROM SQL_IBGN WHERE BGNREF LIKE '2306009';\";\n    ResultSet rs = stmt.executeQuery(sql);\n    String bgnref = null;\n    while (rs.next()) {\n        G1SQL_IBGN g1rec = new G1SQL_IBGN();\n        bgnref = rs.getString(1);\n        g1rec.setBGNREF(bgnref);\n    }\n</code></pre>\n\n<p>Code for Query 2:</p>\n\n<pre><code>        if (bgnref != null) {\n        Statement stmt1 = con.createStatement();\n        String sql1 = \"SELECT ACT_DESC...... SQL_ITXN WHERE BGNREF LIKE '\"\n                + bgnref + \"';\"; // Execute the SELECT statement ResultSet\n        ResultSet rs1 = stmt1.executeQuery(sql1); // Get result of first five records\n        while (rs1.next()) {\n            G1SQL_ITXN g1itxn = new G1SQL_ITXN();\n            g1itxn.setACT_DESC(rs1.getString(1));\n        }\n    }\n</code></pre>\n\n<p>The first query is returning a single record, however even though rs1.next() = true, the second while loop, while (rs1.next()) is not executed.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13191768,"title":"How to make two records from one?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning, and so on\n1   2012-01-01          2               3   \n2   2012-01-01          2               2 \n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning\n1   2012-01-01          2               NULL          2\n1   2012-01-01          NULL            3             2\n2   2012-01-01          2               2 \n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","rollback"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13188621,"title":"roll back SQL query executed by mistake","body":"<p>I think the question says it all,\nthe following update query has been executed - by mistake - in SQL Server management studio</p>\n\n<pre><code>update kms_students set student_campus='4' where student_campus='KL'\n</code></pre>\n\n<p>The effected rows are more than 1000, and i can't identify it since that table is already have the <code>student_campus='4'</code> for many previous rows.</p>\n\n<p>Is it possible to roll back?</p>\n"},{"tags":["sql","oracle-apex","multiple-columns","tabular-form"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12952346,"title":"How to update selected rows only in Oracle SQL","body":"<p>So basically I have a tabular form. One of the columns is a checkbox, another column is called 'hidden' and will contain either the value 'yes' or 'no'. </p>\n\n<p>I have a button for hiding rows, so the user should be able to select certain rows using the checkboxes, then click the hide button and it should change the rows that the user has selected to 'yes' under the 'hidden' column</p>\n\n<p>So my SQL looks like this:</p>\n\n<pre><code>UPDATE nameOfTable\nSET hidden = 'Yes'\nWHERE hidden = 'No';\n</code></pre>\n\n<p>Obviously this will just update the 'hidden' column to 'yes' for all rows that are currently 'no' but how do I instead make it to just update the rows that user has selected using the checkboxes?</p>\n"},{"tags":["php","sql","yii","geospatial","point"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13182573,"title":"Yii Framework handling Geospatial data","body":"<p>I am new to the Yii Framework and I have a database table that stores locations as Geospatial point objects. I am using the code generation tools to generate forms that update/ add to the database. However, these forms don't handle the location field properly. I have been struggling to figure out how this works. The solution mentioned <a href=\"http://stackoverflow.com/questions/12535245/how-do-i-insert-a-mysql-spatial-point-with-a-yii-model\">in this post</a> does not help.</p>\n\n<p>I would appreciate it if anyone could link me to a tutorial on how to handle geospatial point objects within a yii model. I feel like this must be a really easy solution but I cannot seem to get my head around it. The source code for my model, form and controller are provided below:</p>\n\n<p>Model</p>\n\n<pre><code>&lt;?php\n\n/**\n * This is the model class for table \"store\".\n *\n * The followings are the available columns in table 'store':\n * @property integer $id\n * @property string $name\n * @property string $location\n */\nclass Store extends CActiveRecord\n{\n    /**\n     * Returns the static model of the specified AR class.\n     * @param string $className active record class name.\n     * @return Store the static model class\n     */\n    public static function model($className=__CLASS__)\n    {\n        return parent::model($className);\n    }\n\n    /**\n     * @return string the associated database table name\n     */\n    public function tableName()\n    {\n        return 'store';\n    }\n\n    /**\n     * @return array validation rules for model attributes.\n     */\n    public function rules()\n    {\n        // NOTE: you should only define rules for those attributes that\n        // will receive user inputs.\n        return array(\n            array('id, name, location', 'required'),\n            array('id', 'numerical', 'integerOnly'=&gt;true),\n            // The following rule is used by search().\n            // Please remove those attributes that should not be searched.\n            array('id, name, location', 'safe', 'on'=&gt;'search'),\n        );\n    }\n\n    /**\n     * @return array relational rules.\n     */\n    public function relations()\n    {\n        // NOTE: you may need to adjust the relation name and the related\n        // class name for the relations automatically generated below.\n        return array(\n        );\n    }\n\n    /**\n     * @return array customized attribute labels (name=&gt;label)\n     */\n    public function attributeLabels()\n    {\n        return array(\n            'id' =&gt; 'ID',\n            'name' =&gt; 'Name',\n            'location' =&gt; 'Location',\n        );\n    }\n\n    /**\n     * Retrieves a list of models based on the current search/filter conditions.\n     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.\n     */\n    public function search()\n    {\n        // Warning: Please modify the following code to remove attributes that\n        // should not be searched.\n\n        $criteria=new CDbCriteria;\n\n        $criteria-&gt;compare('id',$this-&gt;id);\n        $criteria-&gt;compare('name',$this-&gt;name,true);\n        $criteria-&gt;compare('location',$this-&gt;location,true);\n\n        return new CActiveDataProvider($this, array(\n            'criteria'=&gt;$criteria,\n        ));\n    }\n}\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>&lt;?php\n\nclass StoreController extends Controller\n{\n    /**\n     * @var string the default layout for the views. Defaults to '//layouts/column2', meaning\n     * using two-column layout. See 'protected/views/layouts/column2.php'.\n     */\n    public $layout='//layouts/column2';\n\n    /**\n     * @return array action filters\n     */\n    public function filters()\n    {\n        return array(\n            'accessControl', // perform access control for CRUD operations\n            'postOnly + delete', // we only allow deletion via POST request\n        );\n    }\n\n    /**\n     * Specifies the access control rules.\n     * This method is used by the 'accessControl' filter.\n     * @return array access control rules\n     */\n    public function accessRules()\n    {\n        return array(\n            array('allow',  // allow all users to perform 'index' and 'view' actions\n                'actions'=&gt;array('index','view'),\n                'users'=&gt;array('*'),\n            ),\n            array('allow', // allow authenticated user to perform 'create' and 'update' actions\n                'actions'=&gt;array('create','update'),\n                'users'=&gt;array('@'),\n            ),\n            array('allow', // allow admin user to perform 'admin' and 'delete' actions\n                'actions'=&gt;array('admin','delete'),\n                'users'=&gt;array('admin'),\n            ),\n            array('deny',  // deny all users\n                'users'=&gt;array('*'),\n            ),\n        );\n    }\n\n    /**\n     * Displays a particular model.\n     * @param integer $id the ID of the model to be displayed\n     */\n    public function actionView($id)\n    {\n        $this-&gt;render('view',array(\n            'model'=&gt;$this-&gt;loadModel($id),\n        ));\n    }\n\n    /**\n     * Creates a new model.\n     * If creation is successful, the browser will be redirected to the 'view' page.\n     */\n    public function actionCreate()\n    {\n        $model=new Store;\n\n        // Uncomment the following line if AJAX validation is needed\n        // $this-&gt;performAjaxValidation($model);\n\n        if(isset($_POST['Store']))\n        {\n            $model-&gt;attributes=$_POST['Store'];\n            if($model-&gt;save())\n                $this-&gt;redirect(array('view','id'=&gt;$model-&gt;id));\n        }\n\n        $this-&gt;render('create',array(\n            'model'=&gt;$model,\n        ));\n    }\n\n    /**\n     * Updates a particular model.\n     * If update is successful, the browser will be redirected to the 'view' page.\n     * @param integer $id the ID of the model to be updated\n     */\n    public function actionUpdate($id)\n    {\n        $model=$this-&gt;loadModel($id);\n\n        // Uncomment the following line if AJAX validation is needed\n        // $this-&gt;performAjaxValidation($model);\n\n        if(isset($_POST['Store']))\n        {\n            $model-&gt;attributes=$_POST['Store'];\n            if($model-&gt;save())\n                $this-&gt;redirect(array('view','id'=&gt;$model-&gt;id));\n        }\n\n        $this-&gt;render('update',array(\n            'model'=&gt;$model,\n        ));\n    }\n\n    /**\n     * Deletes a particular model.\n     * If deletion is successful, the browser will be redirected to the 'admin' page.\n     * @param integer $id the ID of the model to be deleted\n     */\n    public function actionDelete($id)\n    {\n        $this-&gt;loadModel($id)-&gt;delete();\n\n        // if AJAX request (triggered by deletion via admin grid view), we should not redirect the browser\n        if(!isset($_GET['ajax']))\n            $this-&gt;redirect(isset($_POST['returnUrl']) ? $_POST['returnUrl'] : array('admin'));\n    }\n\n    /**\n     * Lists all models.\n     */\n    public function actionIndex()\n    {\n        $dataProvider=new CActiveDataProvider('Store');\n        $this-&gt;render('index',array(\n            'dataProvider'=&gt;$dataProvider,\n        ));\n    }\n\n    /**\n     * Manages all models.\n     */\n    public function actionAdmin()\n    {\n        $model=new Store('search');\n        $model-&gt;unsetAttributes();  // clear any default values\n        if(isset($_GET['Store']))\n            $model-&gt;attributes=$_GET['Store'];\n\n        $this-&gt;render('admin',array(\n            'model'=&gt;$model,\n        ));\n    }\n\n    /**\n     * Returns the data model based on the primary key given in the GET variable.\n     * If the data model is not found, an HTTP exception will be raised.\n     * @param integer the ID of the model to be loaded\n     */\n    public function loadModel($id)\n    {\n        $model=Store::model()-&gt;findByPk($id);\n        if($model===null)\n            throw new CHttpException(404,'The requested page does not exist.');\n        return $model;\n    }\n\n    /**\n     * Performs the AJAX validation.\n     * @param CModel the model to be validated\n     */\n    protected function performAjaxValidation($model)\n    {\n        if(isset($_POST['ajax']) &amp;&amp; $_POST['ajax']==='store-form')\n        {\n            echo CActiveForm::validate($model);\n            Yii::app()-&gt;end();\n        }\n    }\n}\n</code></pre>\n\n<p>form:</p>\n\n<pre><code>&lt;?php\n/* @var $this StoreController */\n/* @var $model Store */\n/* @var $form CActiveForm */\n?&gt;\n\n&lt;div class=\"form\"&gt;\n\n&lt;?php $form=$this-&gt;beginWidget('CActiveForm', array(\n    'id'=&gt;'store-form',\n    'enableAjaxValidation'=&gt;false,\n)); ?&gt;\n\n    &lt;p class=\"note\"&gt;Fields with &lt;span class=\"required\"&gt;*&lt;/span&gt; are required.&lt;/p&gt;\n\n    &lt;?php echo $form-&gt;errorSummary($model); ?&gt;\n\n    &lt;div class=\"row\"&gt;\n        &lt;?php echo $form-&gt;labelEx($model,'id'); ?&gt;\n        &lt;?php echo $form-&gt;textField($model,'id'); ?&gt;\n        &lt;?php echo $form-&gt;error($model,'id'); ?&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row\"&gt;\n        &lt;?php echo $form-&gt;labelEx($model,'name'); ?&gt;\n        &lt;?php echo $form-&gt;textArea($model,'name',array('rows'=&gt;6, 'cols'=&gt;50)); ?&gt;\n        &lt;?php echo $form-&gt;error($model,'name'); ?&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row\"&gt;\n        &lt;?php echo $form-&gt;labelEx($model,'location'); ?&gt;\n        &lt;?php echo $form-&gt;textField($model,'location'); ?&gt;\n        &lt;?php echo $form-&gt;error($model,'location'); ?&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row buttons\"&gt;\n        &lt;?php echo CHtml::submitButton($model-&gt;isNewRecord ? 'Create' : 'Save'); ?&gt;\n    &lt;/div&gt;\n\n&lt;?php $this-&gt;endWidget(); ?&gt;\n\n&lt;/div&gt;&lt;!-- form --&gt;\n</code></pre>\n\n<p>This is a screenshot of what happens when I try to add row to the store table from the auto generated form:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Owp2b.png\" alt=\"error\"></p>\n\n<p>This is expected as a point object has to be constructed from the latitude and longitude. I do not know how to incorporate this into the Yii model.\nThanks in advance for any help provided!</p>\n"},{"tags":["c#","asp.net","sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13194185,"title":"How to display uploaded files in GridView and download them on clicking respective download linkbutton?","body":"<p>I am uploading files using fileupload, the details of the file such as file type, name of file, and complete path is getting stored in a table called exceldetails in database now i want to display the uploaded files and download them by clicking on a link button next to every file in GridView. This is how i am uploading files:</p>\n\n<pre><code>        string[] filePaths;\n    string strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();\n    string strFileName = FileUpload1.PostedFile.FileName.ToString();\n    FileUpload1.SaveAs(Server.MapPath(\"~/Import/\" + strFileName + strFileType));\n    string strNewPath = Server.MapPath(\"~/Import/\" + strFileName + strFileType);\n    string strNewPath1 = Server.MapPath(\"~/Import/\" + strFileName + strFileType).ToString();\n    fileSize = FileUpload1.PostedFile.ContentLength / 1024;\n\n    //EXCEL DETAILS TABLE\n    con.Open();\n    //=========================================\n    DataTable dt8 = new DataTable();\n    SqlCommand cmd8 = new SqlCommand(\"insert into exceldetails (name,type,details,size,path)\" + \"values(@name,@type,@details,@size,@path)\", con);\n    cmd8.Parameters.Add(\"@name\", SqlDbType.VarChar).Value = strFileName;\n    cmd8.Parameters.Add(\"@type\", SqlDbType.VarChar).Value = strFileType;\n    cmd8.Parameters.Add(\"@details\", SqlDbType.VarChar).Value = DateTime.Now;\n    cmd8.Parameters.Add(\"@size\", SqlDbType.Int).Value = fileSize;\n    cmd8.Parameters.Add(\"@path\", SqlDbType.NVarChar).Value = strNewPath;\n    cmd8.ExecuteNonQuery();\n    con.Close();\n    try\n    {\n        SqlDataAdapter da8 = new SqlDataAdapter(cmd8);\n        da8.Fill(dt8);\n    }\n    catch { }\n</code></pre>\n\n<p>I am a beginner as you can judge from the question itself so please tell me where i need to add what in detail</p>\n"},{"tags":["javascript","sql","sqlite","node.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12797332,"title":"SQLite SELECT * FROM table WHERE id=? Troubles","body":"<p>There's a gap in my knowledge here and I can't find the answer on the internet.</p>\n\n<p>Basically I'm making a node.js app that pushes entries from an SQLite Database using socket.io. </p>\n\n<p>I'm using the implementation of SQLite here -> <a href=\"https://github.com/developmentseed/node-sqlite3\" rel=\"nofollow\">https://github.com/developmentseed/node-sqlite3</a></p>\n\n<p>I'm trying to execute the statement:</p>\n\n<pre><code>db.serialize(function() {\n        db.run(\"SELECT * FROM messages WHERE id=?\", messageNum, function(err, row) {\n            console.log(row.id);            \n        });\n    });\n</code></pre>\n\n<p>I can't find documentation. It's throwing this error at the moment:</p>\n\n<p>Cannot read property 'id' of undefined</p>\n\n<p>I basically guessed the syntax... Anyone know what it actually is?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have got around the problem with an extremely inefficient solution for now:</p>\n\n<pre><code>db.serialize(function() {\n\n        db.each(\"SELECT id, msg, date FROM messages\", function(err, row) {\n            if(row.id === messageNum){\n                console.log(row.id);    \n            }\n        });\n\n    });\n</code></pre>\n\n<p>Would be good if someone could point me in the right direction at some point though, thanks.</p>\n"},{"tags":["android","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":7118270,"title":"Need find the number of days by taking date differnce in sqlite android","body":"<p>I need to get the no of days by taking the date difference of one date confirmation date hard coded value and other with current date in sqlite.</p>\n"},{"tags":["mysql","sql","phpmyadmin","whitespace","search-and-replace"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13194830,"title":"Remove double space in phpmyadmin","body":"<p>I need to remove the any double space (two spaces) that comes anywhere in the text in one my database tables..</p>\n\n<p>I tried:</p>\n\n<pre><code>update items set description= replace(description, '  ', ' ')\n</code></pre>\n\n<p>but this removes if it is only the spaces..  but the \"description\" cells has many words like: \"any&nbsp;text&nbsp;here&nbsp;&nbsp;more\", so I need to remove the two spaces before the word \"more\" at the example before, and leave everything else as is..  just replace the double space with one space anywhere.</p>\n"},{"tags":["sql","sqlite","group-by","aggregate-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13173445,"title":"Aggregation function for sqlite","body":"<p>Execute below script for create test table.</p>\n\n<pre><code>create table if not exists t1 (id1 int,id2 int);\n</code></pre>\n\n<p>Now, table is created, and it is empty table.</p>\n\n<p>Execute below script,</p>\n\n<pre><code>select max(id1), max(id2) from t1\n</code></pre>\n\n<p>It will return below result(one row).</p>\n\n<pre><code>max(id1)      max(id2)\n-----------   --------\n&lt;null&gt;        &lt;null&gt;\n</code></pre>\n\n<p>Execute below script,</p>\n\n<pre><code>select max(id1), max(id2) from t1 group by id1,id2\n</code></pre>\n\n<p>It will return below result(no result).</p>\n\n<pre><code>max(id1)      max(id2)\n-----------   --------\n</code></pre>\n\n<p>Is there somebody explain the reason?</p>\n"},{"tags":["php","sql","row"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":116,"score":-2,"question_id":8650351,"title":"Why isn't SQL showing the table row?","body":"<p>I clearly made an account on <code>register.php</code>. Then, when I test the code in the SQL section, I get rows 0 - 0 shown (one total, query took 0.0010&nbsp;sec). Even though there is an account it's returning that there is none.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>&lt;?php\n    $db_host = \"localhost\";\n    $db_username = \"izzydog\";\n    $db_name = \"challenge1\";\n    $db_password = \"********\";\n    $tbl_name = \"database1\"; // Table name]\n    $database1 = 'database1';\n\n    // Connect to server and select database.\n    $conn = mysql_connect(\"localhost\", \"izzydog\", \"********\") or die(\"cannot connect\");\n    mysql_select_db(\"challenge1\",$conn)or die(\"cannot select DB\");\n\n    // Username and password sent from form\n    $myusername = $_POST['myusername'];\n    $mypassword = $_POST['mypassword'];\n\n    // To protect MySQL injection (more details about MySQL injection)\n    $myusername = stripslashes($myusername);\n    $mypassword = stripslashes($mypassword);\n    $myusername = mysql_real_escape_string($myusername);\n    $mypassword = mysql_real_escape_string($mypassword);\n\n    $sql = \"SELECT * FROM $database1 WHERE username='$myusername' AND password='$mypassword'\";\n    $result = mysql_query($sql);\n\n    // Mysql_num_row is counting table row\n    $count = mysql_num_rows($result);\n    // If result matched $myusername and $mypassword, table row must be 1 row\n\n    if ($count == 1) {\n        session_register('myusername');\n        session_register('mypassword');\n        header('location:login_success.php');\n    }\n    else {\n        echo 'Wrong Username or Password';\n    }\n?&gt;\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13195060,"title":"why sql query causes General error: 3 Error writing file '/tmp/MYzamaNT' (Errcode: 28) in mysql","body":"<p>This query:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        GROUP_CONCAT( DISTINCT t1.value SEPARATOR '|' ) AS 'Colors', GROUP_CONCAT( DISTINCT t2.value SEPARATOR '|' ) AS 'Languages'\nFROM `subscribers`\nLEFT JOIN `subscribers_multivalued` AS `t1` ON subscribers.subscriber_id = t1.subscriber_id AND t1.field_id = 112\nLEFT JOIN `subscribers_multivalued` AS `t2` ON subscribers.subscriber_id = t2.subscriber_id AND t2.field_id = 111\nWHERE (list_id = 40) AND (state = 1)\nGROUP BY `subscribers`.`email_address` , `subscribers`.`first_name` , `subscribers`.`last_name`\n</code></pre>\n\n<p>With execute plan:</p>\n\n<pre><code>id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n1   SIMPLE  subscribers     ref     FK_list_id,state_date_added     FK_list_id  4   const   1753610     Using where; Using filesort\n1   SIMPLE  t1  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n1   SIMPLE  t2  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n</code></pre>\n\n<p>Caused error: General error: 3 Error writing file '/tmp/MYzamaNT' (Errcode: 28) in mysql.\nThere was 4 Gb of disk space, then we increase disk space and there is not error, but mysql consumes about 5 Gn space during execution of query (one could see df -H on linux) and query was very slow.\nThis query is use for exporting from one of the list. The exported data in the file is about 50 Mb.  During query mysql write large temp files.\nWhy doesn't this query cosume so much disk space?</p>\n"},{"tags":["c#","sql","winforms","dataset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13193827,"title":"how to add dataset values to sql","body":"<p>I am new to SQL (started today itself), how to add data of dataset to the database table when the table in database has the first column as automatic generating numbers i.e., (IDENTITY (1,1))</p>\n\n<p>I have DataSet something like this</p>\n\n<pre><code>  name    age    location\n\n   x      30       yyy\n   y      20       ppp\n</code></pre>\n\n<p>The table in Database is something like this</p>\n\n<pre><code>  Id(auto)   name    age    location\n\n  --------  no data  --------------\n</code></pre>\n\n<p>First of all I am filling the Dataset from the database table.<br>\nSince the first column is autogenerated I cant even add new values to DataSet.\nIf I say </p>\n\n<pre><code> dsMainDoctors.Tables[0].Rows.Add( /* first column is autogenerated so I am leaving it*/\n                secondColumn,\n                thirdColumn,\n                fourthColumn,\n                FifthColumn);\n</code></pre>\n\n<p>Error --> Input string was not in a correct format.Couldn't store  in Doctor_ID Column.  Expected type is Int32.</p>\n\n<p>The code I am trying is: (<em>When I given the first column value manually in the DataSet</em>)</p>\n\n<pre><code>        SqlConnection conn = new SqlConnection(strConn);\n        SqlCommand cmd = new SqlCommand(strQuery, conn);\n        SqlDataAdapter da = new SqlDataAdapter(cmd);\n        conn.Open();\n        da.Update(ds.Tables[0]);  //ERROR :- Update requires a valid InsertCommand when passed DataRow collection with new rows.\n        conn.Close();\n        conn.Dispose();\n        cmd.Dispose();\n</code></pre>\n\n<hr>\n\n<pre><code> strQuery --&gt; \"delete from [dbo].[\" + table_name + \"]\";\n</code></pre>\n\n<p>I could have searched this before asking but I dont know what keywords I should use<br>\nPlease answer in comments if it is very easy question.</p>\n"},{"tags":["sql","database","vb.net","dbf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":195,"score":0,"question_id":11234298,"title":"SQL/DBF Updating records from one table to another table located in different folder (*.dbf)","body":"<p>Updating records from one table to another table located in different folder.</p>\n\n<pre><code>Dim connection As New ADODB.Connection\nDim strConnection As String\nDim pathPrincipal As String\nDim pathUpdate As String 'External data base to update with TablePrincipal\nDim strSQL As String\n\npathPrincipal = \"D:\\DBFs\"\nstrConnection = \"Driver={Microsoft dBASE Driver (*.dbf)};DriverID=277;Dbq=\" &amp; PathPrincipal \n\nconnection.Open strConnection\nIf connection.State &lt;&gt; adStateOpen Then Exit Sub\n</code></pre>\n\n<p>'Correct :)</p>\n\n<pre><code>strSQL=\"UPDATE TablePrincipal#DBF\" &amp; \" A INNER JOIN \" &amp; \"TableUpdate#DBF\" &amp; \" B ON A.ID = B.ID SET A.X=B.X, A.Y=B.Y\"\n'Execute \nconnection.Execute strSQL, n, adCmdText\n</code></pre>\n\n<p>PREVIOUS CODE WORKS TO PERFECTION.....</p>\n\n<p>BUT MY PROBLEM IS WHEN BOTH DBF NOT IN THE SAME FOLDER BUT I AM TRYING THIS IS NOT WHAT ELSE DO</p>\n\n<pre><code>'No working for external DBF :'( :(\nstrSQL = \"UPDATE TablePrincipal#DBF A INNER JOIN\" &amp; _\n         \" OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)}; DBQ=\" &amp; _\n         pathUpdate &amp; \"; SourceType = DBF ','SELECT * FROM TableUpdate#DBF') B\" &amp; _\n         \" ON A.ID=B.ID SET A.X=B.X, A.Y=B.Y\"\n</code></pre>\n\n<p>ANYONE CAN HELP ME.....PLEASEEEE!!!! HELP\nAPOLOGIES FOR MY ENGLISH :)</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":5151,"score":0,"question_id":4712809,"title":"MySQL remove duplicate rows","body":"<p>I have a comments table, whose structure is as:</p>\n\n<pre><code>id, name, email, comment\n</code></pre>\n\n<p>I have many duplicate comments, with same name and email. I need to remove them, can anyone suggest me how can I achieve this using a single query?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql","database","dbf","elevatedb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":11265333,"title":"How to Import Data from .DBF file to Some Other Database like ElevateDB?","body":"<p>I have large file say named as \"customers\" and it is in .DBF format. Now I want to import that .DBF file data to ElevateDB database. ,,,Is ther any ways to import data by Query or write program for import from .DBF to ElevateDB...</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13187663,"title":"Oracle SQL - Putting together potentially contradictory or overlapping date ranges","body":"<p>I have a table like this:</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     05-JAN-12\n1     01-FEB-12     01-MAR-12\n1     15-FEB-12     05-MAR-12\n</code></pre>\n\n<p>For a given Id, it gives a set of date ranges. Let's say that if a date is between the begin and end date for that Id, then that Id is \"on\". Otherwise, \"off\"</p>\n\n<p>The problem here is these last two rows -- the date ranges overlap and contradict each other. The second row claims that the 1 was \"on\" between 01-FEB-12 and 01-MAR-123, but the third row claims that 1 was off before before 14-FEB-12. Similarly, the second row claims that 1 was off on 02-MAR-12, but row 3 claims it was on.</p>\n\n<p>The reconciliation logic I'd like to apply is that, in cases of contradictions, pick the earliest possible begin date and the earliest possible end date after it. The result would therefore be:</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     05-JAN-12\n1     01-FEB-12     01-MAR-12\n</code></pre>\n\n<p>I was able to pull this off with the lag analytical function, but I ran into difficulty with other use cases. Take this input data set.</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     10-JAN-12\n1     5-JAN-12      8-JAN-12\n1     12-JAN-12     15-JAN-12\n1     1-JAN-12      14-JAN-12\n</code></pre>\n\n<p>What I expect here as output is:</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     8-JAN-12\n1     01-JAN-12     14-JAN-12\n</code></pre>\n\n<p>...because the first row is the earliest begin date, and its end date is the earliest end date after that. The next row is the earliest begin date after the previous end date, and the end date of that row is the earliest end date after that. There are no begin dates after 14-JAN-12, so I'm done.</p>\n\n<p>I'm having very little luck solving this problem. One approach I tried was getting the rank partitioned by id and compare it to the max rank. I then used the lag function to compare to previous ranks. However, this strategy totally fails for use cases above.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13194026,"title":"SQL Dynamic join?","body":"<p>Please see <a href=\"http://sqlfiddle.com/#!3/2506f/2/0\" rel=\"nofollow\">http://sqlfiddle.com/#!3/2506f/2/0</a></p>\n\n<p>I have two tables.  One is a general record, and the other is a table containing related documents that link to that record.</p>\n\n<p>In my example I've created a straightforward query which shows all records and their associated documents.  This is fine, but I want a more complex situation.</p>\n\n<p>In the 'mainrecord' table there is a 'multiple' field.  If this is 0, then I only want the most recent document from the documents table (that is, with the highest ID).  If it is 1, I want to join all linked documents.</p>\n\n<p>So, rather than the result of the query being this:-</p>\n\n<pre><code>ID  NAME    MULTIPLE    DOCUMENTNAME    IDLINK\n1   One     1           first document    1\n1   One     1           second document   1\n2   Two     0           third document    2\n2   Two     0           fourth document   2\n3   Three   1           fifth document    3\n3   Three   1           sixth document    3\n</code></pre>\n\n<p>It should look like this:-</p>\n\n<pre><code>ID  NAME    MULTIPLE    DOCUMENTNAME    IDLINK\n1   One     1           first document    1\n1   One     1           second document   1\n2   Two     0           fourth document   2\n3   Three   1           fifth document    3\n3   Three   1           sixth document    3\n</code></pre>\n\n<p>Is there a way of including this condition into my query to get the results I'm after.  I'm happy to explain further if needed.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13194307,"title":"SQL Server Insert based of additional query","body":"<p>Using SQL server is it possible to to a mass insert based on a sub query, Essentially I'm trying to do this.</p>\n\n<pre><code>Insert into ProductExtra (ProductID,ExtraID) \nVALUES \n(Select ProductID From ProductSKU \nJOIN Product on ProductSKU.ProductID = Product.ID\nWhere ItemType = 'fire grate' ), 10739\n</code></pre>\n"},{"tags":["mysql","sql","table","select","export"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13194000,"title":"convert one table into two new tables","body":"<p>I am trying to move data from one table into two new tables, but I am unsure how I can do this in the best and most foolproof way.</p>\n\n<p>I have about 2000 rows in newsletter_users that looks like this:</p>\n\n<pre><code>userid company email memberofgroup\n</code></pre>\n\n<p>where </p>\n\n<pre><code>memberofgroup \n</code></pre>\n\n<p>is an integer that refers to newsletter_mailgroups. This is not the best way if a user wants to be a member of different groups. Then there will be x rows with the same email. 2000 users x 3 or 4 different groups (what did I think of??) Therefore I have made two new tables</p>\n\n<p>newsletter_members that look like this</p>\n\n<pre><code>userid email company\n</code></pre>\n\n<p>and another table newsletter_member_of_group that look like this:</p>\n\n<pre><code>field_member_uid field_user_id field_memberofgroup\n</code></pre>\n\n<p>where </p>\n\n<pre><code>field_user_id\n</code></pre>\n\n<p>will contain a users id from newsletter_members and </p>\n\n<pre><code>field_memberofgroup \n</code></pre>\n\n<p>will contain the emailgroup id. f.x.</p>\n\n<pre><code>field_user_id  field_memberofgroup \n    2                 6\n    2                 4\n    2                 8\n    3                 1\n    5                 6\n</code></pre>\n\n<p>How can I export and then import them in the best way so that emails will not duplicate in newsletter_members? - I might need to do a manual check to see which users a members of more than one mailgroup.</p>\n\n<p>Mailgroups table:</p>\n\n<pre><code>1   Forhandlere \n2   Arkitekter og byggerÃ¥dgivere   \n3   Typehusfabrikanter  \n4   ByggeentreprenÃ¸rer \n5   Murermestre \n6   TÃ¸mrermestre   \n7   TagdÃ¦kkere \n8   Boligforeninger/Ejendomsselskaber   \n9   Bygge-interesserede \n10  Tyske modtagere \n11  Landskabsarkitekter \n12  Norske arkitekter   \n13  Svenske arkitekter  \n14  Norske forhandlere  \n15  Svenske forhandlere \n16  Brancherelaterede   \n17  Svenske ansatte \n18  Norske ansatte  \n19  Beijer Sverige  \n</code></pre>\n"},{"tags":["sql","sql-server-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13192885,"title":"SQL Server 2012 CDC capture my Active Directory account / user information","body":"<p>I have activated CDC on my database for one table:</p>\n\n<pre><code>USE [Test]\nGO\n\nCREATE TABLE [dbo].[CDC_TestTable](\n[ID] [int] NOT NULL,\n[Name] [nvarchar](50) NOT NULL\n) ON [PRIMARY]\n\nGO\n\nEXEC sys.sp_cdc_enable_db\nGO\n\nEXECUTE sys.sp_cdc_enable_table\n@source_schema = N'dbo'\n, @source_name = N'CDC_TestTable'\n, @role_name = N'NULL'\n;\nGO\n</code></pre>\n\n<p>Now the question: How can I capture user information like which user has added / deleted / updated a record in this table ?</p>\n\n<p>I have tried with : </p>\n\n<pre><code>ALTER TABLE [cdc].[dbo_CDC_TestTable_CT] ADD UserName nvarchar(50) NULL DEFAULT(System_User)\ngo\n</code></pre>\n\n<p>but when I logon to this database with my Windows authentication and add / change records it just shows me the user sa ?!</p>\n\n<p>Is it in principal possible with CDC to get the information, which user profile has changed the records ?</p>\n\n<p>Who can help ?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","sql-server-ce","cascade"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":28,"score":3,"question_id":13193935,"title":"Cascade delete on many-to-many between same table","body":"<p>I'm trying to create a many-to-many relation between the same table in SQL Server.</p>\n\n<p>I have one table <code>Object</code> with columns <code>ObjectId</code> and <code>Name</code>.</p>\n\n<p>The relation follows these rules:  </p>\n\n<ul>\n<li>a child can have many parents  </li>\n<li>a parent can have many children  </li>\n<li>ObjectA can be a child of ObjectB and ObjectB can be a child of ObjectA  </li>\n<li>but an object cannot be a direct child of itself</li>\n</ul>\n\n<p>So I create a second table <code>ObjectRelation</code> with columns <code>ParentId</code> and <code>ChildId</code> and of course I want these relations to be deleted by cascade.</p>\n\n<p>But when I try this in SQL Server I get the error </p>\n\n<blockquote>\n  <p>Introducing FOREIGN KEY constraint 'FK_ObjectRelation_Object1' on table 'tblADMembership' may cause cycles or multiple cascade paths. Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, or modify other FOREIGN KEY constraints.</p>\n</blockquote>\n\n<p>In SQL Server Compact I get</p>\n\n<blockquote>\n  <p><em>The referential relationship will result in a cyclical reference that is not allowed.</em></p>\n</blockquote>\n\n<p>I've done some research and I understand why I get these errors, but is there a way around this that will also work on SQL Server Compact (so no stored procedures)? Or is there a better way to model this relationship?</p>\n"}]}
{"total":102599,"page":14,"pagesize":100,"questions":[{"tags":["mysql","sql","text","phpmyadmin","append"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13193750,"title":"add text to an existing cell in phpmyadmin","body":"<p>I want to add text to the the end of a cell in phpmyadmin, where it just adds the text to the end whatever in that cell, and keeps whatever there as is.</p>\n\n<p>I tried this but doesn't work:</p>\n\n<pre><code>update items set description = contact(description, \" - text to add\") where parent_id ='2907'\n</code></pre>\n\n<p>So the cell should be instead of</p>\n\n<pre><code>something here\n</code></pre>\n\n<p>to be:</p>\n\n<pre><code>something here - text to add\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13193852,"title":"Copy from all tables, insert into all tables (sp_MSforeachtable alternative)","body":"<p>I've decided to share my experience in trying to copy data from all tables into the same name tables in a different schema. I'm sure my experience can help others seeking mass table operations without using the unsupported and frankly limited sp_MSforeachtable.</p>\n\n<p><strong>Objective:</strong> Copy data from all tables in my database to identically named tables with different schema</p>\n\n<p><em>One quick note about</em> sp_MSforeachtable. <em>Most of the time when people ask questions here in SO about this stored procedure, there's some reply or another saying that we shouldn't use unsupported features. This is simply not true, what we shouldn't do is have practices and design decisions based on unsupported features, mostly because they might go away.\nBut at some specific point in time, if an unsupported feature exists and does exactly what we need to do right then, one-off style, then just consider yourself lucky and by all means use it, just be careful about unexpected behaviors. When using such features, best to stick with simple operations whose output is quickly and easily verifiable.</em></p>\n\n<p>With that said, and also because there's some real limitations to sp_MSforeachtable, I am presenting a different but not too complicated way of executing statements against all (or specific) tables in our database and I'm using my problem as an example.</p>\n"},{"tags":["sql","sql-server-2008","insert","numeric","column"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":92,"score":4,"question_id":13189688,"title":"Insert empty string into INT column for SQL Server","body":"<p>A <code>SAMPLE</code> table has only one column <code>ID</code> of type <code>int</code>, default null.</p>\n\n<p>In Oracle when I do:</p>\n\n<pre><code>  insert into SAMPLE (ID) values ('');\n</code></pre>\n\n<p>the new record is added with blank value. But in SQL Server 2008, when I run the same <code>insert</code> statement, the new record has the value of 0. </p>\n\n<p>Is there a way to force SQL Server 2008 to default blank string to NULL instead of 0 (for numerical type of columns)?</p>\n"},{"tags":["sql","exists","oracle9i"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13000124,"title":"Oracle missing parenthesis when it isn't","body":"<pre><code>SELECT company_name\nFROM empl_company s\nWHERE NOT EXISTS \n(\n    (SELECT city\n     FROM empl_company\n     WHERE company_name = 'Small Bank Corporation'\n     )\n     EXCEPT\n    (SELECT city\n     FROM empl_company k\n     WHERE k.company_name = s.company_name\n     ) \n);\n</code></pre>\n\n<p>I become an error\nORA-00907: missing right parenthesis\ncan enyone tell me what's the problem?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13193627,"title":"SQL - Update causing deadlock error","body":"<p>I'm trying to update a row in a table upon someone viewing the page (it increments the viewed count), however now and then I get a deadlock error, I'm guessing this is due to two or more people trying to update the same row?</p>\n\n<p>The error is:</p>\n\n<pre><code>Transaction (Process ID 60) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.\n</code></pre>\n\n<p>And my SQL is:</p>\n\n<pre><code>UPDATE [ProductDescription] \nSET [ViewCount] = ([ViewCount] + 1) \nWHERE ProductCode = @prodCode \n    AND ApplicationID = @AppID\n</code></pre>\n\n<p>I believe I may need a WITH(NOLOCK)?</p>\n"},{"tags":["sql","mysql","query"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":8057,"score":3,"question_id":1783784,"title":"SQL Delete Rows Based on Another Table","body":"<p>This is probably very easy, but it's Monday morning.  I have two tables:</p>\n\n<p>Table1:</p>\n\n<pre><code>Field        | Type             | Null | Key | Default | Extra\nid           | int(32) unsigned | NO   | PRI | NULL    | auto_increment\ngroup        | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>Field     | Type             | Null | Key | Default | Extra\ngroup     | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Ignoring other fields...I would like a single SQL DELETE statement that will delete all rows in Table1 for which there exists a Table2.group equal to Table1.group. Thus, if a row of Table1 has group=69, that row should be deleted if and only if there exists a row in Table2 with group=69.</p>\n\n<p>Thank you for any help.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":35,"score":-1,"question_id":13193427,"title":"How to select two same column from single table in single select query","body":"<p>I have a table called Employee having columns empId, empName, managerId. here manager is an employee. how do i get employee-name and manager-name from the above table.</p>\n"},{"tags":["sql","sql-server","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13008116,"title":"routing network function issue","body":"<p>Following on from a <a href=\"http://stackoverflow.com/q/12990638/398670\">this question</a>, I have some dynamic SQL I'm running successfully in PL/PgSQL with <code>EXECUTE</code>, but it doesn't seem to have the intended effect.</p>\n\n<p>The following code is part of a plpgsql function that I have created. This intends to go to each point that is lying on the same track and for each point find its nearest point in order to eventually I will create a network between all the tracks. For some reson it is not working properly.</p>\n\n<p>The i represent the number of the current track.</p>\n\n<pre><code> DECLARE\n    _r record;\n    i int := 0;\n    source_geom character varying;\n    target_geom character varying;\n\nBEGIN\n\nWHILE i &lt; 3 --DEPENDS ON THE NUMBER OF TRACKS\nLOOP\n\nFOR _r IN EXECUTE ' SELECT a.'|| quote_ident(gid_cname) || ' AS id,'\n|| ' st_astext( a.'||quote_ident(geo_cname)||') AS source,' \n|| ' st_astext(b.'||quote_ident(geo_cname)||') AS target, ' \n|| ' ST_Distance(a.'||quote_ident(geo_cname) || ' ,  b.'||quote_ident(geo_cname)||') As dist_ft'\n|| ' FROM ' || quote_ident (geom_table) ||' AS a INNER JOIN ' || quote_ident(geom_table) || ' As b ON ST_DWithin(a.'||quote_ident(geo_cname)|| ', b.'||quote_ident(geo_cname)|| ',1000)'\n|| ' WHERE b.'||quote_ident(gid_cname)|| ' &gt; a.'||quote_ident(gid_cname)|| ' AND b.'||quote_ident(tid_cname)|| ' = '||i|| 'AND a.'||quote_ident(tid_cname)|| ' = '||i|| \n   ' ORDER BY dist_ft '\n|| ' Limit 1 '\n\nLOOP\n\nsource_geom := _r.source;\ntarget_geom := _r.target;\n\n\nEXECUTE 'update ' || quote_ident(geom_table) || \n    ' SET source = ''' || source_geom ||''' \n    , target = ''' || target_geom || ''' \n    WHERE ' || quote_ident(gid_cname) || ' =  ' || _r.id;\nEND LOOP;\n\ni = i + 1;\n\nEND LOOP;\n\nRETURN 'OK';\nEND;\n</code></pre>\n\n<p>The thing is that I have tested the query in plain sql and it worked brilliantly. Now for some reason in plpgsql it is not working properly. Below you can find the same query in plain sql. </p>\n\n<pre><code>SELECT a.ogc_fid AS id, st_astext( a.wkb_geometry) AS source, st_astext(b.wkb_geometry) AS target, ST_Distance(a.wkb_geometry, b.wkb_geometry) As dist_ft\nFROM track_points AS a INNER JOIN track_points As b\nON ST_DWithin(a.wkb_geometry , b.wkb_geometry, 1000)\nWHERE b.ogc_fid &gt; a.ogc_fid AND b.track_fid = 0 AND a.track_fid = 0 \norder by dist_ft\n</code></pre>\n"},{"tags":["java","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13193527,"title":"What is the difference btw callableStatement,preparedStatment and Statement obj?","body":"<p>What is the difference btw callableStatement,preparedStatment and Statement obj ?</p>\n"},{"tags":["sql","postgresql","common-table-expression"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13191885,"title":"hierarchical sum in PostgreSQL","body":"<p>This is a simplified version of a problem I am encountering in PostgreSQL.</p>\n\n<p>I have the following table <strong>A</strong>:</p>\n\n<p><strong>[ ID</strong> <em>INTEGER</em>  <strong>| VALUE</strong> <em>NUMERIC(10,2)</em> <strong>| PARENT</strong> <em>INTEGER</em> <strong>]</strong></p>\n\n<p>Where 'PARENT' is a self-referencing FK to column ID.</p>\n\n<p>The table definition is:</p>\n\n<pre><code>CREATE TABLE A(ID INTEGER IDENTITY, VALUE NUMERIC(10,2), PARENT INTEGER)                                    \nALTER  TABLE A ADD CONSTRAINT FK FOREIGN KEY (PARENT) REFERENCES A(ID) \n</code></pre>\n\n<p>This simple table allows one to define tree data structures of arbitrary depth. Now I need to write a SQL (I prefer not to use server-side PL-SQL) that reports for each node, the total value of the sub-tree \"hanging\" under it. For instance, with the following table:</p>\n\n<pre><code>|  ID  | VALUE | PARENT |\n-------------------------\n|   1  | NULL  | NULL   |\n|   2  | 3.50  |    1   |\n|   3  | NULL  | NULL   |\n|   4  | NULL  |    3   |\n|   5  | 1.50  |    4   |\n|   6  | 2.20  |    4   |\n</code></pre>\n\n<p>I should get the following result set:</p>\n\n<pre><code>| ID  |  Total-Value-of-Subtree |\n|  1  |                  3.50   |\n|  2  |                  3.50   |\n|  3  |                  3.70   |\n|  4  |                  3.70   |\n|  5  |                  1.50   |\n|  6  |                  2.20   |\n</code></pre>\n\n<p>For simplicitly, you can assume that only leaf nodes have values, non-leaf nodes always have a value of <strong>NULL</strong> in the <strong>VALUE</strong> column. Is there a way to do this in SQL, even utilizing PostgreSQL-specific extensions?</p>\n"},{"tags":["sql","sql-server-2008-r2","crystal-reports-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13192989,"title":"Stock Turnover Analysis Grouping Query","body":"<p>I wanted to know how to modify the query below to give me opening stock, receipts, issues and closing stock such that</p>\n\n<p>opening stock + receipts - issues = closing stock and have it such that ItemCode shows only once per warehouse.</p>\n\n<pre><code>SELECT DISTINCT T0.ItmsGrpNam, T2.DocDate, T2.Warehouse, T1.ItemCode, T1.ItemName,\n(SUM(T1.OnHand) - SUM(T2.InQty)) AS 'Opening Stock', \nSUM(T2.InQty) AS 'Receipts',\nSUM(T2.OutQty) AS 'Issues', \n(SUM(T1.OnHand) - SUM(T2.InQty)) + SUM(T2.InQty) - SUM(T2.OutQty) AS 'Closing Stock' \nFROM OITB T0 INNER JOIN OITM T1 ON T0.ItmsGrpCod = T1.ItmsGrpCod\nINNER JOIN OINM T2 ON T1.ItemCode = T2.ItemCode\nGROUP BY T0.ItmsGrpNam, T2.DocDate, T1.ItemCode, T1.ItemName, T2.Warehouse, T2.InQty , T2.OutQty, T1.OnHand\nORDER BY T1.ItemCode \n</code></pre>\n\n<p>I run it in Crystal Reports where a user can enter parameters of start and end date, select itemgroupcode and warehouse as below </p>\n\n<pre><code>{Command.DocDate} &gt;= {?StartDate} and\n{Command.DocDate} &lt;= {?EndDate} and\n{Command.ItmsGrpNam} = {?@Select ItmsGrpNam From OITB order by ItmsGrpNam }\nand {Command.Warehouse} = {?@Select WhsCode From OWHS} \n</code></pre>\n\n<p>Sample SQL SERVER 2008 results are in the attached jpeg file.</p>\n\n<p>From the results, I would like the ItemCode to only appear once such that I can see only one opening stock, receipts...etc per warehouse for the given item codes<img src=\"http://i.stack.imgur.com/fL9UV.jpg\" alt=\"enter image description here\">. How do I achieve this?</p>\n"},{"tags":[".net","sql","sql-server","dataset"],"answer_count":7,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":11976,"score":7,"question_id":589976,"title":"How can you name the Dataset's Tables you return in a stored proc?","body":"<p>I've got the following stored procedure</p>\n\n<pre><code>Create procedure psfoo ()\nAS\nselect * from tbA\nselect * from tbB\n</code></pre>\n\n<p>I'm then accessing the data this way :</p>\n\n<pre><code>     Sql Command mySqlCommand = new SqlCommand(\"psfoo\" , DbConnection)\n     DataSet ds = new DataSet();\n     mySqlCommand.CommandType = CommandType.StoredProcedure;\n     SqlDataAdapter mySqlDataAdapter = new SqlDataAdapter();\n     mySqlDataAdapter.SelectCommand = mySqlCommand;\n     mySqlDataAdapter.Fill(ds);\n</code></pre>\n\n<p>Now, when I want to access my tables, I have to do this :</p>\n\n<pre><code>     DataTable datatableA = ds.Tables[0];\n     DataTable datatableB = ds.Tables[1];\n</code></pre>\n\n<p>the dataset Tables property also got an accessor by string (instead of int).</p>\n\n<p><strong>Is it possible so specify the name of the tables in the SQL code, so that I can instead write this :</strong></p>\n\n<pre><code>     DataTable datatableA = ds.Tables[\"NametbA\"];\n     DataTable datatableB = ds.Tables[\"NametbB\"];\n</code></pre>\n\n<p>I'm using SQL server 2008, if that makes a difference.</p>\n"},{"tags":["mysql","sql","select","limit","inner-join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12315389,"title":"MYSQL: How to limit inner join?","body":"<p>I need some help with my query.\nI have 2 tables:</p>\n\n<pre><code>all: art|serie\nsootv: name|art|foo\n</code></pre>\n\n<p>I need to get result like name|serie.\nMy query is:</p>\n\n<pre><code>SELECT t2.NAME,\n    t1.serie\nFROM (\n    SELECT *\n    FROM `all`\n    WHERE `serie` LIKE '$serie'\n    ) t1\nINNER JOIN sootv t2\n    ON t1.art = t2.art;\n</code></pre>\n\n<p>it works, but <code>sootv</code> table contains data like</p>\n\n<pre><code>name|art|foo\nabc | 1 | 5\nabc | 1 | 6\n</code></pre>\n\n<p>I get 2 same results. Its not what i need.\nHelp me please - how i can get only one result: abc|1</p>\n"},{"tags":["c#","sql","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1222,"score":1,"question_id":4822917,"title":"SSIS Script Component: Microsoft.SqlServer.Dts.Pipeline.BlobColumn","body":"<p>Struggling with a C# Component. What I am trying to do is take a column that is ntext in my input source which is delimited with pipes, and then write the array to a text file. When I run my component my output looks like this:</p>\n\n<pre><code>DealerID,StockNumber,Option\n161552,P1427,Microsoft.SqlServer.Dts.Pipeline.BlobColumn\n</code></pre>\n\n<p>Ive been working with the GetBlobData method and im struggling with it. Any help with be greatly appreciated! Here is the full script:</p>\n\n<pre><code>public override void Input0_ProcessInputRow(Input0Buffer Row)\n{\n    string vehicleoptionsdelimited = Row.Options.ToString();\n    //string OptionBlob = Row.Options.GetBlobData(int ;\n    //string vehicleoptionsdelimited = System.Text.Encoding.GetEncoding(Row.Options.ColumnInfo.CodePage).GetChars(OptionBlob);\n    string[] option = vehicleoptionsdelimited.Split('|');\n    string path = @\"C:\\Users\\User\\Desktop\\Local_DS_CSVs\\\";\n\n    string[] headerline =\n    {\n        \"DealerID\" + \",\" + \"StockNumber\" + \",\" + \"Option\"\n    };\n\n    System.IO.File.WriteAllLines(path + \"OptionInput.txt\", headerline);\n\n    using (System.IO.StreamWriter file = new System.IO.StreamWriter(path + \"OptionInput.txt\", true))\n    {\n        foreach (string s in option)\n        {\n            file.WriteLine(Row.DealerID.ToString() + \",\" + Row.StockNumber.ToString() + \",\" + s);\n        }\n    }\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13192221,"title":"Mysql most outer table visibility in nested loops","body":"<p>Let's assume i have 4 tables:<br>\n'users' (id, username),<br>\n'photos' (id, user_id, name),<br>\n'photos_comments' (id, photo_id, user_id, text),\n'photos_likes'    (id, photo_id, user_id, test).</p>\n\n<p>I want to calculate sum of all comments and likes for every user in all of his uploaded photos. For that i'm trying to build a query:</p>\n\n<pre><code>SELECT users.*,\n    (SELECT SUM(count) as rating FROM(\n   SELECT COUNT(*) as count FROM photos_likes\n     WHERE photos_likes.photo_id IN (SELECT photos.id FROM photos WHERE photos.user_id = users.id)\n            UNION\n   SELECT COUNT(*) as count FROM photos_comments\n     WHERE photos_comments.photo_id IN (SELECT photos.id FROM photos WHERE photos.user_id = users.id)\n ) as total_rating) as rating FROM users\n</code></pre>\n\n<p>It returns 'Unknown users.id column in WHERE clause' error. So it looks like it can't see users table in most inner query.I can't understand why it happens,because another similar query works ok:</p>\n\n<pre><code>SELECT users.*,\n    (SELECT COUNT(*) as count FROM photos_likes\n  WHERE photos_likes.photo_id IN (SELECT photos.id FROM photos WHERE photos.user_id = users.id)) as likes_count,\n\n   (SELECT COUNT(*) as count FROM photos_comments\n     WHERE photos_comments.photo_id IN (SELECT photos.id FROM photos WHERE photos.user_id = users.id)) as comments_count FROM users\n</code></pre>\n\n<p>In this query it can grab id from users table row in most inner query. Why is it working like that? Thanks for help.</p>\n"},{"tags":["mysql","sql","query","zend-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1056,"score":0,"question_id":6096147,"title":"zend framework insert() and LAST_INSERT_ID() screw up","body":"<p>so I tried to use Zend_Db_Adapter_Pdo_Mysql's insert() method....</p>\n\n<p>and then after that I issued the <code>SELECT LAST_INSERT_ID();</code> command....</p>\n\n<p>but then for some reason, that command always return 0 rather than the actual inserted ID...</p>\n\n<p>when I tried to use normal INSERT query, and then get the last insert id, it works just fine so I guess it's some zend framework screw up...</p>\n\n<p>does anybody know how to get around this? </p>\n\n<p>the insert() method only returns 1 if it succeeds rather than the id, so the solution for this: <a href=\"http://stackoverflow.com/questions/4842064/last-insert-id-with-zend-db-table-abstract\">last insert id with zend db table abstract</a>  doesn't seem to work </p>\n"},{"tags":["mysql","sql","where"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":88,"score":1,"question_id":12955060,"title":"Select min, max, avg, WHERE","body":"<p>I'm using MySQL.</p>\n\n<p>I'm trying to select the minumum, maximum and average length of a field but I'm not sure how. Something like this:</p>\n\n<pre><code>SELECT \n  min as min,\n  max as max,\n  avg as avg\nFROM COLUMNS\nWHERE COLUMN_NAME like '%password%'\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13191878,"title":"Why recursive query faster than join and group by?","body":"<p>I am using MySQL server 5.5 and have next db structure</p>\n\n<pre><code>    -- -----------------------------------------------------\n    -- Table `mydb`.`User`\n    -- -----------------------------------------------------\n    CREATE  TABLE IF NOT EXISTS `mydb`.`User` (\n      `id` INT NOT NULL ,\n      `Name` VARCHAR(45) NOT NULL ,\n      PRIMARY KEY (`id`) )\n    ENGINE = InnoDB;\n\n\n    -- -----------------------------------------------------\n    -- Table `mydb`.`Payments`\n    -- -----------------------------------------------------\n    CREATE  TABLE IF NOT EXISTS `mydb`.`Payments` (\n      `id` INT NOT NULL ,\n      `Amount` DOUBLE NOT NULL ,\n      `User` INT NOT NULL ,\n      PRIMARY KEY (`id`) ,\n      INDEX `fk_Payments_User` (`User` ASC) ,\n      CONSTRAINT `fk_Payments_User`\n        FOREIGN KEY (`User` )\n        REFERENCES `mydb`.`User` (`id` )\n        ON DELETE NO ACTION\n        ON UPDATE NO ACTION)\n    ENGINE = InnoDB;\n\n\n    -- -----------------------------------------------------\n    -- Table `mydb`.`Extras`\n    -- -----------------------------------------------------\n    CREATE  TABLE IF NOT EXISTS `mydb`.`Extras` (\n      `id` INT NOT NULL ,\n      `ExtraAmount` DOUBLE NOT NULL ,\n      PRIMARY KEY (`id`) ,\n      INDEX `fk_Extras_Payments1` (`id` ASC) ,\n      CONSTRAINT `fk_Extras_Payments1`\n        FOREIGN KEY (`id` )\n        REFERENCES `mydb`.`Payments` (`id` )\n        ON DELETE NO ACTION\n        ON UPDATE NO ACTION)\n    ENGINE = InnoDB;\n</code></pre>\n\n<p>And question is: Why this query </p>\n\n<pre><code>    SELECT u.*, sum(`amount`),sum(`ExtraAmount`)\n    FROM `user` AS `u`\n    LEFT JOIN payments AS p ON u.id = p.`user`\n    INNER JOIN extras AS e ON p.id = e.id\n    WHERE `Name` = 'abc'\n    GROUP BY `Name`\n</code></pre>\n\n<p>works slower than this one</p>\n\n<pre><code>    SELECT *, IFNULL((SELECT sum(`amount`)\n                      FROM payments AS p\n                      WHERE u.id = p.`user`),0) AS `TotalAmount`,\n              IFNULL((SELECT sum(`ExtraAmount`)\n                      FROM payments AS p\n                      INNER JOIN extras AS e ON p.id = e.id\n                      WHERE p.`User` = u.id),0) AS `sum2`\n    FROM `user` AS `u`\n    WHERE `Name` = 'abc'\n</code></pre>\n\n<p>There is difference even on empty DB(0.0001-0002s, not much, but still). But if you populate each table with 50k records, difference will be more noticeable.</p>\n\n<p>From my point of view second query executes way more sub queries, so it should work slower.</p>\n\n<p>Can somebody explain it for me please?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13192092,"title":"SQL Server : convert char to float and round it","body":"<p>I have a database with a column of <code>VARCHAR2</code> type keeping a value like: <code>398566,569885</code></p>\n\n<p>What I need is to cast this number to float and then to make it looking like: <code>398566,56</code>\nCasting it to float is <strong>not</strong> so important, if It's possible to trim the numbers it will be also ok.</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>select\ncast (p1.VALUE as float) as Total\nfrom Workflow p\nLEFT JOIN PA_PARAMETER p1 on p1.ID=p.ID AND p1.NAME = 'Total'\nWHERE p.TYPE = 'Marketing'\n</code></pre>\n\n<p>Is there a way to trim these numbers or to round it somehow?</p>\n"},{"tags":["sql","oracle","date","join","range"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12567916,"title":"Query Oracle to join date interval in one row","body":"<p>my question is join more date interval in one if start of second row is the day after the end of first row. In all these case I should have one row only.\nex:</p>\n\n<pre><code>id      start           end\n10      20120101        20120125\n10      20120201        20120225\n10      20120226        20120302\n10      20120303        20120304\n</code></pre>\n\n<p>    </p>\n\n<p>must be</p>\n\n<pre><code>10      20120101        20120125\n10      20120201        20120304\n</code></pre>\n\n<p>Do you have any suggestions?</p>\n"},{"tags":["sql","join","mysqli","bind","result"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":489,"score":0,"question_id":1275080,"title":"Bind Results from a Left Join using mysqli","body":"<p>I'm recently changing to mysqli and while performing an update on a script, i couldn't manage to use the same SELECT information as i did before. How can I bind_results from a Left Join between 3 tables?</p>\n\n<p>This is the script:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT actor.id, actor.name, actor.gender, \n       thumbs.id, thumbs.filename, thumbs.actorid\nFROM actors, thumbs\nLEFT JOIN join_thumbscategory\nON thumbs.id=join_thumbscategory.thumbsid\nWHERE join_thumbscategory.categoryid='$id_category'\nAND thumbs.actorid=actor.id\nORDER BY actor.name ASC\n</code></pre>\n\n<p>How can I join 3 tables and bind the results? I'm trying to use msqli prepared statements.</p>\n"},{"tags":["c#","sql","entity-framework","sql-server-2012","filetable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13181645,"title":"Entity Framework 5.0 and FileTable","body":"<p>So say I have the following tables in my SQL Server 2012 DB:</p>\n\n<pre><code>Person\n  PersonId\n  FirstName\n  LastName\n\nPhoto\n  PhotoId\n  PersonId (fk)\n  DateTaken\n\nPhotoFileTable\n  (all the FileTable columns)\n</code></pre>\n\n<p>And the photos stored on disk are structured like this:\n\\\\myserver\\filestreamshare\\People\\PersonId\\Photo1.tif</p>\n\n<p>And very important:  There are a TON of photos ALREADY on disk that need to be added to the database- that's why I thought a FileTable would be cool as it automatically picks them up.</p>\n\n<p>So I need to do 2 things- first, relate the Photo table to the PhotoFileTable so that I can get all photos for a person.  And second (and more painful) I want to use Entity Framework 5.0 to do this.</p>\n\n<p>Using the edmx designer, I can't add a table that contains a hierarchyid.  Since that is the primary key it seems it should be used as a 1:1 mapping between PhotoId and path_locator (the FileTable hierarchyid).  But then I can't add the Photo table either.</p>\n\n<p>What's the best approach here?  At the end of the day, I want to have EF objects in C# to use.  It ideally would look something like:</p>\n\n<pre><code>class Person\n  List&lt;Photo&gt;\n\nclass Photo\n  Filestream (to lazy load the image from the filesystem to bitmapimage)\n  Path (?)\n\nor maybe\nclass Photo\n  BitmapImage (lazy load)\n</code></pre>\n\n<p>Am I going about this the wrong way?  Can I get there from here?  Thought or suggestions?</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13191127,"title":"SQL Query for Count value from the latest date","body":"<p>I need to have a query that returns the ff:</p>\n\n<ol>\n<li>Count from the latest Date in each Name</li>\n<li>If the value of Count from the latest Date is -1 then it will return the count of the Date before the latest Date</li>\n<li>If the value of Count from the latest Date is -1 and the other Date is -1. Then return 0</li>\n<li>If the value of Count from the latest Date is -1 and no other Date of that Name. Then return 0</li>\n</ol>\n\n<p>Example Table:</p>\n\n<pre><code>ID  Name  Date         Count\n1   Adj   09/29/2012   2\n2   Adj   09/30/2012   4\n3   Ped   09/29/2012  -1\n4   Ped   09/30/2012   5\n5   Mel   09/29/2012   3\n6   Mel   09/30/2012  -1\n7   Rod   09/30/2012   7\n8   Ney   09/30/2012  -1\n9   Jin   09/29/2012  -1\n10  Jin   09/30/2012  -1\n</code></pre>\n\n<p>Desired Output:</p>\n\n<pre><code>Name   Count\nAdj    4\nPed    5\nMel    3\nRod    7\nNey    0\nJin    0\n</code></pre>\n\n<p>I am very confused on how to approach this in SQL since I only knew simple query.</p>\n\n<p>Any idea on how to make a query for this? Thanks.</p>\n\n<p>Btw, I'm sorry I forgot to include this. I am using SQL Server 2000.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":4497,"score":0,"question_id":5928599,"title":"Equivalent of explode() to work with strings in mysql","body":"<p>In mysql, I want to be able to search for '31 - 7', when another value = '7 - 31'.  What is the syntax that I would use to break apart strings in mysql.  In, php, I would probably use explode(' - ',$string) and put them together.  Is there a way to do this in mysql?  </p>\n\n<p>Background, I'm working with sports scores and want to try games where the scores are the same (and also on the same date) - the listed score for each team is backwards compare to their opponent's database record.  </p>\n\n<p>Ideal mysql call would be Where opponent1.date = opponent2.date AND opponent1.score = opponent2.score (opponent2.score would need to be opponent1.score backwards).  </p>\n"},{"tags":["sql","join","group-by","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13191869,"title":"Group By and Join (DB2)","body":"<p>I have a little problem with an SQL-Statement right now. I need to somehow get a group by condition inside of a Join. Well now I do know that this doesn't work, but there most be a way to do this and I hope  you guys can give me a clue on how to do this.</p>\n\n<p>Statement:</p>\n\n<pre><code>SELECT \n   btst.Ordnungsbegriff AS BBNR,\n   COUNT(vp.KVNR) \n   FROM T_Betriebsstaette btst\n      JOIN T_VERSICHERUNGSZEIT vz\n         ON vz.BETRIEBSNUMMER = btst.Ordnungsbegriff\n         AND vz.VALIDTO = date('2999-12-31')\n         AND vz.PERSONENKREIS = 'Beschäftigte'\n         AND vz.BEITRAGSGRUPPEKV_IID &gt; 0\n         AND vz.PERSONENGRUPPENSCHLUESSEL IN (101, 102, 103, 118, 119)\n         JOIN T_VERSICHERTEPERSON vp\n            ON vp.OID = vz.VERSPERS_VERSPERSON_ID\n            AND ('1' = '0' or '1' = '1' and (vp.VIPKENNZEICHEN is null or  NOT vp.VIPKENNZEICHEN is null and vp.VIPKENNZEICHEN  NOT  in (5, 6)))\n</code></pre>\n\n<p>The Group By Clause I have to get in there:</p>\n\n<pre><code>GROUP BY vz.\"VALIDTO\", vz.\"BETRIEBSNUMMER\"\n</code></pre>\n\n<p>I'm not really an expert in SQL. Hope you guys can help me out a little. :)</p>\n"},{"tags":["sql","database","json","database-design"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13191733,"title":"intellectual challenge: how to turn the following DB schema into JSON?","body":"<p>I need to populate a javascript grid with monthly data on product sales. the grid looks something like this: </p>\n\n<pre><code>Product    January   February   March   ....\n-------    -------   --------   -------\nProduct A    421        453       571\nProduct B    274        312       305\n...\n</code></pre>\n\n<p>on the server side, I have a DB table that contains the following fields:</p>\n\n<p>id, product_name, month, value</p>\n\n<p>question is - my JS grid expects a json input. how would you serialize the sql table into json effeciently? </p>\n\n<p>is it better to do it server-side or client-side? how?</p>\n"},{"tags":["sql","oracle","jdbc"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13190890,"title":"How to get all usersnames in a single sql row","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1120706/is-there-an-oracle-sql-query-that-aggregates-multiple-rows-into-one-row\">Is there an Oracle SQL query that aggregates multiple rows into one row?</a>  </p>\n</blockquote>\n\n\n\n<p>i have the below output for my sql query to get the users details from oracle table</p>\n\n<pre><code>   Select distinct userid from Scope1\n\nUSERID \nRakesh \nAdmin \n</code></pre>\n\n<p>i want the output to be as below so that i can do my queries even easier. please help me.</p>\n\n<pre><code>USERID\n'Rakesh','Admin'\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2005"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13071003,"title":"Strange (Caching?) Issue (Bug?) with T-SQL View","body":"<p><strong>This issue was resolved by scripting the view as a create, dropping the view, and then recreating the view using the script, so obviously nothing was <em>wrong</em> with the view, per se.  However, I am very curious as to what the cause could be...</strong></p>\n\n<p>I have a created like this:</p>\n\n<pre><code>CREATE VIEW [dbo].[Employees_V]\nAS\nSELECT  cast(right(EmployeeNo,4) as int) as EmployeeID\n,*\n,cast(0 as bit) AS [IsTerritoryManager]\n,cast(0 as bit) AS [IsCoordinator]\nFROM    AD.dbo.ADEmployees_V\n</code></pre>\n\n<p>The <code>AD.dbo.ADEmployees_V</code> has a lot of different fields, but the relevant fields are <code>Status</code> and <code>ISStatus</code>, defined in the creation of the view as:</p>\n\n<pre><code>,CASE WHEN c.[Status] = 'Active' THEN 'Active' ELSE 'Terminated' END AS [Status]\n,CASE WHEN c.[Status] = 'Active' OR ad.[AccountStatus] LIKE '%Enabled%' THEN 'Active' ELSE 'Terminated' END AS [ISStatus]\n</code></pre>\n\n<p>Today, I added the <code>ISStatus</code> column to <code>AD.dbo.ADEmployees_V</code> (<code>Status</code> was there previously).</p>\n\n<p>After making that change, I did a:</p>\n\n<pre><code>SELECT * FROM [Employees_V]\n</code></pre>\n\n<p>Surprisingly, this did not return the proper results.  <code>ISStatus</code> did not appear as a column header, and instead of being populated with 0s, <code>IsTerritoryManager</code> was populated with the new <code>ISStatus</code> values!</p>\n\n<p>I am guessing that this is some sort of caching issue, but I would <em>love</em> an explanation of what is going on under the covers.  Thanks!</p>\n"},{"tags":["sql","fckeditor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13183041,"title":"Sql Datatype needed for FCK editor Text storing","body":"<p>I just want to save long text through FCK Editor in Sql Database. I've given the datatype as 'text' but it is not accepting more than 500 characters. I just need the datatype where I can save atleast 10000 characters. What will be the perfect alternative for this solution.</p>\n\n<p>Please Answer me. \nThanks.</p>\n"},{"tags":["mysql","sql","one-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13191131,"title":"mysql one is to many rquery","body":"<p>table: lead_salesperson</p>\n\n<pre><code>------------------------\nid    | sp_id   |  phone\n------------------------\n0     | 1       |  12345678\n1     | 1       |  87654321\n</code></pre>\n\n<p>table: productProperties</p>\n\n<pre><code>------------------------------------------------\nproduct  | sp_id    |  phone    | activity_name\n------------------------------------------------\n0        | 1        |  12345678 | vm\n1        | 1        |  12345678 | DNC\n2        | 1        |  87654321 | SCB \n3        | 1        |  77654321 | SCB \n</code></pre>\n\n<p></p>\n\n<pre><code>Select DISTINCT(l.phone) as phone \n  from lead_salesperson as l \n  join lead_activity as ls \n  on (ls.phone=l.phone) &amp;&amp; (ls.year_make=l.year_make) &amp;&amp; (ls.make=l.make) \n where l.sp_id=$sp_id and ((ls.act_name!='DNC') OR (ls.act_name!='DNC_AUTO'))\n</code></pre>\n\n<p>so the output should be <code>87654321,77654321</code></p>\n\n<p>I am trying to get all phone numbers that do not have a DNC or DNC_AUTO ... the leadactivity has can have multi rows connected to one row in lead_salesperson . IF even one of the rows (phone) has a DNC or DNC _AUTO in the activity_name then i do not want that phone to be part of the result set any ideas...how to solve this.</p>\n"},{"tags":["mysql","sql","database","dbms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13140524,"title":"How can I change the character sets of an existing database in SQL and MySQL DBMS?","body":"<p>I am managing a website that was created by another programmer. The contents of the web page loads from a DB (MySQL / SQL) - he used JOOMLA for the design. Some special characters were showing on the webpage which are not suppose to be (e toÂ theirÂ st). I want to change the default character set to UTF_8_general_ci on the server (SQL server). Please how can I do this? Thanks.</p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":886,"score":1,"question_id":10516284,"title":"Oracle create table with column comments","body":"<p>Is there a column comment syntax that allows me to specify a column comment directly where I declare the column in the create table statement (i.e. inline)? The <a href=\"http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_7002.htm\" rel=\"nofollow\">11g spec</a> does not mention anything, on <a href=\"http://docs.oracle.com/cd/E17952_01/refman-5.1-en/create-table.html\" rel=\"nofollow\">another page</a> something is mentioned but I could not get it to work. There is a way to <a href=\"http://www.adp-gmbh.ch/ora/sql/comment.html\" rel=\"nofollow\">specify comments after creating the table</a>, but I think it is annoying that the comment is separated from the field definition. I am looking for something like this (which does not work):</p>\n\n<pre><code>create table whatever (\n field number(15,0) primary key comment 'primary key generated from sequence pkseq',\n ...\n)\n</code></pre>\n"},{"tags":["iphone","sql","ios","database","sqlite"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13189964,"title":"store and fetch bold/italic font from sqlite database","body":"<p>I  tried by make Excel file &amp; import as a csv file in sqlite. But it shows me in normal font rather than bold or italic font.</p>\n\n<p>In my app, I uses the sqlite database and fetches data from it. I want to display some text in italic font,How can i do that??</p>\n\n<p><strong>Does Sqlite supports Italic?</strong></p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13174634,"title":"Syntax for partition with subpartition","body":"<pre><code>col1 ....\ncol2 ....\ncol3 ....\ncol4 ....\nPARTITION BY RANGE(DATE_KEY)\nSUBPARTITION BY LIST(REGION_KEY)\nSUBPARTITION TEMPLATE\n  (SUBPARTITION A VALUES (1) TABLESPACE X,\n   SUBPARTITION B VALUES(3) TABLESPACE X,\n   SUBPARTITION C VALUES (8) TABLESPACE X)\n(PARTITION MON_JAN_2012 VALUES LESS THAN (1000)\n    TABLESPACE X\n    PCTFREE 10\n    INITRANS 1\n    MAXTRANS 255\n    NOLOGGING\n  (SUBPARTITION A VALUES (1) TABLESPACE X,\n   SUBPARTITION B VALUES(3) TABLESPACE X,\n   SUBPARTITION C VALUES (8) TABLESPACE X),\n PARTITION MON_FEB_2012 VALUES LESS THAN (2000)\n    TABLESPACE X        PCTFREE 10\n    INITRANS 1\n    MAXTRANS 255\n    NOLOGGING\n  (SUBPARTITION A VALUES (1) TABLESPACE X,\n   SUBPARTITION B VALUES(3) TABLESPACE X,\n   SUBPARTITION C VALUES (8) TABLESPACE X)\n</code></pre>\n\n<p>My table structure is something like this, I m new to partitions, need to add new partitions for table from March_2021 for few months, need correct syntax for this, I tried to google but not able to find example for adding partition with subpartition. Database 10g</p>\n"},{"tags":["sql","sql-server","performance","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":11724333,"title":"SQL Server - joining 4 fast queries gives me one slow query","body":"<p>I have 4 views in my MS Sql Server Database which are all quite fast (less than 2 seconds) and return all less than 50 rows.</p>\n\n<p>BUT when I create a query where I join those 4 views (left outer joins) I get a query which takes almost one minute to finish.</p>\n\n<p>I think the query optimizer is doing a bad job here, is there any way to speed this up. I am tempted to copy each of the 4 views into a table and join them together but this seems like too much of a workaround to me.</p>\n\n<p>(Sidenote: I can't set any indexes on any tables because the views come from a different database and I am not allowed to change anything there, so this is not an option)</p>\n\n<p><strong>EDIT:</strong> I am sorry, but I don't think posting the sql queries will help. They are quite complex and use around 50 different tables. I cannot post an execution plan either because I don't have enought access rights to generate an execution plan on some of the databases.</p>\n\n<p>I guess my best solution right now is to generate temporary tables to store the results of each query.</p>\n"},{"tags":["sql","stored-procedures","delete","oracle11g","self-join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13188464,"title":"Delete using Self Join","body":"<p>Am deleting a table using a self join in a Stored Procedure, it seems sometimes its getting into a stale state, </p>\n\n<p>Query am using is something like the below,</p>\n\n<pre><code>Delete from A a where\n    a.x = 'X'\nand a.y in (select y from A b where b.z = 'z');\n</code></pre>\n\n<p>Its running for more than 24 hours last time, table contains about 15 million records in it.\nAlso the point to note is not every time its getting deadlocked.</p>\n\n<p>Can someone please suggest any reason behind this ? also is it advisable to delete in self join ?</p>\n\n<p>(I also searched and confirmed no other queries deadlocking the table).</p>\n\n<p>Regards\nSubash</p>\n"},{"tags":["sql","sql-server","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13190654,"title":"dateadd() and datename() in postgresql","body":"<p>I am porting from SQLServer to PostgreSQL. I have just started PostgreSQL. I have to convert <code>dateadd()</code> functions. I have converted, but not sure if it is correct. Can you confirm it ?</p>\n\n<p>SQLServer :</p>\n\n<pre><code>dateadd(day,0,wkv.start_date)\n</code></pre>\n\n<p>PostgreSQL:</p>\n\n<pre><code>\"START_DATE\"::date+cast('0 days' as interval)\n</code></pre>\n\n<p>Is it correct ?</p>\n"},{"tags":["c#",".net","sql","ado.net","datatable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1858,"score":1,"question_id":3870051,"title":"exception while adding multiple rows to datatable. Couldn't store <System.Data.DataRowCollection>","body":"<p><code>idLocals</code> is Primary key in database</p>\n\n<p>Populating the datatable</p>\n\n<pre><code>oDtLocalCharge = bll.GetData();\n</code></pre>\n\n<p>i am copying the datatable in another function</p>\n\n<pre><code>   dtLocalCharges = oDtLocalCharge.Copy();\n</code></pre>\n\n<hr>\n\n<p>and trying to add rows using below code</p>\n\n<pre><code>DataRowCollection drr = oDtLocalCharge.Rows;\ndtLocalCharges.Rows.Add(drr);\n</code></pre>\n\n<p>When i try to add rows to datatable, i am getting error as below</p>\n\n<hr>\n\n<pre><code>Error: \n{System.ArgumentException: Unable to cast object of type 'System.Data.DataRowCollection' to type 'System.IConvertible'.Couldn't store &lt;System.Data.DataRowCollection&gt; in idLocals Column.  Expected type is Int32. ---&gt; System.InvalidCastException: Unable to cast object of type 'System.Data.DataRowCollection' to type 'System.IConvertible'.\n</code></pre>\n\n<p>May be Primary Key <code>idLocals</code>is causing problem\nwhat is the problem?</p>\n\n<p>How can i fix this? I want to multiple add rows in <code>dtLocalCharges</code> table</p>\n"},{"tags":["java","sql","spring","db2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13190249,"title":"JdbcTemplate does not support Parameterized Query 'IN' case? Must by NamedParameterJdbcTemplate?","body":"<p>Aimed at preventing SQL injection attacks, all the SQL Statement code in my project should transformed to Parameterized Query. But I got a problem when the query condition includes a 'IN' case. Like this (Using DB2 database):</p>\n\n<pre><code>String employeeId = 'D2309';\nString name = \"%brady%\";\n\nList&lt;Integer&gt; userRights = new ArrayList&lt;Integer&gt;();\nuserRights.add(1);\nuserRights.add(2);\nuserRights.add(3);\n\nString sql = \"SELECT * FROM T_EMPLOYEE WHERE EMPLOYEE_ID = ? AND NAME LIKE ? \nAND RIGHT IN (?)\";\n\njdbcTemplate.query(sql, new Object[] {employeeId, name, userRights}, new \nEmployeeRowMapper());\n</code></pre>\n\n<p>The above code runs failed with the exception:</p>\n\n<pre><code>org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; bad \nSQL grammar [SELECT * FROM T_EMPLOYEE WHERE EMPLOYEE_ID = ? AND NAME LIKE ? AND \nRIGHT IN (?)]; nested exception is com.ibm.db2.jcc.am.io: [jcc][1091][10824]\n[3.57.82] .... ERRORCODE=-4461, SQLSTATE=42815\n</code></pre>\n\n<p>The question here is that does not JdbcTemplate support Parameterized Query for IN case? and I know this work can be done by NamedParameterJdbcTemplate, and whether only NamedParameterJdbcTemplate can do IN case query?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["sql","database","query","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":45,"score":-2,"question_id":13190155,"title":"join tables sql","body":"<p>I have the following tables \n<img src=\"http://i.stack.imgur.com/gJCad.png\" alt=\"enter image description here\">\nDishes table:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ex0ps.png\" alt=\"enter image description here\"></p>\n\n<p>Category table:\n<img src=\"http://i.stack.imgur.com/NWNAO.png\" alt=\"enter image description here\"></p>\n\n<p>t_time table:\n<img src=\"http://i.stack.imgur.com/gMPGU.png\" alt=\"enter image description here\"></p>\n\n<p>To get connect a dish with the ingredients I have the following code which works:</p>\n\n<pre><code>$sql = \"SELECT d.name, i.item\\n\"\n    . \"FROM dish d\\n\"\n    . \"JOIN dish_ingredients di ON ( d.id = di.dish_id )\\n\"\n    . \"JOIN ingredients i ON ( di.ingredient_id = i.id )\\n\"\n    . \"WHERE d.id =1\\n\"\n    . \"LIMIT 0 , 30\";\n</code></pre>\n\n<p>but now I want to connect the dish with the matching <code>categories</code>/<code>t_time</code> and <code>cuisine</code> . instead of having time= 6 and Category 3 being displayed when I do the query I want it to display 60 and fish instead. What would be the easiest way to do this?  a good tutorial might help as well. </p>\n"},{"tags":["html","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13172948,"title":"unicode character are not displayed correctly","body":"<p>At the moment I have the following unicode string stored in a database. </p>\n\n<p>\\u4ece\\u4e0b\\u5468\\u4e00\\u8d77\\uff0c\\u5947\\u5f02</p>\n\n<p>If I send it out through php to the apple  APNS server, it is displayed correctly on the iphones.\nIf I however want to display these characters (chinese characters) on a website, it does not display them in chinese characters but purely as \\u4ece\\u4e0b\\u5468\\u4e00\\u8d77\\uff0c\\u5947\\u5f02</p>\n\n<p>Anyone can help me out how to display them correctly?</p>\n"},{"tags":["sql","hibernate","orm","coldfusion","coldfusion-9"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":181,"score":0,"question_id":7409927,"title":"One-to-One or Many-to-One with CF9 ORM in 2 queries","body":"<p>I have two objects</p>\n\n<pre><code>HomeFeatures\n&lt;cfcomponent persistent=\"true\"&gt;\n    &lt;cfproperty name=\"id\" column=\"homeFeatureid\"&gt;\n    &lt;cfproperty name=\"tabTitle\"&gt;\n    &lt;cfproperty name=\"title\"&gt;\n    &lt;cfproperty name=\"description\"&gt;\n    &lt;cfproperty name=\"sort\"&gt;\n    &lt;cfproperty name=\"moretext\"&gt;\n    &lt;cfproperty name=\"url\"&gt;\n    &lt;cfproperty name=\"active\"&gt;\n    &lt;cfproperty name=\"media\" fieldtype=\"many-to-one\" fkcolumn=\"mediaid\" cfc=\"media\" lazy=\"false\" fetch=\"join\" missingrowIgnored=\"true\"&gt;\n&lt;/cfcomponent&gt;\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Media\n&lt;cfcomponent persistent=\"true\" table=\"cms.dbo.media\"&gt;\n    &lt;cfproperty name=\"id\" column=\"mediaid\"&gt;\n    &lt;cfproperty name=\"filename\"&gt;\n&lt;/cfcomponent&gt;\n</code></pre>\n\n<p>Thus I have multiple homeFeatures, each of which has a media item associated with it. The same media item could be associated with multiple homeFeatures, but each homeFeature can only have one media item joined by homeFeatures.mediaid.</p>\n\n<p>If I do an entityLoad(\"homeFeatures\") I get 1 query for the homeFeatures and 1 query of the media table for EVERY ROW IN homeFeatures. In other words this is the N+1 problem. Why? This should be two queries total, one to get all of the homeFeatures, and one to get all of the media who's media ID is in the list determined by homeFeatures. I am attempting to do \"eager\" loading as defined at <a href=\"http://www.rupeshk.org/blog/index.php/2009/09/coldfusion-orm-performance-tuning-fetching-strategy/\" rel=\"nofollow\">http://www.rupeshk.org/blog/index.php/2009/09/coldfusion-orm-performance-tuning-fetching-strategy/</a> and in the adobe docs.</p>\n\n<p>In this specific view I need to access the media record for every entry, so that is why I have lazy set to false. I swear I have tried every iteration of lazy=false|true, batch=999, fieldtype=one-to-one|many-to-one, fetch=join|select, and all of them produce the same N+1 problem.</p>\n\n<p>Any ideas? Please help!</p>\n"},{"tags":["mysql","sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13190358,"title":"DATE_FORMAT() equivalent in PostgreSQL","body":"<p>I have this query in mysql </p>\n\n<pre><code>SELECT * \nFROM `calendar` \nWHERE DATE_FORMAT(startTime, \"%Y-%m-%d\") = '2010-04-29'\n</code></pre>\n\n<p>How can i convert to Postgresql query?</p>\n"},{"tags":["sql","tsql","reporting-services","ssrs-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13189222,"title":"SSRS Force single sided printing","body":"<p>The Current the windows pc have the printer settings defaulted to double sided printing to save paper.<br>\nThere are some reports which they would like SSRS to ignore the windows settings and print single sided.</p>\n\n<p>I dont think this is possible, is it?</p>\n"},{"tags":["sql","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13189786,"title":"SQL Get a list of categories but exclude the categories that have no items?","body":"<p>I have a <strong>categories</strong> table and an <strong>items</strong> table. I have about 20 categories. In the items table there are items from 10 of those categories. I want to select all the categories that have items in the items table. I want to exclude all the categories that have no items. </p>\n\n<p>The Items table has a categoryID field that matches the ID field of the category. </p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13189706,"title":"SQL Server, how to display (square) ^2 as in column heading?","body":"<p>Please guide me how to display m2 (m with 2 as square small on top of m) in column heading ?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","sql","spring","db2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13189051,"title":"How to handle 'IN' case in SQL Statement with the way of Parameterized Query?","body":"<p>To avoid SQL injection attacks in my project, I'm attempting access database with Parameterized Query way. Right now I know how to handle equal case like below (With Spring JdbcTemplate):</p>\n\n<pre><code>String sql = \"SELECT * FROM T_USER WHERE USERNAME = ? AND PASSWORD = ?\"\njdbcTemplate.query(sql, \n                   new UserRowMapper(), \n                   new Object[]{\"%admin%\", \"%password%\"});\n</code></pre>\n\n<p>Above code runs no problem, but I had no idea how to handle the 'IN' case, following is my case, and it works failed:</p>\n\n<pre><code>String sql = \n   \"SELECT * FROM T_USER WHERE USERNAME = ? AND PASSWORD = ? AND CLASS_ID IN (?)\"\njdbcTemplate.query(sql, \n                   new UserRowMapper(), \n                   new Object[]{\"%admin%\", \"%password%\", \"1,2,3\"});\n</code></pre>\n\n<p>Anybody give me guidance? Thanks a lot.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13188204,"title":"hotel reservation query for booking date","body":"<p>how to get result of a queries into array and the results should compare each one and merge into one array.</p>\n\n<p>i have 3 queries, i don't know what's is wrong in my coding, my best is not enough so guys please help me especially the experts for sql and php.</p>\n\n<p>here's my code:</p>\n\n<pre><code>        &lt;?php\n        $a = $p['id'];\n        $query1 = mysql_query(\"SELECT id FROM prereservation where '$arrival' BETWEEN arrival and departure and room_id ='$a' and status = 'active'\");\n        $rows1 = mysql_fetch_array($query1);  \n\n        $query2 = mysql_query(\"SELECT id FROM prereservation where '$departure' BETWEEN arrival and departure and room_id ='$a' and status = 'active'\");\n        $rows2 = mysql_fetch_array($query2);\n\n        $query3 = mysql_query(\"SELECT id FROM prereservation where arrival &gt; '$arrival' and departure &lt; '$departure' and room_id ='$a' and status = 'active'\");\n        $rows3 = mysql_fetch_array($query3);\n\n        $sample = array_unique(array_merge($rows1, $rows2, $rows3));             \n        ?&gt; \n</code></pre>\n\n<p>and the display is like this:</p>\n\n<pre><code>        &lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n        &lt;option value=\"0\"&gt;&lt;/option&gt;\n        &lt;? $counter = 1; ?&gt;\n        &lt;? while ($counter &lt;= ($p['qty']) - $????????) { ?&gt;\n        &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n        &lt;? $counter++;\n        }?&gt;\n        &lt;/select&gt;\n</code></pre>\n\n<p>all i want for example output is like this:</p>\n\n<pre><code>$rows1 = array(id= 48, 55, 51, 53)\n$rows2 = array(id= 48, 49, 51, 52)\n$rows3 = array(id= 48, 49, 50, 51)\n$sample = array_unique(array_merge($rows1, $rows2, $rows3))\n</code></pre>\n\n<p>so the output of sample is like this:</p>\n\n<pre><code>$sample = array(id= 48, 49, 50, 51, 52, 53)\n</code></pre>\n\n<p>then in table prereservation the columns are: '<strong>id</strong>', '<strong>arrival</strong>', '<strong>departure</strong>', '<strong>room_id</strong>', '<strong>qty</strong>' and '<strong>status</strong>'.</p>\n\n<p>in my table prereservation each <strong>id</strong> has <strong><em>different</em></strong> *<em>qty</em>*, so i want <strong>sum</strong> of <strong>qty</strong> of each <strong>id</strong>'s for sample like this:</p>\n\n<pre><code>    id    |   qty\n    48    |    2\n    49    |    1\n    50    |    1\n    51    |    3   \n    52    |    1\n    53    |    3  \n\n\n$total = sum(qty); which is 11\n</code></pre>\n\n<p>can you guys help me how to create a query to get the <strong><em>sum</em></strong> of those <strong><em>qty</em></strong> by each <strong><em>id</em></strong>'s? also please check the first <strong>3</strong> queries because i know i have an <strong>error</strong> for each query. to get the <strong>array_merge</strong> and <strong>array_unique</strong>.\nthank you very much guys.</p>\n\n<pre><code>            &lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n            &lt;option value=\"0\"&gt;&lt;/option&gt;\n            &lt;? $counter = 1; ?&gt;\n            &lt;? while ($counter &lt;= ($p['qty']) - $total) { ?&gt;\n            &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n            &lt;? $counter++;\n            }?&gt;\n            &lt;/select&gt;\n</code></pre>\n\n<p>here my database:</p>\n\n<pre><code>table rooms\nid |  type   |  qty\n---|---------|-----\n11 | single  |  50\n12 | double  |  50\n13 | deluxe  |  20\n\ntable preservation\nid |   arrival   |  departure  | room_id | qty | status\n---|-------------|-------------|---------|-----|-------\n48 | 05/11/2012  | 11/11/2012  |    11   |  2  | active \n49 | 06/11/2012  | 11/11/2012  |    11   |  1  | active \n50 | 06/11/2012  | 08/11/2012  |    11   |  1  | active \n51 | 05/11/2012  | 07/11/2012  |    11   |  3  | active \n52 | 06/11/2012  | 09/11/2012  |    11   |  1  | active \n53 | 07/11/2012  | 07/11/2012  |    11   |  3  | active \n</code></pre>\n\n<p>so in my display i have an select tag from <strong>table rooms(id=11)</strong> and the option is <strong>qty</strong> and <strong>deducted</strong> by <strong>total sum</strong> of <strong>qty</strong> from table <strong>preservation(room_id=11)</strong></p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13189615,"title":"Which SQL data type would I use for a drivers license number?","body":"<p>this is probably a dumb question to most, but I would like to know which SQL data type to use for a drivers license number.  In my state the drivers license number contains a letter  .  I know that there are three different categories of data  types,  text, number, and Date/Time types.  I also know of the types that fall under those categories, but am unsure to as which one to use for string which contains both numbers and letters.  </p>\n\n<p>In advance, thanks for any help that I receive.</p>\n"},{"tags":["sql","sql-server","time","intervals"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13189458,"title":"Finding records within a 5 min time interval in SQL","body":"<p>I have a table with over 100,000 rows that contain the following columns: ID, Time, and Boolean.<br>\nThe time column tracks time down to the second.<br>\nI need a query that will find all instances of Boolean = 1 for every 5 minute interval of time from the start of the table to the end, then group the count by time interval.</p>\n\n<p>The table represents 4 hours of data, so I should get 48 rows of results.<br>\nI'm using MS SQL Server.</p>\n\n<p>I've tried a few approaches, but the time interval logic is giving me a hard time.   </p>\n"},{"tags":["mysql","sql","select","filter"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":11868775,"title":"SELECT statement issue with OR","body":"<p>I am trying to do a filter query by using the next statement:</p>\n\n<pre><code>SELECT * FROM user_jobs,users WHERE user_jobs.job_title LIKE \"%some_keyword%\" **OR** user_jobs.job_title LIKE \"%another_keyword%\" AND user.id=user_jobs.userid\n</code></pre>\n\n<p>Specs: users.id is PK and user_jobs.userid is FK to users.id</p>\n\n<p>I am trying to filter the users to get the ones that have similar values as specified. When I run it I get a very long loop and finally a large list of users that contains duplicates. (e.g. I only have 300 users and the query shows over 3000 results)</p>\n\n<p>What am I doing wrong, please?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13189490,"title":"sql: how to use count for a particular column ,(or) to count a particular column by its field name","body":"<p>in my query i need a to count a particular column by its field name,</p>\n\n<pre><code>SELECT \n  C.INC_COUNT, MIN_X, MIN_Y, MAX_X, MAX_Y, B.STATE_ABBR,\n  B.STATE_NAME, B.LATITUDE, B.LONGITUDE, A.STATE, GEO_ID, \n  concat(A.LSAD_TRANS,' ' , A.NAME) DIST_NAME, \n  A.LSAD, GeometryType(SHAPE) GEO_TYPE, AsText(SHAPE) GEOM  \nfrom SHAPE_LAYERS A \njoin SHAPE_LAYER_STATE_DESC B \n  on ( A.state = B.state) \nleft outer join INC_DIST_SUMMARY_ALL C \n  on (C.SHAPE_GEO_ID = A. GEO_ID)\n</code></pre>\n\n<p>here i have to count by </p>\n\n<pre><code> B.STATE_NAME ,C.INC_COUNT\n</code></pre>\n\n<p>if exmple the field name <code>nevada</code> means i have to get all <code>neveda value count</code> and the C.INC_COUNT.</p>\n"},{"tags":["sql","sql-server-2008","index","normalization","database-performance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13189237,"title":"Normalize a database - optimization","body":"<p>I have some kind of project in the university, about sql server.</p>\n\n<p>We need to normalize a database, migrating all data.</p>\n\n<p>The original db is a \"master\" table, with about 39 fields. We need to create all tables, and then scanning this master table (about 700.000 rows) inserting the data where it belongs.</p>\n\n<p>I have a problem of performance. In new machines, it runs fast, but in my case (having ubuntu, using a vm of windows xp, so I have lower recurses than the machines of my team partners) runs much slower.</p>\n\n<p>So, we want to improve performance, because we don't know in which machines will be tested.</p>\n\n<p>We think on indexing master table, but the problem is that almost all fields are nvarchar(255) or numeric(18,2).</p>\n\n<p>Is good to index that fields? We must do inserts in almost 15 tables, so each insert is scanning all master table, getting the information.</p>\n\n<p>Is there any other thing useful instead of index ? We thought also in create different views, for optimize the selects.</p>\n\n<p>it's homework, but the tag says \"Do not use\".</p>\n\n<p>Any orientation will be apreciated</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>this is one of the querys.\nBefore you hate me, I DIDN'T DO THIS, with the old-syntax style. (was one of my parters)</p>\n\n<pre><code>insert into LITTLE_BOBBY_TABLES.Proveedor\nSELECT DISTINCT U.idUsuario, C.idCiudad,R.idRubro, M.Provee_RS,M.Provee_CUIT, '', M.Provee_Telefono, M.Provee_Dom, REPLACE(REPLACE(REPLACE(M.Provee_RS, 'N°',''), '.R.L.', ''), ' ', ''), ''   \nFROM gd_esquema.Maestra M, LITTLE_BOBBY_TABLES.Usuario U, LITTLE_BOBBY_TABLES.CIUDAD C, LITTLE_BOBBY_TABLES.Rubro R\nWHERE U.Username=REPLACE(REPLACE(REPLACE(M.Provee_RS, 'N°',''), '.R.L.', ''), ' ', '')\nAND C.Nombre=M.Provee_Ciudad\nAND R.Nombre=M.Provee_Rubro;\n</code></pre>\n\n<p>Maestra is the master Table. The another are the tables where it inserts. Inserts the U.idUsuario(created for each person previously), some more id's joined, and  the replace are because we need to create an user Name replacing some strings in the Field Provee_RS. The username is generated before.</p>\n\n<p>I run the Execution plan, the %85 was in the scanning of Master Table</p>\n\n<p><img src=\"http://i.stack.imgur.com/WjO5p.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Update 2</strong></p>\n\n<p>in this query, scanning gd_Esquema.Maestra takes %97 according execution plan.</p>\n\n<pre><code>insert into LITTLE_BOBBY_TABLES.CuponFactura\nselect m.Factura_Nro, cc.IdCompraCupon\nfrom LITTLE_BOBBY_TABLES.CompraCupon cc\njoin LITTLE_BOBBY_TABLES.Cliente c on c.idUsuario = cc.IdCliente\njoin LITTLE_BOBBY_TABLES.Promocion p on p.IdPromocion = cc.IdPromocion\njoin gd_esquema.Maestra m on \n                m.Cli_Nombre = c.Nombre and\n                m.Cli_Apellido = c.Apellido and\n                m.Groupon_Codigo = p.CodigoPromocion and\n                m.Groupon_Fecha_Compra = cc.Fecha and\n                m.Factura_Fecha is not null\n</code></pre>\n\n<p>so, how efficiently could be create index in this type of fields ? Are there any other technique for better optimization that I'm missing?</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13186511,"title":"Get the data between two LMD in Oracle","body":"<p>I have a table named </p>\n\n<pre><code>USER_BAG\n</code></pre>\n\n<p>in which I have this column</p>\n\n<pre><code>LAST_MODIFIED_DATE  DATE(7) NOT NULL\n</code></pre>\n\n<p>I need all the records whose <code>LAST_MODIFIED_DATE</code> falls between </p>\n\n<p><code>2012-08-20 16:13:19</code> and <code>2012-08-20 16:18:19</code></p>\n\n<p>I am using Oracle Database. Can anyone suggest me how can I achieve my scenario?</p>\n\n<pre><code>SELECT * FROM USER_BAG where LAST_MODIFIED_DATE between \nto_date ('2012-08-20 16:13:19', 'yyyy-mm-dd hh24:mi:ss') AND \nto_date ('2012-08-20 16:18:19', 'yyyy-mm-dd hh24:mi:ss');\n</code></pre>\n\n<p>Anything wrong I am doing in the above sql query? I am working with Oracle. It always gives me-</p>\n\n<pre><code>[WARN]Execute Error : ORA-02392: exceeded session limit on CPU usage, you are being logged off (DBD ERROR: OCIStmtExecute)\n[WARN]Fetch Error : ERROR no statement executing (perhaps you need to call execute first)\n\nNo Matches Found\n</code></pre>\n\n<p><strong>Update:-</strong></p>\n\n<pre><code>select * from user_resource_limits;\n\nRESOURCE_NAME               LIMIT \nCOMPOSITE_LIMIT             UNLIMITED \nSESSIONS_PER_USER           5 \nCPU_PER_SESSION             100 \nCPU_PER_CALL                UNLIMITED \nLOGICAL_READS_PER_SESSION   10000 \nLOGICAL_READS_PER_CALL      UNLIMITED \nIDLE_TIME                   UNLIMITED \nCONNECT_TIME                15 \nPRIVATE_SGA                 UNLIMITED \n</code></pre>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13188603,"title":"can't specify target table for UPDATE in FROM clause","body":"<p>I am trying to execute the following query:</p>\n\n<pre><code>update table3 d set status = 'Complete'\nwhere d.id in \n(\n    select b.id from table1 a, table3 b, table2 c\n    where a.id = b.table1_id\n    and c.id = b.table2_id\n    and c.examId = 16637                 -- will be passed in by user\n    and a.id in (46,47,48,49)            -- will be passed in by user\n);\n</code></pre>\n\n<p>So, I'm trying to update multiple rows of <code>table3</code>. </p>\n\n<p><code>table3</code> is a join table between <code>table1</code> and <code>table2</code>. </p>\n"},{"tags":["sql","sql-server","tsql","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13188610,"title":"Sql group by working not properly","body":"<p>This is my query</p>\n\n<pre><code>select  \n (sum(case when offer1_delivered is not null then 1 else null end) ) as PenetrationRate1\n,(sum(case when offer2_delivered is not null then 1 else null end)) as PenetrationRate2\n,count(TargetMkgListID) as TargetMkgListID from tablename\n</code></pre>\n\n<h1>output</h1>\n\n<pre><code>PenetrationRate1    PenetrationRate2    TargetMkgListID \n1                   2                3\n</code></pre>\n\n<p>I need to include customername column in this query</p>\n\n<pre><code>select  customername,\n (sum(case when offer1_delivered is not null then 1 else null end) ) as PenetrationRate1\n,(sum(case when offer2_delivered is not null then 1 else null end)) as PenetrationRate2\n,count(TargetMkgListID) as TargetMkgListID from tablename\ngroup by customername\n</code></pre>\n\n<p>If I include customername in my query, groupby is not working properly.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13188145,"title":"How to order a a content in ascending order in a database field (SQL)","body":"<p>I have this query below:</p>\n\n<pre><code>   SELECT q.QuestionId,GROUP_CONCAT(DISTINCT Answer SEPARATOR '') AS Answer\n   FROM Question q\n   INNER JOIN Answer an ON q.QuestionId = an.QuestionId\n   GROUP BY an.QuestionId\n</code></pre>\n\n<p>NOw where you can see in my select statement I have this field <code>(DISTINCT Answer SEPARATOR '') AS Answer</code>. Now lets say in the output it outputs this below:</p>\n\n<pre><code>Answer\n\nECB\nFDA\n</code></pre>\n\n<p>I want the Answers to be ordered in alphabetical  order so that it displays its like below:</p>\n\n<pre><code>Answer\n\nBCE\nADF\n</code></pre>\n\n<p>Does anyone know what I need to change in the SQL in order to acheieve this?</p>\n"},{"tags":["php","database","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13188461,"title":"Removing Duplicate Data From SQL Query Output For Display On A Web Page","body":"<p>I had asked <a href=\"http://stackoverflow.com/questions/11086726/php-sql-combine-records-within-foreach\">a similar question on stackoverflow</a> but didn't really get anywhere.</p>\n\n<p><a href=\"http://www.flcbranson.org/events-array.php\" rel=\"nofollow\">This page</a> shows the output that I'm currently getting from my MSSQL server.</p>\n\n<p>I have a table of venue information (name, address, etc...) that our events happen on.  Separately, I have a table of the actual events that are scheduled (an event may happen multiple times in one day and/or over multiple days).  I join those tables with this query:</p>\n\n<pre><code>&lt;?php\ntry {\n    $dbh = new PDO(\"sqlsrv:Server=localhost;Database=Sermons\", \"\", \"\");\n    $dbh-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n    $sql = \"SELECT TOP (100) PERCENT dbo.TblSermon.Day, dbo.TblSermon.Date, dbo.TblSermon.Time, dbo.TblSermon.Speaker, dbo.TblSermon.Series, dbo.TblSermon.Sarasota, dbo.TblSermon.NonFlc, dbo.TblJoinSermonLocation.MeetingName, dbo.TblLocation.Location, dbo.TblLocation.Pastors, dbo.TblLocation.Address, dbo.TblLocation.City, dbo.TblLocation.State, dbo.TblLocation.Zip, dbo.TblLocation.Country, dbo.TblLocation.Phone, dbo.TblLocation.Email, dbo.TblLocation.WebAddress\n        FROM dbo.TblLocation RIGHT OUTER JOIN dbo.TblJoinSermonLocation ON dbo.TblLocation.ID = dbo.TblJoinSermonLocation.Location RIGHT OUTER JOIN dbo.TblSermon ON dbo.TblJoinSermonLocation.Sermon = dbo.TblSermon.ID\n        WHERE (dbo.TblSermon.Date &gt;= { fn NOW() })\n        ORDER BY dbo.TblSermon.Date, dbo.TblSermon.Time\";\n    $stmt = $dbh-&gt;prepare($sql);\n    $stmt-&gt;execute(); \n    $stmt-&gt;setFetchMode(PDO::FETCH_ASSOC);\n    foreach ($stmt as $row) {\n        echo \"&lt;pre&gt;\";\n        print_r($row);\n        echo \"&lt;/pre&gt;\";\n    }\n    unset($row);\n    $dbh = null;\n}\ncatch(PDOException $e) {\n    echo $e-&gt;getMessage();\n}\n?&gt;\n</code></pre>\n\n<p>So, as it loops through the query results, it creates an array for each record and ends up like this:</p>\n\n<pre><code>Array\n(\n    [Day] =&gt; Tuesday\n    [Date] =&gt; 2012-10-30 00:00:00.000\n    [Time] =&gt; 07:00 PM\n    [Speaker] =&gt; Keith Moore\n    [Location] =&gt; The Ark Church\n    [Pastors] =&gt; Alan &amp; Joy Clayton\n    [Address] =&gt; 450 Humble Tank Rd.\n    [City] =&gt; Conroe\n    [State] =&gt; TX\n    [Zip] =&gt; 77305.0\n    [Phone] =&gt; (936) 756-1988\n    [Email] =&gt; info@thearkchurch.com\n    [WebAddress] =&gt; http://www.thearkchurch.org\n)\nArray\n(\n    [Day] =&gt; Wednesday\n    [Date] =&gt; 2012-10-31 00:00:00.000\n    [Time] =&gt; 07:00 PM\n    [Speaker] =&gt; Keith Moore\n    [Location] =&gt; The Ark Church\n    [Pastors] =&gt; Alan &amp; Joy Clayton\n    [Address] =&gt; 450 Humble Tank Rd.\n    [City] =&gt; Conroe\n    [State] =&gt; TX\n    [Zip] =&gt; 77305.0\n    [Phone] =&gt; (936) 756-1988\n    [Email] =&gt; info@thearkchurch.com\n    [WebAddress] =&gt; http://www.thearkchurch.org\n)\nArray\n(\n    [Day] =&gt; Tuesday\n    [Date] =&gt; 2012-11-06 00:00:00.000\n    [Time] =&gt; 07:00 PM\n    [Speaker] =&gt; Keith Moore\n    [Location] =&gt; Fellowship Of Faith Christian Center\n    [Pastors] =&gt; Michael &amp; Joan Kalstrup\n    [Address] =&gt; 18999 Hwy. 59\n    [City] =&gt; Oakland\n    [State] =&gt; IA\n    [Zip] =&gt; 51560.0\n    [Phone] =&gt; (712) 482-3455\n    [Email] =&gt; ffcc@frontiernet.net\n    [WebAddress] =&gt; http://www.fellowshipoffaith.cc\n)\nArray\n(\n    [Day] =&gt; Wednesday\n    [Date] =&gt; 2012-11-14 00:00:00.000\n    [Time] =&gt; 07:00 PM\n    [Speaker] =&gt; Keith Moore\n    [Location] =&gt; Faith Family Church\n    [Pastors] =&gt; Michael &amp; Barbara Cameneti\n    [Address] =&gt; 8200 Freedom Ave NW\n    [City] =&gt; Canton\n    [State] =&gt; OH\n    [Zip] =&gt; 44720.0\n    [Phone] =&gt; (330) 492-0925\n    [Email] =&gt; \n    [WebAddress] =&gt; http://www.myfaithfamily.com\n)\n</code></pre>\n\n<p>As you can see, The Ark Church and its associated contact information is duplicated, so when I work with those arrays and output them to the page, I see a bunch of duplicate content.</p>\n\n<p>I'd like to remove the duplicate information so that I get results similar to this:</p>\n\n<pre><code>The Ark Church\nAlan &amp; Joy Clayton\n450 Humble Tank Rd.\nConroe, TX  77305\n(936) 756-1988\ninfo@thearkchurch.com\nhttp://www.thearkchurch.org\nMeetings:\nTuesday, 2012-10-30 07:00 PM\nWednesday, 2012-10-31 07:00 PM\n\nFellowship Of Faith Christian Center\nMichael &amp; Joan Kalstrup\n18999 Hwy. 59\nOakland, IA  51560\n(712) 482-3455\nffcc@frontiernet.net\nhttp://www.fellowshipoffaith.cc\nMeetings:\nTuesday, 2012-11-06 07:00 PM\n\nFaith Family Church\nMichael &amp; Barbara Cameneti\n8200 Freedom Ave NW\nCanton, OH  44720\n(330) 492-0925\nhttp://www.myfaithfamily.com\nMeetings:\nWednesday, 2012-11-14 07:00 PM\n</code></pre>\n\n<p>It doesn't necessarily have to end up like that (I'm not looking for code specific for these results, but a concept of how to not show the duplicated information).  I'm assuming that an additional <code>foreach</code> or <code>while</code> will do it, but I haven't figured out any logic that says <code>&lt;?php if ($location == $previouslocation) echo \"\"; ?&gt;</code>.</p>\n"},{"tags":["php","sql","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":13188336,"title":"How to get the average price based on multiple room prices","body":"<p>I have table called room_prices that store different prices according to the date specified. Here's the sample data.</p>\n\n<pre><code>id  room_id date_from   date_to     price\n1   1                               3500.00\n25  1       7/28/2012   7/29/2012   3600.00\n27  1       8/24/2012   8/27/2012   3000.00\n49  1       11/12/2012  11/16/2012  4000.00\n</code></pre>\n\n<p>The first row is the default price of room 1 (room_id = 1).</p>\n\n<p>When guest reserve a room, the system will first look at the prices on room_prices table. If the date reserved by guest was found on the table it will get the price according to the date selected and not the default price.</p>\n\n<p>Ex.</p>\n\n<p>If the guest reserved a room from 11/10/2012 to 11/11/2012 then the price should be 3,500.\nIf the guest reserved a room from 11/12/2012 to 11/14/2012 then the price should be 4,000.</p>\n\n<p>If the guest reserved a room from 11/10/2012 to 11/13/2012 then the average price should be 3750. See table below:</p>\n\n<pre><code>11/10/2012  3500\n11/11/2012  3500\n11/12/2012  4000\n11/13/2012  4000\n            3750\n</code></pre>\n\n<p>So my question is if there is a single SQL code to get the average price.</p>\n\n<p>update:</p>\n\n<p>I tried this sql to no avail:</p>\n\n<pre><code>SELECT avg(price) as avg_price\n                        FROM lf_rooms_prices\n                        WHERE room_id = 1\n                        AND ((DATE_FORMAT(date_from, '%m/%d/%Y') &gt;= '11/10/2012' \n                        AND DATE_FORMAT(date_from, '%m/%d/%Y') &lt; '11/10/2012') \n                        OR (DATE_FORMAT(date_to, '%m/%d/%Y') &gt; '11/13/2012' \n                        AND DATE_FORMAT(date_to, '%m/%d/%Y') &lt;= '11/13/2012'))\n</code></pre>\n\n<p>btw, I'm using codeigniter.</p>\n"},{"tags":["sql","sql-server","ssas","mdx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13074781,"title":"Access system tables in calculation","body":"<p>Is there a way to access system tables in a SSAS cube calcuation? </p>\n\n<p>For example the following query can be executed on a SSAS cube to return a last processed date:</p>\n\n<pre><code>SELECT LAST_DATA_UPDATE FROM $System.MDSCHEMA_CUBES WHERE CUBE_NAME = 'Cube'\n</code></pre>\n\n<p>How would one access this information in a calculation?</p>\n\n<p><strong>Background:</strong> We were using ASSP before (a third party sproc) to get the last cube processed date. Recently, this sproc threw an exception on one of our cubes and caused SSAS to go down. Using the above line of MDX did not have this behavior. I would rather not have our cube depend on third party code so I am looking for a way to access LAST_DATA_UPDATE in a calc for a specific cube name.</p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13188158,"title":"Transpose / Pivot distinct row attribute as column and group another attribute?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10404348/sql-server-dynamic-pivot-query\">SQL Server dynamic PIVOT query?</a>  </p>\n</blockquote>\n\n\n\n<p>Is it possible to execute a query on the following table:</p>\n\n<pre><code>Game    Player  Goals\n-----   ------  ------\nGame1   John    1\nGame1   Paul    0\nGame1   Mark    2\nGame1   Luke    1\nGame2   John    3\nGame2   Paul    1   \nGame2   Luke    1\nGame3   John    0\nGame3   Mark    2\n</code></pre>\n\n<p>which gives a result like this:</p>\n\n<pre><code>Game    John    Paul    Mark    Luke\n-----   ----    ----    ----    ----\nGame1   1       0       2       1\nGame2   3       1       -       1\nGame3   0       -       2       -\n</code></pre>\n\n<p>It turns each distinct player into a column and groups the games gives goals per game per player.</p>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":13163057,"title":"PostgreSQL - select only when specific multiple apperance in column","body":"<p>I'm using PostgreSQL.\nI have a table with 3 fields\nperson, recipe and ingredient</p>\n\n<pre><code>person = creator of the recipe\nrecipe = the recipe\ningredient = one of the ingredients in the recipe\n</code></pre>\n\n<p>I want to create a query which results in every person who whenever has added carrot to a recipe, the person must also have added salt to the same recipe.</p>\n\n<p>More than one person can have created the recipe, in which case the person who added the ingredient will be credited for adding the ingredient. Sometimes the ingredient is used more than once, even by the same person.</p>\n\n<p>If this the table:</p>\n\n<pre><code>person1, rec1, carrot\nperson1, rec1, salt\nperson1, rec1, salt\nperson1, rec2, salt\nperson1, rec2, pepper\nperson2, rec1, carrot\nperson2, rec1, salt\nperson2, rec2, carrot\nperson2, rec2, pepper\nperson3, rec1, sugar\nperson3, rec1, carrot\n</code></pre>\n\n<p>Then I want this result:\nperson1</p>\n\n<p>Because this person is the only one who whenever has added carrot also have added salt.</p>\n\n<p>\"Nothing but the carrot could affect the result. I only want persons who has added at least one carrot in one of their recipes, but I don't want persons who have not also added salt to all of the same recipes they've added carrot to. Sorry, but I just can't explain it any clearer than that.\"</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13186879,"title":"Querying data groups with total row before starting next group?","body":"<p>I need to query some data in the below format in SQL Server:</p>\n\n<ul>\n<li>Id   Group   Price </li>\n<li>1    A   10</li>\n<li>2    A   20 </li>\n<li><p><strong>Sum    30</strong> </p></li>\n<li><p>1    B   6</p></li>\n<li>2    B   4 </li>\n<li><p><strong>Sum    10</strong> </p></li>\n<li><p>1    C   100</p></li>\n<li>2    C   200 </li>\n<li><strong>Sum    300</strong> </li>\n</ul>\n\n<p>I was thinking to do it in the follwoing steps:</p>\n\n<ol>\n<li>Query one group</li>\n<li>In other query do sum</li>\n<li>Use Union operator to combine this result set</li>\n<li>Do step 1-3 for all groups and finally return all sub sets of data using union.</li>\n</ol>\n\n<p>Is there a better way to do this ? May be using some out of box feature ? Please advise.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>As per suggestions and code sample I tried this code:</p>\n\n<pre><code>Select \nCase \nwhen id is null then 'SUM' \nelse CAST(id as Varchar(10)) end as ID,\n\nCase when [group] is null then 'ALL' else CAST([group] as Varchar(50)) end as [group]\n,Price from\n(\nSELECT Id,  [Group],BGAApplicationID,Section, SUM(PrimaryTotalArea) AS price   \nFROM vwFacilityDetails\nwhere bgaapplicationid=1102\nGROUP BY Id,  [Group],BGAApplicationID,Section  WITH ROLLUP\n) a\n</code></pre>\n\n<p>And Even this code as well:</p>\n\n<pre><code>Select Id,  [Group],BGAApplicationID,Section, SUM(PrimaryTotalArea) AS price           \nFrom   vwFacilityDetails\nWhere  Not ([group] Is Null And id Is Null And BGAApplicationId is null and section is null) and BGAApplicationId=1102\nGroup By Id,  [Group],BGAApplicationID,Section \n    With Rollup\n</code></pre>\n\n<p>In results it groups up the data but for every record it shows it 3 times (in both above codes) like:</p>\n\n<ul>\n<li>2879 Existing Facilities Whole School    25.00</li>\n<li>2879 Existing Facilities Whole School    25.00 </li>\n<li>2879 Existing Facilities    Whole School 25.00 </li>\n<li>2879 ALL 25.00</li>\n</ul>\n\n<p>I guess there is some issue in my query, please guide me here as well.\nThanks</p>\n"},{"tags":["sql","sql-server","ssas","olap"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13169055,"title":"Is it more efficient to build a cube off of tables or views?","body":"<p>I began to ponder this question after I noticed a system that I had been asked to work on had a cube based entirely off of views. I noticed that those views all joined in other tables/views and the views also had logic coded into them (if, case statements aswell as convert statements, concatation etc.). This all seemed horrible to me, but it made me wonder if one should ever base their datasource for a cube off of views?</p>\n\n<p>To me tables make more sense. It prevents expensive joins in the datasource, and also isn't prone to errors that could occur due to conversions performed by a view. However, I still see many people using views as datasources for cubes. Is there a best practice here? Am I perhaps missing some advantages that views give when used as a datasource?</p>\n"},{"tags":["mysql","sql","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13188002,"title":"ERROR 1093 (HY000): You can't specify target table 'a' for update in FROM clause","body":"<p>I have this query</p>\n\n<pre><code>UPDATE trh_adminLoginDate SET superseded = true WHERE EXISTS \n (SELECT * FROM trh_adminLoginDate AS a2 WHERE a2.adminId = a.adminId AND a2.loginDate &gt; a.loginDate AND a2.clientPlatform = a.clientPlatform)\n</code></pre>\n\n<p>and table look like this.</p>\n\n<pre><code>+----------------+--------------+------+-----+---------+----------------+\n| Field          | Type         | Null | Key | Default | Extra          |\n+----------------+--------------+------+-----+---------+----------------+\n| id             | bigint(20)   | NO   | PRI | NULL    | auto_increment |\n| dateCreated    | datetime     | NO   |     | NULL    |                |\n| version        | int(11)      | NO   |     | NULL    |                |\n| dateModified   | datetime     | NO   |     | NULL    |                |\n| adminId        | bigint(20)   | NO   | MUL | NULL    |                |\n| clientPlatform | varchar(255) | YES  |     | NULL    |                |\n| loginDate      | datetime     | YES  |     | NULL    |                |\n| superseded     | tinyint(1)   | NO   |     | NULL    |                |\n+----------------+--------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>When I execute this query I get the below error:</p>\n\n<pre><code>ERROR 1093 (HY000): You can't specify target table 'a' for update in FROM clause\n</code></pre>\n\n<p>I can create temporary table and keep the result of the sub-query and then do the UPDATE. But I don't want to do in this way. Can someone suggest me better way of doing this?</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13188023,"title":"What's the purpose of distinct in this query?","body":"<p>Today, I came across a query on W3Schools here : <a href=\"http://www.w3schools.com/sql/sql_view.asp\" rel=\"nofollow\">http://www.w3schools.com/sql/sql_view.asp</a> which was written as below:</p>\n\n<pre><code>CREATE VIEW [Category Sales For 1997] AS\nSELECT DISTINCT CategoryName,Sum(ProductSales) AS CategorySales\nFROM [Product Sales for 1997]\nGROUP BY CategoryName\n</code></pre>\n\n<p>I am wondering what's the purpose of using <code>DISTINCT</code> in this query? The query has already <code>GROUPed BY</code> the result set, so there is no chances of same <code>CategoryName</code> after doing <code>GROUP BY</code> and before doing <code>SELECT</code>. Would this query behave differently if it did not use <code>DISTINCT</code>? I mean what would happen if it was written simply as this:</p>\n\n<pre><code>CREATE VIEW [Category Sales For 1997] AS\nSELECT CategoryName,Sum(ProductSales) AS CategorySales\nFROM [Product Sales for 1997]\nGROUP BY CategoryName\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["mysql","sql","join","subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13186402,"title":"Use column in 3rd level sub query","body":"<p>How can I use a column from the top level <code>SELECT</code> in the 3rd level sub query?</p>\n\n<p>I tried this but its gives: <code>unknown column foo.id</code></p>\n\n<pre><code>SELECT foo.id,\n       (\n           SELECT SUM(bar.amount)\n           FROM bar\n           JOIN (\n               SELECT DISTINCT ding.id\n               FROM baz\n               JOIN ding ON ding.baz_id = baz.id\n               WHERE baz.foo_id = foo.id\n           ) AS j ON j.id = bar.id\n       ) AS amount,\nFROM foo\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13187664,"title":"SQL Query for multiple tables (foreign keys involved)","body":"<p>I currently have 5 tables in MySQL database. Some of them share foreign keys and are interdependent of each other. I am trying to create a query that will show all the results side by side(<code>major</code>, <code>course</code>, <code>semester</code>, etc). The query I created query it is not displaying my desired results since I have not added the other tables. I am not sure how to implement the other tables.  How can I modify the mysql-query to display all the results in order? </p>\n\n<p><strong>Query</strong></p>\n\n<pre><code>select * from course left join major on course.id = majors.id left join majors on courses_major_xref.majors_id = majors.id\n</code></pre>\n"},{"tags":["sql","concurrency","db2","persistence","mybatis"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13129747,"title":"How do I INSERT if a row does not already exist with four zillion concurrent threads?","body":"<p>I need to do the following in four zillion threads at the same time (well, probably closer to 2 threads, but either way...): If such-and-such does not exist, insert it.</p>\n\n<p>Currently, the application says:</p>\n\n<pre><code>select rows from the db\nif row count == 0,\n    do some stuff\n    insert a row\n</code></pre>\n\n<p>I have a situation where this is run in 2 separate threads at the same time. This way, the 2 threads may (and in fact do every time so far) each check for existing rows before either thread inserts rows; therefore we have duplicate rows. This is bad.</p>\n\n<p>All the algorithms I can think of fall short one way or another.  </p>\n\n<p>For example, if I do this:</p>\n\n<pre><code>open tx\ninsert a row\nselect rows\nif row count &gt; 2, rollback\nelse commit\n</code></pre>\n\n<p>when the transaction uses <code>READ_COMMITTED</code> isolation, then one thread won't see another thread's inserted rows, and duplicates are possible. With <code>READ_UNCOMMITTED</code> isolation, each thread may see the other thread's rows and both will rollback. I think I'll have the same problem if I use a <code>MERGE</code> statement instead of inserting then selecting (or vice versa).</p>\n\n<p>Is there an algorithm to use to guarantee that exactly 1 row will be inserted when the above algorithm is executed concurrently? FWIW, I'm using DB2, mybatis, and xml-based tx management with Spring, but I'll gladly translate from something else if possible.  </p>\n\n<p>I'm a newbie when it comes to concurrency, so if this question reveals ignorance remedied by a book or article you know of, please share.</p>\n\n<p>EDIT:</p>\n\n<p>The insert statement above is to lazily grant users something iff they don't have it.  In this case, a uniqueness constraint would be appropriate.  Elsewhere in the app, however, it would not be appropriate.  :(  </p>\n\n<p>I'll make the example a bit more concrete soon so it's easier to understand.</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":13159366,"title":"SQL Logic to filter-out BAD data","body":"<p>SQL Smarties,</p>\n\n<p>I need your advice to filter-out bad records from the following data set. Here's my SQL;</p>\n\n<pre><code>select *\n  from TEST_DATA\n where ( (metric = 'R' and seg &lt;&gt; -2) or metric = 'S' ) \n   or ( ( seg &lt;&gt; -2 and metric = 'B') and (src &lt;&gt; 'RON' and metric = 'B') )\n</code></pre>\n\n<p>This SELECT statement works but I need your feedback to see if there is a way to simplify it. Also I created STS column to see if my SQL logic works. Visually saves time compared to scanning all the records to identify what is BAD or GOOD. So I can't use STS &lt;> 'BAD' or STS = 'GOOD'</p>\n\n<p>Thank you...</p>\n\n<pre><code>CREATE TABLE TEST_DATA  ( ID int, SEG int, METRIC varchar(1), SRC varchar(5), STS varchar(5) );\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (1, -2, 'R', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (2, -2, 'R', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (3, -2, 'R', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (4, -100, 'R', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (5, -100, 'R', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (6, -100, 'R', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (7, -2, 'S', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (8, -2, 'S', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (9, -2, 'S', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (10, -2, 'S', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (11, -2, 'S', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (12, -2, 'S', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (13, -100, 'S', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (14, -100, 'S', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (15, -100, 'S', 'RON', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (16, -100, 'S', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (17, -100, 'S', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (18, -100, 'S', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (19, -2, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (20, -2, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (21, -2, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (22, -2, 'B', 'MATT', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (23, -2, 'B', 'MATT', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (24, -2, 'B', 'MATT', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (25, -100, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (26, -100, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (27, -100, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (28, -100, 'B', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (29, -100, 'B', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (30, -100, 'B', 'MATT', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (31, -200, 'B', 'IAN', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (32, -200, 'B', 'IAN', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (33, -200, 'B', 'IAN', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (34, -200, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (35, -2, 'B', 'RON', 'BAD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (36, -100, 'B', 'HARRY', 'GOOD');\nINSERT INTO TEST_DATA (ID, SEG, METRIC, SRC, STS) VALUES (37, -2, 'R', 'RON', 'BAD');\n</code></pre>\n"},{"tags":["sql","performance","indexing","db2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13148822,"title":"How should I improve my query performance?","body":"<p>I have created a table with a couple of columns.</p>\n\n<p>MyTable </p>\n\n<ul>\n<li>Column1 -> RecordId (int)</li>\n<li>Column2 -> Title (varchar)</li>\n<li>Column3 -> Shortname (varchar)</li>\n<li>Column4 ->  (varchar) </li>\n<li><p>Column5 -> varchar</p>\n\n<p>...</p>\n\n<p>...</p></li>\n<li>Column10 -> varchar</li>\n</ul>\n\n<p>I am not joining this table with any other tables. I have 4 rows of data in the table.</p>\n\n<p>When I am querying for title, shortname for a particular RecordId, the query seems to be too slow. It nearly takes 7 seconds to load the page. </p>\n\n<p>I haven't used any indexing on my tables. Can you please suggest how do I improve my table/query performance? </p>\n\n<p>I am making db connection from my jsp in order to display the query results in the listbox. </p>\n\n<p>My code looks something like this- \nconn= DataObjectConnectionPool.getInstance().getConnection();\nprepStmt = conn.prepStmt(\"select title,shortname from MyTable where RecordId=1\");</p>\n"},{"tags":["php","mysql","sql","database","salt"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":196,"score":5,"question_id":11869428,"title":"How to generate random string to salt passowrd in sql?","body":"<p>Got a question salting passwords in sql:</p>\n\n<p>The code below salts a particular password by randomly generating a 10 character string:</p>\n\n<pre><code>Update Teacher \nSET    TeacherSalt = SUBSTRING(MD5(RAND()), -10), \n       TeacherPassword = SHA1(CONCAT('009b9b624aaecc4b3217dcd4bfee15ab704745d7',SUBSTRING(MD5(RAND()), -10)))\nWHERE TeacherPassword = '009b9b624aaecc4b3217dcd4bfee15ab704745d7'\n</code></pre>\n\n<p>But what my question is that I want to change the salt so that the string it is generating comes from all of these characters:</p>\n\n<p>./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789</p>\n\n<p>There are 63 characters. The php way of doing this is below:</p>\n\n<pre><code>$salt = \"\"; \nfor ($i = 0; $i &lt; 40; $i++) { \n   $salt .= substr(\n     \"./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", \n     mt_rand(0, 63), \n     1); \n}\n</code></pre>\n\n<p>But how can I write this in the sql way above?</p>\n"},{"tags":["php","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13187384,"title":"Can the query below be corrected","body":"<p>I need some help in  the query I have where I don't know if I am including the Correct GROUP BY Clause and selecting the fields from the right tables in the SELECT clause:</p>\n\n<p>Below is the database Tables:</p>\n\n<p><strong>Session Table</strong></p>\n\n<pre><code>SessionId  SessionName\n1          AAA\n2          AAB\n</code></pre>\n\n<p><strong>Question Table</strong></p>\n\n<pre><code>SessionId  QuestionId  QuestionContent            QuestionMarks\n1          1           What is 2+2?               2\n1          2           What is 4+4?               3\n2          1           What is 10+10 and 11+11?   5\n2          2           What is 15+15?             5\n2          3           What is 20+20 and 40+40?   7\n</code></pre>\n\n<p><strong>Answer Table</strong></p>\n\n<pre><code>AnswerId SessionId  QuestionId Answer\n1        1          1          B\n2        1          2          C\n3        2          1          A\n4        2          1          D\n5        2          2          A\n6        2          3          D\n7        2          3          E\n</code></pre>\n\n<p>Below is the query:</p>\n\n<pre><code>   $query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, GROUP_CONCAT(DISTINCT Answer SEPARATOR '') AS Answer, q.QuestionMarks \n   FROM Session s \n   INNER JOIN Question q ON s.SessionId = q.SessionId\n   JOIN Answer an ON q.QuestionId = an.QuestionId\n   WHERE SessionName = \"AAB\"\n   GROUP BY an.SessionId, an.QuestionId\n   \";\n</code></pre>\n\n<p>I want to display each question which belongs to session \"AAB\". So it should display QuestionId, QuestionContent, Answer and QuestionMarks like below:</p>\n\n<pre><code> QuestionId  QuestionContent              Answer  QuestionMarks\n    1           What is 10+10 and 11+11?     AD       5\n    2           What is 15+15                A        5\n    3           What is 20 + 20 and 40+40?   DE       7\n</code></pre>\n\n<p>At the moment if I am search for lets say questions in Session \"AAB\", it is displaying this below:</p>\n\n<pre><code>QuestionId  QuestionContent              Answer  QuestionMarks\n    1           What is 10+10 and 11+11?     AD       5\n    2           What is 15+15                A        5\n    3           What is 20 + 20 and 40+40?   DE       7\n    1           What is 10+10 and 11+11?     AD       5\n    2           What is 15+15                A        5\n    3           What is 20 + 20 and 40+40?   DE       7\n    1           What is 10+10 and 11+11?     AD       5\n    2           What is 15+15                A        5\n    3           What is 20 + 20 and 40+40?   DE       7\n    1           What is 10+10 and 11+11?     AD       5\n    2           What is 15+15                A        5\n    3           What is 20 + 20 and 40+40?   DE       7\n    1           What is 10+10 and 11+11?     AD       5\n    2           What is 15+15                A        5\n    3           What is 20 + 20 and 40+40?   DE       7\n</code></pre>\n"},{"tags":["sql","oracle","index"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13187546,"title":"Show me the index on the table in Oracle","body":"<p><strong>Problem Statement:-</strong></p>\n\n<p>Given a oracle table name how can I find out whether there is any index being created on a particular column in that table?</p>\n\n<p>I know its a very basic question, I am not that much familiar with SQL stuff so that's why having problem. So posting here if anyone can help me out?</p>\n"},{"tags":["sql","sql-server"],"answer_count":9,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13179603,"title":"Computed columns with null","body":"<p>I am creating a view (using MS sql 2008) with creates a calculated field as a <code>COLUMN1 + COLUMN2</code>. Everything is fine and dandy but: Both <code>COLUMN1</code> and <code>COLUMN2</code> can be NULL.</p>\n\n<p>I want to follow the following rule:</p>\n\n<ul>\n<li>2 + 2 = 4</li>\n<li>2 + NULL = 2</li>\n<li>NULL + 2 = 2</li>\n<li>0 + 0 =  0</li>\n<li>NULL + NULL = NULL</li>\n</ul>\n\n<p>If I use ISNULL(column2, 0), then all the rules will be followed but not the last one.</p>\n\n<p>How do I need to create the view </p>\n\n<pre><code>CREATE VIEW dbo.test\nAS\nSELECT COLUMN1, COLUMN2, (????????) AS CALCULATEDCOL FROM dbo.TabTest;\nGO\n</code></pre>\n"},{"tags":["sql","mysql","greatest-n-per-group","ranking"],"answer_count":4,"favorite_count":4,"up_vote_count":15,"down_vote_count":0,"view_count":13816,"score":15,"question_id":2129693,"title":"mysql: Using LIMIT within GROUP BY to get N results per group?","body":"<p>The following query:</p>\n\n<pre><code>SELECT\nyear, id, rate\nFROM h\nWHERE year BETWEEN 2000 AND 2009\nAND id IN (SELECT rid FROM table2)\nGROUP BY id, year\nORDER BY id, rate DESC\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>year    id  rate\n2006    p01 8\n2003    p01 7.4\n2008    p01 6.8\n2001    p01 5.9\n2007    p01 5.3\n2009    p01 4.4\n2002    p01 3.9\n2004    p01 3.5\n2005    p01 2.1\n2000    p01 0.8\n2001    p02 12.5\n2004    p02 12.4\n2002    p02 12.2\n2003    p02 10.3\n2000    p02 8.7\n2006    p02 4.6\n2007    p02 3.3\n</code></pre>\n\n<p>What I'd like is only the top 5 results for each id (so you'd get 2006, 203, 2008, 2001, 2007 for p01 and 2001, 2004, 2002, 2003 for p02). Is there a way to do this using some kind of LIMIT like modifier that works w/in the GROUP BY?</p>\n\n<p>Thanks!</p>\n"},{"tags":["iphone","sql","ios","ipad","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12214966,"title":"Swap the order of items in a SQLite database","body":"<p>I retrieve an ordered list of items from a table of items in a Sqlite Database. How can I swap the id so the order of two items in the Sqlite database table?. </p>\n"},{"tags":["c#","sql","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13185818,"title":"Using LINQ, How do I return objects from a GroupBy clause?","body":"<p>Thanks for looking!</p>\n\n<h1>Background</h1>\n\n<p>Within my C# code, I am calling a stored procedure from a MSSQL database that returns a history of orders that a user has made.  I use the Entity Framework for this.  Here is the code:</p>\n\n<pre><code>var db = new CustomerEntities();\nreturn db.GetOrderHistoryByUserId(id);\n</code></pre>\n\n<p>The output of this stored procedure is a list of orders with multiple records having the same <code>OrderNumber</code> because there may have been multiple products in a given order.  So I modified my code to look like this:</p>\n\n<pre><code>var db = new CustomerEntities();\nreturn db.GetOrderHistoryByUserId(id).GroupBy(p =&gt; p.OrderNumber);\n</code></pre>\n\n<p>I was hoping to now have a list of <code>Order</code> objects with nested <code>Product</code> objects, but instead this code essentially produced the same response as before.</p>\n\n<p>Ultimately, I just want to convert this query into a JSON response that looks something like this:</p>\n\n<pre><code>Orders : [\n{\nOrderNumber : 1,\nOrderTotal: $500,\nProducts: [\n  {ProductSku : 11111, ProductPrice: $200},\n  {ProductSku : 22222, ProductPrice: $300}\n]\n}\n]\n</code></pre>\n\n<p>I am using MVC 4 to aid in producing the JSON output, so I am already clear on that part, I just need to know how to consume the results of the stored procedure in a manner that produces an array of objects with the desired structure.</p>\n\n<h1>Question</h1>\n\n<p>Is there a way of producing this desired object structure with the original LINQ call to the stored procedure, or am I going to need to iterate the results of the stored procedure and construct a new object?</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13187035,"title":"Find uniqueidentifier in varbinary","body":"<p>I am pretty weak on sql, but have been tasked with fixing existing functionality. Basically there are numerous uniqueidentifiers which have been stored in a varbinary(max) and I want to pull out the appropriate one. I have tried <code>\nSELECT * FROM MyTable WHERE\nCONVERT(varbinary,[fieldId]) IN (fieldvarBinary)</code>\nAlong with a few other simple queries - but nothing seems to be pulling back the appropriate records. Am I missing something obvious?</p>\n\n<p>EDIT: Example data from field - <code>0x4B9E33FF49A41F4290C51298E20A8515</code> </p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13183880,"title":"how to perform a bitwise operator on result in postegres?","body":"<p>If I have several rows, and I would like to perform a bitwise OR on the result, how can I do this in Postgres 9.x ?</p>\n\n<p>e.g.\nmy table contains</p>\n\n<pre><code>Name col1 col2\n--------------\nJohn    1    2\nWalter  1    1\nRon     1    2\n</code></pre>\n\n<p>I know would like to perform select statements so that I get OR of all (or a subset of) values from a column.</p>\n\n<p>E.g.</p>\n\n<pre><code>select [magical statement OR col1] from table\nwould give me\n1\n\nselect [magical statement OR col2] from table\nwould give me\n3\n</code></pre>\n\n<p>I hope you can understand what I mean, I cant figure out what the proper term is for what I want.</p>\n"},{"tags":["mysql","sql","database","query","query-optimization"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13080770,"title":"mysql query optimization","body":"<p>I got tasked to help speed up this query and I think some of the indexes on these tables are not setup properly.  I also believe they're not all going to be used b/c a function is applied to the col that I have an index on. can anyone see how I can optimize these tables or query?   The <code>requests</code> table will be the largest table of the 3 and will have upwards of 200k+ records. <code>devices</code> currently is sitting ~500 records and <code>clients</code> will be smaller as well.</p>\n\n<p>Query:</p>\n\n<pre><code>explain extended SELECT MAX(Request.datetime) AS datetime, Device.id,\n       Device.client_id, Device.mac_address, Device.type, Device.manufacturer,\n       Device.model_number, Client.id, Client.email_address,\n       Request.device_id, Request.datetime, Request.ip_address\n  FROM livefi.devices AS Device\n  LEFT JOIN livefi.clients AS Client\n    ON (Client.id         = Device.client_id)\n INNER JOIN livefi.requests AS Request\n    ON (Request.device_id = Device.id)\n GROUP BY Request.device_id, Request.client_id\n\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n| id | select_type | table   | type   | possible_keys                                           | key           | key_len | ref                     | rows | filtered | Extra                           |\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n|  1 | SIMPLE      | Device  | ALL    | PRIMARY                                                 | NULL          | NULL    | NULL                    |  617 |   100.00 | Using temporary; Using filesort |\n|  1 | SIMPLE      | Client  | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | livefi.Device.client_id |    1 |   100.00 |                                 |\n|  1 | SIMPLE      | Request | ref    | idx_device_id,inx_requests_deviceId_datetime_ip_address | idx_device_id | 5       | livefi.Device.id        |  144 |   100.00 | Using where                     |\n+----+-------------+---------+--------+---------------------------------------------------------+---------------+---------+-------------------------+------+----------+---------------------------------+\n3 rows in set, 1 warning (0.04 sec)\n</code></pre>\n\n<p>Tables:</p>\n\n<pre><code>CREATE TABLE `clients` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `email_address` varchar(100) DEFAULT NULL,\n  `mac_address` varchar(17) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `email_address` (`email_address`),\n  KEY `idx_mac_address` (`mac_address`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\n\nCREATE TABLE `devices` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `client_id` int(10) unsigned DEFAULT NULL,\n  `mac_address` varchar(17) DEFAULT NULL,\n  `type` varchar(25) DEFAULT NULL,\n  `manufacturer` varchar(100) DEFAULT NULL,\n  `model_number` varchar(50) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `mac_address` (`mac_address`),\n  KEY `idx_mac_address` (`mac_address`),\n  KEY `fk_devices_clients1` (`client_id`),\n  CONSTRAINT `fk_devices_clients1` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=492 DEFAULT CHARSET=utf8\n\n\nCREATE TABLE `requests` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `client_id` int(10) unsigned DEFAULT NULL,\n  `device_id` int(10) unsigned DEFAULT NULL,\n  `domain_id` int(10) unsigned DEFAULT NULL,\n  `ip_address` varchar(15) DEFAULT NULL,\n  `datetime` datetime DEFAULT NULL,\n  `gmt_offset` time DEFAULT NULL,\n  `request_method` varchar(15) DEFAULT NULL,\n  `url` text,\n  `http_protocol` varchar(20) DEFAULT NULL,\n  `http_status_code` varchar(20) DEFAULT NULL,\n  `request_size` int(10) unsigned DEFAULT '0',\n  `referer` text,\n  `user_agent` text,\n  `squid_cache_response` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `idx_client_id` (`client_id`),\n  KEY `idx_datetime` (`datetime`),\n  KEY `idx_device_id` (`device_id`),\n  KEY `idx_domain_id` (`domain_id`),\n  KEY `idx_id` (`id`),\n  KEY `idx_request_size` (`request_size`),\n  KEY `inx_requests_deviceId_datetime_ip_address` (`device_id`,`datetime`,`ip_address`),\n  CONSTRAINT `fk_requests_clients` FOREIGN KEY (`client_id`) REFERENCES `clients` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_requests_devices1` FOREIGN KEY (`device_id`) REFERENCES `devices` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_requests_domains1` FOREIGN KEY (`domain_id`) REFERENCES `domains` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=200523 DEFAULT CHARSET=utf8\n</code></pre>\n"},{"tags":["sql","progress-4gl","openedge"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13052455,"title":"How do I find user permissions for a progress database","body":"<p>What is the best method for listing users and getting their associated table permissions for a progress database?</p>\n"},{"tags":["sql","oracle","join","tree","connect"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12622003,"title":"Tree Structure with Connect BY inner join and update","body":"<p>I have 3 tables.\nThe table <code>Test</code>, <code>Folder</code> and <code>Iteration</code>.</p>\n\n<p>Every <code>test</code> is Linked with a <code>Folder</code>. \nThe <code>Folder</code>, which is linked to the <code>test</code> is a child of many other <code>folders</code>. </p>\n\n<p>From these <code>folders</code> the one on the top of the hierarchy is linked with the table <code>Iteration</code>.</p>\n\n<p>Now I want to <strong>Update</strong> the <strong>Iteration_ID</strong> in a <code>Test</code> table. So that I have a \"fast\" connection  between Test and Iteration.\nThis is my try:</p>\n\n<pre><code>    update Test a set a.Iteration_ID =\n(nvl((\n--The Select Part\n select b.ID from Iteration b inner join Folder c on b.Folder_ID = c.ID \n    where c.ID = \n    (\n        select * from \n        (\n            SELECT d.ID FROM Folder d START WITH d.ID =  135196 CONNECT BY PRIOR d.parent_id = d.id\n            order by LEVEL desc \n        )\n        where rownum= 1\n    )\n\n--End Select Part\n),0));\n</code></pre>\n\n<p>The Query above works, but I have a static ID at d.ID. I would like to set there <strong>a.Folder_ID</strong>\n:</p>\n\n<pre><code>    update Test a set a.Iteration_ID =\n(nvl((\n--The Select Part\n select b.ID from Iteration b inner join Folder c on b.Folder_ID = c.ID \n    where c.ID = \n    (\n        select * from \n        (\n            SELECT d.ID FROM Folder d START WITH d.ID =  a.Folder_ID CONNECT BY PRIOR d.parent_id = d.id\n            order by LEVEL desc \n        )\n        where rownum= 1\n    )\n\n--End Select Part\n),0));\n</code></pre>\n\n<p>The Problem is that Oracle doesn't know the a.folder_id</p>\n\n<pre><code>ORA-00904: \"A\".\"FOLDER_ID\": ungültiger Bezeichner\n00904. 00000 -  \"%s: invalid identifier\"\n</code></pre>\n\n<p>Anybody know a better way to solve the problem or to improve the query?</p>\n\n<p>For example to get the root folder withour the <code>select * from and rownum = 1</code>?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":6,"favorite_count":1,"up_vote_count":25,"down_vote_count":0,"view_count":39087,"score":25,"question_id":482885,"title":"How do I drop a foreign key constraint only if it exists in sql server?","body":"<p>I can drop a table if it exists using the following code but do not know how to do the same with a constraint:</p>\n\n<pre><code>IF EXISTS(SELECT 1 FROM sys.objects WHERE OBJECT_ID = OBJECT_ID(N'TableName') AND type = (N'U')) DROP TABLE TableName\ngo\n</code></pre>\n\n<p>I also add the constraint using this code:</p>\n\n<pre><code>ALTER TABLE [dbo].[TableName] \n  WITH CHECK ADD CONSTRAINT [FK_TableName_TableName2] FOREIGN KEY([FK_Name])\n    REFERENCES [dbo].[TableName2] ([ID])\ngo\n</code></pre>\n"},{"tags":["sql","database-design","inheritance"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":8349972,"title":"Database Table Inheritance","body":"<p><br>\nIs it possible for a table to inherit on-to-many sub tables? (I think thats how its meant to be worded :P) In others words:</p>\n\n<pre><code> PersonBase can be PersonA and/or PersonD and/or PersonC\n</code></pre>\n\n<p>However in this particular case it needs to be possible for <b>PersonBase</b> to exist multiple times as <b>PersonD</b> (there are reasons for it), could I do it this way? Or should I create another table say <b>TableD</b> such that <b>PersonBase</b> is a <b>PersonD</b> which has a one to many relationship with <b>TableD</b>. However I would prefer to be able to do it so that <b>PersonBase</b> can be multiple <b>PersonDs</b> if possible.</p>\n\n<p>Thanks All</p>\n\n<p>P.S. I apologize if my question seems naive.</p>\n"},{"tags":["sql","ms-access","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3049,"score":0,"question_id":944524,"title":"How to populate combo box with values in MS Access 2007","body":"<p>I have a database with 3 tables.</p>\n\n<p><strong>Manufact:</strong>\nID, Name, Decription</p>\n\n<p><strong>Model:</strong>\nID, Manufact_ID, Name</p>\n\n<p><strong>Order:</strong>\nID, Manufact_ID, Model_ID, Quantity, Date,</p>\n\n<p>In Access I would like to have the normal table/datasheet view for Order which gives the following output</p>\n\n<pre>\n\nID Manufact.Name Model_ID(combo box) Quantity Date  \n1  LG            W3000H-BN            10       02-01-2009\n2  SAMSUNG       SyncMaster 205BW      5       02-20-2009\n3  SAMSUNG       SyncMaster 206BW      2       03-18-2009\n4  Iiyama        ProLite E1902S-B1     1       05-13-2009\n</pre>\n\n<p>My problem is the combo box. I want to have only the list of the Models of the curent Manufacturer selectable in the combo box. e.g: only the SAMSUNG models if SAMSUNG is selected.\nI tried to set the Lookup row source for Model_ID column as </p>\n\n<pre>\nSELECT Model.ID,Model.Manufact_ID,Model.Name,Order.Manufact_ID \\ \nFROM Model, Order WHERE Order.Manufact_ID = Model.Manufact_ID\n</pre>\n\n<p>This is actually an Model INNER JOIN Order ON ... giving the wrong result.\nHow can I refer to the actual value of Order.Manufact_ID in the actual row's Lookup SELECT command? It's a variable value I cannot stringify.</p>\n\n<p>Thanks!</p>\n\n<p>strauss</p>\n"},{"tags":["sql","sql-server","query","datediff"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13185869,"title":"SQL query to get DateDiff of the last two records","body":"<p>I have a table called Event with eventNum as the primary key and date as a datetime2(7) in SQL Server 2008 R2.  I am trying to get the date of the last two rows in the table and get the difference in minutes. This is what I currently have:</p>\n\n<pre><code>Select DATEDIFF(MI, e.date,(Select e2.date from Event e2 where eventNum = (Select MAX(e2.eventNum))))\n    From Event e\n    Where eventNum = (Select MAX(e.eventNum)-1 from e)\n</code></pre>\n\n<p>and I get this error:</p>\n\n<blockquote>\n  <p>Invalid column name 'Select eventNum from Event Where eventNum =\n  Select MAX(eventNum) from Event'.</p>\n</blockquote>\n\n<p>I've changed this 100 times and can't get it to work. Any help? </p>\n"},{"tags":["sql","database","converter","iso"],"answer_count":0,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":61,"score":6,"question_id":12958286,"title":"How do I convert a database from format iso to db3?","body":"<p>How do I export a database from <a href=\"http://en.wikipedia.org/wiki/CDS_ISIS\" rel=\"nofollow\">Isis</a> to <a href=\"http://en.wikipedia.org/wiki/Microsoft_SQL_Server\" rel=\"nofollow\">SQL</a>?</p>\n\n<p>I can export the database from Isis to iso. I believe that I could convert iso to <a href=\"http://en.wikipedia.org/wiki/DBase#dBase_III\" rel=\"nofollow\">dBase 3</a> and then <a href=\"http://en.wikipedia.org/wiki/DBase#dBase_III\" rel=\"nofollow\">dBase 3</a> to <a href=\"http://en.wikipedia.org/wiki/Microsoft_SQL_Server\" rel=\"nofollow\">SQL</a>, but I haven't found a way to do this yet. </p>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13186281,"title":"Stripping Phone Numbers of Non-numeric Values During SQL Query in Rails","body":"<p>I have a list of new restaurants and I want to check them against a database of restaurants using the phone number. The problem with phone numbers is that they have different formatting in the database (i.e. <code>123-345-6789</code> or <code>(123)-456 8988</code>).</p>\n\n<p>So far, I have created an index for the phone so that I search through them quickly. I also stripped the phone number of the new restaurants so that they only contain numeric values (0-9).</p>\n\n<p>Now, I want to strip the databases' numbers right before I compare so that I will strictly comparing numbers.</p>\n\n<pre><code>#strip the phone of non-numeric values and spaces\nformatted_phone = SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\") \n\nRestaurant.where(contact_phone: formatted_phone).each do |r|\n  #irrelevant code here\nend\n</code></pre>\n\n<p>The problem with the above code is that contact_phone (from database) will be in its non-stripped format. My research so far has lead me to believe that I have to use something like <code>REGEXP_LIKE</code>, but I'm not quite sure how to implement this with Rails. I do NOT want to update the database - I simply want to strip the numbers for comparison while still keeping the original formatting in the DB.</p>\n\n<p>How do I strip the phone numbers, <code>contact_phone</code>, of non-numeric values from the database before I compare it with <code>formatted_phone</code>?</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13186348,"title":"SELECT all rows that contain a URL","body":"<p>Lets say table:</p>\n\n<p><strong>comments</strong>: *id, id_user, content, date*</p>\n\n<p>Where content can contain html code, so it can contain images.</p>\n\n<p>So how can i select all the rows from comments table that contain images? ( <code>&lt;img src=\"image.png\" /&gt;</code> )</p>\n"},{"tags":["sql","vb.net","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13186096,"title":"Convert SQL expression to VB","body":"<p>I'm trying to cast convert this SQL statement in VB, but have been unsuccessful. Can anyone help?</p>\n\n<pre><code>declare @factor as int\ndeclare @Date as varchar(30)\nset @factor = (Cast(Convert(datetime, @Date) as int) - 33975)- \n    (28 * ((Cast(Convert(datetime, @Date) as int) - 33975)/28))\n</code></pre>\n"},{"tags":["mysql","sql","hierarchical-data"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13186173,"title":"Recursive SQL select","body":"<p>I have items with categories and those categories can also have categories how can I find the first parent. For example...</p>\n\n<pre><code>CategoriesTbl\nCategoryId | CategoryName   | parent\n-------------------------------------\n1          | Category1      | 0\n2          | Category2      | 1\n3          | Category3      | 2\n\nItemsTbl\nItemId     | CategoryId\n-------------------------------------\n1          | 3\n</code></pre>\n\n<p>How could I do a select on the item and join it to the category table with the parent category (CategoryId = 1). The parent category could be nested infinitely deep.</p>\n"},{"tags":["c#","asp.net","sql","radiobuttonlist"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13185080,"title":"SelectedValue which is invalid because it does not exist in the list of items","body":"<p>I am using a <code>GridView</code> and in it I have four columns: <code>labelID</code>, <code>fName</code>, <code>lName</code> and <code>Grade</code>. The <code>Grade</code> is a simple Pass or Fail <code>Radiobuttonlist</code>. Once the data is updated I would like it to pull the data on the next reload to show the selected value if the user has passed or failed. Here is the code:</p>\n\n<pre><code>&lt;asp:TemplateField&gt;\n           &lt;ItemTemplate&gt;\n             &lt;asp:RadioButtonList ID=\"rblChoices\" runat=\"server\" OnSelectedIndexChanged=\"rblChoices_SelectedIndexChanged\" Text='&lt;%# Eval(\"Grade\") %&gt;'&gt;\n               &lt;asp:ListItem Value=\"Pass\" Text=\"Pass\"&gt;&lt;/asp:ListItem&gt;\n                 &lt;asp:ListItem Value=\"Fail\" Text=\"Fail\"&gt;&lt;/asp:ListItem&gt;\n             &lt;/asp:RadioButtonList&gt;\n            &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n</code></pre>\n\n<p>C# code:</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n{\n    if (!Page.IsPostBack)\n    {\n        BindData();\n    }\n}\nprivate void BindData()\n{\n    string connectiongString = \"Data Source=WSCJTCSQ1;Initial Catalog=LiquorStore;Integrated Security=True\";\n    SqlConnection myConnection = new SqlConnection(connectiongString);\n    SqlDataAdapter ad = new SqlDataAdapter(\"SELECT id, firstname, lastname, nickname, Grade FROM Company\", myConnection);\n    DataSet ds = new DataSet();\n    ad.Fill(ds);\n    gvUsers.DataSource = ds;\n    gvUsers.DataBind();\n}\n</code></pre>\n\n<p>Thank you in advance!</p>\n"},{"tags":["sql","query","postgresql","distinct","aggregate-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13183817,"title":"Distinctly sum a column on a joined table?","body":"<p>This is a simple problem, and I'm not sure if its possible here. Here's the problem:</p>\n\n<p>=> <a href=\"http://sqlfiddle.com/#!12/584f1/7\" rel=\"nofollow\">http://sqlfiddle.com/#!12/584f1/7</a></p>\n\n<p>Explanation:</p>\n\n<ul>\n<li>A ticket belongs to an attendee</li>\n<li>An attendee has a revenue</li>\n<li>I need to group the tickets by section and get the total revenue.</li>\n<li>This double counts attendees because 2 tickets can belong to the same attendee, thus double counting it. I'd like to grab the sum of the revenue, but only count the attendees once.</li>\n</ul>\n\n<p>In my sqlfiddle example, I'd like to see:</p>\n\n<pre><code>section | total_revenue\n------------------------\nA       | 40            &lt;= 40 is correct, but I'm getting 50...\nB       | null\nC       | 40\n</code></pre>\n\n<p><em><strong>I'd like to solve this without the use of sub queries. I need a scalable solution that will allow me to do this for multiple columns on different joins in a single query. So whatever allows me to accomplish this, I'm open to suggestions.</em></strong></p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["sql","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":13169887,"title":"How to write SQL for inner join of three tables selection","body":"<p>I have three tables:</p>\n\n<p><strong>Item<br>\nItemCategories<br>\nCategories</strong></p>\n\n<p>If ItemCategories contain:<br>\n<strong>id<br>\nitemID<br>\ncategoryID</strong>   </p>\n\n<p>How would I write the SQL to get the category name of the item? </p>\n\n<p>So far I have:</p>\n\n<pre><code>Select * \nfrom\n   items, \n   itemCategories, \n   categories\nwhere \n  item.id = itemCategories.itemID\n  and categories.id = itemCategories.categoryID\n</code></pre>\n"},{"tags":["mysql","sql","query","postgresql","select"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13184804,"title":"Setting defaults for empty fields returned in select","body":"<p>Given two tables:</p>\n\n<pre><code>image(id, cat_id, name)\nimage_translation(id, title, desc, lang)\n</code></pre>\n\n<p>(names and ids are unique)</p>\n\n<p>Query to select all translations for the particular file:</p>\n\n<pre><code>SELECT c.id           AS c__id, \n       c.cat_id       AS c__cat_id, \n       c.name         AS c__name, \n       c2.id          AS c2__id, \n       c2.title       AS c2__title, \n       c2.desc        AS c2__desc, \n       c2.lang        AS c2__lang, \nFROM   image c \n       LEFT JOIN image_translation c2 \n              ON c.id = c2.id \nWHERE  ( c1.name = 'file.jpg' ) \n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>c__id | c__cat_id  | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n------+------------+-----------+-----------+---------------+--------------+--------- \n114   | 2          | 114       | file.jpg  | default title | default desc | en\n114   | 2          | 114       | file.jpg  | NULL          | desc in de   | de\n114   | 2          | 114       | file.jpg  | title in fr   | ''           | fr\n</code></pre>\n\n<p>To select the translation for the particular file in particular language,\nobviously I need to add the where clause.</p>\n\n<p>But then it returns the default row content, which may contain empty fields in translation.</p>\n\n<p><strong>How can I merge the result with the default values and overwrite the empy fields with the default ones?</strong> The default values are returned for lang <em>en</em>:</p>\n\n<pre><code>SELECT c2.title       AS c2__title, \n       c2.desc        AS c2__desc, \n       c2.lang        AS c2__lang, \nFROM   image c \n       LEFT JOIN image_translation c2 \n              ON c.id = c2.id \nWHERE  ( c1.name = 'file.jpg' ) \nAND WHERE ( c2.lang = 'en')\n</code></pre>\n\n<p>Sample results I expect:</p>\n\n<p>for german language:</p>\n\n<pre><code>-- AND WHERE ( c2.lang = 'de' ) \n\nc__id | c__cat_id | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n-----+------------+-----------+-----------+---------------+--------------+--------- \n114  | 2          | 114       | file.jpg  | default title | desc in de   | de\n</code></pre>\n\n<p>for french language:</p>\n\n<pre><code>-- AND WHERE ( c2.lang = 'fr' ) \n\nc__id | c__cat_id | c2__id    | c__name   | c2__title     | cs__desc     | c2__lang\n-----+------------+-----------+-----------+---------------+--------------+--------- \n114  | 2          | 114       | file.jpg  | title in fr   | default desc | fr\n</code></pre>\n\n<p><strong>How to do it right in one smart query?</strong></p>\n\n<p>(I use MySQL and Doctrine ORM with I18N behavior)</p>\n"},{"tags":["mysql","sql","mysqli","mysql-error-1064"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13185433,"title":"Replace count 0 with 'N/A' in mysql?","body":"<p>I my following query, the last column returns the count of the instances, for this instances with 0 count I would like to replace them with 'N/A'?</p>\n\n<p>This query does not seems to work</p>\n\n<pre><code>select m.id, m.desc, count(IF(i.id is NULL,'N/A',i.id)) as quant\nfrom menu m left join items i\non m.id = i.id\ngroup by m.id\norder by m.id;\n</code></pre>\n\n<p>The above query outputs as </p>\n\n<pre><code>============================\nm.id     |c.desc     | qaunt\n============================\n1234     | Shoes     | 1\n1235     | Socks     | 2\n1236     | Clothes   | 0\n===========================\n</code></pre>\n\n<p>Expected result:</p>\n\n<pre><code>============================\nm.id     |m.desc     | qaunt\n============================\n1234     | Shoes     | 1\n1235     | Socks     | 2\n1236     | Clothes   | N/A\n===========================\n</code></pre>\n\n<p>Could you please suggest me the changes in the above query</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":83,"score":-2,"question_id":13183700,"title":"my recursion goes infinite","body":"<p>I used the following method to get left child of tree through recursion but it ends up in a infinte loop. Please help me out.</p>\n\n<pre><code>public void getLeftChild(string id)\n{  \n    bool check = isLeafNode(id);\n    if(check==true)\n    {\n        string command=string.Format(\"select lid,sponsername from leftchildtable where uplineid='{0}'\",id);\n        SqlDataAdapter da=new SqlDataAdapter (command,conn);\n        DataTable dt=new DataTable ();\n        da.Fill(dt);\n        string newid=dt.Rows[0][0].ToString();\n        while(check==true &amp;&amp; dt.Rows[0][0].ToString()!=\"\")\n        {\n            left.Add(newid);\n            getLeftChild(newid);\n        }\n        Session[\"lchild\"] = left;\n    }\n    else\n    {\n        Session[\"lchild\"] = left;\n    }\n}\n</code></pre>\n"},{"tags":["mysql","sql","phpmyadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13185683,"title":"Weird behaviour from using CASE/WHEN in MySQL","body":"<p>I'm trying to learn how to use <strong>CASE/WHEN</strong> in <strong>SQL</strong> more specifically, mySQL.</p>\n\n<p>I have two tables: <strong>adhoc_item</strong> and <strong>adhoc_vulnerability</strong>. <strong>ahdoc_item</strong> has one <strong>adhoc_vulnerability</strong> related to it. now <strong>adhoc_vulnerability</strong> <em>may or may not</em> have a vulnerability (original_vulnerability_id) attached to it. </p>\n\n<p>In case it doesn't, then I want to return the <strong>name</strong> on itself.</p>\n\n<p>The tables: (or relevant parts thereof)</p>\n\n<p><strong>ADHOC_ITEM</strong>\n<img src=\"http://i.stack.imgur.com/amkYy.png\" alt=\"enter image description here\"></p>\n\n<p><strong>ADHOC_VULNERABILITY</strong>\n<img src=\"http://i.stack.imgur.com/iPxcS.png\" alt=\"enter image description here\">\nThis is my query:</p>\n\n<pre><code>SELECT adi.name as item, CASE ahv.original_vulnerability_id\nWHEN ISNULL(ahv.original_vulnerability_id) THEN ahv.name\nELSE 'foo'\nEND NAME\nFROM adhoc_item adi\nJOIN adhoc_vulnerability ahv ON ahv.id = adi.adhoc_vulnerability_id\n</code></pre>\n\n<p><strong>and these are the results!</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/CDdby.png\" alt=\"enter image description here\"></p>\n\n<p>Now I know this is a little bit complex but i've been thinking about it for about 2 hours and found no explanation on why that last <strong>item</strong> (which has an <strong>adhoc_vulnerability</strong> with NULL as <strong>original_vulnerability_id</strong>) shows the value that is supposed to appear precisely when that attribute is <em>not</em> null!</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","oracle","view"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13176879,"title":"create a view for multiple queries in Oracle","body":"<p>I have 4 SQL queries that fetch data from the same table and I was wondering whether you can create a view containing multiple queries. For instance, one of these queries looks something like: </p>\n\n<pre><code>SELECT Count(COLUMN1) FROM TABLE1 WHERE COLUMN3 &gt; '01-Oct-12' AND COLUMN3&lt; '01-Nov-12' \n</code></pre>\n\n<p>whereas another looks like: </p>\n\n<pre><code>SELECT Count(COLUMN2) FROM TABLE1 WHERE COLUMN3 &gt; '01-Oct-12' AND COLUMN3 &lt; '01-Nov-12' \n</code></pre>\n\n<p>Thanks,</p>\n\n<p>I. </p>\n"}]}
{"total":102599,"page":15,"pagesize":100,"questions":[{"tags":["sql","playframework","playframework-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13183783,"title":"DB Evolution in Play Framework 2.0","body":"<p>On play 1.0 when we change a variable type or for example changing from @OneToMany to @ManyToMany in a Model Play was handling the change automatically but with play 2.0 evolution script drop the database. There is any way to make Play 2.0 apply the change without dropping the DB ?</p>\n"},{"tags":["c#","sql"],"answer_count":3,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":114,"score":9,"question_id":13165958,"title":"What is the safest way to include data in SQL WHERE clause while avoiding SQL injection risk WITHOUT using a parameterized query?","body":"<p>What's a good function to use for making a string safe for inclusion in a SQL query?  For example, apostrophes would need to be fixed, and there are doubtless other problems that could arise as well.  I'd like a function that is rock-solid and would work given any possible input an evil-doer could devise.</p>\n\n<p>Now, before the masses tell me to use query parameters and/or downvote/close this question, consider these points:</p>\n\n<ul>\n<li><p>I am stuck using a 3rd-party library with a poorly-designed API.  The API is supposed to be called as follows:</p>\n\n<pre><code>dataObjectVariable.FindWhere(\"WHERE RecordID = '(your string here)'\");\n</code></pre>\n\n<p>Now, I agree with you 100% that this is not a good API as it (1) exposes internal database field names to the user which are implementation details, (2) offers no opportunity for using parameters which would avoid this problem in the first place, (3) really, you could say that SQL itself is an implementation detail and shouldn't have been exposed.  But I am stuck using this API because it's required to integrate with one of the leading systems in its industry.  We're not really in a position to ask them to change their API, either.</p></li>\n<li><p>I searched this site for other questions pertaining to this issue, but found that answers tended to strongly suggest parameterized queries.  Answers that tried to suggest writing a function to sanitize the string were often downvoted, not well thought out, etc. - I'm not sure if I trust them.</p></li>\n</ul>\n\n<p>I'm only searching for strings and not other data types like numbers, dates, etc.  Again, I'm 100% aware of the benefits of using parameterized queries and I wish I could use them, but I can't because my hands are tied on this one.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","jobs"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":175,"score":2,"question_id":12249056,"title":"Executing SQL Server Agent Job from a stored procedure and returning job result","body":"<p>Need to have a stored procedure that calls a SQL Server Agent Job and returns whether or not the job ran successfully or not.</p>\n\n<p>So far I have<br></p>\n\n<pre><code>CREATE PROCEDURE MonthlyData\nAS\nEXEC msdb.dbo.sp_start_job N'MonthlyData'\n\nWAITFOR DELAY '000:04:00'\n\nEXEC msdb.dbo.sp_help_jobhistory @job_name = 'MonthlyData'\nGO\n</code></pre>\n\n<p>Which starts the job, whats the best way to get back if the job ran successfully or not?</p>\n\n<p>Ok made an edit and used WAITFOR DELAY as the job normally runs between 3-4 mins never longer than 4. Does the job but is there a more efficient way to do it?</p>\n"},{"tags":["sql","oracle","formatting"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":31230,"score":5,"question_id":144167,"title":"How to format Oracle SQL text-only select output","body":"<p>I am using Oracle SQL (in SQLDeveloper, so I don't have access to SQLPLUS commands such as COLUMN) to execute a query that looks something like this:</p>\n\n<pre><code>select assigner_staff_id as staff_id, active_flag, assign_date,\n  complete_date, mod_date\nfrom work where assigner_staff_id = '2096';\n</code></pre>\n\n<p>The results it give me look something like this:</p>\n\n<pre>\nSTAFF_ID               ACTIVE_FLAG ASSIGN_DATE               COMPLETE_DATE             MOD_DATE                  \n---------------------- ----------- ------------------------- ------------------------- ------------------------- \n2096                   F           25-SEP-08                 27-SEP-08                 27-SEP-08 02.27.30.642959000 PM \n2096                   F           25-SEP-08                 25-SEP-08                 25-SEP-08 01.41.02.517321000 AM \n\n2 rows selected\n</pre>\n\n<p>This can very easily produce a very wide and unwieldy textual report when I'm trying to paste the results as a nicely formatted quick-n-dirty text block into an e-mail or problem report, etc.  What's the best way to get rid of all tha extra white space in the output columns when I'm using just plain-vanilla Oracle SQL?  So far all my web searches haven't turned up much, as all the web search results are showing me how to do it using formatting commands like COLUMN in SQLPLUS (which I don't have).</p>\n"},{"tags":["sql","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":52,"score":-3,"question_id":13185030,"title":"Formatting an sql query","body":"<p>I have the following sql statement</p>\n\n<pre><code>SELECT timestamp, tagname ,value\nFROM [GasNominationsData].[dbo].[GasRawData]\nWHERE timestamp between \n             dateadd(hour, 6, DATEADD(day, DATEDIFF(day, 0, GETDATE()), -1))   \n             and dateadd(hour, 6, DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0));\n</code></pre>\n\n<p>the timestamp is each hour, the value is the average over that hour and the the tagname is a string (there are several different tagnames).</p>\n\n<p>I need to be able to produce a list as per the image.</p>\n\n<p><img src=\"http://i.stack.imgur.com/CCNfn.jpg\" alt=\"example table layout\"></p>\n\n<p>I am basically doing this so I can connect to it from a web page dumping the table into a grid view</p>\n"},{"tags":["iphone","objective-c","sql","ios","application"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13184710,"title":"Content from Website to iPhone App","body":"<p>I've been creating iPhone applications for the past couple of months, and one question has always crossed my mind: how does one go about creating an app like Instagram or some other application that lets users sign up and log in? I know how to do this with a website (SQL), but how do you do it on the iPhone? General answers are perfectly fine. Thanks!</p>\n"},{"tags":["mysql","sql","scripting","data-migration"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13184871,"title":"How to save records from one table to another table using stored procedure in mysql?","body":"<p>I have tried, but I don't know how to do this.\nI want to migrate records from one table into another table using a stored procedure.  I have started with a simple procedure (not sure whether it is right or wrong) to print the records based on some condition. Here is the code with which i have tried:</p>\n\n<pre><code>CREATE PROCEDURE curdemo()\nBEGIN\n DECLARE done INT DEFAULT FALSE;\n  DECLARE a VARCHARCHAR(16);\n  DECLARE cur1 CURSOR FOR SELECT user_name FROM discovery_configuration;\n   OPEN cur1;\n  REPEAT \n    FETCH cur1 INTO a;\n     IF a!=' ' THEN \n        select a;\n    END IF;\n  END REPEAT;\n   CLOSE cur1;\nEND;\n</code></pre>\n\n<p>I need a stored procedure to migrate those records to another table if user_name column is empty. Can anyone guide me?</p>\n"},{"tags":["mysql","sql","messaging"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":254,"score":7,"question_id":10962323,"title":"Messaging system query to get last messages, number of unread messages and array of users in conversation","body":"<p>I'm working on a messaging system with two tables and another table with the users information.<br>\nA conversation can be between 2 or more users. Every conversation has a UID and every messages exchanged between users are labeled with that conversation UID. </p>\n\n<p>Here are the tables :</p>\n\n<p><code>conversation_list</code> : every row in this table links the <code>user_id</code> and the <code>conversation_id</code>, it also contains the last time the user viewed the conversation.</p>\n\n<pre><code>`id`                 -&gt; unique ID, autoincremented\n`user_id`            -&gt; This contains the user associated with the conversation.\n`conversation_id`    -&gt; This contains the UID of the conversation\n`date_lastView`      -&gt; This field has the time that the user viewed the conversation last\n</code></pre>\n\n<p><code>conversation_messages</code> : every row in this table contains a message </p>\n\n<pre><code>`id`                 -&gt; unique ID, autoincremented\n`user_id`            -&gt; This contains the user that sent the message.\n`conversation_id`    -&gt; This contains the UID of the conversation\n`date_created`       -&gt; This contains the time when the message was posted\n`message`            -&gt; This contains the message\n</code></pre>\n\n<p><code>users</code> : every row in this table contains a user </p>\n\n<pre><code>`User_ID`            -&gt; UID of the user\n`FirstName`          -&gt; This contains the first name of the user\n`LastName`           -&gt; This contains the last name of the user\n</code></pre>\n\n<p>I already have a SQL query to get the last message of every conversation. Here it is : </p>\n\n<pre><code>SELECT *\nFROM conversation_messages AS m\n\nJOIN\n  (SELECT mx.conversation_id,\n          MAX(mx.date_created) AS MaxTime\n   FROM conversation_messages AS mx\n   GROUP BY mx.conversation_id) AS mx ON m.conversation_id = mx.conversation_id\nAND m.date_created = mx.MaxTime\n\nJOIN\n  (SELECT mu.conversation_id\n   FROM conversation_list AS mu\n   WHERE mu.user_id = :USER_ID_CONNECTED\n   GROUP BY mu.conversation_id) AS mux ON m.conversation_id = mux.conversation_id\n\nJOIN conversation_list AS mu ON m.conversation_id = mu.conversation_id\n\nGROUP BY mu.conversation_id\nORDER BY m.date_created DESC\n</code></pre>\n\n<p>I now would like to add to this perfectly working query the ability to return:</p>\n\n<ul>\n<li>The number of unread messages for each conversation (count of all messages with the <code>date_creaded</code> bigger then <code>date_lastView</code> of the logged in user)</li>\n<li>An array containing the <code>User_ID</code> of every user in each conversation and sorted by when they last posted a message in the conversation.</li>\n<li>With the same idea of the last array but with the <code>FirstName</code> and <code>LastName</code> of the user.</li>\n</ul>\n\n<p>I tried a few things but I was really unsuccessful, so I'm now asking the SO community for its precious help.</p>\n\n<p>All this can only display conversations where the logged in user takes part in.</p>\n\n<p>It it helps, I created a <a href=\"http://sqlfiddle.com/#!2/c7306/2\">SQLFiddle</a></p>\n"},{"tags":["php","sql","checkbox","status"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13185027,"title":"Checkbox, PHP & SQL","body":"<p>Quick issue:</p>\n\n<p>I have a checkbox in my code that tells the user if the status of a record is <strong>DONE</strong> or <strong>NOT DONE</strong>. When the user does a records search in the database, the records that show up, show up with the current record status (<strong>DONE</strong> or <strong>NOT DONE</strong>).</p>\n\n<p>If the checkbox is not check means that the record is <strong>NOT DONE</strong>, so I'm trying to place a checkbox on one side of the record status so the user can check it as soon as they are done working on the record. After they check the checkbox, the value is sent to the DB telling the DB that the new status of the record is <strong>DONE</strong></p>\n\n<p>How can I accomplish this when the following example code: (The results are shown after the user made a search using a form)</p>\n\n<pre><code>&lt;?php\nif(!isset($_POST['search']))\n{\n?&gt;\n\n&lt;?php\n}\nelse\n{\n    $from = trim($_POST['OLD']);\n    $to = trim($_POST['NEW']);\n    $status = isset($_POST['Status']) ? \"AND status = 'DONE' \" :\"AND status = 'NOT DONE' \";\n\n    $connection = mysql_pconnect(\"HOST\", \"USER\", \"PASS\") or die(\"Connection failed. \".myslq_error());\n    mysql_select_db(\"DBNAME\") or die(\"Unable to select db. \".mysql_error());\n    $query = \"SELECT * FROM records WHERE Date &gt;= '$from' AND Date &lt;= '$to' \".$status.\" ORDER BY date ASC\";\n\n    $result = mysql_query($query) or die(mysql_error());\n\n    echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n        echo \"&lt;tr class='rowa'&gt;&lt;b&gt;\";\n            echo \"&lt;td class='col0 cell'&gt;ID&lt;/td&gt;\";\n            echo \"&lt;td class='col1 cell'&gt;Name&lt;/td&gt;\";\n            echo \"&lt;td class='col2 cell'&gt;Last Name&lt;/td&gt;\";\n            echo \"&lt;td class='col3 cell'&gt;Place&lt;/td&gt;\";\n            echo \"&lt;td class='col4 cell'&gt;Station&lt;/td&gt;\";\n            echo \"&lt;td class='col5 cell'&gt;Phone&lt;/td&gt;\";\n            echo \"&lt;td class='col6 cell'&gt;Date of Record&lt;/td&gt;\";\n            echo \"&lt;td class='col7 cell'&gt;Status&lt;/td&gt;\";\n        echo \"&lt;/tr&gt;\";\n    echo \"&lt;/table&gt;\";\n    while($record = mysql_fetch_object($result))\n    {   \n    echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n        echo \"&lt;tr class='rowb'&gt;\";\n            echo \"&lt;td class='col0 cell'&gt;\".$record-&gt;ID.\"&lt;/td&gt;\";\n            echo \"&lt;td class='col1 cell'&gt;\".$record-&gt;Name.\"&lt;/td&gt;\";\n            echo \"&lt;td class='col2 cell'&gt;\".$record-&gt;lastName.\"&lt;/td&gt;\";\n            echo \"&lt;td class='col3 cell'&gt;\".$record-&gt;Place.\"&lt;/td&gt;\";\n            echo \"&lt;td class='col4 cell'&gt;\".$record-&gt;Station.\"&lt;/td&gt;\";\n            echo \"&lt;td class='col5 cell'&gt;\".$record-&gt;Phone.\"&lt;/td&gt;\";\n            $year_part_of_date = explode('-', $record-&gt;date);\n            echo \"&lt;td class='col6 cell'&gt;\".$record-&gt;date.\"&lt;/td&gt;\";\n            echo \"&lt;td class='col7 cell'&gt;\".$record-&gt;Status.\"&lt;/td&gt;\";\n        echo \"&lt;/tr&gt;\";       \n    echo \"&lt;/table&gt;\";\n    }   \n}\n?&gt;\n</code></pre>\n\n<p><br/><hr/>\nThanks everyone for showing me the way :D</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13184253,"title":"Ensure correct sql server instance db in script before executing?","body":"<p>How can I specify in my .sql script that that it only executes against my localhost sql server db instance and not on another open connection to say my integration or test environment?</p>\n\n<p>dbsetupscript.sql</p>\n\n<pre><code>use myDB\n\n--WHAT SAFE GAURD CAN i PUT HERE TO ENSURE THAT THIS SCRIPT CAN ONLY BE EXECUTED VIA MY   \n-- LOCAL ENVIRONMENT BEFORE I START DELETING TABLES, ETC?\n\ndelete MotherTable\n-- delete other tables and insert simulated production data \n</code></pre>\n"},{"tags":["sql","sql-server","tsql","pivot","unpivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13184637,"title":"pivoting rows to columns in tsql","body":"<p>I have the following table with the following sample data</p>\n\n<pre><code>ID  Language       Question       SubQuestion     SubSubQuestion    TotalCount  TotalPercent\n3      E               9               0                1             88527            73%\n3      E               9               0                2             19684            16%\n3      E               9               0                3             12960            11%\n3      E               9               0                9              933              1%\n</code></pre>\n\n<p>I want all in one row like this</p>\n\n<pre><code>    ID  Language        TotalCount901   TotalPercent901     TotalCount902   TotalPercent902 TotalCount903   TotalPercent903\n     3       E            88527           73%                 19684             16%              12960              11%\n</code></pre>\n\n<p>I've tired using the pivot command, but it dosnt to work for me.</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13184856,"title":"create a table from multiple tables while keeping original ID and original table?","body":"<p>This is a part of my assignment and I'm stuck in the first part..</p>\n\n<p>They ask us to create a data warehouse table to integrate data from other tables.</p>\n\n<p>The requirement sheet gave me the following schemas that must be used.</p>\n\n<pre><code>A3DWSW (DWSWID, TITLE, CATCODE, CATNAME, ORIGID, ORIGITABLE)\nthe DWSWID, TITLE, CATCODE, CATNAME columns are from A3SOFTWARE and A3CATEGORY TABLE\n</code></pre>\n\n<p>So I wrote this DDL to create the <code>A3DWSW</code> table with the columns from other tables</p>\n\n<pre><code>CREATE TABLE A3DWSW AS (SELECT A3SOFTWARE.SWID, A3SOFTWARE.TITLE, A3SOFTWARE.CATCODE, A3CATEGORY.CATNAME FROM A3SOFTWARE, A3CATEGORY);\n</code></pre>\n\n<p>This creates the table but I cannot get any information about <code>ORIGID</code> and <code>ORIGITABLE</code> columns from any other tables. There are no columns for them, so I assume the names mean <code>ORIGINAL</code> of some table. But I can't guess which table and ID are original.</p>\n"},{"tags":["sql","tsql","sql-management-studio"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13184746,"title":"SQL Query to Display Count of Total","body":"<p>I've got a very complex query that joins eight (8) different tables.</p>\n\n<p>For the sake of this question, though, I'll simplify it with this type of structure:</p>\n\n<pre><code>create table table1(PacketID int, RequestID int, EmpID int, PartNo varchar(20))\n\ninsert into table1 values\n (1 , 1, 132, 'abc123'),\n (1 , 2, 132, 'abc456'),\n (1 , 3, 132, 'def123'),\n (1 , 4, 132, 'def456'),\n (2 , 5, 228, 'xyz123'),\n (3 , 6, 239, 'xyz321'),\n (3 , 7, 239, 'aaa000')\n</code></pre>\n\n<p>This type of table creates the following output:</p>\n\n<pre><code>|_P_|_R_|_Emp_|_PartNo_|\n|_1_|_1_|_132_|_abc123_|\n|_1_|_2_|_132_|_abc465_|\n|_1_|_3_|_132_|_def123_|\n|_1_|_4_|_132_|_def456_|\n|_2_|_5_|_228_|_xyz123_|\n|_3_|_6_|_239_|_xyz321_|\n|_3_|_7_|_239_|_aaa000_|\n</code></pre>\n\n<p>I put together a fiddle of it here: <a href=\"http://www.sqlfiddle.com/#!3/a3ce4/1\" rel=\"nofollow\">http://www.sqlfiddle.com/#!3/a3ce4/1</a></p>\n\n<p>I was told they don't really need this <code>PacketID</code> or <code>RequestID</code>, but what they do need is something that shows how many requests are in a packet and what request number of that packet needs attention.</p>\n\n<p>I will still need the <code>PacketID</code> and <code>RequestID</code> values in order to make changes to the data.</p>\n\n<p>So, I want to add a column to the table above to be something like this:</p>\n\n<pre><code>|_P_|_R_|_ReadAs_|_Emp_|_PartNo_|\n|_1_|_1_|_1 of 4_|_132_|_abc123_|\n|_1_|_2_|_2 of 4_|_132_|_abc465_|\n|_1_|_3_|_3 of 4_|_132_|_def123_|\n|_1_|_4_|_4 of 4_|_132_|_def456_|\n|_2_|_5_|_1 of 1_|_228_|_xyz123_|\n|_3_|_6_|_1 of 2_|_239_|_xyz321_|\n|_3_|_7_|_2 of 2_|_239_|_aaa000_|\n</code></pre>\n\n<p>How exactly would I go about doing that?</p>\n\n<p>If you just want to feel my pain and see the complete view defined on my SQL Server, here it is:</p>\n\n<pre><code>SELECT P.ID AS PacketID, R.ID AS RequestID, A.ID AS ActionID,\n  EI.FIRSTNAME + ' ' + EI.LASTNAME AS Employee, P.DateStamp, \n  RQ.Description AS RequestType, L.Description AS Line, R.PartNo,\n  R.Workorder, R.Qty, RZ.Description AS ReasonType, R.MTF,\n  A.StatusID, S.Description AS Status, A.EmpID AS Stator, \n  A.DateStamp AS Stated\nFROM dbo.Packet AS P\n  LEFT OUTER JOIN dbo.Request AS R ON R.PacketID = P.ID\n  INNER JOIN dbo.Action AS A ON R.ID = A.RequestID\n  LEFT OUTER JOIN dbo.Action AS A2 ON A.RequestID = A2.RequestID\n         AND (A.DateStamp &lt; A2.DateStamp OR\n         A.DateStamp = A2.DateStamp AND A.RequestID &lt; A2.RequestID)\n  INNER JOIN CPAPP.AIO_Test_Results.dbo.EmployeeInfo AS EI ON A.EmpID = EI.COUNT\n  INNER JOIN dbo.RequestType AS RQ ON R.RequestTypeID = RQ.ID\n  INNER JOIN dbo.Line AS L ON R.LineID = L.ID\n  INNER JOIN dbo.ReasonType AS RZ ON R.ReasonTypeID = RZ.ID\n  INNER JOIN dbo.Status AS S ON A.StatusID = S.ID\nWHERE (A2.RequestID IS NULL)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/3RdIZ.png\" alt=\"screenshot\"></p>\n"},{"tags":["sql","tsql","sql-server-2005","pivot","pivot-without-aggregate"],"answer_count":5,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":245,"score":5,"question_id":12221037,"title":"How can I query row data as columns?","body":"<p>I'm sure I'm missing something here.</p>\n\n<p>I have a dataset like this:</p>\n\n<pre>\nFK    RowNumber    Value    Type    Status\n1     1            aaaaa    A       New\n1     2            bbbbb    B       Good\n1     3            ccccc    A       Bad\n1     4            ddddd    C       Good\n1     5            eeeee    B       Good\n2     1            fffff    C       Bad\n2     2            ggggg    A       New\n2     3            hhhhh    C       Bad\n3     1            iiiii    A       Good\n3     2            jjjjj    A       Good\n</pre> \n\n<p>I'd like to query the top 3 results and Pivot them as columns, so the end result set looks like this:</p>\n\n<pre>\nFK    Value1    Type1    Status1    Value2    Type2    Status2    Value3    Type3    Status3\n1     aaaaa     A        New        bbbbb     B        Good       ccccc     A        Bad\n2     fffff     C        Bad        ggggg     A        New        hhhhh     C        Bad\n3     iiiii     A        Good       jjjjj     A        Good\n\n</pre>\n\n<p>How can I accomplish this in SQL Server 2005? </p>\n\n<p>I have been attempting this using <a href=\"http://msdn.microsoft.com/en-us/library/ms177410%28SQL.105%29.aspx\" rel=\"nofollow\">PIVOT</a>, but I am still very unfamiliar with that keyword and cannot get it to work the way I want.</p>\n\n<pre><code>SELECT * --Id, [1], [2], [3]\nFROM\n(\n    SELECT Id, Value, Type, Status\n    , ROW_NUMBER() OVER (PARTITION BY Id ORDER Status, Type) as [RowNumber]\n    FROM MyTable\n) as T\nPIVOT\n(\n    -- I know this section doesn't work. I'm still trying to figure out PIVOT\n    MAX(T.Value) FOR RowNumber IN ([1], [2], [3]),\n    MAX(T.Type) FOR RowNumber IN ([1], [2], [3]),\n    MAX(T.Status) FOR RowNumber IN ([1], [2], [3])\n) AS PivotTable;\n</code></pre>\n\n<p>My actual data set is a bit more complex than this, and I need the top 10 records, not the top 3, so I don't want to simply do <code>CASE WHEN RowNumber = X THEN...</code> for each one.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I tested all the answers below, and found most of them seem about the same with no apparent performance difference in smaller data sets (around 3k records), however there was a slight difference when running the queries against larger data sets. </p>\n\n<p>Here are the results of my tests using 80,000 records and querying for 5 columns in the top 10 rows, so my end result set was 50 columns + the <code>Id</code> column. I'd suggest you test them on your own to decide which one works best for you and your environment.</p>\n\n<ul>\n<li><p><a href=\"http://stackoverflow.com/a/12221580/302677\">bluefoot's answer</a> of unpivoting and re-pivoting the data averaged the fastest at about 12 seconds. I also liked this answer because I found it easiest to read and maintain.</p></li>\n<li><p><a href=\"http://stackoverflow.com/a/12221510/302677\">Aaron's answer</a> and <a href=\"http://stackoverflow.com/a/12221623/302677\">koderoid's answer</a> both suggest using a <code>MAX(CASE WHEN RowNumber = X THEN ...)</code>, and was close behind averaging at around 13 seconds.</p></li>\n<li><p><a href=\"http://stackoverflow.com/a/12221475/302677\">Rodney's answer</a> of using multiple <code>PIVOT</code> statements averaged around 16 seconds, although it might be faster with fewer PIVOT statements (my tests had 5).</p></li>\n<li><p>And the first half of <a href=\"http://stackoverflow.com/a/12221510/302677\">Aaron's answer</a> that suggested using a CTE and <code>OUTER APPLY</code> was the slowest. I don't know how long it would take to run because I cancelled it after 2 minutes, and that was with around 3k records, 3 rows, and 3 columns instead of 80k records, 10 rows, and 5 columns.</p></li>\n</ul>\n"},{"tags":["sql","sql-server","view","predicates"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13184439,"title":"SQL How to extract a predicate from a left join","body":"<p>I have 2 tables: user and licenseduser. The first one contains <em>all</em> the users and the second one contains only those users with a licenses (2 columns: useruid and subscriptionid).</p>\n\n<p>Given a subscriptionId I have to display in a grid <em>all</em> the users and a boolean flag column indicating for each user if he/she has the subscription or not.</p>\n\n<p>Example: The following query gives me that for the subscriptionId = 7.</p>\n\n<pre><code>select firstname, lastname, emailaddress, subscriptionid \nfrom dbo.[user]\nleft join (select * from dbo.licensedUser where subscriptionid = 7) lu on dbo.[user].[Uid] = lu.useruid \n</code></pre>\n\n<p>However, this query is not useful for me because the executor program uses an ORM. I want to create a view (called myView) such that I can (or the ORM can) do this: </p>\n\n<p>select firstname, lastname, emailaddress, subscriptionid<br>\nfrom myView\nwhere  subscriptionid  = 7 or subscriptionid is null</p>\n\n<p>Could you help me, please?\nThank you in advance.</p>\n"},{"tags":["sql","oracle","views","ddl"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":357,"score":1,"question_id":2063493,"title":"How to auto-redefine view when underlying table changes (new column)?","body":"<p>We've got a view that's defined like this</p>\n\n<pre><code>CREATE VIEW aView as \nSELECT * from aTable Where &lt;bunch of conditions&gt;;\n</code></pre>\n\n<p>The \"value\" of the view is in the where-condition, so it is okay to use a <code>Select *</code> in this case.</p>\n\n<p>When a new column is added to the underlying table, we have to redefine the view with a </p>\n\n<pre><code>CREATE OR REPLACE FORCE VIEW aView as \nSELECT * from aTable Where &lt;bunch of conditions&gt;;\n</code></pre>\n\n<p>as the <code>Select *</code> seems to get \"translated\" into all the columns present at the time the view is (re-)defined. </p>\n\n<p>My question: How can we avoid this extra step? \n(If the answer is dependent on the RDBMS, we're using Oracle.)</p>\n"},{"tags":["sql","oracle10g"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13020316,"title":"Oracle SQL: Sums from a table with multiple joins and conditions","body":"<p>I am trying to get a result from a single query to display the sum of a quantity even when a row is not found.</p>\n\n<p>This query does exactly what I want:</p>\n\n<pre><code>select max(m.item_number), max(m.item_description), \n       max(m.uom), sum(nvl(i.qty_ordered,0))\nfrom (((dex.ITEM_MASTER m FULL JOIN dex.order_request_items i ON m.item_number = i.item_number)  \n                          FULL JOIN dex.order_request h ON h.orderid = i.orderid)\n                          FULL JOIN dex.customer c ON h.customer_number = c.customer_number)\nwhere m.item_number in ('199', '198', '11415', '11425', '11435', '1145', '766')\ngroup by m.item_number\norder by 1\n</code></pre>\n\n<p>and returns this</p>\n\n<pre><code>MAX(M.ITEM_NUMBER) MAX(M.ITEM_DESCRIPTION)     MAX(M.UOM) \"SUM(NVL(I.QTY_ORDERED,0))\"\n11415              Bananas HALF CASE GREEN     1/2        0\n11425              Bananas HALF CASE GREEN TIP 1/2        0\n11435              Bananas HALF CASE RIPE      1/2        0\n1145               Bananas HALF CASE           1/2        5\n198                Watermelons SEEDLESS        EACH       0\n199                Watermelons                 EACH       80\n766                Pumpkins EACH               EACH       0\n</code></pre>\n\n<p>This displays the zeroes for rows that have no quantities just fine. The problem occurs when I add additional conditions that are needed to narrow down the data.\nI need the same kind of result with the additional conditions in this query</p>\n\n<pre><code>select max(m.item_number), max(m.item_description), \n       max(m.uom), sum(nvl(i.qty_ordered,0))\nfrom (((dex.ITEM_MASTER m FULL JOIN dex.order_request_items i ON m.item_number = i.item_number)  \n                          FULL JOIN dex.order_request h ON h.orderid = i.orderid)\n                          FULL JOIN dex.customer c ON h.customer_number = c.customer_number)                      \nwhere m.item_number in ('199', '198', '11415', '11425', '11435', '1145', '766')\nand     h.REQUEST_DELIVERY_DATE = TO_DATE('10/24/2012', 'MM/DD/YYYY')\nand     c.subcontractorid is null\nand     h.request_state &lt;&gt; 'Incomplete'\ngroup by m.item_number\norder by 1\n</code></pre>\n\n<p>That query though returns this result.</p>\n\n<pre><code>MAX(M.ITEM_NUMBER) MAX(M.ITEM_DESCRIPTION)     MAX(M.UOM) \"SUM(NVL(I.QTY_ORDERED,0))\"\n199                Watermelons                 EACH       31\n</code></pre>\n\n<p>The rows that should show a zero are now gone. Is it possible to have all the rows like the first result show when using additional conditions?</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13184419,"title":"Manual order in SQL","body":"<p>If I have a table of things...</p>\n\n<pre><code>ThingName | ThingCategory\n-------------------------\nthing 1   | cat1\nthing 2   | cat2\nthing 3   | cat3\n</code></pre>\n\n<p>How would I select them ordered by first <code>cat2</code>, then <code>cat1</code>, then <code>cat3</code></p>\n\n<p>Is this even possible?</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13184089,"title":"Transposing number from one column into another one where = 0","body":"<p>My question is this, </p>\n\n<p>I have a query I'm working on and I have some values that are 0. I want to be able to take a value from a previous month that is not zero and put it in place of the zero. See the example below. </p>\n\n<pre><code>SELECT item,\n       stock,\n       sold,\n       level,\n       month,\n       year\nFROM   agingdata\nGROUP  BY item,\n          stock,\n          sold,\n          month,\n          year,\n          level\nHAVING ( item = @Item )\nORDER  BY year,\n          month \n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/34WLI.png\" alt=\"enter image description here\"></p>\n\n<p>So I want take the number 2455 and input it into the stock where it says 0, taking last months balance number as the current months stock level. Is that even possible? </p>\n"},{"tags":["sql","sql-server","logging","select","triggers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13184120,"title":"SQL - Selecting a field from another table using a primary key in a trigger","body":"<p>I have two tables in my database, one is Transactions and the other is TransactionHistories. The latter is essentially an auditing table, whereby a trigger executes on insert, update and delete on Transactions to capture a screenshot of the data.</p>\n\n<p>I am successfully retrieving all of the data stored in the Transactions table where the columns match, but the difficulty comes where I am trying to retrieve data from another table using a foreign key. For instance:</p>\n\n<p>The transaction table has a field \"TransactionType_TransactionTypeId\", but in the audit table we wish to store its 'name' equivalent as \"TransactionTypeName\". This needs to be populated from the \"TransactionTypes\" table, which has the fields \"TransactionTypeId\" and \"Name\".</p>\n\n<p>I am struggling to write a query to retrieve this as we wish. I am trying something similar to the following but having little success:</p>\n\n<pre><code>SELECT @TransactionTypeName=Name\nFROM TransactionTypes\nWHERE inserted.TransactionType_TransactionTypeId=TransactionTypes.TransactionTypeId;\n</code></pre>\n\n<p>I'm assuming that is a syntactic nightmare. If someone could point me in the right direction I would be extremely grateful!</p>\n"},{"tags":["sql","sql-server","visual-studio-2010","visual-studio"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13178758,"title":"How can i return error messages as select statement SQL server 2008?","body":"<p>In SQL SERVER 2008 how can i return error messages as select statement </p>\n\n<p><em>LIKE</em></p>\n\n<pre><code>SELECT ** FROM emp \n</code></pre>\n\n<p><em>Will return the following error</em></p>\n\n<pre><code>    Msg 102, Level 15, State 1, Line 1\n    Incorrect syntax near '*'.\n</code></pre>\n\n<p>i just need the 2nd line to be returned as <code>SELECT</code> statement </p>\n\n<p>I've tried @@ERROR but looks like it return just the error code </p>\n\n<p>What i'm doing is validating sql statements from the client side, so if there is a way of doing this with out hitting the server this will be good too i'm using VB </p>\n\n<p>Thanks </p>\n"},{"tags":["sql","sql-server","tsql","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13179188,"title":"SQL Query to get table names by foreign key dependency","body":"<p>How could I frame a query to get table names in SQL Server by order of Foreign Key dependency?</p>\n\n<p>If there is a Table XYZ, which is the Primary table on which 2 other tables have a Foreign Key constraint, then I would want the Table XYZ to appear first.</p>\n\n<p>This is to enable the creation of tables in the correct order.</p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13183975,"title":"how to get full outer join in left and right join order","body":"<p>Please refer the below script</p>\n\n<pre><code>    declare @table1 table\n    (\n    col1 int\n    )\n\n    declare @table2 table\n    (\n    col2 int\n    )\n\n    insert into @table1 values(1)\n    insert into @table1 values(2)\n    insert into @table1 values(3)\n    insert into @table1 values(5)\n    insert into @table1 values(7)\n\n    insert into @table2 values(1)\n    insert into @table2 values(3)\n    insert into @table2 values(3)\n    insert into @table2 values(6)\n    insert into @table2 values(4)\n    insert into @table2 values(7)\n</code></pre>\n\n<p>Case 1:</p>\n\n<pre><code>select * from @table1 a left outer join @table2 b on a.col1=b.col2\n    order by col1 \n</code></pre>\n\n<p>Result 1:</p>\n\n<pre><code>         col1       col2        \n     -----------  ----------- \n    |    1       |    1       |\n    |    2       |    NULL    |\n    |    3       |    3       |\n    |    3       |    3       |\n    |    5       |    NULL    |\n    |    7       |    7       |\n    ---------------------------\n</code></pre>\n\n<p>Case 2:</p>\n\n<pre><code>select * from @table1 a right outer join @table2 b on a.col1=b.col2\n    order by col2 \n</code></pre>\n\n<p>Result 2:</p>\n\n<pre><code>         col1             col2        \n     -----------  ----------- \n    |    1       |    1       |\n    |    3       |    3       |\n    |    3       |    3       |\n    |    NULL    |    4       |\n    |    NULL    |    6       |\n    |    7       |    7       |\n    ---------------------------\n</code></pre>\n\n<p>Actual Case:</p>\n\n<pre><code>select * from @table1 a full outer join @table2 b on a.col1=b.col2\n</code></pre>\n\n<p>Actual Result:</p>\n\n<pre><code>         col1        col2        \n     -----------  ----------- \n    |    1       |    1       |\n    |    2       |    NULL    |\n    |    3       |    3       |\n    |    3       |    3       |\n    |    5       |    NULL    |\n    |    7       |    7       |\n    |    NULL    |    6       |\n    |    NULL    |    4       |\n    ---------------------------\n</code></pre>\n\n<p>Expected Result:</p>\n\n<pre><code>         col1        col2        \n     -----------  ----------- \n    |    1       |    1       |\n    |    2       |    NULL    |\n    |    3       |    3       |\n    |    3       |    3       |\n    |    NULL    |    4       |\n    |    5       |    NULL    |\n    |    NULL    |    6       |\n    |    7       |    7       |\n    ---------------------------\n</code></pre>\n\n<p>I tried union all with left and right join query but it doubles the result set. Is there a way that I can get this expected output.</p>\n\n<p>Thanks,\nEsen.</p>\n"},{"tags":["sql","exec","exe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13183738,"title":"Risks of using SQL trigger to run an exe","body":"<p>What are the risks of running an exe on an sql trigger? This is a closed server, intranet only, with limited user access to the server where the script runs from and the SQL server connection.</p>\n\n<p>I store outgoing emails temporarily in a table in my database system. These are then sent out via a trigger that runs and exe. The exe simply pulls the to, from, subject, cc, and body from the DB and send the email via CDO.</p>\n\n<p>I have to use an outside method of sending emails instead of simply sending from code-behind in order to avoid slwodown on the website. I asked regarding this specific issue in another post, but asking about exec risks seemed like a seperate issue. Direct any alternatives to the related post. </p>\n\n<p>Related post <a href=\"http://stackoverflow.com/questions/13180991/email-from-web-without-tying-up-webpage\">Email from web without tying up webpage</a></p>\n"},{"tags":["sql","query","oracle11g","entity-attribute-value"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13025135,"title":"How can I write a select query from a table which has columns like product,attribute,value?","body":"<p>I have tables like these</p>\n\n<pre><code> - Products: PID,ProductName...\n - Attributes:AID,AttributeName...\n - ProductAttributes:PID,AID,Value\n</code></pre>\n\n<p>and the values are</p>\n\n<pre><code>***ProductAttributes***\n\n - P1,A1,V1\n - P1,A2,V2\n - P1,A3,V3\n - P2,A1,V4\n - P2,A2,V2\n - P2,A3,V3\n - P3,A1,V1\n - P3,A2,V2\n - P3,A3,V5\n</code></pre>\n\n<p>I need a procedure which has 2 array parameters and it filters products by these parameters. If <code>Parameter1:{A1,A2}</code> and <code>Parameter2:{V1,V2}</code> procedure should select </p>\n\n<pre><code>P1,P3\n</code></pre>\n\n<p>How can I write this? Thanks</p>\n"},{"tags":["sql","ruby-on-rails","db2","db2-luw"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13183455,"title":"Unexpected token \"LIMIT\" in DB2","body":"<p>My Rails app is connected to a remote DB2 database, and when migrating I'm stumbling into this error:</p>\n\n<pre><code>==  DropLegacyProject: migrating ========================================\nrake aborted!\nAn error has occurred, this and all later migrations canceled:\n\nRuntimeError: Failed to execute statement due to: [IBM][CLI Driver][DB2/LINUXX8664] SQL0104N  An unexpected token \"LIMIT\" was found following \"\".  Expected tokens may include:  \"FETCH FIRST &lt;n&gt; ROWS ONLY\".  SQLSTATE=42601 SQLCODE=-104: SELECT  projects.* FROM projects WHERE projects.id &lt; 17 LIMIT 1\n</code></pre>\n\n<p>How can I fix this?</p>\n"},{"tags":["sql","algorithm","parsing"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13166590,"title":"Converting stored events into single records","body":"<p>I am currently working on a project that needs to utilize data stored in a SQL db in the format shown below.</p>\n\n<p>What I need to do, and am having difficulty finding a tool to help with, is to take this data and create a multi column single record keyed off of the ID and Event Date. While I have found some info on the net about event driven handlers, the problem is that although my labels say \"Event\" what is really stored is individual pieces of data called \"Events\" that are really individual entries that often, but not always, are entered at the same time and contribute to a whole event entry. I am sorry if this seems a bit confusing but I am working with a system I have no control over to change I just need to make useful sense of the data. </p>\n\n<p>Here is a running example of what is stored in the db that I need to convert to a single record;</p>\n\n<pre><code>ID      Event           Event Result  Event Result Value            Event Date      Entered By\n909909  Status Change       No          no                          10/25/12 23:10  Doe, John\n909909  Disposition         Remuni      Remains in place            10/25/12 23:10  Doe, John\n909909  Event duration      15mins      15mins                      10/25/12 23:10  Doe, John\n909909  Event end time      23:25       23:25                       10/25/12 23:10  Doe, John\n909909  Event start time    23:10       23:10                       10/25/12 23:10  Doe, John\n909909  Event type          Iniqrs      Initial System activation   10/25/12 23:10  Doe, John\n</code></pre>\n\n<p>Into the following single record;</p>\n\n<pre><code>ID      Event Start Event End   Moved               Action Taken                Entered By\n909909  23:10       23:25       Remains in place    Initial System activation   Doe, John\n</code></pre>\n\n<p>Thank you in advance for any help you can give.</p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13183527,"title":"duplicate rows in table, but need to change data in one column","body":"<p>I have the table <strong>step_year</strong>: id, step_id, year</p>\n\n<p>I want to duplicate all rows that have year = 1011 (select * from step_year where year = 1011), but instead of those newly created rows having the same year (1011) I want to change it to 1112.</p>\n\n<p>Any help is appreciated.</p>\n"},{"tags":["mysql","sql","scripting","data-migration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13183457,"title":"need help on migration script for mysql database","body":"<p>Hi here i am facing problem with my sql migration script </p>\n\n<p>I am having two tables namely discovery_configuration and credentialset </p>\n\n<p>the schema for these tables are like \nfor <strong>discovery_configuration</strong> table</p>\n\n<pre><code>CREATE TABLE `discovery_configuration` (\n   `id` bigint(20) NOT NULL AUTO_INCREMENT\n , `version` bigint(20) DEFAULT '0'\n ,  `class_code` char(255) NOT NULL DEFAULT 'discovery_configuration'\n ,  `msp_id` bigint(20) DEFAULT NULL\n ,  `client_id` bigint(20) DEFAULT NULL\n ,  `sa_id` bigint(20) DEFAULT NULL\n ,  `ip_range` text\n ,  `snmp_community` char(255) DEFAULT NULL\n ,  `snmp_port` int(11) NOT NULL DEFAULT '0'\n ,  `snmp_version` char(255) DEFAULT NULL\n ,  `domain_name` varchar(255) DEFAULT NULL\n ,  `user_name` char(255) DEFAULT NULL\n ,  `password` char(255) DEFAULT NULL\n ,  `profile_name` varchar(255) NOT NULL\n ,  `seed_node` varchar(50) DEFAULT NULL\n ,  `discovery_source` varchar(20) NOT NULL DEFAULT 'NSG'\n ,  `excutor_device_id` bigint(20) DEFAULT '0'\n ,  `frequency` int(11) DEFAULT '0'\n ,  `schedule_pattern` int(11) DEFAULT '0'\n ,  `auto_manage` tinyint(2) DEFAULT '0'\n ,  `auto_install` tinyint(2) DEFAULT '0'\n ,  `notify` tinyint(2) DEFAULT '0'\n ,  `notify_email` varchar(255) DEFAULT NULL\n ,  `network_depth` int(11) NOT NULL DEFAULT '0'\n ,  `reverse_dns_lookup` tinyint(1) DEFAULT '0'\n ,  `discovery_type` varchar(60) DEFAULT 'IPRANGE'\n ,  `cdp` tinyint(1) NOT NULL DEFAULT '0'\n ,  `arp` tinyint(1) NOT NULL DEFAULT '0'\n ,   PRIMARY KEY (`id`) \n ) ENGINE=InnoDB AUTO_INCREMENT=13502 DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>and other table <strong>credentialset</strong> is </p>\n\n<pre><code>CREATE TABLE `credentialset` (\n    `id` bigint(20) NOT NULL AUTO_INCREMENT\n  , `version` bigint(20) NOT NULL\n  , `name` varchar(255) NOT NULL\n  , `user_name` varchar(255) NOT NULL\n  , `password` varchar(255) NOT NULL\n  , `transport_type` varchar(50) NOT NULL\n  , `credential_type` varchar(50) NOT NULL\n  , `is_secure` tinyint(1) DEFAULT '0'\n  , `community` varchar(255) DEFAULT NULL\n  , `port` bigint(20) DEFAULT '0'\n  , `snmp_version` varchar(45) DEFAULT NULL\n  , `client_id` bigint(20) DEFAULT NULL\n  , `domain_name` varchar(255) DEFAULT NULL\n  ,  PRIMARY KEY (`id`)\n  ,  UNIQUE KEY `credentialset_ukey` (`client_id`,`name`) \nENGINE=InnoDB AUTO_INCREMENT=104 DEFAULT CHARSET=utf8\n</code></pre>\n\n<p>and here my requirement is first need to read records from <strong>discovery_configuration</strong> table and check whether <strong>username</strong> column is empty or not(may be empty) if username column is not empty we have to copy that record into <strong>credentialset</strong> table (dont mind about <strong>name</strong> column in <strong>credentialset</strong> table) and if <strong>username</strong> column is empty then <strong>snmp_community</strong> column will be compulsorily  filled and need to migrate those records into <strong>credentialset</strong> table. I need mysql procedure to do this . I have tried with sql statement but not getting it exactly.</p>\n"},{"tags":["sql","sql-server-2008","stored-procedures","stored-functions","sql-function"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13173989,"title":"Convert stored procedure to table-valued query","body":"<p>I have this procedure</p>\n\n<pre><code>ALTER PROCEDURE [dbo].GetHerdByUserProc(@user int)\nAs \n    begin\n        Declare\n            @GroupId uniqueidentifier,\n            @UserTrade bit\n\n        Set @GroupId = (select tbUser.group_id from tbUser where Userid = @user)\n        Set @UserTrade = (select tbUser.isTrade from tbUser where Userid = @user)\n        if @GroupId IS NOT NULL and @UserTrade = '1'\n        Begin \n            select HerdId from tbUserHerds where tbUserHerds.UserId in (select Userid from tbUser where tbUser.Group_Id = @GroupId)\n            return;\n        END\n        If @GroupId IS NOT NULL\n        Begin   \n            select HerdId from tbUserHerds where tbUserHerds.UserId = @user\n            return;\n        End\n        return;\n    End\n</code></pre>\n\n<p>It returns a list correctly except I would also like to run a query on the list that is returned and as far as I am aware I cannot write a query such as</p>\n\n<pre><code>Select * from GetHerdByUserProc 80\n</code></pre>\n\n<p>So I am looking the best way to convert this to a table-valued query.</p>\n\n<p>I have changed the alter to say <code>'Create Function x(@user int) Returns Table As'</code></p>\n\n<p>But that does not seam to work it starts screaming errors at me.</p>\n\n<p>Any ideas?  The Database Server is MSSQL2008</p>\n"},{"tags":["mysql","sql","query","join","left-join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13183371,"title":"Tricky MySQL query with joins?","body":"<p>I have 4 tables (among a lot of others - just showing the relevant ones). They are:</p>\n\n<ul>\n<li>\"users\"\n<ul>\n<li>id</li>\n<li>name</li>\n<li>role_id</li>\n</ul></li>\n<li>\"roles\"\n<ul>\n<li>id</li>\n<li>name</li>\n</ul></li>\n<li>\"chapter_role_view_permissions\"\n<ul>\n<li>id</li>\n<li>chapter_id</li>\n<li>role_id</li>\n</ul></li>\n<li>\"chapters\"\n<ul>\n<li>id</li>\n<li>name</li>\n</ul></li>\n</ul>\n\n<p>I'm trying to build a query that will return to me a list of all users, their role name, all chapters per user, and whether or not they have view access to each chapter. So lets say there are 2 users and 2 chapter. User 1 is role_id=1 and User 2 is role_id=2. And the chapter_role_view_permissions has 1 record ( id:1 | chapter_id: 1 | role_id: 1 ) which means only users with role_id=1 can view chapter 1.</p>\n\n<p>The query result I am looking for should be something like:</p>\n\n<p>|---users.id---|--roles.id---|---chapters.id--|-can_view_chapter-|</p>\n\n<p>|------ 1 ------|----- 1 -------|------- 1 --------|----------- 1 -----------|</p>\n\n<p>|------ 1 ------|----- 1 -------|------- 2 --------|----------- 0 -----------|</p>\n\n<p>|------ 2 ------|----- 2 -------|------- 1 --------|----------- 0 -----------|</p>\n\n<p>|------ 2 ------|----- 2 -------|------- 2 --------|----------- 0 -----------|</p>\n\n<p>Any idea what the query might look like? I don't want to have to make a new field in chapter_role_view_permissions that says \"allowed\" and insert new records for each role type with either allowed=1 or allowed=0</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13176954,"title":"Sql Server union with If condition","body":"<p>I have a query like:</p>\n\n<pre><code>DECLARE @tmpValue\nSET @tmpValue = 0 -- it will be change \n\nSELECT * FROM Animal WHERE AniActive = 1\nUNION \nIF @tmpValue &gt; 0 \nSELECT * FROM Animal WHERE.Active = 0\n</code></pre>\n\n<p>When I use like this it is giving error because of if condition. I have to use UNION because of our structure. </p>\n\n<p>How can I use it with if condition?</p>\n\n<p>Thanks, <br/>\nJohn</p>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13183219,"title":"Inserting Data from a form into SQL Server","body":"<p>I have two files, csform.php and process.php.  Csform.php is the main page with the form that a user will enter in the data and hit submit which then I have process.php and the sql connection and I want that data the user entered into the form to be inserted into the sql server database.  But when submit is hit the data that is entered into the form is not inserted, the data in line 13 of the process.php file is inserted.  What am I doing wrong, is doesn't seem like I have a connection between the two files.  Here is the coding I currently have:</p>\n\n<p>csform.php:</p>\n\n<pre><code>&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n&lt;title&gt;CSLog&lt;/title&gt;\n&lt;/head&gt;\n&lt;h1&gt; Customer Service Form &lt;/h1&gt;\n&lt;form method=\"post\" action=\"process.php\"&gt; \n&lt;table width=\"300\" border=\"0\"&gt;\n&lt;tr&gt;\n&lt;td&gt; Forte ID:&lt;/td&gt;\n&lt;td&gt;&lt;select id=\"forteid\" input name=\"forteid\"&gt;                  \n                &lt;option value=\"user1\"&gt;user1&lt;/option&gt;\n                &lt;option value=\"user2\"&gt;user2&lt;/option&gt;\n                &lt;option value=\"user3\"&gt;user3&lt;/option&gt;\n                &lt;option value=\"user4\"&gt;user4&lt;/option&gt;                   \n    &lt;/select&gt;&lt;/td&gt;\n &lt;/tr&gt;\n &lt;tr&gt;\n &lt;td&gt; Disposition&lt;/td&gt;\n &lt;td&gt;&lt;select id=\"disposition\" input name=\"disposition\"&gt;                 \n                &lt;option value=\"Save\"&gt;--Save--&lt;/option&gt;\n                &lt;option value=\"Sale\"&gt;--Sale--&lt;/option&gt;\n                &lt;option value=\"LOC\"&gt;--LOC--&lt;/option&gt;                   \n    &lt;/select&gt; &lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;br /&gt;\n&lt;hr /&gt;        \n&lt;br /&gt; \n&lt;br /&gt; \n&lt;table width=\"400\" border=\"0\"&gt;\n&lt;tr&gt;\n&lt;td&gt;App Number:&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;&lt;input type=\"text\" name=\"appnumber\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Finance Number:&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;&lt;input type=\"text\" name = \"Finance_Num\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Number Payments:&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;&lt;input type=\"text\" name = \"num_payments\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Ach or CC:&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;&lt;input type=\"text\" name = \"ach_cc\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;Date:&lt;/td&gt;\n&lt;td&gt;&lt;/td&gt;\n&lt;td&gt;&lt;input type=\"text\" name = \"date\"&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;br /&gt;\nNotes: \n&lt;br /&gt;\n&lt;textarea input name=\"text\" id=\"notes\" cols=\"45\" rows=\"5\"&gt;&lt;/textarea&gt;\n&lt;/fieldset&gt;\n&lt;br /&gt;\n&lt;br /&gt; \n&lt;hr /&gt;\n&lt;br /&gt;\n&lt;br /&gt;            \n&lt;input type=\"submit\" name=\"formSubmit\" value=\"Submit\"&gt;  &lt;input type=\"Reset\"        name=\"formReset\" value=\"Reset\"&gt; \n&lt;/form&gt; \n&lt;/head&gt;\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And then the process.php:</p>\n\n<pre><code>&lt;?php\n$serverName = 'SRB-Nick_Desktop\\SQLEXPRESS';\n$connectionInfo = array('Database'=&gt;'cslogs', 'UID'=&gt;'cslogslogin', 'PWD'=&gt;'123456');\n$connection = sqlsrv_connect($serverName, $connectionInfo);\n\nif( $connection === false )\n{\n echo \"Connection could not be established.\\n\";\n die( print_r( sqlsrv_errors(), true));\n}\n\n$tsql = \"INSERT INTO logs(ForteID, disposition, appnumber, Finance_Num, num_payments,   ach_cc, date, notes) VALUES (?,?,?,?,?,?,?,?)\";\n$parameters = array( \"forteid\", \"LOC\", \"NCXXXXXXX4\", \"SRB-000004\", \"0\", \"cc\", \"2012-11-01\", \"gave LOC instructions\");\n$stmt = sqlsrv_query($connection, $tsql, $parameters);\nif( $stmt === false ){\necho \"Statement could not be executed.\\n\";\n die( print_r( sqlsrv_errors(), true));\n} else {\necho \"Rows affected: \".sqlsrv_rows_affected( $stmt ).\"\\n\";\n}\n/* Free statement and connection resources. */\nsqlsrv_free_stmt( $stmt);\nsqlsrv_close( $connection);\n?&gt;\n</code></pre>\n\n<p>Hopefully someone is able to help me or steer me in the right direction on what I am doing wrong.</p>\n"},{"tags":["sql","excel","excel-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13183354,"title":"How do i insert or attached .sql file into my Excel.xls file?","body":"<p>I'm making project documentation though I want to attach many sql files with columns\nin excel file.</p>\n\n<p>I tried like <code>Insert Object</code> > <code>Create File</code></p>\n\n<p>but it is not attaching file nor able to link that file</p>\n\n<p>instead of link that file I would like to attachment in excel itself ,</p>\n\n<p>so that using only one Excel.xls file i will have all other attachment files with me</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["sql","sql-server","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13181575,"title":"What is wrong with this SQL statement for inserting concatenated IDS from a table into a field?","body":"<pre><code>INSERT INTO Activity_Feed (userID,Type,DataIDs,PodID) \nVALUES ( 1437\n      , 'eventattend'\n      , (SELECT LEFT(EventID, LEN(eventID) - 1 as nvarchar) \n         FROM ( \n            SELECT EventiD + ', ' \n            FROM   events \n            FOR XML PATH ('')) c (EventID))\n      , 5)\n</code></pre>\n\n<p>Basically I want to take a bunch of IDs from a table and insert them as a comma delimited string into a varchar field.</p>\n\n<p>E.g.</p>\n\n<pre><code>Activity_Feed (table)\n\nactivityID   1\nuserID       2\nDataIDs      1,3,4,56,367 // This would be the (Select Ids FROM bit)\n</code></pre>\n\n<p>I want to take a bunch of RSVP IDs from a table and stick their IDs in the field...</p>\n\n<p>To further explain I wanted to avoid normalizing the query because of the nature of this query. Let me know if I should still separate out the data...</p>\n\n<p>The activity feed works like this...</p>\n\n<p>I create a new entry in activity with a type of <code>event_attending</code> (which is an event I am attending. </p>\n\n<p>I timestamp it, I enter the ID for the event in the <code>dataIDs</code> field any new activity matching <code>event_attending</code> in a 6 hour period fires an <code>update</code> record rather than <code>insert</code> </p>\n\n<p>I keep the timestamp the same but update the ID's that are associated with that time period so basically update the IDs with the latest event attendance within that time period.</p>\n\n<p>I thought normalizing seemed like overkill :D is there such thing as overkill with normalization?</p>\n"},{"tags":["mysql","sql","loops","recursion"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13181882,"title":"How to return a certain set of sub-strings using SQL","body":"<p>Using MySQL, having <code>x = 'aa.bb.cc'</code>, how can I obtain the list <code>'aa.bb.cc', 'aa.bb', 'aa'</code>?</p>\n\n<p>With <code>x = '39.01'</code>, the list is <code>'39.01', '39'</code>.</p>\n\n<p>With <code>x = '39.02.01.01'</code>, the list is <code>'39.02.01.01', '39.02.01', '39.02', '39'</code>.</p>\n\n<p>From the last example above with <code>x = '39.02.01.01'</code>, I would want to be able to construct something like:</p>\n\n<pre><code>SELECT ... FROM ... WHERE foo IN bar\n</code></pre>\n\n<p>where <code>bar</code> is dynamically obtained as <code>('39.02.01.01', '39.02.01', '39.02', '39')</code>.</p>\n\n<p>Any ideas would be appreciated.</p>\n"},{"tags":["sql","ibm-midrange"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13182431,"title":"Can you use SQL to query the Select/Omit criteria of an AS/400 logical file?","body":"<p>I need to be able to lookup the Select/Omit critera of an AS/400 Logical File using SQL.  I cannot use DSPSELOMT.</p>\n\n<p>I figured out how to query whether or not the Logical File has Select/Omit critera by looking at the SELECT_OMIT column in SYSTABLES. (<a href=\"http://publib.boulder.ibm.com/infocenter/iseries/v6r1m0/index.jsp?topic=/db2/rbafzcatalogtbls.htm\" rel=\"nofollow\">IBM i catalog tables and views</a>)</p>\n\n<p>However, I cannot figure out how to query the criteria used in the Select/Omit statement.  How can you view the Select/Omit critera using SQL?  If it's not possible, could you cite a source?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","postgresql","boolean","parameterized-query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":111,"score":0,"question_id":11018613,"title":"Boolean wildcard in postgresql","body":"<p>I have a parameterized postgresql query that users interact with through a PHP front-end.  One of the parameters involves a boolean value, and I want to give the user the option of \"True\", \"False\", \"Unknown\" (Null) or \"Doesn't matter\" (return any result).</p>\n\n<p>Rewriting the actual query isn't an option (the parameterized queries are stored in a database table, not in the PHP code), so I need to have a boolean \"any\" value.</p>\n\n<p>Put another way, what value can I assign \":parameter1\" in this query to get any row, regardless of the value of \"boolean_column\"?</p>\n\n<pre><code>SELECT some_column, some_other_column\nFROM some_table\nWHERE boolean_column = :parameter1\n</code></pre>\n\n<p>EDIT: I need to clarify -- <em>I</em> can rewrite the query, but <em>the program</em> cannot rewrite the query (i.e., I can't drop or rewrite the where clause in response to user input at runtime).</p>\n\n<p>EDIT2: Here's my final solution (thanks couling!)</p>\n\n<pre><code>SELECT some_column, some_other_column\nFROM some_table\nWHERE (:parameter1::text = 'any' OR boolean_column = :parameter1::boolean)\n</code></pre>\n\n<p>Of course, the program has to restrict possible values to 'any' or a string value that can be cast to boolean (e.g., 'true', 't', 'false', 'f').</p>\n\n<p>EDIT3:  The previous solution works in PHP with PDO, but does not work with python's psycopg2 or directly in postgresql for some reason.  I've tried a variation with a case statement, like so:</p>\n\n<pre><code>SELECT some_column, some_other_column\nFROM some_table\nWHERE (CASE WHEN :parameter1::text in ('true', 'false') THEN boolean_column = :parameter1::boolean ELSE TRUE END)\n</code></pre>\n\n<p>But that doesn't work either.  It seems no matter what, I can't stop postgresql from trying to evaluate \":parameter1::boolean\", even if it's behind a false WHEN condition.  This is a real pickle...</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13182990,"title":"In MySQL, how can I find the sum of the N largest values grouped on a particular column?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2129693/mysql-using-limit-within-group-by-to-get-n-results-per-group\">mysql: Using LIMIT within GROUP BY to get N results per group?</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following data.</p>\n\n<pre><code>id      val\nsmith   20\nsmith   10\nsmith    8\nsmith   30\njones   40\njones   10\njones   30\njones   30\n</code></pre>\n\n<p>What I want then is to group by id and sum the two largest values for each id.</p>\n\n<pre><code>smith   50  from 30+20\njones   70  from 40+30\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13183082,"title":"paginating table and getting row count","body":"<p>The query below fetches a subset of rows from a table starting at row 10 and ending at row 20. In addition, to save a query I need to return the total number of rows in the table. This is the best solution that I could think of. Are there any more efficient/elegant ways? In particular, I do not like the <code>partition by 1</code> part.</p>\n\n<pre><code>select *\nfrom (select count(*) over (partition by 1) as [count],\n             row_number() over (order by [Name],[Description]) as [row],\n             *\n      from [Products]) as t\nwhere row between 10 and 20\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13182402,"title":"Move a table from one database to another server","body":"<p>I have a table <code>tbl_Question</code> in <code>MyDatabase</code> on <code>MySqlServer</code>. I want to move that table to <code>MyDB_2</code> on <code>MyLocalSqlServer</code>. </p>\n\n<p>How can I do that?</p>\n\n<p>I am using SQL Server 2008 R2 and Microsoft SQL Server Management Studio 10.50.1617.0</p>\n"},{"tags":["sql","sql-server","performance","application","architecture"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13173984,"title":"Is having a copy of SQL data in an application a good idea to save SQL SELECTS?","body":"<p>I am working on a multithreading .NET 4 application which acquires data continuously and writes them into a SQL database (MySQL or SQL Server - not yet sure).</p>\n\n<p>Everytime when a <code>INSERT</code> is executed, at leat one prior <code>SELECT</code> is necessary in order so synchronize with the databaes. This means the applications gets a block which contains new and old data and then has to check which data sets are new and which are already in the database.</p>\n\n<p>This means a lot of <code>SELECTS</code> which result everytime in more or less the same data.</p>\n\n<p>Would it be a good idea to have a copy of the last x entries per table within the application?\nThis way the synchronization could be done on the copy instead of the database.</p>\n\n<p>Pro: </p>\n\n<ul>\n<li>Faster</li>\n</ul>\n\n<p>Contra:</p>\n\n<ul>\n<li>Uses a lot of memory</li>\n<li>Risk of becomming unsynchronized with the database</li>\n</ul>\n\n<p>What do you think? What is the best practice for such a use case?\nAny other pros and cons?</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13182309,"title":"Advanced count with join SQL","body":"<p>I have two tables, items &amp; categories, sample data below:</p>\n\n<pre><code>Items:\nTitle    category_id\nItem A   1\nItem B   2\nItem C   3\nItem D   2\nItem E   3\nItem F   2\n\nCategories\ncategory_id   category\n1             wood\n2             plastic\n3             metal\n</code></pre>\n\n<p>What I need to do is to count the total number of items, then list how many are in each category and what % that is of the total</p>\n\n<p>I know I can count each item and total e.g.</p>\n\n<pre><code>select \n  count(*) as total, \n  sum(category_id=1) as cat_1, \n  sum(category_id=2\n.... etc etc\n</code></pre>\n\n<p>But is there a way to do it all without counting each (there maybe new categories added and would like this to stay working) and then joining with categories table to produce the name?</p>\n\n<p>Ideally this is what I'd like to return:</p>\n\n<pre><code>Category    how many    % of total\nwood        1           17%\nplastic     3           50%\nmetal       2           33%\n\nTotal       6           100%\n</code></pre>\n\n<p>(17% is 1/6th => 16.666666667% rounded).</p>\n"},{"tags":["sql","mysql","performance","types"],"answer_count":8,"favorite_count":2,"up_vote_count":19,"down_vote_count":0,"view_count":5486,"score":19,"question_id":1962310,"title":"Importance of varchar length in MySQL table","body":"<p>I have a MySQL table where rows are inserted dynamically.  Because I can not be certain of the length of strings and do not want them cut off, I make them varchar(200) which is generally much bigger than I need.  Is there a big performance hit in giving a varchar field much more length than necessary?</p>\n"},{"tags":["php","sql","query","results"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13168663,"title":"SQL query results returned, even if exact match not found","body":"<p>I hope this question isn't redundant.  What I am trying to accomplish is have a user select a bunch of checkboxes on a page and return the closest matching records if there are no matching rows. For example:</p>\n\n<p>A person checks off [x]Apples [x]Oranges [x]Pears [x]Bananas</p>\n\n<p>But the table looks like this:</p>\n\n<pre><code>Apples     Oranges      Pears     Bananas\n 1             1           1        null\n 1             1         null       1\n 1             1         null       null\n</code></pre>\n\n<p>(Obviously I missed the id column here, but you get the point I think.) So, the desired result is to have those three rows still be returned in order of most matches, so pretty much the order they are in now. I'm just not sure what the best approach to take on something like this. I've considered a full text search, the levenshtein function,  but I really like the idea of returning the exact match if it exists. No need for you to go at length with code if not needed. I'm just hoping to be sent in the right direction. I HAVE seen other questions sort of like this, but I still am unsure about which way to go.</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13180086,"title":"Call a SQL function in a query","body":"<p>I have an issue with a function in SQL Server 2008, if I execute a query with a function, it takes like 40 secs, if I remove the function and I add the logic of the function in the query, is 0 secs!</p>\n\n<p>Anybody can explain me the reason of why using a function could be so slow? I really want to use the function to encapsulate the logic but I don't find the way of...</p>\n"},{"tags":["sql","ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1249,"score":1,"question_id":2952482,"title":"Advanced count and join in Rails","body":"<p>I am try to find the top <code>n</code> number of categories as they relate to articles, there is a habtm relationship set up between the two. This is the SQL I want to execute, but am unsure of how to do this with ActiveRecord, aside from using the <code>find_by_sql</code> method. is there any way of doing this with ActiveRecord methods:</p>\n\n<pre><code>SELECT \n  \"categories\".id, \n  \"categories\".name, \n  count(\"articles\".id) as counter \nFROM \"categories\"\nJOIN \"articles_categories\" \n  ON \"articles_categories\".category_id = \"categories\".id\nJOIN \"articles\" \n  ON \"articles\".id = \"articles_categories\".article_id\nGROUP BY \"categories\".id\nORDER BY counter DESC\nLIMIT 5;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13181966,"title":"SQL: Comparing MAX Dates from Two different Tables","body":"<p>I have 3 Tables</p>\n\n<h2>User</h2>\n\n<p><img src=\"http://i.stack.imgur.com/OvUMc.jpg\" alt=\"enter image description here\"></p>\n\n<h2>Attendence</h2>\n\n<p><img src=\"http://i.stack.imgur.com/7hpGz.jpg\" alt=\"enter image description here\"></p>\n\n<h2>Payment</h2>\n\n<p><img src=\"http://i.stack.imgur.com/hHwEh.jpg\" alt=\"enter image description here\"></p>\n\n<p>Now I like to get    </p>\n\n<p>GroupID, UserName, MAX(PaymetDate), MAX(AttendenceDate)</p>\n\n<p>Where MAX(PaymetDate) IS LESS THAN MAX(AttendenceDate)</p>\n\n<h3>This what I have Tried</h3>\n\n<pre><code>    SELECT  MAX(PaymetDate) AS Paied_Upto\n    FROM Payment\n    Group by GroupID   \n\n    SELECT  MAX(AttendenceDate) AS Last_ AttendenceDate\n    FROM Attendence FULL OUTER JOIN Users ON Attendence.Username = Users.Username\n    Group by Users.GroupID\n</code></pre>\n\n<p>But how do get them to work together?</p>\n\n<h3>Thank</h3>\n"},{"tags":["sql","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13178298,"title":"linq group by multipe aggregates","body":"<p>Im new to Linq and Im sure that I have gone about this in a convoluted manner.  Im trying to do something like this SQL in Linq:</p>\n\n<p><code>\nSELECT DISTINCT<br/>\n&nbsp;&nbsp; count(vendor) as vendorCount, <br/>\n&nbsp;&nbsp; reqDate, <br/>\n&nbsp;&nbsp; status, <br>\n&nbsp;&nbsp; openDate, <br>\n&nbsp;&nbsp; item, <br>\n&nbsp;&nbsp; poDate, <br>\n&nbsp;&nbsp; count(responseDate) as responseCount <br>\nFROM <br>\n&nbsp;&nbsp; myTable<br>\nGROUP BY <br>\n&nbsp;&nbsp; reqDate, status, openDate, item, poDate<br>\nHAVING<br>\n&nbsp;&nbsp; reqDate > openDate\n</code></p>\n\n<p>Here is what I have so far.\n<code></p>\n\n<pre><code>        var groupQuery = (from table in dt.AsEnumerable()\n                         group table by new\n                         {                                 \n                             vendor = table[\"vendor\"], reqdate = table.Field&lt;DateTime&gt;(\"ReqDate\"), status = table[\"status\"],\n                             open = table[\"openDate\"],  \n                             item = table[\"item\"), \n                             podate = table.Field&lt;DateTime&gt;(\"PODate\"), responsedate =  table.Field&lt;DateTime&gt;(\"responseDate\"), \n                         }\n                             into groupedTable\n                             where Having(groupedTable.Key.reqdate, groupedTable.Key.openDate) == 1\n                             select new\n                             {\n                                 x = groupedTable.Key,  \n                                 y = groupedTable.Count()\n                             }).Distinct();\n\n\n\n        foreach (var req in groupQuery)\n        {\n            Console.WriteLine(\"cols: {0} count: {1} \",\n                req.x, req.y);\n        }\n</code></pre>\n\n<p></code></p>\n\n<p>The Having() is a function that takes two datetime parameters and returns a 1 if the reqDate is greater than the openDate.  It compiles and runs, but it obviously does not give me the results I want.  Is this possible using Linq?  I want to push this data to an excel spreadsheet so Im hoping to create a datatable from this linq query.  Would I be better off just creating a dataview from my datatable and not mess with Linq?</p>\n"},{"tags":["php","mysql","sql","insert","double"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13181651,"title":"mysql is inserting doublepost","body":"<p>I have a problem with mysql inserting. When the button is clicked, mysql insert is making a doublepost. I can't find the problem.  Why is it doubleposting?</p>\n\n<p>code here <a href=\"http://pastebin.com/z1xx3fjt\" rel=\"nofollow\">http://pastebin.com/z1xx3fjt</a></p>\n\n<p>And <code>postNewTopic.php</code>:</p>\n\n<pre><code>&lt;?\nsession_start();\nmysql_connect('.com', 'user', 'pw');\nmysql_select_db('db');\n\nfunction msg($status,$txt){\n    return '{\"status\":'.$status.',\"txt\":\"'.$txt.'\"}';\n}\n\nif(empty($_POST['t']) or empty($_POST['ttitle'])){\n    die(msg(0,\"Complete all fields!\"));\n}\n\n\n\n$title = mysql_real_escape_string($_POST['ttitle']);\n$desc = mysql_real_escape_string($_POST['tdesc']);\n$msg = mysql_real_escape_string($_POST['t']);\n\n\nmysql_query(\"INSERT INTO f_topics(`title`, `text`, `desc`) \n                        VALUES('$title', '$msg', '$desc')\");\n\necho msg(1,mysql_error());\n?&gt;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13181782,"title":"Why the table sys.sql_modules is empty?","body":"<p>In SSMS, I create a database using the following script. When the script execution completes, I would expect to see the CREATE TABLE statement in the <a href=\"http://technet.microsoft.com/en-us/library/ms175081.aspx\" rel=\"nofollow\">sql_modules</a> table. However I can't find it.</p>\n\n<pre><code>CREATE DATABASE [MyDb]\nGO \nUSE [MyDb]\nGO\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[MyTable] (\n    [UID] [uniqueidentifier] NOT NULL,\n    [DateTime] [datetime] NOT NULL\n)\n</code></pre>\n\n<p>Here's the query I run the get the table definition. However, I get three empty result sets. Any idea why I am getting those three empty results set?</p>\n\n<pre><code>USE MyDb\nGO\n\nSELECT * \nFROM sys.sql_modules\n\nSELECT * \nFROM sys.triggers\n\nSELECT sm.object_id, OBJECT_NAME(sm.object_id) AS object_name, o.type, o.type_desc, sm.definition\nFROM sys.sql_modules AS sm\nJOIN sys.objects AS o ON sm.object_id = o.object_id\nORDER BY o.type;\n</code></pre>\n"},{"tags":["sql","plsql","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13181692,"title":"Need Comma seperated output for a query fetching mutiple rows","body":"<p>Query:</p>\n\n<pre><code>select o.candidateid \nfrom onboardingcandidates o, candidatedetails c \nwhere o.candidateid=c.candidateid \n    and o.JOININGSTATUS='0091' \n    and to_date(o.joiningdate)=to_date(sysdate+5);\n\nOutput:\n\ncand1\ncand2\ncand3\ncand62\n\nRequired Output:\n\ncand1, cand2, cand3, cand62\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13180517,"title":"Casting as float vs int returning different results","body":"<p>Mathematically, these results are similar, I'm just curious about their behavior.  The first version when my local variable is declared as a float, the rounding function stops the decimals displayed at the second decimal. In the second version with the local variable declared as an int the <code>round</code> function rounds to two decimal places, and then adds a bunch of zeroes.  Why would the variable type cause the <code>round</code> function to behave differently?</p>\n\n<pre><code>declare @totalpop float \nset @totalpop = (select count(distinct patid) from members)\nselect @totalpop\nselect edutext\n,COUNT(*) as educationCounts\n,round(100.0*COUNT(*)/@totalpop,2)\nfrom\n(\nselect distinct m.patid, e.eduText\n    from members as m\n    inner join EducationTable as e on e.eduID = m.education\n)x\ngroup by x.eduText\n</code></pre>\n\n<p>--doesn't round to two decimal places</p>\n\n<pre><code>declare @totalpop int\nset @totalpop = (select count(distinct patid) from members)\nselect @totalpop\nselect edutext\n,COUNT(*) as educationCounts\n,round(100.0*COUNT(*)/@totalpop,2)\nfrom\n(\nselect distinct m.patid, e.eduText\n    from members as m\n    inner join EducationTable as e on e.eduID = m.education\n)x\ngroup by x.eduText\n</code></pre>\n"},{"tags":["sql","postgresql","table","database-design","unique"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13180907,"title":"Sql table where row may only be inserted if unique column","body":"<p>I want to create a table which contains person, house and family, where only persons from the same family are allowed to live in the same house.</p>\n\n<p>What I have so far does not work because I can only post one row with unique family and house. Is there any way to do this?</p>\n\n<pre><code>CREATE TABLE familyhouse (\n  person VARCHAR(64),\n  house VARCHAR(64),\n  family VARCHAR(64),\n  unique(house,family)\n);\n</code></pre>\n\n<p>Example of correct table:</p>\n\n<pre><code>man,'1','1'\nman2,'1','1'\nman3,'1','1'\nman4,'2','2'\nman5,'2','2'\nman6,'3','3'\n</code></pre>\n\n<p>Example of non-correct table:</p>\n\n<pre><code>man,'1','1'\nman2,'1','1'\nman3,'1','2'\n</code></pre>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":24,"score":1,"question_id":13181219,"title":"Selecting data from specfic times","body":"<p>I am having trouble getting a query that only displays results between 6am yesterday and 6am today.  Using sql server 2008.  I have a timestamp column with type datetime</p>\n\n<p>thanks for any help offered</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":44,"score":-4,"question_id":13181101,"title":"Getting the sum of three rows from one column?","body":"<p>I have a table, the data in it looks similar to this:</p>\n\n<pre><code>user  type       hours    used    --to make another column with this info    available\n\n2334  sick       10.000   2.000                                              8.000\n2334  vacation   48.000   56.000                                             -8.000\n2334  personal   0        8.000                                              0\n1356  sick       0        16.000                                             -16.000\n1356  vacation   80.000   0                                                  80.000\n1356  personal   14.000   14.000                                             0\n4355  sick       4.000    1.000                                              3.000\n4355  vacation   112.000  0                                                  112.000 \n4355  personal   8.000    0                                                  8.000\n</code></pre>\n\n<p>I had to sum up the values in the hours column, but only for each user.  So user 2334 would have earned <code>58.000</code> hours, <code>10.000 + 48.000 + 0</code> but would have used <code>66.000</code> hours resulting in <code>-8.000</code> hours.</p>\n"},{"tags":["php","sql","user"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13180297,"title":"If account type x include y?","body":"<p>I am trying to direct one set of users <code>Basic</code> to one type of profile page <code>mod_profile.php</code> and another set of users <code>upgraded</code> to a different profile page <code>mod_account.php</code>. So far, I have this but it seems to be having trouble. I am getting errors when I open up <code>mod_account.php</code> about it not being able to redeclare certain functions from <code>mod_profile</code> or the other profile page, but I dont understand why, I only want one of the pages to load for each user type. </p>\n\n<p>Can someone please advise me what I am doing wrong?</p>\n\n<p>My <code>profile.php</code> page:</p>\n\n<pre><code> &lt;?php\n    $page_title = \"Profile\";\n    include('includes/header.php');\n    include ('includes/mod_login/login_form2.php');     \n\n    // GET PROFILE ID FROM URL\n    if (isset ($_GET['id'])) {\n        $profile_id = $_GET['id'];\n    }\n    ?&gt;\n\n    &lt;?php\n    $user_info_set = get_user_info();\n    if (!$user = mysql_fetch_array($user_info_set)) {\n        include ('includes/mod_profile/mod_noprofile.php');\n    } else if (!isset($profile_id)) {\n        include(\"includes/mod_profile/mod_noprofile.php\");\n    }\n\n    $profile_info_set = get_profile_info();\n    while ($profile = mysql_fetch_array($profile_info_set)) \n\n    if (isset ($profile_id))\n    if ($user['account_status'] == \"Active\") {\n        include(\"includes/mod_profile/mod_profile.php\");\n    }\n\n    $profile_info3_set = get_profile_info3();\n\n    while ($profile = mysql_fetch_array($profile_info3_set)) \n        if (isset ($profile_id))\n        if ($user['account_type'] == \"Basic\n\n    ----------\n\n    \") {\n        include(\"includes/mod_profile/mod_account.php\");\n    }\n    ?&gt;\n    &lt;script type=\"text/javascript\" src=\"assets/js/jquery.prettyPhoto.js\"&gt;&lt;/script&gt;\n    &lt;?php include('includes/footer.php');?&gt;\n</code></pre>\n\n<p>my defined function code:</p>\n\n<pre><code> // profile functions\n        function get_user_info() {\n            global $connection;\n            global $profile_id;\n            $query = \"SELECT *\n                        FROM ptb_users\n                        WHERE id = \\\"$profile_id\\\"\n                        AND account_status = \\\"Active\\\" \";\n            $user_info_set = mysql_query($query, $connection);\n            confirm_query($user_info_set);\n            return $user_info_set;\n        }\n\nfunction get_profile_info() {\n            global $connection;\n            global $profile_id;\n            $query = \"SELECT *\n                        FROM ptb_profiles, ptb_users\n                        WHERE ptb_profiles.user_id = \\\"$profile_id\\\"\n                        AND account_type = \\\"Basic\\\"\n                        AND ptb_profiles.user_id = ptb_users.id\";\n            $profile_info_set = mysql_query($query, $connection);\n            confirm_query($profile_info_set);\n            return $profile_info_set;\n\n            }\n\n\n            function get_profile_info3() {\n            global $connection;\n            global $profile_id;\n            $query = \"SELECT *\n                        FROM ptb_profiles, ptb_users\n                        WHERE ptb_profiles.user_id = \\\"$profile_id\\\"\n                        AND account_type = \\\"Upgraded\\\"\n                        AND ptb_profiles.user_id = ptb_users.id\";\n            $profile_info3_set = mysql_query($query, $connection);\n            confirm_query($profile_info3_set);\n            return $profile_info3_set;\n\n            }\n</code></pre>\n"},{"tags":["php","sql","script","login","cpanel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13181296,"title":"login.php sql database","body":"<p>I am getting this error when my login.php file loads..\n'Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource'\nHeres what i have..</p>\n\n<pre><code>$query = mysql_query(\"SELECT * FROM users WHERE username='$username'\");\n$numrows = mysql_num_rows($query);\nif($numrows!=0)\n{\nwhile ($row = mysql_fetch_assoc($query))\n{\n    $dbusername = $row['username'];\n    $dbpassword = $row['password'];\n}\nif ($username==$dbusername&amp;&amp;$password==$dbpassword)\n{\n    echo \"Youre in!\";\n}\nelse\n    echo \"Incorrect Password!\";\n}\nelse\n    die(\"That user doesnt exist!\");\n}\nelse\ndie(\"Please enter a username and a password!\");\n?&gt;\n</code></pre>\n"},{"tags":["sql","query","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13181117,"title":"SQL - how to get out chained data?","body":"<p>I have 4 tables which were auto generated for me:</p>\n\n<ul>\n<li>User</li>\n<li>Challenge</li>\n<li>Exercise</li>\n<li>Challenge_Exercise</li>\n</ul>\n\n<p>One User may have many Challenges, and one Challenge will have many Exercises.</p>\n\n<p>What I noticed is that the Challenge table has a reference to it's parent User (called user_id) but Exercise do not have a reference in it's table to Challenge; their relation is stored in Challenge_Exercise as Challenge_id and exercise_id.</p>\n\n<p>My question is, how would I take out every Exercise that is linked to a specific user? For instance User with id = 1?</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13177756,"title":"Find the row with the largest matching string across two columns","body":"<p>Say I have this:</p>\n\n<pre><code>page_url                      | canvas_url\n---------------------------------------------------------------\nhttp://www.google.com/        | http://www.google.com/barfoobaz\nhttp://www.google.com/foo/bar | http://www.google.com/foo\n</code></pre>\n\n<p>I'd like to find the row that is the start of my string ordered by the longest match. The problem I'm facing is finding the longest matching string, rather than just the row that matches that also has a matching one. I.e.</p>\n\n<p><a href=\"http://www.google.com/foo\" rel=\"nofollow\">http://www.google.com/foo</a> matches <code>page_url</code> in row 1 and <code>canvas_url</code> in row 2, but if it's length of both columns rather than a match it would think row 1 is the better match as <code>canvas_url</code> in row 1 is longer.</p>\n\n<p>I could grab all matches and then filter the length in code doing something like:</p>\n\n<pre><code>SELECT *, LENGTH(canvas_url), LENGTH(page_url)\nFROM app \nWHERE\n    'http://www.google.com/foo' LIKE CONCAT(canvas_url, '%') OR\n    'http://www.google.com/foo' LIKE CONCAT(page_url, '%')\n</code></pre>\n\n<p>Or perform 2 subselections grabbing the top matches of <code>canvas_url</code> respective <code>page_url</code> and then filter that to 1 in code, but I would prefer (barring any ridiculous performance issues) having the database just return what I need.</p>\n\n<p>My immediate concern is MySQL but I need to target SQLite and Postgress, so I'd be happy with an answer in either of those.</p>\n\n<p>Suggestions?</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13180770,"title":"How to sum to achieve total in sql","body":"<p>I have a list of sales id followed by their total sales and buys. I want to now sum total sales and buys. I have attempted to insert sum totalbuy and totalsell as total. But this has not worked. </p>\n\n<pre><code>select sales_id, \n   SUM(CASE WHEN side= 'buy' THEN 1 ELSE 0 END) AS totalbuy, \n   SUM(CASE WHEN side= 'sell' THEN 1 ELSE 0 END) AS totalsell \nfrom car_orders \nwhere sales_id like '%%' \nGROUP BY sales_id\n</code></pre>\n"},{"tags":["sql","join","multiple-tables","hierarchical","libreoffice-base"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13176776,"title":"Semi-hierarchical SQL query with multiple tables and possible outer joins","body":"<p>I have products. Each product is made up of items and assemblies. Assemblies themselves can be made up of items too. So it's a hierarchy but limited in depth. What I would like to do is list products with the items and assemblies it contains, plus any items in the product's assemblies.</p>\n\n<p>This is the output I would like to see. It doesn't have to look exactly like this, but the aim is to show the items in the product, then the assemblies and within each assembly the items with in it. The number of columns isn't fixed, if more are necessary to show the items in the assemblies there is no problem with that.</p>\n\n<pre><code>ProductID ProductName AssemblyID AssemblyName ItemID ItemName\n--------- ----------- ---------- ------------ ------ --------\n P0001001 Product One\n                                               I0045 Item A\n                                               I0082 Item B\n                          A00023 Assembly 1\n                                               I0320 Item 1\n                                               I0900 Item 2\n                          A00024 Assembly 2\n                                               I0877 Item 3\n                                               I0900 Item 2\n                                               I0042 Item 4\n</code></pre>\n\n<p>This I can then use to build a report grouped on the Product ID to list the contents of each product.</p>\n\n<p>This is the table structure I have at the moment.</p>\n\n<pre><code>+ProductList-+             +ProductItems-+                                  \n|ProductID   | ----------&gt; |ProductID    |                                   +ItemList-+\n|ProductName | \\           |ItemID       | --------------------------------&gt; |ItemID   |\n|Price       |  \\          +-------------+                                 &gt; |ItemName |\n+------------+   \\                                                        /  |Cost     |\n                  \\    +ProductAssemblies-+                              /   +---------+\n                   \\-&gt; |ProductID         |       +AssemblyItems-+      /\n                   +-- |AssemblyID        | ----&gt; |AssemblyID    |     /\n                   |   |BuildTime         |       |ItemID        | ---/\n                   |   +------------------+       +--------------+\n                   |\n                   |   +AssemblyList-+\n                   +-&gt; |AssemblyID   |\n                       |AssemblyName |\n                       +-------------+\n</code></pre>\n\n<p>What kind of SELECT statement would I need to do this.</p>\n\n<p>I think I need some sort of outer join but I'm not totally up on SQL syntax to know how to structure the select statement. All my efforts have always led to the product being listed multiple times for each item and assembly. So if a product has 3 items and 2 assemblies, the product appears with 6 times.</p>\n\n<p>Searching for this kind of problem is not easy as I don't know what I need to search on. Is it a three table problem, an outer join issue, or just a simple syntactical answer.</p>\n\n<p>Or would it be better to switch to a pure hierarchical table structure without the use of assemblies? It would then be easier to search on hierarchical tables to solve any problems I might have.</p>\n\n<p>I'm using LibreOffice 3.5.6.2 Base. It has wizards and other helpful things but they don't extend to the complexity of the situation that I find myself in. The aim is that the database contains prices and it can be used to properly price out the products from the cost of the items and time to build the assemblies.</p>\n\n<p>Be gentle, I'm a newbie to SO.</p>\n"},{"tags":["php","sql","database","cpanel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13180534,"title":"php script connecting to my SQL database","body":"<p>When trying to connect to my database using PHP I am getting an error.</p>\n\n<pre><code>$connect = mysql_connect(\"localhost\",\"username\",\"password\") or die (\"Couldn't Connect!\");\nmysql_select_db(\"databasename\") or die (\"Couldnt find database\");\n</code></pre>\n\n<p>When I try running the script it keeps saying <code>'Couldnt find database'</code> which means that I am connecting to the server but my database won't connect.</p>\n\n<p>Am I doing something wrong here? I have pretty much copied and pasted my database name from Cpanel so I know there aren't any mistakes. But in Cpanel it is displayed as 'mywebsite'_database </p>\n\n<p>Any ideas?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":237,"score":5,"question_id":12867597,"title":"SQL Server insert statement runs successfully but values are not added to table even though row is created","body":"<p>I have an insert statement as below. I am able to debug my stored procedure and step through my code to verify that my code runs, but a funny thing happens. </p>\n\n<p>The values that I expect to be saved in the database are not saved. Instead a row is created in the table and the <code>RecordCreatedField</code> is correctly created, even a primary key is included but the actual columns I expect to be inserted are not. All the columns are <code>nvarchar/varchar</code>, except for the date columns and the ID, but only those columns are populated.  However the following <strong>@PRCUPC ,@PRCEAN ,@PRCGTIN,@PRCatalogNumber</strong> are somehow omitted. </p>\n\n<pre><code>EXEC spinsertprodcode \n                  @pid out, \n                  @ProdID, \n                  @UPC, \n                  @EAN, \n                  @TIN, \n                  @CNumber, \n                  0, \n                  0, \n                  1, \n                  @staid, \n                  @counter out\n\n\n\nINSERT INTO dbo.ProdCodes\n(PRProductID\n,PRCUPC\n,PRCEAN\n,PRCGTIN\n,PRCatalogNumber\n,PRIsReplacement \n,PRIsReplaced \n,PRCRecordCreatedDate \n,PRCIsActive\n,PRStatusFlag)\n\nOUTPUT INSERTED.PRCID INTO @opID\n\nVALUES\n(@PRProductID, \n@PRCUPC, \n@PRCEAN, \n@PRCGTIN, \n@PRCatalogNumber,\n@PRIsReplacement ,\n@PRIsReplaced,\nGETDATE(), \n@PRCIsActive, \n@PRStatusFlag)\n\nSELECT @PRCID = O.ID FROm @opID O\n</code></pre>\n\n<p>Would appreciate any suggestion on how I can fix this  or understand what is going on. </p>\n\n<p><img src=\"http://i.stack.imgur.com/9cJ6p.png\" alt=\"Image of the Debug Screen where I confirm the right values are passed\"></p>\n\n<p>Here is an SQl fiddle of the main Stored proc that calls my insert code. \n<a href=\"http://sqlfiddle.com/#!6/d41d8/9\" rel=\"nofollow\"><strong>SQL Fiddle of my code</strong> </a></p>\n"},{"tags":["php","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13180326,"title":"Basic SQL Update query in PHP","body":"<p>I am using a MVC framework and have a problem in a SQL query.</p>\n\n<p>The user that publish a post on my website receives an email containing a confirmation URL : </p>\n\n<pre><code>mywebsite.com/confirm/f9b83b3bf994e5db3b06ya20eb306a24/\n</code></pre>\n\n<p>The routing is made correctly, but I would like to change the SQL \"published\" field to 1 (it is set to 0 by default)</p>\n\n<p>So basically, everything is working except my UPDATE SQL query, it's probably something stupid but I am a beginner in this domain and I couldn't fix it after many tries.</p>\n\n<pre><code>    if(substr(ROUTE, 0, 8) == 'confirm/')\n        {\n            if(strlen($code = substr(ROUTE, 8, 32)) == 32)\n            {\n                if($row = db::fetch(db::query('SELECT `id` FROM `'.DB_PREFIX.'Posts` WHERE `published`=0 AND `confirm`=\"'.db::escape($code).'\"'), 'row'))\n                {\n\n//This is the problematic line\n                 db::query('UPDATE '.DB_PREFIX.'Posts SET published=1 WHERE published=0 AND confirm=\"'.db::escape($code).'\"');\n\n                }\n            }\n\n            header('Location: '.WEB.'publish_success.html');\n        } \n</code></pre>\n\n<p>Thank youf or your help :)</p>\n\n<p>Edit : Problem fixed adding the WHERE clause !</p>\n"},{"tags":["sql","database","vba","ms-access","linked-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13177754,"title":"Refresh table link in Access with VBA","body":"<p>I found the following function while browsing the Web that allows me to dynamically link a table to my Access database at the execution:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function createAttached(strTable As String, strPath As String, strBaseTable As String) As Boolean\n\n'************************************************************************************\n'* Create an attached table in the current database from a table in a different MDB file.\n'* In:                                                                              *\n'*   strTable - name of linked table to create                                      *\n'*   strPath - path and name of MDB file containing the table                       *\n'*   strBaseTable - name of table in strPath MDB                                    *\n'* Out:                                                                             *\n'*   Return value: True/False, indicating success                                   *\n'* Modifies:                                                                        *\n'*   Nothing, but adds a new table.                                                 *\n'************************************************************************************\n\nOn Error GoTo CreateAttachedError\n\nDim tdf As TableDef\nDim strConnect As String\nDim fRetval As Boolean\nDim myDB As Database\n\n    DoCmd.SetWarnings False\n    Set myDB = CurrentDb\n    Set tdf = myDB.CreateTableDef(strTable)\n\n    With tdf\n        .Connect = \";DATABASE=\" &amp; strPath\n        .SourceTableName = strBaseTable\n    End With\n\n    myDB.TableDefs.Append tdf\n\n    fRetval = True\n\n    DoCmd.SetWarnings True\n\nCreateAttachedExit:\n    createAttached = fRetval\n    Exit Function\n\nCreateAttachedError:\n    If Err = 3110 Then\n        Resume CreateAttachedExit\n    Else\n        If Err = 3011 Then\n            Resume Next\n        End If\n    End If\n\nEnd Function\n</code></pre>\n\n<p>This script works, however, if the table is already linked, it just does nothing (but an error event is still triggerered). I would like the same script to delete the linked table if it exists, or at least refresh that link so that the path is the right one. I have no idea of how to do this, it's probably quite simple but I don't know where to start.</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","sql","database","database-design"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13178203,"title":"Database Design For Recording Test Results","body":"<p>I work at a manufacturing plant where we assembly 10 different products. Each product is similar in function but requires different parameters to be tested. Originally I created an Access database to store our test results for each unit we build. I laid out the database by having one table for each product. This table stores the production ID along with the test parameters (pressures, temperatures, pass/fail information.. etc.) I feel like this was a poor way to approach this but it seemed to be the only way I could use access's bound forms for easy data entry. My problem is that now whenever I need to add a new test parameter I have to change the table design as well as the forms.</p>\n\n<p>Soon I will have the ability to recreate this system in mySQL and I'm hoping there is a better way to approach storing these tests results. Any insight would be very useful.   </p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":100,"score":0,"question_id":13172879,"title":"Object reference not set to an instance of an object. Reading Excel","body":"<p>I am importing excel sheet into sql server database the excelsheet contains 3 columns id|data|passport I am using SqlBulkCopy</p>\n\n<pre><code>{\n    SqlConnection con = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings[\"constr\"].ConnectionString);\n\nstring[] filePaths = null;\nstring strFileType = null;\nstring strFileName = null;\nstring strNewPath = null;\nint fileSize;\nint flag=0;\n\nprotected void Page_Load(object sender, EventArgs e)\n{\n\n}\n\n\n\nprotected void Button1_Click1(object sender, EventArgs e)\n{\n    strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();\n    strFileName = FileUpload1.PostedFile.FileName.ToString();\n    FileUpload1.SaveAs(Server.MapPath(\"~/Import/\" + strFileName + strFileType));\n    strNewPath = Server.MapPath(\"~/Import/\" + strFileName + strFileType);\n    fileSize = FileUpload1.PostedFile.ContentLength / 1024;\n\n    //EXCEL DETAILS TABLE\n    con.Open();\n    //=========================================\n    DataTable dt8 = new DataTable();\n    SqlCommand cmd8 = new SqlCommand(\"insert into exceldetails (name,type,details,size)\" + \"values(@name,@type,@details,@size)\", con);\n    cmd8.Parameters.Add(\"@name\", SqlDbType.VarChar).Value = strFileName;\n    cmd8.Parameters.Add(\"@type\", SqlDbType.VarChar).Value = strFileType;\n    cmd8.Parameters.Add(\"@details\", SqlDbType.VarChar).Value = DateTime.Now;\n    cmd8.Parameters.Add(\"@size\", SqlDbType.Int).Value = fileSize;\n    cmd8.ExecuteNonQuery();\n    con.Close();\n    try\n    {\n        SqlDataAdapter da8 = new SqlDataAdapter(cmd8);\n        da8.Fill(dt8);\n    }\n    catch { }\n    //=========================================\n\n    //CHOOSING EXCEL CONNECTIONSTRING\n\n    string excelConnectionString = \"\";\n    switch (strFileType)\n    {\n        case \".xls\":\n\n            excelConnectionString = String.Format(@\"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=\" + strNewPath + \"; Extended Properties=Excel 8.0;\");\n            break;\n        case \".xlsx\":\n            {\n                excelConnectionString = String.Format(@\"Provider=Microsoft.ACE.OLEDB.12.0;\" + \"Data Source=\" + strNewPath + \"; Extended Properties=Excel 12.0 Xml;\");\n\n                break;\n            }\n    }\n\n    //===================================\n    //PRE EXCEL COUNT\n\n    // Create Connection to Excel Workbook\n    using (OleDbConnection connection = new OleDbConnection(excelConnectionString))\n    {\n        connection.Open();\n        OleDbCommand command = new OleDbCommand(\"Select ID,Data,passport FROM [Sheet1$]\", connection);\n        OleDbCommand command1 = new OleDbCommand(\"select count(*) from [Sheet1$]\", connection);\n\n        //Sql Server Table DataTable\n        DataTable dt4 = new DataTable();\n        SqlCommand cmd4 = new SqlCommand(\"select * from excelsheet\", con);\n        try\n        {\n            SqlDataAdapter da4 = new SqlDataAdapter(cmd4);\n            da4.Fill(dt4);//sql table datatable\n        }\n        catch { }\n\n        //===============================\n\n        //excelsheet datatable\n        DataTable oltlb = new DataTable();\n        OleDbCommand olcmd = new OleDbCommand(\"select * from [Sheet1$]\", connection);\n        try\n        {\n            OleDbDataAdapter olda = new OleDbDataAdapter(olcmd);\n            olda.Fill(oltlb); //excel table datatable\n        }\n        catch { }\n\n        //==============================\n\n\n        using (DbDataReader dr = command.ExecuteReader())\n        {\n            // SQL Server Connection String\n            string sqlConnectionString = \"Data Source=DITSEC3;Initial Catalog=test;Integrated Security=True\";\n\n            con.Open();\n            DataTable dt7 = new DataTable();\n            dt7.Load(dr);\n            DataRow[] ExcelRows = new DataRow[dt7.Rows.Count];\n            DataColumn[] ExcelColumn = new DataColumn[dt7.Columns.Count];\n\n            //=================================================\n            for (int i1 = 0; i1 &lt; ExcelRows.Length; i1++)\n            {\n\n                if(string.IsNullOrEmpty(ExcelRows[i1][\"passport\"].ToString()))\n                {\n                    ExcelRows[i1][\"passport\"]=\"0\";\n\n                }\n\n                string a = Convert.ToString(ExcelRows[i1][\"passport\"]);\n                char a1 = a[0];\n\n                if (a1 &gt;= 'A' || a1 &lt;= 'Z')\n                {\n                    Label12.Text = \"CAPITAL\";\n                    break;\n                }\n                else\n                {\n                    Label12.Text = \"notgood\";\n\n\n                    flag = flag + 1;\n\n                }\n\n            }\n            //=========================================================\n\n            if (flag == 0)\n            {\n                using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n                {\n                    bulkCopy.DestinationTableName = \"ExcelTable\";\n                    dt7.Rows.CopyTo(ExcelRows, 0);\n\n                    //==========================================================================================\n                    for (int i = 0; i &lt; ExcelRows.Length; i++)\n                    {\n                        if (ExcelRows[i][\"passport\"] == DBNull.Value)\n                        {\n                            ExcelRows[i][\"passport\"] = 0;\n                        }\n\n                    }\n                    bulkCopy.WriteToServer(ExcelRows);\n                    //==========================================================================================\n                    for (int i = 0; i &lt; ExcelRows.Length; i++)\n                    {\n                        if (ExcelRows[i][\"data\"] == DBNull.Value)\n                        {\n                            // Include any actions to perform if there is no date\n                            //ExcelRows[i][\"data\"] = Convert.ToDateTime(\"0\");\n                        }\n                        else\n                        {\n                            DateTime oldDate = Convert.ToDateTime(ExcelRows[i][\"data\"]).Date;\n                            DateTime newDate = Convert.ToDateTime(oldDate).Date;\n                            ExcelRows[i][\"data\"] = newDate.ToString(\"yyyy/MM/dd\");\n                        }\n\n                    }\n\n                    //==========================================================================================\n                }\n                //======\n\n            }\n            else\n            {\n                Label13.Text = \"Wrong Format\";\n            }\n        }\n\n    }\n}\n}\n</code></pre>\n\n<blockquote>\n  <p>ERROR AT : string a = ExcelRows[i1][\"passport\"].ToString();\n  ERROR: Object reference not set to an instance of an object.</p>\n</blockquote>\n\n<p>also notice that when i run this after removing passport comparison the first row goes null in the database.</p>\n"},{"tags":["sql","oracle","group-by","left-join","decode"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13144605,"title":"using decode in query multiple results?","body":"<pre><code>SELECT PE.PHYS_RESR_ID,PE.EQMT_INIT,  PE.EQMT_NBR,\ndecode (EEU.dimn_type , 'EXTHGT', EEU.dimn_valu) as EXTHGT, \ndecode(EEU.dimn_type, 'EXTHGT', EEU.uom_code) as UNIT_EXTHGT,\ndecode (EEU.dimn_type , 'INHGT', EEU.dimn_valu) as INHGT, \ndecode(EEU.dimn_type, 'INHGT', EEU.uom_code) as UNIT_INHGT,\ndecode (EEU.dimn_type , 'INWDTH', EEU.dimn_valu) as INWDTH, \ndecode(EEU.dimn_type, 'INWDTH', EEU.uom_code) as UNIT_INWDTH\n\nFROM EQU_EQMT PE\n  left join EQU_EQMT_DIMN EEU \n  on  EEU.PHYS_RESR_ID = PE.PHYS_RESR_ID      \nand   ( EEU.POS_DESC is null or EEU.POS_DESC ='VALU' or EEU.POS_DESC ='valu');\n</code></pre>\n\n<p>But when i run it. the query returns me a line for each decode i make. and i want a line for this id pe.phys_resr_id with the different data in the same line. Any advice ?\nI would like it to give me like this:</p>\n\n<pre><code>+-------------+-------------+---------+--------+------------+---------+------------+------------+---------------+\n| PHYS_RESR_ID| EQMT_INIT   | EQMT_NBR| EXTWD  | UNIT_EXTWD | INHGT   | UNIT_INGHT | INWDTH      | UNIT_INWDTH  | \n+-------------+-------------+---------+--------+------------+---------+------------+-------------+--------------+\n|  456        | AC          | 3       |   4    |   IN       | NULL    | NULL       | NULL        | NULL     | \n|  324        | AD          | 45      |   67   |   IN       | 56      | IN         | NULL        | NULL     |\n|  132        | B           | 65      |  54    |   IN       | 78      | IN         | 34          |  IN      |    \n+----+-------------+---------+--------+--------+------------+---------+------------+-------------+--------------+\n</code></pre>\n"},{"tags":["javascript","sql","mysqli","adodb"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13180347,"title":"Conditional SQL Formatting","body":"<p>I was wondering if it was possible and surely it must be. I'd like to basically create a dymanic SQL statement conditionally based on user input from (well for this example, we'll use 3 textbox inputs):</p>\n\n<pre><code>var firstname = document.getElementById('firstname').value\nvar middle = document.getElementById('middle').value\nvar lastname = document.getElementById('lastname').value\nvar SQL\n</code></pre>\n\n<p>(if all 3 fields are filled out...)</p>\n\n<pre><code>SQL = \"SELECT * FROM TABLE WHERE [Firstname] = '\" + firstname + \"' AND [Middle] = '\" + middle + \"' AND [Lastname] = '\" + lastname + \"'\"\n</code></pre>\n\n<p>(if 2 of the 3 fields are filled out...)</p>\n\n<pre><code>SQL = \"SELECT * FROM TABLE WHERE [Firstname] = '\" + firstname + \"' AND [Lastname] = '\" + lastname + \"'\"\n</code></pre>\n\n<p>Is there a better way to be doing this? Something shorter? or will I have to evaluate text in each field and then define the SQL?</p>\n\n<p>Just was wondering, but it never hurts to ask.</p>\n\n<p>Jay</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13180231,"title":"Migrating DB from SQL 2005 Enterprise to SQL 2008 Standard","body":"<p>I'm attemtping to migrate a DB from SQL 2005 Enterprise to SQL 2008 Standard.  I've run into an issue because there is a Partition Function defined in the DB of the Enterprise edition.  I know Standard edtiions do not support Partition Functions. Upgrading the version of SQL im migrating to Enterprise isn't an option.</p>\n\n<p>I'm looking for a way to remove the partition function without causing any negative effects to the DB currently so I can migrate it to the 2008 Standard Edition.</p>\n\n<p>Any help would be greatly appreciated. Thanks!</p>\n\n<p>MOVED to dba.stackexchange.com. </p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13178569,"title":"ms sql casting error","body":"<p>My question is regarding my <a href=\"http://stackoverflow.com/questions/13176788/ms-sql-2005-cant-compare-dates\">previous</a> topic.</p>\n\n<p>The problem I have is that when the date wich have to be casted is like: (25.09.2012) is throwing a strange <code>The conversion of a char data type to a datetime data type resulted in an out-of-range datetime value.</code>error. I lost 40 minutes trying to fix it without success.</p>\n\n<p>Here the code is:</p>\n\n<pre><code>edited\n</code></pre>\n\n<p>Is there a way to convert it? For example when I put <code>20.09.2012</code> im getting an error, but it's running with <code>10.09.2012</code> Please help me with this issue!</p>\n"},{"tags":["sql","sql-server","pivot","dynamic-sql","temp-table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13180175,"title":"Trying to put a dynamic SQL subquery result into SQL-Server 2008 temp table without pre define the temp table","body":"<p>I´m trying to get my result into a temp table but can´t get it to work.</p>\n\n<pre><code>DECLARE @query nvarchar(max)\nSET @query = N'SELECT * INTO ##TmpTbl FROM (SELECT * FROM Tbl1)'\nEXEC(@query)\n</code></pre>\n\n<p>What am i doing wrong?</p>\n\n<blockquote>\n  <p>NOTE: I can NOT pre define temp table/table variable because of the actual\n  question being run is a pivot question without pre defined columns in\n  it´s result.</p>\n</blockquote>\n"},{"tags":["sql","devexpress","xtrareport"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13180265,"title":"Devexpress drill-through report - limit the number of records displayed per case to 1","body":"<p>I am trying to make a drill through report where the user clicks on a year and then gets another screen that shows the monthly data for that year. I get an error in my code because \"EcoYear\" is not in the stored procedure that I have my master report tied to. I can add the table that has EcoYear to the stored procedure, but then I get 15 pages printed for every case. (There are 15 years for on each case)</p>\n\n<p>Here is the code that comes up with the error when I debug:</p>\n\n<pre><code>using System;\nusing System.Data;\nusing System.Drawing;\nusing System.Windows.Forms;\nusing System.Collections;\nusing System.ComponentModel;\nusing DevExpress.XtraReports.UI;\nusing System.Drawing.Printing;\n\nnamespace StdEco\n{\n    public partial class StdEcoRpt : DevExpress.XtraReports.UI.XtraReport\n    {\n        public StdEcoRpt()\n        {\n            InitializeComponent();\n        }\n\n        private void xrLabel1_BeforePrint(object sender, PrintEventArgs e)\n        {\n            ((XRLabel)sender).Tag = GetCurrentRow();\n        }\n\n        private void xrLabel1_PreviewClick(object sender, PreviewMouseEventArgs e)\n        {\n            DetailReport detailReport = new DetailReport();\n            detailReport.CaID.Value = (int)((DataRowView)e.Brick.Value).Row[\"CaseID\"];\n            detailReport.EYear.Value = (int)((DataRowView)e.Brick.Value).Row[\"EcoYear\"];\n            detailReport.ShowPreviewDialog();\n        }\n\n        private void xrLabel1_PreviewMouseMove(object sender, PreviewMouseEventArgs e)\n        {\n            Cursor.Current = Cursors.Hand;\n        }\n\n    }\n}\n</code></pre>\n\n<p>The error is : Column 'EcoYear' does not belong to table StdEcoMonthlyHeaderFooter.</p>\n\n<p>The table which I am getting EcoYear from now is StdEcoMonthlyData.</p>\n\n<p>I either need to be able to connect that code to the StdEcoMonthlyData stored procedure or somehow only print one record per case when I add the EcoYear to the StdEcoMonthlyHeaderFooter stored procedure. </p>\n\n<p>Thank you for your help.</p>\n"},{"tags":["c#","sql","regex","tsql","like"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1036,"score":2,"question_id":47052,"title":"What code would I use to convert a SQL like expression to a regex on the fly?","body":"<p>I'm looking to convert a SQL like statement on the fly to the equivalent regex i.e. </p>\n\n<p>LIKE '%this%'\nLIKE 'Sm_th'\nLIKE '[C-P]arsen'</p>\n\n<p>What's the best approach to doing this?</p>\n\n<p>P.S. I'm looking to do this on the .Net Framework (C#).</p>\n"},{"tags":["sql","sql-server","alter-table","alter-column"],"answer_count":4,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":7592,"score":7,"question_id":3186760,"title":"SQL Server - Change a Nullable column to NOT NULL with Default Value","body":"<p>I came across an old table today with a datetime column called 'Created' which allows nulls.  Now, I'd want to change this so that it is NOT NULL, and also include a constraint to add in a default value (getdate()).</p>\n\n<p>So far I've got the following script, which works fine provided that i've cleaned up all the nulls beforehand:</p>\n\n<pre><code>ALTER TABLE dbo.MyTable ALTER COLUMN Created DATETIME NOT NULL \n</code></pre>\n\n<p>Is there any way to also specify the default value as well on the ALTER statement?</p>\n"},{"tags":["sql","oracle","jdbc","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":13178181,"title":"Joining multiple tables with a single query","body":"<h2>Student</h2>\n\n<pre><code>student_id  FirstName   LastName\n---------------------------------------------------\n1           Joe         Bloggs\n2           Alan        Day\n3           David       Johnson\n</code></pre>\n\n<h2>Student_Course</h2>\n\n<pre><code>course_id   student_id  courseName\n---------------------------------------------------             \n1           1           Computer Science\n2           1           David Beckham Studies\n3           1           Geography   \n1           3           Computer Science\n3           3           Geography   \n</code></pre>\n\n<h2>Student_clubs</h2>\n\n<pre><code>club_id student_id  club_name               club_count\n---------------------------------------------------\n1       1           Footbal                     10\n2       1           Rugby                       10\n3       1           Syncronized Swimming        10\n4       3           Tennis                      15\n</code></pre>\n\n<p>In the above example, student with id = 1 takes 3 course and is part of 3 clubs.<br>\nIf i was to find out which courses a student is involved in or which club the student is part of i can do it but i will need to run two queries. Is it possible to run a single query against the \ntables listed above so that the results come out like this:</p>\n\n<h2>Output</h2>\n\n<pre><code>student_id      FirstName       Student_associated_courses          Student_associated_clubs \n---------------------------------------------------------------------------\n1               Joe             1,2,3                               Football, Rugby, Syncronized swimming\n3               David           1,3                                 Tennis\n</code></pre>\n\n<p>Is it possible to get the above output with just one query? I am using JDBC to get the data so i am trying to see if i can avoid multiple trips to get the necessary data. </p>\n"},{"tags":["sql","sql-server","query","ide","formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":207,"score":1,"question_id":11061642,"title":"SQL server 2012 SP_HELPTEXT extra lines issue","body":"<p>I am using SQL server 2012, &amp; always use <code>SP_HELPTEXT</code> to get my previously created Stored Procedures, In previous versions of SQL server there were no issues in this process but in 2012, My Stored Procedures come with extra lines, for example this is the procedure that I wrote</p>\n\n<pre><code>Create proc SP_Test\nas\nbegin\n Select * \n from table_ABC\nend\n</code></pre>\n\n<p>Now after using <code>SP_HELPTEXT</code> with this procedure (or any other procedure), I am getting this output</p>\n\n<pre><code>Create proc SP_Test\n\nas\n\nbegin\n\n Select * \n\n from table_ABC\n\nend\n</code></pre>\n\n<p>Do any one else also facing this problem or I am the only one on this planet to struggle with this issue ??\nDoes any body know how to solve this issue ??</p>\n\n<p>Configuration of my SQL server is as follows (copied from <strong>Help -> About</strong> )</p>\n\n<pre><code>Microsoft SQL Server Management Studio          11.0.2100.60\nMicrosoft Analysis Services Client Tools        11.0.2100.60\nMicrosoft Data Access Components (MDAC)         6.1.7601.17514\nMicrosoft MSXML                     3.0 6.0 \nMicrosoft Internet Explorer             9.0.8112.16421\nMicrosoft .NET Framework                4.0.30319.269\nOperating System                    6.1.7601\n</code></pre>\n\n<p>Thanx in advance.</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13179765,"title":"ASP MySQL Insertion into lowest table","body":"<p><img src=\"http://i.stack.imgur.com/pXsFQ.png\" alt=\"enter image description here\">\nI designed a table like the above.. Every category can have multiple sub-categories which can have multiple smaller sub-categories. Each sub-category can have multiple products or none at all. Each product can have multiple sub-categories or none at all.</p>\n\n<p>I hope I designed it right. Now how can I insert a product into the table?\nI assume I need to insert a product and somehow give it a subcategory_of ID, a SubCategoryID and a Category. How can I do this?</p>\n\n<p>OR do I have to create a category first then sub, then smaller sub and then product? How would I do that?</p>\n\n<p>Basically I'm confused on how I'd insert because the product can have MANY/No sub-categories and the subcategory can have MANY/No products.</p>\n\n<p>I thought of (but I know it won't work):</p>\n\n<pre><code>CREATE PROCEDURE H_Insert\n  @ID         int,\n  @Name       nchar(50)\n\n  @SubID      int,\n  @SubName    nchar(50)\n  @CatID      int,\n\n  @ProductID  int,\n  @ProdName   nchar(50),\n  @Prodprice  money,\n  @ProdDesc   nchar(1024),\n  @ProdImg    varBinary(MAX)\nAs\nINSERT INTO ?????(......)\nvalues(@........)\nGo\n</code></pre>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13174399,"title":"Coalesce vs Case","body":"<p>I have 5 fields which are bringing back a mixture of values and NULLS. For reporting purposes I need to replace any potential NULLS with a value. The database that I am interrogating is updated nightly via an SSIS package.</p>\n\n<p>Obviously I will need to alter the .dtsx file to stop NULLS being brought through each day by adding some SQL.</p>\n\n<p>My question is:</p>\n\n<p>What is the most efficient way of dealing with these NULLS in terms of performance. So far ive identified <code>COALESCE</code> and <code>CASE</code> to deal with them and im leaning towards <code>COALESCE</code> because my alternative to <code>NULL</code> is not going to change, but I would be interested to hear if and why this would be the most efficient method.</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13179326,"title":"What is the best way to create a query with a big set of data?","body":"<p>I have about 360 lines of data which I need to make into 360 query's for SQL, Is there any quick way of putting all the data into one query instead of having to put them all in separate, for example here is just 3 lines of data I have:</p>\n\n<pre><code>   1,81,32\n   1,101,82\n   1,60,65\n</code></pre>\n\n<p>I have to make this data into query's so these 3 would look like:</p>\n\n<pre><code>   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (1,81,32);\n   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (1,101,82);\n   INSERT INTO `Fixtures` (weeks, HomeID, AwayID) Values (2,60,65);\n</code></pre>\n\n<p>But I have 360 lines of this, so It will be hard to make these all into query's 1 by 1, Is there any quicker way of doing this, Like just one query to insert them all?</p>\n"},{"tags":["sql","azure","sql-azure"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13069323,"title":"Set identity off in azure sql table","body":"<p>I have a table which includes an identity column but i cant remove the identity property.</p>\n\n<p>Is there a way to disable it? Or a way to make a copy of the entire table without identity property?</p>\n"},{"tags":["sql","subquery","max"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13179025,"title":"How to speed up a \"max()-searching\" SQL Subquery","body":"<p>I have created this good but slow working SQL-Statement to search the highest price from a pricelist linked to an item from the itemlist. Known is the items itemnr:</p>\n\n<pre><code>SELECT i.ItemNr, i.ItemId, x.maxprice\n  FROM itemlist i,\n       pricelist p,\n       (SELECT MAX (p2.price) AS maxprice, p2.ItemId\n          FROM pricelist p2\n         GROUP BY p2.ItemId) x\n WHERE i.ItemNr = 4711\n   AND i.ItemId = p.ItemId\n   AND i.ItemId = x.ItemId\n   AND p.price = x.maxprice\n</code></pre>\n\n<p>The itemlist holds about 100000 items and the pricelist about 1000000 prices. This statement is realy slow. I am afraid that the db-server searches the whole pricelist for every item I search.</p>\n\n<p>I know the itemnr. But can I somehow search the correponding itemid and \"send\" this itemid to the subquery? So the subquery can find the highest price of this item quickly??? Or is there an other solution for my problem?</p>\n\n<p>Help please.</p>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13178913,"title":"how can i add primary key value which is auto incremented to another column in php?","body":"<p>I have a tree and I want to I have a table which has an id also, I want to use this id by adding to another column.</p>\n\n<p>clearly,\nI want to add id column'value to parent_root column.</p>\n\n<pre><code>   sql = \"INSERT INTO agac_menu (id,isim,aciklama,parent_id,parent_root,yetki,sira,tip,created)\n        VALUES (NULL,'\".$isim.\"','\".$aciklama.\"','\".$parent_id.\"','\".$parent_root.\"','\".$yetki.\"','\".$sira.\"','\".$tip.\"','\".date('Y-m-d H:i:s').\"')\";\n</code></pre>\n"},{"tags":["c#","sql","sql-server-2008","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13177612,"title":"Does select query change column data value if we use \"set\" in it","body":"<p>In reference to my <a href=\"http://stackoverflow.com/questions/13176567/temporary-sql-datafield/13177257#13177257\">Previous Question</a> someone said in select query if I set a column data value for a table it won't going to update columns value in my table within a stored procedure, is that's right?</p>\n"},{"tags":["sql","sql-server-2008","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13178457,"title":"How to set and return a column Value in SQL Stored Procedure within If else statement","body":"<p>In reference to my <a href=\"http://stackoverflow.com/questions/13176567/temporary-sql-datafield/13177257#13177257\">Previous Question</a> I am not sure how can I set and then return a column data value with out saving it to table.</p>\n\n<pre><code>if @datafield = 1\nset ColumnA.table2=1\nelse if @datafield = 2 AND @datafield2 = 3\nset ColumnA.table2= 0\nelse\nreturn (SELECT ColumnA.table2 FROM table1 INNER JOIN table2 on table1.id and table2.id Where @datafield3 = 0)\n</code></pre>\n\n<p>I am not sure how to return after setting values, I did tried begin and end , not working tho</p>\n"},{"tags":["sql","ruby-on-rails","database-connection"],"answer_count":3,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":118,"score":9,"question_id":12469094,"title":"How to get Rails to automatically reestablish database connections after a database downtime","body":"<p>After a database downtime, Rails will first throw this error once:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: NativeException:\n  org.postgresql.util.PSQLException: Connection refused. Check that the\n  hostname and port are correct and that the postmaster is accepting\n  TCP/IP connections.</p>\n</blockquote>\n\n<p>From then on, every database call with have the following error, even after the database is back up:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: ActiveRecord::JDBCError: This\n  connection has been closed.</p>\n</blockquote>\n\n<p>To get the server running again, I have to restart the rails server.  This is not ideal for us, as our prod engineers would like to do maintenance on our databases without having to also bring back up all the services that depend on the database.  So, I'm wondering - is there a way to automatically get Rails to try to reestablish the database connection or a recommended way to get this behavior?</p>\n\n<p>Things I have tried:</p>\n\n<p>I have already tried setting reconnect to true in my database options, and with that, I can kill individual database connections, and rails will reestablish the connections.  However, it will not after a database outage.  I found that from a command console I could get the connection back up by calling </p>\n\n<blockquote>\n  <p>ActiveRecord::Base::establish_connection</p>\n</blockquote>\n\n<p>So maybe finding a clean place for rails to call the above command this would work?  Any suggestions?</p>\n"},{"tags":["javascript","html","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13178580,"title":"Dynamic HTML from SQL","body":"<p>I am running a query and storing it as a Javascript string that is building dynamic HTML.  How would I insert something into the database that would create a line break that the JS string would read?</p>\n\n<p>Here is how the string is being built:</p>\n\n<pre><code>final_string = '&lt;br/&gt;&lt;b&gt;' + infoarray[b][3] + '&amp;nbsp;' + convertDate(infoarray[b][1]) + '&lt;/b&gt;&lt;br/&gt;' + infoarray[b][0] + '&lt;br/&gt;';\n</code></pre>\n\n<p>The 2d infoarray is data that is being pulled from the database.  In the above example, <code>infoarray[b][3]</code> is:</p>\n\n<ol>\n<li>Call 1-877-968-7762 to initiate your retirement.</li>\n<li>Make Pension election/return form. </li>\n<li>Review Savings/401(k) Options.</li>\n<li>View Medical Options. 5) Review/Confirm beneficiaries.</li>\n</ol>\n\n<p>I want to have a line break before each number and I can't figure out how to do this.  Does anyone know how?</p>\n"},{"tags":["sql","oracle","join","pivot"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":79,"score":-2,"question_id":13160047,"title":"SQL statement to join and give result in multiple columns","body":"<p>Can anyone help me with an sql statement to produce te following result?</p>\n\n<pre><code>Table Person\nPerson_ID  Name\n1          John\n2          Paul\n\nTable Declaration\nDecl_ID             Person_ID   Amount\n1                   1               10\n2                   2               12\n3                   1               99\n4                   1               24\n</code></pre>\n\n<p>Result of the SQL statment should look like this:</p>\n\n<pre><code>Name    Amount1 Amount2 Amount3\nJohn    10      99      24\nPaul    12\n</code></pre>\n"},{"tags":["c#","asp.net",".net","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13156024,"title":"Implementing a parent children object in .Net, SQL server","body":"<p>I have developed a web application with a timesheet object. The object has as property a List. In SQL Server this is reflected in 2 tables, Timesheets and TimesheetEntries, with TimesheetEntries having a foreign key pointing to the PK (Id autonumber) of the Timesheets table.\nCurrently the timesheet object is displayed on a grid where the user makes inserts and amendments to the entries and finally saves it. </p>\n\n<p>In saving the timesheet, I delete all timesheet entries and then re-create them. Of course this pushes the autonumber field of the TimesheetEntries up every time the user saves the timesheet.</p>\n\n<p>Is this the best way to achieve this? Is there a better way to do this?</p>\n"},{"tags":["asp.net","sql","asp.net-mvc","tsql"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":4510,"score":4,"question_id":2851754,"title":"IDENTITY_INSERT is set to off error","body":"<p>I have a MVC web application with a table in the model that I would like to add to.  I have the primary key set along with the other data fields, but every time I try to add to the table, I get the following error:</p>\n\n<p>\"Cannot insert explicit value for identity column in table 'TABLE_NAME' when IDENTITY_INSERT is set to OFF.\"</p>\n\n<p>I'm not sure why this problem is coming up, I have the primary key set as the identity and it is also set to auto increment in the Visual Studio table designer.  Is there any way I can adjust the IDENTITY_INSERT parameter in the table designer in Visual Studio??  Or is there some other issue that might be causing this.</p>\n\n<p>UPDATE:  @Brian - As far as I can tell, I'm not setting the value explicitly, here is the code that adds to the table(s).</p>\n\n<pre><code>//Add viewer\npublic void addViewer(ModelStateDictionary modelState, Users user)\n{\n   var userToAdd = new UserRoles();\n   userToAdd.Users = user;\n\n   if (String.IsNullOrEmpty(userToAdd.Users.Username))\n   {\n      modelState.AddModelError(\"noName\", \"Please enter a username for the new Viewer\");\n   }\n\n   //See if Committee Member already exists\n   try\n   {\n      userToAdd = _db.UserRoles.First(ur =&gt; ur.Users.Username == userToAdd.Users.Username);\n      modelState.AddModelError(\"userExists\", \"A Viewer with that username already exists in the system\");\n      return;\n    }\n    catch (Exception e)\n    {\n       if (modelState.IsValid)\n       {\n          //Assign Committee Member role\n          userToAdd.Role = \"Viewer\";\n          userToAdd.Users = user;\n          //Add new Committee Member to User Roles and associated username to Users\n          _db.AddToUserRoles(userToAdd);\n          _db.SaveChanges();\n       }\n    }\n}\n</code></pre>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13172644,"title":"sql: how to unite fields into a vector in a select query?","body":"<p>What I mean is:</p>\n\n<pre><code>...\nselect...\nwhere (a=1 and b=1) or (a=1 and b=2) or (a=2 and b=3) or(a=3 and b =2)\n</code></pre>\n\n<p>can this be simplified to something like </p>\n\n<pre><code>...select...\nwhere (a,b) in ((1,1),(1,2),(2,3),(3,2))\n</code></pre>\n\n<p>the idea is not to check the fields separately, but unite them into a vector and check the vector value.</p>\n"},{"tags":["sql","entity-framework",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13167048,"title":"Why is the Audit Logout event for EF5, taking ~3 seconds for EF5?","body":"<p>I am trying to put together a prof of concept for changing our home grown ORM solution to EntityFramework 5, and the first problem I run into appears to be a serious show stopper.</p>\n\n<p>EF5 appears, our of the box, to take ~9x longer to execute a scalar sql operation than ad hock sql, BUT when I look at the sql code generated, the sql itself appears to be reasonably well written, and runs quickly.</p>\n\n<p>My C# code for both:</p>\n\n<pre><code> int surveyId = (from survey in upsEntities.Surveys where !survey.Deleted select survey.SurveyID).First();\n            Debug.WriteLine(\"Loading surveyId : {0} through Linq took {1}ms using EF5\", surveyId,\n                            sw.Elapsed.TotalMilliseconds);\n\n            sw.Restart();\n\n            string sql = \"Select top 1 surveyId from Survey where deleted = 0\";\n            object val = SMSDataManager.Instance.DataAccessManager.ExecuteScalar(sql);\n\n            Debug.WriteLine(\"Loading surveyId : {0} through AdHock SQL took {1}ms using OrmDataManager\", val,\n                           sw.Elapsed.TotalMilliseconds);\n</code></pre>\n\n<p>SQL Output:\nEF5: </p>\n\n<pre><code>SELECT TOP (1) \n[Extent1].[SurveyID] AS [SurveyID]\nFROM [dbo].[Survey] AS [Extent1]\nWHERE [Extent1].[Deleted] &lt;&gt; cast(1 as bit)\n</code></pre>\n\n<p>Adhock: <code>Select top 1 surveyId from Survey where deleted = 0</code></p>\n\n<blockquote>\n  <p>Loading surveyId : 1 through Linq took <strong>2965.8625ms using EF5</strong></p>\n  \n  <p>Loading surveyId : 1 through <strong>AdHock SQL took 384.8073ms</strong></p>\n</blockquote>\n\n<p>The duration between the two, according to the profiler is 1ms for EF5, vs 0ms for ad hock. Where the problem appears to lie is in the <strong>Audit Logout</strong> event <strong>for EF5, taking ~3 seconds,</strong> where my <strong>ad hock sql is taking ~.6 seconds</strong> for the same logout event.</p>\n\n<p>What is causing this huge overhead for EF5, and what can I do to mitigate, or explain this?</p>\n"},{"tags":["java","android","sql","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":13178145,"title":"Stuck with android SQL design using SQLite and Group By","body":"<p>have the following problem:\nTrying to display a list of attendees from a table. Table A is generated by \"syncing\" the data from a web source (HTML scraping) into table A.</p>\n\n<p><strong>Table A</strong><br>\nColumns: eventID, userID, userName<br>\nData:<br>\n1, 111, Harry<br>\n2, 222, Ben<br>\n3, 534, Helen<br>\n2, 534, Helen<br>\n2, 545, James<br></p>\n\n<p><strong>End Result</strong><br>\nIm trying to get this displayed in an activity as follows:<br>\nSocial 1: Attended by: Harry<br>\nSocial 2: Attended by: Ben, Helen, James<br>\nSocial 3: Attended by: Helen<br></p>\n\n<p>How is the best way to do this?</p>\n\n<p><strong>My initial plan:</strong><br>\n1) Run a SQL select (Query1) with Group By on eventID from table A.<br>\n2) Cycle through each result from Step 1.<br>\n3) For each result result from Query 1, select all rows in tableA with the current eventID (Called Query 2)<br>\n4) Cycle through result from step 3 Query 2, and for each result, add the user's name to a string buffer. At the end of Query 2 results, insert the eventID together with the resulting StringBuffer, into a new table:<br>\n<br>\n<strong>Table B:</strong><br>\ncolumns: eventID, userName<br>\nData:<br>\n1, \"Harry\"<br>\n2, \"Ben, Helen, James\"<br>\n3, \"Helen\"<br></p>\n\n<p>Then use the data from table B, together with a SimpleCursorAdapter, to populate a standard ListActivity with the data, resulting in a list of all events, and a comma separated list of attendees. And then each time Table A is regenerated, clear the data from table B, and repopulate it.<br>\n<br>\n<strong>Question:</strong><br>\nIs this the best way/neatest to do this? I dont really like the idea of having a temporary table just to do this.<br></p>\n\n<p>Background: Im new to Android dev, and have only just taken up Java again since doing it at uni a few years ago. My strongpoint in programming lies in HTML,  PHP, MySQL.</p>\n\n<p>Extra info: The way data is collected for table A, is that a page is scraped which contains all the events for a particular user. I then aim to display this in the opposite way, by showing for each event, all the users that are attending.</p>\n\n<p>I would appreciate some help/opinions on how to accomplish this. Many thanks!</p>\n"},{"tags":["php","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13173426,"title":"How to call SQL statements from a php function","body":"<p>im trying to write a code where all sql statements are stored inside a separate php file so i can call them later as functions.</p>\n\n<p>i've tried different things but i cant seem to make it work properly </p>\n\n<p>here is my code</p>\n\n<p>(im trying to make a login page here)</p>\n\n<p>login.php</p>\n\n<pre><code>&lt;?php\n     include('sql.php');\n     $sql = new sql();\n?&gt;\n\n&lt;form class = \"form-inline\" method = \"post\" style=\"color: #FFF; position: absolute; margin-top:100px; margin-left:500px;\"&gt;\n            &lt;table width=\"100%\" border=\"0\"&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Username&lt;/td&gt;\n    &lt;td&gt;&lt;input type=\"text\" id = \"username\" name = \"username\" class=\"large\" placeholder=\"\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Password&lt;/td&gt;\n    &lt;td&gt;&lt;input type=\"password\" id = \"password\" name = \"password\" class=\"large\" placeholder=\"\"&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n&lt;br /&gt;\n&lt;center&gt;&lt;button type=\"submit\" id = \"submit\" name = \"submit\" class=\"btn btn-primary\"&gt;Log in&lt;/button&gt;&lt;/center&gt;\n&lt;/form&gt;\n&lt;?php\n//echo $sql-&gt;admin();\n?&gt;\n\n\n&lt;?php\n    if(isset($_POST['submit'])) {\n        // username and password sent from form\n        $username=$_POST['username'];\n        $password=$_POST['password'];\n\n        // To protect MySQL injection (more detail about MySQL injection)\n        $username = stripslashes($username);\n        $password = stripslashes($password);\n        $username = mysql_real_escape_string($username);\n        $password = mysql_real_escape_string($password);\n\n        //THIS IS THE PART WHERE I CALL THE SQL STATEMENT FROM A SEPARATE PHP FILE\n                            echo $sql-&gt;admin($username,$password);\n\n        // Mysql_num_row is counting table row\n        $count=mysql_num_rows($sql);\n\n        // If result matched $username and $password, table row must be 1 row               \n        if($count==1)\n        {\n            //unset($_SESSION);\n            $row = mysql_fetch_assoc($sql);\n            $_SESSION[logged] = $row[logged];\n            // Register $username, $password and redirect to file \"index.php\"\n            $_SESSION['username'] = $username;\n            $_SESSION['password'] = $password;\n            $_SESSION['submitted'] = $row[submitted];\n            $_SESSION['date_submitted'] = $row[date_submitted];\n            session_register($_SESSION['username']);\n            session_register($_SESSION['password']);\n            ?&gt;\n                                     &lt;script&gt;window.location=\"index.php\";&lt;/script&gt;\n            &lt;?php\n        }\n        else \n        { ?&gt;\n            &lt;center&gt;&lt;span style=\"color:white;\"&gt;Wrong Username or Password&lt;/span&gt;&lt;/center&gt;\n        &lt;?php\n\n        }\n    }\n?&gt;\n</code></pre>\n\n<p>sql.php</p>\n\n<pre><code>&lt;?php\n  include('connect.php');\n  class sql{\n    function sql()\n    {\n\n    }\n\n    function admin($username,$password)\n    {\n        echo $sql=mysql_query(\"SELECT * FROM admin WHERE admin_username= '$username' and admin_password= '$password' \");\n    } \n}\n?&gt;\n</code></pre>\n\n<p>the error that appears with this code is</p>\n\n<pre><code>Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource in login.php on line 40\n</code></pre>\n\n<p>my line 40 is</p>\n\n<pre><code>$count=mysql_num_rows($sql);\n</code></pre>\n\n<p>thanks in advance</p>\n\n<p>EDIT*<em>*</em>\nthanks guys ive finally got it</p>\n\n<p>as you guys said ive added a line in my sql.php which is </p>\n\n<pre><code>    return $result; \n</code></pre>\n\n<p>another reason why my code didnt work is because i didnt place my </p>\n\n<pre><code> $sql-&gt;admin($username,$password);\n</code></pre>\n\n<p>inside a variable</p>\n\n<p>now it looks like this </p>\n\n<pre><code>$a = $result-&gt;admin($username,$password);\n</code></pre>\n\n<p>thanks again for the help its working now</p>\n"},{"tags":["php","sql","sql-server-2008","database-connection","connect"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13028538,"title":"sqlsrv_connect() keep connection in application pool active","body":"<p>I have a php script that connects to a local SQL server database through sqlsrv_connect.</p>\n\n<pre><code>  $serverName = \"127.0.0.1\\MSSQLSERVER\";\n  $userName = 'username';\n  $userPassword = 'pass';\n  $dbName = \"name\";\n  $connectionInfo = array(\"database\"=&gt;$dbName,\n                              \"UID\"=&gt;$userName,\n                              \"PWD\"=&gt;$userPassword, \n                              \"MultipleActiveResultSets\"=&gt;true,\n                              \"ConnectionPooling\"=&gt;true);\n\n  sqlsrv_configure('WarningsReturnAsErrors', 0);\n\n  $this-&gt;connection = sqlsrv_connect( $serverName, $connectionInfo);\n</code></pre>\n\n<p>The first time that i load the website this code under is executing in about 1.5sec</p>\n\n<pre><code>$this-&gt;connection = sqlsrv_connect( $serverName, $connectionInfo);\n</code></pre>\n\n<p>If i reload the page the execution time for the same line is 0.0012 - 0.0020sec (much faster)</p>\n\n<p>If i wait for lets say for 10 minutes and try to reload the page again the execution time for connect is over 1sec</p>\n\n<p>Is there anything i can do to keep the connection \"active\" so to make the <code>sqlsrv_connect</code> runs faster? </p>\n\n<ol>\n<li>IIS Application pool idle shutdown is disable</li>\n<li>MSSQL Server connection timeout is 0</li>\n</ol>\n\n<p>Thanks in advance</p>\n"},{"tags":["sql","sql-server-2005","stored-procedures","dll","64bit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13178122,"title":"Run 32 bit dll in 64 bit SQL SERVER","body":"<p>I have a 32 bit dll which is called from a stored procedure. It works fine with 32 bit sql server but now when i call that procedure from 64 bit sql server 2005 developer edition it gives an exception. </p>\n\n<p><strong>How can I make a 32 bit dll to run from 64 bit sql server?</strong> </p>\n\n<p>Please note I do not have the source code for the dll, therefore recompiling won't be a option  .</p>\n"},{"tags":["mysql","sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":54,"score":4,"question_id":13177765,"title":"Regarding get automatic columns in sql`","body":"<p>I have basically 50 fields in a table and I want to select this fields from table on a regular basis.</p>\n\n<p><strong>Problem is</strong>: I have to write all this 50 fields manually.</p>\n\n<p>Is there any shortcut in intellisence or any other tool where I can get all fields. automatically by pressing tool.</p>\n\n<p>Also guys if anyone knows here extra addons on sql..then please post it here.</p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13177591,"title":"Select matching rows as columns","body":"<p>I think it would be quickest to show by example, so here goes a simplified version of my problem. I am using SQL Server.</p>\n\n<p>This is the data model</p>\n\n<pre><code>SURVEY       QUESTION        ANSWER\n------       --------        -------\nsurveyId     questionId      answerId\n             questionText    surveyId\n                             questionId\n                             answerText\n</code></pre>\n\n<p>Here's some sample data</p>\n\n<pre><code>SURVEY          QUESTION\n ----------      ------------ --------------\n| surveyId |    | questionId | questionText |\n ----------      ------------ --------------\n| 1        |    | 1          | Name         |\n| 2        |    | 2          | E-Mail       |\n ----------     | 3          | Address      |\n                | 4          | Phone        |\n                 ------------ --------------\nANSWER\n -----------------------------------------------\n| answerId | surveyId | questionId | answerText |\n -----------------------------------------------\n| 1        | 1        | 1          | John       |\n| 2        | 1        | 2          | john@aa.bb |\n| 3        | 1        | 3          | New York   |\n| 4        | 1        | 4          | 1112223344 |\n| 5        | 2        | 1          | Pete       |\n| 6        | 2        | 2          | pete@cc.dd |\n| 7        | 2        | 3          | Boston     |\n| 8        | 2        | 4          | 5556667788 |\n -----------------------------------------------\n</code></pre>\n\n<p>Finally, here's what I'd like to select</p>\n\n<pre><code>RESULT\n ------------------------------\n| surveyId | name | email      |\n ------------------------------\n| 1        | John | john@aa.bb |\n| 2        | Pete | pete@dd.cc |\n ------------------------------\n</code></pre>\n\n<p>I'd like to be able to specify at run time which columns I need in my final table. Right now I can get this result by doing the following</p>\n\n<pre><code>SELECT rName.surveyId, rName.requestor, rEmail.email \nFROM (SELECT a.answerText AS name, a.surveyId\n      FROM answer a INNER JOIN question q ON a.questionId = q.questionId \n      WHERE a.surveyId = @surveyId AND q.questionText = 'Name') AS rName\nINNER JOIN \n     (SELECT a.answerText AS name, a.surveyId\n      FROM answer a INNER JOIN question q ON a.questionId = q.questionId \n      WHERE a.surveyId = @surveyId AND q.questionText = 'E-Mail') AS rEmail\nON rName.questionnaireId = rEmail.questionnaireId\n</code></pre>\n\n<p>As you can see, it's ugly, and contains duplicate code. Is there a way to do this cleaner? </p>\n"},{"tags":["sql","database","primary-key","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":29,"score":-3,"question_id":13176434,"title":"Is inner join performed by default?","body":"<p>I wonder why it is needed to put the (primary key = foreign key) in a where statement. Tables are related to each other via such criteria. So, why everybody use that in the <em>where</em> clauses or *join*s?</p>\n\n<p>I mean instead of</p>\n\n<blockquote>\n  <p>select a.name, b.name\n  from a,b\n  where (a.fk = b.pk) AND (something = \"something\")</p>\n</blockquote>\n\n<p>if one says</p>\n\n<blockquote>\n  <p>...\n  select a.name, b.name\n  from a,b\n  where (something = \"something\") </p>\n</blockquote>\n\n<p>would it be enough?</p>\n"}]}
{"total":102599,"page":16,"pagesize":100,"questions":[{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13177901,"title":"How to find if a date is from a Odd or Even week?","body":"<p>In my table I have for each day:</p>\n\n<pre><code>Id_______Startdate _______ EndDate __________MondayMorning _____MondayEvening ___TuMorning  ....  \n121 _____2012-01-01________2012-12-31 ________2 ___________________2______________2   \n122 _____2012-02-01________2012-08-05 ________1 ___________________2______________3   \n</code></pre>\n\n<p>I already generated a list of dates using the Startdate and EndDate. </p>\n\n<p>I want to know if this dates belongs to a odd week or a even week so that I can filter days from my output that have number 3 Or 1 (see second record).</p>\n\n<p>how can I filter the days that belongs to  odd weeks and even weeks that have number 1 and 3?</p>\n"},{"tags":["php","mysql","sql","syntax-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":45,"score":-4,"question_id":13177700,"title":"Can someone correct this php code below?","body":"<p>Can somebody help me with the below code:</p>\n\n<pre><code>$which_page = \"http://mywebsite.com/official\";    \n$sql = \"SELECT views, page FROM counter WHERE page = '$which_page'\";\n$query      = @mysql_query($sql);\n$result             = @mysql_fetch_array($query);\n$result_views   = $result['views'];\n$result_page    = $result['page'];\n\nif ( $result_page == $which_page ) {\n\n$sql_update = \"UPDATE counter SET views = '$result_views + 1' WHERE page = '$which_page'\";\n\n@mysql_query($sql_update);\n\n} else {\n\n$sql_insert = \"INSERT INTO counter (views,\n                              page)\n                     VALUES ('1',\n                              '$which_page'\n                              )\";\n@mysql_query($sql_insert);\n\n}\n</code></pre>\n\n<p>I am inserting counter table with \"views\" and \"page\" row in sql for counting the page views from page.php. But its not working, can someone help me with the above code.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["mysql","sql","sql-update","row","column"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13170260,"title":"SQL: UPDATE query which doesn't affect timestamp on the row","body":"<p>I have some SQL code below which enables me to change all instances of quantities that are '0' and change them to '1' within the 'quantity' column only. It works ok but...</p>\n\n<p>What I am trying to do, however, is not affect the timestamp column (called 'entry_date') on the affected rows ie. keep the original time the entry was made. When I run this query it replaces the time the entry was originally made with the time the query below was ran. </p>\n\n<p>How do I get around this? I have basic-intermediate PHP knowledge but my SQL knowledge isn't great. Any help would be appreciated.</p>\n\n<blockquote>\n  <p>UPDATE <code>databasename</code>.<code>tablename</code> SET <code>quantity</code> = '1'<br>\n  WHERE <code>tablename</code>.<code>quantity</code> = '0';</p>\n</blockquote>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13177520,"title":"MySQL - selecting first 3rd, second 3rd, and third 3rd from multiple tables","body":"<p>Given table1, table2, and table3 (assume they are identical in structure), is it possible to select the first 1/3 records of table1, table2, and table3? Then the second 1/3? Then the last 1/3?</p>\n"},{"tags":["sql","database","uml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13125355,"title":"Realizing special case of a class in UML and SQL","body":"<p>In an application, that allows registered users to create pages which can be edited by other registered users, what is the correct way of distinguishing a normal user from the creator of the page, both in UML and SQL.</p>\n\n<p>In UML, I have</p>\n\n<pre><code>--------  accesible by --------  \n| Page |  ------------ |User  |\n--------               --------\n  |created by            / \\\n  |                       | \n  |                       |\n---------   is a          |\n|Creator|------------------\n---------\n</code></pre>\n\n<p>Now, I don't think this is the correct UML. So, what would be the correct UML representation of what I am trying to express. And eventually, I would like to create SQL database for the same. In that case, what would the Database Schema look like?</p>\n"},{"tags":["sql","table"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13177142,"title":"SQL same postal code","body":"<pre><code>select PERSON.fornavn, PERSON.efternavn, PERSON.postnr, POST.distrikt\nfrom PERSON inner join POST on POST.postnr = PERSON.postnr\ninner join MEDLEM on PERSON.personnr = MEDLEM.personnr\ninner join FORMAND on MEDLEM.personnr = FORMAND.personnr\ngroup by PERSON.fornavn, PERSON.efternavn, PERSON.postnr, POST.distrikt, FORMAND.afdnr\nhaving FORMAND.afdnr = 3\norder by PERSON.fornavn\n</code></pre>\n\n<p>I need to show the persons that live on the same postal code as the boss for department 3, but the results make no sense. </p>\n\n<p>Fornavn = First name, Formand = boss, Adresse = adress, Afdeling = Department (afdnr = department nr.), Medlem = member</p>\n\n<p>Tables: </p>\n\n<pre><code>PERSON: personnr, fornavn, adresse, postnr\nPOST: postnr, district\nFORMAND: personnr, afdnr\nMEDLEM: personnr, afdnr\nAFDELING: afdnr, afdname\n</code></pre>\n"},{"tags":["sql","tsql","sybase-ase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13176975,"title":"moving a few rows from one table to another and rest to some other","body":"<p>I have some staging table to bcp some data from a file to db.<br>\nNow from this table i want to copy some 'valid' data to another table, while all other (some invalid, some duplicate) data to another 'error' table.<br>\nCan I have someway to do this using some query/stored procedure in Sybase-ASE.<br>\n(it would be great if i can use the same thing in oracle as well)</p>\n"},{"tags":["php","sql","sql-server","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13176624,"title":"SQL Comment in CodeIgniter Active Record?","body":"<p>I'm moving a project to CodeIgniter and want to take advantage of Active Record.  However, I haven't found a way to append a SQL comment to the queries.  In the existing code the query looks something like this:</p>\n\n<pre><code>UPDATE table\nSET column = 'value'\nWHERE  ID = passed value;\n-- Transacted by ' .$_SESSION['Name']\n</code></pre>\n\n<p>I've search Google and SO and not found the answer to how to add that last \"Transacted by\" comment without coding the whole thing directly and using <code>$this-&gt;db-&gt;query('.....')</code></p>\n"},{"tags":["sql","database","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":13173171,"title":"SQL Server + Composite key or Unique Id","body":"<p>I am fairly new to database design, for many to many relationship, what is the differences and implications of creating a composite key and a unique id for e.g.</p>\n\n<p><code>Country</code> table</p>\n\n<pre><code>CountryID\nCountryName\n</code></pre>\n\n<p><code>Language</code> table</p>\n\n<pre><code>LanguageID\nLangugageName\n</code></pre>\n\n<p>Many to Many table - using composite:</p>\n\n<pre><code>CountryID  Pkey\nLanguageID Pkey\n</code></pre>\n\n<p>OR</p>\n\n<p>Using unique Id:</p>\n\n<pre><code>AutoID Pkey\nCountryID \nLanguageID \n</code></pre>\n"},{"tags":["sql","mysql-error-1146"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":43,"score":1,"question_id":13176935,"title":"What is wrong here? Sql query give me an error 1146","body":"<p>I am trying to use all columns for each row from one table (party), and some columns from another (customer).</p>\n\n<p>Ok, here is my code</p>\n\n<pre><code>public function getParty($data = array()) {\n\n    $sql = \"SELECT party.* , customer.customer_id AS customerID, customer.firstname AS customerFN, customer.lastname AS customerLN, customer.email AS customerEMAIL, customer.ip AS cutomerIP\n    FROM `\" . DB_PREFIX . \"party` \n    JOIN `\" . DB_PREFIX . \"cutomer` \n    ON party.cutomer_id = customer.customer_id\n    WHERE status=3\";\n\n    $sort_data = array(\n\n\n        'date_added',\n        'order_id',\n        'customer_id',\n        'customerFN',\n        'customerLN',\n        'customerEMAIL',\n        'customerIP',\n        'description',\n        'status',\n        'amount'\n\n\n    );\n\n    if (isset($data['sort']) &amp;&amp; in_array($data['sort'], $sort_data)) {\n        $sql .= \" ORDER BY \" . $data['sort'];   \n    } else {\n        $sql .= \" ORDER BY date_added\"; \n    }\n\n    if (isset($data['order']) &amp;&amp; ($data['order'] == 'DESC')) {\n        $sql .= \" DESC\";\n    } else {\n        $sql .= \" ASC\";\n    }\n\n    if (isset($data['start']) || isset($data['limit'])) {\n        if ($data['start'] &lt; 0) {\n            $data['start'] = 0;\n        }           \n\n        if ($data['limit'] &lt; 1) {\n            $data['limit'] = 20;\n        }   \n\n        $sql .= \" LIMIT \" . (int)$data['start'] . \",\" . (int)$data['limit'];\n    }\n\n    $query = $this-&gt;db-&gt;query($sql);\n\n    return $query-&gt;rows;\n}\n</code></pre>\n\n<p>And here is the error</p>\n\n<pre><code>Notice: Error: Table 'XXX.cutomer' doesn't exist\nError No: 1146\nSELECT party.* , customer.customer_id AS customerID, customer.firstname AS customerFN, customer.lastname AS customerLN, customer.email AS customerEMAIL, customer.ip AS cutomerIP FROM `party` JOIN `cutomer` ON party.cutomer_id = customer.customer_id WHERE status=3 ORDER BY date_added ASC LIMIT 0,10 in /srv/www/htdocs/XXX/system/database/mysql.php on line 49\n</code></pre>\n\n<p>Maybe I am wrong somewhere, but do not see it</p>\n\n<p>Greetings\nPetar Stoyanov</p>\n"},{"tags":["sql","sql-server-2008","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13176567,"title":"Temporary SQL datafield","body":"<p>Currently I am returning a boolean value as \"1\" or \"0\" or value of a column let say column A in one of my stored procedure and it works perfectly, however in one of application I am trying to get value like this</p>\n\n<pre><code>string temp = reader.TryGetValue(\"ColumnA\", out licenseStatus) ? temp : string.Empty;\n</code></pre>\n\n<p>Stored procedure is doing something like this,</p>\n\n<pre><code>if @datafield = 1\n    return 1\nelse if @datafield = 2 AND @datafield2 = 3\n    return 0\nelse\n    return (SELECT ColumnA.table2 FROM table1 INNER JOIN table2 on table1.id and table2.id Where @datafield3 = 0)\n</code></pre>\n\n<p>Now I want to return result as value of ColumnA always instead of sending \"0\" or \"1\" as I am not allowed to make changes to code in application.</p>\n\n<p>Is it possible ? I can't make any changes to ColumnA value at all either.</p>\n\n<p><strong>EDIT</strong></p>\n\n<blockquote>\n  <p>I already mentioned in my question that stored procedure is doing what\n  its suppose to do but not working with my code, as I am returning 1 or\n  0 at some point and my code isn't getting it as columnA so its setting\n  it up empty, I want to return 0 or 1 as value of ColumnA but at same\n  time I don't want to change value of columnA in table2..</p>\n  \n  <p>:)</p>\n</blockquote>\n"},{"tags":["sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13176788,"title":"ms sql 2005 can't compare dates","body":"<p>I have a huge database in ms sql. I have a date stored into a field of type: <code>VARCHAR2</code>\nI have the code, but it can't compare dates. What I mean? There is an input with a launch date. What I need is to get the launchdate inputs where the launchdate is bigger than a date and smaller than another. The problem is that when I change the year from 2012 to 2013 there are no results. Also when I have dates with 0 (like 01.01.2012) it can't compire them.</p>\n\n<p>What I have so far is:</p>\n\n<pre><code>edited\n</code></pre>\n\n<p>Can someone help me to get the correct results?</p>\n\n<p><strong>EDIT1</strong></p>\n\n<p>The date is stored as string in this format: yyyy-mm-dd</p>\n"},{"tags":["c#","sql","sql-server-2008","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2234,"score":1,"question_id":2653883,"title":"Easy way to convert data table to hash table or sqldatareader to hashtable","body":"<p>Please tell me if there's an easy way to convert a <code>DataTable</code> to a <code>HashTable</code> or a <code>SQLDataReader</code> to a <code>HashTable</code>. I have to parse it through javascriptserializer. the code i m using, having some problem. please take a look and guide me.</p>\n\n<pre><code>try\n{\n    using (SqlConnection conn = new SqlConnection(ConnectionString))\n    {\n        using (SqlCommand cmd = new SqlCommand(query, conn))\n        {\n            conn.Open();\n            SqlDataReader dr = cmd.ExecuteReader(CommandBehavior.CloseConnection);\n            dt.Load(dr);\n        }\n    }\n\n    Hashtable sendData = new Hashtable();\n\n    foreach (DataRow drIn in dt.Rows)\n    {\n\n        sendData.Add(drIn[\"orderNumber\"].ToString(), drIn[\"customerName\"].ToString());\n\n    }\n\n    sendData.Add(\"orderNum\", order);\n    JavaScriptSerializer jss = new JavaScriptSerializer();\n    string output = jss.Serialize(sendData);\n    return output;\n}\ncatch (Exception ex)\n{\n    return ex.Message + \"-\" + ex.StackTrace;\n}\n</code></pre>\n\n<p>It's giving a correct result when queried from one table in the database but from another table it's having a problem. Is there any other way to do this? </p>\n"},{"tags":["mysql","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13174663,"title":"Get latest row for threads in QA table","body":"<p>This a simplified version of my SQL table for questions and answers, post_id is the primary key.</p>\n\n<pre><code> post_id | ref_post_id | title  | date (unix timestamp)\n   1     |     0       | Title1 |  10 \n   2     |     1       |        |  20 \n   3     |     0       | Title2 |  30 \n</code></pre>\n\n<p>When ref_post_id is 0, that means it's a question. When it is not 0 it's an answer where the number corresponds to the question's post_id. That means that the second row is an answer to the first row in my example above.</p>\n\n<p>What I want to do is to get only the last row of every question. If the question does not have any answers I want the question row, but if it has answers I want the last answer but I want to join in the title that belongs to the question row.</p>\n\n<p>I've googled and tried myself for a while now. Hopefully you understand my problem!</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13176420,"title":"SQL Select query with Group and status (SQL server 2008)","body":"<p>i have a table with the follwoing structure</p>\n\n<pre><code>id   g_id   name    status\n---------------------------------------\n1   111     item1   1\n2   111     item2   1\n3   111     item3   1\n\n6   113     item1   -1\n7   113     item2   1\n8   113     item3   1\n\n9   114     item1   1\n10  114     item2   2\n</code></pre>\n\n<p>status can contains values ,\nsuccess     : 1\nFailed      : -1\nIn progress : 2</p>\n\n<pre><code>Need the following output \nGroupID     Status\n------------------\n111         Success\n113         Failed\n114         In-Progress\n</code></pre>\n\n<p>If one in the group is -1, result should be Failed and if all is 1 then it should be Success. Also if some are 1 and rest is 2 result should be In Progress.\nWhat is the best way i can select the above results?</p>\n"},{"tags":["mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":50,"score":-4,"question_id":13175327,"title":"MySQL - querying 3 tables","body":"<p>Say I have 3 tables, each with a field <code>foo</code>. How do I get the following records:</p>\n\n<ol>\n<li>All records where the value of foo exist in all 3 tables?</li>\n<li>All records where the value of foo exist in any 2 tables?</li>\n<li>All records where the value of foo exist in 1 table only?</li>\n</ol>\n\n<p><code>foo</code> is UNIQUE.</p>\n\n<p><strong>My attempt for #1:</strong></p>\n\n<pre><code>SELECT a.foo\nFROM   a\nWHERE  a.foo IN (SELECT b.foo\n                 FROM   b\n                 WHERE  b.foo IN (SELECT c.foo\n                                  FROM   c)) \n</code></pre>\n\n<p>For #2, I think I need to do something similar to #1, but for 2 tables at a time {a,b}, {b,c}, {a,c} - and then UNION it? Not sure.</p>\n\n<p>For #3, no clue.</p>\n\n<p><strong>UPDATE: Sample Data</strong></p>\n\n<pre><code>Table1\n - foo-a\n - foo-b\n - foo-c\n\nTable2\n - foo-a\n - foo-b\n\nTable3\n - foo-a\n - foo-c\n - foo-d\n</code></pre>\n\n<p>For #1 question, there is 1 record that exist in all 3 tables: foo-a. For #2 question, there are 2 records that exist in 2 tables: foo-b (in Table1 and Table2) and foo-c (in Table1 and Table3). For #3 question, there is 1 record that exist in only 1 table: foo-d.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13176638,"title":"Order by most of items with Join","body":"<p>I've a 'items' table with the following structure:</p>\n\n<pre><code>id, person_id, active\n</code></pre>\n\n<p>and 'people' table with id and name columns.</p>\n\n<p>I want to order by most active items and join the people.name column to sql.</p>\n\n<p>I tried to do something like that, but it's not working:</p>\n\n<pre><code>SELECT people.id, COUNT(*) as items_count\nFROM items, people\nWHERE items.active = true AND people.id = items.person_id\nGROUP BY items.person_id\nORDER BY items_count DESC\n</code></pre>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13176538,"title":"Not equal to outcome of a case statement SQL","body":"<p>I have a SELECT query </p>\n\n<pre><code>SELECT bill.accountid, bill.price, bill.id, price.inclusive, price.exclusive\nfrom bill inner join price on bill.id = price.id\nwhere bill.price &lt;&gt; \nCASE bill.id WHEN 1 THEN price.Inclusive\nCASE bill.id WHEN 2 THEN price.Inclusive\nCASE bill.id WHEN 3 THEN price.exclusive\n</code></pre>\n\n<p>How can I achieve this where clause without separate functions</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13176474,"title":"SQL joining identical tables","body":"<pre><code>select\n  person.adresse,\n  person.fornavn,\n  person.postnr,\n  COUNT(PERSON.personnr)\nfrom \n  PERSON \n    inner join \n  POST\n    on POST.postnr = PERSON.postnr\n    inner join\n  PERSON as P \n    on PERSON.adresse = P.adresse\ngroup by \n  PERSON.adresse, \n  PERSON.fornavn,\n  PERSON.postnr\nhaving \n  COUNT(PERSON.personnr) &gt; 1\n</code></pre>\n\n<p>Adresse = address, fornavn = first name\nI need to show the adress, first name and postal number for persons, where more than one person lives on the same adress. I know it has something to do with joining identical tables, but i can't seem to figure out which tables it would make sense to join. </p>\n"},{"tags":["mysql","sql","query","table","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13173833,"title":"How to have many column from just one cloumn?","body":"<p>I have a table : </p>\n\n<p>IADATA</p>\n\n<pre><code>    Id     Studentid     Mon   Value  Type\n    1      ABC1           1      12     1\n    1      ABC1           1      02     2\n    1      ABC1           1      18     4\n    1      ABC1           1      09     7\n    1      ABC1           1      12     8\n    1      ABC1           1      22     10\n    1      ABC2           2      12     1\n    1      ABC2           2      02     2\n    1      ABC2           2      18     4\n    1      ABC2           2      09     7\n    1      ABC2           2      12     10\n    1      ABC2           3      05     1\n    1      ABC2           3      02     2\n    1      ABC2           3      20     4\n    1      ABC2           3      09     7\n    1      ABC2           3      12     10\n</code></pre>\n\n<p>In the above table we have two Students ABC1 and ABC2 and their data.</p>\n\n<p>Now the kind of result i want is:</p>\n\n<pre><code>   Id      Studentid      Mon     Obtained   Benefits   Max    Type\n    1        ABC1          1         12         02      18       I\n    2        ABC1          1         09         12      22       II\n    3        ABC2          2         12         02      18       I\n    4        ABC2          2         09         00      12       II\n    5        ABC2          3         05         02      20       I\n    6        ABC2          3         09         00      12       II\n</code></pre>\n\n<p>Now in the result you can see that i am placing the values according to the studentid and mon and the types in a certain order. if the type is I it should have obtained, then benefits then max and same with II. What can be the select query for it?</p>\n\n<p>The type in previous tables are linked. When it has the value 1,2,4 it should be like obtained, benefits and maximum for new type I and when 7,8,10, it should be like obtained,benefits and maximum for new type II. And when there is no column available, it should be zero. </p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13157962,"title":"Mysql auto-add prefixes to fields","body":"<p>Example table1:</p>\n\n<pre><code>id | field1 | field2\n--------------------\n</code></pre>\n\n<p>table2:</p>\n\n<pre><code>id | id1 | field1 | field2\n--------------------------\n</code></pre>\n\n<p>Is it possible to do this:</p>\n\n<pre><code>select t1.*, t2.* from table1 t1 inner join table2 t2 on t1.id = t2.id1\n</code></pre>\n\n<p>and receive this result:</p>\n\n<pre><code>t1_id | t1_fiedl1 | t1_field2 | t2_id | t2_id1 | t2_fiedl1 | t2_field2\n----------------------------------------------------------------------\n</code></pre>\n\n<p>The goal is to make mysql auto add prefixes to resulting fields, to avoid long typings, such as</p>\n\n<pre><code>select t1.id as t1_id, t1.field1 as t1_field1\n</code></pre>\n\n<p>and so on</p>\n"},{"tags":["java","sql","spring","orm","mybatis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13085631,"title":"Mybatis nested collection doesn't work correctly with column prefix","body":"<p>I need to set collection for object in another collection using mybatis mappings.</p>\n\n<p>It works for me w/o using columnPrefix, but I need it since there are a lot of repeteable columns.</p>\n\n<pre><code>     &lt;resultMap id=\"ParentMap\" type=\"org.example.mybatis.Parent\"&gt;\n        &lt;id column=\"Id\" jdbcType=\"VARCHAR\" property=\"id\" /&gt;\n        &lt;result column=\"Name\" jdbcType=\"VARCHAR\" property=\"name\" /&gt;\n        &lt;result column=\"SurName\" jdbcType=\"VARCHAR\" property=\"surName\" /&gt;\n\n        &lt;collection property=\"childs\"\n        javaType=\"ArrayList\" ofType=\"org.example.mybatis.Child\"\n        resultMap=\"ChildMap\" columnPrefix=\"c_\"/&gt;       \n    &lt;/resultMap&gt;\n\n&lt;resultMap id=\"ChildMap\" type=\"org.example.mybatis.Parent\"&gt;\n    &lt;id column=\"Id\" jdbcType=\"VARCHAR\" property=\"id\" /&gt;\n    &lt;result column=\"ParentId\" jdbcType=\"VARCHAR\" property=\"parentId\" /&gt;\n    &lt;result column=\"Name\" jdbcType=\"VARCHAR\" property=\"name\" /&gt;\n    &lt;result column=\"SurName\" jdbcType=\"VARCHAR\" property=\"surName\" /&gt;\n    &lt;result column=\"Age\" jdbcType=\"INTEGER\" property=\"age\" /&gt;\n\n    &lt;collection property=\"toys\"\n        javaType=\"ArrayList\" ofType=\"org.example.mybatis.Toy\"\n        resultMap=\"ToyMap\" columnPrefix=\"t_\"/&gt;   \n&lt;/resultMap&gt;\n\n&lt;resultMap id=\"ToyMap\" type=\"org.example.mybatis.Toy\"&gt;\n    &lt;id column=\"Id\" jdbcType=\"VARCHAR\" property=\"id\" /&gt;\n    &lt;result column=\"ChildId\" jdbcType=\"VARCHAR\" property=\"childId\" /&gt;\n    &lt;result column=\"Name\" jdbcType=\"VARCHAR\" property=\"name\" /&gt;\n    &lt;result column=\"Color\" jdbcType=\"VARCHAR\" property=\"color\" /&gt;\n&lt;/resultMap&gt;\n\n&lt;sql id=\"Parent_Column_List\"&gt;\n    p.Id, p.Name, p.SurName,\n&lt;/sql&gt;  \n\n&lt;sql id=\"Child_Column_List\"&gt;\n    c.Id as c_Id, c.ParentId as c_ParentId, c.Name as c_Name, c.SurName as c_Surname, c.Age as c_Age,\n&lt;/sql&gt;\n\n&lt;sql id=\"Toy_Column_List\"&gt;\n    t.Id as t_Id, t.Name as t_Name, t.Color as t_Color\n&lt;/sql&gt;  \n\n&lt;select id=\"getParent\" parameterType=\"java.lang.String\" resultMap=\"ParentMap\" &gt;\n    select \n    &lt;include refid=\"Parent_Column_List\"/&gt;\n    &lt;include refid=\"Child_Column_List\" /&gt;\n    &lt;include refid=\"Toy_Column_List\" /&gt;\n    from Parent p\n\n    left outer join Child c on p.Id = c.ParentId\n    left outer join Toy t on c.Id = t.ChildId\n    where p.id = #{id,jdbcType=VARCHAR}\n</code></pre>\n\n<p></p>\n\n<p>With columnPrefix all works fine, but nested toys collection is empty.\nSql query on database works correctly and all toys are joined.</p>\n\n<p>May be i missed something or this is bug with mybatis?</p>\n"},{"tags":["php","mysql","sql","query","date"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13139318,"title":"Comparing a string-date with another string-date in MySql query","body":"<p>I'm trying to get entries from MySql server where the dates are <code>&gt; date_begin and &lt; date_end</code></p>\n\n<p>My problem is that the table column \"<code>date</code>\" is set to <code>VARCHAR</code>, and the string I am comparing it is also directly from an <code>&lt;input type=\"text\"/&gt;</code></p>\n\n<p>The date format ( as string / varchar ) in the mysql table and in the textbox will be <code>DD.MM.YYYY</code></p>\n\n<p>my problem is that if i do </p>\n\n<p>( php code )</p>\n\n<pre><code> $query = \"SELECT * FROM table WHERE date&gt;='\" . $dateBegin . \"' AND date&lt;='\" . $dateEnd . \"'\";\n</code></pre>\n\n<p>the result will be completely random.</p>\n\n<p>I know why this happening so the question is: How can I compare this to get the right result ?</p>\n\n<p>thank you all who can help</p>\n\n<p><strong>UPDATE :</strong> </p>\n\n<p>Now I've tryed this solution, but it also doesn't work.</p>\n\n<pre><code>$query = \"SELECT * FROM artikel WHERE STR_TO_DATE(datum, '%d.%m.%Y')&gt;=STR_TO_DATE('\" . $_REQUEST['dateTo'] . \"', '%d.%m.%Y')\" . \"' AND STR_TO_DATE(datum, '%d.%m.%Y')&lt;=STR_TO_DATE('\" . $_REQUEST['dateTo'] . \"', '%d.%m.%Y')\";\n</code></pre>\n\n<p>the <code>$_REQUEST['dateFrom']</code> and <code>$_REQUEST['dateTo']</code> came from 2 textboxes and the input is a string like this <code>\"05.06.2005\"</code>.</p>\n\n<p>in the db-table 'artikel' (german for articles) in the column 'datum' (german for date) the values are VARCHAR's with the same format ( \"05.06.2005\" ).</p>\n"},{"tags":["sql","sql-server","tsql","variables","select"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":70,"score":-2,"question_id":13165594,"title":"In SQL Server, is there a way to get a single value from an identity column and repeatedly use it in the same scope?","body":"<p>It's kind of hard to word the question in the title.  Let's say you have a table called Users, and let's say it has an identity / primary key column called \"Id\".  Let's say you want to, in the same transaction, get what you know will only be one instance of Id that falls within a fairly specific WHERE clause or something, then recycle it repeatedly in a very lengthy SELECT statement that's executed immediately afterwards.  Can this be done in SQL Server?  Basically what I'm trying to avoid is something like the following:</p>\n\n<pre><code>Dim id As Int32 = DBA.OneTimeQuery(\"SELECT Id FROM users &lt;where clause&gt;\").Rows(0)(0)\nReturn DBA.OneTimeQuery(\"SELECT &lt;a lot of different things, involving multiple sub\n    -selects that have to pull from the variable id&gt;\")\n'DBA.OneTimeQuery returns a DataTable\n</code></pre>\n\n<p>I know I can avoid using two different connections or whatever by recycling the first where clause, but it's pretty wasteful to have even the same connection and transaction keep re-finding the same exact piece of information.</p>\n\n<p>I want to avoid having Sql Server search for that single value from the Id column more than once, and I also want to be able to put it in the same Sql transaction and connection.  How can this be done?  Thanks!</p>\n"},{"tags":["sql","jdbc","oracle10g"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13176278,"title":"Sum two different types in same column","body":"<p>Hi I have the below as sql output.</p>\n\n<pre><code>TYPE SUM(UPDATE_COUNT) \nLegis 93 \nAcds 43 \nUpdates 41 \nMultibases 345 \n</code></pre>\n\n<p>but i want updates to be displayed as Sum of updates and Multibases and here both Multibases and Updates belong to same column. It should be like the below.</p>\n\n<pre><code>Updates 386\n</code></pre>\n\n<p>the query i used for the first output is </p>\n\n<pre><code>SELECT type, SUM(Update_Count) \nFROM Scope1 \nwhere type in ('Updates','Multibases','DAIS','Acds','Legis','LegAll') and \n      (RECVD_DATE &gt;='04/02/2012' and RECVD_DATE &lt;='11/30/2012') \ngroup by type\n</code></pre>\n\n<p>please help me how do i get the second output.</p>\n"},{"tags":["sql","sql-server","like-operator"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13175861,"title":"Same LIKE condition applied to many columns","body":"<p>I have an SQL query that joins few tables and I want to filter records using same LIKE condition for many columns of result set. \nFor example, I have columns t1.Name, t1.FullName, t1.Comment, t2.Name, t3.Description, etc in my query (t1, t2 and t3 are joined tables names) and I want to check whether t1.Name or t1.FullName or t1.Comment or t2.Name or t3.Description is LIKE '%sometext%'.\nI'm just interested what SQL will be faster?</p>\n\n<pre><code>WHERE t1.FullName LIKE '%sometext%' OR t1.Comment LIKE '%sometext%' OR\n      t2.Name LIKE '%sometext%' OR t3.Description  LIKE '%sometext%'\n</code></pre>\n\n<p>or </p>\n\n<pre><code>WHERE ISNULL(t1.Name,'') + '|' + ISNULL(t1.FullName,'') + '|' + ISNULL(t1.Comment,'') + '|' + ISNULL(t2.Name,'') + '|' + ISNULL(t3.Description,'') LIKE '%sometext%'\n</code></pre>\n\n<p>Or may be there is some even faster way?\nI'm using MS SQL Server 2008 R2.</p>\n\n<p><strong>UPD:</strong> I've edited my second query to handle situations when some fields are NULL and when concatenation may contain pattern but fields separately don't.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13175703,"title":"SQL : How to Delete Rows; when defending “WHERE” from another table with Multiply Returns","body":"<h2>Query</h2>\n\n<pre><code>    DELETE FROM TEMPSchedules \n           WHERE StudentID = ( Select StudentID \n                               From Students \n                               Where Ref = 'H1007')\n</code></pre>\n\n<h2>Error Message</h2>\n\n<blockquote>\n  <p>Subquery returned more than 1 value. This is not permitted when the\n  subquery follows =, !=, &lt;, &lt;= , >, >= or when the subquery is used as\n  an expression.</p>\n</blockquote>\n\n<h2>Problem</h2>\n\n<p>Now the problem is that each “Ref Group” has more than 1 Student attached to it. So how should I deal with this.\nThanks</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":4,"view_count":46,"score":-1,"question_id":13175898,"title":"Display List of Dates from Start and End Date in SQL","body":"<p>I need display a list of dates in SQL. Already I have an input with single row for n number codes.</p>\n\n<p>Present Table Structure (dates in day/month/year format):</p>\n\n<pre><code>Code FromDate   ToDate     Total Days\n\n1    01/03/2012 04/03/2012   4\n2    01/04/2012 05/04/2012   5\n</code></pre>\n\n<p>I need output as:</p>\n\n<pre><code>Code FromDate\n\n1    01/03/2012\n1    02/03/2012\n1    03/03/2012\n1    04/03/2012\n</code></pre>\n"},{"tags":["sql","sql-server","recursion","performance"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1469,"score":1,"question_id":1224623,"title":"WITH Common Table Expression vs. CREATE VIEW performance","body":"<p>I have several queries that use a WITH clause, or Common Table Expression, with a UNION ALL statement to recur through a table with a tree like structure in SQL server as described <a href=\"http://www.webinade.com/web-development/creating-recursive-sql-calls-for-tables-with-parent-child-relationships\" rel=\"nofollow\">here</a>.  Would I see a difference in performance if I were to CREATE that same VIEW instead of including it with the WITH clause and having it generated every time I run the query?  Would it generally be considered good practice to actually CREATE the view since it is used in several queries?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13173372,"title":"How to select one record at a time without using cursor?","body":"<p>I have two tables in SQL SERVER.</p>\n\n<p>DBO.VitalPatientDetails=></p>\n\n<p>| PatientDetailsId | PatientId | PatientName | UnitName | BedName | PatientDOB | LastAlarmReceivedAt |</p>\n\n<p>DBO.VitalAlarmDetails=></p>\n\n<p>| Id | PatientDetailsId (Refers VitalPatientDetails.PatientDetailsId) | VitalGenerationTime | FileName | </p>\n\n<p>I need to retrive all fields of DBO.VitalAlarmDetails grouped by PatientDetailsId ordered by VitalGenerationTime in ascending order.\nI have written cursor for this as below and it is returning multiple result sets. I need to get it in single set without using cursor. I just want to know whether I can do this without cursor.</p>\n\n<pre><code>DECLARE @PatientDetailsId BIGINT\nDECLARE @getAlarmDetails CURSOR\n\nSET @getAlarmDetails = CURSOR FOR SELECT PatientDetailsId FROM VitalPatientDetails\n\nOPEN @getAlarmDetails\n    FETCH NEXT FROM @getAlarmDetails INTO @PatientDetailsId\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        SELECT * FROM VitalAlarmDetails\n        WHERE PatientDetailsId = @PatientDetailsId\n        ORDER BY VitalGenerationTime ASC\n\n        FETCH NEXT FROM @getAlarmDetails INTO @PatientDetailsId\n    END\nCLOSE @getAlarmDetails\nDEALLOCATE @getAlarmDetails\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["sql","reporting-services"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":687,"score":0,"question_id":4022757,"title":"dynamically adding columns into SQL Reporting services","body":"<p>The stored procedure mapped to a report query builder returns values dynamically mean to say once 8 columns and sometimes 6 columns. My question is how to name the header for the extra added columns?</p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13175550,"title":"MySQL database query returns empty result","body":"<p>I am doing a data migration and getting empty result of simple query with one join. Following is the query</p>\n\n<pre><code>Select * from users u INNER JOIN temp_users tu ON tu.uid = u.uid\n</code></pre>\n\n<p>There are hundreds of records which have same uid in both tables, but this query returns only one record.</p>\n\n<p>Following is the structure of tables</p>\n\n<pre><code>users table\nuid:  varchar(50)   utf8_general_ci         Yes     NULL \n\ntemp_users table\nuid: varchar(50)    utf8_general_ci         Yes     NULL\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":55,"score":5,"question_id":13172228,"title":"Require if in where condition SQL","body":"<p>I want to fetch the data based on the key_column in the table. I am having a procedure where i am passing the key character. If the key is 'A' only those records with key as 'A' should get selected . For any other key character other than 'A', I need all the records except the rows with the key_Column value 'A' </p>\n\n<p>sample code:</p>\n\n<pre><code>select * from tab1\nwhere \nif (@key_Char = 'A') Then key_Column=@key_Char \nELSE key_Column &lt;&gt;@key_Char \n</code></pre>\n"},{"tags":["c#","sql","entity-framework","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13175756,"title":"Set custom model Id (primary key) in MVC 4","body":"<p>I want to know if it's possible to use custom ID Integers as primary key?</p>\n\n<p>So instead of the default Ids 1,2,3,4,5,... I would like to use fixed Ids like 1422,1424,1426, ...</p>\n\n<p>I get these Ids from a feed and I will be using relationships based on those values. In my current setup, I have a general Id (auto generated) and a second FeedId column. Can't I just replace to auto-generated Id so it uses the FeedId?</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13175192,"title":"ms sql convert string to date changing the order from yyyy-mm-dd to dd.mm.yyyy","body":"<p>I have a field named <code>VALUE</code> of <code>VARCHAR2</code> type</p>\n\n<p>The string is in this format: <code>yyyy-mm-dd</code>\nIs it possible to change it to: <code>dd-mm-yyyy</code></p>\n\n<p>An then (again if possible) to convert it to date in this format?</p>\n\n<p>What I have tried is:</p>\n\n<pre><code>SELECT convert(varchar, getdate(), 110)\n</code></pre>\n\n<p>but it's only for the current time. Is there a way to do this?</p>\n\n<p>Edit:\nHere my code is:</p>\n\n<pre><code>select\np1.VALUE as Sdate\nfrom Process p \nLEFT JOIN PARAMETER p1 on p1.WP_ID=p.ID AND p1.NAME = 'Sdate'\nWHERE p.TYPE = 'Marketing' and convert(varchar, convert(date,p1.value), 103) ='22.08.2012'\n</code></pre>\n"},{"tags":["php","sql","symfony2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13175617,"title":"symfony 2 verify type of data stored in a single column","body":"<p>In my DB I have a column 'own_product' that contains 2 values ( quantity and name)</p>\n\n<p>In my Edit form I want to check if the first field (quantity) is string and positive or not.</p>\n\n<p>I added a new column 'type-prod' (int , string)</p>\n\n<p>this is my controller :</p>\n\n<pre><code>$request = $this-&gt;container-&gt;get('request');\n    if ($request-&gt;getMethod() == 'POST')\n    {\n\n    $formel = $request-&gt;query-&gt;get('edit_formal'); \n\n\n    $type_value = $formel['own_product'];\n\n\n      //case int\n      $type_int= $this -&gt;getDoctrine()\n                -&gt;getEntityManager()\n                -&gt;getRepository('DHG\\WelcomeBundle\\Entity\\type-prod')\n                -&gt;findOneBy(array('type' =&gt; 'int'));\n\n      //case string \n      $type_string = $this -&gt;getDoctrine()\n                -&gt;getEntityManager()\n                -&gt;getRepository('DHG\\WelcomeBundle\\Entity\\type-prod')\n                -&gt;findOneBy(array('type' =&gt; 'string'));\n\n      if (isset($type_value) &amp;&amp; $type_int &amp;&amp; $type_value &gt; 0 &amp;&amp; is_int($type_value))\n\n      {\n        echo 'Success';\n\n      }\nelse echo 'error' ;\n\n\n        }\n</code></pre>\n\n<p>Thank you !</p>\n"},{"tags":["sql","sql-server","sql-server-2005","command-line","installation"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3437,"score":1,"question_id":696846,"title":"sql server 2005 command line install error ADD_LOCAL property already installed","body":"<p>I have a silent installation of SQL Server 2005 that works great when installing SQL Server on a machine that does not have it already installed.  I use the following parameters when I perform the installation:</p>\n\n<pre><code>#define SQL_SILENT                    \"/passive /qb\"\n#define SQL_USERNAME                  \"username=MyUserName\"\n#define SQL_COMPANYNAME               \"companyname=MyCompanyName\"\n#define SQL_ADDLOCAL                  \"ADDLOCAL=SQL_Engine\"\n#define SQL_UPGRADE                   \"\"\n#define SQL_DISABLENETWORKPROTOCOLS   \"disablenetworkprotocols=0\"\n#define SQL_INSTANCENAME              \"instancename=MYSQLINSTANCE\"\n#define SQL_SQLAUTOSTART              \"SQLAUTOSTART=1\"\n#define SQL_SECURITYMODE              \"SECURITYMODE=SQL\"\n#define SQL_SAPWD                     \"SAPWD=StrongPassword\"\n#define SQL_SQLACCOUNT                \"SQLACCOUNT=\"\"\"\"\"\n#define SQL_SQLPASSWORD               \"SQLPASSWORD=\"\"\"\"\"\n</code></pre>\n\n<p>It installs the instance of SQL Server Express without a problem.  However, when I attempt to install SQL Server on a machine that already has another instance with components I get the following error:</p>\n\n<p>*\"A component that you have specified in the ADD_LOCAL property is already installed.  To upgrade the existing component, refer to the template.ini and set the UPGRADE property to the name of the component.\"*</p>\n\n<p>I have also tried using the UPGRADE method as per the error message </p>\n\n<pre><code>#define SQL_UPGRADE       \"UPGRADE=SQL_Engine INSTANCENAME=MYSQLINSTANCE\"\n</code></pre>\n\n<p>but get the following error:</p>\n\n<p><em>\"SQL Server Setup cannot perform the upgrade because the component is not installed on the computer.  To proceed, verify the component to be upgraded in currently installed, and that the component to be upgraded is specified in the ADDLOCAL property.\"</em></p>\n\n<p>Does anyone have any suggestions?</p>\n\n<p>Thank you</p>\n"},{"tags":["php","sql","login-script"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13175120,"title":"problems in checking login form","body":"<p>I do not know why php ignore the if statement and it does not perform the check,</p>\n\n<pre><code>    &lt;?php\n   require 'default.php';\n   if(isset($_POST['submit'])){\n      $username = $_POST['username'];\n      $password = $_POST['password'];\n      $username = stripslashes($username);\n      $password = stripslashes($password);\n      $username = mysql_real_escape_string($username);\n      $password = mysql_real_escape_string($password);\n      if (mysql_num_rows(mysql_query(\"SELECT `username` FROM `users` WHERE `username`='$username'\"))==1\n         &amp;&amp; mysql_num_rows(mysql_query(\"SELECT `password` FROM `users` WHERE `password`='$password'\"))==1){\n          echo 'you Have logged in successfully';\n         }else{\n             echo 'Incorrect username or password had been entered!';\n            }\n   }\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","sqlite"],"answer_count":3,"favorite_count":10,"up_vote_count":37,"down_vote_count":0,"view_count":35519,"score":37,"question_id":531035,"title":"How to do IF NOT EXISTS in SQLite","body":"<p>I am trying to port this line from MS SQL Server to SQLite</p>\n\n<pre><code>IF NOT EXISTS(SELECT 1 FROM EVENTTYPE WHERE EventTypeName = 'ANI Received') \n    INSERT INTO EVENTTYPE (EventTypeName) VALUES ('ANI Received');\n</code></pre>\n\n<p>It seems that SQLite does not support IF NOT EXISTS or at least I can't make it work.\nAm I missing something simple?  Is there a workaround?</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13174617,"title":"Index was outside the bounds of the array while reading from excelsheet","body":"<p>I am importing excelsheet into sqlserver database but there are three columns in excel:</p>\n\n<pre><code>id|data|passport\n</code></pre>\n\n<p>I want to make sure that all passports start with an alphabet  i am getting \nerror at:</p>\n\n<pre><code>if (a[0]&gt;= 'A' &amp;&amp; a[0] &lt;= 'Z' &amp;&amp; a[0] !='0' )\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Index was outside the bounds of the array.</p>\n</blockquote>\n\n<pre><code>          for (int i1 = 0; i1 &lt; dt7.Rows.Count; i1++)\n            {\n\n                if (dt7.Rows[i1][\"passport\"]==null)\n                {\n                    dt7.Rows[i1][\"passport\"] = 0;\n\n                }\n\n                string a = Convert.ToString(dt7.Rows[i1][\"passport\"]);\n\n                //char a1 = a[0];\n\n                if (a[0]&gt;= 'A' &amp;&amp; a[0] &lt;= 'Z' &amp;&amp; a[0] !='0' )\n                {\n                    Label12.Text = \"CAPITAL\";\n                    break;\n                }\n                else\n                {\n                    Label12.Text = \"notgood\";\n\n\n                    flag = flag + 1;\n\n                }\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":12002,"score":5,"question_id":5856073,"title":"for each in MS SQL SERVER?","body":"<p>I have two tables:</p>\n\n<p><code>Employees(EmployeeID, EmployeeName, EmployeeStatus, BasicSalary)</code> and </p>\n\n<p><code>EmployeePayroll (PayrollID, EmployeeID, VoucherNo, BasicSalary, SalaryMonth)</code></p>\n\n<p>I want to make a <code>for each</code> loop for every employee in the first table so that I can insert dummy data like <code>(0, EmployeeID,0 ,0 ,0)</code> into the second table.</p>\n\n<p>I tried to make it with a <code>for</code> loop but I could not make it, so is there a <code>for each</code> loop in MS SQL Server??</p>\n"},{"tags":["sql","sql-server","ssis","lookup","data-warehouse"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":92,"score":5,"question_id":13169613,"title":"SQL/SSIS DataWareHouse Fact table loading, best practices?","body":"<p>I am building my first datawarehouse in SQL 2008/SSIS and I am looking for some best practices around loading the fact tables.</p>\n\n<p>Currently in my DW I have about 20 Dimensions (Offices, Employees, Products, Customer, etc.) that are of Type 1 SCD. In my dw structure, there are a few things I have already applied:</p>\n\n<ul>\n<li>No Nulls (replaced with blank for text or 0 for numeric during staging)</li>\n<li>unknown key members populated in each dimension (SK ID 0)</li>\n<li>UPSERT for SCD Type 1 loading from stage to production table</li>\n<li>SELECT DISTINCT for my loading of dimensions</li>\n</ul>\n\n<p>In my Fact loading SSIS project, the current method I have for loading dimensions is having multiple lookups (20+) to each of the DIMs, then populating the FACT table with the data.</p>\n\n<p>For my lookups I set:</p>\n\n<ul>\n<li>Full Cache</li>\n<li>Ignore Failures for \"no matching entries\"</li>\n<li>Derived Transformation with \"ISNULL(surrogate_idkey) ? 0 : surrogate_idkey\" for each SK so that if lookups fail they will default to the SK ID 0 (unknown member).</li>\n<li>Some of my dimension lookups have more than one business key</li>\n</ul>\n\n<p>Is this the best approach? Pictures attached to help with my description above.</p>\n\n<p><img src=\"http://i.stack.imgur.com/6NHSQ.png\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/JWjyc.png\" alt=\"enter image description here\">\n<img src=\"http://i.stack.imgur.com/3QQ71.png\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","design-patterns","dynamic","replace"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13110543,"title":"Replace dynamic text SQL","body":"<p>Can anyone help me with a little problem I can't solve. I am trying to update a bbcode tag in php_text</p>\n\n<pre><code>Exemple [i] =&gt; [i:rlj7bc53]\nExemple [u] =&gt; [u:rlj7bc53]\nExemple [b] =&gt; [/b:rlj7bc53]\n</code></pre>\n\n<p>And also </p>\n\n<pre><code>[quote=\"Christo\"] =&gt; [quote=&amp;quot;Christo&amp;quot;:rlj7bc53]\n</code></pre>\n\n<p>for the moment i have used this request.</p>\n\n<pre><code>update phpbb_posts\n   set post_text = replace(post_text, '[/quote]' , '[/quote:rlj7bc53]')\n</code></pre>\n"},{"tags":["sql","database-design","tree"],"answer_count":6,"favorite_count":28,"up_vote_count":35,"down_vote_count":0,"view_count":16257,"score":35,"question_id":935098,"title":"Database Structure for Tree Data Structure","body":"<p>What would be the best way to implement a customizable (meaning, a tree structure with an unknown number of level) tree data structure in a database?</p>\n\n<p>I've done this once before using a table with a foreign key to itself.</p>\n\n<p>What other implementations could you see, and does this implementation make sense?</p>\n"},{"tags":["sql","mysql"],"answer_count":4,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":16373,"score":13,"question_id":658395,"title":"Find the number of columns in a table","body":"<p>It is possible to find the number of rows in a table:</p>\n\n<pre><code>select count(*) from tablename\n</code></pre>\n\n<p>Is it possible to find the number of columns in a table?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13174168,"title":"using select distinct with multiple columns but all columns musnt be distinct","body":"<p>I need all columns in a table but two columns must be distinct.\nI used this code but It check all columns, but I only need two of them will be distinct.\nHow can I satisfy this?</p>\n\n<pre><code>select distinct a.personalId, a.fileId, a.name, a.surname, a.address from my_table a\n</code></pre>\n\n<p>If I used the following code, I can not get the other columns:</p>\n\n<pre><code>select distinct a.personalId, a.fileId from my_table a\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":76,"score":0,"question_id":13174129,"title":"sum function using subquery","body":"<p>I have three tables:</p>\n\n<p><strong>Customer</strong></p>\n\n<pre><code>customer_id   first_name\n1              kapil\n2              rajesh\n</code></pre>\n\n<p><strong>Account</strong></p>\n\n<pre><code>Customer_id     Account_id\n1                   S1\n2                   s2\n</code></pre>\n\n<p><strong>Receipt</strong></p>\n\n<pre><code>Recipt_id   customer_id   Account_id   Transaction_type   Amount\nR1            1              s1         Deposit           40000\nR2            2              s2         Deposit             300\nR3            1              s1         withdrawal         2000\n</code></pre>\n\n<p>now i am putting query as follow </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select   \n    c.customer_id,c.first_name,s.current_balance,s.account_id,\n    (select sum(amount) \n    from receipt as r ,\n        saving_account as s \n    where r.transaction_type='deposit'\n        and r.account_no = s.account_id\n    ) as debit,\n    (select sum(amount) \n    from receipt as r ,\n        saving_account as s\n    where r.transaction_type='withdrawl'\n        and r.account_no = s.account_id  \n    )as credit \nfrom customer as c \nleft outer join saving_account as s \ninner join receipt as r on r.customer_id = s.customer_id \non s.customer_id = c.customer_id \ngroup by c.customer_id\n</code></pre>\n\n<p>but it is giving me debit a single value for whole row and credit tooo\ni am not understanding why it is showing like that ....</p>\n\n<p>My desired result is:</p>\n\n<pre><code>customer_id customer_name account_id debit credit balance\n1           kapil         s1         40000   2000  200\n2           rajesh        s2         300     null  500\n</code></pre>\n"},{"tags":["sql","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13174208,"title":"SQL reverse column value query","body":"<p>Need some Sql help? My Sql is not quite up to this yet.\nI have a table </p>\n\n<pre><code>ColA    ColB    ColC\nA       B       101\nB       B       102\nC       B       102\nB       A       108\n</code></pre>\n\n<p>I need to be able identify the values in ColC where the rows that have the same entry in  Col A and Col B (but reversed) i.e  where Col B = Col A.  But not like row three where Col B corresponding value  has no match or row two where Col A = Col B.</p>\n\n<p>The results set would be  </p>\n\n<pre><code>Col A      Col B     Col C\nA          B         101\nB          A         108\n</code></pre>\n"},{"tags":["sql","encryption","hash","ip-address","legal"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13173517,"title":"Legality of storing ip addresses","body":"<p>I'm starting a new project in which it will involve some sort of \"analytics\" system. For this system to work properly I need to make a count of <strong>unique visitors</strong> to site(s).</p>\n\n<p>To do this I was going to insert rows into a table and attach the visitor's ip address to it. The reason why I do this is so I <strong>group</strong> the rows by the ip address so I can count the amount of unique visitors.</p>\n\n<p>I was then going to hash these ip addresses as I only need them to <strong>compare</strong> against, <strong>not to sell</strong> or use for anything other than comparing.</p>\n\n<p>I just wanted to know the legal situation, are websites allowed to store a user's ip address. I am going to make this clear in our privacy policy, but when people are using this \"analytics\" system on their own website(s) the visitors of those websites wont be aware of this privacy policy.</p>\n\n<p>I thought as I'm hashing it and not storing the ip address, I'm storing a hashed version of it, which if I use a strong hash or a method of encryption the original ip address can't be made from the hashed/encrypted ip address.</p>\n"},{"tags":["sql","sql-server-2008","join","subquery","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13138885,"title":"sql subquery and join on one to many table","body":"<p>This one is causing me too much head scratching!  Basically, I need to show a list of locations, the current item that is stored there and the person who owns it.  I have created 4 tables and have these populated with data.</p>\n\n<p>Setup: MSSQL 2008</p>\n\n<p>What I am looking for is the \"Top(1)\" from tbl_locationHistory for the item and owner as there can only ever be one item or one owner at any one time at each location. Bear in mind that tbl_locationHistory could have multiple bits of data, I just need to pull back the latest ID for each one (e.g. the highest ownerID, the highest itemID thats currently available from the history table).</p>\n\n<h2>tbl_location</h2>\n\n<p>locID\nlocName</p>\n\n<h2>tbl_item</h2>\n\n<p>itemID\nitemName</p>\n\n<h2>tbl_owner</h2>\n\n<p>ownerID\nownerName</p>\n\n<h2>tbl_locationHistory</h2>\n\n<p>locHistID\nlocID\nitemID\nownerID\ndateModified</p>\n\n<p>I tried joining all of these tables together with joins. However I realised that wouldn't work as I wasn't pulling back the top ID for either \"owners\" or \"items\" and therefore the data being displayed would be inaccurate.  </p>\n\n<p>One things I have thought is that I should break up the history table into two parts: 1 x owner to location and 1 x item to location - however I am at my limit of SQL right now so could do with some pointers in the right direction as not sure which way to go with this.</p>\n\n<p>Therefore I would need assistance even if I have to break up the history table.</p>\n\n<p><strong>UPDATED 01/11/12</strong></p>\n\n<p>OK, I am going to paste some code in here.</p>\n\n<p>I am an old school Classic ASP coder.....havent needed to move on yet!  I am using classic asp and MSSQL to create this application. I am also using dreamweaver and therefore want the query to be placed in that so I can use the \"bindings\" function in DW CS6.</p>\n\n<p>Here was my original query:</p>\n\n<pre><code>SELECT DISTINCT p.pID, p.cliID, p.pNo, p.pName, p.dtCommissioned,     \np.description, ps.plotStatus, pt.plotType, o.oSalutation, o.oFname, o.oSname, man.manName, \nmod.model, sl.width, sl.length, sl.yr\nFROM history AS ph INNER JOIN owners AS o ON ph.ownerID   \n= o.ownerID INNER JOIN StockList AS sl ON ph.stockID = sl.stkID   \nINNER JOIN manufacturers AS man ON sl.make = man.manID \nINNER JOIN models AS mod ON sl.model = mod.cID FULL OUTER   \nJOIN plotType AS pt RIGHT OUTER JOIN                       \nplots AS p ON pt.plotTypeID = p.plotType LEFT OUTER JOIN                       \nplotStatus AS ps ON p.pStatus = ps.plotStatusID ON ph.plotID = p.pID\nWHERE (p.cliID = value)\nORDER BY p.pNo\n</code></pre>\n\n<p>Now, when I realised that I wasn't looking in the history table correctly for the highest HistoryID for the \"stockID\" and also the highest plotHistoryID for \"ownerID\" I started looking at how I could perform a \"subquery\" for each ID......this is where I have become stuck.</p>\n\n<p>I have tried  something along the lines of:</p>\n\n<pre><code>Select p.pID, p.cliID, p.pNo, p.pName, p.dtCommissioned,     \np.description, ps.plotStatus, pt.plotType, o.oSalutation, o.oFname, o.oSname, man.manName, \nmod.model, sl.width, sl.length, sl.yr\n(Select top 1 ph.plotHistoryID, ownerID\nFROM History AS ph\norder by ph.plotHistoryID desc)\nTHEN JOINING ETC\nTHEN DO ANOTHER SUBQUERY FOR THE OWNER ETC\n</code></pre>\n\n<p>However I couldn't get that to work, but I am now beyond my level of SQL in relation to Sub Queries and JOINS.</p>\n\n<p>The Output display will be:</p>\n\n<p>Plot No  |  Plot Name  |  plot type  |  Plot status  |  Current Owner  |  Current Stock</p>\n\n<p>Each of the Plot No's/Names/Type/Status will be populated with data as I need to show them. If the owner\\current stock is blank I have an IF statement saying \"no owner\" or \"no stock found\".  </p>\n\n<p>The user will then be able to then click on a \"view\" link at the end of the row and view details of the plot/location and will pass the pID to the next page via QueryString.</p>\n\n<p>Does this help?  I am getting a little desparate now! LOL</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13137967,"title":"update field with another field another table","body":"<p>I want to update a field in table1  with another field in  table2.I wrote the following query but it is not working. </p>\n\n<pre><code>UPDATE tempdata A\n  SET A.new_user_id =\n  (SELECT B.id FROM user B\n  WHERE A.usr_email = B.usr_email)\n</code></pre>\n\n<p>It is giving \"#1242 - Subquery returns more than 1 row\" error. Anybody please help me.</p>\n"},{"tags":["sql","delphi","postgresql","sql-injection","freepascal"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":121,"score":6,"question_id":13171048,"title":"Is there a library for sanitizing query parameters for PostgreSQL or SQL in general, for FreePascal and Delphi?","body":"<p>I got bitten my first sql escaping error (it was long overdue) when I tried to execute the PostgreSQL query below with a value containing an apostrophe eg. <code>O'Brien</code>, using FreePascal and Lazarus</p>\n\n<pre><code>SQL.Add(format('select * from zones where upper(zn_name) &gt;=  %s and upper(zn_name) &lt; %s order by zn_name',[sQuote(zoneMin), sQuote(zoneMax)]));\n</code></pre>\n\n<p>In the query above SQuote is a function that wraps a string in single quotes. Is there some standard library for sanitizing SQL query parameters for  Lazarus/FreePascal or Delphi for that matter?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13173615,"title":"Normalizing values in SQL query","body":"<p>I have an data table I wish to perform some numeric analysis on for that I need all the values to be in the same range. 0..1.</p>\n\n<p>I have a somewhat slow and longhanded way of accomplishing this but would like a more straigt forward performant solution to my problem</p>\n\n<p>What I need to do is:</p>\n\n<p>group by projectid\nwith in each project take the average of each of the values and divide by the largest average for the entire set.</p>\n\n<p>currently I have</p>\n\n<pre><code>select avg(foo * 1.0)/ (Select MAX(IL) FROM (select avg(foo * 1.0) as IL from table group by     \n                                             ProjectID) tbl)\nfrom table\n</code></pre>\n\n<p>so if the list is</p>\n\n<pre><code>projectid  | foo\n-----------------\n1          | 1\n1          | 2\n2          | 4\n2          | 2\n</code></pre>\n\n<p>the largest average is 3 and the result should therefor be</p>\n\n<p>0.5,1</p>\n\n<p>where the first is the average for projectId 1 divided by 3 and the second is the average for projectId 2 divided by 3</p>\n"},{"tags":["mysql","sql","database","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13173602,"title":"In SQL, how to retrieve information from relational database schema?","body":"<p>I have a relational database schema looks like:\n<img src=\"http://i.stack.imgur.com/nSLKY.png\" alt=\"enter image description here\"></p>\n\n<p>The question is to 'find details of customers who bought products in 2009 and the products were manufactured by Honeywell in 1968'.</p>\n\n<p>What I've done so far is:</p>\n\n<pre><code>SELECT * FROM Customer\nWHERE CID IN\n    (SELECT Customer_ID FROM Order\n     WHERE Purchase_Date = 2009 \n     AND EXISTS\n        (SELECT * FROM Order_Items, Product, Manufacturer\n         WHERE OID = OID AND Product_ID = PID AND MID = Manufacturer_ID AND\n         Mnufacturer_Name = \"Honeywell\" AND Manufacturerd_Date = 1968));\n</code></pre>\n\n<p>I've been studying database for only about a month, so I guess it would look so complicate to expert people here.. Did I do this correctly ? Otherwise, please give any feedback where to fix..</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","sql-server"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13169764,"title":"Trigger on Audit Table failing due to update conflict","body":"<p>I have a number of tables that get updated through my app which return a lot of data or are difficult to query for changes. To get around this problem, I have created a \"LastUpdated\" table with a single row and have a trigger on these complex tables which just sets GetDate() against the appropriate column in the LastUpdated table:</p>\n\n<pre><code>CREATE TRIGGER [dbo].[trg_ListItem_LastUpdated] ON [dbo].[tblListItem] \nFOR INSERT, UPDATE, DELETE \nAS\nUPDATE LastUpdated SET ListItems = GetDate()\nGO\n</code></pre>\n\n<p>This way, the clients only have to query this table for the last updated value and then can decided whether or not they need to refresh their data from the complex tables. The complex tables are using snapshot isolation to prevent dirty reads.</p>\n\n<p>In busy systems, around once a day we are getting errors writing or updating data in the complex tables due to update conflicts in \"LastUpdated\". Because this occurs in the statement executed by the trigger, the affected complex table fails to save data. The following error is logged:</p>\n\n<blockquote>\n  <p>Snapshot isolation transaction aborted due to update conflict. You\n  cannot use snapshot isolation to access table 'dbo.tblLastUpdated'\n  directly or indirectly in database 'devDB' to update, delete, or\n  insert the row that has been modified or deleted by another\n  transaction. Retry the transaction or change the isolation level for\n  the update/delete statement.</p>\n</blockquote>\n\n<p>What should I be doing here in the trigger to prevent this failure? Can I use some kind of query hints on the trigger to avoid this  - or can I just ignore errors in the trigger? Updating the data in LastUpdated is not critical, but saving the data correctly into the complex tables is.</p>\n\n<p>This is probably something very simple that I have overlooked or am not aware of. As always, thanks for any info.</p>\n"},{"tags":["sql","oracle","database-partitioning"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13152338,"title":"Range partition table creation with large number of paritions","body":"<p>i have to create an range partitioned table with two hundred partitions. for eg:</p>\n\n<pre><code>CREATE TABLE emp (\n     empno NUMBER(4), \n     ename VARCHAR2(30), \n     sal   NUMBER\n) \nPARTITION BY RANGE(empno) (\npartition e1 values less than (1000)     , \npartition e2 values less than (2000)     , \n...\npartition e200 values less than (MAXVALUE) \n</code></pre>\n\n<p>);</p>\n\n<p>Is there a way to specify the range interval without writing two hundred lines for just specifing the range?</p>\n"},{"tags":["c#","sql","excel","import"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1875,"score":4,"question_id":3664067,"title":"Import data from excel into multiple tables","body":"<p>I'm building an offline C# application that will import data off spread sheets and store them in a SQL Database that I have created (Inside the Project). Through some research I have been able to use some code that can import a static table, into a Database that is exactly the same layout as the columns in the worksheet</p>\n\n<p>What I\"m looking to do is have specific columns go to their correct tables based on name. This way I have the database designed correctly and not just have one giant table to store everything.</p>\n\n<p>Below is the code I'm using to import a few static fields into one table, I want to be able to split the imported data into more than one.</p>\n\n<p>What is the best way to do this?</p>\n\n<pre><code>public partial class Form1 : Form\n    {\n        string strConnection = ConfigurationManager.ConnectionStrings\n        [\"Test3.Properties.Settings.Test3ConnectionString\"].ConnectionString;\n\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n\n\n            //Create connection string to Excel work book\n            string excelConnectionString =\n            @\"Provider=Microsoft.Jet.OLEDB.4.0;\n            Data Source=C:\\Test.xls;\n            Extended Properties=\"\"Excel 8.0;HDR=YES;\"\"\";\n\n            //Create Connection to Excel work book\n            OleDbConnection excelConnection = new OleDbConnection(excelConnectionString);\n\n            //Create OleDbCommand to fetch data from Excel\n            OleDbCommand cmd = new OleDbCommand\n            (\"Select [Failure_ID], [Failure_Name], [Failure_Date], [File_Name], [Report_Name], [Report_Description], [Error] from [Failures$]\", excelConnection);\n\n            excelConnection.Open();\n            OleDbDataReader dReader;\n            dReader = cmd.ExecuteReader();\n\n            SqlBulkCopy sqlBulk = new SqlBulkCopy(strConnection);\n            sqlBulk.DestinationTableName = \"Failures\";\n            sqlBulk.WriteToServer(dReader);\n\n        }\n</code></pre>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13173585,"title":"How to check if a field is updated when inserting from table to table?","body":"<p>I have the following data inserted from TableA to TableB. I'm inserting the data from TableA to TableB using a query that automatically runs every 4 hours. The query contains a insert, update and a delete.</p>\n\n<blockquote>\n  <p>Date_<strong><em>_</em>__<em>_</em>_</strong><em>Group  <strong></em>____</strong><em>State  <strong></em>___</strong><em>BeginTime  <strong></em>___</strong><em>EndTime<br>\n  2012-11-1 <strong></em>_</strong><em>A  <strong></em>__<em>_</em>__<em>_</em>__</strong><em>1     <strong></em>__<em>_</em>____</strong><em>08:00   <strong></em>__<em>_</em>___</strong>_16:00</p>\n</blockquote>\n\n<p>The application that uses TableB can also change the field State but I need to check if this is changed by the application. There is no any attribute how I can check this.</p>\n\n<p>I tried to create a new column 'FromTableA' (bit) into TableB to hold a state that means, this data coming from TableA. But when the application changes the state, the attribute FromTableA stays TRUE so I can't check this.</p>\n\n<p>Any ideas to solve the problem, using just a query? Changes in the application are not allowed.</p>\n"},{"tags":["mysql","sql","query","count"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13173252,"title":"Count and insert comments from Xoops database","body":"<p>I am trying to convert Xoops posts to Wordpress. As part of that, I want to get comment count for a topic. Post and replies are on same \"topic_id\". How to count them and post it in to new column?</p>\n\n<p><strong>DB current status</strong></p>\n\n<pre><code>topic_id | subject             |comment_count|\n+________+_____________________+_____________+\n1    | welcome             | \n1    | Re: welcome         |\n2    | hello world         |\n2    | Re: hello world     |\n2    | Re: hello world     |\n3    | hello friends       |\n</code></pre>\n\n<p>from here I want to take the (count of topic_id - 1) as the number of replays (comment count). Guide me to query in MYSQL</p>\n\n<p>I want to place the output in the same table. (comment_count)</p>\n\n<p><strong>DB expected output</strong></p>\n\n<pre><code>   | topic_id | subject             |comment_count|\n   +________+_____________________+_____________+\n   | 1   | welcome             | 1 \n   | 1   | Re: welcome         | 1\n   | 2   | hello world         | 2\n   | 2   | Re: hello world     | 2\n   | 2   | Re: hello world     | 2\n   | 3   | hello friends       | 0\n</code></pre>\n"},{"tags":["sql","oracle","oracle11g","pivot"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13173242,"title":"Sql: How do i write a query to show the values in the table to be column names?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4841718/oracle-sql-pivot-query\">Oracle SQL pivot query</a>  </p>\n</blockquote>\n\n\n\n<p>I am using oracle 11g . I have requirement to write a sql script using the following table budget</p>\n\n<pre><code>budget_id   resource_id   expense_month   \n      1           1        apr-2012\n      2           1        mar-2012\n</code></pre>\n\n<p>and I have another table called budget line</p>\n\n<pre><code>budget_line_id  budget_id   category_id  amount\n    1             1           1           100\n    2             1           2           200\n</code></pre>\n\n<p>Now I have to combine both these table and show a result such that the when i choose a particular fiscal-year(ex:2012-2013) , category_id and a resource_id only the information about the particular resource in the fiscal_year should be shown .  Fiscal year is from April to March</p>\n\n<p>On choosing resource_id and fiscal_year\nI should show a result as this</p>\n\n<pre><code>april  may  june  july ............ march  total\n 100   100   100   100               100    1200\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>Kindly ignore my bad english</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":9,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":19041,"score":5,"question_id":358542,"title":"How to find fifth highest salary in a single query in SQL Server","body":"<p>How to find fifth highest salary in a single query in SQL Server</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13171931,"title":"family tree sql query","body":"<p>I am working on Family tree application in asp.net with sql server 2008.</p>\n\n<p>My main table is like this:-</p>\n\n<pre><code>ID int PK\nName Varchar(50)\nMotherID int\nFatherID int\n\nID  MotherID FatherID   Name\n\n1   NULL    NULL    My Grand Father\n\n2   NULL    NULL    My Grand Mother\n\n3   someid  someid  My Mother\n\n4   2   1   My Father\n\n5   3   4   Me\n\n6   someid  someid  My wife\n\n7   3   4   My Brother\n\n8   6   5   My son.\n</code></pre>\n\n<p>I am looking for output like this</p>\n\n<pre><code>ID  MotherID    FatherID    Name        Level\n\n1   someid  someid  grandfather 0\n\n\n2   someid  someid  Father      1\n\n3   someid  someid  Me      2\n\n\n4   someid  someid  Brother     2\n\n5   someid  someid  My Son      3\n</code></pre>\n\n<p>Thanks in advance.\nKashmir.</p>\n"},{"tags":["sql","excel"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":1562,"score":-3,"question_id":8814739,"title":"Importing excel data into SQL Server 2008","body":"<p>I need to import data from Excel to my database. I need to insert the data from my Excel sheet to an existing table in my database.</p>\n\n<p>I tried to import data with the help of sql wizard. Firstly I imported it into a temp table then I used an insert query to import data into my destination table. But it does not seem to have worked correctly.</p>\n\n<p>So, plz suggest me good way of importing the data. And also it would be better if you suggest some good sql script for importing.</p>\n"},{"tags":["php","sql","database","loops","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13172734,"title":"SQL Query Not Working In Loop","body":"<p>I have a script that extracts several rows of data from an external file, I then need to upload each of these rows to a database. I put a query inside my loop but it does nothing. even with error reporting turned on I get nothing. I check the database but nothing is being uploaded. </p>\n\n<p>What is the correct way to do this?\nThanks in advance!</p>\n\n<p>My Code:</p>\n\n<pre><code>$size = $_FILES['file']['size'];\n$filename = $_FILES['file']['tmp_name']; \n$max_filesize = 100000;\n  if($size &gt; $max_filesize) //check file size\n  die('File is too large');\n\nif(file_exists($filename)){\n$fp = fopen($filename, \"r\");\n$str = fread($fp, filesize($filename)); //file text stored in variable\n$br = \"\\n\";          //search for new row\n$rows = substr_count($str,$br);  //number of rows\necho \"Rows: \". $rows.\"&lt;br /&gt;\"; \n$row = explode( \"\\n\",$str);\n\n $x=0;\nwhile($x&lt;=$rows)\n  {\n  $field = $row[$x]; \n  $exp = explode(\"|\",$field); \n\n    $case_number = $exp[1];\n    $unknown1 = $exp[2];\n    $chapter = $exp[3];\n    $filed = $exp[8];\n    //tons more variables, removed for readability\n\n   $addrow = mysql_query(\"INSERT INTO records (case_number, wild1, chapter, filed) VALUES('\".$case_number.\"', '\".$unknown1.\"', '\".$chapter.\"', '\".$filed.\"')\");\n    if($addrow)  \n    {  \n    echo \"&lt;p style=\\\"font-weight:bold\\\"&gt;Row \".$x.\" uploaded&lt;/p&gt;\";   \n    }else{\ndie(mysql_error());\n}  \n\n  $x++;\n  }\nfclose($fp); \n }\n</code></pre>\n"},{"tags":["sql","perl","binary","rdbms","sqldatatypes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13161674,"title":"SQL databases: could there be something else than valid unicode strings when reading columns with text data types?","body":"<p>Edited title and added this text:</p>\n\n<p>SQL databases (except SQLite): Could there be something else than valid unicode strings when reading columns with text data types and connected to the database with the right options?\nWith SQLite it is not enough to filter out BLOB columns to avoid binary data. Now I am wondering if with other SQL databases it is enough to filter out columns with binary data-types to avoid binary data in the output.</p>\n\n<pre><code>#!/usr/bin/env perl\nuse warnings;\nuse 5.10.1;\nuse utf8;\nuse DBI;\n\nmy $binary = '1001001000101000110110100100010000010101100110101101011010100010000000001010101000111111';\n$binary = pack( 'b*', $binary );\nmy $data = [\n    [ 'abcdefghi', $binary ],\n    [ $binary, 'abcdefghi'  ],\n];\n\nmy $db = 'my_test_data_base';\nmy $table = 'TEST_TABLE';\n\n\n$dbh = DBI-&gt;connect( \"DBI:mysql:dbname=$db\", ... ) or die DBI-&gt;errstr;\n$dbh-&gt;{mysql_enable_utf8} = 1;\n$dbh-&gt;do( \"CREATE TABLE IF NOT EXISTS $table (\nText    VARCHAR(30),\nBnry    VARBINARY(30)\n)\" );\n\nmy $sth = $dbh-&gt;prepare( \"INSERT INTO $table ( Text, Bnry ) VALUES ( ?, ? )\" );\nfor my $row ( @$data ) {\n    $sth-&gt;execute( @$row );\n}\n\n$sth = $dbh-&gt;prepare( \"SELECT * FROM $table\" );\n$sth-&gt;execute();\nmy $ref = $sth-&gt;fetchall_arrayref();\nsay \"MySQL:\";\nfor my $row ( @$ref ) {\n    say '&lt;', join( '&gt;, &lt;', @$row ), '&gt;';\n}\nsay \"\";\n\n\n$dbh = DBI-&gt;connect( \"DBI:SQLite:dbname=$db\", ... ) or DBI-&gt;errstr;\n$dbh-&gt;{sqlite_unicode} = 1;\n$dbh-&gt;do( \"CREATE TABLE IF NOT EXISTS $table (\nText    TEXT,\nBnry    BLOB\n)\" );\n\n$sth = $dbh-&gt;prepare( \"INSERT INTO $table ( Text, Bnry ) VALUES ( ?, ? )\" );\nfor my $row ( @$data ) {\n    $sth-&gt;execute( @$row );\n}\n\n$sth = $dbh-&gt;prepare( \"SELECT * FROM $table\" );\n$sth-&gt;execute();\n$ref = $sth-&gt;fetchall_arrayref();\nsay \"SQLite:\";\nfor my $row ( @$ref ) {\n    say '&lt;', join( '&gt;, &lt;', @$row ), '&gt;';\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>MySQL:\n&lt;abcdefghi&gt;, &lt;I[\"�YkEU�&gt;\n&lt;I[\"&gt;, &lt;abcdefghi&gt;\n\nSQLite:\n&lt;abcdefghi&gt;, &lt;I[\"�YkEU�&gt;\n&lt;I[\"�YkEU�&gt;, &lt;abcdefghi&gt;\n</code></pre>\n\n<p>With MySQL it looks like it prints (or stores) binary data in text data-type columns until the first invalid code. Is this specific MySQL or behaves every SQL database engine other than SQLite like this?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":185,"score":2,"question_id":11225491,"title":"Select one row from multiple row in sql depands on condition","body":"<p>I have a table in sql 2008 named tblEmployeeAttendance like \n<img src=\"http://i.stack.imgur.com/cw9SU.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here is some dummy data for a employee's one days attendance like</p>\n\n<p><img src=\"http://i.stack.imgur.com/P6puo.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here AI refers AttendanceIn,AO refers AttendanceOut,BO refers BreakIn and BI refers BreakOut.There can multiple row in a day for a employee.First row should be AI,last row should be AO and others rows will be BreakIn,BreakOut Sequentially(that means BreakIn-BreakOut-BreakIn.....).</p>\n\n<p>My expected output would be like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/SfrKP.jpg\" alt=\"enter image description here\"></p>\n\n<p>I need a sql query that will return one row per date and return data that must contain AttendanceIn and AttendanceOut Time depands on strRemark(AI &amp; AO). Please help me.</p>\n"},{"tags":["c#","asp.net","sql","sql-server","ado.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13172423,"title":"How to compare excel value using asp.net SqlBulkCopy?","body":"<p>I am importing an Excel sheet into a SQL Server database. The Excel sheet contains 3 columns </p>\n\n<pre><code>id|data|passport\n</code></pre>\n\n<p>I am using <code>SqlBulkCopy</code> </p>\n\n<pre><code>SqlConnection con = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings[\"constr\"].ConnectionString);\n\n    string[] filePaths = null;\n    string strFileType = null;\n    string strFileName = null;\n    string strNewPath = null;\n    int fileSize;\n    int flag=0;\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n    }\n\n    protected void Button1_Click1(object sender, EventArgs e)\n    {\n        strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();\n        strFileName = FileUpload1.PostedFile.FileName.ToString();\n        FileUpload1.SaveAs(Server.MapPath(\"~/Import/\" + strFileName + strFileType));\n        strNewPath = Server.MapPath(\"~/Import/\" + strFileName + strFileType);\n        fileSize = FileUpload1.PostedFile.ContentLength / 1024;\n\n        //EXCEL DETAILS TABLE\n        con.Open();\n        //=========================================\n        DataTable dt8 = new DataTable();\n        SqlCommand cmd8 = new SqlCommand(\"insert into exceldetails (name,type,details,size)\" + \"values(@name,@type,@details,@size)\", con);\n        cmd8.Parameters.Add(\"@name\", SqlDbType.VarChar).Value = strFileName;\n        cmd8.Parameters.Add(\"@type\", SqlDbType.VarChar).Value = strFileType;\n        cmd8.Parameters.Add(\"@details\", SqlDbType.VarChar).Value = DateTime.Now;\n        cmd8.Parameters.Add(\"@size\", SqlDbType.Int).Value = fileSize;\n        cmd8.ExecuteNonQuery();\n        con.Close();\n        try\n        {\n            SqlDataAdapter da8 = new SqlDataAdapter(cmd8);\n            da8.Fill(dt8);\n        }\n        catch { }\n        //=========================================\n\n        //CHOOSING EXCEL CONNECTIONSTRING\n\n        string excelConnectionString = \"\";\n        switch (strFileType)\n        {\n            case \".xls\":\n\n                excelConnectionString = String.Format(@\"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=\" + strNewPath + \"; Extended Properties=Excel 8.0;\");\n                break;\n            case \".xlsx\":\n                {\n                    excelConnectionString = String.Format(@\"Provider=Microsoft.ACE.OLEDB.12.0;\" + \"Data Source=\" + strNewPath + \"; Extended Properties=Excel 12.0 Xml;\");\n\n                    break;\n                }\n        }\n\n        //===================================\n        //PRE EXCEL COUNT\n\n        // Create Connection to Excel Workbook\n        using (OleDbConnection connection = new OleDbConnection(excelConnectionString))\n        {\n            connection.Open();\n            OleDbCommand command = new OleDbCommand(\"Select ID,Data,passport FROM [Sheet1$]\", connection);\n            OleDbCommand command1 = new OleDbCommand(\"select count(*) from [Sheet1$]\", connection);\n\n            //Sql Server Table DataTable\n            DataTable dt4 = new DataTable();\n            SqlCommand cmd4 = new SqlCommand(\"select * from excelsheet\", con);\n            try\n            {\n                SqlDataAdapter da4 = new SqlDataAdapter(cmd4);\n                da4.Fill(dt4);//sql table datatable\n            }\n            catch { }\n\n            //===============================\n\n            //excelsheet datatable\n            DataTable oltlb = new DataTable();\n            OleDbCommand olcmd = new OleDbCommand(\"select * from [Sheet1$]\", connection);\n            try\n            {\n                OleDbDataAdapter olda = new OleDbDataAdapter(olcmd);\n                olda.Fill(oltlb); //excel table datatable\n            }\n            catch { }\n\n            //==============================\n\n\n            using (DbDataReader dr = command.ExecuteReader())\n            {\n                // SQL Server Connection String\n                string sqlConnectionString = \"Data Source=DITSEC3;Initial Catalog=test;Integrated Security=True\";\n\n                con.Open();\n                DataTable dt7 = new DataTable();\n                dt7.Load(dr);\n                DataRow[] ExcelRows = new DataRow[dt7.Rows.Count];\n                DataColumn[] ExcelColumn = new DataColumn[dt7.Columns.Count];\n\n                //=================================================\n                for (int i1 = 0; i1 &lt; ExcelRows.Length; i1++)\n                {\n                    string a = ExcelRows[i1][\"passport\"].ToString();\n                    char a1 = a[0];\n\n                    if (a1 &gt;= 'A' || a1 &lt;= 'Z')\n                    {\n                        Label12.Text = \"CAPITAL\";\n                        break;\n                    }\n                    else\n                    {\n                        Label12.Text = \"notgood\";\n\n\n                        flag = flag + 1;\n\n\n\n                    }\n\n                }\n                //=========================================================\n\n                if (flag == 0)\n                {\n                    using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n                    {\n                        bulkCopy.DestinationTableName = \"ExcelTable\";\n                        dt7.Rows.CopyTo(ExcelRows, 0);\n\n                        //==========================================================================================\n                        for (int i = 0; i &lt; ExcelRows.Length; i++)\n                        {\n                            if (ExcelRows[i][\"passport\"] == DBNull.Value)\n                            {\n                                ExcelRows[i][\"passport\"] = 0;\n                            }\n\n                        }\n                        bulkCopy.WriteToServer(ExcelRows);\n                        //==========================================================================================\n                        for (int i = 0; i &lt; ExcelRows.Length; i++)\n                        {\n                            if (ExcelRows[i][\"data\"] == DBNull.Value)\n                            {\n                                // Include any actions to perform if there is no date\n                                //ExcelRows[i][\"data\"] = Convert.ToDateTime(\"0\");\n                            }\n                            else\n                            {\n                                DateTime oldDate = Convert.ToDateTime(ExcelRows[i][\"data\"]).Date;\n                                DateTime newDate = Convert.ToDateTime(oldDate).Date;\n                                ExcelRows[i][\"data\"] = newDate.ToString(\"yyyy/MM/dd\");\n                            }\n\n                        }\n\n                        //==========================================================================================\n                    }\n                    //======\n\n                }\n                else\n                {\n                    Label13.Text = \"Wrong Format\";\n                }\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>ERROR AT : </p>\n\n<pre><code>string a = ExcelRows[i1][\"passport\"].ToString();\n</code></pre>\n\n<p>ERROR: </p>\n\n<blockquote>\n  <p><em>Object reference not set to an instance of an object.</em></p>\n</blockquote>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":100,"score":5,"question_id":13158944,"title":"\"Incorrect syntax\" error using OVER()","body":"<p>I have a sales budget for every trading day of the month.  So for day 1 the budget is 300, for day 2 the budget is 400, and then month to date budget is 700.  I get this error in my query:  <code>Incorrect syntax near 'ROWS'.</code></p>\n\n<pre><code>select \nTradingDate\n,Budget\n,sum(Budget) over (PARTITION BY TradingDate\norder by TradingDate asc\nROWS BETWEEN CURRENT ROW AND 1 FOLLOWING),1) AS BudgetMTD\nfrom #4\n</code></pre>\n"},{"tags":["sql","sql-server","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12767125,"title":"Fail to run sp_prepare over ADODB from Visual Basic","body":"<p>I can't get the handle value to pass to sp_execute. If I use the SQL code directly with Management Studio I succeed:</p>\n\n<pre><code>Declare @handle Integer\nexec sp_prepare @handle OUTPUT, N'@year int', N'SELECT * from Sales.CreditCard where ExpYear=@year';\n\nselect @handle\n\nexec sp_execute @handle, 2007\nexec sp_unprepare @handle\n</code></pre>\n\n<p>but when I try the following code on VB, \"param3.Value\" is \"nothing\" after the command is executed.</p>\n\n<pre><code>    ConnString = \"DRIVER={SQL Server};SERVER=192.168.100.41,1433;UID=sa;PWD=&lt;password&gt;;DATABASE=AdventureWorks\"\n    'create an instance of the ADO connection\n    Connection = CreateObject(\"ADODB.Connection\")\n\n    'Open the connection to the database\n    Connection.Open(ConnString)\n    Dim cmd As ADODB.Command\n    Dim param1 As ADODB.Parameter\n    Dim param2 As ADODB.Parameter\n    Dim param3 As ADODB.Parameter\n\n    cmd = CreateObject(\"ADODB.Command\")\n    cmd.ActiveConnection = Connection\n    cmd.CommandText = \"sp_prepare\"\n\n    param1 = cmd.CreateParameter(\"@handle\", 3, 2, 4, 0)\n    param2 = cmd.CreateParameter(\"@params\", 202, 1, 200, \"@year Integer\")\n    param3 = cmd.CreateParameter(\"stmt\", 202, 1, 200, \"SELECT TOP 4 [CreditCardID],[CardType],[CardNumber],[ModifiedDate]  FROM [AdventureWorks].[Sales].[CreditCard] where [ExpYear] in (@year)\")\n\n    cmd.Parameters.Append(param1)\n    cmd.Parameters.Append(param2)\n    cmd.Parameters.Append(param3)\n\n    cmd.Execute()\n\n    Debug.WriteLine(\"handle:\" &amp; param1.Value)\n</code></pre>\n\n<p>Do you know how to make it work on VB?\nThe reason I run this from VB is that I need the command to be run over RPC.</p>\n"},{"tags":["sql","oracle","oracle9i"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13172234,"title":"SQL want to log values before and after update table","body":"<p>I have a problem here.</p>\n\n<p>DB: oracle 9i</p>\n\n<p>I want to save data changes after I execute <code>UPDATE</code> script on my table,\nin that log I want to compare old values with new values.</p>\n\n<p>How can i do this.</p>\n\n<p>thanks for helping me :)</p>\n"},{"tags":["sql","format","datepart"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13172193,"title":"SQL change format of Datepart Month","body":"<p>How do you change the DATEPART format of the month to include the 0 in front of the month?</p>\n\n<p>For instance 5 should be 05.</p>\n\n<p>What I have tried, but none of it works, (only gives me 5)</p>\n\n<p>Createdate = 2008-07-25 13:43:48.000</p>\n\n<pre><code>CONVERT(varchar(2), DATEPART(MONTH,(CreatedDate)))\nCONVERT(varchar(2), DATEPART(MM,(CreatedDate)))\n</code></pre>\n"},{"tags":["sql","cakephp"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13172462,"title":"Cakephp 2.0: complex find query","body":"<p>I'm trying to pull some info out of two tables linked by the hasMany and belongsTo associations. </p>\n\n<p>requisitions hasMany locations and locations belongsTo requisitions</p>\n\n<pre><code>TABLE `requisitions` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`user_id` int(11) NOT NULL,\n`fecha_generacion` date NOT NULL,\n`solicitado_a` varchar(60) NOT NULL,\n`proyecto` varchar(150) NOT NULL,\n`obra_no` varchar(11) NOT NULL,\n`observaciones` text NOT NULL,\n PRIMARY KEY (`id`)\n) \n\nand \n  TABLE `locations` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `requisition_id` int(11) NOT NULL,\n  `fecha` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `name` enum('pendiente','tecnico','existencia','cotizando','generar_o','archivada')   \n   NOT NULL DEFAULT 'pendiente',\n  `image_path` varchar(150) NOT NULL DEFAULT 'estado0.png',\n  `note` text NOT NULL,\n  PRIMARY KEY (`id`)\n) \n</code></pre>\n\n<p>Requisition goes from one Location to another and I need to keep track of its current Location looking by a given Location as 'pendiente','tecnico'...\nSo I need to generate a list with the last Location for each Requisition and then filter that list by the Location.name</p>\n\n<p>I believe the only way to do this is with a query around another query, so I'm trying to understand cakephp syntax with more simple queries first.</p>\n\n<p>I was trying to search for the last 'pendiente' Location with the next code from my RequisitionsController.</p>\n\n<pre><code>$lastPendiente = $this-&gt;Requisition-&gt;Location-&gt;find('all', array(\n 'conditions' =&gt; array('Location.name' =&gt; 'pendiente'),\n   'fields' =&gt; array('MAX(Location.id) AS olderLocation', 'Location.requisition_id'), \n    'group' =&gt; 'Requisition.id',\n    ));\n</code></pre>\n\n<p>I have the query</p>\n\n<pre><code>SELECT MAX(`Location`.`id`) AS olderLocation, `Location`.`requisition_id` FROM `petrofil_demo`.`locations` AS `Location` LEFT JOIN `petrofil_demo`.`requisitions` AS `Requisition` ON (`Location`.`requisition_id` = `Requisition`.`id`) WHERE `Location`.`name` = 'pendiente' GROUP BY `Requisition`.`id`\n</code></pre>\n\n<p>output...</p>\n\n<pre><code>array(\n    (int) 0 =&gt; array(\n        (int) 0 =&gt; array(\n            'olderLocation' =&gt; '22'\n        ),\n        'Location' =&gt; array(\n            'requisition_id' =&gt; '29'\n        )\n    ),\n    (int) 1 =&gt; array(\n        (int) 0 =&gt; array(\n            'olderLocation' =&gt; '5'\n        ),\n        'Location' =&gt; array(\n            'requisition_id' =&gt; '30'\n        )\n    ),\n    (int) 2 =&gt; array(\n        (int) 0 =&gt; array(\n            'olderLocation' =&gt; '13'\n        ),\n        'Location' =&gt; array(\n            'requisition_id' =&gt; '31'\n        )\n    )\n)\n</code></pre>\n\n<p>...which is great because those are exactly the last requisitions with a 'pendiente' location but here comes the second query or the condition where I'm clueless. I need to be sure my requisition last state was 'pendiente' and not another possible locations. For example my requisition_id =>30 last location is really 'tecnico' so I need to find a way to exclude it from showing on my results.</p>\n"},{"tags":["sql","vb.net","linq","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13169314,"title":"Combining two tables into one","body":"<p>I need to merge two data schema into one. I have Schema1 and Schema2. I need to join these two into Schema3. Furthermore, I have a Select statement which queries a data set but I can't figure out how to use the select statement on the data set containing both tables (both Schema1 and Schema2) and combine them into the new table schema3 which is a table in the same data set comprised of both table's fields. </p>\n\n<p>Example</p>\n\n<p><strong>Schema 1</strong> \nID, \nFood, \nBook,\nRice, \nCave</p>\n\n<p><strong>Schema 2</strong>\nID ,\nCarpet, \nStrings,\nRun </p>\n\n<p><strong>Schema 3</strong> \nID,\nFood, \nBook, \nRice,\nCave,\nCarpet,\nStrings,\nRun </p>\n\n<p>Fill the Schema3 Table with this command</p>\n\n<p>Sql Command:</p>\n\n<pre><code>Select * Schema1 [except ID] and all fields from Schema2 [exceptID] Inner Join \nSchema2 ON Schema1.ID = Schema2.ID\nWhere ID = {dynamically defined variable 'X'}\n</code></pre>\n\n<p>Please excuse the lack of proper syntax. The main issue here again is querying a dataset with the select statement and filling up a table with the results. Im not exactly connecting to my DB because I already filled a dataset locally. </p>\n\n<p>------Edit ------\nI really just need a way to create an array of data rows from a query of two tables.</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13169830,"title":"Exclude value of a record in a group if another is present v2","body":"<p>In the example table below, I'm trying to figure out a way to sum amount over marks in two situations: the first, when mark 'C' exists within a single id, and the second, when mark 'C' doesn't exist within an id (see id 1 or 2). In the first situation, I want to exclude the amount against mark 'A' within that id (see id 3 in the desired conversion table below). In the second situation, I want to perform no exclusion and take a simple sum of the amounts against the marks. </p>\n\n<p>In other words, for id's containing both mark 'A' and 'C', I want to make the amount against 'A' as zero. For id's that do not contain mark 'C' but contain mark 'A', keep the original amount against mark 'A'.</p>\n\n<p>My desired output is at the bottom. I've considered trying to partition over id or use the EXISTS command, but I'm having trouble conceptualizing the solution. If any of you could take a look and point me in the right direction, it would be greatly appreciated :)</p>\n\n<p>example table:</p>\n\n<pre><code>id   mark  amount\n------------------\n1    A     1\n2    A     3\n2    B     2\n3    A     1\n3    C     3\n</code></pre>\n\n<p>desired conversion:</p>\n\n<pre><code>id   mark  amount\n------------------\n1    A     1\n2    A     3\n2    B     2\n3    A     0\n3    C     3\n</code></pre>\n\n<p>desired output:</p>\n\n<pre><code>mark    sum(amount)\n--------------------\nA       4\nB       2\nC       3\n</code></pre>\n"},{"tags":["mysql","sql","sql-optimization"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":12881929,"title":"optimize sql with subquery in from","body":"<p>I would like to optimize an sql statement, below is the original one.</p>\n\n<pre><code>SELECT DISTINCT\n    p.productID,\n    p.filename,\n    p.model,\n    p.code,\n    p.manufacturerID,\n    f2.manufacturerName,\n    m.manufacturerName,\n    CONCAT('INSERT INTO distribItems(productID, manufacturer, code, distributorText) VALUES (',\n            CAST(p.productID AS CHAR),\n            ', \\'',\n            f2.manufacturerName,\n            '\\', \\'',\n            f2.code,\n            '\\', \\'',\n            f2.denumire,\n            '\\') ;') INS\nFROM\n    (SELECT \n        f.manufacturerName, f.categoryName, f.code, f.denumire, f.code_2\n    FROM\n        furnizorlist f\n    LEFT JOIN distribitems d ON \n        (d.manufacturer = f.manufacturerName\n        AND (d.code = f.code OR d.manufacturer LIKE 'DELL')\n        AND d.distributorText = LEFT(f.denumire, 450))\n    WHERE\n        productID IS NULL) f2,\n    products p,\n    manufacturers m\nWHERE\n    f2.code_2 &lt;&gt; ''\n        AND (f2.code_2 = p.code_2 OR f2.code_2 = p.model_2)\n        AND p.manufacturerID = m.manufacturerID\n        AND m.manufacturerName = f2.manufacturerName\n        AND m.manufacturerName != 'Compatibil'\n        AND p.code != '1'\nORDER by p.filename ASC;    \n</code></pre>\n\n<p>On my PC it takes around 34 seconds.</p>\n\n<p><img src=\"http://i.stack.imgur.com/8NK5Z.png\" alt=\"screenshot\"></p>\n\n<p>My idea was to write the subquery as a Join and set the conditions in the Where clause.</p>\n\n<p>Here is my incredible fast SQL:</p>\n\n<pre><code>SELECT DISTINCT\n    p.productID,\n    p.filename,\n    p.model,\n    p.code,\n    p.manufacturerID,\n    f.manufacturerName,\n    m.manufacturerName,\n    CONCAT('INSERT INTO distribItems(productID, manufacturer, code, distributorText) VALUES (',\n            CAST(p.productID AS CHAR),\n            ', \\'',\n            f.manufacturerName,\n            '\\', \\'',\n            f.code,\n            '\\', \\'',\n            f.denumire,\n            '\\') ;') INS\nFROM\n    furnizorlist f,\n    distribitems d,\n#subquery end\n    products p,\n    manufacturers m\nWHERE\n    d.manufacturer = f.manufacturerName\n        AND (d.code = f.code OR d.manufacturer LIKE 'DELL')\n        AND d.distributorText = LEFT(f.denumire, 450)\n        AND d.productID IS NULL\n#subquery condions end (f and d tables)\n# the next is a subqury result:\n        AND f.code_2 &lt;&gt; ''\n        AND (f.code_2 = p.code_2 OR f.code_2 = p.model_2)\n        AND p.manufacturerID = m.manufacturerID\n        AND m.manufacturerName = f.manufacturerName\n        AND m.manufacturerName != 'Compatibil'\n        AND p.code != '1'\nORDER by p.filename ASC;    \n</code></pre>\n\n<p>If I write to <code>explain improved_sql</code>  I will see an <strong>Impossible WHERE</strong> column.\nI tried but couldn't find why it is impossible. I checked the fields' compatibility: to not have a case where it require to compare an int with a varchar and like that. I couldn't find any major error, that's why I am here. </p>\n\n<p>Is there a logical error in the WHERE clause? like asking a field to be <code>1</code> and later to be <code>2</code> ?</p>\n\n<p>Fields which ends with ID are INT\nFields which ends with NAME, code are varchar (255)\nFields with Text are 450 and 8192 varchar ( in only one place is used)</p>\n\n<p>traslation: \"denumire\" means \"description\" - or something like that :)</p>\n\n<p>Not sure which version of mysql is running server side, probably 5.</p>\n\n<p>I can suggest table structure changes if I have a good reason, probably the code will be adjusted.</p>\n\n<p>EDIT:</p>\n\n<p>The impossible where it comes from here:</p>\n\n<pre><code>EXPLAIN \n\nSELECT \n    f.manufacturerName,\n    f.categoryName,\n    f.code,\n    f.denumire,\n    f.code_2\nFROM\n    furnizorlist f\n        INNER JOIN\n    distribitems d ON (d.manufacturer = f.manufacturerName\n        AND (d.code = f.code\n        OR d.manufacturer LIKE 'DELL')\n        AND d.distributorText = LEFT(f.denumire, 450))\nWHERE\n    productID IS NULL\n</code></pre>\n\n<p>Remark: INNER JOIN , not LEFT JOIN.</p>\n\n<p>Edit2: \nTable: furnizorlist 42,751 records\nTable: distribitems 72,290 records</p>\n"},{"tags":["mysql","sql","query","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":26,"score":0,"question_id":13171594,"title":"SQL Query Throws Error 150","body":"<pre><code>SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;\nSET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;\nSET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';\n\nCREATE SCHEMA IF NOT EXISTS `rsmad` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;\nUSE `rsmad` ;\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_flashobjects`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_flashobjects` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `flashobject_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_html`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_html` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `html_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_iframes`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_iframes` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `iframe_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_images`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_images` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `image_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_links`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_links` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `link_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`app_text`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`app_text` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `app_id` INT UNSIGNED NOT NULL ,\n  `text_id` INT UNSIGNED NOT NULL ,\n  PRIMARY KEY (`id`) )\nENGINE = InnoDB;\n\n\n-- -----------------------------------------------------\n-- Table `rsmad`.`apps`\n-- -----------------------------------------------------\nCREATE  TABLE IF NOT EXISTS `rsmad`.`apps` (\n  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT ,\n  `webpage_id` INT UNSIGNED NOT NULL ,\n  `timestamp` DATETIME NULL ,\n  `status` ENUM('ok','malicious','good') NOT NULL DEFAULT 'ok' ,\n  PRIMARY KEY (`id`) ,\n  CONSTRAINT `fk_apps_app_flashobjects1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_flashobjects` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_html1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_html` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_iframes1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_iframes` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_images1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_images` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_links1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_links` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE,\n  CONSTRAINT `fk_apps_app_text1`\n    FOREIGN KEY (`id` )\n    REFERENCES `rsmad`.`app_text` (`app_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE)\nENGINE = InnoDB;\n</code></pre>\n\n<p>Can anyone explain what the issue with these queries is?</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":56,"score":5,"question_id":13153344,"title":"In a join, how to prefix all column names with the table it came from","body":"<p>I'm analysing a rather horrible legacy database/codebase, trying to reduce server load by combining queries into joins (including an email alert cron job that typically invokes well over a million separate queries).</p>\n\n<pre><code>SELECT * FROM \nclass_alerts_holding ah \nINNER JOIN class_listings l ON l.id = ah.lid \nINNER JOIN class_users u ON u.id = ah.uid\nLEFT JOIN class_prodimages pi ON pi.pid = ah.lid\n</code></pre>\n\n<p>This spits out 120 columns...</p>\n\n<pre><code>aid | id | lid | uid | oid | catName | searchtext | alertfreq | listType | id | owner | title | section | shortDescription | description | featured | price | display | hitcount | dateadded | expiration | url | notified | searchcount | repliedcount | pBold | pHighlighted | notes | ...\n</code></pre>\n\n<p>To assist my analysis of how to construct the new queries it would be awesome if I could prefix the columns in the result with the table they came from in the JOIN e.g.</p>\n\n<pre><code>class_alerts_holding.aid | class_alerts_holding.id | class_listings.lid | ...\n</code></pre>\n\n<p>Is there a way to achieve this?</p>\n\n<p><em>Before anyone gets hot and bothered, I repeat: the query above is for analysis purposes only, I promise.</em></p>\n"},{"tags":["asp.net","sql","insert","primary-key"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13169769,"title":"asp.net check is primary key exists before inserting into table","body":"<p>looking for a simple way to check if a primary key already exists in the table before inserting into it. where Fname is the primary key in the table.</p>\n\n<pre><code>SqlConnection conn = new SqlConnection(connStr);\nconn.Open();\nSqlCommand cmd = new SqlCommand();\ncmd.Connection = conn;\ncmd.CommandText = \"INSERT INTO [table] ([firstName], [lastName]) VALUES ('\" + txtFName.Text + \"','\" + txtLName.Text + \"')\";        \n\ncmd.ExecuteNonQuery();\nconn.Close();\n</code></pre>\n"},{"tags":["sql","query","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13170717,"title":"MS Access SQL Query - Joining 3 Tables to receive Total Order Price","body":"<p>I would like to know the total price for a specific order ID. The information is contained in these tables:</p>\n\n<p>Order_line_t</p>\n\n<pre><code>Order_ID    Product_ID    Quantity\n--------    ----------    --------\n1006        4             1\n1006        5             2\n1006        7             2\n</code></pre>\n\n<p>Uses_t</p>\n\n<pre><code>Product_ID    Material_ID    Footage\n----------    -----------    -------\n4             16             20\n5             15             13\n7             10             16\n</code></pre>\n\n<p>Raw_Materials_t</p>\n\n<pre><code>Material_ID    Unit_Price\n-----------    ----------\n16             05.70\n15             16.72\n10             15.55\n</code></pre>\n\n<p>The total cost is computed by </p>\n\n<pre><code>Multiplying SUM ( Order_line_t.Quantity * Uses_t.Footage * Raw_Materials_t.Unit_Price) AS Total\n</code></pre>\n\n<p>My current query only returns an error:</p>\n\n<pre><code>SELECT Order_line_t.Order_ID, Order_line_t.Product_ID, Uses_t.Product_ID   ,Uses_t.Footage , \nSUM ( Order_line_t.Quantity * Uses_t.Footage * Raw_Materials_t.Unit_Price) AS Total\nFROM Order_line_t, Uses_t , Raw_Materials_t\nWHERE  Order_line_t.Order_ID = 1006;\n</code></pre>\n\n<p>Help appreciated! How exactly do I JOIN these tables? What am i missing?</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13169921,"title":"Using SQL to create football fixtures?","body":"<p>Quite hard to explain but say I have a table named 'Teams' and It contains 5 teams like so:</p>\n\n<pre><code> team_id, teamname, manager\n   1,       Team1,    1\n   2,       Team2,    10\n   3,       Team3,    3\n   4,       Team4,    5\n   5,       Team5,    6\n</code></pre>\n\n<p>I need to create another table looking similar to this (named TeamFixtures for example)</p>\n\n<pre><code>  id, HomeTeam, HomeScore, AwayScore, AwayTeam\n                  NULL        NULL\n</code></pre>\n\n<p>How would I make the HomeTeam and AwayTeam be the team_id of the 'teams' table?</p>\n\n<p>Id need this for each team so they play against each other twice, home and away games.</p>\n\n<p>Is there a Query that could make this quicker for me, rather than typing out the fixtures 1by1</p>\n"},{"tags":["mysql","sql","database","mysql-workbench"],"answer_count":5,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":11299,"score":9,"question_id":4930733,"title":"How to generate the whole database script in MySQL Workbench?","body":"<p>I want to take the whole database. Where do I find the database file?</p>\n\n<p>And is there a way to write the whole database with all data to a text file (like the one in SQL Server)?</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":280,"score":1,"question_id":7162903,"title":"Alter table to change column data type","body":"<p>I run </p>\n\n<pre><code>ALTER TABLE tbl_name ALTER COLUMN col_name varchar (11);\n</code></pre>\n\n<p>I am using PostgreSQL. what am I doing wrong?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13170371,"title":"Easier way to compare a DATE field to the date value of GETDATE?","body":"<p>I have a field in a table <code>Event.EventDate</code> and it's of the data type <code>DATE</code> rather than <code>DATETIME</code> and then I have a view that has the following <code>WHERE</code> clause:</p>\n\n<pre><code>WHERE e.EventDate &gt;= CAST(CONVERT(VARCHAR(MAX), GETDATE(), 101) AS DATETIME)\n</code></pre>\n\n<p>As you can see, I'm just trying to get all events <code>&gt;=</code> today's <strong>date</strong>. The above code works, but it's ugly. I tried this ...</p>\n\n<pre><code>WHERE e.EventDate &gt;= CONVERT(VARCHAR(MAX), GETDATE(), 101)\n</code></pre>\n\n<p>... and this ...</p>\n\n<pre><code>WHERE e.EventDate &gt;= CONVERT(DATETIME, GETDATE(), 101)\n</code></pre>\n\n<p>... but those didn't work, they gave me every event <code>&gt;</code> today's <strong>date</strong>. However, even if the above worked, it's still ugly.</p>\n\n<p>Isn't there a better way?</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":50,"score":1,"question_id":13132574,"title":"Find count of maximum","body":"<p>Suppose I have table with following values</p>\n\n<pre><code>A         B           C\n------------------------\n5        ABC         $20\n3        BCD         $40\n5        BCD         $40\n2        ABC         $20\n5        ABC         $30\n</code></pre>\n\n<p>How to write query which would return count of maximum, suppose for column A\nit should return value 3 that is count for max which is 5.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":20,"score":1,"question_id":13170413,"title":"mysql counting query","body":"<p>In this query I need to remove duplication tutor id and counting them..</p>\n\n<pre><code>SELECT COUNT(t.tutor_id) FROM tutors AS t\n    INNER JOIN tutor_category_subject as tcs ON t.tutor_id = tcs.tutor_id   \n    INNER JOIN subject AS s ON tcs.subject_id = s.subject_id\nWHERE s.subjects LIKE '%business%' \n</code></pre>\n\n<p>this is query output: </p>\n\n<pre><code>+-------------------+\n| COUNT(t.tutor_id) |\n+-------------------+\n|                 6 |\n+-------------------+\n</code></pre>\n\n<p>but it should be 4.. why there tutor ids are 3, 6, 15, 15, 16, 16 </p>\n"},{"tags":["sql","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":9850758,"title":"sqlite query for grouped time-frame","body":"<p>I'm trying to query my connections history table into hourly time-frame, every hour it's connection duration.</p>\n\n<pre><code>create table sessionHistory (\n  _id       integer PRIMARY KEY autoincrement,\n  modified  integer,\n  ip        text,\n  ...\n  started   integer,\n  ended     integer\n);\n</code></pre>\n\n<p>Every connection start has a \"started\" date, and when it's finished I put an \"end\" date, both in unix epoch.</p>\n\n<p>I'm able to group them using the following query:</p>\n\n<pre><code>select strftime('%H', started, 'unixepoch') HOUR_, \n       sum(ended-started) TOTAL_TIME_ \nfrom sessionHistory \nwhere ip='123.123.123.123' and ended!=0\ngroup by strftime('%H', started, 'unixepoch')\n</code></pre>\n\n<p>Now, I wish also to include in every hour the session time that's still ongoing (ended=0). </p>\n\n<p>For instance, in hour 1 the connection had started and finished with duration of  35 seconds. In hour 2 the connection had started just before turning into hour 3, with 10 seconds to turning, and stopped 10 seconds after turning into hour 3. </p>\n\n<p>This means that the query needs to return something like hour 1 => 35, hour 2 => 10, hour 3 => 10.\nMoreover, if the connection is still up (ended=0) I want to have the current hour to hold data for \"now\"-started, which will accumulate in the relative hour.</p>\n\n<p>Joining 2 sqlite queries will not answer the last specification, as it will always return \"now\"-\"started\", even if the session is over 1 hour long.</p>\n"},{"tags":["sql","database","ms-access-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13170290,"title":"streamlining queries","body":"<p>I have a db now has grouping and filtering queries that feed into aggregate queries that feed into more grouping and filtering queries and it's starting to bog down.</p>\n\n<p>Whats the best way to start streamlining this for reporting and maintenance?</p>\n"},{"tags":["sql","postgresql","aggregate-functions","duplicate-removal","window-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13169367,"title":"Get the distinct sum of a joined table column","body":"<p>I have a problem here, and I'm hoping there is an easy solution. I'll try to make this as simple as possible:</p>\n\n<ul>\n<li>A ticket belongs to an attendee</li>\n<li>Example:</li>\n</ul>\n\n<p></p></p>\n\n<pre><code>select * from tickets JOIN attendees ON attendee.id = tickets.attendee_id\n</code></pre>\n\n<ul>\n<li>An attendee has a decimal column called \"revenue\"</li>\n</ul>\n\n<p>That said, I need to run a query that will return a variety of information about the tickets, including the total revenue. The problem is that if 2 tickets belong to the same attendee, it counts their revenue twice. How can I sum the attendee revenue only once?</p>\n\n<p><strong>I don't want to use subqueries as my ORM makes this difficult. Plus a sub query solution doesn't scale if I want to do this for multiple columns.</strong></p>\n\n<p>Here's what I have:</p>\n\n<ul>\n<li>1 attendees with a revenue of 100</li>\n<li>2 tickets that both belong to that attendee</li>\n</ul>\n\n<p></p></p>\n\n<pre><code>Select count(tickets.*) as tickets_count\n     , sum(attendees.revenue) as atendees_revenue\nfrom tickets LEFT OUTER JOIN attendees ON attendees.id = tickets.attendee_id;\n</code></pre>\n\n<p>=> This tells me that <code>attendees_revenue</code> is 200. I want it to be 100. Since there is one attendee in the database with an existing_revenue of 100. I do NOT want the attendee to be double counted.</p>\n\n<p>Please let me know if this is possible.</p>\n"},{"tags":["javascript","jquery","mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13169783,"title":"Any Javascript/Jquery Library To validate SQL statment?","body":"<p>i have a textarea in my project where users can save SQL queries but one of the requirements is to check if this query is valid or not </p>\n\n<p><strong>EXAMPLE</strong></p>\n\n<p>if user entered something like : </p>\n\n<pre><code>SELECT ** FROM EMP \n</code></pre>\n\n<p>this should return false and an error message just saying <code>invalid</code> it doesn't have to give any reasons </p>\n\n<p>mainly the queries will be just <code>select</code> statement </p>\n\n<p><em>NOTICE</em>\ni DON'T want to use any server side at this point </p>\n\n<p><strong>Question</strong> </p>\n\n<p>Does any one knows a javascript / jquery  library or plugin that have this functionality or any thing similar</p>\n\n<p>i have Google this and it didn't show any thing </p>\n\n<p>Thanks </p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13169810,"title":"Join a table based on first table's content","body":"<p>I am trying to come up with a query where a 3rd table will join another two.  The problem is there are different versions of this first table and I need the query to look at a column in table 1 and then choose the correct table to join but the resulting query must return all rows in table 1 just join an extra table 3 to specific rows which meet the WHERe clause.  <em>Is this even possible?</em></p>\n\n<p><strong>Example:</strong></p>\n\n<p>Table 1 = User</p>\n\n<p>Table 2 = Banners</p>\n\n<p>Table 3 = UserSettings OR AdminSettings OR Nothing</p>\n\n<p><em><strong>Query would say...</em></strong></p>\n\n<pre><code>WHERE User.rank='admin' LEFT JOIN AdminSettings\n\nWHERE User.rank='user' LEFT JOIN UserSettings\n</code></pre>\n\n<p>My current query is this:</p>\n\n<pre><code>$query = \"SELECT * FROM Users as U WHERE U.user_id = :id \";\n$query .= \"LEFT JOIN Banners as B ON U.banner_id = B.banner_id \";\n$query .= \"LEFT JOIN AdminSettings ON U.server_id = AdminSettings.user_id WHERE U.rank='Admin' \";\n$query .= \"LIMIT 1\";\n</code></pre>\n\n<p>Problem is that it only shows rows that have User.rank='admin' and does not show the rows where User.rank='user' rest. </p>\n"},{"tags":["sql","sql-server","common-table-expression"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13164308,"title":"CTE and row_number() to fix join on unnormalized table","body":"<p>There's a table on which I can't perform any updates.  There are a dozen or so fields and of them, <code>bus_typ_cd</code> changes.  This lead to me getting double the expected results for a given patient who had two different <code>bus_typ_cd</code>s.  I'm unable to drop this column.  While I found a workaround solution, I was wondering if there is a more extensible/efficient way to do this.  Pic of the incorrect results:<img src=\"http://i.stack.imgur.com/mRbda.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>EDIT</strong>  what I thought was a fix actually wasn't.  If I use a <code>where</code> clause to restrict only a single <code>bus_typ_cd</code> I can't catch all of the expected results.  </p>\n\n<p>the working version:</p>\n\n<pre><code>   with cte as\n    (\n    select c.patid\n        ,c.CHARGE\n        ,c.pos\n        ,m.sex\n        ,e.eduText\n\n        from claims c\n        inner join icdClm as ic on ic.clmid=c.clmid\n        --instead of selecting the table, a derived table with distinct values was selected\n        inner join\n        (\n            select distinct m.patid, m.sex,m.education\n                from members as m \n        ) as m on m.PATID=c.patid\n        inner join EducationTable as e on e.eduID=m.education\n        where ic.icd like '707%'\n    ) \n</code></pre>\n\n<p>non working</p>\n\n<pre><code>    ;with cte as\n    (\n    select c.patid\n        ,c.CHARGE\n        ,c.pos\n        ,m.sex\n        --,e.eduText\n        ,ROW_NUMBER() over(partition by c.patid,bus_typ_cd order by c.patid)  as rn\n        ,m.BUS_TYP_CD\n        ,m.STATE_CD\n        from claims c\n        inner join icdClm as ic on ic.clmid=c.clmid\n        inner join members as m on m.PATID=c.patid\n        inner join EducationTable as e on e.eduID=m.education\n        where ic.icd like '707%'\n    ) \n\n\n    select  cte.*\n        from cte\n        inner join cte as cte2 on cte.patid=cte2.patid \n        and cte.POS=cte2.POS and cte.sex=cte2.sex \n        --tried to make the below line a logical unit of equal charge and one rn less than the other\n        and (cte.CHARGE=cte2.CHARGE and cte.rn &lt; cte2.rn) \n        and cte.BUS_TYP_CD=cte2.BUS_TYP_CD \n        and cte.STATE_CD=cte2.STATE_CD\n        where cte.patid =1161569271\n        order by cte.CHARGE\n</code></pre>\n"},{"tags":["sql","select","group-by"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13169653,"title":"SQL query to aggregate rows by time periods","body":"<p>I have table with GPS data (datetime, username, longitude, latitude) and need to find travelled distance and time grouped by users in 30 minutes time windows.</p>\n\n<p>E.g. if I logged data in the morning and then took 30+ min. break and after it I started logging again, I should get two rows:</p>\n\n<p>username startedLoggingDatetime, stopedLoggingDatetime, totalTime, totalDistance\nusername startedLoggingDatetime (after 30 min time window when there was no data), stopedLoggingDatetime, totalTime, totalDistance</p>\n\n<p>I was trying to find min max values grouped by date, but this is wrong way (e.g. if there are only several records in db with datetime stamps 12 hours difference, it will show huge values of totalTime and totalDistance but in reality I was logging date only for two short periods in the morning and in the evening).</p>\n\n<p>I have no idea how to get such report and your help is much appreciated. I'm using MS SQL 2008 R2</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005","login"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13168175,"title":"SQL Script to Create Auto-Expiring Login","body":"<p>How can I script the creation of a new SQL Login (whether by Windows\nAuthentication or with SQL password) and have it automatically expire after some\ntime, e.g. 8 hours, 24 hours</p>\n\n<p>I've tried searching here in stackoverflow but I haven't found a solution. If you guys know of one that exists here, please let me know too. Thank you.</p>\n\n<p>I am using SQL Server 2005 and 2008</p>\n"},{"tags":["mysql","sql","windows","r","rmysql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13165738,"title":"Missing mysql.h and trying to find mysql-devel","body":"<p>(I've been through four or five questions that are related to mine, but this sticking point I run into doesn't seem to be addressed in them.)</p>\n\n<p>In trying to run RMySQL on RStudio on a windows machine, I've been trying to follow the help given here: <a href=\"http://stackoverflow.com/questions/10292326/how-to-connect-r-with-mysql-or-how-to-install-rmysql-package\">How to Connect R with MySQL or how to install RMySQL package?</a> and here: <a href=\"http://stackoverflow.com/questions/5223113/using-mysql-in-r-for-windows\">Using MySQL in R for Windows</a></p>\n\n<p>I was able to complete steps 1,3,4,5 but not #2. </p>\n\n<p>I've tried searching for the missing header <strong>mysql.h</strong> itself, but everything I find is for a different platform, or else points toward <a href=\"http://dev.mysql.com/downloads/mysql/#downloads\" rel=\"nofollow\">http://dev.mysql.com/downloads/mysql/#downloads</a> , where I honestly cannot see any reference to the header at all. </p>\n\n<p>Another suggestion I saw was to install mysql-devel, but again, all the links I found for this pointed to nothing that worked. </p>\n\n<p>Thanks in advance for your help: I hope it's simple to resolve!</p>\n"},{"tags":["sql","postgresql","relational-division"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13166996,"title":"Logical conditional in PostgreSQL","body":"<p>I want the name of every male director that has directed more than 20 movies and has cast in every single movie he has directed. If he has cast a movie, but hasn't directed it, that's okay and I still want his name; if he has directed any movie but hasn't cast in it, I don't want him anymore.</p>\n\n<pre><code>SELECT p.firstname, \n    p.lastname \nFROM person p \nWHERE p.gender = 'M' AND\n(\n    SELECT COUNT(*)\n    FROM filmparticipation fpd \n    WHERE p.personid = fpd.personid AND\n        fpd.parttype = 'director' AND\n        (\n            SELECT COUNT(*) \n            FROM filmparticipation c \n            WHERE c.personid = fpd.personid AND\n                c.filmid = fpd.filmid AND\n                c.parttype = 'cast'\n        ) &gt; 0\n) &gt;= 20;\n</code></pre>\n\n<p>This is just one of my multiple tries. As a side question, why doesn't it work? I make sure I'm checking the correct directed movie-id to the casted movie-id etc.</p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":13166647,"title":"Trouble Joining 3 Tables","body":"<p>I am new to writing SQL queries and have been trying to pull information from 3 different tables and link it together.  </p>\n\n<p>Data resides in Microsoft SQL Server.  </p>\n\n<p>This is my current query (which is not working the way I intend it to):  </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhpart, h.jhrev, h.jhcust, h.jhextd, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend \nFROM Jhead AS h\nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 \nORDER BY h.jhjob\n</code></pre>\n\n<p>To explain what I am trying to do.  I have a job header table <strong>Jhead</strong>, a job detail table <strong>jjops</strong> and a purchase order detail table <strong>hpodt</strong>.  I believe the job number is the primary key in the jhead table.</p>\n\n<p>Here is my problem:  As soon as I add the second left join I end up with a lot of extra lines of duplicated information. </p>\n\n<p>I have tried using the GROUP BY jhead.jhjob but get the following error: </p>\n\n<p>“Column ‘jhead.jhhold’ is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.”</p>\n\n<p>So I researched the error with one of the solutions being to make my GROUP BY look like this:\nGROUP BY jhead.jhjob, jhead.jhhold, jhead.jhpart, jhead.jhrev, jhead.jhcust, jhead.jhextd</p>\n\n<p>But then as soon as I put in jhead.jhextd I get this error:\n“The text, ntext, and image data types cannot be compared or sorted, except when using IS NULL or LIKE operator.”</p>\n\n<p>And have now hit a brick wall.  I did see that you can change the type to NVARCHAR.  I don’t really want to be sorting by the description field because it is unique and may be very taxing on the server.  Is there a better way to do this?  </p>\n\n<p><strong>Edit With Sample Data:</strong>\nI removed extra fields to simplify the query and have filtered the results for 1 job number.</p>\n\n<p>With only 1 left join:\n<img src=\"http://i.imgur.com/Gd3J5.jpg\" alt=\"With only 1 Left Join\"></p>\n\n<p>With both left joins:\n<img src=\"http://i.imgur.com/Woaog.jpg\" alt=\"Second\"></p>\n\n<p>ERP software as you can see has multiple jobs under 1 PO# and I am only interested in displaying lines with a job number that matches.\n<img src=\"http://i.imgur.com/nZzXx.jpg\" alt=\"Third\"></p>\n\n<p><strong>QUERY UPDATED</strong> </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd\nFROM Jhead AS h\nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo\nORDER BY h.jhjob\n</code></pre>\n\n<p>This is getting close to what I want.  The problem is now that my jadesc field is duplicating the first result when it should actually be different for each line.</p>\n\n<p><img src=\"http://i.imgur.com/9o7du.jpg\" alt=\"4\"></p>\n\n<p>I filtered to just display one job.  Their should only be one column.</p>\n\n<p><strong>Getting extra lines but have all the data I need</strong>  </p>\n\n<pre><code>SELECT h.jhhold, h.jhjob, h.jhrev, o.jadesc, h.jhpqty, o.jaoqty, o.jacqty, o.japo, o.javend, p.hdprcd, p.hdrecd, p.hdseq \nFROM Jhead AS h \nLEFT JOIN jjops AS o ON h.jhjob = o.jajob \nLEFT JOIN hpodt AS p ON h.jhjob = p.hdjob \nWHERE (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND p.hdjob = h.jhjob AND p.hdpo = o.japo AND p.hdseq = o.jaseq AND o.jaopr != 'PT') \n  OR (h.jhpcmp = 0 AND o.jatype = 2 AND o.jacqty &lt; o.jaoqty AND japcmp = 0 AND o.japo = 0 AND o.jaopr != 'PT')\nORDER BY h.jhjob, o.jaseq\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":34,"score":4,"question_id":13168965,"title":"Group by query is not returning what I expected","body":"<p>I am attempting to find all records that have the same <code>groupCol</code> but more than one non 0 <code>infoCol</code>. Here is a complete example of what I am trying to do.</p>\n\n<pre><code>CREATE TABLE #t\n    (\n    groupCol varchar(14) NOT NULL,\n    infoCol int NOT NULL,\n    indexCol int NOT NULL IDENTITY (1, 1)\n    )\nGO\n\ninsert into #t (groupCol, infoCol) \nvalues ('NoRows',1),      ('NoRows',1),      ('NoRows',1),       --Not in output due to having only 1 disticnt infoCol\n       ('TwoResults',1),  ('TwoResults',1),  ('TwoResults',2),   --In the output with \"'TwoResults', 2\"\n       ('ThreeResults',1),('ThreeResults',2),('ThreeResults',3), --In the output with \"'ThreeResults', 3\"\n       ('ExcludedZero',1),('ExcludedZero',1),('ExcludedZero',0)  --Not in the output due to 0 being excluded for finding distinct infoCol's\n       ('TwoAndZero',1),  ('TwoAndZero',2),  ('TwoAndZero',0)    --In the output but returns 2 not 3.\n\nselect * from #t\n\nselect groupCol, count(groupCol) as distinctInfoCol \nfrom #t \nwhere infoCol &lt;&gt; 0\ngroup by groupCol, infoCol\nhaving count(groupCol) &gt; 1\n\ndrop table #t\n</code></pre>\n\n<p>However the result from my query is </p>\n\n<pre>\ngroupCol       distinctInfoCol\n-------------- ---------------\nExcludedZero   2\nNoRows         3\nTwoResults     2\n</pre>\n\n<p>When I expected my output to be</p>\n\n<pre>\ngroupCol       distinctInfoCol\n-------------- ---------------\nTwoResults     2\nThreeResults   3\nTwoAndZero     2\n</pre>\n\n<p>What am I doing wrong, and how do I correct this to get the results I need?</p>\n"},{"tags":["php","sql","phpexcel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13167307,"title":"Getting the headers in PHPExcel","body":"<p>I am using this piece of code in PHP to query a database and import the data to an excel file. Currently I am getting the data from the database, but I can't get the headers.</p>\n\n<p>Can anyone tell me how to get the headers from the database?       </p>\n\n<pre><code>$objPHPExcel = new PHPExcel();\n\n$col = 1; \nwhile($row_data = mysql_fetch_assoc($result)) {\n    $row = 1;\n    foreach($row_data as $value) {\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n        $row++;\n    }\n    $col++;\n}\n</code></pre>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13168329,"title":"MySQL: Nested SQL using IN","body":"<p>I have a SQL that looks like this:</p>\n\n<pre><code>SELECT * FROM foo WHERE foo.bar IN (SELECT foobar.bar FROM foobar)\n</code></pre>\n\n<p>This is not good, right? The nested SELECT will cause things to slow down? How should I query something like this?</p>\n"},{"tags":["sql","query","sqlite","table","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13167464,"title":"query returning consecutive rows with matching value","body":"<p>assume i have the following table:</p>\n\n<pre><code>data_point (creation_datetime DATETIME PRIMARY KEY, \n            data_point INTEGER);\n</code></pre>\n\n<p>i am looking for an SQL query that would not only tell me if the most recent entry has a data_point value of X, but how many consecutive rows after it also have X as a value.</p>\n\n<p>for instance, assuming the following data:</p>\n\n<pre><code>creation_datetime       data_point\n2012-10-31 12:00:00     0\n2012-10-31 11:55:00     0\n2012-10-31 11:50:00     0\n2012-10-31 11:45:00     2\n2012-10-31 11:40:00     0\n</code></pre>\n\n<p>if i had X=0, the number i would want back here would be 3, because the most recent value matches X, and the next 2 rows also match it.</p>\n\n<p>i don't have any ID column or anything.  i could add one if need be, but i'd like to avoid it.</p>\n\n<p>thanks</p>\n"}]}
{"total":102599,"page":17,"pagesize":100,"questions":[{"tags":["sql","sql-server-2008-r2"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13167837,"title":"Why is nothing selected in this select query?","body":"<p>If I run </p>\n\n<pre><code>Select distinct CompanyID from Device \n</code></pre>\n\n<p>I get 6 rows. If I run</p>\n\n<pre><code>Select CompanyID from Company\n</code></pre>\n\n<p>I get 8441 rows. If I run the following:</p>\n\n<p>If I run </p>\n\n<pre><code>Select CompanyID\nfrom Company where CompanyID NOT IN \n( \n   Select distinct CompanyID from Device\n)\n</code></pre>\n\n<p>I should get the 8435 companies that aren't in the original select statement, correct?</p>\n\n<p>However, when I run this I get 0 rows. What is the issue here? One of the 6 results from above is null but that shouldn't matter. </p>\n\n<p>Thanks!</p>\n\n<p>edit: With Marc-s's help I was able to get the following statement to be what I needed, I still feel like there was an extra step in this query, anyone care to add to this?</p>\n\n<pre><code>DELETE from Company where CompanyID NOT IN\n(\nSelect C.CompanyID \nfrom Company C where C.CompanyID IN \n( \n  Select distinct CompanyID from Device\n)\nOR CompanyID IN\n(\n  Select distinct CustomerID from Device\n)\nOR CompanyID IN\n(\n  Select distinct CompanyID from AssignedCompanies\n )\n )\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13166882,"title":"Cannot get login to work for ODBC driver","body":"<p>I am trying to set up an ODBC driver to SQL Server 2000 and cannot what I am doing wrong. The error I get is <code>sqlstate 28000</code> and <code>error 18456 failed login</code>. </p>\n\n<p>Here are the steps I took: </p>\n\n<ul>\n<li>create a username under computer management</li>\n<li>then in enterprise manager I create login by going to <code>security-&gt;login new login</code> </li>\n<li>From there I browse to the user I created in computer management and windows nt is selected as well as grant access</li>\n<li>then went to database and rolls and gave it read and write permissions for a few databases. The default database is set to master. Everything seems to work just fine up to this point.</li>\n</ul>\n\n<p>Then I go to the ODBC manager and then SysDSN then add and I pick SQL Server. From here I name the DSN, pick the server that has both the windows username and the SQL Server on it and click next. </p>\n\n<p>Then I click SQL Server authentication and enter the username and password, and checked to make sure it was right at least 20 times, and then I get the <code>18456 error</code>.</p>\n\n<p>Am I missing a step, what happened?</p>\n\n<p>Any help is appreciated.</p>\n"},{"tags":["sql","sql-server-2008","tcp","remote-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13161247,"title":"Remote connection to SQL server 2008 sp2","body":"<p>I built a window application in visual studio 2010. It is working fine at my computer. when I trying to run from another computer it gives me an \nError: \n    A network-related or instance-specific error occurred while establishing a connection to     SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. </p>\n\n<p>here some information : \ncomputer ip: 192.168.0.25\nDNS - 192.168.0.12\ninstance - SQLEXPRESS</p>\n\n<p>Connection string : String = \"Data Source=192.168.0.12\\SQLEXPRESS;Initial Catalog=fleetInfo;User ID=user; Password=user123;\"</p>\n\n<p>Im running SQL Server Management Studio 2008 SP2. I checked sql server configuration Manager. Everything is fine.\nIn configuration Manager> protocols for SQLEXPRESS > TCP/IP:\nIP1 \nIP address: 192.168.20.100\nPort : null\nIP ALL\nDynamic port : 1408\nTCP port: null</p>\n\n<p>I'm wondering what is wrong Im doing here.</p>\n\n<p>Thanks guys.</p>\n"},{"tags":["sql","sql-server"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13161401,"title":"calculating age from sysdate and birthdate using SQL Server","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/57599/how-to-calculate-age-in-t-sql-with-years-months-and-days\">How to calculate age in T-SQL with years, months, and days</a>  </p>\n</blockquote>\n\n\n\n<p>I'm simply trying to calc age (in years) using a birthdate variable </p>\n\n<pre><code>1932-04-29 00:00:00.000\n</code></pre>\n\n<p>and SYSDATETIME( ) in SQL Server, where by</p>\n\n<pre><code>SELECT year(Sysdatetime() - Birthdate) as Age\n</code></pre>\n\n<p>produces (surprisingly) : 1980</p>\n\n<p>What did I miss? I expected to get 80!</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13168557,"title":"SQL Oracle Combining Multiple Results Rows","body":"<p>I have the below query</p>\n\n<pre><code>Select \ncase upper(device_model)\n        when 'IPHONE' then 'iOS - iPhone'\n        when 'IPAD' then 'iOS - iPad'\n        when 'IPOD TOUCH' then 'iOS - iPod Touch'\n        Else 'Android'\n        End As Device_Model,\ncount(create_dtime) as Installs_Oct17_Oct30\nFrom Player\nWhere Create_Dtime &gt;= To_Date('2012-Oct-17','yyyy-mon-dd')\nAnd Create_Dtime &lt;= To_Date('2012-Oct-30','yyyy-mon-dd')\nGroup By Device_Model\nOrder By Device_Model\n</code></pre>\n\n<p>This spits out multiple rows of results that read \"Android\"....I would like there to be only 4 results rows, one for each case....so it comes out like this:</p>\n\n<pre><code>Device_Model     Installs_Oct17_Oct30\nAndroid            987\niOS - iPad         12003\niOS - iPhone       8563\niOS- iPod Touch    3482\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13167948,"title":"Exclude value of a record in a group if another is present","body":"<p>In the example table below, I'm trying to figure out a way to sum amount over id for all marks where mark 'C' doesn't exist within an id. When mark 'C' does exist in an id, I want the sum of amounts over that id, excluding the amount against mark 'A'. As illustration, my desired output is at the bottom. I've considered using partitions and the EXISTS command, but I'm having trouble conceptualizing the solution. If any of you could take a look and point me in the right direction, it would be greatly appreciated :)</p>\n\n<p>sample table:</p>\n\n<pre><code>id   mark  amount\n------------------\n1    A     1\n2    A     3\n2    B     2\n3    A     2\n4    A     1\n4    B     3\n5    A     1\n5    C     3\n6    A     2\n6    C     2\n</code></pre>\n\n<p>desired output:</p>\n\n<pre><code>id   sum(amount)\n-----------------\n1    1\n2    5\n3    2\n4    4\n5    3\n6    2\n</code></pre>\n"},{"tags":["sql","oracle","ejb-3.0","bind-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13165356,"title":"binding variables in an EJB query IN clause","body":"<p>Is it possible to bind a list in an EJB IN clause like this?</p>\n\n<pre><code>Query query = myEntitymanager.createNativeQuery(\"SELECT e FROM EntityName e WHERE e.id IN (:ids)\");\n//ids is a List of Long\nquery.setParameter(\"ids\", ids);\nresult = query.getResultSet();\n</code></pre>\n\n<p>Thank you for your help.</p>\n"},{"tags":["sql","performance","sql-server-2005","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":830,"score":-4,"question_id":10926841,"title":"Sql Server 2012 slower than 2005?","body":"<p>We have deployed SQL Server 2012 Enterprise and we have performance issues:</p>\n\n<ul>\n<li>same data (backuped from our SQL Server 2005 Enterprise and restored on 2012)</li>\n<li>test script of 3200 sql SELECT statements</li>\n</ul>\n\n<p>We do tests using Management Studio:</p>\n\n<ol>\n<li>results as plain text</li>\n<li>results in a file</li>\n</ol>\n\n<p>On same computer:</p>\n\n<ol>\n<li>2005 : 15 sec, 2012 : 2 min</li>\n<li>2005 : 14 sec, 2012 : 30 sec</li>\n</ol>\n\n<p>Even with a more powerful computer, 2012 is still slower than 2005.</p>\n\n<p>What can be wrong? The way we installed SQL Server 2012 and default parameters? The way we restored the backup? What can we do?</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13168200,"title":"How to use subquery with multiple tables","body":"<p>I'm trying to create a subquery to bring two tables together but am getting nothing.</p>\n\n<p>Code:</p>\n\n<pre><code>SELECT DISTINCT Agreements.AgrmntID, Agreements.Status, JobSites.SiteName,\n  PurchaseOrderDetails.ExtCost\nFROM Agreements Inner Join\n  JobSites On Agreements.CustSiteID = JobSites.CustSiteID\nWHERE Agreements.Status = 2 And PurchaseOrderDetails.ExtCost = (Select\n    PurchaseOrderDetails.ExtCost\n  FROM PurchaseOrderDetails \n  Inner Join PurchaseOrders On PurchaseOrders.POID = PurchaseOrderDetails.POID\n  WHERE PurchaseOrders.Description Like ('%', JobSites.SiteName, '%') And   \n  Convert(varchar(8),PurchaseOrderDetails.TimeCreated,1) = '09/10/12')\nORDER BY JobSites.SiteName\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>AgreemntID   Status  SiteName  ExtCost\n----------------------------------------\n1            2       TEST01    $144.00\n2            2       TEST02    $400.00\n</code></pre>\n\n<p>I'm using a subquery because there's nothing that links the ExtCost to the SiteName except the Description under PurchaseOrders.</p>\n\n<p>Hopefully this is enough information for you to help me.  Thank you in advance!!</p>\n"},{"tags":["php","sql","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13168120,"title":"MySql PDO connection to database","body":"<p>I am learning PDO and i am getting very confused, I have this piece of code below and all look right to me however am getting this error code and i dont know what I have to do to fix it, please help me :</p>\n\n<pre><code>&lt;?php\n$hostname='localhost';\n$username='root';\n$password='';\n\ntry {\n    $dbh = new PDO(\"mysql:host=$hostname;dbname=stickercollections\",$username,$password);\n    echo 'Connected to Database&lt;br/&gt;';\n\n    $sql = \"SELECT * FROM stickercollections\";\nforeach ($dbh-&gt;query($sql) as $row)\n    {\n    echo $row[\"collection_brand\"] .\" - \". $row[\"collection_year\"] .\"&lt;br/&gt;\";\n    }\n\n\n    $dbh = null;\n    }\ncatch(PDOException $e)\n    {\n    echo $e-&gt;getMessage();\n    }\n?&gt; \n</code></pre>\n\n<hr>\n\n<p>Error Code : <code>Invalid argument supplied for foreach() in /Applications/XAMPP/xamppfiles/htdocs/GOTSWAPMAIN/index.php on line 11</code></p>\n"},{"tags":["sql","group-by"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13167845,"title":"SQL, Group by, merge strings","body":"<p>I have this table:</p>\n\n<pre><code>name    count1    count2   address\nJohn      5         0      London\nJohn      0         3      London\nPhil      1         0      Paris\n</code></pre>\n\n<p>I want to get</p>\n\n<pre><code>name    count1    count2   address\nJohn      5         3      London\nPhil      1         0      Paris\n</code></pre>\n\n<p>So I want to sum count1 and sum count2 and group by name but merge address (since address is always going to be the same for each name)</p>\n"},{"tags":["sql","primary-key"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13156415,"title":"Difference between primary key search and fields search SQL","body":"<p>Is there any difference with performance when we are searching / selecting the records with the primary key and the other fields of same sizes?</p>\n\n<p>Also the comparison in performances of such queries with GUID as primary keys and Int as primary keys will be different?</p>\n"},{"tags":["sql","magento","shopping-cart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13167823,"title":"Magento Error \"SQLSTATE[28000] [1045] Access denied for user\"","body":"<p>I had set up my Magento shopping cart and everything was going well.\nI was inside PHPmyAdmin and only changed some values to eav_entity_store just changed the \"increment_last_id\" from 100,000,002 to 222,000 and \"increment_prefix\" to 5.\nAfter doing so i tried to log back into Magento shopping cart and was prompted with these sets of errors.</p>\n\n<pre><code>SQLSTATE[28000] [1045] Access denied for user 'db147227'@'205.186.176.14' (using password: YES)\n</code></pre>\n\n<p>Trace:</p>\n\n<pre><code>0 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/lib/Zend/Db/Adapter/Pdo/Mysql.php(96): Zend_Db_Adapter_Pdo_Abstract-&gt;_connect()\n1 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/lib/Varien/Db/Adapter/Pdo/Mysql.php(300): Zend_Db_Adapter_Pdo_Mysql-&gt;_connect()\n2 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/lib/Zend/Db/Adapter/Abstract.php(459): Varien_Db_Adapter_Pdo_Mysql-&gt;_connect()\n3 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/lib/Zend/Db/Adapter/Pdo/Abstract.php(238): Zend_Db_Adapter_Abstract-&gt;query('SET NAMES utf8', Array)\n4 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/lib/Varien/Db/Adapter/Pdo/Mysql.php(389): Zend_Db_Adapter_Pdo_Abstract-&gt;query('SET NAMES utf8', Array)\n5 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Resource.php(169): Varien_Db_Adapter_Pdo_Mysql-&gt;query('SET NAMES utf8')\n6 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Resource.php(110): Mage_Core_Model_Resource-&gt;_newConnection('pdo_mysql', Object(Mage_Core_Model_Config_Element))\n7 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(320): Mage_Core_Model_Resource-&gt;getConnection('core_read')\n8 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(335): Mage_Core_Model_Resource_Db_Abstract-&gt;_getConnection('read')\n9 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(355): Mage_Core_Model_Resource_Db_Abstract-&gt;_getReadAdapter()\n10 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Resource/Db/Collection/Abstract.php(134): Mage_Core_Model_Resource_Db_Abstract-&gt;getReadConnection()\n11 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Config.php(1350): Mage_Core_Model_Resource_Db_Collection_Abstract-&gt;__construct(Object(Mage_Core_Model_Resource_Website))\n12 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Config.php(1386): Mage_Core_Model_Config-&gt;getModelInstance('core_resource/w...', Object(Mage_Core_Model_Resource_Website))\n13 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/Mage.php(460): Mage_Core_Model_Config-&gt;getResourceModelInstance('core/website_co...', Object(Mage_Core_Model_Resource_Website))\n14 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Abstract.php(208): Mage::getResourceModel('core/website_co...', Object(Mage_Core_Model_Resource_Website))\n15 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/Abstract.php(213): Mage_Core_Model_Abstract-&gt;getResourceCollection()\n16 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/App.php(602): Mage_Core_Model_Abstract-&gt;getCollection()\n17 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/App.php(460): Mage_Core_Model_App-&gt;_initStores()\n18 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/code/core/Mage/Core/Model/App.php(344): Mage_Core_Model_App-&gt;_initCurrentStore('', 'store')\n19 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/app/Mage.php(640): Mage_Core_Model_App-&gt;run(Array)\n20 /nfs/c08/h04/mnt/147227/domains/shop.avivalabs.com/html/index.php(80): Mage::run('', 'store')\n21 {main}\n</code></pre>\n\n<p>PLEASE i need help, I dont understand what I did wrong, and what these errors mean. I have looked every where and am desperate at this point.</p>\n"},{"tags":["mysql","sql","codeigniter","join","entity-attribute-value"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13167697,"title":"mysql simplifying select query from EAV with multiple joins (codeigniter)?","body":"<p>The current code does not return all rows. </p>\n\n<p>For example if some products don't have category or user activity are excluded from selected rows.</p>\n\n<p>How to simplify that query with working one?</p>\n\n<p>Is there a way to do it with multiple unions or any other (simple) way?</p>\n\n<pre><code>$q = $this-&gt;db-&gt;select('products.id, users_activity.timestamp AS added, products_content.lang, products_content.product_name, products_content.price, products_categories_content.category_name AS category, products_categories_content.category_id AS category_id')\n        -&gt;from('products')\n        -&gt;join('products_content', 'products.id = products_content.product_id')\n        -&gt;join('products_and_categories', 'products.id = products_and_categories.product_id')\n        -&gt;join('products_categories_content', 'products_categories_content.category_id = products_and_categories.category_id')\n        -&gt;join('users_activity', 'users_activity.id = products.id AND users_activity.lang = products_content.lang')-&gt;where('users_activity.type', 'product')\n        -&gt;group_by(array('products.id', 'products_content.lang', 'users_activity.id'))\n        -&gt;limit($limit, $offset)\n        -&gt;order_by($sort_by, $sort_order);\n\nif (strlen($query_array['lang']) &amp;&amp; ! is_numeric($query_array['lang'])) { $q-&gt;like('lang', $query_array['lang']); }\nif (strlen($query_array['product_name'])) { $q-&gt;like('product_name', $query_array['product_name']); }\nif (strlen($query_array['category'])) { $q-&gt;where('category_id', $query_array['category']); }\n\n$return['rows'] = $q-&gt;get()-&gt;result();\n</code></pre>\n"},{"tags":["sql","ms-access"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13166063,"title":"Multiple count based on dynamic criteria","body":"<p>I have two database for which I want to compare the amount of times a case appears.</p>\n\n<p>TAB1:</p>\n\n<pre><code>ID     Sequence\nA2D    1\nA2D    2\nA2D    3\nA3D    1\n</code></pre>\n\n<p>TAB2:</p>\n\n<pre><code>ID     Sequence\nA2D    1\nA2D    2\nA3D    1\nA3D    2\n</code></pre>\n\n<p>Now, for this example, I am trying to get this result:</p>\n\n<pre><code>ID     Table1       Table2\nA2D    3            2\nA3D    1            2\n</code></pre>\n\n<p>I have tried these code without any success:</p>\n\n<pre><code>SELECT R1.ID as ID, COUNT(R1.ID) as Table1, \nCOUNT(R2.ID) as Table2\nFROM TAB1 AS R1, TAB2 AS R2\nWHERE R1.ID = R2.ID\nGROUP BY R1.ID\n</code></pre>\n\n<p>This one gave me wrong count values...</p>\n\n<p>Also, this one simply crash:</p>\n\n<pre><code>select \n    ( \n     select count(*) as Table1\n     from TAB1\n     where ID = R1.ID\n    ),(\n      select count(*) as Table2\n      from TAB2\n      where ID= R1.ID\n     )\nFROM TAB1 AS R1\n</code></pre>\n\n<p>As you can see though, I am trying to have my criteria dynamic. Most examples I found were including basic hard-coded criteria. But for my case, I want the query to look at my first table ID, count the amount of time it appears, do it for the 2nd table with the same ID, then move on to the next ID.</p>\n\n<p>If my question lacks information or is confusing just ask me, I'll do my best to be more precise.</p>\n\n<p>Thanks in advance !</p>\n"},{"tags":["sql","sql-server-2008","merge-replication"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":98,"score":5,"question_id":13009812,"title":"Inserts in Merge Replication database are insanely slow","body":"<p>I have a SQL server that is setup with merge replication to 800 mobile clients running SQL CE.</p>\n\n<p>The server has enough resources and the lines in and out of the company are more than adequate, the replication between clients and the server is generally good but we are getting an intermittent error that I just cannot track down.</p>\n\n<p>Yesterday we needed to insert 550 records into one of our main tables, the only triggers that exist are the standard merge replication ones.</p>\n\n<p>This insert took 14 hours due to it continually getting deadlocked with mobile devices trying to synch.</p>\n\n<p>Does anyone have any advice on how we can avoid locks on inserts and how to speed up the entire process?</p>\n\n<p>------ Update -----</p>\n\n<p>Following on from some comments I've run a profiler over a single insert and I'm seeing a lot of this sort of thing</p>\n\n<pre><code>insert into dbo.MSmerge_current_partition_mappings with (rowlock) (publication_number, tablenick, rowguid, partition_id)\n            select distinct 1, mc.tablenick, mc.rowguid, v.partition_id\n            from dbo.MSmerge_contents mc with (rowlock) \n            JOIN dbo.[MSmerge_JEMProjectME_PromotionResource_PARTITION_VIEW] v with (rowlock) \n            ON mc.tablenick = 286358001\n            and mc.rowguid = v.[rowguid]\n            and mc.marker = @child_marker \n            and v.partition_id in (select partition_id from dbo.MSmerge_current_partition_mappings cpm with (rowlock) JOIN\n                dbo.MSmerge_contents mc2 with (rowlock)\n                ON cpm.rowguid = mc2.rowguid\n                and mc2.marker = @marker)\n            where not exists (select * from MSmerge_current_partition_mappings with (readcommitted, rowlock, readpast) where \n                publication_number = 1 and \n                tablenick = 286358001 and\n                rowguid = v.[rowguid] and\n                partition_id = v.partition_id)\n</code></pre>\n\n<p>For many tables that I'm not meant to be inserting into... could this be a clue?</p>\n"},{"tags":["sql","tsql"],"answer_count":8,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":10493,"score":2,"question_id":420741,"title":"Getting list of tables, and fields in each, in a database","body":"<p>I'm looking at creating a basic ORM (purely for fun), and was wondering, is there a way to return the list of tables in a database and also the fields for every table?</p>\n\n<p>Using this, I want to be able to loop through the result set (in C#) and then say for each table in the result set, do this (e.g. use reflection to make a class that will do or contain xyz).</p>\n\n<p>Further to this, what are some good online blogs for SQL Server? I know this question is really about using system SPs and databases in Sql Server, and I am ok with general queries, so I'm interested in some blogs which cover this sort of functionality.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13163478,"title":"Updates which include auto increment column","body":"<p>I am using PostgreSQL and I would like to update a table which would include an auto number column id. I know it might something very simple but I have done something like this;</p>\n\n<pre><code>CREATE SEQUENCE  SEQ_ID\nMINVALUE 1\nSTART WITH 1\nINCREMENT BY 1\nCACHE 10\n\nupdate trk2\nset (id, track_id, track_point) =\n           (select nextval('seq_id'), trk1.track_fid, trk1.wkb_geometry\n              from track_points_1 as trk1\n             where track_fid = 0)\n</code></pre>\n\n<p>The thing is that it is giving me the following error (<em>code reformatted</em>):</p>\n\n<pre><code>ERROR:  syntax error at or near \"select\"\nLINE 3: set (id, track_id, track_point)=(select nextval('seq_id'), t...\n</code></pre>\n\n<p>Can anybody help please?</p>\n"},{"tags":["sql","perl","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13167778,"title":"returning errors back to user after insert/update","body":"<p>I'm trying to find a good way to return error messages from postgresql back to my client-side application. I've read about RAISE, which appears to be what I want, but I have couple questions. Using Postgresql 9.1.</p>\n\n<p>An overview of what's going on, I'm receiving a JSON object from the client, parse the JSON into a Perl Hash, loop through the keys and do an update/insert on each iteration. The hash keys correlate with the my database table names.</p>\n\n<p>I have 3 sql functions like this (all the same name). One accepts text,timestamp with timezone, and an integer. (query used from <a href=\"http://stackoverflow.com/a/6527838/722238\">http://stackoverflow.com/a/6527838/722238</a>) </p>\n\n<pre><code>-- $1 = Table Key, $2 = Table Value, $3 = Table Name.\ncreate function ex.foo(integer,text,text) Arg2 could be timestamp,text,or integer.  \n    returns void as $$\n    begin\n    execute format('update %3$s set v= %2$L where k = %1$L;\n                insert into %3$s (k,v) select %1$s, %2$L \n                  where not exists (select 1 from %3$s where k = %1$L)', $1,$2,$3);\n    -- RAISE a descriptive error. \n    return;\n    end;\n$$ language 'plpgsql';\n</code></pre>\n\n<p>At the moment, I'm doing this (pseudo-ish code):</p>\n\n<pre><code>if (Begin) {\n    eval {\n        my $tk = 123;\n        foreach my $k (keys %js) {\n            ## tk = table key, $k = table name, $js{$k} = value \n            executeq(\"select ex.foo(tk,$js{$k},$k);\") or die error(pgError); # Function to handle error?\n         }\n         Commit;\n     };\n     if ($@) {\n         RollBack;\n         ## Return $@ \n     }\n}\n</code></pre>\n\n<p>My problem is, I'm not sure how I should generate a descriptive error (where/why), return it up the chain and in language the user can understand. Again, how should I raise the error, and should it be passed to an error handler function? What is the standard? How do others achieve this? </p>\n\n<p>Also, are there issues I may run into while looping through my hash and insert/updating values like this?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13167665,"title":"Sql update big amount of rows","body":"<p>I need to update big amount of rows, something like 100,000.\nProbably one query would be too heavy to the server.</p>\n\n<p>What is the best way to split the update?\nSomething like update 200 rows, sleep a sec, then another 200.</p>\n\n<p>Edit:</p>\n\n<p>Okay I got an answer that it would be okay to do it in one query.\nBut still I'd like to know how to do this.\nAssume I have 1,000,000 rows or more.\nWhat would be the best way to split the query?</p>\n"},{"tags":["sql","tsql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":562,"score":2,"question_id":5711518,"title":"how to get the max size used by a field in table","body":"<p>I have a field which has been set to max size. How can i find the max size occupied by the field.</p>\n\n<p>For example if the records are for table TableA</p>\n\n<pre><code>FieldA\n\n123\nabcd\n1234567\n</code></pre>\n\n<p>I need to know which row occupied the most size and what the size is</p>\n\n<p>Thanks</p>\n\n<p>Prady</p>\n"},{"tags":["sql","ms-access-2007","oracle-xe","rownum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13078813,"title":"Fetching variable number of rows from ms access database based on vaules found on another table","body":"<p>I've spent my whole day trying to come up with a solution for this problem, but I still have no clue:</p>\n\n<p>I have in one table <strong>users</strong> the following fields:</p>\n\n<ul>\n<li>id</li>\n<li>name</li>\n<li>city_id </li>\n<li>score</li>\n</ul>\n\n<p>and in another table <strong>city</strong> two fields:</p>\n\n<ul>\n<li>id</li>\n<li>users_number</li>\n</ul>\n\n<p>What I have to do is to get the top rows from the <strong>users</strong> table as specified by the users_number field in <strong>city</strong> but first, ordering the fetched rows by score. The users quantity is far larger than the value specified by users_number.</p>\n\n<p>My question is: </p>\n\n<p>is there any possibility to select from the table <strong>users</strong> where criteria is number of rows in table <strong>city</strong>? </p>\n\n<p>thank you</p>\n"},{"tags":["sql","database","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13167182,"title":"How can you define a computed column like this?","body":"<p>I have an <code>Equipment</code> table in SQL Server 2008 like this:</p>\n\n<pre><code>CREATE TABLE [dbo].[Equipment](\n[EquipmentID] [nchar](10) NOT NULL,\n[EquipmentName] [nchar](50) NOT NULL,\n[ProducedDate] [date] NOT NULL,\n[WarrantyPeriod] [int] NOT NULL,\n[SerialNumber] [nchar](20) NOT NULL,\n[BrandID] [tinyint] NOT NULL,\nCONSTRAINT [PK_Equipment] PRIMARY KEY CLUSTERED \n)\n</code></pre>\n\n<p>I want to have a computed column <code>WarrantyStatus</code> that will return either <code>Unexpired</code> or <code>Expired</code> when calculating, based on columns <code>ProducedDate</code> and <code>WarrantyPeriod</code>. </p>\n\n<p>This is wrong, but it's what I want:</p>\n\n<pre><code>ALTER TABLE [dbo].[Equipment]\nADD [WarrantyStatus] AS IIF(DATEDIFF(MONTH, [ProducedDate], GETDATE()) &lt; [WarrantyPeriod], \"Unexpired\", \"Expired\")\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13167577,"title":"SQL add month to a query without calendar table","body":"<p>I have a pretty simple table here:</p>\n\n<hr>\n\n<p><strong>Table1</strong><br>\nID<br>\nDate1<br>\nDate2<br>\nDate3  </p>\n\n<hr>\n\n<p>I want to summarize the data by month and ID so the query result comes out like this:</p>\n\n<hr>\n\n<p><strong>Query Result of table1</strong><br>\nID<br>\nMonth<br>\nCount of Date1 from the month that's not null<br>\nCount of Date2 from the month that's not null<br>\nCount of Date3 from the month that's not null    </p>\n\n<hr>\n\n<p>I currently have this query below that only pulls one month depending on what @month is specified to:</p>\n\n<pre><code>Select ID, @month as [Month]  \nSum((Case When Month(Date1)=@month then 1 else 0 END)) as [Date1 Count],   \nSum((Case When Month(Date2)=@month then 1 else 0 END)) as [Date2 Count],  \nSum((Case When Month(Date3)=@month then 1 else 0 END)) as [Date3 Count],  \nFrom Table1  \nGroup by ID \n</code></pre>\n\n<p>But I want to pull <strong>all 12 month</strong>, however the database does not have a month table or calendar table, how can I create a query that will include all 12 month for each IDs and get their corresponding monthly counts for Date1, Date2, and Date3?  Btw, a lot of the entries have one of the Dates empty, e.g. Date1 and Date3 = Null whereas Date2 = '01/01/2008'.  Thanks in advance!</p>\n"},{"tags":["sql","xml","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":7486156,"title":"Update and deleteXML for mutiple rows at same time creates a deadlock","body":"<pre><code>update table X \n   set Y = deleteXML (Y, '/attributes/attribute/properties');\n</code></pre>\n\n<p>This syntax seems to be correctly applied in Oracle to delete a node from the XML root tree and update but my query never finished and this locks the resources in the database. How i can improve this?</p>\n"},{"tags":["sql","sql-server","index"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":48,"score":3,"question_id":13166071,"title":"Index structure to maximize speed across any combination of index columns","body":"<p>I have a database with about five possible index columns, all of which are useful in different ways.  Let's call them System, Source, Heat, Time, and Row.  Using System and Row together will make a unique key, and if sorted by System-Row the database will also be sorted for any combination of the five index variables (in the order I listed them above).</p>\n\n<p>My problem is that I use all combinations of these columns: sometimes I want to JOIN each System-Row to the next System-(Row+1), sometimes I want to GROUP or WHERE by System-Source-Heat, sometimes I want to look at all entries of System-Source WHERE Time is in a specific window, etc.</p>\n\n<p>Basically, I want an index structure that functions similarly to every possible permutation of those five indexes (in the correct order, of course), without actually making every permutation (although I am willing to do so if necessary).  I'm doing statistics / analytics, not traditional database work, so the size of the index and speed of creating / updating it is not a concern; I only care about speeding my improvised queries as I tend to think them up, run them, wait 5-10 minutes, and then never use them again.  Thus my main concern is reducing the \"wait 5-10 minutes\" to something more like \"wait 1-2 minutes.\"</p>\n\n<p>My sorted data would look something like this:</p>\n\n<pre><code>Sys So H Ti R\n1   1  0 .1 1\n1   1  1 .2 2\n1   1  1 .3 3\n1   1  2 .3 4\n1   2  0 .5 5\n1   2  0 .6 6\n1   2  1 .8 7\n1   2  2 .8 8\n</code></pre>\n\n<p>EDIT: It may simplify things a bit that System virtually always needs to be included as the first column to make any of the other 4 columns in sorted order.</p>\n"},{"tags":["sql","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13167682,"title":"How to handle SQL foreign key exceptions in MVC","body":"<p>I have an SQL database connected to my MVC 4 project. In the database I have a table that contains usernames and I have another table that contains details of mobile phones given to users. I have a relationship between the 2 tables with Username as the primary key in the users table and Username as the foreign key in the phones table. So if the user doesn't exist in the users table, an exception is thrown up. My question is how do I validate the username from within my app and display a message to say the user isn't a valid user?</p>\n\n<p>Are there any tutorials that show how to do this?</p>\n"},{"tags":["sql","database","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13167186,"title":"SQLSTATE[22P02]: Invalid text representation","body":"<p>I'm using <strong>Postgresql</strong> and <strong>PHP 5.3.x with PDO</strong> to access the DB.</p>\n\n<p>I have this the SQL query (stripped down version), with a placeholder for PDO to fill in:</p>\n\n<pre><code>INSERT INTO t_articles (a_article_id) VALUES (?) RETURNING a_id\n</code></pre>\n\n<p>I want <code>a_article_id</code> to be either a number, like <code>5</code>, or else it should be the result of the subquery:</p>\n\n<pre><code>((SELECT max(a_article_id) FROM t_articles) + 1)\n</code></pre>\n\n<p>However, PDO says:</p>\n\n<pre><code>SQLSTATE[22P02]: Invalid text representation: 7 ERROR: invalid input syntax for integer: \"(SELECT max(a_article_id) FROM t_articles) + 1\"\n</code></pre>\n\n<p>And I've tried to set the subquery as the default value, but it is not allowed apparently:</p>\n\n<pre><code>ERROR:  cannot use sub query in default expression\n</code></pre>\n\n<p>How can I insert the result of this sub query (or what can be done to achieve the same result)?</p>\n"},{"tags":["mysql","sql","correlated-subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":13165950,"title":"MySQL: dependent subquery select type for uncorrelated subquery","body":"<p>There are DDL statements:</p>\n\n<pre><code>CREATE TABLE t1(\nc1 INT NOT NULL\n);\nCREATE TABLE t2(\nc2 INT NOT NULL\n);\n</code></pre>\n\n<p>My query:</p>\n\n<pre><code>SELECT c1 FROM t1 WHERE c1 NOT IN (SELECT c2 from t2)\n</code></pre>\n\n<p>EXPLAIN output:</p>\n\n<pre><code>id  select_type table   type    possible_keys   key key_len ref rows    Extra\n1   PRIMARY t1  ALL NULL    NULL    NULL    NULL    3   Using where\n2   DEPENDENT SUBQUERY  t2  ALL NULL    NULL    NULL    NULL    3   Using where\n</code></pre>\n\n<p>Subquery doesn't correlate with outer query. Why it's type is DEPENDENT SUBQUERY? </p>\n\n<p>UPD: query is <code>SELECT c1 FROM t1 WHERE c1 NOT IN (SELECT c2 from t2)</code></p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13156038,"title":"Speed up dividing date intervals by minutes in Sql Server","body":"<p>I need to divide some date intervals by minutes. (For example, 2012-01-01 10:00 - 2012-01-01 10:00 interval should be divided into 2012-01-01 10:01, 2012-01-01 10:02, ... 2012-01-01 10:10).\nFor example, there is a table</p>\n\n<pre><code>CREATE TABLE [dbo].[Events](\n    [ID] [int] IDENTITY(1,1) NOT NULL,\n    [EventStart] [datetime] NOT NULL,\n    [EventEnd] [datetime] NOT NULL,\n    [Amount] [float] NOT NULL,\n CONSTRAINT [PK_Events] PRIMARY KEY CLUSTERED \n(\n    [ID] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]\n) ON [PRIMARY]\n\nGO\n</code></pre>\n\n<p>This table is filled like</p>\n\n<pre><code>DECLARE @i integer = 0;\nDECLARE @initial_date datetime = '2012-01-01';\n\nWHILE @i &lt; 50000\nBEGIN\n    INSERT INTO [Events] (EventStart, EventEnd, Amount) VALUES (DATEADD(MINUTE, 10*@i, @initial_date), DATEADD(MINUTE, 10*(@i + 1), @initial_date), @i);\n    SET @i = @i + 1;\nEND\n</code></pre>\n\n<p>As a result we have many 10 minutes intervals.</p>\n\n<p>To divide it by minutes I use the following recursive CTE:</p>\n\n<pre><code>DECLARE @start_date datetime = '2012-01-01';\nDECLARE @end_date datetime = '2013-01-02';\n\n\nWITH Date_Ranges (StatDate, Amount, IntervalStart, CurrentMinute) AS (\n  SELECT \n    DATEADD(MINUTE, 0,  ev.EventStart) AS StatDate, ev.Amount, ev.EventStart AS IntervalStart, 1 AS CurrentMinute\n  FROM [Events] ev\n  WHERE ev.EventStart BETWEEN @start_date AND @end_date\n  UNION ALL\n  SELECT \n    DATEADD(MINUTE, CurrentMinute, ev.EventStart), ev.Amount, ev.EventStart AS IntervalStart, CurrentMinute + 1\n  FROM [Events] ev\n  INNER JOIN Date_Ranges ranges ON (ranges.IntervalStart = ev.EventStart AND \n    ranges.StatDate &gt;= ev.EventStart AND \n    ranges.StatDate &lt; ev.EventEnd)\n    WHERE DATEADD(MINUTE, CurrentMinute, ev.EventStart) BETWEEN @start_date AND @end_date AND\n        ev.EventStart BETWEEN @start_date AND @end_date\n) \n\nSELECT *\nFROM Date_Ranges --ORDER BY StatDate\n</code></pre>\n\n<p>The main problem is too slow execution of this recursive CTE on a large data amount.</p>\n\n<p>So, how can I speed up this?</p>\n"},{"tags":["sql","sql-server-2005","index"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13075245,"title":"SQL Server 2005 IndexOptimize SP against one table's indexes","body":"<p>I'm trying to figure out how to use this <code>IndexOptimize</code> stored procedure that I got from <a href=\"http://ola.hallengren.com/\" rel=\"nofollow\">http://ola.hallengren.com/</a> to run against just a single table's indexes.</p>\n\n<p>When I run the following query:</p>\n\n<pre><code>SELECT * \nFROM sys.dm_db_index_physical_stats (DB_ID(N'database_name'), \n                                     OBJECT_ID(N'dbo.table_name'), \n                                     NULL, NULL , 'DETAILED');'\n</code></pre>\n\n<p>I get this as the result both before and after running the <code>IndexOptimize</code> job:</p>\n\n<p><a href=\"http://cl.ly/image/472J160R1y2n\" rel=\"nofollow\">http://cl.ly/image/472J160R1y2n</a></p>\n\n<p>Here is what I'm trying to run:</p>\n\n<pre><code>EXECUTE dbo.IndexOptimize\n     @Databases = 'database_name',\n     @Indexes = 'database_name.dbo.table_name',\n     @FragmentationLow = NULL,\n     @FragmentationMedium = 'INDEX_REORGANIZE,INDEX_REBUILD_ONLINE',\n     @FragmentationHigh = 'INDEX_REBUILD_ONLINE',\n     @FragmentationLevel1 = 5,\n     @FragmentationLevel2 = 30'\n</code></pre>\n\n<p>The query completes, but it doesn't seem to make a difference to the table's indexes. Am I missing something?</p>\n"},{"tags":["sql","ssis","expressions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13166968,"title":"How to assign a default value to NULL dates using SSIS derived column transformation?","body":"<p>In my SQL 2008 SSIS environment, I have data coming from a CSV file and I need to fix up null dates.</p>\n\n<p>Data from CSV looks like this:</p>\n\n<pre><code>01011990\n01011990\n01011990\n01011990\n01011990\n</code></pre>\n\n<p>In my staging table, I have a column defined as:</p>\n\n<pre><code>[SHIPPED DATE] date NOT NULL\n</code></pre>\n\n<p>First I fix the date values by pushing the column through a derived transformation that has:</p>\n\n<blockquote>\n  <p>(DT_DBDATE)(SUBSTRING([SHIPPED DATE],1,2) + \"/\" + SUBSTRING([SHIPPED DATE],3,2) + \"/\" + SUBSTRING([SHIPPED DATE],5,4))</p>\n</blockquote>\n\n<p>The above transformations makes my string dates coming form CSV import into a date column in my SQL db.</p>\n\n<p>The output of this is:</p>\n\n<pre><code>1990-01-01\n1990-01-01\n1990-01-01\n1990-01-01\n1990-01-01\n</code></pre>\n\n<p><strong><code>Next</code></strong>, I'd like to deal with NULL dates so that I can stay true to the \"NOT NULL\" definition in my db. What I want to do is assign the NULL dates a default value but I get an error message as per below:</p>\n\n<blockquote>\n  <p>Error at CSV to SQL [Derived Column [24817]]: The data types \"DT_WSTR\" and \"DT_DBDATE\" are incompatible for the conditional operator. The operand types cannot be implicitly cast into compatible types for the conditional operation. To perform this operation, one or both operands need to be explicitly cast with a cast operator.</p>\n</blockquote>\n\n<p>My CSV column is WSTR, my destination in the SQL DB is a \"date\" column.</p>\n\n<p>My transformation I am trying to use is:\n    ISNULL([SHIPPED_DATE]) ? \"1900-01-01\" : [SHIPPED_DATE]</p>\n\n<p>It does not want to work due to the above message. Can anyone point me to the right direction?</p>\n"},{"tags":["sql","left-join","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13167161,"title":"I want to Show members where membership has been expired, i'm using two tables with a join","body":"<p>/* Show members where membership has been expired by date */</p>\n\n<pre><code>select m.FirstName, m.LastName, m.SocialSecurityNumber, m.Mobile, m.Email \nfrom Members as m\nJoin Memberships as ms on ms.MemberId = m.Id\nwhere ms.ToDate &lt; '2012-10-31'\n</code></pre>\n\n<p>A member can have more then one membership but only one active membership.\nThis statement gives me to many users, if the user has 4 memberships and 3 has expired it will be displayed 3 times. I only want the member to be included once if he doesn't have any valid membership.</p>\n\n<p>I hope you understand what I am trying to do here. </p>\n"},{"tags":["sql","foxpro"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13150923,"title":"SQL- make all rows show a column value if one of the rows has it","body":"<p>I have an SQL statement for a PICK sheet that returns the header/detail records for an order.\nOne of the fields in the SQL is basically a field to say if there are dangerous goods. If a single product on the order has a code against it, then the report should display that its hazardous.</p>\n\n<p>The problem I am having is that in the SQL results, because I am putting the code on the report in the header section (and not the detail section), it is looking for the code only on the first row.</p>\n\n<p>Is there a way through SQL to basically say \"if one of these rows has this code, make all of these rows have this code\"? I'm guessing a subselect would work here... the problem is, is that I am using a legacy system built on FoxPro and FoxPro SQL is terrible!</p>\n\n<p>EDIT: just checked and I am running VFP8, subqueries in the SELECT statement were added in FVP9 :(</p>\n"},{"tags":["sql","ruby-on-rails","activerecord","ruby-on-rails-3.2","query-optimization"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":204,"score":8,"question_id":13039110,"title":"Why are individual SELECT queries running when an all-encompassing SELECT already ran? (Rails/ActiveRecord)","body":"<p>I have the following code (note the <code>includes</code> and the <code>.each</code>):</p>\n\n<pre><code>subscribers = []\nmailgroup.mailgroup_members.opted_to_receive_email.includes(:roster_contact, :roster_info).each { |m|\n  subscribers &lt;&lt; { :EmailAddress =&gt; m.roster_contact.member_email,\n                   :Name =&gt; m.roster_contact.member_name,\n                   :CustomFields =&gt; [ { :Key =&gt; 'gender', \n                                        :Value =&gt; m.roster_info.gender.present? ? m.roster_info.gender : 'X' \n                                    } ] \n                  } if m.roster_contact.member_email.present?\n}\nsubscribers\n</code></pre>\n\n<p>Correspondingly, I see the following in my logs (i.e. <code>select * from ROSTER_INFO ... IN (...)</code>):</p>\n\n<pre><code>SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` IN ('1450', '1000', '1111')\n</code></pre>\n\n<p>Yet immediately after that there are <code>select * from ROSTER_INFO</code> for each ID already specified in the <code>IN</code> list of the previous query:</p>\n\n<pre><code>RosterInfo Load (84.8ms)  SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` = '1450' LIMIT 1\nRosterInfo Load (59.2ms)  SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` = '1000' LIMIT 1\nRosterInfo Load (56.8ms)  SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` = '1111' LIMIT 1\n</code></pre>\n\n<p>If <code>select *</code> had already been done on <code>ROSTER_INFO</code> on all IDs of interest (<code>IN (...)</code>), why is another <code>select *</code> being done again for each of the same IDs? Doesn't <code>ActiveRecord</code> already know all the <code>ROSTER_INFO</code> columns for each ID?</p>\n\n<p>(Meanwhile, there are no individual queries for <code>ROSTER_CONTACT</code>, yet if I remove <code>:roster_contact</code> from the <code>includes</code> method, then <code>ROSTER_INFO</code> is not queried again, but <code>ROSTER_CONTACT</code> is.)</p>\n\n<hr>\n\n<p><strong>RosterInfo model (abridged)</strong></p>\n\n<pre><code>class RosterInfo &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\nend\n</code></pre>\n\n<p><strong>RosterContact model (abridged)</strong></p>\n\n<pre><code>class RosterContact &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\n\n  has_many :mailgroup_members, foreign_key: 'rosterID'\n  has_many :mailgroups, through: :mailgroup_members\n\n  has_one :roster_info, foreign_key: 'ID'     # can use this line\n  #belongs_to :roster_info, foreign_key: 'ID' # or this with no difference\n\n  def member_name                             # I added this method to this\n    roster_info.member_name                   # question only *after* having\n  end                                         # figured out the problem.\nend\n</code></pre>\n\n<p><strong>RosterWeb model (abridged)</strong></p>\n\n<pre><code>class RosterWeb &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\nend\n</code></pre>\n\n<p><strong>Mailgroup model (abridged)</strong></p>\n\n<pre><code>class Mailgroup &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\n\n  has_many :mailgroup_members, foreign_key: 'mailCatID'\n\n  has_one :mailing_list, foreign_key: :legacy_id\nend\n</code></pre>\n\n<p><strong>MailgroupMember model (abridged)</strong></p>\n\n<pre><code>class MailgroupMember &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\n\n  belongs_to :mailgroup, foreign_key: 'mailCatID'\n  belongs_to :roster_contact, foreign_key: 'rosterID'\n  belongs_to :roster_info, foreign_key: 'rosterID'\n  belongs_to :roster_web, foreign_key: 'rosterID'\n\n  scope :opted_to_receive_email, joins(:roster_web).where('ROSTER_WEB.receiveEmail=?', 1)\nend\n</code></pre>\n"},{"tags":["sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13166566,"title":"sql how to write complicated query for noob?","body":"<p>Here is my tables</p>\n\n<pre><code> Student (sname, sid, gpa, level, deptno) \n Course (cno, cname, deptno, units) \n Dept (dname, deptno) \n Takes (sid, cno) \n</code></pre>\n\n<p>Write a SQL query that returns the names (i.e., snames) of students who have taken \nmore courses outside their department than inside their department.you can \nassume that all students in the database have taken at least one course inside their department.</p>\n\n<p>I am not looking for any solutions for this question, but still welcome for any answer.\nBut I more hoping people can tell me how to generate the steps to write a complicated query like this..</p>\n\n<p>My answer is </p>\n\n<pre><code> Select S.sname\n From Student S, Course C, Dept D, Takes T\n Where T.cno=C.cno and D.deptno=C.deptno and S.sid = T.sid\n Having COUNT(S.deptno=C.deptno) &gt; COUNT( S.deptno != C.deptno)\n</code></pre>\n\n<p>I am not sure I can use the count after HAVING in this way or not .\nThanks</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":13165785,"title":"Calculate hours between two dates","body":"<p>I am trying to make this overview of \"work\" hours</p>\n\n<p>However I can't get it to calculate the hours between two dates in my sql db, but it wont return the result.</p>\n\n<p>I tried to just display the two SQL entries which worked, but it seems like the calculation wont use the SQL enteries</p>\n\n<p>I am getting this error in the top of my page:</p>\n\n<pre><code>Fatal error: Uncaught exception 'Exception' with message 'DateTime::__construct() [&lt;a href='datetime.--construct'&gt;datetime.--construct&lt;/a&gt;]: Failed to parse time string (31/10-2012 19:14) at position 0 (3): Unexpected character' in D:\\xampp\\htdocs\\admin.php:46 Stack trace: #0 D:\\xampp\\htdocs\\admin.php(46): DateTime-&gt;__construct('31/10-2012 19:1...') #1 {main} thrown in D:\\xampp\\htdocs\\admin.php on line 46\n</code></pre>\n\n<p>What am I doing wrong here??</p>\n\n<p>The thing I need help to is on line 43-52\nHere is my code:</p>\n\n<pre><code>&lt;?php\n$host=\"localhost\";\n$username=\"xxxx\";\n$password=\"xxxx\";\n$db_name=\"xxxxx\";\n$tbl_name=\"log\";\n\n\nmysql_connect(\"$host\", \"$username\", \"$password\")or die(\"cannot connect\");\nmysql_select_db(\"$db_name\")or die(\"cannot select DB\");\n\n$sql=\"SELECT * FROM $tbl_name ORDER BY id ASC\";\n$result=mysql_query($sql);\n\n\n?&gt;\n&lt;title&gt;VT Log - Oversigt&lt;/title&gt;\n&lt;table width=\"90%\" border=\"0\" align=\"center\" cellpadding=\"3\" cellspacing=\"1\" bgcolor=\"#CCCCCC\"&gt;\n&lt;tr&gt;\n&lt;td width=\"30%\" align=\"center\" bgcolor=\"#E6E6E6\"&gt;&lt;strong&gt;Navn&lt;/strong&gt;&lt;/td&gt;\n&lt;td width=\"15%\" align=\"center\" bgcolor=\"#E6E6E6\"&gt;&lt;strong&gt;Start&lt;/strong&gt;&lt;/td&gt;\n&lt;td width=\"15%\" align=\"center\" bgcolor=\"#E6E6E6\"&gt;&lt;strong&gt;Slut&lt;/strong&gt;&lt;/td&gt;\n&lt;td width=\"30%\" align=\"center\" bgcolor=\"#E6E6E6\"&gt;&lt;strong&gt;Kommentar&lt;/strong&gt;&lt;/td&gt;\n&lt;td width=\"15%\" align=\"center\" bgcolor=\"#E6E6E6\"&gt;&lt;strong&gt;Tid&lt;/strong&gt;&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;?php\nwhile($rows=mysql_fetch_array($result)){\n?&gt;\n&lt;tr&gt;\n&lt;td align=\"center\" bgcolor=\"#FFFFFF\"&gt;&lt;? echo $rows['user']; ?&gt;&lt;BR&gt;&lt;/td&gt;\n&lt;td align=\"center\" bgcolor=\"#FFFFFF\"&gt;&lt;? echo $rows['start']; ?&gt;&lt;/td&gt;\n&lt;td align=\"center\" bgcolor=\"#FFFFFF\"&gt;&lt;? echo $rows['end']; ?&gt;&lt;/td&gt;\n&lt;td align=\"center\" bgcolor=\"#FFFFFF\"&gt;&lt;? echo $rows['comment']; ?&gt;&lt;/td&gt;\n&lt;?php\n$stamp1 = $rows['start'];\n$stamp2 = $rows['end'];\n$date1 = new DateTime($stamp2);\n$date2 = new DateTime($stamp2);\n$diff = $date2-&gt;diff($date1);\n$hours = $diff-&gt;h;\n$hours = $hours + ($diff-&gt;d*24);\n?&gt;\n&lt;td align=\"center\" bgcolor=\"#FFFFFF\"&gt;&lt;? echo $hours;?&gt;&lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;?php\n}\nmysql_close();\n?&gt;\n&lt;tr&gt;\n&lt;td colspan=\"5\" align=\"center\" bgcolor=\"#E6E6E6\"&gt;&lt;?php echo \"Total arbejdstid: \" . array_sum($numbers) . \"\\n Timer\";?&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["sql","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13166352,"title":"SQL (Access): Multiple values per \"ID\" - Store as TRUE unless any FALSE","body":"<p>Good afternoon!\nI have recently come across an issue that I am hoping can be solved with your help. Our system is [sadly] ran on Access (2007). I have decent experience with SQL and elect to use this method for most of queries rather than the Design View. However, this is the issue I have come across recently:</p>\n\n<p>A table (with its own primary key of course) contains the ParticipantID and Records. This table may contain multiple records per person due to having events at various locations. With this information we track whether or not each record is within our system already due to the location falling under our large \"umbrella\" (Internal). To make it look simple, it looks something like this, ignoring the primary key as we only care about the participant ID.</p>\n\n<pre>\nParticipantID     Internal\n1                 -1\n1                 -1\n2                 0\n3                 -1\n3                 -1\n3                 0\n4                 -1\n4                 0\n</pre>\n\n<p>I want to be able to say if ANY of the records of a participant are not Internal (eg. =0), then in this query's results, store it as 0.\nHence, the results table would look something like:</p>\n\n<pre>\nParticipantID     Internal\n1                 -1\n2                 0\n3                 0\n4                 0\n</pre>\n\n<p>Does this make sense? Thank you in advance! </p>\n"},{"tags":[".net","sql","matlab"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13166346,"title":"Read a row from SQL through .net using MATLAB","body":"<p>I am trying to read a specific row from a SQL table through .net using MATLAB. I am using the following code to that </p>\n\n<pre><code>import System.Data.SqlClient.*   \nimport DataTable.*  \nNET.addAssembly('System.Data');  \nsqlconn = System.Data.SqlClient.SqlConnection();  \nsqlcmd = sqlconn.CreateCommand();      \nconn = SqlConnection('Data Source=B39Q5M1;Initial Catalog=AIR;integrated  \ni=1;  \nlist = [];  \nconn.Open();  \nq = SqlCommand(sqlstring, conn);   \nr = q.ExecuteReader();  \nwhile (r.read())  \nr.GetString(0)  \nend  \nend\n</code></pre>\n\n<p>But this fetches a single element from the row. At least in this case i have a workaround of getting each element and making it an array. But the bigger problem is I dont know whether the table value is int/string. In this case I cant blindly use Getstring coz it throws me an error if the value is int and not string. \nPlease let me know if there is any methods to fetch complete row. Or is there any workaround for this? \nI searched a lot in the sites but all the examples use GetString(0).\nThanks in Advance! </p>\n"},{"tags":["sql","sql-server","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13165703,"title":"SQL update table data query","body":"<p>I want to run update query to update PercentAvailability column value 0 to 100 between specified date period in my case <code>2012-10-28 03:31:01 to 2012-10-28 08:31:01</code>. see following picture.</p>\n\n<p><img src=\"http://i.stack.imgur.com/HQdGV.png\" alt=\"enter image description here\"></p>\n\n<p>How do i run query to update above data between specified date?</p>\n\n<p>Note: I have many ApplicationID which has this issue so how could i run query against all ApplicationID, I believe we need to run JOIN syntax but it would be good if you give some short of hint. </p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13165944,"title":"get the sum of column rows after a mysql JOIN query","body":"<pre><code>$r1 = mysql_query(\"\nSELECT *, SUM(bps.price) as sum FROM accounts \nFULL JOIN bps on bps.id = mid\n\");\necho \"Total price: \".$row['price'].\"&lt;br&gt;\" ;\n    while($row = mysql_fetch_array($r1))\n      {\n      echo $row['name'].\" &lt;b&gt;:::&lt;/b&gt;  \".$row['mid'].\" &lt;b&gt;:::&lt;/b&gt;  \".$row['price'];\n      echo \"&lt;br /&gt;\";\n      }\n</code></pre>\n\n<p>this is my query. I need to get the total(the sum) of the column : bps.price\nsome of the rows have : 10.5 , others -5.5 etc... in other words some are negative values and others are positive.It will list all the results then at the end display the sum of column price.</p>\n"},{"tags":["sql","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13165957,"title":"Trouble integrating a where clause into an existing select statement for reporting purposes","body":"<p>So, I have two queries - one that currently creates a report, and another query I wrote to append more data to the report.</p>\n\n<p>I'd like to merge the new query so the data shows in the same dataset when I call to it in ASP.</p>\n\n<p>I'm having trouble placing the new where clause so that it gives me only what I want. The queries work on their own but I just can't seem to figure out how to get them together without giving me a ton of extra data I'm not looking for.</p>\n\n<p>Here is the original query:</p>\n\n<pre><code>SELECT \ntransactions.date,\ntransactions.Pcode,\ntransactions.L,\ntransactions.iL,  \ntransactions.q,\ntransactions.mTo\nFROM\ntransactions, \nproductlist\nWHERE\ntransactions.Pcode=productlist.Pcode \nAND productlist.client=transactions.client \nAND (transactions.mTo='NotAccepted' OR transactions.mTo = 'TheStage') \nAND transactions.client=232 AND ( tophysical = 'Place1' OR fromphysical = 'Place1' ) \nAND transactions.Date&gt;= '2012-10-01' \nAND transactions.Date &lt;= '2012-10-31 11:59:59 PM ' \nORDER BY\nmTo,\ntransactions.date,\ntransactions.pCode\n</code></pre>\n\n<p>The query I want to integrate is:</p>\n\n<pre><code>SELECT \ntransactions.date,\ntransactions.pcode,\ntransactions.L,\ntransactions.iL,  \ntransactions.qty,\ntransactions.mTo,\nFROM\ntransactions, \nproductlist,\nproductarchive,\nShipping\nWHERE \ntransactions.pcode=productlist.pcode \nAND productlist.client=transactions.client \nAND transactions.mFrom='NotAccepted'\nAND ProductArchive.TrID=Transactions.ID\nAND ProductArchive.StID = Shipping.ID\nAND Shipping.SID LIKE 'BAG%'\nAND transactions.Date&gt;= '2012-10-01' \nAND transactions.Date &lt;= '2012-10-31 11:59:59 PM ' \n</code></pre>\n\n<p>Final Query I came up with that's giving me tens of thousands more records than I want.</p>\n\n<pre><code>SELECT \ntransactions.date,\ntransactions.pCode,\ntransactions.L,\ntransactions.iL,  \ntransactions.q,\ntransactions.mTo\nFROM\ntransactions, \nproductlist, \nshipping,\nProductArchive\nWHERE \ntransactions.pCode=productlist.pCode \nAND productlist.client=transactions.client \nAND (transactions.mTo='NotAccepted' OR transactions.mTo = 'TheStage' OR transactions.mFrom='NotAccepted') \nAND transactions.client=232 \nAND \n( tophysical = 'Place1' OR fromphysical = 'Place1' OR \n    ( ProductArchive.TransID=Transactions.ID\n        AND ProductArchive.StID = Shipping.ID\n        AND Shipping.SID LIKE 'BAG%') \n)\nAND transactions.Date&gt;= '2012-10-01' \nAND transactions.Date &lt;= '2012-10-31 11:59:59 PM ' \nORDER BY\ntransactions.mTo,\ntransactions.date,\ntransactions.pCode\n</code></pre>\n\n<p>Thanks for your time, energy and help! Deeply appreciated :)</p>\n"},{"tags":["sql","linq","query"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1479,"score":5,"question_id":6190620,"title":"how to convert linq query to sql","body":"<p>Just trying to get the sql that is generated by a linq query.</p>\n"},{"tags":["sql","recursion","common-table-expression"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13165398,"title":"Writing a recursive SQL query on a self-referencing table","body":"<p>I have a database with a table called Items, that contains these columns:</p>\n\n<ul>\n<li>ID - primary key, uniqueidentifier  </li>\n<li>Name - nvarchar(256) </li>\n<li>ParentID - uniqueidentifier</li>\n</ul>\n\n<p>The name field can be used to build out a path to the item, by iterating through each ParentId until it equals '11111111-1111-1111-1111-111111111111', which is a root item.</p>\n\n<p>So if you had a table that had rows like</p>\n\n<pre><code>ID                                   Name        ParentID\n-------------------------------------------------------------------------------------\n11111111-1111-1111-1111-111111111112 grandparent 11111111-1111-1111-1111-111111111111\n22222222-2222-2222-2222-222222222222 parent      11111111-1111-1111-1111-111111111112\n33333333-3333-3333-3333-333333333333 widget      22222222-2222-2222-2222-222222222222\n</code></pre>\n\n<p>So if I looked up an item with id '33333333-3333-3333-3333-333333333333' in the example above, i'd want the path</p>\n\n<pre><code>/grandparent/parent/widget \n</code></pre>\n\n<p>returned. i've attempted to write a CTE, as it looks like that's how you'd normally accomplish something like this - but as I don't do very much SQL, I can't quite figure out where i'm going wrong. I've looked at some examples, and this is as close as I seem to be able to get - which only returns the child row.</p>\n\n<pre><code>declare @id uniqueidentifier\nset @id = '10071886-A354-4BE6-B55C-E5DBCF633FE6'\n;with ItemPath as (\n    select a.[Id], a.[Name], a.ParentID \n        from Items a\n            where Id = @id\n\n    union all\n\n    select parent.[Id], parent.[Name], parent.ParentID \n        from Items parent \n            inner join ItemPath as a\n                on a.Id = parent.id\n                    where parent.ParentId = a.[Id]\n)\nselect * from ItemPath\n</code></pre>\n\n<p>I have no idea how i'd declare a local variable for the path and keep appending to it in the recursive query. i was going to try to at least get all the rows to the parent before going after that. if anyone could help with that as well - i'd appreciate it.</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql","string-to-datetime"],"answer_count":10,"favorite_count":4,"up_vote_count":16,"down_vote_count":0,"view_count":81425,"score":16,"question_id":207190,"title":"Sql Server string to date conversion","body":"<p>I want to convert a string like this:</p>\n\n<pre><code>'10/15/2008 10:06:32 PM'\n</code></pre>\n\n<p>into the equivalent DATETIME value in Sql Server.</p>\n\n<p>In Oracle, I would say this:</p>\n\n<pre><code>TO_DATE('10/15/2008 10:06:32 PM','MM/DD/YYYY HH:MI:SS AM')\n</code></pre>\n\n<p><a href=\"http://stackoverflow.com/questions/202243/custom-datetime-formatting-in-sql-server\">This question</a> implies that I must parse the string into one of the <a href=\"http://msdn.microsoft.com/en-us/library/aa226054(SQL.80).aspx\" rel=\"nofollow\">standard formats</a>, and then convert using one of those codes.  That seems ludicrous for such a mundane operation.  Is there an easier way?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","cdc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13162619,"title":"Unable to restart CDC after making table changes","body":"<p>I need to add a couple of columns to CDC for a table that is already being tracked. My approach is as follows:</p>\n\n<pre><code>EXEC sys.sp_cdc_drop_job 'capture'\n\nBEGIN TRANSACTION\n\nBEGIN TRY\n    -- Copy existing data of the tracked table into a temporary table\n    SELECT * INTO CDC.dbo_MyTable_Temp FROM CDC.dbo_MyTable_CT\n\n    -- Add the new column to the temp table. This allows us to just use INSERT..SELECT * later\n    ALTER TABLE CDC.dbo_MyTable_Temp ADD MyColumn INT NULL\n\n    -- Disable CDC for the source table temporarily. This will drop the CDC table\n    EXEC sys.sp_cdc_disable_table @source_schema = 'dbo', @source_name = 'MyTable', @capture_instance = 'dbo_MyTable'\n\n    -- Reenable CDC for the source table. This will recreate the table with the new columns\n    EXEC sys.sp_cdc_enable_table @source_schema = 'dbo', @source_name = 'MyTable', @capture_instance = 'dbo_MyTable', @supports_net_changes = 1, @role_name = NULL, @filegroup_name = 'CDCGROUP'\n\n    -- Insert the old values into the CDC table\n    INSERT INTO cdc.dbo_MyTable_CT SELECT * FROM cdc.dbo_MyTable_Temp\n\n    -- Correct the start_lsn in CDC.change_tables. Otherwise all of the CDC stored procedures will be confused\n    -- and although the old data will exist in the table the functions won't return it\n    UPDATE cdc.change_tables SET start_lsn = (SELECT MIN(__$start_lsn) FROM cdc.dbo_MyTable_Temp) WHERE capture_instance = 'dbo_MyTable'\n\n    -- Drop the temp table\n    DROP TABLE cdc.dbo_MyTable_Temp\n\n    COMMIT TRANSACTION\nEND TRY\nBEGIN CATCH\n    ROLLBACK TRANSACTION\n    RAISERROR('Error!', 16, 1)\nEND CATCH\n\nEXEC sys.sp_cdc_add_job 'capture'\n</code></pre>\n\n<p>However, when the job runs again after being re-added it generates an error that there is a violation of the primary key constraint on <code>CDC.lsn_time_mapping</code>.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","query","insert","where-in"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13165550,"title":"where in sql server query update number list one field to another","body":"<p>I am using SQL Server, and in the query below, I have a concern.  I am not sure if the field on the left will update with the field on the right (coming from the same table) when I do a where in list.</p>\n\n<pre><code>update loc \nset locShortName = locName \nwhere locid in (3,4,11,13,14,15,16,18,19,20,21,24,32,41,45,68,69,77,82,85)\n\nupdate loc set locShortName = locName where locid = 3 (move to next record in the list)      \nupdate loc set locShortName = locName where locid = 4 (move to next record in the list)\nupdate loc set locShortName = locName where locid = 11(move to next record in the list)\n</code></pre>\n\n<p>and so on...</p>\n\n<p>I would think it would take the fist number in the list and address the field value setting, then move to the next in the list.</p>\n\n<p>Are my expectations correct?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","oracle","triggers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":54,"score":-3,"question_id":13138264,"title":"Why the column is not modified in the trigger?","body":"<pre><code>CREATE TABLE EMP\n(\n  EMP_ID      NUMBER PRIMARY KEY,\n  SALARY      NUMBER,\n  OLD_SALARY  NUMBER\n);\n\n\nCREATE OR REPLACE TRIGGER UPDATE_SALARY\nAFTER UPDATE ON EMP\nFOR EACH ROW\nDECLARE\nPRAGMA AUTONOMOUS_TRANSACTION;\nBEGIN\n   UPDATE EMP SET OLD_SALARY = :OLD.SALARY WHERE EMP_ID = :OLD.EMP_ID;\n   COMMIT;\nEXCEPTION\nWHEN OTHERS THEN NULL;\nEND UPDATE_SALARY;\n</code></pre>\n\n<p>Why the column <code>old_salary</code> is not modified ?</p>\n"},{"tags":["java","sql","postgresql","insert","mybatis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13165349,"title":"MyBatis Get Last Insert Id","body":"<p>I have a Java POJO:</p>\n\n<pre><code>public class Widget {\n    private int id;\n    private String name;\n    // ...\n}\n</code></pre>\n\n<p>I am trying to use MyBatis to insert a new <code>Widget</code> into the <code>widget</code> table of my Postgres database, and for this insert method to inject the passed-in POJO with the auto-generated id of the newly-inserted <code>widget</code> table record:</p>\n\n<pre><code>// Notice the widget's id is left null.\nWidget w = new Widget(\"name-of-widget\");\n\nWidgetMapperImpl widgetMapper = new WidgetMapperImpl();\nwidgetMapper.insertWidget(w);\n\n// At runtime this prints null (the id is not being set).\nSystem.out.println(w.getId());\n</code></pre>\n\n<p>And <code>WidgetMapper.java</code>:</p>\n\n<pre><code>public interface WidgetMapper {\n    public void insertWidget(@Param(\"widget\") Widget widget);\n}\n</code></pre>\n\n<p>Here is the <code>WidgetMapper.xml</code>:</p>\n\n<pre><code>&lt;mapper namespace=\"com.myapp.WidgetMapper\"&gt;\n    &lt;cache flushInterval=\"360000\" /&gt;\n\n    &lt;resultMap id=\"WidgetMapperResult\" type=\"com.myapp.Widget\"&gt;\n        &lt;result property=\"id\" column=\"widget_id\"/&gt;\n        &lt;result property=\"name\" column=\"widget_name\" /&gt;\n    &lt;/resultMap&gt;\n\n    &lt;insert id=\"insertWidget\" parameterType=\"com.myapp.Widget\" useGeneratedKeys=\"true\" keyProperty=\"id\"&gt;\n        INSERT INTO\n            myapp.widgets\n            (\n                widget_name\n            )\n            VALUES\n            (\n                #{widget.name}\n            );\n\n            &lt;selectKey keyProperty=\"id\" resultType=\"int\" order=\"AFTER\"&gt;\n                SELECT CURRVAL('widget_id_seq') AS widget_id\n            &lt;/selectKey&gt;\n    &lt;/insert&gt;\n&lt;/mapper&gt;\n</code></pre>\n\n<p>Again, this code compiles and builds fine. At runtime, after I call <code>widgetMapper.insertWidget(Widget)</code>, and then try to access that's <code>Widget</code>'s id, it is null, so the ID-injection is not working. Can anyone spot why? Thanks in advance!</p>\n"},{"tags":["asp.net","sql","sql-server-2008","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12526117,"title":"Error showing up Fill: SelectCommand.Connection property has not been initialized","body":"<pre><code>  DataSet ds = new DataSet();\n\n    SqlDataAdapter cmd = new SqlDataAdapter(\"Select * FROM event\", con);\n    cmd.Fill(ds, \"Table\");\n</code></pre>\n\n<p>Getting the same error again and again tried everything</p>\n\n<p>please help</p>\n"},{"tags":["sql","google-maps","table","add"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":11711823,"title":"insert a google maps code into a table column","body":"<p>i use this query</p>\n\n<p>$sq=\"UPDATE <code>contact</code> SET <code>\".$pType.\"</code>='\".$content.\"'\";</p>\n\n<p>it works fine but until i enter this code to the text area</p>\n\n<pre><code>&lt;iframe width=\"710\" height=\"450\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"http://maps.google.com/maps?f=q&amp;amp;source=s_q&amp;amp;hl=en&amp;amp;geocode=&amp;amp;q=Yenimahalle,+Gersan,+Ankara,+T%C3%BCrkiye&amp;amp;aq=0&amp;amp;oq=gersan+&amp;amp;sll=39.982382,32.760887&amp;amp;sspn=0.157578,0.308647&amp;amp;ie=UTF8&amp;amp;hq=&amp;amp;hnear=Bat%C4%B1+Sitesi+Mh.,+Gersan,+Ankara%2FYenimahalle,+Turkey&amp;amp;t=m&amp;amp;ll=39.955543,32.696342&amp;amp;spn=0.029607,0.060854&amp;amp;z=14&amp;amp;iwloc=A&amp;amp;output=embed\"&gt;&lt;/iframe&gt;&lt;br /&gt;&lt;small&gt;&lt;a href=\"http://maps.google.com/maps?f=q&amp;amp;source=embed&amp;amp;hl=en&amp;amp;geocode=&amp;amp;q=Yenimahalle,+Gersan,+Ankara,+T%C3%BCrkiye&amp;amp;aq=0&amp;amp;oq=gersan+&amp;amp;sll=39.982382,32.760887&amp;amp;sspn=0.157578,0.308647&amp;amp;ie=UTF8&amp;amp;hq=&amp;amp;hnear=Bat%C4%B1+Sitesi+Mh.,+Gersan,+Ankara%2FYenimahalle,+Turkey&amp;amp;t=m&amp;amp;ll=39.955543,32.696342&amp;amp;spn=0.029607,0.060854&amp;amp;z=14&amp;amp;iwloc=A\" style=\"color:#0000FF;text-align:left\"&gt;View Larger Map&lt;/a&gt;&lt;/small&gt;\n</code></pre>\n\n<p>it updates but with missing information</p>\n\n<p>like this</p>\n\n<pre><code>&lt;iframe width=\"710\" height=\"450\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"http://maps.google.com/maps?f=q\n</code></pre>\n\n<p>what could be the possible problem. im stuck.i cant see anything</p>\n\n<p>thanks</p>\n"},{"tags":["sql","dictionary"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13165368,"title":"Should an SQL Dictionary table have an IDENTITY column","body":"<p>My application needs a generic lookup table <code>Dictionary</code> that should only be referenced by <code>KEY  {VARCHAR(N) UNIQUE}</code></p>\n\n<p>Is there any reason I should not set <code>KEY</code> to be the primary key?  </p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":48,"score":-2,"question_id":13163955,"title":"Find row which has unique values with respect to some of its columns","body":"<p>My SQL table is something like this:</p>\n\n<pre><code>id, name, value1, value2, value3, value4\n1, xyz, 1, 2, 4, 1\n2, xyz, 4, 2, 4, 1\n3, abc, 4, 2, 4, 1\n4, abc, 4, 2, 2, 1\n5, abc, 4, 2, 2, 1\n</code></pre>\n\n<p>I want to write a Sql query which returns rows which has <strong>any</strong> of their values (read: value1,value2,value3,value4) changed. So the result output would be:</p>\n\n<pre><code>id, name, value1, value2, value3, value4\n1, xyz, 1, 2, 4, 1\n2, xyz, 4, 2, 4, 1\n4, abc, 4, 2, 2, 1\n</code></pre>\n\n<p>I understand, if I just needed values in output I could have used Distinct or Group by like:</p>\n\n<pre><code>select distinct value1,value2,value3,value4 from table;\n</code></pre>\n\n<p>But, here I need id and name columns too in output.</p>\n\n<p>Wondering if I really need to write a subquery or create virtual/inner table to get my result. Or, there is a smarter way?</p>\n\n<p>My question is not similar to <a href=\"http://stackoverflow.com/questions/6941049/how-to-find-out-whether-a-table-has-some-unique-columns\">How to find out whether a table has some unique columns</a>. Let me know if you think otherwise, I can clarify.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13164215,"title":"Display column names with out datatype in MYSQL","body":"<p><code>show columns from table_name;</code> </p>\n\n<p>The above MYSQL command, displays all column names with data types in a table. I want only the column names with out other information.</p>\n\n<p>Any kind of help is appreciated. Thanks.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13163679,"title":"MYSQL SUM Query With Group By and Join Issue","body":"<p>I am using MYSQL with PHP to do the server side scripting.  I am having trouble trying to build a query that aggregates some review data that needs to be joined with some information about who the review is for.</p>\n\n<p>I have two tables.  One called \"schools\" with general information about a school and another called \"reviews\" with the user supplied review information.</p>\n\n<p>The school table is structured as:</p>\n\n<p>id, schoolName, schoolCity, schoolCountry (for the field names)</p>\n\n<p>With example return data as:</p>\n\n<p>1, ASD, Dubai, UAE <br/>\n2, DAA, Dubai, UAE</p>\n\n<p>etc.</p>\n\n<p>The \"reviews\" table has 57 columns:</p>\n\n<p>RID, schoolID, profileID, dateCreated, Q1, Q2, Q3,...Q51, Q52, freeReview (as field names)</p>\n\n<p>with data returned like:</p>\n\n<p>1, 8, 55, 2012-10-10 05:16:05, 10, 8, 9, 2, 3....</p>\n\n<p>From Q1 to Q25, these are questions within a review form that are returned as integers between 0-10.  The other columns tie to a profile table and the school table (as above).</p>\n\n<p>I am able to create a query for an individual school that SUMS all of the reviews for the given school and generates an average score for the school based on the number of reviews submitted for that school.</p>\n\n<p>What I am having trouble with is I would like to create a page that lists all (broken up by pagination) the schools in a table with that averaged and SUM-ed score.</p>\n\n<p>This is the query I have that generates the overall average score for a school.</p>\n\n<pre><code>$singlereviewtotal = mysql_query(\"\nSELECT ROUND(\n((SUM(Q1+Q2+Q3+Q4+Q5+Q6+Q7+Q8+Q9+Q10+Q11+Q12+Q13+Q14+Q15+\nQ16+Q17+Q18+Q19+Q20+Q21+Q22+Q23+Q24+Q25+Q26+Q27+Q28+Q29+Q30+\nQ31+Q32+Q33+Q34+Q35+Q36+Q37+Q38+Q39+Q40+Q41+Q42+Q43+Q44+Q45+\nQ46+Q47+Q48+Q49+Q50+Q51+Q52)/((52*10)*\n(SELECT COUNT(*) FROM reviews WHERE schoolID='$schoolvalue')))*10), 2)\nAS total\nFROM reviews\nWHERE schoolID='$schoolvalue'\") or die(mysql_error()); \n</code></pre>\n\n<p>This generates the correct summed and averaged value of all of the columns and rows, which is rounded to 2 decimals.  The WHERE clause comes from a PHP value in the page that tells the query which school ID to use.</p>\n\n<p>This is my attempt to try to get all of the schools into a list.</p>\n\n<pre><code>$sumreviews = mysql_query(\"SELECT *, \n ROUND(\n ((Q1+Q2+Q3+Q4+Q5+Q6+Q7+Q8+Q9+Q10+Q11+Q12+Q13+Q14+Q15+\n Q16+Q17+Q18+Q19+Q20+Q21+Q22+Q23+Q24+Q25+Q26+Q27+Q28+Q29+Q30+\n Q31+Q32+Q33+Q34+Q35+Q36+Q37+Q38+Q39+Q40+Q41+Q42+Q43+Q44+Q45+\n Q46+Q47+Q48+Q49+Q50+Q51+Q52)/(52*10)\n *10),2) AS atotal \n FROM reviews\n RIGHT JOIN schools ON schools.SID = reviews.schoolID\n GROUP BY schools.schoolName, reviews.schoolID\n ORDER BY atotal DESC\")or die(mysql_error()); \n</code></pre>\n\n<p>This query gives me the list of schools, yet the output for \"atotal\" only gives me the SUM of the first row for that given school (which in this case is 7.31 - and can be seen just below in the output, but the averaged score should be 7.23).</p>\n\n<p>If I remove the GROUP BY in the query above I get the list of all of the schools, plus extra rows for some schools who have more reviews - like American School of Dubai.</p>\n\n<blockquote>\n  <p>School Name,                    City,     Country,     Rating<br>\n  American School of Dubai,     Dubai,        U.A.E.      7.31<br>\n  Dubai American Academy,           Dubai,        U.A.E.  7.19<br>\n  American School of Dubai,     Dubai,        U.A.E.  7.15<br>\n  International School of Bangkok,      Bankok,    Thailand<br>\n  American School of Rio de Janeiro, Rio,     Brazil<br><br>\n  American School of Budapest,      Budapest,  Hungary<br><br>\n  Zurich International School,      Zurich,    Switzerland<br></p>\n</blockquote>\n\n<p>I am wondering, how to construct the query so that the \"AS atotal\" rows for all the given schools are grouped and averaged?  If I averaged the 7.31 with the 7.15 listed as individual review scores for the American School of Dubai, I would have the correct 7.23.  The answer is just right there, but I can't seem to connect it together.</p>\n\n<p>I apologize in advance for my lack of question \"styling\"!</p>\n"},{"tags":["php","sql","cakephp"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1086,"score":2,"question_id":6272748,"title":"CakePHP - Setting up the default value for a Form->input : I want to have a line break, but how?","body":"<p>I have a form input whose default value I want to have as a couple of short paragraphs. eg in my view:</p>\n\n<pre><code>echo $this-&gt;Form-&gt;input('story', array('default'=&gt;'Thanks for visiting my campaign page. Be sure to check out the links below'));\n</code></pre>\n\n<p>At the minute that works ok and creates a text box filled with those two sentences, but I'd prefer to have them on two different lines. And also saved in the DB as such so when they're recalled they automatically appear in two paragraphs. I've tried <p> tags etc but they just turn up in the text.</p>\n\n<p>Is there some way to create a line break when setting the default value in the view which will be stored in the DB as a line break etc...?</p>\n"},{"tags":["sql","database","oracle","plsql","plsqldeveloper"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":59,"score":0,"question_id":13158067,"title":"Enter the loop based on user parameter","body":"<p>There are 4 parameters .material,Suppliernbr,Suppliername,Materail code.My query is if the user enters any of the parameter with a single value in a single parameter i need to enter into the loop.</p>\n\n<pre><code>For Eg:\nP_suppname='stack'\np_matrl='NULL'\np_suppnbr:=NULL\nP_mtrlcde='NULL' I can go inside \n</code></pre>\n\n<p>But if </p>\n\n<pre><code>P_suppname=NULL\np_matrl=211\np_suppnbr:=43443443\nP_mtrlcde='NULL' I shouldnt go.\n</code></pre>\n\n<p>ALSO </p>\n\n<pre><code>P_suppname=NULL\np_matrl='211;2322'\np_suppnbr:=NULL\nP_mtrlcde='NULL' I should nt go\n</code></pre>\n\n<p>How to do this??</p>\n"},{"tags":["sql","sql-server","sum","divide"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13163395,"title":"SQL division giving wrong answer","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11112462/what-is-wrong-with-this-sql-server-query-division-calculation\">What is wrong with this SQL Server query division calculation?</a>  </p>\n</blockquote>\n\n\n\n<p>I am dividing two values in SQL like </p>\n\n<pre><code>SELECT SUM(totalCalls), \n    SUM(EnteredBTN), \n    SUM(EnteredBTN) * 100 / SUM(totalCalls),\n    SUM(EnteredACC), \n    SUM(EnteredACC) / SUM(totalCalls), \n    SUM(SentToTrans),\n    SUM(SentToTrans) * 100 / SUM(totalCalls),\n    SUM(Complete_Information), \n    SUM(Complete_Information) * 100 / SUM(SentToTrans) \n</code></pre>\n\n<p>Now when I do <code>SUM(EnteredACC)/SUM(totalCalls)</code> i.e <strong>7/48</strong>, it should give me <strong>.14</strong> but it gives <strong>0</strong> instead.</p>\n\n<p>When I do <code>SUM(EnteredACC)*100/SUM(totalCalls)</code> it should give <strong>14.58</strong> (or <strong>15</strong> when rounded off) but it gives <strong>14</strong> as the result. Can anyone help please?</p>\n"},{"tags":["php","sql","query","duplicates","ignore"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13163474,"title":"Do Not Duplicate VALUE if already exist on MySQL","body":"<p>I've been trying to accomplish this, but as other issues I just can't figured it out. I've been reading around for posibles solutions but non of them goes along with my code, or if they do I can't figure out how or where to use them.</p>\n\n<p>I have a DB where a user sends records. The database consist in few tables containing the Following \"<strong>Name, Lastname, Phone</strong>\". If any of this values is duplicate,  I would like my code to identify and <strong>Ignore</strong> the submission of the Form <strong>if ALL this VALUES already exist on the DB</strong>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>        &lt;?php\n\n        $con = mysql_connect(\"HOST\",\"USER\",\"PASS\");\n        if (!$con)\n          {\n          die('Could not connect: ' . mysql_error());\n          }\n\n        mysql_select_db(\"testdb\", $con);\n        $sql=\"INSERT INTO people (Name, LastName, Phone)\n        VALUES\n        ('$_POST[Name]','$_POST[LastName]','$_POST[Phone]')\";\n\n        if (!mysql_query($sql,$con))\n          {\n          die('Error: ' . mysql_error());\n          }\n\n        echo \"Record Added\";\n\n        mysql_close($con);\n        ?&gt;\n</code></pre>\n\n<p>Like I said, I've tried may ways but can't figure it out yet, I'm starting to learn, so excuse me if is something very simple. Thanks a lot everyone!!</p>\n"},{"tags":["mysql","sql","pivot","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13159227,"title":"SQL Dynamic Columns","body":"<p>I have the below SQL statement. The column wrapupcode can be up to four values:</p>\n\n<p>Sales, Service, Meeting, Other</p>\n\n<p>When the SQL is run, the column wrapupcode is showing as a single column. What I would like to work out, is to dynamically create a new wrapupcode based on the value. We may added or remove the codes, otherwise I would case for the value.</p>\n\n<p>This is based on a MySQL database.</p>\n\n<p></p>\n\n<p>Data currently looks like:</p>\n\n<pre><code>user  wrapupcode  intialtime  endofwrapup  timediff\njoe   Service     11:38       11:39        1\njenny Sales       11:35       11:36        1\njoe   Service     11:41       11:42        1\n</code></pre>\n\n<p>But would like to see if its possible via SQL on a MySQL database:</p>\n\n<pre><code>user  Service  Sales     timediff\njoe   2                  2\njenny          1         1\n</code></pre>\n\n<p>I can do the sum/avg for the times and totals, its just adding a new column on each different wrapupcode.</p>\n\n<pre><code>SELECT\n     ( SELECT loginid FROM `axpuser` WHERE age.userid = axpuser.pkey ) as user,\n     ( SELECT name FROM `breakcode` WHERE age.wrapupcode = pkey ) as wrapupcode,\n     time(age.`instime`) as initialtime,\n     age.`ENDOFWRAPUPTIME` AS endofwrapup,\n     timediff(age.`ENDOFWRAPUPTIME`, time(age.`instime`)) as timediff\n  FROM\n     agentcallinformation age\n  WHERE\n     age.endofwrapuptime IS NOT null and ( SELECT name FROM `breakcode` WHERE age.wrapupcode =   pkey ) &lt;&gt; ''\n</code></pre>\n"},{"tags":["php","mysql","sql","error-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":11157763,"title":"Fixing PHP PEAR error","body":"<p>I am trying to connect to MYSQL database and cannot. I believe it has something to do with the PEAR error, and I\"ve looked at this answer but it has been of no use. </p>\n\n<p><a href=\"http://stackoverflow.com/questions/62658/getting-pear-to-work-on-xampp-apache-mysql-stack-on-windows\">Getting PEAR to work on XAMPP (Apache/MySQL stack on Windows)</a></p>\n\n<p>My code is the following: </p>\n\n<pre><code>require 'DB.php';\nrequire 'formhelpers.php';\n\n$db = DB::connect('mysql://root:password@localhost/test');\nif (DB::isError($db)) { die(\"connection error: \" . $db-&gt;getMessage( )); }\n$db-&gt;setErrorHandling(PEAR_ERROR_DIE);\n\n//create table for responses \n$q = $db-&gt;query(\n    \"CREATE TABLE apiResponse(\n    Name VARCHAR(20),\n    Occupation VARCHAR(20)\");\n\n//select data to send\n$db = DB::connect('mysql://root:password@localhost/test');\n$q = $db-&gt;query('SELECT Name, Occupation FROM try2 ');\nwhile ($row = $q-&gt;fetchRow())\n{\n$Name = $row[0];\n$Occupation = $row[1];\n\n$q = $db-&gt;query(\n\"INSERT INTO apiResponse (Name, Occupation) values ($Name, $Occupation)\"\n);\n</code></pre>\n\n<p>And I get the following errors:</p>\n\n<p>Warning: require(formhelpers.php) [function.require]: failed to open stream: No such file or directory in C:\\xampp\\htdocs\\myfiles\\Testing API Script.php on line 10</p>\n\n<p>Fatal error: require() [function.require]: Failed opening required 'formhelpers.php' (include_path='.;C:\\xampp\\php\\PEAR') in C:\\xampp\\htdocs\\myfiles\\Testing API Script.php on line 10</p>\n\n<p>Now, according to the other answer, this is a problem with finding PEAR. I have located the php.ini file and found the include statement. It is PHP's default setting for include_path is \".;/path/to/php/pear\" which is what the answer suggested.</p>\n\n<p>My questions:</p>\n\n<ol>\n<li><p>The file that needs to be corrected is the php.ini file in xamp? (I previously downloaded php straight from php.net)</p></li>\n<li><p>I have both a php.ini for development and for production... which one do I edit?</p></li>\n<li><p>The .ini file opens in notepad, I'm not sure this is the correct place to edit it. Confirmation?</p></li>\n</ol>\n"},{"tags":["sql","database","hierarchical-data"],"answer_count":4,"favorite_count":126,"up_vote_count":117,"down_vote_count":0,"view_count":14633,"score":117,"question_id":4048151,"title":"What are the Options for Storing Hierarchical Data in a Relational Database?","body":"<p><strong>Good Overviews</strong></p>\n\n<p>Generally speaking you're making a decision between fast read times (e.g. nested set) or fast write times (adjacency list). Usually you end up with a combination of the options below that best fit your needs. The following provides some in depth reading: </p>\n\n<ul>\n<li><a href=\"http://vadimtropashko.wordpress.com/2008/08/09/one-more-nested-intervals-vs-adjacency-list-comparison/\" rel=\"nofollow\">One more Nested Intervals vs. Adjacency List comparison</a>: <em>the best comparison</em> of Adjacency List, Materialized Path, Nested Set and Nested Interval I've found. </li>\n<li><a href=\"http://www.slideshare.net/billkarwin/models-for-hierarchical-data\" rel=\"nofollow\">Models for hierarchical data</a>: slides with good explanations of tradeoffs and example usage</li>\n<li><a href=\"http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/\" rel=\"nofollow\">Representing hierarchies in MySQL</a>: very good overview of Nested Set in particular</li>\n<li><a href=\"http://troels.arvin.dk/db/rdbms/links/#hierarchical\" rel=\"nofollow\">Hierarchical data in RDBMSs</a>: most comprehensive and well organized set of links I've seen, but not much in the way on explanation </li>\n</ul>\n\n<p><strong>Options</strong></p>\n\n<p>Ones I am aware of and general features:  </p>\n\n<ol>\n<li><a href=\"http://en.wikipedia.org/wiki/Adjacency_list\" rel=\"nofollow\">Adjacency List</a>: \n<ul>\n<li>Columns: ID, ParentID</li>\n<li>Easy to implement. </li>\n<li>Cheap node moves, inserts, and deletes. </li>\n<li>Expensive to find level (can store as a computed column), ancestry &amp; descendants (Bridge Table combined with level column can solve), path (Lineage Column can solve).      </li>\n<li>Use <a href=\"http://en.wikipedia.org/wiki/Common_table_expressions\" rel=\"nofollow\">Common Table Expressions</a> in those databases that support them to traverse. </li>\n</ul></li>\n<li><a href=\"http://en.wikipedia.org/wiki/Nested_set_model\" rel=\"nofollow\">Nested Set</a> (a.k.a Modified Preorder Tree Traversal)\n<ul>\n<li>Popularized by Joe Celko in numerous articles and his book <a href=\"http://rads.stackoverflow.com/amzn/click/1558609202\" rel=\"nofollow\">Trees and Hierarchies in SQL for Smarties</a> </li>\n<li>Columns: Left, Right</li>\n<li>Cheap level, ancestry, descendants</li>\n<li>Compared to Adjacency List, moves, inserts, deletes more expensive. </li>\n<li>Requires a specific sort order (e.g. created). So sorting all descendants in a different order requires additional work. </li>\n</ul></li>\n<li><a href=\"http://communities.bmc.com/communities/docs/DOC-9902\" rel=\"nofollow\">Nested Intervals</a>\n<ul>\n<li>Combination of Nested Sets and Materialized Path where left/right columns are floating point decimals instead of integers and encode the path information. In the later development of this idea nested intervals gave rise to <a href=\"http://vadimtropashko.files.wordpress.com/2011/07/ch5.pdf\" rel=\"nofollow\">matrix encoding</a>.</li>\n</ul></li>\n<li><a href=\"http://intelligent-enterprise.informationweek.com/showArticle.jhtml;jsessionid=MRBJR2LLRV1ANQE1GHPSKH4ATMY32JVN?articleID=219400252\" rel=\"nofollow\">Bridge Table</a> (a.k.a. <a href=\"http://dirtsimple.org/2010/11/simplest-way-to-do-tree-based-queries.html\" rel=\"nofollow\">Closure Table</a>: some good ideas about how to use triggers for maintaining this approach)\n<ul>\n<li>Columns: ancestor, descendant</li>\n<li>Stands apart from table it describes.</li>\n<li>Can include some nodes in more than one hierarchy.</li>\n<li>Cheap ancestry and descendants (albeit not in what order)</li>\n<li>For complete knowledge of a hierarchy needs to be combined with another option.</li>\n</ul></li>\n<li><a href=\"http://evolt.org/node/4047/\" rel=\"nofollow\">Flat Table</a>\n<ul>\n<li>A modification of the Adjacency List that adds a Level and Rank (e.g. ordering) column to each record. </li>\n<li>Expensive move and delete</li>\n<li>Cheap ancestry and descendants </li>\n<li>Good Use: threaded discussion - forums / blog comments</li>\n</ul></li>\n<li><a href=\"http://www.ferdychristant.com/blog//articles/DOMM-7QJPM7\" rel=\"nofollow\">Lineage Column</a> (a.k.a. <a href=\"http://communities.bmc.com/communities/docs/DOC-9902\" rel=\"nofollow\">Materialized Path</a>, Path Enumeration)\n<ul>\n<li>Column: lineage (e.g. /parent/child/grandchild/etc...)</li>\n<li>Limit to how deep the hierarchy can be. </li>\n<li>Descendants cheap (e.g. <code>LEFT(lineage, #) = '/enumerated/path'</code>)</li>\n<li>Ancestry tricky (database specific queries) </li>\n</ul></li>\n</ol>\n\n<p><strong>Database Specific Notes</strong> </p>\n\n<p><em>MySQL</em></p>\n\n<ul>\n<li><a href=\"http://explainextended.com/2009/09/29/adjacency-list-vs-nested-sets-mysql/\" rel=\"nofollow\">Use session variables for Adjacency List</a> </li>\n</ul>\n\n<p><em>Oracle</em></p>\n\n<ul>\n<li>Use <a href=\"http://www.ypl.com/oracle/sql/hierarchical_queries/html_deep/index.html\" rel=\"nofollow\">CONNECT BY</a> to traverse Adjacency Lists</li>\n</ul>\n\n<p><em>PostgreSQL</em></p>\n\n<ul>\n<li><a href=\"http://www.postgresql.org/docs/current/static/ltree.html\" rel=\"nofollow\">ltree datatype</a> for Materialized Path </li>\n</ul>\n\n<p><em>SQL Server</em></p>\n\n<ul>\n<li><a href=\"http://msdn.microsoft.com/en-us/magazine/cc794278.aspx\" rel=\"nofollow\">General summary</a></li>\n<li>2008 offers <a href=\"http://msdn.microsoft.com/en-us/library/bb677290.aspx\" rel=\"nofollow\">HierarchyId</a> data type appears to help with Lineage Column approach and expand the depth that can be represented. </li>\n</ul>\n"},{"tags":["php","html","sql","css"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":48,"score":-1,"question_id":13163257,"title":"list out data with format in php","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13162682/list-out-data-with-format-in-php\">list out data with format in php</a>  </p>\n</blockquote>\n\n\n\n<p>I know already know how to show php data from SQL with:</p>\n\n<pre><code>$php = mysql_query(\"SELECT * FROM base\");\n\nwhile($row = mysql_fetch_array($php))\n\n{\n\nprint $row['data'];\n\n}\n</code></pre>\n\n<p>That outputs in the following format, only 1 data in 1 line:</p>\n\n<pre><code>| data A |\n\n| data B |\n\n| data C |\n\n| data D |\n\n| data E |\n</code></pre>\n\n<p>I would like to however format my data in columns of 3 as seen below:</p>\n\n<pre><code>| data A | | data B | | data C |\n\n| data D | | data E | | data F |\n\n| data G | | data H | | data I |\n</code></pre>\n\n<p>How can I do this in PHP? Any tips, examples or a nudge in the right direction would be appreciated.</p>\n"},{"tags":["php","html","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13163269,"title":"PHP update sql record","body":"<p>Somehow I get my sql error while trying to update a record in my sql db</p>\n\n<p>Here's my current code</p>\n\n<p>html form:</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;title here&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"end.php\" method=\"POST\"&gt;\n&lt;input type=\"text\" id=\"comment\" name=\"comment\" placeholder=\"Kommentar\"&gt;&lt;p&gt;\n&lt;input type=\"submit\" value=\"Stop arbejde\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>end.php</p>\n\n<pre><code>&lt;?php\n$host=\"localhost\";\n$username=\"root\";\n$password=\"password\";\n$db_name=\"db\";\n$tbl_name=\"log\";\n\nmysql_connect(\"$host\", \"$username\", \"$password\")or die(\"cannot connect\");\nmysql_select_db(\"$db_name\")or die(\"cannot select DB\");\n\n$comment=$_POST['comment'];\n$datetime=date(\"y/m/d H:i:s\");\n$editit=date(\"W/D\");\n\n$sql=\"UPDATE log SET end=$datetime, comment=$comment WHERE editid='$editit'\";\n$result=mysql_query($sql);\n\nif($result){\necho \"Successful&lt;BR&gt;\";\n}\nelse {\necho \"Fejl\";\n}\nmysql_close();\n?&gt;\n</code></pre>\n\n<p>What am I doing wrong since I get that error \"Fejl\" ?</p>\n"},{"tags":["sql","database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13159778,"title":"2 phases commit for distributed transactions: what if commit failed?","body":"<p>I have 2 servers participating in 2PC scenario:</p>\n\n<pre><code>* Srv1: votes OK\n* Srv2: votes OK\n* Coordinator runs \"commit\"\n* Srv1: commits\n* Srv2: does not accept \"commit\" command because of network failure\n</code></pre>\n\n<p>From this moment my distributed DB is not consistence anymore.</p>\n\n<p>How it should be solved?</p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13162953,"title":"Simple query return the same register","body":"<p>I have a problem with the return of a simple query </p>\n\n<p><strong>Table San_ChaveBematech</strong></p>\n\n<pre><code>ID     Chave_Id     Credenciada_Id    Recibo   Impresso\n55     571678       10                Test     0\n</code></pre>\n\n<p><strong>Table San_CadastraBematech</strong></p>\n\n<pre><code>ID     Maquina          Credenciada\n5      000FEAB63D89     10\n6      003067D6A4E7     10\n7      003067D6A4D4     10\n</code></pre>\n\n<p><strong>Query That I has some problem</strong></p>\n\n<pre><code>SELECT San_ChaveBematech.Recibo\nFROM San_ChaveBematech\nJOIN San_CadastraBematech\nON San_ChaveBematech.Credenciada_Id = San_CadastraBematech.Credenciada\nWHERE San_ChaveBematech.Credenciada_Id = \n       (SELECT top 1 credenciada \n        FROM San_CadastraBematech \n        WHERE maquina = '000FEAB63D89')\nAND San_ChaveBematech.Impresso = 0\n</code></pre>\n\n<p><strong>How It Works</strong></p>\n\n<p>I have an application (Windows Form) where my user will be registered. I'll save her register in my <code>San_CadastraBematech</code> table. In my web application I can get some keys and, when I get it, I'll save the data in <code>San_ChaveBematech</code> table. To print it, I do the query that I put here, but look, I have just one register in <code>San_ChaveBematech</code> but my query return the same register 3 times.</p>\n\n<p>Can somebody help me ?</p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13163139,"title":"Sort by Character column 'priority' in sql","body":"<p>I have a table with a coulmn name priority with values :</p>\n\n<pre><code>Urgent, medium, low, high.\n</code></pre>\n\n<p>I want to apply order by such that after order by values are ordered like this:</p>\n\n<pre><code>urgent\nhigh \nmedium\nlow\n</code></pre>\n\n<p>How can I do This</p>\n"},{"tags":["sql","xml","relational-database"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":68,"score":5,"question_id":13135164,"title":"XML to SQL conversion","body":"<p>I know this is not a very straightforward question, but how would you design a SQL database in order to store data coming from a XML file?, (you have no XML schema, just a plain XML with a lots of different tagnames, attributes and nested elements).</p>\n\n<p>This is more conceptual than technical. How we go from hierarchical data model  (XML) to relational model (SQL). </p>\n"},{"tags":["mysql","sql","table","sorting","delete"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":51,"score":0,"question_id":13162249,"title":"Sort by multiple keys a sql table and save top 10 results","body":"<p>I have a sql tabel with multiple columns like this:</p>\n\n<pre><code>NAME   CITY      POINTS\nJohn   Detroit   1456\nDavid   Miami    1365\nMary   Denver    789\nDavid  Atlanta   5565\nJohn   Reno      4785\nJohn   London    785\nMary   Rome      4578\n</code></pre>\n\n<p>I want to sort first by NAME and after by POINTS to have a result like this:</p>\n\n<pre><code>David  Atlanta   5565\nDavid   Miami    1365\nJohn   Reno      4785\nJohn   Detroit   1456\nJohn   London    785\nMary   Rome      4578\nMary   Denver    789\n</code></pre>\n\n<p>After that I need to save in my table only the first 10 records ordered by name (10 of David, 10 of John, 10 of Mary and so on) deleting the others. </p>\n\n<p>Anyone can help me?</p>\n\n<hr>\n"},{"tags":["sql","django","oracle","unit-testing","django-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13162771,"title":"django how to see sql query when running tests?","body":"<p>One of my django application unit test fails with</p>\n\n<pre><code>DatabaseError: ORA-00942: table or view does not exist\n</code></pre>\n\n<p>I would like to see actual SQL query that caused this error. Do you know how to achieve that?</p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":474,"score":4,"question_id":8169471,"title":"How to count number of occurences of a character in a varchar?","body":"<p>How can I count number of occurrences of the character <code>-</code> in a varchar2 string?</p>\n\n<p>Example:</p>\n\n<pre>\nselect XXX('123-345-566', '-') from dual;\n----------------------------------------\n2\n</pre>\n"},{"tags":["sql","sql-server","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13162397,"title":"SQL - Execute stored procedure for all values in a table","body":"<p>I have a SQL stored procedure <strong>'A'</strong> which validates certain bank account information for a given account and it accepts the account number as an argument <strong>'arg1'</strong></p>\n\n<p>I want to execute the procedure for all values present in <strong>Column X</strong> of another table <strong>XXX</strong> (all bank Accounts present in the Accounts table)</p>\n\n<p>I am not sure if something like this would work</p>\n\n<pre><code>exec A @arg1 = X from XXX\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["php","mysql","sql","implode"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":445,"score":1,"question_id":5918088,"title":"Implode 2 separate arrays?","body":"<p>I have a script with a query that gathers information from a db from two separate tables using a join. Now I want to insert those 2 arrays and their values side by side inside a new table.</p>\n\n<pre><code>$query = \"INSERT INTO `new_table` \n            (column_a, column_b) \n          VALUES \n            (implode(something,$array_a), implode(something,$array_b))\"\n</code></pre>\n\n<p>Obviously the syntax isn't right, but I was wondering if it was possible or if I'm on the wrong track. I tried a few queries and couldn't get them to line up for an insert - it exploded them one at a time.</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13162220,"title":"View from 2 tables and 2 record from another","body":"<p>I have table SOME_TABLE with column SOME_ID.\nI also have table ANOTHER_TABLE with column SOME_TABLE_SOME_ID (FOREIGN KEY), TYPE, CONTENT</p>\n\n<p>There is 1 or 2 records in ANOTHER_TABLE for one record in SOME_TABLE.</p>\n\n<p>I would like to have view as below:</p>\n\n<pre><code>SOME_ID, CONTENT_TYPE_A, CONTENT_TYPE_B\n</code></pre>\n\n<p>I have sql statement:</p>\n\n<pre><code>SELECT\nST.SOME_ID,\nTYPE_A.CONTENT CONTENT_TYPE_A, \nTYPE_B.CONTENT CONTENT_TYPE_B\nFROM SOME_TABLE ST\nLEFT OUTER JOIN ANOTHER_TABLE TYPE_A\nON ST.SOME_ID=TYPE_A.SOME_TABLE_SOME_ID \nLEFT OUTER JOIN ANOTHER_TABLE TYPE_B\nON ST.SOME_ID=TYPE_B.SOME_TABLE_SOME_ID \nWHERE\nTYPE_A.TYPE = 'A'\nAND\nTYPE_B.TYPE = 'B'\n</code></pre>\n\n<p>This query returns only results for SOME_TABLE if both records in ANOTHER_TABLE exist (with TYPE='A' and TYPE='B').</p>\n\n<p>How to get view when for corresponding SOME_TABLE record exist only 1 record in ANOTHER_TABLE?</p>\n\n<p>I would like to have null value in CONTENT_TYPE_A or CONTENT_TYPE_B when there is now record.</p>\n"},{"tags":["sql","patterns"],"answer_count":8,"favorite_count":4,"up_vote_count":6,"down_vote_count":1,"view_count":9679,"score":5,"question_id":20484,"title":"Use a LIKE clause in part of an INNER JOIN","body":"<p>Can/Should I use a LIKE criteria as part of an INNER JOIN when building a stored procedure/query? I'm not sure I'm asking the right thing, so let me explain.</p>\n\n<p>I'm creating a procedure that is going to take a list of keywords to be searched for in a column that contains text. If I was sitting at the console, I'd execute it as such:</p>\n\n<pre><code>SELECT Id, Name, Description\n  FROM dbo.Card\n WHERE Description LIKE '%warrior%' \n       OR\n       Description LIKE '%fiend%' \n       OR \n       Description LIKE '%damage%'\n</code></pre>\n\n<p>But a trick I picked up a little while go to do \"strongly typed\" list parsing in a stored procedure is to parse the list into a table variable/temporary table, converting it to the proper type and then doing an INNER JOIN against that table in my final result set. This works great when sending say a list of integer IDs to the procedure. I wind up having a final query that looks like this:</p>\n\n<pre><code>SELECT Id, Name, Description\n  FROM dbo.Card\n       INNER JOIN @tblExclusiveCard ON dbo.Card.Id = @tblExclusiveCard.CardId\n</code></pre>\n\n<p>I want to use this trick with a list of strings. But since I'm looking for a particular keyword, I am going to use the LIKE clause. So ideally I'm thinking I'd have my final query look like this:</p>\n\n<pre><code>SELECT Id, Name, Description\n  FROM dbo.Card\n       INNER JOIN @tblKeyword ON dbo.Card.Description LIKE '%' + @tblKeyword.Value + '%'\n</code></pre>\n\n<p>Is this possible/recommended?</p>\n\n<p>Is there a better way to do something like this?</p>\n\n<hr>\n\n<p>The reason I'm putting wildcards on both ends of the clause is because there are \"archfiend\", \"beast-warrior\", \"direct-damage\" and \"battle-damage\" terms that are used in the card texts.</p>\n\n<p>I'm getting the impression that depending on the performance, I can either use the query I specified or use a full-text keyword search to accomplish the same task? </p>\n\n<p>Other than having the server do a text index on the fields I want to text search, is there anything else I need to do?</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13155212,"title":"Join tables and select entries < x hours","body":"<p>I have a mysql database with two tables that look like this:</p>\n\n<p>Table games</p>\n\n<pre><code>id    startTime(DateTime)\n1     2012-10-30...\n</code></pre>\n\n<p>Table prices</p>\n\n<pre><code>gameID  priceTime(DateTime)   price(int)\n1       2012-10-30 18:...     899\n1       2012-10-28 15:...     699\n</code></pre>\n\n<p>I'm trying to join the tables and select only prices 24 hours before games.startTime.\nIs this possible?</p>\n"},{"tags":["sql","sql-server","database","email","triggers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":42,"score":-5,"question_id":13161237,"title":"Need advice on triggers in SQL Server","body":"<p>I am not much into SQL Server triggers etc and I have a question which may be very basic/simple.</p>\n\n<p>Questions</p>\n\n<ol>\n<li><p>I have a table in the SQL Server database which I want to send out emails to me whenever any records gets added/modified/deleted from that table (including if anyone truncates the table). </p></li>\n<li><p>I would also like to receive an email whenever any table or database restore takes place. </p></li>\n</ol>\n\n<p>Please suggest how to complete the above. I know I have to write triggers etc but I need some advice/assistance here.</p>\n"},{"tags":["sql","sql-server-2012-express"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13160129,"title":"SQL Query: last, second last, third last..value (Microsoft SQL)","body":"<p>I am trying to build reports for sport team. The results are stored in a SQL-Database like this:\n<img src=\"http://i.stack.imgur.com/dIWPj.jpg\" alt=\"Table\"></p>\n\n<p>For the reports I need the columns Home2-Away4 to be filled with the corresponding results.\nWhich means: </p>\n\n<p>Imagine: ID=10 and Home(no.) (Team#) = 1 --> <strong>Home1</strong> = result <strong>one</strong> game before which is ID=3 and the team played away and the result was 0 (=home1). This is what I already have done, but <strong>Home2</strong> = result <strong>two</strong> games ago, as <strong>Home3</strong>=result <strong>three</strong> games ago and so on.</p>\n\n<p>And here is how I have done this:</p>\n\n<pre><code>SELECT top 1 [result_home] from (SELECT Top 2 [result_home] FROM \n(SELECT top 2 [result_home]  from [Table]\nwhere [ID] &lt; 10  and ( [Home(no.)]=1 or [Away(No.)]=1 ) order by [ID] desc  ) top2     )top1 \n</code></pre>\n\n<p>(Microsoft SQL Server Express 2012 btw.)</p>\n\n<p>I have written a small Java code which decides if to pick from result_home or result_away.</p>\n\n<p>The basic question is: How is it possible to query for game results two and more gamedays ago?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Kind regards</p>\n\n<p>Stefan</p>\n"},{"tags":["sql","ms-access"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13161441,"title":"SQL ACCESS - Dividing rows by a specific total over time","body":"<p>I have a SQL database to which I connect with Access.</p>\n\n<p>The data is structured as follows:</p>\n\n<pre><code>Date    ELEMENT     VALUE\n01-2010 ElementA    12\n01-2010 ElementB    43\n01-2010 ElementC    53\n01-2010 ElementD    24\n01-2010 El_Divisor  120\n02-2010 ElementA    54\n02-2010 ElementB    32\n02-2010 ElementC    48\n02-2010 ElementD    21\n02-2010 El_Divisor  130\netc etc....\n</code></pre>\n\n<p>I will need to obtain, for each point in time, each element divided by \"ElementDivisor\", i.e.</p>\n\n<pre><code>Date    ELEMENT     VALUE\n01-2010 ElementA    = 12 / 120\n01-2010 ElementB    = 43 / 120\n01-2010 ElementC    = 53 / 120\n01-2010 ElementD    = 24 / 120\n01-2010 El_Divisor  = 120 / 120 = 1\n02-2010 ElementA    = 54 / 130\n02-2010 ElementB    = 32 / 130\n02-2010 ElementC    = 48 / 130\n02-2010 ElementD    = 21 / 130\n02-2010 El_Divisor  = 130 / 130 = 1\netc etc....\n</code></pre>\n\n<p>Note: the \"El_Divisor\" is NOT the total of all the other elements.\nAt the moment I am using a very not elegant multiple cross-tab system, which is very sub-optimal.</p>\n\n<p>Anyone has an idea?\nIdeas in other SQL-programs are very welcome as well.</p>\n\n<p>Many thanks</p>\n"},{"tags":["sql","sql-server","sql-server-2008","stored-procedures"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":13159526,"title":"Split values over multiple rows","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5493510/turning-a-comma-separated-string-into-individual-rows\">Turning a Comma Separated string into individual rows</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following output from a stored procedure and was wondering the best way to split the values into multiple rows.</p>\n\n<pre><code>reference   name                            subjects       subjectstitle\nLL9X81MT    Making and Decorating Pottery   F06,F27,F38       NULL\n</code></pre>\n\n<p>I need to trim the subjects field at the comma's and duplicate the information over three rows so the data would be as follows.</p>\n\n<pre><code>reference   name                            subjects       subjectstitle\nLL9X81MT    Making and Decorating Pottery   F06       NULL\nLL9X81MT    Making and Decorating Pottery   F27       NULL\nLL9X81MT    Making and Decorating Pottery   F38       NULL\n</code></pre>\n\n<p>I'm using MS SQL Server 2008 to setup these SP's and just need some help on how to split the subjects field up.</p>\n\n<p>Thanks,</p>\n"},{"tags":["mysql","sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13161359,"title":"NOT DISTINCT query in mySQL","body":"<p>I have been asked to create a query for this on a simple employee database columns include:</p>\n\n<p>ninumber - first name - last name - address - SuperVisorNiNumber </p>\n\n<p>The employees and supervisors are all held in the same table and are referenced by their ninumbers. The query I've been asked to build is: </p>\n\n<p>v. Find the NI Numbers, first and last names of employees and NI numbers of supervisors where the employees share that supervisor and both employees and supervisors work in department 8. You will refer to the employee relation twice was done in query vi of Practical 2. Your results should be presented in columns with the following titles ‘Employee NI number’, ‘First Name’, ‘Last Name’ and ‘Supervisor NI Number’.</p>\n\n<p>Therefore I created this query: </p>\n\n<pre><code>SELECT e1.ninumber,\n       e1.fname,\n       e1.minit,\n       e1.lname,\n       e1.address,\n       e1.superNiNumber,\n       COUNT(*) AS nrOfOccurences\nFROM   employee AS e1,\n       employee AS e2\nWHERE  e1.dno = 8\n   AND e1.superNiNumber = e2.ninumber\n   AND e2.dno = 8\nGROUP  BY e1.superNiNumber\nHAVING COUNT(*) &gt; 1\n</code></pre>\n\n<p>I couldn't do a not distinct query to work out this part of the question - \"where the employees share that supervisor\". This query returns a grouping of the rows which in turn hides some of the rows I want to show. </p>\n\n<p>My question is: Is my query correct for the question and can I do a NON DISTINCT query in mySQL to get the database to return all of the fields instead of grouping them together.</p>\n\n<p>Reutrn results from my query </p>\n\n<pre><code>NInumber    fname  minit    lname   address    supervisorNiNum     number of occerences\n666666601   Jill    J   Jarvis  6234 Lincoln, Antrim, UK    666666600   2\n666666607   Gerald  D   Small   122 Ball Street, Letterkenny, IRL   666666602   3\n666666604   Billie  J   King    556 WAshington, Antrim, UK  666666603   2\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["c#","sql","xml","asp.net-mvc-4"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13156068,"title":"XML to List<T> in MVC 4","body":"<p>I'm calling a webservice, which returns XML with students. I need to store all students in my database (existing student table). </p>\n\n<p>Right now I have this XMLStudentParser class that gets the XML, but I'm lost at how to proceed in storing each student record to the database. Do I use the XMLReader to loop through the students and add each student to a <code>List&lt;Student&gt;</code>, and then save that list to the database?</p>\n\n<p><strong>Remote XML via webservice.</strong> </p>\n\n<pre><code>&lt;Response&gt;\n  &lt;Result&gt;True&lt;/Result&gt;\n  &lt;Table&gt;\n    &lt;Students&gt;\n      &lt;Student&gt;\n        &lt;StudentID&gt;14165&lt;/StudentID&gt;\n        &lt;StudentName&gt;Jeff Smith&lt;/StudentName&gt;\n        &lt;GroupId&gt;9109&lt;/GroupId&gt;\n      &lt;/Student&gt;\n      &lt;Student&gt;\n        &lt;StudentID&gt;14168&lt;/StudentID&gt;\n        &lt;StudentName&gt;Mary Jones&lt;/StudentName&gt;\n        &lt;GroupId&gt;9109&lt;/GroupId&gt;\n      &lt;/Student&gt;\n    &lt;/Students&gt;\n  &lt;/Table&gt;\n&lt;/Response&gt;\n</code></pre>\n\n<p><strong>My Student model</strong></p>\n\n<pre><code>public class Student\n{\n    public int StudentId { get; set; }\n    public string FullName { get; set; }\n\n    public int GrpId { get; set; }\n}\n</code></pre>\n\n<p>How would the best practice code look to:</p>\n\n<ul>\n<li>Get the XML from the webservice</li>\n<li>Parse each student</li>\n<li>Store each student in the database</li>\n</ul>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13161044,"title":"Checking if a given date fits between a range of dates","body":"<p>If I have 2 date columns in a table, <code>startDate</code> and <code>endDate</code>.  How do I return rows where a given date fits between those 2 dates?  For example:</p>\n\n<p>If the given date is <code>2012-10-25</code></p>\n\n<p>It should return the following rows</p>\n\n<pre><code>startDate   -   endDate\n2012-10-25  -   2012-10-25\n2011-09-10  -   2013-11-15\n2012-10-20  -   2012-10-25\n2012-10-23  -   2012-10-28\n2012-09-14  -   2012-10-28\n</code></pre>\n\n<p>from the following rows:</p>\n\n<pre><code>startDate   -   endDate\n2012-10-25  -   2012-10-25\n2011-09-10  -   2013-11-15\n2012-01-11  -   2012-10-11\n2012-10-20  -   2012-10-25\n2012-04-15  -   2012-04-16\n2012-05-20  -   2012-05-25\n2012-12-01  -   2012-12-10\n2012-10-23  -   2012-10-28\n2012-09-14  -   2012-10-28\n2012-11-13  -   2012-12-15\n</code></pre>\n\n<p>Is this possible with sql?</p>\n\n<p>I am using sql server 2008.</p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":13161264,"title":"Arithmetic overflow error converting varchar to data type numeric. '10' <= 9.00","body":"<p>Below is a subset of the kind of table structure and data i'm working with.</p>\n\n<pre><code>CREATE TABLE #Test\n(\n     Val varchar(5)\n    ,Type varchar(5)\n)\n\nINSERT #Test VALUES ('Yes','Text')\nINSERT #Test VALUES ('10','Int')\nINSERT #Test VALUES ('10.00','Float')\nINSERT #Test VALUES ('9.00','Float')\nINSERT #Test VALUES ('9','Int')\n</code></pre>\n\n<p>I want to write a query that will let me know if the column 'Val' is &lt;= 9.00 (must be of numeric data type). I did this by doing the following:</p>\n\n<pre><code>SELECT *\nFROM\n    (\n        SELECT Val\n        FROM #Test\n        WHERE Type = 'Int'\n    ) IntsOnly\nWHERE IntsOnly.Val &lt;= 9.00\n</code></pre>\n\n<p>This gives me an arithmetic overflow error. However, if I exclude the row of data with the value '10':</p>\n\n<pre><code>SELECT *\nFROM\n    (\n        SELECT Val\n        FROM #Test\n        WHERE Type = 'Int'\n        AND Val &lt;&gt; '10'\n    ) IntsOnly\nWHERE IntsOnly.Val &lt;= 9.00\n</code></pre>\n\n<p>It works without any issue. <strong>My question is not how to fix this as I know I can simply convert the data to the format I require.</strong></p>\n\n<p>My question is why the value of '10' in the column 'Val' is returning an error. Surely the logic should just return 'False' and simply exclude the rows because '10' (which I assume is implicitly converted) is greater than 9.00.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13160913,"title":"Table A except Table B (relating more than one column)","body":"<p>I successfully query this:</p>\n\n<pre><code>SELECT * FROM tableA\nWHERE NOT (column1 IN \n(SELECT column1 FROM tableB) AND columnDate='9999-12-31');\n</code></pre>\n\n<p>Where <code>tableA</code> has around 35000k (35million) records and <code>tableB</code> has 5k (5 thousand).\nI retrieve all records from <code>tableA</code> except <code>tableB</code> in less than 5 minutes.</p>\n\n<p>The problem is when I try (for another example with the same records volume) to achieve the same result using 3 columns (keys):</p>\n\n<pre><code>SELECT * FROM tableA\nWHERE NOT (column1 || column2 || column3 IN \n(SELECT column1 || column2 || column3 FROM tableB) AND columnDate='9999-12-31');\n</code></pre>\n\n<p>I retrieve all records from <code>tableA</code> except <code>tableB</code> in 1 hour and 40 minutes....!</p>\n\n<p>Can I query it more efficiently?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sqlperformance"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13161170,"title":"MSSQL Server 2008 Performance issue with very strange resolution","body":"<p>I'm a long time DBA (12 years in SQL). I'm running sql2008 enterprise in a win 2008 clustered environment. 128gb memory and 32cpu in each cluster node. Not wimpy.</p>\n\n<p>I've got the wierdest performance issue I've seen to date, and its baffling me why it would occur...looking for ideas.</p>\n\n<p>Occasionally, maybe 2-3 times per week, the performance of queries made by the application to the database will come to a crawl. SPs that normally execute in 500ms, suddenly are up arond 50 seconds. Forget about saving data...application .net code will time out before the data even makes the trip.</p>\n\n<p>First time this happened was about 4 weeks ago. I kicked off a profiler so I could see if there were excessive queries or something, and didnt see anything strange. So, I copied one of the batches from the profile and executed it in SSMS. From that moment, the performance was perfect again. Application was snappy and no issues.</p>\n\n<p>Next time it happened, I remembered that just running a batch in ssms seemed to \"fix\" the issue. So I took some benchmarks first and did it again. Same thing. Running ANY batch in SSMS relieves whatever is happening. I have reproduced this about 15-18 times over the past 4 weeks: The application comes to a crawl, and then I run any query in ssms, and all is well.</p>\n\n<p>This is obviously a problem. In order to find out what is running or going on, I have to run a batch--which makes the problem stop. SO the act of trying to observe the issue resolves it. GAH!</p>\n\n<p>Note: There are two clustered instances running on the same node. Only one of the two experiences this issue. And they are roughly the same size in terms of disk space and activity.</p>\n\n<p>Anyone ever seen this?</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1292,"score":3,"question_id":907366,"title":"Self-join of a subquery","body":"<p><br />\nI was wondering, is it possible to join the result of a query with itself?</p>\n\n<p>(I'm using PostgreSQL)</p>\n"},{"tags":["asp.net","sql","sql-server-2008","c#-4.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13159468,"title":"Date format Issue in SQL Server or ASP.NET","body":"<p>When I run a stored procedure in SQL Server 2008 CTP I get date <code>\"2012-10-31 00:00:00.000\"</code> with this format. </p>\n\n<p>But when I am converting it using</p>\n\n<pre><code>Convert.ToString(drConversation[\"ConversationDate\"])\n</code></pre>\n\n<p>in C#, I am getting <code>\"10/31/2012 12:00:00 AM\"</code>.</p>\n\n<p>Where should be problem? In C# code or in SQL Server?</p>\n"},{"tags":["c#","sql","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13160549,"title":"Gridview update button","body":"<p>I have a GridView with a button which sets all rows into edit mode (which is what I want).  However I was wondering if there is a way to create a button that will update the whole gridview with my changes.  Here is the code behind this.</p>\n\n<pre><code>&lt;asp:GridView ID=\"gvUsers\" runat=\"server\" AutoGenerateColumns=\"False\" \n        onrowcommand=\"gvUsers_RowDataBound\"&gt;\n    &lt;Columns&gt;\n\n\n       &lt;asp:TemplateField HeaderText=\"labelID\" Visible=\"false\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:Label ID=\"ID\" runat=\"server\" Text='&lt;%# Eval(\"id\") %&gt;' /&gt;\n            &lt;/ItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n\n        &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:Label ID=\"labelfirstname\" Visible='&lt;%# !(bool) IsInEditMode %&gt;' runat=\"server\" Text='&lt;%# Eval(\"firstname\") %&gt;' /&gt;\n                &lt;asp:TextBox ID=\"txtFirstName\" Visible='&lt;%# IsInEditMode %&gt;' runat=\"server\" Text='&lt;%# Eval(\"firstname\") %&gt;' /&gt;\n            &lt;/ItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n         &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:Label ID=\"labellastname\" Visible='&lt;%# !(bool) IsInEditMode %&gt;' runat=\"server\" Text='&lt;%# Eval(\"lastname\") %&gt;' /&gt;\n                &lt;asp:TextBox ID=\"txtLastName\" Visible='&lt;%# IsInEditMode %&gt;' runat=\"server\" Text='&lt;%# Eval(\"lastname\") %&gt;' /&gt;\n\n            &lt;/ItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n\n\n    &lt;/Columns&gt;\n    &lt;/asp:GridView&gt;\n\n\n&lt;asp:Button ID=\"Button1\" runat=\"server\" Text=\"Edit Mode\" onclick=\"Button1_Click1\" /&gt;\n&lt;asp:Button ID=\"Button2\" runat=\"server\" Text=\"View Mode\" onclick=\"Button2_Click1\" /&gt;\n</code></pre>\n\n<p>And here is the c#</p>\n\n<pre><code> private bool isEditMode = false;\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!Page.IsPostBack)\n        {\n            BindData();\n        }\n    }\n    private void BindData()\n    {\n\n        string connectiongString = \"Data Source=WSCJTCSQ1;Initial Catalog=LiquorStore;Integrated Security=True\";\n        SqlConnection myConnection = new SqlConnection(connectiongString);\n        SqlDataAdapter ad = new SqlDataAdapter(\"SELECT id, firstname, lastname, nickname FROM Company\", myConnection);\n        DataSet ds = new DataSet();\n        ad.Fill(ds);\n        gvUsers.DataSource = ds;\n        gvUsers.DataBind();\n\n    }\n\n    protected bool IsInEditMode\n    {\n\n        get { return this.isEditMode; }\n\n        set { this.isEditMode = value; }\n\n    }\n\n    protected void gvUsers_RowDataBound(object sender, GridViewCommandEventArgs e)\n    {\n\n    }\n\n    protected void Button1_Click1(object sender, EventArgs e)\n    {\n        isEditMode = true;\n\n        BindData();\n    }\n\n    protected void Button2_Click1(object sender, EventArgs e)\n    {\n\n        isEditMode = false;\n\n        BindData();\n    }\n</code></pre>\n\n<p>Thank you in advance!!</p>\n"},{"tags":["sql","oracle","query","isqlquery"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13062683,"title":"Oracle SQL compare strings containing numbers, starting with 0 (zero)","body":"<p>I have a Date column, which is actually not in a date format.\nThe date looks like: <code>25/10/2012</code>.\nNow I have to compare 2 dates, but I cant find a pattern to do this, as the format is wrong.</p>\n\n<p>What I have tried is: </p>\n\n<pre><code> SELECT * \n   from PARAMETER\n  where NAME like 'Date_To' and SUBSTR(VALUE, 1, 2)&lt;'25' \n    and SUBSTR(VALUE, 1, 2)&gt;'05'\n</code></pre>\n\n<p>The problem I am facing is that this part: <code>SUBSTR(PA_VALUE, 1, 2)&gt;'05'</code> is not working as there is a 0(zero) infront of the number. Are there any solutions?</p>\n"},{"tags":["sql","vb.net","entity-framework","stored-procedures","ef-code-first"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13126213,"title":"Entity Framework does not map 2 columns from a SqlQuery calling a stored procedure","body":"<p>I'm using Code First and am trying to call a stored procedure and have it map to one of my classes. I created a stored procedure, BOMComponentChild, that returns details of a Component with information of its hierarchy in PartsPath and MyPath. I have a class for the output of this stored procedure. I'm having an issue where everything except the two columns, PartsPath and MyPath, are being mapped correctly with these two properties ending up as Nothing. I searched around and from my understanding the mapping bypasses any Entity Framework name mapping and uses column name to property name. The names are the same and I'm not sure why it is only these two columns.</p>\n\n<p>The last part of the stored procedure is:</p>\n\n<pre><code>SELECT   t.ParentID\n        ,t.ComponentID\n        ,c.PartNumber\n        ,t.PartsPath\n        ,t.MyPath\n        ,t.Layer\n        ,c.[Description]\n        ,loc.LocationID\n        ,loc.LocationName\n        ,CASE WHEN sup.SupplierID IS NULL THEN 1 ELSE sup.SupplierID END AS SupplierID\n        ,CASE WHEN sup.SupplierName IS NULL THEN 'Default' ELSE sup.SupplierName END AS SupplierName\n        ,c.Active\n        ,c.QA\n        ,c.IsAssembly\n        ,c.IsPurchasable\n        ,c.IsMachined\n        ,t.QtyRequired\n        ,t.TotalQty\n\nFROM    BuildProducts                       t \n        INNER JOIN [dbo].[BOMComponent]     c       ON c.ComponentID    = t.ComponentID         \n        LEFT JOIN [dbo].[BOMSupplier]       bsup    ON bsup.ComponentID = t.ComponentID AND bsup.IsDefault = 1\n        LEFT JOIN [dbo].[LookupSupplier]    sup     ON sup.SupplierID   = bsup.SupplierID\n        LEFT  JOIN [dbo].[LookupLocation]   loc     ON loc.LocationID   = c.LocationID\nWHERE \n        (@IsAssembly IS NULL OR IsAssembly = @IsAssembly)\nORDER BY\n         t.MyPath\n</code></pre>\n\n<p>and the class it maps to is:</p>\n\n<pre><code>Public Class BOMComponentChild\n\n        Public Property ParentID As Nullable(Of Integer)\n        Public Property ComponentID As Integer\n        Public Property PartNumber As String\n        Public Property MyPath As String\n        Public Property PartsPath As String\n        Public Property Layer As Integer\n        Public Property Description As String\n        Public Property LocationID As Integer\n        Public Property LocationName As String\n        Public Property SupplierID As Integer\n        Public Property SupplierName As String\n        Public Property Active As Boolean\n        Public Property QA As Boolean\n        Public Property IsAssembly As Boolean\n        Public Property IsPurchasable As Boolean\n        Public Property IsMachined As Boolean\n        Public Property QtyRequired As Integer\n        Public Property TotalQty As Integer\n\n        Public Property Children As IDictionary(Of String, BOMComponentChild) = New Dictionary(Of String, BOMComponentChild)\n\n    End Class\n</code></pre>\n\n<p>I am trying to call it like this:</p>\n\n<pre><code>Me.Database.SqlQuery(Of BOMComponentChild)(\"EXEC [BOMComponentChild] @ComponentID, @PathPrefix, @IsAssembly\", params).ToList()\n</code></pre>\n\n<p>When I run the stored procedure in management studio, the columns are correct and not null. I just can't figure out why these won't map as they are the important information in the stored procedure. The types for PartsPath and MyPath are varchar(50).</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>So I realized the only difference between those columns and the other ones is that they are made with casts. I replaced them in the end select with a static string and they were mapped correctly. When i replaced the last select with the 'test' i get the values are mapped. What is wrong with my CASTs if they are displayed correctly on in a SQL query.</p>\n\n<pre><code>;WITH BuildProducts ( ParentID, ComponentID, PartNumber\n                    ,PartsPath, MyPath, QtyRequired, TotalQty, Layer)\nAS\n(\n    SELECT   ...\n            ,@PathPrefix                        AS PartsPath\n            ,CAST(@PathPrefix +  \n                    CAST(ComponentID            AS varchar(4))  +\n                    '/'                         AS varchar(50)\n                  )                             AS MyPath\n            ,... \n    FROM    [dbo].[BOMComponent]            \n    WHERE   ...\n\n    UNION ALL\n\n    SELECT   ...\n            ,CAST(b.PartsPath + \n                    CAST(a.ParentID             AS varchar(4))  +\n                    '/'                         AS varchar(50)\n                  )                             AS PartsPath\n            ,CAST(b.PartsPath + \n                    CAST(a.ParentID             AS varchar(4))  +\n                    '/'                                         +\n                    CAST(a.ComponentID          AS varchar(4))  +\n                    '/'                         AS varchar(50)\n                  )                             AS MyPath\n            ,...\n    FROM    [dbo].[BOMAssembly]             a \n            INNER JOIN [dbo].[BOMComponent] c ON a.ComponentID = c.ComponentID\n            ...\n)\n\nSELECT  -- t.PartsPath\n        --,t.MyPath\n        'test' As PartsPath\n        ,'test' As MyPath\n        ,...\n\nFROM    BuildProducts                       t \n        ...\n</code></pre>\n"},{"tags":["python","sql","orm","peewee"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13157008,"title":"Peewee ORM - annotate count on many-to-many relation even if count is 0","body":"<p>Let's try to explain my problem using users and tweets.</p>\n\n<p>These are my models (from Peewee docs):</p>\n\n<pre><code>class User(BaseModel):\n    username = CharField()\n\nclass Tweet(BaseModel):\n    user = ForeignKeyField(User, related_name='tweets')\n    message = TextField()\n</code></pre>\n\n<p>and this is my query:</p>\n\n<pre><code>User.select().annotate(Tweet).order_by(fn.Count(Tweet.id).desc())\n</code></pre>\n\n<p>I have some users that haven't already tweeted, but I'd like anyway to get them with my query. Unfortunately, this query doesn't work for users without tweets.</p>\n\n<p>How can I solve this problem?</p>\n"},{"tags":["sql","query","ms-access","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13158913,"title":"Concatenate 2 rows in a complex SQL query","body":"<p>I'm using MS-Access 2003 with the query creator. I select everything from one table (<code>FaitsSaillants</code>), then one specific row (<code>WHERE VARIABLE='TitreMandat'</code>) from another table (<code>tb_SOMMAIRE</code>). I want to select another row from that second table and concatenate it.</p>\n\n<h2>The query</h2>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS\n    [CurrAxe] Text ( 255 ), [CurrOTP] Text ( 255 ),\n    [CurrClient] Text ( 255 ), [StartDate] DateTime, [EndDate] DateTime;\nSELECT \n    tb_SOMMAIRE.Valeur AS Projet, tb_SOMMAIRE.VARIABLE, *\nFROM\n    (FaitsSaillants\n     LEFT JOIN Employes\n         ON FaitsSaillants.Utilisateur = Employes.CIP)\n    INNER JOIN tb_SOMMAIRE\n        ON FaitsSaillants.OTP = tb_SOMMAIRE.OTP\nWHERE\n    (((FaitsSaillants.OTP)=[CurrOTP]) AND \n     ((FaitsSaillants.Client) Like [CurrClient]) AND\n     ((FaitsSaillants.Axe) Like [CurrAxe]) AND\n     ((DateValue([DateInsertion]))&gt;=[StartDate] AND\n      (DateValue([DateInsertion]))&lt;=[EndDate]) AND\n     ((tb_SOMMAIRE.VARIABLE)='TitreMandat'))\nORDER BY\n    FaitsSaillants.DateInsertion DESC;\n</code></pre>\n\n<p>This query does add the <code>tb_SOMMAIRE.Valeur</code> field where the IDs (<code>OTP</code> field) match and where <code>tb_SOMMAIRE.VARIABLE='TitreMandat'</code>. It works like a charm. However, I want to add another row to the <code>tb_SOMMAIRE</code> results. I would like to get the row where <code>VARIABLE='TitreMandat'</code> (that part is actually working) and the row where <code>VARIABLE='NomInstallation'</code>. I will get 2 rows and I want those 2 rows to be concatenated and displayed when I ask for <code>Projet</code> (<code>tb_SOMMAIRE.Value as Projet</code>). Both rows' <code>OTP</code> (IDs) are the same as the one selected in <code>FaitsSaillants</code>.</p>\n\n<p>Sorry if it's in French.</p>\n\n<h2>Tables' structure</h2>\n\n<p>FaitsSaillants</p>\n\n<blockquote>\n<pre><code>Index AutoNumber\nProjet Text\nAxe Text\nClient Text\nOTP Text\nFaitSaillant Memo\nDateInsertion Date\nUtilisateur Text\n</code></pre>\n</blockquote>\n\n<p>tb_SOMMAIRE</p>\n\n<blockquote>\n<pre><code>OTP Text\nVARIABLE Text\nValeur Text\n</code></pre>\n</blockquote>\n\n<h2>Data example</h2>\n\n<p>tb_SOMMAIRE</p>\n\n<blockquote>\n<pre><code>OTP   VARIABLE        Valeur\nUGPSW NomInstallation PosteNemiscau\nUGPSW TitreMandat     oscilloperturbographe\nUGPSW RespIng         CU9656\nGWIHK NomInstallation AnotherInstallation\nGWIHK TitreMandat     Anytitle\nGWIHK Responsable     ImportantPerson\n</code></pre>\n</blockquote>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","hierarchy"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13158857,"title":"How to query and parse adjacent list hierarchy using cte?","body":"<p>How can I query this parent-child hierarchy to produce a result set in which the levels are in their own columns? Sample data:</p>\n\n<pre><code>SET NOCOUNT ON;\nUSE Tempdb;\n\nIF OBJECT_ID('dbo.Employees', 'U') IS NOT NULL DROP TABLE dbo.Employees;\n\nCREATE TABLE dbo.Employees\n(\n  empid   INT         NOT NULL PRIMARY KEY,\n  mgrid   INT         NULL     REFERENCES dbo.Employees,\n  empname VARCHAR(25) NOT NULL,\n  salary  MONEY       NOT NULL,\n  CHECK (empid &lt;&gt; mgrid),\n  CHECK (empid &gt; 0)\n);\n\nCREATE UNIQUE INDEX idx_unc_mgrid_empid ON dbo.Employees(mgrid, empid);\n\nINSERT INTO dbo.Employees(empid, mgrid, empname, salary) VALUES\n  (1,  NULL, 'David'  , $10000.00),\n  (2,  1,    'Eitan'  ,  $7000.00),\n  (3,  1,    'Ina'    ,  $7500.00),\n  (4,  2,    'Seraph' ,  $5000.00),\n  (5,  2,    'Jiru'   ,  $5500.00),\n  (6,  2,    'Steve'  ,  $4500.00),\n  (7,  3,    'Aaron'  ,  $5000.00),\n  (8,  5,    'Lilach' ,  $3500.00),\n  (9,  7,    'Rita'   ,  $3000.00),\n  (10, 5,    'Sean'   ,  $3000.00),\n  (11, 7,    'Gabriel',  $3000.00),\n  (12, 9,    'Emilia' ,  $2000.00),\n  (13, 9,    'Michael',  $2000.00),\n  (14, 9,    'Didi'   ,  $1500.00);\n\nselect * from dbo.Employees\ngo     \n\n;WITH Tree (empid, mgrid, lv)\nAS (\n\nSELECT empid, mgrid, 1\nFROM Employees\nWHERE mgrid IS NULL \n\nUNION ALL\n\nSELECT E.empid, E.mgrid, lv + 1\nFROM Employees AS E\nJOIN Tree\nON E.mgrid= Tree.empid\n)\nSELECT empid, mgrid, lv\nFROM Tree\nORDER BY Lv, empid\n</code></pre>\n\n<p>The resulting table should have a structure like</p>\n\n<pre><code>+-------+-----+--------+--------+--------+--------+--------+\n| empid | lvl | level1 | level2 | level3 | level4 | level5 |\n+-------+-----+--------+--------+--------+--------+--------+\n|     1 |   1 |      1 | NULL   | NULL   | NULL   | NULL   |\n|     2 |   2 |      1 | 2      | NULL   | NULL   | NULL   |\n|     3 |   2 |      1 | 3      | NULL   | NULL   | NULL   |\n|     4 |   3 |      1 | 2      | 4      | NULL   | NULL   |\n|     5 |   3 |      1 | 2      | 5      | NULL   | NULL   |\n|     6 |   3 |      1 | 2      | 6      | NULL   | NULL   |\n|     7 |   3 |      1 | 3      | 7      | NULL   | NULL   |\n|     8 |   4 |      1 | 2      | 5      | 8      | NULL   |\n|     9 |   4 |      1 | 3      | 7      | 9      | NULL   |\n|    10 |   4 |      1 | 2      | 5      | 10     | NULL   |\n|    11 |   4 |      1 | 3      | 7      | 11     | NULL   |\n|    12 |   5 |      1 | 3      | 7      | 9      | 12     |\n|    13 |   5 |      1 | 3      | 7      | 9      | 13     |\n|    14 |   5 |      1 | 3      | 7      | 9      | 14     |\n+-------+-----+--------+--------+--------+--------+--------+\n</code></pre>\n"},{"tags":["c#","sql","sqlcommand"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":85,"score":0,"question_id":13157875,"title":"\"Must declare the scalar variable\" for parameter (C# SqlCommand)","body":"<pre><code>string selectedAreas = getSelectedAreas(areaCounts);\n\nSqlConnection cn = new SqlConnection(connectionstring);\nSqlCommand cmd = new SqlCommand();\ncmd.CommandText = \"select top 1 [x1] \" +\n                  \"from sometable \" +\n                  \"where sometable.coll = @selectedAreas\" +\n                  \"order by NEWID() \";\ncmd.CommandType = System.Data.CommandType.Text;\ncmd.Connection = cn;\ncmd.Parameters.AddWithValue(\"@selectedAreas\", selectedAreas);\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n\n<p>I get </p>\n\n<blockquote>\n  <p><em>Must declare the scalar variable for @selectedAreas.</em></p>\n</blockquote>\n\n<p><code>@selectedAreas</code> might become something like:</p>\n\n<pre><code>\" 'nyc' or sometable.coll = 'la' or sometable.coll = 'miami' \"\n</code></pre>\n\n<p>Edit:</p>\n\n<p>I added the space as the comment below pointed out. And removed the paramter, like this:</p>\n\n<pre><code>cmd.CommandText = \"select top 1 [x1] \" +\n                  \"from sometable \" +\n                  \"where sometable.coll = \" + selectedAreas\n                  \" order by NEWID() \";\n</code></pre>\n\n<p>Dont know how correct it is but it works for now...</p>\n"},{"tags":["sql","sql-server","join","aggregate","coalesce"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13157109,"title":"SQL query to display aggregated data when result is zero","body":"<p>I have a table with fields like this:</p>\n\n<pre><code>Item\nCategory\nYear \nMonth\nValue\n</code></pre>\n\n<p>I want to aggregate the result from this table to display sum(value) for each category, year and month. So I have this query:</p>\n\n<pre><code>SELECT Category, Year, Month, SUM(Value) \nFROM Table\nGROUP BY Category, Year, Month;\n</code></pre>\n\n<p>This works fine, but for months in which the sum is zero, the month is not displayed. I want all months to be displayed with zero for the total value where applicable.</p>\n\n<p>I’ve tried doing <code>COALESCE(SUM(Value),0)</code>, but this didn’t work.</p>\n\n<p>I’ve tried creating a separate table (Table2) with the year and month values and then joining this with the first table:</p>\n\n<pre><code>SELECT Category, Year, Month, SUM(Value) \nFROM Table\nRIGHT JOIN Table2\nON Table2.Year + Table2.Month = Table.Year + Table.Month\nGROUP BY Category, Year, Month;\n</code></pre>\n\n<p>This doesn’t work either. What am I doing wrong?</p>\n\n<p>Edit:</p>\n\n<p>I have tried Dems's solution, using the following query:</p>\n\n<pre><code>SELECT\n  Category.name,\n  Dates.Year,\n  Dates.Month,\n  SUM(Data.Value) AS Value\nFROM\n  Category\nCROSS JOIN\n  Dates\nLEFT JOIN\n  Data\n    ON  data.CategoryID = Category.ID\n    AND data.Year       = Dates.Year\n    AND data.Month      = Dates.Month\nWHERE data.Year BETWEEN #### and ####\n  AND data.Month BETWEEN # AND #\n  AND data.Property IN (‘A1’,’B1’) \n  AND data.Property2 IN (‘C1’,’D1’)\nGROUP BY\n  Category.name,\n  Dates.Year,\n  Dates.Month\n</code></pre>\n\n<p>The only differences as far as can see are that I'm using a where clause on data, and have missed of the ORDER BY, which shouldn't make a difference. But I'm still having no joy.</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13152556,"title":"sql server queries related to case statement","body":"<p>My query like this</p>\n\n<p>case when statement1 = statement2 then offer1</p>\n\n<p>if offer1 is have value means  then i need to display offer1 value will be 'Yes'</p>\n\n<p>How to  write the query for this?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1298,"score":0,"question_id":11801911,"title":"Insert multiple rows into single column","body":"<p>I'm new to SQL, (using SQL 2008 R2) and I am having trouble inserting multiple rows into a single column.</p>\n\n<p>I have a table named <code>Data</code> and this is what I am trying</p>\n\n<pre><code>INSERT INTO Data ( Col1 ) VALUES\n('Hello', 'World')\n</code></pre>\n\n<p>That code was taken from <a href=\"http://stackoverflow.com/questions/452859/inserting-multiple-rows-in-a-single-sql-query\">this</a> question, but it, like many other examples I have found on the web uses 2 columns, I just want to use 1. What am I doing wrong?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":83,"score":2,"question_id":13159617,"title":"Reading a datetime value from a SQL database","body":"<p>How can I read datetime fields from a SQL database?</p>\n\n<p>This is not working: </p>\n\n<pre><code>emp.DateFacturation = (DateTime)(dr[\"DateFacturation\"])\n</code></pre>\n\n<p>nor is this:</p>\n\n<pre><code>emp.DateFacturation = DateTime.Parse(dr[\"DateFacturation\"].toString());\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","dbms","ruby-on-rails-2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13157923,"title":"Get values from 3 different tables based on specific condition","body":"<p>I have 3 tables in my database</p>\n\n<ol>\n<li>User (id, username, email, pwd, etc ...)</li>\n<li>Producer (id, user_id)</li>\n<li>Address (first_name, city, addressable_id, etc)</li>\n</ol>\n\n<p>Producer has link with User table(User.id = Producer.user_id) and Address table(p.id = Address.addressable_id)</p>\n\n<p>Now I want to get all the producer addresses with his username</p>\n\n<p>I am trying with following query but it is not giving the expected output</p>\n\n<pre><code>select u.login, p.id, a.city from producers p\n\njoin users u on u.id = p.user_id\n\njoin addresses a on a.addressable_id = p.id\n</code></pre>\n\n<h2>My models and relationships</h2>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :customer\n  has_one :producer\nend\n</code></pre>\n\n<p><strong>producer.rb</strong></p>\n\n<pre><code>class Producer &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :updated_by_user, :class_name =&gt; \"User\", :foreign_key =&gt; \"updated_by_user_id\"\n\n  has_one :address, :as =&gt; :addressable\n  has_many :items  \nend\n</code></pre>\n\n<p><strong>address.rb</strong></p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :addressable, :polymorphic =&gt; true\n\n  belongs_to :updated_by_user, :class_name =&gt; \"User\", :foreign_key =&gt; \"updated_by_user_id\"\nend\n</code></pre>\n"}]}
{"total":102599,"page":18,"pagesize":100,"questions":[{"tags":["sql","mysql","group-by","sql-order-by"],"answer_count":4,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":24524,"score":10,"question_id":1066453,"title":"MySQL \"Group By\" and \"Order By\"","body":"<p>I want to be able to select a bunch of rows from a table of e-mails and group them by the from sender.  My query looks like this:</p>\n\n<blockquote>\n  <p>SELECT <code>emailID</code>, <code>fromEmail</code>, <code>subject</code>, <code>timestamp</code>, MIN(<code>read</code>) as <code>read</code> FROM <code>incomingEmails</code> WHERE <code>toUserID</code> = '$userID' GROUP BY LOWER(<code>fromEmail</code>) ORDER BY <code>timestamp</code> DESC</p>\n</blockquote>\n\n<p>The query almost works as I want it--it selects records grouped by e-mail such that there is only one row per from e-mail address.  The problem is that the emailID, subject, and timestamp don't necessarily correspond to the most recent of the e-mails of a particular from e-mail address.</p>\n\n<p>For example, it might return:</p>\n\n<blockquote>\n  <p>From: john@example.com  Subject: hello</p>\n  \n  <p>From: mark@example.com  Subject: welcome</p>\n</blockquote>\n\n<p>When the records in the database are:</p>\n\n<blockquote>\n  <p>From: john@example.com  Subject: hello</p>\n  \n  <p>From: john@example.com  Subject: programming question</p>\n  \n  <p>From: mark@example.com  Subject: welcome</p>\n</blockquote>\n\n<p>If the programming question e-mail is the most recent, how can I get MySQL to select that record when grouping the e-mails?</p>\n"},{"tags":["sql","ssis","ssis-data-transformations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13126456,"title":"EDI file without any third party tool","body":"<p>i am getting EDI  file as shown below,i need to process it ,and i need to maintain primary key ,foreign key also.</p>\n\n<pre><code>TH*4.2*857463*01**20091015*1045*P**~~IS*7564*ACME \nPHARMACY~PHA*1234567890~PAT*MA*06*987544****SMITH*JOHN****1234 MAIN \nST**SOMEWHERE*MA*54356**19500101*M*01*01*INDIA**BURGER~\n</code></pre>\n\n<p>Here the column delimeter is * ,also if no value is provided they also put *.</p>\n\n<p>i need to store fields from </p>\n\n<pre><code>TH*4.2*857463*01**20091015*1045*P**~~\n</code></pre>\n\n<p>into 1 table,by seperating fields.</p>\n\n<p>So it would be</p>\n\n<pre>\nth01       th02       th03       th04   th05            th06      th07      th08   th09         th10\nTH          4.2        857163     01     *(no value)    20091015   1045       p     * (novalue)  ~~\n</pre>\n\n<p>IS*7564*ACME PHARMACY into another table,and so on.</p>\n\n<p>i cannot use third party tool as i cannot have xml files</p>\n\n<p>Any help?</p>\n\n<p>ok.</p>\n\n<p>here is my vb.net code </p>\n\n<p>Public Enum Segments\n        TH\n        PHA\n        PAT\n        IS1\n    End Enum</p>\n\n<pre><code>Dim arrLine As String()\nDim segmentcode As String\nDim counter As Integer\nDim linenumber As Integer = 1\nDim segmenetsequence As Hashtable = New Hashtable()\nDim setid As Guid = Guid.NewGuid()\n\n\n\n\n\n\nPublic Overrides Sub Input0_ProcessInputRow(ByVal Row As Input0Buffer)\n\n    arrLine = Row.LineText.Split(\"*\"c)\n\n    segmentcode = SegmentValue(arrLine, 0)\n    Row.LineNumber = linenumber\n\n\n    Row.Setid = setid\n\n    counter = arrLine.Length\n    linenumber += 1\n\n    Select Case (segmentcode.ToUpper())\n\n        Case Segments.TH.ToString.ToUpper()\n            Row.TH01 = SegmentValue(arrLine, 1)\n            Row.TH02 = SegmentValue(arrLine, 2)\n            Row.TH03 = Convert.ToInt32(SegmentValue(arrLine, 3))\n            Row.TH04 = SegmentValue(arrLine, 4)\n            Row.TH05 = Convert.ToDateTime(SegmentValue(arrLine, 5))\n            Row.TH06 = SegmentValue(arrLine, 6)\n            Row.TH07 = SegmentValue(arrLine, 7)\n            Row.TH08 = Convert.ToInt32(SegmentValue(arrLine, 8))\n            Row.TH09 = SegmentValue(arrLine, 9)\n\n        Case Segments.IS1.ToString.ToUpper()\n            Row.IS01 = SegmentValue(arrLine, 1)\n            Row.IS02 = SegmentValue(arrLine, 2)\n            Row.IS03 = SegmentValue(arrLine, 3)\n\n        Case Segments.PHA.ToString.ToUpper()\n\n            Row.PHA01 = SegmentValue(arrLine, 1)\n            Row.PHA02 = SegmentValue(arrLine, 2)\n            Row.PHA03 = SegmentValue(arrLine, 3)\n            Row.PHA04 = SegmentValue(arrLine, 4)\n            Row.PHA05 = SegmentValue(arrLine, 5)\n            Row.PHA06 = SegmentValue(arrLine, 6)\n            Row.PHA07 = SegmentValue(arrLine, 7)\n            Row.PHA08 = SegmentValue(arrLine, 8)\n            Row.PHA09 = SegmentValue(arrLine, 9)\n            Row.PHA10 = SegmentValue(arrLine, 10)\n            Row.PHA11 = SegmentValue(arrLine, 11)\n            Row.PHA12 = SegmentValue(arrLine, 12)\n\n\n        Case Segments.PAT.ToString.ToUpper()\n\n            Row.PAT01 = SegmentValue(arrLine, 1)\n            Row.PAT02 = SegmentValue(arrLine, 2)\n            Row.PAT03 = SegmentValue(arrLine, 3)\n            Row.PAT04 = SegmentValue(arrLine, 4)\n            Row.PAT05 = Convert.ToInt32(SegmentValue(arrLine, 5))\n            Row.PAT06 = SegmentValue(arrLine, 6)\n            Row.PAT07 = SegmentValue(arrLine, 7)\n            Row.PAT08 = SegmentValue(arrLine, 8)\n            Row.PAT09 = SegmentValue(arrLine, 9)\n            Row.PAT10 = SegmentValue(arrLine, 10)\n            Row.PAT11 = SegmentValue(arrLine, 11)\n            Row.PAT12 = SegmentValue(arrLine, 12)\n            Row.PAT13 = SegmentValue(arrLine, 13)\n            Row.PAT14 = SegmentValue(arrLine, 14)\n            Row.PAT15 = SegmentValue(arrLine, 15)\n            Row.PAT16 = SegmentValue(arrLine, 16)\n            Row.PAT17 = SegmentValue(arrLine, 17)\n            Row.PAT18 = Convert.ToDateTime(SegmentValue(arrLine, 18))\n            Row.PAT19 = SegmentValue(arrLine, 19)\n            Row.PAT20 = Convert.ToInt32(SegmentValue(arrLine, 20))\n            Row.PAT21 = Convert.ToInt32(SegmentValue(arrLine, 21))\n            Row.PAT22 = SegmentValue(arrLine, 22)\n            Row.PAT23 = SegmentValue(arrLine, 23)\n            Row.PAT24 = SegmentValue(arrLine, 24)\n\n\n\n\n    End Select\n\n\n\nEnd Sub\n\nPublic Function SegmentValue(ByRef LineArray As String(), ByVal Counter As Integer) As String\n    Throw New NotImplementedException\n\n    If LineArray.Length &gt; Counter Then\n        Return LineArray(Counter).ToString().Trim()\n\n    End If\n    Return String.Empty\n\nEnd Function\n</code></pre>\n\n<p>End Class</p>\n"},{"tags":["sql","algorithm","recommendation","digg"],"answer_count":5,"favorite_count":10,"up_vote_count":10,"down_vote_count":0,"view_count":1579,"score":10,"question_id":71920,"title":"How to implement a Digg-like algorithm?","body":"<p>How to implement a website with a recommendation system similar to stackoverflow/digg/reddit? I.e., users submit content and the website needs to calculate some sort of \"hotness\" according to how popular the item is. The flow is as follows:</p>\n\n<ul>\n<li>Users submit content</li>\n<li>Other users view and vote on the content (assume 90% of the users only views content and 10% actively votes up or down on content)</li>\n<li>New content is continuously submitted</li>\n</ul>\n\n<p>How do I implement an algorithm that calculates the \"hotness\" of a submitted item, preferably in real-time? Are there any best-practices or design patterns?</p>\n\n<p>I would assume that the algorithm takes the following into consideration:</p>\n\n<ul>\n<li>When an item was submitted</li>\n<li>When each vote was cast</li>\n<li>When the item was viewed</li>\n</ul>\n\n<p>E.g. an item that gets a constant trickle of votes would stay somewhat \"hot\" constantly while an item that receives a burst of votes when it is first submitted will jump to the top of the \"hotness\"-list but then fall down as the votes stop coming in.</p>\n\n<p>(I am using a MySQL+PHP but I am interested in general design patterns).</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13159284,"title":"How Can I Fix This Select Query","body":"<p>This is my query..</p>\n\n<pre><code>SELECT tcs.tutor_id AS tid, tcs.category_id AS cid, tcs.subject_id AS sid, GROUP_CONCAT( DISTINCT s.subjects SEPARATOR ', ') AS subjects,\nt.tutor_name, t.tutor_code AS tcode, DATE_FORMAT(t.registration_date, '%b %D, %Y') AS date, t.qualification,\nGROUP_CONCAT( DISTINCT o.option_name SEPARATOR ', ') AS tutor_option, timg.image_name AS img\nFROM tutor_category_subject as tcs\nINNER JOIN subject AS s ON tcs.subject_id = s.subject_id\nINNER JOIN tutor_option AS toption ON toption.tutor_id = tcs.tutor_id\nINNER JOIN options AS o ON toption.option_id = o.option_id\nINNER JOIN tutors AS t ON tcs.tutor_id = t.tutor_id\nLEFT JOIN tutor_images AS timg ON timg.tutor_id = tcs.tutor_id\nWHERE s.subjects LIKE '%business%' AND timg.image_type = 'profile'\nGROUP BY tcs.tutor_id;\n</code></pre>\n\n<p>This query working properly.. But there is problem with timg's image_type coloum. It is tutor may have their profile image and some tutors dont have profile image. But I need to select all tutors with this condition even if not their profile images. In this query, if there is no profile image to the tutor that tutor not selecting... so how can I do this..?</p>\n\n<p>any comments are greatly appreciated.\nThank you </p>\n"},{"tags":["sql","query","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13141181,"title":"Select from 2 tables with a left join","body":"<p>Here is probably an easy one if your used to SQL, which I'm not.</p>\n\n<p>I have this query:</p>\n\n<pre><code>SELECT * \nFROM myTable \nLEFT JOIN anotherTable \n    ON myTable.myField=anotherTable.anotherField\n</code></pre>\n\n<p>Actually, this query returns everything from myTable which meets the <em>join condition</em> (as far as my comprehension goes). This query works great, but I would like to select another field from another table. What I would like to do is something like this:</p>\n\n<pre><code>SELECT myTable.*, myTable2.aSpecificField \nFROM myTable, myTable2 \nLEFT JOIN anotherTable \n    ON myTable.myField=anotherTable.anotherField \nWHERE myTable.id = myTable2.id\n</code></pre>\n\n<p>However, this doesn't work, I get an error message about the <em>LEFT JOIN</em>. I would like the aSpecificField from myTable2 to be added to the rows where the ID of both tables match.</p>\n\n<p>Can you help me building this query correctly? Thank you.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","query-optimization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13158956,"title":"UDF performance suddenly degraded","body":"<p>SQL Server 2008 R2</p>\n\n<p>I know this is a common problem (eg: <a href=\"http://connect.microsoft.com/SQLServer/feedback/details/524983/user-defined-function-performance-is-unacceptable\" rel=\"nofollow\">http://connect.microsoft.com/SQLServer/feedback/details/524983/user-defined-function-performance-is-unacceptable</a>) - but ive only just learned of it.</p>\n\n<p>We have a live production database that has performed fine for months, specifically a stored procedure that contains a large CTE that selects into a table variable. Then, based on a parameter on the procedure - data is selected from the table variable in various ways (column sequence, order by clause etc).</p>\n\n<p>This temporary table only has a few hundred rows inserted into it from the CTE - the source data is huge, but the resulting rows are always low in number)</p>\n\n<p>The select satements used on the table variable use 2 very simple UDF's:</p>\n\n<pre><code>CREATE FUNCTION [dbo].[format_timeV2] ( @Time INT )\nRETURNS VARCHAR(20)\nAS \n    BEGIN\n        DECLARE @Time_Varchar VARCHAR(20)\n        SET @Time_Varchar = CONVERT(VARCHAR, @Time / 3600) + 'h ' + CONVERT(VARCHAR, ROUND(( ( CONVERT(FLOAT, ( @Time % 3600 )) ) / 3600 ) * 60, 0)) + 'm'\n        RETURN @Time_Varchar\n    END\nGO\n</code></pre>\n\n<p>And</p>\n\n<pre><code>CREATE FUNCTION [dbo].[udf_WeekEndDate] ( @Date DATETIME )\nRETURNS DATETIME\nAS \n    BEGIN\n        RETURN DATEADD(DAY, 7, CONVERT(DATETIME, CONVERT(VARCHAR(10), DATEADD(day, -1 - ( DATEPART(dw, @Date) + @@DATEFIRST - 2 ) % 7, @Date), 103) + ' 23:59:59', 103))\n    END\nGO\n</code></pre>\n\n<p>These UDF's have been working fine for months, if not years, the stored procedure in question has ALWAYS ran in under 6 seconds - but as soon as the UDF's above are included on the SELECT statement of the table variable the procedure takes MINUTES!</p>\n\n<p>As soon as we comment out the usage of these functions it returns to executing in 3-6 seconds.</p>\n\n<p>These functions are only being used on the <code>SELECT</code> from <code>@TableVar</code> statement (few hundred rows) - so i dont see why the query optimiser if struggling here?!?!</p>\n\n<p>If we run the following - the UDF's and procedure start to work normally again:</p>\n\n<pre><code>DBCC FreeProcCache\nDBCC DropCleanbuffers\n</code></pre>\n\n<p>So i can only assume the query optimiser is doing something stupid in the background - but it's not clear on the execution plan as to what it is.</p>\n\n<p>I have tried recreating the proc with <code>RECOMPILE</code> - this didnt help, only <code>FreeProcCache</code> &amp; <code>DropCleanbuffers</code> helped.</p>\n\n<p>Any ideas what the root cause of this? we dont really want to go re-writing all the UDFs as table valued function (which i understand is a work around for this problem) as this is a live production database which has been working fine for years.</p>\n\n<p><strong>EDIT 1:</strong> Blam requested detail of the actual query that hangs:</p>\n\n<pre><code>    IF @ModeInt = 2 \n        SELECT  [DET_NUMBERA] ,\n                [Name] ,\n                [Branch] ,\n                COUNT(*) OVER ( PARTITION BY [DET_NUMBERA] ) AS RowsForThisEmployee ,\n                CONVERT(VARCHAR(10), dbo.udf_WeekEndDate([Date]), 103) AS [WeekEnding] ,\n                [Date] ,\n                [Start Time] ,\n                [End Time] ,\n                [Duration] ,\n                dbo.format_timeV2([Duration] * 60) AS [DurationF] ,\n                [EntryCount] ,\n                [EntryColour] ,\n                [DurationColour] ,\n                [DurationComment]\n        FROM    @CompletedData\n        WHERE   [EntryCount] = 0\n        ORDER BY [DET_NUMBERA] ,\n                [Date] ,\n                [Start Time]\n\n    IF @ModeInt = 3 \n        SELECT  [DET_NUMBERA] ,\n                [Name] ,\n                [Branch] ,\n                COUNT(*) OVER ( PARTITION BY [DET_NUMBERA] ) AS RowsForThisEmployee ,\n                CONVERT(VARCHAR(10), dbo.udf_WeekEndDate([Date]), 103) AS [WeekEnding] ,\n                [Date] ,\n                [Start Time] ,\n                [End Time] ,\n                [Duration] ,\n                dbo.format_timeV2([Duration] * 60) AS [DurationF] ,\n                [EntryCount] ,\n                [EntryColour] ,\n                [DurationColour] ,\n                [DurationComment]\n        FROM    @CompletedData\n        WHERE   [EntryCount] &gt; 1\n        ORDER BY [DET_NUMBERA] ,\n                [Date] ,\n                [Start Time]\n</code></pre>\n\n<p>The temp table doesnt have an index (didnt think it was needed as it only ever contains 100 - 200 rows:</p>\n\n<pre><code>    DECLARE @CompletedData TABLE\n        (\n          [DET_NUMBERA] VARCHAR(7) ,\n          [Name] VARCHAR(255) ,\n          [Branch] VARCHAR(3) ,\n          [Date] DATE ,\n          [Start Time] TIME(0) ,\n          [End Time] TIME(0) ,\n          [Duration] INT ,\n          [EntryCount] INT ,\n          [EntryColour] VARCHAR(15) ,\n          [DurationColour] VARCHAR(15) ,\n          [DurationComment] VARCHAR(65)\n        )\n</code></pre>\n\n<p>The CTE populates the table in 3 seconds, its only the above SELETS that make use of UDF's that hang, if i remove the UDF's from the SELECT it works instantly.</p>\n"},{"tags":["php","sql","search","post","mysql-like"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13159082,"title":"Echoing data from multiple tables PHP Search form","body":"<p>I'm trying to make a search form that displays data from my database where the name of the data is like the search term. \nSadly I'm trying to get it to echo information from multiple tables:</p>\n\n<p>Album Table: </p>\n\n<pre><code>albumName      albumArt       artistID\n----------    ----------      ---------\nalbum1        art1.jpg        1\nalbum2        art2.jpg        2\nalbum3        art3.jpg        3\n</code></pre>\n\n<p>SongsTable:</p>\n\n<pre><code>songName      artistID       \n--------      ---------       \nsong1         1          \nsong2         1         \nsong3         2         \nsong4         3         \nsong5         3         \n</code></pre>\n\n<p>Example PHP:</p>\n\n<pre><code>$search = $_POST['search'];    \n$sql1 = \"SELECT * FROM songs WHERE songName LIKE '%$search%'\";    \n$searchResult = mysql_query($sql1);    \n\nwhile ($result = mysql_fetch_array($searchResult)) {\necho \"&lt;tr&gt;\n     &lt;td&gt;\".$result['songName'].\"&lt;/td&gt;\n     &lt;td&gt;\".$result['albumName'].\"&lt;/td&gt;\n     &lt;/tr&gt;\";\n}\n?&gt;\n</code></pre>\n\n<p>I'm not sure if inner join will do the trick, I've read as many possible tutorials on this but none i can comprehend or use.</p>\n\n<p>The search term is coming from an form on another page, this is just the processing page, but it also echos the information.</p>\n\n<p>I need the query to return something similiar to below if someone searched 'S':</p>\n\n<pre><code>songName      albumname       artistName\n----------    ----------      ---------\nsong1         album1          artist1\nsong2         album2          artist2\nsong3         album3          artist3\n</code></pre>\n"},{"tags":["sql","vb.net","select-case"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":50,"score":5,"question_id":13158456,"title":"Make a Dynamic select case (vb)","body":"<p>I would like to have one of my cases be a dynamic string because in my table these values changed partially except for the beginning code \"2061\"\nso how do I make my code do something similar to when I'm looking up in my query \n\"... like '2061%'\nhere is my code </p>\n\n<pre><code>Function GetResponse(val As String) As String\n        Select Case val\n            Case \"2061\"\n                Return \"Opted Out\"\n            Case \"00\"\n                Return \"\"\n            Case Else\n                Return \"Other\"\n        End Select\n    End Function\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13157708,"title":"Parsing error when creating view","body":"<p>I have a view which takes multiple rows and Comma Separated Values (CSV) from table columns with data. </p>\n\n<p>It was working well and I got the results that I needed. Now the view has some parsing error like:</p>\n\n<blockquote>\n  <p>Error in WHERE clause near '('. Unable to parse query text.</p>\n</blockquote>\n\n<p>Can someone help? Here is my code:</p>\n\n<pre><code>SELECT dbo.table1.title,\n       Stuff((SELECT ', ' + CONVERT(NVARCHAR(4000), dbo.table3.uid) AS [text()]\n              FROM   dbo.table2\n                     INNER JOIN dbo.table3\n                       ON dbo.table3.uid = dbo.table2.FK_Group\n              WHERE  dbo.table3.uid = dbo.table2.FK_Group\n                     AND dbo.table3.company = dbo.main.company\n                     AND dbo.table2.FK_Version = dbo.table1.fk_Version\n                     AND dbo.main_version.uid = dbo.table1.fk_Version\n              FOR XML PATH('')), 1, 1, '') AS groupName\nFROM   dbo.main_version\n       INNER JOIN dbo.[main]\n         ON dbo.version.fk_main = dbo.[main].uid\n       INNER JOIN dbo.main_schema\n         ON dbo.[main].fk_SCHEMA = dbo.main_schema.uid\n       INNER JOIN dbo.table1\n         ON dbo.version.uid = dbo.table1.fk_Version\nWHERE  ( dbo.main_version.active = 1 )\n</code></pre>\n"},{"tags":["php","sql","database"],"answer_count":11,"favorite_count":5,"up_vote_count":25,"down_vote_count":0,"view_count":5637,"score":25,"question_id":85,"title":"Flat File Databases in PHP","body":"<p>What are your best practices around creating flat file database structures in PHP?  A lot of the more mature PHP flat file frameworks I see out there attempt to implement SQL-like query syntax, which is over the top for my purposes in most cases (I would just use a database at that point).</p>\r\n\r\n<p>Are there any elegant tricks out there to get good performance and features with the small code overhead one would want by taking on this problem in the first place?</p>"},{"tags":["php","sql","database","while-loop","connect"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13147881,"title":"PHP connecting to two tables in a while loop","body":"<p>I have a small and rather simple question I believe, however I have tried everything but I just can't figure out this syntax.</p>\n\n<p>I will start by entering this code (php): </p>\n\n<pre><code>require_once('connectvars.php'); // My database connection\n\n//Connect to the database\n$dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n//Retrieve the data from the database\n$query = \"SELECT * FROM pbclickslogin WHERE username='$username'\";\n$data = mysqli_query($dbc, $query);\nwhile ($info = mysqli_fetch_array( $data )) {\n    echo $info['lol']; echo $info['lol2'];\n}\n</code></pre>\n\n<p>So I made up this example and let us say that \"$info['lol'];\" is a column inside a table named \"pbclickslogin\" and \"$info['lol2'];\" is a column inside a table named \"pbclickssomethingelse\". But I cannot connect to both databases at the same time, or can I? </p>\n\n<p>I have tried adding:</p>\n\n<pre><code>$query = \"SELECT * FROM pbclickslogin, pbclickssomethingelse WHERE username='$username'\";\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>$query = \"SELECT * FROM pbclickslogin WHERE username='$username'\";\n$query2 = \"SELECT * FROM pbclickssomethingelse WHERE username='$username'\";\n$data = mysqli_query($dbc, $query, $query2);\nwhile ($info = mysqli_fetch_array( $data )) {\n    echo $info['lol']; echo $info['lol2'];\n}\n</code></pre>\n\n<p>but as some of you experienced PHP users might know. These two things did not solve my problem. Do any of you have an idea of how I can connect to both of these databases while doing the while loop?</p>\n"},{"tags":["sql","sql-server-2008","tsql","parsing"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13122997,"title":"T-SQL: Parsing names to ignore spaces and middle initials","body":"<p>I have a poorly maintained database that includes employee information.  Human Resources requested a report that lists instances where the employee name associated with an insurance coverage does not match the name on the insurance policy.  </p>\n\n<p>There are inconsistencies in the formatting of the names in both tables.  It's always last name then first name, but you might see any of the following in either table for a fictional employee named Steven J. Smith:</p>\n\n<ol>\n<li>Smith, Steven</li>\n<li>Smith,Steven</li>\n<li>Smith, Steven J.</li>\n<li>Smith,Steven J.</li>\n</ol>\n\n<p>I need to run a query looking for instances where EMPLOYEE.EMP_NAME &lt;> INSURANCE.SUBSCRIBER_NAME while allowing for differences in name formatting as shown above (i.e. picking up that \"Smith,Steven J.\" and \"Smith, Steven\" are (probably) the same person and igonring them).  </p>\n\n<pre><code>SELECT \n  EMPLOYEE.EMP_NO\n, EMPLOYEE.EMP_NAME\n, INSURANCE.SUBSCRIBER_NAME\n, INSURANCE.PAYOR_NAME\n\nFROM EMPLOYEE\n     INNER JOIN INSURANCE ON EMPLOYEE.EMP_NO = INSURANCE.EMP_NO\n\nWHERE EMPLOYEE.EMP_NAME &lt;&gt; INSURANCE.SUBSCRIBER_NAME\n</code></pre>\n\n<p>I know I want to do a substring to ignore the middle initial, but how do I account for ignoring whether or not there is a space after the comma?  </p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13158603,"title":"select 100 records in range","body":"<p>Lets say I have a student table and there are 1000 records in it. </p>\n\n<p>I would like to write such a query that should select only 100 records but I should be able to define the range. </p>\n\n<pre><code>Ex. 100 records showing from 501 to 600\nor 100 records showing from 101 to 200\n</code></pre>\n\n<p>P.S. Yes! There is a identity column but it consists of random numbers.</p>\n\n<p>Thank you for your help.</p>\n"},{"tags":["php","sql","ubuntu"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13158701,"title":"Cannot call an sql connection from php","body":"<p>(Running ubuntu server 12.04)</p>\n\n<p>This line in particular is giving me issues in php:</p>\n\n<pre><code>$con = mysql_connect(\"localhost:3306\",\"root\",\"root\");\n</code></pre>\n\n<p>From turning on error reporting, I only got this returned (as it was killed at that line and nothing afterwards would print):</p>\n\n<pre><code>Fatal error: Call to undefined function mysql_connect() in /var/www/sql/login.php on line 7\n</code></pre>\n\n<p>I'm not sure where to go from there, as it is just killed at the line I provided. I have used just \"localhost\" as well, and I have successfully logged in from the command line. Could this be a php permissions issue, or something like configuration? If so, where would that be?</p>\n"},{"tags":["sql","nvarchar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13156766,"title":"want to store varbinary value in nvarchar datatype?","body":"<p>My table <code>testuidpwd</code> have:</p>\n\n<p>User:</p>\n\n<pre><code>Uid Password Passwordhash\n----------------------------------------    \n121 wrwrwr 0x0013531FA845AEA1E840BDE787336ED3CAEDFE6E\n122 etetxw 0x79BAEFD23C2F4D146F9BD2FDF6C14CA25AC5D6AA\n</code></pre>\n\n<ul>\n<li><code>uid</code> <code>char</code> data type</li>\n<li><code>password</code> <code>nvarchar(100)</code> data type</li>\n<li><code>passwordhash</code> <code>nvarchar(100)</code> data type</li>\n</ul>\n\n<p>My problem is when I use function <code>hashbytes('SHA1',password)</code></p>\n\n<pre><code>update testdb.dbo.testuidpwd \nset pwdhash = HashBytes('SHA1', password)\n</code></pre>\n\n<p>in the column <code>pwdhash</code> is the <code>nvarchar(100)</code> data type.</p>\n\n<p>When I execute the below statement </p>\n\n<pre><code>update testdb.dbo.testuidpwd \nset pwdhash=HashBytes('SHA1', password)\n</code></pre>\n\n<p>I got the <code>pwdhash</code> column as 硽贕ڷד瘃快ﭙ寱캏엞 this kind of format</p>\n\n<p><strong>but I want to store the <code>varbinary</code> format......in the <code>pwdhash</code> column</strong></p>\n\n<p>For ex:</p>\n\n<pre><code>update testdb.dbo.testuidpwd \nset pwdhash = cast(hashbytes('SHA1', PWD) AS varbinary)\n</code></pre>\n\n<p>this statement also doesn't work</p>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13158486,"title":"Save stored procedure results in Dataset using Entity Framework","body":"<p>I use this method to query the database to get all the Valuations of a User. A table is returned with multiple rows and columns</p>\n\n<pre><code> public void UserValuationGet()\n {\n    using (FormValueEntities db = new FormValueEntities())\n    {\n      //Query the database for the Valuation\n      var valuation = db.ValuationOfUserGet(userName);         \n    }\n }\n</code></pre>\n\n<p>How can I save the valaution in a Dataset or is there any good tutorial on how to use the Entity Framework Complex types?</p>\n"},{"tags":["python","sql","postgresql","sqlalchemy","flask-sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13155810,"title":"sqlalchemy query with condition on child relationship","body":"<p>I have the following models in sqlalchemy:</p>\n\n<pre><code>class Magazine(db.Model):\n\n    id= db.Column(db.Integer, primary_key=True)\n    name= db.Column(db.String(50))\n    issues= db.relationship('Issue', backref='magazine', lazy='dynamic')\n\nclass Issue(db.Model):\n    id= db.Column(db.Integer, primary_key=True)\n    magazine_id= db.Column(db.Integer, db.ForeignKey('magazine.id'))\n    date= db.Column(db.Date)\n</code></pre>\n\n<p>Magazines holds names of magazines and issues holds the issues of each magazine. These are weekly magazines, so the <code>date</code> field in <code>Issue</code> is the day of the issue.</p>\n\n<p>I am try to build a query to select all magazines who do not have an issue for a specific date. How's the easiest way to do it?</p>\n"},{"tags":["sql","performance","select","ssis"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13153932,"title":"Does it matter where I SELECT fewer columns in SSIS in order to increase performance?","body":"<p>Say in a data flow task, I have an OLE DB source. I would like to increase the performance of the SSIS. Does it matter where I SELECT less columns?</p>\n\n<ol>\n<li><p>Create a view in database that SELECT less columns, use that as the source.</p></li>\n<li><p>Type SQL SELECT inside the source to select less columns.</p></li>\n<li><p>Choose the table then untick the columns inside the source.</p></li>\n</ol>\n\n<p>Thank you</p>\n"},{"tags":["sql","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13156879,"title":"T-SQL: How to convert string representations of a date","body":"<p>I've got some dates stored in varchar(10) format.</p>\n\n<p>Dates are like so:</p>\n\n<pre><code>2008-01-06\n2008-01-13\n2008-01-20\n2008-01-27\n2008-02-03\n2008-02-10\n2008-02-17\n2008-02-24\n</code></pre>\n\n<p>I would like them in dd/mm/yyyy format (also a DATE datatype)</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>SELECT CONVERT(VARCHAR(max), startWeek, 103) date\nFROM dbo.GoogledataFinal\n</code></pre>\n\n<p>Why does this output:</p>\n\n<pre><code>2008-01-06\n2008-01-13\n2008-01-20\n2008-01-27\n2008-02-03\n2008-02-10\n2008-02-17\n</code></pre>\n\n<p>Would be great if you could fix my code, but I'm more interested in WHY this behaviour is happening, so explaining like I'm 5 years old might be helpful.</p>\n"},{"tags":["c#","sql","database","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13157760,"title":"SQLite auto increment issue","body":"<p>I have created a SQLite database in C# and i used that query to create a table.</p>\n\n<pre><code>string q = \"create table mains ( id int IDENTITY, desc varchar(20), PRIMARY KEY(id) )\"; \nExecuteQuery(q);\n</code></pre>\n\n<p>And i tried adding a record like that :</p>\n\n<pre><code>string txtSQLQuery = \"insert into  mains (desc) values ('\" + textBox1.Text + \"')\";\nExecuteQuery(txtSQLQuery);\n</code></pre>\n\n<p>I just added a desc and not ID , i guess it should auto increment the id field but it does not.\nInstead it adds the desc and the the ID field is empty every time i add a new record </p>\n\n<p>EDIT :\ni tried using :</p>\n\n<pre><code>id int PRIMARY KEY AUTOINCREMENT\n</code></pre>\n\n<p>But got Error :</p>\n\n<pre><code>SQLite.SQLiteException: near \"AUTOINCREMENT\":\n</code></pre>\n\n<p>EDIT 2 :\nI get that when i load the records :</p>\n\n<p><img src=\"http://i.stack.imgur.com/L9XcX.png\" alt=\"enter image description here\"></p>\n\n<p>There are no Numbers in the ID field at all.</p>\n"},{"tags":["sql","sql-server","sql-server-2008-r2","sql-server-2008-express"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13156336,"title":"How to connect to SQL Server 2008 R2 using SQL Server 2008 Express via stored procedures","body":"<p>I need to know how to connect access the data from SQL Server 2008 R2 database using SQL Server 2008 Express through stored procedure.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","sql","variables"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":358,"score":0,"question_id":10127667,"title":"php variable in sql query","body":"<p>I have this:</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM animals WHERE hand= \" .$_SESSION['SESS_HAND']. \");\n</code></pre>\n\n<p>But always shows \"Parse error: parse error, expecting <code>T_STRING' or</code>T_VARIABLE' or `T_NUM_STRING\"</p>\n"},{"tags":["c#","sql","hibernate","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13144100,"title":"HQL select ID of entity with max value within group","body":"<p>I have this small entity</p>\n\n<pre><code>class Order\n{\n    public long Id;\n    public DateTime Date;\n    public long ProductId;\n}\n</code></pre>\n\n<p>I want to select <code>Id</code> of entity which has <code>MAX(Date)</code> among orders grouped by <code>ProductId</code>.\nPair (<code>MAX(Date)</code>, <code>ProductId</code>) is not unique so this query is wrong:</p>\n\n<pre><code>select o.Id \nfrom Order o \nwhere o.Date = \n   (select max(o2.Date) \n    from Order o2 \n    where o2.ProductId = o.ProductId);\n</code></pre>\n\n<p>Do you have any ideas?</p>\n\n<p>Basically what I want is to get most recent Order from group, so if I assume that greater <code>Id</code> == newer <code>Order</code> this:</p>\n\n<pre><code>select o \nfrom Order o \nwhere o.Id in \n   (select max(o2.Id) \n    from Order o2 \n    group by o2.ProductId);\n</code></pre>\n\n<p>will work for me. Are there any better solutions?</p>\n"},{"tags":["sql","oracle","informatica"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13154203,"title":"Tuning long running query","body":"<pre><code>SELECT a AS a,\n   b AS b,\n   c AS c,\n   d AS d,\n   e AS e,\n   f AS f,\n   g AS g,\n   h AS h\nFROM ( \n   SELECT P.*,\n      ROW_NUMBER() OVER (PARTITION BY p.a, RANK_NM \n      ORDER BY P.ID DESC) RW_NUM \n   FROM ( \n      SELECT T.a,\n         T.b,\n         T.c,\n         T.d,\n         T.e,\n         T.f,\n         T.g,\n         T.h,\n         T.ID\n         DENSE_RANK() over (PARTITION BY T.a \n         ORDER BY T.b, T.c, T.d\n         , T.e, T.f, T.g, T.h\n         DESC) RANK_NM \n      FROM TEST_TABLE T ) p) Y \nWHERE RW_NUM = 1\n</code></pre>\n\n<p>I got this query for tuning from production team, I dont have access to production and other things, I have to give query to production guys to execute and they are expecting a miracle. Problem is TEST_TABLE contains 98 million records and this query is used in informatica and creating a huge cache. Is there any way query can be written in better way, just at looking at query. I know lot of things require and information is needed for tuning but this is all I got. :) Database is oracle 10 g.</p>\n"},{"tags":["c#","sql","sql-server-2008","csv","sqlcmd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13157514,"title":"Split and Export a Database Table Based on Size","body":"<p>All, I have developed an export mechanism to allow the selected tables from a givem database to be exported to .csv files; I can do this using <code>bcp</code> or <code>sqlcmd</code>. For large tables (> 1-2GB), I want to split the tables into serveral .csv files of a predetermined, user specifeid size (say 200MB).</p>\n\n<p>How can I determine the number of rows that make up the users specified size? This is so I can use a <code>sqlcmd</code> command like the following</p>\n\n<pre><code>DECLARE @sql VARCHAR(8000);\nSELECT @sql = 'sqlcmd -S' + @@SERVERNAME + ' -E -Q ' + \n              '\"SELECT * FROM Ia.dbo.[Episode];\" -o \"F:\\aaData\\Test2.csv\" -s\",\" -W';\nEXEC master..xp_cmdshell @sql;\n</code></pre>\n\n<p>with a <code>TOP N</code> clause to get the correct split .csv size. I may have to count the rows using a batch read, or is there a better way to do this?</p>\n\n<p>Thanks for your time.</p>\n"},{"tags":["sql","count"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13157422,"title":"How to use COUNT in my sql query","body":"<p>I'm trying to count the number of occurrence of product_id.\nThis is my query that's return 10 products but not according the number of occurrence of product_id.</p>\n\n<pre><code>SELECT name, category_id, product_id \nFROM product, notification \nWHERE type='product_consumed' OR type='product_rate' AND product.id = notification.product_id AND category_id=\"1\" \nGROUP BY product_id ORDER BY product.category_id ASC LIMIT 10\n</code></pre>\n\n<p>I tried to COUNT the occurrenceof product_id like this, but it returns to me bad results,</p>\n\n<pre><code>SELECT name, category_id, product_id, COUNT(*) AS most_viewed \nFROM product, notification \nWHERE type='product_consumed' OR type='product_rate' AND product.id = notification.product_id AND category_id=\".$cat.\" \nGROUP BY product_id ORDER BY product.category_id ASC, most_viewed DESC LIMIT 10\n</code></pre>\n\n<p>My wish is to have a sql response like this :</p>\n\n<p>Category of the product | Name of product | Number of views</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","regex","uppercase"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":58,"score":3,"question_id":13119958,"title":"Select the records containing one or more words fully in UPPERCASE","body":"<p>I have a query in MYSql database. I have a table <code>order_det</code>, the table's column <code>remarks_desc</code> contains the entries as follows:</p>\n\n<p>Table structure:</p>\n\n<pre><code>Table: order_det\n\nColumns: rec_id, remarks_desc\n</code></pre>\n\n<p>Sample records in order_det table </p>\n\n<pre><code>rec_id      remarks_desc\n_________________________________________________________\n\n1           a specific PROGRAMMING problem\n2           A software Algorithm\n3           software tools commonly USED by programmers\n4           Practical, answerable problems that are unique to the programming profession\n5           then you’re in the right place to ask your question\n6           to see if your QUESTION has been asked BEFORE\n</code></pre>\n\n<p>My requirement I want to select only the records which that contains one more more words stored in all uppercase letters. From the above 6 records, I want to select only below 1,3,6 records: </p>\n\n<pre><code>rec_id      remarks_desc\n__________________________________________________\n1           a specific PROGRAMMING problem (it contains one all uppercase word PROGRAMMING)\n3           software tools commonly USED by programmers (it contains one all uppercase word USED)\n6           to see if your QUESTION has been asked BEFORE (it contains two all uppercase words QUESTION and BEFORE)\n</code></pre>\n\n<p>I tried to archive this using LIKE, REGEXP but getting incorrect result.\nPlease help me to get the correct result.</p>\n"},{"tags":["mysql","sql","group-by","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13156706,"title":"MySQL GROUP BY optimization - InnoDB vs MyISAM?","body":"<h2>Question</h2>\n\n<p>Does anyone know why there is no GROUP BY optimization for MyISAM-based tables? (I'm using this version: 5.1.49-3)</p>\n\n<h2>Test tables</h2>\n\n<pre><code>CREATE TABLE `_test2_innodb` (\n    `i` int(10) unsigned NOT NULL AUTO_INCREMENT,\n    `n` smallint(5) unsigned NOT NULL,\n    `t` int(10) unsigned NOT NULL,\n    `v` smallint(6) NOT NULL,\n    PRIMARY KEY (`i`),\n    KEY `i_n` (`n`),\n    KEY `i_t` (`t`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n\nCREATE TABLE `_test2_myisam` (\n    `i` int(10) unsigned NOT NULL AUTO_INCREMENT,\n    `n` smallint(5) unsigned NOT NULL,\n    `t` int(10) unsigned NOT NULL,\n    `v` smallint(6) NOT NULL,\n    PRIMARY KEY (`i`),\n    KEY `i_n` (`n`),\n    KEY `i_t` (`t`)\n) ENGINE=MyISAM DEFAULT CHARSET=latin1\n</code></pre>\n\n<h2>Test queries</h2>\n\n<pre><code>SELECT MAX(i) FROM _test2_myisam GROUP BY n;\n\nSELECT MAX(i) FROM _test2_innodb GROUP BY n;\n</code></pre>\n\n<h2>Results</h2>\n\n<pre><code>id, select_type, table, type, poss_keys, key, key_len, ref, rows, extra\n\n1, SIMPLE, _test2_myisam , ALL, , , , , 19998, Using temporary; Using filesort\n\n1, SIMPLE, _test2_innodb, index, , i_n, 2, , 20024, Using index\n</code></pre>\n\n<p>The problem is that if I'm using MyISAM, a full table scan will be done, which takes hours on large tables... And the MySQL documentation doesn't mention anything about table engines having different implementations ( <a href=\"http://dev.mysql.com/doc/refman/5.0/en/group-by-optimization.html\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.0/en/group-by-optimization.html</a> ). Does anyone know why is this handled differently internally?</p>\n\n<p>(Note: no, it is not a good solution to switch to InnoDB)\nThanks</p>\n"},{"tags":["sql","orm","foreign-keys","sqlalchemy","sqlsoup"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":226,"score":4,"question_id":6777524,"title":"How to automatically reflect table relationships in SQLAlchemy or SqlSoup ORM?","body":"<p>How do I tell SQLAlchemy to automatically reflect basic Foreign Key references as references to other ORM objects and not integer fields?</p>\n\n<p>In both <a href=\"http://www.sqlalchemy.org/docs/orm/tutorial.html#building-a-relationship\" rel=\"nofollow\">SQLAlchemy</a> and it's <a href=\"http://www.sqlalchemy.org/docs/orm/extensions/sqlsoup.html#relationships\" rel=\"nofollow\">SqlSoup</a>, table columns are reflected automatically and relations can be defined manually:</p>\n\n<pre><code>class User(Base):\n    __table__ = metadata.tables['users']\n    loan = relation(Loans)\n</code></pre>\n\n<p>...</p>\n\n<pre><code>You can define relationships on SqlSoup classes:\n&gt;&gt;&gt; db.users.relate('loans', db.loans)\n</code></pre>\n"},{"tags":["sql","sql-server-2005"],"answer_count":5,"favorite_count":9,"up_vote_count":31,"down_vote_count":0,"view_count":12823,"score":31,"question_id":175962,"title":"Dynamic SELECT TOP @var In SQL Server","body":"<p>How can I have a dynamic variable setting the amount of rows to return in SQL Server? Below is not valid syntax in SQL Server 2005+:</p>\n\n<pre><code>DECLARE @count int\nSET @count = 20\n\nSELECT TOP @count * FROM SomeTable\n</code></pre>\n"},{"tags":["sql","formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13156023,"title":"Two different formatting for different numbers","body":"<p>is there any easy and clean solution to have two different formatting for different numbers.<br>\nE.g. 0.00 should be 0 and all other numbers should be x.xxx. </p>\n\n<p>My solution so far:</p>\n\n<pre><code>select decode(to_char(0.000, '90D999'),'0.000', 0, (to_char (0.000, '99990D99999'))) from dual\n</code></pre>\n\n<p>I am not happy, because I think there is an easier solution.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13156493,"title":"How to create a list of dates from a daterange without using a CTE","body":"<p>The following link explains how to turn a date range into a list of dates.\nI used this approach and it works fine but the query is not performing (I used Maxrecursion 0 to unlimit).</p>\n\n<p><a href=\"http://blog.justinstolle.com/sql-turn-a-date-range-into-a-list-of-dates/\" rel=\"nofollow\">http://blog.justinstolle.com/sql-turn-a-date-range-into-a-list-of-dates/</a></p>\n\n<p>Is there any other solution to get this done? (using subquery or declare table?)</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13156064,"title":"my select query removing duplicate row","body":"<p>I created this select query to get some rows... Its working. but my problem is I need to remove duplicate rows from the query...</p>\n\n<p>this is my query:</p>\n\n<pre><code>SELECT tcs.tutor_id, tcs.category_id, tcs.subject_id, s.subjects, t.tutor_name, t.tutor_code\nFROM tutor_category_subject as tcs\nINNER JOIN subject AS s ON tcs.subject_id = s.subject_id\nINNER JOIN tutors AS t ON tcs.tutor_id = t.tutor_id\nWHERE s.subjects LIKE '%business%';\n</code></pre>\n\n<p>This is its output:</p>\n\n<pre><code>    +----------+-------------+------------+------------------+-------------------+-----------+ \n\n| tutor_id | category_id | subject_id | subjects         | tutor_name        | tutor_code|\n\n+----------+-------------+------------+------------------+-------------------+-----------+\n\n|        1 |           6 |         37 | Business Studies | Tharanga Nuwan    |      1250 |\n|        3 |           6 |         37 | Business Studies | Kumara            |      1252 | \n|       15 |           4 |         11 | Business &amp; Accou | Tharanga Nuwan    |      1264 | \n|       15 |           6 |         37 | Business Studies | Tharanga Nuwan    |      1264 |\n|       16 |           5 |         11 | Business &amp; Accou | Kasun Kalhara     |      1265 | \n|       16 |           6 |         37 | Business Studies | Kasun Kalhara     |      1265 |\n</code></pre>\n\n<p>Here, you can see tutor id has duplicated in my query. and I need to select all subjects to a tutor in one row separated by comma.</p>\n\n<p>eg: (Business &amp; Accounting Studies, Business Studies) like this..</p>\n\n<p>So can anybody tell me what I need to do in my select query??</p>\n\n<p>Thank you. </p>\n\n<p>This is my expecting result</p>\n\n<pre><code>+----------+-------------+------------+-------------------------------------------------+-----------------------+------------+\n| tutor_id | category_id | subject_id | subjects                                        | tutor_name            | tutor_code |\n+----------+-------------+------------+-------------------------------------------------+-----------------------+------------+\n|       16 |           5 |         11 | Business &amp; Accounting Studies, Business Studies | Kasun Kalhara         |       1265 |\n|        3 |           6 |         37 | Business Studies                                | Kumara                |       1252 |\n|        1 |           6 |         37 | Business Studies, Business &amp; Accounting Studies | Tharanga Nuwan Kumara |       1250 |\n+----------+-------------+------------+-------------------------------------------------+-----------------------+------------+\n</code></pre>\n"},{"tags":["sql","oracle","date-arithmetic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13155988,"title":"Finding week number in a month in oracle","body":"<p>I have table where I have stored all mondays e.g (1st oct, 8th oct, 15th oct, 22nd oct, 29th oct), I need to find out week of that month which will be like for 1st oct it will 1, 8th oct 2 and henceforth.. for Sept counter should start at 1 again. Can this is done through sql query, database is oracle 10g?</p>\n\n<p>if first on month is coming on wednesday then first monday in that month should be marked as 1, its second week but need as 1.</p>\n"},{"tags":["sql","oracle","ora-00933"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13156302,"title":"Join with table and sub query in oracle","body":"<p>I don't understand what is wrong with this query.  It is giving me a compile time error of \"command not ended properly\".</p>\n\n<p>The inner query is giving me four records.</p>\n\n<pre><code>select WGN3EVENTPARTICIPANT.EVENTUID \nfrom \n    (Select WGN_V_ADDRESS_1.ADDRESSUID1 as add1,\n            WGN_V_ADDRESS_1.ADDRESSUID2 as add2 \n     from WGN3USER inner join \n          WGN_V_ADDRESS_1 on WGN_V_ADDRESS_1.USERID=wgn3user.USERID \n      where WGN3USER.USERNAME='FIRMWIDE\\khuraj'\n    ) as ta\n    ,WGN3EVENTPARTICIPANT \n where (ta.ADDRESSUID1=WGN3EVENTPARTICIPANT.ADDRESSUID1) AND    \n       (ta.ADDRESSUID2=WGN3EVENTPARTICIPANT.ADDRESSUID2)\n</code></pre>\n\n<p>I am running it in oracle.</p>\n\n<p>Thanks </p>\n\n<p>Amandeep</p>\n"},{"tags":["php","mysql","sql","aggregation"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":137,"score":1,"question_id":12767914,"title":"MYSQL count of count?","body":"<p>I have a mysql table like:</p>\n\n<pre><code>id, visitorid, pageid\n</code></pre>\n\n<p>When a visitor hits the website it stores their visitor id and the page id as a row.</p>\n\n<p>I am trying to extract the number of visitors who hit the website exactly X times. (for a chart). so how many visit just one page, how many visit 2 pages...</p>\n\n<p>so far I have:</p>\n\n<pre><code>SELECT COUNT(visid),visid FROM vislog GROUP BY visid ORDER BY COUNT(visid) DESC\n</code></pre>\n\n<p>But I don't know how to do the next part of counting the counts.</p>\n\n<p>Is it possible to do as a mysql query?</p>\n\n<p><em><strong>Edit:</em></strong> I have <a href=\"http://stackoverflow.com/a/12768098/367456\">added my answer</a>.</p>\n"},{"tags":["sql","ruby-on-rails","postgresql","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13155462,"title":"Fetch posts from non blocking users","body":"<p>I'm trying to fetch some posts from users that isn't blocking \"me\". Se models below:</p>\n\n<pre><code>User\n  id\n  username\n  ....\n\nPost\n  id\n  user_id\n  content\n  ...\n\nBlockings\n  blocker_id\n  blocked_id\n</code></pre>\n\n<p>I need to fetch posts from <strong>all</strong> users that isn't blocking me.</p>\n\n<p>I fetch all posts with:</p>\n\n<pre><code>@posts Post.all\n</code></pre>\n\n<p>But how do I joins this together.</p>\n\n<p>Pseudo</p>\n\n<pre><code>SELECT * FROM posts WHERE \"posts.user_id isn't blocking me\"\n</code></pre>\n\n<p>I have a helper called <code>current_user</code> that returns the current logged in user \"me\".</p>\n"},{"tags":["sql","oracle","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":6,"view_count":37,"score":-4,"question_id":13154807,"title":"Query required for given output","body":"<p>Supose I have data in below format</p>\n\n<pre><code>FIELD1   F2       F3 \nLIN0_TMP    A0  1\nLIN0_TMP    B0  2\nLIN0_TMP    C0  3\nLIN_TMP     A   1\nLIN_TMP     B   2\nLIN_TMP     C   3\nLIN_TMP     D   4\nLIN2_TMP    A2  1\nLIN2_TMP    B2  2\nLIN2_TMP    C2  3\nLIN2_TMP    D2  4\n</code></pre>\n\n<p>i WANT output in below format using oracle sql query. </p>\n\n<pre><code>FIELD1   F2       F3   FLOW\n    LIN0_TMP    A0  1 FLOW1\n    LIN0_TMP    B0  2 FLOW1\n    LIN0_TMP    C0  3 FLOW1\n    LIN_TMP     A   1 FLOW2\n    LIN_TMP     B   2 FLOW2\n    LIN_TMP     C   3 FLOW2\n    LIN_TMP     D   4 FLOW2\n    LIN2_TMP    A2  1 FLOW3 \n    LIN2_TMP    B2  2 FLOW3\n    LIN2_TMP    C2  3 FLOW3\n    LIN2_TMP    D2  4 FLOW3\n</code></pre>\n\n<p>Number of record for field1 is not fixed for each LIN_TMP value..</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13156295,"title":"Timout when Selecting or Deleting a specific row","body":"<p>When executing a select or delete statement on a specific row in a table I get a timeout exception.</p>\n\n<p>How can I delete said row without using a delete statement?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13156202,"title":"can we pass alias name in reference on join condition in sqlserver","body":"<p>i have following query but when i pass reference name of this alias column name it is showing invalid column name how can i do this</p>\n\n<pre><code>select OM.*,\n       convert(int,Replace(Ltrim(Replace(left(OM.mstrefc,6), '0', ' ')), ' ', '0')) as partycode,\n       OI.*,\n       Ac.AcctName,\n       Ac.acctaddr,\n       UN.UnitName\nfrom ordemst OM\n  join ordeitd OI\n    on OM.mstCode = OI.ItdCode\n  join Account Ac \n    on OM.partycode = Ac.acctcode\n  left join unitdet UN\n    on OI.ItdUnit = UN.unitcode and \n       OI.CompCode = UN.CompCode \nwhere OM.MstCode = 47 and \n      OM.MstType =79 and \n      OM.CompCode =117 and \n      AC.compcode =117 and \n      OI.Compcode=117\n</code></pre>\n"},{"tags":["sql","postgresql","aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13156055,"title":"Product Aggregate in PostgreSQL","body":"<p>I try to create an aggregate for product (*) in PostgreSQL.\nThe field type of my row is \"double precision\"</p>\n\n<p>So, I tried :</p>\n\n<pre><code>CREATE AGGREGATE nmul(numeric)\n(\n   sfunc = numeric_mul,\n   stype = numeric\n);\n</code></pre>\n\n<p>When I launch my query, the result :</p>\n\n<pre><code>ERROR:  function nmul(double precision) does not exist\nLINE 4: CAST(nmul(\"cote\") AS INT),\n</code></pre>\n\n<p>Thank you</p>\n"},{"tags":["sql","performance","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":13155738,"title":"SQL vs LINQ performance","body":"<p>We currently have a self-made entity framework that relies on a DB-indipendent ORM.</p>\n\n<p>I have to build a software that batch-loads metadata in the DB for about 150 excel template (with info on cell position, cell type, formatting and more).</p>\n\n<p>I can operate</p>\n\n<ul>\n<li><p>via SQL batch (faster but less interactive)</p></li>\n<li><p>via building objects in memory, processing them with LINQ queries for various integrity checks, and then committing modifications to the DB</p></li>\n</ul>\n\n<p>I know that SQL is absolutely faster, but I would know... <strong>how much is it faster?</strong></p>\n\n<p>In detail, how much is a SQL query faster then a LINQ query <em>(assuming that all needed data has been already loaded in memory by ORM)</em> ?</p>\n"},{"tags":["mysql","sql","database","explain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13155463,"title":"Understanding the output of an EXPLAIN statement (MySQL)","body":"<p>I have a query which is returning the below explain:</p>\n\n<pre><code>id  select_type  table  type         possible_keys                                                                                        key                                                      key_len  ref  rows  Extra                                                                                  \n1   SIMPLE       this_  index_merge  CategoryId,Deleted,PublishedOn,_ComputedDeletedValue,_Temporary_Flag,Published,_TestItemSessionGuid  Deleted,_ComputedDeletedValue,_Temporary_Flag,Published  1,1,1,1       6203  Using intersect(Deleted,_ComputedDeletedValue,_Temporary_Flag,Published); Using where  \n</code></pre>\n\n<p>Does this show that the query is using indexes everywhere, or can it be improved by adding other indexes?  Based on this: <a href=\"http://dev.mysql.com/doc/refman/5.1/en/explain-output.html\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.1/en/explain-output.html</a>, it mentions that the <code>key</code> column shows the indexes actually used.  I have an index on every column.</p>\n\n<p>The query in question is the below:</p>\n\n<pre><code>SELECT SQL_NO_CACHE count(*) FROM \n\narticle this_ \n\n\nWHERE \n\n\n(this_._Temporary_Flag = 0 OR this_._Temporary_Flag = NULL) AND \nthis_.Published = 1 AND \n(this_.PublishedOn IS NULL OR this_.PublishedOn &lt;= '2012-10-30 18:46:18 ') AND \n(this_.Deleted = 0 OR this_.Deleted = NULL) AND \n(this_._ComputedDeletedValue = 0 OR this_._ComputedDeletedValue = NULL) AND\n((this_._TestItemSessionGuid IS NULL OR this_._TestItemSessionGuid = ''))\n\n AND NOT (this_.CategoryId IS NULL) \n</code></pre>\n\n<p>Table has approximately 140,000 records.  This query is taking 3 seconds to execute, and returning 135,725 as result.</p>\n"},{"tags":["sql","wpf","query","designer","builder"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13156142,"title":"WPF query builder control","body":"<p>I wonder if there is any sql query builder out there meeting these conditions:</p>\n\n<ol>\n<li>Available as WPF control so that it can be integrated in my WPF app</li>\n<li>At least support of MS SQL Server and Oracle</li>\n<li>Visual representation and drag/drop support (tables, columns)</li>\n<li>SQL expression as a result property (no fancy \"user-friendly\" meta concept)</li>\n<li>Possibility to edit the SQL expression manually (with changes to the visual representation)</li>\n<li>No need to build up a metadata model before </li>\n</ol>\n\n<p>I already spend some time on the web with the following results </p>\n\n<ol>\n<li>ActiveQueryBuilder is functionally perfect but does not fit 1. (lacks WPF support)  [http://www.activequerybuilder.com/index.html?from=about&amp;edition=net]</li>\n<li>KorzhEasyQueryNET does not fit 5. (SQL is not written back to visual) and 6. (metadata model needed) [http://devtools.korzh.com]</li>\n<li>Query Objects is not a component but a standalone tool [http://www.query-objects.com/]</li>\n</ol>\n\n<p>So, is anybody out who knows of an alternative?</p>\n\n<p>Regards</p>\n"},{"tags":["sql","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13155807,"title":"Query to fetch data inline or comma separated data","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/92698/combine-rows-in-access-2007\">Combine rows in Access 2007</a>  </p>\n</blockquote>\n\n\n\n<p>I have a table in MS Access Databse \ncalled as \"emp_orders\"</p>\n\n<p>And the data appears as below,</p>\n\n<pre><code>emp_no  order_no \n1       123\n1       156\n1       264\n2       234\n2       354\n2       268\n2       182\n</code></pre>\n\n<p>now i need a select query which fetches data as specified below.</p>\n\n<pre><code>emp_no  orders\n1       123,156,264\n2       234,354,268,182\n</code></pre>\n\n<p>Please help me out to sort this.</p>\n"},{"tags":["sql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13154023,"title":"Age intervals as row statistics with SQL","body":"<p>I'm trying to create this summary statistic table, counting the number of individuals in each category</p>\n\n<pre><code>Agegroup   |    All    |    Female   |    Male\n------------------------------------------------\nAll        |  560594   |    34324    |   234244\n&lt; 20       |   4324    |     545     |    3456\n20 - 30    |  76766    |     3424    |   32428\n30 - 40    |  36766    |     764     |   82427\n40 - 50    |  46766    |     4324    |   72422\n50 - 60    |  66766    |     3424    |   52424\n&gt; 60       |  76766    |    43424    |   12423\n</code></pre>\n\n<p>from this table</p>\n\n<pre><code>PersonID  |   Age   |  Sex   \n----------------------------\n  A      |    43    |   F\n  B      |    22    |   F\n  C      |    65    |   M\n  D      |    33    |   F\n  E      |    28    |   M\n</code></pre>\n\n<p>Is this even possible \"in one go\" with SQL? I experimented with this, but it's not really coming together..</p>\n\n<pre><code>SELECT SUM(CASE WHEN Age &lt; 20 THEN 1 ELSE 0 END) AS [Under 20],\n    SUM(CASE WHEN Age BETWEEN 20 AND 30 THEN 1 ELSE 0 END) AS [20-30],\n    SUM(CASE WHEN Age BETWEEN 30 AND 40 THEN 1 ELSE 0 END) AS [30-40]\nFROM Persons\n</code></pre>\n"},{"tags":["c#","sql","asp.net-mvc","video","flowplayer"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":108,"score":3,"question_id":12873954,"title":"How to return video (flv) path to display in flowplayer?","body":"<p>I would like to integrate flowplayer in ASP mvc 3 application.\nI'm using SQL Server 2008. Database contains path to files as well which are stored in folder. I wrote library which is able to convert video to flv. Now i would like to use this video in page. </p>\n\n<p>Does anyone have knowledge how to implement that?</p>\n\n<p>I found the flowplayer sample code.</p>\n\n<p><a href=\"http://flowplayer.org/docs/\" rel=\"nofollow\">http://flowplayer.org/docs/</a></p>\n\n<p>But I'm looking for codebehind solution (C#) how to implement something like that (how to return path to video).\nIf anyone have some code I'll be grateful for help.</p>\n\n<p>Please take a look.</p>\n\n<pre><code>    public string FindMusicByID(int musicID)\n    {\n        var pathh = from plik in _data.musicMusicTables\n                    where plik.musicMusicID == musicID\n                    select new PathToFile { PathFile = plik.musicMusicPath };\n        return pathh.ToString();\n    }\n</code></pre>\n\n<p>This is the linq part code which i'm using. FindMusicByID(int musicID) return path to .flv file. I'm looking for how to send output filepath to webpage. I would like to use this path in flowplayer.</p>\n\n<p><code>&lt;div class=\"flowplayer\" data-engine=\"flash\"&gt; &lt;video src=\"some path\"&gt;&lt;/video&gt;\n</code> </p>\n\n<p>Fox example this is my ouptut path d:\\file.flv</p>\n\n<p>I suppose that it's necessary to send output to JavaScript.\nHow can i insert path into flowplayer by ID?</p>\n"},{"tags":["sql","mysql"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1604,"score":4,"question_id":950628,"title":"MySQL: How to get n latest rows of a distinct type","body":"<p>Putting this as simply as I can, I have the following table structure:</p>\n\n<p><code>Date | Type | Title</code></p>\n\n<p>Say <code>Type</code> is a value in the range 1-10, I have 1,000s of records in the table, and I want the 5 most recent records of unique type. So the result would be something like:</p>\n\n<p><code>2009-06-04 14:32:00 | 4 | Zeppo</code></p>\n\n<p><code>2009-06-04 14:31:00 | 2 | Groucho</code></p>\n\n<p><code>2009-06-04 14:30:00 | 8 | Harpo</code></p>\n\n<p><code>2009-06-04 14:29:00 | 5 | Gummo</code></p>\n\n<p><code>2009-06-04 14:28:00 | 3 | Chico</code></p>\n\n<p>Seems like I either want <code>DISTINCT</code> to only apply to the <code>Type</code> column, or I want a <code>GROUP BY</code> which will apply <em>after</em> an <code>ORDER BY</code> clause.</p>\n\n<p>All in MySQL 4.</p>\n"},{"tags":["sql","sql-server-2008","compression"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13155630,"title":"PAGE compression in SQL Server effect on running queries","body":"<p>I am planning to apply PAGE compression to some of the big tables in my database (DW to be precise). These tables are fairly big with over 15 Billion rows. When I applied the compression in test environment, the whole process took around 22 hours.These tables are accessed daily with quite long running queries.  My questions are</p>\n\n<ol>\n<li>While the compression is being applied would there be any affect on the queries that are running? Any lock etc I should be aware of?</li>\n<li>Is there a staggered approach to applying compression? </li>\n</ol>\n\n<p>3.Any other input/feedback you might have?</p>\n\n<p>many thanks</p>\n\n<p>Sean</p>\n"},{"tags":["php","sql","unix","web-applications","xampp"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":56,"score":-4,"question_id":13140230,"title":"Using PHP , call a sql inside a unix script","body":"<p>I read the below link, my issue is different.\nI am running the xampp on WINDOWS, and my php script is connecting to a unix script on a different server (ssh2_connect(\"11.31.138.56\", 22). I am running the unix script and inside this script I am calling the .sql file . The SQL is connecting to oracle db on the unix server.</p>\n\n<p>But the sqlplus command is not working when called using php , but when I run the script on unix everything is working fine.</p>\n\n<p>PHP CODE:</p>\n\n<pre><code>&lt;?php \ninclude 'db_connect.php';\nif (!function_exists(\"ssh2_connect\")) die(\"function ssh2_connect doesn't exist\");\n// log in at server1.example.com on port 22\nif(!($con = ssh2_connect(\"11.31.138.56\", 22))){\n    echo \"fail: unable to establish connection\\n\";\n} else {\n    // try to authenticate with username root, password \n    if(!ssh2_auth_password($con, \"uat0\", \"unix11\")) {\n        echo \"fail: unable to authenticate\\n\";\n    } else {\n        // allright, we're in!\n        echo \"okay: logged in...\\n\";\n\n        // execute a command\n        if (!($stream = ssh2_exec($con,\"sh mysql2.sh\" ))) {\n            echo \"fail: unable to execute command\\n\";\n        } else {\n            // collect returning data from command\n\n            $errorStream = ssh2_fetch_stream($stream, SSH2_STREAM_STDERR);\n\n            // Enable blocking for both streams\nstream_set_blocking($errorStream, true);\nstream_set_blocking($stream, true);\n// Whichever of the two below commands is listed first will receive its appropriate output.  The second command receives nothing\necho \"Output: \" . stream_get_contents($stream);\necho \"Error: \" . stream_get_contents($errorStream);\n\n\n\n\n            $data = \"\";\n            while ($buf = fread($stream,4096)) {\n                $data .= $buf;\n               // echo $data;\n            }\n           // echo $stream;\n            fclose($errorStream);\n            fclose($stream);\n        }\n    }\n}\n?&gt;\n</code></pre>\n\n<p>Unix script:</p>\n\n<pre><code>#!/bin/ksh\n\nsqlplus -s XLTDB10/XLTDB10@XLTUAT1 @mysql.sql \n</code></pre>\n\n<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4027769/running-mysql-sql-files-in-php\">Running MySQL *.sql files in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>I am creating a web application using XAMPP. In the web application I have to display sql data. \nThe sql's are kept on the unix environment I want to run those sql's and display the output.</p>\n\n<p>I am able to connect to unix environment, wanted to check if it is possible to run SQL's and grab the output and later parse it and display it.</p>\n"},{"tags":["sql","parallel-processing","ssms2008","sqlperformance"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13154480,"title":"How to make 2 queries use 2 CPUs","body":"<p>I have a query of the following shape :</p>\n\n<pre><code>A\nUNION ALL\nB\nUNION ALL\nC\nUNION ALL\nD\n</code></pre>\n\n<p>And would like to parallelize it by calling A, B, C and D in parallel and then, union them in .Net. Those 4 queries all read data in the <strong>same</strong> pool of tables.</p>\n\n<p>The first step I tried is to execute A in one Tab of SSMS and B in a second tab. A, and B last about 1 minute each, so I have the time to launch A, then go to tab B and launch it.</p>\n\n<p>But when I look at CPU usage, it stalls at 13% (I'm on a 8 core CPU @ Windows), which corresponds to 100% of one core.</p>\n\n<p>My questions :\n- do the \"lock\" mechanisms allow two queries on a given set of tables to run in parallel ?\n- if parallelism is possible, would I notice it by trying to run A and B in parallel in two SSMS tabs or is my test flawed ?\n- how would it be possible to improve the performance of that UNION ALL series eventually ?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13155310,"title":"Can FORCE SCAN improve performance of query","body":"<p>I think FORCE SEEK can improve the performance of SELECT query, but wondering if FORCE SCAN can also improve performance of query.</p>\n\n<p>Can someone explain with example?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13155104,"title":"Select persons which have overlap with other table","body":"<p>I didn't even know how to come up with a good title, so i hope i can describe my problem oin a right way :)</p>\n\n<p>So i have a person table, and it has a N:N relationship with keywords via the table PersonKeywords.</p>\n\n<p>Then i also have a Search table, and it also has a N:N relationship with keywords via the table SearchKeywords.</p>\n\n<p>Now the person can have a relationship with keyword A and B, and the search record can have a relationship with the keywords A and C.</p>\n\n<p>Now i want the person in my resultset, because it has at least one (in this 'A') of the keywords the search record has.</p>\n\n<p>I also want the person who has 'A', the one with 'C', the one with 'A' and 'C', but not the one with only B.</p>\n\n<p>So it's a match on two lists, but i don't know where to start to create such a statement...</p>\n"},{"tags":["php","sql","while-loop"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1228,"score":1,"question_id":8022353,"title":"How to populate HTML dropdown list with values from database","body":"<p>as part of a HTML form I am creating I would like to have a dropdown list which will list all the usernames in my database.</p>\n\n<p>I thought the following code would do the trick but the dropdown list is empty - could someone assist me in what i'm doing wrong? Thanks.</p>\n\n<pre><code>&lt;tr&gt;\n&lt;td&gt;Owner&lt;/td&gt;\n&lt;td&gt;\n&lt;select name=\"owner\"&gt;\n&lt;?php \n\n$sql = mysql_query(\"SELECT username FROM users\");\n\nwhile ($row = mysql_fetch_array($sql)){\n\n?&gt;\n&lt;option value=\"owner1\"&gt;&lt;?php echo $row['username']; ?&gt;&lt;/option&gt;\n\n&lt;?php\n// close while loop \n}\n?&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13155123,"title":"How skip id's from parent table on base of child table values","body":"<p>I have two tables</p>\n\n<pre><code>table1  \n\nides    name\n\n1001    AA\n1002    BB\n1003    CC\n\n\ntable2      \n\nides    posi    cwawr\n\n1001    2   xyz\n1001    4   lmn\n1001    6   abc\n1002    2   ijk\n1002    4   lmo\n1002    6   pqr\n1003    2   xyz\n1003    4   sfs\n</code></pre>\n\n<p>in both above table i want to select the all ides of table1 where the posi not equal to 2 and cwawr not equal to xyz. for example 1001 posi has 2 and cwawr has xyz so this id should be skip. same 1003 also have posi value 2 and cwawr has xyz so it also should be skip.</p>\n\n<p>so in result it should be </p>\n\n<pre><code>1002 \n</code></pre>\n\n<p>only.</p>\n\n<p>Thanks in advance,\nEshwer</p>\n"},{"tags":["sql","sql-server"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13084693,"title":"Query to display rows having duplicate values in 2 columns","body":"<p>I have Table1:</p>\n\n<pre><code>id|name|city\n-------------\n1 | bat|nyc\n2 | cat|del\n2 | rat|bom\n3 | mat|xyz\n</code></pre>\n\n<p>Table2</p>\n\n<pre><code>id|name|city\n--------------\n1 |bat|dsada\n2 |cat|sadasd\n3 |rat|sdasdas\n2 |rat|asdas\n</code></pre>\n\n<p>I need a query to display rows where BOTH id and name are same among two tables in above example the query must return \ni need a query to display the rows </p>\n\n<pre><code>1|bat|nyc\n2|cat|del \n</code></pre>\n\n<p>from first table</p>\n"},{"tags":["php","html","sql","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13154180,"title":"Turning a database result printout of a JPEG name into a HTML link that opens in a new tab?","body":"<p>I am creating a PHP page where the page prints out the whole of a database I have of meat packaging. I am printing the results of the database in order of their shape (Rectangular, Oval, Square, Insert). I can happily get the database to print out the results but what I want to do for one of the columns is change the result that is printed into a HTML link. </p>\n\n<p>This column is 'Imagename', it prints the name of a JPEG that is stored on the server. I want it so that when the result for 'Imagename' is printed with the JPEG on the side it isn't text but actually a link to a new tab that displays the picture for the user to view. </p>\n\n<p>Here is my current PHP that loops through the database printing it in a table:</p>\n\n<pre><code>&lt;?php\n\n$con = mysql_connect(\"localhost\", \"horizon1\", \"\");\nmysql_select_db(\"horizon1_delyn\", $con);\n\nif ( ! $con)\n{\n  die(\"Could not connect: \" . mysql_error());\n}\n\n$rectangular = mysql_query(\"SELECT toolcode, description, traysize, imagename FROM range WHERE trayshape ='rectangular' ORDER BY traysize\");\n$oval        = mysql_query(\"SELECT toolcode, description, traysize, imagename FROM range WHERE trayshape ='oval' ORDER BY traysize\");\n$square      = mysql_query(\"SELECT toolcode, description, traysize, imagename FROM range WHERE trayshape ='square' ORDER BY traysize\");\n$insert      = mysql_query(\"SELECT toolcode, description, traysize, imagename FROM range WHERE trayshape ='insert' ORDER BY traysize\");\n\n$fields_num = mysql_num_fields($rectangular);\n\necho \"&lt;table width='97%' border='0' cellspacing='0' cellpadding='0'&gt;&lt;tr&gt;\";\n\n\n//*RECTANGULAR*//\n\nfor ($i = 0; $i &lt; $fields_num; $i++)\n{\n  $field = mysql_fetch_field($rectangular);\n  echo \"&lt;td bgcolor='#E8CF24' style='font-family: arial;font-size: 12px;'&gt;{$field-&gt;name}&lt;/td&gt;\";\n}\n\necho \"&lt;/tr&gt;\\n\";\n\nwhile ($row = mysql_fetch_row($rectangular))\n{\n  echo \"&lt;tr&gt;\";\n\n  foreach ($row as $cell)\n    echo \"&lt;td style='font-family: arial;font-size:12px'&gt;$cell&lt;/td&gt;\";\n  echo \"&lt;/tr&gt;\\n\";\n}\nmysql_free_result($rectangular);\n\n\n//* OVAL *// \n\nfor ($i = 0; $i &lt; $fields_num; $i++)\n{\n  $field = mysql_fetch_field($oval);\n  echo \"&lt;td bgcolor='#E8CF24' style='font-family: arial;font-size: 12px'&gt;{$field-&gt;name}&lt;/td&gt;\";\n}\n\necho \"&lt;/tr&gt;\\n\";\n\nwhile ($row = mysql_fetch_row($oval))\n{\n  echo \"&lt;tr&gt;\";\n\n  foreach ($row as $cell)\n    echo \"&lt;td style='font-family: arial;font-size:12px'&gt;$cell&lt;/td&gt;\";\n\n  echo \"&lt;/tr&gt;\\n\";\n}\nmysql_free_result($oval);\n\n\n//* SQUARE *// \n\nfor ($i = 0; $i &lt; $fields_num; $i++)\n{\n  $field = mysql_fetch_field($square);\n  echo \"&lt;td bgcolor='#E8CF24' style='font-family: arial;font-size: 12px'&gt;{$field-&gt;name}&lt;/td&gt;\";\n}\n\necho \"&lt;/tr&gt;\\n\";\n\nwhile ($row = mysql_fetch_row($square))\n{\n  echo \"&lt;tr&gt;\";\n\n  foreach ($row as $cell)\n    echo \"&lt;td style='font-family: arial;font-size:12px'&gt;$cell&lt;/td&gt;\";\n\n  echo \"&lt;/tr&gt;\\n\";\n}\nmysql_free_result($square);\n\n\n//* INSERT *// \n\nfor ($i = 0; $i &lt; $fields_num; $i++)\n{\n  $field = mysql_fetch_field($insert);\n  echo \"&lt;td bgcolor='#E8CF24' style='font-family: arial;font-size: 12px'&gt;{$field-&gt;name}&lt;/td&gt;\";\n}\n\necho \"&lt;/tr&gt;\\n\";\n\nwhile ($row = mysql_fetch_row($insert))\n{\n  echo \"&lt;tr&gt;\";\n\n  foreach ($row as $cell)\n    echo \"&lt;td style='font-family: arial;font-size:12px'&gt;$cell&lt;/td&gt;\";\n\n  echo \"&lt;/tr&gt;\\n\";\n}\nmysql_free_result($insert);\n\n?&gt;\n</code></pre>\n\n<p>Does anyone have any idea how I could in a sense isolate the 'Imagename' column to make the images clickable? Thanks for your help?</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13150915,"title":"SQL - Average number of records within a time period","body":"<p>I'm trying to compile some lifetime value information for customers within one of our databases.</p>\n\n<p>We have an MS SQL Server database which stores all of our customer/transactional information.</p>\n\n<p>My issue is that I don't have much experience when it comes to MS SQL Server (or SQL in general) - I'd like to be able to run a query against the database that pulls AVG number of loans, and AVG revenue based on three criteria:</p>\n\n<p>1.) Loans be counted if they are 'approved'\n2.) Loans from a customer_id only be counted if the first loan (first identified by date_created field) be on or after a certain 'mm/yyyy'\n3.) I'm able to specify for how many months after the first 'mm/yyyy' to tally the number of loans / revenue to be included within the AVG</p>\n\n<p>Here is what the database would look like:</p>\n\n<pre><code>customer_id   | loan_status | date_created      | revenue\n111       | 'approved'  | 2010-06-20 17:17:09   | 100.00\n222       | 'approved'  | 2010-06-21 09:54:43   | 255.12\n333       | 'denied'    | 2011-06-21 12:47:30   | NULL\n333       | 'approved'  | 2011-06-21 12:47:20   | 56.87\n222       | 'denied'    | 2011-06-21 09:54:48   | NULL\n222       | 'approved'  | 2011-06-21 09:54:18   | 50.00\n111       | 'approved'  | 2011-06-20 17:17:23   | 100.00\n... loads' of records ...\n555       | 'approved'  | 2012-01-02 09:08:42   | 24.70\n111       | 'denied'    | 2012-01-05 02:10:36   | NULL\n666       | 'denied'    | 2012-02-05 03:31:16   | NULL\n555       | 'approved'  | 2012-02-17 09:32:26   | 197.10\n777       | 'approved'  | 2012-04-03 18:28:45   | 300.50\n777       | 'approved'  | 2012-06-28 02:42:01   | 201.80\n555       | 'approved'  | 2012-06-21 22:16:59   | 10.00\n666       | 'approved'  | 2012-09-30 01:17:20   | 50.00\n</code></pre>\n\n<p>If I wanted to find the avg transaction count (approved transactions), and average revenue per approved transaction for all customer's who's <strong>first</strong> loan was in/after 2012-01, and for a period of 4 months after then, how would I go about querying the database?</p>\n\n<p>Any help is greatly appreciated.</p>\n"},{"tags":["c#","sql","database","connection-string"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":108,"score":3,"question_id":13154605,"title":"SQL connection string in C#","body":"<p>I read different way of writing of connection string in article </p>\n\n<blockquote>\n  <p><a href=\"http://www.connectionstrings.com/sql-server-2012\" rel=\"nofollow\">http://www.connectionstrings.com/sql-server-2012</a></p>\n</blockquote>\n\n<p>Can you please explain me where to use <code>Server</code> and where to use <code>Data Source</code> ? Similarly where to use <code>Database</code> and where to use <code>Initial Catalog</code>. Please explain in detail. I am new in SQL Server.</p>\n"},{"tags":["sql","database","sqlite","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13154604,"title":"Delete from database all selected rows except first two","body":"<p>I need to delete all dates from database except first two selected dates:</p>\n\n<pre><code>SELECT DateColumn \nFROM Table \nGROUP BY date(DateColumn) \nORDER BY DateColumn DESC\n</code></pre>\n\n<p>I want in one query to delete all dates except first two.</p>\n"},{"tags":["java","sql","hibernate","many-to-many","hql"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":89,"score":3,"question_id":13153592,"title":"Hibernate many-to-many join with condition","body":"<pre><code>+-------+    +--------------|     +-------+\n| BOY   |    | BOY_GIRL     |     | GIRL  | \n+-------+    +--------------|     +-------+\n| id    |    | id           |     | id    |\n| name  |    | boy_id       |     | name  |\n| birth |    | girl_id      |     | birth |\n+-------+    | start_dating |     +-------+\n             +--------------|\n</code></pre>\n\n<p><code>START_DATING</code> is type of <code>TIMESTAMP</code> or <code>DATE</code></p>\n\n<p>I have two beans Boy and Girl with many-to-many relation</p>\n\n<pre><code>@ManyToMany(fetch = FetchType.LAZY)\n@JoinTable(name = \"BOY_GIRL\", joinColumns = {@JoinColumn(name = \"BOY_ID\")}, inverseJoinColumns = {@JoinColumn(name = \"GIRL_ID\")})\npublic Set&lt;Girl&gt; getGirls() {\n    return girls;\n}\n</code></pre>\n\n<p>Now, how can I do select query with HQL, if I want to get the list girls with condition:  </p>\n\n<pre><code>where boy_id = (some_boy_id) and START_DATING &gt; (some_timestamp)\n</code></pre>\n"},{"tags":["sql","tsql","unit-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12171214,"title":"SQL Unit Testing Creating test for Stored procedure that does not necessarily return a value","body":"<p>I am new to sql unit testing but I have written my first test and trying to make sure this is a sensible test. So I have a stored procedure that does a simply Update(if exists) or insert(if not exists). Using TSQLUnit, I wrote the test below to test my stored procedure called <strong>spModifyData</strong>. What the test is designed to do is verify that when an existing ID is passed, a new record is not created in the database. </p>\n\n<pre><code>ALTER PROCEDURE [dbo].[ut_TestspModifyData] \nAS\nBEGIN \n    SET NOCOUNT ON;\n     -- Setup the test conditions by inserting test data\n     DECLARE \n                @newidone uniqueidentifier,\n                @newidtwo uniqueidentifier,\n                @newidthree uniqueidentifier,\n                @ExpectedID uniqueidentifier,\n                @ActualID uniqueidentifier\n\n                SET @ActualID = '13E7C741-9A04-4E84-B604-141874A6A9B4'\n                SET @ExpectedID = '13E7C741-9A04-4E84-B604-141874A6A9B4'\n                SET @newidone = newID()\n                SET @newidtwo = newID()\n                SET @newidthree = newID()\n\n                 INSERT INTO DataSource( [DataSourcePrimarySource],[DataSourceName],[DataSourceRecordCreateDate] \n          ,[DataSourceStatus] ,[DataSourceIsActive]) VALUES ('PRIMARY SOURCE ONE', 'XYZ', GETDATE() , @newidone, 1)\n\n  -- Exercise the test\n EXEC  spModifyDataSource @ActualID , 'PRIMARY SOURCE ONETWO', 'BBB', @newIDone, 0  \n\n -- Assert expectations\n IF (@ExpectedID != @ActualID)\n                EXEC dbo.tsu_Failure 'ModifyData failed.' \n\n-- Teardown\n -- Implicitly done via ROLLBACK TRAN\n\nEND\n</code></pre>\n"},{"tags":["sql","sql-server","xml","xquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13136311,"title":"How To retrieve value of an element from same name multiple elements in XML through xQuery?","body":"<p>I have and xml field like this in sql server</p>\n\n<pre><code>&lt;propertyDetail&gt;\n  &lt;importID&gt;1735532&lt;/importID&gt;\n  &lt;pincode /&gt;\n  &lt;landmarks /&gt;\n  &lt;features&gt;\n    &lt;feature&gt;Society  Name: sec-87 srs peral  floor faridabad&lt;/feature&gt;\n    &lt;feature&gt;Transaction: Resale Property&lt;/feature&gt;\n    &lt;feature&gt;Possession: Dec,2011&lt;/feature&gt;\n    &lt;feature&gt;*Ownership: Freehold*&lt;/feature&gt;\n    &lt;feature&gt;Age of Property: Under Construction&lt;/feature&gt;\n  &lt;/features&gt;\n&lt;/propertyDetail&gt;\n</code></pre>\n\n<p>I want to retrieve the feature which has value \"<strong>Ownership: Freehold</strong>\" through xQuery and sequence of features may vary.</p>\n\n<p>Welcome any suggestion.</p>\n"},{"tags":["java","sql","sql-server-2005","playframework","playframework-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13144887,"title":"Setting up Play 2.0 project with Sql Server 2005","body":"<p>I previously had my app set up to use a MySQL db as the default, and it worked fine.</p>\n\n<p>Now I'm trying to get it to work with <strong><em>SQL server 2005</em></strong>. The I tried this and several similar variants:</p>\n\n<h2>application.conf</h2>\n\n<pre><code>db.default.url=\"jdbc:sqlserver://remoteServerName:Port\"\ndb.default.driver=com.microsoft.jdbc.sqlserver.SQLServerDriver\ndb.default.user=correctUser\ndb.default.pass=correctPass\n</code></pre>\n\n<p>But I'm getting the following error:</p>\n\n<pre><code>Driver not found: [com.microsoft.jdbc.sqlserver.SQLServerDriver]\n...\ncaused by: java.lang.ClassNotFoundException: com.microsoft.jdbc.sqlserver.SQLServerDriver\n</code></pre>\n\n<p>At first glance, it seems like this would hint the jdbc driver JAR is missing from the build path. The problem is, it <em>isn't</em> missing from the build path. sqljdbc4.jar is sitting in the build path with everything else.</p>\n\n<p>Am I missing something? I'm not sure where to go here.</p>\n"},{"tags":["sql","sql-server","insert","temptables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13153420,"title":"Create temp table from provided variable column names","body":"<p>I want to create a temporary table, in which the columns will be those which I provide as parameter, separated by a delimiter. </p>\n\n<p>For example, if the column names are: id, name, address..the respective table should contain the same amount and header names of the columns. Similarly, next time the column number and names could vary. </p>\n\n<p>Any help in this regard?</p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13135580,"title":"mysql select related items based on current item","body":"<p>i have a scenario, lets say 3 users review a business of id 10, how can i get all the unique id of the user who review that business and and use that unique id to find another business review which is not equal to 10 ? </p>\n\n<p>sample table user_review:</p>\n\n<pre><code>review_id | user_id | business_id | rating | review_date\n  1           2          10           3       20121030124001\n  2           2          9            3       20121022120627\n  3           2          10           4       20121023120627\n  4           3          10           4       20121024120627\n  5           3          6            3       20121022140627\n  6           4          10           2       20121025120627\n  7           4          10           5       20121030120627\n  8           3          10           2       20121010120627\n  9           4          8            5       20121028120627\n</code></pre>\n\n<p>i should get result of these</p>\n\n<pre><code>review_id | user_id | business_id | rating | review_date\n  2           2          9            3       20121022120627\n  5           3          6            3       20121022140627\n  9           4          8            5       20121028120627\n</code></pre>\n\n<p>In a above result if there is 2 reviews for a same user_id and same business_id the latest one should be return.Thanks</p>\n"},{"tags":["sql","stored-procedures","sql-server-2008-r2","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13151804,"title":"How to test a query against a stored procedure","body":"<pre><code>-- =============================================\n\nALTER PROCEDURE [dbo].[NST_GetCboCurrencyAfterUpdate]\n@AccCurrency nvarchar(3)='',\n\n@AccSgroup nvarchar(6)= '',\n\n@AccInternalCie int=null\n\nAS\n\nBEGIN\n\nSET NOCOUNT ON;\n\n    IF @AccInternalCie is not null and @AccCurrency &lt;&gt; '' and @AccSgroup &lt;&gt; ''\n    Begin\n    SELECT * FROM TblAccounts Where \n   AccInternalCie = @AccInternalCie and AccCurrency = @AccCurrency and AccSgroup = @AccSgroup ORDER BY AccDescription\n\n   End \n\n\n    Else if @AccInternalCie is not null and @AccCurrency &lt;&gt; ''\n   Begin\n   SELECT * FROM TblAccounts Where \n   AccInternalCie = @AccInternalCie and AccCurrency = @AccCurrency ORDER BY AccDescription\n   END\n\n   Else if @AccInternalCie is not null and @AccSgroup &lt;&gt; ''\n   Begin\n   SELECT * FROM TblAccounts Where \n   AccInternalCie = @AccInternalCie and AccSgroup = @AccSgroup ORDER BY AccDescription\n   END\n\n    Else if @AccCurrency &lt;&gt; '' and @AccSgroup &lt;&gt; ''\n   Begin\n   SELECT * FROM TblAccounts Where \n   AccCurrency = @AccCurrency and AccSgroup = @AccSgroup ORDER BY AccDescription\n   END\n  Else if @AccSgroup &lt;&gt; '' \n   Begin\n   SELECT * FROM TblAccounts Where \n    AccSgroup = @AccSgroup \n    Print @AccSgroup\n   END\n    Else if @AccCurrency &lt;&gt; '' \n   Begin\n   SELECT * FROM TblAccounts Where \n    AccCurrency = @AccCurrency ORDER BY AccDescription\n   END\n     Else if @AccInternalCie is not null \n   Begin\n   SELECT * FROM TblAccounts Where \n   AccInternalCie = @AccInternalCie \n   END\n\nend \n</code></pre>\n\n<p>I have the following stored procedure , How do i test with debugging in SQL SERVER MANAGEMENT STUDIO How a particular query is being executed</p>\n\n<pre><code>Select * from TblAccounts where AccSGroup = '1000'\n</code></pre>\n\n<p>Say only AccSGroup is not equal to '' so </p>\n\n<pre><code>   Else if @AccSgroup &lt;&gt; ''       \n    Begin\n    SELECT * FROM TblAccounts \n    Where AccSgroup = @AccSgroup \n    Print @AccSgroup\n   END\n</code></pre>\n\n<p>query should be executed and rest must be bypassed</p>\n"},{"tags":["sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7624,"score":0,"question_id":6899502,"title":"org.hibernate.exception.SQLGrammarException: could not execute query?","body":"<p>I got this exception when i try to get the list using NamedQuery:</p>\n\n<p><code>org.hibernate.exception.SQLGrammarException: could not execute query</code></p>\n\n<p>Below I mentioned code:</p>\n\n<p><strong>Entity Class  Code:<br></strong></p>\n\n<pre><code>@Table(name = \"tbl_users\")\n@XmlRootElement\n@NamedQueries({@NamedQuery(name = \"TblUsers.findAll\", query = \"SELECT t FROM TblUsers t\")});\n</code></pre>\n\n<p><strong>DAO implement Code:<br></strong></p>\n\n<pre><code>org.hibernate.Query query = session.getNamedQuery(\"TblUsers.findAll\");\nList list = query.list();\n</code></pre>\n\n<p>Please provide solution for this exception.</p>\n"},{"tags":["mysql","sql","clear"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":42,"score":-3,"question_id":13150545,"title":"Clear sql syntax that I had type","body":"<p>I want to change root password\nexample : SET PASSWORD FOR 'root'@'localhost' = PASSWORD('abcdefg'); </p>\n\n<p>I need to clear the history of sql syntax that I had type.\nCoz when someone can access the server, they can press up and easily can know the password of root.</p>\n\n<p>Is that possible for me to clear the history? \nor there is others way to change root password without type the password like that?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13148625,"title":"PROBLEMA SQL SERVER ROLLBACK trigger","body":"<p>good afternoon,\nI have a problem with the rollback ... Treger initially was using to call the procedure and the procedure is triggered rollback but it is ...\nNow I'm trying to do the rollback from trigger nor ...</p>\n\n<p>attached the code and the error</p>\n\n<p>Thanks for your help</p>\n\n<pre><code>USE [Desarrollo_Pruebas]\nGO\n/****** Object:  Trigger [dbo].[Prueba_tre]    Script Date: 10/30/2012 17:02:53 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER TRIGGER [dbo].[Prueba_tre] \n   ON  [dbo].[Cliente]\n    FOR INSERT\nAS \nBEGIN\n\n SET NOCOUNT ON;\n\nbegin try\n    BEGIN TRAN t1\n    SAVE TRAN t1\n    INSERT INTO Articulo (Articulo_Codigo, Articulo_Descripcion, Valor_unitario, Categoria_id, msg) VALUES (1040,'EURECA',15000,5,'')\n    COMMIT \n    --raiserror ('Test error',16,1)\nend try\n\nbegin catch\n    ROLLBACK TRAN t1\n    SELECT    ERROR_NUMBER() AS ERROR_NUMBER, ERROR_MESSAGE() AS ERROR_MESSAGE;\nend catch\n\n--SET NOCOUNT ON;\n--exec Prueba CLIENTE_ID;\n\nEND\n</code></pre>\n\n<p>Msg 3931, Level 16, State 1, Procedure Prueba_tre, Line 21\nThe current transaction cannot be committed and cannot be rolled back to a savepoint. Roll back the entire transaction.</p>\n\n<p>THE TABLE IS </p>\n\n<p>the idea is that when I insert into customers products with an insert update ..\nat the end of this transaction need to return from the console</p>\n\n<pre><code>CREATE TABLE Articulo\n(\n   Articulo_Codigo int not null primary key\n   , Articulo_Descripcion varchar (100)\n   , Valor_unitario int\n   , Categoria_Id int not null constraint fk_Categoria references Categoria (CATEGORIA_ID)\n)\n\nCREATE TABLE Cliente\n(\n   CLIENTE_ID int not null primary key\n   , CLIENTE_PRIMER_NOMBRE varchar(50)\n   , CLIENTE_SEGUNDO_NOMBRE varchar(50)\n   , CLIENTE_PRIMER_APELLI varchar(50)\n   , CLIENTE_SEGUNDO_APELLI varchar(50)\n   , CLIENTE_DIRECCION varchar(90)\n   , CLIENTE_TELEFONO int\n   , CLIENTE_CIUDAD varchar(50)\n)\n</code></pre>\n"},{"tags":["sql","sql-server","metadata"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4542,"score":0,"question_id":2903262,"title":"Sql Query to list all views in an SQL Server 2005 database","body":"<p>I need an sql query to enumerate all views (I only need the view names) of a specific database in SQL Server 2005. Thanks in advance!</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13084195,"title":"Summarising data into year ranges","body":"<p>I am trying to sumarise data in sql and am having difficulty finding a method for grouping data.</p>\n\n<p>i have a table named cars</p>\n\n<pre><code>CarID CarMake  CarModel CarYear\n1      Ford      Mondeo   2000\n2      Ford      Mondeo   2002\n3      Ford      Mondeo   2003\n4      Ford      Mondeo   2005\n</code></pre>\n\n<p>I want to be able to group this data to appear as</p>\n\n<pre><code>CarMake CarModel CarYearRange\nFord     Mondeo   2000-2003\nFord     Mondeo   2005-2005\n</code></pre>\n\n<p>I Have tried using min and max to produce this however this fails if the car wasn't made in a year between as in the example.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13153255,"title":"How to do mutual comparison after group by in a SQL query?","body":"<p>I have a table <code>Information</code> which is something like this:</p>\n\n<pre><code>ID    From     To        Product          Date  \n1         A         B          ProdA         2012-10-01  \n2         A         B          ProdA         2012-10-13  \n3         A         B          ProdB         2012-10-17  \n4         A         B          ProdC         2012-10-18  \n5         A         C          ProdB         2012-10-02  \n6         A         C          ProdC         2012-10-04  \n7         A         C          ProdD         2012-10-12  \n8         A         C          ProdE         2012-10-14  \n9         A         D          ProdA         2012-10-11  \n10       A         D          ProdA         2012-10-14  \n</code></pre>\n\n<p>Let's call the combination of From and To a relationship. So (A,B) and (A, C) are relationships.<br>\nWhat I need to do is to find those relationships sending/receiving <strong>different</strong> products within a week time period. So in the above example the query is supposed to return:</p>\n\n<pre><code>A    B\nA    C\n</code></pre>\n\n<p>since these rows match:</p>\n\n<pre><code>2         A         B          ProdA         2012-10-13  \n3         A         B          ProdB         2012-10-17  \n4         A         B          ProdC         2012-10-18  \n\n5         A         C          ProdB         2012-10-02  \n6         A         C          ProdC         2012-10-04  \n\n7         A         C          ProdD         2012-10-12  \n8         A         C          ProdE         2012-10-14  \n</code></pre>\n\n<p>I know I should start from <code>SELECT ID, From, To, Product, Date FROM Information GROUP BY From, To</code> but I have no idea what's next. Any help please?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13153170,"title":"SQL change value in varchar2 datatype using SQL script","body":"<p>i have a problem here.\nin my database i've value in <code>mobile_phone</code> column like <code>628932323</code> but i wanna change every row which use <code>62 to 0</code></p>\n\n<pre><code>old value : 628932323\nnew value : 08932323\n</code></pre>\n\n<p>can someone help me to solve my problems. thanks</p>\n"},{"tags":["mysql","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12954709,"title":"mysql avoiding subqueries","body":"<p>If I have a table with three columns</p>\n\n<pre>\nuserid,eventid,entrytime\n </pre>\n\n<p>and values like \n<pre></p>\n\n<code>userid,eventid,entrytime\n  1      1      NULL\n  2      1    2012-01-01\n  1      2    2012-01-01\n  2      2    2012-01-01\n  3      1      NULL\n  3      2      NULL\n</code></pre>\n\n<p>What is the best way of selecting userids where entrytime has always been NULL</p>\n"},{"tags":["c++","sql","exception","odbc","runtime-error"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13150311,"title":"C++ ODBC Unhandled exception / Access violation writing location","body":"<p>I am writing a ODBC-database class which contains a member function used to fetch a series of attributes and tuples from a given query.</p>\n\n<p>I have a single line of code in the statements below which causes this runtime error to be throw in debug mode:</p>\n\n<pre><code>Unhandled exception at &lt;mem loc&gt; in &lt;prog name&gt;: 0xC0000005: Access violation writing location &lt;mem loc&gt;.\n</code></pre>\n\n<p>and here is the code where <code>ERROR</code> points out the offending line:</p>\n\n<pre><code>SQLINTEGER length = 0;\nvector&lt;vector&lt;string&gt;&gt; data;\nthis-&gt;sReturn = SQLFetch(this-&gt;sHandle);\n\nwhile (this-&gt;sReturn == SQL_SUCCESS) {\n  vector&lt;string&gt; tuple;\n\nfor (int i = 0; i &lt; columnCount; i++) {\n  SQLPOINTER value = \"\";\n\n  switch (info[i].columnType) {\n    case 0 : //SQL_UNKNOWN_TYPE\n      throw DatabaseAttributeTypeUnknown(\"The database returned an attribute of an unknown type.\");\n      break;\n\n    case 1 : //SQL_CHAR\n      this-&gt;sReturn = SQLGetData(this-&gt;sHandle, i + 1, info[i].columnType, value,\n        info[i].columnSize*sizeof(SQLCHAR),\nERROR   &amp;length);\n        break;\n\n     //Some more cases\n  }\n}\n</code></pre>\n\n<p>Any idea on why this error is being thrown? Here is the <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms715441%28v=vs.85%29.aspx\" rel=\"nofollow\">MSDN documentation on SQLGetData()</a>, which is assigning a value to <code>length</code>.</p>\n\n<p>Thank you for your time.</p>\n"},{"tags":["sql","database","performance","sqlite","sqlite3"],"answer_count":6,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":1220,"score":8,"question_id":8988915,"title":"SQLite: COUNT slow on big tables","body":"<p>I'm having a performance problem in SQLite with a SELECT COUNT(*) on a large tables.</p>\n\n<p>As I didn't yet receive a usable answer and I did some further testing, I edited my question to incorporate my new findings.</p>\n\n<p>I have 2 tables:</p>\n\n<pre><code>CREATE TABLE Table1 (\nKey INTEGER NOT NULL,\n... several other fields ...,\nStatus CHAR(1) NOT NULL,\nSelection VARCHAR NULL,\nCONSTRAINT PK_Table1 PRIMARY KEY (Key ASC))\n\nCREATE Table2 (\nKey INTEGER NOT NULL,\nKey2 INTEGER NOT NULL,\n... a few other fields ...,\nCONSTRAINT PK_Table2 PRIMARY KEY (Key ASC, Key2 ASC))\n</code></pre>\n\n<p>Table1 has around 8 million records and Table2 has around 51 million records, and the databasefile is over 5GB.</p>\n\n<p>Table1 has 2 more indexes:</p>\n\n<pre><code>CREATE INDEX IDX_Table1_Status ON Table1 (Status ASC, Key ASC)\nCREATE INDEX IDX_Table1_Selection ON Table1 (Selection ASC, Key ASC)\n</code></pre>\n\n<p>\"Status\" is required field, but has only 6 distinct values, \"Selection\" is not required and has only around 1.5 million values different from null and only around 600k distinct values.</p>\n\n<p>I did some tests on both tables, you can see the timings below, and I added the \"explain query plan\" for each request (QP). I placed the database file on an USB-memorystick so i could remove it after each test and get reliable results without interference of the disk cache. Some requests are faster on USB (I suppose due to lack of seektime), but some are slower (table scans).</p>\n\n<pre><code>SELECT COUNT(*) FROM Table1\n    Time: 105 sec\n    QP: SCAN TABLE Table1 USING COVERING INDEX IDX_Table1_Selection(~1000000 rows)\nSELECT COUNT(Key) FROM Table1\n    Time: 153 sec\n    QP: SCAN TABLE Table1 (~1000000 rows)\nSELECT * FROM Table1 WHERE Key = 5123456\n    Time: 5 ms\n    QP: SEARCH TABLE Table1 USING INTEGER PRIMARY KEY (rowid=?) (~1 rows)\nSELECT * FROM Table1 WHERE Status = 73 AND Key &gt; 5123456 LIMIT 1\n    Time: 16 sec\n    QP: SEARCH TABLE Table1 USING INDEX IDX_Table1_Status (Status=?) (~3 rows)\nSELECT * FROM Table1 WHERE Selection = 'SomeValue' AND Key &gt; 5123456 LIMIT 1\n    Time: 9 ms\n    QP: SEARCH TABLE Table1 USING INDEX IDX_Table1_Selection (Selection=?) (~3 rows)\n</code></pre>\n\n<p>As you can see the counts are very slow, but normal selects are fast (except for the 2nd one, which took 16 seconds).</p>\n\n<p>The same goes for Table2:</p>\n\n<pre><code>SELECT COUNT(*) FROM Table2\n    Time: 528 sec\n    QP: SCAN TABLE Table2 USING COVERING INDEX sqlite_autoindex_Table2_1(~1000000 rows)\nSELECT COUNT(Key) FROM Table2\n    Time: 249 sec\n    QP: SCAN TABLE Table2 (~1000000 rows)\nSELECT * FROM Table2 WHERE Key = 5123456 AND Key2 = 0\n    Time: 7 ms\n    QP: SEARCH TABLE Table2 USING INDEX sqlite_autoindex_Table2_1 (Key=? AND Key2=?) (~1 rows)\n</code></pre>\n\n<p>Why is SQLite not using the automatically created index on the primary key on Table1 ?\nAnd why, when he uses the auto-index on Table2, it still takes a lot of time ?</p>\n\n<p>I created the same tables with the same content and indexes on SQL Server 2008 R2 and there the counts are nearly instantaneous.</p>\n\n<p>One of the comments below suggested executing ANALYZE on the database. I did and it took 11 minutes to complete.\nAfter that, I ran some of the tests again:</p>\n\n<pre><code>SELECT COUNT(*) FROM Table1\n    Time: 104 sec\n    QP: SCAN TABLE Table1 USING COVERING INDEX IDX_Table1_Selection(~7848023 rows)\nSELECT COUNT(Key) FROM Table1\n    Time: 151 sec\n    QP: SCAN TABLE Table1 (~7848023 rows)\nSELECT * FROM Table1 WHERE Status = 73 AND Key &gt; 5123456 LIMIT 1\n    Time: 5 ms\n    QP: SEARCH TABLE Table1 USING INTEGER PRIMARY KEY (rowid&gt;?) (~196200 rows)\nSELECT COUNT(*) FROM Table2\n    Time: 529 sec\n    QP: SCAN TABLE Table2 USING COVERING INDEX sqlite_autoindex_Table2_1(~51152542 rows)\nSELECT COUNT(Key) FROM Table2\n    Time: 249 sec\n    QP: SCAN TABLE Table2 (~51152542 rows)\n</code></pre>\n\n<p>As you can see, the queries took the same time (except the query plan is now showing the real number of rows), only the slower select is now also fast.</p>\n\n<p>Next, I create dan extra index on the Key field of Table1, which should correspond to the auto-index. I did this on the original database, without the ANALYZE data. It took over 23 minutes to create this index (remember, this is on an USB-stick).</p>\n\n<pre><code>CREATE INDEX IDX_Table1_Key ON Table1 (Key ASC)\n</code></pre>\n\n<p>Then I ran the tests again:</p>\n\n<pre><code>SELECT COUNT(*) FROM Table1\n    Time: 4 sec\n    QP: SCAN TABLE Table1 USING COVERING INDEX IDX_Table1_Key(~1000000 rows)\nSELECT COUNT(Key) FROM Table1\n    Time: 167 sec\n    QP: SCAN TABLE Table2 (~1000000 rows)\nSELECT * FROM Table1 WHERE Status = 73 AND Key &gt; 5123456 LIMIT 1\n    Time: 17 sec\n    QP: SEARCH TABLE Table1 USING INDEX IDX_Table1_Status (Status=?) (~3 rows)\n</code></pre>\n\n<p>As you can see, the index helped with the count(*), but not with the count(Key).</p>\n\n<p>Finaly, I created the table using a column constraint instead of a table constraint:</p>\n\n<pre><code>CREATE TABLE Table1 (\nKey INTEGER PRIMARY KEY ASC NOT NULL,\n... several other fields ...,\nStatus CHAR(1) NOT NULL,\nSelection VARCHAR NULL)\n</code></pre>\n\n<p>Then I ran the tests again:</p>\n\n<pre><code>SELECT COUNT(*) FROM Table1\n    Time: 6 sec\n    QP: SCAN TABLE Table1 USING COVERING INDEX IDX_Table1_Selection(~1000000 rows)\nSELECT COUNT(Key) FROM Table1\n    Time: 28 sec\n    QP: SCAN TABLE Table1 (~1000000 rows)\nSELECT * FROM Table1 WHERE Status = 73 AND Key &gt; 5123456 LIMIT 1\n    Time: 10 sec\n    QP: SEARCH TABLE Table1 USING INDEX IDX_Table1_Status (Status=?) (~3 rows)\n</code></pre>\n\n<p>Although the query plans are the same, the times are a lot better. Why is this ?</p>\n\n<p>The problem is that ALTER TABLE does not permit to convert an existing table and I have a lot of existing databases which i can not convert to this form. Besides, using a column contraint instead of table constraint won't work for Table2.</p>\n\n<p>Has anyone any idea what I am doing wrong and how to solve this problem ?</p>\n\n<p>I used System.Data.SQLite version 1.0.74.0 to create the tables and to run the tests I used SQLiteSpy 1.9.1.</p>\n\n<p>Thanks,</p>\n\n<p>Marc</p>\n"},{"tags":["javascript","jquery","sql","query","jqgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13153287,"title":"JQgrid search string builder","body":"<p>Is there any way for search string builder for JQgrid ?\ni.e. when I press search button then it should automatically generate the search string for the search critaria provided for the grid.</p>\n"},{"tags":["sql","sql-server","performance","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13140520,"title":"Simple SQL Server query across databases runs extremely slow R2","body":"<p>I have two databases on a local machine, connected to <code>localhost</code>.  They both have roughly two million rows a piece.  I was doing the following very simple join and it took over a minute to complete.  </p>\n\n<pre><code>select distinct x.patid\n    from [i 3 sci study].dbo.clm_extract as x\n    left join [i 3 study].dbo.claims as y on y.patid=x.patid\n    where y.patid is null\n</code></pre>\n\n<p>When I looked at the execution plan I saw that the join showplan operator had this to say\n<img src=\"http://i.stack.imgur.com/eQAu6.jpg\" alt=\"enter image description here\"></p>\n\n<p>Why is the actual number of rows so exorbitantly high compared to the actual number of rows in both tables?</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13152887,"title":"Inserting a Row in a Table from Select Query","body":"<p>I'm using two Stored Procedures and two Table in My Sql Server.</p>\n\n<p>First Table Structure.</p>\n\n<p><img src=\"http://i.stack.imgur.com/kdhvO.jpg\" alt=\"enter image description here\"></p>\n\n<p>Second Table Structure.</p>\n\n<p><img src=\"http://i.stack.imgur.com/6C43X.jpg\" alt=\"enter image description here\"></p>\n\n<p>When a Customer books a Order then the Data will be Inserted in Table 1.</p>\n\n<p>I'm using a Select Query in another Page Which Selects the Details from the Second Table.</p>\n\n<p>If a row with a billno from first table is not Present in Second Table I want to Insert into the Second Table with some Default Values in the Select Query. How can I do this\n??</p>\n"},{"tags":["sql","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13150562,"title":"Noob Concern: T-SQL Nesting Subquery","body":"<p>I've got a table named nobel with the following fields:  yr, subject and winner.  </p>\n\n<p>This table represents winners of nobel prize winners in a variety of subjects over the years.  </p>\n\n<p>I am looking for the years in which the Physics Prize was awarded but no Chemistry prize. </p>\n\n<p>I was thinking the answer would look something like the following:  </p>\n\n<pre><code>SELECT yr FROM nobel \nWHERE subject ('Chemistry') IN (SELECT subject FROM nobel WHERE subject = 'Physics')\n</code></pre>\n\n<p>I'm fairly certain I've got the syntax wrong... and i'm not certain i'm going down the right road.  Help would be appreciated.  Thanks!  </p>\n"},{"tags":["asp.net","sql","sql-server-2008","iis-7.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13152746,"title":"How to grant IIS APPPOOL\\DefaultAppPool access to stored procedures in Asp.net using IIS?","body":"<p>Here is the error message I get, \"The EXECUTE permission was denied on the object 'GetDepartments', database 'BalloonShop', schema 'dbo\"</p>\n\n<p>I was able to workaround it by configuring sql server 2008 and making IIS APPPOOL\\DefaultAppPool a dbowner aside from datawriter and datareader, the problem is there are some security issues with it according to some articles that I found online. </p>\n\n<p>How do I allow  IIS APPPOOL\\DefaultAppPool to have access to all stored procs in my current database?(or in any database)</p>\n\n<p>(It would be nice if you could provide links/ script)</p>\n\n<p>Sir/Ma'am your answers would be of great help. Thank you++</p>\n"},{"tags":["mysql","sql","query","like","where"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13150741,"title":"Specification in like query","body":"<p>I can't figure out what's wrong with this query. I just want to search in a specific genre, but this query gives me results of other genres. Would really like some help. This code is for my first site built in php.</p>\n\n<pre><code>SELECT * \nFROM news\nWHERE (titel LIKE '%keyword%') AND genre='politics'\n</code></pre>\n"},{"tags":["sql","sql-server-2005"],"answer_count":1,"favorite_count":3,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13152230,"title":"\"WHEN OTHERS THEN NULL\" in SQL Server 2005","body":"<p><code>tracking_table</code> is a log table declared as follows:</p>\n\n<pre><code>create table tracking_table (my_command nvarchar(500), my_date datetime);\n</code></pre>\n\n<p>Please suppose you have the following block of SQL SERVER 2005 code, declared within a SQL Server 2005 job:</p>\n\n<pre><code>DECLARE @my_statement NVARCHAR(500)  \ndelete from tracking_table\n   SET @my_statement = 'ALTER INDEX ALL ON my_user.dbo.my_fact_table REBUILD WITH (FILLFACTOR = 90)'\ninsert into tracking_table values (@my_statement,getdate()) \nEXEC (@my_statement)  \n SET @my_statement = 'ALTER INDEX ALL ON my_user.dbo.my_second_table REBUILD WITH (FILLFACTOR = 90)'\ninsert into tracking_table (@my_statement,getdate())    \nEXEC (@my_statement)  \n</code></pre>\n\n<p>At runtime, if the first statement (<code>ALTER INDEX ALL ON my_user.dbo.my_fact_table REBUILD WITH (FILLFACTOR=90)</code>) fails, the second statement which acts on my_second table WON'T be executed.</p>\n\n<p>I would like to know how could I modify the SQL Server 2005 code, in order to skip any error, going forward (in Oracle I would say, <code>WHEN OTHERS THEN NULL</code>).</p>\n\n<p>How could I achieve this?</p>\n\n<p>Thank you in advance for your kind help.</p>\n"},{"tags":["php","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":29,"score":-4,"question_id":13152519,"title":"Displaying SQL info","body":"<p>i am having a little issue seeing that my brain is not functioning at all today. </p>\n\n<p>I need a dead simple 2page query and results code. </p>\n\n<p>Basically what i want to do is have a \"welcome page\" where user puts in a number/id/whatever that corresponds to a ID in a DB and then hit submit and then all the info pertaining to that number/id/whatever displays on the next page. </p>\n\n<p>The html side of things, tables, image placeholders and all that jazz i have under control but the form submission / sql queries are giving me a helluva headache.</p>\n\n<p>Please if anyone can assist</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":48,"score":1,"question_id":13151928,"title":"Show First instance of records with duplicate values in colum","body":"<p>I have these values in a table called <code>galley_images</code>:</p>\n\n<pre><code>id    gallery_id    image_id\n1             1            1\n2             1            2\n3             1            3\n4             2            4 \n5             2            5 \n6             2            6 \n7             2            7\n8             3            8\n</code></pre>\n\n<p>I want to return the results like this:</p>\n\n<pre><code>id    gallery_id    image_id\n1             1            1\n4             2            4\n8             3            8\n</code></pre>\n\n<p>Basically I only want the first instance of any record with a unique <code>gallery_id</code>.</p>\n\n<p>I have a solution using Access DB but need a solution for MySQL, Access solution was:</p>\n\n<pre><code>SELECT id, First(gallery_id) AS FirstOfgallery_id,  \n           First(image_id) AS FirstOfimage_id\nFROM galley_images \nGROUP BY id\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":["c#","asp.net","sql","table","user"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13152131,"title":"How do I use the logged in user on the sales table, in asp.net?","body":"<p>Hi I hope you guy/gals could help me!</p>\n\n<p>I'm making a website with ASP.NET in C# and I am using a SQL database with different users/logins.\nEvery user is supposed to input data into a database table on the website and the users should only see thier input not the whole table.</p>\n\n<p>I have atm two tables, one for login/user table and a Sales table, so I have a userID in both tables, what I need is for the userID to fill in automatically in the sales table on the loged in user.and yes i have made a relationship between the tables.\nHow do i make this work?</p>\n\n<p>I think this is how it should work maybe I'm thinking wrong here if so please tell me.</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13152176,"title":"Copy from one table to another table containing an extra column foreign key","body":"<p>I want to insert the values from <code>table A</code> into another table B. The problem is Table B contains another few columns which are foreign keys. </p>\n\n<ul>\n<li><code>Table A</code> : <code>ID, Fatherid, MotherID, ParentOccupation</code></li>\n<li><code>Table B</code> : <code>ID, Fatherid, MotherID, ParentOccupation, TrID</code></li>\n</ul>\n\n<p>In <code>Table B</code> <code>Trid</code> is foreign key. But I wish to copy all the other columns from table A to B.</p>\n\n<p>Is it possible to copy the rows from table A to Table B?</p>\n\n<p>Please help.</p>\n"},{"tags":["php","sql","unique"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13151952,"title":"Get unique values of a SQL column","body":"<p>Say I have a table with some columns as</p>\n\n<p>-conversation_id,</p>\n\n<p>-col2,</p>\n\n<p>-user_id. </p>\n\n<p>I want to grab all the rows corresponding to user_id. There could be, say, 20 rows returned for a particular, but there are only say 3 unique conversation_id values.</p>\n\n<p>What is the fastest way to get these values, rather than going through each one and figuring out the unique ones? </p>\n\n<p>I must say, I mean this in PHP!</p>\n\n<p>Thankss!!</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13137052,"title":"Error in running scheduled Job. Where to find error details","body":"<p>I want to delete row in SQL database when a column value matches with current date.\nI have created a scheduled job for deletion of data using SQL Server Management Studio. I have followed step as shown in <a href=\"http://www.youtube.com/watch?v=De_GOwnTDjo\" rel=\"nofollow\">Video</a> \nHere Type of script is T-SQL and command I have given is:</p>\n\n<pre><code>Delete from NewDB.dbo.Datetabel where Date=getDate();\nCOMMIT\n</code></pre>\n\n<p>I want to schedule this job on daily basis. But now for testing purpose I have given on hourly basis. But this job is failed.</p>\n\n<p>Where will I get the details of Error. I am working on sql2008 r2</p>\n\n<p>What should be reason for failure?\nEdited:\nNow job is getting success when code is  changed as:</p>\n\n<pre><code>BEGIN TRAN \nDelete from NewDB.dbo.Datetabel where Date=getDate();\nCOMMIT;\n</code></pre>\n\n<p>But Data is not deleted from the tabel.\nWhat may be issue now?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","sql","codeigniter","function","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12773564,"title":"Escaping issue in building query dynamic function variables","body":"<p>I am developing a CMS which works on template page system in a different approach.</p>\n\n<p>I have this object:</p>\n\n<pre><code>$structure = new stdClass;\n\n$structure-&gt;homepage-&gt;news-&gt;method            = 'get_articles_by_page_name';\n$structure-&gt;homepage-&gt;news-&gt;lang_key          = translate('home_news');\n$structure-&gt;homepage-&gt;news-&gt;lang              = $lang;\n$structure-&gt;homepage-&gt;news-&gt;add_media         = true;\n$structure-&gt;homepage-&gt;news-&gt;media_type        = 'ibs';\n$structure-&gt;homepage-&gt;news-&gt;limit             = '5';\n$structure-&gt;homepage-&gt;news-&gt;order_by          = 'a.logical_date';\n$structure-&gt;homepage-&gt;news-&gt;asc_des           = 'desc';\n$structure-&gt;homepage-&gt;news-&gt;result_type       = 'result';\n</code></pre>\n\n<p>This helps to get contents as following:</p>\n\n<pre><code>foreach ($structure as $page_template =&gt; $page_contents)\n{\n  // Call Customized Content for Homepage\n  if($this-&gt;data['page_data']-&gt;page_view == $page_template) // homepage comes ok.\n  {\n    foreach ($page_contents as $view_var_name =&gt; $page_cdata)\n    {\n      $method = $page_cdata-&gt;method; // method names comes\n      $page_cdata = substr(implode(\",\",(array) $page_cdata),(strlen($method)+1)) . '\\'';\n      //Returns as expected:\n      //**'Haberler','tr','1','ibs','5','a.logical_date','desc','result'**\n\n      $this-&gt;data[$view_var_name] = $this-&gt;publish-&gt;$method($page_cdata);\n      vdebug($page_cdata);\n    }\n  }\n}\n</code></pre>\n\n<p>It suppose to call them model function of:</p>\n\n<pre><code>function get_articles_by_page_name( $lang_key='',$lang='en',$add_media=true,\n media_type='ibs',$limit='0',$order_by='a.logical_date',$asc_desc='desc',$result_type='result')\n</code></pre>\n\n<p>However, there is a problem with. When I return to last worked query it says:</p>\n\n<pre><code>SELECT * FROM (`page`) JOIN `page_lang` ON `page`.`id_page` = `page_lang`.`id_page` WHERE `page_lang`.`title` = '\\'News\\',\\'tr\\',\\'1\\',\\'ibs\\',\\'5\\',\\'a.logical_date\\',\\'desc\\',\\'result\\''\n</code></pre>\n\n<p>It souldn't be like this. every thing between commas are parameters of the method function. What cause this, any idea?</p>\n\n<p>Content of get_articles_by_page_name:</p>\n\n<pre><code>function get_articles_by_page_name ($lang_key='',$lang='tr',$add_media=true,$media_type='ibs',$limit='0',$order_by='a.logical_date',$asc_desc='desc',$result_type='result')\n{\n  // Define variables\n  $id_page    = ''; \n  $result     = '';\n\n  // Get Page Data\n  $page_name    = $lang_key;\n  $get_page     = $this-&gt;vayes-&gt;getJoined('page','page_lang','id_page','','',array('page_lang.title'=&gt;$page_name),'row');\n  if($get_page)\n  {\n    $id_page  = $get_page-&gt;id_page;\n    $result   = $this-&gt;publish-&gt;get_articles($lang,$id_page,null,false,'',$order_by,$asc_desc,$limit,'result');\n  }\n  else\n  {\n    $result = array('No id_page specified');\n  }\n\n  return $result;\n}\n</code></pre>\n\n<p>Content of get_articles:</p>\n\n<pre><code>function get_articles($lang='tr',$id_page,$id_article=null,$incl_media=true,$media_type='',$order_by='a.logical_date',$asc_desc='desc',$limit='0',$result_type='result')\n{\n  $this-&gt;db-&gt;select('*');\n  $this-&gt;db-&gt;from('article a');\n  $this-&gt;db-&gt;join('article_lang b','b.id_article=a.id_article','left outer');\n\n  if($incl_media) {\n    $this-&gt;db-&gt;join('article_media c','c.id_article=b.id_article','left outer');\n    $this-&gt;db-&gt;join('media d','d.id_media=c.id_media','left outer'); \n  }\n\n  if($id_article == null) { $this-&gt;db-&gt;where('a.id_page',$id_page); }\n  else /*-------------&gt;*/ { $this-&gt;db-&gt;where('a.id_article',$id_article); }\n\n  $this-&gt;db-&gt;where('b.lang',$lang);\n  $this-&gt;db-&gt;where('b.online',1);\n\n  if(($incl_media == true) AND $media_type != '' ) $this-&gt;db-&gt;where('c.usage',$media_type);\n\n  // Order Results\n  $this-&gt;db-&gt;order_by($order_by,$asc_desc);\n\n  // Limit Results\n  if ($limit) $this-&gt;db-&gt;limit($limit);\n\n  $query = $this-&gt;db-&gt;get();\n\n  if($query-&gt;num_rows() &gt; 0)\n  {\n    $result = $query-&gt;$result_type();\n    $query-&gt;free_result();\n    return $result;\n  }\n  return false;\n}\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13150356,"title":"How to display the first row, depending on a value","body":"<p>I am supposed to build a query that displays if a product passed quality test the first time. for example if product# 1234 fails the first test then don't display the value. I am running SQL Server 2005. I am thinking maybe using a <code>COALESCE</code> statement, or case when statement, any help would be appreciated. here is some sample data:</p>\n\n<pre><code>product#  test result   datetime\n1102494    Fail         20111129:07:57:50.203\n1102494    pass         20111130:16:48:28.140\n1102496    pass         20111129:11:09:32.140\n1102498    pass         20111129:08:21:10.218\n</code></pre>\n"},{"tags":["php","sql","query","search","checkbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13150516,"title":"Search SQL with Date Range and Checkbox","body":"<p>I've been trying to develop a code where I have a form to search SQL tables according to date ranges and a checkbox status.</p>\n\n<p>I already have worked out the search query for the dates, but I haven't been able to make it work with the checkbox. I would like to combine both features in one search but I can't figure it out.</p>\n\n<p>For ex: Search between \"<strong>01/01/2012</strong>\" and \"<strong>12/31/2012</strong>\" where status is \"DONE! <strong>(Checkbox=Checked)</strong>\".</p>\n\n<p>Here is the code I'm using to do the search:</p>\n\n<p>The Form</p>\n\n<pre><code>&lt;form method = \"post\" action = \"&lt;?php echo $_SERVER['PHP_SELF'];?&gt;\"&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align:center; padding-top:15px;\"&gt;\n                    &lt;span&gt;From&amp;nbsp:&lt;/span&gt;\n                    &lt;input type = \"date\" name = \"OLD\"&gt;\n                    To:\n                    &lt;input type = \"date\" name = \"NEW\"&gt;\n                    Status:\n                    &lt;input type='checkbox' name='Status' value='DONE'/&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align:center; padding-top:15px;\"&gt;\n                    &lt;button type = \"submit\" name = \"search\" value = \"Search\" class=\"button orange\"&gt;Search&lt;/button&gt;\n                    &lt;button type = \"reset\" value = \"Clear\" class=\"button orange\"&gt;Reset&lt;/button&gt;\n                &lt;/td&gt;   \n            &lt;/tr&gt;\n        &lt;/table&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>The PHP</p>\n\n<pre><code>&lt;?php\n    if(!isset($_POST['search']))\n    {\n    ?&gt;\n\n    &lt;?php\n    }\n    else\n    {\n        $OLD = trim($_POST['from']);\n        $NEW = trim($_POST['to']);\n\n        $connection = mysql_pconnect(\"HOST\", \"USER\", \"PASS\") or die(\"Connection failed. \".myslq_error());\n        mysql_select_db(\"DATABASENAME\") or die(\"Unable to select db. \".mysql_error());\n        $query = \"SELECT * FROM table WHERE Date &gt;= '$OLD' AND Date &lt;= '$NEW' ORDER BY date ASC\";\n        $result = mysql_query($query) or die(mysql_error());\n\n        echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n            echo \"&lt;tr class='rowa'&gt;&lt;b&gt;\";\n                echo \"&lt;td class='col1 cell'&gt;Name&lt;/td&gt;\";\n                echo \"&lt;td class='col2 cell'&gt;Last Name&lt;/td&gt;\";\n            echo \"&lt;/tr&gt;\";\n        echo \"&lt;/table&gt;\";\n        while($record = mysql_fetch_object($result))\n        {   \n        echo \"&lt;table class='table' id='SearchResult' cellspacing='0' cellpadding='0'&gt;\";\n            echo \"&lt;tr class='rowb'&gt;\";\n                echo \"&lt;td class='col1 cell'&gt;\".$record-&gt;Name.\"&lt;/td&gt;\";\n                echo \"&lt;td class='col2 cell'&gt;\".$record-&gt;LastName.\"&lt;/td&gt;\";\n            echo \"&lt;/tr&gt;\";       \n        echo \"&lt;/table&gt;\";\n        }       \n    }\n?&gt;\n</code></pre>\n\n<p>Who can lead me in the right way to accomplish this?! Thanks a lot!</p>\n"},{"tags":["mysql","sql","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13151589,"title":"Get total of a field grouped by date and another field","body":"<p>I have a table with data as follows,</p>\n\n<pre><code>detectDate      |isp    |infection  | count\n--------------------------------------\n2012-10-02 01:00|aaaa   |malware    |3\n2012-10-02 01:30|bbbb   |malware    |2\n2012-10-02 01:33|bbbb   |spy-eye    |2\n2012-10-02 01:45|aaaa   |DDos       |1\n2012-10-03 01:50|cccc   |malware    |2\n2012-10-03 02:00|dddd   |TDSS       |2\n2012-10-03 04:50|dddd   |TDSS       |3\n</code></pre>\n\n<p>I need to get an out put like this, grouped by date and infection like so,</p>\n\n<pre><code>detectDate      |infection  | count\n--------------------------------------\n2012-10-02      |malware    |5\n2012-10-02      |spy-eye    |2\n2012-10-02      |DDos       |1\n2012-10-03      |malware    |2\n2012-10-03      |TDSS       |5\n</code></pre>\n\n<p>I know how to use group in general but not his far :( can you please help me I need to group by date and infection and get the total of the count field as shown.</p>\n"},{"tags":["sql","jsf","windows-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13151750,"title":"SQL windows authentication taking system name instead of username in jsf","body":"<p>I am trying to connect to SQL server using Windows Authentication from a jsf Web application.But when i try logging in with the windows credentials the    DriverManager.getconnection seems to be taking the machine name instead of the username.</p>\n\n<p>set up: \njsf1.2,\nRAD 8.0,\nIBM WAS 7.0</p>\n\n<p>Thanks for any help you can offer.</p>\n"},{"tags":["c#","asp.net","sql","xml","word"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13145055,"title":"How to upload a word document using asp, then save to SQL Server as XML using c#","body":"<p>I know there must be lots of info around the net but I can't find any guides that made sense together.</p>\n\n<p>I'm trying to create a web page where you can upload a word document, then in the C# code-behind, convert it to XML to store in a SQL Server database.</p>\n\n<p>Does anyone know of any decent guides, or the best way to approach this?</p>\n\n<p>Should I use asp <code>FileUpload</code>, then somehow access the file and convert to XML in the code-behind?</p>\n\n<p>Any help / guidance would be greatly appreciated.</p>\n\n<p>Thanks. </p>\n"},{"tags":["sql","oracle10g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13149369,"title":"Query does not subtract correctly","body":"<p>I have these two tables:</p>\n\n<pre><code>SQL&gt; SELECT * FROM TAB_A;\nMYDATE        P4         D1      D2      P5      P6\n--------- ---------- ---------- ----------- ----------- -----------\n30-OCT-12    949,324  4,437,654  10,203,116  25,303,632  13,900,078\n\n\nSQL&gt; SELECT * FROM TAB_B;\nMYDATE        P4         D1      D2      P5      P6\n--------- ---------- ---------- ----------- ----------- -----------\n30-OCT-12    937,796  4,388,477  10,091,811  25,028,402  13,755,882\n</code></pre>\n\n<p>I need to subtract their respective columns and store the results into a third table like so:</p>\n\n<pre><code>SQL&gt; INSERT INTO TAB_C (MYDATE, P4) SELECT SYSDATE,A.P4-B.P4 FROM  TAB_A A,TAB_B B WHERE A.MYDATE=B.MYDATE;\n\nSQL&gt; SELECT * FROM TAB_C;\nMYDATE        P4         D1      D2      P5      P6\n--------- ---------- ---------- ----------- ----------- -----------\n30-OCT-12     926,268\n</code></pre>\n\n<p>The result is wrong. Basic math: <code>949324-937796=11528</code>. Numeric values are stored as number datatypes. What am I missing here?</p>\n"},{"tags":["sql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13151393,"title":"Joining in SQL on more than 2 tables Using ORACLE","body":"<p>Suppose I have three tables, A, B and C.<br>\nI did Join on table A and table B, now I wanted to do Join on result AB and table c.<br>\nDo I need to create view and then do Join or need to do it by Nested query?</p>\n"},{"tags":["mysql","sql","string","sql-update"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":814,"score":2,"question_id":3238319,"title":"How do I change all empty strings to NULL in a table?","body":"<p>I have a legacy table with about 100 columns (90% nullable). In those 90 columns I want to remove all empty strings and set them to null. I know I can:</p>\n\n<pre><code>update table set column = NULL where column = '';\nupdate table set column2 = NULL where column2 = '';\n</code></pre>\n\n<p>But that is tedious and error prone. There has to be a way to do this on the whole table? </p>\n"},{"tags":["sql","mysql","insert","conditional"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":7879,"score":2,"question_id":554205,"title":"With MySQL, how do I insert into a table on condition that the value does not exist in another table?","body":"<p>I have a MySQL database and I would like to insert some values into one table, assuming that a particular value that I am inserting does not match a value in a different table.</p>\n\n<p>Here is a simplified/example structure:</p>\n\n<pre><code>Table: invites\n    id : int (auto-increment index)\n    name : varchar\n    message : varchar\n\nTable: donotinvite\n    name : varchar (index)\n</code></pre>\n\n<p>Is it possible to do a conditional insert of a 'name' and 'message' pair into the 'invites' table assuming the 'name' does not match any 'name' from the 'donotinvite' table with a single statement?</p>\n\n<p>Something like this, perhaps?</p>\n\n<pre><code>INSERT INTO invites\n    SET name = 'joe', message = 'This is an invite'\nWHERE NOT EXISTS \n    (SELECT name \n    FROM donotinvite\n    WHERE name = 'joe')\n</code></pre>\n"}]}
{"total":102599,"page":19,"pagesize":100,"questions":[{"tags":["sql","oracle","table","join"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":13132447,"title":"Difference between ON and WHERE clauses in SQL table joins","body":"<pre><code>select e.last_name, e.hire_date\nfrom employees e join employees m\non (m.last_name = 'Davies')\nand (e.hire_date &gt; m.hire_date);\n\nselect e.last_name, e.hire_date\nfrom employees e join employees m\non (m.last_name = 'Davies')\nwhere (e.hire_date &gt; m.hire_date);\n\nselect e.last_name, e.hire_date\nfrom employees e join employees m\non (e.hire_date &gt; m.hire_date)\nwhere (m.last_name = 'Davies');\n</code></pre>\n\n<p>These three statements have the same result. Apart from the fact that <code>where</code> cannot be used exclusively, without using <code>on</code>, is there any particular reason to use <code>where</code> at all in table joins?</p>\n"},{"tags":["sql","sql-server-2008","aggregate-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13143987,"title":"How to select a value based on a count(*) in a subquery","body":"<p>I'm running a query below which won't work as I can't put an aggregate in a where clause, but given that it's in a subquery I'm not entirely sure what the best way forward is from here...!</p>\n\n<p>The line that doesn't work is:</p>\n\n<pre><code>        (select gradeid from commissionconsultants where UserId = ic.primaryconsultantid) \n        and starters = COUNT(*) ) from InvoiceCommissions ic\n</code></pre>\n\n<p>And the full query is as follows:</p>\n\n<pre><code>select u.username + ' ' + u.surname as UserName, \nic.primaryconsultantid, \nCOUNT(ic.invoiceid) as starters, \nDATENAME(mm,ic.invoiceissueddate) AS [month], \nDATEPART(yy,ic.invoiceissueddate) as [year], \ncast(SUM((ic.value / ic.exchangerate) * (ic.primaryconsultantperc / 100)) as numeric(8,2)) AS totalvalue, \n(select threshold from commissiongrades where gradeid = \n    (select gradeid from commissionconsultants where UserId = ic.primaryconsultantid) ) AS Threshold, \n(select percentage from commissiongradevalues where gradeid = \n    (select gradeid from commissionconsultants where UserId = ic.primaryconsultantid) \n        and starters = COUNT(*) ) from InvoiceCommissions ic\ninner join commissionconsultants cc on cc.userid = ic.primaryconsultantid\ninner join Users u on u.UserId = ic.primaryconsultantid\ngroup by primaryconsultantid, DATENAME(mm,invoiceissueddate), DATEPART(yy,invoiceissueddate), u.username + ' ' + u.surname \n</code></pre>\n\n<p>What, in essence, I am trying to do is lookup the commission percentage from a table (commissiongradevalues) based on the grade of the consultant (found in commissionconsultants) and the number of placements made in a given month.</p>\n\n<p>e.g. if a consultant has made one placement in a month, they will have XX commission percentage, and if they have made two placements in a month they will have YY commission percentage.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["php","sql","database","foreign-keys","relational"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13149852,"title":"SQL - Check for dependants of a single table","body":"<p>Lets say you have a table(A) holding a limited amount of data, and one of the fields being a primary key is being referenced by not one, but many foreign keys from other tables.</p>\n\n<p>The foreign keys of these tables have constraints against the before mentioned table(A) where should a row from table(A) be deleted and one of the other tables FKs holds a reference to it, the deletion will fail.</p>\n\n<p>OK, with the database design taken care of, it is now a matter of the software, PHP in this case.  An attempt is made to delete a row from table(A), how should a check be made to ensure that the row cannot be deleted if a reference is held?</p>\n\n<p>I have seen cases where every table is checked before hand, however that involves coding in every check which becomes a maintenance nightmare.  Additionally, I can't simply let the deletion be attempted, as this needs to be a cross database application, therefore the returned error codes wont be consistent.</p>\n\n<p>I am interested to know how people usually tackle this scenario.  I mentioned I am using PHP, but this situation should apply in any language.</p>\n\n<p>Thank you</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13144900,"title":"How to get row position?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3614666/mysql-get-row-position-in-order-by\">MySQL get row position in ORDER BY</a><br>\n  <a href=\"http://stackoverflow.com/questions/4845290/calculating-rank-in-php-mysql\">Calculating rank in PHP/MySQL</a>  </p>\n</blockquote>\n\n\n\n<p>I have a game system wrote in php, each user has X amount of money.\nI have a page that display the most rich users in the site.</p>\n\n<pre><code>$ranking = mysql_query(\"\n    SELECT * \n    FROM users \n    ORDER BY money DESC \n    LIMIT 10\n\");\n</code></pre>\n\n<p>Now I want give each user his position in the list.\nI can't select all the information and start to sort just to get one value, it's waste of resources.\nHow can I select the position of a row (where userid = X)?</p>\n\n<p>(MYSQL)</p>\n"},{"tags":["java","sql","android","sqlite","arraylist"],"answer_count":4,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":4794,"score":7,"question_id":3142285,"title":"Saving ArrayList in SQLite database in Android","body":"<p>I've been working with SQLite on android and I would like to add an arraylist to a column in a table, and then fetch the data back as an arraylist. The arraylist is a list of Longs. I've noticed that SQL has an option for storing BLOBS, however it looks like I need to convert the arraylist to a byte[] first before being able to store it as a blob in my SQLite database.</p>\n\n<p>If anyone has a solution on how to save arraylists into an SQLite database that would be greatly appreciated. Or is there any other option for saving my array of data, i should consider?</p>\n"},{"tags":["php","sql","css","drupal-6","xampp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13150080,"title":"transfer sql file from live site to my computer and launch website using xxamp","body":"<p>How do I get my website live on my home pc?  I have xxamp up and running and can run drupal but need help in getting th database working with the files.</p>\n"},{"tags":["php","sql","sorting","opencart"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":158,"score":0,"question_id":11462338,"title":"Complex Sort Function using Join, SQL, Order Categories by Products' expiry, Opencart","body":"<p><strong>UPDATE</strong></p>\n\n<p>My end goal was to sort categories by the expiry dates of the products within. So the category with a product closest to expiring goes first, categories with all products expired go last. Thanks to Greg, see the complete answer at the bottom of the question.</p>\n\n<p><strong>/UPDATE</strong></p>\n\n<p>This works fine except for the second line (SELECT MIN(date_expires... Any ideas on how to rewrite this line?</p>\n\n<pre><code> SELECT   c.category_id, \n          name, \n          c.image, \n          description,\n          (SELECT MIN(date_expires) \n           FROM     product \n           WHERE date_expires &gt;= NOW() AND \n                 p.product_id = p2c.product_id) AS expiring\nFROM category c \n        LEFT JOIN category_description cd \n            ON (c.category_id = cd.category_id) \n        LEFT JOIN product_to_category p2c \n            ON (c.category_id = p2c.category_id) \n        LEFT JOIN product p \n            ON (p2c.product_id = p.product_id) \nWHERE c.parent_id = 0 AND c.status = '1'\nGROUP BY c.category_id\nORDER BY expiring\n</code></pre>\n\n<p>Some sample data: </p>\n\n<pre><code>category:\ncategory_id = 62\ncategory_id = 64\ncategory_id = 63\n\nproduct_to_category:\nproduct_id = 43 category_id = 62\nproduct_id = 50 category_id = 63\nproduct_id = 56 category_id = 63\nproduct_id = 58 category_id = 62\nproduct_id = 59 category_id = 63\nproduct_id = 60 category_id = 63\nproduct_id = 61 category_id = 63\nproduct_id = 62 category_id = 63\nproduct_id = 63 category_id = 64\n\nproduct:\nproduct_id = 43 date_expires = 2012-07-11 20:35:00\nproduct_id = 50 date_expires = 2012-06-29 00:00:00\nproduct_id = 56 date_expires = 2012-07-13 00:00:00\nproduct_id = 58 date_expires = 2012-07-26 15:01:00\nproduct_id = 59 date_expires = 2012-07-16 14:12:00\nproduct_id = 60 date_expires = 2012-07-18 08:15:00\nproduct_id = 61 date_expires = 2012-08-02 13:04:00\nproduct_id = 62 date_expires = 2012-08-24 00:00:00\nproduct_id = 63 date_expires = 2012-07-12 19:16:00\n</code></pre>\n\n<p><strong>ANSWER</strong>\nMy end goal was to get</p>\n\n<pre><code>SELECT c.category_id, minDateExpires.Expiring, \nCASE WHEN Expiring &gt; 1 THEN 1 ELSE 2 END as available \nFROM category c\nLEFT JOIN product_to_category p2c ON (c.category_id = p2c.category_id)   \nLEFT JOIN product p ON (p2c.product_id = p.product_id)   \nLEFT JOIN ( \n    SELECT MIN(date_expires) AS expiring, category_id FROM product p join product_to_category p2c on p2c.product_id = p.product_id WHERE date_expires &gt;= GETDATE() GROUP BY category_id\n) minDateExpires on p2c.category_id = minDateExpires.category_id\nORDER BY available, expiring  \n</code></pre>\n\n<p>If you are looking for this for <strong>OpenCart</strong> in particular and you are using the Categories module then go to catalog/model/catalog/category.php and edit function getCategoriesPag() to:</p>\n\n<pre><code>    public function getCategoriesPag($data) {\n        $query = $this-&gt;db-&gt;query(\"SELECT c.category_id, name, c.image, description, minDateExpires.Expiring, CASE WHEN Expiring &gt; 1 THEN 1 ELSE 2 END as available FROM \" . DB_PREFIX . \"category c LEFT JOIN \" . DB_PREFIX . \"category_description cd ON (c.category_id = cd.category_id) LEFT JOIN \" . DB_PREFIX . \"category_to_store c2s ON (c.category_id = c2s.category_id) LEFT JOIN \" . DB_PREFIX . \"product_to_category p2c ON (c.category_id = p2c.category_id) LEFT JOIN \" . DB_PREFIX . \"product p ON (p2c.product_id = p.product_id) LEFT JOIN (SELECT MIN(date_expires) AS expiring, category_id FROM product p JOIN product_to_category p2c on p2c.product_id = p.product_id WHERE date_expires &gt;= NOW() GROUP BY category_id) minDateExpires on p2c.category_id = minDateExpires.category_id WHERE c.parent_id = 0 AND cd.language_id = '\" . (int)$this-&gt;config-&gt;get('config_language_id') . \"' AND c2s.store_id = '\" . (int)$this-&gt;config-&gt;get('config_store_id') . \"'  AND c.status = '1' GROUP BY c.category_id ORDER BY available, Expiring, c.sort_order\");\n\n        return $query-&gt;rows;\n    }\n</code></pre>\n\n<p>You will need to add your own date_expires field to the database and to your back end admin panel.</p>\n"},{"tags":["sql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4016,"score":2,"question_id":7076766,"title":"Select rows having 2 columns equal value","body":"<p>I've a table having data as:</p>\n\n<pre><code>C1    || C2  || C3  || C4\n--------------------------\n1     || a   || b   || 1\n2     || a   || b   || 4\n3     || b   || d   || 2\n4     || b   || d   || 2\n</code></pre>\n\n<p><strong>Question 1</strong>: I've to select all rows which have Column C2 , C3, C4 equal values i.e. in about example row 3 and row 4 should be selected. Suggestions ?</p>\n\n<p><strong>Question 2</strong> : select all rows if total number of rows Column C4 value same are greater than 1. i.e. In above case C4 value -2 has two rows (3,4) so select row 3 and 4. </p>\n"},{"tags":["sql","sql-server","algorithm"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13132270,"title":"How to select similar sets in SQL","body":"<p>I have the following tables:</p>\n\n<pre><code>Order\n----\nID (pk)\n\nOrderItem\n----\nOrderID (fk -&gt; Order.ID)\nItemID (fk -&gt; Item.ID)\nQuantity\n\nItem\n----\nID (pk)\n</code></pre>\n\n<p>How can I write a query that can select all <code>Orders</code> that are at least 85% similar to a specific <code>Order</code>?</p>\n\n<p>I considered using the <a href=\"http://en.wikipedia.org/wiki/Jaccard_index\" rel=\"nofollow\">Jaccard Index</a> statistic to calculate the similarity of two <code>Orders</code>. (By taking the intersection of each set of <code>OrderItems</code> divided by the union of each set of <code>OrderItems</code>)  </p>\n\n<p>However, I can't think of a way to do so without storing the computed Jaccard Index for each possible combination of two <code>Orders</code>.  <strong>Is there another way?</strong></p>\n\n<p>Also, is there a way to include the difference in <code>Quantity</code> of each matched <code>OrderItem</code> into account?</p>\n\n<p><strong>Additional Info:</strong></p>\n\n<hr>\n\n<p>Total <code>Orders</code>: ~79k<br>\nTotal <code>OrderItems</code>: ~1.76m<br>\nAvg. <code>OrderItems</code> per <code>Order</code>: 21.5<br>\nTotal <code>Items</code>: ~13k</p>\n"},{"tags":["sql","multiple","distinct","where","column"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":60,"score":4,"question_id":13149857,"title":"Select Distinct on Inner Join Query filtering by multiple values on a single column?","body":"<p>So, i have to say, SQL is by far my weakest side as a developer. Perhaps what i'm trying to accomplish is pretty easy. I have something like this (It's not the real model, but in order to make it simple to understand without wasting too much time explaining it, i've come up with an example that mimics exactly the table relations i have to use).\nOn one hand, a table, let's call it, \"Users\". Columns such as a primary key \"UserId\", \"UserName\", and so on.</p>\n\n<p>Next, another Table, \"Licenses\". Relates 1:N with user, each license belongs to a single user, a user may have multiple licenses. So, we'd have a PK IdLicense, a FK IdUser, and so on.</p>\n\n<p>Next, a table called \"Equipments\". here we have defined different equipments. IdEquipment, EquipmentName. Not much more to say about it.</p>\n\n<p>Lastly, a table that creates a N:M relation between \"Licenses\" and \"Equipments\". when a user defines a license, they can specify the different equipments that licence allows them to manipulate. So, a license can relate to several equipments, and a piece of equipment can relate to multiple licenses.</p>\n\n<p>The real deal comes here. I've been ordered to implement some kind of search system that allows you to get users based on the equipment they are qualified to handle.It's possible to make a multiple selection, so that you search for users that are qualified to handle equipment \"A\", \"B\" and \"C\". For example, we have 2 users, James and, Dave. James has 2 licenses, Dave has one. James is qualified to use machines \"A\" and \"D\" on his first license, \"B\" and \"C\" on the second one. Dave is qualififed to handle equipment type \"B\" and \"C\" on his only license. If someone tries to search for users being able to handle equipment \"A\",\"B\" AND \"C\", only James would be the returning record.</p>\n\n<p>So far i assumed i'd have to do something like </p>\n\n<pre><code>SELECT DISTINCT IdUser\nFROM  Users\nINNER JOIN Licenses\n   ON Licenses.IdUser = Users.idUser\nINNER JOIN LicensesEquipments\n   ON LicensesEquipments.IdLicense = Licenses.IdLicense\nINNER JOIN Equipment\n   ON Equipment.IdEquipment = LicensesEquipments.IdEquipment\n\nWHERE Equipment.IdEquipment = ??\n</code></pre>\n\n<p>How can i filter this on the all 3 different idEquipments for \"A\" \"B\" and \"C\".?\nObviously, i can't make \nWHERE Equipment.IdEquipment = 1 and Equipment.IdEquipment = 2 since a cell can't be equal to 2 different values.\nNeither i can do \nWHERE Equipment.IdEquipment = 1 or Equipment.IdEquipment = 2 since using an OR would mean that any user holding at least ONE of the possibilities would be considered a valid result, and i'm looking for one that has ALL 3 different equipments on this case.</p>\n\n<p>At first I assumed I'd have to create multiple inner joins with the table equipment, using alias, doing it as many times as filters on equipment i may have, and using each alias with a different filter. But then my code supervisor came by and told me to forget about it, since he said that would render too costly as more and more filters where added (though he gave me no better alternative...)</p>\n"},{"tags":["sql","oracle","hudson"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12754779,"title":"Store build number and date in oracle database procedure comment header","body":"<p>I want to store the latest build number and date in the comment header section of my Oracle Procedures. I have searched on this topic but have only found storing dates and number in tables and not what I need.</p>\n\n<p>Back story - in the middle of a botched deploy I had to file diff procedures to confirm the latest and greatest was deployed as expected. We have grown from a start up to more of an enterprise and are trying to get better processes in place. Most of our procedures do not have headers and developers do not often add modifications/dates to them. I want to update a build version and date in the comment header as a result of the deployment action. We are using Hudson to automate deploys. I believe I should be able to add something to the header and update that via Hudson during the deploy. Then, confirmation that the latest and greatest is there would be at a glance instead of having to wade through a file diff.</p>\n\n<p>I have used Google and searched other sites to no avail. Any help would be greatly appreciated. </p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13148873,"title":"Does OLEDB 12.0 support FULL OUTER JOIN?","body":"<p>ERROR:</p>\n\n<pre><code>Error: IErrorInfo.GetDescription failed with E_FAIL(0x80004005).\nSyntax error in FROM clause. \n</code></pre>\n\n<p>QUERY:</p>\n\n<pre><code>Select * from [tbl Proctors$] p \nFULL OUTER JOIN [tbl Proctor History$] h \nON p.Unique = h.Unique\n</code></pre>\n\n<p>The intriguing part is that the query works on <code>LEFT JOIN</code> or <code>RIGHT JOIN</code> but not with <code>FULL OUTER JOIN</code>.</p>\n\n<p>Any clue?</p>\n"},{"tags":["sql","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13024488,"title":"SSIS Split Condition","body":"<p>I need to implement <code>SCD</code> Type 2\nthis is my condition in my split condition before updating my <code>RecordEndDate</code> and eventually adding it in the database. But even though it does not satisfy the condition it still keeps on adding it in the database </p>\n\n<pre><code>((PlateNo == Stage_PlateNo)) &amp;&amp; (([Car Name] != [Stage_Model]) || \n ([Manufacturer] != [Stage_Manufacturer]) ||\n  [Year Model] != Stage_Year || \n  [Car Body Type] != Stage_BodyType ||\n  Transmission != Stage_Transmission ||\n [Daily Rate (in Peso)] != Stage_DailyRate\n )\n</code></pre>\n"},{"tags":["mysql","sql","mysql-python"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13144815,"title":"check if row exist in the table before adding it in SQL","body":"<p>i'm building a twitter grabber application using <strong>Python</strong> , <code>Tweepy</code> and <code>MySQLdb</code> modules</p>\n\n<p>it will be fetching millions of tweets so performance is an issue \ni want to check if the tweet_id exists before in the table before adding it in the same Query </p>\n\n<p>the table schema is : </p>\n\n<pre><code>  *id* |   tweet_id             |     text\n  _____|________________________|______________________________\n    1  |   259327533444925056   |     sample tweet1\n  _____|________________________|______________________________\n    2  |   259327566714923333   |     this is a sample tweet2 \n</code></pre>\n\n<p>the code that i tried is but it do double Queries :</p>\n\n<pre><code>#check that the tweet doesn't exist first\nq = \"select count(*) from tweets where tweet_id = \" + tweet.id\ncur.execute(q)\nresult = cur.fetchone()\nfound = result[0]\nif found == 0: \nq = \"INSERT INTO  lexicon_nwindow (tweet_id,text) VALUES(tweet_id,tweet.text)\ncur.execute(q)\n</code></pre>\n\n<p>making the Tweet_id unique and just insert the tweets , will raise exception and will not be efficient as well ?</p>\n\n<p>so what's the best performing method to achieve this with one query ? </p>\n"},{"tags":["sql","sql-server","iis","web-applications","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13149683,"title":"Connecting to SQL Database from IIS","body":"<p>This is my connection string, which the web service (hosted in IIS, running under ApplicationPoolIdentity) uses to connect to database</p>\n\n<pre><code>&lt;add name=\"AdventureWorksEntities\"connectionString=\"metadata=.\\AdventureWorks.csdl|.\\AdventureWorks.ssdl|.\\AdventureWorks.msl;\nprovider=System.Data.SqlClient;provider connection string='Data Source=TestMachine;Initial Catalog=AdventureWorks;\nIntegrated Security=True;Connection Timeout=60;multipleactiveresultsets=true'\" providerName=\"System.Data.EntityClient\" /&gt;\n</code></pre>\n\n<p>When I try to access the site I am getting an exception: Login Failed for user MyDomain\\TestMachine$.</p>\n\n<p>Why is IIS trying to use TestMachine to connect and not my user account (e.g MyDomain\\TestUser) ?\nThe reason I believe could be because its hosted under ApplicationPoolIdentity which uses machine creds. </p>\n\n<p>How do I specify it to use the context of the user that made the request without having to run the application under custom identity (i.e I want it to continue running under ApplicationPoolIdentity)?</p>\n\n<p>If  I set <code>&lt;identity impersonate = true/&gt;'</code> in my web.config file then I am able to access the site locally from IIS server machine and access to database works but then accessing the site remotely fails. My Webservice is using Windows Authentication. Any thoughts on this ?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":44,"score":0,"question_id":13149232,"title":"How do I extract a substring from a random position in a string using built-in functions?","body":"<p>I have a series of data stored in the following fashion:</p>\n\n<pre><code>Word of various kinds (ANT\\username1) and even more words\nThis is another row, the words are random (ANT\\username2)\nThankfully the username only ever shows once (ANT\\username1)\n</code></pre>\n\n<p>Above represents three seperate rows. </p>\n\n<p>The general flow of this data is:</p>\n\n<ul>\n<li>Parenthesis can appear anywhere in the text</li>\n<li>The username portion of each string (ANT\\usernamex) will only ever appear once</li>\n<li>The text preceeding and proceeding the username portion is always different lengths.</li>\n<li>The username text may not always be present</li>\n</ul>\n\n<p>As you probably already guessed what I need to do is take the username from each row and where it isn't present return null. Unfortunately I have no idea how to approach this - I've played around with left() and right() functions but don't really know how else to tackle this. Would appreciate if any answers that use a number of functions to accomplish the task have a quick blurb explaining the flow of logic (so I can then read the documentation for the functions to learn).</p>\n"},{"tags":["python","sql","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":9804073,"title":"SQLite python does not update table","body":"<p>I have the following code:</p>\n\n<pre><code>import sqlite3\n\ncon = sqlite3.connect(\"testDB\")\ncur = con.cursor()\n\n#cur.execute('CREATE TABLE test_table (id integer primary key, data text)')\ncur.execute('INSERT INTO test_table VALUES (?, ?)', (76, 'MyData'))\n</code></pre>\n\n<p>when I run this script it does not update table. But when I do the same insertion using sqlite3 commandline in Linux, it updates. Why is it so or there anything I am making wrong?</p>\n"},{"tags":["iphone","objective-c","sql","ios"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":9803458,"title":"iOS coredata using existing SQLite?","body":"<p>new to iOS, I want to create a new table in core data, I have used the following xml file to create in java before and would like to re-use if possible</p>\n\n<p>sql.xml file</p>\n\n<pre><code>&lt;sql&gt;\n&lt;statement&gt;\nCREATE TABLE IF NOT EXISTS place (\n        _id INTEGER PRIMARY KEY AUTOINCREMENT, \n        Name VARCHAR(50), \n    Location VARCHAR(50),\n    Description VARCHAR(300),  \n    Type VARCHAR(50),\n    longitude DOUBLE(50),\n    latitude DOUBLE(50),\n&lt;/statement&gt;\n\n &lt;statement&gt;INSERT INTO place VALUES(1,'Clare'\n     ,'Co Clare'\n     ,'Clare Description'\n     ,'County'\n     ,'52.924014'\n         ,'-9.353399')\n &lt;/statement&gt;\n &lt;statement&gt;INSERT INTO surfSpot VALUES(2,'etc...\n</code></pre>\n\n<p>Java code</p>\n\n<pre><code> public void onCreate(SQLiteDatabase db){\n      String s;\n      try{\n        InputStream in = context.getResources().openRawResource(R.raw.sql);\n        DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();\n        Document doc = builder.parse(in, null);\n        NodeList statements = doc.getElementsByTagName(\"statement\");\n        for (int i=0; i&lt;statements.getLength(); i++) {\n            s = statements.item(i).getChildNodes().item(0).getNodeValue();\n            db.execSQL(s);\n        }\n    } catch (Throwable t) {\n\n    }\n}\n</code></pre>\n\n<p>The database is static, I would like suggestions on how to do the same thing for iOS, step by step instructions would be the ideal answer if possible, thamks,</p>\n"},{"tags":["php","mysql","sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13149487,"title":"MySQL : complex query dynamic select?","body":"<p>I searching for many times now on a complex MySQL query.</p>\n\n<p>It's an achievement system.</p>\n\n<p>Structure of tables is simple and form is symmetric.</p>\n\n<p>The first table (achievements_base) contains the achievements reference : each achievement have :\n- an ID (id of the row, auto-increment &amp; unique),\n- a code_id (reference of the achievement),\n- a rank_id (sub-category of achievement's code_id),\n- and the achievement name (display purposes).</p>\n\n<p>The second table (achievements_user) contains the achievements obtained by the users : each achievement unlocked have :\n- an ID (if of the row, auto-increment &amp; unique),\n- the code_id (reference of the achievement),\n- a rank_id (sub-category of achievement's code_id),\n- and the user id.</p>\n\n<p>The tables syntax is :</p>\n\n<pre><code>achievements_base\nid - code_id - rank_id - name\n1 - 1 - 1 - foo\n2 - 1 - 2 - bar\n3 - 1 - 3 - foobar\n4 - 1 - 4 - foofoo\n5 - 2 - 1 - barbar\n\nachievements_user\nid - code_id - rank_id - user_id\n1 - 1 - 1 - 1\n2 - 1 - 2 - 1\n3 - 2 - 1 - 1\n</code></pre>\n\n<p>I want to display achievements that user don't have (GROUP BY code_id)</p>\n\n<pre><code>In the table exemple above, for example, expected result is, for the user_id 1 :\n3 - 1 - 3 - foobar\n</code></pre>\n\n<p>But I don't see how to do that ! I've already tried multiples queries.</p>\n\n<p>Sorry for my English, I'm French !</p>\n\n<p>Thanks !</p>\n\n<p>edit, example of one of queries that I've tried :</p>\n\n<pre><code>SELECT AB.name\nFROM achievements_base AB\nRIGHT JOIN achievements_users AU \nON AU.code_id = AB.code_id AND AU.rank_id = AB.rank_id\nWHERE (SELECT COUNT(*) FROM achievements_users AU WHERE AU.user_id = 1) = 0\nGROUP BY AB.code_id\nORDER BY AB.code_id ASC\n</code></pre>\n"},{"tags":[".net","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":270,"score":0,"question_id":8595100,"title":"Embedded databases: SQLite or SQL CE?","body":"<p>I currently trying to decide which embedded database to pick up for new .NET project. There are 2 candidates: SQLite and SQL CE.</p>\n\n<p>I put the performance on first place. But it is also important, are there support for microORM tools like Dapper-dot-net or Simple.Data.</p>\n\n<p>If you tried both and have opinion on that, I would be happy to hear!  </p>\n"},{"tags":["sql","sql-server","sql-server-2005","replication"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13082881,"title":"sql table with identity in merge replication","body":"<p>I have a table in SQL Server 2005 and I have an IDENTITY(1,1) property set for an ID column.  Records are inserted in a table at a local server as well as a remote server.  I am using Merge Replication to match the data from local server and remote server.</p>\n\n<p>What happens if I insert the same ID at the local server and the remote server?</p>\n\n<p>Please suggest what am I doing wrong here.</p>\n"},{"tags":["sql","neo4j"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13149658,"title":"Importing data from SQL Server to Neo4J","body":"<p>First let me explain. My platform is mostly Windows and my data mostly resides in a relational database (SQL Server 2008). I primarily work with C# but occasuionally work with PERL and JavaScript. I was looking to learning what a graph database could do for my data but there seems to be a continual stream of tools and utilities that are not available that I need to install and learn. I am so busy learning the tools that I loose focus of what I really want and that is to work with a graph database. \nIt seems that Neo4j is relatively small and should be accessible to evaluate its features. I would like to import my data from an existing SQL database into Neo4J with the relationships established initially via the foreign keys. The idea seems relatively straightforward but it seems I need to learn Java, PHP, etc. not only to access Neo4J but also to access the existing database. I was wondering if anyone had some recommendations, tools, documentation that would accomplish this goal fairly simply. Do I do down the route of PHP? Java? What additional libraries/packages do I need? What tools are most useful? Thank you.</p>\n"},{"tags":["sql","web","report","sccm"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13039093,"title":"SCCM 2007 SQL Query","body":"<p>I need some help writing an SQL query and I am not well versed in this by any means. I am trying to find computer hardware on systems that have software installed with a display name of, lets just say, \"TestMe\". Here is the SQL code:</p>\n\n<pre><code>SELECT dbo.v_GS_ADD_REMOVE_PROGRAMS_DispalyName0, SYS.Netbios_Name0, Processor.Name0, Processor.MaxClockSpeed0, Processor.DeviceID0\nFROM v_R_System SYS\nJOIN v_GS_PROCESSOR Processor on SYS.ResourceID=Processor.ResourceID\nJOIN dbo.v_GS_ADD_REMOVE_PROGRAMS\nWHERE v_GS_ADD_REMOVE_PROGRAMS_DisplayName0 LIKE %TestMe%\nORDER BY SYS.Netbios_Name0\n</code></pre>\n\n<p>When I execute this, I keep getting the following error: </p>\n\n<pre><code>Msg 156, Level 15, State 1, Line 5\nIncorrect syntax near the keyword 'WHERE'.\n</code></pre>\n\n<p>I greatly appreciate your help. Thanks everyone. </p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13143848,"title":"WHERE condition across multiple rows","body":"<p>I have this table...</p>\n\n<pre><code>--------------------------------------\n| user_id |  status   |  status_date |\n--------------------------------------\n|    1    |  Current  |  2012-08-01  |\n|    1    |  Referral |  2012-03-14  |\n|    2    |  Referral |  2012-04-23  |\n|         |           |              |\n--------------------------------------\n</code></pre>\n\n<p>How would I query to find a distinct user_id who has a referral date before 2012-06-30 AND either a current date of after 2012-06-30 or no current status record at all? </p>\n\n<p>Database is MySQL.</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":27,"score":1,"question_id":13149201,"title":"SQL finding course name from course code","body":"<p>I have 2 tables, <code>students</code> and <code>courses</code>. In the students table each student has a course code and in the courses table I have course codes with their names. </p>\n\n<p>How can I return the course name when running the query? </p>\n\n<p>So for example if I run a basic <code>SELECT * FROM Students</code> it says <strong>\"Jimmy | Computing\"</strong> instead of <strong>\"Jimmy | 12390814\"</strong></p>\n"},{"tags":["sql","join","if-statement","exists"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13144391,"title":"How can I use conditional logic to choose which record to join in SQL?","body":"<p>I am working on a query that, among other things, selects one phone number for a person given their ID number.</p>\n\n<p>This bit of code gets it:</p>\n\n<pre><code>LEFT JOIN [thedatabasename].dbo.[thetablename] Phone \nON p.PersonId = phone.PersonId \nAND (phone.[Description] = 'Home Phone' \n     OR phone.[Description] = 'Cell Phone' \n     OR phone.[Description] is null)\n</code></pre>\n\n<p>This works, but what I want is for it do something that is conceptually more like</p>\n\n<pre><code>IF EXISTS select [phone number] from &lt;tablename&gt; where description = 'Home phone'\nELSE IF EXISTS select [phone number] from &lt;tablename&gt; where description = 'cell phone'\nELSE IF EXISTS select [phone number] from &lt;tablename&gt; where description is null\n</code></pre>\n\n<p>so that it prefers the 'home phone' over 'cell phone', and prefers 'cell phone' over one with no description. I don't know how to do that in the middle of my join though. Is there a way to do that without having to write three separate selects? The query that this join is part of is ugly and massive and has a bunch of joins, so separating it out would be tough. Any suggestions?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":592,"score":1,"question_id":3270779,"title":"SCOPE_IDENTITY() return NULL?","body":"<p>I am using SQL Server 2008 express, below is the SP, who return </p>\n\n<blockquote>\n  <p>(0 row(s) affected)  </p>\n  \n  <p>Msg 515, Level\n  16, State 2, Procedure\n  sp_AddCarrierFees, </p>\n  \n  <p>Line 21 Cannot\n  insert the value NULL into column\n  'attribute_value_id', table\n  'MyDevSystem.dbo.shipping_fees'; </p>\n  \n  <p>column\n  does not allow nulls. INSERT fails.\n  The statement has been terminated.</p>\n  \n  <p>(1 row(s) affected)</p>\n</blockquote>\n\n<p>And this is the SP :</p>\n\n<pre><code>GO\n\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER PROCEDURE [dbo].[sp_AddCarrierFees]\n    @carrier_id INT,\n    @zone_id INT,\n    @attribute_value_id INT,\n    @attribute_title varchar(20),\n    @fees decimal(6,2)\nAS\nBEGIN\n    if @attribute_value_id = 0 begin \n        insert into shipping_attribute_value (attribute_id,attribute_value,sort_order) \n        select attribute_id, @fees,0 from shipping_attribute where carrier_id=@carrier_id and attribute_title=@attribute_title; \n\n        declare @NewID int;\n        set @NewID = SCOPE_IDENTITY(); \n        print @NewID;\n\n        insert into shipping_fees (zone_id, attribute_value_id) values (@zone_id, @NewID); \n    end \n    else \n    begin \n        update shipping_attribute_value set attribute_value=@fees where attribute_value_id=@attribute_value_id;\n    end\nEND\n</code></pre>\n\n<p>Any people know why? I have read many post in StackOverFlow, but still not find solution.Somebody say use @@IDENTITY or IDENT_CURRENT instead, but it possible got the identity who made by other users.</p>\n\n<p><strong>FIXED:I found the reason, because the first insert statement is fail, so why return (0 row(s) affected) , after i fix that insert statement,it works now. thanks you for everyone.</strong></p>\n"},{"tags":["java","sql","oracle","jdbc","jndi"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4134,"score":2,"question_id":320299,"title":"How to limit number of rows returned from Oracle at the JDBC data source level?","body":"<p>Is there a way to limit the rows returned at the Oracle datasource level in a Tomcat application?</p>\n\n<p>It seems <code>maxRows</code> is only available if you set it on the datasource in the Java code. Putting <code>maxRows=\"2\"</code> on the datasource doesn't apply.</p>\n\n<p>Is there any other way limit the rows returned? Without a code change?</p>\n"},{"tags":["sql","tsql","oracle10g"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13147705,"title":"sql query to subtract two table values and save them in first table?","body":"<p>How do I subtract one table column value from another table column value, and save the value in the first table column in the process?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["sql","sql-server","triggers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13148106,"title":"SQL Server Instead of Update Trigger Using Update 'Where' Clause Values","body":"<p>I think I'm close on this one, I just can't seem to get it right.  I've also looked through a lot of questions and answers and either I can't find the answer or I don't understand the questions of others so, please forgive if this is a re-post.</p>\n\n<p>What I want to do seems pretty basic as far as the idea of an \"Instead Of\" trigger goes.  I'm working in SQL Server 2008.  I have a view that can't be updated directly so I need an Instead Of Update trigger to update one of the underlying tables.  The primary key of the table in questions will not be included as part of the Update statement so I have to select using a foreign key.  </p>\n\n<p>I'm trying to get the foreign key supplied in the Where clause of the Update statement but I must be using the wrong syntax.  I'm pretty sure that I must be able to get 'Where' values since they seem likely to be used as keys to underlying tables.  So, given the statement...</p>\n\n<pre><code>UPDATE table1 SET field1 = 'value1' WHERE key_field = 'key_value'\n</code></pre>\n\n<p>How do I access get the 'key_value' inside my trigger definition?  I've tried the following...</p>\n\n<pre><code>DECLARE @pk INT\nSELECT @pk = p_key\n  FROM dbo.ptable p, UPDATED u\n WHERE p.f_key = u.key_field\n</code></pre>\n\n<p>And this as well...</p>\n\n<pre><code>DECLARE @pk INT\n SELECT @pk = p_key\n   FROM dbo.ptable\n  WHERE f_key = (SELECT key_field\n                   FROM UPDATED)\n</code></pre>\n\n<p>But neither of these seem to work for me.  I'm pretty sure I'm getting the update value correctly using...</p>\n\n<pre><code>DECLARE @uValue VARCHAR\nSELECT @uValue = field1\n  FROM UPDATED\n</code></pre>\n\n<p>I want to be able to use the derived primary key for an insert or update like this...</p>\n\n<pre><code>INSERT INTO dbo.xtable (fieldx) VALUES (@uValue) WHERE p_key = @pk;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>UPDATE dbo.xtable SET fieldx = @uValue WHERE p_key = @pk;\n</code></pre>\n\n<p>Hopefully, I'm making sense and I'm not too far off.  Thanks for your help.</p>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13127510,"title":"Date displaying differently on different servers","body":"<p>When i run the following query on my desktop</p>\n\n<pre><code>Select to_char(join_date, 'DD-MON-YYYY')\nFrom students\ngroup by to_char(join_date, 'DD-MON-YYYY');\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>23-Oct-2012\n25-Oct-2012\n23-Oct-2012\n23-Oct-2012\n23-Oct-2012\n26-Oct-2012\n23-Oct-2012\n24-Oct-2012\n23-Oct-2012\n</code></pre>\n\n<p>But if i run it on a different server, the output comes out as: </p>\n\n<pre><code>23-Oct. -2012\n25-Oct. -2012\n23-Oct. -2012\n23-Oct. -2012\n23-Oct. -2012\n26-Oct. -2012\n23-Oct. -2012\n24-Oct. -2012\n23-Oct. -2012\n</code></pre>\n\n<p>Any ideas what could be causing this? \nThe second server is running in a different country from me so its regional settings could be different. </p>\n\n<p>Update:</p>\n\n<p>NLS_DATE_FORMAT is DD-Mon-RRRR on both servers. </p>\n"},{"tags":["mysql","sql","console","wamp"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3416,"score":2,"question_id":2956407,"title":"MySQL console slow on import of huge SQL files","body":"<p>My import of SQL via the MySQL console is rather slow, and, as our SQL file is increasing every day, I would like to know if there are any alternatives on how to import an SQL file faster.</p>\n\n<p>Changing to Oracle or other systems is not an option, the configuration has to stay the same.</p>\n\n<p>Currently the SQL file is: 1.5 GB.\nI'm on <a href=\"http://en.wikipedia.org/wiki/WAMP\" rel=\"nofollow\">WAMP</a> with Apache 2.2.14, PHP 5.2.11 and MySQL 5.1.41.</p>\n\n<p>Perhaps the issue is here, import is done by a simple:</p>\n\n<pre><code>mysql -u username -p dbname &lt; sqlfilename.sql\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["php","sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13147759,"title":"Storing the results of pg_query in a table","body":"<p>Is it possible to store the results of a query in a table?</p>\n\n<p>For example, I currently run a query using the following approach in <code>php</code>:</p>\n\n<pre><code>$sql = \"SELECT id FROM mytable\";\n$query = pg_query($connection, $sql);\n</code></pre>\n\n<p>I then use <code>pg_fetch_row()</code> to access the result and return it to the web-browser. However, I would like to also store the results in a new table. I understand that I could run the same query twice so I would also have:</p>\n\n<pre><code>$sql_2 = \"CREATE newtable AS SELECT id FROM mytable\";\n$query = pg_query($connection, $sql_2);\n</code></pre>\n\n<p>I was curious if there was a more efficient way of structuring my queries, so that I could both access the results, and insert the results into a table through just one query.</p>\n"},{"tags":["sql","performance","azure","sql-azure"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13148473,"title":"SQL Azure - very slow compared to localhost database","body":"<p>I decided I wanted to try out Microsoft SQL Azure, as many people have talked very highly about it. It should be fast, flexible, cheap and many other things.</p>\n\n<p>I got it up and running, migrated my data to Azure and hooked up the connectionstring. I tried to run some queries on the database, and was shocked about how slow even simple queries were. A \"SELECT *\" from a table with 700 rows took 7 seconds. My page also seems extremely slow, compared to when I used a localhost managent studio or a database on a shared hosting. </p>\n\n<p>Now, when I setup my server, I couldn't pick a physical position. However, I live in Denmark, and I can see the server is the \"South Central US\". This might be the issue.</p>\n\n<p>I don't use any stored procedures (so I guess no parameter sniffing).. I can also see my indexes is transfered succesfully.</p>\n\n<p>Any ideas on what to do? Any performance things I am missing? </p>\n"},{"tags":["c#","asp.net","sql","gridview","objectdatasource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13125618,"title":"Editing the column of an objectdatasource before databind","body":"<p>Currently I'm using a gridview with an objectdatasource to display a table of product info. I also have a drop down list to switch the view between Imperial and Metric units. To switch between the two, every time someone changes the drop down list selection, I am deleting the old units column and inserting a new column based on the selection, as follows:</p>\n\n<pre><code>if (GridView1.Columns.Count &gt; 7)\n     JobListGridView.Columns.Remove(GridView1.Columns[7]);\n\nBoundField colIndex8 = new BoundField();\ncolIndex8.HeaderText = \"Units\";\n\nif (UnitsDropDown.Text == \"Imperial\")\n{\n     colIndex8.DataField = \"IUnits\";\n     colIndex8.SortExpression = \"IUnits\";\n     GridView1.Columns.Add(colIndex8);\n}\nelse\n{\n     colIndex8.DataField = \"MUnits\";\n     colIndex8.SortExpression = \"MUnits\";\n     GridView1.Columns.Add(colIndex8);\n}\nGridView1.DataBind();\n</code></pre>\n\n<p>This works to change the units being displayed in the units column (e.g. from \"mm\" to \"ft\"). However, I also need to change the value of another column that displays length. Is it possible to somehow edit the values in the length column (say multiply by a constant) and then databinding the modified column to the gridview without having to create a new column in the database table to store this information?</p>\n\n<p>I am imagining something like:</p>\n\n<pre><code>DataColumn dc = GridView1.Columns[4];\nforeach (cell c in dc)\n{\n    c *= 0.5;\n}\nGridView1.Columns.Add(dc);\nGridView1.DataBind();\n</code></pre>\n\n<p>As simple pseudo-code, but is this the right approach/is this possible?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":16,"score":-2,"question_id":13148270,"title":"sql file error message","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13147356/sql-error-i-cant-figure-this-out\">SQL error I can’t figure this out</a>  </p>\n</blockquote>\n\n\n\n<pre><code>#\n# Table structure for table `pa_adclicks`\n#\nCREATE TABLE pa_adclicks(\nbannerid mediumint( 9 ) NOT NULL default '0',\nzoneid mediumint( 9 ) NOT NULL default '0',\nt_stamptimestamp( 14 ) NOT NULL ,\nhost varchar( 255 ) NOT NULL default '',\nsource varchar( 50 ) NOT NULL default '',\ncountrychar( 2 ) NOT NULL default '',\nKEY bannerid_date( bannerid, t_stamp ) ,\nKEY date( t_stamp ) ,\nKEY zoneid( zoneid )\n) ENGINE = 'MyISAM';\n</code></pre>\n\n<p>MySQL said: Documentation</p>\n\n<blockquote>\n  <p>1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use\n  near '(14) NOT NULL,   host varchar(255) NOT NULL default '',   source\n  varchar(50) NOT' at line 14</p>\n</blockquote>\n"},{"tags":["sql","sql-server","aggregate-functions","median"],"answer_count":15,"favorite_count":13,"up_vote_count":37,"down_vote_count":0,"view_count":37332,"score":37,"question_id":1342898,"title":"Function to Calculate Median in Sql Server","body":"<p>According to <a href=\"http://msdn.microsoft.com/en-us/library/ms173454.aspx\" rel=\"nofollow\">MSDN</a>, Median is not available as an aggregate function in Transact-Sql. However, I would like to find out whether it is possible to create this functionality (using the <a href=\"http://msdn.microsoft.com/en-us/library/ms182741.aspx\" rel=\"nofollow\">Create Aggregate</a> function, user defined function, or some other method). </p>\n\n<p>What would be the best way (if possible) to do this - allow for the calculation of a median value (assuming a numeric data type) in an aggregate query?</p>\n"},{"tags":["sql","vb.net","reporting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13148251,"title":"Reporting Services: Using text function inside a URL","body":"<p>Quick question here.  I am building a report that needs to have a link embedded in it to a file.  The directory structure is such that each line of data will point to a different data file in a different directory.  I am using the MID function to get the folder name I need from the generated data, but I am unable to format the hyperlink properly.  Right now, I have the URL function formatted like this:</p>\n\n<pre><code>('file:\\\\rootserver\\dfsroot\\Data\\Archive\\Node\\(Mid(Number.Value,2,4))\\weeksumm.20121029')\n</code></pre>\n\n<p>When the report runs, this should translate to a numbered folder such as below, but the same filename.</p>\n\n<pre><code>('file:\\\\rootserver\\dfsroot\\Data\\Archive\\Node\\4456\\weeksumm.20121029')\n</code></pre>\n\n<p>In summary, how do I format the URL function for the textbox to accept the Mid function being performed as part of the file path?  Thanks.</p>\n"},{"tags":["java","sql","hibernate","postgresql","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13115798,"title":"SQLGrammarException on Heroku after local database change","body":"<p>I created a Java webapp that uses Hibernate and PostgreSQL. It is based on Heroku's Java MVC tutorial (<a href=\"https://devcenter.heroku.com/articles/spring-mvc-hibernate\" rel=\"nofollow\">https://devcenter.heroku.com/articles/spring-mvc-hibernate</a>). I made some minor database changes and correctly update all hibernate annotation. Everything works fine locally, but after pushing to Heroku, I now get this error: </p>\n\n<pre><code>org.hibernate.exception.SQLGrammarException: could not execute query\n</code></pre>\n\n<p>...</p>\n\n<pre><code>Caused by: org.postgresql.util.PSQLException: ERROR: relation \"MY_TABLE\" does not exist\n</code></pre>\n\n<p>So it seems the database changes which exist on my local machine are not reflected up in the heroku cloud. How can I get Heroku to \"reset\" or \"rebuild\" my database?</p>\n\n<p><strong>Update</strong> - I ran <code>heroku pg:reset</code> and it threw an \"Internal server error\" telling me to \"Run 'heroku status' to check for known platform issues\", however running that gave no info. I then checked the site and it was working again (no data of course, but that was expected). Not sure what really happened, but that fixed the problem. Of course, it helps that i was ok with losing all my data.</p>\n"},{"tags":["java","mysql","sql","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":90,"score":-1,"question_id":13147791,"title":"Is it possible to soft code sql statements?","body":"<p>I was told that it is possible to soft code SQL queries instead of hard coding them. Just like we parse JSON responses in Java, we can do that through an external file like below:</p>\n\n<pre><code>abc:[\n{\nsql:\"selecct count(*) from some_database\",\ncount:\"100\"\n}]\n</code></pre>\n\n<p>Is it possible? How I can do that? Links or articles would be appreciated. I am using <strong>Hibernate</strong>. How can I run a SQL query through external file in Hibernate?</p>\n"},{"tags":["c#",".net","sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13147434,"title":"ORA-00933: SQL command not properly ended when running create sequence commands","body":"<p>I'm trying to execute some sql using the following C# code:</p>\n\n<pre><code>IDbCommand objOracleCommand = CreateCommand(commandPart, connection, transaction);\nobjOracleCommand.ExecuteNonQuery();\n</code></pre>\n\n<p>I'm getting back a \"ORA-00933: SQL command not properly ended\" error.  </p>\n\n<p>commandPart is a string that looks like:</p>\n\n<pre><code>CREATE SEQUENCE seq_1\nINCREMENT BY 1\nSTART WITH 1\nNOMAXVALUE\nNOMINVALUE\nNOCACHE\nNOCYCLE\nNOORDER\n\nCREATE SEQUENCE seq_2 START WITH 1 INCREMENT BY 1\n</code></pre>\n\n<p>The commandPart is actually being read in from a text file.  The original SQL has semi-colons like so:</p>\n\n<pre><code>CREATE SEQUENCE seq_1\nINCREMENT BY 1\nSTART WITH 1\nNOMAXVALUE\nNOMINVALUE\nNOCACHE\nNOCYCLE\nNOORDER;\n\nCREATE SEQUENCE seq_2 START WITH 1 INCREMENT BY 1;\n</code></pre>\n\n<p>This original snippet (with semi-colons) will run just fine in SQL Developer.  If I run the original snippet via C# I get \"ora-00911: invalid character\".  Any ideas?</p>\n\n<p>Thanks,\nEric</p>\n"},{"tags":["php","mysql","sql","string","injection"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":1,"view_count":120,"score":3,"question_id":13147555,"title":"PHP SQL Injection Prevention With String Operations","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php\">Best way to prevent SQL injection in PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>I have been doing some research about SQL Injection but I have some questions that I couldn't find answer to. Isn't it possible to prevent SQL injection attacks on string levels? What I mean is, can't we prevent it by;</p>\n\n<ul>\n<li><p><strong>Finding illegal characters before processing them through mysql queries?</strong></p>\n\n<pre><code>$postID = $_POST['id'];\nif($postID contains characters)\n    remove characters;\nif($postID still contains characters)\n    then exit;\nelse\n    mysql_real_escape_string($postID); //just in case?\ncontinue to do whatever you are doing...\n</code></pre></li>\n</ul>\n\n<p>Is it really necessary to use PDO/mysqli stuff? Is it sufficient to analyze your sql strings to be processed in mysql? Please keep in mind that I am not a PHP or MySQL expert while replying. I am someone who is trying to learn about them.</p>\n"},{"tags":["c#","sql","winapi","registry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":53,"score":-1,"question_id":10661136,"title":"Registry and a Database","body":"<p>I've got an application that currently filters through a users Registry; if it finds one of the specific <code>UninstallString msiexec /x</code> then it runs a separate process to either uninstall or repair.</p>\n\n<p>So I've created a local SQL database; that upon install will have them stored in the database.  I'm having difficulty comparing the data read from SQL to the object containing all the Registry Keys.</p>\n\n<p>Any thoughts?  </p>\n\n<pre><code>RegistryKey rk = Registry.LocalMachine.OpenSubKey(@\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\");\nString [] rSK = rk.GetSubKeyNames();\nforeach (string r in rSK)\n{\nif (msiSQL = r)\n{\n\n// Process to Repair / Uninstall.\n}\n}\n</code></pre>\n\n<p>I know the <code>if</code> Statement can't work like that, it has to be set as a String Compare.  But that general process should work?  Any thoughts?</p>\n\n<p>Essentially my office helps customers; but there are several different versions that may be installed on the client machine.  Example: Software 2011, Software 2012, Software 2013.  There is a new version each year; so I'm trying to simplify by having this support application to automatically find it and repair or uninstall.</p>\n\n<p>If you have an easier method rather then deploying a local database; I'm all ears for that as well.</p>\n\n<p><em><strong></em> Edited October 30th, 2012 <em>*</em></strong>\nHello,</p>\n\n<p>I apologize I'm a few months late on this post.  This project was pushed to the side due to a higher priority one; the issue.</p>\n\n<p>When you recursively search through the Registry you can find the software version; I found the solution to recursively search the Registry for a given key.  The issue came when trying to find a clean way to uninstall at that point.</p>\n\n<p>Example:\nCustomer 1: Software 2011\nCustomer 2: Software 2012\nCustomer 3: Software 2013</p>\n\n<p>Pulling the GUID is possible; but I couldn't find a clean design pattern to be able to uninstall whatever the version is.  I'm not sure what result the customer will have installed; but I need to get it removed.</p>\n\n<p>So my original thought was to create a text-file, have the application load a database, or link to a web-service to compare a master file that contains all our application GUID's then just find the one that matches then uninstall.</p>\n\n<p>But that seemed very, very clunky and wasteful in time.  As every year the database will need to be updated.  Was trying to find a cleaner solution to find the application, then uninstall the application. </p>\n\n<p>Hopefully that clarifies the issue.  I'll check back frequently to try and stay up to date so there aren't any delays.  Also I apologize for the long delay and the lack of concise details in explaining the problem.  </p>\n\n<p>I'd still love to know the answer though.</p>\n"},{"tags":["sql","sql-server","identity"],"answer_count":8,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":3546,"score":10,"question_id":1920558,"title":"What is the difference between Scope_Identity(), Identity(), @@Identity, and Ident_Current?","body":"<p>I know Scope_Identity(), Identity(), @@Identity, and Ident_Current all get the value of the identity column, but i would love to know the difference.</p>\n\n<p>Part of the controversy i'm having is what do they mean by scope as applied to these functions above?</p>\n\n<p>I would also love a simple example of different scenarios of using them?</p>\n"},{"tags":["sql","relational-algebra"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13147449,"title":"How beneficial is it to think in terms of relational algebra before writing SQL?","body":"<p>In a class on dbms we are taught to \"make the solution in relational algebra\" before converting to SQL. It really has become second nature and it's almost difficult to directly write SQL. Is this bad or good? I'm told it leads to better queries which is good but I can see a person getting fired quick if every time their asked to find something in a database they start writing math on a piece of paper. </p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":83,"score":4,"question_id":13147352,"title":"SELECT * users who are a certain age","body":"<p>In the <code>users</code> table I have a field called <code>dob</code> which stores the date of birth of the user in this format:</p>\n\n<pre><code>1959-04-02\n</code></pre>\n\n<p>Anyway I would like to SELECT all users who are 18 and 19 years old. This is my query:</p>\n\n<pre><code>SELECT *\nFROM `users`\nWHERE dob BETWEEN '1993-10-30' AND '1994-10-30'\n</code></pre>\n\n<p>But it only seems to select mostly 18 year olds and some (but not all) 19 year olds. I have a bunch of test users in the db and the number of 18 and 19 year olds are equal. Yet this query yields about 90% 18 year olds and about 10% 19 year olds. Why?</p>\n"},{"tags":["php","mysql","sql","doctrine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":159,"score":1,"question_id":9128038,"title":"Count words in column with SQL","body":"<pre><code>id | words                            | other\n1  | lorem ipsum                      | dsf\n2  | Lorem Ipsum is simply dummy text | sads\n3  | simply dummy text                | sdf\n4  | Lorem Ipsum  text                | sdfsdf\n5  | simply dummy Lorem               | asddasd \n</code></pre>\n\n<p>I do SELECT * FROM words .\nHow can i count how many words is in this answer of query? In this example should be 17.\nI use PHP and Doctrine.</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13146239,"title":"Join multiple rows give one distinct row","body":"<p>My SQL statement returns the following </p>\n\n<pre><code>SQLID  Col1  Col2  Col3\n14945  NULL  NULL  sdf\n14945  NULL  xyz   NULL\n14945  abc   NULL  NULL\n</code></pre>\n\n<p>where as I would like it to return </p>\n\n<pre><code>SQLID   Col1 Col2   Col3\n14945   abc  xyz    sdf\n</code></pre>\n\n<p>Please help.</p>\n\n<p>The schema is such that I have a table which contains <code>SQLID</code>'s. And a second table which contains <code>SQLID</code>'s as the FK to first table and the col1, col2 and col3. Currently I am just doing a join on <code>SQLId</code> </p>\n\n<pre><code>Select \n    t1.SQLID, t2.Col1, t2.col2, t2.col3\nfrom\n    Table1 t1 \njoin\n    table2 t2 on t1.SQLId = t2.SQLid\n</code></pre>\n"},{"tags":["php","mysql","html","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":301,"score":3,"question_id":11507002,"title":"Inserting Registered Trademark Symbol/Copyright Symbol into MySQL  with PHP","body":"<p>I am having a hard time understanding how to insert the registered trademark sybol and copyright symbol to my mySQL database using php.</p>\n\n<p>When I insert the normal character of the reistered trademark symbol, it returns some random values when I try to retrieve it.</p>\n"},{"tags":["python","sql","django","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13146441,"title":"How to restore a continuous sequence of IDs as primary keys in a SQL database?","body":"<p>I'm using a SQlite database and Django's <code>QuerySet</code> API to access this database. I wrote data sequentially into the database and each entry has a simple ID as the primary key (this is the Django default). This means that there is a continuous sequence of IDs now in the database (entry 1 has ID 1, entry 2 has ID 2, and so on). Now I needed to delete some entries again. This means that the sequence of IDs is discontinuous now (entry 1 has ID 1, but entry 2 might have ID 3, 8, 1432 or anything else, but not 2).</p>\n\n<p>How can I restore this continuous sequence of IDs again and associate them with the remaining entries in the database? Is there a way to do this with Django's <code>QuerySet</code> API or do I need to use plain SQL? I have no experience with plain SQL, so some working code would be very helpful in this case. Thank you!</p>\n"},{"tags":["mysql","sql","subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13146592,"title":"How to make right subquery?","body":"<p>Well, I got table <code>Workers</code> in my DB. There are 4 columns <code>id</code>,<code>name</code>,<code>salary</code> and <code>department</code>. I need to show list of departments where count of workers with salary more than 90% of max salary value in row and where count of workers with such salary is more than 15% of workers count in department.</p>\n\n<p>At first I made such query which shows all rows with workers who have big salary</p>\n\n<pre><code> SELECT * \n FROM   `Workers` \n WHERE id IN (\n    SELECT `id`  \n    FROM   `Workers` \n    WHERE  `salary` &gt; 0.9 * (SELECT MAX( `salary` )\n                             FROM  `Workers`)) \n</code></pre>\n\n<p>Maybe I asking really silly thing but I stuck and i don't know really how to make next step to throw from it workers who have big salary but in their departments are less than 15% got salaries like this. </p>\n"},{"tags":["sql","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13146352,"title":"group By Contact information by customerID","body":"<p>I am trying to to remove the duplicated from my SQL statement Customer id ,firstname and lastName I want to be able group by customerID and Remove the duplicated Customer id form,firstname and lastName From Final output</p>\n\n<pre><code>SELECT customers.customerid, \n       customers.title, \n       customers.firstname, \n       customers.lastname, \n       customers.postion, \n       company.companyname, \n       (SELECT label.labelcontacttype \n        FROM   label \n        WHERE  label.labelcontacttypeid = \n       customer_contacts.labelcontacttypeid)AS \n       contactType, \n       customer_contacts.contactdetails, \n       customer_contacts.status, \n       customer_contacts.notes \nFROM   customers \n       INNER JOIN customer_company \n               ON customers.customerid = customer_company.customerid \n       INNER JOIN company \n               ON customer_company.companyid = company.companyid \n       INNER JOIN customer_contacts \n               ON customers.customerid = customer_contacts.customerid \n</code></pre>\n\n<p>Current output </p>\n\n<pre><code>15  Mr  Mike Smith Web Developer    compudata   Email   email@email.com 1   dvv  \n15  Mr  Mike Smith Web Developer    compudata   Phone   111-111-1111    1   ex:2222\n</code></pre>\n"},{"tags":["c#","sql","like","sqlcommand"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13145488,"title":"Query not functioning with LIKE","body":"<p>I'm running a query via <code>C#</code> using an <code>SqlCommand</code>. One for of the query performs as expected, but when I complicate it, I'm getting strange results that don't seem to make sense. I'm hoping someone is this community can make more sense of it than I am right now.</p>\n\n<p>The below code runs fine, finding any record with the title containing the supplied text.</p>\n\n<pre><code>comm.CommandText = \"SELECT * FROM tbl_records WHERE Title LIKE '%' + @title + '%'\";\ncomm.Parameters.AddWithValue(\"id\", Request.QueryString[\"idortitle\"]);\ncomm.Parameters.AddWithValue(\"title\", Request.QueryString[\"idortitle\"]);\n</code></pre>\n\n<p>However, when I add the below section, the only results returned are those matching the id. The results that partial-match the title are excluded. Why is this happening?</p>\n\n<pre><code>comm.CommandText = \"SELECT * FROM tbl_records WHERE Title LIKE '%' + @title + '%' OR Id=@id\";\ncomm.Parameters.AddWithValue(\"id\", Request.QueryString[\"idortitle\"]);\ncomm.Parameters.AddWithValue(\"title\", Request.QueryString[\"idortitle\"]);\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13146304,"title":"How to Select Every Row Where Column Value is NOT Distinct","body":"<p>I need to run a select statement that returns all rows where the value of a column (i.e. EmailAddress) is not distinct.</p>\n\n<p>For example, if the table looks like below:</p>\n\n<pre><code>CustomerName     EmailAddress\nAaron            aaron@gmail.com\nChristy          aaron@gmail.com\nJason            jason@gmail.com\nEric             eric@gmail.com\nJohn             aaron@gmail.com\n</code></pre>\n\n<p>I need the query to return:</p>\n\n<pre><code>Aaron            aaron@gmail.com\nChristy          aaron@gmail.com\nJohn             aaron@gmail.com (peer edited from john@gmail.com)\n</code></pre>\n\n<p>I have read many posts and tried different queries to no avail.  The query that I believe should work is below.  Can someone suggest an alternative or tell me what may be wrong with my query?</p>\n\n<pre><code>select EmailAddress, CustomerName from Customers\ngroup by EmailAddress, CustomerName\nhaving COUNT(distinct(EmailAddress)) &gt; 1\n</code></pre>\n"},{"tags":["sql","ms-access","function"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1675,"score":0,"question_id":1896161,"title":"MS Access 2007 sql functions?","body":"<p>Does MS Access 2007 support creation of user defined sql functions?\nif so, where is the option for it in the menu?</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13140518,"title":"Ordering left outer join using right table with fallback","body":"<p>I've got two tables:</p>\n\n<ul>\n<li>Table1 - Id, created_at</li>\n<li>Table2, Id, table1_id, created_at</li>\n</ul>\n\n<p>I want to include all Table1 rows with a join that fetches the latest Table2 record (if any, there may not be any table2 records) and used the created_at on Table2 to order the result. If there is not a Table2 record I'd like to be able to use the created_at in Table1 for that record's ordering.</p>\n\n<p>Example:</p>\n\n<pre><code>Table 1 (id, created_at)  \n1, 100  \n2, 200  \n3, 300  \n4, 400  \n\nTable 2 (id, table1_id, created_at)  \n1, 1, 500  \n2, 1, 450  \n3, 2, 350  \n</code></pre>\n\n<p>And the query would give the result (t1.id, t1.created_at, t2.id, t2.created_at)</p>\n\n<pre><code>1, 100, 1, 500  \n4, 400, --, --  \n2, 200, 2, 350  \n3, 300, --, --  \n</code></pre>\n\n<p>I'm using Postgresql. What would the best query/method to accomplish this?</p>\n"},{"tags":["sql","sql-server","replication"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":536,"score":1,"question_id":3211340,"title":"Sql Server replication over wan","body":"<p>Im looking at developing a simple ecommerce platform and need to replicate product and customer data to the web host over the internet so the website can run disconnected.  The two options i can think of at present are using enterprise messaging and database replication.</p>\n\n<p>Im leaning towards database replication over enterprise messaging as enterprise messaging would require additional developer resource to write all the plumbing code.  Anyone have any success using sql server one way replication over unreliable wan links through the internet?  </p>\n"},{"tags":["sql","ms-access","engine","jet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13135347,"title":"SQL Statement returns wrong values","body":"<p>I tried to get the the last and next row of my table by using this query:</p>\n\n<pre><code>SELECT TOP 1 Nummer FROM Empfänger WHERE Nummer &lt; 4748 ORDER BY Nummer DESC\nUNION \nSELECT TOP 2 Nummer FROM Empfänger WHERE Nummer &gt;= 4748 ORDER BY Nummer ASC;\n</code></pre>\n\n<p>The primary key “Nummer” is unique and auto-incremental  , so there is </p>\n\n<pre><code>4747, 4748, 4749\n</code></pre>\n\n<p>It should imho return the above stated numbers, but instead it returns:</p>\n\n<pre><code>4747, 4798, 4799\n</code></pre>\n\n<p>When I open the Database with Access and set the filter \"between\" the values are shown correctly.</p>\n\n<p>I changed the statement to:</p>\n\n<pre><code>SELECT DISTINCT TOP 1 Nummer FROM Empfänger WHERE Nummer &lt; 4748 ORDER BY Nummer DESC\nUNION \nSELECT DISTINCT Nummer FROM Empfänger WHERE Nummer = 4748 \nUNION \nSELECT DISTINCT TOP 1 Nummer FROM Empfänger WHERE Nummer &gt; 4748 ORDER BY Nummer ASC;\n</code></pre>\n\n<p>This works nearly perfectly.</p>\n\n<pre><code>4747, 4748, 4750\n</code></pre>\n\n<p>When I write every statement in a single query it returns the right values... </p>\n\n<pre><code>SELECT DISTINCT TOP 1 Nummer FROM Empfänger WHERE Nummer &lt; 4748 ORDER BY Nummer DESC\n= 4747\nSELECT DISTINCT Nummer FROM Empfänger WHERE Nummer = 4748 \n= 4748\nSELECT DISTINCT TOP 1 Nummer FROM Empfänger WHERE Nummer &gt; 4748 ORDER BY Nummer ASC;\n= 4749\n</code></pre>\n\n<p>\\</p>\n\n<pre><code>SELECT DISTINCT TOP 1 Nummer FROM Empfänger WHERE Nummer &lt; 4750 ORDER BY Nummer DESC\nUNION \nSELECT DISTINCT Nummer FROM Empfänger WHERE Nummer = 4750 \nUNION \nSELECT DISTINCT TOP 1 Nummer FROM Empfänger WHERE Nummer &gt; 4750 ORDER BY Nummer ASC;\n</code></pre>\n\n<p>I checked it again, suddenly the above shown query worked.\nThank you for your help.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13144458,"title":"improving performance of a view that is heavily dependent on dates","body":"<p><strong>This view is taking me HOURS to execute:</strong></p>\n\n<pre><code>USE [SalesDWH]\nGO\n\n/****** Object:  View [dbo].[FirstLastEstablished]    Script Date: 10/29/2012 15:12:47 ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER view [dbo].[FirstLastEstablished] as\n\n\nwith cte_min as(\n\nselect \n      a.client_id\n      ,a.specimen_source\n      ,a.received_date\nfrom\n      millennium_dw_dev..F_ACCESSION_DAILY a\njoin\n            (select distinct\n                  f.client_id\n                  ,f.received_date\n                  ,f.accession_daily_key\n            from \n                  millennium_dw_dev..F_ACCESSION_DAILY f\n            join \n                  (select CLIENT_ID, MIN(received_date) MinRecDate\n                  from millennium_dw_dev..F_ACCESSION_DAILY\n                  group by CLIENT_ID) i\n            on f.CLIENT_ID=i.CLIENT_ID\n            and f.RECEIVED_DATE=i.MinRecDate) b\non    \n      a.ACCESSION_DAILY_KEY=b.ACCESSION_DAILY_KEY \n\n)\n\n,\ncte_max as \n(\n\nselect \n      a.client_id\n      ,a.specimen_source\n      ,a.received_date\nfrom\n      millennium_dw_dev..F_ACCESSION_DAILY a\njoin\n            (select distinct\n                  f.client_id\n                  ,f.received_date\n                  ,f.accession_daily_key\n            from \n                  millennium_dw_dev..F_ACCESSION_DAILY f\n            join \n                  (select CLIENT_ID, max(received_date) MaxRecDate\n                  from millennium_dw_dev..F_ACCESSION_DAILY\n                  group by CLIENT_ID) i\n            on f.CLIENT_ID=i.CLIENT_ID\n            and f.RECEIVED_DATE=i.MaxRecDate) b\non    \n      a.ACCESSION_DAILY_KEY=b.ACCESSION_DAILY_KEY \n\n)\n,\n\n\ncte_est as\n\n(\n\nselect distinct client_id, MLIS_DATE_ESTABLISHED\nfrom millennium_dw_dev..D_CLIENT\nwhere REC_ACTIVE_FLG=1\nand MLIS_DATE_ESTABLISHED is not null\n)\n\n,\n\nmainQuery as(\nselect distinct\n      f.client_id\n      ,cmin.specimen_source first_specimen_source\n      ,cmin.received_date first_received\n      ,cmax.specimen_source last_specimen_source\n      ,cmax.received_date last_received\n      ,cest.MLIS_DATE_ESTABLISHED MLIS_DATE_ESTABLISHED\nfrom millennium_dw_dev..F_ACCESSION_DAILY f\nleft join cte_max cmax\non cmax.CLIENT_ID=f.CLIENT_ID\nleft join cte_min cmin\non cmin.CLIENT_ID=f.CLIENT_ID\nleft join cte_est cest\non cest.CLIENT_ID=f.CLIENT_ID\n)\n,\nDateDifferences\nas\n\n(\nSELECT\nclient_id,\n   (DATEDIFF(dd, MLIS_DATE_ESTABLISHED,first_received) + 1)\n  -(DATEDIFF(wk, MLIS_DATE_ESTABLISHED,first_received) * 2)\n  -(CASE WHEN DATENAME(dw, first_received) = 'Sunday' THEN 1 ELSE 0 END)\n  -(CASE WHEN DATENAME(dw, MLIS_DATE_ESTABLISHED) = 'Saturday' THEN 1 ELSE 0 END)\n -(case when cast('01/01/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('05/26/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('07/04/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('09/01/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('11/27/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('12/25/2008 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('01/01/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('05/25/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('07/03/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('09/07/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('11/26/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('12/25/2009 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('01/01/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('05/31/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('07/05/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('09/06/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('11/25/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('12/24/2010 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('01/03/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('05/30/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('07/04/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('09/05/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('11/24/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('12/26/2011 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('01/02/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('05/28/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('07/04/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('09/03/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('11/22/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n-(case when cast('12/25/2012 ' as date) between MLIS_DATE_ESTABLISHED and first_received then 1 else 0 end)\n\n\n   DifferenceExcludingWeekends\n  from\n  mainQuery\n)\n,\nTerritory \nas\n(\nselect distinct c.client_id,c.MLIS_TERRITORY,s.REGION_NAME\nfrom millennium_dw_dev..D_CLIENT c\nleft join millennium_dw_dev..D_SALES_HIERARCHY s\non s.TERRITORY_NAME=c.MLIS_TERRITORY\nwhere c.REC_ACTIVE_FLG=1\nand s.REC_ACTIVE_FLG=1\n\n)\n\nselect mainQuery.*,d.DifferenceExcludingWeekends,Territory.MLIS_TERRITORY,Territory.REGION_NAME\nfrom mainQuery\nleft join DateDifferences d\non mainQuery.CLIENT_ID=d.CLIENT_ID\nleft join Territory\non mainQuery.CLIENT_ID=Territory.CLIENT_ID\n\nGO\n</code></pre>\n\n<p>I did the sql server database tuning on this, and created all the recommended indexes. After 15min of executing the view again, I stopped it. </p>\n\n<p><strong>Are there obvious things that you could kindly point out to me about my query to optimize it more and improve execution time?</strong></p>\n"},{"tags":["sql","query","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13146033,"title":"oracle querying","body":"<p>Assuming I'm using a model like <a href=\"http://www.eclipse.org/birt/phoenix/db/dbschema/ClassicModelsDBSchema.jpg\" rel=\"nofollow\">this</a> </p>\n\n<p>How would I be able to find the last customer to order a give product?<br>\n<img src=\"http://i.stack.imgur.com/OeJ06.jpg\" alt=\"enter image description here\"></p>\n\n<p>I got this far</p>\n\n<pre><code>   SELECT customerNumber\nFROM ORDERS\nWHERE orderNumber = (SELECT  TOP 1 OrderNumber FROM orderDetails WHERE productCode = 1\nORDER BY orderDate DESCENDING)\n</code></pre>\n\n<p>Now I'm stuck. Not sure what subquery(s) should be.</p>\n"},{"tags":["c#","sql","like","wildcard","code-injection"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":69,"score":4,"question_id":13145785,"title":"Parameterized strings and the LIKE and wildcard operator","body":"<p>I have seen in my searches the use of parameterized strings in SQL queries formed as below:</p>\n\n<pre><code>SqlCommand comm = new SqlCommand();\ncomm.CommandText=\"SELECT * FROM table WHERE field LIKE '%'+@var+'%'\";\ncomm.Parameters.AddWithValue(\"var\",\"variabletext\");\nSqlDataReader reader = comm.ExecuteReader();\n</code></pre>\n\n<p>However, in this forum it was mentioned that is subject to sql injection despite it's being used in a parameterized string. I can only assume that concatenated strings bypass all parameterized security and just insert the value directly as a string. If this is the case, how does one use the wildcard operators in a parameterized query while avoiding sql code injection?</p>\n"},{"tags":["mysql","sql","database","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13095244,"title":"How to query 1 table with 6 columns with condition in 3 of the columns","body":"<p>All I'm trying to do is a query for my table that contains 6 columns with a condition that has to be met by 3 of those columns</p>\n\n<p>my table's information \ntable name My_table columns a1, a2, a3, a4, a5, a6</p>\n\n<p>the code I have tried is below, doesn't work of course</p>\n\n<pre><code>$myquery = \"SELECT * FROM My_table WHERE a2='$variable1' AND a3='$variable2' AND a6='$variable3' ORDER BY a2 ASC\";\n$myresult = mysql_query($myquery);\n</code></pre>\n\n<p>my result has to contain the rows that met the conditions above. </p>\n\n<p>What is the right way to do this?\nThanks in advance.</p>\n"},{"tags":["sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1444,"score":1,"question_id":3295155,"title":"Excel 2003 send date parameters to SQL query","body":"<p>PROBLEM: I have a few worksheets that use sql queries to retrieve data. I would like all of these sheets to query data based on the same date range entered by a user in excel.</p>\n\n<p>eg. I would enter somewhere in a form or in a cell a date range and retrieve the value in sql to obtain data based on the user specified dates.</p>\n\n<p>Is there anyway to access values from forms or from cells in SQL (Query editor perhaps)?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","r","sas","sqldf"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":120,"score":3,"question_id":11784115,"title":"Difference between PROC SQL and sqldf","body":"<p>I am in the midst of re-writing a SAS program I normally use into R. Many statements in the SAS program are written with proc sql, so for ease of programming I am replicating those statements with sqldf in R. All of the sql code works the same with sqldf as it does in SAS, except for this statement:</p>\n\n<p>SAS:</p>\n\n<pre><code>proc sql;\ncreate table merged32 as\nselect max(ctf) as ctf,\n       max(ctms) as ctms,\n       max(site_name) as site_name,\n       provider_id, npi,\n       first_name, middle_name, last_name, specialty,\n       address_1, city, state, site_ct, zip, site_key\n    from merged2\n    group by 9,10,11,12,14,15;\nquit;\nrun;\n</code></pre>\n\n<p>sqldf:</p>\n\n<pre><code>sqldf(\"select max(ctf) as ctf,\n              max(ctms) as ctms,\n              max(site_name) as site_name,\n              provider_id, npi,\n              first_name, middle_name, last_name, specialty,\n              address_1, city, state, site_ct, zip, site_key\n       from merged2\n       group by 9,10,11,12,14,15\")\n</code></pre>\n\n<p>In SAS, it returns a dataset with 1878 rows; in sqldf, a dataframe with 1375. </p>\n\n<p>Are there any major differences between proc sql and sqldf that could be causing this, or in general that need to be considered? I didn't provide data because 1) the datasets are huge, and 2) I'm more just interested in knowing the differences between the two sql systems. </p>\n"},{"tags":["php","html","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13104939,"title":"How to search for special characters in my database with an sql query in an accent insensitive way?","body":"<p>I have a table in my db that contains several columns and in some of them there are special characters like á, é, í, ó, ú, Á, É, Í, Ó, Ú, ñ and Ñ. I have in my webpage a search box and by using this I make a query that searches my bd table and displays the results like this:</p>\n\n<p>searching form:</p>\n\n<pre><code>&lt;form action=\"resultado.php\" method=\"post\" name=\"form1\" id=\"form1\"&gt;\n    &lt;th scope=\"col\"&gt;&lt;label for=\"busqueda\"&gt;&lt;/label&gt;\n    &lt;input type=\"text\" name=\"buscar\" id=\"buscar\" width=\"auto\" placeholder=\"Buscar...\" height=\"auto\" /&gt;\n  &lt;/th&gt;\n  &lt;th scope=\"col\" align=\"center\" valign=\"top\"&gt;&lt;input type=\"submit\" name=\"ACTION\" class=\"button1\" value=\"Buscar\"&gt;&lt;/th&gt;\n&lt;/tr&gt;&lt;/form&gt;\n</code></pre>\n\n<p>Button function</p>\n\n<pre><code> if (@$_POST['ACTION']=='Buscar'){ \n $buscar = $_POST['buscar'];\n $query = \"SELECT * FROM Medios_table WHERE concat(id,UPPER(Id_Nombre),UPPER(Pais),UPPER(Estado),UPPER(Ciudad),UPPER(website),UPPER(Url),UPPER(Url2),UPPER(InfAnex) COLLATE uft8_unicode_ci) LIKE UPPER('%$buscar%') ORDER BY Id_Nombre ASC\";\n $busquedaresult = mysql_query($query);}\n</code></pre>\n\n<p>In my table I have several columns that contains words like \"Andalucía\" and \"España\" many times as a result from this query if I type in the search box \"andalucia\" nothing comes up, but if I type \"Andalucía\" now it does show up, if I search \"Espana\" nothing shows up but \"España\" works fine, i cannot make it accent insensitive. my table and column collation is utf8_unicode_ci and my webpage meta looks like this</p>\n\n<pre><code> &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n</code></pre>\n\n<p>I'm using a myPhpAdmin in my website to create or modify my db and it has the mySQL server 5.1.1</p>\n"},{"tags":["mysql","sql","query","select"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13144230,"title":"Divisioning of results of two select SQL-statements","body":"<p>So this is my problem:</p>\n\n<p>I have 2 different sql select queries, which both return me a value (1425000 and 2850000)\nWhat i want to do now is the following:</p>\n\n<pre><code>Select (query1 / query 2)\nfrom xxxxx\nwhere xxxx;\n</code></pre>\n\n<p>But query 1 and query 2 are quiet complicated queries, having count and sum functions in it.</p>\n\n<p>How can I solve this?</p>\n"},{"tags":["sql","tsql","sql-server-2008-r2","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13145321,"title":"Using a script to update all columns in a table","body":"<p>The other day I asked a similar question relating to column titles. Now I'm wandering how something like </p>\n\n<pre><code>update table1\nset column1=REPLACE(column1, '\"','')\n\nupdate table2\nset column2=REPLACE(column2, '\"','')\n\nupdate table3\nset column3=REPLACE(column2, '\"','')\n</code></pre>\n\n<p>might be achieved. I'm sure this will be something involving <code>sys.objects</code> or <code>information_schema.columns</code> something along those lines (whatever the green keywords in SSMS are called).  </p>\n\n<p>Would this have to be done with a cursor?</p>\n"},{"tags":["sql","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13145028,"title":"NCHAR(916) in sql String","body":"<p>I need to put the nchar character Δ in a string like this:</p>\n\n<pre><code>SET @ANALISE1 =\n\n 'SELECT \n  * \n  FROM \n  (\n    SELECT \n    ''*'' Codigo,\n    ''Total'' Descricao,\n    SUM(#DADOS_VISTA_PRODUTO.[Mês||Volume]) [Mês||'+@MESATUAL+'Ton],\n    SUM(#DADOS_VISTA_PRODUTO.[Mês||Mês Anterior Volume]) [Mês||'+ @MESANTERIOR +' Ton],\n    (((SUM(#DADOS_VISTA_PRODUTO.[Mês||Volume])/SUM(#DADOS_VISTA_PRODUTO.[Mês||Mês Anterior Volume])) -1) * 100)\n    [Mês||'+ **NCHAR(916)**+'%A]\n  '\n\nEXEC (@ANALISE1)\n</code></pre>\n\n<p>but it appears as a question mark.\nAnyone know why?</p>\n"},{"tags":["mysql","sql","query","phpmyadmin","sql-update"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140582,"title":"MySQL update query does not work #1064","body":"<p>Can anyone tell me what is wrong with this Query ?</p>\n\n<pre><code>UPDATE\n    violetta.navi__stop\nSET\n    violetta.navi__stop.endHour = VB.endHour\nFROM\n    violetta.navi__stop AS V\nINNER JOIN\n    violetta_back.navi__stop AS VB\nON V.code = VB.code\n</code></pre>\n\n<p>This code sample works for me on my database:</p>\n\n<pre><code>SELECT\nV.code, V.endHour\nFROM\n    violetta.navi__stop AS V\nUNIQUE\n    violetta_back.navi__stop AS VB\nON V.code = VB.code\n</code></pre>\n"},{"tags":["php","mysql","sql","database-design"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13140095,"title":"update database with new info but keep old info aswell","body":"<p>How do you update a database with new info but keep old info aswell?</p>\n\n<p>My aim is to have a favorites button that when clicked it will add the item id to a members favorites list so they could call something like fav.php?fav=janedoe and their favorites list be listed.</p>\n\n<p>I know how to add the button and get the item id from database I just really need the mysql query I would run to update aswell as what the \"type\" would be when creating the database column I think. </p>\n\n<p>info inside the row would then look like this</p>\n\n<p><code>1,12,14,15,34,46,74</code></p>\n\n<p>then if member wanted to add item 98 it would update to</p>\n\n<p><code>1,12,14,15,34,46,74,98</code></p>\n\n<p>adding 98 to the end.</p>\n\n<p>I realise this is kind of a \"can you do this for me\" post, but I just haven't a clue where to start.</p>\n"},{"tags":["mysql","sql","sql-update"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13134282,"title":"Update mysql rows with value extracted from counting another table","body":"<p>I have the following query:</p>\n\n<pre><code>SELECT int_intrebari.id, COUNT( id_raspuns ) AS nr_raspunsuri\nFROM int_intrebari, int_raspunsuri\nWHERE int_intrebari.id = int_raspunsuri.id\nGROUP BY id\n</code></pre>\n\n<p>Is it possible to update first table with nr_raspunsuri from the query, without writing a foreach statement?</p>\n"},{"tags":["php","sql","file","upload","fopen"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":27,"score":-3,"question_id":13145227,"title":"Setting local text file contents to variable in PHP","body":"<p>Without uploading (permanently) to server. Is what's the best way to do this, if possible at all? Can I fopen() the $_FILES <em>temporary</em> server location?</p>\n\n<p>I have a bunch of bar delimited text files I need to break up and stick into an sql table. I'd like to be able to write a script to do this for me.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":51,"score":-5,"question_id":13145051,"title":"t sql union vs join order (efficiency)","body":"<p>I have a relatively simple question.</p>\n\n<p>I have dataset A and dataset B, both identical in structure.</p>\n\n<p>The end result is going to be a union all of dataset A and dataset B, we'll call it dataset C.</p>\n\n<p>But before the final version, the end dataset needs to be filtered by joining on dataset X.</p>\n\n<p>The question is should I join dataset A on dataset X, join dataset B on dataset X, and THEN union ALL A and B, or should I UNION ALL A and B into C, then join C on X.</p>\n\n<p>What is faster, more memory efficient, etc?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","sql-server","inner-join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13145275,"title":"Where clause versus inner join statement checks, are they the same?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1018952/condition-within-join-or-where\">Condition within JOIN or WHERE</a>  </p>\n</blockquote>\n\n\n\n<p>Are the below 2 queries the same?</p>\n\n<pre><code>SELECT u.*\nFROM User u\n    INNER JOIN Sales s ON (u.userId = s.userId)\nWHERE\nu.active = 1 AND\ns.amount &gt; 0 AND\ns.status = 1 \n</code></pre>\n\n<p>versus:</p>\n\n<pre><code>SELECT u.*\nFROM User u\n    INNER JOIN Sales s ON \n        (u.userId = s.userId AND s.amount &gt; 0 and s.status=1)\nWHERE\nu.active = 1\n</code></pre>\n\n<p>Are these 2 queries the same in terms of result set always?\nPerformance considerations?</p>\n"},{"tags":["c#","sql","sql-server-2008","smo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13144755,"title":"How to enable/disable/get status of extendedProtection for Authentication in SQL Server 2008 using C#?","body":"<p>I need to :</p>\n\n<ol>\n<li>Get the status of <a href=\"http://msdn.microsoft.com/en-us/library/ff487261%28v=sql.105%29.aspx\" rel=\"nofollow\">Extended protection for Authentication</a></li>\n<li>Enable Extended Protection</li>\n<li>Disable Extended Protection </li>\n</ol>\n\n<p>in <strong>SQL Server 2008 and 2008 R2</strong> preferably using SQl Server Management Objects (SMO) API using C#.</p>\n\n<p>Can someone point me to the relevant resource that can help me accomplish the above goals?</p>\n\n<p>A non-SMO approach is also welcome. However, an approach that does not involve SQL queries, and uses C# is highly desired.</p>\n"},{"tags":["mysql","sql","time"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":549,"score":3,"question_id":5120402,"title":"how to get load time in milliseconds or microseconds in mysql","body":"<p>I' ve searched and searched, but I wasn't able to find an easy way to get this:</p>\n\n<pre><code>Query OK, 50000 rows affected (0.35 sec) \n</code></pre>\n\n<p>in milliseconds or microseconds.</p>\n\n<p>How can I achieve it?</p>\n"},{"tags":["php","mysql","sql","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13145078,"title":"Best way of caching sorted data in PHP/MySQL","body":"<p>Assume we have an application which present continuous data to user. E.g. blog - we present list of blog entries and this list is divided into pages - so we end up with /page1, /page2 etc.</p>\n\n<p>The first page is obviously requested most often, but the higher number of page the less often it is requested.</p>\n\n<p>If we implement cache for our app we have two choices:</p>\n\n<ul>\n<li><p>update cache of every page after every new entry</p></li>\n<li><p>when a page is requested PHP is looking for cached version; if it exists it is returned, otherwise the cache is created with expiration date set to, let's say, an hour</p></li>\n</ul>\n\n<p>First solution seems like a really waste of resources to me. The second one creates possibility of dangerous scenario:</p>\n\n<p>What happends if user requests for pages x and then (x+1), where page x is cached and page (x+1) is not? If cache for page x is outdated then on page (x+1) user'll see the same content. Or worse, what if user go from x page to (x-1) page? He'll miss some entries!</p>\n\n<p>How to implement caching to avoid this problem?</p>\n"},{"tags":["php","mysql","sql","database","phpmyadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":43,"score":1,"question_id":13145006,"title":"SQL Query for Find and Replace is not working","body":"<p>i want to run a find and replace query in my sql database using php my admin. The problem is that in the text that i want to find and replace are some \" characters and this causes problems when i run the command...</p>\n\n<p>i want to search for <code>align=\"right\"&gt;</code> and replace it by <code>align=\"left\"&gt;</code></p>\n\n<p>i did run this command but its not working:</p>\n\n<pre><code>UPDATE `ps_product_lang` SET `description` = replace(`description`,\"align=\"right\"&gt;\",\"align=\"left\"&gt;\");\n</code></pre>\n\n<p>So im wondering how should this query look like as there are \" characters? How is it possible to search for even much longer text and replace it using sql queries?</p>\n\n<p>many thanks</p>\n"},{"tags":["sql","oracle","application","informix","denormalization"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":342,"score":2,"question_id":3057990,"title":"Should I denormalize Loans, Purchases and Sales tables into one table?","body":"<p>Based on the information I have provided below, can you give me your opinion on whether its a good idea to denormalize separate tables into one table which holds different types of contracts?.. What are the pro's/con's?.. Has anyone attempted this before?.. Banking systems use a CIF (Customer Information File) [master] where customers may have different types of accounts, CD's, mortgages, etc. and use transaction codes[types] but do they store them in one table?</p>\n\n<p>I have separate tables for Loans, Purchases &amp; Sales transactions. Rows from each of these tables are joined to their corresponding customer in the following manner: </p>\n\n<pre><code>customer.pk_id SERIAL = loan.fk_id      INTEGER; \n                      = purchase.fk_id  INTEGER; \n                      = sale.fk_id      INTEGER;  \n</code></pre>\n\n<p>Since there are so many common properties among these tables, which revolves around the same merchandise being: pawned, bought and sold, I experimented by consolidating them into one table called \"Contracts\" and added the following column:</p>\n\n<pre><code>Contracts.Type char(1) {L=Loan, P=Purchase, S=Sale}\n</code></pre>\n\n<p>Scenario:</p>\n\n<p>A customer initially pawns merchandise, makes a couple of interest payments, then decides he wants to sell the merchandise to the pawnshop, who then places merchandise in Inventory and eventually sells it to another customer. </p>\n\n<p>I designed a generic table where for example:</p>\n\n<pre><code>Contracts.Capital DECIMAL(7,2) \n</code></pre>\n\n<p>in a loan contract it holds the pawn principal amount, in a purchase holds the purchase price, in a sale holds sale price.</p>\n\n<p>Is this design a good idea or should I keep them separate?</p>\n"},{"tags":["sql","sql-server"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13144820,"title":"SQL Error: The parameterized query..expects the parameter","body":"<p>I was having issues converting a log file section to a SQL <code>DateTime</code> and found a better solution was to have my date field generated by the database instead of code (using <code>GETDATE()</code>). </p>\n\n<p>I removed the date field from my insert but now I get this error:</p>\n\n<blockquote>\n  <p>Error: The parameterized query '(@station int, @indoor_temp float, @outdoor_temp float, @dewpoint f' expects the parameter '@wind_direction_text', which was not supplied.</p>\n</blockquote>\n\n<p>That value it complains about is supplied, and what's stranger the insert still succeeds and the database record is inserted!</p>\n\n<p>I'd like to figure out why I'm getting these exceptions though!</p>\n\n<p>Here's my code:</p>\n\n<pre><code>var dataCommand = new SqlCommand();\ndataCommand.Connection = dataConnection;\n\ndataCommand.Parameters.AddWithValue(\"@station\", _stationId);\ndataCommand.Parameters.AddWithValue(\"@indoor_temp\", _indoorTemp);\ndataCommand.Parameters.AddWithValue(\"@outdoor_temp\", _outdoorTemp);\ndataCommand.Parameters.AddWithValue(\"@dewpoint\", _dewPoint);\ndataCommand.Parameters.AddWithValue(\"@rel_humidity_indoor\", _relHumidityIndoor);\ndataCommand.Parameters.AddWithValue(\"@rel_humidity_outdoor\", _relHumidityOutdoor);\ndataCommand.Parameters.AddWithValue(\"@wind_speed\", _windSpeed);\ndataCommand.Parameters.AddWithValue(\"@wind_direction_degrees\", _windDirectionDegrees);\ndataCommand.Parameters.AddWithValue(\"@wind_direction_text\", _windDirectionText);\ndataCommand.Parameters.AddWithValue(\"@wind_chill\", _windChill);\ndataCommand.Parameters.AddWithValue(\"@rain1h\", _rain1H);\ndataCommand.Parameters.AddWithValue(\"@rain24h\", _rain24H);\ndataCommand.Parameters.AddWithValue(\"@rain_total\", _totalRain);\ndataCommand.Parameters.AddWithValue(\"@relative_pressure\", _relativePressure);\ndataCommand.Parameters.AddWithValue(\"@tendency\", _tendency);\ndataCommand.Parameters.AddWithValue(\"@forecast\", _forecast);\n\ndataCommand.CommandType = CommandType.Text;\ndataCommand.CommandText =\n                         \"INSERT INTO\"\n                         + \" dbo.WeatherData(station_id, indoor_temp, outdoor_temp, dewpoint,\" +\n                            \"rel_humidity_indoor, rel_humidity_outdoor, wind_speed, wind_direction_degrees,\" +\n                            \"wind_direction_text, wind_chill, rain1h, rain24h, rain_total, relative_pressure,\" +\n                            \"tendency, forecast)\"\n                            + \"VALUES \" +\n                            \"(@station, @indoor_temp, @outdoor_temp, @dewpoint, @rel_humidity_indoor,\" +\n                            \"@rel_humidity_outdoor, @wind_speed, @wind_direction_degrees,\" +\n                            \"@wind_direction_text, @wind_chill, @rain1h, @rain24h, @rain_total,\" +\n                            \"@relative_pressure, @tendency, @forecast)\";\n\n// execute the insert command\ndataCommand.ExecuteNonQuery();\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["sql","performance","sqlite","optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13143725,"title":"SQLite: speedup SQL statement with COUNT and GROUP BY","body":"<p>I am working with a table with a \"state\" column, which typically holds only 2 or 3 different values. Sometimes, when this table holds several million rows, following SQL statement becomes slow (I assume a full table scan is done):</p>\n\n<pre><code>SELECT state, count(*) FROM mytable GROUP BY state\n</code></pre>\n\n<p>I expect to get something like this:</p>\n\n<pre><code>disabled |  500000\nenabled  | 2000000\n</code></pre>\n\n<p>(basically I want to know how many items are \"enabled\" and how many items are \"disabled\" - actually that's a number instead of a text in my real application)</p>\n\n<p>I guess adding an index for my state column is pretty useless, since only very few different values can be found there. What other options do I have?</p>\n\n<p>There is also a \"timestamp\" column (with an index). Ideally the solution should also work well if I add:</p>\n\n<pre><code>WHERE timestamp BETWEEN x AND y\n</code></pre>\n\n<p>Right now I'm using an SQLite3 database, but it looks like other database engines are not too different, so solutions for other DB engines might be interesting as well.</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","sql-server","database","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13142433,"title":"Tables for recursive hierarchial data in SQL","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1757260/simplest-way-to-do-a-recursive-self-join-in-sql-server\">Simplest way to do a recursive self-join in SQL Server?</a>  </p>\n</blockquote>\n\n\n\n<p>I have to create a table in SQL that will comprise of groups of items/products. Each new group made will be made under one of the <strong>pre-defined</strong> groups or the groups previously formed. I want to keep all this data in a SQL Table. So far, I have though of creating a table like this:</p>\n\n<ul>\n<li>Group ID</li>\n<li>Group Name</li>\n<li>Group Under (This will store the ID of the group under which this group is from</li>\n</ul>\n\n<p>But this can only refer to just the next level, how will I get to know who is the super-parent of this group.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>I have groups <code>A, B, C</code>. </li>\n<li><code>A</code> has further subgroups <code>A1, A2, A3</code>. </li>\n<li><code>A1</code> has further subgroups, <code>A11, A12, A13</code>. </li>\n</ul>\n\n<p>I will I have the information about super-parent group i.e <code>A</code> from <code>A11</code> or <code>A22</code> or <code>A33</code>? </p>\n\n<p>Let me know if the problem is not clear..</p>\n"},{"tags":["sql","sql-server","sql-server-2000","parameter-sniffing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13144556,"title":"How can I cure parameter sniffing on SQL Server 2000?","body":"<p>I am having an issue where an update query with about 70 parameters times-out on occasion. Based on some research, I believe this is due to packet sniffing. I saw that in newer versions of SQL Server, I can use the <code>Option(recompile)</code> clause, but that does not work in my case, since I am using server 2000.</p>\n\n<p>I am using <code>sqlhelper.executeNonQuery</code> and not a stored procedure.</p>\n"},{"tags":["sql","query","select","join","left-join"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":6,"view_count":42,"score":-6,"question_id":13144251,"title":"query has to many joins","body":"<p>I have this query and works fine. I want to know another way of doing this ?</p>\n\n<pre><code>SELECT  UP.PHYS_RESR_ID,  UP.EQMT_INIT,  UP.EQMT_NBR,  UP.PRIM_OWN_INIT, UP.AAR_CAR_TYPE,  UP.AAR_CAR_CODE ,UP.AAR_END_DOOR_TYPE, UP.TOTL_AXLE_CNT,  UP.LAST_UPTD_DT,  UP.LAST_UPTD_USER_ID,   \n     EXTHGT.DIMN_VALU as EXTHGT , EXTHGT.UOM_CODE   as UNIT_EXTHGT  \n   , EXTWD.DIMN_VALU as EXTWD , EXTWD.UOM_CODE   as UNIT_EXTWD  \n   , INHGT.DIMN_VALU as INHGT , INHGT.UOM_CODE   as UNIT_INHGT  \n   , INLGTH.DIMN_VALU as INLGTH , INLGTH.UOM_CODE   as UNIT_INLGTH  \n   , INWDTH.DIMN_VALU as INWDTH , INWDTH.UOM_CODE   as UNIT_INWDTH  \n   , OUTLGT.DIMN_VALU as OUTLGT , OUTLGT.UOM_CODE   as UNIT_OUTLGT  \n   , SDHGT.DIMN_VALU as SDHGT , SDHGT.UOM_CODE   as UNIT_SDHGT  \n   , SDWDTH.DIMN_VALU as SDWDTH , SDWDTH.UOM_CODE   as UNIT_SDWDTH \n\n   FROM EQU_EQMT UPE \n\n  left join EQU_EQMT_DIMN EXTHGT on EXTHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID and EXTHGT.DIMN_TYPE = 'EXTHGT' and   ( EXTHGT.POS_DESC is null      or  EXTHGT.POS_DESC =  'VALU'      or  EXTHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN EXTWD on  EXTWD.PHYS_RESR_ID = UP.PHYS_RESR_ID   and EXTWD.DIMN_TYPE =  'EXTWD'      and   ( EXTWD.POS_DESC is null      or  EXTWD.POS_DESC =  'VALU'      or  EXTWD.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INHGT on  INHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INHGT.DIMN_TYPE =  'INHGT'      and   ( INHGT.POS_DESC is null      or  INHGT.POS_DESC =  'VALU'      or  INHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INLGTH on  INLGTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INLGTH.DIMN_TYPE =  'INLGTH'      and   ( INLGTH.POS_DESC is null      or  INLGTH.POS_DESC =  'VALU'      or  INLGTH.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN INWDTH on  INWDTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and INWDTH.DIMN_TYPE =  'INWDTH'      and   ( INWDTH.POS_DESC is null      or  INWDTH.POS_DESC =  'VALU'      or  INWDTH.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN OUTLGT on  OUTLGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and OUTLGT.DIMN_TYPE =  'OUTLGT'      and   ( OUTLGT.POS_DESC is null      or  OUTLGT.POS_DESC =  'VALU'      or  OUTLGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN SDHGT on  SDHGT.PHYS_RESR_ID = UP.PHYS_RESR_ID   and SDHGT.DIMN_TYPE =  'SDHGT'      and   ( SDHGT.POS_DESC is null      or  SDHGT.POS_DESC =  'VALU'      or  SDHGT.POS_DESC =  'valu'           ) \n\n  left join EQU_EQMT_DIMN SDWDTH on  SDWDTH.PHYS_RESR_ID = UP.PHYS_RESR_ID   and SDWDTH.DIMN_TYPE =  'SDWDTH'      and   ( SDWDTH.POS_DESC is null      or  SDWDTH.POS_DESC =  'VALU'      or  SDWDTH.POS_DESC =  'valu'           );\n</code></pre>\n\n<p>I WANT TO DO A NEW QUERY THAT GIVES ME THE SAME INFO ANY ADVICES ?</p>\n"},{"tags":["sql","insert","identity","sql-server-2012","output"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13144295,"title":"How to get the identity values of records that were newly inserted or already existing?","body":"<p>I have the following SQL so far...</p>\n\n<pre><code>-- SETUP MY SQL\nDECLARE @NewUsers    TABLE (Username VARCHAR(32), Name VARCHAR(32))\nDECLARE @UserResults TABLE (UserName VARCHAR(32), UserId INT)\n\nINSERT INTO @NewUsers (Username, Name)\nVALUES ('johndoe', 'John Doe'),\n       ('janedoe', 'Jane Doe'),\n       ('mrsmith', 'Mr Smith') -- This guy already exists in the DB though...\n\n-- INSERT STATEMENT\n\nINSERT INTO User (Username, Name)\n    SELECT new.Username, new.Name\n    FROM @NewUsers new\n    WHERE NOT EXISTS (SELECT 1 FROM dbo.User WHERE User.Username = new.Username)\n</code></pre>\n\n<hr>\n\n<p>What I want to do is get the resulting <code>@@IDENTITY</code> values to use in another insert statement later on in my SQL, but I want to get <b>ALL</b> of the identities, including the user that already existed and was not inserted. I know I can always do another select statement afterwards, but I'm not sure that that is the best way?</p>\n\n<pre><code>INSERT INTO @UserResults (UserResults, UserId)\n    SELECT Username, UserId\n    FROM User\n    INNER JOIN @NewUsers new ON new.Username = User.Username\n</code></pre>\n\n<p>I think there is a more efficient way to populate the Results table with all the identities (newly inserted and/or existing) using the <code>OUTPUT</code> clause, but I'm not sure... is there a better way than the way I'm doing?</p>\n"},{"tags":["sql","performance","oracle","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13141970,"title":"Performance of query with OR condition between join tables","body":"<p>There are two tables, tparent and tchild, which are created using script #1.\nIt's need to query all the information from the two tables where uname is equal to 'sky'.\nThe following query statement #2 is fast when there are only a few of records.\nBut it will become very slowly when inserting a huge number of records using the following script #3.\nI think it's caused by the OR condition between tables and the index will be unusefull for querying. \nSo I got a fast solution that changing the statement to three sub ones and union result, like #4.\nI want to konw is there a better solution? what's it? </p>\n\n<p>Thanks!</p>\n\n<p><strong># 1</strong></p>\n\n<pre><code>drop table tparent;\ndrop table tchild;\ncreate table tparent(typeid int,sno number,uname varchar2(50) );\ncreate table tchild(typeid int,sno number,seqno int,uname varchar2(50));\ncreate unique index uidx_tparent_typeidsno on tparent(typeid,sno);\ncreate unique index uidx_tchild_typeidsnoseqno on tchild(typeid,sno,seqno);\ncreate index idx_tparent_name on tparent(uname);\ncreate index idx_tchild_name on tchild(uname);\n\ninsert into tparent values (1,10,'lily');\ninsert into tparent values (1,11,'eric');\ninsert into tparent values (2,10,'tom');\ninsert into tparent values (2,11,'eric');\ninsert into tparent values (3,10,'sky');\n\ninsert into tchild values (1,10,1,'sam');\ninsert into tchild values (1,10,2,'sky');\ninsert into tchild values (1,11,1,'eric');\ninsert into tchild values (1,11,2,'john');\ninsert into tchild values (2,10,1,'sky');\ninsert into tchild values (2,11,1,'eric');\ninsert into tchild values (3,10,1,'tony');\n</code></pre>\n\n<p><strong># 2</strong></p>\n\n<pre><code>select p.typeid,p.sno,p.uname,c1.uname as uname1,c2.uname as uname2 from tparent p\n  left join tchild c1 on c1.typeid=p.typeid and c1.sno = p.sno and c1.seqno=1\n  left join tchild c2 on c2.typeid=p.typeid and c2.sno = p.sno and c2.seqno=2\nwhere (p.uname='sky' or c1.uname='sky' or c2.uname='sky');\n</code></pre>\n\n<p><strong># 3</strong></p>\n\n<pre><code>BEGIN\n    FOR x IN 1..10\n    LOOP\n        BEGIN\n            FOR y IN 10000..100000\n            LOOP\n                BEGIN\n                    insert into tparent values (x,y,'name'|| y);\n                    insert into tchild values (x,y,1,'name'|| y);\n                    insert into tchild values (x,y,2,'name'|| y);\n                END;\n            END LOOP;\n            COMMIT;\n        END;\n    END LOOP;\nEND;\n</code></pre>\n\n<p><strong>#4</strong></p>\n\n<pre><code>select typeid,sno,max(uname),max(uname1),max(uname2) from (\n\nselect p.typeid,p.sno,p.uname,c1.uname as uname1,c2.uname as uname2 from tparent p\n  left join tchild c1 on c1.typeid=p.typeid and c1.sno = p.sno and c1.seqno=1\n  left join tchild c2 on c2.typeid=p.typeid and c2.sno = p.sno and c2.seqno=2\nwhere (p.uname='sky' )\nunion \nselect p.typeid,p.sno,p.uname,c1.uname as uname1,c2.uname as uname2 from tparent p\n  left join tchild c1 on c1.typeid=p.typeid and c1.sno = p.sno and c1.seqno=1\n  left join tchild c2 on c2.typeid=p.typeid and c2.sno = p.sno and c2.seqno=2\nwhere ( c1.uname='sky' )\nunion\n\nselect p.typeid,p.sno,p.uname,c1.uname as uname1,c2.uname as uname2 from tparent p\n  left join tchild c1 on c1.typeid=p.typeid and c1.sno = p.sno and c1.seqno=1\n  left join tchild c2 on c2.typeid=p.typeid and c2.sno = p.sno and c2.seqno=2\nwhere ( c2.uname='sky')\n) tb group by typeid,sno\norder by typeid,sno\n;\n</code></pre>\n"},{"tags":["javascript","sql","web-services","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13142831,"title":"Using ordinary JavaScript/Ajax, how can you access rows and columns in a Sql DataTable object returned by a VB.Net web service?","body":"<p>Let's say you have a VB.Net web method with the following prototype:</p>\n\n<pre><code>Public Function HelloWorld() As DataTable\n</code></pre>\n\n<p>Let's say you have that returned to you in ordinary JavaScript/Ajax.  How would you get individual rows out of it, and how would you get individual fields out of those rows (at least assuming it comes from an SQL query - I'm not sure if it makes a difference)?  I'm not casting it into any particular type before it gets passed to the success function.  To illustrate what I'm talking about, it would be kind of like doing this in AS3:</p>\n\n<pre><code>for each (var table:Object in pEvent.result.Tables) {\n    for each (var row:Object in table.Rows) {\n        ac.addItem(row[\"id\"]);\n    }\n}\n</code></pre>\n\n<p>except that I'm not necessarily looking to loop through them like that - I just want some way to get the information out of them.  Thanks!</p>\n\n<p>EDIT: For example, say you have the following function in a VB.Net web service:</p>\n\n<pre><code>&lt;WebMethod()&gt; _\nPublic Function Test() As DataTable\n    Return DBA.OneTimeQuery(\"SELECT id FROM visits WHERE id = 13\")\n    // returns a one-row, one-column DataTable with the id field being set to 13\nEnd Function\n</code></pre>\n\n<p>How would you be able to get 13 out of it once it gets into the JavaScript that's calling the web method?  Everything I try just says \"[object]\".</p>\n"},{"tags":["sql","database","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13143979,"title":"using excel 2007 to acess external sql database TO import>edit>export table","body":"<p>Is there a way or guide to connect to remote sql server were you can import>modify>export table in excel that uses the excel interface or something similar? Without having to log into the server directly. (multiple domains on one server I don't want them to access)<br></p>\n\n<p>using the sql button in the data tab lets you import and edit the file but only lets you export to a new table(go figure)<br>\n<a href=\"http://i47.tinypic.com/e6qgdj.jpg\" rel=\"nofollow\">http://i47.tinypic.com/e6qgdj.jpg</a><br></p>\n\n<p>using mysql workbench is way to confusing for the user<br>\n<a href=\"http://i45.tinypic.com/2z4fh1f.jpg\" rel=\"nofollow\">http://i45.tinypic.com/2z4fh1f.jpg</a><br></p>\n\n<p>I simply want the user to:<br>\n1. import the table into excel from external database.<br>\n2. edit database in excel.<br>\n3. export back into database overwriting old file.<br>\n<a href=\"http://i48.tinypic.com/2lm7zi1.jpg\" rel=\"nofollow\">http://i48.tinypic.com/2lm7zi1.jpg</a><br></p>\n\n<p>The only method I can't get to work is this one. Im assuming its the one I want too.<br>\n<a href=\"http://i49.tinypic.com/bdjw51.jpg\" rel=\"nofollow\">http://i49.tinypic.com/bdjw51.jpg</a><br></p>\n"},{"tags":["android","sql","database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":35,"score":-4,"question_id":13144357,"title":"android - application using online database - tutorial","body":"<p>I want to develop and app that uses a login with a username and then receives/updates items from an online database.</p>\n\n<p>I already read for example that i can use: Android-PHP-MySQL. (Or is there another simple free way?)</p>\n\n<p>The tutorials i found online are either not complete or are not in android language.</p>\n\n<p>Can someone please direct me to a full tutorial ?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13143883,"title":"Date Specific Criteria for Query","body":"<p>I have a query that is gathering data from the 20th of last month to the 19th of this month and it seems to be working.</p>\n\n<pre><code>(DateTime &gt;= 19+dateadd(mm,datediff(mm,0,getdate())-1,0)   \nAND  DateTime &lt;  18+dateadd(mm,datediff(mm,0,getdate()),0)) \n</code></pre>\n\n<p>I now need to somehow modify it to meet the following...</p>\n\n<p>Always show the current report no matter when it is run.</p>\n\n<p>Currently what happens is.....it works great if run anytime between the 20th of last month and the 19th of this month.....but as soon as it hits the 20th of this month through the 31th of this month....it keeps showing the last period....which technically i am asking it to do.</p>\n\n<p>What I need is.....When it becomes the 20th of this month....it starts a new report.</p>\n\n<p>As I said.....the problem period is between the 20th and the end of the month.  Once the new month starts....everything is fine.</p>\n\n<p>It somehow has to take into account when the report is being run.</p>\n\n<p>Thanks.</p>\n\n<p>Dave</p>\n"},{"tags":["mysql","sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13143705,"title":"SELECT INTO multiple @variables MySQL","body":"<p>I wish to store the result of a <code>SELECT</code> statment into multiple variables.</p>\n\n<p>I know that the result of this query will always return <code>6 ints</code> from 6 different rows.</p>\n\n<p>I have tried using the following code :</p>\n\n<pre><code>SELECT id INTO @photo1, @photo2, @photo3, @photo4, @photo5, @photo6 \nFROM album WHERE uploaded = @time AND scene_id = NEW.id;\n</code></pre>\n\n<p><code>album</code> is a table.\n<code>uploaded</code> is a field in <code>album</code>.\n<code>scene_id</code> is a field in <code>album</code>.\n<code>id</code> is the <code>PRIMARY_KEY</code> of <code>album</code>.</p>\n\n<p>I have read that the number of variables must equal the number of fields. Which is obviously not the case in the above statement. </p>\n\n<p>With this in mind, how would I overcome this problem?</p>\n\n<p>This code is being used within a MySQL Trigger.</p>\n\n<p>EDIT : Relevant Table schema as per request :</p>\n\n<pre><code>person   -- name of table   \nid | approved -- id is PK\n\nalbum   -- name of table\nid | uploaded | scene_id  -- id is PK\n</code></pre>\n\n<p>Trigger is fired on change of <code>approved</code> from 0 to 1</p>\n"},{"tags":["sql","fat-free-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13109321,"title":"F3 Framework Replace String in an array","body":"<p>I'm using the F3 Framwork and need a possibility to replace a value in an array.</p>\n\n<pre><code>$car=new Axon('cars');\n$list=$car-&gt;afind();\n</code></pre>\n\n<p>So I define my array named \"list\" which has a field \"producer_id\".\nBut how can I change the value for the field in this array?\nIdea: This array gives me a list of all cars in my cars database. Every car has a producer_id. Prodrucer is a own table in my database with fields like producer_id and producer_name. By a SQL query on this table I want to get the producers_name and insert it into a array.</p>\n"},{"tags":["asp.net","sql","stored-procedures","godaddy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13142403,"title":"ASP.NET Role and Member Management","body":"<p>I am using the built in role and membership management tool for asp.net on my website. I am currently in the process of upgrading the abilities of the site so that the site admin can add/delete roles, and manage the access of the different roles from inside a page on the site. However, when I execute</p>\n\n<pre><code>System.Web.Security.Roles.CreateRole(roleName); //Where roleName is a string value of the role that I am creating, and it is not a duplicate name.\n</code></pre>\n\n<p>I get the error message </p>\n\n<pre><code>System.Data.SqlClient.SqlException: Conversion failed when converting from a character string to uniqueidentifier.\n</code></pre>\n\n<p>The site is running on GoDaddy and I am using the ASP.NET tables, triggers, and stored procedures that GoDaddy provides. What is odd is that I have had no trouble updating users to roles, creating users, deleting users, resetting passwords, etc. using the built in methods. Is it possible that the stored procedure that the system created for me was in some way flawed and is not returning all of the data that it needs to execute? If not, then what else could be the cause of the issue? \nAny help is greatly appreciated.</p>\n"},{"tags":["php","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13143965,"title":"PHP Export Date range","body":"<p>I have a working database export to xls but I need it to export a particular date range based on the 'closed' date. (See code below).</p>\n\n<p>For example, I'd like it to export all 'closed' dates for last month and/or this month (Range: Sept 1, 2012 to Sept 30, 2012  or  Oct 1, 2012 to Oct 31, 2012)</p>\n\n<pre><code>&lt;?PHP\n\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"ost_helpdesk\";                //your MySQL Database Name\n$DB_TBLName = \"ost_ticket\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select ticketID, name, company, subject, closed from $DB_TBLName ORDER BY closed DESC\";\n\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"MDT Database Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n\n     }\n}\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13143930,"title":"Checking Specific Row's Value and Merge Values","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/194852/concatenate-many-rows-into-a-single-text-string\">Concatenate many rows into a single text string?</a><br>\n  <a href=\"http://stackoverflow.com/questions/10298805/mimic-group-concat-combined-with-group\">Mimic group_concat() combined with group</a>  </p>\n</blockquote>\n\n\n\n<p>this is the source table that I am currently working on:</p>\n\n<p><img src=\"http://i.stack.imgur.com/HSSbF.png\" alt=\"enter image description here\"></p>\n\n<p>And this is the desired output:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xcnAB.png\" alt=\"enter image description here\"></p>\n\n<p>Can I achieve this by simple MSSQL query? Like just using <strong>GROUP BY or JOIN?</strong></p>\n"},{"tags":["sql","query","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13143892,"title":"Is it really a good choice to transform every SQL query to functions call?","body":"<p>I would like to know if using functions call for most of SQL select in a software is a good idea ?</p>\n\n<p>Here are the pro argument that I found :</p>\n\n<ul>\n<li><p>faster, the sql engine already have the functions, and don't have to parse every query</p></li>\n<li><p>less data is transfered between the application and the sql engine</p></li>\n<li><p>better abstraction, as the application doesn't know about database implementation</p></li>\n<li><p>much bigger security, as the functions call are designed by a DBA</p></li>\n</ul>\n\n<p>I really don't like the idea of replacing most of my queries by functions call.</p>\n\n<p>I am wrong ? or is it really a great 'idea' ?</p>\n"},{"tags":["c#","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13141896,"title":"Sql Connection Catalog changes after statement","body":"<p>Issue:</p>\n\n<p>After running an Sql command with SqlCommand() on a database that then inserts data into another database, all following statements error with ExceptionInvalid object name.</p>\n\n<p>Question:</p>\n\n<p>Why is this happening?</p>\n\n<p>Additional Information:</p>\n\n<p>I know how to fix it by adding The Temp database name before the table on the select portion but since it is being run in the context of that database that shouldn't be necessary and is not when I run the statements individually in SQL management studio  </p>\n\n<p>Program Logic:</p>\n\n<ol>\n<li>Create and fill temp database (All tables ASI_...)</li>\n<li>In context of temp database select data and then insert it into another database (@AcuDB)</li>\n<li>Repeat Step 2 for X queries</li>\n</ol>\n\n<p>Insertion code:</p>\n\n<pre><code>if (TempD.State == System.Data.ConnectionState.Closed) TempD.Open();\n                            Command = new SqlCommand(temp, TempD);\n                            Command.CommandTimeout = 0;\n                            Command.ExecuteNonQuery(); \n</code></pre>\n\n<p>Sample Sql being run that errors after previous similar statement:</p>\n\n<blockquote>\n  <p>insert into @AcuDB..Batch (CompanyID,BranchID,\n  Module,BatchNbr,CreditTotal,DebitTotal,ControlTotal,CuryCreditTotal,CuryDebitTotal,CuryControlTotal,CuryInfoID,LedgerID,BatchType,Status,AutoReverse,AutoReverseCopy,OrigModule,OrigBatchNbr,DateEntered,Released,Posted,LineCntr,CuryID,ScheduleID,NoteID,CreatedByID,CreatedByScreenID,CreatedDateTime,LastModifiedByID,LastModifiedByScreenID,LastModifiedDateTime,Hold,Description,Scheduled,Voided,FinPeriodID,TranPeriodID)\n  select 2,\n  1,Module,BatchNbr,CreditTotal,DebitTotal,ControlTotal,CuryCreditTotal,CuryDebitTotal,CuryControlTotal,i.CuryInfoID,\n  isnull((select a.LedgerID from @AcuDB..ledger a where a.LedgerCD =\n  b.LedgerID),0)\n  [LedgerID],BatchType,Status,AutoReverse,AutoReverseCopy,OrigModule,OrigBatchNbr,\n  DateEntered\n  [DateEntered],Released,Posted,LineCntr,b.CuryID,ScheduleID,NoteID,\n  'B5344897-037E-4D58-B5C3-1BDFD0F47BF9' [CreatedByID], '00000000'\n  [CreatedByScreenID], GETDATE() [CreatedDateTime],\n  'B5344897-037E-4D58-B5C3-1BDFD0F47BF9' [LastModifiedByID], '00000000'\n  [LastModifiedByScreenID], GETDATE()\n  [LastModifiedDateTime],Hold,Description,Scheduled,Voided,b.FinPeriodID,TranPeriodID\n  from Temp..ASI_GLBatch b inner join @AcuDB..CurrencyInfo i on\n  i.CuryEffDate = b.DateEntered cross join @AcuDB..glsetup g where\n  b.companyID = @CpnyCD and b.branchID = @BranchCD</p>\n</blockquote>\n"},{"tags":["c++","sql","qt","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13143448,"title":"SQLite UPDATE 100ms","body":"<p>I'm using the <a href=\"http://doc.qt.digia.com/qt/qsqlquery.html\" rel=\"nofollow\">Qt database abstraction</a> layer to interface with Sqlite3.</p>\n\n<pre><code>int x = GetTickCount();\ndatabase.exec(\"UPDATE controls SET dtype=32 WHERE id=2\");\nqDebug() &lt;&lt; GetTickCount()-x;\n</code></pre>\n\n<p>The table is:</p>\n\n<pre><code>CREATE TABLE controls (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    internal_id TEXT,\n    name TEXT COLLATE NOCASE,\n    config TEXT,\n    dtype INTEGER,\n    dconfig TEXT,\n    val TEXT,\n    device_id INTEGER REFERENCES devices(id) ON DELETE CASCADE\n); \n</code></pre>\n\n<p>Results in an update time of  ~100 ms! Even though nothing else is accessing the db and there are a grand total of 3 records in that table.</p>\n\n<p>That seems ridiculously long to me. 10 records would already take a second to complete. Is this the performance I should expect from sqlite or is something messing me up somewhere? SELECT queries are fast enough ~1ms.</p>\n\n<p><hr>\n<strong>Edit 1</strong></p>\n\n<p>So it's not Qt.</p>\n\n<pre><code>sqlite3 *db;\nif ( sqlite3_open(\"example.db\",&amp;db ) != SQLITE_OK )\n{\n    qDebug() &lt;&lt; \"Could not open\";\n    return;\n}\n\nint x = GetTickCount();\nsqlite3_exec(db, \"UPDATE controls SET dtype=3 WHERE id=2\",0,0,0);\nqDebug() &lt;&lt; \"Took\" &lt;&lt; GetTickCount() - x;\n\nsqlite3_close(db);\n</code></pre>\n\n<p>This guy takes just the same amount of time.</p>\n"},{"tags":["sql","join"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":61,"score":4,"question_id":13142637,"title":"How to join 3 tables and order by date of all 3?","body":"<p>I have 3 tables,</p>\n\n<p>albums, videos and stories.</p>\n\n<p>All 3 have a date column and each connected with subject_id column.</p>\n\n<p>I want to select all albums, videos and stories of subject_id ordered by date, How can i do that?</p>\n\n<p>Now i have this query :</p>\n\n<pre><code>SELECT albums.*, videos.*, stories.*\nFROM albums\nLEFT JOIN videos\nON videos.subject_id = albums.subject_id\nRIGHT JOIN stories\nON stories.subject_id = albums.subject_id\nORDER BY albums.date\n</code></pre>\n\n<p>Will this do the trick or am i missing something?\nBecause i want the dates not be ordered just by albums, stories could have older enteries then albums and so on.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":176,"score":0,"question_id":9919278,"title":"SQL multiple replace","body":"<p>I want to read the company table and take out all possible suffixes from the name. Here's what I have so far:</p>\n\n<pre><code>declare @badStrings table (item varchar(50))\n\nINSERT INTO @badStrings(item)\nSELECT 'company' UNION ALL\nSELECT 'co.' UNION ALL\nSELECT 'incorporated' UNION ALL\nSELECT 'inc.' UNION ALL\nSELECT 'llc' UNION ALL\nSELECT 'llp' UNION ALL\nSELECT 'ltd'\n\nselect id, (companyname = Replace(name, item, '') FROM @badStrings)\nfrom companies\nwhere name != ''\n</code></pre>\n"}]}
{"total":102599,"page":20,"pagesize":100,"questions":[{"tags":["sql","postgresql","csv","copy","quote"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":12856377,"title":"The correct COPY command to load postgreSQL data from csv file that has single-quoted data?","body":"<p>I have csv file that has contents like this:</p>\n\n<pre><code>10,53073,0,0,'Y','2008-05-30 21:46:55',0,'2008-05-30 21:48:04',0,53071,2\n</code></pre>\n\n<p>I want to load the csv data into my_table. </p>\n\n<pre><code>CREATE TABLE my_table\n(\n  ad_tree_id numeric(10,0) NOT NULL,\n  node_id numeric(10,0) NOT NULL,\n  ad_client_id numeric(10,0) NOT NULL,\n  ad_org_id numeric(10,0) NOT NULL,\n  isactive character(1) NOT NULL DEFAULT 'Y'::bpchar,\n  created timestamp without time zone NOT NULL DEFAULT now(),\n  createdby numeric(10,0) NOT NULL,\n  updated timestamp without time zone NOT NULL DEFAULT now(),\n  updatedby numeric(10,0) NOT NULL,\n  parent_id numeric(10,0),\n  seqno numeric(10,0),\n  CONSTRAINT ad_treenodemm_pkey PRIMARY KEY (ad_tree_id , node_id ),\n  CONSTRAINT adtree_adtreenodemm FOREIGN KEY (ad_tree_id)\n      REFERENCES ad_tree (ad_tree_id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE CASCADE DEFERRABLE INITIALLY DEFERRED,\n  CONSTRAINT ad_treenodemm_isactive_check CHECK (isactive = ANY (ARRAY['Y'::bpchar, 'N'::bpchar]))\n)\n</code></pre>\n\n<p>When I run this command in pgAdmin III tool:</p>\n\n<pre><code>COPY my_table FROM 'c:\\downloads\\file.csv' DELIMITERS ',' CSV;\n</code></pre>\n\n<p>I got error:</p>\n\n<pre><code>ERROR:  value too long for type character(1)\nCONTEXT:  COPY my_table, line 1, column isactive: \"'Y'\"\n</code></pre>\n\n<p>Then I modified the command like this:</p>\n\n<pre><code>COPY my_table FROM 'c:\\downloads\\file.csv' DELIMITERS ',' CSV QUOTE ''';\nCOPY my_table FROM 'c:\\downloads\\file.csv' DELIMITERS ',' CSV QUOTE '\\'';\nCOPY my_table FROM 'c:\\downloads\\file.csv' DELIMITERS ',' CSV QUOTE '\\'' ESCAPE '\\';\nCOPY my_table FROM 'c:\\downloads\\file.csv' DELIMITERS ',' CSV QUOTE '\\'' ESCAPE \\;\n</code></pre>\n\n<p>All failed when tried.</p>\n\n<p>So, anyone can show me the correct COPY command for this case?</p>\n"},{"tags":["sql","database","oracle","concatenation","string-aggregation"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":13142481,"title":"Oracle concatenation of columns with comma","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/468990/how-can-i-combine-multiple-rows-into-a-comma-delimited-list-in-oracle\">How can I combine multiple rows into a comma-delimited list in Oracle?</a>  </p>\n</blockquote>\n\n\n\n<p>Could some one please tell me how to achieve the following?</p>\n\n<p>Table:</p>\n\n<pre><code>efforts_id        cycle_name      release_name \n123               quarter         march \n123               half            april \n123               full            april\n124               quarter         may\n</code></pre>\n\n<p>My expected output:</p>\n\n<pre><code>efforts_id        cycle_name            release_name \n123               quarter,half,full     march,april\n124               quarter               may\n</code></pre>\n\n<p>I am a beginner in oracle so not sure how to do this. Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["python","sql","django","orm","django-models"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13137894,"title":"Django ORM: sort by aggregate of filter of related table","body":"<p>Here's a subset of my model:</p>\n\n<pre><code>class Case(models.Model):\n    ... # primary key is named \"id\"\nclass Employee(models.Model):\n    ... # primary key is named \"id\"\nclass Report(models.Model):\n    case = ForeignKey(Case, null=True)\n    employee = ForeignKey(Employee)\n    date = DateField()\n</code></pre>\n\n<p>Given a particular employee, I want to produce a list of all cases, ordered by when the employee has most recently reported on it.  Those cases for which no report exists should be sorted last.  Cases on the same date (including NULL) should be sorted by further criteria.</p>\n\n<p>Can I express this in the Django ORM api?  If so, how?</p>\n\n<p>In pseudo-SQL, I think I want</p>\n\n<pre><code>Select Case.*\nFrom Case some-kind-of-join Report\nWhere report.employee_id = the_given_employee_id\nGroup by Case.id\nOrder by Max(Report.date) Desc /* Report-less cases last */, Case.id /* etc. */\n</code></pre>\n\n<p>Do I need to introduce a many-to-many relation from Case to Employee through Report to do this in Django ORM?</p>\n"},{"tags":["sql","query","join","row","max"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":54,"score":3,"question_id":13130524,"title":"SQL Query get data from one table, and get data from only one row from another table","body":"<p>I don't know how to explain my problem in the title, so I'll explain it better here...</p>\n\n<p>I have two tables</p>\n\n<pre><code>CREATE TABLE [dbo].[Ventas]\n(\n    [IdVenta] [int] IDENTITY(1,1) NOT NULL,\n    [FechaVenta] [date] NULL,\n    [HoraVenta] [varchar](10) NULL,\n    [Subtotal] [money] NULL,\n    [Iva] [money] NULL,\n    [Total] [money] NULL,\n    [Saldo] [money] NULL,\n    [Abono] [money] NULL,\n    [FormaDePago] [varchar](50) NULL,\n    [Plazos] [int] NULL,\n    [Estado] [varchar](50) NULL,\n)\n\nCREATE TABLE [dbo].[Plazos]\n(\n    [IdPlazo] [int] IDENTITY(1,1) NOT NULL,\n    [IdVenta] [int] NULL,\n    [NumeroPlazo] [int] NULL,\n    [FechaVencimiento] [date] NULL,\n    [FechaCorte] [date] NULL,\n    [FechaPenalizacion] [date] NULL,\n    [FechaLiquidacion] [date] NULL,\n    [Total] [money] NULL,\n    [Cargo] [money] NULL,\n    [Abono] [money] NULL,\n    [Estado] [varchar](50) NULL,\n)\n</code></pre>\n\n<p>now to add some data</p>\n\n<pre><code>INSERT [dbo].[Ventas] ([IdVenta], [FechaVenta], [HoraVenta], [Subtotal], [Iva], [Total], [Saldo], [Abono], [FormaDePago], [Plazos], [Estado]) VALUES (182, CAST(0x54360B00 AS Date), N'11:20', 500.0000, 55.0000, 555.0000, 333.0000, 222.0000, N'A Credito', 5, N'Pendiente De Pago')\nINSERT [dbo].[Ventas] ([IdVenta], [FechaVenta], [HoraVenta], [Subtotal], [Iva], [Total], [Saldo], [Abono], [FormaDePago], [Plazos], [Estado]) VALUES (183, CAST(0x54360B00 AS Date), N'12:29', 575.0000, 63.2500, 638.2500, 638.2500, 0.0000, N'Una Sola Exhibicion', 1, N'Pendiente De Pago')\n\n\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (93, 182, 1, CAST(0x54360B00 AS Date), CAST(0x57360B00 AS Date), CAST(0x5C360B00 AS Date), CAST(0x54360B00 AS Date), 111.0000, 0.0000, 111.0000, N'Liquidado')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (94, 182, 2, CAST(0x73360B00 AS Date), CAST(0x75360B00 AS Date), CAST(0x7A360B00 AS Date), CAST(0x54360B00 AS Date), 111.0000, 0.0000, 111.0000, N'Liquidado')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (95, 182, 3, CAST(0x91360B00 AS Date), CAST(0x94360B00 AS Date), CAST(0x99360B00 AS Date), NULL, 111.0000, 111.0000, 0.0000, N'Pendiente')\nINSERT [dbo].[Plazos] ([IdPlazo], [IdVenta], [NumeroPlazo], [FechaVencimiento], [FechaCorte], [FechaPenalizacion], [FechaLiquidacion], [Total], [Cargo], [Abono], [Estado]) VALUES (96, 183, 1, CAST(0x54360B00 AS Date), CAST(0x57360B00 AS Date), CAST(0x5C360B00 AS Date), NULL, 639.0000, 639.0000, 0.0000, N'Pendiente')\n</code></pre>\n\n<p>Foreign Key On Ventas.IdVenta = Plazos.IdVenta</p>\n\n<p>Ok, Here's the deal...\nI need to use a query that brings data from all sales (Ventas), which only it supposed to be 2 rows...</p>\n\n<p>However, I need data from Plazos, but I only need data from Plazos \nWhat I need is to display data from plazos on the same row as Ventas, but only data from the most recent Plazo...</p>\n\n<p>you may notice that for example, in Plazos there is a column called NumeroPlazo which increases on the same IdVenta... what I need in this example is to display:</p>\n\n<p>Ventas IdVenta 182 with data from Plazos IdPlazo 95 (since from Plazos, IdPlazo 95 has the highest number on the column Numero Plazos...\nand of course IdVenta 183, but since it only has one Plazo, it will display data from that plazo...</p>\n\n<p>At the moment I had this query...</p>\n\n<pre><code>SELECT Ventas.*, Plazos.*, \nFROM Ventas INNER JOIN Plazos ON Plazos.IdVenta = Ventas.IdVenta \nWHERE Ventas.Estado = 'Pendiente De Pago' \nORDER BY Ventas.FechaVenta DESC, Ventas.HoraVenta DESC\n</code></pre>\n\n<p>but it returns 4 rows (3 rows for Venta where IdVenta = 182, and one where IdVenta = 183)\nWhat I want is only 2 rows...</p>\n\n<p>Then I tried this query that worked... but only for one row</p>\n\n<pre><code>SELECT Ventas.*, Plazos.*, \nFROM Ventas INNER JOIN Plazos ON Plazos.IdVenta = Ventas.IdVenta \nWHERE Ventas.Estado = 'Pendiente De Pago' \nAND Plazos.NumeroPlazo = (SELECT MAX(Plazos.NumeroPlazo) FROM Plazos WHERE Plazos.IdVenta = 182)\nORDER BY Ventas.FechaVenta DESC, Ventas.HoraVenta DESC\n</code></pre>\n\n<p>Obviously it only works for one sale since I specify Plazos.IdVenta = 182...\nMy question here is... how can I use the latter query to get the data I want for each sale...</p>\n\n<p>I hope yuo can help me...\nIf you need me to be more specific, please let me know.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["sql","gorm","grails-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13127124,"title":"If operator in groovy sql select statement","body":"<p>I would like to use the if operator in the select statement, using an executeQuery command.\nSomething like:</p>\n\n<pre><code>def tmpRec = BankStatement.executeQuery(\"select   SUM(IF(operation='CREDIT',cashAmount,-1*cashAmount)) from BankStatement group by portfolio,currency,code\")\n</code></pre>\n\n<p>go\nbut the IF operator doesn't work. </p>\n\n<p>thank you</p>\n"},{"tags":["php","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13142611,"title":"Complex SQL query in string","body":"<p>I want to add this SQL Query into a php variable:</p>\n\n<p>But I have errors.. How can I add that SQL query in right format to the php variable..\nSo I can execute the query later on..</p>\n\n<pre><code>SELECT DISTINCT vtiger_account.account_no AS 'Accounts_Account_No'\n   , vtiger_account.accountname AS 'Accounts_Account_Name'\n   , vtiger_accountscf.cf_740 AS 'Accounts_Shipping_Street_Number'\n   , vtiger_accountshipads.ship_street AS 'Accounts_Shipping_Address'\n   , vtiger_accountshipads.ship_city AS 'Accounts_Shipping_City'\n   , vtiger_accountshipads.ship_state AS 'Accounts_Shipping_State'\n   , vtiger_accountshipads.ship_code AS 'Accounts_Shipping_Code'\n   , vtiger_accountshipads.ship_country AS 'Accounts_Shipping_Country'\n   , vtiger_accountshipads.ship_pobox AS 'Accounts_Shipping_Po_Box'\n   , vtiger_accountbillads.bill_state AS 'Accounts_Billing_State'\n   , vtiger_crmentity.crmid AS \"LBL_ACTION\"\nFROM vtiger_account\nINNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = vtiger_account.accountid\nINNER JOIN vtiger_accountbillads ON vtiger_account.accountid = vtiger_accountbillads.accountaddressid\nINNER JOIN vtiger_accountshipads ON vtiger_account.accountid = vtiger_accountshipads.accountaddressid\nINNER JOIN vtiger_accountscf ON vtiger_account.accountid = vtiger_accountscf.accountid\nLEFT JOIN vtiger_groups AS vtiger_groupsAccounts ON vtiger_groupsAccounts.groupid = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_account AS vtiger_accountAccounts ON vtiger_accountAccounts.accountid = vtiger_account.parentid\nLEFT JOIN vtiger_users AS vtiger_usersAccounts ON vtiger_usersAccounts.id = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_groups ON vtiger_groups.groupid = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_users ON vtiger_users.id = vtiger_crmentity.smownerid\nLEFT JOIN vtiger_users AS vtiger_lastModifiedByAccounts ON vtiger_lastModifiedByAccounts.id = vtiger_crmentity.modifiedby\nWHERE vtiger_account.accountid &gt; 0\n   AND vtiger_crmentity.deleted = 0\n   AND (\n      (\n         vtiger_accountshipads.ship_state = 'WA'\n         OR vtiger_accountbillads.bill_state = 'WA'\n         )\n      AND (\n         trim(CASE \n               WHEN (vtiger_usersAccounts.last_name NOT LIKE '')\n                  THEN CONCAT (\n                        vtiger_usersAccounts.first_name\n                        , ' '\n                        , vtiger_usersAccounts.last_name\n                        )\n               ELSE vtiger_groupsAccounts.groupname\n               END) = 'HACO Australia'\n         OR trim(CASE \n               WHEN (vtiger_usersAccounts.last_name NOT LIKE '')\n                  THEN CONCAT (\n                        vtiger_usersAccounts.first_name\n                        , ' '\n                        , vtiger_usersAccounts.last_name\n                        )\n               ELSE vtiger_groupsAccounts.groupname\n               END) = 'Sam'\n         )\n      )\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13142930,"title":"how to transpose in sql","body":"<p>Suppose I have</p>\n\n<pre><code>select *\nfrom A a\n     left outer join B b on b.ID in (1,2,3/*and possibly any numbers*/)\n</code></pre>\n\n<p>and so I get (<code>Ax - A's xth row, Bx - B's xth row</code>):</p>\n\n<pre><code>A1 B1\nA1 B2\nA1 B3\nA2 B1\n...\n</code></pre>\n\n<p>And what I want is this:</p>\n\n<pre><code>A1 B1 B2 B3\nA2 B1 B2 B3\n</code></pre>\n\n<p>So that there is dynamic number of columns. What is the best way of achieving this?</p>\n"},{"tags":["sql","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":72,"score":5,"question_id":13141899,"title":"Finding the next occurrence of a value in a table","body":"<p>Sorry in advance if this has already been covered.</p>\n\n<p>I am working on a database which isnt particularly well structured but it is owned by a third party and cannot be changed.</p>\n\n<p>I need some assistance with t-sql in find the next occurrence of a value within the table and return records based on the result. Let me first explain the data. I have simplified this to make it easier to understand.</p>\n\n<pre><code>Polref      Effective Date       Transaction Type     Suffix        Value\nABCD1       01/06/2010           New Bus              1             175.00\nABCD1       01/06/2011           Ren                  2             200.00\nABCD1       19/08/2011           Adjust               3              50.00\nABCD1       23/04/2012           Adjust               4              50.00\nABCD1       01/06/2012           Ren                  5             275.00\n</code></pre>\n\n<p>So if I ran my query for 2011, the code would need to return in this example rows with suffix 2,3 and 4. So what I have been trying to do is find the first suffix of a New Bus or Ren for the specified year and then finding the next suffix for a New Bus or Ren for the same polref and then using those two suffix values to limit my recordset. It aint working!!</p>\n\n<p>I cant use MAX() as transactions for 2013 have already been added to the system to I would get more records than I actually need.</p>\n\n<p>There result I should be expecting for this example data would be:</p>\n\n<p>ABCD1       300.00</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>To answer another question, If I select 2011 as my year to run the report, there should only be one New Bus or Ren transaction for 2011 so if its a New Bus transaction, the next main transaction will be a Ren, if its a Ren then the next main transaction will be a Ren. Again in my example below, if I run for 2011, it should find the Ren from 01/06/2011 so I want to return that Ren and the two Adjust records.</p>\n\n<p>Sorry, I've not used this forum before so apologies if I was a little vague.</p>\n\n<p>The table I am using has many polrefs so I need this code to calculate totals for all polrefs that fall within the date range. Some polrefs may only have one row, a New Bus, some will have many rows depending on how many adjustments have been made throughout the year of the policy</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13142202,"title":"SQL query to different tables and show all","body":"<p>On my php web I have 3 content type saved on different tables with different number of columns</p>\n\n<p>for example:</p>\n\n<pre><code>Type 1 (X columns) (example: table_products)\nType 2 (Y columns) (example: table_customers)\nType 3 (Z columns) (example: table_posts)\n</code></pre>\n\n<p>I'm making a Search system that searchs on each type in the same Select, showing finally all results.</p>\n\n<p>Example:</p>\n\n<pre><code>I search: foo\n\nSystem searchs on: Type 1, type 2 and type 3 \"foo\" and shows:\n\n- Product foo1\n- Product foo2\n- Customer foo1\n- Customer foo2\n- Customer foo3\n- Post foo1\n (It's only an example)\n</code></pre>\n\n<p>Now I have three different functions to make the query on each type, but I don't like this because I can't paginate it.</p>\n\n<p><strong>I need to make a query that searchs on three tables at time.</strong></p>\n\n<p>Thank you</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13141696,"title":"Convert Month Name to Month Number","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8314310/convert-month-name-to-month-number-function-in-sql\">Convert Month Name to Month Number Function in SQL</a>  </p>\n</blockquote>\n\n\n\n<p>I am attempting to convert a month name to month number in the area of the script below called <code>datename(MM, patientinfo.PatientDOB)</code>. As an example, it is currently returning as <code>January</code> and I would like it to return as <code>01</code> or <code>1</code>.</p>\n\n<p>From what I've read I may need to do a <code>CASE WHEN 'January' THEN 1</code>, but I am not sure where to insert it or the exact syntax to use.</p>\n\n<pre><code>select\n    Update_Log.RecordID as 'Dictation ID',\n    cast(dictations.DOS as DATE) as 'Date of Service',\n    groups.GroupName,\n    rtrim(aspnet_Users.Firstname)+' '+rtrim(aspnet_Users.LastName) as Provider, \n    Update_Log.Updated, \n    Update_XRef.columnName as 'Update Type', \n    \"New Value\" =\n        case \n            when update_xref.columnname = 'FacilityID' then (select facility.FacilityName+' [gID:'+update_log.NewValue+']' from facility where update_log.NewValue = facility.FacilityID)\n            when update_xref.columnname = 'DOS' then (select left(update_log.NewValue, 11) as 'New Value')\n            when update_xref.columnname = 'DictatorID' then (select rtrim(aspnet_users.Firstname)+' '+rtrim(aspnet_users.lastname) from aspnet_Users where aspnet_users.userid1 = update_log.UpdatedBy)\n            when update_xref.columnname = 'PatientID' then (select rtrim(patientinfo.PatientFirst)+' '+rtrim(patientinfo.PatientLast)+' ['+datename(MM, patientinfo.PatientDOB)+'/'+datename(DD, patientinfo.PatientDOB)+'/'+datename(YY, patientinfo.PatientDOB)+ ', gID:'+rtrim(patientinfo.PatientID)+']' from patientinfo where patientinfo.PatientID = Update_Log.NewValue)\n        end,\n    \"Old Value\" =\n        case \n            when update_xref.columnname = 'FacilityID' then (select facility.FacilityName+' [gID:'+update_log.OldValue+']' from facility where update_log.OldValue = facility.FacilityID)\n            when update_xref.columnname = 'DOS' then (select left(update_log.OldValue, 11) as 'Old Value')\n            when update_xref.columnname = 'DictatorID' then (select rtrim(aspnet_users.Firstname)+' '+rtrim(aspnet_users.lastname) from aspnet_Users where aspnet_users.userid1 = update_log.UpdatedBy)\n            when update_xref.columnname = 'PatientID' then (select rtrim(patientinfo.PatientFirst)+' '+rtrim(patientinfo.PatientLast)+' ['+left(datename(MM, patientinfo.PatientDOB),3)+'/'+datename(DD, patientinfo.PatientDOB)+'/'+datename(YY, patientinfo.PatientDOB)+ ', gID:'+rtrim(patientinfo.PatientID)+']' from patientinfo where patientinfo.PatientID = Update_Log.OldValue)\n        End\nfrom \n    Update_Log, \n    Update_XRef, \n    aspnet_Users, \n    groups, \n    Dictations\nwhere \n    Update_log.XRefID = Update_XRef.xRefID\n    and Update_Log.UpdatedBy = aspnet_Users.userid1\n    and aspnet_users.Groupid = Groups.GroupID\n    and dictations.Dictationid = Update_Log.RecordID\n    and Update_Log.Updated &gt; dictations.DateofSignature\norder by \n    groups.GroupName, \n    aspnet_users.LastName, \n    update_log.RecordID\n</code></pre>\n"},{"tags":["mysql","sql","database","triggers","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13141013,"title":"MySQL LAST_INSERT_ID() not updating due to AUTO_INCREMENT","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6499389/mysql-getting-last-insert-id-in-a-trigger\">mysql getting last_insert_id() in a trigger</a>  </p>\n</blockquote>\n\n\n\n<p>I have MySQL <code>TRIGGER</code> firing <code>AFTER INSERT ON</code> a table (<code>my_table</code>).</p>\n\n<p>I wish to store the <code>PRIMARY_KEY</code> of the row effected by the <code>TRIGGER</code> in a variable using:</p>\n\n<pre><code>SET  @user_id =  LAST_INSERT_ID();\n</code></pre>\n\n<p>Which is backed by <a href=\"http://stackoverflow.com/questions/3837990/last-insert-id-mysql\">this stackoverflow link</a>. And seems to be working.</p>\n\n<p>However, each time it stores the value as <code>0</code>.</p>\n\n<p>From <a href=\"http://stackoverflow.com/questions/10246412/last-insert-id-always-returns-0-rmysql-separate-connection-issue\">this stackoverflow link</a>, I believe this is due to the fact that <code>my_table</code> is set to <code>AUTO_INCREMENT</code>.</p>\n\n<pre><code>SET  @user_id =  LAST_INSERT_ID();\n</code></pre>\n\n<p>What is the best practice to overcome this?</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13142183,"title":"Selecting Areas for Sales Reps","body":"<p>I have an application that is for sales reps. \nI'm trying to pull different institutions information based on 2 things</p>\n\n<ol>\n<li>If they are a client</li>\n<li>If they are in the state that the user (sales rep) is over.</li>\n</ol>\n\n<p>So I want to show all the institutions that are clients in the current_user (sales reps) area. How can I do that? </p>\n\n<p>Since I haven't done this before and I'm newer to rails I'm not sure how to do this.</p>\n\n<p>Here are my models (I've shortened the code):</p>\n\n<p><strong>User(Sales Rep)</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :states, :through =&gt; :rep_areas\n  has_many :institutions, :through =&gt; :company_reps\n  has_many :rep_areas\n  has_many :company_reps\nend\n</code></pre>\n\n<p><strong>States</strong></p>\n\n<pre><code>class State &lt; ActiveRecord::Base\n  has_many :users, :through =&gt; :rep_areas\n  has_many :rep_areas\n  has_many :institutions\n\n  attr_accessible :code, :name\nend\n</code></pre>\n\n<p><strong>Institutions</strong></p>\n\n<pre><code>class Institution &lt; ActiveRecord::Base\n  attr_accessible :company, :phone, :clientdate, :street, :city, :state_id, :zip, :source, :source2, :demodate1, :demodate2, :demodate3, :client, :prospect, :notcontacted\n  belongs_to :state\n  has_many :users, :through =&gt; :company_reps\n  has_many :company_reps\nend\n</code></pre>\n"},{"tags":["php","sql","database","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13142196,"title":"Export specific table columns to Excel","body":"<p>I'm trying to export specific column data (i.e., Ticket #, Company/Customer Name, Issue Subject, Date Closed) from my SQL DB table to Excel (.xls), I have the code written but it's exporting my entire Database table. (See code Below)</p>\n\n<p>Specific column data that needs to be exported:</p>\n\n<ul>\n<li>ticketID</li>\n<li>name</li>\n<li>company</li>\n<li>subject</li>\n<li>closed</li>\n</ul>\n\n<p>Also is there any way to add a function that only exports a specific range (i.e., Date range from October 1, 2012 to October 31, 2012)?</p>\n\n<p><pre></p>\n\n<code>&lt;?PHP\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"my_databse\";                //your MySQL Database Name\n$DB_TBLName = \"my_table\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select * from $DB_TBLName\";\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y H:i');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //following fix suggested by Josue (thanks, Josue!)\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n     }\n}\n\n?&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["python","sql","django"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13139270,"title":"Django advanced query","body":"<p>I'm using Django ORM to handle my database queries. I have the following db tables:</p>\n\n<ul>\n<li>resource</li>\n<li>resource_pool</li>\n<li>resource_pool_elem</li>\n<li>reservation</li>\n</ul>\n\n<p>and the following models:</p>\n\n<pre><code>class Resource(models.Model):\n\n    name = models.CharField(max_length=200)\n\nclass Reservation(models.Model):\n    pass\n\nclass ResourcePool(models.Model):\n\n    reservation = models.ForeignKey(Reservation, related_name=\"pools\", db_column=\"reservation\")\n    resources = models.ManyToManyField(Resource, through=\"ResourcePoolElem\")\n    mode = models.IntegerField()\n\nclass ResourcePoolElem(models.Model):\n\n    resPool = models.ForeignKey(ResourcePool)\n    resource = models.ForeignKey(Resource)\n</code></pre>\n\n<p>Currently, I need to query the resources used in a set of reservations. I use the following query:</p>\n\n<pre><code>resourcesNames = []\nreservations = []\nresources = models.Resource.objects.filter(\n    name__in=resourcesNames, resPool__reservation__in=reservations).all()\n</code></pre>\n\n<p>which I think matches to a sql query similar to this one:</p>\n\n<pre><code>select *\nfrom resource r join resource_pool rp join resource_pool_elem rpe join reservation reserv \nwhere r.id = rpe.resource and  \n  rpe.pool = rp.id and\n  reserv.id = rp.reservation and\n  r.name in (resourcesNames[0], ..., resourcesNames[n-1])\n  reserv.id in (reservations[0], ..., reservations[n-1])\n</code></pre>\n\n<p>Now, I want to add a restriction to this query. Each pool may have a exclusive mode boolean flag. There will be an extra input list with the requested exclusive flags of each pool and I only want to query the resources of pools which exclusive flag match the requested exclusive flag if exclusive = true OR resources of pools which exclusive flag is false. I could build the SQL query using Python with a code similar to this:</p>\n\n<pre><code>query = \"select * \n    from resource r join resource_pool rp join resource_pool_elem rep\n    join reservation reserv \n    where r.id = rpe.resource and  \n    rpe.pool = rp.id and \n    reserv.id = rp.reservation and \n    reserv.id in (reservations[0], ..., reservations[n-1]) and (\"\nfor i in resourcesNames[0:len(resourcesNames)]\n    if i &gt; 0:\n        query += \" or \"\n    query += \"r.name = \" + resourcesNames[i]\n    if (exclusive[i])      \n        query += \" and p.mode == 0\"\nquery += \")\"    \n</code></pre>\n\n<p>Is there a way to express this sql query in a Django query?</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13141055,"title":"Removing certain rows from table on condition plus converting varchar to date","body":"<p>I understand that this question might have a trivial answer. I would like to remove certain rows from a huge table when certain condition is met. The condition is on <code>drdate</code> (a varchar field), which holds date information so it needs to be converted. The table is huge and ideally I do not want to spend too much time for the query to run.</p>\n\n<pre><code>delete from products \nwhere (to_date('drdate','mm/dd/yyyy')) &gt; (to_date('01/01/2011','mm/dd/yyyy'))\n</code></pre>\n\n<p>This returns:</p>\n\n<p><em>SQL Error: ORA-01858: a non-numeric character was found where a numeric was expected\n01858. 00000</em> </p>\n"},{"tags":["php","sql","text","area"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":13141178,"title":"updating mysql table on textarea blur?","body":"<p>i am trying to make a text area update the information in a table in mysql when the user clicks out the text area. can someone guide me in the right direction please. This is what i have so far. im not getting any errors, but when i update it the changes arnt saving.</p>\n\n<p>HTML CODE</p>\n\n<pre><code>    &lt;form action=\"&lt;?php $_SERVER['PHP_SELF'] ?&gt;\" method=\"post\"&gt;\n\n&lt;textarea id=\"title\" textarea name=\"title\" rows=\"10\" style=\"width: 456px; \n    margin-top:3px;\n    text-align:left;\n    margin-left:-2px;\n    height: 120px;\n    resize: none; \n    border: hidden;\" data-id='$idbio'&gt;&lt;?php echo $profile['bio'] ?&gt; &lt;/textarea&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Javascript code</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n\n$('textarea').on('blur',function () {\n    var titleVal = $(this).val(), id = $(this).data('id');        \n\n    $.ajax({\n         type: \"POST\",\n         url: \"changebio.php\",\n         data: {title:titleVal , id:id},\n         success: function(msg) {\n             $('#'+id).html(msg);\n         }\n   })\n});\n\n&lt;/script&gt;\n</code></pre>\n\n<p>changebio.php</p>\n\n<pre><code> &lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\nupdate_profilebio ();\nheader('Location: http://www.something.com/confirm.php');\n?&gt;\n</code></pre>\n\n<p>function.php</p>\n\n<pre><code> function update_profilebio() {\n            global $connection;\n            global $profile_id;\n            $query = \"UPDATE ptb_profiles\n                      SET bio='value'\n                        WHERE ptb_profiles.user_id = \\\"$profile_id\\\"\n                        AND ptb_profiles.user_id = ptb_users.id\";\n            $update_profilebio_set = mysql_query($query, $connection);\n            confirm_query($update_profilebio_set);\n            return $update_profilebio_set;\n\n            }\n</code></pre>\n"},{"tags":["sql","vb.net","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13141554,"title":"Fetching values from tables and adding other parameters in Insert Query","body":"<p>Can anyone please advice in below query - I need to fetch few from table and few will be provided as a variables to below statement. I'm struggling how to write this</p>\n\n<pre><code>SQLCommand = New SqlCommand(\"TableA\", Conn)\nSQLCommand.CommandText = \"Insert into TableA(P1,P2,P3,P4,P5,P6,P7,P8) \" &amp; _\n            \"Values (@p1, @P2, @P3, @P4, @P5, @P6, @P7, @P8)\n</code></pre>\n\n<p>Out of this @p1,@p2,@p3,@p4 will come from Table B\nAnd @p5,@p6, @p7, @p8 will be variables to whom value will be provided by the function</p>\n\n<p>I'm struggling how to change the above COMMANDTEXT statement - to fetch values from TableB and also other custom variables (which are p5,p6,p7,p8)</p>\n"},{"tags":["sql","sql-server","sql-server-2008","query","exists"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13141461,"title":"What can I do to speed up this SQL Query?","body":"<p>I've created this SQL query with the help of @Dems :-)</p>\n\n<p>Here is some detail, I tried to make a SQLFiddle but I kept getting errors with my variables... This works in Sql Server 2008...  My question is, how can I make my query faster? I know I'm doing a number of things wrong here (repeated nester queries), I'm hoping to get one of you SQL gurus to take a look and help me get this down from it's 30 minute execution time! :-S</p>\n\n<p>I'm not sure exactly how much information you need to be able to help me on this one, please fire away with any questions and I'll reply ASAP.  Sorry if the level of detail is lacking a little, I just don't know what you want/need to know!</p>\n\n<p>The basic idea behind the query is that in the game I want to find all players which haven't moved 5 units for a period of time, who have fired whilst stood still and did not fire for 60 minutes before they stopped moving.  The query works, but it's the <code>AND NOT EXISTS</code> clause which is slowing things down to a crawl, before I added that it took 16 seconds to run!  16 seconds is still a looong time, so any other improvements would be appreciated, but for now with this being my own POC game (just throwing bits and pieces together), 16 seconds is acceptable... </p>\n\n<pre><code>DECLARE @n INT , @DistanceLimit INT\nSELECT  @n = 2 , @DistanceLimit = 5;\n\nWITH    partitioned\n          AS ( SELECT   * ,\n                        CASE WHEN Distance &lt; @DistanceLimit THEN 1\n                             ELSE 0\n                        END AS PartitionID\n               FROM     EntityStateEvent\n               WHERE    ExerciseID = '8B50D860-6C4E-11E1-8E70-0025648E65EC'\n             ),\n        sequenced\n          AS ( SELECT   ROW_NUMBER() OVER ( PARTITION BY PlayerID ORDER BY EventTime ) AS MasterSeqID ,\n                        ROW_NUMBER() OVER ( PARTITION BY PlayerID, PartitionID ORDER BY EventTime ) AS PartIDSeqID ,\n                        *\n               FROM     partitioned\n             ),\n        filter\n          AS ( SELECT   MasterSeqID - PartIDSeqID AS GroupID ,\n                        MIN(MasterSeqID) AS GroupFirstMastSeqID ,\n                        MAX(MasterSeqID) AS GroupFinalMastSeqID ,\n                        PlayerID\n               FROM     sequenced\n               WHERE    PartitionID = 1\n               GROUP BY PlayerID ,\n                        MasterSeqID - PartIDSeqID\n               HAVING   COUNT(*) &gt;= @n\n             )\n    SELECT\nDISTINCT    ( sequenced.PlayerID ) ,\n            MIN(sequenced.EventTime) AS StartTime ,\n            MAX(sequenced.EventTime) AS EndTime ,\n            DATEDIFF(minute, MIN(sequenced.EventTime),\n                     MAX(sequenced.EventTime)) AS StaticTime ,\n            Player.Designation AS 'Player'\n    FROM    filter\n            INNER JOIN sequenced ON sequenced.PlayerID = filter.PlayerID\n                                    AND sequenced.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                    AND sequenced.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n            INNER JOIN Events ON Events.FiringPlayerID = sequenced.PlayerID \n            INNER JOIN Player ON Player.PlayerID = sequenced.PlayerID\n                                 AND Player.Force = 'FR'\n                                 AND NOT EXISTS ( SELECT    *\n                                                  FROM      Events\n                                                  WHERE     Events.FiringPlayerID = Player.PlayerID\n                                                  GROUP BY  Events.FiringTime\n                                                  HAVING    Events.FiringTime BETWEEN DATEADD(minute,\n                                                              -60,\n                                                              ( SELECT\n                                                              MIN(s.EventTime)\n                                                              FROM\n                                                              sequenced s\n                                                              WHERE\n                                                              s.PlayerID = filter.PlayerID\n                                                              AND s.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                                              AND s.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n                                                              ))\n                                                              AND\n                                                              ( SELECT\n                                                              MIN(s.EventTime)\n                                                              FROM\n                                                              sequenced s\n                                                              WHERE\n                                                              s.PlayerID = filter.PlayerID\n                                                              AND s.MasterSeqID &gt;= filter.GroupFirstMastSeqID\n                                                              AND s.MasterSeqID &lt;= filter.GroupFinalMastSeqID\n                                                              ) )\n            INNER JOIN Player HitPlayer ON HitPlayer.PlayerID = Events.HitPlayerID\n    WHERE   HitPlayer.[FORCE] = 'HO'\n    GROUP BY GroupID ,\n            sequenced.PlayerID ,\n            Events.FiringPlayerID ,\n            Events.FiringTime ,\n            Player.Designation\n    HAVING  DATEDIFF(minute, MIN(sequenced.EventTime),\n                     MAX(sequenced.EventTime)) &gt; 5\n            AND Events.FiringTime BETWEEN MIN(sequenced.EventTime)\n                                  AND     MAX(sequenced.EventTime)\n    ORDER BY StartTime\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13141369,"title":"is it possible to set column value to a concatenation of string and iteration value?","body":"<p>Is it possible to set value of a varchar column to a concatenation of a string and the result set iteration.    </p>\n\n<p>for example:</p>\n\n<pre><code>update TB_USER set LOGIN_NAME = 'BOB'+index where LOGIN_NAME = 'BOB'\n</code></pre>\n\n<p>results in the following: </p>\n\n<blockquote>\n  <p>LOGIN_NAME</p>\n  \n  <p>BOB0</p>\n  \n  <p>BOB1</p>\n  \n  <p>BOB2</p>\n</blockquote>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13134585,"title":"How to use Update Statement in SQL Server with join","body":"<p>The code below works fine with MS Access but I cannot make it work with SQL Server 2008.</p>\n\n<pre><code>UPDATE Borrow INNER JOIN BorrowDetails \nON Borrow.BorrowID = BorrowDetails.BorrowID \nSET BorrowDetails.Returned = True \nWHERE BookID = 1 AND MemberID = 1\n</code></pre>\n\n<p>Any idea please.</p>\n"},{"tags":["mysql","sql","query","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13141236,"title":"MYSQL insert into first empty column","body":"<p>I have a tbl, for example:</p>\n\n<pre><code>uniqueId     |    col1    |    col2   |   col3   \nu1                 8       \nu2\nu3                 13           89\n</code></pre>\n\n<p>What I want is to insert into the first empty column (can make them null if that helps). In the given if I'll add to u1 the value 2 it will be inserted into col2. If I do it for u2, it will enter col1. and for u3 it will enter to u3. These three queries will do the trick but I would rather do it in one.</p>\n\n<p><code>INSERT INTO tbl SET col1 = $toInsertVal WHERE uniqueId=u col1=''</code><br>\n<code>INSERT INTO tbl SET col2 = $toInsertVal WHERE uniqueId=u col1&lt;&gt;'' AND col2=''</code><br>\n<code>INSERT INTO tbl SET col3 = $toInsertVal WHERE uniqueId=u col1&lt;&gt;'' AND col2&lt;&gt;'' AND col3=''</code></p>\n"},{"tags":["mysql","sql","match-against"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13135326,"title":"Sql compare almost equal records","body":"<p>I have such records in db:</p>\n\n<pre><code>Тормозной диск\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Диски тормозные LPR\n</code></pre>\n\n<p>etc</p>\n\n<p>and i try to compare</p>\n\n<pre><code>Тормозной диск\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Диски тормозные LPR\n</code></pre>\n\n<p>here</p>\n\n<pre><code>select * from (....) where match(`cross_value`) against (\"*Тормозной диск*\" in boolean mode)\n</code></pre>\n\n<p>Sure it give me that it doesn't include it...</p>\n\n<p>But how can i tell mysql, that it is true? That <code>Диски Тормозные</code> and <code>Тормозной Диск</code> is the same and inclusion => true?</p>\n"},{"tags":["c#","sql","database","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13133274,"title":"linq to sql relationship","body":"<p>I want to return a dataset with some relations, the query is OK but I get the ID instead of the real value from the other table... This is the query</p>\n\n<pre><code>        var thr=\n            from u in dc.thresholds\n            select u;\n</code></pre>\n\n<p>This returns something like this:</p>\n\n<pre><code>id: 1\nname: some name\ntype_id: 1\nowner_id: 1\n</code></pre>\n\n<p>I want to get type_id and owner_id with the values of theese tables, so it can be something like:</p>\n\n<pre><code>id: 1\nname: some name\ntype_id: Danger\nowner_id: John Smith\n</code></pre>\n\n<p>I hope some of you could give me some advices, I'm starting with LINQ to SQL and I'm a bit lost...</p>\n\n<p>Thank you</p>\n"},{"tags":["mysql","sql","if-statement","group-by","conditional"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13130276,"title":"Joining conditionally in MySQL","body":"<p>I have a table called <code>USERS</code> and a table called <code>ADDRESSES</code>, as well as an <code>ADDRESS_TYPE</code> table. Each user can have multiple addresses.</p>\n\n<pre><code>SELECT *\nFROM USER\nINNER JOIN address ON address.userId = user.userId\nINNER JOIN address_type ON address_type.id = address.addressType\nWHERE addressType = 4 \n    OR primaryAddress = 1\n</code></pre>\n\n<p>I want to join the address table to the user table if they have an addressType of 4, but if their addressType is NOT 4 it should pull in the address that is marked as the primary. Basically the problem is that I need to group the query so that each user only gets 1 row, while having logic = \"if addressType = 4, join this address, else if primaryAddress = 1, join this other address\".</p>\n\n<p>Hope this makes sense, very grateful for any help.</p>\n\n<p>Edit: These are the tables I am dealing with:</p>\n\n<p>USER TABLE</p>\n\n<p>+--------+-----------------+-----------------+<br>\n| userId | firstName       | lastName        |<Br>\n+--------+-----------------+-----------------+<br>\n| 10001  | Debbie          | Basson         |<Br>\n| 10002  | Bamawama        | Kudon          |<br>\n| 10003  | JessicaM        | Stevies        |<br>\n| 10004  | Kinnon          | White          |<BR>\n+--------+-----------------+-----------------+<br></p>\n\n<p><br><br>\nADDRESS TYPE<BR>\n+----+------+-------------+------------+------------+<br>\n| id | code | description | modifiable | dataStatus |<br>\n+----+------+-------------+------------+------------+<br>\n|  1 | HOME | Home        | 1          |          1 |<br>\n|  2 | BUSS | Business    | 1          |          1 |<br>\n|  3 | SCH  | School      | 1          |          1 |<br>\n|  4 | DON  | Donor Address    | 1          |          1 |<br>\n+----+------+-------------+------------+------------+<br><BR></p>\n\n<p>ADDRESS TABLE<BR><BR>\n+----------------+--------+-------------------------+-------------+-------------+<BR>\n| primaryAddress | userId | street1                 | city        | addressType |<BR>\n+----------------+--------+-------------------------+-------------+-------------+<BR>\n|              0 | 10001  | 12660 Picarte Pl.       | San Diego   |           1 |<BR>\n|              0 | 10001  | 446 W Wilshire Ave      | Fullerton   |           2 |<BR>\n|              0 | 10001  | 4224 E. 114th Way       | Thornton    |           3 |<BR>\n|              1 | 10001  | 828 Colorado Blvd.      | Los Angeles |           4 |<BR>\n|              0 | 10002  | 40A Linden Ave., #2     | Somerville  |           1 |<BR>\n|              0 | 10002  | 446 37th St., #2        | Oakland     |           null |<BR>\n|              1 | 10002  | PO Box 06562            | Chicago     |           null |<BR>\n|              0 | 10002  | 1281 W. 2nd St.         | San Pedro   |           null |<BR>\n|              1 | 10003  | 10557 S. Oakley Ave.    | Chicago     |           null |<BR>\n|              0 | 10003  | 1425 Harrison St., #324 | Oakland     |           null |<BR>\n+----------------+--------+-------------------------+-------------+-------------+<BR></p>\n"},{"tags":["sql","sql-server","count","aggregate-functions","select-case"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":92,"score":3,"question_id":13140545,"title":"How can you use a COUNT() in a comparison in a SELECT CASE clause in Sql Server?","body":"<p>Let's say you want do something along the following lines:</p>\n\n<pre><code>SELECT CASE \n    WHEN (SELECT COUNT(id) FROM table WHERE column2 = 4) &gt; 0\n    THEN 1 ELSE 0 END\n</code></pre>\n\n<p>Basically just return 1 when there's one or more rows in the table, 0 otherwise.  There has to be a grammatically correct way to do this.  What might it be?  Thanks!</p>\n"},{"tags":["sql","sql-server","reporting-services"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13093910,"title":"SSRS Parameter doesn't display even though the query works","body":"<p>I have a query to fill a report parameter:</p>\n\n<pre><code>select distinct [Source No_] from _report_sales_master\nwhere [Industry] = @Industries\nand [posting date] &gt;= dateadd(year,datediff(year,'01/06/2000',@year)-1,'01/06/2000') \nand  [posting date] &lt; dateadd(year,datediff(year,'01/06/2000',@year),'01/06/2000')\norder by [Source No_]\n</code></pre>\n\n<p>The query results in a list that I use to fill a multi-value report parameter.</p>\n\n<p>When I run the query, it generates the right results.</p>\n\n<p>When I run the report, the \"Source No_\" parameter stays empty, no matter which @year or @industries i choose</p>\n\n<p>When I  remove the \"posting date\" clauses from the query, the parameter list populates and works properly. </p>\n\n<p>What am I missing?</p>\n"},{"tags":["mysql","sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13140684,"title":"Difference between entity and tuple","body":"<p>Please help me understand the difference between a entity and a tuple. Thanks</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":56,"score":-1,"question_id":13140401,"title":"SQL insert into values where not exists","body":"<p>I am trying to execute the following query </p>\n\n<pre><code>INSERT INTO test (trans_id, voucher_id, trans_date, ledger_code_1,\n                  company_code,trans_type, trans_amount) \nVALUES (1, 1,'2012/04/01','2001', '8523a95b-5425-46be-89ed-ebd592846845',\n        'Payment', -30)   \nWHERE NOT EXISTS(SELECT trans_id, ledger_code_1 \n                 FROM test \n                 WHERE trans_id = 1 AND ledger_code_1 = '2001')\n</code></pre>\n\n<p>its giving error. where am i wrong ?</p>\n\n<blockquote>\n  <p>1064 - You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax to use\n  near <strong>where not exists(select trans_id,ledger_code_1 from test where\n  **trans_id = 1 and' at line 1</strong></p>\n</blockquote>\n\n<p>is there any other solution ? i have primary key as auto number..</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13140149,"title":"Return Query Based on Tree Structure","body":"<p>I am looking to return a query that shows exactly like this:</p>\n\n<p>Root 1<br/>\n--> Child 2 <br/>\n----->Child 3 <br/>\nRoot 2 <br/>\n--> Child 4 <br/>\n---->Child 5 <br/></p>\n\n<p>So the query should return Root 1 as One row, ---> Child 2 as another row. Assume n Levels, and \"--->\" format is placed for each child. Level is higher then \"---->\" increases.</p>\n\n<p>My Table definition is <br/></p>\n\n<p><strong>[NodeId, ParentId, Name, Level]</strong></p>\n"},{"tags":["sql","sql-server-2008","reporting-services","charts","business-intelligence"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3721,"score":1,"question_id":2580282,"title":"SQL Server 2008 Reporting Services Charting - adding a data table to bottom of a chart","body":"<p>I would like to add a data table to bottom of a (line) chart in a report.  I know I can create a matrix report with the same data source.  I would like to have everything lineup automatically like it does when you add a data table to a chart in Excel (as shown at <a href=\"http://www.tushar-mehta.com/excel/newsgroups/data_table/\" rel=\"nofollow\">http://www.tushar-mehta.com/excel/newsgroups/data_table/</a>). </p>\n\n<p>Example from Excel (from above link)\n<img src=\"http://www.tushar-mehta.com/excel/newsgroups/data_table/index.3.gif\" alt=\"Sample Chart\"></p>\n\n<p>Any ideas?</p>\n"},{"tags":["sql","postgresql","postgresql-8.2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13137699,"title":"Renumber duplicates to make them unique","body":"<pre><code>       Table \"public.t\"\n Column |  Type   | Modifiers\n--------+---------+-----------\n code   | text    |\n grid   | integer |\n</code></pre>\n\n<p>The <code>codigo</code> column, although of type text, has a numeric sequence which has\nduplicates. The grid column is a unique sequence.</p>\n\n<pre><code>select * from t order by grid;\n code | grid\n------+------\n 1    |    1\n 1    |    2\n 1    |    3\n 2    |    4\n 2    |    5\n 2    |    6\n 3    |    7\n</code></pre>\n\n<p>The goal is to eliminate the duplicates in the <code>code</code> column to make it unique. The result should be similar to:</p>\n\n<pre><code> code | grid\n------+------\n 1    |    1\n 6    |    2\n 4    |    3\n 2    |    4\n 7    |    5\n 5    |    6\n 3    |    7\n</code></pre>\n\n<p>The version is 8.2 (no window functions).</p>\n\n<pre><code>create table t (code text, grid integer);\ninsert into t values\n ('1',1),\n ('1',2),\n ('1',3),\n ('2',4),\n ('2',6),\n ('3',7),\n ('2',5);\n</code></pre>\n"},{"tags":["sql","postgresql","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13127953,"title":"How to transpose columns and rows in PostgreSQL (i.e., how do I switch rows and columns)?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8490478/transposing-an-sql-result-so-that-one-column-goes-onto-multiple-columns\">Transposing an sql result so that one column goes onto multiple columns</a>  </p>\n</blockquote>\n\n\n\n<p>I'd like to do a sort of row/column swapping in my PSQL database. Here's my example database:</p>\n\n<pre><code>id  place   price   year\n1   U.S.    80  2000\n2   U.S.    60  2001\n3   U.S.    40  2002    \n4   U.K.    600 2000\n5   U.K.    500 2001\n6   U.K.    350 2002\n</code></pre>\n\n<p>I would like to transform that table into the following example:</p>\n\n<pre><code>year    U.S.    U.K.\n2000    80  600\n2001    60  500\n2002    40  350\n</code></pre>\n\n<p>Is this possible in PostgreSQL?</p>\n"},{"tags":["sql","sql-server","triggers","merge-replication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12931756,"title":"Trigger does not work because of deprecated datatype in replicated table","body":"<p>I have a table in my SQL Server 2005 database, which has a field with the datatype NTEXT. This table is replicated in a merge-replication with a lot of SQLCE-subscriptions.</p>\n\n<p>I have tried to add an <code>ON INSERT</code> trigger to this table to process the NTEXT-field. But I got this error:</p>\n\n<pre><code>Cannot use text, ntext, or image columns in the 'inserted' and 'deleted' tables.\n</code></pre>\n\n<p>On my researches I found several postings that NTEXT is deprecated and I should change to NVARCHAR(MAX). But I can't do this without recreating the snapshot, which is quite a problem for the people working with the devices (because of dataamount and time).</p>\n\n<p>Is there a workaround for the insert-trigger to handle the datatypes?</p>\n\n<p>This is where the error is thrown:</p>\n\n<pre><code>DECLARE c1 CURSOR FOR SELECT ControlValue FROM INSERTED\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13130000,"title":"mysql insert record if something > something else","body":"<p>I have a query </p>\n\n<pre><code>$query = \"INSERT INTO `user`\n    (`fname`,\n    `lname`,\n    `email`,\n    `password`,\n    `permission`,\n    `idcustomer`)\n         VALUES\n    (\n    '\" . $firstname . \"',\n    '\" . $lastname . \"',\n    '\" . $email . \"',            \n    '\" . $password . \"',\n    'admin',\n    \" . $idcustomer . \"\n    );\";\n</code></pre>\n\n<p>Now, I need to execte this query only is the result of the query below is > 0:</p>\n\n<pre><code>select (number_of_users - (select count(*) from user where idcustomer=2)) availableUsers \n   from customer where idcustomer=2\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13135069,"title":"Why calling a function takes much more time than direct execution of function code","body":"<p>In my SQL Server 2008 R2 database, I have a query which calls a function. </p>\n\n<p>Lately this query has started to execute very slowly. I found that the user-defined function is hampering all the query. </p>\n\n<p>I tried to execute this function alone and it took 40 seconds to finish, while previously it executed in 3-4 seconds. So I tried to execute code that is inside of function and executed in this 3-4 seconds. </p>\n\n<p>I cannot understand why executing code of function takes far fewer time than calling function itself. I tried all this in SSMS only.</p>\n\n<p>That's the function itself</p>\n\n<pre><code>ALTER FUNCTION [dbo].[fn_SI_GetMark] (@AREA_ID int, @BD datetime, @ED datetime)  \nRETURNS decimal(24, 2) AS  \nBEGIN \n\n\n\nDeclare @mon int;\nset @Mon = 1;\nif(DateDiff(day, @BD, @ED) &gt; 40)\nbegin\n\ndeclare @q1sb datetime; set @q1sb = Convert(datetime, '01.01.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q1eb datetime; set @q1eb = Convert(datetime, '01.04.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q2sb datetime; set @q2sb = Convert(datetime, '01.04.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q2eb datetime; set @q2eb = Convert(datetime, '01.07.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q3sb datetime; set @q3sb = Convert(datetime, '01.07.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q3eb datetime; set @q3eb = Convert(datetime, '01.10.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q4sb datetime; set @q4sb = Convert(datetime, '01.10.'+Convert(nvarchar(4), Year(@BD)));\ndeclare @q4eb datetime; set @q4eb = Convert(datetime, '01.01.'+(Convert(nvarchar(4), Year(@BD) + 1)));\nif((@BD &gt;= @q1sb) and (@BD &lt; @q1eb))\nbegin\n    set @BD = @q1sb;\nend\nelse if((@BD &gt;= @q2sb) and (@BD &lt; @q2eb))\nbegin\n    set @BD = @q2sb;\nend\nelse if((@BD &gt;= @q3sb) and (@BD &lt; @q3eb))\nbegin\n    set @BD = @q3sb;\nend\nelse if((@BD &gt;= @q4sb) and (@BD &lt; @q4eb))\nbegin\n    set @BD = @q4sb;\nend\n\n\n\ndeclare @q1se datetime; set @q1se = Convert(datetime, '01.01.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q1ee datetime; set @q1ee = Convert(datetime, '01.04.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q2se datetime; set @q2se = Convert(datetime, '01.04.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q2ee datetime; set @q2ee = Convert(datetime, '01.07.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q3se datetime; set @q3se = Convert(datetime, '01.07.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q3ee datetime; set @q3ee = Convert(datetime, '01.10.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q4se datetime; set @q4se = Convert(datetime, '01.10.'+Convert(nvarchar(4), Year(@ED)));\ndeclare @q4ee datetime; set @q4ee = Convert(datetime, '01.01.'+(Convert(nvarchar(4), Year(@ED) + 1)));\nif((@ED &gt;= @q1se) and (@ED &lt;= @q1ee))\nbegin\n    set @ED = @q1ee;\nend\nelse if((@ED &gt;= @q2se) and (@ED &lt;= @q2ee))\nbegin\n    set @ED = @q2ee;\nend\nelse if((@ED &gt;= @q3se) and (@ED &lt;= @q3ee))\nbegin\n    set @ED = @q3ee;\nend\nelse if((@ED &gt;= @q4se) and (@ED &lt;= @q4ee))\nbegin\n    set @ED = @q4ee;\nend\n\n\nset @Mon = datediff(month, @BD, @ED) / 3;\n\nend\n\n\ndeclare @i int;\n\nDECLARE @Mark decimal(24, 2); SET @Mark = 0;\ndeclare @count int; SET @count = 0;\n\nDECLARE @AREA_PATH nvarchar(max), @SI_CheckListId int, @SI_CheckListTitle nvarchar(max), @SI_CheckListCreatedBy int;\n\n\nDECLARE @Mark2 decimal(24, 2); set @Mark2 = 0;\ndeclare @count2 int; SET @count2 = 0;\n\n\n\nDECLARE @areaIdStr nvarchar(max);\nset @areaIdStr = convert(nvarchar(max), @AREA_ID);\n\n\nDECLARE db_cursor_rights2 CURSOR\nfor\nSELECT     tbl_SI_CheckList.SI_CheckListId\nFROM         tblArea INNER JOIN\n                  tbl_SI_CheckList ON tblArea.AREA_ID = tbl_SI_CheckList.AreaId\nWHERE ('%/'+tblArea.AREA_PATH+'/%' like '%/'+@areaIdStr+'/%') \nand (((tbl_SI_CheckList.SI_CheckListIsDeleted &lt;&gt; 1) and (tbl_SI_CheckList.SI_CheckListDateCreated &lt;= @ED))\n    or  \n    ((tbl_SI_CheckList.SI_CheckListIsDeleted = 1) and (tbl_SI_CheckList.SI_CheckListDateDeleted is not null) and (tbl_SI_CheckList.SI_CheckListDateDeleted &gt;= @BD) and (tbl_SI_CheckList.SI_CheckListDateCreated &lt;= @ED)))\n\n\nOPEN db_cursor_rights2;  \nFETCH NEXT FROM db_cursor_rights2\nINTO @SI_CheckListId;\nWHILE @@FETCH_STATUS = 0\nBEGIN   \n\n\n    set @i = 1\n    while @i &lt;= @Mon\n    begin\n        set @Mark2 = 0\n        set @count2 = 0\n\n        SELECT     @Mark2 = @Mark2 + Mark\n        FROM       tbl_SI_CheckListRegistr\n        WHERE     (SI_CheckListId = @SI_CheckListId) and ((tbl_SI_CheckListRegistr.DateCreated &gt;= @BD) and (tbl_SI_CheckListRegistr.DateCreated &lt; @ED) and (tbl_SI_CheckListRegistr.IsDeleted &lt;&gt; 1))\n\n        if(@Mark2 is not null)\n        begin \n            set @Mark = @Mark + @Mark2;\n        end\n        set @i = @i + 1;    \n\n        SELECT     @count2 = count(Mark)\n        FROM       tbl_SI_CheckListRegistr\n        WHERE     (SI_CheckListId = @SI_CheckListId) and ((tbl_SI_CheckListRegistr.DateCreated &gt;= @BD) and (tbl_SI_CheckListRegistr.DateCreated &lt; @ED) and (tbl_SI_CheckListRegistr.IsDeleted &lt;&gt; 1))\n\n        if(@count2 = 0)\n        begin \n            set @count2 = @count2 + 1;\n        end \n\n        set @count = @count + @count2;      \n\n    end\n\n    FETCH NEXT FROM db_cursor_rights2\n    INTO @SI_CheckListId;\n\nEND\nCLOSE db_cursor_rights2;\nDEALLOCATE db_cursor_rights2;\n\nif(@count = 0)\nbegin\nset @count = 1;\nend\n\nset @Mark = round(@Mark/@count, 2)\n\nRETURN (@Mark)\n\n\nEND\n</code></pre>\n\n<p>and this is how i try to call it</p>\n\n<pre><code>DECLARE @AREA_ID int; SET @AREA_ID=1;\nDECLARE @BD datetime, @ED datetime;\nSET @BD=cast('2012-10-01' AS DATETIME);\nSET @ED=cast('2012-11-01' AS DATETIME);\nDECLARE @MArk decimal(24,2);\nset @Mark = (select dbo.fn_SI_GetMark(@AREA_ID, @BD, @ED));\nPRINT @Mark\n</code></pre>\n\n<p>Else one thing, i tried to execute this function on another dbserver (there is replication set up between this two servers) and it executes very fast. And another one observation if i call function without parameters, set them in function directly, it is also executes fast.</p>\n"},{"tags":["sql","tsql","casting","decimal"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":104,"score":2,"question_id":13127326,"title":"Use Cast() function in where clause - T-SQL","body":"<p>I am trying to use a CAST() function in the where clause of a query. Basically I have a FieldA in TableA that is typed as Decimal(10,0), and a FieldB in TableB that is typed as CHAR, and I would like to join the two tables on the conditions that Fields A and B are identical.</p>\n\n<p>I have tried a simple</p>\n\n<pre><code>select FieldA , FieldB from tableA left join tableB \non cast(FieldB as decimal(10,0))= FieldA\n</code></pre>\n\n<p>But it returns an error</p>\n\n<blockquote>\n  <p>character non admitted in the CAST clause</p>\n</blockquote>\n\n<p>EDIT this was a bad translation from french, the right translation seems to be</p>\n\n<blockquote>\n  <p>invalid character value for cast specification</p>\n</blockquote>\n\n<p>(thx Alex K)</p>\n\n<p>I then tried to do something like</p>\n\n<pre><code>select tableA.fieldA, tableC.fieldC\nfrom tableA left join\n(select cast(fieldB as decimal(10,0)) fieldC from tableB)\nas tableC on fieldC=fieldA\n</code></pre>\n\n<p>But I have the same error being returned</p>\n\n<p>I am really not an expert in SQL and basically just use a few SELECTs here and there, tried to look around for similar problems but can't see an answer that matches my problem.</p>\n\n<p>Anyone have an idea ? Thanks </p>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13066509,"title":"can anyone please help me understand this query?","body":"<p>Can anyone help me understand this query? The <code>mktpgmvhclxref.mktpgmvhclxrefId.mktgPgm</code> part mostly. Generally it is <code>table_name.columnName</code> but here the format seems to be different </p>\n\n<pre><code>SELECT mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm, \n       mktpgm.mktgpgm, \n       mktpgmvhclxref.cmpgn, \n       campaign.cmpgndescription, \n       mktpgmvhclxref.mktpgmvhclxrefid.vhcl, \n       vhclhierarchy.modname, \n       mktpgmvhclxref.mktpgmvhclxrefid.modyr, \n       mktpgmvhclxref.userinsrt, \n       mktpgmvhclxref.rowinsrt \nFROM   mktpgmvhclxref mktpgmvhclxref, \n       mktpgm mktpgm, \n       vhclhierarchy vhclHierarchy, \n       campaign campaign \nWHERE  mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm = mktpgm.idmktgpgm \n       AND mktpgmvhclxref.cmpgn = campaign.campaignid \n       AND mktpgmvhclxref.mktpgmvhclxrefid.vhcl = vhclhierarchy.vhcl \n</code></pre>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13139189,"title":"SQL set Table 1 COL A = Table 2 COL B if Table 1 COL C = Table 2 COL D","body":"<p>I have two tables</p>\n\n<p><strong>Table1</strong></p>\n\n<pre><code>REF1 REF2\n     A\n     B\n     C\n</code></pre>\n\n<p><strong>Table2</strong></p>\n\n<pre><code>UPN Filename\n1   A\n2   B\n3   C\n</code></pre>\n\n<p>what I want to do in SQL is this</p>\n\n<blockquote>\n  <p>If Table1 REF2 = Table2 Filename then set Table1 REF1 = Table2 UPN</p>\n</blockquote>\n\n<p>this is the sql I did</p>\n\n<pre><code>UPDATE    Table1\nSET       REF1 = Table2.UPN\nFROM      Table1 INNER JOIN Table2 \nON        Table1.REF2 = Table2.FileName \n</code></pre>\n\n<p>all this does is take the first value in row 1 of table2 and put it in every row under table1 in <code>REF1</code></p>\n\n<p>eg this is what I get </p>\n\n<p><strong>TABLE1</strong></p>\n\n<pre><code>REF1 REF2\n1    A\n1    B\n1    C\n</code></pre>\n\n<p>this is what I want</p>\n\n<p><strong>TABLE1</strong></p>\n\n<pre><code>REF1 REF2\n1    A\n2    B\n3    C\n</code></pre>\n\n<p>any help appreciated.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13139140,"title":"SQL Server 2008 Calculation Bug","body":"<p>Here is the query i am running</p>\n\n<pre><code>Select (100/18)*18\n</code></pre>\n\n<p>The answer i get is 90. I have tried declaring each of the numbers as decimals also, and i get the value <code>100.0008</code>, but when i calculate with variables as floats the answer is correct at '100' so does anyone have any idea why SQL calculates like this?</p>\n"},{"tags":["mysql","sql","utf-8","phpmyadmin","mediawiki"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13138087,"title":"How to edit invalid UTF-8 strings in mysql database","body":"<p>I have some utf-8 strings in my database, they are stored as varbinary. (Generally, it's mediawiki database, but that's not important, i think). I found that some strings are not in a good shape, then i make </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT  log_comment, CONVERT( log_comment\nUSING utf8 ) AS \nCOMMENT \nFROM  `logging` \nWHERE log_id = %somevalue%\n</code></pre>\n\n<p>i have output table in phpmyadmin like this:</p>\n\n<pre><code>-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| d093d09ed0a1d0a220d0a020d098d0a1d09e2fd09cd0add09a20393239342d39332e20c2abd098d0bdd184d0bed180d0bcd0b0d186d0b8d0bed0bdd0bdd0b0d18f20d182d0b5d185d0bdd0bed0bbd0bed0b3d0b8d18f2e2e2e    |NULL |\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n</code></pre>\n\n<p>What i need is to make this string readible, or upload new string with correct data. But this is varbinary field, how can i manage data inside it?</p>\n\n<p><strong>UPD:</strong>\nfound that phpmyadmin automatically added 2e2e2e for three dots at the end of each line - they were too long to show.  Original binary data are, if somebody interested, </p>\n\n<pre><code>d09fd0a02035302e312e3031392d3230303020d09ed181d0bdd0bed0b2d0bdd18bd0b520d0bfd0bed0bbd0bed0b6d0b5d0bdd0b8d18f20d0b5d0b4d0b8d0bdd0bed0b920d181d0b8d181d182d0b5d0bcd18b20d0bad0bbd0b0d181d181d0b8d184d0b8d0bad0b0d186d0b8d0b820d0b820d0bad0bed0b4d0b8d180d0bed0b2d0b0d0bdd0b8d18f20d182d0b5d185d0bdd0b8d0bad0be2dd18dd0bad0bed0bdd0bed0bcd0b8d187d0b5d181d0bad0bed0b920d0b820d181d0bed186d0b8d0b0d0bbd18cd0bdd0bed0b920d0b8d0bdd184d0bed180d0bcd0b0d186d0b8d0b820d0b820d183d0bdd0b8d184d0b8d186d0b8d180d0bed0b2d0b0d0bdd0bdd18bd1\n</code></pre>\n\n<p>anyway those strings contains non-utf symbols at the line end, as it seems from </p>\n\n<pre><code>SELECT log_comment,CAST(log_comment AS CHAR CHARACTER SET utf8) AS COMMENT\nFROM  `logging` \nWHERE log_id = %somevalue%\n</code></pre>\n\n<p>because last symbol is � - for me it seems as black rhomb with white question in it, and last 20-30 characters are missing</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13138194,"title":"Dependency on master and child in SQL","body":"<p>I have a master table like this</p>\n\n<pre><code>Product    Status  Product id\nA          True     1\nB          True     2\nC          true     3\nD          True     4\nE          false    5\nF          True     6\n</code></pre>\n\n<p>Now I have other table which is giving me the dependency of the product</p>\n\n<pre><code>Product    DependencyId\nC             2\nC             5\nE             1\nB             4\nB             6\n</code></pre>\n\n<p>Now when I searching for C, I can see that two products are dependent upon C now these two product is dependent upon other products.</p>\n\n<p>And let say I am searching for E, then I there are only one dependency of the product.</p>\n\n<p>Now, I need to check for a product that if any dependency is false or not. If any of the dependency is false then I have to return some text/value.</p>\n\n<p><strong>Result</strong></p>\n\n<pre><code>When product is C then output will be E (because the grand children of C (i.e. E) has false)\n\nWhen product is B then output will be NULL (becuase none of the child of B or their sub childrens has false)\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13137246,"title":"Column in table is of a type that is invalid for use as a key column in an index","body":"<p>I have a table where I am storing employee details. I want to alter the table and set one of the column <code>emp_code</code> as primary key. Its datatype is <code>nvarchar(max)</code>, but I am not able to set it as primary key.</p>\n\n<p>I run the following query : </p>\n\n<pre><code>ALTER TABLE user_master\nADD PRIMARY KEY (emp_code)\n</code></pre>\n\n<p>but it gives me an error :</p>\n\n<blockquote>\n  <p><em>Msg 1919, Level 16, State 1, Line 1</em><br>\n  <em>Column <code>emp_code</code> in table <code>user_master</code> is of a type that is invalid for use as a key column in an index.</em><br>\n  <em>Msg 1750, Level 16, State 0, Line 1</em><br>\n  <em>Could not create constraint. See previous errors.</em></p>\n</blockquote>\n\n<p>How can I overcome this?</p>\n"},{"tags":["sql","oracle","query","plsql","plsqldeveloper"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":56,"score":-1,"question_id":13138534,"title":"How to handle large string coming as an input parameter to the procedure?","body":"<p>I am getting 200 Supplier names as an input parameter with huge values to the stored procedure.I tried declaring in CLOB,VARCHAR2(32767).But when i try to execute it is not accepting.\nPlease anyone help me how to handle this   .</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE GMMT_PROC.or_rmce_RB_grid_sp (\n   p_plant_cd        IN VARCHAR2,\n   p_region_cd       IN VARCHAR2,\n   p_matrl_nbr       IN OUT VARCHAR2,\n   p_supplier_nbr    IN OUT VARCHAR2,\n   p_supplier_name   IN OUT CLOB,\n   p_mrpcontrollercd IN OUT VARCHAR2,\n   p_currency        IN   VARCHAR2,\n   oresultset        OUT  sys_refcursor,\n   p_err_cd          OUT  NUMBER,\n   p_err_msg         OUT  VARCHAR2\n)\nIS\nsqlquery varchar2(10000);\np1 varchar2(10);\np2 varchar2(20);\np3 varchar2(20);\np4 varchar2(20);\nv_percent varchar2(10):='%';\nV_FROM_CURRENCY VARCHAR2(5);\nV_EX_RATE NUMBER;\nv_matrl_nbr       VARCHAR2(10000);\nv_supplier_nbr    VARCHAR2(10000);\nv_supplier_name   CLOB;\nv_mrpcontrollercd  VARCHAR2(10000);\n\nBEGIN\np1:='matrl_nbr';\n v_matrl_nbr:=p_matrl_nbr;\n p2:='supplier_nbr';\n v_supplier_nbr :=p_supplier_nbr;\n p3:='supplier_name_txt';\n v_supplier_name :=p_supplier_name;\n p4:='mrp_controller_cd';\n v_mrpcontrollercd:=p_mrpcontrollercd; \nsqlquery:='select wk_nbr, nbr_working_days,'||p1||' as matrl_nbr ,'||p2||' as supplier_nbr,'||p3||' as supplier_name_txt,'||p4||' as mrp_controller_cd,sum(reqmnt_qty)reqmnt_qty , sum(proj_inven_qty)proj_inven_qty, sum(doh) doh,sum(proj_recpt_1) proj_recpt_1, sum(proj_recpt_2) proj_recpt_2, sum(proj_recpt_3) proj_recpt_3, sum(proj_recpt_4) proj_recpt_4,sum( proj_recpt_total_qty) proj_recpt_total_qty,sum(consumption_qty) consumption_qty, sum(consumption_var_qty) consumption_var_qty , sum(final_recpt_qty) final_recpt_qty,sum(recpt_var_qty) recpt_var_qty from GMMT_OWNER.OR_RMCE_GTT_PROJ_RECPT_T ';\nsqlquery:=sqlquery||' where ('''||v_matrl_nbr||''' IS NULL) OR matrl_nbr IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_matrl_nbr||'''))) OR matrl_nbr like '''|| v_matrl_nbr||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_supplier_nbr||''' IS NULL) OR supplier_nbr IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_supplier_nbr||'''))) OR supplier_nbr like '''|| v_supplier_nbr||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_supplier_name||''' IS NULL) OR supplier_name_txt IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_supplier_name||'''))) OR supplier_name_txt like '''|| v_supplier_name||v_percent||'''';\nsqlquery:=sqlquery||' AND ('''||v_mrpcontrollercd||''' IS NULL) OR mrp_controller_cd IN (SELECT * FROM TABLE(GMMT_PROC.OR_in_list_RPT5_FN('''||v_mrpcontrollercd||'''))) OR mrp_controller_cd like '''|| v_mrpcontrollercd||v_percent||'''';\nsqlquery:=sqlquery||' group by wk_nbr, nbr_working_days,'||p1||','||p2||','||p3||','||p4||' order by wk_nbr';\n\nOPEN oresultset FOR sqlquery;\n\ndbms_output.put_line(sqlquery);\nEND;                \n</code></pre>\n"},{"tags":["asp.net","sql","connection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13137718,"title":"How do I write SQL connection string?","body":"<p>I have this as my connection string property: </p>\n\n<pre><code>Data Source=\"c:\\users\\perdanny\\documents\\visual studio 2012\\Projects\\WebApplication1\\WebApplication1\\App_Data\\Users.sdf\"\n</code></pre>\n\n<p>Now, how should I write it in my code:</p>\n\n<pre><code>sqlConnection = new SqlConnection(???);\n</code></pre>\n"},{"tags":["c#","sql","sql-server","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13138615,"title":"SqlDataAdapter does not fill DataSet","body":"<p>I'm using VS2012 and SQL Server Express 2008.  I've boiled down my connection/query to try and find out why my <code>DataSet</code> is not being filled.  The connection is completed successfully, and no exceptions are thrown, but the adapter does not fill the <code>DataSet</code>. The database that this is pulling from is on the same PC and using <code>localhost\\SQLEXPRESS</code> does not change the result.  Thanks for any input!</p>\n\n<pre><code>SqlConnection questionConnection = new SqlConnection(ConfigurationManager.ConnectionStrings[\"DefaultConnection\"].ConnectionString);\nquestionConnection.Open();\nString sql = \"SELECT * FROM HRA.dbo.Questions\";\nSqlDataAdapter adapter = new SqlDataAdapter();\nDataSet ds = new DataSet();\nSqlCommand command = new SqlCommand(sql, questionConnection);\nadapter.SelectCommand = command;\nadapter.Fill(ds);\nadapter.Dispose();\ncommand.Dispose();\nquestionConnection.Close();\n</code></pre>\n\n<p>Connection String:</p>\n\n<pre><code>&lt;add name=\"DefaultConnection\" providerName=\"System.Data.SqlClient\" connectionString=\"Data Source=CODING-PC\\SQLEXPRESS;Initial Catalog=HRA;User ID=sa; Password= TEST\" /&gt;\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":44,"score":2,"question_id":13133208,"title":"MySQL Order by Two Columns","body":"<p>I have a Table Like Below</p>\n\n<pre>\n\n    CREATE TABLE Products(Product_id INT, ProductName VARCHAR(255), \n                          Featured enum('Yes', 'No'), Priority enum('p1', 'p2', 'p3'))\n\n\n    INSERT INTO Products(ProductName, Featured, Priority) \n                  VALUES('Product A', 'Yes', 'p1'),\n                        ('Product B', 'No',  'p2'),\n                        ('Product C', 'Yes', 'p1'),\n                        ('Product D', 'No',  'p1'),\n                        ('Product E', 'Yes', 'p3'),\n                        ('Product F', 'No',  'p2'),\n                        ('Product G', 'Yes', 'p1'),\n                        ('Product H', 'Yes', 'p2'),\n                        ('Product I', 'No',  'p2'),\n                        ('Product J', 'Yes', 'p3'),\n                        ('Product K', 'Yes', 'p1'),\n                        ('Product L', 'No',  'p3');\n\n\n</pre>\n\n<p>I Need to get the Featured products followed by product with priority p1, p2 and p3 </p>\n\n<pre>\n\nOp:\n   ProdName | Featured  | Priority\n\n    Product A   Yes         p1\n    Product C   Yes         p1\n    Product G   Yes         p1\n    Product K   Yes         p1\n    Product H   Yes         p2\n    Product E   Yes         p3\n    Product J   Yes         p3\n    Product D   No          p1\n    Product B   No          p2\n    Product F   No          p2\n    Product I   No          p2\n    Product L   No          p3\n\n</pre>\n\n<p>I Wrote a query below which ain't working..</p>\n\n<pre>                                           \n  SELECT * \n    FROM Products\n   ORDER BY Featured IN ('Yes') desc,\n            Priority IN ('p1', 'p2', 'p3') desc\n</pre>\n\n<p>Could u plz spot mistake in that</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13071948,"title":"SQL: selecting 5 urls, with least visited domains as fast as possible","body":"<p>I have <code>url_stack</code> table with <code>urlid</code> and <code>domainid</code> and a <code>domain_stack</code> table with <code>domainid</code> and <code>domain_count</code>.</p>\n\n<p><code>url_stack</code> has <code>urlid</code> as its primary key and a <code>BTREE</code> index on <code>domainid</code>. <code>domain_stack</code> has <code>domainid</code> as its primary and a <code>BTREE</code> index on <code>domain_count</code>.</p>\n\n<p>I constantly add urls to the stack. When popping a url from the stack, I add <code>1</code> to its <code>domain_count</code>.</p>\n\n<p>When I pop a url, I keep the count of its domain, this why there are many domains doesn't have any url (this is why @moj answer is faulty).</p>\n\n<p>When popping I would like to select a <code>url</code> for each of the available <code>domain_counts</code> and limit myself to the top 5.</p>\n\n<p>for example, a common result would be:</p>\n\n<pre><code>+------------+------------+--------------+\n| urlid      | domainid   | domain_count |\n+------------+------------+--------------+\n|  852336945 | -184315873 |            1 |\n| 1930023009 |  -43391685 |            2 |\n| -112137768 | 1607144692 |            4 |\n| 1673460622 |  567460239 |            8 |\n|  612511843 | 1444323871 |           11 |\n+------------+------------+--------------+  \n5 rows in set (5.37 sec)\n</code></pre>\n\n<p>By invoking:</p>\n\n<pre><code>SELECT urlid,domain_stack.domainid,domain_stack.domain_count\nFROM  domain_stack\nINNER JOIN url_stack\nON url_stack.domainid = domain_stack.domainid\nGROUP BY domain_stack.domain_count LIMIT 5;\n</code></pre>\n\n<p>The problem is this is way too slow - I have to get under a 0.5 second per query. How should I change my query / my tables to make this faster?</p>\n\n<p><em>EDIT</em>: here's a link describing the situation <a href=\"http://sqlfiddle.com/#!2/70ded/1/0\" rel=\"nofollow\">http://sqlfiddle.com/#!2/70ded/1/0</a></p>\n"},{"tags":["android","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13138480,"title":"Android login error with SQL Server","body":"<p>Iam a new beginner in android programming. I have designed a login screen ,But have a problem in database connection. I know that JSOn is used for database but i am beginner and want to connect with SQL Server,Kindly help me programmers</p>\n\n<p>Activity Layout</p>\n\n<pre><code>&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\" &gt;\n\n    &lt;EditText\n        android:id=\"@+id/userid\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_alignParentTop=\"true\"\n        android:layout_centerHorizontal=\"true\"\n        android:layout_marginTop=\"87dp\"\n        android:ems=\"10\" &gt;\n\n        &lt;requestFocus /&gt;\n    &lt;/EditText&gt;\n\n    &lt;EditText\n        android:id=\"@+id/password\"\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:layout_below=\"@+id/userid\"\n        android:layout_centerHorizontal=\"true\"\n        android:layout_marginTop=\"39dp\"\n        android:ems=\"10\"\n        android:inputType=\"textPassword\" /&gt;\n\n    &lt;Button\n        android:id=\"@+id/button1\"\n        android:layout_width=\"120dp\"\n        android:layout_height=\"wrap_content\"\n        android:layout_below=\"@+id/password\"\n        android:layout_centerHorizontal=\"true\"\n        android:layout_marginTop=\"24dp\"\n        android:text=\"Button\" /&gt;\n\n&lt;/RelativeLayout&gt;\n</code></pre>\n\n<p>Java Code for Connecting with database, Kindly find the flaws </p>\n\n<pre><code>package com.example.mts;\n\nimport java.sql.*;\n\nimport com.example.mts.HomepageMainActivity;\n\nimport android.os.Bundle;\nimport android.app.Activity;\nimport android.app.AlertDialog;\nimport android.content.Intent;\nimport android.view.Menu;\nimport android.view.View;\nimport android.view.View.OnClickListener;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\npublic class HomepageMainActivity extends Activity {\n    String url=\"jdbc:microsoft:sqlserver://10.0.2.2:1433;DatabaseName=swingmail\";\n    String user=\"sa\";\n    String pwd=\"sa\";\n    Statement st;\n    Button button1;\n     EditText userid,pwd1;\n     String pass,userid1;\n    Connection con=null;\n    ResultSet rs=null;\n    public void login(String userid1, String pass) {\n        // TODO Auto-generated method stub\n        try{\n\n            new AlertDialog.Builder(getApplicationContext()).setTitle(\"Error\").setMessage(\"userid/Password is Empty or Wrong\").setNeutralButton(\"Close\", null).show();\n            Class.forName(\"com.microsoft.jdbc.sqlserver.SQLServerDriver\");\n            con=DriverManager.getConnection(url, user, pwd);\n            st=con.createStatement();\n             String str=\"select userrole from usermaster where m_loginid='\"+userid1+\"'and m_password='\"+pass+\"'\" ;\n            //st.executeQuery(str);\n            rs=st.executeQuery(str);\n            //Toast.makeText(getApplicationContext(),\"Wrng\", 5).show();\n            while(rs.next()){\n                 String  userrole1= rs.getString(1);\n            if((userrole1.equalsIgnoreCase(\"admin\"))||(userrole1.equalsIgnoreCase(\"student\"))||(userrole1.equalsIgnoreCase(\"librarian\"))){\n\n                    Intent obj=new Intent(this,MainActivity.class);\n                    startActivity(obj);\n            }\n            else{\n\n                new AlertDialog.Builder(getApplicationContext()).setTitle(\"Error\").setMessage(\"userid/Password is Empty or Wrong\").setNeutralButton(\"Close\", null).show();\n\n            }\n        }\n        }\n            catch(Exception e){\n                e.printStackTrace();\n            }\n    }\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_homepage_main);\n       userid=(EditText)findViewById(R.id.userid);\n     userid1=userid.getText().toString();\n       pwd1=(EditText)findViewById(R.id.password);\n       pass=pwd1.getText().toString();\n       button1=(Button)findViewById(R.id.button1);\n       button1.setOnClickListener(new OnClickListener() {\n\n\n        public void onClick(View v) {\n            // TODO Auto-generated method stub\n\n            Toast.makeText(getApplicationContext(),\"PleaseWait\", 5).show();\n            login(userid1,pass);\n        }\n\n\n    });\n    }\n\n    @Override\n    public boolean onCreateOptionsMenu(Menu menu) {\n        getMenuInflater().inflate(R.menu.activity_homepage_main, menu);\n        return true;\n    }\n}\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4715,"score":2,"question_id":4655981,"title":"SQL Server - use Exists clause in Where and Select","body":"<p>I have a view that's something like</p>\n\n<pre><code>CREATE VIEW OrdersView WITH SCHEMABINDING AS\nSELECT o.Id, o.OrderDate, o.LastName, o.TotalPrice, s.Status\nFROM dbo.Orders o INNER JOIN dbo.OrderStatus s on o.Id = s.OrderId\nWHERE NOT EXISTS (SELECT NULL from dbo.OrderStatus where OrderId = s.OrderId and StatusDate &gt; s.StatusDate\nAND EXISTS (SELECT NULL FROM dbo.OrderLineItemType1 WHERE OrderId = o.Id)\n</code></pre>\n\n<p>The intent is to fetch all orders that have at least one line item of type 1 along with their current status.</p>\n\n<p>We're in the process of adding a second type of line item, and I have modified the view such that it will include orders that have at least one line item of type 1 or type 2:</p>\n\n<pre><code>CREATE VIEW OrdersView WITH SCHEMABINDING AS\nSELECT o.Id, o.OrderDate, o.LastName, o.TotalPrice, s.Status\nFROM dbo.Orders o INNER JOIN dbo.OrderStatus s on o.Id = s.OrderId\nWHERE NOT EXISTS (SELECT NULL from dbo.OrderStatus where OrderId = s.OrderId and StatusDate &gt; s.StatusDate\nAND (EXISTS (SELECT NULL FROM dbo.OrderLineItemType1 WHERE OrderId = o.Id)\n  OR EXISTS (SELECT NULL FROM dbo.OrderLineItemType2 WHERE OrderId = o.Id))\n</code></pre>\n\n<p>Easy enough, but I've just had a requirement added to show whether an order contains line items of type 1 or type 2 (or both) in the grid where these results are displayed:</p>\n\n<pre>\nOrder ID | T1 | T2 | Last name | Price    | Status\n============================================================\n12345    | x  |    | Smith     | $100.00  | In Production\n12346    | x  | x  | Jones     | $147.23  | Part Dispatched\n12347    |    | x  | Atwood    | $12.50   | Dispatched\n</pre>\n\n<p>The only way I can think of is to do:</p>\n\n<pre><code>CREATE VIEW OrdersView WITH SCHEMABINDING AS\nSELECT o.Id, \n       CASE WHEN EXISTS (SELECT NULL FROM dbo.OrderLineItemType1 WHERE OrderID = o.Id) THEN 1 ELSE 0 END AS HasType1,\n       CASE WHEN EXISTS (SELECT NULL FROM dbo.OrderLineItemType2 WHERE OrderId = o.ID) THEN 1 ELSE 0 END AS HasType2,\n       o.OrderDate, o.LastName, o.TotalPrice, s.Status\nFROM dbo.Orders o INNER JOIN dbo.OrderStatus s on o.Id = s.OrderId\nWHERE NOT EXISTS (SELECT NULL from dbo.OrderStatus where OrderId = s.OrderId and StatusDate &gt; s.StatusDate\nAND (EXISTS (SELECT NULL FROM dbo.OrderLineItemType1 WHERE OrderId = o.Id)\n  OR EXISTS (SELECT NULL FROM dbo.OrderLineItemType2 WHERE OrderId = o.Id))\n</code></pre>\n\n<p>But this smells wrong with the duplication of the <code>EXISTS</code> clauses.  Is there a better qway to write it?  Can I make it perform better?</p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":9704070,"title":"Calculate totals of field based on current fiscal year only - SQL","body":"<p>I have seen many examples regarding calculating the sum of fields using the fiscal year, but I can not find one that fits my needs.  What I am trying to do is get just the current fiscal year totals for a field using SQL Query.  The fields I have is userid, startdate, total_hours, and missed_hours.  Here is the query I have so far:</p>\n\n<pre><code>SELECT    \nuserid,    \nSUM(total_hours) - SUM(missed_hours) AS hours    \nFROM mytable    \nGROUP BY userid\n</code></pre>\n\n<p>This works great, but all I need is the total number of hours for the current fiscal year for each of the userid's.  Our fiscal year runs from July to June.  I only need the current fiscal year and I need it to start over again this coming July.</p>\n"},{"tags":["mysql","sql","json","hierarchical"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":84,"score":4,"question_id":12922859,"title":"Single mysql select on join tables to a json hierarchical fragment, how?","body":"<p>What would be the best and most elegant way to retrieve from <strong>a single</strong> MySQL select query all the information from two joined tables, but in a hierarchical way?</p>\n\n<p>I have those two tables:</p>\n\n<pre><code>-----------------         ------------------\n| Table COMPANY |         | Table EMPLOYEE |\n-----------------         ------------------\n| id            |         | id             |\n| companyName   |         | companyId      |\n-----------------         | employeeName   |\n                          ------------------\n\n(for each company, many employees)\n</code></pre>\n\n<p>and I want to output the following hierarchical JSON fragment:</p>\n\n<pre><code>[\n    {\"id\": 1,\n     \"companyName\": \"Company A\",\n     \"employees\": [\n         {\"id\": 1, \"employeeName\": \"Employee 1\"},\n         {\"id\": 2, \"employeeName\": \"Employee 2\"}\n    ]},\n    {\"id\": 2,\n     \"companyName\": \"Company B\",\n     \"employees\": [\n         {\"id\": 3, \"employeeName\": \"Employee 3\"},\n         {\"id\": 4, \"employeeName\": \"Employee 4\"}\n    ]}\n]\n</code></pre>\n\n<h2>\"Solution\" 1:</h2>\n\n<p>Do a full select on the joined tables, and write some code after to create the json fragment:</p>\n\n<pre><code>select * from company, employee where employee.companyId = company.id;\n</code></pre>\n\n<p>Problem: I'm left with a lot of ugly foreach-type code to create the json fragment</p>\n\n<h2>\"Solution\" 2:</h2>\n\n<p>Group by company all employees in a json string:</p>\n\n<pre><code>select company.id, company.name,\n   concat('[',\n      group_concat('{\"id\": ', employee.id, ',\n         \"employeeName\": \"', employee.employeeName,'\"}'), ']') as employees\nfrom company, employee where company.id = employee.companyId\ngroup by company.id\n</code></pre>\n\n<p>Here, \"employees\" is already a json fragment, I only have to jsonify the company.id and name. <strong>But</strong> to build the json fragment in the mysql seems very bad practice.</p>\n\n<p>Any insight, or other solution?</p>\n\n<p>Many thanks</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":503,"score":1,"question_id":10604275,"title":"Fiscal Year To-Date in Where Clause (T-SQL)","body":"<p>Company's Fiscal Year: July 1 - June 30</p>\n\n<p>I have a query where I am trying to capture aggregate # of units and $ revenue by product and cost center for the fiscal year-to-date.  It will run on the 1st of the month and look through the last day of the previous month.  Fiscal year does not appear in the report - it is criteria.</p>\n\n<pre><code>    Mix of pseudocode and SQL:\n    Where\n      If datepart(mm,getdate()) - 1 &lt; 7\n        THEN \n           transaction_post_date BETWEEN 7/1/ previous year AND dateadd(day,-(day(getdate()),getdate())          \n        Else \n           transaction_post_date BETWEEN 7/1/current year AND dateadd(day,-(day(getdate()),getdate())          \n</code></pre>\n\n<p>Am I on the write track?  How do I write the SQL for a specific date on a year that depends on SQL - 7/1/current year?  </p>\n\n<p>I am weak using variables and do not even know if I have access to create them on the SQL Server DB, which is rather locked down.  Definitely can't create a function.  (I'm a business analyst.)</p>\n\n<p>UPDATE, Fiscal year goes forward, so July 1, 2010, is Fiscal Year 2011.</p>\n\n<p>I think this works:</p>\n\n<pre><code>    Year(dateadd(month,6,htx.tx_post_date)) = Year(DateAdd(Month, 5, GetDate()))\n</code></pre>\n\n<p>Feeback?</p>\n\n<p>And now I've been asked to add Fiscal Year-To-Date fields for quantity and revenue to the following query which gave me totals for </p>\n\n<pre><code>    Select \n      inv.ITEM_CODE \n    , inventory.ITEM_NAME \n    , cc.COST_CENTER_CODE \n    , tx.REV_CODE_ID \n    , tx.PRICE \n    , tx.ITEM_SALE_ID\n    , sum(tx.quantity)\n    , sum(tx.amount)\n\n    from\n    transactions tx\n    inner join inventory inv on inv.item_id = tx.item_id\n    left outer join cost_center cc on cc.cost_center_id = tx.cost_center_id\n\n    where \n    DATEPART(mm, tx.tx_date) = DATEPART(mm,dateadd(m,-1,getdate()))\nand DATEPART(yyyy, tx.tx_date) = DATEPART(yyyy,dateadd(m,-1,getdate()))\n\n    group by \n      inv.ITEM_CODE \n    , inventory.ITEM_NAME \n    , cc.COST_CENTER_CODE \n    , tx.REV_CODE_ID \n    , tx.PRICE \n    , tx.ITEM_SALE_ID\n</code></pre>\n\n<p>I need to add the fiscal year-to-date quantity and and amount columns to this report.  Would a correlated subquery by the way to go?  Would the joins be tricky?  I've never used a subquery with an aggregation/grouping query.  </p>\n\n<p>Thanks for all the previous help.  </p>\n"},{"tags":["mysql","sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13137745,"title":"MYSQL declare varchar issues","body":"<p>I am getting an error while declaring a varchar in MySQL\n<strong>DECLARE city varchar(20)</strong>;</p>\n\n<p>The above line of code works fine in <code>Oracle database</code> but not In MySQL.\nCan someone suggest me the solution?</p>\n\n<p>I am using MySQL 5.0.77. I saw this question on this site but could not find a suitable answer.</p>\n\n<p>One more question %ROWTYPE and %TYPE are these declarations there in MYSQL?</p>\n"},{"tags":["mysql","sql","mysql-error-1442"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13071643,"title":"Can't update table 'tbl' in stored function/trigger because it is already used by statement which invoked this stored function/trigger","body":"<pre><code> INSERT INTO `category_sport` (\n`id` ,\n`category_id` ,\n`sport_id` ,\n`ordering`\n)\nVALUES (\nNULL , '1', '1', ''\n)\n</code></pre>\n\n<p>what I want to do is manually add few rows to the table for the testing purpose. But when I try to add it gives me below error    </p>\n\n<p><strong>#1442 - Can't update table 'tbl' in stored function/trigger because it is already used by statement which invoked this stored function/trigger.</strong></p>\n\n<p>table structure </p>\n\n<p><img src=\"http://i.stack.imgur.com/P6inn.png\" alt=\"table structure\"></p>\n\n<p>Trigger</p>\n\n<pre><code>CREATE TRIGGER `update_category_sport_order` AFTER INSERT ON `category_sport`\nFOR EACH\nROW UPDATE `category_sport` SET `ordering` = NEW.id WHERE `id` = NEW.id;\n</code></pre>\n\n<p>How can I add data? </p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13137643,"title":"Stored Procedure in php","body":"<p>I am using Stored procedure to fetch data from database .</p>\n\n<pre><code>$result = mysql_query(\"call FindProspectRequests('','Summit','','NULL','NULL')\") or die (mysql_error());\n</code></pre>\n\n<p>where last two parameters are starttime and endtime   If i am  calling directly as above my procedure is working .(Fields are accepting value as NULL )</p>\n\n<p>But consider this scenario,\nwhen i am calling as below it is not working for me .  </p>\n\n<pre><code> $starttime ='NULL';\n $endtime ='NULL';\n\n$result = mysql_query(\"call FindProspectRequests('','Summit','','$starttime','$endtime')\") or die (mysql_error());\n</code></pre>\n\n<p>Please tell me what might i am doing wrong ?</p>\n\n<p>Thanks </p>\n"},{"tags":["c#","sql","sql-injection"],"answer_count":8,"favorite_count":5,"up_vote_count":16,"down_vote_count":0,"view_count":14890,"score":16,"question_id":681583,"title":"SQL injection on INSERT","body":"<p>I have created a small survey web page on our company Intranet.  This web page is not accessible from the outside.</p>\n\n<p>The form is simply a couple of radio buttons and a comments box.</p>\n\n<p>I would like to maintain good coding practices and would like to guard against SQL Injections.</p>\n\n<p>Can SQL injections happen on a insert statement with comments from the textbox?\nIf so, how can I guard against it using .NET 2.0?</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13135081,"title":"Get top scorer(s) in MySQL","body":"<p>I have simple table:</p>\n\n<pre><code>ID    Score\n1     90\n2     85\n3     96\n4     96\n5     73\n</code></pre>\n\n<p>I want to get the top scorer(s) so I used max function:</p>\n\n<pre><code>select max(s.score) as score,\n    s.id\nfrom student_score as s\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>score    id\n96       1\n</code></pre>\n\n<p>The problem is, there are two top scorers, how am I going to get all top scorers?</p>\n"},{"tags":["c#","asp.net","sql","odbc","dsn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13137778,"title":"DSN not able to connect to a remote SQL server","body":"<p>I am moving all my existing applications to a new web server, applications use a DSN based connection using ODBC driver.</p>\n\n<p>On the new server I am trying build DSN which connect's to remote SQL Server, but I am getting  the error : </p>\n\n<pre><code>System.Data.OleDb.OleDbException: [DBNETLIB][ConnectionOpen (Connect()).]SQL Server does not exist or access denied.\nInvalid connection string attribute\n</code></pre>\n\n<p>Connection string is : <code>\"Dsn=dsnName;uid=userID;pwd=pswd;Provider=SQLOLEDB;Integrated Security=SSPI\"</code></p>\n\n<p>It works fine on my local P.C, but I get this error while establishing DSN on the web server.</p>\n\n<p>If I specify the port number along with the Server name (servername, 6000) then connection went's thru but my application throw the same error.</p>\n\n<p>Please help.  </p>\n"},{"tags":["mysql","sql","performance","database-performance"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13136278,"title":"Optimize sql request for statistics","body":"<p>I would like to perform some request in mysql that i know will be really slow:</p>\n\n<p>I have 3 tables:</p>\n\n<p>Users:</p>\n\n<pre><code>id, username, email\n</code></pre>\n\n<p>Question:</p>\n\n<pre><code>id, date, question\n</code></pre>\n\n<p>Answer</p>\n\n<pre><code>id_question, id_user, response, score\n</code></pre>\n\n<p>And i would like to do some statistics like the top X users with the best score (sum of all the scores) for all time or for a given amount of time (last month for example). Or it could be users between the 100th and the 110th range</p>\n\n<p>I will have thousands of users and hundred of questions so the requests could be very long since I'll need to order by sum of scores, limit to a given range and sometimes only select some questions depending on the date, ...</p>\n\n<p>I would like to know if there are some methods to optimize the requests!</p>\n"},{"tags":["sql","sql-server","datetime"],"answer_count":5,"favorite_count":7,"up_vote_count":20,"down_vote_count":0,"view_count":48713,"score":20,"question_id":1110998,"title":"Get Day of Week in SQL 2005/2008","body":"<p>Say I have a date 01/01/2009, I want to find out what day it was e.g. Monday, Tuesday, etc...</p>\n\n<p>Is there a built in function for this in Sql2005/2008? Or do I need to use an auxiliary table?</p>\n"},{"tags":["sql","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13135540,"title":"Finding Max of two nested aggregate functions in SQL","body":"<p>I have an MS Access 2007 Database with the following tables and attributes:</p>\n\n<ul>\n<li>Characters: Name</li>\n<li>Planets: Name</li>\n<li>TimeTable: Planet's Name, Character's Name</li>\n</ul>\n\n<p>Time Table denotes if a character has visited a planet, there may be multiple entries for one planet.<br>\nThe query I'm trying to get is this one:<br>\nFor each movie, which characters visited the highest number of planets? </p>\n\n<p>This is my attempt:</p>\n\n<pre><code>SELECT T.Movie, T.[Character's Name], Count(T.[Planet's Name]) AS planets\nFROM TimeTable T\nGROUP BY T.Movie, T.[Character's Name]\nHAVING Count(T.[Planet's Name]) &gt;= ALL (SELECT Count(T2.[Planet's Name])\nFROM TimeTable T2 WHERE T.Movie = T2.Movie);\n</code></pre>\n\n<p>It gives me an empty result though. What is wrong with my query?</p>\n"},{"tags":["sql","oracle","batch","sql-developer"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13137258,"title":"Oracle SQL Developer how to dynamicly run sql scripts","body":"<p>I have the following challange;</p>\n\n<p>I would like to execute a batch of *.sql files on one database. The sql files are assumed to be named in ascending order of their execution sequence. So the main sql script should do a 'dir /s *.sql', then start each of the found scripts in order.</p>\n\n<p>Is this possible ?</p>\n\n<p>Below is something I found for SQL Server, but I want something similar for Oracle SQL Developer.</p>\n\n<p><a href=\"http://pradeep1210.wordpress.com/2012/03/15/executing-a-set-of-sql-script-files-sql-on-a-group-of-sql-server-databases/\" rel=\"nofollow\">http://pradeep1210.wordpress.com/2012/03/15/executing-a-set-of-sql-script-files-sql-on-a-group-of-sql-server-databases/</a></p>\n\n<p>Thanks in advance.</p>\n\n<p>Raymond</p>\n"},{"tags":["sql","sql-server"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":13136204,"title":"Generate sequence number in SQL on every insert","body":"<p>I need to enter primary key in table as in below format </p>\n\n<pre><code>YYYY/MMM/NNNNNN\n</code></pre>\n\n<p>Where, <code>YYYY</code> is the current year, <code>MMM</code> is Month , and <code>NNNNNN</code> is a sequence no from <code>000001, 000002, 000003, .... 999999</code>.</p>\n\n<p>So my primary key will look like <code>2012/Oct/000001</code> or <code>2012/Oct/000010</code> ....</p>\n\n<p>How can I generate this type of code..</p>\n\n<p>I can get Year and Month from <code>Getdate()</code> function. But how can I manage sequence number on every insert. can you please give me logic for that?</p>\n"},{"tags":["asp.net","sql","divide-by-zero"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":51,"score":0,"question_id":13136406,"title":"Divide by zero error encountered","body":"<p>I'm having an divide by zero error when I launch this SQL query :</p>\n\n<pre><code>SELECT CONVERT(VARCHAR(11),CaptureTime,106) 'CaptureTime',\n        Type,\n        CASE WHEN Unit='g/L' THEN (data1* 0.02586) ELSE data1 END As data1,\n        CASE WHEN Unit='g/L' THEN nullif(data2* 0.02586,0) ELSE data2 END As data2,\n        CASE WHEN Unit='g/L' THEN nullif(data3* 0.02586,0) ELSE data3 END As data3,\n        CASE WHEN Unit='g/L' THEN nullif(data1* 0.02586,0) / nullif(data2* 0.02586,0) ELSE (data1/data2) END As Ratio,\n        CASE WHEN Unit='g/L' THEN 'ml/L' ELSE 'ml/L' END As data,\n        CASE WHEN Unit='g/L' THEN (data4* 0.01129) ELSE data4 END As data4\nFROM something \nwhere Type ='DATA'\nand ID='\" + Session[\"name\"].ToString() + \"'\nOrder By CONVERT(DateTime, CaptureTime,101) DESC\n</code></pre>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":6347897,"title":"What's wrong with this query?","body":"<pre><code>SELECT\n      i.*, \n      r.name AS roomname, \n      c.name AS cat, \n      p.key AS imgkey, \n      p.extension AS imgext\n   FROM \n      items i, \n      rooms r, \n      categories c \n         LEFT JOIN photos p \n            ON p.referencekey = i.key \n   WHERE \n          i.room = r.key \n      AND r.key = 663308 \n      AND i.sitekey = 32201 \n      AND c.key = i.categorykey\n</code></pre>\n\n<p>The above query when executed returns following error.</p>\n\n<blockquote>\n  <p>ERROR:  invalid reference to FROM-clause entry for table \"i\"</p>\n  \n  <p>LINE 1: ...tegory c LEFT JOIN photos p ON p.referencekey = i.key WHER...</p>\n  \n  <p>HINT:  There is an entry for table \"i\", but it cannot be referenced from this part of the query.</p>\n</blockquote>\n"},{"tags":["sql","oracle","oracle10g","pivot","unpivot"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":86,"score":4,"question_id":13121775,"title":"fetch distinct column values in a single row","body":"<p>This is the data:</p>\n\n<pre><code>id    name     period      data1    data2\n===================================================\n111   name1    monthly     aaaaa    bbbbb\n111   name1    quaterly    ccccc    ddddd\n111   name1    halfYearly  eeeee    fffff\n111   name1    annually    ggggg    hhhhh\n</code></pre>\n\n<p>I want query which fetch data in a single row like</p>\n\n<pre><code>id    name     monthlYdata1    monthlYdata2      quaterlydata1    quaterlydata2      halfYearlydata1    halfYearlydata2      annuallydata1    annuallydata2\n==========================================================================================================================================================\n111   name1    aaaaa           bbbbb             ccccc            ddddd              eeeee              fffff                ggggg            hhhhh\n</code></pre>\n"},{"tags":["sql","mysql"],"answer_count":7,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":11454,"score":11,"question_id":1446821,"title":"How to get next/previous record in MySQL?","body":"<p>Say I have records with IDs 3,4,7,9 and I want to be able to go from one to another by navitagion via next/previous links. The problem is, that I don't know how to fetch record with nearest higher ID.</p>\n\n<p>So when I have record with ID 4, I need to be able to fetch next existing record, which would be 7. The query would probably look something like</p>\n\n<pre><code>SELECT * FROM foo WHERE id = 4 OFFSET 1\n</code></pre>\n\n<p><strong>How can I fetch next/previous record without fetching whole result set and manualy iterating?</strong></p>\n\n<p>I'm using MySQL 5.</p>\n"},{"tags":["mysql","sql","mysqli","mysql-error-1064"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13134997,"title":"MySQL AES_DECRYPT and AES_ENCRYPT not working","body":"<p>I have this query</p>\n\n<p><code>SELECT AES_ENCRYPT('string','secretkey');</code></p>\n\n<p>that outputs this </p>\n\n<p><code>R\"ߒY</code> (i don't know why ...)</p>\n\n<p>and when i run this query</p>\n\n<p><code>SELECT AES_DECRYPT('R\"ߒY','secretkey');</code></p>\n\n<p>it gives me</p>\n\n<p><code>(NULL)</code></p>\n\n<p>Why is that?????</p>\n\n<p>I tried <code>CONVERT (... USING utf8)</code>. What is the problem? I really need a script in MySQL that encrypts and decrypts. Can that be posible? For example in PHP i have this :</p>\n\n<pre><code>&lt;?php\ndefine('SALT', 'mykey');\n\nfunction encrypt($text)\n{\n    return urlencode(trim(base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, SALT, $text, MCRYPT_MODE_ECB, mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB), MCRYPT_RAND)))));\n}\n\nfunction decrypt($text)\n{\n    return trim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, SALT, base64_decode(urldecode($text)), MCRYPT_MODE_ECB, mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB), MCRYPT_RAND)));\n}\n?&gt;\n</code></pre>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>i have tried first with <strong>5.0.84-log</strong> and get this result and after that i tried with MySQL <strong>5.5.25a</strong> (ENCODE FUNCTION) and get this</p>\n\n<p><code>SELECT ENCODE(  'stringqwqweqwe',  'secretkey' )</code>\n<code>be6580a2c724ac580692f0583688</code></p>\n\n<p><code>SELECT DECODE(  'be6580a2c724ac580692f0583688',  'secretkey' )</code>\n<code>8920758878763a129651793967f4e3e8dd443e0a01238b5c7f635564</code></p>\n\n<p>Not what i expected ... what now?</p>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13135552,"title":"oracle SQL how to remove time from date","body":"<p>I have a column named <code>StartDate</code> containing a date in this format: <code>03-03-2012 15:22</code></p>\n\n<p>What I need is to convert it to date. It should be looking like this: <code>DD/MM/YYYY</code></p>\n\n<p>What I have tried without success is:</p>\n\n<pre><code>select \np1.PA_VALUE as StartDate,\np2.PA_VALUE as EndDate\nfrom WP_Work p \nLEFT JOIN PARAMETER p1 on p1.WP_ID=p.WP_ID AND p1.NAME = 'StartDate'\nLEFT JOIN PARAMETER p2 on p2.WP_ID=p.WP_ID AND p2.NAME = 'Date_To'\nWHERE p.TYPE = 'EventManagement2'\nAND TO_DATE(p1.PA_VALUE, 'DD/MM/YYYY') &gt;= TO_DATE('25/10/2012', 'DD/MM/YYYY')\nAND TO_DATE(p2.PA_VALUE, 'DD/MM/YYYY') &lt;= TO_DATE('26/10/2012', 'DD/MM/YYYY')\n</code></pre>\n\n<p>Is there a way to do this?</p>\n\n<p>EDIT1: the <code>PA_VALUE</code> column is: <code>VARCHAR2</code></p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13136022,"title":"select from the result of execute(@query)","body":"<p>I am using this SQL query</p>\n\n<pre><code>DECLARE @cols AS NVARCHAR(MAX),\n    @query  AS NVARCHAR(MAX)\n\nselect @cols = STUFF((SELECT distinct ',' + QUOTENAME(Animal2) \n                    from animals\n            FOR XML PATH(''), TYPE\n            ).value('.', 'NVARCHAR(MAX)') \n        ,1,1,'')\n\nset @query = 'SELECT Animal1, ' + @cols + ' from \n             (\n                select animal1, animal2, Corelation\n                from animals\n            ) x\n            pivot \n            (\n                min(Corelation)\n                for animal2 in (' + @cols + ')\n            ) p '\n\nexecute(@query)\n</code></pre>\n\n<p>See <a href=\"http://sqlfiddle.com/#!3/5b713/6\" rel=\"nofollow\">SQL Fiddle with demo</a></p>\n\n<p>When I execute the query I get a table as a return.</p>\n\n<p>How can I select from that table? I tried to use <code>SELECT * FROM (*past here the script*)</code> but it did not work. I just need to use the result of the execute(@query) as a table and select from it (to put it in a new table). How can I do it?</p>\n\n<p>Thanks</p>\n\n<p>NOTE: that query was an answer of <a href=\"http://stackoverflow.com/questions/13125187/sql-query-to-select-records-in-a-specific-format-using-pivot-or-other/\">this SO question</a></p>\n"},{"tags":["asp.net","sql","asp.net-mvc-3","lambda","dbset"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13135741,"title":"ASP.NET MVC3 DbSet how to get a set of instances NOT IN int[] array","body":"<p>I have the fowllowing code:</p>\n\n<pre><code>public string ajax_getAllExercises(int[] exclude_list)\n{\n    JSONResponse&lt;Exercise&gt; res = new JSONResponse&lt;Exercise&gt;();\n\n    db.Configuration.ProxyCreationEnabled = false;\n    res.data = db.Exercises.Where(e =&gt; e.CourseID == null).ToList();\n    if(res.data != null)\n    {\n        res.result = true;\n    }\n\n    // Return the response to browser and set headers\n    Response.AppendHeader(\"Content-Type\", \"application/json\");\n    return res.ToJSON();\n}\n</code></pre>\n\n<p>It is not finished... I am trying to fetch a list of exercies where the ExerciseID is not in the int-array <code>exclude_list</code> and <code>CourseID == null</code>. The problem is I don't know how to create a lambda expression in a <code>Where&lt;&gt;</code> clause so it will get same functionality as a SQL statement like <code>SELECT * FROM Exercises WHERE CourseID == null AND id NOT IN (20,21,22,23)</code>. How can i get this functionality from the DbSet type without using SqlQuery so i still use the EntityFramework?</p>\n"},{"tags":["mysql","sql","database","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13129280,"title":"Complex Join of two MySQL tables","body":"<p><strong>edit:</strong> The join that I want:</p>\n\n<p><img src=\"http://i.stack.imgur.com/TOU5z.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is my current MySQL tables</p>\n\n<p>table 'primary'</p>\n\n<pre><code>+----------+--------+---------+-----------+----------+\n| id       | sample | mineral | formula   | link     |\n+----------+--------+---------+-----------+----------+\n| 1        | 5742   | calcite | CaCO3     | link..   |\n| 2        | 3411   | siderite| Fe^2+^CO3 | link..   |\n| .        | ....   | ........| ......... | ......   |\n+----------+--------+---------+-----------+----------+\n</code></pre>\n\n<p>and table 'secondary'</p>\n\n<pre><code>+----------+------------+---------+-----------+\n| id       | wavenumber | calcite | siderite  |\n+----------+------------+---------+-----------+\n| 1        | 1          | 256     | 434       |\n| 2        | 3          | 254     | 312       |\n| 3        | 5          | 251     | 424       |\n| 4        | 7          | 257     | 544       |\n| 5        | 9          | 258     | 345       |\n| 6        | 11         | 257     | 386       |\n| 7        | 13         | 326     | 314       |\n| 8        | 15         | 456     | 337       |\n| 9        | 17         | 236     | 243       |\n| 10       | 19         | 246     | 514       |\n| 11       | 21         | 254     | 662       |\n| 12       | 23         | 258     | 248       |\n| 13       | 25         | 230     | 374       |\n| 14       | 27         | 224     | 359       |\n| 15       | 29         | 216     | 442       |\n| 16       | 31         | 236     | 344       |\n| 17       | 33         | 247     | 343       |\n| ..       | ..         | ...     | ...       |\n+----------+------------+---------+-----------+\n</code></pre>\n\n<p>It is possible to combine in one query:\n- a select all from row click of primary table with select all from weavenumber + specific column from secondary table:</p>\n\n<p><strong>e.g.</strong> if is clicked on row 2 of primary table, select all and also I want to select all from weavenumber and column 'siderite'.</p>\n\n<p>Weavenumber column it is common for all selections, the only difference is column 3, 4, 5, and so on, which corresponds to the id of primary table.\nIt's possible to make a join like this?</p>\n\n<p>I want to make a xy plot for every entry primary table, and in the secondary table, the weavenumber is the x-axe (horizontal) and calcite, siderite, etc. is the variable y-axe (vertical).</p>\n\n<p>For now I have this:</p>\n\n<pre><code>private void primaryMouseClicked(java.awt.event.MouseEvent evt) {  \n\nint row = primary.getSelectedRow();\nint realIndex = primary.convertRowIndexToModel(row);\nString Table_click = (primary.getModel().getValueAt(realIndex, 0).toString());\n\n    try {\n            String sql = \"select * from primary where id='\" + Table_click + \"' \";\n            pst = conn.prepareStatement(sql);\n            rs = pst.executeQuery();\n            if (rs.next()) {\n\n\n                String add1 = rs.getString(\"mineral\");\n                txt_mineral.setText(add1);\n                String add2 = rs.getString(\"formula\");\n                txt_formula.setText(add2);\n                String add3 = rs.getString(\"link\");\n                txt_link.setText(add3);\n\n            }\n\n        } catch (Exception e) {\n\n            JOptionPane.showMessageDialog(null, e);\n        }\n\n}\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":7,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":38657,"score":11,"question_id":177323,"title":"how to read the last row with SQL Server","body":"<p>What is the most efficient way to read the last row with SQL? The table is indexed on a unique key--the \"bottom\" key values represent the last row. </p>\n\n<p>Edit: This is for SQL Server.</p>\n\n<p>Thank you</p>\n\n<p>rp</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":18,"score":-1,"question_id":13135891,"title":"Creating a total row to display the total difference of column items in ms sql","body":"<p>I am trying to create a total row that takes items from a column and displays the difference in the total field as opposed to the sum. Is this even possible in SQL?</p>\n\n<pre><code>SELECT P.Part_Number, P.Units_On_Hand \nFROM Part AS P \nWHERE P.Part_Number IN ('AX12', 'AZ52')\n</code></pre>\n\n<p>This is the query I currently have to display the items I need the processing to be done on. How can I amend it to incorporate a total column to show the difference? </p>\n"},{"tags":["sql","contains"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":504,"score":0,"question_id":2055670,"title":"CONTAINS sql function don't see underlinings","body":"<p>I have some table 'TableName' like Id,Name:</p>\n\n<pre><code>1 | something\n2 | _something\n3 | something like that\n4 | some_thing\n5 | ...\n</code></pre>\n\n<p>I whant to get all rows from this table where name containes 'some'.\nI have 2 ways:</p>\n\n<pre><code>SELECT * FROM TableName WHERE Name like '%some%'\n</code></pre>\n\n<p>Result is table :</p>\n\n<pre><code>1 | something\n2 | _something\n3 | something like that\n4 | some_thing\n</code></pre>\n\n<p>But if I use CONTAINS function </p>\n\n<pre><code>SELECT * FROM TableName WHERE CONTAINS(Name,'\"*some*\"')\n</code></pre>\n\n<p>I get only </p>\n\n<pre><code>1 | something\n3 | something like that\n</code></pre>\n\n<p>What should I do to make CONTAINS function work properly?</p>\n"},{"tags":["c#","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13135060,"title":"Dynamically print number of rows updated","body":"<p>The company that I work for has large databases, millions of records in a single table. I have written a C# program that migrates tables between remote servers.</p>\n\n<p>I first create all the tables using SMO without copying data and then the data insertion is done after all the tables have been created.</p>\n\n<p>During the record insertion since there are so many records the console window remains blank until all the rows have been inserted. Due to the sheer volumes of data this takes a long time.</p>\n\n<p>What I want now is a way to print n rows updated like in MSSQL import export data wizard.<br>\nThe insert part is just a simple <code>insert into select *</code> query. </p>\n"},{"tags":["sql","oracle","plsql","oracle10g","cascading-deletes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13133148,"title":"Deleting rows from multiple related tables","body":"<p>There are three tables related one-to-one on the identifier. I need to delete all the records from the three tables that match the criteria A.ID = B.ID = C.ID</p>\n\n<p>Now I do it in the following way:</p>\n\n<pre><code>DECLARE\n    CURSOR CUR IS \n        SELECT C.ID FROM A \n        INNER JOIN B ON A.\"ID\" = B.\"ID\" \n        INNER JOIN C ON B.\"ID\" = C.\"ID\"\n        WHERE A.STATUS = 'ERROR';\n    IDX NUMBER;\nBEGIN\n    FOR REC IN CUR LOOP \n        IDX := REC.ID;\n        DELETE FROM C WHERE C.\"ID\" = IDX;\n        DELETE FROM B WHERE B.\"ID\" = IDX;\n        DELETE FROM A WHERE BP.\"ID\" = IDX;\n    END LOOP;\n    COMMIT;\nEND;\n</code></pre>\n\n<p>A lot of data and this way for very long runs. Is there any way to delete faster?</p>\n"},{"tags":["c#","asp.net","sql","asp.net-mvc","repository"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13135550,"title":"Populate ViewModel with multiple objects","body":"<p>Considering this ViewModel</p>\n\n<pre><code>public class DocumentReferenceViewModel\n{\n    public int IdDocumentReference { get; set; }\n    public string DocumentTitle { get; set; }\n    public string PageNbr { get; set; }\n    public string Comment { get; set; }\n}\n</code></pre>\n\n<ul>\n<li>The DocumentTitle is a property of a <strong>Document</strong> object</li>\n<li>The <strong>IdDocumentReference</strong> and <strong>PageNumber</strong> are properties of\nDocumentReference object</li>\n</ul>\n\n<p><strong>Document</strong> and <strong>DocumentReference</strong> are linked with a propertie <em>IdDocument</em></p>\n\n<ul>\n<li>I have a repository which can return <strong>Document</strong> objects</li>\n<li>I have a repository which can return <strong>DocumentReference</strong> objects</li>\n</ul>\n\n<hr>\n\n<pre><code>public class DocumentReference\n{\n    public int IdDocumentReference;\n    public string PageNbr { get; set; }\n    public string Comment { get; set; }\n}\n\n\npublic class Document\n{\n    public int IdDocument;\n    public string DocumentTitle { get; set; }\n}\n</code></pre>\n\n<p>How can I bind the ViewModel from theses 2 objects (tables) without looping on the DocumentReference and for each one querying the database to retrieve de DocumentTitle ?</p>\n\n<p>ps : I am not using EF, I have repositories calling handwritten Stored Procedures</p>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13134944,"title":"SQL finding out the common values in two tables","body":"<p>I have two tables as <code>vMerkmale</code> and <code>aREL_Adr_Merk</code>. They have one common attribute as <code>MID</code>. I want to bind <code>Mtitel</code> from <code>merkmale</code> whose  <code>MID</code>'s are common with <code>aREl_Adr_Merk</code>. BUT , the problem is that , when I choose two IDs then it binds all values of these two IDs. I JUST WANT  TO Bind their common  MTITEL Values. MY code is below..</p>\n\n<pre><code>   SELECT M.mtitel as Attribute FROM vMerkmale  M ,aREL_Adr_Merk R\n   where m.mid=R.MID and AdrID in(252674,247354) \n   group by M.MTitel\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13132543,"title":"Matching Different Value within One Row II","body":"<p>this is a revised question from previous one. I decided to open a new question since the scope has changed.</p>\n\n<p>This is what I want to achieve.</p>\n\n<p>List the last name of the author(s) of the book in an \"Author\" column, the last name of the author to be listed first, followed (after a comma) by that of the author to be listed second if any; and if there is a third author, put it after the second author's name. The order of the author of a book is listed in the <strong>au_ord</strong> column (1=First Author, 2=Second Author, 3=Third Author).</p>\n\n<p>Any idea how to achieve this in MYSQL output?</p>\n\n<p><img src=\"http://i.stack.imgur.com/OC3vi.png\" alt=\"enter image description here\"></p>\n\n<p>Those are the source table. The desired output is something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/g0jfF.png\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","xml","sql-server-2005"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13134610,"title":"SQL Server 2005 Query XML Data Type related","body":"<p>I am selecting 2 sets of columns from the same table, as follows.</p>\n\n<pre><code>select (select a, b, c from T1 FOR XML RAW('CAT1')),\n       (select d, e, f from T1 FOR XML RAW('CAT2'))\nfor XML PATH('Parent')\n</code></pre>\n\n<p>The result of the query is </p>\n\n<pre><code>&lt;Parent&gt;&amp;lt;CAT1 a=\"Data1\" b=\"Data2', c=\"Data3\" &amp;gt;&amp;lt;CAT2 d=\"Data4\" e=\"Data5\" f=\"Data6\"&amp;gt;&lt;/Parent&gt;\n</code></pre>\n\n<p>How to avoid? I would get enclosed in a proper parent xml?</p>\n\n<p>Expected Result</p>\n\n<pre><code>&lt;Parent&gt;\n   &lt;CAT1 a=\"Data1\" b=\"Data2', c=\"Data3\"&gt;\n   &lt;CAT2 d=\"Data4\" e=\"Data5\" f=\"Data6\"&gt;\n&lt;/Parent&gt;\n</code></pre>\n"},{"tags":["sql","oracle","oracle11g","constraints","alter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":31,"score":0,"question_id":13131039,"title":"Constraint on multiple columns","body":"<p>I have a table that contains 7 columns(f_name, l_name, sex, birth_date, matri_num,dept,sal) and i want to add a constraint to verify that of out the 3 columns(f_name, l_name,birth_date) at least 2 was filled.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":54,"score":-3,"question_id":13135107,"title":"SUM function in SQL","body":"<p>There are three tables,we have to select data from these table using one primary key and foreign key. But in the one table there is lot of data in the third table. We have to sum the data on the base of the primary key.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SW9TB.png\" alt=\"Table1\">  <img src=\"http://i.stack.imgur.com/PqGVS.png\" alt=\"Table2\"> <img src=\"http://i.stack.imgur.com/m7V5a.png\" alt=\"table3\"></p>\n\n<pre><code>BAl = Balance, met = Method, amo = amount, cst_id, cut_id, cut_i = customer_id\n</code></pre>\n\n<p>Now we have to sum the on the basis of method and sum for 10 cust id in the same query. Can anyone help me on this?</p>\n"},{"tags":["c#","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13015220,"title":"Using SMO for retrieving SQL Server, Database, Table info","body":"<p>I get the db names using:</p>\n\n<pre><code>SqlDataSourceEnumerator sdse = SqlDataSourceEnumerator.Instance;\nDataTable table = sdse.GetDataSources();\n</code></pre>\n\n<p>Then using the below I get a list of db's.</p>\n\n<pre><code>static void Main(string[] args)\n        {\n            {\n                //Connect to the local, default instance of SQL Server. \n                Server srv;\n                srv = new Server(\"LAPTOP\\\\SQLEXPRESS\");\n                //The connection is established when a property is requested.\n\n                Console.WriteLine(srv.Databases.ToString());\n                foreach (Database db in srv.Databases)\n                {\n                    Console.WriteLine(db);\n                }\n                Console.ReadLine();\n            }\n        }\n</code></pre>\n\n<p>The problem is that I only get the system databases, no others, even though they exist. I don't know what to change to get the info for all of the databases. Any assistance would be appreciated.</p>\n\n<p>TH</p>\n"},{"tags":["sql","sql-server","full-text-search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13130551,"title":"Optimizing function that returns phrases present in given text","body":"<p>I need to implement a function that takes a text (some longer document) as a parameter and returns list of phrases that are present in it. Phrases are stored in a table <code>Phrases (id int primary key, phrase text)</code> and there can be as many as 10 millions of them.</p>\n\n<p>My question is: How can I take the advantages of SQL Server's full-text indexes to keep execution time at fairly low level. Searching for documents containing given phrases is obvious but what about this inverted situation?</p>\n"},{"tags":["php","mysql","sql","database","website"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13132961,"title":"Issue with custom config.php","body":"<p>I have been dropped in the deep end by being asked to migrate an OLD custom built website (using php and mysql) to another server.  I have changed the config to reflect the new location but all I get is a white screen.  The DB connects fine so that isn't the issue, I think it might be with the $doc_root.  Can anyone help with the code below?</p>\n\n<pre><code>$doc_root = str_replace( '\\\\', '/', substr($_SERVER['SCRIPT_FILENAME'], 0, 0-strlen($_SERVER['PHP_SELF']))).\"\";\n$DOC_ROOT = str_replace( '\\\\', '/', substr($_SERVER['SCRIPT_FILENAME'], 0, 0-strlen($_SERVER['PHP_SELF']))).\"\";\n</code></pre>\n\n<p>I dont know php too well unfortunately so I am stuck!  The current test server address is in this format<code>http://xx.xxx.xx.xx/thedomain.com/</code></p>\n\n<p>I have tried so many combinations of the above for the $doc_root but whatever I do won't work.</p>\n\n<p>Can anyone help?  Thanks in advance!</p>\n"},{"tags":["mysql","sql","postgresql"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":13132939,"title":"What happens when I exhaust a bigint generated key? How to handle it?","body":"<p>I can't imagine for myself a good answer for this, so I thought of asking it here. In my mind, I'm always wondering what will happen if the <code>AUTO INCREMENT PRIMARY ID</code> column in my <strong>MySQL</strong> table exhausted?</p>\n\n<p>Say for example, I have a table which has two columns. An <strong>ID</strong> (<code>auto increment, primary, BIGINT unsigned</code>) and <strong>DESC</strong> (<code>VARCHAR 255</code>). I know for sure <code>BIGINT</code> is a lot, but it can reach its limit. How do I handle the scenario wherein <em>in case</em> the <strong>ID</strong> reach its limit? Do I need another server? If then how can I sync it? Is this the right way? Any insights friends.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13134540,"title":"Converting nested select into join","body":"<p>My query is </p>\n\n<pre><code>select COUNT(*) from result \nwhere test_id in (select test_id \n                    from test_schedule \n                    where scheduler_id in (select user_id \n                                           from users \n                                           where user_type=1))\n</code></pre>\n"},{"tags":["mysql","sql","query","date","max"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13121742,"title":"MySQL Query: Write max(Date) from whole table to each row","body":"<p>I need to find the max(n.LastEdited) (Latest Editing Date) for my whole table and write it on each row.</p>\n\n<p>What I have:</p>\n\n<pre><code>SELECT n.ID,\nn.Title,\nn.News,\n(SELECT max(n.LastEdited)) AS NewsLastEdited\nFROM News AS n\nORDER BY n.ID DESC\nLIMIT 0,20\n</code></pre>\n\n<p>What I get (not showing ID, Title, News, ...):</p>\n\n<pre><code>NewsLastEdited\n2012-10-25 10:54:24\n2012-10-25 10:54:12\n2012-10-25 10:54:02\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>NewsLastEdited\n2012-10-25 10:54:24\n2012-10-25 10:54:24\n2012-10-25 10:54:24\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13132222,"title":"Why does Sql Sum of multiple columns containing nulls return incorrect result?","body":"<p>Table containing the following values:</p>\n\n<pre><code>Column1  Column2\n1        NULL\nNULL     4\n2        NULL\nNULL     5\n3        6\n</code></pre>\n\n<p>The following query:</p>\n\n<pre><code>SELECT \n    SUM([Column1] + [Column2] ) \nFROM [myTable]\n</code></pre>\n\n<p>returns a value of <code>9</code> when it should be returning <code>21</code>. Why? How does it arrive at the value?</p>\n\n<p>I know the SUM can be corrected by adding <code>ISNULL</code> like so:</p>\n\n<pre><code>SELECT \n    SUM(ISNULL([Column1], 0) + ISNULL([Column2], 0)) \nFROM [myTable]\n</code></pre>\n\n<p>but I would like to know the logic behind the value <code>9</code></p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13133599,"title":"Query to find the duplicates between the name and number in table","body":"<pre><code>SELECT count(*), lower(name), number\nFROM   tbl\nGROUP  BY lower(name), number\nHAVING count(*) &gt; 1;\n</code></pre>\n\n<p>input tb1</p>\n\n<pre><code>slno name number\n1    aaa   111\n2    Aaa   111\n3    abb   221\n4    Abb   121\n5    cca   131\n6    cca   141\n7    abc   222\n8    cse   222\n</code></pre>\n\n<p>This query can just find the duplicates in the number and names which are same but it wont be able find the duplicates in the 3 and 4th row!!!</p>\n\n<pre><code> SELECT count(*), lower(name)\n    FROM   tbl\n    GROUP  BY lower(name)\n    HAVING count(lower(name)) &gt; 1\n</code></pre>\n\n<p>this query can find all the duplicates in name!!! it works perfectly</p>\n\n<pre><code> SELECT count(*), number\n    FROM   tbl\n    GROUP  BY number\n    HAVING count(number) &gt; 1\n</code></pre>\n\n<p>this query can find all the duplicates in number!!! it works perfectly</p>\n\n<p>I want a query which can find all the duplicates in both name and number whether the name consists of lower case and upper case</p>\n\n<pre><code>output\nname number count\n2    111     aaa\n2    ---     abb\n2    ---     cca\n2    222     ---\n</code></pre>\n"},{"tags":["asp.net","sql","sql-server","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13134602,"title":"Creating connection string of database created on different PC","body":"<p>I am trying to use the database send by my friend. He has created it using <em>Sql Server Management Studio</em>. While including the <em><code>.mdf</code></em> file, I am getting an  error message (I have mentioned the error at the end of the answer).\nI think it is because of the difference in the connection strings. I am new to .NET so I just changed the name in the connection string,</p>\n\n<p><strong>From,</strong></p>\n\n<pre><code> &lt;add name=\"ApplicationServices\" connectionString=\"Data Source=sheroz;Initial Catalog=FLEXIFORMDB;integrated security=SSPI\"/&gt;\n  &lt;/connectionStrings&gt;\n</code></pre>\n\n<p><strong>To,</strong></p>\n\n<pre><code> &lt;add name=\"ApplicationServices\" connectionString=\"Data Source=Fahad-PC\\Fahad;Initial Catalog=FLEXIFORMDB;integrated security=SSPI\"/&gt;\n  &lt;/connectionStrings&gt;\n</code></pre>\n\n<p>Please help me out to make it work. Thanks in advance.</p>\n\n<h2>Error</h2>\n\n<pre><code>An exception occurred while executing a Transact-SQL statement or batch. (Microsoft.SqlServer.ConnectionInfo)\n\n------------------------------\nProgram Location:\n\n   at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(String sqlCommand, ExecutionTypes executionType)\n   at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(StringCollection sqlCommands, ExecutionTypes executionType)\n   at Microsoft.SqlServer.Management.Smo.ExecutionManager.ExecuteNonQuery(StringCollection queries)\n   at Microsoft.SqlServer.Management.Smo.Server.AttachDatabaseWorker(String name, StringCollection files, String owner, AttachOptions attachOptions)\n   at Microsoft.SqlServer.Management.Smo.Server.AttachDatabase(String name, StringCollection files)\n\n===================================\n\nUnable to open the physical file \"D:\\FlexiFormWF\\FlexiFormWF\\FlexiFormDB.mdf\". Operating system error 5: \"5(Access is denied.)\". (.Net SqlClient Data Provider)\n\n------------------------------\nFor help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&amp;ProdVer=10.00.1600&amp;EvtSrc=MSSQLServer&amp;EvtID=5120&amp;LinkId=20476\n\n------------------------------\nServer Name: FAHAD-PC\\MSSQL\nError Number: 5120\n</code></pre>\n"},{"tags":["sql","sql-server","notin"],"answer_count":8,"favorite_count":6,"up_vote_count":19,"down_vote_count":0,"view_count":22624,"score":19,"question_id":173041,"title":"NOT IN vs NOT EXISTS","body":"<p>Which of these queries is the faster?</p>\n\n<p>NOT EXISTS:</p>\n\n<pre><code>SELECT ProductID, ProductName \nFROM Northwind..Products p\nWHERE NOT EXISTS (SELECT 1 FROM Northwind..[Order Details] od WHERE p.ProductId = od.ProductId)\n</code></pre>\n\n<p>Or NOT IN:</p>\n\n<pre><code>SELECT ProductID, ProductName \nFROM Northwind..Products p\nWHERE p.ProductID NOT IN (SELECT ProductID FROM Northwind..[Order Details])\n</code></pre>\n\n<p>The query execution plan says they both do the same thing.  If that is the case, which is the recommended form?</p>\n\n<p>This is based on the NorthWind database.</p>\n\n<p>[Edit]</p>\n\n<p>Just found this helpful article: \n<a href=\"http://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx\">http://weblogs.sqlteam.com/mladenp/archive/2007/05/18/60210.aspx</a></p>\n\n<p>I think I'll stick with NOT EXISTS.</p>\n"},{"tags":["sql","sql-server","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13132616,"title":"Retrieving unique names and based on that fetching the dates","body":"<p>I have two stored procedures like below:</p>\n\n<pre><code>Select distinct TempName from History_Table \n\nSelect TempName,RunDate from History_Table  where TempName=@tempname\n</code></pre>\n\n<p>How do I use a single stored procedure to get a result set of distinct <code>tempname</code>'s and their associated <code>RunDate</code>?</p>\n\n<pre><code>  TempName     RunDate                       RunBy\n\n1   test    2012-10-11 00:00:00.000 chandu\n2   testing 2012-12-15 00:00:00.000 kumar\n3   asdsad  2012-08-09 00:00:00.000 asdsad\n4   test    2012-12-12 00:00:00.000 asdasds\n15  test    2012-10-01 00:00:00.000 asdaddf\n15  test    2012-09-12 00:00:00.000 bghgh\n\nI have to display like\n\nTempName   RunDate                   RunBy\ntest       dates(in a dropdown)      lastrun name(i.e asdasds)\n</code></pre>\n"},{"tags":["c#","asp.net","sql","sql-server","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13133614,"title":"Fetching data using last Datetime","body":"<p>I have to show these details in a gridview as Tempname as unique and associated datetime in drodown and the last run by name in a label. Unable to upload the Table picture as i dont have enough reputation.</p>\n\n<pre>\n    private void GridLoading()\n    {\n        DataSet ds = new DataSet();\n        ds = Common.LoadingGrid();\n        GridView1.DataSource = ds;\n        GridView1.DataBind();\n    }\n\n    protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)\n    {\n        if (e.Row.RowType == DataControlRowType.DataRow)\n        {\n            DataSet ds = new DataSet();\n            Label lblName = e.Row.FindControl(\"Label1\") as Label;\n            ds = Common.RunByDate(lblName.Text);\n            DropDownList ddl = e.Row.FindControl(\"DropDownList1\") as DropDownList;\n\n            ddl.DataTextField = \"RunDate\";\n            ddl.DataValueField = \"RunDate\";\n            ddl.DataSource = ds;\n            ddl.DataBind();\n            var items = ddl.Items;\n          }           \n    }\n</pre>\n\n<p>But i am unable to get the Runby name in the label.How can i display it?Below are my stored procedures</p>\n\n<pre>\n    Select distinct TempName from SV_JobHistoryTable \n\n    SELECT TempName,RunDate\n    FROM SV_JobHistoryTable  where TempName=@tempname \n</pre>\n"},{"tags":["sql","sql-server","tsql","dynamic-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13132253,"title":"OpenQuery in SQL Server","body":"<p>I don't know how to config the <code>OpenQuery</code> function.</p>\n\n<p>I want to use <code>OpenQuery</code> to query database in test project. But I don't know how config the servername param </p>\n\n<pre><code>DECLARE @Sql varchar(max)\nDECLARE @SQLExcuteSentence varchar(max)\n\nSET @Sql = 'declare @UserID INT \nselect @UserID = 1\n\ndeclare @TotalGroupByFields nvarchar(2000)\nselect @TotalGroupByFields = ''Media''\n\ndeclare @CostDataFileds nvarchar(2000)\nselect @CostDataFileds = ''''\n\ndeclare @OtherDataFields nvarchar(max)\nselect @OtherDataFields = ''MonitoringSpotNumber,MonitoringTotalSeconds,BaseCost,ColourLoading,PositionLoading,WeekendLoading,Discount''\n\ndeclare @MasterFilterId nvarchar(max)\nselect @MasterFilterId =''DateRange=20060601-20121231''+char(13)+''IncludeGuests=0''\n\ndeclare @RatingTargetId nvarchar(2000)\nselect @RatingTargetId =''''\n\ndeclare @IsEnableFinancialCloseDate INT\nselect @IsEnableFinancialCloseDate = 0\n\ndeclare @MasterDisplayFormat nvarchar(2000)\nselect @MasterDisplayFormat = ''5''\n\nexec [dbo].[USP_MatrixReport] @UserID, @TotalGroupByFields, @CostDataFileds, @OtherDataFields,  @MasterFilterId, @RatingTargetId, @IsEnableFinancialCloseDate, @MasterDisplayFormat, 0'\n\nSET @SQLExcuteSentence = 'SELECT * FROM OPENQUERY(SQLConn,' + '''' + @Sql + '''' + ')'\nEXEC (@SQLExcuteSentence);\n</code></pre>\n\n<p>the SQLConn is what?? </p>\n"},{"tags":["sql","perl","oracle","parsing","lexical-analysis"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13132696,"title":"Parse Oracle Query using perl","body":"<p>I have to perform lexical analysis on the oracle query and separate the query to various parts (based on the clauses)in perl. For example,Consider : </p>\n\n<pre><code>Select deleteddate,deletedby from temptable where id = 10;\n</code></pre>\n\n<p>I need to print </p>\n\n<pre><code>select : deleteddate , deletedby\nfrom : temptable\nwhere : id = 10\n</code></pre>\n\n<p>I used this code snippet : </p>\n\n<pre><code>my $parser= SQL::Statement-&gt;new();\n$parser-&gt;{PrinteError}=1;\nmy $query = SQL::Statement-&gt;new(\"select deleteddate,deletedby from temptable where id =10\",$parser);\n\nmy @columns = $query-&gt;columns();\n\nprint $columns[0]-&gt;name();\n</code></pre>\n\n<p>Though this prints deleteddate, this fails when i give a subquery inside the select clause:</p>\n\n<pre><code>Select deleteddate,deletedby,(select 1+1 from dual) from temptable where id = 10;\n</code></pre>\n\n<p>Can you please point me in the correct direction.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13134070,"title":"Dealing with single quotes in excel vba sql queries","body":"<p>I am using excel sql queries to fetch data from the backend according to the selection i make in a dropdown box.However my sql queries are not working in cases where there is a single quote(') in the dropdown box value. For example-- Men's Wear . Please suggest me a way to deal with this problem</p>\n\n<pre><code>    SQL = \"select Segment,Weeks,Value from [Category performance data$] where       Departments='\" &amp;       Sheet3.Range(\"Dept_name\").Value &amp; _\n     \"' and Metric ='Total Spend' group by Segment,Weeks,Value\"\n    Call execQry   \n</code></pre>\n"},{"tags":["sql","replace"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13132841,"title":"Remove everything after string","body":"<p>I have a table with a field that contains descriptions for items sold on my site.</p>\n\n<p>In our infinite wisdom, when we first started the site, we pasted code for a Facebook Like button into the description, each just a little different, as it has product info in the link. We now have about 400 items with the code in it.</p>\n\n<p>This is an example of what I'm dealing with:</p>\n\n<blockquote>\n  <p>-Whipped Up, Fluffy Chocolate-On-Chocolate Taste; A Lighter Way To Enjoy Chocolate <br>\n  - 45% Less Fat <br> <br> <br> &lt; iframe src=\"http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.oursite.com%2Findex.php%3Fmain_page%3Dproduct_info%26cPath%3D33_36%26products_id%3D106&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;colorscheme=light&amp;height=80\"\n  scrolling=\"no\" frameborder=\"0\" style=\"border:none; overflow:hidden;\n  width:450px; height:80px;\" allowTransparency=\"true\">&lt; /iframe></p>\n</blockquote>\n\n<p>I want to remove the <code>&lt;iframe</code> and everything past it. I have been looking around for examples using REPLACE and/or LEFT, but can't find what I need, as I am not very well versed in SQL language.</p>\n\n<p>It will always be at the end of the products_description field, so I don't need to worry about saving anything past it, only before it.</p>\n\n<p>The best I can come up with is </p>\n\n<pre><code>SELECT LEFT(REPLACE('&lt;iframe%','&lt;iframe%',' '),0)\n</code></pre>\n\n<p>but that doesn't seem to work.</p>\n\n<p>Thank you for any help you can offer on this, as it will take me much less time than editing each description.</p>\n\n<p>UPDATE: Still haven't found an answer, after trying many variations of what has been suggested. It runs, but makes no edit to the column.</p>\n\n<p>I also tried this, after finding it on another site. The same, but thought it might give someone an idea of how to proceed:</p>\n\n<pre><code>select left(`products_description`,instr('&lt;iframe',`products_description`)-1) FROM products_description\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13105756,"title":"Extract specific bundle product orders","body":"<p>how can i extract specific bundle product orders from the following tables. for example, if i wanna extract all orders where product <code>Wireless Mouse</code> has been used as bundle products.</p>\n\n<p><strong>Expecting result 1:</strong></p>\n\n<pre>\n    orders_id     product_name       qty    \n       1000      Wireless Mouse      1\n       1000      Laptop              1\n       1001      Wireless Mouse      3\n       1001      PC                  3\n       1003      Wireless Mouse      4\n       1003      IPAD                4\n</pre>\n\n<p><strong>Second Question:</strong></p>\n\n<p>if i wanna extract only the products orders which are used with \"Wireless Mouse\" as bundle how can I do that?</p>\n\n<p><strong>Expecting result 2:</strong></p>\n\n<pre>\n    orders_id     product_name       qty    \n       1000      Laptop              1\n       1001      PC                  3     \n       1003      IPAD                4 \n</pre>\n\n<p><strong>if possible please help me about the following:</strong> </p>\n\n<p>if i wanna extract only the \"Laptop\" orders which are used with \"Wireless Mouse\" as bundle how can I do that?</p>\n\n<p><strong>Expecting result 3:</strong></p>\n\n<pre>\n    orders_id     product_name       qty    \n       1000      Laptop              1  \n</pre>\n\n<p><strong>Example Data:</strong></p>\n\n<p><strong>Table 1: orders</strong></p>\n\n<pre>\n    id   customer_id      order_price  purchase_date\n    1000   1                   203     12/6/2011\n    1001   2                   304     12/6/2011\n    1002   1                   1000    12/6/2011\n    1003   1                   233     12/6/2011\n    1004   1                   44      12/7/2011\n    1005   3                   50      12/7/2011\n    1006   4                   67      12/7/2011\n    1007   5                   99      12/7/2011\n    1008   6                   299     12/7/2011\n    1009   7                   199     12/7/2011\n\n</pre>\n\n<p><strong>Table 2 : customers</strong></p>\n\n<pre>\n\n    id  email                          name\n    1   aa@dealboard.com.au            james\n    2   bb@dealboard.com.au            Ryan\n    3   cc@live.com.au                 Sili\n    4   dd@acgglobal.com               Mame\n    5   ee.heinrich@det.nsw.edu.au     Kane\n    6   ff@optusnet.com.au             Kratos\n    7   ssy@hotmail.com                Kim\n\n</pre>\n\n<p><strong>table 3: products</strong></p>\n\n<pre>\n\n    id  name\n    1   Laptop\n    2   PC\n    3   Wireless Mouse\n    4   IPAD\n    5   iphone\n    6   Wireless Keyboard\n    7   Printer\n    8   Glaxy S3\n    9   Scanner\n    10  PS3\n\n</pre>\n\n<p><strong>table 4: product_orders</strong></p>\n\n<pre>\n    id     orders_id product_id qty\n        1   1000      1         1\n        2   1000      3         1\n        3   1001      2         3\n        4   1001      3         3\n        5   1003      4         4\n        6   1003      3         4\n        7   1004      5         1\n        8   1005      6         1\n        9   1007      7         2\n        10  1008      8         1\n\n</pre>\n\n<p>Sorry guys, i have asked too much today.</p>\n"}]}
