{"count":102428,"tag":"sql","questions":[{"tags":["mysql","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13281628,"title":"SELECT INTO local variable undeclared?","body":"<p>I have the following in an sql file I am executing...</p>\n\n<pre><code>DECLARE rowcount INT;\n\nSELECT COUNT(*) INTO rowcount\nFROM VRG_PROBLEM_ACCOUNT PA \nWHERE NEW.CustName = PA.CustNAME \nAND NEW.AreaCode = PA.AreaCode \nAND NEW.PhoneNumber = PA.PhoneNumber;\n</code></pre>\n\n<p>And yet I'm getting</p>\n\n<pre><code>ERROR 1327 (42000): Undeclared variable: rowcount\n</code></pre>\n\n<p>In another file I am doing the same type of SELECT...INTO localvariable and it works.</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13281277,"title":"SQL: How to get the original sorting when joining two tables","body":"<p>I have two tables</p>\n\n<p>The first looks like this:</p>\n\n<pre><code>Name|Sir Name|Adress\nMax1|Musterma|Muster Street\nMax2|Musterma|Muster Street\nMax3|Musterma|Muster Street\nMax4|Musterma|Muster Street\nMax5|Musterma|Muster Street\n</code></pre>\n\n<p>The second looks like this:</p>\n\n<pre><code>Name|Money\nMax3|50.00\nMax1|40.00\nMax3|43.00\nMax2|77.00\nMax3|18.00\nMax1|97.00\nMax1|87.00\n</code></pre>\n\n<p>I want to use Left Join and make an Output like this:</p>\n\n<pre><code>Max1|Musterma|Muster Street|40.00\nMax1|Musterma|Muster Street|97.00\nMax1|Musterma|Muster Street|87.00\nMax2|Musterma|Muster Street|77.00\nMax3|Musterma|Muster Street|50.00\nMax3|Musterma|Muster Street|43.00\nMax3|Musterma|Muster Street|18.00\nMax4|Musterma|Muster Street|\nMax5|Musterma|Muster Street|\n</code></pre>\n\n<p>What I get is like:</p>\n\n<pre><code>Max3|Musterma|Muster Street|50.00\nMax1|Musterma|Muster Street|40.00\nMax3|Musterma|Muster Street|43.00\nMax2|Musterma|Muster Street|77.00\nMax3|Musterma|Muster Street|18.00\nMax1|Musterma|Muster Street|97.00\nMax1|Musterma|Muster Street|87.00\nMax4|Musterma|Muster Street|\nMax5|Musterma|Muster Street|\n</code></pre>\n\n<p>What I get is sorted after the position of the entries of the second (right) table.</p>\n\n<p>But I want to get the list sorted</p>\n\n<ol>\n<li>after the position of the user in the first</li>\n<li>after the position of the money in the second</li>\n</ol>\n\n<p>Can anyone tell me what i further have to write?</p>\n"},{"tags":["sql","object","data","invalid","dbo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13281474,"title":"Invalid object name error while trying to populate table.","body":"<p>I'm trying to load data into my tables but SQL wont recognize any of my tables, the error i get is invalid Data Object. I used a visio plugin Forwarded Engineer to create the tables from ERD diagrams, this is a sample SQL the plugin generated:</p>\n\n<pre><code>CREATE TABLE [dbo].[VEHICLE] (\n[VEH_ID] INTEGER  NOT NULL  \n, [VEH_YEAR] CHAR(10)  NOT NULL  \n, [VEH_MILAGE] NUMERIC(10,0)  NOT NULL  \n, [VEH_DESC] CHAR(10)  NULL  \n, [VEH_AC] BINARY(10)  NOT NULL  \n, [VEH_RADIO] BINARY(10)  NOT NULL  \n, [VEH_TYPE] BINARY(10)  NOT NULL  \n, [VEH_PRICE] DECIMAL  NOT NULL  \n, [COLOUR_ID] INTEGER  NOT NULL  \n, [CLASS_ID] INTEGER  NOT NULL  \n, [ORI_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[VEHICLE] ADD CONSTRAINT [VEHICLE_PK] PRIMARY KEY CLUSTERED (\n[VEH_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[EMPLOYEE]') AND type in (N'U'))\n    DROP TABLE [dbo].[EMPLOYEE]\nGO\nCREATE TABLE [dbo].[EMPLOYEE] (\n[EMP_LNAME] CHAR(10)  NOT NULL  \n, [EMP_FNAME] CHAR(10)  NOT NULL  \n, [EMP_PHONE] CHAR(10)  NOT NULL  \n, [EMP_ID] INTEGER  NOT NULL  \n, [EMP_SALARY] NUMERIC(10,2)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[EMPLOYEE] ADD CONSTRAINT [EMPLOYEE_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CUSTOMER]') AND type in (N'U'))\n    DROP TABLE [dbo].[CUSTOMER]\nGO\nCREATE TABLE [dbo].[CUSTOMER] (\n[CUS_ID] INTEGER  NOT NULL  \n, [CUS_FNAME] CHAR(10)  NOT NULL  \n, [CUS_LNAME] CHAR(10)  NOT NULL  \n, [CUS_INITIAL] CHAR(10)  NULL  \n, [CUS_PHONE] CHAR(10)  NOT NULL  \n, [CUS_ADDRESS] CHAR(10)  NOT NULL  \n)\nGO\n\nCREATE TABLE CATS ( \nV_CODE      INTEGER PRIMARY KEY, \nV_NAME      VARCHAR(35) NOT NULL, \nV_CONTACT   VARCHAR(15) NOT NULL, \nV_AREACODE  CHAR(3) NOT NULL, \nV_PHONE     CHAR(8) NOT NULL, \nV_STATE     CHAR(2) NOT NULL, \nV_ORDER     CHAR(1) NOT NULL);\n\nALTER TABLE [dbo].[CUSTOMER] ADD CONSTRAINT [CUSTOMER_PK] PRIMARY KEY CLUSTERED (\n[CUS_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CLASS]') AND type in (N'U'))\n    DROP TABLE [dbo].[CLASS]\nGO\nCREATE TABLE [dbo].[CLASS] (\n[CLASS_ID] INTEGER  NOT NULL  \n, [CLASS_NAME] CHAR(10)  NOT NULL  \n, [CLASS_TYPE] CHAR(10)  NOT NULL  \n, [CLASS_DESC] CHAR(10)  NULL  \n, [CLASS_INV] CHAR(10)  NOT NULL  \n, [MODEL_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[CLASS] ADD CONSTRAINT [CLASS_PK] PRIMARY KEY CLUSTERED (\n[CLASS_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[COMMISSION]') AND type in (N'U'))\n    DROP TABLE [dbo].[COMMISSION]\nGO\nCREATE TABLE [dbo].[COMMISSION] (\n[COMM_ID] INTEGER  NOT NULL  \n, [COMM_Percentage] NUMERIC(2,0)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[COMMISSION] ADD CONSTRAINT [COMMISSION_PK] PRIMARY KEY CLUSTERED (\n[COMM_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[INVOICE]') AND type in (N'U'))\n    DROP TABLE [dbo].[INVOICE]\nGO\nCREATE TABLE [dbo].[INVOICE] (\n[EMP_ID] INTEGER  NOT NULL  \n, [CUS_ID] INTEGER  NOT NULL  \n, [WAR_ID] INTEGER  NOT NULL  \n, [INV_ID] INTEGER  NOT NULL  \n, [INV_DATE] DATETIME  NOT NULL  \n, [INV_PRICE] DECIMAL  NOT NULL  \n, [INV_TAX] DECIMAL  NOT NULL  \n, [INV_TOTAL] DECIMAL  NOT NULL  \n, [INV_NOTES] CHAR(10)  NULL  \n, [REP_ID] INTEGER  NULL  \n, [FIN_ID] INTEGER  NULL  \n)\nGO\n\nALTER TABLE [dbo].[INVOICE] ADD CONSTRAINT [INVOICE_PK] PRIMARY KEY CLUSTERED (\n[INV_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[COLOUR]') AND type in (N'U'))\n    DROP TABLE [dbo].[COLOUR]\nGO\nCREATE TABLE [dbo].[COLOUR] (\n[COLOUR_ID] INTEGER  NOT NULL  \n, [COLOUR_NAME] CHAR(10)  NULL  \n)\nGO\n\nALTER TABLE [dbo].[COLOUR] ADD CONSTRAINT [COLOUR_PK] PRIMARY KEY CLUSTERED (\n[COLOUR_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[WARRANTY]') AND type in (N'U'))\n    DROP TABLE [dbo].[WARRANTY]\nGO\nCREATE TABLE [dbo].[WARRANTY] (\n[WAR_ID] INTEGER  NOT NULL  \n, [WAR_TYPE] CHAR(10)  NOT NULL  \n, [WAR_TERM] CHAR(10)  NOT NULL  \n, [WAR_DESC] CHAR(10)  NULL  \n)\nGO\n\nALTER TABLE [dbo].[WARRANTY] ADD CONSTRAINT [WARRANTY_PK] PRIMARY KEY CLUSTERED (\n[WAR_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CAR_OWNERSHIP]') AND type in (N'U'))\n    DROP TABLE [dbo].[CAR_OWNERSHIP]\nGO\nCREATE TABLE [dbo].[CAR_OWNERSHIP] (\n[VEH_ID] INTEGER  NOT NULL  \n, [CUS_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[CAR_OWNERSHIP] ADD CONSTRAINT [CAR_OWNERSHIP_PK] PRIMARY KEY CLUSTERED (\n[CUS_ID]\n, [VEH_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ORIGIN]') AND type in (N'U'))\n    DROP TABLE [dbo].[ORIGIN]\nGO\nCREATE TABLE [dbo].[ORIGIN] (\n[ORI_ID] INTEGER  NOT NULL  \n, [ORI_NAME] CHAR(10)  NOT NULL  \n, [ORI_LOCATION] CHAR(10)  NULL  \n, [ORI_PHONE] CHAR(10)  NULL  \n, [ORI_DATE] DATETIME  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[ORIGIN] ADD CONSTRAINT [ORIGIN_PK] PRIMARY KEY CLUSTERED (\n[ORI_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FINANCING]') AND type in (N'U'))\n    DROP TABLE [dbo].[FINANCING]\nGO\nCREATE TABLE [dbo].[FINANCING] (\n[FIN_ID] INTEGER  NOT NULL  \n, [FIN_OPTION] CHAR(10)  NOT NULL  \n, [FIN_RATE] DECIMAL(10,4)  NOT NULL  \n, [FIN_LENGHT] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[FINANCING] ADD CONSTRAINT [FINANCING_PK] PRIMARY KEY CLUSTERED (\n[FIN_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ADMINISTRATOR]') AND type in (N'U'))\n    DROP TABLE [dbo].[ADMINISTRATOR]\nGO\nCREATE TABLE [dbo].[ADMINISTRATOR] (\n[EMP_ID] INTEGER  NOT NULL  \n, [QUALIFICATION] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[ADMINISTRATOR] ADD CONSTRAINT [ADMINISTRATOR_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REPAIRS]') AND type in (N'U'))\n    DROP TABLE [dbo].[REPAIRS]\nGO\nCREATE TABLE [dbo].[REPAIRS] (\n[REPAIR_DESC] CHAR(10)  NOT NULL  \n, [REPAIR_COST] DECIMAL  NOT NULL  \n, [REP_ID] INTEGER  NOT NULL  \n, [EMP_ID] INTEGER  NULL  \n)\nGO\n\nALTER TABLE [dbo].[REPAIRS] ADD CONSTRAINT [REPAIRS_PK] PRIMARY KEY CLUSTERED (\n[REP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TASK]') AND type in (N'U'))\n    DROP TABLE [dbo].[TASK]\nGO\nCREATE TABLE [dbo].[TASK] (\n[task_ID] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[TASK] ADD CONSTRAINT [TASK_PK] PRIMARY KEY CLUSTERED (\n[task_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SALESPERSON]') AND type in (N'U'))\n    DROP TABLE [dbo].[SALESPERSON]\nGO\nCREATE TABLE [dbo].[SALESPERSON] (\n[EMP_ID] INTEGER  NOT NULL  \n, [COMM_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[SALESPERSON] ADD CONSTRAINT [SALESPERSON_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MECHANIC]') AND type in (N'U'))\n    DROP TABLE [dbo].[MECHANIC]\nGO\nCREATE TABLE [dbo].[MECHANIC] (\n[EMP_ID] INTEGER  NOT NULL  \n, [LICENSE] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[MECHANIC] ADD CONSTRAINT [MECHANIC_PK] PRIMARY KEY CLUSTERED (\n[EMP_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[REPAIR_TASK]') AND type in (N'U'))\n    DROP TABLE [dbo].[REPAIR_TASK]\nGO\nCREATE TABLE [dbo].[REPAIR_TASK] (\n[REP_ID] INTEGER  NOT NULL  \n, [PART_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[REPAIR_TASK] ADD CONSTRAINT [REPAIR_TASK_PK] PRIMARY KEY CLUSTERED (\n[REP_ID]\n, [PART_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PARTS]') AND type in (N'U'))\n    DROP TABLE [dbo].[PARTS]\nGO\nCREATE TABLE [dbo].[PARTS] (\n[SUPP_ID] INTEGER  NOT NULL  \n, [PART_ID] INTEGER  NOT NULL  \n, [PART_NAME] CHAR(10)  NOT NULL  \n, [PART_DESC] CHAR(10)  NULL  \n, [VENDOR_ID] INTEGER  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[PARTS] ADD CONSTRAINT [PARTS_PK] PRIMARY KEY CLUSTERED (\n[PART_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VENDOR]') AND type in (N'U'))\n    DROP TABLE [dbo].[VENDOR]\nGO\nCREATE TABLE [dbo].[VENDOR] (\n[VENDOR_ID] INTEGER  NOT NULL  \n, [VEN_NAME] CHAR(10)  NOT NULL  \n, [VEN_LOCATION] CHAR(10)  NOT NULL  \n, [VEN_PHONE] CHAR(10)  NOT NULL  \n, [VEN_ADDRESS] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[VENDOR] ADD CONSTRAINT [VENDOR_PK] PRIMARY KEY CLUSTERED (\n[VENDOR_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Table1]') AND type in (N'U'))\n    DROP TABLE [dbo].[Table1]\nGO\nCREATE TABLE [dbo].[Table1] (\n)\nGO\n\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CAR_BRAND]') AND type in (N'U'))\n    DROP TABLE [dbo].[CAR_BRAND]\nGO\nCREATE TABLE [dbo].[CAR_BRAND] (\n[BRAND_ID] INTEGER  NOT NULL  \n, [BRAND_NAME] CHAR(10)  NOT NULL  \n, [BRAND_COUNTRY] CHAR(10)  NOT NULL  \n)\nGO\n\nALTER TABLE [dbo].[CAR_BRAND] ADD CONSTRAINT [CAR_BRAND_PK] PRIMARY KEY CLUSTERED (\n[BRAND_ID]\n)\nGO\nGO\n\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CAR_MODEL]') AND type in (N'U'))\n    DROP TABLE [dbo].[CAR_MODEL]\nGO\nCREATE TABLE [dbo].[CAR_MODEL] (\n[BRAND_ID] INTEGER  NOT NULL  \n, [MODEL_ID] INTEGER  NOT NULL  \n, [MODEL_NAME] CHAR(10)  NOT NULL  \n, [MODEL_DESC] CHAR(10)  NULL  \n)\nGO\n\nALTER TABLE [dbo].[CAR_MODEL] ADD CONSTRAINT [CAR_MODEL_PK] PRIMARY KEY CLUSTERED (\n[MODEL_ID]\n)\nGO\nGO\n\nALTER TABLE [dbo].[VEHICLE] WITH CHECK ADD CONSTRAINT [ORIGIN_VEHICLE_FK1] FOREIGN KEY (\n[ORI_ID]\n)\nREFERENCES [dbo].[ORIGIN] (\n[ORI_ID]\n)\nALTER TABLE [dbo].[VEHICLE] WITH CHECK ADD CONSTRAINT [COLOUR_VEHICLE_FK1] FOREIGN KEY (\n[COLOUR_ID]\n)\nREFERENCES [dbo].[COLOUR] (\n[COLOUR_ID]\n)\nALTER TABLE [dbo].[VEHICLE] WITH CHECK ADD CONSTRAINT [CLASS_VEHICLE_FK1] FOREIGN KEY (\n[CLASS_ID]\n)\nREFERENCES [dbo].[CLASS] (\n[CLASS_ID]\n)\nGO\n\nGO\n\nGO\n\nALTER TABLE [dbo].[CLASS] WITH CHECK ADD CONSTRAINT [CAR_MODEL_CLASS_FK1] FOREIGN KEY (\n[MODEL_ID]\n)\nREFERENCES [dbo].[CAR_MODEL] (\n[MODEL_ID]\n)\nGO\n\nGO\n\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [REPAIRS_INVOICE_FK1] FOREIGN KEY (\n[REP_ID]\n)\nREFERENCES [dbo].[REPAIRS] (\n[REP_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [CUSTOMER_INVOICE_FK1] FOREIGN KEY (\n[CUS_ID]\n)\nREFERENCES [dbo].[CUSTOMER] (\n[CUS_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [WARRANTY_INVOICE_FK1] FOREIGN KEY (\n[WAR_ID]\n)\nREFERENCES [dbo].[WARRANTY] (\n[WAR_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [FINANCING_INVOICE_FK1] FOREIGN KEY (\n[FIN_ID]\n)\nREFERENCES [dbo].[FINANCING] (\n[FIN_ID]\n)\nALTER TABLE [dbo].[INVOICE] WITH CHECK ADD CONSTRAINT [SALESPERSON_INVOICE_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[SALESPERSON] (\n[EMP_ID]\n)\nGO\n\nGO\n\nGO\n\nALTER TABLE [dbo].[CAR_OWNERSHIP] WITH CHECK ADD CONSTRAINT [VEHICLE_CAR_OWNERSHIP_FK1] FOREIGN KEY (\n[VEH_ID]\n)\nREFERENCES [dbo].[VEHICLE] (\n[VEH_ID]\n)\nALTER TABLE [dbo].[CAR_OWNERSHIP] WITH CHECK ADD CONSTRAINT [CUSTOMER_CAR_OWNERSHIP_FK1] FOREIGN KEY (\n[CUS_ID]\n)\nREFERENCES [dbo].[CUSTOMER] (\n[CUS_ID]\n)\nGO\n\nGO\n\nGO\n\nALTER TABLE [dbo].[ADMINISTRATOR] WITH CHECK ADD CONSTRAINT [EMPLOYEE_ADMINISTRATOR_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[EMPLOYEE] (\n[EMP_ID]\n)\nGO\n\nALTER TABLE [dbo].[REPAIRS] WITH CHECK ADD CONSTRAINT [MECHANIC_REPAIRS_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[MECHANIC] (\n[EMP_ID]\n)\nGO\n\nGO\n\nALTER TABLE [dbo].[SALESPERSON] WITH CHECK ADD CONSTRAINT [COMMISSION_SALESPERSON_FK1] FOREIGN KEY (\n[COMM_ID]\n)\nREFERENCES [dbo].[COMMISSION] (\n[COMM_ID]\n)\nALTER TABLE [dbo].[SALESPERSON] WITH CHECK ADD CONSTRAINT [EMPLOYEE_SALESPERSON_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[EMPLOYEE] (\n[EMP_ID]\n)\nGO\n\nALTER TABLE [dbo].[MECHANIC] WITH CHECK ADD CONSTRAINT [EMPLOYEE_MECHANIC_FK1] FOREIGN KEY (\n[EMP_ID]\n)\nREFERENCES [dbo].[EMPLOYEE] (\n[EMP_ID]\n)\nGO\n\nALTER \n</code></pre>\n\n<p>Here's what i wrote to load the tables, which is giving me errors.</p>\n\n<pre><code>/* LOAD EMPLOYEE DATA*/\nINSERT INTO dbo.EMPLOYEE VALUES ('ANDERSON','MIKE',6135796468,1,63768);\nINSERT INTO [dbo].[EMPLOYEE] VALUES ('STEVENS','JERRY',6139175631,2,83420);\nINSERT INTO [EMPLOYEE] VALUES ('ANDRES','GEORGE',6137909602,3,79999);\nINSERT INTO EMPLOYEE VALUES ('ANDRES','GEORGE',6137909602,3,79999);\n</code></pre>\n\n<p>I tried a few different naming conventions but nothing seemed to work. Sorry if the formatting here is incorrect, not used to it yet. </p>\n"},{"tags":["sql","oracle"],"answer_count":5,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":33836,"score":5,"question_id":1766445,"title":"Oracle: how to set user password unexpire?","body":"<p>There is some construction</p>\n\n<pre><code>ALTER USER scott PASSWORD EXPIRE\n</code></pre>\n\n<p>But how can I similair set password to unexpired state?</p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":12,"score":-1,"question_id":13281216,"title":"hard mysql stmnt about creating this view using various tables","body":"<p>So here are three relations:</p>\n\n<p><strong>Table Members</strong></p>\n\n<blockquote>\n  <p>Members(member_id, name, city, state)</p>\n</blockquote>\n\n<p>where member_id is the primary key</p>\n\n<p><strong>Table Borrowed</strong></p>\n\n<blockquote>\n  <p>Borrowed(borrow_id, lib_id, member_id)</p>\n</blockquote>\n\n<p>where borrow_id is the primary key </p>\n\n<p><strong>Table Libraries</strong></p>\n\n<blockquote>\n  <p>Libraries(lib_id, lib_address, lib_city, lib_state)</p>\n</blockquote>\n\n<p>where lib_id is the primary key</p>\n\n<p>Both lib_id and member_id are foreign keys</p>\n\n<p>Create a view called frequent_borrowers that reports, for every library, the member that has borrowed from that library the largest number of times. The view should contain the columns: (lib_id, member_id, name, num_borrowed). The last column is a count of how many times the borrower has made a check out at the library. (Note that you are not counting how many items the borrower has borrowed, but the number of times the borrower has gone to the library and checked out things.) In situations where multiple members tie for the most visits to a given library, include all such members in your results. Make sure your view includes every library, even ones where no members have checked out anything. Stores with no borrows should have NULL values for all columns except the lib_id column. </p>\n"},{"tags":["sql","wordpress"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13267446,"title":"wordpress get_results($sql, ARRAY_A) query comments has duplicate comment","body":"<p>When using <code>get_results($sql, ARRAY_A)</code> to query wp_comments, there is a comment in the result.</p>\n\n<p>The sql is below</p>\n\n<pre><code>SELECT comment_ID,comment_parent,comment_author,comment_author_url,comment_author_email,comment_content,comment_date,comment_type,ck_rating_up,ck_rating_down \nFROM $wpdb-&gt;comments \nLEFT JOIN $comment_rating_table \nON ($wpdb-&gt;comments.comment_ID = $comment_rating_table.ck_comment_id) \nWHERE comment_post_ID = $post_id AND comment_approved = 1 \norder by comment_id ASC\n</code></pre>\n\n<p>How to avoid duplicate comments?</p>\n"},{"tags":["mysql","sql","innodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13279681,"title":"innoDB - should i turn innodb_flush_log_at_trx_commit off?","body":"<p>I have a database table that has 100s of thousands of rows. Entering a new row or updating a row takes a little bit of time. To do 50 updates (in the format of 'update table set field = 1234 where id = 5678; update table set field = 912 where id = 582; ...') it can take 4 or 5 seconds.</p>\n\n<p>How can i reduce this time? Is it worth playing with the innodb_flush_log_at_trx_commit setting? How can I set that setting just for certain connections/queries?</p>\n\n<p>Is it safe to play with innodb_flush_log_at_trx_commit? The data isn't important, as long as one copy (either before the UPDATE command or after) is in tact (it is only setting some somewhat random data updates... no important data gets changed in these queries)</p>\n\n<p>the bulk of the queries on this tables are SELECTS so that is why i use innodb.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","ruby-on-rails","database","performance","postgresql"],"answer_count":2,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":919,"score":14,"question_id":9407442,"title":"Optimise PostgreSQL for fast testing","body":"<p>I am switching to PostgreSQL from SQLite for a typical Rails application.</p>\n\n<p>The problem is that running specs became slow with PG.<br>\nOn SQLite it took ~34 seconds, on PG it's ~76 seconds which is <strong>more than 2x slower</strong>.</p>\n\n<p>So now I want to apply some techniques to <strong>bring the performance of the specs on par with SQLite</strong> with no code modifications (ideally just by setting the connection options, which is probably not possible).</p>\n\n<p>Couple of obvious things from top of my head are:</p>\n\n<ul>\n<li>RAM Disk (good setup with RSpec on OSX would be good to see)</li>\n<li>Unlogged tables (can it be applied on the whole database so I don't have change all the scripts?)</li>\n</ul>\n\n<p>As you may have understood I don't care about reliability and the rest (the DB is just a throwaway thingy here).<br>\nI need to get the most out of the PG and make it <strong>as fast as it can possibly be</strong>.</p>\n\n<p><strong>Best answer</strong> would ideally describe the <em>tricks</em> for doing just that, setup and the drawbacks of those tricks.</p>\n\n<p><strong>UPDATE:</strong> <code>fsync = off</code> + <code>full_page_writes = off</code> only decreased time to ~65 seconds (~-16 secs). Good start, but far from the target of 34.</p>\n\n<p><strong>UPDATE 2:</strong> I <a href=\"https://gist.github.com/1573414\">tried to use RAM disk</a> but the performance gain was within an error margin. So doesn't seem to be worth it.</p>\n\n<p><strong>UPDATE 3:*</strong>\nI found the biggest bottleneck and now my specs run as fast as the SQLite ones.</p>\n\n<p>The issue was the database cleanup that did the <strong>truncation</strong>. Apparently SQLite is way too fast there.</p>\n\n<p>To \"fix\" it I open a <strong>transaction</strong> before each test and roll it back at the end.</p>\n\n<p>Some numbers for ~700 tests.</p>\n\n<ul>\n<li>Truncation: SQLite - 34s, PG - 76s.</li>\n<li>Transaction: SQLite - 17s, PG - 18s.</li>\n</ul>\n\n<p>2x speed increase for SQLite.\n4x speed increase for PG.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13278058,"title":"SQL Server LIKE on datepart doesnt work for the time element","body":"<p>I am trying to return rows in my table that have a certain date but also a certain hour.</p>\n\n<p>At the moment I can handle the date part of the query just fine by using:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05%' \n</code></pre>\n\n<p>That works perfectly and returns all rows where col1 has a value of the 5th November. However when I also want to add the hour to the end like this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05 15%' \n</code></pre>\n\n<p>That query returns no rows, even though there are rows with the hour set to 15.</p>\n\n<p>It looks like the time element of the query needs some kind of different syntax? I just wondered if anyone can confirm this?</p>\n"},{"tags":["mysql","sql","query","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13280677,"title":"How to do a moving average on a range of dates in SQL?","body":"<p>Let's just say I have two columns, DATE and VALUE. The dates are not necessarily regularly spaced intervals. How can I create a moving average on VALUE over the past N days? I'm using postgres but mysql solutions would also be helpful.</p>\n\n<p>Data:</p>\n\n<pre><code>DATE    VALUE\n2012-11-05 10\n2012-10-29 31\n2012-10-22 108\n2012-10-17 3654\n2012-10-16 1187\n2012-10-15 12033\n2012-10-09 41\n2012-10-01 85\n2012-09-25 20\n2012-09-24 285\n2012-09-17 20\n2012-09-10 20\n2012-09-04 41\n2012-08-27 63\n2012-08-20 52\n2012-08-13 160\n</code></pre>\n"},{"tags":["php","sql","pdo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13281099,"title":"Single Quotes in PDO Prepared Statments","body":"<p>I have always had issues with getting single quotes into PDO prepared statements. Here is what I have:  </p>\n\n<pre><code>$query2 = $dbh2-&gt;prepare(\"SELECT um.uploadID,\n\nselCol = CASE WHEN linkID = 1 THEN 'uploadDataMapID' ELSE 'uploadData' END\n\nFROM UploadMappings as um\");\n</code></pre>\n\n<p>When this is passed to SQL it ends up with ' 'uploadDataMapID' ' and ' 'uploadData' ' </p>\n\n<p>What is the best way to pass single quotes to MSSQL server using PDO prepared statements?</p>\n\n<p>Any help would be great.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","arrays","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13280875,"title":"JOIN on array of ids in sql","body":"<p>I have three tables:\nTABLE 1 contracts</p>\n\n<pre><code>-------------------\nid  |  contract_name\n--------------------\n1      test name\n2      test name 2\n2      test name 3\n4      test name 4\n</code></pre>\n\n<p>TABLE 2 rooms</p>\n\n<pre><code>-------------------\nid  |  room_name\n--------------------\n1      test name\n2      test name 2\n2      test name 3\n4      test name 4\n</code></pre>\n\n<p>TABLE 3 promos</p>\n\n<pre><code>    ----------------------------------\n    id  |  contracts_id  |   rooms_id\n    ----------------------------------\n    1          1,3            1,3,4\n    1          2              1,2,3\n</code></pre>\n\n<p>No I am trying to do an inner join to get the names of the contract and the rooms according to the ids in the array saved in database. I know this is not ideal at all, but I can not change the database set up. So here is what I would like to do with my query, but obviously it is impossible. Does anyone have any idea on how I can accomplish this?</p>\n\n<pre><code>mysql_query(\"SELECT pb.*, c.contract_name, r.room_name FROM promo_blackouts AS pb\nINNER JOIN contracts as c ON c.contract_id IS IN pb.contracts_id\nINNER JOIN rooms as r ON r.room_id IS IN pb.rooms_id \nWHERE pb.promo_id = '$promo_id'\") or die(mysql_error());\n</code></pre>\n"},{"tags":["sql","postgresql","cpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13280769,"title":"postgreSQL join gives error","body":"<p>This join is </p>\n\n<pre><code>SELECT \ns.id,\ns.sector_abbr,\ns.sector_desc,\nl.id,\nl.sector_id,\nl.vendor_address_id\nFROM sectors s\nLEFT JOIN sector_vendor_address_link l\nON s.id = l.sector_id\n</code></pre>\n\n<p>is giving me this error</p>\n\n<p><code>ERROR: ERROR: permission denied for relation sector_vendor_address_link</code></p>\n\n<p>Using this id and password through razorSQL, I was able to do updates to these same tables, so I can't imagine it is a permissions problem. Perhaps I am wrong. Is my join just malformed?</p>\n\n<p>Thanks!</p>\n\n<p>EDIT:</p>\n\n<p>It seems that I must manually set All privileges for each table. Is there any way using phpPgAdmin to globally set a users permission for the entire database?</p>\n"},{"tags":["php","sql","flex","mobile-application"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13280729,"title":"Need various help building a flex mobile application that connects to a database","body":"<p>Need various help building a flex mobile application that connects to a database.  </p>\n\n<p>I know that I can ask my questions here, but the thing is I have a deadline ( :( ) and some of my questions are not being answered... don't get me wrong I DO appreciate your help and I know I should do  a lot myself. is there a place where I can ask for help from someone... for a small amount of money (I wish I was rich but I am not)</p>\n"},{"tags":["sql","sql-server","sql-server-2008","hierarchical-data"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13280265,"title":"Flattening a SQL hierarchical data structure in SQL without cursors","body":"<p>Let's say I have the following table</p>\n\n<pre><code>SectionID ParentIDSection DatumID\n   1           NULL         1\n   2            1           2\n   3            1           3\n   4            2           4\n</code></pre>\n\n<p>Now, let's  pretend I want to select all DatumIDs under SectionID = 1, even if it is part of its descendants children so that I would get</p>\n\n<pre><code>SectionID DatumID\n  1         1\n  1         2\n  1         3\n  1         4\n</code></pre>\n\n<p>Is it possible to this without explicitly iterating over the first table recursively with a cursor?</p>\n"},{"tags":["sql","sql-server","performance","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13280548,"title":"Performance issue in retrieving multiple output of the same column with different values from a single table","body":"<p>is there anyway to get the following results from query without joining the same table three times (or) without reading the same \"wordlocation\" table three times (or more if there are more words)? If there are three or more words, it takes about over a minute for the results to be returned.</p>\n\n<p>Currently \"wordlocation\" table has three rows being (\"bookid\",\"wordid\",\"location\") and it currently has 917802 rows.</p>\n\n<p>What I am trying to do is </p>\n\n<ol>\n<li>retrieve the \"bookid\" that contains all the words specified in the query by \"wordid\".</li>\n<li>sum word count of all words (from the query) from each book</li>\n<li>minimum values of each word location, e.g. (min(w0.location), min (w1.location)</li>\n</ol>\n\n<p>I have tried commenting out count(w0.wordid) and min(location) calculations to see whether they are affecting the performance but this is not the case. Joining the same table multiple time was the case.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SYLB7.jpg\" alt=\"enter image description here\"></p>\n\n<p>(this is the same code as the above image)   </p>\n\n<pre><code>select \n    w0.bookid, \n    count(w0.wordid) as wcount, \n    abs(min(w0.location) + min(w1.location) + min(w2.location)) as wordlocation, \n    (abs(min(w0.location) - min(w1.location)) + abs(min(w1.location) - min(w2.location))) as distance \n    from \n    wordlocation as w0 \n    inner join \n    wordlocation as w1 on w0.bookid = w1.bookid \n    join \n    wordlocation as w2 on w1.bookid = w2.bookid \n    where \n    w0.wordid =3 \n    and \n    w1.wordid =52 \n    and \n    w2.wordid =42\n    group by w0.bookid \n    order by wcount desc;\n</code></pre>\n\n<p>This is the result that I am looking for, and which I got from running the above query, but it takes too long if I specify more than 3 words, e.g. (w0 = 3, w1 = 52 , w2 = 42, w3 = 71)</p>\n\n<p><img src=\"http://i.stack.imgur.com/08dD5.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","datanucleus","jdoql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13168112,"title":"JDOQL: How to execute \"CREATE USER\"?","body":"<p>I'm trying to create a USER (in this case using a H2 database) using JDOQL in DataNucleus</p>\n\n<pre><code>PersistenceManager pm=pmf.getPersistenceManager();\nQuery query = pm.newQuery(\"javax.jdo.query.SQL\", \"CREATE USER GUEST PASSWORD 'abc'\");\nquery.execute();\n</code></pre>\n\n<p>result: <strong>org.h2.jdbc.JdbcSQLException: Method is only allowed for a query. Use execute or executeUpdate instead of executeQuery</strong>;</p>\n\n<p>How can i execute this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","tsql"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13279901,"title":"Grouping by Week in SQL, but displaying full datetime?","body":"<p>the following statement: </p>\n\n<pre><code>group by datepart(wk, createdon)\n</code></pre>\n\n<p>Groups the selected rows according to the week in which they fall.  My select statement shows the following: </p>\n\n<pre><code>SELECT \n    datepart(wk, createdon) week,\n</code></pre>\n\n<p>How do I display the actual datetime of the week(\"12-10-2012\"), instead of the number (\"12\")?</p>\n"},{"tags":["sql","database-design"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13280398,"title":"Payments Database Design","body":"<p>I am using SQLSERVER EXPRESS</p>\n\n<p>I am currently trying to design a membership type database design that can keep track of monthly payments. I have a couple tables one for keeping track of MEMBERS another to keep track of PLANTYPES(ex. individualmembership plus cost $25.00) or employeemembership plus cost $15.00) which includes a Cost field. </p>\n\n<p>I also have a DUES table where I am trying to keep track of Membership Fees depending on the plan type that is assigned to each member. So the question I have is, so far I have the following fields</p>\n\n<pre><code>DUAAMT, PAID(YES OR NO), DESC(COMMENTS),MEMID(LINKED FIELD TO MEMBERS TABLE),\nPID(LINKED FIELD TO THE PLANTYPES TABLE)\n</code></pre>\n\n<p>I am having trouble figuring out the proper way to keep track of how much the member owes for that month, also what if they paid extra how would I keep track of that?</p>\n\n<p>My idea was to have a Credit a field where any extra money paid would sit in this field and once the month is due I would check if the member had any existing credit first if not they would owe the full amount due that month.</p>\n"},{"tags":["python","sql","query","sqlalchemy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13271894,"title":"Interfacing with Sqlalchemy query object to extend, custom query types","body":"<p>I'm working on adding pagination functionality to my models. I could do this with a method in a mixin, I think I understand what pagination is in this context, but I'm looking to add queries so I can pass in pagination wherever I want without hard coding a model method and without a mixin e.g.:</p>\n\n<pre><code>Mymodel.query.filter(Mymodel.attr=='X').paginate(**args, **kwargs)\n</code></pre>\n\n<p>flask-sqlalchemy does this, but I'm not using that, though I've gone over it to attempt to extract some of the functionality.</p>\n\n<p>So if I have something like this method:</p>\n\n<pre><code>def paginate(self, page, per_page=20):\n        items = self.limit(per_page).offset((page - 1) * per_page).all()\n        return Pagination(self, page, per_page, self.count(), items)\n</code></pre>\n\n<p>How do I insert that as something with an interface in and out in the sqlalchemy query chain? I somewhat do and don't follow how it is being done in flask-sqlalchemy, but I want to extract/learn how to do this and more control over querying in the future, refine my use of sqlalchemy, so I do not exactly know where I'm going with it, just asking a question and going from there.</p>\n\n<p>Long answer: to keep reading the sqlalchemy docs and code until I achieve greater understanding. I'm looking to extend orm.Query -- which I've done, but I don't see how I can tie this into my project yet because I don't understand the underlying mechanics of sqlalchemy, but I think I just need to add my paginate query to the declarative base Base I'm using but will see once I get back to working on it. </p>\n"},{"tags":["sql","database","sqlite","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13280165,"title":"SQLite3 do a SELECT, order by multiple cross-table columns","body":"<p>I'm trying to produce a \"history/logs page\" out of 3 tables, tables looks like this:</p>\n\n<h2>TableA</h2>\n\n<pre><code>CreationDate\nModifDate\nLastAccessedDate\nFileName\n</code></pre>\n\n<h2>TableB</h2>\n\n<pre><code>Guid_TableA\nCreationDate\nModifDate\nLastAccessedDate\nFileName\n</code></pre>\n\n<h2>TableC</h2>\n\n<pre><code>Guid_TableA\nLastModifDate\nFileName\n</code></pre>\n\n<p>FWIW, despite the similarities in columns names, <strong>there's no relation between dates in these tables</strong>. The only valid column that related between them is <strong>Guid_TableA</strong></p>\n\n<h2>What I want is...</h2>\n\n<p>Select records &amp; order them by date. <strong>I'm trying to build an event log, so returning duplicated entries like this is valid</strong> (as long as results are ordered correctly by dates)</p>\n\n<pre><code>(TableA)  file-1.txt    '01/01/2012 00:00:00' (CreationDate)\n(TableA)  file-1.txt    '01/01/2012 00:00:01' (ModifDate)\n(TableB)  file-2.txt    '01/01/2012 00:00:02' (CreationDate)\n(TableA)  file-1.txt    '01/01/2012 00:00:03' (LastAccessedDate)\n</code></pre>\n\n<p>Hopefully my intention is clear; I basically want to select records ordered by date (that is, ordered against multiple cross-tables columns, <strong>including duplicated entries</strong>)</p>\n\n<p><strong>My question is:</strong> Is this possible? If so, how?</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13280164,"title":"MySQL: Column count doesn't match value count at row 1","body":"<p>I apologise for the lengthy code, but I am trying to create an audit table (called aud_candles) which is a duplicate of 'candles' but with a new unique key, aud_can_id.  Before an update takes place on 'candles', I want the trigger to save the current state of that row in 'aud_candles'.</p>\n\n<pre><code>Target Server Type    : MySQL\nTarget Server Version : 50165\nFile Encoding         : utf-8\n\nDate: 11/07/2012 23:05:38 PM\n*/\n\nSET NAMES utf8;\nSET FOREIGN_KEY_CHECKS = 0;\n\n-- ----------------------------\n--  Table structure for `candles`\n-- ----------------------------\nDROP TABLE IF EXISTS `candles`;\nCREATE TABLE `candles` (\n  `can_id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `can_name` varchar(255) NOT NULL,\n  `can_description` varchar(1024) NOT NULL,\n  `can_dye_id` int(10) unsigned NOT NULL,\n  `can_snt_id` int(10) unsigned NOT NULL,\n  `can_wick_id` int(10) unsigned NOT NULL,\n  `can_wax_id` int(10) unsigned NOT NULL,\n  `can_retail_cost` float(10,2) NOT NULL,\n  `can_materials_cost` float(10,2) NOT NULL,\n  `can_dye_used` float(10,2) NOT NULL,\n  `can_snt_used` float(10,2) NOT NULL,\n  `can_wick_used` float(10,2) NOT NULL,\n  `can_wax_used` float(10,2) NOT NULL,\n  `can_updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`can_id`),\n  KEY `idx_candles_dyes_id` (`can_dye_id`) USING BTREE,\n  KEY `idx_candles_scents_id` (`can_snt_id`) USING BTREE,\n  KEY `idx_candles_wax_id` (`can_wax_id`) USING BTREE,\n  KEY `fk_candles_wick_id` (`can_wick_id`),\n  CONSTRAINT `fk_candles_dye_id` FOREIGN KEY (`can_dye_id`) REFERENCES `dyes` (`dye_id`),\n  CONSTRAINT `fk_candles_scent_id` FOREIGN KEY (`can_snt_id`) REFERENCES `scents` (`snt_id`),\n  CONSTRAINT `fk_candles_wax_id` FOREIGN KEY (`can_wax_id`) REFERENCES `wax` (`wax_id`),\n  CONSTRAINT `fk_candles_wick_id` FOREIGN KEY (`can_wick_id`) REFERENCES `wicks` (`wic_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;\n\ndelimiter ;;\nCREATE TRIGGER `trg_audit_update_candles` BEFORE UPDATE ON `candles` FOR EACH ROW BEGIN  \n    INSERT INTO aud_candles \n(can_id, \ncan_name, \ncan_description, \ncan_dye_id, \ncan_snt_id, \ncan_wick_id, \ncan_wax_id, \ncan_materials_cost, \ncan_retail_cost,\ncan_updated)  \n    VALUES \n(OLD.can_id, \nOLD.can_name, \nOLD.can_description, \nOLD.can_dye_id, \nOLD.can_snt_id, \nOLD,can_wick_id, \nOLD.can_wax_id, \nOLD.can_materials_cost, \nOLD.can_retail_cost,\nOLD.can_updated);  \nEND;\n ;;\ndelimiter ;\n\n-- ----------------------------\n--  Records of `candles`\n-- ----------------------------\nBEGIN;\nINSERT INTO `candles` VALUES ('1', 'Test Name', 'Test Description', '12', '10', '102', '1', '0.00', '0.00', '5', '25.00', '15.00', '500.00', '2012-11-07 13:29:02');\nCOMMIT;\n\n\nDROP TABLE IF EXISTS `aud_candles`;\nCREATE TABLE `aud_candles` (\n  `aud_can_id` int(11) NOT NULL AUTO_INCREMENT,\n  `can_id` int(10) unsigned NOT NULL,\n  `can_name` varchar(255) CHARACTER SET latin1 NOT NULL,\n  `can_description` varchar(1024) CHARACTER SET latin1 NOT NULL,\n  `can_dye_id` int(10) unsigned NOT NULL,\n  `can_snt_id` int(10) unsigned NOT NULL,\n  `can_wick_id` int(10) unsigned NOT NULL,\n  `can_wax_id` int(10) unsigned NOT NULL,\n  `can_retail_cost` float(10,2) NOT NULL,\n  `can_materials_cost` float(10,2) NOT NULL,\n  `can_dye_used` float(10,2) NOT NULL,\n  `can_snt_used` float(10,2) NOT NULL,\n  `can_wick_used` float(10,2) NOT NULL,\n  `can_wax_used` float(10,2) NOT NULL,\n  PRIMARY KEY (`aud_can_id`),\n  KEY `idx_candles_dyes_id` (`can_dye_id`) USING BTREE,\n  KEY `idx_candles_scents_id` (`can_snt_id`) USING BTREE,\n  KEY `idx_candles_wax_id` (`can_wax_id`) USING BTREE,\n  KEY `fk_candles_wick_id` (`can_wick_id`),\n  CONSTRAINT `fk_aud_candles_dye_id` FOREIGN KEY (`can_dye_id`) REFERENCES `dyes` (`dye_id`),\n  CONSTRAINT `fk_aud_candles_scent_id` FOREIGN KEY (`can_snt_id`) REFERENCES `scents` (`snt_id`),\n  CONSTRAINT `fk_aud_candles_wax_id` FOREIGN KEY (`can_wax_id`) REFERENCES `wax` (`wax_id`),\n  CONSTRAINT `fk_aud_candles_wick_id` FOREIGN KEY (`can_wick_id`) REFERENCES `wicks` (`wic_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\n\n\n\nSET FOREIGN_KEY_CHECKS = 1;\n\nUPDATE candles set can_name = 'Test Name 2' WHERE can_id = 1;\n</code></pre>\n\n<p>When performing the update I receive:</p>\n\n<p>Error</p>\n\n<blockquote>\n  <p>Column count doesn't match value count at row 1</p>\n</blockquote>\n\n<p>If I remove the trigger everything works fine, so it must be related to the trigger?</p>\n"},{"tags":["sql","variables","xslt"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13279400,"title":"can we stoe SQL query in XSL variable","body":"<p>Can we store sql query in xsl variable </p>\n\n<pre><code>&lt;xsl:variable name=\"Query\" select=\"'SELECT X FROM ABC WHERE ID&gt;=2'\"/&gt;\n</code></pre>\n\n<p>If i write like that i am getting error for illegal '>' found,and I have tried another way like this</p>\n\n<pre><code> &lt;xsl:variable name=\"Query\" select=\"'SELECT X FROM ABC WHERE ID gt;=2'\"/&gt;\n</code></pre>\n\n<p>Then i am getting illegal '&gt;' element error...</p>\n\n<p>Please help me how to store a query in a variable\nI am using a big queries like which invloves joins and all SQL stuff..I facing the same issue please help me out..</p>\n"},{"tags":["java","sql","el","predicate","lambdaj"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":106,"score":4,"question_id":13237998,"title":"Is there a Java library for defining predicates as SQL-like strings?","body":"<p>Lambdaj (and some other similar libraries) provides a <code>having</code> function which allows me to define predicates like so (example directly from the <a href=\"http://code.google.com/p/lambdaj/wiki/LambdajFeatures\" rel=\"nofollow\">lambdaj Features</a> page):</p>\n\n<pre><code>List&lt;Person&gt; oldFriends = \n    filter(having(on(Person.class).getAge(), greaterThan(30)), meAndMyFriends);\n</code></pre>\n\n<p>I'd quite like to be able to define my Java predicate object using a straightforward string syntax, <code>\"age &gt; 30\"</code> - similar to a SQL where clause - so the filter above becomes something like:</p>\n\n<pre><code>List&lt;Person&gt; oldFriends = \n    filter(having(Person.class, \"age &gt; 30\"), meAndMyFriends);\n</code></pre>\n\n<p>Does such a library exist, or can anyone recommend some building blocks for the query parsing part I could use to build one myself? I don't actually mind what kind of predicate (hamcrest, guava etc) it creates.</p>\n\n<p>Off the top of my head I can think of a number of things it would be awesome for it to support: equalities and inequalities, on custom and primitive types, and/or/not, parentheses, <code>LIKE</code> (for Strings), <code>in(...)</code>, interpretiation of enum names, properties of properties.</p>\n\n<p>Here's an example of a more complex predicate:</p>\n\n<pre><code>\"salesCount &gt; 10 and (country='UK' or city='New York')\nand attitude not in (MENACING, RUDE)\nand product.name &lt;&gt; 'Widget' \"\n</code></pre>\n\n<p>(This example assumes that the class the predicate is applied to (say a <code>SalesPerson</code> class) has methods getSalesCount(), getCountry(), and getCity(), as well as getAttitude() (which returns an enum). It also has a property getProduct which returns a type with method getName). </p>\n\n<p><strong>Motivation</strong>: we have a client-server system that has multiple language APIs (currently Java &amp; C#); I'm looking for a language-agnostic way for a user to specify a predicate that filters on a set of objects the exact contents of which are known only to the server process (which is written in Java).</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":277,"score":0,"question_id":7471131,"title":"copy table from one database to another, maintaining table's structure and renaming it too","body":"<p>I want to copy a table (say tbl_1) from one database (say source_db) to another database (say target_db), with <strong>following things in consideration</strong>:</p>\n\n<ul>\n<li><p>Structure of table should be preserved, including primary key and\nauto-increment key</p></li>\n<li><p>While creating a copy of tbl_1, I need to rename it to cpy_tbl_1</p></li>\n</ul>\n\n<p>How it is possible <strong>using query</strong>?</p>\n\n<p>P.S. I know there will be many similar questions like mine, but I have those special considerations too.</p>\n"},{"tags":["java","sql","spring-jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":7695445,"title":"spring-jdbc for IN query having more than 1000 ids","body":"<p>I have a query like this -</p>\n\n<pre><code>SELECT * FROM mytable WHERE id IN()\n</code></pre>\n\n<p>The IN will get list of ids which are more than <code>1000</code>. So my query fails on Oracle.</p>\n\n<p>One option is that I insert the ids in a temp table and change the above query to join with this new table.</p>\n\n<p>Does spring-jdbc provides anything to solve this? Is there any pattern I can follow to write my DAO?</p>\n"},{"tags":["sql","parent","parent-child"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13280016,"title":"SQL - How to Query Parent Child Records by Descending TimeStamp","body":"<p>Here is my table</p>\n\n<pre><code>+------------+-----------+---------------+--------------+\n| CommentId  | ParentId  |  Timestamp    | CommentText  |\n+------------+---------+-----------+--------------------+\n|          1 |      NULL |  Jan 1 2:00pm |          a   |\n|          2 |      NULL |  Jan 1 2:01pm |          b   |\n|          3 |         1 |  Jan 1 3:03pm |          c   |\n|          4 |         2 |  Jan 1 5:00pm |          d   |\n|          5 |         2 |  Jan 1 5:01pm |          e   |\n|          6 |      NULL |  Jan 1 8:00pm |          f   |\n|          7 |         1 |  Jan 1 7:00pm |          g   |\n|          8 |         6 |  Jan 1 9:04pm |          h   |\n|          9 |         1 |  Jan 1 8:05pm |          i   |\n|         10 |      NULL |  Jan 1 9:04pm |          k   |\n+------------+-----------+---------------+--------------+\n</code></pre>\n\n<p>Currently I am using the following SQL to return the comments ordered by parent</p>\n\n<pre><code>SELECT c.*\nFROM Comments c\nORDER BY COALESCE(c.ParentId, c.Id)\n</code></pre>\n\n<p>The result is this:</p>\n\n<pre><code>+------------+-----------+---------------+--------------+\n| CommentId  | ParentId  |  Timestamp    | CommentText  |\n+------------+---------+-----------+--------------------+\n|          1 |      NULL |  Jan 1 2:00pm |          a   |\n|          3 |         1 |  Jan 1 3:03pm |          c   |\n|          7 |         1 |  Jan 1 7:00pm |          g   |\n|          9 |         1 |  Jan 1 8:05pm |          i   |    \n|          2 |      NULL |  Jan 1 2:01pm |          b   |    \n|          4 |         2 |  Jan 1 5:00pm |          d   |\n|          5 |         2 |  Jan 1 5:01pm |          e   |\n|          6 |      NULL |  Jan 1 8:00pm |          f   |    \n|          8 |         6 |  Jan 1 9:04pm |          h   |    \n|         10 |      NULL |  Jan 1 9:04pm |          k   |\n+------------+-----------+---------------+--------------+\n</code></pre>\n\n<p>I need to get the results in a Descending timestamp order. The result set should look like:</p>\n\n<pre><code> +------------+-----------+---------------+--------------+\n| CommentId  | ParentId  |  Timestamp    | CommentText  |\n+------------+---------+-----------+--------------------+         \n|         10 |      NULL |  Jan 1 9:04pm |          k   |\n|          6 |      NULL |  Jan 1 8:00pm |          f   |    \n|          8 |         6 |  Jan 1 9:04pm |          h   |    \n|          2 |      NULL |  Jan 1 2:01pm |          b   |    \n|          4 |         2 |  Jan 1 5:00pm |          d   |\n|          5 |         2 |  Jan 1 5:01pm |          e   |\n|          1 |      NULL |  Jan 1 2:00pm |          a   |\n|          3 |         1 |  Jan 1 3:03pm |          c   |\n|          7 |         1 |  Jan 1 7:00pm |          g   |\n|          9 |         1 |  Jan 1 8:05pm |          i   |    \n+------------+-----------+---------------+--------------+\n</code></pre>\n\n<p>The following does not work:</p>\n\n<pre><code>SELECT c.*\nFROM Comments c\nORDER BY COALESCE(c.ParentId, c.Id) Timestamp DESC\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13279666,"title":"how can I insert data in oracle AFTER a particular row that exist in the data table?","body":"<p>i have 10 rows of data in my table. now i want to insert a row of data just after the 9th data and before row 10..if am not mistaken ,in mysql db this thing is possible before there's a before and after clause, how bout in oracle ?</p>\n\n<p>here's my starting insert statement, let's say i want to insert it after the 9th data ,how?</p>\n\n<pre><code>INSERT INTO MYTABLE (TITLE,DESCRIPTION,STATUS) VALUES ('blahblah','descriptionblah',1);\n</code></pre>\n"},{"tags":["sql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13279685,"title":"Joining SQL tables on the column that has a value","body":"<p>Let's say I have the following tables</p>\n\n<pre><code>Collection DirectorId StudioId\n   1             NULL      1\n   2             2         NULL\n   3             NULL      2\n\n\nDirector MovieId\n  1        1\n  2        4\n\nStudio   MovieId\n  1        1\n  2        3\n  2        4\n  1        2\n</code></pre>\n\n<p>The collection table will always have either director or studio id but never both.</p>\n\n<p>How could I write a query to get all the movies in one a collection so that I end up with</p>\n\n<pre><code>CollectionID MovieID\n1            1\n1            2\n2            4\n3            3\n3            4\n</code></pre>\n\n<p>I hope this makes sense</p>\n"},{"tags":["sql","oracle","plsql","plsqldeveloper"],"answer_count":6,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1931,"score":0,"question_id":11003918,"title":"Oracle Convert Seconds to Hours:Minutes:Seconds","body":"<p>I have a requirement to display user available time in Hours:Minutes:Seconds format from a given total number of seconds value. Appreciate if you know a ORACLE function to do the same. I'm using Oracle.</p>\n\n<p>Thank you for your time.</p>\n"},{"tags":["php","mysql","sql","mysqli","mysql-num-rows"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13279248,"title":"mysqli_num_rows = 0 when it should be 1","body":"<p>I've been trying to resolve this problem on my own and for the life of me can't fix it..</p>\n\n<pre><code>//If they are, retreive them from the Person table    \nvar_dump($_POST['username']);\nvar_dump($_POST['password']);\n$select = $this-&gt; doQuery(\"SELECT * FROM Person WHERE username = '{$_POST['username']}' AND password = '\".md5($_POST['password']).\"'\");\nvar_dump($select);  \n\ntry {    \n    if (mysqli_num_rows($select) &gt; 0){\n        var_dump(mysqli_num_rows($select));\n        //fetching username and password from database\n        $fetch_array = mysqli_fetch_assoc($select);\n        var_dump($fetch_array);     \n        //Building a session for the user\n        $_SESSION['username'] = $fetch_array['username'];\n\n        //var_dump($_SESSION['username']);\n\n        //Redirecting the user to the index page        \n        header('Location:index.php');\n        return true;\n    }\n</code></pre>\n\n<p>The two var_dumps on the username and password on the 4th and 5th lines returned this: </p>\n\n<pre><code>string(8) \"johnny03\" \nstring(9) \"password3\" \nobject(mysqli_result)#3 (5) { [\"current_field\"]=&gt; int(0) [\"field_count\"]=&gt; int(8) [\"lengths\"]=&gt; NULL [\"num_rows\"]=&gt; int(0) [\"type\"]=&gt; int(0) } \n</code></pre>\n\n<p>The values that I entered for both the password and username are both valid (they are in the database under the correct columns, trust me). I have a feeling that something is wrong with my select query because the var dump on mysqli_num_rows($select) doesn't return anything.That being said, I've tried just about every change to the query that I could think of to make it work and still nothing :[  Can anyone help? </p>\n"},{"tags":["android","sql","sqlite"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":565,"score":1,"question_id":10491646,"title":"Importing SQL to SQLite","body":"<p>I have a database in sql format, and I need to make an sqlite copy in order to add it in an Android App I'm making.</p>\n\n<p>So far, I haven't got anything working for me. I tried to import the sql into SQLite Database Browser but it doesn't import properly, it always gives out an error statement. I tried creating a database then import the tables but it crashed.</p>\n\n<p>I tried using sqlite3 via Terminal (I'm using a Mac if that would make any difference), however the .import FILE TABLE format doesn't work, it says: \"Error: no such table: TABLE\". I tried creating an empty table using \"create table test42\" then \".import test.sql test42 and variants but it says \"Error: near \"test\": Syntax error\".</p>\n\n<p>I'm stuck. </p>\n\n<p>Any help would greatly help. Thanks.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13278535,"title":"Joining 3 tables to return each user's questionnaires between two dates (my challenging query)","body":"<p>I'll try to be brief and cut-to-the-chase as possible here.\nThese are my tables:</p>\n\n<p><strong>questionnaire:</strong> </p>\n\n<ul>\n<li>id[pk], </li>\n<li>name, </li>\n<li>type</li>\n</ul>\n\n<p><strong>user_x_questionnaire:</strong> </p>\n\n<ul>\n<li>id[pk],</li>\n<li>userid[fk],</li>\n<li>questionnaireid[fk references questionnaire.id]</li>\n<li>completedstate,</li>\n<li>iteration</li>\n</ul>\n\n<p><strong>questionnaire_time</strong></p>\n\n<ul>\n<li>id[pk]</li>\n<li>questionnaireid[fk references questionnaire.id]</li>\n<li>iteration</li>\n<li>publishdate[date/time]</li>\n<li>deadline[date/time]</li>\n</ul>\n\n<p>So, users want to fill out some questionnaires. Each user can be assigned to one or more that one questionnaire to fill (user_x_questionnaire). depending on the questionnaire type (one time or frequent) each questionnaire can be filled by the user more than once, therefore questionnaire_time table stores the publishdate and deadline of each of these times.</p>\n\n<p>What I want is a query that displays all the current questionnaires that the user is supposed to answer. That means the time of the questionnaire should be between publishdate and deadline. I went very close to the answer of this query until I realized all my returned results produce the same publish and deadline which is not what I wanted. This is my solution so far.</p>\n\n<pre><code>SELECT * FROM (\n   SELECT DISTINCT questionnaire.id\n        , questionnaire.`name`\n        , user_x_questionnaire.iteration\n        , completedstate\n        , questionnaire_time.publishdate\n        , questionnaire_time.deadline\n   FROM user_x_questionnaire\n      , questionnaire_time\n      , questionnaire \n   WHERE  userid={USERID} \n      AND user_x_questionnaire.questionnaireid=questionnaire.id\n      AND questionnaire.`type`='frequent' \n      AND user_x_questionnaire.questionnaireid=questionnaire_time.questionnaireid\n   ) As result\nWHERE '{CURRENT DATE}' BETWEEN publishdate AND deadline; \n</code></pre>\n\n<p>{USERID} and {CURRENT DATE} will be provided by the program.</p>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":298,"score":0,"question_id":7843296,"title":"How to drop tables with cyclic foreign keys in MySQL","body":"<p>I have two tables, Parent and Child. The column Parent.favorite_child has a foreign key constraint pointing to Child.id. And the column Child.parent has a foreign key constraint pointing to Parent.id.</p>\n\n<p>Now here's the weird part. I'm trying to drop my Child table, which <strong>contains no records</strong>, but MySQL is giving me the error:</p>\n\n<pre><code>ERROR 1217: Cannot delete or update a parent row: a foreign key constraint fails\nSQL Statement:\ndrop table `mydatabase`.`Child`\n</code></pre>\n\n<p>Why is MySQL throwing this error? There are literally no records in the Child table with which anything could be pointing to or from.</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13279388,"title":"Subquery, Nested Select, Join, something else? - not sure","body":"<p>When I try limiting my results, I limit them too much.</p>\n\n<pre><code>Select Distinct Agreements.AgrmntID, Agreements.Status, JobSites.SiteName,\n  AgreementCharges.TotalSaleAmt, AgreementCharges.PartID,\n  AgreementSchedules.FormanEmpID, LaborCodeTypes.RepairCode\nFrom Agreements Inner Join\n  AgreementCharges On Agreements.AgrmntID = AgreementCharges.AgrmntID Inner Join\n  JobSites On JobSites.CustSiteID = Agreements.CustSiteID Left Outer Join\n  AgreementSchedules On Agreements.AgrmntID = AgreementSchedules.AgrmntID\n  Left Outer Join\n  LaborCodeTypes On LaborCodeTypes.RepairID = AgreementSchedules.RepairID\nWhere Agreements.Status = 2 And AgreementCharges.PartID = 31 And\n  LaborCodeTypes.RepairCode = '04 - LS'\n</code></pre>\n\n<p>If there is no RepairCode matching '04 - LS' I still need the AgrmntID and TotalSaleAmt.  Likewise, if there is no AgreementSchedule at all, I need AgrmntID and TotalSaleAmt.</p>\n\n<p>Output:</p>\n\n<pre><code>AgrmntID  Status  SiteName  TotalSaleAmt  PartID  FormanEmpID  RepairCode\n-------------------------------------------------------------------------\n2         2       TEST01    $100.00       31      66           04 - LS\n2         2       TEST03    $300.00       31      21           04 - LS\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>AgrmntID  Status  SiteName  TotalSaleAmt  PartID  FormanEmpID  RepairCode\n-------------------------------------------------------------------------\n2         2       TEST01    $100.00       31      66           04 - LS\n2         2       TEST02    $200.00       31\n2         2       TEST03    $300.00       31      21           04 - LS\n</code></pre>\n\n<p>I've looked and looked and am now coming here for help.  Thank you in advance!!</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13277973,"title":"SQL average number of requests per user over time period","body":"<p>I have a table (Requests) with the following fields:</p>\n\n<p>id, requestType, userEmail, date</p>\n\n<p>I want to find the average number of requests per user over a given period (i.e. over the last month). Any suggestions?</p>\n\n<p>Thanks!\nGreg</p>\n"},{"tags":["sql","database","query","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13278632,"title":"Not sure how to write a query to return column associated with max value in group by","body":"<p>This query in postgres 9.2:</p>\n\n<pre><code>select max(amount) as max_analyte,concat(sarea,' ',sloc) as location,analyte\nfrom sample natural join station\ngroup by analyte,location\norder by max_analyte desc;\n</code></pre>\n\n<p>returns the following results:</p>\n\n<pre><code>max_analyte;location;analyte\n24196;\"CANDLESTICK POINT WINDSURFER CIRCLE\";\"COLI_TOTAL  \"\n19863;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_TOTAL  \"\n14136;\"CRISSY FIELD EAST\";\"COLI_TOTAL  \"\n12033;\"CHINA BEACH/BAKER BEACH BAKER BEACH WEST\";\"COLI_TOTAL  \"\n4352;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"COLI_E      \"\n3076;\"CHINA BEACH/BAKER BEACH BACKER BEACH EAST\";\"COLI_TOTAL  \"\n2851;\"CHINA BEACH/BAKER BEACH LOBOS CREEK\";\"ENTERO      \"\n2064;\"AQUATIC PARK SHORELINE\";\"COLI_TOTAL  \"\n1918;\"CRISSY FIELD EAST\";\"ENTERO      \"\n...\n...\n\n74;\"CHINA BEACH/BAKER BEACH CHINA BEACH\";\"ENTERO      \"\n41;\"CRISSY FIELD WEST\";\"ENTERO      \"\n41;\"OCEAN BEACH NORTH LINCOLN WAY\";\"ENTERO      \"\n31;\"OCEAN BEACH NORTH LINCOLN WAY\";\"COLI_E      \"\n</code></pre>\n\n<p>The data set contains the levels of 3 types of bacteria (COLI_TOTAL, COLI_E, ENTERO) sampled at various locations around the Bay Area on many different dates. The query above finds the max value at each location for each type of bacteria, but now I'd like to find which type of bacteria is associated with the maximum value for each location. I'm just not sure how to write that query. I should mention I'm doing this to improve my SQL skills. Thanks for any help/suggestions.</p>\n\n<p>The tables schemas are as follows:</p>\n\n<pre><code>CREATE TABLE sample\n(\n  analyte character(12),\n  amount integer,\n  sdate date,\n  sid character varying(20)\n)\n\nCREATE TABLE station\n(\n  sid character(20),\n  sarea character varying(24),\n  sloc character varying(24),\n  sfreq character varying(24)\n)\n</code></pre>\n"},{"tags":["sql","postgresql","database-design","openerp","relational-division"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13253420,"title":"Many-to-many relation filter","body":"<p>I need to filter my query with categories table which has many2many relation with another table. Is it possible to filter query with many2many relation? Everything I tried with it, didn't give any good results.</p>\n\n<p>So there is table <code>res_partner</code> which has many2many field <code>category_id</code> relating to table <code>res_partner_category.res_partner</code>, or just let say partners can have many categories. What I need is to filter <code>res_partners</code> table where it has category named 'business' or 'retail'. If it doesn't have any of these categories, it should not be showed.</p>\n\n<p>Also there is another field in <code>res_partner</code> which is <code>category_value_ids</code> and has <code>one2many</code> relation with <code>res_partners_category_value</code>.\nSo to make it more clear:</p>\n\n<p><strong><code>res_partner</code></strong> has following fields with relations:</p>\n\n<ul>\n<li><p><code>category_id</code> to <code>res_partner_category</code> (many2many)</p></li>\n<li><p><code>category_value_ids</code> to <code>res_partner_category_value</code> (one2many)</p></li>\n<li><p><code>name</code> (char)</p></li>\n</ul>\n\n<p><strong><code>res_partner_category</code></strong> has following fields with relations:</p>\n\n<ul>\n<li><p><code>partner_ids</code> to <code>res_partner</code> (many2many)</p></li>\n<li><p><code>name</code> (char)</p></li>\n</ul>\n\n<p><strong><code>res_partner_category_value</code></strong> has following fields with relations:</p>\n\n<ul>\n<li><p><code>category_group_id</code> to <code>res_partner_category</code> (many2one)</p></li>\n<li><p><code>category_id</code> to <code>res_partner_category</code> (many2one)</p></li>\n<li><p><code>object_id</code> to<code>res_partner</code> (many2one)</p></li>\n</ul>\n\n<p>But if I try to use <code>res_partner_category_value</code> table in SQL query I get error that I can't use it in query.</p>\n\n<p>So for example: let say there are 4 partners, which have following categories:</p>\n\n<ul>\n<li>first: categ1, categ2, business</li>\n<li>second: retail</li>\n<li>third: retail, business</li>\n<li>fourth: categ1, categ2</li>\n</ul>\n\n<p>The query should return first, second and third partners.<br>\nOne person said to me its not possible to filter like this with many2many relation. So I wonder is it really not possible or just complicated?</p>\n\n<p>EDIT.\nOk so I found that there is one more table which is called res_partner_category_rel. Why I didn't see it, was because through Openerp administration interface, where you can see all objects of database, that table is not showed. You can only see it directly through database.\nSo table that I was missing and was confused because of that:</p>\n\n<p><strong>res_partner_category_rel:</strong></p>\n\n<ul>\n<li>partner_id (many2one)</li>\n<li>category_id (many2one)</li>\n</ul>\n"},{"tags":["sql","sybase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13265755,"title":"\"optimizer was unable to construct a valid access plan\" after Update ASA9 to SA12","body":"<p>After an update from ASA9 to SA12, there seems to be a problem with several procedures.\nThis occurs only if the user does not have DBA authority. In ASA9 everything worked fine.</p>\n\n<pre><code>SELECT * FROM UDP_ErmittleOffeneSaldenAuslagen('', '');\n</code></pre>\n\n<p>Brings up the following error:</p>\n\n<blockquote>\n  <p>Could not execute statement. The optimizer was unable to construct a\n  valid access plan SQLCODE=-727, ODBC 3 State=\"HY000\" Line 1, column 1</p>\n</blockquote>\n\n<p>But if I use the following statement, it works flawlessly:</p>\n\n<pre><code>CALL UDP_ErmittleOffeneSaldenAuslagen('', '');\n</code></pre>\n\n<p>The problem is, that I need the SELECT statement.\nThe procedure itself looks (for example) like this:</p>\n\n<pre><code>CREATE PROCEDURE \"FCAdmin\".\"UDP_ErmittleOffeneSaldenAuslagen\"() \nBEGIN\n  SELECT * FROM Akte\nEND\n</code></pre>\n\n<p>It looks like the error comes up if a specific table is used inside the procedure. If I use another table instead of \"Akte\" in the procedure's select statement, it works.\nAlso executing the statement</p>\n\n<pre><code>SELECT * FROM Akte\n</code></pre>\n\n<p>itself works.</p>\n\n<p>Any clues?</p>\n"},{"tags":["sql","sql-server-2005","query-optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":540,"score":0,"question_id":2355231,"title":"Problem using ROW_NUMBER() to get records randomly (SQL Server 2005)","body":"<p>I want to get 1000 records from a table randomly, so I use:</p>\n\n<pre><code>SELECT top 1000 \n       mycol1\n     , mycol2\n     , ROW_NUMBER() OVER (ORDER BY NEWID()) rn\nFROM mytable\n</code></pre>\n\n<p>However, I don't want to see <code>rn</code> in my resultset, so I do:</p>\n\n<pre><code>SELECT mycol1\n     , mycol2\nFROM (\n    SELECT top 1000 \n           mycol1\n         , mycol2\n         , ROW_NUMBER() OVER (ORDER BY NEWID()) rn\n    FROM mytable\n) a\n</code></pre>\n\n<p>When I do this, the results do not come randomly anymore. They come as if I just said top 10000 <strong>without</strong> randomization using row_number().</p>\n\n<p>When I change the query to </p>\n\n<pre><code>SELECT mycol1\n     , mycol2\n     , rn\nFROM (\n    SELECT top 1000 \n           mycol1\n         , mycol2\n         , ROW_NUMBER() OVER (ORDER BY NEWID()) rn\n    FROM mytable\n) a\n</code></pre>\n\n<p>they are random again.</p>\n\n<p>I guess sql server does some kind of optimization, saying \"hey, this guy doesn't need the column <code>rn</code> anyway, so just ignore it\". But this results to an unexpected behavior in this case. Is there any way to avoid this?</p>\n\n<p>PS: I use the ROW_NUMBER() trick because mytable has 10 mio. rows and </p>\n\n<pre><code>SELECT top 10000 *\nFROM mytable\nORDER BY NEWID()\n</code></pre>\n\n<p>runs forever, whereas with ROW_NUMBER() it takes only up to 30 secs.</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13277445,"title":"SQL query to find a winner depending on winning odds","body":"<p>I need a SQL query to determine a random winner. Each user has it's own winning odds. The more the winning_odds value is high, the more the user has chances to win. Here's a look at the table structure:</p>\n\n<pre><code>id    email            winning_odds\n1     test@test.com    3\n2     test2@test.com   5\n3     test3@test.com   2\n4     test4@test.com   1\n5     test5@test.com   9\n</code></pre>\n\n<p>MySQL database. Table has approximately 100000 rows. There's only one winner, one time. Emails are unique. Anyone has a solution?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","database","query","postgresql","select"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13278880,"title":"sql query returning multiple result using WHERE","body":"<p>There is a table name <code>Top_Up</code>. Its current snapshot is:\n<img src=\"http://i.stack.imgur.com/5CQha.png\" alt=\"Top_Up Table\">  </p>\n\n<p>When I run query <code>SELECT * FROM Top_Up WHERE Top_up_ID = (round(random() * 9 ) + 1);</code> on it, I am getting random result. Sometimes it is returning with two tuples, sometimes no tuples and sometime one tuple.  </p>\n\n<p>To debug I run the query <code>Select (round(random() * 9 ) + 1);</code> and it is always returning only one tuple in the result.  </p>\n\n<p><strong>Why I am getting this vague and random result?</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":11,"score":-1,"question_id":13273869,"title":"Update sql column by adding two fields together","body":"<p>I have a table with several columns.  I need to add data from one column(money) to another column(money) and then update then table row by row. </p>\n\n<p>I have tried select this creates a tempory column but no data gets saved into database</p>\n\n<p>I have tried insert but I need the new total to update into the field that is calculating</p>\n\n<p>I think my solution is an update but so far this is not working for me.</p>\n\n<p>Before update;</p>\n\n<pre><code>ID  ColumnNameCurrent   ColumnNameYTD\nA               20.20                       89.60 \nb               55.00                       147.38\nc               60.98                       258.46\nd               38.43                     7,894.32\n</code></pre>\n\n<p>After Update (what I hope for)</p>\n\n<pre><code>ID  ColumnNameCurrent   ColumnNameYTD\nA    20.20                    109.80 \nb    55.00                    202.38 \nc    60.98                    319.44 \nd    38.43                   7,932.75 \n</code></pre>\n\n<p>What I think the code should be;</p>\n\n<pre><code>UPDATE TableName\nSET ColumnNameYTD = ColoumNameYTD + ColumnNameCurrent\n</code></pre>\n\n<p>Can you please explain to me what I can change in the above to get the desired results.</p>\n"},{"tags":["sql","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13278552,"title":"GROUP BY WEEK with SQL","body":"<p>I have the following: </p>\n\n<p><a href=\"http://sqlfiddle.com/#!6/226ae/1\" rel=\"nofollow\">http://sqlfiddle.com/#!6/226ae/1</a></p>\n\n<p>I'm trying to now add one row for each week of the year, and filter the contacts accordingly.  CONTACTS has a datetime column.  The new table will look like: </p>\n\n<pre><code>        Status 1    Status 2    Status 3\nWeek 1      3          4           2\nWeek 2      1          5           3\nWeek 3      2          2           4\n</code></pre>\n\n<p>I think that DATEADD needs to be used, however I'm at a loss in terms of how to begin changing my query.  </p>\n\n<p>I do know that MySQL has a GROUP BY WEEK command, but I don't think that SQL has an equivalent.  What's the best way to accomplish this? </p>\n"},{"tags":["sql","query","dbms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":9593727,"title":"Inverted SQL query on a movie DBMS","body":"<p>I've got a task that says, find all firstname and surnames for those people who have been casting and directing in exactly same amount off movies, but where he/she has not been acting but only directing. Take in account only those who have been directing more than ten(10) movies.</p>\n\n<p>Here is the new query I tried:</p>\n\n<pre><code>SELECT p.firstname, p.lastname, COUNT(*) as CASTDIRECTING from PERSON p\n  INNER JOIN Filmparticipation fpCast ON fpCast.personid = p.personid\n  INNER JOIN Filmparticipation fpDirector ON fpDirector.personid = p.personid\n  INNER JOIN FilmItem fi ON fi.filmid = fpCast.filmid AND fi.filmid = fpDirector.filmid\n  INNER JOIN Film f ON f.filmid = fi.filmid\nWHERE (fpCast.parttype = 'cast' AND fpDirector.parttype = 'director' AND fpCast.personid = fpDirector.personid)\nGROUP BY p.lastname, p.firstname\nHAVING count(*) = (SELECT count(*) as DirectedOnly FROM Person p \n       INNER JOIN filmparticipation fpDirector ON fpDirector.personid = p.personid \n       INNER JOIN filmparticipation fpCast ON fpCast.personid = p.personid \n       WHERE (fpCast.parttype!='cast' AND fpDirector.parttype = 'director' AND \n           fpDirector.personid = fpCast.personid) \n       HAVING count(*) &gt; 10)\nORDER BY p.lastname ASC, p.firstname ASC;\n</code></pre>\n\n<p>Now it's returning empty rows. Do anyone see the errors in the query?</p>\n\n<p>Here are some relevant tables regarding the task..</p>\n\n<pre><code>create table filmparticipation (\n    partid int primary key,\n    personid int not null references person (personid),\n    filmid int not null references filmitem (filmid),\n    parttype text not null);\n\n\ncreate table person (\n    personid int primary key,\n    lastname text not null,\n    firstname text not null,\n    gender char(1),\n    check (gender = 'M' or gender = 'F'));\n\ncreate table filmitem (\n    filmid int primary key,\n    filmtype varchar(4) not null);\n\ncreate table film (\n    filmid int primary key references filmitem (filmid),\n    title text not null,\n    prodyear int);\n\ncreate index filmtitleindex on film (title);\ncreate index filmyearindex on film (prodyear);\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13277646,"title":"SQL Grouping by predefined date range","body":"<p>I have the following: </p>\n\n<p><a href=\"http://sqlfiddle.com/#!2/fca3d/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/fca3d/1</a></p>\n\n<p>I'm trying to now add one row for each week in the year, and filter the contacts accordingly.  The new table will look like: </p>\n\n<pre><code>        Status 1    Status 2    Status 3\nWeek 1      3          4           2\nWeek 2      1          5           3\nWeek 3      2          2           4\n</code></pre>\n\n<p>I think that DATEADD needs to be used, however I'm at a loss in terms of how to begin changing my query.  Any help would be much appreciated!  </p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","sqlite3","amazon-ec2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":130,"score":3,"question_id":12812721,"title":"Rails: SQLite3::CantOpenException: unable to open database file","body":"<p>I'm trying to use <code>delayed_job</code> to schedule tasks using Sqlite3, and it looks like apache isn't able to read my <code>production.sqlite3</code> file.</p>\n\n<p>Here's my <code>database.yml</code>:</p>\n\n<pre><code>production:\n  adapter: sqlite3\n  database: db/production.sqlite3\n  pool: 5\n  timeout: 5000\n</code></pre>\n\n<p>Here's the error I am getting (in log/production.log):</p>\n\n<pre><code>ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file:) \n</code></pre>\n\n<p>I have run <code>RAILS_ENV=production rake db:create</code> and <code>RAILS_ENV=production rake db:migrate</code>. The <code>db/production.sqlite3</code> file exists, and the db directory and all its subfolders are owned by <code>apache:apache</code>, which is who apache runs as. I'm using Phusion Passenger on Amazon EC2.</p>\n"},{"tags":["mysql","sql","ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13278741,"title":"Mysql MATCH AGAINST and IN","body":"<p>I need to search some data in my database. But main problem is that i search with match against:</p>\n\n<pre><code>...MATCH(description) AGAINST (\"*52*\" in boolean mode)\n</code></pre>\n\n<p>But on one iteration (or more, but with one query) i must search not only for 52, but for <code>50,51,52,...,59</code>  as before...\nBut is it real to do? \nAlso i do it with RoR:</p>\n\n<pre><code> @accums = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", size])\n</code></pre>\n\n<p>Or i will need to do iterator on rails, and search for all of them iteration by iteration?</p>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["sql","plsql","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13255193,"title":"How to get the 'top most' data","body":"<p>I want to get the 'top most' data from a table similar:</p>\n\n<pre>\nA B C | Id\n1 2 3 | 1\n  4 5 | 1\n    6 | 1</pre>\n\n<p>A-C=Columns<br>\n1-6 values (field not set are empty)<br>\nData is in descending order according to it's id in sequence<br>\n<br></p>\n\n<p>When I query I want to get the latest written data, in this example the query should give me 1, 4 and 6 in a single row:</p>\n\n<pre>\na b c | Id\n1 4 6 | 1\n</pre>\n\n<p>This is what I've tried but then I get the correct result but in different rows:</p>\n\n<pre><code>select * from\n( select id, a from dataTable where id=(select max(dt.dataRow) from dataTable dt where dt.id = 1)) a_query\nfull outer join\n( select id, b from dataTable where id=(select max(dt.dataRow) from dataTable dt where dt.id = 1)) b_query\non a_query.id=b_query.id \nfull outer join\n( select id, c from dataTable where id=(select max(dt.dataRow) from dataTable dt where dt.id = 1)) c_query \non nvl(a_query.id, b_query.id)=c_query.id\n</code></pre>\n\n<p>Preferable Oracle SQL</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":26,"score":4,"question_id":13278315,"title":"SQL Statement that Subs 0 for no Results","body":"<p>I am having an issue getting the results I want from my SQL statement. I know I'm probably missing something simple but I just can't see it.</p>\n\n<p>Here are my tables.<br></p>\n\n<pre><b>Table: Users</b> <i>(RoleID is linked to ID in Roles Table)</i>\n<b>ID</b>,   <b>FirstName</b>,   <b>LastName</b>,   <b>RoleID</b> \n1,    Matt,        Ryan,       1\n2,    Chipper,     Jones,      1\n3,    Julio,       Jones,      2\n4,    Jason,       Bourn,      3\n\n<b>Table: Roles</b>\n<b>ID</b>,    <b>Name</b>\n1,     Field Rep\n2,     Tech\n3,     Admin\n\n<b>Table: FRrequests</b> <i>(UserID is linked to ID in Users table)</i> \n<b>ID</b>,   <b>UserID</b>,    <b>Status</b>\n1,    1,         Open\n2,    1,         Submitted\n3,    1,         Delayed\n4,    1,         Complete\n</pre>\n\n<p>What I want is an SQL statement that shows me a count of all the \"Submitted\" &amp; \"Delayed\" requests for all the Field Reps. Below is an example of desired results.</p>\n\n<pre>\n<b>Name</b>             <b>Count</b>\nChipper Jones    0\nMatt Ryan        2\n</pre>\n\n<p>Here is the statement I have so far and the results it gives me.</p>\n\n<pre>\nSELECT Users.FirstName + ' ' + Users.LastName AS Name, COUNT(FRrequests.ID) AS 'Open Requests'\nFROM Users INNER JOIN\n          Roles ON Users.RoleID = Roles.ID LEFT OUTER JOIN\n          FRrequests ON Users.ID = FRrequests.UserID\nWHERE (Roles.Name = N'Field Rep') AND (FRrequests.Status = 'Submitted' OR FRrequests.Status = 'Delayed')\nGROUP BY Users.FirstName, Users.LastName\n\n<b>Name</b>             <b>Count</b>\nMatt Ryan        2\n\n</pre>\n\n<p>I know that the \"AND (FRrequests.Status = 'Submitted' OR FRrequests.Status = 'Delayed')\" part is what is breaking it. If I run it without that in the statement I get all the users but it counts all status not just submitted and delayed. I just can't figure out what I'm missing to get this to work. Any help would be greatly appreciated.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":43,"score":-2,"question_id":13105583,"title":"Two CTEs in one query in PostgreSQL","body":"<p>Could we have two CTEs in one query in Postgresql?    </p>\n"},{"tags":["sql","query","mode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13278372,"title":"Calculate mode in SQL","body":"<p>I have seen the answer from a previous post, which works fine but I have a small dilemma.\nTaking the same scenario:</p>\n\n<p><br>A table that list students' grades per class. I want a result set that looks like: </p>\n\n<pre><code>BIO...B \nCHEM...C \n</code></pre>\n\n<p><br>Where the \"B\" and \"C\" are the modes for the class and want to get the mode for the class.</p>\n\n<p>Once I applied the below query, i got the following output:</p>\n\n<pre><code>Class | Score | Freq  |  Ranking \n2010  |   B   | 8     |    1 \n2010  |   C   | 8     |    1 \n2011  |   A   | 10    |    1 \n2012  |   B   | 11    |    1\n</code></pre>\n\n<p>In 2010, I have two grades with the same frequency. What if..I just want to display the highest score, in this case will be \"B\". How can I achieve that? I would need to assign rankings to the letter grades, but I'm not sure how. Please advise.\nThanks.</p>\n\n<p>Prior post:\n<a href=\"http://stackoverflow.com/questions/2045075/sql-server-mode-sql\">SQL Server mode SQL</a></p>\n\n<p>The query I used to retrieve the data was the answer from Peter:</p>\n\n<pre><code>;WITH Ranked AS ( \nSELECT \n    ClassName, Grade \n    , GradeFreq = COUNT(*) \n    , Ranking = DENSE_RANK() OVER (PARTITION BY ClassName ORDER BY COUNT(*) DESC) \nFROM Scores \nGROUP BY ClassName, Grade \n) \nSELECT * FROM Ranked WHERE Ranking = 1\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13278147,"title":"Iterate through sql script using different values","body":"<p>Here is part of my script:</p>\n\n<pre><code>DECLARE @dataId int = 123               \n\n-- Here I run more SQL scripts using @dataId\n\nSelect from table A where id = @dataId \n\n-- So on it goes in other tables and delete and update other tables\n</code></pre>\n\n<p>My question is there a way I can enter 100 values in <code>@dataId</code> and it will iterate through the script in an order? Is there a simpler way to do this in SQL Server 2008 rather then manually entering <code>@dataId</code> each time?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":33,"score":1,"question_id":13277588,"title":"SQL INNER JOINS in SP converting date and/or time from character string getting error message","body":"<p>I have searched about 20 results apertaining to the error message \"Conversion failed when converting date and/or time from character string.\" and none seem to address my issue.</p>\n\n<p>A little history, last Friday the queries were working just fine and the data returned was proper. On the following Monday, the queries no longer worked and gave this error message, \"Conversion failed when converting date and/or time from character string.\"  So, after a few hours of battling it was able to run a function with the offending code in it and the query ran perfect again. Until this morning. I came into the office and ran the query and received the error \"Conversion failed when converting date and/or time from character string.\"  So now I am pulling my hair out.</p>\n\n<p>I started by verifying each record being returned is, in fact, a valid date using the isDate function. All the dates are valid dates in string format. I am simply doing a check to see whether or not the record is older than 1 year. </p>\n\n<p>I do have several INNER JOINS and have been wondering if they are affecting the output.</p>\n\n<pre><code>SELECT \ngc2p.partnumber, gc2p.orderby, gc2p.campaigncode, gp2a.assetfilename\nFROM [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2productrefs] gc2p\n,[StepMirror].[dbo].[stepview_nwppck_ngn_getpimweblegalattrlist1] gpwa\n,[StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2assetrefs] gc2a \n,[StepMirror].[dbo].[stepview_nwppck_ngn_getproduct2assetrefs] gp2a \nWHERE gc2p.partnumber=gpwa.PARTNUMBER and\ngc2p.id=gc2a.id and\ngp2a.PRODUCTNAME=gpwa.PARTNUMBER and\nATTRIBUTENAME='New Date' AND \nATTRIBUTEVALUE &gt; dateadd(month,-12,getdate()) AND \ngc2p.id = '5665976' and \ngc2a.assettype='Primary Image' AND \ngp2a.ASSETTYPE = 'Primary Image'\norder by gc2p.orderby\n</code></pre>\n\n<p>If anyone could give me a helping hand that would be wonderful.</p>\n\n<p>Edit: The query runs fine when I remove 'ATTRIBUTEVALUE > dateadd(month,-12,getdate())'. I forgot to mention the exact part of the query throwing the error.</p>\n\n<p>Edit: Updated Query - <strong>Now Working Query</strong> for those seeking a similar answer.</p>\n\n<pre><code>SELECT TOP 18 gc2p.partnumber, gpwa.ATTRIBUTECNAME,gp2a.ASSETFILENAME, gpwa.ATTRIBUTEVALUE\nFROM [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2productrefs] gc2p\nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getpimweblegalattrlist1] gpwa ON gc2p.partnumber=gpwa.PARTNUMBER and gpwa.ORDERBY='96'\nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getclassification2assetrefs] gc2a ON gc2p.id=gc2a.id\nINNER JOIN [StepMirror].[dbo].[stepview_nwppck_ngn_getproduct2assetrefs] gp2a ON gc2p.partnumber=gp2a.PRODUCTNAME\nWHERE gc2p.id = 5665976 AND gp2a.assettype='Primary Image' AND gc2a.assettype='Primary Image' \nAND(CASE WHEN ISDATE(ATTRIBUTEVALUE)  = 0 then NULL ELSE ATTRIBUTEVALUE END) &gt; dateadd(month,-12,getdate())\norder by gc2p.orderby\n</code></pre>\n"},{"tags":["mysql","sql","mysql-error-1005"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":179,"score":1,"question_id":9986287,"title":"Cannot create table with underscore in table name MySQL v5.5.14","body":"<p>I'm using Mysql v5.5.14 and when I try to execute:</p>\n\n<pre><code>mysql&gt; CREATE TABLE IF NOT EXISTS LONGBOW_products.universal_partname (\n    -&gt;    part_id SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,\n    -&gt;    PRIMARY KEY (part_id)\n    -&gt; );\n</code></pre>\n\n<p>It is returning me an error:</p>\n\n<pre><code>ERROR 1005 (HY000): Can't create table 'LONGBOW_products.universal_partname' (errno: -1)\n</code></pre>\n\n<p>However, when I tried removing the underscore from the table name, it returns true:</p>\n\n<pre><code>mysql&gt; CREATE TABLE IF NOT EXISTS LONGBOW_products.universal (\n    -&gt;    part_id SMALLINT(5) UNSIGNED NOT NULL DEFAULT 0,\n    -&gt;    PRIMARY KEY (`part_id`)\n    -&gt; );\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>\n\n<p>I wonder if you cannot use underscores anymore in table name on newer versions of Mysql?</p>\n"},{"tags":["sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":175,"score":1,"question_id":10640743,"title":"SQL query, join multiple tables, Oracle","body":"<p>I have an assignment where I need to write a SQL Query that would retrieve the player number and the total amount paid in penalties for players who are captains and have paid more than £80 in total for penalties.</p>\n\n<p>I've got three tables</p>\n\n<p>Players (<strong>playerNo</strong>, name, initials, street, town, postcode)</p>\n\n<p>Teams (<strong>teamNo</strong>, playerNo, division)</p>\n\n<p>Penalties (<strong>paymentNo</strong>, playerNo, penDate, amount)</p>\n\n<p>bold text indicates the primary key. The playerNo in Teams table indicates the team captain.</p>\n\n<p>I don't know how to join three tables. But my attempt at this is:</p>\n\n<pre><code>SELECT p1.playerNo, SUM(p2.amount)\nFROM Players p1 INNER JOIN Teams t\n   ON p1.playerNo = t.playerNo \nJOIN penalties p2\n   ON p2.playerNo = p1.playerNo\nGROUP BY playerNo\nHAVING SUM(p2.amount) &gt; 80;\n</code></pre>\n\n<p>Is any of this correct?</p>\n"},{"tags":[".net","sql"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13278234,"title":"How to do a SQL with an IF condition on one column","body":"<p>I got a quick question about if this is possible within a SQL statement for an ASPX page. </p>\n\n<p>Let's say there are three columns, <code>USER</code>, <code>Password</code>, and <code>permission</code>. </p>\n\n<p>If within my <code>SELECT</code> statement I want to only select <code>USER</code> and <code>PASSWORD</code> only when <code>Permission</code> is <code>&gt; 2</code>, and if it is less than 2 I only want to show <code>USER</code>. </p>\n\n<p>Is this possible? Or will I have to do this within my presentation layer?</p>\n"},{"tags":["mysql","sql"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13276922,"title":"moving an entry form the end of table to the top","body":"<p>I am using mySql  and I have a record with is in end of the table.  I want to bring it to the top of the table. How can move it? I mean there are entries at top of the table, how can i replace ids of both the entries with each other.</p>\n\n<p>I want to do this because i want to move the last item to the start of the list, so that it appears first on my website.</p>\n\n<p>thanks</p>\n"},{"tags":["sql","sql-server","percentile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13278051,"title":"SQL Percercentile Calculation","body":"<p>I have the following query, which even without a ton of data (~3k rows) is still a bit slow to execute, and the logic is a bit over my head - was hoping to get some help optimizing the query or even an alternate methodology:</p>\n\n<pre><code>Select companypartnumber, (PartTotal + IsNull(Cum_Lower_Ranks, 0) ) / Sum(PartTotal) over() * 100 as Cum_PC_Of_Total\nFROM PartSalesRankings PSRMain\nLeft join \n    (\n        Select PSRTop.Item_Rank, Sum(PSRBelow.PartTotal) as Cum_Lower_Ranks\n          from partSalesRankings PSRTop\n          Left join PartSalesRankings PSRBelow on PSRBelow.Item_Rank &lt; PSRTop.Item_Rank\n         Group by PSRTop.Item_Rank \n    ) as PSRLowerCums on PSRLowerCums.Item_Rank = PSRMain.Item_Rank\n</code></pre>\n\n<p>The PartSalesRankings table simply consists of CompanyPartNumber(bigint) which is a part number designation, PartTotal(decimal 38,5) which is the total sales, and Item_Rank(bigint) which is the rank of the item based on total sales.</p>\n\n<p>I'm trying to end up with my parts into categories based on their percentile - so an \"A\" item would be top 5%, a \"B\" item would be the next 15%, and \"C\" items would be the lower 80th percentile.  The view I created works fine, it just takes almost three seconds to execute, which for my purposes is quite slow.  I narrowed the bottle neck to the above query - any help would be greatly appreciated.</p>\n"},{"tags":["sql","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13277875,"title":"How to return the most repeated value using a foreign key from a referring table","body":"<p>I need to create a SQL query to retrieve all the values from one unique row entry in a table called <code>JOBS</code>.</p>\n\n<p>But to do so I need to use a table called <code>EMPLOYEES</code> which has a foreign key to the <code>JOBS</code> table.\nThe condition is to return the job_title from the table JOBS that has its job_id more times repeated in the <code>EMPLOYEES</code> table.</p>\n\n<p>I need to do it with one SQL statement.</p>\n\n<p>Desired output:</p>\n\n<pre><code>Stock Clerk\n</code></pre>\n\n<p>This is the query I have</p>\n\n<pre><code>SELECT job_id  \nFROM (SELECT job_id FROM employees GROUP BY job_id ORDER BY COUNT(*) desc)  \nWHERE ROWNUM &lt;= 1;\n</code></pre>\n\n<p>but is not good enough because it is <code>job_title</code> from <code>EMPLOYEES</code> what I need.</p>\n\n<p>Do you have any idea how can I do it? I am using an Oracle 11g database</p>\n\n<p>This is how my tables look like:</p>\n\n<p><strong>EMPLOYEES</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/3vCp3.jpg\" alt=\"EMPLOYEES\"></p>\n\n<p><strong>JOBS</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/jHTQ6.jpg\" alt=\"JOBS\"></p>\n"},{"tags":["sql","replication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13278138,"title":"SQL Server MergeReplication with single GUID colum","body":"<p>i have an table which contains an single column, which is the Primary key, uniqueidentified, rowguid = true. if creating an merge replication, the Agent Fails to start with:</p>\n\n<p>\"The article includes only the rowguidcol column. You must publish at least one other column.\"</p>\n\n<p>is there any way to publish this table, without removing the rowguid and adding an second column?</p>\n\n<p>thx</p>\n"},{"tags":["sql","xcode","uitableview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13278134,"title":"Repopulate UITableView with New Data","body":"<p>I am implementing a search functionality using UIAlertView that will search a SQL Table for a match and repopulate the UITableView. So far I have this code below. \"results\" is array of match returned data from the search query. Then, I checked if the \"elements\" are empty which means it does not match any item in SQL Table. If it does then I would like to erase the data currently on UITableView and replace with the \"results\" data.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>            NSUInteger *elements = [results count];\n            if(elements == 0)\n            {\n                UIAlertView *av = [[UIAlertView alloc]initWithTitle:@\"Item Not Found\" message:@\"Sorry the item was not found\" delegate:self cancelButtonTitle:@\"Cancel\"\n                                                  otherButtonTitles:nil, nil];\n                [av show];\n            }\n            if(elements &gt;= 1)\n            {\n                    //Repopulate UITableView with Data\n                    self.itemTitles = itemstitle;\n                    self.itemPrices = itemsprice;\n                    self.itemCategory = itemscategory;\n            }\n</code></pre>\n\n<p>Note: I tried to use <code>[tableView reloadData]</code> but not sure how to implement it in this case.</p>\n\n<p>Thanks in advance for the help.</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13274255,"title":"Complex SQL query on one table","body":"<p>Have forgotten SQL queries as have not used it for a long time.</p>\n\n<p>I have a following requirement.\nHave a table called match where I keep my competitor details with respect to matches my team have played against them. So some important fields are like this</p>\n\n<pre><code>match_id\ncompetior_id\nmatch_winner_id\nismatchtied\ngoals_scored_my_team\ngoals_scored_comp\n</code></pre>\n\n<p>From this table I want to get the head to head information for all my competitors.\nlike this</p>\n\n<pre><code>Competitor Matches Wins Losses Draws \nA          10      5    4      1\nB          8       3    2      1\n</code></pre>\n\n<p>Draw information I can get from ismatchtied is set to 'Y' or 'N'.\nI want to get all the info from one query. I can get all the info from executing queries separately and do complex logic processing in my server code. But my performance will take a hit.</p>\n\n<p>Any help will be hugely appreciated.</p>\n\n<p>cheers,\nSaurav</p>\n"},{"tags":["php","sql","insert","condition"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13277663,"title":"Insert into“Table1” if a condition is met in “Table” 2 SQL","body":"<p><strong>I posted a similar question to this which was about deleting, This one is about inserting.</strong></p>\n\n<p>Hello,</p>\n\n<p>I'm making a little messaging application in PHP using a SQL database but have faced a small problem. I will try explain this as best as possible so here goes...</p>\n\n<p>I have a table called \"users\" as following:</p>\n\n<pre><code>ID | Username | Password | Email \n-------------------------------------------\n1  | Account1 | Pass 1   | email1@mail.com\n2  | Account2 | Pass 2   | email2@mail.com\n</code></pre>\n\n<p>I then have another called \"friends\" as following:</p>\n\n<pre><code>UserID | FriendID\n------------------\n   1   |     2    \n</code></pre>\n\n<p>So what I need is a query that will insert data into the \"friends\" table if a condition is met in the \"users\" table</p>\n\n<p>Example:</p>\n\n<pre><code>INSERT INTO 'friends' VALUES('$UserID', '$FriendID') IF (users.Password = $Password WHERE users.ID = $UserID)\n</code></pre>\n\n<p>I hope that was a good enough explanation but I'm finding this difficult to explain.</p>\n\n<p>Thank for your help :)</p>\n"},{"tags":["php","sql","propel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13265518,"title":"Chaining filterByXXX bug?","body":"<p>I have the following code:</p>\n\n<pre><code>$somethingArray = array( 3, 4, 5 );\n\n$myObjects = MyObjQuery::create()\n  -&gt;filterBySomething( $somethingArray )\n  -&gt;filterById( array( 'min' =&gt; $minMyObjID ) )\n  -&gt;orderByObjTimestamp('DESC')\n  -&gt;find();\n</code></pre>\n\n<p>Which according to the Propel documentation, should result in a SQL command that ends up checking if the 'something' is IN the somethingArray array, and that the id is > $minMyObjID. But instead, the id is IN instead of >. </p>\n\n<p>If I do the following instead:</p>\n\n<pre><code>$myObjects = MyObjQuery::create()\n  -&gt;filterBySomething( $somethingArray )\n  -&gt;where( 'id &gt; ' . $minMyObjID )\n  -&gt;orderByObjTimestamp('DESC')\n  -&gt;find();\n</code></pre>\n\n<p>The resulting SQL is what I would expect. Is this a Propel bug, or am I misunderstanding the documentation when it comes to filterByXXX parameters?</p>\n"},{"tags":["php","mysql","sql","delete","condition"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13277225,"title":"Deleting from \"Table1\" if a condition is met in \"Table\" 2 SQL","body":"<p>I'm making a little messaging application in PHP using a SQL database but have faced a small problem. I will try explain this as best as possible so here goes...</p>\n\n<p>I have a table called \"users\" as following:</p>\n\n<pre><code>ID | Username | Password | Email \n-------------------------------------------\n1  | Account1 | Pass 1   | email1@mail.com\n2  | Account2 | Pass 2   | email2@mail.com\n</code></pre>\n\n<p>I then have another called \"friends\" as following:</p>\n\n<pre><code>UserID | FriendID\n------------------\n   1   |     2    \n</code></pre>\n\n<p>So what I need is a query that will delete A row from the \"Friends\" table if a condition is met in the second table.</p>\n\n<p>Example:</p>\n\n<pre><code>DELETE FROM 'friends' WHERE UserID = 1 AND (users.Password = $Password WHERE users.ID = 1)\n</code></pre>\n\n<p>I hope that was a good enough explanation but I'm finding this difficult to explain.</p>\n\n<p>Thank for your help :)</p>\n"},{"tags":["sql","sql-server","query","sql-server-2008-r2"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13276318,"title":"Returning not found values in query","body":"<p>I'm working on a project, and I have a list of several thousand records that I need check.  I need to provide the list of the ones NOT found, and provide the query I use to locate them so my superiors can check their work.</p>\n\n<p>I'll admit I'm relatively new to SQL. I don't have access to create temporary tables, which is one way I had thought of to do this.</p>\n\n<p>A basic idea of what I'm doing:</p>\n\n<pre><code>select t.column1, t.column2\nfrom table1 t\nwhere t.column1 in ('value1','value2','value3')\n</code></pre>\n\n<p>If value1 and value3 are in the database, but value2 is not, I need to display value2 and not the others.</p>\n\n<p>I have tried <code>ISNULL</code>, embedding the query, and trying to select <code>NOT</code> values from the query.  </p>\n\n<p>I have searched for returning records not found in a query on Google and on this site, and still found nothing.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13277674,"title":"convert string to date in sql server","body":"<p>How do I convert <code>YYYY-MM-DD</code> (<code>2012-08-17</code>) to a date in SQL Server?</p>\n\n<p>I don't see this format listed on the help page: <a href=\"http://msdn.microsoft.com/en-us/library/ms187928.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms187928.aspx</a></p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13277549,"title":"SQL server exclude anything but a number","body":"<p>is their a way to exclude results pulled in a query that start with anything but a number. Exclude anytXing starting in a letter.</p>\n\n<p>I tried</p>\n\n<pre><code> Where a.value like '0%'\n       And a.value  like '1%'\n       And a.value like '2%' \n         .......3-9\n</code></pre>\n"},{"tags":["sql","query","ms-access","ms-jet-ace"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13277677,"title":"SQL for the following equation. Todays EMA = (Price * (2/11)) + ((1 - (2/11)) * Yesterdays EMA)","body":"<p>May I ask for your help with the following, please?</p>\n\n<p>I want to create an MS Jet/Ace/Access Query that returns a 10 day Exponential Moving Average (EMA) from a table of price data. The table format and a small set of its data is as follows …</p>\n\n<pre><code>TableName = Spot\nID (AutoNumber) aDate (DateTime)        Settle (Double)\n1               01/10/2007              16.056\n2               02/10/2007              15.625\n3               03/10/2007              15.655\n4               04/10/2007              15.686\n5               05/10/2007              15.810\n6               08/10/2007              15.665\n7               09/10/2007              15.908\n8               10/10/2007              16.004\n9               11/10/2007              16.319\n10              12/10/2007              16.233\n</code></pre>\n\n<p>In case you are not aware of Exponential Moving Averages, the following websites may help explain them …</p>\n\n<p><a href=\"http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a\" rel=\"nofollow\">http://stockcharts.com/help/doku.php?id=chart_school:technical_indicators:moving_averages#exponential_moving_a</a></p>\n\n<p><a href=\"http://www.pandacash.com/technical-analysis/moving-average/exponential.htm\" rel=\"nofollow\">http://www.pandacash.com/technical-analysis/moving-average/exponential.htm</a></p>\n\n<p>However, hopefuly I can explain the equation to you. </p>\n\n<pre><code>Todays EMA = (Settle * Exponent) + ((1 - Exponent) * Yesterdays EMA)\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>Settle = Closing price of the Stock / Asset\nExponent = (2 / (10 Days + 1)) ie 0.1818\n</code></pre>\n\n<p>I have a query that returns some of the values I need, but I am unable to find a solution to the whole thing.</p>\n\n<p>My Query, so far (hopefully the formatting makes it clearer to read)</p>\n\n<pre><code>SELECT aDate, Settle, \n\n   (SELECT((SELECT Settle \n            FROM   SPOT AS SubQ \n            WHERE  SubQ.ID = SS.ID)) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS YesterdaySettle,\n\n   ( 2 / 11 ) AS Exponent,\n\n   (SELECT Settle \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID) * ( Exponent ) AS [Part A],\n\n   ( 1 - Exponent ) AS [Part B],\n\n   (SELECT ((SELECT Settle \n              FROM   SPOT AS SubQ \n              WHERE  SubQ.ID = SS.ID) * ( 2 / 11 )) \n    FROM   SPOT AS SS \n    WHERE  SS.ID = Spot.ID - 1) AS [Yesterdays Part A],\n\n   (SELECT SUM(Settle) \n    FROM   SPOT AS SubQ \n    WHERE  ID BETWEEN Spot.ID AND Spot.ID -9) / Iif(Spot.id &gt; 10, 10, Spot.id) AS [10DMA] \n\nFROM   SPOT\nORDER  BY aDate; \n</code></pre>\n\n<p>Based on the field names of my Query, my equation would be …</p>\n\n<pre><code>Todays EMA = ([Part A])  + ([Part B] * [Part C])\n</code></pre>\n\n<p>And I would expect results similar to the following.</p>\n\n<pre><code>[10DMA] [Exponent]  [Part A]    [Part B]    [Part C] (Previous EMA)     [EMA]\n15.896  0.181818182 2.919272727 0.818181818     USE 10DMA ie 15.896     15.925\n15.911  0.181818182 2.840909091 0.818181818                 15.925      15.871\n15.945  0.181818182 2.846363636 0.818181818                 15.871      15.831\n15.985  0.181818182 2.852       0.818181818                 15.831      15.805\n16.027  0.181818182 2.874545455 0.818181818                 15.805      15.806\n16.037  0.181818182 2.848181818 0.818181818                 15.806      15.780\n16.052  0.181818182 2.892363636 0.818181818                 15.780      15.803\n16.054  0.181818182 2.909818182 0.818181818                 15.803      15.840\n16.039  0.181818182 2.967090909 0.818181818                 15.840      15.927\n16.025  0.181818182 2.951454545 0.818181818                 15.927      15.983                  \n</code></pre>\n\n<p>The problem is I can’t figure out how to create the [Part C] field.</p>\n\n<p>Some points are …</p>\n\n<ul>\n<li>If there is no EMA for a day, then the [Part C] value should be\n[10DMA]. For example, the first record will not have a EMA so I need\nto use [10DMA]. </li>\n<li>If there is an EMA from yesterday, then use that value for todays [Part C].</li>\n</ul>\n\n<p>May I ask for some advice please. I kind of stumbled across what I have so far, But I am stumped for the Part C value.</p>\n\n<p>I thought I could do something along the lines of …</p>\n\n<pre><code>iif (EMA &lt;&gt; 0, EMA, [10DMA]) AS [Part C],\n    (([Part A]) + ([Part B] * [Part C])) AS EMA\n</code></pre>\n\n<p>However, I get an error relating to </p>\n\n<pre><code>Circular reference caused by alias 'Part C'.\n</code></pre>\n\n<p>Any advice would be gratefully received. Many thanks for your time.</p>\n\n<p>John.</p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13275431,"title":"Finding the total amount for my query","body":"<p>I have a query that allows me to retrieve customer orders.</p>\n\n<pre><code>Select ID, OrderID, Item, Price from customerOrders\nWhere Order = 1\n</code></pre>\n\n<p>is there a way of totalling up the final amount to pay and have it visible below, but still be able to view all details needed in the sql query, for example</p>\n\n<pre><code>ID    |  OrderID |  Item  | Price\n1     |   1      |  Book  | 9.99\n2     |   1      |  DVD   | 12.99\n\n                    total = 22.98\n</code></pre>\n\n<p>Many thanks in advance</p>\n"},{"tags":["mysql","sql","sql-update"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13276480,"title":"Updating where another table equals some value","body":"<p>How do I do the following in MySQL:</p>\n\n<pre><code>UPDATE PartTbl SET aFlag = 0 \nWHERE PartId = (SELECT PartId FROM CategoryTbl WHERE cat = 100)\n</code></pre>\n"},{"tags":["sql","table","alias"],"answer_count":17,"favorite_count":4,"up_vote_count":23,"down_vote_count":0,"view_count":8686,"score":23,"question_id":11043,"title":"SQL Table Aliases - Good or Bad?","body":"<p>What are the pros and cons of using table aliases in SQL?  I personally try to avoid them, as I think they make the code less readable (especially when reading through large where/and statements), but I'd be interested in hearing any counter-points to this.  When is it generally a good idea to use table aliases, and do you have any preferred formats?</p>\n"},{"tags":["c#",".net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":13266324,"title":"accessing database","body":"<p>Here is my problem; I have a hosted and published database on godaddy servers. I have also published my website. However, when I tried to use one of visual studio's tools such as chart, or data view or any tool that wants me to specify a data source, I get the </p>\n\n<pre><code>\"error 40: could not open a connection to sql server\".\n</code></pre>\n\n<p>In most cases, I have worked around this issue by writing the code instead of using these tools on the \".cs\" sections, but now I need to update my database model and I really would prefer not to write that amount of code. The connection string I choose works perfectly, it can update and gather values from database on the published website. But when I Right click on the models section and select \"update model from database\" the update wizard cannot access the database with the very same connection string. Like I said, this problem occurs on every tool that wants me to select a data source.</p>\n\n<p>Is this a permission issue regarding visual studio or something else? \nThanks in advance.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13276778,"title":"Changing the name of a SQL database missing tables","body":"<p>when changing the name of a SQL server 2005 database moving mdf and ldf files.</p>\n\n<p>First i run a script in my program's install:</p>\n\n<pre><code>Alter Database [[DBNAME]] MODIFY NAME = [[RENAMEDBNAME]] \n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =  [[DBNAME]], NEWNAME = [[RENAMEDBNAME]] )\n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =  [[DBNAME]_log], NEWNAME = [[RENAMEDBNAME]_log] )\n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =[[RENAMEDBNAME]]  , FILENAME  ='[DBPATH][RENAMEDBNAME].mdf'  )\n\nAlter Database [[RENAMEDBNAME]] MODIFY FILE ( NAME =[[RENAMEDBNAME]_log]  , FILENAME  ='[DBPATH][RENAMEDBNAME]_log.ldf'  )\n</code></pre>\n\n<p>ALTER DATABASE  [[RENAMEDBNAME]] SET OFFLINE GO</p>\n\n<p>then I move the files in code.</p>\n\n<p>then in the next script I use</p>\n\n<pre><code>ALTER DATABASE  [[RENAMEDBNAME]] SET ONLINE GO\n</code></pre>\n\n<p>The tables are missing from the database - Any ideas?\nShould I use backup and restore?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","ms-access-2007","database-performance"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13275113,"title":"Can Long Integer store letters?","body":"<p>I ran 'Analyze Performance' feature in Access and it had an \"idea\" to improve performance; Access said I should convert items that are alphanumeric mixes that look like this <code>12BB1-DF740</code>§ from <code>text</code> data type into <code>long integer</code> (the specific name from the idea). Whether Access is right that this would improve performance is secondary to whether long integer can store letters at all.</p>\n\n<p><em>[§ About the data - the hyphen in the data provided to me is always present at that location; the letters are always A-F]</em></p>\n\n<p>From what I can tell, <a href=\"http://www.w3schools.com/sql/sql_datatypes.asp\" rel=\"nofollow\">w3schools</a> is indicating that <code>Long</code> will only store numbers</p>\n\n<blockquote>\n  <p><code>Long</code> - Allows whole numbers between -2,147,483,648 and 2,147,483,647    </p>\n</blockquote>\n\n<ul>\n<li>Am I conflating data types? (Further, when I pull up the design view, it only offers <code>number</code> as a data type; there is no <code>long</code> or <code>long integer</code>)</li>\n<li>Can <code>Long Integer</code> store letters?</li>\n<li>If my column is already populated, and I convert the data type, will I lose data?</li>\n</ul>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13273264,"title":"Finding related article based on multiple criteria","body":"<p>This question is similar to <a href=\"http://stackoverflow.com/questions/4717093/mysql-find-related-articles\">this one</a> but with a difference: I have eight different types of tags.</p>\n\n<p>Something like this:</p>\n\n<pre><code>videos      [id, title]\ntags1       [id, tag]\ntags2       [id, tag]\ntags3       [id, tag]\ntags4       [id, tag]\ntags5       [id, tag]\ntags6       [id, tag]\ntags7       [id, tag]\ntags8       [id, tag]\nvideo_tags1 [vid_id, tag_id]\nvideo_tags2 [vid_id, tag_id]\nvideo_tags3 [vid_id, tag_id]\nvideo_tags4 [vid_id, tag_id]\nvideo_tags5 [vid_id, tag_id]\nvideo_tags6 [vid_id, tag_id]\nvideo_tags7 [vid_id, tag_id]\nvideo_tags8 [vid_id, tag_id]\n</code></pre>\n\n<p>Given a single video.id I want to pick out related videos based on which have the most tags in common. I'm finding it hard to find a way to do this, let alone a way that won't bring the server to it's knees.</p>\n"},{"tags":["asp.net","sql","visual-studio-2010","ddl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13276517,"title":"VS 2010 --- DDL How to get ID but show a different column for options","body":"<p>I have a quick question (hopefully quick). I'm still learning, so please bear with me.</p>\n\n<p>I'm trying to get a DDL working, where my drop down shows the user one column of options, but in reality, the option they pick will use the DeviceID for that particular option in the other column. Here is what I have for my Data Source:</p>\n\n<pre><code>    &lt;asp:SqlDataSource ID=\"RetrieveComputerSQL\" runat=\"server\" \n        ConnectionString=\"&lt;%$ ConnectionStrings:SynInventory %&gt;\" \n        SelectCommand=\"SELECT DeviceID + ' ' + Computer as Combo,Computer as Computer,DeviceID AS DeviceID from Hardware\"&gt;\n</code></pre>\n\n<p>Now the Hardware Table has 2 colunns.</p>\n\n<p>DeviceID = IDs of the items in the table\nComputer = The type of machines attached to that DeviceID</p>\n\n<p>So for example, the Hardware table looks like this:</p>\n\n<pre><code>&gt;Computer (Column)        DeviceID (Column)\n&gt;------------------       ----------------------   \n&gt; Thin Client                      0\n&gt; Desktop                          1\n&gt; Laptop                           2\n</code></pre>\n\n<p>Now, here is my DDL:</p>\n\n<pre><code>                    &lt;asp:DropDownList ID=\"ddlComputer\" runat=\"server\" AutoPostBack=\"true\"\n                    DataSourceID=\"RetrieveComputerSQL\" DataTextField=\"Combo\" DataValueField=\"Computer\"                      \n                    SelectedValue='&lt;%# Bind(\"Computer\") %&gt;' AppendDataBoundItems=\"true\"&gt;\n</code></pre>\n\n<p>What I want to do is still show the \"friendly\" name of the object, but in reality, grab the DeviceID of the selected object in the drop down box, then report that value back to my main DataSource (which is: UPDATE MainAsset SET [site] = @Site,[os] = @os,[device] = @Computer WHERE [pk] = @pk\") where [device] IS my Hardware table.</p>\n\n<p>I've tried this every which way I can think of, and manipulted my RetrieveComputerSQL DS in many ways. I decided to end on the \"Combo\" option, but nothing I've tried seems work.</p>\n\n<p>Any constructive ideas or comments sure would be appreciated. Hope this all makes sense.</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","query"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13276240,"title":"SQL query - whats the best way to do this","body":"<p>I have this query...</p>\n\n<pre><code>select * from selection_value where id = 14702\n14702\n14704\n14724\n14710\n14738\n14717\n14719\n14719\n14738\n14722\n14721\n14724\n14725\n14706\n14730\n14708\n14731\n14715\n14708\n14749\n14752\n14754\n14755\n14757\n14795\n14753\n14760\n14761\n14759\n14762\n14763\n14785\n14764\n14765\n14785\n14766\n14768\n14796\n14771\n14772\n14774\n14776\n14764\n14780\n14781\n14767\n14784\n14785\n14786\n14788\n14789\n14790\n14791\n14785\n14772\n14792\n14796\n14785\n14797\n14798\n14799\n14800\n14802\n14778\n14803\n14758\n14765\n14762\n14781\n14785\n14786\n14808\n14793\n14805\n14807\n14808\n</code></pre>\n\n<p>Now I know this will not work, I was just wondering whats the best way to get the data for all of these ids in this order?</p>\n\n<p>Is this possible?</p>\n"},{"tags":["sql","query","dynamics-crm","dynamics-crm-2011","dynamic-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13273956,"title":"SQL Query in CRM Report","body":"<p>A \"Case\" in CRM has a field called \"Status\" with four options.  </p>\n\n<p>I'm trying to\n build a report in CRM that fills a table with every week of the year (each row is a different week), and then counts the number of cases that have each Status option (the columns would be each of the Status options).</p>\n\n<p>The table would look like this </p>\n\n<pre><code>         Status 1    Status 2    Status 3\nWeek 1       3         55          4\nWeek 2       5         23          5\nWeek 3       14        11          33\n</code></pre>\n\n<p>So far I have the following: </p>\n\n<pre><code>SELECT \n    SUM(case WHEN status = 1 then 1 else 0 end) Status1,\n    SUM(case WHEN status = 2 then 1 else 0 end) Status2,\n    SUM(case WHEN status = 3 then 1 else 0 end) Status3,\n    SUM(case WHEN status = 4 then 1 else 0 end) Status4,\n    SUM(case WHEN status = 5 then 1 else 0 end) Status5\nFROM [DB].[dbo].[Contact]\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   2         43          53\n</code></pre>\n\n<p>Now I need to somehow split this into 52 rows for the past year and filter these results by date (columns in the Contact table).  I'm a bit new to SQL queries and CRM - any help here would be much appreciated.  </p>\n\n<p>Here is a SQLFiddle with my progress and sample data: <a href=\"http://sqlfiddle.com/#!2/85b19/1\" rel=\"nofollow\">http://sqlfiddle.com/#!2/85b19/1</a></p>\n"},{"tags":["mysql","sql","exception-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13276337,"title":"Error While importing Schema in sql","body":"<p>Hey guys im trying to import schema from mysql vesion 5.0 to 5.1. Every time i'm trying to import schema I got this error:</p>\n\n<p>Error near Drop Proceduer service_tt_yes'\nMySql.Data.MySqlClient.MySqlException: Column count of mysql.proc is wrong. Expected 20, found 16. The table is probably corrupted.</p>\n\n<p>I try to skip that procedure but error occur in next procedure.</p>\n\n<p>Any solution!</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13275696,"title":"need assistance on constructing sql query","body":"<p>i have three tables like follows:</p>\n\n<p>this one table : <code>m_application_resources</code></p>\n\n<pre><code> resourceid resource_name   menu_group_id   menu_name   creation_date   last_created_by updation_date   last_updated_by\n</code></pre>\n\n<p>and the second table : <code>m_roles</code></p>\n\n<pre><code>roleid  rolename    description creation_date   last_created_by updation_date   last_updated_by\n</code></pre>\n\n<p>and the third table is : <code>m_access_matrix</code></p>\n\n<pre><code>accessid    resourceid  roleid  creation_date   last_created_by updation_date   last_updated_by\n</code></pre>\n\n<p>Relationship for the table is : resourceid and roleid</p>\n\n<p>and this my query </p>\n\n<pre><code>select  am.accessid, ar.resource_name,rls.rolename\nfrom m_application_resources ar, m_roles rls,m_access_matrix am \nwhere ar.resourceid=am.resourceid \n</code></pre>\n\n<p>this returns the following :</p>\n\n<pre><code>ccessid resource_name   rolename\n1   DepartmentAction    Admin\n1   DepartmentAction    Client\n1   DepartmentAction    Doctors\n2   PositionsAction     Admin\n2   PositionsAction     Client\n2   PositionsAction     Doctor\n</code></pre>\n\n<p>the result is wrong and i don't know how to go about.</p>\n\n<p>Ex : DepartmentAction should come only once and the role name should be any one.</p>\n\n<p>Sqlfiddle<a href=\"http://www.sqlfiddle.com/#!2/2fca3/3\" rel=\"nofollow\">Fiddle</a></p>\n\n<p>Please help</p>\n"},{"tags":[".net","sql","vb.net","cryptography","sha1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":163,"score":1,"question_id":11233394,"title":".Net SHA1CryptoServiceProvider not matching SQL Hashbytes","body":"<p>After converting some plaintext passwords stored in SQL using Hashbytes can't seem to get .Net to generate a proper matching hash.</p>\n\n<p>SQL used to convert the passwords:</p>\n\n<pre><code>UPDATE Users\nSET UserPassword = HASHBYTES('SHA1', UserPassword + CAST(Salt AS VARCHAR(36)))\n</code></pre>\n\n<p>Now the .Net code used to generate the hash:</p>\n\n<pre><code>Dim oSHA1 As New System.Security.Cryptography.SHA1CryptoServiceProvider\nDim bValue() As Byte\nDim bHash() As Byte\n\nbValue = System.Text.Encoding.UTF8.GetBytes(sPlainTextPass)\nbHash = oSHA1.ComputeHash(bValue)\noSHA1.Clear()\n\nDim sEncryptPass As String = String.Empty\nFor i As Integer = 0 To bHash.Length - 1\n    sEncryptPass = sEncryptPass + bHash(i).ToString(\"x2\").ToLower()\nNext\n</code></pre>\n\n<p>A few added notes: The salt is stored in the database. sPlainTextPass contains the password+salt in plain text. I tried several different encodings including ASCII, UTF7, and UTF8. The database field is a varchar which is supposed to match to UTF8 from what I understand.</p>\n\n<p>Help?</p>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13273966,"title":"SQL: unique constraint and aggregate function","body":"<p>Presently I'm learning (MS) SQL, and was trying out various aggregate function samples. The question  I have is: Is there any scenario (sample query that uses aggregate function) where having a unique constraint column (on a table) helps when using an aggregate function.</p>\n\n<p>Please note: I'm not trying to find a solution to a problem, but trying to see if such a scenario exist in real world SQL programming.</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008-r2"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13274628,"title":"SQL Server - Count characters between two characters","body":"<p>How would one count the number of letters (alphabetically a to z or z to a) between two characters?</p>\n\n<p>For example:</p>\n\n<pre><code>WITH    ExampleData\n          AS ( SELECT   'a' AS StartChar, 'e' AS EndChar\n               UNION ALL\n               SELECT   'm', 'r'\n               UNION ALL\n               SELECT   'f', 'a'\n             )\n    SELECT  StartChar ,\n            EndChar\n    FROM    ExampleData\n</code></pre>\n\n<p>Would need to produce:</p>\n\n<pre><code>StartChar   EndChar    Diff\na           e          4\nm           r          5\nf           a          -5\n</code></pre>\n\n<p>I see how this could easily be done using udf's and a while loop but I was wondering if there was a faster way?</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13275969,"title":"Cannot insert duplicate key row in object with unique index 'SAXXIRPT while updating","body":"<p>I am writing a SQL statement to update a table in SQL from a temp table. I keep getting this error message: <code>Cannot insert duplicate key row in object with unique index 'SAXXIRPT'</code>.</p>\n\n<p>Here is my update statement: </p>\n\n<pre><code>Update dbo.sat_ser_rpt_itm\nSET itm_key_cd = n.itm_key_cd,\n  itm_typ_cd  = n.itm_typ_cd,\n  ser_id  = n.ser_id ,\n  as_of_dt = n.as_of_dt,\n  ocrn_nr  = n.ocrn_nr ,\n  id_rssd = n.id_rssd,\n  ocrn_day_txt = n.ocrn_day_txt ,\n  ocrn_dt = n.ocrn_dt ,\n  hol_flg = n.hol_flg ,\n  ocrn_val_nr = n.ocrn_val_nr \n  from #LookupTable n\n  on sat_ser_rpt_itm.id_rssd = n.id_rssd \nAND sat_ser_rpt_itm.as_of_dt = n.as_of_dt \nAND sat_ser_rpt_itm.ser_id = n.ser_id \nand sat_ser_rpt_itm.itm_typ_cd = n.itm_typ_cd \nand sat_ser_rpt_itm.ocrn_nr = n.ocrn_nr \nwhere t.id_rssd is not null and  t.as_of_dt is not null  and  t.ser_id is not null and  t.itm_typ_cd is not null and t.ocrn_nr is not null  \n</code></pre>\n\n<p>These are my indexes (clustered):</p>\n\n<pre><code>id_rssd, as_of_dt, ser_id, itm_key_cd and ocrn_nr\n</code></pre>\n\n<p>What's causing this error message?</p>\n"},{"tags":["sql","sql-server","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13268760,"title":"Alter stored procedure or function added extra blank line gap","body":"<p>In SQL Server 2012 when I write code for stored procedure and for any function. After that when I want to alter it added extra blank line gap, that's why it seem very unacceptable lenghty..</p>\n\n<pre><code>CREATE proc sp_delete_Rte_article_admin_Latest   \n(    \n@id int    \n)    \nas    \nbegin    \nif exists (select * from tblRte where Id=@id )    \nbegin    \n    declare @IvanID bigint  \n\n    set @IvanID=(select [IvanArtId] from tblRte where Id=@id )  \n    insert into tblRteOnDelete([IvanArtId],[StoryType],[ChannelType],[Filename],\n                [Headline],[PublishDate],[Title],[DocScope],[KeyWord],[Byline],[City],\n                [State],[StoryDate],[BodyContents],[DownloadedDate],DeleteDate)\n    select [IvanArtId],[StoryType],[ChannelType],[Filename],[Headline],[PublishDate],\n           [Title],[DocScope],[KeyWord],[Byline],[City],[State],[StoryDate],\n           [BodyContents],[DownloadedDate],GETDATE()\n      from tblIvanhoeXmlFeeds\n     where Id=@id   \n\n    delete from tblRte where Id=@id   \n    delete from tblUpdatedRteTopics where IvanArtId=@IvanID  \n    delete from tblCheckAllowRte where ArticleID=@IvanID  \n    delete from tblAddRteeApprove where ArticleID=@IvanID  \n\n    return 1    \nend    \nelse    \nbegin    \n    return 0    \nend    \nend\n</code></pre>\n\n<p>What should do for moving this for all time..any setting ?</p>\n"},{"tags":["sql","sql-server-2008","database-design","denormalization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":55,"score":-1,"question_id":13255736,"title":"Does table size have an effect on a denormalized database?","body":"<p>I am designing a duplicate of an existing database, and moving all the old data to it for reporting purposes. I have to denormalize the tables to improve the reporting performance, so I am trying to figure out which tables to join.</p>\n\n<p>I have examined the table relationships and have made a list of parent/child tables respectively, but I have also found that some of the tables have around 30 columns each. </p>\n\n<p>Will this have a negative effect on the performance if I join these tables in a denormalized database?</p>\n"},{"tags":["sql","windows","script","sqlplus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13264923,"title":"Prompt during sql script","body":"<p>My windows batch script calls a <code>sql</code> script in which a user is required to press <code>ENTER</code> during a prompt. This causes the program to pause during execution and wait for user input. Is it possible to preset the <code>ENTER</code> key in the <code>sql</code> script using a command?</p>\n"},{"tags":["sql","database","postgresql","datetime","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13272022,"title":"Declaring timestamp in postgres","body":"<p>I have to insert a timestamp value into a table. I am inserting values by writing an stored procedure.<br>\nThis is the code to my stored procedure.  </p>\n\n<pre><code>CREATE OR REPLACE FUNCTION dataInsert_Schedule() RETURNS boolean As\n$$\nDECLARE\n    i integer;\n    j integer;\n    dur integer;\n    tup Channel%rowtype;\nBEGIN\n    FOR tup IN SELECT * FROM Channel\n    LOOP\n        for i in 0..6 LOOP --days\n            for j in 0..23 LOOP  --hours\n                dur = round((random() * 2) + 1);\n                IF i + dur &gt; 24 then\n                    dur = 24 - i;\n                END IF;\n                INSERT INTO Schedule VALUES(tup.Channel_ID, round((random() * 999) + 1),( current_date + (integer to_char(i,'9')) )+ (interval to_char(j,'99') || ' hour'), (interval  dur ||' hour'));\n                i = i + dur - 1;\n            END LOOP;\n        END LOOP;\n    END LOOP;\n    return true;\nEND\n$$ LANGUAGE plpgsql;\n</code></pre>\n\n<p>When I write the query <code>Select * From dataInsert_Schedule();</code> I got the following error :  </p>\n\n<pre><code>ERROR:  syntax error at or near \"to_char\"\nLINE 1: ...d((random() * 999) + 1),( current_date + (integer to_char( $...\n                                                             ^\nQUERY:  INSERT INTO Schedule VALUES( $1 , round((random() * 999) + 1),( current_date + (integer to_char( $2 ,'9')) )+ (interval to_char( $3 ,'99') || ' hour'), (interval  $4  ||' hour'))\nCONTEXT:  SQL statement in PL/PgSQL function \"datainsert_schedule\" near line 15\n\n********** Error **********\n\nERROR: syntax error at or near \"to_char\"\nSQL state: 42601\nContext: SQL statement in PL/PgSQL function \"datainsert_schedule\" near line 15\n</code></pre>\n\n<p>I First tried this</p>\n\n<blockquote>\n  <p><code>INSERT INTO Schedule VALUES(tup.Channel_ID, round((random() * 999) + 1),( current_date + (integer ''||i) )+ (interval (j ||' hour')), (interval  dur ||' hour'));</code>  </p>\n</blockquote>\n\n<p>way of inserting, but I was getting the same kind of error.</p>\n\n<p><strong>Why I am getting this error?</strong></p>\n\n<p>And the <code>schedule</code> table is defined as following:  </p>\n\n<pre><code>CREATE TABLE Schedule(\nChannel_ID Integer  REFERENCES Channel(Channel_ID),\nProgram_ID Integer  REFERENCES Program(Program_ID),\nStart_Time Timestamp NOT NULL,\nDuration Interval NOT NULL,\nCONSTRAINT Schedule_Key PRIMARY KEY(Channel_ID, Program_ID)\n);\n</code></pre>\n"},{"tags":["mysql","sql","database","wordpress","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13275271,"title":"SQL Joining another table based on the ID of the initial table","body":"<p>I really just can't seem to grasb the sytanx of SQL Joins, etc ... so I'm needing some help with this (which I think is quite simple)</p>\n\n<p>I'm querying <code>bid_tag</code> as follows:</p>\n\n<pre><code>SELECT paid_date, term, pet_id FROM bid_tag WHERE active = 1\n</code></pre>\n\n<p>And I need to use the <code>pet_id</code> to then grab some information from another table <code>wp_postmeta</code>, where the table is actually in a <code>meta_key</code> <code>meta_value</code> structure (WordPress) ...</p>\n\n<p>So I need to grab the <code>meta_value</code> of <code>meta_key</code> \"bid_name\", for example... amongst other values.</p>\n\n<pre><code>TABLE\nid | meta_key | meta_value\n1    bid_name    Max\n</code></pre>\n\n<p>That <code>ID</code> is the same <code>ID</code> that I need to connect the initial table to...</p>\n\n<p>I really appreciate it!</p>\n"},{"tags":["javascript","asp.net","sql","vb.net","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12519462,"title":"Getting value from SQL query to textbox","body":"<pre><code>Protected Sub Button3_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button3.Click\n    Dim cons, query As String\n    Dim con As OdbcConnection\n    Dim adpt As OdbcDataAdapter\n    'Dim num As Integer\n    cons = \"dsn=Courier; UID=Courier; PWD=123;\"\n    con = New OdbcConnection(cons)\n\n    con.Open()\n\n    query = \"select Name from EMPLOYEE where EMPLOYEE_ID=\" + DropDownList1.SelectedValue\n    Dim ds As DataSet\n    adpt = New OdbcDataAdapter(query, con)\n    ds = New DataSet\n    adpt.Fill(ds, \"Courier\")\n\n    ' TextBox1.Text = ds\n\n    con.Close()\nEnd Sub\n</code></pre>\n\n<p>I want to display the name of the employee in Textbox whoos ID is specified in query, what can I do for that?</p>\n"},{"tags":["sql","sql-order-by","order","limit","parent-child"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13266614,"title":"Parent-child sql query with order by and limit","body":"<p>I have two tables DOCUMENT and ATTRIBUTES like these</p>\n\n<ul>\n<li><code>DOCUMENT(id)</code>,</li>\n<li><code>ATTRIBUTE(name, value, doc_fk)</code>.</li>\n</ul>\n\n<p>I need to run a query that works like this \"abstract query\"</p>\n\n<pre><code>select top 100 documents\nwhere $state='COMPLETED'\norder by $creationDate\n</code></pre>\n\n<p>Where <code>$state</code> and <code>$creationDate</code> are two attributes.</p>\n\n<p>Note that the limit is on documents, not attributes, and sort and filter are on two different attributes. The final query should return all document attributes, not only the filtered/sorted ones.</p>\n\n<p>I was able to write this with a very complex query and I'm looking for better alternatives. I could post my solution if useful, but I do not want to point you in the, possibly, wrong direction.</p>\n\n<p>It's ok to get a FEW extra documents, like 1000 instead of 100, and filter/sort in memory.\nCould be ok for the limit not to be exact, like 74 instead of the required limit 100, but not too far from it.</p>\n\n<p>Extra \"soft\" requirements:</p>\n\n<ul>\n<li>the query should work with several databases (oracle, mysql and sqlserver), so weird analytic functions should be avoided unless available on all platforms</li>\n<li>should work with JPA (eclipselink 2.4.0 implementation)</li>\n</ul>\n\n<p>The expected output is something like this</p>\n\n<pre><code>DOC_ID   ATTRIBUTE_NAME          VALUE\n  123       state              COMPLETED\n  123       creationDate       21/11/2012\n  123       userid             someone\n  456       state              COMPLETED\n  ...\n</code></pre>\n"},{"tags":["sql","ruby-on-rails-3","postgresql","activerecord","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":13133553,"title":"Rails 3 Applying limit and offset to subquery","body":"<p>I have a query that goes something like this (in song.rb):</p>\n\n<pre><code>def self.new_songs\n  Song.where(id: Song.grouped_order_published).select_important_stuff\nend\n</code></pre>\n\n<p>Later on in my app, it is then passed the limit and offset, lets say in the controller:</p>\n\n<pre><code>@songs = Song.new_songs.limit(10).offset(10)\n</code></pre>\n\n<p>The way my app is structured, I'd like to keep this method of setting things, but unfortunately it is really slow as it is limiting the outer query rather than the subquery.</p>\n\n<p>Is there a way I can expose the subquery such that it receives the limit and offset rather than the outer query?</p>\n\n<p><strong>Edit</strong>: I should add I am using postgres 9.2.</p>\n\n<p><strong>Edit 2</strong>:  The reason why I want to do it in this fashion is I am doing pagination and I need to get the \"count\" of the total number of rows.  So I do something like this:</p>\n\n<pre><code>@songs = Song.new_songs\n...\n@pages = @songs.count / 10\n...\nrender @songs.limit(params[:page]).offset(0)\n</code></pre>\n\n<p>If I were to change it somehow, I'd have to redo this entirely (which is in a ton of places).  By not limiting it until it's actually called, I can do the count in between and then get just the page at the end.  I guess I'm looking more for advice on how this can be done with the inner query, without becoming horribly slow as the database grows.</p>\n"},{"tags":["sql","charts","subselect","avg"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13275135,"title":"SQL AVG in subselect","body":"<p>I want to get rates from a product (productId) that is in a specific category (fk_rate_category) and the overall average rates from all products in the category.</p>\n\n<p>To be more specific: I need the data for a chart. One line in the chart represents the rate of a product(y-axis = rate ; x-axis = date_added) and the other line shows the average rates of all products.</p>\n\n<p>I had the following approach:</p>\n\n<pre><code>SELECT        id, productId, rate, fk_rate_category, date_added,\n                             (SELECT        AVG(rate) AS Expr1\n                               FROM            rates\n                               WHERE        (fk_rate_category = r.fk_rate_category)) AS avgRate\nFROM            rates AS r\nWHERE        (productId = @productId) AND (fk_rate_category = @fk_rate_category)\n</code></pre>\n\n<p>The problem is, that with my approach the avgRates value is the same in every record returned. </p>\n\n<p>Any  idea?</p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13274991,"title":"Generate 6 numbers without repetition from the set 1 ... 49","body":"<p>I need to generate 6 numbers without repetition from 1 to 49.\nI have something like that:</p>\n\n<pre><code>create table zadanie1(\nNAZWISKO varchar2(30),\nPUNKTY number,\nID number,\nconstraint stud1_nazw primary key(NAZWISKO)\n);\n\n\n\ncreate or replace procedure \"LOTTO\" IS\npkt number;\nbegin\n   loop\n       BEGIN\n       pkt := round(dbms_random.value(1,14),0);\n       INSERT INTO ZADANIE1(PUNKTY) VALUES (pkt);\n       exit;\n       Exception When DUP_VAL_ON_INDEX Then 0;\n       END;\nend loop;\nEND;\n</code></pre>\n\n<p>but this doesn't seem to work. Can somebody help me ?</p>\n"},{"tags":["sql","sql-server","database","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13274950,"title":"list all tables that don't exist but are used in a view sql server","body":"<p>I can't seem to get all the table names that a view is trying to use.</p>\n\n<p>Currently, I am using <code>INFORMATION_SCHEMA.VIEW_COLUMN_USAGE</code> to find which tables are used. But, it only finds tables that currently exist. I want to find out if that view is trying to use tables that don't exist.</p>\n\n<p><code>View_Column_Usage</code> will only find columns that are used in the view. You can check to see if those columns are in any of the current tables columns to find which columns aren't used, but you can't find which tables aren't used.</p>\n\n<p>Does anyone know a table I can use to find which tables are used in a view, but do not exist?</p>\n"},{"tags":["sql","query","search","search-engine","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13275510,"title":"How to retrieve records based on multiple bit of strings present in those records?","body":"<p>I am using Ruby on Rails v3.2.2 and the MySQL database. I have a database table containing data as-like the following (note: the <code>column1</code> contains comma separated strings):</p>\n\n<pre><code>id   | column1                          | column2 | columnM    \n-----|-----------------------------------------------------\n1    | one1                             | value1  |  ...\n2    | one1, two1                       | value1  |  ...\n3    | one1, two1, three1               | value1  |  ...\n4    | one2                             | value2  |  ...\n5    | one2, two2                       | value2  |  ...\n6    | one2, two2, three2               | value2  |  ...\n...  | ...                              | ...     |  ...\n1000 | oneN                             | valueN  |  ...\n1001 | oneN, twoN                       | valueN  |  ...\n1002 | oneN, twoN, threeN               | valueN  |  ...\n1003 | oneN, twoN, threeN, fourN        | valueN  |  ...\n</code></pre>\n\n<p>I would like to write a SQL query so to retrieve <em>records starting at the same time with one or more bit of strings</em> present in the <code>column1</code>. That is, for instance, given I search the <code>column1</code> for <em>strings</em></p>\n\n<pre><code>Case 1: \"thr\"\nCase 2: \"two1 thr\"\nCase 3: \"two thr\"\nCase 4: \"wo\"\nCase 5: \"one\"\nCase 6: \"four one\"\n</code></pre>\n\n<p>Then, I would like to get respectively records with following <code>id</code>s:</p>\n\n<pre><code>Case 1: 3, 6, 1002, 1003                         # returns all records starting with \"thr\"\nCase 2: 3                                        # returns all records starting with \"two1\" and at the same time starting with \"thr\" \nCase 3: 3, 6, 1002, 1003                         # returns all records starting with \"two\" and at the same time starting with \"thr\"\nCase 4:                                          # nothing to return\nCase 5: 1, 2, 3, 4, 5, 6, 1000, 1001, 1002, 1003 # returns all records starting with \"one\"\nCase 6: 1003                                     # returns all records starting with \"four\" and at the same time starting with \"one\"\n</code></pre>\n\n<p><em>How can I make the SQL query to behave as the above</em> (maybe, by using something as like wildcards or other things unknown to me)<em>?</em> Since I am trying to implement a \"simple\" search engine, what do you advice about? Is there some prescriptions?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13267949,"title":"Update field in Source table with Identity after insert target with merge statement","body":"<p>I have a table Items which should have a corresponding record in the table LanguageText. The ID (Identity) of LanguageText is registered in the Items.LanguageTextId field in my Items table.</p>\n\n<p>What I want to accomplish is a merge between LanguageText and Items for all records with null in Items.LanguageTextId and insert the itemname / text of these Item records in LanguageText plus update the LanguageTextId with the ID value from the newly inserted LanguageText record (SCOPE_IDENTITY()?)</p>\n\n<p>The insert works fine:</p>\n\n<pre><code>MERGE [dbo].[LanguageText] AS target\nUSING (SELECT [Items].* from [dbo].Items ) AS source \nON (TARGET.Id = SOURCE.LanguageTextId) \nWHEN NOT MATCHED By Target THEN \n    INSERT   \n       ([Text])\n VALUES\n       (source.[ItemName]);\n</code></pre>\n\n<p>end</p>\n\n<p>But I don't know how to update my items.Languagetextid, can I do something with:\nOUTPUT $action, INSERTED.ID ?\nOr is there a better way to have this done??</p>\n\n<p>Thanks in advance,</p>\n\n<p>Mike</p>\n"},{"tags":["mysql","sql","database","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13275137,"title":"Regarding formatting of the query","body":"<p>I have made an application in which I have put the sql queries in java method as below..</p>\n\n<pre><code>private static String getSaleTransactionsQuery(final String currentTradingDate){\n\n        final String query =\n            \" SELECT '990' line_code, \" +\n            \" sum(toti_wag.TTIW_CUST_CNT) amount \" +\n            \" FROM total_till_wag toti_wag \" +\n            \" where toti_wag.TOTI_TRADING_DATE = '\" + currentTradingDate + \"' \";\n\n        return query;\n    }\n</code></pre>\n\n<p>Now when I want to filter out sql queries then I have to copy this query on the sql file and have to manually remove the quotes(\"\") and the plus(+) sign in order to make them as pure sql and then have to execute them to see the query output , is there any other tool which will format all these means remove the quotes and the plus sign ,please advise</p>\n"},{"tags":["sql","sql-server","sql-server-2008","version-control"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13274498,"title":"Add version control to existing SQL Server database","body":"<p>I am part of a development team currently working with a database that does not have any kind of source control. We work with SQL Server 2008 R2 and have always managed the DB directly with SSMS. It now has ~340 tables and ~1600 stored procedures, plus a few triggers and views, so it is not a small DB.</p>\n\n<p>My goal is to have the DB under version control, so I have been reading articles, like <a href=\"http://bitly.com/9cJmGR\" rel=\"nofollow\">Scott Allen's series</a> and many old SO related questions. But I am still unable to decide on how to proceed.</p>\n\n<p>What I'm thinking of is to script the database schema in one file, then procedures, triggers and views in one file each. Then keep everything versioned under Mercurial. But of course, every member of the team can access SSMS and directly change the schema and procedures, with the possibility that any of us can forget to replicate those changes in the versioned files.</p>\n\n<p>What better options are there? And, did I forget any element worth having source control of? My biggest concern is that most of the literature I found explains how to do version control when creating a new database, but not when it is already old and relatively big.</p>\n"},{"tags":["mysql","sql","select"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13274746,"title":"Count popular tags with comma delimited field on MySQL","body":"<p>I have a comma delimited field on my table, it stores Tags like:</p>\n\n<pre><code>avengers, heroes, marvel, 2012, hulk, captain america\n</code></pre>\n\n<p>And i want to get the most used tags.</p>\n\n<p>How can i do this on one single SELECT query?</p>\n"},{"tags":["sql","query","sqlite","parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13242543,"title":"Parsing simplified SQL queries with Perl into SQLite","body":"<p>I am trying to turn a \"simplified\" sql query into a working SQLite one to use against XnViews databases, meaning the database layout is at best suboptimal for what I'm trying to do AND I can't change anything about that.</p>\n\n<p>Example would be \"(cat_10 and cat_12) and (cat_5 or cat_7)\".</p>\n\n<p>This should be used against the table \"t3\", which has the fields \"if\" (fileID) and \"ic\" (categoryID).</p>\n\n<p>The entries look like this:</p>\n\n<pre><code>if, ic\n7, 10\n7, 12\n7, 4\n9, 10\n9, 12\n9, 5\n10, 10\n10, 12\n10, 7\n</code></pre>\n\n<p>The simplified query above should only select the files 9 and 10 as 7 does have the wanted categories 10 and 12 but has neither 5 nor 7.</p>\n\n<p>The actual problem now is building that hell of a query statement because it took me already some hours to simply get an AND between two categories working.</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\n</code></pre>\n\n<p>This gives me all fileIDs that contain category 10 and 12, but I have no idea how I should combine that with the remaining \" and (cat_5 or cat_7)\".</p>\n\n<p>When I planned these simplified sql statements (made by a click-it-together-builder made in html and js) I was planning to simply replace \"cat_5\" with \"t3.ic = 5\" and leave the rest as it is.</p>\n\n<p>Of course I didn't forsee that it wouldn't work as where checks the entry as a whole and there can't be ic = 5 AND ic = 7. That pretty much broke everything.</p>\n\n<p>So I'm wondering if anyone would have an idea how I could translate these simple queries in actual working ones, keeping in mind that it might not be limited to ( x and y ) pairs.</p>\n\n<p>Edit: I worked out how to do the example I've given, I think atleast:</p>\n\n<pre><code>SELECT if FROM t3 WHERE ic IN (10, 12) GROUP BY if HAVING count(if) = 2\nINTERSECT if FROM t3 WHERE ic IN (5, 7) GROUP BY if\n</code></pre>\n\n<p>But the main problem now is resolving the ( ) in the right order.</p>\n\n<p>Edit 2: I think I'm giving grouping the categories into one field with group_concat() a try, then I should be able to simply to cats LIKE \"  \" AND which would be small blocks I could easy throw together, then just the brackets and it should work. Highlighting the 'should'.</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13262657,"title":"Date calculation in variable","body":"<p>I'm doing my best to set a date variable so I can compare it later.  I would like something that basically says:</p>\n\n<p>If the current day-of-month is less than 11, then date is 10th of LAST month<br>\nIf the current day-of-month is greater-than-or-equal-to 11, then date is 10th of THIS month</p>\n\n<p>Date is 11/6/2012 expected output:</p>\n\n<pre><code>@PODate = 10/10/2012\n</code></pre>\n\n<p>Date is 11/16/2012 expected output:</p>\n\n<pre><code>@PODate = 11/10/2012\n</code></pre>\n\n<p>Currently all I have is this:</p>\n\n<pre><code>DECLARE @PODate as DATETIME\nSet @PODate = Convert(varchar(8),GetDate(),1)\n</code></pre>\n\n<p>Any tips or help would be greatly appreciated.  Thank you!!</p>\n"},{"tags":["java","sql","database","jdbc","odbc"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":4,"view_count":69,"score":-3,"question_id":13266332,"title":"Strange SQL statements being inserted into database","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their <code>username (their email address)</code> so as to fill in an input form. The functionality of the input form is that the user has to enter for <code>book names</code> in order of priority. </p>\n\n<p>In the application, suppose a user's email address is <code>\"david.ferno@gmail.com\"</code>. He will have to input only <code>\"david.ferno\"</code> in the <code>JTextBox</code>, and a <code>SQL LIKE</code> statement is used check the corresponding User ID from the \"bookuser\" table and store it into the <code>\"priority\" table</code> along with the <code>book priority choices</code>. </p>\n\n<p>I have used <code>PreparedStatement</code> for the <code>SQL</code> retrieval from <code>database</code> but when values are being inserted to the , instead of saving <code>User ID</code> like <code>\"user88\"</code>, it is <code>saving the SQL statement</code> itself inside the database.  </p>\n\n<p>What I mean to say is, in the <code>\"priority\"</code> table, instead of saving <code>user88</code> (as an example), it is saving <code>\"SELECT User_ID FROM user WHERE email_address\"</code></p>\n\n<p>Please help me to find out what is wrong with my code.</p>\n\n<p><strong>Here are my codes</strong></p>\n\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport javax.swing.*;\nimport java.sql.*;\nimport javax.*;\n\npublic class addpriority extends JFrame{\npublic JTextField txt_email, txt_book1, txt_book2,txt_book3, txt_book4;\npublic JLabel label1;\npublic JButton confirm;\n\npublic addpriority(){\n    super(\"Book Choice Input Menu\");\n    this.setSize(506,620);\n    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n    this.setVisible(true);\n\n    Toolkit toolkit =  Toolkit.getDefaultToolkit ();\n    Dimension dim = toolkit.getScreenSize();\n\n    setLocation((int) (dim.width*0.25), 50);\n\n    JPanel label = new JPanel();\n    JLabel welcome = new JLabel(\"Input Book Priorities\");\n\n    Font f = new Font(\"Verdana\", Font.BOLD,16);\n    welcome.setForeground(Color.BLACK);\n    welcome.setFont(f);\n    add(label);\n    label.add(welcome);\n\n    GridLayout g1 = new GridLayout(15, 2, 0, 10);\n    setLayout(g1);\n\n    JPanel textfield1 = new JPanel();\n    JLabel userid = new JLabel(\"Please Enter your username:\");\n    txt_mail = new JTextField(20);\n    JLabel lect2 = new JLabel(\"@gmail.com\");\n    add(textfield1);\n    textfield1.add(userid);\n    textfield1.add(txt_mail);\n    textfield1.add(lect2);\n\n\n    JPanel textfield2 = new JPanel();\n    add(textfield2);\n\n    JPanel textfield3 = new JPanel();\n    JLabel lbl1 = new JLabel(\"Set Priority by entering Books' name:\");\n    add(textfield3);\n    textfield3.add(lbl1);\n\n\n    JPanel textfield4 = new JPanel();\n    JLabel lbl2 = new JLabel(\"1st Priority:\");\n    txt_module1 = new JTextField(10);\n    add(textfield4);\n    textfield4.add(lbl2);\n    textfield4.add(txt_module1);\n\n    JPanel textfield5 = new JPanel();\n    JLabel lbl3 = new JLabel(\"2nd Priority:\");\n    txt_module2 = new JTextField(10);\n    add(textfield5);\n    textfield5.add(lbl3);\n    textfield5.add(txt_module2);\n\n\n    JPanel textfield6 = new JPanel();\n    JLabel lbl4 = new JLabel(\"3rd Priority:\");\n    txt_module3 = new JTextField(10);\n    add(textfield6);\n    textfield6.add(lbl4);\n    textfield6.add(txt_module3);\n\n    JPanel textfield7 = new JPanel();\n    JLabel lbl5 = new JLabel(\"4th Priority:\");\n    txt_module4 = new JTextField(10);\n    add(textfield7);\n    textfield7.add(lbl5);\n    textfield7.add(txt_module4);\n\n    JPanel button = new JPanel();\n    confirm = new JButton(\"Confirm\");\n    confirm.setMnemonic('C');\n    confirm.addActionListener(new ActionListener() {\n        public void actionPerformed(ActionEvent e)\n        {\n            confirm.setEnabled(true);\n            }\n    });\n\n\n    Handleraddclassroom h = new Handleraddclassroom();\n    confirm.addActionListener(h);\n\n    button.add(confirm);\n    add(button);\n\n\n}\n\n\npublic class Handleraddclassroom implements ActionListener{\n    public void actionPerformed(ActionEvent event){\n\n        String name = ((JButton)event.getSource()).getText();\n\n\n        if (name.equals(\"Confirm\")){\n\n            String filename = \"C:/JAVA/book.accdb\";\n            String database = \"jdbc:odbc:booking\";\n\n            if(txt_mail.getText().equals(\"\")){\n                JOptionPane.showMessageDialog(addpriority.this,\"Your Username Field cannot be blank\");\n\n\n            }\n\n            else{\n\n\n            try {\n                Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                Connection con = DriverManager.getConnection(database ,\"\",\"\");  //username &amp;password not being used\n\n                Statement s = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY); //The Result set can now scroll forward and back\n\n\n\n\n            String squery = \"SELECT User_ID FROM bookuser WHERE email_address LIKE ? \";\n            PreparedStatement pstmt = con.prepareStatement(squery);\n            pstmt.setString (1, txt_mail.getText() + '*');\n                            pstmt.executeQuery();\n\n            String sql = \"INSERT INTO priority VALUES('\" \n\n                + squery + \"','\"\n                + txt_book1.getText() + \"','\"\n                + txt_book2.getText() + \"','\" \n                + txt_book3.getText() + \"','\"\n                + txt_book4.getText()+ \"' )\";\n\n            JOptionPane.showMessageDialog(addpriority.this,\"Choice Records Saved.\");\n\n            dispose();\n\n            Mainmenulecturer mml = new Mainmenulecturer();\n\n            s.execute(sql);\n\n            s.close();\n            con.close();\n\n            } catch (Exception e) {System.out.print(\"Error: \" + e);}\n            }\n        }\n    }   \n\n\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["php","jquery","html","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13274593,"title":"PHP, Jquery and DOM manipulation","body":"<p>I have a list that's being populated from the database it's sorted using the time field by ASC dates. I'm using the <code>&lt;?php foreach() :?&gt;</code> to loop through and populate the list .</p>\n\n<pre><code>&lt;li id=\"events\"&gt;\nTime: &lt;?php echo $venue['time']; ?&gt; \nEvent: &lt;?php echo $venue['location']; ?&gt; \n&lt;/li&gt; \n</code></pre>\n\n<p>I have a variable in php called ($time_left ) that keeps track of the days left till <em>each</em> event begins I calculate this by taking the time field from the database subtracting today's current date with <code>php date()</code> <strong>when this reaches 0 how can I remove the expired event from the start of the list and append it to the end.</strong></p>\n\n<p>This can be done on page refresh I don't need it to be asynchronous.  Can I do this just in PHP with DOM manipulation?  or should I use Jquery and if so how do I pass the $time_left variable from PHP to my Jquery script?</p>\n"},{"tags":["c#","sql","database","api","concurrency"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":13224787,"title":"Database recommendations needed -> Columnar, Embedded (if possible), fast, fast, fast","body":"<p>I am searching for the ideal database structure/solution that meets most of my below requirements but so far I utterly failed. Can you please help?</p>\n\n<p>My tasks: I run a process in .Net 4.5 (C#) and generate (generally) value types that I want to use for further analysis in other applications and therefore like to either preserve in-memory or persist on disk. More below. The data is generated within different tasks/threads and thus a row based data format does not lend itself well to match this situation (because the data generated in different threads is generated at different times and is thus not aligned). Thus I thought a columnar data structure may be suitable but please correct me if I am wrong.</p>\n\n<p>Example:</p>\n\n<p>Tasks/Thread #1 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000001 233.23</p>\n\n<p>1000000002 233.34</p>\n\n<p>1000000006 234.23\n...</p>\n\n<p>Taks/Thread #2 generates the following data at given time stamps</p>\n\n<p>datetime.ticks / value of output data</p>\n\n<p>1000000002 33.32</p>\n\n<p>1000000005 34.34</p>\n\n<p>1000000015 54.32\n...</p>\n\n<p>I do not need to align the time stamps at the .Net run-time, I am first and foremost after preserving the data and to process the data within R or Python at a later point.</p>\n\n<p>My requirements:</p>\n\n<ul>\n<li><p>Fast writes, fast writes, fast writes: It can happen that I generate 100,000- 1,000,000 data points per second and need to persist (worst case) or retain in memory the data. Its ok to run the writes on its own thread so this process can lag the data generation process but limitation is 16gb RAM (64bit code), more below.</p></li>\n<li><p>Preference is for columnar db format as it lends itself well to how I want to query the data later but I am open to any other structure if it makes sense in regards to the examples above (document/key-value also ok if all other requirements are met, especially in terms of write speed). </p></li>\n<li><p>API that can be referenced from within .Net. Example: HDF5 may be considered capable by some but I find their .Net port horrible.Something that supports .Net a little better would be a plus but if all other requirements are met then I can deal with something similar to the HDF5 .Net port.  </p></li>\n<li><p>Concurrent writes if possible: As described earlier I like to write data concurrently from different tasks/threads.</p></li>\n<li><p>I am constrained by 16gb memory (run .Net process in 64bit) and thus I probably look for something that is not purely in-memory as I may sometimes generate more data than that. Something in-memory which persists at times or a pure persistence model is probably preferable. </p></li>\n<li><p>Preference for embedded but if a server in a client/server solution can run as a windows service then no issue. </p></li>\n<li><p>In terms of data access I have strong preference for a db solution for which interfaces from R and Python already exist because I like to use the Panda library within Python for time series alignments and other analysis and run analyses within R.</p></li>\n<li><p>If the API/library supports in addition SQL/SQL-like/Linq/ like queries that would be terrific but generally I just need the absolute bare bones such as load columnar data in between start and end date (given the \"key\"/index is in such format) because I analyze and run queries within R/Python.</p></li>\n<li><p>If it comes with a management console or data visualizer that would be a plus but not a must. </p></li>\n<li><p>Should be open source or priced within \"reach\" (no, KDB does not qualify in that regards ;-)</p></li>\n</ul>\n\n<p>OK, here is what I have so far, and again its all I got because most db solution simply fail already on the write performance requirement:</p>\n\n<ul>\n<li>Infobright and Db4o. I like what I read so far but I admit I have not checked into any performance stats</li>\n<li>Something done myself. I can easily store value types in binary format and index the data by datetime.ticks (8 bit longs), I just would need to somehow write scripts to load/deserialize the data in Python/R. But it would be a massive tasks if I wanted to add concurrency, a query engine, and other goodies. Thus I look for something already out there. </li>\n</ul>\n"},{"tags":["sql","database","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13273849,"title":"How do I access data in a database table with SQL","body":"<p>My database has table <code>UserTBL</code> with fields <code>UserID</code>, <code>Name</code> and <code>Email</code>.</p>\n\n<p>Now i already have created a database and GUI in visual Basic and now configuring database.\nThere are few problems i am facing in extracting the exact user from the database because the thing i learned to filter from database is </p>\n\n<pre><code>Me.UserTBLBindingSource.Filter = String.Format(\"UserName =  '{0}'\", Me.TextBox4.Text)\n</code></pre>\n\n<p>Where textbox4 is my input box. Now as many user can have same name. My first problem is how do i extract exact user by using additions details such as email ?</p>\n\n<p>Also i am also planning to store some of the database elements in visual basic variables.\nSomething like,</p>\n\n<pre><code>Dim str1 As String\nstr1 = Me.UserTBLBindingSource.UserID\n</code></pre>\n\n<p>Now, if anyone really know how to do above, kindly try to help me.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13274556,"title":"SQL Conversion Error","body":"<p>I really need a second pair of eyes on this... I have a Stored Procedure with a variable:</p>\n\n<pre><code>DECLARE @date_period_end int \n\nIF @date_period_end = '' or @date_period_end is null  \nBEGIN \n    SET @date_period_end = 'DATEDIFF(dd, ''1/1/1753'', CONVERT(datetime,getdate())) + 639906 ' \nEND\n</code></pre>\n\n<p>Here is the error SQL returning when I execute:</p>\n\n<blockquote>\n  <p>Conversion failed when converting the varchar value 'DATEDIFF(dd, '1/1/1753', CONVERT(datetime,getdate())) + 639906 ' to data type int.</p>\n</blockquote>\n\n<p>I'm pretty certain I'm missing or have added an incorrect amount of quotes somewhere.  Thanks.</p>\n"},{"tags":["mysql","sql","query","sql-order-by","order"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13271667,"title":"MySQL order by multiple columns while grouping by one","body":"<p>So I have a weird scenario where I want the following data to be ordered in a certain way. Let the table data be:</p>\n\n<pre><code>abc 111 2     priority\nabc 111 blah  data\nabc 222 1     priority\nabc 222 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>I want to order that data based on column three (where column 4 is priority) but keep the return order grouped by column 2. So the expected query result would look like:</p>\n\n<pre><code>abc 222 1     priority\nabc 222 blah  data\nabc 111 2     priority\nabc 111 blah  data\nabc 333 3     priority\nabc 333 blah  data\n</code></pre>\n\n<p>What's the best possible way of doing this. I can think of doing a query up front and an in clause, but then I would have to account for all possible priorities.</p>\n\n<p>Thanks in advance. FYI, its MySQL that I am using.</p>\n\n<p>ANSWER (but still looking to see if someone has a more efficient way)\ngiven - </p>\n\n<pre><code>CREATE TABLE my_data( name VARCHAR(20),groupid INT(5), attributekey VARCHAR(10),attributevalue VARCHAR(10));\n\nINSERT INTO my_data VALUES(\"abc\", 111, \"priority\", \"2\");\nINSERT INTO my_data VALUES(\"abc\", 111, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"priority\", \"1\");\nINSERT INTO my_data VALUES(\"abc\", 222, \"someattr\", \"blah\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"priority\", \"3\");\nINSERT INTO my_data VALUES(\"abc\", 333, \"someattr\", \"blah\");\n</code></pre>\n\n<p>solution -</p>\n\n<pre><code>SELECT m1.*,\n(select attributevalue from my_data m2\n   where m1.groupid=m2.groupid \n   AND m2.attributekey='priority' \n) groupidpriority \nFROM my_data m1\norder by groupidpriority;\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13274296,"title":"Auto Increment feature of SQL Server","body":"<p>I have created a table named as ABC. It has three columns which are as follows:-</p>\n\n<p><img src=\"http://i.stack.imgur.com/3sx3t.png\" alt=\"enter image description here\">              </p>\n\n<p>The column <code>number_pk</code> <code>(int)</code> is the <strong>primary key</strong> of my table in which I have made the <code>auto increment</code> feature on for that column.</p>\n\n<p>Now I have deleted two rows from that table say <code>Number_pk= 5</code> and <code>Number_pk =6</code>.</p>\n\n<p>The table which I get now is like this:-</p>\n\n<p><img src=\"http://i.stack.imgur.com/bTpbm.png\" alt=\"enter image description here\"></p>\n\n<p>Now if I again enter two new rows in this table with the same value I get the two new <code>Number_pk starting from 7 and 8</code> i.e,</p>\n\n<p><img src=\"http://i.stack.imgur.com/Y3fLv.png\" alt=\"enter image description here\"></p>\n\n<p>My question is that what is the logic behind this since I have deleted the two rows from the table. I know that a simple answer is because I have set the auto increment on for the primary key of my table. But I want to know is there any way that I can insert the two new entries starting from the last Number_pk without changing the design of my table?</p>\n\n<p>And how the <strong><em>SQL Server manage this record since I have deleted the rows from the database??</em></strong></p>\n"},{"tags":["mysql","sql","query","optimization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13241119,"title":"Problems with a slow Dependent Subquery","body":"<p>I have a query I'm running in MySQL.  As you can see, every part of the query is on indexed fields.  Nevertheless, the query takes forever (tens of minutes, longer than I'm willing to wait).  The Connect tables consist of two integers and two indexes (one field one, field two, the other field two, field one). Source and target are tables with a single indexed int field.  Given all the indexes, I expected this query to finish in seconds.  Any suggestions on 1: why it's taking so long, and 2: how to make it faster?</p>\n\n<p>Thanks!</p>\n\n<pre><code>mysql&gt; explain \nSELECT DISTINCT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n  JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n  JOIN InDels2 AS source ON source.id = snpEConnect.indelID \n  WHERE geneConnect.geneSymbolID NOT IN (\n    SELECT geneConnect.geneSymbolID FROM SNPEffectGeneConnector AS geneConnect \n    JOIN IndelSNPEffectConnector AS snpEConnect ON geneConnect.snpEffectID = snpEConnect.snpEffectID \n    JOIN InDels3 AS target ON target.id = snpEConnect.indelID);\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n| id | select_type        | table       | type  | possible_keys     | key      | key_len | ref                                                                   | rows | Extra                          |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n|  1 | PRIMARY            | source      | index | id                | id       | 4       | NULL                                                                  | 5771 | Using index; Using temporary   |\n|  1 | PRIMARY            | snpEConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.source.id                                           |    2 | Using index                    |\n|  1 | PRIMARY            | geneConnect | ref   | snpEList          | snpEList | 4       | treattablebrowser.snpEConnect.snpEffectID                             |    1 | Using where; Using index       |\n|  2 | DEPENDENT SUBQUERY | geneConnect | ref   | snpEList,geneList | geneList | 4       | func                                                                  |    1 | Using index                    |\n|  2 | DEPENDENT SUBQUERY | target      | index | id                | id       | 4       | NULL                                                                  | 6297 | Using index; Using join buffer |\n|  2 | DEPENDENT SUBQUERY | snpEConnect | ref   | snpEList          | snpEList | 8       | treattablebrowser.target.id,treattablebrowser.geneConnect.snpEffectID |    1 | Using index                    |\n+----+--------------------+-------------+-------+-------------------+----------+---------+-----------------------------------------------------------------------+------+--------------------------------+\n</code></pre>\n\n<p>6 rows in set (0.01 sec)</p>\n"},{"tags":["sql","database","query","count","db2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13273023,"title":"DB2 - Printing info in a Count","body":"<p>Here is the question and my attempt at an answer. I believe that it's successfully selecting records that have borrowed more than one book, I just don't know how to print the book info.</p>\n\n<p>--Find the cardholders (b_name, b_addr) who have borrowed exactly 3 books. Include in your answer the author and title of the borrowed books. </p>\n\n<pre><code>SELECT DISTINCT b_name, b_addr\nFROM cardholder ch, copy c, book k\nWHERE ch.borrowerid IN (SELECT borrowerid\n                        FROM borrows b\n                        WHERE b.borrowerid = ch.borrowerid \n                        AND c.accession_no = b.accession_no\n                        GROUP BY borrowerid\n                        HAVING COUNT(DISTINCT l_date) = 3);\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13217854,"title":"SQL query combined column values","body":"<p>I'm really not sure how to title this question... Imagine that we have a table looking like this:</p>\n\n<pre><code>object | attribute | value\n------------------------------\n   7     country     Germany\n   7     position    12\n   7     points      12\n   8     country     Germany\n   8     position    10\n   8     points      3\n</code></pre>\n\n<p>Now I want to select all object identifiers that has country germany and position 12 or 5</p>\n\n<p>I have no idea how to write this query, is it possible?</p>\n"},{"tags":["sql","sql-server","query","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13274256,"title":"Swapping rows and columns in a \"Group by\" query","body":"<p>I currently have the following: </p>\n\n<pre><code>SELECT status,count(status) AS count\n  FROM [DB].[dbo].[contact]\n  GROUP BY status\n</code></pre>\n\n<p>Which gives me the following: </p>\n\n<pre><code>Status 1   |   12\nStatus 2   |   23\nStatus 3   |   63\n</code></pre>\n\n<p>I'm trying to get the table to look like this: </p>\n\n<pre><code>Status 1   Status 2   Status 3  \n   12        23         63\n</code></pre>\n\n<p>Eventually the table will look like this: </p>\n\n<pre><code>                 Status 1   Status 2   Status 3  \nDate Range 1        12        23         63\nDate Range 2        23        2           3       \n</code></pre>\n\n<p>I'm just not sure what to do now.  What kind of SQL commands / syntax should I study to get this done?  This is my first time looking at SQL so any pointers would be awesome.  </p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13274340,"title":"Create SEQUENCE such that it should initialize on every next day","body":"<p>Suppose SEQUENCE starts from \"1\", today it generated some sequences then on next day it should again start from \"1\".</p>\n\n<p>Is it possible or need to find any workaround ?</p>\n"},{"tags":["mysql","sql","database","query","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13267870,"title":"optimizing a delete query for table with no index?","body":"<p>Let's say we have the following tables:\nr(a, b, c)\nwhere a is some integer, and the table has 50 rows\ns(d, e, f, a)\ns.a is a foreign key onto t.a.\neach tuple is 400 bytes and s is a multiset since this is a SQL database.\ns holds about 1 million tuples. \nwhen a table is added, the database server automatically creates an index on the primary-­‐key columns in the table so for example t has an index on a. However, Oracle does not create indexes on columns that are foreign keys. So s has no index.\nWe want to delete 15 rows from t. So here is what we do:\n1) We remove rows from s that have the same a values in t. This takes 10 minutes.\n2) Then we run the statement DELETE FROM t WHERE a IN (values we are trying to remove, 15 of them to be exact)\nThis takes about 6 hours. </p>\n\n<p>So my guess is the second step takes a long time because for every tuple in t, we are comparing the value of a to every value within the query list. So how can we optimize this query to get the same result but much faster!?</p>\n"},{"tags":["sql","sql-server","vbscript","connection-string","adodb"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13089112,"title":"Unable to use vbscript to connect to sql server on diffrenet domain","body":"<p>I'm using vbscript to try to connect to a sql server on another domain. The server is part of a cluster and is SQL Server Data Center Edition (64bit). I can ping the server from my machine. I'm using the IP address to connect which works fine on SSMS.\nThe vbscript code I'm using is:</p>\n\n<pre><code>Set cn = CreateObject(\"ADODB.Connection\")\ncn.Open \"DRIVER={SQL Server};Server=123.456.345.567\\instance;Database=MyDB;User\nID=domain\\myuserid;Password=mypass;\"\nstrCommandText = \"Select * from mytable\"\ncn.Execute strCommandText\n</code></pre>\n\n<p>When I run this, I get the following error: \nMicrosoft OLE DB Provider for\nODBC Drivers: [Microsoft][ODBC SQL Server Driver][SQL Server]Login failed for user 'domain\\myuserid'.</p>\n\n<p>I can't join my test machine to the domain and I can't use sql authentication as it's disabled on the sql server.</p>\n\n<p>What do I need to do to get this to work?</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13273333,"title":"Compare two Tables SQLSE","body":"<p>I want to know if that possible to compare two columns in two different tables in one database using C# with SQLSE.  if the two table has the same data in order, i can say the two tables are match; otherwise, there is no match.</p>\n\n<p>// More info </p>\n\n<p>I want to compare two column has repeated value the two column vlaues come from actual combination of visits for two patients and i want to check do they visit the hospital on the same date and rational insted to go for every 5 combination and compare the match i want to compare the whole table</p>\n"},{"tags":["sql","list","vba","ms-access","northwind"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13273393,"title":"Access DB GUI. Loop through","body":"<p>Well, I need a code to loop through all the records in a table so I can extract some data.Right now I doing it using SQL-queries but it's not good thing. Here's the code</p>\n\n<pre><code>Private Sub booklist_Click()\n    Dim dbs As Database, curBookList As Recordset, qdf As QueryDef, strQuery As String\n\n    strQuery = \"SELECT [Authors].[first_name] as [Name], [Authors].[last_name] as [Surname],[Books].[book_name] as [Book] FROM [Books], [Authors] WHERE [Books].[author_id] = [Authors].[author_id] AND [Books].[taken] = False\"\n\n    Set dbs = CurrentDb()\n\n    Set curBookList = dbs.OpenRecordset(strQuery, dbOpenSnapshot)\n\n\n\n    With dbs\n        Set qdf = .CreateQueryDef(\"Booklist\", strQuery)\n        DoCmd.OpenQuery \"Booklist\"\n        .QueryDefs.Delete \"Booklist\"\n    End With\n\n        dbs.Close\n        qdf.Close\n\nEnd Sub\n</code></pre>\n\n<p>I need to output data in some form and there list should look someting like <code>Inventory List</code> Form in <code>Northwind</code> but an example if book is taken line should be highlighted by red color and if not - green (this thing is responsible for dat in table <code>[Books].[taken]</code> ).</p>\n"},{"tags":["sql","sql-server-2008","udf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13273350,"title":"Splitting long strings in SQL","body":"<p>The inline solution suggested here: <a href=\"http://stackoverflow.com/questions/2647/split-string-in-sql\">Split string in SQL</a> by vzczc only works for strings containing less than 100 elements because of the limit of recursion depth (and you can't change the limit inside a UDF).</p>\n\n<p>Any other ways of splitting long strings with good performance? The UDF I've been using (not inline) has been very slow:</p>\n\n<pre><code>CREATE FUNCTION [dbo].[fn_ParseDelimitedStrings](@String nvarchar(MAX), @Delimiter char(1))\nRETURNS @Values TABLE\n(\n RowId int Not Null IDENTITY(1,1) PRIMARY KEY\n,Value nvarchar(255) Not Null\n)\nAS\nBEGIN\n    DECLARE  @startPos smallint\n        ,@endPos smallint\n\n    IF (@String = '')\n    RETURN\n\n    IF (RIGHT(@String, 1) != @Delimiter)\n        SET @String = @String + @Delimiter\n    SET @startPos = 1\n    SET @endPos = CharIndex(@Delimiter, @String)\n    WHILE @endPos &gt; 0\n    BEGIN\n        INSERT @Values(Value)\n        SELECT LTRIM(RTRIM(SUBSTRING(@String, @startPos, @endPos - @startPos)))\n        -- remove the delimiter just used\n        SET @String = STUFF(@String, @endPos, 1, '')\n        -- move string pointer to next delimiter\n        SET @startPos = @endPos\n        SET @endPos = CHARINDEX(@Delimiter, @String)\n    END\n    RETURN\nEND\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","ssis","ssis-data-transformations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13273885,"title":"How do I fetch only records created in the past year from a table within SSIS package?","body":"<p>I have a column <strong>CT_DT</strong> in a  table. I have to process only transactions created within the past <code>365 days</code>.</p>\n\n<p>For example, suppose the current date is <strong>Nov 7, 2012</strong>, I have to process only those transaction that were created since <strong>Nov 7, 2011</strong>. I am using conditional filter within the SSIS package.</p>\n"},{"tags":["sql","join","syntax","runtime-error"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":5,"view_count":31,"score":-5,"question_id":13255132,"title":"Error in Left Join Syntax when using identical structure of working query","body":"<p>This query is  not working:</p>\n\n<pre><code>Select *\nFrom TableA \nLeft Join TableB on TableA.Parameter_ID = TableB.ID\nWhere TableA.Field = var\n</code></pre>\n\n<p>Table B is a table of multiple parameters to different types given by a 1-->n relationship inside Table A:</p>\n\n<pre><code>Select * \nFrom TableC \nleft join TableB on TableC.Parameter_ID = TableB.ID \nWhere TableC.Field= var\n</code></pre>\n\n<p>I have triple checked spellings and am quite sure I have nothing misspelled. Also I should've got an <code>item could not be found in requested ordinal error</code> if that had been the case. var is different vars btw.</p>\n\n<p>Desired output is max 3 records to a recordset that are then read out by do while loop.</p>\n\n<p>EDIT:\nI tried to handle this via While loop now, meaning I saved the common parameter in a var and now walk through TableB. Now i get \"Runtime Error 80040e14: Syntax error in From Clause\"</p>\n\n<pre>\nSelect * \nFrom TableB \nWhere Id =\" & Var\n</pre>\n"},{"tags":["sql","sqlplus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13273894,"title":"SQL film database queries","body":"<p>I'm having trouble solving the following SQL requests:</p>\n\n<p>1) \"Give the original name and year, also the current name and year, and the studio of the films that were made before '1960' then remade after '2000'.\"</p>\n\n<p>2) \"Get the filmname of all films created before ‘1951’ and remade after ‘2000’\"</p>\n\n<p>There are several tables but I'm assuming that only 2 are needed: 'films' and 'remakes'</p>\n\n<p>'films' attributes: filmid, filmname, year, director, studio</p>\n\n<p>'remakes' attributes: filmid, title, year, priorfilm, prioryear</p>\n\n<p>My understanding is that remakes are included in films so the priorfilm in 'remakes' table corresponds to a filmid in the 'films' table. I'm having trouble linking the two to be able to place the year conditions.</p>\n"},{"tags":["c#","sql","xml","escaping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13273860,"title":"Backslashes in XML returned from stored procedure","body":"<p>I have written a stored procedure that returns my rows as XML with the following syntax:</p>\n\n<pre><code>FOR XML PATH ('customer'), ROOT ('customers'), TYPE\n</code></pre>\n\n<p>Running the query from the stored procedure in SSMS produces output that when clicked, looks just fine.  </p>\n\n<p>However, calling that stored procedure from C# gives me XML that I assume has double quotes that are escaped, thus:</p>\n\n<pre><code>&lt;customers&gt;&lt;customer id=\\\"123456\\\" firstName=\\\"ABE\\\" lastName=\\\"LINCOLN\\\" dob=\\\"02/12/1809\\\"&gt;\n</code></pre>\n\n<p>My C# code looks like this:</p>\n\n<pre><code>public string GetCustomerXML()\n{\n     string xml = string.Empty;\n     XmlDocument xmlDoc = new XmlDocument();\n\n     using (SqlConnection myConnection = new SqlConnection(connectionString))\n     {\n          myConnection.Open();\n\n          using (SqlCommand cmd = new SqlCommand(\"GetData_CreateXML\", myConnection))\n          {\n               cmd.CommandType = CommandType.StoredProcedure;\n\n               using (XmlReader reader = cmd.ExecuteXmlReader())\n               {\n                   while (reader.Read())\n                   {\n                       xmlDoc.Load(reader);\n                       xml = xmlDoc.OuterXml.ToString();\n                   }\n               }\n           }\n     }\n\n     return xml;\n}\n</code></pre>\n\n<p>What am I getting wrong here? </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","sql-server","sql-server-2008-r2","common-table-expression"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13271764,"title":"Split rows in table using CTE","body":"<p>I have the following rows from a table in SQL Server 2008 R2</p>\n\n<pre><code>+-------------------------------------------+\n|  ID          EntryType dt         price   |\n+-------------------------------------------+\n| 14          4         2012-11-07 0.025000 |\n| 16          5         2012-11-07 0.026000 |\n| 18          6         2012-11-07 0.026000 |\n| 20          7         2012-11-07 0.026000 |\n+-------------------------------------------+\n</code></pre>\n\n<p>What I would like to do is spread the rows based on the EntryType (the EntryType doesn't change)</p>\n\n<pre><code>For EntryType = 4 (1 row)\nFor EntryType = 5 (2 row)\nFor EntryType = 6 (3 row)\nFor EntryType = 7 (9 row)\n</code></pre>\n\n<p>and the dt field will be incremented (in a Month interval), so the output looks like this:</p>\n\n<pre><code>+-----------+-----------+-------+\n| EntryType |    dt     | Price |\n+-----------+-----------+-------+\n|         4 | 11/7/2012 | 0.024 |\n|         5 | 12/7/2012 | 0.025 |\n|         5 | 1/7/2013  | 0.025 |\n|         6 | 2/7/2013  | 0.026 |\n|         6 | 3/7/2013  | 0.026 |\n|         6 | 4/7/2013  | 0.026 |\n|         7 | 5/7/2013  | 0.027 |\n|         7 | 6/7/2013  | 0.027 |\n|         7 | 7/7/2013  | 0.027 |\n|         7 | 8/7/2013  | 0.027 |\n|         7 | 9/7/2013  | 0.027 |\n|         7 | 10/7/2013 | 0.027 |\n|         7 | 11/7/2013 | 0.027 |\n|         7 | 12/7/2013 | 0.027 |\n|         7 | 1/7/2014  | 0.027 |\n+-----------+-----------+-------+\n</code></pre>\n\n<p>Is it possible to do that with CTE and SQL?</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13273795,"title":"primary key in many to many table","body":"<p>let say i have two table, User and Language</p>\n\n<pre><code>user (Table Name)\n-----------------\nuser_id (PK)\nuser_name\nmobile\n...\n....\n\nlanguage (Table Name)\n---------------------\nlang_code (PK)\nlang_name\n...\n....\n</code></pre>\n\n<p>The Question is, if i want to add relationship between user and language table(Many to many) which is a right way ?</p>\n\n<pre><code>solution 1\n\nuser_language (Table Name)\n--------------------------\nuser_id (FK)\nlang_code (FK)\n\n\nor solution 2\n\nuser_language (Table Name)\n--------------------------\nuser_id (PK)\nlang_code (PK)\n\n\nor solution 3\n\nuser_language (Table Name)\n--------------------------\nuser_lang_id (PK)\nuser_id (FK)\nlang_code (FK)\n</code></pre>\n\n<p>i saw many people add primary key on many to many table, but i think that not important and wasting space. so which is right ?</p>\n\n<p>btw i'm using PostgreSQL</p>\n"},{"tags":["sql","sql-server-2008","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13273705,"title":"SQL to bring back material names","body":"<p>The below code is a result of a query i have created, it all works fine apart from one thing.  I have Material ID's for material names:</p>\n\n<pre><code>1 = bath\n2 = sink\n3 = toilet\n</code></pre>\n\n<p>The below works but displays sink for every material</p>\n\n<pre><code>Select cu.FName + '  ' + cu.SName as 'Name', \ncu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', \ncu.PostCode, \nco.DateOrdered,\nco.Material1,\nma.MaterialName,\nco.material2, \nma.MaterialName, \nma.Price as 'Item Price' \nfrom Customers cu \nleft join CustomerOrder co on co.CustomerID = cu.CustomerID\nleft join ItemOrder it on it.OrderID = co.OrderID \nleft join Materials ma on ma.MaterialID = co.Material1 \nor co.material2 = ma.MaterialItemID or co.material3 = ma.MaterialItemID\n</code></pre>\n\n<p>it displays as follows (just the materials are listed to stop confusion)</p>\n\n<pre><code>Material1 | MaterialName | Material2 | Material2Name | Material3 | Material3Name\n    1          Sink            2           Sink           3             Sink\n</code></pre>\n\n<p>Can anybody help with this?</p>\n"},{"tags":["sql","drupal","iis","production-environment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13270161,"title":"Is it safe/wise to run Drupal alongside bespoke business web apps in production?","body":"<p>I'm interested to know the general community feeling about the safety of running Drupal alongside bespoke, business critial ASP.NET MVC apps on a production server.</p>\n\n<p>Previously my employer's Drupal based 'visitor website' was hosted as a managed service with a 3rd party. While the LoB sites were hosted in-house. That 3rd party is no longer available so I'm considering my options:</p>\n\n<ol>\n<li>Bring Drupal in-house</li>\n<li>Find another 3rd party</li>\n</ol>\n\n<p>My concern is that I have little experience with Drupal administration (and no experience securing it) and that the addition of PHP to my IIS server poses a security risk.</p>\n\n<p>Is there a best practice that I can follow in this situation?</p>\n"},{"tags":["c#","sql","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13095357,"title":"VS 2010 SQL Update for SQL Statement","body":"<p>Please bear with me as I'm just beginning to learn this stuff. </p>\n\n<p>I have a VS 2010 Web project up and I'm trying to understand how I can make a custom <code>UpdateCommand</code> (Because I chose to write my own SQL statement, I do not have the option for VS 2010 to auto generate an update command for me.) Problem is: I don't know what the <code>UpdateCommand</code> should look like. Here is my Select:</p>\n\n<pre><code>SELECT * FROM Dbo.MainAsset, dbo.Model, dbo.Hardware WHERE MainAsset.device = Hardware.DeviceID AND MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>Which, VS 2010 turns into:</p>\n\n<pre><code>SELECT MainAsset.pk, MainAsset.img, MainAsset.device, MainAsset.model, MainAsset.os, MainAsset.asset, MainAsset.serial, MainAsset.inyear, MainAsset.expyear, MainAsset.site, MainAsset.room, MainAsset.teacher, MainAsset.FirstName, MainAsset.LastName, MainAsset.Notes, MainAsset.Dept, MainAsset.AccountingCode, Model.Model AS Hardware, Model.pk AS Model, Model.DeviceID, Hardware.Computer, Hardware.pk AS Expr3, Hardware.DeviceID AS Expr4 FROM MainAsset INNER JOIN Hardware ON MainAsset.device = Hardware.DeviceID INNER JOIN Model ON MainAsset.model = Model.DeviceID\n</code></pre>\n\n<p>How would I approach updating one column, say \"MainAsset.site\" if that's changed in the Gridview DDL? Any help constructive help would be appreciated. Thank you.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13273343,"title":"REPLACE new line character in MYSql not working","body":"<p>I executed following query and for some reason its not replacing new line character in database . It says Rows matched 1 but no change . What can be wrong ?</p>\n\n<pre><code>mysql&gt; UPDATE aboutme SET abouttext=REPLACE(abouttext,'\\\\n','') WHERE userid='5099a95cd944b8.22468149';\nQuery OK, 0 rows affected (0.00 sec)\nRows matched: 1  Changed: 0  Warnings: 0\n</code></pre>\n"},{"tags":["php","html","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":39,"score":1,"question_id":13273302,"title":"SQL PHP form error on line 23","body":"<p>I have been trying to write code to insert into different tables but it keeps giving me error on line 23.</p>\n\n<p>This is for a college project registration form.</p>\n\n<pre><code>&lt;?php\n\n$con = mysql_connect(\",\"\",\"\");\nif (!$con)\n{\ndie('Could not connect: ' . mysql_error());\n}\n\nmysql_select_db(\"HNDGeorgeMason\", $con);\n\n$firstname=$_POST['firstname'];\n$surname=$_POST['surname'];\n$username=$_POST['username'];\n$password=$_POST['password'];\n$address=$_POST['address'];\n$postcode=$_POST['postcode'];\n$userid=$_POST['userid'];\n$type=$_POST['type'];\n\nswitch ($_POST['type'])\n{\ncase guides\n $sql=\"INSERT INTO Guides (firstname, surname, type, username, password)\n VALUES ('$firstname', '$surname', '$type', '$username', '$password')\";\n\ncase parents\n $sql=\"INSERT INTO Parents (firstname, surn ame, type, username, password)\nVALUES ('$firstname', '$surname', '$type', '$username', '$password')\"; \n\ncase leaders\n $sql=\"INSERT INTO Leaders (firstname, surname, type, username, password)\n VALUES ('$firstname', '$surname', '$type', '$username', '$password')\"; \n}\n\n mysql_close($con);\n?&gt;\n</code></pre>\n"},{"tags":["mysql","sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13273045,"title":"Converting mySQL select to SQL select","body":"<p>I have this mySQL select statement that works just as I need it to;</p>\n\n<pre><code>SELECT `requires`, `level` FROM `fp` WHERE `model` = '\".$model.\"' GROUP BY `level` ORDER BY `menu_order`\n</code></pre>\n\n<p>In the table both <em>requires</em> and <em>level</em> are char fields. When sorted by *menu_order* the first row of each value of <em>level</em> will always be the value of <em>requires</em> that I want to retrieve.</p>\n\n<p>For the SQL version I use;</p>\n\n<pre><code>SELECT requires, level FROM fp WHERE model = '\" &amp; model &amp; \"' GROUP BY level ORDER BY menu_order\n</code></pre>\n\n<p>Now when I try to run this same query on SQL I get;</p>\n\n<p>requires'_is_invalid_in_the_select_list_because_it_is_not_contained_in_either_an_aggregate_function_or_the_GROUP_BY_clause</p>\n\n<p>I found many examples of this error but all seem to be way more complicated than what I'm trying to do. Maybe I've been using mySQL for so long that my brain is stuck in that way of thinking.</p>\n\n<p>How should that select statement be written in SQL?</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13272148,"title":"DISTINCT ON multiple columns, Order matters?","body":"<p>How is it possible that the order of columns matter in a distinct. I get a different number of rows for</p>\n\n<p><code>\n SELECT DISTINCT ON (the_geom,plz) the_geom\n</code></p>\n\n<p>and </p>\n\n<pre><code>SELECT DISTINCT ON (plz,the_geom) the_geom\n</code></pre>\n\n<p>Any ideas where I am thinking wrong? I am using postgreSQL 9.1.5.</p>\n"},{"tags":["sql","oracle","plsql","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13261037,"title":"Insert into table when data missing","body":"<p>I have the following table, for readability I broke down the after every manager for every case number. </p>\n\n<p>The last column is the cumulative sum of the second last column. </p>\n\n<p>Value for month should ideally run from 1-3 (Like you see for both the cases for Chicago). </p>\n\n<p>But from the table you can see in some cases some entries are missing (marked by &lt;-----). </p>\n\n<pre><code>CITY     CASE   CASE_NUMBER   MANAGER  MONTH  MONTHLY_TOTAL   FISCAL_TOTAL \n---------------------------------------------------------------------------\nchicago  case_1   1             John       1         2              2     \nchicago  case_1   1             John       2         3              5  \nchicago  case_1   1             John       3         5              10\n\nchicago  case_1   1             Jeff       1         4              4     \nchicago  case_1   1             Jeff       2         2              6  \nchicago  case_1   1             Jeff       3         3              9\n\nchicago  case_2   2             John       1         3              3     \nchicago  case_2   2             John       2         2              5  \nchicago  case_2   2             John       3         4              9\n\nchicago  case_2   2             Jeff       1         2              2     \nchicago  case_2   2             Jeff       2         7              9 &lt;----\n\nnewyork  case_1   1             Lee        1         3              3     \nnewyork  case_1   1             Lee        2         4              7 &lt;----\n\nnewyork  case_1   1             Sue        1         2              2     \nnewyork  case_1   1             Sue        2         3              5     \nnewyork  case_1   1             Sue        3         2              7 \n\nnewyork  case_1   2             Lee        1         2              2     \nnewyork  case_1   2             Lee        2         4              6  \nnewyork  case_1   2             Lee        3         4              10  \n\nnewyork  case_1   2             Sue        1         3              3     \nnewyork  case_1   2             Sue        2         2              5 &lt;----\n</code></pre>\n\n<p>What I want is to first find out those missing rows and insert values. </p>\n\n<p>For those missing ones monthly_total = 0</p>\n\n<p>fiscal_total = value in previous row. </p>\n\n<p>E.g. for first missing row it should be:    </p>\n\n<pre><code>CITY     CASE   CASE_NUMBER   MANAGER  MONTH  MONTHLY_TOTAL   FISCAL_TOTAL \n---------------------------------------------------------------------------\nchicago  case_2   2             Jeff       3         0              9\n</code></pre>\n"},{"tags":["sql","database","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13272764,"title":"Retrieve values In the same order of values given in IN caluse","body":"<p>I have a query like (MS ACCESS). \nThe <code>number values in the IN caluse is a variant</code>.In the given example I given only 4.somethimes its more than 30 numbers.</p>\n\n<pre><code>SELECT        ID\nFROM          TableName\nWHERE        (ID IN (16, 18, 15, 20 ))\n\nResult : 15 ,16,18,20 \n</code></pre>\n\n<p>Is there any way to  retrieve values In the <code>same order</code> of values given in <code>IN</code> caluse.<br>\nResult should like  this  <code>Result : 16,18,15,20</code></p>\n"},{"tags":["sql","database","oracle","sql-developer","database-administration"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13272225,"title":"Oracle SQL Developer copy database step by step","body":"<p>I'm having big trouble in copying an Oracle DB to the same server but with another name, to use as a development DB.</p>\n\n<p>I'm used to SQL Server, I'm new to Oracle (11g).</p>\n\n<p>I wanted to use the 'Database copy' from SQL Developer, but I'm getting errors all the way. First it was about missing tablespaces.\nThen when I manually created them in my new empty DB the errors were about missing users.\nI wanted to create the users manually, but then I first needed to create missing roles.\nWhen all that was done, it failed on missing indexes...</p>\n\n<p><strong>How do I copy everything I need with 'Database copy'?</strong></p>\n\n<p>Any advice is greatly appreciated!</p>\n"},{"tags":["sql","model","yii","relations"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13156854,"title":"retrieving a sum of two columns from two related models in yii","body":"<p>I'm fairly new working with yii but have plenty of experience with php and sql.\nI'm hoping that someone more experienced with yii can point me in the right direction. I have two models, Project and Costs, which are related to each other in a many to many relationship through a project_cost table. The reason for this is that costs can be shared between projects. In the project_cost table there is an additional column containing how much of the cost is assigned to the specific project.</p>\n\n<p>So the Project model relations looks like this which is working perfectly fine for getting all the details:</p>\n\n<pre><code>class Project extends CActiveRecord\n{\n\n    /**\n    * @return array relational rules.\n    */\n    public function relations()\n    {\n    return array(\n        'projectcost'   =&gt; array(self::HAS_MANY,   'ProjectCost',    'project_id'),\n        'cost'      =&gt; array(self::HAS_MANY, 'Cost', array('cost_id'=&gt;'id'),'through'=&gt;'projectcost'),\n        //i.e. a many to many relation of cost through the projectcost model\n\n        );\n    }\n    ...\n}\n</code></pre>\n\n<p>In the cost model there is a column named Value and  in the project_cost table there is column name Percent. It is easy to construct a funtion that contains a sql query that gives me the sum for the project cost like this:</p>\n\n<pre><code>select sum(project_cost.Percent*cost.Value) \nfrom project_cost join cost on project_cost.cost_id=cost.id \nwhere project_cost.project_id=1     \n</code></pre>\n\n<p>but is there a way to do the same via relations in yii? I know about STAT relations but am unclear on how they can be applied in this case as most of what I have read so far indicates that relations work best if there are only two models in the relationship.</p>\n\n<p>Any and all help would be greatly appreciated.</p>\n"},{"tags":["android","sql","database","sqlite","upgrade"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13266667,"title":"How to modify type in a table of SQLite in Android, using onUpgrade method?","body":"<p>Following this good example <a href=\"http://code.google.com/p/openintents/source/browse/trunk/notepad/NotePad/src/org/openintents/notepad/NotePadProvider.java?r=3878\" rel=\"nofollow\">http://code.google.com/p/openintents/source/browse/trunk/notepad/NotePad/src/org/openintents/notepad/NotePadProvider.java?r=3878</a></p>\n\n<p>I implement my sqlite database upgrade system. But in the link above the only example show how add new column in a table. The piece of code in the onUpgrade method is</p>\n\n<pre><code> try {\n      db.execSQL(\"ALTER TABLE \" +   NOTES_TABLE_NAME + \" ADD COLUMN \"\n                                                                    + Notes.TAGS + \" TEXT;\");\n      db.execSQL(\"ALTER TABLE \" + NOTES_TABLE_NAME + \" ADD COLUMN \"\n                                                                    + Notes.ENCRYPTED + \" INTEGER;\");\n      db.execSQL(\"ALTER TABLE \" + NOTES_TABLE_NAME + \" ADD COLUMN \"\n                                                                    + Notes.THEME + \" TEXT;\");\n      } catch (SQLException e) {\n      Log.e(TAG, \"Error executing SQL: \", e);\n      // If the error is \"duplicate column name\" then everything is fine,\n      // as this happens after upgrading 2-&gt;3, then downgrading 3-&gt;2, \n      // and then upgrading again 2-&gt;3.\n      }\n      //  *** other upgrade from version x-&gt;y\n      // ***\n</code></pre>\n\n<p>and in onCreate, something like this:</p>\n\n<pre><code>  public void onCreate(SQLiteDatabase db) {\n      db.execSQL(\"CREATE TABLE \" + NOTES_TABLE_NAME + \" (\"\n           // Version 2:\n           + Notes._ID + \" INTEGER PRIMARY KEY,\"\n           + Notes.TITLE + \" TEXT,\"\n           + Notes.NOTE + \" TEXT,\"\n           + Notes.CREATED_DATE + \" INTEGER,\"\n           + Notes.MODIFIED_DATE + \" INTEGER,\"\n           // Version 3:\n           + Notes.TAGS + \" TEXT,\"\n           + Notes.ENCRYPTED + \" INTEGER,\"\n           + Notes.THEME + \" TEXT,\"\n           // Version 4:\n           + Notes.SELECTION_START + \" INTEGER,\"\n           + Notes.SELECTION_END + \" INTEGER,\"\n           + Notes.SCROLL_POSITION + \" REAL\"\n           + \");\");\n          }\n</code></pre>\n\n<p>Now I want a new database version where no column is added, but I want just change type of some field in a table. How can I do this?</p>\n\n<p>Here <a href=\"http://sqlite.org/lang_altertable.html\" rel=\"nofollow\">http://sqlite.org/lang_altertable.html</a> is said that is not possible to change a field type. How can I circumvent the problem?</p>\n\n<p>I'm inserting data in database in this way:</p>\n\n<pre><code>   ContentValues v = new ContentValues();\n   v.put(\"field1\", myString); // fileld1 in db is defined as integer\n\n   dbManager.updateTable(\"mytable\", v, whereClause);\n</code></pre>\n\n<p>How can I make a CAST in this situation?</p>\n"},{"tags":["asp.net","sql","ado.net-entity-data-model"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12707938,"title":"Selecting Data from Different Databases","body":"<p>I have two DB's and an application that gets/sets data using an Entity Data Model in VS 2010.</p>\n\n<p>I do my full stored procedure in DB(A) and then use the EXEC statement in DB(B) to return the data. The data returns fine and is correct, but whenever I run the program I get the following Exception in C#:</p>\n\n<p>The 'AbandonTime' property on 'GetAverageTimes_Result' could not be set to a 'String' value. You must set this property to a non-null value of type 'Decimal'. </p>\n\n<p>I have checked everwhere in the Data Model, the values are Decimal and set as nullable etc etc. Even if I change this to any other type or non-nullable value, I still get the same error. It is incredibly frustrating.</p>\n\n<p>Any help will be appreciated.</p>\n"},{"tags":["php","sql","pdo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":13272591,"title":"Can't fetch results of an SQL statement in PHP","body":"<p>i'm working on a search function in <strong>PHP</strong>, so i do want to be able to research any keyword in all database tables, but i can't fetch the result of the SQL statement which will do :</p>\n\n<pre><code>SELECT * FROM All_Tables\n</code></pre>\n\n<p>here's my code :</p>\n\n<pre><code>$getTables = $this-&gt;db-&gt;query(\"show tables\");\n$tmpString = '';\n\nwhile ($table_data = $getTables-&gt;fetch(PDO::FETCH_NUM))\n{\n    $tmpString.=$table_data[0].',';\n}\n\n$ALL_DATABASE_TABLES = substr($tmpString,0,strlen($tmpString)-1); //Remove the last ,\n\necho \" $ALL_DATABASE_TABLES \"; //  Works, it shows all database tables\n\n$query = \"SELECT * FROM $ALL_DATABASE_TABLES\" ; \n\n$stmt = $this-&gt;db-&gt;query($query) or die(print_r($this-&gt;db-&gt;errorInfo())) ;\n\necho \"Cool1\"; // Works\necho \"$ALL_DATABASE_TABLES \"; //Works\n\n// This Loop doesn't work-----------------------\nwhile ($row = $stmt-&gt;fetch(PDO::FETCH_NUM)) \n{\n    echo \"Cool2\"; // Doesn't work\n\n    echo \"$row[0]\" ; // Doesn't work\n}\n//----------------------------------------------\n\n$stmt-&gt;closeCursor();\n</code></pre>\n\n<p>Do you have any idea about that ? Thank you guys</p>\n"},{"tags":["mysql","sql","select"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13271843,"title":"MySQL Count matching records from multiple tables","body":"<p>Considering the following 4 tables</p>\n\n<pre><code>entity  table1        table2        table3       \n------  ------------- ------------- -------------\nid      ei(entity.id) ei(entity.id) ei(entity.id)\nname    something     somethingelse yetanother\n</code></pre>\n\n<p><strong>How can I figure out entity usage in all three tables</strong>, represented like<br></p>\n\n<pre><code>---------------------\n| id | t1 | t2 | t3 |\n---------------------\n|  1 | 14 | 23 |  0 |\n|  2 | 66 |  9 |  5 |\n...\n</code></pre>\n\n<p>My Original approach was to select from entity then left join other tables but MySQL doesn't seem to like it</p>\n\n<pre><code>SELECT e.id,count(t1.id) FROM entity AS e LEFT JOIN table1 AS t1 on e.id=t1.ei;\n</code></pre>\n\n<p>Edit: Here is the output for 1 table </p>\n\n<pre>mysql> explain select e.id,count(o.id) from entity e left join table1 t1 on e.id=o.ei where e.ty=3;\n+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+\n| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows  | Extra       |\n+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+\n|  1 | SIMPLE      | e     | ALL  | NULL          | NULL | NULL    | NULL |  1083 | Using where |\n|  1 | SIMPLE      | o     | ALL  | NULL          | NULL | NULL    | NULL | 90201 |             |\n+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+\n2 rows in set (0.04 sec)</pre>\n\n<p>The opposite works much better, but doesn't scale to multiple tables</p>\n\n<pre><code>SELECT e.id,count(t1,id) FROM table1 AS t1 LEFT JOIN entity AS e ON t1.ei=e.id\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","postgresql","database-design","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":13272776,"title":"What to use instead of Polymorphic Associations?","body":"<p>So for a number of reasons Polymorphic Associations are considered bad database design, e.g. you can't have foreign keys on the polymorphic id columns so referential integrity is gone.</p>\n\n<p>And, STI is also considered bad <em>unless</em> the sub-types only differ on behavior.</p>\n\n<p>So my question is <b>for Rails / ActiveRecord</b> what is the lesser evil in the following scenario:</p>\n\n<p>I need to allow my users to create a hand-ordered collection of multiple types of entities.</p>\n\n<p>Using Polymorphic Associations the schema would look something like this:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, exhibitable_type, exhibitable_id, position\n\n-- photographs\nid, ...\n\n-- films\nid, ...\n\n-- paintings\nid, ...\n\n-- songs\nid, ...\n\n-- sculptures\nid, ...\n</code></pre>\n\n<p>I could use STI and have something like this:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, artwork_id, position\n\n-- artworks\nid, type, &lt;photograph columns&gt;, &lt;film columns&gt;, &lt;painting columns&gt;, etc.\n</code></pre>\n\n<p>But, because my artworks differ on data (and not just behavior), I now have NULLs all over the artworks table. I've also introduced an inheritance hierarchy to my objects which previously wasn't there and I am generally wary of, particularly when its only purpose is to serve the database design.</p>\n\n<p>STI does seem like it would at least be simpler to query and code for.</p>\n\n<p>So which is the lesser evil?</p>\n\n<p>Then, the other option is multi-table inheritance:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, artwork_id, position\n\n-- artworks\nid\n\n-- photographs\nartwork_id, &lt;photograph columns&gt;\n\n-- films\nartwork_id, &lt;film columns&gt;\n</code></pre>\n\n<p>This would get rid of STI's NULL problem and also keep the table sizes down. We still have object hierarchy that I don't think is strictly necessary. But the biggest problem in my eyes: Rails doesn't support it. The <a href=\"https://github.com/peterhamilton/citier/\" rel=\"nofollow\">CITIER</a> gem looks very nice and it has recent commits but it is not that widely used so I am cautious of using it in my app's foundation. I guess I could also look at using Sequel or another ORM that has CTI support.</p>\n\n<p>Truth be told I think I like the multi-table inheritance solution the best</p>\n\n<p>If I didn't need the position column I would simply use separate join tables like <code>collections_photographs</code>, <code>collections_paintings</code>, <code>collections_films</code>, etc. but I do need that manual ordering.</p>\n\n<p>So, it seems the options are:</p>\n\n<ul>\n<li>PA: loss of referential integrity (does it matter in practice if always using ActiveRecord for database access?)</li>\n<li>STI: big table with lots of nulls</li>\n<li>CTI/MTI: relying on a gem that isn't widely used</li>\n</ul>\n\n<p>Which is the lesser evil and are there any other options? I am using Postgres.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":54,"score":1,"question_id":13270945,"title":"MySql multiple queries or temporary table?","body":"<p>I need help from a SQL guru here...</p>\n\n<p>I have data in the following format:</p>\n\n<pre><code>Key  Value\n100  A\n100  B\n300  A\n400  B\n500  A\n500  B\n500  C\n600  B\n600  W\n</code></pre>\n\n<p>If I want to find all keys with A or B and A and B, but not AB with anything else...how would I do this?  Would I need a temp table or can I somehow join the table to itself?</p>\n\n<p>EDIT:  The desired output would be Key 100 since it has A &amp; B, Key 300 since it has A, Key 400 since it has B.  Not Key 500 because it also contains a C, and not key 600 because it also contains a W</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13210454,"title":"sql cte if statement","body":"<p>This might be a bad idea but just wondering?</p>\n\n<pre><code>;with Products\nAS\n(\n/* can you have an if statement in here? */\nselect * from products\n\n/* or */\n\nselect * from products \nwhere condition\n\n)\n</code></pre>\n\n<p>what i'm thinking is what if sometimes you have a search string or not. How do you make that a consideration in cte?</p>\n\n<p>Or maybe it would be a better idea to have 2 cte in one procedure?</p>\n"},{"tags":["asp.net","sql","vb.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13271951,"title":"If/Else Statements in VB.NET (SQL) Query?","body":"<p>I just wanted to know what's the best way to add <code>If/Else</code> statements in a SQL query within VB.Net code?</p>\n\n<p>This is my current query (doesn't work):</p>\n\n<pre><code>SELECT \n   FIRSTNAME, LASTNAME \nFROM \n   TBL_USERS \nORDER BY \n   If(SortSelect() Is \"\"lastname\"\", LASTNAME, FIRSTNAME) \n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13272407,"title":"Using a column in USING and WHERE clause","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/456684/mixing-using-and-on-in-oracle-ansi-join\">Mixing “USING” and “ON” in Oracle ANSI join</a>  </p>\n</blockquote>\n\n\n\n\n\n<p>I like the way <code>USING</code> coalesces the columns, so I tried the following on Oracle's example database:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT *\nFROM employees workers\nJOIN jobs USING (JOB_ID)\nJOIN departments USING (DEPARTMENT_ID)\nLEFT JOIN employees managers ON workers.manager_id = managers.employee_id\nWHERE workers.job_id LIKE '%CLERK'\nORDER BY workers.employee_id;\n</code></pre>\n\n<p>With MySQL this runs fine, but Oracle says \"ORA-25154: column part of USING clause cannot have qualifier\". Is there a way to keep using <code>USING</code> or what is the optimal solution?</p>\n\n<p>Regards</p>\n\n<p>TC</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":32,"score":1,"question_id":13272045,"title":"mysql nested select statement","body":"<p>I am newbie for relational tables. As i learn more, i see many advantages of sql statement. However i stuck on some point. </p>\n\n<p>i look for if can get a single table for desired data-set from 5 tables. One of the table named 'eta' is used to connect other 4 tables.</p>\n\n<p>Aim:\nA phone number or email can be used by many users, and users may also have multiple phone number or email address. I want to list the phone numbers or email addresses with the user name that uses them.  </p>\n\n<p>Sample Data:\nPlease  check <a href=\"http://sqlfiddle.com/#!2/60acce\" rel=\"nofollow\">http://sqlfiddle.com/#!2/60acce</a>  for the table structure and sample data-set</p>\n\n<p>The final expected final result for the phone case as follow:</p>\n\n<pre><code>  phone            name    extra\n  45336467      ABC Co.   \n  45336467      Gery      114\n  45336467      Todd      117\n  45336467      Adam      119\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Edit: Explanation for the table relation.</p>\n\n<p>table 'eta' has 4 fields which have table relations. column 'own' shows the company, person etc  value 'f' for company and 'k' for person others will used for different tables </p>\n\n<p>v1_id for id of own field's referred table..</p>\n\n<p>column 'res' refers to email and phone tables. value 't' for phone and 'e' for email.\nv2_id for id of res field's referred table</p>\n"},{"tags":["mysql","sql","database","query","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":17,"score":3,"question_id":13272230,"title":"mysql - sum columns from multiple tables based on multiple id's","body":"<p>I have a mySQL database with a couple of identical tables. I need to join all the tables and sum up the views and hits every time the <code>id1</code> and <code>id2</code> are equal in at least 2 tables, or simply show the row if not. </p>\n\n<p>Please see below the tables structure:</p>\n\n<pre><code>Table1:\nid..id2...views...hits\n1...102...55......12\n2...103...12......22\n\nTable2:\nid..id2...views...hits\n1...123...512......13\n2...103...123......43\n\nTable3:\nid..id2...views...hits\n1...102...232......43\n2...103...100......70\n</code></pre>\n\n<p>The end result should be the following table:<br></p>\n\n<pre><code>id...id2...views...hits\n1....102...287....65   &lt;-- This one is the result of adding 1st row of table1 and 2nd row of table 2\n1....123...512....13   &lt;-- This is the 1st row of table2 as there's no other id2 = 123\n2....103...235....135 &lt;-- This is the sum of 2nd row in table1 + 2nd row in table2 + 2nd row in table3\n</code></pre>\n\n<p>I hope this makes sense and someone can help with it.</p>\n\n<p>Thanks !</p>\n"},{"tags":["sql","db2","timestamp","last-modified"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12801289,"title":"Db2 change a column to row update timestamp","body":"<p>In my table I've a column MODIFIED with type TIMESTAMP.\nI want to update this column automatically when the row is updated</p>\n\n<p>I can use this for a new column </p>\n\n<pre><code>alter table my_table add column last_updated timestamp not null\n generated by default for each row on update as row change timestamp \n</code></pre>\n\n<p>But I can't use this to edit the existing column to do the updating automatically</p>\n\n<pre><code>alter table my_table alter column modified set data type timestamp \n not null generated by default for each row on update as row change timestamp\n</code></pre>\n\n<p>Am I using the alter correctly? </p>\n\n<p>the error message is </p>\n\n<pre><code>Error: DB2 SQL Error: SQLCODE=-104, SQLSTATE=42601, SQLERRMC=alter table my_table alter column modified;BEGIN-OF-STATEMENT;&lt;values&gt;, DRIVER=3.50.152\nSQLState:  42601\nErrorCode: -104\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13272029,"title":"Efficient Way to Select if a database row value match a group of string","body":"<p>Efficient Way to Select if a database row value match a group of string</p>\n\n<pre><code>  SELECT id FROM tablename where \n    LeadStatus like \"%Contact Attempt 1%\" or \n    LeadStatus like \"%Contact Attempt 2%\" or \n    LeadStatus like \"%Contact Attempt 3%\" or \n    LeadStatus like \"%Contact Attempt 4%\" or \n    LeadStatus like \"%Contact Attempt 5%\" or \n    LeadStatus like \"%Contact Attempt 6%\" or \n    LeadStatus like \"%Contact Attempt 7%\" or \n    LeadStatus like \"%Call Back/Follow-up%\" or \n    LeadStatus like \"%Working%\" or \n    LeadStatus like \"%Credit Pulled%\" or \n    LeadStatus like \"%Selected other Lender%\" or \n    LeadStatus like \"%Pre-Approved%\" or \n    LeadStatus like \"%Application Taken/Sent%\" or \n    LeadStatus like \"%Application Received%\" or \n    LeadStatus like \"%Submitted%\" or \n    LeadStatus like \"%Funded%\" or \n    LeadStatus like \"%Future Opportunity%\" or \n    LeadStatus like \"%Manager Review%\"\n</code></pre>\n\n<p>I think it clear enough that what I want?</p>\n\n<p><strong>Note :</strong> I can't change the <code>LeadStatus</code> value as it is fetched from a API not in my control </p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13271874,"title":"How to write SQL statement in this case?","body":"<p>For some reason, I'd like to change the database. </p>\n\n<p>It's not possible to change these values manually one by one as there are so much records. </p>\n\n<p>Please advise how to write this SQL, thanks.</p>\n\n<p>From:</p>\n\n<pre><code> id  percentage    type\n  1     6        services\n  1     10       testing\n  3     8        services\n  3     20       testing\n  6     61       services\n  6     90       testing\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>id percentage    type\n1     10       services\n1     10       testing\n3     20       services\n3     20       testing\n6     90       services\n6     90       testing\n</code></pre>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13271676,"title":"LEFT JOIN - How to join tables and include extra row even if you have right match","body":"<p>I have two tables</p>\n\n<pre><code>Table A\n-------\nID\nProductName\n\nTable B\n-------\nID\nProductID\nSize\n</code></pre>\n\n<p>I want to join these two tables</p>\n\n<pre><code>SELECT * FROM\n   (SELECT * FROM A)\n   LEFT JOIN\n   (SELECT * FROM B)\nON A.ID = B.ProductID\n</code></pre>\n\n<p>This is easy, I will get all rows from A multiplied by rows matched in B, and NULL fields if there is no match.</p>\n\n<p>But here comes the tricky question, how can I get all rows from A with NULL fields for table B, even if there is a match, so I get an extra line with NULL values plus all the matches?</p>\n"},{"tags":["sql","tsql","entity-attribute-value"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13270727,"title":"Recreating historical field changes from an EAV audit table","body":"<p>Given the following tables recs and audit, how would one in SQL transform into the resultant table.</p>\n\n<p>A little background, the former table is a simplified example of an standard SQL table used in a CRUD application collecting data. On any update to a column a record is written to an audit table in EAV form. There is now a requirement to transform the recs table into a historical table with a copy of each row as it was at a point in time for reporting (the data will be stored in a star schema data warehouse ultimately.</p>\n\n<p>It seems like this would be straightforward enough in a procedural language and manageable (if ugly) using cursors, but is there a set based approach that would work?</p>\n\n<p>I'm using T-SQL right now, but I imagine that I could port any examples or ideas from any sufficiently rich SQL dialect.</p>\n\n<h2>Setup</h2>\n\n<pre><code>create table recs\n(\n    ID int identity(1,1) not null primary key,\n    Column1 nvarchar(30) not null,\n    Column2 nvarchar(30) not null,\n    sys_updated_on datetime not null\n)\n\ncreate table audit\n(\n    ID int identity(1,1) not null primary key,\n    recs_id int not null,\n    fieldname nvarchar(30) not null,\n    old_value nvarchar(30) not null,\n    new_value nvarchar(30) not null,\n    sys_updated_on datetime not null\n)\n\ninsert into recs (Column1, Column2, sys_updated_on)\nvalues ('A', 'B', '2012-10-31 22:00')\n    , ('C', 'D', '2012-10-31 22:30')\n\ninsert into audit (recs_id, fieldname, old_value, new_value, sys_updated_on)\nvalues (1, 'Column1', 'Z', 'A', '2012-10-31 22:00')\n    , (2, 'Column2','X', 'D', '2012-10-31 22:30')\n    , (1, 'Column1', 'Y', 'Z', '2012-10-31 21:00')\n</code></pre>\n\n<h2>Resultant Data</h2>\n\n<pre>\nRecs            \n\nID  Column1 Column2 sys_updated_on\n1         A       B 31/10/2012 22:00:00\n2         C       D 31/10/2012 22:30:00\n</pre>\n\n<pre>\nAudit                   \n\nID  recs_id fieldname   old_value   new_value   sys_updated_on\n1         1   Column1           Z           A   31/10/2012 22:00:00\n2         2   Column2           X           D   31/10/2012 22:30:00\n3         1   Column1           Y           Z   31/10/2012 21:00:00\n</pre>\n\n<h2>Desired result</h2>\n\n<pre>           \nrecs_id              sys_updated_on       Column1   Column2\n1                          null             Y             B\n1           31/10/2012 21:00:00             Z             B\n1           31/10/2012 22:00:00             A             B\n2                          null             C             X\n2           31/10/2012 22:30:00             C             D\n\n</pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13271400,"title":"Allowing * in SQL query","body":"<p>I have a stored procedure and I want to allow * in it so that if user:</p>\n\n<ul>\n<li>types t* then taller, tea returns</li>\n<li>types * or <em>.</em> then all results are returned</li>\n<li>types t then all results which have t are returned like ptv, tall, sit</li>\n</ul>\n\n<p>my stored procedure is this:</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[SearchEntityDataNew]\n    @SearchText varchar(100) = '*'\n\nAS\nBEGIN\n    SELECT 'Entity' as pagetype,EntityID,EntityData,EntityDataID \n    FROM EntityData \n    WHERE  EntityData LIKE '%' + @SearchText+ '%'\n    OR @SearchText = '*'\n\n    union all\n\n    SELECT 'Property' as pagetype,PropertyID,PropertyValue,EntityDataID  \n    FROM EntityDataProperty \n    WHERE  PropertyValue LIKE '%' + @SearchText+ '%'\n    OR @SearchText = '*'\nEND\n</code></pre>\n"},{"tags":["sql","sql-server","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13260441,"title":"SQL query group by nearby timestamp","body":"<p>I have a table with a timestamp column. I would like to be able to group by an identifier column (e.g. cusip), sum over another column (e.g. quantity), but only for rows that are within 30 seconds of each other, i.e. <strong>not</strong> in fixed 30 second bucket intervals. Given the data:</p>\n\n<pre>\n       cusip| quantity|    timestamp\n============|=========|=============\nBE0000310194|      100| 16:20:49.000\nBE0000314238|       50| 16:38:38.110\nBE0000314238|       50| 16:46:21.323\nBE0000314238|       50| 16:46:35.323\n</pre>\n\n<p>I would like to write a query that returns:</p>\n\n<pre>\n       cusip| quantity\n============|=========\nBE0000310194|      100\nBE0000314238|       50\nBE0000314238|      100\n</pre>\n\n<p>Edit:\nIn addition, it would greatly simplify things if I could also get the MIN(timestamp) out of the query.</p>\n"},{"tags":["sql","vba","ms-access"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13270849,"title":"Link multiple tables from one database","body":"<p>I have actually this little function working as supposed:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function createAttached(strTable As String, strPath As String, strBaseTable As String) As Boolean\n    On Error GoTo CreateAttachedError\n\n    Dim tdf As TableDef\n    Dim strConnect As String\n    Dim fRetval As Boolean\n    Dim myDB As Database\n\n    DoCmd.SetWarnings False\n\n    Set myDB = CurrentDb\n    Set tdf = myDB.CreateTableDef(strTable)\n\n    With tdf\n        .Connect = \";DATABASE=\" &amp; strPath\n        .SourceTableName = strBaseTable\n    End With\n\n    myDB.TableDefs.Append tdf\n    myDB.TableDefs.Refresh\n\n    fRetval = True\n\n    DoCmd.SetWarnings True\n\nCreateAttachedExit:\n    createAttached = fRetval\n    Exit Function\n\nCreateAttachedError:\n    If Err = 3110 Then\n        Resume CreateAttachedExit\n    Else\n        If Err = 3011 Then\n            Resume Next\n        Else\n            If Err = 3012 Then\n                Set tdf = myDB.TableDefs(strTable)\n                tdf.Connect = \";DATABASE=\" &amp; strPath\n                tdf.RefreshLink\n                fRetval = True\n                GoTo CreateAttachedExit\n            End If\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>This code works fine, I can call the function as many times as I want to add links to tables from another database. However, I have about 30 tables to import from the same database and this script restarts from scratch everytime I call it. Because the database is located on another server, it takes about 1 min to link the 30 tables.</p>\n\n<p>Is there anything I could do with that function to make it work faster when I need to link multiple tables from the same database? I would like it to work with multiple strTable and strBaseTable in parameters instead of one (maybe arrays?), but I don't know how to do this.</p>\n\n<p>Thank you.</p>\n"},{"tags":["sql","db2","ibm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13200776,"title":"Pivoting on a field?","body":"<p>I use IBM DB2 SQL.</p>\n\n<p>Here is my current query:</p>\n\n<pre><code>select \nEXSHPE as \"Shape\",\nEXDLVY as \"Delivery\",\n\n  Sum(Case When EXSURF = 'Print' Then EXRLTO Else 0 End) As Retail_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXRLTO Else 0 End) as Retail_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXRLTO Else 0 End) As Retail_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXRLTO Else 0 End) as Retail_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXRLTO Else 0 End) As Retail_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXRLTO Else 0 End) as Retail_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXWHLO Else 0 End) As Wholesale_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXWHLO Else 0 End) as Wholesale_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXWHLO Else 0 End) As Wholesale_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXWHLO Else 0 End) as Wholesale_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXWHLO Else 0 End) As Wholesale_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXWHLO Else 0 End) as Wholesale_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXUNTO Else 0 End) As Units_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXUNTO Else 0 End) as Units_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXUNTO Else 0 End) As Units_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXUNTO Else 0 End) as Units_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXUNTO Else 0 End) As Units_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXUNTO Else 0 End) as Units_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXAURA Else 0 End) As Actual_AUR_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXAURA Else 0 End) as Actual_AUR_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXAURA Else 0 End) As Actual_AUR_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXAURA Else 0 End) as Actual_AUR_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXAURA Else 0 End) As Actual_AUR_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXAURA Else 0 End) as Actual_AUR_UnknownC,\n\n  Sum(Case When EXSURF = 'Print' Then EXMERA Else 0 End) As Merch_AUR_Print,\n  Sum(Case When EXSURF = 'Pattern' Then EXMERA Else 0 End) as Merch_AUR_Pattern,\n  Sum(Case When EXSURF = 'Solid' Then EXMERA Else 0 End) As Merch_AUR_Solid,\n  Sum(Case When EXSURF = 'UnknownA' Then EXMERA Else 0 End) as Merch_AUR_UnknownA,\n  Sum(Case When EXSURF = 'UnknownB' Then EXMERA Else 0 End) As Merch_AUR_UnknownB,\n  Sum(Case When EXSURF = 'UnknownC' Then EXMERA Else 0 End) as Merch_AUR_UnknownC\n\nfrom EXOWMSPD\nWhere (EXCO || '/' || EXDIV)  = ?\nGroup By\n  EXSHPE,\n  EXDLVY\nOrder By\n  EXSHPE DESC,\n  EXDLVY DESC\n</code></pre>\n\n<p>Database looks like this:\n<img src=\"http://i.stack.imgur.com/ahMt0.png\" alt=\"enter image description here\"></p>\n\n<p>I need to pivot of Surface, but dynamically.\nThe issue is, I only know the first 3 surface descriptions. But I need to be ready for up to 6.</p>\n\n<p>Is there a way I could pivot this dynamically to grab the first 6 surfaces. </p>\n\n<p>Example, </p>\n\n<pre><code>RETAIL_DOLLARS_1   10.00\nRETAIL_DOLLARS_2   20.00\nRETAIL_DOLLARS_3   50.00\nRETAIL_DOLLARS_4   0.00\nRETAIL_DOLLARS_5   0.00\nRETAIL_DOLLARS_6   0.00\n</code></pre>\n\n<p>In this example, data was found for 3 surfaces, the other 3 I want filled with 0s.</p>\n\n<p>I'm using this to make a report and I'll hide columns which will have SURFACE_DESCRIPTION_X equal to \"\".</p>\n\n<p>Is there a way to do this?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","postgresql","query-optimization"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13270848,"title":"Optimizing PostgreSQL query with multiple joins, order by and small limit","body":"<p>I need some tips for optimizing queries fetching from large tables.</p>\n\n<p>In this example I have 5 tables:</p>\n\n<pre><code>Brands\n- id_brand\n- b_name\n\nProducts\n- id_product\n- p_name\n- ean\n...\n- fk_brand\n\nProd_attributes\n- id_prod_att\n- size_basic\n...\n- fk_product\n\nStores\n- id_store\n- s_name\n...\n\nStocks\n- id_stock\n- stock_amount\n- fk_prod_att\n- fk_store\n</code></pre>\n\n<p>I need a query with ordered list of stocks, limited, so this is the general approach I used:</p>\n\n<pre><code>SELECT stores.s_name, stocks.stock_amount, prod_attributes.size_basic, \nproducts.p_name, products.ean, brands.b_name \n\nFROM (stocks \n    INNER JOIN stores \n    ON stocks.fk_store = stores.id_store) \n    INNER JOIN (prod_attributes \n        INNER JOIN (products \n            INNER JOIN brands \n            ON products.fk_brand = brands.id_brand) \n        ON prod_attributes.fk_product = products.id_product) \n    ON stocks.fk_prod_att = prod_attributes.id_prod_att \n\nORDER BY s_name, p_name, size_basic \n\nLIMIT 25 OFFSET 0\n</code></pre>\n\n<p>This works fast on small tables, but when the tables grow the query gets very expensive. With 3,5M rows in Stocks, 300K in Prod_attributes, 25K Products it executes in over 8800ms, which is not acceptable for me.</p>\n\n<p>All forgein keys have indexes and DB has been vacuum-analyzed recently.</p>\n\n<p>I know that the issue lies in the ORDER BY part, because of it the query does not use indexes and does sequential scans. If I remove the ordering then the query is very fast.</p>\n\n<p>For solving this I know the I can remove ORDER BY, but it's not feasible option for me. De-normalization of the DB or materialized view could help here also - again I would like to avoid this if possible.</p>\n\n<p>What else I can do to speed this query up?</p>\n\n<p>EXPLAIN ANALYZE:<br>\n- slow with order by: <a href=\"http://explain.depesz.com/s/AHO\" rel=\"nofollow\">http://explain.depesz.com/s/AHO</a><br>\n- fast without order by: <a href=\"http://explain.depesz.com/s/NRxr\" rel=\"nofollow\">http://explain.depesz.com/s/NRxr</a></p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":34,"score":-3,"question_id":13271591,"title":"tsql : Delete query","body":"<pre><code>DELETE abc \nFROM abc INNER JOIN xyz ON \nabc.RECORD_TYPE = xyz.RECORD_TYPE AND \nabc.IN = xyz.IN \nOPTION (MERGE JOIN, LOOP JOIN)\n</code></pre>\n\n<p>can anyone tell me what exactly the query doing ? </p>\n"},{"tags":["sql","powershell"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13270668,"title":"How to check if a composite primary key values exist in sql table using powershell?","body":"<p>I have 2 primary keys in an sql table, say for eg: ApID and AnID. I want to update the sql table (dbo.ApAn) if the particular composite primary key values exist or else insert new values into the table <strong>through powershell</strong></p>\n\n<p><strong>How can I get the sql table's composite primary keys in powershell?</strong> using a join or something?</p>\n\n<p>Something like:</p>\n\n<pre><code>IF (ApId_AnID-eq 0) { \n#SQL INSERT CODE\n} else { \n#SQL UPDATE CODE\n}\n</code></pre>\n"},{"tags":["sql","database-design","foreign-keys","relational-database","normalization"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13257336,"title":"How best to normalize and reference (FK) locations (Neighborhood/City/Region/Country/Continent)","body":"<p>So I have searched around but haven't found a satisfactory answer.</p>\n\n<p>I have different types of locations, as stated in the title. Given a type of location (i.e. city), the less granular locations can be inferred. I.e. if you know you're in Oregon, it implies you're in the United States, which implies you're in North America.</p>\n\n<p>We have Objects that reference locations, but the granularity is not all the same. Some items might point to neighborhoods, others are only known down to the city level, while some are only known to a region, etc. </p>\n\n<p>There were two ways in which I thought of organizing the data, this is the way I am leaning towards:</p>\n\n<ul>\n<li>Have a generic \"Locations\" table, with a location \"type\" and a \"parent location\" referencing itself. So there'd be an entry for United States of type country, and an entry for Oregon type state which references United States. \ni.e.</li>\n</ul>\n\n<p><img src=\"http://i.stack.imgur.com/KXDz6.png\" alt=\"enter image description here\"></p>\n\n<p>You can then have the object reference the location off its primary key, and then other locations can be inferred. Does this make sense or is there a better way I could be organizing the data?</p>\n\n<ul>\n<li>The other way I considered was with a different table for each location \"type\" but then the problem is having our objects referencing it, since the most granular type of location for an object isn't always the same.</li>\n</ul>\n\n<p>If I were to slip other location types in later, for example counties in between Cities and Regions, might this present a problem? I'm thinking it would be no more a problem than with separate tables, but perhaps there's a better way I can keep track of things in a logical way.</p>\n"},{"tags":["android","sql","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13270649,"title":"Get all dates with optional further data, if a condition is met (Android - SQLite)","body":"<h1>What I have</h1>\n\n<p>I'm working on an Android app with a menu of school canteens. I download data from a remote website and save them to the internal SQLite database to such table (SO Markdown doesn't support tables, hence I'll make it a list):</p>\n\n<ul>\n<li>ID</li>\n<li>TEXT - The name of the meal</li>\n<li>NUMBER - The number of the meal (we can choose from more)</li>\n<li>ORDERED - Boolean, whether the particular meal is ordered or not</li>\n<li>DATE - The date (timestamp) when the meal is server</li>\n</ul>\n\n<p>(and a few more unimportant columns)</p>\n\n<h1>What I need</h1>\n\n<p>I want to provide the user with a list, where for every day when the canteen cooks there is either the meal he has ordered or information, that he hasn't ordered anything for that day.</p>\n\n<p>The question is, how should look my query when I need to get:</p>\n\n<ul>\n<li>Every date that is in the table (once).</li>\n<li>For each date either the info about the ordered meal, or (if there isn't any ordered meal) something from which I can tell that the user will be hungry that day.</li>\n</ul>\n\n<p>Because I want my users to be able to see also the meals they didn't order (so that their friends can look, what they might have), I refuse to keep only the ordered meals.</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["sql","oracle10g","adding","two-columns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13270261,"title":"Add 2 coloumn values together and format output Oracle SQL","body":"<p>I am guessing this is a straight forward task but just cannot seem to get this to work. I want to add to column values together and then format the result in Oracle SQL. So i thought i could do something like:</p>\n\n<pre><code>to_char(INVOICE_NET, '9,999,999.99') + to_char(INVOICE_TAX, '9,999,999.99')  AS GROSS_PRICE\n</code></pre>\n\n<p>This fails as i guess these are no longer numbers\nThen i thought this may work:</p>\n\n<pre><code>INVOICE_NET + INVOICE_TAX AS to_char(GROSS_PRICE, '9,999,999.99')\n</code></pre>\n\n<p>This also fails.\nCan anyone put me straight please on this.</p>\n\n<p>many thanks</p>\n\n<p>JC</p>\n"},{"tags":["sql","vb.net","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13270967,"title":"how to get autoincrement id after tableAdapter.update vb","body":"<p>I am using compactSQL.</p>\n\n<p>I am able to make commit changes but don't know how to get the autoincrement id inserted in table.</p>\n\n<pre><code>  Dim row As Integer = CustomerTableAdapter.Update(ArfDynamicsDataSet.Customer)\n</code></pre>\n\n<p>the row shows number of rows added in db but how can i get the newly added autoincement id.</p>\n\n<p>Thanks </p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13270431,"title":"SQL query and string search","body":"<p>I have that database diagram (MySQL). Each <code>Book</code> has assigned a <code>BookLanguage</code>. Each <code>BookLanguage</code> has two different <code>LanguageNames</code> (the globalization purpose). And also, each <code>Book</code> can have an additional <code>BookLanguage</code> <strong>(but it's not required)</strong>.</p>\n\n<p>And here's the problem - I'm stuck here while building a SQL query for searching for that <code>Books</code>, whose have some string in the <code>BookLanguageNames</code>. It's simple to build the query with joining the <code>BookLanguage</code> and <code>BookLanguageNames</code> but how to cope with the <code>AdditionalBookLanguages</code> ?</p>\n\n<p><img src=\"http://i.stack.imgur.com/QSDM4.png\" alt=\"enter image description here\"></p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13244369,"title":"MySql Query for generating report","body":"<p>I have one table which is having three fields:</p>\n\n<pre><code>Id, Creation Time, Fuel Level\n</code></pre>\n\n<p>Every two minutes we are getting data and inserting to database.For generating a fuel credit/debit statement i want to get starting(Stating of the day) and ending(End of the Day) Fuel Level.Can anyone help to form a query to generate this report?</p>\n\n<p>Search parameters will be date range.</p>\n\n<p>Id=10;creation time =2019-02-15 16:32:59;Fuel Level =20</p>\n\n<p>I created one sample schema here\n<a href=\"http://sqlfiddle.com/#!2/76dd5\" rel=\"nofollow\">http://sqlfiddle.com/#!2/76dd5</a></p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13270462,"title":"Case when in variable declaration","body":"<p><img src=\"http://i.stack.imgur.com/jvpqC.jpg\" alt=\"enter image description here\"></p>\n\n<p>I'm looking for another column that will give the overall total counts from each gender next to the <code>eduCounts</code> column.  The rest of the query works fine.  Finding the distinct gender counts in this case has to be done by <code>select count(distinct patid) from...</code></p>\n\n<p>first try:</p>\n\n<pre><code>declare @sexcounts int\nset @sexcounts = case when members.sex 'm' then (select COUNT(distinct patid) from members where sex='m')\n                 when members.sex 'f' then (select COUNT(distinct patid) from members where sex='f')\n\nselect sex, edutext, COUNT(*) as eduCounts from \n(\nselect distinct m.patid, m.sex, e.eduText\n    from members as m\n    inner join claims as c on c.patid=m.PATID\n    inner join icdClm as ic on ic.clmid=c.clmid\n    inner join tblICD as t on t.ICD=ic.icd\n    inner join EducationTable as e on e.eduID=m.education\n    inner join IncomeTable as i on i.incomeID=m.income\n    where ISNUMERIC(ic.icd)=1 and SUBSTRING(ic.icd,1,3)='707'\n)t\ngroup by sex, eduText\norder by sex\n</code></pre>\n\n<p>second try:</p>\n\n<pre><code>declare @sexcounts int\nset @sexcounts = (select COUNT(distinct patid),case when sex 'm' then (select COUNT(distinct PATID) from members where sex='m') else (select COUNT(distinct patid) from members where sex='f') \n                    from members)\n\n    select sex, edutext, COUNT(*) as eduCounts from \n    (\n    select distinct m.patid, m.sex, e.eduText\n        from members as m\n        inner join claims as c on c.patid=m.PATID\n        inner join icdClm as ic on ic.clmid=c.clmid\n        inner join tblICD as t on t.ICD=ic.icd\n        inner join EducationTable as e on e.eduID=m.education\n        inner join IncomeTable as i on i.incomeID=m.income\n        where ISNUMERIC(ic.icd)=1 and SUBSTRING(ic.icd,1,3)='707'\n    )t\n    group by sex, eduText\n    order by sex\n</code></pre>\n\n<p>I know I could make a derived table and join on the sex column, but I'd like to know how to do it with a variable if at all possible.</p>\n"},{"tags":["sql","orm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13271185,"title":"Run arbitrary SQL before and after every SQL statement in ORM environment","body":"<p>We use ORM (to be specific, Hibernate as ORM provider and JPA as abstraction) as our database accessing jobs. Now we have to introduce new database auditing platform which needs to run a special SQL before and after every sql statement in order to inject application user name into this platform. How do we integrate this audit sql into ORM's find() save() delete() method?</p>\n"},{"tags":["sql","sql-order-by","temptables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270543,"title":"Ordered data before update in SQL Server 2008 R2","body":"<p>I have a temp table inside a stored procedure. </p>\n\n<p>What I am doing is fetching data from different table and inserting it into temp table using </p>\n\n<pre><code>INSERT INTO #TempTable\n  SELECT * FROM t1\n  INNER JOIN t2 ON t1.ID = t2.ID\n</code></pre>\n\n<p>After inserting, I need to update one column. Before updating the temp table I want to order the temp table data by another column.</p>\n\n<p>How can I apply <code>ORDER By</code> clause before update clause on temp table?</p>\n"},{"tags":["sql","distinct","collation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13270733,"title":"SQL - distinct case-insensitive collation query - retrieve lower case row instead of first","body":"<p>Using a distinct query with a case-insensitive collation like <code>SQL_Latin1_General_CP1_CI_AS</code> will retrieve the first occurrence of any case-insensitive rows.</p>\n\n<p>But I want to retrieve the lower case if both cases are present.</p>\n\n<p><em>If only one case is present in the data I want to retrieve that case. (unique occurrences of capital case should remain in capital case in the result set)</em></p>\n\n<p><strong>Table:</strong></p>\n\n<pre><code>id | col1  \n----------\n1 | Ab  \n2 | ab  \n3 | cd  \n4 | Cd  \n5 | Ef \n</code></pre>\n\n<p>Query:</p>\n\n<pre><code>SELECT DISTINCT [col1] COLLATE SQL_Latin1_General_CP1_CI_AS \nFROM dbo.table\n</code></pre>\n\n<p>Will retrieve: <code>Ab, cd, Ef</code></p>\n\n<p><strong>But I want to retrieve:</strong> <code>ab, cd, Ef</code></p>\n\n<p><strong>Are there collation that can give me my desired results?</strong> </p>\n\n<p>Give priority to lower case instead of first case.</p>\n\n<p>If not I have to use subselects.</p>\n\n<ol>\n<li>Select all distinct values using case-sensitive collation (strangely is automatically sorted, almost the use case I wanted!)</li>\n<li>Select from 1 using case-insensitive collation</li>\n</ol>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13218282,"title":"sql ce to ms sql server paging query (for razor web pages)","body":"<p>recently i read this article\n<a href=\"http://www.mikesdotnetting.com/Article/150/Web-Pages-Efficient-Paging-Without-The-WebGrid\" rel=\"nofollow\">http://www.mikesdotnetting.com/Article/150/Web-Pages-Efficient-Paging-Without-The-WebGrid</a>\nbut my problem is that article uses sql server ce but im using MS sql server and i want to \nwrite this codes:</p>\n\n<pre><code>sql = \"Select Title, ISBN, Description, FirstName, LastName, Category From Books \" + \n       \"Inner Join Authors on Books.AuthorId = Authors.AuthorId \" + \n       \"Inner Join Categories on Books.CategoryId = Categories.CategoryId \" +\n       \"Order By BookId OFFSET @0 ROWS FETCH NEXT @1 ROWS  ONLY;\";\n\nvar result = db.Query(sql, offset, pageSize);\n</code></pre>\n\n<p>now what is the same query for \"Order By BookId OFFSET @0 ROWS FETCH NEXT @1 ROWS  ONLY;\"\nin sql server,\n and if you know another article to do this in another way thats fine too\n thank u so much guys</p>\n"},{"tags":["java","sql","database","query","jdbc"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":65,"score":-1,"question_id":13270154,"title":"SQL statements are being stored into database instead of values (simple but challenging )","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their username (their email address) so as to fill in an input form. The functionality of the input form is that the user has to enter for book names in order of priority.</p>\n\n<p>In the application, suppose a user's email address is \"david.ferno@gmail.com\". He will have to input only \"david.ferno\" in the JTextBox, and a SQL LIKE statement is used check the corresponding User ID from the \"bookuser\" table and store it into the \"priority\" table along with the book priority choices.</p>\n\n<p>I have used PreparedStatement for the SQL retrieval from database but when values are being inserted to the , instead of saving User ID like \"user88\", it is saving the SQL statement itself inside the database.</p>\n\n<p>What I mean to say is, in the \"priority\" table, instead of saving user88 (as an example), it is saving \"SELECT User_ID FROM user WHERE email_address\"</p>\n\n<p>Please help me to find out what is wrong with my code.</p>\n\n<p><strong>Here is the \"user\" table structure >></strong> <br/></p>\n\n<pre><code> COLUMNNAME     TYPE\n ------------------- \n User_ID        Text\n full_name      Text \n last_name      Text\n email_address  Text\n phone          Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key</p>\n\n<p><strong>Here is the \"priority\" table structure >></strong> <br/></p>\n\n<pre><code>COLUMNNAME  TYPE \n----------------\nUser_ID     Text \nBook1       Text \nBook2       Text \nBook3       Text\nBook4       Text\n</code></pre>\n\n<p><code>User_ID</code> has been set as primary key </p>\n\n<p><strong>Here are my codes</strong></p>\n\n<pre><code>import java.awt.*;\nimport java.awt.event.*;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\nimport javax.swing.*;\nimport java.sql.*;\nimport javax.*;\n\n  public class Handleraddclassroom implements ActionListener{\n\n      public void actionPerformed(ActionEvent event) {\n          String name = ((JButton)event.getSource()).getText();\n\n          if (name.equals(\"Confirm\")) {\n              String filename = \"C:/JAVA/book.accdb\";\n              String database = \"jdbc:odbc:booking\";\n\n              if(txt_mail.getText().equals(\"\")) {\n                   JOptionPane.showMessageDialog(\n                                     addpriority.this, \n                                     \"Your Username Field cannot be blank\");\n              } else {\n                   try {\n                       Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                       //username &amp;password not being used\n                       Connection con = DriverManager.getConnection(database ,\"\",\"\"); \n                       Statement s = con.createStatement(\n                                          ResultSet.TYPE_SCROLL_INSENSITIVE, \n                                          ResultSet.CONCUR_READ_ONLY);\n\n                       String squery = \"SELECT User_ID FROM bookuser WHERE \" +\n                                        + \"email_address LIKE ?\";\n                       PreparedStatement pstmt = con.prepareStatement(squery);\n                       pstmt.setString (1, txt_mail.getText() + '*');\n                       pstmt.executeQuery();\n\n                       String sql = \"INSERT INTO priority VALUES('\" \n                                                 + squery + \"','\"\n                                                 + txt_book1.getText() + \"','\"\n                                                 + txt_book2.getText() + \"','\" \n                                                 + txt_book3.getText() + \"','\"\n                                                 + txt_book4.getText()+ \"')\";\n\n                       JOptionPane.showMessageDialog(addpriority.this,\n                                                     \"Choice Records Saved.\");\n\n                       dispose();\n                       Mainmenulecturer mml = new Mainmenulecturer();\n\n                       s.execute(sql);\n\n                       s.close();\n                       con.close();\n\n                   } catch (Exception e) {\n                        System.out.print(\"Error: \" + e);\n                   }\n              }\n          }\n      }   \n\n}\n</code></pre>\n"},{"tags":["sql","oracle","plsql","oracle11g"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":28,"score":6,"question_id":13269676,"title":"Issue when comparing result of to_char(myDate, 'DAY') to a string","body":"<p>I have been trying to find what the issue might be but I am just out of luck and don't understand this problem at all.I have the following code:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION ckeckDay(dateC in date)\nRETURN VARCHAR\nIS\n  day VARCHAR(15);\n  checkFriday VARCHAR(1);\nBEGIN\n  checkFriday := 'N';\n  day := to_char(dateC, 'DAY');\n  IF day = 'FRIDAY' THEN\n    checkFriday := 'Y';\n  END IF;\n  RETURN day;\nEND;\n/\n</code></pre>\n\n<p>the <code>dateC</code> is set to Friday (even tested it by returning <code>day</code> instead of the <code>day</code> variable and it returns Friday.) However the <code>IF</code> statement never evaluates to true even though the <code>day</code> variable is indeed Friday.Any ideas how to go around this issue.Thanks</p>\n"},{"tags":["sql","sql-server","sql-server-2008","ssms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13267862,"title":"Where I can check user-define table type in SQL Server 2008 in SSMS? and how can I insert new column into it?","body":"<p>I need to add some more columns into my current <code>user-define table type in SQL Server 2008</code></p>\n\n<p>But I didn't see any table type in particular database under <code>Tables</code> .</p>\n\n<p>Where exactly I need to check and how can I modify the design of existing <code>user-define table type in SQL Server 2008</code></p>\n\n<p>I'm using <code>SQL SERVER 2008</code> and <code>SSMS</code></p>\n\n<p>Where I can find that table in <code>SSMS</code> , </p>\n\n<p>so that I can go and modify table type.</p>\n\n<p>thanks</p>\n\n<p>for previous question answer </p>\n\n<p>Please can any one help to sql <code>alter type table</code> syntax <code>add column</code> ?\nhow can I insert any new column ... as ALTER is not working.. it is disable </p>\n"},{"tags":["sql","sql-server-2000","default"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":591,"score":2,"question_id":1865657,"title":"Alter column's default value","body":"<p>I  have a table which has a column 'CompanyID int not null' and its default value is set to 10. Now I want to write a query which will alter this default value to 1. How can can I do it?</p>\n\n<p>Any help will be appreciated. I am using SQL server 2000.</p>\n"},{"tags":["mysql","sql","sql-update","ranking"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1310,"score":4,"question_id":3196971,"title":"MySQL update statement to store ranking positions","body":"<p>I'm trying to get my head around a query and I just can't figure it out. I would appreciate if someone give me a pointer. As a simple example of what I'm trying to achieve, I have these records in the database</p>\n\n<pre><code>Score|Ranking\n-------------\n100  |0\n200  |0\n300  |0\n</code></pre>\n\n<p>And I would like the Ranking field to contain 1,2,3 based on who's got the highest score so the result should be:</p>\n\n<pre><code>Score|Ranking\n-------------\n100  |3\n200  |2\n300  |1\n</code></pre>\n\n<p>At the moment, I'm doing a for next loop for all these records but given that in reality that could be a few thousand - that could take forever! Does anyone have an idea on a magic query which would do this in one go?</p>\n"},{"tags":["sql","performance"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13270502,"title":"sql - what is the difference between these two queries?","body":"<pre><code>select a.Name from rat. Assessment a where a.AssessmentId = '3'\nselect a.Name from rat. Assessment a where a.AssessmentId = 3\n</code></pre>\n\n<p>whats the difference performance wise ?\nis it slow for the first one ?</p>\n\n<p>How can i know if sql server has casted the the column or value to match the the column type or value type ?</p>\n\n<p>I saw the execution plan. cant understand much.</p>\n"},{"tags":["sql","sql-server","query","datepart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270325,"title":"Using DATEPART for AM works correctly but does not work for PM query","body":"<p>I'm using a query to pull a report for our 3rd shift folks.  </p>\n\n<p>The issue I just noticed when the report was mailed with 0 results is that I have it set right now to run from 6pm to 5:59am the next morning.  Since I have the date field = the <code>GETDATE</code>, it doesn't see the results from the night prior(1800-2359).  I was thinking of having this just pull from like -12 hours, but the button can be pressed at anytime to look at results.  </p>\n\n<p>So if they pushed it before the end of the shift, it would show some of 1st shifts entries.  I want it to only run from 1800-0559 the next morning, no matter if the button is pressed before midnight or after midnight.  I hope this makes sense.  I'm not even sure if the between recognizes to go to 00 after it's hit 2359.  I have this built into a VB.net application, and they can press the button anytime they want to get results.  This is for management to track what is being done as the employees are required to enter data real time when issues are taking place.  </p>\n\n<p>Thanks for any help.  Hope I made enough sense!  :D</p>\n\n<pre><code>SELECT \n   Assignment, Datemodified, General, \n   IncNumber, NextSteps, PDCRStatus, \n   RootCause, Status, Summary, \n   Timings, UserID \nFROM \n   Turnover \nWHERE DATEPART(HOUR, datemodified) between 18 and 05 \nAND CONVERT(NVARCHAR(50),datemodified,103) = CONVERT(NVARCHAR(50),GETDATE(),103);\n</code></pre>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13263023,"title":"Need advice to re-create history of a table based on audit tables","body":"<p>OK folks, I have an urgent need. I am tasked with re-creating an accurate history of changes to  multiple fields of an active table retroactively based on individual audit tables for each field.  I have a SQL Server Agent job that does this currently on a daily basis starting 10/16/2012, but need to immediately add records to retrofit the history back to 1/1/2012.</p>\n\n<p>To compound my issue, I need to reflect daily changes to the full hierarchy from the top down based on these audit records.</p>\n\n<p>Here's what I have:</p>\n\n<p>Active Table:</p>\n\n<pre><code>empId varchar(20),\nfirst_name varchar(50),\nlast_name varchar(50),\ncost_center varchar(20), -- need to re-create history\nmgr_empId varchar(20), -- need to re-create history\nstart_dt date, -- starting date range of active record\nend_dt date, -- end of active record - default value of 12/31/2999 = active record\nhierarchy_empId varchar (200), --derived field from a nasty self-referencing function (12x)\nhierarchy_name varchar(1000) -- derived from the same functino as the field above.\n</code></pre>\n\n<p>Example:</p>\n\n<p>Employee A1000, Tim Lee enters the org on 3/1/2012 with manager Bill A with emp Id B1000 into cost center 01552.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   12/31/2999   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999   B1000         Bill A\n</pre>\n\n<p>On 5/1/2012 the nightly job picks up a delta for Tim, and Tim's cost center changes to  31550.  So his current record is updated with an end date of yesterday, and a new \"current\" record is entered, reflected below:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012   4/30/2012   B1000>A1000   Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011   12/31/2999  B1000         Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012   12/31/2999  B1000>A1000   Bill A>Tim Lee\n</pre>\n\n<p>On 6/15/2012, a new manager Ben C, emp Id C1000, was hired underneath Tim's manager:</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000         Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    12/31/2999  B1000               Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000         Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   12/31/2999  A1000>C1000         Bill A>Ben C\nA1000  Tim Lee  31550   B1000   6/15/2012   12/31/2999  B1000>C1000>A1000   Bill A>Ben C>Tim Lee\n</pre>\n\n<p>These updates must trickle down the hierarchy.  So, if something changes above Tim, it also must be reflected in his record.   </p>\n\n<p>On 7/15, Tim's original manager Bill A gets a new manager, Mark S, emp Id X3000.</p>\n\n<pre>\nA1000  Tim Lee  01552   B1000   3/1/2012    4/30/2012   B1000>A1000               Bill A>Tim Lee\nB1000  Bill A   01552   NULL    1/1/2011    7/14/2012   B1000                     Bill A\nA1000  Tim Lee  31550   B1000   5/1/2012    6/14/2012   B1000>A1000               Bill A>Tim Lee\nC1000  Ben C    31550   A1000   6/15/2012   7/14/2012   A1000>C1000               Bill A>Ben C\nA1000  Tim Lee  31550   C1000   6/15/2012   7/14/2012   B1000>C1000>A1000         Bill A>Ben C>Tim Lee\nX3000  Mark S   01000   NULL    7/15/2012   12/31/2999  X3000                     Mark S\nA1000  Tim Lee  31550   C1000   7/15/2012   12/31/2999  X3000>B1000>C1000>A1000   Mark S>Bill A>Ben C>Tim Lee\nB1000  Bill A   01552   X3000   7/15/2012   12/31/2999  X3000>B1000               Mark S>Bill A\nC1000  Ben C    31550   B1000   7/15/2012   12/31/2999  X3000>B1000>C1000              Mark S>Bill A>Ben C\n\n</pre>\n\n<p>I have these audit tables:</p>\n\n<p><strong>tblManagerAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimestamp datetime,\noldMgr varchar(20),\nnewMgr varchar(20)\n</code></pre>\n\n<p><strong>tblCostCenterAudit</strong></p>\n\n<pre><code>empId varchar(20),\nchgTimnestamp datetime,\noldCostCenter varchar(20),\nnewCostCenter varchar(20)\n</code></pre>\n\n<p>I have struggled with how to combine the audit records for a very long time and appreciate any input.</p>\n"},{"tags":["sql","scala","jdbc","playframework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13260429,"title":"Sql Update command used in play framework (scala) does not seem to be working","body":"<p>I have my Sql table setup as follows</p>\n\n<pre><code>create table contact(\nid                      bigint not null,\nfirst_name                varchar(255) not null,\nlast_name                 varchar(255) not null,\nphone                     varchar(255) not null,\nemail                     varchar(255) not null,\ncompany                   varchar(255) not null,\nexternal_access           varchar(255),\nonline_status             varchar(12),\nconstraint pk_computer primary key (id));\n</code></pre>\n\n<p>So initially i input data values into the table except for external_access and online_status.Then I try to update online_status using the function below.</p>\n\n<pre><code>DB.withConnection { implicit connection =&gt;\nSQL(\n  \"\"\"\n     update contact\n     set online_status = online\n     where email = {email}\n  \"\"\"\n     ).on(\n       'email -&gt; email\n         ).executeUpdate()\n  } \n</code></pre>\n\n<p>So after the online status is updated, I try to display the page again by using </p>\n\n<pre><code>  select * from contact  \n</code></pre>\n\n<p>(The above code is just the gist. Actual display function is the page display function List of <a href=\"https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala\" rel=\"nofollow\">https://github.com/playframework/Play20/blob/master/samples/scala/computer-database/app/models/Models.scala</a>)</p>\n\n<p>However, the online_status is not yet updated. It continues to display nothing(in the online_status column). Can someone help me debug this </p>\n"},{"tags":["java","sql","netbeans","derby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13267627,"title":"Netbeans java application - executing query on derby database","body":"<p>I'm building a Java Application with an embedded database on Netbeans 7.2.1. For now, i'm able to establish a connection with the derby database through the following code:</p>\n\n<pre><code>Connection con = DriverManager.getConnection(\n                     \"jdbc:derby:database;create=true\",\n                     uName,\n                     uPass);\n</code></pre>\n\n<p>However, i'm not being able to execute queries on the tables of the database. After some research, i tried to execute the following code, but without success:</p>\n\n<pre><code>Statement stmt = con.createStatement();\n    ResultSet rs;\n    rs = stmt.executeQuery(\"SELECT descricao FROM fichas\");\n\nwhile (rs.next()) {\n    String s = rs.getString(\"descricao\"); \n    System.out.println(s);\n}\n</code></pre>\n\n<p>I have two problems here. First, based on the search i do i should use Statement stmt as in the example above but netbeans gives me an error. To being able to execute the method \"stmt.executeQuery()\" that follows him i have to define statement as:</p>\n\n<pre><code>java.sql.Statement stmt = con.createStatement();\n</code></pre>\n\n<p>if i don't use it like this i can't pick the method \"executeQuery\". Second, even using this the querie doesn't execute. It gives me the error on console: \"java.sql.SQLSyntaxErrorException: Schema 'ADMIN_DATABASE' does not exist\".</p>\n\n<p>Any hints how can i solve this? Thank you!</p>\n\n<p>NEW UPDATES:</p>\n\n<p>I was running some tests and here they are some new conclusions. If instead of creating the tables through the services panel of the netbeans, i run the code:</p>\n\n<pre><code>stmt.execute(\"create table test_table (name varchar(128))\");\n</code></pre>\n\n<p>it works. The table is created and if i try again it gives the expected error that the table already exists. However, i look at the services panel, att the app embedded derby database and this 'test-table' is not there together it the others.</p>\n\n<p>Adding to that, if i execute a select on that table it gives no schema error but in the others i created manually on the services panel it continues to give the error.</p>\n\n<p>So, can anyone please explain to me what's the diference? Where the test_table i created goes? What's the difference between this mode of creation and the one of creating the tables on derby? Why i receive schema erros with ones and not with the others?</p>\n\n<p>Sorry for so many questions but now i'm very confused. Thank you!</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13269545,"title":"SQL View creation error","body":"<p>I am trying to copy a view from one database to another and get the error :</p>\n\n<blockquote>\n  <p>Msg 4121, Level 16, State 1, Procedure vwPAProjects_Summary_New_2 \n  Line 2<br>\n  <em>Cannot find either column \"dbo\" or the user-defined function or\n  aggregate \"dbo.GetContractName\", or the name is ambiguous</em></p>\n</blockquote>\n\n<p>The view I am copying over is:</p>\n\n<pre><code>USE [GRAUD]\nGO\n/****** Object:  View [dbo].[vwPAProjects_Summary_New_2]    Script Date: 11/07/2012 11:57:30 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE VIEW [dbo].[vwPAProjects_Summary_New_2] AS \nselect\n dbo.GetContractName(PAPROJNUMBER) 'CONTRACT',\nPACONTNUMBER,\nisnull(dbo.GetEmployeeName(PABusMgrID),dbo.GetContractPartner(PACONTNUMBER)) 'Project Manager ID',\ncase PASTAT\nwhen 1 then 'Open'\nelse 'Closed'\nend 'Status',\ncase PAProjectType\nwhen 3 then 'Fixed Price'\nelse 'Time and Materials'\nend 'Project Type',\nPAProject_Fee_Amount 'Project Fee Amount',\nPAFTotalCost 'Forecast Total Cost',\n(PAProject_Fee_Amount - PAFTotalCost) 'Forcast Profit',\ncase\n    when PAProject_Fee_Amount = 0 then '0.00%'\n    else cast(cast(((PAProject_Fee_Amount - PAFTotalCost)/PAProject_Fee_Amount)*100 as decimal(19,2)) as varchar(21)) + '%'\nend 'Forcast %',\nPAPostedBillingsN 'Actual Billings',\nPAPostedTotalCostN 'Actual Total Cost',\n(PAPostedBillingsN - PAPostedTotalCostN) 'Current Actual Profit',\ncase\n    when PAPostedBillingsN = 0 then '0.00%'\n    else cast(cast(((PAPostedBillingsN - PAPostedTotalCostN)/PAPostedBillingsN)*100 as decimal(19,2)) as varchar(21)) + '%'\nend 'Current %'\n\nfrom PA01201\nwhere PASTAT = 1\n</code></pre>\n\n<p>Can anybody advise on how I can get this to copy over?  It has worked on other databases after I have copied it over but I cannot see any differences that would stop it this time?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13269787,"title":"SQL Server backup failing. Error: 3041, Severity: 16, State: 1","body":"<p>First of all, I'm very new at stackoverflow, so please bear with me.</p>\n\n<p>I'm running a SQL Server 9.0.4060.</p>\n\n<p>My problem is: my SQL Server backup keeps failing on a lot of the databases.</p>\n\n<p>The Maintenance plan runs to different backup jobs:</p>\n\n<p>DIFF backup everyday at 20:30 and FULL backup every Sunday at 20:30.</p>\n\n<p>I get these two errors foreach database that fails to complete the backup:</p>\n\n<pre><code>Date        06-11-2012 20:31:06\nLog     SQL Server (Current - 07-11-2012 11:43:00)\nSource      Backup\nMessage\nBACKUP failed to complete the command BACKUP DATABASE (dbname) WITH DIFFERENTIAL. Check the backup application log for detailed messages.\n\nDate        06-11-2012 20:31:06\nLog     SQL Server (Current - 07-11-2012 11:43:00)\nSource      Backup\nMessage\nError: 3041, Severity: 16, State: 1.\n</code></pre>\n\n<p>If you guys need any other information, just say the word.</p>\n"},{"tags":["sql","magento","fix","coupon"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13268938,"title":"Magento - Single Coupon marqued as used when payment pending","body":"<p>I've got a problem with magento single coupon code that is marked as having been used at the time the customer click on the ‘Place Order’ button. If the Paypal payment fails or the client abandon, he won't able to go back and re-order with this coupon which is set to be only used once, and has been marqued already been used...</p>\n\n<p>I've found a piece of code that decrease in the database the number of times the coupons is been used by the user and allows him to use the coupon once again. Unfortunately, he gets an error when trying to connect the Paypal page when clicking the place order button. In order to be able to use the coupon another time and acces the Paypal page, I have to delete lines in sql database at salesrule_coupon_usage AND salesrule_customer concerning the customer id ! </p>\n\n<p>Here is the code I need to upgrade to automatically delete coupon usage information for customer id :</p>\n\n<pre><code>public function cancel($observer)\n{\n  $event = $observer-&gt;getEvent();\n  $order = $event-&gt;getPayment()-&gt;getOrder();\n  if ($order-&gt;canCancel()) {\n    if ($code = $order-&gt;getCouponCode()) {\n      $coupon = mage::getModel('salesrule/coupon')-&gt;load($code, 'code');\n      if ($coupon-&gt;getTimesUsed() &gt; 0) {\n        $coupon-&gt;setTimesUsed($coupon-&gt;getTimesUsed()-1);\n        $coupon-&gt;save();\n      }\n\n      $rule = Mage::getModel('salesrule/rule')-&gt;load($coupon-&gt;getRuleId());\n      error_log(\"\\nrule times used=\" . $rule-&gt;getTimesUsed(),3,\"var/log/debug.log\");\n      if ($rule-&gt;getTimesUsed() &gt; 0) {\n        $rule-&gt;setTimesUsed($rule-&gt;getTimesUsed()-1);\n        $rule-&gt;save();\n      }\n      if($customerId = $order-&gt;getCustomerId()) {\n        if ($customerCoupon = Mage::getModel('salesrule/rule_customer')-&gt;loadByCustomerRule($customerId, $rule-&gt;getId())) {\n          $couponUsage = new Varien_Object();\n          Mage::getResourceModel('salesrule/coupon_usage')-&gt;loadByCustomerCoupon($couponUsage, $customerId, $coupon-&gt;getId());\n\n          if ($couponUsage-&gt;getTimesUsed() &gt; 0) {\n\n            /* I can't find any #@$!@$ interface to do anything but increment a coupon_usage record */\n            $resource = Mage::getSingleton('core/resource');\n            $writeConnection = $resource-&gt;getConnection('core_write');\n            $tableName = $resource-&gt;getTableName('salesrule_coupon_usage');\n\n            $query = \"UPDATE {$tableName} SET times_used = times_used-1 \" .\n              \" WHERE coupon_id = {$coupon-&gt;getId()} AND customer_id = {$customerId} AND times_used &gt; 0\";\n\n            $writeConnection-&gt;query($query);\n          }\n          if ($customerCoupon-&gt;getTimesUsed() &gt; 0) {\n            $customerCoupon-&gt;setTimesUsed($customerCoupon-&gt;getTimesUsed()-1);\n            $customerCoupon-&gt;save();\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n"},{"tags":["sql","compare","temp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13269327,"title":"SQL Comparing Information in Tables","body":"<p>I want to know how I would compare two pieces of information such as say I have two columns in my query: <code>surname</code> and <code>forename</code>. How could I check to see whether the <code>forename</code> exists in the <code>surname</code> column and visa versa?</p>\n\n<p>So far I've created two temporary tables, one which selects just the <code>surname</code>, and one which selects all the other information. I was going to compare them by doing a join but im having no luck.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13269586,"title":"SQL adding additional columns to a query","body":"<p>I'm trying to create a query that allows me to see all of the customers orders and to add an additional column using sql to view the total amount that the customer owes.</p>\n\n<p>the following code retrieves the correct data:</p>\n\n<pre><code>SELECT\n    cu.FName + '  ' + cu.SName as 'Name', \n    cu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', \n    cu.PostCode, \n    co.DateOrdered, co.DateDispatched, \n    ma.MaterialName, \n    it.Quantity, \n    ma.Price as 'Total' \nFROM\n    Customers cu \nLEFT JOIN \n    CustomerOrder co ON co.CustomerID = cu.CustomerID \nLEFT JOIN\n    ItemOrder it ON it.OrderID = co.OrderID \nLEFT JOIN \n    Materials ma ON ma.MaterialID = it.MaterialID \n</code></pre>\n\n<p>I now need to add additional code to the above to add a column to show the total amount the customer owes, but I'm stuck, can anybody help?</p>\n\n<pre><code>Date Order   |    Dispatch Date | Item  | QTY  |   Price | TOTAL AMOUNT FOR BOTH ROWS\n2012-10-30   |    2012-11-25    | Bath  | 1    |   49.99 |  \n2012-10-30   |    2012-11-25    | Sink  | 1    |   55.99 |\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13269638,"title":"Group By and place some records in one group","body":"<p>please consider data:</p>\n\n<pre><code> Id          Group            Value\n -----------------------------------\n 1            1                10\n 2            1                12\n 3            1                10\n 4            2                90\n 5            2                10\n 6            3                30\n 7            4                12\n 8            4                11\n 9            5                10\n 10           5                11\n</code></pre>\n\n<p>I want to do <code>Group By</code> on this data as <code>1,2,3</code> place in one group and <code>4,5</code> place in another group. How I can do this with <code>SQL Server</code>?</p>\n\n<p>thanks</p>\n\n<hr>\n\n<p><strong>Edit 1)</strong></p>\n\n<p>I want this result:</p>\n\n<pre><code>Groups                              Count\n-----------------------------------------\nGroup for 1,2,3                       6\nGroup for 4,5                         4\n</code></pre>\n"},{"tags":["c#","asp.net","sql","database","polling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13269609,"title":"Datatable: Does it retrieve all data at once or when it is needed","body":"<p>We have a performance problem in production, we are trying to solve. During our attempt to solve it, we have our eyes on the datatable. </p>\n\n<p><strong>Our flow</strong>:</p>\n\n<ol>\n<li>We run a select query on the database</li>\n<li>Put the data into a <code>DataTable</code></li>\n<li>We write out all the data into a <code>StringBuilder</code> with a separator</li>\n<li>The <code>StringBuilder</code> writes all text into the <code>Response.Write</code>, which builds a CSV file</li>\n</ol>\n\n<p>The problem is in production, our client says the operation times out. We can't reproduce the timeout in development, which might be because of the amounts of data in production.</p>\n\n<p><strong>Step 1</strong>:</p>\n\n<p>We've run a profiler on the select query, and that runs really fast.</p>\n\n<p><strong>Step 2</strong>:</p>\n\n<p>We have the following code:</p>\n\n<pre><code>SqlDataReader reader = searchQuery.ExecuteReader();\nreturnTable.Load(reader);\n</code></pre>\n\n<p><strong>Step 3</strong>:</p>\n\n<p>We iterate the <code>returnTable</code> like this:</p>\n\n<pre><code>foreach (DataRow order in orders.Rows)\n{\n      trackingNumber = order[\"TrackingNumber\"] != null ? order[\"TrackingNumber\"].ToString() : errString;\n      created = order[\"Created\"] != null ? ((DateTime)order[\"Created\"]).ToString() : errString;\n      // rest of the fields\n}\n</code></pre>\n\n<p><strong>Step 4:</strong></p>\n\n<pre><code>HttpContext.Current.Response.Write(bld.ToString());\n</code></pre>\n\n<p>Now, when we have run step 2, what happens? Is the <code>DataTable</code> fully loaded? </p>\n\n<p>I could see a problem if we poll the database in each and every row in step 3, as that could slow our process. But if it loads it all at once, I can't see how this could be a problem.</p>\n\n<p>So basically: does the <code>DataTable</code> load everything at once, or does it use lazy loading?</p>\n"},{"tags":["mysql","sql","wordpress","wordpress-mu"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":476,"score":4,"question_id":3817540,"title":"How can I simultaneously query all blog options table in a Wordpress multisite installation (3.0)?","body":"<p>In our Wordpress 3.0 multi-site installation, we have a custom option for all of our blogs called something like 'platform'. Admins can enter in a value for this platform when creating or editing a blog. Some blogs may have no platform.</p>\n\n<p>We need to be able to create a list of all platforms, and their associated blogs. The problem is, we dynamically create and delete blogs through other site mechanisms, so we have lots of blog options tables with numbers that are not necessarily contiguous. (ie wp_2_options, wp_4_options, wp_12_options, etc.)</p>\n\n<p>My question is this, is there a way in Wordpress to grab an option across all blogs? Conversely, is there a query I could run that would do this manually? I've tried something like this to no effect:</p>\n\n<p>SELECT * FROM\n  (SELECT table_name\n  FROM information_schema.tables\n  WHERE table_name like 'wp_%_options') as t\nWHERE option_name='platform'</p>\n\n<p>Does it make sense what I'm trying to do? Again, I apologize for my lack of MySql knowledge, but I haven't been able to find any answers about how to do this. I could also query all these table names first, and then query each table separately, but thats not really an option because we have many blogs, and we may need to run this query for many page requests simultaneously, and this would be adding hundreds of queries to each of these requests.</p>\n\n<p>Any advice or help you guys could give would be greatly appreciated.</p>\n"},{"tags":["sql","ibm","clearquest"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":7178329,"title":"Rational ClearQuest : sql query get Watchers accociated with a particular CQ issue","body":"<p>I am trying to query this database cq_production_user that is part of IBM Rational ClearQuest.</p>\n\n<p>I have been launching these queries from sql server express 2008 client.</p>\n\n<p>How do I get all of the Watchers associated with a particular ClearQuest issue?</p>\n\n<p>Your help in this matter would be greatly appreciated.</p>\n\n<p>Thank You</p>\n"},{"tags":["sql","reference","updates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13268724,"title":"SQL How to change value With all References","body":"<p>Is there an easier way to change a single value in a row together with its Reference , and that Reference's reference, Instead of backtracking through 20 tables to find the beginning of it all?</p>\n\n<p>Links to Answers\n--<a href=\"http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqls.doc/sqls118.htm\" rel=\"nofollow\">On Cascade</a> (Thanks Javier)</p>\n\n<pre><code>ALTER TABLE catalog DROP CONSTRAINT aa\n\nALTER TABLE catalog ADD CONSTRAINT\n   (FOREIGN KEY (stock_num, manu_code) REFERENCES stock\n   ON DELETE CASCADE CONSTRAINT ab)\n</code></pre>\n"},{"tags":["c#","sql","xml","nodelist","xmlnodelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13269221,"title":"Reading XML file via XML nodes","body":"<p>I have this XML document I am trying to read in and insert into a data base. There will only ever be one GamePlay node however GamePlayStep may repeat so I have created a node list for this. For some reason GamePlayStep isn't receiving data. Here is the XML file: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;GameData&gt;\n  &lt;GamePlay&gt;\n    &lt;type&gt;add&lt;/type&gt;\n    &lt;GamePlayID&gt;1&lt;/GamePlayID&gt;\n    &lt;ParticipantID&gt;1&lt;/ParticipantID&gt;\n    &lt;GameID&gt;1&lt;/GameID&gt;\n    &lt;GameDifficultyID&gt;1&lt;/GameDifficultyID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;Success&gt;False&lt;/Success&gt;\n  &lt;/GamePlay&gt;\n  &lt;GamePlayStep&gt;\n    &lt;GamePlayStepID&gt;1&lt;/GamePlayStepID&gt;\n    &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n    &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n    &lt;SortOrder&gt;1&lt;/SortOrder&gt;\n    &lt;Score&gt;1&lt;/Score&gt;\n    &lt;hintUsed&gt;True&lt;/hintUsed&gt;\n    &lt;GamePause&gt;\n      &lt;GamePauseID&gt;1&lt;/GamePauseID&gt;\n      &lt;Start&gt;2012-08-06T12:19:33.154Z&lt;/Start&gt;\n      &lt;End&gt;2012-08-06T12:30:33.154Z&lt;/End&gt;\n      &lt;Order&gt;1&lt;/Order&gt;\n      &lt;Duration&gt;05:01&lt;/Duration&gt;\n    &lt;/GamePause&gt;\n  &lt;/GamePlayStep&gt;\n&lt;/GameData&gt;\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>public static void start()\n        {\n            string[] filePaths = Directory.GetFiles(System.Configuration.ConfigurationManager.ConnectionStrings[\"filePath\"].ConnectionString);\n            List&lt;GamePlay&gt; gameObj = new List&lt;GamePlay&gt;();\n            List&lt;GamePlayStep&gt; gameStepObj = new List&lt;GamePlayStep&gt;();\n            foreach (string value in filePaths)\n            {\n                XmlDocument xd = new XmlDocument();\n                XmlNodeList GameSteps;\n                xd.Load(value);\n                XmlNode documentNode = xd.SelectSingleNode(\"/GameData/GamePlay\");\n                GameSteps = xd.SelectNodes(\"/GameData/GamePlay/GamePlayStep\");\n\n                GamePlay newGamePlay = new GamePlay();\n                newGamePlay.setType(Convert.ToString(documentNode.SelectSingleNode(\"type\").InnerText));\n                newGamePlay.setGamePlayID(Convert.ToInt32(documentNode.SelectSingleNode(\"GamePlayID\").InnerText));\n                newGamePlay.setParticipantID(Convert.ToInt32(documentNode.SelectSingleNode(\"ParticipantID\").InnerText));\n                newGamePlay.setGameDifficultyID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameDifficultyID\").InnerText));\n                newGamePlay.setGameID(Convert.ToInt32(documentNode.SelectSingleNode(\"GameID\").InnerText));\n                newGamePlay.setStartDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"Start\").InnerText));\n                newGamePlay.setEndDateTime(Convert.ToDateTime(documentNode.SelectSingleNode(\"End\").InnerText));\n                newGamePlay.setSuccess(Convert.ToBoolean(documentNode.SelectSingleNode(\"Success\").InnerText));\n                newGamePlay.setFile(value);\n                newGamePlay.addNewGamePlay();\n\n                foreach (XmlNode documentNode2 in GameSteps)\n                {\n\n                    GamePlayStep newGamePlayStep = new GamePlayStep();\n                    newGamePlayStep.setGamePlayStepID(Convert.ToInt32(documentNode2.SelectSingleNode(\"GamePlayStepID\").InnerText));\n                    newGamePlayStep.setGamePlayID(newGamePlay.getGamePlayID());\n                    newGamePlayStep.setStartDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"Start\").InnerText));\n                    newGamePlayStep.setEndDateTime(Convert.ToDateTime(documentNode2.SelectSingleNode(\"End\").InnerText));\n                    newGamePlayStep.setOrderPlayed(Convert.ToInt32(documentNode2.SelectSingleNode(\"SortOrder\").InnerText));\n                    newGamePlayStep.setScore(Convert.ToInt32(documentNode2.SelectSingleNode(\"Score\").InnerText));\n                    newGamePlayStep.setHintUsed(Convert.ToBoolean(documentNode2.SelectSingleNode(\"hintUsed\").InnerText));\n                    newGamePlayStep.addNewGamePlayStep();\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The GamePlay is filling the variables properly and inserting into the database however the GamePlaySteps in the NodeList are not. Does anyone see the problem or how I can improve this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","sqlite"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":23,"score":3,"question_id":13269314,"title":"Multiple SELECT on the same field in one statement","body":"<p>I got the following table:</p>\n\n<pre><code>**stats**\n\nid INT FK\nday INT    \nvalue INT\n</code></pre>\n\n<p>I would like to create an SQL query that will sum the values in value column in the last day, last week and last month, in one statement.</p>\n\n<p>So Far i got this:</p>\n\n<pre><code>select sum(value) from stats as A where A.day &gt; now() - 1\nunion\nselect sum(value) from stats as B where B.day &gt; now() - 7\nunion\nselect sum(value) from stats as C where C.day &gt; now() - 30\n</code></pre>\n\n<p>This returns just the first sum(value), i was expecting 3 values to return.</p>\n\n<p>Running: <code>select sum(value) from stats as A where A.day &gt; now() - X ( Where x = 1/7/30)</code> in different queries works as it should.</p>\n\n<p>What's wrong with the query? Thanks!</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13269026,"title":"SQL - choose number from string, and replace it","body":"<p>I hav the next query in SQL:\nSELECT id FROM student WHERE DATE LIKE '%$inputdate'\nthe inputDate is in the next format: 2010.08.03\nI also want to change the date of the date, by increasing the day in a week (+7).</p>\n\n<p>I try this:</p>\n\n<pre><code>SELECT id\nFROM student\nWHERE DATE LIKE '%$inputdate'\n     OR DATE Like '%CAST(RIGHT(\"2012-11-03\", 2)AS INT) + 7;\n</code></pre>\n\n<p>But it gives me SQL syntax error. How can I write it correctly?</p>\n"},{"tags":["c#","sql","winforms","telerik"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13182654,"title":"From DataTable to DataGridView including image path","body":"<p>I am building a small application. This application stores customer information and customer pictures.\nHere I have a problem where I want to show data from datatable to datagridview with pictures. My application does not store the image in a database, but stored in a folder. </p>\n\n<p>So in my database just store image path. But not full path, only the name of the folder or file. I use combine path on each name. It is easier to manage folders if the root directory has been changed compared to if I keep the full path.</p>\n\n<p>For example, if I want to display the image in picture box, I'll do this.</p>\n\n<pre><code>//consider the record has been selected from table\n\nclassDirectory cd = new classDirectory();\n\n// it will check current directory combine application name folder and branch name folder.\n\nstring branchFolderPath = cd.getBranchFolderPath(branchName); \n\nstring branchPanelPath = cd.getPanelFolderPath(branchFolderPath,panelName);\n\nstring customerPath = cd.getCustomerFolderPath(branchPanelPath,customerID + \" - \" + customerName);\n\nstring customerImage = path.Combine(customerPath,customerPicPath);\n\npicCustomer.Image = new Bitmap(customerImage);\n</code></pre>\n\n<p>After combine, it will return string <strong>\"C:\\Users\\My Name\\Documents\\My Application Name\\Branch Name\\Panel Name\\1235 - HIDAYAH\\Pictures\\HIDAYAH - Picture.jpg\"</strong></p>\n\n<p>So I can see the pictures.</p>\n\n<p>But, I do not know how to display the data in grid view.</p>\n\n<p>So only so far I've just made.</p>\n\n<pre><code>Customer.classDataBinding cdb = new Customer.classDataBinding();\n\nDataTable dataCustomer = cdb._listOfCustomer();\n\ndgvCustomer.DataSource = dataCustomer;\n\nthis.dgvCustomer.Columns[\"Customer Image\"].Width = 120; //For a while, this code return the string only.\nthis.dgvCustomer.Columns[\"Customer ID\"].Width = 120;\nthis.dgvCustomer.Columns[\"Name\"].Width = 120;\nthis.dgvCustomer.Columns[\"Branch\"].Width = 120;\nthis.dgvCustomer.Columns[\"Panel\"].Width = 120;\n</code></pre>\n\n<p>Code in <strong>cdb._listOfCustomer()</strong></p>\n\n<pre><code>  public DataTable _listOfCustomer()\n    {\n        cs.testConnection();\n\n        DataTable dtCustomer = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(cs.connString))\n        {\n            string query = \"SELECT tbl_customer.customerPicPath as [Customer Image], tbl_customer.customerID as [Customer ID],tbl_customer.customerName as Name, tbl_branch.branchName as Branch, tbl_panel.panelName as Panel FROM (tbl_branch INNER JOIN tbl_panel ON tbl_branch.branchID = tbl_panel.branchID) INNER JOIN tbl_customer ON tbl_panel.panelID = tbl_customer.panelID;\";\n\n            using (SqlDataAdapter adap = new SqlDataAdapter(query, conn))\n            {\n                adap.Fill(dtCustomer);\n\n            }\n        }\n\n        return dtCustomer;\n</code></pre>\n\n<p>Any suggestion? Hope someone can help me to resolve this problem. Thanks a lot!</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":6168434,"title":"Activerecord Where with a hash value","body":"<p>I have a City model with a cached_info field which is a serialized hash. </p>\n\n<pre><code>{:population=&gt;20000, :more_stuff =&gt;....}\n</code></pre>\n\n<p>If I make the following query in Activerecord.</p>\n\n<pre><code>City.where('cached_info[:population] &gt; 300').count\n</code></pre>\n\n<p>I get back...</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: \nYou have an error in your SQL syntax; \ncheck the manual that corresponds to your MySQL server version for the right syntax to use near '[:population] &gt; 300)' at line 1: SELECT COUNT(*) FROM `places` WHERE `places`.`type` = 'City' AND (cached_info[:population] &gt; 3)\n</code></pre>\n\n<p>Anybody have a workaround for this?</p>\n"},{"tags":["sql","sqlplus"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13269317,"title":"SQL selection statement","body":"<p>I'm having some trouble writing the SQL statement for the following request: \"Find the actors that acted in the movie and in the remake of that same movie\".</p>\n\n<p>The three tables are 'films', 'remakes' and 'casts': \nfilms attributes: filmid, filmname, year, director \nremakes attributes: filmid, title, year, priorfilm, priortitle, prioryear\ncasts attributes: filmid, filmname, actor</p>\n\n<p>So far I know that the priorfilm attribute should correspond with the filmid of the film being tested so I started with this:</p>\n\n<pre><code>select actor\nfrom casts, remakes, actors\nwhere casts.filmid = remakes.priorfilm\n</code></pre>\n\n<p>But I have no clue how I should proceed with this.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13269038,"title":"Mixing update/insert records in a single invocation of \"Instead of insert, update\" - Is that possible?","body":"<p>I would like to know whether an \"instead of insert, update\" trigger can be called to both \"UPDATE\" A records in the table while \"INSERTING\" B records in a <strong>single invocation</strong>?</p>\n\n<p>Actually, I'm just curious to know whether SQL Server could call the mentioned trigger for updating and inserting records, at once? or it just calls the trigger once for updating some records, and once for inserting some others?</p>\n\n<p>Consider this, for example:</p>\n\n<pre><code>ALTER TRIGGER [dbo].[MyTable_DoWhatever] \n   ON  [dbo].[MyTable] \n   INSTEAD OF INSERT, UPDATE\nAS \nBEGIN\n    SET NOCOUNT ON;\n\n    DECLARE @Updating BIT = 0;\n    IF EXISTS(SELECT * FROM INSERTED i INNER JOIN DELETED d ON i.Id = d.Id) SET @Updating = 1\n\nEND\n</code></pre>\n\n<p>Does the above @Updating flag valid to determine whether the trigger is called for \"INSTEAD OF INSERTED\" or \"INSTEAD OF UPDATE\"?</p>\n\n<p>Thanks.</p>\n"},{"tags":["asp.net","sql","sql-server","sql-server-2005","sql-server-2008"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":478,"score":0,"question_id":6120957,"title":"SQL Query Problem in Inline Query in Asp.net","body":"<p>My sql table structure is this</p>\n\n<pre><code>ID  DataName\n1   Lipsum lorem \n3   lipsum's lorem\n</code></pre>\n\n<p>My inline query in asp.net is that</p>\n\n<pre><code>select * from table where DataName like 'lipsum's lorem'\n</code></pre>\n\n<p>It gives the following errors:</p>\n\n<pre><code>Msg 102, Level 15, State 1, Line 1\nIncorrect syntax near 's'.\nMsg 105, Level 15, State 1, Line 1\nUnclosed quotation mark after the character string ''.\n</code></pre>\n\n<p>I don't want to create a stored procedure to prevent this, I want a solution to this using inline queries.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":11635,"score":10,"question_id":1383494,"title":"Alter user defined type in Sql Server","body":"<p>I created few user defined types in DB as below</p>\n\n<pre><code>CREATE TYPE [dbo].[StringID] FROM [nvarchar](20) NOT NULL\n</code></pre>\n\n<p>and assigned to various tables. My tables in db are in various schemas (not only dbo)</p>\n\n<p>But I realized I need bigger field, and I need to alter, e.g increase from nvarchar to nvarchar, but there is no ALTER TYPE statement</p>\n\n<p>I need a script that temp table/ cursor whatever and save there all tables and fields where my type is used. Then change existing fields to base type - e.g. from CustID [StringID] to CustID [nvarchar(20)].\nDrop the user type and recreate it with new type - e.g. nvarchar(50)\nand finally set back fields to user type</p>\n\n<p>I do not have rules define on types, so don't have to drop rules and re-add them</p>\n\n<p>I'm not very familiar with T-Sql, so any help is appreciated.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13269067,"title":"Constructing UPDATE statements using associative arrays in PHP","body":"<p>What is the best way to construct an UPDATE statement using associative arrays in PHP?</p>\n\n<p>For example, say I have a function like so:</p>\n\n<pre><code>/**\n * For update queries\n * \n * @param string $tableName Name of the table we're wanting to update.\n * @param array $values Associative array of columns / values to update. e.g. array('name' =&gt; 'John', 'age' =&gt; 29)\n * @param array $conditions Associative array of conditions. e.g. array('user_id' =&gt; 1) equates to \"WHERE user_id = 1\"\n */\n public function update($tableName, $values, $conditions = array()){\n      //Construct SQL\n }\n</code></pre>\n\n<p>So far, I've been able to construct simple UPDATE statements such as:</p>\n\n<pre><code>UPDATE `myTableName` SET `name` = :name, `age` = :age WHERE `user_id` = :user_id\n</code></pre>\n\n<p>Now I'm left wondering: What is the best way to approach constructing the WHERE clause? Are there similar implementations in other libraries and code bases that I can look into? For example: How do I approach the construction of WHERE clauses that have OR and AND and IN() etc? </p>\n\n<pre><code>UPDATE example SET col = :val WHERE user_id = :user_id AND (age = :age OR name = :name)\n</code></pre>\n"},{"tags":["sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13248287,"title":"appending 2 columns into one list in sql","body":"<p>I have 2 tables and each table has some 3 columns. i want to get one column such that one column from each table are apended one after the other</p>\n\n<pre><code> eg:- suppose one column in a table contains  hai, how, are, you.\n and another column in another column contains i, am, fine.\n i want a query which gives hai, how, are, you,i,am,fine. in just one column\n</code></pre>\n\n<p>can anybody give a query for this in sql...</p>\n"},{"tags":["mysql","sql","database","database-design","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13268579,"title":"PHP/MySQL Many to Many. How?","body":"<p>I recently thought that storing an array in MySQL database would solve my problems... then I went and banged my head on a wall until I realised that there was an easier solution to my problem. Unfortunately I can't seem to figure out what the hell I need to do. </p>\n\n<p>I have two tables. User and Entry. Each user can be the Author of any number of entries. One to many right? Well the problem comes from the fact that each entry can have many users. -_-;</p>\n\n<p>As you can imagine, doing this using arrays would be...not only cumbersome but also stupid, especially if someone managed to accumulate 2000 entries. I had anticipated that I might need to create an extra table and some resources do seem to suggest it but the resources aren't as clear as I would have hoped. I will need to get all the users for a post and somewhere else, I'll need to get all the posts for a user. </p>\n\n<p>Can someone explain the best way of doing this? (Without using arrays of course =p)</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13267739,"title":"I want get sales for year using MySQL","body":"<p>I want to get following result for given year </p>\n\n<pre><code>month | sales\njan     0.00\nfeb     4.00\nmar     0.00\napr     45.00\n.\n.\n.\n.\ndec    0.00\n</code></pre>\n\n<p>table that i have is \"sales\" and it has salse_value, sales_date as columns.</p>\n\n<p>question is how can get above result using case when statement in MYSQL </p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":3086,"score":4,"question_id":528529,"title":"Self-referencing constraint in MS SQL","body":"<p>Is it true that MS SQL restrict self-referencing constraints with ON DELETE CASCADE option? \nI have a table with parent-child relation, PARENT_ID column is foreign key for ID. Creating it with ON DELETE CASCADE option causes error </p>\n\n<blockquote>\n  <p>\"Introducing FOREIGN KEY constraint\n  may cause cycles or multiple cascade\n  paths. Specify ON DELETE NO ACTION or\n  ON UPDATE NO ACTION, or modify other\n  FOREIGN KEY constraints.\"</p>\n</blockquote>\n\n<p>I can't believe that I have to delete this hierarchy in recursive mode. Is there any issue except triggers?</p>\n"},{"tags":["sql","dynamic-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13268728,"title":"How to pass an output variable in dynamic sql query","body":"<p>I was reviewing a stored procedure where I found piece of code below. Looking at the code, my perception is that we are creating a variable  named @QuestionInclude and passing its value in dynamic sql statement. But how this code is working? </p>\n\n<p>This is something strage and new to me.</p>\n\n<pre><code>declare @QuestionInclude varchar(10)\nselect @sqln =  'select @QuestionInclude = 1 from ##Stg_Prelim' \nexec sp_executesql @sqln,N'@QuestionInclude varchar(10) output',@QuestionInclude output\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13268241,"title":"Random Function behavior in SELECT query in MS SQL server","body":"<p>I have a written a random function[dbo.UDF_Q_RandomNumber()] that generates a floating type random number between 0 and 1. </p>\n\n<pre><code>DECLARE @upper=10    \nDECLARE @lower=1    \nSELECT  ROUND(CAST((@lower+(@upper-@lower)*dbo.UDF_Q_RandomNumber())AS INT),0) \n</code></pre>\n\n<p>The above code generates a random number between 1 and 10.</p>\n\n<p>Now i made a temporary table #tempTable with 10 rows in it with coulumns 'Id' and 'Number'</p>\n\n<pre><code>Id  Number\n1   1\n2   2\n3   3\n4   4\n5   5\n6   6\n7   7\n8   8\n9   9\n10  10 \n</code></pre>\n\n<p>SQL Query:</p>\n\n<pre><code>CREATE TABLE #tempTable(Id INT,Number INT)\nINSERT INTO #tempTable VALUES (1,1)\nINSERT INTO #tempTable VALUES (2,2)\nINSERT INTO #tempTable VALUES (3,3)\nINSERT INTO #tempTable VALUES (4,4)\nINSERT INTO #tempTable VALUES (5,5)\nINSERT INTO #tempTable VALUES (6,6)\nINSERT INTO #tempTable VALUES (7,7)\nINSERT INTO #tempTable VALUES (8,8)\nINSERT INTO #tempTable VALUES (9,9)\nINSERT INTO #tempTable VALUES (10,10)\nDECLARE @maxCount INT;\nSELECT @maxCount=  COUNT(1) FROM #tempTable\nSELECT * FROM #tempTable\nSELECT Number FROM #tempTable WHERE Id= ROUND(CAST((1+(@maxCount-1)*dbo.UDF_Q_RandomNumber())AS INT),0)\nDROP TABLE #tempTable\n</code></pre>\n\n<p>Here the query </p>\n\n<pre><code>**SELECT Number FROM #tempTable WHERE Id= ROUND(CAST((1+(@maxCount-1)*dbo.UDF_Q_RandomNumber())AS INT),0)**\n</code></pre>\n\n<p>sometimes gives 2 rows and sometimes null which should not come as Id selected is between 1 and 10 (the rows in temptable) and  every Id has value too.\nPlease help .</p>\n"},{"tags":["sql","list","java-ee","callback","jdbctemplate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13268675,"title":"What's wrong with this data retrieval code?","body":"<p>I am new at Java EE and have written a piece of code to populate a List. But while debugging I have found that the Callback fuction is not getting executed and no data is being retrieved. Please Help.</p>\n\n<pre><code>public List&lt;VDRNote&gt; getStdVDRNotes()\n{\n     final List&lt;VDRNote&gt; notes=new ArrayList&lt;VDRNote&gt;();\n     String sql=\"Select NOTE_ID, NOTES from DCTM_VDR_STD_NOTES ORDER BY NOTE_ID ASC\";\n         RowCallbackHandler rch1=new RowCallbackHandler() {\n             public void processRow(ResultSet rs) throws SQLException\n             {\n                 VDRNote note=new VDRNote();\n                 note.setNoteId(rs.getInt(\"NOTE_ID\"));\n                 note.setNote(rs.getString(\"NOTES\"));\n                 notes.add(note);\n             }};\n         jdbcTemplate.query(sql,rch1);\n         return notes;\n}\n</code></pre>\n"},{"tags":["php","mysql","sql","opencart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13268233,"title":"Product Name Print Several times, How to fix.?","body":"<p>i had added the following Opencart module for my order report list...\n<a href=\"http://www.opencart.com/index.php?route=extension/extension/info&amp;extension_id=3597&amp;filter_search=order%20list%20filter%20model&amp;page=4\" rel=\"nofollow\">http://www.opencart.com/index.php?route=extension/extension/info&amp;extension_id=3597&amp;filter_search=order%20list%20filter%20model&amp;page=4</a></p>\n\n<p>I have problems with the column \"Products\". If there are more than one option the products name prints several times. So if I got a product with three options the product name prints three times. Is there any way to fix this problem?</p>\n\n<p>i want print product name and model number only once, any idea.?</p>\n\n<p><strong>i will attach the results what i got now...</strong>\n<img src=\"http://i.stack.imgur.com/6U18X.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>this is my sql query...</strong></p>\n\n<pre><code>public function getOrders($data = array()) { \n$sql = \"select o.order_id,o.email,o.telephone,CONCAT(o.shipping_address_1, ' ', o.shipping_address_2) AS address,CONCAT(o.firstname, ' ', o.lastname) AS customer,o.payment_zone AS state,o.payment_address_2 AS block, o.payment_address_1 AS address,o.payment_postcode AS postcode,(SELECT os.name FROM \" . DB_PREFIX . \"order_status os WHERE os.order_status_id = o.order_status_id AND os.language_id = '\" . (int)$this-&gt;config-&gt;get('config_language_id') . \"') AS  status,o.payment_city AS city,GROUP_CONCAT(pd.name) AS pdtname,GROUP_CONCAT(op.model) AS model,o.date_added,sum(op.quantity) AS quantity,GROUP_CONCAT(opt.value ) AS options, GROUP_CONCAT(opt.order_product_id )  AS ordprdid,GROUP_CONCAT(op.order_product_id )  AS optprdid, GROUP_CONCAT(op.quantity) AS opquantity from `\" . DB_PREFIX . \"order` o LEFT JOIN \" . DB_PREFIX . \"order_product op ON (op.order_id = o.order_id)  LEFT JOIN \" . DB_PREFIX . \"product_description pd ON (pd.product_id = op.product_id and pd.language_id = '\" . (int)$this-&gt;config-&gt;get('config_language_id') . \"') LEFT JOIN \" . DB_PREFIX . \"order_option opt ON (opt.order_product_id = op.order_product_id) \";\n</code></pre>\n\n<p>Product Name = <code>GROUP_CONCAT(pd.name) AS pdtname,</code></p>\n"},{"tags":["sql","sql-server","sql-server-2008","merge","case"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13268170,"title":"Merge Statement: Don't update blank field","body":"<p>I'm performing a MERGE statement from a temp table <code>t</code> into the main table <code>ts</code>, matching on an ID field. It contains the following:</p>\n\n<pre><code>WHEN MATCHED THEN UPDATE\n   SET ts.username = t.username, ts.password = t.password, ts.title = t.title, ts.firstname = t.firstname, ts.surname = t.surname, ts.email = t.email\n</code></pre>\n\n<p>If the username and password is blank in the temp table <code>t</code>, I don't want to update the main table <code>ts</code>. How can I do this?</p>\n\n<p>EDIT: Seems like a <code>CASE</code> statement or using <code>COALESCE(NULLIF(t.username, ''), ts.username)</code> will work. Which is best?</p>\n"},{"tags":["sql","sql-server","vb.net","sql-server-2008"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3365,"score":1,"question_id":1513438,"title":"How do I return a value to a sqldatareader if value is null?","body":"<p>I am currently using a sql data reader (in vb.net) to extract an article object via a stored proc from a SQL Server 2008 database. Part of this object includes the two properties shown below:</p>\n\n<pre><code>theArticle.Truthfulness = ((myReader.GetInt32(myReader.GetOrdinal(\"Truthfulness\"))))\ntheArticle.Relevance = ((myReader.GetInt32(myReader.GetOrdinal(\"Relevance\"))))\n</code></pre>\n\n<p>My problem is that the Truthfulness and Relevance may return a null value and this is causing the function to fall over.</p>\n\n<p>I think I understand why. I am asking for an integer value (getin32) and because null is returned it fails.</p>\n\n<p>How do I accommodate the null value from the database so it does not fall over?</p>\n"},{"tags":[".net","sql","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12929992,"title":"Crystal report 10 Error : Failed to open a rowset","body":"<p>I am using Crystal Reports 10, running on SQL Server 2008 R2. The backend is in the server. When I run a report, it is working fine with my Admin userid and password but if I login with the client userid and password, I get the</p>\n\n<p><img src=\"http://i.stack.imgur.com/CQUHB.png\" alt=\"Error Message\"></p>\n\n<p>Error Message :Failed to open a rowset. 42000:[Microsoft][ODBC SQL Server Driver][SQL Server]</p>\n\n<p>It sound like \"Access Violation or syntax error\".How to run the report in the client PC ?</p>\n"},{"tags":["sql","sql-server","computed-columns"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13267855,"title":"MS SQL format calculated column","body":"<p>I have a computed column which is calculated this way:</p>\n\n<pre><code>(dateadd(month,[amorted_months],[real_date_start]))\n</code></pre>\n\n<p>The above stays in the Formula property of the column. This formula displays for example </p>\n\n<p>'2013-02-28 10:22:15.583'</p>\n\n<p>Now I want to format the column and to display only the date , not the time. When I use the FORMAT function like this:</p>\n\n<pre><code>(FORMAT(dateadd(month,[amorted_months],[real_date_start]), 'YYYY-MM-DD'))\n</code></pre>\n\n<p>It says that there's an error in validation the formula. I'm not good at SQL syntax and I suppose this is really stupid. Thanks for the help!</p>\n"},{"tags":["sql","query","left-join","where-clause"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13266786,"title":"How to use where clause in Query with LEFT JOIN?","body":"<p>how to write my sql query correct? I would like to use WHERE clause in query, but I don't know  how is correct. This is my query with mistake:</p>\n\n<pre><code>**SELECT pil.[Buy-from Vendor No_],  pil.No_, pil.Amount, pil.Quantity \nFROM dbo.[„blk“ 2011$Purch_ Inv_ Line]AS pil\nWHERE pil.Type=5\nLEFT JOIN dbo.[„blk“ 2011$Purch_ Inv_ Header] AS pih\nON pil.[Document No_]=pih.No_\nORDER BY pil.amount**\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13266068,"title":"Update column with select","body":"<p>hello I would like to set a table column I tried with the update query but I have syntax error</p>\n\n<pre><code>  $cmts=\"UPDATE stat_alert INNER  JOIN cell_cmt  ON stat_alert.cell = cell_cmt.cell SET stat_alert.`cmts` = cell_cmt.`Cmts`\";\n$cmt= mysql_query($cmts)OR DIE(\"Erreur sur la requete\");\n</code></pre>\n\n<p>I have erreur sur la requete \nwho can help me </p>\n"},{"tags":["sql","sql-server","tsql","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13267349,"title":"T-SQL stored procedure - how to make parameter that accepts either integer or text","body":"<p>I have created a stored procedure that accepts 3 parameters.</p>\n\n<pre><code>@row int\n,@column VARCHAR(17)\n,@value int\n</code></pre>\n\n<p>I want the <code>@value</code> parameter to accept either text or integer because it updates different columns depending on <code>@column</code> parameter.</p>\n\n<p>Please advise</p>\n"},{"tags":["sql","mysql","stored-procedures","ide"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":831,"score":0,"question_id":1122875,"title":"Developing MySQL Stored Procedures with Intellisense?","body":"<p>i've looking for an IDE for MySQL with intellisense, which would help a lot. Any suggestions? Thanks!</p>\n"},{"tags":["sql","sybase","linear-algebra","transpose","unpivot"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13258984,"title":"Taking the \"transpose\" of a table using SQL","body":"<p>I don't know if there is a name for this operation but it's similar to the transpose in linear algebra. </p>\n\n<p>Is there a way to turn an 1 by n table T1 such as </p>\n\n<pre><code>c_1|c_2|c_3|...|a_n\n-------------------\n1  |2  |3  |...|n\n</code></pre>\n\n<p>Into a n by 2 table like the following</p>\n\n<pre><code>key|val\n-------\nc_1|1\nb_2|2\nc_3|3\n.  |.\n.  |.\na_n|n\n</code></pre>\n\n<p>I am assuming that each column c_i in T1 can be unlikely identified.</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13266766,"title":"How can i skip extra rows in excel while importing it into database using SqlBulkCopy?","body":"<p>I am importing ExcelSheet into SQL server database, the problem I have is that the ExcelSheet has around 25 columns while the database table has 15 rows. I need to skip the extra unwanted rows in excel, e.g:</p>\n\n<pre><code>using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n{                  \n   bulkCopy.ColumnMappings.Add(\"PP NO\", \"passportnumber\");\n   bulkCopy.ColumnMappings.Add(\"COVER NO\", \"covernumber\");\n   bulkCopy.ColumnMappings.Add(\"NAME\", \"paxname\");\n   .....\n}\n</code></pre>\n\n<p>The error I am getting is \n<code>The given ColumnMapping does not match up with any column in the source or destination.</code></p>\n"},{"tags":["sql","sql-server"],"answer_count":6,"favorite_count":7,"up_vote_count":53,"down_vote_count":0,"view_count":101597,"score":53,"question_id":31057,"title":"How to insert a line break in a SQL Server VARCHAR/NVARCHAR string","body":"<p>I didn't see any similar questions asked on this topic, and I had to research this for something I'm working on right now. Thought I would post the answer for it in case anyone else had the same question.</p>\n"},{"tags":["sql","sql-server"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13266534,"title":"Extract hostname from a URL","body":"<p>I have to trim the website name upto \".com\" or\"co.in\" in sql</p>\n\n<p>example: lets assume i have  site address as\"http://stackoverflow.com/questions/ask?title=trim\".\nI need to get the result as \"stackoverflow.com\".</p>\n\n<p>some scenario it may be like \"www.google.co.in\" then i need it to be \"google.co.in\"</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13266772,"title":"How can I select the latest event for a given user in Microsoft SQL Server 2008?","body":"<p>I have a database in Microsoft SQL Server 2008</p>\n\n<p>I have a table <code>[eventlog].[dbo].[USER_OPERATION]</code> with columns <code>[userID], [event_description], [event_date], [event_type], [eventID]</code></p>\n\n<p><code>eventID</code> is unique for, well, every given event that can happen.</p>\n\n<p>A given <code>UserID</code> is, of course, not unique for events (every user may have a lot of events associated with him) but is associated with a single individual user</p>\n\n<p>What I want is to create a query that would give me a list which only has the <em>latest</em> event for every user (that is to say, every <code>UserID</code>) and its associated info (the <code>event_type</code>, <code>eventID</code> and <code>event_description</code> of a given specific event).</p>\n\n<p>To illustrate:</p>\n\n<p>When performing</p>\n\n<pre><code>SELECT * \nFROM [eventlog].[dbo].[USER_OPERATION] \nORDER BY userID ASC\n</code></pre>\n\n<p>I get something along the lines of </p>\n\n<pre><code>|====================================================================================|\n|  eventID  |  userID  |        event_description        |  event_date  | event_type |\n|           |          |                                 |              |            |\n|   123     |    2     |  USER 2 broke something         |  03.11.11    |   CRASH    |\n|   391     |    2     |  USER 2 filed a complaint       |  30.04.10    |  COMPLAINT |\n|   392     |    2     |  USER 2 has bought beer         |  31.10.09    |  PURCHASE  |\n|   32      |    3     |  USER 3 broke something         |  22.10.11    |   CRASH    |\n|   568     |    4     |  USER 4 has requested support   |  05.12.11    |  SUPP_REQ  |\n|   691     |    4     |  USER 4 has bought beer         |  01.12.10    |  PURCHASE  |\n|   81      |    4     |  USER 4 updated personal data   |  17.07.11    |  PDAT_UPD  |\n|   141     |    5     |  USER 5 has bought beer         |  16.08.11    |  PURCHASE  |\n|   142     |    5     |  USER 5 broke something         |  16.08.11    |   CRASH    |\n|   269     |    6     |  USER 6 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|   845     |    7     |  USER 7 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|           |          |                                 |              |            |\n|====================================================================================|\n</code></pre>\n\n<p>As you can see, some users have multiple events with different dates associated with them.</p>\n\n<p>What I want is a query that will show me a list of users and what was the most recent date users had an event on (the output would, essentially, be a table which lists each users once, and shows the most recent event associated with each user, and associated event_description, event_date and event_type info). </p>\n\n<p>Let's call such a query result \"Recent Event Table\".</p>\n\n<p><b>Do note the \"unusual condition\" of User 5 (UserID 5) who broke something and bought beer at the same date. </p>\n\n<p>In such cases, I don't care WHICH of the two same-day events would go into the \"Recent Event Table\"</b>, it can be picked by random or whatever (though I would still would need the associated event_description and event_type info).</p>\n\n<p><b>Ideally</b>, the result would look like this (for same set of users as above):</p>\n\n<pre><code>|====================================================================================|\n|  eventID  |  userID  |        event_description        |  event_date  | event_type |\n|           |          |                                 |              |            |\n|   123     |    2     |  USER 2 broke something         |  03.11.11    |   CRASH    |\n|   32      |    3     |  USER 3 broke something         |  22.10.11    |   CRASH    |\n|   568     |    4     |  USER 4 has requested support   |  05.12.11    |  SUPP_REQ  |\n|   141     |    5     |  USER 5 has bought beer         |  16.08.11    |  PURCHASE  |\n|   269     |    6     |  USER 6 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|   845     |    7     |  USER 7 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|           |          |                                 |              |            |\n|====================================================================================|\n</code></pre>\n\n<p>If there is no way to just <i>\"pick any one of the two randomly or per some rule\"</i> for such \"date-dupes\" as User 5, having two entries in the \"Recent Event Table\" would be acceptable for such special cases, since they are very rare and I can handle them manually.</p>\n\n<p>In such (a little bit less fortunate) case the \"Recent Event Table\" would look like </p>\n\n<pre><code>|====================================================================================|\n|  eventID  |  userID  |        event_description        |  event_date  | event_type |\n|           |          |                                 |              |            |\n|   123     |    2     |  USER 2 broke something         |  03.11.11    |   CRASH    |\n|   32      |    3     |  USER 3 broke something         |  22.10.11    |   CRASH    |\n|   568     |    4     |  USER 4 has requested support   |  05.12.11    |  SUPP_REQ  |\n|   141     |    5     |  USER 5 has bought beer         |  16.08.11    |  PURCHASE  |\n|   142     |    5     |  USER 5 broke something         |  16.08.11    |   CRASH    |\n|   269     |    6     |  USER 6 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|   845     |    7     |  USER 7 updated personal data   |  27.01.12    |  PDAT_UPD  |\n|           |          |                                 |              |            |\n|====================================================================================|\n</code></pre>\n\n<p>Which is also acceptable (but would need a bit additional pruning later).</p>\n\n<p>So, to summarize my question, is it possible to construct such a Microsoft SQL query that would give me a Recent Event Table along the lines of what was described above ?</p>\n\n<p>Thank you very much for your help in advance </p>\n"},{"tags":["mysql","sql","datatable","field","record"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":25,"score":-4,"question_id":13267390,"title":"search field name by record","body":"<pre><code>number | no1 | no2 | no3 | no4 | no5 |\n--------------------------------------\n1      |0    | 3   | 4   | 15  |  23 |\n2      |0    | 3   | 3   | 14  |  16 |\n3      |0    | 3   | 0   | 12  |  37 |\n4      |0    | 3   | 1   | 13  |  53 |\n5      |0    | 3   | 2   | 16  |  13 |\n6      |0    | 3   | 1   | 11  |  22 |\n7      |0    | 3   | 0   |  2  |  23 |\n8      |0    | 3   | 4   | 35  |  25 |\n</code></pre>\n\n<p>i have this table,,\ni want to know the name field by the record,,\nfor ex,,\ni have record '2',,i wanna know the record's field(no4),,</p>\n"},{"tags":["mysql","sql","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13264581,"title":"Nested queries to get count with two conditions","body":"<p>I have these 3 tables,</p>\n\n<pre><code>tbl_1-\nip  |isp    |infection\n----------------------\n1   |aaaa   |malware\n2   |bbbb   |malware\n3   |cccc   |ddos\n3   |cccc   |trojan\n4   |dddd   |ddos\n\ntbl_2-\nip  |isp    |infection\n----------------------\n1   |aaaa   |malware\n3   |cccc   |ddos\n4   |dddd   |trojan\n5   |eeee   |trojan\n6   |ffff   |other\n\ntbl_3-\nip  |isp    |infection\n----------------------\n1   |aaaa   |ddos\n6   |ffff   |\n2   |bbbb   |other\n</code></pre>\n\n<p>Which i need to get the result as follows,</p>\n\n<pre><code>result-\nip  |isp    |infection  |ipCount    |ispCount   |infectionCount\n--------------------------------------------------------------\n1   |aaaa   |malware    |3          |3          |2\n1   |aaaa   |ddos       |3          |3          |1\n2   |bbbb   |other      |2          |2          |1\n2   |bbbb   |malware    |2          |2          |1\n3   |cccc   |ddos       |3          |3          |2\n3   |cccc   |trojan     |3          |3          |1\n4   |dddd   |ddos       |2          |2          |1\n4   |dddd   |trojan     |2          |2          |1\n5   |eeee   |trojan     |1          |1          |1\n6   |ffff   |other      |2          |2          |1\n6   |ffff   |           |2          |2          |1\n\nipCount, ispCount -&gt; count of matching ip and isp\n    eg-there are 3 records with ip = 1 and isp = aaaa\n\ninfectionCount -&gt; count of matching infections per ip and isp\n    eg-there are 2 infections that says malware where ip = 1 and isp = aaaa\n</code></pre>\n\n<p>I think I need a nested a query but I don't know how to count with two conditions; can you help?</p>\n\n<p><strong>EDIT</strong> : Code I tried,</p>\n\n<pre><code>SELECT ip, isp, infection, count(ip), count(isp), count(infection)\nFROM (\n\nSELECT ip, isp, infection\nFROM tbl_1\nUNION ALL\nSELECT ip, isp, infectionType\nFROM tbl_2\nUNION ALL\nSELECT ip, isp, infection\nFROM tbl_3\n)x\n\nGROUP BY ip, isp, infection\n</code></pre>\n\n<p>But it doesnt give the result I desire cause I don't know how to do 2 types of counts in one query</p>\n"},{"tags":["sql","codeigniter","function"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13267243,"title":"A Database Error Occurred Error Number: 1054","body":"<p>i tried to make option delete for my CI with sql, but why its still error?</p>\n\n<p><strong>error warning:</strong></p>\n\n<pre><code>A Database Error Occurred\n\nError Number: 1054\n\nUnknown column 'sip' in 'where clause'\n\nselect * from t_label where label = sip\n\nFilename: E:\\web\\rbt.new\\system\\database\\DB_driver.php\n\nLine Number: 330\n</code></pre>\n\n<p><strong>code:</strong></p>\n\n<pre><code>function hapus($id_user){\n            if($this-&gt;session-&gt;userdata('username')==TRUE) {\n                $name = $this-&gt;db-&gt;query(\"select USER_NAME from t_user where USER_ID = $id_user\")-&gt;row();\n                $id_label = $this-&gt;db-&gt;query(\"select * from t_label where label = $name-&gt;USER_NAME\")-&gt;row();\n                $this-&gt;db-&gt;query(\"delete from t_label, t_publisher where t_label.id_label = t_publisher.id_label and t_label.id_label = $id_label-&gt;id_label\");\n                $this-&gt;db-&gt;delete('t_user', array('USER_ID' =&gt; $id_user));\n                redirect(\"registrasi/reg\");\n            }\n        }\n</code></pre>\n\n<p>whats wrong with my code? really need help here</p>\n"},{"tags":["sql","postgresql","escaping","like"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13258735,"title":"How escape without using replace function in LIKE with PostgreSQL","body":"<p>Short version: I need a function to escape strings for use in <code>LIKE</code> expressions, so <code>fr_e%d</code> becomes <code>fr\\_e\\%d</code>.</p>\n\n<hr>\n\n<p>I'm looking for escape the result of a query without the need to use replace.\nBecause in this result I have path with this char  _  inside. And because I use this result in a LIKE statement, it make the \"_\" a joker like start *.</p>\n\n<p>I have to use LIKE because I'm doing some stuff concatenation in this same statement who need the fact that I use LIKE.</p>\n\n<p>I tried ~ to replace LIKE but I will have the same problem with the char '.' because ~ is to use regex just skip this solution too.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","database","sql-server-2008","query","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13261087,"title":"How to generate the mapping table in a many to many insert","body":"<p>I have a table of trades for Companys in an exchange. So for a given day I can have many trades for a company. I now want to take these trades and group them into positions.</p>\n\n<p>A trade can below to many positions depending on its attributes like country, type etc\na position can be made up of many trades.</p>\n\n<p>So I have the following tables</p>\n\n<p><strong>Table Trades</strong><br/></p>\n\n<pre><code>Id   Date      Company   Trade  Type\n1 2012-11-01     IBM     1000    A\n2 2012-11-01     IBM     3000    B\n3 2012-11-01     Dell    1000    A\n4 2012-11-01     HP      5000    A\n5 2012-11-01     HP      6000    A\n6 2012-11-01     HP      7000    B\n</code></pre>\n\n<p><strong>Table TradePositionMapping</strong><br/></p>\n\n<pre><code>PK     TableTradeID      PositionID\n1          1                100      --IBM 1000\n2          1                101      --IBM 1000\n3          2                101      --IBM 3000\n4          3                102      --Dell 1000\n5          4                103      --HP 5000\n6          5                103      --HP 6000\n7          4                104      --Hp 5000\n7          5                104      --Hp 6000\n7          6                104      --Hp 7000\n</code></pre>\n\n<p><strong>Table Position</strong><br/></p>\n\n<pre><code>PK   Company Position\n100   IBM      1000\n101   IBM      4000\n102   Dell     1000\n103   Hp      11000\n104   Hp      18000\n</code></pre>\n\n<p>So in the Positions above the IBM Trade ID 1 went to 2 Positions 100 and 101. Trade Id 2 also went to Position 101 giving a total of 4000</p>\n\n<p>Ok so the idea being that a trade can make up 1 or more positions and a position can have many trades. The business logic will determine what positions the trades flow to, so I have used A and B as flags for now just as an example.</p>\n\n<p>So to the question which is..</p>\n\n<p>When I select and aggregate from the Trades Table, I insert all the new positions that are made up from the various trades into the Positions table. Now what is the best way to create the mapping table.</p>\n\n<p>What I do at the moment is that I store the newly created Position Ids in a tempory table and then repeat the select that I would do to generate the postions in the first place.. and join to the tempory table. THis seems like a lot of duplication of code and I would like to know what the best practice is out there to do such a thing.</p>\n\n<p>best regards Mick</p>\n"},{"tags":["php","mysql","sql","query","opencart"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13257360,"title":"Using quotation mark in MySQL","body":"<p>I have a list of 1000 products I am currently importing into OpenCart. Some of the product titles contains an quotation mark to symbolise the inches (for example 5\").</p>\n\n<p>I have imported all of these products successfully using this query:</p>\n\n<pre><code>$data['name'] = mysql_escape_string($data['name']);\n$sql = \"INSERT INTO \".DB_PREFIX.\"product-description SET language_id = '1', name = '\".$data['name'].\"'\";\n$query = mysql_query($sql);\n</code></pre>\n\n<p>When I am in OpenCart the list of products also show proberly however when I go to edit the product the title input field (which is meant to show the title) cuts out the title from the \" symbol onwards.</p>\n\n<p>Here is a visual example:\n<img src=\"http://i.stack.imgur.com/HIpsV.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title is complete\n<img src=\"http://i.stack.imgur.com/93t7G.png\" alt=\"enter image description here\"></p>\n\n<p>Here we see the title as been cut out after the \".</p>\n\n<p>I can confirm it is not an OpenCart coding error because if I manually insert products from the interface with a \" it works fine. The error must lie within my query.</p>\n\n<p>If there is a problem with my query, is there a query where I can update all the products rather than re-insert them?</p>\n"},{"tags":["sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13266346,"title":"unable to convert SQL query to Linq","body":"<p>Please help me try and convert this join query. I am trying to convert the following SQL query into a LINQ query, but can not get it working. Can any one help me solve this?  </p>\n\n<pre><code>SELECT T1.BoCode, case when T2.qty is null then 0 else T2.qty end \nFROM  \n    (SELECT bocode from TABLE1) as T1\nleft join\n    (SELECT cBoCode, sum(qty) as qty    FROM TABLE2 where ncampnurn in \n        (select nurn FROM TABLE3 INNER JOIN TABLE4 ON TABLE3.CampaignCode = \n         TABLE4.CampaignCode  \n         where TABLE3.Month = 'Sep12' and TABLE4.ReportGroup = 'testgroup' )\n    GROUP BY cBoCode) as T2 \nON T1.BoCode = T2.cBoCode\norder by T1.BoCode\n</code></pre>\n\n<p>I have only been able to do the middle bit and then get stuck on whether I need to use <code>Contains</code> or <code>Any</code>.</p>\n\n<pre><code>from t3 in table3\njoin t4 in table4 on t3.CampaignCode equals t4.CampaignCode\nwhere t3.Month == \"Sep12\" &amp;&amp; t4.ReportGroup == \"testgroup\"\nselect t3.Nurn \n</code></pre>\n"},{"tags":["sql","sqlite3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":823,"score":1,"question_id":6452038,"title":"SOLite:Date formatter in SQLite","body":"<p>I am a beginner to SQLite. I have to insert as well as retrieve data in <code>DD/MM/YYYY</code> format.\nAs in oracle there are function <code>TO_DATE()</code>,<code>TO_CHAR()</code> similarly, are there any date formatter functions in SQLite.</p>\n\n<p>I want my date in DD/MM/YYYY format. Can any one help me please?</p>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13249894,"title":"IN Mysql Function how can return more than one row","body":"<p>I am using MySQL.I able get more row in MySQL procedure but not in function . I want to write the function by returning values more than one row .  I attach my partial code:</p>\n\n<pre><code>drop function if exists test_splitfn;\nDELIMITER $$\n\nCREATE Function test_splitfn( sSepar VARCHAR(255), saVal TEXT )\nReturns @MyTable table \nbody:\n\nBEGIN\n\n  DROP TEMPORARY TABLE IF EXISTS lib_Explode;\n  CREATE TEMPORARY TABLE lib_Explode(\n    pos int unsigned NOT NULL auto_increment,\n    val VARCHAR(255) NOT NULL,\n    PRIMARY KEY  (pos)\n  ) ENGINE=Memory COMMENT='Explode() results.';\n\n  IF sSepar IS NULL OR saVal IS NULL THEN LEAVE body; END IF;\n\n  SET @saTail = saVal;\n  SET @iSeparLen = LENGTH( sSepar );\n\n  create_layers:\n  WHILE @saTail != '' DO\n\n    # Get the next value\n    SET @sHead = SUBSTRING_INDEX(@saTail, sSepar, 1);\n    SET @saTail = SUBSTRING( @saTail, LENGTH(@sHead) + 1 + @iSeparLen );\n    INSERT INTO lib_Explode SET val = @sHead;\n\n  END WHILE;\n\n     Insert @MyTable\n      SELECT val  FROM lib_Explode;\n\n\n    return @MyTable;\nEND; $$\nDELIMITER ;\n</code></pre>\n"},{"tags":["sql","sqlite","android-sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13263528,"title":"sql query to filter dates of this week","body":"<p>I am new to <code>sql</code> queries, can anyone help me for writing query for the following condition\nI have a column named \"dob\" in table \"members\". <strong>Note: dob datatype is text.</strong>\nAnd the values like : </p>\n\n<pre><code>dob\n===\n7-November-1980\n9-November-1981\n10-November-1982\n5-May-1990\n</code></pre>\n\n<p>Now to get birthdays of this week (i.e) from 7-11-2012 to 13-11-2012 , I want to get the result as first 3 records. For that I wrote query like this</p>\n\n<pre><code>select * from members where dob in('7-November','8-November','9-November','10-November','11-November','12-November','13-November')\n</code></pre>\n\n<p>But it never returns any results. Anyone please help me that how can I get it. Big thanks to you.</p>\n"},{"tags":["java","mysql","sql","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13266393,"title":"How to monitor database connection in java?","body":"<p>i have created web application using java. In that i am using tomcat server and SQL server. I need to implement watch dog service for monitoring database connection and server connection. I mean if database is not connecting or tomcat server is down then i need to write a code for send a alerting mail to my mail id. </p>\n\n<p>pls someone help me...</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13266334,"title":"Substring method's in SQL query","body":"<p>This is the query which i am using to reduce the length of the character.</p>\n\n<p>these are some example char(\"For more information about the valid SQL Server 2005 data types that can be ... Is an integer that specifies where the substring starts. start can be of type bigint.\")</p>\n\n<p>if i give substring to fix the length up to 15 . the rest of the char should show like this way(...)</p>\n\n<p>my sql query is this.....</p>\n\n<pre><code>select substring('For more information about the valid SQL Server 2005 data types that can be ... Is an integer that specifies where the substring starts. start can be of type bigint.',0,15) from Admin\n</code></pre>\n\n<p>for example: it should show like this</p>\n\n<pre><code>For more information about the valid SQL Server 2005 data.\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13266299,"title":"Query to Update Table using another table as information?","body":"<p>I have two tables, <code>Staff</code> and <code>Wages</code></p>\n\n<p><code>Staff</code> Contains </p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        \n  2   Name2       4      \n  3   Name3       1      \n  4   Name4       2      \n</code></pre>\n\n<p><code>Wages</code> Contains</p>\n\n<pre><code> JobID, Wage\n   1    1500\n   2    800\n   3    1600\n   4    2000\n</code></pre>\n\n<p>(There are alot more columns in the actual one I have just took the top 4)</p>\n\n<p>I am missing the wages inside the <code>Staff</code> table, and the wages I need in the staff table are the rates in the <code>Wages</code> table..</p>\n\n<p>So I need a query which would make the <code>Staff</code> table look like:</p>\n\n<pre><code> id,   name,     jobID,   wage\n  1   Name1       2        800\n  2   Name2       4        2000\n  3   Name3       1        1500\n  4   Name4       2        800\n</code></pre>\n\n<p>An example Query which I tried was:</p>\n\n<pre><code>UPDATE `Staff` \nSET wage = (SELECT wage FROM `Wages`) \nWHERE jobID = (Select jobId FROM `Wages`)\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3072,"score":2,"question_id":2712336,"title":"What is the maximum length of a string parameter to Stored procedure?","body":"<p>I have a string of length 1,44,000 which has to be passed as a parameter to a stored procedure which is a select query on a table.\nWhen a give this is in a query (in c# ) its working fine. But when i pass it as a parameter to stored procedure its not working.</p>\n\n<p>Here is my stored procedure where in i have declared this parameter as NVARCHAR(MAX)</p>\n\n<pre><code>------------------------------------------------------\nset ANSI_NULLS ON\nset QUOTED_IDENTIFIER ON\ngo\n\nCREATE PROCEDURE [dbo].[ReadItemData](@ItemNames NVARCHAR(MAX),@TimeStamp as DATETIME)\n\nAS\n\nselect * from ItemData\n\nwhere ItemName in (@ItemNames) AND TimeStamp=@TimeStamp\n\n---------------------------------------------------------------------\n</code></pre>\n\n<p>Here the parameter @ItemNames is a string concatinated with different names such as \n'Item1','Item2','Item3'....etc.</p>\n\n<p>Can anyone tell what went wrong here?</p>\n\n<p>Thanks &amp; Regards</p>\n\n<p>Padma </p>\n"},{"tags":["php","mysql","sql","pdo","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13263094,"title":"MYSQL select field1, field2 only where field1 or field2 does not equal text","body":"<p>I have the following 2 SQL syntax that I'm looking to combine into 1 SQL syntax</p>\n\n<pre><code>SELECT sentFrom \nFROM tableName \nWHERE id = :varid \nAND sentFrom != :vartext\n\nSELECT sentTo \nFROM tableName \nWHERE id = :varid \nAND sentTo != :vartext\n</code></pre>\n\n<p>I guess I should give an example:</p>\n\n<p>MYSQL TABLE</p>\n\n<pre><code>-----------------------------------\nsentFrom          sentTo\n1                 2\n1                 3\n2                 1\n2                 3\n</code></pre>\n\n<p>query </p>\n\n<pre><code>select sentFrom where sentFrom != 1 and select sentTo where sentTo != 1\n</code></pre>\n\n<p>Returns:</p>\n\n<p>sentTo 2 but not sentFrom 1</p>\n\n<p>sentTo 3 but not sentFrom 1</p>\n\n<p>sentFrom 2 but not sentTo 1</p>\n\n<p>sentFrom 2 and sentTo 3</p>\n"},{"tags":["php","mysql","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":55,"score":-4,"question_id":13262882,"title":"How to display incorrect answers in example below","body":"<p>Below I have 4 database tables, Session, Question, Answer and Option_Type.</p>\n\n<p><strong>Session Table:</strong></p>\n\n<pre><code>SessionId  SessionName\n1          AAA\n</code></pre>\n\n<p><strong>Question Table:</strong></p>\n\n<pre><code>SessionId   QuestionId  QuestionContent       OptionId\n1           1           What is 1+1 and 4+4   2\n1           2           Does 2+2 = 4          26\n1           3           What is 3+3 and 5+5   3\n</code></pre>\n\n<p><strong>Answer Table:</strong></p>\n\n<pre><code>AnswerId  SessionId QuestionId  Answer\n1         1         1           B\n2         1         1           C\n3         1         2           Yes\n4         1         3           A\n5         1         3           C\n</code></pre>\n\n<p><strong>Option_Type</strong></p>\n\n<pre><code>OptionId OptionType\n1        A-C\n2        A-D\n3        A-E\n4        A-F\n\n.... goes up to 24 where it goes up to A-Z\n\n25       True or False\n26       Yes or No\n</code></pre>\n\n<p>Now in a jsfiddle here I have created a demo html table which you can see <a href=\"http://jsfiddle.net/WHUkh/6/\" rel=\"nofollow\">here</a></p>\n\n<p>Now if you have a good look at the html table, you will realise that what I am trying to do is display the incorrect answers under the \"Incorrect Answer\" column.</p>\n\n<p>So what I want to do is that for example for Question 1, if you look in the database table, the \"OptionId\" for Question 1 is 2, which means if you look up \"OptionId\" under the \"Option_Type\" table that \"OptionType\" for this OptionId is \"A-D\". So the options are \"A\", \"B\", \"C\" and \"D\". The answers for Question 1 are \"B\" and \"C\". So I don't want to display these answers in the table as they are correct but I want to display the other options \"A\" and \"D\" as that they are incorrect.</p>\n\n<p>Does this make sense? My question is virtually how can I not show the correct answers under the \"Incorrect Answer\" column but instead show the other options under this column per question in the code below:</p>\n\n<pre><code>   $query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, an.Answer, q.QuestionMarks \n   FROM Session s \n   INNER JOIN Question q ON s.SessionId = q.SessionId\n   JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId\n   WHERE s.SessionName = ?\n   ORDER BY q.QuestionId, an.Answer\n   \";\n\n   // prepare query\n   $stmt=$mysqli-&gt;prepare($query);\n   // You only need to call bind_param once\n   $stmt-&gt;bind_param(\"s\", $assessment);\n   // execute query\n   $stmt-&gt;execute(); \n\n\n       // This will hold the search results\n    $searchQuestionId = array();\n    $searchQuestionContent = array();\n    $searchAnswer = array();\n    $searchMarks = array();\n\n    // Fetch the results into an array\n\n   // get result and assign variables (prefix with db)\n   $stmt-&gt;bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionContent, $dbAnswer, $dbQuestionMarks);\n      while ($stmt-&gt;fetch()) {\n        $searchQuestionId[] = $dbQuestionId;\n        $searchQuestionContent[] = $dbQuestionContent;\n        $searchAnswer[] = $dbAnswer;\n        $searchMarks[] = $dbQuestionMarks;\n      } \n\n?&gt;      \n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;form id=\"QandA\" action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n\n&lt;?php \n\necho \"&lt;table border='1' id='markstbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question No.&lt;/th&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='answerth'&gt;Incorrect Answer&lt;/th&gt;\n      &lt;th class='answermarksth'&gt;Penalty per Incorrect Answer&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n$previous_question_id = null;\n$rowspans = array_count_values($searchQuestionId);\nforeach ($searchQuestionContent as $key=&gt;$question) {\n\n    // removed logic, not necessary to set empty strings if you're skipping them\n\n    echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n\n    if ($previous_question_id != $searchQuestionId[$key]) {\n        echo '&lt;td class=\"questionnumtd\" name=\"numQuestion\" rowspan=\"'.$rowspans[$searchQuestionId[$key]].'\"&gt;'.htmlspecialchars($searchQuestionId[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"questioncontenttd\" rowspan=\"'.$rowspans[$searchQuestionId[$key]].'\"&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n    }\n\n    echo '&lt;td class=\"answertd\" name=\"answers[]\"&gt;';\n    echo $searchAnswer[$key];\n    echo '&lt;/td&gt;' ;\n    echo '&lt;td class=\"answermarkstd\"&gt;&lt;input class=\"individualMarks\" name=\"answerMarks[]\" id=\"individualtext\" type=\"text\" /&gt;&lt;/td&gt;' . PHP_EOL;\n\n    // moved this to the end\n    if ($previous_question_id != $searchQuestionId[$key]) {\n        $previous_question_id = $searchQuestionId[$key];\n    }\n}\n        echo '&lt;/tr&gt;';\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n\n        ?&gt;\n\n&lt;/form&gt;\n</code></pre>\n\n<p>At the moment the code above is showing the correct answers under the \"Incorrect Answers\" column, not the incorrect answers.</p>\n"},{"tags":["sql"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2636,"score":0,"question_id":3905633,"title":"passing a parameter into a subquery","body":"<p>i was wondering if it is possible to pass a parameter into a select subquery.</p>\n\n<p>What i want to do is collect some product data from one table and then crossref the weight of the item to it's carriage cost in a shipping table to return a cost.</p>\n\n<p>something like:</p>\n\n<pre><code>select cataloguenumber, productname, \n      (select shipping.carriagecost \n       from shipping \n       where shipping.carriageweight = weight) as carriagecost\nfrom products\n</code></pre>\n\n<p>Regards</p>\n\n<p>DPERROTT</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13265160,"title":"LEFT JOIN 2 Table but will only return the 1st Record from Table2","body":"<p>table1</p>\n\n<pre><code>cid\nitemdesc\nitemprice\n</code></pre>\n\n<p>table2</p>\n\n<pre><code>cid\nimagename\nstatus\n</code></pre>\n\n<p>My 1st table is has unique cid (no duplicate) I want it to LEFT JOIN TO table2 but it has multiple rows per cid</p>\n\n<pre><code>cid      imagename           status\n1        image1-of-cid1      test1\n1        image2-of-cid1      test2\n2        image1-of-cid2      test3\n2        image2-of-cid2      test4\n2        image3-of-cid2      test5\n</code></pre>\n\n<p>But I only want the Query to return the the 1st row only of the each record fom table 1</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":393,"score":1,"question_id":5563141,"title":"Convert text to date format","body":"<p>How do I convert a text format e.g. </p>\n\n<blockquote>\n  <p>Thursday, 1 January 2009</p>\n</blockquote>\n\n<p>to a date in <code>sql</code>?</p>\n\n<p>Thank you </p>\n"},{"tags":["sql","sqlite","sqlite3"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13265244,"title":"shift id's of table alike (id = id + 1) where id is primary key","body":"<p>I need to shift all the primary keys for table alike</p>\n\n<pre><code>UPDATE TODO SET id = id + 1 \n</code></pre>\n\n<p>but I can't do it (  <a href=\"http://sqlfiddle.com/#!5/bd109/2\" rel=\"nofollow\">Demo</a> from Ahmad Al-Mutawa answer ) descript why. primary key can't be changed like this.</p>\n\n<p>Also I can't ALTER the table according that this is sqlite: <a href=\"http://www.sqlite.org/omitted.html\" rel=\"nofollow\">http://www.sqlite.org/omitted.html</a></p>\n\n<p>I'm thinking about some hardcoded recursive change for other columnts but without tsql and stored procedures it's hard for me to get how can I make it?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13254052,"title":"Reorder list by column","body":"<p>I have a column \"SortIndex\" in a table, and I would like to add a \"case update\" to reorder that table by passing in ID and the new position of the chosen one.</p>\n\n<p><a href=\"http://sqlfiddle.com/#!3/d41d8/5831\" rel=\"nofollow\">SQL Fiddle</a></p>\n\n<pre><code>DECLARE @T TABLE\n(\n    ID int,\n    Name char(1),\n    SortIndex int\n)\n\nINSERT @T \nSELECT 21, 'A', 1 UNION ALL\nSELECT 23, 'B', 2 UNION ALL\nSELECT 35, 'C', 3 UNION ALL\nSELECT 45, 'D', 4 UNION ALL\nSELECT 55, 'E', 5\n\nSELECT * FROM @T    \n\nDECLARE @SortIndex int\n\n/* MOVE A -&gt; 4 */\n\nSET @SortIndex = (SELECT SortIndex FROM @T WHERE ID = 23)\n\n/*\nUPDATE @T\n    SET \n        SortIndex = CASE ... ??\n*/      \n\n/* MOVE D -&gt; 2 */\n\nSELECT * FROM @T\n</code></pre>\n\n<p>Is this possible to solve this by only using the case statement to rebuild the sortindex'es?</p>\n\n<p><em>UPDATE</em></p>\n\n<p>Desired results</p>\n\n<pre><code>A -&gt; 4\n\n    Name SortIndex\n    B     1 \n    C     2\n    D     3\n    A     4\n    E     5\n\n    D -&gt; 2\n\n    A     1 \n    D     2\n    B     3\n    C     4\n    E     5\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":70,"score":0,"question_id":13265567,"title":"SQL for getting sum of a column","body":"<p>I have three tables linked each other.</p>\n\n<pre><code>mysql&gt; select * from tablea;\n+----+--------+\n| id | name   |\n+----+--------+\n|  1 | Item 1 |\n|  2 | Item 2 |\n+----+--------+\n2 rows in set (0.00 sec)\n\nmysql&gt; select * from tableb;\n+----+------+----------+\n| id | Aid  | name     |\n+----+------+----------+\n|  1 |    1 | B Item 1 |\n|  2 |    2 | B Item 2 |\n|  3 |    1 | B Item 3 |\n+----+------+----------+\n3 rows in set (0.00 sec)\n\nmysql&gt; select * from tablec;\n+----+------+----------+-------+\n| id | Bid  | name     | value |\n+----+------+----------+-------+\n|  1 |    1 | C Item 1 |    10 |\n|  2 |    2 | C Item 2 |    20 |\n|  3 |    1 | C Item 3 |    15 |\n|  4 |    2 | C Item 4 |     5 |\n|  5 |    3 | C Item 5 |    12 |\n+----+------+----------+-------+\n5 rows in set (0.00 sec)\n</code></pre>\n\n<p>TableA is linked to TableB with Aid, TableC is linked with TableB with Bid.</p>\n\n<p>What I want is the id of tableA and the sum of values of all the TableC items comes under it.</p>\n\n<p>The result set I expect for the above example is </p>\n\n<pre><code>+-----------+--------+\n| tablea.id | sum    |\n+-----------+--------+\n|         1 |     37 |\n|         2 |     25 |\n+-----------+--------+\n</code></pre>\n"},{"tags":["sql","sql-server","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13265369,"title":"SQL Update Select The multi-part identifier \"OLD_SP.Num\" could not be bound","body":"<pre><code>Declare @modCode varchar(3)\nSET @modCOde = 'SOR';\n\nUPDATE  Doc_SalesOrder\nSET     OLD_SP.Num = NEW_SP.NewNum\nFROM    Doc_SalesOrder as OLD_SP\nINNER JOIN\n(\n     Select\n       Id,\n       dbo.ApplyModuleCode(@modCode,Num) as NewNum \n     From Doc_SalesOrder\n     Where Num not LIKE '%'+@modCOde+'%'\n)NEW_SP ON OLD_SP.Id = NEW_SP.Id\n</code></pre>\n\n<p>When I  run the query the error is:</p>\n\n<blockquote>\n  <p>The multi-part identifier \"OLD_SP.Num\" could not be bound.</p>\n</blockquote>\n\n<p>Why?</p>\n"},{"tags":["sql","sql-server-2008","tsql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13258755,"title":"How to load image into varbinary column","body":"<p>I have table like this</p>\n\n<pre><code>CREATE TABLE [dbo].[Product](\n    [Id] [int] IDENTITY(1,1) NOT NULL,\n    [Name] [nvarchar](100) NOT NULL,\n    [Description] [nvarchar](max) NOT NULL,\n    [Price] [decimal](16, 3) NOT NULL,\n    [SmallPhoto] [varbinary](max) NULL);\n</code></pre>\n\n<p>I want load image into [SmallPhoto] field</p>\n\n<p>Main script looks like this</p>\n\n<pre><code>declare @filePath varchar(max)\ndeclare @productId int\n\nset @filePath = 'D:\\myfile.png'\nset @productId = 1\n\nupdate Product\nset SmallPhoto = -- some actions\nwhere Id = @productId\n</code></pre>\n\n<p>Expected result</p>\n\n<p>Command(s) completed successfully. :)</p>\n\n<p>UPD:</p>\n\n<p>1) My database located in other machine</p>\n\n<p>2) I do not have opportunity to copy file to remote machine</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13265209,"title":"Executing SQL Function Using Linq","body":"<p>I have created a function in MSSQL 2005 and I want to run this function using linq. My function has 2 parameters. The definition is seen below:</p>\n\n<pre><code>USE [MobileGateway]\nGO\n/****** Object:  UserDefinedFunction [dbo].[Fn_GetNoLocationAddress]    Script Date: 11/07/2012 08:27:58 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER FUNCTION [dbo].[Fn_GetNoLocationAddress] \n(   \n    -- Add the parameters for the function here\n    @Site nvarchar(255),\n    @ReceivedDate int\n)\nRETURNS @noLocationAddress TABLE (\n\nRequestID int NOT NULL,\nBarcode varchar(50) NOT NULL,\nAdrID int NOT NULL,\nName varchar(50) NOT NULL,\nStreet varchar(50) NOT NULL,\nHouseNo varchar(4) NOT NULL,\nPostal varchar(8) NOT NULL,\nCity varchar(50) NOT NULL,\nCountry varchar(50) NOT NULL,\nLatitude varchar(50) NOT NULL,\nLongitude varchar(50) NOT NULL,\nReveivedDate datetime NOT NULL\n)\nAS \nBEGIN\n    -- Add the SELECT statement with parameter references here\nINSERT INTO @noLocationAddress \nSELECT     TOP (100) PERCENT Request1.RequestID, TrackIT.dbo.Sending.Barcode, TrackIT.dbo.Address_View.AdrID, TrackIT.dbo.Address_View.Name, \n                      TrackIT.dbo.Address_View.Street, TrackIT.dbo.Address_View.HouseNo, TrackIT.dbo.Address_View.Postal, TrackIT.dbo.Address_View.City, \n                      TrackIT.dbo.Address_View.Country, Request1.Latitude, Request1.Longitude, Request1.ReceivedDate\nFROM         (SELECT DISTINCT RequestID, LTRIM([Content]) AS Barcode, Latitude, Longitude, ReceivedDate\n                       FROM          dbo.RequestWithLocation\n                       WHERE      (Site LIKE @Site) AND ([Content] &lt;&gt; '') AND (AddressID = '0') AND (ReceivedDate &gt; DATEADD(day, -@ReceivedDate, GETDATE()))) AS Request1 INNER JOIN\n                      TrackIT.dbo.Sending ON Request1.Barcode = TrackIT.dbo.Sending.Barcode INNER JOIN\n                      TrackIT.dbo.Address_View ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\n\nORDER BY TrackIT.dbo.Address_View.AdrID\n\nRETURN\n\nEND\n</code></pre>\n\n<p>As you can see I have 2 parameters and I'm returning a table with the information. But I need to use linq for executing the this function.\nCan anyone help? thanks</p>\n"},{"tags":["mysql","sql","wordpress","query","posts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":13071035,"title":"SQL query to extract all WordPress posts with categories","body":"<p>I need to extract all posts from my WordPress DB along with the associated categories and not sure how to write this query. I've taken a couple of stabs at it already with no joy and would appreciate the help?</p>\n\n<p><strong>EDIT: Here's what I have tried already:</strong></p>\n\n<pre><code>SELECT post_title, wpr.object_id, wp_terms.name\nFROM wp_terms\nINNER JOIN wp_term_taxonomy ON wp_terms.term_id = wp_term_taxonomy.term_id\nINNER JOIN wp_term_relationships wpr ON wpr.term_taxonomy_id = \nwp_term_taxonomy.term_taxonomy_id\nINNER JOIN wp_posts ON ID = wpr.object_id\nWHERE taxonomy = 'category' \nAND post_type = 'post' \nORDER by post_title\n</code></pre>\n\n<p>This seems to work but it returns 1,553 where I know I only have 1343 in my DB.</p>\n\n<p><strong>EDIT:</strong> \nWe did the same thing on another SQL query a little while ago and found that it was pulling in the revisions and other post types but thought that this was resolved using post_type = 'post'</p>\n\n<p><strong>EDIT:</strong>\nUpon looking at the number of categories in the DB, I come up with a total number of 216, 6 off the number if you subtract 1553 - 1343 = 216. So I think this total number of 1553 is coming from the wp_terms table which needs to be excluded and only those that are active with published posts should be shown?</p>\n\n<p><strong>EDIT:</strong>\nThe other possibility is that each post can have multiple categories, hence the reason for having more posts (1553). So how could I separate each posts into multiple categories?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["php","mysql","sql","date"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13192083,"title":"combining results of 3 queries in one result","body":"<p>i have 3 queries and i want all result be in only one result using array_merge and array_unique.</p>\n\n<p>here's the queries:</p>\n\n<pre><code>            $query1 = mysql_query(\"SELECT * FROM prereservation where '$arival' BETWEEN arrival and departure and room_id ='11' and status = 'active'\");  \n        while($rows1 = mysql_fetch_assoc($query1)){\n        echo $rows1['id']. \" - \". $rows1['qty'];\n        echo \"&lt;br /&gt;\";\n        }\n\n        $query2 = mysql_query(\"SELECT * FROM prereservation where '$departure' BETWEEN arrival and departure and room_id ='11' and status = 'active'\");\n        while($rows2 = mysql_fetch_assoc($query2)){\n        echo $rows2['id']. \" - \". $rows2['qty'];\n        echo \"&lt;br /&gt;\";\n        }\n\n        $query3 = mysql_query(\"SELECT * FROM prereservation where arrival &gt; '$arival' and departure &lt; '$departure' and room_id ='11' and status = 'active'\");\n        while($rows3 = mysql_fetch_assoc($query3)){\n        echo $rows3['id']. \" - \". $rows3['qty'];\n        echo \"&lt;br /&gt;\";\n        }\n\nexample result is:    \nfor       $rows1     |     $rows2     |     $rows3\n        id  |  qty   |   id  |  qty   |   id  |  qty\n       -----|--------|-------|--------|-------|------\n        01  |   1    |   01  |   1    |   02  |   1\n        03  |   1    |   02  |   1    |   03  |   1\n        04  |   1    |   03  |   1    |   04  |   1\n        08  |   1    |   05  |   1    |   05  |   1\n</code></pre>\n\n<p>i dont know if this is right? </p>\n\n<pre><code>$sample = array_unique(array_merge($rows1['id'], $rows2['id'], $rows3['id']))\n</code></pre>\n\n<p>i want to use array_merge and array_unique for id's of each results\nso the final result for id's that will be left is </p>\n\n<pre><code>01, 02, 03, 04, 05, 08.\n</code></pre>\n\n<p>and for the next query all i want is the sum(qty) of those id's.\nbut i don't know how to write a query for this, here's my sample:</p>\n\n<pre><code>$query = mysql_query(\"SELECT sum(qty) FROM prereservation where id = $sample\");\n\n        while($rows = mysql_fetch_array($query))\n          {\n          $total_qty = $rows['sum(qty)'];\n          }     \n</code></pre>\n\n<p>so the sum(qty) is equal to 6.\nplease correct my mistakes for coding, thanks guys...</p>\n\n<p><strong>Finally i found the solution, here it is..</strong></p>\n\n<pre><code>$a = $p['id'];\n        $query1 = mysql_query(\"SELECT DISTINCT id, SUM(qty)\n        FROM prereservation \n        WHERE \n        (\n            ( '$arival1' BETWEEN arrival AND departure ) OR \n            ( '$departure1' BETWEEN arrival AND departure ) OR \n            ( arrival &gt; '$arival1' AND departure &lt; '$departure1' )\n        )\n            AND room_id ='$a' \n            AND STATUS = 'active'\");  \n        while($rows1 = mysql_fetch_assoc($query1)){\n        $set1 = $rows1['SUM(qty)'];\n        }   \n        ?&gt; \n        &lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n        &lt;option value=\"0\"&gt;&lt;/option&gt;\n        &lt;? $counter = 1; ?&gt;\n        &lt;? while ($counter &lt;= ($p['qty']) - $set1){ ?&gt;\n        &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n        &lt;? $counter++;\n        }?&gt;\n        &lt;/select&gt;\n</code></pre>\n\n<p><strong>solution was made by combining all of your answers, thank you guys..</strong></p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13242249,"title":"Sorting mysql results by times from 3 tables","body":"<p>I have 3 tables: <code>questions</code>, <code>articles</code> and <code>pictures</code></p>\n\n<p>The rows in each table contain a current_timestamp column <code>posted</code>, and link to an id. I'd like to sort the results of the rows of all three by their timestamp and only echo the newest of the three (for example: if the question is newest from the ID, display that only)</p>\n\n<pre><code>if(count($interests) != 0){ foreach($interests as $interests_following){\n    $interestid = mysql_result(mysql_query(\"SELECT `id` FROM `interests` WHERE `name` = '$interests_following'\"),0);\n    $interestquestions = @mysql_result(mysql_query(\"SELECT `question_text`, `posted` FROM `questions` WHERE `interest` = '$interests_following'\"),0);\n    $interestarticles = @mysql_result(mysql_query(\"SELECT `article_title`, `posted` FROM `articles` WHERE `interest_id` = '$interestid'\"),0);\n    $interestpictures = @mysql_result(mysql_query(\"SELECT `interest_pic_title`, `posted` FROM `interest_pictures` WHERE `interest_id` = '$interestid'\"),0);\n\necho '.$interests_following.': //&lt;Only display 1 newest item (article/picture/question here&gt;\n</code></pre>\n"},{"tags":["php","mysql","sql","date"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":13089536,"title":"Query for hotel reservation","body":"<p>I have three queries in a hotel reservation system where reserves are automatic deducted from the total number of rooms. All I want those three queries goes all in only one query. My query looks like this: </p>\n\n<p><code>$p =</code> is in a <code>foreach</code> loop where <code>$p['id']</code> is the <em>id</em> of each room class and <code>$p['qty']</code> is the maximum rooms of each room class.</p>\n\n<pre><code>$a = $p['id'];\n$query = mysql_query(\"SELECT sum(qty) FROM prereservation where '$arrival' BETWEEN arrival and departure and room_id ='$a' and status = 'active'\");\n        while($rows = mysql_fetch_array($query))\n          {\n          $inogbuwin=$rows['sum(qty)'];\n          }\n$query = mysql_query(\"SELECT sum(qty) FROM prereservation where departure BETWEEN '$arrival' and '$departure' and room_id ='$a' and status = 'active'\");\n        while($rows = mysql_fetch_array($query))\n          {\n          $inogbuwin2=$rows['sum(qty)'];\n          }\n$query = mysql_query(\"SELECT sum(qty) FROM prereservation where '$departure' BETWEEN arrival and departure and room_id ='$a' and status = 'active'\");\n        while($rows = mysql_fetch_array($query))\n          {\n          $inogbuwin3=$rows['sum(qty)'];\n          }\n\n&lt;select&gt;\n &lt;option value=\"0\"&gt;&lt;/option&gt;\n &lt;? $counter = 1; ?&gt;\n &lt;? while ($counter &lt;= ($p['qty'])-($inogbuwin + $inogbuwin2 + $inogbuwin3)){ ?&gt;\n &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n &lt;? $counter++;\n }?&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>Every time I put a date between the range of those three queries, the total deducted is also tripled which is the reason I want those three queries to be all in one.</p>\n\n<p>for example i have a record in database of \n<code>arrival = 27/10/2012 and departure = 29/10/2012</code></p>\n\n<p>and the input dates that are not available in range is</p>\n\n<pre><code> $arrival = 27/10/2012 and $departure = 29/10/2012 \n $arrival = 26/10/2012 and $departure = 27/10/2012 \n $arrival = 29/10/2012 and $departure = 30/10/2012 \n $arrival = 26/10/2012 and $departure = 30/10/2012 \n $arrival = 29/10/2012 and $departure = 29/10/2012 \n</code></pre>\n\n<p>so each date that in rance of those three queries are also the deductions, so i want those queries to be in one. thanks guys</p>\n\n<p>after all i fixed the errors but only one preblem left. i fixed the reservation dates in only a single month, the problem is when the inputs of arrival and departure are not in the same month it does'nt work either. here's my code again below.</p>\n\n<pre><code>&lt;?\n$a = $p['id'];\n    $query = mysql_query(\"SELECT\n    SUM(IF('$arrival' BETWEEN arrival and departure, qty, 0)) AS bu1,\n    SUM(IF('$departure' BETWEEN arrival and departure, qty, 0)) AS bu2,\n    SUM(IF(arrival &gt; '$arrival' and departure &lt; '$departure', qty, 0)) AS bu3\n    FROM prereservation WHERE room_id ='$a' and status = 'active'\");\n    $row = mysql_fetch_array($query);\n\n    $test1 = $row['bu1'];\n    if ($row['bu1'] == $row['bu2']){\n        $test2 = $row['bu2'] - $row['bu1'];\n    }else{\n        $test2 = $row['bu2'];\n    }       \n        $test3 = $row['bu3'];\n    ?&gt;      \n&lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n&lt;option value=\"0\"&gt;&lt;/option&gt;\n    &lt;? $counter = 1; ?&gt;\n&lt;? while ($counter &lt;= ($p['qty']) - ($test1 + $test2 + $test3)){ ?&gt;\n    &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n    &lt;? $counter++;\n    }?&gt;\n</code></pre>\n\n<p>please help me guys how to solve this reservation query, or maybe there's an other way to solve this in php code. thanks guys.</p>\n\n<p><strong>Finally i'm finished and found the solution, here it is:</strong></p>\n\n<pre><code>            $a = $p['id'];\n        $query1 = mysql_query(\"SELECT DISTINCT id, SUM(qty)\n        FROM prereservation \n        WHERE \n        (\n            ( '$arival1' BETWEEN arrival AND departure ) OR \n            ( '$departure1' BETWEEN arrival AND departure ) OR \n            ( arrival &gt; '$arival1' AND departure &lt; '$departure1' )\n        )\n            AND room_id ='$a' \n            AND STATUS = 'active'\");  \n        while($rows1 = mysql_fetch_assoc($query1)){\n        $set1 = $rows1['SUM(qty)'];\n        }   \n        ?&gt; \n        &lt;select id=\"select\" name=\"qty[]\" style=\" width:50px;\" onchange=\"checkall()\"&gt;\n        &lt;option value=\"0\"&gt;&lt;/option&gt;\n        &lt;? $counter = 1; ?&gt;\n        &lt;? while ($counter &lt;= ($p['qty']) - $set1){ ?&gt;\n        &lt;option value=\"&lt;?php echo $counter ?&gt;\"&gt;&lt;?php echo $counter ?&gt;&lt;/option&gt;\n        &lt;? $counter++;\n        }?&gt;\n        &lt;/select&gt;\n</code></pre>\n\n<p><strong>thank you guys for sharing your ideas, this solution is the combinations of your answers.. thanks again!!</strong></p>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13264779,"title":"How to display a null row between 2 tables","body":"<p>Using a view in SQL Server 2000</p>\n\n<p>Table1:</p>\n\n<pre><code>id  z1      z2      z3      z4   type\n--------------------------------------\n01A 300     400     300     400  01\n2B  300     400     300     500  02\n3C  700     600     400     300  01\n04A 500     400     800     900  01\n05B 400     300     400     300  02\n06  150     200     200     150  03\n....\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>type  value1         value2\n------------------------------------    \n01    0      300\n01    301    500          \n02    0      200\n02    201    400\n03\n.....\n</code></pre>\n\n<p>I want to select the table1 rows based on table2 range:</p>\n\n<p>Combination for table1- <code>max(Z1, Z2) and max(Z3, Z4)</code></p>\n\n<p>If Max(z1,z2)  range is less than or equal to table2 max(value2) where table1.type = table2.type\nIf Max(z1, z2)  range is less than or equal to table2 max(value2) where table1.type = table2.type</p>\n\n<p>If z1, Z2 range less than or equal to table2 then i want to display the z1, z2 rows otherwise null\nIf z3, z4 range less than or equal to table2 then i want to display the z3, z4 rows otherwise null</p>\n\n<p>Expected output</p>\n\n<p>Table1:</p>\n\n<pre><code> id  z1      z2      z3      z4   type\n    --------------------------------------\n\n01A 300     400     300     400  01 ' `Both (z1, z2), (z3, z4) rows are matching with table2 for type 01`\n2B  300     400     null     null  02 ' (z1, z2) are matching, (z3, z4) rows are not matching with table2 for type 02\n3C  null    null     400     300  01 ' (z1, z2) rows are not matching, (z3, z4) rows are matching with table2 for type 01\n04A 500     400     null     null  01 ' (z1, z2) rows are matching, (z3, z4) rows are not matching with table2 for type 01\n05B 400     300     400     300  02 ' Both (z1, z2), (z3, z4) rows are matching with table2 for type 02\n\n....\n</code></pre>\n\n<p>Currently I'm using a view, I don't want to change to stored procedure because most of the report are using this view.</p>\n\n<p>How to do it in sql..?</p>\n"},{"tags":["c#","asp.net","sql","database","informix"],"answer_count":7,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":9468,"score":11,"question_id":7026566,"title":"Failed to enable constraints. One or more rows contain values violating non-null, unique, or foreign-key constraints","body":"<p>I make an outer join and executed successfully in the <code>informix</code> database but I get the following exception in my code:</p>\n\n<pre><code>DataTable dt = TeachingLoadDAL.GetCoursesWithEvalState(i, bat);\n</code></pre>\n\n<blockquote>\n  <p>Failed to enable constraints. One or more rows contain values\n  violating non-null, unique, or foreign-key constraints.</p>\n</blockquote>\n\n<p>I know the problem, but I don't know how to fix it.</p>\n\n<p>The second table I make the outer join on contains a composite primary key which are null in the previous outer join query.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<pre><code>    SELECT UNIQUE a.crsnum_e,  a.crsnum_e  || '/ ' || a.crstteng crs_name, b.period,\n           b.crscls, c.crsday, c.from_lect, c.to_lect,\n           c.to_lect - c.from_lect + 1 Subtraction, c.lect_kind, e.eval, e.batch_no,\n           e.crsnum, e.lect_code, e.prof_course\n    FROM rg1course a, rg3crsgrp b, ct1table c, ct1tablelect d,\n         OUTER(cc1assiscrseval e)  \n    WHERE a.crsnum = b.crsnum \n    AND b.crsnum = c.crsnum \n    AND b.crscls = c.crscls \n    AND b.batch_no = c.batch_no \n    AND c.serial_key = d.serial_key  \n    AND c.crsnum = e.crsnum  \n    AND c.batch_no = e.batch_no  \n    AND d.lect_code= e.lect_code \n    AND d.lect_code = .... \n    AND b.batch_no = ....\n</code></pre>\n\n<p>The problem happens with the table <code>cc1assiscrseval</code>. The primary key is (batch_no, crsnum, lect_code).</p>\n\n<p>How to fix this problem?</p>\n\n<p>EDIT:</p>\n\n<p>According to @PaulStock advice:\nI do what he said, and i get:</p>\n\n<blockquote>\n  <p>? dt.GetErrors()[0] {System.Data.DataRow} HasErrors: true ItemArray:\n  {object[10]} RowError: \"Column 'eval' does not allow DBNull.Value.\"</p>\n</blockquote>\n\n<p>So I solve my problem by replacing  <code>e.eval</code> to ,<code>NVL (e.eval,'') eval</code>.and this solves my problem.\nThanks a lot.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13264519,"title":"Getting weekly data from sql","body":"<p>I have a table which has a date column ands values according to dates.Normally if i want to select the data between two dates we use the <code>BETWEEN</code> syntax but it brings each day between those 2 values i have given.Is it possible to change it so it brings the dates with sopme interval i have given? For example if do a simple </p>\n\n<pre><code>SELECT * FROM METABLE WHERE DATE BETWEEN '2012-06-11' AND '2012-07-11'\n</code></pre>\n\n<p>It should bring me the dates as:</p>\n\n<pre><code>2012-06-11 myValue Stuff \n2012-06-12 myValue Stuff \n.\n.\n.\n2012-07-11 myValue Stuff.\n</code></pre>\n\n<p>IS it possible to change it to,</p>\n\n<pre><code>2012-06-11 myValue Stuff \n2012-06-18 myValue Stuff \n2012-06-25 myValue Stuff \n.\n.\n.\nUntil my end date.\n</code></pre>\n\n<p>So this gives me my weekly values.\nHow can i achieve that?</p>\n"},{"tags":["sql","postgresql","dblink"],"answer_count":4,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":8305,"score":9,"question_id":3862648,"title":"How to use (install) dblink in postgresql?","body":"<p>I am used to Oracle and to create a dblink in my schema and then access to a remote database like this : <code>mytable@myremotedb</code>, is there anyway do to the same with PostgreSQL ?</p>\n\n<p>Right now I am using dblink like this : </p>\n\n<pre><code>SELECT logindate FROM dblink('host=dev.toto.com\n                              user=toto\n                              password=isok\n                              dbname=totofamily', 'SELECT logindate FROM loginlog');\n</code></pre>\n\n<p>When I execute this command I get the following error : <code>HINT:  No function matches the given name and argument types. You might need to add explicit type casts.</code></p>\n\n<p>Does anybody have an idea ? Do we have to \"activate\" dblinks or do something before using them ? </p>\n\n<p><strong>Edit</strong></p>\n\n<p>Is there something to do on the remote database we are going to query? Do we have to activate dblink too ? I keep having a <code>could not establish connection</code>. This is the line is type :</p>\n\n<pre><code>SELECT dblink_connect_u('host=x.x.x.x dbname=mydb user=root port=5432');\n</code></pre>\n\n<p>IP Address is correct and postgres is running on the remote server. Any idea ?</p>\n"},{"tags":["c#","sql","ms-access","exception-handling","ado.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":13264491,"title":"Syntax error in FROM clause on DataAdapter.Fill()","body":"<p>I am having a problem with my codes, not knowing whats the issue. Can anyone advise?</p>\n\n<p>The whole program is for a biometric program. This is just the login User controller. How can i solve this problem?</p>\n\n<p>I am facing this problem in the line: </p>\n\n<pre><code>dbAdapter.Fill(uds);\n</code></pre>\n\n<p>Stating:</p>\n\n<blockquote>\n  <p>OleDbException was unhandled:Syntax error in FROM clause. </p>\n</blockquote>\n\n<p>My codes are below: \n<strong>USER CONTROLLER</strong> </p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\n    class UserController\n    {\n        User[] user;\n        User searchUser;\n        DataRowCollection rows;\n        DataSet uds;\n        OleDbDataAdapter dbAdapter;\n        DataTable userTable;\n\n        //A kind of gobal var to share in project\n        public static string uNameExist;\n        public static string passwordExist;\n        public static string roleExist;\n\n        public UserController(){\n\n        // Set up Connection String\n        OleDbConnection dbConn = new  OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=PrivacyDefenderDatabase.mdb\");\n\n        // Setup SQL select statement\n        string sqlStatement = \"Select * from User\";\n\n        // Setup DBAdapter (Scientist Table)\n\n        dbAdapter = new OleDbDataAdapter(sqlStatement, dbConn);\n        OleDbCommandBuilder OrderDetailsCmdBuilder = new OleDbCommandBuilder(dbAdapter);\n\n        // Create a Data Set to hold data from DB\n        uds = new DataSet();\n\n        // fill ds with data from DB\n        dbAdapter.Fill(uds);\n\n        // get contacts table\n        DataTable userTab = uds.Tables[0];\n\n        // get all rows\n        rows = userTab.Rows;\n        }\n\n        public User[] GetAllUsers()\n        {\n            DataRow row;\n\n            user = new User[rows.Count];\n\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                row = rows[i];\n                user[i] = new User();\n                user[i].SetId((Int32)row[\"ID\"]);\n                user[i].SetEmployeeID((string)row[\"EmployeeID\"]);\n                user[i].SetUsername((string)row[\"Username\"]);\n                user[i].SetFName((string)row[\"FName\"]);\n                user[i].SetLName((string)row[\"LName\"]);\n                user[i].SetPassword((string)row[\"Password\"]);\n                user[i].SetEmail((string)row[\"Email\"]);\n                user[i].SetContact((Int32)row[\"Contact\"]);\n                user[i].SetRole((string)row[\"Roles\"]);\n            }\n            return user;\n        }\n\n        public User SearchUser(string uname)\n        {\n            searchUser = new User();\n\n            //get all rows from DB\n            GetAllUsers();\n            for (int i = 0; i &lt; rows.Count; ++i)\n            {\n                if (user[i].GetUsername() == uname)\n                {\n                    searchUser.SetId(user[i].GetId());\n                    searchUser.SetEmployeeID(user[i].GetEmployeeID());\n                    searchUser.SetUsername(user[i].GetUsername());\n                    searchUser.SetFName(user[i].GetFName());\n                    searchUser.SetLName(user[i].GetLName());\n                    searchUser.SetPassword(user[i].GetPassword());\n                    searchUser.SetEmail(user[i].GetEmail());\n                    searchUser.SetContact(user[i].GetContact());\n                    searchUser.SetRole(user[i].GetRole());\n                }\n            }\n            return searchUser;\n        }\n\n        public User SearchUserName(string userName)\n        {\n        User searchUserName = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get UserName to store in this container\n            string checkUname = user[i].GetUsername();\n            if (checkUname == userName)\n            {\n                uNameExist = \"Exists\";\n                roleExist = user[i].GetRole();\n            }\n        }\n        return searchUserName;\n        }\n\n        // Search password for Login function\n        public User SearchPassword(string password)\n        {\n        User searchPassword = new User();\n\n        //get all rows from DB\n        GetAllUsers();\n        for (int i = 0; i &lt; rows.Count; ++i)\n        {\n            //Get password to store in this container\n\n            string checkPassword = user[i].GetPassword();\n            if (checkPassword == password)\n            {\n                passwordExist = \"Exists\";\n            }\n        }\n        return searchPassword;\n    }\n        public static string GetSHA512(string text)\n        {\n            UnicodeEncoding UE = new UnicodeEncoding();\n            byte[] hashValue;\n            byte[] message = UE.GetBytes(text);\n\n            SHA512Managed hashString = new SHA512Managed();\n            string hex = \"\";\n\n            hashValue = hashString.ComputeHash(message);\n            foreach (byte x in hashValue)\n            {\n                hex += String.Format(\"{0:x2}\", x);\n            }\n            return hex;\n        }\n    }\n}\n</code></pre>\n\n<p>This is my login page form: With the following codes. Whenever i click login, the errors come up. Whats wrong with my codes?</p>\n\n<p>My codes are below:<strong>LOGIN PAGE FORM</strong></p>\n\n<pre><code>namespace Privacy_Biometric_Defender\n{\npublic partial class Login : Form\n{\n    //A kind of gobal var to share in project\n    public static string fixedUName;\n\n    public Login()\n    {\n        InitializeComponent();\n    }\n\n    private void LoginClearButton_Click(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Clear();\n        LoginPasswordTextBox.Clear();\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void Login_Load(object sender, EventArgs e)\n    {\n        LoginUsernameTextBox.Focus();\n    }\n\n    private void LoginButton_Click(object sender, EventArgs e)\n    {\n\n        string userName = this.LoginUsernameTextBox.Text;\n        MessageBox.Show(\"Codes Stops Here\");\n        UserController cont1 = new UserController();\n        User SearchUserName = new User();      \n        // Passing textbox input to Controller\n        fixedUName = LoginUsernameTextBox.Text;\n        SearchUserName = cont1.SearchUserName(userName);\n\n        string passwd = this.LoginPasswordTextBox.Text;\n        UserController cont2 = new UserController();\n        User SearchPassword = new User();\n        // Passing textbox input to Controller\n        SearchPassword = cont2.SearchPassword(UserController.GetSHA512(passwd));\n\n        // Collect information from Controller\n        string checkUnameExist = UserController.uNameExist;\n        string checkPasswordExist = UserController.passwordExist;\n        string checkRoleExist = UserController.roleExist;\n\n        if (checkPasswordExist == \"Exists\" &amp;&amp; checkUnameExist == \"Exists\")\n        { \n            MessageBox.Show(\"Login Successfully\");\n        }\n        else\n        {\n            MessageBox.Show(\"Login Unsuccessfully!\");\n        }   \n    }\n\n    private void LoginUsernameTextBox_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["sql","sql-server","database","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13258850,"title":"table name of column from view","body":"<p>I have a view which returns 30 columns. The view is created by inner join of three tables. I wish to find out which column was taken from which table using a query rather than going through the view line by line.\nIs there a way to do that in sql server 2008?\nthanks in advance </p>\n"},{"tags":["mysql","sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13263497,"title":"SQL compare strings having version as value","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6855588/split-a-string-and-return-greatest-in-mssql\">Split a string and return greatest in mssql</a>  </p>\n</blockquote>\n\n\n\n<p>I need to compare strings which have version value, for example:\nstring1 = 2.3.4\nstring2 = 2.5.6\nNow in the above case i need to check which string version is greater?</p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":18,"score":1,"question_id":13264109,"title":"Oracle:Set default value for number column","body":"<p>How can we set default value for a number typed column has '00'?I tried this but it still saved it has '0',I need to do this.</p>\n\n<pre><code>//alter table table_name add column column1 default '00';\n</code></pre>\n\n<p>Please suggest a way for me.</p>\n"},{"tags":["sql","table","jointable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13263391,"title":"Joining Table error","body":"<p>I've Table1 created that has composite keys (column1,column2,column3)</p>\n\n<pre><code>CONSTRAINT table_PK PRIMARY KEY (column1,column2,column3)\n</code></pre>\n\n<p>Table 2 has composite key (column1,column4)</p>\n\n<pre><code>CONSTRAINT table2_FK FOREIGN KEY (column1)\n  REFERENCES table1 (column1)\nCONSTRAINT table2_column4_FK FOREIGN KEY (column4)\n  REFERENCES table3 (column4)\n</code></pre>\n\n<p>However i'm not able to join table 2 to table 1. Between the 2 tables, the only referencing column should only be column1</p>\n\n<p>however i'm receiving an error.</p>\n\n<pre><code>SQL Error: ORA-02270: no matching unique or primary key for this column-list\n02270. 00000 -  \"no matching unique or primary key for this column-list\"\n*Cause:    A REFERENCES clause in a CREATE/ALTER TABLE statement\n           gives a column-list for which there is no matching unique or primary\n           key constraint in the referenced table.\n*Action:   Find the correct column names using the ALL_CONS_COLUMNS\n           catalog view\n</code></pre>\n\n<p>I've tried check the constraint and everything seems right.</p>\n\n<p>When i tried using the interface to create table, it did not work as well.</p>\n\n<pre><code>The number of FK columns (2) does not equal to the number of referenced columns (3)\n</code></pre>\n\n<p>From what i see, they require me to have an equal amount of column to have reference to another table. However i dun think it's necessary. It should only require 1 column right? Pls correct me if I'm wrong.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","wpf","textbox","intellisense"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13263046,"title":"SQL Intellisense in WPF Textbox","body":"<p>I am building an application which contains Textbox. I want the Textbox to act just like SQl Server Editor with intellisense. I need help, can i make my Textbox act like a Sql Server Query Editor WITH Intellisense.</p>\n"},{"tags":["java","sql","database","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13263493,"title":"Java not recognising SQL statement to retrieve data from database","body":"<p>I have a problem with my Java application. The application is based on users who have to enter their username (their email address) so as to fill in an input form. The functionality of the input form is that the user has to enter for book names in order of priority. In the application, suppose a user's email address is \"david.ferno@gmail.com\"....he will have to input only \"david.ferno\" in the JTextBox...and a SQL LIKE statement is used check the corresponding User ID from the \"bookuser\" table and store it into the \"priority\" table along with the book priority choices. </p>\n\n<p>The issue is that everytime java is displaying syntax error. </p>\n\n<p>Here is the error appearing>>> </p>\n\n<pre><code>Error: java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Syntax error (missing operator) in query expression ''SELECT User_ID FROM bookuser WHERE email_address Like 'david.ferno%' ''.\n</code></pre>\n\n<p>I can't figure out where is my mistake...please help. </p>\n\n<pre><code>    import java.awt.*;\n    import java.awt.event.*;\n    import java.sql.Connection;\n    import java.sql.DriverManager;\n    import java.sql.ResultSet;\n    import java.sql.SQLException;\n    import java.sql.Statement;\n    import javax.swing.*;\n    import java.sql.*;\n    import javax.*;\n\n    public class addpriority extends JFrame{\n    public JTextField txt_email, txt_book1, txt_book2,txt_book3, txt_book4;\n    public JLabel label1;\n    public JButton confirm;\n\n    public addpriority(){\n        super(\"Book Choice Input Menu\");\n        this.setSize(506,620);\n        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n        this.setVisible(true);\n\n        Toolkit toolkit =  Toolkit.getDefaultToolkit ();\n        Dimension dim = toolkit.getScreenSize();\n\n        setLocation((int) (dim.width*0.25), 50);\n\n        JPanel label = new JPanel();\n        JLabel welcome = new JLabel(\"Input Book Priorities\");\n\n        Font f = new Font(\"Verdana\", Font.BOLD,16);\n        welcome.setForeground(Color.BLACK);\n        welcome.setFont(f);\n        add(label);\n        label.add(welcome);\n\n        GridLayout g1 = new GridLayout(15, 2, 0, 10);\n        setLayout(g1);\n\n        JPanel textfield1 = new JPanel();\n        JLabel userid = new JLabel(\"Please Enter your username:\");\n        txt_mail = new JTextField(20);\n        JLabel lect2 = new JLabel(\"@gmail.com\");\n        add(textfield1);\n        textfield1.add(userid);\n        textfield1.add(txt_mail);\n        textfield1.add(lect2);\n\n\n        JPanel textfield2 = new JPanel();\n        add(textfield2);\n\n        JPanel textfield3 = new JPanel();\n        JLabel lbl1 = new JLabel(\"Set Priority by entering Books' name:\");\n        add(textfield3);\n        textfield3.add(lbl1);\n\n\n        JPanel textfield4 = new JPanel();\n        JLabel lbl2 = new JLabel(\"1st Priority:\");\n        txt_module1 = new JTextField(10);\n        add(textfield4);\n        textfield4.add(lbl2);\n        textfield4.add(txt_module1);\n\n        JPanel textfield5 = new JPanel();\n        JLabel lbl3 = new JLabel(\"2nd Priority:\");\n        txt_module2 = new JTextField(10);\n        add(textfield5);\n        textfield5.add(lbl3);\n        textfield5.add(txt_module2);\n\n\n        JPanel textfield6 = new JPanel();\n        JLabel lbl4 = new JLabel(\"3rd Priority:\");\n        txt_module3 = new JTextField(10);\n        add(textfield6);\n        textfield6.add(lbl4);\n        textfield6.add(txt_module3);\n\n        JPanel textfield7 = new JPanel();\n        JLabel lbl5 = new JLabel(\"4th Priority:\");\n        txt_module4 = new JTextField(10);\n        add(textfield7);\n        textfield7.add(lbl5);\n        textfield7.add(txt_module4);\n\n        JPanel button = new JPanel();\n        confirm = new JButton(\"Confirm\");\n        confirm.setMnemonic('C');\n        confirm.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent e)\n            {\n                confirm.setEnabled(true);\n                }\n        });\n\n\n        Handleraddclassroom h = new Handleraddclassroom();\n        confirm.addActionListener(h);\n\n        button.add(confirm);\n        add(button);\n\n\n    }\n\n\n    public class Handleraddclassroom implements ActionListener{\n        public void actionPerformed(ActionEvent event){\n\n            String name = ((JButton)event.getSource()).getText();\n\n\n            if (name.equals(\"Confirm\")){\n\n                String filename = \"C:/JAVA/book.accdb\";\n                String database = \"jdbc:odbc:booking\";\n\n                if(txt_mail.getText().equals(\"\")){\n                    JOptionPane.showMessageDialog(addpriority.this,\"Your Username Field cannot be blank\");\n\n\n                }\n\n                else{\n\n\n                try {\n                    Class.forName(\"sun.jdbc.odbc.JdbcOdbcDriver\");\n\n                    Connection con = DriverManager.getConnection(database ,\"\",\"\");  //username &amp;password not being used\n\n                    Statement s = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY); //The Result set can now scroll forward and back\n\n\n\n\n                String squery = \"SELECT User_ID FROM bookuser WHERE email_address = '\"+txt_mail.getText()+\"%' \";\n                s.executeQuery(squery);\n\n                String sql = \"INSERT INTO priority VALUES('\" \n\n                    + squery + \"','\"\n                    + txt_book1.getText() + \"','\"\n                    + txt_book2.getText() + \"','\" \n                    + txt_book3.getText() + \"','\"\n                    + txt_book4.getText()+ \"' )\";\n\n                JOptionPane.showMessageDialog(addpriority.this,\"Choice Records Saved.\");\n\n                dispose();\n\n                Mainmenulecturer mml = new Mainmenulecturer();\n\n                s.execute(sql);\n\n                s.close();\n                con.close();\n\n                } catch (Exception e) {System.out.print(\"Error: \" + e);}\n                }\n            }\n        }   \n\n    }\n\n}\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13264168,"title":"Query to delete where id is other than multiple values?","body":"<p>How would I make a query to  delete the column where id is other than multiple values?</p>\n\n<p>I tried</p>\n\n<pre><code>DELETE FROM `Player` WHERE `Player`.`Squad` != 3,\n4,\n8,\n9,\n10,\n11,\n21, \n31,\n36,\n43,\n64,\n65,\n66,\n71,\n74,\n103,\n105,\n154,\n171,\n190;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server-2008","tsql","subquery","cross-join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13263856,"title":"SQL Server subquery in cross join returns error","body":"<p>I have tables <code>A</code>, <code>B</code> and <code>C</code>. Now table <code>A</code> as column <code>A1</code>(Primary Key), table <code>B</code> has column <code>B1</code>(Primary Key) and table <code>C</code> has columns <code>A1</code>(Foreign Key to Table <code>A.A1</code>), <code>B1</code>(Foreign Key to Table <code>B.B1</code>).</p>\n\n<p>Now I'm writing a query which list all rows from <code>A</code> and <code>B</code> and a bit column which will be set to to 1 if a row is found matching in table <code>C</code> otherwise 0.</p>\n\n<pre><code>SELECT \n     ISNULL((SELECT CAST(1 AS BIT) \n             FROM C \n             WHERE C.A1 = A.A1 AND C.B1 = B.B1),0) AS [TAG],\n     A.A1,\n     B.B1\nFROM A CROSS JOIN B\n</code></pre>\n\n<p>This query is producing an <code>Subquery returned more than 1 value.</code> error even though the query has no duplicate rows after combining the <code>A1</code> and <code>B1</code> columns.</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13264140,"title":"Refencing an array element in select Query in PL/SQL","body":"<p>I am writing a Pl/SQl in which I used an array Variable of Length 5.</p>\n\n<p>then I stored all the Column name of another table into the above declared array.\nNow I am looking  for a solution by which I can use the Array element in select Query to fech the data from another table which exactly has the column name.\nLike </p>\n\n<pre><code>arr(1):='Name'\narr(2):='Course'\n</code></pre>\n\n<p>the Query in Pl/Sql should be something like this (for reference only) </p>\n\n<pre><code>select arr(1) from Mttable;\n</code></pre>\n\n<p>==== This generates error when I write the Query in this way</p>\n\n<p>Note- All work should be done in Pl/SQL on Oracle 10g</p>\n\n<p>Please Help.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13263615,"title":"sql error(1242) : sub query returns more than 1 row","body":"<p>i have two tables <code>a_daily</code> and <code>o_daily_lcsgeneration</code>:</p>\n\n<p>i am trying this query : </p>\n\n<pre><code>update a_daily\nset\n  a_daily.Turbine_Generation =  \n   (\n     select sum(o_daily_lcsgeneration.Turbine_Generation) \n     from o_daily_lcsgeneration \n     where o_daily_lcsgeneration.Location = 1 \n     group by o_daily_lcsgeneration.Date\n  ) \n</code></pre>\n\n<p>but received the above error saying sub query more than 1 row</p>\n"},{"tags":["php","sql","sql-server","query"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263569,"title":"Getting only the same result to appear in SQL","body":"<p>This is my code, later I will be putting it into php, but for the time being I am using it in a provided Query tester. We are doing the first degree of kevin bacon instead of the 6th.</p>\n\n<p><strong>My query is as follow:</strong> </p>\n\n<pre><code>SELECT name,year\nFROM actors\nJOIN roles ON roles.actor_id = actors.id\nJOIN movies ON movies.id=roles.movie_id\nWHERE actors.first_name= 'kevin' AND actors.last_name='bacon' OR actors.first_name= 'sean' AND actors.last_name='penn'\nORDER BY movies.name;\n</code></pre>\n\n<p><strong>it results in</strong> </p>\n\n<pre><code>Animal House 1978\nApollo 13 1995 \nFew Good Men, A 1992 \nFootloose 1984 \nHollow Man 2000 \nJFK 1991 \nMystic River 2003 \nMystic River 2003 \nPlanes, Trains &amp; Automobiles 1987 \nStir of Echoes 1999 \n</code></pre>\n\n<p><strong>How do I get it to show only Mystic River?</strong></p>\n"},{"tags":["sql","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13262295,"title":"convert csv to .sql","body":"<p>is there any tool that I can convert my CSV file which contains chinese characters and about 500 records to .sql format? </p>\n\n<p>I have tried Advanced CSV converter but it only allows me to convert 50 records.</p>\n"},{"tags":["sql","db2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13262301,"title":"Sql - add row when not existed","body":"<p>Suppose I have a query that returns result like this:  </p>\n\n<pre><code>Project Year Type Amt\nPJ00001 2012 1    1000\nPJ00001 2012 2    1000\nPJ00001 2011 1    1000\nPJ00002 2012 1    1000\n</code></pre>\n\n<p>What I want: Every Project will have 2 rows of Types for each Year. If the row is not there, add it to the result with Amt = 0.<br>\nFor example:<br>\n- PJ00001 have 2 rows of type 1,2 in 2012 --> OK. But in 2011, it only have 1 row of Type 1 --> We add one row:<code>PJ00001 2011 2 0</code><br>\n- PJ00002 have only 1 row of type 1 --> add:<code>PJ00002 2012 2 0</code>  </p>\n\n<p>Is there a way to easily do it. The only way I know now is to create a view like: PJ_VIEW. And then:</p>\n\n<pre><code>SELECT *\nFROM PJ_VIEW\nUNION ALL\nSELECT t.PROJECT, t.YEAR_NO, 1 AS TYPE_NO, 0 AS AMT\nFROM PJ_VIEW t\nWHERE NOT EXISTS (SELECT 1 FROM PJ_VIEW t2 WHERE t2.PROJECT = t.PROJECT AND t2.YEAR_NO = t.YEAR_NO AND t2.TYPE_NO = 1)\nUNION ALL\nSELECT t.PROJECT, t.YEAR_NO, 2 AS TYPE_NO, 0 AS AMT\nFROM PJ_VIEW t\nWHERE NOT EXISTS (SELECT 1 FROM PJ_VIEW t2 WHERE t2.PROJECT = t.PROJECT AND t2.YEAR_NO = t.YEAR_NO AND t2.TYPE_NO = 2)\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13263698,"title":"Mysql Prepared Statement using same parameter multiple times","body":"<p>I wrote stored procedure like this:</p>\n\n<pre><code>  DELIMITER $$\n   CREATE PROCEDURE searchByTerm(term VARCHAR(300))\n    BEGIN\n    SET @statment = \"Select name,description from products where name like '%?%' OR description like '%?%'\";\n    PREPARE stmt FROM @statment;\n    SET @a = term;\n    SET @b = term;\n    EXECUTE stmt USING @a,@b;\n    DEALLOCATE PREPARE stmt; \n  END$$\n</code></pre>\n\n<p>calling it as :</p>\n\n<pre><code>CALL searchByTerm('xyz');\n</code></pre>\n\n<p>it results in following error:</p>\n\n<pre><code>Error Code : 1210\nIncorrect arguments to EXECUTE\n</code></pre>\n\n<p>Am i doing anythng wrong? I know it can be done with concat statement but why it's not working like this? Can't i use same parameter multiple times? Thanks for any help..</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13177874,"title":"combine multiple rows int one row with many to many","body":"<p>Using SQL Server I have the following tables/ data</p>\n\n<p><strong>CUS_VISIT</strong></p>\n\n<pre><code>Cus_ID    Cus_Vis_ID\n1           01\n1           02\n2           01\n</code></pre>\n\n<p>and</p>\n\n<p><strong>CUS_EVENT</strong></p>\n\n<pre><code>Cus_Event_ID    Cus_ID    Cus_Vis_ID\n001               1            01\n002               1            01\n</code></pre>\n\n<p>and</p>\n\n<p><strong>CUS_XREF</strong></p>\n\n<pre><code>Cus_ID    Cus_Event_ID    Cus_Prt_ID    Cus_Seq_No\n1            001               1           1\n1            001               2           1\n</code></pre>\n\n<p>and</p>\n\n<p><strong>CUS_PRT</strong></p>\n\n<pre><code>Cus_ID    Cus_Prt_ID    Prt_Cd\n1            1            1A\n1            2            2A\n</code></pre>\n\n<p>I have tried numerous queries but didn't include them as i thought it would confuse things... most of them have used the xml path functionality but to no avail (i haven't been trying pivot since there is a massive list of codes).</p>\n\n<p>I am trying to get the following</p>\n\n<pre><code>SQL RESULTS\n\nCus_ID     Prt_Cd     Cus_Vis_ID\n1           1A,2A        1\n</code></pre>\n\n<p>what I end up with is</p>\n\n<pre><code>SQL RESULTS\n\nCus_ID     Prt_Cd     Cus_Vis_ID\n1           1A           1\n1           2A           1\n</code></pre>\n\n<p>The tables are linked by ...</p>\n\n<pre><code>CUS_VISIT.Cus_ID    = CUS_EVENT.Cus_ID \nCUS_VISIT.Cus_Vis_ID  = CUS_EVENT.Cus_Vis_ID\nCUS_VISIT.Cus_ID = CUS_XREF.Cus_ID\nCUS_EVENT.Cus_Event_ID = CUS_XREF.Cus_Event_ID    \nCUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID \nCUS_XREF.Cus_ID = CUS_PRT.Cus_ID \n</code></pre>\n\n<p>I can almost get what I am after if I drop the <code>CUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID</code> \njoin but then I get all of the part codes (<code>Prt_Cd</code>) for the customer not just the ones for that visit. </p>\n\n<p>If it would help to see my unsuccessful queries or if I have left anything out sorry just let me know. Thanks for any help.</p>\n\n<p>--</p>\n\n<p>here is my subquery</p>\n\n<pre><code>stuff((\n                  select ',' + B.prt_cd\n                    from CUS_PRT B \n                    WHERE B.prt_cd = XREF.prt_cd  -- this is killing me\n                    and XREF.cus_id=B.cus_id and \n                    -- some extra criteria i need but didn't think involved in my issue\n                    B.prt_typ='1'  \n                    and B.valid_entry='Y' and B.cur_entry_ind='Y'\n                    for xml path('')),1,1,'')\n</code></pre>\n\n<p>here is my latest attempt. I added a new post because I didn't realize an edit would move it to the top of the list again... I think i need another subquery somewhere but not sure where and how to tie it to the other two queries.</p>\n\n<pre><code>select distinct CUS_EVENT.cus_id, CUS_EVENT.cus_visit_id,\n    (Select CUS_PRT.prt_cd + ',' AS [text()]\n    From CUS_PRT, CUS_XREF\n    where \n    CUS_EVENT.cus_id=XREF.cus_id\n    and CUS_EVENT.cus_event_id = XREF.cus_event_id \n    and CUS_XREF.cus_id=CUS_PRT.cus_id \n    and CUS_XREF.cus_prt_id = CUS_PRT.cus_prt_id \n    and CUS_XREF.prt_seq_no ='1'\n    order by CUS_PRT.prt_cd\n    for XML PATH('')) [Codes]\nfrom CUS_EVENT\n</code></pre>\n"},{"tags":["sql","oracle","parameterized"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":723,"score":6,"question_id":7383121,"title":"Embedded SQL vs Dynamic SQL","body":"<p>I am currently doing a *cough*Oracle*cough* database subject. The lecturer is introducing <a href=\"http://en.wikipedia.org/wiki/Embedded_SQL\" rel=\"nofollow\">embedded SQL</a> as the way you get other languages (e.g. C, C++) to interact with the (Oracle) database.</p>\n\n<p>I have done some database work myself (on mysql) where I use dynamic sql.</p>\n\n<p>As embedded SQL seems to be limited to a few Oracle and a few others, so is this more an attempt at lock-in, or is there real value in embedded SQL?</p>\n\n<p><strong>Edit:</strong> I just realized that the fact this lesson was right after a lesson on PL/SQL may be important.</p>\n\n<p><strong>Original question</strong> asked about parameterized SQL (now replaced by \"dynamic sql\" to improve question).</p>\n\n<p><strong>Aside:</strong> I am thinking that the ~$30 \"SQL and relational theory\" book I bought is teaching me more than this database class. </p>\n"},{"tags":["sql","sql-server","sql-server-2008","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13261497,"title":"incorrect syntax near in creating stored procedure on a remote db","body":"<p>I am trying to recreate a stored procedure on a database which is hosted on a remote server.\nWhen creating the same SP locally I don't get any errors but when I am trying to create the SP on the remote server I am getting this errors:</p>\n\n<pre><code>Msg 102, Level 15, State 1, Procedure MySP, Line 26\nIncorrect syntax near 'MERGE'.\nMsg 102, Level 15, State 1, Procedure MySP, Line 27\nIncorrect syntax near 'S'.\n</code></pre>\n\n<p>Those errors are repeating in multiple SP and I didn't get them when I created the SP's on my local server.\nAny idea what can that be?\nHere is a sample SP:</p>\n\n<pre><code>USE [MyDatabase]\nGO\n/****** Object:  StoredProcedure [dbo].[InsertContractorInfo]    Script Date: 11/07/2012 01:08:31 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n-- =============================================\n-- Author:      &lt;Author,,Name&gt;\n-- Create date: &lt;Create Date,,&gt;\n-- Description: &lt;Description,,&gt;\n-- =============================================\n--exec [dbo].[InsertContractorInfo] \nCREATE PROCEDURE [dbo].[InsertContractorInfo]\n(@CompanyName nvarchar(50), \n @LicenseNumber nvarchar(50),\n @MailingAddress1 nvarchar(200),\n @MailingAddress2 nvarchar(200),\n @Phone nvarchar(10),\n @Fax nvarchar(10),\n @Mobile nvarchar(10),\n @Email nvarchar(200),\n @PercentCommercial int,\n @PercentResidental int,\n @TotalEmployees int,\n @AnnualSales decimal(18,2),\n @InsuranceCompanyContact nvarchar(100)=null,\n @InsuranceCompanyContactEmail nvarchar(100)=null,\n @InsuranceCompanyContactPhone nvarchar(100)=null,\n @ContractorID uniqueidentifier)\nAS\nBEGIN\nMERGE dbo.Contractor con\nUSING(SELECT 1 S) S\nON con.Oid = @ContractorID\nWHEN MATCHED THEN UPDATE \n   SET       \n      [CompanyName] = @CompanyName      \n      ,[LicenseNumber] = @LicenseNumber\n      ,[MailingAddress1] = @MailingAddress1\n      ,[MailingAddress2] = @MailingAddress2\n      ,[Phone] = @Phone\n      ,[Fax] = @Fax\n      ,[EMail] =@Email\n      ,[Mobile] =@Mobile      \n      ,[PercentCommercial] = @PercentCommercial\n      ,[PercentResidental] = @PercentResidental\n      ,[TotalEmployees] = @TotalEmployees\n      ,[ApproximateAnnualSales] = @AnnualSales      \n      ,[InsuranceCompanyContact] = @InsuranceCompanyContact\n      ,[InsuranceCompanyContactPhone] = @InsuranceCompanyContactPhone\n      ,[InsuranceCompanyContactEmail] = @InsuranceCompanyContactEmail      \nWHEN NOT MATCHED THEN\nINSERT \n           ([Oid]       \n           ,[CompanyName]           \n           ,[LicenseNumber]\n           ,[MailingAddress1]\n           ,[MailingAddress2]\n           ,[Phone]\n           ,[Fax]\n           ,[EMail]\n           ,[Mobile]                      \n           ,[PercentCommercial]\n           ,[PercentResidental]\n           ,[TotalEmployees]\n           ,[ApproximateAnnualSales]                      \n           ,[InsuranceCompanyContact]\n           ,[InsuranceCompanyContactPhone]\n           ,[InsuranceCompanyContactEmail])\n     VALUES\n           (@ContractorId           \n           ,@CompanyName           \n           ,@LicenseNumber\n           ,@MailingAddress1\n           ,@MailingAddress2\n           ,@Phone\n           ,@Fax\n           ,@EMail\n           ,@Mobile\n           ,@PercentCommercial\n           ,@PercentResidental\n           ,@TotalEmployees\n           ,@AnnualSales                     \n           ,@InsuranceCompanyContact\n           ,@InsuranceCompanyContactPhone\n           ,@InsuranceCompanyContactEmail\n           );\nEND\nGO\n</code></pre>\n\n<p>Thanks, Laziale</p>\n"},{"tags":["sql","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13252165,"title":"concatenate with 3 or 4 joins","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13177874/combine-multiple-rows-int-one-row-with-many-to-many\">combine multiple rows int one row with many to many</a>  </p>\n</blockquote>\n\n\n\n<p>Using SQL Server I have the following tables/ data</p>\n\n<pre><code>CUS_VISIT\n\nCus_ID    Cus_Vis_ID\n1           01\n1           02\n2           01\n</code></pre>\n\n<p>and</p>\n\n<pre><code>CUS_EVENT\n\nCus_Event_ID    Cus_ID    Cus_Vis_ID\n001               1            01\n002               1            01\n</code></pre>\n\n<p>and</p>\n\n<pre><code>CUS_XREF\n\nCus_ID    Cus_Event_ID    Cus_Prt_ID    Cus_Seq_No\n1            001               1           1\n1            001               2           1\n</code></pre>\n\n<p>and</p>\n\n<pre><code>CUS_PRT\n\nCus_ID    Cus_Prt_ID    Prt_Cd\n1            1            1A\n1            2            2A\n</code></pre>\n\n<p>I am trying to get the following</p>\n\n<p>SQL RESULTS</p>\n\n<pre><code>Cus_ID     Prt_Cd     Cus_Vis_ID\n1           1A,2A        1\n</code></pre>\n\n<p>what I end up with is</p>\n\n<p>SQL RESULTS</p>\n\n<pre><code>Cus_ID     Prt_Cd     Cus_Vis_ID\n1           1A           1\n1           2A           1\n</code></pre>\n\n<p>The tables are linked by ...</p>\n\n<pre><code>CUS_VISIT.Cus_ID    = CUS_EVENT.Cus_ID \nCUS_VISIT.Cus_Vis_ID  = CUS_EVENT.Cus_Vis_ID\nCUS_VISIT.Cus_ID = CUS_XREF.Cus_ID\nCUS_EVENT.Cus_Event_ID = CUS_XREF.Cus_Event_ID    \nCUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID \nCUS_XREF.Cus_ID = CUS_PRT.Cus_ID \n</code></pre>\n\n<p>I can almost get what I am after if I drop the CUS_XREF.Cus_Prt_ID = CUS_PRT.Cus_Prt_ID join but then I get all of the part codes (Prt_Cd) for the customer not just the ones for that visit. </p>\n\n<p>here is what i have</p>\n\n<pre><code>select distinct CUS_EVENT.cus_id, CUS_EVENT.cus_visit_id,\n    (Select CUS_PRT.prt_cd + ',' AS [text()]\n    From CUS_PRT, CUS_XREF\n    where \n    CUS_EVENT.cus_id=XREF.cus_id\n    and CUS_EVENT.cus_event_id = XREF.cus_event_id \n    and CUS_XREF.cus_id=CUS_PRT.cus_id \n    and CUS_XREF.cus_prt_id = CUS_PRT.cus_prt_id \n    and CUS_XREF.prt_seq_no ='1'\n    order by CUS_PRT.prt_cd\n    for XML PATH('')) [Codes]\nfrom CUS_EVENT\n</code></pre>\n\n<p>i made a similar post recently but didn't get any specific help. i think i need another sub-query some where. thanks for looking at this.</p>\n"},{"tags":["sql","sql-server-2008","query","stored-procedures","triggers"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13193745,"title":"update column1 based on another column2 from same table without using trigger","body":"<p>scenario is :\nThere are many columns in my table like Col1 Col2 Col3 Col4.\nI want to set data of Col4 if VALUE of Col1 is changed. On firing update query value of Col1 may or may not change.</p>\n\n<p>I have implemented it through trigger.</p>\n\n<pre><code>Select @ISTDNotPossibleI = I.ISTDNotPossible From inserted i\nSelect @IsTDCompletedD = D.IsTDCompleted from deleted d\n\nIf (\n  (@IsTDCompletedD != @IsTDCompletedI) Or\n  (@ISTDNotPossibleD != @ISTDNotPossibleI) Or\n  (@IsTDDirectD != @IsTDDirectI) Or (\n    @IsTDCompletedD Is Null And\n    @IsTDCompletedI Is Not Null\n  ) Or (\n    @ISTDNotPossibleD Is Null And\n    @ISTDNotPossibleI Is Not Null\n  ) OR (\n    @IsTDDirectD Is Null And\n    @IsTDDirectI Is Not Null\n  )\n)\nBegin\n  Update \n    CRM_CarTDLog \n  Set\n    TDCompletedEventBy = @UpdatedBy,\n    TDCompletedEventOn = GetDate() \n  Where\n    Id = @UpdateID \nEnd\n</code></pre>\n\n<p>Problem is : this field is not likely to be updated regularly. But Col2 and Col3 are likely to be updated frequently. And since update query is being fired on this table frequently the trigger will be  fired frequently too. And it is increasing the overhead without serving any purpose.</p>\n\n<p>I want to solve this without using trigger. Please help me.</p>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13255427,"title":"Replace first Letter in a field Oracle","body":"<p>Hi Guys I have this Table\n<img src=\"http://i.stack.imgur.com/EvXt6.png\" alt=\"My Original table\"></p>\n\n<p>I need to replace the First Letter in ACCT_NAME with the First Name of ACCT_SHORT_NAME. Records like the Higliighted(RAFFMAN) should not be changed. I have tried:</p>\n\n<pre><code>select acct_name, ACCT_SHORT_NAME,replace(acct_name, substr(acct_name, 1, 1),      ACCT_SHORT_NAME)\n from tbaadm.gam where schm_type = 'TDA' and rcre_user_id  = 'SYSTEM' and substr(acct_name,2,1) = ' '\n</code></pre>\n\n<p>I am getting:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Mvl1k.png\" alt=\"Table after select\"></p>\n\n<p>This means that am Picking the whole value in ACCT_SHORT_NAME. WHat is the best way to do what am trying to do?</p>\n"},{"tags":["java","sql","oracle","hql"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13247774,"title":"stuck with the sql / hql query group by","body":"<pre><code>id          device_id   config_status   update_finished\n1           5015001     SUCCESS     11-OCT-2012\n2           5015001     SUCCESS     23-OCT-2012\n3           5015001     PENDING     23-OCT-2012\n4           5015001     PENDING     23-OCT-2012\n5           5016222     PENDING     12-OCT-2012\n6           5016222     PENDING     22-OCT-2012\n</code></pre>\n\n<p>Hi, above is my table with some example data. What I'd like to achieve is to get for each device_id last SUCCESS status (date is in update_finished field) and all PENDING statuses. From the example above the result query should have:</p>\n\n<pre><code>id          device_id   config_status   update_finished\n2           5015001     SUCCESS     23-OCT-2012\n3           5015001     PENDING     23-OCT-2012\n4           5015001     PENDING     23-OCT-2012\n5           5016222     PENDING     12-OCT-2012\n6           5016222     PENDING     22-OCT-2012\n</code></pre>\n\n<p>So that means only the last SUCCESS status by date column update_finished and all PENDING statuses for each device_id.</p>\n\n<p>Currently I'm trying to mess with GROUP BY: <code>SELECT device_id, config_status, max(update_finished) AS \"LastUpdate\"\nfrom config_status WHERE config_status = 'SUCCESS' group by device_id, config_status</code></p>\n\n<p>This returns only the last SUCCESS statuses for each device_id indeed, but it misses the PENDING statuses and it doesn't have <code>id</code> column. If I add <code>id</code> field to the GROUP BY then the grouping would be by <code>id</code> anyway.</p>\n\n<p>Could anyone help me with the proper query? Is it supposed to have subqueries also? In the end I need to have it as HQL, but I think it will be very similar to SQL.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks everybody for helping me out. All these queries work but most fitted my the query provided by @Remigio because it was easiest to transform it into HQL query that returns me parametrized object, not just Object.</p>\n\n<p>Here is my working HQL query with additional fields that I have omitted in my initial example</p>\n\n<pre><code>List&lt;ConfigStatus&gt; statuses = getHibernateTemplate().find(\"select c from ConfigStatus c \" +\n                \"where (configStatus = 'SUCCESS' and updateFinished = (select max(updateFinished) from \" +\n                \"ConfigStatus c1 where c1.device.deviceId = c.device.deviceId and c1.configStatus = 'SUCCESS' and c1.configFile.configFileId = ?)) \" +\n                \"or configStatus = 'PENDING' and configFile.configFileId = ?\", new Object[] {configFileId, configFileId});\n</code></pre>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13262283,"title":"Sql query join if table result is not null","body":"<p>I am trying to get some data from a table and possibly filtering it depending on the result from another query.</p>\n\n<p>The code is something like this:</p>\n\n<pre><code>DECLARE @TestTable  TABLE(TestID INT)\n\nINSERT INTO @TestTable\nSELECT TestID from v_Lookuptable Where SomeID = @input\n\n\nSELECT DISTINCT\nC.[Level],\nC.Name\nFROM\ndbo.CPackage CP \nRight outer join @TestTable TT on TT.TestID = CP.TestID\nWHERE\nAND (TT.TestID is null OR Exists( Select TT.TestID from @TestTable \n                                    inner join dbo.CProduct CP on CP.TestID = MT.TestID\n                                    where TT.TestID = CP.TestID\n                                    ))\n</code></pre>\n\n<p>My problem is that if I pass in my currently scenario the <code>@input</code> as 1, then the top part returns some numbers: 1, 2, 3</p>\n\n<p>But if I pass <code>@input</code> as 2, then the top part returns nothing because nothing matches.</p>\n\n<p>The idea is that if nothing matches, return everything in the bottom query, so from <code>dbo.CPackage</code>, else, only return those things where the <code>TestID</code> match.</p>\n\n<p>I have tried various things like changing the joins, case statements, using <code>ISNULL</code> and <code>collasce</code>. Also I have tried to remove the part <code>TT.TestID is null</code> and it then works if the top table returns something, but when I add it again it returns everything and never filters. So I know the logic is wrong... I just can't figure out the correct logic for this.... :S</p>\n\n<p>Is it possible? I presume it is... </p>\n\n<p>Cheers\nRobin</p>\n\n<p>** Solution **</p>\n\n<p>Remove the join and just put it in the where filter...</p>\n\n<pre><code>SELECT DISTINCT\nC.[Level],\nC.Name\nFROM\ndbo.CPackage CP \n\nWHERE\nCP.TestID = coalesce( (select distinct TestID from v_Lookuptable LT\n        where LT.SomeID =  @input), CP.TestID )\n</code></pre>\n"},{"tags":["sql","db2"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":4494,"score":2,"question_id":1018469,"title":"SQL (DB2) Return multiple conditional counts in a single query","body":"<p>I am trying select multiple conditional summaries into a single table result on a DB2 based database. </p>\n\n<p>Example:</p>\n\n<pre><code>SELECT COUNT(FOO) FROM T1 WHERE T1.A=1 AS A_COUNT,\nSELECT COUNT(FOO) FROM T1 WHERE T1.B=2 AS B_COUNT\nExt...\n</code></pre>\n\n<p>Any help is appreciated. </p>\n"},{"tags":["mysql","sql","relational-database","relation","relational-algebra"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13262481,"title":"Writing a query in strictly relational algebra (AS IN NOT SQL/MYSQL)","body":"<p>So here are three relations:</p>\n\n<p><strong>Table Members</strong></p>\n\n<blockquote>\n  <p>Members(member_id, name, city, state)</p>\n</blockquote>\n\n<p>where member_id is the primary key</p>\n\n<p><strong>Table Borrowed</strong></p>\n\n<blockquote>\n  <p>Borrowed(borrow_id, lib_id, member_id)</p>\n</blockquote>\n\n<p>where borrow_id is the primary key </p>\n\n<p><strong>Table Libraries</strong></p>\n\n<blockquote>\n  <p>Libraries(lib_id, lib_address, lib_city, lib_state)</p>\n</blockquote>\n\n<p>where lib_id is the primary key</p>\n\n<p>Both lib_id and member_id are foreign keys</p>\n\n<p>So I am trying to write a query that finds all of the member_id of members that have borrowed a book at EVERY library in their city. This means that </p>\n\n<pre><code>members.city = libraries.lib_city AND members.state = libraries.lib_state\n</code></pre>\n\n<p>I was thinking about using relational division. For example you have a relation consisting of the member_id's and all of the lib_id where they have borrowed a book. And you divide this by a relation that consists of all of the lib_id in that member's city. </p>\n\n<p>However, I am confused as to how to write this in relational algebraic terms.</p>\n\n<p>In mysql/sql it is very easy but the translation to relational algebra is where I get stuck.</p>\n"},{"tags":["sql","sqlite","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13263045,"title":"Grouping sql statement","body":"<p>I'm using SQLite and have a table like this:</p>\n\n<pre><code>CREATE TABLE stream_activity(\n    id INTEGER PRIMARY KEY,\n    username TEXT,\n    time INTEGER,\n    viewers INTEGER\n);\n</code></pre>\n\n<p>I'm keeping time as a unix timestamp. Now here's what I want to do -- have a table that shows the most viewed streams over the course of an hour (with data recorded every 5 minutes), but also sorted by time ascending and grouped by username, kind of like this (x = now, y = some random value):</p>\n\n<pre>\nTime     Username      Viewers\nx - 1h   GuyOne        y\nx - 55m  GuyOne        y\n....\nx - 5m   GuyOne        \nx        GuyOne        highest_view_count\nx - 1h   GuyTwo\nx - 55m  GuyTwo        y\n....\nx - 5m   GuyTwo        y\nx        GuyTwo        secondhighest_view_count\n</pre>\n\n<p>Also feel free to tell me if it's not possible with sqlite (and what type of sql server can do this)</p>\n"},{"tags":["sql","data-modeling"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":321,"score":1,"question_id":6192396,"title":"Are dimension tables and domain tables the same thing?","body":"<p>I think I know what a domain table is (it basically contains all the possible values that some other column can contain), and I've looked up dimension table in Wikipedia. Unfortunately, I'm having a hard time understanding the description they have there, because they explain it in terms of another piece of jargon: \"fact table\", which is explained to \"consists of the measurements, metrics or facts of a business process.\" To me, that's very tautological, which is <a href=\"http://xkcd.com/703/\" rel=\"nofollow\">not helpful</a>. Can someone explain this in <em>plain English</em>?</p>\n"},{"tags":["php","mysql","sql","phpmyadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13244406,"title":"MySQL Tables for School Website","body":"<p>Right now I have 40+ tables for my website and I don't think I'm using MySQL to it's full power quite right. I am making a website similar to Moodle. It basically just holds tests for students grouped by courses.</p>\n\n<p><strong>Origonal Tables</strong>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>courses - Lists all courses (ID, Name)\nc_$id   - Lists all the Tests (ID, Name, etc) for course number $id\na_$id   - Lists all questions for the test number $id (Question, A, B, C, D)\ng_$id   - Lists all grades for the course with course number $id.\nc_a     - Lists course ID and assignment ID pairs ex: (1,2) (1,3) (2,2) (2,3)\n</code></pre>\n\n<p><strong>Tables Revision 1:</strong>\n</p>\n\n<pre><code>courses   - Lists all courses (ID, Name, etc)\ntests     - Lists all tests (ID, Name, etc)\nquestions - Lists all questions from all tests (ID, Ques, Ans)\ngrades*   - Lists all grades (studentID, courseID, testID, grade)\nstudents* - Lists all students and their courses (StudentID, courseID)\n</code></pre>\n\n<p>The grades* table, it's basically 3 primary keys and a value. Something seems odd about it. Is there a better way? Same goes for the students table. Both are basically connections of the other tables. Primary key for fast searching is not possible?</p>\n\n<p><strong>Origonal Post:</strong></p>\n\n<p>What is the most efficient way to recreate this to utilize the power of MySQL?</p>\n\n<p>As of right now when a new course is made it creates a new table for that course (<code>c_$id</code>), then a table for each assignment and a list of grades for that course <code>g_$id</code>. Then when creating an assignment it creates a new <code>a_$id</code> table,adding that course and assignment pair to <code>c_a</code>.</p>\n\n<p>I have removed the \"<code>*</code>\" from most of my select statements and added \"<code>LIMIT 1</code>\" to any that are selecting a primary key, next is solving this OOP issue.</p>\n"},{"tags":["sql","linq","predicatebuilder"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":35,"score":5,"question_id":13261700,"title":"need help in using predicate builder","body":"<p>I need to know about using predicatebuilder. On almost every example of how to use it, they show the code as follows</p>\n\n<pre><code>    var predicate = PredicateBuilder.True&lt;employee&gt;();\n\n    if(!string.IsNullOrEmpty(txtAddress.Text))\n        predicate = predicate.And(e1 =&gt; e1.Address.Contains(txtAddress.Text));\n    if (!string.IsNullOrEmpty(txtEmpId.Text))\n        predicate = predicate.And(e1 =&gt; e1.Id == Convert.ToInt32(txtEmpId.Text));\n    if (!string.IsNullOrEmpty(txtDesc.Text))\n        predicate = predicate.And(e1 =&gt; e1.Desc.Contains(txtDesc.Text));\n    if (!string.IsNullOrEmpty(txtName.Text))\n        predicate = predicate.And(e1 =&gt; e1.Name.Contains(txtName.Text));\n\n    EmployeeDataContext edb= new EmployeeDataContext();\n    var emp = edb.Employees.Where(predicate);\n    grdEmployee.DataSource = emp.ToList();\n    grdEmployee.DataBind();\n</code></pre>\n\n<p>What is that employee object, the one between the greater than and less than brackets? I have racked my brains on that one. I am using linq to sql entities and I get compile errors when I try this myself. I think the errors are something like, cannot cast from a linq table to . . . I am a beginner. Please forgive me for asking what may be an obvious thing. Thank you.</p>\n\n<p>ed Cohen</p>\n"},{"tags":["sql","database","database-design","sqlite3","one-to-many"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":361,"score":1,"question_id":7541595,"title":"How to create one to many in SQLITE3?","body":"<p>How to create one to many in SQLITE3?\nI have 2 tables:</p>\n\n<pre><code>    Mans:\n   _id   name\n     1    antony\n     2    fred\n</code></pre>\n\n<p>and </p>\n\n<pre><code>       point\n  _id   date   point   \n   1     23     77\n         24     99 \n\n   2     25     78\n          5     0\n</code></pre>\n\n<p>i dont now SQL syntax, help me , please.</p>\n"},{"tags":["sql","database","database-design"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13260262,"title":"Data separated by commas inside a field vs new table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3653462/is-storing-a-comma-separated-list-in-a-database-column-really-that-bad\">Is storing a comma separated list in a database column really that bad?</a>  </p>\n</blockquote>\n\n\n\n<p>This is a problem I often encounter when trying to expand the database.</p>\n\n<p>For example:</p>\n\n<p>I want to keep track of how many users saw a particular article in my website, so in the database I added a <code>views</code> field to the <code>article</code> table. Now, if I wanted to make sure that these are <em>unique</em> views then this is clearly not enough.</p>\n\n<p>So let's say that in my design I can identify a user (or at least a computer) with a single number that's stored along with an IP or something.</p>\n\n<p>Then, if I wanted to keep track of how many <em>unique</em> users saw a particular article which is the best way to go?</p>\n\n<ul>\n<li>To create another table <code>article_views</code> with the fields <code>article_id</code> and\n<code>user_id</code>.</li>\n<li>To save the <code>user_id</code>s separated by commas inside the <code>views</code> field of the <code>article</code> table.</li>\n</ul>\n"},{"tags":["mysql","sql","service","random"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13262068,"title":"Is there / would be feasible a service providing random elements from a given SQL table?","body":"<p><strong>ABSTRACT</strong></p>\n\n<p>Talking with some colleagues we came accross the \"extract random row from a big database table\" issue. It's a classic one and we know the naive approach (<a href=\"http://stackoverflow.com/questions/580639/how-to-randomly-select-rows-in-sql\">also on SO</a>) is usually something like:</p>\n\n<blockquote>\n  <p>SELECT * FROM mytable ORDER BY RAND() LIMIT 1</p>\n</blockquote>\n\n<p><strong>THE PROBLEM</strong></p>\n\n<p>We also know a query like that is utterly inefficient and actually usable only with very few rows. There are some approaches that could be taken to attain better efficiency, like <a href=\"http://stackoverflow.com/questions/211329/quick-selection-of-a-random-row-from-a-large-table-in-mysql\">these ones</a> still on SO, but they won't work with arbitrary primary keys and the <em>randomness</em> will be skewed as soon as you have holes in your numeric primary keys. An answer to the last cited question links to <a href=\"http://jan.kneschke.de/projects/mysql/order-by-rand/\" rel=\"nofollow\">this article</a> which has a good explanation and some bright solutions involving an additional \"equal distribution\" table that must be maintained whenever the \"master data\" table changes. But then again if you have frequent DELETEs on a big table you'll probably be screwed up by the constant updating of the added table. Also note that many solutions rely on <code>COUNT(*)</code> which is ridiculously fast on MyISAM but \"just fast\" on InnoDB (I don't know how it performs on other platforms but I suspect the InnoDB case could be representative of other transactional database systems).</p>\n\n<p>In addition to that, even the best solutions I was able to find are fast but not <em>Ludicrous Speed</em> fast.</p>\n\n<p><strong>THE IDEA</strong></p>\n\n<p>A separate service could be responsible to generate, buffer and distribute random row ids or even entire random rows:</p>\n\n<ul>\n<li>it could choose the best method to extract random row ids depending on how the original PKs are structured. An ordered list of keys could be maintained in ram by the service (shouldn't take too many bytes per row in addition to the actual size of the PK, it's probably ok up to 100~1000M rows with standard PCs and up to 1~10 billion rows with a beefy server)</li>\n<li>once the keys are in memory you have an implicit \"row number\" for each key and no holes in it so it's just a matter of choosing a random number and directly fetch the corresponding key</li>\n<li>a buffer of random keys ready to be consumed could be maintained to quickly respond to spikes in the incoming requests</li>\n<li>consumers of the service will connect and request N random rows from the buffer</li>\n<li>rows are returned as simple keys <em>or</em> the service could maintain a (pool of) db connection(s) to fetch entire rows</li>\n<li>if the buffer is empty the request could block or return EOF-like</li>\n<li>if data is added to the master table the service must be signaled to add the same data to its copy too, flush the buffer of random picks and go on from that</li>\n<li>if data is deleted from the master table the service must be signaled to remove that data too from both the \"all keys\" list and \"random picks\" buffer</li>\n<li>if data is updated in the master table the service must be signaled to update corresponding rows in the key list and in the random picks</li>\n</ul>\n\n<p><strong>WHY WE THINK IT'S COOL</strong></p>\n\n<ul>\n<li>does not touch disks other than the initial load of keys at startup or when signaled to do so</li>\n<li>works with any kind of primary key, numerical or not</li>\n<li>if you know you're going to update a large batch of data you can just signal it when you're done (i.e. not at every single insert/update/delete on the original data), it's basically like having a fine grained lock that only blocks requests for random rows</li>\n<li>really fast on updates of any kind in the original data</li>\n<li>offloads some work from the relational db to another, memory only process: helps scalability</li>\n<li>responds really fast from its buffers without waiting for any querying, scanning, sorting</li>\n<li>could easily be extended to similar use cases beyond the SQL one</li>\n</ul>\n\n<p><strong>WHY WE THINK IT COULD BE A STUPID IDEA</strong></p>\n\n<ul>\n<li>because <em>we</em> had the idea without help from any third party</li>\n<li>because nobody (we heard of) has ever bothered to do something similar</li>\n<li>because it adds complexity in the mix to keep it updated whenever original data changes</li>\n</ul>\n\n<p><strong>AND THE QUESTION IS...</strong></p>\n\n<p>Does anything similar already exists? If not, would it be feasible? If not, why?</p>\n"},{"tags":["php","mysql","sql","pdo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13244328,"title":"Updating a MySQL database via PDO and tokens - all parameters being set to last value in dataset","body":"<p>As the title states: I am trying to update specific records in a MySQL data base using PDO and tokens to secure against any injection.</p>\n\n<p>Here is my code:</p>\n\n<p>Some arrays to help build the query:</p>\n\n<pre><code>$id = 1234\n$values = array ('a','b','c',);\n$variables = array ($A, $B, $C);\n</code></pre>\n\n<p>The query built via loop:</p>\n\n<pre><code>$sql =  \"UPDATE table1 SET \";   \n        foreach($values as $value)\n        {\n        $sql .=\"$value = :$value, \";\n        }\n        $sql = rtrim($sql,', ');    \n        $sql .=\" WHERE id = '$id'\";\n</code></pre>\n\n<p>Execution of query via PDO:</p>\n\n<pre><code>try     \n{\n$pdo = new PDO('mysql:host=localhost; dbname=db01', $username, $password);\n$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n$stmt = $pdo-&gt;prepare($sql);\nforeach(array_combine($values, $variables) as $value=&gt;$variable)\n{\n$stmt-&gt;bindParam(\":$value\", $variable);\n}\n\n$stmt-&gt;execute();\n</code></pre>\n\n<p>The result:\nEvery field in the specified record (matching $id) is set to the same value, which is always equal to the contents of the last variable listed in the array (in this example they would all contain the value held in $C)</p>\n\n<p>echoing the SQL query shows it has been constructed correctly.</p>\n\n<p>Any ideas? Thanks for your consideration</p>\n"},{"tags":["sql","database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":18,"score":-2,"question_id":13262161,"title":"Good online resources to learn about databases","body":"<p>Do you know good online resources to learn about databases?</p>\n\n<ul>\n<li>The different types of DBs (relational, object, etc...) and the\ntheory behind DBs structures/models. </li>\n<li>How to choose? Best for REST? </li>\n<li>Comparison between couchDB, mongoDB, D3, PostgresSQL, MySQL and\nother.</li>\n</ul>\n\n<p>I found many interesting things out there, but I thought it might be worth it to ask, to see what experienced programmers would recommend. Thanks in advance.</p>\n"},{"tags":["sql","sql-server-2008","locking"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":120,"score":0,"question_id":6745120,"title":"Creation time of a lock in SQL Server 2008","body":"<p>So I'm trying to monitor the longest living lock in my database. The idea is that if a lock has been held for a certain amount of time, I will receive a warning in my application.</p>\n\n<p>But for the life of I can't find the creation time of the locks.</p>\n\n<p>I have used:</p>\n\n<pre><code>exec msdb..sp_lock\nexec msdb..sp_who2\nSELECT * FROM sys.dm_tran_locks\nselect * from sys.syslockinfo\nselect cmd, * from sys.sysprocesses where blocked &gt; 0\n</code></pre>\n\n<p>But none of these seem to have the information I need.</p>\n\n<p>Any ideas?</p>\n\n<p>G</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13261674,"title":"insert data from a table to another table sorted by column","body":"<p>There is a temp table <code>TMP_OA_PSTN_CMP_11035</code> with fields:</p>\n\n<pre><code>ACTION_OBJID NUMBER,\nCONTRACT_OBJID NUMBER,\nSTATUS varchar2(40),\nUPDATE_DATE DATE\n</code></pre>\n\n<p>This contains 7 million data.i want to create seven different temp tables with data from TMP_OA_PSTN_CMP_11035 sorted by action_objid and each containing  1 million records. <strong>The column ACTION_OBJID is not a sequence .</strong></p>\n\n<p>I tried using rownum but that inputs random  data.</p>\n\n<p>For EG:</p>\n\n<p>Temp1 : data containing action_objid from 5 ,8...to 1100000(as action_objid is not a sequence,this much is 1 million data).\nSimilarly, for other 6 temp tables.\nI am using oracle 10g.</p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13261071,"title":"Where clause on subquery statement in select","body":"<p>Let's say I have a query like this:</p>\n\n<pre><code>   Select col1, \n          col2, \n          (select count(smthng) from table2) as 'records'\n   from table1\n</code></pre>\n\n<p>I want to filter it to be not null for 'records' column.</p>\n\n<p>I cannot do this:  </p>\n\n<pre><code>         Select col1, \n                col2, \n               (select count(smthng) from table2) as 'records'\n          from table1\n        where records is not null  \n</code></pre>\n\n<p>The best I came up with is to write this resultset to a Table Value parameter and have a separate query on that resultset. Any ideas?</p>\n"},{"tags":["sql","installer","localdb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13142160,"title":"Way to deploy VS2010 WinForms application with SQL 2012 LocalDb with VS 2010 Installer","body":"<p>Is there a reference on creating a Visual Studio 2010 Installer project for a WinForms application that uses SQL 2012 LocalDb?</p>\n"},{"tags":["mysql","sql","sql-order-by","order","union"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13261113,"title":"mysql order by and union and parentheses","body":"<p>so I have a query like this:</p>\n\n<pre><code>(SELECT last_updated FROM ...) UNION (SELECT last_updated FROM ...) ORDER BY last_updated\n</code></pre>\n\n<p>Notice that the ORDER BY statement is outside both parentheses...When I run the query it appears that it does a combined order by last_updated (which is what I want to do). IE. it took the combined unioned result set and order them all by last_updated as a single set.</p>\n\n<p>However, I want to confirm that this is indeed what this will do, so does anyone have any link to some docs that confirm that this will indeed happen? Can anyone confirm for a FACT that this will indeed happen if you perform the query this way? </p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1523,"score":2,"question_id":2561130,"title":"Merge overlapping date intervals","body":"<p>Is there a better way of merging overlapping date intervals?<br>\nThe solution I came up with is so simple that now I wonder if someone else has a better idea of how this could be done.</p>\n\n<pre><code>/***** DATA EXAMPLE *****/\nDECLARE @T TABLE (d1 DATETIME, d2 DATETIME)\nINSERT INTO @T (d1, d2)\n        SELECT '2010-01-01','2010-03-31' UNION SELECT '2010-04-01','2010-05-31' \n  UNION SELECT '2010-06-15','2010-06-25' UNION SELECT '2010-06-26','2010-07-10' \n  UNION SELECT '2010-08-01','2010-08-05' UNION SELECT '2010-08-01','2010-08-09' \n  UNION SELECT '2010-08-02','2010-08-07' UNION SELECT '2010-08-08','2010-08-08' \n  UNION SELECT '2010-08-09','2010-08-12' UNION SELECT '2010-07-04','2010-08-16' \n  UNION SELECT '2010-11-01','2010-12-31' UNION SELECT '2010-03-01','2010-06-13' \n\n/***** INTERVAL ANALYSIS *****/\nWHILE (1=1)  BEGIN\n  UPDATE t1 SET t1.d2 = t2.d2\n  FROM @T AS t1 INNER JOIN @T AS t2 ON \n            DATEADD(day, 1, t1.d2) BETWEEN t2.d1 AND t2.d2 \n  IF @@ROWCOUNT = 0 BREAK\nEND\n\n/***** RESULT *****/\nSELECT StartDate = MIN(d1) , EndDate = d2\nFROM @T\nGROUP BY d2\nORDER BY StartDate, EndDate\n\n/***** OUTPUT *****/\n/*****\nStartDate   EndDate\n2010-01-01  2010-06-13 \n2010-06-15  2010-08-16 \n2010-11-01  2010-12-31 \n*****/\n</code></pre>\n"},{"tags":["sql","increment"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13260813,"title":"Limitations on incrementing values (standard sql)","body":"<p>Given a table of students and grades, is there a way to increment each student's grade by 10%,  but without going over 100?</p>\n\n<p>Right now I do </p>\n\n<pre><code>UPDATE studentCourse\nSET grade = grade + 10 * (grade/100) \nWHERE csid = 1\n</code></pre>\n\n<p>In other words, if a student has 60, after the update he should have 66. But if a student has a 98, after the update his grade should be 100 (and not 108).</p>\n\n<p>All this has to be done in standard SQL</p>\n"},{"tags":["sql","visual-studio","encryption","ssdt"],"answer_count":1,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":37,"score":4,"question_id":13256026,"title":"Stored procedure ENCRYPTION option depending on build mode","body":"<p>I'm working on stored procedures encryption in enterprise project. We have a bunch of SP's that should be protected on production.<br> \nThere is no problem to set <code>WITH ENCRYPTION</code> parameter in each SP that is in <code>sqlproj</code>. But I want to make this directive optional: if I'm building project in debug mode - do not apply this procedure option, otherwise - use it. Actually main goal here is to get database for developers without encryption, but on production - encrypted SP's. \n<br>Using <code>PowerShell</code> script in build task I can modify generated sql file and as a result get script with encryption parameter, but I'm wondering how it would work with <code>dacpac</code>.<br>\nAny suggestions? </p>\n"},{"tags":["mysql","sql","perl","relationship"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13259737,"title":"Perl/MySQL Relationship Query","body":"<p>I have the following perl code that will eventually be a webpage:</p>\n\n<pre><code>my($dbh) = DBI-&gt;connect(\"DBI:mysql:host=dbsrv;database=database\",\"my_sqlu\",\"my_sqlp\") or die \"Canny Connect\";\nmy($sql) = \"SELECT * FROM hardware where srv_name = \\\"$srv_name\\\"\";\nmy($sth) = $dbh-&gt;prepare($sql);\n$sth-&gt;execute();\n\n$sth-&gt;bind_col( 1, \\my($db_id));\n$sth-&gt;bind_col( 2, \\my($db_srv_name));\n$sth-&gt;bind_col( 5, \\my($db_site));\n$sth-&gt;fetchrow();\n$sth-&gt;finish ();\nmy($sql) = \"SELECT sites.\\`site_code\\`, sites.\\`long_name\\` FROM \\`hardware\\` JOIN \\`sites\\` ON \\`sites\\`.id=\\`hardware\\`.\\`site\\` where \\`hardware\\`.\\`id\\`=\\'$db_id\\'\";\nmy($sth) = $dbh-&gt;prepare($sql);\n$sth-&gt;execute();\n$sth-&gt;bind_col( 1, \\my($db_site_code));\n$sth-&gt;bind_col( 2, \\my($db_long_name));\n$sth-&gt;fetchrow();\n$sth-&gt;finish ();\n$dbh-&gt;disconnect;\nprint \"$db_site_code&lt;br&gt;$db_long_name\";\n</code></pre>\n\n<p>The query above does work however what I'm trying to find out is there any way I can run one SQL query and get the db_site_code and db_long_name from the sites DB without running the 2nd query? The hardware DB has the foreign key 'id' in the sites Db.</p>\n\n<p>When you read anything about relational DBs they all say it's by far the most efficient method of getting data from your database but I just can't see how this is any quicker than just running 2 select queries. What I've done above would surely take longer than <code>\"select from hardware where srv_name = $srv_name\"</code> then <code>\"select from sites where id = db_site_id\"</code>? Any comments are greatly appreciated.</p>\n"},{"tags":["mysql","sql","sharding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12997895,"title":"Sharding and ID generation as instagram","body":"<p>My question is regarding ID generation for sharded environment. I am following the same steps as <a href=\"http://instagram-engineering.tumblr.com/post/10853187575/sharding-ids-at-instagram\" rel=\"nofollow\">instagram did</a> for generating unique ids. I have a few question on the implementation of this id generation in MySQL.</p>\n\n<p>This is how the ID is being generated (This is a PGQL stored procedure.)</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION insta5.next_id(OUT result bigint) AS $$\nDECLARE\n    our_epoch bigint := 1314220021721;\n    seq_id bigint;\n    now_millis bigint;\n    shard_id int := 5;\nBEGIN\n    SELECT nextval('insta5.table_id_seq') %% 1024 INTO seq_id;\n\n    SELECT FLOOR(EXTRACT(EPOCH FROM clock_timestamp()) * 1000) INTO now_millis;\n    result := (now_millis - our_epoch) &lt;&lt; 23;\n    result := result | (shard_id &lt;&lt; 10);\n    result := result | (seq_id);\nEND;\n$$ LANGUAGE PLPGSQL;\n\n\n\nCREATE TABLE insta5.our_table (\n    \"id\" bigint NOT NULL DEFAULT insta5.next_id(),\n    ...rest of table schema...\n)\n</code></pre>\n\n<p><strong>MY question is</strong> how can I do that in MySQL (equivalent code).  This stored procedure should be called from a query to get the next id.</p>\n\n<p><strong>My other question</strong> is regarding querying the shards.  From what I understand they use logical shards that are maps to actual servers. If they decide to map a logical shard to a new server, this means that they have to query two servers at the same time to aggregate the results, because before they assigned a new server for the same logical shard, some data was added to the older server. I just wanted to know if there's a better way to use logical shards and having the option to query a single server where the data resides instead of querying all the servers that are and were belong to that logical shard?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","gaps-and-islands"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13260329,"title":"Break a single record into multiple","body":"<p>Usually this works the other way around, but I'd like to break single records into multiple records through SQL.</p>\n\n<p>We store a range of with a begin and end date, but are needing to export a record for each year in the range. </p>\n\n<p>Example: <code>TECH_ID</code> has a <code>begin_date</code> of 2009 and <code>end_date</code> of 2011. We need to export 3 records of 2009, 2010, and 2011.</p>\n\n<p>How can this be accomplished?</p>\n"},{"tags":["sql","postgresql","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13260218,"title":"Creating a Trigger To Delete Records","body":"<p>I have a table which we can call decks. Decks has an id used as its primary key along with some other attributes. The cards table contains a foreign key reference to the deck id and has a primary key of cardid as well. Another table exists called answers where its foreign key is the cardid. </p>\n\n<p>So in order to delete from decks, the database requires I delete from answers first, then cards, and then finally from decks. </p>\n\n<p>I would like to create a trigger which takes care of the first and second delete so that I only have to specify a delete statement from the decks table to completely destroy a deck.</p>\n\n<p>Below is an example PostgreSQL trigger I've found, but I am not sure if its even possible to do what I am asking as I can find no examples online of anyone creating a trigger this way.</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION autoCalculate() RETURNS TRIGGER AS $$\n        BEGIN\n\n        IF NEW.wins &lt; 0 THEN\n                RAISE EXCEPTION 'Wins cannot be negative';\n        END IF;\n\n        IF(OLD.wins &lt;&gt; NEW.wins_ OR (OLD.losses &lt;&gt; NEW.losses) THEN\n                NEW.Winning_Percentage := calc_winning_percentage(NEW.Wins, NEW.Losses);\n        END IF\n\n        RETURN NEW;\n        END;\n$$ LANGUAGE plpgsql;\n\nDROP TRIGGER update_winning_percentage ON standings;\nCREATE TRIGGER update_winning_percentage BEFORE INSERT OR UPDATE ON standings\nFOR EACH ROW EXECUTE PROCEDURE autoCalculate();\n</code></pre>\n\n<p>If anyone has knowledge to do this, if they could nudge me in the right direction or provide an example of how to do this I'd be grateful!</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13259913,"title":"Using Sum() with multiple where clauses","body":"<p>I'm pretty new to this, so forgive if this has been posted (I had no idea what to even search on).</p>\n\n<p>I have 2 tables, Accounts and Usage</p>\n\n<pre><code>AccountID  AccountStartDate  AccountEndDate\n-------------------------------------------\n1          12/1/2012         12/1/2013\n2          1/1/2013          1/1/2014\n\n\nUsageId   AccountID EstimatedUsage  StartDate  EndDate\n------------------------------------------------------\n1         1         10              1/1        1/31\n2         1         11              2/1        2/29\n3         1         23              3/1        3/31\n4         1         23              4/1        4/30\n5         1         15              5/1        5/31\n6         1         20              6/1        6/30\n7         1         15              7/1        7/31\n8         1         12              8/1        8/31\n9         1         14              9/1        9/30\n10        1         21             10/1        10/31\n11        1         27             11/1        11/30\n12        1         34             12/1        12/31\n13        2         13              1/1        1/31\n14        2         13              2/1        2/29\n15        2         28              3/1        3/31\n16        2         29              4/1        4/30\n17        2         31              5/1        5/31\n18        2         26              6/1        6/30\n19        2         43              7/1        7/31\n20        2         32              8/1        8/31\n21        2         18              9/1        9/30\n22        2         20             10/1        10/31\n23        2         47             11/1        11/30\n24        2         33             12/1        12/31\n</code></pre>\n\n<p>I'd like to write one query that gives me estimated usage for each month (starting now until the last month that we serve an account) for all accounts being served during that month.</p>\n\n<p>The results would be as follows:</p>\n\n<pre><code>Month-Year     Total Est Usage\n------------------------------\nOct-12            0  (none being served)\nNov-12            0  (none being served)\nDec-12           34  (only accountid 1 being served)\nJan-13           23  (accountid 1 &amp; 2 being served)\nFeb-13           24  (accountid 1 &amp; 2 being served)\nMar-13           51  (accountid 1 &amp; 2 being served)\n...\nDec-13           33  (only accountid 2 being served)\nJan-14           0   (none being served)\nFeb-14           0   (none being served)\n</code></pre>\n\n<p>I'm assuming I need to sum and then do a Group By...but not really sure logically how I'd lay this out.  </p>\n"},{"tags":["sql","query","razor","webmatrix"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12854901,"title":"how to add and divide results from sql queries","body":"<p>I have a database which I am trying to create a webpage summary widget for. I am using MS Webmatrix and razor.</p>\n\n<p>I have several select queries set as variables, then my html asks for their values as a string and displays them. So far so good.<br>\nNow I want to add two results together, then subtract a third. EG: add todays processed orders ( I called it itotl) and todays partly processed orders (ppr) and subtract todays credits (ctotl).<br>\nThus, i want (itotl + ppr) - ctotl.<br>\nIf I try and do this by entering the @itotl and @ppr variables etc in my html, it fails.<br>\nThere will be a simple, industry best practice way to do it but I'm only learning, and the hard way at that!</p>\n\n<p>Any Suggestions? I can paste the whole code in here if it will help.\nHere:<br>\n<code>@{<br>\n    Layout = \"~/_SiteLayout.cshtml\";<br>\n    Page.Title = \"SCOREBOARD\";<br>\n    var db = Database.Open(\"data\");<br>\n    var itot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and SUBTOTAL &gt;0\");<br>\n    var isum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.DR_TRANS where TRANSDATE = 41192 and Subtotal &gt;0\");<br>\n    var qsum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Subtotal &gt;0\");<br>\n    var ppr = db.QueryValue(\"select sum(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0 and status = 1\");<br>\n    var psum = db.QueryValue(\"SELECT COUNT(subtotal) from dbo.SALESORD_HDR where ORDERDATE = 41192 and Status =1\");<br>\n    var qtot = db.QueryValue(\"SELECT SUM(SUBTOTAL) FROM dbo.SALESORD_HDR where ORDERDATE = 41192 and SUBTOTAL  &gt;0\");<br>\n    var ctot = db.QueryValue(\"SELECT SUM(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    var csum = db.QueryValue(\"SELECT COUNT(SUBTOTAL) from dbo.DR_TRANS where TRANSDATE = 41192 and TRANSTYPE = 1 and SUBTOTAL &lt;0\");<br>\n    &lt;META HTTP-EQUIV=\"REFRESH\" CONTENT=\"15\"&gt;&lt;/META&gt;;<br>\n}</code>\n<code>&lt;!DOCTYPE html&gt;</code></p>\n\n<p><code>&lt;html lang=\"en\"&gt;</code>\n   <code>&lt;head&gt;<br>\n        &lt;meta charset=\"utf-8\" /&gt;<br>\n        &lt;title&gt;&lt;/title&gt;<br>\n        &lt;style&gt;<br>\n            .column1 {color: blue; font-weight: bold; font-size: 1.6em;}<br>\n            .column2 {color: red;}<br>\n        &lt;/style&gt;<br>\n    &lt;/head&gt;<br>\n    &lt;body&gt;<br>\n        &lt;p&gt;@qsum.ToString() Quotes:<br>\n            &lt;span class=@(qtot &gt; 20000 ? \"column1\" : \"column2\")&gt;@qtot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@psum.ToString() Partly Processed:<br>\n            &lt;span class=@(ppr &gt; 18000 ? \"column1\" : \"column2\")&gt;@ppr.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@isum.ToString() Invoices:<br>\n            &lt;span class=@(itot &gt; 18000 ? \"column1\" : \"column2\")&gt;@itot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;@csum.ToString() Credits:<br>\n            &lt;span class=@(ctot &gt; 18000 ? \"column1\" : \"column2\")&gt;@ctot.ToString(\"C\")&lt;/span&gt;<br>\n        &lt;/p&gt;<br>\n        &lt;p&gt;Nett Sales:&lt;/p&gt;<br>\n    &lt;/body&gt;<br>\n&lt;/html&gt;</code>  </p>\n\n<p>How do I get my markup to show tidily in stack? This has rendered a little hard to read!</p>\n"},{"tags":["php","sql","cookies","registration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13259966,"title":"Create a random, sequenced id based on cookie session?","body":"<p>I have a user sign up or registration form to allow guests to my site become registered members. The form consists of first name, last name, email etc, the action goes to process_reg.php on submit.</p>\n\n<p>The information is then inserted into an sql table 'ptb_registrations'. but it doesn't work yet because i am trying to randomly generate a new user id with the form from a cookie session. I'm not sure if what i'm doing is right. can people please correct me where I'm wrong or point me in the right direction. Thanks.</p>\n\n<p>here's my script for process_reg.php:</p>\n\n<pre><code>&lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\n?&gt;\n&lt;?php \n\nsession_start();\n\ninclude '_config/connection.php'; \n\n\nfunction get_user_id() {\n    global $connection;\n    global $email;\n    $query = \"SELECT *\n                FROM ptb_registrations\n                WHERE email = \\\"$email\\\"\n                \";\n        $user_id_set = mysql_query($query, $connection);\n        confirm_query($user_id_set);\n        return $user_id_set;\n        }\n?&gt;\n&lt;?php\n$user_id_set = get_user_id();\nwhile ($user_id = mysql_fetch_array($user_id_set)) {\n    $cookie1 = \"{$user_id[\"id\"]}\";\n    setcookie(\"ptb_registrations\", $cookie1, time()+3600);  /* expire in 1 hour */\n\n}\n?&gt;\n&lt;?\n\n$first_name = $_POST['first_name'];\n$last_name = $_POST['last_name'];\n$email = $_POST['email'];\n$display_name = $_POST['display_name'];\n$date_of_birth = $_POST['date_of_birth'];\n$contact_number = $_POST['contact_number'];\n$station = $_POST['station'];\n$hobbies = $_POST['hobbies'];\n$gender = $_POST['gender'];\n$password = $_POST['password'];\n\n\n\n\n\n\n\n\n$result = mysql_query(\"SELECT first_name FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT last_name FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT display_name FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT email FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT contact_number FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT date_of_birth FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT hobbies FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT station FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT gender FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n$result = mysql_query(\"SELECT password FROM ptb_registrations WHERE id=\".$cookie1['user_id'].\"\");\n\n\n\n\n\n\nif(!$result) \n{ \necho \"The username you entered does not exist\"; \n} \nelse \nif($email!= mysql_result($result, 0)) \n{ \necho \"\"; \n\n\n    $sql=mysql_query(\"INSERT ptb_registrations SET first_name='$first_name' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET last_name='$last_name' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET display_name='$display_name' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET email='$email' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET contact_number='$contact_number' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET date_of_birth='$date_of_birth' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET hobbies='$hobbies' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET station='$station' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET gender='$gender' WHERE id=\".$cookie1['user_id'].\"\"); \n    $sql=mysql_query(\"INSERT ptb_registrations SET password='$password' WHERE id=\".$cookie1['user_id'].\"\"); \n\n\n}\n    if($sql) \n    { \n    echo \"&lt;div class=\\\"infobox-profile\\\"&gt; &lt;strong&gt;Thank You&lt;/strong&gt; - We have received your registration details.&lt;/div&gt;\"; \n    }\nelse\n{ \necho \"&lt;div class=\\\"infobox-profile\\\"&gt; &lt;strong&gt;Oooops!&lt;/strong&gt; - Something went wrong. &lt;a href=\\\"../edit_contact_number.php\\\"&gt;Click here&lt;/a&gt; to try again.&lt;/div&gt;\"; \n}  \n?&gt;\n&lt;? ob_flush(); ?&gt;\n\n&lt;style&gt;\n.infobox-profile {\n    background-color: #e1e0f7;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 14px;\n    color: #181469;\n    padding-top: 20px;\n    padding-right: 10px;\n    padding-bottom: 20px;\n    padding-left: 70px;\n    margin-bottom: 20px;\n    background-image: url(../img/icons/info-icon.png);\n    background-repeat: no-repeat;\n    background-position: 15px center;\n    border-top-width: 1px;\n    border-top-style: solid;\n    border-top-color: #8f8fdb;\n    border-right-width: 1px;\n    border-bottom-width: 1px;\n    border-left-width: 1px;\n    border-right-style: solid;\n    border-bottom-style: solid;\n    border-left-style: solid;\n    border-right-color: #8f8fdb;\n    border-bottom-color: #8f8fdb;\n    border-left-color: #8f8fdb;\n    border-radius: 4px;\n    width: 385px;\n    margin-left:8px;\n}\n&lt;/style&gt;\n</code></pre>\n"},{"tags":["python","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13254268,"title":"Split column defintions of SQL create table query","body":"<p>I want to split all column definitions of a sql query into seperate strings. </p>\n\n<p>So:</p>\n\n<pre><code> `citizen_group` int(10) NOT NULL,\n  `container_group` int(10) NOT NULL,\n  PRIMARY KEY (`citizen_group`,`container_group`),\n  KEY `fk_containergroup_readeraccess` (`container_group`)\n</code></pre>\n\n<p>Into:</p>\n\n<pre><code>['`citizen_group` int(10) NOT NULL', '`container_group` int(10) NOT NULL','PRIMARY KEY (`citizen_group`,`container_group`)',' KEY `fk_containergroup_readeraccess` (`container_group`)']\n</code></pre>\n\n<p>First I used <code>split(',')</code>. But this gives a problem when the sql has a multicolumn primary key. I cannot expect that each definition is on a new line, so I can't split on newlines. </p>\n\n<p>How can I split these column definitions?</p>\n"},{"tags":["mysql","sql","triggers","cascade"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13259887,"title":"trigger called on cascade : MYSQL","body":"<p>I have one table in my db that is called products. Another table is called cart and another one is called user. cart is the bridge table that connects the table user with the table products. </p>\n\n<p>Now, I have specified all the foreign keys with the option CASCADE, so that if I delete one product it will be deleted also from the table cart.</p>\n\n<p>In the user table I have one attribute that is called ProductsInTheCart that counts the number of products in the cart immediately, without having to do a query every time. When I insert a new tuple in the table cart this number will increase. (and this is ok) This works also if I delete one tuple from the table cart.</p>\n\n<p>Instead, the problem is that if I delete one tuple from the table products, the tuples in tha table cart with the same key will be deleted but the attribute in the table users doesn't change. \nMaybe because the elimination of one tuple of the table cart is a consequence of the cascade?</p>\n\n<p>How Can I DO?\nthanks!</p>\n\n<p>this is the trigger:</p>\n\n<pre><code>CREATE\nDEFINER=`root`@`localhost`\nTRIGGER `m4af`.`DecrementaProdottiNelCarrello`\nAFTER DELETE ON `m4af`.`carrello`\nFOR EACH ROW\nupdate utente as U, prodotto as P\nset U.ProdottiNelCarrello = U.ProdottiNelCarrello - 1,\nP.NelCarrelloDi=P.NelCarrelloDi-1\nwhere U.username = OLD.Username AND P.barcode=OLD.Barcode$$\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13258893,"title":"MySql - Joining another table with multiple rows, inserting a query into a another query?","body":"<p>I've been racking my brain for hours trying work out how to join these two queries..</p>\n\n<p>My goal is to return multiple venue rows (from venues) based on certain criteria... which is what my current query does....</p>\n\n<pre><code>SELECT venues.id AS ven_id, \n   venues.venue_name, \n   venues.sub_category_id, \n   venues.score, \n   venues.lat, \n   venues.lng, \n   venues.short_description, \n   sub_categories.id, \n   sub_categories.sub_cat_name, \n   sub_categories.category_id, \n   categories.id, \n   categories.category_name, \n   ((ACOS(  SIN(51.44*PI()/180)*SIN(lat*PI()/180) + COS(51.44*PI()/180)*COS(lat*PI()/180)*COS((-2.60796 - lng)*PI()/180)) * 180/PI())*60 * 1.1515) AS dist\n\nFROM venues, \n  sub_categories, \n  categories \nWHERE \n  venues.sub_category_id = sub_categories.id \n  AND sub_categories.category_id = categories.id \nHAVING \n  dist &lt; 5 \nORDER BY score DESC \nLIMIT 0, 100\n</code></pre>\n\n<p>However, I need to include another field in this query (thumbnail), which comes from another table (venue_images). The idea is to extract one image row based on which venue it's related to and it's order. Only one image needs to be extracted however. So LIMIT 1.</p>\n\n<p>I basically need to insert this query:</p>\n\n<pre><code>SELECT \n  venue_images.thumb_image_filename, \n  venue_images.image_venue_id,  \n  venue_images.image_order \nFROM venue_images \nWHERE venue_images.image_venue_id = ven_id //id from above query\nORDER BY venue_images.image_order \nLIMIT 1\n</code></pre>\n\n<p>Into my first query, and label this new field as \"thumbnail\".</p>\n\n<p>Any help would really be appreciated. Thanks!</p>\n"},{"tags":["sql","database","sql-server-2008","query"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13259028,"title":"SQL Server bulk insert - \"Bulk load data conversion error\"","body":"<pre><code>bulk insert dbo.A\nFROM 'd:\\AData.csv'\nWITH \n(\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\n</code></pre>\n\n<p>Inserting bulk data into a database, I approached an unexplainable error after review of the suspect data:</p>\n\n<blockquote>\n  <p><em>Msg 4867, Level 16, State 1, Line 6</em><br>\n  <em>Bulk load data conversion error (overflow) for row 1, column 42 (FES).</em></p>\n</blockquote>\n\n<p>Column FES was <code>tinyint</code>, now <code>smallint</code>. <code>d:\\AData.csv</code> contains a <code>2</code> in row 1, column 42. Are there any other sources for this type of error?</p>\n\n<p>---APPEND---</p>\n\n<p>I'm not sure how to properly post this. </p>\n\n<p>Create Table Script </p>\n\n<pre><code>create table AcsBy320082010Hus(\nserialnoId bigint,\nRT char,\nDIVISION tinyint,\nPUMA int,\nREGION tinyint,\nST tinyint,\nADJHSG int,\nADJINC int,\nWGTP int,\nNP tinyint,\nTYPE tinyint,\nACR tinyint,\nAGS tinyint,\nBDS tinyint,\nBLD tinyint,\nBUS tinyint,\nCONP smallint,\nELEP smallint,\nFS smallint,\nFULP int,\nGASP int,\nHFL tinyint,\nINSP varchar(6),\nKIT tinyint,\nMHP int,\nMRGI tinyint,\nMRGP int,\nMRGT tinyint,\nMRGX tinyint,\nPLM tinyint,\nRMS tinyint,\nRNTM tinyint,\nRNTP int,\nSMP int,\nTEL tinyint,\nTEN tinyint,\nVACS tinyint,\nVAL tinyint,\nVEH tinyint,\nWATP int,\nYBL tinyint,\nFES tinyint,\nFINCP int,\nFPARC tinyint,\nGRNTP int,\nGRPIP tinyint,\nHHL tinyint,\nHHT tinyint,\nHINCP int,\nHUGCL bit,\nHUPAC tinyint,\nHUPAOC tinyint,\nHUPARC tinyint,\nLNGI tinyint,\nMV tinyint,\nNOC tinyint,\nNPF tinyint,\nNPP bit,\nNR bit,\nNRC tinyint,\nOCPIP tinyint,\nPARTNER tinyint,\nPSF bit,\nR18 bit,\nR60 tinyint,\nR65 tinyint,\nRESMODE tinyint,\nSMOCP int,\nSMX tinyint,\nSRNT bit,\nSVAL bit,\nTAXP tinyint,\nWIF tinyint,\nWKEXREL tinyint,\nWORKSTAT tinyint,\nFACRP bit,\nFAGSP bit,\nFBDSP bit,\nFBLDP bit,\nFBUSP bit,\nFCONP bit,\nFELEP bit,\nFFSP bit,\nFFULP bit,\nFGASP bit,\nFHFLP bit,\nFINSP bit,\nFKITP bit,\nFMHP bit,\nFMRGIP bit,\nFMRGP bit,\nFMRGTP bit,\nFMRGXP bit,\nFMVYP bit,\nFPLMP bit,\nFRMSP bit,\nFRNTMP bit,\nFRNTP bit,\nFSMP bit,\nFSMXHP bit,\nFSMXSP bit,\nFTAXP bit,\nFTELP bit,\nFTENP bit,\nFVACSP bit,\nFVALP bit,\nFVEHP bit,\nFWATP bit,\nFYBLP bit,\nWGTP1 int,\nWGTP2 int,\nWGTP3 int,\nWGTP4 int,\nWGTP5 int,\nWGTP6 int,\nWGTP7 int,\nWGTP8 int,\nWGTP9 int,\nWGTP10 int,\nWGTP11 int,\nWGTP12 int,\nWGTP13 int,\nWGTP14 int,\nWGTP15 int,\nWGTP16 int,\nWGTP17 int,\nWGTP18 int,\nWGTP19 int,\nWGTP20 int,\nWGTP21 int,\nWGTP22 int,\nWGTP23 int,\nWGTP24 int,\nWGTP25 int,\nWGTP26 int,\nWGTP27 int,\nWGTP28 int,\nWGTP29 int,\nWGTP30 int,\nWGTP31 int,\nWGTP32 int,\nWGTP33 int,\nWGTP34 int,\nWGTP35 int,\nWGTP36 int,\nWGTP37 int,\nWGTP38 int,\nWGTP39 int,\nWGTP40 int,\nWGTP41 int,\nWGTP42 int,\nWGTP43 int,\nWGTP44 int,\nWGTP45 int,\nWGTP46 int,\nWGTP47 int,\nWGTP48 int,\nWGTP49 int,\nWGTP50 int,\nWGTP51 int,\nWGTP52 int,\nWGTP53 int,\nWGTP54 int,\nWGTP55 int,\nWGTP56 int,\nWGTP57 int,\nWGTP58 int,\nWGTP59 int,\nWGTP60 int,\nWGTP61 int,\nWGTP62 int,\nWGTP63 int,\nWGTP64 int,\nWGTP65 int,\nWGTP66 int,\nWGTP67 int,\nWGTP68 int,\nWGTP69 int,\nWGTP70 int,\nWGTP71 int,\nWGTP72 int,\nWGTP73 int,\nWGTP74 int,\nWGTP75 int,\nWGTP76 int,\nWGTP77 int,\nWGTP78 int,\nWGTP79 int,\nWGTP80 int)\n</code></pre>\n\n<p>Headers row </p>\n\n<blockquote>\n  <p>serialno,RT,DIVISION,PUMA,REGION,ST,ADJHSG,ADJINC,WGTP,NP,TYPE,ACR,AGS,BATH,BDSP,BLD,BUS,CONP,ELEP,FS,FULP,GASP,HFL,INSP,MHP,MRGI,MRGP,MRGT,MRGX,REFR,RMSP,RNTM,RNTP,RWAT,SINK,SMP,STOV,TEL,TEN,TOIL,VACS,VALP,VEH,WATP,YBL,FES,FINCP,FPARC,GRNTP,GRPIP,HHL,HHT,HINCP,HUGCL,HUPAC,HUPAOC,HUPARC,KIT,LNGI,MULTG,MV,NOC,NPF,NPP,NR,NRC,OCPIP,PARTNER,PLM,PSF,R18,R60,R65,RESMODE,SMOCP,SMX,SRNT,SVAL,TAXP,WIF,WKEXREL,WORKSTAT,FACRP,FAGSP,FBATHP,FBDSP,FBLDP,FBUSP,FCONP,FELEP,FFSP,FFULP,FGASP,FHFLP,FINSP,FKITP,FMHP,FMRGIP,FMRGP,FMRGTP,FMRGXP,FMVP,FPLMP,FREFRP,FRMSP,FRNTMP,FRNTP,FRWATP,FSINKP,FSMP,FSMXHP,FSMXSP,FSTOVP,FTAXP,FTELP,FTENP,FTOILP,FVACSP,FVALP,FVEHP,FWATP,FYBLP,WGTP1,WGTP2,WGTP3,WGTP4,WGTP5,WGTP6,WGTP7,WGTP8,WGTP9,WGTP10,WGTP11,WGTP12,WGTP13,WGTP14,WGTP15,WGTP16,WGTP17,WGTP18,WGTP19,WGTP20,WGTP21,WGTP22,WGTP23,WGTP24,WGTP25,WGTP26,WGTP27,WGTP28,WGTP29,WGTP30,WGTP31,WGTP32,WGTP33,WGTP34,WGTP35,WGTP36,WGTP37,WGTP38,WGTP39,WGTP40,WGTP41,WGTP42,WGTP43,WGTP44,WGTP45,WGTP46,WGTP47,WGTP48,WGTP49,WGTP50,WGTP51,WGTP52,WGTP53,WGTP54,WGTP55,WGTP56,WGTP57,WGTP58,WGTP59,WGTP60,WGTP61,WGTP62,WGTP63,WGTP64,WGTP65,WGTP66,WGTP67,WGTP68,WGTP69,WGTP70,WGTP71,WGTP72,WGTP73,WGTP74,WGTP75,WGTP76,WGTP77,WGTP78,WGTP79,WGTP80</p>\n</blockquote>\n\n<p>Row 1</p>\n\n<blockquote>\n  <p>2008000000023,H,6,01300,3,01,1012650,1031272,00043,04,1,1,,1,02,02,2,0000,150,2,0002,020,3,00150,,2,00980,1,1,1,03,,,1,1,,1,1,1,1,,0210000,2,0080,09,2,000058100,2,,,4,1,000058100,0,3,3,3,1,1,1,3,02,04,0,0,02,024,0,1,0,1,0,0,1,01170,3,0,1,19,1,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,00112,00045,00068,00017,00044,00091,00071,00032,00036,00042,00048,00041,00013,00031,00063,00013,00037,00017,00063,00098,00026,00036,00017,00065,00036,00020,00014,00035,00037,00046,00047,00048,00080,00034,00012,00061,00031,00069,00043,00060,00011,00050,00016,00057,00050,00013,00016,00068,00056,00039,00042,00049,00081,00041,00012,00092,00050,00055,00049,00016,00062,00041,00103,00012,00048,00060,00073,00052,00063,00038,00047,00040,00017,00040,00059,00020,00042,00010,00038,00018</p>\n</blockquote>\n\n<p><a href=\"http://www.census.gov/acs/www/Downloads/data_documentation/pums/DataDict/PUMS_Data_Dictionary_2008-2010.pdf\" rel=\"nofollow\">Link to ACS 2008-2010 Data Dictionary</a></p>\n"},{"tags":["c#","sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13257925,"title":"Update the dataset after rows changed","body":"<p>Scenario:</p>\n\n<ol>\n<li>Excel file is read and displayed in datagrid.</li>\n<li>Values in sql server must be updated  if excel values are different.</li>\n<li>Table in Sql server don't have primary key</li>\n</ol>\n\n<p>After all these steps, when I am about to update the table, it throws the error saying \"Update requires a valid UpdateCommand when passed DataRow collection with modified rows.\" </p>\n\n<p>There is no primary key. So I need to use update command. BUt how and what would be in update command? importdata is dictionary where data from excel are stored. PLz help!!! What should I do now? I have No idea....</p>\n\n<pre><code>foreach (DataColumn column in ds.Tables[0].Columns)\n{\n    string fieldName = column.ColumnName;\n    string fieldNameValueE = string.Empty;\n    if (importdata.ContainsKey(fieldName))\n    {\n        fieldNameValueE = importdata[fieldName];\n        foreach (DataRow dr in ds.Tables[0].Rows)\n        {\n            string fieldNameValueD = dr[fieldName].ToString();\n            if (fieldNameValueD != fieldNameValueE)\n            {\n                dr[fieldName] = fieldNameValueE;\n\n            }\n        }\n\n    }\n\n}\n\nda.Update(ds);\nconnection.Close();    \n</code></pre>\n"},{"tags":["sql","vba","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13259730,"title":"Execute VBA using SQL","body":"<p>Ok, this may be a long shot but in MS Access, is it possible to execute VBA using SQL? I'm looking to write a query that runs either a single VBA statement or a Sub. Basically, what I'm trying to do is modify the hidden attribute of a table using SQL.</p>\n\n<p>MS makes enough weird decisions with Office implementations that I'm mildly hopeful this is one of those cases.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13259576,"title":"PHP saving mysql info to php variables","body":"<p>So, what i'm trying to do is that I want this to happen basically, here's my code:</p>\n\n<p>mysql_query(\"SELECT account.id FROM account WHERE account.username= \"\"\");</p>\n\n<p>I want the result of that code stored in a variable named account_id in PHP. But I wasn't able to find anything online that I was able to understand.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13258932,"title":"Query giving undesirable results","body":"<p>I have the following two tables:</p>\n\n<pre><code>lab_assistant\nla_id - la_firstname - la_lastname\n1 - Dennis - Rodman\n2 - Michael - Jordan\n3 - Horace - Grant\n\nhours_worked\nhw_semester - hw_date - hw_hours - la_id\nFall 2012 - 2012-11-01 - 4 - 2\nFall 2012 - 2012-11-04 - 5 - 3\nSpring 2012 - 2012-02-12 - 4 - 1\nSpring 2012 -2012-03-10 - 4 - 1\n</code></pre>\n\n<p>The result of my query is supposed to look like the following:</p>\n\n<p>and I'm trying to run the following query in order to list the Lab Assistant and the number of hours they worked each semester</p>\n\n<pre><code>SELECT DISTINCT(CONCAT(la.la_firstname, ' ', la.la_lastname)) AS 'Lab Assistant',\n   hw.hw_semester AS 'Semester Worked', hw.hw_hours AS 'Hours Worked'\nFROM lab_assistant la\n    JOIN hours_worked hw\n        ON la.la_id = hw.la_id;\n</code></pre>\n\n<p>The results of my quere are SUPPOSED to look like this:</p>\n\n<pre><code>Michael Jordan - Fall 2012 - 4\nHorace Grant - Spring 2012 - 5\nDennis Rodman - Fall 2012 - 8\n</code></pre>\n\n<p>BUT the results I'm getting are as follows:</p>\n\n<pre><code>Michael Jordan - Fall 2012 - 4\nHorace Grant - Fall 2012 - 5\nDennis Rodman - Spring 2012 - 4\n</code></pre>\n\n<p>So basically, it just isn't counting the proper hours for Dennis Rodman. It should be 8 and not 4.</p>\n\n<p>And I probably shouldn't use DISTINCT here because it's possible the same person could work different semesters.</p>\n"},{"tags":["sql","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13254141,"title":"How do I use DateTime from one result set as start and end date for another query?","body":"<p>OK, I have product with serial numbers running through a production line. I read and store times when these serial number are read at different locations. </p>\n\n<p>I can query this data and get:</p>\n\n<pre><code>Tagname - Barcode reader identifier.\nDateTime - DateTime of read.\nValue - Serial Number.\n</code></pre>\n\n<p>I need to look at the process values of a tool from the time that the reader reads a specific Serial Number before the tool and the time it reads that same serial number after the tool. I would like to average, min/max, etc. the values but I haven't figured out how to use the DateTime of the barcode reads to act as the StartDate and EndDate of the process values query.</p>\n\n<p>Any help would be very much appreciated.</p>\n\n<p>Process Query:</p>\n\n<pre><code>SET NOCOUNT ON\nDECLARE @StartDate DateTime\nDECLARE @EndDate DateTime\nSET @StartDate = '20121106 08:48:26.000'\nSET @EndDate = '20121106 08:53:26.000'\nSET NOCOUNT OFF\nSELECT  * \nFROM (SELECT History.TagName, DateTime, Value, vValue, StartDateTime\n      FROM History\n      WHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\n      AND wwRetrievalMode = 'Average'\n      AND wwCycleCount = 10\n      AND wwVersion = 'Latest'\n      AND DateTime &gt;= @StartDate\n      AND DateTime &lt;= @EndDate) temp \nWHERE temp.StartDateTime &gt;= @StartDate\n</code></pre>\n\n<p>I want to get the data based on barcode reads before and after the tool. I tried some things like:</p>\n\n<pre><code>SELECT History.TagName, DateTime, Value\nFROM History\nWHERE History.TagName IN ('PVD1101_01.CHU1_Supply_Water_Pressure')\nAND DateTime &gt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber',\n                                           'MES_110A.PVD1101R_In_SerialNumber' )\n                 AND Value = '100056134')\nAND DateTime &lt;= (SELECT History.DateTime\n                 FROM History\n                 WHERE History.TagName IN ('MES_110B.SCR1101_SerialNumber',\n                                           'MES_110B.SCR1102_SerialNumber')\n                 AND Value = '100056134')\n</code></pre>\n\n<p>OK, I made some changes. Now I have:</p>\n\n<pre><code>    SET NOCOUNT ON\n    DECLARE @StartDate DateTime\n    DECLARE @EndDate DateTime\n    SET @StartDate = (SELECT DateTime\n                              FROM History\n                              WHERE History.TagName IN  ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n                              AND Value = '100056130'\n                              AND DateTime &gt;= '20121106 05:39:48.000'\n                              AND DateTime &lt;= '20121106 23:39:48.000')\n    SET @EndDate = (SELECT DateTime\n                           FROM History\n                           WHERE TagName IN ('MES_110B.SCR1101_In_SerialNumber', 'MES_110B.SCR1102_In_SerialNumber' )\n                           AND Value = '100056130'\n                           AND DateTime &gt;= '20121106 05:39:48.000'\n                           AND DateTime &lt;= '20121106 23:39:48.000')\n    SET NOCOUNT OFF\n\n    SELECT TagName, AVG (Value) AS \"Average\"\n     FROM History\n     WHERE History.TagName IN  ('PVD1101_01.CHU1_Return_Water_Pressure', 'PVD1101_01.CHU1_Return_Water_Temp', 'PVD1101_01.5CT11_IN_Supply_Temp', 'PVD1101_01.5CT11_Out_Return_Temp')\n     AND DateTime &gt;= @StartDate\n     AND DateTime &lt;= @EndDate\n    GROUP BY TagName\n</code></pre>\n\n<p>This returns the values I am looking for. I will make the serial number value a parameter for the reports and it should work. Does this look totally convoluted and inefficient?</p>\n\n<p>I do need one more thing. This subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n</code></pre>\n\n<p>Returns Null. This Subquery:</p>\n\n<pre><code>    SELECT DateTime\n     FROM History\n     WHERE History.TagName IN ('MES_110A.PVD1101L_In_SerialNumber', 'MES_110A.PVD1101R_In_SerialNumber')\n     AND Value = '100056145'\n     AND DateTime &gt;= '20121106 05:39:48.000'\n     AND DateTime &lt;= '20121106 23:39:48.000'\n</code></pre>\n\n<p>Returns a value. Why?</p>\n"},{"tags":["sql","google","schema","google-docs","database-schema"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1033,"score":6,"question_id":2518277,"title":"Online Collaborative Schema Design (leverage google docs?)","body":"<p>I'm looking for an online, collaborative database schema designer.  App is for MySQL specifically, but generic DB designer is fine too.\nIt's important that it can handle revisions (history of changes).</p>\n\n<p>This looks cool, and I could host it on a server - but doesn't look like it would handle multi-user:\n<a href=\"http://ondras.zarovi.cz/sql/demo/\">http://ondras.zarovi.cz/sql/demo/</a></p>\n\n<p>Currently we're doing a lot of design collaboration on google docs/spreadsheets.  Has anyone had any success using google spreadsheet for schema design?  Even if there were just a gadget for drawing lines/connections, I might give Google Docs a shot.</p>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13258801,"title":"Pulling Data in PHP from SQL Server","body":"<p>I have an issue with my script somewhere but do not know exactly where it is incorrect.  Here is the code:</p>\n\n<pre><code>&lt;title&gt;Log&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;h1&gt; Log &lt;/h1&gt;\n\n&lt;form method=\"get\" action=\"getlog.php\"&gt; \n\n&lt;table width=\"300\" border=\"0\"&gt;\n  &lt;tr&gt;\n    &lt;td&gt; Forte ID:&lt;/td&gt;\n    &lt;td&gt;&lt;select id=\"ForteID\" name=\"ForteID\"&gt;                    \n                    &lt;option value=\"nc4682\"&gt;nc4682&lt;/option&gt;\n                    &lt;option value=\"bs1441\"&gt;bs1441&lt;/option&gt;\n                    &lt;option value=\"sp3212\"&gt;sp3212&lt;/option&gt;                 \n        &lt;/select&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n\n &lt;input type=\"submit\" name=\"getLog\" value=\"Get Log\"&gt;\n &lt;/form&gt; \n\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&lt;?php\n/*print_r($_POST);*/\n$serverName = 'SRB-Nick_Desktop\\SQLEXPRESS';\n$connectionInfo = array('Database'=&gt;'cslogs', 'UID'=&gt;'cslogslogin', 'PWD'=&gt;'123456');\n$connection = sqlsrv_connect($serverName, $connectionInfo);\n\n$query = 'SELECT    ForteID, Disposition, appNumber, Finance_Num, Num_Payments, ACH_CC,     Notes from logs';\n\n$result = sqlsrv_query($connection,$query);\n\nif (!$result) \n{\n    $message = 'ERROR: ' . sqlsrv_errors();\n    return $message;\n}\nelse\n{\n    $i = 0;\n    echo '&lt;html&gt;&lt;body&gt;&lt;table&gt;&lt;tr&gt;';\n    while ($i &lt; sqlsrv_num_rows($result))\n    {\n        $meta = sqlsrv_fetch($result, $i);\n        echo '&lt;td&gt;' . $meta-&gt;name . '&lt;/td&gt;';\n        $i = $i + 1;\n    }\n    echo '&lt;/tr&gt;';\n\n    while ( ($row = sqlsrv_fetch_array($result))) \n    {\n        $count = count($row);\n        $y = 0;\n        echo '&lt;tr&gt;';\n        while ($y &lt; $count)\n        {\n        $c_row = current($row);\n        echo '&lt;td&gt;' . $c_row . '&lt;/td&gt;';\n        next($row);\n        $y = $y + 1;\n    }\n    echo '&lt;/tr&gt;';\n}\nsqlsrv_free_stmt ($result);\n\necho '&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;';\n}\nsqlsrv_close( $connection);\n?&gt;\n</code></pre>\n\n<p>And this is what I get in result, no matter what is selected in the drop down box and hit the button get log.</p>\n\n<p>nc4682  nc4682  Save    Save    asdf    asdf    fdas    fdas    1   1   cc  cc  asdf    asdf\nbs1441  bs1441  LOC LOC AN00336862  AN00336862  None    None    0   0   ach ach Backout Backout\nnc4682  nc4682  Save    Save    AN00336862  AN00336862  easdf   easdf   2   2   ach ach asdf    asdf\nsp3212  sp3212  Sale    Sale    NCXXXXXX1   NCXXXXXX1   none    none    1   1   cc  cc  asdfasdfasdf    asdfasdfasdf</p>\n\n<p>Each column is duplicated.  There are supposed to be 7 columns.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13258759,"title":"Update a DateTimes's Time, but not the date","body":"<pre><code>MyTable:\n id     int\n Date1  DateTime\n Date2  DateTime\n</code></pre>\n\n<p>How can I set the time of Date2 to be the same as Date1 without affecting the date of Date2?</p>\n"},{"tags":["sql","database","null","nullable"],"answer_count":6,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":4159,"score":6,"question_id":1833949,"title":"why is null not equal to null false","body":"<p>I was reading this article:\n<a href=\"http://stackoverflow.com/questions/191640/get-null-null-in-sql\">http://stackoverflow.com/questions/191640/get-null-null-in-sql</a></p>\n\n<p>And the consensus is that when trying to test equality between two (nullable) sql columns, the right approach is:</p>\n\n<pre><code>where ((A=B) OR (A IS NULL AND B IS NULL))\n</code></pre>\n\n<p>When A and B are NULL, (A=B) still returns FALSE, since NULL is not equal to NULL. That is why the extra check is required.</p>\n\n<p>What about when testing inequalities? Following from the above discussion, it made me think that to test inequality I would need to do something like:</p>\n\n<pre><code>WHERE ((A &lt;&gt; B) OR (A IS NOT NULL AND B IS NULL) OR (A IS NULL AND B IS NOT NULL))\n</code></pre>\n\n<p>However, I noticed that that is not necessary (at least not on informix 11.5), and I can just do:</p>\n\n<pre><code>where (A&lt;&gt;B)\n</code></pre>\n\n<p>If A and B are NULL, this returns FALSE. If NULL is not equal to NULL, then shouldn't this return TRUE?</p>\n\n<p><strong>EDIT</strong><br>\nThese are all good answers, but I think my question was a little vague. Allow me to rephrase:</p>\n\n<p>Given that either A or B can be NULL, is it enough to check their inequality with</p>\n\n<pre><code>where (A&lt;&gt;B)\n</code></pre>\n\n<p>Or do I need to explicitly check it like this:</p>\n\n<pre><code>WHERE ((A &lt;&gt; B) OR (A IS NOT NULL AND B IS NULL) OR (A IS NULL AND B IS NOT NULL))\n</code></pre>\n\n<p>REFER to this <a href=\"http://stackoverflow.com/questions/1835546/testing-inequality-with-columns-that-can-be-null\">thread</a> for the answer to this question.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13257698,"title":"calculating total rows from one table with 2 level child","body":"<p>I have one table of \"galleries\" and one for \"images\".. the galleries table goes like this..</p>\n\n<pre><code>gal_id|name\n</code></pre>\n\n<p>and images is like</p>\n\n<pre><code>img_id|gal_id|name\n</code></pre>\n\n<p>now I have say 20 galleries, and I want to display total number of images in each gallery, so I want to use one query to return the array with total images in each gallery something like this</p>\n\n<pre><code>Gallery A (Total Images : 23)\nGallery B (Total Images : 33)\nGallery C (Total Images : 523)\nGallery D (Total Images : 25)\n</code></pre>\n\n<p>What would be the best approach to do this, I dont want to put the query in loop it will put load on server, please advise..</p>\n\n<p>thanks</p>\n"},{"tags":["php","sql","user","expire"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13258951,"title":"redirect to page if expiration date = today's date?","body":"<p>I have a site with users on. Each users account has an expiration date in mysql table 'subscription_expires'.</p>\n\n<p>Is there a way to redirect a user to another page other than dashboard.php if their profile or the 'subscription_expires' is = to todays date after an attempt of login in which says their profile has expired. </p>\n\n<p>I've tried to have a go by using 'sub_expires' etc but no luck it still logs the user in if their profile is expired. </p>\n\n<p>here's my login script:</p>\n\n<pre><code>&lt;?php\n\n    if (logged_in()) {\n        redirect_to(\"dashboard.php\");\n    }\n\n    include_once(\"includes/form_functions.php\");\n\n    // START FORM PROCESSING\n    if (isset($_POST['submit'])) { // Form has been submitted.\n        $errors = array();\n\n        // perform validations on the form data\n        $required_fields = array('email', 'password');\n        $errors = array_merge($errors, check_required_fields($required_fields, $_POST));\n\n        $fields_with_lengths = array('email' =&gt; 30, 'password' =&gt; 30);\n        $errors = array_merge($errors, check_max_field_lengths($fields_with_lengths, $_POST));\n\n        $email = trim(mysql_prep($_POST['email']));\n        $password = trim(mysql_prep($_POST['password']));\n        $hashed_password = md5($password);\n\n        if ( empty($errors) ) {\n            // Check database to see if email and the hashed password exist there.\n            $query = \"SELECT id, email, close_account \";\n            $query .= \"FROM ptb_users \";\n            $query .= \"WHERE email = '{$email}' \";\n            $query .= \"AND password = '{$hashed_password}' \";\n            $query .= \"AND close_account = '0' \";\n            $query .= \"LIMIT 1\";\n            $result_set = mysql_query($query);\n            confirm_query($result_set);\n            if (mysql_num_rows($result_set) == 1) {\n                // email/password authenticated\n                // and only 1 match\n                $found_user = mysql_fetch_array($result_set);\n                $_SESSION['user_id'] = $found_user['id'];\n                $_SESSION['email'] = $found_user['email'];\n                $_SESSION['sub_expires'] = $found_user['subscription_expires'];\n\n                $result = mysql_query(\"UPDATE ptb_users SET user_online='Online' WHERE id=\".$_SESSION['user_id'].\"\") \nor die(mysql_error());\n\n\n                redirect_to(\"dashboard.php\");\n            } else {\n                // email/password combo was not found in the database\n                $message = \"&lt;div class=\\\"infobox\\\"&gt;&lt;strong&gt;Email/Password combination incorrect.&lt;/strong&gt;&lt;br /&gt;\n                    Please make sure your caps lock key is off and try again.&lt;/div&gt;\";\n            }\n\n                } else {\n            if (count($errors) == 1) {\n                $message = \"&lt;div class=\\\"infobox\\\"&gt;There was 1 error in the form.&lt;div&gt;\";\n\n\n            } else {\n                $message = \"&lt;div class=\\\"infobox\\\"&gt;There were \" . count($errors) . \" errors in the form.&lt;div&gt;\";\n            }\n        }\n\n\n    } else { // Form has not been submitted.\n        if (isset($_GET['logout']) &amp;&amp; $_GET['logout'] == 1) {\n            $message = \"&lt;div class=\\\"infobox\\\"&gt;You are now logged out.&lt;/div&gt;\";\n        } \n        $email = \"\";\n        $password = \"\";\n    }\n?&gt;\n            &lt;?php if (!empty($message)) {echo \"&lt;p class=\\\"message\\\"&gt;\" . $message . \"&lt;/p&gt;\";} ?&gt;\n            &lt;?php if (!empty($errors)) { display_errors($errors); } ?&gt;\n            &lt;form action=\"login.php\" method=\"post\"&gt;\n\nEmail&lt;br /&gt;\n&lt;input name=\"email\" type=\"text\" value=\"&lt;?php echo htmlentities($email); ?&gt;\" size=\"40\" maxlength=\"50\" /&gt;\n\n  &lt;br /&gt;\n  &lt;br /&gt;\n  Password&lt;br /&gt;\n  &lt;input name=\"password\" type=\"password\" value=\"&lt;?php echo htmlentities($password); ?&gt;\" size=\"40\" maxlength=\"30\" /&gt;\n\n  &lt;br /&gt;\n  &lt;br /&gt;\n&lt;input type=\"submit\" name=\"submit\" value=\"Login\" /&gt;\n\n\n            &lt;/form&gt;\n</code></pre>\n"},{"tags":["sql","stored-procedures","if-statement","null"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12932065,"title":"SQL: @somevalue = null is not working properly","body":"<p>I tried @somevalue = null and it worked that time. But now its not working. How to check if the value is null?\nIn brief what I need to do is if @existPerson is equal to null then INSERT the values into the database. But if it exists then return -2. I have checked in the database made sure that there are no same value as @nic = 100. Even so its returning me -2. What could be the possible reason ?  Thanks a lot!</p>\n\n<pre><code>CREATE PROCEDURE [dbo].[addStudent] \n    @stuName varchar(50), \n    @address varchar(100),\n    @tel varchar(15),\n    @etel varchar(15),\n    @nic varchar (10),\n    @dob date\n\n\nAS \nBEGIN   \n    SET NOCOUNT ON;\n\n    DECLARE @currentID INT\n    DECLARE @existPerson INT\n    SET @existPerson = (SELECT p_ID FROM Student WHERE s_NIC = @nic);\n    IF @existPerson = null\n        BEGIN\n            INSERT INTO Person (p_Name, p_RegDate, p_Address, p_Tel, p_EmergeNo, p_Valid, p_Userlevel)\n            VALUES (@stuName,  GETDATE(), @address, @tel, @etel, 0, 'Student' );\n            SET @currentID = (SELECT MAX( p_ID) FROM Person); \n            INSERT INTO Student (p_ID, s_Barcode, s_DOB, s_NIC) VALUES (@currentID , NULL, @dob, @nic);\n            return 0;\n        END\n    ELSE\n        return -2;\nEND \n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13258021,"title":"distinct condition in case statement","body":"<p>I have a SQL that returns a cnt1 and cnt2 for each Event_ID, while testing a condition for column \"POSA\" </p>\n\n<p>this returns the following as desired:</p>\n\n<p>Event_ID | CNT1 | CNT2</p>\n\n<p>I would like to add another condition to each CASE statement that tests if another column \"S\" in the same table is distinct.  Below is the code snippet:</p>\n\n<pre><code>SELECT Event_ID, \n sum  \n (CASE WHEN POSA IN ('SX', 'DX')  THEN 1 \n    ELSE 0 \n END) \n AS cnt1,\nsum \n(CASE  \n    WHEN POSA IN ('SP', 'DP')  THEN 1 \n    ELSE 0 \n END) AS cnt2\n\n\nFROM Station_Processed_Info GROUP BY EVENT_ID;\n</code></pre>\n"},{"tags":["sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13258442,"title":"SELECT DISTINCT HAVING Count unique conditions","body":"<p>I've searched for an answer on this but can't find quite how to get this distinct recordset based on a condition.  I have a table with the following sample data:</p>\n\n<pre><code>Type    Color   Location    Supplier\n----    -----   --------    --------\nApple   Green   New York    ABC\nApple   Green   New York    XYZ\nApple   Green   Los Angeles ABC\nApple   Red     Chicago     ABC\nApple   Red     Chicago     XYZ\nApple   Red     Chicago     DEF\nBanana  Yellow  Miami       ABC\nBanana  Yellow  Miami       DEF\nBanana  Yellow  Miami       XYZ\nBanana  Yellow  Atlanta     ABC\n</code></pre>\n\n<p>I'd like to create a query that shows the count of unique locations for each distinct Type+Color where the number of unique locations is more than 1, e.g.</p>\n\n<pre><code>Type    Color   UniqueLocations\n----    -----   --------\nApple   Green   2\nBanana  Yellow  2\n</code></pre>\n\n<p>Note that {Apple, Red, 1} doesn't appear because there is only 1 location for red apples (Chicago).  I think I've got this one (but perhaps there is a simpler method).  I'm using:</p>\n\n<pre><code>SELECT Type, Color, Count(Location) FROM\n(SELECT DISTINCT Type, Color, Location FROM MyTable)\nGROUP BY Type, Color HAVING Count(Location)&gt;1;\n</code></pre>\n\n<p>How can I create another query that lists the <code>Type, Color</code>, and <code>Location</code> for each distinct <code>Type,Color</code> when the count of unique locations for that <code>Type,Color</code> is greater than 1?  The resulting recordset would look like:</p>\n\n<pre><code>Type    Color   Location\n----    -----   --------\nApple   Green   New York\nApple   Green   Los Angeles\nBanana  Yellow  Miami\nBanana  Yellow  Atlanta\n</code></pre>\n\n<p>Note that <code>Apple, Red, Chicago</code> doesn't appear because there is only 1 location for red apples.  Thanks!</p>\n"},{"tags":["sql","mysql","query","table","drop"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":5107,"score":11,"question_id":1589278,"title":"SQL: deleting tables with prefix","body":"<p>i know how to delete my tables in MySQL, </p>\n\n<pre><code>DROP TABLE\n</code></pre>\n\n<p>but now i need to know how to delete my tables who all have the prefix</p>\n\n<pre><code>myprefix_\n</code></pre>\n\n<p>How to?</p>\n\n<p>--I NEED TO DO THIS IN PHPMYADMIN, IN A BROWSER. NO TERMINAL STUFF PLEASE. BATCH STUFF IS ALWAYS APRECIATED.--</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13255829,"title":"Dynamic WHERE condition based on variable","body":"<p>I have the follow line in SQL Server</p>\n\n<pre><code>((@data_inicial IS NULL OR @data_inicial = '') \nOR \ntbSO.dt_criacao &gt;= CAST(@data_inicial AS DATE))\n</code></pre>\n\n<p>I need to use the field tbSO.dt_criacao depending one parameter that I receive @cod_status.</p>\n\n<p>If @cod_status = 1 I have to use tbSO.dt_criacao <br/>\nIf @cod_status = 2 I have to use tbSO.dt_abertura <br/>\nIf @cod_status = 3 I have to use tbSO.dt_fechamento</p>\n\n<p>Can you help me in this issue?</p>\n\n<p>Best Regards</p>\n\n<p>Milton Camara</p>\n"},{"tags":["mysql","sql"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13257629,"title":"Update value based on subquery returning more than one row","body":"<p>I have this probably simple SQL question.</p>\n\n<pre><code>UPDATE parts\nSET partscnt=partscnt-1\nWHERE idparts = (SELECT idparts FROM ordercontent WHERE idOrder=4);\n</code></pre>\n\n<p>Problem is that the subquery returns 5 values, and i want the update done on each of the values.</p>\n\n<p>Update:\nThe ordercontent table has an ID for the order and a row idparts. If several of the same parts are hooked to the same order the table looks like this:</p>\n\n<pre><code>ID idparts\n4  147\n4  147\n4  147\n4  55\n4  33\n</code></pre>\n\n<p>So I need to decrement the partscount three times for the part with id 147.</p>\n\n<p>How can I change this query to achieve that?</p>\n"},{"tags":["sql","oracle","plsql","oracle11g"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":67,"score":2,"question_id":13257632,"title":"Oracle 11g: How to union an oracle table with itself?","body":"<p>I have a table which looks like the following: </p>\n\n<pre><code>date          code                name    score         set\n09/09/12     967873         Team A         24            1\n09/09/12     967873         Team B         22            1\n09/09/12     967873         Team A         21            2 \n09/09/12     967873         Team B         16            2\n02/04/12     965454         Team X         21            1\n02/04/12     965454         Team Y         19            1\n02/04/12     965454         Team X         21            2\n02/04/12     965454         Team Y         19            2\n</code></pre>\n\n<p>you guessed it right! it's a volleyball match! however, I would like my output to be in a single line. For example: </p>\n\n<pre><code>date           code               Teams                 Set-1    Set-2     Set-3\n09/09/12      967873             Team A VS.Team B       24-22    21-16       -\nand so on.... \n</code></pre>\n\n<p><code>**Notice that the game could have a third set as well</code></p>\n\n<p>I will need some kind of self join to refine the above format to the format that is easier for Users view...Let me know if you need more details.</p>\n\n<p>Thanks,</p>\n"},{"tags":["asp.net","sql","sql-server-2008","compression","sharpziplib"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13202578,"title":"Most Space-Efficient Way to Store a Byte Array in a Database Table - ASP.NET","body":"<p>Right now we have a database table (SQL Server 2008 R2) that stores an uploaded file (PDF, DOC, TXT, etc.) in an image type column. A user uploads this file from an ASP.NET application. My project is to get a handle on the size at which this table is growing, and I've come up with a couple of questions along the way.</p>\n\n<ol>\n<li><p>On the database side, I've discovered the image column type is supposedly somewhat depreciated? Will I gain any benefits to switching over to varbinary(max), or should I say varbinary(5767168) because that is my file size cap, or might as well I just let it stay as an image type as far as space-efficiency is concerned?</p></li>\n<li><p>On the application side, I want to compress the byte array. Microsoft's built in GZip sometimes made the file bigger instead of smaller. I switched over to SharpZipLib, which is much better, but I still occasionally run into the same problem. Is there a way to find out the average file compression savings before I implement it on a wide scale? I'm having a hard time finding out what the underlying algorithm is that they use.</p></li>\n<li><p>Would it be worth writing a Huffman code algorithm of my own, or will that present the same problem where there is occasionally a larger compressed file than original file?</p></li>\n</ol>\n\n<p>For reference, in case it matters, here's the code in my app:</p>\n\n<pre><code>    using ICSharpCode.SharpZipLib.GZip;\n\n    private static byte[] Compress(byte[] data)\n    {\n        MemoryStream output = new MemoryStream();\n\n        using (GZipOutputStream gzip = new GZipOutputStream(output))\n        {\n            gzip.IsStreamOwner = false;\n            gzip.Write(data, 0, data.Length);\n            gzip.Close();\n        }\n        return output.ToArray();\n    }\n\n    private static byte[] Decompress(byte[] data)\n    {\n        MemoryStream output = new MemoryStream();\n        MemoryStream input = new MemoryStream();\n        input.Write(data, 0, data.Length);\n        input.Position = 0;\n\n        using (GZipInputStream gzip = new GZipInputStream(input))\n        {\n            byte[] buff = new byte[64];\n            int read = gzip.Read(buff, 0, buff.Length);\n\n            while (read &gt; 0)\n            {\n                output.Write(buff, 0, read);\n                read = gzip.Read(buff, 0, buff.Length);\n            }\n\n            gzip.Close();\n        }\n        return output.ToArray();\n    }\n</code></pre>\n\n<p>Thanks in advance for any help. :)</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13258412,"title":"How to write an alter table statement to add a constraint","body":"<p>I'm, new to SQL. I have created few tables:</p>\n\n<pre><code>CREATE TABLE MAINTINANCE\n(Maint_mname char(10),\nMaint_date date,\nMaint_duedate date NOT NULL,\nMaint_mdesc char (15));    \n\nCREATE TABLE DESIGNERR\n(Dez_emp_number varchar(11),\nDez_field char(12),\nDez_qualification char(10) NOT NULL,\nDez_experience smallint);\n</code></pre>\n\n<p>For the first table I am adding the following constraint:</p>\n\n<pre><code>ALTER TABLE MAINTINANCE ADD CONSTRAINT CHK_maintdate CHECK(Maint_date&lt;MAint_duedate);\n</code></pre>\n\n<p>but I am getting the error <code>invalid ALTER TABLE option</code>. Could you please let me know why this is appearing? The same is working for a friend but not for me.</p>\n\n<p>For the second table I have to write a SQL command for the business rule:</p>\n\n<blockquote>\n  <p>If the Qualification of a Designer is BS then a Minimum of 4 years\n  Experience is required. But, if the Qualification of the Designer is\n  MS then a Minimum of 2 years Experience is sufficient.</p>\n</blockquote>\n\n<p>How can we define this business rule in SQL?</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13193574,"title":"Searching a GridView bound to SQLDataSource using Textboxes","body":"<p>My scenario is a Gridview which is bound to a stored procedure using asp:SQLDataSource. This was quickly done using the wizard where i selected the SP and all data was dispalyed.\nThe SP was created in such a way that it contains 4 parameters. When such parameters are null, they will return all values in the query.</p>\n\n<p>I have created 3 textboxes and a dropdown list to populate these parameters, binding them to a  button in an attempt to create a search functionality. I have tried many ways and methods, especially by research on this site but none seem to work. I cant quite find my issue so I appreciate any help on the matter. Below is my code.</p>\n\n<pre><code>&lt;asp:SqlDataSource ID=\"sqlSourceID\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:DBCONNSTRING%&gt;\"\n            SelectCommand=\"storedProcedureName\" SelectCommandType=\"StoredProcedure\"&gt;                \n        &lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>The above is the SQL stored procedure bind.</p>\n\n<p>I have attemtped to bind the controls as parameters for the SQL server. Prior to this code, the page used to load all records fine without search parameters as the SP was assuming a null value. Now nothing loads.</p>\n\n<pre><code>            &lt;SelectParameters&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox1\" PropertyName=\"Text\" Name=\"1\" Type=\"DateTime\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox2\" PropertyName=\"Text\" Name=\"2\" Type=\"DateTime\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"textBox3\" PropertyName=\"Text\" Name=\"3\" Type=\"String\" /&gt;\n                &lt;asp:ControlParameter ConvertEmptyStringToNull=\"true\" ControlID=\"ddl1\" PropertyName=\"SelectedText\" Name=\"4\" Type=\"String\" /&gt;\n            &lt;/SelectParameters&gt;\n</code></pre>\n\n<p>Where the Control ID represents the textbox ID</p>\n\n<p>Below is my code behind.</p>\n\n<pre><code>        sqlSourceID.SelectParameters[\"textbox1\"].DefaultValue = this.textbox.Text;\n        sqlSourceID.SelectParameters[\"textbox2\"].DefaultValue = this.textbox1.Text;\n        sqlSourceID.SelectParameters[\"textbox3\"].DefaultValue = this.textbox2.Text;\n        sqlSourceID.SelectParameters[\"ddl1\"].DefaultValue =    Convert.ToString(this.ddl.SelectedText);\n</code></pre>\n\n<p>Well that is my problem. I need to find a way to pass parameters from the textboxes when the Search Button is clicked and assume null on page load or if nothing is written.</p>\n\n<p>Thanks to all those who contribute in advance.</p>\n"},{"tags":["mysql","sql","query","reservation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13239084,"title":"MySQL Reservation System - Testing for multiple conditions","body":"<p>I'm working on a reservation system in MySQL and I'm having a bit of trouble with my query for finding the next available appointment slots.</p>\n\n<p>My days are broken down into 15-minute slots (00:00:00 - 00:14:59, 00:15:00 - 00:29:59, etc.).  Table structure so far:</p>\n\n<p><strong>appointments table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `appointments` (\n`appointmentID` int(9) unsigned NOT NULL AUTO_INCREMENT,\n`patientID` int(9) unsigned NOT NULL,\n`apptTitle` varchar(50) NOT NULL,\n`apptDT` datetime NOT NULL,\n`apptLength` int(4) NOT NULL,\n`apptStatus` varchar(25) NOT NULL,\n`physician` int(9) unsigned NOT NULL,\n`apptType` varchar(30) NOT NULL,\n`apptLocation` varchar(25) NOT NULL,\nPRIMARY KEY (`appointmentID`),\nKEY `patientID` (`patientID`),\nKEY `physician` (`physician`),\nKEY `apptStatus` (`apptStatus`),\nKEY `apptLocation` (`apptLocation`),\nKEY `apptType` (`apptType`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n</code></pre>\n\n<p><strong>apptSlots Table:</strong></p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `apptSlots` (\n`startDT` datetime NOT NULL,\n`endDT` datetime NOT NULL,\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8;\n</code></pre>\n\n<p>The apptSlots table is already filled with all the 15 minute slots for 2012, as I explained above.</p>\n\n<p>I have a query that can successfully show me the slots that aren't taken in any way (no appointments scheduled at all).</p>\n\n<pre><code>SELECT a.*\nFROM apptSlots AS a\nLEFT JOIN appointments AS b\nON a.endDT\nBETWEEN b.apptDT AND DATE_ADD(b.apptDT, INTERVAL b.apptLength MINUTE)\nAND b.appointmentID IS NULL\n</code></pre>\n\n<p>What I need to do now is search for appointment slots across multiple physicians, multiple rooms, etc.  For example, if Physician A makes an appointment for 7am - 8am, that time slot no longer shows up in my query above.  But Physician B and C don't have any appointments for that slot, so I need to be able to schedule them.  The same goes for rooms, Room A is used by the 7am appointment, but room B and C are still free to be scheduled.</p>\n\n<p>How can I determine open slots with all these variables?  I know I can test with WHERE conditions for each combination and this works if I need to test for a specific doctor, or a specific room for a treatment.  But, if I just want to see all slots across all doctors and rooms, my query doesn't work and testing all possible combinations individually doesn't seem right, it's just a matter of how to get the right conditions into the LEFT JOIN clause.</p>\n\n<p>Please let me know if I'm being unclear, but I think this is enough info.  If not, I'll add in whatever you ask for!</p>\n\n<p>Thank you for your help, my previous question on here got me as far as my query above, now I just need some refinement.  Ask any questions you need, I'll be here to answer them!</p>\n"},{"tags":["php","sql","database","function"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13257934,"title":"PHP SQL Discount Code For Specific Items?","body":"<p>This function successfully calculates a global percentage using a single discount code, although I'm having problems making the code discount a specific range of items instead of globally.   The basket session holds id, name, desc, price, qty etc... but everything I've tried thus far has failed, I realize I need to implement it into the foreach loop (which I keep breaking or updates every item one way or another) or use a different method entirely but I'm really unsure as how to proceed.</p>\n\n<p>I'm not an experienced PHP Dev by the way I just enjoy learning and working basic markup.  Any helpful pointers someone can provide would be very much appreciated.  Thanks!</p>\n\n<pre><code>    $code = $this-&gt;request['code'];\n\n    $discount_status = 'NONE'; // no discount available / applied\n    if ( !empty($this-&gt;config['DISCOUNT_CODE']) &amp;&amp; !empty($this-&gt;config['DISCOUNT_PERCENT']) &amp;&amp; !empty($code) ) {\n        if ( $code == $this-&gt;config['DISCOUNT_CODE'] ) {\n            $discount_status = 'OK';\n        }\n        else {\n            $discount_status = 'ERROR';\n        }\n    }       \n\n    // calculate basket total\n    $basket_value = 0;\n    $discount_factor = 1;\n    if ( $discount_status == 'OK' ) {\n        // apply discount\n        $discount_factor = ( 100 - $this-&gt;config['DISCOUNT_PERCENT'] ) / 100;\n    }   \n\n    if ( !empty($_SESSION['basket']) &amp;&amp; is_array($_SESSION['basket']) ) {       \n    foreach( $_SESSION['basket'] as $basketItem ) {                 \n        // Apply discount to each item separately       \n        $basket_value += sprintf(\"%.02f\", $basketItem['detail_price'] * $discount_factor) * $basketItem['qty'];  \n        }       \n    }   \n\n    // check delivery cost\n    $delivery_area = $this-&gt;DeliveryAreaManager-&gt;getRecord($this-&gt;request['da']);\n    if ( !empty($delivery_area['cost']) &amp;&amp; ( $delivery_area['free_from'] &lt;= 0 || $basket_value &lt; $delivery_area['free_from'] ) ) {\n        $basket_value += $delivery_area['cost'];\n    }\n\n    // return JSON response\n    $data = JSONUtils::encode(\n        array(\n            'discount_status' =&gt; $discount_status,\n            'basket_value' =&gt; sprintf(\"%.02f\", $basket_value),\n        )\n    );\n\n    return $data;\n</code></pre>\n"},{"tags":["sql","postgresql","plpgsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":495,"score":1,"question_id":7945932,"title":"How return result of a select inside a function in PostgreSQL?","body":"<p>I have this function in PostgreSQL, but I don't know how to do to return the result of the query.</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION wordFrequency(maxTokens INTEGER) RETURNS SETOF RECORD AS $$\nBEGIN\n    SELECT text, count(*), 100 / maxTokens * count(*)\n    FROM (\n        SELECT text\n    FROM token\n    WHERE chartype = 'ALPHABETIC'\n    LIMIT maxTokens\n    ) as tokens\n    GROUP BY text\n    ORDER BY count DESC\nEND\n$$\nLANGUAGE plpgsql;\n</code></pre>\n\n<p>But I don't know how return the result of query inside PostgreSQL function.</p>\n\n<p>I found that the return type should be <code>SETOF RECORD</code>. right? But the return command is not right.</p>\n\n<p>What is the right way to do this?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13258297,"title":"A script to test existence of primary keys","body":"<p>Trying to figure out a SQL script to test the existence of primary keys in cerain tables.  If the table has no primary key, then the script should output the table name.</p>\n\n<pre><code>Tables to test:\nTableA\nTableB\nTableC\n</code></pre>\n\n<p>After running the script (and lets say TableA and TableC have PKs, but not TableB), then the output would be below:</p>\n\n<pre><code>NoKeys\nTableB\n</code></pre>\n"},{"tags":["php","sql","ini"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":5217542,"title":"Is it dangerous to remove \"magic_quotes_gpc\" from .htaccess file?","body":"<p>I'm installing <code>phplist</code> under my server that is based on cgi mode. I read that I have to hide the part related to \"magic_quotes_gpc\" on .htaccess file and that I also need to configure php.ini file so to allow magic quotes.</p>\n\n<p>I have configured a separate database for phplist different from that of my site.\nSo is there anything dangerous about that? What is it about \"sql injectors\" ?</p>\n\n<p>I'm using PHP Version 4.4.9</p>\n"},{"tags":["sql","join","sybase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13255780,"title":"How to join by column name","body":"<p>I have a table T1 such that </p>\n\n<pre><code>gsdv   |nsdv  |esdv\n-------------------\n228.90 |216.41|0.00\n</code></pre>\n\n<p>and a table T2 such that</p>\n\n<pre><code>ds                 |nm\n--------------------------\n'Non-Revenue Sales'|'ESDV'\n'Gross Sales'      |'GSDV'\n'Net Sales'        |'NSDV'\n</code></pre>\n\n<p>How do I get the following table?</p>\n\n<pre><code>ds                 |nm    |val\n---------------------------------\n'Non-Revenue Sales'|'ESDV'|0.00\n'Gross Sales'      |'GSDV'|228.90\n'Net Sales'        |'NSDV'|216.41\n</code></pre>\n\n<p>I know that I can do this with the following </p>\n\n<pre><code>SELECT ds,nm,esdv val FROM T1,T2 WHERE nm = 'esdv'\nUNION\nSELECT ds,nm,gsdv val FROM T1,T2 WHERE nm = 'gsdv'\nUNION\nSELECT ds,nm,nsdv val FROM T1,T2 WHERE nm = 'nsdv'\n</code></pre>\n\n<p>but I am looking for a more generic/nicer solution. I am using Sybase, but if you can think of a way to do this with other DBMS, please let me know. \nThanks.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13256604,"title":"MySql adding new column results in Too many connections","body":"<p>My problem is MySQL runs into a 'Too many connections' error when I add a new column to my live database.</p>\n\n<p>The database has 1 million records so it takes a while to add this. </p>\n\n<ul>\n<li>What is the reason the table locks? </li>\n<li>What to do to keep table running?</li>\n</ul>\n\n<p>The query I execute on the table with 1 million records (InnoDB)</p>\n\n<pre><code>ALTER TABLE table_name \nADD COLUMN new_table_column INT(11) NULL \nDEFAULT NULL ;\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","query","tsql","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13257860,"title":"When I run simple select query, is it possible not to show number of rows affected at the end?","body":"<p>I try to use OSQL in order to save query results in text file and later bulk insert those text file to a table. OSQL part is ok, however, in bulk insert, number of rows affected at the end of query results causes error. Here is an example;</p>\n\n<pre><code>select item_number, description, price from item\n\n3536114   Fruit mix     $3.99\n\n3536229   DO 20 liquid  $9.99\n\n3536251   Peppermint    $7.99\n\n(3 rows affected) ------&gt; I do not need this line.\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":8,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1591,"score":5,"question_id":9740256,"title":"How to compare if two strings contain the same words in T-SQL for SQL Server 2008?","body":"<p>When I compare two strings in SQL Server, there are couple of simple ways with <code>=</code> or <code>LIKE</code>.</p>\n\n<p>I want to redefine equality as:  </p>\n\n<p><em>If two strings contain the same words - no matter in what order - they are equal, otherwise they are not.</em></p>\n\n<p>For example:  </p>\n\n<ul>\n<li><code>'my word'</code> and <code>'word my'</code> are equal</li>\n<li><code>'my word'</code> and <code>'aaamy word'</code> are not</li>\n</ul>\n\n<p>What's the best simple solution for this problem?</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":427,"score":2,"question_id":6612306,"title":"prevent sql injection","body":"<p>Is there  a way to prevent sql injection by using stored procedures?</p>\n\n<p>I have a sql query as </p>\n\n<pre><code>select column name from table where field ='@value'\ncmd.parameters.add('@value', value);\n</code></pre>\n\n<p>I am using parameterized queries with least privileges. How can i write a basic stored procedure to prevent an sql injection.  Is that possible?</p>\n"},{"tags":["php","sql","sql-server"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13257659,"title":"sqlsrv returns empty query","body":"<p>I got a weird problem, on a other webserver (and other mssql server) there wasn't a problem.\nBut now I can connect to the server, I can connect to the database.</p>\n\n<p>And I can execute a query (at least I can use the syntax and it doesn't show an error) but it has no results. Also a <code>sqlsrv_fetch_array</code> returns <code>false</code>..</p>\n\n<p>And I don't have that much mssql knowledge, so I just have a very basic installation.</p>\n\n<p>What did I do wrong or what information do you need?</p>\n\n<p>PS. I'm using windows sql server 2008 R2.</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["mysql","sql","wordpress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13257548,"title":"MySQL - Search for column value based on another column value","body":"<p>I have the following SQL statement to calculate several fields based on 3 Wordpress tables. What I need is to calculate the <code>SUM</code> and <code>AVG</code> which are not working in the statement below. </p>\n\n<p>I need to sum all meta_values '3279' only when <code>meta_key = image</code>. The same applies to the <code>AVG</code> formula, ie, avg all meta_values when <code>meta_key=odd</code>.</p>\n\n<p>Any help is much appreciated!</p>\n\n<pre><code>SELECT (user_nicename) AS user,\n       SELECT SUM(IF('meta_key' = 'image', 'meta_value' = '3279', 1,0)) AS won,\n       SELECT SUM(IF('meta_key' = 'image', 'meta_value' = '3280', 1,0)) AS lost,\n       COUNT('meta_key'='odd') AS total,\n       FORMAT (AVG('meta_key' = 'odd', 'meta_value'),1) AS 'average odd',\n       FORMAT (AVG ('meta_key' = 'bet', 'meta_value'),1) AS 'average bet',\n       SUM('meta_key' = 'roi', 'meta_value') AS ROI\nFROM wp_9691postmeta pm, wp_9691posts p\nINNER JOIN wp_9691posts p ON pm.post_id = p.ID \nINNER JOIN wp_9691users u ON p.post_author = u.ID\nWHERE Month(data) = MONTH(CURRENT_DATE)\nGROUP BY (user_nicename)\nORDER BY ROI DESC\n</code></pre>\n"},{"tags":["java","sql","locking","db2","cluster-computing"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3293,"score":3,"question_id":1228833,"title":"Sharing a Java synchronized block across a cluster, or using a global lock?","body":"<p>I have some code that I want to only allow access to by one thread.  I know how to accomplish this using either <code>synchronized</code> blocks or methods, but will this work in a clustered environment?</p>\n\n<p>The target environment is WebSphere 6.0, with 2 nodes in the cluster.</p>\n\n<p>I have a feeling that <code>synchronized</code> won't work, since each instance of the application on each node will have its own JVM, right?</p>\n\n<p>What I am trying to do here is perform some updates to database records when the system is booted.  It will look for any database records that are older that the version of the code, and perform specific tasks to update them.  I only want one node to perform these upgrades, since I want to be sure that each work item is only upgraded once, and performance of these upgrades is not a big concern, since it only happens at application startup, and it only really does anything when the code has been changed since the last time it started up.</p>\n\n<p>The database is DB2v9, and I am accessing it directly via JNDI (no ORM layer).</p>\n\n<p>It has been suggested that a global lock might be the way to go here, but I'm not sure how to do that.</p>\n\n<p>Does anyone have any pointers in this arena?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","asp.net-mvc","amazon-web-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13252686,"title":"Can't connect website to database on amazon web services","body":"<p>I've just loaded my mvc.net 3 website up onto a micro instance on Amazon Web Services and put the database up there on a RDS as well. I can connect to the database via AWS Explorer in VS2010 just fine but when I add the connection string to my <code>web.config</code> it times out trying to access the database. Is there something else I need to do?</p>\n\n<p>The web site loads fine, it just times out when accessing the DB.</p>\n\n<p>Sorry if this is a but vague, the whole AWS thing is new to me.</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13253438,"title":"SQL join on table different from source table","body":"<p>I have the following SQL statement:</p>\n\n<pre><code>select distinct\n  u.id, \n  v1.code,\n  v2.code,\n  a1.phone,\n  a1.phone1,\n  SUM(o1.totalprice) as SALES\n  SUM(ot4.numbers) as NUMBERS\nfrom \n  users u,\n  orders o2\n inner join values v1 on v1.pk = u.gender\n inner join values v2 on v2.pk = u.egistration\n inner join addresses a1 on a1.owner = u.pk \n inner join orders o1 on o1.userpk = u.pk\n inner join orderthings ot4 on ot4.orderpk = o2.pk \nwhere \n  u.cccustomer = 1\nand\n  v2.code = 'REGISTERED'\ngroup by\n  u.id, \n  v1.code,\n  v2.code,\n  a1.phone,\n  a1.phone1\norder by \n  id;\n</code></pre>\n\n<p>Basically the join on orders doesn't work but I need to get the additional relation on the two tables that have no relation to users u. How can I accomplish that?</p>\n"},{"tags":["mysql","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":208,"score":2,"question_id":5532684,"title":"inner join for a query?","body":"<p>I want to do a sql query and have some problems:</p>\n\n<ol>\n<li><p>I want to select from table_1 the ID's Where parent_id is the value I have:</p>\n\n<pre><code>SELECT ID \n  FROM table_1 \n WHERE parent_ID = 'x'\n</code></pre></li>\n<li><p>I want to use the ID'S I got in 1. and </p>\n\n<pre><code>SELECT \n  FROM table_2 \n WHERE ID = 'The ID's from Query 1.'\n</code></pre></li>\n</ol>\n"},{"tags":["mysql","sql","query","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13253814,"title":"MySQL query to retrieve items that have an exact match in a many-to-many relationship","body":"<p>I have the following tables:</p>\n\n<pre><code>Media:\n- mediaid\n- mediatitle\n\n\nMediaTag:\n- mediaid\n- mediatag\n\n\nTag:\n- tagid\n- tagname\n</code></pre>\n\n<p>The following tags:</p>\n\n<pre><code>Tag: (1) - Public\nTag: (2) - Premium\nTag: (3) - Restricted\n</code></pre>\n\n<p>The following media with tags:</p>\n\n<pre><code>Media: (1) - Public\nMedia: (2) - Premium &amp; Restricted\nMedia: (3) - Premium\nMedia: (4) - Restricted\nMedia: (5) - No tags\n</code></pre>\n\n<p>Assume that a user has permissions to see only <code>Public (1)</code> and <code>Restricted (3)</code> tags. If a media has a combination of tags that the user doesn't have explicit access to, he's not allowed to see it. If a media has no tag it's not visible at all. So the user in this case would be able to see only <code>Media 1</code> and <code>Media 4</code>.</p>\n\n<p>Is it possible to write a MySQL query to retrieve the media assuming I have the user permissions in the form of an array with tag IDs <code>(1,3)</code> ?</p>\n"},{"tags":["mysql","sql","database"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257118,"title":"Link field values and ID to another table?","body":"<p>How do I link or add the field with all my users called \"username\" from my main table to another table so I can run checks and compare values without having to add a ton of rows to my main table? This would be a much cleaner and more organized setup. </p>\n\n<p>Table called login_users. This is my main table that stores their basic information</p>\n\n<pre><code>username       email                 password\nAnthony        user@email.com\nJosh           user@email.com\nTsuyoshi       user@email.com\n</code></pre>\n\n<p>Table 2 called badge_status. This table will hold their status with whether or not they have unlocked an achievement on my site. I want to bring in the <strong>usernames.</strong></p>\n\n<pre><code>username       badge1               badge2\nAnthony        locked               unlocked\nJosh           unlocked             locked\nTsuyoshi       unlocked             locked\n</code></pre>\n\n<p>Also, could table 2 automatically be updated with a new user when they sign up since all new sign ups are imported into the first table. As a side note, I am using phpmyadmin.</p>\n\n<p>Thanks for any help with getting this set up. Very much appreciated.</p>\n"},{"tags":["sql","database","performance","query","filter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257155,"title":"Architecture for a fast screener","body":"<p>I'm building a screener that should be able to search through a table about 50 columns wide and 7000 rows long really fast.</p>\n\n<p>Each row is composed of the following columns.</p>\n\n<p>primary_key, quantity1, quantity2, quantity3...quantity50.</p>\n\n<p>All quantities are essentially floats or integers. Hence a typical screener would look like this.</p>\n\n<pre><code>Get all rows which have quantity1 &gt; x and quantity2 &lt; y and quantity3 &gt;= z.\n</code></pre>\n\n<p>Indexing all columns should lead to really fast search times however some of the columns will be updating in realtime. Indexing everything obviously leads to very low insert/update times.</p>\n\n<p>A portion of the columns are fairly static though. Hence an idea was to segregate the data into two tables, one containing all columns that are static while the other containing data that is dynamic. Any screener would then be applied to both tables based on the actual query. And the results combined in the end.</p>\n\n<p>I am currently planning on using a MySQL engine, most probably INNoDB. However I'm looking to get much faster response times. An implementation of the same problem on a certain site was very snappy. Regardless of the query size, i was getting the results within 500 ms. Wondering what other options are available out there to implement this function.</p>\n\n<p>Any thoughts/hints towards a potential solution would be greatly appreciated.</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13256685,"title":"Optimization of query with counts of distinct column based on value of other column","body":"<p>There must be a better way to write this, but I'm just not sure what that is. Basically I'm trying to count the distinct values from one column where a condition is met in a separate column. I found this <a href=\"http://stackoverflow.com/questions/11853065/trying-to-count-distinct-values-of-a-field-based-on-value-of-a-different-field\">link</a>, but am not sure how to apply it here.</p>\n\n<p>Here is the query, I am using SQL Server 2008R2</p>\n\n<pre><code>SELECT lot,\n    (SELECT COUNT(DISTINCT d.pid) FROM invdet d WHERE upk = 0 and d.lot = [invdet].lot) as noUpk,\n    (SELECT COUNT(DISTINCT d.pid) FROM invdet d WHERE upk = 1 and d.lot = [invdet].lot) as isUpk\nFROM invdet\nWHERE ([status] in ('PQ','P2','FA','F2','BH','RL','SC','LD','PS'))\nGROUP BY lot\nHAVING COUNT(CASE WHEN invdet.upk = 1 THEN 1 ELSE null END) &gt; 0\n</code></pre>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13256882,"title":"SQL - Select Columns from table where another table column value equals column name list","body":"<p>seen a lot of similar posts about parsing data based on values but nothing quite what I want to get the result column from one table that contains the column names for another table. For example:</p>\n\n<pre><code> Select [col1], [col2]\n from Table1\n where (select changes as (col#)\n        from table2)\n</code></pre>\n\n<p>The col# is a list of the column names I want from Table1. Table2 changes column is a comma separated list. I wanted to figure a way to be able to get each column from Table1 that's in the list from table2. Any help is greatly appreciated.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13256813,"title":"SELECT SUM() FROM (SELECT (SELECT ())","body":"<p>I have a correct working T-SQL-script in this form</p>\n\n<pre><code>SELECT  columnA\n        AS\n        'numbers'\nFROM    tableA\nWHERE   clause\n</code></pre>\n\n<p>This script gives me as one column, called numbers, of integers. I want to sum these.</p>\n\n<p>Calling the above lines 'script' I tried the following setup</p>\n\n<pre><code>SELECT  SUM(numbers)\nFROM    (\n            script\n        )\n</code></pre>\n\n<p>Reading <a href=\"http://stackoverflow.com/questions/10439122/select-count-from-select\">select count(*) from select</a> I supposed this to work, however, it does not. I keep getting \"Incorrect syntax near.\"</p>\n\n<p>I do not know if it is important but that is here named columnA is itself maked by a SELECT statement.</p>\n"},{"tags":["sql","query","optimization","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13256383,"title":"SQL query: how to distinct count of a column group by another column","body":"<p>In my table I need to know if each <code>ID</code> has one and only one <code>ID_name</code>. How can I write such query?</p>\n\n<p>I tried:</p>\n\n<pre><code>select ID, count(distinct ID_name) as count_name \nfrom table \ngroup by ID \nhaving count_name &gt; 1\n</code></pre>\n\n<p>But it takes forever to run. </p>\n\n<p>Any thoughts?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13256336,"title":"fill empty column with sequence","body":"<p>Is there any way to fill an empty column with a ascending sequence of numbers starting from 1, without using identity?</p>\n\n<p>I tried the following cursor but it is filling the same value (450) for all rows in the column:</p>\n\n<pre><code>declare cur3 cursor for\nselect new_id from sheet1$\ndeclare @no int\ndeclare @no1 int\nset @no1 = 1\nopen cur3\nfetch next from cur3 into @no\nwhile(@@FETCH_STATUS = 0)\nbegin\nupdate sheet1$ set new_id = @no1\nset @no1 = @no1 + 1\nfetch next from cur3 into @no\nend\nclose cur3\ndeallocate cur3\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13254417,"title":"trying to create a trigger that check age from an insert and place into another table if less than 18","body":"<p>Develop a trigger that will be placed on the marketing list table that will insert a record into the child table if the person's age is less than 18 once an insert is attempted.</p>\n\n<p>SEE the code below: </p>\n\n<pre><code>Create Trigger on_insert_marketing_list\nOn marketing_list for insert\nAs\nBEGIN\n        Declare @Name varchar (100)\n        Declare @Dob date\n        Declare @Gender char(1)\n        Declare @Parish VARCHAR(50)\n        Declare @Mobile varchar(50)\n        Declare @Provider varchar(50)\n        Declare @age int\n\n        Select @age = datediff(year,@dob,getdate())from inserted\n\n        If (@age) &lt; 18      \n        BEGIN\n        Insert Into Childlist values(@Name,@Dob,@Gender,@Parish,@Mobile,@Provider)\n        END\n\nEnd\n\ninsert into marketing_list (Name, Dob, Gender,  Parish,  Mobile, Mobile_Provider) values\n('Kendrick Lamar', '3/4/2005','M','Kingston', '18764532345','LIME')\n</code></pre>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13256290,"title":"EF get Keyvalues of added objects","body":"<p>Is it possible to get the entity keyvalues of added objects?</p>\n\n<p>The keyvalues are set after context.SaveChanges(). But unfortunately after context.SaveChanges the EntityState.Added is gone.</p>\n"},{"tags":["php","sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13255566,"title":"SQL - Select IDs from two different tables","body":"<p>I have two tables that have logging information for different actions. I want to select information from both logging tables and display it. I cannot modify the application, so I can't modify the table structure. Assuming I wanted, say, 30 records, I figured I could write some kind of join query that would just return the IDs for each table, in order by time. Then I could simply run two separate queries selecting those IDs from the individual tables. I'm not sure how to do this, or if you even can do this, and I'm kind of at a loss. Can anyone help? If there's a cleaner solution I'd be happy to hear that as well, I'm working in PHP.</p>\n\n<p>Example data:</p>\n\n<p>MAGICAL SELECT ? FROM table1 MAGIC JOIN table2 MAGICALLY ORDER BY date DESC LIMIT 3</p>\n\n<p>Table 1</p>\n\n<pre><code>|------|-------|------------|\n| id   | date  | other data |\n|------|-------|------------|\n| 1    | 8     | ...        |\n| 2    | 5     | ...        |\n| 3    | 3     | ...        |\n|------|-------|------------|\n</code></pre>\n\n<p>Table 2</p>\n\n<pre><code>|------|-------|------------|\n| id   | date  | other data |\n|------|-------|------------|\n| 1    | 6     | ...        |\n| 2    | 4     | ...        |\n| 3    | 12    | ...        |\n|------|-------|------------|\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>|-----------|-----------|\n| table1_id | table2_id |\n|-----------|-----------|\n| NULL      | 3         |\n| 1         | NULL      |\n| NULL      | 1         |\n|-----------|-----------|\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","join","db2","left-join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13246686,"title":"2 Joins on the same table","body":"<p>I have, once again, a little problem with joins. I would like to refere to the same table which causes seem to cause some problems. I originally wanted to use left join (for both joins), because there are results where BBNR has no KVNR refered to it.\nI believe the problem is in the second left join, but so far I didnt find a way to solve this. A normal join won't work and a right join seems to end in nothingsness.</p>\n\n<pre><code>SELECT btst.Ordnungsbegriff AS BBNR, \n       COUNT(vp.KVNR) AS GKV, \n       COUNT (vp1.KVNR) AS PKV\nFROM T_Betriebsstaette btst\nLEFT JOIN T_VERSICHERUNGSZEIT vz \nON vz.BETRIEBSNUMMER = btst.Ordnungsbegriff\nAND vz.VALIDTO = date('2999-12-31')\nAND vz.PERSONENKREIS = 'Beschäftigte'\nAND vz.BEITRAGSGRUPPEKV_IID &gt; 0\nAND vz.PERSONENGRUPPENSCHLUESSEL IN (101, 102, 103, 118, 119)\nLEFT JOIN T_VERSICHERTEPERSON vp\nON vp.OID = vz.VERSPERS_VERSPERSON_ID\nAND ('1' = '0' \n     OR '1' = '1' \n     AND (vp.VIPKENNZEICHEN IS NULL \n          OR NOT vp.VIPKENNZEICHEN IS NULL\n          AND vp.VIPKENNZEICHEN  NOT IN (5, 6)))\nLEFT JOIN T_VERSICHERUNGSZEIT vz1\nON vz1.BETRIEBSNUMMER = btst.Ordnungsbegriff\nAND vz1.VALIDTO = date('2999-12-31')\nAND vz1.PERSONENKREIS = 'Beschäftigte'\nAND vz1.BEITRAGSGRUPPEKV_IID = 0\nAND vz1.BEITRAGSGRUPPEPV_IID = 0\nAND vz1.PERSONENGRUPPENSCHLUESSEL IN (101, 103, 118, 119)\nJOIN T_VERSICHERTEPERSON vp1\nON vp1.OID = vz1.VERSPERS_VERSPERSON_ID\nAND ('1' = '0' \n     OR '1' = '1' \n     AND (vp1.VIPKENNZEICHEN IS NULL \n          OR NOT vp1.VIPKENNZEICHEN IS NULL \n          AND vp1.VIPKENNZEICHEN  NOT IN (5, 6)))\nGROUP BY btst.Ordnungsbegriff\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13207075,"title":"Format a number with commas but without decimals in SQL Server 2008 R2?","body":"<p>I am using the following to create a comma formatted number in T-SQL. How can I get rid of the decimal point and the digits after decimal. So if I get 1,112.00 after formatting, how would I get only 1,112?</p>\n\n<pre><code>SELECT CONVERT(varchar, CAST(1112 AS money), 1)\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13255030,"title":"Oracle SQL - How to use the data dictionary","body":"<p>Oracle SQL - How to use the data dictionary</p>\n\n<p>I was trying oracle sql and was trying to find the name of all indexes owned by a user with the names of index keys in each index.</p>\n\n<p>I try to find from user_indexes in system catalogue view and display INDEX_NAME, INDEX_TYPE, COLUMN_NAME, COLUMN_POSITION but </p>\n\n<p>Below is what I tried:</p>\n\n<pre><code>select table_name, column_name, data_type from user_tab_columns;\n</code></pre>\n\n<p>But its seems insufficient to display all the user_indexes.. what should i do</p>\n"},{"tags":["php","html","sql","sharepoint","web"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13254863,"title":"Query Sharepoint for Table presentation on Web","body":"<p>I already have the ability to use PHP to send SQL queries to a connected Access file and display the output on a website.</p>\n\n<p>I need to implement automation so:</p>\n\n<p>Instead of exporting the Access file every time and overwriting the old file manually in the web dir, I would like to connect to and query the sharepoint directly.</p>\n\n<p>This way, every time the site was loaded/refreshed, it would be grabbing the latest data from the sharepoint.</p>\n\n<p>Is there any way to do this or is there a better meathod?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":593,"score":1,"question_id":6068619,"title":"Merging date intervals in SQL Server","body":"<p>I have the following data:</p>\n\n<pre><code>StartDate   |  EndDate\n-------------------------\n1982.03.02  |  1982.09.30 \n1982.10.01  |  1985.01.17 \n1985.06.26  |  1985.07.26 \n1985.07.30  |  1991.12.31 \n1992.01.01  |  1995.12.31 \n1996.01.01  |  2004.05.31 \n2004.06.05  |  2006.01.31 \n2006.02.01  |  2011.05.20              \n</code></pre>\n\n<p>I need to merge any intervals that are adjacent (both start and the end date are included in the intervals, so an interval ending on 2003.05.06 is adjacent with an interval starting on 2003.05.07), so in this case, the resulting set should be:</p>\n\n<pre><code>StartDate   |  EndDate\n-------------------------\n1982.03.02  |  1985.01.17 \n1985.06.26  |  1985.07.26 \n1985.07.30  |  2004.05.31 \n2004.06.05  |  2011.05.20              \n</code></pre>\n\n<p>For me, the obvious way to do this is to iterate the set with a cursor, and construct a result set row-by-row. However, this functionality will be within code that could potentially be called thousands of times in a day, on a server under heavy load, so I'd prefer not having any performance issues. Any data set is small (20 rows tops), and the data range is large, so any solution that generates all the dates in a range is unfeasible.</p>\n\n<p>Is there a better way I'm not seeing?</p>\n\n<hr>\n\n<p>Initialization code (from Damien's answer):</p>\n\n<pre><code>CREATE TABLE Periods (\n    StartDate datetime NOT NULL CONSTRAINT PK_Periods PRIMARY KEY CLUSTERED,\n    EndDate datetime NOT NULL\n)\n\nINSERT INTO Periods(StartDate,EndDate)\nSELECT '19820302', '19820930'\nUNION ALL SELECT '19821001', '19850117'\nUNION ALL SELECT '19850626', '19850726'\nUNION ALL SELECT '19850730', '19911231'\nUNION ALL SELECT '19920101', '19951231'\nUNION ALL SELECT '19960101', '20040531'\nUNION ALL SELECT '20040605', '20060131'\nUNION ALL SELECT '20060201', '20110520'\n</code></pre>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":13254224,"title":"SQL Order by a float column not working","body":"<p>I have the following rows in my db:</p>\n\n<pre><code>ID       Weight\n-----------------------------\n897      1.46357497509608E-11\n689      6.67145488899268E-12\n896      6.63573718293682E-12\n615      5.14817058560092E-12\n822      5.14806820534293E-12\n</code></pre>\n\n<p>When I execute the following SQL query: </p>\n\n<pre><code>SELECT * \nFROM mytable \nORDER BY weight DESC\n</code></pre>\n\n<p>the data is being returned in the same order.</p>\n\n<p>P.S. the same thing is happening from a Linq query in an ASP.NET C# application</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13249671,"title":"SQL Selecting Two Tables","body":"<p>I dont know how to write the select statement to get the information about details of intervention with only the student id.</p>\n\n<p>If the student id is 2. I would want to find the information about intervention named MENTORING.</p>\n\n<h2>student_intervention table</h2>\n\n<pre><code>id   student_id inter_details_id   start_date                   end_date         staff_id\n 1      2          1            2029-09-12 00:00:00     2029-10-12 00:00:00 0\n 2      2          1            2029-09-12 00:50:00     2029-10-12 00:00:00 0\n</code></pre>\n\n<h2>intervention_details</h2>\n\n<pre><code>   id      name           description\n    1      MENTORING      MENTORING2\n    2      BESPOKE        BESPOKE\n</code></pre>\n"},{"tags":["sql","oracle","olap","cube"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12081229,"title":"Oracle OLAP Expression/Analytical Functions and NA Values","body":"<p>This question is specific to NA values and Oracle OLAP Expression Syntax.</p>\n\n<p><a href=\"http://docs.oracle.com/cd/E11882_01/olap.112/e23381.pdf\" rel=\"nofollow\">http://docs.oracle.com/cd/E11882_01/olap.112/e23381.pdf</a></p>\n\n<p>I am trying to perform some simple avg and sum calculations and there are specific cases where I will have NA values.  It does not appear to exist as part of the Expression Syntax, but is there anyway to perform one of these calcs and skip these values?</p>\n"},{"tags":["php","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":26,"score":0,"question_id":13254743,"title":"Session variable not being stored","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8028957/warning-headers-already-sent-in-php\">“Warning: Headers already sent” in PHP</a>  </p>\n</blockquote>\n\n\n\n<p>Why does this not work? I expect to see whatever is input into the text box in first.php displayed back out in test.php.</p>\n\n<pre><code>    &lt;html&gt;\n&lt;body&gt;\n&lt;form action=\"test.php\"&gt;\nTest: &lt;input type=\"text\" name=\"test\" /&gt;\n&lt;br&gt; &lt;input type=\"submit\" name=\"submit\" /&gt;\n    &lt;?php\n    session_start();\n    $_SESSION['test'] = $_POST['test'];\n    ?&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Here is test.php</p>\n\n<pre><code>    &lt;?php\n    session_start();\n    $check = $_SESSION['test'];\n    echo $check; \n    ?&gt;\n</code></pre>\n"},{"tags":["sql","printing","console","sybase","output"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13252089,"title":"Sybase - Setting console output on for printing log statements","body":"<p>Does somebody know how to turn the console output on in Sybase. The usual statement like - ptint 'Hello', is not working for me, it just says command executed successfully without printing the log statement</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13225424,"title":"Insert elements/values into specific child element of XML column in t-sql","body":"<p>In SQL Server 2008, I would like to insert some elements and values into a specific child element of an xml column based on the value of another of that element's children (ID in this case). The xml currently looks like this: </p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;16&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;test&lt;/Name&gt;\n    &lt;Activities /&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>However, there could potentially be multiple <code>&lt;User&gt;</code> elements within the xml, and I need to insert only into the <code>&lt;User&gt;</code> of a specific <code>&lt;ID&gt;</code> value. How can I achieve this in MS SQL Server 2008/ t-sql? Thanks in advance.</p>\n\n<p><strong>Edit:</strong>\nTo simplify, I am grabbing the xml from that column and setting it to a variable:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nDECLARE @profile_id int\nSET @profile_id = 16\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE\nprofiles.value('(Profile/ID)[1]','int')= @profile_id)\n</code></pre>\n\n<p>The resulting xml value of @profiles_xml looks like what I have above.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13237477,"title":"How do I retrieve decimals when rounding an average in SQL","body":"<p>Here is my SQL statement</p>\n\n<pre><code>SELECT ROUND(AVG(column_name), 100) \nFROM [database].[dbo].[table]\n</code></pre>\n\n<p>The answer I retrieve is <code>3</code> with a possible range of numbers between <code>1 - 5</code> in 908 rows.</p>\n\n<p>I need it to say <code>3.0</code> or <code>3.09</code>. Is this possible?</p>\n"},{"tags":["sql","select","where"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13254884,"title":"Accessing results through WHERE","body":"<p>Well after my first question <a href=\"http://stackoverflow.com/questions/13230685/fetching-a-result-twice-with-deferend-name\">here</a> I came the below code which is correct and tested:<br/></p>\n\n<pre><code>SELECT DISTINCT\nid, title, description, expires,\ncreator_id,executer_id,\noc_opentask.priority_id,\noc_opentask.status_id, priority_name, status_name,\noc_user1.username AS executer_username,\noc_user2.username AS creator_username\nFROM oc_opentask\nINNER JOIN oc_opentask_priority \nON oc_opentask.priority_id=oc_opentask_priority.priority_id\nINNER JOIN oc_opentask_status \nON oc_opentask.status_id=oc_opentask_status.status_id\nINNER JOIN oc_user AS oc_user1 \nON oc_opentask.executer_id=oc_user1.user_id\nINNER JOIN oc_user AS oc_user2 \nON oc_opentask.creator_id=oc_user2.user_id\n</code></pre>\n\n<p>My next question is: I want to access those <code>executer_username</code> and <code>creator_username</code> with a WHERE attribute to compare it with a value, so what I am trying which is poping mystake is:</p>\n\n<pre><code>SELECT DISTINCT\nid, title, description, expires,\ncreator_id,executer_id,\noc_opentask.priority_id,\noc_opentask.status_id, priority_name, status_name,\noc_user1.username AS executer_username,\noc_user2.username AS creator_username\nFROM oc_opentask\nINNER JOIN oc_opentask_priority \nON oc_opentask.priority_id=oc_opentask_priority.priority_id\nINNER JOIN oc_opentask_status \nON oc_opentask.status_id=oc_opentask_status.status_id\nINNER JOIN oc_user AS oc_user1 \nON oc_opentask.executer_id=oc_user1.user_id\nINNER JOIN oc_user AS oc_user2 \nON oc_opentask.creator_id=oc_user2.user_id\nWHERE oc_opentask.creator_username='bill' \n</code></pre>\n\n<p>bill does exists in db, but my command to access that value is not correct, can any1 help me on this? Thanks</p>\n"},{"tags":["c#","sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13250882,"title":"Getting a SQL View via Entity Framework returns incorrect result","body":"<p>I have a very simple View in SQL Server which looks something like this, Where the <strong>Show</strong> is a result of <strong>LEFT JOIN</strong> with <strong>Character</strong> table:</p>\n\n<pre><code>+---------+----------+----------------------+  \n|  Name   | Surname  |         Show         |  \n+---------+----------+----------------------+  \n| Enoch   | Thompson | The Boardwalk Empire |  \n| Anthony | Soprano  | The Sopranos         |  \n| Walter  | White    | Breaking Bad         |  \n+---------+----------+----------------------+  \n</code></pre>\n\n<p>When I get this table via Entity Framework's <code>context.CharacterView.ToList()</code> in my application, the result looks like this: </p>\n\n<pre><code>+---------+----------+----------------------+  \n|  Name   | Surname  |         Show         |  \n+---------+----------+----------------------+  \n| Enoch   | Thompson | The Boardwalk Empire |  \n| Anthony | Soprano  | The Boardwalk Empire |  \n| Walter  | White    | The Boardwalk Empire |  \n+---------+----------+----------------------+  \n</code></pre>\n\n<p>However, in DB the CharacterView is <em>as it should be.</em></p>\n\n<hr>\n\n<h2>Create view query</h2>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE VIEW CharacterView AS\nSELECT c.Name AS [Name], \n       c.Surname AS [Surname], \n       s.Name AS [Show]\n\nFROM   [dbo].[Characters] AS c LEFT OUTER JOIN\n       [dbo].[Shows] AS scen ON c.ShowId = s.Id\n</code></pre>\n\n<hr>\n"},{"tags":["sql","erd"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13253996,"title":"Is there any way to represent many to many relationship without using junction tables?","body":"<p>And in addition to that, when you are drawing out ERD diagrams should you include the \"junction\" tables as entities, even though they are not explicitly mentioned in the spec, but you can clearly see that it is many to many relationship?</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":13254504,"title":"Aggregation for join ON clause","body":"<p>I have a table <code>item_table</code> like this:</p>\n\n<pre><code>item   age\n--------------    \n1      1 \n1      6 \n2      2    \n</code></pre>\n\n<p>I have the other table <code>price_table</code> like this:</p>\n\n<pre><code>item    pricetype    price\n--------------------------    \n1       O             5\n1       P             6\n1       V             7\n2       O             8\n2       P             9\n2       V             10\n</code></pre>\n\n<p>So, I want to inner join above two tables.</p>\n\n<pre><code>select *\nfrom item_table i\ninner join price_table p\non ...\n</code></pre>\n\n<p>There are some conditions about the <code>on</code>:</p>\n\n<ol>\n<li>if <strong>the average of age</strong> of an item is bigger than <code>3</code>, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P'</code></li>\n<li>If not, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P' or pricetype = 'V'</code></li>\n</ol>\n\n<p>So there are conditions for <code>on</code> conditions.</p>\n\n<p>I then write the query like this:</p>\n\n<pre><code>select i.item, i.type, p.pricetype, p.price\nfrom item_table i\ninner join price_table p on i.item = p.item \n    and (avg(i.age) &gt;= 3 and p.pricetype in ('O', 'P'))\n        or (avg(i.age) &lt; 3 and p.pricetype in ('O', 'P', 'V'))\n</code></pre>\n\n<p>The error is given: <code>An aggregate cannot appear in an ON clause unless it is in a subquery contained in a HAVING clause or select list, and the column being aggregated is an outer reference.</code></p>\n\n<p>I can't move the <code>avg</code> to <code>Having</code> because other conditions are depending on the <code>avg</code>.</p>\n\n<p><strong>How can I write the select query?</strong></p>\n"},{"tags":["php","mysql","sql","table","mysql-num-rows"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":36,"score":-4,"question_id":13254860,"title":"PHP/MYSQL mysql_num_row() error","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3698740/mysql-num-rows-supplied-argument-is-not-a-valid-mysql-result-resource\">mysql_num_rows(): supplied argument is not a valid MySQL result resource</a>  </p>\n</blockquote>\n\n\n\n<pre><code>$actcheck = \"SELECT * FROM users WHERE username='$username' AND password='$password' AND  = activated = '1'\";\n$query2 = mysql_query($actcheck);\n$count2 = mysql_num_rows($query2);\nif(!($count2==1)){\necho \"You have not activated\";\nexit();\n}\n</code></pre>\n\n<p><strong>Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource</strong>\nAny help?</p>\n"},{"tags":["sql","ruby","activerecord","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13221902,"title":"Return rows where the count of a character is?","body":"<p>I'm developing a rudimentary word finder app with sql and ruby where I have an array of letters to find available words.  It's easier to make the query by narrowing down what alphabetic letters aren't in the array. For ex.</p>\n\n<pre><code>alphabet= %w{a b c d e f g h i j k l m n o p q r s t u v w x y z}\n\navailable_letters = %w{p k z l p m t l n g g r u a r t n d z w a l m n e}\n</code></pre>\n\n<p>I can then subtract from alphabet, letters to exclude from my search and end up with an sql query like the one below.</p>\n\n<pre><code>select * from words\nwhere word not like '%b%' and word not like '%c%' and word not like '%f%'.....\n</code></pre>\n\n<p>This gives me all the available words with a combination of all available letters.  It does not narrow them down by the number of times that letter occurs.  So if I only have one \"E\",  I would like the query to narrow down words that only contain one e.  I'm not sure if this can be done with an sql query or whether I will need to use a procedure.  Anyone know a good way of solving this?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13254694,"title":"insert into with select","body":"<p>hello I would like to insert the values ​​in a column from a select query</p>\n\n<pre><code>insert into (cmts) stat_alert \nvalues(SELECT stat_alert.cell,stat_alert.cmts,cell_cmt.cmts FROM stat_alert`LEFT OUTER JOIN cell_cmt ON cell_cmt.`cell`=stat_alert.cell WHERE stat_alert.`cell`=cell_cmt.cell )\n</code></pre>\n\n<p>I have syntax error\nwho can help me??</p>\n"},{"tags":["sql","database","data","dbms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13254791,"title":"I'm looking for literature about theory of data management","body":"<p>I seek basic and common theoretical literature about DBMS and data managing. I found books only about concrete technologies like MySQL.</p>\n"},{"tags":["sql","oracle"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13253009,"title":"Oracle SQL , how to use current date - a specified date","body":"<p>For getting current date i use this..</p>\n\n<pre><code>select extract(year from sysdate) from dual;\n</code></pre>\n\n<p>For getting the date that my database hold i use this..</p>\n\n<pre><code>select extract(year from startdate) from staff;\n</code></pre>\n\n<p>But now i am trying to update a field call serviceYears inside staff, by using </p>\n\n<p><code>current year - year of start date</code> </p>\n\n<p>to get the amount of years the staff have committed to work. how do i achieve it..</p>\n\n<p>i am using oracle sql</p>\n\n<p><strong>Thanks!</strong></p>\n\n<p>I tried to use </p>\n\n<pre><code>SQL&gt; select dual.sysdate-staff.startdatefrom dual,staff;\n\nselect dual.sysdate-staff.startdatefrom from dual,staff\n            *\nERROR at line 1:\nORA-01747: invalid user.table.column, table.column, or column specification\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>select SYSDATE-to_date('01-jan-2007','dd-mon-yyyy') from dual;\n\nBut it return me\nSYSDATE-TO_DATE('01-JAN-2007','DD-MON-YYYY')\n--------------------------------------------\n                                  2136.93719\n</code></pre>\n\n<p>How do i just get the year?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13254109,"title":"How to determine the place of a row in ordered SQL table?","body":"<p>I have a table of users and a 'points' column. I would like to determine the number/place of the row across all the users ordered by 'points'.</p>\n\n<p>I could just get result of all users data and then do while loop, and stop when id equals necessary user. But I believe there is a more efficient way do to that because my table will contain ~100 000 rows.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":11110775,"title":"How to generate table name by datetime?","body":"<p>I realize this is syntactically bad but I figure it somewhat explains what I'm trying to do. Essentially, I have a batch job that is going to run each morning on a small table and as a part of the spec I need to create a backup prior to each load that can be accessed by a report.</p>\n\n<p>What I have so far is:</p>\n\n<pre><code>select  *\ninto    report_temp.MSK_Traffic_Backup_ + getdate()\nfrom    property.door_traffic\n</code></pre>\n\n<p>How can I make this function or should I consider doing this a better way?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13251097,"title":"Find all users at a certain stage in the process","body":"<p>I have a <code>Patient</code> which follows a process defined with multiple <code>Phase</code>s. When a patient is at a phase, there is a <code>Status</code> created, connecting patient and phase at a specific time stamp.</p>\n\n<p>In MySQL my tables look like:</p>\n\n<pre><code>patient:\n  id (int)\n\nphase:\n  id     (int)\n  order: (int)\n  name:  (varchar)\n\nstatus:\n  patient_id: (int, FK)\n  phase_id:   (int, FK)\n  timestamp:  (datetime)\n</code></pre>\n\n<p>Now I have phases A > B > C > D. I want to select all patients who are <strong>now</strong> at phase B or C. Patients only at phase A must be excluded, patients at phase D (so having a status for B and C) must be excluded too.</p>\n\n<p><strong>My trials</strong></p>\n\n<p>So I want a select something like this to start with:</p>\n\n<pre><code>SELECT p.*, s.*, ph.*\nFROM patient p\nLEFT JOIN status s on p.id  = s.patient_id\nLEFT JOIN phase ph on ph.id = s.phase_id\nWHERE s.id IN \n(\n  // sub query\n)\nORDER BY s.timestamp\n</code></pre>\n\n<p>I thought to select all patients with a given status x. The status x is something like this to start with:</p>\n\n<pre><code>SELECT status.*, phase.name\nFROM status\nLEFT JOIN phase ON phase.id=status.phase_id\nWHERE phase.name IN ('B', 'C')\nGROUP BY status.patient_id\n</code></pre>\n\n<p>But I cannot solve the rest: obviously there is no exclusion made for people further in the process. If I add a <code>max(status.timestamp) as max_timestamp</code> in the select, I see the <code>status.timestamp</code> and <code>max_timestamp</code> differ.</p>\n\n<p>In this query I haven't even used the <code>order</code> in the phase table, I simply wanted to order on <code>id</code> first, but since the process might change over time, I thought that would be a bad idea. So that's missing as well.</p>\n\n<p><strong>Question</strong></p>\n\n<p>Perhaps I am completely on the wrong track and I do not need the subquery at all. I think the problem is quite clear: how can I select the patients based on a list of given phases?</p>\n"},{"tags":["sql","postgresql","cost","explain"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":42,"score":2,"question_id":13240724,"title":"Cost for nested anti loop on Explain Analyze","body":"<p>I am getting the followig output with explain analyze:</p>\n\n<pre><code>Nested Loop Anti Join  (cost=0.00..36.92 rows=83 width=3) (actual time=0.303..1 0.631 rows=83 loops=1)\n-&gt;  Seq Scan on paises p  (cost=0.00..5.46 rows=246 width=3) (actual time=0.0 43..0.336 rows=246 loops=1)\n-&gt;  Index Scan using ciudades_pkey on ciudades c  (cost=0.00..12.92 rows=192 width=3) (actual time=0.038..0.038 rows=1 loops=246)\n      Index Cond: (c.pais_codigo = (p.pais_codigo)::bpchar)\nTotal runtime: 10.897 ms\n(5 rows)\n</code></pre>\n\n<p>I cant understand why is the loop anti join cost 36.92.</p>\n\n<p>In other sites I have seen the formula for the loop: cost of upper scan + upper row * inner cost.</p>\n\n<p>But I am getting a cost of 36.92, so no way.\nHow is the dbmanager resolving this query?</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13253275,"title":"IF ELSE for the conditions of join?","body":"<p>I am using SQL Server.</p>\n\n<p>I have a table <code>item_table</code> like this:</p>\n\n<pre><code>item   age\n--------------    \n1      1 \n1      6 \n2      2    \n</code></pre>\n\n<p>I have the other table <code>price_table</code> like this:</p>\n\n<pre><code>item    pricetype    price\n--------------------------    \n1       O             5\n1       P             6\n1       V             7\n2       O             8\n2       P             9\n2       V             10\n</code></pre>\n\n<p>So, I want to inner join above two tables.</p>\n\n<pre><code>select *\nfrom item_table i\ninner join price_table p\non ...\n</code></pre>\n\n<p>There are some conditions about the <code>on</code>:</p>\n\n<ol>\n<li>if <strong>the average of age</strong> of an item is bigger than <code>3</code>, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P'</code></li>\n<li>If not, then I do: <code>inner join price_table on pricetype = 'O' or pricetype = 'P' or pricetype = 'V'</code></li>\n</ol>\n\n<p>So there are conditions for <code>on</code> conditions.</p>\n\n<p><strong>How can I write the select query?</strong></p>\n\n<p><strong>Edit:</strong>\nI changed the condition to be <strong>average of age</strong>, instead of <code>type</code></p>\n"},{"tags":["sql","sql-server","performance"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13253522,"title":"Fast SQL Server search on 40M text records","body":"<p>I have a SQL Server 2005 database with a table containing 40 million records. Each record contains a column that stores a comma separated list of keywords. Each keyword is a combination of letters and numbers. The keywords are up to 7 characters long and on average there are 15 keywords per record. The keywords are not unique across rows.</p>\n\n<p>I want to search on full or part of the keyword.</p>\n\n<p>I've created Full text index which shows 328,245,708 unique key count. The search efficiency is fine for queries of 4 or more characters (around <strong>100ms</strong> on the test machine), but too slow for queries that have 3 or less characters (up to <strong>3s</strong> on the test machine).</p>\n\n<p>I've been trying both <code>CONTAINSTABLE</code> and <code>CONTAINS</code> queries of a sort <code>'[query]*'</code> with similar result.</p>\n\n<p>I believe the performance of the short queries is slower, because short words repeat across different records more frequently.</p>\n\n<p>Sorting the results is not crucial, and I've been trying to return <code>TOP X</code> results sorted on Rank from <code>CONTAINSTABLE</code>. This doesn't provide the desired performance.</p>\n\n<p>How can I make this search faster for short queries?</p>\n"},{"tags":["sql","sql-server","query","sql-server-2005"],"answer_count":9,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":13253445,"title":"Select Part of Column","body":"<p>I was wondering if anyone could help with a query to select part of a column.</p>\n\n<p>The column 'criteriadata' contains data that would look like this:</p>\n\n<blockquote>\n  <p><strong>CriteriaData</strong></p>\n  \n  <p>14 27 15 C</p>\n  \n  <p>14 30 15 DD</p>\n  \n  <p>14 38 15 Pass</p>\n  \n  <p>14 33 15 Pass</p>\n</blockquote>\n\n<p>How can I select just the data that appears after the number 15.</p>\n\n<p>Many thanks.</p>\n"},{"tags":["sql","ado.net","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13253235,"title":"Dataset vs Pure queries","body":"<p>Friends,</p>\n\n<p>I have seen many examples in ADO.NET that load entire data into Dataset, set up relationships, etc., and manipulate data in disconnected manner.  Could someone please cast some light onto the pros and cons of this approach versus reading/writing data as and when required using pure sql queries?  I find in some applications the dataset loading time is too long, especially when there are thousands of records.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13252987,"title":"Inner Join two table-Valued Parameters doesn't work","body":"<p>I am trying to 'inner join' two table values parameters but when i execute the query it takes for ever and i have to stop debug in ms sql server management studio 2008.</p>\n\n<p>The query:</p>\n\n<pre><code>    @allClients [dbo].[ImportedClients] READONLY,\n    @NewClients [dbo].[ImportedClients] READONLY\n\n--Update Clients table in db with new clients\n\n    UPDATE [dbo].[Clients]\n        SET \n\n            Email = ISNULL(ct.Email, x.Email), \n            FirstName = ISNULL(ct.FirstName, x.FirstName), \n            LastName = ISNULL(ct.LastName, x.LastName), \n            Telephone = ISNULL(ct.Telephone, x.Telephone), \n            Cellphone = ISNULL(ct.Cellphone, x.Cellphone), \n\n\n\n        FROM @NewClients ct\n        inner join @allClients x \n        ON (x.Email = ct.Email)     \n\n        WHERE ct.Status &gt; -1 \n</code></pre>\n\n<p>What i am trying to do is: Update all the clients information for rows that exist in both @NewClients and @allClients so i used inner join. \nIs it possible to JOIN two  table-Valued Parameters?\nThis query doesn't (query doesn't complete without an error) work even with a few rows.</p>\n\n<p>any suggestions?</p>\n"},{"tags":["mysql","sql","database","database-design"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13250277,"title":"Designing the database layout for a webshop plugin","body":"<p>I'm working on a webshop plugin for a small Content Management System.</p>\n\n<p>The idea is that a <strong>product</strong> is within a certain <strong>category</strong> (for instance T-shirts). The category determines which <strong>attributes</strong> (for instance Color and Size in case of the T-shirt, or capacity in case of an MP3 player) can apply to the product. Based on those attributes, a product can have multiple <strong>variants</strong>.</p>\n\n<p>In case of the t-shirt, those variants could be:</p>\n\n<ul>\n<li>Small Black</li>\n<li>Medium Black</li>\n<li>Large Black</li>\n<li>Small White</li>\n<li>Medium White</li>\n<li>Large White</li>\n</ul>\n\n<p>This is what I currently have:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FNTlq.png\" alt=\"current database layout\"></p>\n\n<p>Does this make sense? Or can I improve this design?</p>\n\n<p>Second question is, I want to display a list of attributes to provide a way of filtering products. For instance, for attribute Color one should be able to click 'Black', which displays a list of products that</p>\n\n<ul>\n<li>have a row in product_attribute with value 'Black', or</li>\n<li>have a variant with a row in product_variant_attribute with value 'Black'</li>\n</ul>\n\n<p>Would that be possible, and how?</p>\n\n<p>Currently I have the following SQL:</p>\n\n<pre><code>SELECT\n    variant_attr.*,\n    COUNT(DISTINCT prod.id) AS prod_count\nFROM catalog_product_variant_attribute AS variant_attr\nINNER JOIN catalog_product_variant AS variant ON variant.id = variant_attr.variant_id\nINNER JOIN  catalog_product AS prod ON prod.id = variant.product_id\nWHERE variant_attr.attribute_id = 1 AND prod.category_id IN (4,6,7,5,2)\nGROUP BY variant_attr.value ASC\n</code></pre>\n\n<p>1 is the attribute's <code>id</code> and (4,6,7,5,2) are the id's of the current category and all it's children (because if category T-shirts has a parent category Clothing, I want to display all the t-shirts in Clothing as well)</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":80,"score":1,"question_id":13250635,"title":"how i can get these with mysql?","body":"<p>I am new to mysql.</p>\n\n<p>I have on survey with clicks, period(date). Now i have to find out number of clicks per month, like:</p>\n\n<pre><code>MON  CLICKS\nnov  0 \noct  34 \nsep  67 \naug  89\n</code></pre>\n\n<p>I have used code like this:</p>\n\n<pre><code>select MONTHNAME(period) mon,  IFNULL(count(id),0) as Clicks\nfrom survey\nwhere period &gt; DATE_SUB(now(), INTERVAL 3 MONTH)\ngroup by EXTRACT(MONTH FROM period)\n</code></pre>\n\n<p>It is not working for with no records.</p>\n\n<p>Here one thing I suppose there is no record in that month it should show 0: if there is no record in <code>nov</code> the number of clicks should be <code>0</code>.</p>\n\n<pre><code>my table structure was like this \nCREATE TABLE `survey` (\n  `id` int(2) NOT NULL auto_increment,\n   `period` datetime default NULL)\n</code></pre>\n\n<p>for last four weeks i have used </p>\n\n<pre><code> SELECT uq.timespan, COALESCE(tsq.TotalClicks, 0) as Clicks FROM (\nSELECT '22-28 days' as timespan\nunion SELECT '15-21 days'\nunion SELECT '8-14 days'\nunion SELECT 'up to 7 days'\n\n)uq LEFT JOIN (\nSELECT CASE \n    WHEN submitdate &gt;= NOW() - INTERVAL 4 WEEK\n                AND submitdate &lt; NOW() - INTERVAL 3 WEEK THEN '22-28 days'\n    WHEN submitdate &gt;= NOW() - INTERVAL 3 WEEK\n           AND submitdate &lt; NOW() - INTERVAL 2 WEEK THEN '15-21 days'\nWHEN submitdate &gt;= NOW() - INTERVAL 2 WEEK\n    AND submitdate &lt; NOW() - INTERVAL 1 WEEK THEN '8-14 days'\nWHEN submitdate &gt;= NOW() - INTERVAL 1 WEEK THEN 'up to 7 days'\n       END Weeksubmitdate, \n           count(id) TotalClicks\nFROM  survey \nWHERE submitdate &gt;= NOW() - INTERVAL 4 WEEK\nGROUP BY Weeksubmitdate\n)tsq ON uq.timespan = tsq.Weeksubmitdate\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13252840,"title":"Select rows which don't have a field specified","body":"<p>I have a table with the following fields:</p>\n\n<pre><code>object_id\nattr_id\nstring_value\n</code></pre>\n\n<p>The object_id refers to an object in another table, as does the attribute id (they are both foreign keys).</p>\n\n<p>So for example I have rows like this:</p>\n\n<pre><code>22, 14, blah\n22, 30, argh\n22, 31, moo\n44, 30, argh\n44, 31, kaw\n</code></pre>\n\n<p>As you can see object 44, does not have attribute 14 set with a value.</p>\n\n<p>What I want to do is select all objects which do not have attribute 14 defined.</p>\n\n<p>Does anyone have any idea how to do this?</p>\n"},{"tags":["ios","sql","phonegap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13253228,"title":"Get resultSet keys in phonegap?","body":"<p>With say 5 fields in the DB, I know the columns that can be queried and use:</p>\n\n<pre><code>function getDetails_success (tx, results) {\n    var len = results.rows.length;\n\n    for (var i=0; i&lt;len; i++) {\n\n        var content = results.rows.item(i);\n        buf += '&lt;tr '+ content.OID+'&gt;';\n        buf += '&lt;tr '+ content.KID+'&gt;';\n    }\n}\n</code></pre>\n\n<p>and so on.</p>\n\n<p>What if I have 50 fields, of which 5 random fields has to be displayed. Do I get the keys from the resultset? What are the various ways I can approach this?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13253259,"title":"SQL Server Replace Command with WIldcard","body":"<p>I am in need of some help. Thanks to fellow user davids, I was able to get certain things working within SQL Server and am in need of some more help. Here is what I am trying to do:</p>\n\n<pre><code>UPDATE Table1 SET keyfield=(REPLACE(REPLACE(Column1,'http://*/folder/',''),'.avi',''))\nUPDATE Table2 SET keyfield=(REPLACE(REPLACE(Column2,'http://server2/folder/',''),'.mpg',''))\n</code></pre>\n\n<p>Can anyone help me out or point me in the right direction to get the wildcard to work? This particular column, the * is an IP Address and it will change all the time. Granted I will know the IP's ahead of time and can probably do it one by one, but I would prefer to have it automatically replace. Thanks in advance!</p>\n"},{"tags":["sql","string","tsql","count","symbols"],"answer_count":3,"favorite_count":2,"up_vote_count":17,"down_vote_count":0,"view_count":12297,"score":17,"question_id":1860457,"title":"How to count instances of character in SQL Column","body":"<p>I have an sql column that is a string of 100 'Y' or 'N' characters. For example: </p>\n\n<blockquote>\n  <p>YYNYNYYNNNYYNY...</p>\n</blockquote>\n\n<p>What is the easiest way to get the count of all 'Y' symbols in each row.</p>\n"},{"tags":["sql","doctrine","left-join"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":113,"score":4,"question_id":12533223,"title":"How to use left join like right join in Doctrine","body":"<p>So I've been racking my brain for a while now. In Doctrine there is no concept of right join. I know that you can use a left join like a right join but I can't figure it out for my example which is why I'm here.</p>\n\n<p>My example:\nI have an entity in Doctrine which has a one-to-one relationship with itself called \"parent\".\nI am trying to get all entities and their children(if they exist) with no duplicates. </p>\n\n<p>With a right join this is simple because I can say: </p>\n\n<pre><code>    SELECT parent.*, child.*\n    FROM table child\n    RIGHT JOIN table parent ON parent.id = child.parent_id\n    WHERE parent.parent_id is null;\n</code></pre>\n\n<p>But using a left join I am returned results that I can not figure out what the where clause should be to filter them out.</p>\n\n<p>So my question is \"Does doctrine have a way of doing right join\" or \"How can I use the left join operation like a right join\"?</p>\n\n<p>---EDIT---</p>\n\n<p>You guys are correct in what you are saying about changing the ordering of tables I select from but I am using Doctrine so the relationship does child->parent. Here is my doctrine query:</p>\n\n<p>My Entity:</p>\n\n<pre><code>/**\n * @Entity\n * @Table(name=\"entity\")\n */\nclass Entity\n{\n...\n/**\n * @OneToOne(\n *     targetEntity=\"Entity\",\n *     fetch=\"EAGER\"\n * )\n * @JoinColumn(name=\"parent_id\", referencedColumnName=\"id\")\n */\nprivate $parent;\n...\n}\n</code></pre>\n\n<p>My doctrine select statement:</p>\n\n<pre><code>$em-&gt;createQueryBuilder()\n-&gt;select(array('child', 'parent'))\n-&gt;from('Entity', 'child')\n-&gt;leftjoin('child.parent', 'parent')\n-&gt;orderBy('parent.id','asc')\n-&gt;getQuery()\n-&gt;execute();\n</code></pre>\n\n<p>I am not sure how and IF I can switch the ordering of tables. I also tried creating another relationship from entity to itself (like the way I did parent) but called it child. But when I updated the db with the new schema doctrine threw errors.</p>\n\n<p>Any ideas? And Thanks for the quick responses!</p>\n\n<p>---EDIT 2---</p>\n\n<p>Left join sql and results:</p>\n\n<pre><code>SELECT child.id, child.changed_timestamp, child.parent_entity_id, parent.id, parent.changed_timestamp, parent.parent_entity_id \nFROM content child \nLEFT JOIN content parent ON child.parent_entity_id = parent.id   \nORDER BY parent.id ASC\n\nchild_id    child_timestamp parent_entity_id    parent_id   parent_timestamp    parent_entity_id\n1   8/16/12 20:29   NULL    NULL    NULL    NULL\n7   9/20/12 16:07   NULL    NULL    NULL    NULL\n8   8/17/12 16:08   NULL    NULL    NULL    NULL\n9   8/17/12 20:44   NULL    NULL    NULL    NULL\n10  8/17/12 21:03   NULL    NULL    NULL    NULL\n11  8/17/12 21:17   NULL    NULL    NULL    NULL\n194 9/19/12 9:58    NULL    NULL    NULL    NULL\n195 9/20/12 10:38   NULL    NULL    NULL    NULL\n196 9/19/12 11:58   NULL    NULL    NULL    NULL\n197 NULL            196 196 9/19/12 11:58   NULL\n200 9/20/12 16:02   1   1   8/16/12 20:29   NULL\n202 9/20/12 16:35   NULL    NULL    NULL    NULL\n204 9/21/12 8:41    NULL    NULL    NULL    NULL\n206 NULL            204 204 9/21/12 8:41    NULL\n</code></pre>\n\n<p>Right join results:</p>\n\n<pre><code>SELECT child.id, child.changed_timestamp, child.parent_entity_id, parent.id, parent.changed_timestamp, parent.parent_entity_id \nFROM content child \nRIGHT JOIN content parent ON child.parent_entity_id = parent.id   \nWHERE parent.parent_entity_id is null\nORDER BY parent.id ASC\n\nchild_id    child_timestamp parent_entity_id    parent_id   parent_timestamp    parent_entity_id\n200 9/20/12 16:02   1   1   8/16/12 20:29   NULL\nNULL    NULL    NULL    7   9/20/12 16:07   NULL\nNULL    NULL    NULL    8   8/17/12 16:08   NULL\nNULL    NULL    NULL    9   8/17/12 20:44   NULL\nNULL    NULL    NULL    10  8/17/12 21:03   NULL\nNULL    NULL    NULL    11  8/17/12 21:17   NULL\nNULL    NULL    NULL    194 9/19/12 9:58    NULL\nNULL    NULL    NULL    195 9/20/12 10:38   NULL\n197 NULL    196 196 9/19/12 11:58   NULL\nNULL    NULL    NULL    202 9/20/12 16:35   NULL\n206 NULL    204 204 9/21/12 8:41    NULL\n</code></pre>\n\n<p>I want to achieve the results with the right join sql. Unique parent entities with their associated children(if they exists) but I need to achieve it using doctrine. Thanks again!</p>\n"},{"tags":["mysql","sql","inner-join"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13253050,"title":"MySQL select row from two tables even though only one table may have the row","body":"<p>I have two tables, <code>posts</code> and <code>pages</code>. The <code>posts</code> table has more columns than the <code>pages</code> table, but other than that they are the same in terms of schema. </p>\n\n<p>If a <code>slug</code> is given, the row with the right <code>slug</code> could exist in the <code>pages</code> table, or the <code>posts</code> table. I was thinking of something like</p>\n\n<pre><code>SELECT * \nFROM pages \nWHERE slug = 'about'\n\nUNION \n\nSELECT * \nFROM posts \nWHERE slug = 'about'\n</code></pre>\n\n<p>but that requires the row with the <code>slug</code> of \"about\" to be in both tables. There's probably a simple <code>INNER JOIN</code> I could use, but my SQL knowledge is limited.</p>\n\n<p>To clarify, I want to be able to search across both tables as if they were one.</p>\n\n<p>Here is the <code>posts</code> table structure:</p>\n\n<pre><code>`slug` varchar(128) NOT NULL,\n`id` varchar(100) NOT NULL,\n`title` text NOT NULL,\n`published` bigint(20) NOT NULL,\n`content` longtext NOT NULL,\n`author` text NOT NULL,\n`status` enum('published','draft','trashed') NOT NULL\n</code></pre>\n\n<p>and the <code>pages</code> structure:</p>\n\n<pre><code>`slug` varchar(128) NOT NULL,\n`id` varchar(100) NOT NULL,\n`title` text NOT NULL,\n`content` longtext NOT NULL,\n`menu_order` int(11) DEFAULT NULL,\n`status` enum('published','drafted','trashed') NOT NULL\n</code></pre>\n"},{"tags":["sql","sql-server-2008","csv"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13252580,"title":"Importing a CSV into SQL when there is a \",\" in the field","body":"<p>I need to import a CSV into a SQL 2008 database.  One of the fields is a directory, and apparently there are over 1600 rows that have a \",\" in the field name.  This field is now broken out incorrectly in my database.  There are over 100000 rows total.</p>\n\n<p>How can I avoid this and modify my statement?</p>\n\n<p>Here is the creation of the table:</p>\n\n<pre><code>create table tablename\n(\nDirectory       varchar(1000),\nName            varchar(1000),\nSize            varchar(50),\nCreationTime    varchar(100),\nLastAccessTime  varchar(100),\nLastWriteTime   varchar(100)\n)\n</code></pre>\n\n<p>Below is the code I used to import it:</p>\n\n<pre><code>BULK\nINSERT tablename\nFROM 'c:\\EmailCSVs\\myfile.csv'\nWITH\n(\nFIRSTROW = 2,\nFIELDTERMINATOR = ',',\nROWTERMINATOR = '\\n'\n)\nGO\n</code></pre>\n\n<p>An example in the directory field looks like this:</p>\n\n<pre><code>\\\\drive\\share\\nightly.175\\savemail\\user\\(Monday, January 10, 2011, 500 PM)\n</code></pre>\n\n<p>And here is an example row in the CSV:</p>\n\n<pre><code>\"\\\\drive\\share\\nightly.175\\savemail\\user\\(Monday, January 10, 2011, 500 PM)\",\"Archive #1.1.pst\",\"271360\",\"1/14/2011 8:37:05 AM\",\"6/1/2011 12:00:38 AM\",\"1/14/2011 2:45:27 PM\"\n</code></pre>\n"},{"tags":["c#",".net","sql","performance","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13252966,"title":"Fastest Get data from remote server","body":"<p>I'm creating a windows application in which I need to get data using ado.net/(Or any other way using C# if any ). From one table. The database table apparently has around <code>100000</code> records and it takes forever to download.</p>\n\n<p>Is there any faster way where I could get data into faster? </p>\n\n<p>I tried the <code>DataReader</code> but still isn't fast enough. </p>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13252846,"title":"Understanding sql queries fired by ActiveRecord","body":"<p>I have two tables one trip and one txns having one to many relationship in oracle db.\nWhen i fire the below query </p>\n\n<pre><code>Trip.where(\"upper(trips.domain) = 'FOOBAR.COM'  and txns.user_id = 50001 and txns.txn_type = '1'\").includes([:txns]).order('trips.created_at desc').limit(10).offset(0)\n</code></pre>\n\n<p>For this there were two queries in the sql log.</p>\n\n<pre><code>    Trip Load (4920.4ms)   SELECT * FROM (\n    SELECT raw_sql_.*, rownum raw_rnum_\n    FROM (SELECT DISTINCT \"TM\".\"TRIPS\".id, FIRST_VALUE(trips.created_at)\n OVER (PARTITION BY \"TM\".\"TRIPS\".id ORDER BY trips.created_at desc) AS alias_0__ FROM \"TM\".\"TRIPS\" LEFT OUTER JOIN \"TXNS\" ON \"TXNS\".\"TRIP_ID\" = \"TM\".\"TRIPS\".\"ID\"\n WHERE (upper(trips.domain) = 'FOOBAR.COM' and txns.txn_type = '1') \nORDER BY alias_0__ DESC) raw_sql_\n    )\n    WHERE raw_rnum_ between 1 and 10\n\n    SQL (186.2ms)  SELECT \"TM\".\"TRIPS\".\"ID\" AS t0_r0, \"TM\".\"TRIPS\".\"TRIP_REF\" AS t0_r1, \"TM\".\"TRIPS\".\"TRIP_NAME\" AS t0_r2, \n\"TM\".\"TRIPS\".\"START_DATE_TIME\" AS t0_r3, \"TM\".\"TRIPS\".\"END_DATE_TIME\" AS t0_r4, \"TM\".\"TRIPS\".\"AMOUNT\" AS t0_r5, \"TM\".\"TRIPS\".\"CREATED_AT\" AS t0_r6,\n \"TM\".\"TRIPS\".\"UPDATED_AT\" AS t0_r7, \"TM\".\"TRIPS\".\"USER_ID\" AS t0_r8, \n\"TM\".\"TRIPS\".\"BOOKING_STATUS\" AS t0_r9, \"TM\".\"TRIPS\".\"TRAVELLERS\" AS t0_r10, \n\"TM\".\"TRIPS\".\"USER_TRIP_NAME\" AS t0_r11, \"TM\".\"TRIPS\".\"CONTACT_DETAIL_ID\" AS t0_r12, \n\"TM\".\"TRIPS\".\"AIR\" AS t0_r13, \"TM\".\"TRIPS\".\"HOTEL\" AS t0_r14, \"TM\".\"TRIPS\".\"DOMAIN\" AS t0_r15, \"TM\".\"TRIPS\".\"TRAIN\" AS t0_r16, \"TM\".\"TRIPS\".\"TAGS\" AS t0_r17, \"TM\".\"TRIPS\".\"CURRENCY\" AS t0_r18, \"TM\".\"TRIPS\".\"CUR_INR_VALUE\" AS t0_r19, \n\"TM\".\"TRIPS\".\"COMPANY_ID\" AS t0_r20, \"TXNS\".\"ID\" AS t1_r0, \"TXNS\".\"TRIP_ID\" AS t1_r1,\n \"TXNS\".\"USER_ID\" AS t1_r2, \"TXNS\".\"TXN_TYPE\" AS t1_r3, \"TXNS\".\"STATUS\" AS t1_r4, \"TXNS\".\"SOURCE_TYPE\" AS t1_r5, \"TXNS\".\"SOURCE_ID\" AS t1_r6, \"TXNS\".\"EXTERNAL_REFS\" AS t1_r7, \"TXNS\".\"CREATED_AT\" AS t1_r8, \"TXNS\".\"IP_NUMBER\" AS t1_r9, \"TXNS\".\"MISC\" AS t1_r10 FROM \"TM\".\"TRIPS\" LEFT OUTER JOIN \"TXNS\" ON \"TXNS\".\"TRIP_ID\" = \"TM\".\"TRIPS\".\"ID\" WHERE \"TM\".\"TRIPS\".\"ID\" IN (11620660, 11620651, 11620649, 11620647, 11620646, 11620645, 11620644, 11620642, 11620641, 11620636) AND (upper(trips.domain) = 'FOOBAR.COM' and txns.txn_type = '1') ORDER BY trips.created_at desc\n</code></pre>\n\n<p>I want to know why does active record fire two queries</p>\n"},{"tags":["php","mysql","sql","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13247996,"title":"How to group exact Tandem values from 2 column of table?","body":"<p>I have a table with 2 column <code>latitude</code> and <code>longitude</code>.<br>\nsome of data rows have exact match tandem values on 2 columns  .</p>\n\n<pre><code>/* Points Table */\nlat |long\n2.1 |5.8\n2.1 |5.6    -Set as Group\n2.1 |5.6    -Set as Group\n2.1 |5.6    -Set as Group\n2.3 |5.2\n2.4 |5.3\n2.5 |5.3    -Set as Group\n2.5 |5.3    -Set as Group\n2.6 |5.3\n2.5 |5.3\n</code></pre>\n\n<p>I want to set as Group tandem values of 2 columns , for example the result of my SQL Query Like :  </p>\n\n<pre><code>/* Points Table */\nlat |long\n2.1 |5.8\n2.1 |5.6    -Grouped\n2.3 |5.2\n2.4 |5.3\n2.5 |5.3    -Grouped\n2.6 |5.3\n2.5 |5.3\n</code></pre>\n\n<p>How can i do this ?</p>\n"},{"tags":["mysql","sql","group-by","union"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1030,"score":2,"question_id":8572821,"title":"Group by with union mysql select query","body":"<pre><code>(SELECT COUNT(motorbike.`owner_id`) as count,owner.`name`,transport.`type` FROM transport,owner,motorbike WHERE transport.type='motobike'\nAND owner.`owner_id`=motorbike.`owner_id`\nAND transport.`type_id`=motorbike.`motorbike_id` GROUP BY motorbike.owner_id)\nUNION ALL\n(SELECT COUNT(car.`owner_id`) as count,owner.`name`,transport.`type` FROM transport,owner,car WHERE transport.type='car'\nAND owner.`owner_id`=car.`owner_id`\nAND transport.`type_id`=car.`car_id` GROUP BY car.`owner_id`)\n</code></pre>\n\n<p>The query above returns a result like this below,</p>\n\n<pre><code>count          name\n1              Linda\n2              Mary\n1              Steve\n1              Linda\n</code></pre>\n\n<p>This query is to count how many transport that owned by an owner. Linda have one car and one motorcycle,so the result should:</p>\n\n<pre><code>count          name\n2              Linda\n2              Mary\n1              Steve\n</code></pre>\n\n<p>I have tried this query,but return error:</p>\n\n<pre><code>(SELECT COUNT(motorbike.`owner_id`),owner.`name`,transport.`type` FROM transport,owner,motorbike WHERE transport.type='motobike'\nAND owner.`owner_id`=motorbike.`owner_id`\nAND transport.`type_id`=motorbike.`motorbike_id`)\nUNION ALL\n(SELECT COUNT(car.`owner_id`),owner.`name`,transport.`type` FROM transport,owner,car WHERE transport.type='car'\nAND owner.`owner_id`=car.`owner_id`\nAND transport.`type_id`=car.`car_id`)  GROUP BY motorbike.owner_id\n</code></pre>\n\n<p>Can anyone help me please?</p>\n"},{"tags":["sql","sql-server","ssms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13252501,"title":"SQL Server Management Studio print in color","body":"<p>I am using SQL Server Management Studio 2012. I am trying to print a stored procedure in the color-coded syntax that it loves showing me, but cannot find an option to enable this. Any ideas?</p>\n\n<p>I know on VS2010 that we (finally) got color output for text, via an add-in on MS's site, but I cannot seem to locate anything for SQL Server Management Studio via Google. Why am I printing this thing out? Because it's 15 pages long, and I am trying to clean it up.  </p>\n"},{"tags":["mysql","sql","alias","nested-queries","inner-query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13251164,"title":"How to solve unknown alias column issue without using nested queries?","body":"<p>I've the querry</p>\n\n<pre><code>SELECT ID, \n  post_title, \n  post_author,\n  max(case when meta_key='geo_latitude' then meta_value end) latitude,\n  max(case when meta_key='geo_longitude' then meta_value end) longitude,\n ( 3959 * acos( cos( radians(18.204540500000) ) \n                   * cos( radians( latitude ) ) \n                   * cos( radians( longitude ) \n                       - radians(-66.450958500000) ) \n                   + sin( radians(18.204540500000 ) )\n                   * sin( radians( latitude ) ) \n                 )\n   ) AS distance \nFROM `wp_posts` \nLEFT JOIN `wp_postmeta` \n  on ID=post_id \nWHERE post_type='place' \n  AND (meta_key='geo_latitude' OR meta_key='geo_longitude') \nGROUP BY ID, post_title, post_author\nORDER BY ID ASC\n</code></pre>\n\n<p>which results </p>\n\n<pre><code>Error Code: 1054. Unknown column 'latitude' in 'field list'\n</code></pre>\n\n<p>Is there any way to solve this without using inner/nested queries?</p>\n"},{"tags":["php","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":13250975,"title":"PHP SQL No result returned","body":"<p>$block is not being returned. The problem seems to arise during the while statement. I have used this script before, only slightly different, so i know it is something fairly minor. Any help would be greatly appreciated, thanks in advance. </p>\n\n<pre><code>&lt;?php\nif (isset($_GET['filter_tag'])) {\n    $filter_tag = $_GET['filter_tag'];\n}\n\n    if (@mysql_connect('xxxxxxxxx','xxxxxxxxxx','xxxxxxxxxx')) {\n        if (mysql_select_db('xxxxx')) {\n                $query = \" SELECT blocks . CNO, blocks . CName, blocks . URL, images . Ipath FROM blocks LEFT JOIN images ON blocks . INO = images . INO WHERE CNO LIKE 'mysql_real_escape_string($filter_tag)' \";\n        $query_run = mysql_query($query);\n        } while ($query_row = mysql_fetch_assoc($query_run)) {      \n            echo $block =   '&lt;li id=\"'.$query_row['CNO'].'\" class=\"block\" data-toggle=\"modal\" data-target=\"#blocklModal\" &gt;\n        &lt;a href=\"'.$query_row['URL'].'\" target=\"_blank\"&gt;\n        &lt;img class=\"b\" src=\"'.$query_row[\"Ipath\"].'\" alt=\"\" data-controls-modal=\"block-modal\" data-backdrop=\"static\"&gt;\n        &lt;/a&gt;\n        &lt;p class=\"c-title\"&gt;'.$query_row['Name'].'&lt;/p&gt;\n        &lt;/li&gt;';\n        }\n    }\n?&gt;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13252567,"title":"sql - How to selectively select by combining multiple conditions?","body":"<p>I am not sure how to describe my question (maybe title is not proper). </p>\n\n<h2>Here it is:</h2>\n\n<p>I have a table like this:</p>\n\n<pre><code>item   type stockdate    saledate\n\n1      1    2012-11-06   2012-11-05\n\n2      2    2012-11-06   2012-11-07\n\n3      2    2012-11-06   2012-11-05\n</code></pre>\n\n<p>So, I want to select from the above table.</p>\n\n<p>There are two conditions:</p>\n\n<ol>\n<li>if the <code>type</code> of an item is <code>1</code>, then I anyway show this item</li>\n<li>If the <code>type</code> of an item is <code>2</code>, but its <code>saledate &gt;= stockdate</code>, then I show; otherwise, I don't show</li>\n</ol>\n\n<p>So from the above table, I want to <code>show only item 1 and 2</code>, because item 1 has <code>type of 1</code>, item 2 has <code>type of 2</code> but its <code>saledate &gt;= stockdate</code>, item 3 cannot be shown because its <code>saledate&lt;stockdate</code>.</p>\n\n<p><strong>How can I write the select query?</strong></p>\n\n<p>I am using MS SQL Server.</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13252444,"title":"Oracle SQL vs Oracle PL/SQL","body":"<p>I have to learn Oracle SQL for work and am very tempted by the O'Reilly book 'Oracle PL/SQL Programming' as it has been so highly reviewed. However, I am unclear as to whether or not PL/SQL is a different language to SQL or if it is just a superset or if it something else. Can  someone please help me here? Thanks. </p>\n"},{"tags":["php","sql","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13252358,"title":"cursor in sqlsrv_query not working","body":"<p>Given this SQL statement that uses a cursor to loop through each row of a table and update a row in another table:</p>\n\n<pre><code>DECLARE @x varchar(100)\nDECLARE @y varchar(100)\nDECLARE c CURSOR FOR\nSELECT col1, col2 FROM table\nOPEN c\nFETCH NEXT FROM c INTO @x, @y\nWHILE @@FETCH_STATUS = 0\nBEGIN\nUPDATE table2 SET cola = @x WHERE colb = @y\nFETCH NEXT FROM c INTO @x, @y\nEND\nCLOSE c\nDEALLOCATE c;\n</code></pre>\n\n<p>If I run this statement directly within SQL console or Navicat, everything works as expected.  But if I run it in PHP using:</p>\n\n<pre><code>sqlsrv_query($sql)\n</code></pre>\n\n<p>only SOME of the rows in table2 are actually updated.  It seems the cursor in the SQL statement does not properly execute, perhaps sqlsrv_query returns while the statement's cursor is still running?  </p>\n\n<p>Is there a way to instruct sqlsrv_query to 'wait' until the statement is fully done executing before returning a result?</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2000","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2457,"score":1,"question_id":3867164,"title":"SQL update query syntax with inner join","body":"<p>Can anyone find my error in this query?  I'm using SQL Server 2000 and I want to update all entries in the CostEntry table to the corresponding value in the ActiveCostDetails table.  The where clause DOES work with a select statement.</p>\n\n<pre><code>    UPDATE CostEntry CE \nINNER JOIN ActiveCostDetails As AD ON CostEntry.lUniqueID = ActiveCostDetails.UniqueID\n       SET CostEntry.sJobNumber = ActiveCostDetails.JobNumber\n     WHERE CostEntry.SEmployeeCode = '002'\n       AND SubString(CostCentre, 1, 1) = sDepartmentCode\n       AND substring(CostCentre, 3, 1) = sCategoryCode\n       AND substring(CostCentre, 5, 2) = sOperationCode\n</code></pre>\n"},{"tags":["mysql","sql","join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":13252492,"title":"mysql query (combine 2 queries into 1)","body":"<p>I'm pretty new with sql possibilities and need help with the following:\nI have two queries, both of them work correct:</p>\n\n<pre><code> select id, text, gt, gg, status, 'XXX' as xxx, 'ZZZ' as zzz, \n concat(md5(concat('str1', 'str2')), sha1(concat('str1', 'str2'))) as yyy\n from table limit 1;\n</code></pre>\n\n<p>and</p>\n\n<pre><code> SELECT c.id \n FROM table2 c \n LEFT JOIN table3 m ON c.id = m.cid \n WHERE c.channel_type = 2 \n    and (m.mid IN ('2')) ;\n</code></pre>\n\n<p>How I can convert it into one query (with two select statements), while '2' which is used in 'IN' clause in the 2nd query is the 'id' from the 1st query?</p>\n\n<p>thanks in advance!</p>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13251933,"title":"SQL : Match IN operator with anything","body":"<p>I am trying to build a dynamic query.</p>\n\n<p>This works fine :</p>\n\n<pre><code>$qstring=\"10000, 10001, 10003, 10005\";\n\nSELECT *\nFROM orders\nWHERE order_id in ($qstring);\n</code></pre>\n\n<p>This also works fine when I have no data to match and select.</p>\n\n<pre><code>$qstring=\"\";\n\nSELECT *\nFROM orders\nWHERE order_id in ($qstring);\n</code></pre>\n\n<p>Does something like below exists to match any data? I checked out the pattern matching for SQL but found nothing that could match everything.</p>\n\n<pre><code>$qstring=\"*\";\n\nSELECT *\nFROM orders\nWHERE order_id in ($qstring);\n</code></pre>\n\n<p>Any hints? Thanks!</p>\n"},{"tags":["sql","syntax","db2","spss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13230754,"title":"SPSS syntax to connect to database","body":"<p>I've successfully connected to a IBM DB2 database in SPSS using the connection wizard. However, I haven't found a working method to do this using SPSS syntax. Has anyone any experience with this?</p>\n"},{"tags":["c#","sql","sql-server","database"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13251809,"title":"how to re-order IDs after deleting a row in database","body":"<p>Im using C# to make program that has a sql database, in the database I have a table named <code>Workers</code>, it has an auto increament and Primary key <code>ID_column</code>, when I delete a record the IDs will have a gap between each other.</p>\n\n<p>what should I do re-order the IDs after deleting a record??</p>\n\n<p>UPDATE</p>\n\n<p>what i am going to do is to display the record on the screen after finding it,\nso I tried to do that using the <code>ID</code> but it make some exception because of these gaps !!</p>\n\n<p>UPDATE 2</p>\n\n<p>this is the code I tried to use</p>\n\n<pre><code>private void btnFind_Click(object sender, EventArgs e)\n    {\n        string searchFor = \"\";\n        string searchOn = \"\";\n        string searchString = \"\";\n        int results = 0;\n\n        if (searchTextBox.Text.Trim() == \"\")\n            MessageBox.Show(\"Nothing to search for\");\n\n        if (cb1.Text == \"Last Name\")\n        {\n            searchFor = searchTextBox.Text.Trim();\n            searchOn = \"last_Name=\";\n            searchString = searchOn + \"'\" + searchFor + \"'\";\n        }\n\n        if (cb1.Text == \"Job Title\")\n        {\n            searchFor = searchTextBox.Text.Trim();\n            searchOn = \"job_Title=\";\n            searchString = searchOn + \"'\" + searchFor + \"'\";\n        }\n\n        DataRow[] returnedRows;\n\n        returnedRows = ds1.Tables[\"Workers\"].Select(searchString);\n\n        results = returnedRows.Length;\n\n        if (results &gt; 0)\n        {\n            DataRow dr1;\n\n            dr1 = returnedRows[0];\n            inc = (int)dr1[\"Worker_ID\"]-1;\n\n            NavigateRecords();\n\n        }\n        else\n        {\n            MessageBox.Show(\"No such Record\");\n        }\n\n    }\n</code></pre>\n\n<p><code>inc</code> is the currently displayed record and <code>NavigateRecords()</code> is do display the recored with the giving number <code>inc</code></p>\n\n<pre><code>void NavigateRecords()\n    {\n        DataRow dRow = ds1.Tables[\"Workers\"].Rows[inc];\n\n        textBox1.Text =  dRow.ItemArray.GetValue(1).ToString();\n        textBox2.Text =  dRow.ItemArray.GetValue(2).ToString();\n        textBox3.Text =  dRow.ItemArray.GetValue(3).ToString();\n    }\n</code></pre>\n"},{"tags":["sql","performance","query","postgresql","postgresql-performance"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":13234812,"title":"Improving query speed: simple SELECT in big postgres table","body":"<p>I'm having trouble regarding speed in a SELECT query on a Postgres database.</p>\n\n<p>I have a table with two integer columns as key: (int1,int2)\nThis table has around 70 million rows.</p>\n\n<p>I need to make two kind of simple SELECT queries in this environment:</p>\n\n<pre><code>SELECT * FROM table WHERE int1=X;\nSELECT * FROM table WHERE int2=X;\n</code></pre>\n\n<p>These two selects returns around 10.000 rows each out of these 70 million. For this to work as fast as possible I thought on using two HASH indexes, one for each column. Unfortunately the results are not that good:</p>\n\n<pre><code>                                                               QUERY PLAN                                                               \n----------------------------------------------------------------------------------------------------------------------------------------\n Bitmap Heap Scan on lec_sim  (cost=232.21..25054.38 rows=6565 width=36) (actual time=14.759..23339.545 rows=7871 loops=1)\n   Recheck Cond: (lec2_id = 11782)\n   -&gt;  Bitmap Index Scan on lec_sim_lec2_hash_ind  (cost=0.00..230.56 rows=6565 width=0) (actual time=13.495..13.495 rows=7871 loops=1)\n         Index Cond: (lec2_id = 11782)\n Total runtime: 23342.534 ms\n(5 rows)\n</code></pre>\n\n<p>This is an EXPLAIN ANALYZE example of one of these queries. It is taking around 23 seconds. My expectations are to get this information in less than a second.</p>\n\n<p>These are some parameters of the postgres db config:</p>\n\n<pre><code>work_mem = 128MB\nshared_buffers = 2GB\nmaintenance_work_mem = 512MB\nfsync = off\nsynchronous_commit = off\neffective_cache_size = 4GB\n</code></pre>\n\n<p>Any help, comment or thought would be really appreciated.</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["sql","oracle"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":103,"score":1,"question_id":12564918,"title":"Why Oracle is saying not a GROUP BY expression?","body":"<p>I am Trying to retrive data from the Oracle database table with following conditions </p>\n\n<ol>\n<li>All entries found by zip-code should be grouped, sorted by zip-code descending.</li>\n<li>entries found by city should be grouped, sorted alphabetically.</li>\n<li>All entries found by dealername should be grouped, sorted alphabetically.</li>\n</ol>\n\n<p>To staisfy the above conditions I wrote the query like below</p>\n\n<pre><code> SELECT DISTINCT ba.uuid AS uuid, COUNT(*) over() AS rowcount FROM basicaddress ba \n    WHERE ba.postalcode='143456' OR ba.lastname LIKE '%143456%' OR ba.city LIKE '%143456%'\n    GROUP BY\n            CASE WHEN ba.postalcode='143456' THEN ba.postalcode END \n    ORDER BY \n            CASE WHEN ba.postalcode='143456' THEN ba.postalcode END DESC, \n            CASE WHEN ba.lastname LIKE '%143456%' THEN ba.lastname END ASC, \n            CASE WHEN ba.city LIKE '%143456%' THEN ba.city ELSE ba.postalcode END DESC\n</code></pre>\n\n<p>This query is working fine in MYSQL but in oracle it is saying <em>\"not a GROUP BY expression\"</em></p>\n\n<p>Any help will be greatly appriciated</p>\n"},{"tags":["sql","design"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":45,"score":6,"question_id":13250417,"title":"Is one big domain table considered bad design?","body":"<p>I have to add some features to a web application I'm maintaining, and I have to decide which path to follow to modify the database (Sql Server 2010) in order to store and retrieve the new data the application needs.</p>\n\n<p><em><strong>\"Ugly but fast\"</em> path:</strong><br>\nThe web application already has this \"Generic domain table\" that stores different domains data that can be retrieved and filtered via Stored Procedure, specifying a Domain field.<br>\nSomething like:</p>\n\n<pre><code>| Id         | Description | Domain       |\n|------------|-------------|--------------|\n| 001        |    Apple    |     Fruit    |\n| 002        |    Peach    |     Fruit    |\n| 003        |    Banana   |     Fruit    |\n| A01        |    Yellow   |     Color    |\n| A02        |     Red     |     Color    |\n| A03        |     Green   |     Color    |\n\n\nSP_GetDomainValues @Domain='Fruit'\n</code></pre>\n\n<p>The table already has the application layer to store and retrieve data without effort.<br>\nAll I need is to create a database script to populate the table with the new records I need with the proper new domains.<br>\nI should add that this application has also several domains table each storing just one domain.</p>\n\n<p><em><strong>\"Good but slow\"</em> path:</strong><br>\nI have to create different tables, Stored Procedures and DAL methods to store and retrieve the data.</p>\n\n<p>Personally I like the second approach for these two <a href=\"http://sqlblog.com/blogs/louis_davidson/archive/2010/11/20/one-domain-table-or-many.aspx\" rel=\"nofollow\">main reasons</a>:</p>\n\n<ul>\n<li><p>Using the data in a query is much easier, as you join naturally to\ntables, not subsets of one big table</p></li>\n<li><p>Data can be validated using foreign key constraints very naturally,\nsomething not feasible if you have one table, perhaps named\n“genericDomain”. It isn’t that it isn’t totally possible, it is just\nmessy to use constraints</p></li>\n</ul>\n\n<p>I tend to think that if you don't have some sort of rigid ratio that can help to decide which way to pick, you'll end up to take the quick and dirty path every time.</p>\n\n<p>In your experience, is the first choice a bad design or there are cases where it can be used without feeling too guilty? </p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13251672,"title":"How to return the table using mysql Function","body":"<p>I am using MySQL. I want to return the table using MySQL  function. In SQL its working fine but not in MySQL.    I attach my partial code</p>\n\n<pre><code> DELIMITER $$\n\n    CREATE FUNCTION myFunction() RETURNS @tmptable TABLE (item varchar(20))\n    BEGIN  \n\n        insert  into @tmptable(item) values('raja')     \n\n\n        return\n     END; $$\n</code></pre>\n"},{"tags":["mysql","sql","oracle","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":56,"score":-4,"question_id":13251647,"title":"SQL query to get one distinct row in a table","body":"<p>In my table i am having 20 columns with redundant rows.</p>\n\n<p>What is the SQL query to get only one distinct row. <code>SELECT DISTINCT(COL1) FROM TABLE1;</code> this gives unique record for that column but i want all the rows how to do it??</p>\n"},{"tags":["mysql","sql","query","normalization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13242840,"title":"SQL query - Two tables with relation many to one (Normalization issue)","body":"<p>I have this example tables:</p>\n\n<pre><code>table ORDERS\n\nclient   orderno   cant1   code1   notes1   cant2   code2   notes2   cant[i]   code[i] [...]\n--------------------------------------------------------------------------------------\n1          1        3      AA01    Test      4      BB01    Testing\n2          2        10     XX05    Test      \n\n\n\ntable PRODUCTS\n\ncode   prod    price\n---------------------\nAA01   Engine   100  \nBB01   Wheel     50  \n\n\n\ntable CLIENTS\n\nclient   name      address     telephone\n-----------------------------------------\n  1     Maxwell   24 1st st    0987654321\n  2     Hammer    77 main st   1234567890\n</code></pre>\n\n<p>I need to relate them to get the quantity, name of the product and price for each of the product lines (they are 30 cant[i], code[i] and notes[i]) and the customer's information (name, address, etc)</p>\n\n<p>I found this case, but I don't understand how to apply it to mine: <a href=\"http://stackoverflow.com/questions/9420475/sql-query-two-tables-with-relation-one-to-many\">SQL query two tables with relation one-to-many</a></p>\n\n<p>I hope it's not too complex.</p>\n\n<p>Thanks in advance!</p>\n\n<h1>EDIT</h1>\n\n<p>Thanks to ElectricLlama I realized the problem here is the table where the order is storaged. According to his answer, the normalization of the database would improve the way I'm able to get the info.</p>\n\n<p>For anyone interested in this solution, I found this great website: <a href=\"http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/\" rel=\"nofollow\">http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/</a></p>\n\n<p>This SO answer clears it ALL! Super clear and understandable!\n<a href=\"http://stackoverflow.com/a/1258776/888292\">http://stackoverflow.com/a/1258776/888292</a></p>\n"},{"tags":["sql","sqlite","sqlite3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13250386,"title":"Sqlite - SELECT or INSERT and SELECT in one statment","body":"<p>I'm trying to avoid writing different SQL queries to achieve the following scenario:</p>\n\n<p>I have a Table called Values:</p>\n\n<p>Values:</p>\n\n<pre><code>id INT (PK)\ndata TEXT\n</code></pre>\n\n<p>I would like to check if a certain data exists in the table, if it is return it's id, if it does not exists, then insert it and return it's id.</p>\n\n<p>The (very) naive way would be:</p>\n\n<pre><code>select id from Values where data = \"SOME_DATA\";\n</code></pre>\n\n<p>if id is not null, great use it.\nif id is null then:</p>\n\n<pre><code>insert into Values(data) values(\"SOME_DATA\");\n</code></pre>\n\n<p>and then select it again to see its id or use the returned id.</p>\n\n<p>I am trying to make the above functionality in one line.\nI think i'm getting close, but i couldn't make it yet:\nSo far i got this:</p>\n\n<pre><code>select id from Values where data=(COALESCE((select data from Values where data=\"SOME_DATA\"), (insert into Values(data) values(\"SOME_DATA\"));\n</code></pre>\n\n<p>I'm trying to take advantage of the fact that the second select will return null and then the second argument to COALESCE will be returned. No success so far. What am I missing?</p>\n\n<p>Reminder, this is a sqlite3 engine! :P</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","join"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13251407,"title":"PHP/MYSQL join fieldname in array","body":"<p>I have a query that joins two tables that share a field name.  I want to grab the field name of one, not the other after converting the results into an array using fetch_array.</p>\n\n<p>I feel like I have accomplished this with a simple alias numerous times but this time it is not working.  Can anyone please help me find the error.  Many thanks.</p>\n\n<p>Code is:</p>\n\n<pre><code>$sql = \"SELECT i.*,ic.* FROM `items` i \n  LEFT JOIN `itemcat` ic ON i.id= ic.itemid \n  WHERE (shortdescript LIKE '%%' OR longdescript LIKE '%%') \n    AND ic.catid='23' limit 0,20 \";\n\n$res = mysql_query($sql) or die(mysql_error());  //query executes no problem\nwhile($row = mysql_fetch_array($res)) {\n$id = $row['i.id'];//I do not understand why this is not getting anything.\n$id2 = $row['id'];//returns id but from wrong table.\n\necho $id; //returns blank.  \necho $id2; //returns id of itemcat table when I want id of items table.\n}\n</code></pre>\n"},{"tags":["mysql","sql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13250645,"title":"SQL syntax error - Haversine formula","body":"<p>I'm trying to <a href=\"http://stackoverflow.com/questions/4645490/get-nearest-places-google-maps-mysql-spatial-data/4979891\">get nearest places</a> from a WordPress database using <a href=\"http://en.wikipedia.org/wiki/Haversine_formula\" rel=\"nofollow\">Haversine formula</a></p>\n\n<p>My table structure below</p>\n\n<p><strong>posts</strong></p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| ID           |\n| post_author  |\n| post_title   | \n| post_type    | \n+--------------+\n</code></pre>\n\n<p><strong>postmeta</strong></p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| meta_id      |\n| post_id      |\n| meta_key     |\n| meta_value   |\n+--------------+\n</code></pre>\n\n<p>and have records with <code>meta_key</code> values <code>latitude</code> and <code>longitude</code> </p>\n\n<p>See the <a href=\"http://stackoverflow.com/questions/13249724/selecting-a-join-tables-column-values-as-result-column-name\">answer to my previous question</a> for the SQL I've used to get the latitude and longitude.</p>\n\n<pre><code>SELECT p.ID, \n  p.post_title, \n  p.post_author,\n  max(case when pm.meta_key='latitude' then pm.meta_value end) latitude,\n  max(case when pm.meta_key='longitude' then pm.meta_value end) longitude\nFROM `wp_posts` p\nLEFT JOIN `wp_postmeta` pm\n  on p.ID=pm.post_id \nWHERE p.post_type='place' \n  AND (pm.meta_key='latitude' OR pm.meta_key='longitude') \nGROUP BY p.ID, p.post_title, p.post_author\nORDER BY p.ID ASC\n</code></pre>\n\n<p>Now I want to incorporate above query into <a href=\"http://stackoverflow.com/questions/4645490/get-nearest-places-google-maps-mysql-spatial-data/4979891#4979891\">answer for this question</a></p>\n\n<pre><code>SELECT item1, item2, \n    ( 3959 * acos( cos( radians(37) ) \n                   * cos( radians( lat ) ) \n                   * cos( radians( lng ) \n                       - radians(-122) ) \n                   + sin( radians(37) ) \n                   * sin( radians( lat ) ) \n                 )\n   ) AS distance \nFROM geocodeTable \nHAVING distance &lt; 25 \nORDER BY distance LIMIT 0 , 20;\n</code></pre>\n\n<p>Below is by combined query</p>\n\n<pre><code>SELECT ID, \n  post_title, \n  post_author,\n  max(case when meta_key='latitude' then meta_value end) latitude,\n  max(case when meta_key='longitude' then meta_value end) longitude,\n  ( 3959 * acos( cos( radians(18.204540500000) ) \n                   * cos( radians( latitude ) ) \n                   * cos( radians( longitude ) \n                       - radians(-66.450958500000) ) \n                   + sin( radians(18.204540500000 ) \n                   * sin( radians( latitude ) ) \n                 )\n   ) AS distance \nFROM `wp_posts` \nLEFT JOIN `wp_postmeta` \n  on ID=post_id \nWHERE post_type='place' \n  AND (meta_key='latitude' OR meta_key='longitude') \nGROUP BY ID, post_title, post_author\nORDER BY ID ASC\n</code></pre>\n\n<p>But this yields syntax error </p>\n\n<pre><code>#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'AS distance FROM `wp_posts` LEFT JOIN `wp_postmeta` on ID=post_id WHERE po' at line 13\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13250851,"title":"how to detect a faulty sequence column with sql?","body":"<p>I have this table</p>\n\n<pre><code>ID  |  Seq  \n------------\n A      1      \n A      2      \n A      3      \n B      1      \n B      2     \n B      3     \n B      3     &lt;--duplicate seq where ID=B\n C      1     \n C      2\n C      4     &lt;--missing seq id number 3\n D      1\n D      2\n .      .\n .      .\n</code></pre>\n\n<p>Is there a way to detect if/when there is an error in the logic of the Seq column, specifically if there are jumps and/or duplicates. </p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13250660,"title":"query the second table with the result of first","body":"<p>I need to bind two tables into a dataset. I have three table named, Students, StudentMarks.</p>\n\n<p>Here if I know the studentId I can query the student table like</p>\n\n<pre><code>DataSet ds=new DataSet();\n\nSqlCommand cmd=new SqlCommand(\"\nSELECT * \nFROM STUDENTS\nWHERE STUDENTID=1; \nSELECT *\nFROM STUDENTS\nWHERE STUDENTID=1\");\n\nSqlDataAdapter da=new SqlDataAdapter(cmd);\nda.Fill(ds);\n</code></pre>\n\n<p>like this. So that I can access these two tables like ds.Table[0] and ds.Table[1].</p>\n\n<p>But my question is, if I dont know the studentid and if I want to query all the students as well as their marks and I've to get these details in two different tables how can I get?</p>\n\n<p>If I join these two tables, the result will be in a single table, I dunno how to do this, can anyone help me out here? thanks in advance.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","guid","entropy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":23,"score":-1,"question_id":13251251,"title":"SQL Server 2008 GUID generation","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3242287/how-are-guids-generated-in-sql-server\">how are GUIDs generated in SQL Server?</a>  </p>\n</blockquote>\n\n\n\n<p>I wonder how SQL Server 2008 GUIDs are generated? Entropy bits</p>\n"},{"tags":["sql","oracle","transitive-closure-table"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":197,"score":3,"question_id":5264637,"title":"How can I speed up queries that are looking for the root node of a transitive closure?","body":"<p>I have a historical transitive closure table that represents a tree.</p>\n\n<pre><code>create table TRANSITIVE_CLOSURE\n  (\n    CHILD_NODE_ID number not null enable,\n    ANCESTOR_NODE_ID number not null enable,\n    DISTANCE number not null enable,\n    FROM_DATE date not null enable,\n    TO_DATE date not null enable,\n    constraint TRANSITIVE_CLOSURE_PK unique (CHILD_NODE_ID, ANCESTOR_NODE_ID, DISTANCE, FROM_DATE, TO_DATE)\n  );\n</code></pre>\n\n<p>Here's some sample data:</p>\n\n<pre><code>CHILD_NODE_ID | ANCESTOR_NODE_ID | DISTANCE \n--------------------------------------------\n1             | 1                | 0\n2             | 1                | 1\n2             | 2                | 0\n3             | 1                | 2\n3             | 2                | 1\n3             | 3                | 0\n</code></pre>\n\n<p>Unfortunately, my current query for finding the root node causes a full table scan:</p>\n\n<pre><code>select *\nfrom transitive_closure tc\nwhere \n  distance = 0\n  and not exists (\n  select null\n  from transitive_closure tci\n  where tc.child_node_id = tci.child_node_id\n    and tci.distance &lt;&gt; 0\n);\n</code></pre>\n\n<p>On the surface, it doesn't look too expensive, but as I approach 1 million rows, this particular query is starting to get nasty... especially when it's part of a view that grabs the adjacency tree for legacy support.</p>\n\n<p>Is there a better way to find the root node of a transitive closure? I would like to rewrite all of our old legacy code, but I can't... so I need to build the adjacency list somehow.  Getting everything except the root node is easy, so is there a better way?  Am I thinking about this problem the wrong way?</p>\n\n<p>Query plan on a table with 800k rows.</p>\n\n<pre><code>OPERATION                                  OBJECT_NAME        OPTIONS         COST \nSELECT STATEMENT                                                              2301 \n  HASH JOIN                                                   RIGHT ANTI      2301 \n    Access Predicates\n      TC.CHILD_NODE_ID=TCI.CHILD_NODE_ID \n    TABLE ACCESS                           TRANSITIVE_CLOSURE FULL            961 \n      Filter Predicates \n        TCI.DISTANCE = 1 \n    TABLE ACCESS                           TRANSITIVE_CLOSURE FULL            962 \n      Filter Predicates \n        DISTANCE=0\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","join","duplicate-removal"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13250247,"title":"Join Tables SQL Server with duplicates","body":"<p>I have a table </p>\n\n<pre><code>col1\n\n1\n2\n</code></pre>\n\n<p>and other table </p>\n\n<pre><code>col1    col2    col3\n\n1          1    data value one                                    \n1          2    data value one                                    \n2          3    data value two   \n</code></pre>\n\n<p>and I want to join both tables to obtain the following result</p>\n\n<pre><code>col1  col2  col3\n\n1       1    data value one\n2       3    data value two\n</code></pre>\n\n<p>The second table have duplicates but I need to join only one (randomly). I've tried with Inner Join, Left Join, Right Join and always returns all rows. Actually I use <code>SQL Server 2008</code>.</p>\n"},{"tags":["sql","vb.net","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":517,"score":3,"question_id":12007723,"title":"insert date and time into acces with SQL visual basic","body":"<p>I am trying to use SQL in visual basic to insert Date and Time value into Access 2007 running in Access2002/3 mode. Using my code I have managed to insert text strings and numerical values into the table. However for the DateTime field get a syntax error. The field in Access is set as a Date/Time field type.</p>\n\n<p>Below is my first function which generates the queries for the Database Accessing function:</p>\n\n<pre><code>Public Function NewUpload(ByVal UploadType As String) As Single\n\n    Dim UploadNumber As Single\n    Dim ColumnString As String\n    Dim ValueString As String\n\n    If DatabaseConnection(\"SELECT ID_UPL FROM tabUpload\", \"Read Recordset\") = \"Error\" Then GoTo close\n    Do Until rdrOLEDB.Read = False\n        If Val(rdrOLEDB.Item(0).ToString()) &gt; UploadNumber Then UploadNumber = Val(rdrOLEDB.Item(0).ToString())\n    Loop\n    rdrOLEDB.Close()\n    cnnOLEDB.Close()\n\n    UploadNumber = UploadNumber + 1\n\n    'Update Uploads table:\n    ColumnString = \"ID_UPL,DateTime,IDUser,DataCalc\"\n    ValueString = Format(UploadNumber, \"0000\") &amp; \",#\" &amp; Now.ToLongDateString &amp; \" \" &amp; Now.ToLongTimeString &amp; \"#,'\" &amp; My.User.Name &amp; \"','\" &amp; UploadType &amp; \"'\"\n    If DatabaseConnection(\"INSERT INTO tabUpload(\" &amp; ColumnString &amp; \") VALUES(\" &amp; ValueString &amp; \")\", \"Non-Query\") = \"Error\" Then GoTo Close\n\n    NewUpload = UploadNumber\n</code></pre>\n\n<p>Close:\n        cnnOLEDB.Close()</p>\n\n<pre><code>End Function\n</code></pre>\n\n<p>Here is the second Function which connects to the Database</p>\n\n<pre><code>Public Function DatabaseConnection(ByVal Query As String, ByVal Task As String) As String\n    'On Error GoTo Err\n\n    cnnOLEDB.ConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; DataDirectoryName &amp; DatabaseFileName\n    cmdOLEDB.Connection = cnnOLEDB\n    cmdOLEDB.CommandText = Query\n    cnnOLEDB.Open()\n\n    Select Case Task\n        Case \"Read Recordset\"\n            rdrOLEDB = cmdOLEDB.ExecuteReader()\n            DatabaseConnection = \"Read Recordset\"\n        Case \"Read Scalar\"\n            DatabaseConnection = Str(cmdOLEDB.ExecuteScalar)\n        Case \"Non-Query\"\n            DatabaseConnection = Str(cmdOLEDB.ExecuteNonQuery())\n            DatabaseConnection = \"Non-Query\"\n    End Select\n\n    Exit Function\nErr:\n    MsgBox(\"Database connection error.\")\n    DatabaseConnection = \"Error\"\n\nEnd Function\n</code></pre>\n\n<p>When I run this code I get the Query:\n<code>INSERT INTO tabUpload(IDUPL, DateTime, User, DataCalc) VALUES(0003, #17 August 2012 14:23:27#, 'UK\\Pej', 'Calc')\"</code></p>\n\n<p>I have also tried several variations of DateTime using format and now(Year) giving yyyy-mm-dd etc.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["sql","sql-server","xml","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13249503,"title":"SQL XML query from column","body":"<p>How to select file names from this kind of XML in a SQL Server column?</p>\n\n<ol>\n<li><p>file name is in attribute <code>VALUE</code> only if high level tag is object with name <code>File</code>\nlike this</p>\n\n<pre><code>&lt;Object NAME=\"File\"&gt;\n    &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n&lt;/Object&gt;\n</code></pre></li>\n<li><p>This sub-hierarchy can be placed on any level of xml (see example below)</p></li>\n<li><p>XML column can contain 0-N file names, I need list like this:</p>\n\n<pre><code>id, filename\n--- ------------------------\n 1  \\\\mysvr\\fiels\\readme1.txt\n 1  \\\\mysvr\\fiels\\readme2.txt\n 2  \\\\mysvr\\fiels\\readme3.txt\n 2  \\\\mysvr\\fiels\\readme4.txt\n</code></pre></li>\n</ol>\n\n<p>Example of XML contents:</p>\n\n<pre><code>declare @t1 table\n(   id int,\n   x XML\n)\n\ninsert into @t1 (id, x)\nselect 1,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"1\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme1.txt\" /&gt;\n   &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n&lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"10\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme2.txt\" /&gt;\n&lt;/Object&gt;\n&lt;Object NAME=\"bitmap\"&gt;\n              &lt;Parameter ID=\"11\" NAME=\"my1\" VALUE=\"bmp\" /&gt;\n&lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\nunion \nselect 2,N'&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"13\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme3.txt\" /&gt;\n  &lt;/Object&gt;\n  &lt;Object NAME=\"Font\"&gt;\n              &lt;Parameter ID=\"22\" NAME=\"Tahoma\" VALUE=\"11\" /&gt;\n  &lt;/Object&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n&lt;subclass1&gt;\n  &lt;Object NAME=\"File\"&gt;\n              &lt;Parameter ID=\"14\" NAME=\"Name\" VALUE=\"\\\\mysvr\\fiels\\readme4.txt\" /&gt;\n  &lt;/Object&gt;\n&lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;'\n</code></pre>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13249936,"title":"Add a column to a table with a default value equal to the value of an existing column","body":"<p>How to add a column to a SQL Server table with a default value that is equal to value of an existing column?</p>\n\n<p>I tried this but its giving an error </p>\n\n<blockquote>\n  <p><em>The name \"oldcolumn\" is not permitted in this context. Valid\n  expressions are constants, constant expressions, and (in some\n  contexts) variables. Column names are not permitted.</em></p>\n</blockquote>\n\n<p>T-SQL statement:</p>\n\n<pre><code>ALTER TABLE tablename \nADD newcolumn type NOT NULL DEFAULT (oldcolumn) \n</code></pre>\n"},{"tags":["mysql","sql","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13247632,"title":"postgresql query to mysql","body":"<p>I want create query in MySQL similiar to PostgreSQL below:</p>\n\n<pre><code>CREATE FUNCTION check_unique_pair(IN id1 INTEGER, IN id2 INTEGER) RETURNS INTEGER AS   $body$\nDECLARE retval INTEGER DEFAULT 0;\nBEGIN \n SELECT COUNT(*) INTO retval FROM (\n  SELECT * FROM edges WHERE a = id1 AND b = id2\n  UNION ALL\n  SELECT * FROM edges WHERE a = id2 AND b = id1\n)  AS pairs;\nRETURN retval;\nEND\n$body$\nLANGUAGE 'plpgsql';\n\nALTER TABLE edges ADD CONSTRAINT unique_pair CHECK (check_unique_pair(a, b) &lt; 1);\n</code></pre>\n\n<p>I am new to MySQL.</p>\n"},{"tags":["sql","join","doctrine2","dql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13137908,"title":"What is the difference between JOIN ON and JOIN WITH in Doctrine2?","body":"<p>What is the difference between JOIN ON and JOIN WITH in Doctrine2?</p>\n\n<p>I couldn't find any relevant info in the manual.</p>\n"},{"tags":["mysql","sql","datetime","time"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13250531,"title":"Retrieve time from MySQL as HH:MM format","body":"<p>I used <code>DATETIME</code> datatype to store date and time in my Database.  It saved date as  </p>\n\n<pre><code>YY-MM-DD HH:MM:SS (2012-11-06 10:45:48)  \n</code></pre>\n\n<p>I can retrieve the time from database as <code>HH:MM:SS</code> format but I want to retrieve it in <code>HH:MM</code> format.  </p>\n\n<p>How can I do this?</p>\n"},{"tags":["mysql","sql","wordpress","join","pivot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13249724,"title":"Selecting a join table's column values as result column name","body":"<p>I've a WordPress database with following tables</p>\n\n<p>posts</p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| ID           |\n| post_author  |\n| post_title   | \n| post_type    | \n+--------------+\n</code></pre>\n\n<p>postmeta</p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| meta_id      |\n| post_id      |\n| meta_key     |\n| meta_value   |\n+--------------+\n</code></pre>\n\n<p>and have records with <code>meta_key</code> values <code>latitude</code> and <code>longitude</code> </p>\n\n<p>How can I write SQL to show <code>latitude</code> and <code>longitude</code> as result column names?</p>\n\n<pre><code>+--------------+\n| Field        |\n+--------------+\n| ID           |\n| post_author  |\n| post_title   |\n| latitude     |\n| longitude    | \n+--------------+\n</code></pre>\n\n<p>Below query is my starting point</p>\n\n<pre><code>SELECT ID, post_title, meta_key, meta_value FROM `wp_posts` \nLEFT JOIN `wp_postmeta` on ID=post_id \nWHERE post_type='place' AND (meta_key='latitude' OR meta_key='longitude') \nORDER BY ID ASC\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":41,"score":0,"question_id":13248598,"title":"SQL join clause to return rows with more than one occurrence without grouping","body":"<p>I want to extract the records which appear more than once from a JOIN query, but without them getting grouped.</p>\n\n<p>Example tables:</p>\n\n<pre><code>tbl_names\nid    Name\n1     Mark\n2     John\n3     Jane\n4     Paul\n\ntbl_locations\nid    Location\n1     Berlin\n2     Frankfurt\n2     Stockholm\n3     Helsinki\n3     Madrid\n3     London\n4     Paris\n</code></pre>\n\n<p>ID is a foreign key.</p>\n\n<p>Now, the result of the query would be:</p>\n\n<pre><code>id     Name    Location\n2      John    Frankfurt\n2      John    Stockholm\n3      Jane    Helsinki\n3      Jane    Madrid\n3      Jane    London\n</code></pre>\n\n<p>i.e. all JOIN records in which the record in the first table appears more than once in the JOIN clause result.</p>\n\n<p>I can get it grouped of course:</p>\n\n<pre><code>SELECT tbl_names.id, tbl_names.Name, tbl_locations.Location FROM tbl_names\n INNER JOIN tbl_locations ON (tbl_names.id = tbl_locations.id)\n GROUP BY tbl_names.id\n HAVING COUNT(tbl_names.id) &gt; 1\n</code></pre>\n\n<p>What I want is to have them not grouped at all. I have tried with a sub-clause and <code>NOT IN</code> but it is extremely slow and doesn't give me the results I want.</p>\n\n<p>Any enlightenment will be welcome.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13249974,"title":"Removing intermediate table","body":"<p>Given the following tables:</p>\n\n<pre><code>Table1\n| id | intermediate_id |\n\nItermediate\n| id |\n\nTable2\n| id | intermediate_id | table1_id|\n</code></pre>\n\n<p><strong>How do i update Table2 with Table1.ids?</strong></p>\n\n<p>I'm trying the following: </p>\n\n<pre><code>update Table2\nset table1_id = \n(select table1.id \n from table1\n where table1.intermediate_id = table2.intermediate_id);\n</code></pre>\n\n<p>which gives me \"ERROR:  more than one row returned by a subquery used as an expression\"</p>\n"},{"tags":["sql","sql-server","oracle","common-table-expression"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":45,"score":4,"question_id":13153819,"title":"how to select only row with max sequence without using a subquery?","body":"<p>I'm trying to select only the row with the highest seq for each ID</p>\n\n<pre><code>ID  |  Seq   |  Age\n-------------------\n A      1       20   \n A      2       30\n B      1       25\n B      2       32\n B      3       44\n B      4       48\n C      1       11\n</code></pre>\n\n<p>This appears to work</p>\n\n<pre><code>SELECT ID, Age\nFROM Persons a\nWHERE Seq = (SELECT MAX(Seq) FROM Persons b WHERE a.ID = b.ID)\n</code></pre>\n\n<p>But is this the best way, the only way? I don't like using subqueries if I don't have to and I recall you can use something but I forget what it is. Any idea?</p>\n"},{"tags":["sql","sql-server","xml"],"answer_count":2,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":16648,"score":8,"question_id":869405,"title":"SQL Server: How to get hold of XML attributes in a query?","body":"<p>I'm currently trying to get all of the attributes from some XML with an SQL query.</p>\n\n<p>I've been attempting the following to retrieve it, but I must be missing something rather fundamental.</p>\n\n<pre><code>DECLARE @T varchar(max) \nSET @T = \n'&lt;root&gt;\n    &lt;Field FieldRowId=\"1000\"&gt;\n\t&lt;Items&gt;\n\t\t&lt;Item Name=\"CODE\"/&gt;\n\t\t&lt;Item Name=\"DATE\"/&gt;\n\t&lt;/Items&gt;\n    \t&lt;Attributes&gt;\n\t\t&lt;Attribute ID =\"1\"/&gt;\n    \t&lt;/Attributes&gt;\n    &lt;/Field&gt;\n    &lt;Field FieldRowId=\"2000\"&gt;\n\t&lt;Items&gt;\n                &lt;Item Name=\"CODE\"/&gt;\n                &lt;Item Name=\"DATE\"/&gt;\n\t&lt;/Items&gt;\n\t&lt;Attributes&gt;\n\t\t&lt;Attribute ID =\"2\"/&gt;\n\t&lt;/Attributes&gt;\n    &lt;/Field&gt;\n&lt;/root&gt;'\n\nDECLARE @X xml\n\nSET @X = CAST(@T as xml)\nSELECT Y.ID.value('@FieldRowId', 'int') as FieldID, \n   Y.ID.value('/Items/@Name', 'varchar(max)') as \"Name\",\n   Y.ID.value('/Attributes/@ID', 'int') as AttributeID\nFROM @X.nodes('/root/Field') as Y(ID)\n</code></pre>\n"},{"tags":["c#","sql","sql-server","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":13249220,"title":"Using text SQL with LINQ","body":"<p>I'm currently having issues with using LINQ to SQL for my project. This is because most of the lengthy SQL queries (or <em>views</em>, rather) are hard-coded into C#, and what we've been doing all along is to use <code>context.Database.SqlQuery&lt;ClassName&gt;(sql, sqlParams)</code>.</p>\n\n<p>It's been generally very effective, but right now we need something more dynamic. We need to plug in stuff like <code>.Where(x =&gt; x.Name.Contains(\"Anonymous\")).Take(20)</code> or something else along the lines. However, plugging in directly to the previously mentioned line of code would result in the following:</p>\n\n<p><code>context.Database.SqlQuery&lt;ClassName&gt;(sql, sqlParams).Where(x =&gt; x.Name.Contains(\"Anonymous\")).Take(20);</code></p>\n\n<p>While it actually works and pulls the top 20 records where the name contains \"Anonymous\", the performance is pretty bad. What it does behind the scenes is to take all the records from that table and then finally filtering them after having loaded them to memory.</p>\n\n<p>I would then like to ask, is there any way to translate the text SQL to LINQ, or translate the LINQ to SQL, such that I can execute both my text SQL and LINQ in one single statement. If you don't actually have a solution, I'd gladly appreciate suggestions too...!</p>\n\n<p><strong>EDIT:</strong> I've considered using Expression Trees, but I'm not sure how they can actually fit into the picture. Also, I've considered using database views. But there are so many views (quite a number per table) it would definitely be a hassle to port everything over to MS SQL and then rewriting all the querying logic.</p>\n"},{"tags":["sql","query","group","wise","sub-query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13245223,"title":"SQL Inner/Sub group wise Query for a specific scenario","body":"<p>I have a table as below</p>\n\n<blockquote>\n  <p>Schema: ID | Category | Keyword | Bid Price</p>\n</blockquote>\n\n<p>Write a sql to fetch out top 5 keywords based on the bid price per category.</p>\n\n<p>Details:</p>\n\n<p>Table definition considered on oracle 10.x:</p>\n\n<pre><code>create table test (\n    ID number,\n    Category varchar (20),\n    Keyword varchar (20),\n    BidPrice number\n);\n</code></pre>\n\n<p>Data:</p>\n\n<pre><code>insert into test values (1, 'Category-A', 'Keyword-A1', 110);\ninsert into test values (2, 'Category-A', 'Keyword-A2', 121);\ninsert into test values (3, 'Category-A', 'Keyword-A3', 130);\ninsert into test values (4, 'Category-A', 'Keyword-A4', 125);\ninsert into test values (5, 'Category-A', 'Keyword-A5', 115);\ninsert into test values (6, 'Category-A', 'Keyword-A6', 133);\ninsert into test values (7, 'Category-B', 'Keyword-B1', 105);\ninsert into test values (8, 'Category-B', 'Keyword-B2', 111);\ninsert into test values (9, 'Category-B', 'Keyword-B3', 108);\ninsert into test values (10, 'Category-B', 'Keyword-B4', 128);\ninsert into test values (11, 'Category-B', 'Keyword-B5', 144);\ninsert into test values (12, 'Category-B', 'Keyword-B6', 101);\ninsert into test values (13, 'Category-C', 'Keyword-C1', 150);\ninsert into test values (14, 'Category-C', 'Keyword-C2', 137);\ninsert into test values (15, 'Category-C', 'Keyword-C3', 126);\ninsert into test values (16, 'Category-C', 'Keyword-C4', 121);\ninsert into test values (17, 'Category-C', 'Keyword-C5', 112);\ninsert into test values (18, 'Category-C', 'Keyword-C6', 118);\n</code></pre>\n\n<p><strong>Output expected:</strong></p>\n\n<pre><code>KEYWORD        CATEGORY        BIDPRICE\n-------------- --------------- ----------\n</code></pre>\n\n<blockquote>\n  <p><br>Keyword-A6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;133\n  <br>Keyword-A3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;130\n  <br>Keyword-A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;125\n  <br>Keyword-A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-A5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-A&nbsp;&nbsp;&nbsp;&nbsp;115\n  <br>Keyword-B5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;144\n  <br>Keyword-B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;128\n  <br>Keyword-B2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;111\n  <br>Keyword-B3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;108\n  <br>Keyword-B1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-B&nbsp;&nbsp;&nbsp;&nbsp;105\n  <br>Keyword-C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;150\n  <br>Keyword-C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;137\n  <br>Keyword-C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;126\n  <br>Keyword-C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;121\n  <br>Keyword-C6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category-C&nbsp;&nbsp;&nbsp;&nbsp;118\n  <br></p>\n</blockquote>\n\n<p><em>Note:  Answer has to be only in SQL without use of any Oracle or database specific function.</em></p>\n"},{"tags":["sql","select","asp-classic"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13249492,"title":"Select statement to check multiple rows against 2 variables","body":"<p>I have the following table :</p>\n\n<pre><code>alertID inspectorID datelive                dateread\n1       none       2012-11-06 10:36:03.350  NULL\n2       none       2012-11-06 10:36:25.043  NULL\n3       none       2012-11-06 10:36:42.433  NULL\n1       31030      2012-11-06 10:37:19.193  2012-06-11 10:34:47.000\n</code></pre>\n\n<p>I want to select the alerts that dont have the inspectors ID against it AND where the alert ID doesn't match the one that has the inspectorID against it, ie inspector has read alert 1 so i only want it to return alerts 2 &amp; 3</p>\n\n<p>Am using Classic ASP and MS-SQL</p>\n"},{"tags":["sql","tsql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13249308,"title":"T-SQL Unpivot with column values","body":"<p>I have a table like below:</p>\n\n<blockquote>\n  <h2>Check |  Bill Total  | D1 | D2 | D3 | D4 | D5 |</h2>\n\n<pre><code>1              100       10           2\n2               50       10                   5    7\n</code></pre>\n</blockquote>\n\n<p>D1 - D5 stands for different discount type, how can I get to the following?</p>\n\n<blockquote>\n  <h2>Check |  Bill Total  | Discount Type | Discount |</h2>\n\n<pre><code>1        100            D1             10\n1        100            D3              2\n2        100            D1             10\n2        100            D4              5\n2        100            D5              7\n</code></pre>\n</blockquote>\n\n<p>Many Thanks.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13248976,"title":"How to insert, update, delete when import data from table to table?","body":"<p>I have a query that I need to run more than once a day. This query is importing data from a database to another. </p>\n\n<p>The target table structure is:  </p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2\n</code></pre>\n\n<p>An application can also insert data to the target table. The records that are inserted by the application may not be updated also when this record exists in the source(temp table) table with another state.</p>\n\n<p>To make this possible I have an solution created. I will create an new column in the target table with a second state so that I can check.</p>\n\n<pre><code>Id   Date        Department  Location  PersonId  Starttime       EndTime       State   StateSource\n1    2012-01-01      2           5       200     12:00:00.000    15:00:00.000   2       2\n</code></pre>\n\n<p>Some Requirements:</p>\n\n<p>If a record is added by the application than StateSource will be NULL. Means that this record may not be deleted, updated or inserted again from the source table.</p>\n\n<p>If a Record is updated by the application than the value State and StateSource will be different. In this case I do not update this record.</p>\n\n<p>I will update if the state from the sourcetable and targettable are not same and the values from target table State = StateSource.</p>\n\n<p>I will INSERT a record when this is not exists in the target table. When records already exists do not insert (no matter if this is added by the application or my query on the first run).</p>\n\n<p>I will delete the records from the target when they are no more exists in my sourcetable and State=StateSource.</p>\n\n<p>I already have the following queries. I have decided to make 3 statements.</p>\n\n<pre><code>--Delete Statement first\nDelete from t\nfrom TargetTable t LEFT JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\nand t.State=t.StateSource\n\n--Just delete if a date is no more exists from the source table and this records is NOT\n--changed by the application (t.State=t.StateSource)\n\n\n--Update statement second\nUpdate t\nset t.State = s.State\nFrom Targettable t INNER JOIN SourceTable s ON t.Id=s.Id \nand t.Date=s.Date \nand t.departments=s.Department\nand t.PersonId=s.PersonId\n\nThe problem here is:\n--when I have State 2 already in the targettable and in my sourcetable i have\n--another state then the state in the targettable changes. This would not be the case.\n\n\n--Insert Statement thirth\n\ninsert into TargetTable (Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource)\nselect Id, Date, Department, Location, PersonId, Starttime, EndTime,State, StateSource\nfrom SourceTable s \nWHERE Date not in (select Date \n                   from TargetTable t \n                   where t.id=s.id \n                   and t.PersonId=s.PersonId\n                   and t.date=s.date\n                   and t.department=s.department)     \n\n--I have no idea about how the insert should be because the application also can\n--insert records. When a record exists then no insert. What to do with the State?\n</code></pre>\n\n<p>Remember that the states that are changed by the application are leading.</p>\n\n<p>Can anyone help me with the desired result? </p>\n"},{"tags":["sql","indexes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13249042,"title":"Find out which indexes have been created using ONLINE = ON","body":"<p>Please could someone let me know if there is a way to identify which indexes have been created using the <code>ONLINE = ON</code> statement</p>\n\n<pre><code>CREATE INDEX idx_Table\nON MyTable (MyColumn)\nWITH (ONLINE = ON)\n</code></pre>\n\n<p>On of our system suppliers requested that we upgrade our installation from Standard to Enterprise edition to support online indexes.  The work has been completed and the new database implemented but would like to identify the online indexes.</p>\n"},{"tags":["sql","database","query","postgresql","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13249348,"title":"Extrude 2d polygon into 3d polygon","body":"<p>I am using postgresql and I have a table containing 2d polygons. Now my question is how can I extrude this polygon into a nice 3d building.? </p>\n\n<p>Can anyone help please? because I couldn't find a good tutorial on it.</p>\n\n<p>Many thanks</p>\n"},{"tags":["sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13248614,"title":"Providing a join count and total count in the same query with Active Record","body":"<p>One <strong>style</strong> has many <strong>reviews</strong>.</p>\n\n<p>Let's say I am doing: </p>\n\n<pre><code>Style.select('styles.id').\n    joins(:reviews).\n    select('reviews.style_id, count(reviews.id) AS review_count')\n</code></pre>\n\n<p>... but I also want to know the total number of reviews! Is it possible to pull that information as well. I tried count(*) as total_reviews, but this still returns the review count per style.</p>\n"},{"tags":["java","mysql","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13248737,"title":"Java Hibernate constant in sql-query","body":"<p>Below is the original content of a hibernate sql query I have:</p>\n\n<pre><code>&lt;sql-query name=\"countryOfOrigin-limit-country-city-location\"&gt;\n&lt;return alias=\"rb\" class=\"RecentBooking\"/&gt;\n    SELECT \n        bb.reserv_num as {rb.reservNum}, \n        bb.origin as {rb.countryOfOrigin}, \n        bb.pick_up_loc as {rb.locationId}, \n        bb.first_date as {rb.bookingDate}, \n        bb.pick_up_time as {rb.pickUpDate}, \n        bb.drop_off_time as {rb.dropOffDate},  \n        bb.car_price as {rb.carPrice}, \n        bb.discount as {rb.discount}, \n        bb.exchange_rate as {rb.exchangeRate},\n        SUBSTRING(a.internal_class,1,1)as {rb.carClass},\n        a.car_type as {rb.carType}, \n        bb.vehicle_type as {rb.vehicleType}, \n        s.name as {rb.supplier}, \n        vv.country as {rb.country}, \n        vv.city as {rb.city}, \n        vv.location as {rb.location}, \n        bb.cur as {rb.currency}, \n        a.pics as {rb.carImage}\n    FROM (SELECT * FROM b  WHERE first_date &gt; DATE(NOW()-1)AS bb  \n    JOIN a a ON a.id = bb.car_id\n    JOIN d  d ON d.id = bb.pick_up_loc\n    JOIN supplier s ON s.id = d.supplier_id\n    JOIN v_location_trans vv ON vv.location_id = d.location_id\n    AND vv.lang=33\n    AND vv.country = :country\n    AND vv.city = :city\n    AND vv.location = :location\n    AND bb.origin = :countryOfOrigin\n    ORDER BY bb.id DESC\n    LIMIT :limit\n&lt;/sql-query&gt;\n</code></pre>\n\n<p>The sql runs fast enough, but as you might have noticed there is a big, the NOW()-1 should be NOW() - INTERVAL 1 DAY.</p>\n\n<p>I modified the nested select statement as follows:</p>\n\n<pre><code>FROM (SELECT * FROM b WHERE first_date &gt; DATE(NOW() - INTERVAL 1 DAY)) AS bb\n</code></pre>\n\n<p>The fix works fine in terms of results, however the query slows down massively (pretty much almost instant up to a few seconds).</p>\n\n<p>I believe this is because the DATE(NOW() - INTERVAL 1 DAY) is being evaluated a large number of times (we have a very large data set). How would I go about seperating this calculation so that it only occurs once, without having to pass it in from java code like the country, city, limit, etc?</p>\n\n<p>I have very little experience with hibernate or SQL, and I have tried seperating the calculation out into a variable before the select statement, which isnt allowed. I have also tried making small changes to the SQL query but I keep getting runtime errors, presumably due to invalid SQL.</p>\n\n<p>How would I go about doing this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13249048,"title":"Relational SQL query","body":"<p>There are two tables which have a relation via a distinct so called PK.</p>\n\n<pre><code>Email     Gender  \na@a.cn    12345  \nb@b.cn    12365\n\nPK     String    \n12345  MALE  \n12365  FEMALE\n</code></pre>\n\n<p>What would a query look like to get E-Mail and the String of the gender? </p>\n\n<pre><code> select \n  user.Email,\n  users.Gender\nfrom\n  users,\nvalues\n</code></pre>\n"},{"tags":["sql","asp.net-mvc-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13234449,"title":"Displaying SQL view with Left Outer Join in MVC3","body":"<p>I'm using a simple view which is a left outer join on two tables to get the CATEGORY name that each FEE would fall under and group them for display.  When I simply run the view and iterate through the items it repeats the items like it isn't using the same view.  </p>\n\n<pre><code>    @foreach (var category in Model.FeeScheduleRates())\n{\n    &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n    foreach (var item in Model.FeeScheduleRates())\n    {                                  \n\n    &lt;tr&gt; \n        &lt;td&gt;@item.Fee_Title - @item.Description&lt;/td&gt;\n        &lt;td&gt;@item.Amount&lt;/td&gt;                                        \n    &lt;/tr&gt;\n    }                                   \n}\n</code></pre>\n\n<p>So I changed my approach to a while loop for the second set of items, but that brought on OUT OF MEMORY errors and doesn't seem to work.  </p>\n\n<pre><code>@foreach (var category in Model.FeeScheduleRates())\n{   \n    &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n    var cid = category.Cat_ID;                             \n    while (category.Cat_ID == cid)\n    {\n         &lt;tr&gt; \n            &lt;td&gt;@category.Fee_Title - @category.Description&lt;/td&gt;\n            &lt;td&gt;@category.Amount&lt;/td&gt;                                        \n        &lt;/tr&gt;       \n    }                            \n}\n</code></pre>\n\n<p>So the questions is, how to iterate through a view and group the items into their categories, displaying the category only once></p>\n\n<p>I've gone back to the drawing board and using this:</p>\n\n<pre><code>                             @foreach (var category in Model.FeeScheduleRates().Distinct())\n                            {\n                                &lt;tr&gt;&lt;td colspan=\"2\"&gt;@category.Category&lt;/td&gt;&lt;/tr&gt;\n                                foreach (var item in Model.FeeScheduleRates().Where(i=&gt;i.Cat_ID == category.Cat_ID))\n                                {                               \n                                    &lt;tr&gt; \n                                        &lt;td&gt;@item.Fee_Title - @item.Description&lt;/td&gt;\n                                        &lt;td&gt;@item.Amount&lt;/td&gt;                                        \n                                    &lt;/tr&gt;\n                                }                                   \n                            }\n</code></pre>\n\n<p>Have experienced some some form of success in that the categories are appearing as rows and then items beneath.  The funny thing is, it still just repeats the same item as many times as their are records matching that category.  I\"m still curious why it isn't iterating through the items properly and giving me each Fee_Title and Description.\nExample:</p>\n\n<p>`FREE Services</p>\n\n<p>Bank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nBank-to-Bank (B2B) Transfer - funds into FCU    FREE<br />\nSavings and Money Market Account<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2<br />\nAutomatic transfer from Savings -   $2`</p>\n\n<p>So there are 12 items in the DB under the category free and 7 under the Savings and Money Market Account.  It just repeats the first one of each category as many times as there are records in the category.  I do get it!!!</p>\n"},{"tags":["sql","parameters","append","ado"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":59,"score":5,"question_id":13034479,"title":"Use variable to append field parameter","body":"<p>Cross Posted Here:</p>\n\n<p><a href=\"http://www.vbforums.com/showthread.php?696163-Use-variable-to-append-field-parameter&amp;p=4264077#post4264077\">http://www.vbforums.com/showthread.php?696163-Use-variable-to-append-field-parameter&amp;p=4264077#post4264077</a></p>\n\n<p>I am using ADO to retrieve data from MS Access into Excel, and I want to append an Iif statement into the SELECT part of my query. My SQL string is stored in a text file, and any parameters are being appended via ADO.</p>\n\n<p>I know how to append parameters in the WHERE clause, and can even append parameters in the SELECT statement like this:</p>\n\n<pre><code>SELECT BA, Iif(QA=[@somestring],[@somestring2], [@somestring3])\nFROM myData\nWHERE BA = 'some person'\n</code></pre>\n\n<p>But what I am trying to accomplish is to transform a placeholder [@somestring] into a variable length Iif statement, such as:</p>\n\n<pre><code>SELECT BA, [@somestring]    \n</code></pre>\n\n<p>And the placeholder translates to a string I have built using a function:</p>\n\n<pre><code>Iif(QA='Jon Doe', 'Jon', Iif(QA='Jane Doe', 'Jane', 'Nobody')).  \n</code></pre>\n\n<p>Right now, the result I get is the literal string I pass to the parameter populating the entire field.  So the Iif statement is literally written out for each record, rather than being evaluated by SQL.</p>\n\n<p>Is what I am trying to do even possible, or does SQL need the Field for the Iif statement predefined in the initial command?     </p>\n\n<p>ie, Iif(QA=[@somestring], [@sometstring2], [@somestring3])</p>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13193557,"title":"SQL pad query result for missing groups","body":"<p>Assume the following table:</p>\n\n<p>TableA:  </p>\n\n<pre><code>ID  GroupName SomeValue\n1   C         1\n2   C         1\n2   B         1\n2   A         1\n</code></pre>\n\n<p>I need to construct a query that selects the following result:  </p>\n\n<pre><code>ID  GroupName SomeValue\n1   C         1\n1   B         0\n1   A         0\n2   C         1\n2   B         1\n2   A         1\n</code></pre>\n\n<p>The GroupName is actually derived from TableA column's CASE expression and can take only 3 values: A, B, C.  </p>\n\n<p>Are the analytic functions the way to go?  </p>\n\n<p><strong>EDIT</strong>  </p>\n\n<p>Sorry, for not mentioning it, but the ID could consist of multiple columns. Consider this example:  </p>\n\n<pre><code>ID1 ID2 GroupName SomeValue\n1   1   C         1\n\n1   2   C         1\n\n2   2   C         1\n2   2   B         1\n2   2   A         1\n</code></pre>\n\n<p>I need to pad <code>SomeValue</code> with 0 for each unique combination ID1+ID2. So the result should be like this:  </p>\n\n<pre><code>ID1 ID2 GroupName SomeValue\n\n1   1   C         1\n1   1   B         0\n1   1   A         0\n\n1   2   C         1\n1   2   B         0\n1   2   A         0\n\n2   2   C         1\n2   2   B         1\n2   2   A         1  \n</code></pre>\n\n<p><strong>EDIT2</strong><br>\nSeems like solution, proposed by @Laurence should work even for multiple-column 'ID'. I couldn't rewrite the query proposed by @Nicholas Krasnov to conform to this requirement. But could somebody compare these solutions performance-wise? Will the <code>analytic function</code> work faster than 'cross join + left outer join'?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13246447,"title":"One date check for entire query","body":"<p>I have the following query:</p>\n\n<pre><code>select \n    fp.id, \n    fr.id,\n    sum(case \n        when to_date(fp.offered_date) BETWEEN TO_DATE( :ad_startdate, 'YYYY-MM-DD') \n             AND TO_DATE(:ad_enddate, 'YYYY-MM-DD') and fp.result &lt;&gt; 'E'\n             then 1 \n        else 0 \n        end) total,\n    sum(case when fp.result = 'G' \n        and  to_date(fp.offered_date) &gt;=  :ad_startdate\n        and  to_date(fp.offered_date) &lt;= :ad_enddate then 1 else 0 end) colorgreen,\n    sum(case when fp.resultat = 'R' \n        and  to_date(fp.offered_date) &gt;=  :ad_startdate\n        and  to_date(fp.offered_date) &lt;= :ad_enddate then 1 else 0 end) colorred\nFROM \n    fruit_properties fp, fruit fr\nWHERE \n    fp.id = fr.id\nGROUP BY \n    fp.id, fr.id\n</code></pre>\n\n<p>I'm checking dates 1 time for each sum column and have a feeling this can be made once somehow? Right now if I check only once at the total column, then colorgreen + colorred might be larger than the total since it counts no matter what date they have.</p>\n\n<p>Can my query be enhanced somehow?</p>\n"},{"tags":["java","sql","hibernate","netbeans"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13247006,"title":"Error in HIbernate Querying Language","body":"<p>I am pretty new to Hibernate based Application Developing.\nRecently i run the same code(which is shown in the below) in Eclipse Juno IDE. It works fine.\nBut when coming to Netbeans it doesn't work.And it shows the error as </p>\n\n<blockquote>\n  <p>SEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='username'' at line 1</p>\n</blockquote>\n\n<p>Here Iam using the Mysql 5.5,IDE-NetBeans-7.2.1.</p>\n\n<p>Here the code i am executing is,</p>\n\n<p>Hibernate.cfg.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt;\n    &lt;mapping resource=\"hibernatefiles/Users.hbm.xml\"/&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Hibernating Mapping File:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Nov 6, 2012 12:42:42 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"hibernatefiles.Users\" table=\"users\" catalog=\"OFFICE MANAGER\"&gt;\n        &lt;id name=\"uid\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"Uid\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"uname\" type=\"string\"&gt;\n            &lt;column name=\"uname\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"upass\" type=\"string\"&gt;\n            &lt;column name=\"upass\" length=\"30\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"ename\" type=\"string\"&gt;\n            &lt;column name=\"ename\" length=\"100\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"edesg\" type=\"string\"&gt;\n            &lt;column name=\"edesg\" length=\"100\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"contactnumber\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"contactnumber\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Users.java(POJO File)</p>\n\n<pre><code>package hibernatefiles;\npublic class Users  implements java.io.Serializable {\n\n\n     private Integer uid;\n     private String uname;\n     private String upass;\n     private String ename;\n     private String edesg;\n     private Integer contactnumber;\n\n    public Users() {\n    }\n\n    public Users(String uname, String upass, String ename, String edesg, Integer contactnumber) {\n       this.uname = uname;\n       this.upass = upass;\n       this.ename = ename;\n       this.edesg = edesg;\n       this.contactnumber = contactnumber;\n    }\n\n    public Integer getUid() {\n        return this.uid;\n    }\n\n    public void setUid(Integer uid) {\n        this.uid = uid;\n    }\n    public String getUname() {\n        return this.uname;\n    }\n\n    public void setUname(String uname) {\n        this.uname = uname;\n    }\n    public String getUpass() {\n        return this.upass;\n    }\n\n    public void setUpass(String upass) {\n        this.upass = upass;\n    }\n    public String getEname() {\n        return this.ename;\n    }\n\n    public void setEname(String ename) {\n        this.ename = ename;\n    }\n    public String getEdesg() {\n        return this.edesg;\n    }\n\n    public void setEdesg(String edesg) {\n        this.edesg = edesg;\n    }\n    public Integer getContactnumber() {\n        return this.contactnumber;\n    }\n\n    public void setContactnumber(Integer contactnumber) {\n        this.contactnumber = contactnumber;\n    }\n\n}\n</code></pre>\n\n<p>I am Executing the HQL in the below JSP File by using Query Class.</p>\n\n<pre><code>&lt;%@page import=\"hibernatefiles.Users\"%&gt;\n&lt;%@page import=\"java.util.Iterator\"%&gt;\n&lt;%@page import=\"org.hibernate.Query\"%&gt;\n&lt;%@page import=\"org.hibernate.Session\"%&gt;\n&lt;%@page import=\"org.hibernate.Transaction\"%&gt;\n&lt;%\n    String user_id = request.getParameter(\"uid\");\n    String u_pass = request.getParameter(\"upass\");\n    out.println(\"got it dude we get the details...\"+user_id+\"\\n\"+u_pass);\n\n    //writing the hibernate code\n\n    Transaction transaction;\n\n    Session ses = hibernatefiles.NewHibernateUtil.getSessionFactory().openSession();\n    try{\n             transaction = ses.beginTransaction();\n             String HQL = \"FROM Users u WHERE u.uname='\"+user_id+\"'\";\n             Query query = ses.createQuery(HQL);\n            java.util.List li = query.list();\n            Iterator itera = li.iterator();\n            while(itera.hasNext()){\n        //getting record\n                Users u= (Users) itera.next();\n        out.println(\"user name is:\"+u.getUname());\n                out.println(\"user password is :\"+u.getUpass());         \n\n            }\n\n    }\n    catch(Exception error){\n        error.printStackTrace();\n\n    }\n\n%&gt;\n</code></pre>\n\n<p>Here NetBeans Log</p>\n\n<pre><code>Nov 06, 2012 2:31:27 PM org.apache.catalina.core.StandardContext reload\nINFO: Reloading Context with name [/Office_Manager] is completed\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.annotations.Version &lt;clinit&gt;\nINFO: Hibernate Annotations 3.3.1.GA\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: Hibernate 3.2.5\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: hibernate.properties not found\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: Bytecode provider name : cglib\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: using JDK 1.4 java.sql.Timestamp handling\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration configure\nINFO: configuring from resource: /hibernate.cfg.xml\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration getConfigurationInputStream\nINFO: Configuration resource: /hibernate.cfg.xml\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : hibernatefiles/Users.hbm.xml\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.Configuration doConfigure\nINFO: Configured SessionFactory: null\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nINFO: Mapping class: hibernatefiles.Users -&gt; users\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.AnnotationConfiguration secondPassCompile\nINFO: Hibernate Validator not found: ignoring\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: Using Hibernate built-in connection pool (not for production use!)\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: Hibernate connection pool size: 20\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: autocommit mode: false\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: using driver: com.mysql.jdbc.Driver at URL: jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: connection properties: {user=root, password=****}\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: RDBMS: MySQL, version: 5.5.25a\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC driver: MySQL-AB JDBC Driver, version: mysql-connector-java-5.1.18 ( Revision: tonci.grgin@oracle.com-20110930151701-jfj14ddfq48ifkfq )\nNov 06, 2012 2:31:47 PM org.hibernate.dialect.Dialect &lt;init&gt;\nINFO: Using dialect: org.hibernate.dialect.MySQLDialect\nNov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionFactoryFactory buildTransactionFactory\nINFO: Using default transaction strategy (direct JDBC transactions)\nNov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionManagerLookupFactory getTransactionManagerLookup\nINFO: No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Automatic flush during beforeCompletion(): disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Automatic session close at end of transaction: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC batch size: 15\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC batch updates for versioned data: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Scrollable result sets: enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC3 getGeneratedKeys(): enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Connection release mode: auto\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Maximum outer join fetch depth: 2\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Default batch fetch size: 1\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Generate SQL with comments: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Order SQL updates by primary key: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Order SQL inserts for batching: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createQueryTranslatorFactory\nINFO: Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory\nNov 06, 2012 2:31:47 PM org.hibernate.hql.ast.ASTQueryTranslatorFactory &lt;init&gt;\nINFO: Using ASTQueryTranslatorFactory\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Query language substitutions: {}\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JPA-QL strict compliance: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Second-level cache: enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Query cache: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createCacheProvider\nINFO: Cache provider: org.hibernate.cache.NoCacheProvider\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Optimize cache for minimal puts: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Structured second-level cache entries: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Echoing all SQL to stdout\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Statistics: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Deleted entity synthetic identifier rollback: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Default entity-mode: pojo\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Named query checking : enabled\nNov 06, 2012 2:31:47 PM org.hibernate.impl.SessionFactoryImpl &lt;init&gt;\nINFO: building session factory\nNov 06, 2012 2:31:48 PM org.hibernate.impl.SessionFactoryObjectFactory addInstance\nINFO: Not binding factory to JNDI, no JNDI name configured\nNov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nWARNING: SQL Error: 1064, SQLState: 42000\nNov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nSEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1\norg.hibernate.exception.SQLGrammarException: could not execute query\nHibernate: \n    select\n        users0_.Uid as Uid0_,\n        users0_.uname as uname0_,\n        users0_.upass as upass0_,\n        users0_.ename as ename0_,\n        users0_.edesg as edesg0_,\n        users0_.contactnumber as contactn6_0_ \n    from\n        OFFICE MANAGER.users users0_ \n    where\n        users0_.uname='manikanta'\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.doList(Loader.java:2223)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\n    at org.hibernate.loader.Loader.list(Loader.java:2099)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)\n    at org.apache.jsp.Employers.checking_jsp._jspService(checking_jsp.java:88)\n    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)\n    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)\n    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n    at com.mysql.jdbc.Util.getInstance(Util.java:386)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)\n    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2293)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n    at org.hibernate.loader.Loader.doList(Loader.java:2220)\n    ... 33 more\n</code></pre>\n"},{"tags":["sql","select","groovy","named-parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13248084,"title":"groovy - Sql eachRow named parameters with map","body":"<p>I'm trying to perform select like this:</p>\n\n<pre><code>def queries = [\n    [\n        paramQuey: \"\",\n        mainQuery: \"SELECT * FROM SOME_TABLE\"\n    ],\n    [\n        paramQuey: \"SELECT SOME_COLUMN AS COUNT FROM A_TABLE WHERE SOMETHING=3\",\n        mainQuery: \"SELECT * FROM OTHER_TABLE WHERE ROWNUM&lt;:COUNT\"\n    ]\n]\n\nqueries.each {\n    def params = [:]\n    if(!it.paramQuery.isEmpty()) {\n        params = sql.firstRow(it.paramQuery)\n    }\n    sql.eachRow(mainQuery, params) { //&lt;--here's my problem\n        //do something\n    }\n}\n</code></pre>\n\n<p>However, program throws </p>\n\n<pre><code>Exception in thread \"main\" groovy.lang.MissingMethodException: No signature of method: groovy.sql.Sql.eachRow() is applicable for argument types: (java.lang.String, java.util.LinkedHashMap, MyClass$_execute_closure4) values: [SELECT * FROM SOME_TABLE, [:], MyClass$_execute_closure4@b3600d]\nPossible solutions: eachRow(java.lang.String, groovy.lang.Closure), eachRow(java.lang.String, groovy.lang.Closure, groovy.lang.Closure), eachRow(java.lang.String, java.util.List, groovy.lang.Closure), eachRow(groovy.lang.GString, groovy.lang.Closure), eachRow(groovy.lang.GString, groovy.lang.Closure, groovy.lang.Closure), eachRow(java.lang.String, int, int, groovy.lang.Closure)\n</code></pre>\n\n<p>which clearly shows that there's no method for handling eachRow with named parameters. However according to <a href=\"http://groovy.codehaus.org/api/groovy/sql/Sql.html\" rel=\"nofollow\">http://groovy.codehaus.org/api/groovy/sql/Sql.html</a> there are:</p>\n\n<pre><code>    void    eachRow(java.lang.String sql, java.util.Map params, Closure closure)\n    void    eachRow(java.lang.String sql, java.util.Map params, Closure metaClosure, Closure rowClosure)\n    void    eachRow(java.lang.String sql, java.util.Map map, Closure metaClosure, int offset, int maxRows, Closure rowClosure)\n    void    eachRow(java.lang.String sql, java.util.Map params, int offset, int maxRows, Closure closure)\n    void    eachRow(java.util.Map params, java.lang.String sql, Closure closure)\n    void    eachRow(java.util.Map params, java.lang.String sql, Closure metaClosure, Closure rowClosure)\n    void    eachRow(java.util.Map map, java.lang.String sql, Closure metaClosure, int offset, int maxRows, Closure rowClosure)\n    void    eachRow(java.util.Map params, java.lang.String sql, int offset, int maxRows, Closure closure)\n</code></pre>\n\n<p>which leaves me wondering: what am I doing wrong, and how can I handle named parameters with eachRow.</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":51,"score":0,"question_id":13230750,"title":"How to display Month Names from month numbers","body":"<p>Now i am in a condition, Where I am just displaying the month names and some data grouped by month number. There is a small issue. I need to get month names instead of month numbers from Oracle.</p>\n"},{"tags":["c#","javascript","asp.net","sql","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":13220979,"title":"How to create hot spots on an image with mouse over and clickable area?","body":"<p>I have a scenario where i want to create hot spot on image.I want to let the hot spots on image be created by the user.Suppose user want to create rectangle on image then he just need to left click with mouse and create rectangle and this rectangle should be displayed with clickable area(Hot spot.).I need it because I need to create a page where a user can select specific area and should be the clickable in future.Can any one please suggest me the way.  </p>\n\n<p>here is the example image.I am now able to draw lines on image but i want to create rectangle which should be clickable with mouse over.\n<img src=\"http://i.stack.imgur.com/K0Gun.png\" alt=\"enter image description here\"> </p>\n\n<p>the background is an image and blue thin line is drawn by mouse.</p>\n"},{"tags":["mysql","sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13242892,"title":"SQL query using group by","body":"<p>I have a table called \"EMP\" and two collumns one called \"deptno\" and the other called \"job\". I need a query to find out how many people there are in each type of job within each department.</p>\n\n<p>I know I need to use count() and group by but im not sure how to do this, any help would be appreciated.</p>\n\n<p>Thanks James. </p>\n"},{"tags":["sql","c","web-services","embedded","point-of-sale"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13227288,"title":"web service access in mobile POS device","body":"<p>i have a web service which  will  return a single dimensions array  or string, if some parameters are passed to it eg,(1,1, ,dd/mm/yyyy hh:mm).It would be really helpful if iam able to get some idea on how this web service can be accessed from a gprs enabled mobile device (Point of sale- ARM9 device with 256MB of NAND flash for the Operating System,\nUser application and the remaining for the user data[Files, Databases and other\nuser requirement].\n ) using <strong>C</strong>( as it is having its self-diagnosing  application developed in C (host os- fedora) for displaying menus,printing bills etc which i also need in my project).i need to store this accessed data temporarily as text file in this device itself for later use.im quite new in this and i couldnt find anything useful on POS software development.so pls help as i cant go forward in developing without proper understanding.pls pardon for posting this here.thanks in advance.</p>\n\n<p>ps:I  mainly need Help  in the portion of temporary storage of data from the web service on the device (to work off-line) and query it when needed.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13246598,"title":"Join two tables and group by xyz","body":"<p>I have two tables</p>\n\n<p>Table 1:</p>\n\n<pre><code>    ref       status\n\n    abc     1\n    abc     1\n    abc     2\n    abc     3\n    abc     5(not in Table2)\n    abc     5(not in Table2)\n</code></pre>\n\n<p>Table 2:</p>\n\n<pre><code>    ref          status\n\n    abc     1\n    abc     1\n    abc     2\n    abc     3\n    abc             4(not in Table1)\n    abc     4(not in Table1)\n</code></pre>\n\n<p>I want to join these two tables and perform a grouping so that the final result looks like this:</p>\n\n<p>Resultant Table:\n        ref       status</p>\n\n<pre><code>    abc     1\n    abc     2\n    abc     3\n    abc     4\n    abc     5\n</code></pre>\n\n<p>I have tried this</p>\n\n<pre><code>    SELECT DISTINCT Table1.ref, Table1.status, Table2.ref, Table2.status\n    FROM Table1, Table2\n    GROUP BY Table1.ref, Table1.status, Table2.ref, Table2.status;\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13246561,"title":"select data vice versa","body":"<p>I have two table in my database.</p>\n\n<pre><code>1) User Table\n\nid  username    password    logo    email\n1   admin        admin      NULL    1   \n2   support     support     NULL    NULL    \n3   test        test        NULL    NULL    \n\n\n2) Link Account Table\n\nID  AccountID   LinkAccountID\n1       1           2\n</code></pre>\n\n<p>Now if i select username with accountid 1 then it will return me Admin and Support\n    same way if i select username with accountid 2 then also it will return admin and support\n    and if i select username with accountid 3 then it will return only test</p>\n\n<p>something like vice versa if in link account table account id is 1 or linkaccountid is 1 that will return both id</p>\n\n<p>Thanks in advance</p>\n\n<p>Regards</p>\n\n<p>Amit Vyas</p>\n"},{"tags":["java","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13247844,"title":"Delete state for sql query","body":"<p>I've met up with some problems regarding to sql statement. I screenshot a photo of tables for you guys to see.</p>\n\n<p><img src=\"http://i.stack.imgur.com/pXzYD.png\" alt=\"Picture delete\"></p>\n\n<p>Okay, so what I'm trying to do here is that i retrieve a parameter from the user, which is '14' in this case. So the query has to link the other foreign keys and delete them off. For this, 'User' table is the \"Parent\" of the other 2 tables which is 'camera' and 'mob_dev'. However, camera can't be deleted as there is another foreign key connected to the table 'camera' which is 'device'. So is there any idea on how I can delete the 4 tables by only inputting a single parameter at 'User' table 'userid'. I tried it by doing this in the controller:</p>\n\n<pre><code>String querycam = \"DELETE FROM ip_camera where user_id =\"  +params.userinput\nString querydevice = \"DELETE FROM mobile_device where user_id =\"  +params.userinput\nString queryvalue = \"DELETE FROM sec_user where id =\"  +params.userinput\n</code></pre>\n\n<p>Or is there a better way for doing this? Thanks in advance to anyone who can solve this :).</p>\n"},{"tags":["c#","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13247500,"title":"Is it bad practice to store SQL stored procedures and parameters in a database table","body":"<p>We have a use case where an app that sends out emails finds a specific string ('smart tag')  in an email and replaces it with the results of a stored procedure. </p>\n\n<p>So for example the email could have <code>Dear &lt;ST:Name&gt;</code> in the body, and then the code would identify this string, run the stored procedure to find the client name passing in the client id as a parameter.</p>\n\n<p>The list of these tags and the stored procedures that need to be run are currently hard coded, so every time a new 'smart tag' needs to be added, a code change and deployment is required. </p>\n\n<p>Our BA's our skilled in SQL and want to be able to add new tags manually. </p>\n\n<p>Is it bad practice to store the procedure and parameters in a database table? Would this be a suitable design for such a table? Would it be necessary to store parameter type?</p>\n\n<p><strong>SmartTag</strong> </p>\n\n<pre><code>SmartTagId   SmartTag   StoredProcedure\n</code></pre>\n\n<p><strong>SmartTagParameters</strong> </p>\n\n<pre><code>SmartTagParameterId   SmartTagId   ParameterName\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13246326,"title":"sql query in where condition","body":"<p>Is it good if i write query like this:- (see query in where condition)</p>\n\n<pre><code>SELECT distinct(id) \"idea_id\" \nFROM ideas \nWHERE deleted_by_user = 0 AND moderation_flag = 1 AND \nuser_id in (select id \n            from users \n            where confirm like \"yes\") \nORDER BY time_of_creation DESC\n</code></pre>\n\n<p>let me know if there is some issue in this query :\nthanx in advance..</p>\n"},{"tags":["sql","database","web-applications","rdbms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13213706,"title":"Ready web query interface to SQL databases","body":"<p>Do you know any free tool which would constitute a <strong>web-based SQL database generic query interface</strong>, incl.:</p>\n\n<ul>\n<li>(mainly) allowing to type in an SQL query and display the result in some nice way</li>\n<li>the interface should allow for some basic security - allowing only <code>SELECT</code> queries </li>\n<li>the very need is to support MS SQL Server, but Oracle support would be useful</li>\n<li>should run against an existing database instance without any re-configuration needed</li>\n<li>might be simple, no need to browse tables, analyze database columns or anything else you would experience in SQLDeveloper or SQL Server Management Studio</li>\n</ul>\n\n<p>Platform / language / etc. is of second importance.</p>\n"},{"tags":["sql","query","postgresql","otrs"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13237579,"title":"querying otrs database","body":"<p>I have a problem with creating a query on a postgresql database from OTRS.  I need to get an asset list with some data that is stored in the CMDB, but I am having trouble with the way that the data is stored.</p>\n\n<p>This query works ok as far as it goes but as soon as I add another left join to get some more data it just runs for ever without returning any results.</p>\n\n<p>As far as I can see, the problem is that all the information is contained in the xml_storage table without any relationships so I need to repeatedly query that table to get the data.  There is also a mix of data types where an integer is stored as a varyable character in some cases and this prevents me from using that value to get additional information from the general catalog.</p>\n\n<p>I have been banging my head against a brick wall for days on this so i would really appreciate any help</p>\n\n<pre><code>SELECT \n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      array_agg(service),\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    FROM \n      public.configitem_version,\n      public.general_catalog,\n      public.configitem \n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS asset_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Asset Number''}[1]{''Content''}')   as select_asset on last_version_id::int = select_asset.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS manufacturer_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Manufacturer''}[1]{''Content''}' ) as select_manufacturer on last_version_id::int = select_manufacturer.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS model_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''Model''}[1]{''Content''}' ) as select_model on last_version_id::int = select_model.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS serial_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''SerialNumber''}[1]{''Content''}' ) as select_serial on last_version_id::int = select_serial.xml_key::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS fqdn_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''FQDN''}[1]{''Content''}' ) as select_fqdn on last_version_id::int = select_fqdn.xml_key::int\n\n    left join\n      (SELECT \n      link_relation.source_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.target_key::int = service.id AND\n      link_relation.target_object_id::int = 2 AND link_relation.source_object_id::int = 3\n      UNION\n      SELECT \n      link_relation.target_key AS \"configitem_id\", \n      service.name AS \"service\"\n      FROM \n      public.link_relation, \n      public.service\n      WHERE \n      link_relation.source_key::int = service.id AND\n      link_relation.target_object_id::int = 3 AND link_relation.source_object_id::int = 2) as select_service on configitem.id = configitem_id::int\n\n    left join\n      (SELECT\n      xml_storage.xml_content_value AS purchasedate_value,\n      xml_storage.xml_key\n      FROM\n      public.xml_storage \n      WHERE\n      xml_content_key = '[1]{''Version''}[1]{''PurchaseDate''}[1]{''Content''}' ) as select_purchasedate on last_version_id::int = select_purchasedate.xml_key::int\n\n    left join\n      (SELECT\n      general_catalog.name AS status_value,\n      general_catalog.id\n      FROM\n      public.general_catalog) as select_status on configitem.cur_depl_state_id::int = select_status.id::int\n\n    WHERE\n      configitem.last_version_id = configitem_version.id AND\n      configitem.class_id = general_catalog.id AND\n      (configitem.class_id = 32 OR configitem.class_id = 33)\n\n\n    GROUP BY\n      asset_value,\n      manufacturer_value,\n      model_value,\n      serial_value,\n      fqdn_value,\n      purchasedate_value,\n      status_value,\n      configitem.configitem_number,\n      configitem_version.name,\n      general_catalog.name\n\n    ;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13245663,"title":"SQL Server format decimal places with commas","body":"<p>How can I convert the decimal values to have some commas?</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4269529/sql-server-2005-currency-format-with-commas-and-period\">this</a> Helps me. But my problem the decimal places are set to 2 only..I want the decimal to be 2, 3, or 4..example</p>\n\n<pre><code>1,234.123   or    1,234.12345\n</code></pre>\n\n<p>I tried</p>\n\n<pre><code>convert(varchar, convert(decimal(18, 4), 1234.1234567), 1) \n</code></pre>\n\n<p>Output : 1234.1234</p>\n\n<p>There is no comma. But if I use money the decimal are 2 only</p>\n\n<blockquote>\n  <p>convert(varchar, convert(money, 1234.1234567), 1) </p>\n  \n  <p>Output : 1,234.12</p>\n</blockquote>\n"},{"tags":["c#","sql","sql-server","sqldatareader"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13247241,"title":"DataReader problems getting data from 2 classes","body":"<p>I am very inexperienced with SQL, and have only had one lesson. I am trying to figure out how to get information from 2 classes using a DataReader. </p>\n\n<p>My Customer class:</p>\n\n<pre><code>public class Customer\n{\n    private CreditCard _creditCard;\n    private List&lt;Subscription&gt; _subscriptions;\n    private int _customerId;\n    private string _name;\n    private string _address;\n    private int _zipCode;\n    private string _city;\n    private string _email;\n    private string _password;\n\n\n    public Customer(int id, string name, string email, string password)\n    {\n        this._customerId = id;\n        this._name = name;\n        this._email = email;\n        this._password = password;\n        this._subscriptions = new List&lt;Subscription&gt;();\n    }\n\n    public Customer(int id, string name)\n    {\n        this._customerId = id;\n        this._name = name;\n        _subscriptions = new List&lt;Subscription&gt;();\n    }\n\n    public override string ToString()\n    {\n        return _customerId + \" \" + _name;\n    }\n\n    public int CustomerId\n    {\n        get { return _customerId; }\n        set { _customerId = value; }\n    }\n\n    public string Name\n    {\n        get { return _name; }\n        set { _name = value; }\n    }\n\n    public string Address\n    {\n        get { return _address; }\n        set { _address = value; }\n    }\n\n    public int ZipCode\n    {\n        get { return _zipCode; }\n        set { _zipCode = value; }\n    }\n\n    public string City\n    {\n        get { return _city; }\n        set { _city = value; }\n    }\n\n    public string Email\n    {\n        get { return _email; }\n        set { _email = value; }\n    }\n\n    public string Password\n    {\n        get { return _password; }\n        set { _password = value; }\n    }\n\n\n\n    public List&lt;Subscription&gt; Subscriptions\n    {\n        get { return _subscriptions; }\n    }\n\n    public void AddSubscription(Subscription s)\n    {\n        _subscriptions.Add(s);\n    }\n\n    public Subscription FindSubscription(int sId)\n    {\n        bool found = false;\n        int i = 0;\n        while (!found &amp;&amp; i &lt; _subscriptions.Count)\n        {\n            if (_subscriptions[i].SubscriptionId == sId)\n                found = true;\n            else\n                i++;\n        }\n        if (found)\n            return _subscriptions[i];\n        else\n            return new Subscription();\n    }\n\n}\n</code></pre>\n\n<p>My Subscription Class:</p>\n\n<pre><code>public class Subscription\n{\n    private SubscriptionType _subscriptionType;\n    private CarModel _carModel;\n    private List&lt;Booking&gt; _bookings;\n    private int _subscriptionId;\n\n    public Subscription(int subscriptionId, SubscriptionType subscriptionType, CarModel carModel)\n    {\n        this._subscriptionId = subscriptionId;\n        this._subscriptionType = subscriptionType;\n        this._carModel = carModel;\n        _bookings = new List&lt;Booking&gt;();\n    }\n\n    public Subscription()\n    { }\n\n    public int SubscriptionId\n    {\n        get { return _subscriptionId; }\n        set { _subscriptionId = value; }\n    }\n\n    public SubscriptionType SubscriptionType\n    {\n        get { return _subscriptionType; }\n    }\n\n    public CarModel CarModel\n    {\n        get { return _carModel; }\n    }\n\n    public override string ToString()\n    {\n        return this.SubscriptionId + \"\\t \" + this.SubscriptionType + \"\\t \" + this.CarModel;\n    }\n}\n</code></pre>\n\n<p>My Database class:</p>\n\n<pre><code>public class DBCustomer\n{\n    private static SqlCommand dbCmd = null;\n\n    public static List&lt;Customer&gt; GetCustomers()\n    {\n        List&lt;Customer&gt; returnList = new List&lt;Customer&gt;();\n        string sql = \"select * from Customer\";\n        dbCmd = AccessDBSQLClient.GetDbCommand(sql);\n\n        IDataReader dbReader;\n        dbReader = dbCmd.ExecuteReader();\n\n        Customer c;\n\n        while (dbReader.Read())\n        {\n            c = new Customer(Convert.ToInt32(dbReader[\"cId\"].ToString()), dbReader[\"cName\"].ToString());\n            returnList.Add(c);\n        }\n        AccessDBSQLClient.Close();\n        return returnList;\n\n    }\n\n    public static List&lt;Customer&gt; GetCustomersByEmail(string email)\n    {\n        List&lt;Customer&gt; returnList = new List&lt;Customer&gt;();\n        string sql = \"select * from Customer where cEmail = '\" + email+\"'\";\n        dbCmd = AccessDBSQLClient.GetDbCommand(sql);\n\n        IDataReader dbReader;\n        dbReader = dbCmd.ExecuteReader();\n\n        Customer c;\n\n        while (dbReader.Read())\n        {\n            c = new Customer(Convert.ToInt32(dbReader[\"cId\"].ToString()), dbReader[\"cName\"].ToString());\n            returnList.Add(c);\n        }\n        AccessDBSQLClient.Close();\n        return returnList;\n\n    }\n\n    public static List&lt;Subscription&gt; GetCustomerSubscriptions(int cId)\n    {\n        List&lt;Subscription&gt; returnList = new List&lt;Subscription&gt;();\n        string sql = \"select S.sId, ST.stName,CM.cmDescription \"\n                   + \"from Customer C, Subscription S, SubscriptionType ST, CarModel CM \"\n                   + \"where C.cId = S.cId \"\n                   + \"and S.stId = ST.stId \"\n                   + \"and S.cmId = CM.cmId \"\n                   + \"and C.cId = \" + cId;\n        dbCmd = AccessDBSQLClient.GetDbCommand(sql);\n\n        IDataReader dbReader;\n        dbReader = dbCmd.ExecuteReader();\n\n        Subscription s;\n\n        while (dbReader.Read())\n        {\n            //s = new Subscription();\n            s = new Subscription((int)(dbReader[\"sId\"]).ToString(),\n                    dbReader[\"stName\"],\n                    dbReader[\"cmDescription\"]);\n            returnList.Add(s);\n        }\n        AccessDBSQLClient.Close();\n        return returnList;\n\n    }\n</code></pre>\n\n<p>Obviously the GetCustomers and GetCustomersByEmail methods are working, but I have no idea how to make the GetCustomerSubscriptions method, as it has to return data fra 2 classes, and I cant just build a Customer to add to the resultset. </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13245044,"title":"corelated query","body":"<p>I have a table where I have some records as follows <br/></p>\n\n<pre><code>Model            Make            Color\n==================================================\nMaruti 800       2008            Black\nMaruti 800       2009            White\nMaruti Esteem    2000            Yelow\nMaruti Esteem    2010            Red\n</code></pre>\n\n<p>Now I want the Model, Make and Color which has maximum make in the list.<br/>\nI have tried writing query like this<br/></p>\n\n<pre><code>SELECT \n     Model,\n     MAX(Model),\n     Color\nfrom \n     tableName\nGROUP BY \n     Model,\n     Color\n</code></pre>\n\n<p>But the result are not coming which I would like<br/>\nIt should be like</p>\n\n<pre><code>Model            Make            Color\n===================================================\nMaruti 800       2009            White    \nMaruti Esteem    2010            Red\n</code></pre>\n\n<p>But the result is the whole table.</p>\n\n<p>I need only those record which has max Make Model Wise.<br/>\nI have also tried inner Query (co-related query) But in that also it is asking for group by.</p>\n"},{"tags":["sql","table","loops","plsql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3433,"score":0,"question_id":5326698,"title":"Loop through multiple tables to execute same query","body":"<p>I have a database wherein per day a table is created to log process instances.\nThe tables are labeled MESSAGE_LOG_YYYYMMDD</p>\n\n<p>Currently i want to sequentially execute the same QUERY against all those tables.\nI wrote the PL/SQL below, but got stuck at line 10. How can i execute the SQL statement against successfully against all tables here ? </p>\n\n<pre><code>DECLARE\n  CURSOR all_tables IS\n    SELECT table_name\n            FROM all_tables \n            WHERE TABLE_NAME like 'MESSAGE_LOG_2%' \n            ORDER BY TABLE_NAME ;\n\nBEGIN\n  FOR msglog IN all_tables LOOP\n    SELECT count(*) FROM TABLE msglog.TABLE_NAME ;\n  END LOOP;\nEND;\n/\n</code></pre>\n\n<p>Cheers,</p>\n\n<p>Peter</p>\n"},{"tags":["sql","sql-server","performance","nested-sets","hierarchyid"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":114,"score":4,"question_id":12568201,"title":"SQL Server Nested set vs Hierarchyid performance","body":"<p>I have a hierarchical data. The most common queries will be \"get parent branch for node\" and \"get subtree of node\". Updates and inserts are not likely to occur often. I am choosing between nested sets and hierarchyid. As far as I am concerned, search on nested set should be pretty fast on indexed columns, however, I have no clue about internal implementation of hierarchyid. What should I use in order to achieve highest performance possible?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13244889,"title":"SQL Oracle How to Alter Constraint","body":"<p>SQL How to Alter Constraint</p>\n\n<p>Below is 1 of my constraint</p>\n\n<pre><code>CONSTRAINT ACTIVEPROG_FKEY1 FOREIGN KEY(ActiveProgCode) REFERENCES PROGRAM(ActiveProgCode),\n</code></pre>\n\n<p>I want to add in </p>\n\n<pre><code>ON DELETE CASCADE\n</code></pre>\n\n<p>to the constraint above. </p>\n\n<p>How do i alter that existing constraint ACTIVEPROG_FKEY1 and add  </p>\n\n<pre><code>ON DELETE CASCADE\n</code></pre>\n\n<p>to constraint ACTIVEPROG_FKEY1</p>\n\n<p>Consider ACTIVEPROG_FKEY1 is at Table ACTIVEPROG</p>\n"},{"tags":["java","sql","mysql","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1178,"score":1,"question_id":2854774,"title":"sql jdbc getgeneratedkeys returns column \"id\" not found, column type unknown","body":"<p>I want to retrieve the most recently updated value in the table using an insert query.</p>\n\n<p>these are the datatypes in my sql table.</p>\n\n<pre><code>int(11) // primary key auto increment, not being assigned by sqlQuery\n\nvarchar(30)\n\ntimestamp  // has a default value. but i am explicit assigning it using CURRENT_TIMESTAMP\n\nvarchar(300)\n\nvarchar(300)\n\nvarchar(300)\n\nint(11)\n\nvarchar(300)\n\n\n        // java code\n        statement.executeUpdate(sqlQuery, Statement.RETURN_GENERATED_KEYS);\n        ResultSet rs = statement.getGeneratedKeys();\n        System.out.println(\"here: \" + rs.getMetaData().getColumnCount());\n        System.out.println(\"here1: \" + rs.getMetaData().getColumnName(1));\n        // none of the following 3 works\n        System.out.println(\"id: \" + rs.getInt(1));\n        System.out.println(\"id: \" + rs.getInt(\"GENERATED_KEY\"));\n        System.out.println(\"id: \" + rs.getInt(\"id\"));\n</code></pre>\n\n<p>for a bit of background see <a href=\"http://stackoverflow.com/questions/2853066/sql-java-get-value-assigned-to-auto-increment-primary-key\">this</a></p>\n\n<p><code>rs.getMetaData().getColumnTypeName(1)</code> tells me column type <code>UNKNOWN</code></p>\n\n<p>stack trace\n        SEVERE: null\n        java.sql.SQLException\n        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1055)\n        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)\n        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:926)\n        at com.mysql.jdbc.ResultSetImpl.checkRowPos(ResultSetImpl.java:815)\n        at com.mysql.jdbc.ResultSetImpl.getStringInternal(ResultSetImpl.java:5528)\n        at com.mysql.jdbc.ResultSetImpl.getString(ResultSetImpl.java:5448)</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":20,"score":0,"question_id":13246339,"title":"Delete from ALL_DB_LINKS","body":"<p>i've problem here. </p>\n\n<p>i write a simple (just trying) query for creating database links.</p>\n\n<pre><code>CREATE DATABASE LINK XXX.US.ORACLE.XXX;\n</code></pre>\n\n<p>after that i wanna delete it. but it said \"ERROR at line 1:\nORA-01031: insufficient privileges\n\"</p>\n\n<p>how i can delete that data since it is a data dictionary view</p>\n"},{"tags":["sql","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":144,"score":3,"question_id":8667077,"title":"SQL Lite blank row id even after deleting the row","body":"<p>I have a SQLite DB file lets say a.db. And I have 100 rows in table a. When I give </p>\n\n<pre><code>SELECT * FROM a WHERE rowid BETWEEN 1 AND 100\n</code></pre>\n\n<p>it gives me the first 100 results. Now if I delete the first 2 rows from the table and run the </p>\n\n<pre><code>SELECT * FROM a WHERE rowid BETWEEN 1 AND 100 \n</code></pre>\n\n<p>it gives me only 98 rows. And when I give the query</p>\n\n<pre><code>SELECT * FROM a WHERE rowid = 1 \n</code></pre>\n\n<p>it gives me an empty row. The database doesn't seem to rearrange the rowid.</p>\n\n<p>Please help.. Is there any way to force the SQLite to rearrange the row ids ?</p>\n"},{"tags":["sql","sql-server","query","sql-server-2000"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13244832,"title":"SQL Server 2000 Query of total value and value from max date","body":"<p>I have this RoomTable with value</p>\n\n<pre><code>SID   Room   Date        APhase   BPhase   ACount  BCount\n1     One    10/28/2012  4        5         3       6\n2     One    10/29/2012  2        3        -1      -1\n3     One    10/30/2012  4        5         7      -1\n4     Two    10/28/2012  8        3         2       3\n5     Two    10/30/2012  3        5         4       6\n6     Three  10/29/2012  5        8         2      -1\n7     Three  10/30/2012  5        6        -1       4\n8     Four   10/29/2012  6        2        -1      -1\n9     Four   10/30/2012  5        8        -1      -1\n</code></pre>\n\n<p>What I want is to return the following:</p>\n\n<ol>\n<li>Total sum of APhase and BPhase of each Room.</li>\n<li>Value of ACount and BCount from max date of each Room</li>\n<li>If ACount value is -1 then use the previous date. Same as BCount.</li>\n<li>If ACount value is -1 and the previous date is -1 and so on. Then use 0. Same as BCount.</li>\n</ol>\n\n<p>I can get the query of number 1 with this query</p>\n\n<pre><code>SELECT Room, sum(APhase) as TotalAPhase, sum(BPhase) as TotalBPhase \nFROM RoomTable \nWHERE Date between '10/28/2012' and '10/30/2012'\ngroup by Room\norder by Room\n</code></pre>\n\n<p>But I'm confused on how to include the number 2-4 query.</p>\n\n<p>This is the output I want</p>\n\n<pre><code>Room  TotalAPhase  TotalBPhase  ACount   BCount\nOne   10           13           7        6\nTwo   11           8            4        6\nThree 10           13           2        4\nFour  11           10           0        0\n</code></pre>\n\n<p>Any ideas will be much appreciated. Thanks. </p>\n"},{"tags":["sql","firebird"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13243026,"title":"Firebird 1.5 : How to get the logarithm of a number","body":"<p>We are using Firebird 1.5 database. we need to calculate the logarithm of a number in the query, how can we do that?</p>\n\n<p>I have tried : </p>\n\n<pre><code>LOG(3, number_field)\n</code></pre>\n\n<p>but got an error :</p>\n\n<pre><code>Error: GDS Exception. 335544569. Dynamic SQL Error\nSQL error code = -804\nFunction unknown\nLOG\nSQLState:  42000\nErrorCode: 335544569\n</code></pre>\n\n<p>thanks for the help.</p>\n"},{"tags":["sql","query","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13245424,"title":"Join in Db2 query","body":"<p>I have joined two tables using inner join. Here primary key of table <code>TPREG</code> is <code>co_id</code> and <code>pol_id</code></p>\n\n<pre><code> SELECT (SELECT etbl_desc_txt\n       FROM uding604.tedit e\n       WHERE etbl_typ_id = 'PITCD'\n       AND   co_id = 'CP'\n       AND   etbl_valu_id = p.pol_ind_typ_cd) pol_ind_typ_cd,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYT'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_TYP_CD) POL_BILL_TYP_CD,\n       POL_PAC_DRW_DY,\n       (SELECT etbl_desc_txt\n        FROM uding604.tedit e\n        WHERE etbl_typ_id = 'PAYM'\n        AND   co_id = 'CP'\n        AND   etbl_valu_id = p.POL_BILL_MODE_CD) POL_BILL_MODE_CD,\n       t.SOURCE_CD\nFROM uding604.tpol p,\n     uding604.TPREG t\nWHERE p.co_id = t.co_id\nAND   p.pol_id = t.pol_id\nAND   p.co_id = 'CP'\nAND   p.pol_id = '000000011'\nAND   t.co_id = 'CP'\nAND   t.pol_id = '000000011'\n</code></pre>\n\n<p>How to make this query more simple?</p>\n\n<p>Please guide.</p>\n"},{"tags":["sql","subquery","pivot","clause"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13245364,"title":"MS SQL Server pivot table with subquery in column clause","body":"<p>Im sure this is a simple technique although I can't find an answer so far!</p>\n\n<p>I have       </p>\n\n<pre><code>TIMESTAMP           | POINTNAME | VALUE\n2012-10-10 16:00:00   AHU01       20\n2012-10-10 16:00:00   AHU02       25\n2012-10-10 16:00:15   AHU01       26\n2012-10-10 16:00:15   AHU02       35\n</code></pre>\n\n<p>etc... ( for approx 800 POINTNAMES)  </p>\n\n<p>with many pointnames I dont want to list each one in the 'IN' clause of the pivot 'FOR'\n(as syntax given below) definition but would like to use perhaps a subquery.</p>\n\n<p>So what I would like is all the POINTNAME values as columns with A TIMESTAMP AND VALUE column, so I will get one TIMESTAMP value and many columns with each POINTNAME, there is only one value per POINTNAME PER TIMESTAMP so I don't need to aggregate anything so just choose max anyway?</p>\n\n<p>Something like:</p>\n\n<pre><code>SELECT [TIMESTAMP] FROM ( SELECT * FROM POINT_TABLE)\nPIVOT( Max[Value] FOR [POINTNAME] IN (SELECT DISTINCT [POINTNAME] FROM POINT_TABLE)\n</code></pre>\n\n<p>would produce-</p>\n\n<pre><code>   TIMESTAMP              AHU01          AHU02\n 2012-10-10 16:00:00        20             25\n 2012-10-10 16:15:00        26             35\n</code></pre>\n\n<p>I realise it is probably no this simple but hopefully you get what I'm trying to achieve?</p>\n\n<p>PIVOT SYNTAX:</p>\n\n<pre><code>SELECT &lt;non-pivoted column&gt;,\n    [first pivoted column] AS &lt;column name&gt;,\n    [second pivoted column] AS &lt;column name&gt;,\n    ...\n    [last pivoted column] AS &lt;column name&gt;\nFROM\n    (&lt;SELECT query that produces the data&gt;) \n    AS &lt;alias for the source query&gt;\nPIVOT\n(\n    &lt;aggregation function&gt;(&lt;column being aggregated&gt;)\nFOR \n[&lt;column that contains the values that will become column headers&gt;] \n    IN ( [first pivoted column], [second pivoted column],\n    ... [last pivoted column])\n) AS &lt;alias for the pivot table&gt;\n&lt;optional ORDER BY clause&gt;;\n</code></pre>\n"},{"tags":["sql","join","oledb"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13245727,"title":"Sql query with complex joins","body":"<p>I am developing c# application.\nI am using OLEDB connections.</p>\n\n<p>I have following two tables>></p>\n\n<p>payment</p>\n\n<pre><code>AdmissionNumber  | StudName |\n\n       1            John\n       2            Smith\n</code></pre>\n\n<p>paymentDetails</p>\n\n<pre><code>   AdmissionNumber  | RemainingFee |    Date         | Payment\n\n        1                5000         10/10/2012         3000\n        1                3000         10/11/2012         2000\n        2                4000         15/11/2012         3000\n        1                1000         10/12/2012         2000\n</code></pre>\n\n<p>In this I want to get the table result as following>></p>\n\n<pre><code> AdmissionNumber | Name | Date           |RemainingPayment|Payment|\n       1           John    10/12/2012          1000         2000\n</code></pre>\n\n<p>In this case Admission number and date is already provided in the form via textbox and datetimepicker.</p>\n"},{"tags":["sql","sql-server","logic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13245652,"title":"Can any body explain the logic mentioned in the description?","body":"<p>The best way to get the month name when you have the month number is </p>\n\n<p>Select DateName( month , DateAdd( month , @MonthNumber , 0 ) - 1 )</p>\n"},{"tags":["sql","codeigniter","error-handling"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":22,"score":-2,"question_id":13244343,"title":"data inside table wont appear","body":"<p>i have tried to make edit option, firstly, i must make my data appear on th table but my data wont appear.</p>\n\n<pre><code>function edit($id_publisher=null){\nif (!empty($_POST['submit'])){\n\n         $id_label=$_POST['id_label'];\n         $artis=$_POST['artis'];\n         $publisher=$_POST['publisher'];\n\n         $a = array('id_label'=&gt;$id_label,'artis'=&gt;$artis,'publisher'=&gt;$publisher);\n         $this-&gt;db-&gt;where('id_publisher',$id_publisher);\n         $this-&gt;db-&gt;update('t_publisher',$a);\n         redirect(\"mapping/mapp\");\n        }else{\n         $data['data'] = $this-&gt;db-&gt;query(\"SELECT b.id_publisher, a.label,  b.artis, b.publisher from t_label a, t_publisher b where a.id_label=b.id_label\")-&gt;row();\n         $this-&gt;load-&gt;view('edit',$data);\n          }\n\n        }\n</code></pre>\n\n<p>whats wrong with my code?\nhelp, please :)</p>\n\n<p>this is the views' code</p>\n\n<pre><code>&lt;form action=\"&lt;?php echo base_url().\"mapping/edit/\".$data-&gt;ID_PUBLISHER;?&gt;\" method=\"POST\"&gt;\n    &lt;table border=\"2\" align=\"center\"&gt;\n        &lt;tr&gt;\n            &lt;td&gt;LABEL&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"label\" value=\"&lt;?php echo $data-&gt;LABEL; ?&gt;\"/&gt;&lt;td&gt;&lt;/tr&gt;\n            &lt;td&gt;ARTIS&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"artis\" value=\"&lt;?php echo $data-&gt;ARTIS; ?&gt;\"/&gt;&lt;td&gt;&lt;/tr&gt;\n            &lt;td&gt;PUBLISHER&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"publisher\" value=\"&lt;?php echo $data-&gt;PUBLISHER; ?&gt;\"/&gt;&lt;td&gt;&lt;/tr&gt;\n            &lt;td colspan=\"2\" align=\"center\"&gt;&lt;input type=\"submit\" name=\"submit\" value=\"Edit\" /&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n</code></pre>\n"},{"tags":["sql","sql-server-2008","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13245451,"title":"Execute the value of a varchar returned from a \"OUTPUT DELETED.[ColumnName]\" statement","body":"<p>I am trying to use a table as a <a href=\"http://rusanu.com/2010/03/26/using-tables-as-queues/\" rel=\"nofollow\">heap queue</a>. However I am having a little trouble figuring out how to take the text that is generated in the dequeue function and perform a execute on it.</p>\n\n<p>Here is the table storing the queue and the dequeue method.</p>\n\n<pre><code>CREATE TABLE [dbo].[Merge_Queued_Work](Sql_Text varchar(2000) NOT NULL)\nGO\n\ncreate procedure usp_dequeueWork\nas\n  set nocount on;\n  delete top(1) from [Merge_Queued_Work] with (rowlock, readpast)\n      output deleted.[Sql_Text];      \ngo\n</code></pre>\n\n<p>How do I get the varchar from <code>deleted.[Sql_Text]</code> to a <code>execute</code> statement?</p>\n"},{"tags":["sql","sql-server","query","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13241518,"title":"sql query including month columns?","body":"<p>I was wondering if I could get some ideas or direction on a sql query that would output column months. Here is my current query..</p>\n\n<pre><code>select A.assetid, A.Acquisition_Cost, B.modepreciaterate from FA00100 A\ninner join FA00200 B on A.assetindex = B.assetindex\nwhere MoDepreciateRate != '0'\n</code></pre>\n\n<p>I would like to add more columns that look as such:</p>\n\n<pre><code>select assetid, acquisition_cost, perdeprrate, Dec_2012, Jan_2013, Feb_2013....\n\nwhere Dec_2012 = (acquisition_cost - MoDepreciateRate*(# of months))\nand Jan_2013 = (acquisition_cost - MoDepreciateRate*(# of months))\n</code></pre>\n\n<p>where # of months can be changed.</p>\n\n<p>Any help would be really appreciated. Thank you!</p>\n\n<p>Here is an example of what I would like the output to be with '# of months' = 4</p>\n\n<pre><code>assetid SHRTNAME    Acquisition_Cost    perdeprrate Dec_2012    Jan_2013    Feb_2013    Mar_2013\nCS-013  GEH INTEG   17490.14            485.83      17004.31    16518.48    16032.65    15546.82\nCS-014  WEB BRD     14560               404.4507    14155.5493  13751.0986  13346.6479  12942.1972\n</code></pre>\n"},{"tags":["java","sql","prepared-statement","sqlexception"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13041817,"title":"java.sql.SQLSyntaxErrorException: Syntax error: Encountered \"(\" at line","body":"<p>I'm executing the following:</p>\n\n<pre><code>private void createTable() {\n    try {       \n        PreparedStatement psCreateTable = con.prepareStatement(\"CREATE TABLE     COMPANIES(\" +\n                \"name VARCHAR(50), \" +\n                \"location VARCHAR(50), \" +\n                \"address VARCHAR(50), \" +\n                \"website VARCHAR(50), \" +\n                \"pit VARCHAR(50), \" +\n                \"asset_class VARCHAR(50), \" +\n                \"telephone INTEGER, \" +\n                \"shares INTEGER, \" +\n                \"value DOUBLE(,2) UNSIGNED)\");\n        psCreateTable.execute();\n    } catch (SQLException e) {\n        System.out.println(\"already exists\");\n        e.printStackTrace();\n        ; //bestaat al\n    }\n}\n</code></pre>\n\n<p>And I get the following error: \n    java.sql.SQLSyntaxErrorException: Syntax error: Encountered \"(\" at line 1, column 195.</p>\n\n<p>Not really sure what to do now, as the SQL query seems valid to me and rechecked it. </p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":56,"score":-1,"question_id":13243047,"title":"Converting row to columns in SQL Server","body":"<p>I have a query that returns the following result set:</p>\n\n<pre><code>patName  SName   DISC    SCHEDULE   \nJM       AA      HA      2 per  Week\nJM       MAC     MSW     1 per  Month\nJM       ANG     RN      1 per  Week\nJM       JON     RN      1 per  Week\nJM       LRH     RN      1 per  Week\n</code></pre>\n\n<p>Is there any way I could display the result as follows using <code>PIVOT</code></p>\n\n<pre><code>PATNAME    HA           MSW             RN \n  JM    AA 2/Week   MAC 1/Month    ANG 1/week \n                                   JON 1/Week \n                                   LRH 1/Week\n</code></pre>\n\n<p>Edit, my query is as follows:</p>\n\n<pre><code>SELECT PatientName, [RN], [HA], [LVN], [MSW], [SC] \n  FROM \n  ( \n   SELECT DISTINCT (tblPatient.FirstName +' '+ tblPatient.LastName) As PatientName,\n   (tblStaff.StaffFirstName+' '+tblStaff.StaffLastName) As StaffName, \n    (tblStaffDiscipline.Discipline)As Discipline, \n    CAST(tblFrequencyOfVisit.NoOfVisit As Varchar)+' per '\n     + REPLACE (tblFrequencyOfVisit.Period,'/','') AS Visits new_value,\n   row_number() over(partition by PatientName, Discipline order by Discipline) rowNum\n   FROM tblPatient INNER JOIN\n   tblFrequencyOfVisit \n   ON tblPatient.PatientId = tblFrequencyOfVisit.PatientId \n   INNER JOIN tblStaffAssignment \n   ON tblPatient.PatientId = tblStaffAssignment.PatientId \n   AND tblFrequencyOfVisit.PatientId = tblStaffAssignment.PatientId \n   INNER JOIN tblStaffDiscipline \n   ON tblFrequencyOfVisit.DisciplineId = tblStaffDiscipline.DisciplineId \n   INNER JOIN tblStaff \n   ON tblStaffAssignment.StaffId = tblStaff.StaffId \n   AND tblStaffDiscipline.Discipline = tblStaff.StaffDisciplane \n )src  \n pivot\n (\n  max(new_value)\n  for Discipline in ([RN], [HA], [LVN], [MSW], [SC])\n) piv\n\n  WHERE\n  tblpatient.PatientId = '138' \n  AND NOT tblPatient.SOC IS NULL \n  AND tblPatient.EOC IS NULL \n  AND tblPatient.Hospiceid = '1' \n  AND tblFrequencyofVisit.FromDate = \n   (Select MAX(FROMDATE) \n   From tblfrequencyofVisit \n   Where tblFrequencyOfVisit.PatientId = tblPatient.PatientId \n   AND tblFrequencyofVisit.Disciplineid = tblStaffDiscipline.Disciplineid )\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13245112,"title":"Oracle SQL Set Foreign Key Check OFF","body":"<p>Oracle SQL Set Foreign Key Check OFF</p>\n\n<p>I tried to use this..</p>\n\n<pre><code>SQL&gt; SET FOREIGN_KEY_CHECKS = 0;\nSP2-0735: unknown SET option beginning \"FOREIGN_KE...\"\n</code></pre>\n\n<p>But it say unknown set option</p>\n\n<p>I am using oracle sql 11g express e</p>\n\n<p>I also tried</p>\n\n<pre><code>begin\nfor i in (select constraint_name, table_name from user_constraints where constraint_type ='R'\nand status = 'ENABLED') LOOP\nexecute immediate 'alter table '||i.table_name||' disable constraint '||i.constraint_name||'';\nend loop;\nend;\n</code></pre>\n\n<p>But the console stuck at line 7, not executing or something..</p>\n\n<p>Heres what happen..</p>\n\n<p>Connected.</p>\n\n<pre><code>SQL&gt; begin\n  2  for i in (select constraint_name, table_name from user_constraints where co\nnstraint_type ='R'\n  3  and status = 'ENABLED') LOOP\n  4  execute immediate 'alter table '||i.table_name||' disable constraint '||i.c\nonstraint_name||'';\n  5  end loop;\n  6  end;\n  7\n</code></pre>\n\n<p>It show the 7 then no longer work</p>\n\n<p><strong>Thanks for all help !!</strong></p>\n"},{"tags":["sql","oracle","create-table"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":131,"score":0,"question_id":11863244,"title":"missing right parenthesis in create table","body":"<p>I searched the forum but didn't find the right answer sorry if I double post\nI want to create this Table</p>\n\n<pre><code>create table HUB_SHIFT_REPORT\n(\n  Da_te timestamp(8) not null\n, Week_Day varchar2(10) not null constraint cnstrnt_day check (Week_Day in('Su','Mo','Tu','We','Th','Fr','Sa'))\n, Shift varchar2(10) not null constraint cnstrnt_shift check (Shift in('Morning','Evening','Night'))\n, Handled_by varchar2(60) not null constraint cnstrnt_handled check (Handled_by in('Artyom','Natan','Asaph','Yaniv','Fadi','AdiG','AdiF','Paul','Benjamin','Matan','Yosef'))\n, Incident_Number number(10) not null PRIMARY KEY\n, Centreon_Duration varchar2(10) not null\n, Time_received varchar2(10) not null\n, Time_restored varchar2(10) not null\n, Time_closed varchar2(10) not null\n, Product varchar2(60) not null constraint cnstrnt_product check (Product in ('Primo','MetaLib','SFX','bX','Primo Central','USTAT','Alma','Aleph','voayger','Marcit','ARC','Verde','Rosetta','Digitool','MetaLib+','NUUL','Not product related'))\n, Service_name varchar2(400) not null\n, Data_Center varchar2(10) constraint cnstrnt_dc check (Data_Center in ('DC01','DC02','DC03','DC04','DC05','Amazon','NULL'))\n, HOST VARCHAR2(40) \n, GUEST VARCHAR2(40) \n, Alert_Name varchar2(400) not null\n, Alert_Status varchar2(40) cnstrnt_status check (Alert_Status in ('CRITICAL','WARNING','UNKNOWN','DOWN','NULL'))\n, Affected_Customers varchar2(400) not null\n, Is_Escalated varchar2(10) default ('No') cnstrnt_yes check (Is_Escalated in('Yes','No'))\n, Escalated_at varchar2(10) default ('NULL') \n, Escalated_to varchar2(100) default ('NULL')\n, Open_Action_items varchar2(400) default ('NULL')\n, Time_Resolved varchar2(10) default ('NULL')\n, Related_alerts varchar2(50) default ('NULL')\n, Related_critical_alert_host varchar2(100) default ('NULL')\n, Is_Reported varchar2(10) default ('No') cnstrnt_yes check (Is_Reported in('Yes','No'))\n, Alert_Accuracy varchar2(10) default ('Real alert') not null cnstrnt_alert check (Alert_Accuracy in ('Real alert','False Positive'))\n, SI_number varchar2(10) default ('NULL')\n, Customer_Type varchar2(15) default ('Direct') not null cnstrnt_type check (Customer_Type in ('Total Care','Direct','SaaS','Local'))\n, Resolved varchar2(20) default ('No') cnstrnt_yes2 check (Resloved in('Yes','No','Cleared Itself'))\n, in_ERD varchar2(10) default ('Yes') cnstrnt_yes check (In_ERD in('Yes','No'))\n, In_XLS varchar2(10) default ('Yes') cnstrnt_yes check (In_XLS in('Yes','No')) \n, Actions_Taken varchar2(10) default ('No') cnstrnt_yes check (Actions_Taken in('Yes','No'))\n, Notes varchar2(800)\n, Root_cause varchar2(200) not null\n, Can_be_prevented varchar2(10) default ('No') cnstrnt_yes check (Can_be_prevented in('Yes','No'))\n, log varchar2(1800)\n)\n</code></pre>\n\n<p>But I get </p>\n\n<blockquote>\n  <p>Error at Command Line:14 Column:27 Error report: SQL Error: ORA-00907:\n  missing right parenthesis\n  00907. 00000 -  \"missing right parenthesis\"\n  *Cause:<br>\n  *Action:</p>\n</blockquote>\n\n<p>I count the right and left paranthesis and get 83 in both cases\nAny Idea?\nThanks</p>\n"},{"tags":["mysql","sql","tsql","group"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":50,"score":3,"question_id":13238464,"title":"Group data based on certain value","body":"<p>I have a table called x, the table has id column and repeat status column. The id can store same values even 6 of them while the repeat status increments each time an id is inserted 1,2...n. If a new different id is inserted the repeat status starts from 1 e.g</p>\n\n<pre><code> xid       repeat_status\nxx123           1\nxx123           1\nxx123           2\nxx123           3\nxx123           3 \nxxx45           1\nxxx45           2\nxxx45           2\n</code></pre>\n\n<p>How can i modify the query below to return something like this:</p>\n\n<pre><code> xid           repeat_status\nxx123             1\nxx123             2\nxx123             3\n\nxxx45             1\nxxx45             2\n\nSELECT xid\n      ,repeat_status \nFROM x \nGROUP BY repeat_status;\n</code></pre>\n"},{"tags":["sql","sql-server-2008-r2","query-optimization"],"answer_count":0,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":43,"score":6,"question_id":13243809,"title":"Performance Tuning for Huge Table (SQL Server 2008 R2)","body":"<p><strong>Background:</strong><br>\nI have a fact table in UAT Phase. Objective to load 5 yrs of data in Prod (expected size 400 Mn records). Currently it has only 2 years of data in Test. </p>\n\n<p><strong>Table Features:</strong></p>\n\n<ol>\n<li>No of Dimensions ~ 45 </li>\n<li>Measures ~ 30</li>\n<li>Non-additive measures and other columns~ 25</li>\n<li>Current data size ~ 200 Million (2 years data)</li>\n<li>Time View: 3 different Month views: Fiscal/Calendar/Adjusted (i.e same row can fall in different months based on which view one is looking for)</li>\n<li>Only One view will be required at a time by a user. (ie. only one Month Column will be used in the query, it's stopping us to do partitioning on time view)</li>\n<li>Indexes: 1 Clustered Index on the Natural Keys (8 columns).Created 3 covering Non Clustered Indexes one on the each Month column including few Dimension SKs (FKs) and all the measures).</li>\n<li>Indexes are huge(total 190 GB) because of this. </li>\n<li>Space is not constraint (1 TB allocated)</li>\n<li>64 GB of RAM available in server.</li>\n<li>Table compression also done.</li>\n</ol>\n\n<p><strong>Requirement:</strong><br>\nQueries on this Fact table should give result within 30 seconds (General queries select sum(measure) joining few Dims group by Dim Values). Reports are directly done on top of this Fact table.</p>\n\n<p><strong>Issue:</strong><br>\nAny query which includes columns available in the Index works fine, but if we include any other columns which are not in the include..It sucks. It takes more than 5-10 minutes. Can any one suggest some solution where it works fine for any dimension/column we select. Can Index view help in this situation?</p>\n"},{"tags":["c#",".net","sql","datatable"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12947872,"title":"Quickest way to create DataTable from query?","body":"<p>What is the code with the smallest number of lines that will generate a <code>DataTable</code> from this SQL query?</p>\n\n<pre><code>SELECT * \nFROM [Table1] \nWHERE ([Date] BETWEEN @Date1 AND @Date2) AND \n      ([Field1] IS NULL OR [Field2] IS NULL)\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13244288,"title":"ERROR calling out CURDATE()","body":"<p>Why is there an error when i called out the CURDATE?</p>\n\n<pre><code>UPDATE TABLENAME\n    SET DATEATR= (TO_DATE(CURDATE() ,'DD-MM-YYYY') - WORKDATE /365 );\n</code></pre>\n"},{"tags":["mysql","sql","database","query"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13243626,"title":"Efficient Query, Table Bridge/Indexing and strucuture","body":"<p>In my PhpMyAdmin database I have 9 tables. 8 of those tables are relevant to me at this moment. I would like my queries to be executed quickly enough but I am not sure the design/structure of the tables are the most effecient. Any suggestion of merging a table with another or creating another bridge table?  Also, I am struggling in building a query that will display bridge results from the following tables: <code>semester</code>, <code>schedule</code>, <code>office_hours</code>, <code>faculty</code>, <code>section</code>, <code>major_minor</code>, <code>major_class_br</code>, <code>class</code>?</p>\n\n<p><a href=\"http://webprolearner2346.zxq.net/class_des/\" rel=\"nofollow\">TABLE STRUCTURE</a></p>\n\n<p>Basic Query- that shows class details</p>\n\n<pre><code>SELECT  class_name, class_caption, class_credit_hours, class_description\nFROM class  \n</code></pre>\n"},{"tags":["sql","asp.net-mvc","json"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13243673,"title":"How to you implement the Like operator in ASP.NET MVC?","body":"<p>I'm still working on my autocomplete textbox using data from the databse (SQL) and I think I'm not getting any result for the textbox because there's something wrong or missing on my select statement here's how my current code looks like. This is my json code for the view:</p>\n\n<pre><code>       $(function () {\n        $(\"#autoCompleteText\").autocomplete({\n            source: function (request, response) {\n                var autoSearch = { searchText: $(\"#autoCompleteText\").val() };\n                $.ajax({\n                    type: \"POST\",\n                    traditional: true,\n                    url: \"/Products/jsonAutoComplete\",\n                    data: autoSearch,\n                    dataType: \"json\",\n                    success: function (data) {\n                        response(data.d);\n                    },\n                    error: function (result) {\n                        alert(\"Error\");\n                    }\n                });\n            },\n            delay: 0,\n            minLength: 2\n        });\n    });\n</code></pre>\n\n<p>I'm very sure that it works because whenever I run a breakpoint on my controller, the method jsonAutoComplete runs but the productName which is what I want to appear on the autcomplete, is always null. Here's my code with the select statement:</p>\n\n<pre><code>    public JsonResult jsonAutoComplete(string searchText)\n    {\n        JsonResult data= new JsonResult();\n        IList&lt;Products&gt; products = null; products = (from c in db.Products where c.CompanyId.Equals(companyId) &amp;&amp; (c.ProductName.Contains(\"'%\" + searchText + \"%'\")) select c).ToList();\nProducts prod = new Products();\n        int productId = prod.Id;\n        string productName = prod.ProductName;\n        data.Data = new { productId = productId, productName = productName };\n        return data;\n    }`\n</code></pre>\n"},{"tags":["sql","oracle","yii"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13244057,"title":"how to get the second batch and 3rd batch in the same query result in oracle sql + yii framework?","body":"<p>let' say i have 20 results in the sql query. if am gonna use the limit in the yii active record, I'll obviously get the first four from the result, but what if i wanna get the 2nd four and then 3rd four in the same query result ? how to query that via sql ?</p>\n\n<p>e.g </p>\n\n<pre><code>        $criteria2 = new CDbCriteria();\n        $criteria2-&gt;select = 'USERID, ADID ,ADTYPE, ADTITLE, ADDESC, PAGEVIEW, DISPPUBLISHDATE';\n        $criteria2-&gt;addCondition(\"STATUS = 1\");\n        $criteria2-&gt;order = '\"t\".PAGEVIEW DESC,\"t\".PUBLISHDATE DESC';\n        $criteria2-&gt;limit = 4;\n        $criteria2-&gt;with = array('subcat','adimages');\n        $result = $this-&gt;findAll($criteria2);\n        return $result;\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13244172,"title":"SQL Check Constraint cannot reference other column","body":"<p>I trying to add this sql check in</p>\n\n<pre><code>ALTER TABLE School\nadd Role check_role\n  CHECK (check_role IN ('Teaching Assistant', 'Lecturer', 'Professor'));\n</code></pre>\n\n<p>I get the error below</p>\n\n<pre><code>ERROR at line 3:\nORA-02438: Column check constraint cannot reference other columns\n\nSQL&gt; desc School;\n Name                                      Null?    Type\n ----------------------------------------- -------- ----------------------------\n\n STAFFNUM                                  NOT NULL VARCHAR2(12)\n NAME                                      NOT NULL VARCHAR2(50)\n ADDRESS                                   NOT NULL VARCHAR2(300)\n DOB                                                DATE\n</code></pre>\n\n<p>I am trying add a column call Role, with the check constraint check_role</p>\n\n<p>I am using Oracle SQL.</p>\n\n<p><strong>Thanks for all help!</strong></p>\n"},{"tags":["c#","sql","datagridview","tableadapter","dataadapter"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2479,"score":1,"question_id":9770561,"title":"Updating MS Access Database from Datagridview","body":"<p>I am trying to update an ms access database from a datagridview.</p>\n\n<p>The datagridview is populated on a button click and the database is updated when any cell is modified.</p>\n\n<p>The code example I have been using populates on form load and uses the cellendedit event.</p>\n\n<pre><code>private OleDbConnection connection = null;\nprivate OleDbDataAdapter dataadapter = null;\nprivate DataSet ds = null;\nprivate void Form2_Load(object sender, EventArgs e)\n{\n\n    string connetionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='C:\\\\Users\\\\Peter\\\\Documents\\\\Visual Studio 2010\\\\Projects\\\\StockIT\\\\StockIT\\\\bin\\\\Debug\\\\StockManagement.accdb';Persist Security Info=True;Jet OLEDB:Database Password=\";\n    string sql = \"SELECT * FROM StockCount\";\n    connection = new OleDbConnection(connetionString);\n    dataadapter = new OleDbDataAdapter(sql, connection);\n    ds = new DataSet();\n    connection.Open();\n    dataadapter.Fill(ds, \"Stock\");\n    connection.Close();\n\n    dataGridView1.DataSource = ds;\n    dataGridView1.DataMember = \"Stock\";\n\n}\nprivate void addUpadateButton_Click(object sender, EventArgs e)\n{\n\n}\n\nprivate void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)\n{\n    try\n    {\n        dataadapter.Update(ds,\"Stock\");\n    }\n    catch (Exception exceptionObj)\n    {\n        MessageBox.Show(exceptionObj.Message.ToString());\n    }\n}\n</code></pre>\n\n<p>The error I receive is </p>\n\n<blockquote>\n  <p>Update requires a valid UpdateCommand when passed DataRow collection\n  with modified rows.</p>\n</blockquote>\n\n<p>I'm not sure where this command needs to go and how to reference the cell to update the value in the database.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13244489,"title":"INSERT INTO Table from multiple tables","body":"<p>Hey so I have a Junction table linking two unrelated tables. Both the tables have ID's. I need to select the ID from each table using WHERE with different values, for example this is how I see it.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO c (aID, bID)\nVALUES (SELECT a.ID WHERE a.Name=\"Me\", SELECT b.ID WHERE b.Class=\"Math\");\n</code></pre>\n\n<p>All the examples I've seen use a join statement but the two tables have a common value, in this case they don't. </p>\n"},{"tags":["sql","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13244173,"title":"RE : setting value to age but getting errors with null on other keys","body":"<p>I am working on a script (setage) which automatically sets the age from dob date in my table.</p>\n\n<p>this is my table (mytable) desc :</p>\n\n<pre><code>ID, NOT NULL, varchar(20)\nDOB, DATE\nAGE, int\n\n\ninsert into MYTABLE(AGE)\nSELECT TRUNC(MONTHS_BETWEEN(SYSDATE,DOB)/12)\nFROM MYTABLE;\n</code></pre>\n\n<p>But I am receiving an  error of</p>\n\n<pre><code>cannot insert NULL into (\"my-PC\".\"MYTABLE\".\"ID\")\n</code></pre>\n\n<p>I am sure that I several records inside my table with ID and DOB inputs, but not my age.\nBut why is the system saying I could not inside due to my ID field ?</p>\n"},{"tags":["mysql","sql","subquery"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13244144,"title":"Delete from table where key not found in other table?","body":"<p>Table 1: </p>\n\n<ul>\n<li>id </li>\n<li>name</li>\n</ul>\n\n<p>Table 2: </p>\n\n<ul>\n<li>id</li>\n<li>other_table_id </li>\n<li>table_1_id </li>\n<li>..</li>\n</ul>\n\n<p>Basically what I want to do is</p>\n\n<pre><code>Delete from table_1 \nwhere id not in (select table_1_id \n                 from table_2 \n                 group by table_1_id);\n</code></pre>\n\n<p>Which should work, what I am wondering is if the sub query is the best way to do this/ is there any other way?</p>\n"},{"tags":["c#","sql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13244052,"title":"Linq query using only year part of datetime","body":"<p>One of the column in my sqlserver table is datetime. In the where clause I have query just by the year (not month and date). I have to do it in LINQ using C#. Please let me know how could do it.</p>\n\n<p>For example if the following are the values in the table</p>\n\n<p>02/12/2010\n07/14/2011\n11/15/2012</p>\n\n<p>and if I query by '2011', only the middle row should be fetched.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","database"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13242427,"title":"How to structure my Users Database?","body":"<p>I have a website that allows users to be different types. Each of these types can do specific things. I am asking if I should set up 1 table for ALL my users and store the types in an enum, or should I make different tables for each type. Now, if the only thing different was the type it would be easy for me to choose only using one table. However, here's a scenario.</p>\n\n<p>The 4 users are A, B, C, D.</p>\n\n<p>User A has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n</ul>\n\n<p>User B has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n<li>phone</li>\n</ul>\n\n<p>User C has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n<li>phone</li>\n<li>about</li>\n</ul>\n\n<p>User D has data for:</p>\n\n<ul>\n<li>name</li>\n<li>email</li>\n<li>phone</li>\n<li>about</li>\n<li>address</li>\n</ul>\n\n<p>If I were to create a single table, should I just leave different fields null for the different users? Or should I create a whole separate table for each user?</p>\n"},{"tags":["mysql","sql","select","uppercase"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13243594,"title":"sql : select uppercase columns in database","body":"<p>I need to select columns that end in an uppercase extension.</p>\n\n<p>for example, look at the following table.</p>\n\n<pre><code>id - picture\n1 - abc.JPG\n2 - def.jpg\n3 - 123.jpg\n4 - xyz.JPG\n</code></pre>\n\n<p>the results should give me the rows 1 and 4 because JPG are in uppercase.</p>\n\n<p>can anyone help?</p>\n"},{"tags":["sql","mysql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4055,"score":1,"question_id":4714239,"title":"How to delete last record(on condition) from a table in MySql","body":"<p>I have a <strong>LoginTime</strong> table like this:</p>\n\n<pre><code>id | user_id | datetime\n1  |   1     | 2011-01-17 18:51:05\n2  |   1     | 2011-01-18 18:51:05  \n3  |   1     | 2011-01-19 18:51:05  \n4  |   2     | 2011-01-19 18:51:05  \n</code></pre>\n\n<p>I want to delete last record for <code>user_id=1</code>. Last record of a user can be recognized by <code>datetime</code>.</p>\n\n<p>How can I do this with one query. </p>\n"},{"tags":["sql","mysql","sql-order-by","ordering"],"answer_count":9,"favorite_count":9,"up_vote_count":24,"down_vote_count":0,"view_count":10361,"score":24,"question_id":396748,"title":"Ordering by the order of values in a SQL IN() clause","body":"<p>I am wondering if there is away (possibly a better way) to order by the order of the values in an IN() clause.</p>\n\n<p>The problem is that I have 2 queries, one that gets all of the IDs and the second that retrieves all the information. The first creates the order of the IDs which I want the second to order by. The IDs are put in an IN() clause in the correct order.</p>\n\n<p>So it'd be something like (extremely simplified):</p>\n\n<pre><code>SELECT id FROM table1 WHERE ... ORDER BY display_order, name\n\nSELECT name, description, ... WHERE id IN ([id's from first])\n</code></pre>\n\n<p>The issue is that the second query does not return the results in the same order that the IDs are put into the IN() clause.</p>\n\n<p>One solution I have found is to put all of the IDs into a temp table with an auto incrementing field which is then joined into the second query.</p>\n\n<p>Is there a better option?</p>\n\n<p><strong>Note:</strong> As the first query is run \"by the user\" and the second is run in a background process, there is no way to combine the 2 into 1 query using sub queries.</p>\n\n<p>I am using MySQL, but I'm thinking it might be useful to have it noted what options there are for other DBs as well.</p>\n"},{"tags":["sql","sql-server","database","query","sql-server-2008-r2"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":11666009,"title":"SQL server query to get this output","body":"<p>I have a query which i am unable to get the output.\nBelow is the query to be executed</p>\n\n<p>Q: 2.   Write a query to find the city Name, Id and Count that has got maximum number of vehicles associated.</p>\n\n<p>Now, Given is the one table on which the query should be executed.</p>\n\n<pre><code>Vehicle_Detail_ID   City_ID\n56                    242\n57                    242\n58                    242\n59                    243\n60                    241\n61                    242\n62                    245\n</code></pre>\n\n<p>Another table which has the city name</p>\n\n<pre><code>City_ID City_Name\n242          Bangalore\n243          ChamarajNager\n241          Bellary\n245          Chitradurga\n</code></pre>\n\n<p>EXPECTED OUTPUT: </p>\n\n<pre><code>City_ID No_Vehicles\n242          4\n</code></pre>\n\n<p>Please tell me how to write the query which fetches me the right output.</p>\n\n<p>Given below is the query which gives the city Id and its vehicle count.\nTRIED: </p>\n\n<pre><code>SELECT c.city_id, COUNT(c.City_ID) AS NO_vehicles\n  FROM city c, vehicle_details v \n WHERE c.City_ID = v.City_ID\n GROUP BY c.City_ID\n</code></pre>\n\n<p>ACTUAL OUTPUT </p>\n\n<pre><code>City_ID No_Vehicles\n242             4\n243             1\n241             1\n245             1\n</code></pre>\n\n<p>Please help me to get max of these as shown in EXPECTED OUTPUT.</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13243425,"title":"Oracle error sql","body":"<p>I have to create a table and insert values into the tables. The tables is being created but it wont insert values.\nheres my code-</p>\n\n<pre><code>CREATE TABLE CUSTOMER(\nCID         number(20) not null primary key,        \nFNAME       varchar2(50) not null,                  \nMIDDLE      varchar2(50) null,\nLNAME       varchar2(50) not null,\nSTREET      varchar2(50) not null,\nCITY        varchar2(50) not null,\nSTATE       char(2) not null,\nZIP         varchar2(5) not null,\nPHONE       varchar2(20) not null,\nBIRTH_YR    date);\n\nINSERT INTO CUSTOMER VALUES(\n'1','john','paul','connor','Broad st','newark','nj','07103','2018643110','1992');\n</code></pre>\n\n<p>I keep getting an error </p>\n\n<pre><code>[Error] Script lines: 12-14 ------------------------\nORA-01861: literal does not match format string\nScript line 14, statement line 2, column 85 \n</code></pre>\n\n<p>Can somebody help me out? What am i doing wrong?</p>\n"},{"tags":["sql","sql-server-2005","sql-server-2008","bulkinsert"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":537,"score":3,"question_id":7937581,"title":"Issue with bulk insert","body":"<p>I am trying to insert the data from this link to my SQL server \n<a href=\"https://www.ian.com/affiliatecenter/include/V2/CityCoordinatesList.zip\" rel=\"nofollow\">https://www.ian.com/affiliatecenter/include/V2/CityCoordinatesList.zip</a></p>\n\n<p>I created the table </p>\n\n<pre><code>CREATE TABLE [dbo].[tblCityCoordinatesList](\n[RegionID] [int] NOT NULL,\n[RegionName] [nvarchar](255) NULL,\n[Coordinates] [nvarchar](4000) NULL\n</code></pre>\n\n<p>) ON [PRIMARY]</p>\n\n<p>And I am running the following script to do the bulk insert</p>\n\n<pre><code>BULK INSERT tblCityCoordinatesList\nFROM 'C:\\data\\CityCoordinatesList.txt' \nWITH \n( \n    FIRSTROW = 2, \n    MAXERRORS = 0, \n    FIELDTERMINATOR = '|', \n    ROWTERMINATOR = '\\n'\n)\n</code></pre>\n\n<p>But the bulk insert fails with following error</p>\n\n<pre><code>Cannot obtain the required interface (\"IID_IColumnsInfo\") from OLE DB provider \"BULK\" for linked server \"(null)\".\n</code></pre>\n\n<p>When I google, I found several articles which says the issue may be with RowTerminator, but I tried everything like /n/r, /n etc, but nothing is working. </p>\n\n<p>Could anyone please help me to insert this data into my database?</p>\n\n<p>Thank you so much for your help.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":1038,"score":5,"question_id":3650690,"title":"SQL SERVER Foreign Keys and Indexes","body":"<p>Is it a good practice to create an index to every foreing key  in my database?</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13243488,"title":"Difference of \"FROM a LEFT JOIN b\" vs. \"FROM a, b\"","body":"<p>Do the queries do the same? What is the standard?</p>\n\n<p>Will I lose performance if I change one of these ways of write the query?</p>\n\n<p>Query 1</p>\n\n<pre><code>   SELECT a.*, b.id AS b_id\n     FROM table_a AS a\nLEFT JOIN table_b AS b\n       ON a.id = b.id\n</code></pre>\n\n<p>Query 2</p>\n\n<pre><code>   SELECT a.*, b.id AS b_id\n     FROM table_a a, table_b b\n    WHERE a.id = b.id\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13243552,"title":"I'm trying to use the MySQL NOT IN command, but to no avail, could anyone point out the error in my syntax?","body":"<pre><code>(SELECT s\nFROM enrolls\nWHERE s)\nNOT IN\n(SELECT s\nFROM likes\nWHERE s);\n</code></pre>\n\n<p>I've got two tables, <code>enrolls</code> and <code>likes</code>, and I'm trying to find s from enrolls where all of the tuples of s <code>likes</code> and <code>enrolls</code> have in common are removed (or <code>enrolls - likes</code>, basically).</p>\n\n<p>I get the following error, though:</p>\n\n<blockquote>\n  <p>You have an error in your SQL syntax; check the manual that\n  corresponds to your MySQL server version for the right syntax to use\n  near 'NOT IN (SELECT s FROM likes WHERE s)' at line 4</p>\n</blockquote>\n"},{"tags":["sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13242632,"title":"SQL Query with INI data?","body":"<p>I have a simple data table with the a column structure including: name, email, paid, and params</p>\n\n<p>The 'params' column contains custom fields filled in by a form from the user.  I have provided a sample submission value AT THE BOTTOM OF THIS QUESTION.  I i would like to display:</p>\n\n<p>custom_field_value_1_person_1</p>\n\n<p>custom_field_value_2_person_1</p>\n\n<p>custom_field_value_3_person_1</p>\n\n<p>custom_field_value_4_person_1</p>\n\n<p>Is there any way to retrieve these from such data?</p>\n\n<p>Right now my simple query reads: </p>\n\n<pre><code>SELECT\n  R.ohanah_registration_id,\n  E.title AS Event,\n  R.name,\n  R.email,\n  R.paid\nFROM\n waqcl_ohanah_registrations R LEFT JOIN waqcl_ohanah_events E\n  ON R.ohanah_event_id = E.ohanah_event_id\n</code></pre>\n\n<p>SAMPLE SUBMISSION VALUE:\nfield_name_person_1=field_name_person_2=field_name_person_3=field_name_person_4=field_name_person_5=custom_field_value_1_person_1=\\CrossFit Gold\\\"custom_field_value_1_person_2=\\\"\\\"custom_field_value_1_person_3=\\\"\\\"custom_field_value_1_person_4=\\\"\\\"custom_field_value_1_person_5=\\\"\\\"custom_field_value_2_person_1=\\\"XL\\\"custom_field_value_2_person_2=\\\"\\\"custom_field_value_2_person_3=\\\"\\\"custom_field_value_2_person_4=\\\"\\\"custom_field_value_2_person_5=\\\"\\\"custom_field_value_3_person_1=\\\"m\\\"custom_field_value_3_person_2=\\\"\\\"custom_field_value_3_person_3=\\\"\\\"custom_field_value_3_person_4=\\\"\\\"custom_field_value_3_person_5=\\\"\\\"custom_field_value_4_person_1=\\\"916-952-..  </p>\n"},{"tags":["sql","google-bigquery"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13203402,"title":"Maximum number of allowed datasets in one project","body":"<p>Is there a limit on how many datasets I can create in one BigQuery project? I did not find this limit anywhere mentioned in documentations.</p>\n\n<p>I am asking this because I want to create a dataset per day. Under the daily dataset, there will be the same number of tables being created with the daily data. E.g.,</p>\n\n<pre><code>dataset_20121101\n   - table1\n   - table2\ndataset_20121102\n   - table1\n   - table2\n...\ndataset_201XXXXX\n   - table1\n   - table2\n</code></pre>\n\n<p>Also if I want to do a query over a range of datasets, can I do something better than explicitly selecting from every single dataset? For instance,</p>\n\n<pre><code>select date, sum(price) from \n dateset_20121101.table1, \n dateset_20121102.table1,\n dateset_20121103.table1,\n dateset_20121104.table1\n group by date order by date\n</code></pre>\n\n<p>I guess not, but just try to confirm. </p>\n\n<p>Thanks. </p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13243171,"title":"select into vs insert sql statement","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6947983/insert-into-vs-select-into\">INSERT INTO vs SELECT INTO</a>  </p>\n</blockquote>\n\n\n\n<p>I have a really hard time understanding what is the difference between select into and a insert statement, I always use insert, but, for some reason, I think having a select into will maximize insertion from a table, am I right? I'm new to SQL queries, please understand me.</p>\n\n<p>Could you please give me some hint on what is there difference? Is it possible to have a statement like</p>\n\n<pre><code>select * into northwind from northwind2\n</code></pre>\n\n<p>where northwind has equal tables with northwind2? like its just a backup?\nor could there be a select like an insert like...</p>\n\n<p>(excuse me for being noobish)</p>\n\n<pre><code>select lastname+firstname+middlename as [name] into northwind from northwind2?\n</code></pre>\n\n<p>thanks!</p>\n"},{"tags":["php","sql","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13243092,"title":"UPDATE inside a WHILE statement","body":"<p>So, I have a page with a bunch of workorders on it. Each workorder is a row in a single table, and gets put on the page with a while() statement. \nI'm trying to update each row with a simple form that I put inside the while(), and an UPDATE/WHERE statement to actually add the information to the table.</p>\n\n<p>Instead of adding it to the specific row, it adds it to Every row. The only thing I can think of is that my WHERE condition is wrong, but I can't seem to figure it out. Maybe it just needs fresh eyes, or maybe I'm heading in Completely the wrong direction.</p>\n\n<p>Also, any specific instructions on security, a better way to do it, etc. would be very helpful. I'm learning PHP on the fly and could use a helping hand. :)</p>\n\n<pre><code>&lt;?php\n\n        $query = \"SELECT * FROM client_information\"; \n\n        $result = mysql_query($query) or die(mysql_error());\n\n\n        while($row = mysql_fetch_array($result)){ \n\n        $which_ad = $row['ID'];?&gt;\n\n            &lt;b&gt;Name:&lt;/b&gt; &lt;? echo $row['billing_name']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Job Type:&lt;/b&gt; &lt;? echo $row['job_type']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Size:&lt;/b&gt; &lt;? echo $row['size']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Text:&lt;/b&gt; &lt;? echo $row['text']; ?&gt; &lt;br&gt;\n            &lt;b&gt;Notes:&lt;/b&gt; &lt;? echo $notes; ?&gt; &lt;br&gt;\n\n            &lt;br&gt;&lt;br&gt;\n\n        &lt;form action=\"small_update.php\" method=\"POST\"&gt;\n        &lt;strong&gt;Email Message:&lt;/strong&gt;&lt;br&gt;\n        &lt;textarea rows=\"8\" cols=\"60\" name=\"email_message\"&gt;&lt;/textarea&gt;        \n        &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;&lt;/form&gt;\n\n\n&lt;?\n$email_message = htmlspecialchars (\"{$_POST['email_message']}\", ENT_QUOTES);\n\n\nif (mysql_errno() != 0) {\ndie(mysql_error());\n}\n\nmysql_query(\n\"UPDATE client_information\nSET email_message='$email_message'\n\nWHERE ID='$which_ad'\"\n);\n\n\nif (mysql_errno() != 0) {\ndie(mysql_error());\n}\n\n    }\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","ruby","postgresql","timezone","dst"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":60,"score":6,"question_id":13239534,"title":"Accounting for DST in Postgres, when selecting scheduled items","body":"<p>I have a <strong>Postgres</strong> table of <strong>clock alarms</strong> (not really, but this is analogous, and easier to explain). Alarms are set by users with a 1 hour resolution, and users can be from many different timezones. The alarms are repeating daily. I want to reliably fetch the alarms that are supposed to go off at a particular hour of the day, and I am <strong>having problems with daylight saving time</strong>. How do I do this in the best way?</p>\n\n<h3>Example</h3>\n\n<blockquote>\n  <p>Alfred and Lotta both live in Stockholm (+1 hour from UTC, but +2h\n  when it's DST).<br> Sharon lives in Singapore (+8 hours from UTC, no\n  DST)</p>\n  \n  <p>During winter, Alfred sets an alarm for 4 AM. The alarm should go off\n  at 4 AM local time, all year.<br> During summer, Lotta sets an alarm\n  for 5 AM. Again, it should go off at 5 AM all year round.<br>\n  Meanwhile, Sharon has set an alarm for 11 AM.</p>\n  \n  <p>All of these can be stored in the database as 03:00 UTC.</p>\n  \n  <p>If I query the database in the winter for alarms that should go off at\n  03:00 UTC, I want Alfred's and Sharon's alarms. Singapore is now +7h\n  from Sweden, so 11 AM in Singapore is 4 AM in Sweden. Lotta's alarm\n  should not go off for another hour.</p>\n  \n  <p>Conversely, if I query the database in the summer for alarms that\n  should go off at 03:00 UTC, I want Lotta's and Sharon's alarms.\n  Singapore is +6h from Sweden now, so 11 AM in Singapore is 5 AM in\n  Sweden now. Sven's alarm went off an hour ago.</p>\n</blockquote>\n\n<p><strong>How do I store this, and query the database?</strong></p>\n\n<p>I can change the db schema if necessary. At the moment, we don't adjust for DST at all, and in fact just have an \"hour\" integer field (which seems dumb, a time field would be better).</p>\n\n<p>It seems I need to store both a UTC time and timezone information, but I don't know how to best achieve this in Postgres. I've found that Postgres has some sort of concept of timezones, but no timezone field type as far as I can tell. Also, I guess I need to do some calculations in SQL to determine how to offset the UTC time in the select, based on the timezone data and the creation date. I'm not great with SQL…</p>\n\n<p>I do want to solve this in Postgres, as there can be a lot of \"alarms\", and I want to avoid the performance issues that come with fetching all of them into Ruby and filter there. (Yes, this is a Rails app.)</p>\n"},{"tags":["sql","html5","relational-database","indexeddb"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13226840,"title":"Relational IndexedDB Wrapper","body":"<p>I am planning to use IndexedDB to support offline database but having trouble in performing queries and understanding the underlying mechanics of it. Is there a indexeddb wrapper that can enable me to query against indexeddb using SQL queries? Thanks!</p>\n"},{"tags":["mysql","sql","mysql-workbench","alter-table"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":111,"score":2,"question_id":12542409,"title":"MySQL Workbench alter table","body":"<p>I create a table with mysql workbench. </p>\n\n<p>The screenshot before \"Apply\";</p>\n\n<p><img src=\"http://i.stack.imgur.com/mru4J.png\" alt=\"enter image description here\"></p>\n\n<p>It creates the table without any error.</p>\n\n<p>After \"Alter Table...\" the screenshot;</p>\n\n<p><img src=\"http://i.stack.imgur.com/zSVwD.png\" alt=\"enter image description here\"></p>\n\n<p>Is this a turkish character problem?\nHow can i fix it?</p>\n"},{"tags":["mysql","sql"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":100,"score":3,"question_id":12469270,"title":"MySQL Get Time of Old Record Insert?","body":"<p>I have a table in my database which contains all of the users for my application. Unfortunately, when I launched my application, I didn't think to include a column which tracked the time at which a particular user signed up, and now I wish I had (bad idea, yes indeed).</p>\n\n<p>Is there, by any shred of luck, a way that MySQL tracks when a particular record is inserted (such as in record metadata???), and would allow me to grab it and insert in into a new dedicated column for this purpose?</p>\n\n<p>I am running on a shared cPanel host, so I doubt I have access to the MySQL logs.</p>\n\n<p>Thank you for your time.</p>\n"},{"tags":["sql","vba","ms-access","access-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13242692,"title":"Subform \"assigned\" control not updating","body":"<p>I'm creating a MS Access 2010 database to allow users enter series of data which would be used in a query.</p>\n\n<p>I have a Main form named \"Entry\" and a bounded subform named \"SubEntry\" (used to view the entered records).\nThe main form (Entry) consists of text/combo box controls that allows users to key in values, such as:</p>\n\n<pre><code>**Controls       ControlSource**\n\nDate             \"Entered by the user\"\nCompanyID        \"Entered by the user\"\nTicketID         \"Entered by the user\"\nTicketPrice      \"Automatic retrieved by a query based on the entered 'Date' and 'TicketID' \"\nPieces           \"Entered by the user\"\nTotalPrice       \"TicketPrice * Pieces\"\nCorrectedPrice   \"Entered by the User\"\nRevenue          \"=IIf([CorrectPrice]=0,[TotalPrice],[CorrectPrice])\"\n</code></pre>\n\n<p>This works fine with entering and viewing record-sets. But the problem is, at the initial stage when the user adds recordset to the subform, the exact \"Revenue\" value is added to the subform's \"Revenue\" field. But after then, when the user scrolls in the subfrom and chooses a recordset (which appears in the main form's respective controls) and changes the values. For instance chooses another ticketID or Date, the \"Revenue\" value in the main form changes but not updated in Subform's Revenue field. Meanwhile anyother changes made main form automatically updates in the subform but not that of the \"Revenue\" value.</p>\n\n<p>I'm not that conversant with MS Access nor VBA, just wondering if there is something obvious that is missing? How to deal with the SubEntry's \"Revenue\" field to automatically updates like any other fields in the subform does. </p>\n\n<p>Thanks for your time and assistance.</p>\n"},{"tags":["sql","logic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13242001,"title":"SQL Logic issue","body":"<p>I am in quite the pickle! I am checking a table that contains information related to patient vaccines. For each patient, there are three possible vaccines stored in four rows. These vaccines have a related yes/no value that depicts whether or not the vaccine was in effect. These vaccine rows each had a 'static' de_name column that held the name of the vaccine that was potentially being administered. If the vaccine had a yes value, there is also a related row that holds a date value of when the vaccine was administered. Luckily, this second row containing dates also contained the name of the field, which could be used to deduce which vaccine was administered. Due to the row nature of this table, there was no obvious way (to me) to search through each patient other than to turn each possibility into it's own column and coalesce the results. This allowed me to create two pretty columns for both the administered vaccines and the date the vaccines were administered. This worked because I did not need to reference the rows that pertained to the yes/no value because the name of the vaccine and the fact that the date existed allowed me to use just the date field itself. </p>\n\n<p>Everything was fine and dandy until I was asked to add a fourth vaccine, which instead of holding a yes/no value, contained free-text. I was asked to place the free-text in the same column as the other vaccines 'static' text. This is an issue because unlike the rest of the vaccines, there was no column in the fourth vaccines date row that displayed the non-date row vaccine free-text entry. I had to reference the fourth row's free-text while also referencing the fourth row's related vaccine date row's date value. The issue comes in when, I have no idea how to join to rows (by a permanent visit number) within a Case statement within a coalesce statement! Any help would be wonderful!</p>\n\n<p>Please let me know if there is any other data you need me to include. I am including apprehensively some dummy data and what my query would currently display.</p>\n\n<p>Data_Points Table:</p>\n\n<pre><code> De_Num       De_Name                        De_Value     Perm_Visit_Num    PatientID\n\n 6224       Flu vaccine                        yes             10111           12\n 6225    Flu vaccine date administered       11/00/2012        10111           12\n 6226     Pneumonia vaccine                    yes             10112           12\n 6227  Pneumonia vaccine date administered   11/01/2012        10112           12\n 6228      Tetanus vaccine                     yes             10113           12\n 6229   Tetanus vaccine date administered    11/02/2012        10113           12\n 6230      Other vaccine                 arbitrary free-text   10114           12\n 6231  Other vaccine date administered       11/03/2012        10114           12\n 6224       Flu vaccine                        yes             10115           10\n 6225    Flu vaccine date administered       11/00/2012        10115           10\n 6226     Pneumonia vaccine                    yes             10116           10\n 6227  Pneumonia vaccine date administered   11/01/2012        10116           10\n 6228      Tetanus vaccine                     yes             10117           10\n 6229   Tetanus vaccine date administered    11/02/2012        10117           10\n 6230      Other vaccine              more arbitrary free-text 10118           10\n 6231  Other vaccine date administered       11/03/2012        10118           10    \n</code></pre>\n\n<p>My Query</p>\n\n<pre><code>select * \nfrom\n(select\n        COALESCE(\n            CASE\n                WHEN de_num = '6225' THEN DE_Name\n            END,\n            CASE\n                WHEN de_num = '6227' THEN DE_Name\n            END,\n            CASE\n                WHEN de_num = '6229' and perm_visit_num in (select perm_visit_num from data_points where de_num = '6228' and de_value = 'Yes') THEN de_name\n            END,\n            CASE\n                WHEN de_num = '6230' THEN DE_Value\n            END\n        ) VaccineAdministered,\n        COALESCE(\n            CASE\n                WHEN de_num = '6225' THEN CASE DE_Value WHEN null THEN null ELSE DE_Value END\n            END,\n            CASE\n                WHEN de_num = '6227' THEN CASE DE_Value WHEN null THEN null ELSE DE_Value END\n            END,\n            CASE\n                WHEN de_num = '6229' and perm_visit_num in (select perm_visit_num from data_points where de_num = '6228' and de_value = 'Yes') THEN CASE DE_Value WHEN null THEN null ELSE DE_Value END\n            END,\n            CASE\n                WHEN de_num = '6230' THEN 'foo'\n            END\n        )\nfrom data_points\nWHERE DE_Num in ('6227','6225','6229','6230')\n)\nwhere vaccineadministered != ''\n</code></pre>\n\n<p>The result set with that dummy data and the current sql query above:</p>\n\n<pre><code>Vaccine Administered                   DateAdministered\n\nFlu vaccine date administered             11/00/2012\nPneumonia vaccine date administered       11/01/2012\nTetanus vaccine date administered         11/02/2012\narbitrary free-text                          foo\nFlu vaccine date administered             11/00/2012\nPneumonia vaccine date administered       11/01/2012\nTetanus vaccine date administered         11/02/2012\nmore arbitrary free-text                     foo\n</code></pre>\n\n<p>My issue is that I cannot figure out a way to pull both the free-text AND the associated date. I can get either or, and in this query I get the free-text.</p>\n\n<p>Please understand this is a very hard thing to explain and I am really in need of help. Thanks!</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2008-r2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13242261,"title":"sql server query on condition","body":"<p>There is a table:</p>\n\n<pre><code>ID   Name   Rank\n1    X       Professor\n2    X       Principal\n3    X       Term Prof\n4    X       assistant\n</code></pre>\n\n<p>What I want is want to write the stored procedure to select the last professor rank or assistant rank depending on the input. Here is the format of the stored proc:</p>\n\n<pre><code>create procedure proc_name(@includeassistant varchar(3))\n\nend\n</code></pre>\n\n<p>if includeassistant is \"yes\" then assistant then the last row must be displayed if include assistant is no then Term prof row must be given.\n</p>\n"},{"tags":["sql","math","regression"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":309,"score":3,"question_id":9292209,"title":"Need SQL Server Query to solve 3rd Order Polynomial Regression","body":"<p>Can anyone help with some SQL query code to provide estimates of the co-efficients for a 3rd order Polynomial regression?</p>\n\n<p>Please assume that I have a table of X and Y data values and want to estimate a, b and c in:</p>\n\n<pre><code>Y(X) = aX + bX^2 + cX^3 + E \n</code></pre>\n"},{"tags":["mysql","sql","join","query-optimization","outer-join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13242293,"title":"Simplifying a query (with left outer join)","body":"<p>Our app has been using this query for a while now:</p>\n\n<pre><code>SELECT id \nFROM invoice \nWHERE id NOT IN \n(SELECT invoice_id FROM invoice_transaction) \n\n#437 rows returned\n</code></pre>\n\n<p>In a code review, this query was rewritten with a left outer join:</p>\n\n<pre><code>SELECT invoice.id \nFROM invoice \nLEFT OUTER JOIN invoice_transaction on invoice.id=invoice_transaction.invoice_id \n\n#586 rows returned\n</code></pre>\n\n<p>The first query returns 437 rows and the second (supposedly identical) query returns 586 rows.  Is this not a valid use of the left outer join?  </p>\n\n<p>What would be a better way to rewrite this query?</p>\n\n<p>Thank you!</p>\n"},{"tags":["mysql","sql","query","group-by","case"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13228875,"title":"Using CASE WHEN with GROUP BY","body":"<p>Background: I'm trying to display a table with the headings: id, full_name, position_7, position_8, position_9...etc if a person was an active employee for Jul and Aug, then 2012_Jul and 2012_Aug will be displayed in position_7 and 8 on one line. If I don't use GROUP BY I get the output but on 2 lines. The reason this is happening is because in the BLMths table a single person will have multiple entries due to being employed for more than 1 month. </p>\n\n<p>The below query will get every persons id, full_name and month successfully...if I don't use GROUP BY. But the problem is, if I neglect to use GROUP BY I will have 4 lines (or more) for each person in my table.   When I do use GROUP BY, I have the desired output of 1 line for each person, but the data I need in the table isn't all there.</p>\n\n<p>Does anyone know what I'm doing wrong?  Or does anyone know why when I use GROUP BY the data from some of my CASE statements appear to be missing?</p>\n\n<p>I know the answer to this has to be simple, but I can't seem to solve it.  Any help is appreciated.   Many thanks in advance.</p>\n\n<pre><code>SELECT Blm.Ags, Blmths.Id, Ie.Full_Name, Blmths.Month,\n       CASE month\n       WHEN \"2012-07-01\" THEN 1\n           ELSE NULL\n       END AS Position_7,\n       CASE month\n       WHEN \"2012-08-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_8,\n       CASE Blmths.Month\n       WHEN \"2012-09-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_9,\n       CASE month\n       WHEN \"2012-10-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_10,\n       CASE Blmths.Month\n       WHEN \"2012-11-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_11,\n       CASE Blmths.Month\n       WHEN \"2012-12-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_12,\n       CASE month\n       WHEN '2013-01-01' THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_1,\n       CASE month\n       WHEN \"2013-02-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_2,\n       CASE month\n       WHEN \"2012-03-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_3,\n       CASE Blmths.Month\n       WHEN \"2013-04-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_4,\n       CASE Blmths.Month\n       WHEN \"2013-05-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_5,\n       CASE Blmths.Month\n       WHEN \"2013-06-01\" THEN Date_Format(Blmths.Month, '%Y_%b')\n           ELSE NULL\n       END AS Position_6\n  FROM Bogus_Leadership_Months AS Blmths, Injection_Employees AS Ie,\nBogus_Leadership_Members AS Blm\n  WHERE Blmths.Id = Blm.Id\n    AND Ie.Ags = Blm.Ags\n    AND Ie.Centre_Id = '666'\n  GROUP BY Blm.Ags\n</code></pre>\n"},{"tags":["sql","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13202376,"title":"How to write this SQL for linking data in DB2?","body":"<p>For example, there are two columns - ID1 and ID2 which are linked to each other. It is possible that the IDs are linked with other IDs in the table.</p>\n\n<pre><code>ID1         ID2\n------------------\n001         002\n001         003\n004         005\n002         006\n005         007\n</code></pre>\n\n<p>In the above table, 001, 002, 003, 006 are linked and 004, 005, 007 are linked.</p>\n\n<p>Is it possible to query this information in SQL for DB2?</p>\n\n<p>The format is similar as the following:</p>\n\n<pre><code>Group       ID\n--------------\n1           001\n1           002\n1           003\n1           006\n2           004\n2           005\n2           007\n</code></pre>\n\n<p>On the other hand, if one more record (008, 007) is added to the table</p>\n\n<pre><code>ID1         ID2\n------------------\n001         002\n001         003\n004         005\n002         006\n005         007\n008         007  (Newly added)\n</code></pre>\n\n<p>The expected result will be:</p>\n\n<pre><code>Group       ID\n--------------\n1           001\n1           002\n1           003\n1           006\n2           004\n2           005\n2           007\n2           008\n</code></pre>\n\n<p>because 004, 005, 007, 008 are linked.</p>\n\n<p>The DB2 Version is 9.7.</p>\n"},{"tags":["sql","sql-server","xml","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13242295,"title":"Add elements and attributes to XML column based on criteria?","body":"<p>With the following, I'd like to add <code>../attrdomv/udom/'some text'</code> within each <code>attr</code> node, of which there are many. However, based on the value of <code>attrlab</code>, 'some text' will be different for each element. I hope that makes sense. I initially considered reconstructing the entire xml column, but <code>'many nodes and elements'</code> contains attributes that are specific to a row, and not easy to reproduce prorgammatically. <code>../attrdomv/udom/'some text'</code> will be the same across each row. Here is a snippet of an existing column:</p>\n\n<pre><code>&lt;metadata xml:lang=\"en\"&gt;\n&lt;many nodes and elements&gt;\n  &lt;eainfo&gt;\n    &lt;detailed Name=\"fire.DBO.labels\"&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;OBJECTID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;OBJECTID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;OID&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdef Sync=\"TRUE\"&gt;Internal feature number.&lt;/attrdef&gt;\n        &lt;attrdefs Sync=\"TRUE\"&gt;Esri&lt;/attrdefs&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Sequential unique whole numbers that are automatically generated.&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;FeatureID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;FeatureID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;ZOrder&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;ZOrder&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;SymbolID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;SymbolID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n      &lt;/attr&gt;\n    &lt;/detailed&gt;\n  &lt;/eainfo&gt;\n&lt;/metadata&gt;\n</code></pre>\n\n<p>...and here is my desired result:</p>\n\n<pre><code>&lt;metadata xml:lang=\"en\"&gt;\n&lt;many nodes and elements&gt;\n  &lt;eainfo&gt;\n    &lt;detailed Name=\"fire.DBO.labels\"&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;OBJECTID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;OBJECTID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;OID&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdef Sync=\"TRUE\"&gt;Internal feature number.&lt;/attrdef&gt;\n        &lt;attrdefs Sync=\"TRUE\"&gt;Esri&lt;/attrdefs&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Sequential unique whole numbers that are automatically generated.&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;FeatureID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;FeatureID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Sequential unique GUID's that are automatically generated.&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;ZOrder&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;ZOrder&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Order of the Z&lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n      &lt;attr&gt;\n        &lt;attrlabl Sync=\"TRUE\"&gt;SymbolID&lt;/attrlabl&gt;\n        &lt;attalias Sync=\"TRUE\"&gt;SymbolID&lt;/attalias&gt;\n        &lt;attrtype Sync=\"TRUE\"&gt;Integer&lt;/attrtype&gt;\n        &lt;attwidth Sync=\"TRUE\"&gt;4&lt;/attwidth&gt;\n        &lt;atprecis Sync=\"TRUE\"&gt;10&lt;/atprecis&gt;\n        &lt;attscale Sync=\"TRUE\"&gt;0&lt;/attscale&gt;\n        &lt;attrdomv&gt;\n          &lt;udom Sync=\"TRUE\"&gt;Symbol Identifier GUID &lt;/udom&gt;\n        &lt;/attrdomv&gt;\n      &lt;/attr&gt;\n    &lt;/detailed&gt;\n  &lt;/eainfo&gt;\n&lt;/metadata&gt;\n</code></pre>\n"},{"tags":["sql","postgresql","plpgsql","upsert","postgresql-performance"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13233369,"title":"Replace looping with a single query for INSERT / UPDATE","body":"<p>I am writing a function in PostgreSQL. It does basically 3 steps:</p>\n\n<ol>\n<li>Fetch a record from source table.</li>\n<li>check the value from the fetched record in target table, if record is found in target table then update all values of target table with fetched record otherwise insert fetched record to target table.</li>\n</ol>\n\n<p>Instead of doing this looping, if I write <strong>single query</strong> for insert/update, will it be faster than above mentioned approach? How can I achieve same result by writing single query instead looping through every records and doing updation/insertion.</p>\n\n<p>My current approach is as below </p>\n\n<pre><code>CREATE OR REPLACE FUNCTION fun1()\n  RETURNS void AS\n$BODY$DECLARE\n   source_tab_row RECORD;\n\n   v_col1 TEXT;\n   v_col2 TEXT;\n   v_col3 TEXT;\n   v_col4 double precision ;\n   cnt integer;\n\nBEGIN\n    FOR source_tab_row IN (SELECT * FROM source_tab where col5='abc')\nLOOP\n    v_col1=source_tab_row.col1;   \n    v_col2=source_tab_row.col2;\n    v_col3=source_tab_row.col3;\n    v_col4=source_tab_row.col4;\n\n    select count(*) INTO cnt from dest_tab where col1=v_col1;\n\n     if (cnt =0) then\n     -- If records is not found\n       INSERT INTO dest_tab(col1, col2, col3,col4)\n       VALUES( v_col1, v_col2, v_col3,v_col4)   ;\n    else\n     --if records found then update it\n       update dest_tab set col1=v_col1, col2=v_col2, col3=v_col3,col4=v_col4\n       where col1=v_col1;\n\n     end if;         \nEND LOOP;\nEND;\n$BODY$ LANGUAGE plpgsql;\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13242004,"title":"How do I display different values as different columns in SQL?","body":"<p>I have a table with columns <code>UserID, SiteID, SiteViews</code> and another with <code>UserID, First, Last</code></p>\n\n<p>And I need to display the data as <code>First + Last, Site1Views, Site2Views</code></p>\n\n<p>There are only 2 site IDs and I need to have the sum of the SiteViews per User.</p>\n\n<p>Currently I have:</p>\n\n<pre><code>select s.UserFirstName + ' ' + s.UserLastName as 'Name', \nj1.SiteViews as 'Site1Name',\nj2.SiteViews as 'Site2Name' \nfrom (Users s INNER JOIN Usage j on s.UserID = j.UserID)\n</code></pre>\n\n<p>I don't know how to do this. Any help would be appreciated.</p>\n"},{"tags":["python","sql","postgresql","pgadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":13239004,"title":"Create SQL table with correct column types from CSV","body":"<p>I've looked a a number of questions on this site and cannot find an answer to the question: How to create <strong>multiple NEW tables</strong> in a database (in my case I am using PostgreSQL) <strong>from multiple CSV source files</strong>, where the new database table columns accurately reflect the data within the CSV columns?</p>\n\n<p>I can write the CREATE TABLE syntax just fine, and I can read the rows/values of a CSV file(s), but does a method already exist to inspect the CSV file(s) and accurately determine the column type?  Before I build my own, I wanted to check if this already existed.</p>\n\n<p>If it doesn't exist already, my idea would be to use Python, CSV module, and psycopg2 module to build a python script that would:</p>\n\n<ol>\n<li>Read the CSV file(s).</li>\n<li>Based upon a subset of records (10-100 rows?), iteratively inspect each column of each row to automatically determine the right column type of the data in the CSV.  Therefore, if row 1, column A had a value of 12345 (int), but row 2 of column A had a value of ABC (varchar), the system would automatically determine it should be a format varchar(5) based upon the combination of the data it found in the first two passes.  This process could go on as many times as the user felt necessary to determine the likely type and size of the column.</li>\n<li>Build the CREATE TABLE query as defined by the column inspection of the CSV.</li>\n<li>Execute the create table query.</li>\n<li>Load the data into the new table.</li>\n</ol>\n\n<p>Does a tool like this already exist within either SQL, PostgreSQL, Python, or is there another application I should be be using to accomplish this (similar to pgAdmin3)?</p>\n"},{"tags":[".net","sql","frameworks"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13240513,"title":"Value of Developing a SQL Framework Similar to .NET","body":"<p>With the widespread support of Microsoft's .NET Framework for C#, Visual Basic, F#, PowerShell, etc.., I've been wondering why there hasn't been any similar database development frameworks created (I haven't been able to find any at least).</p>\n\n<p>This lead me to consider developing my own framework, but I can't help but think that if it there was a significant need for something like this, that surely someone would have started a project like this already, either commercially or as an open source project.</p>\n\n<p>My preliminary thoughts about the technical aspects are:</p>\n\n<ul>\n<li>The framework would be modeled after the Microsoft .NET Framework as much as possible. Personally, I'm somewhat biased towards .NET &amp; T-SQL, but I think that by providing similar functionality to .NET would help ease the learning curve for new developers too.</li>\n<li>There would be an installer of some type with the option to deploy the framework objects in a separate, dedicated database, or include the objects in another database's schema. Also, with an option to simply generate the scripts to create the objects.</li>\n<li>Ability to select which objects to install (similar to how jQuery UI lets you choose which components you want in your <a href=\"http://jqueryui.com/download/\" rel=\"nofollow\">custom download package</a>) to keep databases from becoming bloated.</li>\n<li>Support for strict ANSI SQL, as well as vendor-specific versions (e.g. SQL Server, Oracle, MySQL).</li>\n</ul>\n\n<p>I guess what I'm really looking for is:</p>\n\n<ol>\n<li>Has anyone has come across anything like this that has already been developed?  </li>\n<li>Do you have any pertinent insight as to why this would be good or bad idea, either generally speaking or in regards to the things I mentioned here?</li>\n</ol>\n\n<p><strong>Edit</strong></p>\n\n<p>Basically, I'm envisioning the framework as providing a common set of helper functions/procedures, tally/number tables, etc...</p>\n\n<p>A prime example would be a function to format a date into a string that could be used with SQL Server pre-2012 versions (SQL Server 2012 introduced this as a built-in function).</p>\n\n<p>And, by framework, I'm thinking along the lines of development within the database (i.e. programming functions, stored procedures, ad-hoc scripts, etc...) vs. interacting with or connecting to the database externally (e.g. Ling2Sql, ORM's).</p>\n"},{"tags":["sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13241622,"title":"Rails: OUTER JOIN with condition","body":"<p>I have 2 models Show and Booking. A show has many bookings. Each booking has a start_date and end_date. I want to find the shows that either i) have no bookings or ii) have bookings that do not overlap with a time interval [start, end]. So far I have:</p>\n\n<pre><code>Show.joins(\"LEFT JOIN bookings ON bookings.show_id = shows.id\").where(\"bookings.start_date &gt; ? OR bookings.end_date &lt; ?, end, start)\n</code></pre>\n\n<p>But it doesn't return the shows that have no bookings. How can I include the shows that have no bookings in the query result?</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":10883930,"title":"Create a view that shows from which table content comes","body":"<p>I have a little problem with a postgreSQL view I have to create for a school project.</p>\n\n<p>I have five tables named:</p>\n\n<ul>\n<li>Input(inputId , distributorId , date)</li>\n<li>Inputline(InputId, ObjectId, ammount)</li>\n<li>Output(outputId, clientId, date)</li>\n<li>Outputline(outputId, ObjectId, ammount)</li>\n<li>Stock(ObjectId, ammount)</li>\n</ul>\n\n<p>Now I need a view which shows me the changes (per objectId) made in chronological order like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>| Date       | type   | ammount In | ammount out |\n+------------+--------+------------+-------------+\n| 10-10-2007 | Input  | 10         |             |\n| 11-10-2007 | Output |            | 5           |\n| 12-10-2007 | Input  | 20         |             |\n</code></pre>\n\n<p>I have absolutely no clue on how to do this so I would really appreciate your help.\nIf more details are needed, don't hesitate to ask =)</p>\n"},{"tags":["sql","postgresql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":83,"score":0,"question_id":10885499,"title":"SQL, select in tables","body":"<p>Hey I don't know how to do it....</p>\n\n<p>Its a homework: List the code and the consumers who bought cars only 'Argentina' country.</p>\n\n<blockquote>\n<pre><code>Table sell:\n</code></pre>\n</blockquote>\n\n<pre><code>customer | resell  | veicle    |    date    |  value\n---------+---------+-----------+------------+----------\n 02      | 01      | 03        | 2010-02-05 | 17500.00\n 04      | 02      | 01        | 2010-01-07 | 28000.00\n 01      | 03      | 08        | 2010-02-15 | 28000.00\n 02      | 03      | 02        | 2010-03-12 | 42000.00\n 03      | 04      | 06        | 2010-02-06 | 11500.00\n 03      | 02      | 05        | 2010-01-25 | 22100.00\n 01      | 01      | 04        | 2010-01-21 | 15500.00\n</code></pre>\n\n<blockquote>\n  <p>Table customer:</p>\n</blockquote>\n\n<pre><code> cod    |    name    | lastname\n--------+------------+------------\n 01     | Jose       | Alves\n 02     | Paulo      | Cunha\n 03     | Maria      | DPaula\n 04     | Joana      | Silveria\n</code></pre>\n\n<blockquote>\n  <p>Table veicle:</p>\n</blockquote>\n\n<pre><code> cod    |manufacturer|     model       | year |  country  |  price\n--------+------------+-----------------+------+-----------+----------\n 01     | 01         | Gol             | 2000 | Brasil    | 25000.00\n 02     | 01         | Golf            | 2005 | Argentina | 39000.00\n 03     | 04         | Ford Ka         | 1990 | Brasil    | 15000.00\n 04     | 03         | Corsa Seda      | 1995 | Brasil    | 12500.00\n 05     | 04         | Fiesta          | 2003 | Argentina | 20000.00\n 06     | 03         | Corsa Seda      | 1995 | Argentina | 10000.00\n 07     | 05         | Palio           | 2002 | Brasil    | 15000.00\n 08     | 05         | Siena           | 2006 | Brasil    | 26000.00\n</code></pre>\n\n<p>I guess it to start:</p>\n\n<pre><code>SELECT customer.cod, customer.name \nFROM sell, customer \nWHERE (SELECT cod \n        FROM veicle \n        WHERE veicle.country = 'Argentina') = sell.veicle;\n</code></pre>\n\n<p>To select only the argentine cars...\nPlease guide-me to the answer.</p>\n"},{"tags":["sql","hive","hiveql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13166708,"title":"How to use min() in where/having clause (to avoid subquery) in Hive/SQL","body":"<p>I have a large table of events. Per user I want to count the occurence of type A events before the earliest type B event.</p>\n\n<p>I am searching for an elegant query. Hive is used so I can't do subqueries </p>\n\n<pre><code>Timestamp Type User \n...        A    X\n...        A    X\n...        B    X\n...        A    X\n...        A    X\n\n...        A    Y\n...        A    Y\n...        A    Y\n...        B    Y\n...        A    Y\n</code></pre>\n\n<p>Wanted Result:</p>\n\n<pre><code>User Count_Type_A \nX    2\nY    3\n</code></pre>\n\n<p>I could not get the \"cut-off\" timestamp by doing:</p>\n\n<pre><code>Select User, min(Timestamp) \nWhere Type=B \nGroup BY User;\n</code></pre>\n\n<p>But then how can I use that information inside the next query where I want to do something like:</p>\n\n<pre><code>SELECT User, count(Timestamp) \nWHERE Type=A AND Timestamp&lt;min(User.Timestamp_Type_B) \nGROUP BY User;\n</code></pre>\n\n<p>My only idea so far are to determine the cut-off timestamps first and then do a join with all type A events and then select from the resulting table, but that feels wrong and would look ugly.</p>\n\n<p>I'm also considering the possibility that this is the wrong type of problem/analysis for Hive and that I should consider hand-written map-reduce or pig instead. </p>\n\n<p>Please help me by pointing in the right direction.</p>\n"},{"tags":["sql","query","caching","ruby-on-rails-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13239510,"title":"Caching database data","body":"<p>I am trying to cache some data from the database to reduce number of SQL queries to the database. Currently, what I am doing is that I will load a set of records from the database:</p>\n\n<pre><code>@records = Record.find(:all, :conditions =&gt; [\"id &lt; ?\", 100])\n</code></pre>\n\n<p>and then iterate through this array to find the records that I really want:</p>\n\n<pre><code>@needed_records = Array.new\n@records.each do |record|\n  if record.is_needed\n    @needed_records.push(record)\n  end\nend\n</code></pre>\n\n<p>So that whenever I need, i can just pass @records instead of actually accessing the database.</p>\n\n<p>My question is, is there any shortcoming doing it this way? Is there any better way to do the equivalent?</p>\n"},{"tags":["php","html","sql","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13240521,"title":"How to display answers in separate rows in a HTML table","body":"<p>I have this query below:</p>\n\n<pre><code>SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, q.QuestionMarks\nFROM Session s\nINNER JOIN Question q ON s.SessionId = q.SessionId\nJOIN Answer an ON q.QuestionId = an.QuestionId\nAND an.SessionId = q.SessionId\nWHERE s.SessionName =  \"GHWSW1\" AND q.QuestionId = 1\nGROUP BY an.SessionId, an.QuestionId\nORDER BY q.QuestionId, an.Answer\n</code></pre>\n\n<p>The query above outputs this result below:</p>\n\n<pre><code>SessionId   SessionName QuestionId  QuestionContent         Answer  QuestionMarks\n1           GHWSW1       1          Here are 2 answers      BD      5\n</code></pre>\n\n<p>So I included the query in the code below and set up a html table:</p>\n\n<pre><code>$assessment = \"GHWSW1\";\n$number = 1;\n\n$query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, \nGROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, q.QuestionMarks \n   FROM Session s \n   INNER JOIN Question q ON s.SessionId = q.SessionId\n   JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId\n   WHERE s.SessionName = ? AND q.QuestionId = ?\n   GROUP BY an.SessionId, an.QuestionId\n   ORDER BY q.QuestionId, an.Answer\n   \";\n\n   // prepare query\n   $stmt=$mysqli-&gt;prepare($query);\n   // You only need to call bind_param once\n   $stmt-&gt;bind_param(\"si\", $assessment, $number);\n   // execute query\n   $stmt-&gt;execute(); \n\n\n       // This will hold the search results\n    $searchQuestionId = array();\n    $searchQuestionContent = array();\n    $searchAnswer = array();\n    $searchMarks = array();\n\n    // Fetch the results into an array\n\n   // get result and assign variables (prefix with db)\n   $stmt-&gt;bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionContent, $dbAnswer, $dbQuestionMarks);\n      while ($stmt-&gt;fetch()) {\n        $searchQuestionId[] = $dbQuestionId;\n        $searchQuestionContent[] = $dbQuestionContent;\n        $searchAnswer[] = $dbAnswer;\n        $searchMarks[] = $dbQuestionMarks;\n      } \n\n?&gt;      \n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n\n\n&lt;form id=\"QandA\" action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n&lt;?php \n\necho \"&lt;table border='1' id='markstbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question No.&lt;/th&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='answerth'&gt;Answer&lt;/th&gt;\n      &lt;th class='noofmarksth'&gt;Total Marks&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n\n          foreach ($searchQuestionContent as $key=&gt;$question) {\n\n        echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n        echo '&lt;td class=\"optiontypetd\"&gt;'.htmlspecialchars($searchQuestionId[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"answertd\"&gt;'.htmlspecialchars($searchAnswer[$key]).'&lt;/td&gt;' ;\n        echo '&lt;td class=\"noofmarkstd\"&gt;'.htmlspecialchars($searchMarks[$key]).'&lt;/td&gt;' . PHP_EOL;\n}\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n\n        ?&gt;\n</code></pre>\n\n<p>So the HTML table displays it like this:</p>\n\n<pre><code>QuestionId  QuestionContent         Answer  QuestionMarks\n1           Here are 2 answers      BD      5\n</code></pre>\n\n<p>But I want it like this in the html table:</p>\n\n<pre><code>QuestionId  QuestionContent         Answer  QuestionMarks\n1           Here are 2 answers      B       5\n                                    D\n</code></pre>\n\n<p>The second Answer <code>D</code> should be in a seperate row and the other rows should have a rowspan. But how can this be achieved?</p>\n\n<p>Session Table:</p>\n\n<pre><code>SessionId (auto)  SessionName\n1                 AAA\n</code></pre>\n\n<p>Question Table:</p>\n\n<pre><code>SessionId  QuestionId (auto)  QuestionContent\n1          1                  What is 2+2?\n</code></pre>\n\n<p>Answer Table:</p>\n\n<pre><code>AnswerId (auto) SessionId  QuestionId   Answer\n1               1          1           B   \n2               1          1           D\n</code></pre>\n"},{"tags":["sql","asp.net-mvc","sql-server-2008","asp.net-mvc-4","getdate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13239675,"title":"Executing table-less SQL in MVC4","body":"<p>What is the best practice for executing a generic, table-less SQL query within an MVC architecture?</p>\n\n<p>I'm trying to use commands such as these:</p>\n\n<pre><code>SELECT getdate();\nSELECT user;\n</code></pre>\n\n<p><strong>Update:</strong>\nThis is actually for part of another project that co-exists alongside the MVC project. All of my tables so far are mapped using edmx from an existing database.</p>\n\n<p>I'd like to use the date from the database in some internal calculations, rather than using the date from the server where the application/site are installed. My formulas go down to the milliseconds, and the time difference between the two servers involved throws off the math.</p>\n"},{"tags":["c#",".net","sql","c#-4.0","ado.net"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13240854,"title":"SCOPE_INDENTITY() not working is it returning null?","body":"<p>Having read around this site I thought the following code would return the ID of the item  I add to my database but the int value I am trying to fill isn't showing up in scope. Here is the code for my insert statement:</p>\n\n<pre><code>  foreach (ExOb exc in exobject)\n            {\n\n                Type type = exc.GetType();\n                //Add a weight exercise\n                if (type == typeof(Weights))\n                {\n\n                    Weights thisweight = (Weights)exc;\n                    string InsertWeight = (\"INSERT INTO WeightExercise (ExcerciseName, Duration, Sets, DiaryId) VALUES (@name, @time, @sets, @DiaryId) SET @ID = SCOPE_IDENTITY();\");\n\n                        com = new SqlCommand(InsertWeight, con);\n                        com.Parameters.AddWithValue(\"@name\", thisweight.ExcerciseName);\n                        com.Parameters.AddWithValue(\"@time\", thisweight.WeightDuration);\n                        com.Parameters.AddWithValue(\"@sets\", thisweight.TotalSets);\n                        com.Parameters.AddWithValue(\"@DiaryId\", results[0]);\n                        com.Parameters.Add(\"@ID\", SqlDbType.Int, 4).Direction = ParameterDirection.Output;\n                        con.Open();\n                        com.ExecuteNonQuery();\n                        int ID = (int)com.Parameters[\"@ID\"].Value;\n\n                        con.Close();\n\n\n                }\n                else if (type == typeof(Cardio))\n                {\n                    Cardio thiscardio = (Cardio)exc;\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The database is updated with the Weight Exercise details. I have checked when debugging and the command parameter @ID holds the ID of the latest entry. Int ID does not show up in locals when debugging and if I Watch it I get:</p>\n\n<pre><code>    ID  The name 'ID' does not exist in the current context \n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["sql","sql-server","stored-procedures","return-value"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":7151,"score":7,"question_id":1035789,"title":"Return value from a stored proc on error","body":"<p>I have an sp in SQL Server that when errors returns -4</p>\n\n<p>What does -4 mean? Is there a table somewhere explaining what the possible return values are?</p>\n\n<hr>\n\n<p>There must be some standard</p>\n\n<p>For example</p>\n\n<pre><code>declare @RetVal int  \nEXEC @RetVal = stpTest  \nselect @RetVal\n</code></pre>\n\n<p>where stpTest is \"SELECT 1/0\" returns -6. </p>\n\n<p>-6 must mean something!</p>\n\n<hr>\n\n<p>The sp that returned -4 only has UPDATE and SELECT INTO statements in it.</p>\n\n<p>At no point does it do 'SELECT -4' so how can I \"find out what -4 means in that particular stored procedure\"?</p>\n\n<p>Also, if there is no standard then why does a divide by zero error always return -6?</p>\n\n<hr>\n\n<p>If you have an sp that does not return anything i.e. it doesn't have any select statements in it and you do:    </p>\n\n<pre><code>declare @RetVal int  \nEXEC @RetVal = yourSPName  \n</code></pre>\n\n<p>Then @RetVal will have a value of 0. </p>\n\n<p>If there is an error then @RetVal will be a value other then zero, for example if the only thing your sp does is \"SELECT 1/0\" then @RetVal will be -6.</p>\n\n<p>Try it and see</p>\n\n<p>My question is what do these return values mean? They must have some logical meaning! </p>\n"},{"tags":["php","html","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13241102,"title":"Store values to database without using form action","body":"<p>I have several web pages created that captures information from user inputs and stores them into session variables in PHP tags inside the html. Finally I echo back the values from the session all on the same page and ask the user if all inputs are correct. I would like to include a submit button at the bottom of the page for the user to submit the session values into the database. I am not sure how to take the values from inside the current page in session variables and store to database. Here is an example of code I currently have.</p>\n\n<pre><code>   &lt;?php\n   session_start();\n   $name = $_SESSION['name'];\n\n   echo \"&lt;br&gt;Is this name right?: \".$name;\n   ?&gt;\n</code></pre>\n\n<p>I have already created the database and respective columns. I am familiar with storing values in form submission, however I have always done this by embedding a file in the form action and obtaining the values using $_POST[''] to get values of inputs of current form. </p>\n"},{"tags":[".net","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13240728,"title":"JS to SQL datetime","body":"<p>I am passing from the client a date time that looks something like this...</p>\n\n<p>\"Mon Nov 05 2012 21:27:58 GMT+0000 (GMT Standard Time)\"</p>\n\n<p>I want to save this into a sql datetime field while retaining as much of the date data as possible.</p>\n\n<p>At the moment I'm doing a conversion like this in the .net backend before I save the datetime to the database....</p>\n\n<pre><code>DateTime.ParseExact(date.Substring(0, 24),\n                             \"ddd MMM d yyyy HH:mm:ss\",\n                             CultureInfo.InvariantCulture);\n</code></pre>\n\n<p>This loses the GMT part. </p>\n\n<p>Is there a way that I can keep it in a ParseExact that will be suitable for SQL?</p>\n"},{"tags":["sql","asp-classic"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":33,"score":6,"question_id":13240833,"title":"Trouble combining 3 different SQL tables items and getting the sum","body":"<p>I am having trouble with a system that my dad uses for reporting at his company. I didn't build it but I am trying my best to wrap my head around it. It's ASP and I am not so well versed in it (or writing sql for that matter).</p>\n\n<p>Basically I have three tables I am working with, Item, ItemHistory, and Devices. In those tables what I am trying to do is </p>\n\n<ul>\n<li>Get the items a user has worked on via the \"serialnumber\" column from the \"Item History\" table</li>\n<li>Compare that serial number to the \"serialnumber\" column in the \"Item\" table to get the device type (from the device column)</li>\n<li>Use the device type to grab a predetermined number value from \"points\" column in the \"Devices\" table</li>\n<li>Store the value and add it to any other values that were pulled back by the query then display the total.</li>\n</ul>\n\n<p>ItemHistory Table</p>\n\n<blockquote>\n<pre><code>Date      | SerialNumber |  DeviceType | User\n----------|--------------|-------------|-------\n11/1/12   | 123-456-789  |     NULL    | Bill\n11/1/12   | 456-123-987  |     NULL    | Bill\n11/1/12   | 987-654-321  |     NULL    | Bill\n</code></pre>\n</blockquote>\n\n<p>Item Table  </p>\n\n<blockquote>\n<pre><code>  SerialNumber |  DeviceType\n  -------------|-------------\n  123-456-789  |  Device1\n  456-123-987  |  Device2\n  987-654-321  |  Device3\n</code></pre>\n</blockquote>\n\n<p>Devices Table</p>\n\n<blockquote>\n<pre><code>  Device   |  Points\n ----------|----------\n  Device1  |    20\n  Device2  |    25\n  Device3  |    40\n</code></pre>\n</blockquote>\n\n<p>And what I am hoping the output will be is</p>\n\n<blockquote>\n<pre><code>  User   |  Points\n --------|----------\n  Bill   |    85\n</code></pre>\n</blockquote>\n\n<p>As you can see, it would have been much easier if the Device Type was included in the ItemHistory table, but it wasn't. I've tried JOINing the tables but keep getting errors (which is from my lack of knowledge im fairly certain). The query is by date range and user (from the ItemHistory table), but I think I've got that figured out. I just can't get it to reference all the tables and add the \"points\" together.</p>\n\n<p>Any help is greatly appreciated! If you need any more info let me know. Thank you in advance.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","table-valued-parameters"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13240720,"title":"Doing an existance check using a subquery with 'LIKE' on a table valued parameter","body":"<p>I am doing an import from excel into the database. I am passing a table valued parameter with a bunch of values, one of them being a foreign key. The catch is that in the database the key value is an <code>nvarchar</code> that always will have 2 or 3 zeroes in front of it, however the people that send the excel files did not properly format the column and those leading zeroes are cut off.</p>\n\n<p>The first thing I need to do in the procedure is to check that all these values exist in a parent table using <code>LIKE</code> (since the leading zeroes are missing). If any of the values don't exist in the parent table then the transaction does not proceed.</p>\n\n<p>I need some help with the MS SQL syntax for this.</p>\n"},{"tags":["sql","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13240543,"title":"group invoices with transaction value greater or smaller then zero","body":"<p>Im trying to make a query out of this but im having no luck yet. The tables are as following:</p>\n\n<pre><code>INVOICE\nID | INVOICENUMBER | CUSTOMER | VALUE\n1 | 999 | 8 | 9000\n2 | 999 | 8 | 1000\n\n\nINVOICE_TRANSACTION\nInvoiceID | TYPE | VALUE\n1 | cust | 5000\n1 | cust | 2000\n2 | cust | 1000\n2 | cust | -1000\n\nINVOICE_DETAIL\nInvoiceID | PURCHASEORDERID\n1 | 7777\n\nPURCHASE_ORDER\nPURCHASEORDERID | ORDERTYPE\n7777 | gross\n\nPURCASE_ORDER_DETAILS\nPURCHASEORDERID | ROW | STATUS\n7777 | 1 | 1\n7777 | 2 | 2\n7777 | 3 | 3\n</code></pre>\n\n<p>The result I want is this:</p>\n\n<pre><code>INVOICE VALUE TRANSACTION VALUE PURCHASEORDERID ORDERTYPE HIGH STATUS LOW STATUS\n------- ----- ----------------- --------------- --------- ----------- ----------\n1       9000  7000              7777            gross     3           1\n</code></pre>\n\n<p>In other words I want the result to group all invoice numbers that has a total <code>invoice_transaction.value</code> greater or smaller then 0. I'm new to all this, can anyone give me a hand to get me started?</p>\n"},{"tags":["c#","sql","ado.net","oledb","sql-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13211812,"title":"In ADO.NET, are there restrictions where SQL parameters can be used in the SQL query?","body":"<p>This question is merely for educational purposes, as I'm not currently building any application that builds SQL queries with user input.</p>\n\n<p>That said, I know that in ADO.NET you can prevent SQL Injection by doing something like this:</p>\n\n<pre><code>OleDbCommand command = new OleDbCommand(\"SELECT * FROM Table WHERE Account = @2\", connection);\ncommand.Parameters.AddWithValue(\"@2\", \"ABC\");\n</code></pre>\n\n<p>But assuming that your application is designed in such a way that the user can actually enter the name of the table, can you do the following? (I don't care if it's a bad idea to allow the users to supply the name of the table, I just want to know if the following is possible...) </p>\n\n<pre><code>OleDbCommand command = new OleDbCommand(\"SELECT * FROM @1 WHERE Account = @2\", connection);\ncommand.Parameters.AddWithValue(\"@1\", \"Table\");\ncommand.Parameters.AddWithValue(\"@2\", \"ABC\");\n</code></pre>\n\n<p>I keep getting an exception when I run the second code, saying that the SQL query is incomplete, and I was wondering if the problem is that what I am trying to do simply cannot be done or if I am overlooking something.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13240298,"title":"Remove numbers from string sql server","body":"<p>I have a large database in which I want to do a part string search. The user will enter characters: <code>JoeBloggs.</code></p>\n\n<p>For arguments sake if I had a name <code>Joe 23 Blo Ggs 4</code> in the database. I want to remove everything in the name other than A-Z. </p>\n\n<p>I have the <code>REPLACE(Name, ' ','')</code> function to remove spaces and the <code>UPPER()</code> function to capitalize the name.</p>\n\n<p>Is there a more efficient fast way maybe by terms of regex to replace anything other than A-Z. I cannot change the values in the database.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["php","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239768,"title":"PHP and SQL Server Express to retrieve and show data","body":"<p>I am looking to take a PHP page to retrieve data based on the selection from a drop down list, then show the results based on that selection.  I am not even sure where to begin except my connection to the database.  I do also know that I have to have a query statement, like I would in SQL, which here is a little bit of that:</p>\n\n<pre><code>$sql = \"SELECT ForteID, Disposition, appNumber, Finance_Num, Num_Payments, ACH_CC, Notes, Date\nFROM   cslogs.dbo.Logs\nWHERE  ForteID = 'bs1441'\";\n</code></pre>\n\n<p>The bs1441 is just an example of one option that would be in the drop down list.  I am not sure what I would put there for it to put in there automatically from the list.</p>\n\n<p>Thanks for the help in advance.  Sorry if there is not enough information to go on, but not sure what even would be needed at this point.</p>\n\n<p>EDIT:</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>&lt;form method=\"get\" action=\"getlog.php\"&gt; \n\n&lt;table width=\"300\" border=\"0\"&gt;\n&lt;tr&gt;\n&lt;td&gt; Forte ID:&lt;/td&gt;\n&lt;td&gt;&lt;select id=\"ForteID\" name=\"ForteID\"&gt;                    \n                &lt;option value=\"nc4682\"&gt;nc4682&lt;/option&gt;\n                &lt;option value=\"bs1441\"&gt;bs1441&lt;/option&gt;\n                &lt;option value=\"sp3212\"&gt;sp3212&lt;/option&gt;                 \n    &lt;/select&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n\n&lt;input type=\"submit\" name=\"getLog\" value=\"Get Log\"&gt;\n&lt;/form&gt; \n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&lt;?php\n$serverName = 'SRB-Nick_Desktop\\SQLEXPRESS';\n$connectionInfo = array('Database'=&gt;'cslogs', 'UID'=&gt;'cslogslogin', 'PWD'=&gt;'123456');\n$connection = sqlsrv_connect($serverName, $connectionInfo);\n\n$result = sqlsrv_query( $connection, \n                'SELECT ForteID, Disposition, appNumber, Finance_Num, Num_Payments, ACH_CC, Notes, Date\n                FROM    Logs\n                WHERE   (ForteID = $ForteID)', \n                   array($ForteID));\n\nwhile($row = sqlsrv_fetch_array($result))\n{\necho($row['ForteID'] . ', '.\n     $row['Disposition'] . ', '.\n     $row['appNumber'] . ', '.\n     $row['Finance_Num'] . ', '.\n     $row['Num_Payments'] . ', '.\n     $row['ACH_CC'] . ', '.\n     $row['Notes'] . ', '.\n     $row['Date']);\n}\nsqlsrv_close( $connection);\n?&gt;\n</code></pre>\n\n<p>Then when I look at the page it throws this error:</p>\n\n<p>Parse error: syntax error, unexpected T_STRING in C:\\wamp\\www\\cslogs\\getlog.php on line 46</p>\n\n<p>Line 46 is this line:</p>\n\n<pre><code>    echo($row['ForteID'] . ', '.\n</code></pre>\n\n<p>Let me know if that helps!</p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13239911,"title":"Decreasing execution time with sql left outer join query","body":"<p>How can I decrease the execution time with this sql squery? it is taking over a minute to execute and return rows.(executed in Sql server management studio 2008)</p>\n\n<pre><code>if(@NotInvoiced =1)\nBEGIN\nSelect @Command = \n'select Distinct C.FileID, C.FileName, convert(nvarchar,C.DateReported,111) AS ''DateReported'', \nC.FileDetailsPlainText, CFIT.Level3 as ''InvestigationType'', INV.FName + '' '' + INV.LName AS ''Name'', \nconvert(nvarchar,DD,111) AS ''DD'', i.FirstName + '' '' + i.LastName AS ''ReportedBy''\nfrom CaseFiles C \njoin InvestigatorCaseFileAccess IA on C.FileID=IA.CaseFileID \nLEFT OUTER JOIN CaseFileTimeBills tb on C.FileID=tb.FileID\nLEFT OUTER JOIN CaseFileExpenses e on C.FileID=e.FileID\n\nleft join Element07a_Persons i on i.PersonID = c.PersonID\nLEFT OUTER JOIN CaseFileInvestigationTypes CFIT ON C.InvestigationTypeID = CFIT.InvestigationTypeID \nLEFT OUTER JOIN Investigators INV ON C.InvestigatorID = INV.InvestigatorID\nwhere (tb.InvNumber IS null OR e.InvNumber IS null) and Deleted=0 and IA.InvestigatorID=' + CONVERT (nvarchar(max),@InvestigatorID) + ' and IA.AllowAccess = ''True''\n and tb.FileID = C.FileID or e.FileID=C.FileID '\nEND\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13240116,"title":"Cannot create TABLESPACE as datafile file already part of database","body":"<p>I accidentally somehow remove a tablespace without removing the datafile(forget how..), now the datafile become lost in the woods but when I try to create the TABLESPACE again with the same datafile:</p>\n\n<pre><code>CREATE BIGFILE TABLESPACE SERVER01_DAT DATAFILE 'D:/Oracle11g/app/INSTANCE/dbf/SERVER01_DAT.DBF'\nSIZE 200M REUSE AUTOEXTEND ON NEXT 100M MAXSIZE 2048M LOGGING EXTENT MANAGEMENT LOCAL SEGMENT\nSPACE MANAGEMENT AUTO;\n</code></pre>\n\n<p>then Oracle reject me like this:</p>\n\n<pre><code>cannot add file 'D:/Oracle11g/INSTANCE/INSTANCE/dbf/SERVER01_DAT.DBF' - file already part of database\n</code></pre>\n\n<p>It's interesting as no tablespace occupies this data file then how come it can be in use so oracle service should allow attach this data file back to any tablespace. Anyway I would really appreciate for an idea to re-attache the tablespace with this data file, or help me delete current data file. Thanks a lot.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13238866,"title":"Stored procedure containing inner join with count not working","body":"<p>Let's say i've got a databasetable looking a bit like this, containing information about some assignments.</p>\n\n<pre><code>Id   | ProfessionId      | Title       | Deadline     | DateCreated | ClosingDate\n1    |  5                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n2    |  6                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n3    |  7                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n4    |  7                | Something   | 01-12-2012   | 05-11-2012  | 12-11-2012\n</code></pre>\n\n<p>I want to generate an overview foreach profession (assignments belong to a certain profession) and count the number of assignment in each profession. The overview coming from the database should look like this;</p>\n\n<pre><code>Id | Name           | FriendlyUrl     | Ordinal   | NumberOfAssignments\n5  | Profession 1   | profession-1    | 1         | 1\n6  | Profession 2   | profession-2    | 1         | 1\n7  | Profession 3   | profession-3    | 1         | 2\n8  | Profession 4   | profession-4    | 1         | 0\n</code></pre>\n\n<p>I've currently got a stored procedure returning the overview above, except that the amount of assignments isn't correct. Assignments with a closingdate in the past (we then assume the assignment is closed) shouldn't be taken into the the total number of assignment.</p>\n\n<p>The current stored procedure is like this:</p>\n\n<pre><code>BEGIN\n    SELECT  p.Id, \n            p.Naam, \n            p.FriendlyUrl, \n            p.Ordinal, \n            COUNT(a.ProfessionId) AS NumberOfAssignments\n    FROM ME_Profession AS p \n    LEFT OUTER JOIN ME_Assignment AS a ON a.ProfessionId = p.Id\n    INNER JOIN ME_Client AS c ON a.ClientId = c.Id\n    INNER JOIN aspnet_Membership AS m ON m.UserId = c.UserId\n    WHERE m.IsApproved = 1 \n    GROUP BY p.Id, p.Naam, p.FriendlyUrl, p.Ordinal\nEND\n</code></pre>\n\n<p>I've already came up with and modified procedure like the one below, but it doesn't work. It feels like i'm either thinking too difficult or missing something obvious. What could go wrong?</p>\n\n<pre><code>SELECT        p.Id, p.Naam, p.FriendlyUrl, p.Ordinal, pc.NumberOfAssignments\nFROM            ME_Profession AS p \nINNER JOIN ME_Assignment AS a ON a.ProfessionId = p.Id \nINNER JOIN ME_Client AS c ON a.ClientId = c.Id\nINNER JOIN aspnet_Membership AS m ON m.UserId = c.UserId\nINNER JOIN (SELECT a2.ProfessionId, COUNT(*) AS NumberOfAssignments FROM ME_Assignment AS a2 GROUP BY a2.ProfessionId WHERE a2.Closingdate &gt; GETDATE()) pc ON p.ProfessionId = pc.ProfessionId\nWHERE        m.IsApproved = 1 AND a.Closingdate &gt; GETDATE()\nGROUP BY p.Id, p.Naam, p.FriendlyUrl, p.Ordinal\n</code></pre>\n\n<p><strong>UPDATE 1:</strong> Added where condition for date</p>\n"},{"tags":["sql","oracle10g"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13227349,"title":"how to minimize the usage of conversion functions in SQL queries?","body":"<p>My SQL Queries contain lots of ltrim() , rtrim() , substring() etc conversion functions...They are significantly impacting query performance... Please answer my following queries :</p>\n\n<ul>\n<li>How to minimize usage of conversion functions in my queries? </li>\n<li>What are the possible alternatives instead of conversion functions that could be used in queries ? </li>\n<li>will the alternatives significantly improve my query performance ? </li>\n</ul>\n\n<p>...please guide me  </p>\n"},{"tags":["mysql","sql","left-join"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13239485,"title":"Ordering joined query by multiple rows of the joined table","body":"<p>I've got a <code>posts</code> table and a <code>postmeta</code> table which contains <code>meta_key</code> and <code>meta_value</code> columns. I've included a simplified table structure below (with some demo data).</p>\n\n<pre><code>CREATE TABLE `posts` (\n  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n  `title` varchar(200) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;\n\nINSERT INTO `posts` (`id`, `title`) VALUES\n    (1,'First post'),\n    (2,'Second post'),\n    (3,'Third post'),\n    (4,'Fourth post');\n\nCREATE TABLE `postmeta` (\n  `meta_id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n  `post_id` int(11) NOT NULL,\n  `meta_key` varchar(200) NOT NULL DEFAULT '',\n  `meta_value` text NOT NULL,\n  PRIMARY KEY (`meta_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;\n\nINSERT INTO `postmeta` (`meta_id`, `post_id`, `meta_key`, `meta_value`) VALUES\n    (1,1,'rating','80'),\n    (2,1,'total_votes','500'),\n    (3,2,'rating','80'),\n    (4,2,'total_votes','501'),\n    (5,3,'rating','95'),\n    (6,3,'total_votes','200');\n</code></pre>\n\n<p>The posts need to be ordered by rating. Post without any rating need to be included too, hence the <code>LEFT JOIN</code>. No problem:</p>\n\n<pre><code>SELECT *\nFROM posts p\nLEFT JOIN postmeta m ON p.id = m.post_id AND m.meta_key = 'rating'\nORDER BY m.meta_value DESC\n</code></pre>\n\n<p>However, <strong>for posts with the same rating, I'd like to further order them by the total vote count</strong> which is stored in another row in the <code>postmeta</code> table. In the example above, the first and second post have a rating of 80 but since the second post has more votes, it should be ordered before the first post. How would you pull that off in a single query?</p>\n"},{"tags":["sql","sql-server","query","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13239312,"title":"Return 4 separate counts for single column in SSRS DataSet","body":"<p>I want to provide 5 counts to SSRS from a conditional count on a column.  For instance, suppose the column held the color of a product -- green ,blue, red and yellow.  What I would like to do is return the count of each in a single query.</p>\n\n<p>Although I can accomplish getting this done using a case statement:</p>\n\n<pre><code>Select\n      COUNT(*) 'Count',\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GR' then 'Green\n            Else 'All Others'\n      End as Payment\nFrom COLORS(NoLock)\nGroup by\n      case\n            When Color = 'BL' then 'Blue\n            When Color = 'RD' then 'Red\n            When Color = 'YL' then 'Yellow\n            When Color = 'GRthen ‘Green’\n            Else 'All Others'\n      End\n</code></pre>\n\n<p>When I use the dataset is SSRS, all I get is the a single count.  I don't want to create 4 dataset queries as I'm actually selection the records by the parameters start and end date and I would end up having 5 sets of date parameters. </p>\n"},{"tags":["sql","database-schema"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":35,"score":-4,"question_id":13238679,"title":"creating views SQL","body":"<p>database consists of (primary keys and foreign keys are in bold)</p>\n\n<p>department (<strong>dept_name</strong>, building, budget)</p>\n\n<p>course(<strong>course_id,</strong> title, dept_name, credits)</p>\n\n<p>instructor(<strong>ID</strong>, name, dept_name, salary)</p>\n\n<p>section(<strong>course_id, sec_id, semester, year,</strong> building, room_number, time_slot_id)</p>\n\n<p>teahces(<strong>ID, course_id, sec_id, semester</strong>, year)</p>\n\n<p>student(<strong>ID</strong>, name, dept_name, tot_cred)</p>\n\n<p>takes(<strong>ID, course_id, sec_id, semester, year</strong>, grade)</p>\n\n<p>I don't know how to write a query for the following question as I am a newbie and have just touched on views:</p>\n\n<p>Create a view consisting of the titles of all courses that are taught in room LG115 in Northern Wing Building in the autumn semester 2010.</p>\n\n<p>Thanks! :)</p>\n\n<p>Kirsty</p>\n"},{"tags":["sql","asp.net-mvc","linq","telerik"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239333,"title":"Telerik MVC grid - sorting pre-sorted data on a per-page basis","body":"<p>I have a Telerik grid with paging enabled, at 100 items per page.  I want to sort only these 100 items, per page.</p>\n\n<p>This is my controller, it's returning pre-sorted data:</p>\n\n<pre><code>var listInflows = (from inf in db.CI_INFLOWS\n                                   orderby inf.InvoiceDt descending\n                                   select new InflowsGetModel\n                                   {\n                                     [omitted for brevity]\n</code></pre>\n\n<p>These is my Telerik settings:</p>\n\n<pre><code>.Sortable(sorting =&gt; sorting.OrderBy(so =&gt; so.Add(a =&gt; a.InvoiceDt).Ascending()))\n.Pageable(paging =&gt; paging.PageSize(100)\n                          .Style(GridPagerStyles.NextPreviousAndNumeric)\n                          .Position(GridPagerPosition.Top)\n         )\n</code></pre>\n\n<p>Here, I am telling the db to sort the data.  Then I want the 100-per-page displayed items to sort in the reverse order.  It's not behaving as expected.</p>\n"},{"tags":["mysql","sql","triggers","referencing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13237288,"title":"MySQL: how to refer to transition tables","body":"<p>:) I have these two tables:</p>\n\n<pre><code>create table possiede (\nsoc1 integer not null,\nsoc2 integer not null,\nprimary key (soc1,soc2),\nperc double\n);\n\ncreate table contr (\nsoc1 integer not null,\nsoc2 integer not null,\nprimary key(soc1, soc2)\n);\n</code></pre>\n\n<p>I have these two triggers in a generic SQL syntax and I need to translate them into MySQL syntax:</p>\n\n<pre><code>create trigger contrDir\nafter insert on possiede\nfor each row\nwhen percent &gt; 0.5 and (soc1,soc2) not in (select * from contr)\ninsert into contr values (soc1,soc2);\n\ncreate trigger contrIndir\nafter insert on possiede\nreferencing new table as newTable\nfor each row\ninsert into possiede values\n(select P.soc1, N.soc2, P.perc+N.perc\nfrom newTable as N join possiede as P on N.soc1 = P.soc2);\n</code></pre>\n\n<p>this was my first try, but it gives me an error on \"referencing\" keyword (\"syntax error, unexpected IDENT_QUOTED, expecting FOR_SYM\") and I'm not sure the translation is correct:</p>\n\n<pre><code>create trigger controllo\nafter insert on possiede\nREFERENCING new table as newTable\nfor each row\nbegin\n    insert into possiede (select P.soc1, N.soc2, P.perc+N.perc from\n    newTable as N join possiede as P on N.soc1=P.soc2);\n    if percent &gt; 0.5 and (soc1,soc2) not in (select * from contr) then\n    insert into contr values (soc1,soc2);\n    end if;\nend;\n</code></pre>\n\n<p>also as you noticed I had to compress two triggers into one because of some MySQL constraints. Could somebody give me the right translation?</p>\n"},{"tags":["mysql","sql","query","security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13238850,"title":"Override column value in WHERE clause?","body":"<p>I was wondering if it was possible to override column value in the Where clause of a SQL query (MySQL in my case).</p>\n\n<p>To be more clear, here is an example :</p>\n\n<p>Suppose a basic query is :</p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = \"Doe\";\n</code></pre>\n\n<p>Is it possible to force <code>lastname</code> and <code>firstname</code> to return value from an other table, just by modifying what is after the WHERE part ? Something like </p>\n\n<pre><code>SELECT lastname, firstname FROM contacts WHERE lastname = (SELECT name FROM companies);\n</code></pre>\n\n<p>I am currently testing a web application, and I found a SQL Injection flaw where I can change <code>Doe</code> to whatever I want, but I'm limited with only one query (<a href=\"http://php.net/mysql_query\" rel=\"nofollow\">mysql_query restriction of PHP</a>) and <code>addslashes</code> (so no \" and ').</p>\n"},{"tags":["sql","select","aggregate-functions","ormlite"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13223264,"title":"ORMLite: How to evaluate a SQL function result and query from nested SELECT","body":"<p>How can I implement this SQL query in ORMLite and evaluate the result?</p>\n\n<pre><code>SELECT SUM(column1 * column2) AS total FROM (ANOTHER_SELECT_QUERY)\n</code></pre>\n"},{"tags":["php","sql","authentication","permissions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13238890,"title":"Design help: Multiple User Roles","body":"<p>I'm currently in the process of designing a web app that requires the use of user permissions and roles. The roles will be stored within the SQL database (using MS SQL but this should be a design independent of the implementation).</p>\n\n<p>What is the standard practice for allowing a user to have multiple roles, a \"One to Many\" relationship if you will.</p>\n\n<p>What I came up with conceptually is the idea of a int field that uses a bit flag to determine if the user has that role:</p>\n\n<pre><code>User Group | Permission Mask | Value\n-------------------------------------\nBasic      | 0 0 0 0 1       | 1\nAdvanced   | 0 0 0 1 0       | 2\n...        |    ...          | ...\nAdmin      | 1 0 0 0 0       | 16\n</code></pre>\n\n<p>This way, on my PHP side's authentication I can quickly math out if a user belongs to the role or not. The biggest drawback I see with this is readability and understanding. For someone not involved with this design decision would they be able to figure out what's going on when maintenance/upgrades (new roles) come along?</p>\n\n<p><strong>Is this appropriate for my needs? Is there a more standardized way of allowing users to have multiple roles/groups?</strong></p>\n"},{"tags":["sql","sql-server","database","database-design","database-schema"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13238584,"title":"good ebooks/resources for designing a database for Reporting & analysis purposes","body":"<p>I am working on designing a seperate database in Sql Server for analysis and reporting purposes.</p>\n\n<p>I searched online and found the below link to be somewhat useful:\n<a href=\"http://stackoverflow.com/questions/3331637/when-to-build-a-separate-reporting-database\">When to build a separate reporting database?</a></p>\n\n<p>I also denormalized some of the tables where I felt are necessary.</p>\n\n<p>I would like to know if someone could point me out to any resources ebooks/tutorials/blogs that would exclusively focus on designing of databases for analysis and reporting purposes.</p>\n\n<p>We currently have around 1TB of data within the database and the data is expected to grow\ntremendously within the coming months.</p>\n"},{"tags":["c#",".net","sql","regex","vb.net"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":540,"score":1,"question_id":9842991,"title":"Regex to remove single-line SQL comments (--)","body":"<p>Question:</p>\n\n<p>Can anybody give me a working regex expression (C#/VB.NET) that can remove single line comments from a SQL statement ?</p>\n\n<p>I mean these comments:</p>\n\n<pre><code>-- This is a comment\n</code></pre>\n\n<p>not those</p>\n\n<pre><code>/* this is a comment */\n</code></pre>\n\n<p>because I already can handle the star comments.</p>\n\n<p>I have a made a little parser that removes those comments when they are at the start of the line, but they can also be somewhere after code or worse, in a SQL-string <code>'hello --Test -- World'</code> \nThose comments should also be removed (except those in a SQL string of course - if possible).</p>\n\n<p>Surprisingly I didn't got the regex working. I would have assumed the star comments to be more difficult, but actually, they aren't.</p>\n\n<p>As per request, here my code to remove /**/-style comments\n(In order to have it ignore SQL-Style strings, you have to subsitute strings with a uniqueidentifier (i used 4 concated), then apply the comment-removal, then apply string-backsubstitution.</p>\n\n<pre><code>    static string RemoveCstyleComments(string strInput) \n    { \n        string strPattern = @\"/[*][\\w\\d\\s]+[*]/\"; \n        //strPattern = @\"/\\*.*?\\*/\"; // Doesn't work \n        //strPattern = \"/\\\\*.*?\\\\*/\"; // Doesn't work \n        //strPattern = @\"/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/ \"; // Doesn't work \n        //strPattern = @\"/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/ \"; // Doesn't work \n\n        // http://stackoverflow.com/questions/462843/improving-fixing-a-regex-for-c-style-block-comments \n        strPattern = @\"/\\*(?&gt;(?:(?&gt;[^*]+)|\\*(?!/))*)\\*/\";  // Works ! \n\n        string strOutput = System.Text.RegularExpressions.Regex.Replace(strInput, strPattern, string.Empty, System.Text.RegularExpressions.RegexOptions.Multiline); \n        Console.WriteLine(strOutput); \n        return strOutput; \n    } // End Function RemoveCstyleComments \n</code></pre>\n"},{"tags":["sql","search"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13231892,"title":"SQL search query based on separate words","body":"<p>I currently have a SQL stored procedure that is set up that is based on receiving a parameter search string, (for example 'Netgear WiFI Switch') the stored procedure then does a wildcard LIKE search on this .i.e.  </p>\n\n<pre><code>WHERE COL1 LIKE '%Netgear WiFi Switch'%\n</code></pre>\n\n<p>This works fine however I want to elaborate on this by searching on any of the words. For example the example query would miss out products that say 'Netgear Switch WiFi' because of the different order.</p>\n\n<p>So I need to split the words and do a wildcard search on each word. (%Netgear% AND %Switch% AND %WiFi%)</p>\n\n<p>So my question is how would I begin to look at splitting the string into the necessary words, apply these to variables and then do a dynamic WHERE based on how many variables have been created from the splitting of the search string.</p>\n\n<p>Thank you</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13238668,"title":"Select into a view","body":"<p>I have a simple CTE <code>x</code> and I wish to select its contents into a view.  Can you select into a view using the same type of syntax that you can for a table? i.e.</p>\n\n<pre><code>SELECT * \nINTO newTable\nFROM OldTable\n</code></pre>\n\n<p>Can new views be created dynamically like this?</p>\n"},{"tags":["sql","postgresql","null","aggregate-functions","window-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13237801,"title":"Average over hard to define partition","body":"<p>I have this table:</p>\n\n<pre><code>create table t (value int, dt date);\n\n value |     dt     \n-------+------------\n    10 | 2012-10-30\n    15 | 2012-10-29\n  null | 2012-10-28\n  null | 2012-10-27\n     7 | 2012-10-26\n</code></pre>\n\n<p>And I want this output:</p>\n\n<pre><code> value |     dt     \n-------+------------\n    10 | 2012-10-30\n     5 | 2012-10-29\n     5 | 2012-10-28\n     5 | 2012-10-27\n     7 | 2012-10-26\n</code></pre>\n\n<p>I want the null values, as well as the one previous non null value, to be replaced by the average of the previous not null value when the table is ordered by date descending. In this example the value 15 is the previous not null value of the next two nulls. So 15 / 3 = 5.</p>\n\n<p><a href=\"http://www.sqlfiddle.com/#!12/6a0c7/1\" rel=\"nofollow\">SQL Fiddle</a></p>\n"},{"tags":["sql","oracle"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12301,"score":2,"question_id":1387612,"title":"How can i introduce multiple conditions in LIKE operator","body":"<p>I want to write an SQL statement like below:</p>\n\n<pre><code>select * from tbl where col like ('ABC%','XYZ%','PQR%');\n</code></pre>\n\n<p>I know it can be done using <code>OR</code>. But I want to know is there any better solution.</p>\n"},{"tags":["sql","condition","assertion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13238838,"title":"Why does a syntax error come up when I use the \"CREATE ASSERTION <name>\" in SQL?","body":"<p>I just used the \"CREATE ASSERTION \" to check a condition, but the sql says \"Unknown object type 'ASSERTION' used in a CREATE, DROP, or ALTER statement.\"\nMy code is below:</p>\n\n<pre><code>CREATE ASSERTION SectionLimit\n    CHECK (SELECT COUNT(DISTINCT StudentNo), Capacity\n            FROM Enrollments, CourseSections\n            GROUP BY Capacity\n            HAVING Capacity &gt; COUNT(DISTINCT StudentNo) OR Capacity = COUNT(DISTINCT StudentNo))\n</code></pre>\n\n<p>Does anyone know how to fix this error please?\nThanks in advance!!!</p>\n"},{"tags":["sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":57,"score":1,"question_id":13238036,"title":"Please review my database schema - need input","body":"<p>I am researching database design and theory and have finally made a thoughtful attempt at creating a schema that would be based upon SQL.  I would like, if someone has time, to review my layout and make sure that it is logical.  Tips and criticism aimed at bettering my knowledge is of course welcome! :)</p>\n\n<p>Here is my general goal:\nCreate a database that will allow for a business with multiple stores to be able to track employee training progress by simply marking date trained and date verified.  Basically, this would be the hierarchy:</p>\n\n<pre><code>Business 1 \n--Store Location (a)\n----Employee\n----Employee\n----Employee\n--Store Location (b)\n----employee\n----employee\n----employee\n\nBusiness 2\n--Store Location (a)\n----employee\n----employee\n--Store Location (b)\n----employee\n----etc...\n</code></pre>\n\n<p>This schema should allow for unlimited businesses, stores, and employees.</p>\n\n<p>As far as the training goes, there should be this type of hierarchy:</p>\n\n<pre><code>Business 1\n--Employee Class           (Manager, Employee, Salesman, Associate, etc)\n----Training Category      (Sales, Stocking, Manufacturing, etc)\n------Training Activity    (How to sell X product, How to stock Y aisle, etc)\n------Training Activity\n------Training Activity\n----Training Category\n------Training Activity\n------Training Activity\n--Employee Class\n----Training Category\n----Training Category\n\nBusiness 2\n--Employee Class           \n----Training Category     \n------Training Activity    \n------Training Activity\n------Training Activity\n----Training Category\n------Training Activity\n------Training Activity\n--Employee Class\n----Training Category\n----Training Category\n</code></pre>\n\n<p>The following things should be variable based on business needs and created upon creation of business's account:</p>\n\n<pre><code>*Number of Stores\n*Number of Employees \n*Employee Classes\n\n*Training Categories\n*Training Activities\n</code></pre>\n\n<p>So the grand questions are: <br>\n1) How close did I get?<br>\n2) How can it be done better?</p>\n\n<p>Thanks in advance!</p>\n\n<p>Here is the link to the picture of the Diagram:\n<a href=\"http://i1227.photobucket.com/albums/ee422/CorySCline/diagram.jpg\" rel=\"nofollow\">http://i1227.photobucket.com/albums/ee422/CorySCline/diagram.jpg</a></p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13238568,"title":"Filling Missing Values in Column","body":"<pre><code>Item  ID\nNULL  1\nNULL  2\n3     3\nNULL  4\nNULL  5\n</code></pre>\n\n<p>Im trying to get the output as</p>\n\n<pre><code>Item  ID\n1     1\n2     2\n3     3\n4     4\n5     5\n</code></pre>\n\n<p>using cursors i updated the bottom 2 nulls as 4 and 5 \nand using flags i have counted the NULLs above 3 but i cant access the top 2 positions ?\nis the approach correct ? </p>\n"},{"tags":["sql","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13238580,"title":"Sql Where condition not returning rows specified","body":"<p>I have a sql select query that is supposed to return a bunch of rows filter by a where clause. Everything works until I add an \"OR\" then it doesn't seem to return the correct rows.(Sql server management Studio 2008)</p>\n\n<p>Here is my query:</p>\n\n<pre><code>Select @Command = \n'select DISTINCT C.FileID, C.FileName, convert(nvarchar,C.DateReported,111) AS ''DateReported'', \nC.FileDetailsPlainText, CFIT.Level3 as ''InvestigationType'', INV.FName + '' '' + INV.LName AS ''Name'', \nconvert(nvarchar,DD,111) AS ''DD'', i.FirstName + '' '' + i.LastName AS ''ReportedBy''\nfrom CaseFiles C \njoin InvestigatorCaseFileAccess IA on C.FileID=IA.CaseFileID \nJOIN CaseFileTimeBills tb on C.FileID=tb.FileID\nJOIN CaseFileExpenses e on C.FileID=e.FileID\n\nleft join Element07a_Persons i on i.PersonID = c.PersonID\nLEFT OUTER JOIN CaseFileInvestigationTypes CFIT ON C.InvestigationTypeID = CFIT.InvestigationTypeID \nLEFT OUTER JOIN Investigators INV ON C.InvestigatorID = INV.InvestigatorID\nwhere Deleted=0 and IA.InvestigatorID=' + CONVERT (nvarchar(max),@InvestigatorID) + ' and IA.AllowAccess = ''True'' \nand tb.InvNumber IS NULL OR e.InvNumber IS NULL '\nEND\n</code></pre>\n\n<p>The \"tb.Invnumber IS NULL OR e.Invnumber IS NULL' aren't returning the rows it is supposed to return. When I run the query it returns 5 rows, but I know that it is suppose to return more than 5.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13237736,"title":"How Can we use ISNULL to all Column Names in SQL Server 2008?","body":"<p>I have a question </p>\n\n<p>I tried to <code>google</code> it but looks like they don't like <code>*</code> </p>\n\n<p>I'm using SQL Server 2008.</p>\n\n<p>I have the following database table: </p>\n\n<pre><code> P_Id   ProductName UnitPrice   UnitsInStock    UnitsOnOrder\n------------------------------------------------------------------------\n   1    Jarlsberg   10.45                 16    15\n   2    Mascarpone  Null                  23    NULL \n   3    Gorgonzola  15.67                  9    20\n</code></pre>\n\n<p>If I need to replace the <code>null</code> with a string I know I do :</p>\n\n<pre><code> SELECT ISNULL(UnitsOnOrder,'No Data') FROM tbl\n</code></pre>\n\n<p><strong>Questions</strong> </p>\n\n<ul>\n<li>How can I use <code>ISNULL()</code> with multi column names ?</li>\n<li>is it possible to use it with <code>*</code> </li>\n</ul>\n\n<p><em>Like</em></p>\n\n<pre><code>SELECT ISNULL(* , 'NO data') FROM tbl \n</code></pre>\n\n<p>I think this will be tricky because of the datatype, you can't pass string to <code>INT</code> datatype  so how can I fix this too </p>\n\n<p><strong>Update</strong> </p>\n\n<p>Okay if i use <code>ISNULL(</code>) with a datatype of <code>int</code> it will return <code>0</code> \nwhich will be a value to me , how can i pass empty string instead ? </p>\n\n<p>Thanks </p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13234067,"title":"How to write IN clause query to replace null for no value parameter","body":"<p>I am writing a query in which where clause have IN clause and there are large number of values in this IN clause , I want to fetch the result such that if there is no value exist in table for value given in IN clause then a raw containing 0 or null should return for that value. for example..</p>\n\n<pre>\nselect age,sex,date_joining from emp where name IN ('amit','john','paul','dilip')\n</pre>\n\n<p>Now assume for this query ,data for john and paul does not exist in database then result should be like below..</p>\n\n<pre>\n21    male   21-AUG-2011\nnull  null   null\nnull  null   null\n25    male   9-aug-2010\n</pre>\n\n<p>we can also have 0 instead of null if null is not possible</p>\n\n<p>Thanks...</p>\n"},{"tags":["php","mysql","sql","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13238280,"title":"In SQL, how do I get the awards total for each player","body":"<p>I have two tables, one called Players and one called Awards. End-users give an \"award\" to a player, and players can receive the same award multiple times. </p>\n\n<pre><code> Awards Table\n----+------------------------------------------------------------------------+\n| ID | name                             |  player_id                         |\n+----+-----------------------------------------------------------------------+\n|  1 | Free-throw Excerpt               |  1                                 |\n|  2 | Free-throw Excerpt               |  6                                 |\n|  3 | Top Earner                       |  1                                 |\n|  4 | Top Player                       |  5                                 |\n|  5 | Free-throw Excerpt               |  1                                 |\n|  6 | Free-throw Excerpt               |  1                                 |\n|  7 | Top Earner                       |  1                                 |\n|  8 | Top Player                       |  1                                 |\n       ...\n+----+-----------------------------------------------------------------------\n\n\n `Players Table`\n----+------------------------------------------------------------------------+\n| ID | name                                                                  |\n+----+-----------------------------------------------------------------------+\n|  1 | Player A                                                              |\n|  2 | Player B                                                              |\n|  3 | Player C                                                              |\n|  4 | Player D \n       ...                                                                   |  \n+----+-----------------------------------------------------------------------\n</code></pre>\n\n<p>In my app, each player has a page, and on that page, I want to display all the awards that the player has won. For example, for Player B's page: </p>\n\n<p><strong>Player A Stats:</strong> </p>\n\n<ul>\n<li>Free Throw Excerpt: 3 votes</li>\n<li>Top Earner:         2 Votes</li>\n<li>Top Player:         1 Vote</li>\n</ul>\n\n<p>I can query the the awards table to get all the awards given to Player A, but I'm stuck here and don't know where to go. Do I need to then do a COUNT(*) to get the number of each award received? (1 for Top Player, 3 for Free Throw Excerpt).</p>\n\n<p>Thanks,</p>\n"},{"tags":["mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13237570,"title":"MySQL query consuming an inordinate amount of processor time of the system's CPU","body":"<p>I have the following MySQL query which seems to be consuming an inordinate amount of processor time of the system's CPU.</p>\n\n<p>The query is suppose to get the news that has the highest number of comments in last week:</p>\n\n<pre><code>$timeago = strtotime(\"-1 week\");\n\n$query = \"SELECT * , \n    news.id, \n    news.title, \n    news.state, \n    news.date, \n    COUNT(comments.module_id) as comments_count, \n    comments.module, \n    comments.state \n    FROM news \n    LEFT OUTER JOIN comments on comments.module_id = news.id AND comments.module = 'news' AND comments.state = '1' \n    WHERE news.state = '2' \n    GROUP BY news.id, news.title, news.date \n    ORDER BY news.date &gt;= $timeago DESC, comments_count DESC limit 6\";\n\n$result = mysql_query($query) or die (mysql_error());\n$data = mysql_fetch_assoc($result);\n</code></pre>\n\n<p>The query servers me just right, it sorts out the news which has the highest number of comments in the last week. There is 17,290 record in news table. For this reason I am try to figure out to fix the query in a way that would be healthy for the CPU consumption.</p>\n\n<p>Any suggestions would be welcome.</p>\n\n<p>Explain plan says</p>\n\n<p>| id    | select_type   | table     | type  | possible_keys     | key   | key_len   | ref   | rows  | Extra</p>\n\n<p>| 1     | SIMPLE    | news  | ref   | state     | state     | 4     | const     | 17282     | Using where; Using temporary; Using filesort</p>\n\n<p>| 1     | SIMPLE    | comments  | ref   | module_id     | module_id     | 101   | saidasea_v2.news.id,const,const   | 4     </p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13237015,"title":"scope_identity returns null","body":"<p>I am writing a SP in SQL server</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[spAddUserBadge]\nAS\nBEGIN\nINSERT INTO dbo.SE_UserBadge\n(    \n[UID],\nBadgeID,\nBadgeAssignmentOrRenewalDate,\nBadgeExpiryDate ,\nAmountPaid, \nRemarks ,\nAssignedBy          \n)\nVALUES\n(\n17,1, 12-12-2012, 12-12-2013, 0.00, '', ''\n)\nSELECT SCOPE_IDENTITY() AS id    \nEND\nGO\n</code></pre>\n\n<p>SCOPE_IDENTITY is coming as NULL. where I am wrong?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":451,"score":0,"question_id":10834610,"title":"Date of inserting a row into table ","body":"<p>Is it possible to find date+time when a row was inserted into a table in SQL Server 2005?</p>\n\n<p>Does SQL Server log insert commands?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13237853,"title":"SQL Server Procedure Bad Cache Planning","body":"<p>I have some SQL code that uses PetaPoco that executes using sp_executesql. The query has 3 parameters: 2 dates and one string (as varchar(5)).</p>\n\n<p>The query takes 3 minutes to run - from the app or SSMS. If I run the same code in SSMS without sp_executesql (or parameters) it runs in 10 seconds and if I add the OPTION (OPTIMIZE FOR UNKNOWN) hint to the original code (using the sp) it runs in 3 seconds. I have cleared the cache using </p>\n\n<pre><code>  CHECKPOINT;\n  GO\n  DBCC DROPCLEANBUFFERS;\n  GO\n  DBCC FREEPROCCACHE;\n  GO\n</code></pre>\n\n<p>And I still can't get it to run as expected. It seems that adding the option to every query is a hack. Am I missing something?</p>\n"},{"tags":["php","sql","date-of-birth"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":56,"score":-3,"question_id":13237602,"title":"get age from date of birth?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1572110/how-to-calculate-age-in-years-based-on-date-of-birth-and-getdate\">How to calculate age (in years) based on Date of Birth and getDate()</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to echo a persons age from their date of birth which is stored in mysql table. is there a piece of code i can put in?</p>\n\n<p>At the moment it just displays the date of birth, because that's all i've asked it to do but i would like a way of showing the age instead if this is possible.</p>\n\n<p>Here's the while loop in users.php:</p>\n\n<pre><code> &lt;?\n\n            $platinum_set = get_platinum_user();\n            while ($platinum = mysql_fetch_array($platinum_set)) {\n                echo\"\n                &lt;div class=\\\"platinumcase\\\"&gt;\n                &lt;a href=\\\"profile.php?id={$platinum['id']}\\\"&gt;&lt;img width=80px height= 80px src=\\\"data/photos/{$platinum['id']}/_default.jpg\\\" class=\\\"boxgrid\\\"/&gt;&lt;/a&gt;&lt;h58&gt; {$platinum['first_name']} {$platinum['last_name']}&lt;/h58&gt;&lt;br/&gt;&lt;br/&gt;\n\n    &lt;h52&gt;{$platinum['dob']}&lt;br/&gt;\n\n\n&lt;br/&gt;{$platinum['location']}&lt;/h52&gt;\n                    &lt;/div&gt;\";\n                }\n            ?&gt;\n</code></pre>\n\n<p>Here's the function:</p>\n\n<pre><code>function get_platinum_user() {\n            global $connection;\n            $query = \"SELECT *\n                        FROM ptb_users, ptb_profiles\n                        WHERE ptb_users.account_type = \\\"User\\\"\n                        AND ptb_users.account_status = \\\"Active\\\"\n                        AND ptb_profiles.user_id = ptb_users.id\n                        AND ptb_users.subscription = \\\"Platinum\\\"\n                        LIMIT 0 , 30\";\n            $platinum_set = mysql_query($query, $connection);\n            confirm_query($platinum_set);\n            return $platinum_set;\n        }\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":13232097,"title":"how i can get 0 for no records using mysql?","body":"<p>I am new to mySql.  I have to calculate the count of clicks from table as per the week days.</p>\n\n<p>Here period depends upon database. But what happens is if last week does not have records, it was not in the list. But I need it as 0. So for that how I can do?</p>\n\n<pre><code>SELECT CASE \n    WHEN PERIOD &gt;= NOW() - INTERVAL 4 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 3 WEEK THEN '22-28 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 3 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 2 WEEK THEN '15-21 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 2 WEEK\n        AND PERIOD &lt; NOW() - INTERVAL 1 WEEK THEN '8-14 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 1 WEEK\n                THEN 'up to 7 days ago'\n           END WeekPeriod, IFNULL(count(CLICKS),0) TotalClicks\n\nFROM TABLE\n\nWHERE PERIOD &gt;= NOW() - INTERVAL 4 WEEK\n\nGROUP BY CASE \n    WHEN PERIOD &gt;= NOW() - INTERVAL 4 WEEK\n                    AND PERIOD &lt; NOW() - INTERVAL 3 WEEK THEN '22-28 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 3 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 2 WEEK THEN '15-21 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 2 WEEK\n                AND PERIOD &lt; NOW() - INTERVAL 1 WEEK THEN '08-14 days ago'\n\n    WHEN PERIOD &gt;= NOW() - INTERVAL 1 WEEK\n                THEN '01 to 7 days ago'\n\nEND\n ORDER BY WeekPeriod\";\n</code></pre>\n\n<p>answer should be like this </p>\n\n<pre><code>1-7 0 \n8-15 14 \n16-21 34 \n21-28 45\n</code></pre>\n"},{"tags":["sql","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13236643,"title":"SQL (Access) - Only Show Row With More Information","body":"<p>Good morning.</p>\n\n<p>I am currently building a report that features Name, Document type, and Expiration Date. The query is based on whether or not the document was ever requested (=yes) and the individual's role/position. Sadly, due to how the database was designed and how the users have used it, a person may have two roles (Lead Coordinator/Coordinator), and as such, two separate entries (IDs) in the database. However, the users have often only entered in the \"Expiration Date\" for one of those entries.</p>\n\n<p>Thus, now when I have queries gathering Name, Document, and Expiration Date for each role and then combining them via Union, there may be multiple entries per person, such as:</p>\n\n<pre><code>Smith, John AAA 11-5-2012\nSmith, John AAA\nDoe, Jane AAA \nDoe, Jane AAA 11-11-2011\n</code></pre>\n\n<p>Is there a way that I am able to keep the row that has more information? </p>\n\n<p><em>NOTE</em> I do NOT want to due it based on \"Date &lt;> Null\" because sometimes we may have requested the document but we have not received it yet to enter the Expiration Date and we need to be able to see this data in case we need to request it once again.</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":34,"score":-2,"question_id":13237623,"title":"Copy data into another table","body":"<p>How to copy (append) data from one table into another table with same schema in SQL Server?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I mean to say there is query </p>\n\n<pre><code>select * \ninto table1 \nfrom table2 \nwhere 1=1 \n</code></pre>\n\n<p>which creates <code>table2</code> with the same structure as <code>table1</code>. </p>\n\n<p>So is there any short query like this to only copy entire data only into an already existing table?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13237509,"title":"New user with just USAGE previleges was able to drop a table (MySQL)","body":"<p>I logged into MySQL from root user.</p>\n\n<p>Ran the command:-</p>\n\n<pre><code>create user new;\n</code></pre>\n\n<p>Then I logged in as user new. Ran the following commands:-</p>\n\n<pre><code>use test;\nshow grants;\n</code></pre>\n\n<p>The Output was:-</p>\n\n<pre><code>GRANT USAGE ON *.* TO ''@'LOCALHOST'\n</code></pre>\n\n<p>As I understand, the new user does not have the drop table permissions or any permissions for that matter (except USAGE) on this table.</p>\n\n<p>However when I run the following:-</p>\n\n<pre><code>DROP TABLE test_table;\n</code></pre>\n\n<p>The query is successful. Could you please explain why is this happening? How do I disable this user from dropping tables and revoke other permissions from this user.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13237659,"title":"is there a mechanism similar to operator overload in mysql?","body":"<p>suppose I have a table which has a column days('mon','tue','wed','thu','fri'), how do I implement a days-of-week order (rather than lexicographical order) to them?</p>\n\n<p>eg.</p>\n\n<pre><code>'mon'&lt;'tue' //produce true\n\n'fri'&gt;'wed' //true\n\n'fri'&lt;'thu' //false\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","sql-server","xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13237407,"title":"SQL Server XML query: how to select values?","body":"<p>How to select file names from xml like this, i.e.\nI need only names:</p>\n\n<pre><code>c:\\temp\\f1.txt\nc:\\temp\\f2.txt\n</code></pre>\n\n<p>XML like this:</p>\n\n<pre><code>&lt;root name=\"name\" id=\"12\"&gt;\n&lt;class1&gt;\n     &lt;file name=\"c:\\temp\\f1.txt\"&gt;\n&lt;/class1&gt;\n&lt;class1&gt;\n   &lt;subclass1&gt;\n        &lt;file name=\"c:\\temp\\f2.txt\"&gt;\n    &lt;/subclass1&gt;\n&lt;/class1&gt;\n&lt;/root&gt;\n</code></pre>\n"},{"tags":["php","mysql","sql","api","rate-limiting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13237287,"title":"How to manage request limited API calls","body":"<p>I am using tmdb API that has a new limit on requests which is 30 requests in 10 seconds per IP. I could track these calls by having a table in MySQL that holds the amount of requests per the last 10 seconds but how can I accomplish this with the different IP addresses?</p>\n\n<p>The way my app works is:</p>\n\n<ol>\n<li><p>request is made to the application server from a desktop app. Server side php then makes a search and returns data.</p></li>\n<li><p>desktop app then makes a different call to app server and that in turns makes several api calls to tmdb (4-7) and other api's.</p></li>\n</ol>\n\n<p>There can be anywhere from a few search requests to a few thousands in some cases. What's the best way to keep track and delay api calls to keep it below the limit?</p>\n"},{"tags":["sql","database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13235236,"title":"Can't add new SQL database - error 26 - web developer 2010","body":"<p>My whole project is a Default.aspx and a web.config. When i go to add new item > SQL Server Database, i get this error:</p>\n\n<pre><code>i.stack.imgur.com/0kbia.png\n</code></pre>\n\n<p>I have looked around the internet for the past couple of hours and i just cant find anything :(\nplease keep in mind i am still a beginner so simple, detailed explanations are very welcome\nthank you! :)</p>\n"},{"tags":["mysql","sql","mysql-workbench"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":47,"score":-1,"question_id":13236745,"title":"Count query with 3 columns in SQL","body":"<p>I have one database named \"Library\" with table named \"Medien\".\nHaving multiple columns among them i need to query for the following coloumn named as Fname,Mname,Lname and ISBN.</p>\n\n<p><strong>I want to calculate database total records with ISBN and without ISBN?</strong></p>\n\n<ul>\n<li>Fname = First Name of Author</li>\n<li>Mname = Middle Name of Author</li>\n<li>Lname = Last Name of Author</li>\n</ul>\n\n<p>I want to count how many record are for ISBN and how many without ISBN ?</p>\n\n<p>I have execute following command</p>\n\n<pre><code> Select COUNT(ISBN) as Fname FROM  `library`.`MEDIEN` where  Fname = `isbn`;\n Select COUNT(ISBN) as Mname FROM  `library`.`MEDIEN` where  Mname = `isbn`;\n Select COUNT(ISBN) as Lname FROM  `library`.`MEDIEN` where  Lname = `isbn`;\n Select COUNT(ISBN) as NtFname FROM `library`.`MEDIEN`where  Fname != `isbn`;\n Select COUNT(ISBN) as NtMname FROM `library`.`MEDIEN`where  Mname != `isbn`;\n Select COUNT(ISBN) as NtLname FROM `library`.`MEDIEN`where  Lname != `isbn`;\n</code></pre>\n\n<p>I am not sure i execute correct command or not.\nBecause some ISBN records have Fname,Mname or Fname,Lname or Mname,Lname or Fname , Lname,Mname only respectively.</p>\n\n<p>For example </p>\n\n<p><strong>First Author</strong></p>\n\n<p>Fname: asher\nLname: baig</p>\n\n<p>have written 5 books records but two of them with ISBN so </p>\n\n<p>Total output will be ISBN = 2</p>\n\n<p>Desire output will be like this</p>\n\n<p><code>ISBN=value and NtISBN=value</code></p>\n\n<p>Please kindly help me solving this query</p>\n"},{"tags":["c#",".net","sql","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13236919,"title":"Querying highest value by keys from database","body":"<p>With the following table:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    1    |\n|      1      |     1     |    5    |\n|      1      |     1     |    4    |\n|      1      |     2     |    7    |\n|      1      |     2     |    2    |\n|      2      |     1     |    2    |\n|      2      |     1     |    3    |\n|      2      |     2     |    2    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p>I would like to get the highest available count for given <code>Parent_ID</code> and <code>Item_ID</code>, like the following:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    5    |\n|      1      |     2     |    7    |\n|      2      |     1     |    3    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p><strong>How would I go about doing this using LINQ/SQL in C#?</strong> For example, I would like the highest item counts for parent id 1.  This would be something like:</p>\n\n<pre><code>int parentId = 1;\nvar counts = from c in database.Items where parentId == c.parentId \n//this gets all counts from items for parent id 1, but I am just looking\n//for the highest count per item for parent id 1\n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13237186,"title":"Divide one select result by another select result","body":"<p>I've looked at the other similar questions, and they seem to be a little bit different than what I'm trying to do.</p>\n\n<p>I have a single query, where I'm selecting two count values, and I want to divide one by the other.</p>\n\n<p>Here is my working code:</p>\n\n<pre><code>SELECT (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid='109'\n           AND c.course_name LIKE 'AP %' \n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY') AND  \n               to_date('08/01/2011','MM/DD/YYYY')) as AP, \n       (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid = '109'\n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY') \n           AND to_date('08/01/2011','MM/DD/YYYY')) as ttl\n FROM DUAL\n</code></pre>\n\n<p>Here is where I break it:</p>\n\n<pre><code>SELECT (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid='109'\n           AND c.course_name LIKE 'AP %' \n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY') \n           AND to_date('08/01/2011','MM/DD/YYYY')) as AP, \n       (SELECT count(DISTINCT s.lastfirst) \n          FROM students s\n          JOIN cc ON s.id = cc.studentid\n          JOIN courses c on cc.course_number = c.course_number\n         WHERE cc.schoolid = '109'\n           AND substr(cc.termid,0,1) &lt;&gt; '-'\n           AND cc.dateenrolled BETWEEN to_date('08/01/2010','MM/DD/YYYY')\n           AND to_date('08/01/2011','MM/DD/YYYY')) as ttl,\n      (AP / ttl) as pcnt\n FROM DUAL\n</code></pre>\n\n<p>Could somebody please tell me the <em>proper</em> way to do this?</p>\n\n<p>Thank You</p>\n"},{"tags":["sql","tsql"],"answer_count":6,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":13615,"score":5,"question_id":808611,"title":"SQL Count for each date","body":"<p>I have the following need</p>\n\n<p>I have a logging table which logs som leads generated each day.</p>\n\n<p>Now I need to pull a report over the amount of leads for each day over the last 10 days.</p>\n\n<p>Lets say the table looks like this:</p>\n\n<pre><code>tbl_leads\nid int,\nfirst_name nvarchar(100),\nlast_name nvarchar(100),\ncreated_date datetime\n</code></pre>\n\n<p>And I need to count the number of leads for each day, 10 days total.\nSO the result set should look something like this:</p>\n\n<pre><code>counted_leads | count_date\n5             | 2009-04-30\n7             | 2009-04-29\n5             | 2009-04-28\n7             | 2009-04-27\n</code></pre>\n\n<p>... and so on</p>\n\n<p>Anyone know how to do this the best possible way?\nMy current solution is iterating with a foreach in c# but I would very much like to hand it on the sql server instead in a sp.</p>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13235099,"title":"Primary Key and Unique Index -- sql scripts generated by SQL Developer","body":"<p>When export sql scripts by SQL Developer there are multiple options available, but either way there have to generate a <code>UNIQUE INDEX</code> on primary key like this</p>\n\n<pre><code>CREATE UNIQUE INDEX \"SYS_C0018099\" ON \"TRANSACTION\" (\"ID\") \n</code></pre>\n\n<p>and add <code>PRIMARY KEY</code> to the same table and same column</p>\n\n<pre><code>ALTER TABLE \"TRANSACTION\" ADD PRIMARY KEY (\"ID\")\n</code></pre>\n\n<p>So the question is: does it looks like kind of redundancy? I thought creating a primary key on a column should by default create an unique index on that column too? So why the first command is necessary?</p>\n\n<p>And this may cause data redundancy?</p>\n\n<p>I am on Oracle 11g so please share any ideas about why it should look like above.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","mysql","sql","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13236742,"title":"SQL Databases and table design/organization","body":"<p><em>(NOOB disclaimer)</em></p>\n\n<p>I'm working on a system (a type of map), that is accessed mostly via 3 fields: ID (auto incremented), X coordinate, and Y coordinate.</p>\n\n<p>As it is right now, i have all data on the map, stored in 1 table. Whenever the map display is loaded it simply queries the database for contents in x and y, and the DB gives the data (other fields in the same entry). If an item on the map is doing something, it has a flag saying its doing something, and then has an ID of the action in another table holding that type of 'actions'.</p>\n\n<p>Essentially, for all map data, its stored in 1 table. All actions of a certain type are stored in their own table.</p>\n\n<p>I'm a noob, and i'm wondering what the most effective/efficient structure for such a design? (a map that has items, and each item has stats/actions).</p>\n\n<p>I'm using PHP atm, using standard SQL queries to get my data. </p>\n\n<p>Should i split up the tables so that there are only x number of entries on a table? (coord range limits)? Should it just keep growing and growing?</p>\n\n<p>There's a lot of queries to the table... so just tryin to see what is best :/</p>\n"},{"tags":["sql","sql-parametrized-query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13231800,"title":"Parametrized query in Oracle","body":"<p>I have a <code>WARNINGS_INFO</code> table that contains some info on a specific warning message, such as it's code and level, and a string that describes how to print the output message.</p>\n\n<pre><code>  ID  |     CODE       | LEVEL | STR_FORMAT\n------|----------------|-------|----------------------------------------------\n  5   | attrib_missing |   3   | On cell $R:$C, attribute $ATTRIB not found\n</code></pre>\n\n<p>Let's assume I have a table <code>GENERATED_WARNINGS</code> with all the warnings generated from a SQL batch:</p>\n\n<pre><code>  WARN_ID  |  WARN_ROW_ID   \n-----------|---------------\n    5      |      32      \n</code></pre>\n\n<p>Also, I have another table with the columns <code>R</code>, <code>C</code> and <code>ATTRIB</code> and obviously a <code>ROW_ID</code> primary key column which <code>WARN_ROW_ID</code> refers to.</p>\n\n<p>Is there a way in SQL to dynamically trasduce the <code>STR_FORMAT</code> string to a string with the data from the columns of the last table?</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":68,"score":6,"question_id":13222525,"title":"Can I order by IN value","body":"<p>Can I sort by the value of an IN query?</p>\n\n<p>The following defaults to \"order item_id lowest first\" but i actually want the sort as entered... is this possible?</p>\n\n<p>e.g.</p>\n\n<pre><code>select item_id, item_title, item_source from items where item_id IN ('1676','1559','1672')\n</code></pre>\n\n<p>I want to return:</p>\n\n<pre><code>item_id     item_title    item_source\n-------     ----------    -----------\n1676        item_a        source_a\n1559        item_f        source_f\n1672        item_c        source_c\n</code></pre>\n"},{"tags":["asp.net",".net","sql","sql-server","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13235490,"title":"Archive checked records in grid view (Change 0 to 1 in database)","body":"<p>I have a grid view which pulls through data dictated by a stored procedure.</p>\n\n<p><img src=\"http://i.stack.imgur.com/S89rn.png\" alt=\"screen shot 1\"></p>\n\n<p>The stored procedure is called GetEverything.\nThe statement is made up of information from 2 tables, one with person detail, and one with vessel detail. The stored procedure select statement contains the following Where clause:</p>\n\n<pre><code>WHERE Vessel.ArchiveStatus = 0\n</code></pre>\n\n<p>By default, every new record that is created using the front end application is given a '0' for ArchiveStatus in the db.</p>\n\n<p>So, the gridview will only show me the records where the ArchiveStatus is 0, which by default is evertything.</p>\n\n<p>The 2 boxes, Check All and Uncheck All are working fully.</p>\n\n<p>What I need now is when a REF or REF(s) are selected and the button 'Archive Records' is clicked, for the 0 in the database to be updated to a 1 for that VesselREF.</p>\n\n<p>Can anoyone advise how to do this and give me some example code to put in the Default.aspx.vb file/ Event Handler for the archive records button.</p>\n\n<p>With this is place, the grid view will only display the non-archived records, and I can create a seperate grid view with its own SQL to bring through the archived records.</p>\n\n<pre><code>GridView.aspx\n\n    &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"False\" \n        DataKeyNames=\"REF,VesselREF\" DataSourceID=\"SqlDataSource1\" Height=\"132px\" \n        style=\"text-align: center; font-family: Calibri; font-size: medium\" \n        Width=\"508px\" BackColor=\"#C4FFC4\"&gt;\n        &lt;AlternatingRowStyle BackColor=\"White\" /&gt;\n        &lt;Columns&gt;\n            &lt;asp:TemplateField HeaderText=\"REF\" InsertVisible=\"False\" SortExpression=\"REF\"&gt;\n\n                &lt;ItemTemplate&gt;\n                    &lt;a href=\"Details.aspx?REF=&lt;%# Eval(\"REF\")%&gt;\"&gt;&lt;%# Eval(\"REF\")%&gt;&lt;/a&gt;\n                    &lt;asp:CheckBox ID=\"RecordSelector\" runat=\"server\" /&gt;\n                &lt;/ItemTemplate&gt;\n            &lt;/asp:TemplateField&gt;\n            &lt;asp:BoundField DataField=\"Title\" HeaderText=\"Title\" SortExpression=\"Title\" /&gt;\n            &lt;asp:BoundField DataField=\"FirstName\" HeaderText=\"FirstName\" \n                SortExpression=\"FirstName\" /&gt;\n            &lt;asp:BoundField DataField=\"Surname\" HeaderText=\"Surname\" \n                SortExpression=\"Surname\" /&gt;\n            &lt;asp:BoundField DataField=\"VesselName\" HeaderText=\"VesselName\" \n                SortExpression=\"VesselName\" /&gt;\n            &lt;asp:BoundField DataField=\"VesselREF\" HeaderText=\"VesselREF\" \n                InsertVisible=\"False\" ReadOnly=\"True\" SortExpression=\"VesselREF\" /&gt;\n\n        &lt;/Columns&gt;\n    &lt;/asp:GridView&gt;\n</code></pre>\n"},{"tags":["php","sql","mysql-table"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13235492,"title":"Select a specific row in PHP/MYSQL","body":"<p>Let's say i have a user table. And i got colomuns like ID, Username, Password and Activated.\nAll i want to know is how to write the MYSQL sentence :\nSELECT into USERS WHERE ID = $ID, INSERT (activated) Values (0)\nCan somebody say it in the right grammar?\nThanks in advance.</p>\n"},{"tags":["mysql","sql","flyway"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13235438,"title":"flyway executes \"alter table ... modify `col` auto_increment\" on MySQL but doesn't change `col` values","body":"<p>When I execute these sentences from MySQL command line or Workbench...</p>\n\n<pre><code>-- 1) Add a column `id`\nALTER TABLE `DEVICES` ADD `id` BIGINT(20) NOT NULL;\n-- 2) Add an index, necessary for auto_increment\nALTER TABLE `DEVICES` ADD index `devices_id_index`(`id`);\n-- 3) Makes `id` auto_increment and inserts sequential numbers it (from 1 to N)\nALTER TABLE `DEVICES` MODIFY `id` BIGINT(20) AUTO_INCREMENT;\n</code></pre>\n\n<p>... what I get is a new column <code>id</code> that is filled with auto-increment values from 1 to N.</p>\n\n<p>But when I execute it from <strong>flyway</strong>, the column <code>id</code> has a zero in every row because the last sentence doesn't change its values.</p>\n\n<p>Do you know why?</p>\n\n<p>Any solution/workaround besides inserting those values using a procedure?</p>\n\n<p>Thank you!</p>\n\n<p>Ferran</p>\n"},{"tags":["sql","sql-server","date","time"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2181,"score":6,"question_id":7105093,"title":"Difference between datetime and timestamp in sqlserver?","body":"<p>What is the difference between <code>Timestamp</code> and <code>Datetime</code> SQL Server?</p>\n\n<p>I thought Both formats are capable of storing date + time. Then, Where the difference is lying between them?</p>\n\n<p>But <code>Timestamp</code> is not capable of storing date, time information.</p>\n\n<p>Still Whats the difference?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":66,"score":0,"question_id":13235616,"title":"Converting INT to Time","body":"<p>I have a column in sql that is an INT and I have to convert it to time.</p>\n\n<p>I've tried </p>\n\n<pre><code>         CONVERT (VARCHAR, columnA / 600000)\n   + ':'\n   + RIGHT ('00' + CONVERT (VARCHAR, c_columnA % 60), 2)\n</code></pre>\n\n<p>but that's not the result.  Any idea's how the data might be being casted?</p>\n\n<p>Here a sample of the data:</p>\n\n<pre>\nINT |TIME\n4680001|13:00\n4680001|13:00\n4596001|12:45\n3846001|10:41\n4320001|12:00\n</pre>\n"},{"tags":["sql","query","count"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13235981,"title":"Count number of occurrences for each unique value","body":"<p>Basically I have a table similar to this:</p>\n\n<pre><code>time.....activities.....length  \n13:00........3.............1  \n13:15........2.............2  \n13:00........3.............2  \n13:30........1.............1  \n13:45........2.............3  \n13:15........5.............1  \n13:45........1.............3  \n13:15........3.............1  \n13:45........3.............2  \n13:45........1.............1  \n13:15........3.............3  \n</code></pre>\n\n<p>A couple of notes:</p>\n\n<ul>\n<li>Activities can be between 1 and 5</li>\n<li>Length can be between 1 and 3</li>\n</ul>\n\n<p>The query should return:</p>\n\n<pre><code>time........count  \n13:00.........2  \n13:15.........2  \n13:30.........0  \n13:45.........1  \n</code></pre>\n\n<p>Basically for each unique time I want a count of the number of rows where the activities value is 3.</p>\n\n<p>So then I can say: </p>\n\n<pre><code>At 13:00 there were X amount of activity 3s.\nAt 13:45 there were Y amount of activity 3s.\n</code></pre>\n\n<p>Then I want a count for activity 1s,2s,4s and 5s. so I can plot the distribution for each unique time.</p>\n"},{"tags":["sql","vb.net","ms-access"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13236085,"title":"VB.NET MDB creating a table command and Autonumber type","body":"<p>i am using the following command to create a table in an mdb database, it works fine when i remove the autonumber type</p>\n\n<pre><code>\"CREATE TABLE pxs(sid Autonumber , Adress Text , Port Text, user Text, pass Text, sreq Integer, freq Integer)\"\n</code></pre>\n\n<p>so how should i define an id column as autonumber?</p>\n"},{"tags":["php","sql","mysql","sql-injection"],"answer_count":22,"favorite_count":518,"up_vote_count":852,"down_vote_count":4,"view_count":113984,"score":848,"question_id":60174,"title":"Best way to prevent SQL injection?","body":"<p>If user input have inserted into an SQL query directly, the application becomes vulnerable to <a href=\"http://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain/332367#332367/1228\">SQL injection</a>, like in the following example:</p>\n\n<pre><code>$unsafe_variable = $_POST['user_input'];\n\nmysql_query(\"INSERT INTO table (column) VALUES ('\" . $unsafe_variable . \"')\");\n</code></pre>\n\n<p>That's because the user can input something like <code>VALUE'); DROP TABLE table;--</code>, making the query:</p>\n\n<pre><code>INSERT INTO table (column) VALUES('&lt;strong&gt;VALUE'); DROP TABLE table;--&lt;/strong&gt;')\n</code></pre>\n\n<p>What should one do to prevent this?</p>\n"},{"tags":["sql","database","sql-server-2008","query","insert"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13235606,"title":"SQL query :Copy one table to another from different servers","body":"<p>What's wrong with my query, I want to copy three columns to another server\\table if one of the column (ID_DIRCT) is not null :</p>\n\n<pre><code>INSERT INTO  System\\Syst3.Server1.dbo.TABLE_RESRC (NO_EMPLY,PR,NM_FAML,CO_DIRCT)\nSELECT NO_EMPLY, PR_EMPLY, NM_EMPLY, ID_DIRCT \nFROM System\\Syst3.Server2.dbo.RESRC\nWHERE System\\Syst3.Server2.dbo.RESRC.ID_DIRCT IS NOT NULL\n</code></pre>\n\n<p>Using SQL Server 2008 R2.</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":133,"score":10,"question_id":13235382,"title":"Double IN Statements in SQL","body":"<p>Just curious about the IN statement in SQL.\nI know I can search multiple columns with one value by doing</p>\n\n<pre><code>'val1' IN (col1,col2)\n</code></pre>\n\n<p>And can search a column for multiple values</p>\n\n<pre><code>col1 IN ('val1','val2')   \n</code></pre>\n\n<p>But is there a way to do both of these simultaneously, without restorting to an repeating AND / OR in the SQl? I am looking to do this in the most scalable way, so independent of how many vals / cols i need to search in.\nSo essentially:</p>\n\n<pre><code>('val1','val2') IN (col1,col2)\n</code></pre>\n\n<p>but valid.</p>\n"},{"tags":["sql","tsql","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":46,"score":-1,"question_id":13235429,"title":"Tsql subquery in where clause","body":"<p>I have an error message:</p>\n\n<blockquote>\n  <p>There was an error parsing the query. [ Token line number = 5,Token\n  line offset = 4,Token in error = select ]</p>\n</blockquote>\n\n<p>When I try to execute this query:</p>\n\n<pre><code>select ename, loc\nfrom emp e join dept on (e.deptno = dept.deptno)    \nwhere\n    e.sal &gt;\n        (select avg(sal)\n        from emp\n        group by job\n        having job = e.job);\n</code></pre>\n"},{"tags":["sql","oracle","constraints","check"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13235273,"title":"SQL CHECK CONSTRAINT VARCHAR","body":"<pre><code>create table table1\n(\n  column1 varchar2(8)\n  check constraint column1_ch check ........\n);\n</code></pre>\n\n<p>How do I do a check for a data that the first 4 char is a specific set of alphabets while the last 4 is numbers? and as well as a range of values.</p>\n\n<p>examples, data can be ABCD2121, ABCD1111.</p>\n\n<p>range - ABCD0001 to ABCD9999</p>\n\n<p>So 'ABCD' is fixed while the numbers are changing.</p>\n\n<p>I've foudn online about using '[]\" to define the numbers but i'm not able to integrate it into my constraint.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13186889,"title":"Getting multiple different values from a joined table","body":"<p>I can't figure out a good way of querying this without multiple sub-queries. I can't restructure the tables, so that's not an option. Here's the setup:</p>\n\n<pre><code>person:\nperson_id\nperson_want_id,\nperson_need_id,\nperson_ability_id,\nperson_willingness_id\n\nperson_status_types:\nstatus_type_id\nstatus_type_name\n</code></pre>\n\n<p>Each one of the id's that are in person is of type person_status_types. What I need to pull out is the status_type_name for each of the id's in person. </p>\n\n<p>So the return statement would look like this:</p>\n\n<pre><code>person_id | person_want_name | person_need_name | person_ability_name | person_willingness_name\n</code></pre>\n\n<p>Right now I'm just doing 4 subqueries, but there has to be a cleaner way of doing it. Also, if you want to mention a better database structure, I'm open minded to it for future database production.</p>\n"},{"tags":["sql","sql-server-2008","where-clause"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13234075,"title":"Filtering data from 3 tables on 2 columns not giving good result","body":"<p>so i have 3 tables 1 table is used to get all the good numbers from \nthe second table will contain the date thats needs to be between 2 dates \nand the third table has the information numbers i whant so i tryd something like this but getting wrong results.</p>\n\n<pre><code> select columns,\n   (\n     select \n       SUM(column) \n     from \n       table3 \n     where \n       (column is null or column &lt;&gt; 4) \n         and table3nrcolumn = table1nrcolumn \n         and othercolumnnr from table3 in\n           (\n             select \n               column \n             from \n               table2 \n             where \n               (column is null or column &lt;&gt; 4) \n               and (column_datum between '2012-10-29' and '2012-11-04'))) \n                  as result\nfrom \n  table1\n</code></pre>\n\n<p>but i am getting wrong results i think because of the date between but i cant figure out wy hope someone can help</p>\n\n<p>Sorry for the late reaction but i whas working on on something else and Tanx for the fast reaction il try to make it a bit more clear</p>\n\n<p>select id, naam, prijs,\n(select SUM(aantal) from TABLE2 where (nr is null or nr &lt;> 4) and id_TABLE2 = id_TABLE1 and other_nr_TABLE2 in\n(select other_nr from TABLE3 where (nr is null or nr &lt;> 4) and (datum >= '2012-10-29' and datum &lt;= '2012-11-04'))) as resultset\nfrom TABLE1</p>\n\n<p>Table 1 contains writing material Contains All posible rows \nTable 2 contains writing material thats packed togetor under other_nr Can Contain more ROWS\nTable 3 contains packed name under other_nr with a date Contains 1 row</p>\n\n<p>so i need the material from a date range out table 2 that has a connection with table 3 under other_nr And i need to select a date range from table 3 and get the Materials from table 2</p>\n\n<p>hope its a bit more clear now\nVerry srry but i still dont get the tags needed for code</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198395,"title":"Select with SQL the oldest payment associated to a list of persons","body":"<p>Having troubles with a SQL query on an Oracle database (11G I think).</p>\n\n<p>I need to make a query on two tables. The first one contains identifiers of persons. The second one contains payments (you can consider it as salaries), each record associated to the person with a foreign key.</p>\n\n<p>What I need to do is retrieve, for a known list of persons (let's say identifiers 1, 2, 5 and 10), the oldest payment (based on the payment date).</p>\n\n<p>What I made first is this : </p>\n\n<pre><code>select id_person, MIN(payment_date) \nfrom payment where id_person in (1, 2, 5, 10)\ngroup by id_person;\n</code></pre>\n\n<p>This retrieves something like :</p>\n\n<pre><code>1   19940623\n2   20100429\n5   20100204\n10  20100111\n</code></pre>\n\n<p>Now, how do I get, for each person, the complete record of the ´payment´ table which correspond to the oldest payment ?</p>\n\n<p>I cannot figure out a way of doing this...</p>\n\n<p>The answer must be in a single SQL query (I cannot make a call for each person, which would be very easy to do...)</p>\n"},{"tags":["java","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13234550,"title":"how to use specials characters in the variables declaration in java?","body":"<p>Is it possible to declare java attribute name using specials characters, exemple:</p>\n\n<pre><code>private String var/name;\nprivate int one+one;\n</code></pre>\n\n<p>I ask this question because I need to retrieve data from DB, whose the name of one colomn is <code>annoces/status</code>, And I need to use sql query (not hql or criteria)</p>\n"},{"tags":[".net","sql","intersect"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13234872,"title":"Intersect between some DbGeography elements doesn´t work with Entity Framework 5","body":"<p>What is wrong with that?</p>\n\n<pre><code>const string lonMin=\"-19\";      \nconst string latMin = \"25\";\nconst string lonMax = \"-24\";\nconst string latMax = \"25.6\";\n\n//Create a polygon\nvar geoEncuadre = DbGeography.FromText(\"POLYGON ((\" + lonMin + \" \" + latMin + \",\" +\n            lonMax + \" \" + latMin + \",\"+ lonMax + \" \"+ latMax +\",\"+lonMin+\" \" + latMax +\",\"+lonMin + \" \"+latMin +  \"))\", 4326);\n//Check for every node if intersects with the polygon\nvar nodos = (from n in _bd.Nodo\n             where n.Geo.Intersects(geoEncuadre)\n             select n).ToList();\n</code></pre>\n\n<p>This throws an <code>EntityCommandExecutionException</code>. It´s weird because if I use <em>DbGeometry</em> instead <em>DbGeography</em> it works fine. \nWhat happen with the <em>DbGeography</em> and the <em>Intersect</em> operation?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":13235042,"title":"Changing order row in MySQL table","body":"<p>Is there any way to change the order of rows in a MySQL table?<br>\nI want to change the order what will be returned for the most basic query:</p>\n\n<pre><code>SELECT * FROM table\n</code></pre>\n\n<p>I have access just to the database. The query doesn't contain ORDER BY part.</p>\n"},{"tags":["c#","sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13234505,"title":"Function remains INVALID only when using System.Data.OracleClient, works through SQL Developer","body":"<p>I'm using C# and System.Data.OracleClient to add functions to a database. This works for most functions, except one. The function is created but its state is INVALID. After examining the cause for this invalid state, I noticed I could simply compile the function within SQL Developer, but not from my c# application.</p>\n\n<p>Any ideas why there is a difference using .NET  and SQL Developer?</p>\n\n<p>This is the function I use</p>\n\n<pre><code>string sql =\n   @\"CREATE OR REPLACE FUNCTION MYUSER.TEMPJOINSTRINGS \n    ( P_CURSOR SYS_REFCURSOR, \n      P_DEL VARCHAR2 := ', '\n    ) RETURN VARCHAR2\n   IS\n     L_VALUE VARCHAR2(32767);\n     L_RESULT VARCHAR2(32767);\n   BEGIN\n   LOOP\n     FETCH P_CURSOR INTO L_VALUE;\n     EXIT WHEN P_CURSOR%notfound;\n     IF L_RESULT IS NOT NULL THEN\n       L_RESULT := L_RESULT || P_DEL;\n     END IF;\n     L_RESULT := L_RESULT || L_VALUE;\n   END LOOP;\n   RETURN L_RESULT;\n   END;\";\n\ntry\n{\n    using (OracleConnection connection = new OracleConnection(@\"Data source=TEST10;User Id=MYUSER;Password=MYPASS;\"))\n    {\n        connection.Open();\n        DbCommand cmd = connection.CreateCommand();\n        cmd.CommandText = sql;\n        cmd.ExecuteNonQuery();\n        connection.Close();\n        return true;\n    }\n}\ncatch (Exception ex)\n{\n    MessageBox.Show(ex.Message);\n}\n</code></pre>\n\n<p>and after that I execute</p>\n\n<pre><code>ALTER FUNCTION MYUSER.TEMPJOINSTRINGS COMPILE\n</code></pre>\n\n<p>But compiling will only work from SQL Developer, not my c# application.</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13235048,"title":"Multiple Rows in INSERTED table","body":"<p>On a table in MS SQL Server I need to run a CLR Stored Procedure on new rows if those rows meet certain criteria.  I thought that would be more or less straightforward:</p>\n\n<pre><code>if ((SELECT Cabinet FROM INSERTED) = 1 OR (SELECT Cabinet FROM INSERTED) = 3) AND (SELECT Result_02 FROM INSERTED) = 'N'\nBEGIN\n    DECLARE @id int\n    SET @id = (SELECT ID FROM INSERTED)\n    exec PrintLabel\n        @id,\n        N'LP 2844 LGE'\nEND;\n</code></pre>\n\n<p>However, this recently started throwing errors about a subquery returning multiple rows. I learned that INSERT triggers run once for each statement, not necessarily on individual rows. So, that IF statement can be working on multiple rows, and thus the error.</p>\n\n<p>My question is: how can I iterate over each new row if the rows are added in a batch (in this case via a MERGE statement). </p>\n"},{"tags":["asp.net","sql","asp.net-mvc","ms-access","gridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":13055331,"title":"How to alter table (add/delete column) dynamically and update it to gridview","body":"<p>I need gridview to get updated after I add new field to the table, below is the code</p>\n\n<pre><code>Protected Sub drpDataType_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles drpDataType.SelectedIndexChanged\n    Dim cnnOLEDB As New OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:/Documents and Settings/My Documents/Visual Studio 2008/Projects/WebApplication1/WebApplication1/App_Data/Asset.mdb;\")\n    Dim alterSql As String\n    alterSql = \"ALTER TABLE LAB1 ADD \" + txtColumnName.Text + \" \" + drpDataType.SelectedValue\n    Dim type As String = drpDataType.SelectedValue\n    Dim cmdOLEDB As New OleDbCommand        \n    cnnOLEDB.Open()\n    cmdOLEDB = New OleDbCommand(alterSql, cnnOLEDB)\n    cmdOLEDB.ExecuteNonQuery()\n    cnnOLEDB.Close()\n    Dim tb1 As New DataTable\n    tb1.Columns.Add(txtColumnName.Text)\n    GridView1.DataSourceID = String.Empty\n    Me.GridView1.DataSource = tb1\n    Me.GridView1.DataBind()\nEnd Sub\n</code></pre>\n\n<p>I get this error \"Both DataSource and DataSourceID are defined on 'GridView1'.  Remove one definition\" I understand this because I have set the DataSourceID to AccessDataSource, now if I set it to empty I don't see anything in the gridview not even the tb1. Can anyone help me get this working, any help is appreciated. Thanks!</p>\n\n<p>Edit: Gridview </p>\n\n<pre><code> &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AllowSorting=\"True\" \n              ShowFooter=\"True\" EmptyDataText=\"There are no records for the selection\"  \n              AutoGenerateColumns=\"False\" AutoGenerateDeleteButton=\"False\"  \n              AutoGenerateEditButton=\"False\" CellPadding=\"4\"  OnRowCommand=\"Insert_Click\"\n              DataKeyNames=\"Lab Name\" DataSourceID=\"AccessDataSource8\"/&gt;\n              &lt;Columns&gt;\n                  &lt;asp:TemplateField ShowHeader=\"False\"&gt;\n                      &lt;EditItemTemplate&gt;\n                          &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" CausesValidation=\"True\" \n                              CommandName=\"Update\" Text=\"Update\"&gt;&lt;/asp:LinkButton&gt;\n                          &amp;nbsp;&lt;asp:LinkButton ID=\"LinkButton2\" runat=\"server\" CausesValidation=\"False\" \n                              CommandName=\"Cancel\" Text=\"Cancel\"&gt;&lt;/asp:LinkButton&gt;\n                      &lt;/EditItemTemplate&gt;\n                      &lt;ItemTemplate&gt;\n                          &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" CausesValidation=\"False\" \n                              CommandName=\"Edit\" Text=\"Edit\"&gt;&lt;/asp:LinkButton&gt;\n                          &amp;nbsp;&lt;asp:LinkButton ID=\"LinkButton2\" runat=\"server\" CausesValidation=\"False\" \n                              CommandName=\"Delete\" Text=\"Delete\" OnClientClick=\"return confirm('Are you sure?');\" &gt;&lt;/asp:LinkButton&gt;\n                      &lt;/ItemTemplate&gt;\n                      &lt;FooterTemplate&gt;\n                     &lt;asp:LinkButton ID=\"LinkButton\" runat=\"server\" CommandName=\"Insert\" Text=\"Insert\" ValidationGroup=\"validate\" &gt;&lt;/asp:LinkButton&gt;\n                     &lt;/FooterTemplate&gt;\n                  &lt;/asp:TemplateField&gt;\n\n                  &lt;asp:TemplateField HeaderText=\"Lab Name\" SortExpression=\"Lab Name\"&gt;\n                      &lt;ItemTemplate&gt;\n                          &lt;asp:Label ID=\"Label1\" runat=\"server\" Text='&lt;%# Bind(\"[Lab Name]\") %&gt;'&gt;&lt;/asp:Label&gt;\n                      &lt;/ItemTemplate&gt;\n                      &lt;EditItemTemplate&gt;\n                          &lt;asp:Label ID=\"Label1\" runat=\"server\" Text='&lt;%# Eval(\"[Lab Name]\") %&gt;'&gt;&lt;/asp:Label&gt;\n                      &lt;/EditItemTemplate&gt;\n                      &lt;FooterTemplate&gt;\n                          &lt;asp:TextBox ID=\"txtLabname\" runat=\"server\" &gt;&lt;/asp:TextBox&gt;\n                          &lt;asp:RequiredFieldValidator ID=\"LabName\" runat=\"server\" ControlToValidate=\"txtLabname\" Text=\"*\" ValidationGroup=\"validate\"/&gt;\n                      &lt;/FooterTemplate&gt;\n            &lt;/Columns&gt;\n          &lt;/asp:GridView&gt; \n</code></pre>\n"},{"tags":["sql","database","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13233495,"title":"Using \"power of two numbers\" for length of database columns","body":"<p>I always try to use power of two numbers to define the length of my database columns, either VARCHAR or CHAR type.</p>\n\n<p>Researching by Internet and debate with partners we do not achieve clarify anything about that, if it take advantaged of full clusters usage or something like that, so the question es simple:</p>\n\n<p><strong>Is it better use power of two numbers to define the length of the database VARCHAR and CHAR columns?</strong></p>\n"},{"tags":["php","mysql","sql","sql-injection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13234068,"title":"PHP Mail sanitisation techniques","body":"<p>Im working on building my first contact form. </p>\n\n<p>I have a page similar to this with a lot of fields... \n<a href=\"http://www.missingpeople.org.uk/component/option,com_rsform/Itemid,144/lang,en/view,rsform/\" rel=\"nofollow\">http://www.missingpeople.org.uk/component/option,com_rsform/Itemid,144/lang,en/view,rsform/</a></p>\n\n<p>The form, when submitted then redirects to my process page that contains...</p>\n\n<pre><code>&lt;?php\n\nforeach ($_POST as $key =&gt; $value)\n$message .= \"Field \".htmlspecialchars($key).\" is \".htmlspecialchars($value).\"\\r\\n\";\n\nmail('liam@site.co.uk', 'sghting', $message); \n\n?&gt;\n</code></pre>\n\n<p>From what I've been reading on the process though this seems vulnerable to injections? sorry if this sounds naive im new to the process. What Im asking is where do i start in reading up on sanitizing this code? </p>\n"},{"tags":["html","sql","xml","sql-server-2008","import"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13234725,"title":"Importing XML into SQL Server 2008 including html tags","body":"<p>I need to import an XML file into a SQL Server 2008 table. One of the XML tags contains valid HTML tags which I want also want imported. Below is one of my elements, as you can see the descriptor tag contains HTML tags which I would like included in the import.</p>\n\n<pre><code>&lt;criterionlist&gt;\n    &lt;element&gt;\n         &lt;subjectname&gt;Humanities&lt;/subjectname&gt;\n         &lt;criterion&gt;A&lt;/criterion&gt;\n         &lt;phase&gt;1&lt;/phase&gt;\n         &lt;level&gt;1&lt;/level&gt;\n         &lt;descriptor&gt;The student: &lt;li&gt; makes &lt;b&gt;a limited attempt&lt;/b&gt; to use &lt;b&gt;some&lt;/b&gt; relevant terminology &lt;/li&gt;\n        &lt;li&gt; demonstrates &lt;b&gt;basic&lt;/b&gt; knowledge and understanding of content and concepts through &lt;b&gt;some&lt;/b&gt; descriptions and/or examples.&lt;/li&gt; &lt;/descriptor&gt;\n    &lt;/element&gt;\n</code></pre>\n\n<p>Is this possible? I managed to import the file into a table using <code>OPENROWSET</code>, but it ignores the HTML tags..</p>\n\n<p>Many thanks,\nDave.</p>\n"},{"tags":["sql","sql-server","ssas","sql-server-2012","xmla"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13148511,"title":"Add attribute to cube and reprocess without original database","body":"<p>Every year we keep a historical copy of one of our cubes. This year someone decided they wanted to pay us money to add an attribute to the cube which did not previously exists. Fine, I like money,  but the issue is we don't have a backup of the database that we built this cube off of. </p>\n\n<p>So a question arises in my head, do we need that original database to add a new attribute to this cube? Is it possible for us to add a new attribute to the cube and only process this attribute without having the cube orignal datasource? </p>\n\n<p>Not having a great understanding of what is happening under the hood when I add an attribute to a SSAS cube and process, I can't say if this is or isn't possible. I could imagine that possibly, the cube has a snapshot in memory of the datasource that it can work off of. I can also imagine that this would be ridiculously inefficient so there is a chance this is no way in heck possible</p>\n\n<p>EDIT: It at least would seem feasible to add a calculated member that makes use of existing data in the cube.</p>\n\n<p>I also should mention that I tried to add an attribute to such a cube and received an error:</p>\n\n<blockquote>\n  <p>\"Dimension [Partner] cannot be saved  File system error failed to copy\n  file C:\\\\MYSQLSERVER\\OLAP\\DATA\\2013_Cube.db\\\\.dim\\.dstore  to C:\\\\MYSQLSERVER\\OLAP\\DATA\\2013_Cube.db\\\\.dim\\.dstore  file exists\"</p>\n</blockquote>\n\n<p>Sorry I faked those filepaths a little. </p>\n"},{"tags":["sql","oracle","max","top-n"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13233620,"title":"Returning max value and value prior","body":"<p>I have a query I run to tell me the latest note for active participants:</p>\n\n<pre><code>select notes.applicant_id,\n   reg.program_code,\n   reg.last_name,\n   reg.first_name,\n   reg.status_cd,\n   MAX(notes.service_date) as \"Last Note\"\nfrom reg inner join notes on reg.applicant_id=notes.applicant_id\nwhere reg.status_cd='AC'\ngroup by notes.applicant_id, reg.program_code, \n         reg.last_name, reg.first_name, reg.reg_date, \n         reg.region_code, reg.status_cd\norder by MAX(notes.service_date)\n</code></pre>\n\n<p>But I would also like this query to give me the result of the <code>note.service_date</code> just prior to the max <code>service_date</code> as well. </p>\n\n<p>Results would look like this </p>\n\n<pre><code>notes.applicant_id   reg.last_name  reg.first_name reg.status_cd  Last Note    Prior Note\n 12345                 Johnson          Lori           AC        01-NOV-2011   01-OCT-2011\n</code></pre>\n\n<p>I am working in oracle.</p>\n"},{"tags":["sql","sql-server","sql-server-2005","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13202697,"title":"Updating a set of data from the output of a Table Valued Function","body":"<p>I am trying to write up a query that are merging duplicate client records in to a single record. Right now I am just building a mapping table to know what I should map with what.</p>\n\n<p>Here are the two functions I wrote to aid me in this</p>\n\n<pre><code>CREATE FUNCTION FindDuplicateClients ()\nRETURNS TABLE AS RETURN \n(\n    select distinct CLIENT_GUID \n    from CLIENTS c\n    inner join\n    (\n        select FIRST_NAME, LAST_NAME, HOME_PHONE\n        from CLIENTS\n        group by FIRST_NAME, LAST_NAME, HOME_PHONE\n        having COUNT(*) &gt; 1\n    ) t on c.FIRST_NAME = t.FIRST_NAME and c.LAST_NAME = t.LAST_NAME and c.HOME_PHONE = t.HOME_PHONE)\ngo\n\n--Find other clients that map to this client\nCREATE FUNCTION FindDuplicateClientsByClient (@Client uniqueidentifier)\nRETURNS TABLE AS RETURN \n(\n    select distinct CLIENT_GUID \n    from CLIENTS c\n    inner join\n    (\n        select x.FIRST_NAME, x.LAST_NAME, x.HOME_PHONE\n        from CLIENTS x\n        inner join \n        (\n            select FIRST_NAME, LAST_NAME, HOME_PHONE\n            from CLIENTS\n            where CLIENT_GUID = @Client\n        ) y on x.FIRST_NAME = y.FIRST_NAME and x.LAST_NAME = y.LAST_NAME and x.HOME_PHONE = y.HOME_PHONE\n        group by x.FIRST_NAME, x.LAST_NAME, x.HOME_PHONE\n        having COUNT(*) &gt; 1\n    ) t on c.FIRST_NAME = t.FIRST_NAME and c.LAST_NAME = t.LAST_NAME and c.HOME_PHONE = t.HOME_PHONE\n    where CLIENT_GUID &lt;&gt; @Client)\ngo\n</code></pre>\n\n<p>The first function successfully returns all <code>CLIENT_GUID</code>'s that have more than 1 record, the second you pass in a GUID and it returns all other guids that share the \"Common Information\" (first name, last name, and home phone in this case)</p>\n\n<p>The problem is filling out my mapping table. I have some rules I need to follow to give priority to some of the duplicates. For example anyone who has had transactions needs to not have their <code>CLIENT_GUID</code> changed, but they are able to have other GUIDs merged in to them (if the other GUIDs had no transactions)</p>\n\n<pre><code>--Create Mapping table\nselect CLIENT_GUID, CAST(null as uniqueidentifier) as NEW_CLIENT_GUID\ninto #mapping\nfrom FindDuplicateClients()\n\n--Do not map people who have transactions\nupdate #mapping\nset NEW_CLIENT_GUID = CLIENT_GUID\nwhere CLIENT_GUID in (select CLIENT_GUID from trnHistory)\n</code></pre>\n\n<p>Now here is where I am running in to trouble. I don't know how to get the list of people who had <code>NEW_CLIENT_GUID</code> set in the previous query, run <code>FindDuplicateClientsByClient</code> against that GUID, and set <code>NEW_CLIENT_GUID</code> of any result to the <code>NEW_CLIENT_GUID</code> that was fed in to the function without using a cursor.</p>\n\n<p>Here is the method I came up with using a cursor</p>\n\n<pre><code>declare cur cursor LOCAL FAST_FORWARD for select NEW_CLIENT_GUID from #mapping where NEW_CLIENT_GUID is not null\ndeclare @NEW_CLIENT_GUID uniqueidentifier\n\nopen cur\nfetch next from cur into @NEW_CLIENT_GUID\nwhile @@fetch_status = 0\nbegin\n    update #mapping\n    set NEW_CLIENT_GUID = @NEW_CLIENT_GUID\n    where CLIENT_GUID in (select CLIENT_GUID from FindDuplicateClientsByClient(@NEW_CLIENT_GUID)) --Find duplicates to this record\n        and NEW_CLIENT_GUID is null --Do not reassign values that are already set (ie: duplicates that have transactions)\n\n    fetch next from cur into @NEW_CLIENT_GUID\nend \n\nclose cur\ndeallocate cur\n</code></pre>\n\n<p>To me, iterating over each result in <code>#mapping</code> that has a value set does not seem correct to me. What would be the correct way to do this? I am using SQL Server 2008 R2 but I would prefer if it was compatible with SQL Server 2005 too.</p>\n"},{"tags":["php","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13234466,"title":"PHP inbox System","body":"<p>I have a problem with creating an inbox System. \nWhat i'm trying to do is in \"ViewMessages.php\" I am trying to pull information from a MYSQL Table to show messages. </p>\n\n<p>My First Statement is: </p>\n\n<pre><code>    $MessageQuery = mysql_query(\"SELECT * FROM messages WHERE ToUName='$ToUName' AND FromUName='$FromUName'\");\n</code></pre>\n\n<p>But I realised a flaw, it will only show  messages sent 1 way. I Tried something like:</p>\n\n<pre><code>    $MessageQuery = mysql_query(\"SELECT * FROM messages WHERE ToUName='$ToUName' AND FromUName='$FromUName' OR FromUName='$ToUName' AND ToUName='$FromUName'\");\n</code></pre>\n\n<p>This failed. Can anyone shed some light to show both messages from both parties? </p>\n"},{"tags":["mysql","sql","database","query"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13233649,"title":"MySQL: Impossible WHERE noticed after reading const table","body":"<p>A very simple query always returns an empty result set, after running EXPLAIN, this is what I got:</p>\n\n<pre><code>EXPLAIN SELECT u.id, fname\nFROM user u\nWHERE (birthdate\nBETWEEN \"1992-04-05\"\nAND \"1990-04-05\")\nLIMIT 0,20\n</code></pre>\n\n<p>No matter, if I turn birthdays arround (1990-1992), it's the same... </p>\n\n<pre><code>id  select_type table   type    possible_keys   key key_len ref rows    Extra\n1   SIMPLE  NULL    NULL    NULL    NULL    NULL    NULL    NULL    Impossible WHERE noticed after reading const table...\n</code></pre>\n\n<p>What does this error say? I only found other issues on SO where people tried to join tables, but this query is so simple, what is the matter with it? Any ideas would be highly appreciated, thank you already!</p>\n"},{"tags":["sql","oracle","database-design","constraints","data-modeling"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13233008,"title":"Foreign key on a non-unique index? (oracle)","body":"<p>I'm trying to create a constraint on table A to check if a set of records exists in a table B. I could use a foreign key, but the problem is that the data in the table B is non-unique.</p>\n\n<p>Is there a way to create such a constraint without creating a trigger?</p>\n\n<p>Edit: I can't change table B structure.</p>\n"},{"tags":["sql","oracle","unix","plsql","ksh"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6483,"score":1,"question_id":2551210,"title":"Oracle PL/SQL: Dump query result into file","body":"<p>I'm working on a pl sql stored procedure. \nWhat I need is to do a select, use a cursor and for every record build a string using values.\nAt the end I need to write this into a file.\nI try to use dbms_output.put_line(\"toto\") but the buffer size is to small because I have about 14 millions lines.\nI call my procedure from a unix ksh.\nI'm thinking at something like using \"spool on\" (on the ksh side) to dump the result of my procedure, but I don' know how to do it (if this is possible)</p>\n\n<p>Anyone has any idea?</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13234175,"title":"Use of xml.modify to insert parameters into specific element of an xml column","body":"<p>I would like to use a stored procedure to insert some values passed in as parameters into elements in the xml of a column. I have this so far\nThe following parameters:</p>\n\n<pre><code>@profile_id int,\n@user_id nvarchar(50),\n@activity_name nvarchar(50),\n@display_name nvarchar(50)\n</code></pre>\n\n<p>Retrieve the desired xml:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE profiles.value('(Profile/ID)[1]','int')= @profile_id)\n</code></pre>\n\n<p>The xml from the column inside the @profiles_xml looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;20&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;somename&lt;/Name&gt;\n    &lt;Activities&gt;\n      &lt;Activity&gt;\n         &lt;Name&gt;activity1&lt;/Name&gt;\n      &lt;/Activity&gt;\n    &lt;/Activities&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>Attempt to Insert into User with specific ID the activity name and display name:</p>\n\n<pre><code>SET @profiles_xml.modify('\n    insert\n    if(/Profile/User/ID=sql:variable(\"@user_id\"))\n    then Activity[Name=sql:variable(\"@activity_name\")][DisplayName=sql:variable(\"@display_name\")]\n    else()\n    as first\n    into (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>I have also tried this with no success:</p>\n\n<pre><code> SET @devices_xml.modify('\n    insert /Profile/User[ID=sql:variable(\"@user_id\")]/Activity[Name=sql:variable(\"@activity_name\")][DisplayName=sql:variable(\"@display_name\")]\n    into (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>And this:</p>\n\n<pre><code> SET @devices_xml.modify('\ninsert\n /Profile/User[ID=sql:variable(\"@user_id\")]/Activities/Activity[Name=sql:variable(\"@activity_name\")][DisplayName=sql:variable(\"@display_name\")]\n    into (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>What is the correct way to do this?</p>\n"},{"tags":["mysql","sql","select"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13232649,"title":"Join multiple tables","body":"<p>I have 3 tables. First one is a list of personnel:\n<p>Table <code>Personnel<pre><code>Id_personnel         Name\n1                    John\n2                    Alice\n3                    Tom\n4                    Charles\n5                    Ben</code></pre></p>\n\n<p>Table <code>Department</code></p>\n\n<pre><code>Id_personnel         Department\n1                    Department 1\n2                    Department 2\n3                    Department 3\n4                    Department 4\n5                    Department 5\n</code></pre>\n\n<p>and table with medical leave:</p>\n\n<p>Table <code>Medical</code></p>\n\n<pre><code>Id_personnel         Start_date         End_date\n1                    2012-08-02         2012-08-05\n2                    2012-08-02         2012-08-15\n3                    2012-10-04         2012-10-06\n4                    2012-10-04         2012-10-06\n5                    2012-09-20         2012-09-21\n</code></pre>\n\n<p>For a given date (let's say 2012-10-05) I want to have something like</p>\n\n<pre><code>Department 1                    John\nDepartment 2                    Alice\nDepartment 3                    Tom             2012-10-04         2012-10-06\nDepartment 4                    Charles         2012-10-04         2012-10-06\nDepartment 5                    Ben\n</code></pre>\n\n<p>Using INNER JOIN I am able to get only those sick. I have something like this:</p>\n\n<pre><code>    SELECT a.Name, b.Department, c.Start_date, c.End_date FROM Personnel a\n      INNER JOIN Department b ON a.Id_personnel = b.Id_personnel\n      INNER JOIN Medical c ON a.Id_personnel = c.Id_personnel\n   WHERE c.Start_date &lt;= 2012-10-05  AND c.End_date &gt;= 2012-10-05\n</code></pre>\n\n<p>And the obvious wrong result is:</p>\n\n<pre>Department 3                    Tom             2012-10-04         2012-10-06\nDepartment 4                    Charles         2012-10-04         2012-10-06\n</code></pre>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13234465,"title":"Multiple variables assignment using SET and SELECT","body":"<p>I use the following t-sql code for assign to variable a value obtained from select statement</p>\n\n<pre><code> DECLARE @cfMitt nvarchar(16)\n\n SET @cfMitt = (SELECT CfMittente\n    FROM Messaggi\n    WHERE IDMessaggio = @IDMessaggio)\n</code></pre>\n\n<p>If I want use multiple assignement I try with the following  code, but something is wrong:</p>\n\n<pre><code>DECLARE @cfMitt nvarchar(16)\nDECLARE @cfDest nvarchar(16)\n\nSET @cfMitt, @cfDest= (SELECT CfMittente, CfDestinatario\nFROM Messaggi\nWHERE IDMessaggio = @IDMessaggio)\n</code></pre>\n\n<p>Where is the error?</p>\n"},{"tags":["sql","performance","stored-procedures"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13202227,"title":"SQL stored proc runs extremely slow when filtering by high row numbers","body":"<p>This query is generated from a very long dynamic sequel stored procedure -- the procedure returns the requested number of records starting at a given index to be displayed in a Telerik Radgrid, effectively handling paging.  A simplified version of the stored proc's output:</p>\n\n<pre><code>SELECT r.* FROM (\n       SELECT ROW_NUMBER() OVER(ORDER BY InventoryId DESC) as row,\n       v.* FROM vInventorySearch v\n       ) as R WHERE [ROW] BETWEEN 1 AND 10\n</code></pre>\n\n<p>When the \"BETWEEN\" clause is between 1 and 10, it runs in a fraction of a second, but if it's between something like 10000 and 1010 it takes almost a full minute to execute.</p>\n\n<p>I feel like I may be missing something fundamental here, but it seems to me that it shouldn't matter which 10 records I'm retrieving, it should take the same amount of time.</p>\n\n<p>Thanks for any input, I'm looking forward to being embarrassed!</p>\n\n<hr>\n\n<p>Solution, courtesy Martin Smith (below) :</p>\n\n<pre><code>SELECT r.*, inv.* FROM \n(\n    SELECT ROW_NUMBER() OVER(ORDER BY InventoryId DESC) as row, v.InventoryID\n    FROM vInventorySearch v\n    WHERE 1=1 \n) as R \ninner join vInventory inv on r.InventoryID = inv.InventoryID\nWHERE [ROW] BETWEEN 10001 AND 10010\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["php","sql","arrays","search","results"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13233798,"title":"How to include the value of an array in a query","body":"<p>I have the following array:</p>\n\n<pre><code> $rqt=\"SELECT * FROM `client_gestion_compte` WHERE `id_company`='\".$societe['id'].\"' AND `id_gestionnaire_client`='\".$_SESSION['id'].\"'\" ;\n $res=mysql_query($rqt);\n\n $values = array();\n while($donnees=mysql_fetch_assoc($res))\n {\n     $values[] = $donnees['compte'] ;\n }\n</code></pre>\n\n<p>I would like to use the value of this array in order to make a search query in the database. I have to use all value of the array, but the trouble is that I don't know how many items are in the array so I can not do manually where this criteria LIKE $value and so on...</p>\n\n<p>So I've tried like this.</p>\n\n<pre><code>`$sql=\"SELECT * FROM `debiteur` INNER JOIN `creance` ON `creance`.`n_doss` = `debiteur`.`n_doss` WHERE `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`nom` LIKE '%\".$_GET['s'].\"%' AND `creance`.`code_client` LIKE '%\".$values.\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`prenom` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`raison_sociale` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`siret` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`adresse` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`adresse2` LIKE '%\".$_GET['s'].\"%' Or `debiteur`.`ville` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`code_postal` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`tel` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`tel2` LIKE '%\".$_GET['s'].\"%' Or `debiteur`.`fax` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`fax2` LIKE '%\".$_GET['s'].\"%' Or `debiteur`.`gsm` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`gsm2` LIKE '%\".$_GET['s'].\"%' OR `creance`.`id_company`=\".$societe['id'].\" AND `debiteur`.`e_mail` LIKE '%\".$_GET['s'].\"%' GROUP BY `creance`.`n_doss`  \";\n</code></pre>\n\n<p>The trouble is on this line  <code>creance.code_client LIKE '%\".$values.\"%'</code></p>\n\n<p>Because I never know how to search with all the custom values of the array and not only with one value like that values[1] for example.</p>\n"},{"tags":["sql","postgresql","primary-key","auto-increment"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3231,"score":3,"question_id":7718585,"title":"Set auto increment primary key in postgres","body":"<p>I have a table called iti. I want to add an auto increment primary key to this table (after already creating 22 columns).</p>\n\n<p>So I tried to create a column called id of type bigserial but pgadmin responds with a \"ERROR: sequence must have same owner as table it is linked to\".</p>\n\n<p>Does anyone know how to fix this issue?</p>\n\n<p>It's especially annoying because I just recreated the whole table (22 columns...) and I created a column id of type bigint and I set the constrained to primary key. But it looks like that is not solution because there is no increment for this solution.</p>\n\n<p>Is there a way to fix this without recreating the whole table again?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13232177,"title":"Getting all related rows that a value is included in, in a mapping table","body":"<p>I don't even know how to start my search on this one.</p>\n\n<p>Let me explain what I'm trying to do :</p>\n\n<p>I have a variable - value mapping table.\n<strong>Several values can be assigned to a variable, and the same value can be assigned to many variables</strong>.</p>\n\n<p>The user is able to delete variables/values.\nHowever, <strong>a value should not be allowed to be deleted if there are any variables that only have this specific value assigned to them</strong>. Otherwise the variables would remain undeleted, but with 0 values assigned, which is wrong.</p>\n\n<p>Now, at the point where the user tries to delete a value from a specific variable, I want to check :</p>\n\n<p><strong>IF for the selected valueID there are any variableIDs that only have one valueID assigned to them, and that valueID is the one the user is trying to delete.</strong>\nIf so, then abort. Otherwise proceed.</p>\n\n<p>Is this possible in any way?</p>\n\n<p>Table Names : </p>\n\n<pre><code>Variable\nValue\nVariable_Value ( mapping table )\n</code></pre>\n\n<p>Field Names ( in all tables ) :</p>\n\n<pre><code>Variable_ID\nValue_ID\n</code></pre>\n\n<p>Example below :</p>\n\n<pre><code>For example Variable_ID 5 only has Value_ID 10 assigned to it. \nIf a user selects a Variable_ID, he sees all assigned Value_IDs \nand is able to select one and try to delete it. So, a user could click \non Variable_ID 3 and try to delete Value_ID 10. That shouldn't \nbe possible if that specific Value_ID is the only assigned \nvalue to any other Variable, because that would leave that \nvariable with no Value_IDs.\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/9ezry.jpg\" alt=\"\"></p>\n"},{"tags":["sql","database","oracle"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":362,"score":0,"question_id":9930364,"title":"How do I print a triangle of stars using SQL","body":"<p>Is it practically possible to create a triangle of stars like this as below in SQL.I know that this could be done easily in any other programming language like C,C++,Java but want to know whether it is really possible with just SQL or PL/SQL.I tried working on it with dual table in Oracle but couldn't get through it.</p>\n\n<pre><code>  *              *\n * *             * * \n* * *    or      * * *\n</code></pre>\n\n<p>Can someone please shed somelight if anyone knows about it.</p>\n"},{"tags":["sql","sql-server","select","parameters","where-clause"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13233676,"title":"How to improve performance of SQL query with parameters?","body":"<p>I'm using SQL Server 2005. </p>\n\n<p>I have a problems with executing SQL statements like this</p>\n\n<pre><code>DECLARE @Param1 BIT\nSET @Param1 = 1\n\nSELECT \n    t1.Col1,\n    t1.Col2\nFROM\n    Table1 t1\nWHERE\n    @Param1=0 OR\n    (t1.Col2 in \n        (SELECT  t2.Col4\n            FROM \n                Table2 t2\n            WHERE \n                t2.Col1 = t1.Col1 AND \n                t2.Col2 = 'AAA' AND \n                t2.t3 &lt;&gt; 0)\n    )\n</code></pre>\n\n<p>This query executes very long time.</p>\n\n<p>But if I replace <code>@Param1</code> with <code>1</code>, than query execution time is ~2 seconds. </p>\n\n<p>Any information how to resolve the problem would be greatly appreciated.</p>\n"},{"tags":["java","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13233029,"title":"How to query a maximum of a list?","body":"<p>I have a list (in this example: list of cars) in my stock. I want to query for the stock and find the highest price that is available within the cars list.</p>\n\n<pre><code>class Stock {\n    List&lt;Car&gt; cars;\n}\n\nclass Car {\n    int price;\n}\n</code></pre>\n\n<p>Tried:</p>\n\n<pre><code>SELECT DISTINCT s.cars.price FROM Stock s;\n</code></pre>\n\n<p>But this always gives an \"error in named query\". What could be wrong, or how could this be done better?</p>\n"},{"tags":["sql","sql-server","foreign-keys","sql-update","revert"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13233742,"title":"How to revert update query in sql server?","body":"<p>I am using SQL Server for my database. now there is table which has following columns.</p>\n\n<pre><code>PK_ID   FK_ID   Name   Description\n1        5       ABC      ABCDE\n2        7       EFG      EFT\n3        8       XUZ      Xyz\n4        11      TEF      TEF\n</code></pre>\n\n<p>Now by mistake i update some Fk_ID field with null value. Now I want to get back my all fk_id which is updated by null value. So is there any way to revert back fk_id's which has value previously?</p>\n\n<p>Can any one help me out to find out solution for the same?</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13233325,"title":"Get the ID for range with smallest difference","body":"<p>Lets say that I have a table A. This table has ID, X_value, Y_value. Here is content of table A:</p>\n\n<p>Table A</p>\n\n<pre><code>ID X_value Y_value\n1  100     150\n2  110     170\n3  120     190\n</code></pre>\n\n<p>Now, if I'm comparing number <strong>130</strong> with range numbers(X_value - Y_value) I would like to get ID of range with smallest(minimal) difference! If I can name it that way? Right away we see that number <strong>130</strong> will fall into all this ranges, but I need ID of range with smallest(minimal) difference between <strong>130</strong> and numbers of range. To elaborate that difference:</p>\n\n<pre><code>For range 1: 130-100=30 and 150-130=20\nFor range 2: 130-110=20 and 170-130=40\nFor range 3: 130-120=10 and 190-130=60\n</code></pre>\n\n<p>From this elaboration we see that minimal difference is at third range(that is <strong>10</strong>) so I would like to get ID <strong>3</strong>. What will be a query for this example if I have this table within MySQL db?! </p>\n"},{"tags":["sql","firebird"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13233634,"title":"How to speed up a simple join query in Firebird 2.5.1","body":"<p>When executing a simple inner join query on two large tables the result is returned after several seconds in Firebird 2.5.1 In other databases the result is returned after several milliseconds. The question is how to speed up this query and why is Firebird using A NATURAL instead of the index?</p>\n\n<p>The query is:</p>\n\n<pre><code>SELECT FIRST 20 * FROM A INNER JOIN B ON A.ID = B.AID;\n</code></pre>\n\n<p>Resulting plan is:</p>\n\n<pre><code>PLAN JOIN (A NATURAL, B INDEX (IDX_B_1))\n</code></pre>\n\n<p>Statistics:</p>\n\n<p><img src=\"http://i.stack.imgur.com/2QaSC.jpg\" alt=\"Statistics\"></p>\n\n<p>Table and index metadata:</p>\n\n<pre><code>CREATE TABLE \"A\" \n(\n  \"ID\"   INTEGER NOT NULL,\nCONSTRAINT \"PK_A\" PRIMARY KEY (\"ID\")\n);\n\n\nCREATE TABLE \"B\" \n(\n  \"ID\"   INTEGER NOT NULL,\n  \"AID\"  INTEGER,\nCONSTRAINT \"PK_B\" PRIMARY KEY (\"ID\")\n);\n\n\nCREATE INDEX \"IDX_B_1\" ON \"B\"(\"AID\");\n</code></pre>\n\n<p>To populate you can use this procedure:</p>\n\n<pre><code>declare variable nba integer;\ndeclare variable nbb integer;\ndeclare variable nbc integer;\n\nbegin\n  nba = 0;\n  nbb = 0;\n  nbc = 0;\n  while (nba &lt; 100000) do begin\n    insert into A (ID) values (:nba);\n    nbc = 0;\n    while (nbc &lt; 50) do begin\n      insert into B (ID, AID)\n      values (:nbb, :nba);\n      nbb = nbb + 1;\n      nbc = nbc + 1;\n    end\n    nba = nba + 1;\n  end\nend\n</code></pre>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13233034,"title":"Use of logical and for an xquery delete in tsql","body":"<p>Is it possible to use a logical and operator with an xquery statement inside a stored procedure to delete an element only if its parent element has a specific value AND it has a specific value? Such as:</p>\n\n<pre><code>SET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE profiles.value('(Profile/ID)[1]','int')= @profile_id)\n    SET @profiles_xml.modify('\n    delete\n    if(/Profile/User/ID=sql:variable(\"@user_id\")) and (/Profile/User/Activities/Activity/Name = sql:variable(\"@activity_name\"))\n    then (/Profile/User/Activities/Activity)\n    else()\n    ')\n</code></pre>\n\n<p>I would like to delete the Activity only if the User ID element and Activity Name element match the given parameters.\nThe xml in profiles_xml looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;20&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;somename&lt;/Name&gt;\n    &lt;Activities&gt;\n      &lt;Activity&gt;\n         &lt;Name&gt;activity1&lt;/Name&gt;\n      &lt;/Activity&gt;\n    &lt;/Activities&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>But in the future there will potentially be multiple  elements in each  and Multiple  elements as children of the  element.</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13231825,"title":"SET datatype set in SQL Server","body":"<p>While creating a table I have to use the datatype <code>SET</code>, but it looks like there is no datatype <code>SET</code> in SQL Server. I was looking on the Microsoft's website and those are the datatypes that it supports: <a href=\"http://msdn.microsoft.com/en-us/library/ms187752.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ms187752.aspx</a></p>\n\n<p>Which one should I use to replace the <code>SET</code>?</p>\n\n<p>I have used <code>SET</code> in MySQL database like this:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `configurations` (\n`index` int(11) NOT NULL AUTO_INCREMENT,\n`user_id` int(11) NOT NULL,\n`configDuration` int(5) NOT NULL,\n`configDurationPerspective` set('list_this_day','list_remaining') NOT NULL,\nPRIMARY KEY (`index`)\n) ENGINE=InnoDB  DEFAULT CHARSET=latin1;\n</code></pre>\n\n<p>And then when I insert data into the table it looks like this:</p>\n\n<pre><code>INSERT INTO 'configurations' (index, user_id, configDuration, configDurationPerspective) VALUES (1, 1, 2, 'list_this_day');\n</code></pre>\n\n<p>Never mind the quotes. Something messed up while pasting the code.</p>\n\n<p>Now I want to do the same thing, but in SQL Server.</p>\n"},{"tags":["sql","sql-server"],"answer_count":8,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":5227,"score":7,"question_id":331157,"title":"Does SQL Server CheckSum calculate a CRC? If not how can I get MS SQL to calculate a CRC on an arbitrary varchar column?","body":"<p>Does SQL Server CheckSum calculate a CRC? If not how can I get SQL Server to calculate a CRC on an arbitrary varchar column?</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13233124,"title":"How to get sp_send_dbmail to format the body that is sourced from a table","body":"<p>I'm using sp-send_dbmail to send an email. I populate the @body content by selecting from a table where the column is defined as text. The actual content of the email is stored in the tables column.</p>\n\n<p>How do I get the email to show the line breaks and format accordingly? I tried the format as HTML and TEXT.</p>\n"},{"tags":["sql","sql-server","variables"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":1,"view_count":58,"score":5,"question_id":13233129,"title":"Declared variable behaving differently to hard coded string","body":"<p>I am trying to set a like parameter into a variable and allow that variable to accept wild cards (mssql 2005). If I use my parameter set to '%' it only returns a partial subset but if I hard code the query to use '%' it returns the full set. Why might the variable behave differently to the string?</p>\n\n<pre><code>DECLARE @wareno char(4); \nSET @wareno = '%';\nselect @wareno as a, * from waredesc where wareno like @wareno;\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>DECLARE @wareno char(4); \nSET @wareno = '%';\nselect @wareno as a, * from waredesc where wareno like '%';\n</code></pre>\n\n<p>The full scenario is switching based on a flag but is reproducible under the code above</p>\n\n<pre><code>DECLARE @wareno char(4); \nDECLARE @delprods bit;\n\n/**\nSET THESE PARAMETERS\n**/\nSET @wareno = '1'; \nSET @delprods = 'true'; /** if true all the warehouses should also be emptied for safety - products are held at a company level!**/\n\nIF @delprods = 1\nBEGIN\n    SET @wareno = '%';\nEND\nselect @wareno as a, * from waredesc where wareno like @wareno;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13231884,"title":"How can I speed up this SQL query","body":"<p>I have a piece of code in an ASP.NET application that builds a SQL query from a list of parameters. The number of parameters can vary, so various criteria can be added to this query.  The database is Microsoft SQL Server 2008.</p>\n\n<p>All the AND and OR's are generated programmatically.</p>\n\n<p>The query took more than 3 seconds to execute, but after some profiling and indexes it runs less than a second. Still I think the query itself can be optimized. I've looked at execution plans, but that doesn't mean much to me - not being a SQL guru.</p>\n\n<p>I wonder if the query can be done in a more intelligent fashion - I haven't been able to figure it out. Here's an example of the query:</p>\n\n<pre><code> SELECT [id], [WorkTitle], [CreateDate], [UpdateDate], [Writer], [ValidFrom], \n\n[ValidTo], [Text] \n FROM dbo.Texts T  \n WHERE Category_id = 3 AND '2012-11-06' BETWEEN ValidFrom AND ValidTo  \n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 1 AND CL.Value = '95068')       \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 1))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 2 AND CL.Value = 'C')       \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 2))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 3 AND CL.Value = 'HEL')       \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 3))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 4 AND CL.Value = 'CC')      \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 4))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 5 AND CL.Value = NULL)     \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 5))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 7 AND CL.Value = '321')      \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 7))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 9 AND CL.Value = 'DK7778')    \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 9))  \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 10 AND CL.Value = 'TFS')   \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 10)) \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 11 AND CL.Value = 'TMP')   \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 11)) \n\n AND (EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id   AND CL.Criteria_id = 13 AND CL.Value = 'OY-VKB')   \n    OR NOT EXISTS (SELECT 'X' FROM dbo.Criteria_List CL WHERE T.id = CL.Text_id AND CL.Criteria_id = 13)) \n</code></pre>\n\n<p>Any tips and tricks are appreciated.</p>\n\n<p>Cheers\nJens</p>\n"},{"tags":[".net","sql","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":155,"score":5,"question_id":5226928,"title":"Is it possible to see the SQL query of a LINQ command?","body":"<p>It would help me understand LINQ a little bit better that's all.</p>\n\n<p>I tried using the SQL Profiler but I'm not sure how I can get it to show the actual SQL commands.</p>\n"},{"tags":["c#",".net","sql","asp.net-mvc","asp.net-membership"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13224405,"title":"Update custom user profile fields with SimpleMembershipProvider?","body":"<p>I added a custom field to the <code>UserProfile</code> table named <code>ClassOfYear</code> and I'm able to get the data into the profile during registration like this:</p>\n\n<pre><code>var confirmationToken = WebSecurity.CreateUserAndAccount(model.UserName,\n    model.Password,\n    propertyValues: new { ClassOfYear = model.ClassOfYear },\n    requireConfirmationToken: true);\n</code></pre>\n\n<p>However, now I want to be able to update the profile when I manage it but I can't seem to find a method to do so. <strong>Do I need to simply update the <code>UserProfile</code> table myself? If not, what is the appropriate way of doing this?</strong></p>\n\n<p>FYI, I'm using Dapper as my data access layer, just in case it matters. But, like stated, I can just update the <code>UserProfile</code> table via Dapper if that's what I'm supposed to do, I just figured that the <code>WebSecurity</code> class, or something similar, had a way already since the custom user profile fields are integrated with the <code>CreateUserAndAccount</code> method.</p>\n\n<p>Thanks all!</p>\n"},{"tags":["python","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13232555,"title":"Debug Executed Sql in Python","body":"<p>I am executing some sql in python as follows </p>\n\n<pre><code>statement = \"select * from TEST_TABLE\"\ndebug(\"Statement: %s\" % (statement, ))\ncursor = gblDBConnection.cursor()\ncursor.execute(statement)\n</code></pre>\n\n<p>I can debug the statement using a debug function I have written but would also like to debug the actual values returned ie after sql execution.</p>\n\n<p>Is there a way of doing this?</p>\n"},{"tags":["sql","report","ms-access-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13232486,"title":"Grouping / Multiple Queries in one report in Microsoft Access Report","body":"<p>I have a contacts database in Microsoft Access with all of the data in one table. I'm trying to create a report that groups the users by 'status' and I'm having trouble trying to determine how to do this.</p>\n\n<p>Each contact has two fields, Status 1 and Status 2.  Status 1 can be null, A or B and Status 2 can be either true or false. </p>\n\n<p>The report should group them something like this:</p>\n\n<pre><code>Status 1 Null\n    Contact name and details (repeated for every contact with this status)\nStatus 1 A\n    Contact name and details (repeated for every contact with this status)\nStatus 1 B\n    Contact name and details (repeated for every contact with this status)\nStatus 2 True\n    Contact name and details (repeated for every contact with this status)\n</code></pre>\n\n<p>There is going to be some overlap with these statuses as some records match more than one status, but that's fine.  Showing duplicates on this page is perfectly acceptable.</p>\n\n<p>If this were a web app, I would simply write 4 queries and loops through the resulting record set, displaying the results under each appropriate header.  But in an Access report I cannot figure out what to do.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","html","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13224737,"title":"Want to get the data in the html table displayed correctly","body":"<p>I have a question on how to display the correct table layout in my php code:</p>\n\n<p>I want to display answers and their text inputs in a table.. Now at the moment it is displayed as below:</p>\n\n<pre><code>QuestionNo   Question             Answer        Marks Per Answer     \n1            What is 2+2          B             (text input)         \n2            Name the 3 hobbits?  BCE           (text input)  \n</code></pre>\n\n<p>I want to change the display of the table so that it looks like this below:</p>\n\n<pre><code> QuestionNo  Question             Answer        Marks Per Answer \n 1           What is 2+2?          B             (text input)\n 2           Name the 3 Hobbits?   B             (text input)                   \n                                   C             (text input)\n                                   E             (text input) \n</code></pre>\n\n<ol>\n<li>As you can see from the new display. I want the each answer per question to be displayed in thier own row, not all answers per question in in one row which is what it is doing at moment.</li>\n<li>I want the text inputs to also be display in its own row, like the answers:</li>\n</ol>\n\n<p>My question is that how can point 1 and 2 be achieved so that it can match the new layout?</p>\n\n<p>Below is the code for the current display:</p>\n\n<pre><code>  &lt;?php  \n    $assessment = $_SESSION['id'] . $sessionConcat;\n    include('connect.php');\n\n    $query = \"SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, \n      GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR '') AS Answer, \n    q.QuestionMarks \n    FROM Session s \n    INNER JOIN Question q ON s.SessionId = q.SessionId\n    JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId\n    WHERE s.SessionName = ?\n    GROUP BY an.SessionId, an.QuestionId\n    ORDER BY q.QuestionId, an.Answer\n    \";\n\n    // prepare query\n    $stmt=$mysqli-&gt;prepare($query);\n    // You only need to call bind_param once\n    $stmt-&gt;bind_param(\"s\", $assessment);\n    // execute query\n    $stmt-&gt;execute(); \n\n    // This will hold the search results\n    $searchQuestionId = array();\n    $searchQuestionContent = array();\n    $searchAnswer = array();\n\n    // Fetch the results into an array\n    // get result and assign variables (prefix with db)\n    $stmt-&gt;bind_result($dbQuestionId, $dbQuestionContent, $dbAnswer);\n    while ($stmt-&gt;fetch()) {\n    $searchQuestionId[] = $dbQuestionId;\n    $searchQuestionContent[] = $dbQuestionContent;\n    $searchAnswer[] = $dbAnswer;\n    }   \n    ?&gt;      \n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;form id=\"QandA\" action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n    &lt;?php \necho \"&lt;table border='1' id='markstbl'&gt;\n      &lt;tr&gt;\n      &lt;th class='questionth'&gt;Question No.&lt;/th&gt;\n      &lt;th class='questionth'&gt;Question&lt;/th&gt;\n      &lt;th class='answerth'&gt;Answer&lt;/th&gt;\n      &lt;th class='answermarksth'&gt;Marks per Answer&lt;/th&gt;\n      &lt;th class='noofmarksth'&gt;Total Marks&lt;/th&gt;\n      &lt;/tr&gt;\\n\";\n      $previous_question_id = null;\n      foreach ($searchQuestionContent as $key=&gt;$question) {\n        if ($previous_question_id == $searchQuestionId[$key]) {\n      $searchQuestionId[$key] = '';\n      $question = '';\n  }else{\n      $previous_question_id = $searchQuestionId[$key];\n  }\n        echo '&lt;tr class=\"questiontd\"&gt;'.PHP_EOL;\n        echo '&lt;td class=\"optiontypetd\"&gt;'.htmlspecialchars($searchQuestionId[$key]).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td&gt;'.htmlspecialchars($question).'&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"answertd\"&gt;';\n        echo $searchAnswer[$key];\n        echo '&lt;/td&gt;' ;\n        echo '&lt;td class=\"answermarkstd\"&gt;&lt;input class=\"individualMarks\" name=\"answerMarks[]\" id=\"individualtext\" type=\"text\" \"/&gt;&lt;/td&gt;' . PHP_EOL;\n        echo '&lt;td class=\"noofmarkstd\"&gt;'.htmlspecialchars($searchMarks[$key]).'&lt;/td&gt;' . PHP_EOL;\n}\n        echo \"&lt;/table&gt;\" . PHP_EOL;\n\n    ?&gt;\n    &lt;/form&gt;\n    &lt;/body&gt;\n</code></pre>\n\n<p>Below is what the Session, Question and Answer Table looks like:</p>\n\n<p>Session Table:</p>\n\n<pre><code>SessionId (auto)  SessionName\n1                 AAA\n2                 AAB\n</code></pre>\n\n<p>Question Table:</p>\n\n<pre><code>SessionId  QuestionId (auto)  QuestionContent\n1          1                  What is 2+2?\n1          2                  Name the 3 hobbits?\n</code></pre>\n\n<p>Answer Table:</p>\n\n<pre><code>AnswerId (auto) SessionId  QuestionId   Answer\n1               1          1           B   \n2               1          2           B\n3               1          2           C\n4               1          2           E\n</code></pre>\n"},{"tags":["sql","oracle","oracle10g","pivot"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":900,"score":1,"question_id":3512140,"title":"convert row into columns in oracle10g","body":"<p>how can i convert rows in to columns in  oracle 10g( like pivot in oracle 11g),so that i can add multiple 'and' conditions for the primary key.</p>\n\n<p>ex: select emp_name from emp</p>\n\n<p>where empid = 1 and emp_age = 21;\nwhere empid = 12 and emp_age = 23;</p>\n\n<p>without using 'in' ,i have to get records which satisfies all the above condtions(Like 'and ' operation).</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13230850,"title":"How can i improve the performance of this oracle query?","body":"<p>I have three database tables which contains large amount of data(6000). I wrote the following query for some operaton which is working fine.</p>\n\n<pre><code>UPDATE productlistprice prl SET prl.value = (\n    SELECT minprice FROM(\n       SELECT  MIN(prl.value) AS minprice, prv.productmasterid AS masterprid \n            FROM product pr , productlistprice prl, productvariation prv \n              WHERE prv.productmasterid = (\n       SELECT prv.productmasterid  FROM  productvariation pv \n              WHERE pv.productid = pr.uuid) \n              AND prl.productid = pr.uuid AND prl.productid  = prv.productid \n                    GROUP BY prv.productmasterid) \n              WHERE masterprid = (SELECT prv.productmasterid\n              FROM productvariation prv WHERE prv.productmasterid = prl.productid \n                    GROUP BY prv.productmasterid)) \n              WHERE prl.productid = (\n       SELECT prv.productmasterid FROM productvariation prv \n              WHERE prv.productmasterid = prl.productid \nGROUP BY prv.productmasterid );\n</code></pre>\n\n<p>But the performance of this query is bit slow. it is taking 21 seconds to update the records. Where can i improve this query. Any suggestions will be greatly appriciated </p>\n"},{"tags":["java","sql","database","hibernate","jpql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13230956,"title":"conditional left outer join SQL query To JPQL","body":"<p>What is a <strong>jpql</strong> equivalent of following <strong>SQL</strong> query :</p>\n\n<pre><code>select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=1;\n</code></pre>\n\n<p><strong>Sample Data:</strong></p>\n\n<pre><code>ij&gt; select * from App;\nID         |STATUS\n----------------------\n1          |active\n2          |active1\n3          |active3\n5          |active\n\n4 rows selected\nij&gt; select * from App_Child;\nID         |STATUS    |D\n----------------------------------\n1          |active    |1\n2          |active11  |2\n1          |active111 |3\n1          |active    |4\n\n4 rows selected\nij&gt; select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=1;\nID         |STATUS    |ID         |STATUS    |D\n---------------------------------------------------------\n1          |active    |1          |active    |1\n1          |active    |1          |active    |4\n\n2 rows selected\nij&gt; select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=5;\nID         |STATUS    |ID         |STATUS    |D\n---------------------------------------------------------\n5          |active    |NULL       |NULL      |NULL\n\n1 row selected\n</code></pre>\n\n<p>EDIT : We are using <strong>jpa 2.0</strong></p>\n"},{"tags":["sql","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13231865,"title":"SELECT refering value to sub query","body":"<p>I am trying to get a random id value from my table. The condition is that the selected value must not exist for the same id and different language (language is <code>lang</code> field)</p>\n\n<p><strong>I do this:</strong></p>\n\n<pre><code>SELECT id_v as p,cont FROM value_phrase WHERE lang=1 AND\nNULL IN (SELECT cont FROM value_phrase WHERE id_v=p AND lang=2)\nORDER BY RAND() LIMIT 0,1\n</code></pre>\n\n<p>... but I do not get any results (It must be an error in my query, because there are many rows satisfying the <em>desired</em> condition.) How should I fix it?</p>\n\n<p>-- SOLVED --</p>\n\n<p>the solution is to use NOT EXISTS instead of NULL IN, and use table aliases to refer the first id_v into the sub query. This way (thanks to  Mark Byers):</p>\n\n<pre><code>SELECT first.id_v, first.cont\nFROM value_phrase AS\nFIRST WHERE lang =1\nAND NOT\n EXISTS (\n SELECT cont\n FROM value_phrase\n WHERE id_v = first.id_v\n AND lang =2\n )\nORDER BY RAND( )\nLIMIT 0 , 1\n</code></pre>\n"},{"tags":["sql","sql-server","reporting-services","ssrs-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":209,"score":2,"question_id":8527249,"title":"Multiple Versions of SQL Reporting Services ReportViewer","body":"<p>I have a simple ASP.NET application that use the SSRS ReportViewer control.  </p>\n\n<p>I was wondering if it is possible to support multiple versions of this control within the application?  </p>\n\n<p>My application is used by users who use a mixed bag of reporting services and the SQL Reporting Services ReportViewer 2010 (version 10.0) is not compatible with SSRS 2005, but the SQL Reporting Services ReportViewer version 9.0 is.  </p>\n\n<p>I would like them to be able to choose which version of reporting services they have and then the application choose the correct control.  </p>\n\n<p>Will having multiple versions of this referenced within the application cause conflicts?</p>\n"},{"tags":["sql","sql-server","sql-server-2005","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":79,"score":-1,"question_id":13227560,"title":"SQL Server 2005 query optimization","body":"<p>My application need to get data from a SQL Server database. My problem is that there is 3 tables that has to be joined into a view. This takes a lot of time (about 30 sec to generate the view) So I was wondering if there is a way to optimize this SQL query?</p>\n\n<p>SQL query: </p>\n\n<pre><code>SELECT TOP (100) PERCENT Request1.RequestID,\n                         TrackIT.dbo.Sending.Barcode,\n                         TrackIT.dbo.Address_View.AdrID,\n                         TrackIT.dbo.Address_View.Name,\n                         TrackIT.dbo.Address_View.Street,\n                         TrackIT.dbo.Address_View.HouseNo,\n                         TrackIT.dbo.Address_View.Postal,\n                         TrackIT.dbo.Address_View.City,\n                         TrackIT.dbo.Address_View.Country,\n                         Request1.Latitude,\n                         Request1.Longitude,\n                         Request1.ReceivedDate\nFROM   (SELECT DISTINCT RequestID,\n                        Ltrim([Content]) AS Barcode,\n                        Latitude,\n                        Longitude,\n                        ReceivedDate\n        FROM   RequestWithLocation\n        WHERE  ( Site LIKE '%Z' )\n               AND ( [Content] &lt;&gt; '' )\n               AND ( AddressID = '0' )\n               AND ReceivedDate &gt; Dateadd(day, -7, Getdate())) AS Request1\n       INNER JOIN TrackIT.dbo.Sending\n         ON Request1.Barcode = TrackIT.dbo.Sending.Barcode\n       INNER JOIN TrackIT.dbo.Address_View\n         ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\nORDER  BY AdrID \n</code></pre>\n\n<p>Can anyone help ?</p>\n"},{"tags":["sql","database","core-data"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13221068,"title":"How to download data from web server and save for core data","body":"<p>I have an app I'm working on that will have about 500 contacts, names, email addresses, website addresses ,etc. I will be updating the contacts frequently adding new contacts, and updating emails that change. I was advised the best way to do this with core data would be to do a fetch to find the youngest record and ask my server for all the records that are even younger.</p>\n\n<p>My question is how to download the youngest record from my server and save it for use with core data.</p>\n\n<p>I've looked around, but dont see anything on using core data with a database stored on a server. Or am I missing something, is there another way to go about creating this app. </p>\n\n<p>I need to be able to update my database frequently and for the results to reach the app user</p>\n"},{"tags":["mysql","sql","optimization","database-indexes"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13230629,"title":"How to optimize MySQL database/query","body":"<p>Hi I was hoping I could get some help on how to optimize my database so it doesn't take a year. I know that to speed it up I need to add indexes, but I'm not exactly sure on what I should be adding them on.</p>\n\n<p>Heres the three tables in my database:</p>\n\n<pre><code>CREATE TABLE IF NOT EXISTS `journeyPattern2` (\n  `journeyPatternId` int(11) NOT NULL AUTO_INCREMENT,\n  `serviceId` int(11) NOT NULL,\n  `direction` enum('inbound','outbound') NOT NULL,\n  PRIMARY KEY (`journeyPatternId`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;\n\nCREATE TABLE IF NOT EXISTS `journeyPatternTimingLink2` (\n  `journeyPatternTimingLinkId` int(11) NOT NULL AUTO_INCREMENT,\n  `journeyPatternId` int(11) NOT NULL,\n  `from` varchar(15) NOT NULL,\n  `to` varchar(15) NOT NULL,\n  `direction` enum('inbound','outbound') NOT NULL,\n  `runTime` varchar(15) NOT NULL,\n  PRIMARY KEY (`journeyPatternTimingLinkId`),\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n\nCREATE TABLE IF NOT EXISTS `line` (\n  `lineId` int(11) NOT NULL AUTO_INCREMENT,\n  `serviceId` int(11) NOT NULL,\n  `lineName` tinytext NOT NULL,\n  PRIMARY KEY (`lineId`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n\nCREATE TABLE IF NOT EXISTS `service` (\n  `serviceId` int(11) NOT NULL AUTO_INCREMENT,\n  `serviceCode` varchar(50) NOT NULL,\n  `registeredOperatorRef` varchar(50) NOT NULL,\n  `origin` tinytext NOT NULL,\n  `destination` tinytext NOT NULL,\n  PRIMARY KEY (`serviceId`)\n) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;\n</code></pre>\n\n<p>The table journeyPattern2 contains about 33000 rows, journeyPatternTimingLink2 contains around 13 million, and line and service around 70000.</p>\n\n<p>The query I'm trying to optimize is the following </p>\n\n<pre><code>SELECT DISTINCT lineName,line.serviceId  FROM `journeyPatternTimingLink2` \nINNER JOIN journeyPattern2\nON journeyPattern2.journeyPatternId=journeyPatternTimingLink2.journeyPatternId\nINNER JOIN line\nON journeyPattern2.serviceId = line.serviceId\nWHERE `from` = '13006785E'\n</code></pre>\n\n<p>I've never really worked with tables of this size before so I'm not sure if I'm joining correctly in the first place. I've also uploaded a <a href=\"http://i.imgur.com/eTO4v.png\" rel=\"nofollow\">screenshot</a> of me running EXPLAIN on the query from phpmyadmin, but I'm not exactly sure how to interpret the results so any help would be appreciated.</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13231312,"title":"group by with value of column SQL","body":"<p>I would like to display for a given user percentages by type (M or C)\nI tried with this query:</p>\n\n<pre><code> SELECT TYPE,user_name,pourcentage_c,pourcentage_m,id_user,COUNT(TYPE) AS crtitique ,COUNT(TYPE) AS majeur\n    FROM stat_alert  \n    LEFT OUTER JOIN user_qdf  \n    ON user_qdf.`id` = id_user   \n    WHERE user_qdf.`id`=id_user AND TYPE='C'\n    GROUP BY id_user \n\n   UNION ALL\n\n SELECT TYPE,user_name,pourcentage_c,pourcentage_m,id_user,COUNT(TYPE) AS        crtitique,COUNT(TYPE) AS majeur \n    FROM stat_alert  \n    LEFT OUTER JOIN user_qdf  \n    ON user_qdf.`id` = id_user   \n    WHERE user_qdf.`id`=id_user AND TYPE='M'\n    GROUP BY id_user\n</code></pre>\n\n<p>I want to display in the same line the  percentage and the number of critical and important for a single user</p>\n\n<p><img src=\"http://i.stack.imgur.com/QEctj.png\" alt=\"enter image description here\"></p>\n"},{"tags":["sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13231501,"title":"sql sum repeats from sql query?","body":"<p>I have a sql output which shows the sales_id and the car manufacturers(car_info) they have sold. </p>\n\n<p>I want to create an extra column in the output which shows a total of the manufacturers sold instead as it shows currently just the sales_id and repeats manufacturers associated to each sale</p>\n\n<p>The query I am currently using is :</p>\n\n<pre><code>SELECT i.car_info \n  FROM inventory i \n  JOIN sales s ON s.car_id = i.car_id\nWHERE s.sales_id = 'sales_id1';\n</code></pre>\n\n<p>I have attempted to use the  sum and the count function but have had no luck.</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":70,"score":2,"question_id":13158137,"title":"how to separate field in oracle contain data varchar and number and date","body":"<p>how to separate field in oracle contain data var char and number and date \nex:</p>\n\n<pre><code>table1:\ncolumn1:MohammadBadarneh_07889855_12021990\n\ncreate procedure to separate and insert into table2:\ntable2:\nname:Mohammad Badarneh\nphone number: 07889855\ndate: 12-02-1990 \n</code></pre>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13231395,"title":"SQLPLUS ORACLE select statement","body":"<p>List the student number, subject code, year, and the term of the students\nwho register to only ONE subject in 2012 session 3.</p>\n\n<pre><code>SELECT StudentNum, RSubjectCode, Year, SessionTerm \n FROM &lt;TABLE&gt; \nWHERE Year ='2012' \n  AND SESSIONTERM = '3';\n</code></pre>\n\n<p>This selects everyone from year 2012 and session 3. How do I only find out the student who registered ONE subject only?</p>\n"},{"tags":["mysql","sql","sql-order-by","case"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13231167,"title":"Aliases not working in ORDER BY clause","body":"<p>This will work fine in MySQL 5:</p>\n\n<pre><code>SELECT INSTR(foo, 'Bar') as foobar\nFROM Table\nORDER BY CASE WHEN foobar = 1 THEN foo END DESC;\n</code></pre>\n\n<p>Bu in MySQL 4, I get the error:</p>\n\n<pre><code>ERROR 1054 (42S22): Unknown column 'foobar' in 'order clause'\n</code></pre>\n\n<p>However, if I change the clause to this, it will work on both versions:</p>\n\n<pre><code>SELECT INSTR(foo, 'Bar') as foobar\nFROM Table\nORDER BY CASE WHEN INSTR(foo, 'Bar') = 1 THEN foo END DESC;\n</code></pre>\n\n<p>To ensure compatibility, do I have to always use the second way?</p>\n"},{"tags":["sql","if-statement","case","outer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13231003,"title":"if statements inside outer apply or case when","body":"<p>is it possible to have if statements inside an outer apply? I can't seem to get it work.</p>\n\n<p>this is the existing code that works:</p>\n\n<pre><code>select id\nfrom\nresidentmemberlease rml\nleft outer join lease l on rml.leaid = l.leaid\nouter apply\n(SELECT TOP(1) * FROM dbo.RentalHistory a WITH(NOLOCK) WHERE a.resmID = RML.resmID and rthDisplayBit='1'\nORDER BY ISNULL(a.rthMoveOutDate, a.rthMoveInDate) DESC) AS RH\n</code></pre>\n\n<p>i want it to look like this depending on the value of the codeleasestatuscode(if its 1 or 2):</p>\n\n<pre><code>select id\nfrom\nresidentmemberlease rml\nleft outer join lease l on rml.leaid = l.leaid\nouter apply\nif(select codeleasestatuscode from lease) = '1'\nbegin\n(SELECT TOP(1) * FROM dbo.RentalHistory a WITH(NOLOCK) WHERE a.resmID = RML.resmID and rthDisplayBit='1'\nORDER BY ISNULL(a.rthMoveOutDate, a.rthMoveInDate) DESC) AS RH\nend\nif(select codeleasestatuscode from lease) = '2'\nbegin\n(SELECT TOP(1) * FROM dbo.RentalHistory a WITH(NOLOCK) WHERE a.resmID = RML.resmID and rthDisplayBit='0'\nORDER BY ISNULL(a.rthMoveOutDate, a.rthMoveInDate) DESC) AS RH\nend\n</code></pre>\n"},{"tags":["sql","oracle","plsql","oracle-apex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13183322,"title":"Filter out duplicate entries in report in Oracle 11g","body":"<p>We're running Oracle 11g on Windows Server 2008 R2</p>\n\n<p>I currently have an application that used nationally for managing our recruiting system, we're a contract engineering staffing firm.</p>\n\n<p>Now, we have a pretty decently sized database of candidates we've previously worked with and I used Oracle Text to make the attached resumes searchable, which works out great, the only issue is that we often send the same candidate to multiple jobs in order to put them to work faster, which means I may get the same candidate's resume turning up 6 or 7 times in the search results, I'm looking to have it filter out duplicates based on candidate's name and recruiter name since I don't want to only filter out candidate names since some people have the same name, but usually 1 recruiter works with 1 candidate, I know it's not perfect, but could help to narrow things down.</p>\n\n<p>I've tried a few things to remove the dupes, but I can't get it to work, here's the current query that we use to generate the search results.</p>\n\n<pre><code>select score(1) relevance,\n\"PKEY\",\n\"DATE_SUB\",\n\"CLIENT\",\n\"CANDIDATE\",\n\"RECRUITER\",\n\"SALES\",\ndbms_lob.getlength(\"RESUME\") \"RESUME\",\n+\"MIMETYPE\",\n\"FILENAME\",\n\"POSITION\",\n\"AVAILABILITY\",\n\"RATE\",\n\"ISSUES\",\n\"WHEN_INT\",\n\"FEEDBACK\",\n\"NOTES\"\nfrom \"SUBMITTALS\"\nwhere CONTAINS (resume, :P11_SEARCH, 1) &gt; 0 order by 1 desc\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Thanks again.</p>\n"},{"tags":["javascript","sql","sql-server","asp-classic"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13176438,"title":"Adding form data to a database ASP and SQL Server","body":"<p>I have been googling the net for hours and i still can't get my head around this!</p>\n\n<p>to start with, i have this code which is the form i have created.</p>\n\n<pre><code>&lt;!-- #include file=\"Header.asp\" --&gt;\n&lt;!-- #include file=\"Tauthenticate.asp\" --&gt;\n&lt;!--#include file=\"database.asp\"--&gt;\n\n&lt;SCRIPT LANGUAGE=\"JavaScript\"&gt;\n\nfunction confirmSubmit()\n{\nvar agree=confirm(\"Confirm?\");\nif (agree)\nreturn true ;\nelse\nreturn false ;\n}\n&lt;/script&gt;\n\n\n    &lt;table border=\"0\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" id=\"table17\"&gt;\n        &lt;tr&gt;\n            &lt;td background=\"../images/bar1.jpg\"&gt;&lt;font size=\"2\"&gt;&amp;nbsp;&lt;b&gt;Add \n            Skill&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;/table&gt;\n            &lt;table border=\"0\" width=\"100%\" id=\"table18\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n                &lt;form method=\"POST\" action=\"SaveNewSkill.asp\"&gt;\n                &lt;tr&gt;\n\n                &lt;/tr&gt;\n\n                &lt;td width=\"108\"&gt;&lt;font face=\"Verdana\" size=\"2\" &gt;Employee &lt;/font&gt; &lt;/td&gt;\n    &lt;td&gt;\n\n\n        &lt;p&gt;&lt;font face=\"Verdana\"&gt;&lt;select size=\"1\" name=\"D1\"&gt;\n        &lt;%\n            sql=\"select User_ID, First_Name, Surname from Company Where Status not like 'left%' and (Company.Office='Manchester' or Company.Office='Romania') order by Surname\"\n            set users=conn.execute(sql)\n            do while not users.eof \n                %&gt;\n                    &lt;option value=\"&lt;%=users(\"User_ID\")%&gt;\"&gt;&lt;%=users(\"First_Name\") &amp; \" \" &amp; users(\"Surname\")%&gt;&lt;/option&gt;\n                &lt;%\n                users.movenext\n                loop\n                set users=nothing\n                %&gt;\n        &lt;/select&gt;&lt;/font&gt;&lt;/p&gt;\n\n    &lt;/td&gt;\n\n\n                &lt;tr&gt;\n                    &lt;td width=\"142\"&gt;&lt;b&gt;&lt;font size=\"2\" face=\"Verdana\"&gt;Skill&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;\n                    &lt;select size=\"1\" name=\"D3\"&gt;\n                    &lt;option value=\"AutoCad 2D\"&gt;AutoCAD 2D&lt;/option&gt;\n                    &lt;option value=\"3D Modeling\"&gt;3D Modeling&lt;/option&gt;\n                    &lt;option value=\"Sketchup\"&gt;Sketchup&lt;/option&gt;\n                    &lt;/select&gt;&lt;/td&gt;\n\n                &lt;/tr&gt;\n\n                &lt;tr&gt;\n                    &lt;td width=\"142\"&gt;&lt;b&gt;&lt;font size=\"2\" face=\"Verdana\"&gt;Current Skill Level&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;\n                    &lt;select size=\"1\" name=\"D4\"&gt;\n                    &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                    &lt;option value=\"2\"&gt;2&lt;/option&gt;\n                    &lt;option value=\"3\"&gt;3&lt;/option&gt;\n                    &lt;option value=\"4\"&gt;4&lt;/option&gt;\n                    &lt;option value=\"5\"&gt;5&lt;/option&gt;\n                    &lt;/select&gt;&lt;/td&gt;\n\n                &lt;/tr&gt;\n\n                    &lt;tr&gt;\n                    &lt;td width=\"142\"&gt;&lt;b&gt;&lt;font size=\"2\" face=\"Verdana\"&gt;Required Skill Level&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;&lt;td&gt;\n                    &lt;select size=\"1\" name=\"D4\"&gt;\n                    &lt;option value=\"1\"&gt;1&lt;/option&gt;\n                    &lt;option value=\"2\"&gt;2&lt;/option&gt;\n                    &lt;option value=\"3\"&gt;3&lt;/option&gt;\n                    &lt;option value=\"4\"&gt;4&lt;/option&gt;\n                    &lt;option value=\"5\"&gt;5&lt;/option&gt;\n                    &lt;/select&gt;&lt;/td&gt;\n\n                &lt;/tr&gt;\n\n                &lt;/form&gt;\n                &lt;/table&gt;\n    &lt;form&gt;&lt;p&gt;&lt;font size=\"2\"&gt;&lt;input type=\"submit\" value=\"Save\" name=\"B1\" onclick=\"return confirmSubmit()\"&gt;&lt;/font&gt;&lt;/form&gt;\n    &lt;td width=\"75\"&gt;\n            &lt;!-- #include file=\"footer.asp\" --&gt;\n</code></pre>\n\n<p>the files that are included are for the header, connection to the database and authentication to view the page in the first place (which all works).</p>\n\n<p>the form queries the database for our list of users then allows the user to select a skill from a list and define their current level of expertise.</p>\n\n<p>i have then created this \"save skill\" asp page.</p>\n\n<pre><code>&lt;!--#include file=\"database.asp\"--&gt;\n&lt;!--#include File=\"TUauthenticate.asp\"--&gt;\n\n\n&lt;%\n\n\nUser_ID=request.querystring(\"User_ID\")\nsql=\"select * from company where User_ID=\" &amp; User_ID\nset rs=conn.execute(sql)\nSession(\"User_ID\")=User_ID\n\n\nSkill=request.form(\"D3\")\nCurrent_Level=Request.form(\"D4\")\nUser_ID=request.form(\"D1\")\nRequired_Level=request.form(\"D5\")\n\nif request.form(\"B1\")&lt;&gt;\"\" then\nif skill = \"AutoCAD 2D\" then\nsqlq=\"insert into skills (User_ID, AutoCad_2D, AutoCad_2DR) Values (\" &amp; User_ID &amp; \",'\" &amp;    Current_Level &amp; \"','\" &amp; Required_Level &amp; \"')\"\nresponse.write(sqlq)\nset rs=conn.execute(sqlq)\nend if\nend if\n\n%&gt;\n</code></pre>\n\n<p>i have put this together using various pieces of working code but it will not save to the database... i understand its not very neat but i will sort that once i know whats wrong with it.</p>\n\n<p>i know i've included a little bit of javascript but i'd prefare if answers were in asp code (as im currently trying to study asp) </p>\n\n<p>Thanks in advance guys! :D</p>\n"},{"tags":["sql","sql-server","stored-procedures","openquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13230430,"title":"Insert Into a Table Across Linked Server From SP Using Openquery","body":"<p>I want to send data across from one server to another, I wish to improve my performance and wondered if OpenQuery is a good route to go down?</p>\n\n<p>I tried to do something like this;</p>\n\n<pre><code>INSERT INTO OPENQUERY (SERVERNAME, '(SELECT Num1, Num2, Num3 FROM [DBName].[dbo].TableName)')\n(Num1, Num2, Num3)\nSELECT Num1, Num2, Num3\n FROM #Temp\n</code></pre>\n\n<p>However this returns the error</p>\n\n<pre><code>The provider indicates that conflicts occurred with other properties or requirements.\n</code></pre>\n\n<p>I don't understand this as the query does run fine and produce the required results without OpenQuery...</p>\n\n<p>Could any of you advise me on this please?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":1,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":93,"score":6,"question_id":13229946,"title":"Difference between Tables and Temp Tables","body":"<p>why this code work without problem :</p>\n\n<pre><code>drop table t1 \nselect * into t1 from  master..spt_values\ndrop table t1 \nselect * into t1 from  master..spt_values\n</code></pre>\n\n<p>Output </p>\n\n<pre><code>Msg 3701, Level 11, State 5, Line 1\nCannot drop the table 't1', because it does not exist or you do not have permission.\n\n(2508 row(s) affected)\n\n(2508 row(s) affected)\n</code></pre>\n\n<p>but this code does not :</p>\n\n<pre><code>drop table #t1 \nselect * into #t1 from  master..spt_values\ndrop table #t1 \nselect * into #t1 from  master..spt_values\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Msg 2714, Level 16, State 1, Line 4\nThere is already an object named '#t1' in the database.\n</code></pre>\n\n<p>what is the difference between Tables and Temp Tables in this code ?</p>\n"},{"tags":["c#","javascript","sql","json","razor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2320,"score":0,"question_id":9416380,"title":"Creating a JSON result from SQL server database","body":"<p>I have an SQL server with the following layout </p>\n\n<pre><code>Table (    id int\n           title varchar(40),\n           start Date(),\n           end Date(),\n           allDay bool,\n           username varchar(40)\n      );\n</code></pre>\n\n<p>I have gotten the following code from <a href=\"http://weblogs.asp.net/gunnarpeipman/archive/2010/02/03/using-fullcalendar-jquery-component-with-asp-net-mvc.aspx\" rel=\"nofollow\">this blog</a> to create a JSON object from the data I wish to use, however his data is stored differently. How do I create the same object, extracted from my database?</p>\n\n<p>I am guessing I need to make the file a .cshtml file rather than a .js file and use this :</p>\n\n<pre><code>@{\n    var db = Database.Open(\"events\"); \n    var selectQueryString = \"SELECT * FROM events\";\n}\n\n @foreach(var row in db.Query(selectQueryString)){ }\n</code></pre>\n\n<p>But how do I adapt this code to produce the same JSON object?</p>\n\n<p>Here is the relevant code from the blog, my attempt is below :</p>\n\n<pre><code>public JsonResult GetEvents(double start, double end)\n{\n    var userName = Session[\"UserName\"] as string;\n    if(string.IsNullOrEmpty(userName))\n    {\n        return null;\n    }\n\n    var fromDate = ConvertFromUnixTimestamp(start);\n    var toDate = ConvertFromUnixTimestamp(end);\n\n    var rep = Resolver.Resolve&lt;IEventRepository&gt;();\n    var events = rep.ListEventsForUser(userName,fromDate,toDate);\n\n    var eventList = from e in events\n                    select new {\n                                id = e.Id,\n                                title = e.Title,\n                                start = e.FromDate.ToString(\"s\"),\n                                end = e.ToDate.ToString(\"s\"),\n                                allDay = false\n                            }; \n\n    var rows = eventList.ToArray();\n    return Json(rows,JsonRequestBehavior.AllowGet);           \n}\n</code></pre>\n\n<p>Edit :</p>\n\n<p>I am now working with the following .cshtml code for the GetEvents command, but it will not work. Does anybody have any ideas ?</p>\n\n<pre><code>   @{ \n        var origin = new DateTime(1970, 1, 1, 0, 0, 0, 0);\n        var fromDate = origin.AddSeconds((Request[\"start\"]));\n        var toDate = origin.AddSeconds(Request[\"end\"]);\n\n        var db = Database.Open(\"events\");\n        var result = db.Query(\"SELECT * FROM events\");\n        var data = result.Select(x =&gt; new \n        {\n            id = x.id,\n            title = x.title,\n            start = x.start.ToString(\"s\"),\n            end = x.end.ToString(\"s\"),\n            allDay = false            \n        }).ToArray();\n\n        Json.Write(data, Response.Output);\n        Response.ContentType = \"application/json\";\n    }\n</code></pre>\n"},{"tags":["c#","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13230878,"title":"need solution for dispaly data using asp.net from sql server","body":"<p>I can insert data to sql server using asp.net. And I also display this data easily using data grid. But I need to display this data in bangali language. I don't know how to display this. I need help for this problem. </p>\n"},{"tags":["mysql","sql","datetime-generation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":68,"score":3,"question_id":13225902,"title":"Get sum of fields","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3954200/mysql-count-data-for-last-7-days\">MySQL Count data for last 7 days</a>  </p>\n</blockquote>\n\n\n\n<p>I have an issue where i need to show the sum of fields. Lets say I have a recordset as follows,</p>\n\n<pre><code>detectDate      |isp    |infection  | count\n--------------------------------------\n2012-10-02 01:00|aaaa   |malware    |3\n2012-10-02 01:30|bbbb   |malware    |2\n2012-10-02 01:33|bbbb   |spy-eye    |2\n2012-10-02 01:45|aaaa   |DDos       |1\n2012-10-03 01:50|cccc   |malware    |2\n2012-10-03 02:00|dddd   |TDSS       |2\n2012-10-03 04:50|dddd   |TDSS       |3\n</code></pre>\n\n<p>And i want to display an output which will show the sum of all the infections for each day as follows,</p>\n\n<pre><code>detectDate  |infection  | count\n-------------------------------\n2012-10-02  |DDos       |1\n2012-10-02  |malware    |5\n2012-10-02  |spy-eye    |2\n2012-10-02  |TDSS       |0\n2012-10-03  |DDos       |0\n2012-10-03  |malware    |2\n2012-10-03  |spy-eye    |0\n2012-10-03  |TDSS       |5\n</code></pre>\n\n<p>I used this query,</p>\n\n<pre><code>SELECT DATE_FORMAT( detectDate, '%Y-%m-%d' ) AS detectDate, infection, SUM( count )\nFROM `tbl_correlateddata`\nGROUP BY DATE_FORMAT( detectDate, '%Y-%m-%d' ) , infection\n</code></pre>\n\n<p>but it only gives an out put as follows which is <strong>NOT</strong> my requirement..</p>\n\n<pre><code>detectDate  |infection  | count\n-------------------------------\n2012-10-02  |DDos       |1\n2012-10-02  |malware    |5\n2012-10-02  |spy-eye    |2\n2012-10-03  |malware    |2\n2012-10-03  |TDSS       |5\n</code></pre>\n\n<p>any help would be much helpful :)\nThank you very much :) much appreciated :)</p>\n\n<p><strong>EDIT:</strong>\nPossible duplicate of : <a href=\"http://stackoverflow.com/questions/3954200/mysql-count-data-for-last-7-days\">MySQL Count data for last 7 days</a></p>\n\n<p><strong>but not similar</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13229558,"title":"An expression of non-boolean type specified in a context where a condition is expected, near ','","body":"<p>I've reviewed other similar questions on this however I do not have a <code>Where</code> clause in my query which leaves me a little confused as to how to resolve it.</p>\n\n<pre><code>INSERT INTO #tmpCombined  \nSELECT A.Region  \n    , 'MyLocation' AS 'Location'  \n    , c.Id AS 'CompID'  \n    , c.Name AS 'CompName'  \n    , 'Cash' AS 'Context'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;= 0 and CASE WHEN T.TranAge &lt; 1 THEN 1 ELSE 0 END,0 )) AS 'ZeroDays0'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;= 1 and CASE WHEN T.TranAge &lt; 8 THEN 1 ELSE 0 END ), 0 ) AS '1to7Days'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;=  8 and CASE WHEN T.TranAge &lt; 16 THEN 1 ELSE 0 END ), 0 ) AS '8to15Days'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;=  16 and CASE WHEN T.TranAge &lt; 20 THEN 1 ELSE 0 END ), 0 ) AS '16to20Days'  \n    , isnull( sum( CASE WHEN T.TranAge &gt;=  20 THEN 1 ELSE 0 END ), 0 ) AS '20DaysPlus'  \n    , COUNT(1) AS 'Total'  \n    , A.Level as 'Level'  \n    , sum(T.USDDifference) AS 'USDRevaluation'  \n    from MyLocation.dbo.Company C  \n    inner join #tmpCashTBResults T on T.CompanyId = C.Id  \n    inner join #tmpCashAccounts A on T.CompanyId = A.CompanyId  \n    group by A.Region, C.Id, C.Name, A.Level  \n</code></pre>\n"},{"tags":["sql","json","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13226760,"title":"Execute SQL script in Entity Framework & convert the result to JSON","body":"<p>Hey Guys I want to execute this SQL script in Entity Framework &amp; return the result in <code>JSONResult</code> format to access in jQuery.. Please help!!!</p>\n\n<p>My Entity Framework model contains the tables &amp; databases mentioned in SQL script </p>\n\n<p>THANKS :-)</p>\n\n<pre><code>DECLARE @listCol VARCHAR(2000)\nDECLARE @query VARCHAR(4000)\nSELECT  @listCol = STUFF(( SELECT distinct  '], [' + [PSize]\n                           FROM     Pattern\n                         FOR\n                           XML PATH('')\n                         ), 1, 2, '') + ']'\nSET @query = 'SELECT * FROM\n      (SELECT PColour as Colour_Size_Matrix, PSize, PCode\n            FROM Pattern\n            ) src\nPIVOT (Count(PCode) FOR PSize\nIN (' + @listCol + ')) AS pvt'\nEXECUTE ( @query )\n</code></pre>\n"},{"tags":["python","sql","database","firebird","firebird2.5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":13230203,"title":"Receiving quantity and list of fields of the table in Firebird","body":"<p>What sql request receives quantity of fields of the table Firebird in firebirdsql connection with database? What sql request receives the list of fields of the table Firebird in firebirdsql connection with database? It is not duplicate of <a href=\"http://stackoverflow.com/questions/13227764/receiving-quantity-and-list-of-fields-of-the-table\">Receiving quantity and list of fields of the table</a>, Now I want to know this for firebird database with firebirdsql connection in Python?</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":28,"score":4,"question_id":13230133,"title":"Selecting all uppercased-value rows of a table in SQL Navigator","body":"<p>I have a table with an email address column. Some email addresses in the table contain uppercase letters. I would like to fetch all the rows with uppercase emails (in order to set them to lowercase). How do I select all the rows where the email address contains uppercase letters?</p>\n"},{"tags":["sql","query","typo3","raw","extbase"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13084863,"title":"Extbase - get created sql from query","body":"<p>i want to get some database tables from my typo3 extensions.\nThe Extension is based on extbase.</p>\n\n<p>The query always returns nothing but the data exists</p>\n\n<p>I've tried this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n$query-&gt;statement('SELECT * FROM `my_table`\n    WHERE field = ? ORDER BY date DESC LIMIT 1',\n    array($condition));\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>$query = $this-&gt;createQuery();\n\n$query-&gt;matching($query-&gt;equals('field', $condition));\n$query-&gt;setOrderings(array('date' =&gt; Tx_Extbase_Persistence_QueryInterface::ORDER_DESCENDING));\n$query-&gt;setLimit(1);\n\n$results = $query-&gt;execute();\n</code></pre>\n\n<p>both returns <em>null</em> as result.</p>\n\n<p>Is it possible to get the sql that the class creates to look where the bug is?</p>\n\n<p>I've looked in some extbase persistent classes but didn't find a clue</p>\n\n<p>EDIT: \nFor those who are interested.. i found a \"solution\".</p>\n\n<p>If you create the query with the statement() method, you can print the query with this function</p>\n\n<pre><code>echo $query-&gt;getStatement()-&gt;getStatement();\n</code></pre>\n\n<p>It doesn't replace the placeholder.\nBut you can get the Variables with this method</p>\n\n<pre><code>var_dump($query-&gt;getStatement()-&gt;getBoundVariables());\n</code></pre>\n\n<p>Thats the best Solution that i found, without editing the extbase extenstions</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13229350,"title":"Sql query join?","body":"<p>I have one table containing car inventory. This has two columns one is car_id and the other is car_info e.g. bmw 320</p>\n\n<p>The other table also contains a table with two columns. One is sales_ids and the other is car_id they have sold.</p>\n\n<p>I want to create an sql query were the output will be the sales_id and the car name which was sold by that sales_id. </p>\n\n<p>I have tried using a join query but have had no sucess thus far. Can anyone offer some help</p>\n"},{"tags":["sql","oracle","plsql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2289,"score":0,"question_id":763802,"title":"How to permit update of a view's results in Oracle?","body":"<p>I understand that database views are read-only, or at least read-only by default.</p>\n\n<p>Is it possible to enable the change of data brought by an oracle view?</p>\n\n<p><strong>Rephrasing:</strong> If I make a view of just one table, just to hide some columns, will changes to this data be updated on the table?</p>\n"},{"tags":["sql","oracle11g"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13160074,"title":"Oracle 11g and SQL TOP query","body":"<p>While using <code>SELECT TOP 5 * FROM SOMETABLE</code> gives me an error </p>\n\n<p><em>ORA-00923: FROM keyword not found where expected</em></p>\n\n<p>I am using Oracle 11g . I am aware of using <code>rownum</code> for doing the same thing but just wondering SQL TOP usage is not at all supported in Oracle ? Anything need to do extra to make SQL TOP working in Oracle ?? </p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":13229138,"title":"Get the last 4 months of the year in MySQL?","body":"<p>i am new to mysql.  I want to know about last 4 month names from sql.</p>\n\n<p>like</p>\n\n<pre><code>  SELECT TO_CHAR(ADD_MONTHS(SYSDATE, -level), 'Month') AS month\n    FROM dual\n    CONNECT BY LEVEL &lt; 4 \n</code></pre>\n\n<p>but how this can be done with mysql?</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":10430335,"title":"sql query to find absent tables from database","body":"<p>I am using ORACLE database. \n<strong>EDIT</strong>:</p>\n\n<p>I want only tables not present in a list, not all those tables in database.</p>\n\n<p>Ex: In my database following tables are present:</p>\n\n<pre><code>a\nb\nc\nd\ne\nr\ns\n</code></pre>\n\n<p>I am being given a list of tables:</p>\n\n<pre><code>a\nb\nc\nv\nh\n</code></pre>\n\n<p>out of which i want to find out which tables are <strong>absent(not present)</strong> in my database.</p>\n\n<p>so: a, b, c are those tables which are present in my database. So excluding these tables my answer will be:</p>\n\n<pre><code>v and h \n</code></pre>\n\n<p><strong>My answer is not d,e,r,s</strong></p>\n\n<p>How can i write a query for this to find out?</p>\n"},{"tags":["c#","sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13229461,"title":"C# change date between different formats","body":"<p>I want to know if there's a way to change the date format depending on the users local date format setting. The date I will store in the DB it's <code>YYYY-MM-DD</code> but the users have different formats, like <code>DD-MM-YYYY</code> or <code>DD.MM.YYYY</code>. What is a clean, elegant way to ensure that my application always retrives the date in local date format, and SQL server always receives the date in <code>YYYY-MM-DD</code> to be stored.</p>\n"},{"tags":["sql","sql-server-2005","quotes","quotations"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":20134,"score":4,"question_id":775687,"title":"How to insert text with single quotation sql server 2005","body":"<p>I want to insert text with single quote \nEg john's to table  in sql server 2005 database</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":13697,"score":6,"question_id":1586560,"title":"How do I escape a single quote in sqlserver?","body":"<p>I'm trying to insert some text data into a table in SQLServer 9.\nThe text includes a single quote.\nHow do I escape that?\nI tried using two single quotes, but it threw me some errors.\neg. insert into my_table values('hi, my name''s tim.');</p>\n"},{"tags":["sql","mongodb","database-design","nosql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13228880,"title":"Category Implementation in a database","body":"<p>I'm building a system that involves users and teachers. In this particular system however I would like to categorize the teachers, but the tricky part is the categories are dynamic thus they can change anytime.</p>\n\n<p>I have to have some functions, since I'm developing the backend;</p>\n\n<ul>\n<li> The first one is <b>showAllCategories()</b>, that shows all the <b>main</b> categories.</li>\n<li>Second is the <b>showSubcategories()</b> which shows the subcategories of a category() </li>\n<li>Third is the <b>showContent()</b>, which in this case shows the teacher's information.</li>\n</ul>\n\n<p>Before asking mighty Stack-Overflowers how would this be efficiently implemented, I thought I could use a doubly linked list approach where in categories table <b>CategoryName</b>, <b>Before</b>, <b>After</b>, <b>Content</b> and if the category did not have the after, the content would be pointing to the teacher's table. This is my classic SQL approach however I'm using <b>MongoDB</b> and since I'm a beginner I wonder if I could take the advantage of NoSQL in this particular situation?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13229241,"title":"How to create procedure with the same WHERE column","body":"<p>How can I create one procedure and the <code>WHERE</code> column is the same?</p>\n\n<p>The <code>WHERE</code> column is <code>QuotationNo</code></p>\n\n<p>This is the procedure signature:</p>\n\n<pre><code>create procedure (QUO1 int, QUO2 int, QUO3 int, QUO4 int)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Quote     price     quantity\n---------------------------------\n1234       2000        1000\n5678       2500        4000\n9012        3000        4500 \n3456        1000        1000\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Captain16</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13228765,"title":"Move values from table to another in PostgreSQL","body":"<p>Hello I have a PostgreSQL 9.1 database with such tables [tables are simplified]</p>\n\n<p><img src=\"http://i.stack.imgur.com/2ZoJ0.jpg\" alt=\"enter image description here\"></p>\n\n<p>For now I use only tables: account, account_word and word. But I wanted to add groups of words into my database. So I created tables wordgroup and wordgroup_word. Now my table account_word is no longer needed so I would like to move all words from account_word to wordgroup_word. In general:</p>\n\n<p><strong>I would like to move all account's word to his wordgroup where group's \"is_all\" is true and then delete account_word table</strong></p>\n\n<p>Could someone help me to achieve this? </p>\n\n<p>Cheers</p>\n"},{"tags":["sql","database","oracle","left-join","oracle9i"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13194453,"title":"leftouter join in sql","body":"<p>I have two tables initially in the application. They are as</p>\n\n<pre><code>user                       \n------------------------      \nuser_id                      \ncolumn1                         \ncolumn2\n..\n\nColumnn\n</code></pre>\n\n<h2>user_account_info</h2>\n\n<pre><code>user_id                   \naccount_number (can have multiple a/c number on single user_id)        \ncolumn1                      \ncolumn2          \n..            \nColumnn  \n</code></pre>\n\n<hr>\n\n<p>the query is like </p>\n\n<pre><code>SELECT u.column1, uai.column1, uai.Keycolumn2\n        FROM user u\n        LEFT OUTER JOIN user_account_info uai on u.user_id  = uai.user_id\n</code></pre>\n\n<p>But later a new table user_account_map is added and user_account_info is changed</p>\n\n<h2>user</h2>\n\n<pre><code>user_id                 \ncolumn1                                        \ncolumn2             \n..               \nColumnn   \n</code></pre>\n\n<h2>user_account_info</h2>\n\n<pre><code>account_number (can have multiple a/c number on single user_id)                       \ncolumn1                  \ncolumn2               \n..               \nColumnn \n</code></pre>\n\n<h2>user_account_map</h2>\n\n<pre><code>user_id                      \naccount_number (can have multiple a/c number on single user_id)                \ncolumn1              \ncolumn2 \n</code></pre>\n\n<p>How to rewrite the query to match the output that of the previous query.\n Is it ok to write like                   </p>\n\n<pre><code>SELECT u.column1, uai.column1, uai.Keycolumn2\nFROM user u\nLEFT OUTER JOIN user_account_map uam on u.user_id  = uam.user_id\nLEFT OUTER JOIN user_account_info uai on u.account_number  = uai.account_number\n</code></pre>\n"},{"tags":["sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":53,"score":-1,"question_id":13228969,"title":"How to combine these SQL queries so that it can display one output?","body":"<p>Help needed to combine the output of this query together.How it can be done??TQ</p>\n\n<pre><code>select facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('6910','7976')\nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n\n\nselect facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('6912','7976') \nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n\nselect facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('7344','7976') \nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n\nselect facility, route, operation, script_id \nfrom F_ROUTEOPER\nwhere facility = 'A01' and operation in ('8344','7976')\nAND src_erase_date is null\nand (script_id not in ('PHQ-LOTCHKRV','PHQ-LOTCHK') or script_id is null)  \nAND (route NOT LIKE '9EL%' AND route NOT LIKE '9TB%'\nAND route NOT LIKE 'BLB%' AND route NOT LIKE 'BWR%' AND route NOT LIKE 'CRL%')\n</code></pre>\n"},{"tags":["sql","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13193770,"title":"EF generated SQL Query returns wrong result","body":"<p>I want to filter on a specific date. Because of the control I use I can also filter on a range of dates, but when I filter on a single date it should also work so I have total flexibility.</p>\n\n<p>When I filter on 2004-11-24 my code generates the following query with Entity Framework. However somehow the query returns me the results of 2004-11-25 instead of 2004-11-24.</p>\n\n<p>What is wrong with this query? </p>\n\n<pre><code>SELECT TOP (26) \n[Filter1].[Id] AS [Id], \n[Filter1].[AliquotId] AS [AliquotId], \n[Filter1].[ScientificStudyId] AS [ScientificStudyId], \n[Filter1].[ExpectedSpecimenId] AS [ExpectedSpecimenId], \n[Filter1].[ExpectedAliquotId] AS [ExpectedAliquotId], \n[Filter1].[VisitId] AS [VisitId], \n[Filter1].[BoxId] AS [BoxId], \n[Filter1].[ParticipantId] AS [ParticipantId], \n[Filter1].[Product] AS [Product], \n[Filter1].[BodyMaterial] AS [BodyMaterial], \n[Filter1].[AliquotNr] AS [AliquotNr], \n[Filter1].[ReservationName] AS [ReservationName], \n[Filter1].[Visit] AS [Visit], \n[Filter1].[Win32Color] AS [Win32Color], \n[Filter1].[Position] AS [Position], \n[Filter1].[Barcode] AS [Barcode], \n[Filter1].[Temperature] AS [Temperature], \n[Filter1].[DivergentStorageTemperature] AS [DivergentStorageTemperature], \n[Filter1].[BoxName] AS [BoxName], \n[Filter1].[CollectionDate] AS [CollectionDate], \n[Filter1].[Positioned] AS [Positioned], \n[Filter1].[CheckedOut] AS [CheckedOut], \n[Filter1].[CheckinDate] AS [CheckinDate], \n[Filter1].[CheckoutDate] AS [CheckoutDate], \n[Filter1].[LabelsPrinted] AS [LabelsPrinted], \n[Filter1].[ParticipantNr] AS [ParticipantNr], \n[Filter1].[Specimen] AS [Specimen], \n[Filter1].[ContainerType] AS [ContainerType], \n[Filter1].[ContainerTypeId] AS [ContainerTypeId], \n[Filter1].[Quantity] AS [Quantity], \n[Filter1].[Unit] AS [Unit], \n[Filter1].[QuantityUnit] AS [QuantityUnit], \n[Filter1].[StudyVersion] AS [StudyVersion], \n[Filter1].[ThawCount] AS [ThawCount], \n[Filter1].[Sop] AS [Sop], \n[Filter1].[NrOfRemarks] AS [NrOfRemarks], \n[Filter1].[RemarkSummary] AS [RemarkSummary]\nFROM ( SELECT [Extent1].[Id] AS [Id], [Extent1].[AliquotId] AS [AliquotId], [Extent1]. [ScientificStudyId] AS [ScientificStudyId], [Extent1].[ExpectedSpecimenId] AS [ExpectedSpecimenId], [Extent1].[ExpectedAliquotId] AS [ExpectedAliquotId], [Extent1].[VisitId] AS [VisitId], [Extent1].[BoxId] AS [BoxId], [Extent1].[ParticipantId] AS [ParticipantId], [Extent1].[Product] AS [Product], [Extent1].[BodyMaterial] AS [BodyMaterial], [Extent1].[AliquotNr] AS [AliquotNr], [Extent1].[ReservationName] AS [ReservationName], [Extent1].[Visit] AS [Visit], [Extent1].[Win32Color] AS [Win32Color], [Extent1].[Position] AS [Position], [Extent1].[Barcode] AS [Barcode], [Extent1].[Temperature] AS [Temperature], [Extent1].[DivergentStorageTemperature] AS [DivergentStorageTemperature], [Extent1].[BoxName] AS [BoxName], [Extent1].[CollectionDate] AS [CollectionDate], [Extent1].[Positioned] AS [Positioned], [Extent1].[CheckedOut] AS [CheckedOut], [Extent1].[CheckinDate] AS [CheckinDate], [Extent1].[CheckoutDate] AS [CheckoutDate], [Extent1].[LabelsPrinted] AS [LabelsPrinted], [Extent1].[ParticipantNr] AS [ParticipantNr], [Extent1].[Specimen] AS [Specimen], [Extent1].[ContainerType] AS [ContainerType], [Extent1].[ContainerTypeId] AS [ContainerTypeId], [Extent1].[Quantity] AS [Quantity], [Extent1].[Unit] AS [Unit], [Extent1].[QuantityUnit] AS [QuantityUnit], [Extent1].[StudyVersion] AS [StudyVersion], [Extent1].[ThawCount] AS [ThawCount], [Extent1].[Sop] AS [Sop], [Extent1].[NrOfRemarks] AS [NrOfRemarks], [Extent1].[RemarkSummary] AS [RemarkSummary], row_number() OVER (ORDER BY [Extent1].[CollectionDate] ASC) AS [row_number]\nFROM [dbo].[ClaimedAliquotPositionsReadModels] AS [Extent1]\nWHERE (cast('0ebebae6-594d-4be0-ac8b-a078013f1370' as uniqueidentifier) = [Extent1].[ScientificStudyId])\nAND ([Extent1].[CheckoutDate] &gt;= convert(datetime2, '2004-11-24 00:00:00.0000000', 121))\nAND ([Extent1].[CheckoutDate] &lt; convert(datetime2, '2004-11-25 00:00:00.0000000', 121))\n)  AS [Filter1]\nWHERE [Filter1].[row_number] &gt; 0\nORDER BY [Filter1].[CollectionDate] ASC\n</code></pre>\n"},{"tags":["mysql","sql","stored-procedures","view","sql-view"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13228026,"title":"MySQL design; View or Stored Procedure with variable","body":"<p>I've to execute a complex query, selecting several columns from 7-8 tables.</p>\n\n<p>We don't want to write that query in programming language (PHP - Symfony 1.4/Propel 1.4 in our case) but to create a view or stored procedure to have very simple select query for developers. I'm confused what will be better approach.</p>\n\n<p>We need query in following format:</p>\n\n<pre><code>SET @PlayerId = 1;\n\nSELECT CASE WHEN mat.player1id = @PlayerId THEN mat.player2id ELSE mat.player1id END as opponent\n    /*plus many other columns*/\nFROM `wzo_matches` as mat /*plus few other tables*/\nWHERE (mat.player1id =@PlayerId OR mat.player2id=@PlayerId)\n    /*plus other join conditions*/\n</code></pre>\n\n<p>Problem with view is, <code>SET @PlayerId=xx</code> statement. We don't know player id in advance but will be passed through PHP. I hope this is the reason to rule out views; is there any workaround for that?</p>\n\n<p>Other option will be stored procedure. Only issue with that is, it will create a new view for every query so operation will be very heavy for DB.</p>\n\n<p>Can someone suggest best approach so that developers can get required data from above query without writing above complex query in PHP. (Obviously through SP or view &amp; simple select query from there)</p>\n"},{"tags":["sql","oracle","database-design","data-modeling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":59,"score":-4,"question_id":13225928,"title":"difference between Surrogate key,Synthetic Key, Artificial key","body":"<p>Is there any difference in Surrogate Key, Synthetic Key and Artificial Key ?\nI didn't get the exact difference.</p>\n"},{"tags":["sql","sorting","report","birt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":45,"score":-2,"question_id":13030227,"title":"Is there any way by which we can fix the rows and column in BIRT?","body":"<p>I want the first row and first column to be fixed in the report.\nSo that when I scroll through the report I always see the first row/column.</p>\n\n<p>Thanks in Advanace!!!!</p>\n"},{"tags":["java","sql","validation","jdbc","prepared-statement"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":84,"score":5,"question_id":13228362,"title":"Using prepared statement in the most secure way","body":"<p>From a security validation perspective, is there a difference between:  </p>\n\n<p><code>stmt.setObject(1, theObject);</code>  </p>\n\n<p>and  </p>\n\n<p><code>stmt.setString(1, theObject);</code>?  </p>\n\n<p>I know that in this case <code>theObject</code> is a <code>String</code> but I am interested in making part of this code more general to cover other cases and was wondering if the security perspective of input validation is affected</p>\n"},{"tags":["php","mysql","html","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":480,"score":1,"question_id":11908111,"title":"Inserting SQL data into HTML textarea","body":"<p>I've been reading lots of questions at stackoverflow that have made my life easier, first time I ask something though.</p>\n\n<p>Here is my problem. I need to be able to insert different values from my SQL database into a selected &lt; textarea > field, depending on what option is selected in a &lt; select > input on the same form.</p>\n\n<p>The basic idea is that I want to edit news from the database, edit title and body. To do that, I want to show what (title / body) data contains my db to the user, by getting them from my SQL db. User may have multiple entries in the database, so when I select one entry at the &lt; select > combobox, I'd like to change the  contents to those from the selected entry from the db.</p>\n\n<p>Its a simple idea difficult to express due to my poor English...</p>\n\n<p>HTML form would be more or less as follows:</p>\n\n<pre><code>&lt;form action=\"edit.php\" method=\"post\"&gt;\n    &lt;select name=\"id\"&gt;\n       &lt;option value=\"1\"&gt;Option 1&lt;/option&gt;\n       &lt;option value=\"2\"&gt;Option 2&lt;/option&gt;\n    &lt;/select&gt;\n    &lt;textarea name=\"newsBody\"&gt;&lt;/textarea&gt;\n    &lt;input name=\"submit\" type=\"submit\" value=\"Edit\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>SQL database structure goes more or less as follows:</p>\n\n<p>DB name: database</p>\n\n<p>DB table: news (fields id, body, title, author, timestamp)</p>\n\n<p>I'd like to be able to select news from my &lt; select > getting their 'id' / 'option value', then get from the DB the corrrect value, and show it in the corresponding &lt; textarea >.</p>\n\n<p>I'm new into website coding, and do it just as a hobby, so my knowledge in PHP, MySQL is very basic. I dont provide any PHP code or options, simply because I have no idea how to resolve it... I can understand sql, php syntax though.</p>\n\n<p>I thought using &lt; select > event 'onchange' and javascript, but couldn't make it work... Neither could I using jQuery / ajax, probably because the lack of useful examples!!</p>\n\n<p>Hope that someone understands and can provide a solution!</p>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":11771230,"title":"php + mysql converting multiple rows into columns in a single row","body":"<p>I have a following details in my database table with columns:</p>\n\n<pre><code>currency code\ncurrency rate\ncurrency trade type\n</code></pre>\n\n<p>Eg, I had the following rows in details (database):</p>\n\n<pre><code>USD  3.33  buy \nUSD  3.43  sell\nSGD  4.33  buy\nSGD  4.43  sell\n</code></pre>\n\n<p>And then, I want to bring my database tables into PHP/HTML tables as following:</p>\n\n<pre><code>     BUY   SELL\nUSD  3.33  3.43 \nSGD  4.33  4.43\n</code></pre>\n\n<p>How to use looping to make them be like that?</p>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13228447,"title":"Getting duplicate count and data from table","body":"<p>I have 3 tables like this:</p>\n\n<p>table_1</p>\n\n<pre><code>+-ID-+-table_3_id-+\n|  1 |          1 |\n|  2 |          1 |\n|  3 |          2 |\n+----+------------+\n</code></pre>\n\n<p>table_2</p>\n\n<pre><code>+-ID-+-table_1_id-+-name--+-value-+\n|  1 |          1 | Name1 | Data1 |\n|  2 |          1 | Name2 | Data2 |\n|  3 |          1 | Name3 | Data3 |\n|  4 |          2 | Name1 | Data1 |\n|  5 |          2 | Name2 | Data4 |\n|  6 |          2 | Name3 | Data5 |\n|  7 |          3 | Name1 | Data6 |\n|  8 |          3 | Name2 | Data2 |\n+----+------------+-------+-------+\n</code></pre>\n\n<p>table 3 consists of IDs and other data that is irrelevant to this question. However, I need to be able to filter on <code>table_3_id</code>.</p>\n\n<p>This is what I need: \nTable 2 has multiple rows that have information of the rows in table_1. I need to have a query that checks if there are duplicates in the 'data' column, which have the same 'name'. The result I need would be this (with a WHERE table_3_id = 1):</p>\n\n<pre><code>+-table_3_id-+-name--+-value-+-duplicate-+\n|          1 | Name1 | Data1 | true      |\n|          1 | Name2 | Data2 | false     |\n|          1 | Name3 | Data3 | false     |\n+------------+-------+-------+-----------+\n</code></pre>\n\n<p>Or, if possible, only return the data from table_2 where it actually is a duplicate. The 'duplicate' field can be a count too, since I do know the amount of rows that have the same table_3_id.</p>\n\n<p>I hope I have made my question clear enough. If it is not clear enough I will try to improve it. I have tried it with joins and subqueries, but my knowledge of SQL isn't enough to make an advanced query like this. I'd prefer this in a single query instead of multiple in PHP.</p>\n"},{"tags":["mysql","sql","oracle","updatable-views"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13215119,"title":"How can I update a view with columns that is derived from case statement?","body":"<p>I created a view using this (neglected other columns):</p>\n\n<pre><code>create view view_table (is_root) as select\n  case when C1 = 'Yes' then 1\n       when C1 = 'No' then 0\n       else 0\n  end as is_root\n  from remote_db_table\n</code></pre>\n\n<p>But when I tried to update the view using:</p>\n\n<pre><code>update view_table set is_root=1\n</code></pre>\n\n<p>It does not work. Any way to do it? The view is in Oracle but the remote table is in mySQL</p>\n"},{"tags":["sql","performance","postgresql"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":112,"score":3,"question_id":12848711,"title":"CTE scan is far far slower than it should be","body":"<p>The following query is being run on about 4 million rows. The first two CTE statements execute in about an hour. The final one however is on track to last more than 15 years.</p>\n\n<pre><code>WITH parsed AS (\n   SELECT name, array(...) description FROM import\n), counts AS (\n   SELECT unnest(description) token, count(*) FROM parsed GROUP BY 1\n) \nINSERT INTO table (name, description) \nSELECT name, ARRAY(\n    SELECT ROW(token, count)::a \n    FROM (\n        SELECT token, (\n            SELECT count \n            FROM counts \n            WHERE a.token=counts.token\n            ) \n        FROM UNNEST(description) a(token)\n        ) _\n    )::a[] description \nFROM parsed;\n\n                                                                  QUERY PLAN                                                                   \n-----------------------------------------------------------------------------------------------------------------------------------------------\n Insert on table  (cost=55100824.40..162597717038.41 rows=3611956 width=96)\n   CTE parsed\n     -&gt;  Seq Scan on import  (cost=0.00..51425557.67 rows=3611956 width=787)\n           Filter: ((name IS NOT NULL) AND (description IS NOT NULL))\n           SubPlan 1\n             -&gt;  HashAggregate  (cost=11.59..12.60 rows=101 width=55)\n                   -&gt;  Append  (cost=0.00..11.34 rows=101 width=55)\n                         -&gt;  Result  (cost=0.00..0.01 rows=1 width=0)\n                         -&gt;  Index Scan using import_aliases_mid_idx on import_aliases  (cost=0.00..10.32 rows=100 width=56)\n                               Index Cond: (mid = \"substring\"(import.mid, 5))\n           SubPlan 2\n             -&gt;  HashAggregate  (cost=0.78..1.30 rows=100 width=0)\n                   -&gt;  Result  (cost=0.00..0.53 rows=100 width=0)\n   CTE counts\n     -&gt;  HashAggregate  (cost=3675165.23..3675266.73 rows=20000 width=32)\n           -&gt;  CTE Scan on parsed  (cost=0.00..1869187.23 rows=361195600 width=32)\n   -&gt;  CTE Scan on parsed  (cost=0.00..162542616214.01 rows=3611956 width=96)\n         SubPlan 6\n           -&gt;  Function Scan on unnest a  (cost=0.00..45001.25 rows=100 width=32)\n                 SubPlan 5\n                   -&gt;  CTE Scan on counts  (cost=0.00..450.00 rows=100 width=8)\n                         Filter: (a.token = token)\n</code></pre>\n\n<p>There are about 4 million rows in both <code>parsed</code> and <code>counts</code>. The query's currently running, and the final statement's inserting a row roughly every 2 minutes. It's barely touching disk, but eating CPU like crazy, and I'm confused.</p>\n\n<p>What's wrong with the query?</p>\n\n<p>The final statement's supposed to look up each element of <code>description</code> in <code>counts</code>, transforming something like this <code>[a,b,c]</code> to something like this <code>[(a,9),(b,4),(c,0)]</code> and inserting it.</p>\n\n<p><br/>\n<strong>Edit</strong></p>\n\n<p>With parsed and counts as tables, and <code>token</code> in counts indexed, this is the plan:</p>\n\n<pre><code>explain INSERT INTO table (name, mid, description) SELECT name, mid, ARRAY(SELECT ROW(token, count)::a FROM (SELECT token, (SELECT count FROM counts WHERE a.token=counts.token) FROM UNNEST(description) a(token)) _)::a[] description FROM parsed;\n                                              QUERY PLAN                                              \n------------------------------------------------------------------------------------------------------\n Insert on table  (cost=0.00..5761751808.75 rows=4002061 width=721)\n   -&gt;  Seq Scan on parsed  (cost=0.00..5761751808.75 rows=4002061 width=721)\n         SubPlan 2\n           -&gt;  Function Scan on unnest a  (cost=0.00..1439.59 rows=100 width=32)\n                 SubPlan 1\n                   -&gt;  Index Scan using counts_token_idx on counts  (cost=0.00..14.39 rows=1 width=4)\n                         Index Cond: (a.token = token)\n</code></pre>\n\n<p>Which is much more reasonable. The arrays have an average of 57 elements, so I guess it was just the sheer number of lookups against the presumable fairly inefficient CTE table that was killing performance. It's now going at 300 rows per second, which I'm happy with.</p>\n"},{"tags":["sql","sql-server-2008","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13226450,"title":"Get latest updated records","body":"<p>I have an \"Observation\" table in SQL Server 2008. This table has a locationId column for a bunch of geographic locations, a few columns for observation details and a column for latest updated date.</p>\n\n<p>Every week, a new observation record for each location is appended. So a location has many occurrences in the table.</p>\n\n<p>What I want to achieve is to be able to get the most recent observation record for each location.</p>\n\n<p>Can anyone help with any idea?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Cheers,\nAlex</p>\n"},{"tags":["python","sql","database","ms-access","pyodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13227764,"title":"Receiving quantity and list of fields of the table","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4539254/how-to-get-datatypes-of-specific-fields-of-an-access-database-using-pyodbc\">How to get datatypes of specific fields of an Access database using pyodbc?</a>  </p>\n</blockquote>\n\n\n\n<p>What sql request receives quantity of fields of the table Access in pyodbc connection with database? What sql request receives the list of fields of the table Access in pyodbc connection with database?</p>\n"},{"tags":["mysql","sql","select","variable-declaration","variable-initialization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13226745,"title":"What are the differences in the following variable initialization styles in MySQL?","body":"<p>I'm fairly new to queries which involve variable declaration in MySQL. I have seen various styles and I'm not fully clear of what these actually do. I've questions about what these actually do.</p>\n\n<p>1)</p>\n\n<pre><code>set @row:=0;\nSELECT name, @row:=@row + 1 AS rownum\nFROM animal\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>SELECT name, @row:=@row + 1 AS rownum\nFROM (SELECT @row:= 0) c, animal\n</code></pre>\n\n<p>Both returns the same:</p>\n\n<pre><code>  name rownum\n|| cat || 1 ||\n|| cat || 2 ||\n|| dog || 3 ||\n|| dog || 4 ||\n|| dog || 5 ||\n|| ant || 6 ||\n</code></pre>\n\n<p><strong>What are the differences in the above two queries and which of the two to adopt as to their scope, efficiency, coding habit, use-cases?</strong></p>\n\n<p>3) Now if I do this: </p>\n\n<pre><code>set @row:=0;\nSELECT name, @row:=@row + 1 AS rownum\nFROM (SELECT @row:= 123) c, animal\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>  name  rownum\n|| cat || 124 ||\n|| cat || 125 ||\n|| dog || 126 ||\n|| dog || 127 ||\n|| dog || 128 ||\n|| ant || 129 ||\n</code></pre>\n\n<p><strong>So doesn't that mean that the inner variable initialization is overriding the outer initialization and leaving the latter redundant hence (and hence its always a better practice to initialize in a <code>SELECT</code>?</strong></p>\n\n<p>4) If I merely do: </p>\n\n<pre><code>SELECT name, @row:=@row + 1 AS rownum\nFROM animal\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>   name  rownum\n|| cat || NULL ||\n|| cat || NULL ||\n|| dog || NULL ||\n|| dog || NULL ||\n|| dog || NULL ||\n|| ant || NULL ||\n</code></pre>\n\n<p>I can understand that since <code>row</code> isn't initialized. But if I run any of the other queries (may be variable <code>row</code> is getting initialized?) I see that <code>row</code> variable is incremented every time I run the above query. That is it gives me the result on first run:</p>\n\n<pre><code>  name rownum\n|| cat || 1 ||\n|| cat || 2 ||\n|| dog || 3 ||\n|| dog || 4 ||\n|| dog || 5 ||\n|| ant || 6 ||\n</code></pre>\n\n<p>and then when re-run it yields in </p>\n\n<pre><code>  name rownum\n|| cat || 7  ||\n|| cat || 8  ||\n|| dog || 9  ||\n|| dog || 10 ||\n|| dog || 11 ||\n|| ant || 12 ||\n</code></pre>\n\n<p><strong>So is <code>row</code> being stored somewhere? And what is its scope and lifespan?</strong></p>\n\n<p>5) If I have query like this: </p>\n\n<pre><code>SELECT (CASE WHEN @name &lt;&gt; name THEN @row:=1 ELSE @row:=@row + 1 END) AS rownum, \n       @name:=name AS name\nFROM animal\n</code></pre>\n\n<p>This always yields the right result:</p>\n\n<pre><code>rownum  name\n|| 1 || cat ||\n|| 2 || cat ||\n|| 1 || dog ||\n|| 2 || dog ||\n|| 3 || dog ||\n|| 1 || ant ||\n</code></pre>\n\n<p><strong>So doesn't that mean its not always necessary to initialize variable at the top or in a <code>SELECT</code> depending on the query?</strong></p>\n"},{"tags":["sql","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1371,"score":3,"question_id":4389930,"title":"Exporting data from SQLite 3","body":"<p>I need a simple way to export data from an SQLite database of multiple tables, then import them into another database.</p>\n\n<p>Here is my scenario.  I have 5 tables: A, B, C, D, E.</p>\n\n<p>Each table has a primary key as the first column called ID.  I want a Unix command that will dump ONLY the data in the row from the primary key in a format that can be imported into another database.  </p>\n\n<p>I know I can do a </p>\n\n<pre><code>sqlite3 db .dump | grep INSERT\n</code></pre>\n\n<p>but that gives me ALL data in the table.  I'm not a database expert, and I'm trying to do this with all unix commands in which I can write a shell script, rather than writing C++ code to do it (because that's what people are telling me that's the easiest way).  I just refuse to write C++ code to accomplish a task that possible can be done in 4-5 statements from the command line.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["mysql","sql","database-design","foreign-keys","composite-key"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13225813,"title":"composite foreign key referencing one or more columns","body":"<p>I have a table (tableA) that joins 3 other tables with primary keys 'vehicle','engine','transmission' I would like to be able to assign parts to one or more of these eg 'only this vehicle' or 'only this vehicle with this engine' or 'any vehicle with this engine'</p>\n\n<p>My plan is to have a parts table (tableB) with also primary keys 'vehicle','engine','transmission' and I'd like to be able to insert for example:</p>\n\n<ul>\n<li><code>4844, null, null</code> to assign a part to only 'vehicle' or </li>\n<li><code>4844, 240,  null</code> to assign a part to 'only this vehicle with this engine'.</li>\n</ul>\n\n<p>Is there some way I can enforce integrity at the database level so that. </p>\n\n<ol>\n<li>the fields that are filled in in tableB must reference fields in tableA.</li>\n<li>at least one of the fields must be filled in.</li>\n<li>the option exists not to insert data into them all?</li>\n</ol>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13226351,"title":"How to retrieve the column value based on formula","body":"<p>Using a view in SQL Server 2000</p>\n\n<p><code>Table1</code>:</p>\n\n<pre><code>id  z1      z2      z3      z4   type\n--------------------------------------\n01A 300     400     300     400  01\n2B  300     400     300     400  02\n3C  500     300     400     300  01\n04A 500     400     500     400  01\n05B 400     300     400     300  02\n06  150     200     200     150  03\n....\n</code></pre>\n\n<p><code>Table2</code>:</p>\n\n<pre><code>type  Formula1           Formula2\n------------------------------------    \n01    ((Z1+Z2)/1000)*2   null\n02    null               ((Z3+Z4)/1000)*2\n03    ((Z1+Z2)/1000)*2   ((Z3+Z4)/1000)*2\n</code></pre>\n\n<p>I want to select the <code>table1</code> rows based on <code>table2</code> formula:</p>\n\n<ul>\n<li>in table2 type - 01 (z1 and z2 found) then i want to consider table1 z1 z2 columns</li>\n<li>in table2 type - 02 (z3 and z4 found) then i want to consider table1 z3 z4 columns</li>\n<li>in table2 type - 03 (z1, z2, z3 and z4 found) then i want to consider table1 z1, z2, z3 z4 columns</li>\n</ul>\n\n<p>Expected output</p>\n\n<p><code>Table1</code>:</p>\n\n<pre><code>id   z1     z2     z3     z4    type\n-------------------------------------    \n01A  300    400    null   null  01\n2B   null   null   300    400   02\n3C   500    300    null   null  01\n04A  500    400    null   null  01\n05B  null   null   400    300   02\n06   150    200    200    150   03\n</code></pre>\n\n<p>Currently I'm using a view, I don't want to change to stored procedure because most of the report are using this view.  </p>\n\n<p>How to do it in sql..?</p>\n"},{"tags":["c#","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":70,"score":0,"question_id":13227796,"title":"sql like query issue","body":"<p>I am trying to fetch data , which has the description keyword at the start or in the middle or at the end.</p>\n\n<p>Following is my query </p>\n\n<pre><code>like '%\" + description + \"' or '\" + description + \"%' or '%\" + description + \"%'\n</code></pre>\n\n<p>Problem is it is returning irrelevant data.</p>\n\n<p>E.g if i have given 'as' in description then it also choses 'cake' in result.</p>\n\n<pre><code>Description\n------------------------------------------------------------\nasd\nasdasd\ncake\nNaw\nTast\nad\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2000"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13209331,"title":"How to split the row value","body":"<p>table1</p>\n\n<pre><code>value\n\n100 x 200 x 300 x 400  `I want to split this row bcoz more than 2 values`\n100 x 200\n1300 x 1400\n200 x 300 x 1200 x 2200  `I want to split this row bcoz more than 2 values`\n....\n</code></pre>\n\n<p>Value column is not fixed length, it may also contain <code>10 x 200 x 3000 x 5</code></p>\n\n<p>I want to take the first 2 values then the next 2 values will go to the next row after <code>x</code></p>\n\n<p>I want to split the rows like this:</p>\n\n<p>Expected Output</p>\n\n<pre><code>100 x 200 \n300 x 400\n100 x 200\n1300 x 1400\n200 x 300 \n1200 x 2200\n....\n</code></pre>\n\n<p><strong>Hint:</strong></p>\n\n<p>We can split the value for each x then we can join 2 values </p>\n\n<p>for example <code>20 x 10 x 5 x 1</code></p>\n\n<p>Split like this <code>20, 10 5, 1</code> then join <code>20 x 10, 5 x 1</code> </p>\n\n<p>The above method will work out, if it work out means then can i get some query for splitting and joining the rows..</p>\n\n<p>How can I do this in SQL?</p>\n\n<p>Need SQL Query Help</p>\n"},{"tags":["php","mysql","sql","pdo"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":55,"score":1,"question_id":13223483,"title":"php - Invalid parameter number: parameter was not defined","body":"<p>i have some problems with executing a simple INSERT request.\nAs said in the title, i have this message \"Invalid parameter number: parameter was not defined\". the first value is an id (primary with auto increment)</p>\n\n<pre><code>$req = $pdo-&gt;prepare('INSERT INTO championnat_classement \n                        VALUES (\n                        \"\",\n                        :Equipe,\n                        :Championnat,\n                        :Saison,\n                        :Journee,\n                        :Points,\n                        :NbMatch,\n                        :Position,\n                        :Victoire,\n                        :Nul,\n                        :Defaite,\n                        :MatchJoueDomicile,\n                        :PointsDomicile,\n                        :VictoireDomicile,\n                        :NulDomicile,\n                        :DefaiteDomicile,\n                        :ButPourDomicile,\n                        :ButContreDomicile,\n                        :MatchJoueExterieur,\n                        :PointsExterieur,\n                        :VictoireExterieur,\n                        :NulExterieur,\n                        :DefaiteExterieur,\n                        :ButPourExterieur,\n                        :ButContreExterieur     \n                        )');\nif ($req-&gt;execute(array(\n                        \"Equipe\" =&gt; $this-&gt;idEquipe1,\n                        \"Championnat\" =&gt; $this-&gt;idChamp,\n                        \"Saison\" =&gt; $this-&gt;saison,\n                        \"Journee\" =&gt; $this-&gt;journee,\n                        \"Points\" =&gt; $this-&gt;pointsTotaux,\n                        \"NbMatch\" =&gt; $this-&gt;matchJouesTotal,\n                        \"Position\" =&gt; $this-&gt;position,\n                        \"Victoire\" =&gt; $this-&gt;matchGagneeTotal,\n                        \"Nul\" =&gt; $this-&gt;matchNulTotal,\n                        \"Defaite\" =&gt; $this-&gt;matchPerduTotal,\n                        \"MatchJoueDomicile\" =&gt; $this-&gt;matchJouesDomicile,\n                        \"PointsDomicile\" =&gt; $this-&gt;pointsDomicile,\n                        \"VictoireDomicile \" =&gt; $this-&gt;matchJouesDomicile,\n                        \"NulDomicile\" =&gt; $this-&gt;matchNulDomicile,\n                        \"DefaiteDomicile\" =&gt; $this-&gt;matchPerduDomicile,\n                        \"ButPourDomicile\" =&gt; $this-&gt;butMarquesDomicile,\n                        \"ButContreDomicile\" =&gt; $this-&gt;butEncaissesDomicile,\n                        \"MatchJoueExterieur\" =&gt; $this-&gt;matchJouesExterieur,\n                        \"PointsExterieur\" =&gt; $this-&gt;pointsExterieur,\n                        \"VictoireExterieur\" =&gt; $this-&gt;matchGagneeExterieur,\n                        \"NulExterieur\" =&gt; $this-&gt;matchNulExterieur,\n                        \"DefaiteExterieur\" =&gt; $this-&gt;matchPerduExterieur,\n                        \"ButPourExterieur\" =&gt; $this-&gt;butMarquesExterieur,\n                        \"ButContreExterieur\" =&gt; $this-&gt;butEncaissesExterieur\n                    ))) {\n                return \"ok\";\n            }\n</code></pre>\n\n<p>How to solve this?</p>\n"},{"tags":["mysql","sql","relational"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13226777,"title":"Complex query taking too long to run","body":"<p>I have a query (<a href=\"http://stackoverflow.com/questions/11336651/adding-a-sub-query-to-an-already-giant-query\">original question that has table structure too</a>) that is perfect, but it creates a temporary table which unfortunately takes like 12 seconds due to amount of data.  (1 table has 95k records, another 155k, and another 21k).</p>\n\n<p>Is there any way to go around the temporary table solution or make it run faster?  Maybe suggest which fields should be indexed?  I have ID fields, date fields, etc... indexed, but that's not helping at all.</p>\n\n<pre><code>SELECT\n    (\n        CASE\n            WHEN a.winner = a.f_a THEN \"Win\"\n            WHEN a.winner = a.f_b THEN \"Loss\"\n            WHEN a.winner IS NULL THEN a.method\n        END\n    ) AS result,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.winner &lt;=&gt; a.f_a) AS fighter_wincount,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.winner IS NOT NULL AND d.winner &lt;&gt; a.f_a) AS fighter_losscount,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.method = \"Draw\") AS fighter_drawcount,\n    SUM(a.f_a IN (d.fighter_a, d.fighter_b) AND d.method = \"No Contest\") AS fighter_nocontestcount,\n    b.name AS opponent,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.winner &lt;=&gt; a.f_b) AS opponent_wincount,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.winner IS NOT NULL AND d.winner &lt;&gt; a.f_b) AS opponent_losscount,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.method = \"Draw\") AS opponent_drawcount,\n    SUM(a.f_b IN (d.fighter_a, d.fighter_b) AND d.method = \"No Contest\") AS opponent_nocontestcount,\n    b.fighter_id AS opponent_id,\n    b.fighting_out_of_country AS opponent_country,\n    a.method AS method,\n    a.method_type AS method_type,\n    a.round AS round,\n    a.time AS time,\n    c.event_id AS event_id,\n    c.event_name AS event,\n    c.event_date AS date,\n    c.event_city AS event_city,\n    c.event_state AS event_state,\n    c.event_country AS event_country\nFROM\n    (\n        SELECT \n            fight_id,\n            IF(fighter_b = :fighter_id_3, fighter_b, fighter_a) AS f_a,\n            IF(fighter_b = :fighter_id_4, fighter_a, fighter_b) AS f_b,\n            winner,\n            method,\n            method_type,\n            round,\n            time,\n            event\n        FROM \n            fights\n        WHERE\n            :fighter_id_5 IN (fighter_a, fighter_b)\n    ) a\nINNER JOIN\n    fighters b ON a.f_b = b.fighter_id\nINNER JOIN\n    events c ON a.event = c.event_id\nLEFT JOIN\n    (\n        SELECT \n            a.fighter_a,\n            a.fighter_b,\n            a.winner,\n            a.method,\n            b.event_date\n        FROM\n            fights a\n        INNER JOIN\n            events b ON a.event = b.event_id\n    ) d ON \n        (a.f_a IN (d.fighter_a, d.fighter_b) OR a.f_b IN (d.fighter_a, d.fighter_b)) AND\n        d.event_date &lt;= c.event_date\nGROUP BY\n    a.fight_id\nORDER BY\n    date DESC\n</code></pre>\n"},{"tags":["sql","oracle","alias","decode","ora-00904"],"answer_count":3,"favorite_count":4,"up_vote_count":14,"down_vote_count":0,"view_count":12005,"score":14,"question_id":356675,"title":"Using an Alias in a WHERE clause","body":"<p>I have a query which is meant to show me any rows in table A which have not been updated recently enough. (Each row should be updated within 2 months after \"month_no\".):</p>\n\n<pre><code>SELECT A.identifier\n     , A.name\n     , TO_NUMBER(DECODE( A.month_no\n             , 1, 200803 \n             , 2, 200804 \n             , 3, 200805 \n             , 4, 200806 \n             , 5, 200807 \n             , 6, 200808 \n             , 7, 200809 \n             , 8, 200810 \n             , 9, 200811 \n             , 10, 200812 \n             , 11, 200701 \n             , 12, 200702\n             , NULL)) as MONTH_NO\n     , TO_NUMBER(TO_CHAR(B.last_update_date, 'YYYYMM')) as UPD_DATE\n  FROM table_a A\n     , table_b B\n WHERE A.identifier = B.identifier\n   AND MONTH_NO &gt; UPD_DATE\n</code></pre>\n\n<p>The last line in the WHERE clause causes an \"ORA-00904 Invalid Identifier\" error. Needless to say, I don't want to repeat the entire DECODE function in my WHERE clause. Any thoughts? (Both fixes and workarounds accepted...)</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13227030,"title":"Finding first matched string in a column in SQL Server","body":"<p>I have a table as follows:</p>\n\n<pre><code>TABLE1\n\nNo  Description\n1   Hello Hai Hello\n2   Good Bad Good\n3   Hello Good Hai\n4   Hai Hello Bad\n5   Hello Hello Hello\n</code></pre>\n\n<p>Now if I run the following query:</p>\n\n<pre><code>Select * \nfrom TABLE1 \nwhere Description like '%Hai%' \n   OR  Description like '%Hello%' \n   OR Description like '%Good%'\n</code></pre>\n\n<p>I want the result as follows ( By adding one extra column \"FIRST MATCHED WORD\"):</p>\n\n<pre><code>No  Description     First Matched Word\n1   Hello Hai Hello     Hai\n2   Good Bad Good       Good\n3   Hello Good Hai      Hai\n4   Hai Hello Bad       Hai\n5   Hello Hello Hello   Hello\n</code></pre>\n\n<p>Hear my intention is to find out the first matched word depends on our query. Kindly help me.</p>\n"},{"tags":["java","sql","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":76,"score":3,"question_id":13226613,"title":"MS Access ODBC: Syntax error .. LIKE 'thomas%'","body":"<p>I am working on a mini application and I have to retrieve and save USER_ID in a table.</p>\n\n<p>It works like this; I input the email address of the user and then the statement has to retrieve USER_ID and save it into a table.</p>\n\n<p>I am having problem with my SQL Like statement.  Its just that I have to insert only the first part of the email address.  For example, \"thomas@yahoo.com\".  I insert only \"thomas\"; not remaining part.</p>\n\n<p>Here are sample of the statement and resulting message I am getting in my Java console:</p>\n\n<p><strong>Code:</strong> </p>\n\n<pre><code>String ea = txt_email.getText();\nString lid = \"SELECT USER_ID FROM user WHERE email_address Like  '\"+ea+\"%' \";\n</code></pre>\n\n<p><strong>Error Message:</strong></p>\n\n<blockquote>\n  <p>Error: java.sql.SQLException: [Microsoft][ODBC Microsoft Access Driver] Syntax error (missing operator) in query expression ''SELECT USER_ID FROM user WHERE email_address Like  'thomas%' ''.         </p>\n</blockquote>\n"},{"tags":["sql","plsql","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13225050,"title":"comparing cursor values for equality in plsql","body":"<pre><code>declare\n  course_id char(10);\n  course_idA char(10);\n\ncursor task3 \n  is\n      select c_id from certificationrequirement\n      where pcp_id = 101;\n\ncursor task3A\n  is \n      select o.c_id from courseoffering o\n      join co_enrolment ce\n      on o.co_id = ce.co_id\n      where ce.s_regno = 401 and ce.coe_completionstatus = 'P';\n\nBegin\n  open task3;\n\n    DBMS_OUTPUT.PUT_LINE ( 'List of Course to take ');\n    loop\n\n      FETCH task3 into course_id;\n      exit when task3%NOTFOUND;\n\n      DBMS_OUTPUT.PUT_LINE ( course_id);\n\n    end loop;\n  close task3;\n\n  open task3A;\n\n    DBMS_OUTPUT.PUT_LINE ( 'List of Courses student has passed ');\n\n    loop\n\n      FETCH task3A into course_idA;\n      exit when task3A%NOTFOUND;\n\n      DBMS_OUTPUT.PUT_LINE (course_idA);\n\n    end loop;\n  close task3A;\n\n  if (cursor task3 = cursor task3A )\n  Then\n    DBMS_OUTPUT.PUT_LINE ( 'Student can attempt the Certification exam ');\n  Else\n    DBMS_OUTPUT.PUT_LINE ( 'Student cannot attempt the Certification exam ');\n  END if;\nend;\n</code></pre>\n\n<p>I'm using one cursor to list all courses student need to take for particular degree.\nSecond cursor to list how many courses student have passed for degree he is studying.\nIf both values in both the cursor are equal he would be eligible to take exit exam otherwise he won't be able to. I have written down the comparing code but I think above is not the correct way to do it.</p>\n"},{"tags":["mysql","sql","perl","query","dbi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":13172755,"title":"Replace quotation marks in sql query in perl script","body":"<p>I have a text file of data that I am importing into a MySQL database. Some of the lines unfortunatley contain quotation marks, which causes my SQL queries to go haywire. I would like to get rid of any field that has quotation marks, or at very least ignore them in my query.</p>\n\n<p>I found something that might work, but being as this is run through a Perl script I am having issues \"escaping\" the quotation marks. I really don't know how and can't figure it out. I would like to just search through my table and delete any quotation marks (\") that it may find or replace it with a single quotation mark or space or anything really.</p>\n\n<pre><code>my $myreplacequery = \"REPLACE(s.Title, '\"','')\";\n$sth = $dbh-&gt;prepare($myreplacequery);\n$sth-&gt;execute;\n</code></pre>\n\n<p>Anyone have any ideas?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13226399,"title":"How can I write a query that returns \"between\" to return alphabetic data, not just numeric?","body":"<p>I have a <code>Daily_account</code> table:</p>\n\n<pre><code>customer_id    account_id            current_balance\n\n1                 D1                       200\n2                 d2                       300\n3                 d10                      400\n4                 d100                     500\n5                 d101                     600\n</code></pre>\n\n<p>Now I have a query: </p>\n\n<pre><code>select customer_id,account_id,current_balance\nfrom daily_account\nwhere account_id between 'D1' and'D100'\n</code></pre>\n\n<p>It is giving me output of account no of D1,D10,D100, but I want to get output of every no.\nHow to get output of every account which comes between D1 and d100?  </p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":51,"score":0,"question_id":13226890,"title":"Can't drop temp table SQL","body":"<p>Hi Im creating a Temp table and inserting data to the Table. Im going to use the Temp table to Join it to the specific User. </p>\n\n<pre><code>CREATE TABLE #MyTempTable\n(\n    UsersId int,\n    ValautionCount int \n)\n\n    SELECT\n        U.UserId, \n        COUNT(*) AS ValautionCount\n    INTO  #MyTempTable\n    FROM \n        Users U\n        Right JOIN Valuation V ON V.ValuationUser = U.UserId\n    GROUP BY \n        U.UserId\n\n\n\nDROP TABLE #MyTempTable\n</code></pre>\n\n<p>When I run this query I get this error : There is already an object named '#Temp' in the database.</p>\n\n<p>But when I run this query <code>DROP TABLE #MyTempTable</code> I get this error: Cannot drop the table '#Temp', because it does not exist or you do not have permission.\nIm using SQL 2012</p>\n"},{"tags":["php","sql","user","limit"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13226335,"title":"Limit number of profiles a free user can view?","body":"<p>Is there a way that will allow me to limit the amount of profiles a user can look at on my site per day. so for instance each user has an id 1, 2, 3 etc. and if the one user views 5 profiles all together in one day then it stops them viewing any more and redirects them to a sign up page to become a paid member where they can view unlimited profiles?</p>\n\n<p>I'm quite new to php and sql but this is primarily what i am working in if there's a way to do it in that.</p>\n\n<p>Thanks</p>\n"},{"tags":["php","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13226866,"title":"insert apostrophe in sql text table?","body":"<p>I have an sql insert script that updates the sql table in the database when a user types text in a text area, but if a user uses an apostrophe in their text this will not insert the information into the table. this is because sql reads the apostrophe as a closing statement or whatever. but is there a way to use a statement that will allow users to put apostrophes in, i.e. tell sql to use '%s%' or whatever to represent an apostrophe?</p>\n\n<p>Heres the sql update code I'm using:</p>\n\n<pre><code>   &lt;?php \n\nsession_start();\n\ninclude '_config/connection.php'; \n\n$status = $_POST['status'];\n\n$result = mysql_query(\"SELECT status FROM ptb_profiles WHERE id=\".$_SESSION['user_id'].\"\");\n\n\n\n\n\nif(!$result) \n{ \necho \"The username you entered does not exist\"; \n} \nelse \nif($status!= mysql_result($result, 0)) \n{ \necho \"\"; \n\n\n    $sql=mysql_query(\"UPDATE ptb_profiles SET status ='$status' WHERE id=\".$_SESSION['user_id'].\"\"); \n}\n    if($sql) \n    { \n\n\n}\nheader('Location: http://localhost/ptb1/profile.php?id=' . $_SESSION['user_id'] );\n?&gt;\n</code></pre>\n"},{"tags":["sql","database-design","calendar","relational-database","database-schema"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":40,"score":4,"question_id":13220386,"title":"Table structure for Scheduling App in SQL DB","body":"<p>I'm working on a database to hold information for an on-call schedule.  Currently I have a structure that looks about like this:</p>\n\n<pre><code>Table - Person: (key)ID, LName, FName, Phone, Email\nTable - PersonTeam: (from Person)ID, (from Team)ID\nTable - Team: (key)ID, TeamName\nTable - Calendar: (key dateTime)dt, year, month, day, etc...\nTable - Schedule: (from Calendar)dt, (id of Person)OnCall_NY, (id of Person)OnCall_MA, (id of Person)OnCall_CA\n</code></pre>\n\n<p>My question is: With the <strong>Schedule</strong> table, should I <em>leave it</em> structured as is, where the dt is a unique key, or should I <em>rearrange it</em> so that dt is non-unique and the table looks like this:</p>\n\n<pre><code>Table - Schedule: (from Calendar)dt, (from Team)ID, (from Person)ID\n</code></pre>\n\n<p>and have multiple entries for each day, <strong>OR</strong> would it make sense to just use:</p>\n\n<pre><code>Table - Schedule: (from Calendar)dt, (from PersonTeam)KeyID - [make a key ID on each of the person/team pairings]\n</code></pre>\n\n<p>A team will always have someone on call, but a person can be on call for more than one team at a time (if they are on multiple teams).</p>\n\n<p>If a completely different setup would work better let me know too!</p>\n\n<p>Thanks for any help! I apologize if my question is unclear.  I'm learning fast but nevertheless still fairly new to using SQL daily, so I want to make sure I'm using best practices when I learn so I don't develop bad habits. </p>\n"},{"tags":["mysql","sql","query","sql-update"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13226657,"title":"Insert text in each row of mysql field","body":"<p>I have a table with this structure :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | img.jpg\n2  | otherimg.png\n3  | img2.png \n4  | someimg.gif\n5  | otherelseimg.jpg\n6  | dummy.jpg\n7  | jusimg.jpg\n</code></pre>\n\n<p>How can I modified each row to become like this :</p>\n\n<pre><code>ID | IMG\n_____________\n1  | folder/img.jpg\n2  | folder/otherimg.png\n3  | folder/img2.png \n4  | folder/someimg.gif\n5  | folder/otherelseimg.jpg\n6  | folder/dummy.jpg\n7  | folder/jusimg.jpg\n</code></pre>\n"},{"tags":["mysql","sql","phpmyadmin"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13226520,"title":"Selecting MYSQL column conditionally","body":"<p>Example schema for my question is given at <a href=\"http://sqlfiddle.com/#!2/bbe5b\" rel=\"nofollow\">SQLFiddle</a> and as follow:</p>\n\n<pre><code>CREATE TABLE `players` (\n  `player1id` int(11) NOT NULL,\n  `player2id` int(11) NOT NULL,\n  PRIMARY KEY (`player1id`,`player2id`)\n) ENGINE=InnoDB;\n\nINSERT INTO `players` values\n(1,5),\n(1,7),\n(5,3),\n(5,4),\n(2,1);\n</code></pre>\n\n<p>In a online game, I want to select opponent, which could be in player <code>player1id</code> or <code>player2id</code>.</p>\n\n<p>Example Input/ output needed</p>\n\n<pre><code>Input 1: Output 5, 7, 2\nInput 5: Output 1, 3 ,4\n&amp; so on.\n</code></pre>\n\n<p>That is, required data could be in any column but I need output in single column conditionally or any other way. I heard about MySQL conditional column but could not create query to get required output. Can someone please help with required query.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Based on <a href=\"http://forums.mysql.com/read.php?10,6639,6677#msg-6677\" rel=\"nofollow\">this link</a>, I run following query but failed.</p>\n\n<pre><code>SELECT IF(PLAYER1ID IS 1,PLAYER2ID as opponent,PLAYER1ID as opponent) \nFROM players\nWHERE PLAYER1ID = 1 OR PLAYER2ID = 1;\n</code></pre>\n"},{"tags":["sql","oracle","greatest-n-per-group","correlated-subquery"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":13223035,"title":"how do I get the oldest date without using a correlated subquery sql","body":"<p>The following code list all the invoices, and I just want the oldest invoice from a vendor:</p>\n\n<pre><code>SELECT DISTINCT vendor_name, i.invoice_number AS OLDEST_INVOICE, \n    MIN(i.invoice_date), i.invoice_total\nFROM vendors v\nJOIN invoices i\nON i.vendor_id = v.vendor_id\nGROUP BY vendor_name, invoice_number, invoice_total\nORDER BY MIN(i.invoice_date);\n</code></pre>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13226529,"title":"sql query error - logical or syntax","body":"<p>At the moment I am running an update query which is working, however it allows null values to be inserted which I don't want.</p>\n\n<pre><code>mysql_query('UPDATE community_table SET \nage = \"'.$age.'\", \ngender = \"'.$gender.'\", \npregnant = \"'.$pregnant.'\", \ndiet = \"'.$diet.'\",\nsmoker = \"'.$smoker.'\",\nalcohol = \"'.$alcohol.'\",\nexercise = \"'.$exercise.'\",\nbmi = \"'.$bmi.'\",\nsleeping = \"'.$sleeping.'\",\nstress = \"'.$stress.'\", \neducation = \"'.$education.'\"\nWHERE username = \"' . $_SESSION['user'] . '\" ');\n</code></pre>\n\n<p>I tried this query which seems to prevent null values being entered, however it also prevents values being entered when the variables are not null.</p>\n\n<pre><code>age = \"'.$age.'\", \ngender = \"'.$gender.'\", \npregnant = \"'.$pregnant.'\", \ndiet = \"'.$diet.'\",\nsmoker = \"'.$smoker.'\",\nalcohol = \"'.$alcohol.'\",\nexercise = \"'.$exercise.'\",\nbmi = \"'.$bmi.'\",\nsleeping = \"'.$sleeping.'\",\nstress = \"'.$stress.'\", \neducation = \"'.$education.'\"\n\nWHERE age IS NOT NULL,\ngender     IS NOT NULL,\npregnant   IS NOT NULL,\ndiet       IS NOT NULL,\nsmoker     IS NOT NULL, \nalcohol    IS NOT NULL,\nexercise   IS NOT NULL,\nbmi        IS NOT NULL,\nsleeping   IS NOT NULL,\nstress     IS NOT NULL,\neducation  IS NOT NULL and where\nusername = \"' . $_SESSION['user'] . '\" ');\n</code></pre>\n\n<p>Is there something wrong with the above query, or do I perhaps have a null value in my input?</p>\n\n<p>Thanks. </p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13225619,"title":"Error when using modify and insert on XML data retreived from table: Must be single node","body":"<p>I am attempting to insert into some xml I am retreiving from a column in a table. I retrieve it as follows:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nDECLARE @profile_id int\nSET @profile_id = 16\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE\nprofiles.value('(Profile/ID)[1]','int')= @profile_id)\n</code></pre>\n\n<p>The resulting xml looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;16&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;test&lt;/Name&gt;\n    &lt;Activities /&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n\n<p>However when I try and insert an element into it like this:</p>\n\n<pre><code>SET @devices_xml.modify('insert &lt;Activity&gt;&lt;Name&gt;testname&lt;/Name&gt;&lt;/Activity&gt;\n as first into (Profiles/User/Activities[1])')\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>XQuery [modify()]: The target of 'insert' must be a single node, found 'element(Activities,xdt:untyped) *'\n</code></pre>\n\n<p>I don't understand why there is an error, as there is only one Activities element currently. Thanks in advance.</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","xquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13226336,"title":"Use varchar stored procedure parameter in If condition of xquery insert","body":"<p>Is it possible to use a nvarchar type sproc variable in an xquery insert statement within the stored procedure?\nWhat I mean is something like this, in which an element is inserted only if a child element with the sought for value is present:</p>\n\n<pre><code>DECLARE @profiles_xml xml\nDECLARE @profile_id int\nDECLARE @user_id nvarchar(50)\nSET @profile_id = 20\nSET @user_id ='BC4A18CA-AFB5-4268-BDA9-C990DAFE7783'\nSET @profiles_xml = (SELECT profiles from tbl_applied_profiles WHERE profiles.value('(Profile/ID)[1]','int')= @profile_id)\nSET @profiles_xml.modify('\ninsert\nif(/Profile/User/ID=\"user_id\")\nthen &lt;Activity&gt;activity_name5&lt;/Activity&gt;\nelse()\nas first\ninto (/Profile/User/Activities)[1]')\n</code></pre>\n\n<p>The xml which @profiles_xml contains looks like this:</p>\n\n<pre><code>&lt;Profile&gt;\n  &lt;ID&gt;20&lt;/ID&gt;\n  &lt;User&gt;\n    &lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;\n    &lt;Name&gt;somename&lt;/Name&gt;\n    &lt;Activities&gt;\n      &lt;Activity&gt;activity_name2&lt;/Activity&gt;\n    &lt;/Activities&gt;\n  &lt;/User&gt;\n&lt;/Profile&gt;\n</code></pre>\n"},{"tags":["sql"],"answer_count":9,"favorite_count":2,"up_vote_count":21,"down_vote_count":0,"view_count":18085,"score":21,"question_id":46385,"title":"Delete all but top n from database table in SQL","body":"<p>What's the best way to delete all rows from a table in sql but to keep n number of rows on the top?  </p>\n"},{"tags":[".net","sql","sql-server","sql-server-2005"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3450,"score":0,"question_id":4941489,"title":"Query vs Stored procedure; difference between two approaches","body":"<p>I am developing a web page for search. I have two options to build this page</p>\n\n<ol>\n<li><p>To build the query on page according to parameter enter by the user and send it to server.</p></li>\n<li><p>To send parameters to stored procedure and build query there and get it executed.</p></li>\n</ol>\n\n<p>I want to know that which approach I should adopt and why. </p>\n\n<p>I want to know the advantages or disadvantages of both approaches. </p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13226070,"title":"SQL select all the orders for employees with minimum sales","body":"<p>I'm attempting to select all the employees with minimum sales from the following database schema:</p>\n\n<blockquote>\n  <p>Employees(eno, ename, zip, hdate)</p>\n  \n  <p>Parts(pno, pname, qoh, price, level)</p>\n  \n  <p>Customers(cno, cname, street, zip, phone)</p>\n  \n  <p>Orders(ono, cno, eno, received, shipped)</p>\n  \n  <p>Odetails(ono, pno, qty)</p>\n  \n  <p>Zipcodes(zip, city)</p>\n</blockquote>\n\n<p>I can't get the query I was working on to work for total sales per employee without an error.  My problem is getting the quantity * price per order related to the employee.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13225824,"title":"How to generate random codes, and run an sql multiple times","body":"<p>I have a query I need to run and I have 2 problems. </p>\n\n<p>first here is my query:</p>\n\n<pre><code>INSERT INTO  `anzie_oscommerce`.`discount_codes` (\n`discount_codes_id` ,\n`discount_description` ,\n`products_id` ,\n`categories_id` ,\n`manufacturers_id` ,\n`excluded_products_id` ,\n`customers_id` ,\n`orders_total` ,\n`order_info` ,\n`exclude_specials` ,\n`discount_codes` ,\n`discount_values` ,\n`minimum_order_amount` ,\n`expires_date` ,\n`number_of_orders` ,\n`number_of_use` ,\n`number_of_products` ,\n`status`\n)\nVALUES (\n'' ,  'GALA 2012', '' , '' , '' , '' , '' ,  '2',  '1',  '0',  substr(md5(uniqid(rand(), true)), 0, 8),  250,  '0.0000',  '2013-22-06',  '0',  '1',  '0',  '1'\n);\n</code></pre>\n\n<p>The first problem is I need to generate the random code which I am trying to do with the uniqid function I took from php but I know that is not possible. Is there a way to do something similar in sql?</p>\n\n<p>The second problem is I need to run this 250 times to generate 250 different discount codes. Is there a quick way to run an sql multiple times?</p>\n"},{"tags":["sql","postgresql","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13223985,"title":"Using sub-queries and joins","body":"<p>I have got the following statement:</p>\n\n<blockquote>\n  <p>List of names and addresses from the customers who made purchases in 1997.</p>\n</blockquote>\n\n<p>So I thought the two following ways were correct but they aren't; why?</p>\n\n<pre><code>select contactname, address from customers\n       inner join orders\n       on customers.customerid = orders.customerid\n       where date_part('year', orderdate) = 1997\n       order by contactname\n\nselect contactname, address from customers\n       where customerid in\n             (select customerid from orders \n              where date_part('year', orderdate) = 1997)\n       order by contactname\n</code></pre>\n"},{"tags":["sql","sql-server-2008-r2","sql-management-studio"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13129678,"title":"Fast way to build database alteration queries in SQL server","body":"<p>(sorry - the question wasn't originally clear.  I'm not looking for the fastest ways to build insert, delete statements etc, but the fastest way to build queries to alter, for example, tables in the database e.g. adding or removing a column)</p>\n\n<p>So, what's the fastest and best way to build database alteration queries in SQL server?  I'm going down the manual route of writing the SQL as it's given me the best result in the past with the IBM Informix database.  Points to note:</p>\n\n<ul>\n<li>I've found that using the table designer in management studio is a poor method (in my experience this is too simplistic and GUI driven to be of use, and often requires tables to be completely rebuilt to work well)</li>\n<li>The query designer only allows simple select, update delete etc. queries to be built</li>\n<li>Any recommended tools that make this easier?</li>\n<li>Am I missing something about the SQL management studio that I should know?  Seems to create overly complex SQL for building a table, that's difficult to comprehend and edit</li>\n</ul>\n"},{"tags":["sql","shell","sqlplus","ksh"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13224945,"title":"to pass an numeric value to sqlplus","body":"<p>i want to pass a ksh shell variable as an integer to sqlplus or convert the variable to number before using it .This is the code i have written (not working):</p>\n\n<pre><code>echo\necho \"Enter the day of run (1,2,3,..,N ) :\" | tee -a $sqllog\nread day\n\ntypeset -i first_range\n\nif [ $day -eq 1 ]; then\nfirst_range=5000\nelif [[ $day -eq 2 ]]; then\nfirst_range=105000\nelif [[ $day -eq 3 ]]; then\nfirst_range=205000\nelif [[ $day -eq 4 ]]; then\nfirst_range=305000\nelif [[ $day -eq 5 ]]; then\nfirst_range=405000\nelif [[ $day -eq 6 ]]; then\nfirst_range=505000\nelif [[ $day -eq 7 ]]; then\nfirst_range=605000\nfi\n\necho \"first_range value : ${first_range}\" | tee -a $sqllog\n{\nsqlplus -S ${SF_PSTN_CONN_STRING} &lt;&lt; EOF\n\nalter session enable parallel DML;\n--alter session set  db_file_multiblock_read_count=128;\nalter session enable parallel query;\n\nset heading off\nset verify off\nset echo off\nset pages 0\nset timi on\nset lines 300\nset trimspool on\n\n# Drop table TMP_DAILY_PSTN_CMP_11035\n\ndrop table TMP_DAILY_PSTN_CMP_11035;\n\n\n# Create TMP Table TMP_DAILY_PSTN_CMP_11035 from TMP_OA_PSTN_CMP_11035\n\nCreate table TMP_DAILY_PSTN_CMP_11035 (\n        ACTION_OBJID NUMBER,\n        CONTRACT_OBJID NUMBER,\n        STATUS varchar2(40),\n        UPDATE_DATE DATE\n)\npartition by range(ACTION_OBJID)(\npartition p1 values less than (${first_range})) NOLOGGING parallel;\n\nprompt the day of run is $day;\n\nbegin\n        for k in 2..200\n        loop\n                execute immediate\n                        'alter table TMP_DAILY_PSTN_CMP_11035 add partition p'||k||' values less than ('||${first_range}+(k*5000)||')';\n        end loop;\nend;\n/\n</code></pre>\n\n<p>The error i am getting for it is:</p>\n\n<pre><code>Enter the day of run (1,2,3,..,N ) :\n2\nfirst_range value : 105000\n\nSession altered.\n\n\nSession altered.\n\n\nTable dropped.\n\nElapsed: 00:00:00.03\n\nTable created.\n\nElapsed: 00:00:00.02\nthe day of run is 2\nbegin\n*\nERROR at line 1:\nORA-06502: PL/SQL: numeric or value error: character to number conversion error\nORA-06512: at line 4\n</code></pre>\n\n<p>how do i solve this problem,ie to convert the char to number,even <code>typeset -i</code> does not seem to be working.passing a variable to sqlplus is easy and many question refer to it but i specifically want to pass an integer value and use it</p>\n\n<p>EDIT:\ni am using oracle 10g db.</p>\n"},{"tags":["sql","sql-server-2008","ssis","ssis-data-transformations","collate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13180214,"title":"How can I convert \"SQL_Latin1_ General\" Collate Using an SSIS Package?","body":"<p>We've just noticed 2 of our servers have been set up using <strong>SQL_Latin1_General_CP1_CI_AS</strong> and <strong>Latin1_General_CI_AS</strong>. </p>\n\n<p>I've created a script which compares two sources of data again each other (as it's a simple SELECT statement I haven't included it, it uses the same columns but from different sources) when I tried to union them together I received the collate error.</p>\n\n<blockquote>\n  <p>Msg 468, Level 16, State 9, Line 2\n      Cannot resolve the collation conflict between \n      \"<strong>SQL_Latin1_General_CP1_CI_AS</strong>\" and \"<strong>Latin1_General_CI_AS</strong>\" in the UNION operation.</p>\n</blockquote>\n\n<p>One of the sources is a table which is being populated by an <strong>SSIS</strong> package, is there a way of adapting the SSIS project to convert the \"SQL_Latin1_General_CP1_CI_AS\" format to \"Latin1_General_CI_AS\" before it's sent to the destination table?</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","pdo","dynamic-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13225448,"title":"SQLSTATE[HY000]: General error","body":"<p>I have a mysql dynamic-sql statement and I want to run it using pdo, and I get the following error message:</p>\n\n<blockquote>\n  <p>Warning: PDOStatement::fetchAll() [pdostatement.fetchall]:\n  SQLSTATE[HY000]: General error in C:\\xampp\\htdocs\\tags\\cobasql.php on\n  line 29</p>\n</blockquote>\n\n<p>Here's my php code:</p>\n\n<pre><code>&lt;?php \n   $uname = 'root'; //nama username database \n   $pwd = ''; //Password database \n   $dbname = 'eav_latihan'; //nama Database \n\n   /* Initialisasi database */ \n   $db = new PDO('mysql:host=localhost;dbname='.$dbname, $uname, $pwd); \n   $db-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING); \n\n\n   $query = \"SET @sql = NULL; \". \n            \" SELECT GROUP_CONCAT(DISTINCT CONCAT('MAX(IF(a.Name = ''', \". \n            \" a.Name, ''', ca.value, NULL)) AS ', a.Name )) INTO @sql \". \n            \" FROM cust_attribute ca \". \n            \" INNER JOIN attribute a ON ca.idAttribute = a.idAttribute \". \n            \" INNER JOIN customer c ON c.idCustomer = ca.idCustomer \". \n            \" WHERE a.publish = 'Y'; \". \n            \" SET @sql = CONCAT('SELECT c.idCustomer, c.namaCustomer, ' \". \n            \" ' c.email, c.noTelp, ', @sql, ' FROM cust_attribute ca', \". \n            \" ' INNER JOIN attribute a ON ca.idAttribute = a.idAttribute', \". \n            \" ' INNER JOIN customer c ON c.idCustomer = ca.idCustomer', \". \n            \" ' GROUP BY c.idCustomer'); \". \n            \" SELECT @sql; \". \n            \" prepare stmt FROM @sql; \". \n            \" execute stmt;\"; \n\n   $result_array = array();\n   $queryku = $db-&gt;query($query);\n   $result_array = $queryku-&gt;fetchAll(PDO::FETCH_OBJ);\n   echo $result_array;\n?&gt;\n</code></pre>\n\n<p>Anyone here can help me or give me a suggest please??</p>\n"},{"tags":["php","sql","redirect"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13225690,"title":"Redirect to page only once?","body":"<p>I have this piece of php code that looks up the account prompt function on my website. basically if a user has violated a term and condition on the site, at login they are redirected to a prompt page that says you are very naughty and here's a warning.</p>\n\n<p>My code is this:</p>\n\n<pre><code> &lt;?php\n\n$account_prompt = account_prompt();\nwhile ($prompt = mysql_fetch_array($account_prompt)) \n\n\n if ($prompt['account_prompt'] == '1')  {\n    redirect_to(\"prompt.php\"); \n }\n ?&gt;\n</code></pre>\n\n<p>My question is how can i get it to only redirect once? \nThanks</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13225326,"title":"SQL Server Column Mapping","body":"<p>I have three scenarios that i'd like to handle, with some remapping i'm doing. </p>\n\n<p>Scenario #1\nI have Table A</p>\n\n<blockquote>\n  <p>Column A, Column B<br>   1, NULL  <br> 2, NULL  <br> 3, NULL  <br> 4,\n  NULL  <br> 5, NULL  <br> 6, NULL  <br></p>\n</blockquote>\n\n<p>How Can I Update Column B such that I begin with the next value of Column A  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, 7  <br> 2, 8  <br> 3, 9  <br> 4, 10  <br>\n  5, 11  <br> 6, 12  <br></p>\n</blockquote>\n\n<p>Scenario #2\nI have Table A  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, NULL  <br> 1, NULL  <br> 2, NULL  <br> 2,\n  NULL  <br> 3, NULL  <br> 3, NULL  <br> 3, NULL  <br></p>\n</blockquote>\n\n<p>How Can I Update Column B such that I begin with the next value of Column A but insuring I only update the values as a group like so  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, 4  <br> 1, 4  <br> 2, 5  <br> 2, 5  <br>\n  3, 6  <br> 3, 6  <br> 3, 6  <br></p>\n</blockquote>\n\n<p>Scenario #3\nI have Table A that contains gaps in Column A  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, NULL  <br> 1, NULL  <br> 4, NULL  <br> 4,\n  NULL  <br> 6, NULL  <br> 6, NULL  <br> 6, NULL  <br></p>\n</blockquote>\n\n<p>How Can I Update Column B such that I begin with the next value of Column A but insuring I only update the values as a group like so  </p>\n\n<blockquote>\n  <p>Column A, Column B  <br> 1, 7  <br> 1, 7  <br> 4, 8  <br> 4, 8  <br>\n  6, 9  <br> 6, 9  <br> 6, 9  <br></p>\n</blockquote>\n\n<p>Can I possibly handle all three of these scenario's in one statement? If so, how?\nAny help is much appreciated!  </p>\n"},{"tags":["mysql","sql","query","constraints"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":765,"score":0,"question_id":5156281,"title":"Mysql adding a constraint: force a field to get specific values","body":"<p>I have a simple mysql table with the following attributes: <code>Name, Surname, Role</code>.</p>\n\n<p>I want the Role field to get only 2 possible values: <code>Supervisor</code> or <code>Operator</code> and to result in error when a query tries to insert something different from that 2 values.</p>\n\n<p>For example, i want the following query to return an error:</p>\n\n<pre><code>INSERT INTO tablename (name,surname,role) VALUES ('max','power','footballplayer');\n</code></pre>\n\n<p>I tried setting the field <code>Role</code> as a <code>ENUM</code> or <code>SET</code> type but it will just leave the field empty instead of firing and error :(</p>\n"},{"tags":["php","html","mysql","sql","website"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":71,"score":0,"question_id":13224549,"title":"Am I protecting my website enough from sql injection?","body":"<p>I have made a website where I only display items from my db tables, I pass variables from one page to the other to display certain items, there is no adding, deleting or editing to my table items in my website is just displaying information. </p>\n\n<pre><code>$aaa = _POST['aaa'];\n\n$databasehost = \"localhost\";\n$databasename = \"mydb\";\n$databaseusername = \"user\";\n$databasepassword = \"password\";\n\n// Connect to the database server\n$dbcnx = @mysql_connect($databasehost, $databaseusername, $databasepassword);\n if (!$dbcnx) {\n echo( \"&lt;font color='red'&gt;&lt;P&gt;can't connect to server.&lt;/P&gt;&lt;/font&gt;\" );\n exit();\n  }\n // Select the database\n if (! @mysql_select_db($databasename) ) {\n echo( \"&lt;font color='red'&gt;&lt;P&gt;can't connect to db &lt;/P&gt;&lt;/font&gt;\");\n exit();\n  }\n\n $aaa = mysql_real_escape_string($aaa)\n\n // and with $aaa I do my query\n</code></pre>\n\n<p>I have read that protecting my variables with the mysql_real_escape_string() I stop any injections into my query's but I feel vulnerable with:</p>\n\n<pre><code> $databasehost = \"localhost\";\n $databasename = \"mydb\";\n $databaseusername = \"user\";\n $databasepassword = \"password\";\n</code></pre>\n\n<p>Am I just paranoid or is there a way protect this information that connects to y server and data base?</p>\n"},{"tags":["sql","postgresql","datetime","aggregate","generate-series"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13201077,"title":"Min, Max, Avg for 2-hour intervals","body":"<p>In below query, I am calculating the minimum, the maximum, and the average for a two hour interval using PostgreSQL.</p>\n\n<p>The query works fine for even start hours <code>(..04:00:00+05:30)</code>, but it gives similar result as that of even start time for odd start hours <code>(..05:00:00+05:30)</code>.\nThe multiple by 2 returns even hours which is the problem.</p>\n\n<pre><code>SELECT tagid, CAST(sample_time_stamp as Date) AS stat_date, \n       (floor(extract(hour from sample_time_stamp)/2) * 2)::int AS hrs,\n       min(sensor_reading) AS theMin,   \n       max(sensor_reading) AS theMax,\n       avg(sensor_reading) AS theAvg\nFROM sensor_readings WHERE tagid =1 AND \nsample_time_stamp BETWEEN '2012-10-23 01:00:00+05:30'\n                  AND     '2012-10-23 05:59:00+05:30'\nGROUP BY tagid,CAST(sample_time_stamp as Date),\n         floor(extract(hour from sample_time_stamp)/2) * 2\nORDER BY tagid,stat_date, hrs\n</code></pre>\n\n<h3>OutPut for Odd start Hour ('2012-10-23 01:00:00+05:30')</h3>\n\n<pre><code>tagid    date          hrs  theMin  themax    theAvg \n1        2012-10-23    0    6       58        30.95\n1        2012-10-23    2    2       59        29.6916666666667\n1        2012-10-23    4    3       89        31.7666666666667\n</code></pre>\n\n<h3>OutPut for Even start Hour ('2012-10-23 02:00:00+05:30')</h3>\n\n<pre><code>tagid    date          hrs  theMin   themax    theAvg\n1        2012-10-23    2    2        59        29.6916666666667\n1        2012-10-23    4    3        89        31.7666666666667\n</code></pre>\n"},{"tags":["sql","constraints","foreign-key-relationship","sql-server-2012"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":39,"score":0,"question_id":13224918,"title":"SQL Foreign Key Constraint or a static value?","body":"<p>I have two tables:</p>\n\n<ul>\n<li>Customer (Id, Name, HomeAddressId)</li>\n<li>Address (Id, Street, City, State)</li>\n</ul>\n\n<p>I want to place a foreign key constraint on <code>Customer</code> so that the HomeAddressId is valid, but I also want to allow -1 as a valid value (even if it isn't one of the <code>Address.Id</code> values). Is this actually possible? And, if so... how?</p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13224886,"title":"Why does a left join return differently to a NOT IN?","body":"<p>The following query is behaving somewhat strangely:</p>\n\n<pre><code>SELECT #batches.OutTo, PO_Number, CONVERT(varbinary, #batches.OutTo) , convert     (varbinary, PO_Number), \n    CASE WHEN convert(varbinary, #batches.OutTo) NOT IN (SELECT convert(varbinary,    PO_Number) FROM #pos) \n         THEN 'NOT IN' ELSE 'IN' END\nFROM #batches LEFT JOIN #pos ON \n    convert(varbinary, #batches.OutTo) = CONVERT(varbinary, PO_Number)\nWHERE #batches.OutTo IS NOT NULL\nGROUP BY #batches.OutTo, #pos.PO_Number\n\n\nOutTo       PO_Number   (No column name)    (No column name)    (No column name)\n311117      NULL        0x333131313137      NULL                    IN\n311130      311130      0x333131313330      0x333131313330          IN\n311259      NULL        0x333131323539      NULL                    IN\nL001934     L001934     0x4C303031393334    0x4C303031393334        IN\nL001988     NULL        0x4C303031393838    NULL                    IN\nL002002     NULL        0x4C303032303032    NULL                    IN\n</code></pre>\n\n<p>As you can see, the left join behaves correctly, but the NOT IN does not, returning IN for values that should be NOT IN. Why is this? Is it a bug, or a feature of SQL I don't know about?</p>\n"},{"tags":["php","mysql","sql","mysqli"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13224614,"title":"If string in database contains number at end, it still should not generate string in php","body":"<p>I have a application which you can view <a href=\"http://helios.hud.ac.uk/u0867587/Mobile_app/Text6.php\" rel=\"nofollow\">here</a>. When you open the app, you will see a submit button, simply click on the button and you will see that it will generate  string underneath. If you keep clicking on the button it keeps generating 2 letter strings between letters \"A\" and \"B\". </p>\n\n<p>If in the database under the \"SessionId\" column, I have in a row string \"AB\". Then it would not generate string \"AB\" when I keep clicking on the submit button. I have tested this and this works fine. So this is not an issue if the string contains no number at the end.</p>\n\n<p>The problem I have is this. If I want to create multiple exams. Lets say the string is \"AA\" and that I have 3 exams, it does not insert string \"AA\" in the database as there are multiple \"AA\", so instead it concatenate a number after each \"AA\" in the database so that it displays it as \"AA1\", \"AA2\" and \"AA3\".</p>\n\n<p>But the problem is that if it does this then when you use the app again and keep clicking on the \"Submit\" button, you see that it still generates string \"AA\" when it shouldn't do as string \"AA\" was used in the database as \"AA1\", \"AA2\" and \"AA3\". I have these three values in the database at the moment yet it still generates the string in the application.</p>\n\n<p>So my question is that how can I stop it from generating the string in the application if the string is in the database with a number concatenated at the end of it?</p>\n\n<p>Below is the code for the application:</p>\n\n<pre><code>&lt;?php\n\n // connect to the database\n include('connect.php');\n\n  /* check connection */\n  if (mysqli_connect_errno()) {\n    printf(\"Connect failed: %s\\n\", mysqli_connect_error());\n    die();\n  }\n\n\nfunction id_generator(){ \n\n          $id = \"\"; \n          $a = array( \"A\" , \"B\", \"C\" ); \n\n      for( $i = 0 ; $i &lt; 2 ; $i++ ){ $r = rand( 0 , 1 );\n       $id .= $a[ $r ]; \n\n   }\n\n   return $id;\n\n   };\n\n   $is_there = true;\n\n      while( $is_there ){\n    $id = id_generator(); // your function to generate id;\n    $result = \"SELECT SessionId FROM Session WHERE SessionId LIKE CONCAT(?, '%')\";\n\n    $stmt=$mysqli-&gt;prepare($result);\n    // You only need to call bind_param once\n    $stmt-&gt;bind_param(\"1\",$id);\n    // execute query\n    $stmt-&gt;execute(); \n    // get result and assign variables (prefix with db)\n    $stmt-&gt;bind_result($dbSessionId);\n\n    $stmt-&gt;store_result();\n\n    $stmtnum = $stmt-&gt;num_rows();\n\n    if($stmtnum == 0) {\n    $is_there = false;\n}\n}\n\n ?&gt;\n\n    &lt;h1&gt;CREATING A NEW ASSESSMENT&lt;/h1&gt;\n\n        &lt;form action=\"&lt;?php echo htmlentities($_SERVER['PHP_SELF']); ?&gt;\" method=\"post\"&gt;\n        &lt;p&gt;\n        &lt;input id=\"courseSubmit\" type=\"submit\" value=\"Submit\" name=\"submit\" /&gt;\n        &lt;/p&gt;\n        &lt;/form&gt;\n\n        &lt;?php\nif (isset($_POST['submit'])) {\n\n        ?&gt;\n\n\n\n\n        &lt;br/&gt;\n\n         &lt;form action=\"QandATable.php\" method=\"post\" id=\"sessionForm\"&gt;\n         &lt;p&gt;&lt;strong&gt;1: Your Assessment ID: &lt;/strong&gt;&lt;span id=\"idFont\"&gt;&lt;?php echo $id; ?&gt;&lt;/span&gt;&lt;/p&gt;\n         &lt;input type='hidden' name='id' value='&lt;?php echo $id; ?&gt;' /&gt;\n\n\n        &lt;/form&gt;\n\n\n\n        &lt;?php\n\n        }\n        ?&gt;\n\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["php","sql","arrays","zend-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":28,"score":-2,"question_id":13224811,"title":"Zend SQL Array Select with Limit","body":"<p>I have a table, where I need to select rows that correspond to say some item. But from each of those items, I want to select only one of the rows!</p>\n\n<p>So how do I select multiples rows (saying <code>where('search_id = ?' $searchID)</code> with searchID being an array), but for each, I only select one of the rows?</p>\n"},{"tags":["sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13224764,"title":"Conditional statements in query designer report builder 3.0","body":"<p>I am using report builder with Excel as my data source. I am having a hard time creating a query text in the query designer. I get errors when i try conditional statements of simple group statements.</p>\n\n<p>I have this statement:</p>\n\n<pre><code> SELECT [Flight No],[Full Name],[Date],[Selected Routing 1] AS Routing,\n [Selected ETD 1] AS ETD,[Selected ETA 1] AS ETA\n FROM [Sheet1$]\n</code></pre>\n\n<p>this will return these values:</p>\n\n<pre><code> Flight No   Full Name     Date       Routing   ETD   ETA\n 1           Peter Hansen  10/1/2012  BNE-MEL   1755  2020\n 2           Black Hansen  10/2/2012  BNE-MEL   1756  2021+1\n</code></pre>\n\n<p>Now, i want to create a conditional statement that when ETA has a +1 on its number then the date will add 1. so the table should look like these:</p>\n\n<pre><code> Flight No   Full Name     Date       Routing   ETD   ETA\n 1           Peter Hansen  10/1/2012  BNE-MEL   1755  2020\n 2           Black Hansen  10/3/2012  BNE-MEL   1756  2021+1\n</code></pre>\n\n<p>I seem to get an error when i try to have an SQL statement like this in the report builder:</p>\n\n<pre><code> SELECT [Flight No],[Full Name],If([Selected ETA 1] LIKE '*+*',[Date]+1,[Date]) \n AS DATE, [Selected Routing 1] AS Routing,[Selected ETD 1] AS ETD,\n [Selected ETA 1] AS ETA\n FROM [Sheet1$]\n</code></pre>\n\n<p>The error says:</p>\n\n<pre><code> An error occurred while executing the query.\n ERROR [42000撛] [Microsoft][ODBC Excel Driver] Undefined function 'if' in expression.\n (Microsoft SQL Server Report Builder)\n\n ERROR [42000撛] [Microsoft][ODBC Excel Driver] Undefined function 'if' in expression.     \n (ACEODBC.DLL)\n</code></pre>\n\n<p>Please give me references if possible. Thanks!</p>\n"},{"tags":["sql","xml","sql-server-2008","tsql","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13223781,"title":"XML parsing error: 'A string literal was expected' when inserting values into table","body":"<p>In Microsoft SQL Server 2008 I am attempting to insert values into an sql table with the columns <strong>type_id of datatype int</strong> and <strong>xml_info of datatype XML</strong>. I am using the following query:</p>\n\n<pre><code>INSERT INTO tbl_applied_devices ([type_id],[xml_info])\nVALUES (1,'&lt;Profile ID=99&gt;&lt;Server&gt;&lt;ID&gt;BC4A18CA-AFB5-4268-BDA9-C990DAFE7783&lt;/ID&gt;  &lt;Name&gt;localhost&lt;/Name&gt;&lt;Services&gt;&lt;/Services&gt;&lt;/Server&gt;&lt;/Profile&gt;')\n</code></pre>\n\n<p>But I keep getting this error:</p>\n\n<blockquote>\n  <p>Msg 9413, Level 16, State 1, Line 4<br>\n  XML parsing: line 1, character 13, A string literal was expected  </p>\n</blockquote>\n\n<p>What am I doing incorrectly?</p>\n\n<p><strong>EDIT:</strong>\nI found that the source of the error is the xml element's ID attribute, <code>&lt;Profile ID=99&gt;</code> seems to be what is causing the error. How can I correctly insert xml with an attribute ? Do I need to somehow escape one of the characters?</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":50,"score":4,"question_id":13224164,"title":"ORDER BY depending on the column type","body":"<p>My table is as below:</p>\n\n<pre><code>a | b\n-----\n1 | a\n2 | b \n</code></pre>\n\n<p>In my query, I want to change the order by clause depending on the type of the column.</p>\n\n<p>So something like</p>\n\n<pre><code>get_data($order_by_column) {\n\n  ....\n  ORDER BY\n    CASE \n      WHEN is_numeric($order_by_column) THEN $order_by_column\n      ELSE CHAR_LENGTH($order_by_column)\n    END\n}\n</code></pre>\n\n<p>I've checked and it seems it's quite difficult to determine the column type dynamically like in the above query. What would be an alternative (or alternatives) to achieve this?</p>\n"},{"tags":["sql","ssrs-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13224365,"title":"SSRS - Drillthrough Expression","body":"<p>This is my expression for my drilldown....The field where I have set my drilldown has two values\n - Vacant\n - Occupied</p>\n\n<p>When vacant, it wil do this (it will do nothing and stay on the same report i.e. no drilldown.</p>\n\n<p>=iif(Fields!status.Value = \"Vacant\", Nothing, Globals!ReportName)</p>\n\n<p>But when 'Occupied' I want the drilldown to launch another report.  This is the path of the report.</p>\n\n<p>/RANNNIP/FYTR Reports/FYTRReport_Detail_drill</p>\n\n<p>Is it possible to have this in the same expression ? </p>\n\n<p>This is my current expression - but obviosuly not working</p>\n\n<p>=iif(Fields!status.Value = \"Vacant\", Nothing, Globals!ReportName) &amp; iif(Fields!status.Value = \"Occupied\", Globals!ReportFolder /RAN NGN/FYTR Reports/FYTRReport_Detail_drill)</p>\n"},{"tags":["sql","datetime","reporting-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13134334,"title":"SSRS Date time picker: allow user to pick the time component","body":"<p>I want to use a date-time picker to select a date <em>as well as the</em> time component. The calender allows me to pick a date but there's no possibility to choose the a specific time. </p>\n\n<p>I want to choose a start and end time, to select a subset out of lot of a data.</p>\n"},{"tags":["c#","sql","parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13218843,"title":"SQL Statement after adding parameters","body":"<p>Is it possible to see the sql statement after parameters have been replaced?</p>\n\n<pre><code>using(SqlCommand cmdInsert = new SqlCommand(\"INSERT INTO Table(Value_fkey) VALUES(@ValueKey)\", Database.Connection))\n{\n    cmdInsert.Parameters.AddWithValue(\"@ValueKey\", ValueKey);\n    System.Convert.ToInt32(cmdInsert.ExecuteScalar());\n}\n</code></pre>\n\n<p>I'd like it to log my sql statements, so rather not via SQL Server, but I don't mind whether it is before, or after calling the statement.</p>\n"},{"tags":["php","sql","pdo","adodb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":316,"score":0,"question_id":8580021,"title":"Method \"moveFirst()\" ADODB, PDO equivalence","body":"<p>Currently I use in my projects <strong>ADODB</strong> library for integration with the database.\nI want to migrate to <strong>PDO</strong>, but I have a question about the consultations.</p>\n\n<p>Currently, with the ADODB I do a query and use the row with the set numerous times using the method <strong>MoveFirst()</strong>.</p>\n\n<p>Example:</p>\n\n<pre><code>//I consultation\n$rs = $conn-&gt;execute('select * from mytable');\n\n//Loop through the results\nwhile(!$rs-&gt;EOF) {\n    echo $rs-&gt;fields('name');\n    $rs-&gt;MoveNext();\n}\n\n//I move the \"pointer\" to the beginning of the list\n$rs-&gt;MoveFirst();\n\n//I can go over the results without needing to re-select\nwhile(!$rs-&gt;EOF) {\n    echo $rs-&gt;fields('name');\n    $rs-&gt;MoveNext();\n}\n</code></pre>\n\n<p>I wonder if there is any way similar in PDO, so I do not need to run the query again.\nThe goal is to avoid unnecessary queries on the bench more often since they use the same query.</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1391,"score":3,"question_id":6134016,"title":"How to escape back slash in SQL server","body":"<pre><code>DECLARE @Query nvarchar(max)\nSET @Query ='DECLARE @Test nvarchar(max)\nSELECT @Test = ''\\a'\\b'\\c''\nSELECT @Test\nPRINT @Query\nexec sp_executesql @Query\n</code></pre>\n\n<p>I am trying to get an output as \\a\\b\\c. The above error is probably because I am not able to escape the \\ character.</p>\n"},{"tags":["mysql","sql","facebook","database-design","twitter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13223270,"title":"Database design pattern for storing user data coming from external websites","body":"<p>I'm working on an application which will allow users to register via <code>facebook</code> or <code>twitter</code> and I want to be able to use their personal data from these websites and wondering how I should store it. here is what I have come up with so far:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FnNlf.png\" alt=\"enter image description here\"></p>\n\n<p>The <code>user</code> table would store information that should be present regardless of how the user registered, such as the <code>first_name</code>.</p>\n\n<p>The <code>user_property</code> table would work as a <code>key-value</code> cache and store information that is specific to <code>facebook</code> or <code>twitter</code> (represented by the <code>origin</code> field). I would store properties that can be used as part of <code>API</code> calls or <code>SQL</code> queries individually, such as users' <code>facebook id</code> and I would store results of other <code>API</code> calls serialized in <code>JSON</code> format, such as users' <code>facebook friends</code>. </p>\n\n<p>That way:</p>\n\n<ul>\n<li>I have common information in <code>user</code> table and with one single <code>SELECT</code> I can get some basic useful info on a user</li>\n<li>I have some additional properties coming from <code>facebook/twitter</code> (e.g. user id) stored individually that I can still lookup with a <code>JOIN</code> between <code>user</code> and <code>user_property</code>.</li>\n<li>I can retrieve information that would too expensive to store normalized (e.g. creating a table to store people's friends and have 1 table entry per friend) still with a <code>JOIN</code> between <code>user</code> and <code>user_property</code>.</li>\n</ul>\n\n<p>And here is what I'm wondering right now:</p>\n\n<p><strong>Q1: Could this be a somewhat sustainable database design or am I getting it wrong and going to run into some issues, and if so, which ones?</strong> </p>\n\n<p><strong>Q2: When storing information that is subject to frequent changes (e.g. list of friends/followers), how do you go about keeping the information up to date (do you store information in the DB in the first place? if so what criteria/triggers do you use to decide when to pull information again)?</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13217122,"title":"Comma-separated string in IN clause of SQL query","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4462415/how-to-pass-a-variable-in-where-in-clause-of-oracle-sql\">how to pass a variable in WHERE IN clause of oracle sql?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a column <code>Prefix</code> in my table <code>Tbl_Prefix</code> with value as string separated by comma like this:</p>\n\n<pre><code>'aaa','bbb','ccc'\n</code></pre>\n\n<p>I have an employee table <code>Tbl_Employee</code> like this:</p>\n\n<pre><code>Empno Prefix\n------------\n1000  aaa\n2000  eee\n3000  ccc\n4000  aaa\n5000  ddd\n</code></pre>\n\n<p>I need to use this prefix in the <code>IN</code> portion of my <code>WHERE</code> clause in this query:</p>\n\n<pre><code>Select * \nfrom Tbl_Employee  \nwhere Tbl_Employee.Prefix  in (select  Tbl_Prefix.prefix \n                               from Tbl_Prefix \n                               where Tbl_Prefix.flag = 'y') \n</code></pre>\n\n<p>The inner select query <code>select Tbl_Prefix.prefix from Tbl_Prefix where Tbl_Prefix.flag='y'</code> has the result <code>'aaa','bbb','ccc'</code></p>\n\n<p>How to use this string in the 'IN' clause so that I will get a proper result?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13156617,"title":"SQL query caching","body":"<p>The first run of following query takes about 45 seconds and all the next ones only 1 second. Can you please explain what is the reason and how is it possible to make query run faster on the first execute too?</p>\n\n<pre><code>OPEN SYMMETRIC KEY TEST_KEY DECRYPTION BY PASSWORD='password'\n\nSELECT this.ID FROM SeparationFiles this\nINNER JOIN BarcodeValues b ON this.FIRST_BARCODE_ID = b.ID\nWHERE DecryptByKey(b.ENCRYPTED_VALUE, 0) = 'Peter'\n</code></pre>\n\n<p>Here is execution plan: </p>\n\n<p><img src=\"http://i.stack.imgur.com/u6dJt.png\" alt=\"Execution plan\"></p>\n"},{"tags":["sql","email","redis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13221475,"title":"Is Redis a good option in this scenario?","body":"<p>The company sends emails (thousands) only during 2 hours (i.e. from 1am to 3am), some days even less, during the night, to thousands users. Later it stops, and does nothing else; the next day we use the same process but with new data in those emails.</p>\n\n<p>The process we follow to send them is this:</p>\n\n<ol>\n<li><p>Take content-data/personal-information for emails from SQL database</p></li>\n<li><p>Build queues with these contents-data/personal-information in memory by using Redis</p></li>\n<li><p>Send emails taking content-data/personal-information from memory Redis</p></li>\n<li><p>Delete all content-data/personal-information in memory Redis.</p></li>\n</ol>\n\n<p>The problem is that I'm not sure about if Redis is a good option in this case. It's working, but I think that for only two hours it's not necessary to use Redis. I'm new in the company, so I didn't build that, but I don't understand why they made it like this. </p>\n"},{"tags":["sql","postgresql","date"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13222967,"title":"How to provide a date variable an interval that consists of an integer variable in Postgresql","body":"<p>I am trying to extract an amount of years from a specific date for this the correct syntax is</p>\n\n<pre><code>&lt;date&gt; - interval '5 years';\n</code></pre>\n\n<p>But I dont want to extract a specific amount of years but a variable, which user will provide as a parameter. I have tried the following the variable name is years :</p>\n\n<pre><code>date+interval '% years',years;\n</code></pre>\n\n<p>I am getting an error and it doesn't let me do it that way. What would be the right way to do it.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13223565,"title":"How can I split one record into two and set null values?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning TuesdayEvening and so on\n1   2012-01-01          2               3               2              2\n2   2012-01-02          2               2               2              2\n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning  TuesdayEvening\n1   2012-01-01          2               NULL          2                 2\n1   2012-01-01          NULL            3             NULL              NULL\n2   2012-01-02          2               2             2                 2\n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>I already have a query but, neem some changes. See the query on\n<a href=\"http://sqlfiddle.com/#!3/d41d8/5712\" rel=\"nofollow\">SQL Fiddle</a>.\nThe output you can see here is the case where it goes wrong. For TuesdayEvening and MondayEvening I am expecting 2.</p>\n\n<p>The information on SQL Fiddle is:</p>\n\n<pre><code>Declare @t Table(Id int identity,[Date] Datetime,MondayMorning Int,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int)\nInsert Into @t Select '2012-01-01',0,2,0,2\n\nSELECT id\n    ,date\n    ,MondayMorning\n    ,(CASE WHEN MondayEvening &lt;&gt; MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,TuesdayMorning\n    ,(CASE WHEN TuesdayEvening &lt;&gt; TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t \n\nUNION ALL \n\nSELECT id\n    ,date\n    ,NULL AS MondayMorning\n    ,(CASE WHEN MondayEvening = MondayMorning THEN NULL ELSE MondayEvening END) AS MondayEvening\n    ,NULL AS TuesdayMorning\n    ,(CASE WHEN TuesdayEvening = TuesdayMorning THEN NULL ELSE TuesdayEvening END) AS TuesdayEvening\nFROM @t\nWHERE --MondayMorning &lt;&gt; MondayEvening\n--OR TuesdayMorning &lt;&gt; TuesdayEvening\nMondayMorning &lt;&gt; MondayEvening\nAND (MondayMorning != 0 and MondayEvening != 0)\nOR TuesdayMorning &lt;&gt; TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\n</code></pre>\n"},{"tags":["sql","postgresql","constraints"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13219121,"title":"\"Column ’x’ does not exist\" error for string literal ’x’ in PostgreSQL","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13196572/column-mary-does-not-exist\">Column ‘mary’ does not exist</a>  </p>\n</blockquote>\n\n\n\n<p>I need to check the values that can be accepted to a column through a check constraint. I need to use the check constraint, because this is for a college assignment.</p>\n\n<p>I use this code to create and add the constraint to the table.</p>\n\n<pre><code>CREATE TABLE Ereignis(\n  E_Id Serial PRIMARY KEY,\n  Typ varchar(15),\n  Zeitpunkt timestamp,\n  Ort varchar(32),\n  Anzahl_Pers int\n);\n\nALTER TABLE Ereignis ADD \nCONSTRAINT typ_ch CHECK (Typ in (’Verkehrsunfall’, ’Hochwasser’, ’Sonstiges’));\n</code></pre>\n\n<p>Here is the error I get: </p>\n\n<pre><code> ERROR:  column \"’verkehrsunfall’\" does not exist\n</code></pre>\n\n<p>As I get from this error it tries to compare column typ with column verkehrsunfall, where as I try to check the values that column try can get is one of the (’Verkehrsunfall’, ’Hochwasser’, ’Sonstiges’) strings.</p>\n\n<p>This is exactly the same syntax what our lecturer showed us at the lecture. I am not sure if it is possible to compare varchars with check? Or what am I doing wrong?</p>\n\n<p>Here is the example from the lecture:</p>\n\n<pre><code>CREATE TABLE Professoren \n(PersNr INTEGER PRIMARYKEY,\n Name VARCHAR( 3 0 ) NOT NULL ,\n Rang CHAR(2) CHECK (Rang in ('C2' ,'C3' ,'C4')) , \n Raum INTEGER UNIQUE) ;\n</code></pre>\n"},{"tags":["c#","sql","nosql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":29,"score":-5,"question_id":13223528,"title":"how to transfer all data from a SQL database to NoSQL database?","body":"<p>I am new to NoSQL.\nI have a task, where i should store all the data from a SQL database to a NoSQL database.\nMy question is how to handle this situation and where i should start? </p>\n"},{"tags":["sql","ms-access"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2377,"score":1,"question_id":6018172,"title":"Update A multi-valued field in Access","body":"<p>I have created a lookup table in Access to provide the possible values for a column. Now I need to update this column with the data it had before I converted the column. I am unable to figure out a SQL Query that will work. I keep getting the error \"An UPDATE or DELETE query cannot contain a multi-valued field.\" My research has suggested that I just need to set the value of the column but this always updates 0 records:</p>\n\n<pre><code>UPDATE [table_name] SET [column_name].Value = 55 WHERE [table_name].ID = 16;\n</code></pre>\n\n<p>I know this query will work if I change it to update a text column, so it is definitely a problem with just this column.</p>\n"},{"tags":["sql","distributed-system","filetable"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":32,"score":-1,"question_id":13223217,"title":"Want to sort of create a distributed file system?","body":"<p>Where I work there is about 400 employees split between several campuses at the two main campuses we have servers set up and shared folders on the servers. I want to setup a system so  we have one shared folder that users see but then have copies of all the files on both servers and access the files based on which campus the user is at to stop people having wait while files transfer, and then only if a file is changed force them to have to access the latest copy of the file, and then transfer all files changed overnight so it is not slowing down the network during the day. </p>\n\n<p>Can anyone tell me is there a system that already does this? Or what keywords I should be using when trying to search for a system that does this?</p>\n\n<p>I have been looking at creating a system to do this using MS SQL Server 2012 FileTables and putting triggers on the tables to check which table had the latest copy of the file and creating a store procedure to compress and transfer changed files overnight.</p>\n"},{"tags":["mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13213624,"title":"How to find percentages of values in SQL?","body":"<p>I use following query to find out percentage of winning by Hero in games:</p>\n\n<pre><code>SELECT Hero, (COUNT(*) * g.games) AS p\nFROM gamestatistics\nJOIN (\nSELECT 100/COUNT(*) AS games\nFROM gamestatistics\n) AS g\nWHERE PointEarned&gt;0\nGROUP BY Hero\nORDER BY p DESC\n</code></pre>\n\n<p>But this gives me percent for ALL games. And I want  to know</p>\n\n<blockquote>\n  <p><code>percentage(for Hero)=(Won games by this player)/(Played games by this hero)</code></p>\n</blockquote>\n\n<p>instead of</p>\n\n<blockquote>\n  <p>percentage(for Hero)=(Won games by this player)/(All games)<br>\n  Thanks.</p>\n</blockquote>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13223223,"title":"mysql query getting all fields in table 1 and partial in from table two","body":"<p>Coming back to my very old mysql skills I have need of the following query.</p>\n\n<p>I have two tables </p>\n\n<p>One is a table of all items called products with cols item name, item num</p>\n\n<p>Two is a table of purchased items with cols item num, date</p>\n\n<p>What I need as a result is something like this</p>\n\n<pre><code>ITEM-----PURCHASED\nitem1-------0 \nitem2-------0\nitem3-------0\nitem4-------1  This item purchased\nitem5-------0\nitem6-------1  This item purchased\nitem7-------0\nitem8-------0\n.\n.\n.\nitemX-------0\n</code></pre>\n\n<p>Output contains all items and a 1 in the purchased col if the item exist in the purchased items table\nand a 0 if it has NOT been purchased.</p>\n\n<p>I am sorry if this is easy my brain is in meltdown mode currently and it has been a long time I have needed something like this</p>\n"},{"tags":["mysql","sql","visitor-statistic"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13220121,"title":"SQL , count equivalent values in each column","body":"<p>I'm working on a URL shortener project with PHP &amp; MYSQL which tracks visits of each url. I've provided a table for visits which mainly consists of these properties :  </p>\n\n<pre><code>time_in_second | country | referrer |  os   | browser | device | url_id\n#####################################################################\n1348128639     |    US   |   direct |  win  | chrome  | mobile | 3404  \n1348128654     |    US   |   google | linux | chrome  | desktop| 3404  \n1348124567     |    UK   |   twitter| mac   | mozila  | desktop| 3404  \n1348127653     |    IND  |   direct | win   | IE      | desktop| 3465  \n</code></pre>\n\n<p>Now I want to make a query on this table. for example I want to get visits data for the url with <code>url_id=3404</code>. Because I should <em>provide statistics and draw graphs</em>, for this url, I need these data:  </p>\n\n<ul>\n<li>Number of each kind of OS for this URL , for example 20 windows, 15 linux , ...</li>\n<li>Number of visits in each desired period of time , for example each 10 minutes in past 24 hour</li>\n<li>Number of visits for each country</li>\n<li>...  </li>\n</ul>\n\n<p>As you see, some data like country may accept lots of different values.  </p>\n\n<p>One good idea which I can imagine is to make query which outputs number of each unique value in each column, for example in the country case for the data given above, on column for <code>num_US</code>, one for <code>num_UK</code>, and one for <code>num_IND</code>.  </p>\n\n<p>Now the question is how to implement such a high-performance query in sql (MYSQL) ?  </p>\n\n<p>Also if you think this is not an efficient query for performance, what's your suggestion?  </p>\n\n<p>Any help will be appreciated deeply. </p>\n\n<p><strong>UPDATE:</strong> look at this question : <a href=\"http://stackoverflow.com/questions/915260/sql-only-count-the-values-specified-in-each-column\">SQL; Only count the values specified in each column</a> . I think this question is similar to mine , but the difference is in variety of values possible (as lots of values are possible for <code>country property</code>) for each column which makes the query more complex.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13210510,"title":"Dragging some rows in the middle of the table","body":"<p>So as i say , is possible copy each row and put it on the row below or as the same move field rows to the fields below? ( have and index auto increment of course ).The result should be the old row 40 content (fields) in the row 41 and so. </p>\n\n<pre><code>REPLACE table SET column1 = previuos(column1), column2= previous(column2), column3=(previous(column3)  where id &gt; 20 and id &lt; 300 \n</code></pre>\n\n<p>They are not the last inserted, they are in the middle of the table and want to move it down , so that let me some empty rows ( with the index ) at the beginning of the selected ones</p>\n\n<pre><code>  INSERT INTO table (\n  SELECT column1,column2,column3 \n  FROM  table  WHERE id &gt; 20 AND id &lt; 200\n  ) WHERE id = 30 \n</code></pre>\n\n<p>selected row from 21 to 199 then inserted on 30 and ahead</p>\n\n<p>thank you</p>\n"},{"tags":["sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13222602,"title":"The min () to improve","body":"<p>This is my database project.</p>\n\n<p>table <strong>user_</strong></p>\n\n<pre><code>select id, name from user_;\n\n id |   name\n----+----------\n  1 | bartek\n  2 | bartek_m\n  3 | bartek_k\n  4 | bartek_b\n</code></pre>\n\n<p>table <strong>order_</strong></p>\n\n<pre><code>select id, employee_id, user_id from order_;\n\n id | employee_id | user_id\n----+-------------+---------\n  1 |           3 |       1\n  2 |           4 |       1\n  3 |           4 |       1\n  4 |           4 |       1\n  5 |           3 |       1\n</code></pre>\n\n<p>Every user has a role(I don't add table role_ here but it exist).\nID of every user with role employee can be assigned to order_.employee_id \nI need obtain user with minimum number of orders </p>\n\n<pre><code>select a.id, min(a.count) from (\n    select u.id, count(u.id) from user_ u, order_ o\n    where u.id = o.employee_id\n    group by u.id\n) as a group by a.id, a.count\n\n id | min\n----+-----\n  4 |   3\n  3 |   2\n</code></pre>\n\n<p>I think that my query is wrong. Could anyone change query to return \n only ID this user which have minimum number of orders?</p>\n"},{"tags":["sql","count","group-by","inner-join"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13222218,"title":"SQL Count Innerjoin by Grouping","body":"<p>I have searched all the SQL questions and I have found every version of what I don't want - so I need to ask.  I am in a brain lock - knowing there is a count and sum and group and a join all thrown together.</p>\n\n<p><strong>2 Tables</strong> </p>\n\n<ol>\n<li>CustomerTable - CustID, CustQuality (values are good customer, bad customer, new customer etc)</li>\n<li>PurchaseTable (PurchID, PurchItem, PurchDate)</li>\n</ol>\n\n<p>I am trying to count how many purchases by Good, Bad, New Customers in the last 30 days.</p>\n\n<p>I have tried the join and group count etc and I keep getting:</p>\n\n<ul>\n<li>GoodCustomer - CustID2 - 1 purch</li>\n<li>GoodCustomer - CustID3 - 3 purch</li>\n<li>GoodCustomer - CustID4 - 2 purch</li>\n<li>BadCustomer - CustID7 - 2 purch</li>\n<li>BadCustomer - CustID1 - 4 purch</li>\n<li>NewCustomer - CustID9 - 1 purch</li>\n<li>NewCustomer - CustID4 - 4 purch etc etc.</li>\n</ul>\n\n<p><strong>I just want the overall results</strong></p>\n\n<ul>\n<li>3 Good Customers made 6 Purchases </li>\n<li>2 Bad Customers made 6 Purchases </li>\n<li>2 New Customers made 5 Purcahses</li>\n</ul>\n\n<p>THEN FOR ADDITIONAL functioning...  I have a 3rd table that I need to join as well. CustomerLocation (CLID, CLLocation (values of North, South, East, West))</p>\n\n<p>So if I wanted to know the following break down of the groups</p>\n\n<ul>\n<li>3 Good Customers made 6 Purchases - 1 Customer was from the North, 2 Customers From South</li>\n<li>2 Bad Customers made 6 Purchases - 5 Customer from East, 1 West</li>\n<li>2 New Customers made 5 Purcahses - 2 Customer from South</li>\n</ul>\n\n<p>And the last new query would be...\nWHERE CLLocation = South</p>\n\n<p>Or if I wanted to look up by region...</p>\n\n<ul>\n<li>1 Good Customers made 3 Purchases</li>\n<li>2 Bad Customers made 2 Purchases</li>\n<li>0 New Customers made 0 Purcahses</li>\n</ul>\n\n<p><strong>I KNOW I AM ASKING A LOT - BUT ANY AND ALL HELP WOULD BE GREATLY APPRECIATED!</strong></p>\n"},{"tags":["c#","sql","nhibernate","datetime","like"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13220787,"title":"NHibernate LIKE query on date column","body":"<p>I'm using the following code to dynamically filter data (I'm using MySQL as a DB engine):</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var filter = string.Empty;\nif (!string.IsNullOrWhiteSpace(filterNumber))\n{\n    filter = \"t.Number LIKE :filterNumber\";\n}\nvar query = string.Format(\"SELECT t FROM Table t WHERE 1=1 AND {0} ORDER BY {1} {2}\", filter, orderBy, orderDirection);\nvar q = Session.CreateQuery(query);\nif (!string.IsNullOrWhiteSpace(filterNumber))\n{\n    q.SetParameter&lt;string&gt;(\"filterNumber\", \"%\" + filterNumber + \"%\");\n}\nq.SetFirstResult(offset);\nq.SetMaxResults(limit);\nreturn q.List&lt;Table&gt;();\n</code></pre>\n\n<p>(assume that <code>filterNumber</code>, <code>orderBy</code>, <code>orderDirection</code>, <code>offset</code> and <code>limit</code> are method's parameters and <code>1=1</code> was added only for the sake of this question so the query always work)</p>\n\n<p>It does work when Number is a string (VARCHAR in MySQL) column but it does not work when it is a datetime or integer column.</p>\n\n<p>For datetime it raises the exception:\n<code>could not execute query […] Name:filterDate - Value:%2012%</code> and inner exception is <code>Specified cast is not valid</code>.</p>\n\n<p>For integer/float columns the exception is:\n<code>could not execute query […] Name:filterPrice - Value:%100%</code> and inner exception is <code>Input string was not in a correct format</code>.</p>\n\n<p>(<code>Date</code> and <code>Price</code> are another columns in the table)</p>\n\n<p>How to dynamically create such a LIKE query on date/numbers columns? This kind of query works well in MySQL:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM `Table` WHERE `Date` LIKE '%2012%'\n</code></pre>\n"},{"tags":["sql","vb.net","tsql","ado.net","oledb"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2980,"score":0,"question_id":6414032,"title":"VB.NET Using a SELECT statement to return a row where a DateTime column = variable of type Date?","body":"<p>I am using OleDb, trying to do this:</p>\n\n<pre><code>Dim d as Date = DateSerial(Year(rptDate), Month(rptDate), 1 - 1)\n\nDim conn as OleDbConnection = new OleDbConnection(connStr)\nDim cm as OleDbCommand = new OleDbCommand()\n\nconn.Open()\ncm.Connection = conn\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = \" &amp; d\n</code></pre>\n\n<p>Okay, so I know it returns 1 row because I'm staring at it in SQL Server. Here is what I've tried so far for the query in the last line, none work:</p>\n\n<pre><code>\"SELECT * FROM history WHERE ReportDate = \" &amp; d\n\"SELECT * FROM history WHERE ReportDate = \" &amp; d.toString(\"G\")\n\"SELECT * FROM history WHERE ReportDate = '\" &amp; d &amp; \"'\"\n\"SELECT * FROM history WHERE ReportDate = '\" &amp; d.toString(\"G\") &amp; \"'\"\n\"SELECT * FROM history WHERE ReportDate = '#\" &amp; d &amp; \"#'\"\n\"SELECT * FROM history WHERE ReportDate = #\" &amp; d &amp; \"#\" 'These last 2 with toString\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>cm.CommandText = \"SELECT * FROM history WHERE ReportDate = ?\"\ncm.Parameters.Add(d)\n\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = ?\"\ncm.Parameters.Add(d.toString(\"G\"))\n\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = '?'\"\ncm.Parameters.Add(d.toString(\"G\"))\n\ncm.CommandText = \"SELECT * FROM history WHERE ReportDate = '?'\"\ncm.Parameters.Add(d)\n</code></pre>\n\n<p>Clearly I am missing something here, help? I know that <code>d</code> is the same date as the one in SQL server, specifically <code>3/31/2011 12:00:00 AM</code>.</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","postgresql","pivot"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":51,"score":3,"question_id":13168066,"title":"How do I transpose rows and columns (a.k.a. perform a pivot) in PostgreSQL only for rows and columns with a minimum COUNT()?","body":"<p>Here's my table 'tab_test':</p>\n\n<pre><code>year    animal  price\n2000    kittens 79\n2000    kittens 93\n2000    kittens 100\n2000    puppies 15\n2000    puppies 32\n2001    kittens 31\n2001    kittens 17\n2001    puppies 65\n2001    puppies 48\n2002    kittens 84\n2002    kittens 86\n2002    puppies 15\n2002    puppies 95\n2003    kittens 62\n2003    kittens 24\n2003    puppies 36\n2003    puppies 41\n2004    kittens 65\n2004    kittens 85\n2004    puppies 58\n2004    puppies 95\n2005    kittens 45\n2005    kittens 25\n2005    puppies 15\n2005    puppies 35\n2006    kittens 50\n2006    kittens 80\n2006    puppies 95\n2006    puppies 49\n2007    kittens 40\n2007    kittens 19\n2007    puppies 81\n2007    puppies 38\n2008    kittens 37\n2008    kittens 51\n2008    puppies 29\n2008    puppies 72\n2009    kittens 84\n2009    kittens 26\n2009    puppies 49\n2009    puppies 34\n2010    kittens 75\n2010    kittens 96\n2010    puppies 18\n2010    puppies 26\n2011    kittens 35\n2011    kittens 21\n2011    puppies 90\n2011    puppies 18\n2012    kittens 12\n2012    kittens 23\n2012    puppies 74\n2012    puppies 79\n</code></pre>\n\n<p>Here's some code that transposes the rows and columns so I get an average for 'kittens' and 'puppies':</p>\n\n<pre><code>SELECT\n    year,\n    AVG(CASE WHEN animal = 'kittens' THEN price END) AS \"kittens\",\n    AVG(CASE WHEN animal = 'puppies' THEN price END) AS \"puppies\"\nFROM tab_test\nGROUP BY year\nORDER BY year;\n</code></pre>\n\n<p>The output for the code above is:</p>\n\n<pre><code>    year    kittens puppies\n    2000    90.6666666666667    23.5\n    2001    24.0    56.5\n    2002    85.0    55.0\n    2003    43.0    38.5\n    2004    75.0    76.5\n    2005    35.0    25.0\n    2006    65.0    72.0\n    2007    29.5    59.5\n    2008    44.0    50.5\n    2009    55.0    41.5\n    2010    85.5    22.0\n    2011    28.0    54.0\n    2012    17.5    76.5\n</code></pre>\n\n<p>What I'd like is a table like the second one, but it would only contain items which had a COUNT() of at least 3 in the first table. In other words, the goal is to have this as the output:</p>\n\n<pre><code>year    kittens\n2000    90.6666666666667\n</code></pre>\n\n<p>There were at least 3 instances of 'kitten' in the first table.</p>\n\n<p>Is this possible in PostgreSQL?</p>\n"},{"tags":["sql","sql-server","join","left-join","outer-join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13221154,"title":"How can I get join not duplicate?","body":"<p>I get join 2 tables but use 3 table. I need not duplicate values. But I try join have duplicate.</p>\n\n<p>Table <code>peopleAll</code>:</p>\n\n<pre><code>pNo    pName\n-------------\n00001  Sang\n00002  Janta\n00003  Els\n00004  Est\n00005  Sam\n00006  John\n00007  Misan\n00008  Wila\n00009  light\n00010  Smith\n00011  Ritpo\n</code></pre>\n\n<p>Table <code>fTime</code>:</p>\n\n<pre><code>cNo    cDate                     cIn                        cOut\n-----------------------------------------------------------------------------------\n00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n</code></pre>\n\n<p>Table <code>Leave</code>:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n</code></pre>\n\n<p>This SQL code:</p>\n\n<pre><code>SELECT lr.lNo, lr.lDate, lr.lStart, lr.lStop \nFROM Leave lr \nWhere lr.cStart = '2012-10-22'\n\nUNION ALL\n\nSELECT pa.pNo, ISNULL(tf.cDate, Convert(nvarchar(10),'2012-10-22',114)),tf.cIn, tf.cOut\nFROM fTime tf FULL OUTER join peopleAll pa On tf.cNo = pa.pNo AND \ntf.cDate = Convert(nvarchar(10),'2012-10-22',114)\n</code></pre>\n\n<p>returns this output:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000\n00006  2012-10-22 00:00:00.000   NULL                       NULL\n00007  2012-10-22 00:00:00.000   NULL                       NULL\n00008  2012-10-22 00:00:00.000   NULL                       NULL\n00009  2012-10-22 00:00:00.000   NULL                       NULL\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n</code></pre>\n\n<p>I try to change <code>FULL OUTER JOIN</code> then <code>LEFT OUTER JOIN</code> and I get output:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000\n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00007  2012-10-22 00:00:00.000   NULL                       NULL\n00008  2012-10-22 00:00:00.000   NULL                       NULL\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n</code></pre>\n\n<p>LEFT OUTER join have miss some field??</p>\n\n<p>I need this output:</p>\n\n<pre><code>lNo    lDate                     lStart                     lStop\n-----------------------------------------------------------------------------------\n00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000\n00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000 \n00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000\n00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000\n00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000\n00006  2012-10-22 00:00:00.000   NULL                       NULL\n00007  2012-10-22 00:00:00.000   NULL                       NULL\n00008  2012-10-22 00:00:00.000   NULL                       NULL\n00009  2012-10-22 00:00:00.000   NULL                       NULL\n00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000\n00011  2012-10-22 00:00:00.000   NULL                       NULL\n\n(00002,00003 from fTime)\n</code></pre>\n\n<p>Please help me. Thanks you for you time. :)</p>\n"},{"tags":["sql","sql-server","query","insert","character"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13218271,"title":"SQL statement using special charter","body":"<p>Can anyone please help me in correcting below statement:</p>\n\n<pre><code>SET @cmd='BULK INSERT ' + @Database + '.dbo.' + @tmp + ' from ' + @Out + @tmp + '.csv \nWITH (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)' \n</code></pre>\n\n<p>Output of the above query is: </p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR = , , ROWTERMINATOR = \\n)</p>\n</blockquote>\n\n<p>I want to print this in below manner:</p>\n\n<blockquote>\n  <p>BULK INSERT MP2.dbo.GLCODE from C:\\SABA\\GLCODE.csv WITH\n  (FIELDTERMINATOR =',', ROWTERMINATOR = '\\n')</p>\n</blockquote>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13222135,"title":"Select mutiples of one field","body":"<p>Is it possible to select individual rows within a table from a list of one column variables?</p>\n\n<p>e.g. i'm trying to select just certain products from a table of products, using a list of ID numbers</p>\n\n<p>Example table \"items\":</p>\n\n<pre><code>item_id    item_title    item_source\n-------    ----------    -----------\n123        item A        place_a\n124        item B        place_b\n125        item C        place_c\n126        item D        place_d\n</code></pre>\n\n<p>Here's what I'm trying, but it's not working:</p>\n\n<pre><code>select item_title, item_source from items where item_id IN ('123','125','126')\n</code></pre>\n\n<p>I want to return:</p>\n\n<pre><code>item A        place_a\nitem C        place_c\nitem D        place_d\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","adventureworks"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13220573,"title":"Adventure Works Explanation","body":"<p>I've been looking at Microsoft's Adventure Works 2012 database. I'd be very interested if there's any information explaining why the tables were created as they are. Some sort of schema overview I guess.</p>\n\n<p>For example: </p>\n\n<p>Why they chose to create a <code>BusinessEntity</code> table as a sort of base class for Person, Employee, etc.</p>\n\n<p>Most of the data is normalized so why they chose to put the <code>CountryRegionCode</code> field into the <code>StateProvince</code> table instead of an ID to a separate table.</p>\n\n<p>Anyway I'm very interested in learning more about the decisions that went into the databases design. Anyone know a resource that goes into this sort of thing?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13221588,"title":"SQL retrieve info from multiple tables","body":"<p>i have a question about sql and i need to know if i can retrieve results using only sql.</p>\n\n<p>I need to find the distance in km of the route with the id=1 that starts from station 1 and arrive at station 4. So route 1 will pass from 4 stations (the number could be more or less). I need to find the distance that a train will cover crossing all the 4 stations. Which are: 5+10+15=30</p>\n\n<p>is it possible to get the answer using only SQL?</p>\n\n<p>below are the tables (i hope you understand the structure):</p>\n\n<p>you can see an image of the table <a href=\"http://studio9.com.cy/testing/sql.gif\" rel=\"nofollow\">here</a></p>\n\n<pre><code>route - station\n-----------------------\n1     - 1    \n1     - 2    \n1     - 3    \n1     - 4\n\n\nstation1 - station2 - distance (km)\n------------------------------------\n1        - 2        -   5\n2        - 3        -   10\n3        - 4        -   15\n</code></pre>\n"},{"tags":["sql","sql-server-2008","datetime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13221690,"title":"Can I calculate there's how many weekend days between two dates in SQL Server?","body":"<p>I'm calculating income of hiring equipments for a report. In that, hiring cost in weekend days will be plus 10% more if compare with normal days. So how can I calculate there's how many weekend days between two dates. And in report query, I can't use DECLARE also. Can someone help me to do this. Thank you so much</p>\n"},{"tags":["android","sql","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13221839,"title":"Android SQLite values selection","body":"<p>I'm new to android and SQLite,</p>\n\n<p>is my following code correct?</p>\n\n<pre><code>SQLiteDatabase aa = openOrCreateDatabase(\"MLIdata\", MODE_WORLD_READABLE, null);\nCursor c = aa.rawQuery(\"SELECT CblocationName FROM MLITable WHERE CblocationCode = '\"+str+\"'\", null);\nc.moveToFirst();\nc.getString(c.getColumnIndex(\"CblocationName\"));\n</code></pre>\n\n<p>I doubt that my SQL query is wrong (i.e, rawQuery line in my above code).</p>\n\n<p>Thank you.</p>\n"},{"tags":["php","sql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13221762,"title":"I can't get INSERT INTO to work with php","body":"<p>I really have no idea what I am doing wrong. All other queries (SELECT-queries) work without any problem, but this doesn't seem to work. Any ideas?</p>\n\n<pre><code>&lt;?php\nsession_start();\n\n$host=\"*******\"; // Host name \n$username=\"*******\"; // Mysql username \n$password=\"*******\"; // Mysql password \n$db_name=\"*******\"; // Database name \n$from = $_GET['from'];\n$to = $_GET['to'];\n\n// Connect to server and select databse.\n$con = mysql_connect(\"$host\", \"$username\", \"$password\")or die(\"cannot connect\"); \nmysql_select_db(\"$db_name\",$con)or die(\"cannot select DB\");\n\n\nmysql_query(\"INSERT INTO message('from', 'to', 'message', 'confirm') VALUES (2,3,'would like to add you as a friend',1)\");\n\necho'The request has been sent.';\n\n\n\n\n\n?&gt;\n</code></pre>\n"},{"tags":["sql","vb.net","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2095,"score":0,"question_id":9784301,"title":"Inserting data from a DataGridView to a database","body":"<p>I have a small DataGridView which lets the user enter data.</p>\n\n<p><img src=\"http://i.stack.imgur.com/SljPE.png\" alt=\"Ths is the grid\"></p>\n\n<p>And I'm trying this code to enter the data in the DataGridView to the database.</p>\n\n<pre><code>    strQry = \"INSERT INTO Emp_Fam_Details (empID, famName, famAge, famRelation, famOccup)\" _\n            &amp; \"VALUES (@ID, @Name, @Age, @Rel, @Occ)\"\n    Dim adapFam As New SqlDataAdapter\n    adapFam.InsertCommand = New SqlCommand(strQry, sqlcon)\n\n    For i As Integer = 0 To grdFamily.Rows.Count - 1\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@ID\", txtEmpID.Text.Trim)\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Name\", grdFamily.Columns(0))\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Age\", grdFamily.Columns(1))\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Rel\", grdFamily.Columns(2))\n        adapFam.InsertCommand.Parameters.AddWithValue(\"@Occ\", grdFamily.Columns(3))\n\n        result2 = adapFam.InsertCommand.ExecuteNonQuery()\n    Next\n</code></pre>\n\n<p>When I run this, I come across this error.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Nf1X4.png\" alt=\"This is the error\"> </p>\n\n<p>I found <a href=\"http://stackoverflow.com/a/9391411/1077789\">this</a> solution here on SO but since I'm using Parameters not appended values, I'm having a hard time understanding how to do it with parameters. </p>\n\n<p>Can anyone please show me how to do this? </p>\n\n<p>Thank you all. </p>\n"},{"tags":["sql","sql-server","join","pagination"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13220743,"title":"Implement paging (skip / take) functionality with this query","body":"<p>I have been trying to understand a little bit about how to implement custom paging in SQL, for instance reading <a href=\"http://stackoverflow.com/questions/548475/efficient-way-to-implement-paging\">articles like this one</a>.</p>\n\n<p>I have the following query, which works perfectly. But I would like to implement paging with this one.</p>\n\n<pre><code>SELECT TOP x PostId FROM ( SELECT PostId, MAX (Datemade) as LastDate\n from dbForumEntry \n group by PostId ) SubQueryAlias\n order by LastDate desc\n</code></pre>\n\n<p><strong>What is it I want</strong></p>\n\n<p>I have forum posts, with related entries. I want to get the posts with the latest added entries, so I can select the recently debated posts.</p>\n\n<p>Now, I want to be able to get the \"top 10 to 20 recently active posts\", instead of \"top 10\".</p>\n\n<p><strong>What have I tried</strong></p>\n\n<p>I have tried to implement the ROW functions as the one in the article, but really with no luck. </p>\n\n<p>Any ideas how to implement it?</p>\n"},{"tags":["sql","mysql"],"answer_count":8,"favorite_count":7,"up_vote_count":12,"down_vote_count":0,"view_count":7608,"score":12,"question_id":3856435,"title":"How to convert all tables from MyISAM into InnoDB?","body":"<p>I know I can issue an alter table individually to change the table storage from MyISAM to InooDB.</p>\n\n<p>I am wondering if there is a way to quickly change all of them to InnoDB?</p>\n"},{"tags":["asp.net","sql","sql-management-studio","mdf","app-data"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":234,"score":1,"question_id":11487170,"title":"Run SQL script on MDF file in App_Data","body":"<p>I have the following setup:</p>\n\n<ul>\n<li>Development: My own computer using an MDF file with a connectionstring which refers to my app_data folder. </li>\n<li>Production: An online server with its own SQL database</li>\n</ul>\n\n<p>When I want to create a new table / fields in my system, I create it in deployment and then run those scripts on production without data.</p>\n\n<p>Now, I am in the opposite situation: I've generated scripts from my production server, and wants to run those towards my local MDF file.</p>\n\n<p>How do I do that? All the answers i've seen so far doesn't help me.</p>\n\n<p><strong>I've tried the following</strong>:</p>\n\n<p>I've tried to run the whole SQL script in the \"Run query\" in Visual Studio, but I get a \"The Set SQL construct or statement is not supported.\" error.</p>\n\n<p>I guess I have to open the MDF file somehow in Microsoft SQL Management Studio - but I can't really find a way to get it all to work.</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p>After half a year, I've been using the method suggested as the answer again and again. It is by far the best solution. No more MDF files in the project!</p>\n\n<p>I would strongly suggest anyone reading this to start having your databases in your local database.</p>\n"},{"tags":["c#","sql","linq","wildcard"],"answer_count":8,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":10005,"score":9,"question_id":1040380,"title":"Wildcard search for LINQ","body":"<p>I would like to know if it is possible to do a wildcard search using LINQ.</p>\n\n<p>I see LINQ has Contains, StartsWith, EndsWith, etc.</p>\n\n<p>What if I want something like %Test if%it work%, how do I do it?</p>\n\n<p>Regards</p>\n"},{"tags":["sql","sqlite","core-data"],"answer_count":3,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":484,"score":13,"question_id":13219472,"title":"Why SELECT 0, ... instead of SELECT","body":"<p>Lets say I have a SQLite database that contains a table:</p>\n\n<pre><code>sqlite&gt; create table person (id integer, firstname varchar, lastname varchar);\n</code></pre>\n\n<p>Now I want to get every entry which is in the table.</p>\n\n<pre><code>sqlite&gt; select t0.id, t0.firstname, t0.lastname from person t0;\n</code></pre>\n\n<p>This works fine and this it what I would use. However I have worked with a framework from Apple (Core Data) that generates SQL. This framework generates a slightly different SQL query:</p>\n\n<pre><code>sqlite&gt; select 0, t0.id, t0.firstname, t0.lastname from person t0;\n</code></pre>\n\n<p>Every SQL query generated by this framework begins with \"select 0,\". Why is that?</p>\n\n<p>I tried to use the explain command to see whats going on but this was inconclusive - at least to me.</p>\n\n<pre><code>sqlite&gt; explain select t0.id, t0.firstname, t0.lastname from person t0;\naddr        opcode      p1          p2          p3          p4          p5          comment   \n----------  ----------  ----------  ----------  ----------  ----------  ----------  ----------\n0           Trace       0           0           0                       00          NULL      \n1           Goto        0           11          0                       00          NULL      \n2           OpenRead    0           2           0           3           00          NULL      \n3           Rewind      0           9           0                       00          NULL      \n4           Column      0           0           1                       00          NULL      \n5           Column      0           1           2                       00          NULL      \n6           Column      0           2           3                       00          NULL      \n7           ResultRow   1           3           0                       00          NULL      \n8           Next        0           4           0                       01          NULL      \n9           Close       0           0           0                       00          NULL      \n10          Halt        0           0           0                       00          NULL      \n11          Transactio  0           0           0                       00          NULL      \n12          VerifyCook  0           1           0                       00          NULL      \n13          TableLock   0           2           0           person      00          NULL      \n14          Goto        0           2           0                       00          NULL \n</code></pre>\n\n<p>And the table for the second query looks like this:</p>\n\n<pre><code>sqlite&gt; explain select 0, t0.id, t0.firstname, t0.lastname from person t0;\naddr        opcode      p1          p2          p3          p4          p5          comment   \n----------  ----------  ----------  ----------  ----------  ----------  ----------  ----------\n0           Trace       0           0           0                       00          NULL      \n1           Goto        0           12          0                       00          NULL      \n2           OpenRead    0           2           0           3           00          NULL      \n3           Rewind      0           10          0                       00          NULL      \n4           Integer     0           1           0                       00          NULL      \n5           Column      0           0           2                       00          NULL      \n6           Column      0           1           3                       00          NULL      \n7           Column      0           2           4                       00          NULL      \n8           ResultRow   1           4           0                       00          NULL      \n9           Next        0           4           0                       01          NULL      \n10          Close       0           0           0                       00          NULL      \n11          Halt        0           0           0                       00          NULL      \n12          Transactio  0           0           0                       00          NULL      \n13          VerifyCook  0           1           0                       00          NULL      \n14          TableLock   0           2           0           person      00          NULL      \n15          Goto        0           2           0                       00          NULL     \n</code></pre>\n"},{"tags":["php","sql","passwords"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13212797,"title":"let user change their own password?","body":"<p>I am just starting to learn php and sql so please go easy on me, i know i'm going to be wrong in certain places. I am trying to allow a user to login and be able to change their password. I have made an attempt of a script which i believe should work, but i guess i'm doing something wrong as it will just link to the php function page and not change the password at all. Here's my script:</p>\n\n<p>HTML form:</p>\n\n<pre><code>&lt;form method=\"POST\" action=\"includes/changepassword.php\"&gt;\n&lt;p&gt;&lt;input type=\"password\" name=\"oldpasswd\" id=\"oldpasswd\" maxlength=\"30\" placeholder=\"Old Password\"&gt;&lt;/p&gt;\n&lt;p&gt;&lt;input type=\"password\" name=\"newpsswd1\" id=\"newpsswd1\" maxlength=\"30\" placeholder=\"New Password\"&gt;&lt;/p&gt;\n&lt;p&gt;&lt;input type=\"password\" name=\"newpsswd2\" id=\"newpsswd2\"maxlength=\"30\" placeholder=\"Confirm Password\"&gt;&lt;/p&gt;\n&lt;input type=\"submit\" name=\"submit\" id=\"submit\" value=\"change password\"&gt;\n</code></pre>\n\n<p>changepassword.php file:</p>\n\n<pre><code> &lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\nfunction changepassword ($oldpasswd, $newpasswd1, $newpasswd2) {\n    /*\n     * RETURNS\n     * 0 - if password changed\n     * 1 - if new passwords are not equal\n     * 2 - if user authentification problems\n     */\n\n\n        $oldpasswd = ($_POST['oldpasswd']);\n        $newpasswd1 = ($_POST['newpasswd1']);\n        $newpasswd1 = ($_POST['newpasswd2']);\n\n\n\n\n    if ($newpasswd1 != $newpasswd2) {\n        return 1;\n    }\n\n    //check user logged in changes OWN passwd\n    $sql = \"SELECT password FROM ptb_users WHERE id = \".$_SESSION['user_id'];\n    $result = mysql_query($sql)or die('User not found: ' . mysql_error());\n\n    if (md5($oldpasswd)==$result) { \n\n        //Encrypt $emailpassword in MD5 format for the database\n        $md5_np=md5($newpasswd1);\n\n        // Make a safe query\n        $query = sprintf(\"UPDATE `ptb_users` SET `password` = '%s' \n                    WHERE `id` = \".$_SESSION['user_id'],\n                    mysql_real_escape_string($md5_np));\n\n        mysql_query($query)or die('Could not update password: ' . mysql_error());\n        return 0;\n    } else {\n        return 2;\n    }\n\n\n}   \n?&gt;\n</code></pre>\n\n<p>What have I done wrong?</p>\n"},{"tags":["sql","sql-server-2008-r2","ssas","indexed-view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13191372,"title":"Indexed views, with (NOEXPAND), and SSAS cubes","body":"<p>I've set up an indexed view which I intend to use as a data source view for a SSAS cube. The indexed view looks something like this:</p>\n\n<pre><code>create view vw_indexed1 with schemabinding\nas\n\nselect \nkey1, \nkey2, \ncount_big(*) as bigcount \nfrom\ntable1\ngroup by\nkey1, \nkey2, \nGO\n\n\nCREATE UNIQUE CLUSTERED INDEX [PX_vw_indexed1] ON [dbo].[vw_indexed1] \n(\nkey1, \nkey2, \n)WITH \n(PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = ON, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\nGO\n</code></pre>\n\n<p>Now, when I go <code>select * from vw_indexed1</code> it takes ages, presumably because it is trying to expand the indexes in the underlying table, so I would then use <code>select * from vw_indexed1 with (noexpand)</code>, which performs just like a select directly on a table with a clustered index.</p>\n\n<p>My question is this: if I use this view as the DSV for a SSAS project, is it going to try to use the underlying indexes every time? And if so, how can I force it to consider <code>vw_indexed1</code> as a table with its own indexes?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13220322,"title":"Is there a way in SQL to determine if certain days are in the same week?","body":"<p>I have the following table 'Schedule' in my database:</p>\n\n<pre><code>**Schedule**\nPK Weekday (ie., November 11, 2012)\nPK Punch-In (ie., 1:00 PM)\nPK Punch-Out (ie., 9:00 PM)\n</code></pre>\n\n<p>I am tasked with totaling the number of hours worked per week.</p>\n\n<p>For my example Sunday is Day 1 of the week and Saturday is Day 7.</p>\n\n<p>My question is how do I determine which days are in a \"week.\" Is there an SQL command for this? In other words, how do I determine if November 10 is the same week as November 11.</p>\n"},{"tags":["sql","oracle","plsql","overloading","plsqldeveloper"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":48,"score":1,"question_id":13217166,"title":"overloading procedure in package","body":"<p>Below is the HEADER for the Package TASK5</p>\n\n<pre><code>CREATE OR REPLACE PACKAGE TASK5 \n    AS \nPROCEDURE  TASK5APROCEDURE ( \nREG_NO  IN  NUMBER,\nCERT_TITLE   OUT  VARCHAR2,\nE_DATE     OUT DATE,\n    C_MARKS OUT INTEGER);\n\n\nPROCEDURE  TASK5BPROCEDURE ( \nCERT_ID  IN  CHAR, \nC_T OUT CHAR) ;    \n\n END TASK5;\n</code></pre>\n\n<p>The BODY for the PACKAGE TASK5 </p>\n\n<pre><code>CREATE OR REPLACE PACKAGE BODY TASK5 \nAS \n\n\n PROCEDURE    TASK5APROCEDURE ( \n    REG_NO  IN  NUMBER,\n    CERT_TITLE   OUT  VARCHAR2,\n    E_DATE     OUT DATE,\n    C_MARKS OUT INTEGER)\n            IS\n            BEGIN\n\nSELECT \n    O.PCP_TITLE, \n    C.CERT_EXAMDATE, \n    C.CERT_MARKS \n\nINTO  \n    CERT_TITLE, \n    E_DATE, \n    C_MARKS\n\nFROM \n    PROFCERTPROGRAM O\nINNER JOIN \nCERTIFICATION C\n    ON O.PCP_ID = C.PCP_ID\nWHERE \n    C.S_REGNO LIKE REG_NO;\nEXCEPTION\n               WHEN NO_DATA_FOUND\nTHEN \n                  DBMS_OUTPUT.PUT_LINE('NO DATA FOUND');\n\n\nEND TASK5APROCEDURE;\n\n\nPROCEDURE    TASK5BPROCEDURE ( \nCERT_ID  IN  CHAR, C_T OUT CHAR)\n            IS\n    BEGIN\n\nDBMS_OUTPUT.PUT_LINE ('COURSE NAMES: ');\n\nFOR R IN (  \n    SELECT O.C_TITLE C_T\nFROM \n    COURSE O\nINNER JOIN \nCERTIFICATIONREQUIREMENT C\n    ON O.C_ID = C.C_ID\nWHERE \n    C.PCP_ID LIKE '%'||CERT_ID||'%')\n\nLOOP\n        DBMS_OUTPUT.PUT_LINE (R.C_T);\nEND LOOP ;\n\nEND TASK5BPROCEDURE;\n\nEND TASK5;\n</code></pre>\n\n<p>I wrote the package with two different procedure for 2 different input. \nBut, I want to rewrite the header and body with overloading procedure, any suggestions? </p>\n"},{"tags":["php","sql","select"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":13212235,"title":"Combine Update and Select statments","body":"<p>I am using the following code to display stores and select one store works fine but I want to tune it a bit so I need some help on how to:</p>\n\n<pre><code>class ModelCatalogWinkel extends Model { \n    public function getWinkel($store_id) { \n        $query = $this-&gt;db-&gt;query(\"UPDATE store SET url='' = SELECT * FROM \" . DB_PREFIX . \"store WHERE store_id = '\" . $store_id . \"'\"); \n    if ($query-&gt;num_rows) {\n    return $query-&gt;row; \n    } else {\n    return false;\n    } }\n\n    public function getAllWinkel() {\n    $query = $this-&gt;db-&gt;query(\"SELECT * FROM \" . DB_PREFIX . \"store ORDER BY name DESC\");   \n    return $query-&gt;rows;\n    }}\n</code></pre>\n\n<p>==============</p>\n\n<p>Now I would like to add these 2 queries to the above script but I do not know how to combine update as a 1st time every time I select one store. </p>\n\n<ol>\n<li><code>UPDATE store SET url='';</code></li>\n<li><code>Update store SET url = 'http://localhost/mysite/' where name ='$store_id';</code></li>\n</ol>\n\n<p>I would like to clean the column url and update the url before I select the store-id.</p>\n\n<hr>\n\n<p>Table has 3 fields (based on opencart) </p>\n\n<pre><code>store_id, Name and url \n1         Store_1  (empty)\n2         Store_2  (empty)\n3         Store_3  [mysite]\n4         Store_4  (empty)\n5         Store_5  (empty)\n</code></pre>\n\n<p>I can have 100's of stores but the url is always the same, so what I want to do is every time I select one store from list, it should first get the column url cleaned ==> after that it should add the [mysite] to the selected store only and it opens the home page [index.php?route=common/home]. Why I do this because opencart always open the 1st record when they have all the same URL. This is a work around I see to open any store from the list. But I do not know what is the best a approach===>  to have the 3 queries in one or create 3 public functions. When I say the 3 queries I mean the  </p>\n\n<pre><code>public function getWinkel($store_id) { \n    $query = $this-&gt;db-&gt;query(\"UPDATE store SET url='' = SELECT * FROM \" . DB_PREFIX . \"store WHERE store_id = '\" . $store_id . \"'\");  \n    if ($query-&gt;num_rows) { \n    return $query-&gt;row; } else { return false; \n    } }\n</code></pre>\n\n<p></p>\n\n<pre><code>query(\" UPDATE store SET url=''\");\n</code></pre>\n\n<p></p>\n\n<pre><code>query (\"Update store Set url = '[mysite]' where store_id = '\" . $store_id . \"'\")\n</code></pre>\n"},{"tags":["c#","sql","sql-server","sql-server-2008","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13216924,"title":"How can i update another tables after adding record to a table in sql server 2008","body":"<p>I have two same tables created in SQL Server 2008.</p>\n\n<p>What I need is:</p>\n\n<p><strong>Add the newest data inserted in <code>table1</code> into <code>table2</code>.</strong></p>\n\n<p>Is that possible? </p>\n\n<p>Something like services or triggers or stored procedures?</p>\n\n<p>I think that I have to use triggers, but I don't know how.</p>\n\n<p>I have these two tables:</p>\n\n<pre><code>table1  ( field1,field2,field3 )\ntable2  ( field1,field2,field3 )\n</code></pre>\n\n<p>when i insert into table1 i need table2 to be updated as the procedure below:    </p>\n\n<pre><code>&gt; IF NotExist(field1=value) in table2 THEN INSERT Into table2 ELSE UPDATE table2\n&gt; with new field1 value.\n</code></pre>\n"},{"tags":["sql","database","programming-techniques","technology-choice","tidesdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13209958,"title":"Best way for storing shared contents between different kind of apps","body":"<p>We are starting a new project in my company and I would like to get some opinions on what you think is the best way to go.</p>\n\n<p>There are 3 apps involved: 1 desktop app, an online app (accessible through the browser) and mobile apps, and all of them share most of their contents (text contents basically). Actually they will be quite similar.</p>\n\n<p>We will start with the desktop app. My approach is using TideSDK for developing it and using SQLite for storing those contents that are the same in all apps. This will save us time when we have to use that information for the browser app and for the mobile app although we will probabilly have to migrate from SQLite to mySQL when developing the \"big\" ones. I am thinking in a RESTful web service at this point.</p>\n\n<p>My main question here is, what do you think it is the best way for storing these contents in the database? I'm thinking on having just HTML snippets so that I can embed them on the different apps, but not sure wether using a JSON might be better.</p>\n\n<p>I hope it is clear enough... If any question, let me know. Your opinions will be of great help.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["sql","sql-server","join","distinct"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13219582,"title":"SQL Query - Combine DISTINCT and TOP?","body":"<p>I have the following query I want to fire:</p>\n\n<pre><code>SELECT DISTINCT TOP(5) fp.PostId FROM dbForumPosts fp\nLEFT JOIN dbForumEntry fe ON fp.PostId = fe.PostId\nOrder by fe.Datemade DESC\n</code></pre>\n\n<p>However, when I fire it, I get the error:</p>\n\n<pre><code>Msg 145, Level 15, State 1, Line 1\nORDER BY items must appear in the select list if SELECT DISTINCT is specified.\n</code></pre>\n\n<p>I tried to change the query, so it used GROUP BY instead, but then I have the following problem:</p>\n\n<pre><code>Msg 8127, Level 16, State 1, Line 4\nColumn \"dbForumEntry.Datemade\" is invalid in the ORDER BY clause because it is not contained in either an aggregate function or the GROUP BY clause.\n</code></pre>\n\n<p><strong>WHAT DO I WANT:</strong></p>\n\n<p>Think of this as a forum. There are posts (dbForumPosts) and entries (dbForumEntry). There are 0-many entries pr post.</p>\n\n<p>What I want is to the get posts with the most recent activity (posts with the latest updated entries in).</p>\n"},{"tags":["sql","database","oracle","database-design","audit"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13218873,"title":"General database design - can I reference field names in other tables","body":"<p>I have a table with various fields that can be updated.  Let's called it <code>table1</code> and assume it has these fields:</p>\n\n<pre><code>user VARCHAR2\nfirst_name VARCHAR2\nlast_name VARCHAR2\n</code></pre>\n\n<p>My question: I want to keep track of edits to these fields.  I have an application that allows these fields to be updated but I want to keep track of <em>when</em> a field is edited, <em>who</em> edited the field and <em>which</em> field was edited - the <em>which</em> is the bit I need help with.</p>\n\n<p>I could have a history table:</p>\n\n<pre><code>date_edited DATE\nwho_edited VARCHAR2\nfield_name_edited VARCHAR2\n</code></pre>\n\n<p>what if the field name got changed though?.. It would mean that <code>field_name_edited</code> would refer to a non-existent field.  This seems like a silly approach.</p>\n\n<p>There must be some common way of doing this sort of thing?</p>\n\n<p>Many thanks.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am using an Oracle DB - see new question tags.</p>\n"},{"tags":["php","sql","query","orm","kohana"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13219599,"title":"Kohana is not loading the result rows?","body":"<p>if i try to load a result with Kohana ORM, the query is correct, but the result is empty. If i copy the Query and use it in phpmyadmin, i receive 2 rows.</p>\n\n<p>This is the Kohana Code (ORM)</p>\n\n<pre><code>        // DB work\n        $ftps = ORM::factory('ftp');\n\n        // if we activate many (we load only ready)\n        if ($this-&gt;request-&gt;param('mode') == 'activate') {\n            $ftps-&gt;where('ready', '=', '1');\n\n        // if we activate many (we load only ready)\n        } elseif ($this-&gt;request-&gt;param('mode') == 'not_ready') {\n            $ftps-&gt;where('ready', '=', '0');\n        }\n\n        // DB work\n        $ftps-&gt;and_where('activated', '=', '0')\n             -&gt;order_by('lastcheck', 'ASC')\n             -&gt;limit(intval($post['number']))\n             -&gt;find_all();\n</code></pre>\n\n<p>This is the SQL Query (Debug) </p>\n\n<pre><code>SELECT `ftp`.* FROM `ftps` AS `ftp` WHERE `activated` = '0' ORDER BY `lastcheck` ASC LIMIT 100 (1)\n</code></pre>\n\n<p>Why is Kohana not able to load the same results like phpmyadmin does? It's the same query. I don't find a solution.</p>\n\n<p>Thank you for your help</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13219260,"title":"Determine values that are present in only one of two tables, or in both of them","body":"<p>I have two tables in a SQL Server 2008 database in which I want to find:</p>\n\n<ul>\n<li>values present in both tables (with all columns present in both tables)</li>\n<li>values present in first table but not in second table</li>\n<li>values present in second table but not in first table</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>CREATE TABLE #_temp\n(ATM INT, Fault INT)\n\nCREATE TABLE #_temp1\n(ATM INT, Fault INT)\n\nINSERT INTO #_temp  VALUES (10,101), (11,101), (12,101), (12,101), (10,105), (13,101)\nINSERT INTO #_temp1 VALUES (10,102), (11,101), (12,103), (12,100), (10,105), (13,101)\n\n/* My Try\n\nSELECT * FROM #_temp t RIGHT JOIN #_temp1 t1 ON t.ATM=t1.ATM AND t.Fault=t.Fault AND t.ATM IS NULL AND t.Fault IS NULL\n\nSELECT * FROM #_temp t JOIN #_temp1 t1 ON t.ATM=t1.ATM AND t.Fault=t.Fault\n\n*/\n\nDROP Table #_temp\nDROP Table #_temp1 \n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","sql-server-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13218892,"title":"SQL Server: +(unary) operator on non-numeric Strings","body":"<p>I am surprised! This statement below is valid in <code>SQL SERVER</code>:</p>\n\n<pre><code>SELECT  +'ABCDEF'\n</code></pre>\n\n<p>Has <code>SQL Server</code> defined <code>+</code> as a <code>Unary</code> operator for string types?</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":13219113,"title":"Import from excel to sql format error","body":"<p>hi I am trying to load data into sql from an excel spreadsheet from a web page, I am getting a  \"Cannot implicitly convert type '<code>string</code>' to '<code>decimal</code>\" error I have tried different ways to correct this but nothing is working.</p>\n\n<pre><code>namespace CarpartsStore.Dealers\n{\n\npartial class DealerHome : System.Web.UI.Page\n{\n\n    protected void ButtonUpload_Click(object sender, System.EventArgs e)\n    {\n        PanelUpload.Visible = true;\n        PanelView.Visible = false;\n        PanelImport.Visible = false;\n    }\n\n\n    protected OleDbCommand ExcelConnection()\n    {\n\n        // Connect to the Excel Spreadsheet\n        string xConnStr = \"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=\" + Server.MapPath(\"~/ExcelImport.xls\") + \";\" + \"Extended Properties=Excel 8.0;\";\n\n        // create your excel connection object using the connection string\n        OleDbConnection objXConn = new OleDbConnection(xConnStr);\n        objXConn.Open();\n\n        // use a SQL Select command to retrieve the data from the Excel Spreadsheet\n        // the \"table name\" is the name of the worksheet within the spreadsheet\n        // in this case, the worksheet name is \"Members\" and is coded as: [Members$]\n        OleDbCommand objCommand = new OleDbCommand(\"SELECT * FROM [Products$]\", objXConn);\n        return objCommand;\n\n\n\n    }\n\n    protected void ButtonView_Click(object sender, System.EventArgs e)\n    {\n        PanelUpload.Visible = false;\n        PanelView.Visible = true;\n        PanelImport.Visible = false;\n\n        // Create a new Adapter\n        OleDbDataAdapter objDataAdapter = new OleDbDataAdapter();\n\n        // retrieve the Select command for the Spreadsheet\n        objDataAdapter.SelectCommand = ExcelConnection();\n\n        // Create a DataSet\n        DataSet objDataSet = new DataSet();\n        // Populate the DataSet with the spreadsheet worksheet data\n        objDataAdapter.Fill(objDataSet);\n\n        // Bind the data to the GridView\n        GridViewExcel.DataSource = objDataSet.Tables[0].DefaultView;\n        GridViewExcel.DataBind();\n    }\n\n\n    protected void ButtonImport_Click(object sender, System.EventArgs e)\n    {\n        PanelUpload.Visible = false;\n        PanelView.Visible = false;\n        PanelImport.Visible = true;\n        LabelImport.Text = \"\";\n        // reset to blank\n\n        // retrieve the Select Command for the worksheet data\n        OleDbCommand objCommand = new OleDbCommand();\n        objCommand = ExcelConnection();\n\n        //  create a DataReader\n        OleDbDataReader reader;\n        reader = objCommand.ExecuteReader();\n\n\n        //  create variables for the spreadsheet columns\n        int ProductID = 0;\n        int MakeID = 0;\n        int DealerID = 0;\n        string PartNumber = \"\";\n        string Description = \"\";\n        decimal UnitCost = 0.00M;\n        decimal Postage = 0.00M;\n        int QtyAvailable = 0;\n        string UserName = \"\";\n        string Make = \"\";\n\n\n        int counter = 0;\n        // used for testing your import in smaller increments\n\n        while (reader.Read())\n        {\n            counter = counter + 1;\n            // counter to exit early for testing...\n\n            // set default values for loop\n            ProductID = 0;\n            MakeID = 0;\n            DealerID = 0;\n\n\n\n            PartNumber = GetValueFromReader(reader,\"PartNumber\");\n            Description = GetValueFromReader(reader,\"Description\");\n\n\n            UnitCost = GetValueFromReader(reader,\"UnitCost\");\n            Postage = GetValueFromReader(reader, \"Postage\"); \n\n\n            QtyAvailable = GetValueFromReader(reader,\"QtyAvailable\");\n            UserName = GetValueFromReader(reader,\"UserName\");\n            Make = GetValueFromReader(reader,\"Make\");\n\n\n            // Insert any required validations here...\n\n            MakeID = GetMakeID(Make);\n            DealerID = GetDealerID(UserName); \n\n\n            //retrieve the MakeID\n            ProductID = ImportIntoProducts(PartNumber, Description, UnitCost, Postage, QtyAvailable, MakeID, DealerID);\n\n            LabelImport.Text = LabelImport.Text + ProductID + PartNumber + \" \" + Description + \" \" + UnitCost + \" \" + Postage + \" \" + QtyAvailable + \" \" + UserName + \" Make_id: \" + MakeID + \" \" + Make + \"&lt;br&gt;\";\n            //If counter &gt; 2 Then ' exit early for testing, comment later...\n            //    Exit While\n            //End If\n\n        }\n        reader.Close();\n\n    }\n\n\n\n    protected string GetValueFromReader(OleDbDataReader myreader, string stringValue)\n    {\n        object val = myreader[stringValue];\n        if (val != DBNull.Value)\n            return val.ToString();\n        else\n            return \"\";\n    }\n\n\n    protected void ButtonUploadFile_Click(object sender, System.EventArgs e)\n    {\n\n        if (FileUploadExcel.HasFile)\n        {\n\n\n            try\n            {\n                // alter path for your project\n\n                FileUploadExcel.SaveAs(Server.MapPath(\"~/ExcelImport.xls\"));\n                LabelUpload.Text = \"Upload File Name: \" +\n                    FileUploadExcel.PostedFile.FileName + \"&lt;br&gt;\" +\n                    \"Type: \" + FileUploadExcel.PostedFile.ContentType +\n                    \" File Size: \" + FileUploadExcel.PostedFile.ContentLength +\n                    \" kb&lt;br&gt;\";\n            }\n            catch (System.NullReferenceException ex)\n            {\n                LabelUpload.Text = \"Error: \" + ex.Message;\n            }\n        }\n        else\n        {\n            LabelUpload.Text = \"Please select a file to upload.\";\n        }\n\n    }\n\n\n\n    protected int GetMakeID(string MakeName)\n    {\n\n        int makeID = 0;\n        try\n        {\n            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.MakesTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.MakesTableAdapter();\n            SSSProductsDataSet.MakesDataTable SSDataTable = null;\n            SSDataTable = SSAdapter.GetMakeByName(MakeName);\n            // see if the category already exists in the table, if not insert it\n            if (SSDataTable != null)\n            {\n                if (SSDataTable.Rows.Count &gt; 0)\n                {\n                    if (SSDataTable[0].MakeID &gt; 0)\n                    {\n                        makeID = SSDataTable[0].MakeID;\n                    }\n                }\n            }\n            if (makeID == 0)\n            {\n                // if it is still 0, then insert it into the table\n                // retrieve the identity key category_id from the insert\n                makeID = (int)SSAdapter.InsertMakeQuery(MakeName);\n                // if this fails to return the proper category_id, make sure to \n                // set the InsertCategoryQuery ExecuteMode Property to Scalar\n            }\n            return makeID;\n        }\n        catch (System.NullReferenceException ex)\n        {\n            LabelImport.Text = LabelImport.Text + ex.Message;\n            return 0;\n        }\n\n    }\n\n    protected int GetDealerID(string UserName)\n    {\n\n        int DealerID = 0;\n        try\n        {\n            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.DealersTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.DealersTableAdapter();\n            SSSProductsDataSet.DealersDataTable SSDataTable = null;\n            SSDataTable = SSAdapter.GetDealersByUserName(UserName);\n            // see if the User already exists in the table, if not insert it\n            if (SSDataTable != null)\n            {\n                if (SSDataTable.Rows.Count &gt; 0)\n                {\n                    if (SSDataTable[0].DealerID &gt; 0)\n                    {\n                        DealerID = SSDataTable[0].DealerID;\n                    }\n                }\n            }\n            if (DealerID == 0)\n            {\n                // if it is still 0, then insert it into the table\n                // retrieve the identity key category_id from the insert\n                DealerID = 0;\n                // if this fails to return the proper category_id, make sure to \n                // set the InsertCategoryQuery ExecuteMode Property to Scalar\n            }\n            return DealerID;\n        }\n        catch (System.NullReferenceException ex)\n        {\n            LabelImport.Text = LabelImport.Text + ex.Message;\n            return 0;\n        }\n\n    }\n\n\n    protected int ImportIntoProducts(string PartNumber, string Description, decimal UnitCost, decimal Postage, int QtyAvailable, int MakeID, int DealerID)\n    {\n\n\n        // make sure values don't exceed column limits\n        PartNumber = Left(PartNumber, 50);\n        Description = Left(Description, 300);\n        UnitCost = Convert.ToDecimal(UnitCost);\n\n\n\n\n\n        int ProductID = 0;\n        try\n        {\n            CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.ProductsTableAdapter SSAdapter = new CarpartsStore.DataSets.SSSProductsDataSetTableAdapters.ProductsTableAdapter();\n            SSSProductsDataSet.ProductsDataTable SSDataTable = null;\n            SSDataTable = SSAdapter.GetProductsByPartNumberDealer(PartNumber, DealerID);\n            // see if the category already exists in the table, if not insert it\n            if (SSDataTable != null)\n            {\n                if (SSDataTable.Rows.Count &gt; 0)\n                {\n                    if (SSDataTable[0].ProductID &gt; 0)\n                    {\n                        ProductID = SSDataTable[0].ProductID;\n                        LabelImport.Text = LabelImport.Text + \"&lt;font color=blue&gt;PartNumber Found, Not Imported: \" + \" ID: \" + ProductID + \" \" + PartNumber + \" \" + Description + \"\" + UnitCost + \"\" + Postage + \".&lt;/font&gt;&lt;br&gt;\";\n                    }\n                }\n            }\n            if (ProductID == 0)\n            {\n                // if it is still 0, then insert it into the table\n                // retrieve the identity key ProductID from the insert\n                ProductID = Convert.ToInt32(SSAdapter.InsertProductQuery(PartNumber, Description,UnitCost, Postage, QtyAvailable, MakeID, DealerID));\n                LabelImport.Text = LabelImport.Text + \"&lt;font color=white&gt;Part Number Imported: \" + \" ID: \" + ProductID + \" \" + PartNumber + \" \" + Description + \" Cost: \" + UnitCost + \".&lt;/font&gt;&lt;br&gt;\";\n            }\n            return ProductID;\n        }\n        catch (System.NullReferenceException ex)\n        {\n            LabelImport.Text = LabelImport.Text + \"&lt;font color=red&gt;\" + ex.Message      + \"&lt;/font&gt;&lt;br&gt;\";\n            return 0;\n        }\n\n    }\n\n\n\n    // http://www.mgbrown.com/PermaLink68.aspx\n    public static string Left(string text, int length)\n    {\n        if (length &lt; 0)\n            throw new ArgumentOutOfRangeException(\"length\", length, \"length must be &gt; 0\");\n        else if (length == 0 || text.Length == 0)\n            return \"\";\n        else if (text.Length &lt;= length)\n            return text;\n        else\n            return text.Substring(0, length);\n\n    }\n\n}\n}\n</code></pre>\n"},{"tags":["sql","web-applications","backbone.js","twitter-bootstrap","typeahead"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13219067,"title":"Backbone.js + Twitter Bootstrap","body":"<p>I have been trying to follow the guide at <a href=\"http://coenraets.org/directory/\" rel=\"nofollow\">http://coenraets.org/directory/</a></p>\n\n<p>I have the contents of the \"Web\" folder copied onto the root of my website and the page appears just fine, I also installed his sql script into my database. The search bar isn't working (probably since my SQL database requires a username and password?). How do I fix this?</p>\n"},{"tags":["c#",".net","sql","entity-framework","entity-framework-4.1"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":13122940,"title":"String preparation when calling stored procedure in Entity Framework","body":"<p>Actually, I have code that uses Entity Framework 4.1 in Visual Studio 2010. Everything is working fine except for one thing : it doesn't seem to \"prepare\" the parameters like a good old <code>[parameters.Add]</code> habitually did.</p>\n\n<p>Here's my code : </p>\n\n<pre><code>using (MyEnterprisesEntities dataContext = new \n                             MyEnterprisesEntities(entityBuilder.ToString()))\n{\n         dataContext.CompanyInitializer(connection.Catalog,\n                                        args.CompanyId,\n                                        args.CompanyName);\n}\n</code></pre>\n\n<p>So, if my company's name is <code>O'Brian and sons</code> (actually it passed before through a WCF web service so it's more in this form: <code>O\\'Brian and sons</code>), it's seem to break my stored procedure (including the possibility of allowing SQL injection).</p>\n\n<p>Is there a way to avoid this situation with EDMX or the old way is more reliable ? </p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13218851,"title":"SQL : Update ID; According to Date","body":"<p>I have Table below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/GpVhy.jpg\" alt=\"enter image description here\"></p>\n\n<p>I like to <em>Update</em> <code>ID</code> according to date and then by User. </p>\n\n<h3>For Example</h3>\n\n<p><img src=\"http://i.stack.imgur.com/oyzfU.jpg\" alt=\"enter image description here\"></p>\n\n<h3>Thanks</h3>\n"},{"tags":["sql","oracle","if-statement","plsql"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13217600,"title":"IF EXISTS condition not working with PLSQL","body":"<p>I am trying to print the TEXT when condition is TRUE. The select code is perfectly working fine. It's showing 403 value when i only run select code. But I have to print some text when condition exists. What's the problem with following code.</p>\n\n<pre><code>BEGIN\nIF EXISTS(\nSELECT CE.S_REGNO FROM\nCOURSEOFFERING CO\nJOIN CO_ENROLMENT CE\n  ON CE.CO_ID = CO.CO_ID\nWHERE CE.S_REGNO=403 AND CE.COE_COMPLETIONSTATUS = 'C' AND CO.C_ID = 803\n)\nTHEN\n    DBMS_OUTPUT.put_line('YES YOU CAN');\nEND;\n</code></pre>\n\n<p>Here is the error report:</p>\n\n<pre><code>Error report:\nORA-06550: line 5, column 1:\nPLS-00103: Encountered the symbol \"JOIN\" when expecting one of the following:\n\n   ) , with group having intersect minus start union where\n   connect\n06550. 00000 -  \"line %s, column %s:\\n%s\"\n*Cause:    Usually a PL/SQL compilation error.\n*Action:\n</code></pre>\n"},{"tags":["sql","triggers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13219053,"title":"IF condition in trigger uses query","body":"<blockquote>\n  <p>order_placed(order_no,mess_id,...) rates(mess_id,student_id,rating)</p>\n</blockquote>\n\n<p>I want to create a trigger that checks if a mess's rating is less than 4 when an order is being placed, and if so, the order can't be placed.</p>\n\n<pre><code>CREATE TRIGGER new_order\nAFTER INSERT ON order_placed\nFOR EACH NEW ROW\nBEGIN\nIF((SELECT AVG(rating) FROM rates WHERE rates.mess_id = NEW.mess_id) &lt; 4)\nROLLBACK TRAN\nEND;\n</code></pre>\n\n<p>I'm getting an <code>ERROR 1064</code>.</p>\n"},{"tags":["php","mysql","sql","database","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13216196,"title":"Database relation of purchased items","body":"<p>I'm trying to come up with a database relation to keep track of purchased items that will be used for look up afterwards--for example ebooks. Ignore the ellipses--they represent miscellaneous data such as timestamp, etc...</p>\n\n<p>Here's the table I have right now:</p>\n\n<pre><code>purchased:\ntransaction_id(int)(pk)(auto_inc) | username (varchar) | purchases (text) | ...\n</code></pre>\n\n<p>In this design, the column \"purchases\" is just a string of text that would contain the item_id of items purchased, separated by commas. Simplified example: \"book1, book23, book5, book8\".</p>\n\n<p>In a successful transaction, this query would insert the transaction data into the \"purchased\" table:</p>\n\n<pre><code>INSERT INTO purchased VALUES (null, username, purchases, ...)\n</code></pre>\n\n<hr>\n\n<p>From this point on, two things can happen:     </p>\n\n<ol>\n<li>The user can lookup what ebooks they've purchased</li>\n<li>The user can make another purchase transaction.</li>\n</ol>\n\n<p>If the user (theusername) wants to see their ebooks, the system performs a selection query e.g.</p>\n\n<pre><code>SELECT purchases FROM purchased WHERE username=theusername\n</code></pre>\n\n<p>which returns a string containing the item IDs.</p>\n\n<p>One a sidenot, is it possible to get an php array of purchases without having to use extra php code, i.e. explode? <b>Can you use something besides the data type \"text\" in SQL to store a list of items?</b> If not, that's okay.</p>\n\n<hr>\n\n<p>Either way, here's the main problem. Say the user makes another transaction--there will now be two rows in \"purchased\" that contains the user's purchased items. That means that in this table, the user's purchases are split into multiple rows.</p>\n\n<p>Ideally, I want these purchases to all be in the same row. I can't use an UPDATE statement because each purchase has it's own unique transaction_id.</p>\n\n<p>I was thinking that I could make another table that contains all purchases by a user</p>\n\n<pre><code>all_purchased:\nusername (pk) | purchases (text) | ...\n</code></pre>\n\n<p>and whenever the user makes another transaction, the \"all_purchased\" table would just update its purchases column with the item ID of any new ebooks.</p>\n\n<p>But this table seems redundant because the selection query I mentioned would get the task done.</p>\n\n<p><b>What would be the best way to structure the database relation(s)?</b></p>\n"},{"tags":["c#","sql","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":13218012,"title":"Linq query fails if the data is too big","body":"<p>I have the following linq query</p>\n\n<pre><code>var result=from cases in db.Cases\n           join cc in db.CaseConsents on cases.CaseID equals cc.CaseID into cc_join\n           from cc in cc_join.DefaultIfEmpty()\n           where cc.ConsentTypeID == null &amp;&amp; cc.MidwireEyeBankID == 1\n           &amp;&amp; !((from casedeterminations in db.CaseDeterminations\n           where casedeterminations.DeterminationTypeID == 5\n           select new { casedeterminations.CaseID })).Distinct().Contains(new { cases.CaseID })\n           &amp;&amp; !(from casedeterminations2 in db.CaseDeterminations\n           where\n               (new int[] { 3, 4 }).Contains(casedeterminations2.DeterminationID)\n           select new\n           {\n               casedeterminations2.CaseID\n               }).Distinct().Contains(new { cases.CaseID })\n           select cc;\n</code></pre>\n\n<p>If this part of the query returns more than <code>50000</code> records then the whole query returns no result </p>\n\n<pre><code>(from casedeterminations2 in db.CaseDeterminations\nwhere\n(new int[] { 3, 4 }).Contains(casedeterminations2.DeterminationID)\nselect new\n{\n    casedeterminations2.CaseID\n}).Distinct().Contains(new { cases.CaseID })\n</code></pre>\n\n<p>this is the SQL version of this Linq query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select * from Cases\nleft outer join CaseConsent CC on CC.CaseID = Cases.CaseID \nwhere\nCases.CaseID NOT IN \n(SELECT distinct CaseID  FROM    CASEDETERMINATIONS WHERE   DETERMINATIONTYPEID = 5 )\nAND CC.ConsenttypeID IS NULL\nAND Cases.CaseID NOT IN \n( SELECT    CaseID FROM      CaseDeterminations WHERE     DeterminationID IN ( 3, 4 ) )\nAND Cases.MidwireEyeBankID = 1\n</code></pre>\n"},{"tags":["sql","oracle","oracle-xe"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":19484,"score":4,"question_id":531969,"title":"Oracle 10g express home page is not coming up","body":"<p>I installed Oracle 10g express. Installation went well, But the home page is not coming up.\nI can connect using sqlplus but not with Sql Developer. \nI checked tnsnames.ora and listener.ora everything looks fine.\nListener is also started. I can always reinstall and see. But I thought better inquire the cause.</p>\n\n<p>Regarding the home page. This is the address that comes up in browser. Localhost:8080\n<a href=\"http://127.0.0.1:8080/apex\" rel=\"nofollow\">http://127.0.0.1:8080/apex</a>\nI did a netstat to see whether there is any port conflict for 8080, but that port is not in use.</p>\n\n<p>Have anybody faced this issue?</p>\n"},{"tags":["sql","doctrine2","native-sql","customcolumn"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13218693,"title":"Doctrine 2: How can extend entity with sql code column?","body":"<p>I have entity</p>\n\n<pre><code>mh\\BTBundle\\Entity\\Post:\n    type: entity\n    table: post\n    repositoryClass: mh\\BTBundle\\Repository\\PostRepository\n    fields:\n        id:\n            id: true\n            type: integer\n            unsigned: true\n            nullable: false\n            generator:\n                strategy: IDENTITY\n        title:\n            type: string\n            length: 255\n            nullable: false\n        content:\n            type: text\n            nullable: false\n        isModered:\n            type: boolean\n            nullable: false\n        isPublished:\n            type: boolean\n            nullable: false\n        pubDate:\n            type: datetime\n            nullable: false\n</code></pre>\n\n<p>and now once at 1 minute cron call script, that set isPublished = true if post have isModered = true and pubDate &lt; :now. </p>\n\n<pre><code>$this-&gt;getEM()-&gt;createQueryBuilder()\n            -&gt;update('BTBundle:Post p')\n            -&gt;set('p.isPublished', 'true')\n            -&gt;where('p.pubDate &lt; :date AND p.isModered = true')\n            -&gt;setParameter(':date', new \\DateTime())\n            -&gt;getQuery()-&gt;execute();\n</code></pre>\n\n<p>But i whant to define custom column isPublished with return true if SQL (<code>p.pubDate &lt; CURDATE() AND p.isModered = 1</code>). How can i make it? </p>\n\n<p>i whant to use </p>\n\n<pre><code>$posts = $this-&gt;getRepository('Post')-&gt;findBy(array(\n            'user' =&gt; $user,\n            'isPublished' =&gt; true,\n        ));\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>$this-&gt;getEM()-&gt;createQueryBuilder()\n                -&gt;select('p')\n                -&gt;from('BTBundle:Post', 'p')\n                -&gt;where('p.isModered = true')\n                -&gt;andWhere('p.pubDate &lt; :date')\n                -&gt;andWhere('p.user = :user')\n                -&gt;setParameter(':date', new \\DateTime())\n                -&gt;setParameter(':user', $user)\n                -&gt;getQuery()-&gt;execute();\n</code></pre>\n"},{"tags":["python","sql","database","python-2.7","firebird"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":44,"score":-3,"question_id":13218115,"title":"AttributeError: Transaction instance has no attribute 'trans_handle'","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13210956/programmingerror-42s02-42s02-microsoft\">ProgrammingError: ‘42S02’, &#39;[42S02] [Microsoft]</a>  </p>\n</blockquote>\n\n\n\n<p>I wrote this programm which should insert record into a database</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\nconn=firebirdsql.create_database(host='localhost', database='D:/test2.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nconn.begin()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\"\"\"\ncur.execute(s)\nconn.commit()\ns=\"INSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Organization A')\"\nconn.begin()\ncur.execute(s)\nconn.commit()\nconn.close()\n</code></pre>\n\n<p>As a result, when you run, I got the following error that very much afflicted me</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:/ThirdTask/connectthree.py\", line 37, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 456, in _execute\n    self.transaction.trans_handle, query)\nAttributeError: Transaction instance has no attribute 'trans_handle'\n</code></pre>\n\n<p>In the following version of the program</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\nconn=firebirdsql.create_database(host='localhost', database='D:/test2.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\"\"\"\ncur.execute(s)\ns=\"INSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Organization A')\"\ncur.execute(s)\nconn.commit()\nconn.close()\n</code></pre>\n\n<p>I received the following mistake that very much afflicted me</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:/ThirdTask/connectthree.py\", line 35, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 457, in _execute\n    (h, oid, buf) = self.transaction.connection._op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 764, in _op_response\n    return self._parse_op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 308, in _parse_op_response\n    raise OperationalError(message, gds_codes, sql_code)\nOperationalError: Dynamic SQL Error\nSQL error code = -204\nTable unknown\nCLIENTS\nAt line 1, column 13\n</code></pre>\n"},{"tags":["python","sql","caching","redis","data-mining"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":74,"score":4,"question_id":12938274,"title":"A good blobstore / memcache solution","body":"<p>Setting up a data warehousing mining project on a Linux cloud server. The primary language is Python .</p>\n\n<p>Would like to use this pattern for querying on data and storing data:</p>\n\n<ul>\n<li><strong>SQL Database</strong> - SQL database is used to query on data. However, the SQL database stores only fields that need to be searched on, it does NOT store the \"blob\" of data itself. Instead it stores a key that references that full \"blob\" of data in the a key-value Blobstore. </li>\n<li><strong>Blobstore</strong> - A key-value Blobstore is used to store actual \"documents\" or \"blobs\" of data.</li>\n</ul>\n\n<p>The issue that we are having is that we would like more frequently accessed blobs of data to be automatically stored in RAM. We were planning to use Redis for this. However, we would like a solution that automatically tries to get the data out of RAM first, if it can't find it there, then it goes to the blobstore.</p>\n\n<p>Is there a good library or ready-made solution for this that we can use without rolling our own? Also, any comments and criticisms about the proposed architecture would also be appreciated.</p>\n\n<p>Thanks so much!</p>\n"},{"tags":["sql","vb.net","query","data-binding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13209090,"title":"No effect on rowstate after editing data in textbox binded to a binding source VB","body":"<p>I have a sql Query using join that fills the binding source</p>\n\n<pre><code>SELECT        \n  CustomerServiceLocation.id, \n  CustomerServiceLocation.custId, \n  CustomerServiceLocation.custSubId, \n  CustomerServiceLocation.locationId, \n\n  cust.firstNamePri, \n  cust.lastNamePri, \n  cust.phonePriPri, \n  cust.phoneAltPri, \n  cust.extPri, \n  cust.firstNameAlt, \n  cust.lastNameAlt, \n  cust.phonePriAlt, \n  cust.phoneAltAlt, \n  cust.extAlt, \n  cust.id AS Expr1, \n\n  location.custId AS Expr2, \n  location.city, \n  location.unitNum, \n  location.zip, \n  location.gated, \n  location.height, \n  location.code, \n  location.street, \n  location.email, \n  location.comments,\n  location.id AS Expr3 \nFROM            \n  CustomerServiceLocation \nINNER JOIN\n  Customer AS cust ON CustomerServiceLocation.custId = cust.id \nINNER JOIN\n  ServiceLocation AS location ON CustomerServiceLocation.locationId = location.id \nWHERE        \n  (CustomerServiceLocation.custSubId = @custId)\n</code></pre>\n\n<p>The query runs fine and the text boxes binded also display the corect information. When I edit datain text box and select save from navigation then the dataset shows no change in row state. This is the code I use behind the save button in navigation binder:</p>\n\n<pre><code>    Me.Validate()\n\n    Me.CustomerServiceLocationBindingSource.EndEdit()\n\n\n    Dim deletedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n    CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Deleted), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim newChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Added), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n\n    Dim modifiedChildRecords As ArfDynamicsDataSet.CustomerServiceLocationDataTable = _\n        CType(ArfDynamicsDataSet.CustomerServiceLocation.GetChanges(DataRowState.Modified), ArfDynamicsDataSet.CustomerServiceLocationDataTable)\n</code></pre>\n\n<p>But none of the variables show any changes in <code>deletedChildRecords</code>, <code>newChildRecords</code> &amp; <code>modifiedChildRecords</code></p>\n\n<p>Can anyone help me figure out what I am doing wrong.</p>\n\n<p>Thanks.</p>\n\n<p>UPDATE: if I make changes in fields that are part of CustomerServiceLocation table only those fields value are detected in getChanges and not the Joined tables fields. Can anyone explain how to get changes for joined tables fields that have been binded.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","web-applications","graph-algorithm","pagerank"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13218102,"title":"WebGraph storage in Relational Databases","body":"<p>How one can efficiently store the WebGraph in Relational databases such MySQL for playing with algorithms like PageRank? I think of creating two tables: one for URLs where only distinct URLs will be stored and another outgoing links table, for each url store its outgoing URL. Any ideas or any suggestions for efficient storage?</p>\n"},{"tags":["php","mysql","sql","query"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13217679,"title":"SHOW TABLES only shows tables starting with a space mysql","body":"<p>I have some code that needs to get a list of all of the tables in a database with a certain column equaling a certain thing. However, using the <code>SHOW TABLES</code> MySQL code is only listing tables that start with a space. Here is my code...</p>\n\n<pre><code>$result = mysql_query(\"SHOW FULL TABLES IN `db`\") or die(\"Error: \" . mysql_error());\nwhile ($word = mysql_fetch_array($result)) {\n    $word = $word[0];\n    $sql = \"SELECT * FROM `db`.`$word` WHERE col='$val'\";\n    $result = mysql_query($sql, $con) or die(\"Error: \" . mysql_error());\n    while ($col = mysql_fetch_array($result)) echo \"&lt;li&gt;&lt;a nav='$word' title='View $word'&gt;$word&lt;/a&gt;&lt;/li&gt;\";\n}\n</code></pre>\n\n<p>For some reason, the first <code>mysql_query()</code> is only returning one result, which happens to be a table beginning with a space. (It is the only table starting with a space in the whole thing)\nEdit: I just realized that I left out the line of code that turned $word from an array into a string... it's in there now.</p>\n"},{"tags":["sql","ms-access","delete"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13217716,"title":"How to delete all record on all table with SQL (1 time) (MS ACCESS)","body":"<p>I have 14 table in 1 file of ms access.</p>\n\n<p>I want to delete all record on these table on one time.</p>\n\n<p>I try with </p>\n\n<pre><code>DELETE FROM table1\nDELETE FROM table2\nDELETE FROM table3\n...\nDELETE FROM table12\nDELETE FROM table13\nDELETE FROM table14\n</code></pre>\n\n<p>and run it.</p>\n\n<p>But Can not to run</p>\n\n<p>How to do it ?\nThank you\nps.Sorry for bad english</p>\n"},{"tags":["sql","database","query","select"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":13217069,"title":"Using max() in SQL","body":"<p>One part of my homework assignment is to find the student with the highest average from each department. </p>\n\n<p>QUERY: </p>\n\n<pre><code>SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\nFROM studentgrades g, student s\nWHERE g.sid = s.sid\nGROUP BY s.sid\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>1   Robert  ger 80.0000\n2   Julie   sta 77.0000\n3   Michael csc 84.0000\n4   Julia   csc 100.0000\n5   Patric  csc 86.0000\n6   Jill    sta 74.5000\n</code></pre>\n\n<p>To answer The question, I ran the query </p>\n\n<pre><code>SELECT dcode, averages.sfirstName, MAX(averages.average)\nFROM (\n    SELECT g.sid as studentID, s.sfirstname, s.dcode, AVG(grade) as average\n    FROM studentgrades g, student s\n    WHERE g.sid = s.sid\n    GROUP BY s.sid) averages\nGROUP BY dcode\n</code></pre>\n\n<p>RESULT:</p>\n\n<pre><code>csc Michael 100.0000\nger Robert  80.0000\nsta Julie   77.0000\n</code></pre>\n\n<p>Even though the averages are correct, the names are not!\nJulia is the one who has the average 100 in csc, so why does Michael show up?</p>\n\n<hr>\n\n<p>Here's an example:</p>\n\n<p>a student takes courses and gets grades for these courses. EG:</p>\n\n<pre><code>student1 from dept1 took course A and got grade 80\nstudent1 from dept1 took course B and got grade 90\nstudent2 from dept1 took course C and got grade 100\nstudent3 from dept2 took course X and got grade 90\n</code></pre>\n\n<p>AFTER RUNNING THE FIRST QUERY we get the averages for each student</p>\n\n<pre><code>student 1 from dept1 has average 85\nstudent 2 from dept1 has average 100\nstudent 3 from dept2 has average 90\n</code></pre>\n\n<p>Now we find the student with the highest average from each department</p>\n\n<pre><code>dept1, student2, 100\ndept2, student3, 90\n</code></pre>\n"},{"tags":["sql","oracle","query"],"answer_count":3,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":211,"score":8,"question_id":12315573,"title":"How to write Oracle query to find a total length of possible overlapping from-to dates","body":"<p>I'm struggling to find the query for the following task</p>\n\n<p>I have the following data and want to find the total network day for each unique ID</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   03-Sep-12   07-Sep-12   5\n1   03-Sep-12   04-Sep-12   2\n1   05-Sep-12   06-Sep-12   2\n1   06-Sep-12   12-Sep-12   5\n1   31-Aug-12   04-Sep-12   3\n2   04-Sep-12   06-Sep-12   3\n2   11-Sep-12   13-Sep-12   3\n2   05-Sep-12   08-Sep-12   3\n</code></pre>\n\n<p>Problem is the date range can be overlapping and I can't come up with SQL that will give me the following results</p>\n\n<pre><code>ID  From        To          NetworkDay\n1   31-Aug-12   12-Sep-12   9\n2   04-Sep-12   08-Sep-12   4\n2   11-Sep-12   13-Sep-12   3\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>ID  Total Network Day\n1   9\n2   7\n</code></pre>\n\n<p>In case the network day calculation is not possible just get to the second table would be sufficient.</p>\n\n<p>Hope my question is clear</p>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008","full-text-search"],"answer_count":4,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":9906,"score":10,"question_id":6003240,"title":"Cannot use a CONTAINS or FREETEXT predicate on table or indexed view because it is not full-text indexed","body":"<p>I am getting following error in my SQL server 2008 R2 database:</p>\n\n<blockquote>\n  <p>Cannot use a <code>CONTAINS</code> or <code>FREETEXT</code> predicate on table or indexed view 'tblArmy' because it is not full-text indexed.</p>\n</blockquote>\n"},{"tags":["python","sql","database","ms-access","firebird"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":13216539,"title":"Error in INSERT query : Table unknown","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13210956/programmingerror-42s02-42s02-microsoft\">ProgrammingError: ‘42S02’, &#39;[42S02] [Microsoft]</a>  </p>\n</blockquote>\n\n\n\n<p>I wrote the program which on a descriptor (to a database, containing structure of a database Northwind - in the separate tables, containing the list of tables, indexes, restrictions, domains) databases Northwind builds it in Firebird. Then I am connected to the database Northwind (Access) and I want to copy by means of inquiry sql contents of tables of a database Northwind (Access) in tables of the created identical Firebird database.</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\ncon = sqlite3.connect('borey.db')\nsampling_tables=con.cursor()\nsampling_fields=con.cursor()\nsampling_constraints=con.cursor()\nsampling_constraints_fields=con.cursor()\nsampling_indices=con.cursor()\nsampling_indices_fields=con.cursor()\nsampling_indices_props=con.cursor()\nsampling_fields_from_constraints=con.cursor()\njs=[]\n\nsampling_tables.execute(sql.sqltables)\n\nfor table in sampling_tables:\n    tabledict=dict(inform_about_table='?', fields='?', constraints='?', indices='?')\n    information_about_table_dict=dict(name=table[1], description=table[2], can_add=table[3], can_edit=table[4], can_delete=table[5])\n    #print(js_information_about_table)\n    tabledict['inform_about_table']=information_about_table_dict\n    #print(tabledict)\n    table_id=table[0]\n    sampling_fields.execute(sql.sqlfields,(table_id,))\n    listfields=[]\n    for field in sampling_fields:\n        fielddict=dict(position=field[0], name=field[1], description=field[2], datatype=field[3], char_length=field[4], can_input=field[5], can_edit=field[6], show_in_grid=field[7],\n                      is_mean=field[8], autocalculated=field[9], required=field[10])\n        listfields.append(fielddict)\n    tabledict['fields']=listfields\n    #print(tabledict)\n    sampling_constraints.execute(sql.sqlconstraints,(table_id,))\n    listconstraints=[]\n    for constraint in sampling_constraints:\n        constraintdict=dict(name=constraint[1], constrtype=constraint[2], items='?', reference=constraint[3])\n        sampling_constraints_fields.execute(sql.sql_constr_det,(constraint[0],table_id))\n        listitems=[]\n        for constr_det in sampling_constraints_fields:\n            listitems.append(constr_det[0])\n        constraintdict['items']=listitems\n        listconstraints.append(constraintdict)\n    tabledict['constraints']=listconstraints\n    #print(tabledict)\n    sampling_indices.execute(sql.sqlindices,(table_id,))\n    listindices=[]\n    for index in sampling_indices:\n        indexdict=dict(name=index[1], items='?', position='?', props='?')\n        index_id=index[0]\n        sampling_indices_fields.execute(sql.sql_indices_fields,(table_id,index_id))\n        #sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id, ))\n        listfields=[]\n        listpositions=[]\n        listprops=[]\n        for index_det in sampling_indices_fields:\n            listfields.append(index_det[0])\n            listpositions.append(index_det[1])\n            fieldinindex=index_det[0]\n        sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id,fieldinindex))            \n        for index_desc in sampling_indices_props:\n            listprops.append(index_desc[0])\n        indexdict['items']=listfields\n        indexdict['position']=listpositions\n        indexdict['props']=listprops\n        listindices.append(indexdict)\n    tabledict['indices']=listindices\n    #print(tabledict)\n    js.append(tabledict)\nos.remove('D:/boreas.fdb')\nconn=firebirdsql.create_database(host='localhost', database='D:/boreas.fdb', user='sysdba', password='masterkey')\n#conn=firebirdsql.connect(host='localhost',database='D:/ThirdTask/test.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nfor nametable in js:\n    s=''\n    s+='create table '+nametable['inform_about_table']['name']+'\\n'\n    s+='('+'\\n'\n    countfield=0\n    for namefield in nametable['fields']:\n        s+='   '\n        if namefield['name']=='COUNT':\n            s+='QUANTITY'\n        else:\n            if namefield['name']=='MINIMUM QUANTITY FOR ORDER REPETITION':\n                s+='MINIMUM_QUANTITY'\n            else:\n                if namefield['name']=='PRICE ACCORDING TO THE PRICE-LIST':\n                    s+='LIST_PRICE'\n                else:\n                    if (namefield['name'].count(' ')!=0) or (namefield['name'].count('-')!=0) or (namefield['name'].count('/')!=0):\n                        s+='\"'+namefield['name']+'\"'\n                    else:                    \n                        s+=namefield['name']\n        if namefield['datatype']=='FMTBCD':\n            s+='   '+' INTEGER NOT NULL'\n        else:\n            if namefield['datatype']=='STRING': \n                s+='   '+'VARCHAR'\n            else:\n                if namefield['datatype']=='MEMO':\n                    s+='   '+'BLOB SUB_TYPE 1'\n                else:            \n                    if namefield['datatype']=='LARGEINT':\n                        s+='   '+'INTEGER'\n                    else:\n                        if namefield['datatype']=='SMALLINT':\n                            s+='   '+'INTEGER'\n                        else:\n                            if namefield['datatype']=='CURRENCY':\n                                s+='   '+'NUMERIC(18,2)'\n                            else:\n                                if namefield['datatype']=='BOOLEAN':\n                                    s+='   '+'INTEGER'\n                                else:    \n                                    s+='   '+namefield['datatype']           \n        if namefield['datatype']=='STRING':\n            s+='('+str(namefield['char_length'])+')'\n        countfield+=1\n        #if countfield!=len(nametable['fields']):\n        s+=','+'\\n'\n        #else:\n            #s+='\\n'\n            #s+='\\n'\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='PRIMARY':\n            s+='   CONSTRAINT '+nameconstraint['name']+ ' PRIMARY KEY('\n            countfieldinconstr=0\n            for namefield in nameconstraint['items']:\n                countfieldinconstr+=1\n                if countfieldinconstr!=len(nameconstraint['items']):\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+','\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+','\n                            else:    \n                                s+=namefield+','\n                else:\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+')'+'\\n'\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+')'+'\\n'\n                            else:       \n                                s+=namefield+')'+'\\n'\n    s+=');'+'\\n'\n    print s\n    cur.execute(s)\n    #conn.commit()\n    #conn.begin()\n    for nameindex in nametable['indices']:\n        #print 'nameidex[props] ', nameindex['props']\n        s=''\n        for prop in nameindex['props']:\n            if prop==0:\n                if (nameindex['name'].count(' ')!=0) or (nameindex['name'].count('-')!=0) or (nameindex['name'].count('/')!=0):\n                    s+='create ascending index \"'+nameindex['name'] + '\" on '+nametable['inform_about_table']['name']+' ('\n                else:\n                    if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_INVENTORY_ID':\n                        s+='create ascending index ' + 'IDX_INVENTORY_ID' + ' on '+nametable['inform_about_table']['name']+' ('\n                    else:\n                        if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_ORDERDETAILS':\n                            s+='create ascending index ' + 'IDX_ORDERDETAILS' + ' on '+nametable['inform_about_table']['name']+' ('\n                        else:    \n                            if nameindex['name'].count('INFORMATION_ABOUT_ORDER_')!=0:\n                                s+='create ascending index ' + nameindex['name'][1:4]+nameindex['name'][-len(nameindex['name'])+28:] + ' on '+nametable['inform_about_table']['name']+' ('\n                            else:\n                                s+='create ascending index '+nameindex['name'] + ' on '+nametable['inform_about_table']['name']+' ('\n            countitem=0\n            for nameitem in nameindex['items']:\n                if countitem!=len(nameindex['items'])-1:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+', '\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+', '\n                            else:  \n                                s+=nameitem+', '\n                else:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+');'+'\\n'\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+');'+'\\n'\n                            else:  \n                                s+=nameitem+');'+'\\n'\n                countitem+=1\n        print s\n        cur.execute(s)\n        #conn.commit()\nfor nametable in js:\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='FOREIGN':\n            s=''\n            s+='ALTER TABLE '+nametable['inform_about_table']['name']+'\\n'\n            s+='  '+'ADD CONSTRAINT '+nameconstraint['name']+' FOREIGN KEY ('  \n            for namefield in nameconstraint['items']:\n                if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                    s+='\"'+namefield+'\")'+'\\n'\n                else:\n                    s+=namefield+')'+'\\n'\n            s+='      '+'REFERENCES '+nameconstraint['reference']\n            sampling_fields_from_constraints.execute(sql.sql_fields, (nameconstraint['reference'],))\n            for fields in sampling_fields_from_constraints:\n                field=fields[0]\n                if (field.count(' ')!=0) or (field.count('-')!=0) or (field.count('/')!=0):\n                    s+=' (\"'+field+'\");'+'\\n'\n                else:\n                    s+=' ('+field+');'+'\\n'\n            print s\n            cur.execute(s)\n            #conn.commit()            \n#conn.commit()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID   INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"    VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB\n);\n\"\"\"\ns1='create ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);'\n\"\"\"db = 'D:/ThirdTask/Northwind.accdb' \nconnaccess = win32com.client.Dispatch(r'ADODB.Connection')\nDSN = ('PROVIDER = Microsoft.Jet.OLEDB.4.0;DATA SOURCE = ' + db +  ';') \nconnaccess.Open(DSN) \nrs = win32com.client.Dispatch(r'ADODB.Recordset') \nstrsql = \"select * from deer\" \nrs.Open(strsql, conn, 1, 3) \nt = rs.GetRows() \nconnaccess.Close() \n\"\"\"\nconAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nSqlAccess.execute(sql.sql_count_records_clients);\nCountOfRecords=SqlAccess.fetchone()[0];\nprint CountOfRecords\nid=0\nwhile id&lt;CountOfRecords:\n    id+=1\n    SqlAccess.execute(sql.sql_allfields_clients, (id,))\n    clientdict=dict(ident=id, organization=SqlAccess.fetchone()[1]);\n    print clientdict\n    s='INSERT INTO CLIENTS (ID, COMPANY) VALUES'\n    s+='('+str(clientdict['ident'])+', ' +'\\''+clientdict['organization']+'\\''+')';\n    print s\n    cur.execute(s)\nconn.commit()    \n#print s\n#cur.execute(s)\n#conn.commit()\n#cur.execute(s1)\n#conn.commit()\n#cur=con.cursor()\ncon.close()\nconn.close()\nconAcc.close();\n#print \"Connect succesfully\"\n</code></pre>\n\n<p>When the debugging I display text sql queries, which included (all output not cite)</p>\n\n<pre><code>create table CLIENTS\n(\n   ID    INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"   VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB,\n   CONSTRAINT PK_CLIENTS_ID PRIMARY KEY(ID)\n);\n\ncreate ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);\n\ncreate ascending index IDX_CLIENTS_COMPANY on CLIENTS (COMPANY);\n\ncreate ascending index IDX_CLIENTS_FIRST_NAME on CLIENTS (\"FIRST NAME\");\n\ncreate ascending index IDX_CLIENTS_LAST_NAME on CLIENTS (\"LAST NAME\");\n\ncreate ascending index IDX_CLIENTS_POSTAL_CODE on CLIENTS (\"ZIP/POSTAL CODE\");\n\ncreate ascending index IDX_CLIENTS_PRIMARYKEY on CLIENTS (ID);\n\ncreate ascending index \"IDX_CLIENTS_STATE/PROVINCE\" on CLIENTS (\"STATE/PROVINCE\");\n29\n{'organization': u'\\u041e\\u0440\\u0433\\u0430\\u043d\\u0438\\u0437\\u0430\\u0446\\u0438\\u044f \\u0410', 'ident': 1}\nINSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Организация А')\n\nTraceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 263, in &lt;module&gt;\n    cur.execute(s)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 495, in execute\n    stmt_type, stmt_handle = self._execute(query, params)\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\fbcore.py\", line 457, in _execute\n    (h, oid, buf) = self.transaction.connection._op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 764, in _op_response\n    return self._parse_op_response()\n  File \"C:\\Python27\\lib\\site-packages\\firebirdsql\\wireprotocol.py\", line 308, in _parse_op_response\n    raise OperationalError(message, gds_codes, sql_code)\nOperationalError: Dynamic SQL Error\nSQL error code = -204\nTable unknown\nCLIENTS\nAt line 1, column 13\n</code></pre>\n\n<p>Specifically brought to the printing paste formed request</p>\n\n<pre><code>INSERT INTO CLIENTS (ID, COMPANY) VALUES(1, 'Организация А')\n</code></pre>\n\n<p>and when it is running an error (see above). How to fix?</p>\n"},{"tags":["java","android","sql","cursor"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":136,"score":0,"question_id":12109861,"title":"Android cursor returns no rows for select-query","body":"<p>i'm currently trying to get a single row from my own database, located in the assets folder. Checking if there is a row in the table, with the SQLite Query Browser and the SELECT-Statement from the debugger got me a single row in the database. Anyway calling the statement from my code just gets me an empty cursor. I also added the method </p>\n\n<blockquote>\n  <p>cursor.moveToFirst()</p>\n</blockquote>\n\n<p>and avoided calling </p>\n\n<blockquote>\n  <p>myDataBase.close();</p>\n</blockquote>\n\n<p>Here is the method where i'm trying to append a single entry on a TextView:</p>\n\n<pre><code>private void getAdresses(Location location) { // TODO\n    double lat = location.getLatitude();\n    double lng = location.getLongitude();\n    Geocoder geocoder = new Geocoder(this, Locale.GERMAN);\n\n    try {\n        List&lt;Address&gt; addresses = geocoder.getFromLocation(lat, lng, 1);\n        if (addresses.size() != 0) {\n            Address address = addresses.get(0);\n\n            String addressString = address.getAddressLine(0).toString();\n            System.out.println(\"(geocoder) \" + addressString);\n            textView.append(addressString + \"\\n\");\n\n            Cursor cursor = mDbHelper.getAllEntrys(\"tblBar\", \"Adresse\",\n                    addressString);\n\n            if (cursor.moveToFirst()) {\n\n                String cursorContent = cursor.getString(cursor\n                        .getColumnIndexOrThrow(\"Name\"));\n                textView.append(cursorContent + \"\\n\");\n\n            } else {\n                System.out.println(\"No bar at current location\");\n            }\n        } else {\n            System.out.println(\"(geocoder) no address!\");\n        }\n    } catch (IOException e) {\n        System.out.println(e.toString() + \"(geocoder)\");\n    }\n}\n</code></pre>\n\n<p>Furthermore this is my method for calling the actual query on the database:</p>\n\n<pre><code>public Cursor getAllEntrys(String table, String column, String search) {\n    try {\n        String sSelect = \"SELECT * FROM \" + table + \" WHERE \" + column\n                + \" = '\" + search + \"'\";\n        Cursor cursor = mDb.rawQuery(sSelect, null);\n\n        if (cursor != null) {\n            cursor.moveToFirst();\n        }\n        return cursor;\n    } catch (SQLException mSQLException) {\n        System.out.println(\"getData &gt;&gt;\" + mSQLException.toString());\n        throw mSQLException;\n    }\n}\n</code></pre>\n\n<p>Hope someone can help me with this. Many thanks in advance!</p>\n"},{"tags":["sql","constraints","column"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13217385,"title":"Column Constraint Sql 2008","body":"<p>I have been trying to find out if I can make a column Open on Insert, and closed on Update.\nWhat I mean by that, is I need a column that I can give it a value only on Insert, but if I try to give it a value with Update, the statement would fail.</p>\n\n<p>I am working with SQL 2008... </p>\n"},{"tags":["c#","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":84,"score":2,"question_id":13172857,"title":"Splitting an array to another array","body":"<p>I have a list which contains </p>\n\n<ol>\n<li>The <code>Price</code></li>\n<li>The <code>Code</code></li>\n</ol>\n\n<p>I've managed to split the list to an array, but I want to further split the array so that I can get the <code>Price</code> and <code>Code</code> separately and sort the <code>Price</code> to ascending order. When the sorting occurs, I need the <code>Code</code> to be sorted together as well because the <code>Price</code> is for that particular <code>Code</code>.</p>\n\n<p>So it will be like this:\nOriginal List:</p>\n\n<pre><code>1588,8DNY;1488,ACNY;1288,7DPE;1888,8HUC;1488,8WNH;\n</code></pre>\n\n<p>After Splitting to arrPrice:</p>\n\n<pre><code>[1588,8DNY],[1488,ACNY],[1288,7DPE],[1888,8HUC],[1488,8WNH]\n</code></pre>\n\n<p>2nd Splitting 2ndarrPrice:</p>\n\n<pre><code>[1588],[1488],[1288],[1888],[1488]\n</code></pre>\n\n<p>2nd Splitting 2ndarrCode:</p>\n\n<pre><code>[8DNY],[ACNY],[7DPE],[8HUC],[8WNH]\n</code></pre>\n\n<p>Sort Price in ascending order:</p>\n\n<pre><code>[1288],[1488],[1488],[1588],[1888]\n</code></pre>\n\n<p>Code will be sorted accordingly:</p>\n\n<pre><code>[7DPE],[ACNY],[8HUC],[8WNH]\n</code></pre>\n\n<p>I am stuck after the 1st splitting.</p>\n\n<pre><code>  if (lblprices.Text != \"\")\n    {\n        arrprice = lblprices.Text.Split(new char[] { ';' }, StringSplitOptions.RemoveEmptyEntries);\n\n        Array.Sort(arrprice);\n\n        for (i = 0; i &lt; arrprice.Length; i++)\n        {\n            arr2 = arrprice[i].Split(',');\n            SQL2 = \"SELECT DISTINCT [TP].[TCode], \";\n            SQL2 += \"[TP].[TName], \";\n            SQL2 += \"[TP].[TName_CN],  \";\n            SQL2 += \"[TP].[TourType], \";\n            SQL2 += \"[TP].[LastUpdateDate], \";\n            SQL2 += \"[TP].[ValidityFrom],  \";\n            SQL2 += \"[TP].[ValidityTo], \";\n            SQL2 += \"[CL].[CountryCode], \";\n            SQL2 += \"[CL].[CityName] \";\n\n            SQL2 += \"FROM [CL], [TP], [TourItinerary],[TourHotel] \";\n\n            SQL2 += \"WHERE [TP].[Activation] = 1  \";\n            SQL2 += \"AND [TP].[TCode] = '\" + arr2[1] + \"' \";\n            SQL2 += \"ORDER BY [TP].[LastUpdateDate] DESC \";\n\n            objConnTour.Open();\n\n            SqlCommand command = new SqlCommand(SQL2, objConnTour);\n            SqlDataReader dataReader = command.ExecuteReader();\n\n            if (dataReader.Read())\n            {\n                html += \"&lt;tr&gt;&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TCode\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TName\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TName_CN\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"TType\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"LastUpdateDate\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"ValidityFrom\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"ValidityTo\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"CountryCode\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;\" + dataReader[\"CityName\"] + \"&lt;/td&gt;\";\n                html += \"&lt;td class=\\\"border\\\"&gt;from&amp;nbsp;&lt;span class=\\\"price-red\\\"&gt;S$&lt;b&gt;\" + arr2[0] + \"&lt;/b&gt;&lt;/span&gt;&lt;td/&gt;&lt;/tr&gt;\";\n            }\n\n            dataReader.Close();\n\n            objConnTour.Close();\n        }\n    }\n    return html;\n</code></pre>\n\n<p>The code above will not be able to sort the price in ascending order. As you can see in my <code>arr2</code> split, I need the <code>Code</code> and <code>Price</code> together as I will be retrieving data from database based on the <code>Code</code>.</p>\n\n<p>--------Edit---------</p>\n\n<p>Ok so the problem is that if the prices are in the of 1000-1999, it gets sorted perfectly.\nBut if i have prices that is less than 1000, it will not be sorted in an ascending manner</p>\n\n<p>Example are the screenshots of the results using the code provided by @jekcom</p>\n\n<p>This is when i haven't split the List and retrieve them raw from the database</p>\n\n<p><img src=\"http://i.stack.imgur.com/7Z0Vz.png\" alt=\"Original, Unsorted\"></p>\n\n<p>And this is the Sorted one using @jekcom's code</p>\n\n<p><img src=\"http://i.stack.imgur.com/IuKTy.png\" alt=\"enter image description here\"></p>\n\n<p>Notice how the Price are not sorted in Ascending manner.</p>\n"},{"tags":["php","sql","select"],"answer_count":11,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":449,"score":0,"question_id":1472137,"title":"SQL: Select * from","body":"<p>i hava a query of the following form</p>\n\n<pre><code>select * from tablename where id= $var\n</code></pre>\n\n<p>now\nsometimes i need to select a recod with a particular id ,and\nsometimes i need to select recore with any id</p>\n\n<p>so i intent to something of follwoing form</p>\n\n<pre><code>$v = $_GET['id'];\nif($v== -1)\n   $var = '*' //here i want to select all recods\nelse\n   $var = $v  //select record recod with specifinc id\n\n//execure the SQL query now\n\nselect * from tablename where id= $var\n</code></pre>\n\n<p>but SQL dont support it when <code>$var = *</code></p>\n\n<p>How can this problem be solved by using the above technique\nNOTE: Actial scenirio is very different and complex so i have\n     just give a simple eg for others to get to know my requiremnt \nI know that the above thing can be handled in many diffret appooaches\nBut i want to solve it in the above descibed approach</p>\n"},{"tags":["c#","sql","sql-server","port","sqlclient"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13214174,"title":"Is the port automatically gathered from SQL Server?","body":"<p>I've noticed that if I don't supply a port when I build a connection string I can still connect to SQL Server via a named instance that looks like [SERVER][INSTANCE_NAME].</p>\n\n<p>Is sqlclient automatically gathering the port number for me? Do I have to concern myself with port number even if the instance is the default instance?</p>\n\n<p>I'm sorry if this question seems novice. Google just hasn't turned anything up for me.</p>\n\n<p>Thank you!</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13198894,"title":"How can I select a ranged rows with order from a table in Oracle?","body":"<p>In Oracle there is no limit, so I used this:</p>\n\n<pre><code>SELECT * FROM ( \n    SELECT m.*, ROWNUM r from TABLE_NAME m  WHERE COL LIKE XYZ ORDER BY ID ASC\n    ) \nWHERE r BETWEEN 10 AND 20;\n</code></pre>\n\n<p>But it is still not ordered. It is ordered in the 10 from 20, but not the entire table. How can I do that? </p>\n\n<p>I want to ORDER THE ENTIRE TABLE with <code>WHERE</code> clause and get the ranged ones. The solution above only order within the range.</p>\n\n<hr>\n\n<p><strong>Maybe less confusing solution (in case anyone googled here):</strong></p>\n\n<pre><code>SELECT a.* from (\n  SELECT b.*, ROWNUM r FROM ( \n    SELECT * FROM table ORDER BY id ASC  \n  ) b  WHERE  (city LIKE '%abc%' OR city IS NULL)\n) a where r between 5 and 10\n</code></pre>\n\n<p>So it is a better idea to put order right in the middle criteria, and then put other criteria in the second level, and put row number in the outter-most level.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12065931,"title":"MySQL Select rows on first occurance of each unique value","body":"<p>Let's say you have the following table (the column of interest here is <code>cid</code>):</p>\n\n<pre><code>+-----+-------+-------+-------+---------------------+--------------+\n| cid | pid   | rid   | clink | time                | snippet      |\n+-----+-------+-------+-------+---------------------+--------------+\n| 155 | 11222 |  1499 |  1137 | 2012-08-22 03:05:06 | hi           |\n| 138 | 11222 |   241 |  1136 | 2012-08-21 05:25:00 | again        |\n| 138 | 11222 |   241 |  1135 | 2012-08-21 05:16:40 | hi           |\n| 155 | 11222 |  1499 |  1134 | 2012-08-21 05:11:00 | hi cute      |\n| 140 | 11222 | 11223 |  1133 | 2012-08-21 05:05:18 | hi           |\n| 154 | 11222 |   565 |  1132 | 2012-08-21 05:04:47 | 7            |\n| 153 | 11222 |   272 |  1131 | 2012-08-21 05:04:41 | 6            |\n| 146 | 11222 |   362 |  1130 | 2012-08-21 05:04:33 | 5            |\n| 152 | 11222 |   364 |  1129 | 2012-08-21 05:04:27 | 4            |\n| 151 | 11222 |   390 |  1128 | 2012-08-21 05:04:22 | 3            |\n| 150 | 11222 |   333 |  1127 | 2012-08-21 05:04:16 | 2            |\n| 148 | 11222 |   268 |  1126 | 2012-08-21 05:04:10 | 1            |\n| 140 | 11222 | 11223 |  1125 | 2012-08-21 04:59:57 | hi sir       |\n| 147 | 11222 |   283 |  1123 | 2012-08-21 03:29:55 | yo           |\n| 140 | 11222 | 11223 |  1121 | 2012-08-21 02:12:13 | hello!       |\n| 139 | 11222 |   249 |  1120 | 2012-08-21 02:11:53 | hi :)        |\n| 140 | 11222 | 11223 |  1119 | 2012-08-21 02:11:26 | hi :)        |\n| 140 | 11222 | 11223 |  1118 | 2012-08-21 02:11:08 | hi too       |\n| 139 | 11222 |   249 |  1117 | 2012-08-21 02:11:00 | :P           |\n| 139 | 11222 |   249 |  1116 | 2012-08-21 02:10:57 | hi           |\n| 139 | 11222 |   249 |  1115 | 2012-08-21 02:10:51 | helo         |\n| 139 | 11222 |   249 |  1114 | 2012-08-21 02:06:19 | hi           |\n| 139 | 11222 |   249 |  1113 | 2012-08-21 02:05:45 | hi baby      |\n| 139 | 11222 |   249 |  1112 | 2012-08-21 02:05:00 | hi           |\n| 139 | 11222 |   249 |  1111 | 2012-08-21 02:04:41 | hi           |\n| 140 | 11222 | 11223 |  1110 | 2012-08-21 02:04:26 | hi           |\n| 140 | 11222 | 11223 |  1108 | 2012-08-21 01:47:40 | hey :)       |\n| 139 | 11222 |   249 |  1107 | 2012-08-21 01:44:43 | hi           |\n| 138 | 11222 |   241 |  1106 | 2012-08-21 01:44:11 | hi           |\n| 138 | 11222 |   241 |  1105 | 2012-08-21 01:09:20 | conv 1 msg 1 |\n+-----+-------+-------+-------+---------------------+--------------+\n</code></pre>\n\n<p>How to extract only the first occurrence of each <code>cid</code>? The resulting table would be:</p>\n\n<pre><code>+-----+-------+-------+-------+---------------------+--------------+\n| cid | pid   | rid   | clink | time                | snippet      |\n+-----+-------+-------+-------+---------------------+--------------+\n| 155 | 11222 |  1499 |  1137 | 2012-08-22 03:05:06 | hi           |\n| 138 | 11222 |   241 |  1136 | 2012-08-21 05:25:00 | again        |\n| 140 | 11222 | 11223 |  1133 | 2012-08-21 05:05:18 | hi           |\n| 154 | 11222 |   565 |  1132 | 2012-08-21 05:04:47 | 7            |\n| 153 | 11222 |   272 |  1131 | 2012-08-21 05:04:41 | 6            |\n| 146 | 11222 |   362 |  1130 | 2012-08-21 05:04:33 | 5            |\n| 152 | 11222 |   364 |  1129 | 2012-08-21 05:04:27 | 4            |\n| 151 | 11222 |   390 |  1128 | 2012-08-21 05:04:22 | 3            |\n| 150 | 11222 |   333 |  1127 | 2012-08-21 05:04:16 | 2            |\n| 148 | 11222 |   268 |  1126 | 2012-08-21 05:04:10 | 1            |\n| 147 | 11222 |   283 |  1123 | 2012-08-21 03:29:55 | yo           |\n| 140 | 11222 | 11223 |  1121 | 2012-08-21 02:12:13 | hello!       |\n| 139 | 11222 |   249 |  1120 | 2012-08-21 02:11:53 | hi :)        |\n+-----+-------+-------+-------+---------------------+--------------+\n</code></pre>\n\n<p>Thanks in advance for any ideas.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13216408,"title":"Select MySQL row where column is closest to current date","body":"<p>I have a database with a bunch of rows. One of the columns is \"date\" which has a date for each row in the format: MM/DD/YYYY H:MM PM/AM</p>\n\n<p>How can I write PHP that selects the row where the date is the most recent date that has passed. Meaning if you have a date of tomorrow, a date of today, and a date of yesterday, it picks the row where the date is of yesterday.</p>\n\n<p>I've already connected to the database:</p>\n\n<pre><code>mysql_connect('localhost','username','pass');\nmysql_select_db('db_name');\n</code></pre>\n\n<p>How do I write a query to grab this?</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13147991,"title":"For the following mysql query I got an output. But how to modify the query so that I get results for a range of date","body":"<pre><code>select hotel.*, hotels.type \nfrom pe,se \nwhere p.hotel_Id = s.S_Id \n  and Type=\"\";\n</code></pre>\n\n<p>The output I got is </p>\n\n<pre><code> pid     SId     PName     PPlan     PMethod     PDate     numberOfParents     SType    \n ---------------------  ----------  -------------------------  -------------------------  ---------------------------  -------------------------  ------------------  ------------ \n 4                      2           kjbkjbjkbk                 jkbjbkbl                   lkblknl                      10/5/2012                  234                 abc       \n 6                      2           dfvrvt                     rvrtv                      rvrtvrt                      1/1/2012                   3                   abc       \n 9                      2           er                         \n</code></pre>\n\n<p>Now my problem is I want query so that my output will be in a such way that the data are for a range of dates. For eg, 08/09/2012 to 10/12/2012.</p>\n\n<p>Separately I could write the mysql query for a date range using >= and &lt;=. But I could not combine that date range part in the present query. Please help me. </p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":76,"score":0,"question_id":13079127,"title":"Whats wrong with the following mysql code","body":"<pre><code>Insert into hotel('fname', 'lname'...\nvalues\n  ('null', 'abc'....\nON DUPLICATE KEY UPDATE \n  fname = 'null',\n  lname = 'abc',.....\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Warnings: \n  W (1): You have an error in your SQL syntax; check the\n  manual that corresponds to your MySQL server version for the right</p>\n</blockquote>\n\n<p>Please help me.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13216068,"title":"MySQL query to return AVG","body":"<p>Just a practice problem, little bit confusing I'd appreciate it if somebody could clear this up..</p>\n\n<p>I have a DB called Product and another one called PC. I'm trying to execute a query to \"find the average hard disk size of a PC for all those manufacturers who also make printers\"</p>\n\n<p>Here's my code:</p>\n\n<pre><code>SELECT maker, AVG(hd) \nFROM pc, product\nWHERE pc.model=product.model\nGROUP BY maker\nHAVING COUNT(type='PR')&gt;=1\n</code></pre>\n\n<p>type is an attribute of Product which either stands for printer(PR) laptop or PC, however the HAVING statement doesn't seem to single out only the makers who produce printers, instead I get back an AVG for each maker in the Product table.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>This is what the relations look like:</p>\n\n<pre><code>Product(maker, model, type)\nPC(model, hd, speed, ram, price)\nPrinter(model, color, type, price)\n</code></pre>\n"},{"tags":["php","sql","phpbb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13215749,"title":"Trouble With Understanding How PHPBB translates to regular PHP","body":"<p>I have been fiddling around with a third-party script for some time when I noticed there was some unusual PHPBB framework code put in randomly with the rest of the PHP.  What I need to understand is if there is anything particularly special about this code(can it do something regular PHP can't?) and how I can smoothly transition the code to PHP without a framework if there isn't anything special about the code.</p>\n\n<pre><code>&lt;?\ninclude('bar.php');\ninclude \"../includes/config.inc.php\";\ninclude \"loggedin.inc.php\";\ninclude \"../includes/countries.inc.php\";\n$auction_id = isset($_REQUEST['aid']) ? $_REQUEST['aid'] : \"\";\n?&gt;\n&lt;?\ndefine(\"DATAGRID_DIR\", \"../datagrid/\");\ndefine(\"PEAR_DIR\", \"../datagrid/pear/\");\nrequire_once(DATAGRID_DIR . 'datagrid.class.php');\nrequire_once(PEAR_DIR . 'PEAR.php');\nrequire_once(PEAR_DIR . 'DB.php');\n$DB_USER = $DbUser;\n$DB_PASS = $DbPassword;\n$DB_HOST = $DbHost;\n$DB_NAME = $DbDatabase;\nob_start();\n$db_conn     = DB::factory('mysql');\n$result_conn = $db_conn-&gt;connect(DB::parseDSN('mysql://' . $DB_USER . ':' . $DB_PASS . '@' . $DB_HOST . '/' . $DB_NAME));\nif (DB::isError($result_conn)) {\n    die($result_conn-&gt;getDebugInfo());\n}\n$sql = \"SELECT u.id, u.nick, COUNT(b.bidder) AS bid_count, 'View offers' AS link\n            FROM BPLA_bids b\n                INNER JOIN BPLA_users u ON b.bidder=u.id\n            WHERE b.auction=$auction_id\n            GROUP BY b.bidder\";\n$unique_prefix       = \"au_\";\n$dgrid               = new DataGrid($debug_mode, $messaging, $unique_prefix, DATAGRID_DIR);\n$default_order_field = \"nick\";\n$default_order_type  = \"ASC\";\n$dgrid-&gt;dataSource($db_conn, $sql, $default_order_field, $default_order_type);\n$dg_language = \"en\";\n$dgrid-&gt;setInterfaceLang($dg_language);\n$direction = \"ltr\";\n$dgrid-&gt;setDirection($direction);\n$modes = array(\n    \"add\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\"\n    ),\n    \"edit\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\",\n        \"byFieldValue\" =&gt; \"\"\n    ),\n    \"cancel\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\"\n    ),\n    \"details\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"link\"\n    ),\n    \"delete\" =&gt; array(\n        \"view\" =&gt; false,\n        \"edit\" =&gt; false,\n        \"type\" =&gt; \"image\"\n    )\n);\n$dgrid-&gt;setModes($modes);\n$http_get_vars = array(\n    \"aid\"\n);\n$dgrid-&gt;setHttpGetVars($http_get_vars);\n$printing_option = false;\n$dgrid-&gt;allowPrinting($printing_option);\n$exporting_option    = false;\n$exporting_directory = \"\";\n$dgrid-&gt;allowExporting($exporting_option, $exporting_directory);\n$sorting_option = true;\n$dgrid-&gt;allowSorting($sorting_option);\n$paging_option   = true;\n$rows_numeration = false;\n$numeration_sign = \"N #\";\n$dgrid-&gt;allowPaging($paging_option, $rows_numeration, $numeration_sign);\n$bottom_paging     = array();\n$top_paging        = array();\n$pages_array       = array(\n    \"10\" =&gt; \"10\",\n    \"25\" =&gt; \"25\",\n    \"50\" =&gt; \"50\",\n    \"100\" =&gt; \"100\",\n    \"250\" =&gt; \"250\"\n);\n$default_page_size = 10;\n$paging_arrows     = array(\n    \"first\" =&gt; \"|&amp;lt;&amp;lt;\",\n    \"previous\" =&gt; \"&amp;lt;&amp;lt;\",\n    \"next\" =&gt; \"&amp;gt;&amp;gt;\",\n    \"last\" =&gt; \"&amp;gt;&amp;gt;|\"\n);\n$dgrid-&gt;setPagingSettings($bottom_paging, $top_paging, $pages_array, $default_page_size, $paging_arrows);\n$dgrid-&gt;setViewModeTableProperties($vm_table_properties);\n$vm_colimns = array(\n    \"nick\" =&gt; array(\n        \"header\" =&gt; \"Nick\",\n        \"type\" =&gt; \"label\",\n        \"summarize\" =&gt; \"false\",\n        \"visible\" =&gt; \"true\"\n    ),\n    \"bid_count\" =&gt; array(\n        \"header\" =&gt; \"Bid count\",\n        \"type\" =&gt; \"label\",\n        \"summarize\" =&gt; \"false\",\n        \"visible\" =&gt; \"true\"\n    ),\n    \"link\" =&gt; array(\n        \"header\" =&gt; \"&amp;nbsp;\",\n        \"type\" =&gt; \"link\",\n        \"field_key\" =&gt; \"id\",\n        \"field_data\" =&gt; \"link\",\n        \"href\" =&gt; \"auction_users_bids.php?aid=$auction_id&amp;uid={0}\"\n    )\n);\n$dgrid-&gt;setColumnsInViewMode($vm_colimns);\n$dgrid-&gt;bind();\nob_end_flush();   \n?&gt;\n</code></pre>\n"},{"tags":["mysql","sql","database","database-design"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":7926904,"title":"CHADIM in information technology context","body":"<p>What is CHADIM in information technology context?\nMy assignment for one IT class(Relational database management system) is a investigation report on CHADIM.</p>\n\n<p>Can someone give me some pointers on the subject? i cant find anything related  on search engines.</p>\n"},{"tags":["php","mysql","sql","database","sync"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13216042,"title":"MySQL database sync betwen two servers using PHP","body":"<p>I have two same websites on two different servers. </p>\n\n<pre><code>Master Database - server1\nSlave Database - Server2\n</code></pre>\n\n<p>I wanna make PHP script which will check for changes in master database and if found any it will syncronize it with slave database. I will set chronjob for that script so it will run every few minutes.</p>\n\n<p>I found some scripts on Google but it doesn't work at all.\nI tried using PMS(<a href=\"http://sourceforge.net/projects/mysqlsync/\" rel=\"nofollow\">http://sourceforge.net/projects/mysqlsync/</a>) but i reciving:</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant user - assumed 'user' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant pass - assumed 'pass' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant base - assumed 'base' in /var/www/demos/pms/pmslib.php on line 63</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 79</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant user - assumed 'user' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant pass - assumed 'pass' in /var/www/demos/pms/pmslib.php on line 57</p>\n\n<p>Notice: Use of undefined constant base - assumed 'base' in /var/www/demos/pms/pmslib.php on line 63</p>\n\n<p>Notice: Use of undefined constant host - assumed 'host' in /var/www/demos/pms/pmslib.php on line 79</p>\n"},{"tags":["c#","sql","linq-to-sql","datacontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13212055,"title":"New DataContext per second","body":"<p>I'm making a server for a game and I need to save everyone's second so I made :-</p>\n\n<pre><code>private static void SubmitChanges() {\n    while(true) {\n        try {\n            using(GameDBDataContext db = new GameDBDataContext()){\n                foreach(IHero hero in world.Entities.BattleEntities.OnlineHeros.Values) {\n                    hero.Update(db);\n                }\n            }\n        } catch(Exception ex) {\n            Console.WriteLine(ex.ToString());\n        }\n        Thread.Sleep(1000);\n    }\n}\n</code></pre>\n\n<p>Is that fine? and would it be fine if I have like 500 online heroes?</p>\n\n<p><strong>EDIT</strong>: Checking how long it takes :-</p>\n\n<pre><code>private void UpdateDatabase() {\n    try {\n        using(GameDBDataContext db = new GameDBDataContext()) {\n            foreach(IHero hero in world.Entities.BattleEntities.OnlineHeros.Values) {\n                DateTime now = DateTime.Now;\n                hero.Update(db);\n                DateTime after = DateTime.Now;\n                Console.WriteLine((now - after).Milliseconds);\n            }\n        }\n    } catch(Exception ex) {\n        Console.WriteLine(ex.ToString());\n    }\n}\n</code></pre>\n\n<p>result :- </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>-13\n-10\n-13\n-26\n-19\n-24\n-25\n-19\n-27\n-22\n-19\n-26\n-25\n-21\n-24\n-22\n</code></pre>\n"},{"tags":["sql","query","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13215553,"title":"Match a column from a column with concatenated values in sqlite","body":"<p>I have a table with a column that has concatenated values like this</p>\n\n<pre><code>Table CHILD:\n\n    ChildId       Values\n    2           x123,j455\n    3           f456,z789 \n    4           m333,y567\n    5           x123,h888\n</code></pre>\n\n<p>And I have a master table MASTER that has </p>\n\n<pre><code>Table MASTER:\n\n    MainValues\n    x123\n    f456\n    y567\n</code></pre>\n\n<p>I need to get a query that'll select the following data</p>\n\n<pre><code>ChildId MainValues\n2       x123\n3       f456\n4       y567\n5       x123\n</code></pre>\n\n<p>Basically match value from MASTER in child values and return only the master value. How can I do this ? I have tried IN and LIKE clause matching with second table but that doesnt help much since the values are csv. Is there a way to split and match in sqlite ? </p>\n\n<p>EDIT: Table and column names are fictional and intended just to explain this question better</p>\n"},{"tags":["sql","replace","bit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13215811,"title":"Can I replace values of bit field to text in creating Table","body":"<p>I tried but can't use CASE WHEN in CREATE TABLE code to replace 1 and 0 with text. Can someone help me to solve it. Thank you so much :D</p>\n"},{"tags":["sql","sql-server-2008","ssis"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2579,"score":2,"question_id":1596069,"title":"OnTaskFailed event handler in SSIS","body":"<p>If I use <strong>OnError</strong> event handler in my SSIS package, there are variables <strong>System::ErrorCode</strong> and <strong>System::ErrorDescription</strong> from which I can get the error information if any things fails while execution.</p>\n\n<p>But I cant the find the same for <strong>OnTaskFailed</strong> event handler, i.e. How to get the <strong>ErrorCode</strong> and <strong>ErrorDescription</strong> from the OnTaskFailed event handler when any things fails while execution in case we want to only implement OnTaskFailed event handler for our package?</p>\n"},{"tags":["android","sql","jquery-ajax","phonegap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13173475,"title":"phonegap $.ajax()","body":"<p>anyone know how to store the jsonp data from server in phonegap local database?</p>\n\n<p>the code below can help to connect the phonegap android app to the server, but how to store the data in the phonegap local database?</p>\n\n<pre><code>$.ajax({\n    url: 'http://172.18.75.156/deals.php',\n    dataType: 'jsonp',\n    jsonp: 'jsoncallback',\n    timeout: 5000,\n    success: function(data, status){\n        $.each(data, function(i,item){ \n            output.text('successful');\n        });\n    },\n    error: function(){\n       output.text('There was an error loading the data.');\n    }\n});\n</code></pre>\n"},{"tags":["sql","sql-server","stored-procedures"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":287,"score":2,"question_id":7421074,"title":"Is it possible to create a stored procedure with two insert statements where id/primary_key from the first insert statement will be used in second?","body":"<p>I see that there is a very similiar question already answered that discusses this same issue, but i just cannot seem to understand it. Below is a copy of my code that is in a stored procedure.  I need to somehow, have the second insert statement insert the CompanyID generated from the first, into this second Statement.  I appreciate any help i can get.</p>\n\n<p>Thank You!!</p>\n\n<pre><code>@comp_name nvarchar (50),\n@City nvarchar (50),\n@State nvarchar (10),\n@Address ntext,\n@Zip_Code nvarchar (50),\n@Country nvarchar (50),\n@cust_name nvarchar (50),\n@CompanyID int\nAS\nINSERT INTO Company_Listing\n(comp_name, City, State, Address, Zip_Code, Country)\nVALUES (@comp_name, @City, @State, @Address, @Zip_Code, @Country)\n\nINSERT INTO Customer_Listing\n(cust_name, City, State, Address, Zip_Code, Country, CompanyID)\nVALUES (@comp_name,@City,@State,@Address,@Zip_Code,@Country,@CompanyID)\n</code></pre>\n"},{"tags":["java","sql","mysql","jdbc"],"answer_count":8,"favorite_count":10,"up_vote_count":10,"down_vote_count":0,"view_count":9289,"score":10,"question_id":1044194,"title":"Running a .sql script using MySQL with JDBC","body":"<p>I am starting to use MySQL with JDBC.</p>\n\n<pre><code>Class.forName(\"com.mysql.jdbc.Driver\");\nconn = DriverManager.getConnection(\"jdbc:mysql:///x\", \"x\", \"x\");\nstmt = conn.createStatement();\nstmt.execute( \"CREATE TABLE amigos\" +\n            \"(\"+\n            \"id          int AUTO_INCREMENT          not null,\"+\n            \"nombre      char(20)                    not null,\"+\n            \"primary key(id)\" +\n            \")\");\n</code></pre>\n\n<p>I have 3-4 tables to create and this doesn't look good.</p>\n\n<p>Is there a way to run a .sql script from MySQL JDBC?</p>\n"},{"tags":["sql","database","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13214391,"title":"Can I create a foreign key for a table with elements which don't exist in the referenced table?","body":"<p>I'm working on an assignment which wants me to write some referential integrity constraints on a table.  It asks me to ensure that every battle in Outcomes is also mentioned in Battles and to handle all violations by setting the referencing value to NULL. </p>\n\n<p>I'm  working with the following schemas</p>\n\n<pre><code>Battles(\n    name VARCHAR(255) PRIMARY KEY, \n    date VARCHAR(255), \n)\nOutcomes(\n    ship VARCHAR(255),\n    battle VARCHAR(255),\n    RESULT VARCAHR(255),\n    PRIMARY KEY(ship, battle)\n)\n</code></pre>\n\n<p>I'm trying to add the foregin key like this:</p>\n\n<pre><code>alter table outcomes \nadd foreign key (battle) \nreferences battles(name) \non delete set null \non update cascade;\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>SQL error:\n\nERROR:  insert or update on table \"outcomes\" violates foreign key constraint \"outcomes_battle_fkey\"\nDETAIL:  Key (battle)=(Pearl Harbor \n</code></pre>\n\n<p>I know this is because \"Pearl Harbor\" is in OUTCOMES but not in BATTLES, what I want to know is if there is some way to ignore that fact and set the foreign key anyway? </p>\n"},{"tags":["apache2","postgresql","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13215332,"title":"error on sql data push","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12918630/error-on-windows-apache-data-push\">error on windows -&gt; apache data push</a>  </p>\n</blockquote>\n\n\n\n<p>On a scheduled data push to a postgre db on an apache server, an error has sort of just cropped up out of the blue. The server doing the push is Windows server 2003. The data push is a SQLserver agent job running a stored procedure.</p>\n\n<p>At first it seemed it was a memory issue that was making the push fail. Error message:</p>\n\n<pre><code>Msg 7300, Sev 16: OLE DB error trace [OLE/DB Provider 'MSDASQL' IOpenRowset::OpenRowset returned 0x8007000e:  The provider ran out of memory.]. [SQLSTATE 01000]\n</code></pre>\n\n<p>But after having restarted both servers, I now get this error:</p>\n\n<pre><code>Msg 7300, Sev 16: OLE DB error trace [OLE/DB Provider 'MSDASQL' ::Commit returned 0x8000ffff:  The provider reported an unexpected catastrophic failure.]. [SQLSTATE 01000]\n</code></pre>\n\n<p>Can someone help me figure out what exactly this means and how to correct it?</p>\n\n<p>Thank you very much</p>\n"},{"tags":["mysql","sql","database","structure","ranking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13215230,"title":"Ranking Script - Database Structure","body":"<p>For like 2 last months I was thinking about makin ranking site for an fps game. Suddenly I had no time to start the project, so it was waiting in my mind for better times :)\nNow I would like to start it and I consider what type of database I should do for it.\nIn my opinion the relation one, should be the best, but I am not 100% is it possible to do it like that, since I saw like 2-3 ranking systems where the tables had no relations at all.</p>\n\n<p>In fact I did, such structure for the database:\n<a href=\"http://postimage.org/image/n1lackjfz/\" rel=\"nofollow\">http://postimage.org/image/n1lackjfz/</a> (no dots means 1:1, white dot-black dot means 1:n)</p>\n\n<p>I would really appreciate, if you could give me some advices. If is okey or I should forget about InnoDB one and just make an simple MyISAM engine based database.</p>\n"},{"tags":["sql","xml","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13215005,"title":"Import data into SQLite from XML","body":"<p>I am trying to import data stored in a XML file into my SQLite database. The insert query looks something like the following:</p>\n\n<pre><code>INSERT INTO table1 VALUES (rank, name)\nSELECT X.record.query('rank').value('.', 'INT'),\n       X.record.query('name').value('.', 'VARCHAR(30)')\nFROM (\n  SELECT CAST(x AS XML)\n  FROM OPENROWSET(BULK 'data.xml', SINGLE_BLOB) AS T(x)\n     ) AS T(x)\nCROSS APPLY x.nodes('data/record') AS X(record);\n</code></pre>\n\n<p>The XML data looks like this:</p>\n\n<pre><code>&lt;data&gt;\n    &lt;record&gt;\n        &lt;rank&gt;1&lt;/rank&gt;\n        &lt;name&gt;One&lt;/name&gt;\n    &lt;/record&gt;\n    &lt;record&gt;\n        &lt;rank&gt;2&lt;/rank&gt;\n        &lt;name&gt;Two&lt;/name&gt;\n    &lt;/record&gt;\n    ...\n&lt;/data&gt;\n</code></pre>\n\n<p>However, I am getting \"SQL command not properly ended at the outer SELECT statement, and I can't figure out why. Any ideas?</p>\n"},{"tags":["sql","oracle","sql-developer","oracle-sqldeveloper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13214951,"title":"Internal error on Oracle SQL Developer 3.2.20.09","body":"<p>I am trying ton insert few data on my existing table but it's showing internal error on all tables. </p>\n\n<p>Here is my simple insert into code where sql developer shows the error:</p>\n\n<pre><code>Insert into STUDENTS (I_ID,C_ID) values (1,'801')\n</code></pre>\n\n<p><strong>ERROR:</strong></p>\n\n<pre><code>Error starting at line 1 in command:\nInsert into STUDENTS(I_ID,C_ID) values (1,'801')\nError at Command Line:1 Column:1\nError report:\nSQL Error: ORA-00600: internal error code, arguments: [kqd-objerror$], [U], [0], [373], [BIN$XQQxCzAhRPCuX323VsAKNA==$0], [], [], [], [], [], [], []\n00600. 00000 -  \"internal error code, arguments: [%s], [%s], [%s], [%s], [%s], [%s], [%s], [%s]\"\n*Cause:    This is the generic internal error number for Oracle program\n           exceptions.  This indicates that a process has encountered an\n           exceptional condition.\n*Action:   Report as a bug - the first argument is the internal error number\n</code></pre>\n\n<p>Do you guys have any idea?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":13162616,"title":"how can I fix this..in select query","body":"<p>this is a select query...</p>\n\n<pre><code>   $q = \"SELECT\n        tcs.tutor_id AS tid,\n        tcs.category_id AS cid,\n        tcs.subject_id AS sid,\n        GROUP_CONCAT( DISTINCT s.subjects SEPARATOR ', ') AS subjects,\n        t.tutor_name AS tname,\n        t.tutor_code AS tcode,\n        DATE_FORMAT(t.registration_date, '%b %D, %Y') AS date,\n        t.qualification AS qualifi,\n        GROUP_CONCAT( DISTINCT o.option_name SEPARATOR ', ') AS tutor_option,\n        timg.image_name AS img,\n        city_name AS city,\n        d.district_name AS district\n   FROM tutor_category_subject as tcs\n        INNER JOIN subject AS s ON tcs.subject_id = s.subject_id\n        INNER JOIN tutor_option AS toption ON toption.tutor_id = tcs.tutor_id\n        INNER JOIN options AS o ON toption.option_id = o.option_id\n        INNER JOIN tutors AS t ON tcs.tutor_id = t.tutor_id\n        INNER JOIN address ON address.address_id = t.address_id\n        INNER JOIN city ON city.city_id = address.city_id\n        INNER JOIN district AS d ON d.district_id = city.district_id\n        LEFT JOIN tutor_images AS timg ON timg.tutor_id = tcs.tutor_id AND timg.image_type = 'profile'\n   WHERE s.subjects LIKE '%$subject%'\n   GROUP BY tcs.tutor_id\";\n</code></pre>\n\n<p>this query is working now.. now I found a problem. it is..... so many subject may have to one particular tutor. I need to select all the subject that pertaining to a tutor with searching keyword to display with search result. In this query searching keyword is '$subject'.\nThis query only selecting subjects to the tutor similar to the given keyword. For an example if a user give a keyword like 'business' query selecting subjects to that tutor like 'business studies, business accounting., etc only'. so I need to select other subjects too through this query.. can anybody help me?</p>\n\n<p>thank you. </p>\n"},{"tags":["mysql","sql","pivot","aggregate-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13214601,"title":"MySQL Query: How to sum 3 different values in a column, showing total of each value in result set","body":"<p>I have a table called inventory that includes two columns as follows:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ST24o.png\" alt=\"enter image description here\"></p>\n\n<p>I would like to query this table to return a result set that lists how many items of each condition I have (column headers show in example below are not wanted in result set...just show here to give clarity):</p>\n\n<p><img src=\"http://i.stack.imgur.com/Xrylg.png\" alt=\"enter image description here\"></p>\n\n<p>I guess it would look something like:</p>\n\n<pre><code>  SELECT item, sum(condition???), sum(condition???), sum(condition???) \n    FROM inventory \nGROUP BY item\n</code></pre>\n\n<p>How can I accomplish this? Thanks.</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13214465,"title":"Joining/Displaying Multiple Tables with Same Column Names","body":"<p>What I'm trying to do is set up a query that calls from a Database (the Chinook database in particular - <a href=\"http://chinookdatabase.codeplex.com/\" rel=\"nofollow\">http://chinookdatabase.codeplex.com/</a>)</p>\n\n<p>Now, in order to display the query output correctly, I need to join multiple tables - each that share similar column names.  With the Chinook database, there are multiple tables (Artist, Album, Genre, Media Type, Track, etc.).  Let's say I'm trying to display the contents of an Artist's Name with:</p>\n\n<pre><code>public function fetchArtistName(){\n    return $row['Name'];\n}\n</code></pre>\n\n<p>This is very ambiguous since this row would go and find the Name field for Media Type or Album Name before it finds the artist name.</p>\n\n<p>My SQL statement is as follows:</p>\n\n<pre><code>SELECT *  \nFROM track AS t  \nLEFT JOIN album al \nON t.AlbumId = al.AlbumId  \nLEFT JOIN artist ar ON al.ArtistId = ar.ArtistId  \nLEFT JOIN mediatype m ON t.MediaTypeId = m.MediaTypeId \nLIMIT 0,15; \n</code></pre>\n\n<p>Is there a way I could go about changing the table that is outputted to be like\n|  t.Name   |   al.Name   |    ar.Name    |    m.name    |</p>\n\n<p>so that I could essentially call these much easier with</p>\n\n<pre><code>public function fetchArtistName(){\n    return $row['ar.Name'];\n}\n</code></pre>\n\n<p>It has been so long since I've played with SQL and I'm really stuck.  Any help would be greatly appreciated, I've Googled and search here already.</p>\n\n<p>Thank you.</p>\n"},{"tags":["sql","sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13214317,"title":"compare 2 columns from different tables","body":"<p>I have 2 tables with same column in each.. Lets call it colors. How do I compare the two to show the unique colors in table B that are not in table A?</p>\n"},{"tags":["php","sql","md5"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":13213237,"title":"encrypt password in md5?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2778915/need-help-how-to-add-md5-to-password-field-in-php\">Need help… how to add md5 to password field in php?</a>  </p>\n</blockquote>\n\n\n\n<p>I have got this script to allow users to change their passwords. But am wanting the 'newpassword' to be encrypted into the database with md5. Can anyone tell me how i can change this script to encrypt the 'newpassword' in md5 please?</p>\n\n<pre><code>    &lt;?php\nrequire_once(\"session.php\"); \nrequire_once(\"functions.php\");\nrequire('_config/connection.php');\n?&gt;\n&lt;?php \n\nsession_start();\n\ninclude '_config/connection.php'; \n\n$email = $_POST['email'];\n$password = $_POST['password'];\n$newpassword = $_POST['newpassword'];\n$confirmnewpassword = $_POST['confirmnewpassword'];\n\n$result = mysql_query(\"SELECT password FROM ptb_users WHERE email='$email'\");\n\n\n\n\n\nif(!$result) \n{ \necho \"The username you entered does not exist\"; \n} \nelse \nif($password!= mysql_result($result, 0)) \n{ \necho \"You entered an incorrect password\"; \n} \nif($newpassword=$confirmnewpassword) \n    $sql=mysql_query(\"UPDATE ptb_users SET password='$newpassword' where email='$email'\"); \n    if($sql) \n    { \n    echo \"Congratulations You have successfully changed your password\"; \n    }\nelse\n{ \necho \"The new password and confirm new password fields must be the same\"; \n}  \n?&gt;\n</code></pre>\n"},{"tags":["php","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13214285,"title":"PHP - Using strcpsn() to protect against SQL injection?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php\">Best way to prevent SQL injection in PHP?</a>  </p>\n</blockquote>\n\n\n\n<p>I am making a sort of form validation system and I need to check the SQL database to see if the username is already there.</p>\n\n<p>So, my question, is it effective to use a little if statement like this to protect against an attack?</p>\n\n<pre><code>if (strcspn($string, \"/\\?!@#$%^&amp;*()[]{}|:;&lt;&gt;,.\\\"\\'-+=\" == strlen($string)){\n    return true;    \n    }\n</code></pre>\n\n<p>So essentially, if the string contains any of these characters, <code>\"/\\?!@#$%^&amp;*()[]{}|:;&lt;&gt;,.\\\"\\'-+=\"</code>, then the length will not equal that of the original <code>$string</code>.</p>\n\n<p>I am just wondering if this is sufficient to protect, or if there is more that I must do.\nThanks.</p>\n"},{"tags":["sql","database","oracle","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13213923,"title":"How to create sql query results in columns from rows?","body":"<p>From the following tables:</p>\n\n<ul>\n<li>store(store_id, ...) {1 ..., 2 ...} two stores</li>\n<li>film(film_id, ...)</li>\n<li>inventory(inventory_id, film_id, store_id)</li>\n<li>rental(rental_id, rental_date, inventory_id, return_date, ...)</li>\n<li>category(category_id, name)</li>\n<li>film_category(film_id, category_id)</li>\n<li>film(film_id, rental_duration, rental_rate, ...)</li>\n<li>customer(customer_id, store_id, ...)</li>\n</ul>\n\n<p>Can I have a query resutls on a table just like the follwoing?</p>\n\n<p>CategoryName | \"Store 1: avaliable items\" | \"Store 1: unavaliable items\" | \"Store 2: avaliable items\" | \"Store 2: unavaliable items\"</p>\n\n<p>Notice that the store fileds in the result table are inseperate columns not in the same columns !!</p>\n\n<p>I am not looking for the result query, I am looking for how to make them side by side store 1, store 2.</p>\n\n<p>Can case sql statement help here?</p>\n"},{"tags":["mysql","sql","database","query","join"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13213948,"title":"join two tables with different rows and multiple select statements","body":"<p>I have a result as</p>\n\n<pre><code>select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username\n</code></pre>\n\n<p>which gives me the columns as <code>username,EmaxViews</code> and gives me 93 rows</p>\n\n<p>and I have another table as <code>Users (username,date_registered,name)</code> which has 100 queries in it</p>\n\n<p>I would like to join my above two queries as a single table as</p>\n\n<pre><code>username, date_registered, EmaxViews\n</code></pre>\n\n<p>I tried like this</p>\n\n<pre><code>select name, date_registered,G.EmaxViews from Users F LEFT OUTER JOIN (select D.name as username, E.maxViews AS EmaxViews from (select A.video_id, A.uploaded_by AS username,max(B.numViews) AS maxViews,count(*) AS C from Videos A, (select video,count(*) AS numViews from Views GROUP BY video) B where A.video_id=B.video GROUP BY A.uploaded_by) E, Users D where D.username=E.username) G ON F.username=G.username ORDER BY F.date_registered;\n</code></pre>\n\n<p>Now I am getting 100 rows and proper values for name and date_registered but I am getting NULL for EmaxViews for all the rows..</p>\n\n<p>whats wrong in my query ?</p>\n"},{"tags":["sql","vb.net","stored-procedures","sqldatareader","datareader"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13213956,"title":"SqlDataReader does not read all records","body":"<p>I have a very weird problem in the most simple piece of VB.NET code:</p>\n\n<pre><code>Public Sub ReadIDs(i_oDataReader As Data.SqlClient.SqlDataReader)\n\n    m_aFullIDList = New Generic.List(Of Integer)\n\n    While i_oDataReader.Read\n        If i_oDataReader.IsDBNull(0) = False Then\n            m_aFullIDList.Add(i_oDataReader.GetInt32(0))\n        End If\n    End While\n\n    m_iTotalNumberOfRecords = m_aFullIDList.Count\n\nEnd Sub\n</code></pre>\n\n<p>Basically the procedure accepts a DataReader as a parameter, loops thru all the records in the reader, adding them to a Generic list of integer.</p>\n\n<p>When SQL Stored Procedure that is behind the reader returns relatively small amount of records (below 100K) reader reads all the records and the final count matches the resultset. But when the number of records is over 1 million - results become unpredictable.</p>\n\n<p>E.g. When I know that SP rerturns 1.5M of records - final count of records in Generic list could be 200K, 500K etc.</p>\n\n<p>Any idea what is causing it and how to fix it? Thanks!</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13213265,"title":"processing blocks of records in composite primary key order","body":"<p>I'm using mysql and would like to process a very large table with a primary key of 4 parts in blocks of 10,000 (marshalling data to another system). The database is offline when I am doing the processing so I don't have to worry about any modifications. Say the primary key is (<code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>) which are all integers. I first tried using <code>LIMIT OFFSET</code> to achieve this like this:</p>\n\n<pre><code>SELECT * FROM LargeTable ORDER BY (A, B, C, D) LIMIT 10000 OFFSET 0;\n</code></pre>\n\n<p>Where I increased the offset by 10000 on each call. This seemed to get very slow as it got towards the higher rows in the table. Is it not possible to do this <code>LIMIT OFFSET</code> efficiently?</p>\n\n<p>Then I tried a different approach that uses comparison on the composite primary key. I can get the first block like this:</p>\n\n<pre><code>SELECT * FROM LargeTable ORDER BY (A, B, C, D) LIMIT 10000;\n</code></pre>\n\n<p>If the last row of that block has <code>A = a</code>, <code>B = b</code>, <code>C = c</code>, and <code>D = d</code> then I can get the next block with:</p>\n\n<pre><code>SELECT * FROM LargeTable\nWHERE\n    A &gt; a OR\n    (A = a AND B &gt; b) OR\n    (A = a AND B = b AND C &gt; c) OR\n    (A = a AND B = b AND C = c AND D &gt; d)\nORDER BY (A, B, C, D) LIMIT 10000;\n</code></pre>\n\n<p>And then repeat that for each block. This also seemed to slow down greatly as I got to the higher rows in the table. Is there a better way to do this? Am I missing something obvious?</p>\n"},{"tags":["sql","tsql"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13213691,"title":"Noob Concern: Sub-query calculations","body":"<p>I've got a table <strong>bbc</strong> with the following columns:</p>\n\n<p><strong>name</strong> (refers to a name of a country within a particular region of the world)</p>\n\n<p><strong>region</strong> (continent of the world)</p>\n\n<p><strong>population</strong> (population of the country in the name name field)\nThe question I'm trying to answer:</p>\n\n<p>The <strong>question</strong> is as follows:<br>\n\"Some countries have populations more than three times that of any of their neighbours (in the same region). Give the countries and regions.\"</p>\n\n<p>I was thinking the answer might be something like:</p>\n\n<pre><code>SELECT a.name, a.region FROM bbc AS a\nWHERE a.region IN\n     (\n        SELECT b.region FROM bbc AS b \n        GROUP By b.region \n        HAVING MIN(b.population) &lt; 3*b.population)\n</code></pre>\n\n<p>But honestly, I lose it at that last line... I have no idea how I would find counteries that have more than three times that of any of their neighbours in the same region!  Quite tough.  O_o  </p>\n\n<p>Any and all help would be appreciated.  </p>\n"},{"tags":["mysql","sql","debugging"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":58,"score":-1,"question_id":12885309,"title":"Please resolve the syntax error in the mysql insert query","body":"<p>I am using mysql 5.5.27</p>\n\n<p>At places where it looks like double quotes are two single quotes closer together, and they are actually null values in the excel sheetin the db.</p>\n\n<p>I get the following error,</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLS… You have an error in your SQL syntax; \n  check the manual that corresponds to your MySQL server version for the right \n  syntax to use near 'CASE,lname,fname,gender,dob,ssn,… at line 1\n</code></pre>\n\n<p>the actual query is</p>\n\n<pre><code>Insert into \n  work(CASE,lname,fname,gender,dob\n</code></pre>\n"},{"tags":["android","sql","database","eclipse","debugging"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6606,"score":1,"question_id":6333412,"title":"How to view SQL database in Eclipse Debug mode for android","body":"<p>I am looking for a way to see realtime (as I debug) what is in my SQL database.</p>\n\n<p>Does anyone know how to do this?  I have tried looking through the variables tab but can't seem to find anything.</p>\n"},{"tags":["php","jquery","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13213700,"title":"Drupal site crashing","body":"<p>I am not a developer, I am just ask for advice on what my next step should be.</p>\n\n<p>2 months ago I launched my site using Drupal. <a href=\"http://www.evolvefitwear.com\" rel=\"nofollow\">http://www.evolvefitwear.com</a> So far it has crashed 3 times and been down for about 1.5 days each time. I have been told that the issue was with certain plug-ins not being compatible with others on the site. </p>\n\n<p>My question: </p>\n\n<p>1) is this a common issue Drupal/ PHP developers face when working on the backend </p>\n\n<p>2) if so what steps do you take to prevent it- back up \"testing\" site with different URL?</p>\n\n<p>3) would you suggest me contacting another developer to review the code, but if its fixed now would they find anything?   </p>\n\n<p>I have a handful of other tasks to complete on the site and open to suggestions on where I could turn to for help</p>\n\n<p>thanks! Kyla</p>\n"},{"tags":["php","mysql","sql","group"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13213205,"title":"messages between users: show conversations","body":"<p>right now, I am coding a message system for user communication. In the inbox I do not want to show the user the messages he/she received. I just want to show the conversations. So as an example, if one user send or receive more than one message then in the inbox there should only be the conversation (which includes the newest message, either written or received) with the user and when the user clicks on the conversation he/she can see all past messages.</p>\n\n<p>The table structure (simplified) of 'messages' is as followed:</p>\n\n<pre><code>message_id\nuser_id_sender\nuser_id_recipient\nmessage\n</code></pre>\n\n<p>Now the problem is that the messages are saved in a database where each row is one message, so I have to group these messages in a certain way.</p>\n\n<p>The select statement I came up with is the following:</p>\n\n<pre><code>SELECT * FROM messages\nWHERE user_id_sender = 1 OR user_id_recipient = 1\nGROUP BY user_id_sender\n</code></pre>\n\n<p>But now I obviously get two messages because one which has been written by user '1' and one that he has received..</p>\n\n<p>Does anybody have an idea how to solve this?</p>\n\n<p>Thank you in advance,</p>\n\n<p>Freddy</p>\n"},{"tags":["sql","mysql","sql-order-by","group-concat"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2442,"score":3,"question_id":1577860,"title":"Ordering in a MySQL GROUP_CONCAT with a function in it","body":"<p>I want to order the results in a GROUP_CONCAT function. The problem is, that the selection in the GROUP_CONCAT-function is another function, like this (fantasy select):</p>\n\n<pre><code>SELECT a.name,\n    GROUP_CONCAT(DISTINCT CONCAT_WS(':', b.id, c.name) ORDER BY b.id ASC) AS course\nFROM people a, stuff b, courses c\nGROUP BY a.id\n</code></pre>\n\n<p>I want to get a result like (ordered by b.id):</p>\n\n<pre><code>michael    1:science,2:maths,3:physics\n</code></pre>\n\n<p>but I get:</p>\n\n<pre><code>michael    2:maths,1:science,3:physics\n</code></pre>\n\n<p>Does anyone know how I can order by b.id in my group_concat here?</p>\n"},{"tags":["sql","sql-server","tsql","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13212883,"title":"How can I PIVOT this data?","body":"<p>First, sorry for the middling title.  Didn't have a ton of success on that front.</p>\n\n<p>So - I have a table of data that has one row for each volunteer shift a person is scheduled for.  Many people, being generous with their time, have signed up for multiple shifts.  What I would like is to PIVOT this data s.t. I end up with one row per <em>person</em>, with sets of columns for each shift.  I've spent about 90 minutes on this so far, but can't figure out how to PIVOT without an aggregation function applied.</p>\n\n<p>What I mean by this is that each person is scheduled for at least one shift, so each person's row would have their unique ID, their name, their phone number, and their region.  Then there would be a set of columns for Shift1 - role/status/start time/end time/etc. - which everyone would have filled out since everyone has signed up for at least one shift.  Then, the Shift2 set of columns would be populated for people who have signed up for 2+ shifts, Shift3 for people who signed up for 3+ shifts, etc.</p>\n\n<p>My current table schema:</p>\n\n<pre><code>CREATE TABLE [dbo].[confirmexport](\n    [PersonID] [int] NULL,\n    [EventType] [varchar](14) NULL,\n    [Shift] [varchar](10) NULL,\n    [StartDate] [datetime] NULL,\n    [StartTime] [datetime] NULL,\n    [EndDate] [datetime] NULL,\n    [EndTime] [datetime] NULL,\n    [Location] [varchar](39) NULL,\n    [Role] [varchar](16) NULL,\n    [Status] [varchar](9) NULL,\n    [FirstName] [varchar](20) NULL,\n    [LastName] [varchar](22) NULL,\n    [Phone] [bigint] NULL,\n    [Region] [varchar](9) NULL\n) ON [PRIMARY]\n</code></pre>\n\n<p>All columns but <code>PersonID</code>, <code>FirstName</code>, <code>LastName</code>, <code>Phone</code>, and <code>Region</code> are shift-specific.</p>\n\n<p>In an ideal world, I'd end up with a table that looked something like so:</p>\n\n<pre><code>CREATE TABLE [dbo].[confirmexportpivoted](\n    [PersonID] [int] NULL,\n    [Phone] [bigint] NULL,\n    [FirstName] [varchar](20) NULL,\n    [LastName] [varchar](22) NULL,\n    [Region] [varchar](9) NULL,\n    [EventType1] [varchar](14) NULL,\n    [Shift1] [varchar](10) NULL,\n    [StartDate1] [datetime] NULL,\n    [StartTime1] [datetime] NULL,\n    [EndDate1] [datetime] NULL,\n    [EndTime1] [datetime] NULL,\n    [Location1] [varchar](39) NULL,\n    [Role1] [varchar](16) NULL,\n    [Status1] [varchar](9) NULL,\n    [EventType2] [varchar](14) NULL,\n    [Shift2] [varchar](10) NULL,\n    [StartDate2] [datetime] NULL,\n    [StartTime2] [datetime] NULL,\n    [EndDate2] [datetime] NULL,\n    [EndTime2] [datetime] NULL,\n    [Location2] [varchar](39) NULL,\n    [Role2] [varchar](16) NULL,\n    [Status2] [varchar](9) NULL\n) ON [PRIMARY]\n</code></pre>\n\n<p>Except with as many sets of columns as necessary for my data.  OR - if that's a deal-breaker, I can definitely make do with 3.  Any suggestions?</p>\n\n<p>Thanks in advance - I am super-confused and would appreciate any and all help.</p>\n"},{"tags":["sql","oracle","date-arithmetic"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":841,"score":2,"question_id":9568787,"title":"SQL: Get records created in time range for specific dates","body":"<p>I have a set of records that were created last week, and from those I want to retrieve only those that were created between 6h45 and 19h15. I have a column <code>creation_date</code> that I can use.</p>\n\n<p>How can I do this in sql?</p>\n"},{"tags":["php","mysql","sql","collate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13213103,"title":"MySQL Union illegal mix of collations","body":"<p>I have the following in my PHP query:</p>\n\n<pre><code>SELECT tags.tag, theValues.* \nFROM ch09.tbl_tags tags \nRIGHT JOIN ((SELECT 'dog' as 'Vals')\nUNION (SELECT 'cat' as 'Vals')) theValues on tags.tag = theValues.Vals\n</code></pre>\n\n<p>After the \"RIGHT JOIN\" everything within the brackets are created on the fly from user input.</p>\n\n<p>It worked fine in MySQL 4, but I just had a new computer and installed 5.5, imported the SQL dump as <code>UTF-8</code>. But I get: </p>\n\n<blockquote>\n  <p>\"Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation '='\"</p>\n</blockquote>\n\n<p>There's probably a better way to construct my query, all I need is everything the user inputs in one column as \"<code>Vals</code>\" and if there's a matching tag in <code>tbl_tags.tag</code> then it should be there in a column called \"tag\" else the tag column is blank.</p>\n\n<p>I have tried using Collate: <a href=\"http://www.answermysearches.com/mysql-fixing-illegal-mix-of-collations-message/352/\" rel=\"nofollow\">http://www.answermysearches.com/mysql-fixing-illegal-mix-of-collations-message/352/</a>, but I simply cannot get it to work.</p>\n\n<p>So I need to either construct a better query or use the collate function somehow, but how?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Craig</p>\n"},{"tags":["java","mysql","sql","database","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13166471,"title":"MySQL syntax error using Java in Eclipse","body":"<p>I have the following prepared statement for sql  in Java :</p>\n\n<p>com.mysql.jdbc.JDBC4PreparedStatement@6e56103e:</p>\n\n<pre><code>INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)VALUES(2502591,'2000-03-02 02:02:02','5x5 aptb wdw','00:55:48','DotA v6.75b.w3x','aptb ')ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameStart),`Name`=VALUES(Name),`Lenght`=VALUES(Lenght),`MapVersion`=VALUES(MapVersion),`Mode`=VALUES(Mode).\n</code></pre>\n\n<p>When I execute it in Eclipse I get the following error:</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?,?,?,?,?,?)ON DUPLICATE KEY UPDATE `Id`=VALUES(Id),`GameStart` = VALUES(GameSta' at line 1.\n</code></pre>\n\n<p>But at the same time when I execute the same query in SQLyog I don't get an error. Rows are updated. What can be a problem? Thanks in advance</p>\n\n<p>Code:</p>\n\n<pre><code>  Class.forName(\"com.mysql.jdbc.Driver\");\n    Connection con = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/dota\",\"root\",\"root\");\n    PreparedStatement updateGame = null;\n    String updatingGame = \"INSERT INTO `game` (Id , GameStart ,Name, Lenght, MapVersion, Mode)\" +\n                \"VALUES(?,?,?,?,?,?)\" +\n                \"ON DUPLICATE KEY UPDATE \" +\n                \"`Id`=VALUES(Id),\"+\n                \"`GameStart` = VALUES(GameStart),\" +\n                \"`Name`=VALUES(Name),\" +\n                \"`Lenght`=VALUES(Lenght),\" +\n                \"`MapVersion`=VALUES(MapVersion),\" +\n                \"`Mode`=VALUES(Mode)\";\n    con.setAutoCommit(false);\n    updateGame=con.prepareStatement(updatingGame);\n                updateGame.setInt(1, game.Id);\n                Timestamp timestamp = new Timestamp(100,2,2,2,2,2,2);\n                updateGame.setTimestamp(2,timestamp);\n                updateGame.setString(3, game.GameName);\n                updateGame.setTime(4, (Time) game.Time);\n                updateGame.setString(5, game.MapVersion);\n                updateGame.setString(6, game.Mode);\n                updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>And on:</p>\n\n<pre><code>updateGame.executeUpdate(updatingGame);\n</code></pre>\n\n<p>I get an error</p>\n"},{"tags":["mysql","sql","syntax","limit"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13213025,"title":"SQL Syntax, What am I doing wrong?","body":"<p>I have the following syntax, and all runs fine except for \"LIMIT\". All the results of the database display when only 9 results should. I have the \"0, 9\" coming from variables so they will change on each paginated link (ex. 0, 9; 10, 18; 19, 27; etc.). I checked and rechecked my syntax and I don't understand why all the results would show. Below is the exact query I'm testing.</p>\n\n<p>Also to note, I'm using XAMPP</p>\n\n<pre><code>FROM acb_accfitems WHERE itemtype = 'furniture' ORDER BY price DESC LIMIT 0, 9\n</code></pre>\n"},{"tags":["sql","python-3.x","kml","google-earth","pyodbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":10371935,"title":"Python generates KML but not displayed in google earth network link properly","body":"<p>If the cursor has many rows, the generated kml is not shown in google earth, but the code generated can be seen through python shell.. If there are fewer rows ( 7 or 8 ) then this script easily generates a network link for kml file in google earth.. Thanks for your kind help</p>\n\n<pre><code>import pyodbc\nkml = ('&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\\n'\n'&lt;kml xmlns=\"http://www.opengis.net/kml/2.2\"xmlns:gx=\"http://www.google.com/kml/ext/2.2\" xmlns:kml=\"http://www.opengis.net/kml/2.2\" xmlns:atom=\"http://www.w3.org/2005/Atom\"&gt;\\n'\n'&lt;Document&gt;\\n'\n'&lt;name&gt;documentname&lt;/name&gt;\\n'\n'&lt;StyleMap id=\"default\"&gt;\\n'\n'&lt;Pair&gt;\\n'\n'&lt;key&gt;normal&lt;/key&gt;\\n'\n'&lt;styleUrl&gt;#default0&lt;/styleUrl&gt;\\n'\n'&lt;/Pair&gt;\\n'\n'&lt;Pair&gt;\\n'\n'&lt;key&gt;highlight&lt;/key&gt;\\n'\n'&lt;styleUrl&gt;#hl&lt;/styleUrl&gt;\\n'\n'&lt;/Pair&gt;\\n'\n'&lt;/StyleMap&gt;\\n'\n'&lt;Style id=\"hl\"&gt;\\n'\n'&lt;IconStyle&gt;\\n'\n'&lt;scale&gt;1.2&lt;/scale&gt;\\n'\n'&lt;/IconStyle&gt;\\n'\n'&lt;/Style&gt;\\n'\n'&lt;Style id=\"default0\"&gt;\\n'\n'&lt;/Style&gt;\\n'\n'&lt;Folder&gt;\\n'\n'&lt;name&gt;foldername&lt;/name&gt;')\n\n print ('Content-Type: application/vnd.google-earth.kml+xml\\n')\n print (kml)        \n\n\ndef placemarkize(rowdata):\n placemark = (\n '&lt;Placemark&gt;\\n'\n '&lt;name&gt;%s&lt;/name&gt;\\n'\n '&lt;Point&gt;\\n'\n '&lt;coordinates&gt;%f,%f&lt;/coordinates&gt;\\n'\n '&lt;/Point&gt;\\n'\n '&lt;/Placemark&gt;'\n ) %(rowdata[1],rowdata[11],rowdata[10])\n print(placemark)\n return ()\n\n\nconn = pyodbc.connect('Driver={SQL Server};server=research;database=database;uid=;pwd=')\ncur=conn.cursor()\ncur.execute(\"select * from tbltvet where district like 'kas%'\")\nwhile 1:\nrow = cur.fetchone()\nif not row:\n    break\nplacemarkize(row)\n\n\nkml = ('&lt;/Folder&gt;\\n&lt;/Document&gt;\\n&lt;/kml&gt;')\n\nprint (kml)\nconn.close()\n</code></pre>\n"},{"tags":["sql","oracle","oracle11g"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":54,"score":-1,"question_id":13209775,"title":"Creating table in Oracle","body":"<p>My requirement is that the column <code>accno</code> has no null value and no duplicates. The name column has no nulls and accepts only A to Z (no other like number or * $). The <code>acctype</code> columns is a character that allows only ( 'S'  , 'C' ,'R') and the <code>balance</code> column has no null values. If <code>acctype</code> is S then balance should be >= 5000, when C the balance should be > 10000 and when it's R >= 5000.</p>\n\n<p>I am trying to apply this with:</p>\n\n<pre><code>create table kcb_acc_tab\n (accno varchar2(20)\n    constraint kcb_acc_Pk\n      primary key, \n  name varchar2(20)\n    constraint kcb_name_NN\n      Not null\n    constraint kcb_name_CK \n      check((name =upper(name)) and (name like '[(A-Z)]')),\n  Acctype char\n    constraint kcb_acctype_ck\n      check (acctype in('S' ,'C' ,'R')) ,\n  Doo timestamp\n    default sysdate ,\n  bal number(7,2) kcb_bal_NN\n    constraint kcb_bal_ck\n      check((aacctype ='S' and bal &gt;=5000) or\n            (acctype = 'C' and bal &gt;=10000) or\n            (acctype ='R' and bal &gt;=5000));\n</code></pre>\n"},{"tags":["php","mysql","sql","sqlite","pdo"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":410,"score":1,"question_id":9244053,"title":"SQLite syntax not compatible with MySQL?","body":"<p>I'm using PDO and trying to make my application support both MySQL and SQLite, but in sqlite I get this error when I try to import my database schema:</p>\n\n<p><code>SQLSTATE[HY000]: General error: 1 near \"AUTO_INCREMENT\": syntax error</code></p>\n\n<p>The query looks like this:</p>\n\n<pre><code>CREATE TABLE events (\n\n  id INT UNSIGNED NOT NULL AUTO_INCREMENT,\n  name VARCHAR(32) NOT NULL,\n  title VARCHAR(64) NOT NULL,\n  description LONGTEXT,\n  starttime DATETIME DEFAULT '0000-00-00 00:00:00',\n\n  PRIMARY KEY(id),\n  KEY name(name)\n\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;\n</code></pre>\n\n<p>(and it works in a MySQL database.)</p>\n\n<p>I don't understand what the problem is here? Shouldn't both database systems be compatible?</p>\n"},{"tags":["sql","sql-server","sql-server-2005","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":311,"score":3,"question_id":3872173,"title":"Compare when value could be both NULL or text","body":"<p>Now I know you can't directly compare NULL to anything (as null is unknown) so how would I achieve the following:</p>\n\n<pre><code>select  *\n    from    Material as m\n    where   MtrlCode = 826 and\n            Exposlimit &lt;&gt; 'compareMe'\n</code></pre>\n\n<p>Where Exposlimit MAY be NULL or it may not be.\n'compareMe' may also be NULL.</p>\n\n<p>Therefore how do I compare the two?  Both sides could be either text or NULL.</p>\n"},{"tags":["android","sql","sqlite","bit-manipulation","where"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13211365,"title":"Android/SQLite - Bit operation on WHERE clause","body":"<p>I'd like to know if it's possible to do in Android something like this:</p>\n\n<pre><code>public Cursor getFlowsByCategory(int type, int categoryID, int limit) {\n\n    SQLiteDatabase db = dbHelper.getReadableDatabase();\n\n    final String[] columns = {ID, FLAGS, SUBJECT, AMOUNT, AMOUNT_NO, CATEGORY};\n    final String selection = \"((\" + FLAGS + \" &amp; ?) &gt;&gt; 1 = ?) AND (\" + CATEGORY + \" = ?)\";\n    final String[] selectionArgs = {Integer.toString(Flow.FLOW_TYPE), Integer.toString(type), Integer.toString(categoryID)};\n\n    return db.query(TABLE, columns, selection, selectionArgs, null, null, ID + \" DESC\", Integer.toString(limit));\n\n}\n</code></pre>\n\n<p>FLAGS is a 1-byte bit mask and I'd like to select only the rows which has the second bit (position 1) of the mask on. The mask (Flow.FLOW_TYPE) is 0b00000010 and the type parameter can be either 0 or 1. It should work but it doesn't: what am I doing wrong?</p>\n"},{"tags":["sql","sql-server-2008","database-design","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13211739,"title":"Bug Tracking How to design Project Access in Sql Database schema","body":"<p>I am working on a small open-source project on Bug Tracking.</p>\n\n<p>I am a little confused on something which I need help with.</p>\n\n<p>I have two tables, one is Users and other is Projects.</p>\n\n<p><strong>Users</strong></p>\n\n<ul>\n<li>UserId</li>\n<li>Username</li>\n</ul>\n\n<p><strong>Project</strong></p>\n\n<ul>\n<li>ProjectId</li>\n<li>ProjectName</li>\n<li>ProjectDescription</li>\n</ul>\n\n<p>I have more fields, but I have abstracted them now, to make this question small.</p>\n\n<p><strong>I wanted to know how to create a relationship between Projects and Users ?</strong></p>\n\n<p>Should I have one more table that stores User-Project relationships something like</p>\n\n<p><strong>ProjectAccess</strong></p>\n\n<ul>\n<li>Id</li>\n<li>ProjectId</li>\n<li>UserId</li>\n<li>AccessType (Admin/User)</li>\n</ul>\n\n<p>I am a little new to Database schema designing, so I am not very sure. So I'm here to have a second opinion on this.</p>\n\n<p>Also I would like to know how to provide the option for an admin to add a user and how to handle this at back end.</p>\n\n<p>Any thought, comment or answers will be highly appreciated. Thanks.</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13210493,"title":"appending row number in sql select statement with row value","body":"<p>I am trying to concatenate the select statment results in one row.<br>\nFor eg :\nFor this select statement output :  </p>\n\n<pre><code>Name  \nABC  \nDEF  \nGHI\n</code></pre>\n\n<p>I needed following Output :<br>\nName  </p>\n\n<pre><code>1 ABC, 2 DEF, 3 GHI  \n</code></pre>\n\n<p>(Means row number should be appended in front for each row)<br>\nI am using wm_concat() function but it is giving me the following o/p : <code>ABC,DEF,GHI</code><br>\nCan anyone help ?</p>\n"},{"tags":["python","sql","database","in-memory-database"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":932,"score":7,"question_id":3047412,"title":"in-memory database in Python","body":"<p>I'm doing some queries in Python on a large database to get some stats out of the database. I want these stats to be in-memory so other programs can use them without going to a database. </p>\n\n<p>I was thinking of how to structure them, and after trying to set up some complicated nested dictionaries, I realized that a good representation would be an SQL table. I don't want to store the data back into the persistent database, though. Are there any in-memory implementations of an SQL database that supports querying the data with SQL syntax?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13211268,"title":"returning total records in cte","body":"<p>With help from <a href=\"http://pratchev.blogspot.com/2008/11/paging-with-ranking-functions.html?m=1\" rel=\"nofollow\">article here</a> and recent answers from SO experts I have arrived with the following which will help me efficiently page through a set of records.</p>\n\n<p>I think my last couple of questions are </p>\n\n<ol>\n<li>See how I include the <code>Total Number of Records</code> in the payload at the end\nof SQL CTE called 'Total'. Is that how you would do this? </li>\n<li>Any other suggestions? Potential areas for being more concise or improvements? <code>Return Total Number of Pages</code></li>\n</ol>\n\n<hr>\n\n<pre><code>DECLARE @page_size INT = 5;\nDECLARE @page_nbr INT = 4;\nDECLARE @search NVARCHAR(MAX) = '';\nDECLARE @sort_order INT = 2;\n\nWITH AllProducts\nAS\n(\nSELECT *, \nCASE @sort_order\n    WHEN 1 THEN ROW_NUMBER() OVER ( ORDER BY ProductID )\n    WHEN 2 THEN ROW_NUMBER() OVER ( ORDER BY ProductName )\nEND AS 'Seq'    \nFROM Products\n),\nFiltered\nAS\n(\nSELECT * FROM AllProducts\nWHERE ProductName like '%'+@search+'%'\nOR\n@search is null\n)\nSELECT (select COUNT(*) from Filtered) as 'Total', * FROM Filtered\nWHERE seq &gt; (@page_nbr - 1) * @page_size\n  AND seq &lt;= @page_nbr * @page_size\n</code></pre>\n"},{"tags":["python","sql","ms-access","firebird","pyodbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":58,"score":-2,"question_id":13210956,"title":"ProgrammingError: '42S02', '[42S02] [Microsoft]","body":"<p>I wrote the following code</p>\n\n<pre><code>import pyodbc\n#import kinterbasdb\nimport firebirdsql\nimport os\nimport json,sqlite3,sql\ncon = sqlite3.connect('borey.db')\nsampling_tables=con.cursor()\nsampling_fields=con.cursor()\nsampling_constraints=con.cursor()\nsampling_constraints_fields=con.cursor()\nsampling_indices=con.cursor()\nsampling_indices_fields=con.cursor()\nsampling_indices_props=con.cursor()\nsampling_fields_from_constraints=con.cursor()\njs=[]\n\nsampling_tables.execute(sql.sqltables)\n\nfor table in sampling_tables:\n    tabledict=dict(inform_about_table='?', fields='?', constraints='?', indices='?')\n    information_about_table_dict=dict(name=table[1], description=table[2], can_add=table[3], can_edit=table[4], can_delete=table[5])\n    #print(js_information_about_table)\n    tabledict['inform_about_table']=information_about_table_dict\n    #print(tabledict)\n    table_id=table[0]\n    sampling_fields.execute(sql.sqlfields,(table_id,))\n    listfields=[]\n    for field in sampling_fields:\n        fielddict=dict(position=field[0], name=field[1], description=field[2], datatype=field[3], char_length=field[4], can_input=field[5], can_edit=field[6], show_in_grid=field[7],\n                      is_mean=field[8], autocalculated=field[9], required=field[10])\n        listfields.append(fielddict)\n    tabledict['fields']=listfields\n    #print(tabledict)\n    sampling_constraints.execute(sql.sqlconstraints,(table_id,))\n    listconstraints=[]\n    for constraint in sampling_constraints:\n        constraintdict=dict(name=constraint[1], constrtype=constraint[2], items='?', reference=constraint[3])\n        sampling_constraints_fields.execute(sql.sql_constr_det,(constraint[0],table_id))\n        listitems=[]\n        for constr_det in sampling_constraints_fields:\n            listitems.append(constr_det[0])\n        constraintdict['items']=listitems\n        listconstraints.append(constraintdict)\n    tabledict['constraints']=listconstraints\n    #print(tabledict)\n    sampling_indices.execute(sql.sqlindices,(table_id,))\n    listindices=[]\n    for index in sampling_indices:\n        indexdict=dict(name=index[1], items='?', position='?', props='?')\n        index_id=index[0]\n        sampling_indices_fields.execute(sql.sql_indices_fields,(table_id,index_id))\n        #sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id, ))\n        listfields=[]\n        listpositions=[]\n        listprops=[]\n        for index_det in sampling_indices_fields:\n            listfields.append(index_det[0])\n            listpositions.append(index_det[1])\n            fieldinindex=index_det[0]\n        sampling_indices_props.execute(sql.sql_indices_descend,(table_id,index_id,fieldinindex))            \n        for index_desc in sampling_indices_props:\n            listprops.append(index_desc[0])\n        indexdict['items']=listfields\n        indexdict['position']=listpositions\n        indexdict['props']=listprops\n        listindices.append(indexdict)\n    tabledict['indices']=listindices\n    #print(tabledict)\n    js.append(tabledict)\nos.remove('D:/boreas.fdb')\nconn=firebirdsql.create_database(host='localhost', database='D:/boreas.fdb', user='sysdba', password='masterkey')\n#conn=firebirdsql.connect(host='localhost',database='D:/ThirdTask/test.fdb', user='sysdba', password='masterkey')\ncur=conn.cursor()\nfor nametable in js:\n    s=''\n    s+='create table '+nametable['inform_about_table']['name']+'\\n'\n    s+='('+'\\n'\n    countfield=0\n    for namefield in nametable['fields']:\n        s+='   '\n        if namefield['name']=='COUNT':\n            s+='QUANTITY'\n        else:\n            if namefield['name']=='MINIMUM QUANTITY FOR ORDER REPETITION':\n                s+='MINIMUM_QUANTITY'\n            else:\n                if namefield['name']=='PRICE ACCORDING TO THE PRICE-LIST':\n                    s+='LIST_PRICE'\n                else:\n                    if (namefield['name'].count(' ')!=0) or (namefield['name'].count('-')!=0) or (namefield['name'].count('/')!=0):\n                        s+='\"'+namefield['name']+'\"'\n                    else:                    \n                        s+=namefield['name']\n        if namefield['datatype']=='FMTBCD':\n            s+='   '+' INTEGER NOT NULL'\n        else:\n            if namefield['datatype']=='STRING': \n                s+='   '+'VARCHAR'\n            else:\n                if namefield['datatype']=='MEMO':\n                    s+='   '+'BLOB SUB_TYPE 1'\n                else:            \n                    if namefield['datatype']=='LARGEINT':\n                        s+='   '+'INTEGER'\n                    else:\n                        if namefield['datatype']=='SMALLINT':\n                            s+='   '+'INTEGER'\n                        else:\n                            if namefield['datatype']=='CURRENCY':\n                                s+='   '+'NUMERIC(18,2)'\n                            else:\n                                if namefield['datatype']=='BOOLEAN':\n                                    s+='   '+'INTEGER'\n                                else:    \n                                    s+='   '+namefield['datatype']           \n        if namefield['datatype']=='STRING':\n            s+='('+str(namefield['char_length'])+')'\n        countfield+=1\n        #if countfield!=len(nametable['fields']):\n        s+=','+'\\n'\n        #else:\n            #s+='\\n'\n            #s+='\\n'\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='PRIMARY':\n            s+='   CONSTRAINT '+nameconstraint['name']+ ' PRIMARY KEY('\n            countfieldinconstr=0\n            for namefield in nameconstraint['items']:\n                countfieldinconstr+=1\n                if countfieldinconstr!=len(nameconstraint['items']):\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+','\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+','\n                            else:    \n                                s+=namefield+','\n                else:\n                        if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                            s+='\"'+namefield+'\"'+')'+'\\n'\n                        else:\n                            if namefield=='COUNT':\n                                s+='QUANTITY'+')'+'\\n'\n                            else:       \n                                s+=namefield+')'+'\\n'\n    s+=');'+'\\n'\n    print s\n    cur.execute(s)\n    #conn.commit()\n    #conn.begin()\n    for nameindex in nametable['indices']:\n        #print 'nameidex[props] ', nameindex['props']\n        s=''\n        for prop in nameindex['props']:\n            if prop==0:\n                if (nameindex['name'].count(' ')!=0) or (nameindex['name'].count('-')!=0) or (nameindex['name'].count('/')!=0):\n                    s+='create ascending index \"'+nameindex['name'] + '\" on '+nametable['inform_about_table']['name']+' ('\n                else:\n                    if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_INVENTORY_ID':\n                        s+='create ascending index ' + 'IDX_INVENTORY_ID' + ' on '+nametable['inform_about_table']['name']+' ('\n                    else:\n                        if nameindex['name']=='IDX_INFORMATION_ABOUT_ORDER_ORDERDETAILS':\n                            s+='create ascending index ' + 'IDX_ORDERDETAILS' + ' on '+nametable['inform_about_table']['name']+' ('\n                        else:    \n                            if nameindex['name'].count('INFORMATION_ABOUT_ORDER_')!=0:\n                                s+='create ascending index ' + nameindex['name'][1:4]+nameindex['name'][-len(nameindex['name'])+28:] + ' on '+nametable['inform_about_table']['name']+' ('\n                            else:\n                                s+='create ascending index '+nameindex['name'] + ' on '+nametable['inform_about_table']['name']+' ('\n            countitem=0\n            for nameitem in nameindex['items']:\n                if countitem!=len(nameindex['items'])-1:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+', '\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+', '\n                            else:  \n                                s+=nameitem+', '\n                else:\n                        if (nameitem.count(' ')!=0) or (nameitem.count('-')!=0) or (nameitem.count('/')!=0):\n                            s+='\"'+nameitem+'\"'+');'+'\\n'\n                        else:\n                            if nameitem=='COUNT':\n                                s+='QUANTITY'+');'+'\\n'\n                            else:  \n                                s+=nameitem+');'+'\\n'\n                countitem+=1\n        print s\n        cur.execute(s)\n        #conn.commit()\nfor nametable in js:\n    for nameconstraint in nametable['constraints']:\n        if nameconstraint['constrtype']=='FOREIGN':\n            s=''\n            s+='ALTER TABLE '+nametable['inform_about_table']['name']+'\\n'\n            s+='  '+'ADD CONSTRAINT '+nameconstraint['name']+' FOREIGN KEY ('  \n            for namefield in nameconstraint['items']:\n                if (namefield.count(' ')!=0) or (namefield.count('-')!=0) or (namefield.count('/')!=0):\n                    s+='\"'+namefield+'\")'+'\\n'\n                else:\n                    s+=namefield+')'+'\\n'\n            s+='      '+'REFERENCES '+nameconstraint['reference']\n            sampling_fields_from_constraints.execute(sql.sql_fields, (nameconstraint['reference'],))\n            for fields in sampling_fields_from_constraints:\n                field=fields[0]\n                if (field.count(' ')!=0) or (field.count('-')!=0) or (field.count('/')!=0):\n                    s+=' (\"'+field+'\");'+'\\n'\n                else:\n                    s+=' ('+field+');'+'\\n'\n            print s\n            cur.execute(s)\n            #conn.commit()            \nconn.commit()\ns=\"\"\"\ncreate table CLIENTS\n(\n   ID   INTEGER NOT NULL,\n   COMPANY   VARCHAR(50),\n   \"LAST NAME\"   VARCHAR(50),\n   \"FIRST NAME\"   VARCHAR(50),\n   \"E-MAIL ADDRESS\"   VARCHAR(50),\n   \"JOB TITLE\"   VARCHAR(50),\n   \"BUSINESS PHONE\"    VARCHAR(25),\n   \"HOME PHONE\"   VARCHAR(25),\n   \"MOBILE PHONE\"   VARCHAR(25),\n   \"FAX NUMBER\"   VARCHAR(25),\n   ADDRESS   BLOB SUB_TYPE 1,\n   CITY   VARCHAR(50),\n   \"STATE/PROVINCE\"   VARCHAR(50),\n   \"ZIP/POSTAL CODE\"   VARCHAR(15),\n   \"COUNTRY/REGION\"   VARCHAR(50),\n   \"WEB-SITE\"   VARCHAR(25),\n   NOTES   BLOB SUB_TYPE 1,\n   INCLUDING   BLOB\n);\n\"\"\"\ns1='create ascending index IDX_CLIENTS_CITY on CLIENTS (CITY);'\n\"\"\"db = 'D:/ThirdTask/Northwind.accdb' \nconnaccess = win32com.client.Dispatch(r'ADODB.Connection')\nDSN = ('PROVIDER = Microsoft.Jet.OLEDB.4.0;DATA SOURCE = ' + db +  ';') \nconnaccess.Open(DSN) \nrs = win32com.client.Dispatch(r'ADODB.Recordset') \nstrsql = \"select * from deer\" \nrs.Open(strsql, conn, 1, 3) \nt = rs.GetRows() \nconnaccess.Close() \n\"\"\"\nconAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nSqlAccess.execute(sql.sql_count_records_clients);\nCountOfRecords=SqlAccess.fetchone();\n#print s\n#cur.execute(s)\n#conn.commit()\n#cur.execute(s1)\n#conn.commit()\n#cur=con.cursor()\ncon.close()\nconn.close()\nconAcc.close();\n#print \"Connect succesfully\"\n</code></pre>\n\n<p>As a result, when you run, I get the following error</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 250, in &lt;module&gt;\n    SqlAccess.execute(sql.sql_count_records_clients);\nProgrammingError: ('42S02', '[42S02] [Microsoft][\\xc4\\xf0\\xe0\\xe9\\xe2\\xe5\\xf0 ODBC Microsoft Access] \\xdf\\xe4\\xf0\\xee \\xe1\\xe0\\xe7\\xfb \\xe4\\xe0\\xed\\xed\\xfb\\xf5 Microsoft Office Access \\xed\\xe5 \\xec\\xee\\xe6\\xe5\\xf2 \\xed\\xe0\\xe9\\xf2\\xe8 \\xe2\\xf5\\xee\\xe4\\xed\\xf3\\xfe \\xf2\\xe0\\xe1\\xeb\\xe8\\xf6\\xf3 \\xe8\\xeb\\xe8 \\xe7\\xe0\\xef\\xf0\\xee\\xf1 \"\\xd1\\xef\\xe8\\xf1\\xee\\xea \\xea\\xeb\\xe8\\xe5\\xed\\xf2\\xee\\xe2\".  \\xcf\\xf0\\xee\\xe2\\xe5\\xf0\\xfc\\xf2\\xe5 \\xf1\\xf3\\xf9\\xe5\\xf1\\xf2\\xe2\\xee\\xe2\\xe0\\xed\\xe8\\xe5 \\xf2\\xe0\\xe1\\xeb\\xe8\\xf6\\xfb \\xe8\\xeb\\xe8 \\xe7\\xe0\\xef\\xf0\\xee\\xf1\\xe0 \\xe8 \\xef\\xf0\\xe0\\xe2\\xe8\\xeb\\xfc\\xed\\xee\\xf1\\xf2\\xfc \\xe8\\xec\\xe5\\xed\\xe8. (-1305) (SQLExeсDirectW)')\n</code></pre>\n\n<p>(in Russian language)\nThe module sql.py has the contents</p>\n\n<pre><code># -*- coding: cp1251 -*-\nsqltables='''SELECT id, name, description, can_add, can_edit, can_delete FROM tables'''\nsqlfields = '''SELECT fields.position,fields.name,fields.description,\ndata_types.type_id,domains.char_length,\nfields.can_input,fields.can_edit,\nfields.show_in_grid,fields.is_mean, fields.autocalculated,\nfields.required\nFROM fields\nJOIN domains ON fields.domain_id = domains.id\nJOIN data_types ON domains.data_type_id = data_types.id\nWHERE fields.table_id = ?\nORDER BY fields.position\n'''\nsqlconstraints='''SELECT constraints.id,\nconstraints.name, constraint_type, constraints.reference,\ntables.name\nFROM constraints\nLEFT JOIN tables ON constraints.table_id = tables.id\nWHERE table_id = ? '''\nsql_constr_det = '''SELECT fields.name, tables.name\nFROM constraint_details\nJOIN fields ON constraint_details.field_id = fields.id\nJOIN tables ON tables.id=fields.table_id\nWHERE constraint_id = ?\nAND tables.id= ? '''\nsqlindices = '''SELECT indices.id,indices.name\nFROM indices\nWHERE indices.table_id = ? '''\nsql_indices_fields = '''SELECT fields.name,\nindex_details.position\nFROM indices\nJOIN index_details ON index_id = indices.id\nJOIN fields ON field_id = fields.id\nWHERE indices.table_id = ?\nAND indices.id=?'''\nsql_indices_descend='''SELECT index_details.descend\nFROM index_details\nJOIN indices ON index_details.index_id = indices.id\nJOIN fields ON field_id = fields.id \nWHERE indices.table_id = ?\nAND indices.id = ?\nAND fields.name = ?'''\nsql_fields='''SELECT fields.name\nFROM fields\nJOIN tables ON tables.id=fields.table_id\nJOIN constraints ON (constraints.table_id=tables.id and constraints.constraint_type='PRIMARY')\nJOIn constraint_details ON (constraint_details.constraint_id=constraints.id and constraint_details.field_id=fields.id)\nWHERE tables.name= ?'''\nsql_count_records_clients='''SELECT COUNT(*) FROM \"Список клиентов\"'''\n</code></pre>\n\n<p>For this error and how to fix it? I would also like to know how to translate the text of the error on the normal encoding?</p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3813,"score":3,"question_id":3702576,"title":"SQL if no rows are returned do this","body":"<p>I have a select statement and I want to say if this select statement does not return any rows then put a '' in every cell. How do I do this?</p>\n"},{"tags":["php","sql","tags"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13211841,"title":"SQL Auto Increment ID","body":"<p>I have an SQL table with an auto-increment field. I know people have asked how to retrieve the ID of the 'last entry' after the insert has taken place, and I know how to do that. What I want to do is duplicate the auto-generated field in to a second column of the same table - how do I modify my insert code to do this:</p>\n\n<pre><code>mysql_query(\"INSERT INTO `tags` (`tid`,`tagid`,`tagname`) VALUES('','INSERTED.ID','{$tagname}')\");\n</code></pre>\n\n<p>The reason I want to do this is because I want to be able to make two rows equal each other. I.E. if two different tags (with different unique ids) have the same tagid, then I can use the 'tagid' reference elsewhere as a unique identifier and cycle through them. I can also retain knowledge of which tag is the parent tag - because it will have the same 'tid' as 'tagid'.</p>\n\n<p>I have a system for tagging events; but sometimes I miss-spell a tag... so rather than correcting all the mistakes, I want to make my system error proof by allowing miss-spelt tags to be joined up and treated the same way as a the correct tag. </p>\n\n<p>Would appreciate your help - even if that means doing this a completely different way.</p>\n\n<p>Thanks,</p>\n"},{"tags":["sql","oracle","oracle11g","top-n"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13209962,"title":"inner join on table with multiple record","body":"<p>I have two tables as follows</p>\n\n<h3>table1</h3>\n\n<pre><code>column1|column2\n----------------\na1     | c1\n----------------\na2     | c2\n</code></pre>\n\n<h3>table2</h3>\n\n<pre><code>column1|column2|column3\n----------------------\n1      | a1    | x\n-----------------------\n2      | a1    | y\n-----------------------\n3      | a1    | z\n-----------------------\n4      | a2    | ab\n-----------------------\n5      | a2    | cd\n-----------------------\n6      | a2    | ef\n</code></pre>\n\n<p>Table1 is the parent table and table2 is the child table.</p>\n\n<p>Column1 of table1 is mapped to column2 of table2.</p>\n\n<p>Table2 can contain multiple records for each entry of column1 in table1 some thing like this.</p>\n\n<p>I want to join table1 to table2, but I want only the first record of all entries of table2.</p>\n\n<p>So my result set will be </p>\n\n<pre><code>column1|column2|column3\n----------------------\n1      | a1    | x\n-----------------------\n2      | a2    | ab\n</code></pre>\n\n<p>How to make a join to achieve this in oracle 11 g. I use sql navigator +</p>\n"},{"tags":["sql","list"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":26,"score":-2,"question_id":13211459,"title":"Listing two tables","body":"<p>Here is the question I was asked:</p>\n\n<p>List the various vision powers of the heroes in alphabetical order. Each vision power should appear only once</p>\n\n<p>ID  codename    description</p>\n\n<p>I am trying to obtain the following description with the word \"Vision\" and \"vision\" I have tried to use wildcards but nothing seems to be working, in the discription it offers different types of Vision powers such as X-Ray vision</p>\n"},{"tags":["python","sql","ms-access","encoding","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13210697,"title":"SyntaxError: Non-ASCII character '\\xd1'","body":"<p>I wrote the following code</p>\n\n<pre><code>conAcc = pyodbc.connect('DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=D:\\ThirdTask\\Northwind.accdb')\nSqlAccess=conAcc.cursor();\nSqlAccess.execute(sql.sql_count_record_clients);\nCountOfRecords=SqlAccess.fetchone();\nconAcc.close();\n</code></pre>\n\n<p>where there is a line in module sql.py</p>\n\n<pre><code>sql_count_records_clients='''SELECT COUNT(*) FROM \"Список клиентов\"'''\n</code></pre>\n\n<p>As a result this line in sql.py gives out an error</p>\n\n<pre><code>Traceback (most recent call last):\n  File \"D:\\ThirdTask\\connect.py\", line 5, in &lt;module&gt;\n    import json,sqlite3,sql\n  File \"D:\\ThirdTask\\sql.py\", line 48\nSyntaxError: Non-ASCII character '\\xd1' in file D:\\ThirdTask\\sql.py on line 48, but no encoding declared; see http://www.python.org/peps/pep-0263.html for details\n</code></pre>\n\n<p>What should be done to make the error disappear?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3794,"score":3,"question_id":1344401,"title":"How can I drop all indexes in a SQL database with one command?","body":"<p>So, how can I drop all indexes in a SQL database with one command?   I have this command that will get me all the 20 or so drop statements, but how can I run all of those drop statements from this \"result set\"?</p>\n\n<pre><code>select * from vw_drop_idnex;\n</code></pre>\n\n<p>Another variation that gives me the same list is:</p>\n\n<pre><code>SELECT  'DROP INDEX ' + ix.Name + ' ON ' + OBJECT_NAME(ID)  AS QUERYLIST\nFROM  sysindexes ix\nWHERE   ix.Name IS NOT null and ix.Name like '%pre_%'\n</code></pre>\n\n<p>I tried to do \"exec(select cmd from vw_drop_idnex)\" and it didn't work.  I am looking for something that works like a for loop and runs the queries one by one.</p>\n\n<h2>-----------------------</h2>\n\n<p>With Rob Farleys help, final draft of the script is:</p>\n\n<pre><code>declare @ltr nvarchar(1024);\nSELECT @ltr = ( select 'alter table '+o.name+' drop constraint '+i.name+';'\n  from sys.indexes i join sys.objects o on  i.object_id=o.object_id\n  where o.type&lt;&gt;'S' and is_primary_key=1\n  FOR xml path('') );\nexec sp_executesql @ltr;\n\ndeclare @qry nvarchar(1024);\nselect @qry = (select 'drop index '+o.name+'.'+i.name+';'\n  from sys.indexes i join sys.objects o on  i.object_id=o.object_id\n  where o.type&lt;&gt;'S' and is_primary_key&lt;&gt;1 and index_id&gt;0\nfor xml path(''));\nexec sp_executesql @qry\n</code></pre>\n"},{"tags":["sql","database","scala","jdbc"],"answer_count":15,"favorite_count":116,"up_vote_count":135,"down_vote_count":0,"view_count":32104,"score":135,"question_id":1362748,"title":"Wanted: Good examples of Scala database persistence","body":"<p>I would like to use Scala to persist data to a relational database, so what I am looking for are examples of CRUD operations using Scala.  </p>\n\n<p>I would like to code on a lower level of abstraction than an ORM like Hibernate/Toplink (read:JDBC), but between us, I would like to see examples of all types.</p>\n"},{"tags":["sql","mysql","join","query-optimization"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1924,"score":1,"question_id":3257575,"title":"Mysql query with Left Join is too very slow","body":"<p>Query:</p>\n\n<pre><code>   select `r`.`id` as `id` \n     from `tbl_rls` as `r` \nleft join `tblc_comment_manager` as `cm` on `cm`.`rlsc_id` != `r`.`id`\n</code></pre>\n\n<p>Both tables have 8k records but why is it very slow, taking 2-3 minutes and more sometimes?</p>\n\n<p>OMG , this query makes mysql server down. Will get back to you peoples in a second :(</p>\n\n<p>All peoples those suggested Indexing the columns are all Correct.\nYeh the query i wrote was silly and buggy. Thanks correcting me.</p>\n"},{"tags":["php","mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13211439,"title":"SQL copy data from one column to another table specified column","body":"<p>i have two tables name called by <strong><code>order</code></strong> and <strong><code>order_product</code></strong>, both tables have a column same name <code>model</code>, <code>order_product</code> <code>model</code> column have lots of data, but <code>order</code> <code>model</code> empty field. </p>\n\n<p>i want copy <code>model</code> data from table <code>order_product</code> to <code>model</code> table <code>order</code>, how can i do this.? </p>\n\n<p>i tried some SQL query, but the result not like really what i want, its look all field will be duplicate...</p>\n\n<pre><code>INSERT INTO `order` (model) SELECT (model) FROM `order_product`\n</code></pre>\n"},{"tags":["c#","sql","winforms","string"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13211379,"title":"C# SQL login - Adding information fail","body":"<p>Ok so I have a string issue. Im not sure if its simple and ive just been stareing at it for ages and come to nothing, or it's something I can't avoid? </p>\n\n<p>So I am trying to login to an SQL server using C#. Once the login box shows up I pass the username and password to a connection class and the login is Sucessful. </p>\n\n<pre><code>    public void login(object sender, EventArgs e)\n    {\n        sqlconnect sql = new sqlconnect();\n\n        sql.us = textBox1.Text;\n        sql.pas = textBox2.Text;\n            try\n            {\n                sql.GetSqlConnection();\n                sql.myConnection.Open();\n                label3.Text = \"Connected\";\n                this.Hide();\n                fronthyb.Show();\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n        }\n</code></pre>\n\n<p><strong>So below is my connection class:</strong></p>\n\n<pre><code>    public class sqlconnect\n{\n    public SqlConnection myConnection { get; set; }\n    public String us;\n    public String pas;\n    Settings1 set = new Settings1();\n\n\n    public SqlConnection GetSqlConnection()\n    {\n        if (myConnection == null)\n            myConnection = new SqlConnection(\"user id=\"+(us)+\"; password=\"+(pas)+\";server=\"+(set.SelectServer)+\";Trusted_Connection=\"+(set.SelectContype)+\";database=\"+(set.SelectDataBase)+\"; connection timeout=\"+(set.Condrop)+\"\");\n\n        return myConnection;\n    }\n\n\n}\n</code></pre>\n\n<p><strong>The issue now arrises when I attempt to add information to the database:</strong></p>\n\n<pre><code>     private void button1_Click(object sender, EventArgs e)\n    {\n\n            sql.GetSqlConnection();\n\n            SqlCommand cm = new SqlCommand(\"insert into dbo.Employee(FirstName, LastName, DoB, UserName, Email, Role, JobTitle, MemberOf) values (@FirstName, @LastName, @DoB, @UserName, @Email, @Role, @JobTitle, @MemberOf)\", sql.myConnection);\n            cm.Parameters.AddWithValue(\"@FirstName\", textBox2.Text);\n            cm.Parameters.AddWithValue(\"@LastName\", textBox3.Text);\n            cm.Parameters.AddWithValue(\"@DoB\", textBox5.Text);\n            sql.myConnection.Open();\n            cm.ExecuteNonQuery();\n            sql.myConnection.Close();\n            this.Close();\n</code></pre>\n\n<p>I havnt got any catches yet since its still in development but the program crashes and basically says the User is not allowed. I tested the strings in the connection classes and when i call them after I have logged in it returns nothing. So it seems like its being replaced with \"null\" at somepoint? Im not sure. Anyone see anything obvious? Sorry for the long question. Thank you. </p>\n"},{"tags":["sql","c","odbc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13208087,"title":"exactly what does the statement handle(hstmt) do? in ODBC","body":"<p>I`m new to write c code for ODBC \nbut here I have question...\nafter searching for the tutorial for odbc function tutorials for C, I still caanot get exactly\nhow they work collaborately...</p>\n\n<p>what does the statement handle hstmt exactly do for database data?\nI knew it controls the SQL query statements that I give as a parameter. but,,\nthen every SQL statements that i give as query should have each statement handle(hstmt) for each of them? or one statement handle for several SQL query statements?</p>\n\n<p>for example,</p>\n\n<pre><code>lstrcpy((LPTSTR)update, L\"insert into employee values  ('Dshong','summer','LosAngeles');\");\nSQLExecDirect(hstmt1, update, SQL_NTS);\n\nlstrcpy((LPTSTR)update, L\"insert into works values ('Dshong','Small Bank',    2500);\");\nSQLExecDirect(hstmt3, update1, SQL_NTS);\n\nlstrcpy((LPTSTR)select, L\"select * from works;\");\nif (SQLExecDirect(hstmt, select, SQL_NTS) != SQL_SUCCESS)\n    return printf(\"can’t exec direct\");\n\n\nlstrcpy((LPTSTR)select1, L\"select * from employee;\");\nif (SQLExecDirect(hstmt2, select1, SQL_NTS) != SQL_SUCCESS)\n    return printf(\"can’t exec direct\");\n</code></pre>\n\n<p>should I give like this for two insert statements and two select statements with four hstmt?</p>\n\n<p>and if I give like this,</p>\n\n<pre><code>lstrcpy((LPTSTR)insert, L\"insert into employee values ('Dshong','summer','LosAngeles');\");\nSQLExecDirect(hstmt1, insert, SQL_NTS);\n</code></pre>\n\n<p>the SQLExecDirect has hstmt1 as parameter but I don`t know how SQLExecDirect works with it..</p>\n\n<p>And as I think, the result should be one line inserted, isnt it?</p>\n\n<p>but when I run the code, it inserts multi-same rows for <code>('Dshong','summer','LosAngeles')</code>...\nwhen I printed out the result, <code>('Dshong','summer','LosAngeles')</code> was inserted multiple times \neven though the insert line was not in the for loop or so...</p>\n\n<p>and how they work together with the functions below? </p>\n\n<ul>\n<li><code>SQLBindCol(hstmt, 1, SQL_C_CHAR, id, (SDWORD)sizeof(id), &amp;idlen);</code></li>\n<li><code>SQLFetch(hstmt)</code></li>\n</ul>\n\n<p>I know what they simply doing but.. here I want to know exactly in which way \nhstmt ( statement handle) work with them..</p>\n\n<p>thank you..\n:)</p>\n"},{"tags":["c#","sql","image","application","desktop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13211254,"title":"Rotating Image in C# Desktop Application from Image Location Only","body":"<p>I am writing a C# desktop application that involves importing images from a digital camera, and saving them in a SQL Compact Edition database. I'm not saving the actual images in the database, but the image file path (to save database space). I'm then pulling that image file path from the database and setting the Image Location property of a Picture Box to that path, for display purposes. </p>\n\n<p>My question is this... I would like to add a button that will allow the user to rotate the image after import. Is there a way to do this without creating a new image? I know of the RotateFlip method, but it only works with type Image. Basically, I want to rotate the image linked the file path instead of creating an image from that path, then rotating it. I would love some ideas. Thanks! </p>\n"},{"tags":["sql","query","table","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13205615,"title":"Advanced SQL SUM COLUMN FROM A SAME TABLE","body":"<p>I have this table...</p>\n\n<pre><code>+-----+--------+------+-----+-----+\n|categ| nAME   | quan |IDUNQ|   ID|\n+-----+--------+------+-----+-----+\n|   1 | Z      |    3 |   1 |  15 |\n|   1 | A      |    3 |   2 |  16 |\n|   1 | B      |    3 |   3 |  17 |\n|   2 | Z      |    2 |   4 |  15 |\n|   2 | A      |    2 |   5 |  16 |\n|   3 | Z      |    1 |   6 |  15 |\n|   3 | B      |    1 |   7 |  17 |\n|   2 | Z      |    1 |   8 |  15 |\n|   2 | C      |    4 |   8 |  15 |\n|   1 | D      |    1 |   8 |  15 |\n+-----+--------+------+-----+-----+\n</code></pre>\n\n<p>I need to get the <em>Z of category 1 + Z of category 2 - Z of category 3</em></p>\n\n<p>For example, <em>(3+3-1) = 5   ==>  3 of cat 1,  3 of cat 2, 1 of cat 3</em></p>\n\n<p>The final result should be...</p>\n\n<pre><code>Z ==&gt; 5\nA ==&gt; 5\nB ==&gt; 2\nC ==&gt; 4\n</code></pre>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13210930,"title":"How to select rows where an attribute can have two values","body":"<p>I have a table called site_attributes which looks similar to this:</p>\n\n<pre><code>siteId     attributeId     tier\n-------------------------------\nsite1id    attribute1id    1\nsite1id    attribute2id    1\nsite1id    attribute3id    1\n</code></pre>\n\n<p>How can I select from the table the unique site id where attributeId is equal to attribute1id AND attributeId is equal to attribute3id?</p>\n"},{"tags":["php","sql","css","span"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13211079,"title":"Sorting PHP echo output by time posted","body":"<p>Ok, so. I have asked about 5 questions on stackOverflow today, you've all been so helpful.</p>\n\n<p>Now, i'm a designer, learning to code, so bear with me.</p>\n\n<p>I have a mySQL table, with a small CMS/Blog im building.\nI have it styled how I want to now.\nThis is the code for the page.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM Blog\");\nwhile($row = mysql_fetch_array($result))\n{\n    echo \"&lt;h1&gt;\" . $row['Title'] . \"&lt;/h1&gt;\";\n    echo \"&lt;br&gt;\";\n    echo \"&lt;h2&gt;\" . \"Posted on:   \" . $row['Date'] . \"&lt;/h2&gt;\";\n    echo \"&lt;br&gt;\";\n    echo \"&lt;img src='\".$row['Image'].\"'/&gt;\";\n    echo \"&lt;br&gt;\";\n    echo $row['Message'];\n    echo \"&lt;br&gt;\";\n    echo \"&lt;br&gt;\";\n}\n</code></pre>\n\n<p>I'm still working on it so its all good.</p>\n\n<p>What I want to know is, this code is outputting my sql data into a page. Is there any way of telling the page what order to echo the data, for instance. in my SQL table i have:</p>\n\n<pre><code>2012-11-03 16:16:06     This is my First Blog Post  This is the first message of the first blog post. ...   http://blog.gettyimages.com/wp-content/uploads/201.\n</code></pre>\n\n<p>and next is </p>\n\n<pre><code>2012-11-03 16:17:29     This is my Second Blog Post     This is the second message of the Second Post, You...   http://www.aviation-images.com/user/zooms/118/451n...\n</code></pre>\n\n<p>How can i tell the page to Always display the most recent post at the top, and older ones below.?</p>\n"},{"tags":["sql","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13205031,"title":"JDBC getGeneratedKeys()","body":"<p>I obtained the following code example from <a href=\"http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/getstart/preparedstatement.html\" rel=\"nofollow\">http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/getstart/preparedstatement.html</a></p>\n\n<p>I have three questions:</p>\n\n<ol>\n<li>What does 'keyColumn' refer to considering that there are only three columns - LAST, FIRST, HOME.\n<li>Why is a loop used in iterating the generated keys?  Are multiple rows returned for that one insert statement?\n<li>Which databases support multiple generated keys per table?\n</ol>\n\n<pre><code>String sql = \"INSERT INTO AUTHORS (LAST, FIRST, HOME) VALUES \" +\n                                     \"(?, ?, ?, keyColumn)\";\n\nPreparedStatement addAuthor = con.prepareStatement(sql,\n                             Statement.RETURN_GENERATED_KEYS);\naddAuthor.setString(1, \"Wordsworth\");\naddAuthor.setString(2, \"William\");\naddAuthor.setString(3, \"England\");\n\nint rows = addAuthor.executeUpdate();\n\nResultSet rs = stmt.getGeneratedKeys();\nif (rs.next()) {\n    ResultSetMetaData rsmd = rs.getMetaData();\n    int colCount = rsmd.getColumnCount();\n    do {\n        for (int i = 1; i &lt;= colCount; i++) {\n            String key = rs.getString(i);\n            System.out.println(\"key \" + i + \"is \" + key);\n        }\n    }\n    while (rs.next();)\n} \nelse {\n    System.out.println(\"There are no generated keys.\");\n}\n</code></pre>\n"},{"tags":["java","sql","oracle","jdk"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":5642,"score":4,"question_id":7876502,"title":"How can I run Oracle SQL Developer on JDK 1.6 and everything else on 1.7?","body":"<p>How can I run Oracle SQL Developer on a version of Java it supports (1.6) while running Java 1.7 for everything else?</p>\n\n<p>I can install both JDK's on my system, but I'm concerned with changing environment variables and having it affect more than just SQL Developer. Curious if there's elegant solutions to this.</p>\n\n<p>I am having issues with SQL Developer (running off JDK 1.7) only returning 50 rows. &lt;-- Feel free to address this specific issue as well. EDIT: The problem is not that it returns only 50 rows, this is standard, the problem is the inability to scroll down to see more rows on demand.</p>\n"},{"tags":["mysql","sql","query","select","insert"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13210900,"title":"Sql Insert default value if Select returns nothing","body":"<p>I have the following SQL query which populates a table with details of various phone calls.</p>\n\n<pre><code>INSERT tblCalls (callerID, destinationNum)\nSELECT tblCallerID.callerID, tblSkyNums.skyID\nFROM tblCallerID, tblSkyNums\nWHERE tblCallerID.callerNumber = '\".$caller_id.\"'\nAND tblSkyNums.skyNum = '\".$dest_no.\"'\n</code></pre>\n\n<p>The query grabs a callerID and a skyID from two seperate tables and inserts them into a third table; tblCalls.</p>\n\n<p>My problem is sometimes no skyID exists for the number entered, and when this happens nothing is entered into tblCalls. Which means no data is recorded for this call.</p>\n\n<p>What I have been trying to do is if no such skyID exists, simply enter 'n/a' into the skyID field for that particular call.</p>\n\n<p>I have been at this for over two days now and cant seem to find a way to get it to work.\nAny help would be geatly appreciated.</p>\n"},{"tags":["sql","android","multi-table"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6135,"score":1,"question_id":4002820,"title":"Creating a multi-table SQL database in android","body":"<p>I'm trying to create a multi-table database for my android application. I'm following the suggestion given on this site <a href=\"http://androidforbeginners.blogspot.com/2010/01/creating-multiple-sqlite-database.html\" rel=\"nofollow\">http://androidforbeginners.blogspot.com/2010/01/creating-multiple-sqlite-database.html</a> for doing it. I keep on getting the error below. The error seems to be cause by the onCreate of the databaes tables.</p>\n\n<p>If you look at my onCreate in the the DBHelper class I have two commented out. This allows it to work no matter which one is left uncommeted. </p>\n\n<p>There has to be a way to create a multi-table database because a single table in a database almost defeats the purpose of having a database.</p>\n\n<p>10-23 02:11:35.383: ERROR/AndroidRuntime(300): Caused by: android.database.sqlite.SQLiteException: Can't upgrade read-only database from version 0 to 1: /data/data/com.parkingticket/databases/Tickets.db</p>\n\n<p>Thanks in advance.</p>\n\n<p>Here is my code</p>\n\n<pre><code>package com.parkingticket;\n</code></pre>\n\n<p>import java.sql.SQLException;</p>\n\n<p>import android.content.ContentValues;\nimport android.content.Context;\nimport android.database.Cursor;\nimport android.database.sqlite.SQLiteDatabase;\nimport android.database.sqlite.SQLiteDatabase.CursorFactory;\nimport android.database.sqlite.SQLiteException;\nimport android.database.sqlite.SQLiteOpenHelper;\nimport android.util.Log;</p>\n\n<p>public class TicketDBAdapter \n{\n    private static final String DATABASE_NAME=\"Tickets.db\";\n    private static final int DATABASE_VERSION = 1;</p>\n\n<pre><code>private static final String PARKEDCARS_TABLE = \"ParkedCars\";\nprivate static final String PARKINGMETERS_TABLE = \"ParkingMeters\";\nprivate static final String PARKINGTICKETS_TABLE = \"ParkingTickets\";\nprivate static final String POLICEOFFICERS_TABLE = \"PoliceOfficers\";\n\n// The name and column index for each column in PARKEDCARS\npublic static final String KEY_CARID = \"carID\";\n    public static final int CARID_COLUMN = 0;\npublic static final String KEY_CARMAKE = \"Make\";\n    public static final int CARMAKE_COLUMN = 1;\npublic static final String KEY_CARMODEL = \"Model\";\n    public static final int CARMODEL_COLUMN = 2;\npublic static final String KEY_CARCOLOR = \"Color\";\n    public static final int CARCOLOR_COLUMN = 3;\npublic static final String KEY_CARLICENSENUMBER = \"LicenseNumber\";\n    public static final int CARLICENSENUMBER_COLUMN = 4;\npublic static final String KEY_CARMINUTESPARKED = \"MinutesParked\";\n    public static final int CARMINUTESPARKED_COLUMN = 5;\n\n// The name and column index for each column in PARKINGMETERS\npublic static final String KEY_METERID = \"meterID\";\n    public static final int METERID_COLUMN = 0;\npublic static final String KEY_MINUTESPURCHASED = \"MinutesPurchased\";\n    public static final int MINUTESPURCHASED_COLUMN = 1;\n\n// The name and column index for each column in PARKINGTICKETS\n    //TODO create the columns and indexs for parking tickets\n\n// The name and column index for each column in POLICEOFFICERS\npublic static final String KEY_OFFICERID = \"officerID\";\n    public static final int OFFICERID_COLUMN = 0;\npublic static final String KEY_OFFICERNAME = \"Name\";\n    public static final int OFFICERNAME_COLUMN = 1;\npublic static final String KEY_OFFICERBADGE = \"BadgeNumber\";\n    public static final int OFFICERBADE_COLUMN = 2;\n\n\n//Variable to hold the database instance\nprivate SQLiteDatabase ticketDB;\n\n//Context of the application using the database.\nprivate final Context context;\n\n//Database open/upgrade helper\nprivate TicketDBHelper ticketDBHelper;\n\npublic TicketDBAdapter(Context _context)\n{\n    context = _context;\n    ticketDBHelper = new TicketDBHelper(context, DATABASE_NAME, null, DATABASE_VERSION);\n}\n\npublic void open() throws SQLiteException\n{\n    try\n    {\n        ticketDB = ticketDBHelper.getWritableDatabase();\n    }\n    catch(SQLiteException ex)\n    {\n        ticketDB = ticketDBHelper.getReadableDatabase();\n    }\n}\n\npublic void close()\n{\n    ticketDB.close();\n}\n\n //Insert a new ParkedCar\npublic long insertParkedCar(ParkedCar _car)\n{\n    //Create a new row of values to insert\n    ContentValues newParkedCarValues = new ContentValues();\n\n    //Assign values for each row\n    newParkedCarValues.put(KEY_CARMAKE, _car.getMake());\n    newParkedCarValues.put(KEY_CARMODEL, _car.getModel());\n    newParkedCarValues.put(KEY_CARCOLOR, _car.getColor());\n    newParkedCarValues.put(KEY_CARLICENSENUMBER, _car.getLicenseNumber());\n    newParkedCarValues.put(KEY_CARMINUTESPARKED, _car.getMinutesParked());\n\n    //Insert the row\n    return ticketDB.insert(PARKEDCARS_TABLE, null, newParkedCarValues);\n}\n\n//Remove a ParkedCar based on its index\npublic boolean removeParkedCar(long _rowIndex)\n{\n    return ticketDB.delete(PARKEDCARS_TABLE, KEY_CARID + \"=\" + _rowIndex, null)&gt;0;\n}\n\n//Update a ParkedCar's MinutesParked\n//TODO Create an update for ParkedCar's minutesParked.\n\npublic Cursor getAllParkedCarsCursor()\n{\n    return ticketDB.query(PARKEDCARS_TABLE, new String[] {KEY_CARID, KEY_CARMAKE, KEY_CARMODEL, KEY_CARCOLOR, KEY_CARLICENSENUMBER, KEY_CARMINUTESPARKED}, null, null, null, null, null);\n}\n\npublic Cursor setCursorParkedCar(long _rowIndex) throws SQLException\n{\n    Cursor result = ticketDB.query(true, PARKEDCARS_TABLE, new String []{KEY_CARID}, KEY_CARID + \"=\" + _rowIndex, null, null, null, null, null);\n\n    if ((result.getCount() == 0) || !result.moveToFirst())\n    {\n        throw new SQLException(\"No ParkedCar found for row: \" + _rowIndex);\n    }\n\n    return result;\n}\n\npublic static class TicketDBHelper extends SQLiteOpenHelper\n{\n    public TicketDBHelper(Context context, String name, CursorFactory factory, int version)\n    {\n        super(context, name, factory, version);\n    }\n\n    //SQL Statement to create PARKEDCARS table\n    private static final String PARKEDCARS_CREATE = \"create table \" + PARKEDCARS_TABLE + \" (\" + KEY_CARID + \" integer primary key autoincrement, \" + KEY_CARMAKE + \" text not null,\" + KEY_CARMODEL + \" text not null,\" + KEY_CARCOLOR + \" text not null,\" + KEY_CARLICENSENUMBER + \" text not null,\" + KEY_CARMINUTESPARKED + \"int not null);\";\n\n    //SQL Statement to create ParkingMeters table\n    private static final String PARKINGMETERS_CREATE = \"create table\" + PARKINGMETERS_TABLE + \" (\" + KEY_METERID + \" integer primary key autoincrement, \" + KEY_MINUTESPURCHASED + \" int not null);\";\n\n    //SQL Statement to create ParkingTickets table\n    //TODO create the statement for parkingTickets\n\n    //SQL Statement to create PoliceOfficers table\n    private static final String POLICEOFFICERS_CREATE = \"create table\" + POLICEOFFICERS_TABLE + \" (\" + KEY_OFFICERID + \" integer primary key autoincrement, \" + KEY_OFFICERNAME + \" text not null,\" + KEY_OFFICERBADGE + \"text not null);\";\n\n    //Called when no database exists in disk and the helper class needs to create a new one.\n    @Override\n    public void onCreate(SQLiteDatabase _db)\n    {\n</code></pre>\n\n<p>//          _db.execSQL(PARKEDCARS_CREATE);\n            _db.execSQL(PARKINGMETERS_CREATE);\n//          _db.execSQL(POLICEOFFICERS_CREATE);\n        }</p>\n\n<pre><code>    //Called when there is a database verion mismatch meaning that the version of the database on disk needs to be upgraded to the current version\n    @Override\n    public void onUpgrade(SQLiteDatabase _db, int _oldVersion, int _newVersion)\n    {\n        //Log the version upgrade.\n        Log.w(\"TaskDBAdapter\", \"Upgrading from version \" + _oldVersion + \" to \" + _newVersion + \", which will destroy all old data\");\n\n        //Upgrade the existing database to conform to the new version\n        //Multiple previous versions can be handled by comparing _oldVersoin and _newVersion values\n\n        //The simplest case is to drop teh old table and create a new one.\n        _db.execSQL(\"DROP TABLE IF EXISTS \" + PARKEDCARS_TABLE);\n        _db.execSQL(\"DROP TABLE IF EXISTS \" + PARKINGMETERS_TABLE);\n        _db.execSQL(\"DROP TABLE IF EXISTS \" + POLICEOFFICERS_TABLE);\n\n        onCreate(_db);\n    }\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["php","sql","css","span"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13210552,"title":"How to style PHP echo output with span","body":"<p>I'm trying to style the output of each echo.</p>\n\n<p>Ideally I'd like to use <code>&lt;span class=\"\"&gt; &lt;/span&gt;</code> for each echo, but I'm not too sure how to achieve this.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM Blog\");\nwhile($row = mysql_fetch_array($result))\n{\n    echo $row['Date'];\n    echo $row['Title'];\n    echo $row['Message'];\n    echo \"&lt;img src='\".$row['Image'].\"'/&gt;\";\n}\n\nmysql_close($con);\n</code></pre>\n"},{"tags":["mysql","sql","in-clause"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":34,"score":-1,"question_id":13210233,"title":"Mysql empty in clause parameter list","body":"<p>I was wondering what happens when you do a sql query where the <code>IN</code> clause is empty. I.e :\n<code>SELECT user WHERE id IN ();</code>.</p>\n"},{"tags":["sql","oracle","stored-procedures","plsql","sqlplus"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13209175,"title":"PL/SQL : Encountered the symbol \"END\"","body":"<p>I get the following error, even though I have checked the code carefully. I don't know what I'm missing. </p>\n\n<p>LINE/COL ERROR</p>\n\n<hr>\n\n<p>31/1     PLS-00103: Encountered the symbol \"END\" when expecting one of the\n         following:</p>\n\n<p>CODE:</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE sp_ssjm_newworkorder\n(   workorderno IN NUMBER,\ncompany     IN CHAR,\nattention   IN CHAR,\ndatedue     IN DATE,\nloggedby    IN CHAR\n)\n\nAS  id     NUMBER;\ntoday         DATE:=SYSDATE;\nBEGIN\nSELECT  client_id   --grab client_id\nINTO id \nFROM    ssjm_client\nWHERE ssjm_client.name=company;\n\nIF id IS NULL THEN  --check if client exists by checking if client_id is there\n    dbms_output.put_line('Please create client first');\n    GOTO the_end;\nELSE\n    INSERT INTO ssjm_workorder      VALUES(workorderno,workorderno,company,loggedby,attention,'Received',today,datedue,id);\nEND IF;\n\nEXCEPTION\n    WHEN OTHERS THEN\n    raise_application_error(-20999,'An error occured in' ||\n        SQLCODE || '-ERROR-' || SQLERRM);\n\n&lt;&lt;the_end&gt;&gt;\n\nEND sp_ssjm_newworkorder;\n</code></pre>\n"},{"tags":["php","sql","database","append"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13208219,"title":"My SQL is not working","body":"<p>I'm trying to add a value to a row in a database table that currently has other values. I want to effect only one field in the table. here's what I'm doing:</p>\n\n<pre><code>$sql = \"UPDATE users SET photo = \".$m_fname.\" WHERE pin = \".$_SESSION['pin'].\";\";\n</code></pre>\n\n<p>What's the correct way to do this?</p>\n\n<p>Here's a little more:</p>\n\n<pre><code>  $m_fname = mysql_real_escape_string($dest_filename);\n  $sql = \"UPDATE users SET photo = \".$m_fname.\" WHERE pin = \".$_SESSION['pin'].\";\";\n  $res = @mysql_query($sql);\n  if (!$res) {\n    $errors[] = \"Could not run query.\";\n    break;\n  }\n</code></pre>\n\n<p><strong>Before anyone else downvotes..</strong>\nI'm aware I should be using mysqli. Sorry if I offended anyone by using an old function.</p>\n"},{"tags":["sql","database","dicom"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13134037,"title":"Storing file location of DICOM images in SQL database","body":"<p>I want to store <code>DICOM</code> images in a directory somewhere, create a database of specific parameters relating to the <code>DICOM</code> images and add the relative location of the <code>DICOM</code> files to the database. </p>\n\n<p>How do I go about doing this in Design view instead of coding explicitly? (I'm relatively new to database / SQL that sort of thing which is why I'd prefer doing it in design view at least at first). </p>\n\n<p>I have searched for questions related to this topic, however all I came up with was posts debating whether it was better to store the images themselves in the database or a pointer to the location. </p>\n\n<p>Can somebody tell me exactly how to go about doing it instead of the pros and cons of the different methods?</p>\n"},{"tags":["sql","sql-server","performance","sql-server-2008","query"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":35148,"score":7,"question_id":4193705,"title":"SQL Server SELECT LAST N Rows","body":"<p>This is a known question but the best solution I've found is something like:</p>\n\n<pre><code>SELECT TOP N *\nFROM MyTable\nORDER BY Id DESC\n</code></pre>\n\n<p>I've a table with lots of rows. It is not a posibility to use that query because it takes lot of time. So how can I do to select last N rows without using ORDER BY?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Sorry duplicated question of <a href=\"http://stackoverflow.com/questions/311054/how-do-i-select-last-5-rows-in-a-table-without-sorting\">this one</a></p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13208427,"title":"SQL how to avoid duplicate insert in a table","body":"<p>how to avoid duplicate insert in a table? I use below query to insert in to table:</p>\n\n<pre><code>insert into RefundDetails(ID,StatusModified,RefundAmount,OrderNumber) \n  select O.id,O.StatusModified,OI.RefundAmount,O.OrderNumber \n  from Monsoon.dbo.[Order] as O  \n  WITH (NOLOCK) JOIN Monsoon.dbo.OrderItem as OI  \n  WITH (NOLOCK)on O.Id = OI.OrderId \n  WHERE o.ID in (SELECT OrderID \n                 FROM Mon2QB.dbo.monQB_OrderActivityView \n                 WHERE ACTIVITYTYPE = 4 AND at BETWEEN '10/30/2012' AND '11/3/2012') AND (O.StatusModified &lt; '11/3/2012') \n</code></pre>\n"},{"tags":["mysql","sql","database","foreign-keys"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13210016,"title":"How to Ignore \"Cannot add or update a child row\" error","body":"<p>I have an sql query from my backup files, it has huge amount of insert statements.</p>\n\n<blockquote>\n  <p>INSERT INTO <code>tns_spo_hotel</code> (<code>id_spo</code>, <code>id_hotel</code>) VALUES\n  (523,149),(523,195), ...</p>\n</blockquote>\n\n<p>I have a foreign keys on both columns.</p>\n\n<p>When i run this query, it returns </p>\n\n<pre><code>#1452 - Cannot add or update a child row: a foreign key constraint fails (`tsakhkad_tour_new`.`tns_spo_hotel`, CONSTRAINT `tns_spo_hotel_22` FOREIGN KEY (`id_hotel`) REFERENCES `tns_hotel` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)\n</code></pre>\n\n<p>Because there are some rows, with missing values.</p>\n\n<p>Is it possible to ignore that error message and continue sql execution ?</p>\n"},{"tags":["sql","oracle","database-design","primary-key"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13208403,"title":"What is the better way to organize primary keys in database?","body":"<p>My database holds two tables, one is distance matrix of cities, the other holds cities. My first structure was like this:</p>\n\n<ul>\n<li>City \n<ul>\n<li>Uuid</li>\n<li>Name</li>\n<li>Latitude</li>\n<li>Longitude</li>\n</ul></li>\n</ul>\n\n<p>and </p>\n\n<ul>\n<li>Distance\n<ul>\n<li>FromCityID</li>\n<li>ToCityID</li>\n<li>DistanceLength</li>\n</ul></li>\n</ul>\n\n<p><code>UUID</code> is a primary key of the CITY table, <code>FromCityID</code> and <code>ToCityID</code> reference CITY each as foreign key, and both are composite primary key of the DISTANCE table because the distance between two cities should be unique.</p>\n\n<p>But then a realised that I don't want to use <code>UUID</code> and auto-increment as primary keys because I upload data in this database from XML, which holds cities and distances. And as distances may include not only those cities that mentioned in current XML but any previously stored city from database.</p>\n\n<p>I need a system of IDs that is the same across the database and XML. Latitude / longitude seems the best option so I changed my tables to this:</p>\n\n<ul>\n<li>City \n<ul>\n<li>Name</li>\n<li>Latitude</li>\n<li>Longitude</li>\n</ul></li>\n</ul>\n\n<p>and </p>\n\n<ul>\n<li>Distance\n<ul>\n<li>FromCityIDLatitude</li>\n<li>FromCityIDLongitude</li>\n<li>ToCityIDLatitude</li>\n<li>ToCityIDLongitude</li>\n<li>DistanceLength</li>\n</ul></li>\n</ul>\n\n<p><code>Latitude</code> and <code>Longitude</code> are a composite primary key of the CITY table; <code>FromCityIDLatitude</code> / <code>FromCityIDLongitude</code> and <code>ToCityIDLatitude</code> / <code>ToCityIDLongitude</code> reference CITY each as foreign keys, and all four columns are composite primary key of the DISTANCE table.</p>\n\n<p>But it's a bad design to use 4 columns as a primary key. What is the best thing in this case?</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13208958,"title":"Sql get name and parent in while loop","body":"<p>I have a table called tblmodules which has 3 columns: moduleid,name,parent_id. The column parent_id takes values of other modules. ex:</p>\n\n<pre><code>Moduleid      Name       Parentid\n--------     -----       --------\n1           grandparent    Null\n2            parent         1\n3           child           2\n</code></pre>\n\n<p>I want a stored procedure that takes the parent's Id and Name of a child giving a level. So i develop the following. </p>\n\n<pre><code>        @moduleid bigint,\n    @level int\n\nAS\nBEGIN\n    -- SET NOCOUNT ON added to prevent extra result sets from\n    -- interfering with SELECT statements.\n    SET NOCOUNT ON;\n\n    declare @parentid bigint\n    declare @name nvarchar(100)\n    set @parentid = (select parentid from tblModules where ModuleId = @moduleid)\n\n\n    declare @counter int\n    set @counter = 1\n\n    while @counter &lt; @level\n    begin\n\n        set @parentid = (select parentid from tblModules where ModuleId = @parentid)\n        set @name = (select Name from tblModules where ModuleId = @parentid)\n\n        set @counter = @counter + 1\n    end\n\n    select @parentid AS ID\n    select @name as Name\n\nend\n</code></pre>\n\n<p>The procedure works fine and gets the correct Id of the parent, but the name remains the same as the child. For ex i am executing it giving the values @moduleid: 3 and @level:2.\nI am getting result ID: 1 which is correct but Name: child instead of Grandparent. Any help?</p>\n"},{"tags":["php","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13209913,"title":"PHP variable needs to equal a value obtained from an sql query","body":"<p>I am trying to use php to plot a graph. I want to plot the values returned from a count of results within a table:</p>\n\n<pre><code>SELECT COUNT(*) FROM tAnswer WHERE Answer1 = '1';\n</code></pre>\n\n<p>The query returns 3. I now want this 3 to become stored within a php variable.</p>\n\n<p>How would I got about this?</p>\n"},{"tags":["sql","parsing","postgresql","syntax","cvs"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":772,"score":2,"question_id":8271606,"title":"postgresql syntax check without running the query","body":"<p>I want to verify the syntax of files containing sql queries before they can be committed in my CVS project. </p>\n\n<p>In order to do that, I have a commitinfo script, but I have trouble finding out if the sql commands are valid. <code>psql</code> does not seem to have a dryrun mode, and constructing my own postgresql-dialact tester from the grammar (that is in the source) seems like a long stretch. </p>\n\n<p>The scripts may contain multiple queries, so an <code>EXPLAIN</code> cannot be wrapped around them. </p>\n\n<p>Any hints?</p>\n"},{"tags":["mysql","sql","rank"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13209227,"title":"Getting rank of a row in mysql query","body":"<p>I was using this query to assign rank to every name according to the votes they have got, but it returns with the error :</p>\n\n<blockquote>\n  <p>1248 - Every derived table must have its own alias</p>\n</blockquote>\n\n<p>Here is my code:</p>\n\n<pre><code>SELECT @rownum:=@rownum+1 AS rank, name, vote \nFROM table, (SELECT @rownum:=0) ORDER BY vote DESC\n</code></pre>\n\n<p>On modifying the query to this :-</p>\n\n<pre><code>SELECT @rownum:=@rownum+1 AS rank, name, vote \nFROM table ORDER BY vote DESC\n</code></pre>\n\n<p>I get as expected rank of the queries as NULL. Any help , how to get rank at first place ?</p>\n\n<p><strong>NOTE:</strong> I am not looking for any alternative solution. Just trying to do it in the query itself.</p>\n"},{"tags":["sql","tsql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13208158,"title":"Can't drop procedure if object_id is not null","body":"<p>I have a weird problem. I'm trying to drop a procedure only if it exists, and have this code: </p>\n\n<pre><code>IF OBJECT_ID(N'dbo.CreateBlogUser', N'U') IS NOT NULL\n    DROP PROCEDURE CreateBlogUser;\n    PRINT 'IS NOT NULL'\nGO\n</code></pre>\n\n<p>(the print is only there to try if it is true or not).\nAnd when I run it, \"IS NOT NULL\" is printed, but the procedure isn't dropped! It still exists in the database, so when I run my Create procedure, it fails. </p>\n\n<p>However! When I tried to remove the NOT from the code, it works! The procedure is dropped and \"IS NOT NULL\" is still printed. This seems totally backwards and I don't know why it does this. Is is something to do with the extra N:s and U:s in the OBJECT_ID? Found the code <a href=\"http://msdn.microsoft.com/en-us/library/ms190328.aspx\" rel=\"nofollow\">here</a></p>\n"},{"tags":["mysql","sql","database","table","import"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13209349,"title":"Can't see tables while importing database - MYSQL","body":"<p>Why can't I see tables while i am importing database in phpmyadmin. It shows me success but then still I am not able to see any tables. Though if i run any query it does show me the result. What is the problem? I have tried finding answers online but couldn't find anything.</p>\n"},{"tags":["c#","sql","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13208041,"title":"Desktop Application gridview cell values lock alternate according to cell values","body":"<p>I have a grid, It have 6 columns(item name,min quantity,max quantity,max amout,max amount,Discount).</p>\n\n<p><strong>Requirement</strong> </p>\n\n<p>When I select <strong>min Quantity</strong>, <strong>max Quantity column</strong> will Disable And its Value become Zero,when i select <strong>min amount ,max amout column</strong> will Disable and vice Versa. When i enter min value in quantity then row of grid contain max value from first row.</p>\n"},{"tags":["mysql","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13209021,"title":"Return random image SQL","body":"<p>I have a database which holds information about user-created items. Each item can have a number of images associated with it, and I'd like to have an SQL query that 4 random item images, but should not return images from the same item twice.</p>\n\n<p>Here's a review of the table structures (not full, but including the pertinent information):</p>\n\n<p>Table 1 : <strong>item_images:</strong></p>\n\n<pre><code>+----------+--------------+\n| item_id  |   filename   |\n+----------+--------------+\n|    1     |   test.jpg   | \n|    1     |   test2.jpg  |\n|    5     |   testy.jpg  |\n+----------+--------------+\n</code></pre>\n\n<p>Table 2: <strong>item_link:</strong></p>\n\n<pre><code>+----------+-------------+\n| item_id  | category_id |\n+----------+-------------+\n|    1     |      1      |\n|    5     |      1      |\n+----------+-------------+\n</code></pre>\n\n<p>So given the above data, I'd like to return a random image for item # 1 and 5, since they both exist in category # 1.</p>\n\n<p>Here's the SQL query I have already tried, but for some reason, it always returns the same two images. How might I modify this to return a random image from the matched items?</p>\n\n<pre><code>SELECT `item_images`.`filename` AS `url` FROM `item_images`\n  INNER JOIN `item_link` ON `item_images`.`item_id` = `item_link`.`item_id`\n  WHERE `item_link`.`category_id` = 1 \n  GROUP BY `item_link`.`item_id`\n  ORDER BY RAND()\n  LIMIT 4\n</code></pre>\n"},{"tags":["sql","select","listbox","selected"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2848,"score":1,"question_id":2412863,"title":"Multiple Selected Values of ListBox as Parameters to SELECT SQL Query","body":"<p>I want to pass the Multiple selected values from ListBox as parameters to my Select SQL Query. </p>\n\n<p>I am using VB.NET, how can I achieve this ?...</p>\n"},{"tags":["sql","database","oracle","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2803,"score":1,"question_id":2690192,"title":"Combining multiple rows into one row, Oracle","body":"<p>I'm working with a database which is created in Oracle and used in a GIS-software through SDE. One of my colleuges is going to make some statistics out of this database and I'm not capable of finding a reasonable SQL-query for getting the data.</p>\n\n<p>I have two tables, one with registrations and one with registrationdetails. It's a one to many relationship, so the registration can have one or more details connected to it (no maximum number).</p>\n\n<ol>\n<li>table: Registration  </li>\n</ol>\n\n<pre>\nRegistrationID          Date       TotLenght\n1                    01.01.2010        5\n2                    01.02.2010        15\n3                    05.02.2009        10\n</pre>\n\n<p>2.table: RegistrationDetail</p>\n\n<pre>\nDetailID     RegistrationID   Owner      Type      Distance\n1                  1           TD          UB          1,5\n2                  1           AB          US          2\n3                  1           TD          UQ          4\n4                  2           AB          UQ         13\n5                  2           AB          UR         13,1\n6                  3           TD          US          5\n</pre>\n\n<p>I want the resulting selection to be something like this:</p>\n\n<pre>\nRegistrationID          Date       TotLenght DetailID     RegistrationID   Owner     Type      Distance  DetailID     RegistrationID   Owner      Type      Distance  DetailID     RegistrationID   Owner      Type      Distance\n1                    01.01.2010        5         1              1           TD        UB          1,5          2               1          AB        US          2         3                  1              TD          UQ          4\n2                    01.02.2010        15        4              2           AB        UQ         13            5               2          AB        UR         13,1\n3                    05.02.2009        10        6              3           TD        US          5\n</pre>\n\n<p>With a normal join I get one row per each registration and detail. Can anyone help me with this? I don't have administrator-rights for the database, so I can't create any tables or variables. If it's possible, I could copy the tables into Access.</p>\n"},{"tags":["php","sql","pdo","count","odbc"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":3974,"score":7,"question_id":2304315,"title":"Get Number of Rows from a Select statement","body":"<p>I have this:</p>\n\n<pre><code>$dbh = new PDO(\"odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=$mdbFilename\", $username, $password);\n\n$sql = \"SELECT * FROM this_table\";\n\n$stmt = $dbh-&gt;query($sql);\n\n//num of rows?\n</code></pre>\n\n<p>How do I get the number of rows returned from that SELECT statement?</p>\n\n<p>Thanks all</p>\n"},{"tags":["sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13208147,"title":"Multivalued Attribute","body":"<p>Assume here we have a column to describe the description of a product.</p>\n\n<p>I think I have to use multivalue to fill in the table.</p>\n\n<p>Is that kind of mistake to violate the principle of 1NF?</p>\n\n<p>I am beginner to database design, recently I feel really confused about it.</p>\n"},{"tags":["sql","count","having-clause","match-against"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13208085,"title":"SQL - MATCH AGAINST with HAVING and COUNT()","body":"<p>does someone knows why this first query works and this second not?</p>\n\n<p>first query (works):</p>\n\n<pre><code>SELECT *, \n       MATCH(username) AGAINST ('ergergergergergerg' IN BOOLEAN MODE) AS _score\nFROM (ci_users) HAVING _score &gt; '0';\n</code></pre>\n\n<p>second query (not working):</p>\n\n<pre><code>SELECT COUNT(id), \n       MATCH(username) AGAINST ('ergergergergergerg' IN BOOLEAN MODE) AS _score \nFROM (ci_users) HAVING _score &gt; '0';\n</code></pre>\n\n<p>the first query returns exactly 24 rows, the second query returns 0 rows, while i just changed <code>*</code> to <code>COUNT(id)</code></p>\n"},{"tags":["iphone","objective-c","sql","ios","xcode"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1028,"score":4,"question_id":9645021,"title":"Application users account registration and login, best way to handle?","body":"<p>First of all, i'm new to Objective-C, so please be patient with me.</p>\n\n<p>I want to add to my application users account management, users can register/log-in into a personal account that will synchronized with database on the internet. I dont have a clue how to do that. I know how to work with sqlite3. I was thinking maybe to create an sqlite3 database on the device. is it possible to store images into sqlite3 database? is it the best and efficient way to manage users on application?</p>\n\n<p>what does sign in with Facebook or Twitter do? is it possible to add them both and another option for someone who doesn't have Facebook or Twitter?</p>\n\n<p>What is the best way to handle account registration and login on iPhone?</p>\n\n<p>Thanks alot!</p>\n"},{"tags":["mysql","sql","select","limit","where"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13207746,"title":"SQL how limit and offset are executed?","body":"<p>i would like to know if limit and offset are executed after the row were selected:</p>\n\n<pre><code>SELECT * FROM users WHERE id &gt; 4 LIMIT 0,90 ORDER BY datetime DESC;\n</code></pre>\n\n<p>Does this query first selects all the users's rows then apply the <code>LIMIT</code>, or does this query first apply the <code>LIMIT</code> then selects the users's rows? </p>\n"},{"tags":["sql","sql-server","syntax"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":16356,"score":2,"question_id":1267427,"title":"SQL: Insert all records from one table to another table without specific the columns","body":"<p>I want to insert all the record from the back up table foo_bk into foo table without specific the columns.</p>\n\n<p>if i try this query</p>\n\n<pre><code>INSERT INTO foo \nSELECT *\nFROM foo_bk\n</code></pre>\n\n<p>i'll get error \"Insert Error: Column name or number of supplied values does not match table definition.\"</p>\n\n<p>Is it possible to do bulk insert from one table to another without supply the column name?\nI've google it but can't seem to find an answer. all the answer require specific the columns.</p>\n"},{"tags":["python","sql","list"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":49,"score":-3,"question_id":13206611,"title":"Python associating multiple values from one list to another list","body":"<p>I have a pretty simple idea in mind but don't exactly know how to go about doing it. I have two lists of different length (say 50 in one and 200 in the other). </p>\n\n<p>so</p>\n\n<pre><code>len(x) = 50\nlen(y) = 200\n</code></pre>\n\n<p>What I want to do is print out some lines where one value from x corresponds to multiple values of y (does not matter if numbers are repeated). </p>\n\n<pre><code>I.e. suppose x = [1,2,3,4]\ny = [7,8,9,10,11,12,13,14,15,16,17]\n\nI want to print out:\n1: 7\n1: 8\n1: 9\n1: 10\n2: 11\n2: 12\n2: 13\n3: 14\n3: 15\n3: 16\n4: 17\n</code></pre>\n\n<p>Randomization of values from y does not really matter.\nIt does not matter how many multiple values get printed out for each value of x. I am basically trying to write a sql script of inserting multiple elements from one table into another and using python to write the script.</p>\n\n<p>I know this can be done by simply iterating over the smallest list and having multiple f.write() statements while incrementing some variable to have multiple values of y associated to a single value of x. But this does not cover all the values of y and looks kind of silly. Is there a better way to go about doing this?</p>\n\n<p>Edit: For the question where how I came up with the association of keys to values, it does not really matter how many values 1 key is associated with (an upper bound of 8 exists). There can be only 1 value or multiple (up to 8). Then again, there can be repetitions of values between keys (i.e. in my example there is not but key 4 can say have values 7/8 also) </p>\n"},{"tags":["sql","join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13207784,"title":"MAX function and GROUP BY function not working together","body":"<p>I want to list the name professor who teaches \"java\", number of times he taught and latest year and term he taught.</p>\n\n<p>I tried this query but it's giving two rows with same name.</p>\n\n<pre><code>SELECT i.I_FNAME, COUNT(f.I_ID) as myCount, f.CO_TERMNUMBER, f.CO_YEAR\nFROM \n  INSTRUCTOR i\nJOIN TEACHINGQUALIFICATION t\n  ON i.I_ID = t.I_ID\nJOIN COURSE c\n  ON c.C_ID = t.C_ID\nJOIN COURSEOFFERING f\n  ON i.I_ID = f.I_ID  \nWHERE c.C_TITLE =  'java'\n  GROUP BY t.I_ID, i.I_FNAME, f.CO_TERMNUMBER, f.CO_YEAR\n  ORDER BY f.CO_YEAR desc \n</code></pre>\n\n<p><strong>output:</strong></p>\n\n<pre><code>1    Gaurav    1    4   2006\n2    Gaurav    1    1   2000\n</code></pre>\n\n<p><strong>Expected output:</strong></p>\n\n<pre><code>1    Gaurav    2    4   2006\n</code></pre>\n\n<p><strong>code with error:</strong></p>\n\n<p>I also tried this code with the condition  \"AND f.CO_YEAR= MAX (f.CO_YEAR)\" but it's showing this error \" group function is not allowed here\" </p>\n\n<pre><code>SELECT  t.I_ID, i.I_FNAME, COUNT(f.I_ID) as Cnt, f.CO_TERMNUMBER, f.CO_YEAR\nFROM \n  INSTRUCTOR i\nJOIN TEACHINGQUALIFICATION t\n  ON i.I_ID = t.I_ID\nJOIN COURSE c\n  ON c.C_ID = t.C_ID\nJOIN COURSEOFFERING f\n  ON i.I_ID = f.I_ID  \nWHERE c.C_TITLE =  'itec801' AND f.CO_YEAR= MAX (f.CO_YEAR)\n  GROUP BY t.I_ID, i.I_FNAME, f.CO_TERMNUMBER, f.CO_YEAR\n  ORDER BY f.CO_YEAR desc \n</code></pre>\n\n<hr>\n\n<p><strong>UPDATED</strong></p>\n\n<hr>\n\n<p>This code is showing the output with latest year but the problem is when it fetches the latest row, counter stops there and it shows 1 value. But i want to count all the row and then only display latest year.</p>\n\n<pre><code>SELECT  t.I_ID, i.I_FNAME, COUNT(f.I_ID) as Cnt, f.CO_TERMNUMBER, f.CO_YEAR\n    FROM \n      INSTRUCTOR i\n    JOIN TEACHINGQUALIFICATION t\n      ON i.I_ID = t.I_ID\n    JOIN COURSE c\n      ON c.C_ID = t.C_ID\n    JOIN COURSEOFFERING f\n      ON i.I_ID = f.I_ID  \n JOIN\n    (\n    SELECT I_ID, MAX(CO_YEAR) LatestYear\n    FROM COURSEOFFERING GROUP BY I_ID\n    ) \n  f2 ON f.I_ID = f2.I_ID AND f.CO_YEAR = f2.LatestYear\n\n    WHERE c.C_TITLE =  'itec801' \n      GROUP BY t.I_ID, i.I_FNAME, f.CO_TERMNUMBER, f.CO_YEAR\n     having  f.CO_YEAR= MAX (f.CO_YEAR)\n      ORDER BY f.CO_YEAR desc \n</code></pre>\n\n<p><strong>New output:</strong></p>\n\n<pre><code>1    Gaurav    1    4   2006\n</code></pre>\n\n<p><strong>Expected output:</strong></p>\n\n<pre><code>1    Gaurav    2    4   2006\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1304,"score":0,"question_id":4582832,"title":"Repair all tables in one go","body":"<p>can anyone tell me how to check all the tables in the database in one go </p>\n\n<p>rather than typing the query  - check table ''tablename''; - for all the tables one by one.</p>\n\n<p>I mean is there any simple command like check all or anything like that..</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","r","data.table","xts","zoo"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":196,"score":3,"question_id":12557762,"title":"Splitting irregular time series into regular monthly averages - R","body":"<p>In order to establish seasonal effects on energy use, I need to align the energy use information that I have from a billing database with monthly temperatures.</p>\n\n<p>I'm working with a billing dataset that has bills of varying lengths and start and end dates, and I'd like to obtain the monthly average for each account within each month.  For example, I have a billing database that has the following characteristics:</p>\n\n<pre><code>   acct amount      begin        end days\n1  2242  11349 2009-10-06 2009-11-04   29\n2  2242  12252 2009-11-04 2009-12-04   30\n3  2242  21774 2009-12-04 2010-01-08   35\n4  2242  18293 2010-01-08 2010-02-05   28\n5  2243  27217 2009-10-06 2009-11-04   29\n6  2243    117 2009-11-04 2009-12-04   30\n7  2243  14543 2009-12-04 2010-01-08   35\n</code></pre>\n\n<p>I would like to figure out how to coerce these somewhat irregular time series (for each  account) to get the average amount per day within each month that is spanned within each bill, such that:</p>\n\n<pre><code>   acct amount      begin        end days avgamtpday\n1  2242  11349 2009-10-01 2009-10-31   31          X\n2  2242  12252 2009-11-01 2009-11-30   30          X\n3  2242  21774 2009-12-01 2010-12-31   31          X\n4  2242  18293 2010-01-01 2010-01-31   31          X\n4  2242  18293 2010-02-01 2010-02-28   28          X\n5  2243  27217 2009-10-01 2009-10-31   31          X\n6  2243    117 2009-11-01 2009-11-30   30          X\n7  2243  14543 2009-12-01 2009-12-31   30          X\n7  2243  14543 2010-01-01 2010-01-31   31          X\n</code></pre>\n\n<p>I'm fairly agnostic to whichever tool can do this, since I only have to do this once.</p>\n\n<p>An additional wrinkle is the table is about 150,000 rows long, which is not really very big by most standards, but big enough to make a loop solution in R difficult.  I've investigated using the zoo, xts, and tempdisagg packages in R.  I started writing a really ugly loop that would split each bill, then create one row for each month within an existing bill, and then tapply() to summarize by accts and months, but honestly, couldn't see how to do it efficiently.</p>\n\n<p>In MySQL, I've tried this:</p>\n\n<blockquote>\n  <p>create or replace view v3 as select 1 n union all select 1 union all select 1;<br>\n  create or replace view v as select 1 n from v3 a, v3 b union all select 1;<br>\n  set @n = 0;<br>\n  drop table if exists calendar; \n  create table calendar(dt date primary key);<br>\n  insert into calendar<br>\n     select cast('2008-1-1' + interval @n:=@n+1 day as date) as dt \n     from v a, v b, v c, v d, v e, v; </p>\n  \n  <p>select acct, amount, begin, end, billAmtPerDay, sum(billAmtPerDay), MonthAmt, \n  count(<em>) Days, sum(billAmtPerDay)/count(</em>) AverageAmtPerDay, year(dt), month(dt)\n     FROM ( select *, amount/days billAmtPerDay \n        from bills b \n           inner join calendar c on dt between begin and end and begin &lt;> dt) x \n  group by acct, amount, begin, end, billAmtPerDay, year(dt), month(dt);</p>\n</blockquote>\n\n<p>But for reasons I don't understand, my server doesn't like this table, and gets hung up on the inner join, even when I stage the different calculations.  I'm investigating if there are any temporary memory limits on it.</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","sql","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":32,"score":-4,"question_id":13207832,"title":"delete multiple products in sql","body":"<p>I have many unused products how can i <strong>delete</strong> all unwanted prodcuts from my site.</p>\n\n<p>So that Server run fast.</p>\n\n<p>tell me some query for this.</p>\n\n<p>I want delete multiple products in single query.</p>\n"},{"tags":["sql","delphi","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13207224,"title":"Running a query and displaying result it in a TEdit","body":"<p>I have a <code>TComboBox</code> containing a list of names gathered from my database. Next to it is a <code>TEdit</code> that I intend on using for the purposes for displaying the ID number associated to each person. </p>\n\n<p>Since firstName and lastName are separate fields within the table, but displayed together in the TCombobox I have written a small section to split the firstName and lastName into two separate variables:</p>\n\n<blockquote>\n<pre><code> pos := AnsiPos(' ', cbStudents.Text); \n firstName := Copy(cbStudents.Text, 0, pos-1);\n lastName := Copy(cbStudents.Text, pos+1, Length(cbStudents.Text));\n</code></pre>\n</blockquote>\n\n<p>Then I execute the SQL code:</p>\n\n<pre><code>  try\n    query.Open;\n    query.SQL.Add('Select studentID');\n    query.SQL.Add('From student');\n    query.SQL.Add('Where firstName = ' + StrToQuote(firstName));\n    query.SQL.Add('And lastName = ' + StrToQuote(lastName));\n    editID.Text := query\n  finally\n    query.Free;\n  end;\n</code></pre>\n\n<p>Note: <code>StrToQuote</code> encapsulates the variable firstName and lastName with double quotes (\" \")</p>\n\n<p>The error that I am receiving is:</p>\n\n<p>Argument out of range</p>\n\n<p>What am I doing wrong? Thank you in advanced for the help.</p>\n"},{"tags":["mysql","sql","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13207618,"title":"MySQL JOIN query -","body":"<p>I know this question has already asked here, but I can't figure this one out from the previous answers.</p>\n\n<p>We've got 2 tables:</p>\n\n<pre><code>members\n-----------------------\n| id | country_iso_3 |\n-----------------------\n  1    USA\n  2    DZA\n  3    FRA\n  4    ILI\n  5    USA\n  6    USA\n\n\nmembers_details\n-----------------------\n| member_id | city    |\n-----------------------\n  1          AA\n  2          BB\n  3          CC\n  4          DD\n  5          EE\n  6          FF\n</code></pre>\n\n<p>Now I want to query members_details and select the cities which are from the same countries, here \"AA\", \"EE\" and \"FF\" should be the results (because the members are from USA)</p>\n\n<p>I know how to compare different cols from different tables, but here we need to check the second table 'member_id' and the first table 'id (country_iso_3)' somehow!</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13202621,"title":"check if record columns have some special values","body":"<p>I want to check to see if some of the fields have some unique values - for instance, I want to check if field1, field2 in my table have a value of \"YES\".  If both of them have \"Yes\" then I want to call some function, but if one of them has \"No\" value then I want to call some other function. Note in my select statement, I am passing an ID from the query-string.  How can I do this?</p>\n\n<pre><code>protected void Check_ItemUpdated(object sender, DetailsViewUpdatedEventArgs e) {\n    SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString);\n    SqlDataAdapter da = new SqlDataAdapter(\"SELECT ID, Field1, Field2 from MyTabel WHERE ID = '\" + Request.QueryString[\"ID\"] + \"'\", con);\n    DataTable dt = new DataTable();\n    da.Fill(dt);\n}\n</code></pre>\n"},{"tags":["c#","sql","sql-server","sql-server-2005","gridview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13207520,"title":"Pagination through Sql query","body":"<p>I am developing an application in which am using grid view. I want to use pagination for that grid view by using sql query.</p>\n\n<p>I want to display records with the help of <code>pagesize</code> and <code>pageindex</code>. </p>\n\n<p>How can I do this with sql query?</p>\n"},{"tags":["sql","oracle","optimization","query-optimization","partitioning"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":76,"score":3,"question_id":13173709,"title":"Optimize Oracle order by query","body":"<p>I have a table with around 5 million rows that look like this:  </p>\n\n<p><strong>Erp_in:</strong></p>\n\n<pre><code>corr_id varchar(50) (almost Unique)\ncorr_type nvarchar(1) (4 distinct values)\ninterface varchar(20) (around 10 distinct values)\nindate DateTime\n</code></pre>\n\n<p>With 3 different index on (corr_id, interface and indate)<br>\nAnd also I have another table which I usally left join with the original table, with about 100000 rows</p>\n\n<p><strong>Erp_In_failed:</strong></p>\n\n<pre><code>corr_id\ninterface\nerror (clob)   \ninput (clob)\n</code></pre>\n\n<p>with index on (corr_id and interface)</p>\n\n<p>The query I want to optimize is Simple as this:</p>\n\n<pre><code>SELECT a.corr_id, a.interface, a.indate, b.error \nFROM erp_in a left join erp_in_failed b on a.corr_id = b.corr_id and a.interface =          b.interface\nOrder by a.indate desc;\n</code></pre>\n\n<p>If I remove the order by, the query isn't taking that long, but ordering the data takes around 3 minutes if not more.</p>\n\n<p>What can I do to optimize the query?\nI was thinking on Partitioning / Removing old data to history table / maybe creating a sequence primary key and order by it or anything else you have in mind...</p>\n\n<p><strong>Edit:</strong><br>\nExecution plan says full table scan, and it's not the join that takes so long it's the order by.<br>\nEven this query takes forever:</p>\n\n<pre><code>SELECT * FROM erp_in\nORDER BY indate;\n</code></pre>\n\n<p>I have tried using Paging, but that doesn't work also, and takes few minutes for 20 results, maybe I am doing it wrong?</p>\n\n<p>If I add WHERE clause on indate field, it uses the index, but only when it is less than 20 days old, anything other than that still uses full table scan. (even with 40 days, adding INDEX hint made the query run faster, but still not enough).</p>\n\n<p>And just for the curiosity, I have a simple table with 1 million rows, and order by takes few seconds, what's the difference? is 1 million is enough to sort it in RAM?</p>\n\n<p>Thanks,</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":9,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3605,"score":1,"question_id":1647736,"title":"T-SQL - GROUP BY with LIKE - is this possible?","body":"<p>Is there a way to include a LIKE expression in a GROUP BY query?  For example:  </p>\n\n<pre><code>  SELECT Count(*) \n    from tblWhatever\nGROUP BY column_x [LIKE %Fall-2009%]\n</code></pre>\n\n<p>column_x:</p>\n\n<pre><code>--------\nBIOL-Fall_2009\nHIST Fall_2009\nBIOL Spring_2009\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>------\nFall_2009   2\nSpring_2009 1\n</code></pre>\n"},{"tags":["mysql","sql","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":35,"score":-1,"question_id":13206691,"title":"SQL Update latest column in master table from transaction table","body":"<p>I have two tables </p>\n\n<pre><code>customer_master\n&gt; cname\n&gt; lastreceiptdate\n&gt; lastreceiptamt\n\naccounts\n&gt; cname\n&gt; date\n&gt; amount\n</code></pre>\n\n<p>I need help in constructing a single update query. where the <code>customer_master</code> table is updated with the latest receipt date and receipt amount for a single customer code (cname like \"FRUITXXXXX\") from accounts table.</p>\n\n<p>It should work in mysql 5.0 and postgresql 9.0</p>\n\n<p>thanks</p>\n\n<p>so far we are using a select command to retrieve a record with max(Date) and then using another update command to update using results from the select query.</p>\n\n<pre><code>update customer_master \nset receiptdate = @_da, receiptamt=@_amt \nwhere cname = @_cn and (receiptdate &lt; @_da or receiptdate='null') \n</code></pre>\n"},{"tags":["mysql","sql","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":35,"score":3,"question_id":13207069,"title":"Invalid use of group function while updating a table with sum function","body":"<p>I have two tables: <code>o_daily_lcsgeneration</code> and <code>o_daily_generation</code>.</p>\n\n<p>While trying to update the <code>o_daily_generation</code> I receive an error saying:</p>\n\n<pre><code>error(1111) invalid use of Group function\n</code></pre>\n\n<p>Here is the code I am running:</p>\n\n<pre><code>update o_daily_generation join o_daily_lcsgeneration \non o_daily_generation.Location =o_daily_lcsgeneration.Location \n   and o_daily_generation.Date =o_daily_lcsgeneration.Date  \nset o_daily_lcsgeneration.Turbine_Generation =sum(o_daily_generation.Turbine_Generation)\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","error-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13205827,"title":"Msg 203, Level 16, State 2, is not a valid identifier","body":"<p>I'm getting the following error:</p>\n\n<blockquote>\n  <p><em>Msg 203, Level 16, State 2, Procedure getQuestion, Line 18</em><br>\n  The name 'select top(1) * from tlb_Question inner join tlb_options on tlb_options.qID=tlb_Question.id and tlb_Question.qNumber=1 and tlb_Question.id not in (0,1)' is not a valid identifier</p>\n</blockquote>\n\n<p>from the following stored procedure:</p>\n\n<pre><code>ALTER proc getQuestion\n    @qNo bigint,\n    @total bigint,\n    @next nvarchar(max)\nas\nbegin \n    declare @hisa bigint\n    set @hisa=@total/3\n\n    if(@qNo&lt;=@total/3)\n    begin\n    declare @query nvarchar(max)\n    set @query=('select top(1) * from tlb_Question \n        inner join tlb_options on tlb_options.qID=tlb_Question.id and tlb_Question.qNumber=1 and tlb_Question.id not in ('+cast(@next as varchar)+')')\n    print @query\n    execute @query\n    end\nend\n</code></pre>\n"},{"tags":["c#","sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13206302,"title":"The DELETE statement conflicted with the REFERENCE constraint","body":"<p>In my project I am filling two database tables with two DataSets. The method which I am using to fill those database tables is shown  below:</p>\n\n<pre><code>SqlCommand sqlCommand = new SqlCommand();            \nSqlCommand command;\nusing (SqlConnection conn = new SqlConnection(strConn))\n{\n    using (SqlCommand cmd = new SqlCommand(strQuery, conn))\n    {\n        using (SqlCommand cmdReset = new SqlCommand(\"DBCC CHECKIDENT('Doctor', RESEED, 0)\", conn))\n        {\n            using (SqlCommand cmdUnCheck = new SqlCommand(\"alter table [dbo].[Doctor] nocheck constraint all\",conn))\n            {\n                using (SqlCommand cmdCheck = new SqlCommand(\"alter table [dbo].[Doctor] with check check constraint all\",conn))\n                {\n                    SqlDataAdapter da = new SqlDataAdapter(cmd);\n                    conn.Open();\n                    SqlTransaction sqlTransaction = conn.BeginTransaction();\n                    cmd.Transaction = sqlTransaction;\n                    cmdReset.Transaction = sqlTransaction;\n                    cmdUnCheck.Transaction = sqlTransaction;\n                    cmdCheck.Transaction = sqlTransaction;\n                    try\n                    {\n                        cmdUnCheck.ExecuteNonQuery();\n           /*ERROR*/    cmd.ExecuteNonQuery();\n                        cmdReset.ExecuteNonQuery();//deleting database table data\n                        foreach (DataRow dr in ds.Tables[0].Rows) //Inserting new data into the Database table\n                        {\n                            command = new SqlCommand(query.createDoctorRow(\"Doctor\",\n                            dr[1].ToString(), dr[2].ToString(), Convert.ToInt64(dr[3]), Convert.ToInt32(dr[4])), conn, sqlTransaction);\n                            command.ExecuteNonQuery();\n                        }\n                        cmdCheck.ExecuteNonQuery();\n                        sqlTransaction.Commit();\n                        conn.Close();\n                    }\n                    catch (Exception e)\n                    {\n                        sqlTransaction.Rollback();\n                        throw;\n                    }\n                }\n            }\n        }\n    }                \n}\n</code></pre>\n\n<p>The above code was working fine till the second Database table was empty but when I inserted some data in it and then run the code, VS is showing error --> </p>\n\n<blockquote>\n  <p>The DELETE statement conflicted with the REFERENCE constraint \"FK_Dr_ID\". The conflict occurred in database \"Hospital\", table \"dbo.Patient\", column 'Doctor_ID'.\n  The statement has been terminated.</p>\n</blockquote>\n\n<p>This seems clear that the foreign key is restricting the query to take place but as I am a beginner and dont know what to do I am asking your help..</p>\n\n<p>In the above code I made changes referring to this <a href=\"http://stackoverflow.com/a/1566552/1577396\">SO answer</a> but no joy, the error still exists at the same point.</p>\n\n<p><em>Optional</em>: Is there anyway to reduce the <code>using</code> statements in my code?</p>\n"},{"tags":["sql","architecture","connection-string"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13197105,"title":"SQL connection string broker","body":"<p>My company has a lot of SQL instances with a lot of databases on each instance. Those instances are referenced by a lot of custom code in a lot of different web and application servers. The technology stack on any given server can be at various stages of the lifecycle. It's a maintenance nightmare. I'm in the process of migrating a SQL 2000 instance with thousands of unorganized tables and an unknown set of apps hitting these tables.</p>\n\n<p>I realize my problem is a poorly architected and implemented infrastructure but there's nothing I can do about that right now. What I'm considering is setting up some type of central connection string broker that serve connection strings. Applications will call the broker to get the appropriate connection string.</p>\n\n<p>I guess my first question is - does anything like this exist? I'd much rather drop into an existing solution than roll my own. If not, what's the simplest, most transparent approach for creating something to handle this?</p>\n\n<p>My first thought at a solution is a REST web service running on a load balanced web server that stores the underlying connections in some type of configuration file.</p>\n\n<p>I would appreciate any ideas or potential tools to use.</p>\n"},{"tags":["sql","group-by","distinct"],"answer_count":18,"favorite_count":13,"up_vote_count":25,"down_vote_count":0,"view_count":9544,"score":25,"question_id":164319,"title":"Is there any difference between GROUP BY and DISTINCT","body":"<p>I learned something simple about SQL the other day:</p>\n\n<pre><code>SELECT c FROM myTbl GROUP BY C\n</code></pre>\n\n<p>Has the same result as:</p>\n\n<pre><code>SELECT DISTINCT C FROM myTble\n</code></pre>\n\n<p>What I am curious of, is there anything different in the way an SQL engine processes the command, or are they truly the same thing?  </p>\n\n<p>I personally prefer the distinct syntax, but I am sure it's more out of habit than anything else.</p>\n\n<p>EDIT: This is not a question about aggregates. The use of <code>GROUP BY</code> with aggregate functions is understood.</p>\n"},{"tags":["sql","ruby-on-rails","case-insensitive"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13204957,"title":"Rails / SQL: Find attributes with same value but different capitalization","body":"<p>This may be really basic, but I can't think of how to write a SQL query that would find strings that have the same characters but different capitalization.</p>\n\n<p>The context I'm working on is a Rails 3.2 app. I have a simple Tag model with a Name attribute. I've inherited data for this model that did not store values case-insensitively, so some users input things like \"Tree\" while others input \"tree\" and now we have two tags that really should be one.</p>\n\n<p>So, I'd like to do a query to find all these pairs so that I can go about merging them.</p>\n\n<p>The only thing I can think of so far is to write a rake task that loops through them all and checks for matching values... something like:</p>\n\n<pre><code>pairs = []\nTag.all.each do |t|\n  other = Tag.where( 'name LIKE ?', t.name )\n  pairs &lt;&lt; [t, other] if other\nend\n</code></pre>\n\n<p>However, I'm not sure the above would work, or that it makes sense performance-wise. Is there a better way to write a SQL query that would find these matching pairs?</p>\n"},{"tags":["sql","odbc"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13206626,"title":"creating sql script to import oracle database into ms access","body":"<p>We currently have a procedure at work where we import data from an Oracle database into a MS Access 2007 database. </p>\n\n<p>We start by creating a blank access database labelled as the days day (dd/mm/yy), then import ODBC database entering a username and password finally selecting the tables required.</p>\n\n<p>I am trying to find a way of streamlining this process, maybe with sql script.\nIs this possible?</p>\n\n<p>I have a basic sql understanding, creating scripts to query/insert in tables, but i am unsure where to start with this project.</p>\n\n<p>any help would be much appreciated.</p>\n"},{"tags":["sql","mysql","delete"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1438,"score":2,"question_id":2008916,"title":"DELETE data from a table, joining through two tables","body":"<p>I'm working with some rather sensitive data, so I want to be ABSOLUTELY sure I am doing it properly.</p>\n\n<p>I am trying to delete the rows in a table that are associated with another table</p>\n\n<p>The only way to associate the table is to join through two other tables...</p>\n\n<p>here is the exact query:</p>\n\n<pre><code>DELETE tt.Transaction_Amount, tt.Transaction_ID\n  FROM ItemTracker_dbo.Transaction_Type tt\n  JOIN ItemTracker_dbo.Transaction t ON tt.Transaction_ID = t.Transaction_ID\n  JOIN ItemTracker_dbo.Purchase p ON p.Transaction_ID = tt.Transaction_ID\n  JOIN ItemTracker_dbo.Item i ON i.Item_ID = p.Item_ID\n WHERE i.Client_ID = 1\n</code></pre>\n\n<p>As you can see, it ain't pretty.</p>\n\n<p>I'm getting an odd error though through the MySQL query browser...</p>\n\n<blockquote>\n  <p>Unkown table 'Transaction_Amount' in MULTI DELETE</p>\n</blockquote>\n\n<p>I've tried reading the mysql manual and it seems like this should work to me... any one have any idea's?</p>\n"},{"tags":["sql","type-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13206417,"title":"Error converting data type varchar to numeric in SQL","body":"<p>I have an <code>nvarchar</code> field in my SQL table where column <code>KPI_WT</code> stores int/decimal values for different employees, i.e. 5,10,7.5 etc.\nI am running a query to get sum of KPI_WT for different employees as follows :</p>\n\n<pre><code>select EMP_CODE , SUM(CONVERT(decimal(5,2), KPI_WT) )\nfrom Table_1\ngroup by EMP_CODE\n</code></pre>\n\n<p>It is giving me following error :\n<code>'Error converting data type nvarchar to numeric.'</code></p>\n\n<p>I have also tried to cast the <code>KPI_WT</code> column to decimal, numeric but to no avail. How to fix this?</p>\n"},{"tags":["php","mysql","sql","sql-order-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13205928,"title":"ORDER BY with WHERE","body":"<p>I can't seem to get ORDER BY to work with my current MySQL Query I'm using!</p>\n\n<pre><code>$query = \"SELECT * FROM games WHERE game_platform = '$gameType' ORDER BY ASC\";\n\n$result = mysql_query($query);\n</code></pre>\n\n<p>I just get the following error.</p>\n\n<p>Warning: </p>\n\n<blockquote>\n  <p>mysql_fetch_assoc() expects parameter 1 to be resource, boolean given\n  in</p>\n</blockquote>\n"},{"tags":["sql","vba","ms-access","ms-access-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12930401,"title":"Record source and control source in ms access","body":"<p>I am creating a continuous form in MS Access 2010. In the details section of the form, I have two text boxes (named txtProj and txtArtifact). </p>\n\n<p>There are 2 tables in the database. \ntblProject and tblArtifact. </p>\n\n<pre><code>tblProject has [Project ID] - autonumber and [Project Name] - string.\ntblArtifact has [Artifact ID] - autonumber, [Project] - number and [Artifact Name] - string. \n</code></pre>\n\n<p><code>[Project ID]</code> and <code>[Project]</code> are related by one-to-many relationship.</p>\n\n<p>The Record Source for the form is tblArtifact. Now, in the textbox named txtProject, I want to display name of the project, rather than Project ID. </p>\n\n<p>I am not able to figure out, how to refer to a control source of a table, which is not record source of the form.</p>\n\n<p>Please help me. </p>\n\n<p>I would be happy to provide any additional details, if required.</p>\n\n<p>Thanks in anticipation.</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13206134,"title":"Combine multiple SQL queries in 1","body":"<p>I kinda got stuck at trying to combine a few queries.\nWhat I got is the table holding sort of statistics and reference to another table.</p>\n\n<p>to get statistics report I'm running (short version):</p>\n\n<pre><code>SELECT COUNT(id) \nfrom [Actions] \nwhere date between '2012-01-01 00:00:00' AND '2012-01-01 23:59:59' \n  AND [Action]='request'\n</code></pre>\n\n<p>The question is if I want to get every-day statistics during the specified time period, how should this query look like? I understand if I change start and end dates, I'll get statistics for the whole specified period and not grouped by day. What am I missing?</p>\n"},{"tags":["sql","sql-server"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13091850,"title":"How to sort data before joining","body":"<p>Trying to do a diff of 2 tables with same data layout and have mismatch records on sameline</p>\n\n<pre><code>Table1                   Table2\n------                   ------\n\nCUSTOMER PART            CUSTOMER  PART\n\nCUSTID1  PART1           CUSTID1  PART1\nCUSTID1  PART2           CUSTID1  PART2\nCUSTID1  PART3           CUSTID1  PART3\nCUSTUD1  PART4\n\n\nSELECT T1.CUSTID, T1.PART, T2.CUSTID, T2.PART FROM TABLE1 AS T1\nLEFT JOIN TABLE2 AS T2 ON T1.CUSTID = T2.CUSTID\nWHERE  T1.PART &lt;&gt;  T2.PaRT\nORDER BY T1.CUSTID \n</code></pre>\n\n<p>Sometimes the output look like below - it shows a mismatch when there isn't one.\nCAn I order the tables before the join to get the data to line up ?</p>\n\n<p>Thanks</p>\n\n<pre><code>CUSTID1  PART1           CUSTID1  PART3\nCUSTID1  PART2           CUSTID1  PART1\nCUSTID1  PART3           CUSTID1  PART2\nCUSTUD1  PART4           NULL     NULL\n</code></pre>\n"},{"tags":["mysql","sql","phpmyadmin","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":59,"score":0,"question_id":13205736,"title":"multiple attribute query from mysql","body":"<p>i have a question here... i have a 3 tables like this...</p>\n\n<p>customer</p>\n\n<pre><code>idCustomer | namaCustomer | email   | noTelp \n__________________________________________________\n1          |  Wawan       | a@a.com | 08985623895\n</code></pre>\n\n<p>attribute</p>\n\n<pre><code>idAttribute | Name   | publish\n______________________________\n1           | Gender |  Y\n2           | Hobby  |  Y\n3           | Job    |  Y\n4           | Mission|  N\n</code></pre>\n\n<p>Customer attribute</p>\n\n<pre><code>idCustomer  |  idAttribute   | value \n_____________________________________\n1           |   1            | Male\n1           |   2            | Hacking\n1           |   3            | IT Support\n</code></pre>\n\n<p>The question is.. what query statement if i want to get the query from that 3 tables and get the result like this</p>\n\n<pre><code>idCustomer | namaCustomer | email   | noTelp      | Gender  | Hobby   | Job\n___________________________________________________________________________________\n1          |  Wawan       | a@a.com | 08985623895 | Male    | Hacking | IT Support\n</code></pre>\n\n<p>So the table column was added from customer attribute data, but before that we must look attribute tabel that the attribute is published or not (looking for publish value) </p>\n\n<p>anyone can help me here???</p>\n\n<p>great thanks before</p>\n"},{"tags":["java","mysql","sql","swing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13205689,"title":"Java, MySQL updating table using ID (primary key)","body":"<p>I have a program in which working with MySql and Java JDBC.</p>\n\n<p>My question is:</p>\n\n<p>I have a table (<code>TEMP</code>) with <code>ID</code> as only 1 column and another table with user personal details like ID, name, age etc.. </p>\n\n<p>Im trying to retrieve the <code>ID</code> from <code>TEMP</code> table and update unfilled information like name, age, address etc in <code>USER</code> table.</p>\n\n<p>This is the query I wrote:</p>\n\n<pre><code>update m_auth_info \nset name  = '\"+name+\"', \n    addr  = '\"+addr+\"', \n    email = '\"+email+\"', \n    affiliation = '\"+affil+\"', \n    status = '\"+1+\"'  \nwhere a_id = '\"+ResultSet+\"'\";\n</code></pre>\n\n<p>and when my <code>getIdMethod</code> retrieves ID into <code>ResultSet</code> from <code>TEMP</code> table. I couldn't able to update <code>USER</code> TABLE. </p>\n\n<p>But it works if I give ID directly.. example.</p>\n\n<pre><code>update m_auth_info \nset name = '\"+name+\"', \n    addr = '\"+addr+\"', \n    email = '\"+email+\"', \n    affiliation = '\"+affil+\"', \n    status = '\"+1+\"'  \nwhere a_id = '\"+8989+\"'\";\n</code></pre>\n\n<p>Please tell me if I have to write which step to write in my <code>getIdMethod</code>, so that ill get the value into <code>ResultSet</code>.</p>\n"},{"tags":["java","sql","jdbc","resultset"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":87,"score":4,"question_id":13205500,"title":"Is a generic sql query possible in java?","body":"<p>If I have a method to create SQL queries, as below :</p>\n\n<pre><code>public List selectTuple() {\n   boolean status = true;\n   String query = \"SELECT \";\n   query += getFields() == null ? \" * \" : \" \" + getFields() + \" \";\n   query += \" FROM \" + tables;\n   if ( getSearchClause() != null ) {\n       query += \" \" + getSearchClause();\n   }\n   query += \";\";\n   Debug(\"SQL...........caleed selectTuple method, query is : \"+ query);\n   setQuery(query);\n   if ( getPrepared() ) {//If this is a Prepared query,\n      status = setPreparedStatement();\n   } else {\n      status = setNonPreparedStatement();\n   }\n   if ( ! status ) {\n      Log(\"[CRITICAL] (.........)..........\");\n   }\n   status = doExecuteQuery();\n   if ( ! status ) {\n      Log(\"[CRITICAL] (.........)..........\");\n   }\n   return( getResults() );\n}//method selectTuple\n</code></pre>\n\n<p>However, since this will be used for different tables, the fields will be of different data types (int, string, date etc). So how can I iterate through such a ResultSet ?</p>\n\n<p>Also, how can I create such an Insert query ?</p>\n\n<p>Thanks. </p>\n"},{"tags":["c#","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":89,"score":0,"question_id":13196496,"title":"Rollback changes when code not executed properly","body":"<p>I am new to SQL, In my project I am trying to fill the DataSet from the DataBase table and then inserting new rows in DataSet. After doing this, again I am filling the Database table with the DataSet data. Before filling I am clearing or deleting the Database table data. Well I achieved this by using the below code:</p>\n\n<pre><code>Database Table --&gt; myTable\nDataSet --&gt; ds\n</code></pre>\n\n<hr>\n\n<p><strong>OnButtonClick</strong></p>\n\n<pre><code>   string strQuery = \"delete from [dbo].[myTable]\"\n   SqlConnection conn = new SqlConnection(strConn);\n   SqlCommand cmd = new SqlCommand(strQuery, conn);\n   SqlCommand command;\n   SqlDataAdapter da = new SqlDataAdapter(cmd);\n   using (cmd)\n   {\n      using (conn)\n      {\n         conn.Open();\n         cmd.ExecuteNonQuery();                    //deleting database table data\n         foreach (DataRow dr in ds.Tables[0].Rows) //Inserting new data into the Database table\n         {\n             command = new SqlCommand(InsertQuery, conn);\n             command.ExecuteNonQuery();\n         }\n         conn.Close();\n      }\n   }\n</code></pre>\n\n<p>The above code is working fine but when there is any exception in <code>command</code> sqlCommand then it is deleting the database table completely and not filling the DataSet. Any suggestions to modify this code? please help.</p>\n\n<p>UPDATE:</p>\n\n<pre><code>            string strQuery = \"delete from [dbo].[myTable]\";\n            using (SqlCommand cmd = new SqlCommand(strQuery, conn))\n            {\n                using (SqlCommand cmdReset = new SqlCommand(\"DBCC CHECKIDENT('myTable', RESEED, 0)\", conn))\n                {\n                    SqlDataAdapter da = new SqlDataAdapter(cmd);\n                    conn.Open();\n                    SqlTransaction sqlTransaction = conn.BeginTransaction();\n                    cmd.Transaction = sqlTransaction;\n                    try\n                    {\n                        cmd.ExecuteNonQuery();                   //deleting database table data\n                        cmdReset.ExecuteNonQuery();               //Resetting Identity of first column\n                        foreach (DataRow dr in ds.Tables[0].Rows) //Inserting new data into the Database table\n                        {\n                            command = new SqlCommand(query.createDoctorRow(InsertQuery, conn);\n                            command.ExecuteNonQuery();\n                        }\n                        sqlTransaction.Commit();\n                        conn.Close();\n                    }\n                    catch (Exception e)\n                    {\n                        sqlTransaction.Rollback();\n         /*ERROR*/      throw;  \n                    }\n                }\n            }\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>ERROR -->  \"ExecuteNonQuery requires the command to have a transaction when the connection assigned to the command is in a pending local transaction.  The Transaction property of the command has not been initialized.\"</p>\n</blockquote>\n"},{"tags":["sql","sql-server-2008","search"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13205487,"title":"Match \"word\"s or \"word\"(s)","body":"<p>I am query a data set using <code>field like '%search%'</code> in MS-SQL.  My data often times will contain values like <code>words</code> and <code>word(s)</code>.  I would like to be able to allow users to search for either of those values and get both of them back.  So searching for <code>words</code> would return both results containing <code>words</code> and <code>word(s)</code>, and visa-versa.</p>\n\n<p>Is there a good way of doing this?  Or do I just need to detect in code that the search ends in an <code>s</code> or <code>(s)</code> and update the search accordingly?</p>\n"},{"tags":["sql","oracle","oracle10g"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":135,"score":0,"question_id":7467438,"title":"How to move a table from system schema to scott schema in Oracle?","body":"<p>In some days ago...i was converting some Large MySQL Database to Oracle 10g R2 by using Oracle SQL Developer database migration tools.But unfortunately it was migrated on system schema.but i need to it on scott schema.\nAfter Googling i found this two links <a href=\"http://www.orafaq.com/forum/t/96818/2/\" rel=\"nofollow\">OraFAQ Forum</a> and <a href=\"http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:752030266230\" rel=\"nofollow\">ASK TOM Q&amp;A</a>.But I cannot find any appropriate answer. Any one Can help me to do , How it is possible.</p>\n\n<p>Thanks In Advance.</p>\n"},{"tags":["sql","sybase","sqlanywhere","dynamic-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12452128,"title":"Cannot Discern Apparent SQL Invalid Expression","body":"<p>I tried to run a dynamically generated SQL query within PHP targeting an Sybase SQL-Anywhere database and I got the following error:</p>\n\n<p><code>Warning: mssql_query(): message: SQL Anywhere Error -680: Invalid expression in WHERE clause of Transact-SQL outer join (severity 16) in /path/to/file.php</code></p>\n\n<p><strong>SQL Query String:</strong></p>\n\n<pre><code>SELECT DISTINCT v_InventoryMaster.INV_ScanCode, v_InventoryMaster.INV_ReceiptAlias \nFROM ecrs.v_InventoryMaster, ecrs.StockInventoryLinkDiscounts\nWHERE StockInventoryLinkDiscounts.ILD_INV_FK = v_InventoryMaster.INV_PK \nAND ( v_InventoryMaster.INV_DPT_FK = 9\n  AND v_InventoryMaster.INV_PI1_FK = 118\n  AND ( StockInventoryLinkDiscounts.ILD_DIS_FK IN( 14,6,8,9,10,11,12,17,18,4,2,7,15,16)\n    OR v_InventoryMaster.INV_PK NOT IN (\n      SELECT DISTINCT v_InventoryMaster.INV_PK \n      FROM ecrs.v_InventoryMaster, ecrs.StockInventoryLinkDiscounts\n      WHERE v_InventoryMaster.INV_PK = StockInventoryLinkDiscounts.ILD_INV_FK\n      AND StockInventoryLinkDiscounts.ILD_DIS_FK IN(13,5) \n    )\n  )  \n)\nORDER BY v_InventoryMaster.INV_ScanCode\n</code></pre>\n\n<p>I'm not completely new to SQL or interfacing with a database, but this message has me stumped. It claims that there is an invalid expression in the <code>WHERE</code> clause, probably the outer one, but I can't see how the query is illegally structured.</p>\n"},{"tags":["php","sql","codeigniter","iis-7.5","php-5.4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13203917,"title":"Unable to connect using sqlsrv on PHP 5.4 but works for 5.3","body":"<p>After upgrading to PHP 5.4 and using CodeIgniter's PHP framework my application refused to connect to the SQL Server 2005 database. There were no configuration changes performed, and I made sure to install the PHP SQLSRV drivers (3.0.3) as well. The specific message from CI was \"Unable to connect to your database server using the provided settings\".</p>\n\n<p>Switch back to PHP 5.3 and everything works.</p>\n\n<p>To make sure that the sqlsrv drivers are installed on PHP 5.4 I ran <code>php -m</code> and it displays \"sqlsrv\". phpinfo() looks good as well.</p>\n\n<p>I can't get any debug information on how/why sqlsrv isn't connecting with the new drivers. What's funny is that if I download sqlsrv-5.4-nts-snap.zip from <a href=\"http://downloads.php.net/pierre/\" rel=\"nofollow\">this funny page of drivers on MS's site</a> - then it works! However it seems to be using sqlsrv 2.0 drivers.</p>\n\n<p>Does SQLSRV work on PHP 5.4?</p>\n"},{"tags":["mysql","sql","database","schema","normalization"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13204690,"title":"Combine or Separate Tables","body":"<p>I'm confused on whether I should combine two tables or leave them separated. The ff is just one set of that problem of mine:</p>\n\n<pre><code>tblPhone(Phone_ID, Phone_Number, Phone_Type_ID, Person_ID)\ntblPhone(Phone_Type_ID, Phone_Type_Name)\n</code></pre>\n\n<p>or</p>\n\n<p>I should simply have it as:</p>\n\n<pre><code>tblPhone(Phone_ID, Phone_Number, Phone_Type_Name, Person_ID)\n</code></pre>\n\n<p><strong>Does one have advantage over the other?</strong> Is there like a <strong>standard guideline or practice</strong> for table creation? For example, I remember someone telling me if a table isn't 3 or more, just combine it to another table, something like that...how true is that? I remember a little bit of normalization rules...but it can be very confusing at times. I think this falls on the third normalization rule that's why they should be separated, am I mistaken? Thanks!</p>\n"},{"tags":["mysql","sql","insert"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13204445,"title":"Using MySQL session variable to increment a sort order / weight on Insert","body":"<p>Alright, my brain is a bit done for today and I might be approaching this completely wrong, so I'm hoping someone can give me a bit of insight on this.  </p>\n\n<p>I'm running an insert, through a loop in my code, though I'm wanting to use MySQL Session variables to increment the sort_order.</p>\n\n<p>Maybe I'm just overthinking, any suggestions?  The table is recursive, so it does have parent/child elements, so doing something like <code>SELECT MAX(sort_order)</code> wouldn't work unless explicitly defining the parent id..which could work.  Well talked myself out of that one, still curious.</p>\n\n<pre><code>INSERT INTO another_table (some_field, sort_order)\nVALUES\n    (\n        'some field value',\n        (\n            SELECT\n                @sort_order := @sort_order + 1 sort_order\n            FROM \n                (SELECT @sort_order := 0) so  \n        )\n    )\n</code></pre>\n"},{"tags":["c#","sql","linq-to-sql","datacontext"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13204076,"title":"System.InvalidOperationException: An entity can only be attached as modified","body":"<p>am trying to update table called \"Hero\" , am using <code>DataContext</code> , here is how the codes looks like:-</p>\n\n<pre><code>//linq to sql table (automatic generated)\n[global::System.Data.Linq.Mapping.TableAttribute(Name=\"dbo.Hero\")]\n    public partial class Hero : INotifyPropertyChanging, INotifyPropertyChanged\n    {\n          //fields methods etc..\n    }\n</code></pre>\n\n<p>and there is my own partial class Hero ...</p>\n\n<pre><code>    public partial class Hero : IHero {\n           //my fields and methods etc...\n\n            public void Save() {\n                using(GameDBDataContext db = new GameDBDataContext()) {\n                    db.Heros.Attach(this, true);\n                    db.SubmitChanges();\n                }\n        }\n}\n</code></pre>\n\n<p>but it's throwing this :- </p>\n\n<pre><code>System.InvalidOperationException: An entity can only be attached as modified without original state if it declares a version member or does not have an update check policy.\n</code></pre>\n\n<p>what is the solution for this problem?</p>\n\n<p>EDIT: I have tried this :-</p>\n\n<pre><code>public void Save() {\n    using(GameDBDataContext db = new GameDBDataContext()) {\n        db.Heros.Attach(this, db.Heros.SingleOrDefault(x =&gt; x.id == EntityID));\n    }\n}\n</code></pre>\n\n<p>and it throws :- <code>System.NotSupportedException: An attempt has been made to Attach or Add an entity that is not new, perhaps having been loaded from another DataContext.  This is not supported.</code></p>\n"},{"tags":["c#","sql","xsd"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13203292,"title":"Updating table adapter config reference error","body":"<p>When I try to update a project that was written last year, I am running into problems.</p>\n\n<p>I click configure on the xsd table adapter configuration and after my select statement I get:</p>\n\n<pre><code>Could not load file or assembly 'microsoft.sql.server.types, version = 11.0.0.0,\nculture=neutral,publickeytoken=89845dcd8080cc91 or one of its dependencies.\n</code></pre>\n\n<p>What is odd to me is that I can do a preview of the data and see the sample select, but I can not do a configure from the gui.</p>\n\n<p>I included the file <code>C:\\Program Files (x86)\\Microsoft SQL Server\\100\\SDK\\Assemblies\\Microsoft.SqlServer.Types.dll\nv. 10.0.0.0</code></p>\n\n<p>I have installed SQL Server 2008 R2 SP1.  Where can I find version 11 and why does the select work but not configure?</p>\n"},{"tags":["sql","oracle"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1045,"score":0,"question_id":7019197,"title":"Oracle SQL: Get the last eight months of data (with YEAR and MONTH columns)","body":"<p>I have a table that has columns YEAR and MONTH, which are varchars, which have a format like MONTH = '02', YEAR = '2011'.</p>\n\n<p>What query can I use to get the last eight months of data, excluding the current month?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13204080,"title":"Oracle SQL - Grouping by CASE","body":"<p>I have the following query:</p>\n\n<pre><code>Select Player_Id,\nPt_Credit As Total_Points\nFrom Player \nWhere Trunc(Create_Dtime) = Trunc(Sysdate) - 90\nAnd Trunc(Init_Dtime) &gt;= To_Date('2012-sep-1','yyyy-mon-dd')\nOrder by Total_Points Desc\n</code></pre>\n\n<p>Which gives me this result:</p>\n\n<pre><code>Player_ID      TOTAL_POINTS\n  23452         1500\n  23494         1000\n  30934         500\n</code></pre>\n\n<p>and so on. I want to group these player_ids results into groups like 0-300 points, 301-600 points, 601-900 points , and greater than 900 points...so it would look like this in the results:</p>\n\n<pre><code>Point_Level     Count(Player_ID)\n0-300            532\n301-600          444\n601-900          669\n&gt;900             185\n</code></pre>\n"},{"tags":["sql","database"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13203638,"title":"Lossless Decomposition","body":"<p>Consider a schema R(A, B, C, D) and functional dependencies A ⟶ B and C ⟶ D. Then why isn't the decomposition of R into R1(A, B) and R2(C, D) a lossless decomposition? Can you please explain with real life example that what info is lost here?</p>\n"},{"tags":["sql","sql-server","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13203682,"title":"I am stuck on creating constraint on SQL Server","body":"<p>I am totally new to SQL Server management, I tried to add a constraint in a table.</p>\n\n<p>The situation is that I created a column with <strong>only 'Y'or 'N' allowed to be valued</strong>.</p>\n\n<p>So I tried to create a constraint in Management Studio by right clicking \"Constraints\" in the table.</p>\n\n<p>However, I really have no idea about the syntax of creating a constraint. Finally, I tried to input the code into \"Check Constraint Expression\" window by referring the template from the Internet. The SQL Server always tell me \"Error Validating constaint\".</p>\n\n<p>Can you guys just help me to write the first constraint for me? Because I really dont know how to start.</p>\n\n<p>My requirement is:</p>\n\n<pre><code>I have a table called \"Customer\"\nI created a column called \"AllowRefund\"\nThe column \"AllowRefund\" is only allowed to 'Y' or 'N'\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["python","sql","mongodb","pymongo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13203294,"title":"MongoDB and PyMongo - SQL like columns","body":"<p>I have a MySQL database with a table called <strong><em>sources</em></strong>, there I have two columns called <strong><em>srctype</em></strong> and <strong><em>url</em></strong> where srctype is a name (e.g: Hello) and url is an url (e.g: <a href=\"http://google.com\" rel=\"nofollow\">http://google.com</a>)</p>\n\n<p>In Python using SQLAlchemy, I could filter the srctype and get a list of the urls, for example; </p>\n\n<pre><code>src = \"hello\"    \nlinks = session.query(sources).filter_by(srctype=src).all()\n</code></pre>\n\n<p>Easy, now I am migrating this data to a MongoDB, for this I am using <strong><em>pymongo</em></strong>.</p>\n\n<p>I have a function where it saves the srctype and url to mongodb's database</p>\n\n<pre><code>    def insertSources(self, srctype, link):\n        \"\"\" Insert rss sources so we can parse them \"\"\"\n        new = {srctype: link}\n        self.__sources.insert(new)\n</code></pre>\n\n<p>and a function that retrieves the srctype</p>\n\n<pre><code> def getSources(self, type=None, single=True): # type == srctype\n    if type:\n        if single:\n            return self.__sources.find_one()\n        else:\n            return iter(self.__sources.find({srctype:type}))\n    else:\n        if single:\n            return self.__sources.find_one()\n        else:\n            return iter(self.__sources.find())\n</code></pre>\n\n<p>The problem here is, since there is no column called srctype and no column called url, how can I do the same as the SQLAlchemy/MySQL example?</p>\n\n<p>In MySQL would be;</p>\n\n<pre><code>SELECT * FROM sources WHERE srctype=\"hello\"\n</code></pre>\n\n<p>I wonder how will that be in the retrieve function I have (also in the insert function, since I am not sure if what I did there is correct for the job I want). In the <em>insertSources</em> function I simple add a <em>dict</em> to MongoDB, clearly I won't be able to get the srctype in the getSources function, since srctype in MongoDB is no column. \nAny help would be great. </p>\n"},{"tags":["sql","sql-server","naming-conventions"],"answer_count":36,"favorite_count":51,"up_vote_count":187,"down_vote_count":0,"view_count":38806,"score":187,"question_id":338156,"title":"Table Naming Dilemma: Singular vs. Plural Names","body":"<p>Convention has it that table names should be the singular of the entity that they store attributes of.  </p>\n\n<p>I dislike any T-SQL that requires square brackets around names, but I have renamed a <code>Users</code> table to the singular, forever sentencing those using the table to sometimes have to use brackets.  </p>\n\n<p>My gut feel is that it is more correct to stay with the singular, but my gut feel is also that brackets indicate undesirables like column names with spaces in them etc.</p>\n\n<p>Should I stay, or should I go?</p>\n"},{"tags":["sql","entity-framework-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13203469,"title":"Entity Framework - Update many to many relationships","body":"<p>I'm having a problem attempting to update a Many to Many type relationship in my table.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>            foreach (ThingCategory category in this.unit.Context.ThingCategories.Where(c =&gt; c.ThingId == thingId))\n            {\n                if (this.unit.Context.Entry(category).State == EntityState.Detached)\n                {\n                    this.unit.Context.ThingCategories.Attach(category);\n                }\n\n                this.unit.Context.ThingCategories.Remove(category);\n            }\n\n            foreach (ThingCategory category in categories)\n            {\n                if (this.unit.Context.Entry(category).State == EntityState.Detached)\n                {\n                    this.unit.Context.ThingCategories.Attach(category);\n                    this.unit.Context.Entry(category).State = EntityState.Added;\n                }\n                else\n                {\n                   this.unit.Context.Entry(category).CurrentValues.SetValues(category);\n                   this.unit.Context.Entry(category).State = EntityState.Modified;\n                }\n            }\n\n            this.unit.Context.SaveChanges();\n</code></pre>\n\n<p>I'm getting:</p>\n\n<blockquote>\n  <p>An object with the same key already exists in the ObjectStateManager.\n  The ObjectStateManager cannot track multiple objects with the same\n  key.</p>\n</blockquote>\n\n<p>The ThingCategory entity uses a composite primary key made from a ThingId and CategoryId.</p>\n\n<p>Can someone please point me in the right direction to doing this the right way?</p>\n\n<p>Thanks,</p>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13198812,"title":"SQL Merge with two stage match","body":"<p>I want to merge two tables using SQL Server on the following basis:</p>\n\n<p>IF the primary key (Operation) matches THEN\n    If Source Date Matches Target Date\n        Do nothing\n    Else\n        SET Target Revised_Date to Source Date\nElse\n    Insert Target Row from Source Row</p>\n\n<p>I have built an SQL merge below that does the first stage but can't see how to do the second stage.</p>\n\n<pre><code>MERGE \n    Completed_Operations AS target\nUSING \n    @Completed_Operation_Table AS source ON (target.Operation = source.Operation)\nWHEN MATCHED THEN \n    UPDATE \n    SET target.Revised_Completion_Date  = source.Completion_Date,\n            target.Revised_Pln_Hrs          = source.Pln_Hrs,\n            target.Revised_Pln_Hrs_Capped   = source.Pln_Hrs_Capped,\n            target.Revised_Act_Hrs          = source.Act_Hrs\nWHEN NOT MATCHED THEN   \n    INSERT (Operation, Orig_Completion_Date, Orig_Pln_Hrs, Orig_Act_Hrs, Revised_Completion_Date, Revised_Pln_Hrs, Revised_Act_Hrs)\n    VALUES (source.Operation, source.Completion_Date, source.Pln_Hrs, source.Act_Hrs, NULL, NULL, NULL);\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13203108,"title":"Conditionally setting variable with case statment","body":"<p>I have the following query. I am trying to only add the values, if the value is not null so the whole variable doesnt end up as a null. Obviously this query below is erroring out, but I do not want to use an ISNULL check on the test column because it puts a comma at the end of the variable text. How would I do this without having the comma at the end of the variable text. Sometimes there will be nulls in the test column, and sometimes there will not be.</p>\n\n<pre><code>DECLARE @Test TABLE\n(\n    test varchar(20)\n)\n\nINSERT INTO @Test\nSELECT 'adfasdfasd'\nUNION ALL\nSELECT NULL\n\n\nDECLARE @DocID varchar(max)\n\nSELECT CASE WHEN test IS NOT NULL THEN @DocID = COALESCE(@DocID + ',' ,'')  + test END\nFROM @Test\n\nSELECT @DocID\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13203223,"title":"custom query to show records with duplicate count with its duplicate occurance","body":"<p>Please refer below script</p>\n\n<pre><code>            declare @table1 table\n            (\n            col1 int\n            )  \n\n            insert into @table1 values(1)\n            insert into @table1 values(3)\n            insert into @table1 values(3)\n            insert into @table1 values(6)\n            insert into @table1 values(4)\n            insert into @table1 values(4)\n            insert into @table1 values(4) \n</code></pre>\n\n<p>The below query gives </p>\n\n<pre><code>            select col1 ,COUNT(col1) cntCol1 from @table1 group by col1\n</code></pre>\n\n<p>this output</p>\n\n<pre><code>            ----------------\n            col1   | cntCol1\n            -------| -------\n            | 1    | 1    | \n            | 3    | 2    | \n            | 4    | 3    | \n            | 6    | 1    | \n            ---------------\n</code></pre>\n\n<p>is it possible to get the below output</p>\n\n<pre><code>            ----------------\n            col1   | cntCol1\n            -------| -------\n            | 1    | 1    | \n            | 3    | 1    | \n            | 3    | 2    |  \n            | 4    | 1    |  \n            | 4    | 2    |  \n            | 4    | 3    | \n            | 6    | 1    | \n            ---------------\n</code></pre>\n\n<p>If so, could you please help me with the query.</p>\n\n<p>Thanks, \nEsen.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13202809,"title":"Adding rows to SQL query for each element in WHERE sequence","body":"<p>I have an SQL query like the following:</p>\n\n<pre><code>SELECT store_id, SUM(quantity_sold) AS count\nFROM sales_table\nWHERE store_id IN ('Store1', 'Store2', 'Store3')\nGROUP BY store_id;\n</code></pre>\n\n<p>This returns a row for each store that has rows in <code>sales_table</code>, but does not return a row for those that do not. What I want is one row per store, with a <code>0</code> for <code>count</code> if it has no records.</p>\n\n<p>How can I do this, assuming that I do not have access to a <code>stores</code> table?</p>\n"},{"tags":["sql","ms-access","sum","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13203094,"title":"In SQL How is it possible to use the Sum Function in an Update","body":"<p>This is the code that i used</p>\n\n<pre><code>UPDATE Customers c   \nSET c.TotalP= \n   (SELECT SUM(b.Price) \n    FROM Products b\n   WHERE b.CustomerID= c.CustomerID)\n</code></pre>\n\n<p>I im trying to set a value x to the TotalP field in the Customers table.\nThe value x is equal to the sum of the coressponding prices in the Products table where the Customer ID's are the same.</p>\n\n<p>The above code returns an error of <code>\"Operation must be an Updateable query\"</code></p>\n"},{"tags":["sql","data","tree"],"answer_count":6,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":3029,"score":9,"question_id":2175882,"title":"How to represent a data tree in SQL?","body":"<p>I'm writing a data tree structure that is combined from a Tree and a TreeNode. Tree will contain the root and the top level actions on the data.\nI'm using a UI library to present the tree in a windows form where I can bind the tree to the TreeView.</p>\n\n<p>I will need to save this tree and nodes in the DB.\nWhat will be the best way to save the tree and to get the following features:</p>\n\n<ol>\n<li>Intuitive implementation.</li>\n<li>Easy binding. Will be easy to move from the tree to the DB structure and back (if any)</li>\n</ol>\n\n<p>I had 2 ideas. The first is to serialize the data into a one liner in a table.\nThe second is to save in tables but then, when moving to data entities I will loose the row states on the table on changed nodes.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["mysql","sql","database","database-design","aggregate-functions"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13199060,"title":"Finding the average age of users with 0 posts, 1-5 posts, and >5 posts","body":"<p>I need to generate a report on the age of some of our users with respect to their post count grouped by their country of residence.</p>\n\n<p>Here's a simplified version of my schema right now:</p>\n\n<pre><code>DESCRIBE countries;\n+-------+-------------+------+-----+---------+----------------+\n| Field | Type        | Null | Key | Default | Extra          |\n+-------+-------------+------+-----+---------+----------------+\n| id    | int(11)     | NO   | PRI | NULL    | auto_increment |\n| name  | varchar(45) | NO   |     | NULL    |                |\n+-------+-------------+------+-----+---------+----------------+\n\nDESCRIBE users;\n+------------+---------+------+-----+---------+----------------+\n| Field      | Type    | Null | Key | Default | Extra          |\n+------------+---------+------+-----+---------+----------------+\n| id         | int(11) | NO   | PRI | NULL    | auto_increment |\n| age        | int(11) | NO   |     | NULL    |                |\n| country_id | int(11) | NO   | MUL | NULL    |                |\n+------------+---------+------+-----+---------+----------------+\n\nDESCRIBE posts;\n+---------+-------------+------+-----+---------+----------------+\n| Field   | Type        | Null | Key | Default | Extra          |\n+---------+-------------+------+-----+---------+----------------+\n| id      | int(11)     | NO   | PRI | NULL    | auto_increment |\n| content | text        | NO   |     | NULL    |                |\n| user_id | int(11)     | NO   | MUL | NULL    |                |\n+---------+-------------+------+-----+---------+----------------+\n</code></pre>\n\n<p>And I'd like a result set that looks something like this:</p>\n\n<pre><code>country.name | AVG(age of users with 0 posts) | AVG(age of users with 1-5 posts | AVG(age of users with 1-5 posts\n----------------------------------------\nDenmark  | 17.4   | 23.2   | NULL\nGermany  | 20.1   | 27.8   | 34.7\nEngland  | 31.1   | NULL   | 28.3\n</code></pre>\n\n<p>where NULL would represent a country who has no users at a particular post-count level. For example, everyone in Denmark has 0 through 5 posts, and no more. I suppose it doesn't have to say NULL, but it should be clear that this value is undetermined.</p>\n\n<p>So far, this is my query:</p>\n\n<pre><code>SELECT\n    c.name,\n    AVG(something) AS avg_age_with_no_posts,\n    AVG(something) AS `avg_age_with_1-5_posts`,\n    AVG(something) AS `avg_age_with_gt5_posts`\nFROM\n    users u\n    JOIN posts p ON p.user_id=u.id\n    JOIN countries c ON c.id=u.country_id\nGROUP BY c.id;\n</code></pre>\n\n<p>I know it's not much, but I've actually foiled with other clauses (nested selects, HAVING, COUNT(CASE ... WHEN ...)) quite a bit (several hours). The query above is just the fundamental things I know I need.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","mysql","sql","syntax","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13202230,"title":"You have an error in your SQL syntax? Works on its own, but get error when doubled up","body":"<p>Bit puzzled by this, when i comment out the second query i get no error, the first query runs fine but when the second one (basicly the same query) is added i get you have an error in your sql syntax.\nLittle bit unsure why, any help is appreciated maybe there is a better way for me to do the query, thanks.</p>\n\n<p>SQL ERROR [ mysqli ]</p>\n\n<p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1 [1064]</p>\n\n<p>SQL</p>\n\n<p>SELECT username FROM forum_users WHERE user_id = </p>\n\n<p>BACKTRACE</p>\n\n<pre><code>$challengingClan = $results-&gt;get('challengingClan');\n$query = \"SELECT username FROM forum_users WHERE user_id = $challengingClan\";\n$user1 = $db-&gt;sql_query($query);\n$user1 = $db-&gt;sql_fetchrow($user1);\n\n$opposingClan = $results-&gt;get('opposingClan');\n$query = \"SELECT username FROM forum_users WHERE user_id = $opposingClan\";\n$user2 = $db-&gt;sql_query($query);\n$user2 = $db-&gt;sql_fetchrow($user2);\n</code></pre>\n"},{"tags":["android","sql","sqliteopenhelper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13202837,"title":"get database called recursively error only on HTC Sensation XL","body":"<p>I'm working on a application where the database is imported like in this tutorial: <a href=\"http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/\" rel=\"nofollow\">http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/</a></p>\n\n<p>This works fine on most devices,only at HTC Sensation XL it doesn't work.</p>\n\n<p>Thanks for your Help</p>\n\n<p>Here is error code</p>\n\n<p>11-02 21:35:33.748: W/System.err(14878): java.lang.IllegalStateException: getReadableDatabase called recursively\n11-02 21:35:33.748: W/System.err(14878):    at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:245)\n11-02 21:35:33.748: W/System.err(14878):    at at.klettern.database.DatabaseHelper.createDataBase(DatabaseHelper.java:54)\n11-02 21:35:33.748: W/System.err(14878):    at at.klettern.database.DatabaseHelper.onCreate(DatabaseHelper.java:148)\n11-02 21:35:33.758: W/System.err(14878):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:183)\n11-02 21:35:33.758: W/System.err(14878):    at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:249)\n11-02 21:35:33.758: W/System.err(14878):    at at.klettern.database.DatabaseRouten.(DatabaseRouten.java:39)\n11-02 21:35:33.758: W/System.err(14878):    at at.klettern.wachauclimbing.SplashActivity.onCreate(SplashActivity.java:28)\n11-02 21:35:33.758: W/System.err(14878):    at android.app.Activity.performCreate(Activity.java:4531)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2150)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread.access$600(ActivityThread.java:139)\n11-02 21:35:33.768: W/System.err(14878):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)\n11-02 21:35:33.778: W/System.err(14878):    at android.os.Handler.dispatchMessage(Handler.java:99)\n11-02 21:35:33.778: W/System.err(14878):    at android.os.Looper.loop(Looper.java:154)\n11-02 21:35:33.778: W/System.err(14878):    at android.app.ActivityThread.main(ActivityThread.java:4945)\n11-02 21:35:33.778: W/System.err(14878):    at java.lang.reflect.Method.invokeNative(Native Method)\n11-02 21:35:33.778: W/System.err(14878):    at java.lang.reflect.Method.invoke(Method.java:511)\n11-02 21:35:33.788: W/System.err(14878):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)\n11-02 21:35:33.788: W/System.err(14878):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)\n11-02 21:35:33.788: W/System.err(14878):    at dalvik.system.NativeStart.main(Native Method)</p>\n"},{"tags":["sql","drupal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13201521,"title":"Update SQL Records in Drupal","body":"<p>I need to update 50K records by changing the status of comments (turning read &amp; read/write into disabled) and want to make sure my SQL statement is correct:</p>\n\n<pre><code>$query = \"UPDATE node.nid AS nid, node.comment AS node_comment, node.type AS node_type\n        SET node.comment = '0'\n        WHERE (node.type in ('article', 'blog', 'event')) \n        AND  (node.comment in ('1','2'))\";\n\n$total = 0;\n$count = 0;\nwhile ($query_result = db_query($query)){\n    $count++;\n    $total++;\n    if($count&gt;200){\n        $count = 0;\n        sleep(300);\n    }    \n}\necho \"Updated records:\" . $total;\n</code></pre>\n\n<p>I added a periodic pause in there so it doesn't kill the server.  Does this look ok?</p>\n"},{"tags":["java","sql","vaadin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13181300,"title":"How to order Vaadin Table Rows?","body":"<p>I have a table <strong>phases</strong> that has values that reference to a <strong>repository</strong> table. In the repository each value has an order number.</p>\n\n<p>Normally in SQL, I would join them and then order by the order column. But if I want to do that in Vaadin I have to use the <code>FreeFormQuery</code> to make this join. </p>\n\n<p>The Problem is that I want to allow users to change values in the table <strong>phases</strong>. So I would need to implement the <code>FreeFormQueryDelegate</code>. Is there a way to make this work by using a standard <code>TableQuery</code> instead of a <code>FreeFormQuery</code> ?</p>\n\n<p>Maybe manually move the rows in a table ?</p>\n"},{"tags":["sql","sql-order-by","case"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13196010,"title":"SQL Case Order By specific order","body":"<p>Ok, I asked something similar before, but I've researched it and haven't found this specifically.\nI have a table that I need sorted on fields OptionName(NVarChar) and IsActive(BIT).</p>\n\n<p>I need the results to be in the following order for a DDL:</p>\n\n<pre><code>Option A\nOption B\nOption C\nOptions that are Active, by OptionName ASC \nOption D\nOptions that are Inactive, by OptionName ASC \n</code></pre>\n\n<p>So far I have</p>\n\n<pre><code>ORDER BY CASE WHEN PortalName = 'Company, Inc' THEN 0 ELSE 1 END,\n         CASE WHEN PortalName = 'Setup' THEN 1 ELSE 2 END,\n         CASE WHEN PortalName = 'Daily Routine' THEN 2 ELSE 3 END,\n         CASE WHEN IsActive = 1 THEN 3 ELSE 4 END, \n         CASE WHEN PortalName = 'Master Option' THEN 4 ELSE 5 END,\n         PortalName ASC\n</code></pre>\n\n<p>But this returns the results as:</p>\n\n<pre><code>Option A\nOption B\nOption C\nOption D\nOptions that are Active, by OptionName ASC \nOptions that are Inactive, by OptionName ASC \n</code></pre>\n\n<p>Any help would be great!</p>\n"},{"tags":["sql","query-optimization","database-performance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13202671,"title":"SQL Selecting a View Inside an Inline Table Value Function Performance","body":"<p>I have a query that takes about 14 minutes to complete using an inline table valued function that selects from a view on a linked server. However, if this query is changed to remove the function and select directly from the query it completes in about 20 seconds.</p>\n\n<p>Function:</p>\n\n<pre><code>CREATE FUNCTION [dbo].[fn_GetView](CompanyCharacters VARCHAR(4))\nRETURNS TABLE\nAS\nRETURN\n(\n    SELECT DISTINCT\n           [Some Rows]\n    FROM   LinkedServer.Database.dbo.LinkedView\n    WHERE  Co_char = RIGHT(REPLACE('0', 4) + \n                           CAST(@CompanyCharacters AS VARCHAR(4)), 4)\n)\n</code></pre>\n\n<p>Query that takes 14 minutes:</p>\n\n<pre><code>SELECT [Some Rows]\nFROM   fn_GetSomeCompanyData() AS Comp\n       JOIN CustomerData ON Comp.ID = CustomerData.CompID\n       JOIN fn_GetView('MSF') AS gv ON gv.CompanyChar = Comp.CompanyChar\n                                    AND gv.FirstName = Comp.FirstName\n                                    AND gv.FirstName = Comp.FirstName\n</code></pre>\n\n<p>Changed Query that takes 20 seconds:</p>\n\n<pre><code>SELECT [Some Rows]\nFROM   fn_GetSomeCompanyData() AS Comp\n       JOIN CustomerData ON Comp.ID = CustomerData.CompID\n       JOIN LinkedServer.Database.dbo.LinkedView AS gv ON gv.CompanyChar = Comp.CompanyChar\n                                    AND gv.FirstName = Comp.FirstName\n                                    AND gv.FirstName = Comp.FirstName\nWHERE [Some Data Filtering]\n</code></pre>\n\n<p>Anyone have any ideas why this behaves this way? Is there a best way to change the query so that it is fast but can also still keep the function?</p>\n"},{"tags":["sql","database","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13202148,"title":"How can I represent this idea to the database design?","body":"<p>I am new to database design, I am trying to build a database of shopping system.</p>\n\n<p>Assume we have a Customer table and a Staff table.</p>\n\n<p>The requirement is: </p>\n\n<ol>\n<li>To allow part of the customers to have privilege of \"Item return &amp; refund\".</li>\n<li>To allow part of the staff to have the authority to process the refund.</li>\n</ol>\n\n<p>My idea is to <strong>simply add a column with a Boolean value to \"Flag\" which customer or which staff has the authority or not?</strong></p>\n\n<p>Is that correct to solve this problem? Any potential problem?</p>\n"},{"tags":["sql","date","typo3","where","typoscript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13200407,"title":"SQL date comparison in WHERE clause, TypoScript","body":"<p>I want to compare dates in a TypoScript select.\nHere's what I have (note that I commented the <strong>were</strong> clauses) : </p>\n\n<pre><code>lib.my_val = CONTENT\nlib.my_val {\n  select {\n    pidInList = 100000\n    max = 1\n    #where = effective_date &lt; CURDATE()\n    #where = TIMESTAMP(effective_date) &lt; NOW()\n    orderBy = effective_date DESC\n  }\n  table = tx_my_table\n  renderObj = COA\n  renderObj {\n    5 = TEXT\n    5{\n      field = my_field\n      wrap = &lt;span&gt;|&lt;/span&gt;\n    }\n    [...]\n  }\n}\n</code></pre>\n\n<p>Which returns lines.</p>\n\n<p>I tried to add a <strong>where</strong> statement any way I could with static dates or variables... without success. My understanding of the <strong>where</strong> clause is that everything after the <code>=</code> is dumped <em>as is</em> in the SQL query. But it seems I missed something.</p>\n\n<p>Basically I want the TypoScript to generate a SQL Query smilar to this :</p>\n\n<p><code>SELECT * FROM tx_my_table WHERE effective_date &lt; NOW() ORDER BY effective_date DESC LIMIT 1;</code></p>\n\n<p>This should be simple. Has anyone done this in the past?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","google-app-engine","gwt","google-cloud-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13178439,"title":"Google Cloud SQL doesnt work when deployed to appspot","body":"<p>I have a GWT project, using google sql cloud database. Everything works fine when developing locally ( development mode ). But when I deploy it to appspot it can't connect to to the database. </p>\n\n<p>Doesn't anyone have an idea why this is? Should I change permissions somewhere ? I'm pretty much  lost.</p>\n\n<p>I must say there is another deployed project using this database.</p>\n\n<p>Thanks in advance :) </p>\n\n<p>UPDATE: </p>\n\n<pre><code>     2012-11-02 16:14:59.888\n     Uncaught exception from servlet\n     java.lang.UnsupportedClassVersionError: \n     com/layout/server/EntityServiceImpl :                \n     Unsupported major.minor version 51.0\n</code></pre>\n\n<p>My App Engine log gave the following error, which is not database related. I've been using JRE 7 which appearantly is not compatible with GAE. ( appengine.google.com -> log ).</p>\n\n<p>I'm trying to use JDK6 now and see what happens :)</p>\n\n<p>This was the problem, changed to JDK 6 and everything is solved now. Had nothing to do with my database. Just the Java Version.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13201715,"title":"Convert only the year part of the datetime in SQL server","body":"<p>Any other easier way to bring the year part of a datetime to current year? If not, which one is better performance wise?</p>\n\n<p>Attempt #1:</p>\n\n<pre><code>CAST(DATEPART(MONTH, mydate) AS VARCHAR) + '/' + \nCAST(DATEPART(DAY, mydate) AS VARCHAR) + '/' +\nCAST(YEAR(GETDATE()) AS VARCHAR) AS DATETIME \n</code></pre>\n\n<p>Attempt #2:</p>\n\n<pre><code>DATEADD(YEAR, DATEDIFF(YEAR,  mydate, GETDATE()), mydate)\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13197867,"title":"Find duplicate values over multiple databases","body":"<p>I'm trying to find a way to find duplicate email addresses in a table over multiple DB's.  I have 30 DB's, all with a \"Users\" table with identical fields (each DB is a different customer of ours).  I need to go through each DB, get the email address from this table, then search the current, and all other DB's for this email address.  If it exists, write out the record, if not, move on to the next user record and repeat.  Here's what I've got so far, but I'm stuck.  I think I have to create a cursor inside another cursor but don't know if it can be done dynamically:</p>\n\n<pre><code>DECLARE @DBName varchar(20)\nDECLARE @sSQL      varchar(2000)\n\nDECLARE LoopCursor CURSOR FOR\n    SELECT DBName\n    FROM Configuration\n\n    OPEN LoopCursor\n\n    FETCH NEXT FROM LoopCursor\n    INTO @DBName\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        SET @sSQL = '\n            Select EmailAddress\n            FROM ' + @DBName + '.dbo.Users'\n\n        --Not to sure what to do from here??\n\n        EXEC(@sSQL)\n\n        FETCH NEXT FROM LoopCursor\n        INTO @DBName\n    END\n\n    CLOSE LoopCursor\nDEALLOCATE LoopCursor\n\nSELECT 'DONE'\n</code></pre>\n\n<p>We are using SQL Server 2008 R2 btw.</p>\n"},{"tags":["sql","sql-server","int","guid","identifier"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":41,"score":-4,"question_id":13201183,"title":"ints or guids for table identifiers","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4557422/sql-primary-key-int-or-guid-or\">SQL primary key, INT or GUID or..?</a>  </p>\n</blockquote>\n\n\n\n<p>What is the best practise for using unique identifiers in sql server tables?</p>\n\n<p>I have seen articles regarding using guid's or int's with pros and cons for each. </p>\n\n<p>I am looking to go with the following principal, for external identifiers, guid's should be used but for internal identifiers, it best to go with int's. </p>\n\n<p>I am looking for feedback on this principal and guidelines as to the best approach.</p>\n"},{"tags":["sql","view","plsql","column"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13200547,"title":"Checking for the existence of a column in a view before searching for a value","body":"<p>I am trying to search every view in the database for a specific value of something like '%THIS%'</p>\n\n<p>I came up with this plsql code</p>\n\n<pre><code>DECLARE\n  match_count INTEGER;\nBEGIN\n  FOR t IN (SELECT name FROM user_dependencies where type = 'VIEW') LOOP\n\n    EXECUTE IMMEDIATE \n    'SELECT COUNT(*) FROM '|| t.name || ' Where Column_Name LIKE ''%THIS%'' '\n    INTO match_count;\n\n    IF match_count &gt; 0 THEN\n      dbms_output.put_line( t.name ||' '||match_count );\n    END IF;\n\n  END LOOP;\nEND;\n</code></pre>\n\n<p>But when I try to run it, I get an invalid identifier error for the column name in the execute immeadiate query. </p>\n\n<p>The problem to me is obvious that not every view has the Column_Name, but I can't figure out how I can check to see if the column exists before running the query as I loop through all of the views.</p>\n\n<p>I was also able to use a slightly modified version of this to run through all of the tables, and while they do not all have that column, I did not run in to this issue.</p>\n\n<p>Edit: I am including the plsql code that I was able to use to loop through the tables.</p>\n\n<pre><code>DECLARE\n  match_count INTEGER;\nBEGIN\n  FOR t IN (SELECT table_name, column_name FROM all_tab_columns \n            where table_name LIKE 'THIS%' and data_type = 'VARCHAR2' AND column_name = 'Column_name') LOOP\n\n    EXECUTE IMMEDIATE \n    'SELECT COUNT(*) FROM '||t.table_name || ' Where Column_name LIKE ''%THIS%'' '\n    INTO match_count;\n\n    IF match_count &gt; 0 THEN\n      dbms_output.put_line( t.table_name ||' '||t.column_name||' '||match_count );\n    END IF;\n\n  END LOOP;\nEND;\n</code></pre>\n"},{"tags":["java","sql","sql-server","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":78,"score":5,"question_id":13195935,"title":"Determine if an sql query modifies the database","body":"<p>I have a list of strings that contain valid <code>SQL</code> expressions.<br>\nI need to execute only those that do not modify the database.<br>\nWhat would be the best way to do this? Just doing something like:  </p>\n\n<pre><code>if(sqlQuery.contains(\"DELETE\")){  \n  //don't execute this\n}\n</code></pre>\n\n<p>seems like a bad hack  </p>\n\n<p><strong>Update:</strong><br>\nI'll make this more specific.<br>\nI already have a list of <code>SQL</code> queries that are allowed. I want to make sure only these are executed.<br>\nWhat would be the best way to match against these?</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13200627,"title":"sql server external tools logging errorlog","body":"<p>In SQL Server 2008 I installed some external tools and then removed them.  Somehow I am getting this error in the error logs.  How can I remove this queue?</p>\n\n<pre><code>The activated proc '[LakeSideLockLogger].[_LakeSide_DbTools_LockMonitorEvents]' running on queue 'msdb.LakeSideLockLogger._LakeSide_DbTools_LockQueue' output the following:  'Could not find stored procedure 'LakeSideLockLogger._LakeSide_DbTools_LockMonitorEvents'.'\n</code></pre>\n"},{"tags":["php","javascript","jquery","sql","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13200690,"title":"Paginate records","body":"<p>I am generating records through PHP/SQL. The code displays 5 records. I'm trying to program so that when the next button is pressed, the next 5 records will show.</p>\n\n<p>The code:</p>\n\n<pre><code>function show(qstring,qtype)\n{\n $(\"#vsdiv\").show();\n var myurl=\"scripts/searchpage.php\"; \n $.ajax({url: myurl, \n         dataType:'json',  \n         data:{querystring:qstring,querytype:qtype},\n         success: function(member)\n         {\n            $(\"#results\").append('&lt;tr class=\"me\"&gt;'+'&lt;th&gt;#REC&lt;/th&gt; &lt;th&gt;name&lt;/th&gt;&lt;th&gt;surname&lt;/th&gt;');\n            var j=0;\n            var totrecs=1;\n            for(var i=0;i&lt;5;i++)\n            {\n                $(\"#results\").append('&lt;tr class=\"rows'+j+'\"&gt;'+'\n                                      &lt;td class=\"ids\" id=\"z'+i+'\"&gt;'+totrecs+'&lt;/td&gt;'+'\n                                      &lt;td&gt;'+name[i].bdate+'&lt;/td&gt;'+'\n                                      &lt;td class=\"users\" id=\"username'+i+'\"&gt;'+member[i].username+'&lt;/td&gt;'+'\n                                      &lt;td id=\"contact'+i+'\"&gt;'+member[i].fname+' '+member[i].lname+'&lt;/td&gt;'+'\n                                      &lt;td&gt;&lt;input type=\"checkbox\" name=\"whome\" id=\"showMe'+i+'\"'+'\n                                      class=\"boxes\" onclick=\"getMe('+i+')\" /&gt;&lt;/td&gt;&lt;/tr&gt;');  \n                totrecs++;\n                j++;\n            }\n         }\n       });\n}\n</code></pre>\n\n<p>And for the HTML button:</p>\n\n<pre><code>&lt;input type=\"button\" id=\"next5\" title=\"Next 5 Records\" disabled=\"disabled\" value=\"Next 5&gt;&gt;\" /&gt;\n</code></pre>\n"},{"tags":["sql","ssis","data-warehouse","dimensions","lookup-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13200869,"title":"SSIS Lookup multiple dates in my fact table, how to pull this off using one date dimension?","body":"<p>In my SSIS/DW project, I have a DIM.DATE dimension which is linked to my FACT table by a surrogate key as follows:</p>\n\n<pre><code>ALTER TABLE FACT.SALES ADD date_id INT NOT NULL\nALTER TABLE FACT.SALES WITH CHECK ADD CONSTRAINT FK_dim_date FOREIGN KEY (date_id) REFERENCES DIM.DATE(date_id)\n</code></pre>\n\n<p>This creates a \"date_id\" in my fact table, now during my SSIS import process I have a date column being passed (shipped_date), I use this to look up the DIM.DATE table and pass in the surrogate key in my dimension.</p>\n\n<p>This works great, but now I need to have a few different date dimensions for invoice date, received date, etc.</p>\n\n<p>I am confused as to how to make use of the existing DIM.DATE to do this?</p>\n\n<p>I could then add more columns into my fact table..</p>\n\n<pre><code>-- add column into fact table\nALTER TABLE FACT.SALES ADD shipped_date_id INT NOT NULL\nALTER TABLE FACT.SALES ADD invoice_date_id INT NOT NULL\n\n-- add foreign key\nALTER TABLE FACT.SALES WITH CHECK ADD CONSTRAINT FK_shipped_date FOREIGN KEY (shipped_date_id) REFERENCES DIM.DATE(date_id)\nALTER TABLE FACT.SALES WITH CHECK ADD CONSTRAINT FK_invoice_date FOREIGN KEY (invoice_date_id) REFERENCES DIM.DATE(date_id)\n</code></pre>\n\n<p>But when I do my lookup, I can only pass in the \"date_id\" column.. I am confused how to make this work all together.</p>\n\n<p>Anyone able to clear this up for me?<img src=\"http://i.stack.imgur.com/qDzpr.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":5,"up_vote_count":46,"down_vote_count":0,"view_count":100973,"score":46,"question_id":336268,"title":"SQL - Difference between Select Unique and Select Distinct","body":"<p>I thought these were synonomous, but I wrote the following in Microsoft SQL:</p>\n\n<pre><code>Select Unique col from \n     (select col from table1 union select col from table2) alias\n</code></pre>\n\n<p>And it failed.  Changing it to </p>\n\n<pre><code>Select Distinct col from \n     (select col from table1 union select col from table2) alias\n</code></pre>\n\n<p>fixed it.  Can someone explain?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","sql-server-2000"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13200024,"title":"SQL Server 2008 upgrade advisor tool","body":"<p>We upgraded to SQL Server 2008 from SQL Server 2000. But due to some legacy scripts/queries in our health care application, that run only in 2000, we had to run 2008 version on backwards compatibility mode. </p>\n\n<p>My question is what do I need to be aware of if I have to turn it on to full compatibility mode in terms of potential conflicts/issues etc. Is the Upgrade Advisor tool still useful in my case as we already upgraded but running in backwards compatibility mode. Is there value in running that tool? </p>\n\n<p>Any other information any one can share , will be useful. </p>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13200609,"title":"How get around the arithmetic overflow error converting expression to data type int?","body":"<p>I have the following query:</p>\n\n<pre><code>-- CTE to remove outliers, e.g. remove the fastest and slowest results\n;WITH MinMaxCTE AS \n(\n  SELECT ServerName, CONVERT(VARCHAR(10), UpdatedOn, 101) AS [Date], Version, \n    MIN(JaguarStartupTime) AS MinStartTime, MAX(JaguarStartupTime) AS MaxStartTime\n  FROM dbo.MachineConfiguration (NOLOCK)\n  WHERE DomainLogin NOT IN (SELECT DomainLogin FROM dbo.SupportGroup)\n  GROUP BY ServerName, CONVERT(VARCHAR(10), UpdatedOn, 101), Version\n)\n\nSELECT  AVG(mc.JaguarStartupTime) AS AverageTime\n    , COUNT(*) AS NumEntries\n    , mc.Version\nFROM    #Eligible mc (NOLOCK)\nJOIN MinMaxCTE cte ON mc.ServerName = cte.ServerName \n  AND CONVERT(VARCHAR(10), mc.UpdatedOn, 101) = cte.[Date] \n  AND mc.Version = cte.Version \n  AND mc.JaguarStartupTime &lt;&gt; cte.MinStartTime \n  AND mc.JaguarStartupTime &lt;&gt; cte.MaxStartTime\nGROUP BY mc.Version\nORDER BY Version DESC, AVG(mc.JaguarStartupTime) ASC\n</code></pre>\n\n<p>The definition of the #Eligible temp table is </p>\n\n<pre><code>create table #Eligible (\n    Version nvarchar(50), JaguarStartupTime int, \n    ServerName nvarchar(50), UpdatedOn datetime )\n</code></pre>\n\n<p>No matter what condition or aggregation I comment out, I always get the following error: <code>Arithmetic overflow error converting expression to data type int</code>.</p>\n\n<p>Where can I go from here?  How do I debug this further?</p>\n\n<p>EDIT: Sample data</p>\n\n<pre><code>Version JaguarStartupTime    ServerName     UpdatedOn\n6.4.6.082      16040         NewOrleansLA   2012-08-08 12:34:12.330\n6.5.1.012      40390         BatonRougeLA   2012-08-08 18:33:17.440\n6.5.1.012      48379         HonoluluHI     2012-08-09 04:42:50.453\n</code></pre>\n"},{"tags":["sql","sql-server-2008","triggers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13200511,"title":"How to Generate Scripts For All Triggers in Database Using Microsoft SQL Server Management Studio","body":"<p>I'd like to generate an SQL Script that contains the SQL to create all of the triggers that exist in our database.  The triggers were added directly via the SSMS query pane so, there is currently no source other than the trigger on the database itself.  </p>\n\n<p>I have already tried the method where you right-click the database, select <code>Tasks-&gt;Generate Scripts</code> and used the \"Script Entire Database and All Objects\" option.  While this does create a SQL script for the tables and constraints, it does not generate SQL for the triggers.  </p>\n\n<p>I also understand that I can right click on each trigger in the database and select the Generate SQL Script option but, there is currently 46 tables under audit (For Insert, Update, and Delete).  </p>\n\n<p>Rather manually generate an insert, update, and delete trigger script for each of the 46 tables, is there an easier way to do this?  Or, should I start clicking, copying, and pasting?</p>\n"},{"tags":["php","mysql","sql","database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13200676,"title":"Multiple MySQL Database user logins conflicting","body":"<p>I have 2 databases that I INSERT INTO on my php page. I have anti-injection, however my problem lies in the following mysql_error(); message: INSERT command denied to user 'username'@'50.63.197.56' for table 'something_clients'.</p>\n\n<p>My first database is the 'username', and it cannot access the other database, which is good. However, I would my 2nd connection to access its database. Any help is greatly appreciated! Here is my code: \n</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php  \n{  \nrequire_once('client-config.php');  \n$link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);  \nif(!$link) {  \n    die('Failed to connect to server: ' . mysql_error());  \n}  \n$DBName1 = mysql_select_db(DB_DATABASE);  \nif(!$DBName1) {  \n    die(\"Unable to select database\");  \n}  \n    $sqv = \"CREATE TABLE `$DBName1`.`{$login}_weekly` (  \nDate1 int,  \nDate2 int,  \nDate3 int,   \nDate4 int,  \nDate5 int,  \nDate6 int,  \nDate7 int,  \nClientTotal int  \n)\";   \n    mysql_query($sqv,$link);  \n    mysql_close($link);  \n}  \n{  \nrequire_once('agent-config.php');  \n//Connect to mysql server  \n$link2 = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD, true);  \nif(!$link2) {  \n    die('Failed to connect to server: ' . mysql_error());  \n}  \n$DBName2 = mysql_select_db(DB_DATABASE);  \nif(!$DBName2) {  \n    die(\"Unable to select database\");  \n}  \n//Create INSERT query  \n$qry2 = \"INSERT INTO `$DBName2`.`{$agentlogin}_clients` (AgentClients)   VALUES('$login')\";  \n$result2 = @mysql_query($qry2);  \n    echo mysql_error($link2);  \nif($result2) {  \n    header(\"location: client-register-success.php\");  \n    exit();  \n}else {     \n    die(\"Query failed\");  \n}  \n}   \n?&gt;\n</code></pre>\n"},{"tags":["c#","sql","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":70,"score":6,"question_id":13198639,"title":"Can I artificially restrict a user's sql permissions to be read only for any connections from my application?","body":"<p>I'm having an issue regarding the security of an application that I'm building... It's a wrapper for a crystal report viewer that provides users with some additional functionality.</p>\n\n<p>There are many internal users with the ability to create/modify Crystal Reports. I've done some tests, and for an application that deals so intimately with connecting to various data sources, it doesn't seem to care the least bit about doing so safely. There is nothing stopping me from modifying an existing crystal report that everyone trusts to make it into something malicious and harmful. All it takes is an added command table with the following sql:</p>\n\n<pre><code>DELETE FROM tbl_Employees; SELECT FROM tbl_Employees;\n</code></pre>\n\n<p>In fact, you can do anything in a crystal report that the user has permissions to do... so long as it ends with a select. Which leads me to my question: Is there any way for me to ensure that my application limits any connections to our sql server to just selects? I can't temporarily modify user credentials, and I can't use a single read only account because I still need to limit the user to their normal permissions (i.e. which databases they can query).</p>\n\n<p>I'm not very hopeful, as nothing that I've read has led me to believe that I can restrict connections in such a manner.</p>\n\n<p>On the other hand, most of the people making the reports could take a much more direct approach to destroying our data, if they were so inclined... but I hardly think that that is a good excuse not to do my best to ensure that my application is as safe as I can make it. I just can't seem to find any viable answers.</p>\n"},{"tags":["php","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":13199855,"title":"Using A PHP variable within An SQL statement","body":"<p>I am very new to PHP and SQL... \nI cant get variables used within my SQL code to be recognised ?</p>\n\n<p>here is the full code, i am trying to populate a database table with answer to questions answered from a html page</p>\n\n<p>any help please?</p>\n\n<pre><code>&lt;?php\n\n$odbc = mysql_connect ('localhost', 'root', '') or die (\"Could not connect to database\");\nmysql_select_db('Questionaire', $odbc) or die (\"can not find database\");\n\n$sql;\n$quantity = 1;\n\n$id = 222;\n$r = 1;\n$course = '555';\n\n\n\nfor ($i = 1; $i &lt; $quantity; $i++)\n{   \n$answer = $_POST['q'.$r];\n\nif ($answer == 'a')\n{\n    $sql = \"INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES (\".$id.\", \".$i.\",       '1', '0', '0',  '0', '0', '')\";                         \n}\n\nif ($answer == 'b')\n{\n    $sql = 'INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES ('.$id.', '.$i.',               \"0\", \"1\", \"0\",  \"0\", \"0\", \"\")'; \n    echo'&lt;h2&gt; hello &lt;/h2&gt;'; \n    $result = mysql_query($sql,$odbc) or die (\"can not run query\");                 \n}\n\nif ($answer == 'c')\n{\n    $sql = \"INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES (\".$id.\", \".$i.\",       '0', '0', '1',  '0', '0', '')\";     echo $sql;                  \n}\n\nif ($answer == 'd')\n{\n    $sql = \"INSERT INTO `questionaire`.`tanswer` (`User`, `QuestionID`, `Answer1`, `Answer2`, `Answer3`, `Answer4`, `Answer5`, `AnswerFreeText`) VALUES (\".$id.\", \".$i.\", '0', '0', '0', '1', '0', '');\";                           \n}\n\n$r++;\n\n}\n\n\n\n?&gt;\n</code></pre>\n"},{"tags":["php","sql","mvc","relational-database","models"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13200282,"title":"The best way to organize MVC Model without using ORM?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5863870/how-should-a-model-be-structured-in-mvc\">How should a model be structured in MVC?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm playing around with my own little MVC framework. Until now I was using Doctrine for Object Relation Mapping and this was nice. At first it looked as the best way to setup your MVC. The way I was using it was something like this, I had folder Application/Model and this is where I would put all of the Model files, like Doctrine Entities, Services that would do some global tasks, validators etc... So Model was a folder where all of the meat of the MVC application would go. And then I would register Model folder as library with SPL Class loader and I was able to get any entity like this:</p>\n\n<pre><code>$users = new \\Application\\Model\\Entity\\User();\n</code></pre>\n\n<p>Now I decided to not use ORM since I dont really like it anymore, I wont talk about why but lets just say I want to use raw SQL instead of ORM. Now the question is what would be a proper way to organize my folder structure to achieve this?</p>\n\n<p>I'm thinking about creating new folder Tables in Model folder so I can have something like this: Application\\Model\\Tables\\User.php , and from that PHP file I can access all the actions on User table, like update, get, insert etc...</p>\n\n<p>Now the question is how would I organize my Model folder to use RDMS but without using ORM?\nSince Model is a layer, and Model should have Domain Objects and Data Mappers. Domain objects are objects representing current application Domain objects and Mappers would persist those Domain objects. How could I organize this to use raw SQL, but without ORM, and without building my own ORM?</p>\n\n<p>Is there any good framework that dosent use ORM or Active Record pettern so I could explore his code to see how are they doing this?</p>\n"},{"tags":["sql","sql-server","pivot","pivot-without-aggregate"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12516357,"title":"Transposing data into multiple columns","body":"<p>I have numbers of clients and each client has 67 records. </p>\n\n<p>The record contains Activities, Dates, IDs, flags and many other columns. </p>\n\n<p>I would like the Activities names to be the headings and Dates underneath to those Activity headings. </p>\n\n<p>I am trying to explain it more using the tables below. This is the current output:</p>\n\n<pre><code>Client  Activity    Date \n1       A           21/15\n1       B           5/5/2012\n1       C           51/3115\n1       D           54/6/84\n2       A           8/6/99\n2       B           1/1/2011\n2       C           8/4\n2       D           9/81/1\n3       A           6/51/8\n3       B           1/61/8\n3       C           1/31\n3       D           3/2/1\n</code></pre>\n\n<p>And I would like it to be:</p>\n\n<pre><code>Client      A       B         C         D\n1           21/15   5/5/2012  51/31/15  54/6/84\n2           8/6/99  1/1/2011  8/4       9/81/1\n3           6/51/8  1/61/8    1/31      3/2/1\n</code></pre>\n"},{"tags":["sql","sql-server","pivot","sql-server-2012","pivot-without-aggregate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":12387548,"title":"Query to show customers and their contacts in columns side by side","body":"<p>I am trying to figure it out if it's possible to achieve something having this tables as example...</p>\n\n<pre><code>CustomersTable\n Id  | Name | Address\n  1  | John | Street A\n  2  | Paul | Street B\n  3  | Mary | Street C\n\nContactsTable\n Id  | CustomerId | ContactName | Contact\n  1  |     1      |  Contact A  |   123\n  2  |     1      |  Contact B  |   543\n  3  |     2      |  Contact 1  |   678\n  4  |     3      |  Contact A1 |   980\n  5  |     3      |  Contact B2 |   521\n</code></pre>\n\n<p>And get something like this...</p>\n\n<pre><code> Id  |  Name  |  Address   | ContactId_1 | ContactName_1 | Contact_1 | ContactId_2 | ContactName_2 | Contact_2\n  1  |  John  |  Street A  |      1      |   Contact A   |    123    |      2      |   Contact B   |    543\n  2  |  Paul  |  Street B  |      3      |   Contact 1   |    678    |     NULL    |     NULL      |    NULL\n  3  |  Mary  |  Street C  |      4      |   Contact A1  |    980    |      5      |   Contact B2  |    521\n</code></pre>\n\n<p>The idea is to get a table where the contacts are side by side of each customer where it belongs. And the contact columns contacts will depend of course on the number of contacts of each customer.</p>\n\n<p>This can be done? How?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["mysql","sql","pivot","pivot-without-aggregate"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":115,"score":1,"question_id":12382771,"title":"mysql pivot/crosstab query","body":"<p><strong>Question 1:</strong> I have a table with the below structure and data:</p>\n\n<pre><code>app_id  transaction_id  mobile_no   node_id  customer_attribute  entered_value \n100     111             9999999999  1        Q1                  2                             \n100     111             9999999999  2        Q2                  1                             \n100     111             9999999999  3        Q3                  4                             \n100     111             9999999999  4        Q4                  3                             \n100     111             9999999999  5        Q5                  2                             \n100     222             8888888888  4        Q4                  1                             \n100     222             8888888888  3        Q3                  2                             \n100     222             8888888888  2        Q2                  1                             \n100     222             8888888888  1        Q1                  3                             \n100     222             8888888888  5        Q5                  4                             \n</code></pre>\n\n<p>I want to display these records in the below format:</p>\n\n<pre><code>app_id  |  transaction_id  | mobile     |  Q1  |  Q2  |  Q3  |  Q4 |  Q5  |\n 100    |      111         | 9999999999 |   2  |   1  |   4  |  3  |  2   |\n 100    |      222         | 8888888888 |   3  |   1  |   2  |  1  |  4   |\n</code></pre>\n\n<p>I know I need to use crosstab/pivot query to get this display. For this I tried it based on the limited knowledge that I have about it. Following is my query:</p>\n\n<pre><code>SELECT app_id, transaction_id, mobile_no,\n  (CASE node_id WHEN 1 THEN entered_value ELSE '' END) AS user_input1,\n  (CASE node_id WHEN 2 THEN entered_value ELSE '' END) AS user_input2,\n  (CASE node_id WHEN 3 THEN entered_value ELSE '' END) AS user_input3,\n  (CASE node_id WHEN 4 THEN entered_value ELSE '' END) AS user_input4,\n  (CASE node_id WHEN 5 THEN entered_value ELSE '' END) AS user_input5\nFROM trn_user_log \nGROUP BY app_id, transaction_id, mobile_no, node_id\n</code></pre>\n\n<p>And based on this query I got the below display:</p>\n\n<pre><code>app_id  transaction_id  mobile_no   user_input1  user_input2  user_input3  user_input4  user_input5  \n100     111             9999999999  2                                                                \n100     111             9999999999               1                                                   \n100     111             9999999999                            4                                      \n100     111             9999999999                                         3                         \n100     111             9999999999                                                      2            \n100     222             8888888888  3                                                                \n100     222             8888888888               1                                                   \n100     222             8888888888                            2                                      \n100     222             8888888888                                         1                         \n100     222             8888888888                                                      4            \n</code></pre>\n\n<p>Can anyone help me with the proper changes that I need to make to my query to get the records in one single row and not multiple rows as above.</p>\n\n<p><strong>Question 2:</strong> Also is there a way to get the value of a particular field as the NAME of the column. As you can see above I have <code>user_input1</code>, <code>user_input2</code>,... as the header. Instead of that I want to have the values in <code>customer_attribute</code> as the header of the columns. </p>\n\n<p>For this I checked <code>NAME_CONST(name,value)</code> as below:</p>\n\n<pre><code>SELECT app_id, transaction_id, mobile_no,\nNAME_CONST(customer_attribute, (CASE node_id WHEN 1 THEN entered_value ELSE '' END))\nFROM trn_user_log \n</code></pre>\n\n<p>But it gives an error </p>\n\n<pre><code>Error Code : 1210 Incorrect arguments to NAME_CONST\n</code></pre>\n\n<p>Help required.</p>\n"},{"tags":["sql","sql-server","sql-server-2008-r2","pivot","pivot-without-aggregate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":12514192,"title":"SQL: Turn a row into a column (and include column names in a new column)","body":"<p>I'm busy writing a claims provider class to be used in a Security Token Service.</p>\n\n<p>User permissions are read from a SQL Server 2008 R2 database:</p>\n\n<pre><code>SELECT A, B, C, ..., X FROM Permissions WHERE UserId = @UserId\n</code></pre>\n\n<p>would give me a single row, for example: </p>\n\n<pre><code>A B C ... X\n1 0 1     1\n</code></pre>\n\n<p>it would be much easier to have this data in the form</p>\n\n<pre><code>Permission Value\nA          1\nB          0\nC          1\n...\nX          1\n</code></pre>\n\n<p>Since the actual table contains dozens of columns, I'd prefer to be able to do the transposition \"dynamically\" without really having to type up any column names by hand.</p>\n\n<p>It feels like the PIVOT/UNPIVOT functions and INFORMATION_SCHEMA.COLUMNS view are what I need, but I can't quite figure out what to do.</p>\n\n<p>Any ideas for a query that would do this?</p>\n\n<p>PS. I guess if push comes to shove, I'd just stick the result set in a DataTable and iterate over the columns in code to generate the user claims, but I'd like to find out if the above approach is possible first :)</p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12505079,"title":"Write advanced SQL Select","body":"<p>Item table:</p>\n\n<pre><code>|   Item    |   Qnty    |   ProdSched   |\n|    a      |    1      |       1       |\n|    b      |    2      |       1       |\n|    c      |    3      |       1       |\n|    a      |    4      |       2       |\n|    b      |    5      |       2       |\n|    c      |    6      |       2       |\n</code></pre>\n\n<p>Is there a way I can output it like this using SQL <code>SELECT</code>?</p>\n\n<pre><code>|   Item    |   ProdSched(1)(Qnty)  |   ProdSched(2)(Qnty)  |\n|    a      |           1           |       4               |\n|    b      |           2           |       5               |\n|    c      |           3           |       6               |\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13198079,"title":"how to rewrite the query to make it faster and sql compliant","body":"<p>This query:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        GROUP_CONCAT( DISTINCT t1.value SEPARATOR '|' ) AS 'Colors', GROUP_CONCAT( DISTINCT t2.value SEPARATOR '|' ) AS 'Languages'\nFROM `subscribers`\nLEFT JOIN `subscribers_multivalued` AS `t1` ON subscribers.subscriber_id = t1.subscriber_id AND t1.field_id = 112\nLEFT JOIN `subscribers_multivalued` AS `t2` ON subscribers.subscriber_id = t2.subscriber_id AND t2.field_id = 111\nWHERE (list_id = 40) AND (state = 1)\nGROUP BY `subscribers`.`email_address` , `subscribers`.`first_name` , `subscribers`.`last_name`\n</code></pre>\n\n<p>With execute plan:</p>\n\n<pre><code>id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n1   SIMPLE  subscribers     ref     FK_list_id,state_date_added     FK_list_id  4   const   1753610     Using where; Using filesort\n1   SIMPLE  t1  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n1   SIMPLE  t2  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n</code></pre>\n\n<p>Caused error for uknown reason: General error: 3 Error writing file '/tmp/MYzamaNT' (Errcode: 28) in mysql.</p>\n\n<p>I rewrote it like this groupy by subscriber_id insead:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        GROUP_CONCAT( DISTINCT t1.value SEPARATOR '|' ) AS 'Colors', GROUP_CONCAT( DISTINCT t2.value SEPARATOR '|' ) AS 'Languages'\nFROM `subscribers`\nLEFT JOIN `subscribers_multivalued` AS `t1` ON subscribers.subscriber_id = t1.subscriber_id AND t1.field_id = 112\nLEFT JOIN `subscribers_multivalued` AS `t2` ON subscribers.subscriber_id = t2.subscriber_id AND t2.field_id = 111\nWHERE (list_id = 40) AND (state = 1)\nGROUP BY `subscribers`.`subscriber_id`\n</code></pre>\n\n<p>The plan of this query is better (not filesort):</p>\n\n<pre><code>id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n1   SIMPLE  subscribers     ref     FK_list_id,state_date_added     FK_list_id  4   const   1753610     Using where\n1   SIMPLE  t1  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n1   SIMPLE  t2  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1   \n</code></pre>\n\n<p>It seems that it works in mysql and it much faster that previous query.\nAlthough it works in mysql it's not compliant sql standard there shouldn't be aggregated fields in fields' list that are not present in GROUP BY. I there a way to make the query as fast as the last one and make it sql compliant?</p>\n\n<p>I tried to rewrite it this way too:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        t1.colors AS 'Colors', t2.languages AS 'Languages'\nFROM `subscribers`\nLEFT JOIN (SELECT subscriber_id, GROUP_CONCAT( DISTINCT value SEPARATOR '|' ) AS 'colors'\n           FROM subscribers_multivalued\n           WHERE field_id = 112\n           GROUP BY subscriber_id)  t1 ON t1.subscriber_id = `subscribers`.`subscriber_id`\nLEFT JOIN (SELECT subscriber_id, GROUP_CONCAT( DISTINCT value SEPARATOR '|' ) AS 'languages'\n           FROM subscribers_multivalued\n           WHERE field_id = 111\n           GROUP BY subscriber_id)  t2 ON t2.subscriber_id = `subscribers`.`subscriber_id`         \n</code></pre>\n\n<p>The plan of this query is much worse:</p>\n\n<pre><code>1   PRIMARY     subscribers     ALL     NULL    NULL    NULL    NULL    23358546     \n1   PRIMARY     &lt;derived2&gt;  ALL     NULL    NULL    NULL    NULL    900000   \n1   PRIMARY     &lt;derived3&gt;  ALL     NULL    NULL    NULL    NULL    900000   \n3   DERIVED     subscribers_multivalued     ALL     field_fk    field_fk    4       20621115    Using filesort\n2   DERIVED     subscribers_multivalued     ALL     field_fk    field_fk    4       20621115    Using filesort\n</code></pre>\n\n<p>and I couldn't wait untill it  returns data;</p>\n"},{"tags":["sql","select","group","aggregate","greatest-n-per-group"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13199601,"title":"SQL GROUP BY - also SELECT not-constant columns","body":"<p>can someone please help me with this query?\nI have 2 tables in my database:</p>\n\n<pre><code>log_visitors:\n--------------------\nid | host_id\n\n\nlog_access:\n--------------------\nvisitor | document | timestamp\n</code></pre>\n\n<p>\"log_access.visitor\" links to \"log_visitors.id\"</p>\n\n<p>Currently, I'm using this query:</p>\n\n<pre><code>SELECT\n    log_visitors.host_id\n    , MIM(log_access.timestamp) AS min_timestamp\nFROM\n    log_access\n    INNER JOIN log_visitors\n        ON (log_access.visitor = log_visitors.id)\nGROUP BY log_visitors.host_id;\n</code></pre>\n\n<p>to get \"MIN(timestamp)\" for each \"host_id\" in the database.</p>\n\n<p>HERE'S MY QUESTION:</p>\n\n<p>I also need to get \"document\" for that access with that timestamp... I can't simply add \"log_access.document\" into SELECT list, since it's not constant and I am not grouping by document...\nAny ideas?</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13187456,"title":"Oracle SQL Developer — separate time and date","body":"<p>I have a question with Oracle SQL Developer (I've installed Oracle 11g Express Edition).\nI want to insert values for 'date' and 'time', but I cannot separate them.</p>\n\n<pre><code>create table Match \n(\n    numMatch number(2) constraint PKMatch primary key,\n    dateM date, \n    heureM date,\n    numE_Eq number(2),\n    numE_Eq2 number(2),\n    nomTerrain varchar2(30)\n);\n</code></pre>\n\n<p>--\"tools\"=>\"preferences\"=>\"format de date:DD/MM/YYYY  HH24:MI:SS\"</p>\n\n<pre><code>insert into Match values (1,to_date\n('10/12/2010','DD/MM/YYYY'),to_date('15:00:00','HH24:MI:SS'),1,3,'Stade Argentina'\n);\n</code></pre>\n\n<p><em><strong>result:</em></strong></p>\n\n<pre><code>dateM: 10/12/2010 00:00:00\n\nheureM: 01/11/2012 15:00:00\n</code></pre>\n\n<p>PS: I've tried to_char instead of to_date, but it didn't work at all.</p>\n\n<hr>\n\n<p>thanks a lot for the responses.\nyes, i'm aware of that 'DATE datatype contains both date and time', but it's the prof who insists showing date and time seprately in the table,\nand i've seen your solutions before, but for me, it's a query, not to 'insert values' in the table.\nso i'd like to know how can i be able to have a table directly presente date and time.\nthanks again.</p>\n"},{"tags":["sql","cursor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":21,"score":0,"question_id":13186039,"title":"nested cursor, code won't update table outside of cursors","body":"<p>I am working on this nested cursor. My update statement in the major_cursor is not updating the table. I know that all the looping is working because the print statements print what expect, but nothing is updating in edu_suffix_stage_test. I am hoping some one has a suggestion!</p>\n\n<p>For each id, there is row of data for a major, and the year that degree was obtained. I need to string them together.</p>\n\n<p>For example REID 10013 has two records for two degrees:</p>\n\n<p>Civil Engineering in '38, \nand Civil Engineering in '41.</p>\n\n<p>I need to build the edusuffix so it is equal to \"Civil Engineering'38, Civil Engineering in '41\".\nI need one edusuffix per reid in the end, in edu_suffix_stage_test.</p>\n\n<p>Thanks.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>DECLARE @reid_outside nvarchar(20), @major nvarchar(50), @classof nvarchar(5),\n @edusuffix_inside varchar(80), @note nvarchar(50), @reid_inside nvarchar(20),\n@edusuffix_outside varchar(80)\n\n\nDECLARE education_cursor CURSOR FOR \nSELECT  reid, edusuffix\nFROM edu_suffix_stage_test\nwhere reid &lt; 1005\n--ORDER BY reid\n\nOPEN education_cursor\n\nFETCH NEXT FROM education_cursor \nINTO @reid_outside, @edusuffix_outside\n\nWHILE @@FETCH_STATUS = 0\nBEGIN\n\n    SELECT @note = 'building edusuffix for ' \n    PRINT @note\n    PRINT @reid_outside\n\n    -- Declare an inner cursor based   \n    -- on reid from the outer cursor.\n\n    DECLARE major_cursor CURSOR FOR \n    SELECT v.reid, \n    v.EduMajor, v.EduClassOF\n    FROM  re_education v\n   WHERE v.REID = @reid_outside  -- Variable value from the outer cursor \n--order by v.REID \nFOR UPDATE of edusuffix\n\n\n    OPEN major_cursor\n    FETCH NEXT FROM major_cursor INTO @reid_inside, @major, @classof\n\n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n\n        SELECT @edusuffix_inside = @major +' '+ @classof +', '\n        PRINT @edusuffix_inside\n\n    update edu_suffix_stage_test\n    set edusuffix = case when @edusuffix_outside = null then ''+ @edusuffix_inside \n            else @edusuffix_outside + ', '+@edusuffix_inside end\n    from edu_suffix_stage_test a\nwhere  -- a.reid = @reid_inside\ncurrent of education_cursor\nPrint ' updated edusuffix'\n\n        FETCH NEXT FROM major_cursor INTO @reid_inside, @major, @classof\n        END\n\n    CLOSE major_cursor\n    DEALLOCATE major_cursor\n\n    FETCH NEXT FROM education_cursor \n    INTO @reid_outside, @edusuffix_outside\nEND \nCLOSE education_cursor\nDEALLOCATE education_cursor\n</code></pre>\n"},{"tags":["mysql","sql","count","auto-increment"],"answer_count":10,"favorite_count":9,"up_vote_count":25,"down_vote_count":1,"view_count":50766,"score":24,"question_id":933565,"title":"Get Auto Increment value with MySQL query","body":"<p>I currently have a database with over 6 million rows and growing.  I currently do SELECT COUNT(id) FROM table; in order to display the number to my users, but the database is getting large and I have no need to store all of those rows except to be able to show the number.  Is there a way to select the auto_increment value to display so that I can clear out most of the rows in the database?  Using <code>LAST_INSERT_ID()</code> doesn't seem to work.</p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13199425,"title":"Multiple conditions on select query","body":"<p>I have a select statement and I wish to calculate the cubic volume based on other values within the table. However I want to check that neither pr.Length_mm or pr.Width_mm or pr.Height_mm are NULL prior. I've looked at CASE statements, however it only seems to evaluate one column at a time.</p>\n\n<pre><code>SELECT \n      sa.OrderName,\n      sa.OrderType,\n      pr.Volume_UOM\n ,pr.Length_mm*pr.Width_mm*pr.Height_mm AS Volume_Cubic\n ,pr.Length_mm*pr.Width_mm AS Volume_Floor\n ,pr.Length_mm\n ,pr.Height_mm\n ,pr.Width_mm\nFROM CostToServe_MCB.staging.Sale sa\nLEFT JOIN staging.Product pr\nON sa.ID = pr.ID\n</code></pre>\n"},{"tags":["sql","oracle","oracle11g","sql-developer"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2737,"score":4,"question_id":8842577,"title":"How to increase buffer size in Oracle SQL Developer to view all records?","body":"<p>How to increase buffer size in Oracle SQL Developer to view all records (there seems to be a certain limit set at default)? Any screen shots and/or tips will be very helpful.</p>\n"},{"tags":["sql","sql-server","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13199422,"title":"How can I return several text fields with the same ID number in one row in SQL server?","body":"<p>I have table:</p>\n\n<pre><code>    ID   Note\n1   1    aaa\n2   1    bbb\n3   1    ccc\n4   2    ddd\n5   2    eee\n6   2    fff\n</code></pre>\n\n<p>I need to return it as:</p>\n\n<pre><code>   ID   Note1   Note2   Note3\n1  1    aaa     bbb     ccc\n2  2    ddd     eee     fff\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13199120,"title":"Export SQL data to Excel","body":"<p>I have a webpage requesting data data from an SQL database. I am using the sqldrv. I converted this code which was using the old mssql driver. but be aware I AM NOT A PROGRAMMER....  </p>\n\n<p>This data is then posted to a form in another page. This works perfectly with all the headers and data. What I would like to do is then export this to Excel keeping the same formatting.  </p>\n\n<p>I don't seem to be able to get any more than the headers and the first column of data into Excel. Could anyone point me in the right direction? Here is my code with the original code commented out.</p>\n\n<pre><code>/* Start of Formatting for Word or Excel */\n\n/* FORMATTING FOR EXCEL DOCUMENTS ('.xls') */\n//create title with timestamp:\nif ($Use_Title == 0)\n{\n    echo(\"$title\\n\");\n}\n//define separator (defines columns in excel &amp; tabs in word)\n$sep = \"\\t\"; //tabbed character\n\n//start of printing column names as names of sqlsrv fields\nforeach( sqlsrv_field_metadata($result) as $fieldMetadata)              \n//for($i = 0; $i &lt; sqlsrv_num_fields($result); $i++)\n{\n    echo $fieldMetadata['Name'] , \",\";\n    //echo  sqlsrv_field_metadata($result,$i) . \"\\t\";\n}\nprint(\"\\n\");\n//end of printing column names\n\n//start while loop to get data\nwhile( $row = sqlsrv_fetch_array($result, SQLSRV_FETCH_NUMERIC))\n{\n    //set_time_limit(60); // HaRa\n    //$schema_insert = \"\";\n    echo $row[0], \",\";\n\n//$schema_insert . \"$result\".$sep;\n//$schema_insert .= \"$row[$j]\".$sep;\n////$schema_insert = str_replace($sep.\"$\", \"\", $schema_insert);\n//following fix suggested by Josue (thanks, Josue!)\n//this corrects output in excel when table fields contain \\n or \\r\n//these two characters are now replaced with a space\n////$schema_insert = preg_replace(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n////$schema_insert .= \"\\t\";\n////print(trim($schema_insert));\nprint \"\\n\";\n</code></pre>\n"},{"tags":["sql","sql-server","tsql","sql-server-2008"],"answer_count":4,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":1976,"score":12,"question_id":6376866,"title":"TSQL - How to use GO inside of a BEGIN .. END block?","body":"<p>I am generating a script for automatically migrating changes from multiple development databases to staging/production.  Basically, it takes a bunch of change-scripts, and merges them into a single script, wrapping each script in a <code>IF whatever BEGIN ... END</code> statement.</p>\n\n<p>However, some of the scripts require a <code>GO</code> statement so that, for instance, the SQL parser knows about a new column after it's created.</p>\n\n<pre><code>ALTER TABLE dbo.EMPLOYEE \nADD COLUMN EMP_IS_ADMIN BIT NOT NULL\nGO -- Necessary, or next line will generate \"Unknown column:  EMP_IS_ADMIN\"\nUPDATE dbo.EMPLOYEE SET EMP_IS_ADMIN = whatever\n</code></pre>\n\n<p>However, once I wrap that in an <code>IF</code> block:</p>\n\n<pre><code>IF whatever\nBEGIN\n    ALTER TABLE dbo.EMPLOYEE ADD COLUMN EMP_IS_ADMIN BIT NOT NULL\n    GO\n    UPDATE dbo.EMPLOYEE SET EMP_IS_ADMIN = whatever\nEND\n</code></pre>\n\n<p>It fails because I am sending a <code>BEGIN</code> with no matching <code>END</code>.  However, if I remove the <code>GO</code> it complains again about an unknown column.</p>\n\n<p><strong>Is there any way to create and update the same column within a single <code>IF</code> block?</strong></p>\n"},{"tags":["sql","sql-order-by","teradata"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13199339,"title":"SQL Teradata query","body":"<p>I have a table abc which have many records with columns col1,col2,col3,</p>\n\n<pre><code>dept         | name |  marks |\n\nscience         abc      50\nscience         cvv      21\nscience         cvv      22  \nmaths           def      60\nmaths           abc      21\nmaths           def      62\nmaths           ddd      90\n</code></pre>\n\n<p>I need to order by dept and name with ranking as ddd- 1, cvv - 2, abc -3, else 4 then need to find out maximum mark of an individual. Expected result is   </p>\n\n<pre><code>dept         | name |  marks |\n\nscience         cvv      22\nscience         abc      50\nmaths           ddd      90\nmaths           abc      21\nmaths           def      62\n</code></pre>\n\n<p>. How may I do it.?            </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13198571,"title":"Restore Backup Fails - File 'Db' cannot be restored to '{...}.mdf'. Use WITH MOVE to identify a valid location for the file","body":"<p>I am getting the following errors trying to do a restore using the restore command on a backup file I recieved from a customer.</p>\n\n<p>RESTORE DATABASE SFDB FROM DISK = N'C:\\Backup\\Backup.bak' </p>\n\n<p>Any thoughts on what I can do to correct this?  It's looking for the mdf, so can I assume that the backup file I have is an incremental backup and not the full backup and that's why it's looking for the mdf?  </p>\n\n<p>I am not sure if 1) they have given all the data (the entire db) or 2) I have the right data - and I can do the restore with the right T-SQL commands - I just don't know how.</p>\n\n<p>Help is appreciated.</p>\n\n<pre><code>Msg 5133, Level 16, State 1, Line 2\nDirectory lookup for the file \"D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db.mdf\" failed with the operating system error 21(failed to retrieve text for this error. Reason: 15105).\nMsg 3156, Level 16, State 3, Line 2\nFile 'Db' cannot be restored to 'D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db.mdf'. Use WITH MOVE to identify a valid location for the file.\nMsg 5133, Level 16, State 1, Line 2\nDirectory lookup for the file \"D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db_log.LDF\" failed with the operating system error 21(failed to retrieve text for this error. Reason: 15105).\nMsg 3156, Level 16, State 3, Line 2\nFile 'DbDev_log' cannot be restored to 'D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db_log.LDF'. Use WITH MOVE to identify a valid location for the file.\nMsg 3634, Level 16, State 1, Line 2\nThe operating system returned the error '21(failed to retrieve text for this error. Reason: 15105)' while attempting 'GetVolumeInformation' on 'D:\\'.\nMsg 3013, Level 16, State 1, Line 2\nRESTORE DATABASE is terminating abnormally.\n</code></pre>\n\n<p>RESTORE FileListOnly FROM DISK = N'C:\\Backup\\Backup.bak' shows me the following...</p>\n\n<pre><code>LogicalName PhysicalName    Type    FileGroupName   Size    MaxSize FileId  CreateLSN   DropLSN UniqueId    ReadOnlyLSN ReadWriteLSN    BackupSizeInBytes   SourceBlockSize FileGroupId LogGroupGUID    DifferentialBaseLSN DifferentialBaseGUID    IsReadOnly  IsPresent   TDEThumbprint\nDb  D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db.mdf  D   PRIMARY 29622272    35184372080640  1   0   0   02925462-83CC-4222-8966-53229FA25B1C    0   0   29032448    512 1   NULL    269000000146900238  735C7F0E-F63D-4AA1-AC48-505A084AC00B    0   1   NULL\nDb_log  D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db_log.LDF  L   NULL    40239104    2199023255552   2   0   0   71038B04-CBC9-4E4A-93AD-4E1268859CB2    0   0   0   512 0   NULL    0   00000000-0000-0000-0000-000000000000    0   1   NULL\nDbDev_filestream    D:\\Program Files\\Microsoft SQL Server\\MSSQL10_50.MSSQLSERVER\\MSSQL\\DATA\\Db  S   PRIMARY_FILESTREAM  4691012 0   65537   18000000011800001   0   627C9AAA-97BD-4991-9C8C-90C400226A9F    0   0   4784128 512 2   NULL    269000000146900238  735C7F0E-F63D-4AA1-AC48-505A084AC00B    0   1   NULL\n</code></pre>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13199051,"title":"How to set sql field value equal to another value in the same table","body":"<p>I have a table that contains values for different locations where the <code>location id and the item number combination form the primary key</code>.  A lot of the items are the same in both locations when it comes to cost etc.  I am needing to fix one locations information that got changed by a user somehow.  I am looking for advice on how to set the value for <code>location 1 for item 1</code> to be the same as <code>location 2 item 1</code>.  I know how to do this if the value is in a different table, but I am not sure how to accomplish this when the values are in the same table.  Any advice will be greatly apprciated</p>\n"},{"tags":["sql","database","tsql"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13198746,"title":"sql - group/order same column DESC and with random values","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8305920/sql-how-to-sort-order-query-result-in-somewhat-arbitrary-manner\">SQL: How to sort / order query result in somewhat arbitrary manner?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to order a column like so (DESC values):\n c,b,a. \nHowever at the very end of the DESC, I want to display values g,h,i (if exist) . Do I need to do a union on the column from a sub-query?</p>\n\n<p>This is the SQL script so far:</p>\n\n<pre><code>SELECT cars,size from car_table\nGROUP BY cars, size\nORDER BY cars DESC,size ASC\n</code></pre>\n\n<p>Cars is the column I am trying to run my multi-sort on.</p>\n"},{"tags":["sql"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13198974,"title":"sql confusion with ANDs","body":"<p>I am having a bit of confusion with SQL querying using ANDs.</p>\n\n<p>the query is as follows:</p>\n\n<pre><code>SELECT  count(cdr.id) as callTotal,\n    sum(cdr.callDurationSeconds) as timeTotal,\n    users.firstname,\n    users.surname, \n    MAX(cdr.callDuration) as maxCallDuration,\n    AVG(cdr.answeredTime) as avgAnswerTime,\n    AVG(cdr.callDurationSeconds) as avgTimeTotal,\n    cdr.userId, \n    COUNT(IF(cdr.callDurationSeconds &gt; '0', 1, NULL)) AS answeredCalls\n                 FROM cdr \n                 LEFT JOIN users ON cdr.userId = users.id\n                 WHERE cdr.company = 'C47B0BCCDCE92F'\n                 AND cdr.dateCreated LIKE '2012-11-02%'  \n                 AND  cdr.userId = 'U4BC3128209B01'  \n   OR  cdr.userId = 'U4A9FCCD73C6BB'  \n   GROUP BY userId  ORDER BY users.surname ASC  ;\n</code></pre>\n\n<p>I want to query by the date on the second to last line, but then I wish to retrieve items with any of the posted cdr.userIds.\nHowever it seems to disregard the date in this instance. I need the date to be non-optional and retrieve any data with the select Ids on the chosen date.</p>\n"},{"tags":["c#","asp.net","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":65,"score":-3,"question_id":13199092,"title":"i want to calculate total child count with stored procedure","body":"<p>I have three table a parent table a left child table and a right child table and i want to traverse each node of tree and get child count on the basis of parent id how can i achieve this in c# or in sql </p>\n"},{"tags":["sql","sql-server","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13198805,"title":"Remove duplicate batches of data","body":"<p>Due to a bug in my application a table that was built to carry daily records of each delivery period, was populated many times.</p>\n\n<p>Lets say I have a delivery from 1st of June to 5 of June. My table should be populated with 5 records, one for each day. Now, I have havoc because I have many \"batches\" of the same content.</p>\n\n<p>The table layout is as:</p>\n\n<pre><code>dummy_id       -- identity column\ndelivery_id    -- id of the delivery\non_date        -- the day\ncharge         -- the daily cost\n</code></pre>\n\n<p>Is there an elegant way to keep only the first batch of records and delete the batches that were inserted by mistake for all the deliveries?</p>\n"},{"tags":["sql","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13195025,"title":"Return a substring from a field in SQL","body":"<p>I'm hoping one of you knowledgable lot can help me out with this...</p>\n\n<p>I have a field in my DB which contains HTML.  Within this HTML, in each record there is a link with parameters included.</p>\n\n<p>eg.</p>\n\n<pre><code>&lt;a href='http://mysite.com/clickme.aspx?ctid=31' title='Click Here !' target='_blank'&gt;Click this link&lt;/a&gt;\n</code></pre>\n\n<p>All I want to return is the ID of the record, and the value of the parameter CTid (CTid could be anything between 2 digits and 12 digits long)</p>\n\n<p>So, what I want returned is:</p>\n\n<pre><code>ID ¦ CTid ¦\n73 ¦ 31   ¦\n</code></pre>\n\n<p>I've tried using PATINDEX but it's not doing the trick for me (because I have to specify the length of the string returned)</p>\n\n<pre><code>SELECT id, SUBSTRING(content, PATINDEX('%CTid%', content), 12) AS CTid\nFROM ARTICLES\nWHERE content LIKE '%CTid%'\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>   ID ¦ CTid         ¦\n   73 ¦ ctid=31' tit ¦\n</code></pre>\n\n<p>Can anyone shed some light on a good way of doing this ?</p>\n\n<p>I'll be returning several thousand rows so would rather stay away from cursors and intensive operations if possible.</p>\n\n<p>Thanks a lot :) </p>\n"},{"tags":["c#","sql","sql-server","ado.net"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":675,"score":2,"question_id":4369315,"title":"Datetime has too many decimal places","body":"<p>I have the following code:</p>\n\n<pre><code>SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder();\n// set properties on  builder (omitted for brevity)\n\nusing (SqlConnection connection = new SqlConnection(builder.ToString()))\n{\n    connection.Open();\n    using (SqlCommand command = connection.CreateCommand())\n    {\n        command.CommandType = System.Data.CommandType.Text;\n        command.CommandText = \"SELECT * FROM Employee WHERE WhenHire &lt; @HireDate\";\n        SqlParameter hireDateParameter = new SqlParameter(\"@HireDate\", DateTime.Now);\n        command.Parameters.Add(hireDateParameter);\n        using (SqlDataReader reader = command.ExecuteReader())\n        {\n            while (reader.Read())\n            {\n                // do stuff\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Which shows up in SQL Profiler as:</p>\n\n<pre><code>exec sp_executesql N'SELECT * FROM Employee WHERE WhenHire &lt; @HireDate',\n                   N'@HireDate datetime',\n                   @HireDate='2010-12-06 11:43:23.573'\n</code></pre>\n\n<p>How is the precision of the datetime parameter determined?  I've seen this have 7 digits after the decimal.  </p>\n\n<pre><code>exec sp_executesql N'SELECT * FROM Employee WHERE WhenHire &lt; @HireDate',\n               N'@HireDate datetime',\n               @HireDate='2010-12-06 11:43:23.5733125'\n</code></pre>\n\n<p>In that case, the statement fails to execute with this error:</p>\n\n<blockquote>\n  <p>Msg 8114, Level 16, State 1, Line 1\n  Error converting data type varchar to\n  datetime.</p>\n</blockquote>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13186270,"title":"MySQL group by with lookahead?","body":"<p>I have a log of events for when a device either starts or stops with a failure code and I'm trying to calculate the average and mean times between a failure and a start. Here's a very simple example table of data:</p>\n\n<pre><code>+----+-----------+---------------------+\n| id | eventName | eventTime           |\n+----+-----------+---------------------+\n|  1 | start     | 2012-11-01 14:25:20 |\n|  2 | fail A    | 2012-11-01 14:27:45 |\n|  3 | start     | 2012-11-01 14:30:49 |\n|  4 | fail B    | 2012-11-01 14:32:54 |\n|  5 | start     | 2012-11-01 14:35:59 |\n|  6 | fail A    | 2012-11-01 14:37:02 |\n|  7 | start     | 2012-11-01 14:38:05 |\n|  8 | fail A    | 2012-11-01 14:40:09 |\n|  9 | start     | 2012-11-01 14:41:11 |\n| 10 | fail C    | 2012-11-01 14:43:14 |\n+----+-----------+---------------------+\n</code></pre>\n\n<p>Create code:</p>\n\n<pre><code>CREATE TABLE `test` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `eventName` varchar(50) NOT NULL,\n  `eventTime` datetime NOT NULL,\n  PRIMARY KEY (`id`)\n);\nINSERT INTO `test` (`id`, `eventName`, `eventTime`) VALUES (1,'start','2012-11-01 14:25:20'),(2,'fail A','2012-11-01 14:27:45'),(3,'start','2012-11-01 14:30:49'),(4,'fail B','2012-11-01 14:32:54'),(5,'start','2012-11-01 14:35:59'),(6,'fail A','2012-11-01 14:37:02'),(7,'start','2012-11-01 14:38:05'),(8,'fail A','2012-11-01 14:40:09'),(9,'start','2012-11-01 14:41:11'),(10,'fail C','2012-11-01 14:43:14');\n</code></pre>\n\n<p>I can get the times between a start and a failure using something like this:</p>\n\n<pre><code>SET @time_prev := -1;\nSELECT\n *\nFROM\n(\n  SELECT\n    eventName\n  , eventTime\n  , @ts := UNIX_TIMESTAMP(eventTime) AS ts\n  , @started := IF(eventName = 'start', 1, 0) AS started\n  , @failed := IF(eventName &lt;&gt; 'start', 1, 0) AS failed\n  , @time_diff := IF(@time_prev &gt; -1, @ts - @time_prev, 0) AS time_diff\n  , @time_prev := @ts AS time_prev\n  , @time_to_fail := IF(@failed, @time_diff, 0) AS time_to_fail\n  , @time_to_start := IF(@started, @time_diff, 0) AS time_to_start\n  FROM\n    test\n) AS t1;\n\n+-----------+---------------------+------------+---------+--------+-----------+------------+--------------+---------------+\n| eventName | eventTime           | ts         | started | failed | time_diff | time_prev  | time_to_fail | time_to_start |\n+-----------+---------------------+------------+---------+--------+-----------+------------+--------------+---------------+\n| start     | 2012-11-01 14:25:20 | 1351805120 |       1 |      0 |         0 | 1351805120 | 0            | 0             |\n| fail A    | 2012-11-01 14:27:45 | 1351805265 |       0 |      1 |       145 | 1351805265 | 0            | 145           |\n| start     | 2012-11-01 14:30:49 | 1351805449 |       1 |      0 |       184 | 1351805449 | 184          | 0             |\n| fail B    | 2012-11-01 14:32:54 | 1351805574 |       0 |      1 |       125 | 1351805574 | 0            | 125           |\n| start     | 2012-11-01 14:35:59 | 1351805759 |       1 |      0 |       185 | 1351805759 | 185          | 0             |\n| fail A    | 2012-11-01 14:37:02 | 1351805822 |       0 |      1 |        63 | 1351805822 | 0            | 63            |\n| start     | 2012-11-01 14:38:05 | 1351805885 |       1 |      0 |        63 | 1351805885 | 63           | 0             |\n| fail A    | 2012-11-01 14:40:09 | 1351806009 |       0 |      1 |       124 | 1351806009 | 0            | 124           |\n| start     | 2012-11-01 14:41:11 | 1351806071 |       1 |      0 |        62 | 1351806071 | 62           | 0             |\n| fail C    | 2012-11-01 14:43:14 | 1351806194 |       0 |      1 |       123 | 1351806194 | 0            | 123           |\n+-----------+---------------------+------------+---------+--------+-----------+------------+--------------+---------------+\n</code></pre>\n\n<p>But in order to get time between failure and start I have to move ahead to the next record and lose the grouping of that failure code. How can I move this to the next level and get the future to time start merged into a failed record so it can be grouped?</p>\n\n<p>Ultimately, after calculating averages and medians I would end up with a result set like this:</p>\n\n<pre><code>+-----------+-------------+----------------+--------------+-----------------+\n| eventName | avg_to_fail | median_to_fail | avg_to_start | median_to_start |\n+-----------+-------------+----------------+--------------+-----------------+\n|    fail A |      110.66 |         124.00 |       103.00 |           63.00 |\n|    fail B |      125.00 |         125.00 |       185.00 |          185.00 |\n+-----------+-------------+----------------+--------------+-----------------+\n</code></pre>\n"},{"tags":["sql","mongodb","design","schema"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":109,"score":3,"question_id":13190468,"title":"Pros and Cons of using MongoDB instead of MS SQL Server","body":"<p>I am new to NoSQL world and thinking of replacing my MS Sql Server database to MongoDB. My application (written in .Net C#) interacts with IP Cameras and records meta data for each image coming from Camera, into MS SQL Database. On average, i am inserting about 86400 records per day for each camera and in current database schema I have created separate table for separate Camera images, e.g. Camera_1_Images, Camera_2_Images ... Camera_N_Images. Single image record consists of simple metadata info. like AutoId, FilePath, CreationDate. To add more details to this, my application initiates separate process (.exe) for each camera and each process inserts 1 record per second in relative table in database.</p>\n\n<p>I need suggestions from (MongoDB) experts on following concerns:</p>\n\n<ol>\n<li><p>to tell if MongoDB is good for holding such data, which eventually will be queried against time ranges (e.g. retrieve all images of a particular camera between a specified hour)? Any suggestions about Document Based schema design for my case? </p></li>\n<li><p>What should be the specs of server (CPU, RAM, Disk)? any suggestion?</p></li>\n<li><p>Should i consider Sharding/Replication for this scenario (while considering the performance in writing to synch replica sets)?</p></li>\n<li><p>Are there any benefits of using multiple databases on same machine, so that one database will hold images of current day for all cameras, and the second one will be used to archive previous day images? I am thinking on this with respect to splitting reads and writes on separate databases. Because all read requests might be served by second database and writes to first one. Will it benefit or not? If yes then any idea to ensure that both databases are synced always.</p></li>\n</ol>\n\n<p>Any other suggestions are welcomed please.</p>\n\n<p>Regards.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13198298,"title":"Need to group only specific rows in a query","body":"<p>Please consider the following simplified MySQL table:</p>\n\n<pre><code>id  | docID  | docTypeID | makeID | desc\n1   | 1      | 1         | 1      | doc 1\n2   | 1      | 1         | 2      | doc 2\n3   | 2      | 2         | 1      | doc 3\n4   | 3      | 3         | 2      | doc 4\n5   | 1      | 1         | 4      | doc 5\n6   | 2      | 2         | 5      | doc 6\n7   | 4      | 1         | 1      | doc 7\n</code></pre>\n\n<p>In this example docID, docTypeID, and makeID are all foreign keys. </p>\n\n<p>When a doc of docTypeID 1 is associated with multiple makes, I need to group those docs together and return a special make description ('multiple makes found').</p>\n\n<p>What I need to return for this example table would be:</p>\n\n<pre><code>id  | docID  | docTypeID | makeID                | desc\n1   | 1      | 1         | multiple makes found  | doc 1\n3   | 2      | 2         | 1                     | doc 3\n4   | 3      | 3         | 2                     | doc 4\n6   | 2      | 2         | 5                     | doc 6\n7   | 4      | 1         | 1                     | doc 7\n</code></pre>\n\n<p>Note that in the case of id 7, only a single make is found so there is no grouping performed.</p>\n\n<p>I'm not sure how to limit grouping based on criteria or if that is even possible. I'm hopeful one of the SQL geniuses here can assist. Please let me know if any additional info is required. Thanks.</p>\n"},{"tags":["sql","oracle"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3580,"score":1,"question_id":6789010,"title":"distinct values from multiple fields within one table ORACLE SQL","body":"<p>How can I get distinct values from multiple fields within one table with just one request.</p>\n\n<p><strong>Option 1</strong></p>\n\n<pre><code>SELECT WM_CONCAT(DISTINCT(FIELD1)) FIELD1S,WM_CONCAT(DISTINCT(FIELD2)) FIELD2S,..FIELD10S\n  FROM TABLE;\n</code></pre>\n\n<p>WM_CONCAT is LIMITED</p>\n\n<p><strong>Option 2</strong></p>\n\n<pre><code>select DISTINCT(FIELD1) FIELDVALUE, 'FIELD1' FIELDNAME\n       FROM TABLE\nUNION\nselect DISTINCT(FIELD2) FIELDVALUE, 'FIELD2' FIELDNAME\n       FROM TABLE\n... FIELD 10\n</code></pre>\n\n<p>is just too slow</p>\n"},{"tags":["php","sql","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13198398,"title":"display image limit one per result?","body":"<p>I have a search script i am using. it finds users by name or location. i am trying to add a image to each user that is found in the search. but when i do it lists every users image even if not in the search and duplicates the searched name and image a dozen times like so:</p>\n\n<p>image1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael\nimage1.jp  user: michael</p>\n\n<p>image2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric\nimage2.jp  user: eric</p>\n\n<p>and so on. can someone please let me know how i can limit it to just show one image for each user profile that comes up in the search without limiting the users that show up in the search to 1 obviously?</p>\n\n<p>Heres my code:</p>\n\n<pre><code>&lt;form method=\"get\" action=\"\"&gt;\n&lt;input type=\"text\" name=\"query\" class=\"search\" placeholder=\"Search Name/Location\" style=\"width:120px;\"/&gt;\n&lt;input type=\"image\" src=\"../PTB1/assets/img/icons/loginarrow1.png\" class=\"searchbutton\" name=\"submit\" value=\"Start Search\" /&gt;\n&lt;/form&gt;\n\n&lt;?php\n//PHP CODE STARTS HERE\n\nif(isset($_GET['submit'])){\n\n// Change the fields below as per the requirements\n$db_host=\"localhost\";\n$db_username=\"root\";\n$db_password=\"\";\n$db_name=\"playtime\";\n$db_tb_atr_name=\"display_name\";\n\n//Now we are going to write a script that will do search task\n// leave the below fields as it is except while loop, which will display results on screen\n\nmysql_connect(\"$db_host\",\"$db_username\",\"$db_password\");\nmysql_select_db(\"$db_name\");\n\n$query=mysql_real_escape_string($_GET['query']);\n\n$query_for_result=mysql_query(\"SELECT *\n                        FROM ptb_profiles\n                        WHERE display_name like '%\".$query.\"%' \n        OR location LIKE '%\".$query.\"%' OR orientation LIKE '%\".$query.\"%'\");\necho \"&lt;div class=\\\"results\\\"&gt;\";\nwhile($data_fetch=mysql_fetch_array($query_for_result))\n{\n        $search_set = get_searched_escorts();\n        while ($searched = mysql_fetch_array($search_set)) {\n    echo \"&lt;div class=\\\"spacing\\\"&gt;&lt;a href=\\\"profile.php?id={$data_fetch['user_id']}\\\" class=\\\"search\\\"&gt;\";\n    echo \"&lt;img width=80px height= 80px src=\\\"data/photos/{$searched['id']}/_default.jpg\\\" class=\\\"boxgrid\\\"/&gt; \"; \n     echo substr($data_fetch[$db_tb_atr_name], 0,160);\n    echo \"&lt;/a&gt;&lt;/div&gt;\";\n\n}\n}\n\nmysql_close();\n}\n\n?&gt;\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["sql","sql-server","database","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13198384,"title":"What does &gt; 0 mean in SQL?","body":"<p>I have the following SQL statement. Please tell me if my translation of it is accurate. I'm using MS SQL Server 2008. Thanks</p>\n\n<pre><code>(bld_sqft &amp;gt; 0 OR bld_area &amp;gt; 0)\n</code></pre>\n\n<p>My translation</p>\n\n<pre><code>bld_sqft &gt; 0 OR bld_area &gt; 0\n</code></pre>\n"},{"tags":["sql","database","teradata"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13197934,"title":"SQL difference between =0, ='0', IN(0), IN('0')","body":"<p>I inherited some code from a coworker and I noticed that the way that some of the code is not consistent\nFor example, is ther any functional difference between the following:</p>\n\n<pre><code>sum(case when (elephants = 0)then 1 else 0 end),\n\nsum(case when (elephants = '0')then 1 else 0 end),\n\nsum(case when (elephants IN (0))then 1 else 0 end),\n\nsum(case when (elephants IN ('0'))then 1 else 0 end);\n</code></pre>\n\n<p>If there isn't a functional difference between using single qutoes or IN vs = when looking for a single value, what other reason could account for it (other than sloppy code)?</p>\n"},{"tags":["sql","vba","ado"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13197468,"title":"SQL Query & VBA error","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13197011/sql-query-vba-error\">SQL Query &amp; VBA error</a>  </p>\n</blockquote>\n\n\n\n<p>i'm keep getting this error:</p>\n\n<p>BOF or EOF set tu True, or the current record has been deleted. The requested operation requires a current record.</p>\n\n<pre><code>    MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n         &amp; \"WHERE [DateMad] Between #\" _\n         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \" Group By Destinataire\"\n\n         objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n\n         Feuil3.Cells(1, Col) = Entete\n         Feuil3.Cells(strLine, 2) = Entete2\n         Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>i get the error on the last line</p>\n\n<pre><code>  Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>why did it asks me for an BOF or EOF since i'm asking the SUM? also how to get this query to work plz ? \ni cannot breathe with this debugging</p>\n\n<p>the debug.print MyQuery give the following :</p>\n\n<pre><code> Select Destinataire, SUM(NbCompteurElecNR) AS NombreTotal FROM [Feuil1$] WHERE [DateMad] Between #2012/11/21# And #2012/11/26# And [Destinataire] = 'REL12' Group By Destinataire\n</code></pre>\n"},{"tags":["sql","clojure","clojureql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13198271,"title":"clojureql query with sub-select","body":"<p>Given a table with the following structure:</p>\n\n<pre><code>CREATE TABLE transitions (ordering INT, item_id INT, action_id INT)\n</code></pre>\n\n<p>Is it possible to get ClojureQL to generate a query like this one:</p>\n\n<pre><code>SELECT a.item_id, a.action_id\n  FROM transitions a\n WHERE a.ordering = (SELECT MAX(b.ordering)\n                       FROM transitions b\n                      WHERE b.item_id = a.item_id)\n</code></pre>\n\n<p>I've been looking at using <code>join</code>, but worry I might hit this bug: <a href=\"https://github.com/LauJensen/clojureql/issues/114\" rel=\"nofollow\">https://github.com/LauJensen/clojureql/issues/114</a></p>\n"},{"tags":["sql","database","count","group-by"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12693111,"title":"count multiple columns with group by in one query","body":"<p>I count values from multiple columns like this:   </p>\n\n<pre><code>SELECT COUNT(column1),column1 FROM table GROUP BY column1\nSELECT COUNT(column2),column2 FROM table GROUP BY column2\nSELECT COUNT(column3),column3 FROM table GROUP BY column3\n</code></pre>\n\n<p>This returns for example for column1 array(attr1 => 2000, attr2 => 3000...) (Each column has specific and few values). The problem is that \"table\" in my application can be a query with some joins and where clauses, that may take 0.1sec. By doing all that counts \"table\" is computed each time again which is not necessary. Is there any way to take the results i want with one query, or \"cache\" the query that produces table? Otherwise i believe denormalization would be the only solution here. And i want the same results with the above queries. I am using mysql-myisam.</p>\n"},{"tags":["sql","sql-server","string-concatenation","sql-server-group-concat"],"answer_count":11,"favorite_count":43,"up_vote_count":52,"down_vote_count":0,"view_count":62774,"score":52,"question_id":273238,"title":"How to use GROUP BY to concatenate strings in SQL Server?","body":"<p>How do I get:</p>\n\n<pre><code>id       Name       Value\n1          A          4\n1          B          8\n2          C          9\n</code></pre>\n\n<p>to</p>\n\n<pre><code>id          Column\n1          A:4, B:8\n2          C:9\n</code></pre>\n"},{"tags":["sql","mysql","performance","exists"],"answer_count":9,"favorite_count":12,"up_vote_count":36,"down_vote_count":0,"view_count":22749,"score":36,"question_id":1676551,"title":"Best way to test if a row exists in a MySQL table","body":"<p>I'm trying to find out if a row exists in a table. Using MySQL, is it better to do a query like this:</p>\n\n<pre><code>SELECT COUNT(*) AS total FROM table1 WHERE ...\n</code></pre>\n\n<p>and check to see if the total is non-zero or is it better to do a query like this:</p>\n\n<pre><code>SELECT * FROM table1 WHERE ... LIMIT 1\n</code></pre>\n\n<p>and check to see if any rows were returned?</p>\n\n<p>In both queries, the WHERE clause uses an index.</p>\n"},{"tags":["sql","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":48,"score":0,"question_id":13197011,"title":"SQL Query & VBA error","body":"<p>I keep getting this error:</p>\n\n<pre><code>BOF or EOF set tu True, or the current record has been deleted. The requested\noperation requires a current record.\n</code></pre>\n\n<p>My Code:</p>\n\n<pre><code>    MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n         &amp; \"WHERE [DateMad] Between #\" _\n         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \" Group By Destinataire\"\n\n         objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n\n         Feuil3.Cells(1, Col) = Entete\n         Feuil3.Cells(strLine, 2) = Entete2\n         Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>i get the error on the last line</p>\n\n<pre><code>  Feuil3.Cells(2, Col).Value = objRecordSet.Fields(\"NombreTotal\").Value\n</code></pre>\n\n<p>why did it asks me for an BOF or EOF since i'm asking the SUM? also how to get this query to work plz ? \ni cannot breathe with this debugging</p>\n"},{"tags":["sql","database","indexing"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":6316,"score":2,"question_id":6593765,"title":"How to use index in select statement?","body":"<p>i have created an index suppose IDX_name on the name attribute.\nIs it necessary to use this index name in select clause or it will automatically used to speed up queries related to name attribute,</p>\n\n<p>If the index must be used in select clause then how to use it ?</p>\n"},{"tags":["sql","sql-server-2008","ssas","mdx","business-intelligence"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13184139,"title":"SQL Server MDX query parameter","body":"<p>I am very new to MDX query. I am trying to pass a parameter through my query. It is giving me this SQL error:</p>\n\n<blockquote>\n  <p><em>Query preparation failed.</em><br>\n  <em>The function expects a tuple expression for the 5 argument.</em><br>\n  <em>A tuple set expression was used.</em></p>\n</blockquote>\n\n<p>The query is:</p>\n\n<pre><code>SELECT \n{\n[Measures].[DENOMINATOR]\n,[Measures].[NUMERATOR]\n,[Measures].[Goal]\n}\nON COLUMNS,\nNON EMPTY\n(\n [Dim Indicator].[Indicator Set].[Indicator Set].ALLMEMBERS\n ,[Dim Indicator].[Indicator Group].[Indicator Group].ALLMEMBERS\n ,[Dim Indicator].[Indicator Name].[Indicator Name].ALLMEMBERS\n)\nON ROWS\nFROM [Dummy-Dashboard]\n\n--Parameter Queries goes here \n\nWHERE \n(\n    strtoset(@DimGenderGenderID)\n )\n</code></pre>\n"},{"tags":["sql","database-design","case","teradata"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13197950,"title":"How to re-design my current SQL Case Logic implementation in Teradata 13.0","body":"<p>I am building out a Staging layer for Master Data and have the following situation and current solution. My Transaction data has nothing but Master Data id's or \"codes\" and no text descriptions. Most all my text descriptions are delivered in a single generic table which has all the possible \"codes\" and their subsequent text values. In moving this data into the Staging layer I need to trim the codes from the VARCHAR(60) into their actual field length based on their original field length.</p>\n\n<p>in short, Master Data codes are moved from the source environment where they are correctly cast into this Landing environmental and a VARCHAR(60) where they get padded. I need to trim according to field length as I move into Staging.</p>\n\n<p>I am using the following SQL, but have wrapped it in CASE logic to manage the different possible field lengths I will see. I have to therefore reproduce this bit of logic for each different MD code I deal with. I am looking for a way to tweak this so that it handles all field lengths in one bit of logic. </p>\n\n<pre><code>SELECT ATTR_NM\n    , CASE \n        WHEN ATTR_NM = 'DOC_TYP'\n            THEN(\n                CASE WHEN CHARACTER_LENGTH (TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD)) &gt; 1\n                    THEN SUBSTRING( tx.MSTR_DATA_ATTR_CD FROM CHARACTER_LENGTH(TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD))-1)\n                    ELSE tx.MSTR_DATA_ATTR_CD\n                END\n                )\n    WHEN SAP_ATTR_NM = 'ACCT_GRP'\n        THEN(\n            CASE WHEN CHARACTER_LENGTH (TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD)) &gt; 4\n                THEN SUBSTRING( tx.MSTR_DATA_ATTR_CD FROM CHARACTER_LENGTH(TRIM(BOTH FROM tx.MSTR_DATA_ATTR_CD))-2)\n                ELSE tx.MSTR_DATA_ATTR_CD\n            END\n            )\n        END AS MSTR_DATA_ATTR_CD\n    , LANG_ISO_CD AS LANG_ISO_CODE\n    , tx.LANG AS LANG\n    , tx.END_DT AS END_DT\n    , tx.FRM_DT AS FRM_DT\nFROM MASTER_DATA_DESC_BASE_VOL tx;\n</code></pre>\n\n<p>I can't just Trim leading 0's since I can have a code with a leading 0. I need to know the field length and then apply that numeric value with the Trim function call. Or someone has a better way altogether. I am a longtime programmer consultant, but somewhat new to Teradata.</p>\n\n<p>Also, this is working and currently handles more than 20 different cases and runs rather efficiently. I just know there is a better way to do what I need and I will also have to continue to add more and more Cases.</p>\n\n<p>Thanks in advance, Pat</p>\n"},{"tags":["sql","vb.net","ms-access","delimited-text"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13197941,"title":"Updating Access Table from data in delimited text file... Syntax Error","body":"<p>I am attempting to use the Jet OleDB Provider in order to update rows in an access database table using data from a pipe (\"|\") delimited text file. I am getting a syntax error for some reason and need some assistance on it. I am used to Sql Server, and I know there are suttle differences between the two. I know the issue isn't my schema, because I have been able to do a straight insert. Here is the code: </p>\n\n<pre><code>   Dim dbConn As New OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; Set_Data_Directory() &amp; \"\\db.mdb\")\n   Dim a As String = \"UPDATE [tbl_EmployeeList] \" &amp; _\n                     \"INNER JOIN [[Text;DATABASE=\" &amp; Set_Data_Directory() &amp; \";].[extract_VendorID.txt]] ON ([tbl_EmployeeList].[empID] = [[Text;DATABASE=\" &amp; Set_Data_Directory() &amp; \";].[extract_VendorID.txt]].[Col2]) \" &amp; _\n                     \"SET [tbl_Employeelist].[pinNum] = [[Text;DATABASE=\" &amp; Set_Data_Directory() &amp; \";].[extract_VendorID.txt]].[Col3]\"\n   Dim dbCmd As OleDbCommand = New OleDbCommand(a, dbConn)\n</code></pre>\n\n<p>In the above code, tbl_EmployeeList is my access table, and the Set_Data_Directory is a custom function that simply gets the working directory path. Because I did not design the text files (I would have used XML personally) the txt files do not have headers and the schema uses Col0-ColX for the column names. </p>\n\n<p>For reference, the schema.ini for this source:</p>\n\n<pre><code>[extract_VendorID.txt]\nColNameHeader=False\nCharacterSet=ANSI \nFormat=Delimited(|)\nCol1=Col0 Text\nCol2=Col1 Text\nCol3=Col2 Text\nCol4=Col3 Text\nCol5=Col4 Text\nCol6=Col5 Text\nCol7=Col6 Text\n</code></pre>\n\n<p>As I said, the error that VS is throwing is a very general \"Syntax error in UPDATE statement.\"</p>\n\n<p>Thanks ahead of time.</p>\n"},{"tags":["java","sql","ubuntu","firebird","monitor"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13195672,"title":"Monitoring SQL calls to Firebird under Ubuntu (Java app)","body":"<p>Having just moved platform from mySQL to firebird I am finding it difficult to find an acceptable way of capturing SQL commands being passed from a Java .jar application to the database server (Firebird). I need to analyse the commands as well as the \"cost\" of the queries being passed over in terms of execution time and so on.</p>\n\n<p>With MySQL it was possible to use the <a href=\"http://www.maatkit.org/\" rel=\"nofollow\">maatkit toolkit</a> but unfortunately this does not appear to work with Firebird.</p>\n\n<p>Does anyone have an appropriate and comparable approach to maatkit for Firebird?  Or using strace or similar?</p>\n"},{"tags":["mysql","sql","database-design","orm","relational-database"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13197584,"title":"optional days of the week table design","body":"<p>I have the following form, similar to google's calendar event form:</p>\n\n<ul>\n<li>Interval (drop down) [Daily, Weekdays, Weekly, Monthly, Yearly]</li>\n<li>Starts on (date)</li>\n<li>Ends on (radio) either \"Never\" or \"On (and enters date)\"</li>\n</ul>\n\n<p>and if weekly is selected in interval, then 7 checkboxes appear for weekdays.</p>\n\n<p>I am trying to design the db table, but not sure what is the best way to do it. This is what I have so far (in mysql, excluding irrelavent details):</p>\n\n<pre><code>CREATE TABLE `schedule` (\n    `SCHEDULE_ID` int(11) NOT NULL auto_increment,\n    `START_DT` date NOT NULL,\n    `END_DT` date default NULL,\n    `INTERVAL_CD` tinyint NOT NULL,\n    `SUN_IN` tinyint default NULL,\n    `MON_IN` tinyint default NULL,\n    `TUE_IN` tinyint default NULL,\n    `WED_IN` tinyint default NULL,\n    `THU_IN` tinyint default NULL,\n    `FRI_IN` tinyint default NULL,\n    `SAT_IN` tinyint default NULL,\n    PRIMARY KEY (`SCHEDULE_ID`),\n);\n</code></pre>\n\n<p><code>INTERVAL_CD</code> will take a number defined in a tinyint_cd table, and maps to one of the values (daily, weekdays, etc).</p>\n\n<p><code>END_DT</code> will take a null value if 'Never' is selected, or date if a date is entered.</p>\n\n<p>The days, though, is what I am struggling with. Logic will be needed to interpret the table, and I am not so sure if this is the best way to do it. Thought about putting the days in a separate table that refers to the <code>SCHEDULE</code> tables on its id. I am not too stuck on using indicators (0,1), I even think I overuse them in my table design. If you have any suggestion please share it, and I would really appreciate some reasoning as to why the solution is a good design choice.</p>\n\n<p>Thanks in advance,<br/>\np.s. I use jdbc template now, but will potentially add hibernate support. </p>\n"},{"tags":["android","mysql","sql","database"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13197318,"title":"Storing line-by-line data in single database field","body":"<p>In MySQL database, I have a table in which there is a field named features. I have nearly 20 features to store there. I am trying to retrieve these features from my Android mobile application. In app, it has to be shown as line by line (so 20 lines in total). Is there anyway to store the 20 features in that single field by doing something like <code>\\n</code>? Or is there anyway to get those features in new lines by doing something in my android app?</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":46,"score":-2,"question_id":13195515,"title":"How to set a NULL in the first and second record?","body":"<p>I have the following query:  </p>\n\n<pre><code>Declare @t Table(Id int identity,Groep int,[Date] Datetime,MondayMorning      \nInt,MondayEvening Int,TuesdayMorning Int,TuesdayEvening Int ,WednesdayMorning    \nInt,WednesdayEvening Int)\nInsert Into @t Select 2,'2012-01-01',2,0,2,2,2,2\nunion all\nSelect 2,'2012-01-02', 2,2,2,3,2,2\nunion all\nSelect 3,'2012-01-03', 2,2,2,2,2,2\n\n\nselect Id, Groep ,[Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nfrom @t t\nunion all\nselect Id, Groep, [Date], MondayMorning, MondayEvening, TuesdayMorning,TuesdayEvening, WednesdayMorning, WednesdayEvening\nFrom @t tt\n\nWHERE tt.MondayMorning &lt;&gt; tt.MondayEvening\nAND (tt.MondayMorning != 0 and tt.MondayEvening != 0)\nOR tt.TuesdayMorning &lt;&gt; tt.TuesdayEvening\nAND (TuesdayEvening != 0 and TuesdayMorning != 0)\nOR tt.WednesdayMorning &lt;&gt; tt.WednesdayEvening\nAND (tt.WednesdayEvening != 0 and tt.WednesdayMorning != 0)\n</code></pre>\n\n<p>This query gives me a result that is actually correct. I just need to set in TuesdayEvening a Null value in the first record with Id=2. In the second record from that Id=2 set TuesdayMorning = null</p>\n\n<p>To see how this works just run the query.</p>\n\n<p>any ideas?</p>\n"},{"tags":["sql","oracle","instantclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13195457,"title":"Can I use Direct Path Loads in Oracle Instant Client?","body":"<p>I have used SQL*LOADER in Oracle full client for bulk upload using ctl files. But I am planning to move to instant client in which SQL*LOADER doesn't work. I found from the Oracle OCI reference <a href=\"http://oracle.su/docs/11g/appdev.112/e10646/oci13obn.htm#BAJJGACH\" rel=\"nofollow\">http://oracle.su/docs/11g/appdev.112/e10646/oci13obn.htm#BAJJGACH</a> that I can use Direct Path Loads in OCI. Does this mean, that I will be able to use Direct Path Loads using Oracle Instant Client? Can you point me how some good links\\tutorials how to use this?</p>\n"},{"tags":["sql","varchar","longtext"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13197127,"title":"VARCHAR versus TEXT or LONGTEXT","body":"<p>If a blog post is 200 characters long, will <code>varchar(6500)</code> only consume the space of <code>varchar(200)</code>?</p>\n\n<p>Will this be more efficient than using TEXT or LONGTEXT?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","ssis","tsqlt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":13196802,"title":"SQL - Foreign Key Constraint Error with Update Statement","body":"<p>I am Trying to update my table (product) columns - ProductID(FK) and ProductType(FK). These two column has relation with MProduct table's column MProductID(PK) and MProductType(PK).</p>\n\n<p>I am trying to update </p>\n\n<pre><code>ProductID       ProductType\n9999            11\n9999            12\n</code></pre>\n\n<p>But I got the following error </p>\n\n<pre><code>The UPDATE statement conflicted with the FOREIGN KEY constraint \"FKHCR_MProduct\".\nThe conflict occurred in database \"XXXX\", table \"dbo.MProduct\".\n</code></pre>\n\n<p>I checked with MProduct table, It has all the valid records for look up. I can not change my Table Structure.</p>\n\n<p>I tried this Query too</p>\n\n<pre><code>Select ProductID,ProductType\nfrom dbo.Product P\nLeft Join dbo.MProduct M on M.ProductID = P.ProductID\n   and M.ProductType = P.ProductType\nwhere M.ProductType is null\n   and M.ProductID is null\n</code></pre>\n\n<p>and there is No Output, means there is No Null Data Inside the Look up table.</p>\n"},{"tags":["sql","oracle"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13197033,"title":"Join Query which should return one row","body":"<p>I need to write a query which will retrieve me the fullname (available in fullname) of the ownerid and creatorid. Since both are referring the same table, it is retrieving me two rwo. But I need fullname for both ownerid and creatorid fullname in one row. How to do this? owner id and creator id is the reference name in userdetail table. </p>\n\n<p>create table page(page_key,page_number,ownerid,creatorid)</p>\n\n<p>create table userdetail(id,fullname,phonenumber)</p>\n"},{"tags":["mysql","sql"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13196190,"title":"MySQL - Subtracting value from previous row, group by","body":"<p>I need to have the consumption value base on previous one by SN number.\nThis is my data:</p>\n\n<p>TABLE EnergyLog</p>\n\n<pre><code>SN     Date                 Value\n2380   2012-10-30 00:15:51  21.01\n2380   2012-10-31 00:31:03  22.04\n2380   2012-11-01 00:16:02  22.65\n2380   2012-11-02 00:15:32  23.11\n20100  2012-10-30 00:15:38  35.21\n20100  2012-10-31 00:15:48  37.07\n20100  2012-11-01 00:15:49  38.17\n20100  2012-11-02 00:15:19  38.97\n20103  2012-10-30 10:27:34  57.98\n20103  2012-10-31 12:24:42  60.83\n</code></pre>\n\n<p>This is the result I need:</p>\n\n<pre><code>SN      Date                 Value  consumption\n2380    2012-10-30 00:15:51  21.01  0\n2380    2012-10-31 00:31:03  22.04  1.03\n2380    2012-11-01 00:16:02  22.65  0.61\n2380    2012-11-02 00:15:32  23.11  0.46\n20100   2012-10-30 00:15:38  35.21  0\n20100   2012-10-31 00:15:48  37.07  1.86\n20100   2012-11-01 00:15:49  38.17  1.1\n20100   2012-11-02 00:15:19  38.97  0.8\n20103   2012-10-30 10:27:34  57.98  0\n20103   2012-10-31 12:24:42  60.83  2.85\n</code></pre>\n"},{"tags":["php","mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13195741,"title":"SQL query - WHERE not working","body":"<p>I have got this query which works fine:</p>\n\n<pre><code>SELECT p.design_id, p.product_id, t.account_id, p.name, p.width, p.height, \n p.price, t.email \n FROM designs AS p\n INNER JOIN ( SELECT user_id, email, account_id FROM users ) AS t\n USING(user_id) ORDER BY p.design_id LIMIT 0, 300 );\n</code></pre>\n\n<p>Now I am trying to trim the result:</p>\n\n<pre><code>SELECT p.design_id, p.product_id, t.account_id, p.name, p.width, \n p.height, p.price, t.email \n FROM designs AS p\n INNER JOIN ( SELECT user_id, email, account_id FROM users \n WHERE account_id = 0) AS t\n USING(user_id) ORDER BY p.design_id LIMIT 0, 3 );\n</code></pre>\n\n<p>But the second query result is exactly the same as the first one.</p>\n\n<p>Please could somebody shine some light on this?</p>\n\n<p>//UPDATE</p>\n\n<p>I removed the php vaiables to stop the unnecessary confusion :)</p>\n"},{"tags":["sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13195279,"title":"SQL mixed number and character type","body":"<p>I have a number of tables in an sqlite3 database which have a <code>cost INT</code> attribute.</p>\n\n<p>I now am in a situation where in one of my tables there are three possible valid values for cost: <code>NULL</code>, a number, or 'X'.</p>\n\n<p>Is there a way to allow entering both numbers and characters into an attribute.</p>\n\n<p>I had considered making cost a <code>CHAR(1)</code> and:</p>\n\n<pre><code>CONSTRAINT ck_cost CHECK (ISNUMERIC(cost) OR cost = 'X')\n</code></pre>\n\n<p>But then I would not be able to set cost values to literal integers, they would have to be placed in quotes (<code>'1'</code> instead of <code>1</code>). This would be inconsistent with my other tables.</p>\n"},{"tags":["sql","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":13196572,"title":"Column 'mary' does not exist","body":"<p>i'm doing a simple query here and it returns that column 'Mary' does not exist:</p>\n\n<pre><code>SELECT  telephone.telephonenumber as tel\nFROM    person, telephone\nWHERE   person.idperson = telephone.idperson\nAND person.personname = ‘Mary’;\n</code></pre>\n\n<p>Can someone explain what can be happening? I don't want Mary as a column, but as a value.</p>\n\n<p>Thanks in advance,\nGabriel</p>\n"},{"tags":["sql","oracle","error-handling"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13190059,"title":"ORA-00936 missing expression","body":"<p>The following statement:</p>\n\n<pre><code>INSERT INTO TABLE1(COL_1,COL2) VALUES(SELECT MAX(COL_1) FROM TABLE1), 'XYZ');\n</code></pre>\n\n<p>throws the error:</p>\n\n<pre><code>ERROR at line 1:\nORA-00936: missing expression\n at the select clause. \n1. The table is empty for now.\n2. COL_1 is a primary key intger field.\n</code></pre>\n\n<p>Can you help me please?</p>\n"},{"tags":["sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13134638,"title":"getting the first date when record was created","body":"<p>I have a query where I need to display the user that first created a record of customer information.  See my query below:</p>\n\n<pre><code> select CustID, Title, Firstname, Surname, IDNumber, min(ModifyDate) as ModDate, sUsername\nfrom Customers\nwhere StatusCode = 'PI'\ngroup by CustlD,Title,Firstname,Surname,IDNumber,sUsername \n</code></pre>\n\n<p>My result is displayed below:</p>\n\n<pre><code>1    MR    CHARL    8607295    2012-10-23 14:20:31.407   User1\n1    MR    CHARL    8607295    2012-10-24 12:36:09.023   User2\n2    MISS  XABA     8307297    2012-10-23 14:23:08.593   User1\n2    MISS  XABA     8307297    2012-10-24 14:57:29.603   User2\n</code></pre>\n\n<p>I only need the first record and the 3rd record.  Any idea what I'm doing wrong here?</p>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13193665,"title":"Rails select rows from a table where a related table's all rows have a certain value","body":"<p>Basically I have 3 tables. Ignore the syntax. I just wanted to show the idea.</p>\n\n<pre><code>ModelA:\n    belongs_to :ModelB\n\nModelB:\n    has_many: ModelA\n    has_and_belongs_to_many :ModelC\n\nModelC\n    has_and_belongs_to_many :ModelB\n</code></pre>\n\n<p>How can I get all the rows from ModelA where all rows of ModelC have flag = 'Y'?<br>\nI've tried:  </p>\n\n<pre><code>ModelA.joins(:ModelB =&gt; :ModelC).where(\"#{ModelC.table_name}.flag = 'Y'\")\n</code></pre>\n\n<p>and dozen other ways without success. I know the code above doesn't check all the rows, but that's as far as I've got. I would prefer using ActiveRecord.</p>\n"},{"tags":["php","sql","css","select","div"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13195789,"title":"SQL Select, different color depending on result number","body":"<p>I have an SQL SELECT statement and after executing this I have a While statement to display every record in a div. These div are all under one another and I want the divs to alternate in color. So like this:</p>\n\n<pre><code>Result 1 = white div\nResult 2 = grey div\nResult 3 = white div\nResult 4 = grey div.\n</code></pre>\n\n<p>I actually have no idea how to accomplish this, anyone who could help me?\nThanks!</p>\n\n<p>EDIT: I can actually come up with the theory do to this, even numbers white, uneven numbers grey, but how do I code this?</p>\n"},{"tags":["c#","sql","sql-server","linq-to-sql","max"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13196085,"title":"How to do one-select linq-to-sql MAX query?","body":"<p>This code</p>\n\n<pre><code>int maxTrackId = dataContext.TicketTracks.Max(T =&gt; T.TrackId);\n</code></pre>\n\n<p>Generates the following <code>SQL</code> code:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT MAX([t0].[TrackId]) AS [value]\nFROM [dbo].[TicketTracks] AS [t0]\n</code></pre>\n\n<p>But if the table is empty, I got an exception saing that nullable value cannot be assigned to non-nullable variable.</p>\n\n<p>Then I write this code, explicitly telling the SQL provider that i need either maximum or null:</p>\n\n<pre><code>int? maxTrackId = dataContext.TicketTracks.Max(T =&gt; (int?)T.TrackId);\n</code></pre>\n\n<p>And it works fine on that non-nullable SQL column, giving me back either <code>null</code> or the number. But the <code>SQL</code> code generated is kind of strange:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT MAX([t1].[value]) AS [value]\nFROM (\n    SELECT [t0].[TrackId] AS [value]\n    FROM [dbo].[TicketTracks] AS [t0]\n    ) AS [t1]\n</code></pre>\n\n<p>So it seems weird, especially with two <code>SELECT</code>s. Is there any way to circumvent this?</p>\n"},{"tags":["java","sql","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13195841,"title":"how to access columns which are indexed from JAVA code?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6593765/how-to-use-index-in-select-statement\">How to use index in select statement?</a>  </p>\n</blockquote>\n\n\n\n<p>Let me be specific:</p>\n\n<p>I have certain tables x and y created in oracle 10g Database. I have indexed certain columns in my tables for faster retrieval of records using <code>CREATE INDEX</code> statement. </p>\n\n<p>I have Java code which accesses these tables to retrieve data using prepared statement object. However I am unclear on how to retrieve data from these indexed tables. Please help. A code snippet will be really helpful.</p>\n"},{"tags":["sql","sql-server","sql-server-2005","triggers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13195785,"title":"Is it possible for triggers not to fire?","body":"<p>On three different tables I have separate <code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code> triggers.</p>\n\n<p>I know positively that they work as expected (tried adding, deleting, updating and confirmed the changes going to log-table). However, it happens that rows are removed or added, without my log tables having any content.</p>\n\n<p>So my question is: Is it possible for instance to add a record without the enabled INSERT trigger being triggered?</p>\n\n<p>This is on SQL Server 2005.</p>\n"},{"tags":["php","sql","cakephp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":210,"score":0,"question_id":3092944,"title":"converting simple query to cake query?","body":"<p>Actually I have 1 query but I am unable to convert it into CakePHP query format.</p>\n\n<pre><code>$result = \"select \n             * from esl_userresults\n           where \n             esl_userresults.esl_songID = esl_lyrics.id \n             and esl_lyrics.song_name like '%\".$esl_keyword.\"%'\" ;\n</code></pre>\n\n<p>When I convert this query into CakePHP it gives an error like:</p>\n\n<pre><code>esl_userresults.esl_songID unknown column. \n</code></pre>\n"},{"tags":["php","sql","cakephp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":155,"score":-3,"question_id":3101190,"title":"How can I convert this simple query to CakePHP?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3092944/converting-simple-query-to-cake-query\">converting simple query to cake query?</a>  </p>\n</blockquote>\n\n\n\n<p>Actually I have 1 query but I am unable to convert it into CakePHP query format.</p>\n\n<pre><code>$result = \"select \n             * from esl_userresults, esl_lyrics\n           where \n             esl_userresults.esl_songID = esl_lyrics.id \n             and esl_lyrics.song_name like '%\".$esl_keyword.\"%'\" ;\n</code></pre>\n\n<p>When I convert this query into CakePHP it gives an error like:</p>\n\n<pre><code>esl_userresults.esl_songID unknown column. \n</code></pre>\n"},{"tags":["sql","null","db2","ibm-midrange"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13190869,"title":"Db2 on AS400 and null values inserted on not nullable columns?","body":"<p>Is there a difference in behaviour of DB2 on AS400 machines when it comes to handling not-nullable columns?</p>\n\n<p>Someone just told me that if you insert a null value into a column with not null, on DB2 as400 it will work (sounds strange I know) , but will throw an error if Db2 is running on Windows.</p>\n\n<p>I am going to verify this as soon as I get hold of the environment, still want to know if someone has ever heard of such a thing.</p>\n\n<p>Closing Note:\nIt was a schema that had changed over time... so the column had changed across releases, which led to the confusion.</p>\n"},{"tags":["sql","excel","adodb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13195696,"title":"ADODB/Excel query error","body":"<p>When I try to use ADODB to connect on an Excel DB, it says:</p>\n\n<pre><code>you try to execute a query without a specified expression &lt;Destinataire&gt;\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n                         &amp; \"WHERE [DateMad] Between #\" _\n                         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n                         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \"\"\n\n                    objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n</code></pre>\n\n<p>What's wrong with it?</p>\n"},{"tags":["sql","sql-server","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13193693,"title":"SSIS Eror: insert values list doesnt match column list","body":"<p>In ssis component OLE DB Command:</p>\n\n<pre><code>insert into D_MAPPING_CLIENTS (ID, DIRECTORY_ID, SOURCE_ID, BASE_ID)\n  values (\n\n     case when exists ( select 1 from D_MAPPING_CLIENTS )\n           then ( select MAX(ID) + 1 from D_MAPPING_CLIENTS )\n\n         else 1\n     end\n\n  , ISNULL(?, \n      case when exists ( select 1 from D_MAPPING_CLIENTS )\n             then ( select MAX(DIRECTORY_ID) + 1 from D_MAPPING_CLIENTS )\n\n           else 1\n       end ) \n\n   , ( select ID from D_SOURCES_CLIENTS where SOURCE = 'D:\\load\\1\\clients.txt' )\n\n   , ?)\n</code></pre>\n\n<p>When I try to save it, i get an error: 'Insert value list does not match column list', although when i run this script in Management Studio it works fine. </p>\n\n<p>What's the problem?</p>\n\n<p>UPD: Where i replace last '?' to some value it works fine :o</p>\n"},{"tags":["php","mysql","sql","mysqli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13169425,"title":"Don't want string to be generated if string is in database and contains number at the end","body":"<p>I have a little situation here. If in my database in my \"Session\" Table if I have the data below:</p>\n\n<pre><code>SessionId\n\nC\n</code></pre>\n\n<p>Then what happens with my code is that it would not display the string above when user generates a new string as that it is already in the database. This works fine for example above</p>\n\n<p>The problem I have though is that if I have multiple sessions(exams), then in the database below it will display the strings as below in the database:</p>\n\n<pre><code>SessionId\n\nC1\nC2\nC3\n</code></pre>\n\n<p>The above is for 3 exams. But the problem is that the string \"ADERF\" can still be generated in the code below. What my question is that if there is a number at the end of the string like the table above, then how can I not generate the string as it is still in the database? The strings will always be 5 characters long:</p>\n"},{"tags":["java","sql","spring","parameters","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":142,"score":0,"question_id":11786534,"title":"Spring MVC 3.0 Getting Values Out From Sql Query","body":"<p>I am very new to using Spring MVC 3.0 and i am writing a custom authentication class and i would like to know how i can extract the values from an sql query into variables so i can do a comparison under is an example of what i am trying to achieve and some code is omitted which i am asking about;</p>\n\n<pre><code>import java.sql.ResultSet;\nimport java.sql.SQLException;\n\nimport org.apache.log4j.Logger;\nimport org.springframework.jdbc.core.simple.ParameterizedRowMapper;\nimport org.springframework.jdbc.core.support.JdbcDaoSupport;\n\nimport com.crimetrack.DAO.LoginDAO;\nimport com.crimetrack.business.Login;\n\npublic class JdbcLoginDAO extends JdbcDaoSupport implements LoginDAO {\n\n    private final Logger logger = Logger.getLogger(getClass()); \n    String dbUserName;\n    String dbPassword;\n\n    public boolean AuthenticateUser(Login login) {\n        logger.debug(\"Authenticating User\");\n\n        String sql = \"SELECT userName, password FROM tblofficers WHERE userName = :userName AND password = :password \";\n\n        //code for parameters : userName and password using login.getPassword() and login.getUsername()\n        //and code to get vaules out from query for comparison\n\n\n        if (dbUserName == login.getUserName()) {\n\n            if (dbPassword == login.getPassword()){\n                return true;\n            }\n        }\n\n        return false;\n\n    }\n\n\n    public static class LoginMapper implements ParameterizedRowMapper&lt;Login&gt;{\n\n         public Login mapRow(ResultSet rs, int rowNum) throws SQLException {\n                Login dbLogin = new Login();\n                dbLogin.setUserName(rs.getString(\"userName\"));\n                dbLogin.setPassword(rs.getString(\"password\"));\n                return dbLogin;\n            }       \n    }\n\n}\n</code></pre>\n"},{"tags":["sql","sql-server","sql-server-2005"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13194630,"title":"SQL Server 2005 : conversion failed when converting the varchar value '0.00' to data type int","body":"<p>When adding this line into my query:</p>\n\n<pre><code>convert(varchar(20), convert(varchar(20),\nsum(case when tsr.other like '%aa%' then tsr.block1 else 0 end) +\nsum(case when tsr.other like '%aa%' then tsr.block2 else 0 end) +\nsum(case when tsr.other like '%aa%' then tsr.block3 else 0 end) +\nsum(case when tsr.other like '%aa%' then tsr.block4 else 0 end)) * 450) \n</code></pre>\n\n<p>I get this error message:</p>\n\n<blockquote>\n  <p><em>Conversion failed when converting the varchar value '0.00' to data\n  type int</em></p>\n</blockquote>\n\n<p>Data in block column is days - e.g. <code>10.0</code></p>\n\n<p>Any ideas?</p>\n\n<p>i've got it fixed, it was just changing the 450 to 450.0.</p>\n\n<p>The reason for the varchars is that this is just 1 line from 1 of multiple unioned select statements. </p>\n"},{"tags":["mysql","sql","query","select","join"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13192736,"title":"writing a Select query to deduct one table from another","body":"<p>I am just a little confuse to how write the below query :</p>\n\n<p>I have two tables</p>\n\n<pre><code>tbl_one\nID      TEXT\n1       test1\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n\n<p>and</p>\n\n<pre><code>tbl_two\nID      userID      tblone_ID\n1       50          1\n2       100         1\n3       100         2\n</code></pre>\n\n<p>I am looking to get rows of tbl_one which are not appear in tbl_two but for the certain user .</p>\n\n<p>for example by below select  :</p>\n\n<pre><code>select * from tbl_one, tbl_two \nwhere (tbl_two.tblone_ID !=tbl_one.ID and tbl_two.userID==50) \n</code></pre>\n\n<p>my desire resault will be </p>\n\n<pre><code>Desire resalt:\nID      TEXT\n2       test2\n3       test3\n4       test4\n5       test5\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","query","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13189390,"title":"Rails select and sort by aggregate of has_many","body":"<p>I have a Course model which has_many reviews. My Review model has a rating field. What I would like is a query to find the top rated courses. I want to do this in the SQL in order to avoid returning all the course objects and then trying to rank and sort them.</p>\n"},{"tags":["mysql","sql","query","table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13195501,"title":"mySQL query using two tables","body":"<p>I have one table (config) with the field 'type' in and another table (users) with the field 'status' in.</p>\n\n<p>Some values for the field 'status' are blank.</p>\n\n<p>I want to change the field 'status' to 'applied' ONLY if the field 'type' in the other table equals '3'.</p>\n\n<p>Can you please explain how to do this query?</p>\n"},{"tags":["php","mysql","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":104,"score":-1,"question_id":13193996,"title":"show multiple choice questions with answers to user","body":"<p>i have a problem about displaying multiple choice questions to user. i have the following tables:</p>\n\n<p><strong>multiple_choice_questions</strong> (quiz_id, question,c_answer) \nthis table have the questions with the right answers</p>\n\n<p><strong>multiple_choice_answers</strong> (answer_id, quiz_id,answer)\nthis table have the answers with the foreign key quiz_id</p>\n\n<p><strong>multiple_choice_info</strong> (info_id,quiz_id,name,class, lesson, subject, notes,date)\nhere are basic informations for each quiz which actually helps in choosing the appropriate quiz from the user. e.g. if a user puts as lesson mathematics it show the tests with \"lesson\" mathematics</p>\n\n<p>i want to display for example 10 random questions with their answers. note that each questions has plurality of different answers. e.g. question 1 have 3 different answers. question 2, 5 different answers. </p>\n\n<p>i made an effort to catch the data related with the quiz_id but this method is wrong. im new in php, mysql. </p>\n\n<pre><code>&lt;?php\ninclude('../connect_db.php');\n\n$sql = \"select * from multiple_choice_questions\ninner join multiple_choice_answers on (multiple_choice_questions.quiz_id =      multiple_choice_answers.quiz_id)\ninner join multiple_choice_info on (multiple_choice_questions.quiz_id = multiple_choice_info.quiz_id)\";\n$myData3 = mysql_query($sql);\nwhile($row = mysql_fetch_array($myData3)) {\necho '&lt;input type=\"text\" value=\"'.$row['question'].'\" name=\"q'.$row['quiz_id'].'\"/&gt;&lt;br&gt;';\necho '&lt;input type=\"radio\" value=\"'.$row['answer'].'\" name=\"q'.$row['answer'].'\"/&gt;\"'.$row['answer'].'\"';\n\n}\n?&gt;     \n</code></pre>\n"},{"tags":["sql","postgresql","many-to-many"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13179785,"title":"Uniqueness in many-to-many","body":"<p>I couldn't figure out what terms to google, so help tagging this question or just pointing me in the way of a related question would be helpful.</p>\n\n<p>I believe that I have a typical many-to-many relationship:</p>\n\n<pre><code>CREATE TABLE groups (\n  id integer PRIMARY KEY);\n\nCREATE TABLE elements (\n  id integer PRIMARY KEY);\n\nCREATE TABLE groups_elements (\n  groups_id integer REFERENCES groups,\n  elements_id integer REFERENCES elements,\n  PRIMARY KEY (groups_id, elements_id));\n</code></pre>\n\n<p>I want to have a constraint that there can only be one groups_id for a given set of elements_ids.</p>\n\n<p>For example, the following is valid:</p>\n\n<pre><code>groups_id | elements_id\n        1 | 1\n        1 | 2\n        2 | 2\n        2 | 3\n</code></pre>\n\n<p>The following is not valid, because then groups 1 and 2 would be equivalent.</p>\n\n<pre><code>groups_id | elements_id\n        1 | 1\n        1 | 2\n        2 | 2\n        2 | 1\n</code></pre>\n\n<p>Not every subset of elements must have a group (this is not the power set), but new subsets may be formed.  I suspect that my design is incorrect since I'm really talking about adding a group as a single entity.</p>\n\n<p>How can I create identifiers for subsets of elements without risk of duplicating subsets?</p>\n"},{"tags":["mysql","sql","comma"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":79,"score":-1,"question_id":13194711,"title":"Find distinct values from comma separated text column of mysql","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3653462/is-storing-a-comma-separated-list-in-a-database-column-really-that-bad\">Is storing a comma separated list in a database column really that bad?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a mysql db column of comma separated text:</p>\n\n<pre><code>  id  keys\n ------------\n  1  Key1, Key2\n  2  key3\n  3  key2, key3, key4\n  4  key5, key2\n</code></pre>\n\n<p><strong>Question 1</strong></p>\n\n<p>I need results like this:</p>\n\n<pre><code>id    keys\n----------\n1    Key1\n2    Key2\n3    key3\n4    key4\n5    key5\n</code></pre>\n\n<p><strong>Question 2</strong></p>\n\n<p>Also I need a second query to match the above condition. eg.</p>\n\n<p>select all the rows with <code>key2</code></p>\n\n<p>Output should be</p>\n\n<pre><code>id\n---\n1\n4\n</code></pre>\n\n<p><strong>NOTE:</strong> Only in a single query, no stored procedures, no functions.</p>\n\n<p>I have seen similar questions but with not the desired answer.</p>\n\n<p><strong>NOTE :</strong> Thanks for suggesting that data should not be stored in a comma seprated field.\n<strong>But I have not developed the system and database. I am just about to do a samll upgradation.</strong></p>\n"},{"tags":["sql","sql-server-2008"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13192667,"title":"Is there a Performance difference when we SET Encryption on Database ON and OFF?","body":"<p>I am just wondering to whether is there any performance difference in sprocs and inline queries when DB encryption is set to ON and OFF?</p>\n\n<p>If yes,could you please explain me in detail when the performance is good and when its bad?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","sql","delete"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13195373,"title":"Delete where email is not a known email client","body":"<p>I'm trying to delete records from a table that is getting to much spam. So, the idea is delete all records that don't have email from hotmail, gmail or yahoo. But my sql looks like is returning some hotmail records:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT *\nFROM `users`\nWHERE email NOT LIKE '*hotmail.com*'\nAND email NOT LIKE '*gmail.com*'\nAND email NOT LIKE '*ymail.com*'\n</code></pre>\n\n<p>Applying the <code>OR</code> condition returns the same result. Can you guide to the right direction?</p>\n"},{"tags":["sql","jdbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13195360,"title":"Second ResultSet.next() reporting true but while loop existing","body":"<p>While using a JDBC connection I am trying to perform 2 SELECT statements. The first returns a single record from a table (SQL_IBGN), and the second is designed to return multiple records from another table (SQL_ITXN) using a column (BGNREF) from the first query.</p>\n\n<p>I have separate Statement and ResultSet objects for each query.</p>\n\n<p>Code for Query 1:</p>\n\n<pre><code>    Statement stmt = con.createStatement();\n    String sql = \"SELECT BGNREF..... FROM SQL_IBGN WHERE BGNREF LIKE '2306009';\";\n    ResultSet rs = stmt.executeQuery(sql);\n    String bgnref = null;\n    while (rs.next()) {\n        G1SQL_IBGN g1rec = new G1SQL_IBGN();\n        bgnref = rs.getString(1);\n        g1rec.setBGNREF(bgnref);\n    }\n</code></pre>\n\n<p>Code for Query 2:</p>\n\n<pre><code>        if (bgnref != null) {\n        Statement stmt1 = con.createStatement();\n        String sql1 = \"SELECT ACT_DESC...... SQL_ITXN WHERE BGNREF LIKE '\"\n                + bgnref + \"';\"; // Execute the SELECT statement ResultSet\n        ResultSet rs1 = stmt1.executeQuery(sql1); // Get result of first five records\n        while (rs1.next()) {\n            G1SQL_ITXN g1itxn = new G1SQL_ITXN();\n            g1itxn.setACT_DESC(rs1.getString(1));\n        }\n    }\n</code></pre>\n\n<p>The first query is returning a single record, however even though rs1.next() = true, the second while loop, while (rs1.next()) is not executed.</p>\n"},{"tags":["sql","sql-server","query","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13191768,"title":"How to make two records from one?","body":"<p>I have records with the following:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning, and so on\n1   2012-01-01          2               3   \n2   2012-01-01          2               2 \n</code></pre>\n\n<p>I want split record 1 in two records because the states of mondaymorning and mondayevening are not the same. If the state is the same then do nothing.  </p>\n\n<p>The result that I expect:</p>\n\n<pre><code>Id    Date          MondayMorning  MondayEvening  TuesdayMorning\n1   2012-01-01          2               NULL          2\n1   2012-01-01          NULL            3             2\n2   2012-01-01          2               2 \n</code></pre>\n\n<p>Please remember that also the other days can vary.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql","rollback"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13188621,"title":"roll back SQL query executed by mistake","body":"<p>I think the question says it all,\nthe following update query has been executed - by mistake - in SQL Server management studio</p>\n\n<pre><code>update kms_students set student_campus='4' where student_campus='KL'\n</code></pre>\n\n<p>The effected rows are more than 1000, and i can't identify it since that table is already have the <code>student_campus='4'</code> for many previous rows.</p>\n\n<p>Is it possible to roll back?</p>\n"},{"tags":["sql","oracle-apex","multiple-columns","tabular-form"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12952346,"title":"How to update selected rows only in Oracle SQL","body":"<p>So basically I have a tabular form. One of the columns is a checkbox, another column is called 'hidden' and will contain either the value 'yes' or 'no'. </p>\n\n<p>I have a button for hiding rows, so the user should be able to select certain rows using the checkboxes, then click the hide button and it should change the rows that the user has selected to 'yes' under the 'hidden' column</p>\n\n<p>So my SQL looks like this:</p>\n\n<pre><code>UPDATE nameOfTable\nSET hidden = 'Yes'\nWHERE hidden = 'No';\n</code></pre>\n\n<p>Obviously this will just update the 'hidden' column to 'yes' for all rows that are currently 'no' but how do I instead make it to just update the rows that user has selected using the checkboxes?</p>\n"},{"tags":["php","sql","yii","geospatial","point"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13182573,"title":"Yii Framework handling Geospatial data","body":"<p>I am new to the Yii Framework and I have a database table that stores locations as Geospatial point objects. I am using the code generation tools to generate forms that update/ add to the database. However, these forms don't handle the location field properly. I have been struggling to figure out how this works. The solution mentioned <a href=\"http://stackoverflow.com/questions/12535245/how-do-i-insert-a-mysql-spatial-point-with-a-yii-model\">in this post</a> does not help.</p>\n\n<p>I would appreciate it if anyone could link me to a tutorial on how to handle geospatial point objects within a yii model. I feel like this must be a really easy solution but I cannot seem to get my head around it. The source code for my model, form and controller are provided below:</p>\n\n<p>Model</p>\n\n<pre><code>&lt;?php\n\n/**\n * This is the model class for table \"store\".\n *\n * The followings are the available columns in table 'store':\n * @property integer $id\n * @property string $name\n * @property string $location\n */\nclass Store extends CActiveRecord\n{\n    /**\n     * Returns the static model of the specified AR class.\n     * @param string $className active record class name.\n     * @return Store the static model class\n     */\n    public static function model($className=__CLASS__)\n    {\n        return parent::model($className);\n    }\n\n    /**\n     * @return string the associated database table name\n     */\n    public function tableName()\n    {\n        return 'store';\n    }\n\n    /**\n     * @return array validation rules for model attributes.\n     */\n    public function rules()\n    {\n        // NOTE: you should only define rules for those attributes that\n        // will receive user inputs.\n        return array(\n            array('id, name, location', 'required'),\n            array('id', 'numerical', 'integerOnly'=&gt;true),\n            // The following rule is used by search().\n            // Please remove those attributes that should not be searched.\n            array('id, name, location', 'safe', 'on'=&gt;'search'),\n        );\n    }\n\n    /**\n     * @return array relational rules.\n     */\n    public function relations()\n    {\n        // NOTE: you may need to adjust the relation name and the related\n        // class name for the relations automatically generated below.\n        return array(\n        );\n    }\n\n    /**\n     * @return array customized attribute labels (name=&gt;label)\n     */\n    public function attributeLabels()\n    {\n        return array(\n            'id' =&gt; 'ID',\n            'name' =&gt; 'Name',\n            'location' =&gt; 'Location',\n        );\n    }\n\n    /**\n     * Retrieves a list of models based on the current search/filter conditions.\n     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.\n     */\n    public function search()\n    {\n        // Warning: Please modify the following code to remove attributes that\n        // should not be searched.\n\n        $criteria=new CDbCriteria;\n\n        $criteria-&gt;compare('id',$this-&gt;id);\n        $criteria-&gt;compare('name',$this-&gt;name,true);\n        $criteria-&gt;compare('location',$this-&gt;location,true);\n\n        return new CActiveDataProvider($this, array(\n            'criteria'=&gt;$criteria,\n        ));\n    }\n}\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>&lt;?php\n\nclass StoreController extends Controller\n{\n    /**\n     * @var string the default layout for the views. Defaults to '//layouts/column2', meaning\n     * using two-column layout. See 'protected/views/layouts/column2.php'.\n     */\n    public $layout='//layouts/column2';\n\n    /**\n     * @return array action filters\n     */\n    public function filters()\n    {\n        return array(\n            'accessControl', // perform access control for CRUD operations\n            'postOnly + delete', // we only allow deletion via POST request\n        );\n    }\n\n    /**\n     * Specifies the access control rules.\n     * This method is used by the 'accessControl' filter.\n     * @return array access control rules\n     */\n    public function accessRules()\n    {\n        return array(\n            array('allow',  // allow all users to perform 'index' and 'view' actions\n                'actions'=&gt;array('index','view'),\n                'users'=&gt;array('*'),\n            ),\n            array('allow', // allow authenticated user to perform 'create' and 'update' actions\n                'actions'=&gt;array('create','update'),\n                'users'=&gt;array('@'),\n            ),\n            array('allow', // allow admin user to perform 'admin' and 'delete' actions\n                'actions'=&gt;array('admin','delete'),\n                'users'=&gt;array('admin'),\n            ),\n            array('deny',  // deny all users\n                'users'=&gt;array('*'),\n            ),\n        );\n    }\n\n    /**\n     * Displays a particular model.\n     * @param integer $id the ID of the model to be displayed\n     */\n    public function actionView($id)\n    {\n        $this-&gt;render('view',array(\n            'model'=&gt;$this-&gt;loadModel($id),\n        ));\n    }\n\n    /**\n     * Creates a new model.\n     * If creation is successful, the browser will be redirected to the 'view' page.\n     */\n    public function actionCreate()\n    {\n        $model=new Store;\n\n        // Uncomment the following line if AJAX validation is needed\n        // $this-&gt;performAjaxValidation($model);\n\n        if(isset($_POST['Store']))\n        {\n            $model-&gt;attributes=$_POST['Store'];\n            if($model-&gt;save())\n                $this-&gt;redirect(array('view','id'=&gt;$model-&gt;id));\n        }\n\n        $this-&gt;render('create',array(\n            'model'=&gt;$model,\n        ));\n    }\n\n    /**\n     * Updates a particular model.\n     * If update is successful, the browser will be redirected to the 'view' page.\n     * @param integer $id the ID of the model to be updated\n     */\n    public function actionUpdate($id)\n    {\n        $model=$this-&gt;loadModel($id);\n\n        // Uncomment the following line if AJAX validation is needed\n        // $this-&gt;performAjaxValidation($model);\n\n        if(isset($_POST['Store']))\n        {\n            $model-&gt;attributes=$_POST['Store'];\n            if($model-&gt;save())\n                $this-&gt;redirect(array('view','id'=&gt;$model-&gt;id));\n        }\n\n        $this-&gt;render('update',array(\n            'model'=&gt;$model,\n        ));\n    }\n\n    /**\n     * Deletes a particular model.\n     * If deletion is successful, the browser will be redirected to the 'admin' page.\n     * @param integer $id the ID of the model to be deleted\n     */\n    public function actionDelete($id)\n    {\n        $this-&gt;loadModel($id)-&gt;delete();\n\n        // if AJAX request (triggered by deletion via admin grid view), we should not redirect the browser\n        if(!isset($_GET['ajax']))\n            $this-&gt;redirect(isset($_POST['returnUrl']) ? $_POST['returnUrl'] : array('admin'));\n    }\n\n    /**\n     * Lists all models.\n     */\n    public function actionIndex()\n    {\n        $dataProvider=new CActiveDataProvider('Store');\n        $this-&gt;render('index',array(\n            'dataProvider'=&gt;$dataProvider,\n        ));\n    }\n\n    /**\n     * Manages all models.\n     */\n    public function actionAdmin()\n    {\n        $model=new Store('search');\n        $model-&gt;unsetAttributes();  // clear any default values\n        if(isset($_GET['Store']))\n            $model-&gt;attributes=$_GET['Store'];\n\n        $this-&gt;render('admin',array(\n            'model'=&gt;$model,\n        ));\n    }\n\n    /**\n     * Returns the data model based on the primary key given in the GET variable.\n     * If the data model is not found, an HTTP exception will be raised.\n     * @param integer the ID of the model to be loaded\n     */\n    public function loadModel($id)\n    {\n        $model=Store::model()-&gt;findByPk($id);\n        if($model===null)\n            throw new CHttpException(404,'The requested page does not exist.');\n        return $model;\n    }\n\n    /**\n     * Performs the AJAX validation.\n     * @param CModel the model to be validated\n     */\n    protected function performAjaxValidation($model)\n    {\n        if(isset($_POST['ajax']) &amp;&amp; $_POST['ajax']==='store-form')\n        {\n            echo CActiveForm::validate($model);\n            Yii::app()-&gt;end();\n        }\n    }\n}\n</code></pre>\n\n<p>form:</p>\n\n<pre><code>&lt;?php\n/* @var $this StoreController */\n/* @var $model Store */\n/* @var $form CActiveForm */\n?&gt;\n\n&lt;div class=\"form\"&gt;\n\n&lt;?php $form=$this-&gt;beginWidget('CActiveForm', array(\n    'id'=&gt;'store-form',\n    'enableAjaxValidation'=&gt;false,\n)); ?&gt;\n\n    &lt;p class=\"note\"&gt;Fields with &lt;span class=\"required\"&gt;*&lt;/span&gt; are required.&lt;/p&gt;\n\n    &lt;?php echo $form-&gt;errorSummary($model); ?&gt;\n\n    &lt;div class=\"row\"&gt;\n        &lt;?php echo $form-&gt;labelEx($model,'id'); ?&gt;\n        &lt;?php echo $form-&gt;textField($model,'id'); ?&gt;\n        &lt;?php echo $form-&gt;error($model,'id'); ?&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row\"&gt;\n        &lt;?php echo $form-&gt;labelEx($model,'name'); ?&gt;\n        &lt;?php echo $form-&gt;textArea($model,'name',array('rows'=&gt;6, 'cols'=&gt;50)); ?&gt;\n        &lt;?php echo $form-&gt;error($model,'name'); ?&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row\"&gt;\n        &lt;?php echo $form-&gt;labelEx($model,'location'); ?&gt;\n        &lt;?php echo $form-&gt;textField($model,'location'); ?&gt;\n        &lt;?php echo $form-&gt;error($model,'location'); ?&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row buttons\"&gt;\n        &lt;?php echo CHtml::submitButton($model-&gt;isNewRecord ? 'Create' : 'Save'); ?&gt;\n    &lt;/div&gt;\n\n&lt;?php $this-&gt;endWidget(); ?&gt;\n\n&lt;/div&gt;&lt;!-- form --&gt;\n</code></pre>\n\n<p>This is a screenshot of what happens when I try to add row to the store table from the auto generated form:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Owp2b.png\" alt=\"error\"></p>\n\n<p>This is expected as a point object has to be constructed from the latitude and longitude. I do not know how to incorporate this into the Yii model.\nThanks in advance for any help provided!</p>\n"},{"tags":["c#","asp.net","sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13194185,"title":"How to display uploaded files in GridView and download them on clicking respective download linkbutton?","body":"<p>I am uploading files using fileupload, the details of the file such as file type, name of file, and complete path is getting stored in a table called exceldetails in database now i want to display the uploaded files and download them by clicking on a link button next to every file in GridView. This is how i am uploading files:</p>\n\n<pre><code>        string[] filePaths;\n    string strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();\n    string strFileName = FileUpload1.PostedFile.FileName.ToString();\n    FileUpload1.SaveAs(Server.MapPath(\"~/Import/\" + strFileName + strFileType));\n    string strNewPath = Server.MapPath(\"~/Import/\" + strFileName + strFileType);\n    string strNewPath1 = Server.MapPath(\"~/Import/\" + strFileName + strFileType).ToString();\n    fileSize = FileUpload1.PostedFile.ContentLength / 1024;\n\n    //EXCEL DETAILS TABLE\n    con.Open();\n    //=========================================\n    DataTable dt8 = new DataTable();\n    SqlCommand cmd8 = new SqlCommand(\"insert into exceldetails (name,type,details,size,path)\" + \"values(@name,@type,@details,@size,@path)\", con);\n    cmd8.Parameters.Add(\"@name\", SqlDbType.VarChar).Value = strFileName;\n    cmd8.Parameters.Add(\"@type\", SqlDbType.VarChar).Value = strFileType;\n    cmd8.Parameters.Add(\"@details\", SqlDbType.VarChar).Value = DateTime.Now;\n    cmd8.Parameters.Add(\"@size\", SqlDbType.Int).Value = fileSize;\n    cmd8.Parameters.Add(\"@path\", SqlDbType.NVarChar).Value = strNewPath;\n    cmd8.ExecuteNonQuery();\n    con.Close();\n    try\n    {\n        SqlDataAdapter da8 = new SqlDataAdapter(cmd8);\n        da8.Fill(dt8);\n    }\n    catch { }\n</code></pre>\n\n<p>I am a beginner as you can judge from the question itself so please tell me where i need to add what in detail</p>\n"},{"tags":["javascript","sql","sqlite","node.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12797332,"title":"SQLite SELECT * FROM table WHERE id=? Troubles","body":"<p>There's a gap in my knowledge here and I can't find the answer on the internet.</p>\n\n<p>Basically I'm making a node.js app that pushes entries from an SQLite Database using socket.io. </p>\n\n<p>I'm using the implementation of SQLite here -> <a href=\"https://github.com/developmentseed/node-sqlite3\" rel=\"nofollow\">https://github.com/developmentseed/node-sqlite3</a></p>\n\n<p>I'm trying to execute the statement:</p>\n\n<pre><code>db.serialize(function() {\n        db.run(\"SELECT * FROM messages WHERE id=?\", messageNum, function(err, row) {\n            console.log(row.id);            \n        });\n    });\n</code></pre>\n\n<p>I can't find documentation. It's throwing this error at the moment:</p>\n\n<p>Cannot read property 'id' of undefined</p>\n\n<p>I basically guessed the syntax... Anyone know what it actually is?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have got around the problem with an extremely inefficient solution for now:</p>\n\n<pre><code>db.serialize(function() {\n\n        db.each(\"SELECT id, msg, date FROM messages\", function(err, row) {\n            if(row.id === messageNum){\n                console.log(row.id);    \n            }\n        });\n\n    });\n</code></pre>\n\n<p>Would be good if someone could point me in the right direction at some point though, thanks.</p>\n"},{"tags":["android","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":7118270,"title":"Need find the number of days by taking date differnce in sqlite android","body":"<p>I need to get the no of days by taking the date difference of one date confirmation date hard coded value and other with current date in sqlite.</p>\n"},{"tags":["mysql","sql","phpmyadmin","whitespace","search-and-replace"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13194830,"title":"Remove double space in phpmyadmin","body":"<p>I need to remove the any double space (two spaces) that comes anywhere in the text in one my database tables..</p>\n\n<p>I tried:</p>\n\n<pre><code>update items set description= replace(description, '  ', ' ')\n</code></pre>\n\n<p>but this removes if it is only the spaces..  but the \"description\" cells has many words like: \"any&nbsp;text&nbsp;here&nbsp;&nbsp;more\", so I need to remove the two spaces before the word \"more\" at the example before, and leave everything else as is..  just replace the double space with one space anywhere.</p>\n"},{"tags":["sql","sqlite","group-by","aggregate-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13173445,"title":"Aggregation function for sqlite","body":"<p>Execute below script for create test table.</p>\n\n<pre><code>create table if not exists t1 (id1 int,id2 int);\n</code></pre>\n\n<p>Now, table is created, and it is empty table.</p>\n\n<p>Execute below script,</p>\n\n<pre><code>select max(id1), max(id2) from t1\n</code></pre>\n\n<p>It will return below result(one row).</p>\n\n<pre><code>max(id1)      max(id2)\n-----------   --------\n&lt;null&gt;        &lt;null&gt;\n</code></pre>\n\n<p>Execute below script,</p>\n\n<pre><code>select max(id1), max(id2) from t1 group by id1,id2\n</code></pre>\n\n<p>It will return below result(no result).</p>\n\n<pre><code>max(id1)      max(id2)\n-----------   --------\n</code></pre>\n\n<p>Is there somebody explain the reason?</p>\n"},{"tags":["php","sql","row"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":116,"score":-2,"question_id":8650351,"title":"Why isn't SQL showing the table row?","body":"<p>I clearly made an account on <code>register.php</code>. Then, when I test the code in the SQL section, I get rows 0 - 0 shown (one total, query took 0.0010&nbsp;sec). Even though there is an account it's returning that there is none.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>&lt;?php\n    $db_host = \"localhost\";\n    $db_username = \"izzydog\";\n    $db_name = \"challenge1\";\n    $db_password = \"********\";\n    $tbl_name = \"database1\"; // Table name]\n    $database1 = 'database1';\n\n    // Connect to server and select database.\n    $conn = mysql_connect(\"localhost\", \"izzydog\", \"********\") or die(\"cannot connect\");\n    mysql_select_db(\"challenge1\",$conn)or die(\"cannot select DB\");\n\n    // Username and password sent from form\n    $myusername = $_POST['myusername'];\n    $mypassword = $_POST['mypassword'];\n\n    // To protect MySQL injection (more details about MySQL injection)\n    $myusername = stripslashes($myusername);\n    $mypassword = stripslashes($mypassword);\n    $myusername = mysql_real_escape_string($myusername);\n    $mypassword = mysql_real_escape_string($mypassword);\n\n    $sql = \"SELECT * FROM $database1 WHERE username='$myusername' AND password='$mypassword'\";\n    $result = mysql_query($sql);\n\n    // Mysql_num_row is counting table row\n    $count = mysql_num_rows($result);\n    // If result matched $myusername and $mypassword, table row must be 1 row\n\n    if ($count == 1) {\n        session_register('myusername');\n        session_register('mypassword');\n        header('location:login_success.php');\n    }\n    else {\n        echo 'Wrong Username or Password';\n    }\n?&gt;\n</code></pre>\n"},{"tags":["mysql","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13195060,"title":"why sql query causes General error: 3 Error writing file '/tmp/MYzamaNT' (Errcode: 28) in mysql","body":"<p>This query:</p>\n\n<pre><code>SELECT `subscribers`.`email_address`, `subscribers`.`first_name`, `subscribers`.`last_name`,\n        GROUP_CONCAT( DISTINCT t1.value SEPARATOR '|' ) AS 'Colors', GROUP_CONCAT( DISTINCT t2.value SEPARATOR '|' ) AS 'Languages'\nFROM `subscribers`\nLEFT JOIN `subscribers_multivalued` AS `t1` ON subscribers.subscriber_id = t1.subscriber_id AND t1.field_id = 112\nLEFT JOIN `subscribers_multivalued` AS `t2` ON subscribers.subscriber_id = t2.subscriber_id AND t2.field_id = 111\nWHERE (list_id = 40) AND (state = 1)\nGROUP BY `subscribers`.`email_address` , `subscribers`.`first_name` , `subscribers`.`last_name`\n</code></pre>\n\n<p>With execute plan:</p>\n\n<pre><code>id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra\n1   SIMPLE  subscribers     ref     FK_list_id,state_date_added     FK_list_id  4   const   1753610     Using where; Using filesort\n1   SIMPLE  t1  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n1   SIMPLE  t2  ref     subscriber_fk,field_fk  subscriber_fk   4   chad0598_mailablel.subscribers.subscriber_id    1    \n</code></pre>\n\n<p>Caused error: General error: 3 Error writing file '/tmp/MYzamaNT' (Errcode: 28) in mysql.\nThere was 4 Gb of disk space, then we increase disk space and there is not error, but mysql consumes about 5 Gn space during execution of query (one could see df -H on linux) and query was very slow.\nThis query is use for exporting from one of the list. The exported data in the file is about 50 Mb.  During query mysql write large temp files.\nWhy doesn't this query cosume so much disk space?</p>\n"},{"tags":["c#","sql","winforms","dataset"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13193827,"title":"how to add dataset values to sql","body":"<p>I am new to SQL (started today itself), how to add data of dataset to the database table when the table in database has the first column as automatic generating numbers i.e., (IDENTITY (1,1))</p>\n\n<p>I have DataSet something like this</p>\n\n<pre><code>  name    age    location\n\n   x      30       yyy\n   y      20       ppp\n</code></pre>\n\n<p>The table in Database is something like this</p>\n\n<pre><code>  Id(auto)   name    age    location\n\n  --------  no data  --------------\n</code></pre>\n\n<p>First of all I am filling the Dataset from the database table.<br>\nSince the first column is autogenerated I cant even add new values to DataSet.\nIf I say </p>\n\n<pre><code> dsMainDoctors.Tables[0].Rows.Add( /* first column is autogenerated so I am leaving it*/\n                secondColumn,\n                thirdColumn,\n                fourthColumn,\n                FifthColumn);\n</code></pre>\n\n<p>Error --> Input string was not in a correct format.Couldn't store  in Doctor_ID Column.  Expected type is Int32.</p>\n\n<p>The code I am trying is: (<em>When I given the first column value manually in the DataSet</em>)</p>\n\n<pre><code>        SqlConnection conn = new SqlConnection(strConn);\n        SqlCommand cmd = new SqlCommand(strQuery, conn);\n        SqlDataAdapter da = new SqlDataAdapter(cmd);\n        conn.Open();\n        da.Update(ds.Tables[0]);  //ERROR :- Update requires a valid InsertCommand when passed DataRow collection with new rows.\n        conn.Close();\n        conn.Dispose();\n        cmd.Dispose();\n</code></pre>\n\n<hr>\n\n<pre><code> strQuery --&gt; \"delete from [dbo].[\" + table_name + \"]\";\n</code></pre>\n\n<p>I could have searched this before asking but I dont know what keywords I should use<br>\nPlease answer in comments if it is very easy question.</p>\n"},{"tags":["sql","database","vb.net","dbf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":195,"score":0,"question_id":11234298,"title":"SQL/DBF Updating records from one table to another table located in different folder (*.dbf)","body":"<p>Updating records from one table to another table located in different folder.</p>\n\n<pre><code>Dim connection As New ADODB.Connection\nDim strConnection As String\nDim pathPrincipal As String\nDim pathUpdate As String 'External data base to update with TablePrincipal\nDim strSQL As String\n\npathPrincipal = \"D:\\DBFs\"\nstrConnection = \"Driver={Microsoft dBASE Driver (*.dbf)};DriverID=277;Dbq=\" &amp; PathPrincipal \n\nconnection.Open strConnection\nIf connection.State &lt;&gt; adStateOpen Then Exit Sub\n</code></pre>\n\n<p>'Correct :)</p>\n\n<pre><code>strSQL=\"UPDATE TablePrincipal#DBF\" &amp; \" A INNER JOIN \" &amp; \"TableUpdate#DBF\" &amp; \" B ON A.ID = B.ID SET A.X=B.X, A.Y=B.Y\"\n'Execute \nconnection.Execute strSQL, n, adCmdText\n</code></pre>\n\n<p>PREVIOUS CODE WORKS TO PERFECTION.....</p>\n\n<p>BUT MY PROBLEM IS WHEN BOTH DBF NOT IN THE SAME FOLDER BUT I AM TRYING THIS IS NOT WHAT ELSE DO</p>\n\n<pre><code>'No working for external DBF :'( :(\nstrSQL = \"UPDATE TablePrincipal#DBF A INNER JOIN\" &amp; _\n         \" OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)}; DBQ=\" &amp; _\n         pathUpdate &amp; \"; SourceType = DBF ','SELECT * FROM TableUpdate#DBF') B\" &amp; _\n         \" ON A.ID=B.ID SET A.X=B.X, A.Y=B.Y\"\n</code></pre>\n\n<p>ANYONE CAN HELP ME.....PLEASEEEE!!!! HELP\nAPOLOGIES FOR MY ENGLISH :)</p>\n"},{"tags":["mysql","sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":5120,"score":0,"question_id":4712809,"title":"MySQL remove duplicate rows","body":"<p>I have a comments table, whose structure is as:</p>\n\n<pre><code>id, name, email, comment\n</code></pre>\n\n<p>I have many duplicate comments, with same name and email. I need to remove them, can anyone suggest me how can I achieve this using a single query?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql","database","dbf","elevatedb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":11265333,"title":"How to Import Data from .DBF file to Some Other Database like ElevateDB?","body":"<p>I have large file say named as \"customers\" and it is in .DBF format. Now I want to import that .DBF file data to ElevateDB database. ,,,Is ther any ways to import data by Query or write program for import from .DBF to ElevateDB...</p>\n"},{"tags":["sql","oracle"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13187663,"title":"Oracle SQL - Putting together potentially contradictory or overlapping date ranges","body":"<p>I have a table like this:</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     05-JAN-12\n1     01-FEB-12     01-MAR-12\n1     15-FEB-12     05-MAR-12\n</code></pre>\n\n<p>For a given Id, it gives a set of date ranges. Let's say that if a date is between the begin and end date for that Id, then that Id is \"on\". Otherwise, \"off\"</p>\n\n<p>The problem here is these last two rows -- the date ranges overlap and contradict each other. The second row claims that the 1 was \"on\" between 01-FEB-12 and 01-MAR-123, but the third row claims that 1 was off before before 14-FEB-12. Similarly, the second row claims that 1 was off on 02-MAR-12, but row 3 claims it was on.</p>\n\n<p>The reconciliation logic I'd like to apply is that, in cases of contradictions, pick the earliest possible begin date and the earliest possible end date after it. The result would therefore be:</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     05-JAN-12\n1     01-FEB-12     01-MAR-12\n</code></pre>\n\n<p>I was able to pull this off with the lag analytical function, but I ran into difficulty with other use cases. Take this input data set.</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     10-JAN-12\n1     5-JAN-12      8-JAN-12\n1     12-JAN-12     15-JAN-12\n1     1-JAN-12      14-JAN-12\n</code></pre>\n\n<p>What I expect here as output is:</p>\n\n<pre><code>Id    Begin_Date    End_date    \n1     01-JAN-12     8-JAN-12\n1     01-JAN-12     14-JAN-12\n</code></pre>\n\n<p>...because the first row is the earliest begin date, and its end date is the earliest end date after that. The next row is the earliest begin date after the previous end date, and the end date of that row is the earliest end date after that. There are no begin dates after 14-JAN-12, so I'm done.</p>\n\n<p>I'm having very little luck solving this problem. One approach I tried was getting the rank partitioned by id and compare it to the max rank. I then used the lag function to compare to previous ranks. However, this strategy totally fails for use cases above.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["sql","sql-server","tsql"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13194026,"title":"SQL Dynamic join?","body":"<p>Please see <a href=\"http://sqlfiddle.com/#!3/2506f/2/0\" rel=\"nofollow\">http://sqlfiddle.com/#!3/2506f/2/0</a></p>\n\n<p>I have two tables.  One is a general record, and the other is a table containing related documents that link to that record.</p>\n\n<p>In my example I've created a straightforward query which shows all records and their associated documents.  This is fine, but I want a more complex situation.</p>\n\n<p>In the 'mainrecord' table there is a 'multiple' field.  If this is 0, then I only want the most recent document from the documents table (that is, with the highest ID).  If it is 1, I want to join all linked documents.</p>\n\n<p>So, rather than the result of the query being this:-</p>\n\n<pre><code>ID  NAME    MULTIPLE    DOCUMENTNAME    IDLINK\n1   One     1           first document    1\n1   One     1           second document   1\n2   Two     0           third document    2\n2   Two     0           fourth document   2\n3   Three   1           fifth document    3\n3   Three   1           sixth document    3\n</code></pre>\n\n<p>It should look like this:-</p>\n\n<pre><code>ID  NAME    MULTIPLE    DOCUMENTNAME    IDLINK\n1   One     1           first document    1\n1   One     1           second document   1\n2   Two     0           fourth document   2\n3   Three   1           fifth document    3\n3   Three   1           sixth document    3\n</code></pre>\n\n<p>Is there a way of including this condition into my query to get the results I'm after.  I'm happy to explain further if needed.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","sql-server"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13194307,"title":"SQL Server Insert based of additional query","body":"<p>Using SQL server is it possible to to a mass insert based on a sub query, Essentially I'm trying to do this.</p>\n\n<pre><code>Insert into ProductExtra (ProductID,ExtraID) \nVALUES \n(Select ProductID From ProductSKU \nJOIN Product on ProductSKU.ProductID = Product.ID\nWhere ItemType = 'fire grate' ), 10739\n</code></pre>\n"},{"tags":["mysql","sql","table","select","export"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13194000,"title":"convert one table into two new tables","body":"<p>I am trying to move data from one table into two new tables, but I am unsure how I can do this in the best and most foolproof way.</p>\n\n<p>I have about 2000 rows in newsletter_users that looks like this:</p>\n\n<pre><code>userid company email memberofgroup\n</code></pre>\n\n<p>where </p>\n\n<pre><code>memberofgroup \n</code></pre>\n\n<p>is an integer that refers to newsletter_mailgroups. This is not the best way if a user wants to be a member of different groups. Then there will be x rows with the same email. 2000 users x 3 or 4 different groups (what did I think of??) Therefore I have made two new tables</p>\n\n<p>newsletter_members that look like this</p>\n\n<pre><code>userid email company\n</code></pre>\n\n<p>and another table newsletter_member_of_group that look like this:</p>\n\n<pre><code>field_member_uid field_user_id field_memberofgroup\n</code></pre>\n\n<p>where </p>\n\n<pre><code>field_user_id\n</code></pre>\n\n<p>will contain a users id from newsletter_members and </p>\n\n<pre><code>field_memberofgroup \n</code></pre>\n\n<p>will contain the emailgroup id. f.x.</p>\n\n<pre><code>field_user_id  field_memberofgroup \n    2                 6\n    2                 4\n    2                 8\n    3                 1\n    5                 6\n</code></pre>\n\n<p>How can I export and then import them in the best way so that emails will not duplicate in newsletter_members? - I might need to do a manual check to see which users a members of more than one mailgroup.</p>\n\n<p>Mailgroups table:</p>\n\n<pre><code>1   Forhandlere \n2   Arkitekter og byggerÃ¥dgivere   \n3   Typehusfabrikanter  \n4   ByggeentreprenÃ¸rer \n5   Murermestre \n6   TÃ¸mrermestre   \n7   TagdÃ¦kkere \n8   Boligforeninger/Ejendomsselskaber   \n9   Bygge-interesserede \n10  Tyske modtagere \n11  Landskabsarkitekter \n12  Norske arkitekter   \n13  Svenske arkitekter  \n14  Norske forhandlere  \n15  Svenske forhandlere \n16  Brancherelaterede   \n17  Svenske ansatte \n18  Norske ansatte  \n19  Beijer Sverige  \n</code></pre>\n"},{"tags":["sql","sql-server-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13192885,"title":"SQL Server 2012 CDC capture my Active Directory account / user information","body":"<p>I have activated CDC on my database for one table:</p>\n\n<pre><code>USE [Test]\nGO\n\nCREATE TABLE [dbo].[CDC_TestTable](\n[ID] [int] NOT NULL,\n[Name] [nvarchar](50) NOT NULL\n) ON [PRIMARY]\n\nGO\n\nEXEC sys.sp_cdc_enable_db\nGO\n\nEXECUTE sys.sp_cdc_enable_table\n@source_schema = N'dbo'\n, @source_name = N'CDC_TestTable'\n, @role_name = N'NULL'\n;\nGO\n</code></pre>\n\n<p>Now the question: How can I capture user information like which user has added / deleted / updated a record in this table ?</p>\n\n<p>I have tried with : </p>\n\n<pre><code>ALTER TABLE [cdc].[dbo_CDC_TestTable_CT] ADD UserName nvarchar(50) NULL DEFAULT(System_User)\ngo\n</code></pre>\n\n<p>but when I logon to this database with my Windows authentication and add / change records it just shows me the user sa ?!</p>\n\n<p>Is it in principal possible with CDC to get the information, which user profile has changed the records ?</p>\n\n<p>Who can help ?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","sql-server","sql-server-ce","cascade"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":27,"score":3,"question_id":13193935,"title":"Cascade delete on many-to-many between same table","body":"<p>I'm trying to create a many-to-many relation between the same table in SQL Server.</p>\n\n<p>I have one table <code>Object</code> with columns <code>ObjectId</code> and <code>Name</code>.</p>\n\n<p>The relation follows these rules:  </p>\n\n<ul>\n<li>a child can have many parents  </li>\n<li>a parent can have many children  </li>\n<li>ObjectA can be a child of ObjectB and ObjectB can be a child of ObjectA  </li>\n<li>but an object cannot be a direct child of itself</li>\n</ul>\n\n<p>So I create a second table <code>ObjectRelation</code> with columns <code>ParentId</code> and <code>ChildId</code> and of course I want these relations to be deleted by cascade.</p>\n\n<p>But when I try this in SQL Server I get the error </p>\n\n<blockquote>\n  <p>Introducing FOREIGN KEY constraint 'FK_ObjectRelation_Object1' on table 'tblADMembership' may cause cycles or multiple cascade paths. Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, or modify other FOREIGN KEY constraints.</p>\n</blockquote>\n\n<p>In SQL Server Compact I get</p>\n\n<blockquote>\n  <p><em>The referential relationship will result in a cyclical reference that is not allowed.</em></p>\n</blockquote>\n\n<p>I've done some research and I understand why I get these errors, but is there a way around this that will also work on SQL Server Compact (so no stored procedures)? Or is there a better way to model this relationship?</p>\n"},{"tags":["mysql","sql","text","phpmyadmin","append"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13193750,"title":"add text to an existing cell in phpmyadmin","body":"<p>I want to add text to the the end of a cell in phpmyadmin, where it just adds the text to the end whatever in that cell, and keeps whatever there as is.</p>\n\n<p>I tried this but doesn't work:</p>\n\n<pre><code>update items set description = contact(description, \" - text to add\") where parent_id ='2907'\n</code></pre>\n\n<p>So the cell should be instead of</p>\n\n<pre><code>something here\n</code></pre>\n\n<p>to be:</p>\n\n<pre><code>something here - text to add\n</code></pre>\n"},{"tags":["sql","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13193852,"title":"Copy from all tables, insert into all tables (sp_MSforeachtable alternative)","body":"<p>I've decided to share my experience in trying to copy data from all tables into the same name tables in a different schema. I'm sure my experience can help others seeking mass table operations without using the unsupported and frankly limited sp_MSforeachtable.</p>\n\n<p><strong>Objective:</strong> Copy data from all tables in my database to identically named tables with different schema</p>\n\n<p><em>One quick note about</em> sp_MSforeachtable. <em>Most of the time when people ask questions here in SO about this stored procedure, there's some reply or another saying that we shouldn't use unsupported features. This is simply not true, what we shouldn't do is have practices and design decisions based on unsupported features, mostly because they might go away.\nBut at some specific point in time, if an unsupported feature exists and does exactly what we need to do right then, one-off style, then just consider yourself lucky and by all means use it, just be careful about unexpected behaviors. When using such features, best to stick with simple operations whose output is quickly and easily verifiable.</em></p>\n\n<p>With that said, and also because there's some real limitations to sp_MSforeachtable, I am presenting a different but not too complicated way of executing statements against all (or specific) tables in our database and I'm using my problem as an example.</p>\n"},{"tags":["sql","sql-server-2008","insert","numeric","column"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":86,"score":4,"question_id":13189688,"title":"Insert empty string into INT column for SQL Server","body":"<p>A <code>SAMPLE</code> table has only one column <code>ID</code> of type <code>int</code>, default null.</p>\n\n<p>In Oracle when I do:</p>\n\n<pre><code>  insert into SAMPLE (ID) values ('');\n</code></pre>\n\n<p>the new record is added with blank value. But in SQL Server 2008, when I run the same <code>insert</code> statement, the new record has the value of 0. </p>\n\n<p>Is there a way to force SQL Server 2008 to default blank string to NULL instead of 0 (for numerical type of columns)?</p>\n"},{"tags":["sql","exists","oracle9i"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13000124,"title":"Oracle missing parenthesis when it isn't","body":"<pre><code>SELECT company_name\nFROM empl_company s\nWHERE NOT EXISTS \n(\n    (SELECT city\n     FROM empl_company\n     WHERE company_name = 'Small Bank Corporation'\n     )\n     EXCEPT\n    (SELECT city\n     FROM empl_company k\n     WHERE k.company_name = s.company_name\n     ) \n);\n</code></pre>\n\n<p>I become an error\nORA-00907: missing right parenthesis\ncan enyone tell me what's the problem?</p>\n"},{"tags":["sql","sql-server","sql-server-2008","tsql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13193627,"title":"SQL - Update causing deadlock error","body":"<p>I'm trying to update a row in a table upon someone viewing the page (it increments the viewed count), however now and then I get a deadlock error, I'm guessing this is due to two or more people trying to update the same row?</p>\n\n<p>The error is:</p>\n\n<pre><code>Transaction (Process ID 60) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.\n</code></pre>\n\n<p>And my SQL is:</p>\n\n<pre><code>UPDATE [ProductDescription] \nSET [ViewCount] = ([ViewCount] + 1) \nWHERE ProductCode = @prodCode \n    AND ApplicationID = @AppID\n</code></pre>\n\n<p>I believe I may need a WITH(NOLOCK)?</p>\n"},{"tags":["sql","mysql","query"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":8038,"score":3,"question_id":1783784,"title":"SQL Delete Rows Based on Another Table","body":"<p>This is probably very easy, but it's Monday morning.  I have two tables:</p>\n\n<p>Table1:</p>\n\n<pre><code>Field        | Type             | Null | Key | Default | Extra\nid           | int(32) unsigned | NO   | PRI | NULL    | auto_increment\ngroup        | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Table2:</p>\n\n<pre><code>Field     | Type             | Null | Key | Default | Extra\ngroup     | int(32)          | NO   |     | 0       |\n</code></pre>\n\n<p>Ignoring other fields...I would like a single SQL DELETE statement that will delete all rows in Table1 for which there exists a Table2.group equal to Table1.group. Thus, if a row of Table1 has group=69, that row should be deleted if and only if there exists a row in Table2 with group=69.</p>\n\n<p>Thank you for any help.</p>\n"},{"tags":["mysql","sql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":35,"score":-1,"question_id":13193427,"title":"How to select two same column from single table in single select query","body":"<p>I have a table called Employee having columns empId, empName, managerId. here manager is an employee. how do i get employee-name and manager-name from the above table.</p>\n"},{"tags":["sql","sql-server","query","postgresql","plpgsql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13008116,"title":"routing network function issue","body":"<p>Following on from a <a href=\"http://stackoverflow.com/q/12990638/398670\">this question</a>, I have some dynamic SQL I'm running successfully in PL/PgSQL with <code>EXECUTE</code>, but it doesn't seem to have the intended effect.</p>\n\n<p>The following code is part of a plpgsql function that I have created. This intends to go to each point that is lying on the same track and for each point find its nearest point in order to eventually I will create a network between all the tracks. For some reson it is not working properly.</p>\n\n<p>The i represent the number of the current track.</p>\n\n<pre><code> DECLARE\n    _r record;\n    i int := 0;\n    source_geom character varying;\n    target_geom character varying;\n\nBEGIN\n\nWHILE i &lt; 3 --DEPENDS ON THE NUMBER OF TRACKS\nLOOP\n\nFOR _r IN EXECUTE ' SELECT a.'|| quote_ident(gid_cname) || ' AS id,'\n|| ' st_astext( a.'||quote_ident(geo_cname)||') AS source,' \n|| ' st_astext(b.'||quote_ident(geo_cname)||') AS target, ' \n|| ' ST_Distance(a.'||quote_ident(geo_cname) || ' ,  b.'||quote_ident(geo_cname)||') As dist_ft'\n|| ' FROM ' || quote_ident (geom_table) ||' AS a INNER JOIN ' || quote_ident(geom_table) || ' As b ON ST_DWithin(a.'||quote_ident(geo_cname)|| ', b.'||quote_ident(geo_cname)|| ',1000)'\n|| ' WHERE b.'||quote_ident(gid_cname)|| ' &gt; a.'||quote_ident(gid_cname)|| ' AND b.'||quote_ident(tid_cname)|| ' = '||i|| 'AND a.'||quote_ident(tid_cname)|| ' = '||i|| \n   ' ORDER BY dist_ft '\n|| ' Limit 1 '\n\nLOOP\n\nsource_geom := _r.source;\ntarget_geom := _r.target;\n\n\nEXECUTE 'update ' || quote_ident(geom_table) || \n    ' SET source = ''' || source_geom ||''' \n    , target = ''' || target_geom || ''' \n    WHERE ' || quote_ident(gid_cname) || ' =  ' || _r.id;\nEND LOOP;\n\ni = i + 1;\n\nEND LOOP;\n\nRETURN 'OK';\nEND;\n</code></pre>\n\n<p>The thing is that I have tested the query in plain sql and it worked brilliantly. Now for some reason in plpgsql it is not working properly. Below you can find the same query in plain sql. </p>\n\n<pre><code>SELECT a.ogc_fid AS id, st_astext( a.wkb_geometry) AS source, st_astext(b.wkb_geometry) AS target, ST_Distance(a.wkb_geometry, b.wkb_geometry) As dist_ft\nFROM track_points AS a INNER JOIN track_points As b\nON ST_DWithin(a.wkb_geometry , b.wkb_geometry, 1000)\nWHERE b.ogc_fid &gt; a.ogc_fid AND b.track_fid = 0 AND a.track_fid = 0 \norder by dist_ft\n</code></pre>\n"},{"tags":["java","sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13193527,"title":"What is the difference btw callableStatement,preparedStatment and Statement obj?","body":"<p>What is the difference btw callableStatement,preparedStatment and Statement obj ?</p>\n"},{"tags":["sql","postgresql","common-table-expression"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13191885,"title":"hierarchical sum in PostgreSQL","body":"<p>This is a simplified version of a problem I am encountering in PostgreSQL.</p>\n\n<p>I have the following table <strong>A</strong>:</p>\n\n<p><strong>[ ID</strong> <em>INTEGER</em>  <strong>| VALUE</strong> <em>NUMERIC(10,2)</em> <strong>| PARENT</strong> <em>INTEGER</em> <strong>]</strong></p>\n\n<p>Where 'PARENT' is a self-referencing FK to column ID.</p>\n\n<p>The table definition is:</p>\n\n<pre><code>CREATE TABLE A(ID INTEGER IDENTITY, VALUE NUMERIC(10,2), PARENT INTEGER)                                    \nALTER  TABLE A ADD CONSTRAINT FK FOREIGN KEY (PARENT) REFERENCES A(ID) \n</code></pre>\n\n<p>This simple table allows one to define tree data structures of arbitrary depth. Now I need to write a SQL (I prefer not to use server-side PL-SQL) that reports for each node, the total value of the sub-tree \"hanging\" under it. For instance, with the following table:</p>\n\n<pre><code>|  ID  | VALUE | PARENT |\n-------------------------\n|   1  | NULL  | NULL   |\n|   2  | 3.50  |    1   |\n|   3  | NULL  | NULL   |\n|   4  | NULL  |    3   |\n|   5  | 1.50  |    4   |\n|   6  | 2.20  |    4   |\n</code></pre>\n\n<p>I should get the following result set:</p>\n\n<pre><code>| ID  |  Total-Value-of-Subtree |\n|  1  |                  3.50   |\n|  2  |                  3.50   |\n|  3  |                  3.70   |\n|  4  |                  3.70   |\n|  5  |                  1.50   |\n|  6  |                  2.20   |\n</code></pre>\n\n<p>For simplicitly, you can assume that only leaf nodes have values, non-leaf nodes always have a value of <strong>NULL</strong> in the <strong>VALUE</strong> column. Is there a way to do this in SQL, even utilizing PostgreSQL-specific extensions?</p>\n"},{"tags":["sql","sql-server-2008-r2","crystal-reports-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13192989,"title":"Stock Turnover Analysis Grouping Query","body":"<p>I wanted to know how to modify the query below to give me opening stock, receipts, issues and closing stock such that</p>\n\n<p>opening stock + receipts - issues = closing stock and have it such that ItemCode shows only once per warehouse.</p>\n\n<pre><code>SELECT DISTINCT T0.ItmsGrpNam, T2.DocDate, T2.Warehouse, T1.ItemCode, T1.ItemName,\n(SUM(T1.OnHand) - SUM(T2.InQty)) AS 'Opening Stock', \nSUM(T2.InQty) AS 'Receipts',\nSUM(T2.OutQty) AS 'Issues', \n(SUM(T1.OnHand) - SUM(T2.InQty)) + SUM(T2.InQty) - SUM(T2.OutQty) AS 'Closing Stock' \nFROM OITB T0 INNER JOIN OITM T1 ON T0.ItmsGrpCod = T1.ItmsGrpCod\nINNER JOIN OINM T2 ON T1.ItemCode = T2.ItemCode\nGROUP BY T0.ItmsGrpNam, T2.DocDate, T1.ItemCode, T1.ItemName, T2.Warehouse, T2.InQty , T2.OutQty, T1.OnHand\nORDER BY T1.ItemCode \n</code></pre>\n\n<p>I run it in Crystal Reports where a user can enter parameters of start and end date, select itemgroupcode and warehouse as below </p>\n\n<pre><code>{Command.DocDate} &gt;= {?StartDate} and\n{Command.DocDate} &lt;= {?EndDate} and\n{Command.ItmsGrpNam} = {?@Select ItmsGrpNam From OITB order by ItmsGrpNam }\nand {Command.Warehouse} = {?@Select WhsCode From OWHS} \n</code></pre>\n\n<p>Sample SQL SERVER 2008 results are in the attached jpeg file.</p>\n\n<p>From the results, I would like the ItemCode to only appear once such that I can see only one opening stock, receipts...etc per warehouse for the given item codes<img src=\"http://i.stack.imgur.com/fL9UV.jpg\" alt=\"enter image description here\">. How do I achieve this?</p>\n"},{"tags":[".net","sql","sql-server","dataset"],"answer_count":7,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":11956,"score":7,"question_id":589976,"title":"How can you name the Dataset's Tables you return in a stored proc?","body":"<p>I've got the following stored procedure</p>\n\n<pre><code>Create procedure psfoo ()\nAS\nselect * from tbA\nselect * from tbB\n</code></pre>\n\n<p>I'm then accessing the data this way :</p>\n\n<pre><code>     Sql Command mySqlCommand = new SqlCommand(\"psfoo\" , DbConnection)\n     DataSet ds = new DataSet();\n     mySqlCommand.CommandType = CommandType.StoredProcedure;\n     SqlDataAdapter mySqlDataAdapter = new SqlDataAdapter();\n     mySqlDataAdapter.SelectCommand = mySqlCommand;\n     mySqlDataAdapter.Fill(ds);\n</code></pre>\n\n<p>Now, when I want to access my tables, I have to do this :</p>\n\n<pre><code>     DataTable datatableA = ds.Tables[0];\n     DataTable datatableB = ds.Tables[1];\n</code></pre>\n\n<p>the dataset Tables property also got an accessor by string (instead of int).</p>\n\n<p><strong>Is it possible so specify the name of the tables in the SQL code, so that I can instead write this :</strong></p>\n\n<pre><code>     DataTable datatableA = ds.Tables[\"NametbA\"];\n     DataTable datatableB = ds.Tables[\"NametbB\"];\n</code></pre>\n\n<p>I'm using SQL server 2008, if that makes a difference.</p>\n"}]}
