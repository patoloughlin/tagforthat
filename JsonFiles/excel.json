{"count":18514,"tag":"excel","questions":[{"tags":["excel","heading"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13280862,"title":"calculating heading from latitude and longitude in excel","body":"<p>I would like to calculate heading direction from the north between 2 points with P1(lat1 , long2) and P2(lat2 long2), in excel.</p>\n"},{"tags":["excel","datatable","openxml","openxml-sdk"],"answer_count":7,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":4697,"score":5,"question_id":3837981,"title":"reading Excel Open XML is ignoring blank cells","body":"<p>I am using the <a href=\"http://stackoverflow.com/questions/3321082/from-excel-to-datatable-in-c-with-open-xml\">accepted solution here</a> to convert an excel sheet into a datatable.  This works fine if I have \"perfect\" data but if I have a blank cell in the middle of my data it seems to put the wrong data in each column.</p>\n\n<p>I think this is because in the below code:</p>\n\n<pre><code>row.Descendants&lt;Cell&gt;().Count()\n</code></pre>\n\n<p>is number of populated cells (not all columns) AND:</p>\n\n<pre><code>GetCellValue(spreadSheetDocument, row.Descendants&lt;Cell&gt;().ElementAt(i));\n</code></pre>\n\n<p>seems to find the next populated cell (not necessarily what is in that index)  so if the first column is empty and i call ElementAt(0), it returns the value in the second column.</p>\n\n<p>Here is the full parsing code.</p>\n\n<pre><code>DataRow tempRow = dt.NewRow();\n\nfor (int i = 0; i &lt; row.Descendants&lt;Cell&gt;().Count(); i++)\n{\n    tempRow[i] = GetCellValue(spreadSheetDocument, row.Descendants&lt;Cell&gt;().ElementAt(i));\n    if (tempRow[i].ToString().IndexOf(\"Latency issues in\") &gt; -1)\n    {\n        Console.Write(tempRow[i].ToString());\n    }\n}\n</code></pre>\n"},{"tags":["excel","vba","macros","replace","find"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13263154,"title":"Excel - Find and replace multiple words","body":"<p>I just want to do a simple find and replace for multiple strings. For example, I need to replace all \"A1\", \"A2\", \"A3\" with \"system\" and all \"B1\", \"B2\" with \"ACC\" and so on...</p>\n\n<p>Does anyone know a good route to take? I'm just not sure how to get this started. Thanks for the help!</p>\n"},{"tags":["asp.net","vb.net","excel",".net-3.5","asp.net-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13276905,"title":"Sending an Excel file to the client","body":"<p>I am trying to send an Excel file to the client of an ASP.Net web page, but it doesn't work.</p>\n\n<p>When the user clicks a button, some data from our server-side database is formatted, put in an Excel file and sent to the user (as a direct download).</p>\n\n<p>Everything works well, except the sending part and any help would be greatly appreciated.</p>\n\n<p>Here is the code I'm using right now (client side):</p>\n\n<pre><code>var dataAjax = {};\n$.ajax({\n    async: false,\n    type: \"POST\",\n    url: \"Default.aspx/BuildExcelFile\",\n    contentType: \"application/json\",\n    data: JSON.stringify(dataAjax),\n    dataType: \"text\",\n    success: function(html) {\n        //alert(html);\n    },\n    error: function(request, status, error) {\n        alert(\"An error occurred : [\" + error + \"]\");\n    }\n\n});\n</code></pre>\n\n<p>And the server side code:</p>\n\n<pre><code>&lt;WebMethod()&gt; _\nPublic Shared Function BuildExcelFile() As String\n    Dim localExcelPath = \"C:\\temp1111.xlsx\"\n\n    'Build the excel file here...\n    '...\n\n    'Delete the old version of the Excel file\n    System.IO.File.Delete(localExcelPath)\n    'Save the Excel File locally\n    xWorkSheet.SaveAs(localExcelPath)\n    xWorkBook.Close()\n    exc.Quit()\n\n    'The generated excel is valid, can be opened on the server just fine\n\n    'Send the excel file to the client\n    'This part is not working! :(\n    System.Web.HttpContext.Current.Response.Clear()\n    System.Web.HttpContext.Current.Response.ContentType = \"MS-Excel/xls\"\n    System.Web.HttpContext.Current.Response.AppendHeader(\"Content-Disposition\", \"attachment; filename=\" &amp; System.IO.Path.GetFileName(localExcelPath))\n    System.Web.HttpContext.Current.Response.TransmitFile(localExcelPath)\n    System.Web.HttpContext.Current.Response.End()\n\n    Return \"Success\"\n\nEnd Function\n</code></pre>\n\n<p>I am getting this error when I try to verify the value of <code>Current.Response</code></p>\n\n<pre><code>Response: Cannot refer to an instance member of a class from within a shared method or shared member initializer without an explicit instance of the class.\n</code></pre>\n\n<p>Also, if I remove the <code>Response.End()</code> call, the data is received in the html variable of the <code>success</code> function in the ajax. However, I want the file to be downloaded, not received as text... </p>\n\n<p>If I keep Response.End(), I get an <code>Internal Server Error</code>.</p>\n\n<p>Is it not working because my Webmethod is shared? \nAny clue what's going on here? What can I do to fix this problem?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I'm using .Net 3.5, if that matters</p>\n\n<p>I'm not using MVC</p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13273759,"title":"When performing text to columns for multiple columns spaces seem to affect the delimiting process","body":"<p>My first worksheet contains a number of filled columns. At the bottom I have code that copies one of these columns into the second sheet and performs text to columns. It then repeats the process copying another column into the next available column in the second sheet.</p>\n\n<p><strong>PROBLEM:</strong>\nIt seems that when the code encounters a blank in the first cell of a particular column in the second sheet, the text to columns action doesn't work correctly.</p>\n\n<p>If  columns in sheet 1 (\"Paste in\") looked like:</p>\n\n<pre><code>------------------------------------------\nColumn 1    column 2   column 3  column 4\na b         c  d                  e  f           \ng h         i  j       k l        m n \n</code></pre>\n\n<hr>\n\n<p>After text to columns in sheet 2 (\"TOP LINE\") it wrongly looks something like this:</p>\n\n<pre><code>---------------------------------------------------\nC1  C2  C3  C4  C5  C6  C7  C8  \na    b   c   d   e   f\ng    h   i   j   k   n\n</code></pre>\n\n<hr>\n\n<p>Thus after cell 1 in column 3 in sheet 1 is found to be empty, some of the text in sheet 2 after column 4 is missing (l and m have disappeared). I think this is down to the following line from the code below but I'm not sure to be honest. </p>\n\n<pre><code>   Selection.TextToColumns Destination:=Cells(1, b), DataType:=xlDelimited,\n</code></pre>\n\n<p>Any help would be much appreciated, I'm tearing my hair out with this one!</p>\n\n<pre><code>Sub TextToColumns()\n\nDim a As Integer, b As Integer, cell As Range, column As Range\n\n\nExcel.Application.DisplayAlerts = False\nExcel.Sheets(\"TOP LINE\").Select\nCells.Select\nCells.ClearContents\n\nFor a = 1 To 60\n\nIf Application.WorksheetFunction.CountA(Excel.Sheets(\"Paste In\").Columns(a)) &gt; 0 Then\nExcel.Sheets(\"Paste In\").Columns(a).Copy\nb = Excel.Sheets(\"TOP LINE\").Cells(1, Columns.Count).End(Excel.xlToLeft).column\nExcel.Sheets(\"TOP LINE\").Select\n\n\n  If Application.WorksheetFunction.CountA(Excel.Sheets(\"TOP LINE\").Columns(b)) &gt; 0      Then b = b + 1\n    Excel.Sheets(\"TOP LINE\").Columns(b).EntireColumn.Select\n    Excel.ActiveSheet.Paste\n   Excel.Application.CutCopyMode = False\n    Selection.TextToColumns Destination:=Cells(1, b), DataType:=xlDelimited, _\n            TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n            Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n            :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1),   Array(6, 1), _\n            Array(7, 1), Array(8, 1)), TrailingMinusNumbers:=True\n End If\nNext a\n\nActiveSheet.Columns.AutoFit\nActiveSheet.Rows.AutoFit\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","activex","excel-2007","rexcel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13275909,"title":"Recovering datas from an Excel/ActiveX spreadsheet","body":"<p>I'm having the following issue: I've an Excel spreadsheet with a lot of VBA codes and ActiveX controls, including RExcel formulas.</p>\n\n<p>The Excel version is 2007.</p>\n\n<p>When I try to open this file, Task Manager says Excel isn't answering and something starts like if Excel started running endless codes; I deactivated each control and it still seems broken.</p>\n\n<p>I would like to recover at least some formulas I've written in that spreadsheet, but this is actually impossible by opening the spreadsheet in conventional way.</p>\n\n<p>Could you tell me how I can \"read\" formulas and text in that spreadsheet without opening it by Excel?</p>\n\n<p>Thanks,</p>\n"},{"tags":["php","database","excel","sqlite","data-manipulation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":13277142,"title":"Using PHP to manipulate data, transforming an SQLite database to an excel spreadsheet","body":"<p>I have tables such as tbl_building, tbl_rooms, tbl_lighting. </p>\n\n<p>Each have their tuples so that there can be many buildings, many rooms within buildings and many lighting items within rooms. This is structured by giving each of the buildings/rooms/lighting their own ID.</p>\n\n<p>One of the tasks that I'm trying to achieve is to display a list of lights, for each room within each building in an excel spreadsheet. </p>\n\n<p>Here is my code. It is obviously wrong but I can't get my head around outputting the data. </p>\n\n<pre><code>function getLights($buildingID, $d, $objPHPExcel, $status){\n\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Please Enter Hours Of Usage: ');\n        include(\"setText.php\");$status[2]++;\n\n        $groupStart = $status[1].$status[2];\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Lights Used:');\n            $status[1]++;\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Count');\n            $status[1]++;\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'kWh/yr');\n            $status[1]++;\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Energy Saving kWh/yr');\n            $status[1]++;\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Saving(£)');\n            $status[1]++;\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Cost');\n            $status[1]++;\n            $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], 'Change To...');    \n        $groupEnd = $status[1].$status[2];\n\n        include(\"setHeadersText.php\");groupFill($objPHPExcel, $groupStart, $groupEnd, \"calc\");\n        $status[2]++;$status[1] = chr(65);\n\n        $query = \"SELECT r_id FROM tbl_roomDesc WHERE b_id = '$buildingID'\";\n        $result = $d-&gt;query($query);\n        $rooms = array();\n\n        array_push($rooms, 2);//echo \"&lt;br/&gt;\".$row['r_id'];\n\n\n\n            //echo \"&lt;br/&gt;Building:\";\n        /*while($row = $result-&gt;fetchArray(SQLITE3_ASSOC)){ \n            array_push($rooms, $row['r_id']);//echo \"&lt;br/&gt;\".$row['r_id'];\n        }*/\n\n        //echo \"&lt;br/&gt;\";\n        //var_dump($rooms);\n\n        $lightArray = array(\n            \"CFL\",\n            \"CFL Equivalent Halogen 100w spot\",\n            \"CFL Equivalent Halogen 50w spot\",\n            \"Double d\",\n            \"Halogen 100w spot\",\n            \"Halogen 50w spot\",\n            \"PL\",\n            \"T12 Single 4ft\",\n            \"T12 Single 5ft\",\n            \"T12 Single 6ft\",\n            \"T12 Single 8ft\",\n            \"T12 Twin 4ft\",\n            \"T12 Twin 5ft\",\n            \"T12 Twin 6ft\",\n            \"T12 Twin 8ft\",\n            \"T5 Quad 2ft\",\n            \"T5 Quad 4ft\",\n            \"T5 Single 4ft\",\n            \"T5 Single 5ft\",\n            \"T5 Triple 2ft\",\n            \"T5 Triple 4ft\",\n            \"T5 Triple 5ft\",\n            \"T5 Twin 2ft\",\n            \"T5 Twin 4ft\",\n            \"T5 Twin 5ft\",\n            \"T8 Quad 2ft\",\n            \"T8 Quad 4ft\",\n            \"T8 Single 4ft\",\n            \"T8 Single 5ft\",\n            \"T8 Single 6ft\",\n            \"T8 Twin 2ft\",\n            \"T8 Twin 4ft\",\n            \"T8 Twin 5ft\",\n            \"T8 Twin 6ft\", \n            \"Tungsten 60w\",\n            \"Other\"\n            );\n\n        //echo sizeof($lightArray);\n\n        //for each room, get quant wattage and hours of each light referenced by the room id\n\n        echo sizeOf($rooms);\n        echo \"&lt;br/&gt;\";\n        for($i=0; $i&lt;sizeof($rooms);$i++){\n\n            //set empty arrays\n            $size = 36;\n            $lightQuantityCount = array_fill(0, $size, 0);\n            $lightWattageCount = array_fill(0, $size, 0);\n            $lightHoursCount = array_fill(0, $size, 0);\n\n            //get all lighting data of particular room\n            $query2 = \"SELECT * FROM tbl_lightingData WHERE r_id = '$rooms[$i]'\";\n            $result2 = $d-&gt;query($query2);\n            $row2= $result2-&gt;fetchArray(SQLITE3_ASSOC);\n\n            //for each light type in the lightarray chechk if light type from query == light type in array, if so add quantity, wattage and hours to arrays\n\n\n            while($row2=$result2-&gt;fetchArray(SQLITE3_ASSOC)){\n\n                echo \"&lt;br/&gt;Room ID: \".$rooms[$i].\"&lt;br/&gt;\";\n                $lightID = $row2['l_id'];\n                $lightType = $row2['lightType'];\n                $lightQuantity = $row2['lightQuantity'];\n                $lightWattage = $row2['lightWattage'];\n                $lightHours = $row2['lightHours'];\n                echo \"Light Profile:&lt;br/&gt;Light ID:  \".$lightID.\"&lt;br/&gt;Light Type:  \".$lightType.\"&lt;br/&gt;Light Wattage:  \".$lightWattage.\"&lt;br/&gt;Light Hours:  \".$lightHours.\"&lt;br/&gt;\";\n\n                for($j=0; $j&lt;sizeof($lightArray); $j++){\n                    if($lightType == $lightArray[$j]){\n                        echo \"&lt;br/&gt;MATCH&lt;br/&gt;\";\n                        $lightQuantityCount[$j] = $lightQuantityCount[$j] + $lightQuantity;\n                        $lightWattageCount[$j] = $lightWattage;\n                        $lightHoursCount[$j] = $lightHoursCount[$j] + $lightHours;\n                    }\n                    else{\n                        echo \"&lt;br/&gt;NO MATCH&lt;br/&gt;\";\n                    }\n                }\n            }\n\n            //echo\"&lt;br/&gt;ARRAY DUMP START:&lt;br/&gt;\";\n            //var_dump($lightQuantityCount);\n            //echo\"&lt;br/&gt;ARRAY DUMP END:&lt;br/&gt;&lt;br/&gt;\";\n\n            echo \"&lt;br/&gt;ADFSDFADFA : \".sizeof($lightQuantityCount);\n            echo \"&lt;br/&gt;ADFSDFADFA : \";\n\n            for($k=0; $k&lt;sizeof($lightQuantityCount); $k++){\n\n                if($lightQuantityCount[$k] != 0){\n\n                    echo \"&lt;br/&gt;Light Type: \".$lightArray[$k].\"&lt;br/&gt;\";\n                    echo \"Light Quantity Count: \".$lightQuantityCount[$k].\"&lt;br/&gt;\";\n                    echo \"Wattage Count: \".$lightWattageCount[$k].\"&lt;br/&gt;\";\n                    echo \"Hours Count: \".$lightQuantityCount[$k].\"&lt;br/&gt;\";\n\n                    include(\"setText.php\");$status[2]++;\n\n                    $groupStart = $status[1].$status[2];\n                        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], $lightArray[$k]);\n                        $status[1]++;\n                        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], $lightQuantityCount[$k]);\n                        $status[1]++;\n\n                        $calc = $lightWattageCount[$k] * $lightQuantityCount[$k];\n                        $calc2 = $calc / 1000;\n\n                        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue($status[1].$status[2], $calc2);\n                    $groupEnd = $status[1].$status[2];\n\n                    include(\"setHeadersText.php\");groupFill($objPHPExcel, $groupStart, $groupEnd, \"calc\");\n                    $status[2]++;$status[1] = chr(65);\n                }\n            }\n        }\n\nreturn $status;\n</code></pre>\n\n<p>}</p>\n\n<p>Comment for more information, thanks</p>\n\n<p>Chris</p>\n"},{"tags":["excel","excel-2003"],"answer_count":9,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":9121,"score":1,"question_id":2449755,"title":"Too Many Different Cell Formats","body":"<p>I have a massive file with 10 sheets recreated from scratch, 12 sheets updated, 5 sheets loaded with raw data, and 7 sheets that are used by the macros for the report.  I have recently added a new sheet and am running into the Excel \"Too many different cell formats\" problem.<br>\nI have read some of the google search results and they say I should simplify the formatting, but I don't even know how I got up to 4000 distinct cell formats, let alone how much I'm using which ones, so I can remove some.  It is also popping up some times the file is run, but not all, until such time as it comes up, and then it happens every time it is run.  Since the macro is doing so much of the work, including creating the 10 sheets from scratch, I am not sure what to do.<br>\nDoes anyone know of a Macro I could run to get a listing of all the cell formats and how many cells are using them?<br>\nDoes anyone know of a program they trust to help remove excess cell formats?<br>\nThanks,<br>\nCraig</p>\n"},{"tags":["excel","applescript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13115576,"title":"how to set constant series value in excel using apple script","body":"<p>How to set the constant series value in excel using apple script.</p>\n\n<pre><code> tell worksheet 1 of active workbook\n      set obj to make new chart object at end with properties{ \n                                     left position:120,top:50,width: 120,height:150}  \n set ochart to chart of obj    \n      tell ochart\n           make new series at end with properties {series values:\"={1}\"}\n      end tell\n end tell\n\n This script through error(Microsoft Excel got an error:Can't make class series)\n\nPlease replay\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5186,"score":0,"question_id":4908032,"title":"Calling a sub routine in an excel macro using visual basic","body":"<p>I have written a macro for excel which is used for a simulation in Aspen. The macro is working well, except one part which is not working as it should. I don't now why but the part</p>\n\n<pre><code>For j = 0 To 1 \nCall Run\nNext j\n</code></pre>\n\n<p>in the <code>Sub Start()</code> is not executed properly. As the for loop shows the <code>Call Run</code> should be executed two times. Sincerly this is not the case. When i run the Sub Start() it works, but the <code>Call Run</code> is only executed one time. Here the complete code of the macro in VB. I would be thankful about any advise.</p>\n\n<pre><code>Option Explicit\nDim na As Integer\nDim nb As Integer\nDim nc As Integer\n'Dim nd As Integer\nDim i As Integer\nDim j As Integer\n'Dim B As Integer\n'Dim B As Double\nDim nresults As Integer\nDim Index1 As Integer\nDim Resultfile As String\nDim Resultfolder As String\nDim nlaeufe As Integer\nDim NewBook As Object\nDim ACMObj As Object\nDim nDaten As Integer\n\n\nSub Start()\n  Application.ActiveWorkbook.Save\n   nlaeufe = Sheet0.Cells(2, 2)\n   Call Clear_Data\n  For i = 0 To nlaeufe\n   'Sheet0.Cells(3, 2) = nlaeufe - i\n    Set ACMObj = GetObject(Sheet0.Cells(1, 2))\n  Application.DisplayAlerts = False\n  ACMObj.Application.Visible = True\n  Call Count_Daten\n  Call Add_Daten(ACMObj, nDaten)\n  For j = 0 To 2\n  Call Run\n  Next j\n  Call Get_Data\n      If ACMObj.Application.Simulation.State &lt;&gt; \"Running\" Then\n  Call Results_newfile\n    Application.ActiveWorkbook.Save\n    End If\n   Next i\nEnd Sub\n\n\nSub Get_Data()\n ' If Sheet0.Cells(Index1 - 1, 2).Value &lt;&gt; ACMObj.Application.Simulation.Time Then\n    'Sheet0.Cells(Index1, 2).Value = ACMObj.Application.Simulation.Time\n    Dim nd\n    For nd = 0 To 152\n        Sheet0.Cells(32 + nd, 4 + i).Value = ACMObj.Flowsheet.Resolve(Sheet0.Cells(32 + nd, 2)).Value\n        Sheet0.Cells(187 + nd, 4 + i).Value = ACMObj.Flowsheet.Resolve(Sheet0.Cells(187 + nd, 2)).Value\n    Next nd\n    'Index1 = Index1 + 1\n    'If RunStatus = 1 Then _\n     '   Application.OnTime Now + Sheet0.Cells(4, 2).Value, \"Get_Data\"\n  'Else\n  'End If\nEnd Sub\n\n\nSub Count_Daten()\n  Dim na\n  While Sheet0.Cells(6 + na, 4) &lt;&gt; \"\"\n    na = na + 1\n  Wend\n  nDaten = na - 1\nEnd Sub\nSub Add_Daten(ACMObj, nDaten)\n    Dim nb\n    Dim B\n  For nb = 1 To nDaten\n     Set B = ACMObj.Application.Simulation.Flowsheet.Resolve(CStr(Sheet0.Cells(6 + nb, 3)))\n     B.Value = Sheet0.Cells(6 + nb, 4 + i).Value\n  Next nb\nEnd Sub\n\n\nSub Run()\n  Set ACMObj = GetObject(Sheet0.Cells(1, 2))\n  Application.DisplayAlerts = False\n  ACMObj.Application.Visible = True\n  ACMObj.Application.Simulation.runmode = \"Steady State\"\n  On Error Resume Next ' In case we are already running\n  ACMObj.Run (False)\nEnd Sub\n\n\nSub Results_newfile()\n  Resultfolder = Sheet0.Cells(1, 8)\n  Resultfile = Sheet0.Cells(2, 8)\n   ' Set NewBook = Workbooks.Add(xlWBATWorksheet)\n    'NewBook.SaveAs (Resultfolder &amp; Resultfile &amp; \".xls\")\n    'NewBook.Activate\n    'ThisWorkbook.Activate\n    Sheet0.Select\n    Range(\"A1:BA65536\").Select\n    Selection.Copy\n   ' NewBook.Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Selection.PasteSpecial Paste:=xlPasteColumnWidths, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    'Call Copy_figure\n    'NewBook.Save\n    ThisWorkbook.Activate\nEnd Sub\n\n\nSub Clear_Data()\nDim i As Integer\nDim nc As Integer\n'i = 100\n  Sheet0.Select\n  Range(\"C32:HH166\").Select\n  Selection.Clear\n  While Sheet0.Cells(32 + nc, 3) &lt;&gt; \"\"\n  'Range(Cells(32 + i, 2), Cells(182 + i, 53)).Select\n  nc = nc + 152\n  Selection.Clear\n  i = i + 152\n  Wend\n  Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"},{"tags":["excel","certificate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13165665,"title":"How do you use certmgr to add a certificate to Trusted Publishers in Excel?","body":"<p>I have tried:</p>\n\n<p>certmgrs /add myCert.cer /s /r localMachine root</p>\n\n<p>I have tried several variations on that like:</p>\n\n<p>localMachine trustedPublishers</p>\n\n<p>Everytime I try this on the command line it just loads the certmgr Utility Window. I can't see this command line call doing anything.</p>\n"},{"tags":["excel","math"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":26,"score":-1,"question_id":13274574,"title":"MS Excel calculation - nested operations order","body":"<p>I'm facing this issue, where excel is not following maths rules correctly. Here is the formula</p>\n\n<pre><code>=((F11*4.4)-R11)/G11\n</code></pre>\n\n<p>here are the figures</p>\n\n<pre><code>F11 G11 R11\n37  57  23.38\n</code></pre>\n\n<p>the result of the formula I expect is = 2.445964912</p>\n\n<p>yet Excel calculate that formula to 3.266315789</p>\n\n<p>by the maths logic the above formula needs to be calculated in the following steps:</p>\n\n<pre><code>1. (F11*4.4) = AA\n2. (AA-R11) = BB\n3. (BB/G11) = CC (in this case 2.445964912)\n</code></pre>\n\n<p>am I thinking wrongly or this logic should be put to Excel differently? </p>\n\n<p><img src=\"http://i.stack.imgur.com/xze5f.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1159,"score":0,"question_id":10158675,"title":"Count if two criteria match - EXCEL formula","body":"<p>I have this table and I would like to create a formula which would count values from COLUMN A and COLUMN C. Example. If in column A value is M (male) and in column C is YES, than it would count. Can you help me with this formula? Thank you!</p>\n\n<p><img src=\"http://i.stack.imgur.com/JFfmB.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c","excel","menu","pic","datafile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":21,"score":-4,"question_id":13273092,"title":"Excel data file for menu program","body":"<p>I have written a menu program in C for a PIC24 microcontroller, using the Microchip MPLAB X IDE. The menus are constructed from a data file at runtime. The data file is currently an Assembler file which is linked with the C program file, but it is difficult to maintain. What I would like to do is build the data file in an Excel spreadsheet then export it in some way (.csv ?) and add it to the menu project, but don’t know how to go about this. Bearing in mind that the data file contains variable and function identifiers contained in the program. Any help to get started in the right direction would be appreciated.</p>\n"},{"tags":["asp.net","excel","service","reporting-services","reporting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13276839,"title":"Need to export from Reporting Services viewer in an Excel specific format","body":"<p>Recently we migrated an application made with c# from Windows to Web, preserving all the existing functionality. Only the presentation layer was migrated.</p>\n\n<p>I have there an asp.net page that uses the viewer for Reporting Services. When it displays a report, the user selects \"Excel\" from the export dropdown list, then she presses the Export button. The dialog shows only the Excel format of the Microsoft Office version installed in the client machine (). The user needs to export in the \"Microsoft Excel 5.0/95\" format. This format was available in the dialog in the former Windows application (using the SSRS viewer for Windows apps).</p>\n\n<p>How may I emulate this behavior in order to make the option available to the user? She needs precisely the Excel 5.0/95 format without alternatives.</p>\n\n<p>We know this doesn't has to do with the Office version installed. We had Office 2003 installed in a puter, then we uninstall it and installed 2007 without any difference. We also don't think this depends on the web application, though this may be an issue from the web viewer or Reporting Services. Any idea would be highly appreciated.</p>\n"},{"tags":["excel","unicode","encoding","utf-8","xlsx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":81,"score":0,"question_id":12943891,"title":"UTF-8 encoding issue of 2 columns in Excel workbook","body":"<p>I have an Excel workbook that I need to edit but when I open it 2 of the columns have strange encoding (I think). Instead of normal values (strings) there are these strings:  </p>\n\n<pre><code>¼àãëåíäðîáèëèöàêðàòêîáðîä\n</code></pre>\n\n<p>and  </p>\n\n<pre><code>ÏÅËÈÑÒÅÐ-ÁÐÎÄ-ÄÐÎÁÈËÈÖÀ  \n</code></pre>\n\n<p>I checked the document encoding (which is UTF-8), everything is written with Arial font, and there are no restrictions (I think) or hidden columns. I can edit all the columns but I need to get a normal value for these 2 columns to continue my work. I already tried saving the document with different encoding, tried Google Spreadsheet and tried changing language for non-Unicode programs in Control Panel but unfortunately nothing helped.  </p>\n\n<p>Is there a way to get their normal value?</p>\n"},{"tags":["excel","vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":43,"score":-5,"question_id":13276456,"title":"EXCEL VBA help in macro","body":"<p>I need help in excel VBA. I have two workbooks, A &amp; B. A is the master book and it needs to fetch data from another workbook B and aata in it is in raw form and needs to be converted to simple form. Let me detail you on workbook B Data:</p>\n\n<pre><code>Column1 Column2 Column3\nNames   Data1   Data2\nName1   600     600\nName1   304     304\nName2   4220    4220\nName3   19052   19052\nName4   11093   11093\nName1   14969   14969\nName3   5002    5002\nName2   403     403\nName4   2850    2850\nName2   3901    3901\nName2   4572    4572\nName3   7807    7807\n</code></pre>\n\n<p>All I need is a macro (or VBA script) in workbook A so that I can add columns in Workbook B based on column1 'name', ie., same name data should be added and output a summarized data and this summarized data should be imported to the workbook A.</p>\n\n<p>Please help me on this.\nThanks In advance!</p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13276130,"title":"Populate ComboBox and Textfields from Excel","body":"<p>I have an excel spreadsheet, that contains client information. I would like to populate a combo box (comboBox1) with unique values from Column A. I would then like a second combo box (comboBox2) to list the values from Column B that exist where comboBox1=Column A. Finally, I would like to populate text fields with column's C, D, E and so on....</p>\n\n<p>I have mocked up a quick screen of my desired result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xxvEg.png\" alt=\"enter image description here\"></p>\n\n<p>This would be derived from the following spreadsheet:</p>\n\n<p><img src=\"http://i.stack.imgur.com/INR2w.png\" alt=\"enter image description here\"></p>\n\n<p>The data in the spreadsheet changes from time to time, which is why I can not hard code the information.</p>\n\n<p>I am not sure where to even start with this. Do I load the data into 2D arrays or is there a better way of doing it?</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13275827,"title":"Named Ranges, Cell References and Validation","body":"<p>If I have two cells and a named range mexico</p>\n\n<p>A1, A2.</p>\n\n<p>A1 contains the string: \"mexico\"\nA2 is the cells that has required data validation (drop down list).</p>\n\n<p>I want A2's validation reference to be dynamic, in the sense that I can it reference it to A1; converting the string \"mexico\" to a named range mexico</p>\n\n<p>I tried inputing = INDIRECT(A1) into Cell validation Window.</p>\n\n<p>What is the correct procedure here?</p>\n\n<p>My workbook can be attached here:  <a href=\"https://dl.dropbox.com/u/69651453/test22.xlsx\" rel=\"nofollow\">https://dl.dropbox.com/u/69651453/test22.xlsx</a></p>\n\n<p>It is a little different but should illustrate any point you make.</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","excel","jasper-reports","ireport"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13274183,"title":"Jasper iReport image messing up excel sheet","body":"<p>I am using iReport 4.7.0 to generate a Jasper template, which I am then populating via a call from Java.  So far, everything is working however I have one issue which is causing me grief.  When I insert an image and generate my Excel spreadsheet, the image messes up all of my columns and rows that are nearby.  I see a lot of small or distorted columns and rows which should not be there at all.  I'm able to move the image around as I would expect, but the messed up columns remain.  How can I get Jasper/iReport to know that I just want to lay the image on top of my existing spreadsheet, and not work it into the cell layout that I have?</p>\n"},{"tags":["c#","web-services","excel","file","upload"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13273693,"title":"Uploading and saving an Excel file C# webservice using javascript","body":"<p>I have a javascript code that uploads a file to the server using XMLHttpRequest object. I am accepting the file as a Stream in the web service that is written using C#:</p>\n\n<pre><code>int uploadFile(Stream file)\n{\n    using (FileStream fileStream = File.Create(System.AppDomain.CurrentDomain.BaseDirectory + \"file.csv\"))\n            {\n                byte[] buffer = new byte[8 * 1024];\n                int len;\n                while ((len = file.Read(buffer, 0, buffer.Length)) &gt; 0)\n                {\n                    fileStream.Write(buffer, 0, len);\n                }    \n            }\n    //process file\n    return 0;\n}\n</code></pre>\n\n<p>In javascript the file is sent as a form data object:</p>\n\n<pre><code>var fd = new FormData(document.forms.namedItem(\"file\"));\nvar req = new XMLHttpRequest();\nreq.open(\"POST\", url, true);\nreq.send(fd);\n</code></pre>\n\n<p>Now, I am trying to save the Excel file on the server. I am reading the stream into a byte array and writing it to a csv file. But the error I am facing is corrupted data in the csv file.</p>\n\n<p>Where am I going wrong or is there any other way to upload and save file through web service?</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13273665,"title":"Formula to detect duplicate data in Excel (with a difficult variable!)","body":"<p>I need to sanitise a mailing list, and am wondering if anyone knows of a formula to find out the following:</p>\n\n<p>I have an excel spreadsheet with two columns A and B, the formula I need to do is: if [value in column B is duplicated] has [blank in column A] AND [data in column A] then show the value of Column B in a new Column C.</p>\n\n<p>Example of data:</p>\n\n<pre><code>COL A      |    COL B\n11/11/12   |    **name@example.com**\n03/09/11   |    different@example.com\n           |    **name@example.com**\n06/01/12   |    anothername@example.com\n</code></pre>\n\n<p>The formula would detect name@example.com is duplicated &amp; it has a date in column A &amp; further on has no value in column A, and therefore displays: name@example.com in Column C.</p>\n\n<p>Hope that makes sense! </p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":23,"score":3,"question_id":13272726,"title":"VBA Excel Combo Boxes","body":"<p>I have five worksheets in my workbook. I want to be able to add data to any one of these sheets and have created a user form. </p>\n\n<p>I am falling at the first hurdle. I have added a combo box and want the list to be the sheets in the workbook. </p>\n\n<p>I have tried to download coding and then change it to my specifications, but they never work. \nAny help would be appreciated. </p>\n"},{"tags":[".net","excel","oledb","conditional-formatting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13273168,"title":"Import data with OleDb from Excel turns negative number to positive","body":"<p>My problem is needing to take a column of dollar amounts both positive and negative to insert into a database.  I've had issues with mixed data types previously, but finally got everything working using the following connection string,</p>\n\n<p>\"Provider=Microsoft.ACE.OLEDB.12.0; Data Source={some_filepath}; Extended Properties=Excel 12.0; Xml; IMEX=1; HDR=NO\"</p>\n\n<p>Now the only issue I have is when the Excel spreadsheet has conditional formatting that displays negative numbers as red and positive numbers as black.  A user will enter '-100' for instance, but Excel will only display a red '100' and OleDb doesn't read the minus sign.  When I switch Excel's conditional formatting to one that displays a minus sign everything works fine.</p>\n\n<p>Is there any way I can disable the conditional formatting to read the value exactly as the user entered it?</p>\n\n<p>Regards,\nMatt</p>\n"},{"tags":["asp.net","html","vb.net","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":13159767,"title":"How to avoid excel file format alert while opening an exported excel file?","body":"<p>Iam exporting html data to excel. I am getting an excel file as soon as i click on export button but when i try to open the excel file an alert is popping up saying that the file format is different from the extension specified. how can i get rid of this alert, please help me Iam using the following code    </p>\n\n<pre><code>HttpContext.Current.Response.Buffer = True\nHttpContext.Current.Response.ContentType = \"application/vnd.ms-excel\"\nHttpContext.Current.Server.ScriptTimeout = 600\n</code></pre>\n"},{"tags":["excel","delphi","automation","save","file-format"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":89,"score":-3,"question_id":13234756,"title":"Different save solutions for .xls and .xlsx aren't working","body":"<p>I have to programm a 'templategenerator' for excelfiles and the saveroutine isn´t working for me.</p>\n\n<p>If I use the following code:</p>\n\n<pre><code>procedure SaveAsXlsFormat(sFileName:string);\nbegin\n  ExcelApp.Application.DisplayAlerts := False;\n  ExcelApp.ActiveWorkbook.SaveAs(sFileName); //Error\n  ExcelApp.Application.DisplayAlerts := True;\nend; \n</code></pre>\n\n<p>I can only save '.xlsx' Workbooks. '.xls' Workbooks (to support clients with Office2003) can't be saved. </p>\n\n<p>If I try to alter the code into the following, neither the '.xls' nor the '.xlsx' can be saved, but after the description from <a href=\"http://www.rondebruin.nl/saveas.htm\" rel=\"nofollow\">http://www.rondebruin.nl/saveas.htm</a> it should at least save the '.xls' Workbooks.</p>\n\n<pre><code>procedure SaveAsXlsFormat(sFileName:string);\nbegin\n  ExcelApp.Application.DisplayAlerts := False;\n  ExcelApp.ActiveWorkbook.SaveAs(Filename := sFileName, FileFormat := 56); //Error\n  ExcelApp.Application.DisplayAlerts := True;\nend;\n</code></pre>\n\n<ul>\n<li>sFileName structure> C:\\template.xls or C:\\template.xlsx</li>\n<li>ExcelApp.Application.DisplayAlerts := False > always override the existing file;</li>\n</ul>\n\n<p>Thanks in advance!</p>\n\n<p>Solution:</p>\n\n<p>Delphi 5 played a prank on me again. </p>\n\n<p>My whole SaveRoutine for those, who have a similar problem:</p>\n\n<pre><code>procedure SaveAsXlFormat(sFileName:string);     //RH\n\nbegin\n\n  {\n  Wert = Konstantenname in Excel (Beschreibung)\n  ------------------------------------------------------------------------------\n  50   = xlExcel12 (Excel Binary Workbook 2007+ mit oder ohne Makros, xlsb)\n  51   = xlOpenXMLWorkbook (ohne Makros Excel 2007+, xlsx)\n  52   = xlOpenXMLWorkbookMacroEnabled (mit oder ohne Makros Excel 2007+, xlsm)\n  56   = xlExcel8 (97-2003 Format in Excel 2007-2010, xls)\n  ------------------------------------------------------------------------------\n  }\n\n  //Warnungen von Excel: aus (Überschreibendialog)\n  ExcelApp.Application.DisplayAlerts := False;\n\n  try\n  begin\n    case ermittleDateiendung(sFileName) of\n      1 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 50);\n      2 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 51);\n      3 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 52);\n      4 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 56) else ExcelApp.ActiveWorkbook.SaveAs(sFileName, xlNormal);\n    end;\n  end;\n  except\n    ExcelApp.ActiveWorkbook.SaveAs(sFileName);\n  end;\n\n  //Warnungen von Excel: an (Überschreibendialog)\n  ExcelApp.Application.DisplayAlerts := True;\n\nend;\n\nfunction ermittleDateiendung(sFilename: string) : Integer;\nbegin\n\n  result := 0;\n\n  if (ExtractFileExt(sFileName)) = '.xlsb' then\n    result := 1;\n\n  if (ExtractFileExt(sFileName)) = '.xlsx' then\n    result := 2;\n\n  if (ExtractFileExt(sFileName)) = '.xlsm' then\n    result := 3;\n\n  if (ExtractFileExt(sFileName)) = '.xls' then\n    result := 4;\n\nend;\n</code></pre>\n"},{"tags":["c#",".net","excel","usercontrols","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":199,"score":3,"question_id":12270735,"title":"Getting a handle to a NamedRange control in C#","body":"<p>I'm developing an application-level AddIn for Excel 2007 using C# (.NET 4.0). Questions similar to this one have been previously asked >></p>\n\n<p><a href=\"http://stackoverflow.com/questions/11374023/resizing-namedrange-throws-a-controlnotfoundexception\">Resizing NamedRange throws a ControlNotFoundException</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/7152020/c-sharp-excel-addin-accessing-controls\">C# excel addin - Accessing Controls</a></p>\n\n<p>but the responses to them (where there were any) did not work for me. So I would like to give a detailed description of what I'm trying to do, and what happens when I try to do it.</p>\n\n<p>Very briefly, my problem is that I'm not able to get hold of NamedRange control objects for modifying them, after they have been instantiated and initialized elsewhere in the code.</p>\n\n<p>Please read on for a more complete description.</p>\n\n<p>When the AddIn starts, it creates a NamedRange control and attaches it to some cells on a particular worksheet >></p>\n\n<pre><code>Worksheet worksheet = Globals.Factory.GetVstoObject(\n                Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nExcel.Range cell = worksheet.Range[\"A1\"];\n_configParams.HeaderNamedRange = worksheet.Controls.AddNamedRange(cell, \"HeaderCells\");\n_configParams.HeaderNamedRange.RefersTo = \"=\" + worksheet.Name + \"!$A$1:$A$5\";\n</code></pre>\n\n<p>After the AddIn has started, I want to allow the User to re-specify the cells to which this NamedRange control can point. In order to do so, I'm getting the User to select a range of cells and then get hold of the selected cells' location (as a String) in a suitable event-handler method.</p>\n\n<p>I then intend to programmatically re-specify the cells that the above NamedRange control points to. I have tried the following approaches, but neither of them work.</p>\n\n<p>[Approach 1]</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\n((NamedRange)(controlWorksheet.Controls[\"HeaderCells\"])).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, it throws a ControlNotFoundException, and I get the following message:</p>\n\n<pre><code>Microsoft.VisualStudio.Tools.Applications.Runtime.ControlNotFoundException was unhandled by user code\n  Message=This document might not function as expected because the following control is missing: PortfolioHeaderCells. Data that relies on this control will not be automatically displayed or updated, and other custom functionality will not be available. Contact your administrator or the author of this document for further assistance.\n  Source=Microsoft.Office.Tools.Excel.Implementation\n  StackTrace:\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.EnsureProxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.get_Proxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.AttachSupport()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.ResetControl()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.set_RefersTo(String value)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException: System.Runtime.InteropServices.COMException\n       Message=Exception from HRESULT: 0x800A03EC\n       Source=Microsoft.VisualStudio.Tools.Office.Runtime\n       ErrorCode=-2146827284\n       StackTrace:\n            at Microsoft.VisualStudio.Tools.Office.Runtime.Interop.IHostItemProvider.GetHostObject(String primaryType, String primaryCookie, IntPtr&amp; hostObject)\n            at Microsoft.VisualStudio.Tools.Office.Runtime.DomainCreator.ExecuteCustomization.Microsoft.Office.Tools.IHostItemProvider.GetHostObject(Type primaryType, String primaryCookie)\n            at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       InnerException:\n</code></pre>\n\n<p>[Approach 2]</p>\n\n<p>I then saw <a href=\"http://stackoverflow.com/questions/2416727/set-excel-named-ranges-via-c\">Set Excel Named Ranges via C#?</a> and so tried to use the approach described in the answer there:</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\ncontrolWorksheet.Names.Item(\"HeaderCells\", Type.Missing, Type.Missing).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, I get the following exception and message:</p>\n\n<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code\n  Message=Exception from HRESULT: 0x800A03EC\n  Source=\"\"\n  ErrorCode=-2146827284\n  StackTrace:\n       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)\n       at Microsoft.Office.Interop.Excel.Names.Item(Object Index, Object IndexLocal, Object RefersTo)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException:\n</code></pre>\n\n<p>So, in both approaches, the exception from HRESULT is the same: 0x800A03EC. Also, the exception is being thrown in the line where I try to get hold of the NamedRange control and re-specify the cells it points to.</p>\n\n<p>I have stepped through my code, and a NamedRange control does indeed exist where/when I try to modify the NamedRange object.</p>\n\n<p>I then checked the type of the <code>controlWorksheet.Controls[\"HeaderCells\"]</code> object using the following code >></p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nSystem.Windows.Forms.MessageBox.Show((controlWorksheet.Controls[\"HeaderCells\"]).ToString());\n</code></pre>\n\n<p>This results in a MessageBox containing \"Microsoft.Office.Tools.Excel.NamedRangeImpl\". If I'm not mistaken, this Type is not exposed by the Excel Object Model, and so I wonder if the problem is being caused by my casting a NamedRangeImpl object to a NamedRange control object.</p>\n\n<p>Your help is much appreciated. If there is any further information that I can provide, please let me know. Thanks in advance!</p>\n"},{"tags":["excel","count"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13272127,"title":"Excel: How many lines in the vertical direction by adding this","body":"<p>Is it possible to know how many rows are being added in the vertical direction?</p>\n\n<p>In the example we are adding 13 rows.\n<img src=\"http://i.stack.imgur.com/Ldvfi.png\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","magento","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13260669,"title":"Excel / Magento . CSV","body":"<p>I have a big problem. I'm very stressed with getting a Magento site up and the way it handles imports via csv is mind bending!</p>\n\n<p>I have basically no VBA training but I think it could help me to get this done.\nProblem is with multi field csv.\nI have a column header named <strong>size</strong>. Underneath I need 7 columns with fixed values: 38, 39, 40, ..., 44\nMy current csv uses single rows.\nSo I need multiple rows, just the cells from the size column completed with those said values.\nex:</p>\n\n<pre><code>HEADER1  HEADER2 HEADER3 SIZE         HEADER 4\nValue    Value   Value   38,39, etc   Value\nValue2   Value2  Value2  38,39, etc   Value2\n\nI Need This:\n\nHEADER1  HEADER2 HEADER3 SIZE         HEADER 4\nValue    Value   Value   38           Value\n                         39\n                         40\n                         41\nValue2   Value2  Value2  38           Value2\n                         39\n                         40\n                         41\n</code></pre>\n\n<p>I found a script </p>\n\n<pre><code>Sub InsertARow()\n 'make new row\nActiveCell.EntireRow.Insert Shift:=xlDown\n 'copy the row above\nActiveCell.Offset(-1, 0).EntireRow.Copy Cells(ActiveCell.Row, 1)\nOn Error Resume Next\n 'clear every cell in the new line that does not have a formula\nActiveCell.EntireRow.SpecialCells(xlCellTypeConstants, 23).ClearContents\nEnd Sub\n</code></pre>\n\n<p>This inserts X rows above current selection. Is there any way to do this for all cells in selection? Autocomplete would handle the rest.\nI was thinking something like </p>\n\n<pre><code>for i:=1 to n do \n    j:=i+7(the number of sizes i need to display) -&gt; insert the above code for that cell.\n</code></pre>\n\n<p>and the actual completion is handled by Excel.</p>\n"},{"tags":["c#",".net","excel","sharepoint","pia"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1853,"score":4,"question_id":6960693,"title":"Excel process doesn't get closed","body":"<p>I know similar questions have been asked before but I still need to ask this question as I am not able to get my EXCEL (32) process closed once I am done using it.</p>\n\n<p>As you can see in the code below, once <code>ProcessRFAFData</code> function finishes its execution, the EXCEL process doesn't get closed (I can still see <code>EXCEL.EXE*32</code> in the task manager).</p>\n\n<p>For this reason, when <code>SaveErrors</code> starts its execution, I get the following exception:</p>\n\n<p><code>System.Runtime.InteropServices.COMException (0x800A03EC):<br>\nMicrosoft Office Excel cannot open or save any more documents because there is not enough available memory or disk space.<br>\n• To make more memory available, close workbooks or programs you no longer need.<br>\n• To free disk space, delete files you no longer need from the disk you are saving to.<br>\nat Microsoft.Office.Interop.Excel.Workbooks.Add(Object Template)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.&lt;&gt;c__DisplayClass9.b__6()<br>\nat Microsoft.SharePoint.SPSecurity.&lt;&gt;c__DisplayClass4.b__2()<br>\nat Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess(CodeToRunElevated secureCode)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(WaitCallback secureCode, Object param)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(CodeToRunElevated secureCode)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.SaveErrors()</code></p>\n\n<p>Here is the code that executes the Excel processes:</p>\n\n<pre><code>try {\n    ProcessRFAFData(FileName);\n} catch (Exception ex) {\n    Status = \"ERROR: \" + ex.ToString();\n}\n\nif (Errors.Count() &gt; 0) {\n    SaveErrors();\n}\n</code></pre>\n\n<p>Here are all the functions interacting with Excel:</p>\n\n<pre><code>private void ReleaseObject(object obj) {\n    try {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n        obj = null;\n    } catch (Exception) { } finally {\n        GC.Collect();\n    }\n}\n\nprivate void ProcessRFAFData(string FileName) {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    bool error = false;\n\n    try {\n        SPSecurity.RunWithElevatedPrivileges(delegate() {\n            XLA = new Microsoft.Office.Interop.Excel.Application();\n            XLW = XLA.Workbooks.Open(FileName, 0, true,\n                Type.Missing, null, null, true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows,\n                Type.Missing, false, false, Type.Missing, false, Type.Missing, Type.Missing);\n\n            int index = RFAFTabExists(ref XLW);\n            if (index == 0) return;\n\n            XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(index);\n\n            if (!ValidProjectID(ref XLS)) return;\n\n            ParseData(ref XLS);\n\n            XLW.Close(true, Type.Missing, Type.Missing);\n            XLA.Quit();\n\n            ReleaseObject(XLS);\n            ReleaseObject(XLW);\n            ReleaseObject(XLA);\n        });\n    } catch (SP.ServerException ex) {\n        // output error\n    } catch (Exception ex) {\n        // output error\n    }\n}\n\nprivate int RFAFTabExists(ref Microsoft.Office.Interop.Excel.Workbook XLW) {\n    int index = 0;\n    foreach (Microsoft.Office.Interop.Excel.Worksheet w in XLW.Worksheets) {\n        if (w.Name.Equals(settings.Collection[\"RFAFTabName\"])) index++;\n    }\n\n    return index;\n}\n\nprivate bool ValidProjectID(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    using (SP.ClientContext CTX = new SP.ClientContext(SiteURL)) {\n        var projectId = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n\n        var project = // getting list of projects from SharePoint\n\n        if (project.Count() &gt; 0) {\n            ProjectID = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n            return true;\n        }\n    }\n\n    return false;\n}\n\nprivate void ParseData(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    ListData.Add(\"HID\", GetHID(XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString()));\n\n    if (ListData[\"HID\"].Equals(\"0\")) Errors.Add(new ImportError {\n        Reason = \"Hub ID does not exist in this project workspace.\",\n        Reference = string.Format(\"Hub ID: {0}\", XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString())\n    });\n\n    int row = Int32.Parse(settings.Collection[\"StartRow\"]);\n    while (!NoMoreData(ref XLS, row)) {\n        string PRSIN = XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"PRSIN\"], row), Type.Missing).Text.ToString();\n\n        string NOC = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"NOC\"], row), Type.Missing).Text.ToString());\n\n        string UEIRP = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"UEIRP\"], row), Type.Missing).Text.ToString());\n\n        string LAT = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LAT\"], row), Type.Missing).Text.ToString());\n\n        string LON = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LON\"], row), Type.Missing).Text.ToString());\n\n        string PJ = GetPJ(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        string ST = GetState(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        ListItemData.Add(new ListItem {\n            ProposedRemoteSiteItemNumber = PRSIN,\n            NumberOfCarriers = NOC,\n            UsableEIRP = UEIRP,\n            Latitude = LAT,\n            Longitude = LON,\n            PrimaryJurisdiction = PJ,\n            State = ST\n        });\n\n        row++;\n    }\n}\n\nprivate bool NoMoreData(ref Microsoft.Office.Interop.Excel.Worksheet XLS, int row) {\n    return string.IsNullOrEmpty(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n        settings.Collection[\"ProposedRemoteSiteItemNumberCol\"], row), Type.Missing).Text.ToString());\n}\n\nprivate void SaveErrors() {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    object MissingValue = System.Reflection.Missing.Value;\n\n    try {\n        try {\n            SPSecurity.RunWithElevatedPrivileges(delegate() {\n                XLA = new Microsoft.Office.Interop.Excel.Application();\n                XLW = XLA.Workbooks.Add(MissingValue);\n                XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(1);\n\n                XLS.Cells[1, 1] = \"Reason for error\";\n                XLS.Cells[1, 2] = \"Reference\";\n\n                XLS.get_Range(\"A1\").Font.Bold = true;\n                XLS.get_Range(\"B1\").Font.Bold = true;\n\n                int row = 2;\n                foreach (ImportError e in Errors) {\n                    XLS.Cells[row, 1] = e.Reason;\n                    XLS.Cells[row, 2] = e.Reference;\n\n                    row++;\n                }\n\n                XLW.SaveAs(ErrorLogFileName, Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookNormal,\n                    MissingValue, MissingValue, MissingValue, MissingValue,\n                    Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlExclusive, MissingValue,\n                    MissingValue, MissingValue, MissingValue, MissingValue);\n\n                XLW.Close(true, MissingValue, MissingValue);\n                XLA.Quit();\n\n                ReleaseObject(XLS);\n                ReleaseObject(XLW);\n                ReleaseObject(XLA);\n            });\n        } catch (Exception ex) {\n            Status = \"ERROR: \" + ex.ToString();\n        }\n\n        // Uploading excel file to SharePoint document library\n\n    } catch (Exception) { }\n}\n</code></pre>\n\n<p>I would really appreciate any help you can provide me in this.</p>\n"},{"tags":["excel","excel-2007","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13271909,"title":"Hyperlink to doc file slow opening","body":"<p>I've two excel file with inside some link to .doc and .pdf file. Both excel files and linked files are on a network shared folder. The first excel file is an .xls, the second an .xlsm.</p>\n\n<p>While opening link to .pdf file is very fast (the file is open in few seconds) it take a long time to open .doc files (about 40 secs.). I have searched on internet but found no solution at the moment.</p>\n\n<p>I have this problem with both excel 2007 and 2010.</p>\n\n<p>Does anyone know how to solve this problem? </p>\n\n<p>Thanks a lot\nMarco</p>\n"},{"tags":["excel","vba","automation","range","total"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13156439,"title":"Total from column changes weekly vba","body":"<p>UPDATE: \nGot a new issue with a formula, can't quite get it to work because of text in the formula, the formula (as taken from excel) should be,  </p>\n\n<pre><code>=IF(D2&lt;=0,\"No Sales Price\",E2/D2)  \n</code></pre>\n\n<p>I have tried as many combinations as I can think of but the \"no sales price\" is causing an issue with the quotation marks. My current code is  </p>\n\n<pre><code>For i = 2 To LastRowG   \nRange(\"Q\" &amp; i).Formula = \"=IF(D\" &amp; i &amp; \"&lt;=0,\" &amp; \"(No Sales Price)\",  &amp; \"(E\" &amp; i &amp; \"/D\" &amp; i &amp; \"))\"    \nNext i  \n</code></pre>\n\n<p>have had a look around but been unable to see any resolutions to the problem, any enlightenment will be met with the greatest appreciation</p>\n\n<p>EDIT:This was fixed by inserting the following lines;  </p>\n\n<pre><code>For i = 2 To LastRowG  \nRange(\"Q\" &amp; i).Formula = \"=IF(D\" &amp; i &amp; \"&lt;=0,\" &amp; Chr(34) &amp; \"No Sales Price\" &amp; Chr(34) &amp; \",\" &amp; \"E\" &amp; i &amp; \"/\" &amp; \"D\" &amp; i &amp; \")\"\nNext i \n</code></pre>\n\n<p>The Chr(34) inserts the ASCII character appertaining to that number which just so happens to be \". The program doesn't read it as having typed in the quote marks and continues to read the line of code correctly but then places the \"no sales price\" correctly in the formula.</p>\n\n<p>It will output the line as the formula is intended to be and the Chr(34) is like writing \"\"No Sales Price\"\" without the inevitable \"expected end of statement\" error</p>\n"},{"tags":["osx","excel","drop-down-menu"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13271225,"title":"drop down list failed in excel of mac","body":"<p>I used <code>Data Validation</code> to create a drop-down list in Excel. After choosing <code>list</code> on the Data tab, I set the <em>source</em> value to <code>1,2,3</code>. It worked in Excel of Microsoft Windows, but it failed in Excel of Apple MacBook Air. In MacBook Air, the list have only one item \"1,2,3\". Is anything different to create a drop-down list in MacBook Air?</p>\n\n<p>By the way, another question: how to make the arrow of drop-down list always visible?</p>\n\n<p>Thank you.</p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13270350,"title":"Do if column is empty instead of first cell","body":"<p>The code at the bottom checks to see if cell (1,b) is empty and then copies in a column and performs a text to columns on it. However I would like it to check if column b is empty instead of just this first cell. It should be straightforward but any changes I have made have not worked. For example I have tried: </p>\n\n<pre><code>If Excel.WorksheetFunction.CountBlank(Excel.Sheets(\"TOP LINE\").Columns(b)) &lt;&gt; 1048576 Then\nb = b+1\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>If Cells(1, b) &lt;&gt; \"\" Then b = b + 1\n</code></pre>\n\n<p>Please Help!</p>\n\n<pre><code>For a = 2 To 60\n\nIf Excel.WorksheetFunction.CountBlank(Excel.Sheets(\"Paste In\").Columns(a)) &lt;&gt; 1048576 Then\n\n    Excel.Sheets(\"Paste In\").Columns(a).Copy\n\n    b = Excel.Sheets(\"TOP LINE\").Cells(1, Columns.Count).End(Excel.xlToLeft).column\n\n    Excel.Sheets(\"TOP LINE\").Select\n\n\n    If Cells(1, b) &lt;&gt; \"\" Then b = b + 1\n\n\n        Excel.Sheets(\"TOP LINE\").Columns(b).EntireColumn.Select\n        Excel.ActiveSheet.Paste\n\n        Excel.Application.CutCopyMode = False\n        Selection.TextToColumns Destination:=Cells(1, b), DataType:=xlDelimited, _\n                TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n                Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n                :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n                Array(7, 1), Array(8, 1)), TrailingMinusNumbers:=True\n\nEnd If\n</code></pre>\n\n<p>Next a</p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13268954,"title":"VBA List to be put in sticker format","body":"<p>I have a list of data which needs to be printed out on stickers (imagine the Avery kind). I'm having trouble coming up with the code that will produce the desired result:</p>\n\n<p>My code thus far is:</p>\n\n<pre><code>With wsEtiketten\n    ' erase old data\n    .Cells.Clear\n    ' enter new data\n    With .Cells(1, 2)\n        .Value = \"Lettrine\"\n        .Font.Bold = True\n    End With\n    .Cells(2, 2).Value = sAuswertungsLettrine\n    For i = 0 To MaxRow - 1\n        For j = 0 To 4\n            r.Copy .Cells(4, 2).Offset(i * 5, j * 5)\n            .Cells(4, 2).Offset((i * 5) + 1, (j * 5) + 0) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 1).Value 'Page\n            .Cells(4, 2).Offset((i * 5) + 1, (j * 5) + 1) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 2).Value 'Ordernr\n            .Cells(4, 2).Offset((i * 5) + 1, (j * 5) + 2) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 8).Value 'Surf\n            .Cells(4, 2).Offset((i * 5) + 1, (j * 5) + 3) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 9).Value 'Indice DB\n            .Cells(4, 2).Offset((i * 5) + 3, (j * 5) + 0) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 3).Value 'Count\n            .Cells(4, 2).Offset((i * 5) + 3, (j * 5) + 1) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 4).Value 'CA Brut\n            .Cells(4, 2).Offset((i * 5) + 3, (j * 5) + 3) = wsSheet.ListObjects(1).DataBodyRange.Cells(i + 1, 7).Value 'Marge\n        Next j\n    Next i\nEnd With\n</code></pre>\n\n<p>The information which is tied to it is simply repeated across the row. I need i to change every time the field is offset. How can I do that? I'm sure this is probably programming kindergarden stuff but I'm not getting it.</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","excel","excel-vba","macros","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13250095,"title":"how to make cell as read-only in excel using apachi-POI","body":"<p>i have a drop down list contains some options, and for example two cells. what i need is regarding the selected option turn one of the cells to editable and the other to read-only and vise-versa.</p>\n\n<pre><code>FileOutputStream fos;\ntry {\n    fos = new FileOutputStream(\"D:\\\\POIXls.xls\");\n    Workbook workbook = new XSSFWorkbook();\n    Sheet sheet = workbook.createSheet(\"new Sheet\");\n    DataValidationHelper dvHelper = sheet.getDataValidationHelper();\n    DataValidationConstraint dvConstraint = \n                  dvHelper.createExplicitListConstraint(new String[] { \"cell 1 edit\",\"cell 2 edit\"});\n   CellRangeAddressList addressList = new CellRangeAddressList(0, 2, 0, 0);\n   DataValidation validation = dvHelper.createValidation(dvConstraint, addressList);\n\n   if (validation instanceof XSSFDataValidation) {\n       validation.setSuppressDropDownArrow(true);\n       validation.setShowErrorBox(true);\n   } else {\n       validation.setSuppressDropDownArrow(false);\n   }\n\n   sheet.addValidationData(validation);\n   workbook.write(fos);\n   fos.flush();\n   fos.close();\n}catch(Exception e){//catch code}\n</code></pre>\n\n<p>i need to know how to make that xls file make these cells editable/read-only according to the user's selection.\nVB code may be helpful also.</p>\n"},{"tags":["c#","xml","excel","ms-access"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13269987,"title":"I need to flatten this XML data, so i can import it to Excel","body":"<p>I've been trying for days to get this data into Excel or Access, but i have little experience with XML / XSD. I dont know what is the best approach when it comes to importing data into Excel/Access. Excel doesn't support nested elements afaik. Access dont seem to bother with the linking of nested data. Sooo i might end up flattening the structure my self for Excel, which in either case would be the program i need for final analysis.</p>\n\n<p>I would like it flat or even csv format, but my concern is the size of the file. I have a subset of the data now an this xml file is already 11Meg and its a few precent of the total data.</p>\n\n<p>This is my XML file, a subset.</p>\n\n<pre><code>    &lt;Root&gt;\n    &lt;Delivery&gt;\n    &lt;Database&gt;xxxxxxx&lt;/Database&gt;\n    &lt;Path&gt;SomeUNCPath&lt;/Path&gt;\n&lt;Vessel&gt;\n&lt;SysFolder&gt;internalfolder&lt;/Sysfolder&gt;\n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;Depths&gt;\n&lt;NumberOfItems&gt;2&lt;/NumberOfItems&gt;\n&lt;Depth&gt; \n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;/Depth&gt;\n&lt;Depth&gt;\n...\n&lt;/Depth&gt;\n&lt;Vessel&gt;\n&lt;SysFolder&gt;Anotherinternalfolder&lt;/Sysfolder&gt;\n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;Depths&gt;\n&lt;NumberOfItems&gt;2&lt;/NumberOfItems&gt;\n&lt;Depth&gt; \n&lt;MoreData&gt;1&lt;/MoreData&gt;\n&lt;EvenMoreData&gt;2&lt;/EvenMoreData&gt;\n&lt;/Depth&gt;\n&lt;Depth&gt;\n...\n&lt;/Depth&gt;\n&lt;EngineRoot&gt;\n&lt;SysFolder&gt;internalfolder&lt;/Sysfolder&gt;\n&lt;NumberOfEngines&gt;5&lt;/NumberOfEngines&gt;\n&lt;Engine&gt;5 Elements of this with data&lt;/Engine&gt;\n&lt;/EngineRoot&gt;\n&lt;EngineRoot&gt;\n&lt;SysFolder&gt;Anotherinternalfolder&lt;/Sysfolder&gt;\n&lt;NumberOfEngines&gt;5&lt;/NumberOfEngines&gt;\n&lt;Engine&gt;5 Elements of this with data&lt;/Engine&gt;\n&lt;/EngineRoot&gt;\n</code></pre>\n"},{"tags":["excel","formula","pivot-table","conditional-formatting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13262200,"title":"trend analysis and conditional formatting with Excel Pivot Table","body":"<p>I am trying to apply conditional formatting to my pivot table, but can't seem to get it right despite a lot of research.</p>\n\n<p>Let's say there is the following raw data range/table describing how much different sales agents have sold per year broken down into product categories</p>\n\n<p><strong>sales agent</strong> - <strong>year</strong> - <strong>product</strong> - <strong>sales amount</strong></p>\n\n<p>The respective pivot table would have <strong>sales agent</strong> as a row, <strong>year</strong> and <strong>product</strong> as columns and <strong>sales amount</strong> as the value field.</p>\n\n<p>Now I would like to apply conditional formatting to the value fields depending on a year-on-year comparison. As an example, if the <strong>sales agent A</strong> has sold more <strong>car insurance</strong> in <strong>2012</strong> compared to <strong>2011</strong>, then the respective cell (sales agent A, 2012, car insurance) should be coloured in green.</p>\n\n<p>Moreover this should also work on a subtotals basis, i.e. if the total sales volume of <strong>sales agent A</strong> in <strong>2012</strong> is higher than in <strong>2011</strong>, then the respective cell (<strong>sales agent A</strong>, <strong>2012</strong>) should be green as well.</p>\n\n<p>I tried to use relative references within the conditional formatting dialog, but this is quite static (i.e. always using the previous column) and doesn't work for all columns nor sub totals.</p>\n\n<p>The other option would obviously VBA, basically walking through the whole pivot table identifying the column and row headers and then using GetPivotData to determine the format. But I would like to avoid that.</p>\n"},{"tags":["excel","if-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13269464,"title":"Excel: Adjacent Cells","body":"<p>How do I use the IF command, or another in adjacent cells? Example, if <code>A1 = 'knife'</code> and the adjacent cell (A2) is equal to 'fork'. That is, I need to identify an adjacent cell in the vertical direction.\n<img src=\"http://i.stack.imgur.com/oPx9v.png\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13263711,"title":"Build Insert Statement using Excel","body":"<p>I have a spread sheet with content as below.</p>\n\n<pre><code>EMPLOYEE_ID ATT_DATE    ATT_TIME\n1           10/9/2012   10:47:00\n1           10/9/2012   10:47:00\n1           10/9/2012   10:48:00\n1           10/9/2012   10:49:00\n1           10/9/2012   10:55:00\n</code></pre>\n\n<p>I want to create insert statements from these values. so i wrote below formula to generate insert statements.</p>\n\n<pre><code>=\"INSERT INTO ATTENDANCE (EMPLOYEE_ID, ATT_DATE) VALUES('\" &amp; Attendance!A2 &amp; \"', to_date('\" &amp; TEXT(Attendance!B2,\"dd-mmm-yyyy\") &amp; \"','DD-MON-YYYY'));\"\n</code></pre>\n\n<p>i want to add values in <code>ATT_TIME</code> column to above insert statements. but i'm unable to write formula correctly for that.</p>\n\n<p>how could i add values in <code>ATT_TIME</code> column to my insert statements ?</p>\n\n<p>PS: i'm using oracle database.</p>\n"},{"tags":["java","excel","apache-poi","worksheet"],"answer_count":5,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":6975,"score":11,"question_id":848212,"title":"Copying Excel Worksheets in POI","body":"<p>Does anyone know of a means to copy a worksheet from one workbook to another using POI? The Workbook class has a cloneSheet method, but there doesn't seem to be able to insert a cloned sheet into a new workbook?</p>\n\n<p>If there isn't an API to do this easily, does anyone have the code to copy all of the data (styles, column widths, data, etc) from one sheet to another?</p>\n\n<p>The jxls has methods to copy sheets, but they don't work when copying between workbooks.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13268198,"title":"How do I use data and conditions for Select Case in VBA?","body":"<p>Basically what I am trying to do:</p>\n\n<pre><code>Select Case test_expression\n   Case condition_1\n      result_1   \n   Case condition_n\n      result_n\nEnd Select\n</code></pre>\n\n<p>I need that <code>condition_n</code>, <code>result_n</code> are read from a spreadsheet where <code>condition_1</code> and <code>result_1</code> are in columns A and B. Then rows will be added sometimes to the spreadsheet!</p>\n\n<p>Thank you for any suggestions!</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13267850,"title":"VBA run a macro when cell is changed, but not if by a macro","body":"<p>OK I'm not sure if this is easily achievable but I'm going to try.</p>\n\n<p>I use this sub to execute some macros if a cell is changed:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim target As Range\nSet target = Range(\"b4\")\nIf Not Intersect(target, Range(\"b4\")) Is Nothing Then\nCall init\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This works fine but I have a bit of a problem. </p>\n\n<p>The cell <code>B4</code>, as referenced in the cell change sub above, has its value determined by a named range which is dynamic and contains a list of values on another sheet. I use the data validation tool to make <code>B4</code> a dropdown list with the contents of the named range.</p>\n\n<p>I have another macro who's purpose is to update this list. What it does is clear the current list, query a database and output a bunch of values into the range. The trouble is that when this macro is run it causes the value of <code>B4</code> to change (as <code>B4</code> references the values in the range). This in turn cause my \"cell change\" macro to run throwing up errors.</p>\n\n<p>Is there a way to prevent the \"cell change\" macro from running while I'm updating the list that it references?</p>\n\n<p>Hope that question makes sense.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13263019,"title":"Loading Image from URL in Excel","body":"<p>Basically I have a gigantic excel spread sheet with over 20,000 URL's. It would be very inefficient of me to click on each link to check the image. Instead I was wondering if I could take the url from one cell and load the image into a different cell. This of course would have to be a loop as I have so many images to load. So far I found a thread on this already but I have no idea how to implement this code.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/6312710/how-to-get-images-to-appear-in-excel-given-image-url\">How to get images to appear in Excel given image url</a></p>\n\n<p>If someone could tell me how to use this code that would be great and you will also save my sanity. Thanks!</p>\n"},{"tags":["arrays","excel","types","excel-vba","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13244797,"title":"Excel VB - Read Column into 1D Array, Perform Ops, Write Back to Named Range?","body":"<p>I have a data set that contains around 60,000 records. The delinquency date field is right after a field that deals with monetary values and sometimes users enter the monetary value in the delinquency date field by accident. Additionally, they sometimes enter the date as a string ( August, 2st, 2011) or as the number of days delinquent (135 or 135 days). The most common entry method is in the mm/dd/yy format (08/02/11).</p>\n\n<p>Sadly, the programmers of this system refuse to devote the time to create validation for this field, so I must perform as much of it as I can after I have the data. Normally, I would handle this with a few simple formulas, however, there are 19 different ways users enter the data and I need to be able to handle each of them, and quickly. Loading the column into an array seems like the best option.</p>\n\n<p>My thought is to load the column into an array, loop through it, handling all entry options (or deleting the ones that are completely messed up), then write it back to the worksheet. <strong>I know the datatype is the first problem with the array below, but I've only used arrays once before in Excel VB and am not quite sure what I am doing wrong. The third line of code is the first problem.</strong> Thanks for your help.</p>\n\n<p><strong>WORKING CODE PER BRETTDJ'S COMMENTS</strong></p>\n\n<pre><code>'Perform housekeeping on delinquency date\nDim delinquency()\ndelinquency = Application.Transpose(Range(\"AH1:AH\" &amp; importwsRowCount))\nFor i = LBound(delinquency) To UBound(delinquency)\n    If InStr(delinquency(i), \".\") Then\n        delinquency(i) = Empty\n        Debug.Print \"Emptied an array element at row \" &amp; i + 1\n    End If\n    'Additional string or numeric operations here to reformat bad entries.\nNext i\nSet delRange = Range(\"AJ1:AJ\" &amp; importwsRowCount)\niWS.names.Add Name:=\"dRange\", RefersTo:=delRange\ndelinquency = Application.Transpose(delinquency) 'Transpose rows and columns\nRange(\"dRange\").Value = delinquency 'Write array to worksheet\n</code></pre>\n\n<p><strong>BAD ENTRY EXAMPLES NEEDING REFORMATTING</strong><br/>\n<strike><strong>SEPT. 25, 20</strong></strike> (No year, no year! Delete.)<br/>\n<strong>SEPT</strong> (No year, useless, delete.)<br/>\n<strong>N/A</strong> (Rubbish! Deleted.)<br/>\n<strike><strong>LONG TIME AG</strong></strike> (What moron thought this was a good idea, delete.)<br/>\n<strike><strong>JUNE 30, 200</strong></strike> (Apparently the field will only hold 12 characters, delete.)<br/>\n<strong>CHARGED OFF</strong> (Useless, delete.)<br/>\n<strike><strong>94 DAYS</strong></strike> (Take all characters preceding space and subtract from other field containing order date to obtain delinquent date.)<br/>\n<strike><strong>94 DPD</strong></strike> (DPD in someones bright mind stands for Days Past Due I believe. Same as above.)<br/>\n<strong>2008-7-15 12</strong> (Not sure what additional number is, take all characters before space and transform.)<br/>\n<strike><strong>INVALID</strong></strike> (Delete.)<br/>\n<strike><strong>BLANK</strong></strike> (Do nothing.)<br/>\n<strike><strong>12282009</strong></strike> (Use nested LEFT and RIGHT and CONCATENATE with / in between.)<br/>\n<strike><strong>9202011</strong></strike> (Add leading zero, then same as above.)<br/>\n<strike><strong>92410</strong></strike> (Add leading zero, this will transform to 09/24/10)<br/>\n<strike><strong>41261</strong></strike> (Days since 31/12/1899, this will transform to 12/08/12)<br/>\n<strike><strong>1023</strong></strike> (Days since delinquent, subtract from ORDER DATE to get delinquent date.)<br/>\n<strike><strong>452</strong></strike> (Same as above.)<br/>\n<strike><strong>12</strong></strike> (Same as above.)<br/>\n<strike><strong>1432.84</strong></strike> (Monetary value, mistakenly entered by low IQ lackey. Delete.)</p>\n\n<p><strong>Updated Code Including Removing Bad Entries (Work in Progress)</strong></p>\n\n<pre><code>'Perform housekeeping on delinquency date\nColumns(\"AH:AH\").Select\nSelection.NumberFormat = \"0\"\nSelection.Copy\nSelection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n    True, Transpose:=False\nDim delinquency()\nReDim del(1 To importwsRowCount, 1 To 1)\ndel = Range(\"AH1:AH\" &amp; importwsRowCount).Value\nFor i = LBound(del, 1) To UBound(del, 1)\n    delChars = Len(del(i, 1)) 'Determine length of entry\n    If IsNumeric(del(i, 1)) = True Then 'Determine datatype of entry\n        delType = \"Numeric\"\n    Else\n        delType = \"String\"\n    End If\n    If InStr(del(i, 1), \".\") Then 'Removes monetary entries like 142.84\n        del(i, 1) = Empty\n    ElseIf InStr(del(i, 1), \"*\") Then 'Removes ***INVALID*** entries\n        del(i, 1) = Empty\n    ElseIf delChars = 12 Then 'Removes all entries that extend beyond the 12 character limit of the field and get cut off\n        del(i, 1) = Empty\n    ElseIf delType = \"String\" And Len(del(i, 1).Value) &lt; 10 And InStrRev(del(i, 1).Value, \" \") Then 'Takes the number from entries like 2194 Days or 23 DPD\n        del(i, 1).Value = Left(del(i, 1).Value, Len(del(i, 1).Value) - InStrRev(del(i, 1).Value, \" \"))\n        If IsNumeric(del(i, 1)) = False Then 'If the characters to the left of the space are not numbers, discard\n            del(i, 1).Value = Empty\n        Else\n            del(i, 1).Value = Format((CLng(Range(\"E\" &amp; i + 1).Value) - Abs(del(i, 1).Value)), \"mm/dd/yy\") 'Pull order date and subtract days from it for delinquency date\n        End If\n    ElseIf delType = \"Numeric\" And Len(del(i, 1)) = 5 Then\n        If del(i, 1).Value &gt; CLng(Date) Then 'Value is greater than todays date, improperly formated date that needs character manipulation and / added\n            del(i, 1).Value = Format(del(i, 1).Value, \"000000\") 'Add leading zero\n            del(i, 1).Value = DateSerial(Right(del(i, 1).Value, 2), Left(del(i, 1).Value, 2), Right(Left(del(i, 1).Value, 2), 4)) 'Grab year, then month, then day for serialize\n        Else\n            del(i, 1).Value = Format(del(i, 1).Value, \"mm/dd/yy\") 'Properly formated date that just needs format conversion\n        End If\n    ElseIf delType = \"Numeric\" And (delChars = 7 Or delChars = 8) Then\n        If delChars = 7 Then\n            del(i, 1).Value = Format(del(i, 1).Value, \"00000000\") 'Add leading zero\n        End If\n        del(i, 1).Value = DateSerial(Right(del(i, 1).Value, 4), Left(del(i, 1).Value, 2), Right(Left(del(i, 1).Value, 2), 6)) 'Grab year, then month, then day for serialize\n    ElseIf delType = \"Numeric\" And delChars &lt; 5 Then\n        del(i, 1).Value = Format((CLng(Range(\"E\" &amp; i + 1).Value) - Abs(del(i, 1).Value)), \"mm/dd/yy\")\n    End If\nNext i\nSet dRange = Range(\"AJ1:AJ\" &amp; importwsRowCount)\niWS.names.Add Name:=\"dRange\", RefersTo:=delRange\ndelinquency = Application.Transpose(delinquency) 'Transpose rows and columns\nRange(\"dRange\").Value = delinquency 'Write array to worksheet\n</code></pre>\n"},{"tags":["php","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13266146,"title":"Excel csv export into a php file with fgetcsv","body":"<p>I'm using excel 2010 professional plus to create an excel file.\nLater on I'm trying to export it as a UTF-8 .csv file. \nI do this by saving it as CSV (symbol separated.....<em>sry I know not the exact wording there\nbut I don't have the english version and I fear it is translated differently than 1:1</em>).\nThere I click on tools->weboptions and select unicode (UTF-8) as encoding.\nThe example .csv is as follows:</p>\n\n<pre><code>ID;englishName;germanName\n1;Austria;Österreich\n</code></pre>\n\n<p>So far so good, but if I open the file now with my php code:</p>\n\n<pre><code> header('Content-Type: text/html; charset=UTF-8');\n iconv_set_encoding(\"internal_encoding\", \"UTF-8\");\n iconv_set_encoding(\"output_encoding\", \"UTF-8\");\n setlocale(LC_ALL, 'de_DE.utf8');\n $fp=fopen($filePathName,'r');\n while (($dataRow= fgetcsv($fp,0,\";\",'\"') )!==FALSE)\n {\n     print_r($dataRow);\n }\n</code></pre>\n\n<ul>\n<li>I get: �sterreich as a result on the screen (as that is the \"error\" I cut all other parts of the result).</li>\n<li>If I open the file with notedpad++ and look at the encoding I see \"ANSI\" instead of UTF-8.</li>\n<li>If I change the encoding in notepad++ to UTF8....the ö,ä,... are replaced by special chars, which I have to correct manually.</li>\n</ul>\n\n<p>If I go another route and create a new UTF-8 file with notedpad++ and put in the same data as in the excel file I get shown \"Österreich\" on screen when I open it with the php file.</p>\n\n<p>Now the question I have is, why does it not function with excel, thus am I doing something wrong here? Or am I overlooking something?</p>\n\n<p>Tnx</p>\n"},{"tags":["excel","vba","loops","extract","worksheet"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13267246,"title":"VBA: Extract column until empty, repeat in next sheet","body":"<p>Dear Stack Overflow swarm.</p>\n\n<p>In file \"Prodcuts.xlmx\" I have thousands of numerical values at column A at Worksheet \"Contract1\". Same file contains several other similar Worksheets with names \"Contract2\" and so forth. The number of rows changes in each worksheet and may change in same worksheet over time, but they are always followed by empty row. Number of worksheets is static</p>\n\n<p>I need to collect the information from these worksheets to second file to a single worksheet, lets call it \"Productlist\" in a format where Column A contains Worksheet name repeated, and Column B the numerical values.</p>\n\n<p>I would prefer a extraction loop that simply copies this information, to avoid multiple check's for possible changes.</p>\n\n<p>I can not use select column for copying source, as after empty cells, comes additional set of data which is not required.</p>\n\n<p>General idea is</p>\n\n<p>Get WS1 Column A content, until empty row, copy to \"Productlist\" column B</p>\n\n<p>Get WS1 WS Name, copy to \"Produclist\" column A, repeat until Column B has no value (or Column B +1 row has no value, to avoid 1 extra row of WS name)</p>\n\n<p>Add 2 empty rows</p>\n\n<p>Repeat for WS2, until WSn does not exist (or match count).</p>\n"},{"tags":["php","html","excel"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":6129,"score":1,"question_id":3437745,"title":"HTML table to excel - PHP","body":"<p>I am creating a report in Table format. \nThis report is displayed on the browser.\nI want to provide a download report in excel format link so that the report can be available in excel file also.\nHow can I do this</p>\n"},{"tags":["excel","vba"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2769,"score":3,"question_id":7772986,"title":"if Excel Workbook is open then...... VBA","body":"<p>How could I write code to say.</p>\n\n<pre><code>    Dim xlApp As Excel.Application\n    Dim xlWorkbook As Excel.Workbook\n    Dim xlWorksheet As Excel.Worksheet\n</code></pre>\n\n<p>if an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> Workbook is already open then.... </p>\n\n<pre><code>    Set xlApp = GetObject(, \"Excel.Application\")\n\n    elseif xlApp is nothing then\n    Set xlApp = New Excel.Application\n    xlApp.Visible = True\n    Set xlWorkbook = xlApp.Workbooks.Open(\"E:\\InspectionCreator\\InspectionSheet.xlsx\")\nEnd if\n</code></pre>\n\n<p>I don't want it to have to be a specific workbook just any workbook I can't seem to find anything on the internet. Any help would be awesome.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":33,"score":-3,"question_id":13266588,"title":"Is it possible to copy a file's name from Windows into Excel?","body":"<p>JUst like the question - I am wondering if there is a way to get a file's name and insert it into an Excel sheet? Also, if possible, what would that require? </p>\n\n<p>Any help is appreciated, thanks.</p>\n"},{"tags":["c++","excel","ado"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13267235,"title":"ADO OpenSchema(adSchemaColumns) fails for the odd excel file","body":"<p>I have code that reads column headers from MS Excel files using C++ &amp; ADO. I got this one Excel file from someone for which the OpenSchema(adSchemaColumns) command fails (The error is: 0x800A0CB3: \"Object or provider is not capable of performing requested operation\"). To narrow the problem, I removed all data from the file &amp; deleted all columns except column A. If I delete column A as well, OpenSchema succeeds. Otherwise, it fails. I compared column A to other columns using the excel CELL function: format, protection, contents: but there is no difference.</p>\n\n<p>In any case, OpenSchema(adSchemaTables) does NOT fail.</p>\n\n<p>This is an excerpt of the C++ code I use, built with VS2010:</p>\n\n<pre><code>#import \"C:\\Program Files\\Common Files\\System\\ADO\\msado28.tlb\" no_namespace rename(\"EOF\", \"adoEOF\") rename(\"BOF\", \"adoBOF\")\n\n_ConnectionPtr pCon;\npCon.CreateInstance(__uuidof(Connection))\npCon-&gt;Open(connStr, \"\", \"\", NULL)\n_RecordsetPtr pSchema = NULL;\npSchema = pCon-&gt;OpenSchema(adSchemaColumns);\n</code></pre>\n\n<p>This is a link to the faulty excel file:\n<a href=\"https://docs.google.com/open?id=0B2BtmmWMZ5T9TUxFWS13T0tWREk\" rel=\"nofollow\">workbook.xls</a></p>\n\n<p>I use MS Excel 2010.</p>\n\n<p>To reproduce: run the code on unchanged workbook.xls - fails. Delete column A - succeeds.</p>\n\n<p>Any ideas are welcome,</p>\n\n<p>Thank you</p>\n"},{"tags":["excel","excel-formula"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13264710,"title":"Copying Data from another Excel Workbook based on a matching id","body":"<p>I have 2 workbooks I am working with.</p>\n\n<ul>\n<li>One workbook has an id and a category name.</li>\n<li>The other workbook shows a name and category section that has an id number (but not the actual description).</li>\n</ul>\n\n<p>Basically I want to copy the full category text to my current workbook from the old one based on the id number into a new column</p>\n\n<p>What kind of formula can I use to check the id number category pair and then copy it into the new workbook in a new column? </p>\n\n<p>Any help is great!</p>\n"},{"tags":["excel","vba","excel-vba","reporting"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13266576,"title":"Identifying Unique Rows in Excel","body":"<p>I have an excel spreadsheet that contains over 20,000 rows and between 20/30 columns.</p>\n\n<p>What is the easiest way to identify the rows that are unique - i.e a process that iterates through the rows and genrates a sum of the number of unique rows within the datasheet?</p>\n\n<p>I would like this to be self-contained within a worksheet - i.e. a macro, but am open to other suggestions should the above approach be deemed inappropriate for whatever reason.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13259807,"title":"VBA code to check each sheet, locate a cell containing =TODAY() function, and select that cell","body":"<p>I have a workbook with 12 worksheets each named JANUARY through FEBRUARY.</p>\n\n<p>Only the current month's sheet (e.g., NOVEMBER) will ever contain a cell containing the function <code>=TODAY()</code> in mm/dd/yyyy date format.</p>\n\n<p>When I open the workbook, I want to automatically activate the Sheet that contains this cell (in my instance Cell <code>N2</code>) and <code>Select</code> it. I am truly a newbie learning slowly, but knowledge is minimal and can't find what I need. This what I have so far, but it doesn't work:</p>\n\n<pre><code>Sub ChooseSheet()\nDim SearchString As Variant\n\nSearchString = \"TODAY()\"       'string I am searching for\n\nDo Until SearchString = \"TODAY()\"\nIf Application.WorksheetFunction.CountIf(Sheets(\"Sheet1\").Columns(14), SearchString) &gt; 0 Then\nWorksheets(\"Sheet1\").Activate\n            End If\n        Exit Do                \nLoop\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13262980,"title":"Triggering of Excel Function","body":"<pre><code>Worksheets(\"InputSheet\").Outline.ShowLevels RowLevels:=1\n</code></pre>\n\n<p>After excution of this Line, A UDF is triggered and and this UDF ends abruptly for reasons unknown to me.</p>\n\n<p>The UDF is not called directly anywhere in \"InputSheet\" . Only a NamedCell which is in another sheet using this function is used in \"InputSheet\".</p>\n\n<p>I dont want the function to be triggered.<br>\nAny possible reasons or solutions</p>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":20,"score":-4,"question_id":13265560,"title":"write a string value into a excel sheet using c# with parameterized function","body":"<p>I have to write a set of string values into a excel sheet using function parameters to a particular cell row,col .</p>\n\n<p>Please give inputs   </p>\n"},{"tags":["excel","vlookup"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13261247,"title":"Excel Lookup - Pretty Difficult, Selecting from a Range","body":"<p>I have two tabs, one is \"sales detail\" which contains a field named \"sales zipcode\". The \"sales territory\" tab has a range of zipcodes and the corresponding \"Sales Territory ID\" </p>\n\n<pre><code>Zipcode Low        Zipcode High       Sales Territory ID\n\n10000              19999                    15\n\n20000              24999                    20\n\n25000              33999                    22\n</code></pre>\n\n<p>ETC ETC </p>\n\n<p>How can I write a formula for the Sales Territory ID based on the Zipcode?</p>\n\n<p>For instance</p>\n\n<pre><code>Zipcode  Sales Territory ID\n\n02348        =???       \n\n23485\n\n23433\n</code></pre>\n\n<p>Thank you for your help.</p>\n"},{"tags":["c#","asp.net","excel","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13259420,"title":"Export GridView into Excel","body":"<p>I'm trying to export my GridView into a 2010 Excel file <code>.xlsx</code> format.  It works with an <code>.xls</code> I was wondering if anyone could help me out.  Here is what I have so far:</p>\n\n<pre><code>protected void Button2_Click(object sender, EventArgs e)\n    {\n        Response.Clear();\n        Response.Buffer = true;\n        Response.AddHeader(\"content-disposition\",\n        \"attachment;filename=GridViewExport.xls\");\n        Response.Charset = \"\";\n        Response.ContentType = \"application/vnd.xls\";\n        StringWriter sw = new StringWriter();\n        HtmlTextWriter hw = new HtmlTextWriter(sw);\n        GridView1.AllowPaging = false;\n        GridView1.DataBind();\n\n        GridView1.HeaderRow.Style.Add(\"background-color\", \"#FFFFFF\");\n\n        GridView1.HeaderRow.Cells[0].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[1].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[2].Style.Add(\"background-color\", \"#D1EEEE\");\n\n        GridView1.HeaderRow.Cells[3].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[4].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[5].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[6].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[7].Style.Add(\"background-color\", \"#D1EEEE\");\n        GridView1.HeaderRow.Cells[8].Style.Add(\"background-color\", \"#D1EEEE\");\n        for (int i = 0; i &lt; GridView1.Rows.Count; i++)\n        {\n\n            GridViewRow row = GridView1.Rows[i];\n            row.BackColor = System.Drawing.Color.White;\n            row.Attributes.Add(\"class\", \"textmode\");\n            if (i % 2 != 0)\n            {\n\n                row.Cells[0].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[1].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[2].Style.Add(\"background-color\", \"#FFFFFF\");\n                row.Cells[3].Style.Add(\"background-color\", \"#FFFFFF\");\n\n            }\n        }\n        GridView1.RenderControl(hw);\n        string style = @\"&lt;style&gt; .textmode { mso-number-format:\\@; } &lt;/style&gt;\";\n        Response.Write(style);\n        Response.Output.Write(sw.ToString());\n        Response.Flush();\n        Response.End();\n\n    }\n</code></pre>\n"},{"tags":["excel","rename"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13234540,"title":"Renaming Cells In Excel","body":"<p>I don't know if this is possible, but I have been advised to post here and the most likely place for an answer.</p>\n\n<p>I have four columns in excel as follows</p>\n\n<pre><code>A: all product id's\nB: reference No.\nC: selected product id's\nD: product codes.\n</code></pre>\n\n<p>What I would like excel to do is search column A for the id's in column C, and if there is a match, rename it to the corresponding row in column D from the search in column D. I can't use vlookup easily as the product id's in column A may repeat upto 8 times.</p>\n\n<p>I hope that makes sense and I will try to answer all questions that I can. I know nothing about excel, beyond on the basics so if anyone could shed some light on this I would be grateful.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":141,"score":6,"question_id":13016249,"title":"How to improve the speed of VBA macro code?","body":"<p>I do not have much experience with writing macros, and therefore need the help of this community for the following issue encountered:</p>\n\n<p>My macro copies a range of values entered in a vertical range in one worksheet and then pastes the values horizontally (transpose) in another worksheet.  It would in theory paste the values from the first sheet to first row of the second worksheet which does not have content. Since the first five rows have contents, it thus pastes the values to the sixth row. \nThe problem I have with the running of the macro is that I feel like it is too slow and I would therefore like it to run faster. </p>\n\n<p>I have the same macro doing the same thing but that instead pastes the values to another worksheet to the first row, and it runs perfect. </p>\n\n<p>My best guess is therefore that the second macro is running slow because it has to start pasting on the sixth row and there may be some contents on the first 5 rows that take a lot of time for the macro to go through (there a lot of cell references to other workbooks) to determine where the next row for pasting should be. That is my best guess though and since I hardly know anything about macros, I cannot say for sure what the problem is. </p>\n\n<p>I hereby provide you with the code of my macro and sincerely hope that somebody can tell me what is making my macro slow and provide me with a solution as to how to make it run faster. I am thinking that a solution might potentially be that the macro should not consider the first five rows of data and start pasting immediately on row 6 for the first entry. Then on row 7 the next time, and etc. This might be a solution but I do not know how to write the code in a way that it would do that. </p>\n\n<p>Thank you for taking time and helping me to find a solution, here is the code:</p>\n\n<pre><code>Sub Macro1()\nApplication.ScreenUpdating = False\n\n    Dim historyWks As Worksheet\n    Dim inputWks As Worksheet\n\n    Dim nextRow As Long\n    Dim oCol As Long\n\n    Dim myCopy As Range\n    Dim myTest As Range\n\n    Dim lRsp As Long\n\n    Set inputWks = wksPartsDataEntry\n    Set historyWks = Sheet11\n\n      'cells to copy from Input sheet - some contain formulas\n      Set myCopy = inputWks.Range(\"OrderEntry2\")\n\n      With historyWks\n          nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n      End With\n\n      With inputWks\n          Set myTest = myCopy.Offset(0, 2)\n\n          If Application.Count(myTest) &gt; 0 Then\n              MsgBox \"Please fill in all the cells!\"\n              Exit Sub\n          End If\n      End With\n\n      With historyWks\n          With .Cells(nextRow, \"A\")\n              .Value = Now\n              .NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n          End With\n          .Cells(nextRow, \"B\").Value = Application.UserName\n          oCol = 3\n          myCopy.Copy\n          .Cells(nextRow, 3).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n          Application.CutCopyMode = False\n      End With\n\n      'clear input cells that contain constants\n      With inputWks\n        On Error Resume Next\n           With myCopy.Cells.SpecialCells(xlCellTypeConstants)\n                .ClearContents\n                Application.GoTo .Cells(1) ', Scroll:=True\n           End With\n        On Error GoTo 0\n      End With\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"},{"tags":["excel","list","sharepoint2010","sharepoint2007"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1046,"score":0,"question_id":11013412,"title":"Tool to import Excel sheet data to Sharepoint list","body":"<p>Are there any tools to import Excel sheet data to Sharepoint list ? \nI have found a <a href=\"http://www.rddevsolutions.com/Pages/Magic/MagicScreenshots.aspx#\" rel=\"nofollow\">tool</a> to do that. Are there any alternatives to do this task?</p>\n\n<p>[should be support any Excel version and any SharePoint version]</p>\n"},{"tags":["java","database","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12746572,"title":"import data from database to Excel using java?","body":"<p>import data from excel to database using java, i find \"Apachi POI\" . </p>\n\n<p>But now, i want to import data from database to excel using java. May i use for this \"Apachi POI\" too? if no, what i must do? thanks </p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13261428,"title":"Select from \"this sheet\" to the end in Excel VBA","body":"<p>I'm building a report in <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a>.  </p>\n\n<ul>\n<li>The finishing step is to select a large proportion of the sheets (all the ones to the right of the \"Cover\" page including the cover itself) and print them to PDF. </li>\n<li>The list of sheets can vary.</li>\n</ul>\n\n<p>I'm currently doing this manually, but it seems the sort of thing that can be automated if you know the correct command. </p>\n\n<p>Is it possible to do something along the following line?</p>\n\n<pre><code>Sheets(Array(Sheets(\"Cover\")..Sheets(Worksheets.Count())).Select\nActiveSheet.ExportAsFixedFormat\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13261621,"title":"Dual Loops in VBA","body":"<p>I am trying to run this loop where the indices in the loop change at the same time. </p>\n\n<pre><code>For i = 0 To 20 Step 5\nFor j = 0 To 5 Step 1\n\nRange(ActiveCell, ActiveCell.Offset(5 + i, 0)).Copy Destination:=Cells(8, 12 + j)\n\nNext i\nNext j\n</code></pre>\n\n<p>I am trying to get the loop to do this</p>\n\n<pre><code>Range(ActiveCell, ActiveCell.Offset(5 + 0, 0)).Copy Destination:=Cells(8, 12 + 0)\nRange(ActiveCell, ActiveCell.Offset(5 + 5, 0)).Copy Destination:=Cells(8, 12 + 1)\nRange(ActiveCell, ActiveCell.Offset(5 + 10, 0)).Copy Destination:=Cells(8, 12 + 2)\nRange(ActiveCell, ActiveCell.Offset(5 + 15, 0)).Copy Destination:=Cells(8, 12 + 3)\nRange(ActiveCell, ActiveCell.Offset(5 + 20, 0)).Copy Destination:=Cells(8, 12 + 4)\n</code></pre>\n\n<p>The loop I have unfortuantly does this:</p>\n\n<pre><code>Range(ActiveCell, ActiveCell.Offset(5 + 0, 0)).Copy Destination:=Cells(8, 12 + 0)\nRange(ActiveCell, ActiveCell.Offset(5 + 5, 0)).Copy Destination:=Cells(8, 12 + 0)\nRange(ActiveCell, ActiveCell.Offset(5 + 10, 0)).Copy Destination:=Cells(8, 12 + 0)\n...\nRange(ActiveCell, ActiveCell.Offset(5 + 0, 0)).Copy Destination:=Cells(8, 12 + 1)\nRange(ActiveCell, ActiveCell.Offset(5 + 5, 0)).Copy Destination:=Cells(8, 12 + 1)\n</code></pre>\n\n<p>I guess I can have a single loop such that: But that doesn't quite do it.</p>\n\n<pre><code>For i = 0 To 20 Step 5\n\nRange(ActiveCell, ActiveCell.Offset(5 + i, 0)).Copy Destination:=Cells(8, 12 + j-4)\n\nNext j\n</code></pre>\n\n<p>Can anyone suggest any ideas for having a loop where the indicies are changing concurrently at the same time? Thank you!!</p>\n"},{"tags":["excel","date","types","excel-vba","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13260732,"title":"Excel, VB - Serialize an 8 digit date to mm/dd/yy","body":"<h1>ISSUE</h1>\n\n<p>I am trying to convert a 8 digit number into a date while in an array. Examples of the entries are 12282009 or 12202007. There are other malformed entries in the field including dates entered as strings. I want the 8 digit number to be formatted as 12/28/09 or 12/20/07 respectively. <strong>I keep getting a type mismatch error on the third to last line below. How do I do this??</strong> </p>\n\n<h1>CODE</h1>\n\n<pre><code>Dim del()\nReDim del(1 To importwsRowCount, 1 To 1)\ndel = Range(\"AH1:AH\" &amp; importwsRowCount).Value\nDim delChars As Long\nDim delType As String\nFor i = LBound(del, 1) To UBound(del, 1)\n    delChars = Len(del(i, 1)) 'Determine length of entry\n    If IsNumeric(del(i, 1)) = True Then 'Determine datatype of entry\n        delType = \"Numeric\"\n        del(i, 1) = Abs(del(i, 1))\n    Else\n        delType = \"String\"\n        del(i, 1) = UCase(del(i, 1))\n    End If     \nIf delType = \"Numeric\" Then\n    If delChars = 8 Then\n        del(i, 1) = DateSerial((Right(del(i, 1), 4)), (Left(del(i, 1), 2)), (Mid(del(i, 1), 3, 2))) '&lt;-- TYPE MISMATCH ERROR\n    End If\nEnd If\n</code></pre>\n\n<h1>ENTRY TEMPLATES</h1>\n\n<p><strong>SEPT. 25, 20</strong> (No year, no year! Delete.)<br>\n<strong>SEPT</strong> (No year, useless, delete.)<br>\n<strong>N/A</strong> (Rubbish! Deleted.)<br>\n<strong>LONG TIME AG</strong> (What moron thought this was a good idea, delete.)<br>\n<strong>JUNE 30, 200</strong> (Apparently the field will only hold 12 characters, delete.)<br>\n<strong>CHARGED OFF</strong> (Useless, delete.)<br>\n<strong>94 DAYS</strong> (Take all characters preceding space and subtract from other field containing order date to obtain delinquent date.)<br>\n<strong>94 DPD</strong> (DPD in someones bright mind stands for Days Past Due I believe. Same as above.)<br>\n<strong>2008-7-15 12</strong> (Not sure what additional number is, take all characters before space and transform.)<br>\n<strong>INVALID</strong> (Delete.)<br>\n<strong>BLANK</strong> (Do nothing.)<br>\n<strong>4/2/4/09</strong> (Malformed date, delete.)<br>\n<strong>1/1/009</strong> (Same as above.)<br>\n<strong>12282009</strong> (Use nested LEFT and RIGHT and CONCATENATE with / in between.)<br>\n<strong>9202011</strong> (Add leading zero, then same as above.)<br>\n<strong>92410</strong> (Add leading zero, this will transform to 09/24/10)<br>\n<strong>41261</strong> (Days since 31/12/1899, this will transform to 12/08/12)<br>\n<strong>1023</strong> (Days since delinquent, subtract from ORDER DATE to get delinquent date.)<br>\n<strong>452</strong> (Same as above.)<br>\n<strong>12</strong> (Same as above.)<br>\n<strong>1432.84</strong> (Monetary value, mistakenly entered by low IQ lackey. Delete.)<br></p>\n"},{"tags":["java","excel","csv"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1740,"score":2,"question_id":6505250,"title":"How to create an Excel file based on CSV file using Java?","body":"<p>I have a requirement to create an XLS file on the basis of a CSV file using Java.</p>\n\n<p>Please suppest to me which API is best to create excel file.</p>\n\n<p>Thanks</p>\n"},{"tags":["php","mysql","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12950978,"title":"Using libXL with PHP and mySQL","body":"<p>I'm working on importing and exporting very high volumes of data from Excel into/out of MySQL via PHP. I have a working solution but it is very memory intensive and slow.</p>\n\n<p>I have seen that a developer has produced a Unix build PHP script incorporating libXL - a very fast C library for excel that costs about $200. This purports to process 10,000 cells in 0.03 secs using 262kb of PHP memory.</p>\n\n<p>I also notice that someone posting on this site is developing a stand alone dll based on libXL which I don't think will be suitable for my purpose. </p>\n\n<p>Questions:</p>\n\n<p>Is anyone out there looking to produce a simple to implement PHP libaray built around libXL which I could deploy on both a local Windows based XAMPP rig and onto my UNIX based host (Hostpapa while I'm developing)</p>\n\n<p>Would I need to buy libXL for both Windows and UNIX to work both locally and on-line</p>\n\n<p>Are there any other PHP solutions which are very fast and have low memory requirements</p>\n\n<p>I have tried every PHP solution suggested by the PHPExcel developer, Mark Baker (thanks Mark), and nothing meets my requirements fully so no suggestions along those lines please.</p>\n\n<p>I am considering learning Perl so I can use the excellent Excel parser that exists but unfortunately I've got time constraints and I think that will take me too long.</p>\n"},{"tags":["java","excel","jasper-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13260904,"title":"jasper ireport not honoring cell border in table detail in excel","body":"<p>I am using iReport to create a report from my database.  In my table header and column group header, I have a border between two columns with a width of 1 - a slightly darker border.  I tried to put in the same border on the column header and detail cells, however when I export to excel, I see the thin standard borders on the header and detail.  It looks fine in the iReport internal preview or an html preview.  Why is this?</p>\n\n<p>I'm setting:</p>\n\n<pre><code>JRXlsExporter exporter = new JRXlsExporter();\njasperPrint.setProperty(\"net.sf.jasperreports.export.xls.detect.cell.type\", \"true\");\njasperPrint.setProperty(\"net.sf.jasperreports.export.xls.ignore.cell.border\", \"false\");\njasperPrint.setProperty(\"net.sf.jasperreports.export.xls.use.timezone\", \"true\");\njasperPrint.setProperty(\"net.sf.jasperreports.export.xls.white.page.background\", \"true\");    \njasperPrint.setProperty(\"net.sf.jasperreports.export.xls.remove.empty.space.between.rows\", \"true\");\nexporter.setParameter(JRXlsAbstractExporterParameter.IS_REMOVE_EMPTY_SPACE_BETWEEN_ROWS, true);\nexporter.setParameter(JRXlsAbstractExporterParameter.IS_DETECT_CELL_TYPE, true);\nexporter.setParameter(JRXlsAbstractExporterParameter.IGNORE_PAGE_MARGINS, false);\nhm.put(JRParameter.REPORT_TIME_ZONE, TimeZone.getTimeZone(\"US/Eastern\"));\nexporter.setParameter(JRExporterParameter.JASPER_PRINT, jasperPrint);\nexporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME, xlsFile);\n</code></pre>\n"},{"tags":["excel","parsing","date","excel-vba","formatting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13255896,"title":"Excel, VB - Character Operations & Date Reformating Inside Array","body":"<h1>ISSUE</h1>\n\n<p>Large dataset with many improperly or non-uniformly entered dates in a specific field. There are about 19 different ways the dates have been entered in about 60,000 records. Some entries are completely invalid and must be discarded, others must be formatted properly. I am loading the range into an array and then performing the operations. <strong>I wrote out the operations as I believe I need, however I need some help in actually getting them working. See code below; error in comments.</strong></p>\n\n<h1>CURRENT PROBLEM</h1>\n\n<p>For entries like '54 Days' the following code should only take the characters to the left of the space, and then check if they are numeric. If they are, it keeps them, if they are not it empties that array element. <strong>In practice, nothing is happening, I still have the full entry in the array element?</strong> </p>\n\n<pre><code>ElseIf delType = \"String\" And Len(del(i, 1)) &lt; 10 And InStrRev(del(i, 1), \" \") Then 'Takes the number from entries like 2194 Days or 23 DPD\n    del(i, 1) = Left(del(i, 1), Len(del(i, 1)) - InStrRev(del(i, 1), \" \"))\n    If IsNumeric(del(i, 1)) = False Then 'If the characters to the left of the space are not numbers, discard\n        del(i, 1) = Empty\n    Else\n        del(i, 1) = Format((CLng(Range(\"E\" &amp; i + 1).Value) - Abs(del(i, 1))), \"mm/dd/yy\") 'Pull order date and subtract days from it for delinquency date\n    End If\n</code></pre>\n\n<h1>ENTRY TEMPLATES</h1>\n\n<p><strong>SEPT. 25, 20</strong> (No year, no year! Delete.)<br>\n<strong>SEPT</strong> (No year, useless, delete.)<br>\n<strong>N/A</strong> (Rubbish! Deleted.)<br>\n<strong>LONG TIME AG</strong> (What moron thought this was a good idea, delete.)<br>\n<strong>JUNE 30, 200</strong> (Apparently the field will only hold 12 characters, delete.)<br>\n<strong>CHARGED OFF</strong> (Useless, delete.)<br>\n<strong>94 DAYS</strong> (Take all characters preceding space and subtract from other field containing order date to obtain delinquent date.)<br>\n<strong>94 DPD</strong> (DPD in someones bright mind stands for Days Past Due I believe. Same as above.)<br>\n<strong>2008-7-15 12</strong> (Not sure what additional number is, take all characters before space and transform.)<br>\n<strong>INVALID</strong> (Delete.)<br>\n<strong>BLANK</strong> (Do nothing.)<br>\n<strong>12282009</strong> (Use nested LEFT and RIGHT and CONCATENATE with / in between.)<br>\n<strong>9202011</strong> (Add leading zero, then same as above.)<br>\n<strong>92410</strong> (Add leading zero, this will transform to 09/24/10)<br>\n<strong>41261</strong> (Days since 31/12/1899, this will transform to 12/08/12)<br>\n<strong>1023</strong> (Days since delinquent, subtract from ORDER DATE to get delinquent date.)<br>\n<strong>452</strong> (Same as above.)<br>\n<strong>12</strong> (Same as above.)<br>\n<strong>1432.84</strong> (Monetary value, mistakenly entered by low IQ lackey. Delete.)<br></p>\n\n<h1>CODE (WORK IN PROGRESS)</h1>\n\n<pre><code>'Perform housekeeping on delinquency date\nColumns(\"AH:AH\").Select\nSelection.NumberFormat = \"0\"\nSelection.Copy\nSelection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _\n    True, Transpose:=False\nDim del()\nReDim del(1 To importwsRowCount, 1 To 1)\ndel = Range(\"AH1:AH\" &amp; importwsRowCount).Value\nDim delChars As Long\nDim delType As String\nFor i = LBound(del, 1) To UBound(del, 1)\n    delChars = Len(del(i, 1)) 'Determine length of entry\n    If IsNumeric(del(i, 1)) = True Then 'Determine datatype of entry\n        delType = \"Numeric\"\n    Else\n        delType = \"String\"\n    End If\n    If InStr(del(i, 1), \".\") Then 'Removes monetary entries like 142.84\n        del(i, 1) = Empty\n    ElseIf InStr(del(i, 1), \"*\") Then 'Removes ***INVALID*** entries\n        del(i, 1) = Empty\n    ElseIf delChars = 12 Then 'Removes all entries that extend beyond the 12 character limit of the field and get cut off\n        del(i, 1) = Empty\n    ElseIf delType = \"String\" And Len(del(i, 1)) &lt; 10 And InStrRev(del(i, 1), \" \") Then 'Takes the number from entries like 2194 Days or 23 DPD\n        del(i, 1) = Left(del(i, 1), Len(del(i, 1)) - InStrRev(del(i, 1), \" \"))\n        If IsNumeric(del(i, 1)) = False Then 'If the characters to the left of the space are not numbers, discard\n            del(i, 1) = Empty\n        Else\n            del(i, 1) = Format((CLng(Range(\"E\" &amp; i + 1).Value) - Abs(del(i, 1))), \"mm/dd/yy\") 'Pull order date and subtract days from it for delinquency date\n        End If\n    ElseIf delType = \"Numeric\" And Len(del(i, 1)) = 5 Then\n        If del(i, 1) &gt; CLng(Date) Then 'Value is greater than todays date, improperly formated date that needs character manipulation and / added\n            del(i, 1) = Format(del(i, 1), \"000000\") 'Add leading zero\n            del(i, 1) = DateSerial(Right(del(i, 1), 2), Left(del(i, 1), 2), Right(Left(del(i, 1), 2), 4)) 'Grab year, then month, then day for serialize\n        Else\n            del(i, 1) = Format(del(i, 1), \"mm/dd/yy\") 'Properly formated date that just needs format conversion\n        End If\n    ElseIf delType = \"Numeric\" And (delChars = 7 Or delChars = 8) Then\n        If delChars = 7 Then\n            del(i, 1) = Format(del(i, 1), \"00000000\") 'Add leading zero\n        End If\n        del(i, 1) = DateSerial(Right(del(i, 1), 4), Left(del(i, 1), 2), Right(Left(del(i, 1), 2), 6)) 'Grab year, then month, then day for serialize\n    ElseIf delType = \"Numeric\" And delChars &lt; 5 Then\n        del(i, 1) = Format((CLng(Range(\"E\" &amp; i + 1)) - Abs(del(i, 1))), \"mm/dd/yy\")\n    End If\nNext i\nSet delRange = Range(\"AJ1:AJ\" &amp; importwsRowCount)\niWS.names.Add Name:=\"dRange\", RefersTo:=delRange\nRange(\"dRange\").Value = del 'Write array to worksheet\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13260311,"title":"VBA Range reference using \"Cells\"references","body":"<p>I'm using long variables to denote columns and rows.</p>\n\n<p>When I try to specify a range by the type <code>sheetname.range(cells(i,j), cells(i+1, j+1))</code> I'm getting a Method <code>Range of Object Worksheet failed</code> error.  </p>\n\n<p>Any ideas on how to use a range when using long variables as cell references?</p>\n"},{"tags":["excel","matlab","range"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13149167,"title":"How change an arbitrary range of values to ranged values?","body":"<p>I am going to convert an array as [1 2 6 12 13 15 20 8 30 31] to range [1 2 3 4 5 6 7 8 9 10] in EXCEL or in MATLAB. Is there any function to do it? Is there any suggestion to convert this type of arbitrary range to definite range?</p>\n"},{"tags":["c#","sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13257925,"title":"Update the dataset after rows changed","body":"<p>Scenario:</p>\n\n<ol>\n<li>Excel file is read and displayed in datagrid.</li>\n<li>Values in sql server must be updated  if excel values are different.</li>\n<li>Table in Sql server don't have primary key</li>\n</ol>\n\n<p>After all these steps, when I am about to update the table, it throws the error saying \"Update requires a valid UpdateCommand when passed DataRow collection with modified rows.\" </p>\n\n<p>There is no primary key. So I need to use update command. BUt how and what would be in update command? importdata is dictionary where data from excel are stored. PLz help!!! What should I do now? I have No idea....</p>\n\n<pre><code>foreach (DataColumn column in ds.Tables[0].Columns)\n{\n    string fieldName = column.ColumnName;\n    string fieldNameValueE = string.Empty;\n    if (importdata.ContainsKey(fieldName))\n    {\n        fieldNameValueE = importdata[fieldName];\n        foreach (DataRow dr in ds.Tables[0].Rows)\n        {\n            string fieldNameValueD = dr[fieldName].ToString();\n            if (fieldNameValueD != fieldNameValueE)\n            {\n                dr[fieldName] = fieldNameValueE;\n\n            }\n        }\n\n    }\n\n}\n\nda.Update(ds);\nconnection.Close();    \n</code></pre>\n"},{"tags":["excel","vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2636,"score":0,"question_id":5710757,"title":"Automatically name a file based on cell data when saving a spreadsheet?","body":"<p>I have an .xltm template spreadsheet that I'm wondering if I can get a macro to populate the \"save as\" file name based on cell data, is this possible?</p>\n\n<p>There are over 50 people who will have this spreadsheet, it's more of a form, and we are trying to figure out a way to keep the filenames uniform. I know there is the ThisWorkbook.BeforeSave, but I'm not really having any luck there. I just need it to make a file named something like <code>$A$1 R $B$1 T $B$3.xlsx</code></p>\n\n<p>Any ideas on how to do this?</p>\n"},{"tags":["c#","excel","razor","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13012119,"title":"\"Do you want to Open or save\" not displaying","body":"<p>My Code:</p>\n\n<pre><code>    [AcceptVerbs(HttpVerbs.Get)]\n    public ActionResult Export()\n    {\n        DataTable table = ListToDataTable();\n\n        var rows = table.AsEnumerable().AsQueryable() as IEnumerable&lt;DataRow&gt;;\n        var output = CreateXlsStream(rows);\n        return File(output, \"application/vnd.ms-excel\", \"Export.xls\");\n    }\n</code></pre>\n\n<p>\"Do you want to Open or save\" not displaying. I want to display \"Do you want to Open or save\" by default after executing this \"return File(output, \"application/vnd.ms-excel\", \"Export.xls\");' line.Thanks.</p>\n"},{"tags":["excel","data","format","generate","powerpivot"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12422627,"title":"generate PowerPivot workbook","body":"<p>I would like to know if it is possible to generate a PowerPivot workbook programatically ? Is the powerPivot data format described somwhere ? I know that it's an xlsx file and when i unzip it, there is an item1.data which contains the encoded data - embedded in the workbook.</p>\n\n<p>Regardless of what data i embed in the powerpivot workbook, be it plain text, or data coming from SQL Server, the *.data file is in the same format, and i don't know if this structure is specified somewhere. </p>\n\n<p>ultimately i would like to programatically generate the excel file with embedded data, from a variety of data sources.</p>\n\n<p>thank you\nAngel</p>\n"},{"tags":["c#","asp.net","excel","file","csv"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":13244875,"title":"Generate CSV file in ASP.Net","body":"<p><br/>\nI am using the code below on an aspx page on button click event to generate csv file. This works when I do not name my file but when I try to use:\n    Response.AddHeader(\"Content-Disposition\", \"attachment;filename=myfilename.csv\");</p>\n\n<p>to name the file as myfilename.csv, the excel sheet generated is the screen shot of the web page instead of having text in it. Can someone help me with this problem.<br>\nThanks!</p>\n\n<pre><code>DataGrid dg = new DataGrid();\ndg.DataSource = GetData();\nhtmlTextWriter.WriteLine(\"&lt;b&gt;Details&lt;/b&gt;\");\n//Get the html for the control\ndg.HeaderStyle.Font.Bold = true;\ndg.HeaderStyle.BackColor = System.Drawing.Color.Gray;\ndg.DataBind();\ndg.RenderControl(htmlTextWriter);\n\n//Write the HTML back to the browser.\nResponse.Clear();\nResponse.ContentType = \"application/vnd.ms-excel\";\n//Response.AddHeader(\"Content-Disposition\", \"attachment;filename=myfilename.csv\");\n            this.EnableViewState = false;\nResponse.Write(textWriter.ToString());\nResponse.End();\n\nprivate System.Data.DataTable GetData()\n{\n        System.Data.DataTable dt = new System.Data.DataTable(\"TestTable\");\n        dt.Columns.Add(\"SSN\");\n        dt.Columns.Add(\"Employee ID\");\n        dt.Columns.Add(\"Member Last Name\");\n        dt.Columns.Add(\"Member First Name\");\n        dt.Columns.Add(\"Patient Last Name\");\n        dt.Columns.Add(\"Patient First Name\");\n        dt.Columns.Add(\"Claim No.\");\n        dt.Columns.Add(\"Service Line No.\");\n        dt.Columns.Add(\"Error Code\");\n        dt.Columns.Add(\"Error Message\");                \ndt.Rows.Add(123456789,4455,\"asdf\",\"asdf\",\"sdfg\",\"xzcv\",\"dsfgdfg123\",1234,135004,\"some    error\");            \ndt.Rows.Add(123456788,3344,\"rth\",\"ojoij\",\"poip\",\"wer\",\"aadf124\",1233,135005,\"Some Error\");\ndt.Rows.Add(123456787,2233,\"dfg\",\"sdfg\",\"vcxb\",\"cxvb\",\"UHCAL125\",1223,135006,\"another error\");\n        return dt;\n    }\n</code></pre>\n"},{"tags":["excel","vlookup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13202473,"title":"Way to overcome Excel Vlookup function limit of 256 characters","body":"<p>I have a excel array with multiple values. Some are less than 256 characters and some have a length greater than 256.</p>\n\n<p>When I tried to do a VLookup using a sample string, I can get results when it matches the rows with less than 256 characters. For rows greater that 256 characters, it returns a '#N/A'.</p>\n\n<p>Is there a way of using Vlookup or by using some other in-built function in Excel that I can overcome this limit?</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13258283,"title":"How to allow users to view data only associated with a password","body":"<p>I would like to allow access to an Excel workbook containing two spreadsheets.  The first spreadsheet called Sheet 1 would open upon opening the workbook and allow for the user to enter a passcode (which they were previously provided).  Upon entering this passcode a set of data would appear below (on the spreadsheet) which pertains to the passcode they entered.</p>\n\n<p>The second spreadsheet, Sheet 2, would be hidden to all and contain all of the pertainent information.  This spreadsheet would be set up with column A containing the passcode followed by columns B - Z containing data.</p>\n\n<p>Such as . . .</p>\n\n<pre><code>Column A - Passcode -  456\nColumn B - Name - John Smith\nColumn C - Hire Date - 01/01/12\n</code></pre>\n\n<p>as so on . . .</p>\n\n<p>So if a user entered 456 on Sheet 1.  Below this entry would appear each of the column headings from Sheet 2 along with data associated with it.</p>\n\n<p>Is this possible?  I do not write code so I am at a standstill.</p>\n"},{"tags":["excel","excel-vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256733,"title":"Merging rows in an Excel document with the same email and preserving merged row data","body":"<p>I have an excel sheet of around 50,000 records of something like this:</p>\n\n<pre><code>email   product  info   moreinfo\na@a.com   866   data   data1\nb@b.com   960   data   data1\nc@c.com   976   data   data1\nc@c.com   884   data   data1\nd@d.com   1010   data   data1\ne@e.com   834   data   data1\nf@f.com   981   data   data1\ng@g.com   935   data   data1\ng@g.com   832   data   data1\ng@g.com   934   data   data1\n</code></pre>\n\n<p>I need to convert it to something like this:</p>\n\n<pre><code>email   product   info   moreinfo\na@a.com   866   data   data1\nb@b.com   960   data   data1\nc@c.com   976,884   data   data1\nd@d.com   1010   data   data1\ne@e.com   834   data   data1\nf@f.com   981   data   data1\ng@g.com   935,832,934   data   data1\n</code></pre>\n\n<p>I need rows with duplicate emails to be merged into one and information from column B to be merged into one record for that email address. I've tried a few macros but to no avail. Can you help me? I'm a bit confused here. Thanks!</p>\n\n<p>Edit: I'm using Excel 2011 on the Mac. </p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13255490,"title":"Excel SUM Statement with a WHERE parameter?","body":"<p>I've got the below code which gets me the total value of F18 on all worksheets from \"First\" to \"Last\"</p>\n\n<pre><code>=SUM(First:Last!F18)\n</code></pre>\n\n<p>How can I amend this so it uses the below logic:</p>\n\n<p>Total of F18 in all worksheets between First &amp; Last WHERE B12 = \"Name1\"</p>\n\n<p>Name1 can appear on several worksheets</p>\n"},{"tags":["c#","asp.net","excel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13250769,"title":"Read Excel file from a set index","body":"<p>Is it possible to read a file from a set column \"eg <code>A2</code>\" and read the whole document?</p>\n\n<p>Current code:</p>\n\n<pre><code>(\"Select  * FROM [\" + excelSheet[i] + \"]\", excelConnection); \n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13255863,"title":"VBA open workbook ignoring \"missing library\" error?","body":"<p>I am currently using the following code to open workbooks and search for particular strings:</p>\n\n<pre><code>    Set workbook = Application.Workbooks.Open(Path)\n\n    Set VBProj = workbook.VBProject\n    Set oComp = VBProj.VBComponents(\"Module1\")\n\n    Set CodeMod = oComp.CodeModule\n\n    FindWhat = ToFindStr\n\n    With CodeMod\n        SL = 1\n        EL = .CountOfLines\n        SC = 1\n        EC = 255\n        Found = .Find(target:=FindWhat, StartLine:=SL, StartColumn:=SC, _\n            EndLine:=EL, EndColumn:=EC, _\n            wholeword:=True, MatchCase:=False, patternsearch:=False)\n        Do Until Found = False\n            Print #fnum1, \"found\"\n            EL = .CountOfLines\n            SC = EC + 1\n            EC = 255\n            Found = .Find(target:=FindWhat, StartLine:=SL, StartColumn:=SC, _\n                EndLine:=EL, EndColumn:=EC, _\n                wholeword:=True, MatchCase:=False, patternsearch:=False)\n        Loop\n    End With\n</code></pre>\n\n<p>The problem is there appears to be some compiler errors (missing library) when I open a couple of the spreadsheets. Is there any way I can get around this? I just need to get the CodeMod content to somewhere searchable- but the problem appears to be with opening the workbook.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13252882,"title":"How to offset 2 cells of a range in VBA?","body":"<p>I'm writing a macro that checks if a value is true, and if so takes the first cell of the row and stores it.  For example:</p>\n\n<pre>|191|c:users\\public\\test.dbf  |True |  \n|192|c:users\\public\\test2.dbf |False|  \n|193|c:users\\public\\test2.dbf |False|</pre>  \n\n<p>I want to loop through this array and when a value is True I need to store 191 and c:users\\public\\test.dbf (for this example; the actual values to store will be dependent on the row).</p>\n\n<p>Here is my code:</p>\n\n<pre><code>For Each strPath In Worksheets(\"OPTIONS\").Range(\"F2:H6\")\n    newChemin = strPath\n    If strPath &lt;&gt; True And strPath &lt;&gt; False Then Chemin = strPath\n\n    If strPath.Value = \"True\" Then\n        For Each Cell In Worksheets(\"OPTIONS\").Range(\"F2:F6\")\n            If Cell = Chemin Then\n                strChemin = Chemin\n                Exit For\n            End If\n        Next Cell\n\n        Set wsSheet1 = wbBook.Worksheets(\"DB\" &amp; strChemin)        \n        If strPath.Value = \"TRUE\" Then\n            If FichierExiste(Chemin) Then\n                Line = Line + 1\n            Else\n                Chemin = Worksheets(\"OPTIONS\").Cells(7, 7).Value &amp; \"\\\" &amp; strChemin &amp; \"\\ancretbd.mdb\"\n                If FichierExiste(Chemin) Then\n                    '* Appel de la Method mod_Importation\n                    Call Importation_Totale\n                Else\n                    MsgBox \"Desolé, le fichié demandé n'existe pas !\"\n                End If\n            End If\n        End If\n    End If\nNext strPath\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":36,"score":-3,"question_id":13253592,"title":"Copy only cells with interior index color = 6","body":"<p>I need to copy the cells of a column that contains the interior <strong>color = 6</strong> (vbyellow), and paste them into a new sheet and save this new leaf in <strong>txt</strong> format in <strong>c:\\code.txt</strong>. Can anyone help me with this?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13242707,"title":"Accessing custom property's value gives 'Out of Memory' error when value is null","body":"<p>I'm trying to create a custom property in an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> sheet, then retrieve its value.  This is fine when I don't use an empty string, i.e. <code>\"\"</code>.  When I use the empty string, I get this error:</p>\n\n<pre><code>Run-time error '7':\nOut of memory\n</code></pre>\n\n<p>Here's the code I'm using:</p>\n\n<pre><code>Sub proptest()\n\nDim cprop As CustomProperty\nDim sht As Worksheet\n\nSet sht = ThisWorkbook.Sheets(\"control\")\nsht.CustomProperties.Add \"path\", \"\"\n\nFor Each cprop In ThisWorkbook.Sheets(\"control\").CustomProperties\n    If cprop.Name = \"path\" Then\n        Debug.Print cprop.Value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>The code fails at <code>Debug.Print cprop.value</code>.  Shouldn't I be able to set the property to <code>\"\"</code> initially?</p>\n"},{"tags":["excel","drupal-7","phpexcel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13255929,"title":"Sheetnode Formulas","body":"<p>I am currently using a module named 'Sheetnode' for Drupal 7. It's a great module, however it seems that the excel ROUNDUP function is not working or supported. The excel data I import (through PHPEXCEL) is in .xlsx format containing multiple calculations. However some formulas are incorrect causing wrong totals and rounding up values. All figures on the spreadsheet must be precise. Has anyone had experience with this module? And possible ways around this?</p>\n\n<p>Many thanks</p>\n"},{"tags":["osx","excel","webserver","development-environment","rdbms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":21,"score":-4,"question_id":13255448,"title":"pls recommend free development environments for mac app + db + excel","body":"<p>I was a programmer on Windows world, using IIS, C#, MicroSoft SQL, Excel. \nThings are simple when I need make either a desktop application or a web one. SQL - Excel importing/exporting is also easy.</p>\n\n<p>Now, I'm required to do a simple demo app on Mac. Could you please recommend me some <strong>free</strong> development platforms to me?</p>\n\n<p>The task includes</p>\n\n<ol>\n<li><p>importing data from a Microsoft Excel (.xlsx) file to a database;</p>\n\n<ul>\n<li>I suppose I can use mysql as database? </li>\n<li>can it import/export with\nMicrosoft Excel (.xlsx) files? Viewing/modifying excel files can\nbe done by Open Office, this is not a problem.</li>\n</ul></li>\n<li><p>querying data;</p>\n\n<ul>\n<li>in windows world data query is via odbc or sql server native client ole db, dotnet framework has library available.  in mac, shall i also set up such?</li>\n</ul></li>\n<li><p>display it on a desktop app or a web one.</p>\n\n<ul>\n<li>in windows world there are visual studio express edition, free to use, and C# is the language i'm familiar with; for web apps, IIS will be the WAS (Web Application Server).</li>\n<li>in mac world, what will be the development language and what's the development platform? and what will be the WAS?</li>\n</ul></li>\n</ol>\n\n<p>It would be even better if there is a \"hello world\" sampel to download and mimic... </p>\n"},{"tags":["regex","excel","vba","macros","dns"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13229089,"title":"Clean up domain list in Excel - regex / macros?","body":"<p>I have a huge spreadsheet of domains that I need to clean up as follows:</p>\n\n<ol>\n<li>Remove all <code>http://</code> (simple replace all - \"http://\" with \"\")</li>\n<li>Remove any <code>www.</code> (simple replace all - \"www.\" with \"\")</li>\n<li>Delete any sub-domains (delete the actual row completely, not just the subdomain from the url)</li>\n<li>Remove anything after the domain extension (i.e. <code>website.com/blah/blahbah/</code> becomes just <code>website.com</code> (simple replace all - <code>\"/*\"</code> with <code>\"\"</code>, then replace all <code>\"/\"</code> with <code>\"\"</code>)</li>\n</ol>\n\n<p>So what I'm left with is just a spreadsheet of clean domains like <code>\"website.com\"</code>. </p>\n\n<p>I think I've got 1, 2 and 4 sorted (as above), <strong>but I'm really struggling with 3</strong>.</p>\n\n<p>Any ideas? Can I do this with <a href=\"/questions/tagged/regexp\" class=\"post-tag\" title=\"show questions tagged 'regexp'\" rel=\"tag\">regexp</a> / <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a>, and actually delete the row completely? </p>\n\n<p><strong>Sample data:</strong></p>\n\n<p><a href=\"http://www.scholastic.com/kids/stacks/games/\" rel=\"nofollow\">http://www.scholastic.com/kids/stacks/games/</a><br />\n<a href=\"http://imgworld.teamworkonline.com/\" rel=\"nofollow\">http://imgworld.teamworkonline.com/</a><br />\n<a href=\"http://topfreegraphics.com/\" rel=\"nofollow\">http://topfreegraphics.com/</a><br />\n<a href=\"http://www.workcircle.co.uk/\" rel=\"nofollow\">http://www.workcircle.co.uk/</a><br />\n<a href=\"http://www.healthycanadians.gc.ca/index-eng.php\" rel=\"nofollow\">http://www.healthycanadians.gc.ca/index-eng.php</a><br />\n<a href=\"http://gsociology.icaap.org/methods/soft.html\" rel=\"nofollow\">http://gsociology.icaap.org/methods/soft.html</a><br /></p>\n\n<p><strong>Post 1, 2 and 4 would leave me with:</strong></p>\n\n<p>scholastic.com<br />\nimgworld.teamworkonline.com<br />\ntopfreegraphics.com<br />\nworkcircle.co.uk<br />\nhealthycanadians.gc.ca<br />\ngsociology.icaap.org<br /></p>\n\n<p>It's those pesky sub-domains I need to just delete completely, just delete the row. I've realised I can't just search for 2 x \".\", because obviously plenty of domain extensions (i.e <code>.co.uk</code>) include that. </p>\n\n<p>Any help appreciated.</p>\n"},{"tags":["java","excel","pdf","file-upload","ms-word"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13248466,"title":"Validation of file with thier file extensions","body":"<p>I get files from queues in java. They may be of following formats.</p>\n\n<ol>\n<li>Docx</li>\n<li>pdf</li>\n<li>Doc</li>\n<li>Xls</li>\n<li>xlsx</li>\n<li>txt</li>\n<li>rtf</li>\n</ol>\n\n<p>I want to validate after getting their extensions whether they are actually files of these types.</p>\n\n<p>for example,  I got a file and checked that it has extension .xls. afterwards, I want to check whether it is actually .xls file or someone uploaded file of some other format  after changing its extension. </p>\n\n<p>Thanks in advance</p>\n\n<p>EDIT: well, let's check file's mime type by actually checking its content not by its extension. how it can be done .?</p>\n"},{"tags":["excel","excel-vba","internationalization","excel-formula"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13247771,"title":"Excel Macro, inserting internationally valid formula during run-time","body":"<p>I've got an Excel spreadsheet, with a Macro, that inserts a conditional formatting, like this:</p>\n\n<pre><code>Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=UND($A3=\"\"\" &amp; lastName &amp; \"\"\"; $B3=\"\"\" &amp; firstName &amp; \"\"\")\"\n</code></pre>\n\n<p>As you can see, I've used the German formula for \"AND\" (i.e. \"UND\"), and obviously, this code doesn't work as soon as I use it on a French or English version of Excel.\nUsually formulas are localized automatically, but how can I insert a formula during run-time that will work on ALL versions?</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13253004,"title":"Check if any date within a range is within 1 month of todays date","body":"<p>I've got a column full of dates.  How can I check that column to find which date is within a month of todays date, and then return it?</p>\n\n<p>If there is no date within a month, just return blank</p>\n\n<p>Lets say my dates are:</p>\n\n<pre><code>01-Jan-12   \n01-Apr-12   \n01-Jul-12   \n01-Oct-12   \n01-Jan-13\n</code></pre>\n\n<p>The code im using is below. A:A is the range of the dates above</p>\n\n<pre><code>=MIN(IF(A:A&gt;TODAY(),A:A))\n</code></pre>\n\n<p>The issue im having is that if I use the above, it returns 01/01/12 and not 01/01/13.  Also, if I change the dates so the next date is December 1st 2012, it still returns 01/01/12</p>\n"},{"tags":["c#","excel","vba"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13250744,"title":"Access the VBA of a spreadsheet from within another sheet's VBA (or C# console app)?","body":"<p>I have a batch of spreadsheets with lots of VBA code and I wanted to write something which could check for function dependencies. I am changing code and need to find out which files depend on functions I am modifying.</p>\n\n<p>Is there a way to access the VBA modules/functions of spreadsheet X either from a C# console application, or from VBA in spreadsheet Y (just a different spreadsheet to X)?</p>\n\n<p>I want to access the VBA as text/anything parsable.</p>\n"},{"tags":["c#","excel","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13253999,"title":"Getting data from Excel sheet","body":"<p>I'm trying to write an Excel add-in using Microsoft Visual C# and VSTO. What I'm trying to do is read all of the data in the Excel sheet into a list of some sort so that I can process the list and write the list back to the sheet.</p>\n\n<p>So far I have been unable to get any of the examples of the MSDN site to work.</p>\n\n<ul>\n<li>Environment  = Visual Studio 2010</li>\n<li>Language     = Visual C# </li>\n<li>Project type = Visual C# Excel 2007 Add-In</li>\n</ul>\n"},{"tags":["excel","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13253022,"title":"Macro - Add row, auto fill text and formulas with relative OFFSSET, Sheet reference functions","body":"<p>I have very big problem and i can't find answer for it. Maybe You can halp me.</p>\n\n<ol>\n<li><p>In Sheet \"Intro\" I have row (5), in wich are formulas: \n(i) <code>C5(='Sheet1'!$A$1)</code>;\n(ii) <code>I5(=OFFSET('Sheet1'!$A$1;17;1;1;))</code>; \n(iii) In this row also is number of my tables line, i. e <code>B5(=1)</code>. This number \"1\" is also a hyperlink to Sheet1.enter code here</p></li>\n<li><p>I have Macro, which every time automaticaly insert new row after last filled row, i. e. when i have filled 5 row and run my Macro, it inserts line 6. Therefore necessary to automatically fill this row with my formulas, that I mentioned above.</p></li>\n</ol>\n\n<p>More specifically, the new row should be filled in like this:\nWhen new row is 6:\n(i) <code>C6(='Sheet2'!$A$1)</code>;\n(ii) <code>I6(=OFFSET('Sheet2'!$A$1;17;1;1;))</code>; \n(iii) <code>B6(=2)</code>. This number \"2\" is also a hyperlink to Sheet2.\nWhen new row is 7:\n(i) <code>C7(='Sheet3'!$A$1)</code>;\n(ii) <code>I7(=OFFSET('Sheet3'!$A$1;17;1;1;))</code>; \n(iii) <code>B7(=3)</code>. This number \"3\" is also a hyperlink to Sheet3.\nWhen new row is 8:\n(i) <code>C8(='Sheet4'!$A$1)</code>;\n(ii) <code>I8(=OFFSET('Sheet4'!$A$1;17;1;1;))</code>; \n(iii) <code>B8(=4)</code>. This number \"4\" is also a hyperlink to Sheet4.</p>\n\n<p>And......</p>\n\n<p>Maybe You can help me? </p>\n\n<p>In advance thank you sincerely.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13251953,"title":"Excel: output dynamicly","body":"<p>If the value of cell is 6 for example, how to output dynamically as followed in excel:</p>\n\n<pre><code>6\nA1~A2\nA2~A3\nA3~A4\nA4~A5\nA5~A6\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":13151698,"title":"Excel extract and average values from column","body":"<p>Is it possible if I have one column with names and another with pay. i.e.</p>\n\n<pre>John     $120  \nJohn     $100  \nSally    $90  \nSally    $100  \nSally    $80</pre>  \n\n<p>to extract the values from column 2 for both John and Sally and then average them and place the results into two cells in another column? Could I use spreadsheet commands or do I need VBA to do this automatically. </p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13251534,"title":"Hide/Unhide Last Written Row","body":"<p>I am new in VBA. I'd like to hide unhide all the rows from any row to the end of the sheet.\nThe problem I have it is I dont know how to program to hide from the last written row.\nI use the next function to know the last cell written, but I dont know where to put in the Hide Function.</p>\n\n<pre><code>last = Range(\"A100000\").End(xlUp).Row\n</code></pre>\n\n<p>thanks a lot, any help will be grateful.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13247592,"title":"Excel Find the text between the last two underscores","body":"<p>I need an excel formula to find the text between the last two underscores in an excel cell:</p>\n\n<p>i.e.</p>\n\n<blockquote>\n  <p><code>AAA_BBB_CCC_DDDD_E =&gt; DDDD<br>\n  AAA_BBB_CCC_DDD_EEE_E =&gt; EEE<br>\n  AAA_BBB_CCC_DDD_EEE_F_ =&gt; F<br>\n  AAA_BBB_CCC_DDD_EE_GGGGGGGGGG =&gt; EE<br>\n  AAA_BBB_CCC_DDD_EEE_FFF_GGGGGGGGGGGG_H =&gt; GGGGGGGGGGGG</code> </p>\n</blockquote>\n\n<p>The formula i got is based on the last index of:\n<a href=\"http://geekswithblogs.net/prash/archive/2011/11/02/excel-last-index-of.aspx\" rel=\"nofollow\">EXCEL LAST INDEX OF</a></p>\n\n<blockquote>\n  <p><code>=RIGHT(LEFT(A2,SEARCH(\"@\",SUBSTITUTE(A2,\"_\",\"@\",LEN(A2)-LEN(SUBSTITUTE(A2,\"_\",\"\"))))-1),LEN(LEFT(A2,SEARCH(\"@\",SUBSTITUTE(A2,\"_\",\"@\",LEN(A2)-LEN(SUBSTITUTE(A2,\"_\",\"\"))))-1))-SEARCH(\"@\",SUBSTITUTE(LEFT(A2,SEARCH(\"@\",SUBSTITUTE(A2,\"_\",\"@\",LEN(A2)-LEN(SUBSTITUTE(A2,\"_\",\"\"))))-1),\"_\",\"@\",LEN(LEFT(A2,SEARCH(\"@\",SUBSTITUTE(A2,\"_\",\"@\",LEN(A2)-LEN(SUBSTITUTE(A2,\"_\",\"\"))))-1))-LEN(SUBSTITUTE(LEFT(A2,SEARCH(\"@\",SUBSTITUTE(A2,\"_\",\"@\",LEN(A2)-LEN(SUBSTITUTE(A2,\"_\",\"\"))))-1),\"_\",\"\")))))</code></p>\n</blockquote>\n\n<p>I need to make this less complicated, any ideas?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13252451,"title":"List of workbook VBA functions?","body":"<p>I have managed to get a list of the sheets and macros of a workbook using VBA Extensibility:</p>\n\n<pre><code> For Each oComp In ThisWorkbook.VBProject.VBComponents\n      Debug.Print oComp.Name\n    Next oComp\n</code></pre>\n\n<p>Is there a way to get a list of the functions declared within the module and even better, a list of functions referred to within the code/the code itself?</p>\n\n<p>Eventually this is to open other workbooks and list their functions/dependent functions.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13245996,"title":"Pass row number as variable in excel sheet","body":"<p>Suppose I have: </p>\n\n<ol>\n<li>a value of 5 in <code>B1</code></li>\n<li>I want to pass the number (5) in <code>B1</code> as a row variable, which will be read in conjunction with column <code>A</code> into another cell (say <code>C1</code>) as \"=A(B1)\" i.e. \"=A5\"</li>\n</ol>\n\n<p>How would I do this?</p>\n"},{"tags":["excel","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13234009,"title":"Efficient method of deleting rows in a spreadsheet","body":"<p>Is there better method of deleting rows in an excel spreadsheet than than what I currently use?</p>\n\n<p>On a spreadsheet I run a macro that deletes a row if a figure in a particular cell is '0'. </p>\n\n<pre><code>Public Sub deleteRowsIfZero(colDelete As Integer)\nDim r As Long\nApplication.ScreenUpdating = False\n\nFor r = Cells(Rows.Count, colDelete).End(xlUp).Row To 1 Step -1\n    If Cells(r, colDelete).Value = \"0\" Then Rows(r).Delete\nNext r\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This works, but with a spreadsheet of 700+ rows it can be quite slow. Is there a more efficient method to do this?</p>\n\n<p>Thanks in advance for any advice.</p>\n\n<p>Cheers</p>\n\n<p>Noel</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13252191,"title":"Sum of duplicate named range across multiple sheets?","body":"<p>Ive got X amount of sheets in my excel document.  On all sheets, there is a named range of:</p>\n\n<blockquote>\n  <p>TotalSupportCost</p>\n</blockquote>\n\n<p>On a master sheet, how can I do something like:</p>\n\n<pre><code>Total value of all TotalSupportCost across every worksheet\n</code></pre>\n\n<p>This way, whenever a sheet is duplicated the total will dynamically increase</p>\n"},{"tags":["java","excel","jxl","formulas"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":391,"score":1,"question_id":6459493,"title":"JXL Named Area Formulas Display the Incorrect Value","body":"<p>I am using JXL to write an Excel report. I need to use named areas for the report, and have formulas based off of them. However, when the Excel file loads, the values displayed are incorrect. If I click on the cell, and hit enter, the value changes and is correct. I can't figure out how to make the value appear correctly on load. Does anyone know a way to force Excel to re-evaluate, or to provide a default value for the Formula?</p>\n\n<p>Below is a simplified version of my code:</p>\n\n<pre><code>excelWorkbook.addNameArea(\"NamedArea\", excelSheet, column1, row1, column2, row2);\nFormula formula = new Formula(columnNumber, rowNumber, \"COUNT(NamedArea)\");\nexcelSheet.addCell(formula);\n</code></pre>\n"},{"tags":[".net","excel"],"answer_count":19,"favorite_count":17,"up_vote_count":22,"down_vote_count":1,"view_count":18856,"score":21,"question_id":170652,"title":"What's the best .NET library for parsing and generating Excel spreadsheets?","body":"<p>Open-source or not. What's your experience using it? How's the learning curve?</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13243178,"title":"extract from excel table based on another cells value","body":"<p>I have a table, with a list of <strong>temperatures on the left side</strong> and a list of <strong>pressures altitudes on the top</strong>, then it has a value that is based on those two things in the table. </p>\n\n<p>How do I make a formula that looks at another two cells that have the temperature and another that has the pressure altitudes, then looks at the table and finds where those two values meet on the table and gives me what is in the cell where those two meet?</p>\n\n<p>For example, </p>\n\n<p>I have two cells, one with temperature value 10 and another cell with pressure altitude value 1000, then looks on the table to find the cell where temp 10 and press alt 1000 meet and gives me the value in a different cell.</p>\n"},{"tags":["asp.net","vb.net","excel"],"answer_count":25,"favorite_count":68,"up_vote_count":66,"down_vote_count":1,"view_count":30076,"score":65,"question_id":150339,"title":"Generating an Excel file in ASP.NET","body":"<p>I am about to add a section to an ASP.NET app (VB.NET codebehind) that will allow a user to get data returned to them as an Excel file, which I will generate based on database data.  While there are several ways of doing this, each has its own drawbacks.  How would <em>you</em> return the data?  I'm looking for something that's as clean and straightforward as possible.</p>\n"},{"tags":["excel","dll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":9,"score":-2,"question_id":13249998,"title":"DLL reads cell values from the calling Excel file?","body":"<p>I need suggestions or any sample codes that would help me to achieve the following objective.</p>\n\n<p>I am calling a DLL from an excel. Once the DLL is invoke, I want to access some cell values from the calling Excel file. </p>\n\n<p>For Example, I called a DLL 'xyz' and it is reading value from cells, 1,2 and 3 from Sheet1 , cells 4,5 from Sheet 2 and continuing with the processing. </p>\n"},{"tags":["c#","sql-server-2008","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13249804,"title":"import the updated excel value to database","body":"<p>I have a large amount of data in a excel sheet which has about 2000 rows. I have imported the table in sql server with no error. \nI have to modify the excel now and update the same changes in the database also. \nI cant delete the table and import again since i have large amount of data and have extra columns added to it. </p>\n\n<p>So Please help me how to update the new values along with the existing values. I use C#.Net. </p>\n\n<p>Thanks</p>\n"},{"tags":["excel","excel-2007","excel-formula","excel-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13249315,"title":"vlookup for unsorted data does not work","body":"<p>i have a table as following, i want to use vlookup but it does not work.\n<img src=\"http://i.stack.imgur.com/9Uruf.jpg\" alt=\"enter image description here\"></p>\n\n<p>the format cell of column b and c is text. i wany to find the text in column B from column C.\nmy formula is:</p>\n\n<pre><code>=VLOOKUP(F5,B:C,1,FALSE)\nf5=مركز بهداشت دانشگاه تهران\n</code></pre>\n\n<p>but it returns: #n/a\n when i want to find column C from column B, it works well.\nplease help me. what should i do? is there any mismatch with arabic?</p>\n"},{"tags":["c#","excel","csv","interop","workbook"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":844,"score":0,"question_id":9062823,"title":"Exception When Opening Excel File in C# Using Interop","body":"<p>I have a program running on a server which downloads an .xls file from a website every day, opens it then converts it to a .csv to be able to parse it correctly and add to a database.</p>\n\n<p>When I run it on my local PC everything works fine and it works most of the time on the server as well, but maybe once or twice a week I get this exception:</p>\n\n<p>Exception occurred: System.Runtime.InteropServices.COMException (0x800A03EC): Exception from HRESULT: 0x800A03EC\n   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)</p>\n\n<p>Here's a code snippet:</p>\n\n<pre><code> Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();\n            Microsoft.Office.Interop.Excel.Workbook wbWorkbook = app.Workbooks.Open(_dir + _fileNameTrim + \".xls\", Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n            wbWorkbook.SaveAs(_dir + _fileNameTrim + \".csv\", Microsoft.Office.Interop.Excel.XlFileFormat.xlCSVWindows, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n            wbWorkbook.Close(false, \"\", true);\n</code></pre>\n\n<p>I've read many things online, a lot of solutions mention security settings but I don't think this is the case with me, otherwise it wouldnt work at all. People have also mentioned the file being corrupt. I'm really not sure. Any help would be much appreciated.</p>\n\n<p>UPDATE:</p>\n\n<p>Excel is installed on the server and the exception occurs when trying to open the file.</p>\n"},{"tags":["regex","excel","vba","excel-vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":531,"score":3,"question_id":10789948,"title":"Remove non-numeric characters from Excel","body":"<ol>\n<li>I have a 1500 row excel file. </li>\n<li>In the first column I have characters mixed up with numbers (every row is different).</li>\n<li>I would like to leave only the numbers and delete the alpha characters.</li>\n</ol>\n\n<p>For example in <code>A1</code> I have   </p>\n\n<blockquote>\n  <p><strong>f90f5j49,35.48</strong>  </p>\n</blockquote>\n\n<p>and after I delete the alpha characters it should be  </p>\n\n<blockquote>\n  <p><strong>905493548</strong></p>\n</blockquote>\n\n<p>What is the best way to do this?</p>\n\n<p>I did find this <a href=\"http://www.youtube.com/watch?feature=player_embedded&amp;v=zw3l_p37xYo\" rel=\"nofollow\">youtube solution</a></p>\n\n<p>Thanks!</p>\n"},{"tags":["excel","ms-access","vba","vbscript","access-vba"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3117,"score":2,"question_id":4036772,"title":"How to export all tables from an Access Database into Excel - A sheet for each table","body":"<p>I have an Access database with ~30 tables.</p>\n\n<p>How can I export all 30 tables into separate sheets in an Excel workbook?</p>\n\n<p>I'm hoping to find some VBA/VBS code which I can run from within Access to accomplish this task.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["excel","sqlite3","odbc"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":13068022,"title":"Is it possible to embedded a Sqlite database into an excel 2007 file (zip archive)","body":"<p>I'm working on an excel application that requires a database back end. My preference is to use SQLite 3 and to make this as seamless and portable as possible for the end user. </p>\n\n<p>Recently I have learned that an Excel 2007 file is simply a zip archive with a xlsm extension.  My question is this, can I store my back-end SQLite 3 database in the Zip archive and use ODBC to interact with the database. If so, can anyone point me to some background information, articles, guidance on achieving this objective.  Are there any downsides to this approach or a better alternative I should know about. </p>\n\n<p>Thanks for your input. </p>\n"},{"tags":["c#",".net","excel","csv","pdf-generation"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":78,"score":0,"question_id":13239913,"title":"Free for commercial use tools for .NET that can convert csv to excel and export excel to pdf?","body":"<p>I've got a report being exported as <code>.csv</code>, and I need to offer two more formats of the report - <code>.xlsx</code> and <code>.pdf</code>, with added headers/footers/images.</p>\n\n<p>Originally, my plan was to use <code>Microsoft.Office.Interop.Excel</code> to open the <code>.csv</code>, modify it with <a href=\"http://epplus.codeplex.com/\" rel=\"nofollow\"><code>EPPlus</code></a> to add the header/footer/logo, and save it as an <code>.xlsx</code> file, then export it as a <code>.pdf</code> but the application is running within IIS, and <strong>automating office server-side is not recommended or supported</strong>.</p>\n\n<p><strong>1)</strong> Are there any free for commercial use tools for opening .CSV files and saving them as .XLSX?</p>\n\n<ul>\n<li><strong>EPPlus is the best option</strong> for this, as I can open CSV files, edit them, and save as Excel, which meets my requirement.</li>\n</ul>\n\n<p><strong>2)</strong> Are there any free for commercial use tools for exporting an <strong>Excel .XLSX file to .PDF</strong>?</p>\n\n<p><strong>3)</strong> Is there a tool that can do both?</p>\n"},{"tags":["excel","graph","epplus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12686552,"title":"EPPlus graph in separate sheet","body":"<p>How do I create a graph as a separate worksheet rather than as a drawing in an existing worksheet using EPPLus?</p>\n"},{"tags":[".net","winforms","excel","clipboard","rtf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13089299,"title":"How to copy RTF text to clipboard for use in excel","body":"<p>Is it possible to copy a rtf string to the clipboard for excel. The formatting should be preserved as much as possible (e.g. text-color).</p>\n\n<p>The following .Net code is used to fill the clipboard</p>\n\n<pre><code>var dataObject = new DataObject();\ndataObject.SetData(DataFormats.Rtf, rtf);\nClipboard.SetDataObject(data_object);\n</code></pre>\n\n<ol>\n<li>Excel refuses the rtf clipboard content</li>\n<li>MS Word accepts the rtf content.</li>\n<li>When i paste into MSWord and copy from MSWord into Excel it works.</li>\n</ol>\n\n<p>What's the best way to convert the rtf to a format that excel accepts ?</p>\n\n<p>Remarks:\n  As @KreepN has suggested, System.Windows.Documents.TextRange can be used to convert RTF to HTML and vice versa. HTML is recognized by Excel.</p>\n"},{"tags":["excel","vba","run-time"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2512,"score":0,"question_id":3100952,"title":"What causes MS VB Run-time Error -2147417848 (80010108) in Excel Macro","body":"<p>I have a macro which runs fine on my machine but when I try to run it on another machine it gives the following error.</p>\n\n<p>Microsoft Visual Basic</p>\n\n<p>Run-time Error -2147417848 (80010108)<br>\nAutomation Error<br>\nThe Object invoked has disconnected from its clients.</p>\n"},{"tags":["c#",".net","excel","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13245252,"title":"Get Range in Excel 2007","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13231608/excel-data-coloring-via-oledb\">Excel data coloring via OLEDB</a>  </p>\n</blockquote>\n\n\n\n<p>Pls find the below coding</p>\n\n<pre><code>OleDbCommand cmd = new OleDbCommand(\"Select * from [\" + txtsheet.Text + \"] WHERE [ASSET    NUM] = \" + asset + \"\", con);\n OleDbDataReader rdr = cmd.ExecuteReader();\n OleDbDataAdapter da = new OleDbDataAdapter(cmd);\n int x = cmd.ExecuteNonQuery();\n</code></pre>\n\n<p>after this i need to get the range of the selected cells in excel</p>\n\n<p>please help me for this with the coding</p>\n\n<p>thanks in advance</p>\n\n<p>Regards</p>\n\n<p>Mahendran</p>\n"},{"tags":["c#","visual-studio","excel","vba","vsto"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13244580,"title":"Check whether whole sheet is selected or not?","body":"<p>How to check whether user has selected whole excel worksheet or not?.\nI have tried to use following.</p>\n\n<pre><code>selection.cells.count\n</code></pre>\n\n<p>but it gives a out of present range exception.</p>\n\n<p>is there any way to do the same?</p>\n"},{"tags":["c#",".net","excel","pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13244674,"title":"PDF to excel conversion .net library","body":"<p>I am evaluating option for any open source library integration or commercial library which i can integrate in my application so that I can generate Excel document from my pdf.</p>\n\n<p>I have checked pdfsharp and itextsharp but doesn't find any working sample to do it.  In commercial i have checked investintech solution <a href=\"http://www.investintech.com/downloads/developer/developertools/pdftoexcel/\" rel=\"nofollow\">Link</a> but some pdf failed to convert to excel.</p>\n\n<p>Kindly help me in selecting the best available option\nthanks</p>\n"},{"tags":["c#","excel","process","close"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":113,"score":0,"question_id":12530303,"title":"Close EXCEL application process after data has been fetched","body":"<p>I am trying to get the Columns data form an Excel file in lists by this way :</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n        {\n            Excel.Application xlApp = new Excel.Application();\n            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(@\"D:/test.xlsx\");\n            Excel.Worksheet xlWorksheet = xlWorkbook.Sheets[1];\n            Excel.Range xlRange = xlWorksheet.UsedRange;\n\n            int rowCount = xlRange.Rows.Count;\n            int colCount = xlRange.Columns.Count;\n\n            List&lt;string&gt; FirstColumnValues = new List&lt;string&gt;();\n            List&lt;string&gt; SecondColumnValues = new List&lt;string&gt;();\n\n            for (int row=1; row &lt;= rowCount; row++)\n            {\n                for (int col = 1; col &lt;= colCount; col++)\n                {\n                    switch (col)\n                    {\n                        case 1:\n                            FirstColumnValues.Add(xlRange.Cells[row, col].Value2.ToString());\n                            break;\n                        case 2:\n                            SecondColumnValues.Add(xlRange.Cells[row, col].Value2.ToString());\n                            break;\n                    }\n                }\n            }\n\n            if (FirstColumnValues.Count != 0 &amp;&amp; SecondColumnValues.Count != 0)\n            {\n                xlWorkbook.Close();\n                xlApp.Quit();\n                MessageBox.Show(\"Completed\");\n                Marshal.ReleaseComObject(xlRange);\n                Marshal.ReleaseComObject(xlWorksheet);\n                Marshal.ReleaseComObject(xlWorkbook);\n                Marshal.ReleaseComObject(xlApp);\n                xlApp = null;\n            }\n        }\n</code></pre>\n\n<p>The problem is, that the process <code>EXCEL.EXE</code> is not closing even I have tried all the things to close it properly. I know there are many questions posted here about closing excel process properly. But I am not a professional and I have tried almost everything what I can do. \nStill no luck.</p>\n\n<p>So, Can anybody please tell me what is wrong with this code? And how the process can be closed once when all the data is stored in the lists?</p>\n"},{"tags":["c#","excel","epplus"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":687,"score":1,"question_id":7639180,"title":"How to create a link inside a cell using EPPlus","body":"<p>I am trying to figure out how to write a Hyperlink inside a cell using EPPlus instead of the cell containing the link text. I need it to be recognized as a link and be clickable.</p>\n\n<p>Any help is appreciated.</p>\n"},{"tags":["excel","vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13238009,"title":"RC Notation, add new condition","body":"<p>I need to add a condition to the already existing criteria:</p>\n\n<p>The existing Criteria is: Count the rows where the value in a column is either \"Yes\" or \"MayBe\".</p>\n\n<p>Now I would like to add another condition:Check if in the same 'Report' tab, but a different column, the value is \"Europe\"</p>\n\n<p>Essentially, I would like to count how many rows in Column 5 have the answer \"Yes\" or \"MayBe\" WHEN the Continent is \"Europe\"</p>\n\n<pre><code>Range(\"B2\").Select\nActiveCell.FormulaR1C1 = _\n\"=SUM(COUNTIF('Report'!R[1]C[5]:R[2498]C[5],\"\"Yes\"\"),COUNTIF('Report'!R[1]C[5]:R[2498]C[5],\"\"MayBe\"\"))\"\n</code></pre>\n"},{"tags":["excel","matlab","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13233851,"title":"Changing Excel input sheet each iteration (matlab)","body":"<p>I have an input that changes Excel sheet each time. Instead of manually changing the inputs, could I do something like the following:</p>\n\n<pre><code>n=3\nfor i=1\nData = xlsread('TestInput1.xlsx','B2:B9',\"i\");\nData\nend\n</code></pre>\n\n<p>Since the last value in xlsread is a string, is this possible?</p>\n"},{"tags":["excel","vba","formatting"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13240912,"title":"Colour an entire row based on the contents of one of its cells","body":"<p>I'm trying to color a spreadsheet based on the results given in one of it's columns. I'm using the following code:</p>\n\n<pre><code>With newSheet.Range(\"B:B\")\n    .FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, \"CORRECT\")\n    .FormatConditions(1).Interior.ColorIndex = 4\n\n    .FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, \"INCORRECT\")\n    .FormatConditions(2).Interior.ColorIndex = 3\nEnd With\n</code></pre>\n\n<p>Unfortunately this only colors the cell containing \"CORRECT\" or \"INCORRECT\". I'd like it to extend to the row they are in (for example, if B12 contains \"CORRECT\", I want A12:G12 to all be coloured green). It was suggested that I try using an expression and so I tried the following code:</p>\n\n<pre><code>.FormatConditions.Add(Type:=XlFormatConditionType.xlExpression, Formula1:=\"=B\" &amp; row &amp; \"= \"\"CORRECT\"\")\")\n.FormatConditions(1).Interior.ColorIndex = 4\n</code></pre>\n\n<p>This however, returns an E_INVALIDARG exception. I'd appreciate any tips on how to go about fixing this. I should also note that looping through every row and checking one at a time is not really an option, as there are many thousands of lines.</p>\n"},{"tags":["php","excel","import"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":36,"score":-2,"question_id":13231889,"title":"How to load the values from Excel to a table using PHP","body":"<p>Is there any way to load the values from MS Excel to a database table using PHP?</p>\n"},{"tags":["excel","vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":13199145,"title":"Copy rows from one table to another without creating duplicates","body":"<p>I have an Excel workbook that has a master sheet that keeps track of items and their current location, and another sheet that keeps track of past locations or where an item has been. Currently when a record is changed in the master sheet, the row is manually copied and pasted into the 2nd sheet. I would like to create a macro that would find items in the master sheet that are not in the 2nd sheet and copy them to the 2nd sheet when records change.</p>\n\n<p>Below is a sample macro I found and modified that is close, but it copies and pastes <em>all</em> rows instead of the new or different ones. The rows would only need to be compared on columns A, B, and D.</p>\n\n<pre><code>Public Sub Sample()\nDim shM As Worksheet, sh2 As Worksheet\nDim shMData As Variant\nDim sh2DataA As Variant\nDim sh2Data As Variant\nDim iM As Long, os2 As Long, i2 As Variant\nDim DoSearch As Boolean\n\nSet shM = Sheets(1)\nSet sh2 = Sheets(2)\n\nWith shM\n    shMData = .Range(.[A1], .Cells(.Rows.Count, 1).End(xlUp)).Resize(, 4)\nEnd With\n\nDoSearch = False\nFor iM = 2 To UBound(shMData, 1)\n    With sh2\n        sh2DataA = .Range(.[A1], .Cells(.Rows.Count, 1).End(xlUp)).Resize(, 1)\n        sh2Data = .Range(.[A1], .Cells(.Rows.Count, 1).End(xlUp)).Resize(, 4)\n    End With\n    os2 = 0\n    Do\n        If UBound(shMData, 1) &gt; 1 Then\n            i2 = Application.Match(shMData(iM, 1), sh2DataA, 0)\n\n        Else\n            If shMData(iM, 1) = sh2DataA Then\n                i2 = 1\n            Else\n                i2 = CVErr(xlErrNA)\n            End If\n\n        End If\n\n        If Not IsError(i2) Then\n\n                If (shMData(iM, 2) = sh2Data(i2, 2)) And (shMData(iM, 4) = sh2Data(i2, 4)) Then\n                MsgBox \"Match found Master = \" &amp; iM &amp; \", sheet2 = \" &amp; i2 + os2\n\n                Else\n\n                    shM.Activate\n                    shM.Range(Cells(iM, 1), Cells(iM, 7)).Select\n                    Selection.Copy\n\n                    sh2.Select\n                    FinalRow = Range(\"A65536\").End(xlUp).Row\n                    NextRow = Range(\"A65536\").End(xlUp).Row + 1\n                    Range(\"A\" &amp; NextRow).Select\n                    ActiveSheet.Paste\n\n                End If\n\n\n            os2 = os2 + i2\n            If os2 &lt; UBound(sh2Data, 1) Then\n                With sh2\n                    sh2DataA = .Range(.Cells(i2 + os2, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(, 1)\n                    sh2Data = .Range(.Cells(i2 + os2, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(, 4)\n                End With\n                DoSearch = True\n\n            Else\n                DoSearch = False\n            End If\n\n        Else\n            shM.Activate\n            shM.Range(Cells(iM, 1), Cells(iM, 7)).Select\n            Selection.Copy\n\n            sh2.Select\n            FinalRow = Range(\"A65536\").End(xlUp).Row\n            NextRow = Range(\"A65536\").End(xlUp).Row + 1\n            Range(\"A\" &amp; NextRow).Select\n            ActiveSheet.Paste\n\n            DoSearch = False\n        End If\n    Loop Until Not DoSearch\nNext\nEnd Sub\n</code></pre>\n\n<p>The message box was added only to verify that the code was working - it is not a necessary component.  Thanks again for any advice you can give.</p>\n"},{"tags":["php","mysql","excel"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13242321,"title":"PHP explode function loop to be used on column headers to return desired values into an excel file","body":"<p>So I used this code to return an array from a mysql query headers into an Excel file.</p>\n\n<pre><code>while($row_data = mysql_fetch_assoc($result)) {\n$row = 1;\nif ($col == 1) {\n    $row_headings = array_keys($row_data);\n    foreach($row_headings as $value) {\n        $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValueByColumnAndRow($col, $row, $value);\n        $row++;\n    }\n    $row = 1;\n    $col++;\n</code></pre>\n\n<p>These query headers are returned as values such as 1111X2222X3333. I want to explode these values using this explode function somewhere in there</p>\n\n<pre><code> list($sid,$gid,$qid) = explode(\"X\", $string);\n</code></pre>\n\n<p>After this fucntion is used I want to use this query to replace all these column headers with my desired values using this query in the loop</p>\n\n<pre><code>   select * from lime_questions where sid = 1111 and gid = 2222 and qid = 3333\n</code></pre>\n\n<p>If there is a better way to do this please let me know. I appreciate the help</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":23,"score":-3,"question_id":13227414,"title":"Unwanted sheets in workbook","body":"<p>I have a workbook that has an unwanted Macro1 Sheet. When I try to delete \nit, the delete option is grayed out. I wonder how it came into being in the \nfirst place, and more importantly how I can delete it. Any ideas?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba","powerpoint","copy-paste"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":888,"score":0,"question_id":7793593,"title":"Clear clipboard when copying graphs in Excel VBA","body":"<p>I copy and paste several Excel graphs from Excel to Powerpoint using VBA:</p>\n\n<pre><code>'copy from excel worksheet\n    Workbooks(Stats &amp; \".xls\").Worksheets(Stats).ChartObjects(\"graph4\").Copy\n'paste into powerpoint presentation\n    .Slides(3).Shapes.Paste\n\n' more code and more copy and pastes\n' ...\n</code></pre>\n\n<p>Sometimes, copying the graphs fails. I have no explanation for this other than maybe memory problems.\nThe error message that I get:</p>\n\n<blockquote>\n  <p>Method 'Copy' of object 'Chartobject' failed.</p>\n</blockquote>\n\n<p>Then Excel gets unresponsive and I have to restart it.</p>\n\n<p>What can I do to prevent this?\nMaybe I could clear the clipboard between the copy and paste operations?</p>\n\n<p>Update:\nI've tried the two mentioned ways to clear the clipboard. The copy &amp; paste operation still fails from time to time. The run-time error is \"-2147417848 (80010108)\".\nThere's some info about this error on the net, so I'll start over from there.</p>\n\n<p>Update (Final):\nI think I solved the problem by putting this code in front of the parts where the charts are copy and pasted. The error has not appeared again.</p>\n\n<pre><code>DoEvents 'lets the operating system clear / execute any backed up / queued events that it might have to execute.\n'slow down the execution (to not get an error)\nWorkbooks(Stats &amp; \".xls\").Save\n</code></pre>\n"},{"tags":["regex","excel","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13234031,"title":"Excel VBA Regular Expression to Remove Leading Number, Period, and Space?","body":"<p>I have a sheet that I use an Excel VBA macro to automatically fill all worksheet page headers (NOT column headers) with relevant information on a button click.  This macro uses wSheet.Name to populate the header title.  However, wSheet.Name often contains leading numbers, periods, and spaces that I don't want to appear in the header.</p>\n\n<p>Note the following sample worksheet names:</p>\n\n<pre><code>Cover Page\n1a. Test Page\n1b. Sample Page\n2. Another Test Page\n3. Yet Another Test Page\n4. Almost the Last Example Page\n998.  Last Example Page\n</code></pre>\n\n<p>I would like to remove these leading numbers, periods, and spaces using a regular expression, yet I'm unsure how to code it using VBA in Excel.  I would like it to be as flexible as possible.  Here is an example of how I would like the worksheet names to appear:</p>\n\n<pre><code>Cover Page\nTest Page\nSample Page\nAnother Test Page\nYet Another Test Page\nAlmost the Last Example Page\nLast Example Page\n</code></pre>\n\n<p>Here is my existing code that populates the headers:</p>\n\n<pre><code>Sub FillHeaders()\n'\n' Auto_Fill_Project_Name Macro\n'\nFor Each wSheet In ActiveWorkbook.Worksheets\n    If wSheet.Name &lt;&gt; \"Cover Page\" Then\n        wSheet.PageSetup.CenterHeader = _\n            \"&amp;16&amp;KFF0000\" &amp; ActiveSheet.Range(\"J1\") &amp; \"&amp;10&amp;K000000 &amp;16\" &amp; \" \" &amp; _\n            wSheet.Name &amp; Chr(13) &amp; \"&amp;10 &amp;11 Revision Date: \"\n    End If\n    Next wSheet\n'\nEnd Sub\n</code></pre>\n\n<p>How can I modify this to accomplish my goal?</p>\n\n<p>Thank you!</p>\n\n<p>EDIT -- I have taken the following approach:</p>\n\n<pre><code>Function remleaddig(str As String)\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n    regEx.Pattern = \"^\\S*\\.\"\n    str = regEx.Replace(str, \"\")\n    remleaddig = Trim(str)\nEnd Function\n</code></pre>\n"},{"tags":["java","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":57,"score":-2,"question_id":13240872,"title":"How to read data from excel files and write it to a new excel file","body":"<p>I am trying to read data from a few excel files and write all that data into another excel file.\nI would like to get help with it\nI wrote code to read from excel file, but I have no idea how to write it into another excel file\nThanks!</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13240536,"title":"Need VBA assistance copying data to a row in sheet 2 based on value in sheet 1 and remove orignial data from sheet 1","body":"<p>I'm relatively inexperienced in VBA code, but have a workbook that I am trying to organize based on \"Status\" of items listed in rows. </p>\n\n<p>I have a drop down box in column \"M\" that allows the user to select \"HOLD\" or \"RELEASED\"... Based on this value, the line item needs to be copied and pasted into the same exact row in sheet 2 if the value = \"RELEASED\" (Example of line item range is (\"B7:N7\")(Sheets are formatted exactly the same). I have code for this, but I need to remove the line item that is \"RELEASED\" from sheet 1 after it is copied and pasted into sheet 2.</p>\n\n<p>Here is what I have... (Parts Staging Log = Sheet 1 ... Released Parts Log = Sheet 2)</p>\n\n<pre><code>Public Sub CopyPasteRows()\n\nSheets(\"Parts Staging Log\").Select\n' Find the last row of data\nFinalRow = Range(\"B828\").End(xlUp).Row\n' Loop through each row\nFor x = 7 To FinalRow\n' Decide to copy based on column M value \"RELEASED\"\nThisValue = Range(\"M\" &amp; x).Value\nIf ThisValue = \"RELEASED\" Then\nRange(\"B\" &amp; x &amp; \":BM\" &amp; x).Copy\nSheets(\"Released Parts Log\").Select\nNextRow = Range(\"B828\").End(xlUp).Row + 1\nRange(\"B\" &amp; NextRow).Select\nActiveSheet.Paste\nSheets(\"Parts Staging Log\").Select\nEnd If\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>If anyone can assist me with a deletion of the original line item that would be wonderful. Other comments are accepted as well!</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","excel","udf","rtd"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13240515,"title":"Excel UDF & RTD UDF refresh issue","body":"<p>I have a Excel UDF (not RTD UDF)  say MyUDF which reference a cell A1, \nanother RTD UDF say MyRTDUDF which also reference the same cell A1, \nMyUDF calls a web service to get data back</p>\n\n<p>When the value in A1 is not changed\n1. If I have only MyUDF, then MyUDF is calculated only once \n2. If I have both MyUDF &amp; MyRTDUDF, then MyUDF is calculated every time when RTD is updated say every second even though there is no change to A1 at all. This causes lots of lots of traffic to web server</p>\n\n<p>So I wonder what calculation mechanism in Excel and how to avoid this un-necessary re-calucation to MyUDF?</p>\n\n<p>thanks </p>\n\n<p>Edit \nI found the issue exists even when MyRTDUDF references different cell from MyUDF \nthe issue is as long as there is one MyRTDUDF, and MyUDF references built-in function TODAY(),  every time when RTD refreshes, it seems TOday() get calculated and so does MyUDF \nSo how can tell MyUDF stop refreshing since there is no change to TODAY()</p>\n\n<p>thanks </p>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3670,"score":1,"question_id":9951415,"title":"Excel VBA Save Range to variable","body":"<p>I wrote some functional VBA:</p>\n\n<pre><code>Sheets(\"Src\").Range(\"A2:A9\").Copy Destination:=Sheets(\"Dest\").Range(\"A2\")\n</code></pre>\n\n<p>I want to extract the source range into a variable for flexibility.</p>\n\n<pre><code>SrcRange = Sheets(\"Src\").Range(\"A2:A9\")\nSrcRange.Copy Destination:=Sheets(\"Dest\").Range(\"A2\")\n</code></pre>\n\n<p>However, this doesn't work.\nWhat SrcRange should be Dimmed as? Is the first line even correct?<br>\nI tried Dimming SrcRange as Range and it gave me<br>\n<code>Runtime error 91: Object Variable or With block variable not set</code></p>\n\n<p>I'm not very familiar with the language and the documentation has left me wanting (I couldn't find the return type to the Sheets(index) invocation, <a href=\"http://msdn.microsoft.com/en-us/library/bb178404%28v=office.12%29.aspx\" rel=\"nofollow\">this</a> was the closest I found). When I hit Record Macro, perform some actions, and hit stop, the Macro body is still blank.</p>\n\n<p>Could anyone shed some light on how to use SrcRange as a variable?</p>\n"},{"tags":["c#","excel","provider"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13239609,"title":"Substitute for Microsoft.ACE.OLEDB.12.0 on Windows Server 2003","body":"<p>I have a C# batch job that needs to connect to an .xslx Excel spreadsheet. On my windows 7 machine, the provider in the connection string is specified as such: </p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0\n</code></pre>\n\n<p>However, when to job is moved onto the server it will be running on, I get the following error message: </p>\n\n<pre><code>System Exception: The 'Microsoft.ACE.OLEDB.12.0' provider is not registered on the local machine.; \n</code></pre>\n\n<p>The server is running Microsoft Windows Server 2003 Standard Edition Service Pack 2. Does anyone know of a provider that will work on this machine given that the spreadsheet is (and will always be) a 2010 Excel .xslx spreadsheet? </p>\n"},{"tags":["excel","vba","word","word-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12682682,"title":"How to get reference to an open Excel spreadsheet from Word?","body":"<p>I have some VBA code that copies stuff from Excel and pastes it into Word. The problem I'm having is how to open the spreadsheet. I can open it using an absolute path reference by</p>\n\n<blockquote>\n  <p>Workbooks.Open \"C:\\path\\filename.xls\"</p>\n</blockquote>\n\n<p>I would prefer to reference the spreadsheet using a relative path reference. I was able to find code for relative path references from an Excel workbook to another one but it doesn't seem to work if you're doing it from Word.</p>\n\n<p>Any ideas? I feel like this should be easy but I can't find an answer so apologies if it's been done already.</p>\n\n<p>Thanks!</p>\n"},{"tags":["excel","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13235189,"title":"How can I determine the character encoding of an excel file?","body":"<p>Scenario: I have an excel file containing a large amount of global customer data.  I do not know what encoding was used when the file was created.</p>\n\n<p>Question: How can I determine the character encoding used in the excel file so I can import it correctly into another piece of software?</p>\n"},{"tags":["excel","encoding","csv","diacritics"],"answer_count":21,"favorite_count":27,"up_vote_count":68,"down_vote_count":0,"view_count":43378,"score":68,"question_id":155097,"title":"Microsoft Excel mangles Diacritics in .csv files?","body":"<p>I am programmatically exporting data (using PHP 5.2) into a .csv test file.<br />\nExample data:   Numéro 1   (note the accented e).\nThe data is utf-8 (no prepended BOM)</p>\n\n<p>When I open this file in MS excel is displays as NumÃ©ro 1</p>\n\n<p>I am able to open this in a text editor (UltraEdit) which displays it correctly.  UE reports the character is decimal 233.</p>\n\n<p>How can I export text data in a .csv file so that MS excel will correctly render it, preferably without forcing the use of the import wizard, or non-default wizard settings?</p>\n"},{"tags":[".net","excel","datetime"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":9433,"score":8,"question_id":727466,"title":"How do I convert an Excel serial date number to a .NET DateTime?","body":"<p>How do I convert from excel serial date to a .NET date time?</p>\n\n<p>For example  39938 is 05/05/2009.</p>\n"},{"tags":["excel","vba","macros","find-and-replace"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3220,"score":0,"question_id":8231368,"title":"Split strings in excel (vba)","body":"<p>I am currently using this code(from a fellow user here) to find every cell in column b1 and to find the ones that contain a \";\" something like \"hello;goodbye\". The code will split the cell at the \";\" and place \"goodbye\" directly beneath \"hello;\" on an entirely new row..</p>\n\n<p>What I need now is this... if a cell contains <strong><em>multiple</em></strong> \";\" (ie \"hello;goodbye;yo;hi;hey\") it will split at EACH \";\" not just the first and then move each to a new row directly beneath the other...</p>\n\n<p>What changes do I need to make?</p>\n\n<pre><code>Dim r1 As Range, r2 As Range\nDim saItem() As String\n\n\nFor Each r1 In ActiveSheet.Range(\"B1\", Cells(Application.Rows.Count, 2).End(xlUp))\nIf InStr(1, r1.Value2, \";\") &gt; 0 Then\nsaItem = Split(r1.Value2, \";\")\nr1 = Trim$(saItem(0)) &amp; \";\"\nr1.Offset(1).EntireRow.Insert (xlDown)\nr1.Offset(1) = Trim$(saItem(1))\nEnd If\nNext r1\n</code></pre>\n"},{"tags":["vb.net","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13203252,"title":"Colouring non-contiguous blocks of cells quickly","body":"<p>I have an application that generates a (quite large) spreadsheet containing user output that needs to be color coded. As I generate the data I find the blocks that need to be colored, but coloring them is time consuming if I do it one block at a time. What I'd like to do is maintain a large non-contiguous group of cells and color it using one Excel Interop call.</p>\n\n<p>Right now I'm maintaining a range for each color, and every time I find a new block needing that color, I take the union of the the existing range and the new block. Then at the end I color that range. Unfortunately this is really slow and kind of buggy for large cases. Is there a better method of doing this? I feel like coloring a few thousand cells shouldn't take this long. :)</p>\n\n<p><strong>Edit</strong>\nThe following code solved it with conditional formatting (assuming the words CORRECT and INCORRECT are present in column B)</p>\n\n<pre><code>With newSheet.Range(\"B:B\")\n    .FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, \"CORRECT\")\n    .FormatConditions(1).Interior.ColorIndex = 4\n\n    .FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, \"INCORRECT\")\n    .FormatConditions(2).Interior.ColorIndex = 3\nEnd With\n</code></pre>\n\n<p>The only thing I'd still like to do is color more than just the cell containing \"CORRECT\". Instead I'd like to colour the whole row in the chart (e.g. if B42 contains \"CORRECT\", I'd like A42:H42 (the row containing it) to be green). Any tips for doing that?</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13188569,"title":"Excel: is there a function that returns a range for satisfying the matching condition?","body":"<p>Given a value compare with the subsequent rows (on the same column) and return the range upto the row where the value changes for the first time.</p>\n\n<pre><code>Example:\n   A\n1  cat\n2  cat\n3  cat\n4  dog\n5  cat\n</code></pre>\n\n<p>The range to be returned is A1:A3.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":29,"score":3,"question_id":13236963,"title":"VBA Excel Macro clear all checkboxes in column","body":"<p>I'm trying to clear all active X check boxes in a specific range of cells, or by column</p>\n\n<p>It seems like it would be simple as I was able to do it for the entire worksheet with the below code. I'm just not sure how to modify this to only apply for the single column or range of cells.</p>\n\n<pre><code>Sub ClearAllCheckboxes()\n  Dim Answer As String\n  Dim MyNote As String\n  Dim Obj As Object\n\n  MyNote = \"This will Clear all CheckBoxes Proceed? \"\n  Answer = MsgBox(MyNote, vbQuestion + vbYesNo, \"???\")\n\n  If Answer = vbNo Then\n    Exit Sub\n  Else\n    On Error Resume Next\n    For Each Obj In ActiveSheet.OLEObjects\n         Obj.Object.Value = False\n    Next Obj\n  End If\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13236336,"title":"VBA creating menu item to open file?","body":"<p>I have created my own menu which lists files. I want to be able to click on a file name and workboo.open be called. How can I modify:</p>\n\n<pre><code>Set cbButton = vParentMenu.Controls.Add(Type:=msoControlButton)\ncbButton.Caption = strSubMenuCaption\nIf strButtonOnAction &lt;&gt; \"\" Then cbButton.OnAction = \n</code></pre>\n\n<p>to achieve this? I understand I need to add some sort of action string which calls workbook.open with a reference to the file path (which I do have).</p>\n"},{"tags":["excel","vba","outlook","paste"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13236104,"title":"Excel VBA to Email","body":"<p>I am trying to creat a macro that takes a table from excel and pastes it into an email and sends. I can do this up but the table stays as a table and I want to paste special image. I have tried lots of different approaches and lots of googling but to no avail. Please help... thanks.</p>\n\n<p>The code so far</p>\n\n<pre><code>TempFile = Environ$(\"temp\") &amp; \"/\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Format:=\"Picture (Enhanced Metafile)\"  'Paste:=2\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.ReadAll\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n</code></pre>\n"},{"tags":["mysql","excel","odbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13236412,"title":"Call mysql through odbc and excel","body":"<p>I am calling a query through an odbc connection from excel.</p>\n\n<p>I have a where clause where I want to use dates.</p>\n\n<p>This works for a date\nsale.saledate>={d '2012-10-29'}</p>\n\n<p>But I need to add time in also</p>\n\n<p>I tried\nsale.saledate>={d '2012-10-29 3:30 PM'}</p>\n\n<p>But this does not work.</p>\n\n<p>any ideas?</p>\n"},{"tags":["asp.net","excel","internet-explorer","intranet"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":306,"score":4,"question_id":12712523,"title":"Opening an Excel .xlsx file in IE and following its embedded hyperlinks back to file server","body":"<p>I have an intranet site that lets users open files in the browser (by prompting for download). One of these files is an .xlsx workbook that contains hyperlinks which point to different locations of files <em>(.pdfs, .docs</em>) on the file server in which the .xlsx workbook is located. </p>\n\n<p>It seems the file server path to the workbook is replaced by a \"Temporary Internet Files/Content.IE5/\" path, leading to the warning \"cannot open the specified file\" in Excel. </p>\n\n<p>I tried downloading the Excel document first and then following the links, but they're still opening in the temp internet location</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>For instance, when hovering over the hyperlinks in excel they read: \"file:///C:\\Documents And Settings\\%username%\\Local Settings\\Temporary Internet files\\Content.IE5\\40WSS3CB\\\" + filename</p>\n\n<p>when they should read: \"file:///\\servername\\Departments\\Read\\\" + filename</p>\n\n<p>How can I still open the excel file in the browser and retain the hyperlinks inside and have them not be replaced by the temporary internet files path?</p>\n\n<p>can someone point me in the right direction ? Thanks!</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":28,"score":-2,"question_id":13235480,"title":"How can I separate the rgb values in an excel column?","body":"<p>How can I separate the rgb values in excel column,</p>\n\n<p>This is example can I have to separate the values in different column.</p>\n\n<p>Can any one help with this.</p>\n\n<p>Format line is:</p>\n\n<pre><code>0   0  (202 200 201)  #CAC8C9  rgb(202 200 201)\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13236127,"title":"Extract top 10% of column values in Excel and place in another column","body":"<p>I have an excel spreadsheets with values in one column. What i need is a VBA code that will identify top 10% of column values, and place them in a adjacent column.\n![enter image description here][1]</p>\n"},{"tags":["c#","excel","interop","com-interop"],"answer_count":20,"favorite_count":111,"up_vote_count":181,"down_vote_count":0,"view_count":67652,"score":181,"question_id":158706,"title":"How to properly clean up Excel interop objects","body":"<p>I'm using the Excel interop in C# (<code>ApplicationClass</code>) and have placed the following code in my finally clause:</p>\n\n<pre><code>while (System.Runtime.InteropServices.Marshal.ReleaseComObject(excelSheet) != 0) { }\nexcelSheet = null;\nGC.Collect();\nGC.WaitForPendingFinalizers();\n</code></pre>\n\n<p>Although, this kind of works the Excel.exe process is still in the background even after I close Excel.  It is only released once my application is manually closed.  </p>\n\n<p>Anyone realize what I am doing wrong, or has an alternative to ensure interop objects are properly disposed of.</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13227853,"title":"range type mismatch vba","body":"<p>I'm getting a type mismatch error while comparing a range value to <code>\"\"</code> or <code>vbNullString</code>. i read many similar q+a posts that deal with this issue. </p>\n\n<p><em>The data is all numbers or <code>\"\"</code>.</em></p>\n\n<pre><code>Sub vegetableCounting()\nDim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\nDim ws1Range As Excel.range, ws2Range As Excel.range, ws3Range As Excel.range, ws2Loop As Excel.range\nDim ws1Row As Long, ws1Col As Long, ws2Row As Long, ws2Col As Long\n'\nDim rowCounter As Long, colCounter As Long, rowsMendo As Long\nDim mendoSum As Double\n'\nSet ws1 = Sheets(\"shareSchedule\")\nSet ws2 = Sheets(\"shareDistribution\")\nSet ws3 = Sheets(\"vegCount\")\n'***not yet set to the full ranges***\nSet ws1Range = ws1.range(\"E7:H11\") 'shareSchedule\nSet ws2Range = ws2.range(\"D7:BB17\") 'shareDistribution\nSet ws3Range = ws3.range(\"D7:BB11\") 'vegetableCount\n'***not yet set to the full ranges***\nrowsMendo = 0\nrowCounter = 0\ncolCounter = 0\nmendoSum = 0\n\nFor ws1Row = 0 To ws1Range.Rows.count Step 1\n    For ws1Col = 0 To ws1Range.Columns.count Step 1\n        If ws1Range.Offset(ws1Row, ws1Col).value &lt;&gt; \"\" Then\n            For Each ws2Loop In ws2Range '11rows*51cols = 561\n                ws2Row = ws2Row + rowCounter + rowsMendo\n                ws2Col = ws2Col + colCounter\n                If ws2Range.Offset(ws2Row, ws2Col).value = \"\" Then\n                    Exit For\n                Else\n                    If ws1Range.Offset(ws1Row, ws1Col).Interior.ColorIndex = 24 And _\n                    ws2Range.Offset(ws2Row, ws2Col).Interior.ColorIndex = 24 Then 'a MENDO match\n                        If rowCounter &lt; 3 Then\n                            mendoSum = mendoSum + ws1Range.Offset(ws1Row, ws1Col).value * ws2Range.Offset(ws2Col, ws2Row)\n                            rowCounter = rowCounter + 1\n                        ElseIf rowCounter = 3 Then\n                            colCounter = colCounter + 1\n                            rowCounter = 0\n                        ElseIf colCounter = ws2Range.Columns.count + 1 And _\n                        ws2Range.Offset(ws2Row, 1).Interior.ColorIndex = 24 And _\n                        ws2Range.Offset(ws2Row + 4, 1).Interior.ColorIndex = 24 Then\n                            colCounter = 0\n                            rowsMendo = rowsMendo + 3\n                        ElseIf colCounter = ws2Range.Columns.count + 1 And _\n                        ws2Range.Offset(ws2Row, 1).Interior.ColorIndex = xlNone And _\n                        ws2Range.Offset(ws2Row + 4, 1).Interior.ColorIndex = xlNone Then\n                            colCounter = 0\n                            rowsMendo = rowsMendo + 1\n                        End If\n\n                        ws3Range.Offset(ws1Row, ws2Col) = ws1Range.Offset(ws1Row, ws1Col).value * ws2Range.Offset(ws2Row, ws2Col).value\n\n                    End If\n                End If\n            Next\n        End If\n    Next ws1Col\nNext ws1Row\n\n'for ws2\n                'Offset(0, 0), Offset(1, 0), Offset(2, 0), then\n                'Offset(0, 1), Offset(1, 1), Offset(2, 1), then\n                'Offset(0, 2), Offset(1, 2), Offset(2, 2), then\n                'etc\nEnd Sub\n</code></pre>\n\n<p>i get the error on</p>\n\n<pre><code>  If ws1Range.Offset(ws1Row, ws1Col).value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>and ill prob get it again on</p>\n\n<pre><code>If ws2Range.Offset(ws2Row, ws2Col).value = \"\" Then\n</code></pre>\n\n<p>any thoughts? here are some images of the worksheets im trying to pull from</p>\n"},{"tags":["sharepoint-designer","excel","xml","openxml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13236044,"title":"How to read excel file using xmldocument","body":"<p>I need to read the Excel data using Xmldocument.Plz help me</p>\n"},{"tags":["c#","excel","web-scraping"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":82,"score":1,"question_id":13220150,"title":"Best way to collect information from web page","body":"<p>I need to get information from couple of web sites . For example <a href=\"http://tel.directory.gov.hk/index_ENG.html?accept_disclaimer=yes\" rel=\"nofollow\">this site</a>\nWhat would be the best way to get all the links from the page so that the information could be extracted.\nSome times need to click on a link to get other links inside that. \nI tried Watin and I tried doing the same from within Excel 2007 with Web Data option.\nCould you please suggest some better way which I am not aware of .</p>\n"},{"tags":["r","excel","data.frame","numeric"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13233823,"title":"Excel misses values from numeric vector with write.table function in R","body":"<p>I am trying to save a data.frame from R so that it can be read from Excel. I have done this with several other data.frames that have the same structure as the one I refer to now, so far without problems. But for some reason when I try to save this data.frame and then open it with Excel, many of the numerical values in the columns FreqDev and LengthDev are not read by Excel. Instead, the rows show a string of \"#\" symbols. </p>\n\n<p>My data.frame looks like this:</p>\n\n<pre><code>head(RegPartV)\n     LogFreq     Word   PhonCV WordClass  FreqDev  LengthDev Irregular\n1277  28.395  geweest CV-CVVCC         V 5.464336 -1.1518498     FALSE\n903   25.647  gemaakt CV-CVVCC         V 4.885296 -1.1518498     FALSE\n752   23.304    gehad   CV-CVC         V 4.391595 -2.1100420     FALSE\n610   22.765 gebracht CV-CCVCC         V 4.278021 -0.6727537     FALSE\n1312  22.041   gezegd  CV-CVCC         V 4.125465 -1.6309459     FALSE\n647   21.987   gedaan  CV-CVVC         V 4.114086 -1.6309459     FALSE\n</code></pre>\n\n<p>The type of information in the data.frame is:</p>\n\n<pre><code>str(RegPartV)\n'data.frame':   2096 obs. of  7 variables:\n $ LogFreq  : num  28.4 25.6 23.3 22.8 22 ...\n $ Word     : chr  \"geweest\" \"gemaakt\" \"gehad\" \"gebracht\" ...\n $ PhonCV   : chr  \"CV-CVVCC\" \"CV-CVVCC\" \"CV-CVC\" \"CV-CCVCC\" ...\n $ WordClass: Factor w/ 1 level \"V\": 1 1 1 1 1 1 1 1 1 1 ...\n $ FreqDev  : num  5.46 4.89 4.39 4.28 4.13 ...\n $ LengthDev: num  -1.152 -1.152 -2.11 -0.673 -1.631 ...\n $ Irregular: logi  FALSE FALSE FALSE FALSE FALSE FALSE ...\n</code></pre>\n\n<p>What is strange is that if I put my mouse over the numerical cells that now have only # symbols (in the excel file), I see a trace of the numbers that used to be there in the original R data.frame. For example, the values of these columns for the first row in the data.frame are:</p>\n\n<pre><code>&gt;RegPartV[1,c(5,6)]\n      FreqDev LengthDev\n1277 5.464336  -1.15185\n</code></pre>\n\n<p>And if I put my mouse over the Excel cells (that contain only # symbols)  corresponding to the same values I just showed, I see: </p>\n\n<pre><code>54643356148468 \n</code></pre>\n\n<p>and</p>\n\n<pre><code>-115184982188519\n</code></pre>\n\n<p>So the numbers are still there, but for some reason either R or Excel lost count of where the decimal was. </p>\n\n<p>The method I am using to save the data.frame (and that I've used for structurally equivalent data.frame) is:</p>\n\n<pre><code>write.table(RegPartV,file=\"RegPartV\",quote=F,sep=\"\\t\",row.names=F,col.names=T)\n</code></pre>\n\n<p>Then I open the file with Excel and I would expect to see all the info there, for some reason I'm having this numeric problem with this particular data.frame. </p>\n\n<p>Any suggestions to get an Excel-readable data.frame are very welcome.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["excel","matlab","pdf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13232735,"title":"How to save an Excel sheet as PDF through MATLAB?","body":"<p>I am using the following code:</p>\n\n<pre><code>hExcel = actxserver('Excel.Application');\nhWorkbook = hExcel.Workbooks.Open(sprintf('%s','C:\\test.xlsx'));\nhWorksheet = hWorkbook.Sheets.Item(1);\nhRange = hWorksheet.Range('A1:O10');\nhRange.ExportAsFixedFormat('xlTypePDF','test_out.pdf');\n</code></pre>\n\n<p>The Excel ActiveX server allows me to do the usual stuff, but the last line doesn't do anything. Neither does it throw any error.</p>\n\n<p>Does anyone know how to do this?</p>\n"},{"tags":["php","excel","text","csv","oscommerce"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":173,"score":0,"question_id":11483325,"title":"Oscommerce and automatic import of excel/csv file to my database on a daily basis","body":"<p>I would like to convert a text file to excel and then modify certain data inside the excel file and then import this new excel file to a database.</p>\n\n<p>The contents of the excel file, for example, will be products and their prices and the modification will be on the prices. So the update of the products in the database and on the website will be automatic. I am planning to use OSCommerce</p>\n\n<p>My question is this: Is there any tool for OSCommerce that I will configure it to do this job for me as I need to do this automatically every 8 hours for example? I need to write a script from scratch using PHP?</p>\n"},{"tags":["python","excel","win32com","office-2013"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13121529,"title":"Python Makepy with Office 2013 (office 15)","body":"<p>I'm using python and excel with office 2010 and have no problems there.\nI used python's makepy module in order to bind to the txcel com objects.</p>\n\n<p>However, on a different computer I've installed office 2013 and when I launched makepy no excel option was listed (as opposed to office 2010 where 'Microsoft Excel 14.0 Object Library' is listed by makepy).</p>\n\n<p>I've searched for 'Microsoft Excel 15.0 Object Library' in the registry and it is there.\nI tried to use : <code>makepy -d 'Microsoft Excel 15.0 Object Library'</code> \nbut that didn't work.</p>\n\n<p>Help will be much appreciated.\nThanks.</p>\n"},{"tags":["excel","google","csv","google-docs"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":507,"score":0,"question_id":7272663,"title":"Google Docs Export CSV with double quotes","body":"<p>I have a Google spreadsheet that I need to export and have every field contained in double quotes \"field\" but at the moment it doesn't not do this.</p>\n\n<p>Is there an easy way to achieve this without resorting to manually editing hundreds of lines?</p>\n\n<p>Max</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13231680,"title":"Detecting errors on Excel Worksheets","body":"<p>Is there a simple way to enumerate the errors in a range?</p>\n\n<p>I tried to use the following code, but it does not work</p>\n\n<pre><code>Dim err As Object\n\nFor Each err In Plan10.Range(\"M2:AB8000\").Errors\n    Debug.Print err.Value\nNext err\n</code></pre>\n\n<p>I know from the documentation, that I can't simply enumerate errors using the <code>range.errors</code>.\nI solved the problem scanning every error in every cell in the range, but it is painfully slow</p>\n\n<p>Is there a better way to do the job?</p>\n"},{"tags":["java","excel","xls","xlsx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13230767,"title":"need help to for wring excel with hyperlink field file in java","body":"<p>i am trying to write excel file through the java which has hyperlink field. </p>\n\n<p>i am writing it from object list. please check my code.</p>\n\n<p>it is working when i am giving object list. and it is writing xls file. </p>\n\n<p>but i also want to write hyperlink in it. what should i change in following code.?</p>\n\n<p><strong>Just Start From exportToExcel method.</strong></p>\n\n<pre><code>package com.ksh;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Modifier;\nimport java.math.BigDecimal;\nimport java.text.DecimalFormat;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Map;\n\nimport org.apache.poi.xssf.usermodel.XSSFCell;\nimport org.apache.poi.xssf.usermodel.XSSFRow;\nimport org.apache.poi.xssf.usermodel.XSSFSheet;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\n\nimport com.ksh.Final.Link;\n\npublic class OwnClass {\n\n    private static SimpleDateFormat dateTimeFormatter = new SimpleDateFormat(\"yyyyMMddHHmmss\");\n    @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n    private static Map&lt;Class&lt;?&gt;, Class&lt;?&gt;&gt; javaBasicObjectTypeMap = new HashMap();\n    @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n    private static Map&lt;Class&lt;?&gt;, Class&lt;?&gt;&gt; floatingPointTypeMap = new HashMap();\n\n    static \n    {\n        javaBasicObjectTypeMap.put(Integer.class, Integer.class);\n        javaBasicObjectTypeMap.put(Long.class, Long.class);\n        javaBasicObjectTypeMap.put(Float.class, Float.class);\n        javaBasicObjectTypeMap.put(Double.class, Double.class);\n        javaBasicObjectTypeMap.put(BigDecimal.class, BigDecimal.class);\n        javaBasicObjectTypeMap.put(Character.class, Character.class);\n        javaBasicObjectTypeMap.put(String.class, String.class);\n        javaBasicObjectTypeMap.put(Date.class, Date.class);\n\n        floatingPointTypeMap.put(Float.class, Float.class);\n        floatingPointTypeMap.put(Double.class, Double.class);\n        floatingPointTypeMap.put(BigDecimal.class, BigDecimal.class);\n    }\n\n    @SuppressWarnings(\"rawtypes\")\n    public static String exportToExcel(List&lt;?&gt; objectList, \n                                       ExcelFileParameter config, \n                                       Map&lt;String, String&gt; fieldNameTitleMap)throws Exception\n    {\n        String filePath = config.getExcelFileAbsolutePath();\n        if (filePath.isEmpty()) \n        {\n            filePath = dateTimeFormatter.format(new Date()) + \".xlsx\";\n        }\n        File excelFile = new File(filePath);\n        FileOutputStream fos = null;\n        XSSFWorkbook workBook = new XSSFWorkbook();\n        XSSFSheet sheet = workBook.createSheet();\n        List rowlist = convertObjectToRowList(objectList, config, fieldNameTitleMap);\n\n        System.out.println(\"Kshitij : \"+rowlist.size()+\"Type : ====\"+rowlist.get(0).getClass().getName());\n\n        for (int i = 0; (rowlist != null) &amp;&amp; (i &lt; rowlist.size()); i++) \n        {\n            List row = (List)rowlist.get(i);\n            XSSFRow excelRow = sheet.createRow(i);\n            for (int j = 0; (row != null) &amp;&amp; (j &lt; row.size()); j++) \n            {\n                XSSFCell cell = excelRow.createCell(j);\n                cell.setCellValue((String)row.get(j));\n            }\n        }\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        workBook.write(bos);\n        try\n        {\n            fos = new FileOutputStream(excelFile);\n            fos.write(bos.toByteArray());\n        } \n        catch (Exception ex) \n        {\n            throw ex;\n        } \n        finally \n        {\n            fos.flush();\n            fos.close();\n        }\n\n        return excelFile.getAbsolutePath();\n    }\n\n    @SuppressWarnings({ \"rawtypes\", \"unchecked\" })\n    private static List&lt;List&lt;String&gt;&gt; convertObjectToRowList(List&lt;?&gt; objectList, \n                                                             ExcelFileParameter config, \n                                                             Map&lt;String, String&gt; fieldNameTitleMap) throws Exception\n\n    {\n        if (objectList == null) \n        {\n            throw new Exception(\"objectList is null!\");\n        }\n        if (objectList.size() == 0) \n        {\n            throw new Exception(\"objectList is empty!\");\n        }\n\n        List rowList = new ArrayList();\n        Class itemClass = objectList.get(0).getClass();\n        System.out.println(\"Object List Type is : \"+itemClass.getName());\n\n        if (javaBasicObjectTypeMap.containsKey(itemClass))\n        {\n              System.out.println(\"Non Primitive Type From Java Library\");\n              for (Iterator localIterator = objectList.iterator(); localIterator.hasNext(); ) \n              { \n                  Object obj = localIterator.next();\n                  String value = convertFieldValueToString(itemClass, obj, config);\n                  List row = new ArrayList();\n                  row.add(value);\n                  rowList.add(row);\n              }\n        }\n        else\n        {\n              System.out.println(\"User Defined Class Type just got\");\n              List allFields = getFields(itemClass);\n              Object excelFields = new ArrayList();\n              List header = new ArrayList();\n              String fieldName = null;\n\n              for (int i = 0; (allFields != null) &amp;&amp; (i &lt; allFields.size()); i++) \n              {\n                    fieldName = ((Field)allFields.get(i)).getName();\n                    if ((fieldNameTitleMap != null) &amp;&amp; (fieldNameTitleMap.keySet().size() &gt; 0)) \n                    {\n                        if (fieldNameTitleMap.containsKey(fieldName)) \n                        {\n                            ((List)excelFields).add((Field)allFields.get(i));\n                            header.add((String)fieldNameTitleMap.get(fieldName));\n                        }\n                    } \n                    else \n                    {\n                        ((List)excelFields).add((Field)allFields.get(i));\n                        header.add(fieldName);\n                    }\n              }\n              rowList.add(header);\n              for(Object object : objectList)\n              {\n                  List row = convertToRow(object, config, (List)excelFields);\n                  rowList.add(row);\n              }\n        }\n        return rowList;\n      }\n\n      private static String convertFieldValueToString(Class&lt;?&gt; fieldType, \n                                                      Object fieldValue, \n                                                      ExcelFileParameter config) throws Exception \n      {\n\n            if (fieldValue == null) \n            {\n                return config.getNullValueStrig();\n            }\n            if (fieldType.isAssignableFrom(Date.class)) \n            {\n                SimpleDateFormat dateTimeFormat = config.getDateTimeFormat();\n                if (dateTimeFormat == null) \n                {\n                    return fieldValue.toString();\n                }\n                dateTimeFormat.format(fieldValue);\n            }\n\n            if ((fieldType == Float.TYPE)  || \n                (fieldType == Double.TYPE) || \n                (floatingPointTypeMap.containsKey(fieldType)))\n            {\n                  DecimalFormat decimalFormat = config.getDecimalFormat();\n                  if (decimalFormat == null) \n                  {\n                    return fieldValue.toString();\n                  }\n                  decimalFormat.format(fieldValue);\n            }\n\n            System.out.println(\"99999999999999999999999999999999999999999 : \"+fieldType);\n            if(fieldType == Link.class)\n            {\n                System.out.println(\"Link Value is Found...\");\n                System.out.println(\"Field Value : \"+fieldValue.toString());\n            }\n\n            return fieldValue.toString();\n      }\n\n      @SuppressWarnings({ \"rawtypes\", \"unchecked\" })\n      private static List&lt;Field&gt; getFields(Class&lt;?&gt; clazz)\n      {\n            List list = new ArrayList();\n            Field[] fieldlist = clazz.getDeclaredFields();\n            for (int i = 0; (fieldlist != null) &amp;&amp; (i &lt; fieldlist.length); i++)\n            {\n                Field field = fieldlist[i];\n                Class type = fieldlist[i].getType();\n                System.out.println(\"Type :\" +type);\n                int mod = fieldlist[i].getModifiers();\n                System.out.println(\"Mode :\" +mod);\n                if ((!Modifier.isFinal(mod)) &amp;&amp; (!Modifier.isStatic(mod))) \n                {\n                    if (type.isPrimitive())\n                    {\n                        list.add(field);\n                    }\n                    else if (javaBasicObjectTypeMap.containsKey(type)) \n                    {\n                        list.add(field);\n                    }\n                }\n            }\n            for(Object object : list)\n            {\n                Field field = (Field) object;\n                System.out.println(field.getName());\n            }\n            return list;\n\n      }\n\n      @SuppressWarnings({ \"rawtypes\", \"unchecked\" })\n      private static List&lt;String&gt; convertToRow( Object object, \n                                                ExcelFileParameter config, \n                                                List&lt;Field&gt; fieldList )\n      {\n\n          List row = new ArrayList();\n          for (int i = 0; (fieldList != null) &amp;&amp; (i &lt; fieldList.size()); i++) \n          {\n              try \n              {\n                  Field field = (Field)fieldList.get(i);\n                  field.setAccessible(true);\n                  Class fieldType = field.getType();\n                  Object fieldValue = field.get(object);\n//                System.out.println(\"Field Type : \"+fieldType +\"FieldValue : \"+fieldValue);\n                  String value = convertFieldValueToString(fieldType, fieldValue, config);\n                  System.out.println(\"--------------------------------------------------\"+value);\n                  row.add(value);\n\n              } \n              catch (Exception ex) \n              {\n                  row.add(\"ERROR:\" + ex.toString());\n              }\n          }\n          System.out.println(\"kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk\"+row.size());\n        return row;\n      }\n\n\n}\n</code></pre>\n\n<p>Means that will take object link write it to the excel file. its is working but need to write hyperlink field.</p>\n"},{"tags":["php","mysql","database","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":13231547,"title":"Export simple excel data into MySQL using PHP","body":"<p>My client got a excel file with the following structure</p>\n\n<pre><code>name     |     email\n----------------------------\nName     |   email here\nName     |   email here\nName     |   email here\nName     |   email here\nName     |   email here\nName     |   email here\n</code></pre>\n\n<p>I would likes to make a MySQL database table according to this pattern and save the data into MySQL.</p>\n\n<p>I am wonder how to do this. \nAlso there is an option needed</p>\n\n<p>We have to check that if that corresponding user had a correct email address, ie of the form @ . </p>\n\n<p>Can we check the data as a loop while importing ?</p>\n\n<p>Also how to convert this data to MySQL ?</p>\n"},{"tags":["php","mysql","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":582,"score":1,"question_id":4593436,"title":"mapping excel data to mysql database","body":"<p>how to mapping excel data column name to mysql data field?\nand mapping between excel data column name and mysql data field name and getting the excel data from excel file </p>\n"},{"tags":["c#",".net","excel","oledb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13231608,"title":"Excel data coloring via OLEDB","body":"<pre><code>OleDbCommand cmd = new OleDbCommand(\"Select * from [\" + txtsheet.Text + \"] WHERE [ASSET NUM] = \" + asset + \"\", con);    \n\nOleDbDataReader rdr = cmd.ExecuteReader();    \n\nOleDbDataAdapter da = new OleDbDataAdapter(cmd);    \n\nint x = cmd.ExecuteNonQuery();    \n</code></pre>\n\n<p>and after this the selected asset num row has to be marked in red color</p>\n\n<p>Please help me for this</p>\n\n<p>Thanks in advance</p>\n\n<p>Regards\nMahendran</p>\n"},{"tags":["excel","postgresql","vba","odbc","ado"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13230456,"title":"Connecting Excel to PostgreSQL via VBA","body":"<p>Is it possible to make query like <code>SELECT</code> from VBA in Excel, so I can query a PostgreSQL DB from Excel?</p>\n\n<p>If is possible please explain me how to connect to the database. I was looking in Google but found no results.</p>\n"},{"tags":["excel","vba","excel-vba","macros","worksheet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13215039,"title":"Run Excel Macro from another Sheet with a twist","body":"<p>I have a very frustrating <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> issue.</p>\n\n<p>I have an an Excel Add-in called \"SMF_Add-In\" that pulls stock market historical data into excel in the form of a big array, like A1:G600. So I built a custom stock chart with live yahoo data that can scroll and zoom. I have the chart and data set to change according to the Ticker symbol in a certain cell. The chart is on its own worksheet with the symbol input cell and some other user input options for the chart. All the historical data and background stuff is on its own hidden sheet.  </p>\n\n<p><em><strong>Here is where it gets tricky.</em></strong></p>\n\n<p>I wrote a VBA code to calculate HLC_3 in a new column on the hidden data sheet. When I run the code it works like a charm. However I can only run it when I actively in the data sheet. I already have a vba code to run when the symbol gets reset that sets the chart axes using <code>Worksheet_Change</code> and the code looks into the data sheet to find max and min. </p>\n\n<p>Since that worked I thought I could run the HLC_3 code the same way but it didn't work. It gets stuck on the first method which is just to count the non 0 rows in the data, and says there is no data to count. Remember if I run it from the data sheet it works. </p>\n\n<p>By deduction I found two issues:</p>\n\n<ol>\n<li>If I change the symbol the HLC_3 VBA code trys to run before the SMF-Add-In array can download the data. So I tried a wait for a few seconds, it waited but still didn't work. </li>\n<li>I made a square and assigned the HLC_3 macro to it on the chart's sheet, changed the symbol, everything updated properly, then I pushed the button, and the macro failed and gave the same error as before. The question is how can I run HLC_3, which does everything in the back-end data sheet, from the front end sheet a few seconds after the array data download? </li>\n</ol>\n\n<p>Below is my auto trigger, the HLC_3 part doesn't work, I have even tried to put the auto trigger in the data sheet page code but that did not even run at all even when something changed. I tried a ton of combinations with the code below and a other random ideas too but yet to no avail. </p>\n\n<p>Please Help, thank You. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells1, KeyCells2 As Range\nSet KeyCells1 = Range(\"B1,B2, B3, B5\")   \nIf Not Application.Intersect(KeyCells1, Range(Target.Address)) _\n       Is Nothing Then\n    Call Module1.ChangeAxisScales\n    Call Module2.HLC_3      \nEnd If  \nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel","sorting","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12936457,"title":"Sorting Excel Rows using Excel Interop C#","body":"<p>I have a C# program that is out putting results to an excel spread sheet.  Each row contains the information for a competitor including several fields such as name, id number, address, score, etc with each being in a different column.  I want to sort all of these competitors (so I want to sort these rows) based upon the score with the records being sorted descendingly from highest to lowest.  What is the best way to go about this?  Here is the code I am trying which is not working.</p>\n\n<pre><code> Excel.Range sortRange;\n                sortRange = worksheet.get_Range(\"A14\", \"K32\");\n                Excel.Range scoreColumn;\n                scoreColumn = worksheet.get_Range(\"C14\", \"C32\");\n                sortRange.Sort(scoreColumn, Excel.XlSortOrder.xlDescending,\n</code></pre>\n"},{"tags":["c#","excel","pdf","export"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13228520,"title":"Stop of exporting excel to pdf","body":"<p>Well, for last two months I've been exporting Excel worksheets to PDF and this morning my code just stopped doing that. Every other functionality of my application works great but when I run my \"Excel to PDF\" part it just <strong>freezes whole application</strong>. After this I've tried to debug it, but again it freezes it without showing any sign of what is the problem. Here is my code for that export: </p>\n\n<pre><code>xlSheet.ExportAsFixedFormat(XlFixedFormatType.xlTypePDF, path + file_name, XlFixedFormatQuality.xlQualityStandard, true, false, System.Type.Missing, System.Type.Missing, false, System.Type.Missing);\n</code></pre>\n\n<p>Any idea why is this happening or another way for export of excel2pdf?!</p>\n"},{"tags":["excel","vba"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13227900,"title":"Autosum Cells VBA Excel","body":"<p>Im trying to autosum the values within a block of cells in Excel using VBA. I kept getting a type mismatch error while debugging the following code. Where did I go wrong?</p>\n\n<pre><code>Sub autosumtest()\n    Dim total As Integer\n    Worksheets(\"Sheet1Test\").Select\n    Range(\"F16:G20\").Select\n    total = CInt(\"=SUM(Selection.Values)\")\n    MsgBox (total)\nEnd Sub\n</code></pre>\n\n<p><strong><code>EDIT 1:</code> Here is the simple sample of my test data called Autosum Range:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/EzqJF.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","excel","list","generic-list"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":12602,"score":2,"question_id":1059951,"title":"Export a C# List of Lists to Excel","body":"<p>Using C#, is there a direct way to export a List of Lists (i.e., <code>List&lt;List&lt;T&gt;&gt;</code>) to Excel 2003?</p>\n\n<p>I am parsing out large text files and exporting to Excel. Writing one cell at a time creates way too much overhead. I chose to use <code>List&lt;T&gt;</code> so that I would not have to worry about specifying the number of rows or columns.</p>\n\n<p>Currently, I wait until end of file, then put the contents of my <code>List&lt;List&lt;object&gt;&gt;</code> into a 2-dimensional array. Then the array can be set as the value of an Excel.Range object. It works, but it seems like I should be able to take my List of Lists, without worrying about the number of rows or columns, and just dump it into a worksheet from A1 to wherever.</p>\n\n<p>Here's a snippet of the code I'd like to replace or improve on:</p>\n\n<pre><code>object oOpt = System.Reflection.Missing.Value; //for optional arguments\nExcel.Application oXL = new Excel.Application();\nExcel.Workbooks oWBs = oXL.Workbooks;\nExcel._Workbook oWB = oWBs.Add(Excel.XlWBATemplate.xlWBATWorksheet);\nExcel._Worksheet oSheet = (Excel._Worksheet)oWB.ActiveSheet;\n\nint numberOfRows = outputRows.Count;\nint numberOfColumns = int.MinValue;\n\n//outputRows is a List&lt;List&lt;object&gt;&gt;\nforeach (List&lt;object&gt; outputColumns in outputRows)\n{\n        if (numberOfColumns &lt; outputColumns.Count)\n        { numberOfColumns = outputColumns.Count; }\n}\n\nExcel.Range oRng = oSheet.get_Range(\"A1\", oSheet.Cells[numberOfRows,numberOfColumns]);\n\nobject[,] outputArray = new object[numberOfRows,numberOfColumns];\n\nfor (int row = 0; row &lt; numberOfRows; row++)\n{\n        for (int col = 0; col &lt; outputRows[row].Count; col++)\n        {\n                outputArray[row, col] = outputRows[row][col];\n        }\n}\n\noRng.set_Value(oOpt, outputArray);\n\noXL.Visible = true;\noXL.UserControl = true;\n</code></pre>\n\n<p>This works, but I'd rather use the List directly to Excel than having the intermediary step of creating an array just for the sake of Excel. Any ideas?</p>\n"},{"tags":["c#","excel","ms-office","office-interop","excel-interop"],"answer_count":7,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2452,"score":3,"question_id":2206279,"title":"Exporting the values in List to excel","body":"<p>Hi I am having a list container which contains the list of values. I wish to export the list values directly to Excel. Is there any way to do it directly?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13225591,"title":"Need count of rows having data in all the excels under one folder","body":"<p>How to get the count of all the rows(which have data) in all the excels present under the specified path.The count needs to be used in reporting excel.</p>\n\n<p>The number of excels may not be same in all the folders. Only input should be the file path/location.</p>\n\n<p>I am totally new to vba and a beginner in excel.</p>\n\n<p>Thanks in advance for ur help.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13228334,"title":"Excel VBA. Does this macro produce random permutations?","body":"<p>I'm relying on this macro to produce random sequences at the moment, and I just wanted to check that the sequences I'm getting are indeed random (well, the best a computer can do at random obviously).</p>\n\n<pre><code>Sub Random()\nFor x = 1 To Selection.Rows.Count\n   r = Int(Rnd(1) * (Selection.Rows.Count) + 1)\n   For z = 1 To Selection.Columns.Count\n       y = Selection.Cells(x, z).Formula\n       Selection.Cells(x, z).Formula = Selection.Cells(r, z).Formula\n       Selection.Cells(r, z).Formula = y\n   Next z\nNext x\nEnd Sub\n</code></pre>\n\n<p>Sorry for the terribly pedestrian question but I need peace of mind on this.</p>\n\n<p>Thanks very much</p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13227696,"title":"Excel VBA copy cell value that is bold over regular values until next bold value then copy that over regular values etc","body":"<p>Hello everyone I use Excel 2010 with VB</p>\n\n<p>Ok so I have an issue where I have to copy the bolded cells value from a column into another column AND the same value to be copied until it hits the row with the bolded cell value again and then that value takes over and is copied until another bolded value etc AND when copying the first 2 digits of a number (or characters as I think the numbers are stored as text) are to be deleted.</p>\n\n<p>Can this be done?</p>\n\n<p>I found this code for the copying bolded values into another column:</p>\n\n<pre><code>Sub yTekhed()\n    For Each cell In [A30:A2557]\n        If cell.Font.Bold = True Then\n            Debug.Print cell.Row\n            cell.Copy Range(\"I\" &amp; Range(\"I65536\").End(xlUp).Row + 1)\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>I figured out the deleting characters, there is a formula =RIGHT(A1; LEN(A1)-2)</p>\n\n<p>But that is as far as I got</p>\n\n<p>I still can't copy bold over regular. So say I have:</p>\n\n<p><strong>08479</strong></p>\n\n<p>code</p>\n\n<p>082222</p>\n\n<p>093334</p>\n\n<p>084213</p>\n\n<p><strong>08572</strong></p>\n\n<p>code</p>\n\n<p>093212</p>\n\n<p>012321</p>\n\n<p>482123</p>\n\n<p>I want the paste to look like</p>\n\n<p><strong>08479</strong></p>\n\n<p><strong>08479</strong></p>\n\n<p><strong>08479</strong></p>\n\n<p><strong>08479</strong></p>\n\n<p><strong>08572</strong></p>\n\n<p><strong>08572</strong></p>\n\n<p><strong>08572</strong></p>\n\n<p><strong>08572</strong></p>\n\n<p>So paste the bold value over every regular (non bold) value until the next bold value then copy that one and then paste that value over regular values. Hope this explains it a bit better.</p>\n\n<p>Any help would be greatly appreciated</p>\n"},{"tags":["excel","vba","vbscript","userform"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13228146,"title":"Filling Excel userform in excel file automatically from vbscript","body":"<p>I have an Excel file that is full of macro and functions and userforms that help the user to fill the data correctly in this Excel file. I need to write a VBScript that accesses one of the userforms. Fills it automatically. I know how to call a VBA macro that does exist in a workbook.</p>\n\n<pre><code>objExcel.Application.Run\"'CAM0500040F10_SW_Quality_Assurance_Report_Template (05-11-2012).xlsm'!new_document()\"\n</code></pre>\n\n<p>but now I need to be able to fill a userform from my code. is there a way to do that?</p>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":49,"score":-1,"question_id":13226604,"title":"How to handle a pop up in Microsoft Excel using excel macro","body":"<p>I'm want to write an excel macro to handle some pop-up from microsoft excel (click on the OK button or fill in some empty fields).\nI did quite a lot of googling but still couldn't find a way to do so.</p>\n\n<p>Thank in advance!</p>\n"},{"tags":["c#","excel","email","attachment"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":1,"view_count":100,"score":7,"question_id":13223200,"title":"How can I send an Excel file by email?","body":"<p>I have an excel file (Excel 2003 / xls format) and I want to send it by email with c#.\nMy code send it successfully, but when I try to open the response file, it seems to encoded wrongly.</p>\n\n<p>For example here is the response filename:</p>\n\n<blockquote>\n  <p>=_utf-8_B_RWxzesOhbW9sw6FzXzIwMTJfMTBfMTZf.dat</p>\n</blockquote>\n\n<p>And here is the response file itself:</p>\n\n<blockquote>\n  <p>=?utf-8?B?VEdWdmJIWmhjMkZ1Wk1Pelh6UXlYekZmPz0NCiA9P3V0Zi04P0I/VGtW?=\\\n  \\  =?utf-8?B?TlgwZFRXaTU0YkhNPT89?=\" Content-Transfer-Encoding: base64\n  Content-Disposition: attachment</p>\n  \n  <p>0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAA\n  AQAAAAAAAAAAEAAAIwAAAAEAAAD+////AAAAAAAAAAD/////////////////////\n  ////////////////////////////////////////////////////////////////\n  ////////////////////////////// ....</p>\n</blockquote>\n\n<p>Here is my code fragment:</p>\n\n<pre><code>...\nvar attachment = new Attachment(WriteFileToMemory(\"fileFullPath\"), \"fileName.xls\");\nattachment.ContentType = new ContentType(\"application/vnd.ms-excel\");\nattachmentCollection.Add(attachment);\n...\n\n\nprivate Stream WriteFileToMemory(string filePath)\n{\n    var memoryStream = new MemoryStream();\n    _openedStreams.Add(memoryStream);\n    using (var file = new FileStream(filePath, FileMode.Open, FileAccess.Read))\n    {\n        var bytes = new byte[file.Length];\n        file.Read(bytes, 0, (int) file.Length);\n        memoryStream.Write(bytes, 0, (int) file.Length);\n        file.Close();\n    }\n    memoryStream.Position = 0;\n    return memoryStream;\n}\n</code></pre>\n\n<p>How can I set the attachment encoding type, and which encoding should I use with Excel files?</p>\n\n<p>Please help me solve this problem.\nThanks in advance.</p>\n"},{"tags":["excel","excel-vba","macros"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":31,"score":-1,"question_id":13228242,"title":"I Have a Master sheet and i want to copy each row to each different sheets","body":"<p>I Have a Master sheet and i want to copy each row to each different sheets. For example in master sheet , I have 4 cell value in each row and I want to Copy Them to each different sheet , it means A1  copy to G6,B1 copy to N6 and etc.For next row I have a new sheet that i fill with it . It's my problem and I am grateful to resolve my problem.</p>\n"},{"tags":["excel","excel-vba","visual-studio-macros"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13210585,"title":"Multiplying an integer with a currency in Excel VBA","body":"<p>In my excel table i have one row (5th row) as number of items and another (6th row) as the price of the items. For example i want to multiply 200 with $56.50 but I am having a problem with this script. Can anyone please help. </p>\n\n<pre><code>Sub calcprice()\n    Dim i As Integer\n    Dim iRowNumber As Integer   ' Integer to store result in\n    Dim val As Double\n\n    iRowNumber = InputBox(Prompt:=\"Number of Rows\", _\n          Title:=\"Rows: \", Default:=\"# of Rows\")\n    For i = 1 To iRowNumber\n        If Cells(i, 5).Value &gt;= 0 And Cells(i, 6).Value &gt;= 0 And IsEmpty(Cells(i, 5)) = False And IsEmpty(Cells(i, 5)) = False Then\n            val = FormatCurrency(Cells(i, 5).Value) * Cells(i, 6).Value\n            Cells(i, 7).Value = val\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>it says runtime error 13<br>\ntype mismatch\nhere is the image:\n<img src=\"http://i.stack.imgur.com/QMOIW.png\" alt=\"it says currency\"></p>\n\n<p><br><Br>\nHere is the link: <a href=\"https://www.dropbox.com/s/lla2cuz8hqu5qyp/test.xlsm\" rel=\"nofollow\">https://www.dropbox.com/s/lla2cuz8hqu5qyp/test.xlsm</a>\n<Br>also i cannot use the =a*b i have to use macros!</p>\n"},{"tags":["c#",".net","excel","datetime","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12858310,"title":"reading excel fetching date in general format","body":"<p>In the application we have a wizard with multiple tabs. On the first tab we can select a excel sheet path using a browse button. The moment you select the excel, excel file contents are loaded in a dataset (everything in correct format including DATE fields). Then click Next to go to the next wizard tab.</p>\n\n<p>But if the file is open program loads the excel and this time with all the date fields in General format.\neg: 6/22/2006 as 38890</p>\n\n<p>We are trying to find if the excel is open or being used by another format as:</p>\n\n<pre><code>    bool IsFilebeingUsed(FileInfo file)\n    {\n        FileStream stream = null;\n\n        try\n        {\n            stream = file.Open(FileMode.Open, FileAccess.Read, FileShare.None);\n        }\n        catch (IOException)\n        {\n            return true;\n        }\n        finally\n        {\n            if (stream != null)\n                stream.Close();\n        }\n        return false;\n    }\n</code></pre>\n\n<p>The way we are trying to read the excel is as follows:</p>\n\n<pre><code>string sql = string.Format(\"SELECT * FROM [{0}]\", excelSheetName);\ninternal OleDbCommand command = new OleDbCommand();\ncommand.CommandText = sql;\nOleDbDataReader oleRdr = command.ExecuteReader();\n\nDataTable dataTable = new DataTable();\ndatatable.TableName = excelSheetName;\ndataTable.Load(oleRdr);\n</code></pre>\n\n<p>Can anyone tell whats wrong with the application or code?</p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13194757,"title":"error while reading excel file","body":"<p>I am using the below code to get data from excel file. While opening the connection I get the below error. can any one tell me how can I solve this issue?</p>\n\n<p><strong>Request for the permission of type 'System.Data.OleDb.OleDbPermission, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.</strong></p>\n\n<p>Note: ExcelFilePath is the path of excel file stored in local drive.</p>\n\n<pre><code>String connectionString = String.Format(@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=\"\"Excel 8.0;HDR=YES;IMEX=1;\"\"\", ExcelFilePath);\n\n DbProviderFactory factory = DbProviderFactories.GetFactory(\"System.Data.OleDb\");\n\n            DbConnection connection = factory.CreateConnection();\n\n            connection.ConnectionString = connectionString;\n\n            connection.Open(); // GIVES ERROR \n\n            DataTable tbl = connection.GetSchema(\"Tables\");\n\n            connection.Close();\n\n            foreach (DataRow row in tbl.Rows)\n            {\n                //get sheets.\n\n            }\n</code></pre>\n"},{"tags":["c#",".net","excel","connection-string","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12893284,"title":"Reading excel data when the file is open","body":"<p>Few days back I asked a <a href=\"http://stackoverflow.com/questions/12858310/reading-excel-fetchig-date-in-general-format#comment17403185_12858310\">question</a> but could not find enough answers. I analyzed the problem a bit more and decided to create a new thread. If I should have not, let me know or close the question.</p>\n\n<p>I have an <strong>OPEN</strong> excel file with a column in Date format with some values like 6/22/2006, 6/22/2006. I am trying to read the excel using OleDbDataReader. The code is like this:</p>\n\n<pre><code>string sql = string.Format(\"SELECT * FROM [{0}]\", excelSheetName);\ninternal OleDbCommand command = new OleDbCommand();\ncommand.CommandText = sql;\nOleDbDataReader oleRdr = command.ExecuteReader();\n\nDataTable dataTable = new DataTable();\ndatatable.TableName = excelSheetName;\ndataTable.Load(oleRdr);\n</code></pre>\n\n<p>I am using the connection string as:</p>\n\n<pre><code>string connectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\\ExcelData\\sample.xls;Extended Properties='Excel 8.0;HDR=No;IMEX=1'\";\n</code></pre>\n\n<p>The problem is I am not able to read the date values in correct (<code>DateTime</code>) format. I believe everything is treated as numeric format. So my result is</p>\n\n<p><code>6/22/2006 as 38890</code></p>\n\n<p>After reading some articles on internet, I understood my column is having multiple datatypes and then I changed my connection string as:</p>\n\n<pre><code>string connectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\\ExcelData\\sample.xls;Extended Properties=\"Excel 8.0;HDR=No;IMEX=1;ImportMixedTypes=Text;TypeGuessRows=0\"\";\n</code></pre>\n\n<p>But still I am not able to read the excel in correct format. Any suggestions on this. It looks a weird problem to me. Please let me know if I to need to provide some more information.</p>\n\n<p>Note: Also make a note that when my excel file is closed both the connection strings give me the correct data. Also for new doc formats<code>.xlsx</code> we are using <code>Microsoft.ACE.OLEDB.12.0</code>.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I tried editing the registry as well....but no relief.\nBut when I changed the value <code>IMEX = 0</code> or <code>IMEX = 1</code> it is working fine again. Can any one tell the exactly what is happening?</p>\n\n<p><strong>EDIT 2</strong>\nWhen I changed <code>HDR=Yes</code> still everything worked good. Any help please? I could not find enough help on internet.</p>\n"},{"tags":["c#","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":25,"score":-2,"question_id":13227436,"title":"Excel data fetch query syntax","body":"<p>I have an .xlsx file with 15 columns from A to O. I can fetch the all data with a simple query;  OleDbCommand cmd = new OleDbCommand(\"SELECT *\" + \"FROM [Sheet1$]\", conn);</p>\n\n<p>Here is my problem ; I have missing datas all over the excel sheet and these are marked with '?' and spread randomly. I don't want to fetch the row even one attribute of the row is '?'. I tried ;</p>\n\n<pre><code>OleDbCommand cmd = new OleDbCommand(\"SELECT  [A],[B],[C],[D],[E],[F],[G],[H],[I],[J],[K],[L],[M],[N],[O]\" + \"FROM [Sheet1$]\" +  \n               \"Where A != ' ?' and B != ' ?' and C != ' ?' and D != ' ?' and E != ' ?' and F != ' ?' and G != ' ?' and H != ' ?' and I != ' ?' and J != ' ?' and K != ' ?' and L != ' ?' and M != ' ?' and N != ' ?' and O != ' ?'\", conn);\n</code></pre>\n\n<p>But I got the error : </p>\n\n<p>Syntax error (missing operator) in query expression.</p>\n\n<p>Can anyone help me with this ?</p>\n\n<p>Thank you.</p>\n"},{"tags":["excel","sandbox-solution"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13227021,"title":"Error while opening the OleDbConnection for reading excel file","body":"<p>I am using the code below to read data from excel file using OleDbConnection. But while opening the connection i get the error  \"Request for the permission of type 'System.Data.OleDb.OleDbPermission, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.\"  i am executin this code in sharepoint sandboxed solution (VS2010)</p>\n\n<pre><code> public void OpenExcelFile()\n    {\n        fileName = @\"E:\\Docs\\ExcelFiles\\Book1.xlsx\";\n        //open the excel file using OLEDB\n        OleDbConnection con;\n\n        connectionString = \"Provider=Microsoft.ACE.OLEDB.4.0;Data Source=\" +\n              fileName + \";Extended Properties=Excel 8.0;\";\n\n        con = new OleDbConnection(connectionString);\n        con.Open(); //**Gives ERROR**\n        //get all the available sheets\n        System.Data.DataTable dataSet = con.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);\n        //get the number of sheets in the file\n        workSheetNames = new String[dataSet.Rows.Count];\n        int i = 0;\n        foreach (DataRow row in dataSet.Rows)\n        {\n            //insert the sheet's name in the current element of the array\n            //and remove the $ sign at the end\n            workSheetNames[i] = row[\"TABLE_NAME\"].ToString().Trim(new[] { '$' });\n            i++;\n        }\n        if (con != null)\n        {\n            con.Close();\n            con.Dispose();\n        }\n        if (dataSet != null)\n            dataSet.Dispose();\n    }\n</code></pre>\n"},{"tags":["java","excel","apache-poi","pivot-table","smartxls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13226694,"title":"Design API for Create Pivot in Excel Using Java","body":"<p>I am Java Developer and I want to design Java API for creating a Pivot Table in Excel. However, I am stuck how would I create one? Does anybody have an idea about how to design Java API for creating a Pivot Table in Excel. I am familiar with POI, SmartXLS APIs, but POI doesn't provide any method for creating Pivot Table in Excel and SmartXLS is costs money. So please help.</p>\n"},{"tags":["c#","excel","powerpoint","openxml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":19,"score":-2,"question_id":13226550,"title":"Charts from Excel to PPT using OpenXML and C#","body":"<p>How to read a chart in an Excel Sheet and then write it to a slide in PPT using OpenXML and C# ?</p>\n"},{"tags":["excel","dropdownbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13226228,"title":"Excel drop down list value","body":"<p>been tinkering with Excel and have a few question.</p>\n\n<p>I have a Drop down list and I able to do that. I know that the list came from a group cell. what I want to do, lets say the drop down is a product list with a designation price in the next column. I want to get the price. How do I do get the price?</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","tfs2010","add-in"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":12255981,"title":"Team tab is removed every time Excel 2010 is opened","body":"<p>Using <strong>Excel 2010</strong> and <strong>TFS 2010</strong>. I've been using the \"Team\" tab in Excel for quite a while now (very useful!). Today, the \"Refresh\" took ages and I couldn't use Excel so I killed the process in Task Manager. I reopened Excel and the Team tab was missing. I added it back in <strong>File</strong> > <strong>Options</strong> > <strong>Add Ins</strong> > <strong>Manage COM Add Ins</strong> > Go > selected the <strong>Team Foundation Add-In</strong>  and the <strong>Team</strong> tab is back. I can create/view lists etc. However, when I close and reopen Excel the <strong>Team</strong> tab is missing again. </p>\n\n<p>How do I make the <strong>Team</strong> tab stay on the ribbon bar even when closing &amp; reopening Excel?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13222885,"title":"How to use combo box input to select work sheet to copy data to in excel vba","body":"<p>I think this is a simple question but as I haven't used excel in this way before I am struggling. I am trying to create a program based in Excel VBA. I work in a call center. We have numerous excel sheets to log calls for different schemes. I have a project to streamline this process. So far I have created a workbook that has separate sheets named to represent each scheme. I have created a userform to gather information. One of the combo boxes indicates which scheme the call is in regards to. The input from the userform needs to be logged on to a sheet in the work book that corresponds to the name of the scheme selected in the combo box. I cant seem to get this close to working. Any suggestions or advice would be greatly appreciated!</p>\n\n<p>The code I have is: </p>\n\n<pre><code>Private Sub cmdClear_Click()\nCall UserForm_Initialize\nEnd Sub\n\n\nPrivate Sub cmdClose_Click()\nUnload Me\nEnd Sub\n\n\nPrivate Sub ComboBox1_Change()\nDim ShtName As String\nShtName = ComboBox1.List(ComboBox1.ListIndex)\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nCall Add_Data\nEnd Sub\n\nPrivate Sub Add_Data()\nDim Worksheets As Range\nDim ws As Worksheet\nDim UserForm As Object\nDim iRow As Long\n\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\nSet ws = this.ComboBox1.GetItemText(this.ComboBox1.SelectedItem)\n\n\n'find first empty row in database\niRow = ShtName.Cells(Rows.Count, 1).End(x1up).Offset(1, 0).Row\n\n'copy the data to the database\nws.Cells(iRow, 1) = Date\nws.Cells(iRow, 2) = Me.txtName.Value\nws.Cells(iRow, 3) = Me.txtNumber.Value\nws.Cells(iRow, 4) = ComboBox2.Value\nws.Cells(iRow, 5).Value = Me.txtQuery.Value\n\nIf optYes = True Then\n        msgstr = \"Yes\"\n    ElseIf optNo = True Then\n        msgstr = \"No\"\n\nEnd If\n\nws.Cells(iRow, 6).Value = msgstr\n\n\n\nIf chkMain = True Then\n        msgstri = \"Main\"\n    ElseIf chkExec = True Then\n        msgstr = \"Exec\"\n     Else\n        msgstri = \"\"\n\nEnd If\n\nws.Cells(iRow, 7).Value = msgstri\nws.Cells(iRow, 8).Value = Me.txtTime.Value\n\n\n\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nComboBox1.Clear\nComboBox1.AddItem (\"Sheet2\")\nComboBox1.AddItem (\"Sheet3\")\nComboBox1.AddItem (\"Sheet4\")\nComboBox1.AddItem (\"Sheet5\")\nComboBox1.AddItem (\"Sheet6\")\nComboBox1.AddItem (\"Sheet7\")\nComboBox1.AddItem (\"Sheet8\")\nComboBox1.AddItem (\"Sheet9\")\nComboBox1.AddItem (\"Sheet10\")\nComboBox1.AddItem (\"Sheet11\")\nComboBox1.AddItem (\"Sheet12\")\n\nComboBox2.Clear\nComboBox2.AddItem (\"agent1\")\nComboBox2.AddItem (\"agent2\")\nComboBox2.AddItem (\"agent3\")\nComboBox2.AddItem (\"agent4\")\nComboBox2.AddItem (\"agent5\")\nComboBox2.AddItem (\"agent6\")\nComboBox2.AddItem (\"agent7\")\nComboBox2.AddItem (\"agent8\")\nComboBox2.AddItem (\"agent9\")\nComboBox2.AddItem (\"agent10\")\n\ntxtNumber.Value = \"\"\ntxtName.Value = \"\"\ntxtQuery.Value = \"\"\ntxtTime.Value = \"\"\n\noptYes = False\noptNo = False\nchkMain = False\nchkExec = False\n\nComboBox1.SetFocus\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","reference","macros","invalid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":12162038,"title":"Excel VBA Custom Function giving \"Reference Not Valid\" Error","body":"<p>I've attempted to track down and solve this error for hours now and I just can't figure it out. Here's the setup.</p>\n\n<p>I have one excel workbook which has two sheets in it: \"Input\" and \"Calculations\". I've written in a few custom functions to calculate certain things. These functions are used in the \"Calculations\" sheet, but reference cells in the \"Input\" sheet. Now if I'm just using the sheet itself everything works perfectly fine and the functions work.</p>\n\n<p>However, I have a second excel workbook which interacts with the first. I have a macro in the second workbook which attempts to define values in the \"Input\" sheet of the first workbook. However, when it does this, suddenly the functions don't work. When I attempt to trace the error of the cell in the \"Calculations\" sheet, and attempt to go to the cell in \"Input\" sheet, it claims the reference is invalid.</p>\n\n<p>I have no idea what the problem is. At first I thought it maybe had something to do with the name of the first workbook (which was \"Log K Calculator 7.0.0.xlsm\") but I've tried changing that and I get the same problem. Here is the macro in the second sheet which attempts to change the values in the first:</p>\n\n<pre><code>Sub macro()\n\nDim logK As String\nDim this As String\nlogK = \"Log K Calculator 7.0.0.xlsm\"\nthis = ThisWorkbook.Name\n\nWorkbooks(logK).Activate\n\nWorkbooks(logK).Sheets(\"Input\").Cells(11, 4).Value = Workbooks(this).Sheets(1).Cells(1,   \"B\").Value\nWorkbooks(logK).Sheets(\"Input\").Cells(12, 4).Value = Workbooks(this).Sheets(1).Cells(2, \"B\").Value\nWorkbooks(logK).Sheets(\"Input\").Cells(14, 4).Value = Workbooks(this).Sheets(1).Cells(3, \"B\").Value\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13223714,"title":"How to get Querytables result to land on the same sheet","body":"<p>I'm pulling data from a site that limits the presentation of the data to 75 lines at a time, when some of the data sets contain 100 records<br>\n(Why is there never an option for ALL RECORDS)?<br></p>\n\n<p>I could arrange my loop to just create a new sheet, but this would add more work <br>since I would have to click through up to 50 sheets to join the sheets into one.<br></p>\n\n<p>So far my script pulls the data, and I set a counter to offset the placement of the <br>\nresults so nothing gets overwritten. However, after the script completes I end up with <br>\nin one case 1500 blank rows and then the last few rows of the dataset. So basically I get the last 75 rows or so (3 in one case) of 1000 element datasets<br>\nNot sure what I'm missing here. Does Querytables always place the link data in $A$1?<br></p>\n\n<p>The code:</p>\n\n<pre><code>Sub getHistoricalData()\nDim sheetname As String, url As String\nDim x_wsnames As Range\nDim ws As Worksheet, destinationRange As Range\nDim fillRange As Range, cell As Range, startCell As Range, endCell As Range\nDim operationalRange As Range, max As Integer\nDim last_objid As Integer, m As Integer\nDim startPage As Boolean, divider As String\nOn Error Resume Next\n\nFor Each x_wsnames In Sheets(\"data\").Range(\"B2:B11\")\n'url = x_wsnames.Offset(0, 2).Value\nmax = x_wsnames.Offset(0, 2).Value\nsheetname = x_wsnames.Value\n'  Sheets.Add.Name = sheetname\nSheets(sheetname).Select\n  Set ws = Sheets(sheetname)\n  Select Case sheetname\n    Case \"A\"\n         position = \"one\"\n    Case \"B\"\n        position = \"two\"\n    Case \"C\"\n        position = \"three\"\n    Case \"D\"\n    position = \"four\"\n  Case \"E\"\n    position = \"five\"\n  Case \"F\"\n    position = \"six\"\n   Case \"G\"\n    position = \"seven\"\n  Case \"H\"\n    position = \"eight\"\n  Case \"I\"\n    position = \"nine\"\n  Case \"J\"\n    position = \"ten\"\nEnd Select\nDebug.Print \"Processing cycleThroughWorksheets() \" &amp; sheetname\n\nm = 0\nFor i = 1 To max\n   url = \"http://dataplace/search?category=type&amp;dataType=historical&amp;locations=ALL&amp;d-112233-w=\" &amp; i &amp; \"&amp;filter=\" &amp; divider\n\n'Debug.Print i, url\nIf i = 1 Then\n    Set destinationRange = Range(\"$A$1\")\n    Debug.Print destinationRange.Address\nElse\n    m = m + 75\n    Set destinationRange = Range(\"$A$\" &amp; m)\n    Debug.Print destinationRange.Address\nEnd If\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;\" &amp; url, destination:= _\n    destinationRange)\n    .Name = sheetname\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlEntirePage\n    .WebFormatting = xlWebFormattingNone\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\nNext\n\n\nNext \nEnd Sub\n</code></pre>\n"},{"tags":["excel","powerpivot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13190369,"title":"PowerPivot to list data values instead of summarising","body":"<p>Just starting with MS PowerPivot.  I am trying to create a pivot showing the list of responses to questions in a survey, but am falling over where the powerpivot wants a 'Summarize by' value for the pivoted responses.</p>\n\n<p>In a sql query to return these data I would use max(AnswerComment) (as there will only be one answer per respondent per question). However, when I select Max as the Summarize by values, PowerPivot returns:  ERROR - CALCULATION ABORTED: Calculation error in measure 'Answer'[Maximum of AnswerComment]' and then explains that only numbers or dates (and not Strings) can be 'MAX'ed.</p>\n\n<p>Is there a way of listing pivoted data (rather than performing a summary calculation on it)?  If not, is there a summary function that PowerPivot accepts for string types?</p>\n\n<p>thx\nmcalex</p>\n"},{"tags":["excel","variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1159,"score":0,"question_id":7125046,"title":"How do I insert a variable worksheet name into multiple excel formulas?","body":"<p>I'm trying to setup an excel sheet that will have a drop down box in a cell at the top which will contain different worksheet choices that are available from my workbook.  Once I choose a worksheet, I need this worksheet name to be referenced in many different excel formulas within this sheet.  </p>\n\n<p>Ex:</p>\n\n<pre>\nChoose an Application Group Filter:  *Drop Down Choices* Recap Filter\n                                                         PB Filter\n                                                         Membership Filter\n</pre>\n\n<p>Formula:</p>\n\n<pre><code>=COUNTIF('DropDownChoice'!AA:AA, 8)\n</code></pre>\n\n<p>I also want to have multiple worksheets that have this drop down box available at the top.\nIs this possible?</p>\n"},{"tags":["java","excel","api","jxl","autofilter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13222208,"title":"How to add AutoFilter to Excel Cell with jxl java jar","body":"<p>Does anyone know how to add <strong>autofilter</strong> to a <strong>cell</strong> in excel using <strong>jxl</strong>? I can't quite figure it out.\nAny and all help with be appreciated.. thanks!</p>\n"},{"tags":["c#","winforms","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12769832,"title":"Datagridview to a specific excel cell","body":"<p>I got 2 datgridviews, trying to copy the header and it values to a excel sheet. The first loop is working fine for the first datagirdview</p>\n\n<pre><code>for (int i = 1; i &lt; dataGridView1.Columns.Count + 1; i++)\n            {\n                worksheet.Cells[7, i] = dataGridView1.Columns[i - 1].HeaderText;\n            }\n\n\n\n            // storing Each row and column value to excel sheet\n            for (int i = 0; i &lt; dataGridView1.Rows.Count - 1; i++)\n            {\n                for (int j = 0; j &lt; dataGridView1.Columns.Count; j++)\n                {\n                    worksheet.Cells[i + 8, j + 1] = dataGridView1.Rows[i].Cells[j].Value.ToString();\n                }\n            }\n</code></pre>\n\n<p>This is the second datagridview and I'm trying to copy the header and it's values.</p>\n\n<p>The first datagridview header values finished at 7nth row cell <code>D7</code>and the row values finished at 8th row cell <code>D8</code>. </p>\n\n<p>I want to put the second datagridview header from <code>E7</code> of 7nth row and the row values from <code>E8</code> of 8th row.</p>\n\n<pre><code>//Primary Continuation\n        for (int i = 7; i &lt; dataGridView2.Columns.Count + 1; i++)\n        {\n            worksheet.Cells[7, i] = dataGridView2.Columns[i - 1].HeaderText;\n        }\n\n\n\n        // storing Each row and column value to excel sheet\n        for (int i = 0; i &lt; dataGridView2.Rows.Count - 1; i++)\n        {\n            for (int j = 0; j &lt; dataGridView2.Columns.Count; j++)\n            {\n                worksheet.Cells[i + 8, j + 1] = dataGridView2.Rows[i].Cells[j].Value.ToString();\n            }\n        }\n</code></pre>\n"},{"tags":["excel","excel-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13219177,"title":"Is it possible to combine AND() and OR() in Excel formulae","body":"<p>Is there an easy way to combine AND() and OR() within Excel formulae. IE: </p>\n\n<pre><code>IF(OR(AND(A2=\"\",B2=\"\"),AND(A2=\"(blank)\",B2=\"(blank)\")),\"BLANK\",\"NOT BLANK\")\n</code></pre>\n\n<p>Or do you need to use nesting to achieve the same end goal?</p>\n"},{"tags":["vb.net","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13219934,"title":"Pending File List using Excel","body":"<p>We have a system to monitor the file movement in our small office. In sheet 1, we have File No, Date of Receipt, From whom it received, Description, Date of Dispatch/Cleared, To whom it sent.</p>\n\n<p>I want to sort out the Pending Files in Sheet2. I want the sheet2 should update when I change the time in A1 (=NOW()). It should show first 4 items of above. </p>\n\n<p>Pls tell me any Excel Formula or VB coding.</p>\n"},{"tags":["sql-server-2005","excel","reporting-services","export"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3285,"score":2,"question_id":393669,"title":"Disabling or overriding the excel and pdf export function in Reporting Services","body":"<p>Is there a way to disable or override the excel and pdf export function in SQL Server Reporting Services. I want to my own custom excel export.</p>\n"},{"tags":["excel","vba","excel-vba","timer","excel-2003"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":730,"score":4,"question_id":4876300,"title":"Timed Alarm in Excel VBA","body":"<p>I made a calendar to track tasks and similar items in Excel 2003.\nWhat I need to be able to do is to set a timer via VBA. Something like this:</p>\n\n<pre><code>run_in_x_secs ( timetowait, function to exec)\n</code></pre>\n\n<p>Is there a way to do that in excel vba, or should I try and find an alarm to run via the command line and run that from VBA.</p>\n\n<p>How would you do it?</p>\n"},{"tags":["excel","fortran"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13217778,"title":"Is it possible to link excel with fortran?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1622790/how-do-i-get-my-fortran-output-into-excel\">How do I get my fortran output into excel?</a><br>\n  <a href=\"http://stackoverflow.com/questions/9551902/how-to-read-output-from-excel-file-into-fortran\">How to read output from Excel file into Fortran?</a>  </p>\n</blockquote>\n\n\n\n<p>I just wonder if there is any way to write a code to link data from Fortran to plot graphs on excel?</p>\n\n<p>I have been reading through the basic text for Fortran but there isnt any examples to assist me in writing such code.</p>\n\n<p>Thank you in advance for help.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2638,"score":4,"question_id":9800808,"title":"How to sum columns for a selected range using VBA?","body":"<p>After I have selected a range containing numerical values, I want to, via VBA, input a <code>=SUM</code> formula at the bottom of each column, i.e. on the row after the last selected row. For each column it should sum all of the values in the corresponding column of the entire selection. </p>\n\n<p>How can I do this?</p>\n\n<p>Right now, I'm using the code given by the macro recorder: <code>ActiveCell.FormulaR1C1 = \"=SUM(R[-10]C:R[-1]C)\"</code>. The problem is when my range gets bigger than 10 rows it will not the rows above the bottom 10 into consideration.</p>\n\n<p><img src=\"http://i.stack.imgur.com/qv2UK.png\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":84,"score":7,"question_id":13179138,"title":"#VALUE! errors after setting displayed outline level from VBA","body":"<p>I have reduced my problem to the following test case:</p>\n\n<ol>\n<li><p>create a new workbook;</p></li>\n<li><p>enter a constant value, e.g. <code>123</code> into <code>Sheet1!A1</code>;</p></li>\n<li><p>define a name, e.g. <code>foo</code>, that refers to the formula <code>=CHOOSE(!$A$1, Sheet1!$A$1)</code>;</p></li>\n<li><p>enter the constant value <code>1</code> into <code>Sheet2!A1</code>;</p></li>\n<li><p>enter the formula <code>=foo</code> into some other cell on <code>Sheet2</code>, e.g. <code>Sheet2!B1</code>: observe that, as expected, the result is the value that was entered into <code>Sheet1!A1</code> in step 2 above;</p></li>\n<li><p>create then run a VBA procedure containing the following code:</p>\n\n<pre><code>Sheets(\"Sheet1\").Outline.ShowLevels 1\n</code></pre></li>\n</ol>\n\n<p>You will notice that the cell from step 5 now contains a <code>#VALUE!</code> error.</p>\n\n<p>Moreover, a simple sheet recalculation (whether using the <kbd>F9</kbd> key or the <code>Application.Calculate</code> method) does not resolve the problem: one must instead perform either a <em>full</em> recalculation from VBA (using the <code>Application.CalculateFull</code> method) or else a <em>full rebuild</em> from the interactive UI (using the <kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>SHIFT</kbd>+<kbd>F9</kbd> key combination).</p>\n\n<p>Through trial-and-error, I have ascertained that for this condition to arise:</p>\n\n<ul>\n<li><p>the <code>CHOOSE()</code> index argument must involve a relative-sheet cell reference (not constants or absolute-sheet references);</p></li>\n<li><p>the <code>CHOOSE()</code> value argument that is being indexed must involve a reference to another sheet;</p></li>\n<li><p>the change of displayed outline level must arise from within a VBA <em>procedure</em> (not from the outline controls in the interactive UI or the VBA Immediate Window); and</p></li>\n<li><p>the <code>ShowLevels</code> method call (whose arguments are irrelevant) must be applied to a sheet that is referenced amongst any of the value (though not index) arguments to <code>CHOOSE()</code>.</p></li>\n</ul>\n\n<p>What's going on?</p>\n\n<p>I would very much like to collapse a worksheet that I am referencing amongst the value arguments to <code>CHOOSE()</code> to its highest outline level without triggering this error, as a full recalculation of my actual workbook (still only a few seconds) is undesirable from a UX standpoint.</p>\n\n<p>Suggestions for a workaround (whilst still using a defined name containing the <code>CHOOSE()</code> function together with a relative-sheet index argument) would be most welcome!</p>\n\n<p>My platform: Excel 2010 (14.0.6123.5001, 32-bit) on Windows 7 Home Premium (SP1, 64-bit).</p>\n"},{"tags":["excel","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":674,"score":2,"question_id":12259595,"title":"Load csv file into a VBA array rather than Excel Sheet","body":"<p>I am currently able to enter csv file data into Excel VBA by uploading the data via the code below then handling the table, surely not the best way as I am only interested in some of the data and delete the sheet after using the data:</p>\n\n<pre><code>Sub CSV_Import() \nDim ws As Worksheet, strFile As String \n\nSet ws = ActiveSheet 'set to current worksheet name \n\nstrFile = Application.GetOpenFilename(\"Text Files (*.csv),*.csv\", , \"Please selec text file...\") \n\nWith ws.QueryTables.Add(Connection:=\"TEXT;\" &amp; strFile, Destination:=ws.Range(\"A1\")) \n     .TextFileParseType = xlDelimited \n     .TextFileCommaDelimiter = True \n     .Refresh \nEnd With \nEnd Sub \n</code></pre>\n\n<p>Is it possible to simply load the csv into a two dimensional variant array in VBA rather than going through the use of an excel worksheet?</p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2401,"score":0,"question_id":3003349,"title":"Reduce the file size of Excel","body":"<p>I'm working in an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> application and providing a menu to the user to add a new worksheet in that excel application (Excel Workbook).</p>\n\n<p>The worksheet will be added once the user clicks the \"OK\" button and I'm using a template to add this worksheet (The template has lot of formatting and formulas in it)</p>\n\n<p>Lets say the file size is 10 MB after adding a worksheet if the workbook is saved. Then I close the Excel application and reopen it and save the file then the file size is getting reduced to 8 MB.</p>\n\n<p>Can anybody let me know what could be the reason for the same?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12250110,"title":"Using a class as argument of a custom worksheet function","body":"<p>I want to write a custom worksheet function that uses a class that I have defined as argument. I have tried to do the following:</p>\n\n<p>I created a class named Wrapper:</p>\n\n<pre><code>Private m_value As Integer\n\nPublic Property Get value() As Integer\n  value = m_value\nEnd Property\n\nPublic Property Let value(value As Integer)\n  m_value = value\nEnd Property\n</code></pre>\n\n<p>Then I wrote two functions:</p>\n\n<pre><code>Function make_wrapper(value As Integer) As wrapper\n  Set make_wrapper = New wrapper\n  make_wrapper.value = value\nEnd Function\n\nFunction square(wrapper As wrapper) As Integer\n  square = wrapper.value * wrapper.value\nEnd Function\n</code></pre>\n\n<p>If I chain those function directly from VBA, everything works as I expected</p>\n\n<pre><code>Sub doit()\n  MsgBox (square(make_wrapper(7)))\nEnd Sub\n</code></pre>\n\n<p>displays 49.</p>\n\n<p>If I try to call the function directly from excel it does not work. If I type \"=square(make_wrapper(7))\" in a cell, it displays \"#VALUE!\". What am I doing wrong? Is this possible at all? </p>\n"},{"tags":["string","excel","excel-vba"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":602,"score":3,"question_id":8934184,"title":"Excel VBA: Build a Comma Delimited String","body":"<p>I want to build a comma delimited string from Range <code>A1:A400</code>. </p>\n\n<p>What is the best way of doing this? Should I use a for loop?</p>\n"},{"tags":["jquery","html","excel","webpage"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13216816,"title":"embed excel sheet in web page","body":"<p>I want to have a spreadsheet like functionality on my web page. I am looking forward for following features:\n1) Each cell of spreadsheet should be editable.\n2) It should allow calculations.\n3) When saved , data should be saved into database.\n4) Preferably open source without any licensing issues.</p>\n\n<p>Please suggest me what can I use to achive it?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":45,"score":1,"question_id":13182802,"title":"Compare two cells with the same word variant","body":"<p>Can anyone help me with an excel formula to look whether one cell with a string of text is the same compare to other cell with the same string of text but in different position/placement.</p>\n\n<p>please see below for example:</p>\n\n<p>cell A1: <code>apple orange grape</code></p>\n\n<p>cell A2: <code>orange grape apple</code></p>\n\n<p>I need a formula to check if <code>A1</code> is the same or not to <code>A2</code></p>\n\n<p>thanks</p>\n"},{"tags":["excel","vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13200187,"title":"VBA help - inserting data lines in excel 2012","body":"<p>Have the following snippet of data</p>\n\n<pre><code>Bank       Address      City      State Zip     Product Effective Date\nBank 1     Address 1    Plano     TX    75024   Auto    08/01/1997\nBank 2     Address 2    Granbury  TX    76048   Flood   01/17/2000\n</code></pre>\n\n<p>Am trying to program for excel to \"create\"\" subsequent lines of data - insert data rows based on the following logic.\n(1) at each bank name change add \"duplicate' rows of data BUT iterate the effective date by year until 2012....in other words i would like excel to create new lines of data (by year) up until the 2012 year date....best represented by data below:the effective date </p>\n\n<pre><code>Bank    Address     City    State   Zip Product Effective Date\nBank 1  Address 1   Plano   TX  75024   Auto    08/01/1997\nBank 2  Address 2   Plano   TX  75025   Auto    08/01/1998\nBank 3  Address 3   Plano   TX  75026   Auto    08/01/1999\nBank 4  Address 4   Plano   TX  75027   Auto    08/01/2000\nBank 5  Address 5   Plano   TX  75028   Auto    08/01/2001\nBank 6  Address 6   Plano   TX  75029   Auto    08/01/2002\nBank 7  Address 7   Plano   TX  75030   Auto    08/01/2003\nBank 8  Address 8   Plano   TX  75031   Auto    08/01/2004\nBank 9  Address 9   Plano   TX  75032   Auto    08/01/2005\nBank 10 Address 10  Plano   TX  75033   Auto    08/01/2006\nBank 11 Address 11  Plano   TX  75034   Auto    08/01/2007\nBank 12 Address 12  Plano   TX  75035   Auto    08/01/2008\nBank 13 Address 13  Plano   TX  75036   Auto    08/01/2009\nBank 14 Address 14  Plano   TX  75037   Auto    08/01/2010\nBank 15 Address 15  Plano   TX  75038   Auto    08/01/2011\nBank 16 Address 16  Plano   TX  75039   Auto    08/01/2012\nBank 2  Address 2   Granbury    TX  76048   Flood   01/17/2000\n</code></pre>\n"},{"tags":["java","excel","jxl"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13217109,"title":"Copying data with format from one excel to another using jxl","body":"<p>I tried copying data from one excel sheet to another, but my data is getting trimmed and the format is not the same as the copied. I need the exact format to be copied, as I have to reuse the cell contents to insert into DB.</p>\n\n<p>The code to copy looks like this:</p>\n\n<pre><code>String cell = excelSheet.getCell(col, r).getContents().trim();\n</code></pre>\n\n<p>How to copy the cells keeping the original cell format?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":419,"score":0,"question_id":9848123,"title":"Changing X axis scale in Excel","body":"<p>I have a X-Y scatter plot, my values in the x axis starts from the value 30.</p>\n\n<p>How can i change the scale in the chart in such a way that I have values in the X axis starting from 30 and not zero?</p>\n"},{"tags":["excel","visual-c++","exception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13216651,"title":"Exception on writing in cells in Excel file in VC++","body":"<p>I am trying to create a.xlsx (Excel File) using VC++.\nMy code is..</p>\n\n<pre><code>#define MyExcel   Microsoft::Office::Interop::Excel\n\n\n\nMicrosoft::Office::Interop::Excel::Application^ exApp = gcnew Microsoft::Office::Interop::Excel::ApplicationClass();\n Workbook^   exWb  = exApp-&gt;Workbooks-&gt;Add(Type::Missing);\n MyExcel::Worksheet^ worksheet;\nexWb = exApp-&gt;Workbooks-&gt;Open(\"D:\\\\VC\\\\CreateExelFile\\\\CreateExelFile\\\\a.xlsx\",\n                        Type::Missing, Type::Missing, Type::Missing, Type::Missing,\n    Type::Missing, Type::Missing, Type::Missing, Type::Missing,\n    Type::Missing, Type::Missing, Type::Missing, Type::Missing,\n    Type::Missing, Type::Missing);  \n\n    ((MyExcel::Range^ )worksheet-&gt;Cells[\"1\", \"A\"])-&gt;Value2 = \"k\";// Exception is showing here.\n\n\n                  // Show the Workbook\n                  exApp-&gt;Visible = true;\n                  exWb-&gt;Save();\n                   exWb-&gt;Close(false, Type::Missing, Type::Missing);\n                    //exApp-&gt;Quit();\n                     exApp= nullptr;\n</code></pre>\n\n<p>But when i am writing in cells it is showing exception.\nException is...</p>\n\n<pre><code>System.NullReferenceException: Object reference not set to an instance of an object.\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":237,"score":4,"question_id":7445723,"title":"Excel forms: identify unused code","body":"<p>I am updating an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> app written by someone else (of course :)</p>\n\n<p>I found lots of unused <code>Sub CommandButtonXX_Click()</code> subs, and I am not always sure if the button still exists. Is there a way (program, VBE interface, external tool) to do some cleanup while avoiding to delete the <em>still in use</em> code ?   </p>\n\n<p>The list at the top of the properties box does seem to be reliable, since it is kind of <em>context sensitive</em>: if you're in a tab, it displays only items of that tab.</p>\n"},{"tags":["arrays","excel","vba","excel-vba"],"answer_count":7,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":270,"score":8,"question_id":12921350,"title":"Is it possible to fill an array with row numbers which match a certain criteria in Excel VBA without looping through them?","body":"<p>I would like to fill an array in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> with the row numbers of only rows which meet a certain criteria. I would like the fastest method possible (for example, something like <code>RowArray = index(valRange=valMatch).row</code>)</p>\n\n<p>Below is the code for the (slow) range loop. </p>\n\n<p><strong><code>Current Code</code></strong></p>\n\n<pre><code>Sub get_row_numbers()\n\nDim RowArray() As Long\nDim valRange As Range\nDim valMatch As String\n\nSet valRange = ActiveSheet.Range(\"A1:A11\")\nvalMatch = \"aa\"\nReDim RowArray(WorksheetFunction.CountIf(valRange, valMatch) - 1)\n\nFor Each c In valRange\n    If c.Value = valMatch Then RowArray(x) = c.Row: x = x + 1\nNext c    \nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":392,"score":1,"question_id":8427159,"title":"Copy the Absolute value of an Excel Worksheet Cell (instead of the Formula)","body":"<p>I have a worksheet, on which I am using a macro to create a graph. As the data is scattered across various worksheets in the workbook, I am copying the same and creating a continuous set of columns to use for the creation of the graph:</p>\n\n<pre><code>Sheets(\"Data1\").Range(\"A29:A39\").Copy Destination:=Sheets(\"Chart\").Range(\"AA29:AA39\")\nSheets(\"Data2\").Range(\"D29:D39\").Copy Destination:=Sheets(\"Chart\").Range(\"AB29:AB39\")\nSheets(\"Data3\").Range(\"I29:I39\").Copy Destination:=Sheets(\"Chart\").Range(\"ACI29:AC39\")\nSheets(\"Data3\").Range(\"D129:D139\").Copy Destination:=Sheets(\"Chart\").Range(\"AD29:AD39\")\n</code></pre>\n\n<p>My data looks like this:</p>\n\n<pre><code>CustomerA            489 456 93%\nCustomerB            63  0   0%\nCustomerC            123 123 100%\nCustomerD            185 172 93%\n</code></pre>\n\n<p>The above are the values I wish to get in the newly copied cells, not how they were calculated using formulas. I am using the above <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> for this work.</p>\n\n<p>How can I get the absolute values, instead of the relative formulas in my newly copied worksheet cells?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":959,"score":0,"question_id":8255222,"title":"How to Make a particular Cell Required in Excel 2010","body":"<p>Hi all i will give an <code>Excel Document</code> for the user with some basic information as follows</p>\n\n<p><img src=\"http://i.stack.imgur.com/EEGtp.jpg\" alt=\"enter image description here\"></p>\n\n<p>Now if the user leaves a cell which is required i would like to prompt him a message saying that it is a required value with in the excel.</p>\n\n<p>I have referred to <a href=\"http://www.ehow.com/how_7497735_make-cell-required-excel-2007.html\" rel=\"nofollow\">some articles</a></p>\n\n<p>But i am unable to achieve what I required so can any one help. Also I would like to know is it possible to apply <code>Regular expression validators</code> with in the <code>Excel</code>. Something like <code>Date format</code> should be <code>mm/dd/yyyy</code> and <code>SSN</code> should be <code>9 digited</code> like that..</p>\n\n<p>I tried some thing like but this didn't prompt me any <code>error or Dialog</code></p>\n\n<pre><code>Private Sub Worksheet_BeforeSave(Cancel As Boolean)\nIf Sheet1.Range(\"A3:B3\").Value = \"\" Then\nApplication.EnableEvents = True\nMsgBox \"Cannot print until required cells have been completed!\"\nCancel = True      \nEnd If   \nEnd Sub\n</code></pre>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":7551549,"title":"HLOOKUP over several columns returns nothing else then N/A","body":"<p>I am very familiar with <code>VLOOKUP</code> in <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a>, but <code>HLOOKUP</code> seems not as easy to master as its vertical pendant. Here is a very simple case I can' solve by myself:\n<a href=\"http://dl.dropbox.com/u/3224566/Book1.xlsx\" rel=\"nofollow\">http://dl.dropbox.com/u/3224566/Book1.xlsx</a></p>\n\n<p>I don't understand what is wrong with that kind of formula use, but I would really need to expend that one to a series of rows (thus I can' transpose that set of data to workaround my issue with <code>VLOOKUP</code>!)</p>\n\n<p>Thanks in advance for your help and best regards</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":258,"score":1,"question_id":8321324,"title":"Adding to a formula in cell without deleting formula","body":"<p>Let's say cell A5 has the following formula in it: <code>=SUM(A1:A5)</code></p>\n\n<p>I want to use VBA add 1 to this formula to make it <code>=SUM(A1:A5) + 1</code></p>\n\n<p>I have tried <code>Range(\"A5\") = Range(\"A5\") + 1</code> but this has just changed it a hard coded number rather than a formula + 1. How can I approach this problem?</p>\n\n<p>Thanks for the help!</p>\n"},{"tags":["excel","excel-formula","formulas"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":434,"score":1,"question_id":8587474,"title":"Excel: How to roundup a number to the closest ten?","body":"<p>Probably the title is not very suggestive.</p>\n\n<p>Let me explain you with an example. I have:</p>\n\n<pre><code>12345.6 \n2345.1\n12345.00000001\n</code></pre>\n\n<p>I want those numbers to be roundup to <code>12350</code>.<br>\nHow can I do this? </p>\n\n<p>If possible, I would rather use formulas instead of VBA.</p>\n"},{"tags":["excel","excel-vba","named-ranges"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":272,"score":1,"question_id":11561421,"title":"how to get the value of a defined name in another workbook, using vba for excel","body":"<p>I have several workbooks containing calculations and I am making an \"automatic overview\" combining the data in all those sheets. To find the data I use named ranges. These work fine.<br>\nHowever there is one defined name that does not refer to a range. It is a formula.</p>\n\n<p>What I want is to access the result from that formula (in an <strong>open</strong> calculations book) from my overview book.</p>\n\n<p>Obviously <code>wb.Names(\"myNamedFormula\").RefersToRange</code> does not work as the name does not refer to a range.<br>\n<code>wb.Names(\"myNamedFormula\").Value</code> gives me the formula, but not the result. None of the name's members gets the result.<br>\nI tried evaluating the formula using <code>Evaluate(...)</code> but this doesn't work as it should be evaluated in the other workbook.</p>\n\n<p>Does anyone know how to get the result?</p>\n\n<p>Thanks,</p>\n\n<p>ps: I know one possibility is to make the name refer to a range and then do the calculation there, but I don't want that.</p>\n"},{"tags":["excel","vba","file-io"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":6255,"score":4,"question_id":5971292,"title":"VBA Excel Getting File Path (ends with folder)","body":"<p>From a previous question I know how to go about letting the user click on a \"browser\" button and navigate to a specific file that they might want to open.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim vaFiles As Variant\n\n    vaFiles = Application.GetOpenFilename()\n\n    ActiveSheet.Range(\"B9\") = vaFiles\nEnd Sub\n</code></pre>\n\n<p>I want to create a second browser button that will let the user navigate to a folder.  This folder is going to be where they save the <code>.pdf</code> file that my program creates.  Here's the problem: The <code>GetOpenFilename</code> requires the user to click on a file.  If there's no file in the folder then there's nothing the user can do.</p>\n\n<p>I hope that was clear enough...</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","excel","excel-2007","numberformat"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4041,"score":1,"question_id":1018882,"title":"NumberFormat works but values are still different","body":"<p>I am using C# to do things in Excel-2007.  I have the below code</p>\n\n<pre><code>   object mis = Type.Missing;\n   Excel.Workbook wb = (Excel.Workbook)Globals.ThisAddIn.GetActiveWorkbook();\n   Excel.Worksheet ws = (Excel.Worksheet)wb.Worksheets.Add(mis, mis, mis, mis);\n   Excel.Range range = (Excel.Range)ws.get_Range(\"A1\", \"HM232\");\n   range.Formula = \"Sheet4!A1:HM232*0.56+Sheet5!A1:HM232*0.45\";\n   range.NumberFormat = \"0\";\n</code></pre>\n\n<p>it correctly shows all the cells as whole decimal numbers without any decimal points... but if I request the value in say cell G5 I see 1, but when I do the following</p>\n\n<pre><code>  MsgBox Range(\"G5\").Value2\n</code></pre>\n\n<p>it shows me 0.933333222, how do you make it so that the Value2 is also changed by the value rounded....?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":225,"score":0,"question_id":7426899,"title":"Stucked at deleting a record stored in variant datatype","body":"<p>Ok I have tried these and grasped some view on variants and I have written these code</p>\n\n<pre><code>Sub main()\nDim Vary As Variant\nVary = Sheet1.Range(\"A1:D11\").Value\nFor i = 1 To UBound(Vary)\n    For j = i + 1 To UBound(Vary)\n        If Vary(i, 1) = Vary(j, 1) Then\n            'I should delete the vary(j,1) element from vary \n            'in excel sheet we use selection.entirerow.delete\n        End If\n    Next j\nNext i\nEnd Sub\n</code></pre>\n\n<p>This is the sample I tried</p>\n\n<pre><code> A     B     C     D \n 1    somevalues in BCD columns\n 2\n 3\n 1\n</code></pre>\n\n<p>Now Delete the 4th row don think I'm working for unique records I'm just learning         stuff to do and while I was learning variant I am stuck at this point deleting a complete row stored in variant </p>\n\n<p>we Have stored <code>(A1:D11).value</code> in variant</p>\n\n<p>Now how can I delete the <code>A6</code> element or row in variant? so that I can avoid it while I copy the variant to some other sheet?</p>\n\n<p>Can I also delete the C AND B columns in variant so that when i do transpose it wont copy the C and B columns. I font know what exactly variant is I was thinking to take a set of range and do operations like what we do for an excel sheet than take that variant and transpose it back to sheet. is that right way of thinking? or did I misunderstand the use of variants? </p>\n\n<pre><code>`variant(k,1)=text(x)`   some array shows mismatch ? whats wrong?\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":472,"score":3,"question_id":280872,"title":"What's the best way to get the last non-empty worksheet in Excel (VBA)","body":"<p>I'm trying to write a <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> macro for a group tha</p>\n\n<ul>\n<li>has one workbook where they daily create new worksheets, and also have</li>\n<li><em>Sheet 1</em>, <em>Sheet 2</em> and <em>Sheet 3</em> at the end of their long list of sheets. </li>\n</ul>\n\n<p>I need to create a external cell reference in a new column in a different workbook where this information is being summarized.</p>\n\n<p>So I need to know how to get the <strong>last non-empty sheet</strong> so I can grab this data and place it appropriately in the summary.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":201,"score":0,"question_id":10160393,"title":"When reading down a column of Excel file, how to define cell coordinates without selecting a cell?","body":"<p>Can anyone tell me how to improve this macro?</p>\n\n<p>All the macro does is it just reads an Excel file for a list a accounts to update in an application (SmarTerm Beta).  It technically already accomplishes the goal, but is there a way to code it so that while it’s reading the Excel file, the coordinates of the cells from which to read the account numbers and also the coordinates of the cells in which to write an output don’t depend on a \"pre-selected\" a cell?  The risk with selecting a cell is that if someone were to accidentally select a different cell while the macro is running, everything will get screwed up.</p>\n\n<p>Here's my current code:</p>\n\n<pre><code>Public oExcelObj As Object\n\nFunction WaitSystem(Optional NoDialog as Variant) As Boolean\n    Dim nContinue as Integer\n    Dim nTimeOut as Integer 'In seconds.\n    'The default timeout for each command is 3 minutes. \n    'Increase this value if your host requires more time\n    'for each command.\n    nTimeOut = 10\n    If IsMissing(NoDialog) then NoDialog = False\n    'Wait for response from host.\n    Session.EventWait.Timeout = nTimeOut\n    Session.EventWait.EventType = smlPAGERECEIVED\n    Session.EventWait.MaxEventCount = 1\n    WaitSystem = True\n    If Session.EventWait.Start = smlWAITTIMEOUT Then\n        If NoDialog Then\n            WaitSystem = False\n            Else\n                nContinue = QuerySyncError()\n                If nContinue &lt;&gt; ebYes then WaitSystem = False\n        End If\n    End If\n    Set LockStep = Nothing\nEnd Function\n\n'Establish link.  Search for Excel. \nFunction OleLinkConnection\n    Const XlMaximized = &amp;HFFFFEFD7\n    Titlebar$ = AppFind$(\"Microsoft Excel\")\n    If Titlebar$ &lt;&gt; \"\" Then\n        bIsExcelActive = True               \n        If AppGetState(Titlebar$) = ebMinimized Then                \n            AppSetState 2, Titlebar$\n        End If\n        Else\n            bIsExcelActive = False              \n    End If\n    If bIsExcelActive Then\n        'Create Excel Object using current instance of Excel.\n        Set oExcelObj = GetObject(, \"Excel.Application\")\n        Else\n            'Create Excel Object using a new instance of Excel.\n            Set oExcelObj = CreateObject(\"Excel.Application\")\n    End If\n    Version = oExcelObj.Application.Version\n    oExcelObj.ScreenUpdating = True\n    oExcelObj.Displayalerts = True\n    oExcelObj.Visible = true\nEnd Function\n\nSub JPBmacro\n    Dim AccountNumber As String\n    Dim Temp As Integer\n    Begin Dialog StartDialogTemplate ,,211,74,\"Run JPBmacro?\"\n    OKButton 60,12,92,20,.Proceed\n    CancelButton 60,40,92,20,.Exit\n    End Dialog\n    Dim StartDialog As StartDialogTemplate\n    r% = Dialog(StartDialog)\n    If r% = 0 Then End\n    g$ = \"G:\\DATA\\outputfile.xlsx\"\n    oleCode = OleLinkConnection\n    oExcelObj.Workbooks.Open g$\n    oExcelObj.Range(\"A1\").Select ‘&lt;----This selects the cell from which all coordinates are based off of.  The coordinates of oExcelObj.ActiveCell.Offset(Y,X).Value VBA depend on selecting a cell.\n\n    NEXTACCOUNT:\n        Temp = 0\n        AccountNumber = oExcelObj.ActiveCell.Offset(Temp,0).Value\n        While AccountNumber &lt;&gt; \"\"\n            Session.SendKey \"CLEAR\"\n            If WaitSystem = False Then End\n            Session.Send \"ACTU \" &amp; AccountNumber\n            Session.SendKey \"ENTER\"\n            If WaitSystem = False Then End\n            If Trim(Session.ScreenText(4,6,1,22)) = \"INVALID ACCOUNT NUMBER\" Or Trim(Session.ScreenText(4,6,1,19)) = \"ACCOUNT NOT ON FILE\" Then\n                oExcelObj.ActiveCell.Offset(Temp,1).Value = Trim(Session.ScreenText(4,6,1,22))\n                GoTo RESTARTLOOP\n            End If \n\n            UPDATEIOV:\n                If Trim(Session.ScreenText(13,76,1,1)) = \"Y\" Then\n                    oExcelObj.ActiveCell.Offset(Temp,1).Value = \"Account already flagged as institutional.\"\n                    Else\n                        Session.Row = 13\n                        Session.Column = 76\n                        Session.send \"Y\"\n                        Session.SendKey \"ENTER\"\n                        If WaitSystem = False Then End\n                        oExcelObj.ActiveCell.Offset(Temp,1).Value = Trim(Session.ScreenText(24,2,1,50))\n                End If\n\n            RESTARTLOOP:\n                Temp = Temp + 1\n                AccountNumber = oExcelObj.ActiveCell.Offset(Temp,0).Value\n        Wend\n\n    ENDNOW:\n        oExcelObj.Workbooks.Close\n        MsgBox \"All Done!\"\n\nEnd Sub\n</code></pre>\n"},{"tags":["regex","excel","testing","vba","match"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2324,"score":2,"question_id":8301622,"title":"Excel VBA Regex Match Position","body":"<p>How do I grab the position of the first matched result in a regular expression? See below.</p>\n\n<pre><code>Function MYMATCH(strValue As String, strPattern As String, Optional blnCase As Boolean = True, Optional blnBoolean = True) As String\n    Dim objRegEx As Object\n    Dim strPosition As Integer\n\n    ' Create regular expression.\n    Set objRegEx = CreateObject(\"VBScript.RegExp\")\n    objRegEx.Pattern = strPattern\n    objRegEx.IgnoreCase = blnCase\n\n    ' Do the search match.\n    strPosition = objRegEx.Match(strValue)\n\n    MYMATCH = strPosition\nEnd Function\n</code></pre>\n\n<p>For one, I'm not entirely certain what <code>.Match</code> is returning (string, integer, etc.). The one solution I found said I should create a <code>Match</code> object to and then grab the position from there, but unlike <a href=\"/questions/tagged/vb\" class=\"post-tag\" title=\"show questions tagged 'vb'\" rel=\"tag\">vb</a>, <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> does not recognize the <code>Match</code> object. I've also seen <a href=\"http://stackoverflow.com/questions/8146485/returning-a-regex-match-in-vba-excel\" title=\"from Stack Overflow\">some code</a> like the following, but I'm not necessarily looking for the value, just the first string placement:</p>\n\n<pre><code>If allMatches.count &lt;&gt; 0 Then\n    result = allMatches.Item(0).submatches.Item(0)\nEnd If\n</code></pre>\n\n<p>Somewhat ignoring any of the possible syntax errors above (mostly due to me changing variable types right and left), how do I easily/simply accomplish this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["excel","vba","csv","macros"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":252,"score":0,"question_id":12162477,"title":"Importing multiple CSV to multiple worksheet in a single workbook","body":"<p>How do I do this? Basically I want my multiple csv files to be imported to  multiple worksheet but in a single workbook only. Here's my macro that I want to loop. I need the loop to query all the csv in C:\\test\\</p>\n\n<pre><code>Sub Macro()\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;C:\\test\\test1.csv\", Destination:=Range(\"$A$1\"))\n    .Name = \"test1\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nSheets.Add After:=Sheets(Sheets.Count)\nEnd Sub\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":719,"score":1,"question_id":10687860,"title":"excel vba autofilter not filtering on dates","body":"<p>I have column of dates, which is an output from a database. There is a macro that filters on this date which is meant to show all dates older than 14 days from current date excluding nulls. The filter when applied filters the entire sheet and shows nothing. When I take off the - 14 I do get dates, I have tried even using alt a, e, f to ensure that the column is the correct format, but no luck.</p>\n\n<p>Here is my code snippet:</p>\n\n<pre><code>ActiveSheet.UsedRange.AutoFilter Field:=34, Criteria:=\"&lt;&gt;NULL\", _\nOperator:=xlAnd, Criteria2:=\"&lt;\" &amp; Now()-14\n</code></pre>\n\n<p>I have tried changing the <code>criteria2</code> to <code>\"&lt;\" &amp; Date - 14 &amp; \"# 00:00:00 AM#\"</code></p>\n\n<p>Please help</p>\n"},{"tags":["excel","vba","pivot-table","calculated-field"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1355,"score":1,"question_id":10549786,"title":"Calculated Field in Pivot Table using Conditional Formula VBA","body":"<p>I have this problem that I can't solve, I'm writing an Excel Macro that build up a pivot table taking the data from a table.\nWhen a field in the table is 0 I don't want to perform the calculation of the calculated field and display a blank cell in the pivot table.</p>\n\n<p>my conditional formula is this one:</p>\n\n<pre><code>=IF((field1=0),\"\",(field1/field2))\n</code></pre>\n\n<p>Putting this formula into VBA as follows</p>\n\n<pre><code>pt.CalculatedFields.Add Name:=\"ptfieldname\", Formula:=\"=IF((field1=0),\"\",(field1/field2))\"\n</code></pre>\n\n<p>display an empty pivot table, when I put the same formula in excel using the \"Fields, Items &amp; Set\" button in the pivot table option tab goes well...\nso I think that the formula is right, but what I have to do to get it permorf well also within the VBA macro?!</p>\n\n<p>thanks in advance</p>\n"},{"tags":["asp.net","excel","xlsx","epplus"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1610,"score":2,"question_id":11239805,"title":"How convert stream excel file to datatable C#?","body":"<p>I use Epplus to reading xlsx files from stream.</p>\n\n<p>It has a bug , it cant read some columns in my workbook.How can read xlsx files from stream to datatable without epplus ?</p>\n\n<p>my older code:</p>\n\n<pre><code> public static DataSet ReadExcelFile(Stream stream)\n    {\n        try\n        {\n            //2. Reading from a OpenXml Excel file (2007 format; *.xlsx)\n            IExcelDataReader excelReader =    \n                             ExcelReaderFactory.CreateOpenXmlReader(stream);\n            //...\n            DataSet result = excelReader.AsDataSet();\n\n            return result;\n\n        }\n        catch (Exception x)\n        {\n            throw x;\n        }\n    }\n</code></pre>\n\n<p>I didnt report it, but i tried so much combinations.If there are empty columns in worksheet ,epplus reader cant read correctly column values.</p>\n"},{"tags":["c#","asp.net","excel","webmatrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":105,"score":0,"question_id":13147594,"title":"render excel data to web page row by row (C#)","body":"<p>Can someone help me print data row by row using WebMatrix 2</p>\n\n<p>i am trying to use excel 2007 and/or 2003 the last line DataGrid1 is not working. this is my third day trying, please help.</p>\n\n<pre><code>String Excel = \"C://TEST/test_2.xls\";\nString sConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + Excel +\";Extended Properties=Excel 8.0;\";\n\nstring.System.Data.OleDb.OleDbConnection objConn = new`system.Data.OleDb.OleDbConnection(sConnectionString);`\n\n\nobjConn.Open();\nSystem.Data.OleDb.OleDbCommand objCmdSelect = new System.Data.OleDb.OleDbCommand(\"SELECT * FROM [Sheet1$]\", objConn);\n\nSystem.Data.OleDb.OleDbDataAdapter objAdapter1 = new System.Data.OleDb.OleDbDataAdapter(objCmdSelect);\n\nSystem.Data.DataSet objDataset1 = new System.Data.DataSet();\n\nobjAdapter1.Fill(objDataset1, \"XLData\");\nobjConn.Close();\nint c = objDataset1.Tables[0].Columns.Count;\nint count =0;\n\n//For Test\nResponse.Write(\"Colums: \"+objDataset1.Tables[0].Columns.Count.ToString()+\"&lt;br&gt;\");\nResponse.Write(\"Rows: \"+objDataset1.Tables[0].Rows.Count.ToString()+\"&lt;br&gt;\");\n\n\n// Bind data to DataGrid control. Following part not working, also i like to print data with for or foreach loop)\n\nDataGrid1.DataSource = objDataset1.Tables[0].DefaultView;\nDataGrid1.DataBind();\n//Other option if Data.Grid does not work!!\nchange Rows to Columns to print Columns.\nfor (int i=0;i&lt;r;i++){\nfor (int j=0;j&lt;c;j++){\nResponse.Write(objDataset1.Tables[0].Rows[i].ItemArray[j]+\" \");\n}\nResponse.Write(\"&lt;br&gt;\");\n}\n</code></pre>\n"},{"tags":["excel","time"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2615,"score":0,"question_id":10084057,"title":"How calculate average time in Excel (if sum of hours more, than 24)","body":"<p>I have some time values like 10:00, 8:50, 9:45 and so on (24 hours format).\nI want to know how I can compute average value of this 3 items, if sum of hours more than 24 (if less, then no problems)?</p>\n\n<p>Thanks.</p>\n\n<p>Thanks for everyone. It works, if just type values in cells and try to found average, but it work weird if I use time, which already result of my calculation already. Here screenshot: <a href=\"http://oi42.tinypic.com/2d7vq4x.jpg\" rel=\"nofollow\">tinypic.com/view.php?pic=2d7vq4x&amp;s=5</a> </p>\n"},{"tags":["excel","vba","macros"],"answer_count":7,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":36719,"score":11,"question_id":206324,"title":"How to check for empty array in vba macro","body":"<p>I want to check for empty arrays. Google gave me varied solutions but nothing worked. Maybe I am not applying them correctly.</p>\n\n<pre><code>Function GetBoiler(ByVal sFile As String) As String\n'Email Signature\n    Dim fso As Object\n    Dim ts As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(sFile).OpenAsTextStream(1, -2)\n    GetBoiler = ts.ReadAll\n    ts.Close\nEnd Function\n\nDim FileNamesList As Variant, i As Integer\n' activate the desired startfolder for the filesearch\nFileNamesList = CreateFileList(\"*.*\", False) ' Returns File names\n' performs the filesearch, includes any subfolders\n' present the result\n' If there are Signatures then populate SigString\nRange(\"A:A\").ClearContents\nFor i = 1 To UBound(FileNamesList)\n    Cells(i + 1, 1).Formula = FileNamesList(i)\nNext i\n\nSigString = FileNamesList(3)\n\nIf Dir(SigString) &lt;&gt; \"\" Then\n    Signature = GetBoiler(SigString)\nElse\n    Signature = \"\"\nEnd If\n</code></pre>\n\n<p>Here if FileNamesList array is empty, GetBoiler(SigString) should not get called at all. When FileNamesList array is empty, SigString is also empty and this calls GetBoiler() function with empty string. I get an error at line </p>\n\n<pre><code>Set ts = fso.GetFile(sFile).OpenAsTextStream(1, -2)\n</code></pre>\n\n<p>since sFile is empty. Any way to avoid that.</p>\n"},{"tags":["c#","excel","yahoo-finance"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13211527,"title":"How to use MS Excel inbuilt functions in a c#.net application?","body":"<p>I m building a portfolio management software using c#.net i need to analyze financial data of more than 10 years historical data of 25 companies i am doing the same using the MS Excel inbuild functions of variance, standard deviation and PV,Fv and many others\nI have feeded the large amount of data into .csv(Excel Supported ) files through Yahoo Finance data retrieval portal.</p>\n\n<p>How Will i be able use the above MS Excel functions through the C# coding ??\nhow Can i show Graphs,Pie charts,bar diagrams in C#.net application??\nIf yes then let me know..\nThanks in advance...</p>\n"},{"tags":["c++",".net","excel","cli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13170609,"title":"Open and read Excel file with C++/CLI","body":"<p>I am trying to create a program with C++/CLI that reads some data from Excel workbooks using Visual Studio.\nI have added Microsoft.Office.Interop.Excel (v12) to the references in the project properties.\nMy basic goal would be only to get a cell's value as a string (the workbook contains only text values).\nMy current code is the following (only the main part is included of course):</p>\n\n<pre><code>using namespace System;\nusing namespace System::ComponentModel;\nusing namespace System::Collections;\nusing namespace System::Windows::Forms;\nusing namespace System::Data;\nusing namespace System::Drawing;\nusing namespace Microsoft::Office::Interop::Excel;\n\nstart(void){\n        Microsoft::Office::Interop::Excel::Application^ exApp= gcnew Microsoft::Office::Interop::Excel::ApplicationClass();\n        String^ filename=\"e:\\\\test.xls\";\n        Workbook^ wb = exApp-&gt;Workbooks-&gt;Open(filename, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing);\n        Worksheet^  exWs  = safe_cast&lt;Worksheet^&gt;(exApp-&gt;ActiveSheet);\n        int row=1;\n        int col=1;\n        String^ tmp=((Microsoft::Office::Interop::Excel::Range^)exWs-&gt;Cells[(System::Object^)row, (System::Object^)col])-&gt;Value2-&gt;ToString();\n        MessageBox::Show(tmp);\n}\n</code></pre>\n\n<p>When I run it, it crashes with the following error:</p>\n\n<pre><code>An unhandled exception of type 'System.Runtime.InteropServices.COMException' occurred in exc2.exe\n\nAdditional information: Old format or invalid type library. (Exception from HRESULT: 0x80028018 (TYPE_E_INVDATAREAD))\n</code></pre>\n\n<p>It happens with both xls and xlsx files, when I try to open the workbook (at the line that starts with \"Workbook^ wb = exApp->Workbooks->Open\" - so I could not even check if the rest is working).\nCould some help please, what do i miss/do wrong?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":1861,"score":-1,"question_id":5836965,"title":"How to open .xlsx files with POI SS?","body":"<p>I am trying to open .xlsx files with POI SS with this code (taken from <a href=\"http://poi.apache.org/spreadsheet/quick-guide.html#ReadWriteWorkbook\" rel=\"nofollow\">http://poi.apache.org/spreadsheet/quick-guide.html#ReadWriteWorkbook</a>):</p>\n\n<pre><code>InputStream inp = new FileInputStream(\"workbook.xls\");\n//InputStream inp = new FileInputStream(\"workbook.xlsx\");\n\nWorkbook wb = WorkbookFactory.create(inp);\nSheet sheet = wb.getSheetAt(0);\nRow row = sheet.getRow(2);\nCell cell = row.getCell(3);\nif (cell == null)\n    cell = row.createCell(3);\ncell.setCellType(Cell.CELL_TYPE_STRING);\ncell.setCellValue(\"a test\");\n\n// Write the output to a file\nFileOutputStream fileOut = new FileOutputStream(\"workbook.xls\");\nwb.write(fileOut);\nfileOut.close();\n</code></pre>\n\n<p>and I get this error message:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.NoClassDefFoundError: org/dom4j/DocumentException\n</code></pre>\n\n<p>I add the xbean.jar to my library and to my run-time libraries.</p>\n\n<p>how can I resolve this exception?</p>\n\n<p>Thanks !</p>\n"},{"tags":["excel","excel-vba","dynamically-generated","office-2013","excel-2013"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13196880,"title":"Excel 2013: Generate list meeting all requirements","body":"<p>I need to create a spreadsheet that randomly draws a winner that has correctly answered all questions. </p>\n\n<hr>\n\n<h2>Verifying Answer</h2>\n\n<p>I've added a Column <strong>'Correct'</strong> which verifies the answer was properly answered. It returns <em>QuestionID</em> if correct and <em>'Incorrect'</em> if FALSE.</p>\n\n<p>I have another table with the answers to verify the database results.</p>\n\n<ul>\n<li>9747 | Wrong | Correct | Wrong</li>\n<li>9748 | Correct | Wrong | Wrong</li>\n<li>9749 | Wrong | Wrong | Correct</li>\n<li>9751 | Correct | Wrong | Wrong</li>\n<li>9752 | Wrong | Wrong | Correct</li>\n<li>9753 | Wrong | Wrong | Correct</li>\n</ul>\n\n<hr>\n\n<h2>Pull Possible Winners</h2>\n\n<p>I need to get all PersonID that have properly answered all the questions. If they incorrectly answer a question they are disqualified. Also if they failed to answer a question they are disqualified.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Tpk7T.png\" alt=\"TableWithData\"></p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13097506,"title":"Sum max values in a column based on two other columns","body":"<p>I have three columns and I want the sum of the maximum values in <code>Col2</code> for each category in <code>Col1</code> where <code>Col3</code> is equal to x. </p>\n\n<p>I am not able to add a 4th column to obtain the max first.</p>\n\n<pre><code>Col1    Col2    Col3  \na       3       x  \nb       2       x  \nc       2       x  \na       1       x  \nb       3       x  \nc       1       y  \na       2       y  \nb       1       y  \nc       3       y  \n</code></pre>\n\n<p>In this example the answer I am looking for is 8:</p>\n\n<ul>\n<li>3 for a,</li>\n<li>plus 3 for b, </li>\n<li>plus 2 for c.</li>\n</ul>\n\n<p>How can I do this?</p>\n"},{"tags":["excel","xlsx","xlsm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13202251,"title":"Consolidating Excel worksheet rows into one worksheet in the same workbook","body":"<p>I have an Excel workbook that has several worksheet (by team member name).  Each team member maintains a list of projects/tasks.  All column titles in each worksheet are identical.  </p>\n\n<p>I need a worksheet within the same workbook that consolidates all projects from each team members' worksheet for a one time review instead of the manager having to jump between multiple tabs.  </p>\n\n<p>The consolidated (main worksheet) worksheet needs to automatically update as employees changes within cells, or add/remove rows.  </p>\n\n<p>Is there a macro or function in MS Excel 2007 that enables thus functionality?</p>\n"},{"tags":["security","excel","vba","password-protection"],"answer_count":5,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":41830,"score":8,"question_id":272503,"title":"How do I remove the password from a VBA project?","body":"<p>How can I programmatically remove a (known) password from an Excel VBA project?</p>\n\n<p>To be clear: I want to remove the password from the VBA Project, not the workbook or any worksheets.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13178581,"title":"VBA Alternative to For Each","body":"<p>I am currently using a lot of <code>For ... Each</code> loops in my code which is slowing it down a lot, is there a faster approach? </p>\n\n<p>I have heard I could copy the range to an array and edit the array and paste it back but im having a few problems with editing each cell in the array.</p>\n\n<p>Here is the current for each code I am using - Thanks.</p>\n\n<pre><code>Dim cell As Range\n    For Each cell In Sheets(\"sheet1\").UsedRange\n        cell.Value = cell.Value\nNext cell\n</code></pre>\n"},{"tags":["excel","macros","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":8804889,"title":"Is there a way to disable only a certain part of a macro?","body":"<p>I have an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> spreadsheet with different values. As the values change, different <code>MsgBox</code>s pop up depending on the parameters. These <code>MsgBox</code>s are all under the same worksheet event:</p>\n\n<p><code>Private Sub Worksheet_Change(ByVal Target As Range)</code>.</p>\n\n<p>I want to be able to enable/disable some of the commands as I choose by means of buttons - one button for each value.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["c#","excel","oledb"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13206890,"title":"Excel data cell format via OLEDB","body":"<p>I need to select data from Excel using OLEDB and once it is selected, the entire row has to be colored with red so that user can identify the row easily.</p>\n"},{"tags":["excel","matlab"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":391,"score":-4,"question_id":8707419,"title":"How do i load and read the excel to my GUI?","body":"<p>I already had a GUI which solves formula for </p>\n\n<ul>\n<li>power,</li>\n<li>h,</li>\n<li>q,</li>\n<li>elevation. </li>\n</ul>\n\n<p>My problem now is how do I read all the data in <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> (the table of data is already in excel). And whatever the result in the GUI will match the table of data in excel? </p>\n\n<ol>\n<li>For example, result on GUI is 750.</li>\n<li><p>Then my table (table data below) will read the excel and give the corresponding equivalent such as 750 equivalent will be 250:</p>\n\n<blockquote>\n  <p>H EL<br>\n  800 300<br>\n  775 280<br>\n  750 250<br>\n  725 175<br>\n  700 100  </p>\n</blockquote></li>\n</ol>\n\n<p>sample code :</p>\n\n<pre><code>a = get(handles.input1_gamma,'String'); %GAMMA\nb = get(handles.input2_h,'String');    %H\nc = get(handles.input3_q,'String');     %Q\nd = get(handles.input4_power,'String');  %POWER\ne = get(handles.input5_eout,'String');\n% a and b are variables of Strings type, and need to be converted \n% to variables of Number type before they can be added together\nout = str2num(b) + str2num(e);\nset(handles.equalel,'String',out);\n</code></pre>\n"},{"tags":["c#","excel","xlsx"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":4655,"score":5,"question_id":5886089,"title":"Read Data from XLSX in c#","body":"<p>I am new to c# and am trying to read an XLSX file in c# with the following code:</p>\n\n<pre><code>string Connection = \"Provider=Microsoft.ACE.OLEDB.12.0;DataSource=c:\\\\Temp\\\\source.xlsx;Extended Properties=\\\"Excel 12.0;HDR=Yes;IMEX=1\\\";\";\n\n//code to read the content of format file \nOleDbConnection con = new OleDbConnection(Connection);\nOleDbCommand command = new OleDbCommand();\n\nDataTable dt = new DataTable();\nOleDbDataAdapter myCommand = new OleDbDataAdapter(\"select * from [Tabelle1$]\", con);\n\nmyCommand.Fill(dt);\nConsole.Write(dt.Rows.Count);\n</code></pre>\n\n<p>I get t a correct count from the output, but I have 2 more questions:</p>\n\n<p>1.How do make a select where statement (how to access the rows)? </p>\n\n<pre><code> select * from [Tabelle1$] where A = '123' (A being an existing Excel row)\n</code></pre>\n\n<p>will throw an error mentioning wrong parameters...</p>\n\n<p>2.can anyone supply me with a tutorial link or short sample how to access the data?</p>\n"},{"tags":["excel"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18683,"score":1,"question_id":1110451,"title":"How do I merge two rows in Excel?","body":"<p>Hi I'm not even sure if this is actually possible in excel, but I am trying to merge two rows together, for example I have data that looks a little like this (each like would be a separate row):</p>\n\n<pre><code>1001001\n0100101\n\n1010101\n1010101\n</code></pre>\n\n<p>and I would like to merge the two rows like:</p>\n\n<pre><code>1001001-0100101\n\n1010101-1010101\n</code></pre>\n\n<p>Does anyone have any suggestions? Thank you so much</p>\n"},{"tags":["windows","excel","csv"],"answer_count":9,"favorite_count":7,"up_vote_count":14,"down_vote_count":0,"view_count":27288,"score":14,"question_id":1858195,"title":"Convert XLS to CSV on command line","body":"<p>How could I convert an XLS file to a CSV file on the windows command line.</p>\n\n<p>The machine has Microsoft Office 2000 installed. I'm open to installing OpenOffice if it's not possible using Microsoft Office.</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":367,"score":-2,"question_id":9451102,"title":"Reading data from Any Excel","body":"<p>Please how can I read data from ANY excel file in <a href=\"/questions/tagged/c%23\" class=\"post-tag\" title=\"show questions tagged 'c#'\" rel=\"tag\">c#</a>.</p>\n\n<p>I would like have a program that works on any excel file in any location on my drive</p>\n"},{"tags":["excel","vba","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":8983647,"title":"Populate all relevant fields when selecting a name e.g. John Smit","body":"<p>Hi I am new at learning Excel programming. I work on a document which must do the following:</p>\n\n<ul>\n<li>The form I use has 2 worksheets.</li>\n<li>The first sheet is the sheet the user will see, the second is a hidden lookup worksheet.</li>\n<li>On the hidden lookup worksheet I have a column for Name/Surname,Id,E-mail and mobile number. </li>\n<li>When an user selects a name on the first sheet e.g. <code>John Smith</code> it should also populate the telephone number and email address. </li>\n</ul>\n\n<p>Can someone please help me</p>\n"},{"tags":["excel","gantt","gantt-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":283,"score":-1,"question_id":11960069,"title":"How can I make a Gantt chart in Excel?","body":"<p>I'm trying to produce a chart similar to a Gantt chart which effectively shows 1 line of information for all tasks, by teams within a project. </p>\n\n<p><a href=\"http://www.mediafire.com/?k5ms4a99o856crj,3q4xn4x24m70p6c,h0sbe6h4lu206\" rel=\"nofollow\">This link</a> includes:</p>\n\n<ul>\n<li>An linked image showing what I'm looking to achieve. </li>\n<li>A  worksheet that allows me to generate the image using some software called Tableau. However, ideally I want to be able to do something similar with excel 2010 as Tableau server costs a bomb.</li>\n</ul>\n\n<p>Any suggestions would be greatly appreciated. </p>\n"},{"tags":["image","excel","function","url","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13205146,"title":"Excel VBA Custom Function Insert Image from URL glitch","body":"<p>I'm new to creating functions in VBA.  The following code is a modification of a script found <a href=\"http://www.exceltip.com/st/Insert_pictures_using_VBA_in_Microsoft_Excel/486.html\" rel=\"nofollow\">here</a>.  The code inserts two images from urls (or from the file system) into two user-defined ranges in an Excel spreadsheet.  In a target sheet, I've got a formula that references a URL-containing cell in a source sheet in the same workbook.  The code works as it should on its own sheet, but, when I'm working on the source sheet, it also inserts the images onto the source sheet when I either Save the document or Copy/Paste.  How do I keep the function general while telling Excel only to paste on the target sheet?  How do I keep the code from recalculating on every Save or Copy/Paste?  Thanks! Zen</p>\n\n<pre><code>Public Function NewPicsToRanges(URL1 As String, URL2 As String, Optional TargetCells1 As Range, Optional TargetCells2 As Range)\n' inserts a picture and resizes it to fit the TargetCells range\n\nActiveSheet.Shapes.SelectAll\nSelection.Delete\n\nDim p1 As Object, t1 As Double, l1 As Double, w1 As Double, h1 As Double\n    If TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Function\n    'If Dir(URL1) = \"\" Then Exit Function\n    ' import picture\n    Set p1 = ActiveSheet.Pictures.Insert(URL1)\n    ' determine positions\n    With TargetCells1\n        t1 = .Top\n        l1 = .Left\n        w1 = .Offset(0, .Columns.Count).Left - .Left\n        h1 = .Offset(.Rows.Count, 0).Top - .Top\n    End With\n    ' position picture\n    With p1\n        .Top = t1\n        .Left = l1\n        .Width = w1\n        .Height = h1\n    End With\n    Set p1 = Nothing\n\nDim p2 As Object, t2 As Double, l2 As Double, w2 As Double, h2 As Double\n    If TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Function\n    'If Dir(URL2) = \"\" Then Exit Function\n    ' import picture\n    Set p2 = ActiveSheet.Pictures.Insert(URL2)\n    ' determine positions\n    With TargetCells2\n        t2 = .Top\n        l2 = .Left\n        w2 = .Offset(0, .Columns.Count).Left - .Left\n        h2 = .Offset(.Rows.Count, 0).Top - .Top\n    End With\n    ' position picture\n    With p2\n        .Top = t2\n        .Left = l2\n        .Width = w2\n        .Height = h2\n    End With\n    Set p2 = Nothing\n\nEnd Function\n</code></pre>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":11644627,"title":"Duplicating Excel colors with Apache Poi","body":"<p>In my Excel File a macro looks for certain cell values and then changes the fillcolor.</p>\n\n<p>I have all the RGB values for these colors and want to set exactly these colors when I write data with Apache POI in a file.</p>\n\n<p>How can I do this ?</p>\n"},{"tags":["c#","excel","connection-string"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13205816,"title":"Excel text connection string file path invalid","body":"<p>I'm attempting to write a connection string for a <code>.txt</code> file with C#.</p>\n\n<p>I keep getting the error saying that my file path is invalid.</p>\n\n<pre><code>string excelConnectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=C:\\Users\\Josh\\Documents\\Test.txt;Extended Properties=\"\"text;HDR=YES;FMT=Delimited\"\"\";\n</code></pre>\n\n<p>The file path shouldn't be wrong. So, I'm thinking it's some other problem. Perhaps I'm missing something with the file path though.</p>\n\n<p>Any suggestions would be great.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1719,"score":4,"question_id":7876340,"title":"Deleting Empty rows in Excel using VBA","body":"<p>I am trying to delete Empty rows by using below code:</p>\n\n<pre><code>worksheet.Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>The code above is working fine, but giving <code>run time error '1004': No Cells were found.</code></p>\n"},{"tags":["c#",".net","excel","date","format"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":746,"score":4,"question_id":5386488,"title":"Read data from Excel","body":"<p>I have been trying to read data from an excel file. It has been successful, but I enountered a problem. Whenever the format of the cell and the data entered in the cell is not matching then I get empty data</p>\n\n<p><strong><br>e.g<br></strong></p>\n\n<p>If the data cell is formatted as Date - <code>dd/mm/yyyy</code>, and the user enters <code>13/17/2011</code>, the as the date format and the date entered is contradictory so the excel gives me entirely empty cell. Only if the cell format is text I get the data as entered.</p>\n\n<p>Why is the excel file giving me empty cell in case the entered date format is not complying with the cell format set?</p>\n\n<p>This is the code that reads the excel data</p>\n\n<pre><code>if(fileEXT.Equals(\".xls\"))\n{\n   oledbConn = new OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"+Server.MapPath(\"../Portal_Docs/UploadDocs/\"+filename+\"\")+\";Extended Properties=Excel 8.0\");\n}\nelse if(fileEXT.Equals(\".xlsx\"))\n{\n   oledbConn = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"+Server.MapPath(\"../Portal_Docs/UploadDocs/\"+filename+\"\")+\";Extended Properties=\\\"Excel 12.0;HDR=YES;\\\"\");\n}\nelse if(fileEXT.Equals(\".xlsm\"))\n{\n   oledbConn = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"+Server.MapPath(\"../Portal_Docs/UploadDocs/\"+filename+\"\")+\";Extended Properties=Excel 12.0 Macro\");\n}\n\noledbConn.Open();\nOleDbCommand cmd = new OleDbCommand(\"SELECT * FROM [Sheet1$]\", oledbConn);\nOleDbDataAdapter oleda = new OleDbDataAdapter();\noleda.SelectCommand = cmd;\nDataSet ds = new DataSet();\noleda.Fill(ds,\"LocationDetails\");\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","userform"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":259,"score":0,"question_id":8435015,"title":"Clicking \"X\" on an Excel userform sometimes closes spreadsheet","body":"<p>I'm writing a spreadsheet where double-clicking certain cells opens a userform.  When certain users click the \"X\" to close the userform, the whole workbook closes (which is not the intended behavior).  This happens if the cell has contents; if the cell is blank, the workbook does not close when the userform closes.</p>\n\n<p>Here is the general code that calls the Userforms:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nDim requestID As Long\nDim rowCount As Long\n\nrowCount = UsedRange.Rows.Count\n\nIf (Target.Row &gt; 2) And (Target.Row &lt;= rowCount) Then\n    requestID = Cells(Target.Row, 1)\n    Select Case Target.Column\n        Case 2 To 4\n            requestUpdateForm.populate requestID\n            requestUpdateForm.Show\n\n        Case 5\n            initialSearchForm.populate requestID\n            initialSearchForm.Show\n\n        'etc, more forms using Case statements\n\n    End Select\nEnd If\n</code></pre>\n\n<p>I've seen this behavior before, except it was the opposite: clicking \"X\" to close a form opened from a blank cell closed the workbook, and this problem went away when I created a new workbook and copied all the code into it.</p>\n\n<p>What puzzles me is that this error is occurring on one user's system and not on another's, even though both have identical installations of Excel.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":494,"score":0,"question_id":7535561,"title":"How do you GoTo a line label in a different object?","body":"<p>E.g. Given Sheet 1 contains:</p>\n\n<p><code>Ref: Do things</code></p>\n\n<p>How can I direct a code in Module 1 to <code>GoTo Ref</code>? If I were in the <code>Sheet1</code> code moduke then I could simply use a \n<code>Goto Ref</code></p>\n\n<p>But this doesn't work across different modules</p>\n"},{"tags":["excel","vba","active-directory","connection-string"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":754,"score":0,"question_id":7549502,"title":"Excel Data Connection to Active Directory","body":"<p>I want to create a data connection in <a href=\"/questions/tagged/excel-2007\" class=\"post-tag\" title=\"show questions tagged 'excel-2007'\" rel=\"tag\">excel-2007</a> that pulls the result of an <a href=\"/questions/tagged/active-directory\" class=\"post-tag\" title=\"show questions tagged 'active-directory'\" rel=\"tag\">active-directory</a> query into a sheet in my workbook.</p>\n\n<p>I see that I <a href=\"http://www.remkoweijnen.nl/blog/2007/11/01/query-active-directory-from-excel\" rel=\"nofollow\">can do this</a> with VBA but I agree with Rob <a href=\"http://www.excelforum.com/excel-general/561218-data-connection-active-directory.html\" rel=\"nofollow\">here</a> that it should be easier than that, just using \"OLE DB Provider for Microsoft Directory Services\"</p>\n\n<p>A bit of googling suggests that this is a hole in our collective knowledge that deserves to be filled!</p>\n"},{"tags":["excel","excel-formula"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":134,"score":2,"question_id":7931829,"title":"Excel Formula - Yeah thats right, I said excel?","body":"<p>If <code>A1</code> contains 0.3 I want <code>B1</code> to say 1</p>\n\n<p>If <code>A1</code> says0.45 I want <code>B1</code> to say 0</p>\n\n<p>If it's anything in-between 0.3 and 0.45 I want it to say the proportional difference, so if <code>A1</code> said 0.375, <code>B1</code> should say 0.5 as its half way between 0.3 and 0.45.</p>\n\n<p>Is is even possible? I'm thinking nested <code>IF</code>s but I can't see how to actually get there?</p>\n"},{"tags":["excel","excel-formula","formating"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":24,"score":-2,"question_id":11539254,"title":"formatting in excel","body":"<p>In <a href=\"/questions/tagged/excel-2010\" class=\"post-tag\" title=\"show questions tagged 'excel-2010'\" rel=\"tag\">excel-2010</a> can we format time column into text along with AM/PM information for corresponding time? </p>\n\n<p>For example, COLUMN A has \"daily\" as text and column B has \"6.00 PM \" as value. Can we append these A &amp; B Columns and display as \"daily 6.00 PM\" in single cell?</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":361,"score":0,"question_id":9445396,"title":"Closing Excel file if it is already in open status when opening the same file second time using (VBA)","body":"<p>I have a command button which opens the <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> file. </p>\n\n<p>But if the same file is opened for the second time it should first close it and then reopen it. </p>\n\n<p>So i am looking for such code - I would be very thankful for this help.</p>\n"},{"tags":["excel","excel-formula","transformation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":7598046,"title":"Excel data tranformation","body":"<p>I have a excel sheet with data like below</p>\n\n<pre><code>Col1 Col2 Col3 Col4 Col5   \nabcd defg ghij $454 $980    \nndfe efed eee $111 $748\n</code></pre>\n\n<p>I need to change / transform this data to </p>\n\n<pre><code>Col1 Col2 Col3 Col6 Col7    \nabcd defg ghij Col4 $454    \nabcd defg ghij Col5 $980    \nndfe efed eee Col4 $111    \nndfe efed eee Col5 $748\n</code></pre>\n"},{"tags":["excel","vba","outlook"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":389,"score":0,"question_id":8762412,"title":"Export Outlook Message Body to Excel","body":"<p>I am receiving an email report each day in the following format. </p>\n\n<p>The format is the same, except the value will be different.</p>\n\n<p>So I hope there is a way for me to automatically place this data into individual cells instead of copying and pasting them in 1 by 1.</p>\n\n<pre><code>type        ID      Date_or_Range                       Total\nDAU         aaaa    1/5/2012                            9999\nDAU         bbbb    1/5/2012                            9999\nDAU         cccc    1/5/2012                            9999\nDAU         dddd    1/5/2012                            9999\nDAU         eeee    1/5/2012                            9999\nDAU         ffff    1/5/2012                            9999\nDAU         gggg    1/5/2012                            9999\nDAU         hhhh    1/5/2012                            9999\nDAU         iiii    1/5/2012                            9999\nDAU         jjjj    1/5/2012                            9999\nDAU         kkkk    1/5/2012                            9999\nMAU         aaaa    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         bbbb    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         cccc    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         dddd    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         eeee    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         ffff    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         gggg    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         hhhh    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         iiii    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         jjjj    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         kkkk    2011-12-07 to 2012-01-05 inclusive  9999\nMAU         LLLL    2011-12-07 to 2012-01-05 inclusive  9999\nLast 7 Days aaaa    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days bbbb    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days cccc    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days dddd    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days eeee    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days ffff    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days gggg    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days hhhh    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days iiii    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days jjjj    2011-12-30 to 2012-01-05 inclusive  9999\nLast 7 Days kkkk    2011-12-30 to 2012-01-05 inclusive  9999\nNew Users   aaaa    1/5/2012                            9999\nNew Users   bbbb    1/5/2012                            9999\nNew Users   cccc    1/5/2012                            9999\nNew Users   dddd    1/5/2012                            9999\nNew Users   eeee    1/5/2012                            9999\nNew Users   ffff    1/5/2012                            9999\nNew Users   gggg    1/5/2012                            9999\nNew Users   hhhh    1/5/2012                            9999\nNew Users   iiii    1/5/2012                            9999\nNew Users   jjjj    1/5/2012                            9999\n</code></pre>\n\n<p>This is the ideal format, after copying them to excel using VBA. </p>\n\n<p>So far I have found codes online which allowing me to copy the entire message into 1 cell <code>A1</code> using <code>Msg.Body</code> - but I prefer the follow format. </p>\n\n<pre><code>    A   B       C               D\n1   DAU aaaa    1/5/2012    9999\n2   DAU bbbb    1/5/2012    9999\n3   DAU cccc    1/5/2012    9999\n4   DAU dddd    1/5/2012    9999\n5   DAU eeee    1/5/2012    9999\n</code></pre>\n\n<p>I think this will be helpful for many many people, so I hope someone can help create the exact <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> code and share with us.</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":193,"score":-1,"question_id":9373110,"title":"Aligning the text inside a ComboBox in Excel","body":"<p>How do I align the text inside a <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> Combo Box in an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> spreadsheet? </p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":68,"score":-3,"question_id":12470084,"title":"Sum of hh:mm:ss.0000000 in Excel","body":"<p>Is there a format to sum the time in format hh:mm:ss.0000000? Thanks. </p>\n"},{"tags":["excel","vba","download"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12815142,"title":"vba download and save in C:\\user","body":"<p>I want excel, using VBA, to download a file from the internet.  This file is a database with information about list of employees.  I want the file saved in C:\\Users\\\"name of user\"\\FCMMIS\\</p>\n\n<p>This is the step-by-step process that I want to achieve:</p>\n\n<ol>\n<li>Excel using VBA, downloads a file from a specified web address.</li>\n<li>*<em>The downloaded file is saved in C:\\Users\\\"name of user\"\\FCMMIS*</em> </li>\n<li>Excel links with the downloaded database via VBA to get data that may be required.</li>\n</ol>\n\n<p>As another note, the excel file in question will be used by different people with laptops.  I am not sure if saving the file in the \"User\" folder is possible or should there needs to be permissions to be given in order to allow a save.</p>\n\n<p>I know that there are better solutions to this like writing a full application but due to the requirement, I am stuck with excel and VBA.</p>\n\n<p>EDIT (to be done after along with part 3):</p>\n\n<p>3.1: Once the database is downloaded, then the excel file gets records from the employee table and prints them in a new worksheet in the same excel file.</p>\n\n<p>3.2: The printed data is then used for various functions in the worksheet.</p>\n\n<p>However, I am in a debate whether is it much efficient to just manipulate the data in the database itself or have it work from the created worksheet.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":76,"score":-2,"question_id":12994404,"title":"Make the Macro Excel-2000 Compatible","body":"<p>I have an Excel Macro which is working fine in <a href=\"/questions/tagged/excel-2003\" class=\"post-tag\" title=\"show questions tagged 'excel-2003'\" rel=\"tag\">excel-2003</a> or higher.</p>\n\n<p>But it is giving error at many places in <a href=\"/questions/tagged/excel-2000\" class=\"post-tag\" title=\"show questions tagged 'excel-2000'\" rel=\"tag\">excel-2000</a>. Also the \"Debug\" button is not available when any error occurs.</p>\n\n<blockquote>\n  <p>And the main problem is, I don't have Excel 2000. Only my client has.</p>\n</blockquote>\n\n<p>How can I solve this problem? Please help.</p>\n\n<hr>\n\n<h2>Here is the code of Macro</h2>\n\n<pre><code>Option Explicit\n\nSub Original()\n'Automate the summarization of the PT Reports\n\n'Create PROTO-WS \"TRANS\"\n      ThisWorkbook.Worksheets.Add After:=Worksheets(Sheets.Count)\n        With ActiveSheet\n            .Name = \"Report\"\n        End With\n\n      ThisWorkbook.Worksheets.Add After:=Worksheets(Sheets.Count)\n        With ActiveSheet\n            .Name = \"Trans\"\n        End With\n'Dim Declaration\n    Dim jbC, trN, reP As Worksheet\n    Dim FinalRow, FinalCol As Long\n\n'Set Workbooks\n    Set jbC = ThisWorkbook.Worksheets(\"JobCost\")\n    Set trN = ThisWorkbook.Worksheets(\"Trans\")\n    Set reP = ThisWorkbook.Worksheets(\"Report\")\n\n'Find Range\n    FinalRow = jbC.Cells(Rows.Count, 1).End(xlUp).Row\n    FinalCol = jbC.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Consistent Data into General Form + Copy Paste into Trans\n    jbC.Range(jbC.Cells(1, 1), jbC.Cells(FinalRow, FinalCol)).Copy _\n        Destination:=trN.Range(\"A1\")\n    trN.Range(trN.Cells(1, 1), trN.Cells(FinalRow, FinalCol)).Select\n        Selection.NumberFormat = \"General\"\n\n'Declare Variables\nDim LastRow1 As Double\nDim i As Integer\nDim vacio As Boolean\nDim JbTag As String\nDim Tots, Prof, Prop As Double\nDim JbCnt As Integer\nDim CstAlcr As String\nDim substrg1, substrg2, Alloc As String\nDim CosTag As Variant\nDim icost As Variant\nDim AdjCr As Variant\nDim CstStrg As String\nDim CstRRng As Variant\nDim scst, ecst As Integer\nDim Cost As String\nDim Amt As Variant\nDim iJbCnt, CstItem, MisCst, LabCst, ContAmt, Sales As Double\nDim FinalRowr, FinalColr As Double\n\nscst = 0\necst = 0\nJbCnt = 0\niJbCnt = JbCnt\nCost = 0\nAmt = 0\nvacio = True\nLastRow1 = Cells(Rows.Count, 1).End(xlUp).Row\n\n For i = 1 To LastRow1\n    If IsEmpty(Cells(i, 1)) = True Then\n            JbTag = Cells(i, 1).Offset(3, 0).Value\n            Tots = (Cells(i, 1).Offset(3, 5).Value) * -1\n            Prof = Cells(i, 1).Offset(3, 7).Value\n            Prop = Cells(i, 1).Offset(3, 8).Value\n            JbCnt = JbCnt + 1\n            CstAlcr = Cells(i, 1).Offset(1, 5).Formula\n            CstItem = Len(CstAlcr)\n\n            Select Case CstItem\n                Case Is = 19\n            scst = CInt(Mid(CstAlcr, 15, 1))\n            ecst = CInt(Mid(CstAlcr, 18, 1)) - 1\n                Case Is = 21\n            scst = CInt(Mid(CstAlcr, 15, 2))\n            ecst = CInt(Mid(CstAlcr, 19, 2)) - 1\n                Case Is = 23\n            scst = CInt(Mid(CstAlcr, 15, 3))\n            ecst = CInt(Mid(CstAlcr, 20, 3)) - 1\n                Case Is = 25\n            scst = CInt(Mid(CstAlcr, 15, 4))\n            ecst = CInt(Mid(CstAlcr, 21, 4)) - 1\n                Case Else\n            End Select\n            MisCst = 0\n              For icost = scst To ecst\n                Cost = Cells(icost, 4).Value\n                Amt = Cells(icost, 5).Value\n                CstItem = CstItem + 1\n            Select Case Cost\n                Case Is = \"Sales\"\n                    trN.Cells(FinalRow + (5 + JbCnt), 3).Value = Amt * -1\n                    Sales = Amt * -1\n                Case Is = \"Direct Labor\"\n                   trN.Cells(FinalRow + (5 + JbCnt), 10).Value = Amt\n                   LabCst = LabCst + Amt\n                Case Is = \"Direct Materials\"\n                    trN.Cells(FinalRow + (5 + JbCnt), 12).Value = Amt\n                    LabCst = LabCst + Amt\n                Case Is = \"Subcontractors\"\n                    trN.Cells(FinalRow + (5 + JbCnt), 9).Value = Amt\n                    LabCst = LabCst + Amt\n                Case Is = \"Equipment Rental\"\n                    trN.Cells(FinalRow + (5 + JbCnt), 13).Value = Amt\n                    LabCst = LabCst + Amt\n               Case Else\n                    MisCst = (Sales - Tots) - LabCst\n                    Debug.Print MisCst\n\n            End Select\n        Next icost\n       LabCst = 0\n    trN.Cells(FinalRow + (5 + JbCnt), 1).Value = JbCnt\n    trN.Cells(FinalRow + (5 + JbCnt), 2).Value = JbTag\n    trN.Cells(FinalRow + (5 + JbCnt), 15).Value = (Sales - Tots)\n    trN.Cells(FinalRow + (5 + JbCnt), 18).Value = Prof\n    trN.Cells(FinalRow + (5 + JbCnt), 19).Value = (Prop &amp; \"%\")\n    trN.Cells(FinalRow + (5 + JbCnt), 14).Value = MisCst\n\n    Range(\"E\" &amp; scst &amp; \":E\" &amp; ecst).Font.Bold = True\n    Range(\"C\" &amp; scst &amp; \":C\" &amp; ecst).Font.Bold = True\n    Cells(i, 1).Interior.ColorIndex = 1\n    i = i + 4  \n    End If\n Next i\n\n'Find Range\n    FinalRow = trN.Cells(Rows.Count, 1).End(xlUp).Row\n    FinalCol = trN.Cells(LastRow1 + 6, Columns.Count).End(xlToLeft).Column\n\n'Consistent Data into General Form + Copy Paste into Trans\n\n    'trN.Range(trN.Cells(LastRow1 + 6, 1), trN.Cells(FinalRow, FinalCol)).NumberFormat = \"_($* #,##0.00_);_($* (#,##0.00);_($* \"\"-\"\"??_);_(@_)\"\n    trN.Range(trN.Cells(LastRow1 + 6, 1), trN.Cells(FinalRow, FinalCol)).Copy _\n        Destination:=reP.Range(\"A3\")\n\n'Headers Setup\n        With reP.Range(\"A1\")\n                .Value = \"JFP Painting Company: Job Profitability 2012\"\n                .Font.Bold = True\n                .Font.Size = 20\n        End With\n         reP.Range(\"A2\").Value = \"JB #\"\n         reP.Range(\"B2\").Value = \"Job ID\"\n         reP.Range(\"C2\").Value = \"Original Contract\"\n         reP.Range(\"D2\").Value = \"Change Orders\"\n         reP.Range(\"E2\").Value = \"Revised Contract Price\"\n         reP.Range(\"F2\").Value = \"Percentage Billed\"\n         reP.Range(\"G2\").Value = \"Overhead\"\n         reP.Range(\"H2\").Value = \"Man Days\"\n         reP.Range(\"I2\").Value = \"SUB\"\n         reP.Range(\"J2\").Value = \"Labor\"\n         reP.Range(\"K2\").Value = \"Labor &amp; Burden\"\n         reP.Range(\"L2\").Value = \"Material\"\n         reP.Range(\"M2\").Value = \"Rental Equip.\"\n         reP.Range(\"N2\").Value = \"Misc. Costs\"\n         reP.Range(\"O2\").Value = \"Total Costs\"\n         reP.Range(\"P2\").Value = \"Total Billed\"\n         reP.Range(\"Q2\").Value = \"Payments\"\n         reP.Range(\"R2\").Value = \"Profit\"\n         reP.Range(\"S2\").Value = \"Profit/Loss (%)\"\n' format range\n        reP.Range(\"A3\").ColumnWidth = 4\n        reP.Range(\"B2:S2\").ColumnWidth = 11.8\n        reP.Columns(\"B:B\").EntireColumn.AutoFit\n        reP.Columns(\"H:H\").EntireColumn.NumberFormat = \"0.00\"\n        reP.Columns(\"C:G\").EntireColumn.NumberFormat = \"_($* #,##0.00_);_($* (#,##0.00);_($* \"\"-\"\"??_);_(@_)\"\n        reP.Columns(\"I:R\").EntireColumn.NumberFormat = \"_($* #,##0.00_);_($* (#,##0.00);_($* \"\"-\"\"??_);_(@_)\"\n\n        reP.Range(\"A2:S2\").HorizontalAlignment = xlCenter\n        reP.Range(\"A2:S2\").VerticalAlignment = xlCenter\n        reP.Range(\"A2:S2\").WrapText = True\n        reP.Range(\"A2:S2\").ReadingOrder = xlContext\n\n        reP.Range(\"A2:S2\").Font.Name = \"Calibri\"\n        reP.Range(\"A2:S2\").Font.Size = 10\n        reP.Range(\"A2:S2\").Font.ColorIndex = xlAutomatic\n        reP.Range(\"A2:S2\").Font.ThemeFont = xlThemeFontMinor\n        reP.Range(\"A2:S2\").Font.Bold = True\n\n        reP.Range(\"A2:S2\").Interior.Pattern = xlSolid\n        reP.Range(\"A2:S2\").Interior.PatternColorIndex = xlAutomatic\n        reP.Range(\"A2:S2\").Interior.ThemeColor = xlThemeColorDark1\n        reP.Range(\"A2:S2\").Interior.TintAndShade = -0.349986266670736\n\n        reP.Range(\"A2:S2\").Borders(xlEdgeLeft).LineStyle = xlContinuous\n        reP.Range(\"A2:S2\").Borders(xlEdgeLeft).Weight = xlMedium\n\n        reP.Range(\"A2:S2\").Borders(xlEdgeTop).LineStyle = xlContinuous\n        reP.Range(\"A2:S2\").Borders(xlEdgeTop).Weight = xlMedium\n\n        reP.Range(\"A2:S2\").Borders(xlEdgeBottom).LineStyle = xlContinuous\n        reP.Range(\"A2:S2\").Borders(xlEdgeBottom).Weight = xlMedium\n\n        reP.Range(\"A2:S2\").Borders(xlEdgeRight).LineStyle = xlContinuous\n        reP.Range(\"A2:S2\").Borders(xlEdgeRight).Weight = xlMedium\n\n        reP.Range(\"A2:S2\").Borders(xlInsideVertical).LineStyle = xlContinuous\n        reP.Range(\"A2:S2\").Borders(xlInsideVertical).Weight = xlThin\n'Detect Finals\nFinalRowr = reP.Cells(Rows.Count, 1).End(xlUp).Row\n\n    FinalColr = reP.Cells(2, Columns.Count).End(xlToLeft).Column\n'\nFor i = 3 To FinalRowr\n    reP.Cells(i, 1).Resize(1, 19).Interior.ColorIndex = 35\n    i = i + 1\nNext i\n\n'Auto Realtions\n\n reP.Range(\"E3\").Formula = \"=SUM(C3:D3)\"\n reP.Range(\"G3\").Formula = \"=SUM(0.17*E3)\"\n reP.Range(\"H3\").Formula = \"=SUM(K3/200)\"\n reP.Range(\"K3\").Formula = \"=SUM(J3+(J3*35%))\"\n\n Sheets(\"Report\").Select\n    Range(\"E3\").Select\n    Selection.AutoFill Destination:=Range(\"E3:E\" &amp; FinalRowr), Type:=xlFillValues\n    Range(\"G3\").Select\n    Selection.AutoFill Destination:=Range(\"G3:G\" &amp; FinalRowr), Type:=xlFillValues\n    Range(\"H3\").Select\n    Selection.AutoFill Destination:=Range(\"H3:H\" &amp; FinalRowr), Type:=xlFillValues\n    Range(\"K3\").Select\n    Selection.AutoFill Destination:=Range(\"K3:K\" &amp; FinalRowr), Type:=xlFillValues\n\n    Sheets(\"Report\").Select\n    Sheets(\"Report\").Move Before:=Sheets(1)\nEnd Sub\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":8849460,"title":"Is it possible to create an XLA module with no sheets?","body":"<p>in <a href=\"/questions/tagged/excel-vba\" class=\"post-tag\" title=\"show questions tagged 'excel-vba'\" rel=\"tag\">excel-vba</a> is it possible to create an XLA module with no worksheets at all?</p>\n\n<p>If yes what is the way to do this?</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":28,"score":-3,"question_id":11135170,"title":"Copy first word of cell to another cell in another column","body":"<p>I have a cell <code>A1</code> with a value in such as:</p>\n\n<pre><code>Mr Donald Turing\n</code></pre>\n\n<p>I would like to know how to move just the first word (Mr) to another cell (e.g. <code>B1</code>)</p>\n"},{"tags":["excel","vba","loops","comparing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":406,"score":0,"question_id":10817799,"title":"Comparing two text cells in different sheets","body":"<p>I'm trying to compare two text cells (like <code>abcDEF</code>) from different sheets. One sheet is fixed but the other is not.</p>\n\n<p>My code is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim i As Long, LastRow As Long, n As Long\nDim Project As String\nDim Responsible As String, Site As String, Sample As String, _\n    Description As String, Parameter As String, Method As String\nDim j As Long\n\nApplication.EnableEvents = False\n\n' Find LastRow in Col A into the Sheet2\nLastRow = Sheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n' Select all Col A in Project\nFor Each Value In Sheet2.Range(\"A2:A\" &amp; LastRow)\n   Project = Project &amp; \",\" &amp; Value\nNext Value\n\nSheet1.Range(\"A2\").ClearContents: Sheet1.Range(\"A2\").Validation.Delete\n\n' Create the Data Validation List\nWith Range(\"A2\").Validation\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween,     Formula1:=Project\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n\n' Select the sheet coinciding with the cell \"A2\" value\nFor j = 3 To Sheets.Count\n\n    If Sheets(j).Range(\"A2\").Text = Sheets(1).Range(\"A2\").Text Then\n        'Write 4 in sheet1 cell C6 when the two values are coinciding.\n        Sheet1.Range(\"C6\") = 4\n    End If\n\nNext j\nEnd Sub\n</code></pre>\n\n<p>The problem is the <code>If...</code> line, probably is the range definition. I've tried <code>.Text</code> and <code>.Value</code> and neither works.</p>\n\n<p>Is there anybody that can help me?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["excel","vba","excel-vba","worksheet"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11308,"score":1,"question_id":2649844,"title":"Excel tab sheet names vs. Visual Basic sheet names","body":"<p>It seems that Visual Basic can not reference sheets according to user-modified sheet names. The worksheet tabs can have their names changed, but it seems that Visual Basic still thinks of the worksheet names as Sheet1, etc., despite the workbook tab having been changed to something useful.</p>\n\n<p>I have this:  </p>\n\n<pre><code>TABname = rng.Worksheet.Name  ' Excel sheet TAB name, not VSB Sheetx name.\n</code></pre>\n\n<p>but I would like to use sheet names in Visual Basic routines. The best I could come up so far is to Select Case the Worksheet Tab vs. Visual Basic names, which doesn't make my day.\nVisual Basic must know the Sheet1, Sheet2, etc., names. How can I get these associated with the Excel tab names so that I don't have to maintain a look-up table which changes with each new sheet or sheet tab re-naming?\nThanks in advance for your replies.</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":11555198,"title":"Append 0 to a number of the cell in Excel sheet","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9644789/excel-show-leading-zero-in-formula-bar\">Excel show leading zero in formula bar</a>  </p>\n</blockquote>\n\n\n\n<p>I am using an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> sheet for automation. Whenever i write a number such as <code>0428537</code> in a cell of the Excel sheet, it changes to <code>428537</code>.  </p>\n\n<p>How can I avoid without truncating the leading zero? </p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13204064,"title":"Turn Off Filters","body":"<p>So, I'm doing some searching in an Excel document, but it is very common for others to turn on filters and leave them on. When those filters are on, those cells are not included in the worksheet's Cells range.</p>\n\n<p>Is there a way to turn off these custom filters so that I can still get to all of the cells in the sheet?</p>\n\n<p>This is the way I use to find the method</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Range find = sheet.Cells.Find(tapeID, Type.Missing,\nMicrosoft.Office.Interop.Excel.XlFindLookIn.xlValues, Microsoft.Office.Interop.Excel.XlLookAt.xlPart, \nMicrosoft.Office.Interop.Excel.XlSearchOrder.xlByRows, Microsoft.Office.Interop.Excel.XlSearchDirection.xlNext, false, Type.Missing, Type.Missing); \n</code></pre>\n\n<p>When the filters are on, I get a null object returned and can't do anything but with the filters off, I get what I need.</p>\n\n<p>Any hints on turning the filters off?</p>\n"},{"tags":["java","excel","xls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13193140,"title":"Need help for wring xls file using object-to-excel.jar","body":"<p>i just recently discover one api which is javaobject-to-xls. i really like that and its working perfect. but i dont know how to write link(hiperlink) in cell. means it will show google but its actual value will be <a href=\"http://www.google.com\" rel=\"nofollow\">http://www.google.com</a>.</p>\n\n<p>Please check following link</p>\n\n<p><a href=\"http://erdyes.wordpress.com/2012/07/06/convert-object-to-excel-with-java/\" rel=\"nofollow\">http://erdyes.wordpress.com/2012/07/06/convert-object-to-excel-with-java/</a></p>\n\n<p>Thanks </p>\n"},{"tags":["excel","macros","excel-vba"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1317,"score":2,"question_id":4092329,"title":"Find bottom of Excel worksheet in VBA","body":"<p>I'd like to select to the bottom of the worksheet, but not below what is used/stored.  I might have 10,000 rows, but I certainly don't have 65,536.  I won't know ahead of time how many rows.</p>\n\n<p>In Excel itself (in recent versions, anyway; Excel 97 wasn't so kind) you can press Ctrl + End to be taken to the last row and column.  I'd like the same functionality.</p>\n"},{"tags":["objective-c","xcode","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12704606,"title":"Using libxls with Objective C","body":"<p>I am planning to make an app whose data source is from an excel file.\nSo basically the desire outcome would be to make my app data in sync with the excel file.\nI searched and found libxls and this seems to be a solution?</p>\n\n<p>I downloaded the DHlibxls which is for xCode but have no success in running the provided test file.</p>\n\n<p>Whenever I tried running I got the following error:</p>\n\n<blockquote>\n  <p>Error validating server certificate for\n  'https://libxls.svn.sourceforge.net:443':\n  - The certificate is not issued by a trusted authority. Use the fingerprint to validate the certificate manually! Certificate\n  information:\n   - Hostname: *.svn.sourceforge.net\n   - Valid: from Sat, 25 Feb 2012 23:58:41 GMT until Sun, 31 Mar 2013 19:51:44 GMT\n   - Issuer: GeoTrust, Inc., US\n   - Fingerprint: 0b:11:76:de:db:4c:74:72:cb:01:49:7d:13:70:c2:f1:13:7b:cb:bf (R)eject,\n  accept (t)emporarily or accept (p)ermanently? svn: OPTIONS of\n  'https://libxls.svn.sourceforge.net/svnroot/libxls/trunk/libxls':\n  Server certificate verification failed: issuer is not trusted\n  (https://libxls.svn.sourceforge.net) Command /bin/sh failed with exit\n  code 1</p>\n</blockquote>\n\n<p>Has anyone run into the same problem?</p>\n"},{"tags":["string","excel","excel-formula","excel-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13203919,"title":"Split long text into groups of 255 characters using Excel (or other tool)","body":"<p>In Excel, is it possible to paste in a long text and have that split into subgroups of 255 characters each? It does not have to be split at a space or anything like that.</p>\n\n<p>I tried to create a simple formula in Excel to get the first 255 characters of whatever is in column A, but not sure how to do this for the next sets of 255:</p>\n\n<p>This is what I tried to get them from column A: <code>=LEFT(A1,255)</code></p>\n"},{"tags":["excel","formatting","syntax-error","excel-formula","vlookup"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13203482,"title":"Can't find the error: VLOOKUP not returning the value","body":"<p>I am working with an excel file and I am trying to \"map\" some values with the vLookUp function.</p>\n\n<p>The first parameter of the vLookUp function is giving me headaches: The function works with certains values (typed by hand in a text format)...but doesnt work with pre-generated values (the sames ones...but generated from an ERP system..). I checked to make sure that I was looking for \"same nature\" values ( text vs text ) ...but I can't find out why the first 3 values (typed by hand) are fine... but the last 3 (pre generated) gives me a #N/A error: It has to be a difference of \"format\" ..but I can't find out where's  the difference...</p>\n\n<p>This is the formula used: =VLOOKUP(D1;$A$1:$B$219;2;FALSE)</p>\n\n<p><a href=\"https://www.dropbox.com/s/89hm1g3a1l6em0z/vlookup.xlsx\" rel=\"nofollow\">The actual file</a></p>\n\n<pre><code>1008600 379.99      1008600 379.99\n1008601 379.99      1008601 379.99\n1010600 449.99      1010600 449.99\n1010601 449.99      1010601 #N/A\n1013600 489.99      1013600 #N/A\n1014601 509.99      1014601 #N/A\n1015600 569.99          \n1018603 679.99          \n1019600 809.99          \n</code></pre>\n\n<p>Thank you !</p>\n"},{"tags":["c#","silverlight","excel","openxml","silverlight-5.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13203201,"title":"How can I use OpenXml (Office) in Silverlight?","body":"<p>I installed this SDK to use OpenXml in my Silverlight application. The purpose is to import data from Excel without have the application installed.</p>\n\n<p>But I realized that I cannot use some assemblies in Silverlight like <code>System.IO.Packages</code>, so I have no idea how can I get the data from the Excel.</p>\n\n<p>Does you know free assembly from CodePlex or another site to get some data?</p>\n"},{"tags":["excel","vba","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13200638,"title":"How To Change The Number Of Dropdown Items Shown for an Excel VB6 Form Combobox","body":"<p>By default a Combobox displays 8 Items in it's Dropdown List</p>\n\n<p>Can anybody point me to some (hopefully MINIMAL) Excel VB6 Code to change this default?</p>\n\n<p>Looks like it will have to include API's</p>\n\n<p>I can find examples for VB6 (\n<a href=\"http://stackoverflow.com/questions/1282942/vb6-extend-number-of-items-in-combo-box/\">VB6: Extend number of items in combo box</a>), but none specific to an Excel VB6 Form Combobox</p>\n"},{"tags":["java","excel","sorting","row","apache-poi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":13134490,"title":"Apache-POI sorting rows in excel","body":"<p>I'd like to sort rows in a sheet by one of string column. I tried to achive that using Sheet.shiftRows method, but I cannot manage with that. It doesn't switch positions of rows in my method. What's wrong in my code? Or maybe there is better way to sort rows by any String column in excel?</p>\n\n<pre><code>    /**\n * Sorts (A-Z) rows by String column\n * @param sheet - sheet to sort\n * @param column - String column to sort by\n * @param rowStart - sorting from this row down\n */\nprivate void sortSheet(Sheet sheet, int column, int rowStart) {\n    boolean sorting = true;\n    int lastRow = sheet.getLastRowNum();\n    while (sorting == true) {\n        sorting = false;\n        for (Row row : sheet) {\n            // skip if this row is before first to sort\n            if (row.getRowNum()&lt;rowStart) continue;\n            // end if this is last row\n            if (lastRow==row.getRowNum()) break;\n            Row row2 = sheet.getRow(row.getRowNum()+1);\n            if (row2 == null) continue;\n            String firstValue = (row.getCell(column) != null) ? row.getCell(column).getStringCellValue() : \"\";\n            String secondValue = (row2.getCell(column) != null) ? row2.getCell(column).getStringCellValue() : \"\";\n            //compare cell from current row and next row - and switch if secondValue should be before first\n            if (secondValue.compareToIgnoreCase(firstValue)&lt;0) {                    \n                sheet.shiftRows(row2.getRowNum(), row2.getRowNum(), -1);\n                sheet.shiftRows(row.getRowNum(), row.getRowNum(), 1);\n                sorting = true;\n            }\n        }\n    }\n</code></pre>\n\n<p>Any idea how to manage row sorting in a sheet?</p>\n"},{"tags":["excel","openxml","spreadsheetml"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":5895,"score":3,"question_id":2624333,"title":"How do I read data from a spreadsheet using the OpenXML Format SDK?","body":"<p>I need to read data from a single worksheet in an Excel 2007 workbook using the Open XML SDK 2.0.  I have spent a lot of time searching for basic guidelines to doing this, but I have only found help on creating spreadsheets.</p>\n\n<p>How do I iterate rows in a worksheet and then iterate the cells in each row, using this SDK?</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13202374,"title":"Find row with specified text quickly","body":"<p>Okay, So I have a very large excel sheet in which I need to find a row with a specified string of text. The size of this sheet is on the order of 10,000 rows. I am currently doing things like this:</p>\n\n<pre><code>    sheet = workbook.ActiveSheet;\n\n  // FIND the tape id in column: __________\n        int cellRow = 0;\n        int x = 0;\n        for (x = 1; x &lt;= 1000000; x++)\n        {\n            if (sheet.Cells[43][x].text.Contains(tapeID))\n            {\n                cellRow = x;\n                break;\n            }\n        }\n</code></pre>\n\n<p>The problem is that this goes on for quite some time....and therefore too slow for my needs. I tried to do the sheet.find() method but it was returning a whole bunch of cells that were wrong.....can somebody help me implement the sheet.find or tell me about a faster way to do this?</p>\n\n<p>I implemented find like this:</p>\n\n<pre><code>        sheet = workbook.ActiveSheet;\n           Microsoft.Office.Interop.Excel.Range currentFind = currentFind = sheet.Cells.Find(tapeID, Type.Missing,\n    Microsoft.Office.Interop.Excel.XlFindLookIn.xlValues, Microsoft.Office.Interop.Excel.XlLookAt.xlPart, \n    Microsoft.Office.Interop.Excel.XlSearchOrder.xlByRows, Microsoft.Office.Interop.Excel.XlSearchDirection.xlNext, false,\n    Type.Missing, Type.Missing); \n</code></pre>\n\n<p>But when I look at whats inside with\nstring value = currentFind[0][0].Text </p>\n\n<p>I get the wrong cell.....does excel use zero addressing here?...going to investigate</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13174916,"title":"Transpose a range in VBA","body":"<p>I am Trying to Transpose a range of cells in Excel through VBA macro but I am getting some errors, mostly Error 91. I am pretty new to VBA and dont have much idea about functions either.</p>\n\n<pre><code>Range(InRng).Select\nSet Range1 = Selection\nDim DestRange As Range\nSet DestRange = Application.WorksheetFunction.Transpose(Range1)\n</code></pre>\n\n<p>After going through a couple of forums, this is what I have comeup with. One thing to note is that I don't have to copy them into any other cells. What I am trying to achieve is to create a co-variance method and in the optio window the user will have the option to select the range and then choose either by columns or rows, this will then affect the resulting covariance matrix.</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13201138,"title":"Can I use user input from a header to auto-fill other headers?","body":"<p>I have a workbook with ten different spreadsheets inside it.  Each spreadsheet has a header that follows this format: \"Project Name - Name of Spreadsheet - Revision Date:\".</p>\n\n<p>For instance, example spreadsheet headers should look like this:</p>\n\n<pre><code>\"Test Project - Form 1 - Revision Date: \"\n\"Test Project - Form 2 - Revision Date: \"\n\"Test Project - Form 3 - Revision Date: \"\n</code></pre>\n\n<p>And so on..</p>\n\n<p>I would like to accommodate the user by only making them type the \"Project Name\" one time, and then it would auto-fill the rest of the headers with that value.  I know it can be done quite easily with cells, but I'm not very experienced with Excel.  Can this be done with headers?</p>\n"},{"tags":["excel","openxml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":185,"score":1,"question_id":2764262,"title":"How can I get WorkbookPart from WorkSheet?","body":"<p><br>\nI am trying to create Excel file using OpenXML SDK. I have one situation to get WorkBookPart from WorkSheet instance. How can I get it?<br>\nThanks.<br>\nAnt.</p>\n"},{"tags":["java","excel","grails","servlets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13201393,"title":"\"Unable to read file\" in excel dowloaded from Servlet","body":"<p>When I download the file downloaded using this servlet code (grails), the zipped excel file seems to be corrupted. Here's the code-</p>\n\n<pre><code>def entry = new ZipEntry(name)\n            zipStream.putNextEntry(entry)\n            zipStream.write(doc.getBytes())\n        }\n\n        zipStream.close()\n\n        def zipBytes = byteStream.toByteArray()\n\n\n    response.setHeader(\"Content-Type\", \"application/octet-stream\")\n    response.setHeader(\"Content-Transfer-Encoding\", \"binary\")\n    response.setHeader(\"Content-Disposition\", \"attachment; filename=detailTotal.zip\")\nresponse.setContentLength(zipBytes.length)\n    def outstream = response.getOutputStream()\n    outstream.write(zipBytes)\n</code></pre>\n"},{"tags":["c#","excel","interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13201384,"title":"Enhance Interop FormatConditons performance","body":"<p>I have a tool that generates reports in Excel using Interop and using a lot of conditional formatting data bars.</p>\n\n<p>I found that the performance hit was HUGE when adding the conditional formats through Interop.</p>\n\n<p>The question is: Is there a way to enhance the performance of Interop conditional formatting?</p>\n"},{"tags":["excel","pivot","pivot-table"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13201055,"title":"Custom Calculation Based on Pivot Table Data","body":"<p>I have a pivot table that returns the following data:</p>\n\n<p><code>Accounting_Code</code> - <code>(Values are 12345, 23456, 45678)</code></p>\n\n<p><code>Users</code> - <code>(Values are User 1, User 2, USer 3)</code></p>\n\n<p><code>Total_Time</code> - <code>(Values are Hours logged per accounting code per user)</code></p>\n\n<p>I would like to create two custom fields based on the accounting code.\nThe first is to create a field called 'Core' which calculates based on the value of 12345 from the Accountg field.  The second is called 'Other' and calculates values based on items that are anything other than 'Core'.</p>\n\n<p>My intent is to capture the % of time people are spending between Core and Other.</p>\n\n<p>I am struggling coming up with the formula to get this data based on the value of a field.\nCan someone help?\nThanks!</p>\n"},{"tags":["c++","excel","fstream"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13200809,"title":"Read cells from Excel in C++?","body":"<p>I was wondering how you can read specific cells from an Excel spreadsheet, in C++. I understand we have to use the \"fstream\" library, but I don't know exactly how I could get those values from a certain cell, and print it on the screen. Any help would be appreciated, thanks!\nCarpetfizz</p>\n"},{"tags":["excel","vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13200811,"title":"How to set the macro results into the excel column? Am new to Macro's and very basic. Please explain it","body":"<p>'Need to set the value of employee(0), employee(1)......,employee(25) in the A column of excel \"Sheet1\".</p>\n\n<pre><code>Sub testingarray()\nFor n = 0 To n = 25\nemployee(n) = Chr(n + 65)\nNext n\nFor n = 0 To n = 25\nMsgBox employee(n) \nNext n\nEnd Sub\n\n'Tried to use this:** Please say if am wrong\nPublic Sub putvalue()\nRange(\"A1\").Value = employee(0)\n'Sheets(\"Sheet1\").Cells(1, 1).Value = employee(n)\nn = n + 1\nEnd Sub\n</code></pre>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13126852,"title":"Opening an excel sheet in \"Excel 2003 with a custom built extension\" using WSH","body":"<p>I am trying to open an excel sheet with Excel 2003 that has a custom built extension.</p>\n\n<p>I am able to open that specific version of excel which has custom built extension using the file path but I am not able to open a certain file it. </p>\n\n<p>This is what I want to do:</p>\n\n<p>1) Open Excel 2003 with a custom built extension\n2) Open a specific file in it\n3) Run a macro\n4) close</p>\n\n<p>I can not simply open an excel file because it opens it with normal Excel 2003 which does not have the custom built extension to it. Therefore, I have to open the Excel 2003 with the custom built extension and then open the excel file that I want to open.</p>\n\n<p>I know I was kind of all over the place asking the question but if it needs clarification I will explain it more.</p>\n"},{"tags":["java","excel","jsf","richfaces","apache-poi"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13199185,"title":"How to export rich:dataTable to excel","body":"<p>I would like to export the contents of a <code>&lt;rich:dataTable&gt;</code> or <code>&lt;rich:extendedDataTable&gt;</code> to excel. </p>\n\n<ul>\n<li><p>I have see that PrimeFaces has the \"exporter feature\" <a href=\"http://www.primefaces.org/showcase/ui/exporter.jsf\" rel=\"nofollow\">http://www.primefaces.org/showcase/ui/exporter.jsf</a></p></li>\n<li><p>I would like to be able to do something similar to this only with out using PrimeFaces, but with richFaces (version 3.3.3)...(I would like to migrate to RichFaces 4 at some point in the future but am stuck with 3.3.3 for now)</p></li>\n<li><p>I have read that it is possible to build your own using  <a href=\"http://poi.apache.org/\" rel=\"nofollow\">http://poi.apache.org/</a> but I do not know where to start on implementing something like this...</p></li>\n</ul>\n\n<p>Any thoughts about how best to preform the desired export and examples would be much appreciated! </p>\n"},{"tags":["vb.net","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13199387,"title":"Excel commands are not evaluated when setting the value of a range","body":"<p>I am trying to use a multidimensional array of strings to fill an excel sheet and have run into trouble when inserting formulas. The following small case illustrates the problem:</p>\n\n<pre><code>Dim tA(3, 3) As String\ntA(1, 1) = \"=HYPERLINK(\"\"www.stackoverflow.com\"\")\"\ntA(1, 2) = \"=HYPERLINK(\"\"www.stackexchange.com\"\")\"\ntA(2, 1) = \"=2+5\"\ntA(2, 2) = \"Normal Text\"\nworksheet.Range(worksheet.Cells(1, 1), worksheet.Cells(4, 4)).Value = tA\n</code></pre>\n\n<p>When this code is evaluated, the excel sheet does not automatically convert the hyperlinks or evaluate the formulas. That is, when I look at Excel, the cell at (2,1) will display \"=2+5\" instead of \"7\" as desired. Is there a way to force excel to evaluate all cells to see if a command is present?</p>\n\n<p>I should note that if I insert a command into an individual cell then it is evaluated properly, but that isn't an option as I have many thousands of cells and filling them one at a time is several orders of magnitude slower.</p>\n"},{"tags":["sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13199120,"title":"Export SQL data to Excel","body":"<p>I have a webpage requesting data data from an SQL database. I am using the sqldrv. I converted this code which was using the old mssql driver. but be aware I AM NOT A PROGRAMMER....  </p>\n\n<p>This data is then posted to a form in another page. This works perfectly with all the headers and data. What I would like to do is then export this to Excel keeping the same formatting.  </p>\n\n<p>I don't seem to be able to get any more than the headers and the first column of data into Excel. Could anyone point me in the right direction? Here is my code with the original code commented out.</p>\n\n<pre><code>/* Start of Formatting for Word or Excel */\n\n/* FORMATTING FOR EXCEL DOCUMENTS ('.xls') */\n//create title with timestamp:\nif ($Use_Title == 0)\n{\n    echo(\"$title\\n\");\n}\n//define separator (defines columns in excel &amp; tabs in word)\n$sep = \"\\t\"; //tabbed character\n\n//start of printing column names as names of sqlsrv fields\nforeach( sqlsrv_field_metadata($result) as $fieldMetadata)              \n//for($i = 0; $i &lt; sqlsrv_num_fields($result); $i++)\n{\n    echo $fieldMetadata['Name'] , \",\";\n    //echo  sqlsrv_field_metadata($result,$i) . \"\\t\";\n}\nprint(\"\\n\");\n//end of printing column names\n\n//start while loop to get data\nwhile( $row = sqlsrv_fetch_array($result, SQLSRV_FETCH_NUMERIC))\n{\n    //set_time_limit(60); // HaRa\n    //$schema_insert = \"\";\n    echo $row[0], \",\";\n\n//$schema_insert . \"$result\".$sep;\n//$schema_insert .= \"$row[$j]\".$sep;\n////$schema_insert = str_replace($sep.\"$\", \"\", $schema_insert);\n//following fix suggested by Josue (thanks, Josue!)\n//this corrects output in excel when table fields contain \\n or \\r\n//these two characters are now replaced with a space\n////$schema_insert = preg_replace(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n////$schema_insert .= \"\\t\";\n////print(trim($schema_insert));\nprint \"\\n\";\n</code></pre>\n"},{"tags":["excel","csv","numbers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13197163,"title":"csv in excel and numbers not working correct","body":"<p>I have a list in 3 columns.\nIn order to upload to my mailing list I need to convert in cdv.\nNO PROBLEM - BUT\nOnce converted everything is in one column only seperated by commas.</p>\n\n<p>have been through all forums in the last three days.\nCan this be a language set up on my computer.\nbecause it works on other computers.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13198438,"title":"Oracle data access with vba","body":"<p>I keep getting a 424 error when setting my con object</p>\n\n<pre><code>Dim con As Object\nDim rs As Object\nDim query As String\nSet con = CreateObject(ADODB.Connection)\nSet rs = CreateObject(ADODB.Recordset)\n\nstrCon = \"Driver={Microsoft ODBC for Oracle}; \" &amp; _\n\"CONNECTSTRING=(jdbc:oracle:thin\" &amp; _\n\"(ADDRESS=(PROTOCOL=TCP)\" &amp; _\n\"(HOST=somehost)(PORT=10080))\" &amp; _\n\"(CONNECT_DATA=(SERVICE_NAME=somename))); uid=uid; pwd=pwd;\"\n</code></pre>\n\n<p>could anyone let me no what i am doing wrong?</p>\n\n<p>thanks</p>\n"},{"tags":["excel","ms-word","vsto","clipboard","copy-paste"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13191157,"title":"How to copy from Excel to Word without using the clipboard?","body":"<p>I've written a C# application that copies cell ranges of an Excel workbook as images in a Microsoft Word document, using the Excel.Range.CopyPicture or Excel.Range.Copy methods.\nBut processing big Excel files can take time, and if the user uses the Clipboard in an other application during the process, my application can crash.\nI'm wondering if there is a way to copy Excel cell ranges as images in a Word document without using the clipboard, to avoid this kind of issues.</p>\n\n<p>Thanks for your help,\nJulien</p>\n"},{"tags":["excel","odbc"],"answer_count":0,"favorite_count":1,"up_vote_count":5,"down_vote_count":6,"view_count":151,"score":-1,"question_id":13151757,"title":"Are transactions available using Microsoft's ODBC driver?","body":"<p>I am using a Windows environment with Microsoft's ODBC.</p>\n\n<ol>\n<li>Are transactions available using Microsoft's ODBC?</li>\n<li>How do I add a primary key or auto-increment field to the Excel database?</li>\n<li>What field types are available? (in query string)</li>\n</ol>\n\n<p>I found that INT and TEXT are provided, but when I stored INTs in the excel file via ODBC, and opened the excel file in Excel 2003, the INTs were represented in scientific notation. I need to avoid this.</p>\n\n<p>I have done research, but found inadequate infomation.  </p>\n\n<p>I figured out one constraint: You cannot do SELECTs after you use INSERTs unless you close the database.</p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13192981,"title":"Performing 'text to columns' on a number of columns - loop required","body":"<p>I have some code that I use to perform text to columns and it has worked fine for me for on one column.  </p>\n\n<p>Unfortunately, I have up to 60 columns that I need to split to columns (in sheet 3). I would like to copy column a in sheet 3 to column a in sheet 4 and perform text to columns on it. Then I would like to copy Column B in Sheet 3 to the next available row in sheet 4 (after the delimited text), and repeat the process.</p>\n\n<p>When I start my macro below, it appears to be looping through sheet 3 but after running it there is nothing in sheet 4.  </p>\n\n<pre><code>Sub LoopColumns()\n\n\nDim i As Integer, j As Integer\n\nFor i = 1 To 60\n'Check to see if column is blank\nIf WorksheetFunction.CountBlank(ActiveSheet.Columns(i)) &lt;&gt; 1048576 Then\nColumns(i).Select\nSelection.Copy\nSheets(\"Sheet4\").Select\n\nFor j = 1 To 10000\nIf WorksheetFunction.CountBlank(ActiveSheet.Columns(j)) &lt;&gt; 1048576 Then\nColumns(j).Select\nActiveSheet.Paste\nColumns(j).Select\nApplication.CutCopyMode = False\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\nTextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\nSemicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\nArray(7, 1), Array(8, 1)), TrailingMinusNumbers:=True\nEnd If\nNext j\n\nEnd If\nSheets(\"Sheet3\").Select\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I think that my logic is ok. Can you see where I am going wrong exactly? Thanks!</p>\n"},{"tags":["excel","load","add-in","xll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13196450,"title":"Loading XLL in Excel: any difference between Tools->AddIn and File->Open?","body":"<p>I have got an XLL, and want to load it in Excel. </p>\n\n<p>Is there any difference between loading using Tools->AddIn or File->Open other than\n* it is impossible to unload it if I use File->Open;\n* it won't be loaded automatically if I restart Excel.</p>\n\n<p>Thanks!</p>\n"},{"tags":["excel","excel-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13191287,"title":"Find something in column A then show the value of B for that row in Excel 2010","body":"<p>Basically my problem is that I have a string in one cell in excel, I then need to see if that string exists in another row (not one cell but the whole row) and if so then print the contents of another cell in the same row but in another column. </p>\n\n<p>I will give a basic example:</p>\n\n<pre><code>Title      Answer\nPolice       15\nAmbulance    20\nFire         89\n</code></pre>\n\n<p>Now I need to scan the title column for, say, \"Police\" and then populate the cell with the value under Answer (in this case 15).</p>\n\n<p>I cant just say <code>IF(A2=\"Police\";B2;\"\"</code> as I need the scan the whole of the Title column.</p>\n\n<p>I have tried using <code>IF(COUNTIF(A$2:A$100;\"Police\");</code> which scans the contents of A2 to A100 for the string Police, and know how to make it print a constant (just put something after the ;) but cant work out how to make that \"constant\" a variable that changes depending on the found row. So if the <code>COUNTIF</code> found Police in cell <code>A44</code> then the answer to my formula would be <code>B44</code>, the same as if it found Police in <code>A62</code> then my formula should show <code>B62</code></p>\n\n<p>I hope this makes sense and that someone can help me :)</p>\n\n<p>Note that I am using excel 2010 and need a normal formula as I can not use scripting for this document.</p>\n\n<p>EDIT:</p>\n\n<p>Here is what I have so far, note that the spreadsheet I am using is far more complex than the \"simple\" example I have in the question...</p>\n\n<pre><code>=IF(ISNUMBER(FIND(\"RuhrP\";F9));LOOKUP(A9;Ruhrpumpen!A$5:A$100;Ruhrpumpen!I$5:I$100);\"\")\n</code></pre>\n\n<p>This is showing <code>\"RuhrP\"</code> in every answer where <code>\"RuhrP\"</code> is found in <code>F9</code> and not the answer I want which should be that found in <code>RuhrPumpen!I$5:I$100</code> where the cell index is the same as that for the <code>A</code> coloum where <code>A9</code> was found. Again, sorry for the complexity I cant think of any better way to word it.</p>\n"},{"tags":["excel","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13195868,"title":"How to replace Text with corresponding images","body":"<p>I have an excel document with over 300 records.</p>\n\n<p>In the first row for each record, there is a User Image variable.\nThis record will always be <code>username.jpg</code> or empty.</p>\n\n<p>I have a folder with the corresponding images, all named in the exact same fashion.</p>\n\n<p>Is there any way to replace the text in the first row with their related images automatically?</p>\n"},{"tags":["c#","excel","pagebreak"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13196374,"title":"Excel automatically overrides my horizontal page breaks that I set in Gembox","body":"<p>I am creating an Excel spreadsheet in C# using GemBox. The end user needs the ability to open the spreadsheet and print without manually setting up all the 'ideal' page breaks. The problem I am running into is that Excel seems to automatically override the horizontal page breaks that I am creating in C#. Once opened in Excel, I can go to the Page Break Preview and see my page breaks as heavy blue lines, but then there are these other dotted blue lines (the auto page breaks) that end up getting used as the actual page breaks when printing. Why are my manual page breaks getting ignored? </p>\n\n<p>Here is a trimmed down sample of the code I'm using to create the Excel file. Note, I always want the data to fit to one page wide and print in landscape mode. I don't think that really changes the nature of the problem, though.</p>\n\n<pre><code>var file = new ExcelFile();\nvar sheet = file.Worksheets.Add(\"PrintTest\");\nsheet.PrintOptions.Portrait = false;\nsheet.PrintOptions.FitWorksheetWidthToPages = 1;\n\nfor (int i = 0; i &lt; data.Length; i++) {\n    //Write data to Excel file here\n    if (i == someCriteria) {\n        sheet.HorizontalPageBreaks.Add(i);\n    }\n}\nfile.SaveXls(path);\n</code></pre>\n"},{"tags":["sql","excel","adodb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13195696,"title":"ADODB/Excel query error","body":"<p>When I try to use ADODB to connect on an Excel DB, it says:</p>\n\n<pre><code>you try to execute a query without a specified expression &lt;Destinataire&gt;\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>MyQuery = \"Select Destinataire, SUM(\" &amp; Entete &amp; \") AS NombreTotal FROM [Feuil1$] \" _\n                         &amp; \"WHERE [DateMad] Between #\" _\n                         &amp; Format(date_deb, \"yyyy/mm/dd\") _\n                         &amp; \"# And #\" &amp; Format(date_fin, \"yyyy/mm/dd\") &amp; \"#\" &amp; Query3 &amp; \"\"\n\n                    objRecordSet.Open MyQuery, objConnection, adOpenStatic, adLockOptimistic\n</code></pre>\n\n<p>What's wrong with it?</p>\n"},{"tags":["excel","reference","location","cell","openxml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13186329,"title":"Why is Cell.CellReference optional? How do I get cell location otherwise?","body":"<p>According to the OpenXml spec CellReference is optional. But is there an alternative way to get a cell's location?</p>\n\n<p>For example, I can get a row's cells by something like:</p>\n\n<pre><code>foreach (Row r in sheetData.Elements&lt;Row&gt;())\n{\n    foreach (Cell c in r.Elements&lt;Cell&gt;())\n    {\n        Console.WriteLine(c.CellReference);\n    }\n} \n</code></pre>\n\n<p>But without CellReference, how do I know the cells' locations?</p>\n\n<p>I have done some research and all solutions seem to rely on comparing a cell's CellReference against a given string.</p>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13180234,"title":"Hours Calculations in Excel 2010","body":"<p>I have an Excel 2010 cell with the value of, say, 9876:54:32 (manually entered) representing 9876 hours, 54 minutes and 32 seconds of, say, phone talk time.\nThen I have a cell with the value of, say, 1000 (manually entered) representing 1000 calls.</p>\n\n<p>I want to divide the values to get the average talk time of 592.615 minutes per call.</p>\n\n<p>I'm doing a regular =A1/B1 and it gives me an error.</p>\n\n<p>Ideas?</p>\n\n<p><strong>* EDITED *</strong>\nThanks Brain Webster for correcting my math. I hat mean 9.876 hours. But the point is that Excel gives me an error, not my manual math. Playing around with it I discovered that Excel is fine with me with values up to 9999:59:59. Once I try with 10000:00:00 and up, it doesn't recognize it as a time value.</p>\n"},{"tags":["asp.net","excel","oledbconnection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13194358,"title":"The 'Microsoft.Jet.OLEDB.4.0' provider is not registered on the local machine","body":"<p>I am getting below error when after uploading my asp.net application on window server 2008 R2</p>\n\n<blockquote>\n  <p>The 'Microsoft.Jet.OLEDB.4.0' provider is not registered on the local\n  machine.</p>\n</blockquote>\n\n<p>I have used oleDbConnection class as below to read excel file</p>\n\n<pre><code>OleDbConnection excelConn = null;\n\n            try\n            {\n                if (System.IO.Path.GetExtension(fileName) == \".xlsx\")\n                {\n\n                    excelConn = new OleDbConnection(@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + fileName + \"; Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'\");\n                }\n                else\n                {\n                    excelConn = new OleDbConnection(@\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + fileName + \"; Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'\");\n                }\n\n                excelConn.Open();\n                DataTable dt = new DataTable();\n\n                dt = excelConn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);\n</code></pre>\n\n<p>After searching google i found that i need to install <strong><a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=23734\" rel=\"nofollow\">2007 Office System Driver</a></strong>\nso i have also tried that however i am getting same error.</p>\n"},{"tags":["excel","macros","sikuli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13192888,"title":"How to run sikuli from onclick button in excel using macro?","body":"<p>Im new to vbscript.In excel sheet i have some data,at the end of the every row i have a onclick button.My requirement is when i click on a button it has to run sikuli from command prompt.Is it possible using macro in excel? I dont know which command is used to open and run the command prompt in vbscript.can anybody help me.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":12892654,"title":"POI says Cell is empty but cell has a value","body":"<p>I'm opening a Excel (xls) file in my Java Application with POI.\nThere are 30 Lines in this Excelfile.\nI need to get the Value at ColumnIndex 9.</p>\n\n<p>My code:</p>\n\n<pre><code>Workbook wb;\nwb = WorkbookFactory.create(inp);\nSheet sheet = wb.getSheetAt(0);\nfor (Row row : sheet) {\n    if (row.getLastCellNum() &gt;= 6) {\n        for (Cell cell : row) {\n             if(cell.getColumnIndex == 9) {\n                 //do something\n              }\n         }\n     }\n}\n</code></pre>\n\n<p>Every Row in Excel has Values in Columns 1-14.\nMy problem is, only some Values are recognized. I wrote the same value in every cell in ColumnIndex 9 (10th Column in my Excel sheet), but the Problem is still the same.</p>\n\n<p>What could cause this problem?</p>\n"},{"tags":[".net","excel","excel-2007","openxml","openxml-sdk"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":301,"score":2,"question_id":6888290,"title":"How can I strip macros from an Excel workbook?","body":"<p>I am currently forced to use Office Live / Skydrive (whatever the proper name is) to edit Excel workbooks. Skydrive won't let me upload a workbook that contains macros, and I don't need the macros, so I would like to write a little cleansing app in C# that simply removes all macros. How can I go about this using Excel 2007 and above (.xlsm) documents?</p>\n\n<p><strong>EDIT:</strong>  Basically, I would like to open an xlsm document and save it as an xlsx document, without required Excel to be installed, i.e. via the OpenXML SDK or something.</p>\n"},{"tags":["c#","vb.net","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13192463,"title":"how delete all rows from excel except header of column name using C# or vb form or script","body":"<p>I want to delete all rows from excel except column heading plz give me source code how to do it in c# or vb</p>\n"},{"tags":["excel","excel-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":442,"score":0,"question_id":8181749,"title":"Adding Appostrophe in every field in particular column for excel","body":"<p>How can you add an apostrophe in every field in an [tag:Excel spread sheet without individually typing it in? I have got like 5k fields</p>\n\n<p><img src=\"http://i.stack.imgur.com/wO5ga.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c++","excel"],"answer_count":7,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":250,"score":2,"question_id":8666310,"title":"Figuring out the number corresponding to a letter of the alphabet?","body":"<p>I'm trying to duplicate the way excel provides labels its columns where</p>\n\n<blockquote>\n  <p>A = 1<br>\n  B = 2  </p>\n</blockquote>\n\n<p>so on and so forth, so that it eventually reaches</p>\n\n<blockquote>\n  <p>AB<br>\n  AC<br>\n  AD  </p>\n</blockquote>\n\n<p>etc, etc.</p>\n\n<p>How  do I algorithmically take a number (like 52) and convert it to its equivalent alphabet representation?</p>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":278,"score":2,"question_id":7674135,"title":"Excel Vba Workbook_open stop working","body":"<p>I have an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> file with VBA macro that starts when the Workbook is opening by user.\nOne of the users added Protection Login password to this file, and now the Workbook_open() doesn't react anymore.</p>\n\n<p>It is <a href=\"/questions/tagged/excel-2003\" class=\"post-tag\" title=\"show questions tagged 'excel-2003'\" rel=\"tag\">excel-2003</a></p>\n\n<p>Any Ideas? </p>\n"},{"tags":["java","excel","zip","password-protection"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1258,"score":5,"question_id":8800583,"title":"How to password protect a zipped Excel file in Java?","body":"<p>I have a question about password protecting an Excel file.</p>\n\n<p>The situation is that, I have a zip file, that has an Excel file in it. I need to write a Java program, to password protect the Excel file. Hence, the user should be able to unzip the file (the zip file need not be password protected). But, the Excel needs to be password-protected. When the user tries to unzip the file, he should be able to do so.\nAnd when he tries to open the Excel file (which is inside the unzipped folder), it must ask for a password. The question is similar to <a href=\"http://stackoverflow.com/questions/1092027/protect-excel-file-with-java\">Protect excel file with java</a>, with the added complexity that, the Excel file is zipped.</p>\n\n<p>I have code, that password protects only the zip file, but this is not what I want.</p>\n\n<pre><code>import java.io.File;\nimport java.util.ArrayList;\nimport net.lingala.zip4j.core.ZipFile;\nimport net.lingala.zip4j.exception.ZipException;\nimport net.lingala.zip4j.model.ZipParameters;\nimport net.lingala.zip4j.util.Zip4jConstants;\n\n/**\n* Demonstrates adding files to zip file with standard Zip Encryption\n*/\n\npublic class AddFilesWithStandardZipEncryption\n{\n    public AddFilesWithStandardZipEncryption()\n    {\n    try {\n            // Initiate ZipFile object with the path/name of the zip file.\n            //ZipFile zipFile = new ZipFile(\"c:\\\\ZipTest\\\\AddFilesWithStandardZipEncryption.zip\");\n            ZipFile zipFile = new ZipFile(\"C:\\\\homepage\\\\workspace\\\\PasswordProtectedFiles\\\\new.zip\");\n\n            // Build the list of files to be added in the array list\n            // Objects of type File have to be added to the ArrayList\n            ArrayList filesToAdd = new ArrayList();\n            //filesToAdd.add(new File(\"C:\\\\homepage\\\\workspace\\\\passwordprotectedzipfile\\\\profile\\\\profile.txt\"));\n            filesToAdd.add(new File(\"C:\\\\homepage\\\\workspace\\\\PasswordProtectedFiles\\\\new.xlsx\"));\n            //filesToAdd.add(new File(\"c:\\\\ZipTest\\\\myvideo.avi\"));\n            //filesToAdd.add(new File(\"c:\\\\ZipTest\\\\mysong.mp3\"));\n\n            // Initiate Zip Parameters which define various properties such\n            // as compression method, etc.\n            ZipParameters parameters = new ZipParameters();\n            parameters.setCompressionMethod(Zip4jConstants.COMP_DEFLATE); // set compression method to store compression\n\n            // Set the compression level\n            parameters.setCompressionLevel(Zip4jConstants.DEFLATE_LEVEL_NORMAL); \n\n            // Set the encryption flag to true\n            // If this is set to false, then the rest of encryption properties are ignored\n            parameters.setEncryptFiles(true);\n\n            // Set the encryption method to Standard Zip Encryption\n            parameters.setEncryptionMethod(Zip4jConstants.ENC_METHOD_STANDARD);\n\n            // Set password\n            parameters.setPassword(\"test123!\");\n\n            // Now add files to the zip file\n            // Note: To add a single file, the method addFile can be used\n            // Note: If the zip file already exists and if this zip file is a split file\n            // then this method throws an exception as Zip Format Specification does not \n            // allow updating split zip files\n            zipFile.addFiles(filesToAdd, parameters);\n        }\n        catch (ZipException e)\n        {\n            e.printStackTrace();\n        }\n    }\n\n    public static void main(String[] args)\n    {\n        new AddFilesWithStandardZipEncryption();\n    }\n}\n</code></pre>\n"},{"tags":["sql-server","web-services","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13174587,"title":"Reading data from sql server into excel sheet via Web Service","body":"<p>consider you have an existing excel worksheet, which needs to load data from sqlserver. The data is normalized, so reading from a table is not an option. Btw, it's Excel 2010.</p>\n\n<p>I tried to provide the data via <b>stored procedure</b>, but since I have to do some <b>data transformation</b>, SPs are not an option.</p>\n\n<p>The next idea is to provide the data via <b>web service</b>. I read this <a href=\"http://msdn.microsoft.com/en-us/library/office/dd819156%28v=office.12%29.aspx\" rel=\"nofollow\">article</a> but I don't like the result, because the content of the worksheet is written in the .Net code. The solution I'd prefer would be some kind of <b>data provider</b>, which can be used directly in the excel sheet, similar to reading data directly from a table.</p>\n\n<p>Is there a way to achieve that?</p>\n\n<p><b>Edit</b><br />\nBecause of the first comments and answers. Consider as data transformation e.g. a conversion from ticks (<code>long</code>) to <code>DateTime</code>. I've to do it in .net, because the result depends on the target time zone.</p>\n"},{"tags":["excel","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":122,"score":0,"question_id":12316086,"title":"Export GridView to Excel with Remove some selected columns","body":"<p>I'm here using <code>GridView</code> to show data. And for exporting <code>Gridview</code> data into excel format, I'm using a button - <code>\"Download into Excel\"</code>. The downloading into Excel format or Exporting into Excel is working perfectly. That <code>GridView</code> is showing total of 9 Columns.</p>\n\n<p>My problem is I wanna show 7 columns (as per our choice) among them in the Excel Sheet.\nThe <code>GridView</code> which is showing should be remain as usual but Excel will show only those columns which we want.</p>\n\n<p>I've already used <code>GridView1.Columns.RemoveAt(2);</code>\nBut this removes randomly more numbers of columns.</p>\n"},{"tags":["excel","vba","gui","automation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13191040,"title":"Excel, interact with UserForms using VBA","body":"<p>I have a hundred of Excel programs that can generate different types of report. Those\nprograms contains UserForms which requires users login database or specify other details, before generate the report. Now, users need to enter those information manually to generates the reports.</p>\n\n<p>I would like to know that is there any way I can use VBA to automate the report generation process. \nFor example, I need a programs to open another workbooks, enter the username password and press enter. </p>\n\n<p>I am wondering if Sendkeys function can help me to do so? </p>\n"},{"tags":["php","excel","phpexcel"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1044,"score":1,"question_id":7975381,"title":"PHPExcel: How to get a CELL COLOR","body":"<p>I am using PHPExcel project, but I am having a question in mind, and without solution on the earth.</p>\n\n<p>I had googled for this question for a while, but I CAN NOT find a way to get a CELL BACKGROUND COLOR!</p>\n\n<p>I tried to use the method 'getColor()' or what ... it doesn't work or just shows the warning message...</p>\n\n<p>Can somebody please tell me how to get a CELL COLOR using PHPExcel? THANKS</p>\n"},{"tags":["sql-server","excel","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13186656,"title":"SELECT * INTO -> Excel worksheet using SQL Server 2008","body":"<p>I want to select from a SQL Server table directly into an empty Excel spreadsheet.  </p>\n\n<p>I can select FROM a spreadsheet into another SQL Server table (see example below).  </p>\n\n<p>I can select directly from ACCESS to an empty spreadsheet (see example below).  </p>\n\n<p>But I cannot find a way select from SQL Server directly into an empty spreadsheet.  </p>\n\n<p>(I manipulate a ton of legacy data by importing spreadsheets, manipulating the data several times, then I need to export it for consumption by other programs that require csv files.  Right now I have to create an intermediate step of pulling it into ACCESS to get it back out to Excel. I leverage the <code>SELECT * INTO</code> to format the tables because I format the source table as I work on the data.)  </p>\n\n<p>Thanks for the help.</p>\n\n<p>I can <code>SELECT * INTO</code> a SQL Server table from Excel via the following code:</p>\n\n<pre><code>string query = \"SELECT * INTO \" + tableName + \" \" +\n               \"FROM OPENROWSET('Microsoft.ACE.OLEDB.12.0',\" +\n               \"'Excel 12.0;Database=\" + EXCELfilpath + \";IMEX=1',\" +\n               \"'SELECT * FROM [\"+sheetName+\"$]')\";\n</code></pre>\n\n<p>Also I can select from ACCESS table directly into Excel</p>\n\n<pre><code> //Select the ACCESS Table INTO an Excel Spreadsheet\n            try\n            {\n                //SELECT INTO command                \n                string cnStr = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + AccfilePath +\n                   \";Persist Security Info=False\";\n\n                ConnOpen(cnStr);\n\n                using (connectionToDatabase)\n                {\n                    //Give the Export Table (destination) a Name\n                    //baseTblName = dt.TableName;\n\n                    //Generate the SQL string to SELECT * INTO the NEW table in destination\n                    string selectcmd = \"SELECT * INTO [Excel 12.0;Database=\"+ExfilePath+\"].\" + tblName + \" FROM \" + tblName;\n\n\n                    using (OleDbCommand createCmd = new OleDbCommand(selectcmd, connectionToDatabase))\n                    {\n                        createCmd.ExecuteNonQuery();\n                    }\n\n                    ConnClose();\n                }\n            }\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13189554,"title":"updating target workbook extracting data from source workbook","body":"<p>I have 2 workbooks One having List of documents with some columns say List</p>\n\n<p>List  city   manager</p>\n\n<p>abc \nabc1 \nxyz </p>\n\n<p>and other having names in the list in a column\nsay A1 having abc</p>\n\n<p>&amp; values of city &amp; manager in other colums say C10 &amp; C11 respectively \nfor every item in list I have saperate workbook</p>\n\n<p>I want to add a button so that as I update city &amp; manager in workbook in abc &amp; press the button it get copied into List in row of abc in the List.</p>\n"},{"tags":["excel","encoding","csv","utf-8"],"answer_count":17,"favorite_count":2,"up_vote_count":30,"down_vote_count":0,"view_count":49950,"score":30,"question_id":4221176,"title":"Excel to CSV with UTF8 encoding","body":"<p>I have an Excel file that has some Spanish characters (tildes, etc.) that I need to convert to a CSV file to use as an import file.  However, when I do Save As CSV it mangles the \"special\" Spanish characters that aren't ASCII characters.  It also seems to do this with the left and right quotes and long dashes that appear to be coming from the original user creating the Excel file in Mac.</p>\n\n<p>Since CSV is just a text file I'm sure it can handle a UTF8 encoding, so I'm guessing it is an Excel limitation, but I'm looking for a way to get from Excel to CSV and keep the non-Ascii characters in tact.</p>\n"},{"tags":["php","excel","xlsx"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1215,"score":3,"question_id":10242879,"title":"Read excel xlsx file using simplexlsx in php","body":"<p>I am using <code>simplexlsx.class.php</code> to read xlsx file type. It's giving problems when the file contain date field in the excel file.</p>\n\n<p><strong>Sample output:</strong></p>\n\n<p>In the file data:</p>\n\n<p>Day             Date \nThursday        2/2/2012\nFriday              2/3/2012</p>\n\n<p><strong>Program output:</strong></p>\n\n<p>Day          Date    </p>\n\n<p>Thursday     40941<br>\nFriday           40942      </p>\n\n<p>It's not give the correct date </p>\n\n<pre><code>&lt;?php\n\nif (isset($_FILES['file'])) {\n\nrequire_once \"simplexlsx.class.php\";\n\n$xlsx = new SimpleXLSX( $_FILES['file']['tmp_name'] );\n\necho '&lt;h1&gt;Parsing Result&lt;/h1&gt;';\necho '&lt;table border=\"1\" cellpadding=\"3\" style=\"border-collapse: collapse\"&gt;';\n\nlist($cols,) = $xlsx-&gt;dimension();\n\nforeach( $xlsx-&gt;rows() as $k =&gt; $r) {\n    if ($k == 0) continue; // skip first row\n    echo '&lt;tr&gt;';\n    for( $i = 0; $i &lt; $cols; $i++)\n    {\n\n        echo '&lt;td&gt;'.( (isset($r[$i])) ? $r[$i] : '&amp;nbsp;' ).'&lt;/td&gt;';\n\n    }\n    echo '&lt;/tr&gt;';\n}\necho '&lt;/table&gt;';\n}\n\n?&gt;\n&lt;h1&gt;Upload&lt;/h1&gt;\n&lt;form method=\"post\" enctype=\"multipart/form-data\"&gt;\n*.XLSX &lt;input type=\"file\" name=\"file\"  /&gt;&amp;nbsp;&amp;nbsp;&lt;input type=\"submit\" value=\"Parse\" /&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["excel","vsto","add-in","office-interop"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":160,"score":1,"question_id":10106066,"title":"VSTO Starting EXCEL in code ADDIN NOT LOADED","body":"<p>I'm launching Excel from code using this code : </p>\n\n<pre><code>var excelApp = new MSExcel.Application { Visible = true };\nexcelApp.Workbooks.Add();\nexcelApp = null;\n</code></pre>\n\n<p>I've added the second line because without it the Excel automatically closes when the launcher closes. When I add new workbook it keeps alive. Howewer, my add-in that has nothing to do with the launcher won;t load. Any suggestions ? </p>\n\n<p>Thanks for your advice. </p>\n"},{"tags":["c#","asp.net-mvc","excel","iis","file-io"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13168268,"title":"Access Denied on a Shared Folder from MVC Web Application","body":"<p>I have an MVC Web application that generates Excel and PDF reports (using Crystal) using templates .xlt and .rpt, it generates the reports without a glitch when I place the templates in the web server itself but once I place the templates in a <strong>remote location</strong> then I get an Access Denied error which I found out through process monitor, screen shot below</p>\n\n<p><img src=\"http://i.stack.imgur.com/unDv6.png\" alt=\"enter image description here\"></p>\n\n<p>When I manually browse the remote folder through explorer from the server its all OK and I can open the files I needed its just fires the access denied error when its the server reading the files.  My web application is using the ApplicationPoolIdentity in Integrated Pipeline.  Authentication is through impersonation and Windows Authentication.  Whats even makes it confusing is that the User who runs the Excel templates is my self but I get the access denied, while user used in generating PDF is IIS Apppool.</p>\n\n<p>Does anyone know how to resolve the access denied issue, I already tried putting all users full access on that folder but still it does not work.</p>\n\n<p><strong>ADDITIONAL INFO</strong></p>\n\n<p>I am using IIS 7.5, I also checked on the File Server where the share is, on the Event Logs the user registered is not me but with the following details</p>\n\n<pre><code>An account was successfully logged on.\n\nSubject:\n    Security ID:        NULL SID\n    Account Name:       -\n    Account Domain:     -\n    Logon ID:       0x0\n\nLogon Type:         3\n\nNew Logon:\n    Security ID:        ANONYMOUS LOGON\n    Account Name:       ANONYMOUS LOGON\n    Account Domain:     NT AUTHORITY\n    Logon ID:       0x90eb7c7\n    Logon GUID:     {00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n    Process ID:     0x0\n    Process Name:       -\n\nNetwork Information:\n    Workstation Name:   MYWEBSERVER\n    Source Network Address: 10.10.10.01\n    Source Port:        00000\n\nDetailed Authentication Information:\n    Logon Process:      NtLmSsp \n    Authentication Package: NTLM\n    Transited Services: -\n    Package Name (NTLM only):   NTLM V1\n    Key Length:     128\n</code></pre>\n"},{"tags":["excel","vba","macros","comparison","cells"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":484,"score":1,"question_id":12069890,"title":"How do I compare text in Excel cells to see if same words are found?","body":"<p>I have several rows of Excel cells which contain a string of words, all separated by commas. I want to compare each cell with another cell to check if any of the words match/are duplicates. \nFor example:</p>\n\n<p>cell A1: <code>dog, cat, rabbit, mouse, lion, bear, tiger</code><br>\ncell A2: <code>sausage, pickle, dog, cat, elephant, bread</code></p>\n\n<p>result: <code>dog, cat</code> </p>\n\n<p>The result could also be a number (e.g. 2) if that is easier.\nMany thanks!</p>\n"},{"tags":["regex","excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2910,"score":6,"question_id":8146485,"title":"Returning a regex match in VBA (excel)","body":"<p>I am trying to write a function for excel 2010 that will take a cell of unstructured text, look for something called an sdi value and, if found, return that number. The sdi value will appear as sdi ####. What I want is to return sdi and the sepecific numbers that follow it, so if the cell contains \"some text sdi 1234 some more text\" the function will return sdi 1234. </p>\n\n<p>This is my function:</p>\n\n<pre><code>Function SdiTest(LookIn As String) As String\n  Dim temp As String\n  Dim STA As Object\n  temp = \"\"\n\n  Set SDI = CreateObject(\"VBScript.RegExp\")\n  SDI.IgnoreCase = True\n  SDI.Pattern = \"sdi [1-9]*\"\n  SDI.Global = True\n\n  If SDI.Test(LookIn) Then\n    temp = SDI.Execute(LookIn)\n  End If\n\n  SdiTest = temp\nEnd Function\n</code></pre>\n\n<p>If there is no sdi number it never enters the if statement and dutifully returns the empty string. If there is an sdi number I get #VALUE!</p>\n\n<p>What am I missing?</p>\n\n<p>Yes, VBScript is enabled. Additionally, I am finding it frustrating to use regex in VBA, and hard to find useful info online. Links to good online resources would be appreciated.</p>\n\n<p>Thank you</p>\n"},{"tags":["excel","worksheet-function","self-referencing"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5073,"score":0,"question_id":6335563,"title":"Self-reference for cell, column and row in worksheet functions","body":"<p>I'm posting this question to which I'll post an answer, to not only have one easy to google place to find this information when needed, but also hoping that there are some better ways or improvements that people will come up with.</p>\n\n<p>In a worksheet function in Excel, how do you self-reference the cell, column or row you're in?</p>\n\n<p>Note that this is extremely useful for conditional formatting.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":446,"score":2,"question_id":10612386,"title":"excel - combine multiple columns to a single column","body":"<p>I am new to excel sheet and stuck into this problem,\nMy excel sheet looks like this</p>\n\n<pre><code>      c1        c2      c3      c4\n\nROW1   abc      def      1       2\n\nROW2   abc      def      3       4\n\nROW3   klm      efg     11       5\n\nROW4   klm      efg     12      89\n</code></pre>\n\n<p>I want to combine the data into one single column separated by one comma for duplicate c1 entries. So excel sheet should look like this,</p>\n\n<pre><code>       c1        c2      c3      c4\n\nROW1   abc      def      1,3     2,4\n\nROW2   klm      efg     11,12    5,89\n</code></pre>\n\n<p>Please help to achieve this.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":77,"score":-1,"question_id":7890380,"title":"Saving Existing Excel sheet","body":"<p>How do I save an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> workbook using <a href=\"/questions/tagged/excel-vba\" class=\"post-tag\" title=\"show questions tagged 'excel-vba'\" rel=\"tag\">excel-vba</a>?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":114,"score":-2,"question_id":12402348,"title":"VBA- To export class module code from one worksheet to another class module or in worksheeets","body":"<p>I want to copy a code written in a class module  in <em>Book1.xls</em> and import the same code into another workbook - for example <em>Book2.xls</em></p>\n\n<p>I would like to used <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a>, and not manually using the export and import code options</p>\n"},{"tags":["excel","excel-2007","worksheet-function","array-formulas"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2486,"score":0,"question_id":5596219,"title":"I need to ignore blank cells in an excel 2007 MIN array but I keep getting 0's","body":"<p>Here is the array I have:  </p>\n\n<pre><code>{=MIN(IF('APRIL 2011'!E3:E999&lt;&gt;\"\",'APRIL 2011'!E3:E999  \n *('APRIL 2011'!E3:E999*('APRIL 2011'!D3:D999='APRIL TOTALS'!A2))))}  \n</code></pre>\n\n<p>It still returns zeroes with empty cells!</p>\n"},{"tags":["excel","data","size","limitations","spreadsheetgear"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":11548744,"title":"Is there a limit to the amount of data that can be held in a SpreadsheetGear WorkbookView?","body":"<p>I have an application that takes a table of data from Excel, and imports it into my embedded SpreadsheetGear.WorkbookView.  I am aware of the limitations to the size of a worksheet in Excel, but I was wondering if Excel is able to handle sets of data that is larger than SpreadsheetGear.  Has anyone ever run into this before?</p>\n\n<p>Jake</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13181494,"title":"Create a custom function in Excel","body":"<p>This seems like such an obvious thing that excel <em>must</em> have this feature, I just can't find it.</p>\n\n<p>How can I create a custom function without using VBA? (VBA is too big of a hammer and causes security warnings, etc).</p>\n\n<p>For example, I have a spreadsheet with several very complex formulas. Each of these formulas are replicated in several columns. Each column has hundreds of entries, so each one is replicated hundreds of times. If I tweak something then I have to manually fill-down or copy my change from one column to another.</p>\n\n<p>A simple one looks like this:<br>\n    =(Payment1 - F$12)*12 + ($D21-H21)<br>\nBut what I'd like to do is:<br>\n    =MyFunction(f$12,$D21,H21)<br>\nAnd have the actual formula for \"MyFunction\" written just once someplace.  </p>\n\n<p>I've found a few things that come close to giving me what I want. For example, in tables Excel will automatically replicate changes in a formula down the rest of the column saving you the step of manually selecting the range and doing a \"Fill Down\".</p>\n\n<p>It will also allow relative references off of named cells, which seems equivalent of a user-defined parameter-less functions.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13184691,"title":"I need help fixing vba macro","body":"<p>I have a dataset that is made up of a number of rows and columns e.g.</p>\n\n<pre><code>a1 b1\na2 b2\na3 b3\na4 b4\na5 b5\n</code></pre>\n\n<p>I want to write code that will loop through the cells one column at a time calculating an index like this (a2-a1)/(a2+a1). I want the result to be saved to sheet2.</p>\n\n<p>I have used this code but I keep getting an error. It breaks at where I am trying to save the results to sheet2.</p>\n\n<p>I need help to fix this code:</p>\n\n<pre><code>Sub Combination()\n\nDim jCell As Range\nDim kCell As Range\nDim result As Double\n\nSheet2.Cells.Clear\n\nFor Each jCell In ActiveSheet.UsedRange\n    For Each kCell In ActiveSheet.UsedRange\n        result = (jCell.Value - kCell.Value) / (jCell.Value + kCell.Value)\n\n        Sheet2.Cell(\"result\").Value = Sheet1.Cell(\"result\").Value\n\n    Next kCell\nNext jCell\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["excel","copy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13185082,"title":"Looking to copy/paste while decreasing lines in Excel","body":"<p>I am looking to copy an item in Row 1 of an excel spreadsheet, then paste that in a different window. Once that's complete, I need to copy an item in Row 2 and also paste that in a different window. Not sure if I made that clear but I'm looking for a way to gradually go down on the excel spreadsheet. </p>\n"},{"tags":["c#","excel","dataset","com-interop","worksheet"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13184191,"title":"Fastest way to drop a DataSet into a worksheet","body":"<p>A rather higeisch dataset with 16000 x 12 entries needs to be dumped into a worksheet.</p>\n\n<p>I use the following function now:</p>\n\n<pre><code>        for (int r = 0; r &lt; dt.Rows.Count; ++r)\n        {\n            for (int c = 0; c &lt; dt.Columns.Count; ++c)\n            {\n                worksheet.Cells[c + 1][r + 1] = dt.Rows[r][c].ToString();\n            }\n        }\n</code></pre>\n\n<p>I rediced the example to the center piece</p>\n\n<hr>\n\n<p>Here is what i implemented after reading the suggestion from <a href=\"http://stackoverflow.com/users/1630665/dave-zych\">Dave Zych</a>.\nThis works great.</p>\n\n<pre><code>    private static void AppendWorkSheet(Excel.Workbook workbook, DataSet data, String tableName)\n    {\n        Excel.Worksheet worksheet;\n        if (UsedSheets == 0) worksheet = workbook.Worksheets[1];\n        else worksheet = workbook.Worksheets.Add();\n        UsedSheets++;\n        DataTable dt = data.Tables[0];\n        var valuesArray = new object[dt.Rows.Count, dt.Columns.Count];\n\n        for (int r = 0; r &lt; dt.Rows.Count; ++r)\n        {\n            for (int c = 0; c &lt; dt.Columns.Count; ++c)\n            {\n                valuesArray[r, c] = dt.Rows[r][c].ToString();\n            }\n        }\n        Excel.Range c1 = (Excel.Range)worksheet.Cells[1, 1];\n        Excel.Range c2 = (Excel.Range)worksheet.Cells[dt.Rows.Count, dt.Columns.Count];\n        Excel.Range range = worksheet.get_Range(c1, c2);\n        range.Cells.Value2 = valuesArray;\n        worksheet.Name = tableName;\n    }\n</code></pre>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13184606,"title":"How to access excel headers using OLEDB using C#","body":"<p>i am creating a test cases for number of different test cases and each test case have id to it and i am trying to read the test data from the excel...</p>\n\n<p>here is the layout of my excel sheet and not sure how else to come up with the right design</p>\n\n<p><img src=\"http://i.stack.imgur.com/Jl8fh.png\" alt=\"Test Cases\"></p>\n\n<p>here is the code i'm reading:</p>\n\n<pre><code>string connectionString = \"Provider=Microsoft.Ace.OLEDB.12.0;Data Source=\" + filename + \";Extended Properties=\\\"Excel 8.0;HDR=YES;IMEX=1\\\"\";\n    string testCaseName = \"case_1\";\n    string query = \"SELECT * from [Sheet1$] WHERE test_case_id =\\\"\" + testCaseName + \"\\\"\";\n    DataTable dt = new DataTable();\n\n    using (OleDbConnection conn = new OleDbConnection(connectionString))\n    {\n        conn.Open();\n\n        using (OleDbDataAdapter dataAdapter = new OleDbDataAdapter(query, conn))\n        {\n            DataSet ds = new DataSet();\n            dataAdapter.Fill(ds);\n            dt = ds.Tables[0];\n        }\n\n        conn.Close();\n    }\n</code></pre>\n\n<p>Problem:</p>\n\n<p>The <code>test_case_id == 001_test</code> works fine without any problem</p>\n\n<p>but if pass the <code>test_case_id = 0059_test</code> then I'm getting the data for the same <code>test_case_id</code> which is <code>0059_test</code> but I'am not getting the header correct header name, i am getting the header for the <code>test_case_id 001_test</code></p>\n\n<p>My Question: How can I GET the header for the particular <code>test_case_id</code> (intro_text, api_text...._ ?</p>\n"},{"tags":["arrays","excel","excel-vba","multidimensional-array"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13183775,"title":"Excel VBA - How to Redim a 2D array?","body":"<p>In Excel via Visual Basic, I am iterating through a CSV file of invoices that is loaded into Excel. The invoices are in a determinable pattern by client.</p>\n\n<p>I am reading them into a dynamic 2D array, then writing them to another worksheet with older invoices. I understand that I have to reverse rows and columns since only the last dimension of an array may be Redimmed, then transpose when I write it to the master worksheet.</p>\n\n<p>Somewhere, I have the syntax wrong. It keeps telling me that I have already Dimensionalized the array. Somehow did I create it as a static array? What do I need to fix in order to let it operate dynamically?</p>\n\n<p><strong>WORKING CODE PER ANSWER GIVEN</strong></p>\n\n<pre><code>Sub InvoicesUpdate()\n'\n'Application Settings\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\n\n'Instantiate control variables\nDim allRows As Long, currentOffset As Long, invoiceActive As Boolean, mAllRows As Long\nDim iAllRows As Long, unusedRow As Long, row As Long, mWSExists As Boolean, newmAllRows As Long\n\n'Instantiate invoice variables\nDim accountNum As String, custName As String, vinNum As String, caseNum As String, statusField As String\nDim invDate As String, makeField As String, feeDesc As String, amountField As String, invNum As String\n\n'Instantiate Workbook variables\nDim mWB As Workbook 'master\nDim iWB As Workbook 'import\n\n'Instantiate Worksheet variables\nDim mWS As Worksheet\nDim iWS As Worksheet\n\n'Instantiate Range variables\nDim iData As Range\n\n'Initialize variables\ninvoiceActive = False\nrow = 0\n\n'Open import workbook\nWorkbooks.Open (\"path:excel_invoices.csv\")\nSet iWB = ActiveWorkbook\nSet iWS = iWB.Sheets(\"excel_invoices.csv\")\niWS.Activate\nRange(\"A1\").Select\niAllRows = iWS.UsedRange.Rows.Count 'Count rows of import data\n\n'Instantiate array, include extra column for client name\nDim invoices()\nReDim invoices(10, 0) \n\n'Loop through rows.\nDo\n\n    'Check for the start of a client and store client name\n    If ActiveCell.Value = \"Account Number\" Then\n\n        clientName = ActiveCell.Offset(-1, 6).Value\n\n    End If\n\n    If ActiveCell.Offset(0, 3).Value &lt;&gt; Empty And ActiveCell.Value &lt;&gt; \"Account Number\" And ActiveCell.Offset(2, 0) = Empty Then\n\n        invoiceActive = True\n\n        'Populate account information.\n        accountNum = ActiveCell.Offset(0, 0).Value\n        vinNum = ActiveCell.Offset(0, 1).Value\n        'leave out customer name for FDCPA reasons\n        caseNum = ActiveCell.Offset(0, 3).Value\n        statusField = ActiveCell.Offset(0, 4).Value\n        invDate = ActiveCell.Offset(0, 5).Value\n        makeField = ActiveCell.Offset(0, 6).Value\n\n    End If\n\n    If invoiceActive = True And ActiveCell.Value = Empty And ActiveCell.Offset(0, 6).Value = Empty And ActiveCell.Offset(0, 9).Value = Empty Then\n\n        'Make sure something other than $0 was invoiced\n        If ActiveCell.Offset(0, 8).Value &lt;&gt; 0 Then\n\n            'Populate individual item values.\n            feeDesc = ActiveCell.Offset(0, 7).Value\n            amountField = ActiveCell.Offset(0, 8).Value\n            invNum = ActiveCell.Offset(0, 10).Value\n\n            'Transfer data to array\n            invoices(0, row) = \"=TODAY()\"\n            invoices(1, row) = accountNum\n            invoices(2, row) = clientName\n            invoices(3, row) = vinNum\n            invoices(4, row) = caseNum\n            invoices(5, row) = statusField\n            invoices(6, row) = invDate\n            invoices(7, row) = makeField\n            invoices(8, row) = feeDesc\n            invoices(9, row) = amountField\n            invoices(10, row) = invNum\n\n            'Increment row counter for array\n            row = row + 1\n\n            'Resize array for next entry\n            ReDim Preserve invoices(10,row)\n\n         End If\n\n    End If\n\n    'Find the end of an invoice\n    If invoiceActive = True And ActiveCell.Offset(0, 9) &lt;&gt; Empty Then\n\n        'Set the flag to outside of an invoice\n        invoiceActive = False\n\n    End If\n\n    'Increment active cell to next cell down\n    ActiveCell.Offset(1, 0).Activate\n\n'Define end of the loop at the last used row\nLoop Until ActiveCell.row = iAllRows\n\n'Close import data file\niWB.Close\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13156753,"title":"Clear named ranges on a sheet, within a specified range?","body":"<p>What is the best way to clear all named ranges within part of a sheet?</p>\n\n<p>Something like:</p>\n\n<pre><code>Sheets(\"A\").Range(\"A1:D10\").ClearNames\n</code></pre>\n\n<p>?</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13184062,"title":"Repeatable template for each sheet in a workbook?","body":"<p>I have no advanced Excel education other than a college course, but I have been asked to revise a workbook.  I have done well so far, but the requester has asked for a couple things that may be beyond my scope.  </p>\n\n<p>The workbook consists of several spreadsheets.  Each spreadsheet has the potential to spill over to more than one page.  As such, the requester would like to know if it's possible to repeat rows and columns on each additional spillover page.</p>\n\n<p>Now, I know that I can use the \"Repeat Titles\" function to designate rows to repeat, but, in this instance, the first page's cells are formatted with different colors and have placeholder row labels.  I would prefer that the repeated row and column label cells (as well as cell borders) maintain their formatting, but the actual data cells be blank.  Is this possible?  It seems like it could be a difficult feat.</p>\n\n<p>My theory is that I could create a sort of template that repeats on each page, but modify the template on the first page to match the original look and feel of the requester's spreadsheet.   Additionally, this template would have to be different for each sheet!  Is there a way to accomplish this?</p>\n\n<p>Thank you!</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":249,"score":1,"question_id":5369572,"title":"Autoexecute an Excel macro","body":"<p>I have a macro which is executed on the striking of ctrl-u - I would like that macro to AUTOMATICALLY execute everytime a number gt > 0 is entered into A2 is there an easy way to do that?</p>\n"},{"tags":["excel","concatenation"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3618,"score":1,"question_id":570422,"title":"Auto-concatenate in Excel","body":"<p>I have a huge (~950 variables) survey response spreadsheet, made 2-4x larger than it needs to be because each item's individual response options are reported in separate columns.  E.g., If Question 2 is in cell A1 and has 3 response options, these are listed below the question in cells A2-C2, A3-C3, etc.  Note: Only one of A2-C2, etc. is filled w/ data for each observation.</p>\n\n<p>It seems clear that I <em>could</em> go through the spreadsheet manually and concatenate A2-C2 using code similar to this:</p>\n\n<pre><code>=CONCATENATE(IF(ISBLANK(A4),\"\",A4),IF(ISBLANK(B4),\"\",B4),IF(ISBLANK(C4),\"\",C4))\n</code></pre>\n\n<p>But, the above requires manually altering the code (questions have anywhere from 2-6 response options) and copying/pasting it through all observations for each of the 960 variables individually.  Because I'd like to finish this before dying of old age, I'd love to have some way of automating the above process.  </p>\n\n<p>It would be easy enough to go through and insert an identifier column (w/ no data but w/ some obvious 1st row name) after each variable's last response option so the code knows where to begin looking back for data to concatenate. The code would have to know to stop whenever it hits the previously concatenated result, and begin the current concatenation w/ the subsequent column. Once it hits a certain line (say, 60? I only have ~55 observations), it could just look for the next identifier column and repeat the process.</p>\n\n<p>Any ideas would be <em>much</em> appreciated.</p>\n\n<p>I need to check for blanks so as to not have extra spaces in the data (to aid future analysis).</p>\n\n<p>Hopefully the below will clarify the situation further. You're correct in your earlier comment; each question is followed by 55 rows of observations. For example:</p>\n\n<pre><code> | |   Q1   |         |        ||   Q2    |        || \n |-|--------|---------|--------||---------|--------||\n |1|   1    |         |        ||         |    2   ||\n |2|        |    2    |        ||         |    2   ||\n |3|        |         |    3   ||         |    2   ||\n |4|        |    2    |        ||    1    |        ||\n |5|        |         |    3   ||         |        ||\n |6|   1    |         |        ||         |    2   ||\n |7|   1    |         |        ||    1    |        ||\n |8|        |         |    3   ||    1    |        ||\n |9|        |    2    |        ||         |    2   ||\n</code></pre>\n\n<p>There isn't currently a blank column after the last response option for each question, but (as mentioned in the initial post) I can easily throw one in.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13183465,"title":"Why am I getting Object Required error (VBA, Excel)","body":"<p>Why is the following code wrong?</p>\n\n<pre><code>Sub SetFont()\n    Dim a1 As Range\n    Set a1 = Range(\"a1\")\n    SetFontSize (a1)\nEnd Sub\n\nSub SetFontSize(target As Range)\n    target.Font.Size = 11\nEnd Sub\n</code></pre>\n\n<p>I am getting <strong>\"Run-time error 424: Object required\"</strong> error when calling the <code>SetFontSize</code> method.</p>\n"},{"tags":["sql","excel","excel-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13183354,"title":"How do i insert or attached .sql file into my Excel.xls file?","body":"<p>I'm making project documentation though I want to attach many sql files with columns\nin excel file.</p>\n\n<p>I tried like <code>Insert Object</code> > <code>Create File</code></p>\n\n<p>but it is not attaching file nor able to link that file</p>\n\n<p>instead of link that file I would like to attachment in excel itself ,</p>\n\n<p>so that using only one Excel.xls file i will have all other attachment files with me</p>\n\n<p>How can I achieve this?</p>\n"},{"tags":["excel","excel-2010","pivot-table","powerpivot"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13180492,"title":"Excel: Custom Formula for Grand Total column","body":"<p>I have a frequent problem where the formula I want to use in the Values area in my Pivot-Table is different than the formula I want to use for the Grand Total column of that row. I typically want to Sum the Values but I want to average the Sums. Here is what I normally would get if I pivoted the dates on the Column Labels, Meat Type on the Row Labels, and Sum Orders in the Values. </p>\n\n<pre><code>Row Lables | Day 1 | Day 2 | Day 3 | Grand Total\n________________________________________________\nBeef       |  100  |  105  |  102  |   307\nChicken    |  200  |  201  |  202  |   603\n</code></pre>\n\n<p>I get sums by day and a sum of all of the days in the Grand Total column. Here is what I want to have:</p>\n\n<pre><code>Row Lables | Day 1 | Day 2 | Day 3 | Grand Total (Avg of Day Totals)\n________________________________________________\nBeef       |  100  |  105  |  102  |   102.3\nChicken    |  200  |  201  |  202  |   201.0\n</code></pre>\n\n<p>In this case the Orders are still summed by day but the Grand Total is now an average of the sums. What I do now is copy and paste the Pivot data onto a seperate sheet then calculate the averages. If there was a way to do this with a custom Grand Total column it would be incredible. This is one of the biggest shortcomings of Pivot Tables for me but I'm hoping it is due to my ignorance, which it often is. Thanks for the help!</p>\n"},{"tags":["c#","excel","add-on","excel-addins"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13183284,"title":"C# Excel Addin used like formula","body":"<p>Ok so I am developing an Excel addin that analyzes text in a cell then converts it. </p>\n\n<p>I want it to work like things do in excel like absolute value when you can type into a cell <code>=abs(YOURNUMBER)</code> and then it will replace the text of the cell with the absolute value of your number. </p>\n\n<p>How do i set up the excel add in to add a custom option that would accept strings in a fashion like this, except using <code>=molem(YOURSTRING)</code> instead?</p>\n"},{"tags":["sql-server","excel","excel-vba","sql-server-2000"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13182671,"title":"SQL Server 2000 : return a value when no record is returned","body":"<p>I have a list of about 1500 part numbers in an Excel document. I want to insert these part numbers in a query to pull descriptions from my database and then copy/paste the results back into the Excel document. </p>\n\n<p>The problem is some of the part numbers in my list aren't in my database, so when I go to copy/paste the results of my query into Excel they aren't going to match up because some of the part numbers in the query do not return a result.</p>\n\n<pre><code>SELECT ITEM.ITEMNO, ITEM.DESCRIPTION \nFROM ITEMS \nWHERE ITEM.ITEMNO IN ('1500','Part','Numbers')\n</code></pre>\n\n<p>It seems like a simple concept and my google searches have returned a lot of results, but they usually involve multiple tables and unions/joins. I just can't translate the examples I have seen to my query. If VBA is a better option then I am all ears.</p>\n"},{"tags":["excel","vba","scripting","macros","excel-vba"],"answer_count":5,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":30341,"score":10,"question_id":6301665,"title":"excel vba row number of last cell with data","body":"<p>column A has data like this (ie frequent blank cells):</p>\n\n<pre><code>HEADING  &lt;-- this is A1\nkfdsl\nfdjgnm\nfdkj\n\ngdfkj\n4353\n\nfdjk  &lt;-- this is A9\n</code></pre>\n\n<p>I would like to be able to get the cell reference of the last cell that has data. So in the above example I want to return: A9</p>\n\n<p>I have tried this but it stops at the first blank cell (ie returning A4)</p>\n\n<p>numofrows = destsheet.Range(\"A2\").End(xlDown).Row - 1</p>\n"},{"tags":["php","excel","pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13182535,"title":"Convert PDF to Excel","body":"<p>I need to convert a PDF to Excel, using my acrobat X I have tried to simply save as Excel, tried to save as word doc then convert, I have tried saving as xml, but its unusable. Here is the link to the PDF's I need help with <a href=\"http://www.dmv.ca.gov/vehindustry/mcp/mcp_actve_carrier.htm\" rel=\"nofollow\">Click</a></p>\n\n<p>Any suggestions? If there is a way to do it in PHP that is an option for me as well, I just am unable to find a solution to get this data out of the pdf's.</p>\n"},{"tags":["c#","excel","range","sheet"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":51,"score":3,"question_id":12948392,"title":"Is there a way to find a range within a range in Excel cSharp?","body":"<p>I have an xls file that looks this way:</p>\n\n<p><a href=\"http://i.stack.imgur.com/d2fux.png\" rel=\"nofollow\">http://i.stack.imgur.com/d2fux.png</a></p>\n\n<p>Well, and that's sth like the same piece of info that depends on the headers, in this case the header is the row 22164, next header is 22178, and so on.</p>\n\n<p>In the GUI, i have something that let users choose from parameters, and option to load the info from the xls file depending on their choices, for example, they can choose:</p>\n\n<blockquote>\n  <p>WR | random | 4 | 6 | 15</p>\n</blockquote>\n\n<p>looking in that case for the info stored in A22165:O22177</p>\n\n<p>I have already the sheet with all the info in the workbook, let's call that object[,] 'valueArray':</p>\n\n<pre><code>Workbook workBook = _excelApp.Workbooks.Open(censFilePath);\n        Worksheet sheet = (Worksheet)workBook.Sheets[1];\n        Range sheetRange = sheet.UsedRange;\n        object[,] valueArray = \n            (object[,])sheetRange.get_Value(XlRangeValueDataType.xlRangeValueDefault);\n</code></pre>\n\n<p>and I have created another object that stores the user's choices in the same order and format that the xls has. Let's call that object[,] sth like 'look4it'</p>\n\n<p>I'm trying to find a method that I can tell: I want to find 'look4it' in 'valueArray', and that method's answer would be A22164:E22164 so I can after that calculate the range to copy from 'valueArray' and use the correct info.</p>\n\n<p>I've tried Range.Find but it seems to be that looks for a unique piece of info within a Range, and returns the address, but I've found nothing that allows me to looks for a Range's content within another one.</p>\n\n<p>Any help is appreciated!</p>\n"},{"tags":["python","excel","add-in","win32com"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13164213,"title":"python win32com AddIn adding failure","body":"<p>My python script (see below) misteriously fails on the line \n    xlApp.AddIns.Add(\"C:\\Temp\\palXll_x32_mt.xll\")\nof the example below on one computer, but not on the other; paths are the same, xlls are the same, and are loadable manually.</p>\n\n<p>The only difference between two computers I am aware of is that the result of allAddInNames includes 'palXll_x32_mt' on the computer where my script works fine and it does not include 'palXll_x32_mt'on the coputer that works.</p>\n\n<pre><code>def allAddInNames(xlApp):\n    return [addIn.Name for addIn in xlApp.AddIns]\n\nif __name__ == '__main__':                \n    import win32com.client as win32\n    xlApp = win32.gencache.EnsureDispatch(\"Excel.Application\")\n    xlApp.Workbooks.Add() # make sure there is at least one book open\n    xlApp.Visible = True\n    print allAddInNames(xlApp)\n\n    xlApp.AddIns.Add(\"C:\\\\Temp\\\\palXll_x32_mt.xll\")\n    print allAddInNames(xlApp)\n</code></pre>\n\n<p>The error message is not particularly helpful:\n    pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'Microsoft Office Excel', u'Add method of AddIns class failed', u'C:\\Program Files\\Microsoft Office\\OFFICE11\\1033\\xlmain11.chm', 0, -2146827284), None)</p>\n\n<p>Any ideas? Thank you in advance!</p>\n"},{"tags":["excel","odbc","query"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":16480,"score":3,"question_id":1285686,"title":"Excel: Use a cell value as a parameter for a SQL query","body":"<p>I'm using MS Excel to get data from a MySQL database through ODBC.<br />\nI successfully get data using an SQL query. But now I want that query to be parameterized.<br />\nSo I wonder If it is possible to use a cell value (a spreadsheet cell) as a parameter for such a query.<br />\nFor example, for this query:</p>\n\n<pre><code>select name from user where id=1\n</code></pre>\n\n<p>I'd like to get the id value from, say, cell D4 in the spreadsheet.</p>\n\n<p>Is that the proper approach to parameterize a query? and how can I do it?</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","charts"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8098,"score":1,"question_id":854748,"title":"Excel Chart Several Y values against one X Value","body":"<p>I have a multiple columns representing Y values each against a specific x value. I am doing a scatter plot. When plotting each series, I can easily select the y values as they are present in columns but the x value is constant for each column and I cant seem to figure out how to repeat a constant x value against several y column values.\nDoes someone know how to provide a single repeatable value in the text box \"X-Values\"?</p>\n"},{"tags":["excel","conditional-formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2719,"score":0,"question_id":5247803,"title":"Excel: Hide cell contents if... in conditional formatting","body":"<p>I would like to set up a conditional formatting setting that would hide the contents (the cell should look blank) if the cell's contents is equal to another cell. Does anyone know of a function to do this? I tried just making the font the same color as the background (gray, in this case), but unfortunately when this is printed, there is some sort of residue shadow left over from the text.</p>\n\n<p>Here is what happens when I do gray on gray (they are supposedly the same color):</p>\n\n<p><img src=\"http://i.stack.imgur.com/xf7R0.jpg\" alt=\"Gray on gray still shows up\"></p>\n\n<p>I am using Excel 2008 on the Mac.</p>\n\n<p>Thank you for your help!</p>\n\n<p>JPE</p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13180429,"title":"Excel vba Change shape formula without selecting shape","body":"<p>I'm trying to change the formula within a shape without selecting it but keep getting a run-time error.</p>\n\n<p>Below are some of the code I've tried so far: </p>\n\n<pre><code>    Sheets(\"Quote\").Shapes.Range(Array(\"Rectangle 87\")).Formula = \" =CommAnnualOutput\"\n    Sheets(\"Quote\").Shapes(\"Rectangle 87\").Formula = \" =CommAnnualOutput\"\n    Sheets(\"Quote\").Shapes(\"Rectangle 87\").DrawingObjects.Formula = \" =CommAnnualOutput\"\n</code></pre>\n\n<p>None of these seem to work. Is there a way to change the formula without selecting the shape first?</p>\n"},{"tags":["javascript","excel","csv","xls","file-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12605920,"title":"Convert multiple .xls files to .csv files separated by semicolons","body":"<p>I have multiple .xls files that I want to convert to csv files and already found this JavaScript:</p>\n\n<pre><code>/*\n jPaq - A fully customizable JavaScript/JScript library\n http://jpaq.org/\n\n Copyright (c) 2011 Christopher West\n Licensed under the MIT license.\n http://jpaq.org/license/\n\n Version: 1.0.6.000001\n Revised: April 6, 2011\n*/\n(function(){jPaq={toString:function(){return\"jPaq - A fully customizable JavaScript/JScript library created by Christopher West.\"}};var e=new ActiveXObject(\"WScript.Shell\");alert=function(a,b,c,d){a==null&amp;&amp;(a=\"\");if(!b)b=WScript.ScriptName;c==null&amp;&amp;(c=alert.OKOnly+alert.Exclamation);d==null&amp;&amp;(d=0);return e.Popup(a,d,b,c)};alert.OKOnly=0;alert.OKCancel=1;alert.AbortRetryIgnore=2;alert.YesNoCancel=3;alert.YesNo=4;alert.RetryCancel=5;alert.Critical=16;alert.Question=32;alert.Exclamation=48;alert.Information=\n64;alert.Timeout=-1;alert.OK=1;alert.Cancel=2;alert.Abort=3;alert.Retry=4;alert.Ignore=5;alert.Yes=6;alert.No=7})();\n/***** END OF JPAQ *****/\n\ntry {\n  // Create an instance of Excel, but don't allow the content\n  // area to be repainted.\n  var xlCSV = 6;\n  var xlApp = new ActiveXObject(\"Excel.Application\");\n  xlApp.Visible = true;\n  xlApp.ScreenUpdating = false;\n  xlApp.DisplayAlerts = false;\n\n  // Initialize the counts.\n  var fileCount = 0, csvCount = 0;\n\n  // Regular expression for match Excel files to be converted.\n  var re = /([^\\\\\\/]+)\\.xlsx?$/i;\n\n  // Reference the containing folder.\n  var fso = new ActiveXObject(\"Scripting.FileSystemObject\");\n  var fldr = fso.GetFolder(WScript.ScriptFullName.replace(/[\\\\\\/][^\\\\\\/]+$/, \"\"));\n\n  // Determine whether or not linefeed characters should be removed.\n  var msg = \"Would you like to remove linefeed characters from all cells?\";\n  var title = \"Remove Linefeed Characters\";\n  var removeLf = alert.Yes == alert(msg, title, alert.YesNo + alert.Question);\n\n  // Loop through all of the xls and xlsx files in this folder.\n  for(var e = new Enumerator(fldr.Files); !e.atEnd(); e.moveNext()) {\n    var aFile = e.item();\n    if(re.test(aFile.Name)) {\n      xlApp.StatusBar = \"Processing \" + aFile.Path + \"...\";\n\n      // Open the workbook.\n      var wb = xlApp.Workbooks.Open(aFile.Path);\n\n      // Save each worksheet as a CSV file.\n      for(var e2 = new Enumerator(wb.Sheets); !e2.atEnd(); e2.moveNext()) {\n        var ws = e2.item();\n        if(removeLf) {\n          ws.UsedRange.Replace(\"\\n\", \"\");\n        }\n        var csvPath = aFile.Path.replace(re, function($0, $1) {\n          return $1 + \"-\" + ws.Name + \".csv\";\n        });\n        ws.SaveAs(csvPath, xlCSV);\n        csvCount++;  // Increment the number of CSV's.\n      }\n\n      // Close the workbook.\n      wb.Close();\n\n      // Increment the number of files.\n      fileCount++;\n    }\n  }\n\n  // Allow alerts to be displayed, and the screen to be updated again.\n  xlApp.DisplayAlerts = true;\n  xlApp.ScreenUpdating = true;\n\n  // Close Excel.\n  xlApp.Quit();\n\n  var msg = \"The results are as follows:\\nFiles converted:  \"\n    + fileCount + \"\\nCSV's created:  \" + csvCount;\n  var title = \"Conversion Process Complete\";\n  alert(msg, title, alert.Information);\n}\ncatch(e) {\n  // If the Excel workbook is open, close it.\n  try{ wb.Close(false); }catch(e2){}\n\n  // If Excel is open, change the settings back to normal and close it.\n  try{\n    xlApp.DisplayAlerts = true;\n    xlApp.ScreenUpdating = true;\n    xlApp.Quit();\n  } catch(e2){}\n\n  // Print the error message.\n  var msg = \"The following error caused this script to fail:\\n\"\n    + e.message;\n  var title = \"Critical Error Occurred\";\n  alert(msg, title, alert.Critical);\n}\n</code></pre>\n\n<p>However, this code saves the files with comma-separation, not with semicolons.\nAs it seems, I have to save the files with my local settings (They are saved with semicolons when I save them manually via Excel) and I have no idea how...</p>\n\n<p>Does anyone know a parameter for the</p>\n\n<pre><code>ws.SaveAs(csvPath, xlCSV);\n</code></pre>\n\n<p>method, so it will use my local settings?</p>\n\n<p>I'd be very grateful for your help!</p>\n"},{"tags":["excel","excel-vba","macros","copy","compare"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":22,"score":-1,"question_id":13179611,"title":"Excel VB script to compare values and copy data","body":"<p>My spreadsheet is setup as follows:  </p>\n\n<p>Sheet 1:<br>\nColumn A: Unique alpha numeric values starting from cell A2<br>\nColumn B - Alpha numeric values (non-unique)</p>\n\n<p>Sheet 2:<br>\nColumn A: Unique alpha numeric values starting from cell A2<br>\ncolumn B: Empty</p>\n\n<p>I want a function to compare between <code>Sheet1.ColumnA</code> and <code>Sheet2.ColumnA</code>, and when a match is found, copy the data from <code>Sheet1.ColumnB</code> to <code>Sheet2.ColumnB</code>.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13179332,"title":"capture the delete key in a protected excel 2003 worksheet","body":"<p>I have an Excel 2003 file with a protected worksheet. I created the editable cells, then protected the worksheet, which works fine. I can either use a cell password or not and the protection works correctly.</p>\n\n<p>The issue I'm having is when I set the focus on an editable cell (either a single cell or merged cells), I want to hit the delete key to clear the editable area. But when I do, I get the \"The cell or chart you are trying to change is protected and therefore read only\" message. When I double-click the editable cell, I can highlight and delete the contents.</p>\n\n<p>Here's the catch: the worksheet has many editable cells and the user gets very frustrated having to double-click each cell to delete the contents. If I can provide her the ability to clear the cell with the delete key she'll be very happy and I'll be able to put this project aside and move on to the next.</p>\n\n<p>The solutions that I've been finding online seem to be close to what I need but tend to divert to another sort of solution. Almost like someone teasing a dog with a doggy treat and never giving it to him.</p>\n"},{"tags":["excel","vba","excel-vba","worksheet"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13178817,"title":"Sql queries in VBA code - how to comment after Sql string","body":"<p>I have some Sql queries inside VBA code, this is an example of a line of code:</p>\n\n<pre><code>strQry = strQry &amp; Worksheets(\"Data\").Cells(9, 7) &amp; \"\"\", \" &amp; _ \n</code></pre>\n\n<p>I need to add a comment <strong>at the end of this line</strong>. Like this:</p>\n\n<pre><code>strQry = strQry &amp; Worksheets(\"Data\").Cells(9, 7) &amp; \"\"\", \" &amp; _ 'comment hjjkk\n</code></pre>\n\n<p>I usually comment using an apostrophe but the character is not accepted on that line. Please advise. Also, I need the comment on that exact line if possible, at the end of it.\nThank you!</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13175642,"title":"compare tables ,filter, sort","body":"<p>Sir, I am New to VBA, and need help for the following:</p>\n\n<ol>\n<li><p>I have a Employees worksheet which has three columns ID, Name and Status. Those employees whose status is \"Active\" should be filtered by code and should be made visible.</p></li>\n<li><p>There is Attendance worksheet which should update only visible rows(ID and Name) from employees worksheet. if a new name is added , it should create a new row or if any name is made non visible(by changing status) it should delete that entire row of that name based on ID because there are other columns associated with that name in Attendance Worksheet.</p></li>\n<li><p>There is another Section worksheet which should copy  few columns ((ID,name and Section) after custom sort from attendance worksheet. if a new name is added , it should create a new row. If a section is changed for some employees in the attendance worksheet, the corresponding changes should happen in section worksheet based on ID. If some names are removed from attendance worksheet, the entire row of that name should be removed from section worksheet based on ID because there are other columns associated with that name in Section Worksheet.</p></li>\n</ol>\n\n<p>I need help to write VBA code to perform  as above in all three worksheets </p>\n"},{"tags":["excel","vba","ms-access","excel-vba","ms-access-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13178595,"title":"Error 9 Out of range .Sheets(i)","body":"<p>Hey everyone i've been trying to find a solution to my error but i can't find a similar example on the net to resolve this. I have a variable (i) set to 3 when it enters the loop and then enters the first if statement it runs fine, the file is copied and inserted into sheet 3 however once its incremented to 4 and enters the second if statement i get an error 9 on </p>\n\n<pre><code>      Set wks4 = wkb.Sheets(i)\n</code></pre>\n\n<p>this is the somewhat of the complete code below, hope you guys can help me out .</p>\n\n<pre><code>Set Excel_App = New EXCEL.Application\nExcel_App.Visible = False\nSet wkb = EXCEL.Workbooks.Add\nSet wks = wkb.Sheets(1) 'want first sheet\n\nWith wks\n    ......\n    'extra code involing input to sheet 1 \nEnd With\n\n\n    Dim wkb2 As EXCEL.Workbook\n    Set wkb2 = EXCEL.Application.Workbooks.Open(strDir &amp; \"\\DETAILS.xlsx\")\n\n        wkb2.ActiveSheet.Cells.Select\n        Selection.Copy\n        Set wks2 = wkb.Sheets(2)\n        With wks2\n            .Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        End With\n        wkb2.Close\n\ni = 3\n      Do While Not rstTypes.EOF\n\n            If rstTypes![TYPE] Like \"GROUPED\" Then\n                    DoCmd.OutputTo acOutputReport, \"EXCEL_CBD_CAP_CR\", acFormatXLS, strDir &amp; \"\\SAMEDAY_NEXTDAY_FUTURE.xls\", 0\n                    Dim wkb3 As EXCEL.Workbook\n                    Set wkb3 = EXCEL.Application.Workbooks.Open(strDir &amp; \"\\SAMEDAY_NEXTDAY_FUTURE.xls\")\n\n                    wkb3.ActiveSheet.Cells.Select\n                    Selection.Copy\n                    Set wks3 = wkb.Sheets(i)\n                    With wks3\n                        .Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                                :=False, Transpose:=False\n                    End With\n                    wkb3.Close                   \n                    i = i + 1\n            End If\n\n            If rstTypes![TYPE] Like \"GROUPED2\" Then\n                DoCmd.OutputTo acOutputReport, \"EXCEL_ND/FUT_CAP_CR\", acFormatXLS, strDir &amp; \"\\NEXTDAY_FUTURE.xls\", 0\n                    Dim wkb4 As EXCEL.Workbook\n                    Set wkb4 = EXCEL.Application.Workbooks.Open(strDir &amp; \"\\NEXTDAY_FUTURE.xls\")\n\n\n                    wkb4.ActiveSheet.Cells.Select\n                    Selection.Copy\n                    Set wks4 = wkb.Sheets(i)\n                    With wks4\n                        .Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                                :=False, Transpose:=False\n                    End With\n                    wkb4.Close\n                    Kill (strDir &amp; \"\\NEXTDAY_FUTURE.xls\")\n\n                    i = i + 1\n            End If\n            rstTypes.MoveNext\n Loop\n</code></pre>\n"},{"tags":["vb.net","excel","excel-vba","macros","adodb"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12248223,"title":"Importing data to Excel from a share with ADO without opening file","body":"<p>I am trying to import data into a spreadsheet from a external share drive mapped to X: on my pc.</p>\n\n<p>ADODB should be able to do this without opening the file however it downloads and opens the file on the excel screen instead of just retrieving the data from the range.</p>\n\n<p>My code is below, any advice would be most helpful.</p>\n"},{"tags":["excel","import","macros","word"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13178249,"title":"macro for word data import","body":"<p>Im currently working a bit with word and macro.</p>\n\n<p>I have two drop down lists.</p>\n\n<p>One with the choise of animal, car, buielding ect.</p>\n\n<p>The other then, by the effect of macro allows for selections of bird, fish or bus, truck or house, bunker.</p>\n\n<p>Now the question is.\nCan i make it so that by selecting animals, it imports the list from lets say a excel doc from row \"animal\" and such?</p>\n"},{"tags":["excel","script","ms-word"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":31,"score":-5,"question_id":13178006,"title":"How to put desired data & snaps in word .doc defined format from xls & snaps folder?","body":"<p>I have an Excel containing (Sr. Shop Name, Location, Year etc) &amp; a folder containing pictures with the same Name as in Excel.</p>\n\n<p>Now I want to put desired data from excel &amp; snaps/images (folder) to a Word .doc file which has a format (Sr. Name Address Remarks etc &amp; a portion for placing snaps/images. All the word <code>.doc</code> files will create separately like <code>1- Tulip</code> has its own single word <code>.doc</code> file &amp; <code>2- Red Rose</code> has its own separate file.</p>\n\n<p>Are there any scripts or applications which run and create <code>.Doc</code> file?</p>\n"},{"tags":["c#","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13176716,"title":"Read first line of XLS without specific sheet name","body":"<p>I've found how to read first line from Excel file with specific sheet name, but in my case I have to read first line of the first sheet.</p>\n\n<p>How can I realize that or I have to use CSV instead of XLS?</p>\n"},{"tags":["excel","microsoft"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13175801,"title":"Find and sort same months name as single in Microsoft Excel 2007","body":"<p><img src=\"http://i.stack.imgur.com/2wZRv.png\" alt=\"enter image description here\"></p>\n\n<p>I am working with Microsoft excel 2010. I have different dates like column E1:E19 that are not in specific interval. I want help to find only starts month date and paste them into G column like shown into the figure.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13171714,"title":"Watching an un-modified Cell","body":"<p>I want to be able to set a watch on a particular cell to see if it is being used in output calculations elsewhere.</p>\n\n<p>Any ideas? Much appreciated.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":8399500,"title":"Check whether a given date is present in a range of dates in MS excel","body":"<p>I have recorded the date and time of an event happening around. I would like to check if the recorded date and time is present in between some date/time ranges. Please follow the example</p>\n\n<p>given data:<br>\n<code>26/03/2011 16:33</code></p>\n\n<p>range:<br>\n<code>20/02/2011 16:00</code>  (say some cell)<br>\n<code>28/04/2011 3:00</code>  (another cell)</p>\n\n<p>The condition should check whether the given data is present in the range. I want an <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> function.not <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a>.</p>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":1179,"score":1,"question_id":7741892,"title":"Copy Row If Cell Range Are Not Blank","body":"<p>I wonder whether someone may be able to help me please.</p>\n\n<p>I have an Excel (2003) spreadsheet called 'Input' with data in columns B to N. What I would like to be able to do is if there is text in any of the cells in column B, I would like to copy the row but only columns 'B' 'I' and 'N' and paste them into my second spreadsheet called 'Output' at cell ref B2.</p>\n\n<p>If at all possible, once the information has been pasted, I'd like to add the word 'Scheduled site' in column 'E' on the 'Output' sheet if the cells in column 'B' have text in them. </p>\n\n<p>I've been doing this manually, and it takes quite some time to do.</p>\n\n<p>I just wondered whether someone may be able to show me please how I can automate this.</p>\n\n<p>Many thanks</p>\n"},{"tags":["excel","vba","cell","variable-assignment","spreadsheet"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":2822,"score":1,"question_id":9476282,"title":"Cannot VBA write data to cells in Excel 2007/2010 within a funtion","body":"<p>I want to set value for cells by VBA. I have googled, and see some resolution:</p>\n\n<pre><code>Sheets(\"SheetName\").Range(\"A1\").value = someValue\nSheets(\"SheetName\").Cells(1,1).value = someValue\n</code></pre>\n\n<p>With this kind of code, I can just read data from cell A1 but I cannot set a new value to it. </p>\n\n<p><em>Update</em></p>\n\n<p>The code to set cell A1 value is put within a <code>Function</code> as below.</p>\n\n<pre><code>Function abb()\n    Sheets(\"SheetName\").Range(\"A1\").value = 122333\n    abb = 'any thing'\nEnd Function\n</code></pre>\n\n<p>In cell B2, I set <code>=abb()</code> and hit enter. I get #VALUE but nothing happen at A1.</p>\n\n<p>Putting this code in a macro, it works.</p>\n\n<p>My question is, how to make A1 have values within a funtion?</p>\n"},{"tags":["excel","birt"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12531001,"title":"Getting multiple sheets in same excel output using BIRT reporting tool(opensource version)","body":"<p>I need to get multi tabbed output in the final report output in excel fromat. I'm using birt 4.2.0. Any help????</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":104,"score":4,"question_id":11114192,"title":"Writing Subscript Values In VBA","body":"<p>I have a string:<br>\n<code>Range(\"T4\").Value = \"Rule 13s voilation\"</code> </p>\n\n<p>I want to write <code>13s</code> like 1<sub>3</sub><sub>s</sub><br>\ni.e <code>3</code> and <code>s</code> are a subscript of <code>1</code>. </p>\n\n<p>Please suggest on how should I go about it in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a></p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13171870,"title":"handling empty columns in apache poi","body":"<p>I have a program reading excel sheet from a java program. </p>\n\n<p>I am iterating over cells as below:</p>\n\n<pre><code>Iterator cells = row.cellIterator();\nString temp;\nStringBuilder sb;\nSimpleDateFormat sdf = new SimpleDateFormat(\"yyyyMMdd\");\n\nwhile (cells.hasNext()) {\nCell cell = (Cell) cells.next();\ntemp = null;\n\n    switch (cell.getCellType()) {\n         case Cell.CELL_TYPE_STRING:\n         temp = cell.getRichStringCellValue().getString();\n         break;\n\n    case Cell.CELL_TYPE_NUMERIC:\n\n    if (DateUtil.isCellDateFormatted(cell)) {\n        temp = sdf.format(cell.getDateCellValue());\n       } else {\n             temp = df.format(new BigDecimal(cell.getNumericCellValue()));\n       }\n          break;\n          default:\n     }\n    if (temp == null || temp.equalsIgnoreCase(\"null\")) {\n        sb.append(\"\").append(\";\");\n    } else {\n        sb.append(temp).append(\";\");\n    }\n }\n</code></pre>\n\n<p>As seen, I am trying to create a string builder containing values from excel row in semicolon separated way. </p>\n\n<p>Issue is, if a column value is empty, I want it as an empty value in the string builder with two consecutive semicolons. </p>\n\n<p>However, the call </p>\n\n<blockquote>\n  <p>Cell cell = (Cell) cells.next();</p>\n</blockquote>\n\n<p>simply ignores the empty cells and jumps over to next non empty cell. </p>\n\n<p>So the line </p>\n\n<blockquote>\n  <p>if (temp == null || temp.equalsIgnoreCase(\"null\"))</p>\n</blockquote>\n\n<p>is never met. </p>\n\n<p>How to get a handle on empty column values as well in the iterator ?</p>\n"},{"tags":["java","excel","tomcat"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13175121,"title":"Tomcat 7 crashes on startup when using JExcel Api in webapp","body":"<p>I'm trying to export data from a database into an Excelsheet using the <a href=\"http://jexcelapi.sourceforge.net/\" rel=\"nofollow\">JExcel Api</a> when a specific servlet is called, but when starting Tomcat I get multiple exceptions. Here's the error message as given by eclipse:</p>\n\n<pre><code>Nov 01, 2012 10:57:14 AM org.apache.catalina.core.ContainerBase startInternal\nSEVERE: A child container failed during start\njava.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/web]]\n    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)\n    at java.util.concurrent.FutureTask.get(Unknown Source)\n    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)\n    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)\n    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)\n    at java.util.concurrent.FutureTask.run(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/web]]\nat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\n... 7 more\nCaused by: java.lang.NoClassDefFoundError: jxl/write/WriteException\n    at java.lang.Class.getDeclaredFields0(Native Method)\n    at java.lang.Class.privateGetDeclaredFields(Unknown Source)\n    at java.lang.Class.getDeclaredFields(Unknown Source)\n    at org.apache.catalina.util.Introspection.getDeclaredFields(Introspection.java:87)\n    at org.apache.catalina.startup.WebAnnotationSet.loadFieldsAnnotation(WebAnnotationSet.java:261)\n    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationServletAnnotations(WebAnnotationSet.java:140)\n    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationAnnotations(WebAnnotationSet.java:67)\n    at org.apache.catalina.startup.ContextConfig.applicationAnnotationsConfig(ContextConfig.java:405)\n    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)\n    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n... 7 more\nCaused by: java.lang.ClassNotFoundException: jxl.write.WriteException\n    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)\n    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)\n... 21 more\n\nNov 01, 2012 10:57:14 AM org.apache.catalina.core.ContainerBase startInternal\nSEVERE: A child container failed during start\njava.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]\n    at java.util.concurrent.FutureTask$Sync.innerGet(Unknown Source)\n    at java.util.concurrent.FutureTask.get(Unknown Source)\n    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)\n    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)\n    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)\n Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)\n    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)\n    at java.util.concurrent.FutureTask.run(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.catalina.LifecycleException: A child container failed during start\n    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)\n    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n... 7 more\n\nNov 01, 2012 10:57:14 AM org.apache.catalina.startup.Catalina start\nSEVERE: Catalina.start: \norg.apache.catalina.LifecycleException: Failed to start component [StandardServer[8005]]\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\n    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)\n    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)\nCaused by: org.apache.catalina.LifecycleException: Failed to start component [StandardService[Catalina]]\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\n    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n... 7 more\nCaused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina]]\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)\n    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n... 9 more\nCaused by: org.apache.catalina.LifecycleException: A child container failed during start\n    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)\n    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n... 11 more\n</code></pre>\n\n<p>Here is the servlet code:</p>\n\n<pre><code>import java.io.IOException;\nimport java.io.PrintWriter;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport jxl.write.WriteException;\n\n\n/**\n * Servlet implementation class Test\n */\n@WebServlet(description = \"A simple test.\", urlPatterns = { \"/test\" })\n\npublic class Test extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * @see HttpServlet#HttpServlet()\n     */\n    public Test() {\n        super();\n    }\n\n    /**\n     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n        try {\n            WriteExcel.writeTestFile();\n        } catch (WriteException e) {\n            e.printStackTrace();\n        }\n\n        response.setContentType(\"text/html\");\n        PrintWriter out = response.getWriter();\n        out.println(\"&lt;html&gt;\");\n        out.println(\"&lt;head&gt;\");\n        out.println(\"&lt;title&gt;Test!&lt;/title&gt;\");\n        out.println(\"&lt;/head&gt;\");\n        out.println(\"&lt;body&gt;\");\n        out.println(\"I've written an Excel file!\");\n        out.println(\"&lt;/body&gt;\");\n        out.println(\"&lt;/html&gt;\");\n\n    }\n\n    /**\n     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)\n     */\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        doGet(request, response);\n    }\n\n}\n</code></pre>\n\n<p>And here is the code of the WriteExcel class:</p>\n\n<pre><code>import java.io.File;\nimport java.io.IOException;\nimport java.util.Locale;\n\nimport jxl.CellView;\nimport jxl.Workbook;\nimport jxl.WorkbookSettings;\nimport jxl.format.UnderlineStyle;\nimport jxl.write.Formula;\nimport jxl.write.Label;\nimport jxl.write.Number;\nimport jxl.write.WritableCellFormat;\nimport jxl.write.WritableFont;\nimport jxl.write.WritableSheet;\nimport jxl.write.WritableWorkbook;\nimport jxl.write.WriteException;\nimport jxl.write.biff.RowsExceededException;\n\n//tomcat hat probleme mit der jxl library\npublic class WriteExcel {\n\n  private WritableCellFormat timesBoldUnderline;\n  private WritableCellFormat times;\n  private String inputFile;\n\npublic void setOutputFile(String inputFile) {\n  this.inputFile = inputFile;\n  }\n\n  public void write() throws IOException, WriteException {\n    File file = new File(inputFile);\n    WorkbookSettings wbSettings = new WorkbookSettings();\n\n    wbSettings.setLocale(new Locale(\"en\", \"EN\"));\n\n    WritableWorkbook workbook = Workbook.createWorkbook(file, wbSettings);\n    workbook.createSheet(\"Report\", 0);\n    WritableSheet excelSheet = workbook.getSheet(0);\n    createLabel(excelSheet);\n    createContent(excelSheet);\n\n    workbook.write();\n    workbook.close();\n  }\n\n  private void createLabel(WritableSheet sheet)\n      throws WriteException {\n    // Lets create a times font\n    WritableFont times10pt = new WritableFont(WritableFont.TIMES, 10);\n    // Define the cell format\n    times = new WritableCellFormat(times10pt);\n    // Lets automatically wrap the cells\n    times.setWrap(true);\n\n    // Create create a bold font with unterlines\n    WritableFont times10ptBoldUnderline = new WritableFont(WritableFont.TIMES, 10, WritableFont.BOLD, false,\n        UnderlineStyle.SINGLE);\n    timesBoldUnderline = new WritableCellFormat(times10ptBoldUnderline);\n    // Lets automatically wrap the cells\n    timesBoldUnderline.setWrap(true);\n\n    CellView cv = new CellView();\n    cv.setFormat(times);\n    cv.setFormat(timesBoldUnderline);\n    cv.setAutosize(true);\n\n    // Write a few headers\n    addCaption(sheet, 0, 0, \"Header 1\");\n    addCaption(sheet, 1, 0, \"This is another header\");\n\n\n  }\n\n  private void createContent(WritableSheet sheet) throws WriteException,\n      RowsExceededException {\n    // Write a few number\n    for (int i = 1; i &lt; 10; i++) {\n      // First column\n      addNumber(sheet, 0, i, i + 10);\n      // Second column\n      addNumber(sheet, 1, i, i * i);\n    }\n    // Lets calculate the sum of it\n    StringBuffer buf = new StringBuffer();\n    buf.append(\"SUM(A2:A10)\");\n    Formula f = new Formula(0, 10, buf.toString());\n    sheet.addCell(f);\n    buf = new StringBuffer();\n    buf.append(\"SUM(B2:B10)\");\n    f = new Formula(1, 10, buf.toString());\n    sheet.addCell(f);\n\n    // Now a bit of text\n    for (int i = 12; i &lt; 20; i++) {\n      // First column\n      addLabel(sheet, 0, i, \"Boring text \" + i);\n      // Second column\n      addLabel(sheet, 1, i, \"Another text\");\n    }\n  }\n\n  private void addCaption(WritableSheet sheet, int column, int row, String s)\n      throws RowsExceededException, WriteException {\n    Label label;\n    label = new Label(column, row, s, timesBoldUnderline);\n    sheet.addCell(label);\n  }\n\n  private void addNumber(WritableSheet sheet, int column, int row,\n      Integer integer) throws WriteException, RowsExceededException {\n    Number number;\n    number = new Number(column, row, integer, times);\n    sheet.addCell(number);\n  }\n\n  private void addLabel(WritableSheet sheet, int column, int row, String s)\n      throws WriteException, RowsExceededException {\n    Label label;\n    label = new Label(column, row, s, times);\n    sheet.addCell(label);\n  }\n\n\n  public static void writeTestFile() throws WriteException, IOException {\n    WriteExcel test = new WriteExcel();\n    test.setOutputFile(\"d:/test.xls\");\n    test.write();\n    System.out.println(\"Please check the result file under d:/test.xls\");\n  }\n\n} \n</code></pre>\n\n<p>The method writeTestFile() from the WriteExcel class works fine when tested in a local standalone project.<br>\nThe servlet itself also works when the method writeTestFile() is not called.<br><br>\nCould someone clarify why I'm getting the exceptions?<br>\nAlso is there a fix or workaround?</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12455460,"title":"Multiple function in one cell, Microsoft Excel 2003","body":"<p>I would like to add multiple functions in once cell showing separate answers like e.g.     |</p>\n\n<p><code>=\"Total 1 =&gt;\" &amp;SUM(A3:A44)</code><br>\n<code>=\"Count 1 =&gt;\" &amp;COUNT(B5:B88)</code></p>\n\n<p>All these functions go into one cell e.g. here in cell <code>A1</code>.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":805,"score":4,"question_id":10203349,"title":"Use VBA to Clear Immediate Window?","body":"<p>Anyone knows how to clear the immediate window using VBA please?</p>\n\n<p>Although I can always clear myself manually, just ask by curious. Thanks</p>\n"},{"tags":["excel","excel-vba","excel-2007","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":85,"score":0,"question_id":13162712,"title":"Excel - copy certain rows from worksheet in another worksheet","body":"<p>I have found ways to solve this issue but I don't know how to tailor them to my specific problem. I've never written a marco or any VBA script before, so please be specific with your answers. </p>\n\n<p>I have an Excel workbook with one worksheet named \"foods\", and four other worksheets named \"snack choices\", \"breakfast choices\", \"lunch choices\", and \"dinner choices\"</p>\n\n<p>The heading in the \"foods\" worksheet looks like this:</p>\n\n<p><strong>Food Amount Calories ... ETC ... Type</strong></p>\n\n<p>Where \"Type\" contains \"breakfast\" \"snack\" \"lunch\" \"dinner\" or a combination of 2+ choices. </p>\n\n<p>I'd like the entire row to copy to the corresponding \"snack choices\", \"breakfast choices\", \"lunch choices\", and \"dinner choices\" worksheet according to the value of the \"Type\" field in the \"foods\" worksheet. </p>\n\n<p>For example, if I enter a new row into the \"foods\" worksheet with the \"Type\" field as \"snack / breakfast\" I'd like for the row to automatically appear in the \"breakfast choices\" and \"snack choices\" worksheets. (I could remove the slash or replace it with another character if that makes it easier)</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":11472031,"title":"Delete ALL text to the left of a particular character in MS excel","body":"<p>This is an excel related question. I want to delete all text (all characters) to the left of a particular character or characters in the string.</p>\n\n<p><strong>For instance:</strong></p>\n\n<p>suppose I have an string in a cell\n<strong>helloall welco metostackoverflow</strong></p>\n\n<p>now I want delete all the characters which are at the left side of \"stack\".\nmeans result should be <strong>stackoverflow</strong> (only stackoverflow)</p>\n\n<p>Thanks in advance for your support.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":214,"score":0,"question_id":7729006,"title":"How to prepare Collection object in VBA","body":"<p>Below code is in VB.net, how can i do the same thing with <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a></p>\n\n<pre><code>Option Strict On\nImports System.Collections\nPublic Class Collect\n   Public Shared Sub Main()\n      Dim sta As New Collection\n         sta.Add(\"New York\", \"NY\")\n         sta.Add(\"Michigan\", \"MI\")\n         sta.Add(\"New Jersey\", \"NJ\")\n         sta.Add(\"Massachusetts\", \"MA\")\n\n   End Sub\nEnd Class\n</code></pre>\n\n<p>After preparing the <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> collection object, i want to retrieve it by key,Suppose take I want value for the Key \"New York\". It should return NY.</p>\n"},{"tags":["wordpress","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13176386,"title":"Export Wordpress custom post images to excel","body":"<p>Is it possible to export all images of a custom post type into an excel spreadsheet that is saved on our hosting? Could this be done on a daily basis? Each post can be one Excel spreadsheet row.</p>\n\n<p>So if there's 5 images relating to a post then it would put all 5 in the 1 excel row. </p>\n\n<p>We host a judging website where people submit entries, the judges want to be able to view an offline version (the file can be saved to a Dropbox folder) in an Excel spreadsheet.</p>\n"},{"tags":["excel","sorting","ip-address","spreadsheet","google-spreadsheet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":769,"score":0,"question_id":7813128,"title":"Sort spreadsheet by column containing IP addresses (one IP address per cell)","body":"<p>Using the default sorting engine, the following list is considered sorted:</p>\n\n<pre><code>10.0.0.219\n10.0.0.22\n10.0.0.223\n</code></pre>\n\n<p>This is incorrect.  The sorting should be:</p>\n\n<pre><code>10.0.0.22\n10.0.0.219\n10.0.0.223\n</code></pre>\n\n<p>It is not safe to assume the first three octets will be static.  For instance, other IP addresses include:</p>\n\n<pre><code>10.35.10.11\n10.28.66.30\n</code></pre>\n"},{"tags":["php","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":36,"score":-4,"question_id":13175838,"title":"Cannot open .xls file genereated with PHP","body":"<p>I have a MYSQL database filled with entries and want those entries exported into an .xls file. The script works with all tables, but one. I guess entries contains weird characters and messes up the script. When I try to open the file with excel I get an error:</p>\n\n<blockquote>\n  <p>Cannot open file</p>\n</blockquote>\n\n<p>I've tried changing the headers and decoding from/to utf-8.<br>\nIs there anything else I should consider changing? The table data looks normal in <strong>phpMyAdmin</strong>.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13175179,"title":"How to find minimum value in a cell whose value is always changing in Excel?","body":"<p>In cell a1 value is always changing. I want to keep track of minimum value of a1 in a2. How is it possible?</p>\n"},{"tags":["c#","excel","openxml-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13161056,"title":"Reading data from Excel cells using OpenXML SDK 2.0","body":"<p>I'm trying to get value from Excel cells in this way:</p>\n\n<pre><code>    SpreadsheetDocument spreadSheetDocument = SpreadsheetDocument.Open(filePath, true);\n\n    WorksheetPart worksheetPart = getWorksheetByName(spreadSheetDocument, DEFAULT_SHEET_NAME);\n\n    SheetData sheetData = worksheetPart.Worksheet.GetFirstChild&lt;SheetData&gt;();\n\n    Cell theCell1 = worksheetPart.Worksheet.Descendants&lt;Cell&gt;().FirstOrDefault(c =&gt; c.CellReference == \"A5\");\n    Cell theCell2 = worksheetPart.Worksheet.Descendants&lt;Cell&gt;().FirstOrDefault(c =&gt; c.CellReference == \"A6\");\n    Cell theCell3 = worksheetPart.Worksheet.Descendants&lt;Cell&gt;().FirstOrDefault(c =&gt; c.CellReference == \"B5\");\n    Cell theCell4 = worksheetPart.Worksheet.Descendants&lt;Cell&gt;().FirstOrDefault(c =&gt; c.CellReference == \"B6\");\n</code></pre>\n\n<p>Then I'm checking theCell1.CellValue.Text propetry and I'm getting some strange data like 4,5,248 etc, which is actually far from real data. Real values I can view and edit using Excel.</p>\n\n<p>Does anybody have any guess why it so?</p>\n"},{"tags":["excel","windows-xp",".net-1.1"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":14900,"score":3,"question_id":493178,"title":"Excel Programming: Exception from HRESULT: 0x800A03EC. at Microsoft.office.Interop","body":"<p>I have created a small application which opens,reads and creates Excel files.\nThe app has been written in C# and I don't know why I get this error message when the application is running in one computer.\nI have run the same applicaiton on my computer and I don't have any problem.</p>\n\n<p>Can somebody help me and let me know why happen this error?</p>\n\n<p>thanks</p>\n"},{"tags":["excel","merge","column"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13171382,"title":"Excel search value from whatever row and if found on another row replace that row with the value in the first row","body":"<p>What I am Trying to do is \nlets say I have a excel sheet with</p>\n\n<p>rows</p>\n\n<h1>ProductNo |  Product    |   Sku    |  Price |    Image   |  Thumb</h1>\n\n<p>25         | Shirt Blue  |   4251   |   $10  |  shirt.jpg |  shirtthumb.jpg</p>\n\n<p>2          | Shirt Green |   4581   |   $17  |  green.jpg |  greenthumb.jpg</p>\n\n<p>8          | Shirt Black |   4561   |   $15  |  black.jpg |  blackthumb.jpg</p>\n\n<p><br />\nand just in different rows or on another excel sheet \n<br /><br /></p>\n\n<h1>ProductNo   |    Product     |     Sku    |  Price  |    Image   |  Thumb</h1>\n\n<p>25           |    Shirt Blue  |    4251    |   $52   |            |<br>\n2            |    Shirt Green |    4581    |   $42   |            |<br>\n8            |    Shirt Black |    4561    |   $65   |            |  </p>\n\n<p><br />\nHow can i change the first table to update if the the second table or sheet columns data is different on specified columns and if the cells are empty forget about them ignore them and just replace the values from the second table onto the first\n<br /><br /></p>\n\n<p>Final would be</p>\n\n<h1>ProductNo   |    Product     |     Sku    |  Price  |    Image   |  Thumb</h1>\n\n<p>25           |    Shirt Blue  |    4251    |   $52   |  shirt.jpg |  shirtthumb.jpg</p>\n\n<p>2            |    Shirt Green |    4581    |   $42   |  green.jpg |  greenthumb.jpg</p>\n\n<p>8            |    Shirt Black |    4561    |   $65   |  black.jpg |  blackthumb.jpg</p>\n\n<p>I have tried a couple of excel functions but they do not work since i have so many products to be doing cell additions</p>\n\n<p>I tried doing in Vl but got confused and macro i dont even know what it is</p>\n\n<p>Im open to whatever visual, functions just as long as i can perform the task</p>\n\n<p>if anybody know hos let me know</p>\n\n<p>Thank You</p>\n"},{"tags":["python","excel","xlrd","xlwt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13156730,"title":"Copying value of cell (X,Y) to cell (A,B) in same sheet of an Excel file using Python","body":"<p>I am using the modules <code>xlwd</code>, <code>xlwt</code> and <code>xlutil</code> to do some Excel manipulations in Python. I am not able to figure out how to copy the value of cell <code>(X,Y)</code> to cell <code>(A,B)</code> in the same sheet of an Excel file in Python. Could someone let me know how to do that?</p>\n"},{"tags":["php","excel","phpexcel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13171841,"title":"phpexcel - using it with excel template (chart goes missing) php","body":"<p>I have tried to use <strong>phpexcel</strong> with my own template file. phpexcel loads the file and writes data to some cells A2, A3, A4 for example.. and opens an output file with the new data.</p>\n\n<p>my template file has chart built-in.. all i want to phpexcel to do is to populate values in cells and don't touch the chart. And, open the new file. <strong>(Please note that I don't want to make the chart in code.. I want the chart to pre-exist with in my template in same format as I created originally). Only the data should update.</strong></p>\n\n<p>But, when i try to do this.. the chart itself goes missing from the resulting file. After trying various ways.. still failed.</p>\n\n<p>And, i found the following code from <a href=\"http://phpexcel.codeplex.com/discussions/397263\" rel=\"nofollow\">http://phpexcel.codeplex.com/discussions/397263</a></p>\n\n<pre><code>require_once 'Classes/PHPExcel.php'; \n/** PHPExcel_IOFactory */\ninclude 'Classes/PHPExcel/IOFactory.php';\n\n\n\n\n$target ='Results/';\n$fileType = 'Excel2007';   \n$InputFileName = $target.'Result.xlsx';   \n$OutputFileName =  $target . '_Result.xlsx';\n\n //Read the file (including chart template) \n$objReader = PHPExcel_IOFactory::createReader($fileType); \n$objReader-&gt;setIncludeCharts(TRUE);\n$objPHPExcel = $objReader-&gt;load($InputFileName); \n\n //Change the file \n\n\n$objPHPExcel-&gt;setActiveSheetIndex(0)\n// Add data\n            -&gt;setCellValue('C3','10' )\n            -&gt;setCellValue('C4','20' )\n            -&gt;setCellValue('C5','30')\n            -&gt;setCellValue('C5','40' );\n\n //Write the file (including chart)\n\nPHPExcel_Settings::setZipClass(PHPExcel_Settings::PCLZIP);\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, $fileType); \n$objWriter-&gt;setIncludeCharts(TRUE);\n$objWriter-&gt;save($OutputFileName);\n</code></pre>\n\n<p>The above code works in excel 2010 and now keeps my chart in tact... but still when I try to use filetype \"Excel5\" it doesn't work.</p>\n\n<p>It throws the following error:</p>\n\n<pre><code>    Fatal error: Call to undefined method PHPExcel_Reader_Excel5::setIncludeCharts()\n in D:\\IT\\bfstools\\PHPExcel\\MyExamples\\test1.php on line 16\n</code></pre>\n\n<p><strong>Please provide a simple solution where I want my template file to work with .xls and .xlsx and all my original chart in the template file should stay intact</strong>. I do not want the chart removed it from the resulting file. Neither do I plan to create the chart using phpexcel code. (why write unnecessary code when excel can do all the work for you).</p>\n\n<p>I want the easiest way out which is just to use everything with in my template and just populate cells with new data. And, my existing chart in the template comes live automatically. I don't want to write unnecessary code while I can safely rely on excel template and charting functions.</p>\n\n<p>Please help.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13154063,"title":"Excel VBA. Need a macro to randomize permutations (3p3) 3 times without repeating any permutation","body":"<p>I have 9 cells (which I consider in 3 groups), each group contains the letters A, B and C. Orders are balanced between the 3 groups such that no letter is in the same position twice, e.g.:</p>\n\n<p>A B C   C A B   B A C</p>\n\n<p>I have 3 other cells containing the letters d, e and f. I want to assign d, e and f to A, B and C with the following rules: </p>\n\n<ol>\n<li>d, e and f are each reprented once within in each group.</li>\n<li>d, e and f each combine once with A, B &amp; C</li>\n</ol>\n\n<p>For example : </p>\n\n<p>Ad Be Cf     Ce Af Bd   Bf Ae Cd</p>\n\n<p>Basically I want to write a VBA macro which gives me random assignments of d e f to A B C which follows these rules. I'd like the macro to show me this by putting the cells containing d e f under the cells containing A B C.</p>\n\n<p>Sorry I haven't even tried to write code to do this yet and also sorry if this is a bit of a confusing/poorly formatted question. I'm new to VBA and stackexchange and had a bit of trouble explaining this problem.</p>\n\n<p>Cheers</p>\n"},{"tags":[".net","vb.net","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13173187,"title":"Excel Add-In not working in French Excel","body":"<p>I have developed an Add-in for excel using VB .NET and ExcelDNA.\nThe Add-In works on my computer and all computers which has an english version of excel.\nHowever, it does not work on my clients computer(is in English) which has a French version of Excel.</p>\n\n<p>I get the following error:</p>\n\n<p><strong>Old Format or invalid type library</strong> HResult 0x80028018</p>\n\n<p>I have spent hours on the internet and the solution I found was that you need to change the\nCulture Info.\n I added this to my code does not seem to work,</p>\n\n<pre><code>        Dim oldCI As System.Globalization.CultureInfo = _\n        System.Threading.Thread.CurrentThread.CurrentCulture\n        System.Threading.Thread.CurrentThread.CurrentCulture = _\n         New System.Globalization.CultureInfo(\"fr-FR\")\n        System.Threading.Thread.CurrentThread.CurrentCulture = oldCI\n</code></pre>\n"},{"tags":["wpf","excel","styles","vsto","windows-installer"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13159722,"title":"VSTO Office (Excel) Add-In - WPF XAML Style, ResourceDictionary","body":"<p>I want to deploy my VSTO Office Excel-Add-In with the Windows Installer.\nI created the Installer and installed the Add-In on a Virtual PC, to test it.\nNow i have the Problem, that the Styles not working, but if i debug or run it in Visual Studio it does work.</p>\n\n<p>For example, i created a Style like this:</p>\n\n<pre><code>&lt;Style TargetType=\"{x:Type Button}\"&gt;\n     &lt;Style.Setters&gt;\n        &lt;Setter Property=\"Background\" Value=\"Snow\" /&gt;\n        &lt;Setter Property=\"Width\" Value=\"50\" /&gt;\n        &lt;Setter Property=\"Height\" Value=\"25\" /&gt;\n        &lt;Setter Property=\"Margin\" Value=\"5\" /&gt;\n     &lt;/Style.Setters&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Now i merge the ResourceDictionary (with the style in it) with the ResourceDictionary of the Window:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n      &lt;ResourceDictionary&gt;\n         &lt;ResourceDictionary.MergedDictionaries&gt;\n            &lt;ResourceDictionary Source=\"/assembly;component/UI/Resources/Style.xaml\" /&gt;\n         &lt;/ResourceDictionary.MergedDictionaries&gt;\n      &lt;/ResourceDictionary&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>It does only works after the Setup, when i use Keys for the Styles and set the Style directly to the Control.</p>\n"},{"tags":["c#",".net","excel","openxml","closedxml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13101693,"title":"How can I enable the \"Sharing\" options on Excel workbooks?","body":"<p>Is it possible to enable \"Sharing\" on excel documents through <a href=\"http://msdn.microsoft.com/en-us/library/office/bb448854.aspx\" rel=\"nofollow\">OpenXML</a> or <a href=\"http://closedxml.codeplex.com/\" rel=\"nofollow\">ClosedXML</a>? Or any other library if it can help... I believe this is usually performed when you save the document (at least that's how it works in VBA), but I can't find how to specify saving arguments in C#.</p>\n\n<p>I'd like to avoid using InterOp since I might batch this process on multiple files through a network.</p>\n\n<p>EDIT: According to <a href=\"http://blogs.msdn.com/b/openspecification/archive/2009/07/17/overview-of-protected-office-open-xml-documents.aspx\" rel=\"nofollow\">some old pages from 2009</a>, there are limitations where OpenXML cannot operate protected files. However, would that apply to sharing too?</p>\n"},{"tags":["c#","sql","excel","import"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1872,"score":4,"question_id":3664067,"title":"Import data from excel into multiple tables","body":"<p>I'm building an offline C# application that will import data off spread sheets and store them in a SQL Database that I have created (Inside the Project). Through some research I have been able to use some code that can import a static table, into a Database that is exactly the same layout as the columns in the worksheet</p>\n\n<p>What I\"m looking to do is have specific columns go to their correct tables based on name. This way I have the database designed correctly and not just have one giant table to store everything.</p>\n\n<p>Below is the code I'm using to import a few static fields into one table, I want to be able to split the imported data into more than one.</p>\n\n<p>What is the best way to do this?</p>\n\n<pre><code>public partial class Form1 : Form\n    {\n        string strConnection = ConfigurationManager.ConnectionStrings\n        [\"Test3.Properties.Settings.Test3ConnectionString\"].ConnectionString;\n\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n\n\n            //Create connection string to Excel work book\n            string excelConnectionString =\n            @\"Provider=Microsoft.Jet.OLEDB.4.0;\n            Data Source=C:\\Test.xls;\n            Extended Properties=\"\"Excel 8.0;HDR=YES;\"\"\";\n\n            //Create Connection to Excel work book\n            OleDbConnection excelConnection = new OleDbConnection(excelConnectionString);\n\n            //Create OleDbCommand to fetch data from Excel\n            OleDbCommand cmd = new OleDbCommand\n            (\"Select [Failure_ID], [Failure_Name], [Failure_Date], [File_Name], [Report_Name], [Report_Description], [Error] from [Failures$]\", excelConnection);\n\n            excelConnection.Open();\n            OleDbDataReader dReader;\n            dReader = cmd.ExecuteReader();\n\n            SqlBulkCopy sqlBulk = new SqlBulkCopy(strConnection);\n            sqlBulk.DestinationTableName = \"Failures\";\n            sqlBulk.WriteToServer(dReader);\n\n        }\n</code></pre>\n"},{"tags":["excel","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13159522,"title":"Date and Time Change 24 hours with VBA Excel","body":"<p>How do I add time in 24 hours to this macro I have I already created? Here is the Macro below. I need to add a time stamp to it and I am not sure of how.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim dtDate As Date\n\ndtDate = InputBox(\"Date\", , Date)\n\nSet SelRange = Range(\"B:B\")\nFor Each b In SelRange.Rows\nb.Value = dtDate\nb.Offset(0, 1).Value = dtDate + 1\nNext\nEnd Sub\n</code></pre>\n\n<p>I need the time to increment like for 24 hours base off the macro for this worksheet. I have an example of what I need to do. In this example the date and time is showing I need the time to increment in a 24 hour period.</p>\n\n<p><img src=\"http://i.stack.imgur.com/RWT0O.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["sql","excel"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":1549,"score":-3,"question_id":8814739,"title":"Importing excel data into SQL Server 2008","body":"<p>I need to import data from Excel to my database. I need to insert the data from my Excel sheet to an existing table in my database.</p>\n\n<p>I tried to import data with the help of sql wizard. Firstly I imported it into a temp table then I used an insert query to import data into my destination table. But it does not seem to have worked correctly.</p>\n\n<p>So, plz suggest me good way of importing the data. And also it would be better if you suggest some good sql script for importing.</p>\n"},{"tags":["excel","excel-vba","excel-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13172869,"title":"Add Comma after Every 11 Digits in Excel","body":"<p>I want to pus comma after every 11 digits in excel my data will be like this.</p>\n\n<p><code>ODU88131042ODU88131043ODU88131044ODU88131045ODU65110840ODU65110829ODU65110833ODU65110834ODU88131046ODU88131047ODU88131048ODU88131049ODU88131</code></p>\n\n<p>and i want answer like this</p>\n\n<pre><code>ODU88131046,ODU88131047,ODU88131048,ODU88131049,ODU88131050,ODU88131051,ODU88131052,ODU88131053,ODU88131054,ODU88131055,ODU88131056,ODU88131057,ODU88131058,ODU88131059,ODU88131060,ODU88131061,ODU88131062,ODU88131063,ODU88131064,ODU88131065,ODU88131066,ODU88131067,ODU88131068,ODU88131069,ODU88131070,ODU88131071,ODU88131072,ODU88131073,ODU88131074,ODU88131075,ODU88131076,ODU88131077,ODU88131078,ODU88131079,ODU88131080,ODU88131081,ODU88131082,ODU88131083,ODU88131084,ODU88131085,ODU88131086,ODU88131087,ODU88131088,ODU88131089,ODU88131090,\n</code></pre>\n\n<p>its a fix that i want comma in very 11 digits and the row it in only one cell and result is also shows in one cell only. please help me out..</p>\n"},{"tags":["c#","asp.net","sql-server","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13154009,"title":"How can i compare the values of excel cell values while using SqlBulkCopy?","body":"<p>I am importing Excelsheet into sql server database i need to check certain things before importing the sheet, such as  i have a column called passport which must have values starting with alphabet only and must have rest of the characters as numbers (only). </p>\n\n<pre><code>   DataTable dt7 = new DataTable();\n            dt7.Load(dr);\n            DataRow[] ExcelRows = new DataRow[dt7.Rows.Count];\n            // Bulk Copy to SQL Server\n\n            using (SqlBulkCopy bulkCopy = new SqlBulkCopy(sqlConnectionString))\n            {\n                bulkCopy.DestinationTableName = \"ExcelTable\";\n                dt7.Rows.CopyTo(ExcelRows, 0);\n\n                for (int i = 0; i &lt; ExcelRows.Length; i++)\n                {\n                    if (ExcelRows[i][\"data\"] == DBNull.Value)\n                    {\n                        // Include any actions to perform if there is no date\n                        //ExcelRows[i][\"data\"] = Convert.ToString(0);\n                    }\n                    else\n                    {\n                        DateTime oldDate = Convert.ToDateTime(ExcelRows[i][\"data\"]).Date;\n                        DateTime newDate = Convert.ToDateTime(oldDate).Date;\n                        ExcelRows[i][\"data\"] = newDate.ToString(\"yyyy/MM/dd\");\n                    }\n\n\n\n                }\n                bulkCopy.WriteToServer(ExcelRows);\n</code></pre>\n"},{"tags":["c#",".net","excel","xps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2091,"score":0,"question_id":884356,"title":"Programatically convert Excel to XPS","body":"<p>I am looking for a way to programatically convert Excel reports to XPS format.  Is this supported anywhere in the Microsoft framework, or should we look for a third party tool?</p>\n\n<p>Yes currently we are programatically creating Excel reports using ExcelWriter and need to produce XPS reports for a client.  So we either go direct to XPS which seems to be a larger learning curve, or convert the Excel report to XPS.</p>\n"},{"tags":["excel","excel-2007","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":11243423,"title":"Getting email address from a cell in excel","body":"<p>How to get email id from a cell which contain more records?</p>\n\n<p>For e.g. Cell <em>A1</em> has the following value:</p>\n\n<blockquote>\n  <p>google rockstar@xyz.com www.google.com</p>\n</blockquote>\n\n<p>I want to copy <strong>rockstar@xyz.com</strong> from the cell <em>A1</em> to <em>B1</em>.</p>\n"},{"tags":["vb.net","excel","range"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13170347,"title":"Name a range in dynamically created excel sheet using VB.NET","body":"<p>I want to name a range in an excel sheet that is created dynamically. I tried following but it is not working.</p>\n\n<pre><code>With oWB\n  For intCount = 1 To wbnum1\n    .Worksheets.Add(After:=.Worksheets(intCount + 1)) \n    .Sheets(intCount + 1).Name = \"Sheet\" &amp; intCount.ToString()\n    .Sheets(intCount + 1).Cells(19, 2).value = \"Sheet\" &amp; intCount.ToString\n    .Sheets(intCount+1).Range(\"A1:Z1\")\n    .Range.Name = \"Numbers\"\n  Next\n</code></pre>\n\n<p>what is wrong with this?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","content-type","mime"],"answer_count":5,"favorite_count":6,"up_vote_count":57,"down_vote_count":1,"view_count":31532,"score":56,"question_id":974079,"title":"Setting mime type for excel document","body":"<p>MS Excel has the following observed MIME types:</p>\n\n<ul>\n<li><code>application/vnd.ms-excel</code> (official)</li>\n<li><code>application/msexcel</code></li>\n<li><code>application/x-msexcel</code></li>\n<li><code>application/x-ms-excel</code></li>\n<li><code>application/x-excel</code></li>\n<li><code>application/x-dos_ms_excel</code></li>\n<li><code>application/xls</code></li>\n<li><code>application/x-xls</code></li>\n</ul>\n\n<p>Is there any one type that would work for all versions? If not, do we need to set <code>response.setContentType()</code> with each one of these mime types individually?</p>\n\n<p>Also, we use file streaming in our application to display document (not just excel - any type of document). In doing so, how can we retain the filename if the user opts to save the file - currently, the name of the servlet that renders the file appears as the default name.</p>\n"},{"tags":["django","excel","csv","unicode"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12970082,"title":"Create csv file using django and directly open into Excel","body":"<p>I have created the csv file through django. I have write the encoded data into that. but when i open this file in excel sheet then the unicode characters not display properly.</p>\n\n<p>I also refer this question\n<a href=\"http://stackoverflow.com/questions/10846133/django-create-csv-file-that-contains-unicode-and-can-be-opened-directly-with-exc\">Django create CSV file that contains Unicode and can be opened directly with Excel</a></p>\n\n<p>But didn't get the proper answer. I have tried all the answers, but didn't work any of them.</p>\n\n<p>I write the code as below.</p>\n\n<pre><code>    def exportcsv(request):\n        import csv\n        producer_list = Producer.objects.filter()\n        response = HttpResponse(mimetype='text/csv')\n        response['Content-Disposition'] = 'attachment; filename=producer.csv'\n        writer = csv.writer(response, delimiter=\",\")\n        writer.writerow(codecs.BOM_UTF16_LE)\n        writer.writerow(['Produsenter','Type','Land','Region'])\n        for cdst in producer_list:\n            writer.writerow([cdst.title.encode(\"UTF-8\"),\n                            cdst.producer_type.encode(\"UTF-8\"),\n                            cdst.country.country.encode(\"UTF-8\"),\n                            cdst.region.region.encode(\"UTF-8\")])\n        return response\n</code></pre>\n\n<p>Then the csv file created properly, but the characters in that not encoded properly.\nThe character will be display like \"Tokaj HÃ©tszÃ¶lÃ¶\".</p>\n\n<p>When i try </p>\n\n<pre><code>writer.writerow([cdst.title.encode(\"iso-8859-1\"),\n                            cdst.producer_type.encode(\"iso-8859-1\"),\n                            cdst.country.country.encode(\"iso-8859-1\"),\n                            cdst.region.region.encode(\"iso-8859-1\")])\n</code></pre>\n\n<p>Then the data will we added properly also open it excel file properly.\nBut it give error for some characters like 'æ' and ' in the string.</p>\n\n<p>Error: 'latin-1' codec can't encode character u'\\u2013' in position 266: ordinal not in range(256)</p>\n\n<p>I also try the below code.</p>\n\n<pre><code>response['Content-Disposition'] = 'attachment; filename=producer.csv'\nresponse.write(u'\\ufeff'.encode('utf8'))\nwriter = csv.writer(response, delimiter=\",\")\n</code></pre>\n\n<p>Also try </p>\n\n<pre><code>writer.writerow(codecs.BOM_UTF16_LE)\nwriter.writerow(str.decode('utf8').encode('utf_16_le'))\n</code></pre>\n"},{"tags":["r","excel","import","merge","import-from-excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13169823,"title":"R - Import & Merge Multiple Excel Files And Add Filesource Variable","body":"<p>I have used R for various things over the past year but due to the number of packages and functions available, I am still sadly a beginner. I believe R would allow me to do what I want to do with minimal code, but I am struggling.</p>\n\n<h3>What I want to do:</h3>\n\n<p>I have roughly a hundred different excel files containing data on students. Each excel file represents a different school but contains the same variables. I need to:<br /></p>\n\n<blockquote>\n  <ol>\n  <li>Import the data into R from Excel<br /></li>\n  <li>Add a variable to each file containing the filename<br /></li>\n  <li>Merge all of the data <em>(add observations/rows - do not need to match on variables)</em></li>\n  </ol>\n</blockquote>\n\n<p>I will need to do this for multiple sets of data, so I am trying to make this as simple and easy to replicate as possible.</p>\n\n<h3>What the Data Look Like:</h3>\n\n<blockquote>\n  <p><strong>Row 1</strong>&nbsp; &nbsp; Title<br>\n  <strong>Row 2</strong>&nbsp; &nbsp; <em>StudentID&nbsp; &nbsp; Var1&nbsp; &nbsp; Var2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; Var3&nbsp; &nbsp; &nbsp; Var4&nbsp; &nbsp; &nbsp; &nbsp; Var5</em><br />\n  <strong>Row 3</strong>&nbsp; &nbsp; 11234 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp;  &nbsp; &nbsp; &nbsp;9/8/2011&nbsp; &nbsp; &nbsp; 343&nbsp; &nbsp; &nbsp; 159-167&nbsp; &nbsp; &nbsp; 32<br />\n  <strong>Row 4</strong>&nbsp; &nbsp; 11235 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9/16/2011&nbsp; &nbsp; 112&nbsp; &nbsp; &nbsp; 152-160&nbsp; &nbsp; &nbsp; 12<br />\n  <strong>Row 5</strong>&nbsp; &nbsp; 11236 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9/8/2011&nbsp; &nbsp; &nbsp; 325&nbsp; &nbsp; &nbsp; 164-171&nbsp; &nbsp; &nbsp; 44</p>\n</blockquote>\n\n<p>Row 1 is meaningless and Row 2 contains the variable names. The files have different numbers of rows.</p>\n\n<h3>What I have so far:</h3>\n\n<p>At first I simply tried to import data from excel. Using the XLSX package, this works nicely:</p>\n\n<pre><code>dat &lt;- read.xlsx2(\"FILENAME.xlsx\", sheetIndex=1, \n                  sheetName=NULL, startRow=2, \n                  endRow=NULL, as.data.frame=TRUE, \n                  header=TRUE)\n</code></pre>\n\n<p>Next, I focused on figuring out how to merge the files (also thought this is where I should add the filename variable to the datafiles). This is where I got stuck. </p>\n\n<pre><code>setwd(\"FILE_PATH_TO_EXCEL_DIRECTORY\")\nfilenames &lt;- list.files(pattern=\".xls\")\ndo.call(\"rbind\", lapply(filenames, read.xlsx2, sheetIndex=1, colIndex=6, header=TRUE, startrow=2, FILENAMEVAR=filenames));\n</code></pre>\n\n<p>I set my directory, make a list of all the excel file names in the folder, and then try to merge them in one statement using the a variable for the filenames.</p>\n\n<p>When I do this I get the following error:</p>\n\n<blockquote>\n  <p>Error in data.frame(res, ...) : \n   arguments imply differing number of rows: 616, 1, 5</p>\n</blockquote>\n\n<p>I know there is a problem with my application of lapply - the startrow is not being recognized as an option and the FILENAMEVAR is trying to merge the list of 5 sample filenames as opposed to adding a column containing the filename.</p>\n\n<h3>What next?</h3>\n\n<p>If anyone can refer me to a useful resource or function, critique what I have so far, or point me in a new direction, it would be GREATLY appreciated!</p>\n"},{"tags":["excel","vba","macros","filter","autofilter"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13125788,"title":"Filter excel spreadsheet by month and year","body":"<p>So I need to find the max price and min price for each month of each year.</p>\n\n<pre><code>Sub Anaylze()\nDim datemonthcount As Long\nDim dateyearcount As Long\nDim yearcount As Long\nDim month As Long\nDim yearstart As Long\nDim maxprice As Long\nDim minprice As Long\nDim rowprice As Long\nDim percentchange\n\nDim counterlong As Integer\n\nrowprice = 1\nyearstart = 2002\ncounterlong = 0\n\n    Range(\"A1\").Select\n    Do Until IsEmpty(ActiveCell) Or ActiveCell.Value = 0 Or IsNumeric(ActiveCell) = False\n        counterlong = counterlong + 1 'Increments the counter\n         If year(ActiveCell.Text) &lt;&gt; year((ActiveCell.Offset(-1, 0).Text)) Then\n         dateyearcount = dateyearcount + 1\n         End If\n         ActiveCell.Offset(1, 0).Select ' Step down 1 row from present location.\n    Loop\n\n    For yearcount = 0 To dateyearcount\n    For month = 1 To 12\n    'Range(\"A1\", \"B\" &amp; counterlong).AutoFilter Field:=1, Criteria1:=\"&gt;=\" &amp; month &amp; \"/01/\" &amp; yearstart, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; month &amp; \"/31/\" &amp; yearstart\n    maxprice = WorksheetFunction.Max(Range(\"A1\", \"B\" &amp; counterlong).AutoFilter(Field:=1, Criteria1:=\"&gt;=\" &amp; month &amp; \"/01/\" &amp; yearstart, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; month &amp; \"/31/\" &amp; yearstart))\n    minprice = WorksheetFunction.Min(Range(\"A1\", \"B\" &amp; counterlong).AutoFilter(Field:=1, Criteria1:=\"&gt;=\" &amp; month &amp; \"/01/\" &amp; yearstart, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; month &amp; \"/31/\" &amp; yearstart))\n    Cells(rowprice, \"g\") = maxprice\n    Cells(rowprice, \"h\") = minprice\n    rowprice = rowprice + 1 \n    Next\n    yearstart = yearstart + yearcount\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>My biggest issue is trying to get the filter to work, my data is formatted in this manner</p>\n\n<pre>10/26/2012   61.66\n10/25/2012   61.6</pre>\n"},{"tags":["excel","pivot-table"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13168603,"title":"pivot table / chart default sorting","body":"<p>What is default sorting for excel 2010 pivot table and charts I have a \"Year month Week\" column in my data sheet which I am using as row label, excel pivot table renders it arbitrarily</p>\n\n<p>like in data sheet I have data in the following order</p>\n\n<pre><code>2010 October Week 1\n2010 September Week 1\n2010 September Week 2 \n2010 September Week 3\n2010 September Week 4\n</code></pre>\n\n<p>but when I use this in pivot table it generates row labels as</p>\n\n<pre><code>2010 October Week 1\n2010 September Week 3\n2010 September Week 2 \n2010 September Week 4\n2010 September Week 1\n</code></pre>\n\n<p>I want pivot table to show row labels exactly in the same order as it is in data sheet</p>\n"},{"tags":["excel","charts"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10915,"score":0,"question_id":5161284,"title":"Reordering Chart Data Series in Excel","body":"<p>How does one reorder series used to create a chart in Excel?</p>\n\n<p>For example, I go to the chart, right click > Select Data. In the left column I see series 1, series 2,...,series n. Say, I want to move series 3 after series 4, can it be done from chart view? I don't want to move the data cells in the worksheet. </p>\n\n<p>I'm using Excel 2011 (mac os x).</p>\n"},{"tags":["python","excel","file","list","microsoft"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13161867,"title":"making a 2D array in python","body":"<p>I am tasked with writing a 2d array which will allow me to repeadly loop over the line and store the cells in a 5 length array. What I want help in is how to create it so that it keeps looping until it reaches the last 5  values and stores those.</p>\n\n<p>So an example, I have 6 whole line in my .csv file </p>\n\n<pre><code>line = \"1,9/20/2012, 48.019,34.888,37.334,35.425,36.69,38.916,36.837,39.212,37.528,37.404\"\nline = \"1,9/20/2012, 38.019,54.888,36.334,35.425,36.69,38.916,36.837,39.212,37.528,37.404\"\nline = \"1,9/20/2012, 28.019,31.888,56.334,33.825,36.69,38.916,36.837,39.212,37.528,37.404\"\nline = \"1,9/20/2012, 48.019,34.888,37.334,35.425,36.69,38.916,36.837,39.212,37.528,37.404\"\nline = \"1,9/20/2012, 38.019,54.888,31.334,37.425,33.69,38.916,36.837,39.212,37.528,37.404\"\nline = \"1,9/20/2012, 28.019,31.888,56.334,33.825,36.69,38.916,36.837,39.212,37.528,37.404\"\n</code></pre>\n\n<p>i have set my script to skip over the first 2 vales [1,9/20/2012]</p>\n\n<p>then I have had them separated meaning the first 5 values is <code>htr1</code> and 2nd <code>htr2</code> <code>[ 48.019,34.888,37.334,35.425,36.69]</code> <code>[38.916,36.837,39.212,37.528,37.404]</code></p>\n\n<p>So basically what I need help in is essentially taking on last 5 values in column and storing them in the array or list in python. example</p>\n\n<pre><code>htrA[38.019,28.019,48.019,38.019,28.019]\nhtrB[36.334,56.334,37.334,31.334, 56.334\n</code></pre>\n\n<p>Here the code I have so far</p>\n\n<pre><code>inFile = open(\"input_test.csv\", \"r\")\noutFile = open(\"results.txt\", \"w\")\n\n#To reliably determine steady state temperature average fifoSize last temperature readings\nfifoSize = 5        #last fifoSize to average to get final temperature\nbufFifo = FiFoBuf(fifoSize) \n\n#Write Header\n#outFile.write('Test Name,X+ avg,X+ std,X+ count,X- avg,X- std,X- count,X angle,Y+ avg,Y+ std,Y+ count,Y- avg,Y- std,Y- count,Y angle\\n')\n\nfor line in inFile:\n\n    print line\n    #Characters of each line as list - items that were separated by commas\n    list = line.rstrip().replace(' ','').split(',')\n    list = list[2:]     #remove index and date code (1st 2 items of list)\n\n    htr1 = list[0:5]    #1st heater temperatures\n    htr2 = list[6:10]   #2nd heater temperatures\n\n\n\n    print \"\\nhtr1: \"\n    print htr1\n    print \"\\nchDeviation(htr1): \"\n    print chDeviation(htr1)\n\n    avg()\n#printStats()\n\ninFile.close()\noutFile.close()\n</code></pre>\n"},{"tags":[".net","vb.net","visual-studio-2010","excel","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13166308,"title":"\"Class not registered\" error when working with excel and visual studio 2010","body":"<p>Hello i'm trying to import data from an excel to visual basic variables, but im getting an strange error. I did add the reference to microsoft excel com library.</p>\n\n<pre><code>Imports Microsoft.Office.Interop.Excel\n\nModule Module1\n\nSub Main()\n    ExtraerCostos()\nEnd Sub\n\nPublic Sub ExtraerCostos()\n\n    Dim numero As String\n    Dim aux As String\n    Dim costos(20) As Double\n    Dim cant As Integer  \n\n    Dim excelApp As New Microsoft.Office.Interop.Excel.Application\n    Dim workbook As New Microsoft.Office.Interop.Excel.Workbook ' The error points to this line \n    Dim sheet As New Microsoft.Office.Interop.Excel.Worksheet\n\n    excelApp = CreateObject(\"Excel.Application\")\n    excelApp.Visible = True\n    workbook = excelApp.Workbooks.Open(\"C:\\workbook.xls\")\n    sheet = workbook.Worksheets(\"Factura Detallada\")\n\n     'Irrelevant code\n    numero = \"111111111\"\n    cant = 12\n\n    While numero.Length = 9\n        cant = cant + 1\n    End While\n\n    For i = 12 To cant\n\n        numero = sheet.Cells(i, 1).text\n        For j = 3 To 22\n            aux = sheet.Cells(i, j).text\n            If aux = \"-\" Then\n                costos(j - 2) = 0\n            Else : costos(j - 2) = Convert.ToDouble(aux)\n\n            End If\n            Console.WriteLine(costos(j - 2))\n        Next\n\n\n    Next\n\nEnd Sub\nEnd Module\n</code></pre>\n\n<p>Retrieving the COM class factory for component with CLSID {00020819-0000-0000-C000-000000000046} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).</p>\n"},{"tags":["excel","vba","macros","excel-vba"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":7362,"score":2,"question_id":5590963,"title":"get text from a cell range in excel vba","body":"<pre><code>Dim myText As String\nmyText= Range(\"a3\").Text\n</code></pre>\n\n<p>Returns a value in range a3\nbut </p>\n\n<pre><code>myText= Range(\"a3:c7\").Text\n</code></pre>\n\n<p>gives me an error,Is there a way to get the text from range.( The format of the output text being as for example while we would get while copying from the range and pasting in a notepad.)</p>\n"},{"tags":["excel","vb6"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13166380,"title":"When putting string that into Excel spreadsheet it puts to Scientific notation or rounds up","body":"<p>I am putting a string into excel. The string is often only numeric digits but can have alpha characters or hypens etc. </p>\n\n<p>When I don't set the number format or set it like this\n(Where xlSheet(0) is Excel.Worksheet)</p>\n\n<pre><code>xlSheet(0).Columns(\"N:N\").EntireColumn.Columns.NumberFormat = \"@\"\n</code></pre>\n\n<p>It outputs in scientific notation.</p>\n\n<p>When I use this code:</p>\n\n<pre><code>xlSheet(0).Columns(\"N:N\").EntireColumn.Columns.NumberFormat = \"0\"\n</code></pre>\n\n<p>It rounds up the number to the nearest 100,000 so that the last five digits are 0's when they shouldn't be.</p>\n\n<p>Should be: 1539648751235678942\nBut is: 1539648751235600000</p>\n\n<p>The cells that have a hyphen or a letter aren't affected and work fine.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>EDIT: </p>\n\n<p>I add the data like this:</p>\n\n<p>I loop through and put in <code>xlSheet(0).Cells(i, 14) = rs!value_number</code></p>\n\n<p>Where rs is my ADODB.Recordset</p>\n\n<p>EDIT2: Herbert Sitz got it by adding an apostrophe before the text! Thanks everyone.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13165938,"title":"What is the function of FormulaR1C1?","body":"<p>I have been looking at <strong>FormulaR1C1</strong> as a function, how does this exactly work? I understand what has been said all over the internet which is stands as Row 1 Column 1, but how do people actually make it work? What is the <strong>end result</strong> of using <strong>FormulaR1C1</strong>?</p>\n\n<p>Also can it be changed to start at a specific point in a sheet, or it always going to be R1C1? So could it be <strong>FormulaR2C3</strong>? </p>\n"},{"tags":["asp.net","vb.net","excel","data","export"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":209,"score":0,"question_id":12161436,"title":"'System.OutOfMemoryException' was thrown when Exporting Data in Excel from .NET code","body":"<p>I have a code to debug where I am attempting to export data in Excel. It works fine for smaller data but when data size increases to several thousands, I get 'Out of Memory exception'. My application is running on IIS 6.0. Any recommendations?  </p>\n\n<p>PS: The process usually fails when it takes more than 1.2 GB of memory (looking at the Task Manager)</p>\n\n<pre><code>Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)\n  If (IsExportToCSV) Then\n  Response.Clear()\n        Response.ContentType = \"application/vnd.ms-excel\"\n\n        Response.ContentType = \"a\"\n        'Remove the charset from the Content-Type header.\n        Response.Charset = \"\"\n        'Turn off the view state.\n        Page.EnableViewState = False\n        Dim tw As System.IO.StringWriter\n        tw = New System.IO.StringWriter\n        Dim hw As HtmlTextWriter = New HtmlTextWriter(tw)\n        'Get the HTML for the control.\n        Me.GridView1.AllowPaging = False\n        Me.GridView1.DataBind()\n        Me.GridView1.EnableViewState = False\n        Me.GridView1.AutoGenerateEditButton = False\n        Me.GridView1.RenderControl(hw)\n        Response.Write(tw.ToString)\n        Response.Flush()\n        Response.End()\n\n    Else\n        MyBase.Render(writer)\n    End If\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","event-handling","userform"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":17757,"score":3,"question_id":566770,"title":"Assign on-click VBA function to a dynamically created button on Excel Userform","body":"<p>I'm creating buttons dynamically on an Excel userform with the following code:</p>\n\n<pre><code>With Me.CurrentFrame.Controls.Add(\"Forms.CommandButton.1\")\n    .Caption = \"XYZ\"\n    .name = \"AButton\"\n    .Font.Bold = True\n    .ForeColor = &amp;HFF&amp;\n    ... blah blah blah\nEnd With\n</code></pre>\n\n<p>I'd like to assign a function to run when these buttons are clicked, but I can't find a straightforward way to do this since there's no property as part of the button itself.</p>\n\n<p>Is there a way to do this using the above idiom? Should I be going about this whole thing in a different way?</p>\n"},{"tags":["excel","vba","formula","worksheet"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13161474,"title":"Excel Formula for dynamic columns","body":"<p>I'll try to make sense of this the best I can. I'm pretty horrible at making things clear. :) So...here it goes....</p>\n\n<p>I have a spread sheet that is a list of seeds I have for growing peppers. Here are the columns I have, and I will explain more after.</p>\n\n<p>Crop | Color | Generation | Species | Source | Scoville | Flavor | Heat | Notes | 2012 Type | 2012 Name 1 | 2012 Name 2 | 2013 Type | 2013 Name 1 | 2013 Name 2 | etc.</p>\n\n<p>Ok. So \"2012 Type\" is a list that will contain either a blank, \"N\", \"O\", or \"M\". All I care about is whether it is blank or not for this question. If it is NOT blank I want to highlight the Crop name with a green background to show that I have grown this crop. To do that through the Conditional Formatting is a no brainer. However, my issue begins when I, as usual make things more complicated. When I add \"2013 Type\", \"2014 Type\", etc. I want to check for those also. So then my formula becomes an OR; is there a value in 2012 or 2013 or 2014, etc. Part of question is that. How do I write a formula that is dynamic enough to pickup the new fields I add each year...2015 Type, 2016 Type...etc.?</p>\n\n<p>I also have a ton of other stuff going on, but I think I may have that figured out...sort of. </p>\n\n<p>Thank you for your help, appreciate it.</p>\n\n<p>Edit: Okay. I feel I need to explain how I am trying to develop my whole worksheet, one to check my thinking, and two to clear up the goals.</p>\n\n<p>In addition to what I have explained above, I have tabs that read <strong>2012</strong>, <strong>2013</strong>, <strong>grown</strong>, <strong>not-grown</strong>, <strong>MasterList</strong>, and <strong>Criteria</strong>.</p>\n\n<p><strong>MasterList</strong> is what we are talking about here. </p>\n\n<p><strong>Criteria</strong> is what I am using for an advanced filter to copy crops that to the appropriate sheets. So, if I have a a crop marked in column \"<strong>2012 Type</strong>\", then it will be copied to the <strong>2012</strong> sheet. It will also be listed under the tab Grown. Same if it were marked under \"<strong>2013 Type</strong>\" etc. </p>\n\n<p>Basically, I am using tabs to filter out specifics from my MasterList so that I can find what I'm looking for quickly, or view everything as a whole.</p>\n\n<p>Once again, I am great at making things over complicated. Couple that with the fact that I am still fairly new to Excel coding...and you have a disaster. :)</p>\n\n<p>Thank you all for listening. :)</p>\n"},{"tags":["excel","vba","excel-vba","activex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13149355,"title":"How to programmatically click an ActiveX button in another workbook?","body":"<p>I have a workbook <code>Wbk1</code> where a sheet has an ActiveX button.  I want to run the button's associated Sub from another workbook,<code>Wbk2</code>.  It's not practical to just copy the Sub's code into <code>Wbk2</code> because it in turn calls a bunch of functions from <code>Wbk1</code>.  I tried the following:</p>\n\n<pre><code>Sub pushButton()\n\nDim obj As OLEObject\nDim btn As MSForms.CommandButton\n\nFor Each obj In Wkb1.Sheets(\"testSheet\").OLEObjects\n  If TypeOf obj.Object Is MSForms.CommandButton Then\n    set btn=obj.Object\n    debug.print btn.Caption 'used to test whether or not For loop is picking up button\n    obj.Activate\n    SendKeys \" \"\n  End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>It's not only an inelegant <code>SendKeys()</code> hack, but it doesn't work; the button gets focus but it doesn't get pushed.  I know that the For loop is correctly iterating through the objects, including the CommandButton, because I can pick up the caption for the button.  How can I click on this button (and thereby run its private Sub) from <code>Wbk2</code>?</p>\n\n<p>EDIT: The actual filename in question is in the format 123A_1.0-2.0.xlsm. I think the periods are causing some trouble with regard to the solutions posted in comments and responses below, because when I remove the periods these techniques are successful.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13164176,"title":"excel shows numbers truncated instead of full format","body":"<p>I am trying to export an excel file to csv and it exports this number : 680001010091945\nas : 6.8E+14 \nhow do I make it display the full number instead of a truncated one ?\nany help ? thank you </p>\n"},{"tags":["excel","vba","excel-vba","negative-number"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13162156,"title":"vba check for negative value","body":"<p>I wrote a simple VBA code to check if the value of a cell is negative and if it is negative, highlight it red. For some reason, I keep getting \"run-time mismatch\". My code is</p>\n\n<pre><code>For x = 2 To 100\n\nSet val3 = Worksheets(\"Summary\").Cells(x, 9)\nIf val3.Value &lt; 0 Then\nWorksheets(\"Summary\").Cells(x, 9).FontColorIndex = 3\n\nEnd If\nNext x\n</code></pre>\n\n<p>Column 9 (the column I am checking) is filled with dollar values. Thank you in advance for your help.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13136143,"title":"Why does casting to double using \"String * 1\" fail? Will CDbl(String) work on all systems?","body":"<p>I have an application which contains the line below to assign a parsed XML value to a variant array.</p>\n\n<pre><code>V(2) = latNode.Text * 1\n</code></pre>\n\n<p>This works fine on my system (Windows 7, Excel 2010) but doesn't work on some other system or systems - and I've not been able to get a response from the user who reported the problem.</p>\n\n<p>I've switched out the offending line for:</p>\n\n<pre><code>V(2) = CDbl(latNode.Text)\n</code></pre>\n\n<p>This still works on my system, but then I had no problem in the first place. The question is on what systems does the first approach fail and why, and will the second method always work? I'm sure I've used the \"Stying * 1\" trick elsewhere before and would like to know how concerned I should be about tracking down other occurrences.</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","vbscript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13162748,"title":"VBScript leaves phantom processes running; How to get rid of them?","body":"<p>I am doing some automation with vbscript and everytime I run the script, it leaves the process \"EXCEL.EXE\" running. How do I prevent that?</p>\n\n<p>Code:</p>\n\n<pre><code>Set oFs = CreateObject(\"Scripting.FileSystemObject\")\n\nset objExcel = createObject(\"Excel.Application\")\nset objWorkbook = objExcel.Workbooks.open(\"C:\\test\\test.xlsx\")\n\nfor each sheet in objWorkbook.worksheets\nwscript.echo(sheet.name)\nset objSheet = sheet\n\nnext \n\nset objSheet = Nothing\nset objworkbook = Nothing\nset objExcel = Nothing\nSet oFs = Nothing\n</code></pre>\n\n<p>How do I prevent EXCEL.exe from continuing to run after my script exits?</p>\n"},{"tags":["excel","excel-vba","excel-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13144022,"title":"Macro wont delete all blank cells","body":"<p>This is a longish query because I include failed code. </p>\n\n<p>The Problem: When I have finished importing a text file to excel, my worksheet contains a number of 'blank' cells. I've used the following code successfully before elsewhere but it it not working for me on this occassion.</p>\n\n<pre><code>Range(\"b1:AZ60\").Select\nSelection.SpecialCells(xlCellTypeBlanks).Select\nSelection.Delete shift:=xlToLeft\n</code></pre>\n\n<p>I've searched the web and found a number of proposed solutions (below). I've tried running each of the 4 snipets of code below before my code above to clear the contents of supposedly blank cells but nothing has worked so far.</p>\n\n<p>Number 1---------------------------------------------------------</p>\n\n<pre><code> Set rng = Intersect(Selection, Selection.Parent.UsedRange)\n\nFor Each C In rng\n   If Trim(C) = \"\" Then\n   C.ClearContents\n   End If\nNext C\n</code></pre>\n\n<p>I've replaced the trim above with c.value but nothing</p>\n\n<pre><code>If C.Value &lt;&gt; \"\" Then\n</code></pre>\n\n<p>Number 2--------------------------------------------------</p>\n\n<pre><code>For Each aCell In ActiveSheet.Cells.SpecialCells(xlCellTypeConstants)\n    If Not aCell.Value Like \"*[! ]*\" Then aCell.ClearContents\nNext\n</code></pre>\n\n<p>Number 3-------------------------------------------------</p>\n\n<pre><code>For Each C In rng\n   If IsEmpty(C) Then\n   C.Delete shift:=xlToLeft\n   Else\n   ActiveCell.Select\n   End If\nNext C\n</code></pre>\n\n<p>Number 4--------------------------------------</p>\n\n<p>Finally I found this clean funtion, but that didn't seem to do the trick.</p>\n\n<pre><code>Set rng = Intersect(Selection, Selection.Parent.UsedRange)\n\nFor Each C In rng\n    If Not IsError(C) Then\n        C.Value = MEGACLEAN(C)\n    End If\nNext C\n              '\n              '\n              '\nEnd Sub\n-----------------------------------------\nFunction MEGACLEAN(varVal As Variant)\nDim NewVal As Variant\nIf IsMissing(varVal) Then Exit Function\nNewVal = Trim(varVal) 'remove spaces\nNewVal = Application.WorksheetFunction.Clean(NewVal) 'remove most unwanted characters\nNewVal = Application.WorksheetFunction.Substitute(NewVal, Chr(127), \"\") 'remove   \nASCII#127\nNewVal = Application.WorksheetFunction.Substitute(NewVal, Chr(160), \"\") 'remove  \nASCII#160\nMEGACLEAN = NewVal\nEnd Function\n</code></pre>\n\n<p>Perhaps it is something to do with the text file I imported from but none of these have worked satisfactorily as I still have a few blank cells. Any help would be much appreciated!!</p>\n"},{"tags":["asp.net","vb.net","excel","openxml","openxml-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13040936,"title":"Creating an Excel file via OpenXML in ASP.NET/VB.NET and sending over Response","body":"<p>trying to just create a simple OpenXML document based on <a href=\"http://www.codeproject.com/Articles/371203/Creating-basic-Excel-workbook-with-Open-XML\" rel=\"nofollow\">http://www.codeproject.com/Articles/371203/Creating-basic-Excel-workbook-with-Open-XML</a> \ni moved it over to asp.net (below) on my dev server but the file that is created is corrupted and will not open.  am i doing something obviously stupid?</p>\n\n<pre><code>Private Sub Button2_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button2.Click\n    Response.Clear()\n    Response.Buffer = False\n    Dim myoutputstream As New MemoryStream\n    Dim myPackage As SpreadsheetDocument = CreateWorkbook(myoutputstream)\n\n    AddWorksheet(myPackage, \"Test\")\n    myPackage.WorkbookPart.Workbook.Save()\n\n    Response.AddHeader(\"Content-Disposition\", (\"attachment\") &amp; \"; filename=Report.xlsx\")\n    Response.ContentType = \"application/octet-stream\"\n    Response.AddHeader(\"Accept-Header\", myoutputstream.Length.ToString())\n    Response.AddHeader(\"Content-Length\", myoutputstream.Length.ToString())\n    Response.BinaryWrite(myoutputstream.GetBuffer())\n    Response.End()\n\nEnd Sub\n\nPublic Shared Function CreateWorkbook(ByVal MyMemoryStream As MemoryStream) As SpreadsheetDocument\n    Dim spreadSheet As SpreadsheetDocument = Nothing\n    Dim sharedStringTablePart As SharedStringTablePart\n    Dim workbookStylesPart As WorkbookStylesPart\n\n    Try\n        ' Create the Excel workbook\n        spreadSheet = SpreadsheetDocument.Create(MyMemoryStream, SpreadsheetDocumentType.Workbook, False)\n\n        ' Create the parts and the corresponding objects\n        ' Workbook\n        spreadSheet.AddWorkbookPart()\n        spreadSheet.WorkbookPart.Workbook = New DocumentFormat.OpenXml.Spreadsheet.Workbook()\n        spreadSheet.WorkbookPart.Workbook.Save()\n\n        ' Shared string table\n        sharedStringTablePart = spreadSheet.WorkbookPart.AddNewPart(Of SharedStringTablePart)()\n        sharedStringTablePart.SharedStringTable = New DocumentFormat.OpenXml.Spreadsheet.SharedStringTable()\n        sharedStringTablePart.SharedStringTable.Save()\n\n        ' Sheets collection\n        spreadSheet.WorkbookPart.Workbook.Sheets = New DocumentFormat.OpenXml.Spreadsheet.Sheets()\n        spreadSheet.WorkbookPart.Workbook.Save()\n\n        ' Stylesheet\n        workbookStylesPart = spreadSheet.WorkbookPart.AddNewPart(Of WorkbookStylesPart)()\n        workbookStylesPart.Stylesheet = New DocumentFormat.OpenXml.Spreadsheet.Stylesheet()\n        workbookStylesPart.Stylesheet.Save()\n    Catch exception As System.Exception\n\n    End Try\n\n    Return spreadSheet\nEnd Function\n\nPublic Shared Function AddWorksheet(ByVal spreadsheet As SpreadsheetDocument, ByVal name As String) As Boolean\n    Dim sheets As DocumentFormat.OpenXml.Spreadsheet.Sheets = spreadsheet.WorkbookPart.Workbook.GetFirstChild(Of DocumentFormat.OpenXml.Spreadsheet.Sheets)()\n    Dim sheet As DocumentFormat.OpenXml.Spreadsheet.Sheet\n    Dim worksheetPart As WorksheetPart\n\n    ' Add the worksheetpart\n    worksheetPart = spreadsheet.WorkbookPart.AddNewPart(Of WorksheetPart)()\n    worksheetPart.Worksheet = New DocumentFormat.OpenXml.Spreadsheet.Worksheet(New DocumentFormat.OpenXml.Spreadsheet.SheetData())\n    worksheetPart.Worksheet.Save()\n\n    ' Add the sheet and make relation to workbook\n    sheet = New DocumentFormat.OpenXml.Spreadsheet.Sheet With {\n       .Id = spreadsheet.WorkbookPart.GetIdOfPart(worksheetPart),\n       .SheetId = (spreadsheet.WorkbookPart.Workbook.Sheets.Count() + 1),\n       .Name = name}\n\n    sheets.Append(sheet)\n    spreadsheet.WorkbookPart.Workbook.Save()\n\n    Return True\nEnd Function\n</code></pre>\n"},{"tags":["java","excel","statistics","apache-commons","percentile"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":763,"score":3,"question_id":5948146,"title":"Java Apache Commons getPercentile() different result that MS Excel percentile","body":"<p>I have an algorithm that calculates the <code>percentile(85)</code> with <code>Apache Commons</code> of a series of values (12 values), for a later evaluation with a threshold to make a decision. The result is similar to the one given by Excel, but not equal, and sometimes this is critical for my application because with excel the result doesn't pass the threshold and with Apache Commons Math in <code>Java</code> it does, so I get different outputs. </p>\n\n<p>Here it is an example: Internet traffic (Mbps) every 2 hours</p>\n\n<blockquote>\n  <p>32,7076813360000000   41,2580429776000000 45,4453940200000000 48,8044409456000000 46,7462847936000000 49,8028100056000000 54,3719451144000000 41,9708134600000000 29,4371963240000000 22,4667255616000000 20,0388452248000000 28,7807757104000000</p>\n</blockquote>\n\n<p>After dividing by 1000 Mb (the capacity of the cable) I calculate the percentil(85) of the Occupation:</p>\n\n<p>Excel: 0,049153870117</p>\n\n<p>Apache Commons Math: 0.05003126676104001</p>\n\n<p>I have found that it is possible to change the implementation of the percentile (it does not exist an official one) with <code>setPercentileImpl()</code>, but I couldn't find any example of how to do this, or the Excel algorithm (which is the one I was told to achieve).</p>\n\n<p>Any help about this will be welcomed. </p>\n\n<p>Thank you.</p>\n"},{"tags":["c#",".net","vb.net","excel","interop"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13144756,"title":"Control Excel Within WebBrowser Control","body":"<p>I am trying to load a .xls file into a webbrowser control in my Windows Forms app in such a way that I can keep updating it with data programmatically.</p>\n\n<p>So, for example, as the user presses a button on the form, the data in the Excel sheet updates.</p>\n\n<p>I have managed to load the data into the control very easily:</p>\n\n<pre><code>WebBrowser1.Navigate(PathToXLSFile)\n</code></pre>\n\n<p>And, according to what I have read online, I should be able to now get control of that sheet using something along the lines of:</p>\n\n<pre><code>Dim wb As Object\nWebBrowser1.Navigate(PathToXLSFile)\nwb = WebBrowser1.Document\n</code></pre>\n\n<p>Now, I have tried putting that final line of code into BOTH the <code>WebBrowser1_DocumentCompleted</code> <em>and</em> the <code>WebBrowser1_Navigated</code> modules, but for both, I get that <code>WebBrowser1.Document = Nothing</code>.</p>\n\n<p>I have looked online and found the solutions such as <a href=\"http://www.codeproject.com/Articles/15760/How-to-Integrate-Excel-in-a-Windows-Form-Applicati\" rel=\"nofollow\">this</a>, <a href=\"http://support.microsoft.com/kb/304662\" rel=\"nofollow\">this</a> and <a href=\"http://www.vbforums.com/showthread.php?455851-RESOLVED-Excel-in-Web-Browser-Control-Select-sheet-problem\" rel=\"nofollow\">this</a>, but none of them are working for me.</p>\n\n<p>Again, what I'm looking to do is to load the Excel sheet into the webbrowser control (or another control if you have better ideas) and to be able to edit/change it via .NET.</p>\n\n<hr>\n\n<p>As for my full scenario (why I need this):</p>\n\n<p>Basically, my program generates a enormous amount of data that end-users want to see formatted in a particular way (often changing), so what I have done is create a formatted excel sheet with formulas referencing back to a table on a different excel sheet.\nThat way, all my program needs to do is spit out all the calculated values to the table and then the data is there for the users to see (and is very easily customizable without messing up my program).</p>\n\n<p>The challenge is that now they want to see <em>lots</em> of iterations of this data on a windows form, so, basically what I need to do is each time they want to see the new data, calculate it on the fly and re-show it to them.</p>\n\n<p>I figured out the DataGridView was very difficult to use here because of the complex formatting, so what I'm looking to do is show them the \"Output\" sheet (via a webBrowser control because that's all that I could find) and have the ability to keep updating the \"Input\" sheet with new data such that the output sheet keeps updating.</p>\n"},{"tags":["c#","excel","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13157904,"title":"Error when creating Excel document using NetOffice Interop","body":"<p>I am getting the following unhandled exception when I try to create an excel document using my c# application.  This process works fine when I am running the c# application from visual studio 10, but when I try to run the application outside of visual studio using the .exe file this error is appearing.</p>\n\n<pre><code>System.IO.FileNotFoundException: Could not load file or assembly 'ExcelApi, Version=1.5.1.2, Culture=neutral, PublicKeyToken=9084b9221296229e' or one of its dependencies. The system cannot find the file specified.\nFile name: 'ExcelApi, Version=1.5.1.2, Culture=neutral, PublicKeyToken=9084b9221296229e'\n</code></pre>\n"},{"tags":["excel","big-o"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13109983,"title":"Working Out Big O Of Functions Using Java + Excel","body":"<p>I have been trying to get the big O of four different functions using java and excel. I have no idea what these functions are as they have been hidden. I am not sure if this is the right place / forum to ask.</p>\n\n<p>I have got the functions to give various pieces of data using some java and put them into excel along with the steps (1-n). I then put them into graphs straight away using just the n and the arbitrary measure of time they took if the output was constantly the same. For example if n = 1 always equal 200 for every time its run. For the ones that varied each time the function was run I ran the function 10 times and did an average for each step. </p>\n\n<p>After I had the data I created a graph for each one and put a trendline on it. My f(1) for example was best fitted to a polynomial trendline order 2, which I assume is Quadratic (n2) of big O?. But I needed to prove it was n2, so I did =Steps/LOG(N) which made it fit best to a polynomial trendline order 3, which I assume is Cubic (n3)? (Is that right?) </p>\n\n<p>I really have no idea what to do next to 'prove' that this function is Quadratic or Cubic or how to prove its best case / worst case. </p>\n\n<p>So basically I am trying to work out what the missing step is.</p>\n\n<p>Computation\nGraph\nTrendline\n??? - Proof that the function has big O(?) </p>\n"},{"tags":["c#","excel","csv"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":66,"score":-1,"question_id":13160371,"title":"How to keep first 0 in csv when open it and save as in Excel","body":"<p>I created csv file in format \"Surname;Birthday;Name\". Where Birthday is in format ddmmyyyy (e.g. 01121989 or 09111983). </p>\n\n<p>When I opened it in Excel It did not show first '0'.</p>\n\n<ol>\n<li>Can I escape this symbol to show full date in Excel?</li>\n<li>When I saved this file from Excel using option \"Save as\" It lost first '0' in Birthday. Is it possible to prevent this? </li>\n</ol>\n\n<p>Thank you.</p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13146732,"title":"POI: How to validate empty cells in a range","body":"<p>I'm creating an Excel file where, once created and downloaded, a user isn't allowed to let empty cells in a specific column (<em>because he will send it again with information he entered</em>).</p>\n\n<p>I'm using <code>POI HSSFDataValidation</code> with <code>setEmptyCellAllowed(false)</code>.\n<br />But when the user downloads the file, he still can leave empty cells (<em>after writing some text and deleting it</em>).</p>\n\n<p>Any suggestions?</p>\n\n<p>Here's my code:\nHSSFDataValidation dv = new HSSFDataValidation();\n<code>dv.setFirstColumn((short)19);\n    dv.setLastColumn((short)19);\n    dv.setFirstRow((short)4);\n    dv.setLastRow((short)24);\n    dv.setDataValidationType(DVConstraint.ValidationType.INTEGER);\n    dv.setOperator(DVConstraint.OperatorType.BETWEEN);\n    dv.setDataValidationType(HSSFDataValidation.DATA_TYPE_INTEGER);\n    dv.setOperator(HSSFDataValidation.OPERATOR_BETWEEN);\n    dv.setFirstFormula(\"0\");\n    dv.setSecondFormula(\"1000\");\n    //dv.setEmptyCellAllowed(true);\n    dv.setEmptyCellAllowed(false);\n    dv.setShowPromptBox(true);\n    dv.setSurppressDropDownArrow(false);\n    dv.setErrorStyle(HSSFDataValidation.ERROR_STYLE_STOP);\n    //dv.createErrorBox(\"\", \"\");\n    //dv.createPromptBox(\"\", \"\");\n    sheet.addValidationData(dv);</code></p>\n"},{"tags":["excel","vba","excel-2010","textcolor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13142560,"title":"vba change text colour to a theme preset in excel 2010","body":"<p>I'm trying to set the text colour using vba in excel 2010 to a theme color so if the theme is changed the text colour changes to match it. (The colours that appear in the colour dropdown on the ribbon - the top row are the base colours and the columns beneath them are the different shades.)\nI'm using the following code:</p>\n\n<pre><code>Set s = Sheets(\"1\").Range(\"b1\")\n\nWith s.Font\n    .ThemeColor = xlThemeColorAccent4\n    .TintAndShade = -0.499984740745262\n    .Size = 22\nEnd With\n</code></pre>\n\n<p>This code sets the text to the correct colour accent but does not choose the 50% darker shade which I want. I generated this by recording a macro and copying the relevant bits of code. Why does it not apply the tint and shade?</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13158230,"title":"Excel:Handle exception for workbook.open","body":"<p>How to handle exception in \"C#\" for the errors like-></p>\n\n<pre><code>Code:\nWorkbooks.Open(folderPath,filename,Excel.XlPlatform.xlWindows,\"\",\"\"....)\n\n\"System.Runtime.InteropServices.COMException (0x80070BBC): Office has detected a problem with this file. To help protect your computer this file cannot be opened.\nat Excel.Workbooks.Open\"\n</code></pre>\n\n<p>Few excels work without error,but few throw above error.\nPlease suggest some answers.\nThanks.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13157363,"title":"Create excel ranges using column numbers in vba?","body":"<p>How is it possible to create a range in vba using the column number, rather than letter?</p>\n"},{"tags":["excel","ssas","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12495529,"title":"Moving date period filter in Excel 2010 pivot-table","body":"<p>Is it possible to set some kind of filter for a moving date period?</p>\n\n<p>For example one of the DB views I'm trying to replicate in my pivot-table has this filter : </p>\n\n<p>DATEDIFF(day, dateColumn, GETDATE()) &lt;= 90</p>\n\n<p>So basically I always want to display the last 90 days of whataver data there is in the cube table.\nIs this possible?</p>\n"},{"tags":["excel","cognos","cognos-8","cognos-bi","cognos-tm1"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13157398,"title":"How can I fix excel appearance in cognos ?","body":"<p>I make a report as pdf.It s fine. But when I export it to excel ,there are many sheets on excel . I do not wan to it.I want to 1 sheet.How can I fix this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","vba","combinations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13151975,"title":"VBA finding combinations after picking one and not placing back","body":"<p>My previous question was here: <a href=\"http://stackoverflow.com/questions/12957778/filtering-in-vba-after-finding-combinations\">Filtering in VBA after finding combinations</a>  . I would now like to try a little more detail.</p>\n\n<p>I now have a list of combinations like this:</p>\n\n<blockquote>\n  <p>A<br>\n  B<br>\n  AB<br>\n  C<br>\n  AC<br>\n  BC<br>\n  ABC<br>\n  D<br>\n  AD<br>\n  BD<br>\n  CD<br>\n  E<br>\n  AE<br>\n  BE<br>\n  CE</p>\n</blockquote>\n\n<p>What I would like a new macro to do is to take this information and find out how many options there are for selecting all letters. So for example Option 1 would result in:</p>\n\n<blockquote>\n  <p>A B C D E</p>\n  \n  <p>AC B D E</p>\n  \n  <p>Etc.......</p>\n</blockquote>\n\n<p>You select one box and you find out the possibilities that are required to have all boxes. This is another code that I have tried, however it does not work very well because long calculation time:</p>\n\n<pre><code>Public Text, Alpha, Beta, Temp_Result, Temp_Stack, Wgt, Hgt, Stack, Stack_Sum\nPublic Max_Wgt As Double, Max_Hgt As Double, Crt_Wgt, Crt_Hgt, Next_Row As Long, Next_Col As Long\nSub ListCombinations()\n    Dim Str_Len As Integer, Len_Text As Integer, TotalComb As Integer\n    Len_Text = Worksheets(\"Sheet1\").Range(\"A65536\").End(xlUp).Row - 1\n    Worksheets(\"Sheet2\").Range(\"A2:IJ65536\").Clear\n    Next_Row = 1\n    Next_Col = 1\n    Stack = 0\n    Max_Wgt = Worksheets(\"Limits\").Range(\"B1\")\n    Max_Hgt = Worksheets(\"Limits\").Range(\"B2\")\n\n    ReDim Alpha(1 To Len_Text)\n    For j = 1 To Len_Text\n            Alpha(j) = Worksheets(\"Sheet1\").Cells(j + 1, 1)\n    Next j\n\n    For i = 1 To Len_Text\n        Str_Len = i\n\n\n\n        ReDim Temp_Result(1 To Str_Len)\n\n\n\n        AddCombination Len_Text, Str_Len\n\n\n    Next i\n    Find_Stacks\nEnd Sub\n\n\nPrivate Sub AddCombination(Optional PopSize As Integer = 0, _\n                          Optional SetSize As Integer = 0, _\n                          Optional NextMember As Integer = 0, _\n                          Optional NextItem As Integer = 0)\n\nStatic iPopSize As Integer\nStatic iSetSize As Integer\nStatic SetMembers() As Integer\nDim i As Integer\n\nIf PopSize &lt;&gt; 0 Then\n    iPopSize = PopSize\n    iSetSize = SetSize\n    ReDim SetMembers(1 To iSetSize) As Integer\n    ReDim Crt_Wgt(1 To iSetSize) As Double\n    ReDim Crt_Hgt(1 To iSetSize) As Double\n    NextMember = 1\n    NextItem = 1\nEnd If\n\nFor i = NextItem To iPopSize\n    SetMembers(NextMember) = i\n    Crt_Wgt(NextMember) = Worksheets(\"Sheet1\").Cells(i + 1, 2)\n    Crt_Hgt(NextMember) = Worksheets(\"Sheet1\").Cells(i + 1, 3)\n    If NextMember &lt;&gt; iSetSize Then\n        AddCombination , , NextMember + 1, i + 1\n    Else\n        If (Application.WorksheetFunction.sum(Crt_Wgt) &gt; Max_Wgt) Or _\n            (Application.WorksheetFunction.sum(Crt_Hgt) &gt; Max_Hgt) Then\n\n        Else\n            If Stack = 0 Then\n                SavePermutation SetMembers(), iSetSize\n            Else\n                SaveStack SetMembers(), iSetSize\n            End If\n\n        End If\n    End If\nNext i\n\n\n\nEnd Sub 'AddCombination\n\nSub SavePermutation(Set_Member, Str_Len As Integer)\nFor i = 1 To Str_Len\n    Temp_Result(i) = Alpha(Set_Member(i))\nNext i\n\nIf Next_Row &gt; 65535 Then\n    Next_Row = 1\n    Next_Col = Next_Col + 4\nEnd If\n\nWorksheets(\"Sheet2\").Cells(Next_Row + 1, Next_Col) = Join(Temp_Result, \"\")  Worksheets(\"Sheet2\").Cells(Next_Row + 1, Next_Col + 1) = Application.WorksheetFunction.sum(Crt_Wgt)\nWorksheets(\"Sheet2\").Cells(Next_Row + 1, Next_Col + 2) = Application.WorksheetFunction.sum(Crt_Hgt)\nAction = Find_Number()\nNext_Row = Next_Row + 1\n\nEnd Sub\n\n\nFunction Find_Number()\n    Text = Worksheets(\"Sheet2\").Cells(Next_Row + 1, Next_Col)\n    Sum_Char = 0\n    For i = 1 To Len(Text)\n        iChar = Left(Text, 1)\n        Sum_Char = Sum_Char + Worksheets(\"Sheet1\").Cells(WorksheetFunction.Match(iChar, Worksheets(\"Sheet1\").Range(\"A:A\"), 0), 4)\n        Text = Right(Text, Len(Text) - 1)\n    Next i\n    Worksheets(\"Sheet2\").Cells(Next_Row + 1, Next_Col + 3) = Sum_Char\nEnd Function\n\nSub Find_Stacks()\nDim Len_Text As Integer, Str_Len As Integer\nStack_Sum = WorksheetFunction.sum(Worksheets(\"Sheet1\").Range(\"D:D\"))\nLen_Text = Worksheets(\"Sheet2\").Range(\"D65536\").End(xlUp).Row - 1\nStack = 1\nNext_Row = 1\nReDim Alpha(1 To Len_Text)\nReDim Beta(1 To Len_Text)\nFor j = 1 To Len_Text\n    Alpha(j) = Worksheets(\"Sheet2\").Cells(j + 1, 1)\n    Beta(j) = Worksheets(\"Sheet2\").Cells(j + 1, 4)\nNext j\nWorksheets(\"Sheet4\").Range(\"A1:B65536\").Clear\nFor i = 2 To Len_Text\n    Str_Len = i\n    ReDim Temp_Result(1 To Str_Len)\n    ReDim Temp_Stack(1 To Str_Len)\n    AddCombination Len_Text, Str_Len\nNext i\nEnd Sub\n\nSub SaveStack(Set_Member, Str_Len As Integer)\n    For i = 1 To Str_Len\n        Temp_Result(i) = Alpha(Set_Member(i))\n        Temp_Stack(i) = Beta(Set_Member(i))\n    Next i\n    If (Application.WorksheetFunction.sum(Temp_Stack) = Stack_Sum) Then\n        Crt_Text = Join(Temp_Result, \"\")\n        Len_Char = Len(Crt_Text)\n        For i = 1 To Len_Char\n            Crt_Char = InStr(2, Crt_Text, Left(Crt_Text, 1))\n            If (Crt_Char &gt; 1) Then\n                GoTo End_Loop\n            End If\n            Crt_Text = Right(Crt_Text, Len(Crt_Text) - 1)\n        Next i\n        Worksheets(\"Sheet4\").Cells(Next_Row + 1, 1) = Join(Temp_Result, \",\")\n        Next_Row = Next_Row + 1\n    End If\nEnd_Loop:\nEnd Sub\n</code></pre>\n\n<p>This code we have the boxes on sheet 1 with the height and weight, sheet 2 should provide all options, sheet 3 are the limits and sheet 4 are the final options. This one has a long execution time. I would like to reduce this, can anyone help me with this?</p>\n\n<p>If you require more information, give me shout!</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>This is the other code, is this prefered over the code above? It was the result from my previous question. I would just like to understand which would be better for me to use. To reduce my execution time and move towards my final result macro explained above, aligning all the options possible.</p>\n\n<pre><code>Function stackBox()\n    Dim ws As Worksheet\n    Dim width As Long\n    Dim height As Long\n    Dim numOfBox As Long\n    Dim optionsA() As Variant\n    Dim results() As Variant\n    Dim str As String\n    Dim outputArray As Variant\n    Dim i As Long, j As Long\n    Dim currentSymbol As String\n    '------------------------------------new part----------------------------------------------\n    Dim maxHeight As Double\n    Dim maxWeight As Double\n    Dim heightarray As Variant\n    Dim weightarray As Variant\n    Dim totalHeight As Double\n    Dim totalWeight As Double\n    '------------------------------------new part----------------------------------------------\n\n    Set ws = Worksheets(\"Sheet1\")\n    With ws\n        'clear last time's output\n        height = .Cells(.Rows.Count, 1).End(xlUp).row\n        If height &gt; 3 Then\n            .Range(.Cells(4, 1), .Cells(height, 1)).ClearContents\n        End If\n\n        numOfBox = .Cells(1, 1).Value\n        width = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        If width &lt; 2 Then\n            MsgBox \"Error: There's no item, please fill your item in Cell B1,C1,...\"\n            Exit Function\n        End If\n\n\n        '------------------------------------new part----------------------------------------------\n        maxHeight = .Cells(2, 1).Value\n        maxWeight = .Cells(3, 1).Value\n        ReDim heightarray(1 To 1, 1 To width - 1)\n        ReDim weightarray(1 To 1, 1 To width - 1)\n        heightarray = .Range(.Cells(2, 2), .Cells(2, width)).Value\n        weightarray = .Range(.Cells(3, 2), .Cells(3, width)).Value\n        '------------------------------------new part----------------------------------------------\n\n        ReDim optionsA(0 To width - 2)\n        For i = 0 To width - 2\n            optionsA(i) = .Cells(1, i + 2).Value\n        Next i\n\n        GenerateCombinations optionsA, results, numOfBox\n\n\n        ' copy the result to sheet only once\n        ReDim outputArray(1 To UBound(results, 1) - LBound(results, 1) + 1, 1 To 1)\n        Count = 0\n        For i = LBound(results, 1) To UBound(results, 1)\n            If Not IsEmpty(results(i)) Then\n                'rowNum = rowNum + 1\n                str = \"\"\n                totalHeight = 0#\n                totalWeight = 0#\n                For j = LBound(results(i), 1) To UBound(results(i), 1)\n                    currentSymbol = results(i)(j)\n\n                    str = str &amp; currentSymbol 'results(i)(j) is the SYMBOL e.g. A, B, C\n\n                    'look up box's height and weight , increment the totalHeight/totalWeight\n                    updateParam currentSymbol, optionsA, heightarray, weightarray, totalHeight, totalWeight\n\n                Next j\n                If totalHeight &lt; maxHeight And totalWeight &lt; maxWeight Then\n                    Count = Count + 1\n                    outputArray(Count, 1) = str\n                End If\n\n            '.Cells(rowNum, 1).Value = str\n            End If\n        Next i\n        .Range(.Cells(4, 1), .Cells(UBound(outputArray, 1) + 3, 1)).Value = outputArray\n    End With\n\nEnd Function\n\nSub updateParam(ByRef targetSymbol As String, ByRef symbolArray As Variant, ByRef heightarray As Variant, ByRef weightarray As Variant, ByRef totalHeight As Double, ByRef totalWeight As Double)\nDim i As Long\nDim index As Long\nindex = -1\nFor i = LBound(symbolArray, 1) To UBound(symbolArray, 1)\n    If targetSymbol = symbolArray(i) Then\n        index = i\n        Exit For\n    End If\nNext i\n\n\nIf index &lt;&gt; -1 Then\n    totalHeight = totalHeight + heightarray(1, index + 1)\n    totalWeight = totalWeight + weightarray(1, index + 1)\nEnd If\nEnd Sub\n\nSub GenerateCombinations(ByRef AllFields() As Variant, _\n                                             ByRef Result() As Variant, ByVal numOfBox As Long)\n\n  Dim InxResultCrnt As Integer\n  Dim InxField As Integer\n  Dim InxResult As Integer\n  Dim i As Integer\n  Dim NumFields As Integer\n  Dim Powers() As Integer\n  Dim ResultCrnt() As String\n\n  NumFields = UBound(AllFields) - LBound(AllFields) + 1\n\n  ReDim Result(0 To 2 ^ NumFields - 2)  ' one entry per combination\n  ReDim Powers(0 To NumFields - 1)          ' one entry per field name\n\n  ' Generate powers used for extracting bits from InxResult\n  For InxField = 0 To NumFields - 1\n    Powers(InxField) = 2 ^ InxField\n  Next\n\n For InxResult = 0 To 2 ^ NumFields - 2\n    ' Size ResultCrnt to the max number of fields per combination\n    ' Build this loop's combination in ResultCrnt\n\n    ReDim ResultCrnt(0 To NumFields - 1)\n    InxResultCrnt = -1\n    For InxField = 0 To NumFields - 1\n      If ((InxResult + 1) And Powers(InxField)) &lt;&gt; 0 Then\n        ' This field required in this combination\n        InxResultCrnt = InxResultCrnt + 1\n        ResultCrnt(InxResultCrnt) = AllFields(InxField)\n      End If\n    Next\n\n    If InxResultCrnt = 0 Then\n        Debug.Print \"testing\"\n    End If\n    'additional logic here\n    If InxResultCrnt &gt;= numOfBox Then\n        Result(InxResult) = Empty\n\n    Else\n         ' Discard unused trailing entries\n        ReDim Preserve ResultCrnt(0 To InxResultCrnt)\n        ' Store this loop's combination in return array\n        Result(InxResult) = ResultCrnt\n    End If\n\n  Next\n\nEnd Sub\n</code></pre>\n"},{"tags":["java","excel","upload"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":58,"score":0,"question_id":13156080,"title":"FileNotFound Exception while reading excel file","body":"<p>Scenario: I am trying to read an excel file using JExcel and dump the data into Oracle database. I ask the user to browse and select a file to read from their system and then I read the same and dump the data (without saving the physical file) into the Oracle database.</p>\n\n<pre><code>&lt;form id='uploadform'&gt;\n    &lt;table class='detailTable'&gt;\n    &lt;tr&gt;\n        &lt;td class='detailTableTD'&gt;Select File to Upload:&lt;/td&gt;\n        &lt;td class='detailTableTD'&gt;\n            &lt;input type='file' id='fileUpload'&gt;\n        &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td class='detailTableTD'&gt;&lt;/td&gt;\n        &lt;td class='detailTableTD'&gt;\n            &lt;button id='uploadBtn' onclick=\"upload();\"&gt;Upload&lt;/button&gt;\n            &lt;button id='backBtn'&gt;Back&lt;/button&gt;                                  \n        &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p><strong>Java:</strong></p>\n\n<pre><code>public int[][] readFromExcel(final String excelFilePath) throws ApplicationException {\n    String excelPath = excelFilePath.trim();\n    File inputWorkbook = new File(excelPath);\n    Workbook workbook;\n    MyObj drawBk;\n    List drBkLst = new ArrayList();\n    String tmpStr = \"\";\n    try {\n        workbook = Workbook.getWorkbook(inputWorkbook);\n        Sheet sheet = workbook.getSheet(0);\n        for (int j = 1; j &lt; sheet.getRows(); j++) {\n            drawBk = new MyObj();\n            for (int i = 0; i &lt; sheet.getColumns(); i++) {\n                Cell cell = sheet.getCell(i, j);\n                switch (i) {\n                case 0:\n                    drawBk.setSerialNumber(cell.getContents());\n                    break;\n                case 1:\n                    drawBk.setMediaNumber(cell.getContents());\n                    break;\n                case 2:\n                    tmpStr = cell.getContents();\n                    if (!(tmpStr.trim().equalsIgnoreCase(\"Y\") || tmpStr.trim().equalsIgnoreCase(\"N\")))\n                        continue;\n                    else\n                        drawBk.setMnProcessInd(tmpStr);\n                    drawBk.setSnProcessInd(tmpStr);\n                    break;\n                }\n            }\n            drawBk.setLastChangedUser(userId);\n            drBkLst.add(drawBk);\n        }\n    } catch (Exception readExcelEx) {}\nreturn insertExcelDataToDatabase(drBkLst);\n}\n</code></pre>\n\n<p>Here I capture the path and pass as a parameter to a Java method for processing the cells and create a ArrayList of Objects to be inserted into DB. All simple code here.\nIt all works fine when run from a local deployment but when I deploy the EAR to server I start getting FileNotFound Exception when I browse for a file and select a file.\nI feel its all due to some relative/absolute path issue but can't possibly debug and I need it fast. Any precise help help will be appreciated? </p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","vba","excel-vba","excel-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13155802,"title":"How to transfer (cut & paste) a picture from a worksheet to another","body":"<p>I have the picture temporarily placed and hidden in Sheet1. I chose this method because I prefer not to have the picture stored locally on my drive.</p>\n\n<p>Then, I have a modeless UserForm with a button that should transfer the picture from Sheet1 to whichever is the ActiveSheet at the moment. </p>\n\n<p>So far I have the following code to hide the picture prior to closing the workbook:\n('On Error' is in there because, depending on the user, the picture will not always end-up in Sheet1)</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim tempWs As Variant\n    Call HidePic\nEnd Sub\n\nPrivate Sub HidePic()\n    Dim tempWs As Variant\n    On Error Resume Next\n    For Each tempWs In ThisWorkbook.Worksheets\n        tempWs.Pictures.Visible = False\n    Next\nEnd Sub\n</code></pre>\n\n<p>Next, the following code works but only in Sheet1 (where, in this case, the picture is stored). When I switch to another sheet and then hit the button on the UserForm; whatever data stored in \"A1\" is removed but no picture is placed/pasted.</p>\n\n<pre><code>Private Sub Pic_Click()\n    Dim tempWs As Variant\n    On Error Resume Next\n    For Each tempWs In ThisWorkbook.Worksheets\n        tempWs.Pictures.Visible = True\n        tempWs.Pictures.Select\n    Next\n\n    Selection.Cut\n    ActiveSheet.Range(\"A1\").Activate\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>Additional info: I used \"Select/Selection.Cut\" instead of the shorter(and faster?) \".Cut\" only since, for some reason using Cut only doesn't place the picture in \"A1\"</p>\n"},{"tags":["excel","vba","excel-2007","ribbon","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13125751,"title":"VBA code to add a basic ribbon in Excel 2010?","body":"<p>I have used products to write ribbons for Excel in C# (addin express) but I need to know how to produce a ribbon using vba. Would someone be able to provide me with some code that inserts an additional ribbon into the toolbar for this?</p>\n\n<p>By ribbon I mean where it says \"Formulas\", \"Data\", \"Review\" etc</p>\n"},{"tags":["excel","vba","conditional-formatting"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13154322,"title":"Excel conditional formatting - Top 10 and Bottom 10 values in dynamic range","body":"<p>I want to apply conditional formatting to a dynamic range in my Excel workbook.\nTop 10 values of the dynamic range to be highlighted in 'Green' color, and\nBottom 10 values of the dynamic range to be highlighted in 'Red' color.</p>\n\n<p>Please need help.</p>\n"},{"tags":["c#",".net","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":618,"score":1,"question_id":2757298,"title":"format excel sheet in c#","body":"<p>i want to format excel sheet generating by my c# application, as per template excel / source excel sheet which is.</p>\n"},{"tags":["php","mysql","excel","phpexcel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":13150831,"title":"PHPExcel generate data to array from defined sheet","body":"<p>I want to generate an array from my xlsx file first, before I insert it to Mysql, so I am using phpexcel because this one is good enough (I know it from every website's review). But there is a problem when I am trying to making an array from the xlsx defined sheet, here is my script :</p>\n\n<pre><code>&lt;?php\n\nerror_reporting(E_ALL);\nset_time_limit(0);\n\ndate_default_timezone_set('Europe/London');\n\n?&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /&gt;\n\n&lt;title&gt;Automatic Importer&lt;/title&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;h1&gt;PHPExcel Reader Example #07&lt;/h1&gt;\n&lt;h2&gt;Simple File Reader Loading a Single Named WorkSheet&lt;/h2&gt;\n&lt;?php\n\n/** PHPExcel_IOFactory */\ninclude 'Classes/PHPExcel/IOFactory.php';\n\n\n//$inputFileType = 'Excel5';\n    $inputFileType = 'Excel2007';\n//  $inputFileType = 'Excel2003XML';\n//  $inputFileType = 'OOCalc';\n//  $inputFileType = 'Gnumeric';\n$inputFileName = 'file.xlsx';\n$sheetname = 'My Sheet 4';\n\necho 'Loading file ',pathinfo($inputFileName,PATHINFO_BASENAME),' using IOFactory with a defined reader type of ',$inputFileType,'&lt;br /&gt;';\n$objReader = PHPExcel_IOFactory::createReader($inputFileType);\necho 'Loading Sheet \"',$sheetname,'\" only&lt;br /&gt;';\n$objReader-&gt;setLoadSheetsOnly($sheetname);\n$objPHPExcel = $objReader-&gt;load($inputFileName);\n\n\necho '&lt;hr /&gt;';\n\necho $objPHPExcel-&gt;getSheetCount(),' worksheet',(($objPHPExcel-&gt;getSheetCount() == 1) ? '' : 's'),' loaded&lt;br /&gt;&lt;br /&gt;';\n$loadedSheetNames = $objPHPExcel-&gt;getSheetNames();\n$sheetData = $objPHPExcel-&gt;getActiveSheet()-&gt;toArray(null,true,true,true);\nvar_dump($sheetData);\n\n\n?&gt;\n&lt;body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>and this is the error says :</p>\n\n<pre><code>Fatal error: Call to a member function cellExists() on a non-object in C:\\xampp\\htdocs\\chi\\import\\Classes\\PHPExcel\\Calculation.php on line 3241\n</code></pre>\n\n<p>Can someone tell where is the error is? My OOP is not good, thanks</p>\n"},{"tags":["excel","xslt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13139145,"title":"display xslt formatted data in excel","body":"<p>I have written a test code which reads data from a XML file (Data.xml) and uses a XSLT file (XSLTFile1.xslt) to filter out desired records and format it accordingly. This output is saved in another output.xml file. Upto this point it works fine. Now what I want is to display this output in excel sheet as it is. Till now I am able to dump this data as a whole into excel sheet but I want to specify some constraints:\n•   I want that if I have output  in red color the excel cell color should also be red.\n•   I want to specify a cell location like G12 or (12:7) where I want to show that data.</p>\n\n<pre><code>            DataSet dataSet = new DataSet();\n        dataSet.ReadXml(\"Data.xml\");\n\n        System.IO.FileStream fs = new System.IO.FileStream(\n            \"Customers.htm\", System.IO.FileMode.Create);\n\n        //Create an XmlTextWriter for the FileStream.\n        System.Xml.XmlTextWriter xtw = new System.Xml.XmlTextWriter(\n            fs, System.Text.Encoding.Unicode);\n\n        //Transform the XML using the stylesheet.\n        XmlDataDocument xmlDoc = new XmlDataDocument(dataSet);\n        System.Xml.Xsl.XslTransform xslTran = new System.Xml.Xsl.XslTransform();\n        xslTran.Load(\"XSLTFile1.xslt\");\n        xslTran.Transform(xmlDoc, null, xtw);\n\n        //Open the HTML file in Excel.\n        Microsoft.Office.Interop.Excel.Application oExcel = Globals.ThisAddIn.Application;\n        oExcel.Visible = true;\n        oExcel.UserControl = true;\n        Workbooks oBooks = oExcel.Workbooks;\n        object oOpt = System.Reflection.Missing.Value;\n        oBooks.Open(\"customers.htm\", oOpt, oOpt, oOpt,\n            oOpt, oOpt, oOpt, oOpt, oOpt, oOpt, oOpt, oOpt,\n            oOpt, oOpt, oOpt);\n</code></pre>\n\n<p>The output file data:</p>\n"},{"tags":["c#",".net","excel","interop","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13141593,"title":"How to move data in sheet1 to sheet2 in excel","body":"<p>I am writing contents to an excel file through c#. I am having 4 columns and many rows in excel. When the application runs, I need to check if whether data is present in sheet1, then it should be moved to sheet2. If sheet2 also contains data, then it should be appended with sheet2 data. I am using interop dll for accessing excel. I have done with writing contents, but how I can move it programmatically? This is what I tried.</p>\n\n<pre><code>  Excel.Workbook xlwb;\n  Excel.Application excelApp = new Excel.Application();\n  Excel.Worksheet xlssheet1;\n  Excel.Worksheet xlssheet2; \n xlwb = excelApp.Workbooks.Open(myPath, objMissing, objMissing, objMissing, objMissing, objMissing, objMissing,\n                                    objMissing, objMissing, objMissing, objMissing, objMissing, objMissing, objMissing, objMissing);\n            int rowIndex = 2; int colIndex = 1;\n            if (excelApp.Cells[rowIndex, colIndex] != null)\n            {\n                xlssheet1 = (Worksheet)xlwb.Worksheets[1];\n                xlssheet2 = (Worksheet)xlwb.Worksheets[2];\n\n                xlwb.Sheets.Move(System.Reflection.Missing.Value, xlssheet2);\n                xlwb.Save();                \n\n            }\n</code></pre>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13151462,"title":"Apache POI, creating new cells overrides the row style","body":"<p>I'm using Apache POI to export data to a .xlsx file and I want to style some of the rows and cells contained in the file.</p>\n\n<p>I'm using XSSF since the file is going to be read in Excel 2007+.</p>\n\n<p>Basically, my problem is that I'm trying to set a row style like in the following example, which sets a black foreground color for the entire row at index 0. It works fine, but whenever I create a new cell, the newly created cell has no style, as if it's overriding the row style I specified.</p>\n\n<p>Here's a code snippet to demonstrate what I'm doing:</p>\n\n<pre><code>XSSFWorkbook wb = new XSSFWorkbook();\nXSSFSheet sheet = wb.createSheet(\"mySheet\");\nXSSFRow row = sheet.createRow(0);\n\nXSSFCellStyle myStyle = wb.createCellStyle();           \n\nmyStyle.setFillForegroundColor(new XSSFColor(new Color(255, 255, 255)));\nmyStyle.setFillPattern(CellStyle.SOLID_FOREGROUND);\n\nrow.setRowStyle(myStyle); //This works, the whole row is now black\n\nrow.createCell(0); // This cell doesn't have a style, the rest of the line stays stylized\nrow.getCell(0).setCellValue(\"Test\");\n</code></pre>\n\n<p>I also tried *row.createCell(0, Cell.CELL_TYPE_STRING);*, but it didn't change anything.</p>\n\n<p>What is the correct way of accomplishing what I want to do? I wanted to do it this way so I didn't have to set each cell's style after creating it since all cells on the same row have the same style.</p>\n"},{"tags":["excel","count"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13151320,"title":"MS Excel: Count occurrences of values","body":"<p>I have a column of text values with repeated values. I want to create a new column of unique values (no repeats) and a column with the frequency of each of those values.</p>\n\n<p>What's the easiest way to do that? Efficiency isn't much of a concern as it's under 10,000 rows. </p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13059343,"title":"Excel formula how to concatenate string for external reference","body":"<p>Say I have the following formula in a cell that reads the value of a cell from another work book</p>\n\n<pre><code>='c:\\temp\\[external book.xlsx]SheetX'!$E$4\n</code></pre>\n\n<p>and I want the value of <code>c:\\temp\\[external book.xlsx]SheetX</code> to come from another cell in this sheet. How would I rewrite this formula to concatenate this value and <code>\"!$E$4\"</code></p>\n\n<p>Lets say the cell <code>A1</code> contains <code>c:\\temp\\[external book.xlsx]SheetX</code></p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13066966,"title":"How to bold highlight duplicate rows excel vba","body":"<p>I have the following code which picks up duplicate rows, however I can not get the code to  highlight the duplicates in bold as well as deleting them at the same time. </p>\n\n<pre><code>Public Sub ProcessData()\nConst TEST_COLUMN As String = \"A\" '&lt;=== change to suit\nDim i As Long\nDim iLastRow As Long\nDim rng As Range\n\nWith ActiveSheet\n\n    iLastRow = .Cells(.Rows.Count, TEST_COLUMN).End(xlUp).Row\n    For i = 1 To iLastRow\n        If .Evaluate(\"SUMPRODUCT(--(A\" &amp; i &amp; \":A\" &amp; iLastRow &amp; \"=A\" &amp; i &amp; \"),\" &amp; _\n    \"--(D\" &amp; i &amp; \":D\" &amp; iLastRow &amp; \"=D\" &amp; i &amp; \"),\" &amp; _\n    \"--(F\" &amp; i &amp; \":F\" &amp; iLastRow &amp; \"=F\" &amp; i &amp; \"),\" &amp; _\n    \"--(J\" &amp; i &amp; \":J\" &amp; iLastRow &amp; \"=J\" &amp; i &amp; \"),\" &amp; _\n        \"--(K\" &amp; i &amp; \":K\" &amp; iLastRow &amp; \"=K\" &amp; i &amp; \"))\") &gt; 1 Then\n            If rng Is Nothing Then\n                Set rng = .Cells(i, \"A\").Resize(, 11)\n            Else\n                Set rng = Union(rng, .Cells(i, \"A\").Resize(, 11))\n            End If\n        End If\n    Next i\n\n    **If Not rng Is Nothing Then rng.Delete.font.bold = true**\n\n\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>the example of the dataset and desired output can be seen in the following downloadable link below:</p>\n\n<p><a href=\"https://www.dropbox.com/s/7rhktg6b4nk6ig0/Bold_highlight_Duplicate%20.xlsm\" rel=\"nofollow\">https://www.dropbox.com/s/7rhktg6b4nk6ig0/Bold_highlight_Duplicate%20.xlsm</a></p>\n\n<p>any help would be very much appreciated.  Thank you. </p>\n\n<p><em>Edit:</em></p>\n\n<p>to clarify, this is how it should look like, just that input shall be deleted and the bold highlighting should appear in the output section:</p>\n\n<p><img src=\"http://i.stack.imgur.com/qfWSG.png\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","vba","excel-vba","compare","rows"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":832,"score":0,"question_id":11753724,"title":"Excel vba, compare rows of two workbooks and replace","body":"<p>Here is a bit of background on what I'm trying to achieve. </p>\n\n<p>I have an excel file, which contains 10 sheets and each of the sheets contain many rows of data. This workbook is sent to different people and each one fills in their respective info,only in columns A,B. I have made a vba script which loops through all the filled in workbooks, and checks which rows have cells <code>Ax</code>, <code>Bx</code> filled. Then it copies those in a new workbook. </p>\n\n<p>So what I have right now is:</p>\n\n<ol>\n<li>A workbook which contains only the rows of which the columns A,B have been filled.</li>\n<li>A workbook which contains all unfilled rows. (the initial one)</li>\n</ol>\n\n<p>What I want to do now is check row by row, and find e.g. Row 1 of sheet1 of workbook <strong>A</strong>, minus columns A,B, in workbook's <strong>B</strong> sheet 1. After the row is found I need to replace workbook's <strong>B</strong> row with the one from workbook <strong>A</strong>.</p>\n\n<p>So in the end I will be left with one master workbook (previously workbook <strong>B</strong>) that will contain both filled and unfilled rows. </p>\n\n<p>I hope I didn't make this too complicated. Any insight on what is the best way to achieve this would be appreciated.</p>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13141639,"title":"Transposing CopyFromRecordset Excel VBA","body":"<p>I have the following code in my Excel VBA that copies data from a table in SQL into Excel.  This data is being inserted horizontally starting on cell C2 but I want it to be inserted vertically on column C.</p>\n\n<pre><code>Sheets(\"Control\").Range(\"C2\").CopyFromRecorset rsPubs\n</code></pre>\n\n<p>where rsPubs is my ADO connection.</p>\n\n<p>Basically, I just want this data transposed.  What's an efficient way of doing this? Any help will be appreciated!</p>\n\n<p><em>Edit:</em></p>\n\n<p>This is how rsPubs is created (the connection works fine as I'm actually getting the data):</p>\n\n<pre><code>' Create a recordset object.\nDim rsPubs As ADODB.Recordset\nSet rsPubs = New ADODB.Recordset\n\nWith rsPubs\n    ' Assign the Connection object.\n    .ActiveConnection = cnPubs\n    ' Extract the required records.\n    .Open \"SELECT * FROM Analytics.dbo.XBodoffFinalAllocation\"\n    ' Copy the records into cell B3 on Sheet1.\n    Sheets(\"Control\").Range(\"C2\").CopyFromRecordset rsPubs\n    ' Tidy up\n    .Close\nEnd With\n\ncnPubs.Close\nSet rsPubs = Nothing\nSet cnPubs = Nothing\n</code></pre>\n"},{"tags":["string","excel","vba","replace","character"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13150231,"title":"Excel VBA - Delete Single Character from Cell without losing formatting of remainder of cell contents","body":"<p>I am trying to delete the first occurrence of \"&lt;\" and \">\" in a cell without losing formatting of the remainder of the cell's contents.</p>\n\n<p>I have looked in several places here, and other, to no avail.</p>\n\n<p>This is what I am trying to do:</p>\n\n<p>Say \"A1\" contains the text:</p>\n\n<pre><code>\"This is &lt;a&gt; long string with several &lt;occurrences&gt; of a &lt;special&gt; character.\"\n</code></pre>\n\n<p>In any case, What I am trying to do is remove the \">\", and in a perfect world the \"&lt;\", from the first word which contains them while maintaining the bold formatting as well as the \"&lt;\" and \">\" on the next word containing them.</p>\n\n<p>This is ONLY other code executing prior to the code I am having issues with.</p>\n\n<pre><code>inTx = Range(\"A2\").Value\noutTx = Replace(inTx, \"Init_Day\", Range(\"A3\").Value)\nRange(\"A2\").Value = outTx\n</code></pre>\n\n<p>Which replaces the <code>&lt;placeholder&gt;</code> text with the actual text, a two digit number in this case.</p>\n\n<p>Here is the code that is not working for me:</p>\n\n<pre><code>SearchString = Range(\"A2\").Value\nChar1 = \"&lt;\"\nChar2 = \"&gt;\"\nFor i = 1 To Len(SearchString)\n    If Mid(SearchString, i, 1) = Char1 Then\n        startPos = i\n        Exit For\n    End If\nNext i\nFor i = 1 To Len(SearchString)\n    If Mid(SearchString, i, 1) = Char2 Then\n        endPos = i\n        Exit For\n    End If\nNext i\nRange(\"A2\").Characters(startPos, endPos - startPos).Font.Bold = True\nRange(\"A2\").Characters(startPos - 1, 1).Delete\n</code></pre>\n\n<p>All code works fine until I reach the last line:</p>\n\n<pre><code>Range(\"A2\").Characters(startPos - 1, 1).Delete\n</code></pre>\n\n<p>then nothing happens.</p>\n\n<p>I've even tried:</p>\n\n<pre><code>Range(\"A2\").Characters(startPos - 1, 20).Delete\n</code></pre>\n\n<p>Still nothing...</p>\n\n<p>I know this should be easy but I can't seem to figure it out.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["excel","applescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13004596,"title":"How to change a series name after creating the chart in excel using apple script.","body":"<p>My next question is how to change the series name in this way.   </p>\n\n<p>1)   </p>\n\n<pre><code> tell application \"Microsoft Excel\"\n         tell worksheet \"Sheet1\" of active workbook\n            set obj to make new chart object at end with properties {name:\"chart1\",left position:20,   top:88,width:33, height:90}\n            set ochart to chart of obj\n            tell ochart\n                set chart type to column clustered\n                set newSeries to make new series at end with properties {series values:\"=Sheet1!$B$7:$B$10\", xvalues:\"=Sheet1!$B$7:$B$10\",name:\"tempSeriesName\"}\n           end tell\n         end tell\n      end tell \n</code></pre>\n\n<p>2)   </p>\n\n<pre><code>tell the chart of sheet \"chart1\"     \n             tell series1       \n                 set name to \"chartseries1\"                       \n            end tell                 \n     end tell  \n</code></pre>\n\n<p>In this scripts, first script is run successfully but second script is not change the name of first series. \nPlease reply I am waiting your replay.</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13089581,"title":"Reading Excel ROW using OleDb data retrieval","body":"<p>Any help what I am doing wrong here? if I am trying to read the only row for an example TestCaseName to <code>case_1</code> then i'm getting the data of different row.</p>\n\n<p>How can I make sure its only read what is being requested to read? and I am using the where clause but seems like does not filter it.</p>\n\n<pre><code>string connectionString = String.Format(@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=\"\"Excel 8.0;HDR=YES;IMEX=1;\"\"\", EXCELFILENAME);\n\nstring testCaseName = \"case_1\nstring query = String.Format(\"SELECT * from [{0}$] WHERE TestCaseName=\\\"{1}\\\"\", workbookName, testCaseName);\n\nOleDbDataAdapter dataAdapter = new OleDbDataAdapter(query, connectionString);\n\nDataSet dataSet = new DataSet();\ndataAdapter.Fill(dataSet);  \nDataTable myTable = dataSet.Tables[0]; \n\nTestCaseName       Name    Active   Status  etc...\n----------------------------------------------------------------\ncase_1             Tom     yes      Completed   etc...\n----------------------------------------------------------------\ncase_2             John    yes                  etc...\n----------------------------------------------------------------\ncase_3             Jim     yes                  etc...\n----------------------------------------------------------------\ncase_4             Don     yes                  etc...\n----------------------------------------------------------------\ncase_5             Sam     yes      Visitor     etc...\n----------------------------------------------------------------\n</code></pre>\n"},{"tags":["excel","vba","vlookup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13145011,"title":"Excel, VBA Vlookup, multiple returns into rows","body":"<p>Very new to VBA, so please excuse my ignorance. </p>\n\n<p>How would you alter the code below to return the result into rows as opposed to a string? </p>\n\n<p>Thanks in advance.... </p>\n\n<p>data</p>\n\n<pre><code>Acct No   CropType\n-------   ---------\n0001      Grain\n0001      OilSeed\n0001      Hay\n0002      Grain\n</code></pre>\n\n<p>function</p>\n\n<pre><code>=vlookupall(\"0001\", A:A, 1, \" \")\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>Function VLookupAll(ByVal lookup_value As String, _\n                   ByVal lookup_column As range, _\n                   ByVal return_value_column As Long, _\n                   Optional seperator As String = \", \") As String\n\nApplication.ScreenUpdating = False\nDim i As Long\nDim result As String\n\nFor i = 1 To lookup_column.Rows.count\n   If Len(lookup_column(i, 1).text) &lt;&gt; 0 Then\n        If lookup_column(i, 1).text = lookup_value Then\n            result = result &amp; (lookup_column(i).offset(0, return_value_column).text &amp;     seperator)\n       End If\n   End If\n Next\n\nIf Len(result) &lt;&gt; 0 Then\nresult = Left(result, Len(result) - Len(seperator))\nEnd If\n\nVLookupAll = result\nApplication.ScreenUpdating = True\n\n End FunctionNotes:\n</code></pre>\n"},{"tags":["excel","excel-vba","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13147964,"title":"Excel function that returns formula choice","body":"<p>I am trying to write an Excel VBA function that will return one of two input parameters as the formula for the cell it is input in based on a global setting somewhere else in the sheet.  IE, somewhere else in the sheet someone sets A or B, then formulas that call the functon AorB will return A or B based on what the global setting is.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Function AOrB(A As Variant, B As Variant) As Variant\n    If someSetting = A Then\n        AOrB.formula = A\n    ElseIf someSetting = B Then\n        AOrB.formula = B\n    End If\nEnd Function\n</code></pre>\n\n<p>I've scrounged pretty heavily but I just don't have the knowledge of what types to input and return in order to allow the function to return.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["excel","vba","excel-vba","userform"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13144937,"title":"Userform Listbox populate and clear depending on selection from another listbox","body":"<p>I have 2 listboxes, lbA and lbB. I am populating lbA using SQL script which works fine. Now what i would like to do is when i select an item from lbA, lbB gets populated again from a SQL script. It works when selecting only one item from lbA but selecting two or more or unseleting an item then it either adds repeated items or doesnt delete items from lbB. I am puzzled as to how to approach this. Can anyone please help?</p>\n\n<p>This is the code so far:</p>\n\n<pre><code>Private Sub lbA_Change() \n    Dim Num As Integer \n    Dim lngIndex As Long \n\n    If Me.lbA.ListIndex &lt;&gt; -1 Then \n        For lngIndex = 0 To lbA.ListCount - 1 \n            If lbA.Selected(lngIndex) Then \n\n\n                Dim cnPubs As ADODB.Connection \n                Set cnPubs = New ADODB.Connection \n                Dim strConn As String \n                strConn = \"PROVIDER=SQLOLEDB;\" \n                strConn = strConn &amp; \"DATA SOURCE=MSSQLSERVER2008;INITIAL CATALOG=MyDB;\" \n                strConn = strConn &amp; \" INTEGRATED SECURITY=sspi;\" \n                cnPubs.Open strConn \n                Dim rsPubs As ADODB.Recordset \n                Set rsPubs = New ADODB.Recordset \n                With rsPubs \n                    .ActiveConnection = cnPubs \n                    .Open \"My SQl Statement\" \n                End With \n                If rsPubs.EOF Or rsPubs.BOF Then \n                    Exit Sub \n                End If \n                rsPubs.MoveFirst \n                With Me.lbB \n                    .Clear \n                    Do \n                        .AddItem rsPubs![strName] \n                        rsPubs.MoveNext \n                    Loop Until rsPubs.EOF \n                End With \n                rsPubs.Close \n\n            End If \n        Next \n    End If \nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13141384,"title":"form view in excel for a record","body":"<p>I have a sheet in excel that is basically like a database (yes it has to be in excel unfortunately) and I want to design a simple form to display the records (the different column values in the rows). Usually MS is good with making widgets to do this but I cant seem to figure out how to write it in VBA (easily)</p>\n\n<p>Basically I have a list of Names and ID#'s then some other columns that need to be filled in (address, order # etc) but I'd like the user to do this via a form rather than typing in excel. I created a small form in VBA, but now I cant link the columns to the textboxes in the form. </p>\n\n<p>Anyone know of any code I can plug and play to do this. </p>\n\n<p>Specifically I am using a ComboBox (for the list of names) and then a for loop searching through it to find the selection and updating data. But its a real pain.</p>\n\n<p>plus I cant figure out how to put in a 'Next' button, which is really annoying me. Does anyone know how to change the comboBox value to the next row, if it is linked via RowSource</p>\n"},{"tags":["mysql","excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13145962,"title":"Changing variable with loop in VBA mysql query?","body":"<p>I created a loop in VBA that should change a variable (j) in the strSql portion of the code. My output columns on the excel sheet are all indentical. That means that the changing variable j is not taken into consideration in the strsql string. Does anybody know how to use a proper changing variable in this case? Thanks in advance</p>\n\n<p>Set rs = New ADODB.Recordset</p>\n\n<pre><code>     For j = 1 To 6\n\n\n    strSql = \"SELECT COUNT(*) FROM( \" &amp; _\n     \"SELECT COUNT(*) as nbp FROM `order`   \" &amp; _\n     \"JOIN user ON user.id = order.destination_id   \" &amp; _\n     \"AND DATEDIFF(date_added , register_date) &lt;= j\" &amp; _\n     \"GROUP BY destination_id)  c  \" &amp; _\n     \"GROUP BY nbp \" &amp; _\n     \"ORDER BY c.nbp ASC ; \"\n\n\n\n    rs.Open strSql, oConn, adOpenDynamic, adLockPessimistic\n\n    res = rs.GetRows\n\n    rs.Close\n\n    For i = 1 To 2\n    Cells(i, j) = res(0, i - 1)\n    Next i\n    Next j\n</code></pre>\n"},{"tags":["php","mysql","query","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":13146949,"title":"transpose using php after querying a database","body":"<p>I am using PHP to query a MYSQL database, and I am trying to output the data to an excel file.</p>\n\n<p>I have used phpexcel, csv, etc. With each i have successfully been able to output the data to an excel file, but I can't seem to transpose it in the excel (transpose- flip all columns into rows, and rows into columns)</p>\n\n<p>I can't find any tutorials to help me out.</p>\n\n<p>My question is, is there a way to use php to transpose those rows and columns from MYSQL and import them into an excel file?</p>\n\n<p>thanks!</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>exportMysqlToCsv($tablename,$tokenmain, $id);\nfunction exportMysqlToCsv($tablename,$tokenmain, $id, $filename = 'Results.csv'){\n    $sql_query = \"select * from $tablename where token=1\";\n\n  // Gets the data from the database\n   $result = mysql_query($sql_query);\n\n    $f = fopen('php://temp', 'wt');\n    $first = true;\n\n//trying to transpose the data \nfunction transpose($array) {\n    array_unshift($array, null);\n    return call_user_func_array('array_map', $array);}\n\n//inserting it into the excel file  \n  while ($row = mysql_fetch_assoc($result)) {\n\n        if ($first) {\n\n            fputcsv($f, array_keys($row));\n\n            $first = false;\n\n         }\n\n      fputcsv($f, $row);\n    }\n} //end while\n</code></pre>\n\n<p><strong>Database sample:</strong></p>\n\n<pre><code>=======================================\n|  Male/female  |    Favorite artist  |\n=====+========+===============+=======|\n|    F          | Britney Spears      |\n|-------------------------------------|\n</code></pre>\n\n<p><strong>What I want it to look like:</strong></p>\n\n<pre><code>=====================================\n|Question          |  Answer        |\n=====+========+===============+=====|\n|   Male/female    |   F            |\n|----+--------+---------------+-----|\n| Favorite artist  | Britney Spears |\n|----+--------+---------------+-----|\n</code></pre>\n\n<p><strong>HUGE NOTE:</strong> There is no changing the database/hardcoding out the array in php. I want it all dynamic and the database is going to stay the way it is </p>\n"},{"tags":["excel","search","adobe-reader"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":7675862,"title":"Efficient Way of Recording Page Numbers from a Search of a PDF","body":"<p>I have a list of ~1200 queries (part numbers) that are specified somewhere inside of a 100 page PDF.  Pretty much what I need to do is take record of what pages each of the queries appear on, in the PDF.  I can't think of a clever way of doing this.  It should take me 5-20 hours to do this search by search, so if someone can give me a good idea before the 5 hour mark that would be great!</p>\n"},{"tags":["excel","vba","excel-vba","pivot-table"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13146837,"title":"Sorting Excel PivotTable by value and date","body":"<p>I have a pivot table with 10 value fields and the date as a columnfield. Assuming that the dates are grouped by month, I can sort on the first value field for January:</p>\n\n<pre><code>ptTL.AutoSort xlDescending, strSort, ptTL.PivotColumnAxis.PivotLines(1)\n</code></pre>\n\n<p>If I want to sort based on February's figures, I need to change the pivotlines value to 11</p>\n\n<pre><code>ptTL.AutoSort xlDescending, strSort, ptTL.PivotColumnAxis.PivotLines(11)\n</code></pre>\n\n<p>and so on.</p>\n\n<p>However, this means the code is tied to the table structure and will need to be altered if any valuefields are added or removed,which is something I'd rather avoid.\nIs there anyway to replace the pivotlines parameter with the date and valuefield? Or use the latter to determine the former?</p>\n\n<p>Cheers,</p>\n\n<p>Michael</p>\n"},{"tags":["c#","excel","interop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13138099,"title":"Excel protect workbook with password but allow readonly","body":"<p>Using the interop classes in C# I was able to protect a workbook for reading and writing with a password. </p>\n\n<p><img src=\"http://i.stack.imgur.com/1pcfs.png\" alt=\"Password Dialog\"></p>\n\n<p>But I want users to be able to open the sheet as read-only.</p>\n\n<p><img src=\"http://i.stack.imgur.com/D8mY8.png\" alt=\"Read Only Dialog\"></p>\n\n<p>Is this possible without using the <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.saveas.aspx\" rel=\"nofollow\"><code>Workbook.SaveAs</code></a> method?</p>\n\n<p>Protecting a workbook with a password (picture 1) I'm using the <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.password.aspx\" rel=\"nofollow\"><code>Workbook.Password</code></a> property. </p>\n"},{"tags":["json","web-services","excel","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13146060,"title":"autoupdate Cell in Excel 2010 from JSON Webservice","body":"<p>I'm looking for a solution to automatically update a cell in my Excel Table via a JSON Webservice. I've found a way to do this via XML, but unfortunately no way to do this via JSON.</p>\n\n<p>The Webservice I want to use is: <a href=\"https://mtgox.com/api/1/BTCUSD/ticker\" rel=\"nofollow\">https://mtgox.com/api/1/BTCUSD/ticker</a></p>\n\n<p>And I would like to use the value of return.avg.value in my table.</p>\n\n<p>I even thought of using RegEx to get the value but I could't find a way to do so, also.</p>\n\n<p>I really hope there is a solution to my problem without using a lot of different Addons and Plugins for Excel, so my table remains portable.</p>\n\n<p>Thank you for your help,</p>\n\n<p>Frederick</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":31,"score":3,"question_id":13146252,"title":"C# userform in excel pending while user method running","body":"<p>I am a newbie to excel programing, I now have a problem with my excel add-ins code. My add-ins call out a Mainform. Whenever I  call my method from this form's button to do some tasks, such as searching huge data, the Mainform is frozen, it's inevitable. But when the method is running, assume it then will call a childform, this child form is also pending, I cannot do anything with it.</p>\n\n<p>My purpose is to call a child form to add in a progress bar and an Abort button to cancel the running method.</p>\n\n<p>How can I solve this?</p>\n\n<p>Thanks in advance for your help.\nvuhi</p>\n"},{"tags":["sql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1440,"score":1,"question_id":3295155,"title":"Excel 2003 send date parameters to SQL query","body":"<p>PROBLEM: I have a few worksheets that use sql queries to retrieve data. I would like all of these sheets to query data based on the same date range entered by a user in excel.</p>\n\n<p>eg. I would enter somewhere in a form or in a cell a date range and retrieve the value in sql to obtain data based on the user specified dates.</p>\n\n<p>Is there anyway to access values from forms or from cells in SQL (Query editor perhaps)?</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","excel","yii"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13081588,"title":"Yii : How to select a sheet from excel?","body":"<p>Q : How to select a sheet from excel?</p>\n\n<p>Status : I want the data from a xls/xlsx file. Now, I'm following via this <a href=\"http://hafiznor.wordpress.com/2011/07/04/yii-read-excel-file-xlsx-format/\" rel=\"nofollow\">website</a>. I've 3 sheets (G, H, I) at one excel file. I found getSheetByName() at PHPExcel class. When I tried by</p>\n\n<pre><code>$objWorksheet = $objPHPExcel-&gt;getSheetByName('I');\n</code></pre>\n\n<p>It give me an error</p>\n\n<blockquote>\n  <p>Fatal error: Call to a member function getHighestRow() on a non-object</p>\n</blockquote>\n\n<p>If I set 'G' ('G' is the first sheet at excel), it is working fine.</p>\n\n<p>Thank you for your any advice.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13145329,"title":"Excel (/ Google Spreadsheets) Don't change reference when cutting -other- cells","body":"<p>I have a spreadsheet cell <code>A1</code> with the formula <code>=SUM($P$1:$P$6)</code>.\nNow when I cut the cells <code>P1:P6</code> and paste them to, say, <code>C1:C6</code>, it changes the formula inside <code>A1</code> to <code>=SUM($C$1:$C$6)</code>.</p>\n\n<p>Any way to keep the original reference in <code>A1</code> when cutting other cells?</p>\n"},{"tags":["excel","lisp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":11194672,"title":"Lisp OLE Excel process doesn't get kill when I interactively close Excel","body":"<p>I am working on an application written in Lisp.  I am using Franz OLE to start the process.  It open excel fine, but when I close excel interactively, the process still there.  I am not sure how to kill the process when I close the excel window interactively.  Any suggestion?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","matlab"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13132041,"title":"Excel functions in matlab","body":"<p>What is the right procedure to execute any excel function either built in or user-defined from Matlab?</p>\n"},{"tags":["excel","vlookup"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2818,"score":1,"question_id":6754605,"title":"excel vlookup with multiple results","body":"<p>I am trying to use a vlookup or similar function to search a worksheet, match account numbers, then return a specified value. My problem is there are duplicate account numbers and I would like the result to concatenate the results into one string.</p>\n\n<pre><code>Acct No   CropType\n-------   ---------\n0001      Grain\n0001      OilSeed\n0001      Hay\n0002      Grain  \n</code></pre>\n\n<p>Is in the first worksheet, on the 2nd worksheet I have the Acct No with other information and I need to get all the matching results into one column on the 2nd worksheet ie. \"Grain Oilseed Hay\"</p>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks!</p>\n"},{"tags":["php","excel","compiler-errors","echo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13144530,"title":"creating excel sheet using php","body":"<p>im facing a problem at this particular line..</p>\n\n<pre><code>echo pack(\"ssssss\", 0×809, 0×8, 0×0, 0×10, 0×0, 0×0);\n</code></pre>\n\n<p>the error that's coming is..</p>\n\n<pre><code>Parse error: syntax error, unexpected T_STRING in C:\\wamp\\www\\amc\\excel.php on line 20\n</code></pre>\n\n<p>im not understanding why this is happening cause its the right syntax for echoing the pack function (i referred <a href=\"http://www.w3schools.com/php/func_misc_pack.asp\" rel=\"nofollow\">http://www.w3schools.com/php/func_misc_pack.asp</a>)</p>\n\n<p>could someone help me out here..\nPS: i got same error in next few lines where i used same piece of code of echoing pack with exactly same error when i tried commenting this line 20.</p>\n"},{"tags":["sql","database","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13143979,"title":"using excel 2007 to acess external sql database TO import>edit>export table","body":"<p>Is there a way or guide to connect to remote sql server were you can import>modify>export table in excel that uses the excel interface or something similar? Without having to log into the server directly. (multiple domains on one server I don't want them to access)<br></p>\n\n<p>using the sql button in the data tab lets you import and edit the file but only lets you export to a new table(go figure)<br>\n<a href=\"http://i47.tinypic.com/e6qgdj.jpg\" rel=\"nofollow\">http://i47.tinypic.com/e6qgdj.jpg</a><br></p>\n\n<p>using mysql workbench is way to confusing for the user<br>\n<a href=\"http://i45.tinypic.com/2z4fh1f.jpg\" rel=\"nofollow\">http://i45.tinypic.com/2z4fh1f.jpg</a><br></p>\n\n<p>I simply want the user to:<br>\n1. import the table into excel from external database.<br>\n2. edit database in excel.<br>\n3. export back into database overwriting old file.<br>\n<a href=\"http://i48.tinypic.com/2lm7zi1.jpg\" rel=\"nofollow\">http://i48.tinypic.com/2lm7zi1.jpg</a><br></p>\n\n<p>The only method I can't get to work is this one. Im assuming its the one I want too.<br>\n<a href=\"http://i49.tinypic.com/bdjw51.jpg\" rel=\"nofollow\">http://i49.tinypic.com/bdjw51.jpg</a><br></p>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1145,"score":1,"question_id":6808641,"title":"Find value in another table, return row index","body":"<p>I'm inexperienced in Excel functions and need some help with the following scenario:</p>\n\n<p>Table I has 2 columns:</p>\n\n<pre><code>X      Y \n3.2   result\n4.7   result\n1.2   result\n</code></pre>\n\n<p>Table II has these columns:</p>\n\n<pre><code>A    B    C    D\n1   1.2  0.0  2.3\n2   4.1  3.2  0.0\n3   0.0  4.7  0.0\n</code></pre>\n\n<p>I will try to illustrate what I want to do in C++/C#/Java programming syntax:</p>\n\n<p>In Y[1] I want to store:</p>\n\n<pre><code>foreach (int value in TableII)   //look for X[1] in Table 2\n   if( value == X[1] ){          //when you find it, \n      return A[value.rowNumber]; //return the corresponding value from A\n      //break;\n   }\n</code></pre>\n\n<p>In other words, I want to find X[1] in table II (it will always be there, and always just once), and return the corresponding value from column A[of the same index as the match].</p>\n\n<p>I've looked at HLOOKUP but there's more to it that just one command. Please help.</p>\n\n<hr>\n\n<h2>[EDIT]</h2>\n\n<p>I've tried this <code>=INDEX(Column1,IFERROR(MATCH(I2,Column2,0),IFERROR(MATCH(I2,Column3,0),IFERROR(MATCH(I2,Column4,0),IFERROR(MATCH(I2,Column5,0),IFERROR(MATCH(I2,Column6,0),IFERROR(MATCH(I2,Column7,0),IFERROR(MATCH(I2,Column8,0),MATCH(I2,Column9,0)))))))))</code></p>\n\n<p>But I get the \"more levels of nesting than are allowed in the current file format\" error. If I remove just one <code>IFERROR(MATCH(I2,Column8,0)</code>, then it works. But I need Columns 2 to 9, with Column1 holding the index.</p>\n\n<p>I thought Excel 2007 and 2010 do not have nesting limits any more. What gives?</p>\n\n<p>(For anyone new to Excel reading this, \"Column1\" etc. are made by selecting the column, right clicking on the selection, and \"Define Name\".)</p>\n\n<hr>\n\n<h2>[EDIT2]</h2>\n\n<p>So I \"solved\" my nesting problem by dividing the formula into 2 parts, with a <code>+</code>, having the ifs return 0 in case there's no match in either side. This way you either have <code>something + 0</code> or <code>0 + something</code>, so it works.</p>\n\n<p>Here's the formula I'm using right now:</p>\n\n<pre><code>    =INDEX(Column1, IFERROR(MATCH(I3,Column2,0),IFERROR(MATCH(I3,Column3,0),IFERROR(MATCH(I3,Column4,0),IFERROR(MATCH(I3,Column5,0),IFERROR(MATCH(I3,Column6,0),IFERROR(MATCH(I3,Column7,0),0))))))    \n                    +     \n                    IFERROR(MATCH(I3,Column8,0),IFERROR(MATCH(I3,Column9,0),0))\n          )\n</code></pre>\n\n<p>I've accepted Chris' answer, as he did most of the work, but I would still like to know if my workaround is good practice and if there isn't a shorter/better way to do this.</p>\n\n<p>Thank you.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13142947,"title":"Find and Replace data in a row and change all rows that have that data in the column","body":"<blockquote>\n  <p>I want to change data in row 'I' that has matching text in row 'D'\n  that in their corresponding column. </p>\n  \n  <p>I have not touched excel since basic programming in sophomore year of\n  high school. </p>\n  \n  <p>I can elaborate - thank you.</p>\n</blockquote>\n\n<p>EDIT:</p>\n\n<p>I have data filled in all columns of row 'D'.</p>\n\n<p>These items have a string of text that can be found in Find and Replace tool of Excel.</p>\n\n<p>When Excel Finds the text - I want to do one thing:</p>\n\n<p>Replace all row 'I' data to 'deleted' from 'active' </p>\n"},{"tags":["excel","array-formulas"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":41,"score":-2,"question_id":13142724,"title":"Excel FormulaArray returns wrong values","body":"<p>I found a bug.</p>\n\n<p>I wrote a small formula that verifies amount of goods in stock needed to fulfil the sales plan. It returns proper amount of goods if something is wrong with planned data. Not very effective (code is a bit raw) but works fine anyway.</p>\n\n<p>Then I create a FormulaArray in Excel [1 row x 12 columns]: select range -> press F2 -> enter formula with arguments (several ranges to check) -> it returns an array of [1 row x 12 columns] -> result displayed on a sheet.\nThen I drag FormulaArray down for about 1000 rows. There are several sheets like that.</p>\n\n<p><strong>Problem:</strong></p>\n\n<p>If amount of FormulaArrays comes over 5000-10000 or so (3-4 sheets) Excel starts showing wrong results. All values in a single FormulaArray comes the same (and that is wrong). I doublechecked the code - formula returns proper values up to the last row but Excel doesn't display values at all (some random value is taken for entire row).</p>\n\n<p><strong>Thing that works:</strong></p>\n\n<ul>\n<li>Re-enter FormulaArray: select FormulaArray range -> press F2 -> press Ctrl+Alt+Shift+F9\n(bad idea to re-enter all formulas in a book)</li>\n<li>dragging down re-entered array helps a bit </li>\n</ul>\n\n<p><strong>Things that are are not working:</strong></p>\n\n<ul>\n<li>changing manual &lt;-> automatic formula calculation</li>\n<li>Ctrl+Alt+Shift+F9 - recalculates all values in a book</li>\n<li>multi-threading and multi-processor computation disabled</li>\n</ul>\n\n<p><strong>Tested on versions</strong></p>\n\n<ul>\n<li>Excel 2007 Pro SP2</li>\n<li>Excel 2007 Enterprise SP2</li>\n<li>Excel 2010 Corporate SP(?)</li>\n</ul>\n\n<p>Has anybody encountered that bug? Is there any treatment? Are there any limitations on the number of FormulaArrays in a workbook/worksheet?</p>\n"},{"tags":["asp.net","asp.net-mvc","excel","object"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13143007,"title":"Convert object into excel file for MVC web app","body":"<p>Example, I have an item object with two properties</p>\n\n<pre><code>public class Item {\n   public string Name { get; set; }\n   public decimal Price { get; set; }\n}\n</code></pre>\n\n<p>Then...</p>\n\n<pre><code>Item item = new Item();\n</code></pre>\n\n<p>How can I pass this 'item' object to convert it into excel and save it to a target folder location.</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8328,"score":1,"question_id":11029531,"title":"VBA Copy and paste from one workbook to another","body":"<p>I feel like this should be easy but I cannot get it right.</p>\n\n<p>I have code in one workbook, this should open another workbook, copy and paste into the workbook with the code.</p>\n\n<p>I can select the data but can't paste it.</p>\n\n<p>I have tried many different variations of code getting errors or it doesn't do anything .  An example is below which is ran in template.xls which is where I want to paste the data.</p>\n\n<pre><code>Set dlsheet = appexcel.Workbooks.Open(strPath &amp; \"downloadedData.xls\")\n\nWith dlsheet.Sheets(\"Data\")\n\n    .range(\"A1:H3\").Select.copy\n    selection.copy\n\nEnd With\n</code></pre>\n\n<p>I don't know how to use the selection since this will copy from the template, I tried using a full stop before selection.</p>\n\n<p>I can copy the entire sheet from dlsheet into a new workbook, if someone could tell me how to copy it to the template and not a new workbook then this would also do the trick.</p>\n\n<pre><code>dlsheet.Sheets(\"Data\").Copy\n</code></pre>\n\n<p>Any help or advice would be gratefully appreciated.</p>\n"},{"tags":["python","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":843,"score":2,"question_id":2816530,"title":"Python and Excel - check if file is open","body":"<p>hey guys, I need help considering win32com in Python:\nI have a routine that opens a Workbook, creates a sheet and puts some data on it.\nIf everything runs fine the woorkbook is saved and closed - If not the python session is terminated but the woorkbook is left open. So the reference is lost. Now when restarting the code Excel prompts you with the msg \"workbook still open do you want to re-open?\".\nSo what I want is to suppress this msg. I found a solution that works for me when python terminates before writing to the sheet:</p>\n\n<pre><code>        open_copys = self.xlApp.Workbooks.Count\n        if  open_copys &gt; 0:\n            \"\"\" Check if any copy is the desired one\"\"\"\n            for i in range(0, open_copys):\n                if(self.xlApp.Workbooks[i].FullName == self.file_path):\n                    self.xlBook = self.xlApp.Workbooks[i]\n        else:\n            self.xlBook = self.xlApp.Workbooks.Open(self.file_path)\n</code></pre>\n\n<p>But if any changes were made on the EXCEL sheet this method is obsolet.\nAnyone got an ides how to get back a reference to an open and changed worksheet from a new python session?\nthx</p>\n"},{"tags":["excel","add-in","trust","oneclick"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13142482,"title":"Microsoft One-Click Installer - User Never Prompted for Trust","body":"<p>I wrote an Excel add-in for a client that does some custom things for 5 users.  I wrote it with VS2012 and the interop assemblies for Excel 2010.  I published the add-in with the MS one-click publisher, zipped up the contents, and sent it to these 5 users.  They are (seemingly) only able to install the add-in at random.  Some users have been successful, while others get an error message.  Some more info:</p>\n\n<ul>\n<li>The users that are not successfully installing are never being\nprompted to trust the install.  It takes them right to to the error\nmessage. </li>\n<li>I signed the code with just a local dev cert.  I didn't use a\nverisign certificate or anything like that.  I didn't figure that it would do anything, because their local file system is never allowing it to get to the prompt. </li>\n<li>First I made a batch file to <a href=\"http://msdn.microsoft.com/en-us/library/vstudio/bb772070.aspx\" rel=\"nofollow\">configure the registry for inclusion\nlist security</a>. This did nothing.</li>\n<li>I haven't been able to replicate the error on any other PC, whether\nit's on my local network or not.</li>\n</ul>\n\n<p>My guess is that they've got something in their security policy that prohibits access to these one-click installer files.  Any ideas which one? </p>\n\n<p>Here is the error message:</p>\n\n<pre><code>System.Security.SecurityException: Customized functionality in this application will not work because the certificate used to sign the deployment manifest for ThisAddin or its location is not trusted. Contact your administrator for further assistance.\nat Microsoft.VisualStudio.Tools.Applications.Deployment.ClickOnceAddInTrustEvaluator.VerifyTrustPromptKeyInternal(ClickOnceTrustPromptKeyValue promptKeyValue, DeploymentSignatureInformation signatureInformation, String productName)\nat Microsoft.VisualStudio.Tools.Applications.Deployment.ClickOnceAddInTrustEvaluator.VerifyTrustUsingPromptKey(Uri manifest, DeploymentSignatureInformation signatureInformation, String productName)\nat Microsoft.VisualStudio.Tools.Applications.Deployment.ClickOnceAddInDeploymentManager.VerifySecurity(ActivationContext context, Uri manifest, AddInInstallationStatus installState)\nat Microsoft.VisualStudio.Tools.Applications.Deployment.ClickOnceAddInDeploymentManager.InstallAddIn() The Zone of the assembly that failed was:MyComputer\n</code></pre>\n"},{"tags":["php","sql","database","query","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13142196,"title":"Export specific table columns to Excel","body":"<p>I'm trying to export specific column data (i.e., Ticket #, Company/Customer Name, Issue Subject, Date Closed) from my SQL DB table to Excel (.xls), I have the code written but it's exporting my entire Database table. (See code Below)</p>\n\n<p>Specific column data that needs to be exported:</p>\n\n<ul>\n<li>ticketID</li>\n<li>name</li>\n<li>company</li>\n<li>subject</li>\n<li>closed</li>\n</ul>\n\n<p>Also is there any way to add a function that only exports a specific range (i.e., Date range from October 1, 2012 to October 31, 2012)?</p>\n\n<p><pre></p>\n\n<code>&lt;?PHP\n\n//EDIT YOUR MySQL Connection Info:\n$DB_Server = \"localhost\";        //your MySQL Server\n$DB_Username = \"root\";                 //your MySQL User Name\n$DB_Password = \"\";                //your MySQL Password\n$DB_DBName = \"my_databse\";                //your MySQL Database Name\n$DB_TBLName = \"my_table\";                //your MySQL Table Name\n\n//$DB_TBLName,  $DB_DBName, may also be commented out &amp; passed to the browser\n//as parameters in a query string, so that this code may be easily reused for\n//any MySQL table or any MySQL database on your server\n\n//DEFINE SQL QUERY:\n//edit this to suit your needs\n$sql = \"Select * from $DB_TBLName\";\n\n//Optional: print out title to top of Excel or Word file with Timestamp\n//for when file was generated:\n//set $Use_Titel = 1 to generate title, 0 not to use title\n$Use_Title = 1;\n//define date for title: EDIT this to create the time-format you need\n$now_date = DATE('m-d-Y H:i');\n//define title for .doc or .xls file: EDIT this if you want\n$title = \"Dump For Table $DB_TBLName from Database $DB_DBName on $now_date\";\n/*\n\nLeave the connection info below as it is:\njust edit the above.\n\n(Editing of code past this point recommended only for advanced users.)\n*/\n//create MySQL connection\n$Connect = @MYSQL_CONNECT($DB_Server, $DB_Username, $DB_Password)\n     or DIE(\"Couldn't connect to MySQL:&lt;br&gt;\" . MYSQL_ERROR() . \"&lt;br&gt;\" . MYSQL_ERRNO());\n//select database\n$Db = @MYSQL_SELECT_DB($DB_DBName, $Connect)\n     or DIE(\"Couldn't select database:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n//execute query\n$result = @MYSQL_QUERY($sql,$Connect)\n     or DIE(\"Couldn't execute query:&lt;br&gt;\" . MYSQL_ERROR(). \"&lt;br&gt;\" . MYSQL_ERRNO());\n\n//if this parameter is included ($w=1), file returned will be in word format ('.doc')\n//if parameter is not included, file returned will be in excel format ('.xls')\nIF (ISSET($w) &amp;&amp; ($w==1))\n{\n     $file_type = \"msword\";\n     $file_ending = \"doc\";\n}ELSE {\n     $file_type = \"vnd.ms-excel\";\n     $file_ending = \"xls\";\n}\n//header info for browser: determines file type ('.doc' or '.xls')\nHEADER(\"Content-Type: application/$file_type\");\nHEADER(\"Content-Disposition: attachment; filename=MDT_DB_$now_date.$file_ending\");\nHEADER(\"Pragma: no-cache\");\nHEADER(\"Expires: 0\");\n\n/*    Start of Formatting for Word or Excel    */\n\nIF (ISSET($w) &amp;&amp; ($w==1)) //check for $w again\n{\n     /*    FORMATTING FOR WORD DOCUMENTS ('.doc')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\n\"; //new line character\n\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n         //define field names\n         $field_name = MYSQL_FIELD_NAME($result,$j);\n         //will show name of fields\n         $schema_insert .= \"$field_name:\\t\";\n             IF(!ISSET($row[$j])) {\n                 $schema_insert .= \"NULL\".$sep;\n                 }\n             ELSEIF ($row[$j] != \"\") {\n                 $schema_insert .= \"$row[$j]\".$sep;\n                 }\n             ELSE {\n                 $schema_insert .= \"\".$sep;\n                 }\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         //end of each mysql row\n         //creates line to separate data from each MySQL table row\n         PRINT \"\\n----------------------------------------------------\\n\";\n     }\n}ELSE{\n     /*    FORMATTING FOR EXCEL DOCUMENTS ('.xls')   */\n     //create title with timestamp:\n     IF ($Use_Title == 1)\n     {\n         ECHO(\"$title\\n\");\n     }\n     //define separator (defines columns in excel &amp; tabs in word)\n     $sep = \"\\t\"; //tabbed character\n\n     //start of printing column names as names of MySQL fields\n     FOR ($i = 0; $i &lt; MYSQL_NUM_FIELDS($result); $i++)\n     {\n         ECHO MYSQL_FIELD_NAME($result,$i) . \"\\t\";\n     }\n     PRINT(\"\\n\");\n     //end of printing column names\n\n     //start while loop to get data\n     WHILE($row = MYSQL_FETCH_ROW($result))\n     {\n         //set_time_limit(60); // HaRa\n         $schema_insert = \"\";\n         FOR($j=0; $j&lt;mysql_num_fields($result);$j++)\n         {\n             IF(!ISSET($row[$j]))\n                 $schema_insert .= \"NULL\".$sep;\n             ELSEIF ($row[$j] != \"\")\n                 $schema_insert .= \"$row[$j]\".$sep;\n             ELSE\n                 $schema_insert .= \"\".$sep;\n         }\n         $schema_insert = STR_REPLACE($sep.\"$\", \"\", $schema_insert);\n         //following fix suggested by Josue (thanks, Josue!)\n         //this corrects output in excel when table fields contain \\n or \\r\n         //these two characters are now replaced with a space\n         $schema_insert = PREG_REPLACE(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n         $schema_insert .= \"\\t\";\n         PRINT(TRIM($schema_insert));\n         PRINT \"\\n\";\n     }\n}\n\n?&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13141683,"title":"Inserting checkbox values from VBA form into Excel Spreadsheet","body":"<p>I am trying to insert a list of selected checkboxes into a spreadsheet, within this use case, a user can choose up to 15 items. This will be inserted into a certain cell which I have defined below.</p>\n\n<p>I have a checkbox with the following names/values:</p>\n\n<pre><code>Name         Value\n==========   =====\nchk_week1    1\nchk_week2    2\n...          ...\n...          ...\nchk_week15   15\n</code></pre>\n\n<p>For example if the user selects chk_week1, chk_week2, chk_week4 and chk_week5, then it should be inserted into the cell as 1,2,4,5.</p>\n\n<p>I've included an image how it looks like to better demonstrate it:</p>\n\n<p><img src=\"http://i.stack.imgur.com/oHKea.png\" alt=\"enter image description here\"></p>\n\n<p>Each checkbox has the name and value listed in the table above. Here is the code I am using so far:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\n\nDim ws As Worksheet\nDim rng1 As Range\nSet ws = Worksheets(\"main\")\n\n' Copy the data to the database\n' Get last empty cell in column A\nSet rng1 = ws.Cells(Rows.Count, \"a\").End(xlUp)\n\n' Having difficulty adding the code here\n' rng1.Offset(1, 7) = weeks\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thanks in advance.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13118032,"title":"Adding checkboxes from VBA form into Excel spreadsheet","body":"<p>I am trying to fill a range that is unknown in size, as a user can choose up to 15 items in the first set. This will be inserted into a certain row.</p>\n\n<p>I have a checkbox with the following names/values:</p>\n\n<pre><code>Name         Value\n==========   =====\nchk_week1    1\nchk_week2    2\n...          ...\n...          ...\nchk_week15   15\n</code></pre>\n\n<p>For example if the user selects <strong>chk_week1</strong>, <strong>chk_week2</strong>, <strong>chk_week4</strong> and <strong>chk_week5</strong>, then it should be inserted into the cell as 1,2,4,5.</p>\n\n<p>I've included an image how it looks like to better demonstrate it:</p>\n\n<p><img src=\"http://i.stack.imgur.com/sfYyK.png\" alt=\"enter image description here\"></p>\n\n<p>Each checkbox has the name and value listed in the table above. Here is the code I am using so far:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\n\nDim ws As Worksheet\nDim rng1 As Range\nSet ws = Worksheets(\"main\")\n\n' Copy the data to the database\n' Get last empty cell in column A\nSet rng1 = ws.Cells(Rows.Count, \"a\").End(xlUp)\n\ndeptCodeSplit = Split(cbo_deptCode.Value, \" \")\n\n' Having difficulty adding the code here\n' rng1.Offset(1, 6) = weeks\n\nEnd Sub\n</code></pre>\n"},{"tags":["java","jquery","excel","dialog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13132994,"title":"how to add openwith and save as dialogue box while exporting to .excel on button click","body":"<p>I am exporting data displayed in jqgrid into .excel file by clicking button .\nHere is my code for export to excel button click..</p>\n\n<pre><code> $('#excel').click(function(){\n            var fromdate=$('#fromdate').val();\n            var todate=$('#todate').val();\n            if(fromdate &amp;&amp; todate)\n            {\n                var URL='excel.jsp?fromdate='+$('#fromdate').val()+'&amp;todate='+$('#todate').val();\n                $.ajax({\n                   url:URL,\n                   type:'GET',\n                   success:function(data){\n                       alert('Exported To Excel');\n                   }\n\n                });\n            }\n        });\n</code></pre>\n\n<p>Now this button will direct to excel.jsp page .Below is my excel.jsp page code which is directly giving path to save the generated .excel file in local disk D://.Now Asper my need when the user click on export to excel button a openwith and save as dialogue box should popup which gives user ability to give desired name and save to desired position..</p>\n\n<p>excel.jsp</p>\n\n<pre><code>    String datum1 = request.getParameter(\"fromdate\");\n    String datum2 = request.getParameter(\"todate\");\n    SimpleDateFormat sdfSource = new SimpleDateFormat(\"dd-MM-yyyy\");\n    Date date = sdfSource.parse(datum1);\n    Date date2 = sdfSource.parse(datum2);\n    SimpleDateFormat sdfDestination = new SimpleDateFormat(\"yyyy-MM-dd\");\n    datum1 = sdfDestination.format(date);\n    System.out.println(datum1);\n    datum2 = sdfDestination.format(date2);\n    System.out.println(datum2);\n\n\n\n\n    String filename = \"d:/excel.xls\";\n    HSSFWorkbook hwb = new HSSFWorkbook();\n    HSSFSheet sheet = hwb.createSheet(\"CallBillingSystem\");\n\n    HSSFRow rowhead = sheet.createRow((short) 0);\n    rowhead.createCell((short) 0).setCellValue(\"calldate\");\n    rowhead.createCell((short) 1).setCellValue(\"src\");\n    rowhead.createCell((short) 2).setCellValue(\"dst\");\n    rowhead.createCell((short) 3).setCellValue(\"dstchannel\");\n    rowhead.createCell((short) 4).setCellValue(\"lastapp\");\n    rowhead.createCell((short) 5).setCellValue(\"duration\");\n    rowhead.createCell((short) 6).setCellValue(\"disposition\");\n    rowhead.createCell((short) 7).setCellValue(\"amaflags\");\n    rowhead.createCell((short) 8).setCellValue(\"cdrcost\");\n\n\n    String strQuery = \"\";\n    ResultSet rs = null;\n\n    conexion conexiondb = new conexion();\n    conexiondb.Conectar();\n\n    strQuery = \"SELECT * FROM cdrcost where date(calldate) between '\" + datum1 + \"' and '\" + datum2 + \"'\";\n\n\n\n    rs = conexiondb.Consulta(strQuery);\n    int i = 1;\n    while (rs.next()) {\n        HSSFRow row = sheet.createRow((short) i);\n        row.createCell((short) 0).setCellValue(rs.getString(\"calldate\"));\n        row.createCell((short) 1).setCellValue(rs.getString(\"src\"));\n        row.createCell((short) 2).setCellValue(rs.getString(\"dst\"));\n        row.createCell((short) 3).setCellValue(rs.getString(\"dstchannel\"));\n        row.createCell((short) 4).setCellValue(rs.getString(\"lastapp\"));\n        row.createCell((short) 5).setCellValue(rs.getString(\"duration\"));\n        row.createCell((short) 6).setCellValue(rs.getString(\"disposition\"));\n        row.createCell((short) 7).setCellValue(rs.getString(\"amaflags\"));\n        row.createCell((short) 8).setCellValue(rs.getString(\"cdrcost\"));\n        i++;\n    }\n    FileOutputStream fileOut = new FileOutputStream(filename);\n    hwb.write(fileOut);\n    fileOut.close();\n    System.out.println(\"Your excel file has been generated!\");\n\n} catch (Exception ex) {\n    System.out.println(ex);\n\n}\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13140533,"title":"Removing extra commas from string in Excel VBA","body":"<p>I would like to insert data from three different drop downs into my spreadsheet but I am having several difficulties. There are three drop downs called cbo_fac1, cbo_fac2 and cbo_fac3. </p>\n\n<hr>\n\n<p>Here are the use cases:</p>\n\n<p><strong>Use case 1</strong> - Results in <code>No preference</code> being inserted into spreadsheet</p>\n\n<pre><code>cbo_fac1 - No preference\ncbo_fac2 - No preference \ncbo_fac3 - No preference \n</code></pre>\n\n<p><strong>Use case 2a</strong> - Results in <code>value, ,</code> being inserted into spreadsheet. Should just be <code>value</code></p>\n\n<pre><code>cbo_fac1 - Value\ncbo_fac2 - No preference\ncbo_fac3 - No preference \n</code></pre>\n\n<p><strong>Use case 2b</strong> - Results in <code>, value,</code> being inserted into spreadsheet. Should just be <code>value</code></p>\n\n<pre><code>cbo_fac1 - No preference\ncbo_fac2 - Value\ncbo_fac3 - No preference\n</code></pre>\n\n<p><strong>Use case 2c</strong> - Results in <code>, , value</code> being inserted into spreadsheet. Should just be <code>value</code></p>\n\n<pre><code>cbo_fac1 - No preference \ncbo_fac2 - No preference \ncbo_fac3 - Value\n</code></pre>\n\n<p><strong>Use case 3a</strong> - Results in <code>value, value,</code> being inserted into spreadsheet. Should just be <code>value, value</code></p>\n\n<pre><code>cbo_fac1 - Value\ncbo_fac2 - Value \ncbo_fac3 - No preference\n</code></pre>\n\n<p><strong>Use case 3b</strong> - Results in <code>, value, value</code> being inserted into spreadsheet. Should just be <code>value, value</code></p>\n\n<pre><code>cbo_fac1 - No preference\ncbo_fac2 - Value \ncbo_fac3 - Value  \n</code></pre>\n\n<p><strong>Use case 3c</strong> - Results in <code>value, , value</code> being inserted into spreadsheet. Should just be <code>value, value</code></p>\n\n<pre><code>cbo_fac1 - Value\ncbo_fac2 - No preference\ncbo_fac3 - Value      \n</code></pre>\n\n<hr>\n\n<p>How do I remove the extra commas in <em>Use cases 2a-3c</em>? </p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>If Me.cbo_fac1 &lt;&gt; \"No preference\" Then\ncbo_fac1Entry = Me.cbo_fac1.Value\nElse\ncbo_fac1Entry = \"\"\nEnd If\n\nIf Me.cbo_fac2 &lt;&gt; \"No preference\" Then\ncbo_fac2Entry = Me.cbo_fac2.Value\nElse\ncbo_fac2Entry = \"\"\nEnd If\n\nIf Me.cbo_fac3 &lt;&gt; \"No preference\" Then\ncbo_fac3Entry = Me.cbo_fac3.Value\nElse\ncbo_fac3Entry = \"\"\nEnd If\n\ncbo_facEntry = cbo_fac1Entry &amp; \", \" &amp; cbo_fac2Entry &amp; \", \" &amp; cbo_fac3Entry\n\nIf cbo_facEntry = \" , ,\" Then\ncbo_facEntry = \"No preference\"\nElse\nEnd If\nrng1.Offset(1, 15) = cbo_facEntry\n</code></pre>\n\n<hr>\n\n<p>I've tried inserting this code:</p>\n\n<pre><code>if right(cbo_facEntry,1)=\",\" then\n   cbo_facEntry= left(len(cbo_facEntry)-1)\nend if\n\nif left(cbo_facEntry,1)=\",\" then\n   cbo_facEntry= right(len(cbo_facEntry)-1)\nend if\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>If cbo_facEntry = \",,\" Then\ncbo_facEntry = \"No Preference\"\nElse\nEnd If\n</code></pre>\n\n<p>But it doesn't make much difference, as it doesn't fulfil the requirements of all the use cases and also returns an invalid syntax error message.</p>\n\n<hr>\n\n<p>Thanks in advance!</p>\n"},{"tags":["javascript","excel","tree","xul","export-to-excel"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":101,"score":4,"question_id":13029017,"title":"Export to excel in xul","body":"<p>So I have my function in js and xul that is creating export file in ods or xlsx. Exporting in ods is working just fine, but the problem is when I try to export in excel file format. The plan was to create xml file content.xml that will be generated by treeToXLSX.xsl. Content.xml is generated and when i extract export.xlsx it is in there, but the xlsx is empty. These are my files</p>\n\n<p>TREE.JS</p>\n\n<pre><code>if(exportType == 'excel'){\n    xslFile = \"treeToXLSX.xsl\";\n    tempExportFile = \"export.xlsx.tmp\";\n    exportTemplate = \"template.xlsx\";\n    exportedFileName = \"export.xlsx\";\n}else{\n    xslFile = \"treeToODS.xsl\";\n    tempExportFile = \"export.ods.tmp\";\n    exportTemplate = \"template.ods\";\n    exportedFileName = \"export.ods\";\n}\n\nvar newdoc = this.prep(xslFile);\n\n// save newdoc as /tmp/content.xml\nvar foStream = Components.classes[\"@mozilla.org/network/file-output-stream;1\"]\n    .createInstance(Components.interfaces.nsIFileOutputStream);\n\nvar file = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n    .getService(Components.interfaces.nsIProperties)\n    .get(\"TmpD\", Components.interfaces.nsIFile);\nfile.append(\"content.xml\");\n\nvar file2 = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n    .getService(Components.interfaces.nsIProperties)\n    .get(\"TmpD\", Components.interfaces.nsIFile);\nfile2.append(tempExportFile);\nfile2.createUnique(Components.interfaces.nsIFile.NORMAL_FILE_TYPE, 0666);\nfile2.remove(false);\n\nvar serializer = new XMLSerializer();\n\n// use 0x02 | 0x10 to open file for appending.\nfoStream.init(file, 0x02 | 0x08 | 0x20, -1, 0); // write,\n                                                    // create,\n                                                    // truncate\n// In a c file operation, we have no need to set file mode with or\n// operation, directly using \"r\" or \"w\" usually.\nserializer.serializeToStream(newdoc, foStream, \"UTF-8\");\nfoStream.close();\n\nvar template = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n    .getService(Components.interfaces.nsIProperties)\n    .get(\"AChrom\", Components.interfaces.nsIFile);\n\ntemplate.append(\"&lt;path&gt;\");\ntemplate.append(\"&lt;to_file&gt;\");\ntemplate.append(exportTemplate);\n\n// copy export.ods template file into temp, BLOCKING OPERATION\ntemplate.copyTo(file2.parent, file2.leafName);\n\nvar zipWriter = Components.Constructor(\"@mozilla.org/zipwriter;1\", \"nsIZipWriter\");\nvar zipW = new zipWriter();\n\nzipW.open(file2, 0x04);\nzipW.addEntryFile(file.leafName, Components.interfaces.nsIZipWriter.COMPRESSION_DEFAULT, file, false);\nzipW.close();\n\nvar homedir = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n    .getService(Components.interfaces.nsIProperties)\n    .get(\"Home\", Components.interfaces.nsIFile);\n\n// open a save as dialog box\nvar fp = Components.classes[\"@mozilla.org/filepicker;1\"]\n    .createInstance(Components.interfaces.nsIFilePicker);\n\nfp.init(window, \"Export as\", Components.interfaces.nsIFilePicker.modeSave);\nfp.appendFilters(Components.interfaces.nsIFilePicker.filterAll | Components.interfaces.nsIFilePicker.filterText);\nfp.displayDirectory = homedir;\nfp.defaultString = exportedFileName;\n\nvar rv = fp.show();\n\nif (rv == Components.interfaces.nsIFilePicker.returnOK || rv == Components.interfaces.nsIFilePicker.returnReplace) {\n    file2.moveTo(fp.file.parent, fp.file.leafName);\n} else {\n    file2.remove(false);\n}\n</code></pre>\n\n<p>TREETOXLSX.XSL</p>\n\n<pre><code>&lt;?xml version='1.0'?&gt;\n\n&lt;?mso-application progid=\"Excel.Sheet\"?&gt;  \n&lt;xsl:stylesheet\n  version=\"1.0\"\n  xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"\n  xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n  xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"\n  xmlns:user=\"urn:my-scripts\"\n  xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n  xmlns:x=\"urn:schemas-microsoft-com:office:excel\"\n  xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"&gt;\n\n&lt;xsl:output method=\"xml\" encoding=\"utf-8\" indent=\"yes\" /&gt;\n  &lt;xsl:param name=\"title\" /&gt;\n  &lt;xsl:param name=\"skipfields\" /&gt;\n  &lt;xsl:param name=\"decimals\" /&gt;\n  &lt;xsl:param name=\"numerics\" /&gt;\n\n   &lt;xsl:template match=\"*\"&gt;\n     &lt;Workbook&gt;\n    &lt;Worksheet ss:Name=\"Test\"&gt; \n      &lt;Table x:FullColumns=\"1\" x:FullRows=\"1\"&gt;\n        &lt;Row ss:Height=\"12.1032\"&gt;\n        &lt;xsl:for-each select=\"child::*[1]/@*\"&gt;\n          &lt;xsl:if test=\"not(contains($skipfields, concat('|', name(), '|')))\"&gt;\n             &lt;Cell&gt;\n            &lt;Data ss:Type=\"String\"&gt;\n              &lt;xsl:value-of select=\"translate(name(), '_', '')\"/&gt;\n            &lt;/Data&gt;\n             &lt;/Cell&gt;\n              &lt;/xsl:if&gt;\n        &lt;/xsl:for-each&gt;\n         &lt;/Row&gt;\n         &lt;xsl:for-each select=\"./*\"&gt;\n           &lt;Row&gt;\n          &lt;xsl:for-each select=\"@*\"&gt;\n            &lt;xsl:if test=\"not(contains($skipfields, concat('|', name(), '|')))\"&gt;\n              &lt;xsl:choose&gt;\n            &lt;xsl:when test=\"contains($decimals, concat('|', name(), '|'))\"&gt;\n              &lt;Cell&gt;\n                &lt;Data ss:Type=\"Number\"&gt;\n                  &lt;xsl:value-of select=\".\" /&gt;\n                &lt;/Data&gt;\n              &lt;/Cell&gt;\n            &lt;/xsl:when&gt;\n            &lt;xsl:when test=\"contains($numerics, concat('|', name(), '|'))\"&gt;\n            &lt;Cell&gt;\n               &lt;Data ss:Type=\"Number\"&gt;\n                 &lt;xsl:value-of select=\".\" /&gt;\n               &lt;/Data&gt;\n            &lt;/Cell&gt;\n             &lt;/xsl:when&gt;\n             &lt;xsl:otherwise&gt;\n            &lt;Cell&gt;\n               &lt;Data ss:Type=\"String\"&gt;\n                  &lt;xsl:value-of select=\".\" /&gt;\n               &lt;/Data&gt;\n            &lt;/Cell&gt;\n            &lt;/xsl:otherwise&gt;\n         &lt;/xsl:choose&gt;\n          &lt;/xsl:if&gt;\n        &lt;/xsl:for-each&gt;\n      &lt;/Row&gt;\n    &lt;/xsl:for-each&gt;\n  &lt;/Table&gt;\n&lt;/Worksheet&gt;\n</code></pre>\n\n<p>\n \n</p>\n\n<p>CONTENT.XML</p>\n\n<pre><code>&lt;Workbook xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"&gt;\n  &lt;Worksheet xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" ss:Name=\"Test\"&gt;\n    &lt;Table xmlns:x=\"urn:schemas-microsoft-com:office:excel\" x:FullColumns=\"1\" x:FullRows=\"1\"&gt;\n      &lt;Row ss:Height=\"12.1032\"&gt;\n       &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;ID&lt;/Data&gt;\n       &lt;/Cell&gt;\n       &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Name&lt;/Data&gt;\n       &lt;/Cell&gt;\n       &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Type&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Group&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Totaltickets&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Wontickets&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Moneyin&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Moneyout&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Percentage&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Average&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;Moneyleft&lt;/Data&gt;\n      &lt;/Cell&gt;\n    &lt;/Row&gt;\n    &lt;Row&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;999&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;test&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"/&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"String\"&gt;a&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0,00&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0,00&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0,00&lt;/Data&gt;\n      &lt;/Cell&gt;\n      &lt;Cell&gt;\n         &lt;Data ss:Type=\"Number\"&gt;0,00&lt;/Data&gt;\n      &lt;/Cell&gt;\n   &lt;/Row&gt;\n&lt;/Table&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>The strange thing is that exporting to ods file works perfectly, so I'm realy stuck. I have all needed files in my directory, <code>treeToXLSX.xsl</code> that generates <code>content.xml</code> and <code>template.xlsx</code>.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13140805,"title":"Checking two ranges in different workbooks (run time error 424)","body":"<p>I am trying to check whether the values in <code>workbook1-sheet1-A</code> are matched in <code>workbook2-sheet2-E</code>. If there is a match <code>workbook1-sheet1-Y</code> receives a <code>'x'</code>.</p>\n\n<p>This is the code I have so far and gives me <code>Run time error 424 - Object required</code> error on the if loop.</p>\n\n<pre><code>Sub Check()\n'\nApplication.ScreenUpdating = False\n\nendRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nwkbSLA = (\"F:\\Workbook2\")\n\nFor i = 2 To endRow\n    If Cells(i, 1).Value = wkbSLA.Sheets(\"Sheet2\").Range(\"E2:E575\").Value Then\n        Range(\"Y\" &amp; i) = \"x\"\n    End If\nNext i\n\n'\nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel","interop","openxml"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13139213,"title":"Fastest way to read from and write to Excel using C#","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7844466/what-is-the-best-fastest-way-to-export-large-set-of-data-from-c-sharp-to-excel\">What is the best / fastest way to export large set of data from C# to excel</a>  </p>\n</blockquote>\n\n\n\n<p>I am creating a web application with the following functionality:</p>\n\n<ol>\n<li><p>Assume an admin stores some data in a predefined Excel template file. He will visit the Admin page and upload this Excel. The application reads this Excel and updates data in the database accordingly.</p></li>\n<li><p>The data stored in the database has to be displayed to any user visiting the ViewDetails page. Now, the data should be displayed on screen to the user as well as a Download to Excel option has to be provided. Also, user will have option of filtering the data and sorting the data.</p></li>\n</ol>\n\n<p>Assume that number of rows will be 10000+, and about 10-15 columns of text/numeric data in each row.</p>\n\n<p>My current thoughts are to use the Interop.Excel object to read the Excel template and upload the data in the database. For reading, I usually fetch all my data into a DataTable and then display it as required. I plan to use DataView for my sorting and filtering purposes. However I have never worked with data of this magnitude and I am not sure about the performance using the above method.</p>\n\n<p>My question is, what is the best and fastest way to go about realizing my requirement?\nI read somewhere that it will take about 2-3 min to write that much data into an Excel file.</p>\n\n<p>I also came across OpenXML:\n\"Open XML is an open standard for word-processing documents, presentations, and spreadsheets that can be freely implemented by multiple applications on different platforms.\" </p>\n\n<p>Can I use it for better realizing the requirement or is there some other way?\nI started developing C# web applications recently, and working with Excel spreadsheets for the first time, so please bear with me if there are any obvious answers I do not know about.\nThanks in Advance :)</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13135410,"title":"Removing commas in VBA cell entry when select option is blank","body":"<p>I would like to insert data from three different drop downs into my spreadsheet but I am having several difficulties. There are three drop downs called <strong>cbo_fac1</strong>, <strong>cbo_fac2</strong> and <strong>cbo_fac3</strong>. Here are the use cases:</p>\n\n<p><strong>Use case 1</strong></p>\n\n<pre><code>cbo_fac1 - User selects 'No Preference' \ncbo_fac2 - User selects 'No Preference' \ncbo_fac3 - User selects 'No Preference' \n</code></pre>\n\n<p>In this case I only want No Preference to be inserted into the spreadsheet cell. This is being handled well so far.</p>\n\n<p><strong>Use case 2 &amp; 3</strong></p>\n\n<pre><code>cbo_fac1 - User does not select 'No Preference' \ncbo_fac2 - User does not select 'No Preference' \ncbo_fac3 - User selects 'No Preference' \n\ncbo_fac1 - User does not select 'No Preference' \ncbo_fac2 - User selects 'No Preference' \ncbo_fac3 - User selects 'No Preference' \n</code></pre>\n\n<p>In both cases I want 'No Preference to be skipped and only the values which are not <code>No Preference</code> to be inserted. </p>\n\n<p>I have attempted this but unfortunately the system inserts commas which I would like to omit. So instead of having entries like <code>PC,DVD,</code> or <code>,DVD,PC</code> if the user selects the <code>No Preference</code> option, I would like to neaten it up and have it look like <code>PC, DVD</code> or <code>DVD, PC</code> to remove the comma associated with the blank entry.</p>\n\n<p>I hope my explanation is clear enough, I included code below to show what I've accomplished so far.</p>\n\n<pre><code> If Me.cbo_fac1 &lt;&gt; \"No preference\" Then\n    cbo_fac1Entry = Me.cbo_fac1.Value\n    Else\n    cbo_fac1Entry = \"\"\n    End If\n    If Me.cbo_fac2 &lt;&gt; \"No preference\" Then\n    cbo_fac2Entry = Me.cbo_fac2.Value\n    Else\n    cbo_fac2Entry = \"\"\n    End If\n    If Me.cbo_fac3 &lt;&gt; \"No preference\" Then\n    cbo_fac3Entry = Me.cbo_fac3.Value\n    Else\n    cbo_fac3Entry = \"\"\n    End If\n\n    cbo_facEntry = cbo_fac1Entry &amp; \",\" &amp; cbo_fac2Entry &amp; \",\" &amp; cbo_fac3Entry\n\n    If cbo_facEntry = \",,\" Then\n    cbo_facEntry = \"No Preference\"\n    Else\n    End If\n\n    rng1.Offset(1, 13) = cbo_facEntry\n</code></pre>\n"},{"tags":["c#","xml","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13045453,"title":"xls-xml file to CSV","body":"<p>I have a file i receive from a blackbox system, the file is somehow mixed between xml and excel, when i open the file with excel i get first a warning message, and if i open it with text editor, the following xml head is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;?mso-application progid=\"Excel.Sheet\"?&gt;\n    &lt;Workbook xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\"\n        xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n        xmlns:x=\"urn:schemas-microsoft-com:office:excel\"\n        xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\"\n        xmlns:html=\"http://www.w3.org/TR/REC-html40\"&gt;\n\n        &lt;Styles&gt;\n\n                &lt;Style ss:ID=\"Default\"&gt;\n                    &lt;Alignment ss:Horizontal=\"Left\" ss:Vertical=\"Bottom\" /&gt;\n                    &lt;Borders/&gt;\n                    &lt;Font/&gt;\n                    &lt;Interior/&gt;\n                    &lt;NumberFormat/&gt;\n                    &lt;Protection/&gt;\n                &lt;/Style&gt;\n                &lt;Style ss:ID=\"sHeader\"&gt;\n                    &lt;Alignment ss:Horizontal=\"Left\" ss:Vertical=\"Bottom\" /&gt;\n                    &lt;Font ss:Bold=\"1\"/&gt;\n                    &lt;NumberFormat ss:Format=\"@\"/&gt;\n                &lt;/Style&gt;\n</code></pre>\n\n<p>i tried many solutions includes (first try to import the file to DataGridView then export it to csv however i always get Unrecognized database format </p>\n\n<p>First, what kind of xls mixed with xml file is this? how can i remove all these head information and just have a simple csv file?</p>\n\n<p>UPDATE:\nI found a way to load data from this excel-XML file however i recieve all data in one column </p>\n\n<p>this is the code i used:</p>\n\n<pre><code> XmlDocument xml = new XmlDocument();\n            string filePath = @\"C:\\temp\\test.xml\";\n            xml.Load(filePath);\n            XmlNamespaceManager nsmgr = new XmlNamespaceManager(xml.NameTable);\n            nsmgr.AddNamespace(\"ss\", \"urn:schemas-microsoft-com:office:spreadsheet\");\n            XmlElement root = xml.DocumentElement;\n            XmlNodeList nodeList = root.SelectNodes(\"//ss:Data\", nsmgr);\n            dataGridView1.DataSource= ConvertXmlNodeListToDataTable(nodeList);\n\n\npublic static DataTable ConvertXmlNodeListToDataTable(XmlNodeList xnl)\n        {\n\n            DataTable dt = new DataTable();\n\n            int TempColumn = 0;\n\n\n\n            foreach (XmlNode node in xnl.Item(0).ChildNodes)\n            {\n\n                TempColumn++;\n\n                DataColumn dc = new DataColumn(node.Name, System.Type.GetType(\"System.String\"));\n\n                if (dt.Columns.Contains(node.Name))\n                {\n\n                    dt.Columns.Add(dc.ColumnName = dc.ColumnName + TempColumn.ToString());\n\n                }\n\n                else\n                {\n\n                    dt.Columns.Add(dc);\n\n                }\n\n            }\n\n            int ColumnsCount = dt.Columns.Count;\n            for (int i = 0; i &lt; xnl.Count; i++)\n            {\n\n                DataRow dr = dt.NewRow();\n\n                for (int j = 0; j &lt; ColumnsCount; j++)\n                {\n\n                    dr[j] = xnl.Item(i).ChildNodes[j].InnerText;\n\n                }\n\n                dt.Rows.Add(dr);\n\n            }\n\n            return dt;\n\n        }\n\n    }\n</code></pre>\n"},{"tags":["vb.net","excel","datatable","export"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13138697,"title":"Export Datatable to Excel with Styles and Formating","body":"<p>i have a problem about exporting a datatable to excel. The exporting to excel is not the problem there are enough solutions on stackoverflow and in the internet. My problem is i must export the datatable with the formating. Now when i export the datatable all cells (header and body) are defined as standard (dataformating). So if i export a datatable for example with integer (numbers) and string (text), i will get the right formating in excel interger is formated as number and the string are formated as text (in excel, i mean the category). Does anyone know a solution for this?</p>\n\n<p>At the moment i use the function on \n<a href=\"http://www.codeproject.com/Tips/406704/Export-DataTable-to-Excel-with-Formatting-in-Cshar\" rel=\"nofollow\">http://www.codeproject.com/Tips/406704/Export-DataTable-to-Excel-with-Formatting-in-Cshar</a>\nto export my datatable. </p>\n\n<p>My second question is. Is there a way to set the styles with a second datatable which contains the whole configure for the tablestyling (headerbackground and so on)</p>\n\n<p>In my function now i configure this with input parameters which set the styles.</p>\n\n<p>This is my thought how it looks like.</p>\n\n<pre><code>ExportDatatabletoExcel(ByVal _datatable as datatable, ByVal _styletable as Datatable)\n</code></pre>\n\n<p>Thank you in advanced.</p>\n\n<p>Alex</p>\n\n<p>PS: Sorry for my bad english.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13138541,"title":"find last row data [for the particular]/[filtered by] year in excel","body":"<p>In excel I have data as below.</p>\n\n<pre><code>2011    0\n2011    15\n2011    10\n2011    5\n2012    15\n2012    10\n2012    5\n</code></pre>\n\n<p>What I want to find is the last row for the respective year so that the output would be </p>\n\n<pre><code>2011    5\n2012    5\n</code></pre>\n\n<p>Any idea how to get this done?</p>\n\n<p>I am looking at this <a href=\"http://en.allexperts.com/q/Excel-1059/Find-filled-cell-column.htm\" rel=\"nofollow\">post</a> and found the way for finding last row data, however I need to know how to filter the same by year.</p>\n\n<p><strong>Note</strong>: I want to do this using excel pre-defined function. NO macro, NO coding, NO pivot.</p>\n\n<hr>\n\n<h2>Edit 1</h2>\n\n<p><code>=INDEX($B:$B,MAX(IF(LEN($B:$B)&gt;0,ROW($B:$B),0)),1)</code> gives me answer 5. However I want it to fiter by year. Any idea how to get this done?</p>\n\n<hr>\n\n<h2>Edit 2</h2>\n\n<p><code>=OFFSET(B2,MAX(IF(NOT(ISBLANK(B2:B25)),ROW(B2:B25),0))-ROW(B2),0)</code> this also gives last row data.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13139760,"title":"print occurrences in excel","body":"<p>Lets say I have data as </p>\n\n<pre><code>2011\n2012\n2011\n2012\n2013\n2013\n2011\n2012\n</code></pre>\n\n<p>Then what I want is </p>\n\n<pre><code>2011     1\n2012     1\n2011     2\n2012     2\n2013     1\n2013     2\n2011     3\n2012     3\n</code></pre>\n\n<p>Any idea to get this done?</p>\n\n<p>Note that I want to get this done using Excel formulaes only. NO MACRO NO PIVOT NO CODING.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13122759,"title":"do sum filtered by year","body":"<p>Hi want to create some report using data what I have. Below is what I have.</p>\n\n<pre><code>Date       Sold\n22-Oct-11   22\n23-Oct-11   28\n24-Oct-11   10\n22-Oct-12   22\n23-Oct-12   28\n24-Oct-12   10\n</code></pre>\n\n<p>What I want is create year and sold total as below.</p>\n\n<pre><code>Year   Sold\n2011    60\n2012    87\n</code></pre>\n\n<p>Any idea how to get this done using excel pre-defined function.</p>\n\n<p>I know this can be done using MACRO, however I don't want to use MACRO.</p>\n\n<h2>Edit 1</h2>\n\n<p>I don't want to do this using Pivot too. ONLY Excel pre-defined functions.</p>\n"},{"tags":["c#","silverlight","excel","silverlight-5.0","excel-interop"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13130699,"title":"Is it possible to read excel files in Silverlight?","body":"<p>I'm working with SL 5.0 and realized that I need to work with Excel library from Office. The application purpose is intended for many computers where can have or can't have Office installed.</p>\n\n<p>I'm worry about how can I deal with this situation. Locally I referenced a Interop library for testing, but when I deploy the project, I can imagine that it wouln't work in every computer, right?</p>\n"},{"tags":["java","jquery","excel","servlets","dialog"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13139519,"title":"Save As DialogueBox is not working in servlet response.setHeader","body":"<p>I am exporting data displayed in jqgrid into .excel file by clicking button .\nHere is my code for export to excel button click..</p>\n\n<pre><code> $('#excel').click(function(){\n            var fromdate=$('#fromdate').val();\n            var todate=$('#todate').val();\n            if(fromdate &amp;&amp; todate)\n            {\n                var URL='excel?fromdate='+$('#fromdate').val()+'&amp;todate='+$('#todate').val();\n                $.ajax({\n                   url:URL,\n                   type:'GET',\n                   success:function(data){\n                       alert('Exported To Excel');\n                   }\n\n                });\n            }\n        });\n</code></pre>\n\n<p>Now this button will direct to excel.java  page  which is servlet.Below is my exceljava page code .Now Asper my need when the user click on export to excel button a openwith and save as dialogue box should popup which gives user ability to give desired name and save to desired positionbut it is not happening with this code.plz point out my mistake ..</p>\n\n<p>excel.java</p>\n\n<pre><code>  try {\n\n    response.setHeader(\"Content-Type\", \"application/vnd.ms-excel\");\n    response.setHeader(\"Content-Disposition\",\"attachment; filename=excel.xls\");\n\n    String datum1 = request.getParameter(\"fromdate\");\n    String datum2 = request.getParameter(\"todate\");\n    SimpleDateFormat sdfSource = new SimpleDateFormat(\"dd-MM-yyyy\");\n    Date date = sdfSource.parse(datum1);\n    Date date2 = sdfSource.parse(datum2);\n    SimpleDateFormat sdfDestination = new SimpleDateFormat(\"yyyy-MM-dd\");\n    datum1 = sdfDestination.format(date);\n    System.out.println(datum1);\n    datum2 = sdfDestination.format(date2);\n    System.out.println(datum2);\n\n\n    HSSFWorkbook hwb = new HSSFWorkbook();\n    HSSFSheet sheet = hwb.createSheet(\"CallBillingSystem\");\n\n    HSSFRow rowhead = sheet.createRow((short) 0);\n    rowhead.createCell((short) 0).setCellValue(\"calldate\");\n    rowhead.createCell((short) 1).setCellValue(\"src\");\n    rowhead.createCell((short) 2).setCellValue(\"dst\");\n    rowhead.createCell((short) 3).setCellValue(\"dstchannel\");\n    rowhead.createCell((short) 4).setCellValue(\"lastapp\");\n    rowhead.createCell((short) 5).setCellValue(\"duration\");\n    rowhead.createCell((short) 6).setCellValue(\"disposition\");\n    rowhead.createCell((short) 7).setCellValue(\"amaflags\");\n    rowhead.createCell((short) 8).setCellValue(\"cdrcost\");\n\n\n    String strQuery = \"\";\n    ResultSet rs = null;\n\n    conexion conexiondb = new conexion();\n    conexiondb.Conectar();\n\n    strQuery = \"SELECT * FROM cdrcost where date(calldate) between '\" + datum1 + \"' and '\" + datum2 + \"'\";\n\n     //strQuery = \"SELECT * FROM cdrcost where date(calldate) between '2011-09-01' and '2012-01-01'\";\n\n    rs = conexiondb.Consulta(strQuery);\n    int i = 1;\n    while (rs.next()) {\n        HSSFRow row = sheet.createRow((short) i);\n        row.createCell((short) 0).setCellValue(rs.getString(\"calldate\"));\n        row.createCell((short) 1).setCellValue(rs.getString(\"src\"));\n        row.createCell((short) 2).setCellValue(rs.getString(\"dst\"));\n        row.createCell((short) 3).setCellValue(rs.getString(\"dstchannel\"));\n        row.createCell((short) 4).setCellValue(rs.getString(\"lastapp\"));\n        row.createCell((short) 5).setCellValue(rs.getString(\"duration\"));\n        row.createCell((short) 6).setCellValue(rs.getString(\"disposition\"));\n        row.createCell((short) 7).setCellValue(rs.getString(\"amaflags\"));\n        row.createCell((short) 8).setCellValue(rs.getString(\"cdrcost\"));\n        i++;\n    }\n    FileOutputStream fileOut = new FileOutputStream(filename);\n    hwb.write(fileOut);     \n    hwb.write(response.getOutputStream());\n    System.out.println(\"Your excel file has been generated!\");\n    FileOut.close();\n} catch (Exception ex) {\n    System.out.println(ex);\n\n}\n\n}\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13138204,"title":"Insert radio values from VBA form into Excel spreadsheet","body":"<p>How do you insert selected radio values into a Excel spreadsheet from a VBA form? By radio values we mean that there only one possible option. I'm struggling to achieve this in VBA.</p>\n\n<hr>\n\n<p>Here are my radio values:</p>\n\n<p>priority - options located in the frame <strong>fr_Priority</strong>, two possible checkbox options:</p>\n\n<ul>\n<li><p>priority_y - If user selects this then <em>Yes</em> is inserted into cell</p></li>\n<li><p>priority_n - If user selects this then <em>No</em> is inserted into cell</p></li>\n</ul>\n\n<p>lectureStyle - options located in the frame <strong>fr_LectureStyle</strong>, two possible checkbox options:</p>\n\n<ul>\n<li><p>lecturestyle_trad - If user selects this then <em>Traditional</em> is inserted into cell</p></li>\n<li><p>lecturestyle_sem - If user selects this then <em>Seminar</em> is inserted into cell</p></li>\n<li><p>lecturestyle_lab - If user selects this then <em>Lab</em> is inserted into cell</p></li>\n<li><p>lecturestyle_any - If user selects this then <em>Any</em> is inserted into cell</p></li>\n</ul>\n\n<p>roomStructure - options located in the frame <strong>fr_roomStruc</strong>, two possible checkbox options:</p>\n\n<ul>\n<li><p>rs_Tiered - If user selects this then <em>Tiered</em> is inserted into cell</p></li>\n<li><p>rs_Flat - If user selects this then <em>Flat</em> is inserted into cell</p></li>\n</ul>\n\n<hr>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\nDim ws As Worksheet, rng1 As Range\nSet ws = Worksheets(\"main\")\n\n' Get last empty cell in column A\n  Set rng1 = ws.Cells(Rows.Count, \"a\").End(xlUp)\n\n' I'm strugging to insert the radio values inserted at this point, they \n' need to go into the cells specified below\n\n' rng1.Offset(1, 10) = priority\n' rng1.Offset(1, 11) = lectureStyle\n' rng1.Offset(1, 12) = roomStructure\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thanks so much for the help!</p>\n"},{"tags":["asp.net",".net","excel","c#-4.0",".net-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":24,"score":0,"question_id":13138961,"title":"Embed an excel file into web page","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9261774/embed-excel-sheet-into-asp-net-web-page\">Embed Excel Sheet into Asp.Net Web Page</a>  </p>\n</blockquote>\n\n\n\n<p>Can anyone tell me how to embed and display an excel file in an ASP.NET page?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","excel","xls"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1130,"score":0,"question_id":8128616,"title":"How can i read .xls files (Excel) with PHP?","body":"<p>I need to convert an .xls file to text, i dont need it formatted in any way.\nThe file is filled with productids like PN-5098P, which i will preg_match_all to get.</p>\n\n<p>What is the simplest solution?\nI tried simply opening the file in a regular texteditor, the ids are not showing, so i guess i need some kind of binary converter?</p>\n"},{"tags":["excel","excel-vba","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13125230,"title":"Excel: Data Processing for Pivot - Extract from Single Column to Multiple","body":"<p>I have a list of values that I need to format for processing and the format of the data isn't suitable in it's current form.</p>\n\n<p>The values are currently in the following format:</p>\n\n<p><a href=\"http://imgur.com/PAO90\" rel=\"nofollow\"><img src=\"http://i.imgur.com/PAO90.jpg\" alt=\"\" title=\"Hosted by imgur.com\" /></a></p>\n\n<p>There are far too many records to attempt this manually. What's the best way to automate the process, either with a formula or VBA?</p>\n\n<p>EDIT: The values in C3:C4 appear for each set of records in the sheet. The number of cells below them can vary from 1 to 3,000.</p>\n\n<p>Thanks for your help.</p>\n\n<p>EDIT: Tim you've been a huge help and I massively appreciate it - the edited version didn't work though for some reason. In any case, I modified it very rudimentarily to loop back through and empty the cell values for the ones I didn't want marked. Thanks again.</p>\n\n<pre><code>Sub Tester()\n\nConst STATUS_FLAG As String = \"status code:*\"\n\nDim v1, v2\nDim c As Range\nDim sht As Worksheet\n\n    Set sht = ActiveSheet\n    Application.ScreenUpdating = False\n    For Each c In sht.Range(sht.Range(\"C1\"), sht.Cells(Rows.Count, 3).End(xlUp))\n        If c.Value Like STATUS_FLAG Then\n            v1 = c.Offset(-2, 0)\n            v2 = c.Offset(-1, 0)\n        ElseIf c.Value Like \"http:*\" Then\n            c.Offset(0, -2).Value = v1\n            c.Offset(0, -1).Value = v2\n        End If\n        If c.Value Like STATUS_FLAG Then\n            c.Offset(-2, -2).Value = \"\"\n            c.Offset(-2, -1).Value = \"\"\n            c.Offset(-1, -2).Value = \"\"\n            c.Offset(-1, -1).Value = \"\"\n        End If\n    Next c\n    Application.ScreenUpdating = True\n\nEnd Sub  \n</code></pre>\n"},{"tags":["excel","copy","cell","background-color","conditional-formatting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13138274,"title":"Excel 2007 - Copy 3-Color Scale formatting from one cell to another","body":"<p>I have a list of cells with the names of various regions on the left hand side of a table.</p>\n\n<p>The table contains lots of data of product sales, split into different product sizes and types.</p>\n\n<p>On the far right hand side I have a total number of sales, per region.</p>\n\n<p>Sooo, something like:</p>\n\n<pre><code>Region | S | M | L | Totals\n-------+---+---+---+--------\nJapan  | 1 | 2 | 8 |   11     &lt;~~ Orange\nChina  | 3 | 9 | 9 |   21     &lt;~~ Green\nSpain  | 5 | 0 | 1 |    6     &lt;~~ Dark Orange\nItaly  | 0 | 1 | 2 |    3     &lt;~~ Light Red\n</code></pre>\n\n<p>This is a hugely reduced version, but it paints a picture.</p>\n\n<hr>\n\n<p>Now, the right hand side totals use Excel 2007 onwards 3-Color Scale conditional formatting, which uses a gradient scale to colour the cells' backgrounds.</p>\n\n<p>What I really want is for the left hand 'Region' names to have their backgrounds matching their respective totals, which would prove to be incredibly difficult to achieve.</p>\n\n<hr>\n\n<p>I can't set the region cells to use the total cells values as the values for their conditional formatting.</p>\n\n<p>I also can't simply use the same formatting, as it uses a gradient to decide the colours I can't manually write modified formulas, as I have no idea what they are.</p>\n\n<p>The functions to get a conditionally formatted background (from cpearson) were written for Excel 2003, and don't work on 2007 as the conditional formatting API was totally revamped in 2007 onwards.</p>\n\n<hr>\n\n<p>All I really want (as the data is static, and so isn't going to change) is a way to simply copy the colour from one lot of cells to another, when they've been coloured that way by conditional formatting. Don't mind how I do it, but it does need to be done.</p>\n\n<p>You wouldn't think it would be that difficult to do, but it's certainly got me stumped.</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13138092,"title":"How do I compare values from two tables and add result in third?","body":"<p>I have the following problem:</p>\n\n<p>Table one has the following columns: ID, Name, Color\nTable two has the following columns: ID, Price, Date</p>\n\n<p>I need to make a third table with the following:</p>\n\n<ol>\n<li>If ID from table2 is found in ID in table1, then add a row in table3 with: ID, Name, Price</li>\n</ol>\n\n<p>Table1 and Table2 have different size.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","excel","rubygems","spreadsheet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13137613,"title":"Iterate over all cells from a column Spreadsheet Gem","body":"<p>I need to put a certain string value in all the cells from a column.How can I iterate over all values? Thanks!</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":16,"score":0,"question_id":13137379,"title":"Convert Hexa To decimal numbers","body":"<p>When I put 15 digits number in my excel cell it converts it in to<code>1.002E+15</code>. How do I put it back to 15 digits number?</p>\n"},{"tags":["java","excel","export","dynamic-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13137391,"title":"Dynamicreports - Disable the line border of the cells","body":"<p>I have a question about the XLS export in dynamicreports.</p>\n\n<p>I need to disable the line border of the cells to show the document with the background totally white, without resizing the document (A4). Is it possible? </p>\n\n<p>With EXPORT_XLS_WHITE_PAGE_BACKGROUND only the document size will have the white background</p>\n\n<pre><code>    properties.setProperty(JasperProperty.EXPORT_XLS_WHITE_PAGE_BACKGROUND, \"true\");\n</code></pre>\n\n<p>I have seen that poi have a method to achieve that setDisplayGridlines(false) . Is possible with dynamicreports??</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13134890,"title":"Copy object from a reference into a variable","body":"<p>Is there a way to copy an object from a reference (range or cell for example) to a variable?</p>\n\n<p>The reason why I want to do this is because I have a huge macro that calculates a lot of things and uses many copy+paste operations and it loops over many cells and alters them. This does not perform very well at all, so I wanted to minimize the GUI operations and work in the background, this way I could have the whole result in an array which I paste to the GUI in the end. The problem is that I need the objects not just the value of the cells/ranges because I need also to alter other properties (e.g. size or color).</p>\n"},{"tags":["excel","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13136049,"title":"Export a range as JPEG and store on FTP","body":"<p>My code below exports a range to a JPEG file and saves it to my C: drive. But now I would like to expand this code to save it to a FTP. I have tried editing the path where the file is stored, but this doesn't work.</p>\n\n<pre><code>Sub bah()\n''' Set Range you want to export to file\n    Dim rgExp As Range: Set rgExp = Range(\"B2:C6\")\n    ''' Copy range as picture onto Clipboard\n    rgExp.CopyPicture Appearance:=xlScreen, format:=xlBitmap\n    ''' Create an empty chart with exact size of range copied\n    With ActiveSheet.ChartObjects.Add(Left:=rgExp.Left, Top:=rgExp.Top, _\n    Width:=rgExp.Width, Height:=rgExp.Height)\n    .Name = \"ChartVolumeMetricsDevEXPORT\"\n    .Activate\n    End With\n    ''' Paste into chart area, export to file, delete chart.\n    ActiveChart.Paste\n   ActiveSheet.ChartObjects(\"ChartVolumeMetricsDevEXPORT\").Chart.Export \"C:\\Users\\ajohnson\\Desktop\\workdamnit.jpg\"\nActiveSheet.ChartObjects(\"ChartVolumeMetricsDevEXPORT\").Delete\nEnd Sub\n</code></pre>\n"},{"tags":["php","excel","phpexcel","column-sizing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13135964,"title":"changing the size of column using PHPExcel","body":"<p>I met some troubles while using PHPExcel,</p>\n\n<p>In fact I have read all the tutorials I've found but it does not work for me.</p>\n\n<p>I've put this code on the page:</p>\n\n<pre><code>$i = -1; // index des enregistrements\n\n$objPHPExcel-&gt;setActiveSheetIndex(0);\n$sheet-&gt;getColumnDimension('A')-&gt;setWidth(75);\n$sheet-&gt;getColumnDimension('B')-&gt;setWidth(150);\n$sheet-&gt;getColumnDimension('C')-&gt;setWidth(190);\n$sheet-&gt;getColumnDimension('D')-&gt;setWidth(150);\n$sheet-&gt;getColumnDimension('E')-&gt;setWidth(115);\n$sheet-&gt;getColumnDimension('F')-&gt;setWidth(115);\n$sheet-&gt;getColumnDimension('G')-&gt;setWidth(380);\n$sheet-&gt;getColumnDimension('H')-&gt;setWidth(75);\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D1', '&lt;img src=\"images/agenda.png\" alt=\"AGENDA\" width=\"168\" height=\"24\"&gt;');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A3', 'Du '.$_REQUEST['date1'].' Au '.$_REQUEST['date2'].', Critères: '.$_REQUEST['tache'] );\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('A5', 'CLIENT');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('B5', 'N° DE DOSSIER');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('C5', 'DEBITEUR');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('D5', 'TEL');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('E5', 'DATE');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('F5', 'TRAITEMENT');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('G5', 'DESCRIPTION');\n$objPHPExcel-&gt;getActiveSheet()-&gt;SetCellValue('H5', 'RESTANT DU EN PPAL');\n</code></pre>\n\n<p>But it give to me the following errors:</p>\n\n<p>Notice: Undefined variable: sheet in Line 173</p>\n\n<p>Notice: Undefined variable: sheet in Line 173</p>\n\n<p>I'm really Lost, I thought it wad that way for changing column sizes.</p>\n\n<p>Any kind of help will be much appreciated.</p>\n\n<p>Kind Regards.</p>\n\n<p>SP.</p>\n"},{"tags":["excel","excel-2007","pivot"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13136187,"title":"dynamic database connection dropdown in Pivot table excel","body":"<p>I have prepared an excel 2007 pivot table (my first pivot table) to retrieve information from a table in dev database.<br>\nI want to provide a drop down filter on top of pivot which can let me select different database connections and show pivot table data based on database selected</p>\n\n<p>option1 : Dev Database <br>\nOption2 : Test Database<br>\nOption2: Pre Production Database<br>\nOption4: Production Database<br></p>\n\n<p>Thanks <br>\nAlex</p>\n"},{"tags":["sql-server","excel","excel-vba","adodb"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":13129090,"title":"Excel Automation Error Importing DB into Worksheets","body":"<p>I have a workbook with 192 worksheets that correspond to the 192 tables in our mssql database. If I set up a given table in Data Connections Wizard, all of the data is properly dumped into the worksheet. However, when I run my code below, I get:</p>\n\n<p>Run-Time Error '214767259 (80004005)' Automation Error Unspecified Error</p>\n\n<p>About half of the tables populate just fine. I've noticed that I get the error once it reaches a field that has a large amount of data (rtf text). The fields that have that text aren't important to me, so if excel could leave those blank and continue on I would be happy. That large field is in a different column (sometimes multiple columns) depending on each table, so it'd be time consuming to have to go through all 192 tables to weed out an individual column to not import. </p>\n\n<p>Why am I getting this error when I run it in vba, but the data connection wizard has no problems?</p>\n\n<pre><code>Sub GetData()\n\nDim cnDump As ADODB.Connection\nSet cnDump = New ADODB.Connection\n\n' Provide the connection string.\nDim strConn As String\n\n'Use the SQL Server OLE DB Provider.\nstrConn = \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=XXXX;Data Source=XXXX\\XXXX;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=XXXX;Use Encryption for Data=False;Tag with column collation when possible=False;\"\n\n'Now open the connection.\ncnDump.Open strConn\n\n\n' GET DATA\nDim ws As Worksheet\nDim tbl_name As String\n\nDim rsDump As ADODB.Recordset\nSet rsDump = New ADODB.Recordset\n\nFor Each ws In Worksheets\n\ntbl_name = ws.Name\nws.Rows.ClearContents\n\nWith rsDump\n\n    .ActiveConnection = cnDump\n    .Open \"SELECT * FROM \" &amp; tbl_name\n\n    For i = 1 To .Fields.Count\n     ws.Cells(1, i) = .Fields(i - 1).Name\n    Next i\n\n\n    ws.Range(\"A2\").CopyFromRecordset rsDump\n\nEnd With\n\n\nws.Rows(1).Font.Bold = True\n\n\nNext ws\n\ncnDump.Close\nSet rsDump = Nothing\nSet cnDump = Nothing\n\n\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","artificial-intelligence","excel-formula","game"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13114128,"title":"Find distance to nearest cell in each cardinal direction with value \"#\"?","body":"<p>To phrase it differently, how many cells must you go down, up, left, and right before you find a cell with value \"#\"?</p>\n\n<p>The desired end result is for the cell to display how directions you can go at least 'x' cells before you find a cell that has the value \"#\".</p>\n\n<p>I am a bit of a newb, and am sure this question is not exactly the normal sort, but I can't seem to find any information anywhere that would point me to a solution of any kind.</p>\n\n<p>battleship board distribution of possible placements for four tile long ship: turn 0</p>\n\n<p><img src=\"http://i.stack.imgur.com/6H1QR.png\" alt=\"turn-0\"></p>\n\n<p>battleship board distribution of possible placements for four tile long ship: turn 1</p>\n\n<p><img src=\"http://i.stack.imgur.com/YQFQ1.png\" alt=\"turn-1\"></p>\n"},{"tags":["excel","filter","pivot-table","simultaneous"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13118486,"title":"filtering simultaneously data entries on pivot table/excel","body":"<p>I need to create a pivot table in excel to show which xml pages contain which variables.</p>\n\n<p>The pages look something like:</p>\n\n<pre>\n|Datagroup|Variable|Value|XmlPageName|\n|ABC      |    VarX|   22|     pageA1|\n|ABC      |    VarY|   33|     pageA1|\n|ABC      |    VarY|   44|     pageA2|\n|ABC      |    VarX|   80|     pageA3|\n|ABC      |    VarY|   12|     pageA3|\n|ABC      |    VarY|   80|     pageA4|\n</pre>\n\n<p>First, I want to filter the data on Varx = 22 . \nFurthermore, I want apply another filter on Vary =33 to show me all XmlPageName entries that contain simultaneously (VarX= 22 and VarY=33). <br/>In this case, it will be pageA1.<br/>\nI am not able to perform this, as I can't apply 2 filters simultaneously. <br/>\nI couldn't do this with regular filtering and nor with pivot tables.</p>\n\n<p>I want to mention that the excel file is huge, so \"eyeball\" filtering takes too much time.</p>\n\n<p>Any ideas on how to achieve this?</p>\n\n<p>Many thanks,</p>\n\n<p>Dola</p>\n"},{"tags":["sql","excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13134070,"title":"Dealing with single quotes in excel vba sql queries","body":"<p>I am using excel sql queries to fetch data from the backend according to the selection i make in a dropdown box.However my sql queries are not working in cases where there is a single quote(') in the dropdown box value. For example-- Men's Wear . Please suggest me a way to deal with this problem</p>\n\n<pre><code>    SQL = \"select Segment,Weeks,Value from [Category performance data$] where       Departments='\" &amp;       Sheet3.Range(\"Dept_name\").Value &amp; _\n     \"' and Metric ='Total Spend' group by Segment,Weeks,Value\"\n    Call execQry   \n</code></pre>\n"},{"tags":["excel","ms-access","diff","vlookup"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13133204,"title":"Find the different two Excel sheets when having identical row","body":"<p>I have two excel sheets with same column Names and Format. And it has one identical row(can use as Primary Key) <code>id</code>. I want to get the diff.</p>\n\n<p>table 1:</p>\n\n<pre><code> id   Name   GPA \n----+------+-------\n 1  | AA   |  3\n 2  | BB   |  2\n 3  | CC   |  3\n 4  | DD   |  1\n</code></pre>\n\n<p>Table 2:</p>\n\n<pre><code> id   Name   GPA \n----+------+-------\n 4  | DD   |  2               (updated)\n 7  | YY   |  2               (New)\n 1  | AA   |  3                  _\n 2  | DD   |  2               (Updated)  \n</code></pre>\n\n<p>Result Table:</p>\n\n<pre><code>     id   Name   GPA \n    ----+------+-------\n     4  | DD   |  2               \n     7  | YY   |  2                    \n     2  | DD   |  2   \n</code></pre>\n\n<p>I want to populate the result table with only Updated and New Rows. (We can identify row using Primary key)</p>\n\n<p>Is there any function directly to get the difference in Excel(VLOOKUP) ? </p>\n\n<p>If not how can I write a query in Access to get this done? </p>\n"},{"tags":["javascript","excel","date","activex","format"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4791,"score":0,"question_id":380100,"title":"How to customize date format when creating excel cells through javascript (activexobject)?","body":"<p>I'm trying to convert an HTML table to Excel in Javascript using new <code>ActiveXObject(\"Excel.application\")</code>. Bascially I loop through table cells and insert the value to the corresponding cell in excel:</p>\n\n<pre><code>//for each table cell\noSheet.Cells(x,y).value = cell.innerText;\n</code></pre>\n\n<p>The problem is that when the cell is in date format of 'dd-mm-yyyy' (e.g. 10-09-2008), excel would read as 'mm-dd-yyyy' (i.e. 09 Oct 2008). I tried to specify <code>NumberFormat</code> like:</p>\n\n<pre><code>oSheet.Cells(x,y).NumberFormat = 'dd-mm-yyyy';\n</code></pre>\n\n<p>But it has no effect. It seems that this only affect how excel <strong>display the value, not parse</strong>. My only solution now is to swap the date like:</p>\n\n<pre><code>var txt = cell.innerText;\nif(/^(\\d\\d)-(\\d\\d)-\\d\\d\\d\\d$/.test(txt)) txt = txt.replace(/^(\\d\\d)-(\\d\\d)/,'$2-$1');\n</code></pre>\n\n<p>But I'm worrying that it is not generic and a differnt machine setting would fail this.</p>\n\n<p>Is there a way to specific how excel <strong>parse</strong> the input value?</p>\n"},{"tags":["excel","spreadsheet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13132027,"title":"Find averages by index in excel","body":"<p>I have a slightly complicated task that i need to do in excel</p>\n\n<p>I have a spreadsheet that is 10,000 rows by 100 columns</p>\n\n<p>I want to extract the 10 groups that are 1000 rows by 100 columns from that spreadsheet</p>\n\n<p>Then i want to get a row of the averages of each of the 100 columns for each of the groups i got previously</p>\n\n<p>Then i went to copy each of the averages 500 times so that i have 500 rows of the averages from the first group, then 500 more rows with averages from the second group and so on</p>\n\n<p>This is a lot to do by hand, so i was wondering if there are any parts of it that i can easily automate. I'm not familiar with scripting in excel, but i feel like a lot of these things can be done with built in functions\nAny suggestions?</p>\n\n<p>Thanks!</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13121425,"title":"Border around each cell in a range","body":"<p>I am trying to create a simple function that will add borders around every cell in a certain range. Using the wonderful recording this generates a ton of code which is quite useless. The code below will display a 'table' of data, around each cell in this range I would like to add a border. Online I haven't been able to find a simple or clear answer for this.</p>\n\n<p>All help is much appreciated!</p>\n\n<pre><code>Set DT = Sheets(\"DATA\")\nendRow = DT.Range(\"F\" &amp; Rows.Count).End(xlUp).Row\nresult = 3\n\nFor I = 2 To endRow\n    If DT.Cells(I, 6).Value = Range(\"B1\").Value Then\n        Range(\"A\" &amp; result) = DT.Cells(I, 6).Value\n        Range(\"B\" &amp; result) = DT.Cells(I, 1).Value\n        Range(\"C\" &amp; result) = DT.Cells(I, 24).Value\n        Range(\"D\" &amp; result) = DT.Cells(I, 37).Value\n        Range(\"E\" &amp; result) = DT.Cells(I, 3).Value\n        Range(\"F\" &amp; result) = DT.Cells(I, 15).Value\n        Range(\"G\" &amp; result) = DT.Cells(I, 12).Value\n        Range(\"H\" &amp; result) = DT.Cells(I, 40).Value\n        Range(\"I\" &amp; result) = DT.Cells(I, 23).Value\n        result = result + 1\n    End If\nNext I\n</code></pre>\n"},{"tags":["c#",".net","sql","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":352,"score":0,"question_id":8914345,"title":".NET Excel data using SqlBulkCopy","body":"<p>I have an Excel file with a large amount of data which needs to be inserted to MS Sql server table.\nThe Excel data contains different data types in each column. I need to loop through the data of row each row and convert it to a string where each column for that row is seperated by a comma. </p>\n\n<pre><code>Excel data ( | = column seperation):\n\nID | FirstName | LastName |\n\n1  | John      | Smith    |\n\n2  | Amy       | Jones    |\n</code></pre>\n\n<p>So the new rows will look like:</p>\n\n<pre><code>Row 1= ID, FirstName, LastName\n\nRow 2= 1, John, Smith\n\nRow 3= 2, Amy, Jones\n</code></pre>\n\n<p>Then each row of data after the conversion needs to be inserted in to Sql table. Please note the excel file is likely to contain 10,000+ rows.</p>\n\n<p>What is the most efficient way to do this in .NET using C# please?</p>\n"},{"tags":["ruby","excel","openxml","rubyxl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13104034,"title":"How do I create a date-formatted cell using RubyXL?","body":"<p>I'm using RubyXL to dynamically generate a spreadsheet file that contains some dates. The documentation is kind of sparse so I've been looking at the source, and it appears the library only has special handling for <code>Date</code> and <code>DateTime</code> when you call <code>change_contents</code>, so that's what I'm doing:</p>\n\n<pre><code>cell = sheet.add_cell_obj RubyXL::Cell.new(sheet, row_index, col_index)\ncell.change_contents(Time.now.to_datetime)\n</code></pre>\n\n<p>When I create a spreadsheet this way, Excel does not format those cells as dates. I'm guessing that I need to set some other field, perhaps <code>cell.datatype</code>, but I'm not sure. Or maybe I'm barking up the wrong tree. Does anybody know what to do?</p>\n"},{"tags":["excel","excel-interop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13131079,"title":"ChartObject.TopLeftCell (and most every other property) throwing an exception","body":"<p>I have this code (sheet is a Wordsheet):</p>\n\n<pre><code>ChartObject chart = sheet.Application.ActiveWindow.Selection as ChartObject;\nif (chart != null)\n    return chart.TopLeftCell;\n</code></pre>\n\n<p>And it throws a COMException on accessing TopLeftCell. Looking at it in the debugger, most of the properties throw an exception. Sample code at <a href=\"http://www.windward.net/temp/ExcelChartPositionBug.zip\" rel=\"nofollow\">http://www.windward.net/temp/ExcelChartPositionBug.zip</a></p>\n\n<p>Any idea why?</p>\n\n<p>thanks - dave</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13126533,"title":"Excel/VBA Breakdown field","body":"<p>Bit of a complicated task I have to do but I will try and explain. I have an excel file with 23000 lines of data which I am importing into a website. Each one has a field like so:</p>\n\n<pre><code>Category | other data | other data 2 \n\nFoods/Dog/Treats Pre-Pack | 1223 | image.jpg\n</code></pre>\n\n<p>I need it to grab each line and add a new line below it for each \"/\" so turning the above into:</p>\n\n<pre><code>Category | other data | other data 2 \n\n[blank in original line] | 1223 | image.jpg\n\nFoods | [blank field] | [blank field]\n\nFoods/Dog | [blank field] | [blank field]\n\nFoods/Dog/Treats Pre-Pack | [blank field] | [blank field]\n</code></pre>\n\n<p>So the script needs to add a new line for each category but keeping the original category in front of it. So turning <code>category/category2/category 3</code> into 4 lines of: <code>[blank] - category - category/category2 - category/category2/category 3</code></p>\n\n<p>Does anyone know a way or script to do this?</p>\n\n<p>Thanks, Simon</p>\n\n<p>Note: The worksheet is called \"test\" and the category column starts at E2 and goes to E23521</p>\n\n<p>I have the following script:</p>\n\n<pre><code>Sub test()\n    Dim a, i As Long, ii As Long, e, n As Long\n    Dim b(), txt As String, x As Long\n    With Range(\"a1\").CurrentRegion\n        a = .Value\n        txt = Join$(Application.Transpose(.Columns(5).Value))\n        With CreateObject(\"VBScript.RegExp\")\n            .Global = True\n            .Pattern = \"/\"\n            x = .Execute(txt).Count * 2\n        End With\n        ReDim b(1 To UBound(a, 1) + x, 1 To UBound(a, 2))\n        For i = 1 To UBound(a, 1)\n            If a(i, 5) &lt;&gt; \"\" Then\n                For Each e In Split(a(i, 5), \"/\")\n                    n = n + 1\n                    For ii = 1 To UBound(a, 2)\n                        b(n, ii) = a(i, ii)\n                    Next\n                    b(n, 5) = Trim$(e)\n                Next\n            End If\n        Next\n        .Resize(n).Value = b\n    End With\nEnd Sub\n</code></pre>\n\n<p>This seems to create a new row as I need it to but does not keep the slash structuring moving up with each one. And also dosnt add a blank line on all the new ones and make the original category value blank.</p>\n\n<p>SOLVED:</p>\n\n<pre><code>Sub splitEmUp()\n    Dim splitter() As String 'this is storage space for the split function\n    Dim i As Integer ' main-loop for counter \"which cell we are on\"\n    Dim j As Integer ' splitter for-loop counter \"which section of the split are we on\"\n    Range(\"E2\").Activate 'starting in cell e2 because row 1 is headers and category is located in the B column\n\n   For i = 0 To 24000 'from beginning to end i=0 means e2, i=1 means e3\n        ActiveCell.Offset(i, 0).Value = Replace(ActiveCell.Offset(i, 0).Value, \" / \", \"!@#\")\n        splitter = Split(ActiveCell.Offset(i, 0), \"/\") 'split the cell based on / and store it in splitter\n        If (UBound(splitter)) &gt; 0 Then 'if a split occurred\n            ActiveCell.Offset(i, 0).Value = \"\" 'set the activecell to blank\n            Debug.Print i\n            ActiveCell.Offset(i + 1, 0).EntireRow.Insert shift:=xlDown, copyorigin:=xlFormatFromLeftOrAbove 'insert a new row and shift everything down\n\n            ActiveCell.Offset(i + 1, 0).Value = splitter(0) 'initialize the \"Down\" cells\n            ActiveCell.Offset(i + 1, 0).Value = Replace(ActiveCell.Offset(i + 1, 0).Value, \"!@#\", \" / \")\n            For j = 1 To UBound(splitter)\n                ActiveCell.Offset(i + j + 1).EntireRow.Insert shift:=xlDown, copyorigin:=xlFormatFromLeftOrAbove 'create another row if it needs to\n                ActiveCell.Offset(i + (j + 1), 0).Value = ActiveCell.Offset(i + j).Value &amp; \"/\" &amp; splitter(j) 'fill out the new row\n                ActiveCell.Offset(i + (j + 1), 0).Value = Replace(ActiveCell.Offset(i + (j + 1), 0).Value, \"!@#\", \" / \")\n            Next\n            i = i + UBound(splitter) + 1 'need to step I past the new cells\n            ReDim splitter(0)\n            Erase splitter 'erase and eliminate splitter to avoid carry over.\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"},{"tags":["c#","asp.net","excel","gridview","export"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3664,"score":0,"question_id":7943841,"title":"C# GridView export to excel","body":"<p>I am binding a GridView to a sqldatasource and then on _rowcreated event doing some validations and when the row does not meet requirements I am hiding it using  e.Row.Visible = false;</p>\n\n<p>This works fine and only displays the correct rows in the gridview. Now I have a button to export to excel and that works great with the exception of exporting also the hidden rows. I do not want the hidden rows exported. </p>\n\n<p>Is there a way that i can tell the gridview to not add that row instead of hiding it?\nIs there a simple method to delete all hidden rows before i run the export?\nCan i not add the hidden rows during the export? As you can see in the code below I tried to do this one, but it does not recognize whether the row is visible or not.</p>\n\n<p>Export Code:</p>\n\n<pre><code> public static void Export(string fileName, GridView gv)\n{\n    HttpContext.Current.Response.Clear();\n    HttpContext.Current.Response.AddHeader(\n        \"content-disposition\", string.Format(\"attachment; filename={0}\", fileName));\n    HttpContext.Current.Response.ContentType = \"application/ms-excel\";\n\n    using (StringWriter sw = new StringWriter())\n    {\n        using (HtmlTextWriter htw = new HtmlTextWriter(sw))\n        {\n            //  Create a form to contain the grid\n            Table table = new Table();\n\n            gv.GridLines = GridLines.Both;\n            table.GridLines = gv.GridLines;\n            //table.BackColor = Color.Yellow;\n\n\n\n            //  add the header row to the table\n            if (gv.HeaderRow != null)\n            {\n                GridViewExportUtil.PrepareControlForExport(gv.HeaderRow);\n                table.Rows.Add(gv.HeaderRow);\n\n                //color the header\n                table.Rows[0].BackColor = gv.HeaderStyle.BackColor;\n                table.Rows[0].ForeColor = gv.HeaderStyle.ForeColor;\n            }\n\n            //  add each of the data rows to the table\n            foreach (GridViewRow row in gv.Rows)\n            {\n\n                if (row.Visible == true)\n                {\n                    GridViewExportUtil.PrepareControlForExport(row);\n                    table.Rows.Add(row);\n                }\n            }\n\n            //  color the rows\n            bool altColor = false;\n            for (int i = 1; i &lt; table.Rows.Count; i++)\n            {\n                if (!altColor)\n                {\n                    table.Rows[i].BackColor = gv.RowStyle.BackColor;\n                    altColor = true;\n                }\n                else\n                {\n                    table.Rows[i].BackColor = gv.AlternatingRowStyle.BackColor;\n                    altColor = false;\n                }\n            }\n\n            //  render the table into the htmlwriter\n            table.RenderControl(htw);\n\n            //  render the htmlwriter into the response\n            HttpContext.Current.Response.Write(sw.ToString());\n            HttpContext.Current.Response.End();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["excel","c#-4.0","oledbdataadapter"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13124035,"title":"OleDbDataAdapter.Update returns rows, but no rows added to Excel spreadsheet","body":"<p>I can add rows to my Excel spreadsheet one row at a time, but it is incredibly slow (1 minute for 400 records, even using Prepare). So, I know the Sql is valid and the DataTable is good.</p>\n\n<p>The code that works:</p>\n\n<pre><code>    public void InsertFromDataTable(string strSql, DataTable dtTable, string strTableName)\n    {\n        if (m_oleDbHandler == null)\n        {\n            m_oleDbHandler = new OleDbHandler(m_strConnection);\n        }\n\n        //Do one row at a time since the DataAdapter did not work\n        foreach (DataRow drRow in dtTable.Rows)\n        {\n            OleDbParmCollection cololedbParameters = new OleDbParmCollection();\n            foreach (DataColumn dcColumn in dtTable.Columns)\n            {\n                OleDbParameter odpParameter = new OleDbParameter(\"@\" + dcColumn.ColumnName, drRow[dcColumn.ColumnName]);\n                odpParameter.ParameterName = \"@\" + dcColumn.ColumnName;\n                odpParameter.DbType = OleDbHandler.GetDbType(dcColumn.GetType());\n                odpParameter.Size = dcColumn.MaxLength;\n                odpParameter.SourceColumn = dcColumn.ColumnName;\n\n                cololedbParameters.Add(odpParameter);\n            }\n\n            m_oleDbHandler.ExecuteCommand(strSql, cololedbParameters, true);\n        }\n    }\n}\n</code></pre>\n\n<p>When I try to do the same thing using a DataAdapter, it says it returns 458 rows, but there are no new rows in the spreadsheet. The code that fails:</p>\n\n<pre><code>        //DataAdapter version\n        OleDbParmCollection cololedbParameters = new OleDbParmCollection();\n        foreach (DataColumn dcColumn in dtTable.Columns)\n        {\n            OleDbParameter odpParameter = new OleDbParameter();\n            odpParameter.ParameterName = \"@\" + dcColumn.ColumnName;\n            odpParameter.OleDbType = OleDbHandler.GetOleDbType(dcColumn.GetType());\n            odpParameter.DbType = OleDbHandler.GetDbType(dcColumn.GetType());\n            odpParameter.Size = dcColumn.MaxLength;\n            odpParameter.SourceColumn = dcColumn.ColumnName;\n\n            cololedbParameters.Add(odpParameter);\n        }\n\n        m_oleDbHandler.InsertFromDataTable(strSql, dtTable, cololedbParameters, strTableName);\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>    public int InsertFromDataTable(string strSql, DataTable dtTable, OleDbParmCollection cololeDbParameters, string strTableName)\n    {\n        //Set every row as added so that they will be inserted\n        foreach (DataRow drRow in dtTable.Rows)\n        {\n            drRow.SetAdded();\n        }\n\n        //Update the output table\n        int intRows = -1;\n        try\n        {\n            OleDbCommand oleDbCommand = new OleDbCommand(strSql, OpenConnection());\n\n            foreach (OleDbParameter oleDbParameter in cololeDbParameters)\n            {\n                if (oleDbParameter.Value == null)\n                {\n                    oleDbCommand.Parameters.Add(oleDbParameter.ParameterName, OleDbType.VarChar).Value = DBNull.Value;\n                }\n                else if (string.IsNullOrEmpty(oleDbParameter.Value.ToString()))\n                {\n                    oleDbCommand.Parameters.Add(oleDbParameter.ParameterName, OleDbType.VarChar).Value = DBNull.Value;\n                }\n                else\n                {\n                    oleDbCommand.Parameters.Add(oleDbParameter);\n                }\n            }\n\n            OleDbDataAdapter odaAdapter = new OleDbDataAdapter(new OleDbCommand(\"SELECT * FROM \" + strTableName, OpenConnection()));\n            odaAdapter.InsertCommand = oleDbCommand;\n            odaAdapter.MissingMappingAction = MissingMappingAction.Passthrough;\n            odaAdapter.MissingSchemaAction = MissingSchemaAction.Error;\n            odaAdapter.TableMappings.Add(strTableName, dtTable.TableName);\n\n            foreach (DataColumn dcColumn in dtTable.Columns)\n            {\n                odaAdapter.TableMappings[0].ColumnMappings.Add(dcColumn.ColumnName, dcColumn.ColumnName);\n            }\n\n            intRows = odaAdapter.Update(dtTable);\n        }\n        catch (OleDbException ex)\n        {\n            LogStackTrace();\n            LogToDb.LogException(ex, LogToDb.c_strAppError);\n            LogToDb.LogMessage(\"OleDb error\", \"OleDbHandler.InsertFromDataTable error\", strSql, LogToDb.c_intErrorLevelOleDb);\n            CancelTransactionAndClose();\n            throw;\n        }\n        finally\n        {\n            CloseConnection();\n        }\n\n        return (intRows);\n    }\n</code></pre>\n\n<p>Why would I get intRows = 458, but there are no new rows in the Excel file?</p>\n\n<p><strong>EDIT:</strong> I just did a test to see what happens if I export to a Microsoft Access .mdb (instead of Excel), and the results tell me something. I get 458 blank rows. so, I suspect I am getting 458 blank rows in Excel. So, now the question is why the rows are all blank.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3395,"score":1,"question_id":2368252,"title":"Excel VBA: how to cast a generic control object into a ComboBox object?","body":"<p>I need to cast a generic VBA form control object into a ComboBox object so that I can add items to it. The generic object won't allow me to insert items into my existing lists</p>\n\n<pre><code>Dim ctlCurrent As MSForms.Control\nFor Each ctlCurrent In frmItemInput.Controls\n    If TypeName(ctlCurrent) = \"ComboBox\" Then\n         Dim lbCurrentComboBox As MSForms.ComboBox\n         lbCurrentComboBox = ctlCurrent 'This is where the error occurs, when I try to convert one into another\n\n         ' Adiciona os itens necessários\n         lbCurrentComboBox.AddItem (\"R\")\n         lbCurrentComboBox.AddItem (\"D\")\n    End If\nNext ctlCurrent\n</code></pre>\n\n<p>My problem is: I have tons of ComboBoxes in my form and I need to add the same options for all of them. So I would like to do this progrmatically. </p>\n"},{"tags":["excel","formula","worksheet-function"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":51,"score":-2,"question_id":13095262,"title":"calculating football score in Excel","body":"<p>Hopefully someone can help.\nI am running a prediction league in work.  To help me calculate scores I thought I would use Excel.<br>\nThese are the conditions for my league</p>\n\n<ul>\n<li>Exact score = 3 pts</li>\n<li>Points for correct goal difference = 2pts, i.e. if predicted score is 2-2 and the actual score is 1-1 then goal difference in both case =0 goals, so 2pts should be awarded</li>\n<li>Correct result but wrong score = 1pt (home or away win)</li>\n</ul>\n\n<p>Can't post images so here is a quick mockup </p>\n\n<pre>-  HOME        HOME    AWAY    AWAY        Home    Away    Pts\n-   Norwich     0       0       West Ham    1       1       2\n-   Arsenal     3       1       Southampton 7       2       1\n-   Aston Villa 2       0       Swansea     0       1       0\n-   Fulham      3       0       West Brom   1       1       0\n-   Man Utd     4       0       Wigan       2       0       1\n-   Q.P.R.      0       0       Chelsea     0       0       3\n-   Stoke       1       1       Man City    1       3       0\n-   Sunderland  1       2       Liverpool   1       2       3\n-   Reading     1       3       Tottenham   0       2       2\n-   Everton     2       0       Newcastle   4       1       1</pre>\n"},{"tags":["excel","vba","colors","conditional","formating"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2754,"score":4,"question_id":9773357,"title":"How to get colors made by color scale of conditional formatting of Excel 2012 throught VBA code","body":"<p>I need to know: <strong>how to get colors made by color scale of conditional formatting of Excel 2010 throught VBA code</strong>. Those colors will be subsequently assigned by VBA as chart background according to the following image: </p>\n\n<p><img src=\"http://www.lnkm.cz/Slozka/Example.jpg\" alt=\"www.lnkm.cz/Slozka/Example.jpg\"></p>\n\n<p>I did a research on various web sides and:</p>\n\n<ol>\n<li>Most people advice how to read color of conditional formatting by method \n<code>&lt;Cell&gt;.FormatConditions(index that is active).Interior.ColorIndex</code> \nbut in my case it don’t work because of error “Object doesn’t support this property or method”</li>\n<li>Some people advice to write own computation of colors (based on cells value). I found various ways how to do it, but none of them can compute same colors as was computed previously by excel (same colors as are on previous picture).</li>\n</ol>\n\n<p>So I’m asking:</p>\n\n<ol>\n<li>Is there any way to directly ready colors from cells? (or those colors are not accessible for API)</li>\n<li>Do you know how to compute same colors as excel compute?</li>\n<li>Do you know any other way how to solve my problem?</li>\n</ol>\n\n<p>I believe that it has to work somehow.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13127762,"title":"What is \"keys(0)\" after GetKeyboardState keys(0) in VBA?","body":"<p>I am new to using Windows API functions in VBA and I can't find what the keys(0) exactly does/means.  It is also not in a bracket/parentheses so I do not understand how it works.  Thanks in advance!</p>\n\n<pre><code>Private Declare PtrSafe Function GetKeyboardState Lib \"user32\" _\n(pbKeyState As Byte) As Long\n\nProperty Get Value() As Boolean\n\n    Dim keys(0 To 255) As Byte\n    GetKeyboardState keys(0) '&lt;&lt; Can someone explain what this is doing?\n    Value = keys(VK_NUMLOCK)\n\nEnd Property\n</code></pre>\n"},{"tags":["excel","vba","editor"],"answer_count":15,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":4637,"score":6,"question_id":1164138,"title":"VBA editor auto-deletes spaces at the ends of lines","body":"<p>Is there a way to convince the VBA editor in Excel to stop auto-formatting lines to remove the space at the end when I pause in my typing for a quarter second?</p>\n"},{"tags":["c#","excel","reportviewer","reportviewer2008"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13127442,"title":"ReportViewer Simulate Excel (Dynamic Table/PIVOT table) When Export to Excel","body":"<p>I have a report that have 2 tables, one with grouped rows and a count, and another with all rows,</p>\n\n<p>In a Dynamic Table/PIVOT table in excel, its possible to create a dynamic table and group the rows, so that when you click the grouped rows count, excel will open a new sheet only with the rows that meet the clicked rows groups.</p>\n\n<p>So, my question is, is it possible to make the same effect in the reportviewer when exporting to excel? So that when the user clicks the grouped rows count, it will open a new sheet with only the data regarding that group?</p>\n\n<p>Im not sure if i was clear enough, </p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13127027,"title":"Cascade dropdown update and freeze VBA","body":"<p>I have three combo boxes: <strong>cbo_prefRoom1, cbo_prefRoom2, cbo_prefRoom3</strong>.</p>\n\n<p>On form initialisation <strong>cbo_prefRoom2</strong> and <strong>cbo_prefRoom3</strong> are disabled.</p>\n\n<p>When the user selects an option in <strong>cbo_prefRoom1</strong> then it enables <strong>cbo_prefRoom2</strong>. \nWhen the user selects an option in <strong>cbo_prefRoom2</strong> then it enables <strong>cbo_prefRoom3</strong>.</p>\n\n<p>What I would like to do is add an instance in which if the user selects the option <code>No Preference</code> in <strong>cbo_prefRoom1</strong> then what happens is <strong>cbo_prefRoom2</strong> and <strong>cbo_prefRoom3</strong> are updated with the same value of <code>No Preference</code>. Then <strong>cbo_prefRoom2</strong> and <strong>cbo_prefRoom3</strong> are disabled until the user changes the option of <code>No Preference</code> in <strong>cbo_prefRoom1</strong>.</p>\n\n<p>There is also a second instance of this, if the user selects the option <code>No Preference</code> in <strong>cbo_prefRoom2</strong> then <strong>cbo_prefRoom3</strong> is updated with the same value of <code>No Preference</code> and disabled. Then <strong>cbo_prefRoom3</strong> is disabled until the user changes the option of <code>No Preference</code> in <strong>cbo_prefRoom2</strong>.</p>\n\n<p>How do I go about achieving this? </p>\n\n<pre><code>Private Sub cbo_prefRoom1_Change()\n\n' When user selects an option in cbo_prefRoom1 then cbo_prefRoom2 is enabled\n    With cbo_prefRoom2\n        .Enabled = Len(cbo_prefRoom1.Value) &gt; 0\n            If Not .Enabled Then\n                .ListIndex = -1\n            End If\n    End With\n\nEnd Sub\n\nPrivate Sub cbo_prefRoom2_Change()\n\n' When user selects an option in cbo_prefRoom2 then cbo_prefRoom3 is enabled\n    With cbo_prefRoom3\n        .Enabled = Len(cbo_prefRoom2.Value) &gt; 0\n            If Not .Enabled Then\n                .ListIndex = -1\n            End If\n    End With\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","datetime","date"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":786,"score":1,"question_id":5022864,"title":"date time conversion","body":"<p>I have 40241 as a date value. Which format is this in?</p>\n\n<p>I think it is in seconds past midnight.\nBut I need a formula so that I can work out manually and verify!!</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","vb.net","excel","interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13126053,"title":"Embed Excel 2010 Document in Windows Form","body":"<p>I've been trying to fix this problem the whole day and hope someone here has already figured out how to do this - I'm trying to display an Excel 2010 Worksheet in my Windows Form and did not expect it to be this difficult.</p>\n\n<p>So... From what I've seen online, the best way to do this is via a WebBrowser control - My code for this is SUPER easy:</p>\n\n<pre><code>Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click\n\n    Dim strfilename = Application.StartupPath &amp; \"\\SheetXX.xlsx\"\n    WebBrowser1.Navigate(strfilename, False)\n\nEnd Sub\n</code></pre>\n\n<p>But it pops up a File Download dialog. At first, my problem was that even when I pushed the \"Open\" button, it opened Excel in a separate window. This I managed to fix using <a href=\"http://support.microsoft.com/kb/927009#letmefixit\" rel=\"nofollow\">this registry fix</a>, but it still pops up the dialog before opening it in my webbrowser which my end-users will complain about.</p>\n\n<p>Other solutions online mentioned the Microsoft dsoframer, but that didn't work for me at all either...</p>\n\n<p>Anyone know how to make this work?? Plain and simply, I just want to see the Excel sheet in my windows form.</p>\n\n<p>Thanks!!</p>\n"},{"tags":["excel","latex"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13126139,"title":"Installing/Using Exceltex","body":"<p>I need help installing and using exceltex. </p>\n\n<p>I installed ActivePerl, then according to <a href=\"http://www.physik.uni-freiburg.de/~doerr/exceltex/index.en.html\" rel=\"nofollow\">link</a> I installed Spreadsheet::ParseExcel. Then copied exceltex into <code>/usr/local/bin</code> and exceltex.sty into <code>/usr/local/texlive/2012/texmf/tex/latex/Misc</code> Note: I created Misc folder myself. </p>\n\n<p>Now according to the above link, when I try to run the simple example given in the above link, after creating the latex file, it says: now, run latex, exceltex and latex again. This is the part I don't understand. </p>\n\n<p>Am I supposed to compile my latex file, then run exceltex from <code>/usr/local/bin</code> and then compile latex file again? I tried this and it doesnt work. It compiles, but doesnt give me the result I am looking for. I really appreciate any help/suggestions.</p>\n"},{"tags":["excel","datetime","excel-formula","formula","formulas"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13116935,"title":"Auto Fill \"Missing\" based on two dates values","body":"<p>I have two date columns.</p>\n\n<p>My requirement is: </p>\n\n<blockquote>\n  <p>in the 2nd column word \"Missing\" should be filled if difference\n  between [Today] and [Date in 1st column] is more than two days. Also\n  user may enter some date value in 2nd column. In that case \"Missing\"\n  should not be filled.</p>\n</blockquote>\n\n<p>I can use 1 or more columns for intermediate calculations.</p>\n\n<p>Sample file can be downloaded from <a href=\"https://docs.google.com/open?id=0Bwjl0SErKySTWXM2bGlCNlZJX1U\" rel=\"nofollow\">Link</a>. In that, cell \"B3\" should be auto-filled with \"Missing\" but not cells \"B5\"</p>\n"},{"tags":["vb.net","excel","com"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13040342,"title":"Randomly occuring COM Exceptions when modifying an Excel Worksheet","body":"<p>I am building an application that generates some data and then outputs it to an Excel sheet. Sometimes this sheet is many thousands of lines long, so I use a BackgroundWorker to deal with it (note that I use a progress bar that prevents editing to stop the user from modifying the spreadsheet while it is being generated).</p>\n\n<p>Unfortunately, while this is happening the program is randomly crashing due to COM exceptions. By randomly I mean that the exceptions occur at different times during execution, and sometimes don't occur at all. Here is the code causing the issue, the exceptions are always called on the lines using the <code>sheet</code> variable.</p>\n\n<pre><code>Public Sub modifyCell(ByRef sheet As Worksheet, ByVal row As Integer, ByVal column As Integer, ByRef value As String)\n\n    sheet.Cells(row, column) = value\n\nEnd Sub\n\nPublic Sub colorRange(ByRef sheet As Worksheet, ByVal iRow As Integer, ByVal iCol As Integer, ByVal fRow As Integer, ByVal fCol As Integer, ByVal color As Integer, ByRef type As String)\n\n    If type Is \"Interior\" Then\n        sheet.Range(sheet.Cells(iRow, iCol), sheet.Cells(fRow, fCol)).Interior.ColorIndex = color\n    ElseIf type Is \"Font\" Then\n        sheet.Range(sheet.Cells(iRow, iCol), sheet.Cells(fRow, fCol)).Font.ColorIndex = color\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The exception shows up in different forms including \"Return argument has an invalid type.\", \"Exception from HRESULT: 0x800A03EC\" and a few other HRESULT codes.</p>\n\n<p>Another oddity that might be important - if I catch that exception and then immediately execute the same line, it works. (i.e. the following allows the program to complete successfully)</p>\n\n<pre><code>Try\n    modify sheet code\nCatch ex As Exception\n    identical modify sheet code\nEnd Try\n</code></pre>\n\n<p>I've done quite a bit of hunting around but I cannot figure out how to stop this from happening. The random nature of the exceptions make me think it might be something like the garbage collector which runs at unpredictable times, but I don't know how to go about testing that theory.</p>\n"},{"tags":["excel","ms-office"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":285,"score":0,"question_id":6821255,"title":"Microsoft Excel 2007 \"Find and Replace\"","body":"<p>Microsoft Excel 2007 Find and Replace tool does not produce an error message <code>Microsoft Excel cannot find the data you're searching for</code> when I enter an incorrect number; such as if I had a number range of 1 to 10 and I entered 22 on Find what, then pressing enter or FIND NEXT button - nothing happens <code>NO ERROR MESSAGE</code>. The sheet and/ or workbook are not protected and I have no formatting on the cells what-so-ever. </p>\n\n<p>How do you enable the error message to indicate to someone that the search criteria or data is not on the sheet?</p>\n"},{"tags":["excel","vba","ms-access","excel-vba","access-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13125467,"title":"Adding a format condition in Excel through Access VBA","body":"<p>So currently i got these lines in my code, </p>\n\n<pre><code>.Range(\"C2\").Formula = \"=IF(B2 = \"\"\"\",\" &amp; \"\"\"REQUIRED\"\"\" &amp; \",\" &amp; \"\"\"\"\"\" &amp; \") \"\n.Range(\"C3\").Formula = \"=IF(B3 = \"\"\"\",\" &amp; \"\"\"REQUIRED\"\"\" &amp; \",\" &amp; \"\"\"\"\"\" &amp; \") \"\n</code></pre>\n\n<p>my goal was to add a conditional formatting to it, so if it equal to Required from the range =$C$2:$C$3 turn background red so far ive seen some codes online but none of them seem to apply. I modified some existing code for my purposes by i get an error on xlExpression \"variable not defined\". Can anyone help me?</p>\n\n<pre><code>.Range(\"C2:C3\").Selection.FormatConditions.Delete \n.Range(\"C2:C3\").Selection.FormatConditions.Add TYPE:=xlExpression, Formula1:=\"=(=$C$2:$C$23 = 'REQUIRED')\"\n</code></pre>\n"},{"tags":["sql-server","excel","formatting","openrowset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1202,"score":0,"question_id":9349946,"title":"SQL Server 2005 OPENROWSET insert into Excel - text to number formatting","body":"<p>So it's not a huge deal, but with Google not returning anything more recent (mostly 2007 or so) about it possibly being an Excel driver issue...I came here to ask the question as what I found as an \"answer\" was not acceptable without further research.</p>\n\n<p>My problem:</p>\n\n<p>Writing a dynamic OPENROWSET query clear and insert new data to send off a report to specific users - the base excel report contains some formulas in which it calculates off and sums based off the inserted data and the multiplication formulas seem to work fine, but unless the totals are formatted properly in Excel as \"numbers\" instead of text the sum will not function...</p>\n\n<p>Solution must be free-form based (if there is a solution at all), I don't want to transfer all my code to SSIS...</p>\n\n<p>Update/Insert code:</p>\n\n<pre><code>    SELECT @sqlu = 'UPDATE OPENROWSET(' +\n    '''Microsoft.ACE.OLEDB.12.0'', ' +\n    '''Excel 12.0;Database=' + @File + ';HDR=YES'', ' +\n    '''SELECT * FROM [Base$B1:G601]'')\n    SET \n    col1 = '''', col2 = '''', col3 = '''', col4 = '''', col5 = '''', col6 = '''' '\n\n\n    EXEC (@sqlu)\n\n\n    SELECT @sqli = 'INSERT INTO OPENROWSET(' +\n    '''Microsoft.ACE.OLEDB.12.0'', ' +\n    '''Excel 12.0;Database=' + @File + ';HDR=NO'', ' +\n    '''SELECT * FROM [Base$B1:G2]'')\n\n    SELECT col1, col2, col3, col4, col5, col6\n    FROM [DATABASE].[dbo].tbl_CIM\n    WHERE col1 IN(''' + @area + ''')'\n\n\n    EXEC (@sqli)\n</code></pre>\n\n<p>The second problem and it may not be a problem for now but later - after the insert, it seems to create borders around the results. Is there also a potential way to remove those during the result transfer?</p>\n\n<p>Any help or sources to research if it is a driver issue is appreciated as I could find none.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13090549,"title":"Importing text files to excel - Start a new row everytime a word is encountered","body":"<p>I have a number of text files that I want to import into excel. I want my macro to open a file and when it encounters the word 'PRICE' it places that line in A1. Each line after that will be placed in b1, c1 etc. When the word PRICE is found again, a new row is started and that line is placed in a2 followed by lines in b2, c2 etc. I think I should use Instr. The code below seems to place the lines with PRiCE in new rows but the following lines in the text files don't seem to follow. I think I just need a minor adjustment within the DO while not loop .Any help would be great!</p>\n\n<pre><code>x = 1 'to offset rows for each file\n\n' Loop thru all files in the folder\nFor Each file In folder.Files\n\n' set the starting point to write the data to\nSet cl = ActiveSheet.Cells(x, 1)\n\n' Open the file\nSet FileText = file.OpenAsTextStream(ForReading)\n\n\n\ni = 0 'to offset columsn for each line\n' Read the file one line at a time\nDo While Not FileText.AtEndOfStream\n\n    TextLine = FileText.ReadLine 'read line\n\n    If InStr(TextLine, \"FINEX\") &gt; 0 Then 'find text\n\n    x = x + 1\n    Set cl = ActiveSheet.Cells(x, 1)\n    cl.Offset(, 0).Value = TextLine\n    'i = i + 1\n    'cl.Value = TextLine\n\n    'MsgBox (\"yes\")\n    Else\n     cl.Offset(, i).Value = TextLine 'fill cell\n    i = i + 1\n    End If\nLoop\n\n' Clean up\nFileText.Close\n\nx = x + 1\n\nNext file\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":318,"score":0,"question_id":2565546,"title":"Mass saving xls as csv","body":"<p>here's the trick. gotta convert 'bout 300 files from xls to csv, wrote some simple macro to do it, here's the code:</p>\n\n<pre><code>Dim wb As Workbook\n\nFor Each wb In Application.Workbooks\nwb.Activate\n\n    Rows(\"1:1\").Select\n    Selection.Delete Shift:=xlUp\n    ActiveWorkbook.SaveAs Filename:= _\n        \"C:\\samplepath\\CBM Cennik \" &amp; ActiveWorkbook.Name &amp; \" 2010-04-02.csv\" _\n        , FileFormat:=xlCSV, CreateBackup:=False\nNext wb\n</code></pre>\n\n<p>but it doesn't do exactly what i want - saves file <strong>\"example.xls\"</strong> as <strong>\"example.xls 2010-04-02.csv\"</strong>, what i need is <strong>\"example 2010-04-02.csv\"</strong></p>\n\n<p>need support guys ;)</p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":152,"score":1,"question_id":12284682,"title":"OleDbException. No value given for one or more required parameters","body":"<pre><code>string connString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + Application.StartupPath + \"\\\\a.xlsx\" + \";Extended Properties='Excel 12.0 Xml;HDR=No'\";\n        OleDbConnection conn = new OleDbConnection(connString);\n        OleDbCommand cmd = new OleDbCommand(\"Update [tablenameeee$] SET A1='15'\", conn);\n        conn.Open();\n        cmd.ExecuteNonQuery();\n        conn.Close();\n</code></pre>\n\n<p>i want to access a specific cell in excel , and change its value . but i got the exception</p>\n\n<p>OleDbException. No value given for one or more required parameters.What is the solution ?</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":192,"score":2,"question_id":5183513,"title":"Excel .net component?","body":"<p>I need an excel component for developing which replace for M$ Excel COM component, because i don't want my client install their excel component on the machine any more, but make sure that it support copy, paste and delete cell direct on the document (grid in asp.net).</p>\n\n<p>(open source, free or commercial)</p>\n\n<p>Thanks in advance! </p>\n"},{"tags":["sql","excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12865752,"title":"Use of concatrelated vba excel","body":"<p>I'm having problem using the function concatrelated on a sql statement. I want to obtain as follows:</p>\n\n<p>My data is:</p>\n\n<pre><code>A.CABNRO E01.EXCCEX\n90001 500\n87000 400\n90001 450\n90001 300\n87000 500\n76005\n</code></pre>\n\n<p>I want to obtain:</p>\n\n<pre><code>A.CABNRO NEW FIELD\n90001 500,450,300\n87000 400,500\n76005\n</code></pre>\n\n<p>The following code does not run when I include the statement related with concatrelated. I will be grateful if someone can help me!!!</p>\n\n<pre><code>MYSQL = \"SELECT A.CABFPR, A.CABCIA, A.CABCTR, B.CTRDTR, A.CABLOE, \"\nMYSQL = MYSQL &amp; \"A.CABNRO, A.CABCAR, A.CABFED, A.CABHOD, A.CABFEI, \"\nMYSQL = MYSQL &amp; \"A.CABHOI, A.CABFEF, A.CABHOF, A.CABFEE, A.CABHOE, \"\nMYSQL = MYSQL &amp; \"A.CABCCL, A.CABNEM, A.CABDEM \"\nMYSQL = MYSQL &amp; \"CONCATRELATED(EXCCEX, E01, A.CABNRO=E01.EXCNRO) \"\nMYSQL = MYSQL &amp; \"FROM BDYOBEL.AIPDTA.AIPCAB A \"\nMYSQL = MYSQL &amp; \"LEFT OUTER JOIN BDYOBEL.AIPDTA.AIPCTR B ON A.CABCIA=B.CTRCIA AND A.CABCTR=B.CTRCTR \"\nMYSQL = MYSQL &amp; \"LEFT OUTER JOIN BDYOBEL.AIPDTA.AIPEXC E01 ON A.CABNRO=E01.EXCNRO \"\nMYSQL = MYSQL &amp; \"WHERE A.CABCIA='LOR' AND A.CABFED&gt;=\"\nMYSQL = MYSQL &amp; Chr$(39) &amp; fini &amp; Chr$(39) &amp; \"AND A.CABFED&lt;=\" &amp; Chr$(39) &amp; ffin &amp; Chr$(39)\nMYSQL = MYSQL &amp; \" AND (A.CABCTR='DM' OR A.CABCTR='L1' OR A.CABCTR='L5' OR A.CABCTR='LR') AND A.CABCAR&lt;&gt;'0'\"\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","excel-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13079534,"title":"How to get the squared symbol (²) to display in a string","body":"<p>I'm trying to get <code>²</code> to show in a string. As an example my output should be inside a ActiveX Textbox and should read <code>R² = 50</code>.</p>\n\n<p>I've tried the following two statements: </p>\n\n<pre><code>Selection.Characters.Text = \"R&amp;ChrW(&amp;HB2)&amp;\" = \" &amp; variable\n</code></pre>\n\n<p>but this displays a 0 as the output in the Textbox. And this:</p>\n\n<pre><code>Selection.Characters.Text = \"R² = \" &amp; variable\n</code></pre>\n\n<p>also displays a 0.</p>\n"},{"tags":["excel","graph","charts","schedule","gantt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13122657,"title":"Excel: overlap bars of bar graph tool","body":"<p>I would like to make a bar graph similar to a <a href=\"http://www.mrexcel.com/articles/timeline-chart-in-excel.php\" rel=\"nofollow\">Gantt Chart</a> (see figure)</p>\n\n<p><img src=\"http://i.stack.imgur.com/V4ZWx.png\" alt=\"Gantt chart\"> </p>\n\n<p>but <strong>only showing one row, with every bar overlapped with the others</strong>. I want to do this supposing that I have non-overlapped periods, and the final figure is only one row with several red periods.</p>\n\n<p>How can I do it?</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","types","header","mime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13123912,"title":"Mime type for excel 2007","body":"<p>How can I set the correct MIME type that works with excel 2007?\nright now I have this:</p>\n\n<pre><code>header(\"Content-type: application/vnd.ms-excel; charset=UTF-8\");\n</code></pre>\n\n<p>my browser keeps telling me that is a 97 2003 file, but when I try to open the file with excel 2007, the program shows some warning, I can see the document, but I'm trying to avoid that warning. </p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13121413,"title":"How to display selected range of cells in Textbox1 using VBA code","body":"<p>I am new to <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a></p>\n\n<p>I am facing an issue while trying to display a selected range of cells from excelto an userform textbox, say <code>C1:E14</code></p>\n\n<p>I have used the below code but it's giving me an <code>Runtime error '13' Type Mismatch</code>. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim ActSheet As Worksheet\nDim SelRange As Range\nSet ActSheet = ActiveSheet\nSet SelRange = Selection\nRange(\"TABLE\").Select\nApplication.Goto \"TABLE\"\nUserForm1.TextBox1.Text = Range(\"C1:E14\").Value\n'UserForm1.TextBox1.Text = Range(\"C1:E14\").Select\nEnd Sub\n</code></pre>\n\n<p>If i use <code>.Value</code> i'ts giving the above mentioned error, but is i use <code>.Select \"True\"</code> it is printing in the Userform text box..</p>\n\n<p>Please help me to solve this issue.</p>\n\n<p>Thanks</p>\n"},{"tags":["database","excel","file-upload"],"answer_count":8,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1447,"score":4,"question_id":9148063,"title":"Uploading data from excel file to database using java","body":"<p>I need to upload data in an excel sheet to the database using java.</p>\n\n<p>The database will be oracle.</p>\n\n<p>The excel sheet will be uploaded once in a month by a user using a web application (Spring MVC front end). </p>\n\n<p>The excel sheet will be having thousands of records/rows e.g. around 15000 or more.</p>\n\n<ol>\n<li>What is the fastest way to upload this huge data in database? We are\nusing simple JDBC (Spring's JDBC Template). </li>\n<li>How do we handle transaction sand errors as there can be errors while uploading data in which case the partly uploaded data will be useless?</li>\n<li>We need to able to notify the user of the error so that he can\ncorrect the excel sheet and try again?</li>\n</ol>\n\n<p>Please help/</p>\n"},{"tags":["excel","vba","ms-access","excel-vba","ado"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":125,"score":-1,"question_id":13055393,"title":"What is correct way to set up VBA ADO connection from Excel to Access for multiple users and files?","body":"<p>I have several excel files that are used for entering data. Files are identical in functionality, one for each service center of ours. In the form there is button that launches a macro which transforms data to table format on another sheet which is then later uploaded to Access db.</p>\n\n<p>Everything worked fine on my own computer. Adding new rows, updating existing rows and deleting existing roles. I had used early binding which lead to problems when I moved files to our network drive. I managed to convert files to late binding but then other problems arose.</p>\n\n<p>Most of the time, uploading to Access isn't working, especially when multiple users try to do stuff at the same time. Most common error code is that I am not using updateable query or that this method doesn't support backwards scrolling. I sorry for not reporting actual error codes, but I can't replicate them at the moment. </p>\n\n<p>My connection code is as follows, it is bit of a mix of copy paste code from different examples. </p>\n\n<p>Opening the connection and other prestuff</p>\n\n<pre><code>Sub excel2access()\n\nConst adUseClient = 3  \nConst adUseServer = 2\nConst adLockOptimistic = 3\nConst adOpenKeyset = 1\nConst adOpenDynamic = 2\n\nDim oConn As Object\nDim cmd As Object\nDim rs As Object\nDim r As Long\nDim criteria As String\nDim Rng As Range\n\nSet oConn = CreateObject(\"ADODB.Connection\")\nSet cmd = CreateObject(\"ADODB.Command\")\n\noConn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source= '\" &amp; Range(\"dbpath\").Value &amp; \"\\\" &amp; Range(\"dbfile\").Value &amp; \"' ;\"\n\nSet rs = CreateObject(\"ADODB.Recordset\")\nrs.CursorLocation = adUseClient\nrs.CursorType = adOpenStatic\nrs.LockType = adLockOptimistic\nrs.Open \"Select * from need_rows WHERE service_center = '\" &amp; Range(\"scenter_name\").Value &amp; \"'\", oConn\n\nr = 2 ' the start row in the worksheet\n\nSheets(\"data\").Select\n</code></pre>\n\n<p>This following bit looks through data in excel sheet and tries to find match from recordset found for that service center. If match is not found new record is created and if match is found the old record is updated.</p>\n\n<pre><code>Do While Len(Range(\"A\" &amp; r).Formula) &gt; 0\n    With rs\n        criteria = Range(\"D\" &amp; r).Value\n        .Find \"identifier='\" &amp; criteria &amp; \"'\"\n        If (.EOF = True) Or (.BOF = True) Then\n            .AddNew ' create a new record\n            .Fields(\"service_center\") = Range(\"scenter_name\").Value\n            .Fields(\"product_id\") = Range(\"A\" &amp; r).Value\n            .Fields(\"quantity\") = Range(\"B\" &amp; r).Value\n            .Fields(\"use_date\") = Range(\"C\" &amp; r).Value\n            .Fields(\"identifier\") = Range(\"D\" &amp; r).Value\n            .Fields(\"file_type\") = Range(\"file_type\").Value\n            .Fields(\"use_type\") = Range(\"E\" &amp; r).Value\n            .Fields(\"updated_at\") = Now\n            .Update             \n        Else\n            If .Fields(\"quantity\") &lt;&gt; Range(\"B\" &amp; r).Value Then\n                .Fields(\"quantity\") = Range(\"B\" &amp; r).Value\n                .Fields(\"updated_at\") = Now\n                .Update ' stores the new record\n            End If                      \n        End If\n        .MoveFirst \n    End With\n    r = r + 1 \nLoop\n\nrs.Close\nSet rs = Nothing\nSet oConn = Nothing\n\nMsgBox \"Confirmation message\"\nEnd Sub\n</code></pre>\n\n<p><em>Edit: Based on link by barrowc I changed cursor type to adOpenStatic. I made a test with several users trying to upload data at the same time and everything worked perfectly. Until one user stayed in the file and spent quite a while editing data there and then tried to upload data to db and got following error message:</em> <a href=\"https://dl.dropbox.com/u/3815482/vba_error.jpg\" rel=\"nofollow\">https://dl.dropbox.com/u/3815482/vba_error.jpg</a></p>\n\n<p><em>Again, I am back where I started from.</em></p>\n\n<p>Also, I am open to feedback on my code in general as well.</p>\n\n<p>I am using Office 2010.</p>\n\n<p>Am I doing it wrong? All help is appreciated.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13115444,"title":"How to copy-paste email body from outlook to excel in VBA?","body":"<p>I am trying to create a macro that takes 2 tables from an email body and save it in excel. \n<img src=\"http://i.stack.imgur.com/ySIS4.png\" alt=\"example\"></p>\n\n<p>I read on another site that using vbody would help but when i tried it pastes it in one cell. So is there any easier way of doing this? I am not too sure how to do string manipulation and string parsing and this task seemed simple enough but I just can't seem to get around it.</p>\n\n<p>Any help would be much appreciated.</p>\n"},{"tags":["excel","vba","ms-access","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13123230,"title":"Writing formula into Excel through Access VBA","body":"<p>I want to insert in \"A1\" some text \"ABC\" and the following cell in \"B1\" an <code>if</code> statement. However I get only the first entry \"ABC\" inserted and then an error at <code>FormulaR1C2 \"Object doesn't support this property or method\"</code>. I'm not sure I'm using the <code>R1C2</code> correctly. I was assuming it stood for Row 1 Column 2, can someone help me out. </p>\n\n<pre><code>Dim Excel_App  As Object\nDim strExcel As String\nSet Excel_App = CreateObject(\"Excel.Application\")\nExcel_App.Visible = True\nExcel_App.Workbooks.Add\nWith Excel_App\n .Range(\"A:B\").EntireRow.ColumnWidth = 25\n .Range(\"A2\").EntireRow.Font.FontStyle = \"Bold\"\n .ActiveCell.FormulaR1C1 = \"ABC\"\n  strExcel = \"=IF(A1 = \"\"\"\",\" &amp; \"\"\"EMPTY\"\"\" &amp; \",\" &amp; \"\"\"FILLED\"\"\" &amp; \") \"\n .ActiveCell.FormulaR1C2 = strExcel\nEnd With \n</code></pre>\n"},{"tags":["excel","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13120957,"title":"Using single slicer to control two pivot tables with different data source in Excel","body":"<p>I have a problem with slicer in Excel file. In my Excel file I have two worksheets. In the first one, there is a pivot table taking data from OLAP cube and in the second I have a pivot table taking data from another Excel file. I'd like to have one slicer called \"Organization\" to filter data in both tables. Is it possible?</p>\n\n<p>Kind regards</p>\n"},{"tags":["php","excel","phpexcel","swiftmailer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13094456,"title":"swiftmailer attachment error with excel spreadsheet","body":"<p>I am trying to develop an application that will convert a CSV file to a Excel spreadsheet and then using Swift Mailer attach and mail it. I'm using the PHPexcel library( <a href=\"http://phpexcel.codeplex.com/\" rel=\"nofollow\">http://phpexcel.codeplex.com/</a>) to convert the CSV file to an Excel 2007 format. I've tried to attach the intermediate CSV file (spreadsheet.csv) as well with the same result. Here is some code:</p>\n\n<pre><code> try {\n     $message=   Message::to($address)\n            -&gt;from($address, 'hello')\n            -&gt;subject('Hi ') \n            -&gt;body($body)\n            -&gt;attach(Swift_Attachment::fromPath($attachmentFullPath)) // to csv\n            -&gt;send();\n        return $message-&gt;was_sent();\n\n     } catch \n        echo $e-&gt;getMessage(); //Boring error messages from anything else!\n        }\n</code></pre>\n\n<p>Unfortunately, I am getting the following error. Can anyone tell me what I'm doing wrong, or how to fix this.</p>\n\n<pre><code>Unhandled Exception\nMessage:\nfopen(Content-Type: text/csv; name=spreadsheet.csv\nContent-Transfer-Encoding: base64\nContent-Disposition: attachment; filename=spreadsheet.csv\n\naWQsbmFtZSx0aW1lc3RhbXAsY2l0eSxkaXN0cmljdCxwaG9uZSxmYXgsY29udGFjdCxlbWFpbCxz\ndGFycyxkaWFtb25kcyx1cmwsbGF0aXR1ZGUsbG9uZ2l0dWRlLGdyZWVuX2tleSxncmVlbl9sZWFm\nLHByb3BlcnR5X3R5cGUsdW5pdHMscHJpY2VfcmFuZ2UscmVzZXJ2YXRpb25fbGluZSxzZWFzb25h\n</code></pre>\n\n<p>the stack trace includes:</p>\n\n<pre><code>[function.fopen]: failed to open stream: Invalid argument\nLocation:\n......../swiftmailer/classes/Swift/ByteStream/FileByteStream.php on line 125\n</code></pre>\n\n<p>Thank you very much for looking at it,</p>\n\n<p>Bill.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":63,"score":1,"question_id":12998320,"title":"IF ELSE THEN in Excel","body":"<p>I have this code in Excel's visual basic. I tried without a, b and c and just use Range(\"C2\"), F2, G2, but it doesn't work too. I really don't know why this doesn't work, can someone help me ? :)</p>\n\n<pre><code>Sub pourcentremiseport()\nDim a As Integer\nDim b As Integer\nDim c As Integer\n\na = Range(\"C2\").Value\n\nIf a &lt; 6 Then\n b = 9.6\n c = 0 \n\nElseIf a &gt;= 6 And a &lt; 20 Then\n b = 0\n c = 10\n\nElse\n b = 0\n c = 25\n\n End If\n\n b = Range(\"F2\").Value\n c = Range(\"G2\").Value\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13121624,"title":"list distinct values in excel","body":"<p><em><strong>This question is related to</em></strong> <a href=\"http://stackoverflow.com/questions/13112163/do-sum-filter-by-date\"><strong><em>this question</em></strong></a>.</p>\n\n<p>I have data as below.</p>\n\n<pre><code> Col A\n22-Oct-12\n22-Oct-12\n22-Oct-12\n23-Oct-12\n23-Oct-12\n23-Oct-12\n23-Oct-12\n23-Oct-12\n23-Oct-12\n24-Oct-12\n24-Oct-12\n24-Oct-12\n</code></pre>\n\n<p>What I want is find the unique values in column B so that output would be as below.</p>\n\n<pre><code> Col A\n22-Oct-12\n23-Oct-12\n24-Oct-12\n</code></pre>\n\n<p>I tried with <code>=IF(COUNTIF(A$1:A1,A1)=1,A1,\"\")</code> but the problem is that I get <code>22-Oct-12</code> infront of first occurrence of <code>22-Oct-12</code>, <code>23-Oct-12</code> infront of first occurrence of <code>23-Oct-12</code>. Output is shown as below.</p>\n\n<pre><code> Col A       Col B\n22-Oct-12   22-Oct-12\n22-Oct-12   \n22-Oct-12   \n23-Oct-12   23-Oct-12\n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n24-Oct-12   24-Oct-12\n24-Oct-12   \n24-Oct-12   \n</code></pre>\n\n<p><strong>I don't want output like this. What I want is as below.</strong></p>\n\n<pre><code> Col A       Col B\n22-Oct-12   22-Oct-12\n22-Oct-12   23-Oct-12\n22-Oct-12   24-Oct-12\n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n24-Oct-12   \n24-Oct-12   \n24-Oct-12   \n</code></pre>\n\n<h2>OR</h2>\n\n<pre><code> Col A      Col B          Col C\n22-Oct-12   22-Oct-12   22-Oct-12\n22-Oct-12               23-Oct-12\n22-Oct-12               24-Oct-12\n23-Oct-12   23-Oct-12\n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n23-Oct-12   \n24-Oct-12   24-Oct-12\n24-Oct-12   \n24-Oct-12   \n</code></pre>\n\n<p><em><strong>Note :</em></strong> I can do this by MACRO, however I don't want to use MACRO. I want to get this done by use of excel functions.</p>\n\n<p>Also, I could do above as per <a href=\"http://superuser.com/questions/49614/how-do-i-get-the-distinct-values-in-a-column-in-excel\">this answer</a>, however I don't want to get done manually.</p>\n\n<p>Everything by pre-defined excel function. NO MACRO or NO MANUAL WORK.</p>\n"},{"tags":["c++","excel","c++builder","borland"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1905,"score":4,"question_id":310031,"title":"Open a Specified File in Excel from a GUI - Borland C++","body":"<p>I am using Borland Builder C++ 2009. I want to add a button to a form that allows the user to open a file in Excel that I specify. I can't think of how to do this. I know how to link with other code and executables -- is there a Microsoft Excel executable that I could use? How could I specify the file then? Any hints on this, or at least a place to look online, would be greatly appreciated.</p>\n"},{"tags":["excel","excel-2007","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13112163,"title":"do sum filter by date","body":"<p>In my business what I do is provide a book of 25 coupon. If customer buys anything (from special people say Person A, Person B, etc to whom I give coupon), Person A gives one coupon to the customer. What I am doing is maintaining database of the same in excel. First column have coupon code. Then Date on which I took details. Then Sold column where I put daily details of sold coupons. Then I have Remaining coupon column and finally the total coupon left from the respective coupon book</p>\n\n<p>Data looks like below.</p>\n\n<pre><code>Coupon #    Date    Sold    Remaining   Starting Day Coupon Counter\nCoupon A    22-Oct-12   22  3   25\nCoupon B    22-Oct-12   16  9   25\nCoupon C    22-Oct-12   24  1   25\nCoupon A    23-Oct-12   3   0   3\nCoupon B    23-Oct-12   9   0   9\nCoupon C    23-Oct-12   1   0   1\nCoupon D    23-Oct-12   5   20  25\nCoupon E    23-Oct-12   8   17  25\nCoupon F    23-Oct-12   2   23  25\nCoupon D    24-Oct-12   20  0   20\nCoupon E    24-Oct-12   17  0   17\nCoupon F    24-Oct-12   23  0   23\n</code></pre>\n\n<p>What I want is <strong>same data</strong> for the respective date. Output I am looking is as below.</p>\n\n<pre><code>Date    Sold    Remaining   Starting Day Coupon Counter\n22-Oct-12   62  13  75\n23-Oct-12   28  60  88\n24-Oct-12   60  0   60\n</code></pre>\n\n<p>Any idea to get this done? I know how to get sum, but not sure how to filter it by any stuff.</p>\n\n<h2>Edit 1</h2>\n\n<p>I know thiis can be done using Macro, however I want to use pre-defined function available in excel.</p>\n\n<p>Any idea/ suggestions how to get this done?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13068090,"title":"How to get current directory name in macros programming?","body":"<p>I need to know how can i get current directory variable in macros programming. I am saving a file on desktop like this : C:\\Users\\deadlock\\Desktop\\data.htm. Is is possible to replace the C:\\Users\\deadlock\\Desktop\\ with the current directly variable?   </p>\n\n<p>Here is my small piece of code:  </p>\n\n<pre><code> ActiveWorkbook.ShowPivotChartActiveFields = True\nWith ActiveWorkbook.PublishObjects.Add(xlSourceSheet, _\n    \"C:\\Users\\deadlock\\Desktop\\data.htm\", \"Sheet1\", \"\", xlHtmlStatic, \"data_9438\", \"\")\n    .Publish (True)\n    .AutoRepublish = False\n</code></pre>\n\n<p>Any Code-snippet will highly be appreciated.</p>\n\n<p>Thanks in advance.. </p>\n"},{"tags":["c#","excel","openxml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13120146,"title":"Setting Excel spreadsheet column properties issue","body":"<p>I'm trying to set up default column width in Excel spreadsheet using OpenXML framework and as a result I've got broken file. Here is code</p>\n\n<pre><code>private void initSpreadsheetDocument()\n{\n    // Add a WorkbookPart to the spreadsheet document.\n    WorkbookPart workbookpart = spreadsheetDocument.AddWorkbookPart();\n    workbookpart.Workbook = new Workbook();\n\n    var sheetData = new SheetData();\n    var properties = new SheetFormatProperties { DefaultColumnWidth = 25D };\n\n    Worksheet worksheet = new Worksheet();\n    worksheet.AppendChild(sheetData);\n\n    // here is line of code that corrupt file\n    // without it - file is being generated properly\n    worksheet.AppendChild(properties);  ![enter image description here][1]\n\n    // Add a WorksheetPart to the WorkbookPart.\n    WorksheetPart worksheetPart = workbookpart.AddNewPart&lt;WorksheetPart&gt;();\n    worksheetPart.Worksheet = worksheet;\n\n    // Init sheets\n    sheetsStorage = new Sheets();\n\n    defaultSheet = new Sheet();\n    defaultSheet.Id = spreadsheetDocument.WorkbookPart.GetIdOfPart(worksheetPart);\n    defaultSheet.SheetId = 1;\n    defaultSheet.Name = DEFAULT_SHEET_NAME;\n\n    sheetsStorage.AppendChild(defaultSheet);\n\n    spreadsheetDocument.WorkbookPart.Workbook.AppendChild(sheetsStorage);\n    spreadsheetDocument.WorkbookPart.Workbook.Save();\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/NwLYA.png\" rel=\"nofollow\">here</a> is error screenshot</p>\n\n<p>I was trying to use \"Append\" vs \"AppendChild\" but result was the same</p>\n\n<p>Does anybody has a point of view how to sort it out?</p>\n"},{"tags":["c#","excel","com"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1214,"score":1,"question_id":7271771,"title":"Merging multiple excel files into one","body":"<p>Here's the problem, I have several excel files that are generated, each has 1 tab (but that's not to say some won't have more in the future).</p>\n\n<p>What I need to write, is a process that can open each file, and copy all of it's worksheets (tabs) into a new file.  </p>\n\n<p>In the end, that new file should contain the worksheets of all the other files.</p>\n\n<p>Currently, I have created the following to accomplish converting between excel formats.</p>\n\n<p>I'm not too sure where to go from here, I don't have any of my sources I used to create this... and am not too sure on the object model (in order to copy the tabs to a new file) or the issues I'll face with com and making sure I keep everything cleaned up.</p>\n\n<pre><code>        object excelApplication = null;\n        object workbook = null;\n        object workbooks = null;\n\n        try\n        {\n            // Get the Remote Type\n            var excelType = Type.GetTypeFromProgID(\"Excel.Application\", Properties.Settings.Default.ExcelServer, true);\n\n            // Instantiate the type\n            excelApplication = Activator.CreateInstance(excelType);\n\n            // Turn off Prompts\n            excelApplication.GetType().InvokeMember(\n                \"DisplayAlerts\",\n                BindingFlags.SetProperty,\n                null,\n                excelApplication,\n                new Object[] { false });\n\n            // Get a reference to the workbooks object\n            workbooks = excelApplication.GetType().InvokeMember(\n                \"Workbooks\",\n                BindingFlags.GetProperty,\n                null,\n                excelApplication,\n                null);\n\n            // Open the input file\n            workbook = workbooks.GetType().InvokeMember(\n                \"Open\",\n                BindingFlags.InvokeMethod,\n                null,\n                workbooks,\n                new object[] { inputFilePath });\n\n            // If overwrite is turned off, and the file exist, the save as line will throw an error\n            if (File.Exists(outputFilePath) &amp;&amp; overwriteIfExists)\n            {\n                File.Delete(outputFilePath);\n            }\n\n            // Save the workbook\n            workbook.GetType().InvokeMember(\n                \"SaveAs\",\n                BindingFlags.InvokeMethod,\n                null,\n                workbook,\n                new object[] { outputFilePath, saveAsFileFormat, null, null, null, null, 1, null, null, null, null, null });\n        }\n        finally\n        {\n            // Cleanup all created COM objects\n            if (workbook != null)\n            {\n                workbook.GetType().InvokeMember(\n                    \"Close\",\n                    BindingFlags.InvokeMethod,\n                    null,\n                    workbook,\n                    null);\n                Marshal.ReleaseComObject(workbook);\n                workbook = null;\n            }\n\n            if (workbooks != null)\n            {\n                Marshal.ReleaseComObject(workbooks);\n                workbooks = null;\n            }\n\n            if (excelApplication != null)\n            {\n                excelApplication.GetType().InvokeMember(\n                    \"Quit\",\n                    BindingFlags.InvokeMethod,\n                    null,\n                    excelApplication,\n                    null);\n                Marshal.ReleaseComObject(excelApplication);\n                excelApplication = null;\n            }\n        }\n</code></pre>\n\n<p>EDIT: This code is nearly working, the issue is on the line that should actually perform the copy...</p>\n\n<pre><code>    public byte[] MergeFiles(FileFormat saveAsFileFormat, List&lt;byte[]&gt; inputFileBytesList)\n    {\n        var outputFilePath = Path.Combine(Properties.Settings.Default.WorkingFolder, Guid.NewGuid() + \".target.xls\");\n\n        Impersonate(\n            Properties.Settings.Default.ImpersonationUser.Decrypt(),\n            Properties.Settings.Default.ImpersonationDomain,\n            Properties.Settings.Default.ImpersonationPassword.Decrypt()\n        );\n\n        var convertedFileList = new List&lt;string&gt;();\n        foreach (var inputFileBytes in inputFileBytesList)\n        {\n            var inputFileExtension = GetExtension(inputFileBytes);\n            var inputFilePath = Path.Combine(Properties.Settings.Default.WorkingFolder, Guid.NewGuid() + inputFileExtension);\n            var convertedFileBytes = SaveAs(saveAsFileFormat, inputFileBytes);\n            File.WriteAllBytes(inputFilePath, convertedFileBytes);\n            convertedFileList.Add(inputFilePath);\n        }\n\n        // Target Excel File\n        object targetExcelApplication = null;\n        object targetWorkbook = null;\n        object targetWorkbooks = null;\n        object targetWorksheets = null;\n        object targetWorksheet = null;\n\n        try\n        {\n            // Get the Remote Type\n            var excelType = Type.GetTypeFromProgID(\"Excel.Application\", Properties.Settings.Default.ExcelServer, true);\n\n            // Instantiate the type\n            targetExcelApplication = Activator.CreateInstance(excelType);\n\n            // Turn off Prompts\n            targetExcelApplication.GetType().InvokeMember(\n                \"DisplayAlerts\",\n                BindingFlags.SetProperty,\n                null,\n                targetExcelApplication,\n                new Object[] { false });\n\n            // Get a reference to the workbooks object\n            targetWorkbooks = targetExcelApplication.GetType().InvokeMember(\n                \"Workbooks\",\n                BindingFlags.GetProperty,\n                null,\n                targetExcelApplication,\n                null);\n\n            // Create a workbook to add the sheets to\n            targetWorkbook = targetWorkbooks.GetType().InvokeMember(\n                \"Add\",\n                BindingFlags.InvokeMethod,\n                null,\n                targetWorkbooks,\n                new object[] { 1 });\n\n            // Get a reference to the worksheets object\n            targetWorksheets = targetWorkbook.GetType().InvokeMember(\n                \"Sheets\",\n                BindingFlags.GetProperty,\n                null,\n                targetExcelApplication,\n                null\n                );\n\n            foreach (var inputFilePath in convertedFileList)\n            {\n                // Open each File, grabbing all tabs\n                object sourceExcelApplication = null;\n                object sourceWorkbooks = null;\n                object sourceWorkbook = null;\n                object sourceWorksheets = null;\n\n                try\n                {\n                    // Instantiate the type\n                    sourceExcelApplication = Activator.CreateInstance(excelType);\n\n                    // Turn off Prompts\n                    sourceExcelApplication.GetType().InvokeMember(\n                        \"DisplayAlerts\",\n                        BindingFlags.SetProperty,\n                        null,\n                        sourceExcelApplication,\n                        new Object[] {false});\n\n                    // Get a reference to the workbooks object\n                    sourceWorkbooks = sourceExcelApplication.GetType().InvokeMember(\n                        \"Workbooks\",\n                        BindingFlags.GetProperty,\n                        null,\n                        sourceExcelApplication,\n                        null);\n\n                    // Open the input file\n                    sourceWorkbook = sourceWorkbooks.GetType().InvokeMember(\n                        \"Open\",\n                        BindingFlags.InvokeMethod,\n                        null,\n                        sourceWorkbooks,\n                        new object[] {inputFilePath});\n\n                    // Get a reference to the worksheets object\n                    sourceWorksheets = sourceWorkbook.GetType().InvokeMember(\n                        \"Sheets\",\n                        BindingFlags.GetProperty,\n                        null,\n                        sourceExcelApplication,\n                        null);\n\n                    var sourceSheetCount = (int)(sourceWorksheets.GetType().InvokeMember(\n                        \"Count\",\n                        BindingFlags.GetProperty,\n                        null,\n                        sourceWorksheets,\n                        null));\n\n                    for (var i = 1; i &lt;= sourceSheetCount; i++)\n                    {\n                        var targetSheetCount = (int)(targetWorksheets.GetType().InvokeMember(\n                            \"Count\",\n                            BindingFlags.GetProperty,\n                            null,\n                            targetWorksheets,\n                            null));\n\n                        var sourceWorksheet = sourceWorksheets.GetType().InvokeMember(\n                            \"Item\",\n                            BindingFlags.GetProperty,\n                            null,\n                            sourceWorksheets,\n                            new Object[] { i });\n\n                        targetWorksheet = targetWorksheets.GetType().InvokeMember(\n                            \"Item\",\n                            BindingFlags.GetProperty,\n                            null,\n                            targetWorksheets,\n                            new Object[] { targetSheetCount });\n\n                        // TODO: Copy into target file\n\n                        sourceWorksheet.GetType().InvokeMember(\n                            \"Copy\",\n                            BindingFlags.InvokeMethod,\n                            null,\n                            sourceWorksheet,\n                            new[] { Type.Missing, targetWorksheet }\n                            );\n\n                        if (sourceWorksheet != null)\n                        {\n                            Marshal.ReleaseComObject(sourceWorksheet);\n                            sourceWorksheet = null;\n                        }\n                    }\n                }\n                finally\n                {\n                    // Cleanup all created COM objects\n                    if (sourceWorksheets != null)\n                    {\n                        Marshal.ReleaseComObject(sourceWorksheets);\n                        sourceWorksheets = null;\n                    }\n\n                    if (sourceWorkbook != null)\n                    {\n                        sourceWorkbook.GetType().InvokeMember(\n                            \"Close\",\n                            BindingFlags.InvokeMethod,\n                            null,\n                            sourceWorkbook,\n                            null);\n                        Marshal.ReleaseComObject(sourceWorkbook);\n                        sourceWorkbook = null;\n                    }\n\n                    if (sourceWorkbooks != null)\n                    {\n                        Marshal.ReleaseComObject(sourceWorkbooks);\n                        sourceWorkbooks = null;\n                    }\n\n                    if (sourceExcelApplication != null)\n                    {\n                        sourceExcelApplication.GetType().InvokeMember(\n                            \"Quit\",\n                            BindingFlags.InvokeMethod,\n                            null,\n                            sourceExcelApplication,\n                            null);\n                        Marshal.ReleaseComObject(sourceExcelApplication);\n                        sourceExcelApplication = null;\n                    }\n                }\n            }\n\n            // If overwrite is turned off, and the file exist, the save as line will throw an error\n            if (File.Exists(outputFilePath))\n            {\n                File.Delete(outputFilePath);\n            }\n\n            // Save the workbook\n            targetWorkbook.GetType().InvokeMember(\n                \"SaveAs\",\n                BindingFlags.InvokeMethod,\n                null,\n                targetWorkbook,\n                new object[] { outputFilePath, saveAsFileFormat, null, null, null, null, 1, null, null, null, null, null });\n        }\n        finally\n        {\n            // Cleanup all created COM objects\n            if (targetWorksheets != null)\n            {\n                Marshal.ReleaseComObject(targetWorksheets);\n                targetWorksheets = null;\n            }\n\n            if (targetWorkbook != null)\n            {\n                targetWorkbook.GetType().InvokeMember(\n                    \"Close\",\n                    BindingFlags.InvokeMethod,\n                    null,\n                    targetWorkbook,\n                    null);\n                Marshal.ReleaseComObject(targetWorkbook);\n                targetWorkbook = null;\n            }\n\n            if (targetWorkbooks != null)\n            {\n                Marshal.ReleaseComObject(targetWorkbooks);\n                targetWorkbooks = null;\n            }\n\n            if (targetExcelApplication != null)\n            {\n                targetExcelApplication.GetType().InvokeMember(\n                    \"Quit\",\n                    BindingFlags.InvokeMethod,\n                    null,\n                    targetExcelApplication,\n                    null);\n                Marshal.ReleaseComObject(targetExcelApplication);\n                targetExcelApplication = null;\n            }\n        }\n\n        // Read target file bytes\n        var resultBytes = (File.Exists(outputFilePath))\n            ? File.ReadAllBytes(outputFilePath)\n            : new byte[] { };\n\n        // Delete working files\n        if (File.Exists(outputFilePath))\n            File.Delete(outputFilePath);\n        foreach (var inputFilePath in convertedFileList.Where(File.Exists))\n        {\n            File.Delete(inputFilePath);\n        }\n\n        Repersonate();\n\n        // Return result\n        return resultBytes;\n    }\n</code></pre>\n\n<p>I get the error <em>System.Runtime.InteropServices.COMException: Copy method of Worksheet class failed</em>, which doesn't help much...I don't know why it failed...</p>\n"},{"tags":["excel","pdf","data","screen-scraping"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3561,"score":3,"question_id":3147803,"title":"Data Scraping from PDF and Excel","body":"<p>I am doing a little data scraping, There are 3 types of file from which i am scraping data.<br/><br/>\n 1- HTML<br/>\n 2- PDF<br/>\n 3- Excel(xls)<br/>\n<br/>\nFor HTML i am comfortable, i am using HTML Agility for that.<br/><br/></p>\n\n<p>For PDF and excel i need suggestions from anyone. <br/><br/></p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","excel","apache-poi","poi-hssf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13120819,"title":"How to set integer value in the excel sheet created through java?","body":"<p>When I create excel sheet through java ,the column which has <code>number</code> datatype in the oracle table, get converted to <code>text</code> format in excel.I want it to remain in the <code>number</code> format.Below is my code snippet for excel creation.</p>\n\n<pre><code>    public boolean prepareExcelFilefromQuery(String chanType,\n                    Collection&lt;List&gt; queryDataRowWise, HttpServletResponse response)\n\n            {\n                List&lt;String&gt; queryDataColWise;\n                HSSFRow row = null;\n                HSSFCell cell = null;\n                Integer rowCounter = 0;\n                Integer colCounter;\n                boolean success = false;\n                try {\n\n                    Iterator&lt;List&gt; rowIterator = queryDataRowWise.iterator();\n                    HSSFWorkbook workbook = new HSSFWorkbook();\n                    HSSFSheet sheet = workbook.createSheet(chanType + \" Report\");\n                    System.out.println(\"First row/...\" + sheet.getFirstRowNum());\n                    while (rowIterator.hasNext()) {\n                        colCounter = 0;\n\n                        queryDataColWise = (List) rowIterator.next();\n                        Iterator colIterator = queryDataColWise.iterator();\n\n                        row = sheet.createRow(rowCounter++);\n                        while (colIterator.hasNext()) {\n                            cell = row.createCell(colCounter++);\n                            Object o = colIterator.next();\n\n                            if (o instanceof java.lang.String) {\n                                String s = (String) o;\n                                cell.setCellValue(s);\n                            } else if (o instanceof java.lang.Double) {\n                                Double d = (Double) o;\n                                cell.setCellValue(d);\n                            } else if (o instanceof java.lang.Integer) {\n                                Integer i = (Integer) o;\n                                 cell.setCellType(cell.CELL_TYPE_NUMERIC);\n                                cell.setCellValue(i);\n                            } else if (o instanceof java.util.Date) {\n                                Date date = (Date) o;\n\n                                SimpleDateFormat FORMATTER;\n\n                                FORMATTER = new SimpleDateFormat(\"MM/dd/yyyy\");\n                                String date11 = FORMATTER.format(date);\n                                HSSFCellStyle cellStyle = workbook.createCellStyle();\n                                cellStyle.setDataFormat(HSSFDataFormat\n                                        .getBuiltinFormat(\"m/d/yy\"));\n                                cell.setCellStyle(cellStyle);\n                                cell.setCellValue(FORMATTER.parse(date11));\n                            }\n                        }\n                    }\n\n                    workbook.write(response.getOutputStream());\n                    success = true;\n\n                } catch (Exception e) {\n                    logger.debug(\n                            \"Exception caught in prepareExcelFilefromQuery class \", e);\n                    System.out\n                            .println(\"Exception caught in prepareExcelFilefromQuery class \");\n                    e.printStackTrace();\n\n                } \n                }\n                return success;\n            }\n</code></pre>\n"},{"tags":["excel","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13119296,"title":"SSIS deployment issue","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13088974/running-an-ssis-package-using-dtexec\">Running an SSIS Package using dtexec</a>  </p>\n</blockquote>\n\n\n\n<p>My SSIS package is working fine when I'm running it on my local system. My Package copies a blank template excel file which has only headers, to another place, and then populates this copy with data from the DB. However, when i place the package and config on the server, and schedule an SQL server job on it, it's throwing errors as follows :</p>\n\n<pre><code>Executed as user: CIQHYD\\sqladmindev. \nMicrosoft (R) SQL Server Execute Package UtilityVersion 10.0.4000.0 for 64-bitCopyright (C) Microsoft Corp 1984-2005. All rights reserved.\nStarted: 3:24:28 PM\nError: 2012-10-29 15:24:28.34 \n  Code: 0xC001401E \n  Source: GICSReport Connection manager \"GICSReport.xls\" \n  Description: The file name \"\\\\HYD-FILESVR\\Departments\\Technology\\GICSReports\\Dev\\GICSReport.xls\" specified in the connection was not valid.\nEnd Error\nError: 2012-10-29 15:24:28.34 \n  Code: 0xC001401D \n  Source: GICSReport \n  Description: Connection \"GICSReport.xls\" failed validation.\nEnd Error\nDTExec: The package execution returned DTSER_FAILURE (1).\nStarted: 3:24:28 PM\nFinished: 3:24:28 PM\nlapsed: 0.234 seconds \n[SQLSTATE 42000] (Error 50000). The step failed.\n</code></pre>\n\n<p>When I delete the file at the Destination folder, i get this error :</p>\n\n<pre><code>Executed as user: CIQHYD\\sqladmindev. \nMicrosoft (R) SQL Server Execute Package Utility\nVersion 10.0.4000.0 for 64-bitCopyright (C) Microsoft Corp 1984-2005. All rights reserved.\nStarted: 3:15:38 PM\nError: 2012-10-29 15:15:38.57 \n  Code: 0xC001401E \n  Source: GICSReport Connection manager \"GICStemplate.xls\" \n  Description: The file name \"\\\\HYD-FILESVR\\Departments\\Technology\\GICSAutomationTemplate\\GICStemplate.xls\" specified in the connection was not valid.\nEnd Error\nError: 2012-10-29 15:15:38.57 \n  Code: 0xC0202070 \n  Source: GICSReport Connection manager \"GICStemplate.xls\" Description: The file name property is not valid. The file name is a device or contains invalid characters.\nEnd Error\nError: 2012-10-29 15:15:38.57 \n  Code: 0xC0029163 \n  Source: Copy Template To Destination File System Task \n  Description: File or directory \"\\\\HYD-FILESVR\\Departments\\Technology\\GICSAutomationTemplate\\GICStemplate.xls\" represented by connection \"GICStemplate.xls\" does not exist.\nEnd Error\nError: 2012-10-29 15:15:38.57 \n  Code: 0xC002F30A \n  Source: Copy Template To Destination File System Task \n  Description: The source is empty.\nEnd Error\nDTExec: The package execution returned DTSER_FAILURE (1).\nStarted: 3:15:38 PM\nFinished: 3:15:38 PM\nElapsed: 0.344 seconds [SQLSTATE 42000] (Error 50000). The step failed.\n</code></pre>\n"},{"tags":["c#","excel"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13120184,"title":"How to create excel in my c# application if msoffice is not installed","body":"<p>Hi I am creating an application through which i need to create an excel. I have added Microsoft Excel 12.Object Library as Reference to application. But my server didnt get Msoffice Installed in it. So how can i create Excel in that server.</p>\n"},{"tags":["excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13112877,"title":"Get column by finding value in the row","body":"<p>In Excel, I've looked into hlookup, vlookup, match, index, but none of these functions do following:</p>\n\n<p>I need to find a text value in A1:Z1 and get the column of it. For example, I found the value in F1 , then I want a result F:F.</p>\n\n<p>EDIT: This is the function I want it to be added to : </p>\n\n<p>=COUNTIFS(Source!B:B;Result!C3;Source!AT:AT;Result!$D$2)</p>\n\n<p>I need the Source!B:B and alternatively Source!AT:AT be a search function that looks for a specific value in my table row and column in different sheet (Source).</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":373,"score":3,"question_id":8224247,"title":"Hiding the formula bar in Excel for a specific file","body":"<p>I would like to hide the formula bar in a specific Excel file and only in this file. I know we can do it with VBA (Application.DisplayFormulaBar = False) but I am wondering if there is another solution like editing the CustomUI file.</p>\n\n<p>Usually I edit the CustomUI file for hiding ribbon, adding custom tabs, ... It would be nice if we can hide the formula bar in this way.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","ms-office","vsta"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":371,"score":1,"question_id":257096,"title":"Is Visual Studio Tools for Applications part of Office 2007?","body":"<p>The VSTO bit I understand. Visual Studio has the project templates to get you started with creating nice .NET based add-ins.</p>\n\n<p>But where is VSTA?  I installed the SDK but it seems to be gears towards adding extensibility to your own applications.</p>\n\n<p>I had thought that VSTA was like the new VBA for Office 2007.  Infopath 2007 seems to be VSTA enabled but I cannot seem to find where Excel 2007 is also VSTA enabled.</p>\n\n<p>Am I missing something ?</p>\n"},{"tags":[".net","vb.net","sql-server-2008","excel","stored-procedures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":500,"score":0,"question_id":12404809,"title":"How to import data from Excel into SQL Server 2008 ","body":"<p>I actually want to import data from an Excel file into an existing database (I use SQL Server 2008 and VB.net) using a T-SQL stored procedure called from my VB.NET app.</p>\n\n<p>So is there a possibility to do that just by coding (without using any other tool SSIS or the SS import and export wizard), if yes can somebody give me just a simple sample of code.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":2351,"score":-1,"question_id":2198455,"title":"How do you add two COUNTIF equations together?","body":"<p>How do i add two COUNTIF equations together to get a total</p>\n"},{"tags":["c#","excel","merge","office-interop"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12985554,"title":"Merging different worksheets of workbook","body":"<p>The whole app works fine, when merging single tabbed workbooks. But then I added functionality to also merge all worksheets in a book, before merging the book with another.</p>\n\n<p>It merges them (tested on a single multitabbed wbook), but at some point starts to mess it up.\nFor example</p>\n\n<p>outcome:</p>\n\n<ul>\n<li>sheet1\n-empty lines- sheet2\n-empty lines- sheet3+ half of sheet4\n-empty lines- sheet2 again not all, with some values missing</li>\n</ul>\n\n<p>etc...</p>\n\n<p>Im not sure if is the code that needs something extra, or problems in certain worksheets.</p>\n\n<p>Heres the crucial parts:</p>\n\n<pre><code>for (int i = 0; i &lt; pathList.Count; i++)\n{\n     List&lt;string&gt; Sheet = GetSheetName(path);\n     filename = GetFileName(path);\n     MyConnection = new System.Data.OleDb.OleDbConnection(\"provider=Microsoft.Jet.OLEDB.4.0;Data Source='\" + path + \"';Extended Properties='Excel 8.0;IMEX=1;'\");\n\n\n     foreach (string SheetName in Sheet)\n     {\n        //OLEDB SECTION ***********************************************\n        MyCommand = new System.Data.OleDb.OleDbDataAdapter(\"select * from [\" +  SheetName + \"$]\", MyConnection);\n        MyCommand.TableMappings.Add(pathList.Count.ToString(), filename);\n        MyCommand.Fill(table);\n        lstTable.Add(table);\n        MyConnection.Close();\n        MyCommand.Dispose();\n        //*************************************************************\n      }\n\n}\n</code></pre>\n\n<p>and the getSheetNames</p>\n\n<pre><code>List&lt;string&gt; GetSheetName(string path)\n{\n    Microsoft.Office.Interop.Excel.Application xlApp;\n    Microsoft.Office.Interop.Excel.Workbook xlWorkBook;\n    Microsoft.Office.Interop.Excel.Worksheet xlWorkSheet;\n    List&lt;string&gt; names = new List&lt;string&gt;();\n\n    xlApp = new Microsoft.Office.Interop.Excel.Application();\n    xlWorkBook = xlApp.Workbooks.Open(path, 0, true, 5, \"\", \"\", true,        Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\n\n\n\n    foreach (Microsoft.Office.Interop.Excel.Worksheet i in xlWorkBook.Worksheets)\n     if (i.UsedRange.Count &gt; 0)\n            names.Add(i.Name);\n\n\n\n  return names ;\n  }\n</code></pre>\n"},{"tags":["excel","excel-formula","formula"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1874,"score":1,"question_id":6867070,"title":"Counting number of rows with text values","body":"<p>I am trying to count the number of rows in a spreadsheet which contain at least one non blank value over a few columns: i.e.</p>\n\n<pre><code>row 1 has a text value in column A\nrow 2 has a text value in column B\nrow 3 has a text value in column C\nrow 4 has no values in A, B or C\n</code></pre>\n\n<p>the formula would equate to 3 because rows 1, 2 &amp; 3 have a text value in at least one column. Similarly if row 1 had a text value in each column (A, B &amp; C) this would be counted as 1.</p>\n"},{"tags":["asp.net","excel","ms-access","datatable","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13108388,"title":"DataTable to .accdb database","body":"<p>I am populating a DataSet with data from an excel sheet. I now need to insert this data into a table in an Access database that has identical structure. </p>\n\n<p>Convention would dictate that I iterate over the rows of the DataTable and make an INSERT query for each, but I was wondering if there is a more efficient way to accomplish this? Perhaps something analogous to SqlBulkCopy for SQL Server?</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>    Dim connection As OleDbConnection = New OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Server.MapPath(path) &amp; \";Extended Properties=Excel 12.0;\")\n    Dim adapter = New OleDbDataAdapter(\"SELECT * FROM [Sheet1$] WHERE EmpID IS NOT NULL\", connection)\n    Dim results = New System.Data.DataSet\n    connection.Open()\n    adapter.Fill(results)\n    connection.Close()\n    connection = New System.Data.OleDb.OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Server.MapPath(\"~/App_Data/Leaves.accdb\"))\n    `Now, short of a loop, how can I insert results.Tables(0) into my database?\n</code></pre>\n\n<p>Thanks for your help.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":45,"score":-4,"question_id":13116817,"title":"VB macro in Excel to delete rows based on condition","body":"<p>Can I attach a word document that describes the issue?</p>\n"},{"tags":["excel","matlab","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13115569,"title":"Error when reading data from csv file into MATLAB","body":"<p>I have the following sample data</p>\n\n<pre><code>Date,Open,High,Low,Close,Volume,Adj Close\n10/24/2011,181.51,183.39,180.62,182.25,5890600,182.25\n10/21/2011,179.11,181.67,178.75,181.63,8054200,181.63\n10/20/2011,178.13,179.24,176.17,177.25,7513800,177.25\n</code></pre>\n\n<p>I am reading data from a CSV file into MATLAB.</p>\n\n<pre><code>data = csvread('filename.csv','A1:G12542');\n</code></pre>\n\n<p>I get the following errors. Any idea how to circumvent this issue ?</p>\n\n<pre><code>   ??? Error using ==&gt; dlmread at 145\nHeader lines must be integer-valued.\n\nError in ==&gt; csvread at 50\n    m=dlmread(filename, ',', r, c);\n\nError in ==&gt; Q11 at 1\ndata1 = csvread('ibm.csv','A1:G12542');\n</code></pre>\n"},{"tags":["asp.net","excel"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":777,"score":2,"question_id":2711307,"title":"How to read column names of an excel sheet using ASP.Net?","body":"<p>I am trying to read column names from excel using ASP.Net. Any help?</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":43,"score":1,"question_id":13115546,"title":"How to bring the userform in the excel sheet?","body":"<p>I have developed an <code>UserForm</code> VBA module.</p>\n\n<p>But i want that userform when opening the excel sheet itself? WheN I open <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> the <code>UserForm</code> should should show.</p>\n\n<p>Please advise.</p>\n"},{"tags":["c#","excel","ms-access"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13109594,"title":"if access is not installed will my program still operate","body":"<p>I am developing a program that retrieves information from Excel files and converts that information to store it in an Access Database and use it later. \nThe computer that the program will operate on does have Excel installed, but i am not sure whether it has Access. \nI was just wondering will my program work in this case or Access should definitely be installed on the other computer?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13115238,"title":"Inserting checkbox, radio and dropdown values from VBA form into Excel spreadsheet","body":"<p>I have a bit of a multi-faceted question regarding inserting checkbox, radio and dropdown values from a VBA form into the Excel spreadsheet. I am trying to accommodate a couple case scenarios in my code at the moment.</p>\n\n<p>The first set of items I want to insert is a <strong>checkbox</strong> with the following names/values:</p>\n\n<pre><code>Name         Value\n==========   =====\nchk_week1    1\nchk_week2    2\nchk_week3    3\nchk_week4    4\nchk_week5    5\nchk_week6    6\nchk_week7    7\nchk_week8    8\nchk_week9    9\nchk_week10   10\nchk_week11   11\nchk_week12   12\nchk_week13   13\nchk_week14   14\nchk_week15   15\n</code></pre>\n\n<p>If the user makes a selection of several checkboxes then it should be inserted in the form <code>1,2,4,5</code> - for example if the user selects <code>chk_week1, chk_week2, chk_week4 and chk_week5</code>.</p>\n\n<hr>\n\n<p>The second set of items I want to insert is a single pick from radio group with the followng names/values within the frame <code>fr_Priority</code>:</p>\n\n<pre><code>Name         Value\n==========   =====\npriority_y   Yes\npriority_n   No\n</code></pre>\n\n<p>So if the user selects <code>priority_y</code> then <code>Yes</code> is inserted into the Excel spreadsheet. </p>\n\n<hr>\n\n<p>The third set of items I want to insert comes from three drop downs. This is fairly straightforward, but the user is required to make a selection in all three drop downs. If they are not interested in a preference then they select <code>'No Preference'</code>. If the user makes this decision then nothing should be inserted into cell. The following names/values are present:</p>\n\n<pre><code>Name         \n==========   \ncbo_fac1   \ncbo_fac2\ncbo_fac3   \n</code></pre>\n\n<p>For instance if the user makes a selection of <code>111,222,No Preference</code> in <strong>cbo_fac1</strong>, <strong>cbo_fac2</strong>, <strong>cbo_fac3</strong> then only <code>111,222</code> gets inserted. If <code>111,No Preference,No Preference</code> is selected then only <code>111</code> gets inserted. </p>\n\n<hr>\n\n<p>This is the code I am using right now:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\n\nDim ws As Worksheet\nDim rng1 As Range\nSet ws = Worksheets(\"main\")\n\n' Copy the data to the database\n' Get last empty cell in column A\nSet rng1 = ws.Cells(Rows.Count, \"a\").End(xlUp)\n\ndeptCodeSplit = Split(cbo_deptCode.Value, \" \")\n\nrng1.Offset(1, 0) = deptCodeSplit(0)\nrng1.Offset(1, 1) = cbo_moduleCode.Value\nrng1.Offset(1, 2) = cbo_moduleName.Value\nrng1.Offset(1, 3) = txt_studentNo.Value\nrng1.Offset(1, 4) = cbo_day.Value\nrng1.Offset(1, 5) = cbo_period.Value\n' rng1.Offset(1, 6) = weeks\nrng1.Offset(1, 7) = cbo_weeks.Value\nrng1.Offset(1, 8) = cbo_semester.Value\nrng1.Offset(1, 9) = cbo_rounds.Value\nrng1.Offset(1, 10) = cbo_priority.Value\n' rng1.Offset(1, 11) = lectureStyle\nrng1.Offset(1, 12) = txt_noRooms.Value\nrng1.Offset(1, 13) = cbo_park.Value\n' rng1.Offset(1, 14) = fac\n' rng1.Offset(1, 15) = pref\nrng1.Offset(1, 16) = txt_specialReq.Value\n\nEnd Sub\n</code></pre>\n\n<p>Thanks so much in advance!</p>\n"},{"tags":["algorithm","excel","language-agnostic"],"answer_count":17,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":21986,"score":12,"question_id":22708,"title":"How do I find the Excel column name that corresponds to a given integer?","body":"<p>How would you determine the column name (e.g. \"AQ\" or \"BH\") of the nth column in Excel?</p>\n\n<p>Edit: A language-agnostic algorithm to determine this is the main goal here.</p>\n"},{"tags":["excel","random","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13112178,"title":"Generating unique random numbers in Excel using formula without VBA","body":"<p>I have to generate five distinct random numbers from 0 to 50 using only formulas and not VBA. How should I do it?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13108594,"title":"Set Excel spreadsheet values to wrap text automatically when inserting values from VBA form","body":"<p>I'm currently inserting some values into an Excel spreadsheet via a VBA form. What I've done is working great so far but I was wondering if there was a way to set the text to automatically wrap in each cell? </p>\n\n<p>As right now it seems like everything will just overlap with each other.</p>\n\n<pre><code>Private Sub btnSubmit_Click()\n    Dim ws As Worksheet\n    Dim rng1 As Range\n    Set ws = Worksheets(\"main\")\n    Set rng1 = ws.Cells(Rows.Count, \"a\").End(xlUp)\n    rng1.Offset(1, 0) = cbo_deptCode.Value\nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel","file-io","ioexception"],"answer_count":7,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":1788,"score":7,"question_id":4992057,"title":"How to read open excel file at C#","body":"<p>I want to read already open excel file with C#. I am using this method but it can't read the excel file while the file is open in Microsoft excel. </p>\n\n<pre><code>FileStream stream = File.Open(\"myfile.xlsx\", FileMode.Open, FileAccess.Read);\n</code></pre>\n\n<p>It gives <code>IOException: The process cannot access the file 'myfile.xlsx' because it is being used by another process.</code></p>\n\n<p>I hope you understands what I mean. I want to keep excel file open and while file is open at Microsoft excel i want to read it from C#. I am using C# net framework 4.0</p>\n"},{"tags":["php","excel","string","strlen"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":4,"view_count":1995,"score":-1,"question_id":3561596,"title":"Why is my Content-Length header wrong?","body":"<p>I am trying to find out the exact length of a string using strlen() in php 5.2. The string ($data) contains '\\t' and '\\n'.</p>\n\n<pre><code>echo strlen($data);\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>    // fetch table header\n      $header = '';\n      while ($fieldData = $result-&gt;fetch_field()) {\n        $header .= $fieldData-&gt;name . \"\\t\";\n      }\n\n      // fetch data each row, store on tabular row data\n      while ($row = $result-&gt;fetch_assoc()) {\n        $line = '';\n        foreach($row as $value){\n          if(!isset($value) || $value == \"\"){\n            $value = \"\\t\";\n          }else{\n            // important to escape any quotes to preserve them in the data.\n            $value = str_replace('\"', '\"\"', $value);\n            // needed to encapsulate data in quotes because some data might be multi line.\n            // the good news is that numbers remain numbers in Excel even though quoted.\n            $value = '\"' . $value . '\"' . \"\\t\";\n          }\n\n          $line .= $value;\n        }\n        $data .= trim($line).\"\\n\";\n      }\n\n      // this line is needed because returns embedded in the data have \"\\r\"\n      // and this looks like a \"box character\" in Excel\n      $data = str_replace(\"\\r\", \"\", $data);\n\n      // Nice to let someone know that the search came up empty.\n      // Otherwise only the column name headers will be output to Excel.\n      if ($data == \"\") {\n        $data = \"\\nno matching records found\\n\";\n      }\n\n      // create table header showing to download a xls (excel) file\n      header(\"Content-type: application/octet-stream\");\n      header(\"Content-Disposition: attachment; filename=$export_filename\");\n      header(\"Cache-Control: public\");\n      header(\"Content-length: \" . strlen($data); // tells file size\n      header(\"Pragma: no-cache\");\n      header(\"Expires: 0\");\n\n  // output data\n  echo $header.\"\\n\".$data;\n</code></pre>\n\n<p>This does not return the exact length (its less than the actual length). Please advice.</p>\n"},{"tags":["excel","excel-vba","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13104235,"title":"How do I get excel to merge cells only when other cells are filled?","body":"<p>I need to merge cells using a formula so that the cells only merge when cells on another tab are filled.\nI have 2 tabs with the same amount of columns in each. I want cells a1-d1 to merge in tab 1 when cells a1-d1 in tab 2 are filled and for the value of d1 in tab 2 to be inputted into the newly merged cells in tab 1.\nthis is what I have:</p>\n"},{"tags":["c#","asp.net","excel","openxml","openxml-sdk"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3037,"score":3,"question_id":6021608,"title":"Excel Open XML error: \"found unreadable content\" when creating simple example","body":"<p>I am getting the ambiguous \"excel found unreadable content\" error when I try to open the document created by the following code:</p>\n\n<pre><code>public void GenerateWorkbookFromDB()\n{\n    //Make a copy of the template file\n    File.Copy(HttpContext.Current.Server.MapPath(\"ReportTemplate/test.xlsx\"), HttpContext.Current.Server.MapPath(\"Reports/test.xlsx\"), true);\n\n    //Open up the copied template workbook\n    using (SpreadsheetDocument myWorkbook = SpreadsheetDocument.Open(HttpContext.Current.Server.MapPath(\"Reports/test.xlsx\"), true))\n    {\n        WorkbookPart workbookPart = myWorkbook.WorkbookPart;\n        WorksheetPart worksheetPart = workbookPart.WorksheetParts.First();\n        string origninalSheetId = workbookPart.GetIdOfPart(worksheetPart);\n\n        WorksheetPart replacementPart = workbookPart.AddNewPart&lt;WorksheetPart&gt;();\n        string replacementPartId = workbookPart.GetIdOfPart(replacementPart);\n\n        OpenXmlReader reader = OpenXmlReader.Create(worksheetPart);\n        OpenXmlWriter writer = OpenXmlWriter.Create(replacementPart);\n\n        Row r = new Row();\n        Cell c = new Cell();\n        CellValue v = new CellValue();\n        v.Text = \"test\";\n        c.Append(v);\n\n        while (reader.Read())\n        {\n            if (reader.ElementType == typeof(SheetData))\n            {\n                if (reader.IsEndElement)\n                    continue;\n                writer.WriteStartElement(new SheetData());\n\n                for (int row = 0; row &lt; 20; row++)\n                {\n                    writer.WriteStartElement(r);\n\n                    for (int col = 0; col &lt; 4; col++)\n                    {\n                        writer.WriteElement(c);\n                    }\n\n                    writer.WriteEndElement();\n                }\n\n                writer.WriteEndElement();\n            }\n            else\n            {\n                if (reader.IsStartElement)\n                    writer.WriteStartElement(reader);\n                else if (reader.IsEndElement)\n                    writer.WriteEndElement();\n            }\n        }\n        reader.Close();\n        writer.Close();\n\n        try\n        {\n            Sheet sheet = workbookPart.Workbook.Descendants&lt;Sheet&gt;().Where(s =&gt; s.Id.Value.Equals(origninalSheetId)).First();\n            sheet.Id.Value = replacementPartId;\n            workbookPart.DeletePart(worksheetPart);\n        }\n        catch (Exception ex) { }\n    }\n}\n</code></pre>\n\n<p>any help or suggestions is much appreciated! :D</p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13109050,"title":"range end xldown not working","body":"<p>I'm trying to select a row and then CtrlShift end down, but without .SELECT etc...</p>\n\n<pre><code>        Set rng = wsDATA.Range(\"A8\").EntireRow\n        Set rng = Range(rng, rng.End(xlDown))\n</code></pre>\n\n<p>but I get an <code>Application Defined or Object Defined Error</code> on the second line.  Why is this?</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13108171,"title":"Inserting form values into Excel spreadsheet using VBA","body":"<p>I'm trying to insert form values into my Excel spreadsheet using <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> but my current code is inserting values into the same row.</p>\n\n<ol>\n<li>As my table starts from <strong>row 3</strong>, I want to start from there and continue by automatically shifting to the next row each time. The rows are already set and I don't want to insert new rows but overwrite the current 'empty' rows.</li>\n<li>When 202 rows (maximum no. of rows available) have been entered then I want the spreadsheet to return an error message dialog.</li>\n</ol>\n\n<p>How can I go about achieving this? </p>\n\n<p><strong>Current Code</strong></p>\n\n<pre><code>    Private Sub btnSubmit_Click()\n\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"main\")\n\n    ' Copy the data to the database\n    ws.Rows(\"4:4\").Insert Shift:=xlDown\n    ws.Range(\"A3\").Value = cbo_deptCode.Value\n    MsgBox (\"Booking request has been successfully made\")\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","ms-access"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":66,"score":0,"question_id":13089507,"title":"Making a calender in Access 2010","body":"<p>I have a calender table that lists All dates in a certain range, and then some of the dates have other dates attatched to them for reference.</p>\n\n<p>The table is 60_Days  and it has fields  Date and Date_60 with Date being the Actual calender and the Date_60 refers to other dates that need to be listed below Date.</p>\n\n<p>I want to make a report that shows a normal calender but will display the Date_60 dates below Date where it exists. Any ideas? Visual Basic would be fine if it can be done. If I can export this into Excel and that somehow makes it easier, that is fine too. Thanks!!</p>\n\n<p>Edit</p>\n\n<p>I fail to see why this has been downvoted since no one seems to know my answer. Just being honest. I can't find what I am looking for and I have no idea where to start. I did read that for some reason, MS took out the Calender Control in forms and reports from Access in the 2010 version... Makes NO sense to me, but whatever. After doing more research, it seems like this MAY be able to be done in Excel, but I still don't see how it can be done yet.</p>\n\n<p>Next Edit. The type of Calender I want to use should look somewhat like this</p>\n\n<p><a href=\"http://www.google.com/imgres?um=1&amp;hl=en&amp;safe=active&amp;sa=N&amp;biw=1280&amp;bih=880&amp;tbm=isch&amp;tbnid=WR_gZPF0plXvWM:&amp;imgrefurl=http://www.docstoc.com/docs/16553160/Year-Round-School-Calendar-2009-2010-March-2010-S-7-14-21-28-7-14-21-28-S-M-1-8-15-22-29-T-2-9-16-23-30-W-3-10-17-24-31-T-4-11-18-25-F-5-12-19-26-S-6-13-20-27-W-4-11-18-25-T-5-12-19-26-F-6-13-20&amp;docid=_aFOfbu3eBlxcM&amp;imgurl=http://img.docstoccdn.com/thumb/orig/16553160.png&amp;w=1275&amp;h=1650&amp;ei=Q8yKUJmuIZCK9gTd34HACg&amp;zoom=1&amp;iact=rc&amp;dur=357&amp;sig=117327434000511743512&amp;page=2&amp;tbnh=150&amp;tbnw=117&amp;start=24&amp;ndsp=35&amp;ved=1t:429,r:5,s:20,i:158&amp;tx=104&amp;ty=49\" rel=\"nofollow\">http://www.google.com/imgres?um=1&amp;hl=en&amp;safe=active&amp;sa=N&amp;biw=1280&amp;bih=880&amp;tbm=isch&amp;tbnid=WR_gZPF0plXvWM:&amp;imgrefurl=http://www.docstoc.com/docs/16553160/Year-Round-School-Calendar-2009-2010-March-2010-S-7-14-21-28-7-14-21-28-S-M-1-8-15-22-29-T-2-9-16-23-30-W-3-10-17-24-31-T-4-11-18-25-F-5-12-19-26-S-6-13-20-27-W-4-11-18-25-T-5-12-19-26-F-6-13-20&amp;docid=_aFOfbu3eBlxcM&amp;imgurl=http://img.docstoccdn.com/thumb/orig/16553160.png&amp;w=1275&amp;h=1650&amp;ei=Q8yKUJmuIZCK9gTd34HACg&amp;zoom=1&amp;iact=rc&amp;dur=357&amp;sig=117327434000511743512&amp;page=2&amp;tbnh=150&amp;tbnw=117&amp;start=24&amp;ndsp=35&amp;ved=1t:429,r:5,s:20,i:158&amp;tx=104&amp;ty=49</a></p>\n"},{"tags":["excel","excel-vba","double-click"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13098369,"title":"Avoid selection in a form when double-click","body":"<p>In <a href=\"/questions/tagged/excel-2007\" class=\"post-tag\" title=\"show questions tagged 'excel-2007'\" rel=\"tag\">excel-2007</a> I have a macro that when double clicking a cell, a form will open.</p>\n\n<p>When the relevant cell is located within the range in which the form will appear, an undesired selection is carried out in the form. </p>\n\n<p>How can I avoid this selection?</p>\n"},{"tags":["excel","excel-2007","excel-formula","conditional-formatting"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13104524,"title":"How to create a conditional format in excel 2007 from another cell","body":"<ul>\n<li>I have a sheet with 4 fields spanning <code>A3:D3</code> </li>\n<li>in <code>D3</code> I have a conditional format that turns the cell yellow if it equals the word \"no contact\"</li>\n</ul>\n\n<p>How can I get Cells <code>A3:C3</code> to also turn yellow if this is the case, any help would be greatly appreciated</p>\n"},{"tags":["excel","macros","rows"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":327,"score":0,"question_id":11888683,"title":"Copy Excel rows if 3 conditions are met for 50 different variables","body":"<p>I'm trying to write a macro that will copy the rows if 3 conditions are met. Such as:</p>\n\n<p>If \"A\" = B and \"D\" = E and \"F\" = G \nThen copy row into next available row on sheet 2 </p>\n\n<p>If \"A\" = C and \"D\" = F and \"F\" = H \nThen copy row into next available row on sheet 2 </p>\n\n<p>I need to repeat the above steps up to 50 times. The columns will not change </p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>`Sub SearchForString()\n\nDim LSearchRow As Integer\nDim LCopyToRow As Integer\n\nOn Error GoTo Err_Execute\n\n'Start search in row 4\nLSearchRow = 4\n\n'Start copying data to row 2 in Sheet2 (row counter variable)\nLCopyToRow = 2\n\nWhile Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n    'If value in column E = \"Mail Box\", copy entire row to Sheet2\n    'If value in column D = \"0\", copy entire row to Sheet2\n    'If value in column A = \"5\", copy entire row to Sheet2\n    'If Range(\"E\" &amp; CStr(LSearchRow)).Value = \"Mail Box\" Then\n    If Range(\"F\" &amp; CStr(LSearchRow)).Value = \"Mail Box\" And _\n        Range(\"E\" &amp; CStr(LSearchRow)).Value = \"0\" And _\n        Range(\"A\" &amp; CStr(LSearchRow)).Value = \"5\" Then\n\n 'If Range(\"E\" &amp; CStr(LSearchRow)).Value = \"Mail Box\" Then\n\n        'Select row in Sheet1 to copy\n        Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n        Selection.Copy\n\n        'Paste row into Sheet2 in next row\n        Sheets(\"Sheet2\").Select\n        Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n        ActiveSheet.Paste\n\n        'Move counter to next row\n        LCopyToRow = LCopyToRow + 1\n\n        'Go back to Sheet1 to continue searching\n        Sheets(\"Sheet1\").Select\n\n        End If\n\n    LSearchRow = LSearchRow + 1\n\n    Wend\n\n'Position on cell A3\nApplication.CutCopyMode = False\nRange(\"A3\").Select\n\n'MsgBox \"All matching data has been copied.\"\n\n'Exit Sub\n\n\n        'Search 2\n\n         'Start search in row 4\nLSearchRow = 4\n\n'Start copying data to row 3 in Sheet2 (row counter variable)\nLCopyToRow = 3\n\nWhile Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n    'If value in column E = \"Mail Box\", copy entire row to Sheet2\n    'If value in column D = \"1\", copy entire row to Sheet2\n    'If value in column A = \"5\", copy entire row to Sheet2\n    'If Range(\"E\" &amp; CStr(LSearchRow)).Value = \"Mail Box\" Then\n    If Range(\"F\" &amp; CStr(LSearchRow)).Value = \"Mail Box\" And _\n        Range(\"E\" &amp; CStr(LSearchRow)).Value = \"1\" And _\n        Range(\"A\" &amp; CStr(LSearchRow)).Value = \"5\" Then\n\n 'If Range(\"E\" &amp; CStr(LSearchRow)).Value = \"Mail Box\" Then\n\n        'Select row in Sheet1 to copy\n        Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n        Selection.Copy\n\n        'Paste row into Sheet2 in next row\n        Sheets(\"Sheet2\").Select\n        Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n        ActiveSheet.Paste\n\n        'Move counter to next row\n        LCopyToRow = LCopyToRow + 1\n\n        'Go back to Sheet1 to continue searching\n        Sheets(\"Sheet1\").Select\n\n    End If\n\n    LSearchRow = LSearchRow + 1\n\nWend\n\n'Position on cell A3\nApplication.CutCopyMode = False\nRange(\"A3\").Select\n\nMsgBox \"All matching data has been copied.\"\n\nExit Sub\n\n Err_Execute:\nMsgBox \"An error occurred.\"\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","loops","concatenation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13104864,"title":"Loop in VBA to add extension .jpg","body":"<p>I am really new to VBA and I would like to add a .jpg extension to values contained in a column.</p>\n\n<pre><code>Header Col G\n11125;111545\n154645\n154511;145521;165421\n1156556;13165\n567418\n</code></pre>\n\n<p>I would like to loop into this column and add a .jpg to every value (multiple images per cell tho')</p>\n\n<p>EDIT: 2n Try and working one</p>\n\n<pre><code>Sub image()\nDim c As Range\n\n\n    For Each c In Selection.Cells\n        Dim Words() As String\n        Words() = Split(c.Value, \";\")\n        Dim x As Integer\n\n        For x = 0 To UBound(Words)\n        Words(x) = Words(x) &amp; \".jpg\"\n        Next x\n        c.Value = Join(Words, \";\")\n    Next\nEnd Sub\n</code></pre>\n\n<p>Probably not the shortest way..but it works \nThank you</p>\n"},{"tags":["excel","vba","optimization","large-data"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":114,"score":3,"question_id":13094664,"title":"Excel VBA: Macro for data processing getting slower and slower the longer it runs","body":"<p>I'm analysing large amounts of historical financial data using the QuantlibXl library in Excel 2010, 32-bit. My typical worksheet contains long columns of empirical data of up to 1 million rows. My macros usually need to to run through each row from the top to the bottom and do some Quantlib-typical financial analysis stuff like revaluing a security, which requires that Quantlib objects be created in every row. The analytical stuff is contained within the cells as formulas.</p>\n\n<p>So in the beginning I tried to just select the cells with formulas in the top row and fill them down by dragging the lower right corner to the bottom of the sheet. Already here, the processing time grew exponentially with the number of rows involved.</p>\n\n<p>So I figured I had to write a macro that processes smaller chunks of rows at one time. The macro would basically take care of filling down the top row only 100 rows at a time. That and a number of optimizations (explained below) certainly improved speed tremendously, but processing time still grew exponentially.</p>\n\n<p>The problem is that as much as I try to optimize my macros, they keep getting slower and slower the longer they run. I keep track of processed rows in the status bar, and for example if 2000 rows are processed per minute (the calculations are pretty involved) when kick-starting the macro, its speed decreases constantly throughout its runtime, for example to only 100 rows per minute after 60,000 rows. At that rhythm, it will never see the end of the sheet. So in fact, at some point it becomes optimal to just abort it and start it off again from where it stopped. I also splitted the files and let them run on different computers simultaneouesly, which is a pain in the ass in terms of managing.</p>\n\n<p>I already implemented tons of optimizations:\n- screen updating and automatic calculations are turned off.\n- I only perform calculation on the row being processed at a time.\n- garbage collecting: Quantlib objects are deleted immediately after they are no longer used. I thought it was them eating all free memory that caused the slow-downs.\n- I got so far to write the relevant results (cells) to a text file and delete the rows that were no longer needed. Again, the macro was very fast in the beginning and would have run until the end within a couple of hours if it wasn't getting slower again after like 70,000 rows. In fact, I had hoped to see a speed increase during runtime as rows are getting deleted and the sheet shrinks, but it just doesn't happen. So I just keep halting the process ever 60,000 rows and kick-starting it again, but its tiresome.</p>\n\n<p>I'd like to figure out what causes this behaviour of Excel not processing large amounts of data linearly and requiring restarts, and how to avoid it. If somebody ran into similar trouble and found a way around it, I'd be glad to hear about it.</p>\n\n<p><strong>EDIT:</strong>  Every time I halt the process to speed it up again by starting over, I noticed that I have to restart Excel, otherwise it resumes just as slow as before. My current hypothesis is that at some point data isn't cleaned up correctly. If this is the case, your solution would bring me any further. The Quantlib library has a method to look at how many objects still reside in memory called ohRepositoryObjectCount(). I call the ohRepositoryDeleteAllObjects() function after every calculation and they are being effectively deleted as per that other method, but maybe there is still some leakage that remains undetected.</p>\n\n<p><strong>EDIT2:</strong> I'm now convinced there is memory leakage as after a long batch the task manager shows 3 or 4 Excel processes consuming together about 1.5 GB of memory. When quitting Excel, it crashes (with a message along the lines of \"Excel is not working anymore\"), and the processes persist, so I have to kill them manually.</p>\n"},{"tags":["excel","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13105105,"title":"Processing CSV data","body":"<p>I have recently been asked to take a .csv file that looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ASSvl.png\" alt=\"enter image description here\"></p>\n\n<p>Into something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/gY8J1.png\" alt=\"enter image description here\"></p>\n\n<p>Keeping in mind that there will be hundreds, if not thousands of rows due to a new row being created every time a user logs in/out, and there will be more than simply two users. My first thought was to load the .csv file into a MySQL then run a query on it. However, I really don't want to install MySQL on the machine that will be used for this.</p>\n\n<p>I could do it manually for each agent in Ecxel/Open Office, but due to there being little room for error, and there are so many lines to do this, I want to automate the process. What's the best way to go about that?</p>\n"},{"tags":["excel","excel-2007","excel-formula"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4113,"score":2,"question_id":364073,"title":"Can I make a structured reference absolute in excel 07?","body":"<p>I have a table \"A\" with 2 columns \"Foo\" and \"Bar\". I have a formula with the structured reference A[Foo]. When I fill this formula horizontally I want the reference to stay A[Foo] but now, in the second column, the reference turns to A[Bar]. Is there a way to make this structured reference absolute? </p>\n\n<p>It'd be shocking that this isn't supported if not.</p>\n\n<p>Example Formula:</p>\n\n<p>=A[Foo]</p>\n\n<p>Drag that horizontally and Foo changes if the table has multiple columns</p>\n"},{"tags":["excel","vba","excel-vba","macros","excel-formula"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":95,"score":5,"question_id":13079443,"title":"How to perform a sumif using blank cells as a reference?","body":"<p>Please see the example data below:</p>\n\n<pre><code>Time        Date                Result\n00:21.6     10/1/2012 1:43      FALSE\n01:47.7     10/1/2012 2:13      FALSE\n00:56.7     10/1/2012 2:49      FALSE\n00:54.9     10/1/2012 3:43  \n00:11.8     10/1/2012 3:43  \n02:10.9     10/1/2012 3:46      FALSE\n01:05.4     10/1/2012 3:58      FALSE\n00:55.8     10/1/2012 4:53  \n04:41.8     10/1/2012 4:52  \n00:26.3     10/1/2012 4:58  \n00:04.2     10/1/2012 4:58  \n00:15.3     10/1/2012 4:59  \n00:06.4     10/1/2012 4:57  \n00:10.7     10/1/2012 4:56  \n00:04.4     10/1/2012 4:56  \n00:04.2     10/1/2012 4:57  \n00:29.2     10/1/2012 4:57  \n00:34.5     10/1/2012 4:56  \n01:22.4     10/1/2012 4:55  \n00:08.1     10/1/2012 4:55      FALSE\n03:20.9     10/1/2012 4:51      FALSE\n00:56.3     10/1/2012 5:42      FALSE\n02:23.1     10/1/2012 5:51      \n01:20.6     10/1/2012 5:48  \n00:09.8     10/1/2012 5:49      FALSE\n01:40.0     10/1/2012 7:47      FALSE\n01:13.4     10/1/2012 8:11      FALSE\n00:41.6     10/1/2012 9:49      FALSE\n01:08.1     10/1/2012 11:56     FALSE\n</code></pre>\n\n<p>I need to perform a certain type of calculation. If there is no blank cell in the result, I need the data in time cell next to the result. But if there is a blank cell in the result column, I need to perform a sum of the time in the rows that contain the blank cell and the first cell containing FALSE next to the blank cell.</p>\n\n<p>Please see the example output below:</p>\n\n<pre><code>00:21.6     10/1/2012 1:43      FALSE       00:21.6\n01:47.7     10/1/2012 2:13      FALSE       01:47.7\n00:56.7     10/1/2012 2:49      FALSE       00:56.7\n00:54.9     10/1/2012 3:43      \n00:11.8     10/1/2012 3:43      \n02:10.9     10/1/2012 3:46      FALSE       03:17.6(i.e., 00:54.9+00:11.8+02:10.9)\n01:05.4     10/1/2012 3:58      FALSE       01:05.4\n00:55.8     10/1/2012 4:53      \n04:41.8     10/1/2012 4:52      \n00:26.3     10/1/2012 4:58      \n00:04.2     10/1/2012 4:58      \n00:15.3     10/1/2012 4:59      \n00:06.4     10/1/2012 4:57      \n00:10.7     10/1/2012 4:56      \n00:04.4     10/1/2012 4:56      \n00:04.2     10/1/2012 4:57      \n00:29.2     10/1/2012 4:57      \n00:34.5     10/1/2012 4:56      \n01:22.4     10/1/2012 4:55      \n00:08.1     10/1/2012 4:55      FALSE       09:23.3(i.e., 00:55.8+04:41.8+00:26.3+00:04.2+00:15.3+00:06.4+00:10.7+00:04.4+00:04.2+00:29.2+00:34.5+01:22.4+00:08.1)\n03:20.9     10/1/2012 4:51      FALSE       03:20.9\n00:56.3     10/1/2012 5:42      FALSE       00:56.3\n02:23.1     10/1/2012 5:51      \n01:20.6     10/1/2012 5:48      \n00:09.8     10/1/2012 5:49      FALSE       03:53.5(i.e., 02:23.1+01:20.6+00:09.8)\n01:40.0     10/1/2012 7:47      FALSE       01:40.0\n01:13.4     10/1/2012 8:11      FALSE       01:13.4\n00:41.6     10/1/2012 9:49      FALSE       00:41.6\n01:08.1     10/1/2012 11:56     FALSE       01:08.1\n</code></pre>\n\n<p>If it is possible by any formulas or using visual basic editor please let me know. I am doing this manually right now. I have to handle about 10000-15000 rows per day. If you help me out I could save a lot of hours and use it to learn something new.</p>\n"},{"tags":["c#","excel","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13088002,"title":"How can I rename Excel worksheets using NetOffice?","body":"<p>I am trying to use NetOffice to create excel workbooks in my c# application and have caught a snag trying to rename worksheets and using sorts on ranges of cells.  The following lines of code are not recognized by NetOffice and I am struggling to find a way to rename worksheets and sort ranges of cells using NetOffice.</p>\n\n<pre><code>workbook.Worksheets[sheetCountPlusONe].name = \"Event \" + sheetCountPlusONe.ToString() + \" Results\";\n</code></pre>\n\n<p>And this also doesn't work.  This is where I am declaring and sorting a range of cells:</p>\n\n<pre><code>Excel.Range valueRange;\nExcel.Range placeRange;\nplaceRange = worksheet.get_Range(\"A14\", \"A\" + (14 + (registrationForm.numberofCompetitors - 1)).ToString());\nvalueRange = worksheet.get_Range(\"A14\", \"K\"+(14+(registrationForm.numberofCompetitors-1)).ToString());\nvalueRange.Sort(valueRange.Columns[3, Type.Missing], Excel.XlSortOrder.xlDescending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);\nplaceRange.Sort(placeRange.Columns[1, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal); \n</code></pre>\n"},{"tags":["php","mysql","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13105230,"title":"Insert Excel data into MySQL","body":"<p>I've been searching and searching and I'm sure I'm just looking up the wrong thing so I'm looking for a push in the right direction please.</p>\n\n<p>I'm a newbie to PHP and MySQL and my first project has a need to upload excel sheets that contain 20k or so records at varying intervals to an already existing MySQL database. I understand how to do a simple upload and map fields but where I am getting stuck is the excel data is going to two separate tables and the second table has a foreign key for the first table. </p>\n\n<p>I need to find out if the record is a duplicate in table one and if so, get the primary key and insert it into the second table along with some data from the excel sheet.</p>\n\n<p>I'm sure what I'm asking for is very basic but I need to know what the most accepted way to do this is so I can research and build it. I'm not sure if CRUD is what I'm looking for or if I should be running a special SQL statement in PHPMyAdmin?</p>\n\n<p>Im using PHP, MySQL, Godaddy shared hosting for this project. Thx!</p>\n"},{"tags":["sharepoint","excel","internet-explorer"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1140,"score":1,"question_id":2494869,"title":"Sharepoint list loses its IssueID column when exported to Excel, why?","body":"<p>My team current uses a Sharepoint list to manage bugs, issues etc for the project.\nI frequently use the \"Export to Spreadsheet\" feature in Sharepoint to manage the list from within Excel, where I can edit, update and sync at my leisure.</p>\n\n<p>However, I just got given a shiny new PC, and now whenever I use this feature, the <strong>IssueID</strong> column disappears.</p>\n\n<p>On my <strong>old</strong> PC, I get the following:</p>\n\n<pre><code>A     B     C\nID    ID    Title ..... etc\n1     246   foo\n2     258   bar\n3     266   foobar\n</code></pre>\n\n<p>whereby column A would simply be an index of row numbers, and column B was the \"true\" IssueID.</p>\n\n<p>On my <strong>new</strong> PC, I get the following</p>\n\n<pre><code>A     B     \nID    Title ..... etc\n1     foo\n2     bar\n3     foobar\n</code></pre>\n\n<p>which means that I no longer have the corresponding unique ID for each line item - which is, frankly, useless !</p>\n\n<p>Both of my PCs are Win XP, Excel 2003 and IE6 (i know, but it's company policy), connecting to the same Sharepoint site.</p>\n\n<p>Can anyone point out where I might be going wrong ?</p>\n\n<p>Many thanks,</p>\n\n<p>Andrew</p>\n"},{"tags":["c#",".net","vb.net","excel","replace"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13103516,"title":"Warning message while replacing Excel cell values in C# windows application","body":"<p>I am replacing excel cell values in C# with the following code, but in case if a particular field is not found then its showing following warning dialog box.</p>\n\n<p>Code is like this:</p>\n\n<pre><code>xlWorkSheet.Cells.Replace(\n     \"CustomerName\", \n     \"John\", \n     missingValue, \n     missingValue, \n     missingValue, \n     missingValue, \n     missingValue, \n     missingValue);\n</code></pre>\n\n<p>So if \"CustomerName\" is not present in any of the excel cells it shows following message:</p>\n\n<blockquote>\n  <p><strong>Microsoft Office Excel</strong></p>\n  \n  <p>Microsoft Office Excel cannot find any data to replace. Check if your\n  search formatting and criteria are defined correctly. If you are sure\n  that matching data exists in this workbook, it may be on a protected\n  sheet. Excel cannot replace data on a protected worksheet.</p>\n</blockquote>\n\n<p>I need to stop this dialog box to popup, because I have many cells that can have fields or not.  </p>\n\n<p>Any answer?</p>\n"},{"tags":["excel","data-structures","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13076218,"title":"Store struct in excel cells?","body":"<p>\nHey guys,</p>\n\n<p>Is there a way to store a data struct inside an excel cell? How would I put and get data from it?</p>\n\n<p>I expect to use something like <br>\n\n   <li>to put struct in cell A1: <code>=putstruct(\"data1\", 123, \"data2\", \"hello\", \"data3\", MMULT(matA,matB))</code></li>\n   <li>to get in cell B1 from A1: <code>=getstruct(\"A1\", \"data1\")</code></li></p>\n\n<p>One (of several) problems solved with a struct: if I need to reference a computed matrix, first I gotta expand (i.e. display) the whole matrix on the spreadsheet and then name it as a range to start using it. But if the matrix size changes, that starts to become a headache...</p>\n\n<p>Any help appreciated!</p>\n\n<p><sub>\nBy the way, I found similar questions <a href=\"http://stackoverflow.com/questions/12162854/using-excel-add-ins-to-store-complex-structures-with-vba-in-excel\">here</a> and <a href=\"http://stackoverflow.com/questions/9575299/how-to-store-array-elements-in-an-excel-sheet-cells-with-tcl-tcom\">here.</a>\n</sub>\n</p>\n"},{"tags":["php","excel","codeigniter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13095844,"title":"Reading specific row or column - phpExcel","body":"<p>Using phpExcel, I have managed to read the whole worksheet, is there a way i can read only certain values say from cell C15:C18, to insert them to the databse?</p>\n"},{"tags":["php","excel","export","bom"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13101457,"title":"Header definition export to excel file php","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4348802/how-can-i-output-a-utf-8-csv-in-php-that-excel-will-read-properly\">How can I output a UTF-8 CSV in PHP that Excel will read properly?</a>  </p>\n</blockquote>\n\n\n\n<p>I need to export from html table to excel file, but I'm having troubles with characters when I read de xml file..</p>\n\n<p>Something like this:</p>\n\n<pre><code>RegiÃ³n should be like Región\nTelÃ©fono should be like Teléfono\n</code></pre>\n\n<p>This is my header definition:</p>\n\n<pre><code>header('Content-encoding: UTF-8');\nheader(\"Content-type: application/x-msexcel; charset=UTF-8\");\nheader(\"Expires: 0\");\nheader(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\nheader(\"Content-disposition: attachment; filename=\" . $nombreArchivo . \".xls\");\n</code></pre>\n\n<p>there is a BOM configuration, but don't know how set that in the header </p>\n\n<p><strong>Very Nice</strong></p>\n\n<p>I just apply this code just before the end of header</p>\n\n<pre><code>echo \"\\xEF\\xBB\\xBF\";\n</code></pre>\n\n<p>and that solved the problem with the \"special characters\". thanks to mario :)</p>\n\n<p>but</p>\n\n<p>Now I still get this message when I want to open the downloaded file:</p>\n\n<pre><code> \"The file you are trying to open, 'file.xls', has a different format than specified by the file extension. Make sure the file is not corrupted and is from a trusted source before opening. Do you want to open the file now?\" \n</code></pre>\n\n<p>any ideas for avoid that message?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13100376,"title":"Hiding rows from 200 on to maximum row in Excel","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13099486/vba-code-to-hide-rows-n-maximum\">VBA code to hide rows n-maximum</a>  </p>\n</blockquote>\n\n\n\n<p>I'm currently using this code to hide rows from number 200 to maximum on Excel VBA but it doesn't seem to be working. Any idea on what's wrong? </p>\n\n<p>I already have data in rows 1-200.</p>\n\n<pre><code>Sub HideEm()\nDim ws As Worksheet\nDim rng1 As Range\nSet ws = Sheets(\"main\")\nSet rng1 = ws.Cells.Find(\"*\", ws.[a1], xlValues, , , xlPrevious)\nIf Not rng1 Is Nothing Then\n    If rng1.Row &gt; 200 Then ws.Rows(\"200:\" &amp; rng1.Row).Hidden = True\nEnd If\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","powerpoint"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12983768,"title":"Resizing chart in powerpoint after inserting it from excel (Excel VBA)","body":"<p>I have some code that takes a chart in <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> and pastes it into a <a href=\"/questions/tagged/powerpoint\" class=\"post-tag\" title=\"show questions tagged 'powerpoint'\" rel=\"tag\">powerpoint</a> slide. However, once it is pasted into <a href=\"/questions/tagged/powerpoint\" class=\"post-tag\" title=\"show questions tagged 'powerpoint'\" rel=\"tag\">powerpoint</a>  I'm not sure how to resize the chart. I've looked into finding which number \"shape\" it is and I can do this manually but I don't know how to automate this. Any help would be appreciated, thanks!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub AddChartToPPT(PPT As PowerPoint.Application, Slide As Integer, Chart As String, FromTop As Double, FromLeft As Double, Length As Double, Width As Double)\nDim activeslide As PowerPoint.Slide\nPPT.ActiveWindow.View.GotoSlide Slide\nSet activeslide = PPT.ActivePresentation.Slides(Slide)\nActiveSheet.ChartObjects(Chart).Activate\nActiveChart.ChartArea.Copy\nactiveslide.Shapes.PasteSpecial(DataType:=ppPasteMetafilePicture).Select\nPPT.ActiveWindow.Selection.ShapeRange.Left = FromLeft\nPPT.ActiveWindow.Selection.ShapeRange.Top = FromTop\n'Need to add scaling code\nEnd Sub\n</code></pre>\n"},{"tags":["excel","plugins","ms-office","add-in","xll"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12844583,"title":"Plugin development for Excel","body":"<p>I need to develop a plugin for excel. It should behave similar to Plugins for Eclipse.\nIt should be available as a context sensitive menu, should have access to spreadsheet contents currently opened, the chart content etc.</p>\n\n<p>I saw the the following link for developing Add-ins for Excel:\n<a href=\"http://msdn.microsoft.com/en-us/library/office/aa730920(v=office.12).aspx#office2007excelXLL_DevelopingXLLs\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/office/aa730920(v=office.12).aspx#office2007excelXLL_DevelopingXLLs</a> ( using C &amp; C++ and XLL SDK).</p>\n\n<p>Is this the only option to develop plugins for Excel?</p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":11886822,"title":"How to make a checkbox and a graph size to fill a specific range using VBA Excel 2010?","body":"<p>A few questions!</p>\n\n<p><strong>Question One</strong></p>\n\n<p>I'd like this program to create three checkboxes. I want one that says \"days\" to be in A2, one that says \"hours\" to be in A3, and one that says \"minutes\" to be in A4. Is there any way to make it resize to fill in that cell, or do I have to size it manually?</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub CheckBoxMacro()\nActiveSheet.CheckBoxes.Add(111.75, 28.5, 52.5, 17.25).Select\nSelection.Characters.Text = \"Hello World\"\nEnd Sub\n</code></pre>\n\n<p>I tried putting <code>Range(\"A2\")</code> in where it has the numbers, but that didn't work.</p>\n\n<p><strong>Question Two</strong></p>\n\n<p>How do I delete a series from a graph? I'm making a graph using VBA, and it keeps adding a blank third series. It shows up in the legend, and I'm not sure how to make it go away.</p>\n\n<p><strong>Question Three</strong></p>\n\n<p>How do I make a graph fill a specific range? I found out how to do it using VBA a while ago, but I can't for the life of me find out how to do it again. I'd like a graph to fill a specific range, like F1 to K8. That way if the other columns to the left change due to user input, the graph while still stay in that range, making everything look nice.</p>\n\n<p>Thank you!</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13100563,"title":"Preventing double instance of validation error occuring","body":"<p>I'm having a problem validating three drop down's at once. Here are the test cases:</p>\n\n<pre><code>cbo_fac1 - user must select this as a pre-requisite for cbo_fac1 and cbo_fac2\ncbo_fac2 - user must select cbo_fac1 as a pre-requisite\ncbo_fac3 - user must select cbo_fac1 and cbo_fac2 as a pre-requisite\n</code></pre>\n\n<p>Here is the code I'm using so far. Unfortunately in some cases i.e. if the user tries to select <strong>cbo_fac3</strong> first, it seems to be looping several of the errors. Is there any way I can merge these functions and have it only display the error once in each case?   </p>\n\n<pre><code> Private Sub cbo_fac2_Enter()\n\n    If Len(cbo_fac1.Value) = 0 Then\n        MsgBox (\"Please select a first preference before selecting a second preference\")\n        cbo_fac1.SetFocus\n        Exit Sub\n    End If\n\nEnd Sub\n\nPrivate Sub cbo_fac3_Enter()\n\n    If Len(cbo_fac2.Value) = 0 &amp; Len(cbo_fac3.Value) = 0 Then\n        MsgBox (\"Please select a first preference before selecting a second/third preference\")\n        cbo_fac1.SetFocus\n        Exit Sub\n    End If\n\n    If Len(cbo_fac2.Value) = 0 Then\n        MsgBox (\"Please select a second preference before selecting a third preference\")\n        cbo_fac2.SetFocus\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":426,"score":1,"question_id":11991308,"title":"How do I use checkboxes in an IF-THEN statement in Excel VBA 2010?","body":"<p>I need to use the value of checkboxes for an IF-THEN statement. Based on what the user checks, the way I have to calculate things changes. However, I can't figure out how to use the checkbox values, or how to detect them. Here is the code I have so far:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Range(\"E1:F7,A1:A4,B1:B4,C1:C3\").Select\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Range(\"A1\").Select\n    Range(\"A1\") = \"Time\"\n    Range(\"B1\") = \"Specimen Shape\"\n    Range(\"C1\") = \"Data Type\"\n    Range(\"A1:C1\").Font.Bold = True\n    Range(\"E1\") = \"Owner\"\n    Range(\"E2\") = \"Experiment Date\"\n    Range(\"E3\") = \"Specimen ID\"\n    Range(\"E4\") = \"Contaminant\"\n    Range(\"E5\") = \"Leachant\"\n    Range(\"E6\") = \"Temperature\"\n    Range(\"E7\") = \"Regression Title\"\n    Range(\"E1:E7\").Font.Bold = True\n    Columns(\"A:E\").EntireColumn.EntireColumn.Autofit\n    'Formatting Column A\n    Columns(\"A\").EntireColumn.ColumnWidth = 9.71\n    ActiveSheet.CheckBoxes.Add(4, 14.5, 72, 17.25).Select\n    Selection.Characters.Text = \"Days\"\n    Range(\"A6\").Select\n    ActiveSheet.CheckBoxes.Add(4, 30.5, 73.5, 17.25).Select\n    Selection.Characters.Text = \"Hours\"\n    ActiveSheet.CheckBoxes.Add(4, 45.75, 52.5, 17.25).Select\n    Selection.Characters.Text = \"Minutes\"\n    'Formatting Column B\n    ActiveSheet.CheckBoxes.Add(58, 14.5, 72, 17.25).Select\n    Selection.Characters.Text = \"Cylinder\"\n    ActiveSheet.CheckBoxes.Add(58, 30.5, 73.5, 17.25).Select\n    Selection.Characters.Text = \"Wafer\"\n    ActiveSheet.CheckBoxes.Add(58, 45.75, 52.5, 17.25).Select\n    Selection.Characters.Text = \"Irregular\"\n    'Formatting Column C\n    Columns(\"C\").EntireColumn.ColumnWidth = 12.71\n    ActiveSheet.CheckBoxes.Add(140.5, 14.5, 72, 17.25).Select\n    Selection.Characters.Text = \"Incremental\"\n    ActiveSheet.CheckBoxes.Add(140.5, 30.5, 72, 17.25).Select\n    Selection.Characters.Text = \"Cumulative\"\n    Columns(\"F\").EntireColumn.ColumnWidth = 60\n    Range(\"A1:C1\").HorizontalAlignment = xlCenter\n    Range(\"F1\").Select\n    Dim btn As Button\n    Dim rng As Range\n    With Worksheets(\"Sheet1\")\n        Set rng = .Range(\"A9:C9\")\n            Set btn = .Buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height)\n        With btn\n            .Caption = \"After making your selections above, click this button to continue.\"\n            .AutoSize = True\n            .OnAction = \"DataInput\"\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>What I want it to do, just as a test, is if the \"Time\" checkbox is checked, and then the button is pressed to continue, I want it to say something like \"YAY\", using an IF-THEN statement. If the \"Time\" checkbox is not checked and you press continue, I'd like it to say \"AWW...\".</p>\n\n<p>This is what I tried to make that happen, and it isn't working.</p>\n\n<pre><code>Sub DataInput()\n    If ActiveSheet.Shapes.Range(Array(\"Check Box 1\")).Value = True Then\n    MsgBox (\"Yay\")\n    Else: MsgBox (\"Aww\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13101209,"title":"match dates (lines) with columns on Excel","body":"<p>I have two sheets : </p>\n\n<pre><code>    Countries  |  Date\n    ---------------------------\n    France     | jun-13\n    Belgium    | jun-13\n    U.S        | aug-13\n    Canada     | sept-13\n    Sweden     | oct-13\n    Norway     | oct-13\n    Finland    | oct-13\n    ...        | ...\n</code></pre>\n\n<p>AND (expected result) in a sond sheet :</p>\n\n<pre><code>      jun-13   |  jul-13   |  aug-13   |  sep-13   |  oct-13   |  ...\n    --------------------------------------------------------------------------------\n      France   |           |    U.S    |  Canada   |  Sweden   |\n      Belgium  |           |           |           |  Norway   |\n               |           |           |           |  Finland  |\n               |           |           |           |           |\n</code></pre>\n\n<p>I would like to show the countries like the second table using only the informations in the first one. (i have a lot of data to do it manually)</p>\n"},{"tags":["mysql","excel","vb6"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13100207,"title":"VBA Excel -view multiple range of records on the same worksheet","body":"<p>i would like to display a range of records extracted from a database onto ms excel worksheet, for example if you have a record of 10 suppliers and would like to put this data on excel each on a new page on the same worksheet, without having to do it one by one, which is what i have currently.. I am using VB 6.0, and mysql database</p>\n\n<p>please help!!!</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13099677,"title":"Validate VBA drop down on click","body":"<p>I have a drop down select list in a VBA form I would like to validate as soon the user clicks on it. It needs to check that a pre-requisite drop down has been filled already. </p>\n\n<p>This is to avoid the user jumping ahead on the form because there are certain fields that need to be filled out first. My attempt so far is not working:</p>\n\n<pre><code>Private Sub cbo_moduleName_Click()\n\n    If Len(cbo_moduleCode.Value) = 0 Then\n        MsgBox (\"Please select a module code\")\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":42,"score":-2,"question_id":13099486,"title":"VBA code to hide rows n-maximum","body":"<p>Is there there any code in Excel 2010 VBA that I can use to hide <strong>row n (e.g. row 200)</strong> to the maximum row?</p>\n\n<p>Btw the name of the sheet in particular is <em>main</em>.</p>\n"},{"tags":["excel","excel-vba","excel-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3304,"score":0,"question_id":5196316,"title":"Formula that will repeat number X times and increased by a counter","body":"<p>I have the following problem: I need to repeat a given number, say 3 times.  I then need to repeat the next number the same amount of times.  So I need a formula to print, for instance, 111, 222, 333, 444 etc. each on a different row.  Can this be done?  Thanks.</p>\n"},{"tags":["excel"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":8529461,"title":"How can I plot the points of a curve?","body":"<p>I'm not great with Math at all and so-so with Excel.  I have a requirement to calculate a series of values to apply as an offset for a price schedule.  I know what I basically want to achieve with the offsets and how I want them to change across span of values but I don't know how I can plot these values or something close to it in Excel.  For an idea of the curve I'm roughly trying to create you can plot these values:</p>\n\n<pre><code>0\n20\n30\n35\n38\n39\n39.5\n40\n40.5\n40.75\n41\n41.125\n41.25\n</code></pre>\n\n<p>Or if you don't want to use excel you can take a look at this chart image:\n<img src=\"http://i.stack.imgur.com/nRweO.png\" alt=\"screen shot of chart of sample data above\"></p>\n\n<p>Now it was easy to quickly create that by entering some values and tweaking them to get a shape I roughly want, but I need 1000 data points!  In other words, instead of the 13 point I provided above I would need 1000.  This would be crazy to try and do manually.</p>\n\n<p>I can think of two possible options:</p>\n\n<ol>\n<li>Create the range of values with fewer points, then somehow\nextrapolate that data set into more points.  Maybe extrapolate isn't\ncorrect but essentially convert 10 points of data into 1000</li>\n<li>Interactively draw a curve and then have it plotted to values within\na defined min/max range</li>\n</ol>\n\n<p>I've tried googling for help but I'm just coming up with tons and tons of \"how to plot your data\" sites - I need to work from the OTHER direction ;)</p>\n\n<p>Thanks for any help or tips.</p>\n"},{"tags":["excel","vba","excel-formula"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":361,"score":2,"question_id":7661895,"title":"Looping through duplicates cells of a column and put a \"-NUMBER\" after","body":"<p>I have a huge spreadsheet and in one of the column there is SUPPOSED to be a unique identifier. But the problem is my client does not understand the importance of the \"uniqueness\" requirement.</p>\n\n<p>So I just don't want to go through the 7000 rows by hand and rename these. I know how to do loops, I know how to highlight duplicates cells but I don't know how to loop through duplicates and put a counter after them so if I have:</p>\n\n<pre><code>duplicate\nduplicate\nduplicate\n</code></pre>\n\n<p>it'll make:</p>\n\n<pre><code>duplicate-1\nduplicate-2\nduplicate-3\n</code></pre>\n\n<p>How do I do this?</p>\n"},{"tags":["excel","vba","excel-formula"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2232,"score":2,"question_id":7811736,"title":"Trim leading whitespace from Excel cells","body":"<p>How do I get rid of leading whitespaces in <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a>?</p>\n\n<p>I have quite a few rows with this problem.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":76,"score":1,"question_id":13088090,"title":"Count number of rows in worksheet","body":"<p>I want to count number of rows in Sheet1, from Sheet2 code.</p>\n\n<p>In sheet1 the following code works fine</p>\n\n<pre><code>ctr = Range(\"B2\", Range(\"B2\").End(xlDown)).Count\n</code></pre>\n\n<p>I tried the same code in Sheet2 code</p>\n\n<pre><code>recct = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B2\", Range(\"B2\").End(xlDown)).Count\n</code></pre>\n\n<p>I am getting <code>run time error 1004 Application -Defined or Defined error</code></p>\n\n<p>Thanks</p>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2351,"score":2,"question_id":5536202,"title":"Some but not all Excel numbers show as a date","body":"<p>I have a big .xls file. Some numbers show as a date.<br/>\n31.08 shows as 31.aug<br/>\n31.13 shows as 31.13 (that is what i want all columns to be)<br/>\nWhen I reformat 31.aug to number it shows as 40768,00 \nI have found no ways to convert 31.aug to 31.08 as a number. All I am able to do is to reformat 31.aug as d.mm and then it shows as 31.08 and when I try to reformat it from 31.08 to number it shows as 40768,00. No way to cheat Excel using different types of cell formats.</p>\n"},{"tags":["excel","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1060,"score":0,"question_id":5118113,"title":"Convert from .csv file to .xlsx excel file","body":"<p>Hi \nI am using an ASP.NET application and producing a report in excel page with .csv extension.   However I would like to produce it with .xlsx etension.\nThe code I am currently using is as follows:\nProtected Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnSubmit.Click</p>\n\n<pre><code>    Dim sql As String\n    Dim strLine As String = \"\"\n    Dim attachment As String = \"attachment; filename=PTW.csv\"\n\n    m_sBranch = ddlBranches.SelectedValue\n    m_sRegion = ddlAreas.SelectedValue\n\n    Dim cnn As SqlConnection = New SqlConnection(\"Server=XYZ;Database=abc;Trusted_Connection=yes;\") \n\n    HttpContext.Current.Response.AddHeader(\"content-disposition\", attachment)\n    HttpContext.Current.Response.ContentType = \"text/csv\"\n\n    cnn.Open()\n\n    sql = GetReportSql(m_sBranch, m_sRegion)\n\n    Dim cmd As SqlCommand = New SqlCommand(sql, cnn)\n    Dim dr As SqlDataReader\n    dr = cmd.ExecuteReader()\n\n    HttpContext.Current.Response.Write(\"PTW JOBS - EXPORTED ON \" + DateTime.Now)\n\n    For i = 0 To dr.FieldCount - 1\n        strLine = strLine &amp; dr.GetName(i).ToString &amp; \",\"\n    Next\n    HttpContext.Current.Response.Write(strLine)\n\n    Dim sb As StringBuilder = New StringBuilder()\n    Dim temp As String = \"\"\n    While dr.Read()\n        For i = 0 To dr.FieldCount - 1\n            temp = temp &amp; dr.GetValue(i)\n            temp = temp.Replace(\",\", \" \")\n            sb.Append(temp &amp; \",\")\n            temp = \"\"\n        Next\n        sb.AppendLine()\n        strLine = \"\"                            \n    End While\n\n    HttpContext.Current.Response.Write(sb.ToString())\n\nEnd Sub\n</code></pre>\n\n<p>Any help will be highly appreciated.  Thanks.</p>\n"},{"tags":["string","excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":13020165,"title":"VBA split cell string into two separate strings and put them in different cells","body":"<p>I am unable to split a single cell's value into two different strings and put both of those strings in different cells. </p>\n\n<p>For instance I want to take a measurement <code>10ft x 20ft</code> value in a cell and take the <code>10ft</code> and put it in another cell, and take the <code>20ft</code> and put it in a completely different cell. </p>\n\n<p>I'd like to use a delimiter <code>x</code> or something, but I just don't know how to take those separations and do something with them after the split.</p>\n\n<p>Any tips would be much appreciated.  I'm still pretty new to VBA macros.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","excel","vsto","com-interop"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":50,"score":4,"question_id":13094996,"title":"Keeping track of sheets added and removed","body":"<p>I'm working on an Excel addin and have hit a roadblock. </p>\n\n<p>I wish to update a combobox with the sheets in the Excel workbook. Currently I'm able to do this with a foreach loop. However, this is limited in the sense it only picks up added or subtracted sheets when I run it. My addin looks tacky with a \"refresh sheets\" button and I would like to avoid that if possible.</p>\n\n<p>Ideally I'd be able to databind the worksheet object to the combobox so it's updated on-the-fly without my intervention. However, my research has turned up that it doesn't support that. I haven't tried it, as I'm not in front of my dev computer until later, but I'm almost positive since it doesn't inherit IList it won't work as a datasource.</p>\n\n<p>Has anyone done anything similar? I'd really like to get this thing working right.</p>\n\n<p>Thank you!  </p>\n"},{"tags":["regex","excel","vba","vlookup"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":80,"score":0,"question_id":13075067,"title":"EXCEL/VBA: Column header and values are offset, how to get them synchronized","body":"<p>I am using an output file (CSV) wich is coming from an external source - used to do data scraping.</p>\n\n<p>However, web pages that are \"scrapped\" doesn't have the same exaction pattern, so in the output file (Excel), I have column that are offset. Fortunaltly, the values contains the name of the header , so I am looking a solution to solve the \"offset\" problem. </p>\n\n<p>PS: Some rows are offset, some not. The offset can be by 1, 2 or more cell, so i can't do: value(i+1)  = i as there is no logic</p>\n\n<p>Download File <a href=\"https://www.dropbox.com/s/omnu1452pmv4o98/SORTcannodale2013.csv\" rel=\"nofollow\">Here</a>, or same info here:</p>\n\n<pre><code>FRAME           BRAKES         SADDLE         WHEELS          etc….\nbrakes: info1   saddle:info1   wheels:info1     \nframe:info2     brakes:info2   saddle:info2   wheels: info2 \nbrakes: info3   saddle:info3   wheels:info3     \n</code></pre>\n\n<p>I dont know if vlookUp, combined with some regex could do the trick,</p>\n\n<p>What do you suggest ?</p>\n\n<p>EDIT: \nDownload File <a href=\"https://www.dropbox.com/s/omnu1452pmv4o98/SORTcannodale2013.csv\" rel=\"nofollow\">Here</a></p>\n\n<p>VBA CODE </p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim Titles As Variant\nDim Data As Variant\nDim Dataline As String\nDim NumDataPoints As Long\nDim FirstTitle As String\nDim WhichTitle As Long\nDim Offset As Long\nDim rowcount As Long\n\nOpen \"SORTcannodale2013.csv\" For Input As #1\n\nLine Input #1, Dataline\n\nTitles = Split(Dataline, \",\")\nFor Offset = 0 To UBound(Titles)\n    Cells(1, Offset + 1) = Titles(Offset)\nNext\n\nrowcount = 2\n'While Not EOF(1)\n    Line Input #1, Dataline\n    Data = Split(Dataline, Chr$(34) &amp; \",\" &amp; Chr$(34))\n\n    FirstTitle = LCase(Left(Data(0), InStr(Data(0), vbLf) - 1))\n    For WhichTitle = 0 To UBound(Titles)\n        If Titles(WhichTitle) = FirstTitle Then Exit For\n    Next\n    For Offset = WhichTitle To UBound(Titles)\n        Cells(rowcount, Offset + 1) = Data(Offset - WhichTitle)\n    Next\n    rowcount = rowcount + 1\n'Wend\n\nClose #1\n\nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":4098,"score":4,"question_id":1088539,"title":"Using templates in excel with C#","body":"<p>As part of the c# program that I am producing I need to generate 1 workbook containing; 2 different worksheets and a 3rd that could be produced any number of times, what is the most effective way of doing this? I have looked into using templates although I am unsure how to repeat certain worksheets whilst only displaying others once.  Any help or advice would be appreciated.</p>\n"},{"tags":["c#","excel","exception","sql-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13096077,"title":"Catch clause for endless repeating number","body":"<p>I am loading values from excel in C#, which is then turned into a string which I then want to save in SQL Server 2008 R2. How can I catch or reformat floats like 0.3333333333?</p>\n\n<p>I get the following error: Specified cast is not valid.</p>\n"},{"tags":["excel","vsto","word","ole"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13096234,"title":"Passing extra data by OLE Object","body":"<p>I have I Excel Add-In (C#) that converts excel formulas to TeX and then uses MathTypeEquation OLE Object to present the ready equation.  It all works quite nice in Excel but now I need to find the way to link it with Word:user creates equation in Excel, copies it via clipboard and pasts it in Word, when the contents of equation changes in Excel user can just click \"Update\" button in Word, and then get the updated equation contents of MathType OLE Object that pasted to Word  . The thing i need is to pass The filename, cell adress and some extra data about the way that the equation is generated. </p>\n\n<p>Any possible way of sticking some data (just a string) to Math Type OLE object ? I assume there can be no files etc, just the OLE object.</p>\n"},{"tags":["excel","vba","filter","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7700,"score":0,"question_id":1296026,"title":"How to get all filtered data rows in excel (with hidden columns)?","body":"<p>My data sheet has filters and hidden columns. When filter(s) applies, I need to loop through all filtered data. I use: \n  Excel.Range visibleRange =  this.UsedRange.SpecialCells(XlCellType.xlCellTypeVisible, missing) as Excel.Range;</p>\n\n<p>Now visibleRange.Rows.Count is 0; use foreach loop \"foreach(Excel.Range row in visibleRange.Row)\"   row doesn't have all the columns, chopped from the first hidden column.</p>\n\n<p>How could we loop through the filtered rows?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13095470,"title":"If statement accessing data in another workbook in excel-vba","body":"<p>I am currently trying to program a macro. </p>\n\n<ul>\n<li>I am writing the macro in a new black workbook (this is part of the requirement) and I have a lot of data in a different workbook. </li>\n<li>I need to use the macro to read the data in that different workbook and spit out errors encountered for each column and write it in the blank workbook (that i am programming macro in). </li>\n<li>So for each column it's suppose to have list of row numbers an error was encountered (and nothing else). I'm trying to write an If statement to do this and i keep getting an error message stating \"expected then or go to\". </li>\n</ul>\n\n<p>This is what I have so far:</p>\n\n<p><code>If [Dataset1.xls]Data1!R2C1=53 AND [Dataset1.xls]Data1!R2C1=453 AND [Dataset1.xls]Data1!R2C1=953 Then</code></p>\n\n<p>The dataset1.xls is the workbook that holds all the data and Data1 is the sheet in that workbook with all the data. I might be accessing the separate workbook totally wrong. Can you guys please help. Thank you very much in advance.</p>\n\n<p>This is most of the code:</p>\n\n<pre><code>Dim numrow As Long\nDim count As Long\ncount = 2\n\nWith Workbooks(\"Dataset1.xls\").Sheets(\"Data1\")\nnumrow = .Range(\"A1\", .Range(\"A1\").End(xlDown)).Rows.count\n\nEnd With\nDo Until count = numrow\nIf [Dataset1.xls]Data1!R2C1&lt;&gt;53 AND [Dataset1.xls]Data1!R2C1&lt;&gt;453 AND [Dataset1.xls]Data1!R2C1&lt;&gt;953 Then  \n\nEnd If\ncount = count + 1\nLoop\n</code></pre>\n"},{"tags":["excel","dropbox","password-protection","password-encryption"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12839475,"title":"Why does excel's content change when its password is modified?","body":"<p>I tested it by assigning an excel a password. This excel was kept in dropbox, and as I assigned a password to the excel, it was entirely downloaded on every comp that it was shared with. Is there a way that I assign the password and the whole file does not get modified? I am sure that it is not an issue with Dropbox as this is what happened with SugarSync as well.</p>\n"},{"tags":["python","excel","testing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13095120,"title":"reading column from excel and doing specific math","body":"<p>I have an excel file that has 27 columns. I want to write a python code which reads column by column and stores the final 5 values in the coloum which will have math equations done on them. </p>\n\n<p>I have this so far:</p>\n\n<pre><code>from math import tan\n\n#Write Header\n#outFile.write('Test Name,X+ avg,X+ std,X+ count,X- avg,X- std,X- count,X angle,Y+ avg,Y+ std,Y+ count,Y- avg,Y- std,Y- count,Y angle\\n')\n\n#for line in inFile:\n\n\nif 1==1:\n\n    line = [1,2,38.702,37.867,35.821, 44, 49,55,65,20,25,28,89.]\n\n    line0= len(line)\n    print \"the list size\"\n    print line0\n\n    line1 = len(line) -5  #takes the overall line and subtracts 5. \n    print \"the is the start of the 5 #'s we need\"\n    print line1 #prints the line\n\n    d= line[line1:line0]       #pops all the values from in the line (..)\n    print \"these are the 5 #'s we need\"\n    print d\n\n    lo=min(d)\n    hi=max(d)\n\n\n    print \"the lowest value is\"\n    print lo\n\n\n    print \"the highest value is\"\n    print hi\n\n    average1 = float (sum(d))/ len(d)   #sum\n    print \"the average of the values is\"\n    print average1\n</code></pre>\n\n<p>the \"line = [1,2,38.702,37.867,35.821, 44, 49,55,65,20,25,28,89.]\" part I want python to automatically read in the coloumn, store the 5 last vales and  do the above math analysis.</p>\n"},{"tags":["excel","google","google-docs","formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13094185,"title":"Google Docs multiple criteria counting formula","body":"<p>I would like to create a Google Docs formula which will count and sum, how many times ONE OF the words appear in the column. i.e.I have values in Sheet1 - column A, and in Sheet2 - column A1 I would like to count (sum), how many times Google <strong>OR</strong> Yahoo <strong>OR</strong> Ask appears in Sheet1-column A, (see the example). How this can be done? Thanx!</p>\n\n<p><img src=\"http://i.stack.imgur.com/TNw4P.png\" alt=\"enter image description here\">  </p>\n"},{"tags":["c#","vb.net","excel","replace","find"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13094404,"title":"replace excel cell values in C# windows application","body":"<p>I have a excel template, where we have different predefined fields like CustomerName, CompanyName, Address etc.  All this things are in single cell and this cell is named as \"Customer\" and similarly we have another cell called \"Sender\" having fields related to sender details. My job is to find Customer and Sender cells and replace the values that they contain with the actual values, For example i need to find \"Customer\" Cell and will replace CustomerName with actual name \"John\", ComanyName with \"XYZ\" and so on for other fields, same task is for Sender Cell. </p>\n\n<p>I am using Microsoft.Office.Interop.Excel to implement this task as follows.</p>\n\n<p>xlWorkSheet.Cells.Replace(\"CustomerName\", \"John\", Excel.XlLookAt.xlPart, missingValue, missingValue, missingValue, missingValue, missingValue);</p>\n\n<p>xlWorkSheet.Cells.Replace(\"CompanyName\", \"XYZ\", Excel.XlLookAt.xlPart, missingValue, missingValue, missingValue, missingValue, missingValue);</p>\n\n<p>The problem is all this fields in a single cell, and i need to find different fields and replace their values, if a fields values is not then shifting the remaining fields up to fill the empty space.  </p>\n\n<p>Please provide solution. </p>\n"},{"tags":["excel","vba","excel-vba","printing","print-preview"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4190,"score":3,"question_id":1371107,"title":"Difference between print and print preview events in excel vba","body":"<p>I have some code which intercepts the <code>Before_Print</code> event in excel to make sure that the user has filled in all the required fields before they print the sheet.  However, I only want this code to fire when the user is actually printing, not when they are just calling the print preview.</p>\n\n<p>Is there any way to tell in the <code>Before_Print</code> code whether the user is actually printing or just previewing?</p>\n\n<p>The code that I currently have is (event stub was generated by excel):</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    If Not Sheet2.CheckAllFieldsFilled Then\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","declare"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13086829,"title":"VBA in Excel: \"Can't find project or library\" error when executing in 2007","body":"<p>Using VB for Excel in Excel 2003, I have no problems executing code with some non-declared variables:</p>\n\n<pre><code>numberOfBooks = 0\n</code></pre>\n\n<p>However, if I try to execute the same code in Excel 2007, I get a \"Can't find project or library\" error message.</p>\n\n<p>I looked at Tools > Options and I don't have checked \"Require Variable declaration\". In Excel 2003 I did not use Option Explicit</p>\n\n<p>What am I doing wrong? Thank you very much.</p>\n"},{"tags":["excel","macros"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":31,"score":1,"question_id":13089942,"title":"Macro copy formula until empty","body":"<p>I've done maybe one other macro in my life, but have sold my boss on the \"push one button and it's done for you\" aspect. </p>\n\n<p>I get my data from a system that can export to Excel, but formatting is \"picture-like\" and not in normal spreadsheet form (ie: names in merged cells accross the top of each set of headers, time, and data; then repeat for per case) so sorting and subtotals are impossible. And, of course, it's all in text.</p>\n\n<p>I unmerged all and inserted a blank column (C). Some cells in Column B have activity time (ie: \"Act: 00:15\") others have repeated headings. I need to place this formula in column C \"=mid(B#,7,5)\" in order to \"sort-out\" the time value, but only if the word \"Act:\" shows up in column B. Then, I need to copy or repeat the formula down column C (which will have varying lengths per each report) and subtotal each case as well as grand total.</p>\n\n<p>I've tried \"dim\" and \"do...loop\" and \"find/next\" and even some \"R1C1\", but I'm obviously out of my league.  Is anyone intrigued yet?</p>\n\n<pre><code>Do \n    Cells.Find(What:=\"act:\", After:=ActiveCell, LookIn:=xlFormulas, _\n            LookAt :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:= False, SearchFormat:=False).Activate \n\n    ActiveCell.Offset(0, 1).Activate \n    ActiveCell.FormulaR1C1 = \"=MID(act,7,5)\" \n    ActiveCell.Offset(1, -1).Activate \nLoop While ActiveCell = \"Email me\"\n</code></pre>\n"},{"tags":["excel","pivot-table"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4348,"score":1,"question_id":84769,"title":"Excel 2007 pivot tables - how to use calculated fields when connecting to a data cube?","body":"<p>Can you use calculated fields in Excel 2007 pivot tables when the data source is an SSAS data cube?</p>\n\n<p>I am connecting to a SQL Server 2005 data cube with Excel 2007 and viewing the data though a pivot table. I want to create calculated fields in my pivot table, but the \"Formulas\" button is grayed out. </p>\n\n<p>How do I do create calculated fields (if it is possible when connecting to a data cube) ?</p>\n"},{"tags":["excel","vba","excel-vba","excel-2003","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":191,"score":4,"question_id":11730025,"title":"Incorrect value when counting cells in different versions of Excel","body":"<p>I have seen some SO users run into an issue when trying to use some variation of <code>Cells.Count</code>; the VBA code throws an overflow error in some cases. </p>\n\n<p>For reference, see comments on <a href=\"http://stackoverflow.com/a/11698727/698590\">this answer</a>:</p>\n\n<blockquote>\n  <p>I think this will work, but I get an \"overflow\" error and it points me\n  to the code \"If Master.Cells.SpecialCells(xlCellTypeVisible).Count > 0\n  Then\" --- it seems like it's not filtering for anything in particular\n  – user1556069</p>\n</blockquote>\n\n<p>and <a href=\"http://stackoverflow.com/a/11690898/698590\">this answer</a>:</p>\n\n<blockquote>\n  <p>Is this onyl working (and Cells.Count didnt work) because the latter\n  used an integer, 16 bits, max value of 65,536 and the whole\n  spreadsheet returned a numbr greater? – fast_code</p>\n  \n  <hr>\n  \n  <p>I'm assuming that somewhere behind the scenes VBA is trying to coerce\n  the cell count to a small Integer (16-bit) or Long integer (32-bit).\n  The cell count of an Excel 2007 worksheet would overflow both of those\n  datatypes. Unfortunately I can't isolate it right now because I don't\n  have a copy of Excel 2007 handy and cannot actually reproduce your\n  error. – mwolfe02</p>\n</blockquote>\n\n<p>Trying to understand this, I tried to reproduce myself and got an overflow when trying to assign <code>Cells.Count</code> as an Integer. This makes sense as the value is too large for the Integer data type.</p>\n\n<p>Using the code below in both Excel 2003 and 2010, I was given a numeric result when trying to assign as a Long or Variant.</p>\n\n<pre><code>Option Explicit\n\nSub testInteger()\n    Dim i As Integer\n    i = Cells.Count 'Overflow\n    Debug.Print i 'Doesn't get this far...\nEnd Sub\n\nSub testLong()\n    Dim l As Long\n    l = Cells.Count\n    Debug.Print l 'Prints 16777216 in both versions\nEnd Sub\n\nSub testVariant()\n    Dim v As Variant\n    v = Cells.Count\n    Debug.Print v 'Prints 16777216 in both versions\nEnd Sub\n</code></pre>\n\n<p>As you can see in my comments, the <code>Cells.Count</code> value is <code>16777216</code> (which is correct for 2003), but it is the same <em>for both versions</em>, and that doesn't make sense to me. To quote <a href=\"http://stackoverflow.com/users/154439/mwolfe02\">mwolfe02</a> from one of the above-linked answers:</p>\n\n<blockquote>\n  <p>Excel 2007 worksheets have 1,048,576 rows and 16,384 columns for a total of 17,179,869,184 cells.</p>\n</blockquote>\n\n<p>Which tells me the value printed in 2010 should be at least (I believe it should really be the same) <code>17,179,869,184</code>. </p>\n\n<p><strong>So why does this number not print correctly/why is the 2003 value returned in 2010?</strong></p>\n"},{"tags":["excel","save","export-to-excel","powerbuilder"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":174,"score":0,"question_id":12167057,"title":"Powerbuilder - Keep Column names when saving as Excel format","body":"<p>I am kind of new to PowerBuilder and I'd like to know if it was possible to keep the \"visible\" value of a column name when using the SaveAs() Method of my DataWindow. Currently, my report shows columns like \"Numéro PB\" or \"Poste 1-3\", but when I save, it shows the Database's names. ie: \"no_pb\" and \"pos_1_3\"... </p>\n\n<p>As I am working on a deployed application, I have to make my changes and implementations As user-friendly as possible, and they won't understand anything of that.</p>\n\n<p>I already use the dw2xls api to save an exact copy of the report, but they want to have an option saving only the raw data, and I don't think I can achieve it using their API.</p>\n\n<p>Also, I was asked not to use the Excel OLE object to do it...</p>\n\n<p>Anyone's got an idea?</p>\n\n<p>Thanks, \nMichael</p>\n"},{"tags":["excel","styles","openpyxl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":11121300,"title":"Openpyxl , how to preserve .xlsx file style which was before , after saving it with openpyxl .save() function?","body":"<p><em>I have an issue with openpyxl library.</em> </p>\n\n<p><strong>Problem:</strong> </p>\n\n<p>When i used xlwt  , opened some .xls file , wrote some cells in there , the styles of cells i didn't touch remained the same . But now i have to work with xlsx documents , so i chose openpyxl for this . But the thing is that it completely strips the style of a document , even the cells i didn.t touch at all , after saving it with a .save function . </p>\n\n<p><strong>Any suggestions how i can preserve the style ?</strong></p>\n"},{"tags":["excel","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13092121,"title":"Close then Open Workbook","body":"<p>I have a need to close the workbook i have a macro in and then reopen it after closing.</p>\n\n<p>It is at the end of a process that makes various changes in some setting values and then saves a copy of the changed file.  after saving the changed file, i then want to Close the current workbook (no save changes) and then open it so that way i can open it as it was before the changes occurred.</p>\n\n<p>If there is a better way than Close then Open, by all means ill take advise.</p>\n\n<p>This logic needs to happen in the Workbook and not anywhere outside of the Working Workbook, IE no Personal.xlsm or other personal method locations that will not travel with the workbook.</p>\n"},{"tags":["java","excel","apache-poi","sheet"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13090313,"title":"how to copy a sheet between excel workbooks in java with apache poi","body":"<p>How can i copy an sheet between two different workbooks in apache poi?</p>\n\n<p>the methode is missing refering <a href=\"http://www.coderanch.com/t/420958/open-source/Copying-sheet-excel-file-another\" rel=\"nofollow\">this</a> thread. there is nothing such an solution.</p>\n"},{"tags":["c#",".net","excel"],"answer_count":34,"favorite_count":239,"up_vote_count":341,"down_vote_count":2,"view_count":257231,"score":339,"question_id":151005,"title":"Create Excel (.XLS and .XLSX) file from C#","body":"<p>What is the best tool for creating an Excel Spreadsheet with C#?</p>\n\n<p>Ideally, I would like open source so I don't have to add any third party dependencies to my code, and I would like to avoid using Excel directly to create the file (using OLE Automation.)  </p>\n\n<p>The .CSV file solution is easy, and is the current way I am handling this, but I would like to control the output formats.</p>\n\n<hr>\n\n<p>EDIT:  I am still looking at these to see the best alternative for my solution.  Interop will work, but it requires Excel to be on the machine you are using.  Also the OLEDB method is intriguing, but may not yield much more than what I can achieve with CSV files.   I will look more into the 2003 xml format, but that also puts a > Excel 2003 requirement on the file.  </p>\n\n<p>I am currently looking at a port of the PEAR (PHP library) Excel Writer that will allow some pretty good XLS data and formatting and it is in the Excel_97 compatible format that all modern versions of Excel support.  The PEAR Excel Writer is here:  <a href=\"http://pear.php.net/package/Spreadsheet_Excel_Writer\" rel=\"nofollow\">PEAR - Excel Writer</a></p>\n"},{"tags":["sql","excel","biztalk"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":13051071,"title":"Create an excel output file from Biztalk as resulting of a query from SQL","body":"<p>I have a query in SQL Server that returns me 5 columns with some data.</p>\n\n<p>I want to create a BizTalk application that saves me the result of my query in an Excel file.\nI will create a SP for polling, using wcf adapter to do the communication between BT and SQL.</p>\n\n<p>I don't know how to generate a <code>file.xls</code>. Is it possible?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":13080570,"title":"How to get the browse file path in text box using VBA?","body":"<p>How to get the browse file name into text box ? if get the file path, how to split the file name?</p>\n\n<p>I tried <code>application.GetOpenFilename(\"Text Files(*.txt),*.txt\")</code></p>\n\n<p>Please advise to display into the text box and how to split the exact file name only to read the text file?</p>\n"},{"tags":["excel","excel-vba","excel-2007"],"answer_count":12,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":7313,"score":4,"question_id":4902703,"title":"Excel chart won't update","body":"<p>I have an Excel document (2007) with a chart (Clustered Column) that gets its Data Series from cells containing calculated values</p>\n\n<p>The calculated values never change directly, but only as a result of other cells in the sheet changing</p>\n\n<p>When I change other cells in the sheet, the Data Series cells are recalculated, and show new values - but the Chart based on this Data Series refuses to update automatically</p>\n\n<p>I can get the Chart to update by saving/closing, or toggling one of the settings (such as reversing x/y axis and then putting it back), or by re-selecting the Data Series</p>\n\n<p>Every solution I have found online doesn't work</p>\n\n<ul>\n<li>Yes I have Calculation set to\nautomatic</li>\n<li>Ctrl+Alt+F9 updates everything fine, EXCEPT the chart</li>\n<li>I have recreated the chart several times, and on different computers</li>\n<li><p>I have tried VBA scripts like:</p>\n\n<p><code>Application.Calculate</code><br>\n<code>Application.CalculateFull</code><br>\n<code>Application.CalculateFullRebuild</code><br>\n<code>ActiveWorkbook.RefreshAll</code><br>\n<code>DoEvents</code>  </p></li>\n</ul>\n\n<p>None of these update or refresh the chart</p>\n\n<p>I do notice that if I type over my Data Series, actual numbers instead of calculations, it will update the chart - it's as if Excel doesn't want to recognize changes in the calculations</p>\n\n<p>Has anyone experienced this before or know what I might do to fix the problem?\nThank you</p>\n"},{"tags":["c#","excel","com","32bit-64bit","rpc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13089974,"title":"RPC_E_SYS_CALL_FAILED exception from Excel when accessed from Out of proc C# COM server after long time","body":"<p>I use 64 bit office and the C# Out of proc server runs in 32 bit mode.\nFrom a excel macro - invoke a C# out of proc server - Launch modal dialog from the C# out of proc server - close the dialog after 15 mins and accessing any excel application's property(after the \"frm.ShowDialog()\" modal dialog code) throws RPC_E_SYS_CALL_FAILED exception.\nAny timeout will happen..!? Why RPC_E_SYS_CALL_FAILED exception if it takes long time for the dialog to respond. </p>\n\n<p>VBA Code:</p>\n\n<pre><code>Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)\nSet obj = CreateObject(\"CSExeCOMServer.SimpleObject\")\nobj.Parent = ActiveWorkbook.Application\nobj.ShowDlg\nEnd Sub\n</code></pre>\n\n<p>C#out of proc server:\n<a href=\"http://code.msdn.microsoft.com/windowsdesktop/CSExeCOMServer-f2a59967\" rel=\"nofollow\">http://code.msdn.microsoft.com/windowsdesktop/CSExeCOMServer-f2a59967</a></p>\n\n<p>Added a property \"Parent'  to set application variable.</p>\n\n<p>and a Interface Function 'ShowDlg\" that has the implementation :</p>\n\n<pre><code>public\nvoid ShowDlg()\n{\ntry\n{\nif (m_ExcelAppVar != null)\n{\nm_ExcelAppVar.DisplayAlerts = \nfalse;\n}\n// Display modal dialog and Wait for 15 mins\nForm objForm = new Form();\nobjForm.ShowDialog(); \nif (m_ExcelAppVar != null)\n{\nMessageBox.Show(m_ExcelAppVar.Name);\n}\n}\ncatch (Exception ex) \n{\nMessageBox.Show(ex.Message + ex.StackTrace);\n}\n}\n</code></pre>\n\n<p>IMessagefilter - if implemented in the C# server 'RetryRejectedCall\" is not getting called.\nAlso it has no set time out option.</p>\n"},{"tags":["excel","usb","hid"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4141,"score":1,"question_id":1275974,"title":"Program for HID USB Scale","body":"<p>I'm looking for a program that can read the weight on a USB scale, namely the Pelouze 10lb USB Portable Scale. I thought it would have a virtual COM port driver but instead, it uses HID drivers. I've been searching for a whole month for a program that can help me transfer the reading of the scale to Microsoft Excel. Can someone help me out or point me in the right direction? I am absolutely illiterate to programming. Much gratitude any help given.</p>\n"},{"tags":["c#",".net","excel","ms-office"],"answer_count":32,"favorite_count":121,"up_vote_count":188,"down_vote_count":1,"view_count":148599,"score":187,"question_id":15828,"title":"Reading Excel files from C#","body":"<p>Is there a free or open source library to read Excel files (.xls) directly from a C# program? </p>\n\n<p>It does not need to be too fancy, just to select a worksheet and read the data as strings. So far, I've been using Export to Unicode text function of Excel, and parsing the resulting (tab-delimited) file, but I'd like to eliminate the manual step.</p>\n"},{"tags":["excel","vba"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13085345,"title":"Looking for a reference that explains the use of vba classes","body":"<p>I am learning <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> and now I am trying to start using classes because I see that otherwise my programs are too hard to work with and I always writing the similar pieces of code over and over.</p>\n\n<p>Can you recommend any book that covers user-defined objects in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> well? Because everything that I found just gives a short introduction on this subject.</p>\n\n<p>While I was searching for such a book, I found a lot of advanced books on <a href=\"/questions/tagged/vb.net\" class=\"post-tag\" title=\"show questions tagged 'vb.net'\" rel=\"tag\">vb.net</a>. As I understood this language is more \"powerful\" (can be used for wider variety of tasks). </p>\n"},{"tags":["excel","if-statement","calc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13089223,"title":"Issue with Excel/openoffice Calc nested if statement","body":"<p>I have just about no experience messing around with formulas in Excel, but I'm trying to hack something together for someone who can't get their macros to work.</p>\n\n<p>Essentially, I've done a sort list of a set of data, and need to grab the top four items. Using VLookup or Index seems to make the most sense, but the way the table is formatted (which for various reasons I can't change)  it doesn't seem like I'll be able to get them to work (if I could switch the column/row definitions in them, then I could, but I'm not sure if I can/how). So anyway, I've got this long nested if statement I've thrown together that should do the trick, but it's throwing me a 509 error for a missing element. I've done just about everything I could think of to figure out what's going on, with no luck.</p>\n\n<p>So here it is:</p>\n\n<pre><code>=IF(AO2=13, D2, IF(AP2=13, E2, IF(AQ2=13, F2, IF(AR2=13, G2, IF(AS2=13, H2, IF(AT2=13, I2, IF(AU2=13, J2, IF(AV2=13, K2, IF(AW2=13, L2, IF(AX1=13, M2, IF(AY2=13, N2, IF(AZ2=13, O2, IF(BA2=13, P2, \"foo\")))))))))))))\n</code></pre>\n\n<p>where the A02... values are the sort list (so index number 13 corresponds to the highest value in D2:P2) and the D2... is the corresponding value list I want it to return.</p>\n\n<p>I was wondering if somebody could take a quick look and see if anything jumps out at them. I'm sure it's stupid and/or structural, but I can't get it working.</p>\n\n<p>P.S. - I'm using Calc on a .xlsx file, but I'm pretty sure that should make no difference.</p>\n"},{"tags":["excel","file","text","rows"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13077740,"title":"Create text Files from every row in an Excel spreadsheet","body":"<p>I need help creating separate text files from each row in an excel spread sheet called \"worksheet\".  I want the text files to be named with content of Column A, with columns B-G being the content, preferably with a double hard return between each column in the text file, so each column will have a blank line in between them.</p>\n\n<p>Is this possible?  How would I go about it.  thanks!</p>\n"},{"tags":["sql-server-2008","excel","ssis"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13086976,"title":"SSIS with Excel sheets","body":"<p>I have created ssis package to loda data from excel to database. My problem is Those excel files proteced with password( I know the password) at the minute i am removing password mannually. Is there any way to automate in ssis, Because i have 200 excel files.</p>\n"},{"tags":["sql","excel","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13088241,"title":"OLEDB Named Parameters and Group By: \"?\" won't work","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8857090/group-by-using-parameters-in-sql\">GROUP BY using parameters in SQL</a>  </p>\n</blockquote>\n\n\n\n<p>Here is my SQL string for a OLEDB query of a .xlsx file</p>\n\n<pre><code>szSQL = \"SELECT cawo_wo_id, wows_step_id, wows_description, wffj_cur_state_desc, cawo_wo_id &amp; wows_step_id AS p5_id FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; sourceRange$ &amp; \"] WHERE [wows_description] like '%ECR%';\"\n</code></pre>\n\n<p>I understand that named parameters are not supported by OLEDB, but why will it not work with a 'group by' using \"?\" as the parameter?</p>\n\n<p>Like so:</p>\n\n<pre><code>szSQL = \"SELECT cawo_wo_id, wows_step_id, wows_description, wffj_cur_state_desc, cawo_wo_id &amp; wows_step_id AS p5_id FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; sourceRange$ &amp; \"] WHERE [wows_description] like '%ECR%' GROUP BY ?;\"\n</code></pre>\n\n<p>Thanks for any help.</p>\n"},{"tags":["java","excel","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13085615,"title":"Excel 2010 getting alerts on closing workbook","body":"<p>I am using Excel 2010 and I am using java excel connector library (from www.moyosoft.com ) to open, read/write and close excel files. </p>\n\n<p>I do not want to see any alerts while closing the workbook if it is not saved so I am using setDisplayAlerts to False.</p>\n\n<p>But it is not working in Excel 2010. In Excel 2007, it used to work fine.</p>\n\n<p>I searched on internet and came across this <a href=\"http://social.msdn.microsoft.com/Forums/sv/exceldev/thread/adbad831-d9fc-402a-9a00-8252d6fde3d4\" rel=\"nofollow\">link</a> and it says to set property AskToUpdateLinks to false. I did that also but i still get a pop up while closing the workbook.</p>\n\n<p>Any ideas what I am missing and how can it be resolved?</p>\n\n<p>Rgds,\nSapan</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13084366,"title":"How to concatenate two cells without space in excel?","body":"<p>I have two columns in my excel sheet like that:</p>\n\n<pre><code>1234  |  548\n21596 |  1875\n</code></pre>\n\n<p>When i concatenate this two field by doing   <code>=A1&amp;B1</code>  then it give me   <code>1234 548</code> with space between the two values.</p>\n\n<p>Why it put a space and how can I erase it? It's for populate a database, so I don't want a space between my values. Any ideas please? </p>\n"},{"tags":["python","excel","win32com"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12296563,"title":"How to draw a chart with excel using python?","body":"<p>Hi I intend to draw a chart with data in an xlsx file.\nIn order to keep the style, I HAVE TO draw it within excel.\nI found a package named win32com, which can give a support to manipulate excel file with python on win32 platform, but I don't know where is the doc.....</p>\n\n<p>Another similar question is how to change the style of cells, such as font, back-color ?\nSo maybe all I wanna know is the doc, you know how to fish is more useful than fishes.... and an example is better.</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13082641,"title":"How to prevent numbers to get converted to dates in Excel?","body":"<p>I'm trying to copy paste numberic data from database to Excel. In the database the decimal separator is dot (.) and in my Excel the decimal separator is comma (,). Now when I copy paste this data from the database to excel, numberic data is converted to dates. How to prevent this and get data converted to numbers (with comma decimal separator)?</p>\n\n<p>Data:</p>\n\n<pre><code>1.2\n1.3\n1.4\n</code></pre>\n\n<p>Converts to (in my locale)</p>\n\n<pre><code>1.helmi\n1.maalis\n1.huhti\n</code></pre>\n\n<p>Although is should be</p>\n\n<pre><code>1,2\n1,3\n1,4\n</code></pre>\n"},{"tags":["c#","excel"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":182,"score":1,"question_id":11820769,"title":"How to release objects which are created for Excel (C#)","body":"<p>I use some objects like workbook, worksheet, app for Excel tasks. After I am done with Excel, I try releasing them by the code below. After all, I still see EXCEL.EXE at Task Manager. Why doesn't it release completely?</p>\n\n<p><strong>My class for Excel tasks:</strong></p>\n\n<pre><code>Excel._Application app = new Excel.Application();\nExcel._Workbook workbook = app.Workbooks.Add(Type.Missing);\nExcel._Worksheet worksheet = null;\napp.Visible = true;\n\nworksheet.Cells[1, 1] = \"test string\";\n\nworkbook.SaveAs(\"C:\\testfile.xlsx\");\n\nobject misValue = System.Reflection.Missing.Value;\nworkbook.Close(true, misValue, misValue);\napp.Quit();\n\nreleaseObject(worksheet2);\nreleaseObject(workbook);\nreleaseObject(app);\n</code></pre>\n\n<p><strong>releaseObject class:</strong></p>\n\n<pre><code>    private void releaseObject(object obj)\n    {\n        try\n        {\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n            obj = null;\n        }\n        catch (Exception ex)\n        {\n            obj = null;\n            MessageBox.Show(\"Unable to release the Object \" + ex.ToString());\n        }\n        finally\n        {\n            GC.Collect();\n        }\n    } \n</code></pre>\n\n<p><strong>EXCEL.EXE is still at Task Manager:</strong>\n<img src=\"http://i.stack.imgur.com/Js79T.png\" alt=\"enter image description here\"></p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13085101,"title":"Excel:Office failed to open a excel file","body":"<p>I have uploaded a excel file to a server,while downloading it`s throwing error like </p>\n\n<p>\"System.Runtime.InteropServices.COMException (0x80070BBC): Office has detected a problem with this file. To help protect your computer this file cannot be opened.\"</p>\n\n<p>It used to work before.Recently I installed 2010 office,it was 2003 before.But some other excels work fine.I can download few,but others throw above error.</p>\n\n<p>What is the problem here?\nPlease suggest.</p>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":67,"score":-5,"question_id":13084006,"title":"How to create an bitmap of type png in c#?","body":"<p>i have several fonts design in Excel workbook. THe cells are shrinked to a smaller size where one cell corresponds to a one pixel. The Dark green shaded cell are considered as Enable pixel where the pale green shaded are disabled pixel for that particular fonts.In the similar way, all the other fonts are designed.</p>\n\n<p>so,In this excel sheet wherein I have to go through the cells n columns of particular font. Then based on the color of the cells (dark green(1 - enable) n pale green(0 - disable) i have to make an output png file in c# of size 10* 10 pixels. </p>\n\n<p>To do this task:</p>\n\n<ol>\n<li><p>I need how to open an particular excel file in C# and then how to read through cell by cell?</p></li>\n<li><p>secondly, how to create a bitmap in c#?</p></li>\n</ol>\n"},{"tags":["c#","asp.net","excel","datatable"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":4344,"score":1,"question_id":7843822,"title":"Export DataTable to Excel File in asp.net","body":"<p>I have read this article that exports datatable to excel file.\nIt worked great.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/1746701/export-datatable-to-excel-file\">Export DataTable to Excel File</a></p>\n\n<p>and the code is below:</p>\n\n<pre><code>dt = city.GetAllCity();//your datatable \nstring attachment = \"attachment; filename=city.xls\"; \nResponse.ClearContent(); \nResponse.AddHeader(\"content-disposition\", attachment); \nResponse.ContentType = \"application/vnd.ms-excel\"; \nstring tab = \"\"; \nforeach (DataColumn dc in dt.Columns) \n{ \n    Response.Write(tab + dc.ColumnName); \n    tab = \"\\t\"; \n} \nResponse.Write(\"\\n\"); \nint i; \nforeach (DataRow dr in dt.Rows) \n{ \n    tab = \"\"; \n    for (i = 0; i &lt; dt.Columns.Count; i++) \n    { \n        Response.Write(tab + dr[i].ToString()); \n        tab = \"\\t\"; \n    } \n    Response.Write(\"\\n\"); \n} \nResponse.End(); \n</code></pre>\n\n<p>But when I use this codes, the korean characters are all broken.\nCan anyone help me with this problem?</p>\n"},{"tags":["excel","add-in","office-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13084928,"title":"Office Excel 2010 COM Add-In - won't load on debug or after ClickOne","body":"<p>I have done something to my Excel and now I cannot seem to install add-ins correctly.</p>\n\n<p>The add-in ClickOnce installs. It appears in Programs list. It appears in registry (and is set to load automatically).</p>\n\n<p>However it does not appear in my Excel. It doesn't appear in the list under COM Add-Ins (nor disbaled items or anywhere on that page).</p>\n\n<p>I don't believe it is my application as I have managed to run it on another PC and it loads locally fine.</p>\n\n<p>I have tried - uninstalling from Programs, removing cahce using CMD command, repaired Microsoft Office and restarted and nothing seems to make it appears.</p>\n\n<p>When I run in debug mode it doesn't hit the ThisAddIn_Startup method but still loads Excel fine.</p>\n\n<p>Does anyone else have any other suggestion? I know this isn't really a development question but I thought a dev might have encountered the same problem.</p>\n"},{"tags":["c#","excel","interop","com-interop"],"answer_count":5,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1907,"score":7,"question_id":2767364,"title":"Using Wrapper objects to Properly clean up excel interop objects","body":"<p>All of these questions:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/247833/excel-2007-hangs-when-closing-via-net\">Excel 2007 Hangs When Closing via .NET</a></li>\n<li><a href=\"http://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c#159419\">How to properly clean up Excel interop objects in C#</a></li>\n<li><a href=\"http://stackoverflow.com/questions/1372292/how-to-properly-clean-up-interop-objects-in-c\">How to properly clean up interop objects in C#</a></li>\n</ul>\n\n<p>struggle with the problem that C# does not release the Excel COM objects properly after using them. There are mainly two directions of working around this issue:</p>\n\n<ol>\n<li>Kill the Excel process when Excel is not used anymore.</li>\n<li>Take care to explicitly assign each COM object used to a variable first and to guarantee that eventually, Marshal.ReleaseComObject is executed on each.</li>\n</ol>\n\n<p>Some have stated that 2 is too tedious and there is always some uncertainty whether you forget to stick to this rule at some places in the code. Still 1 seems dirty and error-prone to me, also I guess that in a restricted environment trying to kill a process could raise a security error.</p>\n\n<p><strong>So I've been thinking about</strong> solving 2 by creating another proxy object model which mimics the Excel object model (for me, it would suffice to implement the objects I actually need). The principle would look as follows:</p>\n\n<ul>\n<li>Each Excel Interop class has its proxy which wraps an object of that class.</li>\n<li>The proxy releases the COM object in its finalizer.</li>\n<li>The proxy mimics the interface of the Interop class.</li>\n<li>Any methods that originally returned a COM object are changed to return a proxy instead. The other methods simply delegate the implementation to the inner COM object.</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>public class Application\n{\n    private Microsoft.Office.Interop.Excel.Application innerApplication\n        = new Microsoft.Office.Interop.Excel.Application innerApplication();\n\n    ~Application()\n    {\n        Marshal.ReleaseCOMObject(innerApplication);\n        innerApplication = null;\n    }\n\n    public Workbooks Workbooks\n    {\n        get { return new Workbooks(innerApplication.Workbooks); }\n    }\n}\n\npublic class Workbooks\n{\n    private Microsoft.Office.Interop.Excel.Workbooks innerWorkbooks;\n\n    Workbooks(Microsoft.Office.Interop.Excel.Workbooks innerWorkbooks)\n    {\n        this.innerWorkbooks = innerWorkbooks;\n    }\n\n    ~Workbooks()\n    {\n        Marshal.ReleaseCOMObject(innerWorkbooks);\n        innerWorkbooks = null;\n    }\n}\n</code></pre>\n\n<p><strong>My questions to you are in particular:</strong></p>\n\n<ul>\n<li>Who finds this a bad idea and why?</li>\n<li>Who finds this a gread idea? If so, why hasn't anybody implemented/published such a model yet? Is it only due to the effort, or am I missing a killing problem with that idea?</li>\n<li>Is it impossible/bad/error-prone to do the ReleaseCOMObject in the finalizer? (I've only seen proposals to put it in a Dispose() rather than in a finalizer - why?)</li>\n<li>If the approach makes sense, any suggestions to improve it?</li>\n</ul>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13084426,"title":"How to group rows in Excel","body":"<p>Hopefully easy queastion - but I can't find the answer.<br>\nThe situation is as below:</p>\n\n<p>A B C 3<br>\nA B C 4<br>\nA B D 1<br>\nA B E 2</p>\n\n<p>How do I get to (in an automated manner)</p>\n\n<p>A B C 7<br>\nA B D 1<br>\nA B E 2</p>\n"},{"tags":["mysql","excel","delete","cell","rows"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13083883,"title":"I have a list of rows in Excel that I need to delete from MySQL database. How to?","body":"<p>I have an excel file with about 1500 rows of business' and I need to delete those business' from my MySQL database. How can I do this? I'm using the business ID as the cell which identifies the rows.</p>\n\n<p>So in file A I have 1,500 rows of business IDs\nIn file B I have +50,000 rows of business'</p>\n\n<p>And I need to delete business' that are in file A from file B.</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","excel","script"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13082989,"title":"multiple tables in excel worksheet and sql file needed as output","body":"<p>I have a single excel worksheet which contains lots of table definitions around 50. Table definitions are like:</p>\n\n<pre><code>Table School\nName Varchar2 20\nMarks Number 5\n</code></pre>\n\n<p>These values are in different columns in excel and there lot of similar tables. \nNow I need to generate a sql script using the excel file. The output script should consists of create table statemnts for all the tables. I just need sql script for all the tables.\nLet me know how can I do it.</p>\n"},{"tags":["excel","ms-access","vba","pivot-table"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":854,"score":1,"question_id":2770821,"title":"Pivotcache problem using ado recordset into excel","body":"<p>I'm having a problem with runtime error 1004 at the last line.  I'm bringing in an access query into excel 2007.  I know the recordset is ok as I can see the fields and data.  Im not sure about the picotcache was created in the set ptCache line.  I see the application, but the index is 0.  Code is below...</p>\n\n<pre><code>Private Sub cmdPivotTables_Click()\n\n    Dim rs As ADODB.Recordset\n    Dim i As Integer\n    Dim appExcel As Excel.Application\n    Dim wkbTo As Excel.Workbook\n    Dim wksTo As Excel.Worksheet\n    Dim str As String\n    Dim strSQL As String\n    Dim rng As Excel.Range\n    Dim rs As DAO.Recordset\n    Dim db As DAO.Database\n    Dim ptCache As Excel.PivotCache\n\n    Set db = CurrentDb()\n\n    'to handle case where excel is not open\n    On Error GoTo errhandler:\n    Set appExcel = GetObject(, \"Excel.Application\")\n    'returns to default excel error handling\n    On Error GoTo 0\n    appExcel.Visible = True\n    str = FilePathReports &amp; \"Reports SCU\\SCCUExcelReports.xlsx\"\n    'tests if the workbook is open (using workbookopen functiion)\n    If WorkbookIsOpen(\"SCCUExcelReports.xlsx\", appExcel) Then\n        Set wkbTo = appExcel.Workbooks(\"SCCUExcelReports.xlsx\")\n        wkbTo.Save\n        'To ensure correct Ratios&amp;Charts is used\n        wkbTo.Close\n    End If\n    Set wkbTo = GetObject(str)\n    wkbTo.Application.Visible = True\n    wkbTo.Parent.Windows(\"SCCUExcelReports.xlsx\").Visible = True\n\n    Set rs = New ADODB.Recordset\n    strSQL = \"SELECT viewBalanceSheetType.AccountTypeCode AS Type, viewBalanceSheetType.AccountGroupName AS AccountGroup, \" _\n                &amp; \"viewBalanceSheetType.AccountSubGroupName As SubGroup, qryAmountIncludingAdjustment.BranchCode AS Branch, \" _\n                &amp; \"viewBalanceSheetType.AccountNumber, viewBalanceSheetType.AccountName, \" _\n                &amp; \"qryAmountIncludingAdjustment.Amount, qryAmountIncludingAdjustment.MonthEndDate \" _\n            &amp; \"FROM viewBalanceSheetType INNER JOIN qryAmountIncludingAdjustment ON \" _\n                &amp; \"viewBalanceSheetType.AccountID = qryAmountIncludingAdjustment.AccountID \" _\n            &amp; \"WHERE (qryAmountIncludingAdjustment.MonthEndDate = GetCurrent()) \" _\n            &amp; \"ORDER BY viewBalanceSheetType.AccountTypeSortOrder, viewBalanceSheetType.AccountGroupSortOrder, \" _\n                &amp; \"viewBalanceSheetType.AccountNumber;\"\n    rs.Open strSQL, CurrentProject.Connection, adOpenDynamic, adLockOptimistic\n\n'    Set rs = db.OpenRecordset(\"qryExcelReportsTrialBalancePT\", dbOpenForwardOnly)\n\n**'**********problem here\n    Set ptCache = wkbTo.PivotCaches.Create(SourceType:=XlPivotTableSourceType.xlExternal)\n    Set wkbTo.PivotCaches(\"ptCache\").Recordset = rs**\n</code></pre>\n"},{"tags":["php","excel","phpexcel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13071752,"title":"How to set auto-line break PhpExcel?","body":"<p>I'm using PHPExcel to generate some excel export. Excel has an autoline break feature. How can i activate this ?</p>\n\n<p>My customer use only Microsoft Excel, so it don't have to support others programs.</p>\n\n<p>Any ideas ?</p>\n\n<p>I may use something like this : <a href=\"http://stackoverflow.com/questions/5960242/how-to-make-new-lines-in-a-cell-using-phpexcel\">how to make New lines in a cell using phpexcel</a> But that's more a kind of hack, than a real solution.</p>\n\n<p><strong>UPDATE :</strong>\nSee, once columns are merged, wrap text fail. I tryied to add wrap text upon every column merged, but it don't affect result.</p>\n\n<p><img src=\"http://i.stack.imgur.com/qoy2T.png\" alt=\"enter image description here\"></p>\n\n<p><strong>UPDATE 2 :</strong></p>\n\n<p>The cells are merged, then i add wrap text, then i add text.</p>\n"},{"tags":["c#","excel","dataset","ranges"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5659,"score":2,"question_id":2458481,"title":"Convert Excel Range to ADO.NET DataSet or DataTable, etc","body":"<p>I have an Excel spreadsheet that will sit out on a network share drive.  It needs to be accessed by my Winforms C# 3.0 application (many users could be using the app and hitting this spreadsheet at the same time).  There is a lot of data on one worksheet.  This data is broken out into areas that I have named as ranges.  I need to be able to access these ranges individually, return each range as a dataset, and then bind it to a grid.</p>\n\n<p>I have found examples that use OLE and have got these to work.  However, I have seen some warnings about using this method, plus at work we have been using Microsoft.Office.Interop.Excel as the standard thus far.  I don't really want to stray from this unless I have to.  Our users will be using Office 2003 on up as far as I know.</p>\n\n<p>I can get the range I need with the following code:</p>\n\n<pre><code>MyDataRange = (Microsoft.Office.Interop.Excel.Range)\n    MyWorkSheet.get_Range(\"MyExcelRange\", Type.Missing);\n</code></pre>\n\n<p>The OLE way was nice as it would take my first row and turn those into columns.  My ranges (12 total) are for the most part different from each other in number of columns.  Didn't know if this info would affect any recommendations.</p>\n\n<p>Is there any way to use Interop and get the returned range back into a dataset?</p>\n"},{"tags":["c#","excel","border","cell"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13082880,"title":"make border in Excel Cell using C#","body":"<p>I have a little question, using C# I want text be in cell and not out of the cell. Because sometimes the text is too long and it goes automatically to another cells. How can I make border there? Should I use <code>Excel.Range.Borders</code>? </p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13067673,"title":"Breaking Up Data Set into Individual Worksheets by Identifier","body":"<p>I have a large data set with an identifier attributed to each row. There around 10 different identifiers for the whole dataset but this can be variable. The aim is to break the main dataset up into individual worksheets for each group of identifiers. I have written this code below which does the job but seems very clunky with a loop to make all the worksheets and another to go through each row.</p>\n\n<pre><code>    ...\n\n    '--&gt; Get list of Area Codes\n    ws1.Range(\"N:N\").Copy\n    Set TempWS = Sheets.Add\n    With TempWS\n        With .Range(\"A:A\")\n            .PasteSpecial\n            .AdvancedFilter xlFilterInPlace, Unique:=True\n            .SpecialCells(xlCellTypeVisible).Copy\n        End With\n        .Range(\"B:B\").PasteSpecial\n        .ShowAllData\n        .Range(\"A:A\").Delete\n        .Rows(1).Delete\n        tmpLR = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n    End With\n\n    '--&gt; Create Worksheet for Each Code\n    i = 1\n    Do Until i = tmpLR\n    Set ws = Sheets.Add\n    ws.Name = TempWS.Cells(i, 1).Text\n    ws1.Range(\"A1\").EntireRow.Copy\n    ws.Rows(\"1:1\").PasteSpecial\n    i = i + 1\n    Loop\n\n    TempWS.Delete\n\n    '--&gt; Break Up Main Data Sheet into Area Code Sheets\n    Set rng = ws1.Range(\"N2:N\" &amp; LRws1)\n    For Each c In rng\n        shname = c.Text\n        c.EntireRow.Copy\n        Set oWS = Sheets(shname)\n        oLR = oWS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n        oWS.Rows(oLR).PasteSpecial\n    Next\n\n    ...\n</code></pre>\n\n<p>Is there a more efficient way of completing this process instead of looping multiple times?</p>\n\n<p>I also noticed that with this line <code>c.entirerow.copy</code> it is not possible to use a <code>cut</code> instead of <code>copy</code>, what's the reason for this?</p>\n\n<p>Format is like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/7Rt1f.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","excel-vba","excel-2003"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13081823,"title":"Excel: Call a VBA library function from a cell formula?","body":"<p>Is it possible to call a VBA library function, eg. <code>StrReverse</code> (in <code>VBA.Strings</code>) directly from a cell formula without writing a wrapper function?</p>\n"},{"tags":["php","excel","pear","export-to-excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1538,"score":1,"question_id":4512888,"title":"How to adjust width of cells so they do not cut words in Spreadsheet_Excel_Writer","body":"<p>I am trying to create an Excel sheet using the Spreadsheet_Excel_Writer that comes with Pear.<br>\nThe sheet is created, and all is OK, Except, My words are being cut and the cells does not adjust their width to accommodate complete words.<br>\nI try to open it with Office 2007.<br>\nWhat values do I have to put into the Spreadsheet_Excel_Writer_Format object for that?</p>\n"},{"tags":["excel","excel-vba","range"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13082393,"title":"Range address for a specific sheet (and not the active sheet)","body":"<p>I want to write a simple function that tells me the column length, giving the first record of the column. Hence, I write something like...</p>\n\n<pre><code>Public Function getColumnLen(firstCell As Range) As Long\n\nDim lastRow As Long\nlastRow = Range(firstCell.Address).End(xlDown).Row\n\ngetColumnLen = lastRow - firstCell.Row + 1\nEnd Function\n</code></pre>\n\n<p>Now I have two worksheets in my project, \"A\" and \"B\" and in VBA I call </p>\n\n<pre><code>Dim colLen as Long\ncolLen = getColumnLen(Worksheets(\"A\").Range(\"A1\"))\n</code></pre>\n\n<p>when I want to know the height of data starting on A1. The resulting value of <code>colLen</code> depends on whether sheet \"A\" is active or \"B\" is active. The thing is that in the <code>getColumnLen</code> function, <code>firstCell</code> remembers that it is a part of \"A\" sheet, however scrolling is done on the active sheet. Is there any way to make this give correct results regardless of the active sheet, other than activating <code>firstCell</code> in each call? </p>\n"},{"tags":["vb.net","excel","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13052091,"title":"Convert xls File to csv, but extra rows added?","body":"<p>So, I am trying to convert some xls files to a csv, and everything works great, except for one part.  The SaveAs function in the Excel interop seems to export all of the rows (including blank ones).  I can see these rows when I look at the file using Notepad.  (All of the rows I expect, 15 rows with two single quotes, then the rest are just blank).  I then have a stored procedure that takes this csv and imports to the desired table (this works on spreadsheets that have been manually converted to csv (e.g. open, File--> Saves As, etc.)</p>\n\n<p>Here is the line of code I am using for my SavesAs in my code.  I have tried xlCSV, xlCSVWindows, and xlCSVDOS as my file format, but they all do the same thing.</p>\n\n<pre><code>wb.SaveAs(aFiles(i).Replace(\".xls\", \"B.csv\"), Excel.XlFileFormat.xlCSVMSDOS, , , , False) 'saves a copy of the spreadsheet as a csv\n</code></pre>\n\n<p>So, is there some additional step/setting I need to do to not get the extraneuos rows to show up in the csv?</p>\n\n<p>Note that if I open this newly created csv, and then click Save As, and choose csv, my procedure likes it again.</p>\n"},{"tags":["php","excel","phpexcel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12877704,"title":"Is there a PHP library for XLSM(Excel with Macro) parsing/editing?","body":"<ul>\n<li>I know that PHPExcel does not support XLSM files.</li>\n<li>I have tried Iliaal's wrapper around Libxl, <a href=\"https://github.com/iliaal/php_excel\" rel=\"nofollow\">can be found here</a></li>\n</ul>\n\n<p>However both of them do not support <strong>XLSM</strong>, they do cool with <strong>XLS</strong> though. I have searched all over the internet and didn't find a library, or a method with <strong>PHP</strong> to do so.</p>\n\n<p>By the way, my environment is <strong>*NIX</strong>.</p>\n\n<p><strong>EDIT</strong>\nI do not need to edit macros itself. I don't want to touch them, but I want a library/wrapper/command line executable(as last resort) to work with XLSM files(XML Sheets with Macros). </p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","vba","checkbox","worksheet-function"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":412,"score":0,"question_id":3238803,"title":"VBA Excel: Too many checkboxes on worksheet, code doesn't work","body":"<p>I'm currently working on an MS Excel worksheet which contains 1277 checkboxes, spread over 96 rows. In this sheet, there is a column in which the total of the checked checkboxes is placed.\nThe idea is that when a checkbox is ticked, the total sum in this control column is added by one.</p>\n\n<p>The code for this works fine, because I used the same code on different files with fewer checkboxes. \nHowever, when I tick a checkbox in this file with 1277 boxes, nothing happens with the control column. </p>\n\n<p>Is there a limit to the total amount of objects that is allowed in a single file? Or worksheet?</p>\n\n<p>And does anyone know a bypass for this one? I could split up the file in several separate ones, but I'd much rather keep everything in the same document. </p>\n\n<p>Many thanks in advance!!!</p>\n\n<p>Kind regards, </p>\n\n<p>Marc</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13079727,"title":"Excel, VBA: How to pass multiple variables to .OnAction","body":"<p>I am trying to pass multiple variables to a .OnAction call for a button.  I have not been able to find answers that relate to multiple variables, and I can do it with just one variable.  Here is what I have that works for one variable:</p>\n\n<pre><code>shpBar.OnAction = \"'Button_Click \"\"\" &amp; strText &amp; \"\"\"'\"\n</code></pre>\n\n<p>How can I add two other variables to this (such as VarA and VarB)?</p>\n"},{"tags":["java","excel","exception"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8508,"score":0,"question_id":1747665,"title":"Biff exception in Java","body":"<p>When I tried to read an Excel file in Java it throws \"biff exception\".</p>\n\n<p>What does this mean? I tried to Google it but wasn't able to find a proper explanation.</p>\n\n<pre><code>jxl.read.biff.BiffException: Unable to recognize OLE stream\n\n                             at jxl.read.biff.CompoundFile.&lt;init&gt;(CompoundFile.java:116)\n\n                             at jxl.read.biff.File.&lt;init&gt;(File.java:127)\n\n                             at jxl.Workbook.getWorkbook(Workbook.java:221)\n\n                             at jxl.Workbook.getWorkbook(Workbook.java:198)\n\n                             at Com.Parsing.ExcelFile.excel(Extract.java:20)\n\n                             at Com.Parsing.Extract.main(Extract.java:55)\n</code></pre>\n"},{"tags":["excel","table","latex"],"answer_count":1,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":1631,"score":11,"question_id":2714993,"title":"How to draw diagonal table borders in latex, like in excel?","body":"<p>Is it possible to draw diagonal (parallelogram) cells in LaTeX: the cell content is diagonal, and the cell's originally vertical borders are also diagonal.</p>\n\n<p>Here is what I managed to do using the rotating package:</p>\n\n<pre><code>\\begin{tabular}{|r|c|c|}\n\\hline\n\\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\ \\\\\n &amp; \\begin{rotate}{45}Trying to save some horizontal space\\end{rotate} &amp; \\begin{rotate}{45}While keeping headers readable\\end{rotate} \\\\\n\\hline\nthis &amp; is &amp; a \\\\\n\\hline\nsample &amp; latex &amp; table \\\\\n\\hline\n\\end{tabular}\n</code></pre>\n\n<p>Here is a screenshot of the output vs what is possible using excel:</p>\n\n<p><img src=\"http://img106.imageshack.us/img106/3872/fa98352d18.png\" alt=\"LaTeX vs. Excel screenshots\"></p>\n\n<p>Thanks.</p>\n"},{"tags":["excel","pdf","printing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13076364,"title":"Printing Excel to PDF has cells on new pages, while they look fine in Preview","body":"<p>I'm using ExportAsFixedFormat to create a PDF of a multi-page workbook. In Print Preview these look fine and everything \"prints\" fine.</p>\n\n<p>However, when I export to PDF, the right-most column is cut off, and appears on a second page.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["excel","vba","macros","multiple","column"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":13073033,"title":"Convert Multiple Columns to One Large Column (Excel 2010)","body":"<p>I would like to convert 15,096 columns of text (one word per cell) to one large column including every cell from the original columns.  My original columns vary in size (i.e. one column may have 4 cells/rows, while another may have 100 cells/rows).</p>\n\n<p>I have no experience with VBA, but have recorded a macro to do this somewhat manually and it is taking forever.  Please help with something that I could set and go get coffee and come back to see the job done.  (NOTE: Some columns have 1 word/row...this has made my macro throw an error every time it encounters one of these).</p>\n\n<p>Thank you! Hope someone can help.\n-Mike</p>\n"},{"tags":["excel","file","vba","csv"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13077317,"title":"Excel VBA: Is there a way to write ranges in bulk to a text/CSV file?","body":"<p>I'm used to write the content (values) of a range of cells to a text file with the write command in VBA, for example:</p>\n\n<p><code>write #myfile, Range(\"A1\").value, Range(\"A2).value, Range(\"A3).value</code></p>\n\n<p>Does there exist a more elegant and convenient built-in method to dump a whole range directly to a delimited file, possibly even over multiple rows at a time? Or has anybody come up with a customized solution? I think that would be incredibly useful.</p>\n\n<p><strong>EDIT:</strong> Find my own solution below.</p>\n"},{"tags":["c#","excel","file-io","export-to-excel"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1352,"score":5,"question_id":4286511,"title":"generating/opening CSV from console - file is in wrong format error","body":"<p>I am writing out a comma separated file using a console app, and than using Process to open the file. It's a quick and dirty way of dumping results of a query into excel. </p>\n\n<p>for a while this worked fine, but lately i started getting \"<strong>The file you are trying to open 'blah.csv', is in a different format than specified by the file extension</strong>\". </p>\n\n<p>and than after clicking \"Yes\"</p>\n\n<p><strong>Excel has detected that blah.csv is a SYLK file, but cannot load it. Either the file has errors or it is not a SYLK file format. Click OK to try to open the file in a different format.</strong> </p>\n\n<p>Pressing OK opens it, and displays correctly.</p>\n\n<p>I see some solutions for this in web world with adding content-disposition header, but since i am using a Process to open it, i can't apply that fix. </p>\n\n<p>my code to open the file:</p>\n\n<pre><code>ProcessStartInfo info = new ProcessStartInfo();\ninfo.FileName = filePath;\ninfo.UseShellExecute = true;\nProcess.Start(info);\n</code></pre>\n\n<p>if i open the file in Notepad++ and show all chars, it just shows as regular CSV with CR LF line endings. </p>\n\n<p>after some investigation, it looks like the headings line is triggering the error. If i simply write a empty line before the headings, the error goes away. the headings look like this:</p>\n\n<p>heading1,heading2,heading3 CRLF</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13078256,"title":"How to open Text File with .OpenText in VBA that starts with first column like \"ID\" without getting SYLK error","body":"<p>I've come across a nasty little bug in Excel VBA's <code>.OpenText</code> method..  It errors on opening any text or CSV file when the first two letters are upper-case \"ID\".  Here is the article from MS so you know I'm not crazy: <a href=\"http://support.microsoft.com/kb/323626\" rel=\"nofollow\">http://support.microsoft.com/kb/323626</a></p>\n\n<p>So, I'm trying to figure out a workaround that does NOT involve copying the entire file just to re-name the first header.  I am working with some large text files and this would be an unsatisfactory last resort.</p>\n\n<p>I've tried <code>On Error Resume Next</code> before the <code>.OpenText</code> call but that didn't work..  Has anybody come across this and found a simple solution I'm missing?  Is there a way to just crack open the first line and find/replace inside of a text file?  Or extra parameters to <code>.OpenText</code> I could use?</p>\n"},{"tags":["excel","vba","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13078043,"title":"Sort horizontally - each row independently of the other rows","body":"<p>I would like to sort my data (strings) horizontally but I want to sort each row independently of the other rows. </p>\n\n<p>Is the only way of doing that is to select manually select each row and sort it?</p>\n\n<p>I am not an VBA expert at all, I could do that in c# or java but I hope that this function exist in excel ...</p>\n\n<p>Thank you!</p>\n"},{"tags":["php","excel","xls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13077331,"title":"Printing an Excel File in PHP","body":"<p>So I've got multiple instances of an application running, one for 2008, 2009, 2010.. 2012. All of these have a feature where you can download a .XLS report of a bunch of data. For some reason, the XLS file is being mangled when downloaded through the application. You can move the pdf to the webroot, download it, and it will open just fine, but when you attempt to download it through, say, <code>download.php?file=29320f9je</code>, Excel says it doesn't recognize the file's format, and spews garbage (what SHOULD be our data, just in unicode trash)</p>\n\n<p>Anyone run into this before and have other suggestions to check, other than the application and headers? Because the code between 2010 and 2012 SHOULD be fine.</p>\n\n<h2>Use Example:</h2>\n\n<p>User generates report. Can be viewed properly via above method. Actual method is as follows:</p>\n\n<p>User clicks link to \"download file\" (<code>report.retrieve.download.htm?file=2390jsf</code>)</p>\n\n<p>report.retrieve.download.htm</p>\n\n<pre><code>$file = $_GET['file'];\n\n$tempfile = new tempfile(''); // open tempfile class, argument is name of report\n\nif ($tempfile-&gt;set_filename($file) === false)\n        $tempfile-&gt;error_report('4026','',\"Filename: $file\",'Y');\n\nif ($tempfile-&gt;send_file() === false)\n        $tempfile-&gt;error_report('4027','',\"Filename: $file\",'Y');\n</code></pre>\n\n<p>Associated function</p>\n\n<pre><code>public function send_file() {\n            $file = $this-&gt;get_full_filename();\n            if (file_exists($file)===FALSE)\n                    return FALSE;\n            if ($this-&gt;send_headers($file)===FALSE)\n                    return FALSE;\n            $this-&gt;output_file($file);\n            return TRUE;\n    }\n</code></pre>\n\n<p>And that all important headers function..</p>\n\n<pre><code>public function send_headers($filename) {\n            if (headers_sent()===TRUE)\n                    return FALSE;\n            if (isset($_SERVER['HTTP_USER_AGENT']) &amp;&amp; preg_match(\"/MSIE/\", $_SERVER['HTTP_USER_AGENT'])) {\n                    // IE Bug in download name workaround\n                    ini_set( 'zlib.output_compression','Off' );\n            }\n            /*\n            $fInfo = new finfo(FILEINFO_MIME);\n            $type = $fInfo-&gt;file($filename);\n            $stats = stat($filename);\n            $size = $stats['size'];\n            */\n            $output_filename = $this-&gt;get_output_filename();\n\n            if (eregi('csv$', $this-&gt;get_output_filename())) {\n                    header(\"Content-type: text/csv\");\n                    //header(\"Content-Size: $size\");\n                    header(\"Pragma: public\");\n                    header(\"Content-Disposition: attachment; filename=$output_filename\");\n            }\n            elseif (eregi('htm$', $this-&gt;get_output_filename()))\n                    header(\"Content-type: text/html\");\n            else {\n                    header(\"Content-type: application/vnd.ms-excel\");\n                    //header(\"Content-Size: $size\");\n                    header(\"Pragma: public\");\n                    header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n                    header(\"Content-Disposition: attachment; filename=$output_filename\");\n            }\n            return TRUE;\n    }\n</code></pre>\n"},{"tags":["php","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":12968173,"title":"php generate image from excel cell range","body":"<p>I have an excel sheet. Its Cells can contain data and graph. I need to generate an image from the cells between a fixed range(for example: A1 to K19). </p>\n\n<p>I found one solution to this problem with ASP.NET: <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel%28v=office.11%29.aspx\" rel=\"nofollow\">Microsoft.Office.Interop.Excel</a>. It provides method <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.range.copypicture.aspx\" rel=\"nofollow\">Range.CopyPicture()</a> and <a href=\"http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._worksheet.paste.aspx\" rel=\"nofollow\">Chart.Paste()</a>. I need to implement this using PHP. Any solution, suggestion or direction will be appreciated.</p>\n\n<p>For range A1 to B2, image can be like :  <img src=\"http://i.stack.imgur.com/iysCd.jpg\" alt=\"A1:B2\"></p>\n"},{"tags":["excel","vbscript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13076566,"title":"Excel VBScript insert column and fill","body":"<p>I'm trying to insert a column to an Excel spreadsheet via a script. I found the code below which should allow me to insert a column, but how would I then go about filling that column with data like I would in the Excel application using the fill>down or fill>series commands?</p>\n\n<pre><code>Const xlToRight = -4161\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\nSet objWB = objExcel.Workbooks.Open(\"C:\\Temp\\Scripts\\Test2.xls\")\nSet objSheet = objwb.Sheets(\"Overall\")\nobjSheet.Columns(\"D:D\").Insert xlToRight\nobjWB.Close True\nobjExcel.Quit\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here's what ended up working.</p>\n\n<pre><code>Const xlToRight = -4161\nconst xlColumns = &amp;H2 \nconst xlLinear = -4132 \nconst xlDay = 1\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\nSet objWB = objExcel.Workbooks.Open(\"C:\\Temp\\Scripts\\Test2.xls\")\nSet objSheet = objwb.Sheets(\"Overall\")\nobjSheet.Columns(\"A:A\").Insert xlToRight\nobjSheet.Cells(1, 1).Value = \"label\"\nobjSheet.Cells(2, 1).Value = \"Value\"\nset Range = objSheet.Range(\"A2:A\"&amp;objSheet.UsedRange.Rows.Count) \nRange.FillDown\nobjSheet.Columns(\"A:A\").Insert xlToRight\nobjSheet.Cells(1, 1).Value = \"series\"\nobjSheet.Cells(2, 1).Value = 1\nset Range = objSheet.Range(\"A2:A\"&amp;objSheet.UsedRange.Rows.Count) \nRange.DataSeries xlColumns, xlLinear,xlDay, 1, , False\nobjWB.Close True\nobjExcel.Quit\n</code></pre>\n"},{"tags":["python","excel","loops"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1043,"score":2,"question_id":1643643,"title":"How to test for multiple command line arguments (sys.argv","body":"<p>I want to test againts multiple command line arguments in a loop</p>\n\n<pre><code>&gt; python Read_xls_files.py group1 group2 group3\n</code></pre>\n\n<p>No this code tests only for the first one (group1). </p>\n\n<pre><code>hlo = []\nfor i in range(len(sh.col_values(8))):\n   if sh.cell(i, 1).value == sys.argv[1]:\n      hlo.append(sh.cell(i, 8).value)\n</code></pre>\n\n<p>How should I modify this that I can test against one, two or all of these arguments? So, if there is group1 in one sh.cell(i, 1), the list is appended and if there is group1, group2 etc., the hlo is appended.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13076922,"title":"VBA dynamic validation of text box based on selection in drop down menu","body":"<p>all. I have a table in the worksheet called <strong>lookupMisc</strong> called <em>periodNo (A)</em> and <em>periodName (B)</em> with the following values.</p>\n\n<pre><code>A   B\n1   09:00\n2   10:00\n3   11:00\n4   12:00\n5   13:00\n6   14:00\n7   15:00\n8   16:00\n9   17:00\n</code></pre>\n\n<p>The code for this as follows:</p>\n\n<pre><code>   For i = 1 To ws_misc.Range(\"periodNo\").Rows.Count\n        CombinedName = periodNo(i, 1) &amp; \" - \" &amp; periodName(i, 1)\n        cbo_period.AddItem CombinedName\n    Next i\n</code></pre>\n\n<p>and thsi generates:</p>\n\n<p><img src=\"http://i.stack.imgur.com/xRYcb.png\" alt=\"enter image description here\"></p>\n\n<p>Now you will notice that there is a <strong>Length</strong> (<strong>txt_length</strong>) text field to the right. Basically I am trying to create a form of dynamic validation based on the entry that period has. Here are the cases:</p>\n\n<pre><code>If user selects  Then\n1 - 09:00        Length can only accept values from 1-9\n2 - 10:00        Length can only accept values from 1-8\n3 - 11:00        Length can only accept values from 1-7\n4 - 12:00        Length can only accept values from 1-6\n5 - 13:00        Length can only accept values from 1-5\n6 - 14:00        Length can only accept values from 1-4\n7 - 15:00        Length can only accept values from 1-3\n8 - 16:00        Length can only accept values from 1-2\n9 - 17:00        Length can only accept values from 1-1\n</code></pre>\n\n<p>How would I go about accomplishing this?</p>\n"},{"tags":["asp.net","forms","excel","sharepoint","web"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13076197,"title":"Open Selection in Microsoft Excel and Publish back to the server from ASP.NET Web Form Application. No SharePoint on the server","body":"<p>On ASP.NET Web Forms, is it possible to open selected rows in Excel, modify data and publish changes back to the server (similar to Visual Studio TFS)?   What technologies are available for this?  Unfortunately I cannot use SharePoint for this.</p>\n"},{"tags":["excel","vba","excel-vba","excel-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":47,"score":0,"question_id":13076152,"title":"Using data from cell in VBA code to open directory","body":"<p>Rewording my question:</p>\n\n<pre><code>Sub Path()\nDim path As Range\nDim shPivot As Worksheet\nSet shPivot = ActiveWorkbook.Sheets(\"Pivot\")\nSet path = shPivot.Range(\"E12\").Value\nSet wkbFrom = Workbooks.Open(\"S:\\_Supply Chain\\Weekly Rpts Supplier and Buyer\\\" &amp; path &amp; \"\\SUPPLIER_01_00028257_KIK CUSTOM PRODUCTS GAINSVILLE_21-OCT-12.xls\")\n</code></pre>\n\n<p>Path is a date in a cell. When this cell changes, I want the directory to change according to path. </p>\n"},{"tags":["excel","vba","pdf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13075781,"title":"Exporting a multi-sheet Excel workbook as PDF in VBA","body":"<p>I'm using Excel 2007 to build a complex multi-tab (sheet) workbook. I'd like to save this out as PDF from within VBA. I'm trying to use ExportAsFixedFormat.</p>\n\n<p>Sure enough, this call correctly exports a PDF, with the right name in the right place. However, it consists only of the currently visible tab.</p>\n\n<p>I found a thread about this in Excel 2010 (which I assume is similar/same) which placed all of the sheets in an array and then selected them...</p>\n\n<p>Sheet(Array(\"One\", \"Two\")).Select</p>\n\n<p>However, this returns an error on my machine, that the Select failed.</p>\n\n<p>I'm sure this is something fairly simple, any pointers?</p>\n"},{"tags":["excel","excel-formula"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13075669,"title":"2D Lookup without unique column values","body":"<p>I have a 2 Sheets x and y as follows:</p>\n\n<pre><code>x\n____________________________________________\nState    | 1         | 2         | 3\nME       |           |           |         \nVA       |           |           |\n\n\n\ny\n__________________________________\nState    | Type     |   Date  \nVA       |  1       | 2/12/2012\nVA       |  3       | 1/15/2012\nME       |  2       | 8/1/2011\nVA       |  2       | 2/2/2012\nME       |  1       | 1/4/2011\n</code></pre>\n\n<p>I need a formula that can find and match the values in columns A and B of sheet y against B1 and A2 of sheet x and put the value of the corresponding date from sheet y into the correct column on sheet x</p>\n\n<p>The issue is that most excel 2d arrays require unique values in the first lookup column (in this case 'y'!$A:$A) . </p>\n\n<p>Is this possible?</p>\n\n<p>I have tried:</p>\n\n<pre><code>=IF(ISNA(INDEX('y'!$C:$C,MATCH(1,($A2='y'!$A:$A)*(B$2='y'!$B:$B),0))),\"\",INDEX('y'!$C:$C,MATCH(1,($A1='y'!$A:$A)*(B$2='y'!$B:$B),0)))\n</code></pre>\n\n<p>To no avail.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13075473,"title":"Validating checkboxes using VBA","body":"<p>I'm having difficulty validating a group of radio buttons, this is the code I'm using right now but I keep getting the error message: <code>Runtime error 438 - Object doesn't support this property or method</code>.</p>\n\n<p>This is the code that is causing the problem.</p>\n\n<pre><code>For Each ctl In Me.frPriority.Controls\n        If ctl.Value = True Then GoTo nxtCheck1\n    Next\n        MsgBox \"You didn't select a priority\"\n    Exit Sub\nnxtCheck1:\n</code></pre>\n\n<p>The line causing all the trouble is</p>\n\n<pre><code>If ctl.Value = True Then\n</code></pre>\n\n<p>How can I resole this problem?</p>\n"},{"tags":["c#","excel","interop","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":13072629,"title":"Excel Interop Worksheet copy raises exception HRESULT: 0x800A03EC","body":"<p>I'm having a problem copying worksheets in Excel 2003 using Interop. The code works for 30-40 copies and then an exception is thrown \"Exception from HRESULT: 0x800A03EC\". The folowing test code already contains a patch as sugested in <a href=\"http://support.microsoft.com/kb/210684/en-us\" rel=\"nofollow\">http://support.microsoft.com/kb/210684/en-us</a>, but no success.\nDoes anyone know any workaround for this ?\nThanks in advance</p>\n\n<pre><code>using Excel = Microsoft.Office.Interop.Excel;\n\nprivate void button2_Click(object sender, EventArgs e)\n    {\n        string template_path = @\"c:\\temp\\template.xlt\";\n        string filename = @\"c:\\temp\\testxl1.xls\";\n        if (File.Exists(filename))\n            File.Delete(filename);\n\n        object missing = System.Reflection.Missing.Value;\n\n        System.Globalization.CultureInfo my_culture = System.Threading.Thread.CurrentThread.CurrentCulture;\n        System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo(\"en-US\");\n\n        Excel.ApplicationClass xlapp = new Excel.ApplicationClass();\n        xlapp.Visible = true;\n        xlapp.UserControl = true;\n\n        Excel.Workbook xlwb = xlapp.Workbooks.Add(template_path);\n\n        xlwb.SaveAs(@filename,\n            missing, missing, missing, missing, missing,\n            Excel.XlSaveAsAccessMode.xlNoChange,\n            missing, missing, missing, missing, missing);\n\n\n        Excel.Worksheet xlws = xlwb.Worksheets[\"diario\"] as Excel.Worksheet;\n\n        int copies = 200;\n\n        for (int i = 0; i &lt; copies; i++)\n        {\n            #region Patch kb/210684\n\n            if (copies % 10 == 0)\n            {                    \n                xlwb.Close(true, missing, missing);\n                System.Runtime.InteropServices.Marshal.ReleaseComObject(xlwb);\n                xlwb = null;\n\n                System.Runtime.InteropServices.Marshal.ReleaseComObject(xlws);\n                xlws = null;\n\n                Application.DoEvents();\n\n                xlwb = xlapp.Workbooks.Open(@filename, 0,\n                    missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);\n                xlws = xlwb.Worksheets[\"diario\"] as Excel.Worksheet;\n\n            }\n\n            #endregion\n\n            xlws.Copy(System.Reflection.Missing.Value, xlwb.Worksheets.Count);\n        }\n\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(xlws);\n        xlws = null;\n\n        xlwb.Close(true, missing, missing);\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(xlwb);\n        xlwb = null;\n\n        xlapp.Quit();\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(xlapp);\n        xlapp = null;\n\n        System.Threading.Thread.CurrentThread.CurrentCulture = my_culture;\n    }\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":13056625,"title":"Data source for copied worksheets","body":"<p>I'm attempting to copy three sheets (two sheets are pivot tables, one is the source data for those pivots) from one workbook to a new workbook. </p>\n\n<p>The code below copies the desired sheets to the new workbook and saves it (modified <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=359\" rel=\"nofollow\">original</a>):</p>\n\n<pre><code>Sub ExportFile()\n    Dim NewName As String\n    Dim nm As Name\n    Dim ws As Worksheet\n\n    With Application\n        .ScreenUpdating = False\n        On Error GoTo ErrCatcher\n\n        ' Array of sheets to copy\n        Sheets(Array(\"sourcedata\", \"pivot\", \"pivot2\")).Copy\n        On Error GoTo 0\n\n        For Each ws In ActiveWorkbook.Worksheets\n            ws.Cells.Copy\n            ' Paste sheets\n            ws.[A1].PasteSpecial\n\n            ' Remove external links, hyperlinks and hard-code formulas\n            ws.Cells.Hyperlinks.Delete\n            Application.CutCopyMode = False\n\n            ' Select A1 on sheet\n            Cells(1, 1).Select\n            ws.Activate\n        Next ws\n        Cells(1, 1).Select\n\n        ' Save it in the same directory as original and close\n        ActiveWorkbook.SaveCopyAs ThisWorkbook.Path &amp; \"\\export.xls\"\n        ActiveWorkbook.Close SaveChanges:=False\n\n        .ScreenUpdating = True\n    End With\n    Exit Sub\n\nErrCatcher:\n    MsgBox \"Specified sheets do not exist within this workbook\"\nEnd Sub\n</code></pre>\n\n<p>However, when I open the new workbook, the data source in the pivot tables still point to the original workbook. My colleague explained that this is because the sheets are being copied one by one, rather in a group and suggested to copy the sheets as a range. How would I go about copying the sheets as a range or would it be easier way to change the data source to the new copied sheets?</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13072918,"title":"Excel VBA - Execute string as code","body":"<p>I am trying to execute the following string as code using Evaluate but get Error 2029. Anyone know why?</p>\n\n<p>Help much appreciated.</p>\n\n<pre><code>Calculation = \"Format(\"\"21/08/2012\"\", \"\"MMM\"\")\"\nValue = Evaluate(Calculation)\n</code></pre>\n"},{"tags":["excel","pivot-table","slice"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13074768,"title":"Attendance Calculations / Period Calendar","body":"<p>This is a multi-tiered project. Let me give a quick overview. I have attendance data, card/ timestamp punches. I would like to have a pivot table with slicers in Excel. Ideally you'd be able to choose a department / last name / associate number. And also a period of time. Ideally this would be a table with the company period/week. And maybe default to last weeks.</p>\n\n<p>I can get at timecard data in two ways:</p>\n\n<p>(1) generate a CSV that automatically performs the timecard math, to figure out how many hours someone worked and it is smart enough to understand 3rd shift workers. The format of that CSV is:</p>\n\n<blockquote>\n  <p>Last Name, First Name, Personnel Type, Associate Number, Facility, Department, TimeIn, TimeOut, Total Hours</p>\n</blockquote>\n\n<p>The problem with this method is that I would have to manually append the information to the CSV tables. Or come up with some autoIT script.</p>\n\n<p>(2) Get at the raw data via sql/odbc. This way the math is not done. It is just all of the associates timestamps. I would have to figure up the daily hours myself and figure out a 3rd shift formula too. It is not a set schedule, many people swing shifts and others get called in a lot. </p>\n\n<p>Lastly, I would like to be able to filter the dates by using our company fiscal calendar. I have a spreadsheet that goes from 2000 to 2093. With everyday listed and it's corresponding year/period/week.</p>\n\n<p>Example period info spreadsheet:</p>\n\n<pre><code>date    Year    Period  week    WeekTotal   Period Total\n12/3/2007   2008    1   1   2008.1.1    2008.1\n12/4/2007   2008    1   1   2008.1.1    2008.1\n</code></pre>\n\n<p>I know there is a lot going on here, but what would be the best way to approach this project?</p>\n"},{"tags":["excel","vba","pdf","macros","save-as"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13073888,"title":"vba macro that saves excel range as pdf","body":"<p>I tried implimenting a range into my code, but I'm having no luck.  I'd like to be able to have a macro in vba to 'save as' a specific sheet or specific range to pdf.\nAny help would be much appreciated.</p>\n\n<p>Here is what I've been working with:</p>\n\n<pre><code>ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"c:\\Book1.pdf\", Quality:= _\n    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True\n</code></pre>\n\n<p>Thanks,</p>\n"},{"tags":["excel","excel-2007","excel-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13041680,"title":"Delete Certain Characters in a excel 2010 cell","body":"<p>I have 4000 records of data in excel 2010 that looks like this </p>\n\n<p>QW3-WE-2232-322-A-2</p>\n\n<p>WETE-33-3REE-33-WEWE-3</p>\n\n<p>DEE-3YED-3432-DXSDDD-3FESE-2</p>\n\n<p>343-34SE-34323-AWBE-3</p>\n\n<p>ABDC-343-3THYT-2</p>\n\n<p>I want the data to look like this where everything after the last dash is deleted.</p>\n\n<p>QW3-WE-2232-322-A</p>\n\n<p>WETE-33-3REE-33-WEWE</p>\n\n<p>DEE-3YED-3432-DXSDDD-3FESE</p>\n\n<p>343-34SE-34323-AWBE</p>\n\n<p>ABDC-343-3THYT</p>\n\n<p>Was wondering if there was an easy way to do this excel</p>\n"},{"tags":["c#","excel","ace","oledbdataadapter"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":75,"score":5,"question_id":13038384,"title":"Excel with ACE Timeout in .NET using Data Adapter Update","body":"<p>I am experiencing a timeout issue writing data from a dataset into an excel spreadsheet. Here is my connection string currently:</p>\n\n<pre><code>&lt;add key=\"ExcelConnectionStringHeader\" value=\"Provider=Microsoft.ACE.OLEDB.12.0;Connect Timeout=30;Extended Properties=&amp;quot;Excel 12.0;HDR=YES&amp;quot;;Data Source=\"/&gt;\n</code></pre>\n\n<p>The Connect Timeout property doesn't seem to be supported by the provider. Neither is Connection Timeout, Timeout, ConnectionTimeout, ConnectTimeout, etc.  My code created a Data Adapter and and InsertCommand, and updates from a dataset. This works great unless the Update command itself takes more than 15 seconds, which is the default OleDb timeout. Thats why I am trying to set it in the Connection string. I have increased the CommandTimeout from the default of 30, but that is really irrelevant. Below is my Code:</p>\n\n<pre><code>        OleDbDataAdapter da = new OleDbDataAdapter(szHeaderSelect, oCnn); // Ratings_Test -- Loan_Test$A1:F1]\",\n        DataSet dsTest = new DataSet();\n\n        da.InsertCommand = new OleDbCommand(szNewSQL + \"(\" + szColumns + \") \" + \"VALUES ( \" + szParams + \")\", oCnn);\n        da.InsertCommand.CommandTimeout = 300;\n\n\n        foreach (DataRow oDr in dtTable.Rows)\n        {\n\n            drNew = dsTest.Tables[0].NewRow();\n\n            dsTest.Tables[0].Rows.Add(drNew);\n        }\n\n        var timer = new System.Diagnostics.Stopwatch();\n        timer.Start();\n        var recs = da.Update(dsTest, szExcelTab); // Ratings_Test           }\n        timer.Stop();\n</code></pre>\n\n<p>I omitted the loops and such that actually build the content and parameters of the insert command. Trust me, it all works fine. 2200+ records work fine.</p>\n\n<p>It was after I added the timer that I discovered the problem was timeout. When processing 2221 records, it takes 14.95 seconds and shows up just fine in the spreadsheet. When processing 2260 records, it takes 15.21 seconds and nothing shows up. There are no errors of any kind. I've checked the row state after the update for all rows and they all show no failure.</p>\n\n<p>Bottom line, since the ConnectionTimeout property is ReadOnly, and the provider doesn't seem to support a Timeout in the connection string, what to do....</p>\n\n<p>Thanks. </p>\n"},{"tags":["java","excel","selenium","automation","selenium-ide"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12972959,"title":"Recording test cases in excel format from Selenium IDE","body":"<p>So as of now, I record actions on the website using Selenium IDE, then I manually write the test cases from that, which I write in an excel. Is there a way I can just get a direct output into an excel file?\nI know outputting to an excel file from IDE is not possible, but any ideas on how I could get this done? \nIDE can export the testcase in java, so maybe I could write another program to convert that into my format?\nWhat do you think?</p>\n"},{"tags":["java","apache","excel","apache-poi","delete-row"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":361,"score":0,"question_id":11520696,"title":"POI removeRow and shiftRows leaves blank rows at the end of sheet. How to delete them?","body":"<p>I am using POI to manipulate an existing excel sheet.<br>\nI want to remove rows in the begining and add rows at the end. When I remove rows I move all rows after them up.</p>\n\n<pre><code>int numOfRows = sheet.getLastRowNum()+1;\nint extraRows = numOfRows - maxAllowedRows;             \nfor(int i=1;i&lt;=extraRows;i++){  //i intialized with 1 to ignore header row.\n    sheet.removeRow(sheet.getRow(i));\n}\nsheet.shiftRows(extraRows+1,sheet.getLastRowNum(),-extraRows);\n</code></pre>\n\n<p>In current run of the program it works fine. But when the program runs again, as many rows as were removed and shifted in first run equal number of blank rows appear in the sheet at the bottom and any new row that I try to add at the bottom of the sheet gets added after these blank rows.</p>\n\n<p>Is there a way to avoid appearance of blank rows after the remove and shift operation (i.e. <em>Is there any way to actaully delete the rows?</em>)</p>\n"},{"tags":["excel","date"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":894,"score":5,"question_id":8745244,"title":"How to force Excel to automatically fill prior year in column instead of current year?","body":"<p><strong>Context:</strong> I'm entering prior year data into Excel.</p>\n\n<p>Every time I type in the date in the date column <em>(\"9/16\" for September 16th)</em>, Excel automatically formats it to \"9/16/12\", where 12 is 2012, the current year.</p>\n\n<p>I'm entering data from last year in the current year 2012.  I don't want to type the \"11\" for 2011.  I want Excel to automatically populate it as it does with 2012, and as it did on December 31st.</p>\n\n<p>The <strong>simplest</strong> fix is to set the clock in Windows back to any time in 2011, but that tends to muck with the network which wants to set me back and complains about my network password being out of date, etc.  </p>\n\n<p>I prefer the date to reside in a single column, so tabbing to alternate columns for day/month/year is not an option for me.</p>\n\n<p>One would think this is a simple fix, but a couple hours searching and my Google-fu is failing me.</p>\n"},{"tags":["excel","vba","add-in"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13071185,"title":"xla vs xlam addin, what is the difference?","body":"<p>Could someone please explain the difference between an xla Excel addin format and an xlam Excel addin format? Googling didnt provide anything useful.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13072096,"title":"Excel 2010 VBA - Update Graph using range defined by variable","body":"<p>I have an Excel sheet that is updating daily.  I am trying to automatically update a graph with the new data (1 row) that is added daily.</p>\n\n<p>So far I have:</p>\n\n<pre><code>Sub UpdateGraphs()\n\n    Dim latestRow As Integer\n\n    Sheets(\"DailyJourneyProcessing\").Select\n\n    Range(\"A500\").Select\n\n    Do Until ActiveCell.Value = \"\"\n        If ActiveCell.Value &lt;&gt; \"\" Then\n            ActiveCell.Offset(1, 0).Select\n        End If\n    Loop\n\n    ActiveCell.Offset(-1, 0).Select\n    Application.CutCopyMode = False\n    ActiveCell.EntireRow.Copy\n\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.EntireRow.PasteSpecial (xlPasteAll)\n\n    Application.CutCopyMode = False\n\n    latestRow = ActiveCell.row\n\n    Dim str1 As String\n    Dim rng1 As Range\n\n    str1 = \"=DailyJourneyProcessing!$F$180:$F$\" &amp; latestRow\n    Set rng1 = Range(str1)\n\n    Debug.Print \"Got this far...\"\n\n    Set ActiveChart.SeriesCollection(1).Values = Range(str1)\n</code></pre>\n\n<p>I know that this looks like I simply copy the previous row but the formula's included take car of the changes in data.</p>\n\n<p>The Integer / row at the moment is around 520, so I want to do:</p>\n\n<pre><code>ActiveChart.SeriesCollection(1).Values = \"=DailyJourneyProcessing!$F$180:$F$520\"\n</code></pre>\n\n<p>Where the row number changes daily.  This is one of about 20 range updates I need to automate, but once I have solved one the others should be the same.</p>\n\n<p>I have tried everything I can find online, but nothing quite worked.</p>\n\n<p>At the moment, I get a run-time error 91:  Object or With block variable not set.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["excel","date","excel-vba","excel-2007","autofill"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":12542703,"title":"Auto-fill the current date if the previous row was empty","body":"<p>I have a spreadsheet sorted by dates. Everyday, I enter new data into it. After each day, I leave one row empty before starting the next day. Example:</p>\n\n<pre><code>20.09.12 XXXXX XXXXX XXXXX XXXX\n         XXXXX XXXX  XXXXX XX\n         XX    XXXXX XX    XXXX\n\n21.09.12 XXX   XXXXX XXX   XXXX\n         X     XXXX  XXXX  XXX\n\n22.09.12 XXXX  XX    XXXX  XXXX\n</code></pre>\n\n<p>So I want excel to always fill in the current date whenever I enter data after one blank row, but obviously the dates shall stay the same - not be updated to the current date whenever I open excel. I am using Excel 2007 and while non vba ideas are preferred, vba is not a problem either!</p>\n"},{"tags":["excel","excel-vba","excel-2007","array-formulas"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13070982,"title":"Array formulas and PasteSpecial:=Formats","body":"<p>I have this small issue in a workbook. I wanted to simply a very long function by using array formulas. The formula works well and produces the expected results. However, in my VBA macro I copy and then I do a formula paste and then a format paste. The format paste crashes with : \"Impossible to paste because copy and paste zones are of different size\" (or similar to that). This problem is solved if I use any other formula that is not an array formula.</p>\n\n<p>Did anyone experience this before and find a proper solution ? I can't seem to find help an answer on Google. I'll post code if needed, but it is rather straight forward (<code>Row.Copy ... Rows(something, something).PasteSpecial...</code>) and works with a non-array formula anyway.</p>\n\n<p>Edit: The code:</p>\n\n<pre><code> sRapDetail = \"rap - détails\"\n\n    Sheets(sRapDetail).Select\n    iStart = 17\n    iFormuleExceptionRNIAC = 13\n    iFormule1 = 14\n    iFormule2 = 15\n    iFormuleExceptionAR = 16\n    range(Rows(iStart - 1), Rows(1000)).Hidden = False\n\n    iLastRow = Cells(65535, \"B\").End(xlUp).Row\n    range(\"A\" &amp; iStart &amp; \":AL\" &amp; iLastRow).Select\n'    selection.Borders(xlInsideVertical).LineStyle = xlNone\n'    selection.Borders(xlEdgeBottom).LineStyle = xlNone\n    selection.Delete Shift:=xlUp\n\n    'RNIAC\n    Sheets(\"Zoom0\").Select\n\n    If Cells(21, \"B\").Value = \"\" Or Cells(22, \"B\").Value = \"\" Then\n        iLastRow = 21\n    Else\n        iLastRow = Cells(21, \"B\").End(xlDown).Row\n    End If\n     iNbRow = iLastRow - 20\n\n    Sheets(sRapDetail).Select\n    Rows(iFormuleExceptionRNIAC).Select\n    selection.Copy\n    range(Rows(iStart), Rows(iStart - 1 + iNbRow)).Select\n    selection.PasteSpecial xlPasteFormulas\n    selection.PasteSpecial xlPasteFormats\n</code></pre>\n\n<p>(And yes I know the use of <code>selection</code> is ugly (or at least in this case) but this was written by a colleague)</p>\n"},{"tags":["excel","if-statement","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13071218,"title":"Concatenate Formula (Getting a #REF Error)","body":"<p>Afternoon all :)</p>\n\n<p>This is kind of a little difficult to explain but ill happily clarify where ever it is needed. Thank you for taking the time to read this post ^^ Here goes..</p>\n\n<p>I am currently creating a spreadsheet that is been extracted from the database whereby I am tasked to concatenate data from 2 adjacent cells. I change the database on a frequent basis adding or removing data wherever necessary so the range of data is always different. To concatenate the two cells I use the following formula:</p>\n\n<p>e.g:  =IF(ISBLANK(B8&amp;H8),\"\",B8&amp;H8)</p>\n\n<p>This formula works out great when im dealing with increasing amounts of data as I can simply drag the formula down as far as i want and i know that it will pick up the formula whenever I refresh the database without the need of seeing value errors when the formula ends up referring to a blank cell. The snag here (and my query as well) is if I have less data then before the formula within the last set of cells looks something like this:</p>\n\n<p>e.g:  =IF(ISBLANK(#REF!&amp;#REF!),\"\",#REF!&amp;#REF!)</p>\n\n<p>I have dealt with #REF before in other spreadsheets whereby I simply used a ISERROR in the statement but I dont know if there is a possible way of including this within my formula. I need the ISBLANK there so I have more control and dont have to drag the formula as often.</p>\n\n<p>If there is a better way around this or a way to amend the current formula Id appreciate the help :)</p>\n"},{"tags":["excel","excel-vba","excel-2007"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":13056051,"title":"Convert Date from yyyymmdd to mm/dd/yyyy Excel","body":"<p>I have been searching for about an hour on how to do this in Excel.</p>\n\n<p>I have an Excel file that was created from an old system and I am pulling information from a SQL Server Database, I will be inputting the information back into the SQL Server Database and would like the Dates to match.  </p>\n\n<p>I have tried Creating a Custom Format, but I am unsure if I even did it Correctly.  I found several places where they want to go the other way <code>mm/dd/yyyy</code> to <code>yyyymmdd</code>  but they have not been helpful.</p>\n\n<p>I am unfamiliar with using VBA in any Microsoft Products otherwise I am sure that this would be a simple Task.</p>\n\n<p>I have two separate Columns that need to be changed.</p>\n\n<p>How do I Format the entire Row from  <strong><code>(float)</code>yyyymmdd</strong> to a <strong><code>(Date)</code>mm/dd/yyyy</strong> </p>\n"},{"tags":["java","excel","jxl"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13071704,"title":"Text Object not supported. Java excel API","body":"<p>I have this piece of code to read from an xls file:    </p>\n\n<pre><code>fileName = \"....\"\n\nWorkbookSettings settings = new WorkbookSettings();\nsettings.setEncoding(\"Cp1252\");\n\nSystem.out.println(\"BEFORE\");\n\nWorkbook w = Workbook.getWorkbook(new File(fileName), settings);\nSheet sheet = w.getSheet(1);\n\nSystem.out.println(\"AFTER\");\n</code></pre>\n\n<p>This is what I get in the console:</p>\n\n<pre><code>BEFORE\nWarning:  Text Object on sheet \"Detalle\" not supported - omitting\njxl.common.AssertionFailed\n    at jxl.common.Assert.verify(Assert.java:37)\n    at jxl.read.biff.SheetReader.handleObjectRecord(SheetReader.java:1811)\n    at jxl.read.biff.SheetReader.read(SheetReader.java:1059)\n    at jxl.read.biff.SheetImpl.readSheet(SheetImpl.java:716)\n    at jxl.read.biff.WorkbookParser.getSheet(WorkbookParser.java:257)\n    at MapMovInfoResource.postService(MapMovInfoResource.java:77)\n</code></pre>\n\n<p>The problem comes when I try to open the second sheet in that file. When I use the first sheet (<code>w.getSheet(0)</code>), it works fine.</p>\n\n<p>Any ideas on how to solve this?</p>\n"},{"tags":["c#","asp.net","sql-server","excel","import"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":263,"score":-1,"question_id":13015818,"title":"Unable to import Excel file into SQL Server through asp.net","body":"<p>I am trying to import Excel file's data into SQL Server table.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>protected void Button1_Click(object sender, EventArgs e)\n{\n    String connectionString = string.Format(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=c:\\\\myFolder\\\\myExcel2007file.xlsx;Extended Properties=Excel 12.0;HDR=YES\");\n    String destinationConnectionString = \"Data Source=ARBAAZ-1B14C081;Initial Catalog=haj;Integrated Security=True\";\n\n    DataTable data = SelectDataFromSource(connectionString);\n\n    CopyDataToDestination(destinationConnectionString, data);\n}\n\nprivate DataTable SelectDataFromSource(String connectionString)\n{\n     DataTable data = new DataTable();\n\n     using (SqlConnection connection = new SqlConnection(connectionString))\n     {\n         SqlCommand command = new SqlCommand(\"SelectOrders\", connection);\n         command.CommandType = CommandType.StoredProcedure;\n         connection.Open();\n\n         SqlDataReader reader = command.ExecuteReader();\n         data.Load(reader);\n     }\n\n     return data;\n}\n\nprivate void CopyDataToDestination(String connectionString, DataTable table)\n{\n     SqlBulkCopyColumnMapping mapping1 = new SqlBulkCopyColumnMapping(\"ID\", \"IDa\");\n     SqlBulkCopyColumnMapping mapping2 = new SqlBulkCopyColumnMapping(\"Name\", \"Namea\");\n     SqlBulkCopyColumnMapping mapping3 = new SqlBulkCopyColumnMapping(\"Address\", \"Addressa\");\n     SqlBulkCopyColumnMapping mapping4 = new SqlBulkCopyColumnMapping(\"City\", \"Citya\");\n\n     SqlBulkCopy bulkCopy = new SqlBulkCopy(connectionString);\n     bulkCopy.BatchSize = 100;\n     bulkCopy.BulkCopyTimeout = 5;\n     bulkCopy.ColumnMappings.Add(mapping1);\n     bulkCopy.ColumnMappings.Add(mapping2);\n     bulkCopy.ColumnMappings.Add(mapping3);\n     bulkCopy.ColumnMappings.Add(mapping4);\n     bulkCopy.DestinationTableName = \"orders\";\n     bulkCopy.SqlRowsCopied += new SqlRowsCopiedEventHandler(bulkCopy_SqlRowsCopied);\n     bulkCopy.NotifyAfter = 200;\n\n     bulkCopy.WriteToServer(table);\n}\n\nvoid bulkCopy_SqlRowsCopied(object sender, SqlRowsCopiedEventArgs e)\n{\n    Response.Write(String.Format(\"{0} Rows have been copied.\", e.RowsCopied.ToString()));\n}\n</code></pre>\n\n<p>error: </p>\n\n<pre><code>Exception Details: System.ArgumentException: Keyword not supported: 'provider'. \nSource Error: \nLine 33: { \nLine 34: DataTable data = new DataTable(); \nLine 35: using (SqlConnection connection = new SqlConnection(connectionString)) \nLine 36: { \nLine 37: SqlCommand command = new SqlCommand(\"SelectOrders\", connection); \n</code></pre>\n"},{"tags":["c#","excel","powerpivot"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":605,"score":4,"question_id":8242557,"title":"Connecting to PowerPivot with C#","body":"<p>Is it possible to connect to a PowerPivot model in an Excel .xlsx file? (Not hosted on a SharePoint site... just the local file).</p>\n\n<p>It must be, since Tableau can do it. </p>\n\n<p>Anyone have any clues?</p>\n"},{"tags":["regex","excel","vba","excel-vba","delimiter"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13027130,"title":"Delimiting columns very specifically","body":"<p>I've got a column (with many thousands of rows) which I'd like to delimit into multiple rows. I have some experience using regular expressions in Excel, and I have some experience using delimiters in excel, but this one is just a tad too hard..</p>\n\n<p>Let me give you three example-lines:</p>\n\n<pre><code> - 23-12-05: For sale for 2000. 2010-09-09: Not found\n - 25-11-09: For sale for 3400. Last date found: 2010-07-08\n - 18-06-08: For sale for 5500. 21-07-09: Changed from 5500 to 4900. 16-09-09: Jumped from 4900 to 4700. 2010-02-04: Not found\n</code></pre>\n\n<p>Most other lines follow these structures. How can I create a new column based on just the first symbols before [COLON]; A second column based on the symbols between the first [COLON] and the first [DOT]. How can I continue to the last IF the text LAST DATE is not found? Finally: How can I use regex (or another way) to use the text 'NOT FOUND' to paste the last date into a new column?</p>\n\n<p>Trust me, I have been at this for quite some time now (sigh). Any help is much appreciated!</p>\n"},{"tags":["c#","excel","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13069153,"title":"Eliminating use of '2 dots' when using Excel Interop Com Objects - C#","body":"<p>I am having trouble releasing Excel Interop Com Objects which is causing my c# application to crash when I attempt to save and then close an Excel workbook created via Excel Interop.  I feel the issue is that in some cases I am using '2 dots' with excel interop COM objects which from what I've read is not allowed.  I have eliminated 2 dots from most lines of code, but I am having troulbe figuring out a way to recreate the following lines of code so that they only use one dot.  If anyone has any suggestions I would greatly appreciate it.</p>\n\n<pre><code>workbook = (Excel.Workbook)app.Workbooks.Open(startForm.excelFileLocation,);\n\nworkbook = (Excel.Workbook)app.Workbooks.Add(1);\n\nworkSheet_range.Font.Color = System.Drawing.Color.FloralWhite.ToArgb();\n\nworkSheet_range.Font.Bold = font;\n\nworkSheet_range.Interior.Color = System.Drawing.Color.Red.ToArgb();\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13058703,"title":"Format pages to print in 2 columns","body":"<p>Does anyone know how to move pages in excel to basically split a spreadsheet in half?   </p>\n\n<p>Example, I have 390,000 lines in a spreadsheet.<br>\nIf you were to print the spreadsheet in portrait format with a 12 size font, that would come out to about 44 lines per page at close to 8800 pages.  </p>\n\n<p>I want to cut that in half.  </p>\n\n<p>I have 3 columns.  All I want to do is bring the even pages to the odd pages, where there is plenty of room.  Can anyone advise me as to what I can do?   </p>\n\n<p><img src=\"http://i.stack.imgur.com/bAH9E.png\" alt=\"enter image description here\"></p>\n"},{"tags":["java","swing","excel","jtable"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13070379,"title":"How to Suppress Extension Warning in Excel","body":"<p>I have created an Excel file from my JTable. The same button that creates it also opens it. But it gives a prompt :</p>\n\n<blockquote>\n  <p>The file you are trying to open is in a different format than specified by \n  the file extension. Verify that the file is not corrupted and is from a \n  trusted user before opening the file. Do you want to open the file?</p>\n</blockquote>\n\n<p>When I click OK the file opens. I am using Office 2007 and am saving the file as <code>.xls</code>. Is there a way of stopping the prompt from the code level? Here is the code that creates and opens the file:</p>\n\n<pre><code>if (obj == btnExport) {\n  File f = new File(\"Student Results\");\n  f.mkdir();\n  try {\n    TableModel model = DataBaseTable.getModel();\n    FileWriter excel = new FileWriter(\"Student Results/\" + exam  + \"_\"+ level + \"_\" + year + \".xls\");\n    for(int i = 0; i &lt; model.getColumnCount(); i++){\n      excel.write(model.getColumnName(i) + \"\\t\");\n    }\n\n    excel.write(\"\\n\");\n\n    for(int i=0; i&lt; model.getRowCount(); i++) {\n      for(int j=0; j &lt; model.getColumnCount(); j++) {\n        excel.write(model.getValueAt(i,j).toString()+\"\\t\");\n      }\n      excel.write(\"\\n\");\n    }\n\n    excel.close();\n    JOptionPane.showMessageDialog(this, \"File Exported to \" + f.getAbsolutePath(),\n    \"Success\", JOptionPane.INFORMATION_MESSAGE);\n    File opn = new File(\"Student Results/\" + exam  + \"_\"+ level + \"_\" + year + \".xls\");\n    Desktop.getDesktop().open(opn);\n\n  } catch (Exception se) {\n    JOptionPane.showMessageDialog(this, se,\n    \"Error\", JOptionPane.ERROR_MESSAGE);\n  }\n}\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":13062270,"title":"Coloring Excel cells under conditions","body":"<p>I'm trying to find a code in excel macro that can address the following problem.</p>\n\n<p>If the first column contains any text then highlight the first column cells with a certain color until next text doesn't appear in the same column. When any text appears in the same column, start coloring the cells with different color.</p>\n\n<p>I have to repeat this for all the worksheets in my workbook.\nThanks.</p>\n\n<p><img src=\"http://i.stack.imgur.com/DNtTr.jpg\" alt=\"enter image description here\"></p>\n\n<p>Right now I'm using this macro to colour the cells which are empty\nbut the problem is the color doesnot change whenever a text is encountered</p>\n\n<pre><code>Sub try()\nDim i As Integer\nDim j As Integer\nDim k As Integer\ni = 200\nj = 100\nk = 5\n\nApplication.ScreenUpdating = False\n\nWith ActiveSheet.UsedRange\n    .AutoFilter Field:=1, Criteria1:=\"\"\n    If WorksheetFunction.CountBlank(.Columns(1)) &gt; 0 Then\n        .Columns(1).SpecialCells(xlCellTypeBlanks).Interior.Color = RGB(i, j, k)\n    Else\n        i = i - 50\n        j = j - 10\n        k = 255\n    End If\n\n    .AutoFilter\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13065896,"title":"Convert vertical data to horizontal in excel","body":"<p>In an excel sheet I have data as below:</p>\n\n<pre><code>Name        Age\n-------    -------\nXYZ        24\nABC        25\nCDE        26\nGHI        27\n</code></pre>\n\n<p>I want this data to be converted as following in excel sheet.</p>\n\n<pre><code>Name1     Age1    Name2     Age2    Name3     Age3    Name4     Age4\nXYZ       24      ABC       25      CDE       26      GHI       27\n</code></pre>\n\n<p>Is this possible? please help. Thanks!</p>\n"},{"tags":["sql","excel","script"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13067370,"title":"convert excel worksheet to sql script","body":"<p>I have a excel worksheet (.xls). I need to convert it into sql script. The single excel worksheet consists of multiple tables. So the resultant script should have multiple create table and insert statements. \nI tried various tools such as <a href=\"http://www.sqlconverter.com/\" rel=\"nofollow\">http://www.sqlconverter.com/</a> but I am unable to get a proper solution. Any other way I can do it?</p>\n"},{"tags":["excel","word","dropdownbox"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13053491,"title":"VBA to copy selected value of dropdown in Word Doc into specific Excel cell","body":"<p>I am trying to return the text from a dropdown box that is selected on a Word form. </p>\n\n<p>The word doc is a survey that contains a form with several dropdown boxes.  I want to copy the value that the survey respondent selected from each dropdown into specific cells in Excel.</p>\n\n<p>I have tried things such as:</p>\n\n<pre><code>Activedocument.DropDowns(\"DropDown1\").Value;\nActivedocument.DropDowns(\"DropDown1\").Text; \nActivedocument.DropDowns(\"DropDown1\").SelectedValue; \nActivedocument.Shapes(\"DropDown1\").Value etc etc.\n</code></pre>\n\n<p>Current applicable parts of my code:</p>\n\n<pre><code>Dim dd14 As FormFields\nWith ActiveDocument\nSet dd14 = ActiveDocument.FormFields(\"Dropdown14\").DropDown.Value\nCells(iRow + 1, \"H\") = dd14\nEnd With\n</code></pre>\n"},{"tags":["excel","pdf-generation","jodconverter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12971125,"title":"create pdf from multiple excel sheets and tabs in Java","body":"<p>I want to read some excel files with multiple sheets in it.</p>\n\n<p>All sheets should be printed 2 on 1 in a pdf.</p>\n\n<p>I've found the <a href=\"http://code.google.com/p/jodconverter/\" rel=\"nofollow\">jodconverter</a> library. \nIf there are better or easier opinions please tell me.</p>\n\n<p><img src=\"http://i.stack.imgur.com/tVr7a.png\" alt=\"simplified descripton of the text\"></p>\n\n<p>May important:\ni don't want to change something in the xls files, if not necessary.</p>\n\n<p>EDIT:\nFollowing approach, merging all the xls with <a href=\"http://poi.apache.org/spreadsheet/index.html\" rel=\"nofollow\">apache poi</a> and print them to one pdf, I think i need a option to configure the \"printer\". How can I do that?</p>\n\n<h2>EDIT2:</h2>\n\n<p>I've found a way to print directly xls to pdf with the <a href=\"http://www.jxcell.net/\" rel=\"nofollow\">jxcell-library</a>. There is an <a href=\"http://www.jxcell.net/features.htm\" rel=\"nofollow\">example</a> for printing a pdf from a xls file. But mutliple spreadsheet arent listend. So i'll going to seperate them with poit, print them to pdf, and merge it.</p>\n\n<p>If you know a faster or easyier solution, feel free to answer.</p>\n"},{"tags":["c#","excel","interop","dataset","excel-interop"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":11271,"score":3,"question_id":7244971,"title":"Import Excel data into a DataSet using Microsoft.Office.Interop.Excel","body":"<h1>What I want to do</h1>\n\n<p>I'm trying to use the <strong>Microsoft.Office.Interop.Excel</strong> namespace to open an Excel file (XSL or CSV, but sadly not XSLX) and import it into a DataSet. I don't have control over the worksheet or column names, so I'd like to allow for changes to them.</p>\n\n<h1>What I've tried</h1>\n\n<p>I've tried the <a href=\"http://www.c-sharpcorner.com/uploadfile/yuanwang200409/102242008174401pm/1.aspx\" rel=\"nofollow\">OLEDB method</a> of this in the past, and had a lot of problems with it (buggy, slow, and required prior knowledge of the Excel file's layout), so I'd like to avoid doing that again. What I'd like to do is use Microsoft.Office.Interop.Excel to import the workbook directly into a DataSet, or loop through the worksheets and load each one into a DataTable.</p>\n\n<p>Believe it or not, I've had trouble finding resources for this. <a href=\"http://stackoverflow.com/search?page=3&amp;tab=relevance&amp;q=c#%20excel%20dataset\">A few searches on StackOverflow</a> have found mostly people trying to do the reverse (DataSet => Excel), or the OLEDB technique. Google hasn't been much more helpful.</p>\n\n<h1>What I've got so far</h1>\n\n<pre><code>    public void Load(string filename, Excel.XlFileFormat format = Excel.XlFileFormat.xlCSV)\n    {\n        app = new Excel.Application();\n        book = app.Workbooks.Open(Filename: filename, Format: format);\n\n        DataSet ds = new DataSet();\n\n        foreach (Excel.Worksheet sheet in book.Sheets)\n        {\n            DataTable dt = new DataTable(sheet.Name);\n            ds.Tables.Add(dt);\n\n            //??? Fill dt from sheet \n        }\n\n        this.Data = ds;\n    }\n</code></pre>\n\n<p>I'm fine with either importing the entire book at once, or looping through one sheet at a time. Can I do this with Microsoft.Office.Interop.Excel?</p>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":124,"score":1,"question_id":13063837,"title":"Excel macro if file exist","body":"<p>So like the topic title says, i am looking for some help with a macro.\nI need it for my job so every time a clients backup is executed he sends a mail to a mailbox and these mails are exported in the folder.\nThis is the mail format:</p>\n\n<blockquote>\n  <p>Backup Rapport Success Clients name File Backup Set Taak 2012-10-23 (20 30)</p>\n</blockquote>\n\n<p>The macro's needs to do a few things :</p>\n\n<ul>\n<li>Extract the name of the client</li>\n<li>extract or the backup whas SUccess or failed or missed</li>\n<li>And write the success or failed message in the right cell </li>\n</ul>\n\n<p>Is this even possible?</p>\n\n<pre><code>Public Function FileFolderExists(strFullPath As String) As Boolean\n'Author       : Ken Puls (www.excelguru.ca)\n'Macro Purpose: Check if a file or folder exists\n    On Error GoTo EarlyExit\n    If Not Dir(strFullPath, vbDirectory) = vbNullString Then FileFolderExists = True\n\nEarlyExit:\n    On Error GoTo 0\nEnd Function\n\nPublic Sub TestFolderExistence()\n'Author       : Ken Puls (www.excelguru.ca)\n'Macro Purpose: Test if directory exists\n    If FileFolderExists(\"c:\\test\") Then\n        MsgBox \"Folder exists!\"\n    Else\n        MsgBox \"Folder does not exist!\"\n    End If\nEnd Sub\n</code></pre>\n"},{"tags":["javascript","jquery","excel","firefox"],"answer_count":4,"favorite_count":3,"up_vote_count":13,"down_vote_count":5,"view_count":3518,"score":8,"question_id":5494387,"title":"Read Excel data with JQuery","body":"<p>I would like to know how to read data from a multi-worksheet MS Excel 2003 file using nothing, but jquery. I have read several solutions for PHP/JQuery, ActiveX, etc..., but I would like to do it with <em>JQuery ONLY</em>. Any idea of how this could work?</p>\n\n<p>I have found <a href=\"http://plugins.jquery.com/project/csv2table\" rel=\"nofollow\" rel=\"nofollow\">http://plugins.jquery.com/project/csv2table</a> and this does the job almost perfectly, except for the fact that I have to break each sheet out into a CSV file. I would like to drop that step and read it directly from the Excel file. Thank you in advance for your help!</p>\n\n<p><em>BTW - I am working in FireFox 4 and have no need for cross browser support.</em></p>\n"},{"tags":["sql-server","excel","import","sqldatatypes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13066774,"title":"Import SQL Server data into Excel with user-defined data types","body":"<p>I have a SQL Server and I want to import data from a view into Excel via Microsoft Query. </p>\n\n<p>Sounds easy right? Well it isn't as some of the columns are of a user-defined data type.</p>\n\n<p><strong>tblSeller</strong>:</p>\n\n<ul>\n<li>ID: <code>int</code></li>\n<li>Name: <code>nvarchar(50)</code></li>\n<li>Country: <code>CountryName:nvarchar(50)</code></li>\n</ul>\n\n<p><strong>tblBuyer</strong>:</p>\n\n<ul>\n<li>ID: <code>int</code></li>\n<li>Name: <code>nvarchar(50)</code></li>\n<li>Country: <code>CountryName:nvarchar(50)</code></li>\n</ul>\n\n<p><strong>tblSale</strong>:</p>\n\n<ul>\n<li>ID: <code>int</code></li>\n<li>SellerId: <code>int</code></li>\n<li>BuyerId: <code>int</code></li>\n</ul>\n\n<p><strong>vSales</strong>:</p>\n\n<pre><code>SellerName, SellerCountry, BuyerName, BuyerCountry\n</code></pre>\n\n<p>(I think you get the idea that I have joined <code>tblSale</code> with <code>tblSeller</code> and <code>tblBuyer</code> and want to get names and countries - and since this is just an example I have left out all other stuff which would make it a useful view!!!)</p>\n\n<p>The view <code>vSales</code> works like a charm on my server: It shows me all my information. The problem occurs when I want to import it into Excel 2010 via \"From Microsoft Query\" (Data => From Other Sources => From Microsoft Query). All columns with a user-defined data type are not available!</p>\n\n<p>Only if I import data directly via \"From SQL Server\" (Data => From Other Sources => From SQL Server) I get my data. But as my real view contains hundreds of columns and nearly 200.000 rows that is not and option as I need to specify which columns I want to import.</p>\n\n<p>So to put it short: how to import data from a SQL Server view into Excel using a Microsoft Query in order to be able to limit number of columns?</p>\n"},{"tags":[".net","excel","c#-4.0","ribbon-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13066569,"title":"Excel Ribbon Controls from C#","body":"<p>I have some code that updates a C# Excel ribbon control as follows:</p>\n\n<pre><code>public void MyToggle_Click(object sender, RibbonControlEventArgs e)\n{     \n     MyToggle.Label = \"Clicked!\";\n}\n</code></pre>\n\n<p>This works fine, until I try to access the toggle object from a method that isn't raised as a ribbon event (such as <code>_Click</code>) but instead by a WCF callback hosted by my class:</p>\n\n<pre><code>#region IControllerCallback Members    \n\npublic void MethodCalledByWCFDuplexCallback()\n    {\n         Globals.Ribbons.MyRibbon.MyToggle.Label = \"info\";         \n         ConnectionToggle.Label = \"info\";\n    }\n\n#endregion\n</code></pre>\n\n<p>Which results in the exception:</p>\n\n<p>\"Unable to cast COM object of type 'System.__ComObject' to interface type 'Microsoft.Office.Core.IRibbonUI'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{000C03A7-0000-0000-C000-000000000046}' failed due to the following error: Error loading type library/DLL. (Exception from HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY)).\"</p>\n\n<p>Any ideas?\nThanks!</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":102,"score":-1,"question_id":13063418,"title":"Run Time Error 1004: Application-Defined or Object Defined Error","body":"<p><img src=\"http://i.stack.imgur.com/w8ffB.png\" alt=\"ExcelSpreadSheet\"><img src=\"http://i.stack.imgur.com/3CWSa.png\" alt=\"VBAScrennshot\">I am trying to record a macro which will create pivot chart out of excel data and here is the code that has been recorded:                        </p>\n\n<pre><code>Sub chart1()\n '\n ' chart1 Macro\n '\n\n '\nRange(\"E1:F11\").Select\nSheets.Add\nIn Debugger, code within the **** **** is shown in Yellow color\n***** ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"data!R1C5:R11C6\", Version:=xlPivotTableVersion12).CreatePivotTable _\n    TableDestination:=\"Sheet1!R3C1\", TableName:=\"PivotTable1\", DefaultVersion _\n    :=xlPivotTableVersion12 ********\nSheets(\"Sheet1\").Select\nCells(3, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"question1\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"answer1\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable1\").PivotFields(\"answer1\"), \"Count of answer1\", xlCount\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"answer1\")\n    .Orientation = xlPageField\n    .Position = 1\nEnd With\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"answer1\").Orientation = _\n    xlHidden\nWith ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"answer1\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\nActiveSheet.Shapes.AddChart.Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$3:$D$6\")\nActiveSheet.Shapes.AddChart.Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$3:$D$6\")\nActiveChart.ChartType = xlColumnClustered\nEnd Sub\n</code></pre>\n\n<p>Why am I getting the Run Time Error 1004: Application-Defined or Object Defined Error when i try to run this macro ?</p>\n\n<p>Thanks in advance..</p>\n"},{"tags":["excel","excel-vba","vsto","excel-2007","excel-2010"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13065597,"title":"How to capture the top or bottom border of a selection or cell in excel properly?","body":"<p>![The image show cell A1 in excel sheet whose Bottom Border has been set.<a href=\"http://i.stack.imgur.com/KB7dy.jpg\" rel=\"nofollow\">1</a>I am trying to mock the format painter behavior. \nI have created the bottom border of a cell (lets say A1) using \"Format Cells\" option. \nWhile capturing if I capture the formatting of cell A2 then <strong>bottom border of cell A1 is captured as top border of cell A2</strong> which doesn't not happen in native \"Format Painter\" option. \nNow If I programmatically capture the formatting ( which includes Border) of cell <strong>A2</strong> and apply it to some other cell in the sheet the result would be the destination cell/seletion whill have TOP border.\nIn native format painter option this doesn't happen, I mean if we capture cell <strong>A2</strong> formatting and apply on some other cell it will do nothing.\nWhat should I do ?</p>\n"},{"tags":["java","excel","optimization","apache-poi","xssf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":592,"score":1,"question_id":11154678,"title":"XSSFWorkbook takes a lot of time to load","body":"<p>I am using the following code:</p>\n\n<pre><code>File file = new File(\"abc.xlsx\");\nInputStream st = new FileInputStream(file);\nXSSFWorkbook wb = new XSSFWorkbook(st);\n</code></pre>\n\n<p>The xlsx file itself has 25,000 rows and each row has content in 500 columns. During debugging, I saw that the third row where I create a XSSFWorkbook, it takes a lot of time (1 hour!) to complete this statement.</p>\n\n<p>Is there a better way to access the values of the original xlsx file?</p>\n\n<p>Thanks\nAbhishek S</p>\n"},{"tags":["performance","excel","vba","optimization","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":140,"score":-7,"question_id":13039069,"title":"Optimize VBA Code","body":"<p>Can somebody help me optimize this code.  It is a macro to input formulas into a was-is spreadsheet (deltas, rows subtotals, column subtotals).  It works well with small amounts of data, but with large datadumps it takes upward of 15 minutes and sometimes bombs out excel.  I wrote this code myself, so i am sure there are many ways to make it more efficient.  </p>\n\n<p>Here is the code (Sorry about format):</p>\n\n<pre><code>'Variables\nDim Rcnt As Long\nDim Ccnt As Long\nDim i As Long\nDim j As Long\nDim n As Long\nDim rValues As Long\nDim msgComplete As Long\n\n 'Delete extra rows\nActiveSheet.UsedRange\nRcnt = Cells.SpecialCells(xlLastCell).Row\nCcnt = Cells.SpecialCells(xlLastCell).Column\n\nFor n = 1 To Ccnt\n    If IsError(Application.VLookup(\"Values\", Columns(n), 1, False)) Then\n        'do nothing\n    Else\n        If WorksheetFunction.Match(\"Values\", Columns(n), 0) = 1 Then\n            MsgBox (\"Error.  Did not paste updated pivot table data.  Exiting Macro.\")\n            Exit Sub\n        Else\n            Rows(1 &amp; \":\" &amp; (WorksheetFunction.Match(\"Values\", Columns(n), 0)) - 1).Delete\n        End If\n    End If\nNext n\n\n'Copy down pivot data\nActiveSheet.UsedRange\nRcnt = Cells.SpecialCells(xlLastCell).Row\nCcnt = Cells.SpecialCells(xlLastCell).Column\n\nFor n = WorksheetFunction.Match(\"Values\", Rows(1), 0) - 1 To 1 Step -1\n    For i = 1 To Rcnt\n        If Cells(i, n).Value = \"\" Then\n            Cells(i, n) = Cells(i, n).Offset(-1, 0)\n            Cells(i, n).Font.Color = RGB(255, 255, 255)\n        Else\n            'do nothing\n        End If\n    Next i\nNext n\n\n'Input delta formulas\nFor n = WorksheetFunction.Match(\"Values\", Rows(1), 0) To 1 Step -1\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"BAC Delta\") _\n        Or InStr(1, Cells(i, n), \"EAC Delta\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=R[-1]C-R[-2]C\"\n            Next j\n        End If\n    Next i\nNext n\n\n'Input grand total sum formulas\nFor n = WorksheetFunction.Match(\"Values\", Rows(1), 0) To 1 Step -1\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Revised BAC\") Or InStr(1, Cells(i, n), \"BAC Delta\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Or InStr(1, Cells(i, n), \"EAC Delta\") Then\n            Cells(i, Ccnt) = \"=Sum(\" &amp; Cells(i, Ccnt).Offset(0, -1).Address(False, False) &amp; \":\" _\n            &amp; Cells(i, WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1).Address(False, False) &amp; \")\"\n        End If\n    Next i\nNext n\n\n'Input sumifs formulas\n n = 10\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(n).Offset(0, -4).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -4).Address &amp; \",\" &amp; Columns(n).Offset(0, -5).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -5).Address &amp; \",\" &amp; Columns(n).Offset(0, -6).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -6).Address &amp; \",\" &amp; Columns(n).Offset(0, -7).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -7).Address &amp; \",\" &amp; Columns(n).Offset(0, -8).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -8).Address &amp; \",\" &amp; Columns(n).Offset(0, -9).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -9).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 9\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(n).Offset(0, -4).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -4).Address &amp; \",\" &amp; Columns(n).Offset(0, -5).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -5).Address &amp; \",\" &amp; Columns(n).Offset(0, -6).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -6).Address &amp; \",\" &amp; Columns(n).Offset(0, -7).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -7).Address &amp; \",\" &amp; Columns(n).Offset(0, -8).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -8).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 8\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(n).Offset(0, -4).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -4).Address &amp; \",\" &amp; Columns(n).Offset(0, -5).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -5).Address &amp; \",\" &amp; Columns(n).Offset(0, -6).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -6).Address &amp; \",\" &amp; Columns(n).Offset(0, -7).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -7).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 7\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(n).Offset(0, -4).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -4).Address &amp; \",\" &amp; Columns(n).Offset(0, -5).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -5).Address &amp; \",\" &amp; Columns(n).Offset(0, -6).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -6).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 6\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(n).Offset(0, -4).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -4).Address &amp; \",\" &amp; Columns(n).Offset(0, -5).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -5).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 5\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(n).Offset(0, -4).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -4).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 4\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \",\" &amp; Columns(n).Offset(0, -3).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -3).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 3\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(n).Offset(0, -2).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -2).Address &amp; \", \" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 2\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)), \" &amp; Columns(n).Offset(0, -1).Address &amp; _\n                \",\" &amp; Cells(i, n).Offset(0, -1).Address &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 1\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(n).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")-2),LEFT(\" &amp; Cells(i, n).Address &amp; _\n                \",search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")-2)),\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n\nn = 1\nIf IsError(Application.Find(\"Values\", Cells(1, n))) Then\n    For i = Rcnt To 1 Step -1\n        If InStr(1, Cells(i, n), \"Total Current BAC\") _\n        Or InStr(1, Cells(i, n), \"Total Revised BAC\") _\n        Or InStr(1, Cells(i, n), \"Total Current EAC\") _\n        Or InStr(1, Cells(i, n), \"Total Revised EAC\") Then\n            For j = Ccnt - 1 To WorksheetFunction.Match(\"Values\", Rows(1), 0) + 1 Step -1\n                Cells(i, j) = \"=Sumifs(\" &amp; Columns(j).Address(False, False) &amp; \",\" &amp; Columns(WorksheetFunction.Match(\"Values\", Rows(1), 0)).Address &amp; _\n                \",If(not(iserror(search(\"\"Current\"\" ,\" &amp; Cells(i, n).Address &amp; \"))), right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Current\"\",\" &amp; Cells(i, n).Address &amp; \")+1)),right(\" &amp; Cells(i, n).Address &amp; _\n                \",(len(\" &amp; Cells(i, n).Address &amp; \")-search(\"\"Revised\"\",\" &amp; Cells(i, n).Address &amp; \")+1))))\"\n            Next j\n        End If\n    Next i\nElse\n    'do nothing\nEnd If\n</code></pre>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13050341,"title":"Count names one time (per year) regardless of how many there are by year","body":"<p>I have a client that has asked something very simple, but as luck would have it - it's very hard!!!</p>\n\n<p>The problem is:</p>\n\n<p>There is a table that gets data added to it each month.  I use this data for many different pivot tables and reports, so I am not able to modify it.  The user has requested that if its possible (and I assured him that it was) he would like to see two (2) single values of This Year and Last Year Doctors on the list.</p>\n\n<p>The data looks something like this:\nDoctor, In/Out, Date, Number</p>\n\n<p><code>John Deaux   Out     10/1/11     8</code><br/>\n<code>John Deaux   Out     11/1/11     3</code><br/>\n<code>John Deaux   Out     01/1/12     5</code><br/>\n<code>John Deaux   Out     05/1/12     3</code><br/>\n<code>John Deaux   Out     09/1/12     1</code><br/>\n<code>Billy White   In      02/1/12     2</code><br/>\n<code>Mike Adams   Out     06/1/11     6</code><br/>\n<code>Mike Adams   Out     10/1/11     9</code><br/>\n<code>Mike Adams   Out     01/1/12     1</code><br/>\n<code>Mike Adams   Out     04/1/12     6</code><br/></p>\n\n<p>I would have 1 John Deaux for 2011, and 1 for 2012.  The same for Mike Adams.</p>\n\n<p>TY    2\nLY    2</p>\n\n<p>Now I only have to count the \"Out\"(s), so I have to be careful of that.  Also, there is the chance that I would have to build this for the previous 12 months as well making it that much harder.</p>\n\n<p>1 for John Deaux for the previous 12 months.</p>\n\n<p>TY    2\nLY    1</p>\n\n<p>Any help would be greatly appreciated!</p>\n"},{"tags":["excel","vba","workbook"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1210,"score":3,"question_id":10012463,"title":"How to call function from another specific workbook in VBA?","body":"<p>I would like to know if there is a way to call a VBA function or method from another specified workbook's module as it is possible for a specific worksheet without using the Application.Run</p>\n\n<p>For the worksheet I can call for example :</p>\n\n<pre><code>ActiveSheet.MyTest() \n</code></pre>\n\n<p>if MyTest is defined in the sheet module</p>\n\n<p>But I would like to call a function which is defined in a module</p>\n\n<p>I tried :</p>\n\n<pre><code>ActiveWorkbook.MyTestModule()\nActiveWorkbook.VBProject.VBComponents(\"MyModule\").MyTestModule(myArg)\n</code></pre>\n\n<p>which don't work generating an error Object does not support this method</p>\n\n<p>I could call </p>\n\n<pre><code>Application.Run(ActiveWorkbook.name &amp; \"!MyTestModule\", myArg)\n</code></pre>\n\n<p>But I am not sure of the error handling of the Application.Run and I would find cleaner to run directly the method</p>\n"},{"tags":["excel","excel-vba","macros"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13060580,"title":"force data in a cell to be the one next to the one in a list only if its in the list","body":"<p>I have two sheets....</p>\n\n<ul>\n<li>Sheet one I have two areas we will call them a1 and a2.</li>\n<li>sheet two I have two areas we will call them c1 and c2.</li>\n</ul>\n\n<p>What I want to do is enter a value into a1, check a list on the second sheet in c1, and if the value is there, use the value next to it in c2 to populate a2. If that value is not in the list I would like to add it to the list in c1.</p>\n\n<p>Is it possible to do that last part with a <code>dropdown</code> box? - put a value into the dropdown box and if its not in the list then add it to the list.</p>\n"},{"tags":["excel","c#-4.0","office-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13043347,"title":"Dynamically Change Button Image in Excel 2010","body":"<p>I'm using XML to create a custom Excel Ribbon in which I have a button that contains an image. I would like to be able to change this image when the button is pressed (like a toggle) to show what state it's in. I have the following XML to describe the button:</p>\n\n<pre><code>&lt;button id=\"MyButton\"\n            label=\"MyLabel\"\n            screentip=\"Some useful info.\"\n            onAction=\"MyAction\"\n            getImage=\"GetImage\"\n            size=\"large\"/&gt;\n</code></pre>\n\n<p>Where the <code>MyAction</code> method is defined as:</p>\n\n<pre><code>public void MyAction(Office.IRibbonControl control)\n{\n     // Change button image here...\n}\n</code></pre>\n\n<p>Is there some way I can change the button's image in the <code>MyAction()</code> method?</p>\n\n<p>Thanks,\nFrank</p>\n"},{"tags":["perl","excel","ole"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":13062522,"title":"invalid index in perl","body":"<p>I am very new to the perl programming. I am having a perl script which basically runs and produces output as a report in excel spreadsheet. I added another tab to this existing excel report and updated the variables in the perl script accordingly. When I execute this perl script after the changes, I am getting invalid index method/property get error. This is the script where it is throwing an error. Any help would be greatly appreciated, thanks.</p>\n\n<pre><code>#Begin subroutines\n    sub writeUUs\n    {\n        my ($sql1, $column1, $row1, $brandName1) = @_;\n        my $cellRange;\n        my $Sheet = $Book -&gt; Worksheets($brandName1);\n        $Sheet -&gt; Activate();\n</code></pre>\n"},{"tags":["php","excel","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13061660,"title":"Insert Image in csv file using php script","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11337142/php-code-can-insert-image-to-excel-file-and-open-it-correctly-in-ms-excel\">PHP code can insert image to excel file and open it correctly in MS Excel?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to add images in <code>.csv</code> file with the help of PHP script. I also don't know if it is possible or not.</p>\n\n<p><img src=\"http://i.stack.imgur.com/BYNss.png\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","excel-2007","excel-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12780323,"title":"Excel grouping, the minimize button at the top?","body":"<p>There seems to be two different ways of grouping rows in Excel:</p>\n\n<ol>\n<li>Both the expand and contract +/- buttons are on the \"top level\" row of the grouping.</li>\n<li>The \"+\" button is on the top row of the grouping, you expand this and the \"-\" is the same row number as the last expanded row.</li>\n</ol>\n\n<p>I would like to implement option 1 every time, but I am unsure what determines whether option 1 or option 2 is implemented?</p>\n"},{"tags":["query","excel","vba","export"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13059900,"title":"Having trouble exporting multiple MS Access 2010 queries to MS Excel 2010 from one \"Form Load\" or \"Form Open\"","body":"<p>I tried this several different ways but it keeps stopping after the first one. I tried adding other forms, form 1 to run one on open, then form 1 opens form 2 which runs one export etc but that didn't work. I tried pausing, <code>do while not isloaded(next form)</code> etc but that didn't work.</p>\n\n<pre><code>Option Compare Database\nPrivate Sub Form_Load()\nOn Error GoTo Err_Form_Load\n\n'I tried 9\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"All-ActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _\n\"All-ActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\n\n'I tried 12 and 12XML\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllFilteredABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllFilteredABC.xls\", True\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _\n\"AllActiveABC\", _\n\"Y:\\Projects\\Protocol Folders\\AllActiveABC.xls\", True\n\n'I tried it as a function\n'see function below the three exports\n\nCall exportData(\"All-FilteredABC\", _\n\"Y:\\Projects\\Folders\\All-FilteredABC.xlsx\")\nCall exportData(\"AllActiveABC\", _\n\"Y:\\Projects\\Folders\\AllActiveABC.xlsx\")\nCall exportData(\"AllABC\", _\n\"Y:\\Projects\\Folders\\AllABC.xlsx\")\n\n\nFunction exportData(queryName As String, strSaveFileName As String)\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, queryName, strSaveFileName, True \n\nEnd Function\n</code></pre>\n\n<p>No luck. I am so confused by all the things I've tried and the different outcomes I've had like, creating a new blank sheet in the existing workbook but with an _1 at the end, stopping after one export, exporting them all but all blank.</p>\n"},{"tags":["excel","vba","excel-vba","microsoft"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12867547,"title":"Count couple of Info from a bunch of csvs in excel","body":"<p>I've got hundreads of folders in links to them in a shared folder<br>\nEg:<br></p>\n\n<pre><code>a:\\Images\\abc\\year\\month\\date\\names1\na:\\Images\\abc\\year\\month\\date\\names2\na:\\Images\\abc\\year\\month\\date\\names3 etc,.\n</code></pre>\n\n<p>Each folder has a csv in it (<em><code>abc.csv</code></em> constant name in each folders) containing few info.</p>\n\n<p>Eg:<br></p>\n\n<pre><code>1 Orange USA\n2 Apple England\n3 Orange Australia\n4 Orange Austria\n5 Apple India\n</code></pre>\n\n<p>Here I would like to count the number of Oranges, Apples, Grapes and Melons in CSV of \nDifferent Folders.</p>\n\n<p>I'm expecting output like:<br></p>\n\n<pre><code>Link    Oranges Apples  Grapes  Melon\n\n\\names1 5846    2000    85215   586\n\n\\Names2 4521    1542    45852   125\n\n\\Names3 365     4856    25415   548\n</code></pre>\n\n<p>Kindly Help... </p>\n"},{"tags":["asp.net","excel","office-interop"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":453,"score":2,"question_id":1994686,"title":"Excel file generation on server without Excel installed","body":"<p>I am using <code>Microsoft.Office.Interop.Excel</code> and generating Excel files using the <code>SaveAs</code> method.  This all works correctly on  computer with Excel installed.  However, my server does not have Excel installed.</p>\n\n<p>How can I generate my files?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13059562,"title":"Validating groups of checkboxes and radio buttons using VBA","body":"<p>I have the following groups of check-boxes and radio groups and was wondering how I would validate them each separately in VBA. Can anybody point me in the right direction? </p>\n\n<p>For example I would require that at least checkbox is selected in the <strong>weeks</strong> group and each of the radio button groups (<strong>priority</strong>, <strong>lecturestyle</strong>, <strong>roomstruc</strong> and <strong>roomtype</strong>) just require a selection to be made. I would appreciate any code to show me how to accomplish this.</p>\n\n<p><strong>weeks</strong> - checkboxes</p>\n\n<blockquote>\n  <p>chk_week1, chk_week2, chk_week3, chk_week4, chk_week5,..., chk_week15</p>\n</blockquote>\n\n<p><strong>priority</strong> - radio buttons</p>\n\n<blockquote>\n  <p>priority_y, priority_n</p>\n</blockquote>\n\n<p><strong>lecturestyle</strong> - radio buttons</p>\n\n<blockquote>\n  <p>lecturestyle_trad, lecturestyle_sem</p>\n</blockquote>\n\n<p><strong>roomstruc</strong> - radio buttons</p>\n\n<blockquote>\n  <p>roomstruc_tiered, roomstruc_flat</p>\n</blockquote>\n\n<p><strong>roomtype</strong> - radio buttons</p>\n\n<blockquote>\n  <p>roomtype_lecture, roomtype_lab</p>\n</blockquote>\n"},{"tags":["arrays","excel","vba","multidimensional-array","excel-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":853,"score":2,"question_id":7466186,"title":"excel VBA (not VBScript) 101: How do I create and read a multidimensional array?","body":"<p>I'm using Excel 2010 and I have a macro that needs to load OData results into an in-memory array.  The only part I'm missing is how to actually create that array in Excel.</p>\n\n<blockquote>\n  <p>How do I create a multi-dimensional array (or an array of a class) in\n  Excel 2010?</p>\n</blockquote>\n\n<p>The only constraint I have is that anything I build must be self contained in the XLSX.  So that means dependencies on PowerPivot, addins, etc, are out.  I think that leaves me with just VBScript macros.</p>\n\n<p>I've searched MSDN, StackOverflow, and Google for hours and can't find a clear-cut example of how to do this.  </p>\n"},{"tags":["excel","excel-formula","worksheet-function"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13057032,"title":"Reference two cells","body":"<p>I have a schedule in excel which is organied vertically, I want to look up a date and an engineers name to return the place of install in a different work sheet horizontally.</p>\n\n<p>Can anyone help me?</p>\n"},{"tags":["excel","table","data","source","pivot"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":908,"score":0,"question_id":6220267,"title":"How can I \"Change Data Source\" for multiple pivot tables for multiple worksheets (or entire workbook) in Excel 2010?","body":"<p>How can I \"Change Data Source\" for multiple pivot tables for multiple worksheets (or entire workbook) in Excel 2010?</p>\n\n<p>I tried using this VB code but it's not changing the data source for the entire workbook? What do I have here that's wrong? Thank you.</p>\n\n<pre><code>Sub ChangePTDataSource()\n'===============================================================\n'Macro Changes the DataSource on all Pivot Tables in a Workbook\n'===============================================================\nDim pt As PivotTable\nDim ws As Worksheet\n\n ActiveWorkbook.Names.Add Name:=\"myData\", RefersToR1C1:=\"='Detail+'!R1C1:R20C20\"\n\n On Error Resume Next\nFor Each ws In ActiveWorkbook.Worksheets\n   On Error Resume Next\n   For Each pt In ws.PivotTables\n     '-----------------------------------------------------\n     'Changes DataSource Name to myData\n     '-----------------------------------------------------\n      pt.ChangePivotCache ActiveWorkbook. _\n        PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"''filename\", Version _\n        :=xlPivotTableVersion12)\n\n   Next pt\nNext ws\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13056081,"title":"VBA obtaining info from unopened workbook from shared drive","body":"<p>I'm curious about what the format of a code in VBA for...  </p>\n\n<p>obtaining specific rows from a specific sheet from a specific workbook within a specific subset of folders.  </p>\n\n<p>for example: Populating Sheet1 in Wkbk1 from the data in Sheet1 from Wkbk2 which is in a shared drive somewhere....</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT:  </p>\n\n<p>I realize this may be a vague post so I am going to try to explain in further detail.  </p>\n\n<p>I am looking for a code which allows me to do the following.  </p>\n\n<ul>\n<li>Enable a macro from WkBk 1 to pull data from WkBk 2.  </li>\n<li>WkBk 2 is located within a shared drive and is closed.  </li>\n<li>I want to pull specific data from WkBk 2 and populate that data into specific rows in WkBk 1.</li>\n</ul>\n"},{"tags":["python","excel","iterate","flags","xlrd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13055945,"title":"Alternative to using flags when iterating through objects in python","body":"<p>I have a script that compares values between two .xls sheets using xlrd. By default it lets me look for similarities, and writes them to a txt file. If I pass an in an argument, I can look for devices unique to each .xls, and write those to txt file. Right now, I iterate through the rows in each .xls, and mark a flag as True when it finds a similarity between the two files. It will only write hosts from the first sheet when the flag is marked False. Here is the bit of code with flags:</p>\n\n<pre><code>else:\n    for row1 in range(sheet1.nrows):\n        inboth = False\n        for row2 in range(sheet2.nrows):\n            if sheet2.row_values(row2)[0].split(\".\")[0] == sheet1.row_values(row1)[0].split(\".\")[0]:\n                inboth = True\n        if not inboth:\n            outfile.write(sheet1.row_values(row1)[0].split(\".\")[0] + \",File1\\n\")\n    for row2 in range(sheet2.nrows):\n        inboth = False\n        for row1 in range(sheet1.nrows):\n            if sheet1.row_values(row1)[0].split(\".\")[0] == sheet2.row_values(row2)[0].split(\".\")[0]:\n                inboth = True\n        if not inboth:\n            outfile.write(sheet2.row_values(row2)[0].split(\".\")[0] + \",File2\\n\")\n</code></pre>\n\n<p>Is there a more efficient way to do this without using the \"inboth\" flag? Is there a solution where I don't need to iterate through both sheets twice?</p>\n"},{"tags":["c#","excel","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":13055369,"title":"How to Save/Overwrite existing Excel file with Excel Interop - C#","body":"<p>Is there a way to save changes to an excel spreadsheet through the excel interop (in this case I am adding a worksheet to it) without having it prompt the user if they want to overwrite the existing file with the changes.  I do not want the user to even see the spreadsheet open in my application so having a message box popping up asking them if they want to overwrite the file seems very out of place and possibly confusing to the user.  </p>\n\n<p>I am using the workbook.SaveAs(fileloaction) method.  </p>\n\n<p>Here is where I am initializing the COM reference objects for the excel interop.</p>\n\n<pre><code>private Excel.Application app = null;\n    private Excel.Workbook workbook = null;\n\n    public Excel.Workbook Workbook\n    {\n        get { return workbook; }\n        set { workbook = value; }\n    }\n    private Excel.Worksheet worksheet = null;\n    private Excel.Range workSheet_range = null;\n</code></pre>\n\n<p>Below is the code I am using to close/save the excel file.  The workbook.close() method line is the one that is reportedly throwing the unhandled exception. </p>\n\n<pre><code> workbook.Close(true, startForm.excelFileLocation, Missing.Value);\n            Marshal.ReleaseComObject(app);\n            app = null;\n            System.GC.Collect();\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13055281,"title":"If-then statement in VBA","body":"<p>I'm currently writing two sets of if-else statements which are very similar. They basically compare three drop down menus and ensure that the user has not put down two matching preferences. For example:</p>\n\n<pre><code>cbo_fac1 - Kitchen    \ncbo_fac2 - Kitchen   \ncbo_fac3 - Lounge\n</code></pre>\n\n<p>This would return an error message because <strong>cbo_fac1</strong> and <strong>cbo_fac2</strong> match up. But there is a special case scenario I'm struggling to implement. One of the drop down cases is <em>No preference</em>.</p>\n\n<pre><code>cbo_fac1 - Kitchen    \ncbo_fac2 - No preference\ncbo_fac3 - No preference\n\ncbo_fac1 - No preference    \ncbo_fac2 - No preference\ncbo_fac3 - No preference\n</code></pre>\n\n<p>With any scenario <em>No preference</em> selection is allowed to match. How do I go about implementing this? Here is the code I'm using so far:</p>\n\n<pre><code>If cbo_fac1.Value = cbo_fac2.Value Then\n    MsgBox (\"Facilities preference 1 and facilities preference 2 cannot be the same. Please select another option for facilities preference 2, if you have none then select 'No preference'\")\n    Exit Sub\nEnd If\n\nIf cbo_fac1.Value = cbo_fac3.Value Then\n    MsgBox (\"Facilities preference 1 and facilities preference 3 cannot be the same. Please select another option for facilities preference 3, if you have none then select 'No preference'\")\n    Exit Sub\nEnd If\n\nIf cbo_fac2.Value = cbo_fac3.Value Then\n    MsgBox (\"Facilities preference 2 and facilities preference 3 cannot be the same. Please select another option for facilities preference 3, if you have none then select 'No preference'\")\n    Exit Sub\nEnd If\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","excel-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":119,"score":5,"question_id":13054960,"title":"VBA Macro across multiple worksheets","body":"<p>I am trying to run a single macro which performs functions on multiple worksheets. Let's say I have assigned the macro button on worksheet 4. I have listed the functions I want it to perform step by step:</p>\n\n<p>1) Select certain cells in worksheet 4 and copy to adjacent cells in worksheet 4.<br>\n2) delete range of cells in worksheet 3.<br>\n3) CUT range of cells in worksheet 2 then paste this range of cells into worksheet 3.<br>\n4) Take range of cells from a separate workbook and copy into worksheet 2. (I know this is an entirely different problem as the workbook is automatically published and I will have to find a way to link the two.)<br>\n5) Update pivot tables located within Worksheet 4 and Worksheet 3.  </p>\n\n<p>I would love help on the first 3 functions of this. I've pasted my current code below.</p>\n\n<pre><code>Sub START()\n\nDim sh1 As Worksheet\nDim sh2 As Worksheet\nDim sh3 As Worksheet\nDim sh4 As Worksheet\n\nSet sh1 = ActiveWorkbook.Sheets(\"Brand\")\nSet sh2 = ActiveWorkbook.Sheets(\"CurrentWeek\")\nSet sh3 = ActiveWorkbook.Sheets(\"PriorWeek\")\nSet sh4 = ActiveWorkbook.Sheets(\"Pivot\")\n\nsh4.Range(\"B29:B30\").Select\nSelection.Copy\n\nsh4.Range(\"C29\").Select\nActiveSheet.Paste\n\nsh3.Range(\"A4:AC1000\").Select\nSelection.Delete\n\nsh2.Range(\"A4:AC1000\").Select\nSelection.Copy\n\nsh3.Range(\"A4\").Select\nActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>It works... but it only works when I'm in the right worksheet to perform a specific function.</p>\n"},{"tags":["perl","excel","file","merge"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13050659,"title":"Perl How to merge two or more excel files in one (multiple worksheets)?","body":"<p>I need to merge a few excel file into one, multiple sheets. \nI do not care too much about the sheet name on the new file.</p>\n\n<p>I do not have Excel on the computer I plan to run this. so I cannot use Win32 OLE.\nI attempted to run this code <a href=\"https://sites.google.com/site/mergingxlsfiles/\" rel=\"nofollow\">https://sites.google.com/site/mergingxlsfiles/</a> but it is not working, I get a new empty excel file.</p>\n\n<p>I attempt to run <a href=\"http://www.perlmonks.org/?node_id=743574\" rel=\"nofollow\">http://www.perlmonks.org/?node_id=743574</a> but I only obtained one of the file in the new excel file.</p>\n\n<p>My input excel files have some french characters (é for e.g.) I believe these are cp1252. </p>\n\n<p>Code used : </p>\n\n<pre><code>    #!/usr/bin/perl -w\n    use strict;\n    use Spreadsheet::ParseExcel;\n    use Spreadsheet::WriteExcel;\n    use File::Glob qw(bsd_glob);\n    use Getopt::Long;\n    use POSIX qw(strftime);\n\n    GetOptions(\n        'output|o=s' =&gt; \\my $outfile,\n        'strftime|t' =&gt; \\my $do_strftime,\n    ) or die;\n\n    if ($do_strftime) {\n        $outfile = strftime $outfile, localtime;\n    };\n\n    my $output = Spreadsheet::WriteExcel-&gt;new($outfile)\n        or die \"Couldn't create '$outfile': $!\";\n\n    for (@ARGV) {\n        my ($filename,$sheetname,$targetname);\n        my @files;\n        if (m!^(.*\\.xls):(.*?)(?::([\\w ]+))$!) {\n            ($filename,$sheetname,$targetname) = ($1,qr($2),$3);\n            warn $filename;\n            if ($do_strftime) {\n                $filename = strftime $filename, localtime;\n            };\n            @files = glob $filename;\n        } else {\n            ($filename,$sheetname,$targetname) = ($_,qr(.*),undef);\n            if ($do_strftime) {\n                $filename = strftime $filename, localtime;\n            };\n            push @files, glob $filename;\n        };\n\n        for my $f (@files) {\n            my $excel = Spreadsheet::ParseExcel::Workbook-&gt;Parse($f);\n            foreach my $sheet (@{$excel-&gt;{Worksheet}}) {\n                if ($sheet-&gt;{Name} !~ /$sheetname/) {\n                    warn \"Skipping '\" . $sheet-&gt;{Name} . \"' (/$sheetname/)\";\n                    next;\n                };\n                $targetname ||= $sheet-&gt;{Name};\n                #warn sprintf \"Copying %s to %s\\n\", $sheet-&gt;{Name}, $targetname;\n\n                my $s = $output-&gt;add_worksheet($targetname);\n                $sheet-&gt;{MaxRow} ||= $sheet-&gt;{MinRow};\n                foreach my $row ($sheet-&gt;{MinRow} .. $sheet-&gt;{MaxRow}) {\n                    my @rowdata = map {\n                        $sheet-&gt;{Cells}-&gt;[$row]-&gt;[$_]-&gt;{Val};\n                    } $sheet-&gt;{MinCol} ..  $sheet-&gt;{MaxCol};\n                    $s-&gt;write($row,0,\\@rowdata);\n                }\n            }\n        };\n    };\n\n    $output-&gt;close;\n</code></pre>\n\n<p>I have 2 excel files named: 2.xls (only 1 sheet named 2 in it), 3.xls (only 1 sheet named 3) </p>\n\n<p>I launched the script as this:</p>\n\n<pre><code>xlsmerge.pl -s -o results-%Y%m%d.xls 2.xls:2 3.xls:3\n</code></pre>\n\n<p>Results: results-20121024.xls  empty nothing in it. </p>\n\n<p>Then I tried </p>\n\n<pre><code>xlsmerge.pl -s -o results-%Y%m%d.xls 2.xls 3.xls \n</code></pre>\n\n<p>And it worked. \nI am not sure why is it failing while adding the Sheetname</p>\n"},{"tags":["excel","c#-4.0","spreadsheetgear"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13054245,"title":"Reference another sheet in Formula string SpreadSheetGear","body":"<p>As the questions states, I'm trying to reference some cells from one sheet to another. In one sheet I have the Data to populate some other cells in my Principal sheet</p>\n\n<p>In short: DataSheet > Feeds > PrincipalSheet</p>\n\n<p>I'm trying something like:</p>\n\n<pre><code>\"=Data!$A$1\"\n</code></pre>\n\n<p>I've even tried something like:</p>\n\n<pre><code> \"=[Book1]Data!$A$1\"\n</code></pre>\n\n<p>But still, I can't find the correct code.</p>\n\n<p>I have SpreadSheetGeat 2010 and using C#</p>\n\n<p>Thanks in advance for the help you provide!!</p>\n"},{"tags":["excel","vba","drop-down-menu","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13050506,"title":"Nested dropdown list without named ranges","body":"<p>I'm a newbie, so your patience is appreciated. I have a long list of case numbers and associated names in one sheet, with several names per case number. At various places in the workbook, I want users to pick a case number from a dropdown list (can use dynamic named ranges), and then select one of the associated names in another dropdown. </p>\n\n<p>Because there are so many case numbers, and they change, I can't use a named range for the second dropdown. Is there a VBA way to do this?</p>\n"},{"tags":["actionscript-3","excel","air","as3xls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13052409,"title":"as3xls > Number of sheets always 0","body":"<p>I'm trying to parse a .xlsx file exported from a google docs. Right now I'm not trying to access it online, I'm manually downloading it and copying inside my application.</p>\n\n<p>I've read <a href=\"http://code.google.com/p/as3xls/wiki/Tutorial\" rel=\"nofollow\">the tutorial</a> provided online, and this is the code I have right now:</p>\n\n<pre><code> var contentBA:ByteArray = new ByteArray ();\n var fileToLoad:File = File.applicationDirectory.resolvePath(\"textLabels.xlsx\");        \n var stream:FileStream = new FileStream();\n stream.open(fileToLoad, FileMode.READ);\n stream.readBytes (contentBA, 0, contentBA.length);\n var xls:ExcelFile = new ExcelFile();\n xls.loadFromByteArray(contentBA); \n trace (\"N SHEETS \", xls.sheets.length);\n</code></pre>\n\n<p>but the number of sheets it's always 0. I tried to change the file and to load the most simple excel ever but it keeps saying 0.</p>\n\n<p>Is it a problem of the \".xlsx\" extension? Am I missing something?</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13049817,"title":"Copy unique list based on criteria in another column vba excel","body":"<p>I want to use VBA to extract a unique, ordered list, subject to conditions in another column. So, I have two columns A, B.</p>\n\n<pre><code>A    B\n========\na   FALSE\nb   FALSE\nc   TRUE\na   TRUE\nb   FALSE\nc   TRUE\n</code></pre>\n\n<p>Should result in a list</p>\n\n<pre><code>C\n==\na\nc\n</code></pre>\n\n<p>I'm very, very new to VBA, so any help would be appreciated. </p>\n\n<p>Oh, and the second list will be updated with every change to the first, so needs to be wiped to ensure there are no leftovers, if, for example, the second \"a\" is set to FALSE.</p>\n"},{"tags":["javascript","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":46,"score":-1,"question_id":13053573,"title":"Edit a web page (html file) with JavaScript code in Excel, and save it back as html file","body":"<p>I am working on an assignment where I need to edit an html file that has a huge table. In the html file, I added some javascript code to add some list boxes that get populated at run time, to filter data based on some columns. to run the script automatically, I added an onload function in body tag.</p>\n\n<p>The issue is, the person who edits the html file, does it in Excel, and then saves the file back as web page. Now, after adding Javascript code, when the file is edited in Excel and saved back as web page, the script disappears. Instead of saving as web page, I tried publish method, but got another issue. With publish, the script remains, but the list box do not function, and body tag's onload method disappears.</p>\n\n<p>So, how can I edit a web page with JavaScript code in Excel 2010, save it back as web page and have the script working? </p>\n\n<p>OR</p>\n\n<p>Another possibility is to have javascript embedded in html file when it is Saved as html page from Excel. Is there a way to use VBA to embed JS into Excel file so that when it is saved, the Javascript code to filter columns is available in html file? </p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13051941,"title":"Importing text files to Excel - lines from each file are placed in separate columns on same row","body":"<p>I found this code on this site but I haven't been able to adjust it for my own needs though I think it must be a very quick fix. </p>\n\n<p>The code imports a series of text files to excel. A file is opened and the first line of this file is placed in A1, the second line in A2 and so on. When a new file is opened, the text is placed in the next available cell in column A (all files are read into column A). </p>\n\n<p>I want to make a slight modification. I want the first line of file 1 in A1, the second line in B1 and so on (i.e. all the lines from File 1 are kept in Row 1). Then, the lines in File 2 are placed in Row 2, File 3 in Row 3 etc. </p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<pre><code>    Sub ReadFilesIntoActiveSheet()\n    Dim fso As FileSystemObject\n    Dim folder As folder\n    Dim file As file\n    Dim FileText As TextStream\n    Dim TextLine As String\n    Dim Items() As String\n    Dim i As Long\n    Dim cl As Range\n\n    ' Get a FileSystem object\n    Set fso = New FileSystemObject\n\n    ' get the directory you want\n    Set folder = fso.GetFolder(\"D:\\YourDirectory\\\")  \n\n    ' set the starting point to write the data to\n    Set cl = ActiveSheet.Cells(1, 1)\n\n    ' Loop thru all files in the folder\n    For Each file In folder.Files\n        ' Open the file\n        Set FileText = file.OpenAsTextStream(ForReading)\n\n        ' Read the file one line at a time\n        Do While Not FileText.AtEndOfStream\n            TextLine = FileText.ReadLine\n\n            ' Parse the line into | delimited pieces\n            Items = Split(TextLine, \"|\")\n\n            ' Put data on one row in active sheet\n            For i = 0 To UBound(Items)\n                cl.Offset(0, i).Value = Items(i)\n            Next\n\n            ' Move to next row\n            Set cl = cl.Offset(1, 0)\n        Loop\n\n        ' Clean up\n        FileText.Close\n    Next file\n\n    Set FileText = Nothing\n    Set file = Nothing\n    Set folder = Nothing\n    Set fso = Nothing\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","date","coldfusion","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":181,"score":0,"question_id":9402441,"title":"How can I format a column as a date using spreadsheetFormatColumn?","body":"<p>I'm using cfspreadsheet to generate an excel sheet of data. There are a couple of columns that are dates, and are displaying like this:</p>\n\n<pre><code>1988-09-19 00:00:00.0\n</code></pre>\n\n<p>I'd like to format them to display in m/d/yyyy format. I tried using spreadsheetFormatColumn:</p>\n\n<pre><code>&lt;cfset spreadsheetFormatColumn(s, {dataformat=\"m/d/yyyy\"}, 8) /&gt;\n</code></pre>\n\n<p>But it doesn't change anything. How can I format the column using coldfusion?</p>\n"},{"tags":["c#","excel","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":68,"score":-1,"question_id":13049819,"title":"Can't disconnect form Excel Introp after saving created Excel File - C#","body":"<p>I am trying to save an excel file that was created and written to via a C# application using the Excel Interop.  I have looked all over this site as others to find a code that properly works and I have yet to find one.  My excel interop funciton uses a workbook, worksheet, app, and workshee_range object.  Does anyone have any suggestions.  The easier the solution the better.  I'm a beginner to intermediate level C# programmer and an advanced solution will likely be out of my scope of knowledge.  The unhandled exception I am getting when trying to disconnect from the excel interop after saving and then closting the excel file says 'Object reference not set to an instance of an object.'</p>\n\n<p>here is the code I am using to do the aforementioned process:</p>\n\n<pre><code>            workbook.SaveAs(startForm.excelFileLocation);\n            workbook.Close();\n            app.Quit();\n            Marshal.ReleaseComObject(workSheet_range);\n            Marshal.ReleaseComObject(worksheet);\n            Marshal.ReleaseComObject(workbook);\n            Marshal.ReleaseComObject(app);\n            app = null;\n            workbook = null;\n            worksheet = null;\n            workSheet_range = null;\n</code></pre>\n\n<p>Here is the full bit of code:</p>\n\n<pre><code>     class CreateExcelDoc\n    {\n        string newFormString = trialReportForm.newFormString;\n       string fileString=trialReportForm.fileString;\n       int sheetCount;\n       string trialString = trialReportForm.trialString;\n       string dateString = trialReportForm.dateString;\n       string saveString = trialReportForm.saveSting;\n       System.Windows.Forms.Timer excelTimer = new System.Windows.Forms.Timer();\n        private Excel.Application app = null;\n        private Excel.Workbook workbook = null;\n        private Excel.Worksheet worksheet = null;\n        private Excel.Range workSheet_range = null;\n        public CreateExcelDoc()\n\n        {\n            createDoc();\n        }\n\n        public void createDoc()\n        {\n\n            try\n            {\n                app = new Excel.Application();\n                //app.Visible = false;\n                if (startForm.exportOwnerString == \"Yes\")\n                {\n                    app.Visible = true;\n                    startForm.exportOwnerString = \" \";\n                }\n                else\n                {\n                    app.Visible = false;\n                }\n                if (startForm.excelActionFlag==\"addNewTrialReport\")\n                {\n                    workbook = (Excel.Workbook) app.Workbooks.Add(1);\n                    //workbook.SaveAs(newFileForm.desktopPath + \"\\\\\" + \"OB \"+trialReportForm.otrClubNameString+\" - \"+trialReportForm.otrDateString);\n                    worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                    //fileNameString = newFileForm.desktopPath + \"\\\\OB \" + trialReportForm.otrClubNameString + \" \" + trialReportForm.otrDateString;\n                    workbook.Worksheets[1].Name = trialReportForm.trialReportDate+\" Trial \"+trialReportForm.trialReportTrialNumber;\n                }\n                else if (startForm.excelActionFlag == \"ownerContacts\")\n                {\n                    workbook = (Excel.Workbook)app.Workbooks.Add(1);\n                    worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                    workbook.Worksheets[1].Name = \"Owner Contacts\";\n                }\n                else if (startForm.excelActionFlag == \"newExcelResults\")\n                {\n                    string testFile = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\test\";\n                    workbook = (Excel.Workbook)app.Workbooks.Add(1);\n\n                    worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                    workbook.Worksheets[1].Name = \"Event 1 Results\";\n                    //workbook.SaveAs(testFile, Missing.Value, Missing.Value, Missing.Value, false);\n                    //workbook.SaveAs(Environment.GetFolderPath(Environment.SpecialFolder.Desktop)+\"\\\\Results\", Missing.Value, Missing.Value, Missing.Value, false);\n\n\n\n                    //workbook.SaveAs(startForm.excelFileLocation, Missing.Value, Missing.Value, Missing.Value, false);\n\n                    //fileNameString = registrationForm.regFileLocation + \"\\\\OB \" + registrationForm.regClubName + \" \" + registrationForm.regDateString;\n                }\n                else if (dogForm.dogRegistrationExcel == \"Yes\")\n                {\n                    workbook = (Excel.Workbook)app.Workbooks.Add(1);\n                    workbook.SaveAs(dogForm.filePath, Missing.Value, Missing.Value, Missing.Value, false);\n\n                }\n                else if (newFormString == \"No\")\n                {\n\n                    //workbook = app.Workbooks.Open(fileString, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                    // workbook.Close(true,fileString,Missing.Value);\n                    workbook = (Excel.Workbook)app.Workbooks.Open(fileString, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                }\n                if (newFormString==\"Yes\"&amp;registrationForm.formString==\"OTR\")\n                {\n                    //string sheetName = \"Trial Report - \" + dateString + \" \" + trialString;\n                worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                workbook.Worksheets[1].Name =trialReportForm.otrDateString+\" Trial \" + trialReportForm.otrTrialString;\n                //workbook.Worksheets[1].Name = \"Trial Report - \" + dateString + \" \" + trialString;\n                //workbook.Worksheets[1].Name = \"Hello\";\n                //Excel.Name name1 = worksheet.Names.Add(\"Trial Report - \" + dateString + \" \" + trialString, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                //worksheet.Name = \"Trial Report - \" + dateString + \" \" + trialString;\n\n\n                }\n                else if (newFormString == \"Yes\" &amp; registrationForm.formString == \"Registration\")\n                {\n                    //string sheetName = \"Trial Report - \" + dateString + \" \" + trialString;\n                    worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                    workbook.Worksheets[1].Name = \"Results: \"+registrationForm.selectedEvent;\n                    //workbook.Worksheets[1].Name = \"Trial Report - \" + dateString + \" \" + trialString;\n                    //workbook.Worksheets[1].Name = \"Hello\";\n                    //Excel.Name name1 = worksheet.Names.Add(\"Trial Report - \" + dateString + \" \" + trialString, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                    //worksheet.Name = \"Trial Report - \" + dateString + \" \" + trialString;\n\n\n                }\n                else if (startForm.excelActionFlag == \"addExistingTrialReport\")\n                {\n                    workbook = (Excel.Workbook)app.Workbooks.Open(startForm.excelFileLocation, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                   sheetCount = workbook.Worksheets.Count;\n                   int sheetCountPlusONe=sheetCount+1;\n                   worksheet = (Excel.Worksheet)workbook.Worksheets.Add(Missing.Value,workbook.Worksheets[sheetCount],Missing.Value,Missing.Value);\n                   workbook.Worksheets[sheetCountPlusONe].Name = trialReportForm.trialReportDate + \" Trial \" + trialReportForm.trialReportTrialNumber;\n\n                   //worksheet.Move(Missing.Value, workbook.Worksheets[sheetCount]);\n\n\n                }\n                else if (startForm.excelActionFlag == \"existingExcelResults\")\n                {\n\n                    workbook = (Excel.Workbook)app.Workbooks.Open(startForm.excelFileLocation, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                    sheetCount = workbook.Worksheets.Count;\n                    int sheetCountPlusONe = sheetCount + 1;\n                    worksheet = (Excel.Worksheet)workbook.Worksheets.Add(Missing.Value, workbook.Worksheets[sheetCount], Missing.Value, Missing.Value);\n                    workbook.Worksheets[sheetCountPlusONe].Name = \"Event \" + sheetCountPlusONe.ToString() + \" Results\";\n\n\n                    //worksheet.Move(Missing.Value, workbook.Worksheets[sheetCount]);\n\n\n                }\n                else if (dogForm.dogRegistrationExcel == \"Yes\")\n                {\n                    worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                    workbook.Worksheets[1].Name = dogForm.dogUKCNumber;\n                }\n            }\n            catch (Exception e)\n            {\n                Console.Write(\"Error\");\n            }\n             /* if (trialReportForm.saveMe==\"Yes\")\n                {\n                    workbook.Save();\n                    workbook.Close();\n                }\n            */\n\n\n        }\n\n\n        public void createHeaders(int row, int col, string htext, string cell1,\n        string cell2, int mergeColumns, string b, bool font, int size, string\n        fcolor)\n        {\n            worksheet.Cells[row, col] = htext;\n            workSheet_range = worksheet.get_Range(cell1, cell2);\n            workSheet_range.Merge(mergeColumns);\n            switch (b)\n            {\n                case \"BLUE\":\n                    workSheet_range.Interior.Color = System.Drawing.Color.Red.ToArgb();\n                    break;\n                case \"GAINSBORO\":\n                    workSheet_range.Interior.Color =\n            System.Drawing.Color.Gainsboro.ToArgb();\n                    break;\n                //case \"Turquoise\":\n                   // workSheet_range.Interior.Color =\n            //System.Drawing.Color.Turquoise.ToArgb();\n                    //break;\n                case \"PeachPuff\":\n                    workSheet_range.Interior.Color =\n            System.Drawing.Color.PeachPuff.ToArgb();\n                    break;\n                default:\n                    //  workSheet_range.Interior.Color = System.Drawing.Color..ToArgb();\n                    break;\n            }\n\n            //workSheet_range.Borders.Color = System.Drawing.Color.Black.ToArgb();\n            //workSheet_range.Borders = null;\n            workSheet_range.Font.Bold = font;\n            workSheet_range.ColumnWidth = size;\n            //workSheet_range.HorizontalAlignment = ContentAlignment.BottomCenter;\n            if (startForm.excelActionFlag == \"existingExcelResults\" | startForm.excelActionFlag==\"newExcelResults\")\n            {\n                workSheet_range.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;\n            }\n            //workSheet_range.Cells.HorizontalAlignment = ContentAlignment.MiddleCenter;\n            workSheet_range.Font.Color = System.Drawing.Color.FloralWhite.ToArgb();\n\n        }\n\n        public void addData(int row, int col, string data,\n            string cell1, string cell2, string format)\n        {\n            worksheet.Cells[row, col] = data;\n            workSheet_range = worksheet.get_Range(cell1, cell2);\n            //workSheet_range.Borders.Color = System.Drawing.Color.Black.ToArgb();\n            workSheet_range.NumberFormat = format;\n            workSheet_range.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;\n\n            excelTimer.Tick += new EventHandler(excelTimer_Tick);\n            excelTimer.Interval = 6000;\n            excelTimer.Start();\n        }\n        void excelTimer_Tick(object sender, EventArgs e)\n        {\n            if (startForm.excelActionFlag != \"ownerContacts\")\n            {\n                if (startForm.excelActionFlag == \"existingExcelResults\" | startForm.excelActionFlag == \"newExcelResults\")\n                {\n                   /* Excel.Range sortRange;\n                    sortRange = worksheet.get_Range(\"A14\", \"K32\");\n                    Excel.Range scoreColumn;\n                    scoreColumn = worksheet.get_Range(\"C14\", \"C32\");\n                    sortRange.Sort(scoreColumn, Excel.XlSortOrder.xlDescending);*/\n                    Excel.Range valueRange;\n                    Excel.Range placeRange;\n                    placeRange = worksheet.get_Range(\"A14\", \"A\" + (14 + (registrationForm.numberofCompetitors - 1)).ToString());\n                    valueRange = worksheet.get_Range(\"A14\", \"K\"+(14+(registrationForm.numberofCompetitors-1)).ToString());\n                    valueRange.Sort(valueRange.Columns[3, Type.Missing], Excel.XlSortOrder.xlDescending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);\n                    placeRange.Sort(placeRange.Columns[1, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal); \n                }\n                // workbook.Close(true, Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\Results.xls\", Missing.Value);\n/*\n                GC.Collect(); \n                GC.WaitForPendingFinalizers();\n                GC.Collect();\n                GC.WaitForPendingFinalizers(); \n                Marshal.FinalReleaseComObject(workSheet_range); \n                Marshal.FinalReleaseComObject(worksheet); \n                workbook.Close(Type.Missing, Type.Missing, Type.Missing); \n                Marshal.FinalReleaseComObject(workbook);\n                app.Quit();\n                Marshal.FinalReleaseComObject(app);\n\n                */\n                //workbook.Close(true, startForm.excelFileLocation, Missing.Value);\n                workbook.SaveAs(startForm.excelFileLocation);\n                workbook.Close();\n                //app.Application.Quit();\n                app.Quit();\n                Marshal.ReleaseComObject(workSheet_range);\n                Marshal.ReleaseComObject(worksheet);\n                Marshal.ReleaseComObject(workbook);\n                Marshal.ReleaseComObject(app);\n                app = null;\n                workbook = null;\n                worksheet = null;\n                workSheet_range = null;\n                //Application.Exit();\n\n                /* workSheet_range = null;\n                 worksheet = null;\n                 workbook = null;\n                 app = null;*/\n                //Thread.Sleep(5000);\n                // File.Move(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\Results.xls\", startForm.excelFileLocation);\n            }\n</code></pre>\n"},{"tags":["c#","excel","vba","excel-dna"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13040919,"title":"Can we pass a custom object from Excel to C# ExcelDNA?","body":"<p>I have an object:</p>\n\n<pre><code>public class Shampoo\n{\npublic string Name {get;set;}\npublic string Id {get;set;}\npublic string PriceRegion {get;set;}\n}\n</code></pre>\n\n<p>Can I pass this object to a method in C# via Excel DNA:</p>\n\n<p>C# method is:</p>\n\n<pre><code>public static string PassShampoo(Shampoo shampoo)\n{\n//Some Code...\n}\n</code></pre>\n\n<p>Is this possible from VBA to C# via Excel DNA?</p>\n"},{"tags":["php","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13048803,"title":"PHP Excel Reader 2 read can't read column if not filled","body":"<p>I've got an excel file like this: <a href=\"http://imageshack.us/a/img16/7893/excelsample.png\" rel=\"nofollow\">Excel example</a></p>\n\n<p>I want to read the columns F, G ,H ,J when I do:</p>\n\n<blockquote>\n<pre><code>              for ($i = 3; $i &lt;= $data-&gt;sheets[0]['numRows']; $i++) {\n                error_log(\n                    FW_Class_Voucher_Code::cleanCode($data-&gt;sheets[0]['cells'][$i][6]).' - '.\n                    FW_Class_Voucher_Code::cleanCode($data-&gt;sheets[0]['cells'][$i][7]).' - '.\n                    FW_Class_Voucher_Code::cleanCode($data-&gt;sheets[0]['cells'][$i][8]).' - '.\n                    FW_Class_Voucher_Code::cleanCode($data-&gt;sheets[0]['cells'][$i][9]));\n                $count++;\n                }\n</code></pre>\n</blockquote>\n\n<p>I have the problem that I get errors:</p>\n\n<blockquote>\n  <p>PHP Notice:  Undefined offset: 7  PHP Notice:  Undefined offset: 8 \n  PHP Notice:  Undefined offset: 9</p>\n</blockquote>\n\n<p>the F column is always full, but as you can see I've got problems with the others. How can I escape this error, so the field only gets checked if it's filled with data?</p>\n"},{"tags":["c#","excel","excel-2007","worksheet-function","excel-interop"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":590,"score":1,"question_id":7559679,"title":"Sorting excel sheet in reverse order on basis of created time / reversing the excel sheet","body":"<p>I'm using  Microsoft interop excel to automate the excel workboook\nin which i have many worksheets(say 40) which have been created at in seconds gap or even less\nnow i have to present the worksheet in reverse order i.e the sheet which was created first should come first while opening(currently it comes last) in short I have to sort the excel sheet in reverse order or by time of creation</p>\n\n<p>any help in this matter</p>\n\n<p>thnx</p>\n"},{"tags":["asp.net","database","excel","search","information"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13049155,"title":"Excel Sorting Data Formulas & Clearing Empty (novalue) cells","body":"<p><strong>IMAGE OF MY EXCEL, COULD NOT POST IT BECAUSE I AM NEW MEMBER</strong>\n<a href=\"http://s16.postimage.org/dhu9pidol/stackoverflow.png\" rel=\"nofollow\">http://s16.postimage.org/dhu9pidol/stackoverflow.png</a></p>\n\n<p>I have tons of information similar to the example provided in the image, sometimes certain areas are missing, but <strong>distance</strong> and <strong>em:</strong> are always there and I have used them in my <strong>if search command within excel</strong> </p>\n\n<p>RED TEXT :  =IF(ISERROR(SEARCH(\"<em>distance</em>\",A408,1)),\"\",A410)</p>\n\n<p>BLUE TEXT: =IF(ISERROR(SEARCH(\"<em>Em:</em>\",A420,1)),\"\",A420)</p>\n\n<p>The values I want are returned, but I press F5, and select blank cells to delete them and have my values stack up in rows, will not do anything, even if I paste special as values, selecting blank cells seems to be impossible. All I want is my values of the <strong>name</strong> and the <strong>email</strong> to be stacked one on top of the other without all these empty spaces, and do not wanna do it manually. The data varies, sometimes missing one field, so copying every nth row would also not work. </p>\n\n<p>Thanks</p>\n"},{"tags":["excel","macros","row","clear","column"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":29,"score":1,"question_id":13046484,"title":"In Excel macro Clear column and row","body":"<p>Need a macro to Clear column from A to J and row from 21 to 200. Below code is clearing the column till end, need to delete till column J</p>\n\n<pre><code>Function ClearSummary()\n\n\nConst TestName_Col = \"B\"   \nConst FirstRow_Num = \"21\"   \n\n    MaxRowNumber = Range(TestName_Col &amp; \"200\").End(xlUp).Row\n\n    If (MaxRowNumber &gt; FirstRow_Num) Then\n        'select all rows in range &amp; clear\n        CellReference = FirstRow_Num &amp; \":\" &amp; MaxRowNumber\n        Rows(CellReference).Select\n        Selection.ClearContents\n        Selection.Hyperlinks.Delete\n        Selection.Font.Underline = xlUnderlineStyleNone\n        Selection.Font.ColorIndex = 0\n    End If\nEnd Function\n</code></pre>\n"},{"tags":["c#","excel","comexception"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":60,"score":5,"question_id":12977353,"title":"Resizing Comments in Excel using ShapeRange","body":"<p>I have a spreadsheet that is created programatically with a lot of comments in it(up to 40,000). The comments get resized after deleting several columns from the worksheet. This is apparently a bug in excel. ( <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2007-excel/excel-comment-boxes-resizing-themselves-andor/3fdf3e72-6ca5-4186-a656-b7b6fd8db781?msgId=d55534a5-4603-482e-ac97-9ec260124f78\">http://answers.microsoft.com/en-us/office/forum/office_2007-excel/excel-comment-boxes-resizing-themselves-andor/3fdf3e72-6ca5-4186-a656-b7b6fd8db781?msgId=d55534a5-4603-482e-ac97-9ec260124f78</a> )</p>\n\n<p>Ideally I would like to AutoSize all the comments at once after deleting the columns. </p>\n\n<p>Attempting to avoid looping through each individual comment, here's what I've tried so far. </p>\n\n<ul>\n<li>Setting AutoShapeDefaults has no effect - the comments still get resized after deleting the columns.</li>\n<li>XlPlacement property. XlMove and XLMoveAndSize have no effect.</li>\n<li>Worksheet.Shapes.SelectAll throws an OutOfMemory Exception no matter the amount of comments</li>\n</ul>\n\n<p>My thought is to get a ShapeRange object of all the comments in the spreadsheet and set the size from there. </p>\n\n<p>This works perfectly:</p>\n\n<pre><code>        public static void ResizeComments()\n        {\n        Microsoft.Office.Interop.Excel.Workbook objWorkbook;\n        objWorkbook = (Workbook)Globals.ThisAddIn.Application.ActiveWorkbook;\n        Worksheet objSheet = (Worksheet)objWorkbook.ActiveSheet;\n\n        int[] test = {1,2,3,4,5};\n        ShapeRange sRange = objSheet.Shapes.Range[test];\n        sRange.Height = 100;\n        sRange.Width = 220;\n        }\n</code></pre>\n\n<p>Changing to this throws an exception \"Exception from HRESULT: 0x800A03EC\" at the AutoSize line.</p>\n\n<pre><code>        ShapeRange sRange = objSheet.Shapes.Range[test];\n        sRange.TextFrame.AutoSize = true;\n</code></pre>\n\n<p>Using my actual array of Shape Indices throws the same exception but at <strong>Shapes.Range[]</strong>.\nI've looked at the <strong>shapes</strong> variable while debugging and it's identical to <strong>test</strong> except it's <strong>int[249]</strong> instead of <strong>int[5]</strong>; </p>\n\n<pre><code>        int[] shapes = (int[])shapes.ToArray(typeof(int)); \n        ShapeRange sRange = objSheet.Shapes.Range[shapes];\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13045962,"title":"Delete rows that not contain string in my array","body":"<p>Pls help me modify this code but I would like to keep it 90% the same.</p>\n\n<p>I want to delete the rows that does not contain the array items. So my program deletes rows with a, b in cell. How can I modify the below code so that it erases the other a, b to remain in exec.</p>\n\n<pre><code>myArr = Array(\"a\",\"b\")\nFor I = LBound(myArr) To UBound(myArr)\n\n    'Sheet with the data, you can also use Sheets(\"MySheet\")\n    With ActiveSheet\n\n        'Firstly, remove the AutoFilter\n        .AutoFilterMode = False\n\n        'Apply the filter\n        .Range(\"E1:E\" &amp; .Rows.Count).AutoFilter Field:=1, Criteria1:=myArr(I)\n\n        Set rng = Nothing\n        With .AutoFilter.Range\n            On Error Resume Next\n            Set rng = .Offset(1, 0).Resize(.Rows.Count - 1, 1) _\n                      .SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n            If Not rng Is Nothing Then rng.EntireRow.Delete\n        End With\n\n        'Remove the AutoFilter\n        .AutoFilterMode = False\n    End With\nNext I\n</code></pre>\n"},{"tags":["excel","monotouch"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":11306741,"title":"Parsing Excel files in monotouch","body":"<p>Are there any good ways of parsing Excel files in monotouch? Seems like most methods to work with Excel is based on using the Excel Object Library. Doesn't seem like that's even an option in monotouch? I read that objective-c doesn't have any native support for Excel-files, so don't know if that would change anything?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":117,"score":4,"question_id":13044473,"title":"Difference between CreateObject(\"Excel.Application\") .Workbooks.Open and just Workbooks.Open","body":"<p>I am currently using <code>Workbooks.Open</code> to process a large number of files contained in a directory. But opening and closing these files make the files appear in the task bar and I wanted to avoid the constant flickering. </p>\n\n<p>I got a suggestion from that I can use <code>CreateObject</code> to create a new instance since that opens a new Excel instance which is hidden. </p>\n\n<ol>\n<li><p>Is there any other difference between the two ways of opening new workbooks in terms of performance? </p></li>\n<li><p>Also, should I just use one instance of Excel created using <code>CreateObject</code> to open all Workbooks or do I need to create one instance for each workbook I have to process (<em>which seems like a waste of lot of memory and less speed</em>)? </p></li>\n</ol>\n"},{"tags":["vb.net","excel","vba","macros","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13046645,"title":"VBA - \"does not contain\"-filter (excel 2010)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7662659/combine-multiple-exclusion-criteria-in-autofilter\">Combine multiple exclusion (&lt;&gt;) criteria in AutoFilter</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to set up a filter with multiple 'Does not containt' values. I seem to get an error doh every time I try to run it. I've looked up this error and it means that excel didn't find any value's. When I try to run the same code, only with one value, it works fine. Any help/suggestions?</p>\n\n<p>Code with multiple values:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$J$218\").AutoFilter Field:=5, Criteria1:=Array(\"&lt;&gt;*a*\", \"&lt;&gt;*b*\", \"&lt;&gt;*c*\"), Operator:=xlFilterValues\n</code></pre>\n\n<p>Code with only one value: </p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$J$218\").AutoFilter Field:=5, Criteria1:=\"&lt;&gt;*a*\", Operator:=xlFilterValues\n</code></pre>\n\n<p>Greetz\nBulki</p>\n"},{"tags":["c#","excel","vba","math"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13046328,"title":"Excel Function called from C# running slowly","body":"<p>I have a method <code>CalculateLinearRegression()</code> that calls the <code>LinEst</code> function of an <code>Excel.Application.WorksheetFunction</code> class. <code>LinEst</code> is called roughly 3,500 times each time <code>CalculateLinearRegression()</code> is called. I inject the WorksheetFunction class into my method so I know that only one instance of the class gets created.</p>\n\n<p>Each call of <code>CalculateLinearRegression()</code> takes around 10 minutes and I am certain it is the <code>LinEst</code> function that is slowing everthing down (removing the call to <code>LinEst</code> and hard coding the results means the method to run in a couple of seconds).</p>\n\n<p>I appreciate that <code>LinEst</code> is doing a fair bit of computation, but I doubt it's doing so much as to cause this delay, therefore I think it is probably the call to the Excel function that is adding on the lag. Does anyone know of either a way of speeding this up, or a C# direct replacement for the <code>LinEst</code> function?</p>\n"},{"tags":["c#","excel","oledb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":799,"score":-1,"question_id":7419367,"title":"C# problem read text from excel","body":"<p>I tried to read an Excel file using OLEDB.\nI can read the integers correctly, but the problem occurs when I want to read text.</p>\n\n<p>I also tried IMEX=1 but it didn't work!</p>\n\n<p>Here is my sample code:</p>\n\n<pre><code>connectionString = String.Format(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + file + \";Extended Properties='Excel 8.0;IMEX=1;HDR=Yes'\");\n\nadapter = new OleDbDataAdapter(\"SELECT * FROM [\" + sheet + \"$]\", connectionString);\n\nDataSet data= new DataSet();\nadapter.Fill(data);\n</code></pre>\n"},{"tags":["excel","excel-2007","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":704,"score":0,"question_id":5008763,"title":"Date Range Using Advance Filter in Excel","body":"<p>I currently am using an advanced filter to pull data from a master list. I only have 1 column for the date in the master list. What I want to do is be able to enter a date range (1/1/11 - 1/31/11) and have the filter only pull the month of january out of all of the data. Is this possible to do when I only have one column to type in my filter arguments?<br>\nB</p>\n"},{"tags":["excel","word"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13043568,"title":"Conditional Word Document Auto Generation from an Excel Spreadsheet?","body":"<p>I'm on a quest of sorts, trying to determine how, if at all, I can do the following: I want Word to take in data from a spreadsheet (Excel) and check each cell for its value. If its value is a specific one, then Word presents (prints, puts in, whatever you care to call it) a corresponding paragraph. </p>\n\n<p>I've been Googling for hours, to no avail. As far as I can tell, what I need is a backwards, conditional Mail Merge for word; some program that can generate a paragraph from essentially a boolean value.</p>\n\n<p>Your assistance is appreciated, much obliged, et cetera.</p>\n\n<p>DA.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13040694,"title":"Excel - Display ComboBox DropDown by VBA","body":"<p>I need a workbook to display the Combobox List Dropdown when it opens.</p>\n\n<p>The combobox in the Workbook is a form control, so a shape.</p>\n\n<p>Cant seem to find the associated property.</p>\n"},{"tags":["excel","vba","excel-vba","excel-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13031495,"title":"Browsing Main excel file and Save As directory path with use of Excel VBA","body":"<p>I have below Excel procedure I gather up and I am using it for couple of different calculations under different workbooks. So I was thinking instead changing the procedure for main and outcome files each time, I should be able to pick the file I want to carry out calculations in and the file path for outcomes files. </p>\n\n<p>But I could not find anything for saving directory, I appreciate if you could help</p>\n\n<pre><code>Sub AsBuiltForm()\n\nDim SaveName As String\nDim mainBook As Workbook\n\na = InputBox(\"ENTER FIRST NUMBER \")\nb = InputBox(\"ENTER LAST NUMBER \")\n\nWorkbooks.Open Filename:=\"C:\\\"  'main file can be browsed? \n\nSet mainBook = Excel.Workbooks(\"CP.xlsx\")\n\n    For i = a - 1 To b - 1\n\n        mainBook.Sheets(1).Range(\"bi1\") = i + 1\n        SaveName = Sheets(1).Range(\"bi1\").value &amp; \".xlsx\"\n\n        mainBook.SaveCopyAs \"C:\\\" &amp; SaveName 'save directory?\n        Workbooks.Open Filename:=\"C:\\\" &amp; SaveName 'save directory?\n\n        With Excel.ActiveWorkbook\n            .Sheets(\"1 of 2\").Range(\"A1:CT103\").value = Sheets(\"1 of 2\").Range(\"A1:CT103\").value\n            .Sheets(\"2 of 2\").Range(\"A1:CT103\").value = Sheets(\"2 of 2\").Range(\"A1:CT103\").value\n            Excel.Application.DisplayAlerts = False\n            .Sheets(\"Sheet1\").Delete\n            .Sheets(\"il oufall\").Delete\n\n            .Sheets(\"1 of 2\").Select\n            Columns(\"Bh:BZ\").Select\n            Selection.Delete Shift:=xlToLeft\n\n            .Sheets(\"2 of 2\").Select\n            Columns(\"Bn:BZ\").Select\n            Selection.Delete Shift:=xlToLeft\n\n            .Close True\n\n        End With\n\n    Next\n\nmainBook.Close False\nSet mainBook = Nothing\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1123,"score":0,"question_id":10586984,"title":"Search a specific word and copy line to another Sheet","body":"<p>I have a spreadsheet that consists of columns from A-P and lines 1 to 2016 (and still growing).  I am looking for an easy way to search the spreadsheet for a specific word, for example \"Gap\", and have the lines that contain the word \"gap\" copied to Sheet2. I would like if it could use a box where I put the word in, so I can search for different things as needed. </p>\n\n<p>I don't expect the spreadsheet to get any smaller (this is an action item list, I need it to search until it reaches a blank line).</p>\n\n<p>How can I do this?</p>\n"},{"tags":["excel","excel-vba","excel-2007"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13042600,"title":"Vba Listobject Auto Filter unique items","body":"<p>I am an excel newbie and for a project, I am trying to create a userform through which the user will make a series of selections to get the result.</p>\n\n<p>For example, I have a table like the following.</p>\n\n<pre>\nType  | Color   | Item\n---------------------\nFruit | Yellow | Mango \nFruit | Red    | Apple\nVeggie| Green  | Broccoli \n</pre>\n\n<p>I want the user to select from combo box, first the type and then the color to determine the item. </p>\n\n<p>I am using list object filter to populate the combo box. I am able make a selection, for example Fruit from combo box 1. And Yellow from cobo box 2 to get Mango as the result. But, the problem I am running into is that my combo box has duplicate entires. </p>\n\n<p>My questions are:\n1. Is there a way through the tables, I will be able to just get the unique items to populate the combo box. Or, \n2. Is there a neat little trick to get rid of the duplicates in the combo box? </p>\n"},{"tags":["python","excel","email","ssl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":176,"score":0,"question_id":2846294,"title":"Emailing an excel sheet with SSL in Python","body":"<p>this is my first post so let me know if there are any common courtesies I should know about.</p>\n\n<p>I just started programming 8 months ago, so I am fairly new.  I have been doing some projects to get better.  A project I'm working on now creates an Excel sheet from inputted data. It's in Python, which I just started learning a couple of weeks ago. I'm attempting to embed part of this Excel sheet into an email, sent from my school address.  I have spent hours looking this up, and to no avail.</p>\n\n<p>There are two problems I am asking for help with:</p>\n\n<p>1)  The following code works for sending email from GMail, but not my school account.  Unfortunately, I have been having a problem setting up outgoing email for this account on my iPhone as well. It may be related? Would anyone have idea why this code doesn't work?</p>\n\n<pre><code>import smtplib\nfrom email.MIMEText import MIMEText\n\nLOGIN = 'myemailaddress'\nPASSWORD = 'mypassword'\n\n\ndef send_email(subject, message, from_addr=LOGIN, to_addr=LOGIN):\n    msg = MIMEText(message)\n    msg['Subject'] = subject\n    msg['From'] = from_addr\n    msg['To'] = to_addr\n\n    server = smtplib.SMTP('myhost',465)\n    server.ehlo()\n    server.starttls()\n    server.ehlo()\n    server.login(LOGIN,PASSWORD)\n    server.sendmail(from_addr, to_addr, msg.as_string())\n    server.close()\n\n\nif __name__==\"__main__\":\n    send_email('test', 'This is a test email', \"myemailaddress\", \"myemailaddress\")\n</code></pre>\n\n<p>2) Excel has an option of saving a sheet as a HTML. When doing so, I copy and pasted the HTML source and emailed it as an attachment. Unfortunately, the colored text did not transfer over. Does anyone know of a better way of using Python to send an excel sheet embedded in an email?</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["c#",".net","excel","unit-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":13037362,"title":"Read Rows in Excel File using c#","body":"<p>I have  added an Excel file to provide unit test values. </p>\n\n<p>Below is a example about what I was doing before  </p>\n\n<pre><code>public void test1()\n{\n    try\n    {\n        var Service = new Service.ServiceClient();\n        var Cid = testContextInstance.DataRow[\"CId\"].ToString();\n        var MNumber = testContextInstance.DataRow[\"MNumber\"].ToString();\n        var VID = testContextInstance.DataRow[\"VID\"].ToString();\n        var isVisit = new Service.ISVisit()\n        {\n        };\n\n    var first = Service.Medis(isVisit).Cast&lt;Service.ISMedi&gt;().FirstOrDefault();\n    // Assert\n    Assert.AreEqual(\"12345678\", first.Proc.ProcID);\n    }\n</code></pre>\n\n<p>.i am using excel sheet to provide values for the untitest.</p>\n\n<p><img src=\"http://i.stack.imgur.com/9MPVE.png\" alt=\"enter image description here\"></p>\n\n<p>By using the sample code above i am able to loop through each row in the excel and set values to the variables.But the Requirement is not to attach excel as a Data Driven Source and not to use Oledb way to query things in Excel.They said me to use Microsoft.Office.Interop.Excel; .</p>\n\n<p>Can any one help me with how to change the code to retrive the data in excel , row by row and assign cells to respective variables using  different approach.??? This is a c# Unittest framework</p>\n"},{"tags":["excel","vba","outlook"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3606,"score":2,"question_id":2512351,"title":"Pasting formatted Excel range into Outlook message","body":"<p>I am using Office 2007 and I would like to use VBA to paste a range of formatted Excel cells into an Outlook message and then mail the message.  In the following code (that I lifted from various sources), it runs without error and then sends an empty message... the paste does not work.</p>\n\n<p>Can anyone see the problem and better yet, help with a solution?</p>\n\n<p>Thanks,\n-Steph</p>\n\n<pre><code>Sub SendMessage(SubjectText As String, Importance As OlImportance)\nDim objOutlook As Outlook.Application\nDim objOutlookMsg As Outlook.MailItem\nDim objOutlookRecip As Outlook.Recipient\nDim objOutlookAttach As Outlook.Attachment\nDim iAddr As Integer, Col As Integer, SendLink As Boolean\n'Dim Doc As Word.Document, wdRn As Word.Range\nDim Doc As Object, wdRn As Object\n\n' Create the Outlook session.\nSet objOutlook = CreateObject(\"Outlook.Application\")\n' Create the message.\nSet objOutlookMsg = objOutlook.CreateItem(olMailItem)\n\nSet Doc = objOutlookMsg.GetInspector.WordEditor\n'Set Doc = objOutlookMsg.ActiveInspector.WordEditor\nSet wdRn = Doc.Range\nwdRn.Paste\n\nSet objOutlookRecip = objOutlookMsg.Recipients.Add(\"MyAddress@MyDomain.com\")\nobjOutlookRecip.Type = 1\nobjOutlookMsg.Subject = SubjectText\nobjOutlookMsg.Importance = Importance\n\nWith objOutlookMsg\n    For Each objOutlookRecip In .Recipients\n        objOutlookRecip.Resolve\n        ' Set the Subject, Body, and Importance of the message.\n        '.Subject = \"Coverage Requests\"\n        'objDrafts.GetFromClipboard\n    Next\n    .Send\nEnd With\nSet objOutlookMsg = Nothing\nSet objOutlook = Nothing\nEnd Sub\n</code></pre>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":26,"score":-3,"question_id":13041349,"title":"find a value from table for multiple argument in excel","body":"<pre><code>Taper Angle         Fw      \n</code></pre>\n\n<p>phi     25  30  35  40\n    0.1 1.1 1.25    1.3 1.5\n    0.2 1.15     2  2.4 2.5 \n    0.3 1.3 1.4 1.8 1.9\n    0.4 1.5 1.6 1.9 1.96\n    0.5 1.7 2.2 2.5 3.9\n    0.6 1.8 1.98    2   2.4\n    0.7 2   2.5 2.7 2.9\n    0.8 2.2 3   3.3 3.7\n    0.9 2.4 2.8 2.9 2.97\n    1   2.8 3.5 4.4 4\n    1.1 1.2 1.3 1.4 1.7\n    1.2 1.5 1.7 1.8 1.9\n    1.3 1.4 1.5 1.6 1.7\n    1.4 1.5 1.56    1.6 1.7\n    1.5 4   4.3 4.4 4\n    1.6 1.8 1.33    .4  1.6\n    1.7 3   4   2   3\n    1.8 2   2   3   4\n    1.9 2   4   5   6\n    2   4.9 4.4 4.4 4</p>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":54871,"score":5,"question_id":534062,"title":"Excel: How do I take the first character of 1 cell and prepend it to another cell and place it in a 3rd cell?","body":"<p>I have first names in one column and second names in another, I want to create a third column that contains the first character from the first name and add it to the surname creating first initial + surname.</p>\n\n<p>John &amp; Smith = jsmith</p>\n\n<p>How can I do this using Excel?</p>\n\n<p>Thanks all</p>\n"},{"tags":["excel","excel-formula","worksheet-function"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13035303,"title":"Extracting Data Between two Characters in Excel","body":"<p>I have the following format in Excel and I am trying to extract the data between the characters:</p>\n\n<pre><code>First Last &lt;flastname@xxxx.com&gt;\n</code></pre>\n\n<p>I need to extract the email address between &lt; and > into its own cell</p>\n\n<p>Thanks!</p>\n"},{"tags":["excel","macros"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1250,"score":1,"question_id":3399823,"title":"excel: how do i sort within a cell?","body":"<p>i have a string separated by commas, is it possible to use an excel formula to sort within the values within the cell? </p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":13019981,"title":"Workbooks.Open returns different file than Filename","body":"<p>I am having the strangest problem. I was writing the below code on my laptop the other day and it worked fine. Now, I am testing it on my desktop and it's stopped working.</p>\n\n<p>First, here's my code</p>\n\n<pre><code>Dim oApp As Application\nDim oWb As Workbook\n\nSet oApp = New Application\noApp.Visible = True\nSet oWb = oApp.Workbooks.Open(Filename:=\"C:\\myFile.xlsx\", ReadOnly:=True)\n\ndebug.print oWb.name\n'returns \"SOLVER.XLAM\"\n' \"SOLVER.XLAM\" is not \"myFile.xlsx'\n\ndebug.print oApp.Workbooks.Count\n'returns 1\n\ndebug.print oApp.Workbooks(1).name\n'returns \"myFile.xlsx\"\n</code></pre>\n\n<p>Now, I know that solver is an add in, and it gets loaded in the new application upon creating it... but how does it perform this switcheroo? I can still get to the correct file, but I don't want to risk it on the coincidence that there is only 1 file in my Application object (or that the first file is the one I loaded)</p>\n\n<h3>Additional Info</h3>\n\n<p>I am calling executing this macro from within an excel instance and I wish to open a separate excel instance and then open particular workbook (<code>\"C:\\myFile.xlsx\"</code>) inside that other instance. </p>\n\n<p>The key problem I'm having is that when I open the other instance and then add the workbook and set it to my oWb variable... somehow, when I later call that oWb variable it refers to something different from what I had set it to.</p>\n\n<pre><code>'This is how it makes me feel:\nDim x As Integer\nx = 5\n\nDebug.Print x\n' 12\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13039437,"title":"loop through cells in named range","body":"<p>I am trying to write code that will loop through all cells in a range.  Eventually I want to do something more complicated, but since I was having trouble I decided to create some short test programs.  The first example works fine but the second (with a named range) doesn't (gives a \"Method Range of Object_Global Failed\" error message).  Any ideas as to what I'm doing wrong?  I'd really like to do this with a named range... Thanks!</p>\n\n<p>Works:</p>\n\n<pre><code>Sub foreachtest()\nDim c As Range\nFor Each c In Range(\"A1:A3\")\n    MsgBox (c.Address)\nNext\nEnd Sub\n</code></pre>\n\n<p>Doesn't work:</p>\n\n<pre><code>Sub foreachtest2()\nDim c As Range    \nDim Rng As Range\nSet Rng = Range(\"A1:A3\")\nFor Each c In Range(\"Rng\")\n    MsgBox (c.Address)\nNext\nEnd Sub\n</code></pre>\n"},{"tags":["vb.net","excel","automation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13038562,"title":"Excel not properly displaying an array","body":"<p>Excel seems to display the first element of an array over and over in a column with the following code</p>\n\n<pre><code>      Dim fileNum() As String = {\"1\", \"2\"}\n    xlSourceRange = xlWorkSheet.Range(\"N2:N\" &amp; fileNum.Length + 1)\n    xlSourceRange.Value2 = fileNum\n</code></pre>\n\n<p>The entire range just fills up with 1. How can I make it so each element in the array is displayed in the column without having to manually assign each cell in a loop. I'm using the Microsoft.Office.Interlop.Excel if that matters.</p>\n"},{"tags":["excel","f#","vsto","office-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":13039153,"title":"F# Excel UsedRange has no Properties or Methods","body":"<p>This is a continuation of the discussion begun on <a href=\"http://stackoverflow.com/questions/12956517/f-excel-usedrange-is-not-defined/12957422#12957422\">F# Excel UsedRange is not Defined</a>, which has been solved by down-casting the ActiveSheet object to a Worksheet. Upon doing that, however, I was presented with a new problem: UsedRange exposes no properties or methods other than the standard object methods.</p>\n\n<p>My solution has references to Microsoft.Office.Interop.Excel and Microsoft.Office.Tools.Excel.v4.0.Utilities.</p>\n\n<pre><code>open Microsoft.Office.Interop.Excel\nopen Microsoft.Office.Tools.Excel\n\nlet xl = ApplicationClass()\nxl.Workbooks.OpenText(fileName)\nlet wb = xl.Workbooks.Item(1)\nlet ws = wb.ActiveSheet :?&gt; Worksheet\n\nws.UsedRange.EntireColumn.AutoFit()\n// \"The field, constructor or member 'EntireColumn' is not defined\".\n\nws.UsedRange.Sort(xl.Range(sortKey1), XlSortOrder.xlAscending)\n// \"The field, constructor or member 'Sort' is not defined\".\n\nxl.Range(\"A2\").Value &lt;- 1\nxl.Range(\"A2\").AutoFill(xl.Range(\"A2:A\" + ws.UsedRange.Rows.Count),\n                        XlAutoFillType.xlFillSeries) |&gt; ignore\n// \"The field, constructor or member 'Rows' is not defined\".\n\nws.UsedRange.\n// Intellisense shows only default object members, e.g. Equals, GetEnumerator, etc.\n</code></pre>\n\n<p>I can use Range with no problem:</p>\n\n<pre><code>xl.Range(\"A1\").EntireColumn.Insert() |&gt; ignore\n</code></pre>\n\n<p>UsedRange is recognized as a Range. Down-casting to Range, Visual Studio warns me: \"This type test or downcast will always hold\".</p>\n\n<p>Range works.\nUsedRange is recognized as Range.\nTherefore, UsedRange should work.\nBut it doesn't. I'm left with contradiction.</p>\n\n<p>Visual Studio 2010 Premium, F# 2.0.</p>\n\n<p>I appreciate any insight offered. Thanks.</p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12898341,"title":"Selective mail message merge","body":"<p>I'm trying to do a merge and embed some logic: I'm sending instructions to a list of recipients, and only include parts of the message which apply to each recipient. The data is populating from an excel table with a column of user names/email address, and columns with flag variables for each user designating whether or not they should receive a paragraph of instructions identified by the column. I don't know VB very well, and I'd like to use those flag variables to designate whether or not the instructions corresponding to that column should be included in the message or not.</p>\n\n<p>Please let me know if this is even feasible in VBA, or if there's a better way of going about this--currently the list of recipients for instructions is small, but it is expected to grow quickly, and I would like to develop this process before that happens. </p>\n\n<p>Update: I should add: <em>how</em> should I go about doing this? What resources would be helpful-guides, pastebin, etc.?</p>\n"},{"tags":["c#","excel","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13037817,"title":"Disconnect from Microsoft Excel Interop without crashing host C# program","body":"<p>I have a C# program that is creating, writing, and saving an excel file using the Excel Interop.  The problem is that if I don't have the application quit immediately after saving and closing the excel file then the c# application gets an unhandled exception and crashes.  Has anyone found a way to do this while being able to keep the host c# application open and running.</p>\n\n<p>Here is the code that handles everything involving the Excel Interop</p>\n\n<pre><code> class CreateExcelDoc\n{\n    string newFormString = trialReportForm.newFormString;\n   string fileString=trialReportForm.fileString;\n   int sheetCount;\n   string trialString = trialReportForm.trialString;\n   string dateString = trialReportForm.dateString;\n   string saveString = trialReportForm.saveSting;\n   System.Windows.Forms.Timer excelTimer = new System.Windows.Forms.Timer();\n    private Excel.Application app = null;\n    private Excel.Workbook workbook = null;\n    private Excel.Worksheet worksheet = null;\n    private Excel.Range workSheet_range = null;\n    public CreateExcelDoc()\n\n    {\n        createDoc();\n    }\n\n    public void createDoc()\n    {\n\n        try\n        {\n            app = new Excel.Application();\n            //app.Visible = false;\n            if (startForm.exportOwnerString == \"Yes\")\n            {\n                app.Visible = true;\n                startForm.exportOwnerString = \" \";\n            }\n            else\n            {\n                app.Visible = false;\n            }\n            if (startForm.excelActionFlag==\"addNewTrialReport\")\n            {\n                workbook = (Excel.Workbook) app.Workbooks.Add(1);\n                //workbook.SaveAs(newFileForm.desktopPath + \"\\\\\" + \"OB \"+trialReportForm.otrClubNameString+\" - \"+trialReportForm.otrDateString);\n                worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                //fileNameString = newFileForm.desktopPath + \"\\\\OB \" + trialReportForm.otrClubNameString + \" \" + trialReportForm.otrDateString;\n                workbook.Worksheets[1].Name = trialReportForm.trialReportDate+\" Trial \"+trialReportForm.trialReportTrialNumber;\n            }\n            else if (startForm.excelActionFlag == \"ownerContacts\")\n            {\n                workbook = (Excel.Workbook)app.Workbooks.Add(1);\n                worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                workbook.Worksheets[1].Name = \"Owner Contacts\";\n            }\n            else if (startForm.excelActionFlag == \"newExcelResults\")\n            {\n                string testFile = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\test\";\n                workbook = (Excel.Workbook)app.Workbooks.Add(1);\n\n                worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                workbook.Worksheets[1].Name = \"Event 1 Results\";\n                //workbook.SaveAs(testFile, Missing.Value, Missing.Value, Missing.Value, false);\n                //workbook.SaveAs(Environment.GetFolderPath(Environment.SpecialFolder.Desktop)+\"\\\\Results\", Missing.Value, Missing.Value, Missing.Value, false);\n\n\n\n                //workbook.SaveAs(startForm.excelFileLocation, Missing.Value, Missing.Value, Missing.Value, false);\n\n                //fileNameString = registrationForm.regFileLocation + \"\\\\OB \" + registrationForm.regClubName + \" \" + registrationForm.regDateString;\n            }\n            else if (dogForm.dogRegistrationExcel == \"Yes\")\n            {\n                workbook = (Excel.Workbook)app.Workbooks.Add(1);\n                workbook.SaveAs(dogForm.filePath, Missing.Value, Missing.Value, Missing.Value, false);\n\n            }\n            else if (newFormString == \"No\")\n            {\n\n                //workbook = app.Workbooks.Open(fileString, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                // workbook.Close(true,fileString,Missing.Value);\n                workbook = (Excel.Workbook)app.Workbooks.Open(fileString, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n            }\n            if (newFormString==\"Yes\"&amp;registrationForm.formString==\"OTR\")\n            {\n                //string sheetName = \"Trial Report - \" + dateString + \" \" + trialString;\n            worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n            workbook.Worksheets[1].Name =trialReportForm.otrDateString+\" Trial \" + trialReportForm.otrTrialString;\n            //workbook.Worksheets[1].Name = \"Trial Report - \" + dateString + \" \" + trialString;\n            //workbook.Worksheets[1].Name = \"Hello\";\n            //Excel.Name name1 = worksheet.Names.Add(\"Trial Report - \" + dateString + \" \" + trialString, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n            //worksheet.Name = \"Trial Report - \" + dateString + \" \" + trialString;\n\n\n            }\n            else if (newFormString == \"Yes\" &amp; registrationForm.formString == \"Registration\")\n            {\n                //string sheetName = \"Trial Report - \" + dateString + \" \" + trialString;\n                worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                workbook.Worksheets[1].Name = \"Results: \"+registrationForm.selectedEvent;\n                //workbook.Worksheets[1].Name = \"Trial Report - \" + dateString + \" \" + trialString;\n                //workbook.Worksheets[1].Name = \"Hello\";\n                //Excel.Name name1 = worksheet.Names.Add(\"Trial Report - \" + dateString + \" \" + trialString, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                //worksheet.Name = \"Trial Report - \" + dateString + \" \" + trialString;\n\n\n            }\n            else if (startForm.excelActionFlag == \"addExistingTrialReport\")\n            {\n                workbook = (Excel.Workbook)app.Workbooks.Open(startForm.excelFileLocation, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n               sheetCount = workbook.Worksheets.Count;\n               int sheetCountPlusONe=sheetCount+1;\n               worksheet = (Excel.Worksheet)workbook.Worksheets.Add(Missing.Value,workbook.Worksheets[sheetCount],Missing.Value,Missing.Value);\n               workbook.Worksheets[sheetCountPlusONe].Name = trialReportForm.trialReportDate + \" Trial \" + trialReportForm.trialReportTrialNumber;\n\n               //worksheet.Move(Missing.Value, workbook.Worksheets[sheetCount]);\n\n\n            }\n            else if (startForm.excelActionFlag == \"existingExcelResults\")\n            {\n\n                workbook = (Excel.Workbook)app.Workbooks.Open(startForm.excelFileLocation, Missing.Value, false, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, true, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n                sheetCount = workbook.Worksheets.Count;\n                int sheetCountPlusONe = sheetCount + 1;\n                worksheet = (Excel.Worksheet)workbook.Worksheets.Add(Missing.Value, workbook.Worksheets[sheetCount], Missing.Value, Missing.Value);\n                workbook.Worksheets[sheetCountPlusONe].Name = \"Event \" + sheetCountPlusONe.ToString() + \" Results\";\n\n\n                //worksheet.Move(Missing.Value, workbook.Worksheets[sheetCount]);\n\n\n            }\n            else if (dogForm.dogRegistrationExcel == \"Yes\")\n            {\n                worksheet = (Excel.Worksheet)workbook.Worksheets[1];\n                workbook.Worksheets[1].Name = dogForm.dogUKCNumber;\n            }\n        }\n        catch (Exception e)\n        {\n            Console.Write(\"Error\");\n        }\n         /* if (trialReportForm.saveMe==\"Yes\")\n            {\n                workbook.Save();\n                workbook.Close();\n            }\n        */\n\n\n    }\n\n\n    public void createHeaders(int row, int col, string htext, string cell1,\n    string cell2, int mergeColumns, string b, bool font, int size, string\n    fcolor)\n    {\n        worksheet.Cells[row, col] = htext;\n        workSheet_range = worksheet.get_Range(cell1, cell2);\n        workSheet_range.Merge(mergeColumns);\n        switch (b)\n        {\n            case \"BLUE\":\n                workSheet_range.Interior.Color = System.Drawing.Color.Red.ToArgb();\n                break;\n            case \"GAINSBORO\":\n                workSheet_range.Interior.Color =\n        System.Drawing.Color.Gainsboro.ToArgb();\n                break;\n            //case \"Turquoise\":\n               // workSheet_range.Interior.Color =\n        //System.Drawing.Color.Turquoise.ToArgb();\n                //break;\n            case \"PeachPuff\":\n                workSheet_range.Interior.Color =\n        System.Drawing.Color.PeachPuff.ToArgb();\n                break;\n            default:\n                //  workSheet_range.Interior.Color = System.Drawing.Color..ToArgb();\n                break;\n        }\n\n        //workSheet_range.Borders.Color = System.Drawing.Color.Black.ToArgb();\n        //workSheet_range.Borders = null;\n        workSheet_range.Font.Bold = font;\n        workSheet_range.ColumnWidth = size;\n        //workSheet_range.HorizontalAlignment = ContentAlignment.BottomCenter;\n        if (startForm.excelActionFlag == \"existingExcelResults\" | startForm.excelActionFlag==\"newExcelResults\")\n        {\n            workSheet_range.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;\n        }\n        //workSheet_range.Cells.HorizontalAlignment = ContentAlignment.MiddleCenter;\n        workSheet_range.Font.Color = System.Drawing.Color.FloralWhite.ToArgb();\n\n    }\n\n    public void addData(int row, int col, string data,\n        string cell1, string cell2, string format)\n    {\n        worksheet.Cells[row, col] = data;\n        workSheet_range = worksheet.get_Range(cell1, cell2);\n        //workSheet_range.Borders.Color = System.Drawing.Color.Black.ToArgb();\n        workSheet_range.NumberFormat = format;\n        workSheet_range.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;\n\n        excelTimer.Tick += new EventHandler(excelTimer_Tick);\n        excelTimer.Interval = 6000;\n        excelTimer.Start();\n    }\n    void excelTimer_Tick(object sender, EventArgs e)\n    {\n        if (startForm.excelActionFlag != \"ownerContacts\")\n        {\n            if (startForm.excelActionFlag == \"existingExcelResults\" | startForm.excelActionFlag == \"newExcelResults\")\n            {\n               /* Excel.Range sortRange;\n                sortRange = worksheet.get_Range(\"A14\", \"K32\");\n                Excel.Range scoreColumn;\n                scoreColumn = worksheet.get_Range(\"C14\", \"C32\");\n                sortRange.Sort(scoreColumn, Excel.XlSortOrder.xlDescending);*/\n                Excel.Range valueRange;\n                Excel.Range placeRange;\n                placeRange = worksheet.get_Range(\"A14\", \"A\" + (14 + (registrationForm.numberofCompetitors - 1)).ToString());\n                valueRange = worksheet.get_Range(\"A14\", \"K\"+(14+(registrationForm.numberofCompetitors-1)).ToString());\n                valueRange.Sort(valueRange.Columns[3, Type.Missing], Excel.XlSortOrder.xlDescending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);\n                placeRange.Sort(placeRange.Columns[1, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlGuess, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal); \n            }\n            // workbook.Close(true, Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\Results.xls\", Missing.Value);\n            workbook.Close(true, startForm.excelFileLocation, Missing.Value);\n            app.Quit();\n            Application.Exit();\n\n            /* workSheet_range = null;\n             worksheet = null;\n             workbook = null;\n             app = null;*/\n            //Thread.Sleep(5000);\n            // File.Move(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\\\Results.xls\", startForm.excelFileLocation);\n        }\n\n    }\n}\n</code></pre>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12981154,"title":"Excel check if any 2 values within the same row equal any others","body":"<p>I have a data which has 6 columns and tens of thousands of rows.\nI need to count the number of times a given row shares data from column B and E with a different row's columns B and E.</p>\n\n<p>For example,<br>\n<code>COUNTIF(AND(B[X]=B[Y],E[X]=B[Y]))</code></p>\n\n<pre>\n    A         B            C       D                   E            F\n1  6725  555-371-7295   0:00:12 Answered    10/8/2012 8:57  outbound\n2  6725  555-371-7295   0:00:31 Answered    10/8/2012 8:57  outbound\n3  6714  555-558-2100   0:00:13 Answered    10/8/2012 8:59  outbound\n4  6714  555-558-2100   0:00:25 Answered    10/8/2012 9:08  outbound\n5  6725  555-842-2600   0:00:04 Answered    10/8/2012 9:08  outbound\n</pre>\n\n<p>where X and Y are row numbers</p>\n\n<p>The code above is obviously not real Excel code, it's just supposed to get across what I'm looking to do. Notice that B1=B2 AND E1 = E2 that's what I'm looking to count. B3 = B4 but E3 &lt;> E4 so I would not want to count that.</p>\n\n<p>This means, COUNTIFS(B:B,B1,E:E,E1) won't work because what I really need is <code>COUNTIFS(B1:B5,ANY B1:B5,El:E5, ANY El:E5)</code> I hope I made the question is somewhat clear.</p>\n\n<p>Please advise.</p>\n"},{"tags":["excel","vba","word","office"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":13038589,"title":"Excel - Populate a combobox on a userform from cell values","body":"<p>I'm assuming this is a fairly easy task but... my google-fu is failing me. So... How does one populate a combobox (on a userform) from cell B2 to however many the user chooses to enter.</p>\n\n<p>Thanks.</p>\n"},{"tags":["jquery","asp.net","database","excel","spreadsheet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":37,"score":-3,"question_id":13038837,"title":"Export Data Fields from ASPX search Site into Spreadsheet","body":"<p><a href=\"http://www.nkba.org/Design/Homeowners/ProSearch.aspx\" rel=\"nofollow\">http://www.nkba.org/Design/Homeowners/ProSearch.aspx</a></p>\n\n<p>I would like to use this page, and only export the name and email fields based on my search results into a spreadsheet. Is there a simple and easy way to do this. Thanks</p>\n"},{"tags":["excel","delphi","excel-2010","office-automation"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":13037007,"title":"How can I avoid Excel show Save dialog when automation app exits","body":"<p>I have a excel automation application written in Delphi, that accesses a given excel workbook and extracts applying some internal logic different data of the sheets. </p>\n\n<p>It has worked perfectly for years on Excel 2003 and 2007. </p>\n\n<p>Recently some users have Excel 2010. On those users, when my application exits, Excel shows a dialog box asking the user to Save the unmodified worksheet. The message says something about versions of the formulas to be saved in a new 2010 format. Sorry I don't have the exact words because it is not an english office package. </p>\n\n<p>How can my app prevent excel 2010 showing this annoying and useless box? </p>\n\n<p>Most of the users have Excel 2007, so most of the files that my application needs to process, regardless of the actual Excel version of the user running my app, are in that format, and will be in the future, so migrating all the files is not an option.</p>\n"},{"tags":["excel","vba","math","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13037765,"title":"Change Cell Data Type within VBA?","body":"<p>I am writing an application in excel that helps you to learn the Completing the Square process. I want the cell to be formatted as Number if the variable is an integer, and formatted as a fraction if not.</p>\n\n<pre><code>If h = (Int(h)) Then\nRange(\"D1\").Select\nSelection.NumberFormat = \"Number\"\nElse\nRange(\"D1\").Select\nSelection.NumberFormat = \"?/?\"\nEnd If\n</code></pre>\n\n<p>This code doesn't work for some reason, giving me the following error:</p>\n\n<blockquote>\n  <p>Unable to set the NumberFormat property of the Range class</p>\n</blockquote>\n\n<p>Are there any other ways I can do this?</p>\n"},{"tags":["excel","vba","macros","equations","equation-solving"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13037286,"title":"Set VBA macro for Excel to run a series of Linear Equations by taking variable from several rows?","body":"<p>I've got a set of equations which I'd like to be repeated taking variables from the next row down for each of the columns at which each variable is located. I am a beginner, so my coding is probably not to scratch:</p>\n\n<pre><code>Sub Iteration()\n\nDim al, ab, ae As Double\nDim as1, as2 As Double \n'etc\n\nas1 = Range(\"CG7\")\nas2 = Range(\"CG8\")\naA1 = Range(\"BQ7\")\n'etc\n\nintCounter = 0\nFor intCounter = 1 To 10000\n\n  Let x = ((aN1 * 1000) - (as1 * aA1) + (as2 * aA2)) / (al * fc * ae * ab)\n\n  Let x2 = ((aN12 * 1000) - (as12 * aA12) + (as22 * aA22)) / (al2 * fc2 * ae2 * ab2)\n\nNext\n\n Sheets(\"Sheet1\").Range(\"CJ7\").Value = x\n\nEnd Sub\n</code></pre>\n\n<p>I've done this for several variables which I've set as the range relative to each variable value. And then for the next row I've had to redo the whole equation and set the variables again for the next row down. Is there any way to set the variables (possibly with a relative cell reference?) which will skip to the cell in the next row for the next calculation? Consider also that there are 36 rows for calculation and about 9 variables! </p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13036896,"title":"will ABS formula columns sort and match","body":"<p>I am retired so I have a lot of free time on my hands so I like playing the greyhounds. using excel I attempted to help myself save time by sort out two columns at a time(post - B-spd)etc, \nbecause you have to sort some low and some high.the columns not marked post are formula columns =abs(a3)etc. but when I try to sort the Post columns will sort, but the column I try to sort with it does not sort and match the post number it is assign to. can this be done or does the =ABS formula prevent it.plus even using =Abs some of the number are negative number but the -minus sign does not appear.I have tried everything using numbers,using currency,using general, but nothing works.one person sent me to control panel to the Clock, Language, and Region setting.go additional setting and set your negative setting there.but that would not let the -minus sign show up on negative numbers either. is any of the above even possible?      </p>\n\n<p>POST B-SPD  POST A-SPD  POST 8TH    POST L-SPD  POST A-FIN\n1    31.43  1    31.84  1     0         1      3    1     5.83\n2    31.43  2    31.67  2   35.14   2      0    2     4.67\n3    31.79  3     31.9  3   59.11   3      6    3     5.67\n4    31.32  4    31.73  4   65.5    4      3    4     3.83\n5    31.47  5    31.68  5   29.71   5      4    5     3.33\n6    31.76  6    32.18  6   100     6      9    6     5.01\n7    31.48  7    31.99  7   41.13   7      1    7     5.67\n8    31.69  8    31.99  8   75.79   8      6    8     4.83\n      LOW         LOW       HIGH             HIGH         LOW</p>\n"},{"tags":["c#","asp.net","excel","linq-to-entities","export-to-excel"],"answer_count":7,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":7079,"score":6,"question_id":2202606,"title":"How to Export data to Excel using LINQ to Entity?","body":"<p>I have the data coming from Entity Data model table on my ASP.NET page.\nNow I have to export this data into Excel on button click.</p>\n\n<p>If it is using OLEDB, it is straight forward as it is here: <a href=\"http://csharp.net-informations.com/excel/csharp-excel-oledb-insert.htm\" rel=\"nofollow\">http://csharp.net-informations.com/excel/csharp-excel-oledb-insert.htm</a> </p>\n\n<p>Here is my function to read data from inquiries table:</p>\n\n<pre><code>var model = from i in myEntity.Inquiries\n            where i.User_Id == 5\n                        orderby i.TX_Id descending\n                        select new {\n                            RequestID = i.TX_Id,\n                            CustomerName = i.CustomerMaster.FirstName,\n                            RequestDate = i.RequestDate,\n                            Email = i.CustomerMaster.MS_Id,\n                            DocDescription = i.Document.Description,\n                            ProductName = i.Product.Name\n</code></pre>\n"},{"tags":["c#","asp.net","sql-server","ajax","excel"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":13036569,"title":"Export SQL Server data to Excel in a web app","body":"<p>I would like to export data from a SQL Server pull (usually I use <code>SqlDataReader</code>, but am open to suggestions) into an Excel/CSV file and have the user of the web app get it as a download. </p>\n\n<p>I'd like to do this AJAX style, so that the click on download won't cause a reload/postback. </p>\n\n<p>Anyone done this before or have an idea on how?</p>\n"},{"tags":["c#",".net","excel","com","interop"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":113,"score":3,"question_id":12810541,"title":"Copying Excel worksheets using COM Interop loses cell colors","body":"<p>I have tried various methods of merging worksheets using COM Interop.</p>\n\n<p>Here's what I have ended up with (unnecessary code omitted for brevity):</p>\n\n<pre><code>    public bool CombineWorkBooks(string exportFilePath, IEnumerable&lt;string&gt; filesToMergeFrom, bool deleteRawFiles)\n    {\n        var success = false;\n\n        Excel.Application xlApp = null;\n        Excel.Workbook mergeToWorkbook = null;\n        Excel.Workbooks mergeToWorkbooks = null;\n        Excel.Sheets mergeToWorksheets = null;\n        Excel.Worksheet defaultWorksheet = null;\n\n        try\n        {\n            if (filesToMergeFrom == null)\n            {\n                return false;\n            }\n\n            xlApp = new Excel.Application\n                    {\n                        DisplayAlerts = false,\n                        Visible = false,\n                        CutCopyMode = Excel.XlCutCopyMode.xlCopy\n                    };\n\n            mergeToWorkbooks = xlApp.Workbooks;\n            mergeToWorkbook = mergeToWorkbooks.Add(Excel.XlWBATemplate.xlWBATWorksheet);\n            mergeToWorksheets = mergeToWorkbook.Worksheets;\n\n            // Get the reference for the [first] empty default worksheet\n\n            if (mergeToWorksheets.Count &gt; 0)\n            {\n                defaultWorksheet = mergeToWorksheets[1] as Excel.Worksheet;\n            }\n\n            if (defaultWorksheet == null)\n            {\n                return false;\n            }\n\n            var reportSheetIndex = 1;\n            var fileMergeCount = 0;\n\n            foreach (var mergeFromFilename in filesToMergeFrom)\n            {\n                fileMergeCount++;\n\n                Excel.Workbook sourceWorkbook = null;\n                Excel.Sheets childSheets = null;\n\n                // Make sure file is still there...\n\n                if (!File.Exists(mergeFromFilename))\n                {\n                    continue;\n                }\n\n                try\n                {\n                    // Open source file\n\n                    sourceWorkbook = mergeToWorkbooks.Open(mergeFromFilename,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing,\n                                                           Type.Missing);\n\n                    childSheets = sourceWorkbook.Worksheets;\n\n                    if (childSheets != null)\n                    {\n                        var sheetsCopiedFromSource = 0;\n\n                        // childSheets.Copy(defaultWorksheet, Type.Missing);\n\n                        for (int iChildSheet = 1; iChildSheet &lt;= childSheets.Count; iChildSheet++)\n                        {\n                            Excel.Worksheet sourceWorksheet = null;\n\n                            try\n                            {\n                                sourceWorksheet = childSheets[iChildSheet] as Excel.Worksheet;\n\n                                if (sourceWorksheet != null)\n                                {\n                                    string name = string.Format(baseSheetName, reportSheetIndex.ToString(\"D4\", new CultureInfo(CultureInfo.CurrentCulture.Name)));\n\n                                    // Assigning the worksheet name\n\n                                    sourceWorksheet.Name = Truncate(name, 31); // only 31 char max\n\n                                    // Copy the worksheet before the default sheet\n\n                                    sourceWorksheet.Copy(defaultWorksheet, Type.Missing);\n\n                                    reportSheetIndex++;\n                                    sheetsCopiedFromSource++;\n                                }\n                            }\n                            finally\n                            {\n                                disposeCOMObject(sourceWorksheet);\n                            }\n                        }\n\n                        // Close the childbook - for some reason, calling close below may cause an \n                        // exception -&gt; System.Runtime.InteropServices.COMException (0x80010108): The object invoked has disconnected from its clients.\n\n                        try\n                        {\n                            sourceWorkbook.Close(false, Type.Missing, Type.Missing);\n                        }\n                        catch (COMException comException)\n                        {\n                            if (comException.ErrorCode != 0x80010108)\n                            {\n                                throw;\n                            }\n\n                            _messages.Add(\"Caught COMException, discarding it.\");\n                        }\n\n                        _messages.Add(string.Format(\"Successfully copied {0} worksheets from report file: '{1}'\", sheetsCopiedFromSource, mergeFromFilename));\n                    }\n                }\n                catch (Exception ex)\n                {\n                    _messages.Add(string.Format(\"An error occurred processing file '{0}'.\", mergeFromFilename));\n\n                }\n                finally\n                {\n                    disposeCOMObject(childSheets);\n                    disposeCOMObject(sourceWorkbook);\n                }\n            }\n\n            // Delete the empty default worksheet\n\n            defaultWorksheet.Delete();\n\n            // Select the first sheet.\n\n            if (mergeToWorksheets.Count &gt; 0)\n            {\n                Excel.Worksheet firstSheet = null;\n\n                try\n                {\n                    firstSheet = mergeToWorksheets[1] as Excel.Worksheet;\n\n                    if (firstSheet != null)\n                    {\n                        firstSheet.Select(Type.Missing);\n                        firstSheet.Range[\"A1\"].Select();\n                    }\n                }\n                finally\n                {\n                    disposeCOMObject(firstSheet);\n                }\n            }\n\n            // Determine the file extension\n\n            var fileExt = GetExcelExtension();\n\n            if (string.IsNullOrEmpty(Path.GetExtension(exportFilePath)))\n            {\n                exportFilePath = string.Format(\"{0}.{1}\", exportFilePath, fileExt);\n            }\n            else if (Path.GetExtension(exportFilePath) != string.Format(\".{0}\", fileExt))\n            {\n                exportFilePath = Path.ChangeExtension(exportFilePath, fileExt);\n            }\n\n            _mergeOutputFile = exportFilePath;\n\n            // Save the merged output\n\n            mergeToWorkbook.SaveAs(exportFilePath,\n                                   Excel.XlFileFormat.xlWorkbookDefault,\n                                   Type.Missing,\n                                   Type.Missing,\n                                   Type.Missing,\n                                   Type.Missing,\n                                   Excel.XlSaveAsAccessMode.xlExclusive,\n                                   Type.Missing,\n                                   Type.Missing,\n                                   Type.Missing,\n                                   Type.Missing,\n                                   Type.Missing);\n\n            // Close file\n\n            mergeToWorkbooks.Close();\n            xlApp.DisplayAlerts = true;\n\n            success = true;\n            return true;\n        }\n        catch (Exception ex)\n        {\n            return false;\n        }\n        finally\n        {\n            disposeCOMObject(defaultWorksheet);\n            disposeCOMObject(mergeToWorksheets);\n            disposeCOMObject(mergeToWorkbook);\n            disposeCOMObject(mergeToWorkbooks);\n\n            // Quit Excel.\n\n            if (xlApp != null)\n            {\n                xlApp.Quit();\n\n                disposeCOMObject(xlApp);\n            }\n\n            // Only delete source files upon success...\n\n            if (success &amp;&amp;\n                deleteRawFiles)\n            {\n                deleteTemporaryFiles(filesToMergeFrom);\n            }\n\n            // Clean up remaining resources\n\n            GC.Collect();\n            GC.WaitForPendingFinalizers();\n        }\n    }\n</code></pre>\n\n<p>Now - this works all well and good. BUT... the merge file has the cell/row interior colors all messed up (usually blacks and purples - something a 3 year old might prefer). The source worksheets have some rows with highlighted colors or background (interior) colors other than white.</p>\n\n<p>If I add the following code, I can reset all the cell colors in the merged file to white, but I've not managed with any success to preserve the colors of the original source sheets.</p>\n\n<pre><code>            // Reset the background colour in the cells to white. For some reason the worksheet copy\n            // operation screws up the cell backgrounds - pinks, purples and other business-like \n            // colours.\n\n            foreach (Excel.Worksheet targetWorksheet in mergeToWorkbook.Worksheets)\n            {\n                var usedRange = targetWorksheet.UsedRange;\n\n                usedRange.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.White);\n            }\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","ms-office","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13020878,"title":"Auto sort and format and Excel","body":"<p>I have a table of clients in Excel, and I want to be able to add new client into the last row of the table and excel will sort the table automatically so that the client's name will be sorted in alphabetical order. </p>\n\n<p>Also, that the format will be similar to the previous line. for example, the second column is DOB, so I want the format to be the same as the previous row MM/DD/YYYY</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12963923,"title":"Prevent Excel from defaulting \"True\" and \"False\" to boolean","body":"<p>My Excel document defaults all <code>True</code> and <code>False</code> strings to <code>TRUE</code> and <code>FALSE</code>, which it then treats as a boolean value and this is failing in my macro.</p>\n\n<p>I can <code>right click -&gt; format cells -&gt; select text</code>, but I don't know which cells users will use, so this method will not work.</p>\n\n<p>Is there a global method to disable this automatic conversion or perhaps a method using VBA?</p>\n"},{"tags":["c#","excel","inputbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13011077,"title":"C# Excel.Application.Inputbox","body":"<p>Pardons if this is a silly/simple question. I'm still really new to programming. I'm writting an Excel Addin in C# and am using Excel.application.InputBox in place of a RefEdit control. It works great for what I need, but I am unsatisfied that its appearance does not match the rest of the addin. </p>\n\n<p>Is there a way to customize the Form that pops up with the InputBox? I don't want to add any new features to the current Inputbox, I'd just prefer it not have the Windows XP appearance. Is there a place I can find the source code for the Excel InputBox method that I could use in a custom form I create?</p>\n\n<p>Any help would be much appreciated. Thanks in advance!</p>\n"},{"tags":["c#","excel","csv","graph"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":580,"score":2,"question_id":11454392,"title":"Externally create an excel graph from a CSV file","body":"<p>I have a bunch of data that I am saving out into .csv (Comma Seperated Value) format.\nIn excel, I can easily create a bar graph of this by manually selecting the data and hitting Graph.</p>\n\n<p>However, I want to do this externally with a click of a button.</p>\n\n<p>Ideally, I hit a button in C#. This calls a method which generates my .csv file, and then calls an excel function that creates the excel sheet, with the graph created in it.</p>\n\n<p>Not sure how to go about this, or if excel even supports something like this, much less from a csv file!</p>\n\n<p>Thank you.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13032645,"title":"Creating an Excel Macro to Delete multiple rows at once","body":"<p>I found a code online and want to make edits to it.  The code is in VBA and I want the macro code to delete multiple rows rather than one.  Here is the code:</p>\n\n<pre><code>Sub findDelete()\n    Dim c As String\n    Dim Rng As Range\n\n    c = InputBox(\"FIND WHAT?\")\n\n    Set Rng = Nothing\n\n    Set Rng = Range(\"A:A\").Find(what:=c, _\n        After:=Range(\"A1\"), _\n        LookIn:=xlFormulas, _\n        lookat:=xlPart, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, _\n        MatchCase:=False)\n\n    Rng.EntireRow.Delete shift:=xlUp\nEnd Sub\n</code></pre>\n"},{"tags":["php","database","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":12586049,"title":"indexing excel files in PHP","body":"<p>For a customer i'm working on a small project to index a bunch (around 30) Excel spreadsheets. Main goal of the project is to search fast through uploaded excel files. I've googled to find a solution but I didn't found an easy solution yet.</p>\n\n<p>Some options I'm considering:</p>\n\n<p>-Do something manually with PHPExcel and MySQL and store column information using meta  tables. Use the FullText options of the table to return search results.</p>\n\n<p>-Use a document store (like MongoDB) to store the files and combine this with ElasticSearch / Solr to get fast results.</p>\n\n<p>-Combination of both, use Solr on the relational database.</p>\n\n<p>I think the second option is a bit overkill, I don't want to spend to much time on this problem. I'd like to hear some opinions about this, other suggestions are welcome :)</p>\n"},{"tags":["excel","f#","vsto","office-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":152,"score":0,"question_id":12956517,"title":"F# Excel UsedRange is not Defined","body":"<p>Error: \"The field, constructor or member 'UsedRange' is not defined\".</p>\n\n<p>Code excerpts:  </p>\n\n<pre><code>open Microsoft.Office.Interop.Excel\nopen Microsoft.Office.Tools.Excel // Onorio's excellent suggestion didn't fix code until this line was added.\n// Once the above line was added, Onorio's suggestion worked,\n// but now F# says \"The field, constructor or member 'EntireColumn' is not defined\".\n\nlet xl = ApplicationClass()\nxl.Workbooks.OpenText(...\nlet wb = xl.Workbooks.Item(1)\nlet ws = wb.ActiveSheet :?&gt; Worksheet // Per Onorio's suggestion.\n\nws.UsedRange.EntireColumn.AutoFit()\n// \"The field, constructor or member 'EntireColumn' is not defined\".\n\n// Here's another example of UsedRange now working,\n// but Properties and Methods of UsedRange not working:\n// (uniqueID is simply a Boolean set earlier based on ini file values)\nif uniqueID then\n   xl.Range(\"A1\").EntireColumn.Insert() |&gt; ignore\n   xl.Range(\"A1\").Value &lt;- \"UniqueID\"\n   xl.Range(\"A2\").Value &lt;- 1\n   xl.Range(\"A2\").AutoFill(xl.Range(\"A2:A\" + ws.UsedRange.Rows.Count),\n                           XlAutoFillType.xlFillSeries) |&gt; ignore\n// Here it's \"The field, constructor or member 'Rows' is not defined\".\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1194,"score":1,"question_id":953664,"title":"Sort Excel Grouped Rows","body":"<p>I have a spreadsheet that has information in groups.  The header row contain company names and information and then the grouped rows beneath them contain names of people in the company.  </p>\n\n<blockquote>\n  <p>Company Name  |  Number of Employees  |  Revenue |<br />\n  Employee Name | Email | Phone</p>\n</blockquote>\n\n<p>Is there anyway to sort by the number of employees and/or revenue and keep the grouped employee information below the company with the information?  </p>\n\n<p>Normally when I try it, it will sort the company information but keep the employee information in the order that it is entered.  </p>\n"},{"tags":["excel","vba","outlook"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":449,"score":1,"question_id":10049419,"title":"How to access contact groups in Excel VBA?","body":"<p>I am building an Excel add-in that sends the active workbook as an attachment in an Outlook email template to a specific Contact Group.</p>\n\n<p>I've gotten the first two parts to work with the code below, but I am not sure how to set the <code>.TO</code> field to a contact group.</p>\n\n<pre><code>Public Sub Mail_Reports()\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object \n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    On Error Resume Next\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    'Set this line to the path and file name of your template\n    Set OutMail = OutApp.CreateItemFromTemplate(\"C:\\Users\\moses\\AppData\\Roaming\\Microsoft\\Templates\\test.oft\")\n    On Error Resume Next\n\n    With OutMail\n        '.TO field should be set to the contact group\n        .BCC = \"\"\n        .Attachments.Add ActiveWorkbook.FullName\n        .HTMLBody = Replace(OutMail.HTMLBody, strOldPeriod, strNewPeriod)\n        .Subject = Replace(OutMail.Subject, strOldPeriod, strNewPeriod)\n        'To display the email leave as is;  to send the Email, change to .Send\n        .Display    'or Send\n    End With\n\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"},{"tags":[".net","excel"],"answer_count":8,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":15045,"score":5,"question_id":297213,"title":"Translate an index into an Excel Column Name","body":"<p>Given a column index, how can you get an Excel column name?  </p>\n\n<p>The problem is tricker than it sounds because it's <strong>not</strong> just base-26. The columns don't wrap over like normal digits would.  Even the <a href=\"http://support.microsoft.com/kb/833402\" rel=\"nofollow\">Microsoft Support Example</a> doesn't scale beyond ZZZ.</p>\n\n<p><sub><em>Disclaimer: This is some code I had done a while back, and it came across my desktop again today.  I thought it was worthy of posting here as a pre-answered question.</em></sub></p>\n"},{"tags":["xml","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":252,"score":0,"question_id":3212043,"title":"Open excel file","body":"<p>I need to open a excel file to see the markup. the xml format.\nI wont to open the markup of Office 2003 file in any editor.\nAny ideas?</p>\n"},{"tags":["ipad","excel","vba","macros","compatibility"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13034088,"title":"Can the ipad run a file with formulas and macros?","body":"<p>I have an excel file with a number of formulas and macros and would like to know whether I will be able to run the file on an ipad! Will I be able to keep all the functionalities that I have when working with it on my computer? Do I need special software to run the file/ special application?\nThanks in advance!</p>\n"},{"tags":["excel","match"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":58,"score":1,"question_id":13033096,"title":"match cols a and c then match cols b and d","body":"<p>I'm trying to match cols a(id) and c(id), then the corresponding ''balance'' columns b(balance) and d(balance).</p>\n\n<p>e.g. i need output like that in e(does balance match keying on id):</p>\n\n<pre><code>id  balance id  balance does balance match keying on id\n1   20.1    2   30  yes\n2   30  6   24.6    no\n3   12.5    4   16  yes\n4   16  5   51  no\n5   50  3   12.5    yes\n6   24.5    1   20.1    yes\n</code></pre>\n\n<p>It's driving me nuts.  I can match id with vlookup, but if the rows are all mixed up (as above) i can't easily compare the corresponding balances in b and d.  If the rows where in order it would be easy of course (use an IF(b = d, \"true\",\"false\"))\nI have literally tens of thousands of rows in this condition.</p>\n\n<p>Does anyone know a way to do this?  Any help would be much appreciated</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13032636,"title":"How do you copy cell data in a range from one sheet to specific cells in another sheet?","body":"<p>The issue I am currently having is trying to write a subroutine that will copy cells for example A1:A10 from one worksheet; to another sheet with specific cells like A1,A2,B1,B2,B3,B5,C1,C2,C4,C5. The issue is the current sub I have cannot read in the worksheet name and range values. Here is the code</p>\n\n<pre><code>'User will be able to copy cell data from one to another.\nPublic Sub CopyCell(ByVal pv_worksheet_source As Worksheet, _\n                    ByVal pv_range_source_cells As Range, _\n                    ByVal pv_worksheet_destination As Worksheet, _\n                    ByVal pv_range_destination_cells As Range, _\n                    ByRef pr_str_error_message As String)\n\n'first the cells are compared for the data that is in them.\nIf pv_range_source_cells.Cells.Count &lt;&gt; pv_range_destination_cells.Cells.Count Then\n     pr_str_error_message = pr_str_error_message &amp; \"The cell count \" &amp; pv_range_source_cells.Cells.Count &amp; \" and \" &amp; _\n        pv_range_destination_cells.Cells.Count &amp; \" do not match. The cells of Initial Optics Input and Output cannot be copied!\"\n    Exit Sub\nEnd If\n\n\nDim source_cells As Range\nDim i As Integer\nDim ArrOut() As String\nDim str_source_worksheet_name As String\nDim str_destination_worksheet_name As String\n\n\n\nArrOut() = Split(pv_range_destination_cells.Address, \",\")\n\ni = 0\n\n\nFor Each source_cells In pv_worksheet_source\n    pv_worksheet_destination.Range(ArrOut(i)).Value = source_cells.Value\n    i = i + 1\nNext\nEnd Sub\n</code></pre>\n\n<p>As you can see the code is suppose read in source and destination sheet names, and their cells ranges for copying. There are type mismatches, plus I cannot figure out how else to copy the data over in VBA. This sub must be kept in the module format because it will be called throughout the Workbook for other sheets. Here is an example of it being called on the source worksheet....</p>\n\n<pre><code>Private Sub CopyButton_Click()\n'User gets data copied over to specific cells\n   Dim str_error_message As String\n    Call CopyCell(Sheet1, _\n                  \"A1:A10\", _\n                  Sheet2, _\n                  \"B1,B2,B3,C1,C2,C3,C4,D1,D2,D3\", _\n                  pr_str_error_message:=str_error_message)\n\n\nEnd Sub\n</code></pre>\n\n<p>This is where the error begins when I click the button. Please help because I have been dealing with this problem for days now! I would really appericate it! :)</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13032608,"title":"Insufficient memory error in Excel","body":"<p>Due to a large amount of data (more than 2,000,000 entries in a collection), Excel terminates my VBA program with an \"Insufficient memory error\" (code 7). I know that VBA is not the right language to handle so many data, but is there a way to increase the memory that Excel uses to run a VBA program? I precise it's not a stack overflow, the number of stack calls are limited to 10.</p>\n\n<p>Thanks in advance,\nMark</p>\n"},{"tags":["excel","matlab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12780746,"title":"Error while using xlswrite","body":"<p>When I run the following code </p>\n\n<pre><code>function feff\n\nfilename = 'UHL DEA.xlsx';\nFI = xlsread(filename,'AU9:AU179');\nFO = xlsread(filename,'AW9:AW179');\nFEff = FI./FO;\n\n%Write the efficiency back to the appropriate file in excel\n\nxlswrite(filename,FEff,'BC9:BC179');\n</code></pre>\n\n<p>I get the error</p>\n\n<pre><code> Error using xlswrite (line 220)\n Excel returned: Error: Object returned error code: 0x800A03EC.\n\n Error in feff (line 15)\n xlswrite(filename,FEff,'BC9:BC179');\n</code></pre>\n\n<p>But it works fine if i write into another file as follows</p>\n\n<pre><code>function feff\n\nfilename = 'UHL DEA.xlsx';\nFI = xlsread(filename,'AU9:AU179');\nFO = xlsread(filename,'AW9:AW179');\nFEff = FI./FO;\n\n%Write the efficiency back to the appropriate file in excel\n\nxlswrite('DEA.xlsx',FEff,'BC9:BC179'); \n</code></pre>\n\n<p>The UHL DEA.xlsx contains other data in the previous columns and I need to write this data again in the same file. Pointers will be appreciated. Thanks</p>\n"},{"tags":["c#","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13027552,"title":"Copy/paste Data from 1 sheet to another by matching specific cell or data (Date)","body":"<p>I have two sheets in Excel. Sheet2 contains data and I need that is on per date for 1 month, I would like to copy/paste the data on sheet1 by matching the date I put on the Blank date, example: Put Oct 1 on the date of sheet1 it will automatically copy the data of Oct 1 on sheet2. put Oct 2 copy data on Oct 2 an so on..</p>\n\n<p>SHEET 1         </p>\n\n<pre><code>DATE            \nTurnover  IN     out    Revenue\n0     0  0   0\n0     0  0   0\n0     0  0   0\n0     0  0   0\n0     0  0   0\n0     0  0   0\n0     0  0   0\n0     0  0   0\n</code></pre>\n\n<p>SHEET 2                             </p>\n\n<pre><code>1-Oct                           2-Oct           \nTurnover IN  OUT     RESULT     Turnover IN  OUT     RESULT\n14599    4410    4500    -90        1000     54641   737542  -90\n67530    9330    1440    7890       100  345     4274    7890\n57699    11520   2673    8846       500  4525    275274  8846.5\n196425   55960   68800   -12840     60050    42  4247    -12840\n92100    17770   2500    15270      136450   4   14  15270\n</code></pre>\n"},{"tags":["c#","excel"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":144,"score":2,"question_id":12901309,"title":"Screenshot of VBA editor in debug mode in terminal, or use Excel DOM to find error line and desc in VBA editor?","body":"<p>An Excel workbook is called by a command line, which itself is launched from c# (3.5). The workbook runs, but there is an error in the VBA. For example, a column is missing in a pivot and Excel prompts the user with an error message, with the option to \"debug\". </p>\n\n<p>From the process in C#, we can detect that the error window is open, and we take a screenshot of the error message, and then we close the error box. </p>\n\n<p>If this was an interactive session, Excel would then present the VBA editor, in debug mode, with the line where the error occurred highlighted. </p>\n\n<p>However, because this is running in an unattended terminal session, we are then unable to take a screenshot of the VBA editor (the screenshot is a black screen). </p>\n\n<p>We are then able to close the excel program, using the windows PID.</p>\n\n<p>The questions is: how do we either get a screenshot of the VBA editor, or how do we bind (with COM or interop) with the Excel in debug mode, and traverse the dom to find the error line, and possibly error message?</p>\n"},{"tags":["c#","excel","aspose","aspose-cells"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12947827,"title":"Error while saving Workbook using Aspose tool after Deleting a range of Cells","body":"<p>Before saving the Workbook I am deleting a CellArea in the Worksheet(I have used ClearContents, DeleteRange, ClearRange). But it keeps on giving an error \"<strong>Specified argument was out of the range of valid values</strong>.\" \nHowever if i remove the delete code and try it saving, It works fine..KIndly Suggest..\nMy Code goes like this :</p>\n\n<pre><code>foreach (GcmTemplateWorksheets _worksheet in Worksheetdetails)\n        {\n            if (_worksheet.IsTransposeRequired ?? false)\n            {\n                Range maxRange = _workbook.Worksheets[_worksheet.WorksheetName].Cells.MaxDisplayRange;\n                _workbook.Worksheets[_worksheet.WorksheetName].Cells.ClearRange((int)_worksheet.StartRow, (int)_worksheet.StartColumn, maxRange.RowCount, maxRange.ColumnCount);\n            }\n            _workbook.Worksheets[_worksheet.WorksheetName].Cells.ImportDataTable(data_.Tables[_worksheet.FixedWorksheetName], false, _worksheet.ExportDataStartRow ?? 0, 0);\n            //Instantiate the error checking options\n            ErrorCheckOptionCollection opts = _workbook.Worksheets[_worksheet.WorksheetName].ErrorCheckOptions;\n            int index = opts.Add();\n            ErrorCheckOption opt = opts[index];\n            //Disable the numbers stored as text option\n            opt.SetErrorCheck(ErrorCheckType.TextNumber, false);\n            opt.AddRange(CellArea.CreateCellArea(0, 0, _workbook.Worksheets[_worksheet.WorksheetName].Cells.MaxDataRow, _workbook.Worksheets[_worksheet.WorksheetName].Cells.MaxDataColumn));\n        }\n             string _exportPath = System.Configuration.ConfigurationManager.AppSettings[\"ExportTemplatePath\"].ToString();\n        //Save the worksheet at an appropriate configured location and assign path to _exportPath..\n        _workbook.Save(_exportPath);\n        return _exportPath;\n</code></pre>\n"},{"tags":["excel","internet-explorer","vba","automation"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13029708,"title":"Excel VBA: Wait for JavaScript execution in Internet Explorer","body":"<p>I am trying to do some web scraping in Excel VBA. Here is the part of the code that I am having trouble with:</p>\n\n<pre><code>IE.Navigate URL\nDo\n  DoEvents\nLoop While IE.ReadyState &lt;&gt; 4 Or IE.Busy = True\nSet doc = IE.document\n</code></pre>\n\n<p>After running this <code>doc</code> contains html that still has unexecuted JavasScript in it.\nThis is the signature of the script that has not been executed:</p>\n\n<pre><code>&lt;SCRIPT type=text/javascript&gt;\n        goosSearchPage.Initialize(...)...;\n&lt;/SCRIPT&gt;\n</code></pre>\n\n<p>I can wait for execution by doing <code>Application.Wait(Now  + TimeValue(x))</code> but that really is not satisfactory, as the amount of time the script takes to execute is quite variable depending on input.</p>\n\n<p>Is there a way to either wait for the script to finish evaluating or to just evaluate the script directly in the <code>doc</code> object?</p>\n"},{"tags":["excel","excel-vba","excel-2007"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":99,"score":-1,"question_id":12759229,"title":"Running Macros without opening excel","body":"<p>I wonder how would you assign VBA codes written on Excel VBA to a sort of procedure/programme or maybe dos related filepath, which you can directly without opening excel. In other word, i want to have a desktop icon i can stir up a vba code i assigned to. </p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":13026072,"title":"How to pick data out of a row and display it on a form","body":"<p>I have a list of dates in a spreadsheet, next to these dates are details what correspond to that date, I have a combo box which finds all the dates in the list but when I select a specific date from the drop down I want it to display the corresponding data in that row in text boxes on a form, so far I have:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Dim rw As Long, cl As Range\n    staffName = TextBox8.Value\n\n    rw = WorksheetFunction.Match(Me.ComboBox1.Value, Worksheets(staffName).Range(\"A16:A18\"), 0)\n    TextBox1 = Worksheets(staffName).Range(\"A\" &amp; rw).Offset(0, 1)\n    TextBox2 = Worksheets(staffName).Range(\"A\" &amp; rw).Offset(0, 2)\n    TextBox3 = Worksheets(staffName).Range(\"A\" &amp; rw).Offset(0, 3)\n    TextBox4 = Worksheets(staffName).Range(\"A\" &amp; rw).Offset(0, 4)\n\nEnd Sub\n</code></pre>\n\n<p>It doesnt error, but it doesnt work any ideas?</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13030540,"title":"Excel - Calculate investment return","body":"<p>Using Excel I am trying to calculate the position return based on the accumulative return. \nThe formula I am trying to use is \"=B2*A2\" (position return x the accumulative r) but I am getting a #value error.</p>\n\n<pre><code>Accumulative R  Position Return\n    100.00%         $200,000\n    98.03%  \n    99.90%  \n    100.16% \n    97.87%  \n    96.36%  \n    97.62%  \n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":249,"score":0,"question_id":7924909,"title":"Count rows between non-empty cells","body":"<p>Hi there i have a similar question to the question posed at</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3475300/move-from-one-cell-to-another-and-count-the-number-of-rows-in-between-two-data\">Move from one cell to another and count the number of rows in between two data</a></p>\n\n<p>In my example i would like count the number of rows between non-empty cells (including the original data line itself) in column A and put the count in Column B</p>\n\n<p>My data starts at A1 and moves down with blanks in cells until the the next data row.</p>\n\n<p>Example:</p>\n\n<pre><code>A1 1        B1 3\nA2          B2 4\nA3          B3 2\nA4 2        B4 3\nA5  \nA6  \nA7 \nA8 3  \nA9  \nA10 4\nA11 \nA12 \n</code></pre>\n\n<p>I tried to make mods to the original solution posted but i cant seem to get the count for the last row. </p>\n\n<p>Any assistance would be very much appreciated.</p>\n"},{"tags":["excel","parsing","vba","excel-formula"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":13007912,"title":"excel - string validate","body":"<p>I have strings which I need to validate such as</p>\n\n<pre><code>'AB01MCD10werdfGhjklOP01DEF03124'\n</code></pre>\n\n<p>It starts with <code>AB</code>, followed by a two character number, which tells us how many characters follow for 'AB'(In this case it is <code>01</code>, just 1 character that is M). It should be followed by <code>CD</code>, again with the same behaviour, followed by <code>OP</code>, which is optional ie the <code>OP</code> group may or may not be present. Finally it should end with the <code>EF</code> gr</p>\n\n<ol>\n<li>String starts with 'AB', mandatory</li>\n<li>Followed by 'CD' again mandatory</li>\n<li>Followed by 'OP' which is optional</li>\n<li>Followed by 'EF', mandatory</li>\n</ol>\n\n<p>I want to validate the string in A1 and put the validation result in B1.</p>\n\n<p>If the validation is success, B1 should have <em>Validation Success</em>, otherwise <em>Error:Expected 'CD', but found 'blah</em>. </p>\n\n<p>Please let me know the best way to do this - is it using a formula or a macro?</p>\n"},{"tags":["php","javascript","excel","forms"],"answer_count":5,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":5955,"score":11,"question_id":2006468,"title":"Copy/Paste from Excel to a web page","body":"<p>Is there a standard way or library to copy and paste from a spreasheet to a web form?\nWhen I select more than one cell from Excel I (obviously) lose the delimiter and all is pasted into one cell of the web form.\nDoes it have to be done in VB? or could the processing be done once the paste action is started on the web form?</p>\n\n<p>Thanks a lot</p>\n"},{"tags":["excel","datatable","dataset","oledb"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13028969,"title":"OLEDB read excel mixed datatypes, no header","body":"<p>I am reading a few excel spreadsheets into a dataset via an OLEDB connection.  I have had problems with mixed datatypes (specifically columns with number values and numbers mixed with text, ie ####### and ##abc##)</p>\n\n<p>I have tried the solution suggested in this question <a href=\"http://stackoverflow.com/questions/3232281/oledb-mixed-excel-datatypes-missing-data/5721521#5721521\">OleDB &amp; mixed Excel datatypes : missing data</a></p>\n\n<p>However after further research it seems that both TypeGuessRows=0 and ImportMixedTypes=Text do nothing in the connection string as they are always taken from the registry, which for this solution I cannot edit.</p>\n\n<p>The only reason the above solution works is by setting no header (HDR=NO) so that any file with a header would always set all columns to text type.</p>\n\n<p>The file I am trying to process does have mixed datatypes and it does not have a header row. Does anyone know a solution to set the OLEDBDataAdapter to read all columns as text type?</p>\n"},{"tags":["excel","excel-vba","excel-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":205,"score":0,"question_id":12818449,"title":"Excel found unreadable content in <filename>","body":"<p>I have an excel file that contains about 1000 rows.  Each row has an image, kind of like a thumbnail size in one of the columns.  The cell that the image overlaps has a comment which actually contains a bigger version of the same image.</p>\n\n<p>Every now and then when opening the file I get</p>\n\n<p>Excel found unreadable content in .  Do you want to recover the contents of the file.  If I say No it closes.</p>\n\n<p>If I say yes it repairs and removes some parts with the following log:-</p>\n\n<p>Removed Part: /xl/drawings/vmlDrawing1.vml part.  (Drawing shape)\nRemoved Part: /xl/drawings/vmlDrawing2.vml part.  (Drawing shape)</p>\n\n<p>What then happens is the comments (that contain the bigger version of the image) are all gone on every row.</p>\n\n<p>The file originally contains a macro that runs and once its done I save the file as xlsx which strips the macro out which is fine.</p>\n\n<p>There is no concrete pattern to this behaviour, its not like it happens the first time I re-open it after saving as xlsx or anything.  It can be fine for a while and then suddenly happen.</p>\n\n<p>This is happening on Windows 7, Office 2010</p>\n\n<p>Any suggestions would be greatly appreciated</p>\n"},{"tags":["php","excel","phpexcel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":12636964,"title":"Use Excel to do core analysis in a PHP application?","body":"<p>I think this is really a question about approach.</p>\n\n<p>We have a core Excel spreadsheet that comes in from a third party, and it provides some complex analysis of raw data. The raw data arrives directly from customers in a second spreadsheet.</p>\n\n<p>We are looking to create an automated web-server based system where the raw data Excel file can be uploaded and the analysis performed, and a report generated.</p>\n\n<p>The report generation is no problem, but is there any mileage in actually using the core Excel spreadsheet itself within the application to do the mathematics (using PHPExcel for example)? Or is the best approach always to replicate the analysis in code?</p>\n\n<p>Our thinking is that the analysis (which comes in from a third party) is fairly complex, so will take quite a lot of unpicking to replicate in PHP, and secondly parts of the analysis are often being tweaked by the third party meaning new versions of the Excel are regularly provided to us.</p>\n\n<p>I could imagine using PHPExcel to do something like this, creating the sheet in memory and merging the raw data in as a second worksheet, then reading out the calculated results, but is this realistic - would it be too slow - or just simply not work how I am imagining?</p>\n\n<p>Any thoughts would be much appreciated.</p>\n"},{"tags":["excel","vba","excel-vba","pass","subroutine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":12995133,"title":"VBA Subroutine can't pass variable","body":"<p>I am having problems passing a variable to from one subroutine to another. I have declared them public, yet it doesn't seem to work. It says subroutine out of range. All I need is to use varUnique (an array) and firstIndex on my second subroutine. What do I need to do to accomplish this?</p>\n\n<pre><code>Public fistIndex As Integer\nPublic varUnique As Variant\nSub FindUnique()\n\n    Dim varIn As Variant\n    Dim iInCol As Long\n    Dim iInRow As Long\n    Dim iUnique As Long\n    Dim nUnique As Long\n    Dim isUnique As Boolean\n    Dim lastIndex As Integer\n\n    varIn = Range(\"List\")\n    ReDim varUnique(1 To UBound(varIn, 1) * UBound(varIn, 2))\n\n    nUnique = 0\n    For iInRow = LBound(varIn, 1) To UBound(varIn, 1)\n        For iInCol = LBound(varIn, 2) To UBound(varIn, 2)\n\n            isUnique = True\n            For iUnique = 1 To nUnique\n                If varIn(iInRow, iInCol) = varUnique(iUnique) Then\n                    isUnique = False\n                    Exit For\n                End If\n            Next iUnique\n\n            If isUnique = True Then\n                nUnique = nUnique + 1\n                varUnique(nUnique) = varIn(iInRow, iInCol)\n            End If\n\n        Next iInCol\n    Next iInRow\n    '// varUnique now contains only the unique values.\n    '// Trim off the empty elements:\n    ReDim Preserve varUnique(1 To nUnique)\n    firstIndex = LBound(varUnique)\n    lastIndex = UBound(varUnique)\n\n\ncreate:\n    If Not varUnique(firstIndex) = \"Sub-Total\" Then\n    Worksheets.Add.Name = varUnique(firstIndex)\n    Call Ledge(varUnique, firstIndex)\n    Else\n    End\n    End If\n    If Not firstIndex = lastIndex Then\n    firstIndex = firstIndex + 1\n    ActiveCell.Offset(1, 0).Select\n    GoTo create\n    Else\n    End If\nEnd Sub\nSub Ledge(varUnique, firstIndex)\n'\n\n'\n\n'Define Variables\nDim Account_type As String\nDim Debit As Long\nDim Credit As Long\n\n\n'Select Journal and Cell B4\n    Sheets(\"Journal\").Select\n    Range(\"B4\").Select\n\nAccount_Search:\n'Make that cell= account_type\n    Account_type = ActiveCell.Value\n'If that cell= cash then save the values adjecent\n    If Account_type = varUnique(firstIndex) Then\n        ActiveCell.Offset(0, 1).Select\n        Debit = ActiveCell.Value\n        ActiveCell.Offset(0, 1).Select\n        Credit = ActiveCell.Value\n'Then go back to where you began\n        ActiveCell.Offset(0, -2).Select\n'Select Cash and Cell A2\n        Sheets(varUnique(firstIndex)).Select\n        Range(\"A2\").Select\nSearch:\n'If both cells are empy\n            If ActiveCell.Value = \"\" And ActiveCell.Offset(0, 1).Value = \"\" Then\n'Then write values and indicate you have done so\n               ActiveCell.Value = Debit\n               ActiveCell.Offset(0, 1).Select\n               ActiveCell.Value = Credit\n               Else\n'If they are not empty go down one cell and search again\n               ActiveCell.Offset(1, 0).Select\n               GoTo Search\n            End If\n'Once it is recorded go to Journal again and go down one more cell\n                Sheets(\"Journal\").Select\n                ActiveCell.Offset(1, 0).Select\n'If it wasn't cash then go down one\n    Else\n        ActiveCell.Offset(1, 0).Select\n    End If\n'Record that cell value and check to see if it is not sub-total\n    Account_type = ActiveCell.Value\n    If Not Account_type = \"Sub-Total\" Then\n'Now see if it is cash\n        GoTo Account_Search\n    Else\n    End If\nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel","xls","datareader","oledbdatareader"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":12279258,"title":"DataReader does not see data in Excel cell if previous cell in the column are empty","body":"<p>I have a weird problem with reading .xls file using <code>OleDbDataReader</code>. </p>\n\n<p>Basically, it does not see a data in the cell, if the previous cells in the column are empty. </p>\n\n<p>If I move the row with the data at the top of Excel sheet, then everything loads fine. I'm not sure, but I think that it has something to do with the amount of empty cells before the one with data.</p>\n\n<p>Any help or advice will be much appreciated. </p>\n"},{"tags":["php","excel","excel-formula"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13027023,"title":"Run excel formula from php","body":"<p>Here's my clients scenario my client wants to put a excel file on server now from a PHP form\nsends data to the file runs a formula in this excel file and get the results.</p>\n\n<p>I don't know if this is possible. \nIf so direct me to a library best was PHP, or some other possible solutions.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13024409,"title":"Excel VBA Event Handlers","body":"<p>1) Can someone please tell me what the issue could be with this code?</p>\n\n<p>2) I need this code actually to run on a worksheet update, but @ first-time load of the workbook, i'm running an update using the <code>Workbook_Open</code> event handler. Won't this trigger my <code>Worksheet_Change</code> event as well? Is there any way to avoid this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim ws As Worksheet\nDim rowCount As Integer\n\nSet Worksheet = \"datasheet\"\nSet rowCount = ws.Cells(Rows.Count, \"A\").End(xlUp)\n\nIf Not Intersect(Target, Range(\"M3:M\" &amp; CStr(rowCount))) Is Nothing Then\n   MsgBox (\"Hi\")\nEnd If\nElse\nIf Not Intersect(Target, Range(\"T3:T\" &amp; CStr(rowCount))) Is Nothing Then\n   MsgBox (\"Hi\")\nEnd If\nElse\nIf Not Intersect(Target, Range(\"X3:X\" &amp; CStr(rowCount))) Is Nothing Then\n   MsgBox (\"Hi\")\nEnd If\nElse\nIf Not Intersect(Target, Range(\"AB3:AB\" &amp; CStr(rowCount))) Is Nothing Then\n   MsgBox (\"Hi\")\nEnd If\nElse\nIf Not Intersect(Target, Range(\"AI3:AI\" &amp; CStr(rowCount))) Is Nothing Then\n   MsgBox (\"Hi\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I'm getting a Compiler error saying \"object required\" when i change my data with this handler. On the other hand, if i give values instead of taking a rowcount, I get no issues.</p>\n"},{"tags":["c#","excel",".net-4.0","clipboard"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":71,"score":1,"question_id":13019461,"title":"How do I remove Excel copy focus with C#","body":"<p>I created a small app using .NET framework 4 which processes info copied from an Excel spreadsheet and saves the processed data to the clipboard.\nThe problem is that when the app finishes, Excel's focus is still on the cell from which the data was copied. </p>\n\n<p>My info is in the Office clipboard, but I have to manually remove focus before I can paste it. I would like my app to remove the focus for me, in order to simplify the process. How can this be done?</p>\n\n<pre><code>       try\n        {\n            Clipboard.Clear();\n        }\n        catch (Exception)\n        {\n            MessageBox.Show(\"Clipbour Clear Error\");\n        }                       \n        try\n        {\n            Clipboard.SetText(clipbourholder.ToString(), TextDataFormat.UnicodeText);\n\n        }\n        catch (Exception)\n        {\n            MessageBox.Show(\"Clipbour Paste Error\");\n        }\n</code></pre>\n\n<p>When information is in clipboard excel has this border around cells, which i dont like because it is active clipboard. I need mine info in active office clipboard. \n<a href=\"http://s18.postimage.org/knwhuieit/clp_Err.png\" rel=\"nofollow\">Active clipbourd example</a></p>\n"},{"tags":["c#","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":12968169,"title":"Format cell in an excel sheet using interop","body":"<p>I need to add borders to excel cells in Automatic colour using c# language. Given below is the coding that i use. But it doesn't add any borders to the cell. Can you please let me know what i have done wrong here:</p>\n\n<p>i'm not getting any border designing functionalities when i try to specify border styles to cells: <img src=\"http://i.stack.imgur.com/JEi1h.png\" alt=\"enter image description here\"></p>\n\n<pre><code> Excel.Application xlApp;\n            Excel.Workbook xlWorkBook;\n            Excel.Worksheet xlWorkSheet;\n            object misValue = System.Reflection.Missing.Value;\n            xlApp = new Excel.Application();\n            xlApp.Visible = false;\n            xlWorkBook = xlApp.Workbooks.Open(textBox1.Text, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue);\n            xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);\n\n            int i = 0;\n            int j = 0;\n\n            for (i = 0; i &lt;= dataGridView1.RowCount - 1; i++)\n            {\n                for (j = 0; j &lt;= dataGridView1.ColumnCount - 1; j++)\n                {\n                    DataGridViewCell cell = dataGridView1[j, i];\n                    xlWorkSheet.Cells[\"19\", \"I\"] = \"Availablility\";                         \n                    xlWorkSheet.Cells[i + 20, j + 9] = cell.Value;                                                               \n                    xlWorkSheet.Cells.BorderAround(Excel.XlLineStyle.xlContinuous, Excel.XlBorderWeight.xlMedium, Excel.XlColorIndex.xlColorIndexAutomatic, Excel.XlColorIndex.xlColorIndexAutomatic);\n                }\n            }\n</code></pre>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1607,"score":2,"question_id":2497411,"title":"Excel MAXIF function or emulation?","body":"<p>I have a moderately sized dataset in <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a> from which I wish to extract the maximum value of the values in Column B, but those that correspond only to cells in Column A that satisfy certain criteria. </p>\n\n<p>The desired functionality is similar to that of <code>SUMIF</code> or <code>COUNTIF</code>, but neither of those return data that is necessary. There isn't a <code>MAXIF</code> function; how do I emulate one?</p>\n"},{"tags":["excel","vba","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":150,"score":1,"question_id":13021676,"title":"Excel Macro to Insert Data into Next Row","body":"<p>I can't seem to figure out how to offset the information into the next row down. </p>\n\n<p>What I'm trying to do is insert the same information on the next row down every time this macro is executed. I'm using it as a cheap for of Learning Management System to track completion of eLearning courses, so every time a user executes the macro it will list the date, course, and their username.  </p>\n\n<p>The information in <code>.Cells(1, 1)</code> is incorrect, but I just used that to ensure the rest of the macro was working. At this point I just need to figure out how build in the logic to move down one row each time the macro is executed.  </p>\n\n<p>Thanks in advance for your help!</p>\n\n<pre><code>Sub Test()\n    Dim objNetwork\n    Set objNetwork = CreateObject(\"WScript.Network\")\n    strUserName = objNetwork.UserName\n\n    Set objExcel = CreateObject(\"Excel.Application\")\n    Set objWorkbook = objExcel.Workbooks.Open(\"G:\\Training\\GPL\\Test.xlsx\")\n    objExcel.Application.DisplayAlerts = False\n    objExcel.Application.Visible = False\n    objWorkbook.Worksheets(1).Activate\n    objWorkbook.Worksheets(1).Cells(1, 1).Value = \"GPL Overview\"\n    objWorkbook.Worksheets(1).Cells(1, 2).Value = strUserName\n    objWorkbook.Worksheets(1).Cells(1, 3).Value = Date\n\n    'objExcel.ActiveWorkbook.Save \"G:\\Training\\GPL\\Test.xlsx\"\n    objExcel.ActiveWorkbook.SaveAs \"G:\\Training\\GPL\\Test.xlsx\"\n    objExcel.ActiveWorkbook.Close\n    'objExcel.ActiveWorkbook.\n\n    'objExcel.Application.Quit\n    'WScript.Echo \"Finished.\"\n    'WScript.Quit\n\n    objExcel.Application.Quit\nEnd Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":158,"score":2,"question_id":9818539,"title":"is it possible for VBA to detect the error and give a prompt that data not available instead of giving error message?","body":"<p>I have created a GUI that will setup the pivot table.</p>\n\n<p>For example, I click <code>button1</code> it will run and setup the pivot table.</p>\n\n<p>When I click <code>button3</code>, it will have a <code>run time error 1004</code> because it does not have the value in the data. So is it possible to let VBA accept that error and show a prompt that that data is not available?</p>\n\n<p><img src=\"http://i.stack.imgur.com/mZi76.png\" alt=\"enter image description here\"></p>\n\n<p>By the way, I'm using this </p>\n\n<p><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Test\").CurrentPage = \"Data1\"</code> </p>\n\n<p>to setup the pivot table.</p>\n\n<p>There are 3 different variables; <strong>Data1</strong>, <strong>Data2</strong>, <strong>Data3</strong>. If <strong>Data3</strong> is not available, it will show the error but I want to have a prompt to show that it is not available.. If you know how to do it, please share it with me! Thank you!</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":12133265,"title":"Why do Labels get Type mismatch errors in VBA but ComboBoxes don't?","body":"<p>I'm running Excel 2003. I have the following VBA code, corresponding to a simple <code>UserForm</code> comprising a <code>ComboBox</code> control and a <code>Label</code> control. It works through the save of the <code>ComboBox</code> but generates a <em>Type mismatch</em> error when saving the <code>Label</code>.</p>\n\n<pre><code>Private whatComboBox As ComboBox\nPrivate whatLabel As Label\n\nPrivate Sub UserForm_Initialize()\n    Call SaveComboBox(SomeComboBox)\n    Call SaveLabel(SomeLabel)\nEnd Sub\n\nPrivate Sub SaveComboBox(aComboBox As ComboBox)\n    Set whatComboBox = aComboBox\nEnd Sub\n\nPrivate Sub SaveLabel(aLabel As Label)\n    Set whatLabel = aLabel\nEnd Sub\n</code></pre>\n\n<p>[And I do appreciate that VBA is limited in comparison to most other languages. But I wouldn't have thought this was the kind of thing it would get wrong.]</p>\n\n<p>Thanks all!</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13006982,"title":"Excel VBA Workbook_open event handler required","body":"<p>I have reference data in columns A and B on <em>Sheet2</em> of my <code>WorkBook</code>. I have a blank sheet - <em>Sheet1</em> - which i need to fill from my database. </p>\n\n<p>I want to use Excel VBA to fill <em>Sheet1</em> based on data in columns A and B in <em>Sheet2</em>.</p>\n\n<p>I use the reference data by.</p>\n\n<ul>\n<li>I populate values in column A in <em>Sheet1</em> from DB.</li>\n<li>I check if the values stored in sheet 1, column A exist in <em>Sheet2</em> column A,</li>\n<li>If so, I populate into sheet 1 column B, the corresponding data i've found in <em>Sheet2</em> column B. </li>\n</ul>\n"},{"tags":["excel","vba","copy","range","runtime-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":12911440,"title":"Runtime Error '9' Subscript out of range - Copying ranges","body":"<p>First off I am aware of other similar questions with this title or close to it, I have tried the solutions on the pages but they do not work.</p>\n\n<p>I am trying to copy one range to another using Excel VBA. The worksheet I am copying from is 201209TB.xlsx and to 201210DB.xlsx.</p>\n\n<p>the cell value is the result of a sum and is cell F396 and needs to copy to cell J10 in the new workbook. Here is my code thus far;</p>\n\n<pre><code>Sub CopyRange()\n'\n' CopyRange Macro\n' Copy range from TrialBalance to Dashboard\n'\n    Dim Rng1 As Range\n    Dim Rng2 As Range\n    Set Rng1 = Workbooks(\"201209TB.xlsx\").Sheets(\"excel\").Range(\"F396\")\n    Set Rng2 = Workbooks(\"201210DB.xlsx\").Sheets(\"Sheet1\").Range(\"J10\")\n    Rng1.Copy Rng2\nEnd Sub\n</code></pre>\n\n<p>The cell code is =SUM(E409-E396) and the result should be -2,214,534.78\nThanks</p>\n\n<hr>\n\n<p>The reason it was throwing up an error was that the Workbook it was trying to use was not being opened by the other code due to an error on my part</p>\n"},{"tags":["html","excel","jsp"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":32,"score":-2,"question_id":13022604,"title":"How to add page break into jsp file for converting excel file","body":"<p>We all know we can convert a HTML file to an Excel file.</p>\n\n<p>I know we can use <code>PAGE-BREAK-BEFORE:always;</code> for a general HTML page, but it never works if I convert to an Excel file.</p>\n\n<p>I use <code>&lt;%@ page contentType=\"application/vnd.ms-excel; charset=euc-kr\" language=\"java\"%&gt;</code> for converting the page.</p>\n\n<p>Would you give me some technical way to improve this? </p>\n"},{"tags":["c#","excel"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":388,"score":1,"question_id":2245152,"title":"C# Numeric Errors Driving Me Crazy","body":"<p>Here is my test code for some maths I am doing: </p>\n\n<p>Why is C# treating this differently?</p>\n\n<p>EXCEL</p>\n\n<p>Numerator = =-0.161361101510599*10000000\nDenominator = =(-1*(100-81.26)) * (10000000/100)</p>\n"},{"tags":["excel","matlab","styles"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13003170,"title":"Matlab XlsRead - is this poorly styled code?","body":"<p>I'm trying to read an Excel spreadsheet with the first column having keys and the following columns having values into a struct with the keys as field names and the values as, well, values. I came up with the following code, but it just doesn't feel very matlab-y - I feel like there should be a way to do this in O(1) time rather than O(n).</p>\n\n<pre><code>[num,txt,~]=xlsread('whatever.xls','Rate');\ntxt=cell2mat(txt);\nfor i = 1:size(txt)\n    rates.(txt(i,:))=num(i,:)\nend\n</code></pre>\n\n<p>What's a more appropriate way of going about this? I'm working at home, where I only have Octave, so importdata is out of the realm of solutions.</p>\n"},{"tags":["excel","sum","range","sequence"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13005800,"title":"Do something with sequence of cells in an Excel cell?","body":"<p>I want to <a href=\"/questions/tagged/sum\" class=\"post-tag\" title=\"show questions tagged 'sum'\" rel=\"tag\">sum</a> \"every 5th row between A9 and A54,\" i.e.</p>\n\n<blockquote>\n  <p>A(5x + 9)-A(54),</p>\n</blockquote>\n\n<p>inside <a href=\"/questions/tagged/excel\" class=\"post-tag\" title=\"show questions tagged 'excel'\" rel=\"tag\">excel</a>.  </p>\n\n<p>There's also a sub-question here. Is it possible to sum a <a href=\"/questions/tagged/range\" class=\"post-tag\" title=\"show questions tagged 'range'\" rel=\"tag\">range</a> of cells using a function or VBA?</p>\n\n<p>Here are some test questions, based on the answer:</p>\n\n<ul>\n<li><code>=SUMPRODUCT(--(MOD(ROW(Range)-MIN(ROW(Range))+1,1)=0),A1:A50)</code>--sums row A1 throughA50?</li>\n<li><code>=SUMPRODUCT(--(MOD(ROW(A50)-MIN(ROW(A50))+1,2)=0),A1:A50)</code>--sums every other row, A1 through A50</li>\n<li><code>=SUMPRODUCT(--(MOD(ROW(A5:A50)-MIN(ROW(A1:A50))+1,5)=0),A1:A50)</code>--sums everyth 5th row between A5 and A50?</li>\n</ul>\n\n<p>Based on: </p>\n\n<blockquote>\n  <p>Substitute A9:A54 for Range and 5 for n for your specific query. Only\n  those parts change Answer will remain the same even if you delete rows\n  below Range.</p>\n</blockquote>\n"},{"tags":["excel","csv","utf-16","comma"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13019620,"title":"How to save Excel file as csv with UTF-16 formatting","body":"<p>I am having an issue with Excel not saving my files properly. I have a list of data which is organized into three columns: String String INt.</p>\n\n<p>I want to read this file into a Java program to perform some calculations. Excel exporting as a .csv file causes me to lose significant data as a result of the native UTF-8 encoding. I can save it as a UTF-16 .txt file however, I get another annoying result. If i insert columns of commas between each field field it saves the commas with quotes around it! I have seen some solutions to this problem but they do not preserve the UTF-16 encoding. </p>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["c#","excel","column"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13015823,"title":"Generate columns range for Excel (c#)","body":"<p>I need help with a fast function to generate a range with the names of Excel columns, that receives as input the start and end indexes.</p>\n\n<pre><code>i.e. Generate(2, 4) -&gt; B, C, D\n</code></pre>\n\n<p>Speed is important as I will need to generate ranges of up to 16,384 columns.</p>\n"},{"tags":["r","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13019567,"title":"what kind of files is suitable to be read in R","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6099243/read-an-excel-file-directly-from-a-r-script\">Read an Excel file directly from a R script</a>  </p>\n</blockquote>\n\n\n\n<p>I made an Excel file, I named it <code>test.xlsx</code>. I wanted to read the file in R.  </p>\n\n<pre><code>date    price  \n1   34  \n2   34.5  \n3   34  \n4   34  \n5   35  \n6   34.5  \n7   36  \n</code></pre>\n\n<p>Now, when I used  </p>\n\n<pre><code>x = read.csv(\"test.xlsx\")  \n</code></pre>\n\n<p>didn't work. Also I used  </p>\n\n<pre><code>x = read.table(\"test.xlsx\")\n</code></pre>\n\n<p>I got the warning</p>\n\n<pre><code>Warning message:\nIn read.table(\"test.xlsx\") :\n  incomplete final line found by readTableHeader on 'test.xlsx'  \n</code></pre>\n\n<p>and the result:</p>\n\n<pre><code> V1\n1                         PK\\003\\004\\024\n2 PˆTز\\005›DQ4ï½ùfىé|[™d\\003\\001µ³9\\033g\n</code></pre>\n\n<p>So, do I need to make a special file in order to read it in R?</p>\n"},{"tags":["excel","r","r-faq"],"answer_count":5,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":3345,"score":6,"question_id":6099243,"title":"Read an Excel file directly from a R script","body":"<p>How can I read an Excel file directly into R? Or should I first export the data to a text- or CSV file and import that file into R?</p>\n"},{"tags":["excel","vba","word","auto-generate","word-template"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13018627,"title":"How do I generate a formatted Word report from multi-row/column Excel spreadsheet","body":"<p>I'm trying to auto-build a formatted Word report from an Excel template used by multiple teams. For example, if i have the following Excel structure:</p>\n\n<p>......A.... |.....B.... |....C...<br>\n1  <strong>Name</strong> | <strong>Height</strong> | <strong>Weight</strong><br>\n2  Jason | 74 | 170<br>\n3  Greg | 70 | 160<br>\n4  Sam | 71 | 200  </p>\n\n<p>and I want to pull out that data and format into a Word file with the following format:</p>\n\n<p>2.1 Jason<br>\nHeight: 74<br>\nWeigh: 170  </p>\n\n<p>2.2 Greg<br>\nHeight: 70<br>\nWeight: 160  </p>\n\n<p>2.3 Sam<br>\nHeight: 71<br>\nWeight: 200  </p>\n\n<p>Is there a quick way to do that with VBA and be able to iterate through as many rows as may exist in any particular Excel file? (could vary from a few to many hundreds) The real excel file contains about a dozen columns where for each record (row) the data needs to be pulled out and formatted using standard template (font size/color, indent, alignment, etc...) but i'd love to just get the extract to work and I can play with the formatting later.</p>\n\n<p>Appreciate any help you can provide.</p>\n\n<p>For reference, I've tried to research known solutions, but most are centered on named bookmarks and relatively static content vs. interating through a dynamic number of rows and parsing the same data for each.</p>\n"},{"tags":["excel","microsoft","jet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13018290,"title":"Microsoft Jet database engine could not find the object for xls but the same sheet as xlsx works fine","body":"<p>I have a sheet name \"Test (testing)\". I can access this sheet just fine when I use a <code>xlsx</code> workbook but when the workbook is in the <code>xls</code> format I get the following error:</p>\n\n<pre><code>System.Data.OleDb.OleDbException (0x80040E37): The Microsoft Jet database engine could not find the object ''Test [testing]$'_'.  Make sure the object exists and that you spell its name and the path name correctly.\n   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr)\n   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object&amp; executeResult)\n   at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object&amp; executeResult)\n   at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object&amp; executeResult)\n   at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)\n   at System.Data.OleDb.OleDbCommand.ExecuteReader(CommandBehavior behavior)\n   at System.Data.OleDb.OleDbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)\n   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)\n   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)\n   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)\n</code></pre>\n\n<p>The error seems to be looking for \"Testing [testing]\". Is Jet doing some conversion I don't know about? Is there any other reason for this error? Note the workbooks are exactly the same, just the file format is different.</p>\n"},{"tags":["excel","vba","collections","pivot-table"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13015085,"title":"VBA: creating pivotTable from a collection or use a better algorithm?","body":"<p>I was wondering how, or if at all possible, to create a pivotTable using VBA given a collection. Or improve on the current algorithm for my code.</p>\n\n<p>Currently, I have a collection with about 28000 items.  Each item has an unique Id, item number, and price.  I want to generate a new collection with the unique Id, part number that has the lowest price.  So I was thinking generating the pivotTable will aggregate all the item numbers, and find minimum price. Then based on that table, I can generate a new collection, or should I improve on the algorithm I have?</p>\n\n<p>For example:    </p>\n\n<pre><code>item[unique_id]: item number, price\n\nItem[1]: 11111, 10\nItem[2]: 22222, 2\nItem[3]: 11111, 3\nItem[4]: 11111, 15\nItem[5]: 22222, 1\nItem[6]: 33333, 2\n</code></pre>\n\n<p>and then the result collection would be something like:</p>\n\n<pre><code>Item[3]: 11111, 3\nItem[5]: 22222, 1\nItem[6]: 33333, 2\n</code></pre>\n\n<p>Currently, I have code that does the following to create that new collection</p>\n\n<pre><code>For Each Item in OriginalCollection\n\n    ' Temp item holder for comparison\n    Set minItem = item\n    i = 1\n\n    Do While (i &lt;= OriginalCollection.Count)\n      if OriginalCollection(i).itemNumber = minItem.itemNumber And OriginalCollection(i).price &lt; minItem.price Then\n        Set minItem = OriginalCollection(i)\n\n        ' reduce the size of collection, so fewer iterations\n        OriginalCollection.Remove (i)\n        OriginalCollection.Remove (minItem.Id)\n      End if\n      i = i + 1\n    Loop\n\n    If Not InCollection (MinCollection, minItem.Id) Then\n        MinCollection.Add minItem, minItem.Id\n    End If\nNext item\n</code></pre>\n\n<p>Thank you in advance.</p>\n"},{"tags":["excel","vba","excel-vba","excel-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":67,"score":-2,"question_id":13011177,"title":"automating account reconciliation in excel","body":"<p>I have a spread sheet with three columns. the first column contains names of people. the second column contains dates. the third column contains amounts received and invoices paid for the date. </p>\n\n<p>eg:</p>\n\n<pre><code>Name  date         amount\nabc   1-jan-2012   2000 usd\nabc   2-jan-2012   (1500) usd\nabc   3-jan-2012   2000 usd\nabc   3-jan-2012   2000 usd\nabc   3-jan-2012   (3500) usd\n</code></pre>\n\n<p>i am trying to offset the invoices (positive values) against payments (negative value) received. if i use a lifo application then the net_value for the first entry will be 500 USD. the net value for the second entry will be zero.</p>\n\n<p>can anyone suggest a way of automating this exercise. i have written an if statement but the condition does not hold when the payments are more than the invoices (a case of advances being received by the client) </p>\n\n<p>thanks in advance.</p>\n\n<p>this is how the final table will look like </p>\n\n<pre><code>NAME    DATE    AMOUNT  NET VALUE\nabc 1-Jan-12     (4,910.00)  (4,910.00)\nabc 2-Jan-12     3,674.00    (26.00)\nabc 16-Jan-12    1,777.00    -   \nabc 17-Jan-12    (5,477.00)  -   \nabc 22-Mar-12    258.00      258.00 \nabc 31-Mar-12    5,502.00    1,465.00 \nabc 7-May-12     3,986.00    -   \nabc 20-May-12    5,238.00    -   \nabc 23-May-12    (6,861.00)  -   \nabc 4-Jul-12     (6,400.00)  -   \nabc 9-Aug-12     2,238.00    2,238.00 \nabc 21-Aug-12    4,855.00    2,456.00 \nabc 26-Aug-12    (2,399.00)  -   \nabc 9-Sep-12     3,938.00    3,938.00 \n</code></pre>\n\n<p>sorry guys for the confusion...</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12976259,"title":"How do I use a variable in FormulaR1C1?","body":"<p>I have a formula to get the closest value to given value i.e., </p>\n\n<pre><code>=SMALL(R1C1:R1C144,COUNTIF(R1C1:R1C144,\"\"&lt;\"\" &amp;8)+1 )\n</code></pre>\n\n<p>will give the closest value to 8.</p>\n\n<p>I want to use variable instead of direct number \"(8)\"</p>\n\n<p>Please help me. This is my current code</p>\n\n<pre><code>Private Sub CommandButton1_Click() \nDim col As Integer \ncol = Me.TextBox1.Value\nActiveCell.FormulaR1C1 = \"=SMALL($A$1:$EN$1,COUNTIF($A$1:$EN$1,\" &lt; \"&amp;col)+1)\"\nEnd Sub \n</code></pre>\n"},{"tags":[".net","excel","office-pia"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13015196,"title":"Excel PIA returning null for a cell with a number in","body":"<p>I have a problem in that using the following code</p>\n\n<pre><code>var num = sheet.Cells[row, col].Value;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var num = sheet.Cells[row, col].Value2;\n</code></pre>\n\n<p>will not return a value if the cell contains only a number. Am I missing something silly here? I also ought to mention that I am doing this with a csv file and office 2010.</p>\n\n<p>Thanks all.</p>\n"},{"tags":[".net","excel","dottrace"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":12805470,"title":"Profiling Excel addins with dotTrace","body":"<p>I am trying to profile Excel addins written in C# with dotTrace.</p>\n\n<p>I am able to connect to excel and profile my code when I select \"attach to process\" in dottrace, but when I want to use the \"standalone application\" mode (that allows for more options), then dottrace seems to think that excel is loading .Net v.2 and so it doesn't see my addins.</p>\n\n<p>Any idea about how to force dottrace to profile .net 4.0 addins?</p>\n\n<p>EDIT: I found that some other addins was loading .NET v2 before my addins were loading v4, and that dottrace takes the first one. Any way I can force which one to trace?</p>\n"},{"tags":["excel","microsoft","skydrive"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13015422,"title":"Skydrive and Hosted Excel?","body":"<p>I am currently using Skydrive to host an Excel workbook which is displayed on a web page. All of the formulas are retained and the functionality works perfectly. Is it possible to Host this on our network instead of using Skydrive and then make changes the layout using CSS?</p>\n\n<p>many thanks</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13015318,"title":"How to draw a line parallel to the linear portion of the curve in excel?","body":"<p>I have stress strain data from tensile test. I have drawn a stress vs strain graph in excel.I need to find the yield point.For that, I need to draw a line parallel to the linear(straight) portion of the curve with 0.2% offset in x axis and see where it intersects with the original curve.</p>\n\n<p>So, I tried to keep only the linear portion data and drew a trendline, which gives me straight line equation y=mx. Now, if I want 0.2% offset, equation of line is y=mx +c.\nI have the equation, how to draw this line in excel with the equation? And how to get the intersection point? Is my approach right? Please help.</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12385394,"title":"Excel VBA: List of changes","body":"<p>In Excel I can activate \"Track changes while editing.\" with \"Select \"Highlight changes on screen.\", and I get all changes visible.</p>\n\n<p>Now I want to generate a complex report of all these changes, so I need a way to access this information via VBA. Unfortunatly there is no \"Workbook.Changes\" Property.</p>\n\n<p>Does anybody know how to do it?</p>\n\n<p>Kind regards,\nThomas</p>\n"},{"tags":["string","excel","excel-formula"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":120,"score":0,"question_id":12386414,"title":"Excel: Use formula longer that 255 characters","body":"<p>I have the following formula in excel</p>\n\n<pre><code>=CONCATENATE(\"insert into #UpdateData (mondayopenhour, mondayopenmin,mondayclosehour, mondayclosemin,tuesdayopenhour, tuesdayopenmin,tuesdayclosehour, tuesdayclosemin,wednesdayopenhour, wednesdayopenmin, wednesdayclosehour, wednesdayclosemin,thursdayopenhour, thursdayopenmin,thursdayclosehour, thursdayclosemin, fridayopenhour, fridayopenmin, fridayclosehour, fridayclosemin, saturdayopenhour, saturdayopenmin, saturdayclosehour, saturdayclosemin, sundayopenhour, sundayopenmin, sundayclosehour, sundayclosemin values ('\",TRIM(A2),\"',\",MID(B2,1,2),\",\",MID(B2,3,2),\",\",MID(C2,1,2),\",\",MID(C2,3,2),\",\",MID(D2,1,2),\",\",MID(D2,3,2),\",\",(MID(E2,1,2),\",\",MID(E2,3,2),\",\",MID(F2,1,2),\",\",MID(F2,3,2),\",\",MID(G2,1,2),\",\",MID(G2,3,2),\",\",MID(H2,1,2),\",\",MID(H2,3,2),\",\",MID(I2,1,2),\",\",MID(I2,3,2),\",\",MID(J2,1,2),\",\",MID(J2,3,2),\",\",MID(K2,1,2),\",\",MID(K2,3,2),\",\",MID(L2,1,2),\",\",MID(L2,3,2),\",\",MID(M2,1,2),\",\",MID(M2,3,2),\",\",MID(N2,1,2),\",\",MID(N2,3,2),\",\",MID(O2,1,2),\",\",MID(O2,3,2),\")\")\n</code></pre>\n\n<p>When I try run it i get the following error </p>\n\n<blockquote>\n  <p>Text values in formulas are limited to 255 characters. To create text\n  values longer than 255 characters in a formula, use the CONCATENATE\n  function or the concatenation operator (&amp;).</p>\n</blockquote>\n\n<p>I have been looking this up online but have got no real solutions for this! does anybody know how to solve this?</p>\n"},{"tags":["excel","excel-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13012793,"title":"Excel - Lookup value with a condition","body":"<p>I've been trying to do the following:</p>\n\n<ul>\n<li><code>Sheet1</code>, lookup value <code>A3</code> in <code>Data</code></li>\n<li><code>Data</code>, check whether the found value has a <code>1</code> in column <code>M</code>\n<ul>\n<li>Yes: Paste the value of column <code>K</code> from <code>Data</code> in column <code>B3</code> in <code>Sheet1</code></li>\n<li>No: Carry on searching through the sheet and display <code>0</code> if nothing is found</li>\n</ul></li>\n</ul>\n\n<p>This is what I have so far, it finds the correct K value, but I need to enter shift+ctrl+enter to get the value ...</p>\n\n<pre><code>=INDEX('TLN Data'!$B$1:$Z$15000; MATCH(1;(A3='TLN Data'!$B$1:$B$15000)*(1='TLN Data'!$M$1:$M$15000);0); 10)\n</code></pre>\n\n<p>All help is much appreciated!</p>\n\n<p>--</p>\n\n<p>Sheet1</p>\n\n<p><img src=\"http://i.stack.imgur.com/VaxtR.jpg\" alt=\"enter image description here\"></p>\n\n<p>TLN Data</p>\n\n<p><img src=\"http://i.stack.imgur.com/LB3v4.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["osx","excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13011618,"title":"Mac querytables","body":"<p>I have written a script which downloads data from yahoo finance into excel using querytable. It should loop through each URL and download the data but it can't get past the second loop and fails at the .Refresh BackroundQuery:=False with the error code 1004 - An unexpected error has occurred.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>rowOffset = 0\nurl = Worksheets(\"Yahoo codes\").Range(\"b2\").Offset(rowOffset, 0)\n\nDo While url &lt;&gt; \"\"\n\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; url, Destination:=Worksheets(\"Yahoo Data\").Range(\"A65536\").End(xlUp).Offset(1, 0))\n    .RefreshStyle = xlOverwriteCells\n    .SaveData = True\n    .BackgroundQuery = True\n    .Refresh BackgroundQuery:=False\n\n\n    '.Refresh\n\nEnd With\n\nrowOffset = rowOffset + 1\nurl = Worksheets(\"Yahoo Data\").Range(\"a2\").Offset(rowOffset, 0)\nLoop\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12934407,"title":"How to generate graph without taking of time using vba?","body":"<p>Hello I have written a code for generating the graph and it is working correctly.\nThe problem is it is taking lot of time to generate. and i am not getting why it is taking time.\nthe code is</p>\n\n<pre><code>    Dim cc As Chart\n\n    Set cc = ActiveWorkbook.Charts.Add\n    Set cc = cc.Location(Where:=xlLocationAsObject, name:=assume)\n\n    With cc\n\n     .ChartType = xlXYScatterLines\n\n     With .Parent\n\n       .Top = Columns(b).Offset(0, 4).Top\n       .Left = Columns(b).Offset(0, 4).Left\n       .name = \"cc\"\n\n     End With\n\n  End With\n\n  Dim sc As Series\n  Set sc = cc.SeriesCollection(1)\n\n  With sc\n      .Values = Columns(b).Offset(0, -3)\n      .XValues = Columns(b).Offset(0, -5)\n  End With\n</code></pre>\n\n<p>Please somebody help me</p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13012426,"title":"Excel VBA Events","body":"<p>I'm a little new to Excel VBA. I've currently designed VBA code to produce a Vlookup that populates data in a column(say column Y)  in my datasheet based on ref data in another sheet, and a filled value in another column (column X) of the same sheet. This I'm performing on the Workbook_Open event.</p>\n\n<p>I need to, however, also be able to update column Y's value when column X's value is changed in a particular row. Also, if an additional row is added, I need to be able to provide a Y value for that too. However, I can't seem to find an appropriate event for the same, barring the selection changed event at Worksheet level, which is triggered when u change which cell you've selected.</p>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1649,"score":1,"question_id":2814116,"title":"running a macro from an add-in","body":"<p>i have an add-in called book1. inside the addin there is a module called module1 which has a sub called addin1</p>\n\n<p>i would like to run the macro addin1 from a different workbook</p>\n\n<p>i am trying to call this macro like this:</p>\n\n<pre><code>Call Addin1\n</code></pre>\n\n<p>but that's not working</p>\n\n<p>and i tried:</p>\n\n<pre><code>Call book1.xlam.Module1.AddIn1\n</code></pre>\n\n<p>which is not working either</p>\n\n<p>does anyone know how to run a macro that is within an add-in ?</p>\n"},{"tags":["osx","excel","add-in"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13010712,"title":"How to create Excel addin for Mac version?","body":"<p>Can anyone tell me the way in which we can create an addin for Excel(mac version).\nI have already created an addin for the windows version of office now, I would like to make the same for the mac users.\nAlso, is it possible to directly do some conversion or something so that windows excel addin works on mac machines as well ?\nI would like to know the tools (like VSTO for windows) or an approach, any thing will do.</p>\n"},{"tags":["excel","vba","excel-vba","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":13010049,"title":"Excel VBA Vlookup issue","body":"<p>I'm a complete beginner to Excel VBA. </p>\n\n<p>The following is code I've written that should iterate through a column in a sheet, filling values by referring to the column value to it's left and referring to another sheet in the same workbook to find what the correct corresponding value should be.</p>\n\n<p>I've used a <code>While</code> loop so i can apply this <code>VLOOKUP</code> macro to each cell in the column ( only the lookup value, changes, which should be a variable denoting the column to the left) :</p>\n\n<pre><code>Dim result As String\nDim sheet As Worksheet\nDim rownum As Integer\nDim iterator As Integer\nDim lookup_value As String\nDim vlookupString1 As String\n\nSet sheet = ActiveWorkbook.Sheets(\"datasheet\")\nrownum = sheet.Range(\"A1\").End(xlDown).Row\nSet iterator = 3\n\nWhile iterator &lt; rownum\n\nlookup = \"M\" &amp; iterator\nvlookup1String = \"=VLOOKUP(\" &amp; lookup &amp; \",'GICS Sub-industry codes'!$A$2:$B$155,2,FALSE)\"\nWith ActiveSheet.Cells\n       Range(\"N\" &amp; iterator).Select\n       Selection.Value = vlookup1String\nEnd With\niterator = iterator + 1\n\nEnd While\n</code></pre>\n\n<p>I'm getting an error @ end while saying \"expected if or select or sub...\" </p>\n\n<p>1) Have i made a syntax error?<br>\n2) Is my approach correct. I have observed this string approach to designing <code>VLOOKUPS</code> in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged 'vba'\" rel=\"tag\">vba</a> only in one other place. It seemed best suited.</p>\n"},{"tags":["excel","oledb","ace"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4072,"score":3,"question_id":3531458,"title":"Microsoft ACE OLEDB provider throws could not find installable ISAM exception","body":"<p>I'm trying to read Excel spreadsheets with a 64bit Process. Therefore I use the 64 bit Version of <a href=\"http://www.microsoft.com/downloads/details.aspx?familyid=C06B8369-60DD-4B64-A44B-84B371EDE16D&amp;displaylang=en\" rel=\"nofollow\">Micorosft Access Database Engine 2010</a>.</p>\n\n<p>The following code</p>\n\n<pre><code>var cs = @\"Provider=Microsoft.ACE.OLEDB.12.0;\"\n         + @\"Data Source=C:\\test.xls;\"\n         + @\"Extended Properties=\"\"Excel 14.0;\"\"\");\n\ncon = new OleDbConnection(cs);\ncon.Open();\n</code></pre>\n\n<p>throw an Exception:</p>\n\n<p>Could not find installable ISAM</p>\n\n<p>Using google I found a lot of questions about this exception. But they refer to JET and seem not apply to my problem.</p>\n\n<p>Any recommendations?</p>\n"},{"tags":["excel","vba","background-color","sheet"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":13008714,"title":"Change Background Color for Entire Sheet","body":"<p>Is there a way to change the Background color into <code>xlNone</code>, \nfor example to the entire sheet. I see that you can put a background image...\nBut how can you change the color for all cells in the sheet?</p>\n"},{"tags":["excel","vba","excel-vba","excel-2007","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13008551,"title":"Filter-out odd numbers in a PivotTable","body":"<p>In the source sheet of my pivot table; contains two columns; one for the <strong>names</strong> and another for the <strong>scores</strong>. As the thread title suggests, I want to display all names and their corresponding scores of those with even number scores. </p>\n\n<p>An alternative way to accomplish this is to create a third column and ran an IF formula to check which numbers are odd. And then include this third column to the pivot table and use it as the filter. </p>\n\n<p>But is there a way to do the same without modifying the source?</p>\n"},{"tags":["php","mysql","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13008068,"title":"Export to Excel is dropping leading zero","body":"<p>I found this code on web for export tables from Mysql to Excel. The problem is that data exported to excel is missing the leading zero. So instead of number 090888 i get 90888. Except that code work fine, so i would like to change this particular code.</p>\n\n<p>If anyone can help with this I would really appreciate it.</p>\n\n<p>The code:</p>\n\n<pre><code>header(\"Content-Type: application/xls\");\nheader(\"Content-Disposition: attachment; filename=$filename.xls\");\nheader(\"Pragma: no-cache\");\nheader(\"Expires: 0\");\n\n/*******Start of Formatting for Excel*******/\n\n//define separator (defines columns in excel &amp; tabs in word)\n\n$sep = \"\\t\"; //tabbed character\n\n//start of printing column names as names of MySQL fields\n\nfor ($i = 0; $i &lt; mysql_num_fields($result); $i++) {\n\necho mysql_field_name($result,$i) . \"\\t\";\n\n}\n\nprint(\"\\n\");\n\n//end of printing column names\n\n//start while loop to get data\n\n    while($row = mysql_fetch_row($result))\n    {\n        $schema_insert = \"\";\n\n        for($j=0; $j&lt;mysql_num_fields($result);$j++)\n\n        {\n\n            if(!isset($row[$j]))\n\n                $schema_insert .= \"NULL\".$sep;\n\n            elseif ($row[$j] != \"\")\n\n                $schema_insert .= \"$row[$j]\".$sep;\n\n            else\n\n                $schema_insert .= \"\".$sep;\n\n        }\n\n        $schema_insert = str_replace($sep.\"$\", \"\", $schema_insert);\n\n $schema_insert = preg_replace(\"/\\r\\n|\\n\\r|\\n|\\r/\", \" \", $schema_insert);\n\n        $schema_insert .= \"\\t\";\n\n        print(trim($schema_insert));\n\n        print \"\\n\";\n    }\n?&gt;\n</code></pre>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":25,"score":0,"question_id":13007920,"title":"Generate excel sheet using php with few non editable cells","body":"<p>I want to generate excelsheet using php so which method or code is preferable to use to generate dynamic excelsheet?  Please check a screenshot image for more idea what I am facing issue.! \n<a href=\"https://www.dropbox.com/s/wjwjz2019erk07y/excel_generate_issue.png\" rel=\"nofollow\">screenshot of required excel sheet format</a>\nPlease, anyone can help me to sort out these issue? Thanks in advance.</p>\n\n<p>I am using below code example.</p>\n\n<pre><code>$result = mysql_query(\"SELECT * FROM \".$pre.\"customers\");\n    if (!$result) die('Couldn\\'t fetch records');\n    $num_fields = mysql_num_fields($result);\n    $headers = array();\n\n    for ($i = 0; $i &lt; $num_fields; $i++) \n    {\n        $headers[] = mysql_field_name($result , $i);\n        mysql_field_name($result , $i);\n    }\n\n    $fp = fopen('php://output', 'w');\n    if ($fp &amp;&amp; $result)\n    {\n            header('Content-Type: text/csv');\n            header('Content-Disposition: attachment; filename=\"export1.csv\"');\n            header('Pragma: no-cache');\n            header('Expires: 0');\n            fputcsv($fp, $headers);\n\n            while ($row = mysql_fetch_row($result)) \n            {\n                 fputcsv($fp, array_values($row));\n            }\n\n            die;\n     }\n</code></pre>\n\n<p>But I don't that I can lock any cell into this excel sheet. So which php method or class are suitable to generate excelsheet for my purpose to use?</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12989687,"title":"Fetch Website data into Excel using VBA (Excel Macro)","body":"<p>I need to fetch the table from <a href=\"http://www.zillow.com/homes/comps/67083361_zpid/\" rel=\"nofollow\">http://www.zillow.com/homes/comps/67083361_zpid/</a> into Excel.\nI just want the table. Nothing else I want.</p>\n\n<p>But when I'm using </p>\n\n<pre><code>Set objIE = CreateObject(\"InternetExplorer.Application\")\n\nWith objIE\n    .Visible = True\n    .Navigate \"http://www.zillow.com/homes/comps/67083361_zpid/\"\n    Do While .ReadyState &lt;&gt; 4: DoEvents: Loop\n    Debug.Print .document.Body.outerText\nEnd With\n</code></pre>\n\n<p>it gives me text like </p>\n\n<blockquote>\n  <p>4723 N 63rd Dr$63,50008/17/201241.752,0747,6751972$360.11</p>\n</blockquote>\n\n<p>for each product which I can't analyze and store into differnt cells of Excel.</p>\n\n<p>So is there a way I can fetch the page data in a manageable way. I am ok if I need to traverse a loop for this. Also I can do additional processing to fill the row data into Excel properly.</p>\n\n<p>Thanks!</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":30,"score":-2,"question_id":13005518,"title":"How to convert dd/mm/yyyy into yyyy/mm/dd in excel 2003?","body":"<p>I am supposed to convert date format from <code>dd/mm/yyyy</code> or <code>dd/mm/yy</code> to <code>yyyy/mm/dd</code> in excel 2003, i think it is possible in excel 2007 by selecting <code>format-cell--&gt;custom date--&gt;yyyy/mm/dd</code>.</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":8758473,"title":"How can I share a cell value between two Excel documents?","body":"<p>I have two documents that should share a numeric value that should also increase by one after each time one of the documents are used.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>I open docA.xls and it should say 001.</li>\n<li>I'd like to be able to change it to 002 and save. </li>\n<li>When I open docB.xls, it should say 002, because docA's value is 002.  </li>\n</ul>\n\n<p>I'm pretty sure I can create a third spreadsheet that I could update to update the two cell values, but I'm wondering if there is a way to link cells other</p>\n\n<ol>\n<li>than having a formula that reads <code>=A1</code>. </li>\n<li>I realize I could have one workbook with three spreadsheets, as well.</li>\n</ol>\n\n<p>But what is the best way to accomplish this?</p>\n"},{"tags":["excel","windows-7","phpexcel"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":4466,"score":5,"question_id":5265719,"title":"Windows 7: \"Excel found unreadable content\"","body":"<p>I'm using PHPExcel to generate a very simple .xls file (<code>PHPExcel_IOFactory::createWriter($PHPExcel, 'Excel5')</code>). Whenever that file is opened on Windows 7 using Excel 2010 or 2007, I get the following error: </p>\n\n<p><em>Excel found unreadable content in 'XXXXXXX.xls'. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.</em></p>\n\n<p>When I open the same file in Excel 2010 in Windows XP it works fine. If I open the same file in OpenOffice, it works regardless of the OS.</p>\n\n<p>Windows 7 / Excel 2010: Error</p>\n\n<p>Windows 7 / Excel 2007: Error</p>\n\n<p>Windows XP / Excel 2010: Works</p>\n\n<p>Windows XP / Excel 2007: Works</p>\n\n<p>Any / OpenOffice: Works</p>\n\n<p>When I tell PHPExcel to generate an .xlsx file (<code>PHPExcel_IOFactory::createWriter($PHPExcel, 'Excel2007')</code>), it works fine with all the above combinaisons.</p>\n\n<p>I found countless threads on the MS forums, and it seems to affect only Windows 7 files with Excel files generated by third party libraries (not just PHPExcel). But no one has a solution.</p>\n\n<p>I also found the following MS KB article, but I'm not familiar with the underlying Excel specifications: <a href=\"http://support.microsoft.com/kb/2411912\" rel=\"nofollow\">http://support.microsoft.com/kb/2411912</a></p>\n\n<p>Has anyone else experienced this?</p>\n"},{"tags":["excel","multiple","labels"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":12738801,"title":"How can I put multiple QR codes in MS word?","body":"<p>I'm a teacher and running coach, and I could really use your help. I am trying to use data in an Excel format (columns of runner name, school, grade, and a link to a QR generator that uses that same information to generate a URL of an image of that specific QR code. <a href=\"http://chart.apis.google.com/chart?cht=qr&amp;chs=350x350&amp;chl=MECARD%3aN%3aCharles%20Adams;ORG%3aXYZ%20Co.;TEL:123456789;EMAIL%3aca@xyz.com;ADR:88%20Broad%20Street,%20New%20York,%20NY%2010004,%20USA;URL%3ahttp://www.xyz.com;NOTE%3achadams%20in%20twitter;;\" rel=\"nofollow\">See here for example.</a>). This would feed into a mail merge for labels in MS Word.</p>\n\n<p>The end product I'm looking for is a set of Avery labels with runner name, school, and a QR code. This way, each runner wears a specific label, and after they cross the finish line in a race, I can scan in their information with a QR code app on my phone. </p>\n\n<p>This would also have many uses for many of the teachers at my school: we could keep track of student items such as paperback books, folders, and assignments with these QR codes. </p>\n\n<p>Thank you kindly for any help you can provide!</p>\n\n<p>Best,</p>\n\n<p>Dave</p>\n"},{"tags":["excel","applescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12913289,"title":"How to create mulitple series in excel using apple script","body":"<p>I want to create a chart with multiple series in excel 2011 using apple script.</p>\n\n<pre><code>    tell application \"Microsoft Excel\"\n    tell worksheet \"Sheet1\" of active workbook\n        set obj to make new chart object at end with properties {left position:20, top:88, width:33, height:90}\n        set ochart to chart of obj\n        set chart type of ochart to column clustered\n        set series 1 of series collection to ochart\n        tell series 1\n            set xvalues to \"=Sheet1!$B$7:$B$10\"\n            set name to \"shartseries1\"\n        end tell\n    end tell\nend tell\n</code></pre>\n\n<p>In this script chart is created and chart type is set successfully, but chart series is not created.</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2704,"score":0,"question_id":5156951,"title":"How to create a macro to import any .txt file from a folder using excel?","body":"<p>i want to know how to create a macro in excel for importing any .txt file from a folder.</p>\n\n<p>I know how to create a button and how to affect a macro to it but the problem is for creating the macro.</p>\n\n<p>Each time i want to import a txt file i just want to click the button \nis it possible?\nThank you</p>\n"},{"tags":["excel","vba","loops","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":13002427,"title":"VBA Loop through multiple folders","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/9827715/get-list-of-subdirs-in-vba\">get list of subdirs in vba</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to apply the following code, which applies to running this VBA loop through all files in a folder, to make it run through all folders within one folder.</p>\n\n<p>Is there any way that this is possible?</p>\n\n<p>I have about 50 folders, each with the same named workbook, so I'd need to try and make it more efficient.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub LoopFiles()\n\n    Application.DisplayAlerts = False    \n    Dim strDir As String, strFileName As String\n    Dim wbCopyBook As Workbook\n    Dim wbNewBook As Workbook\n\n    strDir = \"C:\\Documents and Settings\\mburke\\Desktop\\Occupancy 2013\\\"\n    strFileName = Dir(strDir &amp; \"*.xlsm\")\n\n    Set wbNewBook = Workbooks.Add\n\n    Do While strFileName &lt;&gt; \"\"\n        Set wbCopyBook = Workbooks.Open(strDir &amp; strFileName)\n        wbCopyBook.Sheets(1).Copy Before:=wbNewBook.Sheets(1)\n        wbCopyBook.Close False\n        strFileName = Dir\n    Loop\n\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"},{"tags":["python","excel","twitter","tweepy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13002903,"title":"How to get tweepy output into Excel?","body":"<p>I'm a newbie in programming, but i hope you can help me with my problem. I'm trying to analyse tweets using tweepy/python/stream.api and R (the statistic program).</p>\n\n<p>Right know the stream listener is working, but I can't use the output...</p>\n\n<p>This is the script I'm running:</p>\n\n<pre><code>import tweepy\n\nconsumer_key=\"...\"\nconsumer_secret=\"...\"\naccess_key = \"...\"\naccess_secret = \"...\"\n\n\nauth = tweepy.OAuthHandler(consumer_key, consumer_secret)\nauth.set_access_token(access_key, access_secret)\napi = tweepy.API(auth)\n\nclass CustomStreamListener(tweepy.StreamListener):\n    def on_status(self, status):\n        print status.text\n\n    def on_error(self, status_code):\n        print &gt;&gt; sys.stderr, 'Encountered error with status code:', status_code\n        return True # Don't kill the stream\n\n    def on_timeout(self):\n        print &gt;&gt; sys.stderr, 'Timeout...'\n        return True # Don't kill the stream\n\nsapi = tweepy.streaming.Stream(auth, CustomStreamListener())\nsapi.filter(track=['...'])\n</code></pre>\n\n<p>As a result, I don't get the full tweets (only the first 50 characters), and I can't see the time when it was tweeted. How can i fix this, and is it possible to somehow \"print\" the output into an Excel file?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13001856,"title":"Collecting Average from multiple sheets in Vba","body":"<p>I need to calculate the average of a certain range (\"C2:C11\") from several worksheets into a new worksheet. The function should still work if a new sheet is added and data is entered into the specified range. </p>\n\n<p>So far I have this</p>\n\n<p>....</p>\n\n<pre><code>Sheets.Add\n\nDim myavg As Collection\nSet myavg = New Collection\n\nFor Each wsheet In Worksheets\n   myavg.Add wsheet.Range(\"B2:B11\")\nNext    \nFor i = 1 To myavg.Count\n   avg1 = Application.WorksheetFunction.Average(Range(\"B2:B11\"))\nNext\n\ncurColumn = 5\ncurRow = 4\n\nFor i = 1 To myavg.Count\n   ActiveSheet.Cells(curRow, curColumn).Value = avg1\n   curRow = curRow + 1\nNext  \n</code></pre>\n\n<p>...</p>\n\n<p>It returns one number into the desired range of the new sheet and its not accurate</p>\n\n<p>Please help me understand what I am doing wrong.\nThank you in advance.</p>\n"},{"tags":["c#","excel","jenkins","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12994470,"title":"Accessing Excel through a C# class library from Jenkins","body":"<p>I've written a Keyword Driven Framework using Selenium and NUnit in C#.  I'm using Excel to hold my test cases.  I'll eventually create a database and a UI, however for now, I want to show my team that it works.  NUnit and my program work as expected when run through the NUnit-GUI or the NUnit-Console.  I'm trying to port this over to Jenkins, however when I run it through the batch command as I would through the command prompt.  I get this error:</p>\n\n<pre><code>Tests Not Run:\n\n1) NotRunnable : SeleniumFramework.TestDriver.executeTest\n    System.Runtime.InteropServices.COMException : Microsoft Excel cannot access the file &gt; &gt; 'C:\\testSet.xlsx'. There are several possible reasons:\nThe file name or path does not exist.\nThe file is being used by another program.\nThe workbook you are trying to save has the same name as a currently open workbook.\n  at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)\n    at SeleniumFramework.Program.setupTestSet(String testSetFile) in C:\\Users\\AaronH\\Documents\\Visual Studio 2010\\Projects\\SeleniumFramework\\SeleniumFramework\\Program.cs:line 36\n    at SeleniumFramework.TestDriver.getTests() in C:\\Users\\AaronH\\Documents\\Visual Studio 2010\\Projects\\SeleniumFramework\\SeleniumFramework\\TestDriver.cs:line 54\n</code></pre>\n\n<p>I've checked, it's a good path, nothing is holding on to the file, and the Excel process is non-existent.  </p>\n\n<p>Now what I'm assuming is that because Jenkins is a service and not a user, that's where the issue lies.  If that's the case, I don't know how to solve it (either nobody else has posted about this or I'm terrible at Googling).  I've tried sharing the folder that the test case is located in, it did nothing as I expected.  If that's not the case, I am lost.</p>\n\n<p>I really don't want to have to move to ADO Connections for Excel.  I would much rather keep using the Excel.Application object.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12924294,"title":"Convert a Cell's Value/Formats to an HTML String in Excel with VBA","body":"<p>I have had this issue in multiple applications now and I am wondering if anyone has come up with a more efficient solution than mine. Essentially, my goal is to convert the content within a cell, to an HTML string to include all of its formatting. My workaround up to this point has been to loop through each character in the string to determine the font size, weight, and style, however, this can prove to be extremely slow when converting a lot of data at once.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13000851,"title":"VBA validation not working properly","body":"<p>I'm trying to return an error message if the <code>cbo_moduleName</code> field is empty once the <strong>submit</strong> button is clicked but nothing is happening. </p>\n\n<pre><code>Private Sub btnSubmit_Click()\n\n    If IsEmpty(cbo_moduleName.Value) Then\n        MsgBox (\"Module Name field empty!\")\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Any idea where I am making my mistake?</p>\n"},{"tags":["database","excel","templates","word"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12985003,"title":"Word / Excel templates that can grab information from a database","body":"<p>I work for a small company that uses simple word / excel templates to write memos/reports and similar documents. I'm looking for more information about how to accomplish this task.</p>\n\n<p>We would most likely need some sort of database to store all the necessary information (client name, contact info, etc...), and perhaps a series of sophisticated word and excel templates to extract information from the database. </p>\n\n<p>At this point I am simply researching possible ways to tackle this. Perhaps there is some Microsoft software (or other vendor) that has this functionality built in?</p>\n"},{"tags":["vb.net","excel","vba","dll","com"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":9890015,"title":"VB(A) Error when COM-DLL tries to instance NET-DLL object","body":"<p>Here is my challenge...  </p>\n\n<p>EXCEL-VBA opens a COM-DLL that -at one place- refers to a class from a another NET-DLL. When the COM-DLL tries to initialize an object from a class (in the NET-DLL), I get an error that the method <code>get_ContentTypeProperties</code> has no implementation. </p>\n\n<p><a href=\"http://i.stack.imgur.com/O6PGo.jpg\" rel=\"nofollow\">error message \"method [...] has no implementation\"</a>. </p>\n\n<p>I never created the method <code>get_ContentTypeProperties</code>, nor is it part of the interface I'm using.</p>\n\n<p>When accessing the COM-DLL via another DLL, to workaround EXCEL-VBA, it works properly.\nAny ideas?</p>\n\n<p><strong>UPDATE</strong>: Using a different class from the NET-Dll that implements _Worksheet Interface (not _Workbook Interface like in the original Problem) brings the same error message, but at least i found out that the \"not implemented\" method (PrintOutEx) being part of the Worksheet Interface from the Microsoft.Office.Tools.Excel Namespace. This interface is used by Visual Studio, with which i am creating my DLLs. But still...my NET-DLL is implementing the _Worksheet-Interface in the Microsoft.Office.Interop.Excel Namespace. <strong>Why is a method from an interface reported missing that i am not implementing?</strong></p>\n\n<p><strong>UPDATE</strong>:<br>\n1.) According to the <a href=\"http://i.stack.imgur.com/MHv7C.jpg\" rel=\"nofollow\">Process Monitor Results </a> i see that the proper DLL is addressed and that there is no interfering Version of the DLL loaded in the GAC, e.g.<br>\n2.) I - just in case - made Excel to refer to the .NET-Framework 2.xxx, on which all the involved DLLs are based on...same error again :(</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13000284,"title":"Make the second combo-box item selected based on item selection of first combo box","body":"<p>I'm trying to update the combo box <strong>cbo_moduleName</strong> based on the selection made in <strong>cbo_moduleCode</strong>. Right now the user has to select the combo box to make their selection but I want the first value found during the loop to be automatically filled \"on the fly\". Any idea on how I can achieve this? Here is my code so far:</p>\n\n<pre><code>Private Sub cbo_moduleCode_Change()\n\n    Dim lLoop As Long\n    ' Clear the comboboxes we are about to update\n    Me.cbo_moduleName.Clear\n\n    ' Loop through the worksheet and test each row\n    For lLoop = 1 To Sheets(\"lookupModule\").Range(\"A\" &amp; Sheets(\"lookupModule\").Rows.Count).End(xlUp).Row\n        ' If the row's column A matches the combobox then add the corresponding values to other combos\n        If Sheets(\"lookupModule\").Range(\"A\" &amp; lLoop).Value = Me.cbo_moduleCode.Value Then\n            Me.cbo_moduleName.AddItem Sheets(\"lookupModule\").Range(\"B\" &amp; lLoop).Value\n        End If\n    Next lLoop\n\nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel","windows-phone-7","skydrive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":12999796,"title":"Loading data from excel in windows phone 7","body":"<p>How can I load data from excel file (from skydrive) in windows phone 7 (c#)? I will just load, I do not need write in this file. And I need load just 2 coulombs if it can helps.</p>\n"},{"tags":["java","excel","excel-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":8857075,"title":"Why does org.apache.poi.hssf give wrong color with Excel 2007?","body":"<p>Why does org.apache.poi.hssf give the wrong color a cell which with Excel 2007? With the 2010 version there are no problem.</p>\n\n<p>Any idea for a fix/workaround?</p>\n\n<pre><code> final HSSFCellStyle cellStyle = (HSSFCellStyle) cell.getCellStyle();\n final HSSFColor backgroundColor = cellStyle.getFillForegroundColorColor();\n String theColor = ExcelToHtmlUtils.getColor( backgroundColor );\n</code></pre>\n\n<p>I  tried couple libraries but no luck. Only xlsgen gives good results but it is not open source, which I would prefer.</p>\n"},{"tags":["windows","excel","ole-automation"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3430,"score":0,"question_id":185524,"title":"Building MFC Automation example (to access Excel using OLE automation). Can't compile","body":"<p>I'm trying to build the example described at <a href=\"http://support.microsoft.com/kb/178749/EN-US/\" rel=\"nofollow\">http://support.microsoft.com/kb/178749/EN-US/</a>  in order to build an application that programatically accesses Excel using Automation.  I have Visual C++ 2005/Visual Studio 2005.  Some of the instructions don't exactly match up (classwizard, mostly), but the general idea seems to be the same.</p>\n\n<p>Problems: I don't end up with an excel.h file after using the \"new class\" to create my wrapper classes.  So I can' t #include that file as it specifies in step 13.  I do get a excel.tlh and an excel.tli in my windebug directory, but that doesn't seem to work.  I tried all orders for </p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"debug/excel.tli\"\n#include \"debug/excel.tlh\"\n</code></pre>\n\n<p>... including leaving one of those files out of the compile, but I still end up with a ton of compile errors.</p>\n\n<p>Here's the top 5 compile errors with the above #includes:</p>\n\n<pre><code>1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C2653: 'Adjustments' : is not a class or namespace name\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C2146: syntax error : missing ';' before identifier 'GetParent'\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C2433: 'IDispatchPtr' : 'inline' not permitted on data declarations\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(16) : error C3861: 'get_Parent': identifier not found\n</code></pre>\n\n<p>Here's the top 5 errors with these includes:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"debug/excel.tlh\"\n\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tlh(550) : error C3121: cannot change GUID for class 'IFilter'\n1&gt;        c:\\program files\\microsoft sdks\\windows\\v6.0\\include\\comdef.h(483) : see declaration of 'IFilter'\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tlh(1541) : error C2786: 'BOOL (__stdcall *)(HDC,int,int,int,int)' : invalid operand for __uuidof\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tlh(1541) : error C2923: '_com_IIID' : 'Rectangle' is not a valid template type argument for parameter '_Interface'\n1&gt;        c:\\program files\\microsoft sdks\\windows\\v6.0\\include\\wingdi.h(3667) : see declaration of 'Rectangle'\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tlh(1541) : error C3203: '_com_IIID' : unspecialized class template can't be used as a template argument for template parameter '_IIID', expected a real type\n</code></pre>\n\n<p>Here's the top 5 errors with these includes:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"debug/excel.tli\"\n\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C2653: 'Adjustments' : is not a class or namespace name\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C2146: syntax error : missing ';' before identifier 'GetParent'\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C2433: 'IDispatchPtr' : 'inline' not permitted on data declarations\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n1&gt;c:\\users\\sniles\\documents\\visual studio 2005\\source10\\testole\\testole\\debug\\excel.tli(14) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["php","excel","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":191,"score":0,"question_id":8520764,"title":"How to insert task list and dependencies among them in a .csv file to database?","body":"<p>I have an excel file in .csv format with task list.<br>\nI have an table for task_dependency where taskid and dependency id will be stored.<br>\nI want to add an additional column in my .csv file for dependency tasks with ne tasks list so that when i upload the file then tasks and their corresponding dependencies should be inserted to those tables.</p>\n"},{"tags":["excel","sorting","excel-vba"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1753,"score":3,"question_id":9469438,"title":"suggestions for a macro to find duplicates in a SINGLE column","body":"<p>found a lot of questions involving finding duplicates in two columns : </p>\n\n<p>i.e. \n<a href=\"http://stackoverflow.com/questions/2162684/ms-excel-how-to-create-a-macro-to-find-duplicates-and-highlight-them\">MS Excel how to create a macro to find duplicates and highlight them?</a> and <a href=\"http://stackoverflow.com/questions/7743273/excel-mark-duplicates-values\">excel mark duplicates values</a></p>\n\n<p>However I'm trying to adapt code to be used to find duplicates in one column. For example here is a data set: </p>\n\n<p>Column 1</p>\n\n<p>Foo <br>\nBar <br>\n23 <br>\n23 <br>\n12 <br>\nfoo <br>\nBar <br>\nbart <br></p>\n\n<p>This is what I'm using right now:</p>\n\n<pre><code>Function warnDupes()\n\nDim lastRow As Long\nDim dict As Object\n\n' Let Col be the column which warnDupes operates on.\nDim Col As String\n\nCol = \"A\"\n\nSet dict = CreateObject(\"scripting.dictionary\")\n\nlastRow = range(Col &amp; Rows.Count).End(xlUp).Row\n\nOn Error Resume Next\nFor i = lastRow To 1 Step -1\n    If dict.Exists(range(Col &amp; i).value) = True Then\n\n    'range(\"Y\" &amp; i).EntireRow.Delete\n\n    MsgBox (\"Hmm...Seems to be a duplicate of \" &amp; range(Col &amp; i).value &amp; _\n    \" in Cell \" &amp; Col &amp; i)\n\nEnd If\ndict.Add range(Col &amp; i).value, 1\nNext\n\nEnd Function\n</code></pre>\n\n<p>So far I've got some code that does 90% of the job. 23 and 23 are matched. Bar and Bar are matched. etc. So the code matches both Strings and Ints. But I'd like the macro to be able to match Foo and foo as a duplicate as well. How do I make Excel ignore case? </p>\n\n<p>This question ( <a href=\"http://stackoverflow.com/questions/1492048/function-for-detecting-duplicates-in-excel-sheet\">Function for detecting duplicates in Excel sheet</a> ) seems relevent but I'm having trouble adapting the code or understanding what the author did. Any improvements to the code, explanations or suggestions would be very much appreciated. </p>\n\n<p>Thanks.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Just noticed something really weird. </p>\n\n<p>The data: </p>\n\n<p>IB6061 <br>\nIC6071 <br></p>\n\n<p>are matched whether I use my Macro or if I use the Conditional Formatting tool in Excel. Any reason why? </p>\n"},{"tags":["excel","excel-vba","macros","worksheet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12997100,"title":"Excel VB This Active Worksheet","body":"<p>I'm sure this is really easy but I can't find any info on it.</p>\n\n<p>I've got a Excel macro which has things like:</p>\n\n<pre><code>    ActiveWorkbook.Worksheets(\"Data 21 Oct 12 11-05\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Data21 Oct 12 11-05\").Sort.SortFields.Add Key _\n    :=Range(\"W1:W23\"), SortOn:=xlSortOnValues, Order:=xlDescending, _\n    DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Data 21 Oct 12 11-05\").Sort\n    .SetRange Range(\"A1:BZ23\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>What I want to do is make this a global macro but the file name is hard coded in the macro. How can I change the code so it references \"this\" currently open file?</p>\n"},{"tags":["excel","file","multiple","add","cell"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":12997086,"title":"Add cell across multiple excel files","body":"<p>I have a directory of xls files, of which the filenames and quantities vary.\nI want to be able to open just one 'master' sheet and have the have the contents of cell A1 in each of those files added in to A1 of the master sheet.</p>\n\n<p>Is there a simple way of doing this in excel?</p>\n\n<p>Thank you.</p>\n"},{"tags":["excel","excel-formula","excel-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":286,"score":0,"question_id":9545935,"title":"EXCEL 2010 Replace value with ID if match other value","body":"<p>I have the following column:</p>\n\n<blockquote>\n  <blockquote>\n    <p><strong>A1</strong> TextOne</p>\n    \n    <p><strong>A2</strong> TextOne</p>\n    \n    <p><strong>A3</strong> TextTwo</p>\n    \n    <p><strong>A4</strong> TextTwo</p>\n    \n    <p><strong>A5</strong> TextOne</p>\n    \n    <p><strong>A6</strong> TextTwo</p>\n  </blockquote>\n</blockquote>\n\n<p>And other two columns:</p>\n\n<blockquote>\n  <blockquote>\n    <p><strong>B1</strong>  TextOne <strong>C1</strong>  10</p>\n    \n    <p><strong>B2</strong>  TextTwo <strong>C2</strong>  11 </p>\n  </blockquote>\n</blockquote>\n\n<p>I want to replace the text from column A with the ID from column C. This is the code I am using to get this value in other cell (let's say D column):</p>\n\n<pre><code>=IF(ISNA(VLOOKUP(A1,$B$1:$C$2,2,FALSE)),\"0\",VLOOKUP(A1,$B$1:$C$2,2,FALSE))\n</code></pre>\n\n<p>Where I am wrong?</p>\n"},{"tags":["html","excel","text"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":150,"score":0,"question_id":10959776,"title":"HTML vertical text in cell + export to excel","body":"<p>I have try to do this once, but unsuccessfully, and now meet the same problem again.</p>\n\n<p>I have to generate HTML table with vertical text like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/GmrnN.png\" alt=\"enter image description here\"> </p>\n\n<p>and this HTML should be valid(the same) in excel.</p>\n\n<p>Has anyone done this? </p>\n\n<p>Something more - I am not able to use images too.</p>\n"},{"tags":["excel","excel-formula"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12993265,"title":"Count number of cells with certain criteria","body":"<p>Unfortunately I need to use excel to solve an issue.</p>\n\n<p>I have a (huge) sheet with many columns.\nI need to create a summary of some sort.</p>\n\n<p>What I need to know is how to count the number of cells (in a column) with certain criteria.</p>\n\n<p>e.g:</p>\n\n<pre><code>              COL1       COL2     COL3\n----------------------------------------\nROW1          apple      food       AB\nROW2          apple      food       AB\n----------------------------------------\n</code></pre>\n\n<p>In the case above, if the criteria is apple,food,AB it would return 2. (the criteria will mainly be string matching inside the cell)</p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3296,"score":0,"question_id":9372630,"title":"Reading Excel sheet using POI's XSSF and SAX (Event API)","body":"<p>I am reading excel sheet using POI's XSSF and SAX (Event API). The excel sheet has thousands of rows of user information like username, email, address, age, department etc. </p>\n\n<p>I need to read each row from excel, convert it into a User object and add this user object to a List of user object. </p>\n\n<p>I can read excel successfully. But I am ot sure at what point while reading I should create an  instance of user object and populate it with the data from the excel sheet.</p>\n\n<p>Below is my entire working code.</p>\n\n<pre><code>        import java.io.File;\n    import java.io.FileOutputStream;\n    import java.io.IOException;\n    import java.io.InputStream;\n    import java.io.PrintStream;\n    import java.util.ArrayList;\n    import java.util.List;\n\n    import javax.xml.parsers.ParserConfigurationException;\n    import javax.xml.parsers.SAXParser;\n    import javax.xml.parsers.SAXParserFactory;\n\n    import org.apache.poi.openxml4j.exceptions.OpenXML4JException;\n    import org.apache.poi.openxml4j.opc.OPCPackage;\n    import org.apache.poi.openxml4j.opc.PackageAccess;\n    import org.apache.poi.ss.usermodel.BuiltinFormats;\n    import org.apache.poi.ss.usermodel.DataFormatter;\n    import org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable;\n    import org.apache.poi.xssf.eventusermodel.XSSFReader;\n    import org.apache.poi.xssf.model.StylesTable;\n    import org.apache.poi.xssf.usermodel.XSSFCellStyle;\n    import org.apache.poi.xssf.usermodel.XSSFRichTextString;\n    import org.xml.sax.Attributes;\n    import org.xml.sax.ContentHandler;\n    import org.xml.sax.InputSource;\n    import org.xml.sax.SAXException;\n    import org.xml.sax.XMLReader;\n    import org.xml.sax.helpers.DefaultHandler;\n\n    public class ExcelSheetParser {\n\n        enum xssfDataType {\n            BOOL, ERROR, FORMULA, INLINESTR, SSTINDEX, NUMBER,\n        }\n\n        int countrows = 0;\n\n        class XSSFSheetHandler extends DefaultHandler {\n\n            /**\n             * Table with styles\n             */\n            private StylesTable stylesTable;\n\n            /**\n             * Table with unique strings\n             */\n            private ReadOnlySharedStringsTable sharedStringsTable;\n\n            /**\n             * Destination for data\n             */\n            private final PrintStream output;\n\n            private List&lt;?&gt; list = new ArrayList();\n\n            private Class clazz;\n\n            /**\n             * Number of columns to read starting with leftmost\n             */\n            private final int minColumnCount;\n\n            // Set when V start element is seen\n            private boolean vIsOpen;\n\n            // Set when cell start element is seen;\n            // used when cell close element is seen.\n            private xssfDataType nextDataType;\n\n            // Used to format numeric cell values.\n            private short formatIndex;\n            private String formatString;\n            private final DataFormatter formatter;\n\n            private int thisColumn = -1;\n            // The last column printed to the output stream\n            private int lastColumnNumber = -1;\n\n            // Gathers characters as they are seen.\n            private StringBuffer value;\n\n            /**\n             * Accepts objects needed while parsing.\n             * \n             * @param styles\n             *            Table of styles\n             * @param strings\n             *            Table of shared strings\n             * @param cols\n             *            Minimum number of columns to show\n             * @param target\n             *            Sink for output\n             */\n            public XSSFSheetHandler(StylesTable styles,\n                    ReadOnlySharedStringsTable strings, int cols, PrintStream target, Class clazz) {\n                this.stylesTable = styles;\n                this.sharedStringsTable = strings;\n                this.minColumnCount = cols;\n                this.output = target;\n                this.value = new StringBuffer();\n                this.nextDataType = xssfDataType.NUMBER;\n                this.formatter = new DataFormatter();\n                this.clazz = clazz;\n            }\n\n            public void startElement(String uri, String localName, String name,\n                    Attributes attributes) throws SAXException {\n\n                if (\"inlineStr\".equals(name) || \"v\".equals(name)) {\n                    vIsOpen = true;\n                    // Clear contents cache\n                    value.setLength(0);\n                }\n                // c =&gt; cell\n                else if (\"c\".equals(name)) {\n                    // Get the cell reference\n                    String r = attributes.getValue(\"r\");\n                    int firstDigit = -1;\n                    for (int c = 0; c &lt; r.length(); ++c) {\n                        if (Character.isDigit(r.charAt(c))) {\n                            firstDigit = c;\n                            break;\n                        }\n                    }\n                    thisColumn = nameToColumn(r.substring(0, firstDigit));\n\n                    // Set up defaults.\n                    this.nextDataType = xssfDataType.NUMBER;\n                    this.formatIndex = -1;\n                    this.formatString = null;\n                    String cellType = attributes.getValue(\"t\");\n                    String cellStyleStr = attributes.getValue(\"s\");\n                    if (\"b\".equals(cellType))\n                        nextDataType = xssfDataType.BOOL;\n                    else if (\"e\".equals(cellType))\n                        nextDataType = xssfDataType.ERROR;\n                    else if (\"inlineStr\".equals(cellType))\n                        nextDataType = xssfDataType.INLINESTR;\n                    else if (\"s\".equals(cellType))\n                        nextDataType = xssfDataType.SSTINDEX;\n                    else if (\"str\".equals(cellType))\n                        nextDataType = xssfDataType.FORMULA;\n                    else if (cellStyleStr != null) {\n                        // It's a number, but almost certainly one\n                        // with a special style or format\n                        int styleIndex = Integer.parseInt(cellStyleStr);\n                        XSSFCellStyle style = stylesTable.getStyleAt(styleIndex);\n                        this.formatIndex = style.getDataFormat();\n                        this.formatString = style.getDataFormatString();\n                        if (this.formatString == null)\n                            this.formatString = BuiltinFormats\n                                    .getBuiltinFormat(this.formatIndex);\n                    }\n                }\n\n            }\n\n            public void endElement(String uri, String localName, String name)\n                    throws SAXException {\n\n                String thisStr = null;\n\n                // v =&gt; contents of a cell\n                if (\"v\".equals(name)) {\n                    // Process the value contents as required.\n                    // Do now, as characters() may be called more than once\n                    switch (nextDataType) {\n\n                    case BOOL:\n                        char first = value.charAt(0);\n                        thisStr = first == '0' ? \"FALSE\" : \"TRUE\";\n                        break;\n\n                    case ERROR:\n                        thisStr = \"\\\"ERROR:\" + value.toString() + '\"';\n                        break;\n\n                    case FORMULA:\n                        // A formula could result in a string value,\n                        // so always add double-quote characters.\n                        thisStr = '\"' + value.toString() + '\"';\n                        break;\n\n                    case INLINESTR:\n                        // TODO: have seen an example of this, so it's untested.\n                        XSSFRichTextString rtsi = new XSSFRichTextString(value\n                                .toString());\n                        thisStr = '\"' + rtsi.toString() + '\"';\n                        break;\n\n                    case SSTINDEX:\n                        String sstIndex = value.toString();\n                        try {\n                            int idx = Integer.parseInt(sstIndex);\n                            XSSFRichTextString rtss = new XSSFRichTextString(\n                                    sharedStringsTable.getEntryAt(idx));\n                            thisStr = '\"' + rtss.toString() + '\"';\n                        } catch (NumberFormatException ex) {\n                            output.println(\"Failed to parse SST index '\" + sstIndex\n                                    + \"': \" + ex.toString());\n                        }\n                        break;\n\n                    case NUMBER:\n                        String n = value.toString();\n                        if (this.formatString != null)\n                            thisStr = formatter.formatRawCellContents(Double\n                                    .parseDouble(n), this.formatIndex,\n                                    this.formatString);\n                        else\n                            thisStr = n;\n                        break;\n\n                    default:\n                        thisStr = \"(TODO: Unexpected type: \" + nextDataType + \")\";\n                        break;\n                    }\n\n                    // Output after we've seen the string contents\n                    // Emit commas for any fields that were missing on this row\n                    if (lastColumnNumber == -1) {\n                        lastColumnNumber = 0;\n                    }\n                    for (int i = lastColumnNumber; i &lt; thisColumn; ++i)\n                        output.print(',');\n\n                    // Might be the empty string.\n                    output.print(thisColumn +\" : \"+thisStr);\n\n                    // Update column\n                    if (thisColumn &gt; -1)\n                        lastColumnNumber = thisColumn;\n\n                } else if (\"row\".equals(name)) {\n\n                    // Print out any missing commas if needed\n                    if (minColumns &gt; 0) {\n                        // Columns are 0 based\n                        if (lastColumnNumber == -1) {\n                            lastColumnNumber = 0;\n                        }\n                        for (int i = lastColumnNumber; i &lt; (this.minColumnCount); i++) {\n                            output.print(',');\n                        }\n                    }\n\n\n\n                    // We're onto a new row\n\n                    output.println();\n                    output.println(countrows++);\n                    lastColumnNumber = -1;\n\n                }\n\n            }\n\n            /**\n             * Captures characters only if a suitable element is open. Originally\n             * was just \"v\"; extended for inlineStr also.\n             */\n            public void characters(char[] ch, int start, int length)\n                    throws SAXException {\n                if (vIsOpen)\n                    value.append(ch, start, length);\n            }\n\n            /**\n             * Converts an Excel column name like \"C\" to a zero-based index.\n             * \n             * @param name\n             * @return Index corresponding to the specified name\n             */\n            private int nameToColumn(String name) {\n                int column = -1;\n                for (int i = 0; i &lt; name.length(); ++i) {\n                    int c = name.charAt(i);\n                    column = (column + 1) * 26 + c - 'A';\n                }\n                return column;\n            }\n\n        }\n\n        // /////////////////////////////////////\n\n        private OPCPackage xlsxPackage;\n        private int minColumns;\n        private PrintStream output;\n        private Class clazz;\n\n        /**\n         * Creates a new XLSX -&gt; CSV converter\n         * \n         * @param pkg\n         *            The XLSX package to process\n         * @param output\n         *            The PrintStream to output the CSV to\n         * @param minColumns\n         *            The minimum number of columns to output, or -1 for no minimum\n         */\n        public ExcelSheetParser(OPCPackage pkg, PrintStream output, int minColumns, Class clazz) {\n            this.xlsxPackage = pkg;\n            this.output = output;\n            this.minColumns = minColumns;\n            this.clazz = clazz;\n\n        }\n\n        /**\n         * Parses and shows the content of one sheet using the specified styles and\n         * shared-strings tables.\n         * \n         * @param styles\n         * @param strings\n         * @param sheetInputStream\n         */\n        public void processSheet(StylesTable styles,\n                ReadOnlySharedStringsTable strings, InputStream sheetInputStream)\n                throws IOException, ParserConfigurationException, SAXException {\n\n            InputSource sheetSource = new InputSource(sheetInputStream);\n            SAXParserFactory saxFactory = SAXParserFactory.newInstance();\n            SAXParser saxParser = saxFactory.newSAXParser();\n            XMLReader sheetParser = saxParser.getXMLReader();\n            ContentHandler handler = new XSSFSheetHandler(styles, strings,\n                    this.minColumns, this.output, this.clazz);\n            sheetParser.setContentHandler(handler);\n            sheetParser.parse(sheetSource);\n        }\n\n        /**\n         * Initiates the processing of the XLS workbook file to CSV.\n         * \n         * @throws IOException\n         * @throws OpenXML4JException\n         * @throws ParserConfigurationException\n         * @throws SAXException\n         */\n        public void process() throws IOException, OpenXML4JException,\n                ParserConfigurationException, SAXException {\n\n            ReadOnlySharedStringsTable strings = new ReadOnlySharedStringsTable(\n                    this.xlsxPackage);\n            XSSFReader xssfReader = new XSSFReader(this.xlsxPackage);\n\n            StylesTable styles = xssfReader.getStylesTable();\n            XSSFReader.SheetIterator iter = (XSSFReader.SheetIterator) xssfReader\n                    .getSheetsData();\n            int index = 0;\n            while (iter.hasNext()) {\n                InputStream stream = iter.next();\n                String sheetName = iter.getSheetName();\n                this.output.println(sheetName + \" [index=\" + index + \"]:\");\n                processSheet(styles, strings, stream);\n                stream.close();\n                ++index;\n            }\n        }\n    }\n</code></pre>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12966330,"title":"Compare to columns, identify duplicates in a 3rd column","body":"<p>Excel 2003 / Windows XP</p>\n\n<p>I have two columns of email addresses, A with 13,000 entries and B with 6000 entries. I need to compare B with A and identify emails in B that are not found in A. So that I end up with a list of all those emails from B somehow. </p>\n\n<p>Thanks</p>\n"},{"tags":["excel","excel-formula","excel-2010","conditional-formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12994844,"title":"Conditional Formatting A Row In Excel Based on Date in One Cell","body":"<p>I am working on a spreadsheet and I would like to apply my conditional formatting to the entire row as opposed to one cell.  Currently, it is set so that if the date in L2 is greater than 180 from today's date it will highlight green, if it is less than 90 days it will highlight red and if it is greater than 90 days but less than 180 it will turn yellow.  I would like to apply that to the entire row based on the one cell.  Please HELP!</p>\n"},{"tags":["excel","vba"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12981033,"title":"VBA Run-time error -214724809 (80070057)","body":"<p>I want fill a drop down list based on user selection in another. I'm trying to update the contents of a field based on selection in another by adding the items on the fly once the first combobox (cbo_park) is selected.</p>\n\n<p>I have a four drop down lists:</p>\n\n<p>The first drop down <strong>cbo_park</strong> has the following options:</p>\n\n<pre><code>Central\nEast\nWest\n</code></pre>\n\n<p>I have a second workbook called <strong>lookupRoom</strong> which contains the following table:</p>\n\n<pre><code>roomCode    park\nA.0.01      Central \nA.2.01      Central \nA.3.01      Central \nHE.0.10     East\nHE.0.21     East\nHE.0.22     East\nKG.1.07     West\nKG.1.09     West\nKG.1.10     West\n</code></pre>\n\n<p>When the user selects the Central park option under the first drop down <strong>cbo_park</strong> I only want rooms in the Central park to be displayed in dropdown <strong>cbo_prefRoom1</strong>, <strong>cbo_prefRoom2</strong> and <strong>cbo_prefRoom3</strong>. How would I go about achieving this?</p>\n\n<p>Please find below my attempts so far. I keep receiving an error at the line: <code>Me.cbo_prefRoom1.RemoveItem 0</code>.</p>\n\n<pre><code>Private Sub cbo_park_Change()\n\nDim lLoop As Long, rgLoop As Range\n\n    For lLoop = 1 To Me.cbo_park.ListCount\n\n        Me.cbo_prefRoom1.RemoveItem 0\n\n    Next lLoop\n\n    Sheets(\"lookupRoom\").[a1].CurrentRegion.AutoFilter\n    Sheets(\"lookupRoom\").[a1].CurrentRegion.AutoFilter Field:=3, Criteria1:=Left(Me.cbo_park.Value, 2)\n\n    For Each rgLoop In Sheets(\"lookupRoom\").[a1].CurrentRegion.Offset(1).SpecialCells(xlCellTypeVisible).Columns(1).Cells\n        If Len(rgLoop) &gt; 0 Then\n            Me.cbo_prefRoom1.AddItem rgLoop\n        End If\n    Next rgLoop\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":68,"score":-2,"question_id":12991311,"title":"Checking for multiple values in a cell to output multiple texts in another","body":"<p>cell <code>A1</code> = <code>10,21,34,23,45,67</code></p>\n\n<p>Need a formula in cell <code>A2</code> that does the following:</p>\n\n<p>Check if <code>A1</code> contains 10, if yes, then \"Coca Cola\"<br>\nAlso check if <code>A1</code> contains 21, if yes, then <em>append</em> \"Pepsi\"<br>\nAlso check if <code>A1</code> contains 34, if yes, then <em>append</em> \"7Up\"<br>\nAlso check if <code>A1</code> contains 23, if yes, then <em>append</em> \"Sprite\"<br>\nAlso check if <code>A1</code> contains 45, if yes, then <em>append</em> \"Fanta\"<br>\nAlso check if <code>A1</code> contains 67, if yes, then <em>append</em> \"Gatorade\"<br>\nAlso check if <code>A1</code> contains 99, if yes, then <em>append</em> \"Red Bull\"<br>\n...<br>\nAnd so on.  </p>\n\n<p>So the output of cell <code>A2</code> for the example values above would be something like:</p>\n\n<p><code>Coca Cola , Pepsi , 7Up , Sprite , Fanta , Gatorade</code></p>\n\n<p>Note that the output values are separated by a <code>\" , \"</code> (i.e. <code>&lt;space&gt; comma &lt;space&gt;</code>)<br>\nIs this possible as a formula in 1 cell?  There are about 20 values to check for.</p>\n"},{"tags":["asp.net","vb.net","excel","export-to-excel"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1448,"score":1,"question_id":7760680,"title":"Excel file \"Open\" \"Save As\" dialog box not showing in asp.net","body":"<p>I have searched S/O, but unable to find a solution that helps my problem. I am exporting data to an xls file from my asp.net application. I need to display the Open / Save As / Cancel dialog box when the user clicks \"Export Data\" button.  </p>\n\n<p>How do I accomplish that?  </p>\n\n<pre><code>        oSheet = Nothing\n        oRange = Nothing\n        oWB.SaveAs(sFileName.ToString())\n        oWB.Close()\n        oWB = Nothing\n        oXL.Quit()\n</code></pre>\n"},{"tags":["php","javascript","html","database","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":55,"score":-4,"question_id":12993618,"title":"Converting excel spreadsheet with formulas in web application?","body":"<p>I have an Excel spreadsheet which calculates a total amount based on numerous formulas. What would be the best way to convert this into a web application? Considering there are several calculations. I have not done anything like this before.</p>\n\n<p>Many Thanks</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":171,"score":2,"question_id":12986520,"title":"Excel VBA - Remove blank rows in table","body":"<p>I'm trying to run a macro that selects blank cells in a table column and deletes the entire row. </p>\n\n<p>The script below does everything except the deleting part, which prompts a <code>run-time error 1004 - \"Delete method of Range class failed\"</code>.</p>\n\n<p>Any ideas how to fix this problem? Thanks</p>\n\n<pre><code>Sub test()\nRange(\"Table1[[New]]\").Activate\nSelection.SpecialCells(xlCellTypeBlanks).Select\nSelection.EntireRow.Delete\nEnd Sub\n</code></pre>\n"},{"tags":["excel","text","formatting","excel-2007","autocorrect"],"answer_count":10,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":8086,"score":10,"question_id":2420931,"title":"Stop Excel from changing cell contents, ever","body":"<p>I work with card numbers, like credit card and ID numbers. We do not do any calculations with card numbers, obviously. They are \"text.\"</p>\n\n<p>I format them as text, I type them like text. I know how that works. Excel doesn't care. 16 digit card numbers get their last digit turned into a zero, changed into scientific notation, stupid stuff that I did not tell Excel to do.</p>\n\n<p>I need to do things like Find/Remove spaces from cells in files downloaded from our currently imperfect web-system. The system sends me files with 16 digit numbers, cells formatted as text, but due to bugs there are spaces at the end. I do Find/Remove all spaces and all my card numbers are transformed into scientific notation and the last digit turned into a 0. THEY ARE TEXT, they are formatted as text, I yelled into the screen that they are text, why does Excel refuse to acknowledge that they are text? (I would rather find a way to stop Excel's action than find a way to tell our programmers to put an apostrophe in every cell)</p>\n\n<p>How do I make it so that Excel just STOPS doing anything that I didn't tell it to do? Or at least stop it from doing anything to numbers it doesn't like. Maybe I can write a macro for whenever it discovers \"Uhoh I should change that number to something different!\" I'll make it format that cell to text a thousand times instead.</p>\n\n<p>Give me an error when I try calculating with a number larger than 15 digits, make my computer explode violently, that's fine. Just stop changing the numbers.</p>\n\n<p>Is it possible? I have many thousands of numbers that need changing in many different scenarios. I just want to stop it from trying to help. I can't understand why that would be difficult. I have 2007, but answers for other versions would be great as well.</p>\n\n<p>Thank you!</p>\n"},{"tags":["asp.net-mvc-3","excel","mvc","interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12985769,"title":"Return Excel file as result from MVC","body":"<ol>\n<li>If I opt for using Interop, does it require to have Excel installed on server-side?</li>\n<li>Are there any additional reasons why not to use Interop?</li>\n<li>Should I go for <code>System.Web.UI.WebControls.GridView</code> server-side solution, populate it and write it in result?</li>\n<li>Any other intelligent solution that preserves MVC logic and features?</li>\n</ol>\n"},{"tags":["python","excel","api","bloomberg"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":664,"score":0,"question_id":9024056,"title":"How to implement excel BDP() function with Bloomberg API?","body":"<p>I'm not familiar with either BDP() or api. I'm just wondering if there is any easy and elegant way to implement this excel function with Bloomberg API? Thanks!  (any language is fine although python is preferred)</p>\n"},{"tags":["php","excel"],"answer_count":4,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":7163,"score":2,"question_id":1558425,"title":"Create Excel chart programmatically in PHP","body":"<p>Do you have any idea on how to create a chart in an Excel sheet programmatically from PHP ?</p>\n\n<p>I know you can invoke the Excel COM object, but the server is running on a Linux machine...</p>\n\n<p>I already use the excellent PHPExcel library but they do not offer the option to create charts.</p>\n\n<p>Thanks !</p>\n"},{"tags":["c#","wcf","excel","ado.net"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2528,"score":0,"question_id":9313066,"title":"How to insert (bind) DataTable to Excel Workbook (VS Excel 2010 Workbook Project)","body":"<p>I have <code>WCF Service</code> that returns data as <code>DataTable</code> type. I want to insert this data into Excel workbook in the <code>Workbook_Startup</code> event.</p>\n\n<p>What is the best way to do it?</p>\n\n<p>(VS .NET 3.5 Excel 2010 Workbook Project)</p>\n\n<hr>\n\n<p>WCF Service code:</p>\n\n<pre><code>public DataTable GetQuarterTargetAchievement()\n{\n    var dt = new DataTable(\"TargetAchievement\");\n\n    using (var conn = new SqlConnection(GetConnectionString()))\n    {\n        using (var da = new SqlDataAdapter(\"SELECT fld1, fld2, ... , fldN FROM dbo.ReportTable; \", conn))\n        {\n            da.Fill(dt);\n        }\n    }\n\n    return dt;\n}\n</code></pre>\n\n<hr>\n\n<p>Client code:</p>\n\n<pre><code>var dt = proxy.GetQuarterTargetAchievement();\n</code></pre>\n"},{"tags":["excel","vba","range"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12985634,"title":"Copying data into Range name in excel 2007 via vba","body":"<p>If I populate an object in vba with 10 values, and paste it into a range that has been defined to be 200 rows long, will these 10 values be copied over and over again in the predefined range?</p>\n\n<p>note: the populating and pasting is done via vba code, and the range is defined in excel.</p>\n\n<p>this seems to be happening in excel vba 2007, but not in 2010. need to fix the 2007 problem. would appreciate your input..</p>\n\n<p>thanks in adv!</p>\n"},{"tags":["excel","query"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":2286382,"title":"Write Queries on Excel sheet in c#","body":"<p>I want to update specific row of excel sheet from my asp.net application. I m able to read excel, but how can i update the records.Can i write Update query . How . please send me code:</p>\n\n<pre><code>        string strQuery = \"UPDATE [Sheet1$]  SET Child Name=\" + \"\\\"\" + strDataToUpdate[0] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Point Name=\" + \"\\\"\" + strDataToUpdate[1] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Bus No=\" + \"\\\"\" + strDataToUpdate[2] + \"\\\",\";\n        strQuery = strQuery + \"Pickup Bus Time=\" + \"\\\"\" + strDataToUpdate[3] + \"\\\",\";\n        strQuery = strQuery + \"Drop Down Point Name=\" + \"\\\"\" + strDataToUpdate[4] + \"\\\",\";\n        strQuery = strQuery + \"Drop Bus No=\" + \"\\\"\" + strDataToUpdate[5] + \"\\\",\";\n        strQuery = strQuery + \"Drop Down Bus Time=\" + \"\\\"\" + strDataToUpdate[6] + \"\\\",\";\n        strQuery = strQuery + \"Parent Name=\" + \"\\\"\" + strDataToUpdate[7] + \"\\\",\";\n        strQuery = strQuery + \"Mobile 1=\" + \"\\\"\" + strDataToUpdate[8] + \"\\\",\";\n        strQuery = strQuery + \"Mobile 2=\" + \"\\\"\" + strDataToUpdate[9] + \"\\\",\";\n        strQuery = strQuery + \"Email ID 1=\" + \"\\\"\" + strDataToUpdate[10] + \"\\\",\";\n        strQuery = strQuery + \"Email ID 2=\" + \"\\\"\" + strDataToUpdate[11] + \"\\\",\";\n        strQuery = strQuery + \"Service Mode=\" + \"\\\"\" + strDataToUpdate[12] + \"\\\",\";\n        strQuery = strQuery + \"WHERE Child Id=\" + strDataToUpdate[13];\n</code></pre>\n\n<p>This Query i am using giving Syntax error.Please guide</p>\n"},{"tags":["php","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":274,"score":2,"question_id":9931149,"title":"php export to excel not showing gridlines","body":"<p>I have this code </p>\n\n<pre><code>&lt;?php\nheader(\"Content-type: application/vnd.ms-excel; name='excel'\");\n\nheader(\"Content-Disposition: filename=export.xls\");\n// Fix for crappy IE bug in download.\nheader(\"Pragma: \");\nheader(\"Cache-Control: \");\necho $_REQUEST['datatodisplay'];\n?&gt;\n</code></pre>\n\n<p>It puts the data from a html table into excel, but the only problem is that i don`t see the gridline in the sheet. Am i missing something? Thanks</p>\n"},{"tags":["ruby","excel","csv","fastercsv"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12977544,"title":"CSV file with carriage returns in a column generated using Ruby CSV returns square character in Excel","body":"<p>I've got a script that generates and emails a CSV file to a number of users who are on Windows. One of the columns has line breaks within it, and when I open the generated file I get square boxes before the line breaks. Here's an example in code of what I'm trying to do:</p>\n\n<pre><code>CSV.open(\"/tmp/reports.csv\", \"w\") do |csv|\n  csv &lt;&lt; [\"Date\", \"Description\", \"Comments\", \"Status\"]\n  csv &lt;&lt; [\"Foo\",\"Bar\",\"This\\r\\n is \\r\\n where \\r\\n my \\r\\n linebreaks \\r\\n are,\"Baz\"]\nend\n</code></pre>\n\n<p>I've tried any number of linebreak and encoding combinations I can think of, but no joy. I suspect it's related to <a href=\"http://support.microsoft.com/kb/210372\" rel=\"nofollow\">this issue</a>, but the solution involves doing something after the import, which I'd rather not saddle my users with, especially as I'm not dealing with technical users here.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","excel","string-formatting"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":452,"score":0,"question_id":10333923,"title":"How to convert the column number format of a excel sheet in c# dynamically?","body":"<p>I am exporting some fields to an excel sheet in c#. All but one column are coming correctly, but in that column I need to export the value 0 to 0.00 format. </p>\n\n<p>When my code behind code is running I am appending the value to a stringBuilder object as 0.00 format, but when I opened that exported document it shows the value as 0. Then I must change the column number format in the excel sheet and change the number format by selecting the type 12.3323. </p>\n\n<p>I don't want to do it like this. I want to define the column number format dynamically in c# code behind file.</p>\n\n<p>How can I do this? Please suggest me if you know.</p>\n"},{"tags":["c#",".net","excel","com","excel-2003"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":477,"score":1,"question_id":4806248,"title":"COMException 0x800A03EC when setting axis title","body":"<p>When exporting data to excel via COM Interop I get an error (code 0x800A03EC) when trying to set the AxisTitle.Text property. This happens ONLY on one specific computer with Windows 7 x64 Professional and Excel 2003. I've tried it on a variety of different PCs (incuding Win7 x64 Professional + Excel 2003) but can't reproduce that error on any other machine. </p>\n\n<pre><code>private static void setAxisTitle(_Chart tChart, string aszTimeUnit)\n    {\n        Axis tAxis = (Axis)tChart.Axes(XlAxisType.xlValue, XlAxisGroup.xlPrimary);\n        try\n        {\n            tAxis.HasTitle = true;\n            tAxis.AxisTitle.Text = \"Messwert [um/m]\";\n            tAxis = (Axis)tChart.Axes(XlAxisType.xlCategory, XlAxisGroup.xlPrimary);\n            tAxis.HasTitle = true;\n            tAxis.AxisTitle.Text = string.Format(\"Zeit [{0}]\", aszTimeUnit);\n        }\n        catch (Exception aEx)\n        {\n            cLogger.ErrorFormat(\"error setting axis title for time unit '{0}' on Axis '{1}'\", aszTimeUnit, tAxis.AxisTitle);\n            cLogger.Error(\"error stack trace:\", aEx);\n            throw;\n        }\n    }\n</code></pre>\n\n<p>Someone got any idea how to solve this dilemma? </p>\n\n<p>EDIT: \nOn the topic of differing cultures: \nBoth OS and Excel have the same culture. \nHOWEVER, I (think I) do handle any problems that may arise from this with the following code: </p>\n\n<pre><code> static Excel2007Export()\n    {\n        Microsoft.Office.Interop.Excel.Application tExcel = new Application();\n        cSystemCulture = Thread.CurrentThread.CurrentCulture;\n        cExcelCulture = new CultureInfo(tExcel.LanguageSettings.get_LanguageID(\n            Microsoft.Office.Core.MsoAppLanguageID.msoLanguageIDUI));\n\n        try\n        {\n            Thread.CurrentThread.CurrentCulture = cExcelCulture;\n            int tVersion;\n            bool tParseSucceded = Int32.TryParse(tExcel.Version.Substring(0, tExcel.Version.IndexOf('.')), out tVersion);\n\n            // 12 is the first version with .xlsx extension\n            if (tVersion &gt;= 12)\n                cDefaultExtension = \".xlsx\";\n            else\n                cDefaultExtension = \".xls\";\n\n        }\n        catch (Exception aException)\n        {\n            cLogger.Debug(\"error retrieving excel version.\", aException);\n            cLogger.Error(\"error retrieving excel version.\");\n        }\n        finally\n        {\n            Thread.CurrentThread.CurrentCulture = cSystemCulture;\n        }\n    }\n</code></pre>\n"},{"tags":["c#","winforms","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2547,"score":0,"question_id":3781389,"title":"Import Excel to datatable","body":"<p>I am using syncfusion to import excel to datattable.when the datat is imported to datatable the columns are all strings .how to convert these columns to specific datatype?how do i validate the column data type?</p>\n\n<pre><code>using Syncfusion.XlsIO;\n\nprivate void btnImport_Click(object sender, EventArgs e)\n        {\n            ImportExcelFile();\n        }\n private void ImportExcelFile()\n        {\n            try\n            {\n                string strFileName = \"\";\n                OpenFileDialog openFileDialog = new OpenFileDialog();\n\n                openFileDialog.Filter = \"Files (*.xls)|*.xls|(*.xlsm)|*.xlsm\";\n                openFileDialog.DefaultExt = \".xls\";\n                if (openFileDialog.ShowDialog() == DialogResult.OK)\n                {\n                    strFileName = openFileDialog.FileName;\n                    #region Get Correct Worksheet in excel file\n                    DateTime dtStart = DateTime.Now;\n                    ExcelEngine excelEngine = new ExcelEngine();\n                    IApplication application = excelEngine.Excel;\n                    IWorkbook workbook = application.Workbooks.Open(strFileName);\n                    IWorksheet sheet = workbook.Worksheets[0];\n                    #endregion                \n\n\n                    DataTable dt = sheet.ExportDataTable(sheet.UsedRange, ExcelExportDataTableOptions.ColumnNames);\n\n                  dgIDCImport.GridDataSource(dt,ucGrid.GridTypes.IDCImport);\n\n                    //Close the workbook.\n                    workbook.Close();\n\n                    //No exception will be thrown if there are unsaved workbooks.\n                    excelEngine.ThrowNotSavedOnDestroy = false;\n                    excelEngine.Dispose();\n\n\n\n                }\n            }\n\n            catch (Exception err)\n            {\n                base.DisplayError(err);\n            }\n        }\n</code></pre>\n"},{"tags":["linux","excel","bash","script"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":101,"score":0,"question_id":12942209,"title":"Script to convert an output into an Excel sheet","body":"<p>I have file which contains the following data:</p>\n\n<pre><code>-------------------[ server10 ]-------------------\nuser1\nuser2\nuser99\nuser100\n-------------------[ server20 ]-------------------\nuser1\nuser2\nuser10\nuser4\n-------------------[ server30 ]-------------------\nuser10\nuser30\nuser40\n</code></pre>\n\n<p>I want to convert this output into Excel sheet, so that I can present ti to my management. Any idea how can do that???  </p>\n\n<p>I want the output into the following format in the Excel sheet:</p>\n\n<pre><code>Hostname            users\nserver10            user1\n                    user2\n                    user99\n                    user100\nserver20            user2\n                    user10\n                    user4 \n...\n...\n</code></pre>\n\n<p>Till here \"David\" helped me with Python (openpyxl). but here i have new column (Last Logon time) which i want to add in excel so here is the example.</p>\n\n<pre><code>    -------------------[ server10 ]-------------------\n    user1\n    never\n    user2\n    Oct 17, 2011\n    user99\n    Jan 01, 2007\n    user100\n    Feb 02, 2010\n    -------------------[ server20 ]-------------------\n    user1\n    never\n    user2\n    never\n    user10\n    jul 17, 2001\n    user4\n    Dec 25, 1999\n    -------------------[ server30 ]-------------------\n    user10\n    Aug 10, 2012\n    user30\n    never\n    user40\n    never\n</code></pre>\n\n<p>In excel it would be like.</p>\n\n<pre><code> Hostname            users           Last logon\n    server10            user1            never\n                        user2            Oct 17, 2011\n                        user99           ...\n                        user100          ...\n    server20            user2\n                        user10\n                        user4 \n    ...\n    ...\n</code></pre>\n\n<p>Notes: username could be different here i gave you example userX but it would be spatel, jim, eric etc...</p>\n"},{"tags":["c#","excel","combobox","syncfusion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":160,"score":0,"question_id":8857177,"title":"Combobox in Syncfusion XlsIO","body":"<p>Hi I am new with Syncfusion product,\nI need to get the values of combobox created in excel file\nI found \nIComboBoxShape that contains  SelectedValue and  SelectedIndex\nBut not all the values.</p>\n\n<p>Should I use another thing</p>\n\n<p>here is my code</p>\n\n<pre><code>   var xlApp = xl.Excel;\n  var wkbk = xlApp.Workbooks.Open(stream); \n var sheet1 = kbk.Worksheets[0];  \nvar combobox = sheet1.ComboBoxes[0];\n</code></pre>\n\n<p>and after that? What should I do???</p>\n"},{"tags":["excel","excel-vba","excel-2003"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12961794,"title":"How to copy part of dynamic tables in excel based on an id?","body":"<p>I have 2 dynamics tables in a worksheet</p>\n\n<pre>\n    projectId | start    | end      | employee | name | amount\n    ----------------------------------------------------------\n    5013-001  | 12-01-01 | 13-01-01 |  001     | bob  | 100 $\n                                    |  021     | foo  | 200 $\n                                    |  101     | bar  | 300 $\n                                    |  111     | luc  | 300 $\n    ----------------------------------------------------------\n    total 5013-001                                      900 $\n    ----------------------------------------------------------\n    5013-002  | 12-01-01 | 13-01-01 |  001     | bob  | 150 $\n                                    |  021     | foo  | 205 $\n    ----------------------------------------------------------\n    total 5013-002                                      355 $\n\n    --Snip--\n</pre>\n\n<pre>\n    projectId | expenseCode     | total\n    ---------------------------------------\n    5013-001   | T01 Summary      | 4504$\n               | D01 Summary      |  204$\n    total 5013-001                | 4708$\n    ---------------------------------------\n    5013-002   | T01 Summary      | 1007$\n    total 5013-002                | 1007$\n\n    --Snip--\n</pre>\n\n<p>expected result : </p>\n\n<pre>\n    projectId | start    | end      | employee | name | amount\n    ----------------------------------------------------------\n    5013-001  | 12-01-01 | 13-01-01 |  001     | bob  | 100 $\n                                    |  021     | foo  | 200 $\n                                    |  101     | bar  | 300 $\n    ----------------------------------------------------------\n    total 5013-001                                      600 $\n    ----------------------------------------------------------\n\n    projectId | expenseCode     | total\n    ---------------------------------------\n    5013-001   | T01 Summary      | 4504$\n               | D01 Summary      |  204$\n    total 5013-001                | 4708$\n    ---------------------------------------\n\n    --page break--\n</pre>\n\n<p>How would you proceed to have both tables filtered by projectId, each on one page? (number of columns is fix, but not rows!)</p>\n\n<p>I'm guessing a macro but I though there might something simpler.</p>\n\n<p>If I should indeed use a macro, is the engine powerful enough? I never coded excel macro, so I'll gladly take any tips/references.</p>\n\n<p>One last <em>subjective</em> question : Do you think this problem is solvable in ~1 workday?</p>\n"},{"tags":["c#","excel","openxml","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12981632,"title":"Programmatically set a sheet's format to text before reading the cell contents","body":"<p>I have a requirement to read the contents of an excel sheet,write to it and allow for editing and re-importing. The problem I am having is that when user enters a number into the cells in the sheet, the numbers are, on the back, considered indexes on the SharedString table, an effect I do not need. What I would like to do is force the cells in the worksheet to be formatted as text before going ahead to read it. I believe that way, I am sure that my numbers will be treated as Strings. How do I accomplish this please? </p>\n\n<p>I would appreciate examples using the OPENXML library to solve this problem please. </p>\n"},{"tags":["arrays","excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12979034,"title":"Multiplying arrays with scalars and adding in VBA","body":"<p>I have two columns of data in an excel sheet that are equal in size and both only contain numbers.  </p>\n\n<p>I'm trying to write a macros which will put both of these sets  into arrays, then perform a calculation on them. Specifically <code>ArrayA + 3*ArrayB</code> then put the result back into the worksheet in a new column.  Below is the code I have so far.  </p>\n\n<pre><code>Dim ArrayA As Variant\nDim ArrayB As Variant\nDim ArrayC As Variant\n\nArrayA = Worksheets(\"Sheet1\").Range(\"A1:A5\")\nArrayB = Worksheets(\"Sheet1\").Range(\"B1:B5\")\n\n'this is where things go bad\nArrayC = ArrayA + 3 * ArrayB\n</code></pre>\n"},{"tags":["sql","sql-server","excel","ssis"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12981683,"title":"How do I run data flow task successfully if certain files in the data flow doesn't exist","body":"<p>I have a data flow task that imports excel files. I cant use a for each loop to go through the excel files as the metadata for each excel file is completely different.</p>\n\n<p>So in the data flow task I have 10 separate source files and use a union component to combine them then import it to SQL. </p>\n\n<p>Problem i am facing now is sometimes certain excel files that i am importing might not exist so when my package runs it will fail as the file doesn't exist. So is there any way for me to create a check that allows the package run to skip the source file that doesn't exist and run the rest of the source files?</p>\n\n<p>I am using SSIS 2005.</p>\n"},{"tags":["excel","excel-vba","excel-2003"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":57,"score":0,"question_id":12979954,"title":"Any way to save a row in an excel macro for future usage?","body":"<p>I'm building a macro to split a long table into multiple smalls tables, and I'd like to have the header saved in a variable to be able to quickly paste it on top of  the smalls table. </p>\n\n<p>I made a macro to do the first one (quite simple)</p>\n\n<pre><code>Sheets(\"Feuil1\").Select\nRows(\"2:2\").Select\nSelection.Copy\nSheets(\"PageImpression\").Select\nRows(\"2:2\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>How can I keep my <code>Selection.Copy</code> in a variable and how do I paste it when I need to?</p>\n"},{"tags":["c#",".net","excel","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12980640,"title":"How to add additional worksheets to an Excel from DataTable","body":"<p>I'm trying to create an excel report that has multiple sheets.  each of these sheets has data that comes from a DataTable that results from a SQL query.  The inital worksheet is created correctly, however, i'm unable to create the second worksheet.  I understand what i'm doing wrong, but i'm just not sure how to add a worksheet using the below code without creating a new excel workbook everything.</p>\n\n<p>I was thinking about just creating the workbook and then just adding sheets.  But I cant seem to make it all click.</p>\n\n<p>This is what i'm trying:</p>\n\n<pre><code>static void Main(string[] args)\n{\n        Excel_FromDataTable(testingTable);\n        Excel_FromDataTable(testingTable);\n    }\n}\n\nprivate static void Excel_FromDataTable(DataTable dt)\n{\n    var excel = new Microsoft.Office.Interop.Excel.Application();\n    var workbook = excel.Workbooks.Add(true);\n\n    int iCol = 0;\n    foreach (DataColumn c in dt.Columns)\n    {\n        iCol++;\n        excel.Cells[1, iCol] = c.ColumnName;\n    }\n\n    int iRow = 0;\n    foreach (DataRow r in dt.Rows)\n    {\n        iRow++;\n        // add each row's cell data...\n        iCol = 0;\n        foreach (DataColumn c in dt.Columns)\n        {\n            iCol++;\n            excel.Cells[iRow + 1, iCol] = r[c.ColumnName];\n        }\n    }\n    // Global missing reference for objects we are not defining...\n    object missing = System.Reflection.Missing.Value;\n    // If wanting to Save the workbook...\n    workbook.SaveAs(@\"C:\\MyExcelWorkBook2.xlsx\");\n    workbook.Close();\n}\n</code></pre>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12978411,"title":"MIN array function non zeros only","body":"<p>I have been trying to get this array function to output (non-zero) minimum values in the 'FINAL DATA'  AE column.  Can you see a structural error in this formula?</p>\n\n<pre><code>       =IF($C$4=\"All EMEA\",\n\nMIN(IF('FINAL DATA'!$2:$AE$250000&lt;&gt;0,\n\n('FINAL DATA'!$J$2:$J$250000=$C$4)*('FINAL DATA'!$E$2:$E$250000=$E$4)*( 'FINAL DATA'!$AE$2:$AE$250000))),\n\nMIN(IF('FINAL DATA'!$AE$2:$AE$250000&lt;&gt;0, \n\n('FINAL DATA'!$K$2:$K$250000=$C$4)*('FINAL DATA'!$E$2:$E$250000=$E$4)*( 'FINAL DATA'!$AE$2:$AE$250000)))\n\n)\n</code></pre>\n"},{"tags":["java","database","excel","import","xls"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":155,"score":0,"question_id":9700794,"title":"Import records from xls to database","body":"<p>I am trying to import more than 20,000 records from an excelsheet to and send it to database in java.</p>\n\n<p>I am taking 1000 records at a time in a list and and copy them in db, and then clear that list and again use the same list object for next 1000 records.</p>\n\n<p>But I am able to copy not more than 2000 records...means i tried for 2018 records, it succeeded, but when i am trying for 3050 records or even 3000, it fails.</p>\n\n<p>I dont able to get the reason.</p>\n\n<p>Should I use gc() after clearing the List.</p>\n"},{"tags":["excel","postgresql","import"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3708,"score":0,"question_id":1645286,"title":"Import Excel spreadsheet into PostgreSQL","body":"<p>I need to be able to import an Excel spreadsheet into a PostgreSQL database. The goal is for use with a Rails application. I have looked at the <a href=\"http://roo.rubyforge.org\" rel=\"nofollow\">Roo gem</a> and it takes 16 seconds to convert a 2000 line XLS file to CSV which is unacceptable. So I was wondering if I could just short-circuit the Rails application and import directly into PostgreSQL.</p>\n\n<p>Is there a way to import data from an Excel spreadsheet directly into PostgreSQL?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","excel","rake-task"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":176,"score":0,"question_id":7605991,"title":"Rails to_xls in rake task","body":"<p>I am trying to use the rails to_xls gem in my rake task. My code is:</p>\n\n<pre><code>tmp_file = Tempfile.new(['export_test', '.xls'])\nToXls::ArrayWriter.new(@logins_report, :name =&gt; 'export_test').write_io(tmp_file)\n</code></pre>\n\n<p>I receive an error that says \"rake aborted! uninitialized constant ToXls\" Any suggestions?</p>\n"},{"tags":["html","excel","data","import"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":185,"score":1,"question_id":4836893,"title":"import xls cells into html","body":"<p>I want to create an html template that can fetch the (sometimes long) texts of cells in an xls database into specific locations in the body. The html will then be saved to a unique document and will not be changed anymore.</p>\n\n<p>I've been searching the web for days now and any help will be most appreciated.</p>\n\n<p>Thank you.</p>\n"},{"tags":["excel","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12975730,"title":"Calculate Amount in Microsoft Excel according to Date","body":"<p>I have written my expenses for 7 months. I want to know my monthly expense sum as on 5th of every month. How should I do that in excel?</p>\n\n<p>Detailed: Expenses are written roughly on everyday basis. And I can calculate the sum total of all the expenses till date. Now I want to create a checkpoint or say the monthly expense.\nFormat:</p>\n\n<pre><code>S. No. | Date | Particulars | Amount\n</code></pre>\n"},{"tags":["c#","excel","interop","ninject","excel-interop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":273,"score":0,"question_id":11648523,"title":"How to inject Microsoft.Office.Interop.Excel.Application instance with Ninject v3?","body":"<p>I'm looking to inject an instance of the Microsoft.Office.Interop.Excel.Application interface with Ninject 3.0.1.10 to an application I'm writing with .NET 4 in C#. Creating and disposing the Excel object manually <a href=\"http://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c-sharp\">seems like a hassle</a>, so I'm hoping that Ninject would be helpful in managing the lifetime of the Excel object.</p>\n\n<p>If I attempt to configure Ninject like this:</p>\n\n<pre><code>public static void RegisterServices(IKernel kernel)\n{ \n   kernel.Bind&lt;Microsoft.Office.Interop.Excel.Application&gt;()\n         .To&lt;Microsoft.Office.Interop.Excel.ApplicationClass&gt;();\n}\n</code></pre>\n\n<p>And have the following service:</p>\n\n<pre><code> using Microsoft.Office.Interop.Excel;\n\n public class FooService {\n\n    private readonly Application _excelApplication;\n\n    public FooService(Application excelApplication)\n    {\n        _excelApplication = excelApplication;\n    }\n\n }\n</code></pre>\n\n<p>I get the following build error:</p>\n\n<pre><code>Interop type 'Microsoft.Office.Interop.Excel.ApplicationClass' cannot be embedded. Use the applicable interface instead.\n</code></pre>\n\n<p>I can <a href=\"http://stackoverflow.com/a/2483688/1548950\">resolve this build error</a>, but then running the code produces the following error:</p>\n\n<pre><code> Error activating Application\n No matching bindings are available, and the type is not self-bindable.\n\n Activation path:\n 2) Injection of dependency Application into parameter excelApplication of  \n    constructor of type FooService\n 1) Request for FooService\n</code></pre>\n\n<p>Injection of the interfaces I've created and mapped to my implementation classes (e.g. kernel.Bind&lt;IMyClass&gt;().To&lt;MyClass&gt;(); ) is working fine. What is wrong with the setup above? Is injecting Microsoft.Office.Interop.Excel.Application a bad idea in any case? </p>\n"},{"tags":["excel","vba","adodb"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12979605,"title":"How to retrieve data from Excel with ADODB connection if the first line of the worksheet does not have the column name?","body":"<p>I use the following type of code to retrieve data from some Excel Workbooks (path is a Parameter)</p>\n\n<pre><code>Dim strSQL  As String, conStr as String\nDim cnn As New ADODB.Connection\nDim rs As New ADODB.Recordset\n\n\nconStr = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; path &amp; \"';\" &amp; _\n             \"Extended Properties=\"\"Excel 12.0;HDR=YES;IMEX=1;\"\";\"\n\nstrSQL = \"SELECT [Field1], [Field2] FROM [Worksheet$] WHERE [Thing1] &gt; 1\"\n\ncnn.open conStr   \nrs.Open query, cnn, adOpenStatic, adLockOptimistic, adCmdText\n</code></pre>\n\n<p>That code works fine if the names of the fields are on the first row of the worksheet. The problem is that I need to retrieve data from a worksheet that the data table begins on another row (Row 10).</p>\n\n<p>Is there a way to specify the first row of my data table?</p>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12976677,"title":"Excel Macro date prompt for current date and changes the next cell 1 day ahead","body":"<p>How would I create an macro to prompt with current date and change the next cell 1 day ahead? I have a sample of what I have so far. Let me know if I am Close.</p>\n\n<pre><code>Sub Change_dates()\n    Dim dtDate As Date\n    dtDate = InputBox(\"Date\", , Date)\n    For Each cell In Intersect(Range(\"B \" &amp; dblRow).Value = dtDate, ActiveSheet.UsedRange)\n        cell.Offset(0, 1).Select = cell.Offset(0, 1).Select + 1\n    Next cell\nEnd Sub\n</code></pre>\n"},{"tags":["vb.net","excel","listview","extract"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12938907,"title":"VB export listview to Excel","body":"<p>I keep getting 'Exception from HRESULT: 0x800A03EC' error when I run my code.\nSome forums say that the '1' needs to be changed to a '0' or vice versa.\nAt this point I just don't know what is wrong nothing is sticking out. I believe I have all the references loaded that I need, so any suggestions/help would be much appreciated.</p>\n\n<pre><code>Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click\n    Dim objExcel As New Excel.Application\n    Dim bkWorkBook As Workbook\n    Dim shWorkSheet As Worksheet\n    Dim i As Integer\n    Dim j As Integer\n\n    objExcel = New Excel.Application\n    bkWorkBook = objExcel.Workbooks.Add\n    shWorkSheet = bkWorkBook.ActiveSheet\n    For i = 0 To Me.ListView1.Columns.Count\n        shWorkSheet.Cells(1, Chr(64 + i)) = Me.ListView1.Columns(i)\n    Next\n    For i = 1 To Me.ListView1.Items.Count\n        shWorkSheet.Cells(i + 2, \"A\") = Me.ListView1.Items(i).Text\n        For j = 2 To Me.ListView1.Items.Count\n            shWorkSheet.Cells(i + 2, Chr(64 + j)) = Me.ListView1.Items(i).SubItems(j - 1)\n        Next\n    Next\n\n    objExcel.Visible = True\nEnd Sub\n</code></pre>\n\n<p>Thanks,</p>\n"},{"tags":["java","apache","excel","java-ee","apache-poi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12979609,"title":"APACHE POI - cloneStyleFrom doesn't copy BorderStyle","body":"<p>I've a problem with the library apache poi, i want to copy the style of a cell and to do this i use the function cloneStyleFrom() and all works good except the copy of borders style. I don't understand if is my mistake or if this function doesn't implements the copy of the borders style.</p>\n\n<p>This is my code:</p>\n\n<pre><code>int stHashCode = oldCell.getCellStyle().hashCode();\nXSSFCellStyle newCellStyle = styleMap.get(stHashCode);\nif (newCellStyle == null) {\n    newCellStyle = newCell.getSheet().getWorkbook().createCellStyle();\n    newCellStyle.cloneStyleFrom(oldCell.getCellStyle());\n    styleMap.put(stHashCode, newCellStyle);\n}\n    newCell.setCellStyle(newCellStyle);\n</code></pre>\n\n<p>Someone can help me? Where is my mistake?</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","web","copy","paste"],"answer_count":5,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":235,"score":8,"question_id":12774684,"title":"Paste a HTML table into Excel, how to keep the line break in cell","body":"<p>I have a simple html table, for example, just one cell, but when I copy the dom node, and paste it into excel, it will be recognize as two rows, How to make Excel get the correct paste data.</p>\n\n<pre><code> &lt;table&gt;&lt;tr&gt;&lt;td&gt;1&lt;br&gt;2&lt;/td&gt;&lt;tr&gt;&lt;/table&gt;\n</code></pre>\n\n<p>I tried to add css style </p>\n\n<pre><code>br {mso-data-placement:same-cell;},\n</code></pre>\n\n<p>But it only works in IE.</p>\n\n<p>Note, copy a plain text out is not OK, i need to add color, font information on cells.</p>\n"},{"tags":["excel","c#-4.0","excel-2007","excel-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12928693,"title":"want to get data in excel based upon row and column using c#","body":"<blockquote>\n  <p>Hi was wondering  through internet for my solution. considering  my excel sheet as array i want to get data based on row and column index, how can i do this. i am not getting a clue to implement this my excel sheet look like below</p>\n</blockquote>\n\n<p><img src=\"http://i.stack.imgur.com/MgJoC.png\" alt=\"\"></p>\n\n<blockquote>\n  <p>please help in this. i am getting mad of trying different methods.</p>\n  \n  <p>my requirement is if i give R3,C2 in console ,i should get 4 as my answer.\n  i was using Excel.interop for getting this,you can suggest solution by other methods too.\n  thanking you in anticipation.</p>\n</blockquote>\n"},{"tags":["sql","excel","postgresql","pivot-table"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":93,"score":2,"question_id":12904277,"title":"Alias error in Excel pivot table sql","body":"<p>I'm pulling data from a database using an Excel pivot table. When I go into Microsoft Query to edit the SQL query, I tried to rename the columns for the pivot table using aliases but keep getting error messages:</p>\n\n<pre><code>SELECT table1.column1 AS \"Alias String\"\n\nSELECT table1.column1 \"Alias String\"\n\nSELECT table1.column1 AS my_alias\n\nSELECT table1.column1 my_alias\n</code></pre>\n\n<p>All of these result in \"Syntax Error\" messages. I don't want to just rename the columns by hand in the table because when I refresh the data, the names I write get overwritten with the original SQL column names. I'm using Postgresql 8.4 and Excel 2010. What's the syntax I should be using?</p>\n"},{"tags":["excel","vba","excel-vba","automation","userform"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":198,"score":0,"question_id":12951946,"title":"Excel VBA Open workbook, perform actions, save as, close","body":"<p>This question has been edited due to lengthy comments and updates from proposed answers.</p>\n\n<p>As requested here is module 13;</p>\n\n<pre><code>Sub SaveInFormat()\nApplication.DisplayAlerts = False\nWorkbooks.Application.ActiveWorkbook.SaveAs Filename:=\"C:\\Documents and Settings\\jammil\\Desktop\\AutoFinance\\ProjectControl\\Data\\\" &amp; Format(Date, \"yyyymm\") &amp; \"DB\" &amp; \".xlsx\",   leFormat:=51\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Also there are issues with the errorhandling, I know I've gone wrong with it but I'm more interested in fixing the close function at the moment before I get into it. Here is the error handling code that needs some work</p>\n\n<pre><code>Sub test()\n\nDim wk As String, yr As String, fname As String, fpath As String\nDim owb As Workbook\n\nwk = ComboBox1.Value\nyr = ComboBox2.Value\nfname = yr &amp; \"W\" &amp; wk\nfpath = \"C:\\Documents and Settings\\jammil\\Desktop\\AutoFinance\\ProjectControl\\Data\"\nowb = Application.Workbooks.Open(fpath &amp; \"\\\" &amp; fname)\nOn Error GoTo ErrorHandler:\nErrorHandler:\nIf MsgBox(\"This File Does Not Exist!\", vbRetryCancel) = vbCancel Then Exit Sub Else Call Clear\n\n'Do Some Stuff\n\nCall Module13.SaveInFormat\n\nowb.Close\n</code></pre>\n\n<p>this is your test code plus my changing of the file path and name</p>\n"},{"tags":["c#","excel","ashx"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":110,"score":3,"question_id":12975883,"title":"Create an excel file in ashx from byte[] array for client download","body":"<p>I'm trying to create an Excel file from a byte[] array after reading the data from a DataTable using a DataTableReader, all this in a ashx file. But it's just not working. Here I post some code:</p>\n\n<pre><code>DataTableReader RS = dt.CreateDataReader();\nbyte[] byteArray = GetData(RS);\n\ncontext.Response.ContentType = \"application/ms-excel\";\ncontext.Response.Clear();\n\n//  context.Response.Charset = \"\";\ntry\n{\n    context.Response.BinaryWrite(byteArray);\n    context.Response.OutputStream.Write(byteArray, 0, byteArray.Length);\n    context.Response.BufferOutput = true;\n    context.Response.Flush();\n }\n catch (Exception ex)\n {\n    SendMail(ex.Message.ToString());\n }\n</code></pre>\n\n<p>It throws the following exception:  </p>\n\n<blockquote>\n  <p>context.Response.SubStatusCode threw an exception of type System.PlatformNotSupportedException. {\"This operation requires IIS integrated pipeline mode.\"} ashx </p>\n</blockquote>\n\n<p>I know that if I use the headers need to have IIS7 or Framework 3+.</p>\n\n<p>Any help would be appreciated!!</p>\n"},{"tags":["c#","excel","vsto","workbook"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12900194,"title":"Select Workbook Excel already Open with a Button Click Method","body":"<p>I have a problem, I want insert data with a button click method, but this method are created in a Ribbon menu (VSTO).</p>\n\n<p>To understand better this, I want make a query on a database send it to a list of persons, and print on excel what i want see from that persons. For example, i just want see name and birthdate, or name, id and profession.</p>\n\n<p>To do this i need select the Workbook opened when i run the application. So i try this:</p>\n\n<pre><code>private void button1_Click(object sender, RibbonControlEventArgs e)\n        {\n            Excel.Workbook wb = (Excel.Workbook)Globals.ThisWorkbook.InnerObject;\n            Excel.Worksheet ws = wb.Sheets[\"Sheet1\"];\n            ws.Cells[1, 2] = \"teste\";\n        }\n</code></pre>\n\n<ul>\n<li>using Excel = Microsoft.Office.Tools.Excel; </li>\n<li>using ExcelTools = Microsoft.Office.Tools; </li>\n<li>using Microsoft.Office.Interop.Excel;</li>\n</ul>\n\n<p>But i get this error: \n<code>**\"Unable to cast COM object of type 'System.__ComObject' to interface type 'Microsoft.Office.Tools.Excel.Workbook'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{B74CBB86-9C9F-4172-9AE7-3CE4A7BFA5EB}' failed due to the following error: No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE)).\"**</code></p>\n\n<p>Probably is more easy than i'm seeing, but i'm so tired, and i need finish this...</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12976452,"title":"SUM(A1:A2) <> A1 + A2?","body":"<p>I noticed that SUM(A1:A2) &lt;> A1 + A2 returns true when A1 and A2 are boolean (e.g. A1=TRUE and A2=FALSE). The same applies to PRODUCT and the \"*\" operator. What is the rationale (if any) behind this strange behaviour? </p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12976867,"title":"Unprotect method fail after using keyboard shortcut","body":"<p>I have the following piece of code which calls a few different subs:</p>\n\n<pre><code>Sub DropDown2_Change()\n 'Packtype/Brand-packtype change\n  Sheets(\"planning interface\").unprotect\n  Application.ScreenUpdating = False\n  Call clear_data\n  If Sheets(\"load\").range(\"Q1\") = True Then\n    packtypeform.Show\n  End If\n  If Sheets(\"load\").range(\"Q1\") = False Then\n    brandpacktypeform.Show\n  End If\n  Call formatting\n  With Sheets(\"planning interface\")\n    .Protect\n    .EnableSelection = xlUnlockedCells\n  End With\n  application.screenupdating = true\nEnd Sub\n</code></pre>\n\n<p>It works great unless I press <code>ctrl+shift+pageup</code> (or pagedown) to switch between sheets I am viewing and return to the sheet with the dropdown.  </p>\n\n<p>I get a <code>Run-time error '1004': Unprotect method of worksheet class failed</code>  Is there a known reason why switching sheets using <code>ctrl+shift+pageup</code> would break the unprotect code that i have?</p>\n"},{"tags":["excel","automation","vsto","udf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12838249,"title":"Excel UDF not available when opening Excel via automation","body":"<p>I’m having a problem getting an Excel UDF class to be available in Excel when I launch Excel using automation.  I have an add-in I’m writing that needs to work when Excel is launched from a third-party application.  </p>\n\n<p>It is my understanding that this is by design, but I need to have a way to make my UDFs available to users when Excel is opened via automation. </p>\n\n<p>I created a VSTO addin and UDF class for Excel 2007.  I copied the code and followed the instructions from this web page exactly as written, except I replaced the GUIDs as instructed. \n<a href=\"http://csharpramblings.blogspot.ca/2011/09/communicating-between-vsto-and-udfs-in.html\" rel=\"nofollow\">http://csharpramblings.blogspot.ca/2011/09/communicating-between-vsto-and-udfs-in.html</a></p>\n\n<p>When I open Excel, I see my new add-in and the UDF shows as available in the list of functions (Insert Function).  So I know it’s working. </p>\n\n<p>I then created an application that uses Excel automation to open Excel.<br>\nIt is a Windows forms application, and I put a button on Form1.  I added a reference to Microsoft.Office.Interop.Excel  (version 1.6.0.0) which resolves (on my machine) to  C:\\Windows\\assembly\\GAC\\Microsoft.Office.Interop.Excel\\12.0.0.0__71e9bce111e9429c\\Microsoft.Office.Interop.Excel.dll</p>\n\n<p>I got the following code from <a href=\"http://support.microsoft.com/kb/302084\" rel=\"nofollow\">http://support.microsoft.com/kb/302084</a>, although I removed some of the code that puts data into the worksheet’s cells because I didn’t need it – I just wanted an example of opening Excel using automation.</p>\n\n<p>The C# code for Form1 for my sample program:</p>\n\n<pre><code>using System;\nusing System.Reflection;\nusing System.Windows.Forms;\nusing Excel = Microsoft.Office.Interop.Excel;\nnamespace ExcelAutomationTest\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n        private void button1_Click(object sender, System.EventArgs e)\n        {\n            Excel.Application oXL;\n            Excel._Workbook oWB;\n            Excel._Worksheet oSheet;\n            Excel.Range oRng;\n            try\n            {\n                //Start Excel and get Application object.\n                oXL = new Excel.Application();\n                oXL.Visible = true;\n                //Get a new workbook.\n                oWB = (Excel._Workbook)(oXL.Workbooks.Add(Missing.Value));\n                oSheet = (Excel._Worksheet)oWB.ActiveSheet;\n                //Add table headers going cell by cell.\n                oSheet.Cells[1, 1] = \"First Name\";\n                oSheet.Cells[1, 2] = \"Last Name\";\n                oSheet.Cells[1, 3] = \"Full Name\";\n                oSheet.Cells[1, 4] = \"Salary\";\n                //Make sure Excel is visible and give the user control\n                //of Microsoft Excel's lifetime.\n                oXL.Visible = true;\n                oXL.UserControl = true;\n            }\n            catch (Exception theException)\n            {\n                String errorMessage;\n                errorMessage = \"Error: \";\n                errorMessage = String.Concat(errorMessage, theException.Message);\n                errorMessage = String.Concat(errorMessage, \" Line: \");\n                errorMessage = String.Concat(errorMessage, theException.Source);\n                MessageBox.Show(errorMessage, \"Error\");\n            }\n        }\n    }\n</code></pre>\n\n<p>Build the windows forms app that automates Excel. Run the app. It will start Excel. Go to the \"Formulas\" tab and click \"Insert Function\". View \"All\" functions. On my machine, MYINT is not in the list. </p>\n\n<p>Is it possible to make the MYINT function available when Excel opens using automation?  One person suggested I could use the Excel.Application object in the VSTO ThisAddIn_Startup() to load the UDF, but I was unable to find a sample of how to do that, and the person helping me didn’t know. </p>\n\n<p>I asked on the MSDN Excel and VSTO forums for help and wasn’t able to get a clear picture of what to do next. There are some similar questions, but nothing quite the same, around StackOverflow. Does anyone have any ideas?  </p>\n"},{"tags":["vb.net","excel","pivotitem"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":12961572,"title":"Reading PivotItem.Visible in Page Field when Workbook saved from Excel 2007 to 2003 and back","body":"<p>Here's the 1000 ft. view:</p>\n\n<p>I have written a program that creates pivot tables in 2007 format, which are used by the client to select which records they want to have returned from a large data set.  The client returns the pivot table with selections made, and the program reads the selections in the pivot table using the PivotItem.Visible property.</p>\n\n<p>Sometimes the client only has an older version of Excel, and the pivot table get saved in an earlier format.  The program requires reading from Excel 2007, so when the pivot table is returned, I have to save it in the newer format before parsing the selections in the program.</p>\n\n<p>Problem: when iterating over the PivotItems, checking the PivotItem.Visible property for any PivotItem in a Page field always returns False, even when selections are made in the base pivot table.  If I recreate the pivot table and make the selections without conversion - iterating over the PivotItems and checking visibility works properly - items selected return True and items not selected return False.</p>\n\n<p>Question: Is there a workaround for this?  I've looked, but can't find any solutions.</p>\n\n<pre><code>Private Sub MakeSelectionsFromPivotTable(ByVal currentPivotFieldItems As Excel.PivotItems, _\n        ByVal currentPivotField As Excel.PivotField, _\n        ByVal currentPivotItem As Excel.PivotItem, _\n        ByVal currentAttribute As Attribute)\n\n        currentPivotFieldItems = CType(currentPivotField.PivotItems(), Excel.PivotItems)\n\n        For pivotItemCounter As Integer = 1 To currentPivotFieldItems.Count\n            currentPivotItem = CType(currentPivotField.PivotItems(pivotItemCounter), Excel.PivotItem)\n\n            For Each bucket As Bucket In currentAttribute.GetBuckets()\n                If bucket.nameMatches(CStr(currentPivotItem.SourceName)) Then\n                    bucket.Selected = (currentPivotItem.Visible) 'shouldn't always be false!\n                    Exit For\n                End If\n            Next\n        Next\n    End Sub\n</code></pre>\n\n<p>Details: The code essentially maps a PivotItem to a Bucket object, and a PivotField to an Attribute object.  This code works perfectly, as long as the Workbook hasn't changed format.</p>\n\n<p>Edit: Discovered that the PivotItem.Visible property is correctly read when moved from the page field to a row or column field.  I can now catch the error by trapping when all buckets are not selected for an attribute, but still would like to know what's going on - or if this is some weird esoteric Excel bug/feature.</p>\n"},{"tags":["excel","applescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12970836,"title":"How to apply theme color of cell in excel using apple script","body":"<p>I am using Apple script. My problem is, how can i change the theme color of cells to first accent theme color. </p>\n\n<p>tell interior object of cell \"A1\" \n set color index to 5 \n set theme color 9 \nend tell</p>\n\n<p>In this script color index is set but theme color is not set .\nPlease help me.\ni am waiting for your replay.</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","powershell","powershell-v2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12937814,"title":"Writing a two-dimensional array to the Value2 property of an Excel range object in PowerShell","body":"<p>I'm new to PowerShell, and can't seem to figure out why the first method in the code below does not work, while the second method (commented out) does.<br><br>\nI'm trying to write the result of a database recordset to an Excel file, so i need a dynamically expandable array. I know how to do that with the first type of array, but not with the second type.<br><br>\nMy problem would be solved if:</p>\n\n<ul>\n<li>you know how to dynamically expand the array of the second type<br>\nEdit: As mentioned here <a href=\"http://powershell.com/cs/blogs/tips/archive/2008/12/05/multidimensional-arrays.aspx\" rel=\"nofollow\">http://powershell.com/cs/blogs/tips/archive/2008/12/05/multidimensional-arrays.aspx</a> this isn't possible.</li>\n<li>know how to write the array of the first type to the range</li>\n<li>Edit: or, you know an efficient method to convert the array of the first type to the second type.</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code>#need this to work around bug if you have a non us-locale and English excel: http://support.microsoft.com/default.aspx?scid=kb;en-us;320369\n[System.Threading.Thread]::CurrentThread.CurrentCulture = \"en-US\" \n\n# This doesn't work\n$values = @(('test1','test2'),('test3','test4'))\n\n# This works\n&lt;#\n$values = New-Object 'object[,]' 2,2\n$values[0,0] = 'test1'\n$values[0,1] = 'test2'\n$values[1,0] = 'test3'\n$values[1,1] = 'test4'\n#&gt;\n\n$excel = New-Object -ComObject Excel.Application\n$excel.Visible = $False\n$xls_workbook = $excel.Workbooks.Add()\n$range = $xls_workbook.sheets.item(1).Range(\"A1:B2\")\n$range.Value2 = $values\n\n$xls_workbook.SaveAs($MyInvocation.MyCommand.Definition.Replace($MyInvocation.MyCommand.Name, \"\") + \"test.xlsx\")\n$excel.Quit()\n</code></pre>\n"},{"tags":["c#","visual-studio","excel","vsto","office-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12975093,"title":"Check excel 2010 bitness","body":"<p>Is it possible to get office 2010 bitness using <strong>getBinaryType()</strong> function which is defined in kernel32.dll something like this.</p>\n\n<pre><code>[DllImport(\"kernel32.dll\")]\nstatic extern bool GetBinaryType(string lpApplicationName, out uint lpBinaryType);\n\nuint type;\nGetBinaryType(\"applicationName\",out type);\n</code></pre>\n\n<p>I have tried using application class as stated below but sometimes it will fail.</p>\n\n<pre><code> public static ExcelVersion GetExcelVersion(object applicationClass)\n        {\n            if (applicationClass == null)\n                throw new ArgumentNullException(\"applicationClass\");\n\n            PropertyInfo property = applicationClass.GetType().GetProperty(\"HinstancePtr\", BindingFlags.Instance | BindingFlags.Public);\n            if (property == null)\n                return ExcelVersion.Excel;\n\n            return (System.Runtime.InteropServices.Marshal.SizeOf(property.GetValue(applicationClass, null)) == 8) ? ExcelVersion.Excel2010_64 : ExcelVersion.Excel2010_32;\n}\n</code></pre>\n\n<p>Is there any another way to detect <strong>office 2010</strong> bitness?</p>\n"},{"tags":["xml","excel","sap","dashboard","xcelsius"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12974760,"title":"Update Data With XML - xCelsius (SAP Dashboard Design)","body":"<p>I'm using SAP Dashboard Design 6 and I need to update the .swf with XML data.</p>\n\n<p>The main idea is to upload the .swf on a web server and get the data from a XML that will be updated sometimes. New rows will be added every update.</p>\n\n<p>Something isn't working as expected. When I update the XML with new rows, these rows don't appear. I already checked the option to \"refresh before components are loaded\" on the Data Connection.</p>\n\n<p>What I'm missing?</p>\n\n<hr>\n\n<ul>\n<li>Edit: I want to update only the xml. The .swf will not be re-uploaded.</li>\n</ul>\n"},{"tags":["excel","matlab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12974631,"title":"xlsread only the first row","body":"<p>From matlab I wish to read only the first row from an excel sheet but do not know the number of columns in the sheet. i.e I want to do the equivalent of </p>\n\n<pre><code>filename = 'myExample.xlsx';\n\ncolumnB = xlsread(filename,'B:B') .\n</code></pre>\n\n<p>Would be grateful to know the method.</p>\n"},{"tags":["excel","ms-office","openxml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12974965,"title":"Excel - how best to solve the excel this read/write cell format issue","body":"<p>I have a situation where in order to read Excel files of any format, I use the following function to access the data in my excel row cells.</p>\n\n<pre><code>  public String assignRowValue(Row row, int number, SharedStringTable sharedString)\n        {\n            String value = String.Empty;\n            int index = 0;\n            try\n            {\n                Cell cell = row.Descendants&lt;Cell&gt;().Where(c =&gt; c.CellReference == ExcelColumnFromNumber(number) + row.RowIndex.ToString()).FirstOrDefault();\n                if (cell == null)\n                {\n                    value = String.Empty;\n                }\n                else if (int.TryParse(cell.CellValue.InnerText, out index))\n                {\n                    if (index &gt; 0 &amp;&amp; (index &lt; sharedString.ChildElements.Count) &amp;&amp; (sharedString.ChildElements[index].InnerText != null))\n                    {\n                        value = sharedString.ChildElements[int.Parse(cell.CellValue.InnerText)].InnerText;\n                    }\n                }\n                else if ((cell.CellValue != null &amp;&amp; cell.CellValue.InnerText != null))\n                {\n                    value = cell.CellValue.InnerText;\n                }\n            }\n            catch (Exception ex)\n            {\n                return String.Empty;\n            }\n            return value;\n        }\n</code></pre>\n\n<p>However, when I go to write the export excel, I use the following method. </p>\n\n<pre><code>public Row createContentRow( DataRow dataRow,int rowIndex)\n{\n    Row row = new Row\n\n    {\n        RowIndex = (UInt32)rowIndex\n    };\n\n    for (int i = 0; i &lt; dataRow.Table.Columns.Count; i++)\n    {\n        Cell dataCell = createTextCell(i + 1, rowIndex, dataRow[i]);\n        row.AppendChild(dataCell);\n    }\n    return row;\n}\n</code></pre>\n\n<p>Both work  really fine except when I try to feed the generated excel file back in to the system, then my first function there, <strong>assignRowValue</strong>, attempts to read numbers in the cells as indexes to the excel in the excel SharedString Table, something I definitely do not want. How do I properly change my function to identify text formatted and read the content as is, while it also knows to identify cells containing indexes and read the values from the three instead. </p>\n"},{"tags":["php","mysql","arrays","excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":12974621,"title":"send an array to an excel file using php","body":"<p>I want to send an array to excel file... array contains diiferent categories.</p>\n\n<p>Each categories should go into one column... the code i written was sending all the values to one field on excel..please help me where iam getting wrong..thanks</p>\n\n<pre><code>$shop['id']=$id_array;\n    $shop['name']=$name_array;\n    $shop['cat1'] = $cat1;\n    $shop['cat2'] = $cat2;\n    $shop['cat3'] = $cat3;\n\n\n    $id_excel=implode(\",\",$shop['id']);\n    $name_excel=implode(\",\",$shop['name']);\n    $cat1_excel=implode(\",\",$shop['cat1']);\n    $cat2_excel=implode(\",\",$shop['cat2']);\n    $cat3_excel=implode(\",\",$shop['cat3']);\n\n}\n    $filename =\"cat.xls\";\n    $contents = \"$id_excel \\t $name_excel \\t $cat1_excel \\t $cat2_excel \\t $cat3_excel \\t \\n\";\n    header('Content-type: application/ms-excel');\n    header('Content-Disposition: attachment; filename='.$filename);\n    echo $contents;\n</code></pre>\n"},{"tags":["excel","csv","vbscript","match","type-mismatch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":138,"score":0,"question_id":12969149,"title":"Type mismatch , compare excel cell value to array value *FIXED*","body":"<p>Current problem:</p>\n\n<p>Target is to copy data from a source .csv file to a target excel sheet, based on matching a value from each row of the .csv to values in an excel sheet column, and then making the copy based on that to the correct cells in the excel sheet.</p>\n\n<p>I'm gathering values to an array from a .csv file in a loop, comparing one of the values in the array to values in the target excel sheet column A, if a match happens, all the values in the array are to be copied to the corresponding row in the excel sheet.</p>\n\n<p>I'm now getting a \"Type mismatch\" error when trying to compare the excel sheet's cell values to the array value.</p>\n\n<p>Here are the relevant bits of the code:</p>\n\n<pre><code>sfile=\"\\\\DFSpath\\file1.csv\"\nsmaster=\"\\\\DFSpath\\file2.xlsx\"\n\nset xlapp = createobject(\"excel.application\")\n\nset wbtarget = xlapp.workbooks.open(smaster)\n\nset tgtworksheet = wbtarget.worksheets(\"sheet1\")\n\nset usedRowsXP = tgtworksheet.UsedRange.Rows\n\ndim fs,objTextFile\nset fs=CreateObject(\"Scripting.FileSystemObject\")\ndim arrStr\nset objTextFile = fs.OpenTextFile(sfile)\n\nDo while NOT objTextFile.AtEndOfStream\n  arrStr = split(objTextFile.ReadLine,\",\")\n\n    for each oRow in usedRowsXP   \n\n    Introw = oRow\n    If tgtworksheet.cells(Introw,1).value = arrStr(2) Then\n    tgtworksheet.cells(Introw,4).value = arrStr(0)\n    tgtworksheet.cells(Introw,5).value = arrStr(1)\n    tgtworksheet.cells(Introw,6).value = arrStr(2)\n\n    End If\n    next\nLoop\n</code></pre>\n\n<p>Fixed by modifying the code as follows:</p>\n\n<pre><code>dim fs,objTextFile\n    set fs=CreateObject(\"Scripting.FileSystemObject\")\n    dim arrStr\n    set objTextFile = fs.OpenTextFile(sfile)\n\n'##Replace quotation marks with nothing in .csv##\n\nstrText = objtextFile.ReadAll\nobjTextFile.Close\nstrNewText = Replace(strText, \"\"\"\", \"\")\n\nSet objtextFile = fs.OpenTextFile(sfile, 2)\nobjtextFile.Write strNewText\nobjtextFile.Close\n\nset objTextFile = fs.OpenTextFile(sfile, 1)\n\n'##Gather array out of line in .csv + compare user's name to name in excel sheet, if matches, copy data, repeat for each line##\n\n\nDo while NOT objTextFile.AtEndOfStream\narrStr = split(objTextFile.ReadLine,\",\")     \n\nfor each oRow in usedRowsXP   \n\nIntrow = oRow.row\nIf Cstr(tgtworksheet.cells(Introw,1).value) = arrStr(2) Then\ntgtworksheet.cells(Introw,4).value = arrStr(0)\ntgtworksheet.cells(Introw,5).value = arrStr(1)\ntgtworksheet.cells(Introw,6).value = arrStr(2)\n\nEnd If\nnext\n\nLoop\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12972790,"title":"Macro does not work when sheet is renamed","body":"<p>I am using a macro on a worksheet that needs to be protected. This is the macro:</p>\n\n<pre><code>wksPartsDataEntry.Unprotect\nSheet11.Unprotect\nApplication.ScreenUpdating = False\n\nDim historyWks As Worksheet\nDim inputWks As Worksheet\n\nDim nextRow As Long\nDim oCol As Long\n\nDim myCopy As Range\nDim myTest As Range\n\nDim lRsp As Long\n\nSet inputWks = wksPartsDataEntry\nSet historyWks = Sheet11\n\n'check for duplicate order ID in database\nIf inputWks.Range(\"CheckID2\") = True Then\n  lRsp = MsgBox(\"Clinic ID already in database. Update record?\", vbQuestion + vbYesNo, \"Duplicate ID\")\n  If lRsp = vbYes Then\n    UpdateLogRecord\n  Else\n    MsgBox \"Please change Clinic ID to a unique number.\"\n  End If\n\nElse\n\n  'cells to copy from Input sheet - some contain formulas\n  Set myCopy = inputWks.Range(\"OrderEntry2\")\n\n  With historyWks\n      nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n  End With\n\n  With inputWks\n      Set myTest = myCopy.Offset(0, 2)\n\n      If Application.Count(myTest) &gt; 0 Then\n          MsgBox \"Please fill in all the cells!\"\n          Exit Sub\n      End If\n  End With\n\n  With historyWks\n      With .Cells(nextRow, \"A\")\n          .Value = Now\n          .NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n      End With\n      .Cells(nextRow, \"B\").Value = Application.UserName\n      oCol = 3\n      myCopy.Copy\n      .Cells(nextRow, 3).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n      Application.CutCopyMode = False\n  End With\n\n  'clear input cells that contain constants\n  With inputWks\n    On Error Resume Next\n       With myCopy.Cells.SpecialCells(xlCellTypeConstants)\n            .ClearContents\n            Application.GoTo .Cells(1) ', Scroll:=True\n       End With\n    On Error GoTo 0\n  End With\nEnd If\n\nApplication.ScreenUpdating = True\nwksPartsDataEntry.Protect\nSheet11.Protect\nEnd Sub\n</code></pre>\n\n<p>The macro works fine. However I will distribute the file to other users that will want to use passwords to protect their sheets. Every user will want to use a different password. \nAdding a password in the code is not an option, since that password would be unique, and I want other users to be able to add their own password when protecting. \nDoes a code exist that could do something like:</p>\n\n<pre><code>Sub Macro1()\nwksPartsDataEntry.Unprotect Password: (anything a user might choose as a password)\nSheet11.Unprotect: (anything a user might choose as a password)\n</code></pre>\n\n<p>So in the end my macro would unprotect and reprotect based on the password that the user chooses himself, without the user having to change any code whatsoever. </p>\n\n<p>Hope I have been clear enough, thanks for any answer!</p>\n"},{"tags":["jquery","json","excel","jsp","jqgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12968199,"title":"Exporting Jqgrid into excel is not working in jsp","body":"<p>Hello Guys!!\n              I have a jqgrid which displays the records .Now as per my requirement i have to export it into excel format .i am trying to do it but its not happening any how.Export to excel button is not working.Here i am posting my code...</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n    &lt;title&gt;JQgrid&lt;/title&gt;\n&lt;img src=\"images/header.png\" alt=\"Logo\" height=\"130\" width=\"1270\"/&gt;\n&lt;hr noshade size=\"3\" align=\"left\"&gt;\n&lt;script language=\"javaScript\"\ntype=\"text/javascript\" src=\"calender.js\"&gt;&lt;/script&gt;\n&lt;link href=\"calender.css\" rel=\"stylesheet\" type=\"text/css\"&gt;\n&lt;link href=\"css/jquery-ui-1.8.16.custom.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"css/ui.jqgrid.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"css/style.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"plugins/ui.multiselect.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;script src=\"js/jquery-1.5.2.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"js/i18n/grid.locale-en.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"js/jquery-ui-custom.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"plugins/ui.multiselect.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"js/jquery.jqGrid.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"js/custom.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n\n\n\n\n&lt;script type=\"text/javascript\"&gt;\n    $(document).ready(function() {\n        //var windowWidth = (document.documentElement.clientWidth - 100) /0.9;\n        var i=1;\n        $('#go').click(function(evt){\n            //alert('hi');\n            evt.preventDefault();\n            var todate=$('#todate').val();\n            var fromdate=$('#todate').val();\n            if(todate &amp;&amp; fromdate)\n            {\n\n                var URL='getGriddahico.jsp?todate='+$('#todate').val()+'&amp;fromdate='+$('#fromdate').val();\n\n                //jQuery(\"#gridUsuarios\").jqGrid('reload');\n                if(i==1){gridcall(URL);}\n                else{jQuery(\"#gridUsuarios\").jqGrid('GridUnload');gridcall(URL);}\n                i++;\n\n            }\n\n        });\n\n\n    });\n\n    function gridcall(path)\n    {\n        jQuery(\"#gridUsuarios\").jqGrid({\n            url:path,\n            datatype: \"json\",\n            colNames:['ID','Call Date','src','dst','dstchannel','Lastapp','Duration','Disposition','Amaflags','cdrcost'],\n            colModel:[\n                {name:'id',index:'id', width:90,align: 'center',editable:true, hidden:true,closed:true},\n                {name:'calldate',index:'calldate',editable:false, width:170,align: 'center'},\n                {name:'src',index:'src',editable:false, width:170,align: 'center'},\n                {name:'dst',index:'dst',editable:false, width:170,align: 'center'},    \n                {name:'dstchannel',index:'dstchannel',editable:false, width:170,align: 'center'}, \n                {name:'Lastapp',index:'lastapp',editable:false, width:170,align: 'center'}, \n                {name:'duration',index:'duration',editable:false, width:170,align: 'center'}, \n\n                {name:'disposition',index:'disposition',editable:false, width:170,align: 'center'}, \n\n                {name:'amaflags',index:'amaflags',editable:false, width:170,align: 'center'}, \n                {name:'cdrcost',index:'cdrcost',editable:false, width:170,align: 'center'},\n            ],\n            rowNum:50,\n            rowList:[50,100,150],\n            scrollrows : true,\n            // multiselect: true,\n            pager: '#pagGrid',\n            sortname: 'id',\n            viewrecords: true,\n            sortorder: \"asc\",\n            autowidth:true,\n            //width: windowWidth,\n            height:360, \n            editurl:'edit.jsp'\n\n        });\n        $(\"#gridUsuarios\").jqGrid('navGrid', '#pagGrid',{excel:true})\n        .navButtonAdd('#pagGrid',{\n            caption:\"Export to Excel\", \n            buttonicon:\"ui-icon-save\", \n            onClickButton: function(){ \n                exportExcel();\n            }, \n            position:\"last\"\n        });\n\n        function exportExcel()\n        {\n            var mya=new Array();\n            mya=$(\"#gridUsuarios\").getDataIDs();  // Get All IDs\n            var data=$(\"#gridUsuarios\").getRowData(mya[0]);     // Get First row to get the labels\n            var colNames=new Array(); \n            var ii=0;\n            for (var i in data){colNames[ii++]=i;}    // capture col names\n            var html=\"\";\n            for(i=0;i&lt;mya.length;i++)\n            {\n                data=$(\"#gridUsuarios\").getRowData(mya[i]); // get each row\n                for(j=0;j&lt;colNames.length;j++)\n                {\n                    html=html+data[colNames[j]]+\"\\t\"; // output each column as tab delimited\n                }\n                html=html+\"\\n\";  // output each row with end of line\n\n            }\n            html=html+\"\\n\";  // end of line at the end\n            document.forms[0].csvBuffer.value=html;\n            document.forms[0].method='POST';\n            document.forms[0].action='csvExport.jsp';  // send it to server which will open this contents in excel file\n            document.forms[0].target='_blank';\n            document.forms[0].submit();\n        }\n\n\n        jQuery(\"#gridUsuarios\").jqGrid('bindKeys', {\"onEnter\":function( rowid ) { alert(\"You enter a row with id:\"+rowid)} } );  \n    }\n\n&lt;/script&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12963526,"title":"Apache POI throws -60 Error on cell with recursive formula. Can this be resolved or worked around","body":"<p>I created a simple spread sheet to test this problem.  A percentage is computed at the top of the spread sheet.  Below the sum of a different column of numbers includes a computation of the sum total times the calculated percentage (A recursive formula).</p>\n\n<p>This works fine in EXCEL.</p>\n\n<p>In POI when the cell is computed it throws an undocumented FormulaError code (-60 ).</p>\n\n<p>Is there a way to determine WHAT this error code is and how if to work around it / fix it?</p>\n\n<p>Code:</p>\n\n<pre><code>    try {\n        Session session = getSession();\n        AgentContext agentContext = session.getAgentContext();\n\n        /**\n         * creates an {@link HSSFWorkbook} the specified OS filename.\n         */\n        // Read the Excel template from the local hard drive\n        String filename = \"c:\\\\temp\\\\RecurssionTest.xls\";\n        // Create the control number and format\n\n        Workbook wb = new HSSFWorkbook(new FileInputStream(filename));\n        wb.setForceFormulaRecalculation(true);\n        //Get the row and cell (zero index)\n        int rindex = 0;\n        int cindex = 0;\n        //Get the Notes Fields worksheet\n        Sheet ws = wb.getSheet(\"Sheet1\");\n        //String fields[] = {\"Position1\",\"Position\",\"PositionWC\",\"Positionprefix\",\"raterwc\",\"Client_Name\",\"State\",\"Client_Division\"};\n\n        cellSetValNum(ws, rindex, cindex, 120);\n\n        // Write the output to a file\n        String excelOutput = \"C:\\\\temp\\\\UpdatedRT.xls\";\n        FileOutputStream fileOut = new FileOutputStream(excelOutput);\n        wb.write(fileOut);\n\n        System.out.println(\"Formula Errors are: \");\n        FormulaError fevals[] = FormulaError.values();\n        for (FormulaError formulaError : fevals) {\n            System.out.println(\"formula error val: \" + formulaError.getCode());\n        }\n\n\n        FormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();\n        evaluator.evaluateAll();\n            Sheet sheet = wb.getSheet(\"Sheet1\");\n            System.out.println(\"processing sheet: \" + sheet.getSheetName());\n            for(Row r : sheet) {\n                for(Cell c : r) {\n                    if(c.getCellType() == Cell.CELL_TYPE_FORMULA) {\n\n                        System.out.println(\"Recalcing: \"+r.getRowNum()+c.getColumnIndex() + \"in \"+ sheet.getSheetName());\n                        System.out.println(\"Cell Type before is: \"+c.getCellType());\n                        //System.out.println(\"Cell value before is:\" +c.getNumericCellValue());\n                        evaluator.evaluateFormulaCell(c);\n                        evaluator.evaluateAll();\n                        System.out.println(\"Cell Formula is: \"+ c.getCellFormula());\n                        System.out.println(\"Cell Type after is: \"+c.getCellType());\n                        //System.out.println(\"Cell Value After is: \"+c.getNumericCellValue());\n\n                        if(r.getRowNum()== 11){\n                            System.out.println(\"This cell has an error\");\n                            System.out.println(\"Cell Error Value is: \"+c.getErrorCellValue());\n                        }\n                        System.out.println(\"\");\n                    }\n                }\n            }\n\n        wb.write(fileOut);\n        fileOut.close();\n\n\n\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n\n<p>Stacktrace:</p>\n\n<pre><code>start set cell num\n0 120.0\nEnd set cell num\nFormula Errors are: \nformula error val: 0\nformula error val: 7\nformula error val: 15\nformula error val: 23\nformula error val: 29\nformula error val: 36\nformula error val: 42\nprocessing sheet: Sheet1\nRecalcing: 20in Sheet1\nCell Type before is: 2\nCell Formula is: A1*A2\nCell Type after is: 2\n\nRecalcing: 100in Sheet1\nCell Type before is: 2\nCell Formula is: A3*A12\nCell Type after is: 2\n\nRecalcing: 110in Sheet1\nCell Type before is: 2\nCell Formula is: SUM(A6:A11)\nCell Type after is: 2\nThis cell has an error\nCell Error Value is: -60\n</code></pre>\n"},{"tags":["php","mysql","arrays","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12972714,"title":"download an excel file from php which have different array","body":"<p>I want to write different arrays from my php script to different rows of an excel file. I know there are many ways to do that.</p>\n\n<p>I got a small script which downloads an excel file but not supporting my array to insert into the content.. please help me,if it need any changes.</p>\n\n<p>Thanks</p>\n\n<pre><code>    $shop['id']=$column['id'];\n    $shop['name']=$column['name'];\n    $shop['cat1'] = $cat1;\n    $shop['cat2'] = $cat2;\n    $shop['cat3'] = $cat3;\n    $all_shops[$column['id']] = $shop; \n\n\n\n$filename =\"cat.xls\";\n$contents = \"$shop['cat2']\";\nheader('Content-type: application/ms-excel');\nheader('Content-Disposition: attachment; filename='.$filename);\necho $contents;\n</code></pre>\n"},{"tags":["python","excel","types","xls","xlrd"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":397,"score":0,"question_id":3691000,"title":"Python Excel parsing data with xlrd","body":"<p>Fairly simple; I've got the data I want out of the excel file, but can't seem to find anything inside the <a href=\"https://secure.simplistix.co.uk/svn/xlrd/trunk/xlrd/doc/xlrd.html\" rel=\"nofollow\">XLRD readme</a> that explains how to go from this:</p>\n\n<pre><code>xldate:40397.007905092592\nnumber:10000.0\ntext:u'No'\nnumber:0.1203\nnumber:0.096000000000000002\nnumber:0.126\n</code></pre>\n\n<p>to their respective python datatypes. Any ideas?</p>\n"},{"tags":["c#","excel","count","openxml"],"answer_count":2,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":4988,"score":10,"question_id":4777128,"title":"C# EPPlus OpenXML count rows","body":"<p>With EPPlus and OpenXML does anyone know the syntax on how to count the rows?</p>\n\n<p>Say my worksheet is called \"worksheet\"</p>\n\n<p>int numberRows = worksheet.rows.count()? or worksheet.rows.dimension</p>\n\n<p>I'm cetainly interested in the answer, but how to find the answer would be cool to, like \"Go to definition\" and look for this or that, etc.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","excel","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12969786,"title":"Excel Addin Creation for only one file","body":"<p>I have created a VS Addin Project where I have written code to add a custom menu with some menu items in C#. By this I got a VSTO deployment file. Now I open a random excel file and add this addin or vsto manually by Excel Options-> Addins->Manage (Com Addins) -> Go and Added the addin. My isuue is that the addin gets added in all files alongwith the file in which I added. I want that the user view this addin menu for the file for which s/he added manually. Our approach is free to ask user to go thru some special steps to follow or I can write C# code also for achieving this. Also we cannot do this by identifying the file name as the name and location of file may change. Please suggest any workaround as I am totally stuck on this issue.</p>\n"},{"tags":["excel","excel-formula","excel-2010"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12968822,"title":"Excel formula - Compare two tables for values","body":"<p>I need help setting up an Excel-Formula. </p>\n\n<p>I have two tables that I need to compare in order to multiply the <em>currency rate</em> of <strong>table2</strong> with the <em>amount</em> of <strong>table1</strong> depending on the <em>date</em> of <strong>table1</strong> matching the <em>date</em> field of <strong>table2</strong>.</p>\n\n<p>If you have a look at the screenshot I made I think you will understand what I want to do: <a href=\"http://i.imgur.com/dvg9B.png\" rel=\"nofollow\">Image</a></p>\n\n<p>Hope you can help me set up a formula for this. If you need the excel-file for testing I uploaded it to <strong>zoho</strong>. <a href=\"https://public.sheet.zoho.com/public/tonyclifton77/excelcurrency\" rel=\"nofollow\">Link</a></p>\n"},{"tags":["excel","csv","script","vbscript","import"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":119,"score":0,"question_id":12961835,"title":"Vbscript to import csv into excel","body":"<p>I would like to make a VBSript that will open a csv of varying rows and columns and paste them starting at row 4 column 1. So far what I have written is slow and has the amount of columns hard coded into it.</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(wscript.Arguments(0))\nobjExcel.Visible = True\nobjExcel.Cells(1, 4).Value = wscript.Arguments(1)+\" - \"+wscript.Arguments(2)\nobjExcel.Cells(2, 4).Value = wscript.Arguments(3)\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objTextFile = objFSO.OpenTextFile (wscript.Arguments(4))\ncCount = 1\nrCount = 4\n\nDo While objTextFile.AtEndOfStream &lt;&gt; True\n        arrUserRecord = split(objTextFile.Readline, \",\")\n        Do While cCount&lt;213\n            objExcel.Cells(rCount, cCount).Value = arrUserRecord(cCount-1)\n            cCount=cCount+1\n        Loop\n        cCount=1\n        rCount=1+rCount\nLoop\n</code></pre>\n"},{"tags":["c#","asp.net","sql","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12969281,"title":"I am importing data from Excel sheet to SQL Server to store in a table using an aplication","body":"<p>I have one <code>Excel</code> sheet, in that plenty amount of data is there, so need to write these data in the <code>SQL server</code> table directly. I searched in google but I didn't found a proper solution for my requirement. </p>\n\n<p>My <code>Excel</code> contains the data in row wise, I mean that data is not continually provided. Having sub headings &amp; some other information about tables description written after every table ended.</p>\n\n<p>I hope you all understand my requirement. Please anybody have idea about this issue, or alternate solution to resolve. Have to store this excel data in to the <code>SQL server</code> table.</p>\n\n<p>Here data is columns as rows &amp; rows as columns. So how to read in this case. </p>\n\n<pre><code>firstname      vijay      vikram     vikek      varun\n\nlastame        kumar      rathod      goshal    kandari\n\nmobile         45425      456546      54656     454615   \n</code></pre>\n\n<p>Like above my data in <code>excel</code> sheet so how capture this kind of data.</p>\n"},{"tags":[".net","excel","vba","filesystems","pia"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":263,"score":1,"question_id":8330845,"title":"Set Current Directory in Excel.Application via .NET Office PIA","body":"<p>I want to create an Excel spreadsheet from a .NET Application and then set the Excel.Application instance current directory to a custom folder. I want to do this so when the user clicks the save button in Excel, the Save as dialog is already located in the correct directory.</p>\n\n<p>I know it's possible to change the current directory in Excel Instance with VBA.FileSystem.ChDir and doing it within the Excel.Application instance with VBA Code/Macro like this:</p>\n\n<ol>\n<li><p>Create an Excel Spreadsheet from C# .NET</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();\nexcel.Workbooks.Add();\nexcel.Visible = true;  \n</code></pre></li>\n<li><p>When Excel spreadsheet is open, hit ALT + F11. Then create and run following macro   </p>\n\n<pre><code>Sub SetChdir()\n   Call FileSystem.ChDir(\"C:\\To\\My\\Custom\\Directory\\\")\nEnd Sub\n</code></pre></li>\n<li><p>When clicking Save in Excel the Current Directory is set path set with ChDir</p></li>\n</ol>\n\n<p>I can't figure out, or even if it's possible, how to create this behaviour from .NET. I tired messing around with Excel.DefaultFilePath which Excel uses on startup to set the Current Directory. But it has two problems:</p>\n\n<ul>\n<li>When DefaultFilePath is set to a different value, you need to restart Excel to make it effect on new or open spreadsheets</li>\n<li>I really don't want to change the users current DefaultFilePath as it is a Global value for Excel and not this individual spreadsheet.</li>\n</ul>\n"},{"tags":["vb.net","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":33,"score":-3,"question_id":12967906,"title":"How to input xls data into VB?","body":"<p>I have two columns of data. One column are numbers, and the other one is text. I need to read the numbers and transfer to text array format (each row is a text element). The text column just read as a text array (each row is a text element). How I can do that?</p>\n"},{"tags":["c#","excel","visual-studio-2008","import-from-excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12967052,"title":"I want to Read Multiple excel sheets in one file without using OLEDB in C#","body":"<p>Im reading an Excel document from C# Windows Form.. There are 25 worksheets in Excel Workbook.. i can read 1st worksheet successfully.. But when i change it to worksheet 2.. it won't working at all.. Im not using OLEDB..</p>\n\n<p>I want to read 100 Row in every sheet.. following is my code...</p>\n\n<pre><code>`       dt.Columns.Add(\"Amount\", typeof(double));\n        dt.Columns.Add(\"ChequeNo\", typeof(int));\n        dt.Columns.Add(\"month\", typeof(int));\n\n\n        int AmountRow = 100;\n        int ChequeNoRow = 101;\n        int Column = 3;\n\n        xlApp = new Excel.ApplicationClass();\n        xlWorkBook = xlApp.Workbooks.Open(path, 0, true, 5, \"\", \"\", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\n        xlWorkSheet = (Excel.Worksheet)xlWorkBook.Sheets[2];\\\\This place is the changing worksheets\n\n        range = xlWorkSheet.UsedRange;\n\n        double chequeAmount;\n        double chequeNo;\n\n        for (int i = Column; i &lt; 15; i++)\n        {\n            chequeAmount = (double)(range.Cells[AmountRow, i] as Excel.Range).Value2;\n            chequeNo = (double)(range.Cells[ChequeNoRow, i] as Excel.Range).Value2;\n\n            if (chequeNo != 0.0)\n            {\n                dt.Rows.Add(Convert.ToDouble(chequeAmount), Convert.ToInt32(chequeNo), i);\n            }\n        }\n\n        dataGridView1.DataSource = dt;\n        xlWorkBook.Close(true, null, null);\n        xlApp.Quit();\n\n        releaseObject(xlWorkSheet);\n        releaseObject(xlWorkBook);\n        releaseObject(xlApp);`\n</code></pre>\n\n<p>releaseObject methods are not here.. those working perfectly... </p>\n\n<pre><code> `xlWorkSheet = (Excel.Worksheet)xlWorkBook.Sheets[1];`\n</code></pre>\n\n<p>This is how i change my worksheets.. The following line gives an exception..[Null point Exception]</p>\n\n<p><code>chequeAmount = (double)(range.Cells[AmountRow, i] as Excel.Range).Value2;</code></p>\n\n<p>Hope you'll know answers..</p>\n"},{"tags":["excel","vba","double","overflow","rsa"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12965805,"title":"Incorrect VBA Overflow using Doubles (Excel)","body":"<p>For some reason, the following statement evaluates to zero.  I assume it's due to overflow, but all the interim values seem to be well within the limits of a double.</p>\n\n<pre><code>DiffieHellmanKey = (43 ^ 47) - (53 * Fix((43 ^ 47) / 53))\n</code></pre>\n\n<p>I think it's overflow because when I execute it with different numbers (below), it results in the correct value of 29.</p>\n\n<pre><code>DiffieHellmanKey = (5 ^ 22) - (53 * Fix((5 ^ 22) / 53))\n</code></pre>\n\n<p>What gives?  Now, back to the original numbers that are giving me overflow.  All variables involved are Doubles.  It doesn't even work if I calculate it as a Worksheet formula instead of in VBA:</p>\n\n<pre><code>=(43 ^ 47) - (53 * ROUNDDOWN(((43 ^ 47) / 53), 0))\n</code></pre>\n\n<p>And if I implement the above example in VBA using the equivalent form (below), I get an incorrect result of -1.75357E+62.</p>\n\n<pre><code>DiffieHellmanKey = (43 ^ 47) - (53 * WorksheetFunction.RoundDown(((43 ^ 47) / 53), 0))\n</code></pre>\n"},{"tags":["excel","apache-poi","xssf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12966306,"title":"Efficient way (using apache POI) to read an XLSX, replace the first row and write the result?","body":"<p>It seems the best option is to use the XSSF and SAX (Event API) but the docs aren't really that good and I can't find a simple example for my needs:</p>\n\n<p>I need to read a XLSX file, read the first row and first cell and then replace the text there (something like Title: TODO) and write the final file (Title: example).</p>\n\n<p>This must be very efficient in terms of memory-use. I don't mind the speed performance, just memory usage.</p>\n\n<p>Currently using apache poi 3.8</p>\n"},{"tags":["excel","ssas","pivot-table"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2532,"score":0,"question_id":998185,"title":"Excel Pivot Table Row Labels Not Refreshing","body":"<p>To all,</p>\n\n<p>I have an Excel spreadsheet pivot table that is linked to an SSAS data source.  The employee counts are aggregated and return the following values:</p>\n\n<p>Row Label      Count</p>\n\n<p>North America    7 <br>\nSouth America    2 <br>\nEurope           5 <br>\nAsia             1 <br>\nAustralia        3 <br></p>\n\n<p>Let's say the user modifies the South America Row to read \"Antarctica\" by accident, and then the spreadsheet is saved.  Now we have the following:</p>\n\n<p>Row Label      Count</p>\n\n<p>North America    7 <br>\nAntarctica       2 <br>\nEurope           5 <br>\nAsia             1 <br>\nAustralia        3 <br></p>\n\n<p>Which we know is wrong.  I refresh the data and the counts can change, but the row label remains \"Antarctica\" and does not change back to \"South America\".  I've check a number of Excel Pivot table settings but to no avail.</p>\n\n<p>Anyone able to solve this problem?</p>\n\n<p>Thanks - Mr. Do</p>\n"},{"tags":["excel","jsp","excel-2007","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":851,"score":0,"question_id":10983006,"title":"unreadable content error with apache POI 3.8","body":"<p>I'm using Apache POI 3.8. I have a JSP that generates an excel (.xslx) file. I developed it locally and the file could be opened without any problems.\nThen, I deployed the app in the Dev environment and when I open the generated excel file there, a warning box comes up saying: \"Excel found unreadable content in ausencias.xlsx. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.\"\nIf I click Yes, then the following alert appears: \"This file cannot be opened by using Microsoft Excel.  Do you want to search the Microsoft Office Online Web site for a converter that can open the file?\"\nIf I click No, the file is correctly opened. But I don't know why I get these errors.</p>\n\n<p>It happens even if I generate a simple empty .xslx file:</p>\n\n<pre><code>&lt;%@page import=\"java.io.FileOutputStream\"%&gt;\n&lt;%@page language=\"java\" contentType=\"text/html; charset=utf-8\" pageEncoding=\"utf-8\"%&gt;\n&lt;%@page import=\"java.io.IOException\"%&gt;\n&lt;%@page import=\"javax.servlet.*\"%&gt;\n\n&lt;%@page import=\"org.apache.poi.ss.usermodel.*\"%&gt;    \n&lt;%@page import=\"org.apache.poi.ss.util.CellRangeAddress\"%&gt;\n&lt;%@page import=\"org.apache.poi.xssf.usermodel.*\"%&gt;\n\n&lt;%\n    response.setHeader (\"Content-Disposition\", \"attachment;filename=\\\"ausencias.xlsx\\\"\");\n    response.setContentType(\"application/vnd.ms-excel\");\n\n    Workbook wb = new XSSFWorkbook();\n\n    Sheet sheet = wb.createSheet(\"Ausencias\");\n\n    ServletOutputStream fout = response.getOutputStream();\n\n    wb.write(fout);\n    fout.flush();\n    fout.close();\n%&gt;\n</code></pre>\n\n<p>In my local machine, I have Microsoft Office Excel 2007 (12.0.6661.5000) SP2 MSO (12.0.6562.5003)\nIn the Dev environment, I have Microsoft Office Excel 2007 (12.0.6611.1000) SP3 MSO (12.0.6607.1000)</p>\n\n<p>Does anyone know a solution or a workaround?</p>\n\n<p>Thanks.</p>\n\n<p>EDIT: I have added the whole JSP code. I am aware that some imports may not be used; I just left them there when I cropped my original code looking for the problem.</p>\n\n<p>EDIT 2: I have opened in my local machine the document generated in the development environment and it throws the same warnings. So the problem is in the file, not in the Excel version. It seems like something is tampering with the file in the Dev Env. Any ideas??</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12962828,"title":"Excel transpose some rows into columns depending on values in another column","body":"<p>I have an Excel file I'm getting that looks something like this:</p>\n\n<pre><code>Time  012345  2345678   5647890 7891234\n6:00    1        0         0       1\n6:30    1        1         0       1\n7:00    1        1         0       0\n7:30    0        0         0       0\n8:00    0        0         1       0\n8:30    0        0         1       0\n9:00    0        0         1       0\n9:30    0        0         1       0\n10:00   0        0         0       0\n10:30   1        0         0       1\n11:00   1        0         0       1\n11:30   1        0         0       1\n12:00   1        0         0       1\n12:30   0        0         0       0\n13:00   0        0         0       0\n13:30   0        0         1       0\n14:00   0        0         1       0\n14:30   0        0         1       0\n15:00   0        0         1       0\n15:30   1        1         0       0\n</code></pre>\n\n<p>etc.</p>\n\n<p>The goal is to get these transposed but to take the time values instead of the actual 1s and 0s in the columns. The ideal output would look like this:</p>\n\n<pre><code>userID    startTime1   stopTime1   startTime2   stopTime2   startTime3  stopTime3\n012345      6:00         7:30         10:00       12:30        15:00\n2345678     6:00         7:30         15:00\n5647890     7:30         10:00        13:00       15:30        \n7891234     6:00         7:00         10:00       12:30\n</code></pre>\n\n<p>I've tried setting up a pivot table and filtering, and that hasn't gotten me anywhere. And I'm not sure what else to try. V and HLOOKUPS haven't done the trick for me either.</p>\n\n<p>Part of the problem is that the start time needs to be the timestamp one row above the 1 and the stop time needs to be the timestamp 1 row below the final 1 in a group. Doing simple things like if statements hasn't helped me because I need the first and last time in each group from the column. So I'm pretty stumped.</p>\n\n<p>Any help on this would be appreciated.</p>\n"},{"tags":["php","excel","encoding","delimiter","separator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12963175,"title":"How to fix \"tabs\" in Excel Export (PHP)?","body":"<p>I applied <a href=\"http://stackoverflow.com/questions/4348802/how-can-i-output-a-utf-8-csv-in-php-that-excel-will-read-properly\">this solution</a> to solve an encoding problem I got exporting files to .CSV and Excel and it worked successfully, but now another problem emerged:</p>\n\n<p>The tabs (\"\\t\") I use in PHP as the delimiter for Excel files stopped working. It was working before I solve the previous problem. When I open the excel file, it display likes:</p>\n\n<blockquote>\n  <p>\"ColumnAColumbBColumnC\" (all together).</p>\n</blockquote>\n\n<p>If a export it like csv <code>('Content-type: text/csv; charset=UTF-8'</code>) I have success, but not as Excel (<code>Content-type: application/vnd.ms-excel; charset=UTF-8</code>).</p>\n\n<p>Any solution for this?</p>\n\n<p>Note: using \",\" as a separator is not a good solution for me, because I have values with \",\" in some fields.</p>\n"},{"tags":["excel","vba","error-handling","microsoft","pivot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":12964470,"title":"VBA Pivot Table Errors","body":"<p>I'm trying to make an Excel worksheet more readable and easier for me to work with by writing user defined functions\nI'm trying to convert a formula like this,</p>\n\n<p>=If(IsErr(GetPivotData(Pivot Look up information here)),0,GetPivotData(Pivot Look up information here))</p>\n\n<p>With a vba code</p>\n\n<p>pt.GetPivotData(Pivot Look up information here)</p>\n\n<p>I'm having trouble detecting problems with the lookup query in VBA. In the above formula this is handled with the IsErr function. I've tried using IsError(pt.GetPivotData(Pivot lookup information here)), but the program crashes with Run-time error '1004' Application-defined or object-defined error. I get this same error when I call the function from a sub without the IsError.</p>\n\n<p>How can I get VBA to detect these errors?</p>\n"},{"tags":["excel","excel-formula"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12945672,"title":"INDEX(INDIRECT(\"DefinedName\"),1)=#REF while INDEX(DefinedName,1) works","body":"<p>In an excel workbook, I'm referencing a defined name from another tab (to get dependent data validation). Accessing the defined name directly works, but accessing it through <code>INDIRECT</code> doesn't. </p>\n\n<p><code>=INDEX(DefinedName,1)</code> returns the first value of the range</p>\n\n<p><code>=INDEX(INDIRECT(\"DefinedName\"),1)</code> returns #REF!</p>\n\n<p>I have also tried</p>\n\n<p><code>=INDEX(INDIRECT(\"SheetName!DefinedName\"),1)</code>, but it also returns #REF!</p>\n\n<p>Sample file can be downloaded <a href=\"https://docs.google.com/open?id=0B04VM-tmdCnIekJZTEthRXVyVzA\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["osx","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12964060,"title":"MAC OS X: find a computer independent path to a Dropbox local folder in excel formula or excel macro","body":"<p>I would like to define a computer independent path to access an Excel file stored in a Dropbox local folder from an Excel cell or from an Excel macro.<br>\nCurrently if I refer to a file stored locally on a Dropbox folder either in my excel cell or in my excel macro, it will only work on one computer.<br>\nI would like the path to be generic such that it works from different computers with the same dropbox account.</p>\n\n<p>Ideally I would like to make this path PC or MAC agnostic</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12963271,"title":"VBA - Call function inside a sub (module)","body":"<p>I have the following function in vba:</p>\n\n<pre><code>Public Function lorh(custo As Integer)\nIf custo &gt; 10.99 And custo &lt;&gt; 0 Then\n    lorh = \"1.4\"\nElse\n    If custo &lt; 11 And custo &lt;&gt; 0 Then\n        lorh = \"1.35\"\n    Else\n        If custo &lt;= 0 Or custo &lt; 0 Then\n            lorh = \"Valor Inválido\"\n        End If\n    End If\nEnd If\nEnd Function\n</code></pre>\n\n<p>Now what I need is to call this function starting from a sub or better from a macro, so I can associate it to a custom button on the excel toolbar . Can anyone guide me? </p>\n"},{"tags":["php","mysql","database","excel","odbc"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12945623,"title":"Is there a way to use ODBC to give users ability to download MySQL as a formatted excel file?","body":"<p>I have a survey site that collects data from user inputs and stores it in MySQL. </p>\n\n<p>I want some users to be able to go to a page that allows them to download a formatted excel file of the data (note, not a csv).</p>\n\n<p>I've heard ODBC allows you to interface excel with MySQL, but can't find any server side applications for it.</p>\n\n<p>Is it possible?</p>\n\n<p>I'm using PHP for the site.</p>\n\n<p>Thanks</p>\n"},{"tags":["vb.net","excel","exception-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12930845,"title":"command button run time exception","body":"<p>I have a sample code for creating button in an excel sheet vb.net code as follows:</p>\n\n<pre><code>Dim button As Microsoft.Office.Interop.Excel.OLEObject\nbutton = _xlWorksheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", _\n   Link:=False, DisplayAsIcon:=False, Left:=0, Top:=0, Width:=100, Height:=30)\nbutton.Name = \"Send Mail\"\n\nDim oCommandBar As Microsoft.Office.Core.CommandBar\nDim oCommandBarButton As Microsoft.Office.Core.CommandBarControl\nDim tb As String = \"My Toolbar\"\nDim _btnCaption As String = \"Forward To BSC\"\n'Dim code As String\n\n'code = \"Sub button_Click()\" &amp; vbCrLf\n'code = code &amp; \"Call Tester\" &amp; vbCrLf\n'code = code &amp; \"End Sub\"\n\nTry\n   oCommandBar = _xlApp.CommandBars.Add(.......) \n\n   'oCommandBar = _xlApp.CommandBars.Add(.....)\n   oCommandBar.Visible = True\n\n   oCommandBarButton = oCommandBar.Controls.Add(button)\n   oCommandBarButton.Caption = _btnCaption\n   oCommandBarButton.OnAction = \"button_Click\"\nCatch ex As Exception\n   Console.WriteLine(ex.Message)\nEnd Try\n\n Sub Tester()\n      MsgBox(\"You have click on the test button\")\n End Sub\n</code></pre>\n\n<p>I am not sure what to add in the following:<br>\n<code>_xlApp.CommandBars.Add(.......) and _xlApp.CommandBars.Add(.....)</code></p>\n\n<p>Please advise. Also specify namespaces required. This is a in a console app.</p>\n"},{"tags":["excel","vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12963033,"title":"Excel VBA get date from a string","body":"<p>If I have a cell with the following:</p>\n\n<pre><code>Tuesday, April 16th 2009\n</code></pre>\n\n<p>How do I convert that string into a date format recognized by Excel. I think I have to use MID() and FIND() functions.</p>\n"},{"tags":["excel","excel-vba","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":42,"score":-1,"question_id":12962970,"title":"How To: Create a 1 column form on sheet2 that will extract data from sheet1","body":"<p>I have tried a number of different values and sorts and filters but my data is difficult to re-align so I think it would be better to use my Sheet_raw as a dB of information, then extract the info from it into a specific format. That's my objective, the extracted data will be uploaded to a dB so I need it in a specific format.</p>\n\n<p>I have two sheets (Sheet Raw &amp; Sheet Upload)</p>\n\n<p>Sheet Raw is raw data that has 5 columns (Title, Type, Title2, SN, ID)</p>\n\n<p>I would like on \"Sheet Upload\" is type only in Column A an ID# that is from Sheet Raw and it extract the information associated with that specific ID# and put it in column C,D,E,F on \"sheet upload\"...</p>\n\n<p>So my exercise would be, copy the ID from Sheet Raw, place the ID# in Column A of Sheet Upload, with the formula in-place it would extract the associated data from from Sheet Raw and put it on Sheet Upload columns, C,D,E,F...</p>\n"},{"tags":["c#",".net","excel","connection"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":118,"score":0,"question_id":12959382,"title":"Connection to large excel file is very slow","body":"<p>I have a very large excel file, it has about one milion rows and have size about 400MB.\nI need to estabilish some System.Data.IDbConnection to this file. For now, i tried two aproaches:\n1)</p>\n\n<pre><code>System.Data.OleDb.OleDbConnection(\"provider=Microsoft.ACE.OLEDB.12.0;Data Source='D:\\\\file.xls';Extended Properties='Excel 12.0;HDR=YES;IMEX=1';\");\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>System.Data.Odbc.OdbcConnection(\"Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};DBQ=&lt;FILE&gt;;ReadOnly=True;Extended Properties=\\\"Excel 12.0;HDR=Yes;IMEX=1\\\"\")\n</code></pre>\n\n<p>Both connections work just fine for small files (25MB). But even for 25MB file, opening connection take about 4seconds.</p>\n\n<p>When I use 350MB file, this simple command: </p>\n\n<pre><code>connection.Open();\n</code></pre>\n\n<p>takes more than 3 minutes and i cannot use so slow connection. </p>\n\n<p>Is there any free sollution to get fast IDbConnection for reading large excel file?\nThanks for any help.</p>\n"},{"tags":["excel","append","ms-office"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":88,"score":-1,"question_id":12961882,"title":"Combine multiple excel tables into 1 table that will automatically update","body":"<p>I have a question that relates directly to this post: <a href=\"http://stackoverflow.com/questions/9923385/combine-2-ms-excel-tables-into-one-appending-the-data\">combine 2 ms excel tables into one appending the data?</a></p>\n\n<p>The asker wanted to be able to combine these 2 tables in excel:</p>\n\n<pre>===========================\nno.  f_name     l_name  \n===========================\n13   Little     Timmy\n 1   John       Doe\n17   Baby       Jessica\n---------------------------</pre>\n\n<p>2nd table:</p>\n\n<pre>===========================\nno.  f_name     l_name  \n===========================\n 1   john       Tim\n16   kyle       joe\n14   Baby       katy\n22   qbcd       wsde\n---------------------------</pre>\n\n<p><a href=\"http://stackoverflow.com/users/698590/gaffi\">Gaffi</a> offered some code for a macro as a response to this post, which I tried out with the given example, and this is what it came up with:</p>\n\n<pre>Origin Sheet   no.  f_name  l_name\nSheet1         13   Little  Timmy\nSheet1         1    John    Doe\nSheet1         17   Baby    Jessica\nSheet1         #N/A #N/A    #N/A\nSheet2         1    john    Tim\nSheet2         16   kyle    joe\nSheet2         14   Baby    katy\nSheet2         22   qbcd    wsde\nSheet2         #N/A #N/A    #N/A</pre>\n\n<p>Not sure why the #N/A answers are being output, and furthermore I would like to know the following:</p>\n\n<ul>\n<li><strong>Is there a way to create a table in excel that is a dynamic combination of multiple different tables, from multiple different workbooks, that will automatically update as data is entered and saved into the original tables?</strong></li>\n</ul>\n\n<p>Clearly, the source tables will have matching columns.  In my case, it will be columns A-I, with data in the form of text and dates in each column.  I have tried using pivot tables, and they seem to only give me sums and averages, when all I really want is data to be appended in real time.  Any help would be greatly appreciated, I have been searching and trying for a couple hours now!  Thanks!</p>\n\n<p>I am using Office 2010, however the source tables will most likely be from Office 2003.</p>\n"},{"tags":["excel","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12962240,"title":"FIxing MS Excel date time format","body":"<p>A reporting service generates a csv file and certain columns (oddly enough) have mixed date/time format , some rows contain datetime expressed as m/d/y, others as d.m.y </p>\n\n<p>When applying =TYPE() it will either return 1 or 2 (Excel will recognize either a text or a number (the Excel timestamp))</p>\n\n<p>How can I convert any kind of wrong date-time format into a \"normal\" format that can be used and ensure some consistency of data?</p>\n\n<p>I am thinking of 2 solutions at this moment :</p>\n\n<ul>\n<li>i should somehow process the odd data with existing excel functions</li>\n<li>i should ask the report to be generated correctly from the very beginning and avoid this hassle in the first place</li>\n</ul>\n\n<p>Thanks</p>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12962656,"title":"Format cells in excel for decimal places using a macro","body":"<p>How can I format Cell (D:) 2 decimals places Cell (E:) 1 decimal place and Cell (H:)3 decimals places in excel using a macro?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12952989,"title":"Removing option from subsequent dropdown based in selection in another","body":"<p>I have three drop downs in my VBA form (<strong>cbo_fac1</strong>, <strong>cbo_fac2</strong>, <strong>cbo_fac3</strong>), each extracting data from the same source. But I would like to implement a cascade update on the group of select lists so that when the user picks an option from one it is removed from subsequent select lists. </p>\n\n<p>For example if <strong>cbo_fac1</strong> has the following options:</p>\n\n<pre><code>Blu-ray DVD Player\nChalk board\nComputer \nData projector\nData projector trolley\n</code></pre>\n\n<p>and the user selects <code>Blu-ray DVD Player</code> from <strong>cbo_fac1</strong> then the next two drop downs (<strong>cbo_fac2</strong> and <strong>cbo_fac3</strong>) should only have the following options available:</p>\n\n<pre><code>Chalk board\nComputer \nData projector\nData projector trolley\n</code></pre>\n\n<p>If the user then decides to pick <code>Data projector trolley</code> from <strong>cbo_fac2</strong> then the next and final drop (<strong>cbo_fac3</strong>) down should only have the following options for selection:</p>\n\n<pre><code>Chalk board\nComputer \nData projector\n</code></pre>\n\n<p>Of course if the user decides to go back and change their options then this should also reflect. How would I go about achieving this. This is the code I have so far: </p>\n\n<pre><code>   For Each c_fac In ws_misc.Range(\"fac\")\n        With Me.cbo_fac1\n        .AddItem c_fac.Value\n        .List(.ListCount - 1, 1) = c_fac.Offset(0, 1).Value\n         End With\n        With Me.cbo_fac2\n        .AddItem c_fac.Value\n        .List(.ListCount - 1, 1) = c_fac.Offset(0, 1).Value\n        End With\n        With Me.cbo_fac3\n        .AddItem c_fac.Value\n        .List(.ListCount - 1, 1) = c_fac.Offset(0, 1).Value\n        End With\n      Next c_fac\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["excel","excel-vba","excel-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12961953,"title":"Add VALUES + INDEX to ActiveX ComboBox in Excel with VBA","body":"<p>How can I add items and an index to a combo box, I've got the below, but it says it's an invalid argument:</p>\n\n<pre><code>Me.lstDataSet.AddItem wsB.Range(\"B5\"), wsB.Range(\"A5\")\n</code></pre>\n\n<p><code>A5</code> is an integer (index) value [34] and <code>B5</code> is a string/date (actual) value [04 Jan 2012].  For reference, code that comes before this imports the last updated/inserted record from a database.</p>\n\n<p>What I want to achieve is to have the combobox display [ 001 | String Value ], ie display two columns, which I can then reference later.</p>\n"},{"tags":["excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12932741,"title":"Copying specific data from one sheet to another","body":"<p>2 columns on master sheet: </p>\n\n<pre><code>col1      col2\nApple     Fruit\nSpinach   Veg\nOrange    Fruit\nPotatoe   Veg   \nPear      Fruit\nBannana   Fruit\nCarrot    Veg\nPotataoe  Veg\n</code></pre>\n\n<p>Say I wanted to copy all <code>Fruit</code> data to a another sheet and all <code>Veg</code> data to a 3rd sheet. Is there a way to do this? Does it require a macro or can I somehow do a <code>VLOOKUP</code>?</p>\n\n<p>Also I need this to be dynamic, so if a new row is added the corresponding sheets are updated.</p>\n"},{"tags":["windows","excel","scripting","vbscript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":12958458,"title":"Searching all cells in a column Excel with vbscript","body":"<p>I wrote a vbScript to gather computer information for each user's computer on login, and Id like to have the script record the information to an Excel sheet on the server, with each computer having its own row.</p>\n\n<p>I wrote this like 6 years ago but lost the script and havent touched vbScript since.</p>\n\n<p>So what I need to do is, </p>\n\n<ol>\n<li>check all the cells in column B (which would be computer name) that have a value</li>\n<li>compare that value to value saved for the computer's name</li>\n<li>if it matches, write the  computer info to that row</li>\n<li>if there are no matches, then write the info to the first empty row</li>\n</ol>\n\n<p>I have no idea where to start since vbScript is pretty foreign to me.</p>\n\n<p>Edit - I have this loop so far and that echo to test it, but it only goes to 1, while I have like 6 rows with values in column 0. I tried that conditional to check the cell value for a value I know exists and I get a runtime error.</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"test.xlsx\")\nDo While objExcel.ActiveCell.Offset(iRow,0).Value&lt;&gt;\"\"\n   WScript.Echo iRow\n   If objExcel.Cells(iRow,0).Value = \"three\" Then\n    WScript.Echo \"three\"\n   End If\n   iRow = iRow+1\nLoop\nWScript.Quit\n</code></pre>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12957683,"title":"VBA Programming for Microsoft Excel Macro","body":"<p>While implementing a macro via Visual Basic Editor, i got an error \"Compile Error: Procedure Too Long\".........i wanted to know why is there a limit to the size of the macro and is there any way to increase the allowed size. My macro is pretty big (based on around 150 different cases) and because of this error i will have to divide the task among 8 macros approximately. Is there anyway around it?</p>\n\n<p>Will appreciate your help. </p>\n"},{"tags":["perl","excel","ole","workbook"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12961662,"title":"How do I use Perl to run a macro in an **already open** Excel workbook","body":"<p>I would like to use Perl to run a macro in an <strong>already open</strong> Excel workbook.  </p>\n\n<p>The following code works if I just want to open a workbook and run a macro:</p>\n\n<pre><code>#!C:\\Perl\\bin\\perl.exe    \nuse strict;\nuse Win32::OLE;\n\nmy $Excel = Win32::OLE-&gt;new('Excel.Application') or die;\n$Excel-&gt;Workbooks-&gt;open('M:\\Programs\\MyExcelFile.xls');\n$Excel-&gt;run('Book1!ChartData');\n$Excel-&gt;quit;\n</code></pre>\n\n<p>But how do I operate on an <strong>open</strong> workbook?</p>\n"},{"tags":["excel","vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12958635,"title":"How to populate a ListBox by differencies between two columns","body":"<p>I want to populate ListBox by differencies between two columns<br>\ni.e. if a cell exists in one column, and doesn't exist in the second one</p>\n\n<pre><code>Dim r1 As Range, r2 As Range\nSet r1 = Range(Sheets(1).Range(\"B2\"), Sheets(1).Range(\"B\" &amp; Rows.Count).End(xlUp))\nSet r2 = Range(Sheets(2).Range(\"B2\"), Sheets(2).Range(\"B\" &amp; Rows.Count).End(xlUp))\nFor Each cc In r1.Cells\nFor Each cell In r2.Cells\nIf Not cc.Value = cell.Value Then Form1.ListBox1.AddItem cell.Value\nNext cell\nNext cc\nForm1.Show\n</code></pre>\n\n<p>What I got is endless proccess (sandClock icon).</p>\n"},{"tags":["excel","vba","subroutine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12941852,"title":"VBA Subroutine declaration issue stoping excel VBA from properly executing","body":"<p>I am working on a simple subroutine to pull values from the Primary Worksheet and to move those values to the additional sheets. When I run the VBA macro it never gets past the subroutine declaration, any suggestions would greatly be appreciated.</p>\n\n<pre><code>Option Explicit\nSub Macro2()\nDim rCell As Range, ws As Worksheet\nApplication.DisplayAlerts = False\n\nWith Sheets(\"Sheet1\")\nSheets.Add().Name = \"Temp\"\n.Range(\"D2\", .Range(\"D\" &amp; Rows.Count).End(xlUp)).AdvancedFilter Action:=xlFilterCopy,         CopyToRange:=Sheets(\"Temp\").Range(\"B1\"), Unique:=True\nFor Each rCell In Sheets(\"Temp\").Range(\"D2\", Sheets(\"Temp\").Range(\"B\" &amp; Rows.Count).End(xlUp))\n    If Not IsEmpty(rCell) Then\n        .Range(\"D2\").AutoFilter field:=3, Criteria1:=rCell\n        If SheetExists(rCell.Text) Then\n            Set ws = Sheets(rCell.Text)\n        Else\n            Set ws = Worksheet.Add(After:=Worksheets(Worksheets.Count - 1))\n            ws.Name = rCell\n        End If\n        With .AutoFilter.Range\n            .Offset(1).Resize(.Rows.Count - 1).Copy ws.Range(\"A\" &amp; Rows.Count).End(xlUp)(2)\n        End With\n    End If\nNext rCell\nSheets(\"Temp\").Delete\n.AutoFilterMode = False\nEnd With\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>added Function </p>\n\n<pre><code> Function SheetExists(shtName As String, Optional wb As Workbook) As Boolean\n Dim sht As Worksheet\n\n If wb Is Nothing Then Set wb = ThisWorkbook\n On Error Resume Next\n Set sht = wb.Sheets(shtName)\n On Error GoTo 0\n SheetExists = Not sht Is Nothing\n End Function\n</code></pre>\n\n<p>New error </p>\n\n<pre><code>extract range has a illegal or missing field name\n</code></pre>\n\n<p>@ </p>\n\n<pre><code>.Range(\"D2\", .Range(\"D\"&amp;Rows.Count).End(xlDown)).AdvancedFilter  Action:=xlFilterCopy, CopyToRange:=Sheets(\"Temp\").Range(\"B1\"), Unique:=True\n</code></pre>\n"},{"tags":["asp.net","asp.net-mvc","excel","asp.net-mvc-4","npoi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12953901,"title":"NPOI - saving workbook created from template file","body":"<p>It is my 2nd time dealing with NPOI. I'm creating a workbook from a template excel file like this.</p>\n\n<pre><code>        string dldir = AppDomain.CurrentDomain.BaseDirectory + \"Download\\\\excel\\\\\";\n        string uldir = AppDomain.CurrentDomain.BaseDirectory + \"Upload\\\\default_export_file\\\\\";\n        string filename = DateTime.Now.ToString(\"yyyy-M-d\") + \"_\" + user.first_name + \"_\" + query.default_export_filename;\n\n        System.IO.File.Delete(Path.Combine(dldir, filename));\n\n        //System.IO.File.Copy(Path.Combine(uldir, query.default_export_filename), Path.Combine(dldir, filename));\n\n\n        HSSFWorkbook hssfwb;\n        using (FileStream file = new FileStream(Path.Combine(uldir, query.default_export_filename), FileMode.Open, FileAccess.ReadWrite))\n        {\n            hssfwb = new HSSFWorkbook(file);\n        }\n\n        MemoryStream mstream = new MemoryStream();\n        hssfwb.Write(mstream);\n\n        FileStream xfile = new FileStream(Path.Combine(dldir, filename), FileMode.Create, System.IO.FileAccess.Write);\n        byte[] bytes = new byte[mstream.Length];\n        mstream.Read(bytes, 0, (int)mstream.Length);\n        xfile.Write(bytes, 0, bytes.Length);\n        xfile.Close();\n        mstream.Close();\n</code></pre>\n\n<p>But when I checked the created file. It contains nothing. The size is correct. But the contents is just blanks. And I couldn't open it in MS Excel either. I repeated and traced the code but I can't seem to find what is causing it to just write blanks.</p>\n\n<p>Anyone knows why is this happening</p>\n\n<p>FYI: I'm using VS 2010, ASP.Net MVC 4 and NPOI 1.2.5 installed from the NuGet Gallery</p>\n"},{"tags":["string","excel","search"],"answer_count":11,"favorite_count":8,"up_vote_count":30,"down_vote_count":0,"view_count":70180,"score":30,"question_id":350264,"title":"How can I perform a reverse string search in Excel without using VBA?","body":"<p>I have an Excel spreadsheet containing a list of strings. Each string is made up of several words, but the number of words in each string is different.</p>\n\n<p>Using built in Excel functions (no VBA), is there a way to isolate the last word in each string?</p>\n\n<p>Examples:</p>\n\n<pre>\n  Are you classified as human? -> human?\nNegative, I am a meat popsicle -> popsicle\n                  Aziz! Light! -> Light!</pre>\n"},{"tags":["excel","excel-formula"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12641248,"title":"Multiple VLOOKUP LOOKUP IF Statement?","body":"<p>I've got the below tables.<br>\nWhat I need to do is have a VLOOKUP/LOOKUP statement which looks a the month under 'Compare' and tells me if that month is included under the column 'Month,'  If it is, then look at Sent and Paid.  If both columns have Yes in then then return Yes, otherwise return the value in the Paid column.   </p>\n\n<p>It does however need to check if say 1st Feb is inbetween the months, so in this example, if 1st Feb is between 1st Jan and March, use the data from Jan.  At the moment I am doing this using a combination of VLOOKUP and LOOKUP:</p>\n\n<pre><code>=VLOOKUP(LOOKUP(I21,$L$4:$L$15),$L$4:$Q$15,6,FALSE)\n</code></pre>\n\n<p>I21 is the \"Compare\" month, L4-L15 is the \"Month\" column, L4-Q15 is the full range up to Sent, and 6 is for the Sent column.  At the moment I am not included the Paid column which I need to do as explained above.</p>\n\n<pre><code>  Month          Sent?          Paid?\n  1st Jan        Yes            Yes\n  1st Mar        Yes            No\n  1st Jun        No             No\n  1st Oct        N/A            N/A\n\n Compare\n 1st Jan\n 1st Feb\n 1st Mar\n ...\n 1st Jun\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12958668,"title":"Date Change with VBA Excel add/subtract in two different cells","body":"<p>How can I create a macro that will add a day in one cell and subtract a day in another cell at the same time?  Here is what I have so far.</p>\n\n<pre><code>Sub ChangeDates()\n\nDim cell As Range\n\nFor Each cell In Range(\"B:B\")\n    cell.Value = cell.Value + 1\nNext cell\n\nFor Each cell In Range(\"C:C\")\n\n    cell.Value = cell.Value - 1\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12959174,"title":"Excel Cell Text Not Displaying Into Next Blank Cell","body":"<p>Normally when you type enough characters in cell A1, they display over the cell(s) to the right (B1, C1, etc.).\nI had a workbook where this was the case, then suddenly I noticed that the text in A1 only displayed in A1 and no longer displayed over the cells to the right. Cells B1, C1, etc. were completely empty/deleted/cleared. I could find no cell formatting like wrap text or otherwise that would cause this.</p>\n\n<p>Is there a setting, global or otherwise, that would cause or allow this behavior?</p>\n\n<p>Merge cells sort of makes the text appear as desired, but it doesn't make sense that this is the best fix. The cells were never merged before, and don't need to be merged in a new workbook for the \"normal\" behavior to be seen.</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12952006,"title":"Excel Shape row and column for buttons of same name","body":"<p>I have various shapes on my excel 07 worksheet which are identical (same name, same function linked to it).</p>\n\n<p>I need to know which of these is pressed (TopLeft Row/Column). Application.Caller correctly identifies the name, but since there are multiple instances of it I am then unable to identify which one it pressed.</p>\n\n<p>Since I am copying the shapes numerous times would prefer for them to be all called the same.</p>\n"},{"tags":["excel","vbscript","macros","citrix"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":315,"score":0,"question_id":6655367,"title":"Could not load automation class \"Excel.Application\" - VBScript Move Mouse","body":"<p>I'm using the code from my previous question : <a href=\"http://stackoverflow.com/questions/6613703/move-mouse-vbscript-and-excel-macro\">Move Mouse - VBScript and Excel Macro</a></p>\n\n<p>My aim is to move the mouse using VBScript and this works through using Excel. The problem is, this runs fine on my home machine, which has Office 2007 on.</p>\n\n<p>However, when running this script at work, I get the following error:</p>\n\n<p>\"Could not locate automation class named \"Excel.Application\"\"</p>\n\n<p>The only difference I can see that these work computers have is that they have Office 2003 installed instead, so Excel.Aplacation needs to be changed to something else maybe?</p>\n\n<p>Google yielded no useful results. I'm creating this in notepad. Can someone help? If I can get this working it's be pretty amazing.</p>\n"},{"tags":["excel","vba","module","pivot-table"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12954742,"title":"Excel PivotTable Conditional Formatting","body":"<p>I have a pivot table in an Excel worksheet that contains the result of a query made to my database. I would like to format the information automatically based on every other data set. </p>\n\n<p>The information contains 4 weeks' (1 month) worth of records for each employee sorted by an  employee ID number. I would like to write a module so that it will highlight every other record (employee data set) with a different color. Is this even possible to do? Thanks for the help!</p>\n\n<p><img src=\"http://i.stack.imgur.com/m6qCS.gif\" alt=\"enter image description here\"></p>\n"},{"tags":["excel","excel-vba","vbscript"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":12861095,"title":"Transform a worksheet to an array containing only strings","body":"<p>I need to extract the data from an excel worksheet to an array that will be used in an application that uses VBScript as scripting language (Quick Test Professional). We can use the following code for that:</p>\n\n<pre><code>' ws must be an object of type Worksheet\nPublic Function GetArrayFromWorksheet(byref ws)\n    GetArrayFromWorksheet = ws.UsedRange.Value\nEnd Function\n\nmyArray = GetArrayFromWorksheet(myWorksheet)\nMsgBox \"The value of cell C2 = \" &amp; myArray(2, 3)\n</code></pre>\n\n<p>All nice and well, but unfortunately the array that gets returned does not only contain the literal text strings, but also primitives of type date, integer, double etc. It happened multiple times that that data got transformed.</p>\n\n<p>[edit] <strong>Example:</strong> when entering <code>=NOW()</code> in a cell and set the cell formatting to <code>hh:mm</code> makes the displayed value <strong>17:45</strong>, the above method retuns a variable of type <code>double</code> and a value like <strong>41194.7400990741</strong></p>\n\n<p>The following solution worked better: I can get the literal text from a cell by using the <code>.Text</code> property, but they only work on one cell and not on a range of cells. I cannot do this at once for an array as I could with the <code>.Value</code> property, so I have to fill the array one cell at a time:</p>\n\n<pre><code>Public Function GetArrayFromWorksheet_2(byref ws)\n    Dim range, myArr(), row, col\n    Set range = ws.UsedRange\n\n    ' build a new array with the row / column count as upperbound\n    ReDim myArr(range.rows.count, range.columns.count)\n\n    For row = 1 to range.rows.count\n        For col = 1 to range.columns.count\n            myArr(row, col) = range.cells(row, col).text\n        Next\n    Next\n\n    GetArrayFromWorksheet_2 = myArr\nEnd Function\n</code></pre>\n\n<p>But ouch... a nested <code>for loop</code>. And yes, on big worksheets there is a significant performance drop noticable.<br>\nDoes somebody know a better way to do this?</p>\n"},{"tags":["excel","excel-vba","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":12955461,"title":"What difference does it make if one runs a VBA code in `Sheets`, in `ThisWorkbook`, or in `Modules`?","body":"<p>What difference does it make if one runs a VBA code in <code>Sheets</code> (<code>Sheet1</code>, <code>Sheet2</code>, etc.), in <code>ThisWorkbook</code>, or in <code>Modules</code> (<code>Module1</code> etc.)?</p>\n\n<p>In other words, which one should be used in which cases?</p>\n\n<p><img src=\"http://i.stack.imgur.com/m8gPD.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12955992,"title":"Trying to read and save a excel file (.xlsx) from stream to local folder using Filestream","body":"<p>The scenario is that a user uploads a excel (.xlsx) file through a FileUpload and the user needs to download that file from a stream and needs to convert it into an Excel file and store in a local folder.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>using (FileStream fs = new FileStream(@\"D:\\Download.xlsx\", FileMode.Create, FileAccess.Write))\n{\n\n    byte[] bytearray = new byte[16 * 1024];\n\n    int bytesRead = 0;\n    int totalBytesRead = 0;\n    do\n    {\n        bytesRead = fileStream.Read(bytearray, 0, bytearray.Length);\n        totalBytesRead += bytesRead;\n    } while (bytesRead &gt; 0);\n\n    fs.Write(bytearray, 0, bytearray.Length);\n    fs.Close();\n    fs.Dispose();\n}\n</code></pre>\n\n<p>I'm just a beginner can anyone tell me how to do it? </p>\n"},{"tags":["excel","vba","date","excel-vba"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":8035978,"title":"VBA Process to add a date into a cell next to a inserted line","body":"<p>I have an issue that i am trying to resolve.</p>\n\n<p>Basically i have two worksheets in one workbook.</p>\n\n<p><code>Sheet1 = Input</code></p>\n\n<p><code>Sheet2 = Data</code></p>\n\n<p>In the \"Input\" sheet the user would copy a random amount of lines which can vary in rows but not columns into this sheet. However I have included a Calender object for the user to select the date for the data is for.</p>\n\n<p>The image of the screen of my input is:</p>\n\n<p><a href=\"http://www.nrnails.co.uk/stack/input_screen.png\" rel=\"nofollow\">Input Screen</a></p>\n\n<p>What I need to do now is a create some VBA magic that basically copies the value in <code>C4 = Date</code> into each cell that has a data in there and paste this date into the DATE column \"G\".</p>\n\n<p>Then copy the range from <code>G2:N2</code> downwards till the last row and copy into my data worksheet which has exising data in there. so it will need to go into the last empty cell...</p>\n\n<p>your help will be great!</p>\n\n<p>Thanks,</p>\n"},{"tags":["excel","openxml","excel-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12957521,"title":"How to launch Excel with an XLSX stream","body":"<p>i've constructed an XLSX document in memory.</p>\n\n<p>i want to display the document to the user <em>without having to save a temporary file</em>.</p>\n\n<p>In the olden days i would simply automate Excel, and make</p>\n\n<pre><code>xl.Visible = true;\n</code></pre>\n\n<p>and the user would see it - no temporary files littering their computer.</p>\n\n<p>But i'm hoping to standardize on one code-base for <a href=\"http://epplus.codeplex.com/\" rel=\"nofollow\">server-side creation of Excel documents, and interactive creation of Excel documents</a>. On the server i would send the Stream down the <code>HttpResponse</code>, or as an SMTP attachment, and be done with it.</p>\n\n<p>Now i need a way to <em>stream</em> content into client-side Excel.</p>\n"},{"tags":["vb.net","excel","vba","excel-vba","bubble-chart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12923753,"title":"Excel VB.NET How do you change the border of an individual bubble in a bubble chart?","body":"<p>I am generating bubble charts in VB.NET and I think it would be nice to make the border of a bubble thicker, so its easier to see if there is an overlap, but I can't sort out how to do it. To do it by hand you just right click on the bubble, go to border styles and put in your value.</p>\n\n<p>I sorted out how to change the color of bubbles with:</p>\n\n<pre><code>.chart.SeriesCollection(i).interior.color = RGB\n</code></pre>\n\n<p>I have spent quite a bit of time reading around looking for something similar that will allow me to raise the border weight a point or so, but I have had no luck.</p>\n\n<p>Anyone know how to do it? Thanks as always SO!</p>\n\n<p>Update: What I did:</p>\n\n<pre><code>            With oChart\n\n            With CType(.SeriesCollection, Excel.SeriesCollection)\n                .NewSeries()\n                With CType(.Item(counterVal - 43), Excel.Series)\n                    .Name = mainSheet.Range(\"a\" &amp; counterVal).Value\n                    .XValues = mainSheet.Range(\"b\" &amp; counterVal).Value\n                    .Values = mainSheet.Range(\"d\" &amp; counterVal).Value\n                    .BubbleSizes = mainSheet.Range(\"c\" &amp; counterVal).Value\n                    .HasDataLabels = True\n                    .DataLabels.Position = XlDataLabelPosition.xlLabelPositionAbove\n                    'DL.ShowSeriesName = True\n                    .Has3DEffect = True\n                    .Format.ThreeD.SetThreeDFormat(Microsoft.Office.Core.MsoPresetThreeDFormat.msoThreeD1)\n                    '.Format.Line.Weight = 1.5\n                End With\n            End With\n        End With\n</code></pre>\n\n<p>I ended up just using 3D effects instead of the line weight, but I left them both in. </p>\n"},{"tags":["excel","vba","excel-vba","automation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":91,"score":-1,"question_id":12853800,"title":"Moving data based on information in one column and then sorting by data in another","body":"<p>Ok so best way to explain this, I have a spreadsheet that is produced monthly. It needs to be automated. From the report that gets shipped into excel I need to take all the data from the project number column and move it to another workbook. In this workbook are worksheets for 2012 and 2013. I need all of the projects starting 300, then 400, then 500 etc to move into the new workbook and then the 2012 projects to go into one worksheet and 2013 into another. How would I go about automating such a thing?</p>\n\n<p>Thanks for any help</p>\n\n<p>300873  <em>Company Name</em>                      10/09/2012<br>\n300874  <em>Company Name</em>                          10/09/2012<br>\n412774  <em>Company Name</em>                          30-01-12<br>\n412972  <em>Company Name</em>                          23-05-12<br>\n412986  <em>Company Name</em>                          17-07-12<br>\n413001  <em>Company Name</em>                          08/06/13<br>\n413048  <em>Company Name</em>                          14-08-12<br>\n413049  <em>Company Name</em>                          14-08-12<br>\n413062  <em>Company Name</em>                          20-08-13<br>\n413068  <em>Company Name</em>                          23-08-12<br>\n413169  <em>Company Name</em>                          21-09-13<br>\n510003  <em>Company Name</em>                      27-12-12<br>\n600161  <em>Company Name</em>                          28-02-12  </p>\n\n<p>So with these I would want all of the projects with 2012 to go into one sheet and all the others to go into a 2013 sheet in a sperate workbook, I would also need the 300--- projects to go into the spreadsheet and fill rows underneath the number 300 so this might include adding rows.</p>\n"},{"tags":["c#","asp.net","excel","epplus"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":853,"score":2,"question_id":11549139,"title":"EPPlus Error When Outputting .XLSX to Response","body":"<p>I have a weird issue here using EPPlus to create some .XLSX files. I have a package being created, and then being output to the response.</p>\n\n<p>I have created a package as follows:</p>\n\n<pre><code>var file = new FileInfo(@\"C:\\Test.xlsx\");\nExcelPackage package = new ExcelPackage(file);\n//...code to output data...//\npackage.Save();\n</code></pre>\n\n<p>This saves the file to my local C: drive correctly, and when I open it it works great. No errors or anything, formatting is correct, etc.</p>\n\n<p>However, I now wish to output this file to the response stream so I have modified the code I had to look like this:</p>\n\n<pre><code>ExcelPackage package = new ExcelPackage();\n//...code to output data...//\nMemoryStream result = new MemoryStream();\npackage.SaveAs(result);\ncontext.Response.Clear();\ncontext.Response.ContentType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";                                                       \ncontext.Response.AddHeader(\"Content-Disposition\", \"attachment;filename=MissionDetails.xlsx\");\nresult.WriteTo(context.Response.OutputStream);\ncontext.Response.End(); \n</code></pre>\n\n<p>BUT when I run THIS code I get the following prompt when trying to open the Excel file:</p>\n\n<blockquote>\n  <p>Excel found unreadable content in filename.xlsx. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes</p>\n</blockquote>\n\n<p>Clicking yes then displays the following prompt:</p>\n\n<blockquote>\n  <p>This file cannot be opened by using Microsoft Excel. Do you want to search the Microsoft Office Online Web site for a converter that can open the file?</p>\n</blockquote>\n\n<p>I select <code>No</code> here and then it opens the Excel file and displays this error:</p>\n\n<blockquote>\n  <p>Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.</p>\n</blockquote>\n\n<p><em>BUT</em> the file then loads fine and appears to be formatted correctly and everything. But every time I try to open the file it gives the same prompts and error message.</p>\n\n<blockquote>\n  <p><strong>Note:</strong> The code to output the data does not change for either of these scenarios.</p>\n</blockquote>\n\n<p>Has anyone seen anything like this? Or have any idea what could cause this to save the file incorrectly <em>only</em> when outputting to the response?</p>\n"},{"tags":["excel","vb6","oledb","adodb","msdasql"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1326,"score":0,"question_id":229404,"title":"Ignored columns using vb6 to extract from excel","body":"<p>I am trying to extract a table of values from an excel (2003) spreadsheet using vb6, the result of which needs to be stored in a (adodb) recordset. The table looks like this:</p>\n\n<pre>\n    Name   Option.1  Option.2  Option.3  Option.4  Option.5  Option.6 \n    -----------------------------------------------------------------\n    Name1         2         3         4\n    Name2         2         3         4\n    Name3         2         3         4\n    Name4         2         3         4\n    Name5         2         3         4\n    Name6         2         3         4\n    Name7         2         3         4\n    Name8         2         3         4\n    Name9         2         3         4         5         6         7  \n</pre>\n\n<p>Upon connecting and executing the query \"<code>SELECT * FROM [Sheet1$]</code>\" or even a column-specific, \"<code>SELECT [Option#6] FROM [Sheet1$]</code>\" (see footnote 1) and looping through the results, I am given <code>Null</code> values for the row <code>Name9</code>, <code>Option.4</code> --&gt; <code>Option.6</code> rather than the correct values 5, 6, and 7. It seems the connection to the spreadsheet is using a \"best guess\" of deciding what the valid table limits are, and only takes a set number of rows into account.  </p>\n\n<p>To connect to the spreadsheet, I have tried both connection providers <code>Microsoft.Jet.OLEDB.4.0</code> and <code>MSDASQL</code> and get the same problem.</p>\n\n<p>Here are the connection settings I use:</p>\n\n<pre><code>Set cn = New ADODB.Connection\nWith cn\n    .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n    .ConnectionString = \"Data Source=\" &amp; filePath &amp; \";Extended Properties=Excel 8.0;\"\n    - - - - OR - - - - \n    .Provider = \"MSDASQL\"\n    .ConnectionString = \"Driver={Microsoft Excel Driver (*.xls)};\" &amp; _\n                        \"DBQ=\" &amp; filePath &amp; \";MaxScanRows=0;\"\n    .CursorLocation = adUseClient\n    .Open\nEnd With  \nSet rsSelects = New ADODB.Recordset\nSet rsSelects = cn.Execute(\"SELECT [Option#5] FROM \" &amp; \"[\" &amp; strTbl &amp; \"]\")\n</code></pre>\n\n<p>This problem only occurs when there are more than 8 rows (excluding the column names), and I have set <code>MaxScanRow=0</code> for the <code>MSDASQL</code> connection, but this has produced the same results.</p>\n\n<p>Notable project references I have included are: </p>\n\n<ul>\n<li>MS ActiveX Data Objects 2.8 Library</li>\n<li>MS ActiveX Data Objects Recordset 2.8 Library</li>\n<li>MS Excel 11.0 Object Library</li>\n<li>MS Data Binding Collection VB 6.0 (SP4)</li>\n</ul>\n\n<p>Any help in this matter would be very appreciated!</p>\n\n<p>(1) For some reason, when including a decimal point in the column name, it is interpreted as a #.</p>\n\n<p><hr /></p>\n\n<p>Thanks everyone! Halfway through trying to set up a <code>Schema.ini</code> \"programmatically\" from <a href=\"http://support.microsoft.com/kb/155512\" rel=\"nofollow\">KB155512</a> <a href=\"http://stackoverflow.com/questions/229404/ignored-columns-using-vb6-to-extract-from-excel#229721\">onedaywhen</a>'s excellent <a href=\"http://www.dailydoseofexcel.com/archives/2004/06/03/external-data-mixed-data-types/\" rel=\"nofollow\">post</a> pointed me towards the solution:</p>\n\n<pre><code>.Provider = \"Microsoft.Jet.OLEDB.4.0\"\n.ConnectionString = \"Data Source=\" &amp; filePath &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes;IMEX=1\"\";\"\n</code></pre>\n\n<p>I would encourage anyone with similar problems to read the post and comments, since there are slight variations to a solution from one person to another.</p>\n"},{"tags":["java","excel","recursion","apache-poi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":12944161,"title":"Calculating the value of a recursion formula in EXCEL using POI","body":"<p>I have an EXCEL Spreadsheet that has many computations some including recursive formula's (perfectly fine in excel which computes these with no problem).</p>\n\n<p>I'm using version 3.8 of the Apache Poi API to open the existing spreadsheet, add updated values for the computations, save the spreadsheet and then read the results into my program.</p>\n\n<p>All of this works except the in memory poi version of the spreadsheet does not perform the recursive calculation.</p>\n\n<p>I'm calling the POI code to compute the entire workbook, each sheet and then each formula cell, but the cell formula never computes.</p>\n\n<p>If I open the saved spreadsheet and compute it the formula computes the value accurately. I need to avoid having the user manually open the saved spreadsheet if possible.</p>\n\n<p>Any insight in to this problem would be greatly appreciated.</p>\n\n<p>Here is the code I have tried.  It all runs with no error but does not compute the formula.</p>\n\n<p>The formula is already in the spreadsheet an works fine so I'm trying to force the formula to re-compute. </p>\n\n<p>I have tried all these variations.  The code runs and executes but does not compute the formula</p>\n\n<pre><code>wb.getCreationHelper().createFormulaEvaluator().evaluateAll();\n/*\n//wb.getCreationHelper().createFormulaEvaluator().evaluateAll();\nSystem.out.println(wb.getSheet(\"Rate Report\").getRow(16).getCell(0).getStringCellValue());\nSystem.out.println(wb.getSheet(\"Rate Report\").getRow(16).getCell(1).getNumericCellValue());\nFormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();\n\n//String wbsheets[] = {\"Original\",\"Main_DB\",\"Parameters\",\"Translator\",\"Workers Comp.\",\"Rate Report\",\"Notes Fields\"};\nString wbsheets[] = {\"Notes Fields\",\"Translator\",\"Parameters\",\"Rate Report\"};\nfor(String sheetName : wbsheets) {\nSheet sheet = wb.getSheet(sheetName);\nSystem.out.println(\"processing sheet: \" + sheet.getSheetName());\nfor(Row r : sheet) {\nfor(Cell c : r) {\nif(c.getCellType() == Cell.CELL_TYPE_FORMULA) {\nSystem.out.println(\"Recalcing: \"+r.getRowNum()+c.getColumnIndex() + \"in \"+ sheet.getSheetName());\nevaluator.evaluateFormulaCell(c);\n\n\n}\n}\n}\n}\n</code></pre>\n\n<p>XSSFFormulaEvaluator.evaluateAllFormulaCells((XSSFWorkbook) wb);</p>\n"},{"tags":["excel","vba","ms-access","ms-access-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12955456,"title":"ERROR 3011 ACCESS 2007","body":"<p>Hey everyone ive been checking on this site for some similar issues but i haven't found a response to my problem. My line that keeps crashing is:</p>\n\n<pre><code>  DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"MY_FUT_REPORT\", \"U:\\Desktop\\TEST.xls\", True, \"FUTURE\"\n</code></pre>\n\n<p>So MY_FUT_REPORT is a report and i want to transfer it into and excel sheet. I then have the following line below i want to append to the existing sheet.</p>\n\n<pre><code>    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"MY_ND_REPORT\", \"U:\\Desktop\\TEST.xls\", True, \"NEXT DAY\"\n</code></pre>\n\n<p>So far the first line crashes i've create multiple files to the same path and it works, also ive tried this line </p>\n\n<p>DoCmd.OutputTo acOutputReport, \"MY_FUT_REPORT\", acFormatXLS, \"U:\\Desktop\\TEST.xls\", 0</p>\n\n<p>which works perfectly so i am wondering what the issue is ive also tried the commands by replacing it to acSpreadsheetTypeExcel12Xml, but still no success. Can anyone help me!!!! </p>\n"},{"tags":["c#","asp.net","excel","interop","pia"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3355,"score":1,"question_id":285715,"title":"Automating Excel using ASP.NET","body":"<h2>Background</h2>\n\n<p>We are developing some in-house utilities using ASP.NET 2.0. One of which is extracting some information from databases and building an Excel workbook containing a number of spreadsheets with data based on queries into the database.</p>\n\n<h2>Problem</h2>\n\n<p>The proof-of-concept prototype (a simple ASP.NET page that queries a single item from the database and opens Excel to add data to a worksheet) is working well when run locally on the development machines, happily creating and displaying an Excel spreadsheet as requested.  However, when run on our server, we get the following error upon trying to instantiate Excel .</p>\n\n<p>Unable to cast COM object of type 'Microsoft.Office.Interop.Excel.ApplicationClass' to interface type 'Microsoft.Office.Interop.Excel._Application'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{000208D5-0000-0000-C000-000000000046}' failed due to the following error: No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE)).</p>\n\n<h2>Solution?</h2>\n\n<p>We are using the PIA for Excel 2003 and we have Excel 2003 and the PIA installed on the server. Can anyone explain why this isn't working or give us some tips on how we might track the problem down?</p>\n\n<p>Thanks for any assistance you can provide.</p>\n"},{"tags":["excel","vba","excel-vba","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12914678,"title":"How to insert extra column","body":"<p>the folowing code allows me to browse for multiple different excel files and paste them in a single sheet below each other.the excel file have the same column names but have different data in them and is working fine, my problem is i need it when it paste a file it must also create extra column and write the name of that file in that column for each and every file it paste. </p>\n\n<pre><code>Sub Button5_Click()\n Dim fileStr As Variant\n Dim wbk1 As Workbook, wbk2 As Workbook\n Dim ws1 As Worksheet\n\n fileStr = Application.GetOpenFilename(FileFilter:=\"microsoft excel files (*.xlsx), *.xlsx\", Title:=\"Get File\", MultiSelect:=True)\n Set wbk1 = ActiveWorkbook\n Set ws1 = wbk1.Sheets(\"Sheet3\")\n\n 'handling first file seperately\n MsgBox fileStr(1), , GetFileName(CStr(fileStr(1)))\n Set wbk2 = Workbooks.Open(fileStr(1))\n wbk2.Sheets(1).UsedRange.Copy ws1.Cells(ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 2, 1)\n\n wbk2.Close\n\n For i = 2 To UBound(fileStr)\n MsgBox fileStr(i), , GetFileName(CStr(fileStr(i)))\n\n Set wbk2 = Workbooks.Open(fileStr(i))\n 'using offset to skip the header - not the best solution,  but a quick one\n\n wbk2.Sheets(1).UsedRange.Offset(1, 0).Copy ws1.Cells(ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 2, 1)\n\n wbk2.Close\n Next i\n End Sub\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12935491,"title":"Reset a field based on selection of another in VBA","body":"<p>I have a drop down field in VBA called <strong>cbo_deptCode</strong>. I would like another set of fields called <strong>cbo_moduleCode</strong> and <strong>cbo_moduleName</strong> to be cleared of any current entry each time the user makes a selection from the drop down <strong>cbo_deptCode</strong>. The combo boxes are form controls. How can I go about achieving this?</p>\n"},{"tags":["excel","ssas"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12953848,"title":"excel 2007 pivot on ssas","body":"<p>I am new to this.</p>\n\n<p>I built a pivot report in excel 2007 on SSAS. It connects to a cube on my local pc. Now I want to send this pivot report to other people to make them be able to view the pivot report and do some analysis by themselves (expanding year-month-day etc). </p>\n\n<p>When my colleague tried he couldn't expand.</p>\n\n<p>How can I achieve this?</p>\n\n<p>Thank you,\nNian</p>\n"},{"tags":["sql-server","excel","visual-studio-2008","ssis","export-to-excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12954314,"title":"Preserving Formulas when exporting to Excel using SSIS","body":"<p>I'm currently using a template to generate Excels to export data from my DB to daily reports using SSIS.</p>\n\n<p>This template is a workbook of about 5 worksheets, of which only 1 needs to be filled automatically. This sheet has about 20 columns, of which 2 use Vlookups to auto-populate values based on the value in the preceding column. This is like an ID-Name pair. I need to make ID population part of the export from my DB, while the Name should be populated automatically. This ID-Name relation is maintained in Sheet 2, which I am not touching.</p>\n\n<p>My problem is THIS : The formula is applied to these two columns for about 150 rows (i don't expect more records). So, if my DB returns 120 results, I want my final Excel report from SSIS to have records from A2 to T122. However, what's happening is that once my SSIS package executes, I'm getting an Excel file with the first 150 rows blank... and then my 120 results are filled in. These formula-based Name columns have values \"#NA\" when the ID column is empty.</p>\n\n<p>How do I tackle this? Would I be able to work around this if I redesigned the Excel formulae to store an empty string instead of #NA when no ID value is present? My end-user needs these formulae to be preserved in his final Excel output.</p>\n"},{"tags":["excel","function"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12953480,"title":"Sumproducts #value! error","body":"<p>I am trying to use the Sumproducts function, but get the #VALUE error</p>\n\n<p>The code looks like this:\n    =SUMPRODUCT('Combined Output Table'!AO4:BH4,'ECAP CONSTANTS'!B2:I2)</p>\n\n<p>Both arrays are made up percentage values.  </p>\n\n<p>I use the second array in a Sumproducts function elsewhere where it works perfectly, and i have checked that the first array is only made up of number values (in percentage format).  Neither array has any characters or non-number values.</p>\n"},{"tags":["excel","vba","encryption","excel-vba"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":182,"score":1,"question_id":12852095,"title":"How does Excel's worksheet password protection work","body":"<p>This code has been floating around the net for quite a few years - it's apparently able to provide a password for decrypting an excel spreadsheet that you don't know the password to.</p>\n\n<p><a href=\"http://www.theofficeexperts.com/VBASamples/Excel02.htm\" rel=\"nofollow\">http://www.theofficeexperts.com/VBASamples/Excel02.htm</a></p>\n\n<p>I'm interested in how this works but I don't seem to be able to work it out. I'm assuming it's encrypted under a certain value that can be gotten to in a number of ways (a few places on the net say it'll give you the original password or another one that will work) sort of like a public key - you can have 100 public keys that all work with a single private one.</p>\n\n<p>To me it seems like it's creating integer variables and filling them with a specific number, before turning that number into the relevant characters. Wouldn't these always be the same? If so, is there \"master password\" for Excel protection?</p>\n\n<p>Thanks all!</p>\n\n<p>EDIT: I've noticed the <em>For n = 32 To 126</em> in the example code I posted. Cross referencing with an ASCII table that seems to be all characters from space through to tilde. Is this some sort of dictionary attack I'm not understanding due to syntax?</p>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12951574,"title":"Reset form but set a single field to a certain value","body":"<p>I have created a reset button which currently clears an entire VBA form I've created. I would like it however to clear the entire form and set the value of a drop down called <strong>cbo_deptCode</strong> to \"CO - Computer Science\". How would I go about accomplishing this?</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>Private Sub btn_Reset_Click()\n\n    ' Reset form\n    Dim ctl As MSForms.Control\n    For Each ctl In Me.Controls\n        Select Case TypeName(ctl)\n            Case \"TextBox\"\n                ctl.Text = \"\"\n            Case \"CheckBox\", \"OptionButton\", \"ToggleButton\"\n                ctl.Value = False\n            Case \"ComboBox\", \"ListBox\"\n                ctl.ListIndex = -1\n        End Select\n    Next ctl\n\nEnd Sub\n</code></pre>\n"},{"tags":["c#","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12952576,"title":"Change Sheet Direction with OpenExcel","body":"<p>I use this <a href=\"http://openexcel.codeplex.com/\" rel=\"nofollow\">OpenXML spreadsheet library</a> to create excel document in my code.\nThe project does not have any documentation.</p>\n\n<p>I want to change sheet direction from <strong>left to right</strong> to <strong>right to left</strong>.\nIs that possible?</p>\n"},{"tags":["excel","vba","combinatorics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12950671,"title":"stacking and layering boxes in excel","body":"<p>I am layering, stacking my options in excel. I have asked the question in a similar way, however I now want to put some more detail into it. If I have n number of boxes to stack, the possible options to stack them is 2^n-1. Let me give an example of 3 boxes and we give them the names A, B, C and D. The way they are stacked does not matter, meaning AB=BA and ABC=CAB, they count as 1 stack option. The result would be:</p>\n\n<p>A, B, C, AB, BC, AC, ABC</p>\n\n<p>Now I would like to create an excel file which in which I will enter the boxes letters and it gives me a list of all the possibilities for stacking. So I would provide the number of boxes and the letters. (3 boxes, A, B, C) Excel reads this in and gives me in cells the options.</p>\n\n<p>Is it possible to get the options in a row underneath each other? for n number of boxes?</p>\n\n<p>Is this possible? Can anyone help me with this?</p>\n\n<p>Thank you in advanced!</p>\n"},{"tags":["excel","ssis","export-to-excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12951173,"title":"SSIS Excel Formatting","body":"<p>I have a pre-specified Excel template with formatting laid out already. My header row has column names written with specific formatting. I want this formatting to stay specific only to my headers.</p>\n\n<p>When I copy this template and populate the copy with values from my DB source using SSIS however, the header formatting is being copied to the lower columns as well. Is there any way to counter this?</p>\n"},{"tags":["php","mysql","excel","export-to-excel","large-data"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1356,"score":4,"question_id":10649094,"title":"Generating large Excel files from MySQL data with PHP from corporate applications","body":"<p>We're developing and maintaining a couple of systems, which need to export reports in Excel format to the end user. The reports are gathered from a MySQL database with some trivial processing and usually result in ~40000 rows of data with 10-15 columns, we're expecting the amount of data to grow steadily. </p>\n\n<p>At the moment we're using PHPExcel for the Excel generation, but it's not working for us anymore. After we go above 5000 rows, the memory consumption and loading times become untolerable, and can't be solved by indefinitely increasing PHP's maximum limits for memory usage and script execution times. Processing of the data is as lean as possible, and the entire problem is with PHPExcel being a memory hog. CSV generation would be lighter, but unfortunately we're required to export Excel (and Excel alone) from our services due to user demands. This is due to formatting requirements etc., so CSV isn't an option.</p>\n\n<p>Any ideas/recommendations for a third party application/module/service/what ever for generating large excels? Doesn't matter if it's a commercial licence, as long as it fits our needs, can be integrated to existing PHP applications and does its job. Our services are generally running on linux/php/mysql and we can do just about whatever we need to do with the servers. </p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":12927252,"title":"SQL query to select a range","body":"<p>I need to write an sql query (in c#) to select excel sheet data in <strong>only the \"C\" column</strong> starting from C19. But i cant specify the ending cell number because more data are getting added to the column. Hence i need to know how to specify the end of the column. Please help. I have mentioned the query that i'm using. And I have attached an image of the excel sheet that i'm using!.And I have attached the output datagridview!</p>\n\n<pre><code>//Generte Oracle Datatable\n            OleDbConnection conn = new OleDbConnection(@\"Provider=Microsoft.ACE.OLEDB.12.0;\"\n            + @\"Data Source=\" + textBox1.Text + \";\" + @\"Extended Properties=\"\"Excel 12.0 Macro;HDR=Yes\"\"\");\n            conn.Open();\n\n            OleDbCommand ccmd = new OleDbCommand(@\"Select * From [SPAT$]\", conn);\n            OleDbDataAdapter adapter = new OleDbDataAdapter(ccmd);                     \n            DataTable Oracle = new DataTable();\n            adapter.Fill(Oracle);\n\n            for (int y = 19; y &lt; Oracle.Rows.Count; y++)\n            {\n                var value = Oracle.Rows[y][3].ToString();           \n            }   \n            dataGridView1.DataSource = Oracle.AsEnumerable().Where((row, index) =&gt; index &gt; 3).CopyToDataTable();                \n</code></pre>\n"},{"tags":["c#","excel","vsto"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12950407,"title":"How to track references to cells in other worksheet?","body":"<p>I'm working on a Excel plugin and in one worksheet my user can add formulas to reference other cells. Currently I am able to track references in the same worksheet, but I am unable to track  formulas referencing cells in some other worksheet.\nI am using the DirectPrecedents property of a range for detecting, bu according to MSDN this only tracks inside current active worksheet and doesn't track remote references. I also tried to use Precedents, but without any luck...\nMy GetPrecendenst code is similar to the code in this thread: <a href=\"http://stackoverflow.com/questions/12745827/how-to-catch-change-event-for-a-cell-containing-a-formula/\">How to catch change event for a cell containing a formula</a></p>\n\n<p>Any ideas how I can modify my code in order to track both local and remote references?</p>\n\n<p>Thank you!</p>\n"},{"tags":["excel","vba","macros"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":733,"score":3,"question_id":11299620,"title":"Error Checking and Trace Empty Cells from a VBA Macro in Excel","body":"<p>In Excel it's possible to locate formulas that have references to empty cells.\nFor example</p>\n\n<p>A1 = 1</p>\n\n<p>B1 = Empty</p>\n\n<p>C1 = .5</p>\n\n<p>D1 = A1 + B1 + C1</p>\n\n<p>D1 will correctly calculate the value to be 1.5\nHowever, error checking will identify that there is an error in the formula D1 and it can draw an arrow to this cell.</p>\n\n<p>I need to be able to run this check from a VBA macro and alert the user if they have a reference to an empty cell. </p>\n\n<p>When I try to record myself using the feature I get this</p>\n\n<pre><code>With Application.ErrorCheckingOptions\n    .EvaluateToError = False\n    .TextDate = False\n    .NumberAsText = False\n    .InconsistentFormula = False\n    .OmittedCells = False\n    .UnlockedFormulaCells = False\n    .ListDataValidation = False\n    .InconsistentTableFormula = False\nEnd With\n\nActiveSheet.ClearArrows\n</code></pre>\n\n<p>The options for only checking for empty cells are setup correctly but the actual execution of the \"Trace\" function is completely ignored. Is there any way to cause this to happen automatically and then check the result of the test?</p>\n\n<p>The function is \"Formulas Tab\" \"Error Checking\" \"Formulas referring to empty cells\" \"Trace Empty Cell\"</p>\n\n<p>Thanks,</p>\n\n<p>Steven</p>\n"},{"tags":["xml","excel","plsql","oracle-apex","xls"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":173,"score":1,"question_id":12733336,"title":"Create xls file using PL/SQL without going through xml","body":"<p>My system is developed in APEX/Oracle 11g, and I want to create an xls file directly without having to create an xml file.  The system currently creates an xml file which can then be saved to xls format, but the user, who is very picky, does not like the Windows 7 warning when one tries to open the xml file (Excel warning that the format of the file does not match its extension).  Is there any way to use Oracle PL/SQL from within APEX to accomplish this?</p>\n"},{"tags":["string","excel","function","count","substring"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12948338,"title":"Formula in Excel to count occurrences of substrings within strings","body":"<p>I am trying to count the number of times a substring appears within a column of string data in Excel. Please see the below example.</p>\n\n<p>The column of string data (tweets) looks like this:</p>\n\n<pre><code>   A\n1  An example string with @username in it\n2  RT @AwesomeUser says @username is awesome\n</code></pre>\n\n<p>The column with \"substrings\" (Twitter screen names) looks like this:</p>\n\n<pre><code>   B\n1  username\n2  AwesomeUser\n</code></pre>\n\n<p>I want to use a formula to count the number of times that a substring from B1, B2, etc. appears in the strings in column A. For example: a formula searching for B1 would return \"2\" and a search for B2 would return \"1\".</p>\n\n<p>I can't do it this way:</p>\n\n<pre><code>=COUNTIF(A:A, \"username\")\n</code></pre>\n\n<p>because COUNTIF only looks for strings, not substrings. This formula would always return \"0\".</p>\n\n<p>Here's a <a href=\"http://www.excelforum.com/excel-formulas-and-functions/341605-solved-counting-the-number-of-times-a-word-appears-in-a-worksheet.html\" rel=\"nofollow\">formula</a> I thought might do it:</p>\n\n<pre><code>=SUMPRODUCT((LEN(A:A)-(LEN(SUBSTITUTE(A:A,\"username\",\"\"))))/LEN(\"username\"))\n</code></pre>\n\n<p>Unfortunately, I have 16,000 entries in column B and tens of thousands in A, so counting characters won't work even on a high power PC (also, the result returned by the function is suspect).</p>\n\n<p>I thought about using:</p>\n\n<pre><code>=COUNTIF(A:A, \"*username*\")\n</code></pre>\n\n<p>but COUNTIF requires a string with the star operators; I need to use cell references due to the volume of data.</p>\n\n<p>My question: does anyone know how I can use a formula for this? If using COUNTIF, how do I get a cell reference in the conditional part of the statement (or use a function to substitute the string in the cell referenced within the conditional part of a COUNTIF statement)?</p>\n\n<p>I know that I <em>could</em> parse the data, but I would like to know how to do it in Excel.</p>\n"},{"tags":["r","excel"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":12945687,"title":"How to read all worksheets in an Excel Workbook into an R list with data.frame elements using XLConnect?","body":"<p>I understand that <code>XLConnect</code> can be used to read an Excel worksheet into R. For example, this would read the first worksheet in a workbook called <code>test.xls</code> into R.</p>\n\n<pre><code>library(XLConnect)\nreadWorksheetFromFile('test.xls', sheet=1)\n</code></pre>\n\n<p>I have an Excel Workbook with multiple worksheets. </p>\n\n<p><strong>How can all worksheets in a workbook be imported into a list in R where each element of the list is a data.frame for a given sheet, and where the name of each element corresponds to the name of the worksheet in Excel?</strong></p>\n"},{"tags":["excel","vba","unicode","macros"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12936295,"title":"How can I take non-ASCII strings from an Excel cell and place them into a text file (JSON format) with proper encoding?","body":"<p>We are writing a very basic macro for an Excel file that takes values from cells and places them into a text file with a JSON format. We are using the <code>Range</code> function to extract the cell values like this:</p>\n\n<pre><code>Print #iFile, \"          \"\"title\"\": \"\"\" &amp; Range(\"AP\" &amp; cell.Row).Value &amp; \"\"\"\"\n</code></pre>\n\n<p>I'm sure this isn't the prettiest or most efficient approach, but it seems to work for our purposes (and to be perfectly honest, we don't have anyone on hand that is actually a VBA developer really...). The problem, though, is when we encounter foreign characters (Latin, Japanese, etc) that are not being picked up by the VBA code above whatsoever.</p>\n\n<p>What we would like to do is not only extract the string from the cell no matter what type of characters are in there (ASCII or otherwise), and place them into the text file with any necessary encoding on the string values such that the file will still contain valid JSON.  </p>\n\n<p>Any help with this issue would be very appreciated as this is a subject that is far out of my comfort zone (front-end web development).</p>\n"},{"tags":["excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12936505,"title":"Excel 2007 Cell Drop Down List","body":"<p>I have a drop down list that I perform data validation on. I want one word in the dropdown list to be bold, so I make it bold in the listing off to the side. Validate the data to include all changes to take effect in the column where I have applied the drop down list to appear. Again the word I want bold is bold, but when selected in the cloumn in the spreadsheet the word when selected isn't bold. Why not?</p>\n"},{"tags":["c#","excel","com","charts","series"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3150,"score":0,"question_id":1426240,"title":"Excel C# Com Chart Multiple Series Problem","body":"<p>Please can someone help me with this as it's driving me nuts!</p>\n\n<p>I'm creating an excel chart using C# and the COM interface pragmatically.</p>\n\n<p>I've created the chart using the chart wizard.</p>\n\n<p>I want to then add more series to this chart. I can add the series but the extra data is on new columns and they are not automatically created.</p>\n\n<p>Am I going about this the wrong way?</p>\n\n<p>Add Chart:</p>\n\n<pre><code>public void MakeExcelChart(string startRange, string endRange, string chartTitle, string seriesName)\n    {\n        ExcelChart = (Excel.Chart)ExcelWBook.Charts.Add(Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n        ExcelApp.Visible = true;\n        ExcelChart.HasTitle = true;\n        ExcelChart.ChartTitle.Text = chartTitle;\n\n        ExcelRange = ExcelWSheet.get_Range(startRange, endRange);\n\n        ExcelChart.ChartWizard(ExcelRange, Excel.XlChartType.xlColumnClustered, Missing.Value, Excel.XlRowCol.xlColumns, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n\n        ExcelChart.ApplyDataLabels(Microsoft.Office.Interop.Excel.XlDataLabelsType.xlDataLabelsShowBubbleSizes, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);\n\n        ExcelChart.ChartArea.Fill.OneColorGradient(Microsoft.Office.Core.MsoGradientStyle.msoGradientHorizontal, 1, 1);\n\n        GetSeriesCollection();\n\n        ExcelSeries = ExcelSeriesCollection.Item(1);\n        ExcelSeries.Name = seriesName;\n    }\n</code></pre>\n\n<p>And to add series:</p>\n\n<pre><code>public void AddSeries(string col1, string col2, string startRange, string endRange, string seriesName)\n    {\n        ExcelSeries = ExcelSeriesCollection.NewSeries();\n\n        ExcelSeries.HasDataLabels = true;\n\n        ExcelRange = ExcelWSheet.get_Range(col1+startRange, col1+endRange);\n\n        ExcelSeries.XValues = ExcelRange;\n\n        ExcelRange = ExcelWSheet.get_Range(col2+startRange, col2+endRange);\n\n        ExcelSeries.Values = ExcelRange;\n\n        ExcelChart.HasLegend = true;\n\n        ExcelSeries.Name = seriesName;\n\n       }\n</code></pre>\n"},{"tags":["excel","vba","macros","excel-vba","out-of-memory"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2395,"score":2,"question_id":10327457,"title":"Excel VBA \"Out of Memory\" debugging techniques","body":"<p>I was debugging a problem mentioned in a few other* questions on SO and noticed a strange behavior during the debugging process.</p>\n\n<p>The behavior:\nExperienced 'out of memory' error while pasting complex formulas. Only about half of the 20,000 rows I'm iterating get formulas pasted before the error.\nCommented out virtually all code, error goes away.\nUncomment code incrementally in the hopes of discovering the specific section of code that's causing it.\nEnd up uncommenting all code and stop experiencing the bug!</p>\n\n<p>This means the exact same code worked fine in the same Excel instance, and fixing it only required running various lighter versions of the code before going back to the original version. What could possibly cause this?</p>\n"},{"tags":["winforms","excel","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2505,"score":0,"question_id":907986,"title":"DataGridView Copy Paste (with style, background color, ...)","body":"<p>I have a C# Windows Form Application with a DataGridView.</p>\n\n<p>Copy &amp; Paste (ctrl-c after selecting the data in the datagrid and ctrl-v in Excel) is working almost fine. </p>\n\n<p>The problem is that the style (such as background color) is not being pasted in Excel, only the cell values. Do I need to change a property somewhere on my datagridview or implement custom code?</p>\n\n<p>Thanks,</p>\n"},{"tags":["excel","report","jira","webwork"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12910119,"title":"excel export from jira webwork plugin","body":"<p>I write my own webwork plugin for Jira 3.12, which make a report for version progress of some projects. I can't use standart jira report plugin, because customer want two-step parameters choise (some projects and set of versions for every selected project). He also need excel export of this report. But I don't understand, how to transfer this parameters to ConfigureReport or don't know another way do this.</p>\n\n<p>How can I add excel export to my webwork plugin?</p>\n"},{"tags":["c#",".net","excel","interop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12941399,"title":"convert .net 4.0 syntax OfType to .net 3.5","body":"<p>I have this .NET 4.0 code:</p>\n\n<pre><code>var myTable = tables[1];\nmyTable = tables.Item[\"Table1\"];\nmyTable = tables.OfType&lt;Excel.ListObject&gt;().FirstOrDefault(t =&gt; t.Name == \"Table1\");\n</code></pre>\n\n<p>I am trying to compile with .NET 3.5 and getting a bunch of errors:</p>\n\n<blockquote>\n  <p>Error 23  Property, indexer, or event 'Item' is not supported by the\n  language; try directly calling accessor method\n  'Microsoft.Office.Interop.Excel.ListObjects.get_Item(object)'</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Error 24  'Microsoft.Office.Interop.Excel.ListObjects' does not contain\n  a definition for 'OfType' and the best extension method overload\n  'System.Linq.Queryable.OfType(System.Linq.IQueryable)' has\n  some invalid arguments</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Error 25  Instance argument: cannot convert from\n  'Microsoft.Office.Interop.Excel.ListObjects' to\n  'System.Linq.IQueryable'</p>\n</blockquote>\n\n<p>Can you please guide me on exactly what these errors mean so that I can try to convert this to .NET 3.5?</p>\n\n<p>Thank you so much for your advice.</p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":444,"score":1,"question_id":8840672,"title":"POI - SXSSFWorkbook - Excel found unreadable content","body":"<p>I have an existing workbook that acts as template. I tried to update a cell value in an existing row, meaning the adjacent cell has a value. The problem is that after the file is created and I open it, I get the  following error:\n\"Excel found unreadable content in....\"</p>\n\n<p>I assume the reason is SXSSFWorkbook only handles writing and if a row exists it cant update the contents of the row, which would entail reading and then writing - is this correct or am I experiencing a bug?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":190,"score":0,"question_id":9071387,"title":"Why does this give me error: 80040154","body":"<p>I am using this code to read an Excel spreadsheet:</p>\n\n<pre><code>using Excel = Microsoft.Office.Interop.Excel; \n\nnamespace myProject\n{\n  public class uploadfile\n  {\n    public void ReadFile(string file, string companycode)\n    {\n        Excel.Application xlApp;\n        Excel.Workbook xlWorkBook;\n        Excel.Worksheet xlWorkSheet;\n        Excel.Range range;\n\n        string str;\n        int rCnt = 0;\n        int cCnt = 0;\n\n        xlApp = new Excel.Application(); //&lt;==Crashes right here\n\n        xlWorkBook = xlApp.Workbooks.Open(file, 0, true, 5, \"\", \"\", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\n        xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);\n       //Code eliminated for brevity\n     }\n  }\n}\n</code></pre>\n\n<p>I get error 0x80040154, \"Class not registered\", each time I run this code. I have tried targeting X86 and reinstalled Office on my PC. I have search the internet but in most sources, it is a problem after it is installed on someone's machine, but it is happening to me in VS2010.</p>\n"},{"tags":["excel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":12941858,"title":"How to do concatenation in excel?","body":"<p>I am using excel concatenation to generate SQL insert statement but i find it very hard to define the concatenation for the below SQL values...can anyone advise? on the concatenation formula to use?</p>\n\n<pre><code>VALUES ( \nNEWID(),'ABC', 'ABC', 'ABC', 'abc', 'abc', 'abc', NULL,  CONVERT(datetime, '1999/01/01',     101)\n,  CONVERT(datetime, '1999/12/31', 101), 1, 0, 1, LOWER(NEWID())\n, 'abc',  getdate(), 'system'\n,  getdate());\n</code></pre>\n"},{"tags":["excel","vba","macros"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12941370,"title":"How to transpose in excel 2010","body":"<p>I have an excel sheet with the following format</p>\n\n<pre><code>a 2 3 4 0 0 0 0 0   \na 2 5 6 7 0 0 0 0  \na 4 5 9 0 0 0 0 0  \nb 5 5 9 0 0 0 0 0   \nb 1 1 1 1 1 1 1 1\n</code></pre>\n\n<p>I want to end up with something like this </p>\n\n<pre><code>a 2  \na 3  \na 4  \na 2  \na 5  \na 6  \na 7  \na 4  .....  \nb 1  \nb 1   \nb 1 ....\n</code></pre>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":39,"score":-2,"question_id":12943260,"title":"Excel help for exam","body":"<p>So I am studying for an exam by using an old paper online and I can't figure out how to do a part of the problem. </p>\n\n<p>Here is the layout of my spreadsheet:</p>\n\n<p><img src=\"http://i.stack.imgur.com/8b4gc.png\" alt=\"enter image description here\"></p>\n\n<p>Here is a layout of the info + question.</p>\n\n<p><img src=\"http://i.stack.imgur.com/wdJxy.png\" alt=\"enter image description here\"></p>\n\n<p>I can't figure out how to add the total owed amount up.</p>\n"},{"tags":["c#",".net","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12943000,"title":"identify pop up and kill it or press OK","body":"<p>Although the following background information is not so relevant to the question, I am including it in case you are curious:</p>\n\n<p>I am running:</p>\n\n<pre><code>xlWorkBook.RefreshAll();\n</code></pre>\n\n<p>on an Excel workbook, and sometimes I get this message:</p>\n\n<p><img src=\"http://i.stack.imgur.com/qV3Ti.png\" alt=\"enter image description here\"></p>\n\n<p>Using c# .NET 3.5 I would like to get rid of this pop up immediately after detecting it.</p>\n\n<p><strong>How can I programmatically detect it and close it / press OK?</strong></p>\n\n<p>Please note that I want to be able to identify this pop up even if it is in the background!</p>\n"},{"tags":["excel","worksheet-function"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":704,"score":2,"question_id":5757525,"title":"Use Excel Match Result as Column Selection","body":"<p>I have a MATCH expression that returns the valid row number. I now need to combine this result with a known Column identifier to return the results of that cell.</p>\n\n<p>So, if something on A50 = \"apple\", then I can get the contents of cell D50.</p>\n\n<p>Looked at indirect and index, but not seeing how it can help.</p>\n\n<p>ANSWER:</p>\n\n<p>=INDEX('SHEET1'!A:D,MATCH(SHEET2!A2,'SHEET1'!B:B,0),4)</p>\n\n<p>I got INDEX to work. Took some more reading up on it.</p>\n\n<p>'SHEET1'!A:D is the range for INDEX to work with.\nMATCH(SHEET2!A2,'SHEET1'!B:B,0) is pulling the row based upon my MATCH criteria.\n4 is the COLUMN to return the cell contents from using the ROW number from the MATCH above.</p>\n\n<p>Hopefully this will help someone else understand how to use INDEX.</p>\n"},{"tags":["excel","macros"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":12935473,"title":"Counting number of hours for a given period of time","body":"<p>I am having an issue at work. I need to calculate the number of hours that a process ran for a given period of time. Example: there is a Work Order that started at 7am today and finished at 9am of the next day. The shifts in my company go from 7am through 3pm and I want to include in my count only the hours worked in that period of time. </p>\n\n<p>Currently I am using this formula: =(((Endtime-Starttime)*1440)/60)</p>\n\n<p>Using this formula the result of the example above will be 26 hours, but the result I am looking for is 10 hours because the product ran for the entire 8 hours of today's shift, but only for 2 hours of tomorrow's shift.</p>\n"},{"tags":["excel","limit","apache-poi","cell","dataformat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12940617,"title":"Apache POI excel cell character Limit","body":"<p>First of all I'm new to POI. I am extracting data from backend and saving it to an excel file. But I noticed that one cell only allows a max of 10 characters. This does not happen on other cells. Can I change the limit of the characters on a cell. Will dataFormat do it? Does dataFormat only work on integers? How about strings? </p>\n"},{"tags":["excel","vba","macros","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12935127,"title":"Macro using Dynamic Pivot table values","body":"<p>I get a lot of data every day with one of the columns being the name of stores. These stores are divided into two regions, say north and south. So , I have a superset with store names including both storesN and storesS. Everyday I get reports from a subset of these names. I use Pivot tables to display the data. </p>\n\n<p>I want to write a macro which will show me just the data from storesN or storesS. If all the stores reported everyday, I could write a fixed macro. But every day the stores that report changes. So is there a way, I could write a macro, which will automatically detect and which names are present and adjust accordingly.</p>\n\n<p>I am using\n With PivotTables(\"PivotTable30\").PivotFields(\"Name\")\n      .PivotItems(\"Store1\").Visible=False</p>\n\n<p>The names are always a subset of the superset.\nI hope the question is clear.</p>\n"},{"tags":["excel","vba","microsoft","office"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12938237,"title":"VBA: Macro runs every minute but I want a particular sub to run every 45 minutes","body":"<p>I have a spreadsheet that runs every minute between 8am to 4pm that imports files from a certain folder and does certain calculations</p>\n\n<p>The calculations are done to check if a limit has been breached. If a limit has been breached then the spreadsheet needs to notify the user through a sound alert and email alert. The requirement is for the sound alert to go off every minute while the email alert is supposed to go off every 45 minutes as they dont want to be spammed with emails.</p>\n\n<pre><code>public sub fileImport()\n     if between 0800 to 1600\n         //do file import\n         //do calculations\n         if breach sound alert             \n     end if   \n     Application.OnTime RunEveryMinute, fileImport\n\n     if there is a breach\n         sendMail()         \n         Application.OnTime RunEvery45Min, sendMail              \n     end if\n\npublic sub sendEmail()\n     //do email function\n</code></pre>\n\n<p>so how can i go about in calling the sendEmail sub only every 45 minutes instead of every minute?</p>\n"},{"tags":["vb.net","excel","ado.net","oledb","getschematable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12940349,"title":"conn.GetSchema(\"Tables\") on Excel file does not return worksheets","body":"<p>I am changing my application from Windows Forms to a Windows Service. </p>\n\n<p>conn.GetSchema(\"Tables\") is working differently in the two code bases.</p>\n\n<p>In the new code base, I cannot get the Excel worksheets returned. conn.GetSchema(\"Tables\").Rows.Count is 0. I have double checked all of the references and nothing is different. I can't find any other differences in my code that I can think would have this effect. Any ideas and what else I can look for?</p>\n\n<p>Here is my full function (yeah, I know I should be using a For Each):</p>\n\n<pre><code>Private Function GetWorksheets(FileName As String) As String()\n\n    Dim rv As List(Of String)\n    Dim conn = New OleDb.OleDbConnection(\"provider=Microsoft.Jet.OLEDB.4.0;data source=\" &amp; FileName &amp; \";Extended Properties=Excel 8.0;\")\n\n    conn.Open()\n    For x As Integer = 0 To conn.GetSchema(\"Tables\").Rows.Count - 1\n        rv.Add(conn.GetSchema(\"Tables\").Rows(x)(\"TABLE_NAME\"))\n    Next x\n    conn.Close()\n    Return rv.ToArray\n\nEnd Function\n</code></pre>\n\n<p>Thanks,\nBrad</p>\n"},{"tags":["excel","vba","autofilter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12892252,"title":"VBA + checkboxes + autofilter","body":"<p>I have a list in excel with an autofilter and where every row has a checkbox. </p>\n\n<p>I have made a button with a macro to select all the checkboxes. This works fine. But when I filter my rows my 'select all' has to <strong>select only the visible checkboxes</strong>. </p>\n\n<p>With my code it still selects all the checkboxes. Has anybody an idea to solve this? </p>\n\n<p>My code:</p>\n\n<pre><code>  Sub SelectAll()\n  Dim chk As CheckBox\n\n  If Worksheets(\"Summary\").FilterMode = True Then\n    MsgBox \"Filter mode is on\"      \n  Else\n    MsgBox \"Filter mode is off\"\n    For Each chk In Worksheets(\"Summary\").CheckBoxes\n      chk.Value = Checked\n    Next\n  End If\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["excel","ssas"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12938062,"title":"SSAS (client:excel), viewing columns side by side","body":"<p>Got a question concerning SSAS and output formatting in excel. My customer wants to view customer information in a list form. </p>\n\n<p>Lets say we have firstname, lastname and gender. How i would like excel to display these attributes values would be like:</p>\n\n<blockquote>\n  <p>Firstname Lastname   Gender</p>\n  \n  <p>Hans      Jorgensen  Male</p>\n  \n  <p>Niels     Svenson    Male</p>\n  \n  <p>Ninna     Vestermann Female</p>\n</blockquote>\n\n<p>Im quite sure its possible, but would anyone be so kind to give me a few pointers as how to do make this work? </p>\n\n<p>Thx a lot in advance :)\nTorben</p>\n"},{"tags":["excel","matlab","matrix","output"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12925186,"title":"Creating matrix of output from script (matlab)","body":"<p>I have a script something like the following:</p>\n\n<pre><code>for \n(do something)\nend\n</code></pre>\n\n<p>And also outputs that use data output from the loop (which change each time -- when the script is run):</p>\n\n<pre><code>A = 1\nA = 1.5\n</code></pre>\n\n<p>Etc.</p>\n\n<p>I am looking to store this output that changes each time into a matrix.\nIs this feasible?</p>\n\n<pre><code>for number of iterations\n(Call script)\nend\nOutput to excel\n</code></pre>\n\n<p>The reason I want to store the data into a matrix is to be able to output all the answers (for several iterations) into Excel at once.</p>\n\n<p>Edit:\nTo give a better picture of what my output looks like it is something like this </p>\n\n<pre><code>Output = [rand() rand() rand(); rand() rand() rand()];\n</code></pre>\n\n<p>then I use this to create a new variable: </p>\n\n<pre><code>var = Output(1,1)./Output(2,1); \n</code></pre>\n\n<p>each time I run the script the answer changes. This new answer each time, is what I am looking to save in a matrix. Hope that clears things up.</p>\n"},{"tags":["excel","list","filter","copy","same"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":12938077,"title":"How Do I Create A Column With The Same Filter In Each Cell?","body":"<p>I created a filter for \"GENRE\" it has a drop down list to easily check which one pertains to the row. I want to have this filter appear in every cell in that column. Can this be done? If so HOW?</p>\n"},{"tags":["iphone","excel","uiwebview","worksheet","airprint"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12937539,"title":"iPhone: UIWebView viewPrintFormatter print all pages of local Excel xls file","body":"<p>I use UIWebView's viewPrintFormatter to print an Excel xls file.</p>\n\n<p>My xls contains multiple worksheets, but only the first got printed (containing all the worksheet's name at the top of the printout). Is it possible to print all the worksheets somehow?</p>\n\n<p>Thanks for any help in advance!</p>\n"},{"tags":["excel","vba","variables","macros","row"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":12922743,"title":"can an XL macro select a range with variable starting and ending rows?","body":"<p>I'm a front-line tech.  Not new to macro coding, but most of my experience is in WordPerfect macros.  I'm trying to code an Excel macro which will select and act on a range in a series of files.  The desired range is in a constant set of columns, but a variable set of rows.  Static values mark the starting and ending rows, but those rows will vary with each data file.</p>\n\n<p>The problem I'm having is that when I record a macro, XL does not record my cursor movements (Ctrl-Up, Ctrl-Shift-Home, etc), it records the absolute cell addresses I am acting upon.  Since the starting and ending rows will vary with each data file, absolute cell references will not work.  Can anyone provide any hints as to how I could/should approach this?</p>\n\n<p>Thanks in advance,\nJames</p>\n"},{"tags":["excel","openxml","spreadsheet","office"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12937326,"title":"OPENXML spreadSheet read taking too long","body":"<p>I have a requirement to read rows of data from excel file where each row has about 250 cell values to be read, and the excel sheet could be thousands of lines long. To each the content of each cell, in each my row, I have the following procedure. I came up with this as solution after testing different ways to get at the values present in each of my rows. Some cells are null, some have null as value, some have values embedded, while others have their values stored away in the sharedString table.  Problem is this procedure along with others consume time and I would appreciate some help tuning this to work better. Thanks in advance. </p>\n\n<pre><code>  public String assignRowValue(Row row, int number, SharedStringTable sharedString)\n    {\n        String value = String.Empty;\n        try\n        { \n           Cell cell = row.Descendants&lt;Cell&gt;().Where(c =&gt; c.CellReference == ExcelColumnFromNumber(number) + row.RowIndex.ToString()).FirstOrDefault();\n           if (cell == null)\n           {\n               value = String.Empty;\n           }\n           else if ((int.Parse(cell.CellValue.InnerText) &lt; sharedString.ChildElements.Count)&amp;&amp; (sharedString.ChildElements[int.Parse(cell.CellValue.InnerText)].InnerText != null))\n           {\n               value =sharedString.ChildElements[int.Parse(cell.CellValue.InnerText)].InnerText;\n           }\n           else if((cell.CellValue != null &amp;&amp; cell.CellValue.InnerText != null))\n           {\n                   value =cell.CellValue.InnerText; \n           }\n        }\n        catch (Exception ex)\n        {\n            return String.Empty;\n        } \n        return value; \n    }\n</code></pre>\n"},{"tags":["excel","vba","vb6","insert","picture"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12936646,"title":"How to insert a picture into Excel at a specified cell position with vb6","body":"<p>Im adding \".jpg\" files to my Excel sheet with the code below</p>\n\n<pre><code>'Add picture to excel\nxlApp.Cells(i, 20).Select\nxlApp.ActiveSheet.Pictures.Insert(picPath).Select\n'Calgulate new picture size\nWith xlApp.Selection.ShapeRange\n    .LockAspectRatio = msoTrue\n    .Width = 75\n    .Height = 100\nEnd With\n'Resize and make printable\nWith xlApp.Selection\n    .Placement = 1 'xlMoveAndSize\n    '.Placement = 2 'xlMove\n    '.Placement = 3 'xlFreeFloating\n    .PrintObject = True\nEnd With\n</code></pre>\n\n<p>i dont know what am i doing wrong but it doesnt get inserted in to right cell\nso what should i do to put this picture into a specified cell in excel?</p>\n"},{"tags":["java","excel","list","arraylist","aspose"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12930324,"title":"List having different data to be displayed in excel","body":"<p>I have a list of quest id like 1,2,3,4,5,6 for one person id say 34512 and only 4 for other person id say 23124 .I am display the data for each person id in excel like</p>\n\n<pre><code>       A  B C D E F ---&gt;cells\n34512  1  2 3 4 5 6\n23124         4\n</code></pre>\n\n<p>i want to show the output as above but i am getting like</p>\n\n<pre><code>       A  B C D E F ---&gt;cells\n34512  1  2 3 4 5 6\n23124  4\n</code></pre>\n\n<p>because i am taking the cell count as A to start with for every new person id.I need to see now if the quesid is not present for a given person id then it should leave the cell blank and should display as shown in first .</p>\n\n<p>Can i do anything with list of quesid for previous and new and check if quesid is not present in its list then start the count accordingly ?</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12925043,"title":"errors with excel workbooks","body":"<p>I'm having hard time to work with excel workbooks from c#.\ni cant get basic operations to work right and for some reason it seems that documentation\nabout excel related classes is not as good as others.\nI've learned to work with xml and text files so far and it was by far more easy then excel.\nI've copy the next example from msdn forums but i cant get it to work, even having hard time\nto declare the namespace, i get only errors from this code:</p>\n\n<pre><code>using Microsoft.Office.Interop.Excel; \n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            object oExcel=new Excel.Application();\n            object oBook = oExcel.Workbooks.Open(\"C:\\\\Book1.xls\");\n            object oSheet = oExcel.Worksheets(1);\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2809,"score":1,"question_id":10353367,"title":"Excel: Selecting all rows until empty cell","body":"<p>I'd to select all rows from 2 adjacent columns, starting with the row below the header (this is fixed) and ending with the row before the first row with a blank cell.</p>\n\n<p>Given the following the example...       </p>\n\n<pre><code>    A       B\n1   Item    Amount\n2   Item1   1\n3   Item2   4\n4           2\n5\n</code></pre>\n\n<p>I'd like to select the range A2:B3. The first row is always row 2, the last row is row 3 because it is the row before the first row with a blank cell.</p>\n\n<p>My goal is to use this selection to automatically sort and add borders to the rows after I've completely filled in the row below the current last row. In this example, I'd have to fill in A4 to make the row part of the selection and apply the aforementioned actions.</p>\n\n<p>I hope anyone can help me.. Thanks in advance!</p>\n\n<p>EDIT</p>\n\n<p>I've come up with a solution, based on chris neilsen's solution:</p>\n\n<pre><code>Dim rng As Range\nWith Worksheets(\"YourSheet\")\n    Set rng1 = .Range(.Cells(2, 1), .Cells(2, 2).End(xlDown))\n    Set rng2 = .Range(.Cells(2, 2), .Cells(2, 1).End(xlDown))\n    Set r = Application.Intersect(rng1, rng2)\n\nEnd With\n</code></pre>\n"},{"tags":["excel","excel-vba"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12932254,"title":"Macros don't work when sheet is protected. Running macro returns run-time error 1004","body":"<p>I have three macros in my workbook that work fine. However, when I protect any of the worksheets, they stop to work and I get a <code>run-time error 1004</code>. </p>\n\n<p>I have tried following the two suggestions that I found online:</p>\n\n<ul>\n<li>Unprotect at start of macro code, and protect at end; </li>\n<li>User Interface Only) but the run-time error remains. </li>\n</ul>\n\n<p>I need my Workbook to be protected and for my macros to function, what shall I do? </p>\n\n<p><strong>Macro 1:</strong></p>\n\n<pre><code>Sub Macro1()\n\nDim historyWks As Worksheet\nDim inputWks As Worksheet\n\nDim nextRow As Long\nDim oCol As Long\n\nDim myCopy As Range\nDim myTest As Range\n\nDim lRsp As Long\n\nSet inputWks = Worksheets(\"Visit &amp; Order Entry Form\")\nSet historyWks = Worksheets(\"Visit &amp; Order Database\")\n\n'check for duplicate order ID in database\nIf inputWks.Range(\"CheckID2\") = True Then\n  lRsp = MsgBox(\"Clinic ID already in database. Update database?\", vbQuestion + vbYesNo, \"Duplicate ID\")\n  If lRsp = vbYes Then\n    UpdateLogRecord\n  Else\n    MsgBox \"Please change Clinic ID to a unique number.\"\n  End If\n\nElse\n\n  'cells to copy from Input sheet - some contain formulas\n  Set myCopy = inputWks.Range(\"OrderEntry2\")\n\n  With historyWks\n      nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n  End With\n\n  With inputWks\n      Set myTest = myCopy.Offset(0, 2)\n\n      If Application.Count(myTest) &gt; 0 Then\n          MsgBox \"Please fill in all the cells!\"\n          Exit Sub\n      End If\n  End With\n\n  With historyWks\n      With .Cells(nextRow, \"A\")\n          .Value = Now\n          .NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n      End With\n      .Cells(nextRow, \"B\").Value = Application.UserName\n      oCol = 3\n      myCopy.Copy\n      .Cells(nextRow, 3).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n      Application.CutCopyMode = False\n  End With\n\n  'clear input cells that contain constants\n  With inputWks\n    On Error Resume Next\n       With myCopy.Cells.SpecialCells(xlCellTypeConstants)\n            .ClearContents\n            Application.GoTo .Cells(1) ', Scroll:=True\n       End With\n    On Error GoTo 0\n  End With\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Macro 2</strong></p>\n\n<pre><code>Sub UpdateLogWorksheet()\n\nDim historyWks As Worksheet\nDim inputWks As Worksheet\n\nDim nextRow As Long\nDim oCol As Long\n\nDim myCopy As Range\nDim myTest As Range\n\nDim lRsp As Long\n\nSet inputWks = Worksheets(\"Visit &amp; Order Entry Form\")\nSet historyWks = Worksheets(\"Contact Details &amp; Segm Database\")\n\n'check for duplicate order ID in database\nIf inputWks.Range(\"CheckID\") = True Then\n  lRsp = MsgBox(\"Clinic ID already in database. Update database?\", vbQuestion + vbYesNo, \"Duplicate ID\")\n  If lRsp = vbYes Then\n    UpdateLogRecord\n  Else\n    MsgBox \"Please change Clinic ID to a unique number.\"\n  End If\n\nElse\n\n  'cells to copy from Input sheet - some contain formulas\n  Set myCopy = inputWks.Range(\"OrderEntry\")\n\n  With historyWks\n      nextRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n  End With\n\n  With inputWks\n      Set myTest = myCopy.Offset(0, 2)\n\n      If Application.Count(myTest) &gt; 0 Then\n          MsgBox \"Please fill in all the cells!\"\n          Exit Sub\n      End If\n  End With\n\n  With historyWks\n      With .Cells(nextRow, \"A\")\n          .Value = Now\n          .NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n      End With\n      .Cells(nextRow, \"B\").Value = Application.UserName\n      oCol = 3\n      myCopy.Copy\n      .Cells(nextRow, 3).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n      Application.CutCopyMode = False\n  End With\n\n  'clear input cells that contain constants\n  With inputWks\n    On Error Resume Next\n       With myCopy.Cells.SpecialCells(xlCellTypeConstants)\n            .ClearContents\n            Application.GoTo .Cells(52) ', Scroll:=True\n       End With\n    On Error GoTo 0\n  End With\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Macro 3</strong></p>\n\n<pre><code>Sub UpdateLogRecord()\n\nDim historyWks As Worksheet\nDim inputWks As Worksheet\n\nDim lRec As Long\nDim oCol As Long\nDim lRecRow As Long\n\nDim myCopy As Range\nDim myTest As Range\n\nDim lRsp As Long\n\nSet inputWks = Worksheets(\"Visit &amp; Order Entry Form\")\nSet historyWks = Worksheets(\"Contact Details &amp; Segm Database\")\n\n'check for duplicate order ID in database\nIf inputWks.Range(\"CheckID\") = False Then\n  lRsp = MsgBox(\"Clinic ID not in database. Add clinic to database?\", vbQuestion + vbYesNo, \"New Order ID\")\n  If lRsp = vbYes Then\n    UpdateLogWorksheet\n  Else\n    MsgBox \"Please select Clinic ID that is in the database.\"\n  End If\n\nElse\n\n  'cells to copy from Input sheet - some contain formulas\n  Set myCopy = inputWks.Range(\"OrderEntry\")\n\n  lRec = inputWks.Range(\"CurrRec\").Value\n  lRecRow = lRec + 1\n\n  With inputWks\n      Set myTest = myCopy.Offset(0, 2)\n\n      If Application.Count(myTest) &gt; 0 Then\n          MsgBox \"Please fill in all the cells!\"\n          Exit Sub\n      End If\n  End With\n\n  With historyWks\n      With .Cells(lRecRow, \"A\")\n          .Value = Now\n          .NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n      End With\n      .Cells(lRecRow, \"B\").Value = Application.UserName\n      oCol = 3\n\n      myCopy.Copy\n      .Cells(lRecRow, 3).PasteSpecial Paste:=xlPasteValues, Transpose:=True\n      Application.CutCopyMode = False\n  End With\n\n  'clear input cells that contain constants\n  With inputWks\n    On Error Resume Next\n       With myCopy.Cells.SpecialCells(xlCellTypeConstants)\n            .ClearContents\n            Application.GoTo .Cells(52) ', Scroll:=True\n       End With\n    On Error GoTo 0\n  End With\nEnd If\n\nEnd Sub\n</code></pre>\n"},{"tags":["excel","events","vba","excel-vba"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3186,"score":3,"question_id":9377237,"title":"How can I define ENTER keypressed event for a dynamically chosen Cell in VBA for Excel","body":"<p>I got a dynamically chosen Cell that will be filled with some information that im going to put and when I put the information and <strong><kbd>ENTER</kbd> keypressed</strong> at that Cell;</p>\n\n<p><strong>1 - it should trigger a macro</strong></p>\n\n<pre><code>'macro(value)\nmacro1 myinfo\n</code></pre>\n\n<p><strong>2 - macro should get the info in that cell</strong></p>\n\n<pre><code>myinfo = Cells( i, j )\n</code></pre>\n\n<p>So how can i achive that?</p>\n"},{"tags":["java","excel","pivot-table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":304,"score":2,"question_id":10097066,"title":"Generate Excel 2010 Pivot Table from Java","body":"<p>Does anyone know sever side library (free or not - it doesn't matter) which can generate pivot tables in excel 2010 format.</p>\n\n<p>POI can't do it.</p>\n\n<p>Now I'm evaluating SmartXLS but it uses Excel 2007 format.  I need couple feature from Excel 2010 - like data field sorting, default pivot table template and etc...</p>\n\n<p>Thanks</p>\n"},{"tags":["excel","csv","grid","clipboard"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1774,"score":3,"question_id":2563,"title":"What is a good web-based Grid that accepts Excel clipboard data?","body":"<p>Any good recommendations for a platform agnostic (i.e. Javascript) grid control/plugin that will accept pasted Excel data and can emit Excel-compliant clipboard data during a Copy?</p>\n\n<p>I believe Excel data is formatted as CSV during \"normal\" clipboard operations.</p>\n\n<hr>\n\n<p><a href=\"http://dhtmlx.com/docs/products/dhtmlxGrid/\" rel=\"nofollow\">dhtmlxGrid</a> looks promising, but the online demo's don't actually copy contents to my clipboard!</p>\n"},{"tags":["excel","csv","import","magento"],"answer_count":6,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":8498,"score":2,"question_id":3736463,"title":"import csv/excel file into magento database","body":"<p>Is there any method or tool by which csv/excel file of products can be directly imported to magento database?</p>\n"},{"tags":["c#","silverlight","excel","worksheet","sheet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12579402,"title":"How to set excel worksheet in silverlight?","body":"<p>I want to export an element(Maybe gridview , List...etc) as .xls file with setting WorkSheet by string giving  in silerlight 4.0.\nHow can I solve this problem?</p>\n\n<p>The following are Export function by using RadGridView API...</p>\n\n<pre><code>public RadGridView Grid { get; private set; }\nvoid ExportWithoutDetail()\n{\n    SaveFileDialog saveDialog = new SaveFileDialog();\n    saveDialog.Filter = ReadFilter();\n    saveDialog.FilterIndex = 4;\n\n\n    if (saveDialog.ShowDialog() == true)\n    {\n        SetAllColumnVisibile();\n        Stream stream = null;\n        try\n        {\n            using (stream = saveDialog.OpenFile())\n            {\n                GridViewExportOptions opt = CreateExportOptions();\n\n                switch (saveDialog.FilterIndex)\n                {\n                    case 1: //*.txt\n                        opt.Format = ExportFormat.Text;\n                        break;\n                    case 2: //*.html\n                        opt.Format = ExportFormat.Html;\n                        break;\n                    case 3: //*.csv\n                        opt.Format = ExportFormat.Csv;\n                        break;\n                    case 4: //*.xls\n                        opt.Format = ExportFormat.ExcelML;\n                        break;\n                    case 5: //*.xml\n                        opt.Format = ExportFormat.ExcelML;\n                        break;\n                }\n                Grid.Export(stream, opt);\n            }\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n        }\n        finally\n        {\n            if (stream != null)\n                stream.Close();\n\n        }\n    }\n}\n</code></pre>\n"},{"tags":["php","excel","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":56,"score":-1,"question_id":12931758,"title":"how to generate csv excel sheet using php so that I can use some styling also like font-size and font-color","body":"<p>I want to generate a <code>CSV</code> file using <code>php</code>. I am able to generate simple <code>CSV</code> file but I want to set font-size and font-color dynamically for headings. I found some libraries but those were not upto the mark.</p>\n\n<p>Here is the code by which I can generate simple CSV file</p>\n\n<pre><code>$fp = fopen(FCPATH .'assets/' . $filename,'w');\n$content = \"\";\n\nforeach ($query_pairs-&gt;result() as $pair) {\n    $content .= '&lt;th&gt;' . @$users[$pair-&gt;uid1]-&gt;name . '&lt;/th&gt;' . $sep . ' ' . @$users[$pair-&gt;uid2]-&gt;name . PHP_EOL;\n}\n\nfwrite($fp,$content);\nfclose($fp);\n\nheader(\"Content-type: application/vnd.ms-excel\");\nheader(\"Content-Disposition: attachment; filename=\".$filename);\nheader(\"Pragma: no-cache\");\nheader(\"Expires: 0\");\n\nreadfile(FCPATH .'assets/' . $filename);\n</code></pre>\n\n<p>Please help</p>\n"},{"tags":["performance","excel","aggregate-functions","lookup"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12930500,"title":"excel performance: Lookup Vs Getpivotdata","body":"<p>I build an Excel 2007 spreadsheet which contains a larger table with source data (about 500,000 rows and 10 columns). I need to extract data from this large table for my analysis. To extract and aggregate data I usually use sumif, vlookup/hlookup and index+match functions. </p>\n\n<p>I recently learned about the existence of the function getpivotdata, which makes it possible to extract data from a pivot table. To be able to use it, I first need to convert my large source table to a pivot table and after that I can extract data using the function getpivotdata.</p>\n\n<p>Would you expect a performance improvement if I would use getpivotdata to extract and aggregate data instead? I would expect that within the underlying Pivot object aggregated values are pre-calculated and therefore performance would be better. </p>\n\n<p>If performance would be better, are there any reasons not to follow this approach? To be clear, there is no need to refresh the pivot table because it contains source data (which is located in the beginning of the calculation chain).</p>\n"},{"tags":["excel","optimization","powershell","vbscript","powershell-v2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":189,"score":4,"question_id":12918206,"title":"Why is writing Excel cell values fast in VBScript but slow in PowerShell?","body":"<p>Why is it that writing cell values to Excel is a lot faster in VBScript than in PowerShell?\nIsn't PowerShell the new thing, and VBScript the depricated MS scripting language?</p>\n\n<p><strong>VBScript example (save to filename.vbs)</strong>\nThis runs in a split second.</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = false\nSet objWorkbook = objExcel.Workbooks.Add()\n\n' Edit: increased number of writes to 500 to make speed difference more noticeable\nFor row = 1 To 500\n     'Edit: using .cells(row,1) instead of .cells(50,1) - this was a mistake\n     objWorkbook.workSheets(1).cells(row,1).value = \"test\"\nNext\n\nobjWorkbook.SaveAs(CreateObject(\"Scripting.FileSystemObject\").GetParentFolderName(WScript.ScriptFullName) &amp; \"\\test.xlsx\")\nobjExcel.Quit\nmsgbox \"Done.\"\n</code></pre>\n\n<p><strong>PowerShell example (save to filename.ps1)</strong> This takes multiple seconds to run (problematic on thousands of records)</p>\n\n<pre><code>#need this to work around bug if you use a non-US locale: http://support.microsoft.com/default.aspx?scid=kb;en-us;320369\n[System.Threading.Thread]::CurrentThread.CurrentCulture = \"en-US\" \n\n$excel = New-Object -ComObject Excel.Application\n$excel.Visible = $False\n$xls_workbook = $excel.Workbooks.Add()\n\n# Edit: using foreach instead of for\n# Edit: increased number of writes to 500 to make speed difference more noticeable\nforeach ($row in 1..500) {\n    # Edit: Commented out print-line, slows down the script\n    #\"Row \" + $row\n    # This is very slow! - http://forums.redmondmag.com/forums/forum_posts.asp?tid=4037&amp;pn=7\n    $xls_workbook.sheets.item(1).cells.item($row,1) = \"test\"\n}\n\n$xls_workbook.SaveAs($MyInvocation.MyCommand.Definition.Replace($MyInvocation.MyCommand.Name, \"\") + \"test.xlsx\")\n$excel.Quit()\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel)\n</code></pre>\n\n<p>I want to use this for thousands of records. If there is no fast way to do this, PowerShell is not an option. Are there better alternatives?</p>\n"},{"tags":["excel","macros","charts","excel-vba","excel-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1937,"score":1,"question_id":8770429,"title":"Excel macro to fix overlapping data labels in line chart","body":"<p>I am searching/trying to make a macro to fix the position of data labels in a line chart with one or multiple series collections so that they will not overlap each other.</p>\n\n<p>I was thinking of some ways for my macro but when I try to make it I understand that this is way too hard for me and I get headache.</p>\n\n<p>Is there anything that I missed? Do you know about such a macro?</p>\n\n<p>Here's an example chart with overlapped data labels:</p>\n\n<p><img src=\"http://i.stack.imgur.com/1eucU.png\" alt=\"enter image description here\"></p>\n\n<p>Here's an example chart where I manually fixed the data labels:</p>\n\n<p><img src=\"http://i.stack.imgur.com/gHrbA.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","excel","printing","replace"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12916773,"title":"Excel Cell Value Replacement with other value in C# Windows Application","body":"<p>I am working on a windows application in .NET C#.  I have to replace Excel cell content with some other text (that I am getting from a database).  What I need to do is to replace the values of Excel with the actual values from the database. (e.g. \"CustomerName\" would be replaced by \"John\", \"CustomerCompanyName\" would be replaced by \"GE\" etc. ). Also if some values are not present then that empty space would be overlapped by its below values.</p>\n\n<p>How can we implement this thing?</p>\n"},{"tags":["excel","file","vba","text","import"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12918992,"title":"How to open multiple text files into one excel sheet but skip line 1 for each text file?","body":"<p>With the code below I am able to open all text files in my folder into one excel sheet. Each file has headers and what I cant figure out is how to have it skip the first line in each text file.</p>\n\n<pre><code>Dim fso As FileSystemObject\nDim folder As folder\nDim file As file\nDim FileText As TextStream\nDim TextLine As String\nDim Items() As String\nDim i As Long\nDim cl As Range\n\n' Get a FileSystem object\nSet fso = New FileSystemObject\n' get the directory you want\nSet folder = fso.GetFolder(\"\\\\mydirectoryfolderhere\")\n' set the starting point to write the data to\nSet cl = ActiveSheet.Cells(1, 1)\n' Loop thru all files in the folder\nFor Each file In folder.Files\n' Open the file\nSet FileText = file.OpenAsTextStream(ForReading)\n\n' Read the file one line at a time\nDo While Not FileText.AtEndOfStream\nTextLine = FileText.ReadLine\n' Parse the line into | delimited pieces\nItems = Split(TextLine, \"|\")\n' Put data on one row in active sheet\nFor i = 0 To UBound(Items)\ncl.Offset(1, i).Value = Items(i)\nNext\n'Move to next row\nSet cl = cl.Offset(1, 0)\nLoop\n\n' Clean up\nFileText.Close\nNext file\n\nSet FileText = Nothing\nSet file = Nothing\nSet folder = Nothing\nSet fso = Nothing\n</code></pre>\n"},{"tags":["excel","hyperlink","word"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":12927980,"title":"Link to Excel from Word: This object is corrupt or no longer available","body":"<p>I have a Word 2010 document, with linked objects to pivot tables in a Excel 2012 document.\nEvery night, a macro runs to update the underlying data for the pivot tables in Excel, and refresh these tables.</p>\n\n<p>Next, a macro in Word update all the Excel links in Word, to pick up the changes in the pivot tables.</p>\n\n<p>At some point, the links in Word because corrupt.  When right-click on the table in Word, there is no \"Update Link\" option.  It is replaced by a menu item called \"object\", and when I click on that, error pop up is \"This object is corrupt or no longer available\".</p>\n\n<p>I tried refreshing the links by going to File -> \"Edit Links to Files, then \"Change Source...\" and re-select the Excel file again.  After this refresh, I can do \"Update Link\".  But If i save and close the file, the link becomes corrupt again.</p>\n\n<p>Not sure if this is somehow related, but when I first manually update the link in word, the link type is \"Worksheet\".  When I save &amp; reopen, the link type becomes \"Excel.Sheet.12\".  </p>\n\n<p>Any ideas on how to stop the links from becoming corrupt on closing/re-opening the file?</p>\n"},{"tags":["java","excel","apache-poi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12927412,"title":"excel file to delimited dat file","body":"<p>I am reading an excel document as below:</p>\n\n<pre><code>package com.sample.file;\n\n//necessary imports goes here\n\npublic class ExcelReader { \n   public static void main(String[] args) throws Exception{ \n\n  String fname = \"C:\\\\myExcel.xls\"; // or  \"C:\\\\myExcel.xlsx\"  \n  InputStream inp = new FileInputStream(fname); \n  Workbook wb = WorkbookFactory.create(inp); \n  Sheet sheet = null; \n\n  sheet = wb.getSheetAt(0); \n\n  Iterator rows = sheet.rowIterator(); \n\n  while (rows.hasNext()) \n    { \n            Row row = (Row) rows.next(); \n\n            // how to write to a semicolon delimited dat file here\n    }\n\n  inp.close(); \n} \n}\n</code></pre>\n\n<p>As seen above, I am able to read the row. However, now I want to write that row into a semicolon delimited dat file. </p>\n\n<p>Also, if a column is empty, it should go as an empty value in the file i.e. no data between consecutive semicolons. </p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12912277,"title":"Change cell values in excel files and copy the changes to a new column using c#","body":"<p>I need to reduce a cell value in a column, such as \"250-1824-02\" to \"250-1824\" and update the new value to a new column in the same excel sheet using c#. Please Help </p>\n\n<p>I have generated the coding upto the below level:</p>\n\n<pre><code>Excel.Workbook xlWorkBook;\n            Excel.Worksheet xlWorkSheet;\n            object misValue = System.Reflection.Missing.Value;\n            xlApp = new Excel.Application();\n            xlApp.Visible = false;\n            xlWorkBook = xlApp.Workbooks.Open(textBox1.Text, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue);\n            xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);\n</code></pre>\n"},{"tags":["osx","r","excel","csv","end-of-line"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12925968,"title":"Incomplete final line when trying to read csv in R","body":"<p>I've got R v.2.15.1 running on Mac OS 10.8.2 . Earlier today, R started throwing errors at me every time I try to import ANY recently created (today) csv files. Older (before today) csv files work fine, but anything I create that's new will not read in without a warning.</p>\n\n<p>I'm creating the csv's the same way -- saving the spreadsheet as .csv in MS Excel (Office for Mac 2011). </p>\n\n<p>Even with a dummy file ('test.csv'), I get this: \n\"Warning message:\nIn read.table(file = file, header = header, sep = sep, quote = quote,  :\n  incomplete final line found by readTableHeader on 'test.csv'\"</p>\n\n<p>in TextEdit, test.csv is:</p>\n\n<pre><code>cat,stuff\n1,1\n2,2\n</code></pre>\n\n<p>I have tried hitting enter at the end of every line (as suggested here: <a href=\"http://stackoverflow.com/questions/5990654/incomplete-final-line-warning-when-trying-to-read-a-csv-file-into-r\">&#39;Incomplete final line&#39; warning when trying to read a .csv file into R</a> ) , but this doesn't work.</p>\n\n<p>I've re-installed R and Microsoft Excel. Weirdly, I was able to read in the csv file without a warning on a Windows machine with R. On another Mac with R and also with RStudio, I get the same warning...</p>\n\n<p>I know this is \"just\" a warning, but it makes me a bit nervous and seems to have the potential to cause problems in the future.</p>\n"},{"tags":["sql","vb.net","excel","ado.net"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":2509,"score":1,"question_id":1851076,"title":"import excel to sql db table","body":"<p>I am trying to write data from an excel spread sheet to a SQL Database. I have been able to connect to the Excel Spreadsheet and read the data but I am unable to get the data to insert into the SQL DB table. </p>\n\n<p>the current code is as follows</p>\n\n<p>any help most appreciated.</p>\n\n<pre><code>    Dim plmExcelCon As System.Data.OleDb.OleDbConnection\n    Dim ldExcelDS As System.Data.DataSet\n    Dim cmdLoadExcel As System.Data.OleDb.OleDbDataAdapter\n    Dim PrmPathExcelFile As String\n    PrmPathExcelFile = txtImportFileLocation.Text.ToString\n\n    plmExcelCon = New System.Data.OleDb.OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + PrmPathExcelFile + \";Extended Properties=Excel 12.0;\")\n    cmdLoadExcel = New System.Data.OleDb.OleDbDataAdapter(\"select * from [\" + txtImportSheetName.Text + \"$]\", plmExcelCon)\n    ldExcelDS = New System.Data.DataSet\n    cmdLoadExcel.Fill(ldExcelDS)\n\n    dgvImportData.DataSource = ldExcelDS.Tables(0)\n\n    plmExcelCon.Close()\n\n\n   cmdINSERT.Parameters(\"@[SQL COLUMN NAME]\").Value = [Not sure how to set value from datagrid view]\n\n\n  cnLD.Open()\n  cmdINSERT.ExecuteNonQuery()\n  cnLD.Close()\n</code></pre>\n"},{"tags":["excel"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3946,"score":2,"question_id":8135995,"title":"how to merge all column into one cell in excel?","body":"<p>E.g </p>\n\n<pre><code>A1:I\nA2:am\nA3:a\nA4:boy \n</code></pre>\n\n<p>I want to merge them all to a single cell \"Iamaboy\"<br>\nThis example shows 4 cells merge into 1 cell however I have many cells (more than 100), I can't type them one by one using <code>A1 &amp; A2 &amp; A3 &amp; A4</code> what can I do?</p>\n"},{"tags":["c#","sql","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":12510619,"title":"Getting different errors while importing Excel file through SqlBulkCopy","body":"<p>I am importing an Excel file into SQL Server using <code>SqlBulkCopy</code></p>\n\n<p>But every time I get differant errors like </p>\n\n<blockquote>\n  <p><em>Cannot update. Database or object is read-only.</em></p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p><em>Could not find installable ISAM.</em></p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p><em>The Microsoft Jet database engine could not find the object. Make sure the object exists and that you spell its name and the path name correctly.</em></p>\n</blockquote>\n\n<p>Check my code below...</p>\n\n<pre><code>String strConnection = ConfigurationManager.ConnectionStrings[\"MyConnection\"].ConnectionString;\nstring excelConnectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"+filepath+\";Extended Properties=Excel 8.0;HDR=YES;\";\n\n//Create Connection to Excel work book\nOleDbConnection excelConnection = new OleDbConnection(excelConnectionString);\n\n//Create OleDbCommand to fetch data from Excel\nOleDbCommand cmd = new OleDbCommand\n(\"Select * from [Sheet1$]\",\nexcelConnection);\nMessageBox.Show(\"ss\");\nexcelConnection.Open();\nMessageBox.Show(\"ss2\");\nOleDbDataReader dReader;\ndReader = cmd.ExecuteReader();\nMessageBox.Show(\"ss1\");\nSqlBulkCopy sqlBulk = new SqlBulkCopy(strConnection);\nsqlBulk.DestinationTableName = \"RecExcelTable\";\n//sqlBulk.ColumnMappings.Add(\"ID\", \"ID\");\n//sqlBulk.ColumnMappings.Add(\"Name\", \"Name\");\nsqlBulk.WriteToServer(dReader);\n</code></pre>\n\n<p>Also I need to compitable this code for any version of Excel.  </p>\n\n<p>How can I do that and solve my error?</p>\n"},{"tags":["php","excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":78,"score":-1,"question_id":12907526,"title":"Error : csv file is not readable","body":"<p>I have done uploading of csv file but there is an error like this</p>\n\n<pre><code>abcd.csv is not readable.\n</code></pre>\n\n<p>I have used <code>Excel/reader.php</code> file. &amp; my code is,</p>\n\n<pre><code>require_once 'Excel/reader.php';\n$data = new Spreadsheet_Excel_Reader();\n$data-&gt;read($fileName); // error is given to this line\n$countRejected=array();\n$countAccepted=array();\n$countAlreadyExists = 0;\n$dataArray=$data-&gt;sheets[0]['cells'];\n</code></pre>\n\n<p>Please suggest me any solution if anybody have.</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12924237,"title":"the efficient approach of selecting large amount of rows in an Excel file","body":"<p>I have an Excel file which have large amount of rows, say 100000 rows. Is there any efficient way to select these 1000000 rows altogether instead of dragging my mouse? Thanks.</p>\n"},{"tags":["excel","dataset","sas"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":784,"score":1,"question_id":9723788,"title":"Import excel file located on a UNIX server to SAS","body":"<p>I am trying to import a excel file to a dataset using SAS, however the regular approach:</p>\n\n<pre><code>PROC IMPORT OUT= test.test\n            DATAFILE= \"M:/excelfile.xls\"\n            DBMS=EXCEL REPLACE;\n     SHEET=\"Sheet1\";\n     GETNAMES=YES;\n     MIXED=NO;\n     SCANTEXT=YES;\n     USEDATE=YES;\n     SCANTIME=YES;\nRUN;\n</code></pre>\n\n<p>only works on Windows.</p>\n\n<p>Im using SAS 9.2 .. I tried different DBMS like XLS, EXCELCS with no luck...\nI've been investing a lot of time on this I wanted to know if is possible..\nI don't have access to any other languages other than SAS ans SHELL (no PERL)</p>\n\n<p>Is there anyway to accomplish what I'm looking for?</p>\n\n<p>These are the installed base products </p>\n\n<p>Operating System:   AIX 64   <br>\n---Base Product  <br>\n ---SAS/STAT               <br><br>\n---SAS/GRAPH            <br><br>\n---SAS/ETS <br>                                           ---SAS/OR                                            ---SAS/CONNECT<br>\n---SAS Integration Technologies<br>\n---OR OPT<br>\n---OR PRS<br>\n---OR IVS<br>\n---OR LSO<br>\n---SAS/ACCESS Interface to DB2   </p>\n"},{"tags":["sql-server-2008","excel","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12908305,"title":"How to properly align the xls to bind the table data using a stored procedure in SQL Server 2008?","body":"<p>I wrote the stored procedure like this</p>\n\n<pre><code>CREATE Procedure [dbo].[usp_GetTrackAgencyCountReport_Job]\nAS\n   Declare @BodyMessage Varchar(1000),\n        @ToEmail Varchar(254),\n        @sql Varchar(max),\n        @Count int,\n        @intFlag INT,\n        @Agent varchar(200),\n        @From datetime,\n        @To datetime,\n        @DbName varchar(100)\n\n        SET @BodyMessage='Please find attached list of Agency names, for how many accounts rated, how many accounts submitted and how many accounts approved to QMS. '\n        Select @ToEmail='hemanth@zeninfotech.com;'\n        --Select @ToEmail='cpeterson@chris-leef.com; gpeterson@chris-leef.com; info@chris-leef.com'\n        SET @To= (SELECT DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0))\n        SET @From=(SELECT DATEADD(day, DATEDIFF(day, 0, GETDATE()), -7))\n        SET @Agent=''\n        SET @DbName='QMSV3Dev'\n\nBegin   \n--crete temp table to get the details\nCREATE TABLE #tblAgencyCount(AID INT IDENTITY(1,1) NOT NULL,SaveDataCount varchar(50),AgentID varchar(50),GetRateCount varchar(50),ConvertedQuoteCount varchar(50))\nINSERT INTO #tblAgencyCount(SaveDataCount,AgentID) select COUNT(*),AQ.AgentID from Agent_Quote AQ where \n        AQ.CreatedOn between @From and @To\n        and AQ.AgentID like @Agent +'%' and AQ.StatusCode!='C' group by AQ.AgentID  \nSET @intFlag = 1\nset @Count=(select COUNT(*) from #tblAgencyCount)\nWHILE (@intFlag &lt;=@Count)\nBEGIN\ndeclare @Ai int\nset @Ai=(select AgentID from #tblAgencyCount where AID=@intFlag)\nUpdate #tblAgencyCount set GetRateCount=(select COUNT(*) from Agent_Quote AQ where \n        AQ.CreatedOn between @From and @To\n        and AQ.AgentID like @Ai and AQ.StatusCode!='C' and AQ.LowPrice!='' and AQ.HighPrice!=''),\n        ConvertedQuoteCount=(select COUNT(*) from Agent_Quote AQ where \n        AQ.CreatedOn between @From and @To\n        and AQ.AgentID like @Ai and AQ.StatusCode!='C' and AQ.ApproveStatus='Approved')\n         where AID=@intFlag\nSET @intFlag = @intFlag + 1\nEND\n--end \n    Drop Table Temp_AgencyCount\n    Create Table Temp_AgencyCount(AgencyName Varchar(250),SubmittedCount Varchar(50),GetRateCount varchar(50),ApprovedQuoteCount Varchar(50))\n    SET @sql='select A.Name,AC.SaveDataCount as SubmittedCount,AC.GetRateCount,AC.ConvertedQuoteCount as ApprovedQuoteCount from #tblAgencyCount AC Left Join ' + @DbName + '..Agent A On AC.AgentID = A.ID order by A.Name'\n    Insert into Temp_AgencyCount Values('Agency Name','Submitted Count','GetRate Count','Approved QuoteCount')\n    Insert into Temp_AgencyCount Values('------------------------------------','-----------------','---------------','-------------------')\n    Insert into Temp_AgencyCount Exec(@sql)\n    exec master..xp_cmdshell 'bcp \"SELECT AgencyName+Space(40-Len(AgencyName))+ ''-   ''+ SubmittedCount+Space(20-Len(SubmittedCount))+''- ''+GetRateCount+Space(20-Len(GetRateCount))+''- ''+ApprovedQuoteCount FROM AgentPortal_Live_21Sept2012..Temp_AgencyCoun\nt\" queryout C:\\WeeklyOnlineSubmissionReport.xls -c -T'\n    Select @Count=COUNT(*) from Temp_AgencyCount\n    If(@Count!=0)\n    Begin\n        EXEC msdb.dbo.sp_send_dbmail @profile_name='Profile',\n             @recipients=@ToEmail, @subject='Weekly Online Submission Report', \n             @body=@BodyMessage,@file_attachments='C:\\WeeklyOnlineSubmissionReport.xls'\n    End\nEnd\n\n--Exec usp_GetTrackAgencyCountReport_Job\n</code></pre>\n\n<p>It is working fine to create the Excel file and send to mail but I don't get correct format in one column in one line like that to display the Excel, how to align, please give me any idea about that</p>\n\n<p>Thank u\nhemanth</p>\n"},{"tags":["excel"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":18,"score":0,"question_id":12924231,"title":"Excel -- inserting multiple rows at once","body":"<p>Anybody know how to insert multiple blank rows in Excel all at once?  Right now I right-click->Insert but that does just one row.</p>\n\n<p>Thanks</p>\n"},{"tags":["excel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12915785,"title":"Is THIS date within 1 year of todays date?","body":"<p>How can I go about having a conditional formatting formula which checks the date in its cell and then formats it if the date is within 1 year from todays date?</p>\n\n<p>I know I can do =EDATE(A5,16) which adds 16 months onto A5, but I don't know how to implement this into the above.</p>\n"},{"tags":["excel","libreoffice"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12922647,"title":"LIBRE OFFICE / EXCEL how to get data from a column and join with string","body":"<p>How do i do something like for example:</p>\n\n<p>COL(C2).VALUE + \",\\n\" + COL(D2).VALUE + \",\\n\" + COL(E2).VALUE</p>\n\n<p>in excel or libre office.</p>\n\n<p>I want to concatenate column values across a row into 1 column with a seperator of my choice.</p>\n"},{"tags":["excel","matlab","delete-row"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12922296,"title":"matlab: delete the last row in excel","body":"<p>I have an excel file with contents and background color,</p>\n\n<p>something like the first row:\n<img src=\"http://i.stack.imgur.com/jPdhS.png\" alt=\"enter image description here\"></p>\n\n<p>I want to delete all the contents in the first row, there is a command that do that?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I succeeded to delete the cells of A3:I3:</p>\n\n<pre><code>esh.Range('A1:I1').value = []; \n</code></pre>\n\n<p>I tried to color the J1 cell by white, but it let me the cell of J2 and I need to get the cell of J3.</p>\n\n<p>so I need to color J1 by 'NoFill'.</p>\n\n<p>how can I do that?</p>\n\n<p>I have to say that <strong>I always want to delete the last row in the file (<em>the example doesn't show that but always the last line</em>)</strong></p>\n\n<p><strong>you can assume I have the range/number_of_the_row that I want to delete</strong></p>\n\n<pre><code>e = actxserver ('Excel.Application'); %# open Activex server\newb = e.Workbooks.Open(filename); %# open the file\nesh = ewb.ActiveSheet;\nclr = [255 255 255] * [1 256 256^2]';\nesh.Range('A1:I1').value = [];\nesh.Range('J1:J1').Interior.Color = clr;\nset(e, 'DisplayAlerts', 0); % Stop dialog!\nxlWorkbookNormal = excelWorkbook; %# it's the Excel constant, not sure how to pass it other way\newb.SaveAs(filename, xlWorkbookNormal)\newb.Close(false)\ne.Quit\ne.delete\n</code></pre>\n"},{"tags":["excel","excel-formula"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":11389233,"title":"Using a special calculator to write to a table","body":"<p>I have a downloaded Excel spreadsheet that has a special built-in calculator. </p>\n\n<p>In another sheet I have my list of 173 values. These I enter into the calculator cell, press enter in another cell and in another cell the return value pops up.</p>\n\n<p>I want the value of each return cell to be entered adjacent to its list value.</p>\n\n<p>How can I do this without using an <code>IF</code> statement?</p>\n"},{"tags":["windows","excel","vba","ms-office","windows-update"],"answer_count":11,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":8202,"score":4,"question_id":11971358,"title":"Excel/VBA Automation Errors due to Office Service Pack 3.0 caused by Forms","body":"<p>After installing all latest windows updates my Excel VBA code is showing an automation error at the very start of the first module. It contains some forms as well as numerous modules of VBA code. However, when removing the forms (and associated code) everything is fine.</p>\n\n<p>The same thing happened about a year ago after some other windows updates. Back then deleting the .exd files did the trick, but the current updates (including Service Pack 3) seem to be different.</p>\n\n<p>What is going on and how can I get the forms to work? All the code is unchanged and has survived all previous windows/office updates. Running Windows 7 (same happening on Vista machine) and Office 2007.</p>\n"},{"tags":["excel"],"answer_count":9,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":36295,"score":5,"question_id":1500153,"title":"Find the differences between 2 Excel worksheets?","body":"<p>I have two excel files with the same structure:  they both have 1 column with data.  One has 800 records and the other has 805 records, but I am not sure which of the 5 in the 805 set are not in the 800 set.  Can I find this out using Excel?</p>\n"},{"tags":["php","excel","writer","spreadsheet-excel-writer"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":12920281,"title":"spreadsheet_excel_writer setColumn","body":"<p>I am having trouble getting the columns to change width using spreadsheet_excel_writer.  I want the first column to be longer than the rest, however they are all the same when it outputs....</p>\n\n<pre><code>    $worksheet[$w] =&amp; $workbook-&gt;addWorksheet($worksheetName);\n                $worksheet[$w]-&gt;setInputEncoding(\"UTF-8\");\n                $worksheet[$w]-&gt;setColumn(0,0,85.33);\n                $worksheet[$w]-&gt;setColumn(1,8,10);\n                $worksheet[$w]-&gt;setRow(5, 27);\n</code></pre>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12915415,"title":"How to write a modularized copy subroutine for cells in VBA?","body":"<p>I need to be able to write a copy subroutine that will read in the input worksheet name and the input cells, and copy this data to a specific output sheet and output cells. This subroutine must be modularized because it will be used in mulitiple worksheets.It will only copy the data from input sheets to output sheets. Here is one I have written but it doesn't work.</p>\n\n<pre><code>Public Sub Copy_Input_Data_To_Output_Data( _\n ByVal pv_str_input_worksheet_name As String, _\n ByVal pv_str_output_worksheet_name As String, _\n ByVal pv_str_input_cell_range As String, _\n ByVal pv_str_output_cell_range As String, _\n ByRef pr_str_error_message As String)\n\n Worksheets(pv_str_input_worksheet_name).Range(pv_str_input_cell_range).Value  = _\n Worksheets(pv_str_output_worksheet_name).Range(pv_str_output_cell_range).Value\nEnd Sub\n</code></pre>\n\n<p>Here is the code of that subroutine being applied to a input sheet.</p>\n\n<pre><code>Call Copy_Input_Data_To_Output_Data( _\n pv_str_in… _\n pv_str_output_worksheet_name:=\"Sheet2\", _\n pv_str_input_cell_range:=\"B13:B17\", _\n pv_str_output_cell_range:=\"\"B17,B20,B34,B18,B21\", _\n pr_str_error_message:=str_error_message)\n</code></pre>\n\n<p>As you can see this code is copying ranges of input cells and the data goes to specific output cells in another sheet. Please help I would greatly appericate it! :)</p>\n"},{"tags":["excel","excel-formula"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1198,"score":1,"question_id":4305584,"title":"In MS Excel, I need to delete every alternate row AUTOMATICALLY rather than MANUALLy, how can it be done WITH EXCEL?","body":"<blockquote>\n  <h3>Already asked on Super User:</h3>\n  \n  <p><a href=\"http://superuser.com/questions/216368/\">In MS Excel, I need to delete every alternate row AUTOMATICALLY rather than MANUALLY.</a></p>\n</blockquote>\n\n<p>basically i'm working on an excel spreadsheet in which I have to delete every alternate row because it is messing up with my results.</p>\n\n<p>Its a set of 4000 randomly generated set of data.</p>\n\n<p>Hence, deleting 2000 wud take about 30 mins, can it be done in 30 seconds using EXCEL alone and avoiding Programming?</p>\n\n<p>Is there any trick to do that in MS Excel?</p>\n"},{"tags":["excel","microsoft"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12918834,"title":"Excel sheet locking using VBA Macro code","body":"<p>I was created an MS Excel sheet for storing my complete accounting details and stocks. I want to lock my excel sheet. but it should be visible by others and they dont edit or modify it. please tell me a solution. i heared about visual basis editor (VBA Macro code) but i dont know how to use it.please explain how to lock an excel worksheet using visual basis editer.waiting for your valuable replay.</p>\n"},{"tags":["excel","exception","64bit","invalid","xlsx"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12918822,"title":"How to read in Excel file in Win7 64bit using ACE OLEDB provider?","body":"<p>I have a c# application that I have moved to a 64bit machine. This application reads in an Excel file for some data input. I would like to build this project as 64bit. Is there any way to have my program read in this file? I find it hard to believe that there is no way to use and Excel file as input into a 64bit app. I have installed Office 2010 64 bit as well as the 2010 Office System Driver Beta: Data Connectivity Components with no luck. I'm sure that I'm just missing something really simple. My application works perfectly with 32 bit environment for .xls and .xlsx files. With 64 bit it only works with .xls and not with .xlsx. Following code is throwing exception that Specified method is not supported(when I tried to open connection with xlsx on 64 bit env.).</p>\n\n<p>Exception:</p>\n\n<pre><code>&lt;Exception&gt;\n  &lt;Description&gt;An exception of type 'System.NotSupportedException' occurred and was caught.&lt;/Description&gt;\n  &lt;DateTime&gt;2012-10-12 17:53:53Z&lt;/DateTime&gt;\n  &lt;ExceptionType&gt;System.NotSupportedException, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/ExceptionType&gt;\n  &lt;Message&gt;Specified method is not supported.&lt;/Message&gt;\n  &lt;Source&gt;ExcelHelper&lt;/Source&gt;\n  &lt;HelpLink /&gt;\n  &lt;Property name=\"Data\"&gt;System.Collections.ListDictionaryInternal&lt;/Property&gt;\n  &lt;Property name=\"TargetSite\"&gt;System.Data.OleDb.OleDbConnection GetConnection(System.String)&lt;/Property&gt;\n  &lt;StackTrace&gt;   at ExcelOperations.ExcelHelper.GetConnection(String excelFile)\n   at ExcelOperations.ExcelHelper.GetExcelSheetDataSet(String excelFile, String sheetName)\n   at ExcelOperations.ExcelHelper.GetXLSXDataSet(String dataFilePath, String sheetName, Int64 rowNo)\n   at Intralinks.Platform.ObjectImpl.DataSource.ExcelFileSource.UpdateDataFilePath(String dataFilePath)&lt;/StackTrace&gt;\n  &lt;additionalInfo&gt;\n    &lt;info name=\"MachineName\" value=\"NYCVMQCA007\" /&gt;\n    &lt;info name=\"TimeStamp\" value=\"10/12/2012 9:53:53 PM\" /&gt;\n    &lt;info name=\"FullName\" value=\"Microsoft.Practices.EnterpriseLibrary.ExceptionHandling, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null\" /&gt;\n    &lt;info name=\"AppDomainName\" value=\"ILPlatform.exe\" /&gt;\n    &lt;info name=\"ThreadIdentity\" value=\"\" /&gt;\n    &lt;info name=\"WindowsIdentity\" value=\"INTRALINKS\\VPatel\" /&gt;\n  &lt;/additionalInfo&gt;\n&lt;/Exception&gt;\nCategory: Logging Exception\nPriority: 1\nEventId: 100\nSeverity: Error\nTitle:Enterprise Library Exception Handling\nMachine: NYCVMQCA007\nApplication Domain: ILPlatform.exe\nProcess Id: 3548\nProcess Name: C:\\IntraLinks\\IntraLinks Designer\\ILPlatform.exe\nWin32 Thread Id: 5360\nThread Name: \n</code></pre>\n\n<p>Code snippet:</p>\n\n<pre><code>    public static OleDbConnection GetConnection(string excelFile)\n    {\n        OleDbConnection objConn = null;\n        try\n        {\n            // Connection String. Change the excel file to the file you\n            // will search.\n            String connString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + excelFile + \";Extended Properties=\\\"Excel 12.0 xml;IMEX=1\\\"\";\n            // Create connection object by using the preceding connection string.\n            objConn = new OleDbConnection(connString);\n            // Open connection with the database.\n            objConn.Open();\n        }\n        catch (Exception)\n        {\n            try\n            {\n                // Connection String. Change the excel file to the file you\n                // will search.\n                String connString = \"Provider=Microsoft.Jet.OLEDB.4.0;\" +\n                      \"Data Source=\" + excelFile + \";Extended Properties=Excel 8.0;\";\n                // Create connection object by using the preceding connection string.\n                objConn = new OleDbConnection(connString);\n                // Open connection with the database.\n                objConn.Open();\n            }\n            catch (Exception)\n            {\n                throw new NotSupportedException(); \n            }\n        }\n        return objConn;\n    }\n</code></pre>\n"},{"tags":["excel","vba"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12918306,"title":"Excel VBA: Tell the print setup somehow which row = end of first page?","body":"<p>I have two tables in my spreadsheet (one on top of the other separated by a couple rows), call them T1 and T2. T1 is dynamic in terms of how many rows it contains, T2 is static. I can easily find out which row T1 ends on and then add 1 to it or so -- call this variable T1EndRow.</p>\n\n<p>I want to code it so it'll know that everything from row 1 to T1EndRow will be on the first page of the print preview. T2 will flow over to the second page.</p>\n\n<p>How can I do this?</p>\n"},{"tags":["excel","csv"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":12918628,"title":"Move data from ColB and ColC beneath data in ColA","body":"<p>I tried looking up what I need to do, but I'm not very good with Excel, so I'm not sure how to search for what I'm attempting to do.... here it goes...</p>\n\n<p>I have a file that a customer sent me that I need to export as a .csv for direct mailing. What she sent has all 1463 customer names down column A, their address in ColB, and the second address line in ColC. The program that I need to import the .csv file into needs all of the information in one column so that it reads as you might read an address on an envelope, with the entire name and address in one cell (one cell per entry). So I need to take the data in column C and move it underneath the data in column B, then take that data and move it underneath the name data in column A. </p>\n\n<p>Side note: The third address lines did have a comma between the city and state, but I have already gone through and removed them, since I know that the file will not export correctly with a comma in the data in a .csv file.</p>\n\n<p>Using Excel 2010 on Windows 7.</p>\n"},{"tags":["excel","vba","excel-vba"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6662,"score":1,"question_id":5181164,"title":"Progress bar in VBA Excel","body":"<p>im doing a excel app that needs a lot data updating from a database so it takes time. I want to make a progress bar in a userform and it pops up when the data is updating.\nThe bar i want is just a little blue bar moves right and left and repeats till the update is done, no percentage needed.\nI know i should use progressbar control but i tried for sometime but cant make it.</p>\n\n<p>EDIT: My probleme is with the progressbar control, i cant see the bar 'progress', it just complete when the form pops up. I use a loop and DoEvent but that dont work. Plus, i want the process to repeat, not just one time.</p>\n"},{"tags":["c#","excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":127,"score":2,"question_id":12907404,"title":"How can I export data to excel using Microsoft.ACE.OLEDB.12.0 and keep the data format.","body":"<p>Sample code is</p>\n\n<pre><code>INSERT INTO OPENROWSET ('Microsoft.ACE.OLEDB.12.0', 'Excel 8.0;Database=E:\\Application\\PASpready\\Files\\NK\\NKAll.xlsx;HDR=YES;','SELECT * FROM [All$]') \nselect ..... from table\n</code></pre>\n\n<p>All the data comes over as text and number decimals loose their format. How can i keep the data format in excel.</p>\n"}]}
